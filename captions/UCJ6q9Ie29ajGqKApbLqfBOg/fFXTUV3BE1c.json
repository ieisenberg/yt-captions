[
  {
    "start": "0",
    "end": "36000"
  },
  {
    "text": "yeah hello and welcome to my talk breaking the industrial Internet of Things I'll talk a bit about hacking",
    "start": "30",
    "end": "6330"
  },
  {
    "text": "industrial control gateways but first a short introduction Who am I my name is",
    "start": "6330",
    "end": "11670"
  },
  {
    "text": "Thomas Roth I'm the founder of level down security small security consultancy",
    "start": "11670",
    "end": "16980"
  },
  {
    "text": "from Germany my main focus is on embedded devices from trust zone to boot loaders to",
    "start": "16980",
    "end": "23160"
  },
  {
    "text": "industrial systems all kinds of stuff and if you want to follow me on Twitter you can find me at stack smashing and if",
    "start": "23160",
    "end": "29760"
  },
  {
    "text": "you want to send me an email feel free to mail to Thomas Roth at level down de",
    "start": "29760",
    "end": "35570"
  },
  {
    "text": "so before we start all information in this talk is based on reverse engineering so if there are small",
    "start": "35570",
    "end": "42180"
  },
  {
    "start": "36000",
    "end": "36000"
  },
  {
    "text": "mistakes small misinterpretations I apologize I did my best to get everything correct but you know how it",
    "start": "42180",
    "end": "47850"
  },
  {
    "text": "goes sometimes I'm also not trying to shame any single vendors so the vendor selection of the devices we'll talk",
    "start": "47850",
    "end": "54449"
  },
  {
    "text": "about is completely random and I think the entire industry has a problem and not a single vendor also all scripts",
    "start": "54449",
    "end": "61859"
  },
  {
    "text": "that were used in in the research are available on github but the exploits are",
    "start": "61859",
    "end": "67860"
  },
  {
    "text": "currently not kiss they're far too many devices out there that are unpatched currently there are some people who",
    "start": "67860",
    "end": "75780"
  },
  {
    "start": "74000",
    "end": "74000"
  },
  {
    "text": "talked about the similar class of devices previously for example mr. Reiter white man",
    "start": "75780",
    "end": "81030"
  },
  {
    "text": "Patrick De Santis and maximum rock you absolutely want to check them out if you're interested in industrial security",
    "start": "81030",
    "end": "87000"
  },
  {
    "text": "and they have been very helpful to me in providing some feedback giving me additional information and so on so",
    "start": "87000",
    "end": "94290"
  },
  {
    "text": "let's talk about the motivation for this talk I was doing a pen test of an",
    "start": "94290",
    "end": "100799"
  },
  {
    "text": "electricity provider and they showed me all their SCADA systems they showed me",
    "start": "100799",
    "end": "106049"
  },
  {
    "text": "how they're interconnected how other substations are connected to this big control room and then they showed me",
    "start": "106049",
    "end": "113720"
  },
  {
    "text": "basically a shelf full of tiny devices which had a serial port on one side and",
    "start": "113720",
    "end": "119460"
  },
  {
    "text": "Ethernet on the other and they were used to basically interconnect a ton of devices we RF links via ethernet via GSM",
    "start": "119460",
    "end": "128190"
  },
  {
    "text": "and so on and they all came back at that single point and I found them very interesting",
    "start": "128190",
    "end": "133590"
  },
  {
    "text": "very interesting because they are really at this place between the native protocols such as cereal and so on and",
    "start": "133590",
    "end": "139860"
  },
  {
    "text": "the internet also industrial systems are used as weapons nowadays so we really",
    "start": "139860",
    "end": "146099"
  },
  {
    "start": "142000",
    "end": "142000"
  },
  {
    "text": "need to look at securing these devices so we have attacks on steel plants in",
    "start": "146099",
    "end": "151319"
  },
  {
    "text": "Germany we have a cyber attack on a Saudi Arabian petrol plant which almost",
    "start": "151319",
    "end": "157380"
  },
  {
    "text": "caused it to explode and was actively used to cause harm basically we were",
    "start": "157380",
    "end": "163260"
  },
  {
    "text": "lucky that the exploit was not working and we also have active attacks on the par grid so for example Ukraine Power",
    "start": "163260",
    "end": "170100"
  },
  {
    "text": "Grid attack in December 2015 was conducted using one of the devices I'll",
    "start": "170100",
    "end": "175650"
  },
  {
    "text": "be talking about today so what is industrial IOT if we look at traditional",
    "start": "175650",
    "end": "182430"
  },
  {
    "text": "ICS networks they're kind of this enclosed system we have for example a chemical plant you have a control room",
    "start": "182430",
    "end": "188819"
  },
  {
    "start": "183000",
    "end": "183000"
  },
  {
    "text": "you have all your actors all your sensors located in a secure perimeter with physical access control and so on",
    "start": "188819",
    "end": "195360"
  },
  {
    "text": "but today if we look at electric grids if we look at large chemical plants or",
    "start": "195360",
    "end": "201329"
  },
  {
    "text": "our large plants in general suddenly those kind of segmented networks become",
    "start": "201329",
    "end": "207239"
  },
  {
    "text": "a very wide area network so you might have in a case of an electricity grid you might have solar panels that are",
    "start": "207239",
    "end": "213269"
  },
  {
    "text": "remotely connected for data collection or for control you might have some PLC's",
    "start": "213269",
    "end": "218459"
  },
  {
    "text": "in your substations that are connected we are some kind of run to your central control room and there are all these",
    "start": "218459",
    "end": "224579"
  },
  {
    "text": "kinds of things so for example substations we have remote valves we",
    "start": "224579",
    "end": "230489"
  },
  {
    "start": "225000",
    "end": "225000"
  },
  {
    "text": "have water dams so for example they water them in the city where I live is remotely controlled we have one of the",
    "start": "230489",
    "end": "236310"
  },
  {
    "text": "devices we're going to talk about we have traffic management systems we have",
    "start": "236310",
    "end": "241590"
  },
  {
    "text": "access control so for example these barriers are often connected via such devices and even tunnels which was kind",
    "start": "241590",
    "end": "248910"
  },
  {
    "text": "of funny because I was doing a pen test and I asked hey I found this device it's vulnerable what the hell is it and they",
    "start": "248910",
    "end": "254549"
  },
  {
    "text": "told me it's a it's a tunnel and so it turns out that the ventilation system of",
    "start": "254549",
    "end": "259739"
  },
  {
    "text": "tunnels is also remotely controlled and so if you manage to break into this and stop the ventilation system chances are",
    "start": "259739",
    "end": "266330"
  },
  {
    "text": "that you might cause someone to suffocate or similar RIT so industrial",
    "start": "266330",
    "end": "273530"
  },
  {
    "text": "control systems as I've mentioned before they used to connect different protocols",
    "start": "273530",
    "end": "279199"
  },
  {
    "start": "279000",
    "end": "279000"
  },
  {
    "text": "to an IP network so in the industrial control world you for example I have Modbus you have rs-232 you have canvas",
    "start": "279199",
    "end": "286189"
  },
  {
    "text": "as four eight five whatever and all those protocols somehow need to talk to",
    "start": "286189",
    "end": "291199"
  },
  {
    "text": "a computer and for what that use case these industrial control gateways are used and they connect via ethernet GSM",
    "start": "291199",
    "end": "298520"
  },
  {
    "text": "whatever and they you can basically find them in any larger industrial installation and the first feedback I",
    "start": "298520",
    "end": "307639"
  },
  {
    "text": "get when I'm going to talk to people about the industry gateways is hey don't worry these devices are I kept a on the",
    "start": "307639",
    "end": "314030"
  },
  {
    "text": "secure Network whatever I mean how can I device with an antenna via get right I mean these devices today have Wi-Fi the",
    "start": "314030",
    "end": "322580"
  },
  {
    "text": "fgs and they're some proprietary radio systems they use Laura they basically",
    "start": "322580",
    "end": "328639"
  },
  {
    "text": "can do everything and even the vendor examples the same vendor that tells me no these devices I adapt their examples",
    "start": "328639",
    "end": "336110"
  },
  {
    "text": "for example use GPRS to remote control valves to remotely monitor systems and",
    "start": "336110",
    "end": "342199"
  },
  {
    "text": "so on so in this case from advantage and moxa has the same examples of remote controlling pumps and whatever and so",
    "start": "342199",
    "end": "349279"
  },
  {
    "text": "these are not only used together sensor data they actively used to control things remotely and so these devices are",
    "start": "349279",
    "end": "356330"
  },
  {
    "text": "absolutely not a gift and then if you go",
    "start": "356330",
    "end": "362330"
  },
  {
    "text": "on the internet and start scanning a bit you find thousands of these devices open on the internet you actually can find",
    "start": "362330",
    "end": "368360"
  },
  {
    "start": "363000",
    "end": "363000"
  },
  {
    "text": "entire network ranges almost exclusively filled with these devices because they come from industrial ISPs and most of",
    "start": "368360",
    "end": "375469"
  },
  {
    "text": "them are significantly outdated so for example on children you can find eight thousand six hundred devices of just a",
    "start": "375469",
    "end": "381889"
  },
  {
    "text": "single type and even if they are not fully open on the Internet the barrier",
    "start": "381889",
    "end": "389629"
  },
  {
    "start": "385000",
    "end": "385000"
  },
  {
    "text": "of access to them is mostly very low so you might have some cards with public IPS as that there there are some",
    "start": "389629",
    "end": "395959"
  },
  {
    "text": "providers that provide you with industrial SIM cards and they give you a public IP and if you look at the whole ripe range",
    "start": "395959",
    "end": "401810"
  },
  {
    "text": "you can just find hundreds of devices over on the Internet often they use static IPS without any",
    "start": "401810",
    "end": "409040"
  },
  {
    "text": "VPN protection also or they're connected via Wi-Fi and in one case we found an industrial Wi-Fi which was a",
    "start": "409040",
    "end": "415280"
  },
  {
    "text": "point-to-point directional Wi-Fi with the IP with a password sent to one one one one one F then you have the issue of",
    "start": "415280",
    "end": "423620"
  },
  {
    "text": "physical access for example in these small boxes it's trivial to break in we've got good luck because here at",
    "start": "423620",
    "end": "429650"
  },
  {
    "text": "blackhat so this is not protection and we need to make sure that these devices are even secure at least in some way",
    "start": "429650",
    "end": "436460"
  },
  {
    "text": "temper proof or what we also see is that these devices are connected via GPRS",
    "start": "436460",
    "end": "443270"
  },
  {
    "start": "440000",
    "end": "440000"
  },
  {
    "text": "with a custom APN so they are basically in a custom network but they are not",
    "start": "443270",
    "end": "449660"
  },
  {
    "text": "really segment segmented in any way so if you steal a single SIM card of one device you can connect into the entire",
    "start": "449660",
    "end": "455720"
  },
  {
    "text": "SCADA Network ok that being said let's start hacking some gateways so all",
    "start": "455720",
    "end": "464300"
  },
  {
    "text": "equipment that was needed for everything you see in this talk is just this just",
    "start": "464300",
    "end": "469370"
  },
  {
    "text": "as simple oscilloscope a cheap lodging analyzer a bus pirate and multimeter and",
    "start": "469370",
    "end": "474770"
  },
  {
    "start": "470000",
    "end": "470000"
  },
  {
    "text": "an a laptop and obviously a soldering iron I have this slide in here because with some of the vendor response was",
    "start": "474770",
    "end": "481100"
  },
  {
    "text": "these attacks on like the resources you need to conduct an attack on industrial",
    "start": "481100",
    "end": "486800"
  },
  {
    "text": "network are so high nobody can do it so this is me doing it at home so the first",
    "start": "486800",
    "end": "494870"
  },
  {
    "text": "step before I actually got started was I needed to find potential targets my",
    "start": "494870",
    "end": "500450"
  },
  {
    "start": "496000",
    "end": "496000"
  },
  {
    "text": "personal process is the first thing I look for is can I get the firmware before I even start so I checked the",
    "start": "500450",
    "end": "505760"
  },
  {
    "text": "vendor site I check whether I can download the firmware I check if the firmware is encrypted and then I check",
    "start": "505760",
    "end": "511760"
  },
  {
    "text": "the availability so basically how expensive is this research going to be",
    "start": "511760",
    "end": "516770"
  },
  {
    "text": "and how expensive is it going to be if I break it and also it should be a half what current technology because",
    "start": "516770",
    "end": "523099"
  },
  {
    "text": "otherwise you just hack junk all junk and that's not really interesting so if you do this for a couple of weeks you",
    "start": "523099",
    "end": "529400"
  },
  {
    "text": "eventually have a collection of random industrial hardware in interconnected on a board and these",
    "start": "529400",
    "end": "535540"
  },
  {
    "text": "are the devices plus some new ones that we are going to look at the first device",
    "start": "535540",
    "end": "541120"
  },
  {
    "text": "I would like to talk about is the moxa w2 one-five-zero a it's a simple",
    "start": "541120",
    "end": "547899"
  },
  {
    "text": "Ethernet or an internet to come and Wi-Fi adapter and you can get this very",
    "start": "547899",
    "end": "555430"
  },
  {
    "text": "easily it's used a lot around the world and what's nice about it is you can find the firmware publicly it's decently",
    "start": "555430",
    "end": "562810"
  },
  {
    "text": "cheap on eBay and it's found a lot on in the world and so the first step was a",
    "start": "562810",
    "end": "569230"
  },
  {
    "text": "sacramentary before let's get a firmware of this device so what do you do if you",
    "start": "569230",
    "end": "574830"
  },
  {
    "text": "find a random firmware the first thing is you run strings on it just to see is",
    "start": "574830",
    "end": "580000"
  },
  {
    "start": "577000",
    "end": "577000"
  },
  {
    "text": "this encrypted and unfortunately the only thing that's readable is the model",
    "start": "580000",
    "end": "585790"
  },
  {
    "text": "number and that's it otherwise it's just gibberish the next thing we do is we run",
    "start": "585790",
    "end": "591820"
  },
  {
    "text": "a tool called bin walk in walk tries to detect signatures of common compressions",
    "start": "591820",
    "end": "596860"
  },
  {
    "text": "of common firmware structures and so on but in this case not a single hit so",
    "start": "596860",
    "end": "603450"
  },
  {
    "text": "maybe it's encrypted that would be kind of bad and if you're not sure if a file",
    "start": "603450",
    "end": "609070"
  },
  {
    "text": "is encrypted or compressed or something what you can do is you run an entropy and other sis on it and an entropy",
    "start": "609070",
    "end": "614800"
  },
  {
    "text": "analysis will tell you if the device has a high entropy so it's very random it",
    "start": "614800",
    "end": "621370"
  },
  {
    "text": "means that it's either encrypted or compressed and if it has low entropy it's very likely to want to be",
    "start": "621370",
    "end": "627279"
  },
  {
    "text": "unencrypted just because a machine code is not dense enough to really be random so you will very easily see the",
    "start": "627279",
    "end": "633490"
  },
  {
    "text": "difference between an unencrypted and an encrypted image so as you can see on the graph it looks like a straight line with",
    "start": "633490",
    "end": "640779"
  },
  {
    "text": "high entropy so not looking good but then I remembered that when I downloaded the firmware there was a small note on",
    "start": "640779",
    "end": "648310"
  },
  {
    "text": "the bottom of the site which basically which basically said before upgrade to",
    "start": "648310",
    "end": "655720"
  },
  {
    "text": "firmware version 2.0 please make sure you have already upgraded the unit to version 1 point 11 and if we go to this",
    "start": "655720",
    "end": "663670"
  },
  {
    "text": "download link you see that the change look they actually introduced the support for",
    "start": "663670",
    "end": "669130"
  },
  {
    "text": "encrypted firmware and so I decided to download this older image and suena if",
    "start": "669130",
    "end": "676450"
  },
  {
    "text": "we run the strings on it you can see it's fully unencrypted and we can use it for analysis and if we just run this",
    "start": "676450",
    "end": "684490"
  },
  {
    "text": "image into a hex amp you can see that almost at every fourth byte is an e and",
    "start": "684490",
    "end": "691890"
  },
  {
    "text": "that immediately tells you that you're looking at an arm firmware why is that because the first four bits of any",
    "start": "691890",
    "end": "699280"
  },
  {
    "text": "encoded arm instructions are what's called the condition bits so basically in arm every instruction can be set to",
    "start": "699280",
    "end": "706030"
  },
  {
    "text": "only execute if a certain condition is met so for example if the carry flag has said zero of like a set or so and",
    "start": "706030",
    "end": "713190"
  },
  {
    "text": "because mostly you just always execute every fourth byte will be e and so we",
    "start": "713190",
    "end": "718510"
  },
  {
    "text": "know that we have an unencrypted firmware off with arm code and if we run been walking our nice entropy analysis",
    "start": "718510",
    "end": "725860"
  },
  {
    "text": "on it we can see that indeed pin walk finds a lot of compressed data it finds",
    "start": "725860",
    "end": "731620"
  },
  {
    "text": "a squashy fast filesystem it finds gzip compressed data and so on and so",
    "start": "731620",
    "end": "736630"
  },
  {
    "text": "wonderful we can hopefully use this to find the firmware upgrade code and see",
    "start": "736630",
    "end": "742480"
  },
  {
    "text": "how does this encryption of the firmware upgrade actually work and after browsing",
    "start": "742480",
    "end": "749290"
  },
  {
    "text": "a bit through this decrypted from where I sure enough found fun a small file",
    "start": "749290",
    "end": "754870"
  },
  {
    "text": "called helpfully lip upgrade firmware and matza was nice enough to not remove",
    "start": "754870",
    "end": "761650"
  },
  {
    "start": "756000",
    "end": "756000"
  },
  {
    "text": "any of the symbols so we can actually find a very nice function called firmware decrypt thank you",
    "start": "761650",
    "end": "771400"
  },
  {
    "text": "and so I loaded the whole code into Ida probe to look at it and to disassemble",
    "start": "771400",
    "end": "778150"
  },
  {
    "text": "it and what you can see on the left part is that there's a lot of there are a lot",
    "start": "778150",
    "end": "784870"
  },
  {
    "text": "of X or instructions and if you see a lot of extra instructions in something it already tells you it's very highly",
    "start": "784870",
    "end": "791050"
  },
  {
    "text": "likely that there's some kind of X or decryption happening and so basically in",
    "start": "791050",
    "end": "797050"
  },
  {
    "text": "this case it loads a constant called password and it goes into this kind of",
    "start": "797050",
    "end": "803080"
  },
  {
    "text": "loop runs a lot of X or on this constant and then eventually goes out of the loop",
    "start": "803080",
    "end": "810910"
  },
  {
    "text": "and calls a function called ECB 128-bit crypt this sounds a lot like an aes",
    "start": "810910",
    "end": "817779"
  },
  {
    "text": "decryption and there's no singer a symmetric crypto anything involved so",
    "start": "817779",
    "end": "822820"
  },
  {
    "text": "that means if we can get this AES key out we cannot only decipher the current",
    "start": "822820",
    "end": "828640"
  },
  {
    "text": "firmware but we can also create new firmware because there's no a symmetric check of the firmware there's no hashing",
    "start": "828640",
    "end": "834670"
  },
  {
    "text": "there's no nothing to really prove that the firmware upgrade came from Aqsa and",
    "start": "834670",
    "end": "840150"
  },
  {
    "text": "so I went ahead and basically",
    "start": "840150",
    "end": "846220"
  },
  {
    "text": "implemented the whole the whole thing that I saw in a simpler and C and ran it",
    "start": "846220",
    "end": "851350"
  },
  {
    "text": "and sure enough we got the full password which is two 887 con 7-5 6-4 and this",
    "start": "851350",
    "end": "859630"
  },
  {
    "text": "combined with a script I called moxa decrypt allows us to decrypt the full firmware and we can run Ben walk on it",
    "start": "859630",
    "end": "867459"
  },
  {
    "text": "and sure enough we get the full decrypted firmware including all compressed ranges or squash FS file",
    "start": "867459",
    "end": "874240"
  },
  {
    "text": "systems the kernel and so on the scripts for this can be downloaded at and might",
    "start": "874240",
    "end": "881440"
  },
  {
    "text": "be tapped by the way and yeah so after I knew I can decrypt the firmware it's a",
    "start": "881440",
    "end": "887500"
  },
  {
    "text": "device I can buy everywhere on eBay it's a device that is cheap enough for me to look at and it's widely used I decided",
    "start": "887500",
    "end": "894760"
  },
  {
    "text": "to buy it and immediately open it up so inside this device we will find a freescale automotive processor which is",
    "start": "894760",
    "end": "901780"
  },
  {
    "start": "897000",
    "end": "897000"
  },
  {
    "text": "just your standard off-the-shelf processor we use in the automotive area or in the",
    "start": "901780",
    "end": "907240"
  },
  {
    "text": "industrial area and inside of the device we also find a ton of test points so for",
    "start": "907240",
    "end": "913540"
  },
  {
    "text": "example all basically all exposed pets I",
    "start": "913540",
    "end": "918850"
  },
  {
    "text": "tested them with my oscilloscope I hooked up a logic analyzer to them and try to find a serial console and sure",
    "start": "918850",
    "end": "925840"
  },
  {
    "text": "enough if we look at those port pins we have a full serial console and if we",
    "start": "925840",
    "end": "931270"
  },
  {
    "text": "connect our serial 2 years be adapted to it we get a wonderful root shell without",
    "start": "931270",
    "end": "937330"
  },
  {
    "text": "any authentication whatsoever and so at this point where we're in this great",
    "start": "937330",
    "end": "943840"
  },
  {
    "text": "position that if we get access to the hardware we have full route access and if we let's say start to write and",
    "start": "943840",
    "end": "950230"
  },
  {
    "text": "exploit we can actually debug it directly on the device which is a pretty nice situation to be in and so this is",
    "start": "950230",
    "end": "958240"
  },
  {
    "text": "not really a vulnerability this is a design decision so we need to look at all the interfaces that are available",
    "start": "958240",
    "end": "964210"
  },
  {
    "text": "for potential remote vulnerabilities because this is kind of standard and kind of boring and so yeah I looked at",
    "start": "964210",
    "end": "973120"
  },
  {
    "start": "970000",
    "end": "970000"
  },
  {
    "text": "all the available services and if you port scan this device you will see that there's a web interface there's telnet",
    "start": "973120",
    "end": "979510"
  },
  {
    "text": "SNMP some serial driver protocol and also a proprietary configuration",
    "start": "979510",
    "end": "984850"
  },
  {
    "text": "protocol running on port 4900 and I started with looking at the web",
    "start": "984850",
    "end": "990310"
  },
  {
    "text": "interface and it's really really bad so if we look at the list of",
    "start": "990310",
    "end": "995920"
  },
  {
    "text": "vulnerabilities we go from cross-site scripting in every field to cross-site request forgery to unsecure",
    "start": "995920",
    "end": "1001590"
  },
  {
    "text": "authentication to command injection to stack overflows over to a zero-day for",
    "start": "1001590",
    "end": "1007530"
  },
  {
    "text": "the web server that's publicly on there on the internet so demo time I had to",
    "start": "1007530",
    "end": "1016650"
  },
  {
    "text": "pre-record it because my SCADA hardware is stuck in US Customs",
    "start": "1016650",
    "end": "1022000"
  },
  {
    "text": "[Laughter] okay so yeah this is the web interface",
    "start": "1022000",
    "end": "1028000"
  },
  {
    "text": "and I'm just logging into the logging into it with the credentials and when",
    "start": "1028000",
    "end": "1034480"
  },
  {
    "text": "when you look in you just see the standard overview of the the system you see the model name serial number and so",
    "start": "1034480",
    "end": "1041530"
  },
  {
    "text": "on and if we go to the basic settings we see some some nice text fields and what",
    "start": "1041530",
    "end": "1047110"
  },
  {
    "text": "do we do as pentesters when we see a text field we pasted on some JavaScript",
    "start": "1047110",
    "end": "1052780"
  },
  {
    "text": "in it what else and so in this case just some alert we press apply reload the",
    "start": "1052780",
    "end": "1059590"
  },
  {
    "text": "page and we get JavaScript execution and",
    "start": "1059590",
    "end": "1064980"
  },
  {
    "text": "if there's a single thing on the page that helps you a lot about this class of devices it's that it's best viewed with",
    "start": "1064980",
    "end": "1072610"
  },
  {
    "text": "Intel Explorer five this is a firmware release in 2017 by the way so it's not",
    "start": "1072610",
    "end": "1079750"
  },
  {
    "text": "like old firmware this was like very up-to-date malarkey these are",
    "start": "1079750",
    "end": "1085360"
  },
  {
    "text": "authenticated bugs so that's kind of boring right we if we want to have real vulnerability so we want something",
    "start": "1085360",
    "end": "1091630"
  },
  {
    "text": "remote and we want something unauthenticated and so I decided to look",
    "start": "1091630",
    "end": "1096760"
  },
  {
    "start": "1095000",
    "end": "1095000"
  },
  {
    "text": "at this custom protocol that is used for firmware upgrades and my goal was to reverse-engineer it and build a phaser",
    "start": "1096760",
    "end": "1103030"
  },
  {
    "text": "the goal of a father is to basically take valid input data mutated in some",
    "start": "1103030",
    "end": "1109450"
  },
  {
    "start": "1107000",
    "end": "1107000"
  },
  {
    "text": "way send it to the device and see if it crashes and because we already got code execution on the device via the serial",
    "start": "1109450",
    "end": "1115600"
  },
  {
    "text": "interface we can also basically start",
    "start": "1115600",
    "end": "1122669"
  },
  {
    "text": "handling all these precious and immediately get great intelligence of the crashes but this turned out to not",
    "start": "1122669",
    "end": "1132549"
  },
  {
    "text": "be necessary which is while developing this father I accidentally sent too much",
    "start": "1132549",
    "end": "1137559"
  },
  {
    "text": "data to the device I basically made a small mistake in my loop my packet was too long and guess what happened when I",
    "start": "1137559",
    "end": "1144820"
  },
  {
    "text": "send a lot of ace to the device obviously stack overflow or program",
    "start": "1144820",
    "end": "1151990"
  },
  {
    "text": "counter is set to aaaa and we basically have a trivial tree Boyd stackoverflow in like a half a day",
    "start": "1151990",
    "end": "1160330"
  },
  {
    "text": "of exploit development time demo type so",
    "start": "1160330",
    "end": "1168609"
  },
  {
    "text": "I packed this whole thing into a small Python script I can just point at the IP of the device and if we run it it will",
    "start": "1168609",
    "end": "1178599"
  },
  {
    "text": "spawn a shadow on the server and we can",
    "start": "1178599",
    "end": "1183820"
  },
  {
    "text": "just use netcat to connect to it paste",
    "start": "1183820",
    "end": "1189700"
  },
  {
    "text": "the command it outputs and then you can see you name a Linux kernel to 6:31 and",
    "start": "1189700",
    "end": "1194799"
  },
  {
    "text": "we are in a true s root very easy so",
    "start": "1194799",
    "end": "1201899"
  },
  {
    "text": "obviously these bugs were reported by the vendor and some of these bugs were actually reported by different people",
    "start": "1201899",
    "end": "1208739"
  },
  {
    "text": "before on slightly different devices and so what it turns out is that if you",
    "start": "1208739",
    "end": "1216759"
  },
  {
    "text": "report back to some of these vendors that if you find a vulnerability and you",
    "start": "1216759",
    "end": "1223599"
  },
  {
    "start": "1221000",
    "end": "1221000"
  },
  {
    "text": "send it to them the vulnerability gets fixed but then there are like two five",
    "start": "1223599",
    "end": "1229479"
  },
  {
    "text": "ten different devices which almost run the same throw where which stay completely untouched so they only you",
    "start": "1229479",
    "end": "1237249"
  },
  {
    "text": "can like for example the cross-site scripting bugs were reported on acting five different devices but they are",
    "start": "1237249",
    "end": "1243249"
  },
  {
    "text": "still on some of the new firmware and so this is a whole security culture problem",
    "start": "1243249",
    "end": "1249070"
  },
  {
    "text": "from from my view and you can see this the device on the right is called the secure router or something from Aqsa and",
    "start": "1249070",
    "end": "1257109"
  },
  {
    "text": "it has the same basic box as the cheaper ones which are not from this secure",
    "start": "1257109",
    "end": "1262450"
  },
  {
    "text": "edition so basically it is yeah you can find these bugs all across the product range unfortunately so the next device I",
    "start": "1262450",
    "end": "1271869"
  },
  {
    "text": "looked at was the advantage eki 15 to 2 which is kind of a similar device it's",
    "start": "1271869",
    "end": "1278109"
  },
  {
    "text": "just a serial to ethernet device you can also get it with Wi-Fi you can get it",
    "start": "1278109",
    "end": "1283720"
  },
  {
    "text": "with GSM I think or with more Ethernet ports whatever and it's really just a",
    "start": "1283720",
    "end": "1288879"
  },
  {
    "text": "simple device and as before the first thing I did was I looked at the firmware of the device",
    "start": "1288879",
    "end": "1296560"
  },
  {
    "text": "running it through bin walk and through the entropy analysis we immediately see very low entropy some high entropy",
    "start": "1296560",
    "end": "1303380"
  },
  {
    "text": "regions so it's probably unencrypted and just compressed and we can see that didn't work even immediately detects the",
    "start": "1303380",
    "end": "1310760"
  },
  {
    "text": "linux image and so on and so forth and what's kind of interesting of looking",
    "start": "1310760",
    "end": "1316190"
  },
  {
    "text": "through the firmware is that it runs a web server called boa whose last release was in 2005 so it a device you buy in",
    "start": "1316190",
    "end": "1325630"
  },
  {
    "text": "2018 runs 13 year-old web server and the main binary found on the device that",
    "start": "1325630",
    "end": "1331850"
  },
  {
    "text": "handles all the serial communication of the web server and so on is called edge server and edge server",
    "start": "1331850",
    "end": "1337990"
  },
  {
    "start": "1337000",
    "end": "1337000"
  },
  {
    "text": "when I look at such a binary I look at calls to do what I consider dangerous",
    "start": "1337990",
    "end": "1343040"
  },
  {
    "text": "functions so for example string copies printf and system and because all this",
    "start": "1343040",
    "end": "1349910"
  },
  {
    "text": "whole system either gives me remote code execution and printf gives me buffer overflows and string copy gives me",
    "start": "1349910",
    "end": "1355910"
  },
  {
    "text": "buffer overflows so if I find lots of these I'm already pretty confident that I'll find something and this is again",
    "start": "1355910",
    "end": "1362390"
  },
  {
    "text": "before I even bought the device I looked at it and sure enough I found in the firmware a long string which looks a lot",
    "start": "1362390",
    "end": "1369920"
  },
  {
    "text": "like a mail command and you can see that there are a lot of parameters that are filled in so for example there's the",
    "start": "1369920",
    "end": "1376760"
  },
  {
    "text": "person s will insert a string of arbitrary length and so on and this is from from my interpretation at the time",
    "start": "1376760",
    "end": "1383900"
  },
  {
    "text": "this was the alert mail system so if you have a failed authentication this will send you an email with the details and",
    "start": "1383900",
    "end": "1389540"
  },
  {
    "text": "if we look at where this string is used it's used as an argument to printf which",
    "start": "1389540",
    "end": "1396380"
  },
  {
    "text": "first doesn't check buffer sizes so if we manage to put in a very long string it will overflow the buffer and then",
    "start": "1396380",
    "end": "1403730"
  },
  {
    "text": "after the call to printf it actually will call system so if we managed to insert anything into the male",
    "start": "1403730",
    "end": "1411860"
  },
  {
    "text": "subject for example the username with which we fail the authentication we will get remote code execution very easily",
    "start": "1411860",
    "end": "1419960"
  },
  {
    "text": "before we even bought the device so at this point I again decided to go",
    "start": "1419960",
    "end": "1427250"
  },
  {
    "start": "1427000",
    "end": "1427000"
  },
  {
    "text": "on eBay find the device buy it and the fun part here was that I first bought a device which was slightly older",
    "start": "1427250",
    "end": "1434000"
  },
  {
    "text": "where this mail functionality was broken so the back was there that the mail system was broken for whatever reason",
    "start": "1434000",
    "end": "1440510"
  },
  {
    "text": "and acknowledged by advantage that is was it was broken and try to buy yet",
    "start": "1440510",
    "end": "1445549"
  },
  {
    "text": "another device on which the functionality actually worked so okay so",
    "start": "1445549",
    "end": "1450860"
  },
  {
    "text": "I looked inside I checked all the pets and again for sure there was a serial console as root without any",
    "start": "1450860",
    "end": "1457910"
  },
  {
    "text": "authentication and again they give you the filesystem and so on and these",
    "start": "1457910",
    "end": "1462950"
  },
  {
    "text": "devices are not read-only like if you change something on the file for example you can buy it on only from a",
    "start": "1462950",
    "end": "1469700"
  },
  {
    "text": "distributor you can modify the device via the serial console send it back they will happily resell it we've tried that",
    "start": "1469700",
    "end": "1476780"
  },
  {
    "text": "with the allowance of a distributor that you we basically got a device from them modified it by creating a file sending",
    "start": "1476780",
    "end": "1484100"
  },
  {
    "text": "it back and ordered it again and for sure we got the same device precisely again with our modifications so we",
    "start": "1484100",
    "end": "1489770"
  },
  {
    "text": "actually have supply chain issues because of these serial consoles and because there's no way to actually",
    "start": "1489770",
    "end": "1495370"
  },
  {
    "text": "authenticate the device and check whether it's been tampered with or not so again how do we find vulnerabilities",
    "start": "1495370",
    "end": "1503390"
  },
  {
    "start": "1501000",
    "end": "1501000"
  },
  {
    "text": "we have a web interface we have a proprietary configuration protocol yet",
    "start": "1503390",
    "end": "1508490"
  },
  {
    "text": "again we have telnet we have SNMP and again a custom serial driver protocol and again I started with a web interface",
    "start": "1508490",
    "end": "1516500"
  },
  {
    "text": "and again we find cross-site scripting cross-site request forgery command",
    "start": "1516500",
    "end": "1522470"
  },
  {
    "text": "injection everything and even broken authentication and this is kind of a fun back because if you unlock the admin",
    "start": "1522470",
    "end": "1530210"
  },
  {
    "text": "interface from one computer it somehow unlocks it for everyone so you login",
    "start": "1530210",
    "end": "1536540"
  },
  {
    "text": "from computer a and everyone else can also log in without any password or so I don't know how how that can work but",
    "start": "1536540",
    "end": "1543320"
  },
  {
    "text": "yeah and then we also have a stack overflow again in an other protocol which we're going to look at in a second",
    "start": "1543320",
    "end": "1549530"
  },
  {
    "text": "but first let's look at the web interface again",
    "start": "1549530",
    "end": "1554230"
  },
  {
    "text": "so we lock into the web interface again with default credentials by the way if",
    "start": "1555850",
    "end": "1561920"
  },
  {
    "text": "you ever do a scatter pen test 50% of the time the default passwords will work I don't know",
    "start": "1561920",
    "end": "1568370"
  },
  {
    "text": "and in this case we can go to the system configuration we have a nice device description field we enter some",
    "start": "1568370",
    "end": "1574850"
  },
  {
    "text": "JavaScript in it we save it and we reload the page and again we get a",
    "start": "1574850",
    "end": "1580820"
  },
  {
    "text": "JavaScript alert so again trivial that vulnerabilities in a an up-to-date",
    "start": "1580820",
    "end": "1586340"
  },
  {
    "text": "device yeah good",
    "start": "1586340",
    "end": "1592150"
  },
  {
    "text": "but that vulnerabilities are kind of boring so let's write an exploit for the",
    "start": "1592150",
    "end": "1597440"
  },
  {
    "text": "stack overflow again because we have gdb we can we have serial console we can install gdb we can just divide our",
    "start": "1597440",
    "end": "1603740"
  },
  {
    "text": "exploit it's very trivial to write once you have the stack overflow and so for sure I again through the Python tool",
    "start": "1603740",
    "end": "1612279"
  },
  {
    "text": "which just takes the IP sponsor shell on the device and you can just use netcat",
    "start": "1612340",
    "end": "1618320"
  },
  {
    "text": "to connect to it and you see again it's like a an old Linux - 631 built in I",
    "start": "1618320",
    "end": "1624440"
  },
  {
    "text": "believe 2017 and we are logged in as root remotely and this is because all these services the edge server the web",
    "start": "1624440",
    "end": "1630920"
  },
  {
    "text": "server everything runs on s root on all these devices so there's really no no",
    "start": "1630920",
    "end": "1637570"
  },
  {
    "text": "permission system or anything everything runs as root everything runs on outdated",
    "start": "1637570",
    "end": "1642980"
  },
  {
    "text": "Linux kernels everything runs on outdated web service and if any of those components fail your root on the machine",
    "start": "1642980",
    "end": "1652330"
  },
  {
    "text": "so let's look at lunch 1x devices so this device is called and tronic CGS",
    "start": "1652780",
    "end": "1660640"
  },
  {
    "text": "2100 and it's a simple serial device server",
    "start": "1660640",
    "end": "1665780"
  },
  {
    "text": "it has two Ethernet ports and it as the only device in this talk it doesn't come with Linux so I used something called",
    "start": "1665780",
    "end": "1672980"
  },
  {
    "text": "evolution OS on it I have no clue what evolution has actually consists of and",
    "start": "1672980",
    "end": "1679090"
  },
  {
    "text": "yeah I looked at the firmware of it and it's it was unencrypted yeah again and",
    "start": "1679090",
    "end": "1684910"
  },
  {
    "start": "1683000",
    "end": "1683000"
  },
  {
    "text": "using the cold fire protector when cold fire I've never worked with it it's pretty hard to find",
    "start": "1684910",
    "end": "1690570"
  },
  {
    "text": "a good disassembler for it so this was for sure going to be interesting and I also no obvious external software",
    "start": "1690570",
    "end": "1696960"
  },
  {
    "text": "components like if you look in the firmware there's no open SSL there's no nothing you really know or can research",
    "start": "1696960",
    "end": "1702870"
  },
  {
    "text": "it's pretty much all proprietary from what I could tell or purchased in from",
    "start": "1702870",
    "end": "1708000"
  },
  {
    "text": "third parties and so I decided to still buy it and give it a spin and bought the",
    "start": "1708000",
    "end": "1713370"
  },
  {
    "text": "device and for the first time the I couldn't find the serial console there's something that looks like a debug port",
    "start": "1713370",
    "end": "1719310"
  },
  {
    "text": "but I could not get it to to debug or give me any serial console or anything at all I don't even know to be honest",
    "start": "1719310",
    "end": "1725880"
  },
  {
    "text": "whether evolution West even has a command line or anything I have no clue and so this made this device much harder",
    "start": "1725880",
    "end": "1733950"
  },
  {
    "text": "to look at right because you have to still have that interface you have a telnet which runs with custom with with",
    "start": "1733950",
    "end": "1741660"
  },
  {
    "start": "1736000",
    "end": "1736000"
  },
  {
    "text": "a custom menu basically and you have SSL SSH FTP TFTP and this device was the",
    "start": "1741660",
    "end": "1747810"
  },
  {
    "text": "first one to really have strong security configuration options at least there's a",
    "start": "1747810",
    "end": "1753330"
  },
  {
    "text": "guide on how to really configure it securely on what to do on what not to do and the web interface was also a bit",
    "start": "1753330",
    "end": "1760200"
  },
  {
    "text": "more more stable and so I found just found cross-site request forgery a",
    "start": "1760200",
    "end": "1766170"
  },
  {
    "start": "1762000",
    "end": "1762000"
  },
  {
    "text": "configuration injection and also an authentication bypass no code execution or anything just because it doesn't look",
    "start": "1766170",
    "end": "1772920"
  },
  {
    "text": "like the system actually is executing commands or anything in the shell because it's custom so demo time I set a",
    "start": "1772920",
    "end": "1782100"
  },
  {
    "text": "device authentication bypass in this case if you look at the device it",
    "start": "1782100",
    "end": "1787580"
  },
  {
    "text": "requires a password we don't know it and so I wrote a small tool which is the",
    "start": "1787580",
    "end": "1794520"
  },
  {
    "text": "video running yes which I called LAN Tronics form and if we reload the site",
    "start": "1794520",
    "end": "1804770"
  },
  {
    "text": "just press console we're in so we got a nice authentication bypass because of a back-end of app server so device three",
    "start": "1805310",
    "end": "1812790"
  },
  {
    "text": "broken basically the next one I looked",
    "start": "1812790",
    "end": "1818040"
  },
  {
    "text": "at actually was the Schneider device PAH logic egx 100 which is an Ethernet",
    "start": "1818040",
    "end": "1823950"
  },
  {
    "text": "to Modbus gateway and Modbus is used a lot in in ICS applications and again we",
    "start": "1823950",
    "end": "1833310"
  },
  {
    "start": "1826000",
    "end": "1826000"
  },
  {
    "text": "had trivial back vulnerabilities this unfortunately is the last device I bought and so I'm not fully yet through",
    "start": "1833310",
    "end": "1839310"
  },
  {
    "text": "the vulnerability disclosure process so I cannot demoed this yet but I can tell",
    "start": "1839310",
    "end": "1844680"
  },
  {
    "text": "you that you will find this device a lot in the wild and there are a lot of very very funny issues in it so hopefully",
    "start": "1844680",
    "end": "1851520"
  },
  {
    "text": "soon then kind of a different gateway at",
    "start": "1851520",
    "end": "1857550"
  },
  {
    "text": "the beginning of the target my shoulder all the different rated protocols they use in the wild in the industrial IOT",
    "start": "1857550",
    "end": "1864210"
  },
  {
    "text": "field and at one penetration test I found this GE MVS system so this is a",
    "start": "1864210",
    "end": "1870030"
  },
  {
    "text": "custom a proprietary radio solution for basically connecting serial devices or",
    "start": "1870030",
    "end": "1876210"
  },
  {
    "text": "even a devices via RF so we had custom radio you need license spectrum to use",
    "start": "1876210",
    "end": "1881940"
  },
  {
    "text": "it so for example if you are an electric grid provider whatever then you need to",
    "start": "1881940",
    "end": "1888060"
  },
  {
    "text": "go to the state license the the radio band and then you can use it and you",
    "start": "1888060",
    "end": "1895520"
  },
  {
    "text": "it has optional encryption on the old devices you actually have to buy a",
    "start": "1895520",
    "end": "1900750"
  },
  {
    "text": "special box to enable encryption and on the new ones it's integrated and it's",
    "start": "1900750",
    "end": "1905910"
  },
  {
    "text": "used a lot on electric grids and also a lot on water damage systems so on remote",
    "start": "1905910",
    "end": "1911310"
  },
  {
    "text": "water dams they use this kind of proprietary radio and if we look inside",
    "start": "1911310",
    "end": "1917160"
  },
  {
    "text": "of this device we we can see that some of them contain a compute module or they",
    "start": "1917160",
    "end": "1922680"
  },
  {
    "text": "contain or they contain a flash that you can read out and the flash is not",
    "start": "1922680",
    "end": "1928680"
  },
  {
    "text": "encrypted so you can read out the encryption key from the flash and because the whole system is based on a",
    "start": "1928680",
    "end": "1934830"
  },
  {
    "text": "pre-shared key if you only a single device of these you actually own the",
    "start": "1934830",
    "end": "1940410"
  },
  {
    "text": "entire network so we have a key extraction attack which allows full decryption of the traffic with these",
    "start": "1940410",
    "end": "1946050"
  },
  {
    "text": "devices and I've also got a new radio module coming up soon hopefully so I reversed and",
    "start": "1946050",
    "end": "1952880"
  },
  {
    "text": "the whole radio protocol which is a qualm based protocol and so hopefully",
    "start": "1952880",
    "end": "1958280"
  },
  {
    "text": "soon we'll have that on github and yeah broken too unfortunately so what's the",
    "start": "1958280",
    "end": "1966740"
  },
  {
    "text": "answer obviously let's use VPN but then if you look at the VPN stacks of all",
    "start": "1966740",
    "end": "1972320"
  },
  {
    "text": "these devices you will want to cry you have broken Eike parses you have bad",
    "start": "1972320",
    "end": "1979610"
  },
  {
    "start": "1976000",
    "end": "1976000"
  },
  {
    "text": "crypto support you have SSL issues and on one device I enabled VPN for",
    "start": "1979610",
    "end": "1984830"
  },
  {
    "text": "everything and then the configuration part was still exposed without VPN and I",
    "start": "1984830",
    "end": "1990650"
  },
  {
    "text": "sent the vendor an email said hey guys how the hell do I turn this up and the",
    "start": "1990650",
    "end": "1996800"
  },
  {
    "text": "answer's no no we need this in case the VPN fails thank you yeah so before we",
    "start": "1996800",
    "end": "2008620"
  },
  {
    "text": "finish some other devices are even worse like I looked at some vendors but I",
    "start": "2008620",
    "end": "2014890"
  },
  {
    "start": "2014000",
    "end": "2014000"
  },
  {
    "text": "don't want you to get the impression that the others are better necessarily quite some devices that are out there",
    "start": "2014890",
    "end": "2020770"
  },
  {
    "text": "run across which is like a real-time operating system which had its last",
    "start": "2020770",
    "end": "2025870"
  },
  {
    "text": "release nine years ago no memory protection whatsoever no threat separation nothing some devices run",
    "start": "2025870",
    "end": "2033910"
  },
  {
    "text": "linux 2.4 that you can buy today and they still ship software updates I",
    "start": "2033910",
    "end": "2039310"
  },
  {
    "text": "imagine they have like a very old computer somewhere in the closet where they go to build a new software release",
    "start": "2039310",
    "end": "2045310"
  },
  {
    "text": "for this I don't know and some others even have unfixed public vulnerabilities and for example you can find a lot of",
    "start": "2045310",
    "end": "2051580"
  },
  {
    "text": "cheaper serial to Ethernet gateways on ebay from they all look the same but they all come from different vendors so",
    "start": "2051580",
    "end": "2058060"
  },
  {
    "text": "I guess it's just some ODM situation and this thing even has backdoor ssh accounts if you see a console it you can",
    "start": "2058060",
    "end": "2065440"
  },
  {
    "text": "see that there are backdoor accounts everywhere around it so we really have",
    "start": "2065440",
    "end": "2071470"
  },
  {
    "text": "an issue so to summarize shits on fire",
    "start": "2071470",
    "end": "2076770"
  },
  {
    "start": "2074000",
    "end": "2074000"
  },
  {
    "text": "we have no integrity protections on any of the devices like we literally cannot",
    "start": "2080159",
    "end": "2086290"
  },
  {
    "text": "ensure that the device has not been tampered with or supplies original firmware and for example if you look at",
    "start": "2086290",
    "end": "2092440"
  },
  {
    "text": "the firmware download portals they are crazy insecure two of them for example on Schneider we had trivial cross-site",
    "start": "2092440",
    "end": "2098980"
  },
  {
    "text": "scripting which can be used for phishing attacks so you can just send somebody an official Schneider link and provide your",
    "start": "2098980",
    "end": "2104890"
  },
  {
    "text": "own firmware we have no agitation functionality no security mitigation so",
    "start": "2104890",
    "end": "2110140"
  },
  {
    "text": "if you look at it there's no a SLR there's no annex there's no it's like exploiting in the 90s really it's and",
    "start": "2110140",
    "end": "2116369"
  },
  {
    "text": "from my perspective there's also unfortunately not really a security",
    "start": "2116369",
    "end": "2121599"
  },
  {
    "text": "culture with a lot of these vendors not all of them I actually after I first talked about these devices a lot of",
    "start": "2121599",
    "end": "2128740"
  },
  {
    "text": "vendors including moxa contacted me and were very nice and very engaging in the",
    "start": "2128740",
    "end": "2134020"
  },
  {
    "text": "whole process but yeah I still think these are big issues so with that thank",
    "start": "2134020",
    "end": "2139750"
  },
  {
    "text": "you very much for coming and I hope you enjoyed this talk [Applause]",
    "start": "2139750",
    "end": "2151849"
  }
]