[
  {
    "text": "so this is our this is the title of our talk that we are going to do today dude what the in my can we did a",
    "start": "80",
    "end": "8639"
  },
  {
    "text": "similar talk in defcon last year but uh in that in that talk in the delphi",
    "start": "8639",
    "end": "14240"
  },
  {
    "text": "defcon talk we were more focused in the caline protocol",
    "start": "14240",
    "end": "19279"
  },
  {
    "text": "okay in that case we're going to be completely focused in the canbus protocol that is used within the the cars",
    "start": "19279",
    "end": "26800"
  },
  {
    "text": "nowadays so first of all",
    "start": "26800",
    "end": "32719"
  },
  {
    "text": "typical slides about introducing ourselves who are we okay so here's javier",
    "start": "32719",
    "end": "39680"
  },
  {
    "text": "we are from spain that's the strange thing that you can notice in my accent",
    "start": "39680",
    "end": "45840"
  },
  {
    "text": "so uh yeah he's a hardware security specialist and he loves breaking toys he's all the",
    "start": "45840",
    "end": "53920"
  },
  {
    "text": "day with the dirty hands with all this toys around him and",
    "start": "53920",
    "end": "59520"
  },
  {
    "text": "yeah there is no day that i don't speak with him and he said oh alberto i found a new thing in this new device",
    "start": "59520",
    "end": "65760"
  },
  {
    "text": "and blah blah blah blah blah so yeah he's  crazy of and he's from",
    "start": "65760",
    "end": "72960"
  },
  {
    "text": "cadiz have you ever been in spain someone of you yeah okay why are you here instead of",
    "start": "72960",
    "end": "79119"
  },
  {
    "text": "being in spain right now so caddis is in the south of spain really really south of spain",
    "start": "79119",
    "end": "85200"
  },
  {
    "text": "and yeah they have great parties actually",
    "start": "85200",
    "end": "91360"
  },
  {
    "text": "and i am alberto and i'm a pen tester",
    "start": "91759",
    "end": "98960"
  },
  {
    "text": "i work for a huge for a big company cloud company so yeah most of my time i",
    "start": "98960",
    "end": "106479"
  },
  {
    "text": "work in a red team so my day-to-day is very offensive and i",
    "start": "106479",
    "end": "111520"
  },
  {
    "text": "love breaking everything hardware software i like reversing i like this either",
    "start": "111520",
    "end": "118880"
  },
  {
    "text": "that is my girlfriend so yeah i like this kind of things",
    "start": "118880",
    "end": "124560"
  },
  {
    "text": "so have you seen where we are right now where have you have you stayed in the",
    "start": "124560",
    "end": "131120"
  },
  {
    "text": "swimming pool have you been in the swimming pool who have been in the swimming pool already",
    "start": "131120",
    "end": "137360"
  },
  {
    "text": "only so okay so that's my question for you today if you know that this is the swimming",
    "start": "137760",
    "end": "144560"
  },
  {
    "text": "pool that we have just going through the elevator why are you here i mean",
    "start": "144560",
    "end": "153200"
  },
  {
    "text": "really so why are you here today right now instead of being in the swimming pool and with this",
    "start": "153200",
    "end": "160480"
  },
  {
    "text": "brilliant girls okay so",
    "start": "160480",
    "end": "165760"
  },
  {
    "text": "that's the okay cool that's the um the index those are the",
    "start": "165920",
    "end": "171920"
  },
  {
    "text": "topics that we're going to speak about today we're going to just do a small remind about kaline",
    "start": "171920",
    "end": "178560"
  },
  {
    "text": "and we're going to speak about what is the common things that we can buy today very i mean",
    "start": "178560",
    "end": "185840"
  },
  {
    "text": "not not cheap not cheap at all but we can buy some hardware to interact with our car",
    "start": "185840",
    "end": "192560"
  },
  {
    "text": "so we can do some stuff but for us that was not enough right so we",
    "start": "192560",
    "end": "198000"
  },
  {
    "text": "just wanted to do something cheaper very cheaper very cheap sorry",
    "start": "198000",
    "end": "203599"
  },
  {
    "text": "and um being able to exploit as much as possible i mean",
    "start": "203599",
    "end": "210159"
  },
  {
    "text": "speaking against the network itself not like just some parts of the car so",
    "start": "210159",
    "end": "217440"
  },
  {
    "text": "we we developed uh we made a piece of hardware that we have right here it is called",
    "start": "217440",
    "end": "224840"
  },
  {
    "text": "chd car hacking tool yeah it's not very original i know but",
    "start": "224840",
    "end": "231440"
  },
  {
    "text": "yeah we will speak about it what are the features that we have how can we speak directly with the with",
    "start": "231440",
    "end": "237519"
  },
  {
    "text": "the campus network and everything one of the most important things",
    "start": "237519",
    "end": "242560"
  },
  {
    "text": "in my opinion at least is the statistical analysis because we will see later but each car",
    "start": "242560",
    "end": "248480"
  },
  {
    "text": "is a different world it's a completely different world even being the same brand even using the same",
    "start": "248480",
    "end": "254080"
  },
  {
    "text": "brand of cars it's going to be diff it's going to be completely different the packets that the car sent",
    "start": "254080",
    "end": "259280"
  },
  {
    "text": "the ecu sends between within the campus network are completely different even",
    "start": "259280",
    "end": "265919"
  },
  {
    "text": "being the same model but different year the packets are different so that's something we have to deal",
    "start": "265919",
    "end": "272639"
  },
  {
    "text": "about and we did we figured out some kind of statistical",
    "start": "272639",
    "end": "277919"
  },
  {
    "text": "analysis to just go through it yeah we did um kind of attack take over we",
    "start": "277919",
    "end": "284560"
  },
  {
    "text": "called takeover to you we'll see you later and we are going to speak some car forensics",
    "start": "284560",
    "end": "290880"
  },
  {
    "text": "uh yeah i have this windows here but i'm used to look yeah okay yeah um",
    "start": "290880",
    "end": "298080"
  },
  {
    "text": "this is the typical picture that everybody use when it's gonna speak about ecu's so",
    "start": "298080",
    "end": "304400"
  },
  {
    "text": "basically uh all the cars are like a subnet of easy use it's like our car our",
    "start": "304400",
    "end": "310960"
  },
  {
    "text": "house our office that we have different devices connected to a gateway or something",
    "start": "310960",
    "end": "316400"
  },
  {
    "text": "in that case the devices are connected it's a broadcast uh network okay so yeah there are",
    "start": "316400",
    "end": "323199"
  },
  {
    "text": "tons of different ecu's within a car a lot of different ecu's all the easy user sending packets most of the",
    "start": "323199",
    "end": "330800"
  },
  {
    "text": "time like eve even all the milliseconds every millisecond we're gonna have some ecu sending a bunch of packets that",
    "start": "330800",
    "end": "339120"
  },
  {
    "text": "we want to interpret we want to know what these packets do and just try to do something with them",
    "start": "339120",
    "end": "345360"
  },
  {
    "text": "that we will see okay so uh",
    "start": "345360",
    "end": "352800"
  },
  {
    "text": "now about the ecu's themselves uh it is common that they have a set of unique",
    "start": "352800",
    "end": "358080"
  },
  {
    "text": "ids uds are usually attached on the can bus not on k line not to a",
    "start": "358080",
    "end": "364840"
  },
  {
    "text": "specific issue but to a function that we could say an id is broadcasting the current engine",
    "start": "364840",
    "end": "373360"
  },
  {
    "text": "rpms another is broadcasting the speed so maybe some data there are requests so",
    "start": "373360",
    "end": "380319"
  },
  {
    "text": "there is a unique id for each uh we'll call it like a type of data service request",
    "start": "380319",
    "end": "388000"
  },
  {
    "text": "sometimes it's shared between ecu's but this is just for the canvas since we can have a same request from",
    "start": "388000",
    "end": "395360"
  },
  {
    "text": "different ecu's um then when we talk about security uh",
    "start": "395360",
    "end": "400479"
  },
  {
    "text": "to modify the firmware on them usually if you want to do it the legit way uh they have uh some authentication",
    "start": "400479",
    "end": "407039"
  },
  {
    "text": "method a seed key to prevent the unauthorized manipulation",
    "start": "407039",
    "end": "412720"
  },
  {
    "text": "of the firmware and most of the times they have some diagnostics data stored",
    "start": "412720",
    "end": "419360"
  },
  {
    "text": "in them sometimes in their pro sometimes in the flash either for diagnosis or",
    "start": "419360",
    "end": "427759"
  },
  {
    "text": "just for determining how the behavior of that ecu depending on which",
    "start": "429039",
    "end": "434400"
  },
  {
    "text": "one is should be like then uh just a quick thing we talked",
    "start": "434400",
    "end": "442479"
  },
  {
    "text": "about the differences between compass and k-line k-lang is mainly diagnostics oriented so not",
    "start": "442479",
    "end": "447680"
  },
  {
    "text": "much or any data at all is being broadcasted on it it's cheap it works on 12 volts it's",
    "start": "447680",
    "end": "453759"
  },
  {
    "text": "basically a new word but level shifted to 12 bus due to the length of the wires the speed is usually 250 can reach that",
    "start": "453759",
    "end": "462240"
  },
  {
    "text": "but it's lower most of the times 250 would be like some bench so i mean like taking the ecu out of the",
    "start": "462240",
    "end": "468720"
  },
  {
    "text": "car itself but the can bus well actually it was",
    "start": "468720",
    "end": "474400"
  },
  {
    "text": "discontinued somewhere around 2010 uh i stopped seeing it on the cars just",
    "start": "474400",
    "end": "480560"
  },
  {
    "text": "the canvas was there so compass is really old it's nothing new i think it's from the 80s",
    "start": "480560",
    "end": "485599"
  },
  {
    "text": "indeed but they call it like the future technology that's okay",
    "start": "485599",
    "end": "490879"
  },
  {
    "text": "speed should be higher like one megabit per second actually it's slower because there are lots of uh",
    "start": "491360",
    "end": "497520"
  },
  {
    "text": "ecu's broadcast in there so it gets quite slower when you want to do some heavy communicating",
    "start": "497520",
    "end": "503599"
  },
  {
    "text": "the frame length the payload is just eight bits where k length was up to two for",
    "start": "503599",
    "end": "508639"
  },
  {
    "text": "54 bits bytes sorry so still you need to send more frames to",
    "start": "508639",
    "end": "514959"
  },
  {
    "text": "get the thing so it's it's better for the noise immunity stuff but it's not",
    "start": "514959",
    "end": "520000"
  },
  {
    "text": "good for the speed and well we said on devcon that it requires pensive handware",
    "start": "520000",
    "end": "526959"
  },
  {
    "text": "not anymore so maybe you have seen this somewhere",
    "start": "526959",
    "end": "534480"
  },
  {
    "text": "this was the subject of our talk uh defcon and at blackhead arsenal as well in",
    "start": "534480",
    "end": "539760"
  },
  {
    "text": "vegas this is the ecu too we've been further developing some features for it",
    "start": "539760",
    "end": "545519"
  },
  {
    "text": "it started as a static firmware and we developed a library for the klan we added some functions",
    "start": "545519",
    "end": "553360"
  },
  {
    "text": "basically what could be done with the main firmware but now you can just make your own",
    "start": "553360",
    "end": "559920"
  },
  {
    "text": "custom firmware using the calls in that library and we are updating it since we are using it for",
    "start": "559920",
    "end": "565519"
  },
  {
    "text": "developing the main firmware for it for free we will give you the",
    "start": "565519",
    "end": "572640"
  },
  {
    "text": "link for that so okay so back to can data uh",
    "start": "572640",
    "end": "580800"
  },
  {
    "text": "as alberto was saying earlier uh you know people say like yeah can data",
    "start": "580800",
    "end": "586160"
  },
  {
    "text": "is like yeah so we see you just attached to it it's like you are well actually each car even the same",
    "start": "586160",
    "end": "591920"
  },
  {
    "text": "model from different years have uh different ways of parsing the data i mean uh it is not",
    "start": "591920",
    "end": "599040"
  },
  {
    "text": "a structure the same way so you cannot like say yeah i can read canvas data yeah you can read the",
    "start": "599040",
    "end": "604880"
  },
  {
    "text": "up to level two but you cannot really parse the data in all the cars so it's not that universal then uh",
    "start": "604880",
    "end": "612640"
  },
  {
    "text": "well it is as well wrongly stated that can data is plain it's not like you can attach to",
    "start": "612640",
    "end": "618480"
  },
  {
    "text": "it and you can read like a speed and two points and then the speed that's that's what i consider playing so",
    "start": "618480",
    "end": "624800"
  },
  {
    "text": "it's not really playing it needs to be passed still i'm parsing it it's different even",
    "start": "624800",
    "end": "629920"
  },
  {
    "text": "from same models different years so it's might not be encrypted but it's",
    "start": "629920",
    "end": "635279"
  },
  {
    "text": "still not playing and as well khan is so secure or whatever",
    "start": "635279",
    "end": "640480"
  },
  {
    "text": "and it's just an oc level one and two how can it be secure it's just you know there's no security",
    "start": "640480",
    "end": "645680"
  },
  {
    "text": "there security should be implemented by the manufacturer itself so it's like saying tcpip is safe",
    "start": "645680",
    "end": "652240"
  },
  {
    "text": "it's nonsense and now this is according to our",
    "start": "652240",
    "end": "659120"
  },
  {
    "text": "experience uh we'll call like there are three kinds of frames inside uh",
    "start": "659120",
    "end": "665680"
  },
  {
    "text": "that goes inside the networks and we'll call them diagnosis frames that are usually generated by",
    "start": "665680",
    "end": "672079"
  },
  {
    "text": "some diagnosis equipment and they can trigger some functions",
    "start": "672079",
    "end": "677760"
  },
  {
    "text": "that usually would not happen in a normal environment inside the car like if you're gonna test for example",
    "start": "677760",
    "end": "683920"
  },
  {
    "text": "the brakes individually you would be it would be possible to",
    "start": "683920",
    "end": "689120"
  },
  {
    "text": "turn on an individual brake on one wheel or if you want to test the steering wheel it should be possible to move the",
    "start": "689120",
    "end": "695279"
  },
  {
    "text": "steering wheel that's diagnostics but usually well usually you know if it's diagnosis",
    "start": "695279",
    "end": "701200"
  },
  {
    "text": "it does not exist within the car itself i mean if you don't have the tool there's no way you're going to get those",
    "start": "701200",
    "end": "706720"
  },
  {
    "text": "packets those commands then uh system commands basically",
    "start": "706720",
    "end": "712240"
  },
  {
    "text": "they're the ones that are uh generated uh by another ecu i mean like you want to open your car",
    "start": "712240",
    "end": "719120"
  },
  {
    "text": "you push the remote then uh whatever module we say like okay",
    "start": "719120",
    "end": "724639"
  },
  {
    "text": "i got the request so the lights should turn on that module is sending that frame that",
    "start": "724639",
    "end": "730240"
  },
  {
    "text": "frame would be a system frame because it was not triggered by the user itself but it was triggered by another module",
    "start": "730240",
    "end": "736240"
  },
  {
    "text": "as a consequence for another action so sometimes uh these system commands are the same as the user",
    "start": "736240",
    "end": "743200"
  },
  {
    "text": "once i will talk now or even diagnosis but not every time",
    "start": "743200",
    "end": "748720"
  },
  {
    "text": "then user commands that's uh pretty straight like you push a button then someone you get the request it will",
    "start": "748720",
    "end": "755040"
  },
  {
    "text": "broadcast the command for that request",
    "start": "755040",
    "end": "759839"
  },
  {
    "text": "now uh elm327 that's the most commonly used ic for",
    "start": "760240",
    "end": "767279"
  },
  {
    "text": "diagnosis it's like you can find it on ebay for 10 euros stuff like that",
    "start": "767279",
    "end": "772480"
  },
  {
    "text": "it supports a lot of uh protocols like yeah the can kwp even the pills with",
    "start": "772480",
    "end": "778560"
  },
  {
    "text": "modulation which is used on zonal cars so and it's handled by 80 commands i mean",
    "start": "778560",
    "end": "784959"
  },
  {
    "text": "serial that it's easy to implement so",
    "start": "784959",
    "end": "790320"
  },
  {
    "text": "it allows use of an enhanced diagnosis which gives you access to some security",
    "start": "790320",
    "end": "795519"
  },
  {
    "text": "features that's good as well yeah it works on 80 easy to use",
    "start": "795519",
    "end": "801519"
  },
  {
    "text": "but actually i will show it again check the speeds for the canvas just a",
    "start": "801519",
    "end": "808480"
  },
  {
    "text": "standard standard id but 500 kilobyte or 250 kilobyte",
    "start": "808480",
    "end": "813680"
  },
  {
    "text": "so what happens if you want 125 like for example i've seen",
    "start": "813680",
    "end": "818959"
  },
  {
    "text": "on some internal can buses for framework for body what happens with that you cannot use",
    "start": "818959",
    "end": "824399"
  },
  {
    "text": "that or what happens if you have some 800 kilobyte you cannot use it if you need to do",
    "start": "824399",
    "end": "830320"
  },
  {
    "text": "something else you can't so the chd what is it it says somehow we're",
    "start": "830320",
    "end": "838320"
  },
  {
    "text": "based on the arduino mini pro that gets attached to any can bus any speed",
    "start": "838320",
    "end": "844480"
  },
  {
    "text": "the hardware we have brought here is alpha which means it's like uh",
    "start": "844480",
    "end": "849920"
  },
  {
    "text": "so-so looking pcb it's sleep we're always adding new stuff taking other stuff out",
    "start": "849920",
    "end": "856560"
  },
  {
    "text": "so we need it to be a field thing",
    "start": "856560",
    "end": "861199"
  },
  {
    "text": "this is actually how it looks i guess some of you might have seen that photo already but we will see the pcb leave in a few",
    "start": "861839",
    "end": "868839"
  },
  {
    "text": "minutes this is actually a board that is being",
    "start": "868839",
    "end": "874000"
  },
  {
    "text": "developed it supports gsm so you can see the difference in the size when you put everything together in a two layer pcb",
    "start": "874000",
    "end": "881199"
  },
  {
    "text": "it gets way smaller and we will talk it in a few minutes",
    "start": "881199",
    "end": "887920"
  },
  {
    "text": "about it in a few minutes as well we are even developing another board that has uh in system firmware update",
    "start": "887920",
    "end": "893600"
  },
  {
    "text": "capabilities so you can just attach the device to whatever forget about it then you",
    "start": "893600",
    "end": "901199"
  },
  {
    "text": "develop the framework you want for it and you can upload it remotely i mean we're using a one euro",
    "start": "901199",
    "end": "907680"
  },
  {
    "text": "microcontroller with a remote update for finger so",
    "start": "907680",
    "end": "913839"
  },
  {
    "text": "what does it do well it has some menus we will see as well briefly",
    "start": "914320",
    "end": "919600"
  },
  {
    "text": "in a while so you can set up completely all the features of the canvas interface",
    "start": "919600",
    "end": "926240"
  },
  {
    "text": "it has memory for the options so you don't have to set it up on every startup",
    "start": "926240",
    "end": "932560"
  },
  {
    "text": "well that was obvious it can capture and get canvas",
    "start": "934079",
    "end": "939199"
  },
  {
    "text": "and data when the bus is full at 500 kilowatt bits per second i mean like inter frame",
    "start": "939199",
    "end": "945759"
  },
  {
    "text": "space is the minimum which is like 32 milliseconds if i recall it right",
    "start": "945759",
    "end": "951759"
  },
  {
    "text": "it gets 92 percent of the data that is in the bus which is still good",
    "start": "951759",
    "end": "959360"
  },
  {
    "text": "it can inject errors and manipulate the frames on real time",
    "start": "961199",
    "end": "968399"
  },
  {
    "text": "it can generate an active ids report which means basically that we can see some uh what ideas are broadcasting not",
    "start": "968399",
    "end": "975519"
  },
  {
    "text": "one-time ids for that we use another method",
    "start": "975519",
    "end": "980720"
  },
  {
    "text": "it can perform a really basic analysis of the data that is being transmitted on the bus like uh if",
    "start": "980800",
    "end": "987360"
  },
  {
    "text": "the what's the length of the payload if it's dynamic static it can store locks",
    "start": "987360",
    "end": "994880"
  },
  {
    "text": "that then can be sent to a back-end for some more advanced uh analysis that alberto will talk about",
    "start": "994880",
    "end": "1001600"
  },
  {
    "text": "in a few minutes yeah and uh with additional hardware",
    "start": "1001600",
    "end": "1006800"
  },
  {
    "text": "which is like nothing we will talk about it later you can just update the firmware in fields so you can add new stuff like have",
    "start": "1006800",
    "end": "1013600"
  },
  {
    "text": "different frameworks if you run out of space it's really flexible",
    "start": "1013600",
    "end": "1019120"
  },
  {
    "text": "so the hardware itself but as i said it was just some arduino",
    "start": "1019759",
    "end": "1026558"
  },
  {
    "text": "mini pro some wireless interface it's up to you you can use from bluetooth to gsm",
    "start": "1026559",
    "end": "1033120"
  },
  {
    "text": "this is actually a gsm shield so it costs uh like around 15 euros",
    "start": "1033120",
    "end": "1039918"
  },
  {
    "text": "this is used for development uh in the end product it would be only the",
    "start": "1039919",
    "end": "1045038"
  },
  {
    "text": "white chip we can see here and that costs around seven euros and then you have gsm on the device so",
    "start": "1045039",
    "end": "1052320"
  },
  {
    "text": "it's still not that cheap not expensive it's good and the canvas stuff",
    "start": "1052320",
    "end": "1058640"
  },
  {
    "text": "basically so it's free i mean it's free it's cheap it's very cheap i guess",
    "start": "1058640",
    "end": "1064640"
  },
  {
    "text": "but then as we were talking about uh canvas data is not universal so if i",
    "start": "1064640",
    "end": "1070240"
  },
  {
    "text": "want to know how my car works then how could i do",
    "start": "1070240",
    "end": "1076960"
  },
  {
    "text": "that yeah so that's the problem that we were speaking previously it's like okay i have my car",
    "start": "1078840",
    "end": "1085039"
  },
  {
    "text": "my specific model specific year and i want to know for example what is the payload that i have to send",
    "start": "1085039",
    "end": "1092320"
  },
  {
    "text": "to open the door no some juicy juicy thing open the door or",
    "start": "1092320",
    "end": "1097679"
  },
  {
    "text": "activate i don't know doing some cool stuff so what happened in my specific model",
    "start": "1097679",
    "end": "1105360"
  },
  {
    "text": "how can i know what is the id for my model my brand my gf car that open the doors",
    "start": "1105360",
    "end": "1113679"
  },
  {
    "text": "how can i do it so we thought about a statistical analysis because right now when you do a capture",
    "start": "1113679",
    "end": "1119919"
  },
  {
    "text": "in the cam in the campus uh in the campus bus",
    "start": "1119919",
    "end": "1125039"
  },
  {
    "text": "we just receive tons of packets with different id with different payloads",
    "start": "1125039",
    "end": "1130640"
  },
  {
    "text": "but we don't know what these ideas are doing we don't know what is the the action that is being performed with",
    "start": "1130640",
    "end": "1136880"
  },
  {
    "text": "this id so yeah with we thought about okay let's gonna do some statistical analysis it's",
    "start": "1136880",
    "end": "1142400"
  },
  {
    "text": "gonna think like a car the logical of a car what a car does i mean in what moment do you think that a car",
    "start": "1142400",
    "end": "1148880"
  },
  {
    "text": "is going to send the packet to open the door at the beginning at the end of the use i",
    "start": "1148880",
    "end": "1155440"
  },
  {
    "text": "think that if you're going to opening the door you're going to use it at the beginning of the of the trace of the capture of",
    "start": "1155440",
    "end": "1162720"
  },
  {
    "text": "course it's not going to be at the end because you are supposed to be inside the car it's just if you're riding the car okay so we",
    "start": "1162720",
    "end": "1170400"
  },
  {
    "text": "thought about this kind of things and then we thought about okay so right now what is interesting for us to",
    "start": "1170400",
    "end": "1176480"
  },
  {
    "text": "know exactly what id is performing this specific action so yeah we thought we checked about type",
    "start": "1176480",
    "end": "1183840"
  },
  {
    "text": "of data okay so we wanted to difference between the typical commands like",
    "start": "1183840",
    "end": "1188960"
  },
  {
    "text": "okay the lights are on the lights are on the lights are on the lights are on i don't care about that it's like just status data i don't care",
    "start": "1188960",
    "end": "1196320"
  },
  {
    "text": "at all i want to find commands really actions that we can inject in the in the bus in the network okay so",
    "start": "1196320",
    "end": "1204480"
  },
  {
    "text": "yeah the thing is that uh there are like i told you some random data there are some text zooms and",
    "start": "1204480",
    "end": "1210080"
  },
  {
    "text": "this a lot of so yeah one very important thing is determine the",
    "start": "1210080",
    "end": "1215679"
  },
  {
    "text": "frequency because if i'm sending like a packet saying okay the lights are on the lights are on it's going to be more or less in the",
    "start": "1215679",
    "end": "1222159"
  },
  {
    "text": "same frequency it's not going to be like open the door that id that i did with the payload because i",
    "start": "1222159",
    "end": "1229520"
  },
  {
    "text": "want to remember that a canvas packet a canvas frame has the id and the the payload later okay so",
    "start": "1229520",
    "end": "1238480"
  },
  {
    "text": "some id can be okay the lights are on and the payload can say the light that is on is the light who is",
    "start": "1238480",
    "end": "1244880"
  },
  {
    "text": "in the front of the car or in the front right the front left wherever okay so in that case we want to know the",
    "start": "1244880",
    "end": "1251679"
  },
  {
    "text": "frequency so we can just forget about all the packets that are being sent with the same frequency because that",
    "start": "1251679",
    "end": "1258480"
  },
  {
    "text": "packets are not useful for the things that we want to do so yeah",
    "start": "1258480",
    "end": "1263760"
  },
  {
    "text": "that's the thing determine if it's a command it's only send once so yeah we want this kind of things so",
    "start": "1263760",
    "end": "1270240"
  },
  {
    "text": "yeah the thing about doing the statistical analysis is improving the comprehensive of the of",
    "start": "1270240",
    "end": "1277600"
  },
  {
    "text": "the of the ideas that are sent in the in the in the network okay that's more or less that's what is",
    "start": "1277600",
    "end": "1283679"
  },
  {
    "text": "the statistical analysis so yeah why we do that obviously it's like",
    "start": "1283679",
    "end": "1288799"
  },
  {
    "text": "the things that i told you like if we can if we want to open the doors we will send that command only once",
    "start": "1288799",
    "end": "1296000"
  },
  {
    "text": "okay we're gonna open the windows for example we're gonna be uh sending some specific",
    "start": "1296000",
    "end": "1302240"
  },
  {
    "text": "id for that just for a specific frame of time okay just specific time but then it's going to",
    "start": "1302240",
    "end": "1309600"
  },
  {
    "text": "stop so we can think how the car is how is the logical of the car",
    "start": "1309600",
    "end": "1314880"
  },
  {
    "text": "the logic of the car so we can know more or less what packets are for each uh each action",
    "start": "1314880",
    "end": "1322720"
  },
  {
    "text": "so and yeah that's another thing that we saw a lot there are tons of packets that are just the same all the time but with a",
    "start": "1322720",
    "end": "1329919"
  },
  {
    "text": "payload zero for example and in some moment that packet starts being exactly the",
    "start": "1329919",
    "end": "1335600"
  },
  {
    "text": "same same id but the payload is one in some byte so it's like the typical thing like okay",
    "start": "1335600",
    "end": "1342640"
  },
  {
    "text": "my lights i'm going i'm i'm riding the car and my lights are off but it's getting dark so i'm gonna",
    "start": "1342640",
    "end": "1349120"
  },
  {
    "text": "turn on the lights and we said this minimal difference is like the zero two",
    "start": "1349120",
    "end": "1354559"
  },
  {
    "text": "one but the id is the same okay i want to be clear in that like we have the id of the packet and then we",
    "start": "1354559",
    "end": "1360000"
  },
  {
    "text": "have the payload so it doesn't mean that the id is turn on and turn off the lights",
    "start": "1360000",
    "end": "1365840"
  },
  {
    "text": "it's different it can be the same id but with different payload okay",
    "start": "1365840",
    "end": "1370799"
  },
  {
    "text": "and yeah that's another option that is very useful imagine that the car is turned off so the cambus is not sending any any",
    "start": "1371120",
    "end": "1379120"
  },
  {
    "text": "data so that we can do is just uh just connect our device",
    "start": "1379120",
    "end": "1384320"
  },
  {
    "text": "to the to the cambus network and just send sending send some stupid packet",
    "start": "1384320",
    "end": "1392000"
  },
  {
    "text": "to the to the network the ecu's are gonna receive the packet and i'm gonna i'm gonna start sending",
    "start": "1392000",
    "end": "1398159"
  },
  {
    "text": "some stupid commands like oh what's happening here what is happening here so we can just",
    "start": "1398159",
    "end": "1403440"
  },
  {
    "text": "get a log of all these ideas and say okay i don't care about these ideas in the real capture we're gonna say okay",
    "start": "1403440",
    "end": "1410159"
  },
  {
    "text": "we're not gonna take in care about those ideas because our ideas of status ids for",
    "start": "1410159",
    "end": "1415600"
  },
  {
    "text": "from the ecu's so we did uh okay you know the arduino",
    "start": "1415600",
    "end": "1422559"
  },
  {
    "text": "that we're using have two kilobytes of ram that's like",
    "start": "1422559",
    "end": "1428720"
  },
  {
    "text": "this thing okay it's very cheap that's why we use it and",
    "start": "1428720",
    "end": "1434159"
  },
  {
    "text": "actually we use it too for the challenge of being developing c code even assembly codes",
    "start": "1434159",
    "end": "1439440"
  },
  {
    "text": "eventually because we wouldn't have enough round memory to recollect all the frames",
    "start": "1439440",
    "end": "1444559"
  },
  {
    "text": "that we were receiving so it's kind of cool just to having to deal with these limitations these limits so",
    "start": "1444559",
    "end": "1452240"
  },
  {
    "text": "yeah we created a website for doing the analysis itself it was impossible to do it in",
    "start": "1452240",
    "end": "1457760"
  },
  {
    "text": "this thing so yeah i it's just easy website use a login",
    "start": "1457760",
    "end": "1464960"
  },
  {
    "text": "you can you can use it i mean we're gonna we're gonna pull this the the website with the code and the code basically that it does",
    "start": "1464960",
    "end": "1472799"
  },
  {
    "text": "is like analysis analysis uh to them to the data this is our the query analysis that we",
    "start": "1472799",
    "end": "1479679"
  },
  {
    "text": "have already we have four different analysis one of them is just to list the most used id if an id is used",
    "start": "1479679",
    "end": "1487760"
  },
  {
    "text": "so many times it must be probably a stupid idea i mean stupid that i i i",
    "start": "1487760",
    "end": "1494640"
  },
  {
    "text": "did that i don't care an idea of state status or something like that okay so the other the other the other",
    "start": "1494640",
    "end": "1501200"
  },
  {
    "text": "analysis that we we did is just the periodicity of the active id",
    "start": "1501200",
    "end": "1506480"
  },
  {
    "text": "if an id is being sent all the time the same frequency i don't care about that we're going to",
    "start": "1506480",
    "end": "1512640"
  },
  {
    "text": "look for commands actual commands of the car like open the door turn off the lights or whatever things that can be",
    "start": "1512640",
    "end": "1520080"
  },
  {
    "text": "interesting and yeah the same thing packet sent over timeline and that is very important a possible",
    "start": "1520080",
    "end": "1527919"
  },
  {
    "text": "match with some commands and not only that there are some packets",
    "start": "1527919",
    "end": "1533520"
  },
  {
    "text": "i mean some frames that the id is the same but the payload it's an incremental byte",
    "start": "1533520",
    "end": "1539840"
  },
  {
    "text": "it has an incremental byte so it's like a b c d e whatever okay",
    "start": "1539840",
    "end": "1546240"
  },
  {
    "text": "it's it's like that all the time i don't care about those packets",
    "start": "1546240",
    "end": "1551520"
  },
  {
    "text": "i'm not going to be wasting my time taking i mean trying to understand what that",
    "start": "1551520",
    "end": "1557520"
  },
  {
    "text": "packet is going to do because most of the times that packet is not the lovely command that we are looking for",
    "start": "1557520",
    "end": "1565520"
  },
  {
    "text": "so yeah let's gonna do the demo i don't have i hope to have internet here yeah we",
    "start": "1565520",
    "end": "1572559"
  },
  {
    "text": "have actually we that's awful we're connected to a",
    "start": "1572559",
    "end": "1578080"
  },
  {
    "text": "to a net a network wi-fi who was unprotected and it's called black hat asia so please be nice",
    "start": "1578080",
    "end": "1586559"
  },
  {
    "text": "no yeah it's okay i know this is not defcon but i don't",
    "start": "1586559",
    "end": "1592960"
  },
  {
    "text": "believe in you guys don't trust you oh okay so oof that's horrible",
    "start": "1592960",
    "end": "1602480"
  },
  {
    "text": "okay so as alberto was saying usually when you see an id that is being",
    "start": "1609840",
    "end": "1616159"
  },
  {
    "text": "sent like overall many times it's not interesting but still you",
    "start": "1616159",
    "end": "1622960"
  },
  {
    "text": "should look at the payload because it might be the case that an id is being used for commands",
    "start": "1622960",
    "end": "1629679"
  },
  {
    "text": "and for status reports which would mean if you do a statistical analysis of the whole data",
    "start": "1629679",
    "end": "1635679"
  },
  {
    "text": "and let's say let's keep it like simple there's just one comment uh payload and",
    "start": "1635679",
    "end": "1642559"
  },
  {
    "text": "then there's some fixed payload that will send some",
    "start": "1642559",
    "end": "1648159"
  },
  {
    "text": "status data i don't know let's call it like a so if you're doing a statistical",
    "start": "1648159",
    "end": "1653200"
  },
  {
    "text": "analysis to the whole payloads that are being broadcasted then you will see that 99.999",
    "start": "1653200",
    "end": "1660480"
  },
  {
    "text": "is this static data but there's one payload that will be different that will probably be a command",
    "start": "1660480",
    "end": "1669840"
  },
  {
    "text": "hold on we're having trouble with the",
    "start": "1673200",
    "end": "1676559"
  },
  {
    "text": "wifi",
    "start": "1680840",
    "end": "1683840"
  },
  {
    "text": "yeah yeah we better do that",
    "start": "1688880",
    "end": "1697840"
  },
  {
    "text": "let's see if it works",
    "start": "1707600",
    "end": "1711840"
  },
  {
    "text": "why you do this yeah what about hackers where",
    "start": "1713760",
    "end": "1719440"
  },
  {
    "text": "yeah yeah there's like it's very a very simple website you can just upload the",
    "start": "1720960",
    "end": "1726159"
  },
  {
    "text": "account traffic that you can capture with this software i mean with this hardware and they i have i developed some python",
    "start": "1726159",
    "end": "1734080"
  },
  {
    "text": "code that is going to do the um the analysis itself i already have this is awful",
    "start": "1734080",
    "end": "1743440"
  },
  {
    "text": "anyway",
    "start": "1750840",
    "end": "1753840"
  },
  {
    "text": "okay yeah i have already uploaded this okay i",
    "start": "1756159",
    "end": "1763039"
  },
  {
    "text": "can try to upload the the scan i mean the the log that i have but i don't care it is the same so like we",
    "start": "1763039",
    "end": "1770480"
  },
  {
    "text": "can see here we have the this id have been sent like 3 000 times the id237",
    "start": "1770480",
    "end": "1778720"
  },
  {
    "text": "we have all the ids okay yeah okay and here we have the",
    "start": "1778720",
    "end": "1784720"
  },
  {
    "text": "internal the interval average okay so this id has been sent is 72 milliseconds",
    "start": "1784720",
    "end": "1790720"
  },
  {
    "text": "so i don't care about this id maybe i care about the ids that are at the bottom",
    "start": "1790720",
    "end": "1798320"
  },
  {
    "text": "here okay maybe those ideas are more interesting maybe those ideas are commands yeah",
    "start": "1799360",
    "end": "1808159"
  },
  {
    "text": "yeah i know that you can maybe not see very well i love colors and these things and then here you have the percentage of",
    "start": "1808159",
    "end": "1814880"
  },
  {
    "text": "the total with the same the ids here you can see actually",
    "start": "1814880",
    "end": "1820320"
  },
  {
    "text": "very easily this id 4 1b has been sent a lot of time",
    "start": "1820320",
    "end": "1826399"
  },
  {
    "text": "and actually according to our test it has it has a counter an incremental",
    "start": "1826399",
    "end": "1832799"
  },
  {
    "text": "byte so you can see you can see it here in the byte 3 there is an incremental",
    "start": "1832799",
    "end": "1840320"
  },
  {
    "text": "counter so probably this is not important for us actually doing this test we finally",
    "start": "1840320",
    "end": "1848000"
  },
  {
    "text": "got the the packet who was in charge of opening the the door so the door of the car so",
    "start": "1848000",
    "end": "1854000"
  },
  {
    "text": "that's that's nice so yeah go for it no yeah i hate this spiritual",
    "start": "1854000",
    "end": "1865840"
  },
  {
    "text": "okay so basically we know that injection is possible that is nothing new we can log the data",
    "start": "1869120",
    "end": "1876799"
  },
  {
    "text": "that is nothing new so let's talk about attacks actually on canvas so",
    "start": "1876799",
    "end": "1884399"
  },
  {
    "text": "why using attacks like alberto was saying some frames are being sent periodically",
    "start": "1884399",
    "end": "1889919"
  },
  {
    "text": "that let's see let's start let's get stick to the lights we're saying we want to turn off",
    "start": "1889919",
    "end": "1896640"
  },
  {
    "text": "the lights but it comes out that lights are being uh the light the status what they should be is being broadcasted like",
    "start": "1896640",
    "end": "1903679"
  },
  {
    "text": "every 10 milliseconds so if i keep on injecting the lights off then i'm going to have some",
    "start": "1903679",
    "end": "1910240"
  },
  {
    "text": "crazy stuff like lights are going to be like turning on off on off because i'm saying like",
    "start": "1910240",
    "end": "1915360"
  },
  {
    "text": "turn off and the system is saying turn on so after all it's either not gonna work",
    "start": "1915360",
    "end": "1920799"
  },
  {
    "text": "at all or something's gonna smell like fried like magic smoke you know if you make things go like crazy so injection",
    "start": "1920799",
    "end": "1928720"
  },
  {
    "text": "is not like uh yeah it's so easy compasses so you just inject data and everything works so wonderful",
    "start": "1928720",
    "end": "1934240"
  },
  {
    "text": "it's not like that exactly and then",
    "start": "1934240",
    "end": "1939360"
  },
  {
    "text": "some modules require some conditions as well like let's say if you want to use the parking",
    "start": "1939840",
    "end": "1946320"
  },
  {
    "text": "brake then the speed should never be higher than zero because you know you cannot use a parking rate at 100 kilometers per",
    "start": "1946320",
    "end": "1952720"
  },
  {
    "text": "hour so then what happens if i want to use it it doesn't work okay yeah sure i can inject the turn on",
    "start": "1952720",
    "end": "1959519"
  },
  {
    "text": "the parking brake but it's not going to happen so still injection is not just like that",
    "start": "1959519",
    "end": "1964720"
  },
  {
    "text": "easy yeah inject stuff so what's the idea take over",
    "start": "1964720",
    "end": "1971679"
  },
  {
    "text": "as we were talking earlier we want to do something about that about",
    "start": "1972080",
    "end": "1978640"
  },
  {
    "text": "not being able to do the stuff so uh we developed an attack that is basically",
    "start": "1978640",
    "end": "1984480"
  },
  {
    "text": "just taking down frames we just take down the frames we want and then we inject our own",
    "start": "1984480",
    "end": "1990159"
  },
  {
    "text": "so and we do it in a way that it's not considered like a real error",
    "start": "1990159",
    "end": "1996720"
  },
  {
    "text": "it's just like something weird we will see it in a while so basically what how does it work we select a target id",
    "start": "1996720",
    "end": "2003200"
  },
  {
    "text": "we want to replace we use the chd we attach it",
    "start": "2003200",
    "end": "2008720"
  },
  {
    "text": "it's four wires yes two for the canvas and two four feet if we use a battery then it's just two wires",
    "start": "2008720",
    "end": "2014080"
  },
  {
    "text": "but since it should be possible to have it for long term in the car",
    "start": "2014080",
    "end": "2019440"
  },
  {
    "text": "we are using four wires so uh then once the id is transmitting",
    "start": "2019440",
    "end": "2027760"
  },
  {
    "text": "we will basically real time read the bits of the id once",
    "start": "2027760",
    "end": "2034399"
  },
  {
    "text": "we see there's a match then we will get we will inject an error so we will put down the frame and then",
    "start": "2034399",
    "end": "2041039"
  },
  {
    "text": "we will inject our own frame and it you know there's some error",
    "start": "2041039",
    "end": "2046320"
  },
  {
    "text": "checking possibilities according to the con specifications",
    "start": "2046320",
    "end": "2052158"
  },
  {
    "text": "they are not using it you will see it that just keeps forever trying to transmit uh",
    "start": "2052159",
    "end": "2059760"
  },
  {
    "text": "so well that's basically it why does it work uh due to the arbitration that is used",
    "start": "2059760",
    "end": "2067118"
  },
  {
    "text": "on canvas it is always possible uh to put the bus in a low state which is",
    "start": "2067119",
    "end": "2074960"
  },
  {
    "text": "dominant since that's how arbitration works like many modules are trying to",
    "start": "2074960",
    "end": "2081040"
  },
  {
    "text": "fight to get the id his id then if another module has a lower id",
    "start": "2081040",
    "end": "2087520"
  },
  {
    "text": "which means it's dominant and bitwise then the",
    "start": "2087520",
    "end": "2094398"
  },
  {
    "text": "other one if it's trying to set level high but it reads out level is low it will stop",
    "start": "2094399",
    "end": "2099839"
  },
  {
    "text": "so basically at the point about this is you can set the bus low any time and",
    "start": "2099839",
    "end": "2106640"
  },
  {
    "text": "as well yeah just for if this is as well by specification first thing that is being broadcasted",
    "start": "2107520",
    "end": "2114720"
  },
  {
    "text": "well not broadcaster since first thing in the frame in a compass frame is the start bit so when the bus is like silent and i see",
    "start": "2114720",
    "end": "2121760"
  },
  {
    "text": "it's going uh low i know something's gonna happen and then what's the second thing the id so i can",
    "start": "2121760",
    "end": "2128880"
  },
  {
    "text": "just before anything happens i know the id before even i know what's the length of the payload i already know",
    "start": "2128880",
    "end": "2134400"
  },
  {
    "text": "the id so i don't need to wait much more okay i get the id i check it then what's an error we said",
    "start": "2134400",
    "end": "2143359"
  },
  {
    "text": "that we can put the bus in a low state dominant anytime",
    "start": "2143359",
    "end": "2148400"
  },
  {
    "text": "and how do you signal an error by putting down the bus for 12 bit times so i can inject error",
    "start": "2148400",
    "end": "2156960"
  },
  {
    "text": "anytime it doesn't matter i can always put it down",
    "start": "2156960",
    "end": "2162560"
  },
  {
    "text": "and as well errors actually they can be reported by their",
    "start": "2164079",
    "end": "2170480"
  },
  {
    "text": "own module on real time since the modules are echoed echoing themselves to check if",
    "start": "2170480",
    "end": "2178160"
  },
  {
    "text": "the data they are trying to pull out is actually making it out to the bus so if they see the data they are trying to",
    "start": "2178160",
    "end": "2184480"
  },
  {
    "text": "pull out is not making it to the bus they will just signal this error stuff like we can see",
    "start": "2184480",
    "end": "2189760"
  },
  {
    "text": "in this image the on the current rx this is like let's say one model it's reading from the bus on package when it's transmitting",
    "start": "2189760",
    "end": "2196000"
  },
  {
    "text": "it will see its own echo so it is uh it is the one that should inject the",
    "start": "2196000",
    "end": "2201520"
  },
  {
    "text": "error now uh we're using the",
    "start": "2201520",
    "end": "2206720"
  },
  {
    "text": "microchip uh mp and cp2515 yep which has a possibility to signal a",
    "start": "2206720",
    "end": "2214640"
  },
  {
    "text": "start-up frame uh so it makes it quite easy",
    "start": "2214640",
    "end": "2219680"
  },
  {
    "text": "to know when a frame is starting but actually due to the fact that its signal is just",
    "start": "2219680",
    "end": "2225680"
  },
  {
    "text": "a 7 62 62.5 nanoseconds",
    "start": "2225680",
    "end": "2231440"
  },
  {
    "text": "we had to develop something that was even better we no longer require that",
    "start": "2231839",
    "end": "2237040"
  },
  {
    "text": "so now we're gonna see a demo okay so okay",
    "start": "2237040",
    "end": "2245280"
  },
  {
    "text": "zoom out so basically this is a car ecu this is the subject",
    "start": "2245280",
    "end": "2252320"
  },
  {
    "text": "that we are going to use with the demo logic analyzer we're going to be using to see all the stuff",
    "start": "2252320",
    "end": "2258800"
  },
  {
    "text": "that's one thing we couldn't we tried to bring here a car but it was not possible okay we're sorry",
    "start": "2258800",
    "end": "2264160"
  },
  {
    "text": "about that that's what's the only thing that we can do it's like bringing an ecu but we can of",
    "start": "2264160",
    "end": "2269440"
  },
  {
    "text": "course attach to the campus with this device it's the same as this two two wires that's all",
    "start": "2269440",
    "end": "2277200"
  },
  {
    "text": "well without one ecu well you know it has a few more so and actually this small device",
    "start": "2279839",
    "end": "2288320"
  },
  {
    "text": "is uh something we made for as a serial link and for updating",
    "start": "2288320",
    "end": "2294960"
  },
  {
    "text": "the firmware remotely that's it what we were talking about earlier this is a bluetooth module this is an sd card",
    "start": "2294960",
    "end": "2301359"
  },
  {
    "text": "usage buffer and the fancy red light is the arduino yeah",
    "start": "2301359",
    "end": "2306800"
  },
  {
    "text": "we can see your hand yeah so and then this here i'm not going to move it i will",
    "start": "2306800",
    "end": "2312079"
  },
  {
    "text": "take everything apart and we will see it when the demo is done this is the cht that is actually just attached by canvas",
    "start": "2312079",
    "end": "2318640"
  },
  {
    "text": "with these two wires to the ecu and the power supply which has the other two wires",
    "start": "2318640",
    "end": "2324880"
  },
  {
    "text": "so let's get back to the computer",
    "start": "2324880",
    "end": "2329440"
  },
  {
    "text": "hey computer please",
    "start": "2330880",
    "end": "2340160"
  },
  {
    "text": "okay so as i said this is cereal so we're gonna use a serial terminal",
    "start": "2340160",
    "end": "2347440"
  },
  {
    "text": "it's here already okay so we're going to connect to it this is",
    "start": "2348160",
    "end": "2354880"
  },
  {
    "text": "bluetooth actually and and then okay let's reset this",
    "start": "2354880",
    "end": "2361920"
  },
  {
    "text": "and now okay we are going to use uh the serial",
    "start": "2362079",
    "end": "2369440"
  },
  {
    "text": "shell so we are going to reset this",
    "start": "2369440",
    "end": "2374480"
  },
  {
    "text": "okay so basically that is the interface for the chd let's check how",
    "start": "2374960",
    "end": "2381599"
  },
  {
    "text": "the bus looks like before doing anything",
    "start": "2381599",
    "end": "2386078"
  },
  {
    "text": "so one second",
    "start": "2388400",
    "end": "2396160"
  },
  {
    "text": "so yeah we can actually see that frames are being sent",
    "start": "2396160",
    "end": "2401680"
  },
  {
    "text": "like yeah let's zoom it out some frames have been sent there with some ids so i mean like that's",
    "start": "2402880",
    "end": "2409520"
  },
  {
    "text": "traffic right yeah so let's say okay we like id288 for",
    "start": "2409520",
    "end": "2415359"
  },
  {
    "text": "example okay so yeah so you see it's actually just there yeah",
    "start": "2415359",
    "end": "2422480"
  },
  {
    "text": "you can see it quickly i guess the 288 yeah so yeah and you can see how the",
    "start": "2422480",
    "end": "2428240"
  },
  {
    "text": "data looks like yeah we can see some frames it looks so nice so symmetric yeah let's go for it",
    "start": "2428240",
    "end": "2436480"
  },
  {
    "text": "so let's configure this",
    "start": "2436480",
    "end": "2440240"
  },
  {
    "text": "okay so we said 288 and let's inject for example one one two",
    "start": "2450000",
    "end": "2456480"
  },
  {
    "text": "two three three okay so let's see what's going on",
    "start": "2456480",
    "end": "2467838"
  },
  {
    "text": "oops now it doesn't look so symmetric like what what's this okay",
    "start": "2469680",
    "end": "2477680"
  },
  {
    "text": "so actually if you see uh yeah this is stuff down here okay the",
    "start": "2477680",
    "end": "2484800"
  },
  {
    "text": "white one this one indicates that we have detected that start of frame",
    "start": "2484800",
    "end": "2490160"
  },
  {
    "text": "which would be this and then each small one it's the bit counting so actually if this doesn't move anymore",
    "start": "2490160",
    "end": "2498000"
  },
  {
    "text": "we can see we're counting the bits in the middle so if we get a match we inject an error so it doesn't make it",
    "start": "2498000",
    "end": "2507520"
  },
  {
    "text": "we're just getting arrows yeah so yeah and",
    "start": "2507520",
    "end": "2516000"
  },
  {
    "text": "when we're going to inject our own stuff you know since this is buffered the combat stuff",
    "start": "2516000",
    "end": "2523119"
  },
  {
    "text": "if we were like sending out the frame and it got buffered then we found out that we would put down our",
    "start": "2523119",
    "end": "2529200"
  },
  {
    "text": "own packet so we had to listen as well on the our own tx line for the for the canvas and when we",
    "start": "2529200",
    "end": "2536400"
  },
  {
    "text": "detected that the level was low both on txr and rx it would be us trying to send the",
    "start": "2536400",
    "end": "2542319"
  },
  {
    "text": "packet so that's why here we can only see one spike we have detected",
    "start": "2542319",
    "end": "2547359"
  },
  {
    "text": "it's us trying to send the packet so we stopped but actually the ecu was trying to send us",
    "start": "2547359",
    "end": "2552720"
  },
  {
    "text": "well at the same time so we got an error and then we need a little bit more",
    "start": "2552720",
    "end": "2559920"
  },
  {
    "text": "debugging but that one made it through and this was us here with our own payload",
    "start": "2559920",
    "end": "2569119"
  },
  {
    "text": "yeah and you can see that when it's another id it's just skipped",
    "start": "2569119",
    "end": "2575920"
  },
  {
    "text": "like we check it's different we don't put it down so basically every time we detect the other one we just put it down",
    "start": "2576560",
    "end": "2585599"
  },
  {
    "text": "yeah like lots of errors",
    "start": "2586319",
    "end": "2593839"
  },
  {
    "text": "yeah there are a lot other options you can see in the interface like inject a specific command",
    "start": "2595599",
    "end": "2600800"
  },
  {
    "text": "okay we can just take out a specific id and then we can inject our own id",
    "start": "2600800",
    "end": "2606000"
  },
  {
    "text": "so we can just generate the flights i mean the lights get crazy or something like that",
    "start": "2606000",
    "end": "2611119"
  },
  {
    "text": "imagine that you are uh what these are the configuration options we were talking about earlier",
    "start": "2611119",
    "end": "2617440"
  },
  {
    "text": "like you know there's some stuff but it's just the basic stuff for the canvas interface",
    "start": "2617440",
    "end": "2623599"
  },
  {
    "text": "yeah the thing that you can do as much as you want your imagination is your limit here and of course it's very very important",
    "start": "2623599",
    "end": "2630319"
  },
  {
    "text": "the uh the statistic analysis very important because we need to know what id is doing a specific task",
    "start": "2630319",
    "end": "2636560"
  },
  {
    "text": "if we don't know that we're going to just do a denial of service to a specific id that we don't know what it's doing it can be",
    "start": "2636560",
    "end": "2643599"
  },
  {
    "text": "wrong okay so let's change to the and well actually you know we just saw a",
    "start": "2643599",
    "end": "2651440"
  },
  {
    "text": "small part but uh we did the logic after a while this was working",
    "start": "2651440",
    "end": "2656720"
  },
  {
    "text": "and if you noticed it was still broadcasting on the network i mean when it detects uh up to two five four",
    "start": "2656720",
    "end": "2664240"
  },
  {
    "text": "hours it should stop but it does not stop it just keeps on retrying forever so you can just keep on",
    "start": "2664240",
    "end": "2670720"
  },
  {
    "text": "injecting and putting down frames forever which should not be possible and now",
    "start": "2670720",
    "end": "2676319"
  },
  {
    "text": "about flex rate well that's the future that's a real filter not canvas that is a recent protocol it supports up to 10",
    "start": "2676319",
    "end": "2683040"
  },
  {
    "text": "megabits per second and the working principle is basically the same as canvas arbitration",
    "start": "2683040",
    "end": "2689760"
  },
  {
    "text": "and yeah the idea is at the beginning as well so",
    "start": "2689760",
    "end": "2694960"
  },
  {
    "text": "okay so just let's speak a little bit about forensics how",
    "start": "2696880",
    "end": "2702560"
  },
  {
    "text": "can i retrieve the information of a car of a crash in a car a fire accident",
    "start": "2702560",
    "end": "2708160"
  },
  {
    "text": "okay so every car has a black box right now nowadays all the cars have a",
    "start": "2708160",
    "end": "2713760"
  },
  {
    "text": "mini black box with information all this information that we are speaking about we can store part of this",
    "start": "2713760",
    "end": "2720240"
  },
  {
    "text": "information in the in this black box this information is usually stored in the airbag ecu okay",
    "start": "2720240",
    "end": "2727680"
  },
  {
    "text": "so we can just try to retrieve this information and we can use that information in court or we can use this information",
    "start": "2727680",
    "end": "2734079"
  },
  {
    "text": "just i don't know just to check we can buy random airbag ecu's and know what happened in the",
    "start": "2734079",
    "end": "2740160"
  },
  {
    "text": "crash of that guy okay so yeah like he told you it's uh it's in",
    "start": "2740160",
    "end": "2746079"
  },
  {
    "text": "the airbag ecu and usually it is a store in the eprom okay so yeah there's uh there are",
    "start": "2746079",
    "end": "2752560"
  },
  {
    "text": "some software and some hardware that can retrieve this information but usually it's a it's not free actually it's never free",
    "start": "2752560",
    "end": "2762000"
  },
  {
    "text": "so for in this uh in this specific ecu it's the brand is bosch okay the brand",
    "start": "2762000",
    "end": "2768400"
  },
  {
    "text": "of the ecu is bosch and uh both have a tool who is called",
    "start": "2768400",
    "end": "2774000"
  },
  {
    "text": "yeah have a tool that retrieves the information from uh from ecu we can retrieve this",
    "start": "2774000",
    "end": "2780079"
  },
  {
    "text": "information in three different ways okay just connecting to the odb port",
    "start": "2780079",
    "end": "2786079"
  },
  {
    "text": "okay and we need authentication we can connect with the airbag module directly so just having the ecu and connect",
    "start": "2786079",
    "end": "2792400"
  },
  {
    "text": "directly to the icu like we are connecting right now and the other more",
    "start": "2792400",
    "end": "2798240"
  },
  {
    "text": "difficult way is reading directly using the eprom reading the eprom",
    "start": "2798240",
    "end": "2804000"
  },
  {
    "text": "directly dump the information of the apron try to parse that information the problem about that is that i mean",
    "start": "2804000",
    "end": "2809760"
  },
  {
    "text": "the good thing about that is that we don't need authentication so that's cool we don't need to just do",
    "start": "2809760",
    "end": "2815760"
  },
  {
    "text": "the seed key that it usually needs to be performed if you want to connect through the odb port",
    "start": "2815760",
    "end": "2821040"
  },
  {
    "text": "or using directly the airbag module so yeah the odb4 is one of the options",
    "start": "2821040",
    "end": "2826160"
  },
  {
    "text": "connecting directly to the ecu is the other option to access to the data who is in the eprom",
    "start": "2826160",
    "end": "2832000"
  },
  {
    "text": "and the other option is okay i have the apron so that's gonna dump everything so this is the software",
    "start": "2832000",
    "end": "2838079"
  },
  {
    "text": "i told you about software and hardware so it cost like 9 000",
    "start": "2838079",
    "end": "2844000"
  },
  {
    "text": "so yeah we are like students we don't have uh this kind of money so actually",
    "start": "2844000",
    "end": "2850720"
  },
  {
    "text": "we downloaded the the software do you remember yeah we don't load in the software yeah go to",
    "start": "2850720",
    "end": "2856400"
  },
  {
    "text": "the other machine that's gonna show everybody the software so they can buy boss products",
    "start": "2856400",
    "end": "2863599"
  },
  {
    "text": "yeah that's the software okay yeah let me yeah the boss",
    "start": "2864559",
    "end": "2872079"
  },
  {
    "text": "grass data retrieval tool so the things uh it requires an activation so i just took",
    "start": "2872079",
    "end": "2879119"
  },
  {
    "text": "a look okay and i saw that this waiting for a file with extension extension ctf that was so funny",
    "start": "2879119",
    "end": "2886800"
  },
  {
    "text": "ctf captured the flag yeah i was trying i just generated a random random file in that case this is the",
    "start": "2886800",
    "end": "2893920"
  },
  {
    "text": "random file and open it and i don't know why the calc was executed i don't have any idea about",
    "start": "2893920",
    "end": "2902240"
  },
  {
    "text": "why this happened i'm so confused so we were not able to use the uh",
    "start": "2902240",
    "end": "2907520"
  },
  {
    "text": "this this software this is the last version of that of the server okay so we were not able to use that software",
    "start": "2907520",
    "end": "2913280"
  },
  {
    "text": "we so we tried other things what no i just want to go back and",
    "start": "2913280",
    "end": "2921119"
  },
  {
    "text": "yes okay so yeah what about poor guy so guys that doesn't know how to activate this",
    "start": "2926839",
    "end": "2932079"
  },
  {
    "text": "software like we don't know so yeah",
    "start": "2932079",
    "end": "2937200"
  },
  {
    "text": "okay next so yeah there's a list of supported vehicles",
    "start": "2937200",
    "end": "2942480"
  },
  {
    "text": "so in our case a client contacted with us a customer and mercedes mercedes was not",
    "start": "2942480",
    "end": "2950960"
  },
  {
    "text": "in the supported vehicle so we were not able to use this tool to extract information to parse the",
    "start": "2950960",
    "end": "2956400"
  },
  {
    "text": "information and to give the client or the customer um a report okay so what yeah that was like",
    "start": "2956400",
    "end": "2965119"
  },
  {
    "text": "our face what are we going to do in that case so what we did is uh redirectly",
    "start": "2965119",
    "end": "2970960"
  },
  {
    "text": "uh the apron okay as you can see they from down here this this small",
    "start": "2970960",
    "end": "2978319"
  },
  {
    "text": "chip okay so we dumped the the eprom and",
    "start": "2978319",
    "end": "2984960"
  },
  {
    "text": "we had information but it's just a binary we didn't know how to parse this information we didn't know okay the first three bytes are going to be",
    "start": "2984960",
    "end": "2991520"
  },
  {
    "text": "the speed of the car one second before the crash and the next three bytes are going to be the speed",
    "start": "2991520",
    "end": "2997440"
  },
  {
    "text": "two seconds before the crash and this other part of the file is the rpm at the moment of the crash we didn't",
    "start": "2997440",
    "end": "3003359"
  },
  {
    "text": "know that so that we did is to reset this this um",
    "start": "3003359",
    "end": "3008480"
  },
  {
    "text": "this file this dump we reset it to the default uh moment and we did a div",
    "start": "3008480",
    "end": "3015280"
  },
  {
    "text": "so in that case we could know what are the exact parts of the file that have that were",
    "start": "3015280",
    "end": "3020960"
  },
  {
    "text": "being modified okay so we know that that specific parts contains information relevant information for us",
    "start": "3020960",
    "end": "3028960"
  },
  {
    "text": "okay so yeah we knew that some parts were changed so the next step that we did is",
    "start": "3028960",
    "end": "3035760"
  },
  {
    "text": "just to use this program we know ls it's like a problem that you can just try to print",
    "start": "3035760",
    "end": "3042240"
  },
  {
    "text": "some graphics of the of data so we retrieve some um functions",
    "start": "3042240",
    "end": "3049599"
  },
  {
    "text": "okay so we if there is a a a crash there's gonna be a really huge break",
    "start": "3049599",
    "end": "3056640"
  },
  {
    "text": "the car is gonna it's gonna stop eventually so if we have we had some graphics who were",
    "start": "3056640",
    "end": "3063280"
  },
  {
    "text": "ascendant and other one who are descendant so in that case if it is a crash we only",
    "start": "3063280",
    "end": "3069599"
  },
  {
    "text": "cares about the descendant uh graphics for for the speed i mean the speed is going to be",
    "start": "3069599",
    "end": "3076000"
  },
  {
    "text": "it's going to go to zero we sorted and we got here",
    "start": "3076000",
    "end": "3083680"
  },
  {
    "text": "it totally looks this was the only uh descending graphic that we had so",
    "start": "3083680",
    "end": "3090319"
  },
  {
    "text": "after the div of course so yeah we realized that that was the specific speed during the",
    "start": "3090319",
    "end": "3096400"
  },
  {
    "text": "accident so yeah it was kind of cool how to",
    "start": "3096400",
    "end": "3101520"
  },
  {
    "text": "be able to even not have in the way in which the the information is parsed",
    "start": "3101520",
    "end": "3108400"
  },
  {
    "text": "we could do something to figure out so okay so",
    "start": "3108400",
    "end": "3117520"
  },
  {
    "text": "about the ac tool okay we will be soon releasing a new",
    "start": "3117520",
    "end": "3124000"
  },
  {
    "text": "revision of the hardware and a new revision of the software this one already has it",
    "start": "3124000",
    "end": "3130800"
  },
  {
    "text": "it has canvas so it's going to be working with canvas with k-line and should be working with",
    "start": "3130800",
    "end": "3136800"
  },
  {
    "text": "lean as well we had already",
    "start": "3136800",
    "end": "3142480"
  },
  {
    "text": "done the implementation for canvas for edc 16 on this one we will",
    "start": "3142480",
    "end": "3149839"
  },
  {
    "text": "release that as well yeah as alberto said we are working on the crash data retrieval",
    "start": "3149839",
    "end": "3155200"
  },
  {
    "text": "so that's still in the works we should be able in a near future to",
    "start": "3155200",
    "end": "3162319"
  },
  {
    "text": "get the crash data from our cars using the ecu tool and then parse it",
    "start": "3162319",
    "end": "3169520"
  },
  {
    "text": "yeah i didn't say that but we are working about doing these parts of information in an automatic way",
    "start": "3169680",
    "end": "3176800"
  },
  {
    "text": "but the things that we don't have all the different airbag ecu's to be able to know how",
    "start": "3176800",
    "end": "3184000"
  },
  {
    "text": "that information is stored how to parse this information we need it's a very manually job to know okay i",
    "start": "3184000",
    "end": "3190720"
  },
  {
    "text": "have this dump of this specific ecu this specific model okay let's see how the information",
    "start": "3190720",
    "end": "3195920"
  },
  {
    "text": "is stored in the eprom so if you have some airbag ecu's and you don't want it even",
    "start": "3195920",
    "end": "3201839"
  },
  {
    "text": "if you have a car right now you want to just take out the ecu and give it to me it's okay",
    "start": "3201839",
    "end": "3207440"
  },
  {
    "text": "so okay i'll finish the we're gonna have the chd emulation with basic functionality not the glitch",
    "start": "3212880",
    "end": "3219680"
  },
  {
    "text": "itself but should anyone want to see to get the code for it",
    "start": "3219680",
    "end": "3226160"
  },
  {
    "text": "we would send it and the optional over the air finger",
    "start": "3226160",
    "end": "3231839"
  },
  {
    "text": "so everything all the updates the hardware of course should be around ten dollars and",
    "start": "3231839",
    "end": "3239280"
  },
  {
    "text": "everything can be downloaded from our github repository",
    "start": "3239280",
    "end": "3244720"
  },
  {
    "text": "so yeah we're gonna get back to the camera we're gonna show a little bit the",
    "start": "3244720",
    "end": "3249839"
  },
  {
    "text": "hardware now unconnected",
    "start": "3249839",
    "end": "3253599"
  },
  {
    "text": "so let's see",
    "start": "3257920",
    "end": "3265838"
  },
  {
    "text": "this is the cht so basically how the injection was done for the aeros of",
    "start": "3274480",
    "end": "3279839"
  },
  {
    "text": "course we needed to drive the stuff manually this is the mcp2515 which is the canvas",
    "start": "3279839",
    "end": "3285839"
  },
  {
    "text": "controller it's handled by spi by the arduino here",
    "start": "3285839",
    "end": "3291040"
  },
  {
    "text": "then we have the the driver for canvas for the legged way i mean for normal",
    "start": "3291040",
    "end": "3296720"
  },
  {
    "text": "frames which is this one that is being used for the by the combust driver and then we have this another combust",
    "start": "3296720",
    "end": "3303760"
  },
  {
    "text": "driver that is directly connected to digital pins on the arduino so",
    "start": "3303760",
    "end": "3309440"
  },
  {
    "text": "and uh what we are basically doing is we are using uh normal canvas for injecting our own",
    "start": "3309440",
    "end": "3315760"
  },
  {
    "text": "frame and this extension for injecting the errors",
    "start": "3315760",
    "end": "3321119"
  },
  {
    "text": "and you know basically that's the sd and little more like some leds here",
    "start": "3321119",
    "end": "3328160"
  },
  {
    "text": "some power supply here and the remote finger update is pretty",
    "start": "3328160",
    "end": "3334000"
  },
  {
    "text": "simple it's just as i was saying uh one microcontroller arduino mini pro here is an sd that access buffer",
    "start": "3334000",
    "end": "3340640"
  },
  {
    "text": "we could add further like several fingers inside the sd so you can quickly change between them",
    "start": "3340640",
    "end": "3346559"
  },
  {
    "text": "and just a bluetooth module it could be anything like esm yeah and actually this is the gsm",
    "start": "3346559",
    "end": "3353119"
  },
  {
    "text": "development shield as uh i was saying earlier this is the chipset itself",
    "start": "3353119",
    "end": "3358240"
  },
  {
    "text": "this costs around seven euros it's a sim 900 it's quad band so it works worldwide and",
    "start": "3358240",
    "end": "3364960"
  },
  {
    "text": "it's really small like you can see my finger so yeah second",
    "start": "3364960",
    "end": "3372799"
  },
  {
    "text": "okay so yeah that's it uh oh can you thank you yeah",
    "start": "3372799",
    "end": "3379520"
  },
  {
    "text": "that's thank you everybody for being here today thank you for joining us go to the pool please stop just going to",
    "start": "3379520",
    "end": "3387520"
  },
  {
    "text": "this conference go to the pool it's awesome and thank you to all those who wants to understand",
    "start": "3387520",
    "end": "3392640"
  },
  {
    "text": "how and why things works thank you very",
    "start": "3392640",
    "end": "3397279"
  },
  {
    "text": "much",
    "start": "3399480",
    "end": "3402480"
  }
]