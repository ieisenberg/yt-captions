[
  {
    "text": "okay oh good afternoon everyone does a sense for attending our session and we're going to talk about routine every",
    "start": "30",
    "end": "6569"
  },
  {
    "text": "Android from expectation exploitation which basically will be focusing on the security of the Android kernel in our",
    "start": "6569",
    "end": "13440"
  },
  {
    "text": "stitching and first on brief introduction oh my name is Jane is decent and aka Remy we both work for the",
    "start": "13440",
    "end": "23070"
  },
  {
    "text": "King lack of Tencent and we are really into the Android kernel security because",
    "start": "23070",
    "end": "28710"
  },
  {
    "text": "we focusing on rooting all kinds of Android devices and our lab has been working on Android security and internal",
    "start": "28710",
    "end": "35340"
  },
  {
    "text": "security for more than 50 years and there is a quota quite proud that we are contributed multiple no malicious",
    "start": "35340",
    "end": "42809"
  },
  {
    "text": "routing solution which are quite welcomed by the communities including the pimple root which was released the",
    "start": "42809",
    "end": "49440"
  },
  {
    "text": "last year to be one of the first the root utility released for the Galaxy s6",
    "start": "49440",
    "end": "54780"
  },
  {
    "text": "and also the CVE 2015 AKO 5 which was released this year and actually project",
    "start": "54780",
    "end": "61379"
  },
  {
    "text": "Google to reduce its first security advisory of Android during the history so these are two major general routine",
    "start": "61379",
    "end": "68850"
  },
  {
    "text": "tools we worked on and also we release the multiple quite quite some device specific alerts which will also be",
    "start": "68850",
    "end": "76500"
  },
  {
    "text": "discussed in today's session ok so here's the agenda audit of our session",
    "start": "76500",
    "end": "81750"
  },
  {
    "text": "and today we are going to discuss a very interesting attack surface of the Android kernel which is named a wireless",
    "start": "81750",
    "end": "88200"
  },
  {
    "text": "extension so this actually existed almost every Android device because most",
    "start": "88200",
    "end": "93540"
  },
  {
    "text": "of the devices comes with a Wi-Fi chip step so during the session we are going",
    "start": "93540",
    "end": "98549"
  },
  {
    "text": "to give you a general overview of how this interface looks like and what I",
    "start": "98549",
    "end": "103579"
  },
  {
    "text": "what are the potential weakness spot and how we actually discovered on a very",
    "start": "103579",
    "end": "109049"
  },
  {
    "text": "excited the following is that most of the time we're depending on three different cases they are affecting not",
    "start": "109049",
    "end": "115290"
  },
  {
    "text": "just the different SOC but also coming with different types of vulnerabilities and a lot but not least we also mention",
    "start": "115290",
    "end": "123810"
  },
  {
    "text": "Google's latest medication which helps reduce and mitigate the attacks from this attack service ok so first thing",
    "start": "123810",
    "end": "131009"
  },
  {
    "text": "first let's get into the although the section so what is the Wi-Fi all called Wireless extension of",
    "start": "131009",
    "end": "137849"
  },
  {
    "text": "Android we all know that beneath the Android he needs order order graphic",
    "start": "137849",
    "end": "143129"
  },
  {
    "text": "stuff we still have any enough kernel there and for Linux kernel only a lot of contributions from different communities",
    "start": "143129",
    "end": "149640"
  },
  {
    "text": "and the world of them that actually are well at extension which was just done by Jean he is a GP lab researcher I think",
    "start": "149640",
    "end": "158819"
  },
  {
    "text": "whom main concern of research is communication and network protocols and",
    "start": "158819",
    "end": "165870"
  },
  {
    "text": "logical stuff so he was quite concerned by the difference of different wireless",
    "start": "165870",
    "end": "172650"
  },
  {
    "text": "drivers in early times of back in 1997 so he would like to design a wellness a",
    "start": "172650",
    "end": "178769"
  },
  {
    "text": "standard a neutral way that user can manipulate any well as networking device",
    "start": "178769",
    "end": "184470"
  },
  {
    "text": "that they set in some standard for the wireless devices drivers for dizziness",
    "start": "184470",
    "end": "190200"
  },
  {
    "text": "kernel so eventually key technologies wireless extension API which was",
    "start": "190200",
    "end": "195480"
  },
  {
    "text": "implemented in almost all major wireless solution vendors by almost all the major West ocean vendors but well be replaced",
    "start": "195480",
    "end": "203340"
  },
  {
    "text": "by CFG old 802 11 which should be a",
    "start": "203340",
    "end": "209099"
  },
  {
    "text": "little newer but also still supplied to it backward compatibility so if there's",
    "start": "209099",
    "end": "214530"
  },
  {
    "text": "some some issue in the implementation of the wild life extension it is still potentially can be attractive even the",
    "start": "214530",
    "end": "221910"
  },
  {
    "text": "device come to it with the latter well expansion standard and also it",
    "start": "221910",
    "end": "227459"
  },
  {
    "text": "doesn't mean that 52 802 element is more secure because we are also the",
    "start": "227459",
    "end": "232889"
  },
  {
    "text": "invalidated discovered in the implementation of this API okay so let's look into the",
    "start": "232889",
    "end": "239459"
  },
  {
    "text": "interface itself let's log into the wireless extension API and it actually comes in two major interfaces one of the",
    "start": "239459",
    "end": "246690"
  },
  {
    "text": "interface actually is implemented at a progress note which just provides some",
    "start": "246690",
    "end": "251790"
  },
  {
    "text": "features which we basically just just read that file that under prog net and",
    "start": "251790",
    "end": "257820"
  },
  {
    "text": "wealth so just get the phone or seed some set some studies dictator of different",
    "start": "257820",
    "end": "263430"
  },
  {
    "text": "well that interfaces which does not provide too many features here so this",
    "start": "263430",
    "end": "268889"
  },
  {
    "text": "is not likely to be some kind of major attack surface of the weather attention the other one is almost everyone's",
    "start": "268889",
    "end": "276030"
  },
  {
    "text": "favorite especially for Linux kernel resolution security assertions which is the i/o control interface so the our",
    "start": "276030",
    "end": "282900"
  },
  {
    "text": "country interface will provide us that a group of commands and different",
    "start": "282900",
    "end": "289199"
  },
  {
    "text": "functionalities which allows you to set or peripheral parameters for that device or we say may also issue commands to the",
    "start": "289199",
    "end": "297090"
  },
  {
    "text": "device while important able certain weather features are turned off so it provides a very feature-rich interface",
    "start": "297090",
    "end": "303270"
  },
  {
    "text": "which can be a potential attack surface by the way and let's take a look at how",
    "start": "303270",
    "end": "308760"
  },
  {
    "text": "this all control interface was implemented so we all know that I'll control interfaces comma with command",
    "start": "308760",
    "end": "314760"
  },
  {
    "text": "and it's actually reserved the southern command range from 8000 to ad FS they",
    "start": "314760",
    "end": "321240"
  },
  {
    "text": "actually 256 commands are available in this range and they are they are",
    "start": "321240",
    "end": "326280"
  },
  {
    "text": "actually just reserved just for the wildest extension commands so in theory",
    "start": "326280",
    "end": "332940"
  },
  {
    "text": "dictates of the many many features implemented in this interface and actually the some kind of quite",
    "start": "332940",
    "end": "339479"
  },
  {
    "text": "interesting you forget an assessment so it's the command comes with a odd number",
    "start": "339479",
    "end": "346590"
  },
  {
    "text": "that will be a get operation or otherwise a drop the obsess operation",
    "start": "346590",
    "end": "352229"
  },
  {
    "text": "just as defined in these two macros well this is quite quite clear but well this",
    "start": "352229",
    "end": "357570"
  },
  {
    "text": "also call some kind of product will be this application trouble later in a case",
    "start": "357570",
    "end": "363030"
  },
  {
    "text": "studies so besides this there are is nearly any kind of access control",
    "start": "363030",
    "end": "368630"
  },
  {
    "text": "implemented on this our control command which also makes it a great attack interface and later there'll be a more",
    "start": "368630",
    "end": "375120"
  },
  {
    "text": "detailed research and one more more more is not the important thing is that according to the documents of the Wi-Fi",
    "start": "375120",
    "end": "382169"
  },
  {
    "text": "or wireless extension which is in in the in the comment of this header file said",
    "start": "382169",
    "end": "387840"
  },
  {
    "text": "that this is not magic so almost every feature needs to be implemented by the",
    "start": "387840",
    "end": "394250"
  },
  {
    "text": "SOC vendor for them that cheerful uniform implementation in front",
    "start": "394250",
    "end": "400370"
  },
  {
    "text": "of everything them by the soft vendor so which means that they are more likely to",
    "start": "400370",
    "end": "405830"
  },
  {
    "text": "be some issues in the code rather than just made life difficult so this is a",
    "start": "405830",
    "end": "413000"
  },
  {
    "text": "this is a generic code path if you issue a io culture command on a socket which",
    "start": "413000",
    "end": "419750"
  },
  {
    "text": "is open ie with write what will happen and we're pointing it out because this",
    "start": "419750",
    "end": "425450"
  },
  {
    "text": "also describes the access control which is import by the Linux kernel where you actually issued in ultra gentlemen so",
    "start": "425450",
    "end": "432950"
  },
  {
    "text": "starting from this our control we know that there is a lat them the identification module here which may actually put some enforcement on the",
    "start": "432950",
    "end": "440750"
  },
  {
    "text": "operations which is a users with application can do and in our case for Android at 16 X so the SS policy is",
    "start": "440750",
    "end": "448280"
  },
  {
    "text": "going to be important our own cultural command and if our hundreds not not allowed or for for this process it will",
    "start": "448280",
    "end": "455660"
  },
  {
    "text": "be actually denied and going all the way down there there's almost no any kind of access control until before actually",
    "start": "455660",
    "end": "463820"
  },
  {
    "text": "calling to the driver and the vendor specific code there is going to be a consent that they are going to check the",
    "start": "463820",
    "end": "471170"
  },
  {
    "text": "actual project map and see whether this is actually a set object if it is set which means it is actually right",
    "start": "471170",
    "end": "477470"
  },
  {
    "text": "operation and the NetID means the credibility of net administration is going to be enforced and there will be a",
    "start": "477470",
    "end": "484310"
  },
  {
    "text": "sort of normal users with audio scalability will not be able to operate on that socket twist at the",
    "start": "484310",
    "end": "490400"
  },
  {
    "text": "specification document so as you can see from this diagram basically get almost",
    "start": "490400",
    "end": "495850"
  },
  {
    "text": "no other access control is applied on this so um we can see that this is",
    "start": "495850",
    "end": "503510"
  },
  {
    "text": "actually a great service to to play with so we'll be looking into three major",
    "start": "503510",
    "end": "509390"
  },
  {
    "text": "wireless weather Wi-Fi device vendors which was pursuant to welcome the",
    "start": "509390",
    "end": "515180"
  },
  {
    "text": "filament court on a third was immediate expertise also covered most of the Wi-Fi chips which is being used in the Android",
    "start": "515180",
    "end": "521870"
  },
  {
    "text": "devices nowadays on market so if we can find one big is being opened and basically we can route of the devices",
    "start": "521870",
    "end": "529580"
  },
  {
    "text": "and our first case will be a vulnerability that calls LeBonheur dating in Qualcomm what vaccination okay",
    "start": "529580",
    "end": "536660"
  },
  {
    "text": "so this model is it was reported I buy a anonymous source which in the in the",
    "start": "536660",
    "end": "542360"
  },
  {
    "text": "boyfriend was translated as in Jeju which is actually lewodan Jack means anonymous in Chinese pretty interesting",
    "start": "542360",
    "end": "549620"
  },
  {
    "text": "as I know is a CV number 20 2015 5 70",
    "start": "549620",
    "end": "555500"
  },
  {
    "text": "and in the advisory released by Qualcomm so it is also notable that it picks",
    "start": "555500",
    "end": "562070"
  },
  {
    "text": "something which is caused by the odd I will control number rules we mentioned earlier which is add some specific",
    "start": "562070",
    "end": "570560"
  },
  {
    "text": "controls atoms with specific chests in",
    "start": "570560",
    "end": "576320"
  },
  {
    "text": "the control handles themselves adhere so actually we can see that this rule this",
    "start": "576320",
    "end": "582710"
  },
  {
    "text": "odd number rule is not being a well respected of all the well-known by the",
    "start": "582710",
    "end": "588980"
  },
  {
    "text": "vendors so we implemented it way implementing those our control commands",
    "start": "588980",
    "end": "594740"
  },
  {
    "text": "they are not actually strictly for the other set command into even numbers and",
    "start": "594740",
    "end": "600200"
  },
  {
    "text": "order commander second as into odd numbers and a get commands into even",
    "start": "600200",
    "end": "605960"
  },
  {
    "text": "numbers so this actually cost some kind of privacy League in those devices so we have to enforce certain access control",
    "start": "605960",
    "end": "613880"
  },
  {
    "text": "in the code itself instead of relying on the original access control designed by the wireless accession so I decide that",
    "start": "613880",
    "end": "621830"
  },
  {
    "text": "more importantly is a stack overflow vulnerability 16 this advisory but just",
    "start": "621830",
    "end": "628070"
  },
  {
    "text": "one problem here so we all know that stack poor texture has been widely enforced in most of Android the kernels",
    "start": "628070",
    "end": "635330"
  },
  {
    "text": "I mean in the recent was three years so why that a stack overflow vulnerability",
    "start": "635330",
    "end": "640520"
  },
  {
    "text": "still survives in a well at exchanging driver because there should be a",
    "start": "640520",
    "end": "645740"
  },
  {
    "text": "security but the fact is that the stack protector compiler extension is not as",
    "start": "645740",
    "end": "652910"
  },
  {
    "text": "good as we thought it actually misses a lot of functions which actually demoniac",
    "start": "652910",
    "end": "657920"
  },
  {
    "text": "certain level of protection according to some statistics file I think",
    "start": "657920",
    "end": "663230"
  },
  {
    "text": "by Google it only cost like 2% of all the functions but among the many of them",
    "start": "663230",
    "end": "669290"
  },
  {
    "text": "actually demand protection because they have certain buffers on the stack which",
    "start": "669290",
    "end": "674540"
  },
  {
    "text": "user may write into and in this case actually stack protector that protector",
    "start": "674540",
    "end": "683630"
  },
  {
    "text": "strong was being recommended by Qualcomm and Google both of them after this model",
    "start": "683630",
    "end": "689930"
  },
  {
    "text": "was addressed that it should be used to by the by by the kernel if they ever",
    "start": "689930",
    "end": "695570"
  },
  {
    "text": "want to compile the kernel instead of the step protector because after interested some issues in or just architecture and also this stack process",
    "start": "695570",
    "end": "703310"
  },
  {
    "text": "to strong functioning requests GCC 4.9 or later version which is a certain",
    "start": "703310",
    "end": "710480"
  },
  {
    "text": "recent version of the GCC so the volar is the vulnerability sauce is sitting the functioning of WLAN HDD that filter",
    "start": "710480",
    "end": "717830"
  },
  {
    "text": "and we can see on the right side that this data structure actually contains certain certain char are released and",
    "start": "717830",
    "end": "726620"
  },
  {
    "text": "highlighted so it contains two agrees",
    "start": "726620",
    "end": "733780"
  },
  {
    "text": "with the size of 8 bytes and if you check the stock protected code what you",
    "start": "733780",
    "end": "738860"
  },
  {
    "text": "will be aware that actually advises the limit I mean any any buffer equal to or",
    "start": "738860",
    "end": "744500"
  },
  {
    "text": "bigger than 8 bytes are going to be protected by the stop protector but the problem here is that this structure is",
    "start": "744500",
    "end": "750470"
  },
  {
    "text": "actually nested in another structure as a remember and this actually traded",
    "start": "750470",
    "end": "756950"
  },
  {
    "text": "above in the GCC which this original that protects that does not check method structure thing I agree",
    "start": "756950",
    "end": "763190"
  },
  {
    "text": "so it's all these buffers are being overlooked so ders that's why does that carry does not apply and eventually",
    "start": "763190",
    "end": "769670"
  },
  {
    "text": "leads to the vulnerability we are talking about this in decision and here are just the code which causes the stack",
    "start": "769670",
    "end": "777920"
  },
  {
    "text": "overflow it's very straightforward lack of chat on the length when being when the arguments are being passed",
    "start": "777920",
    "end": "784520"
  },
  {
    "text": "eternal from the user space so on the other words the user actually has a",
    "start": "784520",
    "end": "789980"
  },
  {
    "text": "direct control over those events and the contents so a perfect",
    "start": "789980",
    "end": "795020"
  },
  {
    "text": "overflow vulnerability and also the trick is reverse very very thing which is over overflow the stack and override",
    "start": "795020",
    "end": "802940"
  },
  {
    "text": "the LR and try to get the PC control over the whole process but just the one",
    "start": "802940",
    "end": "809390"
  },
  {
    "text": "thing to mention here that actually on on TP for devices it's quite hard to",
    "start": "809390",
    "end": "815060"
  },
  {
    "text": "exploit it because if you are controlling the X 29 X 19 registering",
    "start": "815060",
    "end": "820670"
  },
  {
    "text": "sort of the instead of the conventional ones usually X 0 X 1 X 2 will be easier",
    "start": "820670",
    "end": "825800"
  },
  {
    "text": "to make a GOG chain to actually achieve the DDD target of root so we actually",
    "start": "825800",
    "end": "832490"
  },
  {
    "text": "use a modified version earlier version of dropper I miss combo package on that and to find a pirate budget first to",
    "start": "832490",
    "end": "840350"
  },
  {
    "text": "transfer the at 19 and X 29 control to 0 and X x1 and then there will be 2",
    "start": "840350",
    "end": "846800"
  },
  {
    "text": "Commission of rejecting which then we can use to actually achieve the goal of",
    "start": "846800",
    "end": "853010"
  },
  {
    "text": "leaking the stack pointer and eventually override ad litem so we can gain kind of",
    "start": "853010",
    "end": "858470"
  },
  {
    "text": "read and write after that okay so this is the first case and you can see that",
    "start": "858470",
    "end": "863899"
  },
  {
    "text": "actually a stack overflow vulnerability can still exist in modern devices along with the compiler expansion of that",
    "start": "863899",
    "end": "870709"
  },
  {
    "text": "protection and literally let me well introduced to other more interesting",
    "start": "870709",
    "end": "876399"
  },
  {
    "text": "creases which are tracked into different wireless vendors and also he will",
    "start": "876399",
    "end": "882079"
  },
  {
    "text": "conclude with the Google's latest modification of this issue compensation",
    "start": "882079",
    "end": "889670"
  },
  {
    "text": "case the discovery of that common ability put our attention focused on stability and so I continue the unusual",
    "start": "889670",
    "end": "897709"
  },
  {
    "text": "work and find some other vulnerabilities Omega tax whe and the Broadcom WT and this part is a different section",
    "start": "897709",
    "end": "906290"
  },
  {
    "text": "overflow and it's obviously of its photo so I just finished exporting those parts in two days without any hard coding",
    "start": "906290",
    "end": "912890"
  },
  {
    "text": "single address and a lot of detail reporting to Google yet but taking into account last is very easy to find this",
    "start": "912890",
    "end": "920240"
  },
  {
    "text": "vulnerability by coding so am not very spry that another researcher from Google",
    "start": "920240",
    "end": "925440"
  },
  {
    "text": "traductor Auto reported to Google at December 2015 so the three number of the second case",
    "start": "925440",
    "end": "932940"
  },
  {
    "text": "is CVE 2016 and 0h 20 HP affected or MIDI track devices actually it's a very",
    "start": "932940",
    "end": "942480"
  },
  {
    "text": "classic copy from user issue and the whe handle or coffee into backward from the",
    "start": "942480",
    "end": "949470"
  },
  {
    "text": "user space to the data traction without verifying that the sides of include buffer is less than the sides of aqua",
    "start": "949470",
    "end": "955560"
  },
  {
    "text": "buffer so leading to the introduction over towards the destination address is",
    "start": "955560",
    "end": "962400"
  },
  {
    "text": "a you see OID path and I am going to highlight and is it is a 4050 a 96 bytes",
    "start": "962400",
    "end": "972630"
  },
  {
    "text": "in data fraction and the one of our code has been shown on the slide so you can see that the data length is provided by",
    "start": "972630",
    "end": "978720"
  },
  {
    "text": "user and can be any value so in this way we got a chance to overwrite other",
    "start": "978720",
    "end": "983850"
  },
  {
    "text": "arrivals just behind a UC or any path and in the data section so how to",
    "start": "983850",
    "end": "990690"
  },
  {
    "text": "exploit a tactical idea to achieve canonical execution is or writing a global function puncher located behind a",
    "start": "990690",
    "end": "998730"
  },
  {
    "text": "UCI debug and so I'm going to highlight",
    "start": "998730",
    "end": "1005360"
  },
  {
    "text": "and I'm going to override this function pointer and in this case I'm going to",
    "start": "1005360",
    "end": "1011870"
  },
  {
    "text": "try to hours over either PFW then remove to remove actually to avoid or chrono",
    "start": "1011870",
    "end": "1018560"
  },
  {
    "text": "crash I better not rush other unrelated global variables in gray so I better",
    "start": "1018560",
    "end": "1024260"
  },
  {
    "text": "know the data of this unrelated variables and I also I have to know the",
    "start": "1024260",
    "end": "1029300"
  },
  {
    "text": "relative of start to the AUC or a deeper so I need to know the author here so",
    "start": "1029300",
    "end": "1036800"
  },
  {
    "text": "another one ability which is linking the value of this value are about is necessary so fortunately another command",
    "start": "1036800",
    "end": "1046670"
  },
  {
    "text": "completely classical property there is no function on the red shark will call the 22 user so we just can't the value",
    "start": "1046670",
    "end": "1053780"
  },
  {
    "text": "of this variables be handled you see I'm going to highlight here the",
    "start": "1053780",
    "end": "1063510"
  },
  {
    "text": "two you sleep of debug shows this were ever it's just behind this looks",
    "start": "1063510",
    "end": "1070260"
  },
  {
    "text": "miserable is just behind the aut valuable in this reaction as we turn out",
    "start": "1070260",
    "end": "1075270"
  },
  {
    "text": "to copy the bikini team arrivals to the user space so elected so all its variety",
    "start": "1075270",
    "end": "1080850"
  },
  {
    "text": "can be lived so Microsoft will not rational anymore so now it's time to",
    "start": "1080850",
    "end": "1087270"
  },
  {
    "text": "allocate on pages in you displayed and copy the shellcode to this video and learn as a direct-mapped address of",
    "start": "1087270",
    "end": "1093900"
  },
  {
    "text": "dispute internal it's also known as the return to direct mapped memory which is presidency by materials summer camel is",
    "start": "1093900",
    "end": "1103080"
  },
  {
    "text": "as black as bureau of two years ago I really admire his work and please also note these pages are useful internal",
    "start": "1103080",
    "end": "1110550"
  },
  {
    "text": "space magic activities so that I can exclude the kernel code without any Gog",
    "start": "1110550",
    "end": "1116190"
  },
  {
    "text": "or our key cadence or hard-coded cannot see borders they just excused sheltered in the kernel then I will since I have",
    "start": "1116190",
    "end": "1124710"
  },
  {
    "text": "already authorized the PF doubler removed with the address of the shellcode and so finally I will call a",
    "start": "1124710",
    "end": "1131730"
  },
  {
    "text": "Java API which is start Wi-Fi enabled so large in this way system process which",
    "start": "1131730",
    "end": "1137790"
  },
  {
    "text": "is empty k WM key which is provided by the empty calendar will call the TFW and",
    "start": "1137790",
    "end": "1145830"
  },
  {
    "text": "remove to excuse shellcode eternal space so finally we will gain route privilege",
    "start": "1145830",
    "end": "1153270"
  },
  {
    "text": "and reach out after that we will recover a modified global variables so that's",
    "start": "1153270",
    "end": "1159570"
  },
  {
    "text": "the second let's the second case so here come the final case and I think the",
    "start": "1159570",
    "end": "1165300"
  },
  {
    "text": "previous two changes are kind of warning us because the sort of exploitations is much complicated than the previous two",
    "start": "1165300",
    "end": "1171450"
  },
  {
    "text": "case so firstly it is a user perforate you to the risk condition and the noted",
    "start": "1171450",
    "end": "1176520"
  },
  {
    "text": "problem is the window is very small so I need to refill the period objecting a very short time this is the biggest",
    "start": "1176520",
    "end": "1183060"
  },
  {
    "text": "challenge of this case and we also introduced two separated issue the first",
    "start": "1183060",
    "end": "1188370"
  },
  {
    "text": "one is a lack of really check we're protecting the TT Alfonso so that you can any local",
    "start": "1188370",
    "end": "1195270"
  },
  {
    "text": "application can call the WCW FTL console to the Broadcom driver and attack it the second",
    "start": "1195270",
    "end": "1202770"
  },
  {
    "text": "line is the user preference for the WL enjoyed by PI off concurrently so this",
    "start": "1202770",
    "end": "1210720"
  },
  {
    "text": "one ability will affected all premium and and joyful at Samsung Galaxy stories and valley materials and also a Google",
    "start": "1210720",
    "end": "1218820"
  },
  {
    "text": "Nexus 6p and many other my other phones with a high price and before I introduce",
    "start": "1218820",
    "end": "1229309"
  },
  {
    "text": "how the how the vulnerability is going and how to exploit there is another",
    "start": "1229309",
    "end": "1235710"
  },
  {
    "text": "interesting fact is that the token usually is covered by running some test code while pressing the Wi-Fi part",
    "start": "1235710",
    "end": "1242250"
  },
  {
    "text": "turning on and off repeatedly and crediting and then the kernel crash and current under crash is reproducible so",
    "start": "1242250",
    "end": "1248910"
  },
  {
    "text": "after analyzing the crash I realized I have found the user user profit by or accidentally so by analyzing the crash",
    "start": "1248910",
    "end": "1256919"
  },
  {
    "text": "message from Colonel you tell Zilla the name of process who triggered a crash is throughout 128 it means that it's a",
    "start": "1256919",
    "end": "1264870"
  },
  {
    "text": "vendor's to LP belongs to the same server assistance or is a whole process of Android running in user space and it",
    "start": "1264870",
    "end": "1271169"
  },
  {
    "text": "has several working motors watch you handle the Thunder apathy request from other applications and by analyzing the",
    "start": "1271169",
    "end": "1278700"
  },
  {
    "text": "code stack of the crash you can see that it is pressed while calling the whe",
    "start": "1278700",
    "end": "1284640"
  },
  {
    "text": "outrun show and so this crosstalk belong",
    "start": "1284640",
    "end": "1293610"
  },
  {
    "text": "to the direct e l function handler so after that by reproducing and debugging",
    "start": "1293610",
    "end": "1300540"
  },
  {
    "text": "the issues again again finally I realized life is values afraid you to the risk condition between attack first",
    "start": "1300540",
    "end": "1306150"
  },
  {
    "text": "our control requests and v servers our control request handled by the Box integrity so adjusted that there are",
    "start": "1306150",
    "end": "1317340"
  },
  {
    "text": "there will be two separated issue the first usually is civilly 2016 and to four thousand five the WL and",
    "start": "1317340",
    "end": "1326430"
  },
  {
    "text": "Royal previously empty is able to be called with insufficient privilege it means that any local application can",
    "start": "1326430",
    "end": "1332700"
  },
  {
    "text": "also call this function to change the status of our achieved a directory so in",
    "start": "1332700",
    "end": "1338100"
  },
  {
    "text": "that image you can still add the DHD l control will be processed will process",
    "start": "1338100",
    "end": "1343730"
  },
  {
    "text": "this command which is abyssal which is a",
    "start": "1343730",
    "end": "1351630"
  },
  {
    "text": "kayo C DV private plus one and but there",
    "start": "1351630",
    "end": "1358620"
  },
  {
    "text": "is another permission charge just be founded is over there but it's too late the the the left out of our control",
    "start": "1358620",
    "end": "1365970"
  },
  {
    "text": "comma has already be handled without any permission check so that's why it is a issue and so it just go into that WL",
    "start": "1365970",
    "end": "1375900"
  },
  {
    "text": "Android pre command in this function a large number of commands will be",
    "start": "1375900",
    "end": "1381240"
  },
  {
    "text": "programs will be progress without any permission check and the most attractive to me the CMB starts and CMD stop here",
    "start": "1381240",
    "end": "1391950"
  },
  {
    "text": "and here so you got listen with these",
    "start": "1391950",
    "end": "1398250"
  },
  {
    "text": "commands will trigger the UF bug and after all authorized is if to swat",
    "start": "1398250",
    "end": "1404190"
  },
  {
    "text": "disabling the Wi-Fi concurrently is why the UAF happened and okay so d here's",
    "start": "1404190",
    "end": "1413160"
  },
  {
    "text": "some the second usually it just has no Stevie number and never appeared in Android security balaton but it's",
    "start": "1413160",
    "end": "1418920"
  },
  {
    "text": "absolutely it's possible as a part it's quite simple it just remove one line code here oh sorry the slides crust just",
    "start": "1418920",
    "end": "1432780"
  },
  {
    "text": "wait a second",
    "start": "1432780",
    "end": "1435290"
  },
  {
    "text": "so let me jump to the slides I'm talking about",
    "start": "1443870",
    "end": "1450710"
  },
  {
    "text": "perhaps I found another one ability accidentally Oh a thing is here okay",
    "start": "1456110",
    "end": "1470990"
  },
  {
    "text": "so the patch just remove this line and it means that in case PCIe part already",
    "start": "1470990",
    "end": "1477080"
  },
  {
    "text": "down it should not disabling that it should not disabled are killed calling anymore because when the part is done",
    "start": "1477080",
    "end": "1483590"
  },
  {
    "text": "lots of resources and objects have been freed and to remove code will steal",
    "start": "1483590",
    "end": "1489050"
  },
  {
    "text": "references resort it an object so it will trigger use after free bug but I",
    "start": "1489050",
    "end": "1498520"
  },
  {
    "text": "found about accidentally but how can write how can I write a POC to trigger",
    "start": "1498520",
    "end": "1504080"
  },
  {
    "text": "the UF bug so according to the analyze of Chrono Cross assaults the flowchart of use of a fluid should be like this",
    "start": "1504080",
    "end": "1510200"
  },
  {
    "text": "and if two threads called the WL enjoyed by PI off simultaneously and at first",
    "start": "1510200",
    "end": "1516290"
  },
  {
    "text": "the past age its apps so the first one will go through the yellow branch and my freezer as I in for here to a slice this",
    "start": "1516290",
    "end": "1525620"
  },
  {
    "text": "function after ID touch feel free will free the actual info and finally in will",
    "start": "1525620",
    "end": "1530690"
  },
  {
    "text": "start the backstage return so after that soon after the second story will go",
    "start": "1530690",
    "end": "1535730"
  },
  {
    "text": "through the green branch because the birthdays has already been done here so it will call the college function and",
    "start": "1535730",
    "end": "1542960"
  },
  {
    "text": "finally it will call the aside for racks to trigger the you topper freak but but",
    "start": "1542960",
    "end": "1552160"
  },
  {
    "text": "unfortunately in fact we can't do that because if we want to call that function",
    "start": "1552160",
    "end": "1558050"
  },
  {
    "text": "concurrently we need to call a DHD our control entry but this function is",
    "start": "1558050",
    "end": "1563750"
  },
  {
    "text": "locked you can see a lock here so we conquer we can't call it concurrently so",
    "start": "1563750",
    "end": "1569120"
  },
  {
    "text": "we need to find another solution because finally we which we are going to call it function card concurrently maybe you can",
    "start": "1569120",
    "end": "1575540"
  },
  {
    "text": "find another way not wire HDL control but use another function to call it so",
    "start": "1575540",
    "end": "1582890"
  },
  {
    "text": "fortunately the WL Android of a pair of AutoCAD be hardwired the tht stop",
    "start": "1582890",
    "end": "1588890"
  },
  {
    "text": "the tasty sauce is here and by calling the TV nygel control with a command code",
    "start": "1588890",
    "end": "1596610"
  },
  {
    "text": "which is as IOC SIF flags and but calling this function need",
    "start": "1596610",
    "end": "1604350"
  },
  {
    "text": "requires the caps next meaning privileged wishes which we don't have because we are local applications only",
    "start": "1604350",
    "end": "1612870"
  },
  {
    "text": "root user have this privilege but we can use another Java method to ask its",
    "start": "1612870",
    "end": "1618630"
  },
  {
    "text": "server to do the favor so if we call the parameter which is set by first date and the tip server will help us to to call",
    "start": "1618630",
    "end": "1627270"
  },
  {
    "text": "it L control and in the been destroyed and finally it will call the WL enjoyed myself so in this way we can call that",
    "start": "1627270",
    "end": "1634740"
  },
  {
    "text": "function concurrently so here is a real flow chance of the UF attacker should",
    "start": "1634740",
    "end": "1640920"
  },
  {
    "text": "create a thread to call the W error enjoy repel off to three large objects",
    "start": "1640920",
    "end": "1646760"
  },
  {
    "text": "so he will create us right here and finally it will call the aside attached to free the SI info object after that he",
    "start": "1646760",
    "end": "1655800"
  },
  {
    "text": "will call the field Java API from wired panel apt so the Installer will help us",
    "start": "1655800",
    "end": "1663630"
  },
  {
    "text": "to call the WL Android well enjoyed Wi-Fi off concurrency so finally to add",
    "start": "1663630",
    "end": "1670200"
  },
  {
    "text": "sugar the user for free so the physics of call so that's how we can control the",
    "start": "1670200",
    "end": "1676920"
  },
  {
    "text": "code flow when you stop or happened if the refute object meets several requirements it will reach reach reach",
    "start": "1676920",
    "end": "1685830"
  },
  {
    "text": "and macro here but before that we need to make sure that the path carafe is not",
    "start": "1685830",
    "end": "1692280"
  },
  {
    "text": "equal to the tools for effects and the at all as the s ol ci5 should not much",
    "start": "1692280",
    "end": "1700890"
  },
  {
    "text": "equal to Liza over CIP and the back type should not be either of them this",
    "start": "1700890",
    "end": "1708450"
  },
  {
    "text": "variables are all the members of the fridge objects as I info so we can control that if we can review review the",
    "start": "1708450",
    "end": "1717200"
  },
  {
    "text": "free object so finally we will reach crow here and you can see that fi is the",
    "start": "1717200",
    "end": "1724039"
  },
  {
    "text": "freight object that you can control so here is a function pointer and here is",
    "start": "1724039",
    "end": "1729320"
  },
  {
    "text": "the first argument both of them can be controlled by the tracker so in this way we can control the code flow and if",
    "start": "1729320",
    "end": "1736190"
  },
  {
    "text": "killed Colonel code so since it's a user Africa tourist conditions so we need to",
    "start": "1736190",
    "end": "1743809"
  },
  {
    "text": "care about the window you can see that the window is small I have already asked some print a loads in the kernel so it",
    "start": "1743809",
    "end": "1750500"
  },
  {
    "text": "can tell you will object what's frayed and when it was reused in",
    "start": "1750500",
    "end": "1755720"
  },
  {
    "text": "fact attacker only has point zero two seconds Yuri free to review the objects",
    "start": "1755720",
    "end": "1762590"
  },
  {
    "text": "and excuse coding colonel so the objects refueling is a big challenge so let's talk about raising an",
    "start": "1762590",
    "end": "1771620"
  },
  {
    "text": "object refueling if the reason failed nothing will be happy nothing will be happen except an error returns it laptop",
    "start": "1771620",
    "end": "1778370"
  },
  {
    "text": "logic ok but if reading succeeds but refueling failed kernel crash so we have",
    "start": "1778370",
    "end": "1784490"
  },
  {
    "text": "to find a way to spray the kernel heat efficiently and quickly and also in this",
    "start": "1784490",
    "end": "1789890"
  },
  {
    "text": "case with natural cooling can show the data and the length of the refuel refuel objects so normally I will use the send",
    "start": "1789890",
    "end": "1797450"
  },
  {
    "text": "a message to spread chronology and this come is still working ok so how to spray",
    "start": "1797450",
    "end": "1804890"
  },
  {
    "text": "the chrono heat by Sun message firstly you I will create to process",
    "start": "1804890",
    "end": "1810770"
  },
  {
    "text": "observer and trance and cleanse you standpipe over the TCP connection and",
    "start": "1810770",
    "end": "1817480"
  },
  {
    "text": "using the term message but server should not respond lat",
    "start": "1817480",
    "end": "1822620"
  },
  {
    "text": "just like the coins just like the message center you can see that here",
    "start": "1822620",
    "end": "1828730"
  },
  {
    "text": "maybe the message header and in this structure you need to lock this function",
    "start": "1828730",
    "end": "1834320"
  },
  {
    "text": "pointer message control point to the concepts you want to spray and act just as the server never responded symmetric",
    "start": "1834320",
    "end": "1841340"
  },
  {
    "text": "request from trans the kernel buffer of thematic control will be fermenting permanently stay in the kernel heat so",
    "start": "1841340",
    "end": "1847700"
  },
  {
    "text": "to spray to spray thieves in the kernel just create many pairs of server and",
    "start": "1847700",
    "end": "1853380"
  },
  {
    "text": "and to the above step in this way we it",
    "start": "1853380",
    "end": "1861300"
  },
  {
    "text": "has a 90% success rate to refill the field of charging in the point zero two",
    "start": "1861300",
    "end": "1868800"
  },
  {
    "text": "seconds and the data and the length of the breed object can be freakin sold unfortunately the 3d object which is are",
    "start": "1868800",
    "end": "1876510"
  },
  {
    "text": "trying info its allocated in came a log with the size 256 this approach will not",
    "start": "1876510",
    "end": "1884400"
  },
  {
    "text": "will will be not working if the object is larger example object is 512 this",
    "start": "1884400",
    "end": "1892770"
  },
  {
    "text": "will be filled because apricot so message will allocate each other's same",
    "start": "1892770",
    "end": "1898140"
  },
  {
    "text": "size objects as an interference or with a spring so finally with with with",
    "start": "1898140",
    "end": "1908970"
  },
  {
    "text": "approach we have talking about value will go to a kernel Constitution but after that you still have lots lots of",
    "start": "1908970",
    "end": "1915540"
  },
  {
    "text": "works to do since the reactor restrictions you need to build the GOG",
    "start": "1915540",
    "end": "1921660"
  },
  {
    "text": "gardens to perfect the restriction and the skill code in the kernel after that the first thing you need to do is",
    "start": "1921660",
    "end": "1927510"
  },
  {
    "text": "manipulate the credential of your tax in other words you need to change your UID",
    "start": "1927510",
    "end": "1932850"
  },
  {
    "text": "to 0 and change your security ID to 1 or 2 the ID belong which is belong to the",
    "start": "1932850",
    "end": "1940830"
  },
  {
    "text": "you need process so you need to you can you can but you can't you have had some",
    "start": "1940830",
    "end": "1945990"
  },
  {
    "text": "active inequalities and you can also just the to actually disable the",
    "start": "1945990",
    "end": "1951090"
  },
  {
    "text": "epidemics in the kernel so in this way you don't need to care about resetting poverty but after that you still need to",
    "start": "1951090",
    "end": "1959220"
  },
  {
    "text": "bypass some modules plastic mitigations the most famous one is some socks and we",
    "start": "1959220",
    "end": "1965520"
  },
  {
    "text": "have already disclosed how we pass the sentinels on galaxy s6 and apparently",
    "start": "1965520",
    "end": "1972120"
  },
  {
    "text": "not too distant future we'll also introduce how to perfect the today's",
    "start": "1972120",
    "end": "1977490"
  },
  {
    "text": "special comes on walks in the galaxy s7 but knowledge can be called the yoga",
    "start": "1977490",
    "end": "1983250"
  },
  {
    "text": "nobility are still not be fixed and maybe later so after we found so many",
    "start": "1983250",
    "end": "1991920"
  },
  {
    "text": "well abilities and develop so many exploit about the WFT Google also",
    "start": "1991920",
    "end": "1997890"
  },
  {
    "text": "realized Lots the WFD is a big potential attack surface I enjoyed so a new mitigation",
    "start": "1997890",
    "end": "2003830"
  },
  {
    "text": "has been applied things to life and join security public in this year and the discovery of the CVE 2015 and zero 570",
    "start": "2003830",
    "end": "2013100"
  },
  {
    "text": "which is the first case with transmissions put researchers and attention to the diversity but the",
    "start": "2013100",
    "end": "2019340"
  },
  {
    "text": "second case just chose Google to reduce the sake they'll control formations filter you can see the lytic is the",
    "start": "2019340",
    "end": "2028640"
  },
  {
    "text": "cache which this is a search for the mitigation and the district user has a",
    "start": "2028640",
    "end": "2034130"
  },
  {
    "text": "same variety with the second case so I'm sure that's just the second our second case study just joke will go to reduce",
    "start": "2034130",
    "end": "2040670"
  },
  {
    "text": "it to reduce the Chronos to reduce sake del tronto formation so in the latest",
    "start": "2040670",
    "end": "2049460"
  },
  {
    "text": "exceeding exposure see now only a limited side of socket our controls can",
    "start": "2049460",
    "end": "2055429"
  },
  {
    "text": "be a start by improving these applications and I'm not surprised that the private wtl controls artists a lot",
    "start": "2055429",
    "end": "2062179"
  },
  {
    "text": "right now so if you want to call the Pyrates wtl control on updating Nexus",
    "start": "2062179",
    "end": "2069260"
  },
  {
    "text": "device devices I'm afraid you will catch a b c t9 error from the turn on and",
    "start": "2069260",
    "end": "2075398"
  },
  {
    "text": "light just like this",
    "start": "2075399",
    "end": "2081069"
  },
  {
    "text": "so so finally is a conclusion so after",
    "start": "2083830",
    "end": "2091250"
  },
  {
    "text": "we use three thought mentioned about roots large number of devotees with cocom magitek and the brought on by by",
    "start": "2091250",
    "end": "2097700"
  },
  {
    "text": "cheap stocks i believed as the wrt private l control it was once also",
    "start": "2097700",
    "end": "2104510"
  },
  {
    "text": "attack surface on Android kernel and the normal code in relief curl is really",
    "start": "2104510",
    "end": "2110900"
  },
  {
    "text": "safe because it has in long time and so many researchers are working on large",
    "start": "2110900",
    "end": "2115970"
  },
  {
    "text": "part the vineyard holder still is still buggy so but google reality though good",
    "start": "2115970",
    "end": "2122060"
  },
  {
    "text": "job on surface protection in in this year because it is allowing the WSDL",
    "start": "2122060",
    "end": "2129410"
  },
  {
    "text": "control is just one of their contributions also to some other works use to reduce the more and more attack",
    "start": "2129410",
    "end": "2135770"
  },
  {
    "text": "surface on this kernel so you can check these blocks which which the article is",
    "start": "2135770",
    "end": "2141760"
  },
  {
    "text": "producting and joy with more external differences for more details and but in",
    "start": "2141760",
    "end": "2147560"
  },
  {
    "text": "summary for us routing and choice is becoming more and more challenging to route you enjoyed us again in futures we",
    "start": "2147560",
    "end": "2155240"
  },
  {
    "text": "can try to fund some attack service little knowing just like regular tea or just discover another universal when",
    "start": "2155240",
    "end": "2162170"
  },
  {
    "text": "ability in the january 6th all activity 2015 and a ginger in the repair which is",
    "start": "2162170",
    "end": "2167900"
  },
  {
    "text": "the AWACS are overrun because it happened in generated class or israel in",
    "start": "2167900",
    "end": "2173780"
  },
  {
    "text": "fact it all enjoy automatic and maybe some of you have already heard that the dirty cow because it's really amazing",
    "start": "2173780",
    "end": "2180410"
  },
  {
    "text": "and it's incredible for me but first we are good at finding the merit russian",
    "start": "2180410",
    "end": "2187640"
  },
  {
    "text": "parks the not like the logical but so",
    "start": "2187640",
    "end": "2193010"
  },
  {
    "text": "forth I enjoyed work is actually if we want to disable the uplink totally and",
    "start": "2193010",
    "end": "2199540"
  },
  {
    "text": "we still need an exploitation but logical only can bypass track links but",
    "start": "2199540",
    "end": "2205190"
  },
  {
    "text": "you cannot get the kernel memory of writing so I think it's not good for two",
    "start": "2205190",
    "end": "2211100"
  },
  {
    "text": "writer to write or exploit with the recall",
    "start": "2211100",
    "end": "2216330"
  },
  {
    "text": "so forest we still need to find another another kernel exploit in the future and",
    "start": "2216330",
    "end": "2224040"
  },
  {
    "text": "the final way there's another way which is compromising the pre-tribulation",
    "start": "2224040",
    "end": "2229080"
  },
  {
    "text": "process first and after that you can access some travelers you cannot be full",
    "start": "2229080",
    "end": "2234620"
  },
  {
    "text": "so after that you can attacking the drivers which only acceptable to the",
    "start": "2234620",
    "end": "2239970"
  },
  {
    "text": "privileged process this is another option but exploit but compromise a user",
    "start": "2239970",
    "end": "2246450"
  },
  {
    "text": "user mode user mode process on Android is pretty hard I think it's just another",
    "start": "2246450",
    "end": "2251460"
  },
  {
    "text": "hard work so ok that's all for our presentations thank you for attending",
    "start": "2251460",
    "end": "2257880"
  },
  {
    "text": "and we really appreciate that so if you have questions you can ask not be happy",
    "start": "2257880",
    "end": "2263010"
  },
  {
    "text": "to answer the question and a quick",
    "start": "2263010",
    "end": "2281460"
  },
  {
    "text": "question about the hip spring method is to say that you're putting the quantity",
    "start": "2281460",
    "end": "2287490"
  },
  {
    "text": "to spray in message control right what design yeah yeah yeah message so as far",
    "start": "2287490",
    "end": "2293100"
  },
  {
    "text": "as I know isn't message control it goes through a sanitation check and when you send it via send a message for like so I",
    "start": "2293100",
    "end": "2301200"
  },
  {
    "text": "descriptors and any kind of this in data",
    "start": "2301200",
    "end": "2306590"
  },
  {
    "text": "so talking about the various and powder can be implemented when actually the send message is issued by the abusers",
    "start": "2306590",
    "end": "2313260"
  },
  {
    "text": "based applications so we are talking that these any study advisor and I mean",
    "start": "2313260",
    "end": "2320160"
  },
  {
    "text": "it when you use message control for hip spraying yeah usually it goes through a",
    "start": "2320160",
    "end": "2325650"
  },
  {
    "text": "valley input type citation for file descriptors because this is the filters",
    "start": "2325650",
    "end": "2330690"
  },
  {
    "text": "usually is used to transfer file script roles and special data for specific protocols so as far as say you know and",
    "start": "2330690",
    "end": "2338430"
  },
  {
    "text": "I might be wrong it goes through a sanitation check and therefore it does",
    "start": "2338430",
    "end": "2343860"
  },
  {
    "text": "get allocated but then it is immediately freed because the tension-filled unless your spring data",
    "start": "2343860",
    "end": "2350050"
  },
  {
    "text": "matches exactly the phallus Kryptos are a indicate enriches unlikely first think",
    "start": "2350050",
    "end": "2357640"
  },
  {
    "text": "that the cases we are talking here is actually not just the photos fall discourses it's just some kind of generic message exchange but this a",
    "start": "2357640",
    "end": "2364900"
  },
  {
    "text": "misogynist I don't see any sense either in this mechanism yet so basically POA actually the sender message is also",
    "start": "2364900",
    "end": "2371830"
  },
  {
    "text": "using our ATO 5.3 2015 85 the vector",
    "start": "2371830",
    "end": "2376900"
  },
  {
    "text": "over ruin exploitation to actually count a concept another piece of our vector",
    "start": "2376900",
    "end": "2383200"
  },
  {
    "text": "early after the one which we are going to over into and I have volume controls okay",
    "start": "2383200",
    "end": "2388300"
  },
  {
    "text": "data so essentially in the single Jalalabad anyone know thank you John",
    "start": "2388300",
    "end": "2399070"
  },
  {
    "text": "thank you guys [Applause]",
    "start": "2399070",
    "end": "2405889"
  }
]