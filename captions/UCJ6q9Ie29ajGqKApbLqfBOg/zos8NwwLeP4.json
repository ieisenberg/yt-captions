[
  {
    "text": "[Music]",
    "start": "1130",
    "end": "14690"
  },
  {
    "text": "hello everyone and welcome to anti-forensics reverse engineering a leading phone forensic tool",
    "start": "15679",
    "end": "23600"
  },
  {
    "text": "my name is matt burgin and i'm a red team member and vulnerability researcher for corelogic security i have released",
    "start": "23760",
    "end": "30640"
  },
  {
    "text": "just over 50 security advisories in the last 10 years and today i would like to talk to you about three of them",
    "start": "30640",
    "end": "38640"
  },
  {
    "text": "so we have a bit of ground to cover but we'll quickly review what we'll be talking about i'll give you an idea of",
    "start": "38719",
    "end": "44719"
  },
  {
    "text": "what initially caught my attention how i went about getting targets to play with what i had to do in order to set up a",
    "start": "44719",
    "end": "51360"
  },
  {
    "text": "debugging environment my reverse engineering process things i found after breaking their",
    "start": "51360",
    "end": "57120"
  },
  {
    "text": "encryption algorithm concerns that i have and a way you might be able to protect your data",
    "start": "57120",
    "end": "64719"
  },
  {
    "text": "so what does it celebrate well pretty much what you see is what you get it's a tool designed to help break into",
    "start": "65600",
    "end": "71280"
  },
  {
    "text": "mobile phones and enable the user to recover information from it it can unlock encrypted devices remove",
    "start": "71280",
    "end": "78479"
  },
  {
    "text": "lock screens read application data etc this information can then be imported",
    "start": "78479",
    "end": "83840"
  },
  {
    "text": "into analysis software that they also develop",
    "start": "83840",
    "end": "88240"
  },
  {
    "text": "it's an honorable goal right they want to help law enforcement solve criminal cases and bring justice to victims",
    "start": "89040",
    "end": "95439"
  },
  {
    "text": "forensic evidence undoubtedly helps do this more information for investigators means leads and cases are established",
    "start": "95439",
    "end": "102560"
  },
  {
    "text": "easier and relevant information can be uncovered more quickly i'm sure these tools have helped make",
    "start": "102560",
    "end": "108000"
  },
  {
    "text": "the job of law enforcement investigators much easier normally companies like celebrity don't want",
    "start": "108000",
    "end": "113920"
  },
  {
    "text": "their tools to be leaked either with reasons ranging from not wanting to help quote unquote the bad guys or protecting",
    "start": "113920",
    "end": "121040"
  },
  {
    "text": "trade secrets when you google tools like these though",
    "start": "121040",
    "end": "126399"
  },
  {
    "text": "you often see both sides of the coin groups like the human rights watch privacy international eff the aclu",
    "start": "126399",
    "end": "135040"
  },
  {
    "text": "as well as many others who agree that in some way shape or form law enforcement hacking can be harmful and not just in",
    "start": "135040",
    "end": "141840"
  },
  {
    "text": "the united states there was a court petition recently filed in israel for their foreign",
    "start": "141840",
    "end": "147360"
  },
  {
    "text": "defense ministry to no longer allow celebrity to be sold to hong kong i'm",
    "start": "147360",
    "end": "152640"
  },
  {
    "text": "not sure what happened to this this was in august of 2020 but not too long after",
    "start": "152640",
    "end": "157680"
  },
  {
    "text": "that celebrity announced that it would no longer sell to customers in russia",
    "start": "157680",
    "end": "162800"
  },
  {
    "text": "after an israeli newspaper discussed celebrates tools being used to hack political opposition",
    "start": "162800",
    "end": "169680"
  },
  {
    "text": "gizmodo also released a story about a k-12 school district in the united states who was relying on these tools",
    "start": "169680",
    "end": "176400"
  },
  {
    "text": "for investigations into student-teacher relationships",
    "start": "176400",
    "end": "181280"
  },
  {
    "text": "also in the u.s i went through some of our public information websites i found groups like the secret service",
    "start": "181519",
    "end": "187760"
  },
  {
    "text": "spending half a million dollars on tools from celebrity the city of beverly hills spent fifty",
    "start": "187760",
    "end": "193840"
  },
  {
    "text": "thousand dollars on tools from celebrity and the department of homeland security spent",
    "start": "193840",
    "end": "199519"
  },
  {
    "text": "somewhere between 30 and 35 million dollars on tools from celebrate you'll you'll see the cost for a used and or",
    "start": "199519",
    "end": "206480"
  },
  {
    "text": "new version of these tools in just a moment and with that number in mind the budget of 35",
    "start": "206480",
    "end": "212000"
  },
  {
    "text": "million dollars is pretty mind-boggling checking out google trends it is not",
    "start": "212000",
    "end": "217360"
  },
  {
    "text": "just the united states these tools are being used it's pretty much everywhere",
    "start": "217360",
    "end": "223280"
  },
  {
    "text": "uh so others have talked about these tools before i'm by no means the first the source code for celebrate had been",
    "start": "225599",
    "end": "232080"
  },
  {
    "text": "leaked at one point encryption mechanisms that we'll talk about later on had been broken",
    "start": "232080",
    "end": "237360"
  },
  {
    "text": "celebrate had been hacked into and lost almost a terabyte of data someone even ran doom on one of the",
    "start": "237360",
    "end": "242879"
  },
  {
    "text": "celebrate you feds which is kind of cool i didn't know if i would be wasting my time here or not but",
    "start": "242879",
    "end": "248400"
  },
  {
    "text": "i was definitely curious about what was going on",
    "start": "248400",
    "end": "254000"
  },
  {
    "text": "uh so how do you get a hold of these though right well it turns out there are two models a consumer model and a",
    "start": "254000",
    "end": "259600"
  },
  {
    "text": "government model one that's more commonly used by law enforcement and you can acquire either model through",
    "start": "259600",
    "end": "266080"
  },
  {
    "text": "ebay and they range in costs between 100 and 2500",
    "start": "266080",
    "end": "271840"
  },
  {
    "text": "if you look kind of mid-center screen you'll see this one particular one has a valid",
    "start": "271840",
    "end": "277280"
  },
  {
    "text": "license through 2025 it costs two thousand dollars usd",
    "start": "277280",
    "end": "282400"
  },
  {
    "text": "and presumably you can still get updates for this device",
    "start": "282400",
    "end": "287199"
  },
  {
    "text": "so you can also get the you fed uh just as a software a normal thick application",
    "start": "288400",
    "end": "293600"
  },
  {
    "text": "install for a laptop i think you might also need a special hub to go with it",
    "start": "293600",
    "end": "298639"
  },
  {
    "text": "but i'm not sure on the left side of the screen you'll see the mix and models that",
    "start": "298639",
    "end": "305199"
  },
  {
    "text": "i've just taken some sample screenshots of what these tools can go after and on",
    "start": "305199",
    "end": "310240"
  },
  {
    "text": "the right hand side you'll see the version and settings the top right one is from the physical you fed device",
    "start": "310240",
    "end": "317199"
  },
  {
    "text": "and the bottom right one is from the you fed 4 pc software",
    "start": "317199",
    "end": "323960"
  },
  {
    "text": "so i keep up with their release notes in case anything particularly interesting pops up and to give you an idea of what",
    "start": "325520",
    "end": "332479"
  },
  {
    "text": "their latest tools support you fed 4 pc has around 31 000 different",
    "start": "332479",
    "end": "338639"
  },
  {
    "text": "extraction profiles it supports up almost 11 000 applications and can read data from",
    "start": "338639",
    "end": "345360"
  },
  {
    "text": "applications ranging from things like text messaging apps to your social media apps to travel",
    "start": "345360",
    "end": "351680"
  },
  {
    "text": "and of course your dating applications like tinder and grinder",
    "start": "351680",
    "end": "356880"
  },
  {
    "text": "so some of the exploits used by these tools i don't know",
    "start": "358000",
    "end": "363199"
  },
  {
    "text": "i can't say when they became public i can't say if celebrate first discovered one or more of these",
    "start": "363199",
    "end": "368720"
  },
  {
    "text": "vulnerabilities and prior to being discovered in the public or if they were first publicly",
    "start": "368720",
    "end": "373919"
  },
  {
    "text": "documented and then later implemented in their tools i believe at least in the case of",
    "start": "373919",
    "end": "379360"
  },
  {
    "text": "checkpoint or checkpaint it was implemented later on but that was mostly based off of media coverage",
    "start": "379360",
    "end": "386800"
  },
  {
    "text": "the content i had access to at the time i was a couple years old",
    "start": "386800",
    "end": "391840"
  },
  {
    "text": "there were recent or there weren't any recent or unreleased privilege escalation exploits in the archives that",
    "start": "391840",
    "end": "397199"
  },
  {
    "text": "i found but there was still some interesting content worth reviewing",
    "start": "397199",
    "end": "402960"
  },
  {
    "text": "if for some reason your ufed device can't compromise a target you can send it off to them and their",
    "start": "404800",
    "end": "410800"
  },
  {
    "text": "services team will run some exploits that they keep behind the scenes third-party forensic firms often have",
    "start": "410800",
    "end": "417440"
  },
  {
    "text": "services teams with other capabilities that aren't otherwise offered through their product line in the case of",
    "start": "417440",
    "end": "423360"
  },
  {
    "text": "celebrity at least what you do is you send in your the device that you want to be compromised and they'll send it back",
    "start": "423360",
    "end": "429840"
  },
  {
    "text": "to you in an unlocked form this is what their services team capabilities look like currently and you",
    "start": "429840",
    "end": "436720"
  },
  {
    "text": "can always find the up-to-date information on their website but it doesn't change too often",
    "start": "436720",
    "end": "444160"
  },
  {
    "text": "so i had some devices and i needed to get system privilege that i could set up my debugging environment they try to lock you into",
    "start": "446800",
    "end": "454960"
  },
  {
    "text": "a pretty jailed environment you're not able to access things like the task manager the start menu has a",
    "start": "454960",
    "end": "461199"
  },
  {
    "text": "lot of reduced items in it you can't access the file system directly and all of this is done through local",
    "start": "461199",
    "end": "467440"
  },
  {
    "text": "policy so what i did was you still have to be able to connect these things to the internet",
    "start": "467440",
    "end": "473520"
  },
  {
    "text": "to receive updates etc so one of the the features that is left",
    "start": "473520",
    "end": "479039"
  },
  {
    "text": "available is the windows networking manager so i use the windows networking manager",
    "start": "479039",
    "end": "484240"
  },
  {
    "text": "to open up a file dialog using a certificate based authentication",
    "start": "484240",
    "end": "490639"
  },
  {
    "text": "for wireless and once i had a file dialog there very similar to a citrus escape if anybody is",
    "start": "490639",
    "end": "497840"
  },
  {
    "text": "familiar with those i simply traverse to the system 32 directory where i could hit cmd.exe",
    "start": "497840",
    "end": "505360"
  },
  {
    "text": "then i copied over a meterpreter payload where i could then run it and have it connect back to a c2 which i controlled",
    "start": "505360",
    "end": "512240"
  },
  {
    "text": "then i set up a local forward from my c2 to the target celebrate device for the port 445",
    "start": "512240",
    "end": "520320"
  },
  {
    "text": "so that i could deliver eternal blue and escalate to system privilege",
    "start": "520320",
    "end": "525680"
  },
  {
    "text": "from here i simply added myself a local administrator user that i could log into",
    "start": "525680",
    "end": "530720"
  },
  {
    "text": "and i was able to continue from there",
    "start": "530720",
    "end": "535240"
  },
  {
    "text": "so the ufed software does have some anti-debugging features compiled in you can see on the right hand side the",
    "start": "536720",
    "end": "543040"
  },
  {
    "text": "themed error message that you receive when you launch the application and the debugger is also running",
    "start": "543040",
    "end": "549120"
  },
  {
    "text": "those familiar with the media know it can be a pretty tough battle i didn't do anything original in this",
    "start": "549120",
    "end": "554640"
  },
  {
    "text": "case i just read what was implemented by others before me and use that",
    "start": "554640",
    "end": "561200"
  },
  {
    "text": "the combination of plugins i was able to bypass the",
    "start": "561360",
    "end": "566560"
  },
  {
    "text": "debugger detection mid screen you'll see a cheap motorola phone attached to the",
    "start": "566560",
    "end": "572080"
  },
  {
    "text": "celebrity console powered by a smd rework station with some",
    "start": "572080",
    "end": "577120"
  },
  {
    "text": "duct tape to hold the power connectors in the debugger is ollie debug it's sitting at",
    "start": "577120",
    "end": "583839"
  },
  {
    "text": "a break point on the shot 256 function from common dll and i've used",
    "start": "583839",
    "end": "589760"
  },
  {
    "text": "olliescript to help dump the file and packing dlls rebuild the import",
    "start": "589760",
    "end": "596160"
  },
  {
    "text": "address tables as well as other plugins like strong od and phantom to help hide",
    "start": "596160",
    "end": "601360"
  },
  {
    "text": "the process the debugger process",
    "start": "601360",
    "end": "605399"
  },
  {
    "text": "so i'm not the first person to break epr it was first broken in 2017 by somebody",
    "start": "607200",
    "end": "613200"
  },
  {
    "text": "associated with a hack against celebrity i didn't realize the epr had",
    "start": "613200",
    "end": "618399"
  },
  {
    "text": "already been broken until after i had finished breaking the first version myself uh the experience breaking it myself",
    "start": "618399",
    "end": "625120"
  },
  {
    "text": "though was pretty invaluable as version 2 was similar but slightly more difficult",
    "start": "625120",
    "end": "630720"
  },
  {
    "text": "it slowly progressed over the years but they're at a point now where the architecture they have chosen has given",
    "start": "630720",
    "end": "636560"
  },
  {
    "text": "them very limited options on what additional measures they can take in the future so i don't suspect this will be",
    "start": "636560",
    "end": "643279"
  },
  {
    "text": "unbreakable anytime soon but within these archives they're just zip files once you decrypt them",
    "start": "643279",
    "end": "650720"
  },
  {
    "text": "and they have some some of their their hacker goodies in there",
    "start": "650720",
    "end": "656480"
  },
  {
    "text": "so a little bit of background these are aes 256 cbc encrypted archives",
    "start": "656880",
    "end": "662880"
  },
  {
    "text": "each vendor has their own archive things that apply generically are stored together",
    "start": "662880",
    "end": "668320"
  },
  {
    "text": "the decryption process happens in memory it doesn't rely on a standard library",
    "start": "668320",
    "end": "673440"
  },
  {
    "text": "and i tried two different approaches only one of which i had real success with i tried hooking directly into their",
    "start": "673440",
    "end": "679839"
  },
  {
    "text": "libraries and making calls to the relevant functions and it started to work but i wasn't making enough ground",
    "start": "679839",
    "end": "686480"
  },
  {
    "text": "so i moved to simply attaching to the process with the debugger and observing what was going on in assembly and memory",
    "start": "686480",
    "end": "693839"
  },
  {
    "text": "and then recreating that same process outside",
    "start": "693839",
    "end": "698320"
  },
  {
    "text": "um so uh with the first version a shot 256 hash",
    "start": "700480",
    "end": "705920"
  },
  {
    "text": "of a string is immediately identifiable it's hard coded inside of the decryption dll",
    "start": "705920",
    "end": "713279"
  },
  {
    "text": "there's a header that you can also discard um basically byte 22 everything after that is the actual",
    "start": "714560",
    "end": "720480"
  },
  {
    "text": "encrypted cipher text and everything before that is a header you can kind of",
    "start": "720480",
    "end": "725519"
  },
  {
    "text": "ignore everything before that byte 22 goes away in the next version",
    "start": "725519",
    "end": "731600"
  },
  {
    "text": "for version 2 we start with an encrypted header and use an aes key and iv that is hard coded in the unpacking dll to",
    "start": "731600",
    "end": "738240"
  },
  {
    "text": "decrypt it the first envelope is open now josh hardin a colleague of mine helped reverse some of the second envelope for",
    "start": "738240",
    "end": "745279"
  },
  {
    "text": "this one we have two or we xor two d words together which produces the ending d word of a sha-256",
    "start": "745279",
    "end": "753040"
  },
  {
    "text": "i use this d word to find the sha-256 hash from within the unpacking dll and",
    "start": "753040",
    "end": "758320"
  },
  {
    "text": "the next iv is taken from the file header the second envelope is open now and",
    "start": "758320",
    "end": "764000"
  },
  {
    "text": "third envelope can then be opened where the final key material resides using this key material everything after",
    "start": "764000",
    "end": "770639"
  },
  {
    "text": "byte 128 can be decrypted in blocks of 65536 producing a valid zip file at the",
    "start": "770639",
    "end": "777600"
  },
  {
    "text": "end so version 3 is the same as version 2",
    "start": "777600",
    "end": "784240"
  },
  {
    "text": "for the most part with the bytes used to derive subsequent keys having been updated i believe their approach going forward",
    "start": "784240",
    "end": "790560"
  },
  {
    "text": "will be to rotate these bytes with each new release this would require someone to reverse",
    "start": "790560",
    "end": "796639"
  },
  {
    "text": "engineer the correct bytemap each release or develop an automated method to do so",
    "start": "796639",
    "end": "803440"
  },
  {
    "text": "here's a screenshot of the decrypter that i've written and released you'll notice the key material is not",
    "start": "804320",
    "end": "810720"
  },
  {
    "text": "shown and has not been publicly released my goal is not to give everyone blanket access to these resources but to provide",
    "start": "810720",
    "end": "817279"
  },
  {
    "text": "proof that these problems do exist and we should be talking about them more openly",
    "start": "817279",
    "end": "822480"
  },
  {
    "text": "i think the content of these archives is just as important though and we'll talk about that also",
    "start": "822480",
    "end": "829839"
  },
  {
    "text": "so what do you get one of the things you get is a post exploitation toolkit called knockout ng",
    "start": "830639",
    "end": "837760"
  },
  {
    "text": "this is heavily relied on this tool facili facilitates different types of device access for the user",
    "start": "837760",
    "end": "844880"
  },
  {
    "text": "for example you can use knockout ng to build an image that will load adb with no",
    "start": "844880",
    "end": "850560"
  },
  {
    "text": "authentication requirements you can use it to run automated reading of the device's file system",
    "start": "850560",
    "end": "856639"
  },
  {
    "text": "or you can use it to remove authentication or run attacks against encrypted partitions",
    "start": "856639",
    "end": "862240"
  },
  {
    "text": "for example on the right we have a function from the binary brute force this function has a generic call to the",
    "start": "862240",
    "end": "869680"
  },
  {
    "text": "kmtz run command function nested in a while loop which iterates over a password dictionary",
    "start": "869680",
    "end": "876480"
  },
  {
    "text": "an interesting limitation in this function is that when it reads the next password",
    "start": "876480",
    "end": "882079"
  },
  {
    "text": "to be tested on line 104 this limits the length of that password",
    "start": "882079",
    "end": "887360"
  },
  {
    "text": "to 32 characters what about when the device is up and",
    "start": "887360",
    "end": "893600"
  },
  {
    "text": "running apks like mr meseeks help automate the process of evidence collection by",
    "start": "893600",
    "end": "899519"
  },
  {
    "text": "running binaries or performing tasks and like a good misigs it'll disappear when it's done",
    "start": "899519",
    "end": "905600"
  },
  {
    "text": "in our case mr misig starts an action.delete intent on itself",
    "start": "905600",
    "end": "910800"
  },
  {
    "text": "mr meeseeks is a reference to the rick and morty tv show episode where jerry has to improve his golf game and he has",
    "start": "910800",
    "end": "918240"
  },
  {
    "text": "a mr meeseeks box uh that you pop and out comes a mr me seeks to give him some",
    "start": "918240",
    "end": "923839"
  },
  {
    "text": "extra help perhaps even more interesting is",
    "start": "923839",
    "end": "928880"
  },
  {
    "text": "alohomora alohomora is a reference to a magical spell and the harry potter series which is used to unlock locks",
    "start": "928880",
    "end": "936000"
  },
  {
    "text": "it seems like a fitting name given the feature is designed to remove the lock screen from affected devices",
    "start": "936000",
    "end": "942000"
  },
  {
    "text": "publicly facing this feature is called lockpick i don't know much about it it's probably the least investigated",
    "start": "942000",
    "end": "948720"
  },
  {
    "text": "portion of my research and is likely to be one of the future projects down the road",
    "start": "948720",
    "end": "956160"
  },
  {
    "text": "one of the biggest issues i found relates to adb some of the available extractions will rely on the android debug bridge",
    "start": "956560",
    "end": "963920"
  },
  {
    "text": "forensic tools will often use adb to silo their tools or download information from the target device",
    "start": "963920",
    "end": "971360"
  },
  {
    "text": "at least when i was working on this research the celebrite devices instructed the user to permanently",
    "start": "971360",
    "end": "976720"
  },
  {
    "text": "accept the rsa keys on the devices being extracted that may or may not still be the case",
    "start": "976720",
    "end": "982560"
  },
  {
    "text": "i'm not sure i found the private keys used for their adb authentication",
    "start": "982560",
    "end": "988480"
  },
  {
    "text": "within hard-coded deal were hard-coded within dlls here on the right-hand side you can see",
    "start": "988480",
    "end": "994000"
  },
  {
    "text": "the location to where these keys are and their cross references to them",
    "start": "994000",
    "end": "999920"
  },
  {
    "text": "maybe i was wrong though dead code or something right i thought a quick and easy test would be to plug in some",
    "start": "1000720",
    "end": "1006560"
  },
  {
    "text": "android phones to my celebrate devices i had five or six at this point and a lot",
    "start": "1006560",
    "end": "1011920"
  },
  {
    "text": "of 40 or so motorola devices and see what fingerprint they gave when connecting",
    "start": "1011920",
    "end": "1017360"
  },
  {
    "text": "i'm sure you can guess what happened they all shared the same fingerprint so what does that mean",
    "start": "1017360",
    "end": "1023519"
  },
  {
    "text": "well every celebrate regardless of owner country government whatever you want to",
    "start": "1023519",
    "end": "1028558"
  },
  {
    "text": "say they all used the same keys a total of three keys were found hard-coded in the adb client and a",
    "start": "1028559",
    "end": "1035520"
  },
  {
    "text": "fourth key was found alongside the knockout ng tool you could get a copy of the private keys",
    "start": "1035520",
    "end": "1041760"
  },
  {
    "text": "by hooking the right functions or just copying the bytes straight from the adb clients dll",
    "start": "1041760",
    "end": "1047360"
  },
  {
    "text": "with the you fed ui instructing users to permanently trust these keys anyone with",
    "start": "1047360",
    "end": "1052640"
  },
  {
    "text": "access to them could come back and later reattach to the target devices without needing the you fed at all and without",
    "start": "1052640",
    "end": "1058640"
  },
  {
    "text": "any additional user prompts",
    "start": "1058640",
    "end": "1062160"
  },
  {
    "text": "a design like this makes it possible for someone to plant fake evidence on a device with plausible attribution that",
    "start": "1063919",
    "end": "1070240"
  },
  {
    "text": "it was a you fed having connected and not a malicious actor doing something nodding",
    "start": "1070240",
    "end": "1075440"
  },
  {
    "text": "now it isn't just this easy an actual malicious actor would need to stomp on the file metadata to place the device in",
    "start": "1075440",
    "end": "1082480"
  },
  {
    "text": "the possession of the target individual or potentially other considerations that",
    "start": "1082480",
    "end": "1087760"
  },
  {
    "text": "would be need to be made as well from an operational perspective though the exploits you would need to make",
    "start": "1087760",
    "end": "1094240"
  },
  {
    "text": "these changes are on the file system of the celebrite device and you can access",
    "start": "1094240",
    "end": "1099440"
  },
  {
    "text": "them now i debated about not including these",
    "start": "1099440",
    "end": "1105520"
  },
  {
    "text": "next slides since they're only relevant to the united states but i kept them in in the hopes that your takeaway will be",
    "start": "1105520",
    "end": "1111440"
  },
  {
    "text": "a curiosity about how this may work in your own country so with all this in mind i started",
    "start": "1111440",
    "end": "1117520"
  },
  {
    "text": "having other questions like regarding zero days should we use zero days for law enforcement",
    "start": "1117520",
    "end": "1123840"
  },
  {
    "text": "well i'd be lying if i said i knew the right answer but i've worked with enough zero days to know that each we don't",
    "start": "1123840",
    "end": "1129440"
  },
  {
    "text": "patch exposes us a little bit and sometimes a lot the exploits used to collect evidence",
    "start": "1129440",
    "end": "1135679"
  },
  {
    "text": "from someone suspected of a murder are the same kind of exploits that are often used by a country's adversaries against",
    "start": "1135679",
    "end": "1141840"
  },
  {
    "text": "them and they could potentially even be for the same vulnerabilities with over 50 public advisories that i",
    "start": "1141840",
    "end": "1148400"
  },
  {
    "text": "have released it takes both both hands to count the number of times i've gotten an email from someone saying they knew",
    "start": "1148400",
    "end": "1154640"
  },
  {
    "text": "about the vulnerability that i had just published at least in my experience the implied",
    "start": "1154640",
    "end": "1160240"
  },
  {
    "text": "secrecy is just not nearly as effective as one might think it is and more often",
    "start": "1160240",
    "end": "1165280"
  },
  {
    "text": "than not you're probably not the only person that knows about a particular vulnerability",
    "start": "1165280",
    "end": "1170720"
  },
  {
    "text": "so how do you balance public risk versus reward",
    "start": "1170720",
    "end": "1175760"
  },
  {
    "text": "i don't envy the people involved but the u.s does have a policy and process i",
    "start": "1175919",
    "end": "1180960"
  },
  {
    "text": "think in and of itself has some flaws but we do have one some of the issues i see with it at",
    "start": "1180960",
    "end": "1186320"
  },
  {
    "text": "least in my own reading is that it only applies to vulnerabilities discovered by the u.s government",
    "start": "1186320",
    "end": "1192400"
  },
  {
    "text": "presumably when law enforcement reaches out to a third party like cass and they use exploits they keep behind the scenes",
    "start": "1192400",
    "end": "1200400"
  },
  {
    "text": "the use of those exploits is not subject to the same risk for reward evaluation further the ones that are",
    "start": "1200400",
    "end": "1207840"
  },
  {
    "text": "under this policy have part 2a and part 2b of appendix b which act as a",
    "start": "1207840",
    "end": "1213200"
  },
  {
    "text": "catch-all for continued use until they're no longer effective some exploits have lived for a decade",
    "start": "1213200",
    "end": "1219840"
  },
  {
    "text": "that's exposed risk for everybody regardless if you break the law or not and finally we have no transparency into",
    "start": "1219840",
    "end": "1227360"
  },
  {
    "text": "the input and output of this policy the executive summary is supposedly not",
    "start": "1227360",
    "end": "1232720"
  },
  {
    "text": "classified but everything else is and i've been unable to find the unclassified summaries and trust me i've",
    "start": "1232720",
    "end": "1239600"
  },
  {
    "text": "tried so i reported all of these issues to",
    "start": "1239600",
    "end": "1246159"
  },
  {
    "text": "celebrate and although they disagreed with the risk they produced patches for all of the issues that we brought",
    "start": "1246159",
    "end": "1252159"
  },
  {
    "text": "forward surely things like this should have been caught before though right",
    "start": "1252159",
    "end": "1257280"
  },
  {
    "text": "why should forensic examiners in other countries have access to the same key material used to image devices",
    "start": "1257280",
    "end": "1264320"
  },
  {
    "text": "in another country before our disclosure this was the case",
    "start": "1264320",
    "end": "1269520"
  },
  {
    "text": "going back to at least march of 2016 and in all reality probably earlier than that",
    "start": "1269520",
    "end": "1275679"
  },
  {
    "text": "this got me wondering whether or not tools like these have to comply with any sort of minimum standards or",
    "start": "1275679",
    "end": "1281919"
  },
  {
    "text": "accreditation process and the short answer is they don't we do have the cftt",
    "start": "1281919",
    "end": "1288480"
  },
  {
    "text": "the cftt is a testing program from nist that validates that tools function as their",
    "start": "1288480",
    "end": "1295360"
  },
  {
    "text": "features describe that is if a forensic tool is being marketed as able to extract instagram",
    "start": "1295360",
    "end": "1302640"
  },
  {
    "text": "messages from a samsung 10 running android 11 they'll build a test case that validates",
    "start": "1302640",
    "end": "1308640"
  },
  {
    "text": "this nothing in their methodology though calls for the type of testing that we've",
    "start": "1308640",
    "end": "1313919"
  },
  {
    "text": "talked about today i would call it adversarial testing the cftt does seem like a great",
    "start": "1313919",
    "end": "1320720"
  },
  {
    "text": "framework to extend this type of testing into though it produces valid findings as it is",
    "start": "1320720",
    "end": "1326960"
  },
  {
    "text": "today and extending it while also adopting legislation that requires tools like these to undergo and pass tests",
    "start": "1326960",
    "end": "1334720"
  },
  {
    "text": "including the type of adversarial tests we've talked about today would provide the ability to regulate",
    "start": "1334720",
    "end": "1341360"
  },
  {
    "text": "and enforce standards on these tools i think that's good for everybody i think it's good for from everyone from a",
    "start": "1341360",
    "end": "1348640"
  },
  {
    "text": "forensic analyst and prosecutors who rely on these tools to gather evidence all the way to someone who has been",
    "start": "1348640",
    "end": "1355280"
  },
  {
    "text": "accused of a crime i also believe the way that any process",
    "start": "1355280",
    "end": "1362480"
  },
  {
    "text": "is implemented to acquire forensic evidence should be publicly known and freely available for scrutiny",
    "start": "1362480",
    "end": "1369039"
  },
  {
    "text": "in a fair system of justice the accused should have a right to confront their accusers",
    "start": "1369039",
    "end": "1374720"
  },
  {
    "text": "and that should extend to information about the way data are gathered for use in criminal investigations",
    "start": "1374720",
    "end": "1381039"
  },
  {
    "text": "the core issue is that every citizen should have the right to cross-examine the evidence acquired the origin of the",
    "start": "1381039",
    "end": "1388080"
  },
  {
    "text": "process used to acquire it the acquisition process itself how acquired",
    "start": "1388080",
    "end": "1393280"
  },
  {
    "text": "data were processed or analyzed and how any conclusions were drawn from those",
    "start": "1393280",
    "end": "1398320"
  },
  {
    "text": "efforts it's my opinion that our community should be advocating for transparency",
    "start": "1398320",
    "end": "1406080"
  },
  {
    "text": "open source solutions and legislative policies designed to strike an appropriate balance between human rights",
    "start": "1406080",
    "end": "1413200"
  },
  {
    "text": "and the needs of law enforcement while also respecting national security",
    "start": "1413200",
    "end": "1418480"
  },
  {
    "text": "basically any government agency not part of the military acting in defense of the",
    "start": "1418480",
    "end": "1423840"
  },
  {
    "text": "nation should be required to disclose vulnerabilities identified or used in criminal investigations",
    "start": "1423840",
    "end": "1430559"
  },
  {
    "text": "using industry recognized procedures and standards we're at least starting to see some",
    "start": "1430559",
    "end": "1436799"
  },
  {
    "text": "courts requiring disclosure relating to technologies used in criminal investigations and i'm hopeful this is a",
    "start": "1436799",
    "end": "1444000"
  },
  {
    "text": "trend we see continue",
    "start": "1444000",
    "end": "1447200"
  },
  {
    "text": "so occasionally i see questions like um can i defend against celebrate and i",
    "start": "1449039",
    "end": "1454080"
  },
  {
    "text": "like a challenge so the answer is yes but also very much no the easiest to deploy defenses are while",
    "start": "1454080",
    "end": "1461840"
  },
  {
    "text": "the android os is running and i wrote an example of how that could work generally speaking though i wouldn't run",
    "start": "1461840",
    "end": "1468080"
  },
  {
    "text": "anything like lockup and expect to be safe from forensics tools as that's unlikely to be the case",
    "start": "1468080",
    "end": "1474799"
  },
  {
    "text": "lockup specifically is a user land application and a proof of concept it's designed to fail open makes no attempt",
    "start": "1474799",
    "end": "1482000"
  },
  {
    "text": "to hide itself and is only meant to show that some defenses are possible not to provide them in depth",
    "start": "1482000",
    "end": "1488720"
  },
  {
    "text": "the concept does not require root privilege but does require the device admin privilege",
    "start": "1488720",
    "end": "1494400"
  },
  {
    "text": "it will start on boot and attempt to defend itself against some of the techniques used by the you fed very much",
    "start": "1494400",
    "end": "1500159"
  },
  {
    "text": "dependent upon the extraction type and what device you've installed it on",
    "start": "1500159",
    "end": "1506080"
  },
  {
    "text": "so how does it work the application registers to receive broadcasts that can be used to influence",
    "start": "1506880",
    "end": "1513200"
  },
  {
    "text": "what checks are performed and when in the case of mr meeseeks for example a",
    "start": "1513200",
    "end": "1518720"
  },
  {
    "text": "broadcast is sent when any application is installed and that's received by lockup",
    "start": "1518720",
    "end": "1524320"
  },
  {
    "text": "lockup will check the sha-256 hash and other certificate characteristics of the",
    "start": "1524320",
    "end": "1530000"
  },
  {
    "text": "applications certificate against known malicious applications and if it ever found then the a call to",
    "start": "1530000",
    "end": "1537440"
  },
  {
    "text": "factory reset the device occurs this is also true for exploits and binaries that copy on to the device as",
    "start": "1537440",
    "end": "1543840"
  },
  {
    "text": "well lockup also lets you set a plausibility a possible deniability password through",
    "start": "1543840",
    "end": "1550000"
  },
  {
    "text": "the user accessibility service when this service is enabled the lock screen will leak one character of your",
    "start": "1550000",
    "end": "1556799"
  },
  {
    "text": "password at a time and lockup can register to receive these keystrokes",
    "start": "1556799",
    "end": "1561919"
  },
  {
    "text": "having an application receive your keystrokes is also a good reason not to run an application",
    "start": "1561919",
    "end": "1567520"
  },
  {
    "text": "and so it's optional and disabled by default i'll say it one more time",
    "start": "1567520",
    "end": "1573120"
  },
  {
    "text": "don't run a lockup on your actual device let's check out a demo though",
    "start": "1573120",
    "end": "1578799"
  },
  {
    "text": "so here we see lockup's user interface and is connected to the celebrity it's a",
    "start": "1580000",
    "end": "1585039"
  },
  {
    "text": "rather old install of android and here we're at the emergency screen and we're",
    "start": "1585039",
    "end": "1590159"
  },
  {
    "text": "performing a file system based extraction to a removable drive the adb client will then connect to the",
    "start": "1590159",
    "end": "1598159"
  },
  {
    "text": "adb daemon on the target device the it'll instruct you to always accept the",
    "start": "1598159",
    "end": "1603760"
  },
  {
    "text": "key you hit ok and now the celebrate is connecting to pull some information that",
    "start": "1603760",
    "end": "1609120"
  },
  {
    "text": "it will use to decide what to do next and now it's decided and is installing",
    "start": "1609120",
    "end": "1614720"
  },
  {
    "text": "applications and copying things over to the device which has been detected now and a lockup",
    "start": "1614720",
    "end": "1621440"
  },
  {
    "text": "then sent a command to factory reset the device uh and and now",
    "start": "1621440",
    "end": "1627279"
  },
  {
    "text": "it's this the demo is over um all right so",
    "start": "1627279",
    "end": "1634240"
  },
  {
    "text": "um a slightly better way patching aosp seems like a better way to go",
    "start": "1637679",
    "end": "1643840"
  },
  {
    "text": "something that you simply can't easily remove as in the case of lock up you can just uninstall it before you begin to",
    "start": "1643840",
    "end": "1650880"
  },
  {
    "text": "image your device and then the checks no longer apply and you're good to go um so i wanted to have",
    "start": "1650880",
    "end": "1657600"
  },
  {
    "text": "something that wasn't as easy to remove so i forked lineage os",
    "start": "1657600",
    "end": "1662960"
  },
  {
    "text": "um and i've been working on a set of patches um in my spare time but i'm by",
    "start": "1662960",
    "end": "1668799"
  },
  {
    "text": "no means a seasoned android developer um so during this talk if any of you",
    "start": "1668799",
    "end": "1674240"
  },
  {
    "text": "have had the thought there's a way better way to do this uh sweet um you're",
    "start": "1674240",
    "end": "1679520"
  },
  {
    "text": "part of the reason why i submitted to this conference these are the areas of the of aosp that",
    "start": "1679520",
    "end": "1685919"
  },
  {
    "text": "i've decided to patch but i'd be really curious to hear from anyone else if you have other ideas of",
    "start": "1685919",
    "end": "1691919"
  },
  {
    "text": "different methods that can be used or different locations that we can apply patches in that kind of thing i'm very",
    "start": "1691919",
    "end": "1698080"
  },
  {
    "text": "interested to hear that and my contact information is at the end of the slides",
    "start": "1698080",
    "end": "1703919"
  },
  {
    "text": "so with as many disclosures as i've had i still wasn't really sure what to expect worst case i figured they'd try",
    "start": "1705120",
    "end": "1711360"
  },
  {
    "text": "to stop the disclosure and oops i've wound up with a fbi party van outside my house and",
    "start": "1711360",
    "end": "1717840"
  },
  {
    "text": "some maybe understandably angry exploit developers at my gateway well the reality wasn't quite that um",
    "start": "1717840",
    "end": "1725679"
  },
  {
    "text": "they were the people at celebrate were very friendly and they worked to address the issues in a timely way",
    "start": "1725679",
    "end": "1731840"
  },
  {
    "text": "i certainly wouldn't be afraid to disclose other issues that i come across to them again",
    "start": "1731840",
    "end": "1737360"
  },
  {
    "text": "they they were a decent group of people um i also ended up getting nominated for",
    "start": "1737360",
    "end": "1742799"
  },
  {
    "text": "some ponies um i got a couple cves issued for this and um also i was able",
    "start": "1742799",
    "end": "1748880"
  },
  {
    "text": "to present for you folks here today so all in all i think it was a good research process",
    "start": "1748880",
    "end": "1754080"
  },
  {
    "text": "and i was i was quite happy with it some of the future work i'll probably",
    "start": "1754080",
    "end": "1760080"
  },
  {
    "text": "look into includes alohomora that was easily the least researched",
    "start": "1760080",
    "end": "1765200"
  },
  {
    "text": "part of everything that i looked into so far i also have some ideas on how to detect",
    "start": "1765200",
    "end": "1772559"
  },
  {
    "text": "and respond to the automated device detection feature that the ufed relies on when you plug it in the first thing",
    "start": "1772559",
    "end": "1779120"
  },
  {
    "text": "that it tries to do is automatically identify what phone it's talking to and it has a particular algorithm that it",
    "start": "1779120",
    "end": "1784640"
  },
  {
    "text": "goes through when doing that i also have equipment from a few other players in the market that i'll",
    "start": "1784640",
    "end": "1790480"
  },
  {
    "text": "eventually open up and i'm always interested to hear if you have access to them as well",
    "start": "1790480",
    "end": "1797120"
  },
  {
    "text": "so advisories are in the qr code thank you to everybody who helped make the research public",
    "start": "1799039",
    "end": "1804640"
  },
  {
    "text": "celebrate the corelogic vulnerability disclosure board real special thanks to derek brown and",
    "start": "1804640",
    "end": "1811200"
  },
  {
    "text": "hank josh hardin and clayton monroe they really went out of their way to",
    "start": "1811200",
    "end": "1816480"
  },
  {
    "text": "help with the disclosure process and kind of getting things pushed through if you have any questions you can find",
    "start": "1816480",
    "end": "1822240"
  },
  {
    "text": "me on efnet freenode netgarage or worst case level at corelogic.com thank you",
    "start": "1822240",
    "end": "1828240"
  },
  {
    "text": "everybody for your time",
    "start": "1828240",
    "end": "1831799"
  }
]