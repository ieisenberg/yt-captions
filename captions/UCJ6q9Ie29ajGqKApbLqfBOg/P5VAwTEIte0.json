[
  {
    "start": "0",
    "end": "35000"
  },
  {
    "text": "[Music]",
    "start": "1130",
    "end": "14690"
  },
  {
    "text": "hello this is siam ball from the chinese university of hong kong today i'm presenting a new kind of",
    "start": "19359",
    "end": "26000"
  },
  {
    "text": "attack called fingerprint jacking attack and this is a practical fingerprint",
    "start": "26000",
    "end": "31279"
  },
  {
    "text": "authorization hijacking attack in android apps and first of all let me give you a",
    "start": "31279",
    "end": "37440"
  },
  {
    "start": "35000",
    "end": "229000"
  },
  {
    "text": "little bit introduction on myself i'm a second year phd student in the",
    "start": "37440",
    "end": "42640"
  },
  {
    "text": "chinese chinese university of hong kong and i'm from the lab mobi tech and our lab actually did",
    "start": "42640",
    "end": "49600"
  },
  {
    "text": "a lot of work on oas security before if you are interested you can check our",
    "start": "49600",
    "end": "54800"
  },
  {
    "text": "previous talk including blackhead asia last year and blackhead europe",
    "start": "54800",
    "end": "59920"
  },
  {
    "text": "in 2016. and for me my personal interests are mostly on web and android",
    "start": "59920",
    "end": "66560"
  },
  {
    "text": "application security and i also love ctf and bug bounty basically anything happened in the",
    "start": "66560",
    "end": "72640"
  },
  {
    "text": "security community and you can find me on twitter and this is my twitter handle",
    "start": "72640",
    "end": "81040"
  },
  {
    "text": "okay let's directly jump into the demonstration and you can see now here we have an",
    "start": "81520",
    "end": "89280"
  },
  {
    "text": "device running android 10 and we first open the app called the magix",
    "start": "89280",
    "end": "96159"
  },
  {
    "text": "magix is a root manager app on android if you are an android developer or",
    "start": "96159",
    "end": "103600"
  },
  {
    "text": "if you are a security researcher for android then you should be you may be very",
    "start": "103600",
    "end": "109200"
  },
  {
    "text": "familiar with this one and it is just an app that can control which apps on your device can have the",
    "start": "109200",
    "end": "116640"
  },
  {
    "text": "root access support that your device is already rooted then we can see in this in our",
    "start": "116640",
    "end": "123759"
  },
  {
    "text": "magix manager currently there's no no apps being granted the rule permission then we open",
    "start": "123759",
    "end": "130640"
  },
  {
    "text": "our demonstration app which is a very simple diary app which only have two buttons one is to",
    "start": "130640",
    "end": "136560"
  },
  {
    "text": "create a new diary and another to view existing diaries then well the victim is using this app",
    "start": "136560",
    "end": "143200"
  },
  {
    "text": "suddenly but he will he'll sing this interface of the",
    "start": "143200",
    "end": "148800"
  },
  {
    "text": "lock screen if you like me you use your fingerprint to unlock your mobile device",
    "start": "148800",
    "end": "154000"
  },
  {
    "text": "every day then you can have this impulse to put your fingerprint finger onto the fingerprint sensor right so",
    "start": "154000",
    "end": "162080"
  },
  {
    "text": "this is what our victim did he put his fingerprint onto the sensor",
    "start": "162080",
    "end": "168720"
  },
  {
    "text": "and try to unlock the device then then yeah it is unlocked and history his uh",
    "start": "168720",
    "end": "177040"
  },
  {
    "text": "the interface is redirected back to the uh diary app however we can see that inside",
    "start": "177040",
    "end": "183040"
  },
  {
    "text": "the diary app it actually executes some command with the root permission we can see it",
    "start": "183040",
    "end": "188959"
  },
  {
    "text": "executed the id commands and return with the uid0 so up to this point you may you may",
    "start": "188959",
    "end": "196879"
  },
  {
    "text": "guess what happened are we presenting some local privilege privilege exclamation box here actually",
    "start": "196879",
    "end": "203920"
  },
  {
    "text": "it's not we're just presenting some ui attack techniques so",
    "start": "203920",
    "end": "210159"
  },
  {
    "text": "we can see that go back to the magics manager and see that inside the matches manager",
    "start": "210159",
    "end": "217760"
  },
  {
    "text": "actually remember the list right now the list contains our demonstration app meaning",
    "start": "217760",
    "end": "222879"
  },
  {
    "text": "that our app has been granted the root permission inside the magic through manager silently",
    "start": "222879",
    "end": "229440"
  },
  {
    "start": "229000",
    "end": "570000"
  },
  {
    "text": "okay talking about the ui attack the one keyword jumping to your mind may",
    "start": "229440",
    "end": "235519"
  },
  {
    "text": "be click jacking because our attack also called fingerprint jacking so click jacking is",
    "start": "235519",
    "end": "242400"
  },
  {
    "text": "a very classic attack happening web browser have a history like 20 about 20 years",
    "start": "242400",
    "end": "250799"
  },
  {
    "text": "so basically if you uh the attacker will make some malicious",
    "start": "250799",
    "end": "256239"
  },
  {
    "text": "websites and meanwhile underneath the malicious website there will be some",
    "start": "256239",
    "end": "261919"
  },
  {
    "text": "target website so that when the victim thinks it is like playing some game in",
    "start": "261919",
    "end": "266960"
  },
  {
    "text": "this malicious website by click here and click there what actually happens that is clicking",
    "start": "266960",
    "end": "272720"
  },
  {
    "text": "those buttons in the background which will authorize the money transfer",
    "start": "272720",
    "end": "278400"
  },
  {
    "text": "for example in the online bank so our observation or our",
    "start": "278400",
    "end": "286560"
  },
  {
    "text": "uh motivation is that nowadays people use the fingerprints everywhere",
    "start": "286560",
    "end": "293120"
  },
  {
    "text": "especially on mobile devices for different purpose for example we can use simply use our fingerprint to",
    "start": "293120",
    "end": "299520"
  },
  {
    "text": "authorize the money transferring in our mobile wallet or",
    "start": "299520",
    "end": "305360"
  },
  {
    "text": "we can use the fingerprint to unlock this some app like the diary app in our first pre",
    "start": "305360",
    "end": "311680"
  },
  {
    "text": "first demonstration so the fingerprint jack the high",
    "start": "311680",
    "end": "316960"
  },
  {
    "text": "fingerprint jacking attack we present here is uh basically it's a ui attack and the target of this attack",
    "start": "316960",
    "end": "324080"
  },
  {
    "text": "is to to let the user trick the user into authorizing some dangerous actions",
    "start": "324080",
    "end": "330479"
  },
  {
    "text": "without noticing it so the interesting findings we want to share with you today is that first of",
    "start": "330479",
    "end": "336720"
  },
  {
    "text": "all we find several attack techniques to conduct this fingerprint jacking attack",
    "start": "336720",
    "end": "344000"
  },
  {
    "text": "and here the highlight highlighted keyword is practical and we'll explain later why our attack can be",
    "start": "344000",
    "end": "350080"
  },
  {
    "text": "considered practical and then uh because we find that",
    "start": "350080",
    "end": "355440"
  },
  {
    "text": "actually in android android uh have some mitigation to block this kind of attack",
    "start": "355440",
    "end": "360880"
  },
  {
    "text": "however we managed to bypass the mitigation in android os mentioning about the ui",
    "start": "360880",
    "end": "368560"
  },
  {
    "text": "attack in android the first thing we need to introduce here is the android activity",
    "start": "368560",
    "end": "374400"
  },
  {
    "text": "lifecycle which is basically a state machine model for android activities",
    "start": "374400",
    "end": "379600"
  },
  {
    "text": "active activity in android just means the windows or page page in android ui in either interface",
    "start": "379600",
    "end": "387600"
  },
  {
    "text": "and in this below diagram it's a simplified illustration of the of",
    "start": "387600",
    "end": "393919"
  },
  {
    "text": "the activity lifecycle model you can see when some activity is created it will first go into",
    "start": "393919",
    "end": "399759"
  },
  {
    "text": "some create state and then it will go to the start state and finally stays in the",
    "start": "399759",
    "end": "404800"
  },
  {
    "text": "resume state when it is running then after some time when it is switching",
    "start": "404800",
    "end": "410479"
  },
  {
    "text": "it will switch to the background or some other app is bring brought to the foreground covering",
    "start": "410479",
    "end": "416160"
  },
  {
    "text": "it then it will go into the pulse state and if it is invisible it will finally go into the",
    "start": "416160",
    "end": "422000"
  },
  {
    "text": "stop state now you have we have the basic idea of how the",
    "start": "422000",
    "end": "428479"
  },
  {
    "text": "activity life cycle works then let's look at uh what's the activity like",
    "start": "428479",
    "end": "433919"
  },
  {
    "text": "life cycle behavior when some normal apps do the fingerprint authorization here we are here we have",
    "start": "433919",
    "end": "441520"
  },
  {
    "text": "we have some normal apps and when it tries to do the fingerprint authorization or or authentication it",
    "start": "441520",
    "end": "448080"
  },
  {
    "text": "will start or launch a new activity which is contains the fingerprint",
    "start": "448080",
    "end": "454240"
  },
  {
    "text": "authorization functionality and then this new activity fingerprint activity will go through the create",
    "start": "454240",
    "end": "460720"
  },
  {
    "text": "state create start and stays in the resume state and later when the switch to the background",
    "start": "460720",
    "end": "468319"
  },
  {
    "text": "or some other apps goes into the foreground then it will go into the pulse state",
    "start": "468319",
    "end": "476560"
  },
  {
    "text": "and then if it is invisible it will go into the stop state well",
    "start": "476560",
    "end": "483599"
  },
  {
    "text": "right now the very important question for attackers is that whether the fingerprint activity can",
    "start": "483599",
    "end": "491280"
  },
  {
    "text": "continue listening to fingerprint inputs when it is in the foreground",
    "start": "491280",
    "end": "497759"
  },
  {
    "text": "and this brings up our initial idea for the fingerprint jacking",
    "start": "499759",
    "end": "505840"
  },
  {
    "text": "attack the basic idea is like this we have first of all we assume that we already have some",
    "start": "505840",
    "end": "512159"
  },
  {
    "text": "malicious app installed on victim device and this malicious app actually can disguise itself as some normal benign",
    "start": "512159",
    "end": "519518"
  },
  {
    "text": "app then after some attack setup finally what the malicious app can do is that he can",
    "start": "519519",
    "end": "527920"
  },
  {
    "text": "launch the fingerprint activity in the target app",
    "start": "527920",
    "end": "533279"
  },
  {
    "text": "and meanwhile he can use some coloring activity to cover the fingerprint activity",
    "start": "533279",
    "end": "539360"
  },
  {
    "text": "and he can make some visual contents to lure the victim to input his",
    "start": "539360",
    "end": "545440"
  },
  {
    "text": "fingerprints and actually the fingerprint is goes into the background target app so now the",
    "start": "545440",
    "end": "553040"
  },
  {
    "text": "question is what kind of attack setup can allow this uh",
    "start": "553040",
    "end": "558240"
  },
  {
    "text": "hosing happen to to to introduce that we actually need to",
    "start": "558240",
    "end": "563519"
  },
  {
    "text": "consider different apps implementation pattern and different android os versions",
    "start": "563519",
    "end": "570639"
  },
  {
    "text": "here this uh complex style diagram oh summarize uh",
    "start": "572399",
    "end": "580080"
  },
  {
    "text": "all the fingerprint jacking attack techniques we know including some previously uh",
    "start": "580080",
    "end": "586240"
  },
  {
    "text": "introduced pre some known attacks as well as some new attacks we represent in this",
    "start": "586240",
    "end": "592160"
  },
  {
    "text": "talk and to tell you the truth uh we didn't do this research from the",
    "start": "592160",
    "end": "599440"
  },
  {
    "text": "beginning to do such a thorough study on this at first i was uh trying to do the bug",
    "start": "599440",
    "end": "605519"
  },
  {
    "text": "hunting in some particular mobile wallet app and then i find one one technique to make this fingerprint",
    "start": "605519",
    "end": "612320"
  },
  {
    "text": "checking happen and then further we we do more study and grow into this complex diagram",
    "start": "612320",
    "end": "620160"
  },
  {
    "text": "and you can see on the right hand side there are actually five attack techniques translucent attack wake up bypass",
    "start": "620160",
    "end": "627600"
  },
  {
    "text": "including the wrist attack those in the red boxes are our new attacks",
    "start": "627600",
    "end": "633760"
  },
  {
    "text": "and the attacks for the tech techniques can be categorized in three categories the",
    "start": "633760",
    "end": "639360"
  },
  {
    "text": "first one they exploit some unusual features or some special permissions",
    "start": "639360",
    "end": "644399"
  },
  {
    "text": "in android apps and the second one they exploit apps implementation flaws and",
    "start": "644399",
    "end": "650640"
  },
  {
    "text": "there are also some attacks that exploit the bot in the android system itself",
    "start": "650640",
    "end": "656880"
  },
  {
    "text": "first of all let's review some existing techniques the earliest similar attacks",
    "start": "657200",
    "end": "663440"
  },
  {
    "text": "i can find online is also a presentation in blackhead euro blackhead usa 2015",
    "start": "663440",
    "end": "671440"
  },
  {
    "text": "because at that time android didn't even provide an official api for fingerprints",
    "start": "671440",
    "end": "677680"
  },
  {
    "text": "the the speakers the their introduced attack are targeting some old samsung device and",
    "start": "677680",
    "end": "685040"
  },
  {
    "text": "then more recently in 2018 in some academic paper titled",
    "start": "685040",
    "end": "690160"
  },
  {
    "text": "broken fingers the authors proposed to use the draw or draw over other apps",
    "start": "690160",
    "end": "697279"
  },
  {
    "text": "permission which is a quite dangerous permission to to perform the ui confusion attack for fingerprint",
    "start": "697279",
    "end": "703360"
  },
  {
    "text": "authorization at this permission you may have already know that but are widely used by those for example",
    "start": "703360",
    "end": "711839"
  },
  {
    "text": "some video video call when you do some video calling some app you can see this smaller windows floating around and",
    "start": "711839",
    "end": "719519"
  },
  {
    "text": "always display above other apps and in the same paper they also propose to to",
    "start": "719519",
    "end": "728160"
  },
  {
    "text": "the malicious app can actually control the brightness of your screen and they can they can adjust the",
    "start": "728160",
    "end": "734959"
  },
  {
    "text": "brightness to to to be very dark then the user may the victim is saying that he needs to unlock the device and he",
    "start": "734959",
    "end": "741519"
  },
  {
    "text": "will put his fingerprint on the sensor which makes the attack happen and",
    "start": "741519",
    "end": "749680"
  },
  {
    "start": "748000",
    "end": "772000"
  },
  {
    "text": "what do we want for our fingerprint jacking attack is that first of all",
    "start": "749680",
    "end": "754720"
  },
  {
    "text": "we want our malicious app to require no permissions meaning that the victim",
    "start": "754720",
    "end": "760320"
  },
  {
    "text": "doesn't need to grant any permission either at installation or during the app is",
    "start": "760320",
    "end": "765600"
  },
  {
    "text": "running and also we want our attack to work on even the latest android versions",
    "start": "765600",
    "end": "773279"
  },
  {
    "start": "772000",
    "end": "868000"
  },
  {
    "text": "so first of all let's look at what a developer what developers can use if they want to",
    "start": "773279",
    "end": "779920"
  },
  {
    "text": "implement fingerprint functionality in android they have two choices the first one is fingerprint manager api",
    "start": "779920",
    "end": "787279"
  },
  {
    "text": "which is introduced in android 6. this api only provides the",
    "start": "787279",
    "end": "792480"
  },
  {
    "text": "function to call the fingerprint sensor but they don't provide the ui user interface and then uh later",
    "start": "792480",
    "end": "800320"
  },
  {
    "text": "starting from android 9 they also introduced it by metric from api which is a new api for fingerprint",
    "start": "800320",
    "end": "806800"
  },
  {
    "text": "and it has a unified ui and it's more secure however it is not backward compatible actually",
    "start": "806800",
    "end": "813120"
  },
  {
    "text": "nowadays in the market you you can we still see a lot of apps are still using the old",
    "start": "813120",
    "end": "818240"
  },
  {
    "text": "uh fingerprint manager api and this is our target for in this presentation",
    "start": "818240",
    "end": "825360"
  },
  {
    "text": "and let's go back to our original question can apps listen to the fingerprint inputs in the background",
    "start": "825360",
    "end": "831360"
  },
  {
    "text": "the answer is that it it depends on which android system you're using if the",
    "start": "831360",
    "end": "837600"
  },
  {
    "text": "victim runs the android a or android 7 basically before android 9 then yes the",
    "start": "837600",
    "end": "844399"
  },
  {
    "text": "app can listen to fingerprint inputs in the background however starting from android 9 they added some mitigation",
    "start": "844399",
    "end": "851920"
  },
  {
    "text": "into the fingerprint manager api to block the background fingerprint inputs you can also see that",
    "start": "851920",
    "end": "858399"
  },
  {
    "text": "we you may notice that we put a question mark here so does this mitigation actually works and",
    "start": "858399",
    "end": "864880"
  },
  {
    "text": "how can we find any bypass to it before we talk about those uh first",
    "start": "864880",
    "end": "872000"
  },
  {
    "start": "868000",
    "end": "917000"
  },
  {
    "text": "we will talk we will introduce the case when the victim is running older android",
    "start": "872000",
    "end": "877519"
  },
  {
    "text": "versions for example android 8 because before android 9 there's no",
    "start": "877519",
    "end": "883680"
  },
  {
    "text": "system level protection so the apps need to block the background fingerprint input by themselves",
    "start": "883680",
    "end": "889760"
  },
  {
    "text": "and we observe that there are two common implementation patterns for apps using fingerprint the first one",
    "start": "889760",
    "end": "897120"
  },
  {
    "text": "that is that they will the apps will cancel the fingerprint listening",
    "start": "897120",
    "end": "902480"
  },
  {
    "text": "inside the impulse event of the activity and the second one is that they will cancel it in the",
    "start": "902480",
    "end": "909279"
  },
  {
    "text": "stop event so which one is correct the answer is they need to cancel it in on pulse even why",
    "start": "909279",
    "end": "918399"
  },
  {
    "text": "so to explain to explain it first we need to introduce the some property for android",
    "start": "918399",
    "end": "924880"
  },
  {
    "text": "activity called translucent and active and translucent activity",
    "start": "924880",
    "end": "930240"
  },
  {
    "text": "running in the foreground carrying some background activity then the background activity will be considered",
    "start": "930240",
    "end": "936399"
  },
  {
    "text": "visible by the system and that means it will only go into pulse state but not",
    "start": "936399",
    "end": "941600"
  },
  {
    "text": "a stop state and this uh diagram shows the difference in activity life cycle on the",
    "start": "941600",
    "end": "949680"
  },
  {
    "text": "left hand side it's a normal case where the active one the background activity",
    "start": "949680",
    "end": "954720"
  },
  {
    "text": "starts activity 2 which is covering then because the covering is a normal",
    "start": "954720",
    "end": "960880"
  },
  {
    "text": "activity then the background activity ftp 1 will go into the pause state and then go into",
    "start": "960880",
    "end": "966959"
  },
  {
    "text": "stop state as usual on the right hand side is the case where the covering has the translucent process",
    "start": "966959",
    "end": "974079"
  },
  {
    "text": "then the background activity one will only go into the pause state but not the stop state",
    "start": "974079",
    "end": "981519"
  },
  {
    "start": "980000",
    "end": "1047000"
  },
  {
    "text": "so this leads to our first attack called translucent attack in this attack uh the malicious app",
    "start": "981519",
    "end": "990240"
  },
  {
    "text": "will first try to launch or try to invoke the target apps fingerprint",
    "start": "990240",
    "end": "995600"
  },
  {
    "text": "activity and let the target app listening to users fingerprint inputs and then at the",
    "start": "995600",
    "end": "1002000"
  },
  {
    "text": "meantime it will also launch a malicious carving a malicious",
    "start": "1002000",
    "end": "1007279"
  },
  {
    "text": "which is some prepared activity where some visual content can alert the victim to input his fingerprint",
    "start": "1007279",
    "end": "1014880"
  },
  {
    "text": "now because this covering has translucent property then the background fingerprint activity",
    "start": "1014880",
    "end": "1020240"
  },
  {
    "text": "which only cancel in the stop state will not trigger the canceling process",
    "start": "1020240",
    "end": "1025760"
  },
  {
    "text": "so it can it can continue listening to user fingerprint so when user put his fingerprint onto",
    "start": "1025760",
    "end": "1032880"
  },
  {
    "text": "the sensor he thinks he he is using uh he's using it to authorize what he's seen",
    "start": "1032880",
    "end": "1038798"
  },
  {
    "text": "on the screen however his fingerprint is utilized by the background activity to",
    "start": "1038799",
    "end": "1045120"
  },
  {
    "text": "to to authorize other scenes so a natural question is how many apps in the market",
    "start": "1045120",
    "end": "1051840"
  },
  {
    "start": "1047000",
    "end": "1089000"
  },
  {
    "text": "have this implementation flaw we actually built this automatic static analyzer based on flow",
    "start": "1051840",
    "end": "1058000"
  },
  {
    "text": "droid to do this valuation we collected more than 2000 sample apps from markets",
    "start": "1058000",
    "end": "1065200"
  },
  {
    "text": "and then among them our analyzer can success successfully handle about 700",
    "start": "1065200",
    "end": "1071760"
  },
  {
    "text": "apps um and inside just 700 apps we find that almost half of them contain",
    "start": "1071760",
    "end": "1077600"
  },
  {
    "text": "implementation flaws notice that this uh analyze the rebuilding only performs conservative analyze this",
    "start": "1077600",
    "end": "1085440"
  },
  {
    "text": "means the situation uh true situation can be even worse",
    "start": "1085440",
    "end": "1090960"
  },
  {
    "text": "okay so this attack we just mentioned only works on older android versions so what happened",
    "start": "1090960",
    "end": "1096320"
  },
  {
    "text": "in android 9 starting from android 9 the add mitigation to block the background",
    "start": "1096320",
    "end": "1101520"
  },
  {
    "text": "fingerprint inputs and we look look into the source code of the android project and find that the",
    "start": "1101520",
    "end": "1108720"
  },
  {
    "text": "mitigation logic is like this it will it will try it will uh",
    "start": "1108720",
    "end": "1114799"
  },
  {
    "text": "the mitigation will be triggered whenever the activity stack changes so when the activities that",
    "start": "1114799",
    "end": "1120799"
  },
  {
    "text": "change it means that there are some new activities uh appearing it's being created or some",
    "start": "1120799",
    "end": "1126320"
  },
  {
    "text": "activities being uh destroyed",
    "start": "1126320",
    "end": "1131600"
  },
  {
    "text": "then the system will check whether current foreground activity belongs to the same",
    "start": "1131600",
    "end": "1137600"
  },
  {
    "text": "app as that app is using the finger listening to the fingerprint inputs if they don't belong",
    "start": "1137600",
    "end": "1143840"
  },
  {
    "text": "they don't belong to the same app then the system will queue that that will keep the fingerprint listener for you",
    "start": "1143840",
    "end": "1151200"
  },
  {
    "start": "1149000",
    "end": "1224000"
  },
  {
    "text": "but can we find the bypass if we want to when we want to find the bypass for the",
    "start": "1151200",
    "end": "1156559"
  },
  {
    "text": "mitigation it means that we want to find a bot in the mitigation and well we all know that when we want",
    "start": "1156559",
    "end": "1163520"
  },
  {
    "text": "to find the bar we just first thing we go to is go to thinking about those corner cases",
    "start": "1163520",
    "end": "1170080"
  },
  {
    "text": "so what's the corner case here remember that the this mitigation is only triggered when",
    "start": "1170080",
    "end": "1175360"
  },
  {
    "text": "the activity stack changes so how about we first put the activity fingerprint activity in the background",
    "start": "1175360",
    "end": "1181919"
  },
  {
    "text": "and then let's the fingerprint listener start listening then there will",
    "start": "1181919",
    "end": "1186960"
  },
  {
    "text": "be no stack change after it starts listening so also let's recall how this developers",
    "start": "1186960",
    "end": "1194640"
  },
  {
    "text": "they usually do the implantation they usually have such kind of as such",
    "start": "1194640",
    "end": "1199840"
  },
  {
    "text": "uh fingerprint activity and they will automatically start the fingerprint listener",
    "start": "1199840",
    "end": "1205120"
  },
  {
    "text": "inside on resume events of that activity so this uh sim this makes the attackers",
    "start": "1205120",
    "end": "1212880"
  },
  {
    "text": "our bypass id uh trick easier so what we want to do is",
    "start": "1212880",
    "end": "1218480"
  },
  {
    "text": "that we want to put the fingerprint activity in the background and then just let it resume",
    "start": "1218480",
    "end": "1225280"
  },
  {
    "start": "1224000",
    "end": "1302000"
  },
  {
    "text": "and this is our first idea for the bypass it caused a wake up bypass basically the",
    "start": "1225280",
    "end": "1232159"
  },
  {
    "text": "malicious step as before it will first launch the fingerprint activity then launch the carrying activity but because",
    "start": "1232159",
    "end": "1240159"
  },
  {
    "text": "the mitigation when it when it launched launches the current activity the background fingerprint activity will",
    "start": "1240159",
    "end": "1246840"
  },
  {
    "text": "be cancelled by os then it will just wait the victim to lock the screen",
    "start": "1246840",
    "end": "1252799"
  },
  {
    "text": "and later unlock the screen what happens when the victim when the device is unlocked is that all",
    "start": "1252799",
    "end": "1259360"
  },
  {
    "text": "those visible activities will be resumed that which which which cause",
    "start": "1259360",
    "end": "1265039"
  },
  {
    "text": "that which cause the background finger print activity starts doing the fingerprint listening",
    "start": "1265039",
    "end": "1271200"
  },
  {
    "text": "all of this is done without and causing any change to the activity stack",
    "start": "1271200",
    "end": "1276240"
  },
  {
    "text": "so the mitigation is never triggered here and a more practical more practical way",
    "start": "1276240",
    "end": "1282480"
  },
  {
    "text": "to launch this attack is the malicious app can monitoring to the action of the screen screen of",
    "start": "1282480",
    "end": "1290320"
  },
  {
    "text": "broadcast which allows it to know when when before that the user tries to lock the",
    "start": "1290320",
    "end": "1296640"
  },
  {
    "text": "screen and then right before that the malicious app can set up the attack",
    "start": "1296640",
    "end": "1303679"
  },
  {
    "start": "1302000",
    "end": "1392000"
  },
  {
    "text": "and this is the second bypass which is more more interesting and but it works like this before",
    "start": "1303679",
    "end": "1310240"
  },
  {
    "text": "because uh starting from android 7 androids uh support a new feature called uh split",
    "start": "1310240",
    "end": "1316000"
  },
  {
    "text": "screen basically the user can use multiple string at the same time however the activity life cycle is not",
    "start": "1316000",
    "end": "1323120"
  },
  {
    "text": "changed meaning that there will only be one activity can be in the resume state at the same time",
    "start": "1323120",
    "end": "1328720"
  },
  {
    "text": "and we also notice that when the user try to resize a split screen it will",
    "start": "1328720",
    "end": "1333919"
  },
  {
    "text": "result in updates of the activity lifecycle and here the diagram shows how this attack will",
    "start": "1333919",
    "end": "1342000"
  },
  {
    "text": "work first as usual we have the malicious app running in one of the split screen window",
    "start": "1342000",
    "end": "1347840"
  },
  {
    "text": "then this app can put the can put the fingerprint activity and the",
    "start": "1347840",
    "end": "1353039"
  },
  {
    "text": "carving into the adjacent window by setting some flags and then",
    "start": "1353039",
    "end": "1359200"
  },
  {
    "text": "but because the victims see that there's not something happening in a smaller window and he may want to",
    "start": "1359200",
    "end": "1365679"
  },
  {
    "text": "enlarge to see what hap enlarge it to see what happened and at the same time when he do the resize",
    "start": "1365679",
    "end": "1371679"
  },
  {
    "text": "then the activities in that window will become active again which result in the",
    "start": "1371679",
    "end": "1377120"
  },
  {
    "text": "resumes they resume even being triggered and that means the activity the fingerprint listener",
    "start": "1377120",
    "end": "1383440"
  },
  {
    "text": "will start listening however the stack has never been changed here",
    "start": "1383440",
    "end": "1389039"
  },
  {
    "text": "so this can again bypass the mitigation and the third one third bypass is uh",
    "start": "1389039",
    "end": "1396080"
  },
  {
    "start": "1392000",
    "end": "1457000"
  },
  {
    "text": "some some case we find uh we found accidentally basically when we are doing",
    "start": "1396080",
    "end": "1402799"
  },
  {
    "text": "testing testing this attack on some uh oem raw",
    "start": "1402799",
    "end": "1408400"
  },
  {
    "text": "based on android knight we find that uh we can we can first we instead of launch",
    "start": "1408400",
    "end": "1414720"
  },
  {
    "text": "directly launching the car we can first launch some activity in some arbitrary app however this activity",
    "start": "1414720",
    "end": "1422799"
  },
  {
    "text": "will crash we may we make it so it will crash after it immediately after it launched",
    "start": "1422799",
    "end": "1430000"
  },
  {
    "text": "so after the that activity crashed then the malicious activity at any time",
    "start": "1430000",
    "end": "1435279"
  },
  {
    "text": "he can it can just again launch the car ring now this time",
    "start": "1435279",
    "end": "1440960"
  },
  {
    "text": "although there are stack changes however the mitigation is not triggered",
    "start": "1440960",
    "end": "1447120"
  },
  {
    "text": "and uh because this oem is closed source and we didn't investigate further to",
    "start": "1447120",
    "end": "1453679"
  },
  {
    "text": "understand the exact reason behind it and okay finally it comes to the most",
    "start": "1453679",
    "end": "1461760"
  },
  {
    "start": "1457000",
    "end": "1541000"
  },
  {
    "text": "powerful attack in this presentation it's called the wrist attack which",
    "start": "1461760",
    "end": "1468240"
  },
  {
    "text": "exploits some risk condition bug in android system and we find that if we",
    "start": "1468240",
    "end": "1475120"
  },
  {
    "text": "launch two activities within a very short period of time it may cause some risk condition in the",
    "start": "1475120",
    "end": "1481279"
  },
  {
    "text": "android activity life cycle and on the right hand side you can see",
    "start": "1481279",
    "end": "1486799"
  },
  {
    "text": "it is a three slot even three slot of android activity",
    "start": "1486799",
    "end": "1492559"
  },
  {
    "text": "and the upper part choose choose the case when we normally launch a victim activity and",
    "start": "1492559",
    "end": "1498880"
  },
  {
    "text": "then use the malicious carving to cover it then as expected we can see the on the",
    "start": "1498880",
    "end": "1504880"
  },
  {
    "text": "background victim activity goes into the pulse state",
    "start": "1504880",
    "end": "1510159"
  },
  {
    "text": "and in the below part that is what happened when the risk condition block is",
    "start": "1510159",
    "end": "1515360"
  },
  {
    "text": "triggered we can see the background victim activity only goes into the resume state",
    "start": "1515360",
    "end": "1521200"
  },
  {
    "text": "so this renders the the the cancellation in on pulse become",
    "start": "1521200",
    "end": "1528000"
  },
  {
    "text": "useless meaning that even apps have the correct implementation they are still vulnerable to our fingerprint jacking attack",
    "start": "1528000",
    "end": "1534640"
  },
  {
    "text": "and also because this spark breaks the android activity life cycle it also breaks android nice mitigation",
    "start": "1534640",
    "end": "1543279"
  },
  {
    "start": "1541000",
    "end": "1605000"
  },
  {
    "text": "and actually we reported this issue to",
    "start": "1543279",
    "end": "1549600"
  },
  {
    "text": "google about half a year ago and we provided proof of concept video and also source code",
    "start": "1549600",
    "end": "1556559"
  },
  {
    "text": "later on they requested us to test this on the latest android so we installed android 11 and yeah proved it",
    "start": "1556559",
    "end": "1564720"
  },
  {
    "text": "find out it also worked on even android 11. recently we are informed that uh they",
    "start": "1564720",
    "end": "1571360"
  },
  {
    "text": "will assign a cv id to the spa and also they plan to release the patch in",
    "start": "1571360",
    "end": "1577039"
  },
  {
    "text": "january so before they uh after the patch they release the patch",
    "start": "1577039",
    "end": "1583120"
  },
  {
    "text": "we may we may be able to disclose more details like uh actually we find several ways to",
    "start": "1583120",
    "end": "1590400"
  },
  {
    "text": "trigger this risk condition bar and also this spot actually breaks the activity life cycle so it may also",
    "start": "1590400",
    "end": "1597520"
  },
  {
    "text": "break other things apart from just the fingerprint hijacking attacks represented here",
    "start": "1597520",
    "end": "1606000"
  },
  {
    "start": "1605000",
    "end": "1666000"
  },
  {
    "text": "and okay this is basically our new attack techniques and",
    "start": "1606720",
    "end": "1613440"
  },
  {
    "text": "to this point you may think that oh it is not cool because you assume that some malicious app is",
    "start": "1613440",
    "end": "1619360"
  },
  {
    "text": "installed in the victim's device well",
    "start": "1619360",
    "end": "1624559"
  },
  {
    "text": "because i'm a web security guy so i also i don't like such a strong assumption so",
    "start": "1624559",
    "end": "1631279"
  },
  {
    "text": "i try to make this attack work in web browsers and finally i find that it is possible",
    "start": "1631279",
    "end": "1637200"
  },
  {
    "text": "but just with more conditions so the condition can be summarized as two",
    "start": "1637200",
    "end": "1642880"
  },
  {
    "text": "points first one you need to find some current gadget which i will explain in the next slide and the second is that",
    "start": "1642880",
    "end": "1650960"
  },
  {
    "text": "the target app fingerprint authorization needs to be able to invoked from the browser this can happen",
    "start": "1650960",
    "end": "1657360"
  },
  {
    "text": "for example in some because some of the mobile payment apps they want to support the user",
    "start": "1657360",
    "end": "1662960"
  },
  {
    "text": "to do the payment from the web browsers and okay so what is the current gadget",
    "start": "1662960",
    "end": "1669120"
  },
  {
    "start": "1666000",
    "end": "1738000"
  },
  {
    "text": "carbon gadgets are those activities in the benign apps",
    "start": "1669120",
    "end": "1674720"
  },
  {
    "text": "that first of all it allows the location from browser of course and second it allows the attacker to",
    "start": "1674720",
    "end": "1681039"
  },
  {
    "text": "control to control its visual content and the third one is that it has to have",
    "start": "1681039",
    "end": "1687279"
  },
  {
    "text": "the translucent property so the carbon gadgets usually come",
    "start": "1687279",
    "end": "1693360"
  },
  {
    "text": "in the form of the blinks one common cases i i've seen are",
    "start": "1693360",
    "end": "1699919"
  },
  {
    "text": "in those uh bug bounty program i think people can find some openly direct in",
    "start": "1699919",
    "end": "1705760"
  },
  {
    "text": "webview in some popular apps so in this case that this case actually uh already met the",
    "start": "1705760",
    "end": "1711919"
  },
  {
    "text": "first two conditions however the more difficult one is also the this uh",
    "start": "1711919",
    "end": "1717039"
  },
  {
    "text": "webview activity needs to have the translucent property so i know it is not easy to find such",
    "start": "1717039",
    "end": "1723440"
  },
  {
    "text": "kind of carving gadgets and for me i i didn't spend much time on this one",
    "start": "1723440",
    "end": "1729120"
  },
  {
    "text": "currently so i only be able to find one of such casings some rather popular app",
    "start": "1729120",
    "end": "1736240"
  },
  {
    "text": "with partial content control suppose that uh you already have uh",
    "start": "1736240",
    "end": "1742399"
  },
  {
    "text": "find some carbon gadget and then what you want to do is that in your",
    "start": "1742399",
    "end": "1749360"
  },
  {
    "text": "malicious web page or your attack web page you you want to first use deep link to",
    "start": "1749360",
    "end": "1756000"
  },
  {
    "text": "launch the target fingerprint activity and then at the same time you will use",
    "start": "1756000",
    "end": "1762880"
  },
  {
    "text": "script to launch the carving gadget mainly those carving activities inside",
    "start": "1762880",
    "end": "1769279"
  },
  {
    "text": "existing apps you can see that here we prepared several",
    "start": "1769279",
    "end": "1774640"
  },
  {
    "text": "several current gadgets in the same attack that's that because from only from the web browser the attacker",
    "start": "1774640",
    "end": "1780960"
  },
  {
    "text": "cannot know which app is installed on the victim device so the better strategy here is that he",
    "start": "1780960",
    "end": "1787360"
  },
  {
    "text": "would try and try all of them once one of them is installed then the tech can work",
    "start": "1787360",
    "end": "1795440"
  },
  {
    "start": "1794000",
    "end": "1840000"
  },
  {
    "text": "and this table this table here this table here summarize all of our",
    "start": "1795440",
    "end": "1804640"
  },
  {
    "text": "attack techniques as well as those known attacks and the green cells in the table means",
    "start": "1804640",
    "end": "1811200"
  },
  {
    "text": "that it is easier or more practical to launch that attack so you can see that the most powerful",
    "start": "1811200",
    "end": "1817360"
  },
  {
    "text": "attack for sure is risk attack that is exploiting",
    "start": "1817360",
    "end": "1822720"
  },
  {
    "text": "the android uh risk condition bug another difference you may notice of our",
    "start": "1822720",
    "end": "1829360"
  },
  {
    "text": "new text from those known attacks is that our new attacks",
    "start": "1829360",
    "end": "1834960"
  },
  {
    "text": "doesn't require any permission so it can be considered more practical here",
    "start": "1834960",
    "end": "1840720"
  },
  {
    "start": "1840000",
    "end": "1886000"
  },
  {
    "text": "finally some suggestions to android developers first of all use the android x biometric api",
    "start": "1840720",
    "end": "1847520"
  },
  {
    "text": "which is a wrapper for the fingerprint manager and biometric prompt api",
    "start": "1847520",
    "end": "1852559"
  },
  {
    "text": "and it's it has more secure implementation and second i suggest you to use those",
    "start": "1852559",
    "end": "1858799"
  },
  {
    "text": "third party live fingerprint libraries more carefully because we also did some investigation into those open source",
    "start": "1858799",
    "end": "1864799"
  },
  {
    "text": "libraries and find some of them actually viable finally if",
    "start": "1864799",
    "end": "1869919"
  },
  {
    "text": "you you may want to check your existing implementations and if you are using the fingerprint",
    "start": "1869919",
    "end": "1875039"
  },
  {
    "text": "manager api you may want to try you may want to make sure that you do the canceling in the correct",
    "start": "1875039",
    "end": "1883200"
  },
  {
    "text": "place namely on post events and this is the last part again some",
    "start": "1883200",
    "end": "1889679"
  },
  {
    "start": "1886000",
    "end": "2049000"
  },
  {
    "text": "demonstration and this time we will we will show the demonstration with the",
    "start": "1889679",
    "end": "1896320"
  },
  {
    "text": "coverings being set to be transparent so you can see what happens in the background",
    "start": "1896320",
    "end": "1901760"
  },
  {
    "text": "and there will be two demonstrations and the first one is the same as our first demonstration just with",
    "start": "1901760",
    "end": "1907679"
  },
  {
    "text": "transparent occurring and the second one is more interesting it is uh it's it's targeting some payment app and",
    "start": "1907679",
    "end": "1914880"
  },
  {
    "text": "it's it also combines the touch jacking attack techniques here so this is the first demonstration",
    "start": "1914880",
    "end": "1922960"
  },
  {
    "text": "first we launch the matrix manager to check the super user list as euro",
    "start": "1924080",
    "end": "1931120"
  },
  {
    "text": "we can see right now there's no app being granted the root permission",
    "start": "1931120",
    "end": "1937600"
  },
  {
    "text": "then we launch our demonstration malicious app and when the attack happens you can see",
    "start": "1937600",
    "end": "1945200"
  },
  {
    "text": "underneath the covering there's the fingerprint dialer requesting user to input his fingerprint to authorize",
    "start": "1945200",
    "end": "1953120"
  },
  {
    "text": "the root permission and after user do so",
    "start": "1953120",
    "end": "1958480"
  },
  {
    "text": "then our malicious app has been granted the rule permission but the attacker for sure they don't",
    "start": "1958640",
    "end": "1965039"
  },
  {
    "text": "need to make the carving translucent to to and to let the",
    "start": "1965039",
    "end": "1971039"
  },
  {
    "text": "victim know what happens and the second one is the attack targeting the payment app",
    "start": "1971039",
    "end": "1980640"
  },
  {
    "text": "and we can see when this attack happens",
    "start": "1981600",
    "end": "1987360"
  },
  {
    "text": "what happens in the background is first in inside that payment app it will first ask the user to tap some",
    "start": "1987360",
    "end": "1993919"
  },
  {
    "text": "button so this is why we need the touch jacking here to trick the user into",
    "start": "1993919",
    "end": "1999519"
  },
  {
    "text": "pushing the button and then after the user put tap the button then",
    "start": "1999519",
    "end": "2005679"
  },
  {
    "text": "it's the the fingerprint dialog need user to authorize to to proceed to",
    "start": "2005679",
    "end": "2012720"
  },
  {
    "text": "the page to complete the payment then we use the fingerprint jacking as before",
    "start": "2012720",
    "end": "2019440"
  },
  {
    "text": "after the user put his finger onto the fingerprint sensor",
    "start": "2019440",
    "end": "2024720"
  },
  {
    "text": "the payment transaction has been completed and the money has been transferred to our malicious app",
    "start": "2024720",
    "end": "2032960"
  },
  {
    "text": "yeah and this is our final demonstration and thank you for your time and we if",
    "start": "2032960",
    "end": "2039440"
  },
  {
    "text": "you're interested in this talk you may also want to check our white paper which includes more details",
    "start": "2039440",
    "end": "2044880"
  },
  {
    "text": "and well any questions are welcome thanks",
    "start": "2044880",
    "end": "2051280"
  }
]