[
  {
    "text": "[Music]",
    "start": "3950",
    "end": "27449"
  },
  {
    "text": "well I guess we should start um let me introduce uh to you myself first um I'm",
    "start": "31960",
    "end": "39559"
  },
  {
    "text": "not an native English speaker which you probably hear by my accent I'm from Germany and um uh to tell you a little",
    "start": "39559",
    "end": "46399"
  },
  {
    "text": "bit about myself I've been doing a lot of system administration for a lot of years and started about 5 years ago",
    "start": "46399",
    "end": "53640"
  },
  {
    "text": "providing security training and Consulting mostly in the open source area and um have been doing a lot of",
    "start": "53640",
    "end": "62559"
  },
  {
    "text": "well penetration testing during that time at different um uh different uh",
    "start": "62559",
    "end": "69000"
  },
  {
    "text": "places at uh different customers and uh today I would like to",
    "start": "69000",
    "end": "75720"
  },
  {
    "text": "uh tell you a little bit about my experiences using and testing an open",
    "start": "75720",
    "end": "82200"
  },
  {
    "text": "source Ike demon implementation and the tool I developed",
    "start": "82200",
    "end": "88159"
  },
  {
    "text": "during that um while testing",
    "start": "88159",
    "end": "93600"
  },
  {
    "text": "so um if we talk about ik we have to talk about ipac if we talk about ipac",
    "start": "93600",
    "end": "99560"
  },
  {
    "text": "we're speaking vpns and I don't know who of you have heard the keynote by Paul",
    "start": "99560",
    "end": "105399"
  },
  {
    "text": "Simmons uh yesterday morning uh Paul well somehow",
    "start": "105399",
    "end": "111960"
  },
  {
    "text": "required uh secure protocols for what he was proposing his dep parameterization",
    "start": "111960",
    "end": "118840"
  },
  {
    "text": "of the networks and IPC mostly is thought to be a secure",
    "start": "118840",
    "end": "124280"
  },
  {
    "text": "protocol Ike is thought to be a secure protocol and it probably is but uh the way it is uh designed but there are a",
    "start": "124280",
    "end": "133200"
  },
  {
    "text": "lot of problems within different implementations out there there are several Ike implementations IP",
    "start": "133200",
    "end": "139920"
  },
  {
    "text": "implementations and not everybody is actually following the standard uh to",
    "start": "139920",
    "end": "145560"
  },
  {
    "text": "the dot so um we should take a closer look look at those different I",
    "start": "145560",
    "end": "151519"
  },
  {
    "text": "implementations to see whether they are implemented correctly or whether have they",
    "start": "151519",
    "end": "157480"
  },
  {
    "text": "flaws most VPN today are based on ipac and if you look at ipac there are",
    "start": "157480",
    "end": "163480"
  },
  {
    "text": "essentially two protocols uh the authentication header protocol and encapsulated security payload protocol",
    "start": "163480",
    "end": "169800"
  },
  {
    "text": "which do the work which uh take care of uh guaranteeing Integrity",
    "start": "169800",
    "end": "176200"
  },
  {
    "text": "confidentiality um but these protocols actually do not exchange keys so when",
    "start": "176200",
    "end": "183040"
  },
  {
    "text": "you actually want to set up a VPN you need some keys to encrypt and to",
    "start": "183040",
    "end": "188480"
  },
  {
    "text": "authenticate the packets with and you need somebody who takes care of that and",
    "start": "188480",
    "end": "194840"
  },
  {
    "text": "there are two protocols actually available and used today um one of them",
    "start": "194840",
    "end": "200599"
  },
  {
    "text": "is the internet key exchange protocol the internet key exchange protocol is the protocol used most often there's",
    "start": "200599",
    "end": "207840"
  },
  {
    "text": "another protocol not known to to many people it's called furus it's for",
    "start": "207840",
    "end": "212959"
  },
  {
    "text": "example used by um the open BSD people they've got a furus demon which can be",
    "start": "212959",
    "end": "218680"
  },
  {
    "text": "used to exchange Keys um if we take a closer look at the",
    "start": "218680",
    "end": "225640"
  },
  {
    "text": "internet key exchange protocol it's very complicated um there",
    "start": "225640",
    "end": "230840"
  },
  {
    "text": "are a lot of standards that actually Define how",
    "start": "230840",
    "end": "236720"
  },
  {
    "text": "and yeah Define how the internet key exchange protocol should work so uh it",
    "start": "236720",
    "end": "243720"
  },
  {
    "text": "is based on several other protocols several other Frameworks uh I've just listed a few of them here there is the",
    "start": "243720",
    "end": "251280"
  },
  {
    "text": "um Isa KMP uh protocol which is defined in the RFC",
    "start": "251280",
    "end": "256919"
  },
  {
    "text": "248 which provides a framework for authentication and key exchange there's the Oakley uh protocol",
    "start": "256919",
    "end": "265240"
  },
  {
    "text": "or the O framework defined in its own RFC which describes a series of key",
    "start": "265240",
    "end": "270520"
  },
  {
    "text": "exchanges which are called modes there's s ke and um then there's Ike itself and",
    "start": "270520",
    "end": "278280"
  },
  {
    "text": "Ike essentially is a protocol which is using parts of all these other protocols I just",
    "start": "278280",
    "end": "284120"
  },
  {
    "text": "mentioned so implementing Ike or ik is not very simple and is probably error",
    "start": "284120",
    "end": "292720"
  },
  {
    "text": "prone although Ike itself is probably a good design and quite secure",
    "start": "292720",
    "end": "300400"
  },
  {
    "text": "so if you take a look at ik more closely it's actually uh well it actually does",
    "start": "300400",
    "end": "306720"
  },
  {
    "text": "its work in two phases uh there's a phase one",
    "start": "306720",
    "end": "313280"
  },
  {
    "text": "which has again two at least two different modes which are called the",
    "start": "313280",
    "end": "318600"
  },
  {
    "text": "aggressive mode and uh main mode uh there's another mode it's called base mode to um well which is not used that",
    "start": "318600",
    "end": "328520"
  },
  {
    "text": "much uh today uh theive mode uses three different messages to uh do its work the main mode",
    "start": "328520",
    "end": "335199"
  },
  {
    "text": "uses six messages and office identity protection uh doing it and once phase",
    "start": "335199",
    "end": "341759"
  },
  {
    "text": "one is done once phase one was successful there's a phase two and phase",
    "start": "341759",
    "end": "348319"
  },
  {
    "text": "two uh fortunately only has one mode which is called the quick mode but",
    "start": "348319",
    "end": "353479"
  },
  {
    "text": "relies solely on the security of phase one so in phase two we don't have any",
    "start": "353479",
    "end": "359160"
  },
  {
    "text": "additional security um negotiated we just rely on the security negotiated in Phase",
    "start": "359160",
    "end": "367759"
  },
  {
    "text": "One if we take a look at the aggressive mode um there are several ways uh we can",
    "start": "367759",
    "end": "374720"
  },
  {
    "text": "use to authenticate during phase one uh like we can use pre-share Keys which",
    "start": "374720",
    "end": "382280"
  },
  {
    "text": "essentially are passwords we can use uh RSA signatures we can use RSA encryption",
    "start": "382280",
    "end": "389319"
  },
  {
    "text": "and and uh there even are two ways to encrypt um in phase one uh using RSA",
    "start": "389319",
    "end": "398280"
  },
  {
    "text": "keys for um the authentication phase so",
    "start": "398280",
    "end": "403400"
  },
  {
    "text": "if we take a look at the aggressive mode using signatures those are the messages that they exchanged uh so we've got uh",
    "start": "403400",
    "end": "411080"
  },
  {
    "text": "the initiator which sends uh packet to the responder the responder is usually",
    "start": "411080",
    "end": "417520"
  },
  {
    "text": "the VPN Gateway accepting the connection and the packet that is sent consists of",
    "start": "417520",
    "end": "424000"
  },
  {
    "text": "a header um of a security Association payload key exchange payload a nors",
    "start": "424000",
    "end": "430759"
  },
  {
    "text": "payload an identification payload which are all packed into one packet the",
    "start": "430759",
    "end": "437720"
  },
  {
    "text": "responder answers using a header the uh his own security Association response",
    "start": "437720",
    "end": "445520"
  },
  {
    "text": "his own key exchange payload his own nons payload his own ID ification payload may be an additional certificate",
    "start": "445520",
    "end": "453720"
  },
  {
    "text": "uh payload which contains his own certificate and to authenticate uh",
    "start": "453720",
    "end": "459759"
  },
  {
    "text": "lastly it adds a signature payload and then the initiator sends again his own",
    "start": "459759",
    "end": "465319"
  },
  {
    "text": "certificate and the signature payload to",
    "start": "465319",
    "end": "470000"
  },
  {
    "text": "authenticate if the responder has any kind of flaw uh within the uh code that",
    "start": "471800",
    "end": "480080"
  },
  {
    "text": "passes the key exchange or the security Association or the identification uh payload of the initiator we might have a",
    "start": "480080",
    "end": "487400"
  },
  {
    "text": "problem because we can send this information without authenticating ourselves uh before let's take a look at",
    "start": "487400",
    "end": "494599"
  },
  {
    "text": "the main mode which is a little bit more complicated that's got six messages um",
    "start": "494599",
    "end": "500759"
  },
  {
    "text": "and again we see pretty much the same payloads uh the only uh difference",
    "start": "500759",
    "end": "506159"
  },
  {
    "text": "between the main mode and the aggressive mode pretty much is that the last two messages in the last two messages the",
    "start": "506159",
    "end": "513240"
  },
  {
    "text": "header has got this little star over here and what the star means is that everything behind the header is",
    "start": "513240",
    "end": "520200"
  },
  {
    "text": "encrypted so we've got some kind of uh further security within the uh",
    "start": "520200",
    "end": "527519"
  },
  {
    "text": "main mode further security which encrypts the identification payload the",
    "start": "527519",
    "end": "532600"
  },
  {
    "text": "certificate and the signature payload so that an East dropper that listens into",
    "start": "532600",
    "end": "539320"
  },
  {
    "text": "the this connection cannot see the identification payload or the certificate in",
    "start": "539320",
    "end": "546200"
  },
  {
    "text": "clear um therefore the main mod is often called the identity protection mode too",
    "start": "546200",
    "end": "551360"
  },
  {
    "text": "because the identity is transferred uh encrypted the aggressive mode doesn't",
    "start": "551360",
    "end": "558640"
  },
  {
    "text": "support this the headers don't have the star which means that every payload",
    "start": "558640",
    "end": "565360"
  },
  {
    "text": "transferred is not encrypted so the identi ident uh identification payload",
    "start": "565360",
    "end": "571959"
  },
  {
    "text": "and the certificate payload is transferred uh without any uh",
    "start": "571959",
    "end": "579640"
  },
  {
    "text": "encryption there are several different payloads which are supported by ik there",
    "start": "579720",
    "end": "585519"
  },
  {
    "text": "are the security Association P The Proposal payload the transform payload key exchange payload identification",
    "start": "585519",
    "end": "592079"
  },
  {
    "text": "payload certificate payload Certificate request payload uh the hash payload signature nose notification delete and",
    "start": "592079",
    "end": "598279"
  },
  {
    "text": "vendor ID the sheer uh number of these payloads",
    "start": "598279",
    "end": "604920"
  },
  {
    "text": "makes it very diff difficult to implement an Ike implementation that",
    "start": "604920",
    "end": "610000"
  },
  {
    "text": "actually handles all these different payloads",
    "start": "610000",
    "end": "613920"
  },
  {
    "text": "correctly um to further complicate the whole situation um the most payloads uh build",
    "start": "616079",
    "end": "624040"
  },
  {
    "text": "up like this we've got this is a generic payload um uh structure we've",
    "start": "624040",
    "end": "631440"
  },
  {
    "text": "got um 16 um sorry uh we've got uh four",
    "start": "631440",
    "end": "637959"
  },
  {
    "text": "bytes which are uh constant the next payload bite one Reserve bite and two",
    "start": "637959",
    "end": "644240"
  },
  {
    "text": "bytes which uh Define the length of the payload and then we've got a variable length payload so any kind of these",
    "start": "644240",
    "end": "652399"
  },
  {
    "text": "payloads might have a buff overflow in the I implementation so if the I",
    "start": "652399",
    "end": "657959"
  },
  {
    "text": "implementation does not check the length or buffers that might be a buffer overflow and in fact there have been",
    "start": "657959",
    "end": "665440"
  },
  {
    "text": "buffer overflows in Ike in the past if we take further look at Ike and",
    "start": "665440",
    "end": "671959"
  },
  {
    "text": "the ike importance today um Ike exchanges the keys in almost all ipac",
    "start": "671959",
    "end": "677760"
  },
  {
    "text": "based vpns today um I'm not aware of any vendor at the moment any commercial",
    "start": "677760",
    "end": "684920"
  },
  {
    "text": "vendor at the moment that does not use Ike to exchange ke for an IPC based VPN",
    "start": "684920",
    "end": "691880"
  },
  {
    "text": "if anybody of you doesn't know such a vendor I would be very interested uh if we can compromise the",
    "start": "691880",
    "end": "698600"
  },
  {
    "text": "EG exchange uh if we are able to um introduce buffer overflows or",
    "start": "698600",
    "end": "706240"
  },
  {
    "text": "stuff like that or if we were able to somehow uh use certificates which are",
    "start": "706240",
    "end": "711560"
  },
  {
    "text": "not valid if we are able to use signatures which are not valid uh we can compromise the I exchange and can attack",
    "start": "711560",
    "end": "719279"
  },
  {
    "text": "theal of the VPN so once we can do that we usually",
    "start": "719279",
    "end": "726440"
  },
  {
    "text": "are done with the attack because if you take a look at your vpns today probably",
    "start": "726440",
    "end": "732720"
  },
  {
    "text": "most vpns are used to enable well are used to give you full access to your",
    "start": "732720",
    "end": "738440"
  },
  {
    "text": "internal Network once you've authenticated to your VPN you're in uh because usually your boss wants full",
    "start": "738440",
    "end": "745079"
  },
  {
    "text": "access to his database while he works from home so most vpns actually give you full",
    "start": "745079",
    "end": "752079"
  },
  {
    "text": "access so let's take a look at ik problems after we've looked at the",
    "start": "752639",
    "end": "758760"
  },
  {
    "text": "complexity um there's at least one design flaw that is known and that has been known for",
    "start": "758760",
    "end": "765519"
  },
  {
    "text": "some time and uh that's um well um that",
    "start": "765519",
    "end": "772839"
  },
  {
    "text": "can be used to attack Ike when you're using um Ike with aggressive mode and",
    "start": "772839",
    "end": "779199"
  },
  {
    "text": "pre-shared keys if we go back to the aggressive",
    "start": "779199",
    "end": "785360"
  },
  {
    "text": "mode exchange um you see that there are three signature three um packets passed back",
    "start": "785360",
    "end": "792519"
  },
  {
    "text": "and forth and that the identification is passed and clear and this is uh the aggressive mode",
    "start": "792519",
    "end": "801480"
  },
  {
    "text": "exchange using signatures but if you use pre-share Keys it's pretty much the same uh what actually is exchanged then",
    "start": "801480",
    "end": "808920"
  },
  {
    "text": "is is an hash here which is encrypted using the preet key or based on the preet key and what",
    "start": "808920",
    "end": "816880"
  },
  {
    "text": "you can do and uh what was first published by Anton rager is you can uh",
    "start": "816880",
    "end": "823760"
  },
  {
    "text": "do a brute force or dictionary attack on the used pre-share key so if the",
    "start": "823760",
    "end": "829560"
  },
  {
    "text": "pre-share key that has been used to implement the VPN uh can be um guessed using a",
    "start": "829560",
    "end": "836680"
  },
  {
    "text": "dictionary attack it's quite easy to to attack the the authentication phase um",
    "start": "836680",
    "end": "842519"
  },
  {
    "text": "first published by Anon rer and the first tool that implemented that was called I if you're interested in I you",
    "start": "842519",
    "end": "849759"
  },
  {
    "text": "can find I on sourceforge it's. sf.net and you can download there",
    "start": "849759",
    "end": "856680"
  },
  {
    "text": "and uh it's a nice tool which is able to crack your pre-share key aggressive mode",
    "start": "856680",
    "end": "862920"
  },
  {
    "text": "vpns offline so you just uh sna the or sniff the uh change from The Wire and",
    "start": "862920",
    "end": "871120"
  },
  {
    "text": "crack it offline or using uh machines which are uh capable of doing",
    "start": "871120",
    "end": "877320"
  },
  {
    "text": "it further Ike vulnerabilities U those are now vulnerabilities that are not",
    "start": "877320",
    "end": "882839"
  },
  {
    "text": "inside the ike protocol itself and the ik design but in different I implementations I've just used a few of",
    "start": "882839",
    "end": "889880"
  },
  {
    "text": "those um I've just listed a few of those uh that um are listed in the security",
    "start": "889880",
    "end": "897680"
  },
  {
    "text": "Focus uh vulnerability ility database so there are several bits here now uh which",
    "start": "897680",
    "end": "904040"
  },
  {
    "text": "you can look up it's a security Focus vulnerability database and uh there are",
    "start": "904040",
    "end": "909519"
  },
  {
    "text": "several uh vulnerabilities in the EXO implementation which is an additional I",
    "start": "909519",
    "end": "915240"
  },
  {
    "text": "implementation which allows you to use usernames and passwords there's in Deni",
    "start": "915240",
    "end": "920440"
  },
  {
    "text": "of service vulnerability in the ipd of open BSD um there are uh different",
    "start": "920440",
    "end": "928279"
  },
  {
    "text": "vulnerabilities and several clients which uh can be uh exploited using",
    "start": "928279",
    "end": "933440"
  },
  {
    "text": "excessive payloads and there are different vulnerabilities uh within multiple",
    "start": "933440",
    "end": "939560"
  },
  {
    "text": "vendor I implementations uh which are not correctly authenticating or verifying certificates which are used",
    "start": "939560",
    "end": "947319"
  },
  {
    "text": "while uh in the authentication process the security vulnerability",
    "start": "947319",
    "end": "953560"
  },
  {
    "text": "database lists Al together about 32 different Ike vulnerabilities well",
    "start": "953560",
    "end": "959000"
  },
  {
    "text": "listed them at the time I looked them up which is about a couple of weeks ago um",
    "start": "959000",
    "end": "964800"
  },
  {
    "text": "even sample bags are not found if nobody looks for them which can be quite easily",
    "start": "964800",
    "end": "970000"
  },
  {
    "text": "demonstrated if you take a look at two simple bugs in raccoon uh one of which",
    "start": "970000",
    "end": "975920"
  },
  {
    "text": "was um detected by myself the first one the second one well uh was detected by",
    "start": "975920",
    "end": "981959"
  },
  {
    "text": "myself too but unfortunately um Tomas wusi found it too and already published",
    "start": "981959",
    "end": "988319"
  },
  {
    "text": "it a couple of week weeks ago so I couldn't present it here anyway",
    "start": "988319",
    "end": "994560"
  },
  {
    "text": "um what actually happens and that's what I want to show you later on is that the",
    "start": "994560",
    "end": "1000720"
  },
  {
    "text": "raccoon Ike demon um can be uh contacted using Ike and what",
    "start": "1000720",
    "end": "1008040"
  },
  {
    "text": "usually should happen if you use x59 certificates for the authentication is I",
    "start": "1008040",
    "end": "1013279"
  },
  {
    "text": "go back to the main mode uh we send each other security Association pay not and",
    "start": "1013279",
    "end": "1020800"
  },
  {
    "text": "um propose what kind of encryption we want to use what kind of hash we want to",
    "start": "1020800",
    "end": "1026720"
  },
  {
    "text": "use um what kind of D hmer group we want to use and they negotiate those then we",
    "start": "1026720",
    "end": "1033880"
  },
  {
    "text": "send key exchange information uh for the defy halman exchange and",
    "start": "1033880",
    "end": "1040319"
  },
  {
    "text": "nses and last but not least we send our own identification our own certificate",
    "start": "1040319",
    "end": "1048280"
  },
  {
    "text": "and usually usually a signature uh which authenticates ourself to the pier the",
    "start": "1048280",
    "end": "1054400"
  },
  {
    "text": "signature should be generated using our own private key so if you're familiar",
    "start": "1054400",
    "end": "1059880"
  },
  {
    "text": "with private and public Keys we send the public key within the certificate and we",
    "start": "1059880",
    "end": "1066960"
  },
  {
    "text": "sign uh or and we create a signature with our private key and uh the",
    "start": "1066960",
    "end": "1074280"
  },
  {
    "text": "responder which gets this information can check our signature",
    "start": "1074280",
    "end": "1079440"
  },
  {
    "text": "using our certificate well um if you send raccoon",
    "start": "1079440",
    "end": "1085280"
  },
  {
    "text": "this older version it's fixed now if you send raccoon uh any kind of valid",
    "start": "1085280",
    "end": "1091799"
  },
  {
    "text": "certificate and don't create a signature at all it says hey okay I'm fine we're",
    "start": "1091799",
    "end": "1098320"
  },
  {
    "text": "done with it the certificate was fine and I don't even check the",
    "start": "1098320",
    "end": "1103760"
  },
  {
    "text": "signature that's the first one um that was F quite fast it took um the uh",
    "start": "1104679",
    "end": "1113039"
  },
  {
    "text": "people developing raccoon a couple of days to fix that and then the second one",
    "start": "1113039",
    "end": "1119480"
  },
  {
    "text": "uh was found and what the second one actually does is if you now again",
    "start": "1119480",
    "end": "1127159"
  },
  {
    "text": "contact raccoon and send raccoon your certificate and generate a valid",
    "start": "1127159",
    "end": "1134280"
  },
  {
    "text": "signature uh raccoon does not check the certificate anymore so if you've got a",
    "start": "1134280",
    "end": "1140200"
  },
  {
    "text": "certificate which is not valid anymore because uh somehow the validity uh the",
    "start": "1140200",
    "end": "1146000"
  },
  {
    "text": "validity date is in the past or if you've got a certificate that has been revoked um raccoon says Hey fine I don't",
    "start": "1146000",
    "end": "1154000"
  },
  {
    "text": "care if the certificate is revoked I allow you anyways into my VPN so those are quite simple um",
    "start": "1154000",
    "end": "1163760"
  },
  {
    "text": "vulnerabilities which were present in raccoon for at least a couple of years",
    "start": "1163760",
    "end": "1170679"
  },
  {
    "text": "and nobody found them why not because probably everybody uh always used valid",
    "start": "1170679",
    "end": "1176480"
  },
  {
    "text": "certificates and Val keys and nobody wondered if it if he could authenticate",
    "start": "1176480",
    "end": "1183640"
  },
  {
    "text": "Recon 2 using uh nonvalid private keys or using nonvalid",
    "start": "1183640",
    "end": "1190159"
  },
  {
    "text": "certificates so uh what I thought back then was that we need a tool to test",
    "start": "1190159",
    "end": "1196440"
  },
  {
    "text": "such I implementations we need a tool to to somehow find out if the I",
    "start": "1196440",
    "end": "1201799"
  },
  {
    "text": "implementation actually does what it um is supposed to do if it actually implements the ik standards uh as they",
    "start": "1201799",
    "end": "1211039"
  },
  {
    "text": "are uh defined uh since there are numerous I complementations out there uh and a lot",
    "start": "1211039",
    "end": "1217720"
  },
  {
    "text": "of them are closed binary ey complementations uh we cannot just take a look at the source code which is quite",
    "start": "1217720",
    "end": "1225000"
  },
  {
    "text": "easy in when you uh take a look at raccoon or the KMD or the freeze one",
    "start": "1225000",
    "end": "1230559"
  },
  {
    "text": "tools on Linux and stuff like that you can take a look at the source code but uh a lot of implementations uh close",
    "start": "1230559",
    "end": "1237600"
  },
  {
    "text": "source so um we need a tool to test those since they might have numerous buffer overflows or strange or wrong",
    "start": "1237600",
    "end": "1245159"
  },
  {
    "text": "certificate handling or just other straightforward bugs um to give you an idea what kind of",
    "start": "1245159",
    "end": "1252919"
  },
  {
    "text": "buffer overflow problem um uh Ike implementations might have there was one",
    "start": "1252919",
    "end": "1258360"
  },
  {
    "text": "and checkpoint um which was",
    "start": "1258360",
    "end": "1263559"
  },
  {
    "text": "found I think this year too either the beginning of this year or last year uh checkpoint had um improper handling of C",
    "start": "1263559",
    "end": "1272520"
  },
  {
    "text": "Certificate request payloads uh since go back to my main mode since we",
    "start": "1272520",
    "end": "1280520"
  },
  {
    "text": "are exchanging certificates here uh if you take a look at the the messages",
    "start": "1280520",
    "end": "1286080"
  },
  {
    "text": "again um this s underscore I and the thir underscore R are in um uh brackets",
    "start": "1286080",
    "end": "1295200"
  },
  {
    "text": "and what these brackets mean essentially is that those are optional so you can send your certificate but you don't have",
    "start": "1295200",
    "end": "1301840"
  },
  {
    "text": "to send your certificate if you don't send your certificate the responder must have any kind or means to request your",
    "start": "1301840",
    "end": "1309760"
  },
  {
    "text": "certificate and the responder can send or the initiator can send a Certificate request to the other side and within the",
    "start": "1309760",
    "end": "1316960"
  },
  {
    "text": "Certificate request you can State what kind of certificate Authority you're willing to accept so you can say well I",
    "start": "1316960",
    "end": "1325640"
  },
  {
    "text": "want any kind of certificate you've got or I want a certificate that has to be signed by this kind of certificate",
    "start": "1325640",
    "end": "1331880"
  },
  {
    "text": "Authority uh What uh checkpoint did was it sent",
    "start": "1331880",
    "end": "1337520"
  },
  {
    "text": "certificate well you could send checkpoint Certificate request and if you use the certificate Authority within",
    "start": "1337520",
    "end": "1345360"
  },
  {
    "text": "that request which was a little bit too long you had to buff overflow in checkpoint so since all these payloads",
    "start": "1345360",
    "end": "1354480"
  },
  {
    "text": "have got variable length payload uh may be of variable length and you have to",
    "start": "1354480",
    "end": "1360760"
  },
  {
    "text": "check all these length and check if the buffer is actually uh",
    "start": "1360760",
    "end": "1368000"
  },
  {
    "text": "protected so what tools are available um I looked",
    "start": "1368320",
    "end": "1374400"
  },
  {
    "text": "around and tried to find a tool which was already doing this kind of stuff and",
    "start": "1374400",
    "end": "1380120"
  },
  {
    "text": "what did I find well I found I crack which already mentioned I crack is a tool that is able to crack pre-share",
    "start": "1380120",
    "end": "1387039"
  },
  {
    "text": "Keys used in aggressive mode um the same guy who wrote I CRA which can be",
    "start": "1387039",
    "end": "1393039"
  },
  {
    "text": "downloaded here also wrote a tool called ik prober which already did a little bit",
    "start": "1393039",
    "end": "1398640"
  },
  {
    "text": "of that what I wanted to implement it is able to um generate the first packet",
    "start": "1398640",
    "end": "1405880"
  },
  {
    "text": "within uh the IE Exchange to test whether the um the responder is",
    "start": "1405880",
    "end": "1413039"
  },
  {
    "text": "accepting pre-shared keys so you've got a tool to test whether the VPN Gateway",
    "start": "1413039",
    "end": "1418679"
  },
  {
    "text": "you're trying to tag might be susceptible to the ick snaf attack then",
    "start": "1418679",
    "end": "1424799"
  },
  {
    "text": "there's a tool called I probe which you can download here and ik probe is pretty",
    "start": "1424799",
    "end": "1430440"
  },
  {
    "text": "much the same tool as I prober um just for Windows machines so um um it pretty",
    "start": "1430440",
    "end": "1440159"
  },
  {
    "text": "much tries to do a uh main mode or aggressive mode exchange using preate",
    "start": "1440159",
    "end": "1445279"
  },
  {
    "text": "keys and last one is I scan which is somehow a discovery and fingerprinting",
    "start": "1445279",
    "end": "1451039"
  },
  {
    "text": "Tool uh you can download it here and I scan is a tool which tries to find out what kind of VPN",
    "start": "1451039",
    "end": "1457600"
  },
  {
    "text": "Gateway um is used on the other side so you can use I scan to test is this uh",
    "start": "1457600",
    "end": "1465240"
  },
  {
    "text": "checkpoint VPN Gateway is this raccoon is this free spawn um it's quite interesting how it does",
    "start": "1465240",
    "end": "1470760"
  },
  {
    "text": "this because it um actually sends the first packet and doesn't respond anymore then",
    "start": "1470760",
    "end": "1478440"
  },
  {
    "text": "so it sends the first packet res respond answers and doesn't get an answer back",
    "start": "1478440",
    "end": "1484760"
  },
  {
    "text": "and then the responder will repeat its answer and I can somehow times these",
    "start": "1484760",
    "end": "1491960"
  },
  {
    "text": "answers and is able to use this timing information to find out what kind of VPN",
    "start": "1491960",
    "end": "1498919"
  },
  {
    "text": "Gateway we're talking to um what I did now is I wrote a tool",
    "start": "1498919",
    "end": "1505200"
  },
  {
    "text": "Which is far from complete um as you can tell since uh as",
    "start": "1505200",
    "end": "1510440"
  },
  {
    "text": "I showed you ik is very very very complicated um this uh ik test tool is",
    "start": "1510440",
    "end": "1518120"
  },
  {
    "text": "far from complete what does it do uh well it's written in Pearl I chose peul at first",
    "start": "1518120",
    "end": "1526039"
  },
  {
    "text": "because I thought it would be the easiest way to do it",
    "start": "1526039",
    "end": "1531200"
  },
  {
    "text": "um if you uh since I don't know who of you is coding in Pearl if if you code in",
    "start": "1531200",
    "end": "1537600"
  },
  {
    "text": "P you uh you usually assume that somebody already has written some kind",
    "start": "1537600",
    "end": "1544120"
  },
  {
    "text": "of pear module for anything you want to do so I assumed that there would be several modules available to encrypt and",
    "start": "1544120",
    "end": "1551120"
  },
  {
    "text": "to decrypt and to do defy Harman and all that stuff um and there are a lot of",
    "start": "1551120",
    "end": "1556600"
  },
  {
    "text": "modules available but not all you need so um I had to well somehow do uh some",
    "start": "1556600",
    "end": "1564279"
  },
  {
    "text": "tricks to to actually Implement everything I wanted to do um I use especially a p module which is called",
    "start": "1564279",
    "end": "1570480"
  },
  {
    "text": "net ra IP uh what does Net ra IP allow me to do well I can um create packets",
    "start": "1570480",
    "end": "1577240"
  },
  {
    "text": "and just inject them into the wire and sniff the answers back from The Wire um so I don't actually implement",
    "start": "1577240",
    "end": "1584320"
  },
  {
    "text": "the UDP connection but generate all my packets by my myself and pass them",
    "start": "1584320",
    "end": "1590520"
  },
  {
    "text": "afterwards all by myself um the fact that it was written in Pearl well the idea was that it would",
    "start": "1590520",
    "end": "1596760"
  },
  {
    "text": "would be easy to extend and modify in terms of cryptography it's not that easy to extend and modify and right now I'm",
    "start": "1596760",
    "end": "1604279"
  },
  {
    "text": "trying to to implement it all over again and to redo it um it strives to",
    "start": "1604279",
    "end": "1609720"
  },
  {
    "text": "implement all different Ike messages uh and it strives to implement all different I messages in all",
    "start": "1609720",
    "end": "1615360"
  },
  {
    "text": "different um uh steps within the the the protocol",
    "start": "1615360",
    "end": "1621799"
  },
  {
    "text": "so to just tell you what I want to do is um what you can do is there's this uh",
    "start": "1621799",
    "end": "1627919"
  },
  {
    "text": "Certificate request payload and you can even send the Certificate request payload within the first",
    "start": "1627919",
    "end": "1633919"
  },
  {
    "text": "packet you can send it in the second packet you can send it in the third packet and what I try to do is to",
    "start": "1633919",
    "end": "1639840"
  },
  {
    "text": "implement all these different um possibilities so you can choose where to",
    "start": "1639840",
    "end": "1645279"
  },
  {
    "text": "implement or where to send the Certificate request payload and the other payloads",
    "start": "1645279",
    "end": "1651158"
  },
  {
    "text": "too um the tool will be available at this uh URL it's not available yet there",
    "start": "1655039",
    "end": "1662600"
  },
  {
    "text": "I will put it there tonight or tomorrow so um you can download there the newest",
    "start": "1662600",
    "end": "1667880"
  },
  {
    "text": "version of The Tool uh the tool on your dis you received is not the newest",
    "start": "1667880",
    "end": "1673760"
  },
  {
    "text": "version um it still has a couple of problems newest one still probably has problems two uh it's far from complete",
    "start": "1673760",
    "end": "1680799"
  },
  {
    "text": "as I said just to show you a couple of examples what you can do with it um you",
    "start": "1680799",
    "end": "1687080"
  },
  {
    "text": "can try to to um initiate now any kind of VPN connection so here's the I test",
    "start": "1687080",
    "end": "1694720"
  },
  {
    "text": "command uh which Targets this machine uh uses a",
    "start": "1694720",
    "end": "1700200"
  },
  {
    "text": "couple of transforms and uses uh or encrypts the phase one which means that",
    "start": "1700200",
    "end": "1706559"
  },
  {
    "text": "the last two messages shall be encrypted so what you can even",
    "start": "1706559",
    "end": "1712518"
  },
  {
    "text": "do what I what I can do with the tool I can say well I don't want these last two",
    "start": "1713159",
    "end": "1718360"
  },
  {
    "text": "messages well my last messages to be encrypted to be encrypted um",
    "start": "1718360",
    "end": "1724640"
  },
  {
    "text": "and uh using this non-encrypted last message I can test whether the other",
    "start": "1724640",
    "end": "1730720"
  },
  {
    "text": "site will accept it or not accept it there are implementations that do accept it older ones I haven't found one at the",
    "start": "1730720",
    "end": "1738320"
  },
  {
    "text": "moment I'm still testing a lot of different implementations um you can Define your",
    "start": "1738320",
    "end": "1743919"
  },
  {
    "text": "certificate you can Define your private key you want to use you can Define the identification you want to use you want",
    "start": "1743919",
    "end": "1750679"
  },
  {
    "text": "to present the other to the other side like um asn1 distinguished names or IP",
    "start": "1750679",
    "end": "1757559"
  },
  {
    "text": "uh IP addresses and stuff like that um within the payloads as I showed you",
    "start": "1757559",
    "end": "1764039"
  },
  {
    "text": "before there's a reserved bite you can set the reserved bite to different values can check how the different",
    "start": "1764039",
    "end": "1770600"
  },
  {
    "text": "implementations uh react on a set reversed uh reserved bite usually this",
    "start": "1770600",
    "end": "1778399"
  },
  {
    "text": "Reserve bite has to be set to zero and we can set it to any kind of um value",
    "start": "1778399",
    "end": "1784080"
  },
  {
    "text": "and we can pass the output we get back so you've got an idea what the VPN Gateway sends you",
    "start": "1784080",
    "end": "1790559"
  },
  {
    "text": "back so let's just um take a look at at uh one or two of these um uh",
    "start": "1790559",
    "end": "1799039"
  },
  {
    "text": "implementations let's see if that works so what I need now is I",
    "start": "1799039",
    "end": "1805559"
  },
  {
    "text": "need um a Linux box which is vulnerable I start up a",
    "start": "1805880",
    "end": "1813120"
  },
  {
    "text": "Linux would take a couple of seconds",
    "start": "1813120",
    "end": "1818039"
  },
  {
    "text": "so we've got a Linux let's",
    "start": "1841159",
    "end": "1845679"
  },
  {
    "text": "see um this is uh Linux box running on a oh",
    "start": "1846720",
    "end": "1853039"
  },
  {
    "text": "let's see can get this little larger",
    "start": "1853039",
    "end": "1857799"
  },
  {
    "text": "I guess you can read it now um this is a Linux B which which runs on a 2.6 Corel",
    "start": "1858399",
    "end": "1863919"
  },
  {
    "text": "the Linux 2.6 Corel is the first Linux kernel to implement IPC within the kernel um and I've got a raccoon version",
    "start": "1863919",
    "end": "1871799"
  },
  {
    "text": "running on this box well I can start it um the version I'm using",
    "start": "1871799",
    "end": "1879559"
  },
  {
    "text": "here is uh based on the IPC",
    "start": "1880720",
    "end": "1886480"
  },
  {
    "text": "tools um uh if you if you implement or if you",
    "start": "1886679",
    "end": "1891760"
  },
  {
    "text": "build raccoon on Linux you usually don't build the native raccoon on Linux the one from BSD but there's a special port",
    "start": "1891760",
    "end": "1900360"
  },
  {
    "text": "a special Linux Port of raccoon which is called the IPC tools the IPC tools can be downloaded from Source vge 2 and",
    "start": "1900360",
    "end": "1907559"
  },
  {
    "text": "these are the IPC tools 0.3 uh rc4 and um I can start raccoon",
    "start": "1907559",
    "end": "1917638"
  },
  {
    "text": "and I first start Recon using preet keys I just want to show you that actually the tool works and can Implement uh VPN",
    "start": "1920159",
    "end": "1929399"
  },
  {
    "text": "connection I've started raccoon here with uh the debug switches and I've told",
    "start": "1929399",
    "end": "1935720"
  },
  {
    "text": "it to to stay in the foreground so we can see what's going on",
    "start": "1935720",
    "end": "1941278"
  },
  {
    "text": "nah okay let's see um that's not what I wanted",
    "start": "1950880",
    "end": "1957080"
  },
  {
    "text": "oh nah sorry for that",
    "start": "1957080",
    "end": "1964919"
  },
  {
    "text": "okay I'm looking for a preure key version good [Music]",
    "start": "1965760",
    "end": "1973640"
  },
  {
    "text": "one okay",
    "start": "1974080",
    "end": "1978080"
  },
  {
    "text": "okay this one should work um to just uh explain the different",
    "start": "1986000",
    "end": "1992360"
  },
  {
    "text": "options um this box this virtual Linux box which is running here is its own",
    "start": "1992360",
    "end": "2000240"
  },
  {
    "text": "Linux box uh maybe I should uh explain you what's happening on here this is its",
    "start": "2000240",
    "end": "2006960"
  },
  {
    "text": "own Linux box uh separate from the uh box in the background that's got its own",
    "start": "2006960",
    "end": "2013039"
  },
  {
    "text": "IP address this IP address is 5.0.0",
    "start": "2013039",
    "end": "2020840"
  },
  {
    "text": "do1 and when I start raccoon here and issue",
    "start": "2020840",
    "end": "2027120"
  },
  {
    "text": "this command I tell this Comm uh I tell ik test to Target",
    "start": "2027120",
    "end": "2032440"
  },
  {
    "text": "5.0.1 using main mode and",
    "start": "2032440",
    "end": "2038279"
  },
  {
    "text": "and using this transform U so the phase one will be",
    "start": "2038279",
    "end": "2045519"
  },
  {
    "text": "encrypted using uh 3des um authentication will be provided",
    "start": "2045519",
    "end": "2051720"
  },
  {
    "text": "using md5 um I will use pre-share keys for the authentication and I will use the Helman",
    "start": "2051720",
    "end": "2058480"
  },
  {
    "text": "group one um and I offer another transform uh since I initiate the",
    "start": "2058480",
    "end": "2065839"
  },
  {
    "text": "connection I can propose different trans transforms and I propose another transform and uh in the second transform",
    "start": "2065839",
    "end": "2073398"
  },
  {
    "text": "I exchanged md5 by the CQ hash algorithm and I can even uh propose the same",
    "start": "2073399",
    "end": "2082118"
  },
  {
    "text": "transform twice to check whether the other side is able to cope with that if",
    "start": "2082119",
    "end": "2087240"
  },
  {
    "text": "it's able to cope with several identical transforms I can even add uh 10 15 20",
    "start": "2087240",
    "end": "2093760"
  },
  {
    "text": "different transforms to check whether the other side can cope with this number of",
    "start": "2093760",
    "end": "2098880"
  },
  {
    "text": "transforms uh then I Define a preed key I want to use for the authentication um debug gives a lot of",
    "start": "2098880",
    "end": "2105880"
  },
  {
    "text": "information on the screen encrypt phase one tells the tool to um encrypt the",
    "start": "2105880",
    "end": "2112720"
  },
  {
    "text": "last message and get rid is at the moment implemented um in all versions of",
    "start": "2112720",
    "end": "2118640"
  },
  {
    "text": "ik test to get rid of a disclaimer shown in the beginning so raccoon is running",
    "start": "2118640",
    "end": "2126960"
  },
  {
    "text": "and now I start this tool let's see what's oh I'm in the",
    "start": "2126960",
    "end": "2132359"
  },
  {
    "text": "wrong directory",
    "start": "2132359",
    "end": "2135640"
  },
  {
    "text": "okay let's see what's happening so lot of numbers flowing",
    "start": "2140880",
    "end": "2149280"
  },
  {
    "text": "by and here is the information raccoon uh",
    "start": "2149280",
    "end": "2155680"
  },
  {
    "text": "is logging and the last line tells us that a security Association has been",
    "start": "2155680",
    "end": "2161480"
  },
  {
    "text": "established so this tool was able to establish the security association with raccoon at the moment and this is fine",
    "start": "2161480",
    "end": "2168560"
  },
  {
    "text": "because if we take a look at the configuration of raccoon everything we did was okay uh",
    "start": "2168560",
    "end": "2176800"
  },
  {
    "text": "meaning uh we allowed Anonymous uh initiators uh using main",
    "start": "2181119",
    "end": "2188640"
  },
  {
    "text": "mode uh 3D md5 using pre-share keys and if you have group one and the pre-share",
    "start": "2188640",
    "end": "2195040"
  },
  {
    "text": "key we use is okay too since it is mentioned in this file so",
    "start": "2195040",
    "end": "2202880"
  },
  {
    "text": "everything is fine now let's check certificates so I start raccoon",
    "start": "2202880",
    "end": "2209560"
  },
  {
    "text": "again oh this would be the configuration file for certificates",
    "start": "2209560",
    "end": "2216319"
  },
  {
    "text": "and let's start raccoon and let's check raccoon using",
    "start": "2216319",
    "end": "2223240"
  },
  {
    "text": "certificates and what I'm doing here is I'm",
    "start": "2227640",
    "end": "2233359"
  },
  {
    "text": "telling um sorry that was too",
    "start": "2233359",
    "end": "2239599"
  },
  {
    "text": "fast what I'm doing here again is I tell the test tool to Target 501 using main",
    "start": "2243599",
    "end": "2250599"
  },
  {
    "text": "mode using the transform um and for authentication we now want to use RSA signatures we want to encrypt phase one",
    "start": "2250599",
    "end": "2257760"
  },
  {
    "text": "and this is the certificate we want to use this is a private key we want to use we want to use to sign uh the last",
    "start": "2257760",
    "end": "2264359"
  },
  {
    "text": "packet uh this is identification we want to use okay we can get get rid of this",
    "start": "2264359",
    "end": "2269920"
  },
  {
    "text": "reserved here we don't want to change the reserve bite and we want to pass the output want",
    "start": "2269920",
    "end": "2276280"
  },
  {
    "text": "to see what's happening and raccoon background is running and I",
    "start": "2276280",
    "end": "2282880"
  },
  {
    "text": "start this and everything should be",
    "start": "2282880",
    "end": "2289720"
  },
  {
    "text": "fine so again we had uh where is it oh",
    "start": "2290040",
    "end": "2297319"
  },
  {
    "text": "okay great this is German the batter is fully loaded fully charged okay uh where",
    "start": "2297319",
    "end": "2303760"
  },
  {
    "text": "was I uh here that's the um lock message was looking for and again",
    "start": "2303760",
    "end": "2310760"
  },
  {
    "text": "we have got an security Association established using certificates and again",
    "start": "2310760",
    "end": "2316079"
  },
  {
    "text": "this was fine since um the certificate we used uh has been signed by the same",
    "start": "2316079",
    "end": "2322760"
  },
  {
    "text": "certificate of authority raccoon trusts and therefore we should be able to",
    "start": "2322760",
    "end": "2328680"
  },
  {
    "text": "authenticate now let's try something different I start racon again and I tell",
    "start": "2328680",
    "end": "2336880"
  },
  {
    "text": "my tool to use an arbitrary",
    "start": "2336880",
    "end": "2341240"
  },
  {
    "text": "signature just use zeros as signature what happens now is that the last packet",
    "start": "2341960",
    "end": "2347960"
  },
  {
    "text": "that contains the signature will contain these zeros instead of the signature so",
    "start": "2347960",
    "end": "2353480"
  },
  {
    "text": "the last payload will have the static part the next payload bite the reserved",
    "start": "2353480",
    "end": "2359760"
  },
  {
    "text": "bite and the length and then we'll just have the static zeros",
    "start": "2359760",
    "end": "2366200"
  },
  {
    "text": "inside and and if I use",
    "start": "2366200",
    "end": "2370480"
  },
  {
    "text": "that raccoon still says W security Association is established now let's see",
    "start": "2373960",
    "end": "2379079"
  },
  {
    "text": "if we can see uh what's what has [Music]",
    "start": "2379079",
    "end": "2384760"
  },
  {
    "text": "happened okay",
    "start": "2384760",
    "end": "2388200"
  },
  {
    "text": "wa that's I have to let's see if I can find it",
    "start": "2392280",
    "end": "2399318"
  },
  {
    "text": "this s a dck message",
    "start": "2404000",
    "end": "2407400"
  },
  {
    "text": "foron okay where is it I'm not finding at the moment ah wait",
    "start": "2410680",
    "end": "2418480"
  },
  {
    "text": "a second no um I'm not able to find at the moment uh if you actually take a look at",
    "start": "2418480",
    "end": "2424760"
  },
  {
    "text": "the raccoon lock messages you can even see the signature is set to zero and still is um accepted by",
    "start": "2424760",
    "end": "2433480"
  },
  {
    "text": "raccoon now this was fixed in a later version of raccoon and I can show you",
    "start": "2433480",
    "end": "2440240"
  },
  {
    "text": "that that the later version of raccoon is not susceptible to that anymore so I start a different Linux box which",
    "start": "2440240",
    "end": "2447940"
  },
  {
    "text": "[Music] um has a new version of raccoon",
    "start": "2447940",
    "end": "2454520"
  },
  {
    "text": "excuse me um it's not Implement in the version",
    "start": "2464960",
    "end": "2471480"
  },
  {
    "text": "which is on the web or will be on the web but I'm working on it I will tell you a little bit later uh what I",
    "start": "2471480",
    "end": "2477480"
  },
  {
    "text": "actually want to still Implement and which has to still be done and what has been done already yes but vendor IDs are",
    "start": "2477480",
    "end": "2485319"
  },
  {
    "text": "very important and our must let's",
    "start": "2485319",
    "end": "2491960"
  },
  {
    "text": "see let's get this a little bit larger now this is a newer version of",
    "start": "2491960",
    "end": "2497220"
  },
  {
    "text": "[Music] raccoon this",
    "start": "2497220",
    "end": "2502440"
  },
  {
    "text": "is although the number was 0.3 here this",
    "start": "2502440",
    "end": "2507680"
  },
  {
    "text": "is a newer version there's two uh there are two um um um versions at the moment",
    "start": "2507680",
    "end": "2516359"
  },
  {
    "text": "the 0.2 version is a stable version 0.3 version is a development version this one is",
    "start": "2516359",
    "end": "2523880"
  },
  {
    "text": "actually uh not Su susceptible to the TCH and we'll take a look at",
    "start": "2523880",
    "end": "2529000"
  },
  {
    "text": "that so I start my raccoon I hope this is a right configuration file and what",
    "start": "2529000",
    "end": "2536680"
  },
  {
    "text": "we do now is we try the same attack on a different Target this one has got the IP address",
    "start": "2536680",
    "end": "2544000"
  },
  {
    "text": "3.0 and let's let me show that to you",
    "start": "2544000",
    "end": "2549119"
  },
  {
    "text": "this is 3.01 so we target this",
    "start": "2550599",
    "end": "2558960"
  },
  {
    "text": "box let's go",
    "start": "2559000",
    "end": "2565480"
  },
  {
    "text": "and wait a second he's telling me he's got established this thing wait a",
    "start": "2566720",
    "end": "2575079"
  },
  {
    "text": "second I've got a small flaw here in my",
    "start": "2575319",
    "end": "2582400"
  },
  {
    "text": "demonstration this shouldn't happen let's try again oh oh okay it's not sign it's sick",
    "start": "2583119",
    "end": "2593920"
  },
  {
    "text": "this is one of the flaws in this oh sorry uh this is one of the flaws still in the tool if you define an option",
    "start": "2593920",
    "end": "2600839"
  },
  {
    "text": "which is not actually recognized by the tool it doesn't tell you um so um",
    "start": "2600839",
    "end": "2607920"
  },
  {
    "text": "the option here to use is sign and uh let's first try it again on the older",
    "start": "2607920",
    "end": "2613800"
  },
  {
    "text": "one that you still see that the older one accepts",
    "start": "2613800",
    "end": "2618480"
  },
  {
    "text": "it",
    "start": "2619960",
    "end": "2622960"
  },
  {
    "text": "okay so the older one says well everything is fine and let's see now if",
    "start": "2625000",
    "end": "2630400"
  },
  {
    "text": "I can find now signature just composed of zeros",
    "start": "2630400",
    "end": "2637170"
  },
  {
    "text": "[Music] where is it um maybe later okay now let's try it",
    "start": "2637170",
    "end": "2644520"
  },
  {
    "text": "on the side second one okay let's start raccoon and try it on",
    "start": "2644520",
    "end": "2652119"
  },
  {
    "text": "the second one",
    "start": "2652119",
    "end": "2657480"
  },
  {
    "text": "go and here we've got not",
    "start": "2659480",
    "end": "2665359"
  },
  {
    "text": "um accepted security Association and here we find let's see here it is invel",
    "start": "2665359",
    "end": "2674040"
  },
  {
    "text": "sck so the newer version um doesn't accept the signature",
    "start": "2674040",
    "end": "2680079"
  },
  {
    "text": "and tells us which it's an invalid signature and rejects the",
    "start": "2680079",
    "end": "2686640"
  },
  {
    "text": "connection now let's attack the newer",
    "start": "2687599",
    "end": "2693599"
  },
  {
    "text": "one again [Music]",
    "start": "2693599",
    "end": "2698640"
  },
  {
    "text": "and I'm not using um a preset signature my tool",
    "start": "2698640",
    "end": "2704720"
  },
  {
    "text": "should calculate the correct signature and I attack it again and let's see what I'm looking for",
    "start": "2704720",
    "end": "2712400"
  },
  {
    "text": "now is a different kind of message first we see that the phase one has been",
    "start": "2712400",
    "end": "2718400"
  },
  {
    "text": "established again it's here down here and now if we",
    "start": "2718400",
    "end": "2724880"
  },
  {
    "text": "take a look further up where the certificate is",
    "start": "2724880",
    "end": "2730520"
  },
  {
    "text": "checked um here's a signature has been",
    "start": "2733920",
    "end": "2740520"
  },
  {
    "text": "authenticated",
    "start": "2740520",
    "end": "2743520"
  },
  {
    "text": "and wait where is it always happens if you stand in front",
    "start": "2748079",
    "end": "2753960"
  },
  {
    "text": "you never find what you're looking for what I'm oh yeah there it is first line",
    "start": "2753960",
    "end": "2760319"
  },
  {
    "text": "uh certificate has expired by depth zero so this certificate is or was a",
    "start": "2760319",
    "end": "2769040"
  },
  {
    "text": "valid certificate but it's not valid anymore the certificate has been expired and raccoon still accepts the",
    "start": "2769040",
    "end": "2774640"
  },
  {
    "text": "certificate for the authentication there's no way in raccoon in raccoon's configuration files at the moment to",
    "start": "2774640",
    "end": "2781280"
  },
  {
    "text": "actually disable this Behavior there's no way to tell raccoon well accept certificates although they are expired",
    "start": "2781280",
    "end": "2788319"
  },
  {
    "text": "or although they have been revoked so raccoon just accepts them revoked or",
    "start": "2788319",
    "end": "2793920"
  },
  {
    "text": "expired certificates there's now newer version of raccoon which will reject these",
    "start": "2793920",
    "end": "2801520"
  },
  {
    "text": "certificates but still if you take a look at these errors and certificate handling um which have been in recron",
    "start": "2801520",
    "end": "2809160"
  },
  {
    "text": "for the last couple of years uh you would expect that well the the",
    "start": "2809160",
    "end": "2814599"
  },
  {
    "text": "programmers should be able to to find these these flaws and errors and to fix them themselves but essentially or",
    "start": "2814599",
    "end": "2821359"
  },
  {
    "text": "apparently nobody actually tests uh its own Co or his own code um these flaws",
    "start": "2821359",
    "end": "2828599"
  },
  {
    "text": "were in raccoon in all versions of raccoon known to me before March this year and uh if you think about who's",
    "start": "2828599",
    "end": "2836359"
  },
  {
    "text": "using raccoon today well most bsds use it uh apart from open",
    "start": "2836359",
    "end": "2842440"
  },
  {
    "text": "BSD uh Linux is using it so if you've got red Enterprise Linux distribution",
    "start": "2842440",
    "end": "2848720"
  },
  {
    "text": "right Enterprise Linux is using raccoon for its uh Ike messages um if you take a",
    "start": "2848720",
    "end": "2855280"
  },
  {
    "text": "look at Apple um apple is using raccoon for its VPN connections",
    "start": "2855280",
    "end": "2860400"
  },
  {
    "text": "so even uh although redhead and apple got into this um into this stuff which",
    "start": "2860400",
    "end": "2867520"
  },
  {
    "text": "was uh only BSD before uh these errors haven't been",
    "start": "2867520",
    "end": "2873680"
  },
  {
    "text": "found so that's what why I think we we need a tool to test this okay well let's",
    "start": "2873680",
    "end": "2879760"
  },
  {
    "text": "see um where was I [Music]",
    "start": "2879760",
    "end": "2886240"
  },
  {
    "text": "um those were the examples and they showed you that the tool was able to",
    "start": "2886240",
    "end": "2891960"
  },
  {
    "text": "test this stuff now what can't it do yet",
    "start": "2891960",
    "end": "2897440"
  },
  {
    "text": "um while developing this tool I found out that implementing one tool to uh",
    "start": "2897440",
    "end": "2905079"
  },
  {
    "text": "test both both the aggressive and the main mode is much too complicated so",
    "start": "2905079",
    "end": "2910800"
  },
  {
    "text": "right now I've got two tools to test either main mode or aggressive",
    "start": "2910800",
    "end": "2915960"
  },
  {
    "text": "mode uh the aggressive mode tool is not fully finished yet uh there are a",
    "start": "2915960",
    "end": "2922319"
  },
  {
    "text": "couple of uh problems with that tool still uh what both tools don't do yet is",
    "start": "2922319",
    "end": "2927960"
  },
  {
    "text": "they are not able to generate any kind of vendor ID or past vendor IDs uh what",
    "start": "2927960",
    "end": "2933200"
  },
  {
    "text": "are vendor IDs uh vendor IDs were implemented in Ike to allow vendors",
    "start": "2933200",
    "end": "2939920"
  },
  {
    "text": "to um exchange proprietary messages so that if they wanted to test new bleeding",
    "start": "2939920",
    "end": "2947799"
  },
  {
    "text": "edge features they could Implement them in their own software and the software",
    "start": "2947799",
    "end": "2953319"
  },
  {
    "text": "could negotiate uh this fact across the ike channel so one the initiator sent a",
    "start": "2953319",
    "end": "2960400"
  },
  {
    "text": "vendor ID and the responder um somehow recognized the vend ID it could use new",
    "start": "2960400",
    "end": "2966839"
  },
  {
    "text": "additional features uh which are not present in the standard uh Ike protocol",
    "start": "2966839",
    "end": "2973440"
  },
  {
    "text": "uh today vend IDs are very important if you want to implement something uh like N Net traversal netk Network address",
    "start": "2973440",
    "end": "2981880"
  },
  {
    "text": "translation traversal sorry um what net traversal is uh essentially um",
    "start": "2981880",
    "end": "2991319"
  },
  {
    "text": "it allows you to send ik and IPC protocols cross net devices um the",
    "start": "2991319",
    "end": "3000040"
  },
  {
    "text": "problem with ipac and net is that IPC itself cannot be netted why not doesn't",
    "start": "3000040",
    "end": "3008799"
  },
  {
    "text": "have any ports if you take a look at modern uh net device implementations",
    "start": "3008799",
    "end": "3014079"
  },
  {
    "text": "they all use the port to uh keep track of the connections they",
    "start": "3014079",
    "end": "3021000"
  },
  {
    "text": "have neted uh since it's not just net but anap mostly today Network address and",
    "start": "3021000",
    "end": "3028040"
  },
  {
    "text": "pro translation so those are not implemented yet um what uh else am I",
    "start": "3028040",
    "end": "3034960"
  },
  {
    "text": "trying to do well uh during the the development of this tool um I found out",
    "start": "3034960",
    "end": "3041280"
  },
  {
    "text": "that uh the approach I chose in the beginning uh is not very suited for this",
    "start": "3041280",
    "end": "3048119"
  },
  {
    "text": "uh tool and what I'm trying to do is to do a full overhaul and uh try an object",
    "start": "3048119",
    "end": "3054480"
  },
  {
    "text": "oriented approach so it's much easier to implement the different uh messages and the different payloads and stuff like",
    "start": "3054480",
    "end": "3061559"
  },
  {
    "text": "that uh again what I need are more RFC compliance tests uh you are already able",
    "start": "3061559",
    "end": "3068079"
  },
  {
    "text": "to modify almost all payloads using that tool and to uh Define them by hand",
    "start": "3068079",
    "end": "3074920"
  },
  {
    "text": "manually with different length but there's even more that you can do with",
    "start": "3074920",
    "end": "3080359"
  },
  {
    "text": "it and what I'm still missing is the base mode uh what I'm still missing uh",
    "start": "3080359",
    "end": "3086799"
  },
  {
    "text": "some encryption algorithms um which uh should be uh",
    "start": "3086799",
    "end": "3093160"
  },
  {
    "text": "implemented in this tool and uh what I'm missing is time to test commercial",
    "start": "3093160",
    "end": "3099160"
  },
  {
    "text": "implementations so uh that's what I want to do next to just give you an idea what",
    "start": "3099160",
    "end": "3105400"
  },
  {
    "text": "problems you've got if you implement uh such a thing with pearl um",
    "start": "3105400",
    "end": "3113960"
  },
  {
    "text": "um you need and in some cases you need",
    "start": "3125400",
    "end": "3130880"
  },
  {
    "text": "um encodings or um signatures which aren't implemented in PE yet so you",
    "start": "3130880",
    "end": "3137319"
  },
  {
    "text": "don't find any kind of PE module to help you doing it and since I don't want to",
    "start": "3137319",
    "end": "3142520"
  },
  {
    "text": "code a 1,000 line Pro modu to do to do just one task within my uh tool right",
    "start": "3142520",
    "end": "3149480"
  },
  {
    "text": "now I'm uh using sometimes external tools to to implement uh uh part parts",
    "start": "3149480",
    "end": "3156599"
  },
  {
    "text": "of the the ike implementation so here for example I'm using external tool",
    "start": "3156599",
    "end": "3161920"
  },
  {
    "text": "which is called fsw Ser which actually takes a certificate file and extracts",
    "start": "3161920",
    "end": "3168680"
  },
  {
    "text": "the ID the uh asn1 distinguished name",
    "start": "3168680",
    "end": "3173920"
  },
  {
    "text": "out of the certificate file uh and and uh the extracted ID um has the right",
    "start": "3173920",
    "end": "3180760"
  },
  {
    "text": "encoding for it because you need in in the the payloads you need uh asn1 de",
    "start": "3180760",
    "end": "3187920"
  },
  {
    "text": "binary encoded identifications uh to implement that in Pearl well I guess would be a couple of",
    "start": "3187920",
    "end": "3194480"
  },
  {
    "text": "hundred lines uh to do it right and therefore I'm using these external tools",
    "start": "3194480",
    "end": "3199720"
  },
  {
    "text": "sometimes",
    "start": "3199720",
    "end": "3202720"
  },
  {
    "text": "question um yes um I'm I'm using uh op SSL",
    "start": "3204760",
    "end": "3211200"
  },
  {
    "text": "2 uh",
    "start": "3211200",
    "end": "3215000"
  },
  {
    "text": "wait um here for example I'm using the uh open SSL RSA util uh command to uh",
    "start": "3216640",
    "end": "3225559"
  },
  {
    "text": "sign um the data to to create signature um and U what I first wanted",
    "start": "3225559",
    "end": "3232920"
  },
  {
    "text": "to do is actually do a full po implementation to not be uh Dependable on these external tools um",
    "start": "3232920",
    "end": "3240400"
  },
  {
    "text": "and there are a couple of open SSL P modules but most are incomplete so",
    "start": "3240400",
    "end": "3245640"
  },
  {
    "text": "therefore I'm now using open SSL commands directly within the",
    "start": "3245640",
    "end": "3251960"
  },
  {
    "text": "tool um and I think the object oriented approach",
    "start": "3251960",
    "end": "3257680"
  },
  {
    "text": "if I actually redo everything and uh use the object oriented approach I'm I'm able to uh encapsulate that a little bit",
    "start": "3257680",
    "end": "3264640"
  },
  {
    "text": "more and uh to get rid of some uh dependabilities we'll",
    "start": "3264640",
    "end": "3271119"
  },
  {
    "text": "see other questions at the moment okay well uh anyway um that",
    "start": "3272079",
    "end": "3278839"
  },
  {
    "text": "pretty much is it um so that's what's on my to-do list",
    "start": "3278839",
    "end": "3288520"
  },
  {
    "text": "and well uh I would like to thank you for your patience and for listening in uh I showed you two applications of the",
    "start": "3288520",
    "end": "3295440"
  },
  {
    "text": "tool at the moment there are a lot of more that you can do or can use um I'm",
    "start": "3295440",
    "end": "3301520"
  },
  {
    "text": "still testing uh a lot of commercial implementations and I'm looking for uh",
    "start": "3301520",
    "end": "3306960"
  },
  {
    "text": "backs there and am uh further developing the tool as I go along uh implementing",
    "start": "3306960",
    "end": "3313440"
  },
  {
    "text": "that what I need in within the tool if you would like to use the tool would",
    "start": "3313440",
    "end": "3318760"
  },
  {
    "text": "like to test the tool yourself um you can either go to the blackhead website",
    "start": "3318760",
    "end": "3324720"
  },
  {
    "text": "probably uh the tool will be be up online there within a couple of days",
    "start": "3324720",
    "end": "3329880"
  },
  {
    "text": "weeks I don't know how fast Jeff will be uh updating the web page as I said the",
    "start": "3329880",
    "end": "3335440"
  },
  {
    "text": "tool on your CD well I wouldn't bother with it um and I hope that I will be",
    "start": "3335440",
    "end": "3341280"
  },
  {
    "text": "able to uh publish the objectoriented tool within the next one or two weeks",
    "start": "3341280",
    "end": "3347319"
  },
  {
    "text": "depending on the time I've got to to um redo it and if you uh want the",
    "start": "3347319",
    "end": "3354280"
  },
  {
    "text": "up-to-date slides I don't know if anybody followed the slides in the book one or",
    "start": "3354280",
    "end": "3359559"
  },
  {
    "text": "two slides have changed if you want to have the upto-date slides you will find them on the blackhead web page",
    "start": "3359559",
    "end": "3366920"
  },
  {
    "text": "or uh on this web page so",
    "start": "3366920",
    "end": "3372079"
  },
  {
    "text": "uh yeah well um if you got further questions questions you don't want to",
    "start": "3372079",
    "end": "3377200"
  },
  {
    "text": "ask here maybe want to ask private or whatever you can always send questions to me best would be this email address",
    "start": "3377200",
    "end": "3384760"
  },
  {
    "text": "uh so I know uh you referring to the tool okay any further",
    "start": "3384760",
    "end": "3392038"
  },
  {
    "text": "questions I tested against Pluto and uh uh I think within the open source",
    "start": "3396200",
    "end": "3403760"
  },
  {
    "text": "implementations Pluto is probably at the moment the best um especially uh concerning x59 certificates um that's",
    "start": "3403760",
    "end": "3411880"
  },
  {
    "text": "what I'm mostly interested in because they are the most um errors can occur",
    "start": "3411880",
    "end": "3417799"
  },
  {
    "text": "probably um and Pluto and the x59 Page by Andreas Stefan is probably at the",
    "start": "3417799",
    "end": "3424520"
  },
  {
    "text": "moment the best known x509 implementation to me uh but I'm just uh",
    "start": "3424520",
    "end": "3431880"
  },
  {
    "text": "testing the other commercial uh implementations at the moment what I've",
    "start": "3431880",
    "end": "3437079"
  },
  {
    "text": "tested so far for example is uh Microsoft and from the outside it looks",
    "start": "3437079",
    "end": "3443160"
  },
  {
    "text": "quite all right um there are no um uh funny things and and and the the",
    "start": "3443160",
    "end": "3450280"
  },
  {
    "text": "packet to get back um I'm starting testing checkpoint and I'm not quite",
    "start": "3450280",
    "end": "3456119"
  },
  {
    "text": "sure there um we'll see um and a couple of other implementations too but Pluto",
    "start": "3456119",
    "end": "3461960"
  },
  {
    "text": "is well at the moment mostly I use Pluto as a reference so when I develop my tool",
    "start": "3461960",
    "end": "3467200"
  },
  {
    "text": "and want to test new features um I'm I must have a reference on the other side",
    "start": "3467200",
    "end": "3472680"
  },
  {
    "text": "to see what I'm supposed to get back and if everything I prepare has been",
    "start": "3472680",
    "end": "3478000"
  },
  {
    "text": "prepared correctly um so mostly I use Pluto as a reference at the moment and",
    "start": "3478000",
    "end": "3483359"
  },
  {
    "text": "haven't found any funny thing in Pluto uh yet so I guess Pluto is quite all",
    "start": "3483359",
    "end": "3489240"
  },
  {
    "text": "right although uh there was a slight flaw within imputed that",
    "start": "3489240",
    "end": "3497400"
  },
  {
    "text": "was yeah yeah there there were some flaws with in the last couple of weeks yes um but those were mostly found by",
    "start": "3497599",
    "end": "3505280"
  },
  {
    "text": "looking at the source code",
    "start": "3505280",
    "end": "3508119"
  },
  {
    "text": "excuse me um well uh I don't check the",
    "start": "3516000",
    "end": "3522680"
  },
  {
    "text": "certificate I get back with at the moment within my tool because um uh I",
    "start": "3522680",
    "end": "3528039"
  },
  {
    "text": "want to check the other side if that would support certificate chains yes you use any kind of certificate you can um",
    "start": "3528039",
    "end": "3535160"
  },
  {
    "text": "uh what you can do is where is",
    "start": "3535160",
    "end": "3541000"
  },
  {
    "text": "it uh you can use any kind of certificate here and test where the",
    "start": "3541039",
    "end": "3546720"
  },
  {
    "text": "other side support certificate chains and if the other side then requests another certificate uh I could send that",
    "start": "3546720",
    "end": "3553680"
  },
  {
    "text": "too",
    "start": "3553680",
    "end": "3556680"
  },
  {
    "text": "yes to implement what um not yet no um",
    "start": "3560440",
    "end": "3567760"
  },
  {
    "text": "it would be very interesting uh but no not yet it's on the further down",
    "start": "3567760",
    "end": "3575359"
  },
  {
    "text": "list excuse me I2 probably",
    "start": "3577039",
    "end": "3584000"
  },
  {
    "text": "yeah further questions okay well thank [Applause]",
    "start": "3584000",
    "end": "3594400"
  },
  {
    "text": "you",
    "start": "3595039",
    "end": "3598039"
  },
  {
    "text": "e",
    "start": "3624960",
    "end": "3627960"
  },
  {
    "text": "e",
    "start": "3654920",
    "end": "3657920"
  },
  {
    "text": "e for",
    "start": "3684920",
    "end": "3688880"
  }
]