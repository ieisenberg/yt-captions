[
  {
    "text": "[Music]",
    "start": "1600",
    "end": "6730"
  },
  {
    "text": "[Music]",
    "start": "14750",
    "end": "21710"
  },
  {
    "text": "[Music]",
    "start": "25400",
    "end": "39040"
  },
  {
    "text": "about ready to start here talk today is on decompilation and application",
    "start": "40280",
    "end": "45399"
  },
  {
    "text": "security and how it can change your life a little bit about myself my name is Kevin spet I work at spy Labs which is",
    "start": "45399",
    "end": "52320"
  },
  {
    "text": "the research and development arm of spy Dynamics Incorporated we are the world's leader in web application security",
    "start": "52320",
    "end": "58879"
  },
  {
    "text": "Technologies we make assessment tool called Web inspect um in the labs it's by Labs we",
    "start": "58879",
    "end": "65320"
  },
  {
    "text": "do stuff we look at uh emerging issues in application security field and one of the things that is a really great thing",
    "start": "65320",
    "end": "71680"
  },
  {
    "text": "you can do but I don't think has been talked about enough is decompilation uh the goal of this",
    "start": "71680",
    "end": "77880"
  },
  {
    "text": "presentation is not to explain the technical minutia behind what decompilation uh how it actually works",
    "start": "77880",
    "end": "83560"
  },
  {
    "text": "if you want to know that download the uh the jvm spec from Sun it'll basically tell you how to read jvm Shell Code",
    "start": "83560",
    "end": "89680"
  },
  {
    "text": "which is is what decompilation is it just looks to that and it says this is about what this would look like in",
    "start": "89680",
    "end": "94960"
  },
  {
    "text": "source code presentation here is divided into two parts the first thing I'm just going to introduce what decompilation is",
    "start": "94960",
    "end": "102560"
  },
  {
    "text": "couple of quick ways to use it and then after that we're going to get to the fun part which is how I used it to find",
    "start": "102560",
    "end": "107840"
  },
  {
    "text": "vulnerability in ba web logic uh the other thing you guys should know is that if you are following on the slides in",
    "start": "107840",
    "end": "114040"
  },
  {
    "text": "the red book you are going to see different stuff up here it has been revised the most recent slides will be",
    "start": "114040",
    "end": "119320"
  },
  {
    "text": "available on the black hat side afterwards so uh let's get",
    "start": "119320",
    "end": "125200"
  },
  {
    "text": "started all right first question is what is decompilation uh in a sentence",
    "start": "125200",
    "end": "130840"
  },
  {
    "text": "decompilation is a way of getting to source code to applications that are only distributed in executable",
    "start": "130840",
    "end": "136239"
  },
  {
    "text": "form uh decompiler is a rig surprise a program that automates the process of",
    "start": "136239",
    "end": "141599"
  },
  {
    "text": "decompilation so that you don't have to do it by hand a lot of languages decompile really well uh there are ones",
    "start": "141599",
    "end": "147480"
  },
  {
    "text": "for Visual Basic Java um net there are two that I know of right now there are probably going to be more",
    "start": "147480",
    "end": "154319"
  },
  {
    "text": "and something that again hasn't been mentioned much net applications can be decompiled and you can see their source",
    "start": "154319",
    "end": "159959"
  },
  {
    "text": "code in most cases uh there is a thing though that some languages decompile better than",
    "start": "159959",
    "end": "165400"
  },
  {
    "text": "others Java for instance happens to work exceptionally",
    "start": "165400",
    "end": "170879"
  },
  {
    "text": "well there are the reasons for this are basically the same reasons that make Java an attractive language to do",
    "start": "170879",
    "end": "176560"
  },
  {
    "text": "Enterprise development in it uses fewer lines of code which basically means there's less stuff going on you can",
    "start": "176560",
    "end": "182640"
  },
  {
    "text": "accomplish more in a few lines of Java or any other high level programming language than you could in see also Java",
    "start": "182640",
    "end": "189519"
  },
  {
    "text": "applications tend to make extensive use of reusable widely distributed components so you have fewer and fewer",
    "start": "189519",
    "end": "196319"
  },
  {
    "text": "people rolling their own things that are annoying to go through and figure out how they work when you're looking at a Java application and it wants to open a",
    "start": "196319",
    "end": "203080"
  },
  {
    "text": "file pretty much every Java application is going to do it in about the same way uh Java is completely portable again",
    "start": "203080",
    "end": "210920"
  },
  {
    "text": "as one as its strong points so there aren't processor specific issues that you'd have to go through you've got one",
    "start": "210920",
    "end": "217040"
  },
  {
    "text": "executable no matter where you want to run it so you only have to do the decompilation analysis really once uh",
    "start": "217040",
    "end": "223360"
  },
  {
    "text": "and really the real killer is here that the whole thing works an intermediate by code uh VM code is very clean looking",
    "start": "223360",
    "end": "230560"
  },
  {
    "text": "the jvm does a lot of the work in terms of things like memory management and all that stuff that in a language like C or",
    "start": "230560",
    "end": "236640"
  },
  {
    "text": "C++ their executables would take a lot of work to sort out in the decompilation process you simply just don't really",
    "start": "236640",
    "end": "243400"
  },
  {
    "text": "have to worry about it when you're working in Java uh tools that are available uh",
    "start": "243400",
    "end": "250360"
  },
  {
    "text": "mocha was probably the first widely distributed Java decompiler uh it worked well for a while",
    "start": "250360",
    "end": "256160"
  },
  {
    "text": "it's no longer being maintained in fact I think the author is dead uh it's somewhat buggy and as seeing as its",
    "start": "256160",
    "end": "262160"
  },
  {
    "text": "author is dead it is not likely to get repaired anytime soon Jad which is currently my personal favorite is very",
    "start": "262160",
    "end": "268160"
  },
  {
    "text": "fast it's written in C which is which is nice if you're decompiling a very large code base for example an entire servers",
    "start": "268160",
    "end": "275280"
  },
  {
    "text": "it's uh available on a lot of different platforms you can get it for OSX you can get it for Windows you can get it for",
    "start": "275280",
    "end": "281000"
  },
  {
    "text": "Linux for Solaris uh if you like things that are fancy there are nice Standalone goys for",
    "start": "281000",
    "end": "286360"
  },
  {
    "text": "it uh there is a plugin for eclipse for it written by some Japanese guy that I cannot get to work because I can't read",
    "start": "286360",
    "end": "291840"
  },
  {
    "text": "the documentation for it and it looks like it's broken uh but the caveat for it is there is no source",
    "start": "291840",
    "end": "297560"
  },
  {
    "text": "code third one I'm going to mention is jod it is open source uh hosted on",
    "start": "297560",
    "end": "303000"
  },
  {
    "text": "Source Forge it is still actively being maintained and it is written entirely in Java I've had not great luck with J Jad",
    "start": "303000",
    "end": "310360"
  },
  {
    "text": "is still my personal favorite okay now that we know we can decompile stuff uh some ideas for",
    "start": "310360",
    "end": "316919"
  },
  {
    "text": "targets things you might want to look at what should I decompile clients there are a lot of",
    "start": "316919",
    "end": "322400"
  },
  {
    "text": "thick Java clients out there either in the form of applets for instance or uh",
    "start": "322400",
    "end": "327960"
  },
  {
    "text": "Standalone applications a lot of people might use Java clients the people who build these Java clients really don't",
    "start": "327960",
    "end": "334199"
  },
  {
    "text": "expect that people are going to take them apart and see how they work and the things they do uh good examples of java",
    "start": "334199",
    "end": "340479"
  },
  {
    "text": "clients is there was one I had a friend telling me about for a casino that he took apart and as it turned out we",
    "start": "340479",
    "end": "346880"
  },
  {
    "text": "looked through the code and you could get you could see other players hands if you just DEC compiled it look through",
    "start": "346880",
    "end": "352560"
  },
  {
    "text": "the Java code and see what the thing was capable of which is a great blackback strategy I haven't tried it here but",
    "start": "352560",
    "end": "359240"
  },
  {
    "text": "don't think it would work second thing is uh stolen class files if you're doing a web app audit and the servers are",
    "start": "359240",
    "end": "365520"
  },
  {
    "text": "using servlets or Java server Pages somewhere on that server quite possibly on the file system there are class files",
    "start": "365520",
    "end": "372039"
  },
  {
    "text": "class files the Java executable it's what you decompile you can go grab those and you can take them apart and see what those",
    "start": "372039",
    "end": "378880"
  },
  {
    "text": "jsps or serlet pages are doing and finally we can look at",
    "start": "378880",
    "end": "386000"
  },
  {
    "text": "servers uh web sphere is written Java web logic is written in Java uh Sun one",
    "start": "386000",
    "end": "391440"
  },
  {
    "text": "is written in Java jron is written on Java these are applications that power a",
    "start": "391440",
    "end": "396599"
  },
  {
    "text": "lot of the world's largest Enterprise businesses and you know they're all written in this language that you can",
    "start": "396599",
    "end": "402840"
  },
  {
    "text": "basically very easily using tools that are freely available take apart and see how they",
    "start": "402840",
    "end": "408720"
  },
  {
    "text": "work which brings us to yay Bea ba web logic is a pretty popular",
    "start": "408720",
    "end": "417639"
  },
  {
    "text": "application server uh ton of the Fortune 550 companies use it it's out there all the",
    "start": "417639",
    "end": "425879"
  },
  {
    "text": "time and uh a while ago we sat down and we decided we wanted to see what web logic does and we did an audit of it and",
    "start": "425879",
    "end": "432879"
  },
  {
    "text": "we found some interesting stuff next part of the presentation here is going to be a rundown on an excerpt",
    "start": "432879",
    "end": "440360"
  },
  {
    "text": "of the things we did and one of the vulnerabilities we found that involved",
    "start": "440360",
    "end": "445400"
  },
  {
    "text": "decompilation uh I just want to mention at this point that a lot of stuff is changing right now in the way that your",
    "start": "445840",
    "end": "451800"
  },
  {
    "text": "people are going to be hacking in the next few years is that you're not going to find a buffer overflow in web Logic",
    "start": "451800",
    "end": "457000"
  },
  {
    "text": "the entire thing's written in Java and even if you could pull off some magic I mean you're inside the virtual machine",
    "start": "457000",
    "end": "462680"
  },
  {
    "text": "there's not a whole lot you're going to do you're going to have to look for other ways to get into things besides Shell Code uh one of the great ways of",
    "start": "462680",
    "end": "469360"
  },
  {
    "text": "doing it is decompiling stuff and seeing all the stupid things developers did that they figured no one would ever find",
    "start": "469360",
    "end": "475199"
  },
  {
    "text": "and with that started with regular install of ba web logic Windows you'll",
    "start": "475199",
    "end": "480840"
  },
  {
    "text": "note I put up here in very large letters for a reason that will be very soon apparent it basically says we're installing a web logic domain and",
    "start": "480840",
    "end": "487400"
  },
  {
    "text": "there's no template applications on it no custom applications so you know we installed",
    "start": "487400",
    "end": "493400"
  },
  {
    "text": "the server and the very first thing I wanted to do is just see what it had running on it now the documentation for",
    "start": "493400",
    "end": "499360"
  },
  {
    "text": "baa web logic it mentions that there are two applications on the server one of them is Administration console which is",
    "start": "499360",
    "end": "507199"
  },
  {
    "text": "this other one is a certificate app appli it's behind off but the point is there's stuff on the server so instead",
    "start": "507199",
    "end": "514000"
  },
  {
    "text": "of Starting by decompiling the actual server engine which you know is probably somewhat complicated let's just look at",
    "start": "514000",
    "end": "520080"
  },
  {
    "text": "the things that are easier for instance uh the console application uh Windows Server 2003 was",
    "start": "520080",
    "end": "526519"
  },
  {
    "text": "just released for those of you read bug track which is probably just about everyone someone looked at the console application for the windows I 2003",
    "start": "526519",
    "end": "534040"
  },
  {
    "text": "whatever and found that it had some holes in it you can March an elephant through people don't pay a lot of attention to these these things so on a",
    "start": "534040",
    "end": "541399"
  },
  {
    "text": "web app server the place you look for to see what is deployed is in config.xml file this is the one what it basically",
    "start": "541399",
    "end": "548480"
  },
  {
    "text": "looks like for a default web logic install you've got encryption Keys realms for",
    "start": "548480",
    "end": "555120"
  },
  {
    "text": "authentication and these things application deployed that's the whole entire XML",
    "start": "555120",
    "end": "562120"
  },
  {
    "text": "file there's only one of them the there are two applications deployed here one is called default web app and one is",
    "start": "562120",
    "end": "568640"
  },
  {
    "text": "called certificate but that's kind of interesting cuz know for a fact here that there's a",
    "start": "568640",
    "end": "575240"
  },
  {
    "text": "console application so I was thinking there thinking it's not in the config.xml file but it's definitely live",
    "start": "575240",
    "end": "580920"
  },
  {
    "text": "on the server so where is this thing so I head over",
    "start": "580920",
    "end": "587160"
  },
  {
    "text": "here and uh Java applications typically deployed",
    "start": "587160",
    "end": "593560"
  },
  {
    "text": "in war files which is basically a zip file that contains some the",
    "start": "595440",
    "end": "601360"
  },
  {
    "text": "stuff and look at that there is a directory in my server which is the name",
    "start": "601360",
    "end": "607000"
  },
  {
    "text": "of the server instance called internal and that's where console. war is hiding out",
    "start": "607000",
    "end": "612600"
  },
  {
    "text": "so we're going to head over",
    "start": "612600",
    "end": "616480"
  },
  {
    "text": "there and see what's going on in here by the way can everyone see that",
    "start": "618440",
    "end": "623800"
  },
  {
    "text": "okay no great all right um well I just did a find for console. war and uh it",
    "start": "623800",
    "end": "630680"
  },
  {
    "text": "located it and I changed to that directory let me see if I can make the",
    "start": "630680",
    "end": "635720"
  },
  {
    "text": "console larger",
    "start": "635720",
    "end": "638560"
  },
  {
    "text": "here okay that made the console larger the font's still small",
    "start": "649120",
    "end": "655079"
  },
  {
    "text": "here we go",
    "start": "662680",
    "end": "668200"
  },
  {
    "text": "no is that better all right so hold on more we can",
    "start": "668600",
    "end": "676519"
  },
  {
    "text": "keep going I don't know how big these fonts get but we're going to find",
    "start": "676519",
    "end": "681680"
  },
  {
    "text": "out I'm not changing the font color here's 16 x",
    "start": "681680",
    "end": "687560"
  },
  {
    "text": "12 whoa",
    "start": "687920",
    "end": "691240"
  },
  {
    "text": "um that takes too much time and effort I tell you what I I'll give you guys really good descriptions of what I'm doing this is an LSL command I'm seeing",
    "start": "699399",
    "end": "706480"
  },
  {
    "text": "what is in the directory there are not only",
    "start": "706480",
    "end": "712279"
  },
  {
    "text": "is console in here but there are a number of other applications that do the",
    "start": "712279",
    "end": "718160"
  },
  {
    "text": "document says documentation says nothing about that are in this internal directory There Is console. War which is",
    "start": "718160",
    "end": "726000"
  },
  {
    "text": "documented and we saw moment ago starts with login streen there's something called uddi another thing called uddi",
    "start": "726000",
    "end": "732240"
  },
  {
    "text": "Explorer which both looked at and have some very interesting stuff in them those are both web services",
    "start": "732240",
    "end": "738160"
  },
  {
    "text": "related and there are these things here called WL management internal one and WL",
    "start": "738160",
    "end": "746079"
  },
  {
    "text": "internal or WL management internal 2 uh that sounded pretty interesting to me at",
    "start": "746079",
    "end": "751399"
  },
  {
    "text": "that point I did a Google search on it there is nothing on the web about W management internal and any of the B",
    "start": "751399",
    "end": "757199"
  },
  {
    "text": "administrator docs or anything so the only way to learn about them is to take them apart and see what they",
    "start": "757199",
    "end": "764040"
  },
  {
    "text": "do uh process of decompiling this stuff is really simple you just start by",
    "start": "764040",
    "end": "771040"
  },
  {
    "text": "unzipping these things to a directory cannot find fil management. War okay problem solved",
    "start": "771040",
    "end": "781120"
  },
  {
    "text": "so I'm going to the directory where I just unzip this war file again a war file is basically a zip file format that",
    "start": "781160",
    "end": "787279"
  },
  {
    "text": "contains Java files and we're going to see what's in here uh there's a web INF directory and a made INF directory web",
    "start": "787279",
    "end": "794440"
  },
  {
    "text": "INF is interesting if you're looking at a web app there is a file called web.xml which explains how to get at that web",
    "start": "794440",
    "end": "800920"
  },
  {
    "text": "app from uh a browser uh this is what WL management",
    "start": "800920",
    "end": "806600"
  },
  {
    "text": "internal one looks like when you request it this is the web.xml file for",
    "start": "806600",
    "end": "812760"
  },
  {
    "text": "it as you can see it deploys one serlet it is called log file search log file",
    "start": "812760",
    "end": "818399"
  },
  {
    "text": "search sounds pretty interesting to me we're going to decompile",
    "start": "818399",
    "end": "823320"
  },
  {
    "text": "it okay J's there Jad is a one that's written in C I'm very happy with it for",
    "start": "825199",
    "end": "831680"
  },
  {
    "text": "the most part it's very easy to use for instance you just go to the directory with the files you want or",
    "start": "831680",
    "end": "837880"
  },
  {
    "text": "wherever the directory is jar. class or no matching files found what's in",
    "start": "837880",
    "end": "845199"
  },
  {
    "text": "here oh this is the web.xml directory where this file is that tell us that there's login",
    "start": "845199",
    "end": "851199"
  },
  {
    "text": "search we're going to the classes",
    "start": "851199",
    "end": "855720"
  },
  {
    "text": "directory and here we have two Java class files one is called log file search serlet which is the one that's",
    "start": "856639",
    "end": "863079"
  },
  {
    "text": "deployed and the other one is called Web logic log message since web logic log message",
    "start": "863079",
    "end": "868759"
  },
  {
    "text": "isn't deployed it's safe to say this is uh probably something that's just used",
    "start": "868759",
    "end": "873959"
  },
  {
    "text": "by log file",
    "start": "873959",
    "end": "876519"
  },
  {
    "text": "search okay so that's the jat output now we look at the directory again and we've",
    "start": "879839",
    "end": "884920"
  },
  {
    "text": "got two files called Jad that are Java source",
    "start": "884920",
    "end": "889399"
  },
  {
    "text": "code okay so this is what we just walked through two applications and we will",
    "start": "893199",
    "end": "898839"
  },
  {
    "text": "have these management internal things and it had two Java files in it",
    "start": "898839",
    "end": "904360"
  },
  {
    "text": "and one XML file we looked at those and now let's decompile and look at see",
    "start": "904360",
    "end": "910120"
  },
  {
    "text": "what's in there this is going to be absolutely unreadable for you guys I'm going to",
    "start": "910120",
    "end": "916399"
  },
  {
    "text": "have to do something about",
    "start": "916399",
    "end": "919440"
  },
  {
    "text": "this it doesn't look very large just sucks",
    "start": "921839",
    "end": "927279"
  },
  {
    "text": "um I will have SP Spike proxy loaded in just a minute to complete the rest of this presentation for those of you who",
    "start": "937000",
    "end": "942639"
  },
  {
    "text": "haven't used Spike proxy it can do um everything and anything anyway hopefully that's a",
    "start": "942639",
    "end": "949000"
  },
  {
    "text": "little better this looks pretty much like any Java source code file you've ever seen up here it's got a little Jad",
    "start": "949000",
    "end": "954959"
  },
  {
    "text": "header explaining what it did where it came from and we've got all the stuff in here in a serlet servlets are handled",
    "start": "954959",
    "end": "963279"
  },
  {
    "text": "when you make an HTTP request you get generally two handlers for the Ser it",
    "start": "963279",
    "end": "968639"
  },
  {
    "text": "you've got one called do get and do post and these are the ones that are interesting to us because that's where",
    "start": "968639",
    "end": "973680"
  },
  {
    "text": "we can do things uh so here's the do get Handler for the log log file search",
    "start": "973680",
    "end": "980120"
  },
  {
    "text": "serlet which is an undocumented application that's deployed in all ba web logic servers first thing it does is grabs two",
    "start": "980120",
    "end": "988959"
  },
  {
    "text": "headers a header called username and a header name called password and it's going to get the value of those now",
    "start": "988959",
    "end": "994639"
  },
  {
    "text": "that's kind of weird because using headers like that to exchange authentication is not standard so at",
    "start": "994639",
    "end": "1001480"
  },
  {
    "text": "this point I'm I'm pretty sure they're doing stuff and they're not entirely doing things right there's a reason that",
    "start": "1001480",
    "end": "1007800"
  },
  {
    "text": "they're passing these in headers and not using uh real web off using HTTP off or something on application Level which is",
    "start": "1007800",
    "end": "1014519"
  },
  {
    "text": "pretty weird so it takes a username and password and it sets up and this block of code right here basically does",
    "start": "1014519",
    "end": "1022560"
  },
  {
    "text": "authentication and if you log in incorrectly you will get 401 as we see over here because it doesn't have",
    "start": "1022560",
    "end": "1029720"
  },
  {
    "text": "these headers at this point I basically decided that it looks like if they're doing authentication I'm going to need",
    "start": "1029720",
    "end": "1036120"
  },
  {
    "text": "to usern name and password let's move on see if we can find something else so I just like okay what does WL management",
    "start": "1036120",
    "end": "1043720"
  },
  {
    "text": "internal to do since there were two of those things",
    "start": "1043720",
    "end": "1050279"
  },
  {
    "text": "and now we're going to do the same thing again you would unzip WL management internal 2 and then you would run Jano",
    "start": "1072559",
    "end": "1078400"
  },
  {
    "text": "the class files which I have already done so we're going to go here",
    "start": "1078400",
    "end": "1084360"
  },
  {
    "text": "and this is what WL management internal 2 looks like again it's got 403 on it which is kind of discouraging but we're",
    "start": "1084360",
    "end": "1090600"
  },
  {
    "text": "going to look at it anyway so we go to WL management internal 2.xml this has",
    "start": "1090600",
    "end": "1096400"
  },
  {
    "text": "got a couple of things deployed on it there is one servlet called bootstrap and there's another one called",
    "start": "1096400",
    "end": "1103919"
  },
  {
    "text": "file distribution servlet uh at that point I was pretty intrigued so we take apart and in the",
    "start": "1103919",
    "end": "1111120"
  },
  {
    "text": "same way you would you'd go to the directory with the class files and you'd go get the file distribution servlet and",
    "start": "1111120",
    "end": "1117640"
  },
  {
    "text": "you decompile it and you got a number another one of these files so we're going to do the same thing here we're going to look for the serlet handlers do",
    "start": "1117640",
    "end": "1123960"
  },
  {
    "text": "get and do Post",
    "start": "1123960",
    "end": "1127399"
  },
  {
    "text": "so the file distribution Handler for the D post method which is the first",
    "start": "1141960",
    "end": "1148320"
  },
  {
    "text": "thing we're going to look at is that again there's more really",
    "start": "1148320",
    "end": "1154000"
  },
  {
    "text": "weird stuff going on where for whatever reason they're exchanging information through HTTP headers now when you use",
    "start": "1154000",
    "end": "1161440"
  },
  {
    "text": "something like internet explore you don't really have much access to change the headers without doing weird stuff to",
    "start": "1161440",
    "end": "1166960"
  },
  {
    "text": "the Dom someone's probably found a way to do it but it's pretty obvious that whatever these things that it's getting",
    "start": "1166960",
    "end": "1172440"
  },
  {
    "text": "the headers for like WL request type is they don't expect an actual user to be doing this because users aren't going to",
    "start": "1172440",
    "end": "1179520"
  },
  {
    "text": "start changing the headers like that this is obviously something they've set up for internal communication within web",
    "start": "1179520",
    "end": "1185120"
  },
  {
    "text": "logic so this is basically a serlet that an application would be talking to not like a user in front of a web browser",
    "start": "1185120",
    "end": "1191720"
  },
  {
    "text": "which is probably why it's named WL management internal and it goes through and in this",
    "start": "1191720",
    "end": "1197039"
  },
  {
    "text": "one again it's doing authentic a it's got the same thing here get",
    "start": "1197039",
    "end": "1202720"
  },
  {
    "text": "header username and get header password and you'll look that even though this does look like it's protected by o",
    "start": "1202720",
    "end": "1208159"
  },
  {
    "text": "there's something called WL upload application name here that I will mention a little later because it's",
    "start": "1208159",
    "end": "1213360"
  },
  {
    "text": "pretty interesting but we're going to look at the do get header now we've already seen",
    "start": "1213360",
    "end": "1219000"
  },
  {
    "text": "that there are two of them which is a little bit unusual but not too much",
    "start": "1219000",
    "end": "1225039"
  },
  {
    "text": "here's the do get Handler again communication and headers it looks for a header called WL request",
    "start": "1235799",
    "end": "1242120"
  },
  {
    "text": "type and depending on the value of what that is it does a whole bunch of stuff",
    "start": "1242120",
    "end": "1247600"
  },
  {
    "text": "so if your header is equal to WL component request it calls this function",
    "start": "1247600",
    "end": "1253559"
  },
  {
    "text": "if it's wle or resource request it calls this one we are going to look at",
    "start": "1253559",
    "end": "1260600"
  },
  {
    "text": "all these WL request type things there are 10 of them and if you look at these see the ones marked with the star on the",
    "start": "1261679",
    "end": "1267520"
  },
  {
    "text": "slide those are the only ones that do authentication it's got it there and it's got it and other points in it see",
    "start": "1267520",
    "end": "1274720"
  },
  {
    "text": "the username and password but not for all of them some of them will just call these functions if you ask for",
    "start": "1274720",
    "end": "1280799"
  },
  {
    "text": "them we're going to look at the one called WL XML entity request",
    "start": "1280799",
    "end": "1287440"
  },
  {
    "text": "uh we're gonna go",
    "start": "1297559",
    "end": "1300640"
  },
  {
    "text": "back get XML entity request so it's calling this function and we have these",
    "start": "1305600",
    "end": "1311720"
  },
  {
    "text": "headers that we use XML registry name and XML registry path so to just uh",
    "start": "1311720",
    "end": "1319080"
  },
  {
    "text": "sitti back and review here we've got an application called WL management internal",
    "start": "1319080",
    "end": "1326399"
  },
  {
    "text": "2 and it's got a serlet called WL management deployed and if we put the header WL XML request it's going to look",
    "start": "1327480",
    "end": "1334960"
  },
  {
    "text": "at these things I like to push buttons so at this point I'm like okay what do these things do what happens when I start filling stuff",
    "start": "1334960",
    "end": "1341760"
  },
  {
    "text": "in so this tool I'm using it's just a an HTTP request editor it's part of web inspect the software we make so I send",
    "start": "1341760",
    "end": "1349000"
  },
  {
    "text": "this request and it comes back with the error message it's uh HTTP code 500 and internal server error and that text that",
    "start": "1349000",
    "end": "1355640"
  },
  {
    "text": "line at the bottom says XML registry directory cbaa user projects my",
    "start": "1355640",
    "end": "1362760"
  },
  {
    "text": "domain dospace back SL XML Registries and then the garbage I type not found",
    "start": "1362760",
    "end": "1369559"
  },
  {
    "text": "this is pretty cool because it looks like it's using all the stuff I'm putting up here in the headers it's",
    "start": "1369559",
    "end": "1375760"
  },
  {
    "text": "using it to build a file system path that presumably it might be trying to",
    "start": "1375760",
    "end": "1381400"
  },
  {
    "text": "load so we're going to look more into this so it goes through and that source",
    "start": "1381400",
    "end": "1386880"
  },
  {
    "text": "code it gets the values and the headers for XML registry name and XML registry path if both of those are nonnull and",
    "start": "1386880",
    "end": "1393679"
  },
  {
    "text": "not zero length it creates an object called an XML registry dur with the value of XML registry",
    "start": "1393679",
    "end": "1401000"
  },
  {
    "text": "name and in then it calls a method on it with the value of the XML registry path",
    "start": "1401000",
    "end": "1406200"
  },
  {
    "text": "so basically when you hand it these two arguments headers it creates an object and calls a method using the values you",
    "start": "1406200",
    "end": "1412120"
  },
  {
    "text": "did uh XML registry dur is not an object that's in that source code file so we're",
    "start": "1412120",
    "end": "1417480"
  },
  {
    "text": "going to have to go look for it at this point uh did some work that you're not going to see in the presentation because it' be a waste of time to show you web",
    "start": "1417480",
    "end": "1424760"
  },
  {
    "text": "logic has a file called webl logic. jar which contains all more or less all of the classes that web logic use and XML",
    "start": "1424760",
    "end": "1432320"
  },
  {
    "text": "registry do is in there and I'm going to show it to you here so I've already found it and decompiled it and this the",
    "start": "1432320",
    "end": "1438600"
  },
  {
    "text": "same way that we did the other thing you just unzip the file and decompile the classes you",
    "start": "1438600",
    "end": "1444120"
  },
  {
    "text": "want so the first thing we looked at is that in the source code for file distribution serlet it creates an smml",
    "start": "1448559",
    "end": "1454960"
  },
  {
    "text": "registor with string s this is the Constructor for that and basically what it does is it takes it and if all the",
    "start": "1454960",
    "end": "1462760"
  },
  {
    "text": "stuff works out okay it'll go through and set it to the registry name because registry name is a variable",
    "start": "1462760",
    "end": "1468960"
  },
  {
    "text": "and it's equal to whatever you passed into the string for the Constructor which is this value right here XML",
    "start": "1468960",
    "end": "1475320"
  },
  {
    "text": "registry name next thing the application did is called get entity with another value",
    "start": "1475320",
    "end": "1483919"
  },
  {
    "text": "that was the value of XML registry path and it will call get local entity",
    "start": "1483919",
    "end": "1490720"
  },
  {
    "text": "so let's see what it does here file equals new file",
    "start": "1490720",
    "end": "1496440"
  },
  {
    "text": "S1 XML regist plus XML registry name so what it's",
    "start": "1496440",
    "end": "1502399"
  },
  {
    "text": "doing is it is indeed exactly what it would look like here from this air message it's taking whatever we put in",
    "start": "1502399",
    "end": "1509960"
  },
  {
    "text": "here and it's going to load a file based on this and you'll note that it never",
    "start": "1509960",
    "end": "1515399"
  },
  {
    "text": "did any kind of uh validation of your input it didn't try to strip out double dots or all",
    "start": "1515399",
    "end": "1521679"
  },
  {
    "text": "these things never mind that when most people do it they do it wrong anyway in their ways to circumvent them but it just doesn't look like anyone really",
    "start": "1521679",
    "end": "1527640"
  },
  {
    "text": "paid attention to the fact that you can ask for whatever you",
    "start": "1527640",
    "end": "1532880"
  },
  {
    "text": "want so we go through here and we look at what do we have so well there is an",
    "start": "1532880",
    "end": "1539039"
  },
  {
    "text": "undocumented application called WL management internal 2 it is deployed in",
    "start": "1539039",
    "end": "1544360"
  },
  {
    "text": "the most basic configuration of a web logic server it's got a serlet called file",
    "start": "1544360",
    "end": "1550679"
  },
  {
    "text": "distribution which does a bunch of different stuff depending on a value you send it in the headers it doesn't use",
    "start": "1550679",
    "end": "1557360"
  },
  {
    "text": "authentication on most of them one of the file distribution serlet functions WL XML entity request can take",
    "start": "1557360",
    "end": "1566039"
  },
  {
    "text": "two client supplied values and they'll use it to put together a path and then after that as you look in the source",
    "start": "1566039",
    "end": "1572919"
  },
  {
    "text": "code here it returns a file input stream with whatever came out of that call so",
    "start": "1572919",
    "end": "1578640"
  },
  {
    "text": "it is sending whatever the result of that is back to the",
    "start": "1578640",
    "end": "1585399"
  },
  {
    "text": "user so we end up with a that looks like",
    "start": "1585399",
    "end": "1591279"
  },
  {
    "text": "this since it builds it around XML the XML Registries",
    "start": "1593240",
    "end": "1599679"
  },
  {
    "text": "directory we're going to have to Traverse out of it using those uh double dots and slashes since it doesn't mind",
    "start": "1600720",
    "end": "1606000"
  },
  {
    "text": "it doesn't try to block it and let's say the file we want is config.xml which we already looked at because we have access",
    "start": "1606000",
    "end": "1612200"
  },
  {
    "text": "to the server but normally you can't touch it it's in the web INF directory which is supposedly protected on web app",
    "start": "1612200",
    "end": "1618039"
  },
  {
    "text": "server servers so we send off this request and surprise surprise we do get the config.xml file returned uh",
    "start": "1618039",
    "end": "1626039"
  },
  {
    "text": "config.xml files are really nice if uh the web application use database access which almost all of them do uh the",
    "start": "1626039",
    "end": "1633520"
  },
  {
    "text": "database connection information login name password is usually stored in here uh crypto Keys all kinds of other little",
    "start": "1633520",
    "end": "1643399"
  },
  {
    "text": "settings um I'll show you another thing here which is really cool if the server",
    "start": "1643559",
    "end": "1649760"
  },
  {
    "text": "really isn't configured right it doesn't stop with what's inside that web",
    "start": "1649760",
    "end": "1655398"
  },
  {
    "text": "application y three dots uh thank",
    "start": "1659840",
    "end": "1666640"
  },
  {
    "text": "you that's the boot.ini file so at this point we have one of the world's most",
    "start": "1668320",
    "end": "1674640"
  },
  {
    "text": "popular web application servers for large Enterprises that has this undocumented application",
    "start": "1674640",
    "end": "1680720"
  },
  {
    "text": "that basically lets anyone who asks for it pull files off the system uh I will tell you guys uh other",
    "start": "1680720",
    "end": "1687080"
  },
  {
    "text": "things that there are all kinds of other stuff that these applications do that I just showed you one of them WL XML",
    "start": "1687080",
    "end": "1693360"
  },
  {
    "text": "entity request this is by the way this is a released bug they fixed it a while ago uh most people didn't bother",
    "start": "1693360",
    "end": "1700600"
  },
  {
    "text": "patching so this is very useful stuff if you go through and you walk through the procedure I did and you take a time to",
    "start": "1700600",
    "end": "1706480"
  },
  {
    "text": "look at everything thing that those source files do there are ways to upload applications to the server there are",
    "start": "1706480",
    "end": "1712960"
  },
  {
    "text": "ways of getting the complete source code to the applications it'll actually send it back to you in war file",
    "start": "1712960",
    "end": "1718480"
  },
  {
    "text": "format for those of you who don't know that you can go to the Bea website and download the installer for this you can",
    "start": "1718480",
    "end": "1724640"
  },
  {
    "text": "actually download a vulnerable version I don't know why they're still on their website but they are out there so you",
    "start": "1724640",
    "end": "1730159"
  },
  {
    "text": "can walk through this presentation and see did and find all the other stuff uh at this point I'm going to open",
    "start": "1730159",
    "end": "1736399"
  },
  {
    "text": "up the room for questions if anyone has any questions about application Security in general what went on here please feel",
    "start": "1736399",
    "end": "1742519"
  },
  {
    "text": "free to ask",
    "start": "1742519",
    "end": "1746240"
  },
  {
    "text": "yes well preventing Java decompilation is there are tools called Opus skaters",
    "start": "1748159",
    "end": "1754720"
  },
  {
    "text": "that do things that are known to kind of break decompilation tools some of them work pretty well some of them don't but",
    "start": "1754720",
    "end": "1761760"
  },
  {
    "text": "at the end of the day the the truth is you've got to write good code you can't put stuff in there and assume no one",
    "start": "1761760",
    "end": "1767799"
  },
  {
    "text": "will ever find it it's the the solution and it's not an easy one but it's the right",
    "start": "1767799",
    "end": "1773600"
  },
  {
    "text": "one",
    "start": "1773600",
    "end": "1776600"
  },
  {
    "text": "yes Bea web logic was very alarmed that they had these problems in their code",
    "start": "1779679",
    "end": "1784919"
  },
  {
    "text": "and they worked with me they created a patch for it took it apart uh there was no backlash there was no why are you",
    "start": "1784919",
    "end": "1791480"
  },
  {
    "text": "doing this you know blah blah blah blah blah they were very receptive to the fact that people are going to be going",
    "start": "1791480",
    "end": "1796840"
  },
  {
    "text": "through their stuff looking for problems",
    "start": "1796840",
    "end": "1800039"
  },
  {
    "text": "well the the laws that would be used to prevent this are specifically designed for the circumvention of copyright",
    "start": "1809120",
    "end": "1814760"
  },
  {
    "text": "controls this really isn't a copyright control issue furthermore uh supposedly security uh stuff security research is",
    "start": "1814760",
    "end": "1823120"
  },
  {
    "text": "protected what I feel I'm doing is legitimate if they don't like it you",
    "start": "1823120",
    "end": "1828399"
  },
  {
    "text": "know it's not my problem I'm here to share knowledge other",
    "start": "1828399",
    "end": "1835760"
  },
  {
    "text": "questions okay well thank you all for your time have a lovely",
    "start": "1838679",
    "end": "1843840"
  },
  {
    "text": "[Applause]",
    "start": "1843840",
    "end": "1850200"
  },
  {
    "text": "convention",
    "start": "1856919",
    "end": "1859919"
  },
  {
    "text": "e",
    "start": "1886919",
    "end": "1889919"
  },
  {
    "text": "e",
    "start": "1916840",
    "end": "1919840"
  },
  {
    "text": "e",
    "start": "1946840",
    "end": "1949840"
  },
  {
    "text": "e",
    "start": "1976840",
    "end": "1979840"
  },
  {
    "text": "e",
    "start": "2006760",
    "end": "2009760"
  },
  {
    "text": "e",
    "start": "2036720",
    "end": "2039720"
  },
  {
    "text": "e",
    "start": "2066720",
    "end": "2069720"
  },
  {
    "text": "e",
    "start": "2096640",
    "end": "2099640"
  },
  {
    "text": "e",
    "start": "2126640",
    "end": "2129640"
  },
  {
    "text": "e",
    "start": "2156640",
    "end": "2159640"
  },
  {
    "text": "e",
    "start": "2186560",
    "end": "2189560"
  },
  {
    "text": "e",
    "start": "2216520",
    "end": "2219520"
  },
  {
    "text": "e",
    "start": "2246520",
    "end": "2249520"
  },
  {
    "text": "e",
    "start": "2276440",
    "end": "2279440"
  },
  {
    "text": "e for",
    "start": "2306440",
    "end": "2310480"
  }
]