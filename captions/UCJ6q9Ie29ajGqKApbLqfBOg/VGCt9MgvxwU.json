[
  {
    "text": "all right thanks everyone for coming to my presentation side Channel analysis for cheap skates so hopefully a few",
    "start": "80",
    "end": "6319"
  },
  {
    "text": "cheap skates in the room here that can enjoy why we want to attack Hardware using very lowcost methods rather than",
    "start": "6319",
    "end": "13719"
  },
  {
    "text": "the sort of typical high-end Scopes that I'm also going to be showing so I come from Halifax Nova Scotia Canada which is",
    "start": "13719",
    "end": "20880"
  },
  {
    "text": "the far east side of Canada and it's actually somewhat easier between the friendlier EU customs and the flights",
    "start": "20880",
    "end": "28039"
  },
  {
    "text": "for me to get here than it is to get to to Las Vegas or",
    "start": "28039",
    "end": "33439"
  },
  {
    "text": "California so in between the next hour between now in lunch I'm going to",
    "start": "34200",
    "end": "39600"
  },
  {
    "text": "introduce you a bit to what is side Channel analysis A lot of people have this rough idea of what it is but it",
    "start": "39600",
    "end": "45680"
  },
  {
    "text": "seems sort of magic you have some device you do something and somehow you get the",
    "start": "45680",
    "end": "50840"
  },
  {
    "text": "key there's something in between those two steps and that's this side Channel analysis the rest of the presentation is",
    "start": "50840",
    "end": "57480"
  },
  {
    "text": "introducing a lot of these tools that trying to help create and release um so there's some software I call Chip",
    "start": "57480",
    "end": "64239"
  },
  {
    "text": "whisper and that interfaces through some different waveform acquisition Hardware some different example systems that you",
    "start": "64239",
    "end": "71200"
  },
  {
    "text": "can attack to learn about it as well as sort of building your own amplifiers building some of your own front end",
    "start": "71200",
    "end": "77600"
  },
  {
    "text": "equipment and a quick sort of very brief where do you go from here so it's",
    "start": "77600",
    "end": "83040"
  },
  {
    "text": "important first to sort of Define what the motivation of this talk is and what you can hope to get out of it I'm not",
    "start": "83040",
    "end": "89000"
  },
  {
    "text": "trying to create something that's just a simple script you know that you can just run and it just works and does",
    "start": "89000",
    "end": "94280"
  },
  {
    "text": "everything this is all about learning about side Channel analysis so you're really going to have to spend time",
    "start": "94280",
    "end": "101079"
  },
  {
    "text": "learning the underlying Theory learning some of the math there's not that much math to be honest learning how the",
    "start": "101079",
    "end": "107759"
  },
  {
    "text": "algorithms are really working it's not just a okay you connect this up you hit this button and poof it works",
    "start": "107759",
    "end": "114680"
  },
  {
    "text": "magically so you will have to know something about Hardware design uh software programming so both the",
    "start": "114680",
    "end": "120759"
  },
  {
    "text": "embedded targets and the software running on the computer and you're probably going to get frustrated all the",
    "start": "120759",
    "end": "126920"
  },
  {
    "text": "tools I'm sort of working on now they do work but they're Ultra beta Alpha type",
    "start": "126920",
    "end": "132599"
  },
  {
    "text": "tools and you might have to contribute them a bit it's all open source as I said and sort of tear into the",
    "start": "132599",
    "end": "140040"
  },
  {
    "text": "internals all right so with that sort of disclaimer about what you might get of this presentation let's talk about the",
    "start": "140040",
    "end": "147160"
  },
  {
    "text": "side channel the power channel in particular so we have a chip and we have",
    "start": "147160",
    "end": "152400"
  },
  {
    "text": "a main channel that you talk to it with if it's the smart card your",
    "start": "152400",
    "end": "157680"
  },
  {
    "text": "Communication channel or any other com Channel but there's something else here it the device also takes",
    "start": "157680",
    "end": "164640"
  },
  {
    "text": "power and this is where we get this power side channel so over this",
    "start": "164640",
    "end": "170680"
  },
  {
    "text": "additional Channel over this other information we're going to get some we're going to learn something about the",
    "start": "170680",
    "end": "176560"
  },
  {
    "text": "secret in the device so using the main Channel you you're not supposed to be able to learn anything about the secret",
    "start": "176560",
    "end": "182120"
  },
  {
    "text": "that's the whole point but using this side channel in this case power we can",
    "start": "182120",
    "end": "188080"
  },
  {
    "text": "so how does this work how does this sort of magic power Channel work imagine you had some chip Crypt Pro 9000 the latest",
    "start": "188080",
    "end": "194959"
  },
  {
    "text": "digital logic chip inside it it has a 4-bit bus and there's two blocks in this",
    "start": "194959",
    "end": "201720"
  },
  {
    "text": "case you can imagine between say the RAM and an ALU maybe it's just doing an algorithm in software so it has to take",
    "start": "201720",
    "end": "208439"
  },
  {
    "text": "data from Ram move it to the AL does something on it pushes it back those",
    "start": "208439",
    "end": "214360"
  },
  {
    "text": "data buses are basically just small very small wires that are sending data between them",
    "start": "214360",
    "end": "221799"
  },
  {
    "text": "you might think of it as something like this so in this schematic here if you're not too familiar with electronics these",
    "start": "221799",
    "end": "227439"
  },
  {
    "text": "are basically just switches and they're switching the data bus line from either",
    "start": "227439",
    "end": "232640"
  },
  {
    "text": "the VCC so the positive or the ground so it can send a zero or one by switching",
    "start": "232640",
    "end": "237879"
  },
  {
    "text": "this bus line to one of those States now this bus which is effectively",
    "start": "237879",
    "end": "244920"
  },
  {
    "text": "a long wire relatively I'm calling it has a bit of capacitance to change the",
    "start": "244920",
    "end": "251519"
  },
  {
    "text": "state of a capacitor it takes charge which means it takes power so every time we send a one or a zero it takes a tiny",
    "start": "251519",
    "end": "258479"
  },
  {
    "text": "tiny tiny amount of power from one of those either the VCC or the ground",
    "start": "258479",
    "end": "264280"
  },
  {
    "text": "rail so what you can see is imagine if I have two bits on a data bus and and with",
    "start": "264280",
    "end": "270160"
  },
  {
    "text": "digital logic systems there's always this clock so we're all everything is synchronized to this clock on this clock",
    "start": "270160",
    "end": "276320"
  },
  {
    "text": "Edge everything happens at the next clock Edge in the next time step everything else happens so we can",
    "start": "276320",
    "end": "283360"
  },
  {
    "text": "imagine that if the data bus is first at the zero State and I want to move it to the one state at that clock Edge it's",
    "start": "283360",
    "end": "291720"
  },
  {
    "text": "going to take a tiny bit of power to do that it's just physically required to",
    "start": "291720",
    "end": "297600"
  },
  {
    "text": "change the charge on the bus it takes the power so if we looked at the power sort of in an ideal manner what you",
    "start": "297600",
    "end": "304720"
  },
  {
    "text": "would see is on each clock Edge you would see some spikes either in the VCC rail or the ground rail depending what",
    "start": "304720",
    "end": "311120"
  },
  {
    "text": "the state is so this very basic observation is sort of everything you",
    "start": "311120",
    "end": "317160"
  },
  {
    "text": "need to know about power analysis this is the root of why it works is that it physically takes power to change the",
    "start": "317160",
    "end": "324400"
  },
  {
    "text": "state of a normal data bus and based on this we can sort of break everything out",
    "start": "324400",
    "end": "329919"
  },
  {
    "text": "which I'll explain next so there's two power models I should explain first you might hear",
    "start": "329919",
    "end": "336560"
  },
  {
    "text": "people talk about one of them is called Hamming distance which is to say on",
    "start": "336560",
    "end": "342319"
  },
  {
    "text": "every clock cycle the bus is going to change from one state to the next so what I've shown here is what we call",
    "start": "342319",
    "end": "347440"
  },
  {
    "text": "Hamming distance so from here to here where it goes from zero to one um it's",
    "start": "347440",
    "end": "353600"
  },
  {
    "text": "taking this positive Spike and when it's going from one to zero it takes a spike of the opposite direction",
    "start": "353600",
    "end": "360520"
  },
  {
    "text": "but these small microcontrollers I'm going to be showing actually have what we call a Hamming weight power model",
    "start": "360520",
    "end": "366960"
  },
  {
    "text": "which is to say that on every clock cycle this isn't actually accurate what",
    "start": "366960",
    "end": "372080"
  },
  {
    "text": "it actually looks like is these spikes are just related to the current state of the data bus so if there's a bunch of",
    "start": "372080",
    "end": "379280"
  },
  {
    "text": "ones in the bus there's always a positive Spike even if it's staying the same where this comes from is the buses",
    "start": "379280",
    "end": "386400"
  },
  {
    "text": "do something called a pre-charge which is you can imagine if the data bus switches from all ones to all zeros this",
    "start": "386400",
    "end": "392240"
  },
  {
    "text": "would be the worst case power consumption this would be the require the most charge um your worst case is",
    "start": "392240",
    "end": "398000"
  },
  {
    "text": "going to limit your device in terms of speed and things like that they can go over the data bus so what they do is in",
    "start": "398000",
    "end": "404319"
  },
  {
    "text": "between these two states it's pre-charging it to halfway so it's always putting it to this half state to",
    "start": "404319",
    "end": "410919"
  },
  {
    "text": "go from this half state to either positive or negative is going to take half the energy so now when we go from",
    "start": "410919",
    "end": "417280"
  },
  {
    "text": "all ones to all zeros it's actually going into this half state in between and then goes to all zeros an artifact",
    "start": "417280",
    "end": "424199"
  },
  {
    "text": "is this that every clock cycle we can learn about the number of ones that is",
    "start": "424199",
    "end": "429720"
  },
  {
    "text": "on the data bus which is what we call the Hamming weight model so the Hamming",
    "start": "429720",
    "end": "435319"
  },
  {
    "text": "weight model is just saying that we always know the number of ones on the data bus the Hamming distance is saying",
    "start": "435319",
    "end": "441199"
  },
  {
    "text": "we know how many lines are changing on every clock",
    "start": "441199",
    "end": "446240"
  },
  {
    "text": "cycle so this is seems like so far very very basic B piece of information we know just the number one's on a bus and",
    "start": "446240",
    "end": "453800"
  },
  {
    "text": "how we use this though is that any sort of crypto algorithm you put in stuff at a comes out at B and you can't find the",
    "start": "453800",
    "end": "461560"
  },
  {
    "text": "secret key but there's all sorts of intermediate operations and this is what we target this stuff here at C so we",
    "start": "461560",
    "end": "469000"
  },
  {
    "text": "want to learn information about these intermediate supposedly secret operations and if we learn that then we",
    "start": "469000",
    "end": "475360"
  },
  {
    "text": "can derive the secret key so let me give you a very basic example of how this might work say I had",
    "start": "475360",
    "end": "482599"
  },
  {
    "text": "a 4 bit system again and say all it's doing is xoring data I can put in any",
    "start": "482599",
    "end": "489759"
  },
  {
    "text": "plain text I want any single four bit number here and there's a key I don't",
    "start": "489759",
    "end": "496360"
  },
  {
    "text": "know what the key is and I also cannot look at the output otherwise I could obviously very easily get this so I",
    "start": "496360",
    "end": "503080"
  },
  {
    "text": "somehow knowing just what I put in and assuming I can measure the power want to",
    "start": "503080",
    "end": "508159"
  },
  {
    "text": "find out the key so how we do this first I'm going to",
    "start": "508159",
    "end": "513800"
  },
  {
    "text": "talk about the original type of power analysis called differential power analysis or DPA so if you look up sort",
    "start": "513800",
    "end": "520279"
  },
  {
    "text": "of the original paper in this field this is what they describe and then I'll talk",
    "start": "520279",
    "end": "525760"
  },
  {
    "text": "about a slightly more advanced one that will be demoed here so the original DPA attack you put in in this case I have",
    "start": "525760",
    "end": "532640"
  },
  {
    "text": "seven input plantex I've just randomly chosen seven it doesn't matter what they are and I've measured the power well",
    "start": "532640",
    "end": "538760"
  },
  {
    "text": "I've put those in so now I have seven power traces and I can see you know what was",
    "start": "538760",
    "end": "544360"
  },
  {
    "text": "happening during that time I can also guess what the hypothetical key might be",
    "start": "544360",
    "end": "549880"
  },
  {
    "text": "there's 16 possibilities that that key could be so I can take for each of those input",
    "start": "549880",
    "end": "556040"
  },
  {
    "text": "plane texts that I know because I chose them randomly I can say well if the key was two I'm just I'm going to try every",
    "start": "556040",
    "end": "562800"
  },
  {
    "text": "guess I'm going to say if the key was two if the key was three Etc um the hypothetical result would be six I'm",
    "start": "562800",
    "end": "569480"
  },
  {
    "text": "going to take a look at a single bit of that 4-bit bus and say well in this result Bit Zero was a zero and this",
    "start": "569480",
    "end": "578200"
  },
  {
    "text": "result Bit Zero was one Etc and I'm going to do that again for",
    "start": "578200",
    "end": "584240"
  },
  {
    "text": "all of the 16 possibilities that I think the key could be what I'm going to do now is split up",
    "start": "584240",
    "end": "593120"
  },
  {
    "text": "um the power traces associated with each Bit Zero and bit one state so all the power traces associated with the Bit",
    "start": "593120",
    "end": "601000"
  },
  {
    "text": "Zero being zero I think is zero in the hypothetical case I'm going to put to one side and all of them with a bit",
    "start": "601000",
    "end": "608000"
  },
  {
    "text": "where I think it was one I'm going to put to the other side remember I don't know the key I'm just guessing so I'm going to have 16 different Arrangements",
    "start": "608000",
    "end": "615240"
  },
  {
    "text": "of these power traces if I was right what I'd expect to",
    "start": "615240",
    "end": "621360"
  },
  {
    "text": "see is somewhere there's going to be a difference between those two sets because if I was right at some point",
    "start": "621360",
    "end": "627920"
  },
  {
    "text": "that but that single bit is is always zero so it's taking less power at another point that single bit was always",
    "start": "627920",
    "end": "635320"
  },
  {
    "text": "one if I was right and when I compare sort of the average or add up all of",
    "start": "635320",
    "end": "640440"
  },
  {
    "text": "those sets I've made I should see this difference like that if I was wrong and",
    "start": "640440",
    "end": "646440"
  },
  {
    "text": "assuming you have a lot of traces not just seven um it should just average out to 0.5 and the rest of the bit should",
    "start": "646440",
    "end": "652440"
  },
  {
    "text": "also average out to 0.5 so this is how we sort of do the original differential power analysis",
    "start": "652440",
    "end": "660320"
  },
  {
    "text": "there's a more powerful version that is called correlation analysis or correlation power analysis and rather",
    "start": "660320",
    "end": "667360"
  },
  {
    "text": "than targeting a single bit we look at okay what is the hypothetical result in this case what is the hypothetical",
    "start": "667360",
    "end": "673880"
  },
  {
    "text": "Hamming weight so all of the bits um and again I do the same thing I guess what the key is I have no idea just take",
    "start": "673880",
    "end": "680279"
  },
  {
    "text": "every 16 possible guess and I look at this hypothetical Hamming weight and see",
    "start": "680279",
    "end": "686639"
  },
  {
    "text": "if there's correlation with my power tra in one of these 16 cases I should see",
    "start": "686639",
    "end": "692399"
  },
  {
    "text": "somewhere with good correlation correlation meaning there's just a linear relationship between this and the",
    "start": "692399",
    "end": "698360"
  },
  {
    "text": "amount of power which will be true if my hypothetical result was",
    "start": "698360",
    "end": "705079"
  },
  {
    "text": "correct if you start to think too much about this example you'll realize it's quite poor and will start to fail um for",
    "start": "705519",
    "end": "712279"
  },
  {
    "text": "example that first case any key with Bit Zero cleared gives you bit zero so you're going to have multiple keys that",
    "start": "712279",
    "end": "719040"
  },
  {
    "text": "are successful um in real examples we wouldn't be attacking something like the",
    "start": "719040",
    "end": "724240"
  },
  {
    "text": "exor what you might look at is the sbox output of the",
    "start": "724240",
    "end": "729880"
  },
  {
    "text": "AES um so an AES for example which looks something like this",
    "start": "730040",
    "end": "736880"
  },
  {
    "text": "at the input what I'm doing is I'm just attacking I can guess I'm trying to",
    "start": "736880",
    "end": "742440"
  },
  {
    "text": "guess this key here I know the plain text because this is what I put in um",
    "start": "742440",
    "end": "748480"
  },
  {
    "text": "and I just yes you know if the key was Zero I know what the plain text is I know what the output of the S boox would",
    "start": "748480",
    "end": "754279"
  },
  {
    "text": "be and this is where I'm attacking and you just do that for every one of the 16 um sub",
    "start": "754279",
    "end": "761639"
  },
  {
    "text": "keys so if you wanted sort of a simplified algorithm it would look something like that so we input many PL",
    "start": "761639",
    "end": "767360"
  },
  {
    "text": "text we measure the power and for each of the possibilities of the keys for",
    "start": "767360",
    "end": "772920"
  },
  {
    "text": "each of those 16 bytes we calculate the sbox output we use the power model so",
    "start": "772920",
    "end": "778600"
  },
  {
    "text": "the Hamming weight Hamming distance um to see well what should the Power Trace look like should we have more power less",
    "start": "778600",
    "end": "785680"
  },
  {
    "text": "power and we measure the correlation between the two whichever of those 256",
    "start": "785680",
    "end": "791000"
  },
  {
    "text": "key gases had the highest correlation we say well that that was it that was probably",
    "start": "791000",
    "end": "797959"
  },
  {
    "text": "correct and again there's the a so to sort of simplify getting into",
    "start": "798360",
    "end": "805240"
  },
  {
    "text": "this a bit I've created this software called chip Whisperer and it's it's all open source GPL",
    "start": "805240",
    "end": "811480"
  },
  {
    "text": "licensed and you can get it from Chip whisper.com all these are referenced at the end of the slides as well so there's",
    "start": "811480",
    "end": "818560"
  },
  {
    "text": "the git repository as I say all of the tools I'm showing you here all of the Hardware Designs um PCB layouts are all",
    "start": "818560",
    "end": "826519"
  },
  {
    "text": "online in that repository there's a mailing list for discussion and there's a Wiki for",
    "start": "826519",
    "end": "834639"
  },
  {
    "text": "documentation and to avoid look something like that just so that",
    "start": "834639",
    "end": "840880"
  },
  {
    "text": "people don't all stare at their laptops while I'm talking um so as you can see there's a number of I'm starting to add",
    "start": "840880",
    "end": "847839"
  },
  {
    "text": "descriptions of some of the various software and Hardware that you can use",
    "start": "847839",
    "end": "852920"
  },
  {
    "text": "here let's go back to this there's two main software packages",
    "start": "852920",
    "end": "859680"
  },
  {
    "text": "um chip whisper capture so this is my interface for capturing the power traces",
    "start": "859680",
    "end": "864720"
  },
  {
    "text": "and you can extend this to work with all sorts of other oscilloscopes if you want and the analyzer which applies this",
    "start": "864720",
    "end": "871000"
  },
  {
    "text": "attack I just described to the power traces I'm using mostly python for the",
    "start": "871000",
    "end": "877079"
  },
  {
    "text": "guey and the tools here which not necessarily the fastest compared to you know straight C but a you can interface",
    "start": "877079",
    "end": "884800"
  },
  {
    "text": "to a lot of other code from within python if you haven't used it like mat lab you can interface to C code um and",
    "start": "884800",
    "end": "892199"
  },
  {
    "text": "it's quite a bit easier for sort of getting into this if you want to make a few quick hacks Python's very quick for",
    "start": "892199",
    "end": "898639"
  },
  {
    "text": "that sort of work um so let me show you this so this is the chip whisper analyzer software",
    "start": "898639",
    "end": "906399"
  },
  {
    "text": "and let me sort of give you a preview of",
    "start": "906399",
    "end": "910360"
  },
  {
    "text": "that so if I run it looks something like that and I can",
    "start": "913320",
    "end": "919120"
  },
  {
    "text": "load a capture that is included the the version",
    "start": "919120",
    "end": "924480"
  },
  {
    "text": "of this on the CDs doesn't have sort of all these updates there's a link at the end that hasn't updated zip that's",
    "start": "924480",
    "end": "930279"
  },
  {
    "text": "exactly what you're seeing here so example traces this chip Whisperer",
    "start": "930279",
    "end": "936519"
  },
  {
    "text": "project and we can look at so these are power traces from a software AES",
    "start": "936519",
    "end": "941880"
  },
  {
    "text": "implementation it's a real AES library and that I didn't write this this is used by people in actual",
    "start": "941880",
    "end": "949360"
  },
  {
    "text": "proc um so we can zoom in for example on part of the",
    "start": "949360",
    "end": "954880"
  },
  {
    "text": "um part of the computations and you can see sort of some",
    "start": "954880",
    "end": "960120"
  },
  {
    "text": "uh patterns in it and you can plot for example a few power traces to Overlay them and you can start to see areas",
    "start": "960120",
    "end": "967519"
  },
  {
    "text": "where they may differ a bit for doing the actual power analysis um we can select as I said we",
    "start": "967519",
    "end": "975240"
  },
  {
    "text": "had these this type of uh attack correlation or the original DPA we can",
    "start": "975240",
    "end": "981720"
  },
  {
    "text": "select Hamming weight or Hamming distance type models and select how many traces so remember when I said that the",
    "start": "981720",
    "end": "988319"
  },
  {
    "text": "input in that example the DPA I was putting in seven traces um you may need",
    "start": "988319",
    "end": "993519"
  },
  {
    "text": "a lot more traces depending on how good your capture is what type of Hardware you're attacking in this case I know I",
    "start": "993519",
    "end": "999839"
  },
  {
    "text": "don't need very many I'm only going to use about 40 um and I hit attack so it just takes",
    "start": "999839",
    "end": "1009160"
  },
  {
    "text": "a second to analyze it so again this is done with pre- captured traces that you",
    "start": "1009160",
    "end": "1014440"
  },
  {
    "text": "have so if you want to experiment a bit you can easily do it without needing Hardware",
    "start": "1014440",
    "end": "1019480"
  },
  {
    "text": "anything um so what this is showing at the bottom I can",
    "start": "1019480",
    "end": "1025240"
  },
  {
    "text": "oops it's fairly slow to redraw oh",
    "start": "1025559",
    "end": "1032438"
  },
  {
    "text": "no is this is showing you for bite zero this is the correlation between all",
    "start": "1032439",
    "end": "1039120"
  },
  {
    "text": "possible key guesses so it's plotting 256 possible key guesses and in red it's",
    "start": "1039120",
    "end": "1044798"
  },
  {
    "text": "highlighted the one that I know to be correct ahead of time um because I know it's this key is initially and what we",
    "start": "1044799",
    "end": "1050799"
  },
  {
    "text": "can see is that the red um Trace at one point all of a",
    "start": "1050799",
    "end": "1056440"
  },
  {
    "text": "sudden has much higher correlation so this is telling you right at this point in time this is where that operation",
    "start": "1056440",
    "end": "1064000"
  },
  {
    "text": "actually occurred so this is where the sbox lookup probably had occurred and",
    "start": "1064000",
    "end": "1069600"
  },
  {
    "text": "because it's software you may actually see it happen a few times because perhaps this is a sub routine um the",
    "start": "1069600",
    "end": "1075640"
  },
  {
    "text": "sbox is being looked up here from memory and then later on it's passing that sbox output somewhere else or it's passing it",
    "start": "1075640",
    "end": "1082200"
  },
  {
    "text": "to one of the mixed column operations so that's why you may see",
    "start": "1082200",
    "end": "1087919"
  },
  {
    "text": "multiple um on the side here there's a table so this is just listing for each",
    "start": "1087919",
    "end": "1093320"
  },
  {
    "text": "of the 16 bytes for the AES",
    "start": "1093320",
    "end": "1099000"
  },
  {
    "text": "key see if I can pull this",
    "start": "1099000",
    "end": "1103200"
  },
  {
    "text": "over the screen resolution is a little limited here um so for each of the 16 key bytes it's",
    "start": "1104679",
    "end": "1112760"
  },
  {
    "text": "organized them by what is most likely the correct key and not so we can",
    "start": "1112760",
    "end": "1118159"
  },
  {
    "text": "actually see in the last case because I cut this um I basically cut the trace",
    "start": "1118159",
    "end": "1123840"
  },
  {
    "text": "down too short this last key it's failed to recover the correct key bite uh the correct",
    "start": "1123840",
    "end": "1130919"
  },
  {
    "text": "key is 3C so it thinks it's 19 which is wrong but all the rest of them are right",
    "start": "1130919",
    "end": "1136440"
  },
  {
    "text": "so it thinks it's 4f which is right CF ET um so that's just a very simple",
    "start": "1136440",
    "end": "1141919"
  },
  {
    "text": "correlation power analysis and all down this column is the",
    "start": "1141919",
    "end": "1147000"
  },
  {
    "text": "256 possibilities that the key could be again organized by the highest",
    "start": "1147000",
    "end": "1153880"
  },
  {
    "text": "correlation to the lowest all",
    "start": "1153880",
    "end": "1159360"
  },
  {
    "text": "right so to do this we obviously need to measure the power we need to acquire",
    "start": "1161880",
    "end": "1167600"
  },
  {
    "text": "those traces IAL talked about magically so normally it might look something like this this is using a hardware board",
    "start": "1167600",
    "end": "1175039"
  },
  {
    "text": "called the cebo project which is the standard evaluation board and it's used in quite a few research papers it has a",
    "start": "1175039",
    "end": "1183000"
  },
  {
    "text": "resistive shunt so you can measure the power across a resistor being used by the fpga and you just plug that into your",
    "start": "1183000",
    "end": "1190120"
  },
  {
    "text": "scope it has a trigger pin um so what this trigger is doing and I'm doing the",
    "start": "1190120",
    "end": "1195679"
  },
  {
    "text": "same sort of hack here is this trigger tells you specifically when about the AES is occurring you might have noticed",
    "start": "1195679",
    "end": "1203360"
  },
  {
    "text": "in that plot I had you know I said well way over here in this uh window this is",
    "start": "1203360",
    "end": "1209360"
  },
  {
    "text": "where the actual operation is occurring I had to acquire a whole bunch of points because I didn't know where the",
    "start": "1209360",
    "end": "1215440"
  },
  {
    "text": "operation was going to occur in real life obviously systems don't tell you you know oh this pin goes high right",
    "start": "1215440",
    "end": "1222600"
  },
  {
    "text": "before encrypt data so you might have to use something like when I send the last request to the device I start a timer",
    "start": "1222600",
    "end": "1230000"
  },
  {
    "text": "and I know the as will occur at some point between then and the result so I'm just going to capture everything and run",
    "start": "1230000",
    "end": "1236799"
  },
  {
    "text": "an attack over that once you know where in that space it actually occurs you can sort of start to window it down to make",
    "start": "1236799",
    "end": "1243799"
  },
  {
    "text": "your life a bit easier and one question you might have you might say well is that really typical if you're in a university lab",
    "start": "1243799",
    "end": "1250400"
  },
  {
    "text": "and you have a $20,000 osilloscope you're just going to use the $220,000 osilloscope when you publish it and when",
    "start": "1250400",
    "end": "1257240"
  },
  {
    "text": "you look at a lot of work in this it's always a fairly expensive scope um it depends a lot on the hardware device",
    "start": "1257240",
    "end": "1263520"
  },
  {
    "text": "you're attacking but critically there are a number of papers showing that you do need this several Giga sample per",
    "start": "1263520",
    "end": "1270720"
  },
  {
    "text": "second rate to get good results when you're attacking Hardware devices there's just no way around it is",
    "start": "1270720",
    "end": "1278360"
  },
  {
    "text": "what sort of has been claimed before and something like this might be",
    "start": "1278360",
    "end": "1284039"
  },
  {
    "text": "shown where you have on the side what we call the partial guessing entropy",
    "start": "1284039",
    "end": "1289240"
  },
  {
    "text": "uh so this is how unsure you are of the result when it goes to zero you know perfectly what the result is on the",
    "start": "1289240",
    "end": "1296600"
  },
  {
    "text": "bottom this is how many traces it's taken me to get this result so if I only had to um use 20 traces I only need 20",
    "start": "1296600",
    "end": "1304960"
  },
  {
    "text": "measurements so I just got 20 encryptions from the device and I figured out the key obviously the lower",
    "start": "1304960",
    "end": "1310400"
  },
  {
    "text": "the better because real devices are going to limit you to how many times you can you know request the encryption",
    "start": "1310400",
    "end": "1316200"
  },
  {
    "text": "especially if you're getting it wrong you're just sending in garbage so this tra this line here is",
    "start": "1316200",
    "end": "1323440"
  },
  {
    "text": "with 500 megga sample per second scope and I'm attacking a very very crappy Target so something that should work you",
    "start": "1323440",
    "end": "1330000"
  },
  {
    "text": "know without needing an expensive Scope when I go up to 100 megga samples per second which is a fairly common sample",
    "start": "1330000",
    "end": "1336840"
  },
  {
    "text": "rate for low cost Scopes we can see we're now down out at about 80 traces",
    "start": "1336840",
    "end": "1342559"
  },
  {
    "text": "required as they go up it just continues to get worse so 50 Mega samples per second",
    "start": "1342559",
    "end": "1348880"
  },
  {
    "text": "and when I'm down to 25 megga samples per second it's working very very slowly it's going to take a long time to",
    "start": "1348880",
    "end": "1355480"
  },
  {
    "text": "recover the key but we can do better than that we don't need those expensive Scopes and",
    "start": "1355480",
    "end": "1361520"
  },
  {
    "text": "this is sort of the core part of my work is showing how can we get rid of that",
    "start": "1361520",
    "end": "1366919"
  },
  {
    "text": "one requirement for an expensive high-speed oscilloscope and the problem is that when we measure the power we really care",
    "start": "1366919",
    "end": "1373880"
  },
  {
    "text": "about the power on the clock Edge as it's switching and we have the clock of the device often if it's a digital",
    "start": "1373880",
    "end": "1380440"
  },
  {
    "text": "system so if you measure using this clock so rather than using the",
    "start": "1380440",
    "end": "1385919"
  },
  {
    "text": "oscilloscopes time base you use this clock to Define when the samples should occur you'll see your results are much",
    "start": "1385919",
    "end": "1392600"
  },
  {
    "text": "much better so this line here this blue line is measuring at about 7.4 Mega",
    "start": "1392600",
    "end": "1398400"
  },
  {
    "text": "samples per second at 7.4 Mega samples per second stuff's very cheap adcs are",
    "start": "1398400",
    "end": "1404320"
  },
  {
    "text": "very cheap to buy if you have to buy a 500 Mega sample second ADC not even",
    "start": "1404320",
    "end": "1409960"
  },
  {
    "text": "talking about buying a scope just the physical chip even that is expensive so by using synchronous",
    "start": "1409960",
    "end": "1416360"
  },
  {
    "text": "sampling you can greatly reduce your cost requirements and where this comes from",
    "start": "1416360",
    "end": "1424200"
  },
  {
    "text": "the sort of core part of this is this requirement to synchronize your power traces so these two graphs the top one",
    "start": "1424200",
    "end": "1432320"
  },
  {
    "text": "is sampling at 100 megga samples per second this is sampling a hardware AES",
    "start": "1432320",
    "end": "1438559"
  },
  {
    "text": "um system that has basically doesn't work below about 250 Mega samples per second you need the minimum speed of the",
    "start": "1438559",
    "end": "1445080"
  },
  {
    "text": "scope in B I'm sampling also at about that speed 96 megga samples um but I've",
    "start": "1445080",
    "end": "1453120"
  },
  {
    "text": "perfectly synchronized the clock to the device in both cases I have 10 traces overlaid so in a you can see that's",
    "start": "1453120",
    "end": "1459559"
  },
  {
    "text": "garbage effectively they're not lining up at all in B these 10 traces are",
    "start": "1459559",
    "end": "1464840"
  },
  {
    "text": "perfectly lining up and you can only barely see in a few spots where they",
    "start": "1464840",
    "end": "1470039"
  },
  {
    "text": "differ and again exact same Hardware running 10 operations on the same",
    "start": "1470039",
    "end": "1476840"
  },
  {
    "text": "data where this Jitter sort of comes from is that the scope is always sampling it has its own sample clock",
    "start": "1476840",
    "end": "1482880"
  },
  {
    "text": "running all the time when the device clock is going it will start the",
    "start": "1482880",
    "end": "1488200"
  },
  {
    "text": "encryption at some point say this clock Edge but the scope is not going to be able to sample it just cannot take a",
    "start": "1488200",
    "end": "1494600"
  },
  {
    "text": "sample until later when its own internal clock has gone",
    "start": "1494600",
    "end": "1500039"
  },
  {
    "text": "high but this isn't at all related to your device clock so later when you take another trace and again encryption",
    "start": "1500039",
    "end": "1507840"
  },
  {
    "text": "starts here it may have to wait a different distance before the next sample is taken so now you have this",
    "start": "1507840",
    "end": "1513279"
  },
  {
    "text": "sort of random Jitter the typical way they get around this is if you run this sample clock very fast then this",
    "start": "1513279",
    "end": "1521520"
  },
  {
    "text": "window becomes smaller um and that's the main reason the higher sample rate gives",
    "start": "1521520",
    "end": "1527880"
  },
  {
    "text": "you such better results is that it's sort of a hack to improve the synchronization so the question might be",
    "start": "1527880",
    "end": "1533919"
  },
  {
    "text": "if you do have a normal scope that you want to use um what can you do there's a",
    "start": "1533919",
    "end": "1539480"
  },
  {
    "text": "few things you can hack some of them to actually get at the sample clock which",
    "start": "1539480",
    "end": "1545159"
  },
  {
    "text": "depending how expensive your scope is you may not want to do because it could damage it greatly um many Scopes will",
    "start": "1545159",
    "end": "1552520"
  },
  {
    "text": "actually tell you even though this happens they can tell you what this time distance is with fairly high resolution",
    "start": "1552520",
    "end": "1559480"
  },
  {
    "text": "and you can do some tricks to upsample it do a bit of Shifting and down sample",
    "start": "1559480",
    "end": "1565399"
  },
  {
    "text": "it again it's not going to be as good because you are losing information by",
    "start": "1565399",
    "end": "1570600"
  },
  {
    "text": "doing this sampling at the wrong time information is just",
    "start": "1570600",
    "end": "1576000"
  },
  {
    "text": "gone um so you can try to do that or if you do have a high-speed scope sample at",
    "start": "1576000",
    "end": "1582039"
  },
  {
    "text": "the highest possible rate and you can actually down sample if you want to have less data to deal with um but you'll",
    "start": "1582039",
    "end": "1589159"
  },
  {
    "text": "help reduce this problem by sampling at the highest possible rate even if you don't store at that",
    "start": "1589159",
    "end": "1595279"
  },
  {
    "text": "rate so to sort of make life easier I've designed some open hard Open Source",
    "start": "1595279",
    "end": "1602679"
  },
  {
    "text": "Hardware um that can do this type of synchronous sampling and this is just showing that it's basically achieving",
    "start": "1602679",
    "end": "1609279"
  },
  {
    "text": "similar results I'm using a 2 Giga sample scope is reference attacking this Hardware platform um and it's achieving",
    "start": "1609279",
    "end": "1617440"
  },
  {
    "text": "very similar results result so This Global success rate is just saying did I recover the key or not averaged over a",
    "start": "1617440",
    "end": "1624399"
  },
  {
    "text": "long time so did I recover the key in 3,500 traces averaged over a long time",
    "start": "1624399",
    "end": "1630520"
  },
  {
    "text": "and you can see they're Crossing this point8 threshold so 80% of the time I was right around the same",
    "start": "1630520",
    "end": "1637720"
  },
  {
    "text": "point um so it schematically or block diagram is something like that you have",
    "start": "1638440",
    "end": "1644240"
  },
  {
    "text": "a bit of an amplifier you just have a high-speed ADC um fifo and an interface",
    "start": "1644240",
    "end": "1649919"
  },
  {
    "text": "to the computer this type of board if you have an fpga board you may actually",
    "start": "1649919",
    "end": "1655640"
  },
  {
    "text": "be able to get away with what you already have you may have an ADC on board the fpga board that you can",
    "start": "1655640",
    "end": "1663039"
  },
  {
    "text": "use um so what I've done is designed this high-speed ADC board um and I'm",
    "start": "1663039",
    "end": "1670640"
  },
  {
    "text": "showing it on this $80 Avnet fpga board on the bottom",
    "start": "1670640",
    "end": "1676039"
  },
  {
    "text": "here or there's a Zex a German firm that makes these other fpga boards that have",
    "start": "1676039",
    "end": "1682679"
  },
  {
    "text": "a slightly faster USB interface I also use and I have both of those versions",
    "start": "1682679",
    "end": "1688559"
  },
  {
    "text": "here if you want to sort of take a look at them and I actually am trying to build an adapter board right now you'll",
    "start": "1688559",
    "end": "1694600"
  },
  {
    "text": "notice you have to do all this wiring yourself and add some voltage Regulators at some point there'll be an open",
    "start": "1694600",
    "end": "1700320"
  },
  {
    "text": "Hardware adapter board that if you don't want to have to do all that wiring but it's not up",
    "start": "1700320",
    "end": "1705799"
  },
  {
    "text": "yet as I say if you already have an fpga depending how proficient you are you",
    "start": "1705799",
    "end": "1711320"
  },
  {
    "text": "might be able to just use it and get it working a lot of research Labs already have fpga boards so this is a great way",
    "start": "1711320",
    "end": "1717960"
  },
  {
    "text": "to get into the very cheap um side Channel analysis you just need some sort of analog front end be it what I've",
    "start": "1717960",
    "end": "1725720"
  },
  {
    "text": "designed or something else that you happen to",
    "start": "1725720",
    "end": "1729880"
  },
  {
    "text": "have additionally your scope might already have synchronous sampling some do it's",
    "start": "1730799",
    "end": "1737720"
  },
  {
    "text": "fairly rare um I know clever scope for example one of the USB oscilloscopes has",
    "start": "1737720",
    "end": "1743200"
  },
  {
    "text": "an option to add this external sample clock in some have an ability to synchronize to very specific frequencies",
    "start": "1743200",
    "end": "1749720"
  },
  {
    "text": "so you could sort of hack it together and as I said almost any other fpga or",
    "start": "1749720",
    "end": "1755080"
  },
  {
    "text": "ADC board will work so say you were interested in doing this one thing you might say is well I've seen people with",
    "start": "1755080",
    "end": "1761039"
  },
  {
    "text": "these smart cards I've one here and they have these cool attacks and they say oh I've attacked a smart card I'm the",
    "start": "1761039",
    "end": "1766760"
  },
  {
    "text": "greatest hacker in the world um and you can do that so you can get a",
    "start": "1766760",
    "end": "1772240"
  },
  {
    "text": "regular smart card reader like this and all I've done is I've added this resistor in the power line here you",
    "start": "1772240",
    "end": "1779919"
  },
  {
    "text": "can't see it because it's small surface mount resistor and I've pulled out the clock signal I've pulled out a",
    "start": "1779919",
    "end": "1786039"
  },
  {
    "text": "synchronization signal and I've pulled out the power measurement signal so then the smart code reader looks something",
    "start": "1786039",
    "end": "1791320"
  },
  {
    "text": "like that a little connector on the back and I then connect this to the the fpga",
    "start": "1791320",
    "end": "1799919"
  },
  {
    "text": "board so that I'm now measuring I have the clock input and power is being measured",
    "start": "1799919",
    "end": "1806279"
  },
  {
    "text": "there and you can sort of run your attack algorithms now if you're too cheap to buy a regular reader you might",
    "start": "1806279",
    "end": "1813000"
  },
  {
    "text": "be able to get away with building your own so there's not a whole lot involved in it um this will only work with very",
    "start": "1813000",
    "end": "1820600"
  },
  {
    "text": "specific smart cards again all the schematics or online or in the um white",
    "start": "1820600",
    "end": "1826279"
  },
  {
    "text": "paper and there's basically just a crystal oscillator here some additional connections to the io",
    "start": "1826279",
    "end": "1834519"
  },
  {
    "text": "pins but what you really have to understand with these smart cards in particular and it's very specific to",
    "start": "1835159",
    "end": "1841440"
  },
  {
    "text": "this either they call them fun cards or at mega cards is this is a regular",
    "start": "1841440",
    "end": "1846559"
  },
  {
    "text": "microcontroller there's no difference between this and that dip package",
    "start": "1846559",
    "end": "1852320"
  },
  {
    "text": "microcontroller it's a standard commodity microcontroller so you're not really attacking a smart card with",
    "start": "1852320",
    "end": "1858960"
  },
  {
    "text": "um it happens to be in a smart car form factor but that's the",
    "start": "1858960",
    "end": "1864120"
  },
  {
    "text": "only sort of similarity at shares if you can successfully attack that that means",
    "start": "1864120",
    "end": "1869840"
  },
  {
    "text": "nothing for attacking a regular smart card which has some protection against um these sort of",
    "start": "1869840",
    "end": "1877399"
  },
  {
    "text": "attacks so my suggestion if you are interested in doing this is to instead",
    "start": "1877399",
    "end": "1883440"
  },
  {
    "text": "don't buy one of those smart cards because they can be a little trickier to find and expens and you need that reader",
    "start": "1883440",
    "end": "1889600"
  },
  {
    "text": "is you just attack a AVR microcontroller like the type used in the Arduino and you can either build up",
    "start": "1889600",
    "end": "1895440"
  },
  {
    "text": "something on a breadboard like I have here um and we have a crystal we have a",
    "start": "1895440",
    "end": "1902399"
  },
  {
    "text": "shunt resistor under there and I'm measuring the power across the shunt I have the clock frequency coming out here",
    "start": "1902399",
    "end": "1909320"
  },
  {
    "text": "and I have a little USB to Art board to send and receive data and also for power in this case um",
    "start": "1909320",
    "end": "1916519"
  },
  {
    "text": "so you know very simple these might be Parts you already have hanging around somewhere in a",
    "start": "1916519",
    "end": "1921679"
  },
  {
    "text": "lab what I have here the same thing in a PCB version so I've just built something that won't fall apart on me um again say",
    "start": "1921679",
    "end": "1928600"
  },
  {
    "text": "we have this microcontroller here there's shunts under here Crystal oscillator and the USB",
    "start": "1928600",
    "end": "1936919"
  },
  {
    "text": "board so that's just some of the parts so again I'm using this AVR either Mega",
    "start": "1937000",
    "end": "1942080"
  },
  {
    "text": "8 or Mega 48 is the newer version um there is a note I should explain here",
    "start": "1942080",
    "end": "1948679"
  },
  {
    "text": "you'll see various versions of the microcontroller the 0ga 8 at Mega 48p",
    "start": "1948679",
    "end": "1956080"
  },
  {
    "text": "48a um one of the main differences is that atml has been using different",
    "start": "1956080",
    "end": "1961600"
  },
  {
    "text": "production environments which means different geometry on the actual silicon die the a is the latest version and",
    "start": "1961600",
    "end": "1968320"
  },
  {
    "text": "probably the only version you can now get from Digi key or other Distributors and it has a slightly smaller power",
    "start": "1968320",
    "end": "1974279"
  },
  {
    "text": "signature in my testing it doesn't really matter they all work just the same um so I wouldn't really care about it",
    "start": "1974279",
    "end": "1981360"
  },
  {
    "text": "and I happen to use a specific USB to you but you know there's tons of Manufacturers spark fun or um whoever",
    "start": "1981360",
    "end": "1987399"
  },
  {
    "text": "else makes these type of things as it you do need the capture Hardware here I'm showing this open ADC board I've",
    "start": "1987399",
    "end": "1994120"
  },
  {
    "text": "designed um but you can get away with general purpose Scopes if you're attacking this very simple board um you",
    "start": "1994120",
    "end": "2002000"
  },
  {
    "text": "can probably get away with something like a 100 megga sample type ey scope or similar",
    "start": "2002000",
    "end": "2008519"
  },
  {
    "text": "um so you can do some testing then the testing in this case I send it some data",
    "start": "2009760",
    "end": "2014799"
  },
  {
    "text": "check the encrypted response is right so this super simple board all it does is",
    "start": "2014799",
    "end": "2019960"
  },
  {
    "text": "you can send it a key you send it a plain text and it responds with the encrypted version so that's all it",
    "start": "2019960",
    "end": "2028120"
  },
  {
    "text": "does once you start looking into this you'll have to say how noisy is it how well is this going to work so one of the",
    "start": "2028440",
    "end": "2035240"
  },
  {
    "text": "first characterizations I do or us should do with these boards is I've connected the",
    "start": "2035240",
    "end": "2041679"
  },
  {
    "text": "probe just to the power in line from the",
    "start": "2041679",
    "end": "2047240"
  },
  {
    "text": "voltage regulator the voltage Supply I'm using what you don't want to see is this you don't want to see a bunch of noise",
    "start": "2047240",
    "end": "2053000"
  },
  {
    "text": "on it because that's going to give you trouble um so I've just through trial",
    "start": "2053000",
    "end": "2059520"
  },
  {
    "text": "and error added some various filtering components until I've got this nice flat",
    "start": "2059520",
    "end": "2065440"
  },
  {
    "text": "line um we then have this filtered power here I add a shunt resistor there so and",
    "start": "2065440",
    "end": "2071760"
  },
  {
    "text": "we're going to measure the power on the other side of it because this is a sort of solid reference and we measure the",
    "start": "2071760",
    "end": "2077638"
  },
  {
    "text": "power consumption there you can sort of test if you send it the same data a bunch of times and",
    "start": "2077639",
    "end": "2084200"
  },
  {
    "text": "you use a persistence mode in any scope it doesn't have to be this you should see the same results so you should see",
    "start": "2084200",
    "end": "2090118"
  },
  {
    "text": "this repeatable results um if you don't then something else is wrong be it the",
    "start": "2090119",
    "end": "2095960"
  },
  {
    "text": "synchronization is bad have too much noise in the power supply or noises coming in somewhere",
    "start": "2095960",
    "end": "2101599"
  },
  {
    "text": "else and then you can just acquire a whole bunch of traces once you have them acquired you",
    "start": "2101599",
    "end": "2107839"
  },
  {
    "text": "can run that same uh attack program I showed you earlier and try to break it",
    "start": "2107839",
    "end": "2113960"
  },
  {
    "text": "so let me show you a capture example",
    "start": "2113960",
    "end": "2118240"
  },
  {
    "text": "here so everything's sort of real time so there's always a good chance that it won't work I apologize if it does",
    "start": "2120880",
    "end": "2127720"
  },
  {
    "text": "doesn't but let's hope for the best so this is the capture application um I",
    "start": "2127720",
    "end": "2132920"
  },
  {
    "text": "select the type of oscilloscope I'm using and I have this higher speed version",
    "start": "2132920",
    "end": "2139640"
  },
  {
    "text": "connected and I just connect to my simple serial device so I can first check that it's working so it just sends",
    "start": "2139640",
    "end": "2146920"
  },
  {
    "text": "it some data gets the response and locally this program comp computat what",
    "start": "2146920",
    "end": "2153000"
  },
  {
    "text": "it would expect the response to be and prints it doesn't actually check anything it's just just prints it for",
    "start": "2153000",
    "end": "2158240"
  },
  {
    "text": "you to look at um here we have a the trace",
    "start": "2158240",
    "end": "2163520"
  },
  {
    "text": "so doesn't look like a whole lot yet but let's see if we can get a little",
    "start": "2163520",
    "end": "2169119"
  },
  {
    "text": "better here I'm just going to reset",
    "start": "2169119",
    "end": "2173760"
  },
  {
    "text": "this so what we can do is we can increase the gain in this spot here so as I increase this um it's increasing",
    "start": "2179040",
    "end": "2186480"
  },
  {
    "text": "the amplification in the fr end so this is auto scaling you can see",
    "start": "2186480",
    "end": "2191920"
  },
  {
    "text": "a little bit here so these numbers are getting bigger",
    "start": "2191920",
    "end": "2198440"
  },
  {
    "text": "so we're starting to see some of this um sort of repetitive nature that we had",
    "start": "2198440",
    "end": "2205960"
  },
  {
    "text": "expected to see earlier I'm finally going to switch to an external clock",
    "start": "2205960",
    "end": "2212480"
  },
  {
    "text": "and if it doesn't work I just have to replug it here",
    "start": "2212480",
    "end": "2217800"
  },
  {
    "text": "so this is the part that is liable to",
    "start": "2217800",
    "end": "2224400"
  },
  {
    "text": "fail let's try",
    "start": "2226359",
    "end": "2230039"
  },
  {
    "text": "this just",
    "start": "2232119",
    "end": "2235359"
  },
  {
    "text": "restart so as I say because it's all real there's always a good chance of this failure but here it's working um so",
    "start": "2246160",
    "end": "2253160"
  },
  {
    "text": "let me pull this back up for you",
    "start": "2253160",
    "end": "2257318"
  },
  {
    "text": "oops increase the gain and you can sort of start to see",
    "start": "2258960",
    "end": "2264680"
  },
  {
    "text": "some signature there so I'm going to set the trigger mode so the trigger is what I said before I have a pin that goes",
    "start": "2264680",
    "end": "2271240"
  },
  {
    "text": "high right before the encryption happen so I always want to synchronize to that Rising Edge um and I'll reduce how much data",
    "start": "2271240",
    "end": "2278880"
  },
  {
    "text": "you have on screen here so this is starting to look a",
    "start": "2278880",
    "end": "2284520"
  },
  {
    "text": "little like what I showed before so this is sort of a repetitive um",
    "start": "2284520",
    "end": "2290200"
  },
  {
    "text": "system so we can see that as I'm sending different data it's changing a little bit and now all I'm going to do is",
    "start": "2290200",
    "end": "2296960"
  },
  {
    "text": "capture a bunch of traces so say I want 100 traces and just hit start",
    "start": "2296960",
    "end": "2303800"
  },
  {
    "text": "capture um sometimes you have to try it a few times or it crashes the the USB cables I",
    "start": "2303800",
    "end": "2311319"
  },
  {
    "text": "brought have broken in my bag a bit so it's giving me some issues",
    "start": "2311319",
    "end": "2316560"
  },
  {
    "text": "here so I'm just going to use the",
    "start": "2316560",
    "end": "2320640"
  },
  {
    "text": "pre-turbo board the digital fpga boards here and this is the target system uh as",
    "start": "2328280",
    "end": "2335440"
  },
  {
    "text": "an alternative so this was The Other Board I showed this is the lx9 so the fpga part is this board and the analog",
    "start": "2335440",
    "end": "2344520"
  },
  {
    "text": "board is just plugging on top uh if you come up after when I have more time I'll",
    "start": "2344520",
    "end": "2349680"
  },
  {
    "text": "show you this running as well with the smart card I don't want to waste time fixing that right",
    "start": "2349680",
    "end": "2355839"
  },
  {
    "text": "now so some other stuff you'll see when you look into literature is these magnetic field probes as well where you",
    "start": "2355839",
    "end": "2362560"
  },
  {
    "text": "use these is that when you're attacking a system I had insert this shunt",
    "start": "2362560",
    "end": "2368240"
  },
  {
    "text": "physically in the line so physically I put this resistor you know I opened up",
    "start": "2368240",
    "end": "2374240"
  },
  {
    "text": "the device put this resistor right in there you might not want to do that um it might not even be possible if it's a",
    "start": "2374240",
    "end": "2381119"
  },
  {
    "text": "fairly recent device so they use these magnetic field probes any current will create a magnetic field you can use a",
    "start": "2381119",
    "end": "2387200"
  },
  {
    "text": "small Probe on the device to actually see the power it's using without even opening it possibly but when you start",
    "start": "2387200",
    "end": "2394119"
  },
  {
    "text": "to look at them and look at ones other people are using you know you start to prices like $2,000 and just doesn't seem",
    "start": "2394119",
    "end": "2400680"
  },
  {
    "text": "very nice but what you have to realize is that most of these probes are nothing",
    "start": "2400680",
    "end": "2407880"
  },
  {
    "text": "more than something like a piece of semi- rigid uh cable looped around",
    "start": "2407880",
    "end": "2413680"
  },
  {
    "text": "soldered to itself with a bit of a slot to actually pick up the field so you can",
    "start": "2413680",
    "end": "2418839"
  },
  {
    "text": "do this for like $3 if you buy one of these cables off eBay nothing if you have a lab and you stole it from that",
    "start": "2418839",
    "end": "2425440"
  },
  {
    "text": "lab or something um either either way and this works quite well I've sort of had some demos of showing this and it",
    "start": "2425440",
    "end": "2433000"
  },
  {
    "text": "achieves pretty much similar results to you'd expect uh there's a few good",
    "start": "2433000",
    "end": "2438079"
  },
  {
    "text": "papers of a guy actually you know making a whole bunch of these he's using them for a different purpose but it's the",
    "start": "2438079",
    "end": "2444160"
  },
  {
    "text": "exact same thing and there's even someone who's done a thesis on how these magnetic field probes making a own and",
    "start": "2444160",
    "end": "2452240"
  },
  {
    "text": "testing them for different sort of characteristics so there's a lot of great DIY reference",
    "start": "2452240",
    "end": "2458400"
  },
  {
    "text": "and this is again a little cooler because you can do this without having to physically modify a real device so",
    "start": "2458400",
    "end": "2463920"
  },
  {
    "text": "when you're attacking something that isn't just a board you're making you may want to use an em probe",
    "start": "2463920",
    "end": "2470800"
  },
  {
    "text": "instead part of this probe you'll notice they have this preamplifier um and these pre-amplifiers",
    "start": "2470800",
    "end": "2477640"
  },
  {
    "text": "are also very expensive they tend to look suspiciously like some of these",
    "start": "2477640",
    "end": "2482880"
  },
  {
    "text": "commercial ones that are only $90 but with a different label on them and then $400 they're costing so as you",
    "start": "2482880",
    "end": "2491319"
  },
  {
    "text": "can guess you can in fact just use these amplifiers instead",
    "start": "2491319",
    "end": "2496680"
  },
  {
    "text": "but and they give you somewhere around this the gain could vary from about 20",
    "start": "2496680",
    "end": "2501960"
  },
  {
    "text": "DB to 24 DB um but that's not cheap enough",
    "start": "2501960",
    "end": "2507359"
  },
  {
    "text": "because you can just make one you can get these ic's from digii which are about 60 cents in single unit quantity",
    "start": "2507359",
    "end": "2515119"
  },
  {
    "text": "and this is a gain of around 20 DB and it just needs a 3.3 volt power",
    "start": "2515119",
    "end": "2521640"
  },
  {
    "text": "supply few capacitors DC block capacitors um and you can build",
    "start": "2521640",
    "end": "2528079"
  },
  {
    "text": "something like that so you remember that graph I showed before of this 20 DB gain 20 DB is about",
    "start": "2528079",
    "end": "2536800"
  },
  {
    "text": "100 times by the way in a linear scale um so from 80 to 400 plus megahertz I'm",
    "start": "2536800",
    "end": "2542680"
  },
  {
    "text": "getting that sort of performance at lower frequency it gives you a little less gain about 40 times gain but either",
    "start": "2542680",
    "end": "2550760"
  },
  {
    "text": "one of these or two of them chained together still works well enough for the cheap skate side Channel stuff we're",
    "start": "2550760",
    "end": "2555960"
  },
  {
    "text": "doing it's far from perfect don't show these slides to an irf guy because they will not be impressed with me and this",
    "start": "2555960",
    "end": "2563040"
  },
  {
    "text": "uh particularly this one um there is also an open Hardware",
    "start": "2563040",
    "end": "2568960"
  },
  {
    "text": "PCB layout design too so if you want something a little nicer one other thing",
    "start": "2568960",
    "end": "2575000"
  },
  {
    "text": "you're going to frequently see is a differential probe so the theory behind",
    "start": "2575000",
    "end": "2580720"
  },
  {
    "text": "this is that we have some common mode voltage so some voltage is coming in",
    "start": "2580720",
    "end": "2585920"
  },
  {
    "text": "here and we're trying to measure the current across this resistor uh ohms law is where you know",
    "start": "2585920",
    "end": "2593880"
  },
  {
    "text": "all this comes from so for example say we were trying to measure 0.2 milliamps the shent was 75 ohms we'd expect about",
    "start": "2593880",
    "end": "2600920"
  },
  {
    "text": "15 molts across that resistor uh the problem is that if you had 30 molts of",
    "start": "2600920",
    "end": "2607200"
  },
  {
    "text": "noise which isn't that much you've basically totally obliterated your signal um and",
    "start": "2607200",
    "end": "2614480"
  },
  {
    "text": "this common mode noise for example came from a regulator in the system I was using so using a differential probe the",
    "start": "2614480",
    "end": "2622040"
  },
  {
    "text": "idea is that this common mode voltage will to some degree appear on both sides",
    "start": "2622040",
    "end": "2628520"
  },
  {
    "text": "and be eliminated by looking differentially I have to warn you it's not quite perfect in this setup because",
    "start": "2628520",
    "end": "2636040"
  },
  {
    "text": "the common mold uh voltage is not evenly applied to both sides on one side it goes through the",
    "start": "2636040",
    "end": "2641800"
  },
  {
    "text": "resistor and is slightly reduced but this type of differential proe still gives you a much much better signal um",
    "start": "2641800",
    "end": "2648839"
  },
  {
    "text": "than just a straight connection alone although all the demos I have here are just straight connections so looking at",
    "start": "2648839",
    "end": "2655960"
  },
  {
    "text": "this is a paper side Channel analysis of avrx Mega and you might notice this guy",
    "start": "2655960",
    "end": "2662079"
  },
  {
    "text": "is using a differential Probe on this system so again the point is say you are",
    "start": "2662079",
    "end": "2667520"
  },
  {
    "text": "interested in this you say I want to do this I want to duplicate these results well what's that differential",
    "start": "2667520",
    "end": "2672920"
  },
  {
    "text": "probe he's using I want to get something similar and you look it up on Mouser and that probe just the probe is four and a",
    "start": "2672920",
    "end": "2682800"
  },
  {
    "text": "half yeah $4,500 so you know that's not that cheap",
    "start": "2682800",
    "end": "2688400"
  },
  {
    "text": "but that's good up to 1,000 mahz so you can get A2 MHz version of it that's only",
    "start": "2688400",
    "end": "2694040"
  },
  {
    "text": "$1,700 these are Canadian so a, something around there um still not that",
    "start": "2694040",
    "end": "2701760"
  },
  {
    "text": "cheap what about eBay used you know here's a used probe and it's still $1,000",
    "start": "2701760",
    "end": "2707760"
  },
  {
    "text": "us again this isn't good this is not cheap so how cheap are you again you can",
    "start": "2707760",
    "end": "2714520"
  },
  {
    "text": "buy an IC that does most of what you need which is around $4.60 I believe in single unit quantity",
    "start": "2714520",
    "end": "2722000"
  },
  {
    "text": "uh you need a few resistors and capacitors and supporting components and hey you get a pretty good differential",
    "start": "2722000",
    "end": "2730200"
  },
  {
    "text": "probe there's a layout for an actual circuit board as well as the schematic",
    "start": "2730359",
    "end": "2735760"
  },
  {
    "text": "uh in the white paper on online so here's a few photos of some",
    "start": "2735760",
    "end": "2741640"
  },
  {
    "text": "extra things that didn't quite fit in um if you start to look into this you'll",
    "start": "2741640",
    "end": "2747559"
  },
  {
    "text": "see a few different uh useful boards in this area there's a company Sakura that",
    "start": "2747559",
    "end": "2753440"
  },
  {
    "text": "makes the sasbo CBO G2 I showed earlier the cebo W uh this is not a cheap",
    "start": "2753440",
    "end": "2759720"
  },
  {
    "text": "skateboard I warn you though it's like $1,500 or something um but you can use",
    "start": "2759720",
    "end": "2764960"
  },
  {
    "text": "that ADC platform I was showing you earlier uh plug it right onto the board it has a reader for smart cards it has",
    "start": "2764960",
    "end": "2771240"
  },
  {
    "text": "quite a large fpga for doing your own processing so you can do some cool stuff like say you wanted to do the attack in",
    "start": "2771240",
    "end": "2777839"
  },
  {
    "text": "real time you put the card in you're doing the attack in Hardware um this board is a good tool for",
    "start": "2777839",
    "end": "2784960"
  },
  {
    "text": "that some of the targets that I don't have with me that you'll find reference to uh the X mega so avrx Mega is another",
    "start": "2784960",
    "end": "2793599"
  },
  {
    "text": "microcontroller this is interesting it has a hardware AES engine and in the",
    "start": "2793599",
    "end": "2799520"
  },
  {
    "text": "previous paper I mentioned um this is actually what he's attacking he's attacking the hardware AES or I believe",
    "start": "2799520",
    "end": "2806960"
  },
  {
    "text": "dees2 engine uh you can even use an Arduino as",
    "start": "2806960",
    "end": "2813960"
  },
  {
    "text": "a Target it is an AVR it's almost the same AVR I'm showing here and I've sort",
    "start": "2813960",
    "end": "2819480"
  },
  {
    "text": "of hacked together a dip socket with a resistor in one of the power lines and",
    "start": "2819480",
    "end": "2825920"
  },
  {
    "text": "then that resistor you connect up to your scope um so that's a sort of very",
    "start": "2825920",
    "end": "2832559"
  },
  {
    "text": "lowcost type Target another interesting thing that's not working right now but",
    "start": "2832559",
    "end": "2838520"
  },
  {
    "text": "at some point may this is getting even cheaper this is a um X mega is a another",
    "start": "2838520",
    "end": "2845559"
  },
  {
    "text": "AV microcontroller this has a 2 megga sample per second ADC built into it as well as",
    "start": "2845559",
    "end": "2852040"
  },
  {
    "text": "USB so if you use this and can get it to synchronize properly with your target",
    "start": "2852040",
    "end": "2857480"
  },
  {
    "text": "you may be able to actually um do an attack not on a real device I would say",
    "start": "2857480",
    "end": "2862800"
  },
  {
    "text": "but you can do an attack for learning purposes to test some of your own algorithms for $30 Hardware complete",
    "start": "2862800",
    "end": "2869000"
  },
  {
    "text": "with everything I also wanted to show you so what can you some of these power",
    "start": "2869000",
    "end": "2875160"
  },
  {
    "text": "analysis results look like a little so this is showing this AVR Target running different",
    "start": "2875160",
    "end": "2881680"
  },
  {
    "text": "software and all three of these versions of software are in the git or in the zip",
    "start": "2881680",
    "end": "2886800"
  },
  {
    "text": "you can download so there's what I call straightforward C which is if you just wrote AES looking at the Wikipedia page",
    "start": "2886800",
    "end": "2894440"
  },
  {
    "text": "or something um you'd end up with something like that this is what most of",
    "start": "2894440",
    "end": "2899520"
  },
  {
    "text": "the attacks I'm demoing are done with is AVR Crypt which is a fairly popular open- Source library for the AVR and",
    "start": "2899520",
    "end": "2906960"
  },
  {
    "text": "similar microcontrollers um written in C which takes longer and there's also an ASM",
    "start": "2906960",
    "end": "2913200"
  },
  {
    "text": "version so you can see the entire crypto is done long before you can't really tell from this but this is only the",
    "start": "2913200",
    "end": "2919440"
  },
  {
    "text": "first few rounds of AES whereas the ASM version is entirely done um in that same",
    "start": "2919440",
    "end": "2925520"
  },
  {
    "text": "time frame so this gives you some sort of different attacks you can work with if you're using the ASM one for example",
    "start": "2925520",
    "end": "2931839"
  },
  {
    "text": "you'll find the attacks are not going to be as successful or you need more traces",
    "start": "2931839",
    "end": "2936960"
  },
  {
    "text": "um because it's so condensed and this is with the S X mega",
    "start": "2936960",
    "end": "2943119"
  },
  {
    "text": "Hardware I showed you uh so there's again you can just compile that same library for it or you can even use the",
    "start": "2943119",
    "end": "2949240"
  },
  {
    "text": "hardware AES with Hardware AES you notice it's done very quickly because it's all done in",
    "start": "2949240",
    "end": "2956079"
  },
  {
    "text": "Hardware so I've sort of tried to Ram through as much as I could so you had a",
    "start": "2956079",
    "end": "2962240"
  },
  {
    "text": "overview of everything I could think of what do you do now if you really are interested in this well the white paper",
    "start": "2962240",
    "end": "2971440"
  },
  {
    "text": "for this uh conference has a lot more details of some of the stuff I glossed over and this chip Whisperer chip",
    "start": "2971440",
    "end": "2979240"
  },
  {
    "text": "whisper.com also is a Wiki with additional details there's a mailing list critically so if you want to ask me",
    "start": "2979240",
    "end": "2985359"
  },
  {
    "text": "questions because not everything is on the wiki yet um send an email to that and I'll respond rather than just",
    "start": "2985359",
    "end": "2991920"
  },
  {
    "text": "sending an email to me and there's also a book called Power analysis attack revealing the secrets of smart cards and",
    "start": "2991920",
    "end": "2998480"
  },
  {
    "text": "this goes over in a lot more detail um all of the attacks and some of the countermeasures and a whole lot of stuff",
    "start": "2998480",
    "end": "3005119"
  },
  {
    "text": "I just didn't remotely have time to cover the original paper DPA paper by",
    "start": "3005119",
    "end": "3011319"
  },
  {
    "text": "Paul coacher um is also quite interesting I find a lot of people don't tend to go to the sources sometimes and",
    "start": "3011319",
    "end": "3017359"
  },
  {
    "text": "read them it's quite easy to read so I highly recommend that and there's a lot of interesting proceedings too if you",
    "start": "3017359",
    "end": "3023480"
  },
  {
    "text": "want to sort of find out some of the more recent ADV es in this field a hint um as a lot of these type of things may",
    "start": "3023480",
    "end": "3031040"
  },
  {
    "text": "be behind pay walls if you have any local University they often have access to them and you can just go to their",
    "start": "3031040",
    "end": "3036839"
  },
  {
    "text": "library and read them from there um so I'll show a demo of the final that",
    "start": "3036839",
    "end": "3045720"
  },
  {
    "text": "thing working game but before I do that are there questions",
    "start": "3045720",
    "end": "3050480"
  },
  {
    "text": "or yep",
    "start": "3051720",
    "end": "3055720"
  },
  {
    "text": "okay so the question was if there's chips that have asymmetric crypto to look at them I don't actually know I've",
    "start": "3061400",
    "end": "3068680"
  },
  {
    "text": "only really focused on symmetric to be honest um I know for example the X mega only has symmetric",
    "start": "3068680",
    "end": "3076000"
  },
  {
    "text": "cryptography uh in Hardware you may have to go to actual smart carard devices to get that um I know atmail makes a few",
    "start": "3076000",
    "end": "3083920"
  },
  {
    "text": "security chips so they're not smart card chips but like small three pen devices that I",
    "start": "3083920",
    "end": "3089559"
  },
  {
    "text": "believe I'd have to check yeah might be RSA um there some of them are harder to",
    "start": "3089559",
    "end": "3095680"
  },
  {
    "text": "get though I know like even the not the smart card ones but the small uh three pin devices you need to have an NDA",
    "start": "3095680",
    "end": "3102599"
  },
  {
    "text": "signed to even get the um to get the development kit so that's not going to",
    "start": "3102599",
    "end": "3107839"
  },
  {
    "text": "be useful there is a number of java cards you can buy um so these are real",
    "start": "3107839",
    "end": "3113200"
  },
  {
    "text": "smart card targets but they do have some support of of asymmetric crypto and you",
    "start": "3113200",
    "end": "3119760"
  },
  {
    "text": "can sort of get started on them a lot easier um other",
    "start": "3119760",
    "end": "3126760"
  },
  {
    "text": "questions no all right well um thanks everyone for coming maybe if you want to",
    "start": "3129000",
    "end": "3136119"
  },
  {
    "text": "go to lunch you can leave now otherwise I will try to get this uh demo working",
    "start": "3136119",
    "end": "3141200"
  },
  {
    "text": "again here so give me a few minutes but it's up to you",
    "start": "3141200",
    "end": "3147760"
  },
  {
    "text": "so",
    "start": "3150359",
    "end": "3153359"
  },
  {
    "text": "all right so this is what the capture looks like running oh and it's done already",
    "start": "3203400",
    "end": "3210559"
  },
  {
    "text": "um oh yeah there's some issue with the USB as I say this cable I brought with",
    "start": "3210559",
    "end": "3215599"
  },
  {
    "text": "me is very uh flaky unfortunately",
    "start": "3215599",
    "end": "3221760"
  },
  {
    "text": "so you can see the number of traces going up quickly and yeah it crashes again um I may have to unplug the webcam",
    "start": "3250720",
    "end": "3258799"
  },
  {
    "text": "what kind of cable is it uh USB mini not micro mini if do you have one y okay",
    "start": "3258799",
    "end": "3269520"
  },
  {
    "text": "excellent uh yeah one even closer thank you maybody should have one",
    "start": "3269520",
    "end": "3278480"
  },
  {
    "text": "[Music] one try this",
    "start": "3285710",
    "end": "3291440"
  },
  {
    "text": "here for",
    "start": "3295319",
    "end": "3299359"
  },
  {
    "text": "so we'll try another 100 traces I can't show you it running um hope it doesn't crash no yeah there's",
    "start": "3327640",
    "end": "3335599"
  },
  {
    "text": "still some issue there with I don't know anyway assuming that worked assuming you would then run the",
    "start": "3335599",
    "end": "3343839"
  },
  {
    "text": "um that analyzer software I showed you so I have a version of",
    "start": "3343839",
    "end": "3350680"
  },
  {
    "text": "it there",
    "start": "3351480",
    "end": "3355480"
  },
  {
    "text": "um so before I had loaded a new project here I would just create a sample project somewhere",
    "start": "3356920",
    "end": "3364440"
  },
  {
    "text": "so save that somewhere and I could import those traces that I had just",
    "start": "3365200",
    "end": "3371119"
  },
  {
    "text": "run um again the black hat zip or CD actually has a version of just the",
    "start": "3371119",
    "end": "3378240"
  },
  {
    "text": "capture not the imported one so you can test this without without needing to um have run",
    "start": "3378240",
    "end": "3385799"
  },
  {
    "text": "that so will tell you how many traces you done run import I can enable them",
    "start": "3385799",
    "end": "3391280"
  },
  {
    "text": "and save the project and I'm just going to reopen",
    "start": "3391280",
    "end": "3396559"
  },
  {
    "text": "this and open that project so there is the traces again um you can see",
    "start": "3402119",
    "end": "3407440"
  },
  {
    "text": "basically the same thing that was coming up on the screen before and if you want to look you can",
    "start": "3407440",
    "end": "3413720"
  },
  {
    "text": "see how many traces um sort of can overlay and again you can run that exact same analysis I",
    "start": "3413720",
    "end": "3420000"
  },
  {
    "text": "showed you",
    "start": "3420000",
    "end": "3422480"
  },
  {
    "text": "before so in the exact same way it's running that same sort of um correlation",
    "start": "3425240",
    "end": "3430400"
  },
  {
    "text": "power analysis program and trying to recover each of the key bites in",
    "start": "3430400",
    "end": "3436200"
  },
  {
    "text": "sequence it gives you that same table I showed before and this sort of result output so we can",
    "start": "3436200",
    "end": "3443880"
  },
  {
    "text": "see oh the red process is a little slow",
    "start": "3443880",
    "end": "3449480"
  },
  {
    "text": "too we go um so again we can see because it's all the same hardware and same",
    "start": "3450920",
    "end": "3457160"
  },
  {
    "text": "setup uh we see the SE same type of Trace I showed you before maybe it looks a tiny bit different um and we can zoom",
    "start": "3457160",
    "end": "3464799"
  },
  {
    "text": "in and look at a few points that it was doing this operation on the sbox um",
    "start": "3464799",
    "end": "3473799"
  },
  {
    "text": "so that's a very brief overview to Super sheep power analysis feel free to come up and I'll try to set up the other",
    "start": "3473799",
    "end": "3480559"
  },
  {
    "text": "smart card reader I have here quickly uh I think I'm well out of time for uh two",
    "start": "3480559",
    "end": "3487760"
  },
  {
    "text": "minutes it takes longer than two minutes so thanks for coming everyone hope you enjoyed the presentation",
    "start": "3487760",
    "end": "3495160"
  },
  {
    "text": "[Applause]",
    "start": "3497210",
    "end": "3499828"
  }
]