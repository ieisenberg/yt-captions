[
  {
    "text": "some people would refer to us as hecker group um so um I'm going to talk about",
    "start": "52879",
    "end": "59120"
  },
  {
    "text": "attacking network embedded systems which basically does not cover mobile phones",
    "start": "59120",
    "end": "64920"
  },
  {
    "text": "yet we're talking about today pretty much like design failures and software",
    "start": "64920",
    "end": "71760"
  },
  {
    "text": "vulnerabilities and embedded systems got an example for the two major things here",
    "start": "71760",
    "end": "77920"
  },
  {
    "text": "um design failures um we have like examples for different design failures",
    "start": "77920",
    "end": "84240"
  },
  {
    "text": "that showed up doing research in um embedded system technology and how to",
    "start": "84240",
    "end": "90560"
  },
  {
    "text": "exploit one and we're basically covering the same thing for software vulnerabilities um well-known things",
    "start": "90560",
    "end": "97759"
  },
  {
    "text": "like buffer overflows and stuff and I think we just go on here so what's an",
    "start": "97759",
    "end": "103520"
  },
  {
    "text": "embedded system for the purpose of this talk um an embedded system is a small",
    "start": "103520",
    "end": "110119"
  },
  {
    "text": "computer kind of like has a CPU has some memory",
    "start": "110119",
    "end": "115159"
  },
  {
    "text": "um maybe has some storage disk space kind of thing and of course it has a",
    "start": "115159",
    "end": "122640"
  },
  {
    "text": "network interface so this is pretty much all you need to have a device that you",
    "start": "122640",
    "end": "128640"
  },
  {
    "text": "can possibly attack and play with um it mostly has a custom operating",
    "start": "128640",
    "end": "135239"
  },
  {
    "text": "system and this custom operating system is designed to do specific tasks in",
    "start": "135239",
    "end": "142239"
  },
  {
    "text": "contrast to um commonly used operating systems like Windows the embedded",
    "start": "142239",
    "end": "148840"
  },
  {
    "text": "systems most often have something really specific and monolithic of design",
    "start": "148840",
    "end": "157040"
  },
  {
    "text": "there is mostly no or very limited way to update stuff um to manage it to patch",
    "start": "157040",
    "end": "165519"
  },
  {
    "text": "it like if you think of embedded systems let's say in your 7 series BMW it's it's",
    "start": "165519",
    "end": "173440"
  },
  {
    "text": "actually said to be based on Windows C but I don't really know that um but you",
    "start": "173440",
    "end": "178640"
  },
  {
    "text": "can't really buy a CD for your BMW go to the car and like update it which would",
    "start": "178640",
    "end": "184640"
  },
  {
    "text": "have been kind of cool because those embedded systems had serious bugs like the BMW stopped running when it had like",
    "start": "184640",
    "end": "191120"
  },
  {
    "text": "gas for still 120 kilometers the B computing system kind of thought it's",
    "start": "191120",
    "end": "196159"
  },
  {
    "text": "empty and so stopped working um and the biggest problem we have in",
    "start": "196159",
    "end": "201840"
  },
  {
    "text": "embedded systems is there is no separation um of the tasks there is no",
    "start": "201840",
    "end": "209200"
  },
  {
    "text": "access levels inside the operating system which basically means you execute one bite you got the",
    "start": "209200",
    "end": "215879"
  },
  {
    "text": "thing there is no internal borders like um running under different user accounts",
    "start": "215879",
    "end": "223360"
  },
  {
    "text": "memory protection stuff like that it's not there talking about design failures what are",
    "start": "223360",
    "end": "229840"
  },
  {
    "text": "design failures i mean undocumented functionality is one of the biggest things for embedded systems we got",
    "start": "229840",
    "end": "237519"
  },
  {
    "text": "things like developer backdoors everyone remembers developer backd doors and embedded systems i mean",
    "start": "237519",
    "end": "245120"
  },
  {
    "text": "people put it in just to get debugging output or might access it if the Talnet",
    "start": "245120",
    "end": "251840"
  },
  {
    "text": "interface just died and well they just kind of keep it in there don't document",
    "start": "251840",
    "end": "257840"
  },
  {
    "text": "it nobody's going to find out right um next big thing out of something features",
    "start": "257840",
    "end": "264560"
  },
  {
    "text": "out of everything especially if you think of small routers home devices DSL",
    "start": "264560",
    "end": "270960"
  },
  {
    "text": "routers stuff like that when you take them out of the box and you're like \"John though I have no",
    "start": "270960",
    "end": "277880"
  },
  {
    "text": "idea about TCP IP guy.\" You take it out of the box connect it to the network",
    "start": "277880",
    "end": "284639"
  },
  {
    "text": "actually manage to not put Ethernet on the ISDN port and get the software CD",
    "start": "284639",
    "end": "290639"
  },
  {
    "text": "out put it in your computer and it kind of magically finds out where the router",
    "start": "290639",
    "end": "295919"
  },
  {
    "text": "is and says \"Okay now enter the IP address or I'm going to give it an IP address.\" those out of something",
    "start": "295919",
    "end": "302320"
  },
  {
    "text": "features can be really really bad and we got legacy functions stuff",
    "start": "302320",
    "end": "309680"
  },
  {
    "text": "that's put into version one or maybe version two and in version 34 nobody",
    "start": "309680",
    "end": "317360"
  },
  {
    "text": "uses it anymore but it's still there and it's no longer considered part of the",
    "start": "317360",
    "end": "323440"
  },
  {
    "text": "software we actually had the situation talking with vendors of embedded systems",
    "start": "323440",
    "end": "329759"
  },
  {
    "text": "and um yeah saying look there's this feature here it's kind of old but you",
    "start": "329759",
    "end": "335120"
  },
  {
    "text": "can break into the system and they're like what feature even the developers didn't know",
    "start": "335120",
    "end": "340960"
  },
  {
    "text": "about it anymore then we got the all big ignored standards I mean we all know",
    "start": "340960",
    "end": "348240"
  },
  {
    "text": "about um certain vendors doing certain things and and not really following our",
    "start": "348240",
    "end": "353680"
  },
  {
    "text": "C's like being on Windows Blackhead most people think of Microsoft probably now",
    "start": "353680",
    "end": "359759"
  },
  {
    "text": "um I'm more thinking about Cisco because you always got like the RFC and then you got a web page saying Cisco's",
    "start": "359759",
    "end": "366000"
  },
  {
    "text": "understanding of the protocol which is always kind of different than the RFC is",
    "start": "366000",
    "end": "372600"
  },
  {
    "text": "so those have kind of neat side effects and we have an absolute uncontrolled",
    "start": "372600",
    "end": "379440"
  },
  {
    "text": "increase of complexity in those systems now the worst thing for security that can happen is increase of complexity",
    "start": "379440",
    "end": "385759"
  },
  {
    "text": "when you do not control it why because you got different units test every unit",
    "start": "385759",
    "end": "391680"
  },
  {
    "text": "every unit is fine you put them all together it falls apart um we all know how that works um I",
    "start": "391680",
    "end": "398960"
  },
  {
    "text": "mean in a in a market today you got marketing coming in saying we need this",
    "start": "398960",
    "end": "404639"
  },
  {
    "text": "and that new feature well you got about two weeks time to code it there is no",
    "start": "404639",
    "end": "410400"
  },
  {
    "text": "time to think about which side effects could that possibly have and all the other features we had well and this",
    "start": "410400",
    "end": "418160"
  },
  {
    "text": "means at some point in time you get bottom line inconsistent access",
    "start": "418160",
    "end": "425319"
  },
  {
    "text": "restrictions first case a design failure this is a firewall built by Lucent it's",
    "start": "425319",
    "end": "433039"
  },
  {
    "text": "called the Lucent brick kind of like goes along with the picture um it's a layer 2 firewall the Bellabs",
    "start": "433039",
    "end": "442000"
  },
  {
    "text": "people came up with a pretty cool embedded system operating embedded system operating system um called",
    "start": "442000",
    "end": "449160"
  },
  {
    "text": "Inferno it's actually pretty good and the firewall is based on Inferno so this",
    "start": "449160",
    "end": "455360"
  },
  {
    "text": "firewall is a layer 2 device pretty much it doesn't route it just sits on the",
    "start": "455360",
    "end": "461199"
  },
  {
    "text": "network um and talks to both sides and just drops the traffic that's not nice",
    "start": "461199",
    "end": "467680"
  },
  {
    "text": "the thing is for layer 2 device the design failure is in the worst possible",
    "start": "467680",
    "end": "472720"
  },
  {
    "text": "place it's in the ARP cache design the ARP cache first of",
    "start": "472720",
    "end": "478599"
  },
  {
    "text": "all is built to not run on firewalls but generally on layer 2 devices so our",
    "start": "478599",
    "end": "486400"
  },
  {
    "text": "requests and replies are forwarded through the firewall whatever your rule set says like you say drop every traffic",
    "start": "486400",
    "end": "494000"
  },
  {
    "text": "you can still send up requests through the firewall and get the answers which means you can basically arc scan the",
    "start": "494000",
    "end": "500240"
  },
  {
    "text": "whole network behind it and find out which hosts are up despite the fact that the firewall was actually configured to",
    "start": "500240",
    "end": "506720"
  },
  {
    "text": "not allow you doing that the other problem",
    "start": "506720",
    "end": "511800"
  },
  {
    "text": "is the ARP cache really takes every ARP reply it ever sees and caches it for",
    "start": "511800",
    "end": "519680"
  },
  {
    "text": "performance reasons that kind of sounds like a good idea you get a OP reply somewhere um you cache it you know where",
    "start": "519680",
    "end": "528399"
  },
  {
    "text": "it is next time you don't have to ask but it does not time out now imagine",
    "start": "528399",
    "end": "534560"
  },
  {
    "text": "what happens if you like send out op replies continuously what happens to a cache",
    "start": "534560",
    "end": "541600"
  },
  {
    "text": "that does not time out and caches every OP reply if you continuously send them",
    "start": "541600",
    "end": "547200"
  },
  {
    "text": "at some point in time it's full and what happens is this firewall actually explodes all over itself and is dead",
    "start": "547200",
    "end": "556720"
  },
  {
    "text": "the other thing with the replies is if you like send an ARP reply here with the",
    "start": "556720",
    "end": "562560"
  },
  {
    "text": "IP address of the LSMS server which is the management solution for those loosen",
    "start": "562560",
    "end": "568399"
  },
  {
    "text": "bricks um so here you have all the rule sets configured and you have all the logging taken place now you send from",
    "start": "568399",
    "end": "575680"
  },
  {
    "text": "the outside an OP reply with the IP address of this server and a different MAC address the firewall thinks \"Oh cool",
    "start": "575680",
    "end": "582560"
  },
  {
    "text": "update ARP cache here new entry.\" And yeah you are not going to manage your",
    "start": "582560",
    "end": "587920"
  },
  {
    "text": "firewall anymore air attacker sends one packet and you're",
    "start": "587920",
    "end": "593480"
  },
  {
    "text": "out second case SN routers um actually now also",
    "start": "593480",
    "end": "599720"
  },
  {
    "text": "lucid here we have the case of an undocumented auto something feature this",
    "start": "599720",
    "end": "605360"
  },
  {
    "text": "is um one of those protocols I just mentioned for taking a box out of like",
    "start": "605360",
    "end": "611200"
  },
  {
    "text": "the original package and put it on your network and trying to find out how to configure it this one works by sending a",
    "start": "611200",
    "end": "618320"
  },
  {
    "text": "specially formatted UDP packet to the discard port now UDP discard is supposed",
    "start": "618320",
    "end": "624399"
  },
  {
    "text": "to as the name suggests discarding the packets but if you send this special",
    "start": "624399",
    "end": "629600"
  },
  {
    "text": "magic packet um it goes and fills the rest of the packet with kind of interesting information like IP address",
    "start": "629600",
    "end": "636480"
  },
  {
    "text": "net mask um here's the real MAC address from the internal Ethernet interface its",
    "start": "636480",
    "end": "642720"
  },
  {
    "text": "name serial number stuff like that bad about this is it still works if",
    "start": "642720",
    "end": "648640"
  },
  {
    "text": "the device is already configured and since the operating system in this case",
    "start": "648640",
    "end": "654560"
  },
  {
    "text": "teaos um is used in bigger devices it still works on like huge dial in boxes",
    "start": "654560",
    "end": "662959"
  },
  {
    "text": "like um ascent as max not the TNT but the other",
    "start": "662959",
    "end": "669200"
  },
  {
    "text": "dialin boxes they got like 60 ports ISDN dial in it still has this protocol while",
    "start": "669200",
    "end": "676720"
  },
  {
    "text": "you would never expect someone to set such a box up and not knowing what IP is and how it works so the worst part about",
    "start": "676720",
    "end": "684800"
  },
  {
    "text": "this is it's supposed to work automatically so it takes the SNMP write community but",
    "start": "684800",
    "end": "694560"
  },
  {
    "text": "in this special packet format um as kind of a password and you can change this",
    "start": "694560",
    "end": "702240"
  },
  {
    "text": "information here like the IP address and the name and send it back with the message saying write or configure and",
    "start": "702240",
    "end": "711279"
  },
  {
    "text": "having the SNMP write community in there now even if you're turned off SNMP this",
    "start": "711279",
    "end": "716640"
  },
  {
    "text": "feature still works imagine what happens if you send such a packet with a new IP address to a",
    "start": "716640",
    "end": "722320"
  },
  {
    "text": "big dial-in server it gets a new IP address which kind of like destroys the",
    "start": "722320",
    "end": "727839"
  },
  {
    "text": "whole purpose because it's no longer working this is one of those protocols where you",
    "start": "727839",
    "end": "733519"
  },
  {
    "text": "go ask the developers okay how do you turn it off which protocol no no we don't do that",
    "start": "733519",
    "end": "740000"
  },
  {
    "text": "they they actually still run it and nobody knows about it they didn't even find it in the",
    "start": "740000",
    "end": "746040"
  },
  {
    "text": "code another nice design failure a Cisco enhanced IGRP now Cisco has the habit of",
    "start": "746040",
    "end": "753120"
  },
  {
    "text": "like not just only interpreting um RFC's kind of widely but also inventing",
    "start": "753120",
    "end": "759360"
  },
  {
    "text": "protocols because those guys writing RFC's don't really know um enhanced IGP is a Cisco in invention",
    "start": "759360",
    "end": "768800"
  },
  {
    "text": "for a routing protocol and it uses automated neighbor learning like the",
    "start": "768800",
    "end": "774079"
  },
  {
    "text": "neighbor announces hey I'm a new Cisco router i want to participate in your autonomous system and it just works",
    "start": "774079",
    "end": "779839"
  },
  {
    "text": "plug-and-play fine the thing is how many neighbors could that possibly cover now",
    "start": "779839",
    "end": "787600"
  },
  {
    "text": "sending out lots of neighbor announcements with non-existing IP addresses spoofed IP addresses um",
    "start": "787600",
    "end": "795360"
  },
  {
    "text": "happens to trigger the ARP request system in the router of course because",
    "start": "795360",
    "end": "800800"
  },
  {
    "text": "the router wants to talk back to you and push all your routing protocol information over to you now you're not",
    "start": "800800",
    "end": "807680"
  },
  {
    "text": "existing so you're not answering usually that would mean ARP will time out after",
    "start": "807680",
    "end": "814040"
  },
  {
    "text": "what three requests then you're done the problem is that this announcement this",
    "start": "814040",
    "end": "821120"
  },
  {
    "text": "neighbor announcement itself has a hold time which is in seconds so it counts",
    "start": "821120",
    "end": "827760"
  },
  {
    "text": "kind of counts it down once a second the whole time to just find out if the neighbor announcement is still valid and",
    "start": "827760",
    "end": "834959"
  },
  {
    "text": "this kicks again off the OP request process now imagine what happens with several a thousand neighbor",
    "start": "834959",
    "end": "841560"
  },
  {
    "text": "announcements your router will use every possible amount of CPU power and network",
    "start": "841560",
    "end": "848240"
  },
  {
    "text": "interface power to blast your network with OP requests as long as",
    "start": "848240",
    "end": "854600"
  },
  {
    "text": "this hello packet is valid now the timer is transmitted in the packet which is a",
    "start": "854600",
    "end": "863680"
  },
  {
    "text": "16 bit number so you go up to 18 hours valid so it spends 18 hours trying to",
    "start": "863680",
    "end": "871120"
  },
  {
    "text": "find you for server a thousand which means you send about 1,000 packet and the Cisco router takes care of the",
    "start": "871120",
    "end": "877519"
  },
  {
    "text": "network no longer working because it's busy forwarding op requests for iOS 11 this is even",
    "start": "877519",
    "end": "884720"
  },
  {
    "text": "possible to do as uniccast usually um enhanced IGP does multiccast but the 11",
    "start": "884720",
    "end": "892720"
  },
  {
    "text": "series doesn't really look at that so um you can even send it across the",
    "start": "892720",
    "end": "898440"
  },
  {
    "text": "internet the problem here is um as you see all iOS versions are affected but",
    "start": "898440",
    "end": "906399"
  },
  {
    "text": "for some reason Cisco's solution is kind of like none we're not going to fix it",
    "start": "906399",
    "end": "911920"
  },
  {
    "text": "and so I I came up with this device here to like fix the problem",
    "start": "911920",
    "end": "918560"
  },
  {
    "text": "exploiting a design failure hp printers how many of you people have HP printers",
    "start": "923120",
    "end": "928560"
  },
  {
    "text": "in their places how many of those",
    "start": "928560",
    "end": "933880"
  },
  {
    "text": "areworked you will have fun when you return um HP printers got various access",
    "start": "933880",
    "end": "942079"
  },
  {
    "text": "methods you can like tn it to it you can FTP over postcript or text files and",
    "start": "942079",
    "end": "947760"
  },
  {
    "text": "they were printed out um you can HTTP serve to their pages kind of thing um",
    "start": "947760",
    "end": "954639"
  },
  {
    "text": "you got of course SNMP and you get something called PGL um those access restrictions um no",
    "start": "954639",
    "end": "963120"
  },
  {
    "text": "those access methods are actually restricted by certain means of like authentication you got an admin password",
    "start": "963120",
    "end": "970399"
  },
  {
    "text": "which is valid for Tnet and HTTP you got the IP address filter thing where you",
    "start": "970399",
    "end": "977360"
  },
  {
    "text": "say only the certain subnet can access the box um and you got the PGL has its",
    "start": "977360",
    "end": "985040"
  },
  {
    "text": "own security scheme with the PGL password now those things are not really",
    "start": "985040",
    "end": "990959"
  },
  {
    "text": "consistent with each other by going there notice IP access",
    "start": "990959",
    "end": "996959"
  },
  {
    "text": "restriction does not include SNMP so you go to the printer and read this kind of",
    "start": "996959",
    "end": "1004240"
  },
  {
    "text": "funny looking oid here and you get back a hex string now this hex string happens",
    "start": "1004240",
    "end": "1009920"
  },
  {
    "text": "to be the administrator password for the printer so equipped with this password",
    "start": "1009920",
    "end": "1016399"
  },
  {
    "text": "you can now surf to the printer um log in with username laser jet we tried",
    "start": "1016399",
    "end": "1021920"
  },
  {
    "text": "admin over and over doesn't work um and the password you just got off the",
    "start": "1021920",
    "end": "1027839"
  },
  {
    "text": "printer and well you basically just owned the printer now here comes the interesting",
    "start": "1027839",
    "end": "1035120"
  },
  {
    "text": "part pgl already mentioned it runs on what's called the app socket application",
    "start": "1035120",
    "end": "1040880"
  },
  {
    "text": "socket or whatever it's port 9,100 um and it's the printer job",
    "start": "1040880",
    "end": "1046720"
  },
  {
    "text": "language it's used to like set up your job when you send over um your print job it's",
    "start": "1046720",
    "end": "1054880"
  },
  {
    "text": "like the preamble in the end of it that says use um US letter paper double-sided",
    "start": "1054880",
    "end": "1061840"
  },
  {
    "text": "printed um highest quality and with a green logo whatever this kind of stuff",
    "start": "1061840",
    "end": "1068320"
  },
  {
    "text": "so it basically sets that all you can also use that to set the defaults on a",
    "start": "1068320",
    "end": "1074160"
  },
  {
    "text": "printer now this PGL has its own security scheme as I said unfortunately",
    "start": "1074160",
    "end": "1081679"
  },
  {
    "text": "this password is just a number it is a number in the range of 16 bits means 1",
    "start": "1081679",
    "end": "1089120"
  },
  {
    "text": "to 6535 um 65535 and well this actually takes about",
    "start": "1089120",
    "end": "1097360"
  },
  {
    "text": "6 hours remotely to brute force i mean the key space is really small so there",
    "start": "1097360",
    "end": "1102880"
  },
  {
    "text": "isn't really big security now let's see what we can do with that pgl on top of",
    "start": "1102880",
    "end": "1109600"
  },
  {
    "text": "like doing paper um size configuration allows access to the printer's file",
    "start": "1109600",
    "end": "1115600"
  },
  {
    "text": "system the printer has a file system now you got um the spool directory that's",
    "start": "1115600",
    "end": "1122240"
  },
  {
    "text": "sitting either in DRAM or in flash or on a real hard drive um that contains",
    "start": "1122240",
    "end": "1130240"
  },
  {
    "text": "current print jobs those print jobs sent over to the printer i'll boot there so",
    "start": "1130240",
    "end": "1135600"
  },
  {
    "text": "he can like print it out later and it contains the PCL macros now lots of",
    "start": "1135600",
    "end": "1142080"
  },
  {
    "text": "companies actually have PCI macros in their HP printers because it's kind of convenient instead of going to a printer",
    "start": "1142080",
    "end": "1148160"
  },
  {
    "text": "shop and have your letter head printed on paper and then use this paper in your printer you can put a PCR macro on there",
    "start": "1148160",
    "end": "1156000"
  },
  {
    "text": "and have the letterhead like on the printer automatically being put on the",
    "start": "1156000",
    "end": "1161240"
  },
  {
    "text": "page now you can actually access this and of course change it which kind of",
    "start": "1161240",
    "end": "1168080"
  },
  {
    "text": "like gives some fun but there's more file system content the later models",
    "start": "1168080",
    "end": "1173919"
  },
  {
    "text": "actually have the full stuff on there the firmware the content of the web",
    "start": "1173919",
    "end": "1179440"
  },
  {
    "text": "server the embedded one that we just serve to and subsystem configuration for",
    "start": "1179440",
    "end": "1185760"
  },
  {
    "text": "different subsystems now think of your printer as a PGLbased file",
    "start": "1185760",
    "end": "1192200"
  },
  {
    "text": "server it also allows you of course since you got the right password to",
    "start": "1192200",
    "end": "1197760"
  },
  {
    "text": "change this content now you can actually make this kind of like extensively and",
    "start": "1197760",
    "end": "1204320"
  },
  {
    "text": "play with the file system so what I tried was um running a porn site off the printer in our office which actually",
    "start": "1204320",
    "end": "1210760"
  },
  {
    "text": "worked um so but it's also pretty interesting part um to like trade files",
    "start": "1210760",
    "end": "1217840"
  },
  {
    "text": "with your buddies via the printer now this this is from an um",
    "start": "1217840",
    "end": "1227480"
  },
  {
    "text": "8150 laser jet and you see this is the file system you see lots of stuff here",
    "start": "1227480",
    "end": "1234320"
  },
  {
    "text": "the the already mentioned postcript and PCL things pgl default is actually a",
    "start": "1234320",
    "end": "1240320"
  },
  {
    "text": "configuration directory um you have the web server obvious some txt files the",
    "start": "1240320",
    "end": "1247679"
  },
  {
    "text": "library stuff everything you want and on the volume one you got the",
    "start": "1247679",
    "end": "1254039"
  },
  {
    "text": "spool so you really like got full access i mean it it's pretty much like a DOS",
    "start": "1254039",
    "end": "1261400"
  },
  {
    "text": "drive now it's kind of hard to do that by hand because you got the whole PGL",
    "start": "1261400",
    "end": "1267760"
  },
  {
    "text": "thing is escape sequencebased so you have to like put together your escape",
    "start": "1267760",
    "end": "1272960"
  },
  {
    "text": "sequence and then the commands and they're kind of arcane sometimes so we",
    "start": "1272960",
    "end": "1278000"
  },
  {
    "text": "thought well let's like write a tool for it and there it is PFT um the printer",
    "start": "1278000",
    "end": "1284240"
  },
  {
    "text": "frustration tool it's um reading modifying writing environment variables",
    "start": "1284240",
    "end": "1290400"
  },
  {
    "text": "which is very very funny because with the environment variables you set the default ways like print 999 copies of",
    "start": "1290400",
    "end": "1300200"
  },
  {
    "text": "everything kind of like makes it funny you can also go and set the front panel",
    "start": "1300200",
    "end": "1307200"
  },
  {
    "text": "to a certain security mode the front panel security mode means it's not",
    "start": "1307200",
    "end": "1312720"
  },
  {
    "text": "working you set the front panel security to maximum and people can spend the whole",
    "start": "1312720",
    "end": "1318320"
  },
  {
    "text": "day pressing buttons it's not going to do anything um now this tool also allows",
    "start": "1318320",
    "end": "1324000"
  },
  {
    "text": "you the full file system access the screenshot you just saw was from the command line version but the real fun part isn't",
    "start": "1324000",
    "end": "1333280"
  },
  {
    "text": "technically challenging but really funny is changing the display message now imagine what happens the secretary goes",
    "start": "1333280",
    "end": "1338880"
  },
  {
    "text": "over to the printer because the printer says failure i can't print and the error message says please insert",
    "start": "1338880",
    "end": "1344440"
  },
  {
    "text": "coin they spend a lot of time actually finding this little slot to put the coin",
    "start": "1344440",
    "end": "1350760"
  },
  {
    "text": "in um you can actually communicate with people in other office buildings um",
    "start": "1350760",
    "end": "1356159"
  },
  {
    "text": "using printers because you lock the front panel and you send error messages like um well you ran out of like green",
    "start": "1356159",
    "end": "1366120"
  },
  {
    "text": "ink or um the paper tray 517 is empty please refill it's really funny you can",
    "start": "1366120",
    "end": "1374000"
  },
  {
    "text": "really communicate with people and it takes quite a while till they figure out what's",
    "start": "1374000",
    "end": "1379360"
  },
  {
    "text": "happening now since there are so many MCSEs all over the world um we figured",
    "start": "1380039",
    "end": "1385760"
  },
  {
    "text": "we would go and and write a GUI for it so you can play with that in",
    "start": "1385760",
    "end": "1390840"
  },
  {
    "text": "Windows so this is how it looks like um notice this is not a copyright",
    "start": "1390840",
    "end": "1396720"
  },
  {
    "text": "violation um you got like the file system access the environment variables",
    "start": "1396720",
    "end": "1402400"
  },
  {
    "text": "and the premium messages this is how the file system now looks like you can basically serve it like in your explorer",
    "start": "1402400",
    "end": "1409440"
  },
  {
    "text": "um and as I say trade files set up your own website on a printer whatever you",
    "start": "1409440",
    "end": "1415200"
  },
  {
    "text": "feel like um yeah it's getting",
    "start": "1415200",
    "end": "1422520"
  },
  {
    "text": "worse there is this invention called Shy VM shyvm is a Java virtual machine for",
    "start": "1422520",
    "end": "1429600"
  },
  {
    "text": "embedded systems developed by HP um the 9000 series um",
    "start": "1429600",
    "end": "1437559"
  },
  {
    "text": "4,100455 are officially running the stuff um other printers as the",
    "start": "1437559",
    "end": "1445320"
  },
  {
    "text": "8150 also run it and it is full-blown",
    "start": "1445320",
    "end": "1450720"
  },
  {
    "text": "virtual machine for the web server so it comes with like the web server itself",
    "start": "1450720",
    "end": "1457679"
  },
  {
    "text": "static files which we can replace with porn content um and objects the whole the whole nine yards",
    "start": "1457679",
    "end": "1465120"
  },
  {
    "text": "it's all there and everything lives on a printer file system which we just saw we can access now here's the scary part",
    "start": "1465120",
    "end": "1473760"
  },
  {
    "text": "this is from the HP website um it's actually yeah from from summer last year",
    "start": "1473760",
    "end": "1480159"
  },
  {
    "text": "the important part is the last three lines saying these appliances are powered by HPshy embedded software it",
    "start": "1480159",
    "end": "1487039"
  },
  {
    "text": "does not mention printers the thing is HPshai is sold all",
    "start": "1487039",
    "end": "1492880"
  },
  {
    "text": "over the place for TV setup set top boxes um pay TV boxes for even big",
    "start": "1492880",
    "end": "1500880"
  },
  {
    "text": "storage area network systems now we will see in a minute that the security of",
    "start": "1500880",
    "end": "1506000"
  },
  {
    "text": "SHIVM is kind of questionable here it is by default it",
    "start": "1506000",
    "end": "1512240"
  },
  {
    "text": "comes with a loader now this loader is there so bright people as the the",
    "start": "1512240",
    "end": "1519600"
  },
  {
    "text": "advertisement says HP invent um bright people can go to the printer and upload",
    "start": "1519600",
    "end": "1524799"
  },
  {
    "text": "code now they thought about oh that's scary so what are you going to do to secure that um okay we we make it",
    "start": "1524799",
    "end": "1531760"
  },
  {
    "text": "validate the signature of the JAR file the JAR file has to be signed by HP um",
    "start": "1531760",
    "end": "1537840"
  },
  {
    "text": "so we can first take a look at the software and not every single dude in the world can upload software the",
    "start": "1537840",
    "end": "1543679"
  },
  {
    "text": "problem here is a the default loader this loader doesn't really work it's",
    "start": "1543679",
    "end": "1551039"
  },
  {
    "text": "pure bad code it does not work and B they figure nobody is going to send them",
    "start": "1551039",
    "end": "1557039"
  },
  {
    "text": "code to sign it so they released something new the easy loader now the",
    "start": "1557039",
    "end": "1562720"
  },
  {
    "text": "easy loader as the name suggests makes it really easy for us it is itself an a",
    "start": "1562720",
    "end": "1570159"
  },
  {
    "text": "Java file signed by HP and after installation it will not",
    "start": "1570159",
    "end": "1577279"
  },
  {
    "text": "validate signatures anymore now here's the deal you can forget about all that",
    "start": "1577279",
    "end": "1582320"
  },
  {
    "text": "because we got file system access and on a file system as I said in a default directory there are configuration files",
    "start": "1582320",
    "end": "1589120"
  },
  {
    "text": "like csconfig cs config is a text file this text file says load the following",
    "start": "1589120",
    "end": "1595279"
  },
  {
    "text": "class and um put it on the following URL so we can basically download the text",
    "start": "1595279",
    "end": "1600720"
  },
  {
    "text": "file modify the text file upload the text file put the Java classes on the printer restart the printer all fine um",
    "start": "1600720",
    "end": "1609440"
  },
  {
    "text": "the last point got an issue because well HP still says it has nothing to do with",
    "start": "1609440",
    "end": "1616080"
  },
  {
    "text": "like us being on Devcon and doing this talk but um shortly after Defcon the",
    "start": "1616080",
    "end": "1621440"
  },
  {
    "text": "whole HP shy business unit um official stuff was shut down so the documentation",
    "start": "1621440",
    "end": "1628640"
  },
  {
    "text": "and all that stuff is no longer available but luckily um just before they shut it all down they released the",
    "start": "1628640",
    "end": "1635440"
  },
  {
    "text": "Shai server as open source under the LGBL and some people still mirror mirror",
    "start": "1635440",
    "end": "1642000"
  },
  {
    "text": "it we have a link on the website to um one mirror that actually has the shy",
    "start": "1642000",
    "end": "1647440"
  },
  {
    "text": "server still so if you want to play with this stuff um it's available this is just like a graphical",
    "start": "1647440",
    "end": "1654720"
  },
  {
    "text": "representation on how to get your code on a printer either the clicky clicky",
    "start": "1654720",
    "end": "1660320"
  },
  {
    "text": "browser way um upload easy loader um get easy loader running which is automat",
    "start": "1660320",
    "end": "1666400"
  },
  {
    "text": "magically done and then like upload your jar or like modify the CS config file",
    "start": "1666400",
    "end": "1672000"
  },
  {
    "text": "and put your own classes on now the problem is shym isn't really",
    "start": "1672000",
    "end": "1678399"
  },
  {
    "text": "stable code um if you do Java threads are kind of",
    "start": "1678399",
    "end": "1684880"
  },
  {
    "text": "important sometimes especially for server processes well if you do too many of those Shy VM dies if you try connect",
    "start": "1684880",
    "end": "1692000"
  },
  {
    "text": "to a closed port on some printer models it will kill Shyvm kind of silly actually um it",
    "start": "1692000",
    "end": "1700640"
  },
  {
    "text": "doesn't even always throw exceptions well Java without exceptions is kind of like not very useful instead of throwing",
    "start": "1700640",
    "end": "1708320"
  },
  {
    "text": "an exception it will just crash the printer um and well there is this this",
    "start": "1708320",
    "end": "1713600"
  },
  {
    "text": "little nice um shy server thing um and you can install that on a normal Linux",
    "start": "1713600",
    "end": "1719200"
  },
  {
    "text": "box or even Windows box if you feel like um but if your code runs on your box in",
    "start": "1719200",
    "end": "1725600"
  },
  {
    "text": "like the simulation environment it's not saying it will run on your printer no",
    "start": "1725600",
    "end": "1731120"
  },
  {
    "text": "there are differences so if you want to play with that or research some of the possible",
    "start": "1731120",
    "end": "1737279"
  },
  {
    "text": "applications um this oid here is kind of important",
    "start": "1737279",
    "end": "1742320"
  },
  {
    "text": "because if you set it to four it will reboot the printer and you will find out you need this quite",
    "start": "1742320",
    "end": "1748440"
  },
  {
    "text": "frequently yeah things you can do now we got a",
    "start": "1748440",
    "end": "1753600"
  },
  {
    "text": "full-blown printer with a CPU actually a pretty good MIP CPU um and network connectivity",
    "start": "1753600",
    "end": "1763679"
  },
  {
    "text": "stuff like that so what could we do first of all we implemented a web-based port scanner you go to your printer",
    "start": "1763679",
    "end": "1770880"
  },
  {
    "text": "enter the target host say scan ports do something different come back like half",
    "start": "1770880",
    "end": "1777279"
  },
  {
    "text": "an hour later and check which ports are open very funny if the scan system is",
    "start": "1777279",
    "end": "1784559"
  },
  {
    "text": "monitored by an IDS i had a guy actually um running to",
    "start": "1784559",
    "end": "1791919"
  },
  {
    "text": "the phone or being on the way to the phone calling ISS and complaining about how shitty their IDS is because Resecure",
    "start": "1791919",
    "end": "1800399"
  },
  {
    "text": "was telling him his printer is port scanning his web server it's really interesting",
    "start": "1800399",
    "end": "1809360"
  },
  {
    "text": "now as I said we got a big fat CPU and usually the thing just prints so it's",
    "start": "1809360",
    "end": "1815760"
  },
  {
    "text": "kind of like not really used and we thought why always use those cool",
    "start": "1815760",
    "end": "1822240"
  },
  {
    "text": "processing cycles on my laptop to crack passwords when I got a CPU sitting there",
    "start": "1822240",
    "end": "1828320"
  },
  {
    "text": "so we wrote chai crack which again is web- based for your convenience you go",
    "start": "1828320",
    "end": "1834000"
  },
  {
    "text": "there enter your crypt string um enter the characters that you want to brute",
    "start": "1834000",
    "end": "1839440"
  },
  {
    "text": "force through and just let the printer do the work and the best thing about it um it still",
    "start": "1839440",
    "end": "1845480"
  },
  {
    "text": "prints the magic of",
    "start": "1845480",
    "end": "1849200"
  },
  {
    "text": "multitasking you can do actually you can do a lot of stuff um like binding to listen binding and listening on on funny",
    "start": "1850520",
    "end": "1858320"
  },
  {
    "text": "ports um providing services stuff like that in the near future we're gonna",
    "start": "1858320",
    "end": "1865039"
  },
  {
    "text": "release things like um transparent TCP proxies for printers so you can like",
    "start": "1865039",
    "end": "1870080"
  },
  {
    "text": "chain up five printers um through the internet and then like hide yourself all over the place well yeah you can do",
    "start": "1870080",
    "end": "1878080"
  },
  {
    "text": "whatever you want well who wants to code in Java anyway um yeah this is how shy",
    "start": "1878080",
    "end": "1884240"
  },
  {
    "text": "crack looks kind of basic but works",
    "start": "1884240",
    "end": "1889520"
  },
  {
    "text": "there are shy services available from HP um shy services have some some",
    "start": "1889520",
    "end": "1896399"
  },
  {
    "text": "interesting side effects first of all they're fully trusted if you're a shy service someone else is a shy service",
    "start": "1896399",
    "end": "1901760"
  },
  {
    "text": "you can do whatever you want to him second there are things like shy",
    "start": "1901760",
    "end": "1907880"
  },
  {
    "text": "PMP find other printers kind of cool took over one printer and then like",
    "start": "1907880",
    "end": "1914080"
  },
  {
    "text": "extend your shy service by shy PMP and make it like distribute itself around",
    "start": "1914080",
    "end": "1920799"
  },
  {
    "text": "the printers talking about a printer wall it's so easy it's about four or",
    "start": "1920799",
    "end": "1926880"
  },
  {
    "text": "five screen pages Java um there is a notifier service this one is really",
    "start": "1926880",
    "end": "1933200"
  },
  {
    "text": "sweet really really sweet um you can tell it to notify you of interesting",
    "start": "1933200",
    "end": "1939120"
  },
  {
    "text": "events now definition of interesting events for me is like the CEO is printing something um 6:00 in the",
    "start": "1939120",
    "end": "1946000"
  },
  {
    "text": "evening might be interesting um you can actually with a bit of coding you can actually make the printer send you a",
    "start": "1946000",
    "end": "1952000"
  },
  {
    "text": "copy of that print job just so you got informed and yeah maybe he's firing some",
    "start": "1952000",
    "end": "1958080"
  },
  {
    "text": "important people maybe you want to buy or sell your stocks whatever um you can",
    "start": "1958080",
    "end": "1964159"
  },
  {
    "text": "also get this by email of course the absolute worst thing shy mail is as",
    "start": "1964159",
    "end": "1972399"
  },
  {
    "text": "it says on the documentation designed to work across firewalls now how does it do that it's no magic the printer gets an",
    "start": "1972399",
    "end": "1979840"
  },
  {
    "text": "email account a POP account configured somewhere out in the internet let's say Hotmail now it will p this account every",
    "start": "1979840",
    "end": "1988799"
  },
  {
    "text": "once in a minute see if there's new email you send an email there with",
    "start": "1988799",
    "end": "1994080"
  },
  {
    "text": "commands for shy services you would take the email look for the commands for shy",
    "start": "1994080",
    "end": "1999720"
  },
  {
    "text": "services start the service according to your email and send you back an email",
    "start": "1999720",
    "end": "2004799"
  },
  {
    "text": "with the result excellent so you don't even need to access the printer itself",
    "start": "2004799",
    "end": "2011279"
  },
  {
    "text": "you send them an email it's so silly if you want to play",
    "start": "2011279",
    "end": "2017440"
  },
  {
    "text": "with the printers in your company um here's where the tools are just download the stuff it's all",
    "start": "2017440",
    "end": "2025440"
  },
  {
    "text": "open source but don't look at the Windows code we don't live on Windows software vulnerabilities now",
    "start": "2025440",
    "end": "2032480"
  },
  {
    "text": "let's go to the discussing the classic mistakes the classic mistakes are also",
    "start": "2032480",
    "end": "2037679"
  },
  {
    "text": "made in embedded systems because embedded systems developers are not any brighter or smarter than any other",
    "start": "2037679",
    "end": "2044240"
  },
  {
    "text": "developers they just got smaller devices so we have input validation",
    "start": "2044240",
    "end": "2049839"
  },
  {
    "text": "issues format string buffer overflow even cross-ite scripting the HP printers",
    "start": "2049839",
    "end": "2055679"
  },
  {
    "text": "example cross-ite scripting vulnerabilities all over the place you can store like JavaScript code on that",
    "start": "2055679",
    "end": "2062560"
  },
  {
    "text": "next time the administrator tries to access it he got like 500 windows um but",
    "start": "2062560",
    "end": "2068560"
  },
  {
    "text": "the most scary thing is embedded system HTTP demons i have to see one single",
    "start": "2068560",
    "end": "2074638"
  },
  {
    "text": "HTTP demon on an embedded system that is not absolutely broken by default",
    "start": "2074639",
    "end": "2080480"
  },
  {
    "text": "the idea seems to be that wow I got a limited device resource it's so small",
    "start": "2080480",
    "end": "2085839"
  },
  {
    "text": "it's like I can't really do error checking and length checking and other",
    "start": "2085839",
    "end": "2090960"
  },
  {
    "text": "computing intensive stuff so I just leave it out seems to be the idea",
    "start": "2090960",
    "end": "2096638"
  },
  {
    "text": "talking about interesting overflows this is cursory checks we didn't really like",
    "start": "2096639",
    "end": "2102320"
  },
  {
    "text": "research the devices we just got our fingers on it and played about 10 minutes 15 minutes two hours with it and",
    "start": "2102320",
    "end": "2110160"
  },
  {
    "text": "got a buffer overflow somewhere so it's not really complicated first case ZDI router it's now again a Lucent product",
    "start": "2110160",
    "end": "2118480"
  },
  {
    "text": "it's an excellent router really good router got like um full-blown quality of",
    "start": "2118480",
    "end": "2123760"
  },
  {
    "text": "service stuff all pretty good command line interface with TCL scripting so",
    "start": "2123760",
    "end": "2129839"
  },
  {
    "text": "they really know what they're doing the web server long request 2,00 characters",
    "start": "2129839",
    "end": "2135839"
  },
  {
    "text": "boom router gone network printer from brother in this case you don't even need to send an",
    "start": "2135839",
    "end": "2143760"
  },
  {
    "text": "HTTP request yourself you go with the browser to the web page saying I want to",
    "start": "2143760",
    "end": "2148880"
  },
  {
    "text": "configure the printer it asks you for a password you're holding the A key for a while you click on submit",
    "start": "2148880",
    "end": "2155560"
  },
  {
    "text": "its HP proof switch is really cool normally if you got like SNMP write",
    "start": "2155560",
    "end": "2161040"
  },
  {
    "text": "access to a which um you're all done you're all set but this one is kind of",
    "start": "2161040",
    "end": "2166320"
  },
  {
    "text": "different because you got HTTP um you got SNMP right here and you fill this",
    "start": "2166320",
    "end": "2173520"
  },
  {
    "text": "OID here with like 85 characters the system will not die everything works as",
    "start": "2173520",
    "end": "2179839"
  },
  {
    "text": "expected until the administrator tries to access the device via TNET or HTTP",
    "start": "2179839",
    "end": "2185760"
  },
  {
    "text": "then it crashes talking about a trap i mean if you're breaking into a network it's kind",
    "start": "2185760",
    "end": "2192160"
  },
  {
    "text": "of cool to do this first because if the connectivity is gone you know someone",
    "start": "2192160",
    "end": "2198320"
  },
  {
    "text": "tried to find out what you're doing but they didn't have a chance because they just killed their",
    "start": "2198320",
    "end": "2203720"
  },
  {
    "text": "switch and even really small devices SE is a German-based small company um they",
    "start": "2203720",
    "end": "2212960"
  },
  {
    "text": "sell or used to sell pocket print servers size of a cigarette pack um for those Americans non-smoking this is a",
    "start": "2212960",
    "end": "2219359"
  },
  {
    "text": "cigarette pack um this thing also has a web server this web server again send a",
    "start": "2219359",
    "end": "2226960"
  },
  {
    "text": "get request long password in it boom it crashes and resets itself now the funny",
    "start": "2226960",
    "end": "2233520"
  },
  {
    "text": "part is um since it's directly connected to the printer port on a printer the Centronics port it will by resetting",
    "start": "2233520",
    "end": "2241040"
  },
  {
    "text": "itself reset the printer which is real bad during a print job on a laser printer it kind of like crashes the",
    "start": "2241040",
    "end": "2247599"
  },
  {
    "text": "whole idea of the laser printer so if you do that multiple times there will be collateral damage we tried that this is",
    "start": "2247599",
    "end": "2256000"
  },
  {
    "text": "how the device actually looks you see it's kind of small really now here are the common",
    "start": "2256000",
    "end": "2263400"
  },
  {
    "text": "misconceptions first of all embedded systems are so hard to exploit it's way harder than multi-purpose",
    "start": "2263400",
    "end": "2270720"
  },
  {
    "text": "you have to like reverse engineer the whole thing like get the binary down fire up IDA get yourself a memory",
    "start": "2270720",
    "end": "2277200"
  },
  {
    "text": "upgrade first um put the whole image in IDA and reverse engineer everything so",
    "start": "2277200",
    "end": "2283440"
  },
  {
    "text": "you know about SIS calls library functions stuff like that and since",
    "start": "2283440",
    "end": "2288800"
  },
  {
    "text": "you're not going to do that the worst thing that can possibly happen to your device is well it",
    "start": "2288800",
    "end": "2295079"
  },
  {
    "text": "crashes um well that's my statement",
    "start": "2295079",
    "end": "2300320"
  },
  {
    "text": "um the idea was to once prove it wrong and we have the habit of like um",
    "start": "2301480",
    "end": "2309680"
  },
  {
    "text": "choosing Cisco as a primary target for just because they're a nice target um so",
    "start": "2309680",
    "end": "2315839"
  },
  {
    "text": "the idea was exploit an overflow in Cisco IOS and take over the router really own the box um the thing is the",
    "start": "2315839",
    "end": "2325280"
  },
  {
    "text": "process you're crashing in Cisco IOS is not really a process as in in Windows or",
    "start": "2325280",
    "end": "2332240"
  },
  {
    "text": "Linux so it's really tightly integrated in the operating system so if you crash something um if you overflow something",
    "start": "2332240",
    "end": "2339440"
  },
  {
    "text": "it will crash i mean we all know that from Cisco routers as soon as they don't feel happy anymore they reboot or want",
    "start": "2339440",
    "end": "2346240"
  },
  {
    "text": "to be rebooted so according to Cisco now memory",
    "start": "2346240",
    "end": "2352079"
  },
  {
    "text": "corruption is like 85% of all issues they got um explicit or implicit it is",
    "start": "2352079",
    "end": "2360079"
  },
  {
    "text": "always memory corruption that's the bad thing so the assumption was it's",
    "start": "2360079",
    "end": "2365200"
  },
  {
    "text": "probably heat- based overflow so we got a vulnerability for research here um",
    "start": "2365200",
    "end": "2370560"
  },
  {
    "text": "it's a plain simple buffer overflow TFTP if you make your um Cisco TFTP server so",
    "start": "2370560",
    "end": "2378960"
  },
  {
    "text": "it serves out the um iOS image you send in a request with a long",
    "start": "2378960",
    "end": "2385200"
  },
  {
    "text": "name for the file you want to get and it kind of crashes now it says here iOS",
    "start": "2385200",
    "end": "2391520"
  },
  {
    "text": "11.1 to 11.3 how many people of you here in the room know that there is um iOS 12",
    "start": "2391520",
    "end": "2401799"
  },
  {
    "text": "that's not too much okay um let's do it other way around how many people are",
    "start": "2402960",
    "end": "2408480"
  },
  {
    "text": "running Cisco here okay keep your hands up please thank you um how many people are kind of",
    "start": "2408480",
    "end": "2416000"
  },
  {
    "text": "sure that they only run 12 series IOS okay how many of you guys are sure",
    "start": "2416000",
    "end": "2422880"
  },
  {
    "text": "that um the boot iOS you're running is also",
    "start": "2422880",
    "end": "2428320"
  },
  {
    "text": "12 one left the Microsoft guy isn't",
    "start": "2428520",
    "end": "2434720"
  },
  {
    "text": "it um the thing here is when Cisco's boot they got two iOSs first they got",
    "start": "2434920",
    "end": "2441920"
  },
  {
    "text": "like a ROM mon kind of thing then they kick off what's called the boot helper",
    "start": "2441920",
    "end": "2446960"
  },
  {
    "text": "image it's like a mini iOS and it's less frequently updated or it translates to",
    "start": "2446960",
    "end": "2455480"
  },
  {
    "text": "never because this thing is there are not many",
    "start": "2455480",
    "end": "2461319"
  },
  {
    "text": "versions that actually work so even if you want to upgrade your boot iOS to",
    "start": "2461319",
    "end": "2467000"
  },
  {
    "text": "12.0 or 12 something you can't because if you get a 12 series boot loader image",
    "start": "2467000",
    "end": "2474640"
  },
  {
    "text": "it doesn't work that means every time you reboot your",
    "start": "2474640",
    "end": "2479839"
  },
  {
    "text": "router for about 10 seconds it's vulnerable like the old versions of iOS",
    "start": "2479839",
    "end": "2486960"
  },
  {
    "text": "are because the bootloadader actually reads parses and executes the",
    "start": "2486960",
    "end": "2492760"
  },
  {
    "text": "configuration before kicking off the real iOS and the time",
    "start": "2492760",
    "end": "2498040"
  },
  {
    "text": "between running the configuration and finally kicking off the real iOS is",
    "start": "2498040",
    "end": "2503760"
  },
  {
    "text": "between five and 10 seconds which is more than enough to do an overflow and it's kind of funny because if",
    "start": "2503760",
    "end": "2511079"
  },
  {
    "text": "you make this overflow wrong so it like didn't work and it crashes even if the",
    "start": "2511079",
    "end": "2518480"
  },
  {
    "text": "boot iOS crashes it will still load the other the real iOS so nobody's going to",
    "start": "2518480",
    "end": "2523760"
  },
  {
    "text": "notice it this is from Cisco's TFTP",
    "start": "2523760",
    "end": "2530200"
  },
  {
    "text": "advisory and actually they continue saying that summary of this text worst possible",
    "start": "2530200",
    "end": "2536960"
  },
  {
    "text": "thing um is well it crashes it could be a deny of",
    "start": "2536960",
    "end": "2542839"
  },
  {
    "text": "service let's see if that's right okay here's what the router says if you",
    "start": "2542839",
    "end": "2548319"
  },
  {
    "text": "overflow something red zone um does anyone find this 41414141 kind of familiar yeah have you",
    "start": "2548319",
    "end": "2555760"
  },
  {
    "text": "seen that before it's um hex for all A so if someone puts an A strip somewhere",
    "start": "2555760",
    "end": "2562800"
  },
  {
    "text": "lots of A's well that is actually part of the",
    "start": "2562800",
    "end": "2568720"
  },
  {
    "text": "file we requested so we obviously overwrote something really interesting",
    "start": "2568720",
    "end": "2574400"
  },
  {
    "text": "and as it says down here corrupted red zone um let's see if we can do",
    "start": "2574400",
    "end": "2580119"
  },
  {
    "text": "that so how does the heap actually look the heap on on iOS is linked list memory",
    "start": "2580119",
    "end": "2587119"
  },
  {
    "text": "blocks they're linked together there are actually two different kinds of memory one is called the main memory",
    "start": "2587119",
    "end": "2593760"
  },
  {
    "text": "it's pretty much like processing you have the iOS sitting there you have um",
    "start": "2593760",
    "end": "2598960"
  },
  {
    "text": "some some buffers input buffers you have the stuff for processing the console stuff like that um and you got the IO",
    "start": "2598960",
    "end": "2606560"
  },
  {
    "text": "memory the IO memory is more for like fast packet oriented storage fixed size memory",
    "start": "2606560",
    "end": "2614440"
  },
  {
    "text": "blocks small medium large extra large kind of like with the t-shirts",
    "start": "2614440",
    "end": "2619720"
  },
  {
    "text": "um and mostly different type of RAM depends on a router type the bigger ones",
    "start": "2619720",
    "end": "2626480"
  },
  {
    "text": "have really different types of RAM um IO memory is sitting on a different bus um",
    "start": "2626480",
    "end": "2632160"
  },
  {
    "text": "running with different ways to organize memory but in general they're always",
    "start": "2632160",
    "end": "2637680"
  },
  {
    "text": "linked lists typical picture like you have a next pointer pointing to the next block",
    "start": "2637680",
    "end": "2644160"
  },
  {
    "text": "you have a previous pointer previous pointing to the previous block kind of thing just a link",
    "start": "2644160",
    "end": "2651000"
  },
  {
    "text": "list so one of those blocks we got a header then got the data here grayed out",
    "start": "2651000",
    "end": "2657760"
  },
  {
    "text": "and broken and a red zone it has magic like here begins memory",
    "start": "2657760",
    "end": "2664880"
  },
  {
    "text": "block which is a static value you got the process ID you got something which I",
    "start": "2664880",
    "end": "2671119"
  },
  {
    "text": "really find absolutely hilarious it's um the alloc check space now every process",
    "start": "2671119",
    "end": "2678400"
  },
  {
    "text": "is given four bytes of memory in the block header to put some dynamic um",
    "start": "2678400",
    "end": "2686880"
  },
  {
    "text": "canary in there and validate that and make sure nobody overwrote your block",
    "start": "2686880",
    "end": "2692480"
  },
  {
    "text": "now I have to find one single process in iOS that actually uses it none",
    "start": "2692480",
    "end": "2698920"
  },
  {
    "text": "does then you got like a pointer to the name of your process um the maloc",
    "start": "2698920",
    "end": "2705920"
  },
  {
    "text": "address kind of thing um where the maloc actually happened this is the program",
    "start": "2705920",
    "end": "2711599"
  },
  {
    "text": "counter address there then you got your next pointer previous pointer you got a size field how big the block is and the",
    "start": "2711599",
    "end": "2718480"
  },
  {
    "text": "most significant bit here is saying if it's in use or not on top of that you got a reference count how many processes",
    "start": "2718480",
    "end": "2725760"
  },
  {
    "text": "are referencing to this block um so it's kind of like double information and nobody actually uses the reference count",
    "start": "2725760",
    "end": "2733280"
  },
  {
    "text": "and you get a red zone which is a static canary this is the one we just",
    "start": "2733280",
    "end": "2739480"
  },
  {
    "text": "overflowed now the theory of the overflow here what we're trying to do is",
    "start": "2739480",
    "end": "2744640"
  },
  {
    "text": "we have a host block i call it host block because it's like hosting my data",
    "start": "2744640",
    "end": "2750280"
  },
  {
    "text": "um and we got the next block here so the idea is if we fill our data we write we",
    "start": "2750280",
    "end": "2759760"
  },
  {
    "text": "hit this border here and then we overwrite the header of the next block pretty much like every kind of heap",
    "start": "2759760",
    "end": "2765520"
  },
  {
    "text": "exploit on on Windows Linux same idea and the desired result of course is like",
    "start": "2765520",
    "end": "2771440"
  },
  {
    "text": "writing to arbitrary memory allocations or make iOS do funny things with our",
    "start": "2771440",
    "end": "2776800"
  },
  {
    "text": "block information and this is how it's supposed to work",
    "start": "2776800",
    "end": "2782838"
  },
  {
    "text": "make things short um it works best when the block is freed now here's the thing",
    "start": "2783839",
    "end": "2789359"
  },
  {
    "text": "about um free on iOS it's remember it's a double linked list and upon a free one",
    "start": "2789359",
    "end": "2797040"
  },
  {
    "text": "of those blocks is taken out it's a pointer exchange taking place so this",
    "start": "2797040",
    "end": "2803280"
  },
  {
    "text": "block here is no longer in a linked list of used blocks kind of makes sense so",
    "start": "2803280",
    "end": "2808640"
  },
  {
    "text": "this is pretty much what happens in in C and this is pretty much what happens in",
    "start": "2808640",
    "end": "2814880"
  },
  {
    "text": "like pixels so it's just taken out here and no longer in a linked",
    "start": "2814880",
    "end": "2823920"
  },
  {
    "text": "list when we overflow such a block we need to know which information in the",
    "start": "2824119",
    "end": "2830000"
  },
  {
    "text": "block header is actually checked by iOS the magic is checked to find out if it's",
    "start": "2830000",
    "end": "2836400"
  },
  {
    "text": "really memory block could be something different sure sitting in RAM um the P",
    "start": "2836400",
    "end": "2843280"
  },
  {
    "text": "is not checked this as I said dynamic canery nobody cares about it's never",
    "start": "2843280",
    "end": "2850440"
  },
  {
    "text": "checked um those addresses are more for debugging purpose the next pointer",
    "start": "2850440",
    "end": "2855839"
  },
  {
    "text": "pointing to the next block is also not checked nobody cares about it the previous pointer is um the size is and",
    "start": "2855839",
    "end": "2865359"
  },
  {
    "text": "the red zone is now the question is who checks that they got a demon for this this",
    "start": "2865359",
    "end": "2872960"
  },
  {
    "text": "demon or process is called check heaps and I got the impression this whole",
    "start": "2872960",
    "end": "2878560"
  },
  {
    "text": "thing was invented because 85% of all bucks in iOS are memory corruptions",
    "start": "2878560",
    "end": "2884400"
  },
  {
    "text": "because without this",
    "start": "2884400",
    "end": "2887680"
  },
  {
    "text": "process the wonders of modern GSM communication okay um without this",
    "start": "2890359",
    "end": "2897440"
  },
  {
    "text": "process it would probably um take some more time to find out if someone wrote",
    "start": "2897440",
    "end": "2902880"
  },
  {
    "text": "somewhere he was not supposed to so they iOS coders had issues debugging it um",
    "start": "2902880",
    "end": "2909119"
  },
  {
    "text": "that's probably the reason for having this process so what this process does is it starts the linked list from top to",
    "start": "2909119",
    "end": "2915800"
  },
  {
    "text": "bottom and goes looks at every single block and says hey are you okay checks",
    "start": "2915800",
    "end": "2921200"
  },
  {
    "text": "the red things here um and it gets kicked off twice a minute",
    "start": "2921200",
    "end": "2929280"
  },
  {
    "text": "and some of those checks are also done when you do a maloc or free in iOS um so",
    "start": "2929280",
    "end": "2935119"
  },
  {
    "text": "just if you allocate memory it just makes sure that there is still some kind of valid memory structure",
    "start": "2935119",
    "end": "2942160"
  },
  {
    "text": "but as we see since the magic is a static value and all this stuff here is",
    "start": "2942160",
    "end": "2949760"
  },
  {
    "text": "not checked we can actually fill the buffer up to here leave all this stuff",
    "start": "2949760",
    "end": "2954960"
  },
  {
    "text": "here alone and um see what it does so what it does is exactly what we",
    "start": "2954960",
    "end": "2963559"
  },
  {
    "text": "expected we're taking the first victim the 2500 routers it's one of the",
    "start": "2963559",
    "end": "2969200"
  },
  {
    "text": "so-called shared memory routers because IO and main memory are in the same chip kind of thing um this one allows",
    "start": "2969200",
    "end": "2977760"
  },
  {
    "text": "anything and anyone to write into NVRAM now NVRAM is kind of interesting on a Cisco router does any anyone have an",
    "start": "2977760",
    "end": "2985040"
  },
  {
    "text": "idea what um like the NVRM is for come on good morning i'm",
    "start": "2985040",
    "end": "2993400"
  },
  {
    "text": "here yeah it stores the configuration now if you control the configuration you",
    "start": "2993400",
    "end": "2999359"
  },
  {
    "text": "control the router right so the idea is let's like write something into NVAM the",
    "start": "2999359",
    "end": "3006160"
  },
  {
    "text": "good thing about NVAM is it's checked it's checked for integrity of course you",
    "start": "3006160",
    "end": "3011920"
  },
  {
    "text": "don't want to run with like a funny configuration so um it has a checksum",
    "start": "3011920",
    "end": "3017520"
  },
  {
    "text": "now what happens if this checksum is wrong it will not load the configuration",
    "start": "3017520",
    "end": "3022800"
  },
  {
    "text": "now on the other hand the router without a configuration is kind of so it well what are you going to do like over to",
    "start": "3022800",
    "end": "3029119"
  },
  {
    "text": "the router and fix it so as a kind of backup plan it goes out on the network",
    "start": "3029119",
    "end": "3034640"
  },
  {
    "text": "and tries to find someone to provide a configuration now what we are doing here is we do this overflow",
    "start": "3034640",
    "end": "3042559"
  },
  {
    "text": "um have this is the red zone static value because we like terminate the",
    "start": "3042559",
    "end": "3047680"
  },
  {
    "text": "first block nicely um this is the magic um this is all kinds of crap and this is",
    "start": "3047680",
    "end": "3054079"
  },
  {
    "text": "the memory address of the NVRAM on a 2500 we send that",
    "start": "3054079",
    "end": "3060119"
  },
  {
    "text": "over and this is what happens we send over the little",
    "start": "3060119",
    "end": "3066040"
  },
  {
    "text": "overflow the router figures out oops memory problem check heaps goes la all",
    "start": "3066040",
    "end": "3072720"
  },
  {
    "text": "bad um better reboot that's like the standard solution of Cisco reboot so",
    "start": "3072720",
    "end": "3079559"
  },
  {
    "text": "router doesn't like its memory anymore reboots now figures out there is no",
    "start": "3079559",
    "end": "3085240"
  },
  {
    "text": "config or there is a config but it's kind of like broken so goes out ask TFTP",
    "start": "3085240",
    "end": "3091920"
  },
  {
    "text": "broadcast could someone please provide me with a configuration and of course being nice we are actually going to do",
    "start": "3091920",
    "end": "3097800"
  },
  {
    "text": "that welcome you just own the router but that's kind of like you have",
    "start": "3097800",
    "end": "3103680"
  },
  {
    "text": "to be on the same subnet um it's only the 2500s yes it is the most sold router",
    "start": "3103680",
    "end": "3110319"
  },
  {
    "text": "but being on the same subnet 2500 kind of restrictive so let's make this thing",
    "start": "3110319",
    "end": "3116839"
  },
  {
    "text": "remote previous pointer as I said is checked the previous pointer points to the block previous to that one as the",
    "start": "3116839",
    "end": "3123920"
  },
  {
    "text": "name suggests now the thing is the check always happens when the block before",
    "start": "3123920",
    "end": "3130240"
  },
  {
    "text": "that is validated it goes and like looks okay this block here points to another",
    "start": "3130240",
    "end": "3136160"
  },
  {
    "text": "block so I go see if the thing it points to points back to me which is pretty",
    "start": "3136160",
    "end": "3143760"
  },
  {
    "text": "good test and it's hard to come by actually there is no way to fake anything you have to provide the correct",
    "start": "3143760",
    "end": "3150000"
  },
  {
    "text": "value which makes exploitation a little bit tricky since you need the exact",
    "start": "3150000",
    "end": "3155800"
  },
  {
    "text": "value well you need to make it somehow predictable",
    "start": "3155800",
    "end": "3161359"
  },
  {
    "text": "you can't just guess around because every time it boots it takes about two minutes to come back up um so what you",
    "start": "3161359",
    "end": "3168000"
  },
  {
    "text": "do is one uncontrolled overflow just send a bunch of A's over the thing",
    "start": "3168000",
    "end": "3173760"
  },
  {
    "text": "crashes and comes back up now when it comes back up it has a kind of predictable memory",
    "start": "3173760",
    "end": "3180520"
  },
  {
    "text": "layout you pretty much know where it is um the best thing is if you got access",
    "start": "3180520",
    "end": "3187559"
  },
  {
    "text": "to the SIS lock server or console output",
    "start": "3187559",
    "end": "3192880"
  },
  {
    "text": "even if you cannot log in um often you can see the SIS lock packets going by",
    "start": "3192880",
    "end": "3198640"
  },
  {
    "text": "you see the crash log you see the logging messages saying hey I crashed the memory was corrupted at the",
    "start": "3198640",
    "end": "3204559"
  },
  {
    "text": "following address so you got the address it's not a real cool way to do",
    "start": "3204559",
    "end": "3211040"
  },
  {
    "text": "that but I couldn't find a better Quite",
    "start": "3211040",
    "end": "3216480"
  },
  {
    "text": "frankly as I said it works best when you do free so let's look at the free memory",
    "start": "3216760",
    "end": "3223040"
  },
  {
    "text": "blocks a free memory block has on top of all that overhead we already saw",
    "start": "3223040",
    "end": "3228240"
  },
  {
    "text": "consisting of 40 bytes overhead for a single bite allocated um got more memory",
    "start": "3228240",
    "end": "3235119"
  },
  {
    "text": "management stuff in here it got some padding here that actually used to have some meaning um you got a second magic",
    "start": "3235119",
    "end": "3244160"
  },
  {
    "text": "kind of free magic that says this block is free you got yet another address",
    "start": "3244160",
    "end": "3249359"
  },
  {
    "text": "which is um pointing to the place that freed this block and padding more",
    "start": "3249359",
    "end": "3256680"
  },
  {
    "text": "padding then you have a free next and a free previous now those two are again",
    "start": "3256680",
    "end": "3263520"
  },
  {
    "text": "pointers in a linked list but this time in a different one this is probably that's an assumption i don't know that",
    "start": "3263520",
    "end": "3270640"
  },
  {
    "text": "um a linked list of free memory blocks so iOS can actually walk down free memory blocks in a linked list and say",
    "start": "3270640",
    "end": "3276640"
  },
  {
    "text": "\"Okay is this one big enough?\" No is this one big enough no is this one big enough yeah cool so instead of checking",
    "start": "3276640",
    "end": "3283280"
  },
  {
    "text": "is this free no go to the next check if this free block takes",
    "start": "3283280",
    "end": "3288359"
  },
  {
    "text": "to so the nice thing about those free blocks those two pointers are not",
    "start": "3288359",
    "end": "3295920"
  },
  {
    "text": "checked at all check heaps does not care about free blocks so we got two pointers",
    "start": "3295920",
    "end": "3301599"
  },
  {
    "text": "that are used in a pointer exchange when the free block is taken out of the list",
    "start": "3301599",
    "end": "3307920"
  },
  {
    "text": "of free blocks um or when memory is I can't even pronounce the word um merged",
    "start": "3307920",
    "end": "3315559"
  },
  {
    "text": "together it got a word cocalated is that correct",
    "start": "3315559",
    "end": "3321880"
  },
  {
    "text": "yeah um so when it's merged together you have two free blocks like five free",
    "start": "3321880",
    "end": "3327920"
  },
  {
    "text": "bytes and 10 free bytes it's kind of better to merge them together to have 15 free bytes and since you get rid of all",
    "start": "3327920",
    "end": "3335200"
  },
  {
    "text": "the overhead um for the allocated memory blocks it actually saves quite a lot of",
    "start": "3335200",
    "end": "3341440"
  },
  {
    "text": "space so when they're merged together this memory um this pointer operation",
    "start": "3341440",
    "end": "3347119"
  },
  {
    "text": "here takes place where free previous is pointing to gets the value of free next",
    "start": "3347119",
    "end": "3352960"
  },
  {
    "text": "and vice versa so with an offset of 20 we got a point that actually does a",
    "start": "3352960",
    "end": "3359920"
  },
  {
    "text": "pointer exchange unchecked so we can write to arbitrary",
    "start": "3359920",
    "end": "3365599"
  },
  {
    "text": "memory now where do should we write to i mean the",
    "start": "3366040",
    "end": "3371559"
  },
  {
    "text": "the process space is kind of big right so you better find a good place to write",
    "start": "3371559",
    "end": "3377760"
  },
  {
    "text": "your pointers to so it has some effect here is the deal we got a process",
    "start": "3377760",
    "end": "3385440"
  },
  {
    "text": "array process array seems to be an idea they had quite a while ago um having an",
    "start": "3385440",
    "end": "3392400"
  },
  {
    "text": "literally an array of process ids um pointing to memory blocks those memory",
    "start": "3392400",
    "end": "3398720"
  },
  {
    "text": "blocks um I call them process record because it's like a chunk of data consisting of all possible information",
    "start": "3398720",
    "end": "3406880"
  },
  {
    "text": "um for a process so like pretty much like the task switching context in in",
    "start": "3406880",
    "end": "3413480"
  },
  {
    "text": "Linux and the second element of this process record actually points to the",
    "start": "3413480",
    "end": "3420079"
  },
  {
    "text": "process stack so now we got like a place where we can",
    "start": "3420079",
    "end": "3426920"
  },
  {
    "text": "overwrite things we can put a new pointer here here here somewhere those",
    "start": "3426920",
    "end": "3433680"
  },
  {
    "text": "are all pointers we got a pointer exchange so we can like replace them",
    "start": "3433680",
    "end": "3439119"
  },
  {
    "text": "this is what we do taking a processor um this deck is writable the memory all over the place",
    "start": "3439119",
    "end": "3446720"
  },
  {
    "text": "except for the NVRAM is mostly writable so we can actually replace lots of",
    "start": "3446720",
    "end": "3453280"
  },
  {
    "text": "possible pointers we could replace the frame pointer of our CD function pretty",
    "start": "3453280",
    "end": "3459200"
  },
  {
    "text": "much like in every other exploitation the return address of course the process",
    "start": "3459200",
    "end": "3465440"
  },
  {
    "text": "array entry the whole process record stack entry st pointer entry whatever we",
    "start": "3465440",
    "end": "3471359"
  },
  {
    "text": "feel like there's lots of things we can actually replace the good thing about",
    "start": "3471359",
    "end": "3476520"
  },
  {
    "text": "those process information tables and stuff is they got a pretty static place",
    "start": "3476520",
    "end": "3482720"
  },
  {
    "text": "in memory it's not that they're like roaming around and are in different memory areas every time they are static",
    "start": "3482720",
    "end": "3492640"
  },
  {
    "text": "per iOS image which sounds pretty cool but in",
    "start": "3492640",
    "end": "3497680"
  },
  {
    "text": "contrast to Windows where you need like four values um for like Windows no",
    "start": "3497680",
    "end": "3503280"
  },
  {
    "text": "service packs service pack one service pack two service pack 3 and it increases with every service pack the amount of",
    "start": "3503280",
    "end": "3509760"
  },
  {
    "text": "Cisco images is a little bit higher my last count is",
    "start": "3509760",
    "end": "3516480"
  },
  {
    "text": "33,000 no joke there are 33,000 different iOS images on the Cisco FTP",
    "start": "3517160",
    "end": "3522920"
  },
  {
    "text": "server so it's kind of like limited um how static static is in this case but",
    "start": "3522920",
    "end": "3531520"
  },
  {
    "text": "it's at least a place you can write your stuff to now we got the question of the buffer",
    "start": "3531520",
    "end": "3538480"
  },
  {
    "text": "we got the execution redirected to wherever we want now we better provide",
    "start": "3538480",
    "end": "3544640"
  },
  {
    "text": "some code the problem here is the free we're using um actually clears the",
    "start": "3544640",
    "end": "3552240"
  },
  {
    "text": "memory so if we overwrite something here and then the free happens this memory is",
    "start": "3552240",
    "end": "3558000"
  },
  {
    "text": "overwritten by od i don't know if that's like an indication for o day no idea but the",
    "start": "3558000",
    "end": "3566400"
  },
  {
    "text": "thing we wrote the fake header for is now considered a free block a free block",
    "start": "3566400",
    "end": "3572000"
  },
  {
    "text": "is already free so someone already cleaned it and iOS is not going to check",
    "start": "3572000",
    "end": "3577119"
  },
  {
    "text": "if that's true or not so we can actually append the exploit buffer",
    "start": "3577119",
    "end": "3583920"
  },
  {
    "text": "here okay now we need shell code it's kind of tricky to do shell",
    "start": "3584200",
    "end": "3589920"
  },
  {
    "text": "code for a system that really doesn't follow the idea of a shell so what we do",
    "start": "3589920",
    "end": "3596079"
  },
  {
    "text": "is get rid of iOS right away don't care about the operating system running on",
    "start": "3596079",
    "end": "3602559"
  },
  {
    "text": "the embedded system we got a CPU for which we got a manual in this case for",
    "start": "3602559",
    "end": "3609119"
  },
  {
    "text": "the 1600 it's a Motorola CPU um we got the problem that the NVRM is protected",
    "start": "3609119",
    "end": "3616480"
  },
  {
    "text": "but this is also some function of the CPU so we look at the manual there is a memory protection register right here so",
    "start": "3616480",
    "end": "3625040"
  },
  {
    "text": "we know how to write there um well simply assembly um and we know what to",
    "start": "3625040",
    "end": "3631839"
  },
  {
    "text": "write there like we take away this bit that says protected and well we disable",
    "start": "3631839",
    "end": "3637920"
  },
  {
    "text": "the memory protection and write to the NV RAM either we can still do this here",
    "start": "3637920",
    "end": "3645599"
  },
  {
    "text": "like write invalid values somewhere in NV RAM like a stamp and the device",
    "start": "3645599",
    "end": "3652000"
  },
  {
    "text": "reboots doesn't know what the config is ask for a config but it's still okay",
    "start": "3652000",
    "end": "3657799"
  },
  {
    "text": "Right so um this is actually the code snippet for removing the memory protection don't",
    "start": "3657799",
    "end": "3665040"
  },
  {
    "text": "be scared of this little bit assembly there's more coming um it's just loading",
    "start": "3665040",
    "end": "3671359"
  },
  {
    "text": "the right addresses moving it over and like writing right into NVRAM kind of",
    "start": "3671359",
    "end": "3680359"
  },
  {
    "text": "simple now we want to do that actually make that remote",
    "start": "3680359",
    "end": "3686240"
  },
  {
    "text": "we overflow once to get a predictable memory layout we overflow a second time with",
    "start": "3686240",
    "end": "3692880"
  },
  {
    "text": "fake block and the correct previous pointer which is one of the hard parts",
    "start": "3692880",
    "end": "3699280"
  },
  {
    "text": "the size field oh I forgot to mention that the size field the size is checked",
    "start": "3699280",
    "end": "3704480"
  },
  {
    "text": "as I said the check here is if it's um terminating on memory boundaries or",
    "start": "3704480",
    "end": "3710920"
  },
  {
    "text": "terminating to the next block so it's kind of intelligent",
    "start": "3710920",
    "end": "3716200"
  },
  {
    "text": "but it's a 30 um 32-bit field and the",
    "start": "3716200",
    "end": "3721520"
  },
  {
    "text": "most significant bit as I said is usage if you fill it with seven FFF that",
    "start": "3721520",
    "end": "3727119"
  },
  {
    "text": "basically would be the maximum size some operation in iOS I have no",
    "start": "3727119",
    "end": "3732799"
  },
  {
    "text": "idea where um seems to be either with signed and unsigned buck like you have a",
    "start": "3732799",
    "end": "3738799"
  },
  {
    "text": "signed and an unsigned variable and you like move it over or is using um",
    "start": "3738799",
    "end": "3745119"
  },
  {
    "text": "addition or shifting or stuff so it flips over and becomes zero and having this size field here um",
    "start": "3745119",
    "end": "3753920"
  },
  {
    "text": "is valid it's checked and it will pass the check we have the free next pointer",
    "start": "3753920",
    "end": "3760480"
  },
  {
    "text": "who points to our code and the free previous points to the return address of some stack from some process now you",
    "start": "3760480",
    "end": "3768799"
  },
  {
    "text": "better take a process that it's not highly active and called every 5 seconds um the worst possible process to take is",
    "start": "3768799",
    "end": "3775440"
  },
  {
    "text": "virtual xc because that has a very very unpredictable stack layout you never",
    "start": "3775440",
    "end": "3781680"
  },
  {
    "text": "know where it currently is those little helper processes like load meter kicked",
    "start": "3781680",
    "end": "3787200"
  },
  {
    "text": "on once a minute to check how big the load on a box is um once a second is",
    "start": "3787200",
    "end": "3794079"
  },
  {
    "text": "yeah those are perfect because they run a specific cycle of calls and return and",
    "start": "3794079",
    "end": "3800480"
  },
  {
    "text": "so you actually know the state for of um 60 seconds minus 10 milliseconds of runtime",
    "start": "3800480",
    "end": "3808720"
  },
  {
    "text": "for load meter for those 60 seconds it's like stable state frozen state and we",
    "start": "3808720",
    "end": "3815520"
  },
  {
    "text": "have like code to unprotect memory and write into the NV",
    "start": "3815520",
    "end": "3820599"
  },
  {
    "text": "RAM this is still like overflowing um and just invalidating the",
    "start": "3820599",
    "end": "3826920"
  },
  {
    "text": "NVAM we invalidated it it says notice and VM invalid possibly due to right",
    "start": "3826920",
    "end": "3832960"
  },
  {
    "text": "arrays maybe they change it in the future and say possibly due to exploitation attempts um then it says",
    "start": "3832960",
    "end": "3839440"
  },
  {
    "text": "loading network config from IP address hey yeah got a network config call press return to get started or get owned um",
    "start": "3839440",
    "end": "3849200"
  },
  {
    "text": "remote shell code isn't much different the only thing we do is we append the",
    "start": "3849200",
    "end": "3854799"
  },
  {
    "text": "new config to the buffer that already contains our code we send it over code",
    "start": "3854799",
    "end": "3860960"
  },
  {
    "text": "gets executed instead of writing crap in NVRAM it will disable the interrupts",
    "start": "3860960",
    "end": "3866960"
  },
  {
    "text": "just to make absolutely sure iOS isn't doing anything anymore um unprotects the",
    "start": "3866960",
    "end": "3872520"
  },
  {
    "text": "NVAM copies the thing over makes sure that the NVAM header and all that of",
    "start": "3872520",
    "end": "3879200"
  },
  {
    "text": "course it's like mini file system so it got like a header um that the NVM header",
    "start": "3879200",
    "end": "3884640"
  },
  {
    "text": "is correct check some and length fields that's pretty much it and write it to",
    "start": "3884640",
    "end": "3891760"
  },
  {
    "text": "the NVR slowly it's kind of funny when we first wrote that the code ran the box rebooted",
    "start": "3891760",
    "end": "3899520"
  },
  {
    "text": "came back up you look at the memory and like every second bite of the config we",
    "start": "3899520",
    "end": "3905680"
  },
  {
    "text": "submitted was there just every second and I was like what the hell and and",
    "start": "3905680",
    "end": "3912000"
  },
  {
    "text": "checking the code found out no the code works the problem is NVRAM chips aren't",
    "start": "3912000",
    "end": "3918680"
  },
  {
    "text": "fast you have to wait until the right actually happened you can't just loop",
    "start": "3918680",
    "end": "3924640"
  },
  {
    "text": "through it and and write bite by bite by bite by bite it's more like bite",
    "start": "3924640",
    "end": "3932039"
  },
  {
    "text": "bite that's how it works this is why it kind of like takes a while to copy a",
    "start": "3932039",
    "end": "3937520"
  },
  {
    "text": "config um but yeah if you do it slowly it works you have to erase the old",
    "start": "3937520",
    "end": "3943760"
  },
  {
    "text": "config so the checksum isn't broken um and then just to be nice we do a clean",
    "start": "3943760",
    "end": "3949119"
  },
  {
    "text": "hard reset of the processor tell the processor do a reset has two good things",
    "start": "3949119",
    "end": "3955920"
  },
  {
    "text": "to it first of all it doesn't like crash hard um and when it crashes sometimes",
    "start": "3955920",
    "end": "3963680"
  },
  {
    "text": "iOS the bootloader iOS installs kind of an exception handler this one will write",
    "start": "3963680",
    "end": "3969200"
  },
  {
    "text": "a ST trace or at least some context information on what went wrong in the",
    "start": "3969200",
    "end": "3974240"
  },
  {
    "text": "NVAM sometimes destroying um the checksum we just calculated for a new config i'm not entirely sure why it",
    "start": "3974240",
    "end": "3982240"
  },
  {
    "text": "sometimes happen when and sometimes not on the other hand if we do a clean",
    "start": "3982240",
    "end": "3987400"
  },
  {
    "text": "reset if someone inspects the device later on he will not see that it was",
    "start": "3987400",
    "end": "3992960"
  },
  {
    "text": "exploited because it says I got resetted by the administrator saying reload well",
    "start": "3992960",
    "end": "4000079"
  },
  {
    "text": "the only difference now of course is that they don't know the password anymore um yeah we put that all together",
    "start": "4000079",
    "end": "4008000"
  },
  {
    "text": "for the TFTP thing um it's just the overflow a fake block a bootstrap code",
    "start": "4008000",
    "end": "4014480"
  },
  {
    "text": "because you have the classic string things like oh there is a zero in the code and and that terminates the string",
    "start": "4014480",
    "end": "4020520"
  },
  {
    "text": "la so you do the classic circumvention of that problem by having a bootloader",
    "start": "4020520",
    "end": "4025760"
  },
  {
    "text": "code with um no zeros in it and then the rest of the code exart um and the new",
    "start": "4025760",
    "end": "4031839"
  },
  {
    "text": "config as well so it's all like nonnull stuff and yeah sends it over you can",
    "start": "4031839",
    "end": "4038960"
  },
  {
    "text": "adjust certain values here it's yeah you can download it if you feel like and",
    "start": "4038960",
    "end": "4044240"
  },
  {
    "text": "this is how looks like if it actually works you see no complaining about",
    "start": "4044240",
    "end": "4049760"
  },
  {
    "text": "exceptions and stuff it just clean reboots here um it says \"Oh config new",
    "start": "4049760",
    "end": "4056720"
  },
  {
    "text": "um configuration funny version here never saw that before.\"",
    "start": "4056720",
    "end": "4063000"
  },
  {
    "text": "Um here it actually says setup new interface BRRI it's also priced to find",
    "start": "4063000",
    "end": "4068240"
  },
  {
    "text": "an BRRI interface on a 1600 that's because our minimum config appended to",
    "start": "4068240",
    "end": "4073280"
  },
  {
    "text": "the buffer didn't mention anything about a BRI interface the nice thing about it",
    "start": "4073280",
    "end": "4078400"
  },
  {
    "text": "it doesn't really complain about it just says well yeah got a new interface put it in shutdown mode doesn't care um so",
    "start": "4078400",
    "end": "4085920"
  },
  {
    "text": "it actually works if you just configure the Ethernet interface or whatever interface you use to attack",
    "start": "4085920",
    "end": "4091720"
  },
  {
    "text": "it and this is the config you just tell it to the box well you provided the",
    "start": "4091720",
    "end": "4097199"
  },
  {
    "text": "config so you know the passwords you just log in you own the",
    "start": "4097199",
    "end": "4102000"
  },
  {
    "text": "router that's more like the technical information um here this is how the",
    "start": "4102359",
    "end": "4108560"
  },
  {
    "text": "whole memory block um looks like when you send it over the fake header it's kind of like well it's probably better",
    "start": "4108560",
    "end": "4115359"
  },
  {
    "text": "in in the print outs anyway um greetings to the chaos computer club",
    "start": "4115359",
    "end": "4121640"
  },
  {
    "text": "um this is the bootloadader code that does not contain any zeros and well",
    "start": "4121640",
    "end": "4129679"
  },
  {
    "text": "decodes the rest of it and this is how you do a clean reset on Motorola",
    "start": "4129679",
    "end": "4136359"
  },
  {
    "text": "CPU might be interesting this one is really fun i named it oops PF because it's like",
    "start": "4136359",
    "end": "4144238"
  },
  {
    "text": "OPF overflow they have a very interesting bug um which is actually",
    "start": "4144239",
    "end": "4150480"
  },
  {
    "text": "documented and known for about a year um in 11.2 up to",
    "start": "4150480",
    "end": "4156199"
  },
  {
    "text": "12.0 the OPF also does neighbor tracking as explained with the enhanced IGP",
    "start": "4156199",
    "end": "4163080"
  },
  {
    "text": "before you send out hello packets in OPF and it's like a cool new neighbor now",
    "start": "4163080",
    "end": "4169838"
  },
  {
    "text": "some dude at Cisco thought you will never ever have more than 255",
    "start": "4169839",
    "end": "4176199"
  },
  {
    "text": "neighbors typical case of someone coming from small site computing and thinking",
    "start": "4176199",
    "end": "4181440"
  },
  {
    "text": "that class C is the biggest and half of the internet no it's not so having more",
    "start": "4181440",
    "end": "4187600"
  },
  {
    "text": "than 255 neighbors of course overflows something that's like kind of the logic",
    "start": "4187600",
    "end": "4194560"
  },
  {
    "text": "thing in iOS um it is interesting for",
    "start": "4194560",
    "end": "4199679"
  },
  {
    "text": "several reasons first it's not single packet the TFTP thing was like all in a",
    "start": "4199679",
    "end": "4206320"
  },
  {
    "text": "buffer you could put everything interesting in one buffer your code your",
    "start": "4206320",
    "end": "4211920"
  },
  {
    "text": "new config everything you wanted um this time it is not single packet",
    "start": "4211920",
    "end": "4219760"
  },
  {
    "text": "this time we have to like puzzle this stuff together um second it's now in IO",
    "start": "4219760",
    "end": "4225679"
  },
  {
    "text": "memory as I mentioned there's main memory and IO memory now it's in IO",
    "start": "4225679",
    "end": "4230800"
  },
  {
    "text": "memory so we got like little bit different memory structure stuff have to",
    "start": "4230800",
    "end": "4235880"
  },
  {
    "text": "see and the overflow is not at the end of the memory blockchain which is a",
    "start": "4235880",
    "end": "4242400"
  },
  {
    "text": "problem because for um this free block merging we better be somewhere at the",
    "start": "4242400",
    "end": "4248320"
  },
  {
    "text": "end where more free blocks are um available so there is something actually",
    "start": "4248320",
    "end": "4253679"
  },
  {
    "text": "to merge otherwise a free would actually free the block and just yeah keep it at",
    "start": "4253679",
    "end": "4259840"
  },
  {
    "text": "that so exploitability",
    "start": "4259840",
    "end": "4265520"
  },
  {
    "text": "um the overflow is actually a table of the router ids of the discovered",
    "start": "4265520",
    "end": "4272920"
  },
  {
    "text": "neighbors so out of the whole OPF hello packet four bytes the router ID which is",
    "start": "4272920",
    "end": "4280159"
  },
  {
    "text": "usually an M IP address is taken and written to a table now this table grows",
    "start": "4280159",
    "end": "4286080"
  },
  {
    "text": "and eventually overflows some memory structure the source IP address for the",
    "start": "4286080",
    "end": "4293360"
  },
  {
    "text": "halo of course has to be in the range that says the network statement for like",
    "start": "4293360",
    "end": "4298800"
  },
  {
    "text": "expected neighbors otherwise it's going to be dropped anyway",
    "start": "4298800",
    "end": "4303920"
  },
  {
    "text": "and of course to have more than 255 neighbors you need a net mask um smaller than /24",
    "start": "4303920",
    "end": "4311440"
  },
  {
    "text": "now um this list entry this router",
    "start": "4311440",
    "end": "4316719"
  },
  {
    "text": "neighbor entry is very good because",
    "start": "4316719",
    "end": "4321920"
  },
  {
    "text": "first of all we're allowed to send null bytes and second since the router ID",
    "start": "4321920",
    "end": "4329440"
  },
  {
    "text": "could be any possible combination of four bytes we are not restricted in what",
    "start": "4329440",
    "end": "4335120"
  },
  {
    "text": "we are sending over we can send whatever we want makes it a whole lot",
    "start": "4335120",
    "end": "4342360"
  },
  {
    "text": "easier um iOS IO memory this one uses dynamically scaled",
    "start": "4342360",
    "end": "4350320"
  },
  {
    "text": "list of fixed block sizes as I said it's like in a t-shirt store you got small",
    "start": "4350320",
    "end": "4355920"
  },
  {
    "text": "medium large x large huge extra huge tent um so that's the same with like the",
    "start": "4355920",
    "end": "4363679"
  },
  {
    "text": "blocks here you got small blocks in a chain then you got mediumsized blocks in a chain big blocks in a chain there are",
    "start": "4363679",
    "end": "4371679"
  },
  {
    "text": "different buffers really depending on the type of router you're dealing with the small shared memory routers like the",
    "start": "4371679",
    "end": "4377199"
  },
  {
    "text": "1600s it's well just buffers um they're all in the same memory area but for the",
    "start": "4377199",
    "end": "4383520"
  },
  {
    "text": "bigger ones it's different having the same design for the overall iOS thing um",
    "start": "4383520",
    "end": "4390719"
  },
  {
    "text": "means that they got public buffer pools where basically every interface is",
    "start": "4390719",
    "end": "4396239"
  },
  {
    "text": "allowed to grab some some buffer space off and private interface pools where",
    "start": "4396239",
    "end": "4401600"
  },
  {
    "text": "the blocks are actually the size of the maximum packet size possibly received by",
    "start": "4401600",
    "end": "4407840"
  },
  {
    "text": "the interface it's kind of good design actually it's kind of speedy um and the",
    "start": "4407840",
    "end": "4414800"
  },
  {
    "text": "allocation deallocation actually depends on some values you got the permanent amount of buffers the minimum amount the",
    "start": "4414800",
    "end": "4421840"
  },
  {
    "text": "maximum um minimum free maximum free um and you",
    "start": "4421840",
    "end": "4426960"
  },
  {
    "text": "got all kinds of values actually it's kind of tricky um and as long as it",
    "start": "4426960",
    "end": "4433679"
  },
  {
    "text": "still is between the the lower and the higher thresholds they will not allocate memory",
    "start": "4433679",
    "end": "4440880"
  },
  {
    "text": "they were not free memory buffers in most operating systems like FreeBSD are fixed here they are",
    "start": "4440880",
    "end": "4448880"
  },
  {
    "text": "dynamically scaled but not very often it has to be an exceptional traffic",
    "start": "4448880",
    "end": "4455560"
  },
  {
    "text": "condition so what we're doing here is like dear Cisco piece that together for",
    "start": "4455560",
    "end": "4462360"
  },
  {
    "text": "me we send over OPF hellos and well kind",
    "start": "4462360",
    "end": "4468159"
  },
  {
    "text": "of like puzzle together the same memory block thing we did before with router",
    "start": "4468159",
    "end": "4474760"
  },
  {
    "text": "ids works so with every pack we're sending over we got four bytes of buffer",
    "start": "4474760",
    "end": "4481280"
  },
  {
    "text": "um the overflow actually happens that's why the animation went this way um button to top because we're first",
    "start": "4481280",
    "end": "4489360"
  },
  {
    "text": "overflowing it and we're first sending it over and what happens is a copy",
    "start": "4489360",
    "end": "4494640"
  },
  {
    "text": "operation it takes the old list adds a new entry at the top and copies it back",
    "start": "4494640",
    "end": "4499760"
  },
  {
    "text": "into memory um we can actually",
    "start": "4499760",
    "end": "4504920"
  },
  {
    "text": "do 1,24 bytes here because yeah 256 by 4 we",
    "start": "4504920",
    "end": "4513520"
  },
  {
    "text": "can even do larger buffers but that would actually require us to have a even smaller net mask and at certain point",
    "start": "4513520",
    "end": "4520480"
  },
  {
    "text": "like with a flat class A you probably don't run",
    "start": "4520480",
    "end": "4526000"
  },
  {
    "text": "OPF memory management tricks as I said we're not at the end of the memory chain",
    "start": "4526760",
    "end": "4532719"
  },
  {
    "text": "so we have to convince it somehow to um merge three blocks together that do not",
    "start": "4532719",
    "end": "4538640"
  },
  {
    "text": "really exist next to each other um so we need some memory management tricks most",
    "start": "4538640",
    "end": "4545600"
  },
  {
    "text": "of you probably have this experience that sometimes you have to trick around with management so you get what you",
    "start": "4545600",
    "end": "4551600"
  },
  {
    "text": "wanted same here um the overflowed block header is as I said in the middle of the",
    "start": "4551600",
    "end": "4559040"
  },
  {
    "text": "chain so it's well kind of useless the exploit um actually goes ahead and",
    "start": "4559040",
    "end": "4566239"
  },
  {
    "text": "builds the block header in a way that for the buffer list the list of actually used buffers it's they're pointing to",
    "start": "4566239",
    "end": "4573040"
  },
  {
    "text": "the buffers to the buffers well one is free I don't care but for the memory",
    "start": "4573040",
    "end": "4578199"
  },
  {
    "text": "manager that tries to merge the three blocks together this one is actually at",
    "start": "4578199",
    "end": "4583840"
  },
  {
    "text": "the end remember we got two linked lists one",
    "start": "4583840",
    "end": "4590560"
  },
  {
    "text": "for the real blocks used and free one for the free blocks yeah nobody says that those two",
    "start": "4590560",
    "end": "4598080"
  },
  {
    "text": "information have to be like correct for each other we can make the one pointing",
    "start": "4598080",
    "end": "4604080"
  },
  {
    "text": "at the end of the memory the other one pointing to the next block so if everything works fine we got something",
    "start": "4604080",
    "end": "4611600"
  },
  {
    "text": "like here if you do like show memory IO memory um we got packet data packet data",
    "start": "4611600",
    "end": "4618239"
  },
  {
    "text": "packer data packer data here we are we basically terminate the memory",
    "start": "4618239",
    "end": "4623920"
  },
  {
    "text": "list there it still works because the um buffer pointers are pointed directly",
    "start": "4623920",
    "end": "4630239"
  },
  {
    "text": "into the memory segments where it's supposed to write to it's no linked list",
    "start": "4630239",
    "end": "4636560"
  },
  {
    "text": "because it would take ages for every received packet to go down the linked",
    "start": "4636560",
    "end": "4642159"
  },
  {
    "text": "list and find the right buffer so they got like the pointers cached the funny part about this one is you send it all",
    "start": "4642159",
    "end": "4649840"
  },
  {
    "text": "over it worked and the exploit is dormant nothing happens the pointers are",
    "start": "4649840",
    "end": "4656719"
  },
  {
    "text": "all good there is no allocation or free taken place so our faked pointer",
    "start": "4656719",
    "end": "4665199"
  },
  {
    "text": "information is not used so far so it's sitting there and we really tried that",
    "start": "4665199",
    "end": "4671280"
  },
  {
    "text": "we really ran like um serious TCP IP sessions over a router that had this",
    "start": "4671280",
    "end": "4677280"
  },
  {
    "text": "like kind of funny memories layout now it stays stable what you",
    "start": "4677280",
    "end": "4684280"
  },
  {
    "text": "do is you activate the exploit at some point in time by either um send in heavy",
    "start": "4684280",
    "end": "4691440"
  },
  {
    "text": "traffic load complex routing updates something like this it figures oops need buffers um best I need small buffers",
    "start": "4691440",
    "end": "4698640"
  },
  {
    "text": "allocates buffers buffers buffers buffers you stop sending it goes like oh lots of buffers what I'm doing ah I",
    "start": "4698640",
    "end": "4705040"
  },
  {
    "text": "freed them they get freed then the memory management goes oh lots of free buffers let's merge them boom executed",
    "start": "4705040",
    "end": "4712400"
  },
  {
    "text": "the code or you call up the guy and say look there is this evil Cisco warm",
    "start": "4712400",
    "end": "4719040"
  },
  {
    "text": "coming out and the only way to protect is like go to configure mode and say buffer small permanent zero next thing",
    "start": "4719040",
    "end": "4725360"
  },
  {
    "text": "you know he executed your code you can do it whenever you",
    "start": "4725360",
    "end": "4732158"
  },
  {
    "text": "want this is a min minimum iOS config that we actually included in this whole",
    "start": "4732280",
    "end": "4737440"
  },
  {
    "text": "OPF send over kind of thing um the fun part is iOS always always parses the",
    "start": "4737440",
    "end": "4745280"
  },
  {
    "text": "configuration the same way you know that you can um do short commands if it's",
    "start": "4745280",
    "end": "4750960"
  },
  {
    "text": "clear what the command is supposed to do um you can shorten it the same thing happens when it loads",
    "start": "4750960",
    "end": "4758080"
  },
  {
    "text": "the configuration from the NVRM or from the network so you're not required to write full-blown",
    "start": "4758080",
    "end": "4764880"
  },
  {
    "text": "um configuration this is like as small as you can get um has everything you need",
    "start": "4764880",
    "end": "4772400"
  },
  {
    "text": "an enabled password the password is C um IP address on the Ethernet interface a",
    "start": "4772400",
    "end": "4778480"
  },
  {
    "text": "default route because well remote you want to like reach it again um the configuration for the telnet",
    "start": "4778480",
    "end": "4785840"
  },
  {
    "text": "interface the password and the login statement and that's pretty much it you",
    "start": "4785840",
    "end": "4790960"
  },
  {
    "text": "don't need more and this is how it looks like when it actually happens um it boots yeah",
    "start": "4790960",
    "end": "4799360"
  },
  {
    "text": "legal blah blah geek info and then we have like the interfaces rediscovered",
    "start": "4799360",
    "end": "4806000"
  },
  {
    "text": "and well of course you provided the password so you can tell into it work to",
    "start": "4806000",
    "end": "4812280"
  },
  {
    "text": "do as you see there is lots of value guess works lots of value guess works um",
    "start": "4812280",
    "end": "4820000"
  },
  {
    "text": "for the OPF overflow you need about six values known it's well way",
    "start": "4820000",
    "end": "4828000"
  },
  {
    "text": "um far away from being as stable as like a to SSH exploit",
    "start": "4828000",
    "end": "4833679"
  },
  {
    "text": "it's really more in a lab environment and will not lead to a Cisco IOS warm",
    "start": "4833679",
    "end": "4840320"
  },
  {
    "text": "published tomorrow i wouldn't know about that um so we have to map commonly used",
    "start": "4840320",
    "end": "4847640"
  },
  {
    "text": "addresses find better ways than um doing this previous pointer guess work after",
    "start": "4847640",
    "end": "4854560"
  },
  {
    "text": "overflowing um and basically produce stable exploits",
    "start": "4854560",
    "end": "4860320"
  },
  {
    "text": "maybe stack based could be there are stackbased issues in iOS",
    "start": "4860320",
    "end": "4867199"
  },
  {
    "text": "um I used to say there aren't but people way brighter than I am",
    "start": "4867199",
    "end": "4873040"
  },
  {
    "text": "um slapped me in the face and said \"Well look here is one so forget what I said",
    "start": "4873040",
    "end": "4879440"
  },
  {
    "text": "there are stack based problems in iOS and it's probably going to be",
    "start": "4879440",
    "end": "4884600"
  },
  {
    "text": "easier.\" The other thing is NVRAM and config sometimes it's stored on Flash so",
    "start": "4884600",
    "end": "4890880"
  },
  {
    "text": "um you want to write on flash chips instead of NVRAM that's easy just get",
    "start": "4890880",
    "end": "4895920"
  },
  {
    "text": "the manual anti-forensics code kind of like funny write some some funny error",
    "start": "4895920",
    "end": "4901280"
  },
  {
    "text": "message in NVRAM and reboot the box if someone is really trying to do router",
    "start": "4901280",
    "end": "4906679"
  },
  {
    "text": "forensics he will figure out that the broken interface was the problem because",
    "start": "4906679",
    "end": "4912320"
  },
  {
    "text": "the NVMA says so or do like shell code that actually real time modifies the",
    "start": "4912320",
    "end": "4918600"
  },
  {
    "text": "configuration takes off all the access list bindings and makes your router really just route and and not",
    "start": "4918600",
    "end": "4925639"
  },
  {
    "text": "firewall probably all kinds of stuff possible so what's what's the",
    "start": "4925639",
    "end": "4931639"
  },
  {
    "text": "point well first of all just because it's black box it doesn't mean you cannot exploit",
    "start": "4931639",
    "end": "4938199"
  },
  {
    "text": "it second um most iOS heap overflows are actually exploitable if you go to",
    "start": "4938199",
    "end": "4945159"
  },
  {
    "text": "cisco.com got a account log in check the buck database you can actually query",
    "start": "4945159",
    "end": "4950880"
  },
  {
    "text": "around find lots of issues in different iOS versions that are exploitable just by querying the buck",
    "start": "4950880",
    "end": "4957480"
  },
  {
    "text": "database protocol- based exploitation we just saw two examples of that um debug",
    "start": "4957480",
    "end": "4963199"
  },
  {
    "text": "based kind of funny because the debug messages if you debug something on the",
    "start": "4963199",
    "end": "4968239"
  },
  {
    "text": "console or on the tnet um the debug messages seem to have a fixed size",
    "start": "4968239",
    "end": "4973800"
  },
  {
    "text": "buffer where the string is built in um if you overflow that buffer by providing",
    "start": "4973800",
    "end": "4980080"
  },
  {
    "text": "some long data and saying debug this and app protocol and this app protocol had a",
    "start": "4980080",
    "end": "4985199"
  },
  {
    "text": "real long string in there um it often overrides a buffer in heap by building",
    "start": "4985199",
    "end": "4991920"
  },
  {
    "text": "this debug output kind of funny and well at the end of the day nobody updates",
    "start": "4991920",
    "end": "4998400"
  },
  {
    "text": "their router so if you write an exploit for 11.1 you probably still get half of your company",
    "start": "4998400",
    "end": "5005520"
  },
  {
    "text": "and if you do this NVRAM invalidation thing well it still contains all the",
    "start": "5005520",
    "end": "5011280"
  },
  {
    "text": "passwords that are probably the same all over the campus for routers they all have the same enable password and all",
    "start": "5011280",
    "end": "5017040"
  },
  {
    "text": "have the same tent password and those are heavily encrypted does everyone know that this was a",
    "start": "5017040",
    "end": "5023480"
  },
  {
    "text": "joke no um there is actually two different encryptions um one is real MD5",
    "start": "5023480",
    "end": "5029360"
  },
  {
    "text": "which is called enable secret but mostly used and for tnet password you're not",
    "start": "5029360",
    "end": "5034960"
  },
  {
    "text": "even I don't think you're even able to do it otherwise um there is this Cisco",
    "start": "5034960",
    "end": "5040960"
  },
  {
    "text": "password type 7 encryption which is just a silly X or with a known string that",
    "start": "5040960",
    "end": "5046719"
  },
  {
    "text": "sometimes someone found so um if you see that you just grab your mobile phone",
    "start": "5046719",
    "end": "5051840"
  },
  {
    "text": "surf to our web page and like enter the string and instantly get the password",
    "start": "5051840",
    "end": "5058560"
  },
  {
    "text": "free service okay how to protect well first",
    "start": "5058560",
    "end": "5065280"
  },
  {
    "text": "of all do not rely on one type of device for protection if everything in your shop says Cisco you're toast if",
    "start": "5065280",
    "end": "5073120"
  },
  {
    "text": "everything in your shop says Checkpoint you're toast as well layered security welcome in the world of",
    "start": "5073120",
    "end": "5080560"
  },
  {
    "text": "layered security it is important on your network to have different things i'm not",
    "start": "5080560",
    "end": "5087679"
  },
  {
    "text": "saying um you should get a zoo and every possible router on the planet let me",
    "start": "5087679",
    "end": "5092800"
  },
  {
    "text": "tell you um most other routers are even worse but a little bit of like",
    "start": "5092800",
    "end": "5100280"
  },
  {
    "text": "multiculture thing two different routers or at least two different firewall brands would be cool um consider all",
    "start": "5100280",
    "end": "5107600"
  },
  {
    "text": "your worked equipment vulnerable at some point in time some sick German dude will come along look at",
    "start": "5107600",
    "end": "5114400"
  },
  {
    "text": "the thing see oh look a buffer overflow spend some time on it and write shell code for it just because it's small it",
    "start": "5114400",
    "end": "5122320"
  },
  {
    "text": "does not mean nobody's going to be interested in hacking it and I mean one",
    "start": "5122320",
    "end": "5128400"
  },
  {
    "text": "of the oldest things device management is not good by TNET do not tell net to",
    "start": "5128400",
    "end": "5135440"
  },
  {
    "text": "your routers everyone can read it so HP specific how do we secure those",
    "start": "5135440",
    "end": "5143679"
  },
  {
    "text": "funny printers well set an admin password set",
    "start": "5143679",
    "end": "5148719"
  },
  {
    "text": "SNMP read and write community really set it don't leave it at public and",
    "start": "5148719",
    "end": "5154520"
  },
  {
    "text": "private um well at the PGL protection at least it gives you about 5 hours",
    "start": "5154520",
    "end": "5161199"
  },
  {
    "text": "you got about five hours left before you discover that well someone broke into your printer um only allow access to the",
    "start": "5161199",
    "end": "5169120"
  },
  {
    "text": "app socket port from print servers if the only thing talking to your printer",
    "start": "5169120",
    "end": "5174159"
  },
  {
    "text": "is your print server there is no reason someone else is doing and I mean",
    "start": "5174159",
    "end": "5179239"
  },
  {
    "text": "seriously if it's critical if it's the CEO's printer and he's the only guy",
    "start": "5179239",
    "end": "5184920"
  },
  {
    "text": "printing there are things like LPT cables just because it got a network",
    "start": "5184920",
    "end": "5191360"
  },
  {
    "text": "interface it doesn't mean you're forced to use it i mean you got the choice either buying",
    "start": "5191360",
    "end": "5197920"
  },
  {
    "text": "a firewall for your printers and sitting in front of the printers so only the CEO can print or buy yourself an LPT cable",
    "start": "5197920",
    "end": "5206320"
  },
  {
    "text": "and connected to the CEO's machine that's what they are for and they still exist believe",
    "start": "5206320",
    "end": "5213480"
  },
  {
    "text": "me also remove this um CS config loader",
    "start": "5213480",
    "end": "5218560"
  },
  {
    "text": "entry use our tool go to the printer get down the CS config remove the whole",
    "start": "5218560",
    "end": "5224320"
  },
  {
    "text": "entry about the loader put CS config back on no more",
    "start": "5224320",
    "end": "5229480"
  },
  {
    "text": "loader well or as I said buy a firewall for printers i might actually selling",
    "start": "5229480",
    "end": "5236679"
  },
  {
    "text": "some um how to protect in Cisco well this is more like a joke but",
    "start": "5236679",
    "end": "5242880"
  },
  {
    "text": "I couldn't save myself from saying that just have no overflows in iOS anyone",
    "start": "5242880",
    "end": "5248719"
  },
  {
    "text": "here from Cisco no well if you know someone get the message out stop copying stuff in",
    "start": "5248719",
    "end": "5255360"
  },
  {
    "text": "buffers that's not big enough um keep your iOS up to date that's a joke as",
    "start": "5255360",
    "end": "5261280"
  },
  {
    "text": "well because if you keep your iOS up to date you got more functionality bugs in than you get security bugs out and you",
    "start": "5261280",
    "end": "5268560"
  },
  {
    "text": "constantly need new hardware because it constantly needs more memory more here more this more that and well Steve",
    "start": "5268560",
    "end": "5277280"
  },
  {
    "text": "probably agrees the latest and best iOS version is mostly the one that has the",
    "start": "5277280",
    "end": "5282639"
  },
  {
    "text": "lowest uptime yeah so this is just the oldest message in",
    "start": "5282639",
    "end": "5291280"
  },
  {
    "text": "security after someone invented passwords do not run services you do not",
    "start": "5291280",
    "end": "5298679"
  },
  {
    "text": "need okay if you need a service use authentication",
    "start": "5298679",
    "end": "5305000"
  },
  {
    "text": "copf it wouldn't work if you have MD5",
    "start": "5305000",
    "end": "5310120"
  },
  {
    "text": "authentication well you can put this this signature here in your network-based IDs it or split it in the",
    "start": "5310120",
    "end": "5318400"
  },
  {
    "text": "middle it will at least see if something that looks like an iOS memory block comes across and well ring a bell or",
    "start": "5318400",
    "end": "5325840"
  },
  {
    "text": "whatever your IDs usually does um there is an undocumented com uh command for iOS that",
    "start": "5325840",
    "end": "5333360"
  },
  {
    "text": "says debug sanity um it's actually it should be called debug insanity but um",
    "start": "5333360",
    "end": "5341520"
  },
  {
    "text": "it really checks the memory blocks a little bit more in depth and a little bit more",
    "start": "5341520",
    "end": "5346600"
  },
  {
    "text": "frequent so um if someone is trying to exploit your Cisco you probably notice",
    "start": "5346600",
    "end": "5353040"
  },
  {
    "text": "it unfortunately this one kicks off after it happened so when everything is",
    "start": "5353040",
    "end": "5359280"
  },
  {
    "text": "lost you at least know there is the absolute hard way",
    "start": "5359280",
    "end": "5364480"
  },
  {
    "text": "saying config register zero the config register decides on how to boot and what",
    "start": "5364480",
    "end": "5370080"
  },
  {
    "text": "to boot when it's set to zero it doesn't boot it hangs in ROM one problem is if",
    "start": "5370080",
    "end": "5376320"
  },
  {
    "text": "you don't document this well and your router is a little bit away and the next administrator comes along and says \"Oh",
    "start": "5376320",
    "end": "5383040"
  },
  {
    "text": "okay i changed this I changed that i have to reload the router.\" Then you get out the car keys and a map give it to",
    "start": "5383040",
    "end": "5389280"
  },
  {
    "text": "the admin and say bye-bye go right to the router because it's not going going to come back up you need console",
    "start": "5389280",
    "end": "5397400"
  },
  {
    "text": "connection oh by the way please stop hanging terminal servers in the same",
    "start": "5397400",
    "end": "5403280"
  },
  {
    "text": "network the Cisco hang on and like not password protect them it's nothing like",
    "start": "5403280",
    "end": "5409600"
  },
  {
    "text": "talenting to the terminal server to some high port and finding yourself being enabled on the router you can save",
    "start": "5409600",
    "end": "5415360"
  },
  {
    "text": "yourself a serious amount of time he hacking those things just by like terminating to the IP next to it which",
    "start": "5415360",
    "end": "5421360"
  },
  {
    "text": "is the terminal server connected to it um perform logging on a separate segment",
    "start": "5421360",
    "end": "5426880"
  },
  {
    "text": "as I said the SIS lock messages are highly variable and well protect the SIS lock host if someone's breaking into",
    "start": "5426880",
    "end": "5433040"
  },
  {
    "text": "your SIS lock host well happy hacking that's pretty much it um this is",
    "start": "5433040",
    "end": "5439360"
  },
  {
    "text": "like some of the final members if you ever meet them so you recognize them",
    "start": "5439360",
    "end": "5444679"
  },
  {
    "text": "um that's pretty much it uh any questions please tell me there are questions",
    "start": "5444679",
    "end": "5452360"
  },
  {
    "text": "one question all",
    "start": "5452360",
    "end": "5459840"
  },
  {
    "text": "asleep okay then no questions um you're probably just not asking questions",
    "start": "5460520",
    "end": "5465760"
  },
  {
    "text": "because there's coffee out there um yeah thanks for listening and I hope you enjoyed it",
    "start": "5465760",
    "end": "5473719"
  }
]