[
  {
    "start": "0",
    "end": "41000"
  },
  {
    "text": "welcome to this um sceta Workshop which is called industrial Control Systems",
    "start": "160",
    "end": "5440"
  },
  {
    "text": "pesting plcs 101 so just a quick reminder that means",
    "start": "5440",
    "end": "11480"
  },
  {
    "text": "that it's going to be an IND introductory class um do not expect any",
    "start": "11480",
    "end": "16760"
  },
  {
    "text": "OD days this afternoon uh the goal is to give you some knowledge about how you can pentest those devices what what is",
    "start": "16760",
    "end": "24119"
  },
  {
    "text": "specific to those devices what can what attack techniques you can use so",
    "start": "24119",
    "end": "30039"
  },
  {
    "text": "basically that's the point um I'm sorry we start a bit late but we have some issues with the let's say the hardware",
    "start": "30039",
    "end": "36719"
  },
  {
    "text": "that I bring some things broke during the during the the travel uh just uh 10 seconds about me my",
    "start": "36719",
    "end": "45680"
  },
  {
    "start": "41000",
    "end": "93000"
  },
  {
    "text": "name is Aros suier uh I'm French I work at solam which is a French management",
    "start": "45680",
    "end": "50719"
  },
  {
    "text": "and IT consulting obviously I work in the it part um what are my interests um I work",
    "start": "50719",
    "end": "58120"
  },
  {
    "text": "in security mostly at the as a tester so I perform all kind of uh web application",
    "start": "58120",
    "end": "63640"
  },
  {
    "text": "penetration test Network penetration test thick clients and also uh industrial Control",
    "start": "63640",
    "end": "70159"
  },
  {
    "text": "Systems um I have a specific interest in Windows Active Directory issues uh I",
    "start": "70159",
    "end": "76000"
  },
  {
    "text": "gave a talk at the French uh security conference earlier this year so that there's actually actually um a mistake",
    "start": "76000",
    "end": "82560"
  },
  {
    "text": "on the slide it's it was this year not last year and uh also I like wine a lot",
    "start": "82560",
    "end": "89240"
  },
  {
    "text": "but this top topic will not be covered today um okay so this is a workshop so I",
    "start": "89240",
    "end": "96360"
  },
  {
    "start": "93000",
    "end": "143000"
  },
  {
    "text": "expect you to ask all the question you want uh during the workshop no need to wait until the",
    "start": "96360",
    "end": "101759"
  },
  {
    "text": "end uh there's going to be two parts um the first one would be about uh let's",
    "start": "101759",
    "end": "107479"
  },
  {
    "text": "say an introduction to IC so it's going to be uh mostly slides and in the second",
    "start": "107479",
    "end": "112920"
  },
  {
    "text": "part um I will give you a virtual machine with some exercises to do uh",
    "start": "112920",
    "end": "118360"
  },
  {
    "text": "firstly on simulators and in a second time we're going to try to uh access those devices and try to um understand",
    "start": "118360",
    "end": "126280"
  },
  {
    "text": "how we can p them uh so I will give give you USB Keys um it's um virtual box",
    "start": "126280",
    "end": "134120"
  },
  {
    "text": "virtual machine which is C Linux uh I think most of you should be familiar",
    "start": "134120",
    "end": "139280"
  },
  {
    "text": "with this uh Linux distribution it's used for penetration testing uh I put some additional tools",
    "start": "139280",
    "end": "147000"
  },
  {
    "start": "143000",
    "end": "223000"
  },
  {
    "text": "uh specific to the ICS so you will find modp MBT get PLC scan snap 7 and also",
    "start": "147000",
    "end": "153560"
  },
  {
    "text": "some uh metas spit modules and also some uh piap samples",
    "start": "153560",
    "end": "159480"
  },
  {
    "text": "and some script that I wrote so I have the USB key just here um what I suggest",
    "start": "159480",
    "end": "167760"
  },
  {
    "text": "is that you copy the the virtual machine and you try to install it during the first part so when you come back after",
    "start": "167760",
    "end": "173440"
  },
  {
    "text": "the break uh everything works",
    "start": "173440",
    "end": "177840"
  },
  {
    "text": "I'm low on USB keys but uh please share it with your neighbors",
    "start": "186640",
    "end": "192319"
  },
  {
    "text": "don't okay there you go",
    "start": "192319",
    "end": "201319"
  },
  {
    "text": "yeah that's a bit",
    "start": "218239",
    "end": "221360"
  },
  {
    "start": "223000",
    "end": "464000"
  },
  {
    "text": "sexier okay so as I told you uh there would be two part one mostly with the slid it's going to be the IC",
    "start": "223560",
    "end": "230080"
  },
  {
    "text": "introduction and uh some specific uh knowledge about the modb protocol and",
    "start": "230080",
    "end": "235480"
  },
  {
    "text": "then the last part attacking plcs um so I'm going to give you a quick word about",
    "start": "235480",
    "end": "242159"
  },
  {
    "text": "what a PLC is right now so here we have two different models this one is from cement this one is from uh",
    "start": "242159",
    "end": "250120"
  },
  {
    "text": "Schneider and uh those little devices are used in most of the plants or factory to allow automation uh of the",
    "start": "251519",
    "end": "259239"
  },
  {
    "text": "process so depending on um of the inputs uh the value of some sensors that will",
    "start": "259239",
    "end": "265440"
  },
  {
    "text": "process this information and per perform um some kind of action with their",
    "start": "265440",
    "end": "270800"
  },
  {
    "text": "outputs basically okay so let's start with the",
    "start": "270800",
    "end": "275960"
  },
  {
    "text": "introduction what is an industrial control uh system and",
    "start": "275960",
    "end": "281120"
  },
  {
    "text": "ICS um so it's let's say it's divided in several parts um the lowest level one is",
    "start": "281120",
    "end": "287840"
  },
  {
    "text": "what we call the the production Network on which you can find uh sensors and",
    "start": "287840",
    "end": "293639"
  },
  {
    "text": "actuators uh which are basically the inputs and outputs of the plcs",
    "start": "293639",
    "end": "299840"
  },
  {
    "text": "you can find some Wireless N networks uh most of the time uh it's a let's say a",
    "start": "299840",
    "end": "305440"
  },
  {
    "text": "classical Wi-Fi network uh Sometimes some specific uh proprietary tools can",
    "start": "305440",
    "end": "312240"
  },
  {
    "text": "be used also we can also find some rtus which means a remote terminal units and",
    "start": "312240",
    "end": "318520"
  },
  {
    "text": "it's used to remotely access um it's kind of a PLC but meant to be used",
    "start": "318520",
    "end": "326720"
  },
  {
    "text": "remotely um then we have the supervision Network that's may also be called the",
    "start": "326720",
    "end": "331960"
  },
  {
    "text": "the scada network on which uh you can find um workstation with the supervision",
    "start": "331960",
    "end": "339000"
  },
  {
    "text": "uh software installed so this uh is where the operators the people working",
    "start": "339000",
    "end": "344400"
  },
  {
    "text": "at the plant or the factory uh let's say they um they manage the",
    "start": "344400",
    "end": "350120"
  },
  {
    "text": "process you can also find some uh kind of laptops used for maintenance for",
    "start": "350120",
    "end": "355800"
  },
  {
    "text": "example the people working take the laptop with them and they connect directly to the plcs or to other kind of",
    "start": "355800",
    "end": "361520"
  },
  {
    "text": "device on the field and of course you have some servers uh some are dedicated to the to",
    "start": "361520",
    "end": "367919"
  },
  {
    "text": "the scatter supervision software that you use and uh some server are quite specific and are called Data historian",
    "start": "367919",
    "end": "375000"
  },
  {
    "text": "uh their purpose is to store all the data from the process at all the time in",
    "start": "375000",
    "end": "380560"
  },
  {
    "text": "order to be uh let's say analyzed later so what we call IC is basically uh",
    "start": "380560",
    "end": "387520"
  },
  {
    "text": "the production Network and the supervision Network most of the time everything is somehow",
    "start": "387520",
    "end": "394919"
  },
  {
    "text": "connected to the corporate Network where you can find uh let's say all your application the user users's",
    "start": "394919",
    "end": "401759"
  },
  {
    "text": "workstation um because most of the time um some data needs to be uh taken off",
    "start": "401759",
    "end": "408680"
  },
  {
    "text": "the supervision Network for example from the data historian and to be fed into some specific application in the",
    "start": "408680",
    "end": "414560"
  },
  {
    "text": "corporate Network for example uh in acap or any other kind of",
    "start": "414560",
    "end": "420039"
  },
  {
    "text": "Erp uh that allows the people to let's say try to have um to um to have a",
    "start": "420039",
    "end": "427039"
  },
  {
    "text": "better process to uh to me let's say to to be more",
    "start": "427039",
    "end": "433038"
  },
  {
    "text": "efficient so as a conclusion on this slide um basically what I would like to",
    "start": "433199",
    "end": "438879"
  },
  {
    "text": "say that you have to understand that corporate information system only handles data whereas uh what we call an",
    "start": "438879",
    "end": "445759"
  },
  {
    "text": "IC uh actually interfaces the data with the physical world so that means if you",
    "start": "445759",
    "end": "450800"
  },
  {
    "text": "perform you send some packets uh some real things will happen in the physical",
    "start": "450800",
    "end": "456039"
  },
  {
    "text": "world that may be a a light that will be um switched on on or off or any kind of",
    "start": "456039",
    "end": "463039"
  },
  {
    "text": "physical action uh next just uh a bit of",
    "start": "463039",
    "end": "468360"
  },
  {
    "start": "464000",
    "end": "534000"
  },
  {
    "text": "vocabulary because I think it's important um IC stands for industrial",
    "start": "468360",
    "end": "473560"
  },
  {
    "text": "control system I'm going to say that uh at least a thousand times this afternoon",
    "start": "473560",
    "end": "478720"
  },
  {
    "text": "uh it's quite it's exactly the same as iacs which means Industrial Automation",
    "start": "478720",
    "end": "484039"
  },
  {
    "text": "and control system and as we saw earlier it's quite different as from uh scada which means",
    "start": "484039",
    "end": "491080"
  },
  {
    "text": "supervisory control and data acquisition because uh scada is only one",
    "start": "491080",
    "end": "496159"
  },
  {
    "text": "part of the the let's say dics and it's also different from DCS which is another",
    "start": "496159",
    "end": "502919"
  },
  {
    "text": "kind of uh let's say um process um um",
    "start": "502919",
    "end": "508560"
  },
  {
    "text": "plan processing uh however what is also important to know uh today uh most people tend to say",
    "start": "508560",
    "end": "515200"
  },
  {
    "text": "SCA for ICS so uh if you encounter one of your client that says you want um",
    "start": "515200",
    "end": "521880"
  },
  {
    "text": "scatter assessment uh that could mean anything from the ICS that can be the the plcs the production Network or only",
    "start": "521880",
    "end": "528760"
  },
  {
    "text": "the supervision software uh that's let's say the the trend",
    "start": "528760",
    "end": "534920"
  },
  {
    "start": "534000",
    "end": "589000"
  },
  {
    "text": "today okay if I continue um I will detail the let's say the role of the key",
    "start": "535880",
    "end": "541800"
  },
  {
    "text": "components that we can find in an ICS uh please feel free to uh to interrupt me",
    "start": "541800",
    "end": "547079"
  },
  {
    "text": "if I forget something or if you know any kind of uh device that you can find so the first kind of device is what",
    "start": "547079",
    "end": "555040"
  },
  {
    "text": "I called earlier the sensors and the actuators so as I told you um these are",
    "start": "555040",
    "end": "561079"
  },
  {
    "text": "the the most lowlevel things you can find so uh basically what we call a um a",
    "start": "561079",
    "end": "567440"
  },
  {
    "text": "sensor could be uh some kind of switch like this one and an actuator is",
    "start": "567440",
    "end": "572800"
  },
  {
    "text": "something that performs an action depending on the on the information that is sent to him so on this picture you",
    "start": "572800",
    "end": "579440"
  },
  {
    "text": "have a valve so let's say you send some electric signal to the valve and it shuts or uh shuts off the valve or maybe",
    "start": "579440",
    "end": "587079"
  },
  {
    "text": "it opens it next type of thing you can encounter",
    "start": "587079",
    "end": "593120"
  },
  {
    "start": "589000",
    "end": "640000"
  },
  {
    "text": "is what we call a local HMI so it means human machine interface so",
    "start": "593120",
    "end": "599519"
  },
  {
    "text": "over here we have one from uh cement so",
    "start": "599519",
    "end": "604800"
  },
  {
    "text": "let's say most of the time the the plants or the factory are quite big so the people are uh performing the",
    "start": "604800",
    "end": "610120"
  },
  {
    "text": "supervision from one um one Central room but they also need to have some information where when they are on the",
    "start": "610120",
    "end": "616880"
  },
  {
    "text": "field so near the the process so in most of the plants you can find those tiny screens uh sometimes they are touch",
    "start": "616880",
    "end": "623839"
  },
  {
    "text": "screen sometimes there is only some buttons it allows The Operators to have some",
    "start": "623839",
    "end": "629880"
  },
  {
    "text": "uh let's say um some information about what is going on or maybe before doing some kind of operation they can shut",
    "start": "629880",
    "end": "636519"
  },
  {
    "text": "down the process locally um so that's quite important plc's which are uh let's say",
    "start": "636519",
    "end": "643399"
  },
  {
    "start": "640000",
    "end": "678000"
  },
  {
    "text": "the subject of today that means programmable logic controll it manage all the sensors and the",
    "start": "643399",
    "end": "649839"
  },
  {
    "text": "actuators uh so for example on the on the picture it's also a PLC from Schneider um if we take a look here at",
    "start": "649839",
    "end": "657760"
  },
  {
    "text": "at this PLC uh you will see that um uh I'll come back to that later but just",
    "start": "657760",
    "end": "663639"
  },
  {
    "text": "quickly you can see that there is the power that's uh what we call the CPU so it processes the information and then we",
    "start": "663639",
    "end": "669680"
  },
  {
    "text": "have an input output uh card that allows to interact with the sensors and the",
    "start": "669680",
    "end": "675079"
  },
  {
    "text": "actuators that I mentioned supervision screen uh so as I",
    "start": "675079",
    "end": "682880"
  },
  {
    "start": "678000",
    "end": "704000"
  },
  {
    "text": "just uh told you um most of the Supervision in the plant of factory is done from u a big Ro where you have",
    "start": "682880",
    "end": "690639"
  },
  {
    "text": "those kind of big screen with the green or red light depending of on how the process goes uh so that allows the",
    "start": "690639",
    "end": "698480"
  },
  {
    "text": "people to have a high level uh overview of the how the the plant or the factory",
    "start": "698480",
    "end": "703880"
  },
  {
    "text": "is going and then again data historian that's a server so I didn't put any",
    "start": "703880",
    "end": "709880"
  },
  {
    "start": "704000",
    "end": "736000"
  },
  {
    "text": "picture of server but more a picture of data uh it recalls all the data from the production networks and allow this data",
    "start": "709880",
    "end": "717200"
  },
  {
    "text": "to be sometimes forwarded to the corporate Network where when the people",
    "start": "717200",
    "end": "722560"
  },
  {
    "text": "crunch all these data to um let's say to try to make the process more efficient",
    "start": "722560",
    "end": "728279"
  },
  {
    "text": "or in case of incident if something goes bad they can analyze the data and see uh",
    "start": "728279",
    "end": "733720"
  },
  {
    "text": "where the problem came from any questions so far okay um next",
    "start": "733720",
    "end": "743279"
  },
  {
    "start": "736000",
    "end": "756000"
  },
  {
    "text": "um let's say um a security awareness timeline from scada systems I think it's",
    "start": "743279",
    "end": "749639"
  },
  {
    "text": "important to to understand uh that's quite a a big shift nowadays in SC",
    "start": "749639",
    "end": "755880"
  },
  {
    "text": "awareness so before uh 2011 let's say uh nobody cared about scada security that's",
    "start": "755880",
    "end": "762120"
  },
  {
    "start": "756000",
    "end": "779000"
  },
  {
    "text": "mostly right uh except from specific Industries maybe in the nuclear",
    "start": "762120",
    "end": "767839"
  },
  {
    "text": "production they were doing some security but most of my clients never asked or",
    "start": "767839",
    "end": "773160"
  },
  {
    "text": "never mentioned the SK the security of IC before that uh before uh 2011",
    "start": "773160",
    "end": "780040"
  },
  {
    "start": "779000",
    "end": "805000"
  },
  {
    "text": "then uh oh my God STX net uh of course uh that was kind of a big deal because",
    "start": "780040",
    "end": "785480"
  },
  {
    "text": "it made it to the news uh and not only the specific it or security uh newspaper",
    "start": "785480",
    "end": "791440"
  },
  {
    "text": "it was all over the place so that was at least for me and for my company quite of",
    "start": "791440",
    "end": "796720"
  },
  {
    "text": "a game changer because we were asked a lot for IC assessments and for let's say IC",
    "start": "796720",
    "end": "805399"
  },
  {
    "start": "805000",
    "end": "818000"
  },
  {
    "text": "consuling and maybe one day uh as we do today for for some of the corporate networks we'll have some fancy dashboard",
    "start": "805399",
    "end": "812360"
  },
  {
    "text": "that uh truly means nothing about the security level but at least you have you have",
    "start": "812360",
    "end": "818279"
  },
  {
    "start": "818000",
    "end": "1351000"
  },
  {
    "text": "something okay um so let's continue and",
    "start": "819800",
    "end": "824920"
  },
  {
    "text": "um let's try to find out uh what is wrong currently with the level uh of",
    "start": "824920",
    "end": "830480"
  },
  {
    "text": "security of IC uh so that's mainly based on what I've seen uh please feel free to join in",
    "start": "830480",
    "end": "836519"
  },
  {
    "text": "the conversation and add some things or tell me if I'm wrong um so well the first part would be",
    "start": "836519",
    "end": "843720"
  },
  {
    "text": "awareness and organization from what I've been able to see um most of the",
    "start": "843720",
    "end": "849120"
  },
  {
    "text": "time there is no security awareness uh for people working in the ICS field um",
    "start": "849120",
    "end": "854959"
  },
  {
    "text": "they care about safety which means uh the safety of the the people working in the factory the safety of the people",
    "start": "854959",
    "end": "861240"
  },
  {
    "text": "leaving nearby the factory and also they try not to pollute the environment but",
    "start": "861240",
    "end": "867120"
  },
  {
    "text": "that's what we call safety and it's quite different from security um so they they think a lot",
    "start": "867120",
    "end": "873440"
  },
  {
    "text": "about what could go wrong in the process in terms of the safety of the people but they really not take into account the",
    "start": "873440",
    "end": "880920"
  },
  {
    "text": "fact that someone could maybe remotely access the IC and do some bad things",
    "start": "880920",
    "end": "886839"
  },
  {
    "text": "also it's kind of hard to find uh someone to talk to uh concerning security when you visit the plant or a",
    "start": "886839",
    "end": "893560"
  },
  {
    "text": "factory so in corporate networks most of the time we have uh Chief Information uh",
    "start": "893560",
    "end": "899279"
  },
  {
    "text": "uh security officers that's not the case for most ICS locally on the plant of",
    "start": "899279",
    "end": "904519"
  },
  {
    "text": "Factory uh sometimes only a few people are knowledgeable about it and that",
    "start": "904519",
    "end": "909600"
  },
  {
    "text": "doesn't not include security so that's also kind of a a very big",
    "start": "909600",
    "end": "917120"
  },
  {
    "text": "deal next subject the network segmentation um we're going to Deep dive",
    "start": "918399",
    "end": "925800"
  },
  {
    "text": "in that later but let's say that uh from I've been able to see most of the time",
    "start": "925800",
    "end": "931519"
  },
  {
    "text": "as I told you some data needs to get out of the IC to be fed into uh some kind of",
    "start": "931519",
    "end": "937720"
  },
  {
    "text": "network applications most of the time it's done wrongly uh that means that sometimes you",
    "start": "937720",
    "end": "945240"
  },
  {
    "text": "put some IC devices on the internet that means that sometimes um all your",
    "start": "945240",
    "end": "951519"
  },
  {
    "text": "corporate Network can access all the uh let's say web interfaces of all you ICS",
    "start": "951519",
    "end": "957440"
  },
  {
    "text": "so when we're talking about big companies that have maybe U 100,000 employees that's too much",
    "start": "957440",
    "end": "965519"
  },
  {
    "text": "clearly um sometimes the network segmentation is only done using um let's say some Access",
    "start": "965519",
    "end": "972199"
  },
  {
    "text": "Control list on the router there is no real firewall uh there there is no real DMZ or data diod so let's say if an",
    "start": "972199",
    "end": "981920"
  },
  {
    "text": "attacker can can Bridge into your corporate Network and if there are some pentester over here I'm sure they",
    "start": "981920",
    "end": "989560"
  },
  {
    "text": "they know that it's quite easy um it's also quite easy to jump from the corporate Network to the IC Network most",
    "start": "989560",
    "end": "995839"
  },
  {
    "text": "of the time vulnerability management uh also a",
    "start": "995839",
    "end": "1001600"
  },
  {
    "text": "a Hot Topic uh let's say it's not it's not easy to do um vulnerability management right in the corporate",
    "start": "1001600",
    "end": "1008160"
  },
  {
    "text": "Network it's uh quite harder in the IC World um most of the time let's say for",
    "start": "1008160",
    "end": "1014959"
  },
  {
    "text": "the the plc's there are some security updates um so you have to update the",
    "start": "1014959",
    "end": "1020560"
  },
  {
    "text": "firmware the problem is that uh when you want to update the firmware you have to",
    "start": "1020560",
    "end": "1025640"
  },
  {
    "text": "uh turn off your industrial process for a moment so let's say you have uh 100",
    "start": "1025640",
    "end": "1031240"
  },
  {
    "text": "plcs maybe your plant needs to be shut down for one two days or maybe a week",
    "start": "1031240",
    "end": "1036360"
  },
  {
    "text": "and then that's a big loss of money most of the time they run um 24/7 so it's not",
    "start": "1036360",
    "end": "1042959"
  },
  {
    "text": "possible to apply the patch during the night as we can do in the corporate Network",
    "start": "1042959",
    "end": "1049160"
  },
  {
    "text": "so yeah patches are published but rarely applied if we talk about the let's say",
    "start": "1049200",
    "end": "1055000"
  },
  {
    "text": "the classical it component like um Windows yeah let's say Windows XP uh or",
    "start": "1055000",
    "end": "1061640"
  },
  {
    "text": "Windows 7 workstation um since the IC is not directly connected to the corporate",
    "start": "1061640",
    "end": "1068000"
  },
  {
    "text": "Network do not benefit from the wsus systems for example so yes um even the",
    "start": "1068000",
    "end": "1074679"
  },
  {
    "text": "Windows machine are mostly not patched excuse me do you have a question question uh you actually include in this",
    "start": "1074679",
    "end": "1080480"
  },
  {
    "text": "Vision also tyal structure no actually no um mostly",
    "start": "1080480",
    "end": "1087080"
  },
  {
    "text": "talking about factories and plants uh not the smart meters but I'm sure um uh",
    "start": "1087080",
    "end": "1093720"
  },
  {
    "text": "the let's say the security problems must be the same but I've never assessed security um let's say um Smart Meters so",
    "start": "1093720",
    "end": "1102159"
  },
  {
    "text": "um I really don't know but there was a great talk yesterday about that uh it",
    "start": "1102159",
    "end": "1108039"
  },
  {
    "text": "was really interesting of the yeah is basically on millions of",
    "start": "1108039",
    "end": "1116240"
  },
  {
    "text": "at the same time yeah SC problem and",
    "start": "1116240",
    "end": "1123240"
  },
  {
    "text": "solution yes but uh then you have to be sure that the let's say the update",
    "start": "1124240",
    "end": "1129960"
  },
  {
    "text": "mechanism is secured because as the the people who did the the the talk yesterday mentioned uh they they were",
    "start": "1129960",
    "end": "1136799"
  },
  {
    "text": "able to uh let's say create some kind of worm that will uh spread Itself by",
    "start": "1136799",
    "end": "1142159"
  },
  {
    "text": "modifying the firmware of each smart meter what was included in okay so",
    "start": "1142159",
    "end": "1147760"
  },
  {
    "text": "that's mostly the industrial Control Systems you can find in plants and",
    "start": "1147760",
    "end": "1153080"
  },
  {
    "text": "factories um yeah let's continue with the security protocols so as we will'll",
    "start": "1153080",
    "end": "1159120"
  },
  {
    "text": "see later with modbus most of the times there was no security included into the",
    "start": "1159120",
    "end": "1164159"
  },
  {
    "text": "protocols so that means uh no authentication uh clear text protocols",
    "start": "1164159",
    "end": "1169400"
  },
  {
    "text": "so let's say once you have uh network access you basically have uh the",
    "start": "1169400",
    "end": "1174640"
  },
  {
    "text": "possibility of doing everything that you want uh which combined to the fact that the network segmentation uh is loose uh",
    "start": "1174640",
    "end": "1182440"
  },
  {
    "text": "that's kind of a big deal um just a quick word about the",
    "start": "1182440",
    "end": "1187520"
  },
  {
    "text": "third party management um in most of plants or factories that I've been to uh",
    "start": "1187520",
    "end": "1193000"
  },
  {
    "text": "there was a lot of uh let's say specific devices managed only by a third party so",
    "start": "1193000",
    "end": "1199080"
  },
  {
    "text": "um the client had to let the third party come connect his specific computers maybe his USB key or even allow a remote",
    "start": "1199080",
    "end": "1206799"
  },
  {
    "text": "connection to that specific device or to the wall IC um to to allow remote uh",
    "start": "1206799",
    "end": "1214039"
  },
  {
    "text": "connection and debugging and if you do not agree with that then you lose the support and then uh you cannot take that",
    "start": "1214039",
    "end": "1221640"
  },
  {
    "text": "risk so that's also a big deal and the next topic is security supervision which is a Hot Topic in the",
    "start": "1221640",
    "end": "1228880"
  },
  {
    "text": "Network most of the time people try not to focus only on protection but also on",
    "start": "1228880",
    "end": "1233960"
  },
  {
    "text": "the ability of detecting any security bridge and responding to it uh funny",
    "start": "1233960",
    "end": "1239400"
  },
  {
    "text": "thing is that uh let's say ICS and scada is all about monitoring but it's monitoring a process and it's quite",
    "start": "1239400",
    "end": "1246200"
  },
  {
    "text": "different from monitoring the security of a process so the capabilities uh of",
    "start": "1246200",
    "end": "1252280"
  },
  {
    "text": "the the plc's and other device that you can find in terms of logging uh are most",
    "start": "1252280",
    "end": "1257880"
  },
  {
    "text": "of the time quite low and at the moment I've never seen someone performing a real let's say um C log on IC and",
    "start": "1257880",
    "end": "1266039"
  },
  {
    "text": "correlating the logs um I think maybe in the in a few years we can see that but",
    "start": "1266039",
    "end": "1271679"
  },
  {
    "text": "at the moment I've never seen it any question yeah are we also talking",
    "start": "1271679",
    "end": "1279080"
  },
  {
    "text": "about really small scale systems like for",
    "start": "1279080",
    "end": "1284240"
  },
  {
    "text": "example yeah but also for uh let's say private swimming pools you can find some",
    "start": "1285919",
    "end": "1292600"
  },
  {
    "text": "some private swimming pool on the internet yes um yeah that's true um",
    "start": "1292600",
    "end": "1299159"
  },
  {
    "text": "actually if we take a look at those uh devices the Schneider one is used in small factories and uh the cement is uh",
    "start": "1299159",
    "end": "1307400"
  },
  {
    "text": "let's say I'm not sure it's used in factories but that's the kind of device that I would want to put in my home because it's quite cheap and it's easy",
    "start": "1307400",
    "end": "1314360"
  },
  {
    "text": "to program it has um uh relay outputs so yes uh this talk also includes the",
    "start": "1314360",
    "end": "1321880"
  },
  {
    "text": "device that you can find at",
    "start": "1321880",
    "end": "1325279"
  },
  {
    "text": "home yes um I recently yes one of my clients not on the IC part but uh a",
    "start": "1328440",
    "end": "1334480"
  },
  {
    "text": "client recently told me that in this building uh which is um how to say that",
    "start": "1334480",
    "end": "1339600"
  },
  {
    "text": "a shared building the eating was remotely controlled by by someone from the internet so yeah I was pretty scared",
    "start": "1339600",
    "end": "1346200"
  },
  {
    "text": "for for this winter",
    "start": "1346200",
    "end": "1349919"
  },
  {
    "start": "1351000",
    "end": "1415000"
  },
  {
    "text": "okay uh next up just a quick word about the IC CT so it's a computer emergency",
    "start": "1353559",
    "end": "1359279"
  },
  {
    "text": "and response team uh that is specific to IC it's quite interesting to to take a",
    "start": "1359279",
    "end": "1365919"
  },
  {
    "text": "look at at least if you want to perform some um assessment on IC and you're",
    "start": "1365919",
    "end": "1371039"
  },
  {
    "text": "looking for vulnerability non vulnerabilities in specific components you have to go there and check uh the",
    "start": "1371039",
    "end": "1377080"
  },
  {
    "text": "vulnerability buttons um and also is that or is that Europe uh",
    "start": "1377080",
    "end": "1384000"
  },
  {
    "text": "actually the icert is for the us but the let's say most of the devices",
    "start": "1384000",
    "end": "1389799"
  },
  {
    "text": "used are the same so the vulnerabilities are the same and yeah just a quick word about",
    "start": "1389799",
    "end": "1396120"
  },
  {
    "text": "the study they published last year they listed over 200 attacks on IC and some",
    "start": "1396120",
    "end": "1402159"
  },
  {
    "text": "of them around 80 were successful so we also have to acknowledge that",
    "start": "1402159",
    "end": "1409039"
  },
  {
    "text": "um yes there are vulnerabilities and yes they are being exploited right",
    "start": "1409039",
    "end": "1414440"
  },
  {
    "start": "1415000",
    "end": "1578000"
  },
  {
    "text": "now okay so now we will uh focus a bit on what is a PLT you have a",
    "start": "1416440",
    "end": "1424880"
  },
  {
    "text": "question I think what they mean by 200 attacks is that",
    "start": "1430919",
    "end": "1436120"
  },
  {
    "text": "uh let's say somehow an in inent was detected it was not before the incident",
    "start": "1436120",
    "end": "1441559"
  },
  {
    "text": "happened it was after",
    "start": "1441559",
    "end": "1446840"
  },
  {
    "text": "yeah um okay so what is uh PLC so as I",
    "start": "1447480",
    "end": "1452640"
  },
  {
    "text": "told you before um It's Made to manage input and outputs it's some kind of",
    "start": "1452640",
    "end": "1458000"
  },
  {
    "text": "realtime computer um it's it was invented to",
    "start": "1458000",
    "end": "1463360"
  },
  {
    "text": "replace electrical relays uh because um let's say a few um thousand years ago uh",
    "start": "1463360",
    "end": "1470960"
  },
  {
    "text": "people were using electrical relays to perform the Automation in plants and and",
    "start": "1470960",
    "end": "1476159"
  },
  {
    "text": "factories but it was really expensive when you wanted to modify the process you have to rewire everything so that",
    "start": "1476159",
    "end": "1483279"
  },
  {
    "text": "was costly so that's why we invent they invented plc's and uh also last thing you have to",
    "start": "1483279",
    "end": "1490640"
  },
  {
    "text": "know these devices are uh rugged that means they work in a harsh environment",
    "start": "1490640",
    "end": "1496200"
  },
  {
    "text": "when there is dust when there is electrical no uh the temperature is not uh 18° as in a",
    "start": "1496200",
    "end": "1502279"
  },
  {
    "text": "data center so it's quite different from a computer but basically um it's a",
    "start": "1502279",
    "end": "1508720"
  },
  {
    "text": "real-time computer on the right side of the slide you can see the s7200 which is the the",
    "start": "1508720",
    "end": "1515200"
  },
  {
    "text": "the smallest uh PLC that I have you can see the inputs the outputs there is a",
    "start": "1515200",
    "end": "1520520"
  },
  {
    "text": "network connection uh for ethernet and that's the power uh if you take a look at the at",
    "start": "1520520",
    "end": "1528120"
  },
  {
    "text": "the same device but we try to look what's inside uh we see that there's the hardware on top of it there's a firmware",
    "start": "1528120",
    "end": "1536120"
  },
  {
    "text": "or an operating system for example on the Schneider uh the operating system is VX works so it's a real-time operating",
    "start": "1536120",
    "end": "1544200"
  },
  {
    "text": "system then you have some application uh most of the time you have a web server",
    "start": "1544200",
    "end": "1549399"
  },
  {
    "text": "sometimes an FTP server uh SNMP server and on the other side you have uh let's",
    "start": "1549399",
    "end": "1555200"
  },
  {
    "text": "say the the the logic that you program into your PLC and that is run through uh a",
    "start": "1555200",
    "end": "1562200"
  },
  {
    "text": "middleware uh so in the past I know that some people have discovered vulnerabilities into those middleware",
    "start": "1562200",
    "end": "1568120"
  },
  {
    "text": "and that allowed them to compromise several PLC because they all some of them rely on the same uh",
    "start": "1568120",
    "end": "1576360"
  },
  {
    "start": "1578000",
    "end": "1643000"
  },
  {
    "text": "middleway okay so to understand how a PLC works it's also interesting to know",
    "start": "1580399",
    "end": "1586480"
  },
  {
    "text": "how you program a PLC so the the first programming language that was used and that is uh still used",
    "start": "1586480",
    "end": "1593360"
  },
  {
    "text": "today is what we call the lad logic um it was called like that because it",
    "start": "1593360",
    "end": "1598679"
  },
  {
    "text": "mimics the the look of U let's say an electrical wiring diagram you can see an",
    "start": "1598679",
    "end": "1604760"
  },
  {
    "text": "example on the on the bottom left um but since then there was a",
    "start": "1604760",
    "end": "1611840"
  },
  {
    "text": "standard published that defines uh five main programming uh languages I'm not",
    "start": "1611840",
    "end": "1617320"
  },
  {
    "text": "going to detail them I'm just going to show you the example so on the left the",
    "start": "1617320",
    "end": "1622399"
  },
  {
    "text": "lad diagram which uh mimics the the let's say real devices uh then in the",
    "start": "1622399",
    "end": "1628760"
  },
  {
    "text": "middle you have the the structure text example so it's like programming uh in a",
    "start": "1628760",
    "end": "1634399"
  },
  {
    "text": "classical programming language and on the right you have the instruction list example so as you can see it looks like",
    "start": "1634399",
    "end": "1640640"
  },
  {
    "text": "a assembly uh so maybe now I'm trying to",
    "start": "1640640",
    "end": "1646600"
  },
  {
    "text": "show you uh how is program the Schneider PLC so you have a real",
    "start": "1646600",
    "end": "1653520"
  },
  {
    "text": "example um yeah I'm just going to set up my screen",
    "start": "1658520",
    "end": "1664919"
  },
  {
    "text": "can you see at least somehow uh so I'm now I'm connected to the to the PLC",
    "start": "1684279",
    "end": "1692159"
  },
  {
    "text": "the Schneider one so that's the one on top I'm going to transfer the program from the PLC to my",
    "start": "1692159",
    "end": "1697600"
  },
  {
    "text": "computer it should",
    "start": "1697600",
    "end": "1701000"
  },
  {
    "text": "work I'm sorry everything is written in French",
    "start": "1703799",
    "end": "1709200"
  },
  {
    "text": "uh when you're using that kind of software uh you have to have a big screen because there are some let's say windows everywhere uh that's by the way",
    "start": "1718960",
    "end": "1725960"
  },
  {
    "text": "that's Unity Pro that's the programming uh software that you have to use uh for",
    "start": "1725960",
    "end": "1731039"
  },
  {
    "text": "let's say most of the Schneider PLC so let's take a look at the code",
    "start": "1731039",
    "end": "1739880"
  },
  {
    "text": "it's really basic just to to show you an example um so as you can see um there",
    "start": "1741240",
    "end": "1748880"
  },
  {
    "text": "are are some lines that are green the other one are red uh basically green means electricity is flowing and red",
    "start": "1748880",
    "end": "1755880"
  },
  {
    "text": "means that's not so for example here uh one uh light is LD because uh I just put",
    "start": "1755880",
    "end": "1763840"
  },
  {
    "text": "this output to on um and the two other are are switched",
    "start": "1763840",
    "end": "1770000"
  },
  {
    "text": "off because uh light zero and light one are set to zero at the moment",
    "start": "1770000",
    "end": "1777360"
  },
  {
    "text": "um uh so basically if I just delay this",
    "start": "1777360",
    "end": "1782640"
  },
  {
    "text": "one so that's ladder logic as I was uh explaining uh",
    "start": "1784320",
    "end": "1790600"
  },
  {
    "text": "before um now I can transfer it to the to the plc",
    "start": "1792159",
    "end": "1800039"
  },
  {
    "text": "cance code directly from Yes uh mostly we will cover that in the second part of",
    "start": "1802000",
    "end": "1808279"
  },
  {
    "text": "the workshop because the way it's done by the software is quite funky um but",
    "start": "1808279",
    "end": "1816240"
  },
  {
    "text": "yes and it's absolutely not working is it ah maybe it's on",
    "start": "1820159",
    "end": "1826679"
  },
  {
    "text": "stop yes so now it's uh it's lit on because the electricity is",
    "start": "1826679",
    "end": "1832600"
  },
  {
    "text": "Flowing so I'm just going to go back to what I've done previously if I",
    "start": "1832600",
    "end": "1839200"
  },
  {
    "text": "can okay",
    "start": "1839200",
    "end": "1843200"
  },
  {
    "text": "okay so basically that was just to give you an idea how it works how it is programmed um let's say the people that",
    "start": "1862159",
    "end": "1869279"
  },
  {
    "text": "I met mostly use uh lther logic but uh I'm sure depends on the company and the",
    "start": "1869279",
    "end": "1875200"
  },
  {
    "text": "the specific policy about that uh okay so let's go back to the",
    "start": "1875200",
    "end": "1881799"
  },
  {
    "text": "slides",
    "start": "1881799",
    "end": "1884799"
  },
  {
    "text": "okay so next topic I mentioned the the lack uh the usual lack of NE Network",
    "start": "1898320",
    "end": "1904399"
  },
  {
    "text": "segmentation and I just wanted to give you some example of what a real lack of segmentation looks like that means can",
    "start": "1904399",
    "end": "1911120"
  },
  {
    "text": "we find SCA on the internet uh you may know that the answer is yes um to do that I will demonstrate",
    "start": "1911120",
    "end": "1919399"
  },
  {
    "start": "1913000",
    "end": "2021000"
  },
  {
    "text": "uh using Shodan uh I'm sure you've heard of it uh Shodan is basically um a search",
    "start": "1919399",
    "end": "1925960"
  },
  {
    "text": "engine that scans the worldall ipv4 uh addresses all the time and allows you to",
    "start": "1925960",
    "end": "1932399"
  },
  {
    "text": "uh let's say search some specific um some specific devices or some specific",
    "start": "1932399",
    "end": "1939039"
  },
  {
    "text": "versions of software so uh it's mostly free uh while",
    "start": "1939039",
    "end": "1944240"
  },
  {
    "text": "you have to pay to export all the results uh what else can I say uh yes in my",
    "start": "1944240",
    "end": "1950799"
  },
  {
    "text": "personal experience if I just buy a virtual machine on Amazon Cloud and I",
    "start": "1950799",
    "end": "1955880"
  },
  {
    "text": "start an Apache server uh within two hours it has been if you take a look at the logs within two hours it has been",
    "start": "1955880",
    "end": "1961760"
  },
  {
    "text": "scanned by shodown so that's quite efficient um of course you can find some",
    "start": "1961760",
    "end": "1967559"
  },
  {
    "text": "funny things you can find plc's like the Schneider and the cement you can find some webcams you can find some",
    "start": "1967559",
    "end": "1973960"
  },
  {
    "text": "printers uh some fridge maybe um they also have uh quite good report on IC so",
    "start": "1973960",
    "end": "1980919"
  },
  {
    "text": "uh they try to Crunch all their data to find how many IC can be reached uh from",
    "start": "1980919",
    "end": "1986760"
  },
  {
    "text": "the internet however you have to know that Shodan Works u in an opt out mode that",
    "start": "1986760",
    "end": "1993159"
  },
  {
    "text": "means uh if you are an ISP and you do not want your IP addresses to be scanned by Shodan you can ask so basically what",
    "start": "1993159",
    "end": "2000039"
  },
  {
    "text": "you can find on Shodan is not the let's say the the wall perimeter it's only what they are allowed to scan so if you",
    "start": "2000039",
    "end": "2007799"
  },
  {
    "text": "you want to do it yourself there are quite uh some tools uh zmap math scan uh",
    "start": "2007799",
    "end": "2013480"
  },
  {
    "text": "there's also French tool called uh IV and I'm sure you can find some uh other",
    "start": "2013480",
    "end": "2018840"
  },
  {
    "text": "online services that do the same that's one example I uh once saw on",
    "start": "2018840",
    "end": "2025159"
  },
  {
    "start": "2021000",
    "end": "2357000"
  },
  {
    "text": "Twitter so that was someone scanning the internet and finding uh this SC system which is actually a crematorium so that",
    "start": "2025159",
    "end": "2032320"
  },
  {
    "text": "was freely accessible and you can start the fire and everything so that's",
    "start": "2032320",
    "end": "2038320"
  },
  {
    "text": "let's say the most funny example I have but I'm going to I'm going to try to connect to showan to show you uh if you",
    "start": "2038320",
    "end": "2044720"
  },
  {
    "text": "can find some devices as the Schneider or maybe as the",
    "start": "2044720",
    "end": "2050560"
  },
  {
    "text": "seens uh just looking for my phone because I heard that the Wi-Fi is not working that well",
    "start": "2050560",
    "end": "2059079"
  },
  {
    "text": "okay let's see if it works yes so basically that's the new",
    "start": "2080760",
    "end": "2086079"
  },
  {
    "text": "version of uh showan you have a new user interface that's quite funny uh so let",
    "start": "2086079",
    "end": "2091200"
  },
  {
    "text": "me input M 340 which is uh the model of the Schneider plc",
    "start": "2091200",
    "end": "2098760"
  },
  {
    "text": "so yes they found some uh I'm going to filter by the the countries I'm going to check out the the ones in",
    "start": "2100760",
    "end": "2108079"
  },
  {
    "text": "France so there are not a lot while uh even 40 PLC is connected to the internet",
    "start": "2108079",
    "end": "2115240"
  },
  {
    "text": "is quite uh strange uh as you can see uh some in",
    "start": "2115240",
    "end": "2121680"
  },
  {
    "text": "some interesting information can be found uh using showan so you have the",
    "start": "2121680",
    "end": "2127200"
  },
  {
    "text": "name of the project and other things uh let's click on detail maybe on this",
    "start": "2127200",
    "end": "2135280"
  },
  {
    "text": "one it's random I I do not know this this one okay so the port that was scan was",
    "start": "2137599",
    "end": "2145200"
  },
  {
    "text": "uh the snmp1 so some information were uh sent back that's not really interesting",
    "start": "2145200",
    "end": "2151520"
  },
  {
    "text": "um you can find some that have modbus enabled so I'm sure you should we should",
    "start": "2151520",
    "end": "2156560"
  },
  {
    "text": "find some yes this one for example everything is",
    "start": "2156560",
    "end": "2163000"
  },
  {
    "text": "open great so you have the FTP Port so you have the list of available commands",
    "start": "2163000",
    "end": "2169440"
  },
  {
    "text": "you have the web interface we're going to take a look at that later SNMP of course and",
    "start": "2169440",
    "end": "2175359"
  },
  {
    "text": "modbus uh which allows you to have a precise version of the CPU uh as well as",
    "start": "2175359",
    "end": "2182240"
  },
  {
    "text": "uh the version of the project and um that's all so let me just see if it",
    "start": "2182240",
    "end": "2190240"
  },
  {
    "text": "works it seems to",
    "start": "2197720",
    "end": "2201400"
  },
  {
    "text": "work yeah I'm going to try another one I did not prepare that um but I was",
    "start": "2207359",
    "end": "2214200"
  },
  {
    "text": "sure to to find some um",
    "start": "2214200",
    "end": "2219520"
  },
  {
    "text": "sorry nope no",
    "start": "2222440",
    "end": "2226000"
  },
  {
    "text": "luck no this one okay so this one has even the tailet port which is great as",
    "start": "2232760",
    "end": "2238680"
  },
  {
    "text": "you can see it V works as I told you uh actually I do not know how it's",
    "start": "2238680",
    "end": "2244920"
  },
  {
    "text": "possible to have a tnet uh enabled they succeeded apparently so yes uh so",
    "start": "2244920",
    "end": "2251800"
  },
  {
    "text": "that's the real web interface of um one PLC somewhere in France I'm not going to",
    "start": "2251800",
    "end": "2257599"
  },
  {
    "text": "try to log in with the default credential I'm sure that would be pretty illegal um and I'm going to do the same",
    "start": "2257599",
    "end": "2264960"
  },
  {
    "text": "with the other kind of PLC that I have uh which is the Simon Simons",
    "start": "2264960",
    "end": "2270079"
  },
  {
    "text": "s7200 uh so yes not a lot but we can find some",
    "start": "2270079",
    "end": "2277920"
  },
  {
    "text": "with a lot of open ports as well still in France so you have FTP you have HTP that is strange uh they",
    "start": "2280079",
    "end": "2290280"
  },
  {
    "text": "must have some kind of port forwarding there because that's not the the web interface of the the cement but there is",
    "start": "2290280",
    "end": "2296800"
  },
  {
    "text": "the specific proprietary protocol uh S7 on part 102 so that's also quite",
    "start": "2296800",
    "end": "2303800"
  },
  {
    "text": "dangerous and just to finish uh this new version of Shan is quite great because",
    "start": "2303800",
    "end": "2309200"
  },
  {
    "text": "of course you can see the results on the map if you pay for it I think but you also have an exploit tab which allows",
    "start": "2309200",
    "end": "2315200"
  },
  {
    "text": "you to uh have the list of exploits that may or may not work for those kind of uh",
    "start": "2315200",
    "end": "2320359"
  },
  {
    "text": "specific devices so yeah it's really uh all inclusive",
    "start": "2320359",
    "end": "2327880"
  },
  {
    "text": "and let's go back okay so that was all for the first",
    "start": "2339240",
    "end": "2346160"
  },
  {
    "text": "part which is which was the introduction do you have any question if no we're going to switch to the second part which",
    "start": "2346160",
    "end": "2352000"
  },
  {
    "text": "is uh let a description of the modb protocol to understand how it",
    "start": "2352000",
    "end": "2357160"
  },
  {
    "text": "works um yeah that's I do not have the text on my computer so um mbus is a",
    "start": "2357599",
    "end": "2363040"
  },
  {
    "text": "Serial uh communication protocol it was invented a long time ago I think it's was",
    "start": "2363040",
    "end": "2368319"
  },
  {
    "text": "1979 by Schneider Electric um it was made specifically for",
    "start": "2368319",
    "end": "2375359"
  },
  {
    "text": "industrial uh applications and it was royaltyfree that means uh if you were",
    "start": "2375359",
    "end": "2380680"
  },
  {
    "text": "developing some uh plcs or other kind of IC component it was free to implement",
    "start": "2380680",
    "end": "2385800"
  },
  {
    "text": "mbus protocol that's why now at least in Europe and at least in France it's one",
    "start": "2385800",
    "end": "2391000"
  },
  {
    "text": "of the the most widespread uh industrial protocol it works uh in the Master Slave",
    "start": "2391000",
    "end": "2397599"
  },
  {
    "text": "mode that means uh the master has to pull the information from the slave at a",
    "start": "2397599",
    "end": "2402960"
  },
  {
    "text": "regular time um you can only have uh around 250",
    "start": "2402960",
    "end": "2410079"
  },
  {
    "text": "slaves per uh modbus master and also you have to know that uh",
    "start": "2410079",
    "end": "2416240"
  },
  {
    "text": "the data that you get is uh without any kind of context so you have to know if",
    "start": "2416240",
    "end": "2421920"
  },
  {
    "text": "you are quering a sign integer or an N sign integer because you just get the value not any kind of object or",
    "start": "2421920",
    "end": "2428720"
  },
  {
    "text": "description of the data security anyone uh no not really uh",
    "start": "2428720",
    "end": "2433960"
  },
  {
    "text": "as I told you before it's again it's the the case for most of industrial protocols so it's clear text there is uh",
    "start": "2433960",
    "end": "2440839"
  },
  {
    "text": "no kind of authentication so uh let's say if I have a cable that is plugged to",
    "start": "2440839",
    "end": "2446040"
  },
  {
    "text": "a network uh on which there is a modbus enabled device I can freely uh ask uh",
    "start": "2446040",
    "end": "2452520"
  },
  {
    "text": "for some data and also set the data um yeah so um mostly um modbus was",
    "start": "2452520",
    "end": "2462200"
  },
  {
    "start": "2455000",
    "end": "2966000"
  },
  {
    "text": "invented on serial um Proto um It Was a Serial communication protocol but now",
    "start": "2462200",
    "end": "2467880"
  },
  {
    "text": "since uh people tend to use uh classical ethernet networks in the plants there is",
    "start": "2467880",
    "end": "2473760"
  },
  {
    "text": "a modbus TCP version of the protocol uh that actually implements uh",
    "start": "2473760",
    "end": "2479720"
  },
  {
    "text": "all the same security features um so yeah it's basically the",
    "start": "2479720",
    "end": "2484839"
  },
  {
    "text": "same protocol over TCP um if we take take a look at the what the modbus TCP frame looks like uh there is a",
    "start": "2484839",
    "end": "2491480"
  },
  {
    "text": "transaction identifier uh that helps making sure that when you uh get a um a",
    "start": "2491480",
    "end": "2497599"
  },
  {
    "text": "response from the device it corresponds to which request um then you have the",
    "start": "2497599",
    "end": "2502839"
  },
  {
    "text": "protocol identifier which is not really interesting because it's zero all the time you have um a field for the length",
    "start": "2502839",
    "end": "2510560"
  },
  {
    "text": "of the remaining uh the remaining length of the packet you have the address of",
    "start": "2510560",
    "end": "2515599"
  },
  {
    "text": "the slave so as we're talking uh TCP uh there is already the IP address that is",
    "start": "2515599",
    "end": "2521960"
  },
  {
    "text": "used to know to who you're talking to so actually most of the time it's 01 or 255",
    "start": "2521960",
    "end": "2529640"
  },
  {
    "text": "that is used when uh dealing with modb TCP and then you have the function code",
    "start": "2529640",
    "end": "2535680"
  },
  {
    "text": "and the data um well okay uh now let's see which",
    "start": "2535680",
    "end": "2544520"
  },
  {
    "text": "are the most basic function that you can find in mod TCP um so there is two uh",
    "start": "2544520",
    "end": "2551280"
  },
  {
    "text": "big kind of data you have uh a coil that means a zero or one and you also have",
    "start": "2551280",
    "end": "2557079"
  },
  {
    "text": "what they call a a register that stores some kind of word uh that are 8bit Longs",
    "start": "2557079",
    "end": "2564559"
  },
  {
    "text": "so uh yeah the most basic function allow to read and write to codes and",
    "start": "2564559",
    "end": "2570400"
  },
  {
    "text": "registers uh I took this table from Wikipedia so if you want more information about what kind of function",
    "start": "2570400",
    "end": "2576079"
  },
  {
    "text": "you can find on mod go to Wikipedia it's not only read and WR there is also some",
    "start": "2576079",
    "end": "2581680"
  },
  {
    "text": "kind of diagnostic functions there you can in some cases depending on the implementation you can also read some",
    "start": "2581680",
    "end": "2588240"
  },
  {
    "text": "files from the device and of course some of the uh function codes are not",
    "start": "2588240",
    "end": "2594119"
  },
  {
    "text": "documented and are used by some manufacturer to perform some",
    "start": "2594119",
    "end": "2600280"
  },
  {
    "text": "things okay so now what we can do is try to um understand how how mbus works by",
    "start": "2601079",
    "end": "2608200"
  },
  {
    "text": "taking a look at um Network capture so did anyone uh succeed in getting the USB",
    "start": "2608200",
    "end": "2615359"
  },
  {
    "text": "key and the virtual machine take that for",
    "start": "2615359",
    "end": "2620960"
  },
  {
    "text": "yes uh",
    "start": "2620960",
    "end": "2624318"
  },
  {
    "text": "okay so if you do not know it the the account name is root and the password is",
    "start": "2633720",
    "end": "2640680"
  },
  {
    "text": "uh root reversed so that means t o o r uh",
    "start": "2640680",
    "end": "2648079"
  },
  {
    "text": "okay uh so in the files directory you should be able to find modbus one. pcap",
    "start": "2661240",
    "end": "2669039"
  },
  {
    "text": "of course you have the classical warnings because you are running wire shark as a root which is really not such",
    "start": "2672119",
    "end": "2678359"
  },
  {
    "text": "a good idea um so the the first thing we can do",
    "start": "2678359",
    "end": "2683960"
  },
  {
    "text": "is uh let's say try to filter out um only the modbus uh communication so we",
    "start": "2683960",
    "end": "2691800"
  },
  {
    "text": "can uh filter by TCP Port so the TCP Port used by modbus is",
    "start": "2691800",
    "end": "2698200"
  },
  {
    "text": "52 uh so that was pretty useless since in this precise capture I gave you only",
    "start": "2698200",
    "end": "2703599"
  },
  {
    "text": "modus um Communications but anyway you can see that we have a three-way TCP and",
    "start": "2703599",
    "end": "2709760"
  },
  {
    "text": "chake and then we have the the first modb",
    "start": "2709760",
    "end": "2714920"
  },
  {
    "text": "request so we can see that uh it complies with uh the description I made",
    "start": "2715839",
    "end": "2722280"
  },
  {
    "text": "earlier you have one transaction identifier protocol identifier zero six",
    "start": "2722280",
    "end": "2728800"
  },
  {
    "text": "remaining bytes and the unit identifier is one if we now take a look at the modb",
    "start": "2728800",
    "end": "2735079"
  },
  {
    "text": "payload uh we can see that the function code is three which means which means",
    "start": "2735079",
    "end": "2740839"
  },
  {
    "text": "reading uh registers reference number means the address of the data uh and here it is",
    "start": "2740839",
    "end": "2747920"
  },
  {
    "text": "zero so it's the the first data and we want to read uh 16 words",
    "start": "2747920",
    "end": "2755078"
  },
  {
    "text": "okay and if we take a look at the answer from the device you see that the transaction identifier is exactly the",
    "start": "2758200",
    "end": "2764760"
  },
  {
    "text": "same so that's the right answer it's actually quite longer which is a good sign because we ask for uh 16",
    "start": "2764760",
    "end": "2771960"
  },
  {
    "text": "words function code is the same and then you have uh several",
    "start": "2771960",
    "end": "2778359"
  },
  {
    "text": "values is that clear for everyone okay",
    "start": "2781240",
    "end": "2788720"
  },
  {
    "text": "um so if I go back to my slide I think I I was asking a question about uh the",
    "start": "2788720",
    "end": "2794280"
  },
  {
    "text": "value of specific value yes so in the capture you can see that there are some other requests and uh I would like to",
    "start": "2794280",
    "end": "2800760"
  },
  {
    "text": "know if you're able to tell me what's the value of the register number one two three at the end so if you can take a",
    "start": "2800760",
    "end": "2807040"
  },
  {
    "text": "look at the file capture it's quite easy you can just scroll to the end and it's",
    "start": "2807040",
    "end": "2812440"
  },
  {
    "text": "quite it's kind of the last packet I think",
    "start": "2812440",
    "end": "2817119"
  },
  {
    "text": "so as you can see uh wire shark actually has a pretty good diss sector from adus protocol so it's really easy to",
    "start": "2835400",
    "end": "2841880"
  },
  {
    "text": "understand how it works so you have several queries the",
    "start": "2841880",
    "end": "2849519"
  },
  {
    "text": "answers did somebody find the answer okay I'm just going to tell you",
    "start": "2858720",
    "end": "2865920"
  },
  {
    "text": "then um let's see",
    "start": "2865920",
    "end": "2873640"
  },
  {
    "text": " okay so here we are um as asking to read um to read some uh",
    "start": "2873640",
    "end": "2882000"
  },
  {
    "text": "value and I think that's the good one uh yeah that's actually this one and I'm",
    "start": "2882000",
    "end": "2889280"
  },
  {
    "text": "going to explain to you why if we take a look at the",
    "start": "2889280",
    "end": "2894359"
  },
  {
    "text": "query we asked to read uh some registers and the reference number was 120 so we",
    "start": "2896599",
    "end": "2903440"
  },
  {
    "text": "wanted to read 120 21 22 and 23 and if we take a look at the",
    "start": "2903440",
    "end": "2909920"
  },
  {
    "text": "answer which Bears the same uh transaction",
    "start": "2909920",
    "end": "2916240"
  },
  {
    "text": "identifier uh we can see that the value is uh 57,5 which means if you take a look on",
    "start": "2916240",
    "end": "2923200"
  },
  {
    "text": "the bottom of the screen uh at the uh EXA x value it's actually dead so that",
    "start": "2923200",
    "end": "2930160"
  },
  {
    "text": "was the answer you have to know that depending on the imple software implementation sometimes the the",
    "start": "2930160",
    "end": "2936200"
  },
  {
    "text": "register address starts at zero sometimes at one so that's also some something you can take into",
    "start": "2936200",
    "end": "2944040"
  },
  {
    "text": "account okay um I think there will be a break in about 10",
    "start": "2945200",
    "end": "2950240"
  },
  {
    "text": "minutes um if I'm not wrong so what we can do is uh do another",
    "start": "2950240",
    "end": "2957000"
  },
  {
    "text": "exercise on um on modbus this time using a m simulator uh it's",
    "start": "2957000",
    "end": "2966359"
  },
  {
    "text": "yeah so included in the virtual machine you have modbus pal that is a Java modb",
    "start": "2968559",
    "end": "2973880"
  },
  {
    "text": "simulator it allows you to let's say if you're developing some specific tools or you're trying to understand how modbus",
    "start": "2973880",
    "end": "2979440"
  },
  {
    "text": "works it's quite interesting to have a simulator because you do not have a PLC all the time uh just around so to launch",
    "start": "2979440",
    "end": "2986040"
  },
  {
    "text": "it it's quite easy you just uh go into the right uh directory which is uh tools",
    "start": "2986040",
    "end": "2992160"
  },
  {
    "text": "and then you input Jaa uh minus jar and the name of um",
    "start": "2992160",
    "end": "2997280"
  },
  {
    "text": "the program which is mod spel and I'm going to walk through walk you through",
    "start": "2997280",
    "end": "3004640"
  },
  {
    "text": "it okay so we go to the tools um directory and then we start the simulator which",
    "start": "3010720",
    "end": "3018440"
  },
  {
    "text": "actually has a nice goey yes here it",
    "start": "3018440",
    "end": "3023920"
  },
  {
    "text": "is uh next the first thing to do is to try to add some slaves because uh as I",
    "start": "3023920",
    "end": "3029960"
  },
  {
    "text": "mentioned before um each uh it's a Master Slave protocol so I'm just going",
    "start": "3029960",
    "end": "3035319"
  },
  {
    "text": "to add one slave you put any funny name that you",
    "start": "3035319",
    "end": "3041599"
  },
  {
    "text": "want okay so you can add um a second one if you want that doesn't",
    "start": "3041599",
    "end": "3048040"
  },
  {
    "text": "matter okay so let's see if I want to uh modify the values of this uh first slave",
    "start": "3050359",
    "end": "3056440"
  },
  {
    "text": "I'm I'm going to click on the big eye and then you see you have several T tabs one from the coils so I'm going to",
    "start": "3056440",
    "end": "3063559"
  },
  {
    "text": "click on ADD and then just next next next add so you see now I have um I can",
    "start": "3063559",
    "end": "3070160"
  },
  {
    "text": "modify the value of all the cods so I'm going to do it uh let's see",
    "start": "3070160",
    "end": "3076880"
  },
  {
    "text": "if I try to input five it actually inputs one since as I told you the value is zero or one for a coil and for a",
    "start": "3076880",
    "end": "3083599"
  },
  {
    "text": "register you can do the same you add and then try to modify some value depending",
    "start": "3083599",
    "end": "3089839"
  },
  {
    "text": "uh the address that you want once it's done you just close the",
    "start": "3089839",
    "end": "3095640"
  },
  {
    "text": "windows click on run and then uh you have a modbus device",
    "start": "3095640",
    "end": "3101319"
  },
  {
    "text": "listening on Local Host so that's kind of",
    "start": "3101319",
    "end": "3106040"
  },
  {
    "text": "convenient there are two tools that we're going to use uh to perform the quaries uh but maybe yeah let's say just",
    "start": "3107680",
    "end": "3114960"
  },
  {
    "text": "one before the the break uh it's um a pearl tool that is called",
    "start": "3114960",
    "end": "3120160"
  },
  {
    "text": "MBT get so if you want to take a look at the source code you",
    "start": "3120160",
    "end": "3127440"
  },
  {
    "start": "3127000",
    "end": "3462000"
  },
  {
    "text": "can uh so it's a common line tool it's quite easy to to understand it's also in",
    "start": "3128119",
    "end": "3133480"
  },
  {
    "text": "the tools directory uh if you want to perform some request you use the R1",
    "start": "3133480",
    "end": "3139040"
  },
  {
    "text": "switch um for the coils and the R3 uh switch for the words then you have to",
    "start": "3139040",
    "end": "3145079"
  },
  {
    "text": "pass uh the address address of course the number of words or coil that you",
    "start": "3145079",
    "end": "3151040"
  },
  {
    "text": "want to read so that's the end switch and then the IP",
    "start": "3151040",
    "end": "3155760"
  },
  {
    "text": "address okay let's see so I'm open up a new",
    "start": "3164760",
    "end": "3171400"
  },
  {
    "text": "tab so let's see um I will use the R1 switch to read the value of some",
    "start": "3174400",
    "end": "3181480"
  },
  {
    "text": "coil uh starting at the address zero and I want to read eight of it and then I",
    "start": "3181480",
    "end": "3188119"
  },
  {
    "text": "just input my IP address and you see that the values are",
    "start": "3188119",
    "end": "3193480"
  },
  {
    "text": "one one one and then only zeros I'm going to do a double check by looking",
    "start": "3193480",
    "end": "3198559"
  },
  {
    "text": "through the guy uh on the coils and you can see that",
    "start": "3198559",
    "end": "3204640"
  },
  {
    "text": "I have one one one and then only zeros so I'm just going to modify",
    "start": "3204640",
    "end": "3211318"
  },
  {
    "text": "it and if I perform the same request the first value should be zero and it",
    "start": "3217040",
    "end": "3223960"
  },
  {
    "text": "is does that work for those of you who are performing the the",
    "start": "3225760",
    "end": "3232240"
  },
  {
    "text": "test sorry",
    "start": "3232680",
    "end": "3236680"
  },
  {
    "text": "which one the M SP okay H because it runs on Port uh 52",
    "start": "3240920",
    "end": "3247200"
  },
  {
    "text": "yeah sure um that's why we do not have those",
    "start": "3247200",
    "end": "3252720"
  },
  {
    "text": "kind of problems in Cali since you're running everything in rout which is a very bad idea of course from a security",
    "start": "3252720",
    "end": "3257880"
  },
  {
    "text": "point of view [Music]",
    "start": "3257880",
    "end": "3263200"
  },
  {
    "text": "um okay so let's do the same kind of request on registers which stores uh",
    "start": "3263200",
    "end": "3269000"
  },
  {
    "text": "let's say longer values so you can see that I have one two three four five and that should be",
    "start": "3269000",
    "end": "3276119"
  },
  {
    "text": "the same if I take a look at here yes that's the same I'm just going",
    "start": "3276119",
    "end": "3283079"
  },
  {
    "text": "to change the the five to",
    "start": "3283079",
    "end": "3286960"
  },
  {
    "text": "six and it works of course if I want to I can also",
    "start": "3292559",
    "end": "3300160"
  },
  {
    "text": "modify the value by using the switch W6 and inputting uh any address let's say",
    "start": "3300160",
    "end": "3306880"
  },
  {
    "text": "address one so it's say wordwide okay and if I",
    "start": "3306880",
    "end": "3314040"
  },
  {
    "text": "take a look in the G I have 12 address number two whereas I",
    "start": "3314040",
    "end": "3319599"
  },
  {
    "text": "ask for address one which is a different because there is an offset in the let's say as I told you some software use zero",
    "start": "3319599",
    "end": "3326480"
  },
  {
    "text": "as the first value some other use one as the first",
    "start": "3326480",
    "end": "3331038"
  },
  {
    "text": "value so is it working for everyone do you have any uh kind of",
    "start": "3334599",
    "end": "3341798"
  },
  {
    "text": "question nope okay uh I'm just continue and try to",
    "start": "3341839",
    "end": "3348880"
  },
  {
    "text": "modify the a coil because that's uh another possibility I do not",
    "start": "3348880",
    "end": "3356798"
  },
  {
    "text": "I do not remember um the exact command so I'm going to take a look at the AL so if you",
    "start": "3357039",
    "end": "3363599"
  },
  {
    "text": "want to write a bits",
    "start": "3363599",
    "end": "3366520"
  },
  {
    "text": "W5 okay so that should have worked this one and if I do the same",
    "start": "3381000",
    "end": "3386720"
  },
  {
    "text": "with the value zero then it's",
    "start": "3386720",
    "end": "3393160"
  },
  {
    "text": "zero okay great I think if you do not have any other question we can take our",
    "start": "3397760",
    "end": "3403240"
  },
  {
    "text": "break what are we going to do after the break we're going to do the the same kind of request using uh Metasploit",
    "start": "3403240",
    "end": "3409480"
  },
  {
    "text": "because there is an integrated mbus client uh auxiliary module and uh then after I'm going to",
    "start": "3409480",
    "end": "3418119"
  },
  {
    "text": "try to set up a Wi-Fi network so those of you which are interested can perform the same test as me on the real devices",
    "start": "3418119",
    "end": "3425599"
  },
  {
    "text": "and by those test I mean uh performing some kind of Recon using n map or PLC scan uh then we are going to use the",
    "start": "3425599",
    "end": "3432200"
  },
  {
    "text": "same tool MBT get or Metasploit to perform modbus request to the Schneider",
    "start": "3432200",
    "end": "3437240"
  },
  {
    "text": "PLC and then I'm going to try to show you um let's say one or two vulnerability in the Schneider uh PLC um",
    "start": "3437240",
    "end": "3445960"
  },
  {
    "text": "that allow unauthenticated stop and start and maybe we can try to retrieve",
    "start": "3445960",
    "end": "3451359"
  },
  {
    "text": "the program without being authenticated",
    "start": "3451359",
    "end": "3456160"
  },
  {
    "text": "[Applause]",
    "start": "3457900",
    "end": "3464409"
  }
]