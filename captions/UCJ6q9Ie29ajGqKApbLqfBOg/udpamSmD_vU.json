[
  {
    "text": "[Music]",
    "start": "3990",
    "end": "13809"
  },
  {
    "text": "welcome to this talk when tls hacks you",
    "start": "14799",
    "end": "17920"
  },
  {
    "text": "i'm actually going to start off with the",
    "start": "17920",
    "end": "19199"
  },
  {
    "text": "demo this is going to be weird",
    "start": "19199",
    "end": "21279"
  },
  {
    "text": "this isn't a concrete attack scenario",
    "start": "21279",
    "end": "22800"
  },
  {
    "text": "but hopefully should make everyone",
    "start": "22800",
    "end": "24240"
  },
  {
    "text": "curious about what's going on",
    "start": "24240",
    "end": "26400"
  },
  {
    "text": "for those familiar with ssrf the",
    "start": "26400",
    "end": "28720"
  },
  {
    "text": "implications will be fairly clear",
    "start": "28720",
    "end": "30320"
  },
  {
    "text": "but i'll explain them right after the",
    "start": "30320",
    "end": "32000"
  },
  {
    "text": "demo for everyone else",
    "start": "32000",
    "end": "33840"
  },
  {
    "text": "after that the attack scenario examples",
    "start": "33840",
    "end": "35680"
  },
  {
    "text": "are going to gradually move towards real",
    "start": "35680",
    "end": "37360"
  },
  {
    "text": "stuff",
    "start": "37360",
    "end": "38320"
  },
  {
    "text": "but i find it's easiest to first look at",
    "start": "38320",
    "end": "39840"
  },
  {
    "text": "the simplest cases and then",
    "start": "39840",
    "end": "41760"
  },
  {
    "text": "start expanding to look at real world",
    "start": "41760",
    "end": "43280"
  },
  {
    "text": "stuff for now though",
    "start": "43280",
    "end": "46239"
  },
  {
    "text": "let's see the essence of the dangerous",
    "start": "46239",
    "end": "47600"
  },
  {
    "text": "property of dls that this talk is about",
    "start": "47600",
    "end": "50640"
  },
  {
    "text": "oh there we go",
    "start": "50640",
    "end": "54559"
  },
  {
    "text": "here's memcached a popular cache that",
    "start": "54559",
    "end": "57680"
  },
  {
    "text": "commonly",
    "start": "57680",
    "end": "58640"
  },
  {
    "text": "commonly runs on port one one two and",
    "start": "58640",
    "end": "60239"
  },
  {
    "text": "one i have it installed here so you can",
    "start": "60239",
    "end": "62399"
  },
  {
    "text": "see that for the key named z",
    "start": "62399",
    "end": "64400"
  },
  {
    "text": "there is currently no entry if you're",
    "start": "64400",
    "end": "66560"
  },
  {
    "text": "not familiar with memcache this is how",
    "start": "66560",
    "end": "68080"
  },
  {
    "text": "stuff communicates with it",
    "start": "68080",
    "end": "69439"
  },
  {
    "text": "a new line delimited tcp protocol now",
    "start": "69439",
    "end": "72240"
  },
  {
    "text": "i'll do something that",
    "start": "72240",
    "end": "74080"
  },
  {
    "text": "you might not expect to affect memcached",
    "start": "74080",
    "end": "76080"
  },
  {
    "text": "i'll make a request to an https url",
    "start": "76080",
    "end": "78560"
  },
  {
    "text": "the dash l enables redirects and the",
    "start": "78560",
    "end": "80560"
  },
  {
    "text": "dash v lets us see everything that's",
    "start": "80560",
    "end": "82080"
  },
  {
    "text": "going on",
    "start": "82080",
    "end": "83920"
  },
  {
    "text": "so you can see that the end point after",
    "start": "83920",
    "end": "86000"
  },
  {
    "text": "a bit is",
    "start": "86000",
    "end": "87040"
  },
  {
    "text": "redirecting to itself i sped this up",
    "start": "87040",
    "end": "90159"
  },
  {
    "text": "because this is a lightning talk and the",
    "start": "90159",
    "end": "91680"
  },
  {
    "text": "string of redirects takes a couple of",
    "start": "91680",
    "end": "93119"
  },
  {
    "text": "minutes",
    "start": "93119",
    "end": "94720"
  },
  {
    "text": "but the redirects don't go on forever",
    "start": "94720",
    "end": "96400"
  },
  {
    "text": "[Music]",
    "start": "96400",
    "end": "97759"
  },
  {
    "text": "after a bit we get an error and now for",
    "start": "97759",
    "end": "100320"
  },
  {
    "text": "the magic",
    "start": "100320",
    "end": "101439"
  },
  {
    "text": "going back to memcached if we rerun the",
    "start": "101439",
    "end": "104560"
  },
  {
    "text": "same get command we see an entry appear",
    "start": "104560",
    "end": "108320"
  },
  {
    "text": "the odd thing is that text never showed",
    "start": "108640",
    "end": "110479"
  },
  {
    "text": "up in the curl command",
    "start": "110479",
    "end": "111920"
  },
  {
    "text": "or in any of the redirects so somehow",
    "start": "111920",
    "end": "114159"
  },
  {
    "text": "the server we were talking to had to do",
    "start": "114159",
    "end": "115920"
  },
  {
    "text": "something with tls to trick curl into",
    "start": "115920",
    "end": "118479"
  },
  {
    "text": "putting it in there so even though i",
    "start": "118479",
    "end": "120399"
  },
  {
    "text": "didn't just do anything aside from",
    "start": "120399",
    "end": "121759"
  },
  {
    "text": "hacking myself",
    "start": "121759",
    "end": "122799"
  },
  {
    "text": "what happened was weird and potentially",
    "start": "122799",
    "end": "126719"
  },
  {
    "text": "useful",
    "start": "126840",
    "end": "128160"
  },
  {
    "text": "but here's where i'm going with this",
    "start": "128160",
    "end": "130000"
  },
  {
    "text": "because not everyone is into these sorts",
    "start": "130000",
    "end": "131599"
  },
  {
    "text": "of attacks",
    "start": "131599",
    "end": "132560"
  },
  {
    "text": "i'm going to start off with exactly what",
    "start": "132560",
    "end": "134959"
  },
  {
    "text": "makes this useful as an attacker",
    "start": "134959",
    "end": "137040"
  },
  {
    "text": "i'll then move on to some stuff that",
    "start": "137040",
    "end": "138400"
  },
  {
    "text": "shows just how widely these attacks can",
    "start": "138400",
    "end": "140000"
  },
  {
    "text": "be applied",
    "start": "140000",
    "end": "140959"
  },
  {
    "text": "and then get to some recommendations for",
    "start": "140959",
    "end": "143280"
  },
  {
    "text": "what to do about them",
    "start": "143280",
    "end": "144310"
  },
  {
    "text": "[Music]",
    "start": "144310",
    "end": "145920"
  },
  {
    "text": "so to start off with there's an existing",
    "start": "145920",
    "end": "147599"
  },
  {
    "text": "category of vulnerability called ssrf",
    "start": "147599",
    "end": "150319"
  },
  {
    "text": "it stands for server side request",
    "start": "150319",
    "end": "151760"
  },
  {
    "text": "forgery it's where you effectively fish",
    "start": "151760",
    "end": "153920"
  },
  {
    "text": "a server into doing something by sending",
    "start": "153920",
    "end": "155680"
  },
  {
    "text": "it a url",
    "start": "155680",
    "end": "158319"
  },
  {
    "text": "last year at black hat i demonstrated a",
    "start": "158319",
    "end": "159920"
  },
  {
    "text": "bunch of these vulnerabilities in apple",
    "start": "159920",
    "end": "161760"
  },
  {
    "text": "pay and in web book receivers",
    "start": "161760",
    "end": "164080"
  },
  {
    "text": "i'm not going to go into these as much",
    "start": "164080",
    "end": "165599"
  },
  {
    "text": "here but if you're curious you can",
    "start": "165599",
    "end": "167200"
  },
  {
    "text": "download these slides later and take a",
    "start": "167200",
    "end": "169040"
  },
  {
    "text": "look at this youtube link right here",
    "start": "169040",
    "end": "172560"
  },
  {
    "text": "ssrf has a ton of different approaches",
    "start": "173120",
    "end": "175360"
  },
  {
    "text": "but it was actually pretty easy in some",
    "start": "175360",
    "end": "176800"
  },
  {
    "text": "cases",
    "start": "176800",
    "end": "178000"
  },
  {
    "text": "webkit.org had a live sample",
    "start": "178000",
    "end": "179840"
  },
  {
    "text": "implementation of apple pay and it even",
    "start": "179840",
    "end": "182720"
  },
  {
    "text": "was on aws with the old instance",
    "start": "182720",
    "end": "184560"
  },
  {
    "text": "metadata service",
    "start": "184560",
    "end": "186319"
  },
  {
    "text": "so all i had to do was pass this ip and",
    "start": "186319",
    "end": "188239"
  },
  {
    "text": "i could poke around an internal api",
    "start": "188239",
    "end": "190239"
  },
  {
    "text": "and get some tokens but not everything",
    "start": "190239",
    "end": "193120"
  },
  {
    "text": "was so simple",
    "start": "193120",
    "end": "194640"
  },
  {
    "text": "uh i had a lot of ssrf vulnerabilities",
    "start": "194640",
    "end": "197040"
  },
  {
    "text": "that were out there",
    "start": "197040",
    "end": "199280"
  },
  {
    "text": "that were almost there but weren't quite",
    "start": "199280",
    "end": "201200"
  },
  {
    "text": "vulnerable to this easy approach",
    "start": "201200",
    "end": "204080"
  },
  {
    "text": "sometimes i'd have a web hook where i",
    "start": "204080",
    "end": "205840"
  },
  {
    "text": "could hand it a url and the server would",
    "start": "205840",
    "end": "207599"
  },
  {
    "text": "even fetch the url",
    "start": "207599",
    "end": "209120"
  },
  {
    "text": "but not give me a response this is",
    "start": "209120",
    "end": "210799"
  },
  {
    "text": "called blind ssrf",
    "start": "210799",
    "end": "212020"
  },
  {
    "text": "[Music]",
    "start": "212020",
    "end": "213360"
  },
  {
    "text": "other times the requests in question",
    "start": "213360",
    "end": "214879"
  },
  {
    "text": "would be a put request",
    "start": "214879",
    "end": "216720"
  },
  {
    "text": "which restricted what endpoints i could",
    "start": "216720",
    "end": "218159"
  },
  {
    "text": "hit sometimes you can mess with the",
    "start": "218159",
    "end": "220319"
  },
  {
    "text": "request method by setting up an endpoint",
    "start": "220319",
    "end": "222159"
  },
  {
    "text": "that redirects the server around",
    "start": "222159",
    "end": "223920"
  },
  {
    "text": "but that's hit or miss other times you",
    "start": "223920",
    "end": "227200"
  },
  {
    "text": "might get some data back",
    "start": "227200",
    "end": "228400"
  },
  {
    "text": "but it's validated against a specific",
    "start": "228400",
    "end": "230000"
  },
  {
    "text": "content type or you only get back",
    "start": "230000",
    "end": "231680"
  },
  {
    "text": "certain fields",
    "start": "231680",
    "end": "233120"
  },
  {
    "text": "or even worse it will only accept https",
    "start": "233120",
    "end": "235040"
  },
  {
    "text": "urls",
    "start": "235040",
    "end": "237280"
  },
  {
    "text": "so what we really want here in order to",
    "start": "237280",
    "end": "239680"
  },
  {
    "text": "exploit this stuff",
    "start": "239680",
    "end": "240560"
  },
  {
    "text": "is a generic blind ssrf approach in",
    "start": "240560",
    "end": "244000"
  },
  {
    "text": "other words we'd like to send the server",
    "start": "244000",
    "end": "245840"
  },
  {
    "text": "a url have it fire a payload at",
    "start": "245840",
    "end": "247840"
  },
  {
    "text": "something internal like smtp or redis",
    "start": "247840",
    "end": "250799"
  },
  {
    "text": "and get a security compromise just from",
    "start": "250799",
    "end": "252799"
  },
  {
    "text": "that exchange alone",
    "start": "252799",
    "end": "255599"
  },
  {
    "text": "and without needing to see a response",
    "start": "255599",
    "end": "257290"
  },
  {
    "text": "[Music]",
    "start": "257290",
    "end": "258959"
  },
  {
    "text": "so here are the comments some of the",
    "start": "258959",
    "end": "260639"
  },
  {
    "text": "common approaches to that",
    "start": "260639",
    "end": "262079"
  },
  {
    "text": "the issue is these are extremely",
    "start": "262079",
    "end": "263600"
  },
  {
    "text": "platform specific to the point that i",
    "start": "263600",
    "end": "265919"
  },
  {
    "text": "have never had any luck with these but",
    "start": "265919",
    "end": "268320"
  },
  {
    "text": "there are some useful ideas in here",
    "start": "268320",
    "end": "269759"
  },
  {
    "text": "particularly an sni injection",
    "start": "269759",
    "end": "272320"
  },
  {
    "text": "you wouldn't think tls would be",
    "start": "272320",
    "end": "273440"
  },
  {
    "text": "particularly useful because its packets",
    "start": "273440",
    "end": "275840"
  },
  {
    "text": "are mostly just encrypted data",
    "start": "275840",
    "end": "277600"
  },
  {
    "text": "binary flags and other stuff that an",
    "start": "277600",
    "end": "279680"
  },
  {
    "text": "attacker doesn't have much control over",
    "start": "279680",
    "end": "282160"
  },
  {
    "text": "but it's not all that limited as orange",
    "start": "282160",
    "end": "284000"
  },
  {
    "text": "signos",
    "start": "284000",
    "end": "285280"
  },
  {
    "text": "the sni which is basically just the",
    "start": "285280",
    "end": "287040"
  },
  {
    "text": "domain name",
    "start": "287040",
    "end": "289680"
  },
  {
    "text": "is part of the url so if you can trick",
    "start": "289759",
    "end": "292960"
  },
  {
    "text": "the victim into accepting a weird domain",
    "start": "292960",
    "end": "295680"
  },
  {
    "text": "name and parsing it incorrectly",
    "start": "295680",
    "end": "297759"
  },
  {
    "text": "you can include arbitrary bytes in there",
    "start": "297759",
    "end": "300240"
  },
  {
    "text": "and smuggle stuff like smtp commands",
    "start": "300240",
    "end": "302720"
  },
  {
    "text": "this approach is dependent on a",
    "start": "302720",
    "end": "304000"
  },
  {
    "text": "platform-specific url parsing bug",
    "start": "304000",
    "end": "306080"
  },
  {
    "text": "but what if we had something that was",
    "start": "306080",
    "end": "307280"
  },
  {
    "text": "inherent to the tls protocol",
    "start": "307280",
    "end": "309520"
  },
  {
    "text": "this is where my work starts let's look",
    "start": "309520",
    "end": "311759"
  },
  {
    "text": "at a tls packet",
    "start": "311759",
    "end": "312880"
  },
  {
    "text": "and see what's there for us to use as",
    "start": "312880",
    "end": "316160"
  },
  {
    "text": "is often helpful when looking at",
    "start": "316160",
    "end": "317600"
  },
  {
    "text": "protocols we can open up wireshark and",
    "start": "317600",
    "end": "319680"
  },
  {
    "text": "see what happens in a tls connection",
    "start": "319680",
    "end": "321520"
  },
  {
    "text": "here's the sni or server name indication",
    "start": "321520",
    "end": "324560"
  },
  {
    "text": "that was previously explored in orange's",
    "start": "324560",
    "end": "326960"
  },
  {
    "text": "talk",
    "start": "326960",
    "end": "327680"
  },
  {
    "text": "his work involves putting new lines and",
    "start": "327680",
    "end": "330479"
  },
  {
    "text": "smtp commands into the section pointed",
    "start": "330479",
    "end": "332400"
  },
  {
    "text": "to by the arrow here",
    "start": "332400",
    "end": "334800"
  },
  {
    "text": "if you poke around you'll see stuff like",
    "start": "334800",
    "end": "336320"
  },
  {
    "text": "random strings key",
    "start": "336320",
    "end": "338000"
  },
  {
    "text": "shares and other stuff that isn't all",
    "start": "338000",
    "end": "339360"
  },
  {
    "text": "that useful for ssrf",
    "start": "339360",
    "end": "341600"
  },
  {
    "text": "why because the only part of a server",
    "start": "341600",
    "end": "343840"
  },
  {
    "text": "that or the only part of this that we",
    "start": "343840",
    "end": "345680"
  },
  {
    "text": "can typically feed a server",
    "start": "345680",
    "end": "347360"
  },
  {
    "text": "is a url and the only part of the url",
    "start": "347360",
    "end": "349600"
  },
  {
    "text": "that will make it into this client hello",
    "start": "349600",
    "end": "351440"
  },
  {
    "text": "packet",
    "start": "351440",
    "end": "352080"
  },
  {
    "text": "is the domain name that we provide the",
    "start": "352080",
    "end": "353440"
  },
  {
    "text": "victim machine",
    "start": "353440",
    "end": "356080"
  },
  {
    "text": "but there's a different way that we as",
    "start": "357919",
    "end": "359120"
  },
  {
    "text": "an attacker can get payloads into client",
    "start": "359120",
    "end": "361199"
  },
  {
    "text": "hello messages",
    "start": "361199",
    "end": "362400"
  },
  {
    "text": "it involves a couple of steps and is the",
    "start": "362400",
    "end": "364000"
  },
  {
    "text": "main focus of this talk first",
    "start": "364000",
    "end": "366639"
  },
  {
    "text": "we send over a link to our own server in",
    "start": "366639",
    "end": "369360"
  },
  {
    "text": "this case jmaddox.com",
    "start": "369360",
    "end": "371360"
  },
  {
    "text": "then jmadx.com responds with a valid",
    "start": "371360",
    "end": "373680"
  },
  {
    "text": "server hello",
    "start": "373680",
    "end": "374639"
  },
  {
    "text": "hello that contains our payload",
    "start": "374639",
    "end": "376590"
  },
  {
    "text": "[Music]",
    "start": "376590",
    "end": "378240"
  },
  {
    "text": "now it would be an ideal if we as an",
    "start": "378240",
    "end": "379919"
  },
  {
    "text": "attacker could get that payload",
    "start": "379919",
    "end": "382319"
  },
  {
    "text": "the jmatics.com sent the victim and get",
    "start": "382319",
    "end": "384560"
  },
  {
    "text": "the victim to send it somewhere internal",
    "start": "384560",
    "end": "386880"
  },
  {
    "text": "but that raises a question is there such",
    "start": "386880",
    "end": "388800"
  },
  {
    "text": "a field that we can use to deliver these",
    "start": "388800",
    "end": "390960"
  },
  {
    "text": "payloads",
    "start": "390960",
    "end": "391540"
  },
  {
    "text": "[Music]",
    "start": "391540",
    "end": "393280"
  },
  {
    "text": "it might seem too good to be true but",
    "start": "393280",
    "end": "395120"
  },
  {
    "text": "tls actually provides us",
    "start": "395120",
    "end": "396880"
  },
  {
    "text": "with exactly that in the form of a",
    "start": "396880",
    "end": "398319"
  },
  {
    "text": "session id most clients even persist",
    "start": "398319",
    "end": "400800"
  },
  {
    "text": "this field",
    "start": "400800",
    "end": "401919"
  },
  {
    "text": "session ids are limited to 32 bytes as",
    "start": "401919",
    "end": "404479"
  },
  {
    "text": "you see here",
    "start": "404479",
    "end": "405360"
  },
  {
    "text": "but depending on the implementation you",
    "start": "405360",
    "end": "406800"
  },
  {
    "text": "might have",
    "start": "406800",
    "end": "408560"
  },
  {
    "text": "session tickets this one is about 200",
    "start": "408560",
    "end": "411599"
  },
  {
    "text": "bytes but these can be up to around 65",
    "start": "411599",
    "end": "413759"
  },
  {
    "text": "kilobytes",
    "start": "413759",
    "end": "415280"
  },
  {
    "text": "both session ids and session tickets are",
    "start": "415280",
    "end": "417280"
  },
  {
    "text": "mechanisms for a tls client to go",
    "start": "417280",
    "end": "419440"
  },
  {
    "text": "hey remember that key cryptographic key",
    "start": "419440",
    "end": "421199"
  },
  {
    "text": "exchange we did earlier",
    "start": "421199",
    "end": "422479"
  },
  {
    "text": "let's just keep using that in this new",
    "start": "422479",
    "end": "425039"
  },
  {
    "text": "exchange",
    "start": "425039",
    "end": "425680"
  },
  {
    "text": "or in this new connection tls 1.3",
    "start": "425680",
    "end": "429199"
  },
  {
    "text": "includes a slightly more complicated",
    "start": "429199",
    "end": "430800"
  },
  {
    "text": "mechanism called a pre-shared key",
    "start": "430800",
    "end": "432240"
  },
  {
    "text": "identity",
    "start": "432240",
    "end": "433520"
  },
  {
    "text": "which does pretty much the same thing",
    "start": "433520",
    "end": "434960"
  },
  {
    "text": "for our purpose",
    "start": "434960",
    "end": "436800"
  },
  {
    "text": "all of these are about optimization",
    "start": "436800",
    "end": "438720"
  },
  {
    "text": "since key exchanges can be time",
    "start": "438720",
    "end": "440000"
  },
  {
    "text": "consuming",
    "start": "440000",
    "end": "441199"
  },
  {
    "text": "but they provide a way for a server to",
    "start": "441199",
    "end": "442800"
  },
  {
    "text": "tell whatever is connecting to it to",
    "start": "442800",
    "end": "444880"
  },
  {
    "text": "persist some data for later use",
    "start": "444880",
    "end": "448319"
  },
  {
    "text": "so it's almost like a cookie that lives",
    "start": "448319",
    "end": "450000"
  },
  {
    "text": "in plain text so it's perfect for the",
    "start": "450000",
    "end": "451680"
  },
  {
    "text": "ssrf attack that we're trying to do",
    "start": "451680",
    "end": "455199"
  },
  {
    "text": "now you might anticipate a problem here",
    "start": "455280",
    "end": "457520"
  },
  {
    "text": "obviously if you go to google.com and",
    "start": "457520",
    "end": "459199"
  },
  {
    "text": "then to apple.com those tls sessions",
    "start": "459199",
    "end": "461680"
  },
  {
    "text": "are going to have distinct data from",
    "start": "461680",
    "end": "463199"
  },
  {
    "text": "each other the same applies between",
    "start": "463199",
    "end": "465120"
  },
  {
    "text": "google.com and localhost",
    "start": "465120",
    "end": "467280"
  },
  {
    "text": "so we have a bit of a problem getting",
    "start": "467280",
    "end": "468639"
  },
  {
    "text": "the target server to reuse the session",
    "start": "468639",
    "end": "470400"
  },
  {
    "text": "when communicating with something",
    "start": "470400",
    "end": "471680"
  },
  {
    "text": "internal",
    "start": "471680",
    "end": "473759"
  },
  {
    "text": "but when i looked at both the tls spec",
    "start": "473759",
    "end": "475919"
  },
  {
    "text": "and popular session cache",
    "start": "475919",
    "end": "477120"
  },
  {
    "text": "implementations",
    "start": "477120",
    "end": "478319"
  },
  {
    "text": "i saw this wasn't quite the case i first",
    "start": "478319",
    "end": "480800"
  },
  {
    "text": "went to the",
    "start": "480800",
    "end": "481520"
  },
  {
    "text": "curl source code since lib curl is used",
    "start": "481520",
    "end": "483759"
  },
  {
    "text": "by a lot of php stuff",
    "start": "483759",
    "end": "485840"
  },
  {
    "text": "sessions are keyed by the four key",
    "start": "485840",
    "end": "487440"
  },
  {
    "text": "properties here",
    "start": "487440",
    "end": "489759"
  },
  {
    "text": "which belong to this struct as you can",
    "start": "489759",
    "end": "492080"
  },
  {
    "text": "see none of these are the ip address",
    "start": "492080",
    "end": "494639"
  },
  {
    "text": "this means that no matter what ip",
    "start": "494639",
    "end": "496080"
  },
  {
    "text": "address jmaddix.com resolves to",
    "start": "496080",
    "end": "499120"
  },
  {
    "text": "curl will attempt to reuse the session",
    "start": "499120",
    "end": "501280"
  },
  {
    "text": "this also happens to be how just about",
    "start": "501280",
    "end": "503039"
  },
  {
    "text": "everything else caches tls sessions",
    "start": "503039",
    "end": "505680"
  },
  {
    "text": "so if you establish a tls session with",
    "start": "505680",
    "end": "507440"
  },
  {
    "text": "jmadx.com",
    "start": "507440",
    "end": "508800"
  },
  {
    "text": "whether it resolves to something on your",
    "start": "508800",
    "end": "510479"
  },
  {
    "text": "on the internet or your own machine",
    "start": "510479",
    "end": "513039"
  },
  {
    "text": "your https client will not know the",
    "start": "513039",
    "end": "514560"
  },
  {
    "text": "difference since i as the attacker own",
    "start": "514560",
    "end": "517200"
  },
  {
    "text": "jmaddox.com",
    "start": "517200",
    "end": "518560"
  },
  {
    "text": "i can combine all of this tls stuff with",
    "start": "518560",
    "end": "520560"
  },
  {
    "text": "a concept i'd call dns or binding",
    "start": "520560",
    "end": "523919"
  },
  {
    "text": "so i resolve the first request to",
    "start": "523919",
    "end": "526920"
  },
  {
    "text": "35.x.x.x",
    "start": "526920",
    "end": "528320"
  },
  {
    "text": "some server i control then i",
    "start": "528320",
    "end": "531519"
  },
  {
    "text": "the server target server picks up the",
    "start": "531519",
    "end": "533200"
  },
  {
    "text": "payload from 35.x.x",
    "start": "533200",
    "end": "534959"
  },
  {
    "text": "x in the form of a session ticket",
    "start": "534959",
    "end": "539040"
  },
  {
    "text": "after some time i send the exact same",
    "start": "539040",
    "end": "541040"
  },
  {
    "text": "url",
    "start": "541040",
    "end": "542160"
  },
  {
    "text": "except the dns entry has expired again",
    "start": "542160",
    "end": "545040"
  },
  {
    "text": "since i",
    "start": "545040",
    "end": "545600"
  },
  {
    "text": "control the dns server",
    "start": "545600",
    "end": "549040"
  },
  {
    "text": "this time around i resolved jmatox.com",
    "start": "549040",
    "end": "551440"
  },
  {
    "text": "to something internal that i wouldn't",
    "start": "551440",
    "end": "552959"
  },
  {
    "text": "normally have access to from the outside",
    "start": "552959",
    "end": "555120"
  },
  {
    "text": "to simplify things i'll just use",
    "start": "555120",
    "end": "556720"
  },
  {
    "text": "localhost",
    "start": "556720",
    "end": "559279"
  },
  {
    "text": "once the dns query finishes the target",
    "start": "559839",
    "end": "562160"
  },
  {
    "text": "server then",
    "start": "562160",
    "end": "563200"
  },
  {
    "text": "makes an internal request with that",
    "start": "563200",
    "end": "564640"
  },
  {
    "text": "payload",
    "start": "564640",
    "end": "567040"
  },
  {
    "text": "so like what i did in the opening demo",
    "start": "567360",
    "end": "569600"
  },
  {
    "text": "you can manipulate whatever you're",
    "start": "569600",
    "end": "570800"
  },
  {
    "text": "attacking",
    "start": "570800",
    "end": "571600"
  },
  {
    "text": "to send a tls session id ticket or psk",
    "start": "571600",
    "end": "574480"
  },
  {
    "text": "identity to itself",
    "start": "574480",
    "end": "576320"
  },
  {
    "text": "here i'm showing a psk identity that",
    "start": "576320",
    "end": "578240"
  },
  {
    "text": "does a memcache insert",
    "start": "578240",
    "end": "581360"
  },
  {
    "text": "so here's the same tcp stream but just",
    "start": "581360",
    "end": "583440"
  },
  {
    "text": "displayed raw",
    "start": "583440",
    "end": "584640"
  },
  {
    "text": "this view shows the really important",
    "start": "584640",
    "end": "586080"
  },
  {
    "text": "property of my approach to combining tls",
    "start": "586080",
    "end": "588399"
  },
  {
    "text": "with dns for binding you can get",
    "start": "588399",
    "end": "590240"
  },
  {
    "text": "arbitrary characters",
    "start": "590240",
    "end": "591519"
  },
  {
    "text": "to be sent which includes new lines this",
    "start": "591519",
    "end": "594080"
  },
  {
    "text": "is what allows you to interact with a",
    "start": "594080",
    "end": "595440"
  },
  {
    "text": "bunch of local services like memcached",
    "start": "595440",
    "end": "597600"
  },
  {
    "text": "just like people did in the past with",
    "start": "597600",
    "end": "598959"
  },
  {
    "text": "gopher urls",
    "start": "598959",
    "end": "601839"
  },
  {
    "text": "and here's an exchange more typical of",
    "start": "602720",
    "end": "604240"
  },
  {
    "text": "what you'd use to do real damage",
    "start": "604240",
    "end": "606079"
  },
  {
    "text": "this is a value that in most python",
    "start": "606079",
    "end": "607839"
  },
  {
    "text": "memcache libraries",
    "start": "607839",
    "end": "609120"
  },
  {
    "text": "will execute a shell command immediately",
    "start": "609120",
    "end": "611839"
  },
  {
    "text": "once it's retrieved from the cache",
    "start": "611839",
    "end": "613920"
  },
  {
    "text": "this is because it's quite common in",
    "start": "613920",
    "end": "615200"
  },
  {
    "text": "python and other languages to use",
    "start": "615200",
    "end": "617040"
  },
  {
    "text": "built-in serialization methods like",
    "start": "617040",
    "end": "618560"
  },
  {
    "text": "pickle",
    "start": "618560",
    "end": "619839"
  },
  {
    "text": "to convert values to something that can",
    "start": "619839",
    "end": "621440"
  },
  {
    "text": "be stored unfortunately",
    "start": "621440",
    "end": "623920"
  },
  {
    "text": "built-in serialization methods are also",
    "start": "623920",
    "end": "625519"
  },
  {
    "text": "common rce targets we'll get to",
    "start": "625519",
    "end": "627200"
  },
  {
    "text": "exploitation later",
    "start": "627200",
    "end": "628190"
  },
  {
    "text": "[Music]",
    "start": "628190",
    "end": "630079"
  },
  {
    "text": "but since this is pretty common i ended",
    "start": "630079",
    "end": "632079"
  },
  {
    "text": "up testing a fairly fair amount of sites",
    "start": "632079",
    "end": "634399"
  },
  {
    "text": "i'll get to specif some specific ones in",
    "start": "634399",
    "end": "636079"
  },
  {
    "text": "a second but first i'll go over some",
    "start": "636079",
    "end": "638000"
  },
  {
    "text": "infrastructure",
    "start": "638000",
    "end": "638720"
  },
  {
    "text": "some testing infrastructure i set up",
    "start": "638720",
    "end": "640720"
  },
  {
    "text": "along with some tips for actually",
    "start": "640720",
    "end": "641920"
  },
  {
    "text": "performing these exploits",
    "start": "641920",
    "end": "643260"
  },
  {
    "text": "[Music]",
    "start": "643260",
    "end": "645040"
  },
  {
    "text": "so here are all the vms i have on the",
    "start": "645040",
    "end": "646640"
  },
  {
    "text": "internet save for maybe some ip white",
    "start": "646640",
    "end": "648959"
  },
  {
    "text": "listing",
    "start": "648959",
    "end": "649839"
  },
  {
    "text": "they need to be on the open internet so",
    "start": "649839",
    "end": "651360"
  },
  {
    "text": "the target boxes can reach them",
    "start": "651360",
    "end": "653680"
  },
  {
    "text": "i've got a name server record pointing",
    "start": "653680",
    "end": "655200"
  },
  {
    "text": "to ssltest.jmax.com queries to the dns",
    "start": "655200",
    "end": "658720"
  },
  {
    "text": "server on the top left",
    "start": "658720",
    "end": "660160"
  },
  {
    "text": "which is just a by python script running",
    "start": "660160",
    "end": "661920"
  },
  {
    "text": "on port 53.",
    "start": "661920",
    "end": "663839"
  },
  {
    "text": "it alternates between answering with the",
    "start": "663839",
    "end": "665279"
  },
  {
    "text": "ip address of the custom tls server",
    "start": "665279",
    "end": "668079"
  },
  {
    "text": "and localhost then on over there on the",
    "start": "668079",
    "end": "670800"
  },
  {
    "text": "right i have my custom tls server",
    "start": "670800",
    "end": "673519"
  },
  {
    "text": "which is there to deliver my payloads",
    "start": "673519",
    "end": "674880"
  },
  {
    "text": "via session tickets i configure those by",
    "start": "674880",
    "end": "677279"
  },
  {
    "text": "just updating values in redis",
    "start": "677279",
    "end": "679839"
  },
  {
    "text": "but when testing it it proved difficult",
    "start": "679839",
    "end": "681440"
  },
  {
    "text": "to go straight to localhost",
    "start": "681440",
    "end": "683600"
  },
  {
    "text": "since depending on what library is",
    "start": "683600",
    "end": "686079"
  },
  {
    "text": "making the requests",
    "start": "686079",
    "end": "687600"
  },
  {
    "text": "i didn't know if ssl sessions were being",
    "start": "687600",
    "end": "689279"
  },
  {
    "text": "cached",
    "start": "689279",
    "end": "691519"
  },
  {
    "text": "to address this sometimes i ended up",
    "start": "691519",
    "end": "693440"
  },
  {
    "text": "adding another box",
    "start": "693440",
    "end": "694560"
  },
  {
    "text": "just see if the payload was being",
    "start": "694560",
    "end": "695920"
  },
  {
    "text": "persisted if you're not familiar",
    "start": "695920",
    "end": "698480"
  },
  {
    "text": "netcat can be set up to listen just",
    "start": "698480",
    "end": "700800"
  },
  {
    "text": "listen for tcp",
    "start": "700800",
    "end": "702240"
  },
  {
    "text": "connections and log the results i saw my",
    "start": "702240",
    "end": "704640"
  },
  {
    "text": "payload",
    "start": "704640",
    "end": "705279"
  },
  {
    "text": "if i saw my payload making it into the",
    "start": "705279",
    "end": "706800"
  },
  {
    "text": "logs i knew the general approach",
    "start": "706800",
    "end": "708880"
  },
  {
    "text": "could work and then go back to the setup",
    "start": "708880",
    "end": "711760"
  },
  {
    "text": "from the previous slide",
    "start": "711760",
    "end": "712959"
  },
  {
    "text": "to get the server to start delivering",
    "start": "712959",
    "end": "714480"
  },
  {
    "text": "the payload to itself on different ports",
    "start": "714480",
    "end": "718800"
  },
  {
    "text": "and here are the links to what i",
    "start": "718959",
    "end": "720000"
  },
  {
    "text": "actually used a big chunk of the work",
    "start": "720000",
    "end": "721839"
  },
  {
    "text": "was saved by just messing around with",
    "start": "721839",
    "end": "723440"
  },
  {
    "text": "pure a pure rust implementation of tls",
    "start": "723440",
    "end": "725600"
  },
  {
    "text": "which is linked to here",
    "start": "725600",
    "end": "727279"
  },
  {
    "text": "a big thanks goes out to everyone in",
    "start": "727279",
    "end": "728720"
  },
  {
    "text": "this slide i wouldn't have had the time",
    "start": "728720",
    "end": "731040"
  },
  {
    "text": "to do any of this work if not for the",
    "start": "731040",
    "end": "732560"
  },
  {
    "text": "code they had put out there",
    "start": "732560",
    "end": "735600"
  },
  {
    "text": "but i know if everything i just claimed",
    "start": "736160",
    "end": "738240"
  },
  {
    "text": "i need to back things up by showing what",
    "start": "738240",
    "end": "740160"
  },
  {
    "text": "actual real-world attacks can happen",
    "start": "740160",
    "end": "742800"
  },
  {
    "text": "with us i'll start off conceptually and",
    "start": "742800",
    "end": "745200"
  },
  {
    "text": "then get to some examples along with",
    "start": "745200",
    "end": "746880"
  },
  {
    "text": "another demo",
    "start": "746880",
    "end": "748959"
  },
  {
    "text": "but here's the model i've got if you're",
    "start": "748959",
    "end": "750880"
  },
  {
    "text": "in the middle of this diagram you're",
    "start": "750880",
    "end": "752560"
  },
  {
    "text": "generally vulnerable",
    "start": "752560",
    "end": "755519"
  },
  {
    "text": "and then this top part refers to when",
    "start": "755839",
    "end": "757440"
  },
  {
    "text": "you can send something a url",
    "start": "757440",
    "end": "759200"
  },
  {
    "text": "and it will fetch that url but you don't",
    "start": "759200",
    "end": "760800"
  },
  {
    "text": "know of a way to exploit that behavior",
    "start": "760800",
    "end": "762639"
  },
  {
    "text": "just like in the first few slides it's",
    "start": "762639",
    "end": "765120"
  },
  {
    "text": "interesting because you would hope by",
    "start": "765120",
    "end": "767040"
  },
  {
    "text": "now people would try to eliminate",
    "start": "767040",
    "end": "768720"
  },
  {
    "text": "anything even remotely looking like ssrf",
    "start": "768720",
    "end": "771279"
  },
  {
    "text": "but this pattern is in fact required by",
    "start": "771279",
    "end": "773360"
  },
  {
    "text": "a few popular specs",
    "start": "773360",
    "end": "774959"
  },
  {
    "text": "this is even common enough that i've",
    "start": "774959",
    "end": "776720"
  },
  {
    "text": "seen bug bounties mention ssrf with no",
    "start": "776720",
    "end": "778639"
  },
  {
    "text": "proven security impact",
    "start": "778639",
    "end": "780160"
  },
  {
    "text": "as an excluded category understandably",
    "start": "780160",
    "end": "782480"
  },
  {
    "text": "so",
    "start": "782480",
    "end": "783360"
  },
  {
    "text": "but that's what this exactly what this",
    "start": "783360",
    "end": "785279"
  },
  {
    "text": "talk is about adding the security impact",
    "start": "785279",
    "end": "787600"
  },
  {
    "text": "even when you have something that",
    "start": "787600",
    "end": "790639"
  },
  {
    "text": "it's just almost srf and then this one",
    "start": "790639",
    "end": "800560"
  },
  {
    "text": "on the left sounds weird",
    "start": "800560",
    "end": "801839"
  },
  {
    "text": "but it's getting bigger it's just a",
    "start": "801839",
    "end": "803680"
  },
  {
    "text": "matter of what if",
    "start": "803680",
    "end": "804880"
  },
  {
    "text": "whatever the sref is going through to",
    "start": "804880",
    "end": "806800"
  },
  {
    "text": "make requests has implemented this",
    "start": "806800",
    "end": "808240"
  },
  {
    "text": "feature according to the latest spec",
    "start": "808240",
    "end": "811680"
  },
  {
    "text": "unfortunately there are quite a few",
    "start": "811920",
    "end": "813360"
  },
  {
    "text": "https client libraries out there that",
    "start": "813360",
    "end": "815200"
  },
  {
    "text": "support full-blown tls session caching",
    "start": "815200",
    "end": "817920"
  },
  {
    "text": "i reported this as a vulnerability to a",
    "start": "817920",
    "end": "819680"
  },
  {
    "text": "few but not all of the entries with yes",
    "start": "819680",
    "end": "822240"
  },
  {
    "text": "i haven't seen much traction",
    "start": "822240",
    "end": "824240"
  },
  {
    "text": "understandably since",
    "start": "824240",
    "end": "825519"
  },
  {
    "text": "fixing this requires diverging from the",
    "start": "825519",
    "end": "827279"
  },
  {
    "text": "tls spec not a whole lot of people are",
    "start": "827279",
    "end": "829440"
  },
  {
    "text": "eager to do so",
    "start": "829440",
    "end": "832160"
  },
  {
    "text": "this thing you run into the most trouble",
    "start": "832639",
    "end": "834560"
  },
  {
    "text": "with is this last circle",
    "start": "834560",
    "end": "836240"
  },
  {
    "text": "because you have to first do some recon",
    "start": "836240",
    "end": "838160"
  },
  {
    "text": "to see what ports might be open",
    "start": "838160",
    "end": "839600"
  },
  {
    "text": "internally exposed on the server and",
    "start": "839600",
    "end": "842079"
  },
  {
    "text": "then you need to see",
    "start": "842079",
    "end": "843360"
  },
  {
    "text": "if what's on those ports is permissive",
    "start": "843360",
    "end": "845199"
  },
  {
    "text": "enough to keep the connection",
    "start": "845199",
    "end": "847120"
  },
  {
    "text": "open past the opening bytes of the tls",
    "start": "847120",
    "end": "848880"
  },
  {
    "text": "client hello",
    "start": "848880",
    "end": "851120"
  },
  {
    "text": "but here's some examples of what you",
    "start": "851120",
    "end": "852399"
  },
  {
    "text": "might be looking for it's far from",
    "start": "852399",
    "end": "854720"
  },
  {
    "text": "from complete but here are some of the",
    "start": "854720",
    "end": "856079"
  },
  {
    "text": "most notable entries i've had success",
    "start": "856079",
    "end": "857680"
  },
  {
    "text": "with",
    "start": "857680",
    "end": "859920"
  },
  {
    "text": "so now we'll go through a couple of",
    "start": "860079",
    "end": "861360"
  },
  {
    "text": "exploitable examples of these tls",
    "start": "861360",
    "end": "863519"
  },
  {
    "text": "session based",
    "start": "863519",
    "end": "864240"
  },
  {
    "text": "ssrf vulnerabilities that i reported and",
    "start": "864240",
    "end": "866320"
  },
  {
    "text": "got fixed",
    "start": "866320",
    "end": "868560"
  },
  {
    "text": "here's one from you track it's rated low",
    "start": "868560",
    "end": "870959"
  },
  {
    "text": "because",
    "start": "870959",
    "end": "871600"
  },
  {
    "text": "all i had was local smtp and i didn't",
    "start": "871600",
    "end": "874079"
  },
  {
    "text": "try",
    "start": "874079",
    "end": "874639"
  },
  {
    "text": "poking around to see if i could exploit",
    "start": "874639",
    "end": "876240"
  },
  {
    "text": "the smtp server further",
    "start": "876240",
    "end": "878000"
  },
  {
    "text": "it originated from utrack's import",
    "start": "878000",
    "end": "880000"
  },
  {
    "text": "feature",
    "start": "880000",
    "end": "881279"
  },
  {
    "text": "which normally wouldn't be easy to",
    "start": "881279",
    "end": "882720"
  },
  {
    "text": "exploit being blind ssrf",
    "start": "882720",
    "end": "886079"
  },
  {
    "text": "but with my rebinding code here's a",
    "start": "886079",
    "end": "887680"
  },
  {
    "text": "section from the tls packet i got you",
    "start": "887680",
    "end": "889600"
  },
  {
    "text": "track to send itself",
    "start": "889600",
    "end": "891199"
  },
  {
    "text": "this works because ssrf is a newline",
    "start": "891199",
    "end": "893120"
  },
  {
    "text": "delimited",
    "start": "893120",
    "end": "894240"
  },
  {
    "text": "tcp protocol just like memcached so you",
    "start": "894240",
    "end": "896639"
  },
  {
    "text": "can embed working commands within a tls",
    "start": "896639",
    "end": "898880"
  },
  {
    "text": "ticket",
    "start": "898880",
    "end": "900800"
  },
  {
    "text": "and here's what came of that packet this",
    "start": "900800",
    "end": "903120"
  },
  {
    "text": "alone wasn't super severe",
    "start": "903120",
    "end": "904800"
  },
  {
    "text": "because it's not signed quite right and",
    "start": "904800",
    "end": "906240"
  },
  {
    "text": "i didn't dig too deeply because",
    "start": "906240",
    "end": "907839"
  },
  {
    "text": "i wanted to just report it asap but it",
    "start": "907839",
    "end": "910399"
  },
  {
    "text": "did get initiated by tcp",
    "start": "910399",
    "end": "912240"
  },
  {
    "text": "stream i got utrack to send itself so",
    "start": "912240",
    "end": "914800"
  },
  {
    "text": "it's still pretty bad",
    "start": "914800",
    "end": "916000"
  },
  {
    "text": "just conceptually and here's one i",
    "start": "916000",
    "end": "918959"
  },
  {
    "text": "reported in next cloud",
    "start": "918959",
    "end": "920320"
  },
  {
    "text": "the idea behind next cloud is a cool one",
    "start": "920320",
    "end": "922240"
  },
  {
    "text": "you can set up a server and host files",
    "start": "922240",
    "end": "924880"
  },
  {
    "text": "and even share them with other people's",
    "start": "924880",
    "end": "926639"
  },
  {
    "text": "servers using a share url like this",
    "start": "926639",
    "end": "930000"
  },
  {
    "text": "but as it turns out you can include port",
    "start": "930000",
    "end": "932000"
  },
  {
    "text": "numbers in the share url",
    "start": "932000",
    "end": "933759"
  },
  {
    "text": "now since next cloud automatically puts",
    "start": "933759",
    "end": "935600"
  },
  {
    "text": "https in there",
    "start": "935600",
    "end": "937600"
  },
  {
    "text": "normally there wouldn't be as much ssrf",
    "start": "937600",
    "end": "939440"
  },
  {
    "text": "potential and it would have to be blind",
    "start": "939440",
    "end": "940880"
  },
  {
    "text": "ssrf",
    "start": "940880",
    "end": "943360"
  },
  {
    "text": "but luckily i was able to do just that",
    "start": "943360",
    "end": "945600"
  },
  {
    "text": "so as a non-admin user i could use my",
    "start": "945600",
    "end": "947759"
  },
  {
    "text": "tls for binding attack",
    "start": "947759",
    "end": "949279"
  },
  {
    "text": "infrastructure to perform arbitrary",
    "start": "949279",
    "end": "950880"
  },
  {
    "text": "writes on memcached",
    "start": "950880",
    "end": "953680"
  },
  {
    "text": "after reporting this and working through",
    "start": "953680",
    "end": "955279"
  },
  {
    "text": "the options there weren't any great ones",
    "start": "955279",
    "end": "957120"
  },
  {
    "text": "because not all",
    "start": "957120",
    "end": "958079"
  },
  {
    "text": "request libraries allow you to disable",
    "start": "958079",
    "end": "959839"
  },
  {
    "text": "tls sessions",
    "start": "959839",
    "end": "961440"
  },
  {
    "text": "in this case libkurl has the option but",
    "start": "961440",
    "end": "964480"
  },
  {
    "text": "isn't exposed by a php request library",
    "start": "964480",
    "end": "966560"
  },
  {
    "text": "such as guzzle",
    "start": "966560",
    "end": "967759"
  },
  {
    "text": "in any case adding a request timeout",
    "start": "967759",
    "end": "969920"
  },
  {
    "text": "made the attack pretty much",
    "start": "969920",
    "end": "971680"
  },
  {
    "text": "infeasible assuming people don't turn",
    "start": "971680",
    "end": "973199"
  },
  {
    "text": "their dns time to live values super low",
    "start": "973199",
    "end": "975279"
  },
  {
    "text": "on their servers",
    "start": "975279",
    "end": "976720"
  },
  {
    "text": "next claude was even generous enough to",
    "start": "976720",
    "end": "978480"
  },
  {
    "text": "give me a bounty even though in my",
    "start": "978480",
    "end": "980079"
  },
  {
    "text": "opinion this is lip girl's fault",
    "start": "980079",
    "end": "983839"
  },
  {
    "text": "so since the last couple were just text",
    "start": "984000",
    "end": "985839"
  },
  {
    "text": "slides let's see a real demo now from",
    "start": "985839",
    "end": "987680"
  },
  {
    "text": "the",
    "start": "987680",
    "end": "988079"
  },
  {
    "text": "perspective of a django web developer",
    "start": "988079",
    "end": "989920"
  },
  {
    "text": "getting phished",
    "start": "989920",
    "end": "991440"
  },
  {
    "text": "the dns or binding part has been done in",
    "start": "991440",
    "end": "993120"
  },
  {
    "text": "the past",
    "start": "993120",
    "end": "996079"
  },
  {
    "text": "uh but what's new here is combining dns",
    "start": "996079",
    "end": "998639"
  },
  {
    "text": "or binding with tls session persistence",
    "start": "998639",
    "end": "1000639"
  },
  {
    "text": "to make it even more powerful",
    "start": "1000639",
    "end": "1002880"
  },
  {
    "text": "in the past you had to get people to",
    "start": "1002880",
    "end": "1004320"
  },
  {
    "text": "visit a fully malicious page",
    "start": "1004320",
    "end": "1006800"
  },
  {
    "text": "to get anywhere with the nsr binding but",
    "start": "1006800",
    "end": "1008880"
  },
  {
    "text": "with my work you just",
    "start": "1008880",
    "end": "1010000"
  },
  {
    "text": "need you can do the same with just an",
    "start": "1010000",
    "end": "1011440"
  },
  {
    "text": "image tag because of that you can fish",
    "start": "1011440",
    "end": "1013680"
  },
  {
    "text": "people into rce",
    "start": "1013680",
    "end": "1015279"
  },
  {
    "text": "even if they just view an email but",
    "start": "1015279",
    "end": "1017440"
  },
  {
    "text": "don't click any links",
    "start": "1017440",
    "end": "1018800"
  },
  {
    "text": "let's see it now",
    "start": "1018800",
    "end": "1021600"
  },
  {
    "text": "and now for the actual demo so as you",
    "start": "1023279",
    "end": "1025678"
  },
  {
    "text": "can see",
    "start": "1025679",
    "end": "1026558"
  },
  {
    "text": "we're pretending i'm a django developer",
    "start": "1026559",
    "end": "1028880"
  },
  {
    "text": "running a typical app",
    "start": "1028880",
    "end": "1030798"
  },
  {
    "text": "but if we look at the app it's pretty",
    "start": "1030799",
    "end": "1032000"
  },
  {
    "text": "simple we can view a slot emoji",
    "start": "1032000",
    "end": "1034400"
  },
  {
    "text": "but if we refresh too fast the slot",
    "start": "1034400",
    "end": "1036640"
  },
  {
    "text": "needs to go to sleep",
    "start": "1036640",
    "end": "1038558"
  },
  {
    "text": "and now for what happens when i get",
    "start": "1038559",
    "end": "1039839"
  },
  {
    "text": "phished as you can see",
    "start": "1039839",
    "end": "1042400"
  },
  {
    "text": "i've received some perfectly legitimate",
    "start": "1042400",
    "end": "1044240"
  },
  {
    "text": "emails and i'm viewing them",
    "start": "1044240",
    "end": "1046798"
  },
  {
    "text": "normally these image tags would be",
    "start": "1046799",
    "end": "1048319"
  },
  {
    "text": "benign but after viewing them my sloth",
    "start": "1048319",
    "end": "1052480"
  },
  {
    "text": "now opens up a calculator",
    "start": "1052480",
    "end": "1054080"
  },
  {
    "text": "via shell command that's because the",
    "start": "1054080",
    "end": "1056559"
  },
  {
    "text": "image tag is pointed to by the dom",
    "start": "1056559",
    "end": "1058400"
  },
  {
    "text": "pointed to the domain with my rebinding",
    "start": "1058400",
    "end": "1060000"
  },
  {
    "text": "setup and a simple python picot payload",
    "start": "1060000",
    "end": "1066880"
  },
  {
    "text": "and here's most of the source code used",
    "start": "1066880",
    "end": "1068320"
  },
  {
    "text": "in the example app i created",
    "start": "1068320",
    "end": "1070160"
  },
  {
    "text": "you can pretty easily find apps that",
    "start": "1070160",
    "end": "1072160"
  },
  {
    "text": "call django.cor.cache around github",
    "start": "1072160",
    "end": "1074960"
  },
  {
    "text": "but i didn't want to demo against a",
    "start": "1074960",
    "end": "1076720"
  },
  {
    "text": "specific one because that seems a little",
    "start": "1076720",
    "end": "1078559"
  },
  {
    "text": "mean",
    "start": "1078559",
    "end": "1079360"
  },
  {
    "text": "and i don't want people launching actual",
    "start": "1079360",
    "end": "1081039"
  },
  {
    "text": "fishing campaigns against such projects",
    "start": "1081039",
    "end": "1084000"
  },
  {
    "text": "it's a little tough to assign blame here",
    "start": "1084000",
    "end": "1086080"
  },
  {
    "text": "nothing is really breaking from",
    "start": "1086080",
    "end": "1087600"
  },
  {
    "text": "establish safe practices but it's clear",
    "start": "1087600",
    "end": "1090240"
  },
  {
    "text": "that there's a potential to compromise",
    "start": "1090240",
    "end": "1091840"
  },
  {
    "text": "real world developer laptops",
    "start": "1091840",
    "end": "1096159"
  },
  {
    "text": "on that note there's a lot more to do",
    "start": "1096320",
    "end": "1097919"
  },
  {
    "text": "here that i couldn't possibly do on my",
    "start": "1097919",
    "end": "1099360"
  },
  {
    "text": "own",
    "start": "1099360",
    "end": "1100160"
  },
  {
    "text": "these slides will be available online if",
    "start": "1100160",
    "end": "1101679"
  },
  {
    "text": "you want to return to this",
    "start": "1101679",
    "end": "1103840"
  },
  {
    "text": "and if you do anything interesting i'd",
    "start": "1103840",
    "end": "1105200"
  },
  {
    "text": "love to hear about it there's certainly",
    "start": "1105200",
    "end": "1107120"
  },
  {
    "text": "a lot more potential vulnerabilities to",
    "start": "1107120",
    "end": "1108960"
  },
  {
    "text": "explore",
    "start": "1108960",
    "end": "1111280"
  },
  {
    "text": "so all of that is bad but what can be",
    "start": "1111280",
    "end": "1113360"
  },
  {
    "text": "done about it",
    "start": "1113360",
    "end": "1114400"
  },
  {
    "text": "let's start from the root of the problem",
    "start": "1114400",
    "end": "1115840"
  },
  {
    "text": "tls clients",
    "start": "1115840",
    "end": "1118720"
  },
  {
    "text": "so here's something i recommended to the",
    "start": "1118799",
    "end": "1120160"
  },
  {
    "text": "chromium team a while back we still",
    "start": "1120160",
    "end": "1122160"
  },
  {
    "text": "aren't in agreement about whether this",
    "start": "1122160",
    "end": "1123760"
  },
  {
    "text": "should be fixed and my report was pretty",
    "start": "1123760",
    "end": "1125360"
  },
  {
    "text": "hastily written which probably didn't",
    "start": "1125360",
    "end": "1127039"
  },
  {
    "text": "help things",
    "start": "1127039",
    "end": "1128320"
  },
  {
    "text": "essentially i'd like to remove the",
    "start": "1128320",
    "end": "1129760"
  },
  {
    "text": "ability for sessions to be resumed",
    "start": "1129760",
    "end": "1132480"
  },
  {
    "text": "between different servers while the",
    "start": "1132480",
    "end": "1135679"
  },
  {
    "text": "chromium team has marked this as it",
    "start": "1135679",
    "end": "1137039"
  },
  {
    "text": "won't fix they did suggest an",
    "start": "1137039",
    "end": "1138320"
  },
  {
    "text": "alternative",
    "start": "1138320",
    "end": "1139280"
  },
  {
    "text": "that maintains or support for resuming",
    "start": "1139280",
    "end": "1141679"
  },
  {
    "text": "sessions across servers",
    "start": "1141679",
    "end": "1143200"
  },
  {
    "text": "they probably care a lot more about that",
    "start": "1143200",
    "end": "1144640"
  },
  {
    "text": "than i do but we can have the best of",
    "start": "1144640",
    "end": "1146240"
  },
  {
    "text": "both worlds",
    "start": "1146240",
    "end": "1147280"
  },
  {
    "text": "this last option of just partitioning",
    "start": "1147280",
    "end": "1148880"
  },
  {
    "text": "based upon whether the address is",
    "start": "1148880",
    "end": "1150640"
  },
  {
    "text": "something local",
    "start": "1150640",
    "end": "1151760"
  },
  {
    "text": "is a good compromise it wouldn't affect",
    "start": "1151760",
    "end": "1153840"
  },
  {
    "text": "performance but would",
    "start": "1153840",
    "end": "1155120"
  },
  {
    "text": "be but would protect against most most",
    "start": "1155120",
    "end": "1157760"
  },
  {
    "text": "of the attack scenarios i can think of",
    "start": "1157760",
    "end": "1160160"
  },
  {
    "text": "but based on my experience so far i'm",
    "start": "1160160",
    "end": "1162480"
  },
  {
    "text": "not hopeful that there's going to be",
    "start": "1162480",
    "end": "1163919"
  },
  {
    "text": "much proactive effort",
    "start": "1163919",
    "end": "1165360"
  },
  {
    "text": "on the part of software packages that",
    "start": "1165360",
    "end": "1166799"
  },
  {
    "text": "make https requests",
    "start": "1166799",
    "end": "1168640"
  },
  {
    "text": "so for most of the audience it's more",
    "start": "1168640",
    "end": "1170320"
  },
  {
    "text": "useful to know what's susceptible and",
    "start": "1170320",
    "end": "1172480"
  },
  {
    "text": "what layers of defense can be applied",
    "start": "1172480",
    "end": "1174559"
  },
  {
    "text": "however with all of this it's worth",
    "start": "1174559",
    "end": "1176160"
  },
  {
    "text": "taking a step back to consider",
    "start": "1176160",
    "end": "1178320"
  },
  {
    "text": "is cl assumption session resumption even",
    "start": "1178320",
    "end": "1180400"
  },
  {
    "text": "worth it",
    "start": "1180400",
    "end": "1180920"
  },
  {
    "text": "[Music]",
    "start": "1180920",
    "end": "1182799"
  },
  {
    "text": "there are others issues with it some of",
    "start": "1182799",
    "end": "1185440"
  },
  {
    "text": "some of which are shown here",
    "start": "1185440",
    "end": "1187360"
  },
  {
    "text": "i'm not going to make the case that the",
    "start": "1187360",
    "end": "1188640"
  },
  {
    "text": "industry as a whole",
    "start": "1188640",
    "end": "1190799"
  },
  {
    "text": "should give up on this optimization but",
    "start": "1190799",
    "end": "1192799"
  },
  {
    "text": "we should take a step back and see if",
    "start": "1192799",
    "end": "1194320"
  },
  {
    "text": "this is a worthwhile trade-off",
    "start": "1194320",
    "end": "1196240"
  },
  {
    "text": "we may just like in the previous slide",
    "start": "1196240",
    "end": "1198080"
  },
  {
    "text": "find that the costs can be eliminated",
    "start": "1198080",
    "end": "1200880"
  },
  {
    "text": "but if we can't if we find that we can't",
    "start": "1200880",
    "end": "1203120"
  },
  {
    "text": "tackle these problems",
    "start": "1203120",
    "end": "1204400"
  },
  {
    "text": "we need to weigh them against the",
    "start": "1204400",
    "end": "1205520"
  },
  {
    "text": "benefits",
    "start": "1205520",
    "end": "1206150"
  },
  {
    "text": "[Music]",
    "start": "1206150",
    "end": "1216960"
  },
  {
    "text": "and here's the main benefit you get a",
    "start": "1216960",
    "end": "1219360"
  },
  {
    "text": "sizable performance improvement",
    "start": "1219360",
    "end": "1220880"
  },
  {
    "text": "on the small subset of packets that are",
    "start": "1220880",
    "end": "1222559"
  },
  {
    "text": "dls handshakes",
    "start": "1222559",
    "end": "1224559"
  },
  {
    "text": "you probably care about this whenever",
    "start": "1224559",
    "end": "1226400"
  },
  {
    "text": "you're in the position of serving up",
    "start": "1226400",
    "end": "1227840"
  },
  {
    "text": "a lot of tls connections",
    "start": "1227840",
    "end": "1230880"
  },
  {
    "text": "whatever percentage of cpu usage is due",
    "start": "1230880",
    "end": "1233120"
  },
  {
    "text": "to tls session",
    "start": "1233120",
    "end": "1234559"
  },
  {
    "text": "tls handshakes you probably want to keep",
    "start": "1234559",
    "end": "1236799"
  },
  {
    "text": "that load to minimize costs",
    "start": "1236799",
    "end": "1240000"
  },
  {
    "text": "but if you're like me you don't care i'm",
    "start": "1240000",
    "end": "1242320"
  },
  {
    "text": "taking on all the",
    "start": "1242320",
    "end": "1243440"
  },
  {
    "text": "security and privacy risk as just a",
    "start": "1243440",
    "end": "1245840"
  },
  {
    "text": "regular",
    "start": "1245840",
    "end": "1246640"
  },
  {
    "text": "internet user taking on all the",
    "start": "1246640",
    "end": "1250000"
  },
  {
    "text": "security and privacy risk of session",
    "start": "1250000",
    "end": "1251600"
  },
  {
    "text": "resumption but the amount that actually",
    "start": "1251600",
    "end": "1253200"
  },
  {
    "text": "saves on my powerball is probably pretty",
    "start": "1253200",
    "end": "1255120"
  },
  {
    "text": "minimal",
    "start": "1255120",
    "end": "1256159"
  },
  {
    "text": "additionally if you're running a web",
    "start": "1256159",
    "end": "1258240"
  },
  {
    "text": "application that you might",
    "start": "1258240",
    "end": "1260559"
  },
  {
    "text": "you might care about session resumption",
    "start": "1260559",
    "end": "1262000"
  },
  {
    "text": "on incoming connections",
    "start": "1262000",
    "end": "1263840"
  },
  {
    "text": "uh but when you are making an external",
    "start": "1263840",
    "end": "1265919"
  },
  {
    "text": "request it's probably not in your",
    "start": "1265919",
    "end": "1267760"
  },
  {
    "text": "interests",
    "start": "1267760",
    "end": "1268799"
  },
  {
    "text": "you're placing a lot of trust on random",
    "start": "1268799",
    "end": "1270320"
  },
  {
    "text": "websites not to redirect you",
    "start": "1270320",
    "end": "1272480"
  },
  {
    "text": "and own your local services so how you",
    "start": "1272480",
    "end": "1275440"
  },
  {
    "text": "how might you turn this off",
    "start": "1275440",
    "end": "1277919"
  },
  {
    "text": "here's what i found it's kind of sad",
    "start": "1277919",
    "end": "1280240"
  },
  {
    "text": "when stuff forces you into this",
    "start": "1280240",
    "end": "1281919"
  },
  {
    "text": "but at least as an internet user you can",
    "start": "1281919",
    "end": "1283760"
  },
  {
    "text": "pick firefox and disable session",
    "start": "1283760",
    "end": "1285360"
  },
  {
    "text": "identifiers if you're really paranoid",
    "start": "1285360",
    "end": "1287120"
  },
  {
    "text": "about this stuff",
    "start": "1287120",
    "end": "1288480"
  },
  {
    "text": "if you're running a web application",
    "start": "1288480",
    "end": "1290000"
  },
  {
    "text": "you're a bit stuck though what should",
    "start": "1290000",
    "end": "1291840"
  },
  {
    "text": "you do",
    "start": "1291840",
    "end": "1294080"
  },
  {
    "text": "first off it's a good idea in general to",
    "start": "1294400",
    "end": "1296400"
  },
  {
    "text": "run your outbound requests through a",
    "start": "1296400",
    "end": "1297679"
  },
  {
    "text": "proxy",
    "start": "1297679",
    "end": "1298640"
  },
  {
    "text": "especially if you're supporting web",
    "start": "1298640",
    "end": "1300080"
  },
  {
    "text": "hooks or some other ssrf prone feature",
    "start": "1300080",
    "end": "1302720"
  },
  {
    "text": "but also reconsider your infrastructure",
    "start": "1302720",
    "end": "1304720"
  },
  {
    "text": "decisions you'd be surprised just how",
    "start": "1304720",
    "end": "1306720"
  },
  {
    "text": "much stuff is still set up in a way that",
    "start": "1306720",
    "end": "1308400"
  },
  {
    "text": "is just one locally initiated tcp stream",
    "start": "1308400",
    "end": "1310880"
  },
  {
    "text": "away from compromise",
    "start": "1310880",
    "end": "1312120"
  },
  {
    "text": "[Music]",
    "start": "1312120",
    "end": "1314240"
  },
  {
    "text": "and here are the general takeaways the",
    "start": "1314240",
    "end": "1316240"
  },
  {
    "text": "thing i'd like to highlight is",
    "start": "1316240",
    "end": "1317600"
  },
  {
    "text": "if you're just starting out on the",
    "start": "1317600",
    "end": "1318880"
  },
  {
    "text": "offensive side of security i'd encourage",
    "start": "1318880",
    "end": "1320880"
  },
  {
    "text": "you to look at random standards and",
    "start": "1320880",
    "end": "1322320"
  },
  {
    "text": "browser features that come out",
    "start": "1322320",
    "end": "1324159"
  },
  {
    "text": "even if you don't fully understand them",
    "start": "1324159",
    "end": "1326000"
  },
  {
    "text": "at first find something that seems",
    "start": "1326000",
    "end": "1327760"
  },
  {
    "text": "interesting and start hacking around in",
    "start": "1327760",
    "end": "1329200"
  },
  {
    "text": "wireshark",
    "start": "1329200",
    "end": "1330480"
  },
  {
    "text": "i know i didn't understand tls and i",
    "start": "1330480",
    "end": "1332480"
  },
  {
    "text": "still don't really understand it",
    "start": "1332480",
    "end": "1333919"
  },
  {
    "text": "but as an attacker you only really need",
    "start": "1333919",
    "end": "1336720"
  },
  {
    "text": "to understand the worst parts",
    "start": "1336720",
    "end": "1338240"
  },
  {
    "text": "and that's what this is all about",
    "start": "1338240",
    "end": "1341360"
  },
  {
    "text": "and thank you here's my twitter and a",
    "start": "1341360",
    "end": "1343280"
  },
  {
    "text": "link to latakora where i work",
    "start": "1343280",
    "end": "1345280"
  },
  {
    "text": "they're a great place to work and have",
    "start": "1345280",
    "end": "1346640"
  },
  {
    "text": "been amazingly supportive of random",
    "start": "1346640",
    "end": "1348240"
  },
  {
    "text": "research directions i take",
    "start": "1348240",
    "end": "1349760"
  },
  {
    "text": "definitely take a look",
    "start": "1349760",
    "end": "1350750"
  },
  {
    "text": "[Music]",
    "start": "1350750",
    "end": "1354029"
  },
  {
    "text": "thanks everyone for watching and for all",
    "start": "1355440",
    "end": "1357360"
  },
  {
    "text": "the comments",
    "start": "1357360",
    "end": "1358559"
  },
  {
    "text": "i don't see any questions quite yet um",
    "start": "1358559",
    "end": "1361520"
  },
  {
    "text": "oh actually i do see one",
    "start": "1361520",
    "end": "1363440"
  },
  {
    "text": "uh when using an image proxy in your",
    "start": "1363440",
    "end": "1365200"
  },
  {
    "text": "email protects against this",
    "start": "1365200",
    "end": "1367039"
  },
  {
    "text": "that's a good question you'll notice uh",
    "start": "1367039",
    "end": "1370880"
  },
  {
    "text": "if you rewatched in the demo i used",
    "start": "1370880",
    "end": "1374000"
  },
  {
    "text": "microsoft uh outlook outlook",
    "start": "1374000",
    "end": "1377360"
  },
  {
    "text": "and not gmail um and that's actually due",
    "start": "1377360",
    "end": "1380240"
  },
  {
    "text": "to the fact that",
    "start": "1380240",
    "end": "1381200"
  },
  {
    "text": "uh you're correct like using when an",
    "start": "1381200",
    "end": "1384400"
  },
  {
    "text": "email provider uses",
    "start": "1384400",
    "end": "1386080"
  },
  {
    "text": "an image proxy that does to some extent",
    "start": "1386080",
    "end": "1389520"
  },
  {
    "text": "um protect end users against",
    "start": "1389520",
    "end": "1393039"
  },
  {
    "text": "uh against this although then the catch",
    "start": "1393039",
    "end": "1395280"
  },
  {
    "text": "of course is",
    "start": "1395280",
    "end": "1396240"
  },
  {
    "text": "email providers have to put some work",
    "start": "1396240",
    "end": "1397760"
  },
  {
    "text": "into",
    "start": "1397760",
    "end": "1399919"
  },
  {
    "text": "preventing esc's traffic against",
    "start": "1401039",
    "end": "1402400"
  },
  {
    "text": "themselves which of course you know",
    "start": "1402400",
    "end": "1404240"
  },
  {
    "text": "gmail being",
    "start": "1404240",
    "end": "1405120"
  },
  {
    "text": "as big as it is they've put that work in",
    "start": "1405120",
    "end": "1408159"
  },
  {
    "text": "um and i think uh i might not be",
    "start": "1408159",
    "end": "1411840"
  },
  {
    "text": "correct about this in all cases but uh",
    "start": "1411840",
    "end": "1414799"
  },
  {
    "text": "outlook uh does not use an",
    "start": "1414799",
    "end": "1416960"
  },
  {
    "text": "image proxy and that's why the demo",
    "start": "1416960",
    "end": "1419200"
  },
  {
    "text": "worked and not look",
    "start": "1419200",
    "end": "1422000"
  },
  {
    "text": "um let's see",
    "start": "1422880",
    "end": "1426799"
  },
  {
    "text": "see do you have a white paper on this um",
    "start": "1427440",
    "end": "1429919"
  },
  {
    "text": "so i didn't get around to uh",
    "start": "1429919",
    "end": "1432159"
  },
  {
    "text": "writing a white paper but there is",
    "start": "1432159",
    "end": "1433760"
  },
  {
    "text": "something close to it um",
    "start": "1433760",
    "end": "1436240"
  },
  {
    "text": "the github link has i wrote up the",
    "start": "1436240",
    "end": "1438799"
  },
  {
    "text": "readme",
    "start": "1438799",
    "end": "1439840"
  },
  {
    "text": "um it has at least some",
    "start": "1439840",
    "end": "1444080"
  },
  {
    "text": "uh some explanation of the attacks uh as",
    "start": "1444080",
    "end": "1446880"
  },
  {
    "text": "well as a little diagram",
    "start": "1446880",
    "end": "1448240"
  },
  {
    "text": "and uh instructions on how to set up the",
    "start": "1448240",
    "end": "1451360"
  },
  {
    "text": "infrastructure for yourself",
    "start": "1451360",
    "end": "1453520"
  },
  {
    "text": "um and the next question uh does this",
    "start": "1453520",
    "end": "1456720"
  },
  {
    "text": "work on all versions of tls",
    "start": "1456720",
    "end": "1458799"
  },
  {
    "text": "um so uh it works on",
    "start": "1458799",
    "end": "1463200"
  },
  {
    "text": "um",
    "start": "1463200",
    "end": "1465519"
  },
  {
    "text": "so it works i want to say you know with",
    "start": "1466960",
    "end": "1470240"
  },
  {
    "text": "tls implementations you get",
    "start": "1470240",
    "end": "1472400"
  },
  {
    "text": "uh it gets a bit fuzzy",
    "start": "1472400",
    "end": "1475679"
  },
  {
    "text": "um i think the features that this relies",
    "start": "1475679",
    "end": "1478159"
  },
  {
    "text": "on",
    "start": "1478159",
    "end": "1479200"
  },
  {
    "text": "um have been present since cls 1.2",
    "start": "1479200",
    "end": "1482559"
  },
  {
    "text": "although i think you know most stuff is",
    "start": "1482559",
    "end": "1485039"
  },
  {
    "text": "on 1.2 or 1.3 at least",
    "start": "1485039",
    "end": "1487520"
  },
  {
    "text": "um so you run into more as",
    "start": "1487520",
    "end": "1490720"
  },
  {
    "text": "if the actual request making the https",
    "start": "1490720",
    "end": "1493440"
  },
  {
    "text": "client library",
    "start": "1493440",
    "end": "1494880"
  },
  {
    "text": "um if that if that",
    "start": "1494880",
    "end": "1498400"
  },
  {
    "text": "uh implementation like has a cache on",
    "start": "1498400",
    "end": "1500480"
  },
  {
    "text": "its own so like if you",
    "start": "1500480",
    "end": "1501919"
  },
  {
    "text": "use like the built-in java https request",
    "start": "1501919",
    "end": "1504240"
  },
  {
    "text": "library uh method",
    "start": "1504240",
    "end": "1506000"
  },
  {
    "text": "um that will automatically cache",
    "start": "1506000",
    "end": "1507760"
  },
  {
    "text": "sessions for you which will make",
    "start": "1507760",
    "end": "1509760"
  },
  {
    "text": "you know if you have an sref",
    "start": "1509760",
    "end": "1512960"
  },
  {
    "text": "issue in your website this is a valid",
    "start": "1513039",
    "end": "1514880"
  },
  {
    "text": "approach to in the java application",
    "start": "1514880",
    "end": "1518320"
  },
  {
    "text": "um oh yes i'll re-share the github link",
    "start": "1518320",
    "end": "1524000"
  },
  {
    "text": "here",
    "start": "1526840",
    "end": "1529840"
  },
  {
    "text": "um let's see and what versions of tls",
    "start": "1531200",
    "end": "1536000"
  },
  {
    "text": "okay that was the same as the previous",
    "start": "1536000",
    "end": "1537760"
  },
  {
    "text": "one",
    "start": "1537760",
    "end": "1539200"
  },
  {
    "text": "oh yes okay and another question",
    "start": "1539200",
    "end": "1542960"
  },
  {
    "text": "what kind of payload can be set in a tls",
    "start": "1542960",
    "end": "1544640"
  },
  {
    "text": "ticket is binary data possible",
    "start": "1544640",
    "end": "1547039"
  },
  {
    "text": "like xo um i believe",
    "start": "1547039",
    "end": "1550320"
  },
  {
    "text": "i believe null bytes are possible um",
    "start": "1550320",
    "end": "1554240"
  },
  {
    "text": "it's just about anything because it's um",
    "start": "1554240",
    "end": "1557520"
  },
  {
    "text": "i believe it's a length prefix field um",
    "start": "1557520",
    "end": "1561039"
  },
  {
    "text": "the particular thing that you run into",
    "start": "1561039",
    "end": "1563279"
  },
  {
    "text": "or that you know",
    "start": "1563279",
    "end": "1565039"
  },
  {
    "text": "gets you a lot of the ssrf",
    "start": "1565039",
    "end": "1566880"
  },
  {
    "text": "vulnerabilities in practice",
    "start": "1566880",
    "end": "1568320"
  },
  {
    "text": "is uh is the new lines because that gets",
    "start": "1568320",
    "end": "1571520"
  },
  {
    "text": "you like memcached that gets you",
    "start": "1571520",
    "end": "1574080"
  },
  {
    "text": "smtp although it would be really",
    "start": "1574080",
    "end": "1576000"
  },
  {
    "text": "interesting trying to",
    "start": "1576000",
    "end": "1577760"
  },
  {
    "text": "attack uh non-newline delimited",
    "start": "1577760",
    "end": "1579679"
  },
  {
    "text": "protocols like",
    "start": "1579679",
    "end": "1580960"
  },
  {
    "text": "you know random binary debugging",
    "start": "1580960",
    "end": "1583120"
  },
  {
    "text": "protocols",
    "start": "1583120",
    "end": "1584080"
  },
  {
    "text": "which i haven't had any success with yet",
    "start": "1584080",
    "end": "1585760"
  },
  {
    "text": "but i imagine might be possible",
    "start": "1585760",
    "end": "1588720"
  },
  {
    "text": "um oh yes and you have an example of the",
    "start": "1588720",
    "end": "1592080"
  },
  {
    "text": "code used for the",
    "start": "1592080",
    "end": "1592960"
  },
  {
    "text": "calc.exe payload that",
    "start": "1592960",
    "end": "1596559"
  },
  {
    "text": "so that's buried within the github",
    "start": "1596559",
    "end": "1600240"
  },
  {
    "text": "link a bit i'm gonna try to find the",
    "start": "1600240",
    "end": "1603919"
  },
  {
    "text": "path here",
    "start": "1603919",
    "end": "1613840"
  },
  {
    "text": "let's see so it's in quiet hell",
    "start": "1614159",
    "end": "1617600"
  },
  {
    "text": "poisoning slash minimal django",
    "start": "1617600",
    "end": "1621840"
  },
  {
    "text": "um so in there i have a payload",
    "start": "1621840",
    "end": "1624080"
  },
  {
    "text": "memcached",
    "start": "1624080",
    "end": "1625760"
  },
  {
    "text": "file which has uh that has a d",
    "start": "1625760",
    "end": "1628799"
  },
  {
    "text": "serialization payload",
    "start": "1628799",
    "end": "1630559"
  },
  {
    "text": "um for attacking specifically uh",
    "start": "1630559",
    "end": "1634720"
  },
  {
    "text": "specifically django users and it's",
    "start": "1634720",
    "end": "1637440"
  },
  {
    "text": "specific to",
    "start": "1637440",
    "end": "1639200"
  },
  {
    "text": "uh it's specific to this application",
    "start": "1639200",
    "end": "1642720"
  },
  {
    "text": "because in order to load the payload you",
    "start": "1642720",
    "end": "1644720"
  },
  {
    "text": "do need to know like",
    "start": "1644720",
    "end": "1646080"
  },
  {
    "text": "what that name of the cache entry is um",
    "start": "1646080",
    "end": "1648960"
  },
  {
    "text": "so there is",
    "start": "1648960",
    "end": "1650159"
  },
  {
    "text": "you know in terms of practical",
    "start": "1650159",
    "end": "1652799"
  },
  {
    "text": "exploitation of this",
    "start": "1652799",
    "end": "1654000"
  },
  {
    "text": "you know it does depend on some recon",
    "start": "1654000",
    "end": "1656240"
  },
  {
    "text": "and some knowledge of",
    "start": "1656240",
    "end": "1657200"
  },
  {
    "text": "what application you're attacking um of",
    "start": "1657200",
    "end": "1659520"
  },
  {
    "text": "course if it's open source",
    "start": "1659520",
    "end": "1660880"
  },
  {
    "text": "which some of some of the apps i found",
    "start": "1660880",
    "end": "1664640"
  },
  {
    "text": "uh are um then that's a lot easier",
    "start": "1664640",
    "end": "1669840"
  },
  {
    "text": "let's see",
    "start": "1670240",
    "end": "1672720"
  },
  {
    "text": "oh here's another question i'm seeing in",
    "start": "1677440",
    "end": "1679360"
  },
  {
    "text": "the chat if a deep inspection firewall",
    "start": "1679360",
    "end": "1681840"
  },
  {
    "text": "was able to block",
    "start": "1681840",
    "end": "1682880"
  },
  {
    "text": "external dns supplies that had internal",
    "start": "1682880",
    "end": "1685039"
  },
  {
    "text": "answers",
    "start": "1685039",
    "end": "1686080"
  },
  {
    "text": "including locos would that mitigate the",
    "start": "1686080",
    "end": "1688000"
  },
  {
    "text": "dns refining impact",
    "start": "1688000",
    "end": "1691440"
  },
  {
    "text": "um",
    "start": "1694840",
    "end": "1697360"
  },
  {
    "text": "i think this is an angle i haven't",
    "start": "1697360",
    "end": "1698399"
  },
  {
    "text": "thought about as much um",
    "start": "1698399",
    "end": "1701679"
  },
  {
    "text": "i want to say there is uh",
    "start": "1701679",
    "end": "1704960"
  },
  {
    "text": "there is in terms of generic dns",
    "start": "1704960",
    "end": "1708000"
  },
  {
    "text": "rebinding",
    "start": "1708000",
    "end": "1709120"
  },
  {
    "text": "defenses uh i have seen some stuff",
    "start": "1709120",
    "end": "1714159"
  },
  {
    "text": "uh",
    "start": "1714159",
    "end": "1716399"
  },
  {
    "text": "i don't know what what they actually uh",
    "start": "1719840",
    "end": "1722640"
  },
  {
    "text": "what's actually been implemented",
    "start": "1722640",
    "end": "1724559"
  },
  {
    "text": "um but i think you know like on my home",
    "start": "1724559",
    "end": "1728159"
  },
  {
    "text": "network i have like a pie haul",
    "start": "1728159",
    "end": "1730240"
  },
  {
    "text": "um blocking ads and i think i've seen",
    "start": "1730240",
    "end": "1734000"
  },
  {
    "text": "a uh i think i've seen some so",
    "start": "1734000",
    "end": "1737840"
  },
  {
    "text": "like a plug-in for pie hole or something",
    "start": "1737840",
    "end": "1739279"
  },
  {
    "text": "like that that does",
    "start": "1739279",
    "end": "1740960"
  },
  {
    "text": "try to mitigate dns or binding i don't",
    "start": "1740960",
    "end": "1742559"
  },
  {
    "text": "remember if it's by just",
    "start": "1742559",
    "end": "1744799"
  },
  {
    "text": "um keeping like dns ttl values really",
    "start": "1744799",
    "end": "1748640"
  },
  {
    "text": "really high",
    "start": "1748640",
    "end": "1749840"
  },
  {
    "text": "um that's a good question um",
    "start": "1749840",
    "end": "1753840"
  },
  {
    "text": "it may be a little bit more in the",
    "start": "1753840",
    "end": "1754960"
  },
  {
    "text": "general dns refining",
    "start": "1754960",
    "end": "1757279"
  },
  {
    "text": "attack category",
    "start": "1757279",
    "end": "1760159"
  },
  {
    "text": "all right i think",
    "start": "1761600",
    "end": "1767039"
  },
  {
    "text": "see i think that's all the questions um",
    "start": "1767039",
    "end": "1770159"
  },
  {
    "text": "thank you everyone for watching and for",
    "start": "1770159",
    "end": "1771840"
  },
  {
    "text": "all the kind words in the chat",
    "start": "1771840",
    "end": "1776880"
  }
]