[
  {
    "text": "what's up",
    "start": "5120",
    "end": "8359"
  },
  {
    "text": "work with Darren and you might be asking yourself what does USB have to do with web app security and the answer is",
    "start": "29820",
    "end": "36600"
  },
  {
    "text": "absolutely nothing this was just a fun project for us we're not releasing any new products or anything of that nature",
    "start": "36600",
    "end": "45079"
  },
  {
    "text": "all right real quick um I just want to make sure that everyone's clear on what it is that we're going to present today there's been some postings",
    "start": "46440",
    "end": "53100"
  },
  {
    "text": "out on the web and things about this presentation that might have led people to believe that we have a vulnerability",
    "start": "53100",
    "end": "58800"
  },
  {
    "text": "in the overall implementation of USB that is not the case what we have are we",
    "start": "58800",
    "end": "63899"
  },
  {
    "text": "we are going to be able to Target some windows specific drivers that are installed by default on every Windows",
    "start": "63899",
    "end": "70260"
  },
  {
    "text": "operating system 2000 and later and we will Target those this same device that we have however is USB 2.0 compliant and",
    "start": "70260",
    "end": "78420"
  },
  {
    "text": "can be tested against Linux OS X you know whatever whatever you want to test against to look for issues in drivers",
    "start": "78420",
    "end": "85380"
  },
  {
    "text": "and those operating systems as well anyway moving on",
    "start": "85380",
    "end": "90960"
  },
  {
    "text": "this is where the presentation would generally have started uh so who wouldn't plug these devices in right you",
    "start": "90960",
    "end": "97860"
  },
  {
    "text": "show up for work there's an empty cube next to you there's a really cool optical USB mouse sitting in that Cube and no one else there you might say my",
    "start": "97860",
    "end": "105000"
  },
  {
    "text": "it guy probably left that there for me I think I should uh think I should take it right or you know a new USB keyboard or",
    "start": "105000",
    "end": "111899"
  },
  {
    "text": "someone hands you a USB thumb drive says hey man check out these files you're going to want to see what I got here",
    "start": "111899",
    "end": "117479"
  },
  {
    "text": "plug that in the problem is they could be owning you what we're going to show you are a",
    "start": "117479",
    "end": "122880"
  },
  {
    "text": "couple of different devices that are able to execute code upon insertion into a PC some of the things we're going to",
    "start": "122880",
    "end": "130259"
  },
  {
    "text": "show you are some OS level issues USB auto run from a memory stick we're going",
    "start": "130259",
    "end": "135900"
  },
  {
    "text": "to talk about usb protocol enforcement and how we were able to build a device that is the technical equivalent of raw",
    "start": "135900",
    "end": "141599"
  },
  {
    "text": "sockets at the USB layer so attack vectors one of the things that",
    "start": "141599",
    "end": "147239"
  },
  {
    "text": "we typically hear and you know we've seen a lot of postings on the web are why do I need this USB device if I have",
    "start": "147239",
    "end": "153239"
  },
  {
    "text": "physical access to the machine I Own It Anyway already right law number three kind of stuff",
    "start": "153239",
    "end": "158400"
  },
  {
    "text": "the uh issue there is that that's not really the intent of this kind of device we",
    "start": "158400",
    "end": "163980"
  },
  {
    "text": "basically have a hardware Trojan right so if I can build a device that looks like a thumb drive I slap somebody's",
    "start": "163980",
    "end": "170340"
  },
  {
    "text": "company right on the side of it make it look like just ultimate marketing swag then I take a fist full of them and I",
    "start": "170340",
    "end": "175980"
  },
  {
    "text": "drop them in a fishbowl out on one of these tables out here now everyone walks by picks it up they root themselves if",
    "start": "175980",
    "end": "181739"
  },
  {
    "text": "we install a root kit on there that perhaps phones home something of that nature we are able to distribute this",
    "start": "181739",
    "end": "187260"
  },
  {
    "text": "malware via effectively a hardware Trojan the cool thing about this type of",
    "start": "187260",
    "end": "193560"
  },
  {
    "text": "attack as well is let's say you go and you pick up one of these thumb drives you plug it in you get the newest",
    "start": "193560",
    "end": "199980"
  },
  {
    "text": "pictures of Paris Hilton whatever you upload those onto your thumb drive and you want to show them to your buddy but",
    "start": "199980",
    "end": "205440"
  },
  {
    "text": "you don't want to email them because you know you don't want to get caught sending pictures of Paris Hilton across Corporate email so you take your thumb",
    "start": "205440",
    "end": "211560"
  },
  {
    "text": "drive and you hand it to them say hey man plug this in check out what I got there we now have the effect of a",
    "start": "211560",
    "end": "216959"
  },
  {
    "text": "sneakernet worm very similar to the you know floppy viruses of the of the 80s you know very same type of attack",
    "start": "216959",
    "end": "224519"
  },
  {
    "text": "we do get the walk up and own attack Vector as well so a lot of people say again you know if",
    "start": "224519",
    "end": "230879"
  },
  {
    "text": "I've got physical access to the machine why do I need this USB thumb drive I could just boot off a CD I could hit it",
    "start": "230879",
    "end": "236940"
  },
  {
    "text": "with a sledgehammer I could just steal the hard drive out of it well think of it this way right uh say we're walking",
    "start": "236940",
    "end": "242400"
  },
  {
    "text": "around a retailer Best Buy Circuit City one of those",
    "start": "242400",
    "end": "247620"
  },
  {
    "text": "things there's point of sale stations all over the store right how many times have you walked by and said hey man that",
    "start": "247620",
    "end": "253080"
  },
  {
    "text": "thing's running XP awesome right so you don't want to be standing in the middle of a store with a sledgehammer right or",
    "start": "253080",
    "end": "260459"
  },
  {
    "text": "a you know power drill pulling out a pulling out a hard drive you could actually effectively though walk right",
    "start": "260459",
    "end": "266880"
  },
  {
    "text": "up slip a USB thumb drive in let it sit there for 10 seconds pull it out walk away and in effect you know install some",
    "start": "266880",
    "end": "273479"
  },
  {
    "text": "type of software that records every credit card transaction that's gone through that machine whatever you need come back in a week plug in a different",
    "start": "273479",
    "end": "280380"
  },
  {
    "text": "USB thumb drive extract all that data and you have you know stolen data from that machine with two 10 second attacks",
    "start": "280380",
    "end": "287280"
  },
  {
    "text": "where no one ever saw it especially with these types of really cool monitors that",
    "start": "287280",
    "end": "292380"
  },
  {
    "text": "everyone has now the you know the nice Dell flat panel with the USB ports right in the side of the monitor right you",
    "start": "292380",
    "end": "297660"
  },
  {
    "text": "don't even have to reach under the counter you just walk right up stick that thing in the side walk away do some shopping right",
    "start": "297660",
    "end": "303720"
  },
  {
    "text": "Darren and I are headed to Fry's after the presentation anyone want to come",
    "start": "303720",
    "end": "308840"
  },
  {
    "text": "another attack Vector empty the trash right hand one to your janitor they don't need to know anything about",
    "start": "309540",
    "end": "314699"
  },
  {
    "text": "hacking they don't even know what they're doing they don't even know what you just handed them right you just say take this stick it in the port that",
    "start": "314699",
    "end": "320580"
  },
  {
    "text": "matches that shape on the side of the Monitor and pull it out you know in 10 seconds thanks and he'll go 20 bucks",
    "start": "320580",
    "end": "326880"
  },
  {
    "text": "awesome all right",
    "start": "326880",
    "end": "332340"
  },
  {
    "text": "so there's been a lot of discussion on the web about how to make auto run work from a USB thumb drive I've seen a lot",
    "start": "332340",
    "end": "339600"
  },
  {
    "text": "of postings about hacking the registry changing some bit values to make Windows",
    "start": "339600",
    "end": "345360"
  },
  {
    "text": "run something from a thumb drive that's not exactly a very cool attack right and",
    "start": "345360",
    "end": "351300"
  },
  {
    "text": "you know I can own you as long as you've changed your registry right that's not that's not cool so basically auto run on",
    "start": "351300",
    "end": "358740"
  },
  {
    "text": "a Windows box will only work with non-removable media by default you know out of the box install the windows so",
    "start": "358740",
    "end": "364740"
  },
  {
    "text": "how do we make our USB thumb drive appear to be non-removable media never mind the man behind the curtain",
    "start": "364740",
    "end": "370740"
  },
  {
    "text": "we're getting power",
    "start": "370740",
    "end": "373400"
  },
  {
    "text": "perfect thank you all right okay so many USB thumb drives",
    "start": "381360",
    "end": "387000"
  },
  {
    "text": "or USB controllers support what is called in-system programming in-system programming allows you to",
    "start": "387000",
    "end": "393780"
  },
  {
    "text": "insert the thumb drive into your system you it comes with a client piece of software and allows you to basically",
    "start": "393780",
    "end": "399479"
  },
  {
    "text": "reconfigure the device the reason that they came out with this type of technology is things like authentication",
    "start": "399479",
    "end": "405660"
  },
  {
    "text": "tokens USB thumb drives that are meant to you know two-factor authentication if there's ever a firmware upgrade that's",
    "start": "405660",
    "end": "412319"
  },
  {
    "text": "needed for that thumb drive they don't want to have to ship you a whole new thumb drive to make that work so what",
    "start": "412319",
    "end": "417539"
  },
  {
    "text": "they do is they embed an in-system programming client into their piece of software and that way if there's a",
    "start": "417539",
    "end": "423180"
  },
  {
    "text": "firmware upgrade they can actually deploy the firmware upgrade as part of a software patch so it comes down to your client you use the in-system programming",
    "start": "423180",
    "end": "430199"
  },
  {
    "text": "client it updates your thumb drive I use the same procedure to go ahead and make",
    "start": "430199",
    "end": "435780"
  },
  {
    "text": "my thumb drive tell windows that it's something other than a thumb drive so what would we be able to do with this",
    "start": "435780",
    "end": "441840"
  },
  {
    "text": "uh with autorun it works okay for the hardware Trojan or sneakernet worm approach person's already sitting at",
    "start": "441840",
    "end": "448319"
  },
  {
    "text": "their workstation they know nothing of it they go ahead and plug it in they have that code executed it's not totally",
    "start": "448319",
    "end": "455039"
  },
  {
    "text": "reliable for the walk-up and Own auto run does not work on a locked workstation so if you have the the",
    "start": "455039",
    "end": "460860"
  },
  {
    "text": "workstation locked you will not be able to execute an auto on attack old concept new packaging right we all saw this in",
    "start": "460860",
    "end": "467639"
  },
  {
    "text": "Windows 95 with people creating CDs you know hey check this out it's you know Metallica no it's not it's owning your",
    "start": "467639",
    "end": "474960"
  },
  {
    "text": "box right same concept just a new package so in this particular case it doesn't",
    "start": "474960",
    "end": "481080"
  },
  {
    "text": "look like a CD drive but your OS thinks it is",
    "start": "481080",
    "end": "486918"
  },
  {
    "text": "so I've got that thumb drive I'm sure you can't see this let me go ahead and plug that in here",
    "start": "487919",
    "end": "494780"
  },
  {
    "text": "and there we have a window in case you can't read that installing rootkit",
    "start": "498240",
    "end": "503520"
  },
  {
    "text": "so um thankfully the author of this root",
    "start": "503520",
    "end": "508680"
  },
  {
    "text": "kit allows us to cancel the install what a nice guy",
    "start": "508680",
    "end": "513379"
  },
  {
    "text": "yeah you can even get a dialog box it wasn't even backgrounded okay",
    "start": "515180",
    "end": "520260"
  },
  {
    "text": "let me catch up with myself so here's why this attack is lame okay",
    "start": "520260",
    "end": "526680"
  },
  {
    "text": "attack is in user space you know sure in Windows there's plenty of ways to escalate privileges but we're a device",
    "start": "526680",
    "end": "532620"
  },
  {
    "text": "why should we be a device that inserts ourselves at the kernel level comes back up to user space and then goes back down",
    "start": "532620",
    "end": "538860"
  },
  {
    "text": "to the kernel level so it would be a whole lot cooler if we didn't have to make that travel and auto run must be",
    "start": "538860",
    "end": "543899"
  },
  {
    "text": "enabled it's a security conference I would say that many if not the majority",
    "start": "543899",
    "end": "549120"
  },
  {
    "text": "of you in the in the audience here have auto run disabled on your laptop so I would not be able to take my spy",
    "start": "549120",
    "end": "554760"
  },
  {
    "text": "Dynamics marketing swag and install my root kit",
    "start": "554760",
    "end": "559339"
  },
  {
    "text": "let's talk about some devices that don't have that type of dependency",
    "start": "559980",
    "end": "565040"
  },
  {
    "text": "let's see great you need a little more space up here all right",
    "start": "572220",
    "end": "580440"
  },
  {
    "text": "oh already there",
    "start": "580440",
    "end": "583940"
  },
  {
    "text": "how do you get rid of feedback let me turn mine on",
    "start": "585720",
    "end": "590180"
  },
  {
    "text": "okay is this thing on well when this project first sort of",
    "start": "590760",
    "end": "596760"
  },
  {
    "text": "came about I was just getting back into hardware and all that fun stuff what I when I came when it came time to",
    "start": "596760",
    "end": "603899"
  },
  {
    "text": "make this I had to just come up with some requirements and I was just poking around and I realized that the layer to",
    "start": "603899",
    "end": "610019"
  },
  {
    "text": "attack is where the plug meets the operating system it's called the Hub it's just basically a chip on your",
    "start": "610019",
    "end": "616680"
  },
  {
    "text": "laptop or maybe part of a really big LSI module but uh I need I realized I needed to",
    "start": "616680",
    "end": "622440"
  },
  {
    "text": "talk to that so I started working out different things",
    "start": "622440",
    "end": "628339"
  },
  {
    "text": "and then once I can once I'm talking to that I can work my way through the layers from from the first The Hub layer",
    "start": "631140",
    "end": "637440"
  },
  {
    "text": "to the uh to the kernel level where I can talk to the operating system maybe coax into loading some drivers",
    "start": "637440",
    "end": "644220"
  },
  {
    "text": "and then if I have control of the device that's doing the talking I can have it",
    "start": "644220",
    "end": "649740"
  },
  {
    "text": "alter things even on the Fly you know it plugs in it says it has four gigabytes of storage and then I can back it off to",
    "start": "649740",
    "end": "655320"
  },
  {
    "text": "one and see what happens and I wanted to use off-the-shelf parts and just for my sake because I was doing",
    "start": "655320",
    "end": "663060"
  },
  {
    "text": "this for fun not not an official spy event or anything it was just some Hardware fun I was having I wanted to",
    "start": "663060",
    "end": "668760"
  },
  {
    "text": "use off the shelf and low-cost parts and while I'm programmer by trade so I wanted to make it a largely software",
    "start": "668760",
    "end": "674579"
  },
  {
    "text": "solution so what I started with was a Z8 evaluation",
    "start": "674579",
    "end": "680160"
  },
  {
    "text": "kit and picked it up off a digikey it was about 40 bucks oh sorry",
    "start": "680160",
    "end": "685440"
  },
  {
    "text": "remember to push the button anyway yeah it's just a little it's just this little demo board has all kinds of neat little",
    "start": "685440",
    "end": "690540"
  },
  {
    "text": "features on it and some headers for hooking up boards and well even some buttons and Blinky",
    "start": "690540",
    "end": "697079"
  },
  {
    "text": "lights then I started adding fun things made it into this what we're seeing here",
    "start": "697079",
    "end": "702120"
  },
  {
    "text": "is my fancy plcc flavor nice big chip you can place it by hand",
    "start": "702120",
    "end": "707820"
  },
  {
    "text": "and a 48 megahertz oscillator another nice big piece and various resistors and capacitors for making it act like a real",
    "start": "707820",
    "end": "714839"
  },
  {
    "text": "USB device the original board I did do we have a picture of that one",
    "start": "714839",
    "end": "720540"
  },
  {
    "text": "okay well it started out with a thin small outline package it was a lot more difficult to place but still perfectly",
    "start": "720540",
    "end": "727740"
  },
  {
    "text": "obtainable",
    "start": "727740",
    "end": "730220"
  },
  {
    "text": "which way oh sorry uh oh I need someone just smack me on the back",
    "start": "733620",
    "end": "739200"
  },
  {
    "text": "of the head and say louder all right anyway but if I can go back here all it is you",
    "start": "739200",
    "end": "746640"
  },
  {
    "text": "can sort of see it at the bottom there there is a USB Jack and I even rigged it up for self power so you just walk right",
    "start": "746640",
    "end": "752760"
  },
  {
    "text": "up plug it in uh there's for all sorts of chips available out there a lot of them are by",
    "start": "752760",
    "end": "759300"
  },
  {
    "text": "the big name like Philips and Intel they're on the USB Consortium all that fun stuff but they tend to favor LSI",
    "start": "759300",
    "end": "766260"
  },
  {
    "text": "large scale integration where the chips take care of just about everything for you I mean you just basically it says",
    "start": "766260",
    "end": "771959"
  },
  {
    "text": "here's your bites you have anything to send back and you know you everything's out of your hands I tracked down an",
    "start": "771959",
    "end": "778680"
  },
  {
    "text": "antique of a chip called the sl811 it was one of the first generation or this is a second generation ship it was",
    "start": "778680",
    "end": "784980"
  },
  {
    "text": "originally developed by scanlogic for their scanners and in the 95 days but it relies heavily on the controller CPU",
    "start": "784980",
    "end": "793920"
  },
  {
    "text": "so with that kind of Reliance that left everything in my hands",
    "start": "793920",
    "end": "800180"
  },
  {
    "text": "when you plug in a USB device one of the first things that's requested is the vid vendor ID",
    "start": "800700",
    "end": "806660"
  },
  {
    "text": "you can pick one up yourself for the low low price of about two thousand dollars but don't quote me on that",
    "start": "806660",
    "end": "813720"
  },
  {
    "text": "um I would my goal wasn't to be compliant and then uh within your vendor ID you can then have a product ID so you can",
    "start": "813720",
    "end": "820740"
  },
  {
    "text": "have up to 65 000 products hey got rid of that good so you can have",
    "start": "820740",
    "end": "826680"
  },
  {
    "text": "all you can have as many products as you want within that vendor ID and then between those two those two values uh an",
    "start": "826680",
    "end": "832920"
  },
  {
    "text": "operating system can figure out what's just been plugged in the idea is they're relatively unique to",
    "start": "832920",
    "end": "839399"
  },
  {
    "text": "the device uh oh I've got way ahead here all right",
    "start": "839399",
    "end": "845660"
  },
  {
    "text": "anyway uh and then uh yeah within after the the",
    "start": "846120",
    "end": "851700"
  },
  {
    "text": "device identifies itself somewhat POS there's some string values that are available the string just the the string",
    "start": "851700",
    "end": "858420"
  },
  {
    "text": "descriptor in USB is a fairly simple structure the first place length",
    "start": "858420",
    "end": "863639"
  },
  {
    "text": "but it's only a byte and you have up to 255 characters and that includes the two byte headers so you're left with 253",
    "start": "863639",
    "end": "869639"
  },
  {
    "text": "probably not not much fun for overflows but I played with that too and then after that you just tag on the string",
    "start": "869639",
    "end": "876240"
  },
  {
    "text": "data which is in unicode and then between all these little bits the US probably has a good idea of",
    "start": "876240",
    "end": "881880"
  },
  {
    "text": "what's just been plugged in and begins to load drivers but there's a new twist with USB 2.0",
    "start": "881880",
    "end": "888180"
  },
  {
    "text": "called class drivers it allows for broader definitions of devices like the",
    "start": "888180",
    "end": "893459"
  },
  {
    "text": "storage devices and mice and keyboards and video terminals",
    "start": "893459",
    "end": "900540"
  },
  {
    "text": "and the nice thing is those drivers tend to be included with the OS because they were going to get compliance and those",
    "start": "900540",
    "end": "906360"
  },
  {
    "text": "devices are required those drivers are required and I mean like I say there are just",
    "start": "906360",
    "end": "911639"
  },
  {
    "text": "classes for everything I mean even Imaging and infrared things obviously the mass storage that everyone",
    "start": "911639",
    "end": "918540"
  },
  {
    "text": "loves to play with so and the class definition is also",
    "start": "918540",
    "end": "926459"
  },
  {
    "text": "provided by the device as just another couple of bytes within one of the descriptors that's requested at the startup",
    "start": "926459",
    "end": "932820"
  },
  {
    "text": "well my sl811 chip doesn't store them internally it relies on the host controller to provide them",
    "start": "932820",
    "end": "939120"
  },
  {
    "text": "well hmm that sounds like software control for me so let's see what happens",
    "start": "939120",
    "end": "946800"
  },
  {
    "text": "well to when you plug in a device it signals its Presence by tying a 3.3 volt",
    "start": "946800",
    "end": "952320"
  },
  {
    "text": "signal to one of the data lines if you use the d-plus line I really don't have I didn't want to go into this much",
    "start": "952320",
    "end": "958139"
  },
  {
    "text": "detail but since I'm there USB uses two data lines D plus and D",
    "start": "958139",
    "end": "963540"
  },
  {
    "text": "minus if you tie a three volt signal to the D plus line the host seems to think that a high speed yeah high speed device",
    "start": "963540",
    "end": "970680"
  },
  {
    "text": "no full sorry a full speed device was plugged in if you tie it to D minus it",
    "start": "970680",
    "end": "976440"
  },
  {
    "text": "thinks it's a low speed like a mouse and grab this excuse me",
    "start": "976440",
    "end": "982519"
  },
  {
    "text": "sorry so now since that signal is just tied between a resistor and a data line",
    "start": "984560",
    "end": "991139"
  },
  {
    "text": "we can throw a switch in line I use just an ordinary uh npn general purpose transistor",
    "start": "991139",
    "end": "997259"
  },
  {
    "text": "well transistors are electronic switches I have an electronic device so now I can just flip a bit and that device unplugs",
    "start": "997259",
    "end": "1003259"
  },
  {
    "text": "itself plugs itself back in under software control so now I can basically test one thing if",
    "start": "1003259",
    "end": "1010519"
  },
  {
    "text": "nothing happens through the switch unplugs we can test something else all right we do need to",
    "start": "1010519",
    "end": "1018879"
  },
  {
    "text": "a little angle out here",
    "start": "1019279",
    "end": "1024100"
  },
  {
    "text": "so I went just added a little extra code here and now I have",
    "start": "1040400",
    "end": "1045678"
  },
  {
    "text": "see I'm going to poke a button at random here let's see what this thing does",
    "start": "1045679",
    "end": "1052340"
  },
  {
    "text": "oh and I used black light for black hat",
    "start": "1052340",
    "end": "1056679"
  },
  {
    "text": "okay",
    "start": "1057559",
    "end": "1059919"
  },
  {
    "text": "come on it's only a Z8 give me a break",
    "start": "1062600",
    "end": "1066400"
  },
  {
    "text": "man look at that does this look like a CD-ROM probably not",
    "start": "1069620",
    "end": "1075440"
  },
  {
    "text": "let's see what happens here what ah",
    "start": "1075440",
    "end": "1080080"
  },
  {
    "text": "rats hey it's a prototype give me a break all right one more time here",
    "start": "1080720",
    "end": "1089380"
  },
  {
    "text": "now there we go",
    "start": "1107960",
    "end": "1110980"
  },
  {
    "text": "oh come on you didn't want me to do file system too now did you",
    "start": "1113059",
    "end": "1117880"
  },
  {
    "text": "but it's an option maybe next year all right well let's see",
    "start": "1118400",
    "end": "1123440"
  },
  {
    "text": "what happens now I'm going to poke this button yeah the CD disappeared",
    "start": "1123440",
    "end": "1130000"
  },
  {
    "text": "all right but again this is all done in user land and all that boring things now let's have a little more fun",
    "start": "1148640",
    "end": "1155960"
  },
  {
    "text": "all right let's where'd that go",
    "start": "1155960",
    "end": "1161980"
  },
  {
    "text": "okay to left",
    "start": "1162140",
    "end": "1167440"
  },
  {
    "text": "and what we what I have here is a screenshot of a fuzzing program I started on just to try different things",
    "start": "1181580",
    "end": "1188000"
  },
  {
    "text": "it just gives you convenient interface for just picking values uh you want to play",
    "start": "1188000",
    "end": "1194780"
  },
  {
    "text": "with the vendor ID change it up at the top I'm going to play with the product ID or the",
    "start": "1194780",
    "end": "1199940"
  },
  {
    "text": "identification strings it's over on the side there or and a complete readout of the sl811",
    "start": "1199940",
    "end": "1207020"
  },
  {
    "text": "status just poke buttons you can update things I mean you can't do it you can't do it yourself but it's just useful for",
    "start": "1207020",
    "end": "1213679"
  },
  {
    "text": "readout purposes and then at the bottom it was just some more places for picking strings and",
    "start": "1213679",
    "end": "1220299"
  },
  {
    "text": "descriptor values well since uh I can emulate it I mean I",
    "start": "1220299",
    "end": "1227179"
  },
  {
    "text": "can emulate any kind of device I want I can pick from the classes or manufacturer supplied drivers if you",
    "start": "1227179",
    "end": "1233720"
  },
  {
    "text": "know that they're if you know they're present in the case of the vendor supplied if the hardware developers working closely",
    "start": "1233720",
    "end": "1240500"
  },
  {
    "text": "with the software developer and just says that hey it's only got a 32 byte buffer uh well is the software guy going to",
    "start": "1240500",
    "end": "1248419"
  },
  {
    "text": "malloc 32 bytes or is he just going to char 32 go",
    "start": "1248419",
    "end": "1254660"
  },
  {
    "text": "so we can exploit that relationship if if it becomes available",
    "start": "1254660",
    "end": "1260260"
  },
  {
    "text": "well real quick Darren if I might um we're about to demo two bugs in Windows",
    "start": "1264440",
    "end": "1271280"
  },
  {
    "text": "uh drivers that are installed by default with Windows Microsoft has been notified of these bugs however we ran into a bit",
    "start": "1271280",
    "end": "1278720"
  },
  {
    "text": "of a time crunch and they have not had adequate time to uh create a patch so we",
    "start": "1278720",
    "end": "1284240"
  },
  {
    "text": "will not be taking these through full exploitation but we will be demoing that the bugs are in fact there and there",
    "start": "1284240",
    "end": "1289760"
  },
  {
    "text": "will be no doubt in your mind that these bugs exist I can promise you that all right this first one is just the",
    "start": "1289760",
    "end": "1297919"
  },
  {
    "text": "operating system expecting me to play by the USB rules uh in the spec it says if your descriptor doesn't want to include",
    "start": "1297919",
    "end": "1304640"
  },
  {
    "text": "a string you're supposed to zero that value well if I'm not one to play by the rules",
    "start": "1304640",
    "end": "1311720"
  },
  {
    "text": "oh wait we gotta do this first oh my God I do oh good point",
    "start": "1311720",
    "end": "1318159"
  },
  {
    "text": "a quick something here anyway so we're gonna looks like we're loading",
    "start": "1318159",
    "end": "1324020"
  },
  {
    "text": "up the CX register with some value somewhere and then decrementing it and shifting it and",
    "start": "1324020",
    "end": "1330200"
  },
  {
    "text": "ooh what are we about to do move 3ff wow",
    "start": "1330200",
    "end": "1336380"
  },
  {
    "text": "we're going to shift your entire memory map a few bytes to the left now aren't we",
    "start": "1336380",
    "end": "1341620"
  },
  {
    "text": "yep this is my first brush with the kernel debugger with this kind of",
    "start": "1342380",
    "end": "1348740"
  },
  {
    "text": "this sort of fun anyway this is windy bug you can download it right from Microsoft",
    "start": "1348740",
    "end": "1355419"
  },
  {
    "text": "it's actually reasonably competent it supports either to rs232 or fire water",
    "start": "1355419",
    "end": "1362980"
  },
  {
    "text": "but not USB",
    "start": "1363919",
    "end": "1366940"
  },
  {
    "text": "all right",
    "start": "1371659",
    "end": "1374320"
  },
  {
    "text": "here we are let's poke this button now",
    "start": "1379600",
    "end": "1384640"
  },
  {
    "text": "nothing up our sleeves short sleeves I mean you didn't even see me change",
    "start": "1386419",
    "end": "1392179"
  },
  {
    "text": "cables or anything oh isn't that a pretty shade of blue",
    "start": "1392179",
    "end": "1399460"
  },
  {
    "text": "all right I don't you don't want to sit through the reboot now do you",
    "start": "1400280",
    "end": "1405820"
  },
  {
    "text": "think and uh yep that's what happens when you move that much memory",
    "start": "1413600",
    "end": "1421360"
  },
  {
    "text": "it's kernel space that's not my strong suit I mean I'm just a programmer uh",
    "start": "1422179",
    "end": "1427460"
  },
  {
    "text": "anyone anyone I don't see any hands come on people",
    "start": "1427460",
    "end": "1434120"
  },
  {
    "text": "got to be some kernel God out there",
    "start": "1434120",
    "end": "1437799"
  },
  {
    "text": "well we're taking a trip up to the uh what's it called uh I can't remember the name of the place it's up off of uh",
    "start": "1440179",
    "end": "1446179"
  },
  {
    "text": "Tropicana gonna run some submachine guns come on up",
    "start": "1446179",
    "end": "1452080"
  },
  {
    "text": "there we go oh okay here's another one uh David I'm gonna let you take this one",
    "start": "1452299",
    "end": "1458480"
  },
  {
    "text": "because he he did most of the work on it all right so in our research we came",
    "start": "1458480",
    "end": "1463640"
  },
  {
    "text": "across another bug does everyone hear me all right uh we came across another bug this one is um",
    "start": "1463640",
    "end": "1470419"
  },
  {
    "text": "a little bit unlike any other you know type of attack class that I'd seen before you know this is not uh",
    "start": "1470419",
    "end": "1477919"
  },
  {
    "text": "this is not a buffer overflow this is not a heap overflow this is not a you know format string vulnerability I'd",
    "start": "1477919",
    "end": "1483860"
  },
  {
    "text": "quite honestly I'd never seen this type of issue before because it seems a little bit too simple but you can what's",
    "start": "1483860",
    "end": "1490880"
  },
  {
    "text": "that can everyone hear me all right so what you can see here is we're going to jump",
    "start": "1490880",
    "end": "1496640"
  },
  {
    "text": "to a pointer plus an offset that offset is user controllable so let's jump to somewhere for the",
    "start": "1496640",
    "end": "1503720"
  },
  {
    "text": "purposes of this demo that doesn't make any sense like a call to free we're not going to prepare the stack and we're",
    "start": "1503720",
    "end": "1509720"
  },
  {
    "text": "just going to jump right to free and see what happens once again we'll see a big poof",
    "start": "1509720",
    "end": "1515740"
  },
  {
    "text": "so if we plug in a our USB device again here",
    "start": "1515900",
    "end": "1521679"
  },
  {
    "text": "we wait patiently",
    "start": "1555740",
    "end": "1558760"
  },
  {
    "text": "and there we go that one we didn't that was a little bit me all right",
    "start": "1564980",
    "end": "1574179"
  },
  {
    "text": "yeah the uh there's a hard-coded offset plus a you know plus a byte plus ECX ECX",
    "start": "1582860",
    "end": "1588500"
  },
  {
    "text": "which user controllable out of the device so we can set that to any byte we want so we can control the jump table",
    "start": "1588500",
    "end": "1595580"
  },
  {
    "text": "if you can control a jump table you can point it off the end of the jump table if you'd like which is what we did there it just so happens that the the way that",
    "start": "1595580",
    "end": "1602600"
  },
  {
    "text": "we demoed that I can't show you all the code obviously because the jump table gives information away about what the",
    "start": "1602600",
    "end": "1607940"
  },
  {
    "text": "class driver itself is but basically what we saw there was a see if I can",
    "start": "1607940",
    "end": "1615100"
  },
  {
    "text": "um four instructions above this call to um anti-ex free pool what you see there is",
    "start": "1615320",
    "end": "1621860"
  },
  {
    "text": "a jump table so what we did is we just jumped to the next instruction down off the end of the jump table so in this",
    "start": "1621860",
    "end": "1627140"
  },
  {
    "text": "particular case we'd be able to jump to a misaligned offset if we want to a call EDI for example",
    "start": "1627140",
    "end": "1633200"
  },
  {
    "text": "all right and uh potentially exploit this don't potentially exploit that bug",
    "start": "1633200",
    "end": "1640840"
  },
  {
    "text": "since we control that jump Offset you know the rest is up to you where do you want to go today where do you want to",
    "start": "1642679",
    "end": "1648080"
  },
  {
    "text": "jump to",
    "start": "1648080",
    "end": "1650440"
  },
  {
    "text": "and as I've stated these drivers are already built into the OS they're included but they'll be patched",
    "start": "1654080",
    "end": "1660980"
  },
  {
    "text": "okay well next vid plus plus what do we want to try now",
    "start": "1660980",
    "end": "1666820"
  },
  {
    "text": "then there's the Hub section of the USB specs but uh it was a hub is such a",
    "start": "1667940",
    "end": "1673400"
  },
  {
    "text": "special device that I didn't want to touch it it warrants its own section in the specs but it would open up a few",
    "start": "1673400",
    "end": "1679640"
  },
  {
    "text": "more attack vectors like multiple devices and uh all sorts of just oh I know 2006 speech",
    "start": "1679640",
    "end": "1686600"
  },
  {
    "text": "I guess uh see you then",
    "start": "1686600",
    "end": "1689919"
  },
  {
    "text": "so what do we do about this",
    "start": "1694880",
    "end": "1697960"
  },
  {
    "text": "all right epoxy the USB port shut Darren and I are giving away one free",
    "start": "1702740",
    "end": "1708020"
  },
  {
    "text": "USB protection package if you'd like to uh to uh come on up and retrieve it",
    "start": "1708020",
    "end": "1713059"
  },
  {
    "text": "just kidding there is a software solution out there uh safe end I would be remiss in not",
    "start": "1713059",
    "end": "1719120"
  },
  {
    "text": "mentioning them what they allow you to do is white list a set of devices that you are allowed to plug into your system",
    "start": "1719120",
    "end": "1725000"
  },
  {
    "text": "unfortunately as Darren has shown we can match your white list we can be anything you want us to be you know in fact I can",
    "start": "1725000",
    "end": "1731720"
  },
  {
    "text": "walk by your desktop one day and say oh yeah you've got a Dell USB mouse plugged in there it's obviously white listed",
    "start": "1731720",
    "end": "1737539"
  },
  {
    "text": "tomorrow I'm going to come by with a USB thumb drive that says it's a Dell USB mouse",
    "start": "1737539",
    "end": "1742880"
  },
  {
    "text": "the other issue there is it's very similar to you know in the IDS world when you start trying to enforce strict",
    "start": "1742880",
    "end": "1748039"
  },
  {
    "text": "protocol level enforcement right no vendor actually abides by protocol right",
    "start": "1748039",
    "end": "1753500"
  },
  {
    "text": "and if you start strictly enforcing protocol you start breaking devices and on top of that it's nearly impossible to",
    "start": "1753500",
    "end": "1759320"
  },
  {
    "text": "have protocol enforcement for every single type of device that could exist you would basically have to have this",
    "start": "1759320",
    "end": "1764360"
  },
  {
    "text": "piece of software that enforces protocol for a scuzzy drive a mouse a scanner a",
    "start": "1764360",
    "end": "1769940"
  },
  {
    "text": "thumbprint scanner right it's just the amount of work is unbelievable so it's a nice idea",
    "start": "1769940",
    "end": "1776779"
  },
  {
    "text": "and we want to give you some food for thought where you know as I mentioned we are not coming out with any type of USB",
    "start": "1776779",
    "end": "1782659"
  },
  {
    "text": "protection software we came up with our solution so uh but we want to you know give you all some food for thought in",
    "start": "1782659",
    "end": "1788779"
  },
  {
    "text": "case it's something you know you wanted to research uh software solution uh to enforce the USB protocol as I mentioned",
    "start": "1788779",
    "end": "1794480"
  },
  {
    "text": "very hard to very hard to do you basically have to have a kernel level driver that can sit in insert itself and",
    "start": "1794480",
    "end": "1800600"
  },
  {
    "text": "trapped all of those calls to the US to USB and ensured that what it was receiving is that exactly what it's",
    "start": "1800600",
    "end": "1806059"
  },
  {
    "text": "supposed to receive a nice little feature if you were going to do something like that would be to disable auto run duh",
    "start": "1806059",
    "end": "1813919"
  },
  {
    "text": "a nice Hardware solution we also came up with again a nice Theory sort of an inline USB device that allows you to",
    "start": "1813919",
    "end": "1819799"
  },
  {
    "text": "enforce protocol but more importantly you could have a USB inline USB device that says this is my inline Mouse",
    "start": "1819799",
    "end": "1826880"
  },
  {
    "text": "enforcer right I'm going to plug my mouse into this and then plug this into my laptop and that way I know that the",
    "start": "1826880",
    "end": "1833419"
  },
  {
    "text": "only thing that could ever come through this device is a mouse and you know thus you know eliminating a large number of",
    "start": "1833419",
    "end": "1839120"
  },
  {
    "text": "the types of attacks again it's just Theory just a little food for thought",
    "start": "1839120",
    "end": "1844059"
  },
  {
    "text": "some references these are available in your books these are some of the links that Darren used when he built his board",
    "start": "1844460",
    "end": "1851360"
  },
  {
    "text": "you can build the exact board that Darren built for as he mentioned very little money anyone in this room can do",
    "start": "1851360",
    "end": "1857240"
  },
  {
    "text": "it all right come on let's have it",
    "start": "1857240",
    "end": "1864799"
  },
  {
    "text": "any questions yes",
    "start": "1864799",
    "end": "1870100"
  },
  {
    "text": "the question was did we actually build an exploit are we showing that the system crashes um we",
    "start": "1872539",
    "end": "1879260"
  },
  {
    "text": "due to our you know constraints with Microsoft we did not build a fully functional exploit we took it to the",
    "start": "1879260",
    "end": "1885559"
  },
  {
    "text": "point of proof of concept where it's almost to the point where it's like okay just cut and paste your shell code we",
    "start": "1885559",
    "end": "1891500"
  },
  {
    "text": "know we have code execution but I do have a revision two firmware on the drawing board",
    "start": "1891500",
    "end": "1898640"
  },
  {
    "text": "because it was part that and just plain time constraints I I didn't know USB",
    "start": "1898640",
    "end": "1903740"
  },
  {
    "text": "protocol in January any other questions next",
    "start": "1903740",
    "end": "1909700"
  },
  {
    "text": "uh come on all right well thank you thank you",
    "start": "1910700",
    "end": "1917919"
  },
  {
    "text": "oh and you can bring your own laptops up if you want to try it two lines no waiting",
    "start": "1922399",
    "end": "1929080"
  },
  {
    "text": "no",
    "start": "1931100",
    "end": "1934100"
  }
]