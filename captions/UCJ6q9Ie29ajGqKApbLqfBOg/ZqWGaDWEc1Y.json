[
  {
    "text": "[Music]",
    "start": "1700",
    "end": "4810"
  },
  {
    "text": "hi everyone I'm Han Yan Welcome to our talk broker match new attack Services of",
    "start": "8179",
    "end": "14580"
  },
  {
    "text": "Bluetooth smash in this talk we will discuss some common attack surfaces and vulnerabilities of",
    "start": "14580",
    "end": "21300"
  },
  {
    "text": "Bluetooth mesh technology first let me introduce our team we",
    "start": "21300",
    "end": "28140"
  },
  {
    "text": "belong to the Baidu alt security team we now focus on the security of Android and",
    "start": "28140",
    "end": "34200"
  },
  {
    "text": "Linux platform and our duty is to discover zero-day vulnerability and",
    "start": "34200",
    "end": "40079"
  },
  {
    "text": "explore possible defense Solutions in this talk we will first introduce",
    "start": "40079",
    "end": "46620"
  },
  {
    "text": "some basic concepts of Bluetooth mesh technology and then we will analyze the",
    "start": "46620",
    "end": "52620"
  },
  {
    "text": "attack surfaces to show where to attack when to attack and how to attack",
    "start": "52620",
    "end": "58020"
  },
  {
    "text": "and next we will introduce PR image further an automated fasting tool for",
    "start": "58020",
    "end": "64018"
  },
  {
    "text": "Bluetooth mesh and show its effect with several case studies",
    "start": "64019",
    "end": "69979"
  },
  {
    "text": "well let's start with the Bluetooth slash technology Bluetooth smash is also known as",
    "start": "69979",
    "end": "77340"
  },
  {
    "text": "Bluetooth re mesh or VR image it is a wireless management working Technology",
    "start": "77340",
    "end": "83460"
  },
  {
    "text": "based on bre a Bluetooth smash was made public by seek in 2017.",
    "start": "83460",
    "end": "90479"
  },
  {
    "text": "and now is widely used in smart home and Industrial llt and other things",
    "start": "90479",
    "end": "98040"
  },
  {
    "text": "we're hearing the Bluetooth smash may be one of the most confusing question is",
    "start": "98040",
    "end": "103200"
  },
  {
    "text": "what is the difference between Bluetooth Smash and the Bluetooth classic or Bluetooth re",
    "start": "103200",
    "end": "109439"
  },
  {
    "text": "we think the main difference is that Bluetooth classic and ble are wireless",
    "start": "109439",
    "end": "115079"
  },
  {
    "text": "communication technology they are just like Wi-Fi well the Bluetooth smash is",
    "start": "115079",
    "end": "121680"
  },
  {
    "text": "not working technology it's just like the TCP and this figure shows their protocol",
    "start": "121680",
    "end": "129119"
  },
  {
    "text": "stack as we can see Bluetooth smash has a network layer but the other protocol",
    "start": "129119",
    "end": "135360"
  },
  {
    "text": "do not since brutal smash is a networking",
    "start": "135360",
    "end": "141720"
  },
  {
    "text": "technology Communication in Bluetooth mesh is no longer just point to point a",
    "start": "141720",
    "end": "147900"
  },
  {
    "text": "large number of device forms a network and communicate with each other",
    "start": "147900",
    "end": "154260"
  },
  {
    "text": "formally device in the mesh network is called node and you could see there are",
    "start": "154260",
    "end": "160860"
  },
  {
    "text": "many types of nodes but we only need to focus on the based node and the Really",
    "start": "160860",
    "end": "166379"
  },
  {
    "text": "node here okay let's see how the message flows in this network",
    "start": "166379",
    "end": "172019"
  },
  {
    "text": "assuming that the node a wants to send some message to this node e it can just",
    "start": "172019",
    "end": "178200"
  },
  {
    "text": "pass the message to the relay node queue and the queue will then forward the message to E",
    "start": "178200",
    "end": "184379"
  },
  {
    "text": "in this process node a actually advertises the message to all the nearby",
    "start": "184379",
    "end": "190500"
  },
  {
    "text": "nodes include the node B node hero and node p and so on but only the relay node",
    "start": "190500",
    "end": "197580"
  },
  {
    "text": "Q will do the forward job and we call such communication mechanism",
    "start": "197580",
    "end": "202739"
  },
  {
    "text": "as managed flooding we have figured out how message flows",
    "start": "202739",
    "end": "209760"
  },
  {
    "text": "but how to represent the source and destination of a message in fact just like TCP each node in mesh",
    "start": "209760",
    "end": "218099"
  },
  {
    "text": "Network high will not work address there are basically four types of drives but we can focus on two of them",
    "start": "218099",
    "end": "225239"
  },
  {
    "text": "the first is unique Castle Choice it is an address for each individual node and",
    "start": "225239",
    "end": "231720"
  },
  {
    "text": "the second is the group address it is an address for a group of nodes",
    "start": "231720",
    "end": "236760"
  },
  {
    "text": "and in this example node B has a Unica suggest well node C and node D has the",
    "start": "236760",
    "end": "243420"
  },
  {
    "text": "same group contrast so node a can send message to node B just by its unicast",
    "start": "243420",
    "end": "250140"
  },
  {
    "text": "Flash and the node a can send a message to C and D at the same time by their",
    "start": "250140",
    "end": "256260"
  },
  {
    "text": "group address let's further understand the Bluetooth smash communication from a higher level",
    "start": "256260",
    "end": "264120"
  },
  {
    "text": "Bluetooth smash adopts message oriented communication which is also known as",
    "start": "264120",
    "end": "269699"
  },
  {
    "text": "publish and subscribed here publish means Sending message to a",
    "start": "269699",
    "end": "274740"
  },
  {
    "text": "specific address a node can publish message to unicast address on Google just well subscribe",
    "start": "274740",
    "end": "283020"
  },
  {
    "text": "means start to receive message with specific destination address",
    "start": "283020",
    "end": "288240"
  },
  {
    "text": "no one can subscribe to a group address we also see the example",
    "start": "288240",
    "end": "295220"
  },
  {
    "text": "these slides has have subscribed to the Google Translation well this switch can",
    "start": "295220",
    "end": "303000"
  },
  {
    "text": "publish an all message to the Google transportation to turn on those lights",
    "start": "303000",
    "end": "309660"
  },
  {
    "text": "so in summary Bluetooth smash is a networking Technology based on pre and",
    "start": "309660",
    "end": "316139"
  },
  {
    "text": "the nodes can communicate with each other in the network",
    "start": "316139",
    "end": "321080"
  },
  {
    "text": "okay in the second part we will analyze the attack surfaces of Bluetooth smash",
    "start": "321300",
    "end": "327120"
  },
  {
    "text": "or resource scope include two aspects the first is protocol and the second is",
    "start": "327120",
    "end": "333660"
  },
  {
    "text": "wrapper application here the protocol means Bluetooth smash specification which is proposed basic",
    "start": "333660",
    "end": "341580"
  },
  {
    "text": "and wrapper application means software framework for providing Bluetooth smash",
    "start": "341580",
    "end": "346919"
  },
  {
    "text": "capabilities to up layer applications and further we divide the protocol into",
    "start": "346919",
    "end": "352919"
  },
  {
    "text": "two key stages the first is Network view stage and the second is Network control",
    "start": "352919",
    "end": "358860"
  },
  {
    "text": "stage on the other hand in this research we focus on software implementation",
    "start": "358860",
    "end": "365280"
  },
  {
    "text": "vulnerabilities of Bluetooth smash such as memory corruption",
    "start": "365280",
    "end": "371460"
  },
  {
    "text": "but let's start with the network viewport local Network view is a process in which new",
    "start": "371460",
    "end": "378180"
  },
  {
    "text": "devices join the mesh network with the help of a match kit week",
    "start": "378180",
    "end": "384180"
  },
  {
    "text": "formerly the network field is called providing it and the mesh Gateway is",
    "start": "384180",
    "end": "389880"
  },
  {
    "text": "called provisioner and the new device is called unprovising device",
    "start": "389880",
    "end": "395520"
  },
  {
    "text": "Network build protocol contains file procedures but we just need to know the overview that's okay",
    "start": "395520",
    "end": "401880"
  },
  {
    "text": "and provided device for the standard specific Beacon to the provisioner to",
    "start": "401880",
    "end": "407940"
  },
  {
    "text": "announce that that I want to join in the mesh Network and provide another build",
    "start": "407940",
    "end": "413220"
  },
  {
    "text": "Link with the unprovising device and then both of them provide some necessary",
    "start": "413220",
    "end": "419160"
  },
  {
    "text": "information to each other and here is a critical point the",
    "start": "419160",
    "end": "424740"
  },
  {
    "text": "provisioner and unprovising device will calculate a shared key using ecthr",
    "start": "424740",
    "end": "430259"
  },
  {
    "text": "algorithm and use the shared key to increase something for Authentication",
    "start": "430259",
    "end": "436220"
  },
  {
    "text": "we should not decide the authentication is often based on some window specific",
    "start": "436220",
    "end": "442580"
  },
  {
    "text": "parameters which means that a device of window a may not be able to join the",
    "start": "442580",
    "end": "449460"
  },
  {
    "text": "mesh Network through a provisioner of window p and finally the provisioning style",
    "start": "449460",
    "end": "457759"
  },
  {
    "text": "unprovising device will send the link close to the provider to end this link",
    "start": "457759",
    "end": "463440"
  },
  {
    "text": "and also notice that if providing Fields provider can also send link close to",
    "start": "463440",
    "end": "469319"
  },
  {
    "text": "unprovising device next we need to take a further look at",
    "start": "469319",
    "end": "476580"
  },
  {
    "text": "providing a massive format in fact all the message used in",
    "start": "476580",
    "end": "482880"
  },
  {
    "text": "providing follows these formats we can see the whole package is just a",
    "start": "482880",
    "end": "489360"
  },
  {
    "text": "Bluetooth low energy advertising packet which means that the Bluetooth smash is",
    "start": "489360",
    "end": "496440"
  },
  {
    "text": "actually built on top of the Bluetooth low energy and the data related to providing are",
    "start": "496440",
    "end": "504060"
  },
  {
    "text": "all here in the generic providing pdu and",
    "start": "504060",
    "end": "509639"
  },
  {
    "text": "especially in these two in the transaction star pdu and the transaction",
    "start": "509639",
    "end": "514919"
  },
  {
    "text": "to dupu so how the mesh protocol implementation pass the generic",
    "start": "514919",
    "end": "521820"
  },
  {
    "text": "providing pu is the key point of vulnerability mining",
    "start": "521820",
    "end": "528839"
  },
  {
    "text": "okay let us see the time surfaces of the network build stage",
    "start": "528839",
    "end": "534420"
  },
  {
    "text": "first we need to decide when to attack we think the attack should be carried",
    "start": "534420",
    "end": "540420"
  },
  {
    "text": "out before the authentication because in these procedures no actual information",
    "start": "540420",
    "end": "547080"
  },
  {
    "text": "is required so the attack is applicable to any Windows specific device",
    "start": "547080",
    "end": "555560"
  },
  {
    "text": "and next we need to decide what to attack and after our study we found that the",
    "start": "555560",
    "end": "564300"
  },
  {
    "text": "segmentation and for example the mechanism is a perfect Target the segmentation and reassembly are",
    "start": "564300",
    "end": "572040"
  },
  {
    "text": "designed for transmitting extremely long data it is relied through these two the",
    "start": "572040",
    "end": "578880"
  },
  {
    "text": "transactions started new and the transaction continue PU here the transaction star pu is the",
    "start": "578880",
    "end": "585600"
  },
  {
    "text": "first segment under transaction continue pdu at the beginning",
    "start": "585600",
    "end": "591060"
  },
  {
    "text": "we considered the cemented binary assembly as perfect Target because it is",
    "start": "591060",
    "end": "597779"
  },
  {
    "text": "a general mechanism so that supported by other mesh devices I mean while",
    "start": "597779",
    "end": "603120"
  },
  {
    "text": "receiving and caching segmented packet involved memory operation which are very",
    "start": "603120",
    "end": "609899"
  },
  {
    "text": "likely to cause memory corruption so we can attack the segmentation and",
    "start": "609899",
    "end": "617339"
  },
  {
    "text": "resembly by mutated lines related fields of transaction star pu and the",
    "start": "617339",
    "end": "623100"
  },
  {
    "text": "transaction continue view the fields are icgn totalized under segment index",
    "start": "623100",
    "end": "630779"
  },
  {
    "text": "and we will show are automatically fasting tool for this purpose later",
    "start": "630779",
    "end": "636980"
  },
  {
    "text": "in summary the thread model of a network build attack surface are shown here the",
    "start": "638339",
    "end": "644579"
  },
  {
    "text": "attacker can be either a provisioner or an unprovising device",
    "start": "644579",
    "end": "651000"
  },
  {
    "text": "followed by the provider it can send amount from segmented package to victim",
    "start": "651000",
    "end": "656700"
  },
  {
    "text": "and providing device after building link and the vulnerability will be triggered",
    "start": "656700",
    "end": "663660"
  },
  {
    "text": "on waiting during its real assembly and similarly a tight unprovising device",
    "start": "663660",
    "end": "670980"
  },
  {
    "text": "can send mail from the segmenting package to the victim provider after",
    "start": "670980",
    "end": "676200"
  },
  {
    "text": "receiving the providing invite here",
    "start": "676200",
    "end": "681800"
  },
  {
    "text": "okay next let's see the network control protocol Network control is a precise data one",
    "start": "683160",
    "end": "691079"
  },
  {
    "text": "device and message to other devices for example a switch can send some",
    "start": "691079",
    "end": "697380"
  },
  {
    "text": "message to the lights to turn on those lights we call it Network control",
    "start": "697380",
    "end": "703320"
  },
  {
    "text": "and the network control protocol follows a layered architecture and they are",
    "start": "703320",
    "end": "709019"
  },
  {
    "text": "totally eight layers here we can just focus on the network layer and the transport layer here",
    "start": "709019",
    "end": "717180"
  },
  {
    "text": "in network layer they are network address including the social trans SRC",
    "start": "717180",
    "end": "723180"
  },
  {
    "text": "and the destination address DST and in transport layer or most",
    "start": "723180",
    "end": "730740"
  },
  {
    "text": "specifically in the lower transport layer there are Fields designed for the",
    "start": "730740",
    "end": "737279"
  },
  {
    "text": "segmentation and real assembly well yes the network control also",
    "start": "737279",
    "end": "742740"
  },
  {
    "text": "supports the segmentation and with assembly mechanism",
    "start": "742740",
    "end": "748459"
  },
  {
    "text": "double to smash natively supports some security features and one of the main",
    "start": "750300",
    "end": "756360"
  },
  {
    "text": "security features is the message of application and encryption",
    "start": "756360",
    "end": "762420"
  },
  {
    "text": "in Bluetooth smash there are two keys for the encryption and they are known as",
    "start": "762420",
    "end": "768360"
  },
  {
    "text": "Knight key and apt key the Knight key is used to obfuscate and",
    "start": "768360",
    "end": "774180"
  },
  {
    "text": "encrypt fields of network layer here and the APB key is used to encrypt the",
    "start": "774180",
    "end": "780480"
  },
  {
    "text": "fields of upper transport layer here I enhance if we have no keys we can only",
    "start": "780480",
    "end": "788040"
  },
  {
    "text": "know the IBI ID at the next time I see here because they are in raw uh but if",
    "start": "788040",
    "end": "796800"
  },
  {
    "text": "we have the net key then we can pass the whole much more clear and the whole",
    "start": "796800",
    "end": "801959"
  },
  {
    "text": "lower transport layer and if we have Knight key and APB key we",
    "start": "801959",
    "end": "808680"
  },
  {
    "text": "can pass the whole message okay next let's see the attack surfaces",
    "start": "808680",
    "end": "817019"
  },
  {
    "text": "of network control stage similar to the network view stage we",
    "start": "817019",
    "end": "822600"
  },
  {
    "text": "found that segmentation and the real assembly mechanism is an ideal tax",
    "start": "822600",
    "end": "828360"
  },
  {
    "text": "Target in the network control stage in addition to the reason that it is a",
    "start": "828360",
    "end": "834180"
  },
  {
    "text": "general mechanism and involves memory operation it is also because that the",
    "start": "834180",
    "end": "840420"
  },
  {
    "text": "segmentation unreasonably occurred in the lower transport layer",
    "start": "840420",
    "end": "846680"
  },
  {
    "text": "so that only net key is required not apt key or what is this Advantage we need to",
    "start": "847079",
    "end": "855240"
  },
  {
    "text": "know that all the devices within the network have the same night key but different device may have different APB",
    "start": "855240",
    "end": "862500"
  },
  {
    "text": "key as long as the attacker joined in the match Network the net key can be",
    "start": "862500",
    "end": "868260"
  },
  {
    "text": "obtained it means that the attacker can send main Siege malware message to any",
    "start": "868260",
    "end": "875160"
  },
  {
    "text": "other device and we can also attack segmentation and",
    "start": "875160",
    "end": "881040"
  },
  {
    "text": "reassembly by mutating the last related fields such as this control icgo icg and",
    "start": "881040",
    "end": "889320"
  },
  {
    "text": "the second time here well those three model of network",
    "start": "889320",
    "end": "895920"
  },
  {
    "text": "control attack surface is shown like this from this right model we can see in",
    "start": "895920",
    "end": "902160"
  },
  {
    "text": "Bluetooth smash the attack Vector is no longer limited to the adjacent",
    "start": "902160",
    "end": "908220"
  },
  {
    "text": "the attacker device a can send the mail while segmented package to nearby with",
    "start": "908220",
    "end": "916199"
  },
  {
    "text": "him the devices and it can also sent to remote",
    "start": "916199",
    "end": "921959"
  },
  {
    "text": "with Team device D with the help of the relay node life",
    "start": "921959",
    "end": "928260"
  },
  {
    "text": "so vulnerabilities will be triggered on victim during the resembly",
    "start": "928260",
    "end": "934759"
  },
  {
    "text": "we have finished the attack surface analysis for Bluetooth my protocol and",
    "start": "936920",
    "end": "942959"
  },
  {
    "text": "finally let us find out the attack surfaces of bluetooth smart Shopper application",
    "start": "942959",
    "end": "949500"
  },
  {
    "text": "first we need to Define what is a wrapper application",
    "start": "949500",
    "end": "955199"
  },
  {
    "text": "this figure shows a typical framework of Bluetooth Smash in Android",
    "start": "955199",
    "end": "960660"
  },
  {
    "text": "the mesh capabilities are wrapped as airdr service provided by this process",
    "start": "960660",
    "end": "967500"
  },
  {
    "text": "called the Android Bluetooth uh other",
    "start": "967500",
    "end": "972600"
  },
  {
    "text": "Android app can utilize these capabilities through the airdr bundle",
    "start": "972600",
    "end": "978959"
  },
  {
    "text": "for example Android app wants to send a message it can just call the",
    "start": "978959",
    "end": "986459"
  },
  {
    "text": "corresponding interface provided by the main service and my service will then",
    "start": "986459",
    "end": "992160"
  },
  {
    "text": "forward this call to the GI layer and the generator will do for this call to",
    "start": "992160",
    "end": "997800"
  },
  {
    "text": "the whole layer finally to delete matched ISO uh well the live match.so",
    "start": "997800",
    "end": "1004959"
  },
  {
    "text": "will send the HCL command to Bluetooth chip to actually send a message out",
    "start": "1004959",
    "end": "1013540"
  },
  {
    "text": "assume that the attacker is malware Android app and the attack battery is",
    "start": "1013699",
    "end": "1020240"
  },
  {
    "text": "the malicious call then from this architecture we can see there are two",
    "start": "1020240",
    "end": "1025880"
  },
  {
    "text": "main guitar surfaces the first we can attack the permission",
    "start": "1025880",
    "end": "1031880"
  },
  {
    "text": "restriction of airdr service we can try to call the mesh service without",
    "start": "1031880",
    "end": "1037160"
  },
  {
    "text": "Bluetooth permission and second we can attack the memory operation in gni and",
    "start": "1037160",
    "end": "1043880"
  },
  {
    "text": "the whole year these two layers are often implemented by using C or CPP",
    "start": "1043880",
    "end": "1049660"
  },
  {
    "text": "which are very likely to involve memory corruption vulnerabilities so we can try",
    "start": "1049660",
    "end": "1056600"
  },
  {
    "text": "to call the mesh series with malformed parameters to see what happens",
    "start": "1056600",
    "end": "1063679"
  },
  {
    "text": "so in conclusion permission restriction under memory operation are too many",
    "start": "1063679",
    "end": "1068840"
  },
  {
    "text": "attack surfaces in wrap application and we will show more details in the case",
    "start": "1068840",
    "end": "1074120"
  },
  {
    "text": "study part foreign",
    "start": "1074120",
    "end": "1078460"
  },
  {
    "text": "part we will introduce BR image further advising 2 we designed to find the",
    "start": "1079900",
    "end": "1085940"
  },
  {
    "text": "vulnerabilities in Bluetooth mesh protocol implementation",
    "start": "1085940",
    "end": "1091039"
  },
  {
    "text": "and Oracle is too fast both Network build and network control stages",
    "start": "1091039",
    "end": "1097400"
  },
  {
    "text": "so that the VRE my father is composed of two corresponding subsystems",
    "start": "1097400",
    "end": "1105799"
  },
  {
    "text": "here is an overview of the network build further for fuzzing process there are several",
    "start": "1106520",
    "end": "1113480"
  },
  {
    "text": "necessary things to do we need to generate test cases and we need to send",
    "start": "1113480",
    "end": "1118940"
  },
  {
    "text": "them to the Target device and monitor the response from the target device to",
    "start": "1118940",
    "end": "1124160"
  },
  {
    "text": "detect crash so PR image files will also follow this framework",
    "start": "1124160",
    "end": "1130760"
  },
  {
    "text": "for the test case generation we Define a series of",
    "start": "1130760",
    "end": "1135799"
  },
  {
    "text": "segmented package as a single test case like this and we generate them at once",
    "start": "1135799",
    "end": "1144380"
  },
  {
    "text": "in each fuzzy Loop then our sender will first follow the",
    "start": "1144380",
    "end": "1150500"
  },
  {
    "text": "normal providing procedure to build Link with the target device and when is",
    "start": "1150500",
    "end": "1156200"
  },
  {
    "text": "father's turn to send message or sender will send each package of test case to",
    "start": "1156200",
    "end": "1162559"
  },
  {
    "text": "the Target device meanwhile we monitor the response from the target device to detect crash you",
    "start": "1162559",
    "end": "1170240"
  },
  {
    "text": "further do not receive the link closed from the target device which is expected",
    "start": "1170240",
    "end": "1176059"
  },
  {
    "text": "to receive after a time interval and we will consider it as the crash happen",
    "start": "1176059",
    "end": "1183260"
  },
  {
    "text": "yeah by the way monitoring log from serial Port is also a way to detect crash but",
    "start": "1183260",
    "end": "1191660"
  },
  {
    "text": "different developer board may have different output so it may take more effort to adapt to",
    "start": "1191660",
    "end": "1199820"
  },
  {
    "text": "each window so to the in the contrast the link",
    "start": "1199820",
    "end": "1206840"
  },
  {
    "text": "closed-based crash detection method is small General",
    "start": "1206840",
    "end": "1212200"
  },
  {
    "text": "and these two sequence diagrams show how the network build further works",
    "start": "1214240",
    "end": "1220280"
  },
  {
    "text": "the first diagram shows the case that trigger vulnerability at first the father will generate a test",
    "start": "1220280",
    "end": "1228440"
  },
  {
    "text": "case which is composed of several segmented packets then the father followed the normal",
    "start": "1228440",
    "end": "1236140"
  },
  {
    "text": "providing procedure use Link with the target device and willing established the further",
    "start": "1236140",
    "end": "1244580"
  },
  {
    "text": "start to send segmentally package as well as wait for the link clones",
    "start": "1244580",
    "end": "1250580"
  },
  {
    "text": "assuming that this transport continued pdu triggers vulnerability causing the",
    "start": "1250580",
    "end": "1256940"
  },
  {
    "text": "target device to crash then the target device will lost all the information for",
    "start": "1256940",
    "end": "1263059"
  },
  {
    "text": "this providing session so it will never send link close to our father",
    "start": "1263059",
    "end": "1268580"
  },
  {
    "text": "and we return to the father side the second timer has time out",
    "start": "1268580",
    "end": "1274039"
  },
  {
    "text": "and the factor does not receive any link rules so the father will consider it as",
    "start": "1274039",
    "end": "1280640"
  },
  {
    "text": "crash happen then save the crash log and clear time",
    "start": "1280640",
    "end": "1286480"
  },
  {
    "text": "well the second diagram shows the case that not trigger One Vision",
    "start": "1286580",
    "end": "1292220"
  },
  {
    "text": "assuming that this segmented packet is determined as invalid by the Target",
    "start": "1292220",
    "end": "1299120"
  },
  {
    "text": "device and console check file under Target device send the link close to the",
    "start": "1299120",
    "end": "1305179"
  },
  {
    "text": "father due to the check file then the father knows that this fuzzing Loop has",
    "start": "1305179",
    "end": "1310700"
  },
  {
    "text": "failed so just reset the timer and start the next fast loop",
    "start": "1310700",
    "end": "1318400"
  },
  {
    "text": "now we have established a fuzzy framework so the last work to do is to",
    "start": "1319460",
    "end": "1324740"
  },
  {
    "text": "Define how to generate the test case uh a test case is composed of one",
    "start": "1324740",
    "end": "1332059"
  },
  {
    "text": "transaction star pdu and a number of transaction continue PU",
    "start": "1332059",
    "end": "1338260"
  },
  {
    "text": "when generating the test case we first randomize the package count one plus and",
    "start": "1338260",
    "end": "1345220"
  },
  {
    "text": "and then we random the oxygen Total Lines data lines of the",
    "start": "1345220",
    "end": "1351380"
  },
  {
    "text": "transaction star pu and we randomize the sh o data lines of the transaction",
    "start": "1351380",
    "end": "1357440"
  },
  {
    "text": "continuity to form a test case and this is a example the father has",
    "start": "1357440",
    "end": "1365960"
  },
  {
    "text": "generated parameters such as hydrogen and this test case finally calls the",
    "start": "1365960",
    "end": "1372080"
  },
  {
    "text": "target device to crash okay let's move to the network control",
    "start": "1372080",
    "end": "1379460"
  },
  {
    "text": "fuzzle Network control further is also composed of three main modules the test",
    "start": "1379460",
    "end": "1385460"
  },
  {
    "text": "case generation Center receiver and the Crash detection a test case is also defined as a series",
    "start": "1385460",
    "end": "1393799"
  },
  {
    "text": "of segmented packets and our father will send this cemented",
    "start": "1393799",
    "end": "1400220"
  },
  {
    "text": "package to the Target device one by one on the notice that the sender will also",
    "start": "1400220",
    "end": "1407000"
  },
  {
    "text": "send some prob package to the turkey device at the same time",
    "start": "1407000",
    "end": "1412220"
  },
  {
    "text": "here the pro packets are valid segmented packets and they are used to detect the",
    "start": "1412220",
    "end": "1419419"
  },
  {
    "text": "crash in normal case Target device will send",
    "start": "1419419",
    "end": "1424520"
  },
  {
    "text": "sdks to the prop packets and SDK package contains response to",
    "start": "1424520",
    "end": "1431360"
  },
  {
    "text": "multiple problems this is called the block SDK",
    "start": "1431360",
    "end": "1436820"
  },
  {
    "text": "any further find that some institutes to the problems are missing then the crash",
    "start": "1436820",
    "end": "1442880"
  },
  {
    "text": "is considered to happen by the way why we need the props rather",
    "start": "1442880",
    "end": "1448700"
  },
  {
    "text": "than just monitoring the SDK to test case to detect crash uh this is because that missing SDK to",
    "start": "1448700",
    "end": "1456980"
  },
  {
    "text": "test case may be caused by a crush but it may also be caused by the invalid",
    "start": "1456980",
    "end": "1464179"
  },
  {
    "text": "package not being a set it is just hard to tell these two",
    "start": "1464179",
    "end": "1469760"
  },
  {
    "text": "situation but for the problem missing is a key for prop must means crash",
    "start": "1469760",
    "end": "1476600"
  },
  {
    "text": "so it's a battery indicator",
    "start": "1476600",
    "end": "1480520"
  },
  {
    "text": "and these two sequence diagrams show how the network build further works the",
    "start": "1481900",
    "end": "1487760"
  },
  {
    "text": "first diagram shows the case that trigger vulnerability I first father also generate a test case",
    "start": "1487760",
    "end": "1495380"
  },
  {
    "text": "which is composed of several statement in the packets then the fight the father sent the first",
    "start": "1495380",
    "end": "1502220"
  },
  {
    "text": "package to the Target device as well as the probe and we can see that the target",
    "start": "1502220",
    "end": "1508760"
  },
  {
    "text": "device responds is key to both segmented and the prop that's correct and next the",
    "start": "1508760",
    "end": "1516919"
  },
  {
    "text": "father send the second segmenting package but this package is not accepted",
    "start": "1516919",
    "end": "1522860"
  },
  {
    "text": "as a Target device so no SDK to this package will be sent",
    "start": "1522860",
    "end": "1527900"
  },
  {
    "text": "but we do not care that's okay and the father received the SDK to the",
    "start": "1527900",
    "end": "1534500"
  },
  {
    "text": "pro so we know that the target device works fine",
    "start": "1534500",
    "end": "1540220"
  },
  {
    "text": "and then the father sent the third segmenting package and the trigger crash",
    "start": "1540220",
    "end": "1547400"
  },
  {
    "text": "on the target device a next father send prompt to the Target",
    "start": "1547400",
    "end": "1552620"
  },
  {
    "text": "device and the note is the critical point if the mesh service on the target device",
    "start": "1552620",
    "end": "1559940"
  },
  {
    "text": "is permanent Dot the father will find that the exactly to the probe is missing",
    "start": "1559940",
    "end": "1567260"
  },
  {
    "text": "so that I know the crush has occurred this is the simplest case",
    "start": "1567260",
    "end": "1573020"
  },
  {
    "text": "but even if the mesh service is not permanent done we can still detect the",
    "start": "1573020",
    "end": "1579440"
  },
  {
    "text": "crash because we match class all the information about this",
    "start": "1579440",
    "end": "1585140"
  },
  {
    "text": "segmentation and real sampling session has been lost so this SDK will only response to the",
    "start": "1585140",
    "end": "1592460"
  },
  {
    "text": "last problem but missing the response to the first and the second part",
    "start": "1592460",
    "end": "1598100"
  },
  {
    "text": "so if we found the missing we know that the mesh the service on the target",
    "start": "1598100",
    "end": "1604220"
  },
  {
    "text": "device has crashed well for the case that not trigger",
    "start": "1604220",
    "end": "1610279"
  },
  {
    "text": "vulnerability Factor will receive all the sdks to prompt and know that nothing",
    "start": "1610279",
    "end": "1616100"
  },
  {
    "text": "happens the test case generation is similar to",
    "start": "1616100",
    "end": "1622279"
  },
  {
    "text": "the network build we first decide how many segmented packets are included in a",
    "start": "1622279",
    "end": "1628100"
  },
  {
    "text": "single test case and then we randomize the icg ic0 details under control",
    "start": "1628100",
    "end": "1634700"
  },
  {
    "text": "uh these fields are related to the lines and here is an example the father has",
    "start": "1634700",
    "end": "1642440"
  },
  {
    "text": "generally several concerned parameters and finally triggered the target device",
    "start": "1642440",
    "end": "1648380"
  },
  {
    "text": "to crash okay this is the last part of our father",
    "start": "1648380",
    "end": "1655640"
  },
  {
    "text": "we Implement our system based on the Nordic RF model and this module supports",
    "start": "1655640",
    "end": "1663020"
  },
  {
    "text": "the sending and receiving of Bluetooth signals and in the aspect of software since the",
    "start": "1663020",
    "end": "1670580"
  },
  {
    "text": "Bluetooth smash is built on top of Bluetooth low energy so we need to find",
    "start": "1670580",
    "end": "1676279"
  },
  {
    "text": "out a tool that can sound raw bre packets first and here we utilize the screen tools",
    "start": "1676279",
    "end": "1684080"
  },
  {
    "text": "driver for this purpose swim tools is a great open source tool that allows us customize the ere we are",
    "start": "1684080",
    "end": "1692360"
  },
  {
    "text": "Tyson and thanks for their great work and next we implement the mesh protocol",
    "start": "1692360",
    "end": "1699440"
  },
  {
    "text": "based on the match spec and this is called state that shows the",
    "start": "1699440",
    "end": "1707059"
  },
  {
    "text": "details of network layer and finally we Implement our system",
    "start": "1707059",
    "end": "1714020"
  },
  {
    "text": "based on our self-implemented protocol the fourth part is about our real world",
    "start": "1714020",
    "end": "1721940"
  },
  {
    "text": "Wanna Be reminding of Bluetooth Smash and up to July 24 we have found a total",
    "start": "1721940",
    "end": "1728299"
  },
  {
    "text": "of 17 issues covered eight well-known winners and obtained certain CPS",
    "start": "1728299",
    "end": "1734240"
  },
  {
    "text": "and now other listed CVS have been fixed by windows in this part we will discuss",
    "start": "1734240",
    "end": "1740840"
  },
  {
    "text": "the vulnerabilities in network field stage Network control stage and the",
    "start": "1740840",
    "end": "1745940"
  },
  {
    "text": "router application the first case is an auto on right",
    "start": "1745940",
    "end": "1751880"
  },
  {
    "text": "vulnerability in network view stage here we need to know two Fields the icgm",
    "start": "1751880",
    "end": "1759380"
  },
  {
    "text": "and the total s and the scgm means number of segments it",
    "start": "1759380",
    "end": "1766399"
  },
  {
    "text": "is the zero best value for example the icgm equals three means that the home",
    "start": "1766399",
    "end": "1772760"
  },
  {
    "text": "message is divided into four segmented packets while the total lens means the total",
    "start": "1772760",
    "end": "1781100"
  },
  {
    "text": "number of bytes in the whole message in a while it is Ice Age and the Total",
    "start": "1781100",
    "end": "1787100"
  },
  {
    "text": "Lines should be matched for example if total s is 65 then the icgn should be 2",
    "start": "1787100",
    "end": "1794720"
  },
  {
    "text": "which means that 65 bytes are divided into three segmented packets",
    "start": "1794720",
    "end": "1802419"
  },
  {
    "text": "okay this is the vulnerability that the",
    "start": "1802419",
    "end": "1807500"
  },
  {
    "text": "mesh SDK allows mismatched as it and total lens in the network view stage",
    "start": "1807500",
    "end": "1815360"
  },
  {
    "text": "and in this case the attacker forced to send the transaction Star video to the",
    "start": "1815360",
    "end": "1820640"
  },
  {
    "text": "victim with the Total Line 65 but with the oxygen 30.",
    "start": "1820640",
    "end": "1827059"
  },
  {
    "text": "and the victim first picks up the total length Okay it's 35 so victim will lock",
    "start": "1827059",
    "end": "1834980"
  },
  {
    "text": "it a 65 bytes buffer to catch all the segmented packets but next the weak team",
    "start": "1834980",
    "end": "1842659"
  },
  {
    "text": "will pick up the Sigmund the oxygen inserted and it will consider that there",
    "start": "1842659",
    "end": "1850640"
  },
  {
    "text": "are totally 31 practice to resume in fact that is incorrect",
    "start": "1850640",
    "end": "1856700"
  },
  {
    "text": "so the attacker can just need to send to a male from the segmented packet who",
    "start": "1856700",
    "end": "1864260"
  },
  {
    "text": "segmented the index is free and here since the 17 index free is smaller than",
    "start": "1864260",
    "end": "1872059"
  },
  {
    "text": "the oxygen so this package will be catched and will",
    "start": "1872059",
    "end": "1877520"
  },
  {
    "text": "be considered as valid but the segmented index 3 means that",
    "start": "1877520",
    "end": "1884120"
  },
  {
    "text": "this is the force packet so this package will be catching here and the final",
    "start": "1884120",
    "end": "1890299"
  },
  {
    "text": "release to the other one right uh here is the pork we first we will",
    "start": "1890299",
    "end": "1897620"
  },
  {
    "text": "link with the victim and dance and the malformed segmenting package and this",
    "start": "1897620",
    "end": "1903500"
  },
  {
    "text": "family leads to the crash of my stories",
    "start": "1903500",
    "end": "1908200"
  },
  {
    "text": "okay the cycling case is an Autobahn red vulnerability in network control stage",
    "start": "1909140",
    "end": "1915620"
  },
  {
    "text": "again we need to know these two Fields the icgn and icgo",
    "start": "1915620",
    "end": "1921279"
  },
  {
    "text": "oxygen is also the number of segments and the Sho is similar to Sigmund index",
    "start": "1921279",
    "end": "1928460"
  },
  {
    "text": "in network build protocol it is the offsite number indicates which",
    "start": "1928460",
    "end": "1934279"
  },
  {
    "text": "segment the current package is and invalid case for a certain",
    "start": "1934279",
    "end": "1941740"
  },
  {
    "text": "segmentation and real assembly session the icgm in all the segmented packets",
    "start": "1941740",
    "end": "1949039"
  },
  {
    "text": "should be the same but in this by the case match SDK allows the oxygen to be",
    "start": "1949039",
    "end": "1957380"
  },
  {
    "text": "inconsistent here the attacker first send the segmented package to the victim with the",
    "start": "1957380",
    "end": "1965600"
  },
  {
    "text": "oxygen one under the scgo zero that's okay it means that there are two",
    "start": "1965600",
    "end": "1972620"
  },
  {
    "text": "segmented packets in total and this is the first one",
    "start": "1972620",
    "end": "1978200"
  },
  {
    "text": "and the victim will pick up the oxygen well since there are totally two packets",
    "start": "1978200",
    "end": "1984799"
  },
  {
    "text": "to receive it's just lock it a buffer for this two package",
    "start": "1984799",
    "end": "1990340"
  },
  {
    "text": "but next the attacker will send a mail from the package with icgn31 and sh02",
    "start": "1990340",
    "end": "2000159"
  },
  {
    "text": "victim just to a check that the AC Joe here is smaller than the oxygen here and",
    "start": "2000159",
    "end": "2008080"
  },
  {
    "text": "incorrectly consider it as the valid package and cache it into buffer",
    "start": "2008080",
    "end": "2015399"
  },
  {
    "text": "uh again since the scgo is 2 this packet",
    "start": "2015399",
    "end": "2020860"
  },
  {
    "text": "is considered as the third packet so this package will be cached out of bound",
    "start": "2020860",
    "end": "2026919"
  },
  {
    "text": "and finally caused a Auto on right",
    "start": "2026919",
    "end": "2032398"
  },
  {
    "text": "five minutes Mr Han five minutes",
    "start": "2032980",
    "end": "2037500"
  },
  {
    "text": "we just changed the oxygen of different package and the first is one and the",
    "start": "2038620",
    "end": "2047019"
  },
  {
    "text": "other are circular uh this finally leads to crash in Waiting device and from low",
    "start": "2047019",
    "end": "2053320"
  },
  {
    "text": "we can see we can hijack the PC and r0 so that this crash can lead to remote",
    "start": "2053320",
    "end": "2059740"
  },
  {
    "text": "cubed cold ice cubes rce",
    "start": "2059740",
    "end": "2064800"
  },
  {
    "text": "and now we are clear about the water abilities in mesh protocol next the",
    "start": "2065020",
    "end": "2070240"
  },
  {
    "text": "let's see what happens in the rocket application the first vulnerability is a permission",
    "start": "2070240",
    "end": "2075700"
  },
  {
    "text": "leak in mesh service it is discovered on Android platform",
    "start": "2075700",
    "end": "2082118"
  },
  {
    "text": "although the services have some permission check but it treats all the",
    "start": "2082119",
    "end": "2087580"
  },
  {
    "text": "foreground applications as per meter caller so that every application can call this service interface even they do",
    "start": "2087580",
    "end": "2095020"
  },
  {
    "text": "not have any permission related to Bluetooth and here's the talk I trust the ABP with",
    "start": "2095020",
    "end": "2102640"
  },
  {
    "text": "any without any permission can successfully call the life stories of",
    "start": "2102640",
    "end": "2108520"
  },
  {
    "text": "course this vulnerability is an entry and more vulnerabilities can be triggered by calling the service",
    "start": "2108520",
    "end": "2114880"
  },
  {
    "text": "interface with male formal parameters and here is an example this is a stack",
    "start": "2114880",
    "end": "2121540"
  },
  {
    "text": "Overflow vulnerabilities in Bluetooth smash GTI and input touch my storage there is an",
    "start": "2121540",
    "end": "2127960"
  },
  {
    "text": "interface that we see are array from the Color battery is passed from GI level",
    "start": "2127960",
    "end": "2133680"
  },
  {
    "text": "from java layer to GI layer and copy into stack the vulnerability is that the",
    "start": "2133680",
    "end": "2140980"
  },
  {
    "text": "memory copy doesn't check the lens of array so if user passes are overlast",
    "start": "2140980",
    "end": "2146859"
  },
  {
    "text": "array to the interface it will cause the stack overflow",
    "start": "2146859",
    "end": "2152140"
  },
  {
    "text": "foreign with summarize our work as follows from",
    "start": "2152140",
    "end": "2157839"
  },
  {
    "text": "the study we know memory corruption vulnerabilities are very likely to occur in the segmentation and reassembling",
    "start": "2157839",
    "end": "2165420"
  },
  {
    "text": "implementation and the security of wrapper application especially their",
    "start": "2165420",
    "end": "2171280"
  },
  {
    "text": "permission are native also needs attention and the other listed CBE have been fixed",
    "start": "2171280",
    "end": "2178359"
  },
  {
    "text": "by windows for the framework we plan to enhance our fighting system add feedback driven",
    "start": "2178359",
    "end": "2185500"
  },
  {
    "text": "fasting strategy and all starting now is concentrate on the network layer and the",
    "start": "2185500",
    "end": "2193119"
  },
  {
    "text": "low transport layer in the future we will do one or BT mining at uploads",
    "start": "2193119",
    "end": "2199180"
  },
  {
    "text": "and also Bluetooth smash has a lot of interesting features such as gatd proxy",
    "start": "2199180",
    "end": "2206440"
  },
  {
    "text": "we could explore the attack surfaces of jtt proxy protocol",
    "start": "2206440",
    "end": "2212099"
  },
  {
    "text": "in the end we hope our work can help to improve the security of Bluetooth mesh",
    "start": "2212099",
    "end": "2220300"
  },
  {
    "text": "thank you for listening any question please tell me and you can also contact with me on the swipe card thank you",
    "start": "2220300",
    "end": "2229440"
  },
  {
    "text": "[Music]",
    "start": "2229660",
    "end": "2232770"
  },
  {
    "text": "thank you",
    "start": "2236099",
    "end": "2239820"
  }
]