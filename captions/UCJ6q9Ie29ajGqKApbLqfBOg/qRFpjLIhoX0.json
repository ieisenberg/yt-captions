[
  {
    "start": "0",
    "end": "27000"
  },
  {
    "text": "good afternoon welcome to Black Hat you are currently in the mobile track this is Don't Stand Clo so close to me i'd",
    "start": "160",
    "end": "7440"
  },
  {
    "text": "like to introduce Charlie Miller from Acuvent Labs",
    "start": "7440",
    "end": "14480"
  },
  {
    "text": "thanks so uh thanks for having me um so yeah I'm going to talk to you oh do I",
    "start": "16840",
    "end": "23039"
  },
  {
    "text": "have to film this it'd be nice if you could see my slides there you go okay so I'm here to",
    "start": "23039",
    "end": "29519"
  },
  {
    "start": "27000",
    "end": "37000"
  },
  {
    "text": "talk to you today about NFC and and the dangers of having NFC chips if there are",
    "start": "29519",
    "end": "34719"
  },
  {
    "text": "any on your phone okay so who am I it was a great introduction but I you know",
    "start": "34719",
    "end": "40320"
  },
  {
    "start": "37000",
    "end": "58000"
  },
  {
    "text": "I could talk about me all day so uh first one to write iPhone Android exploit one pone known got this cool",
    "start": "40320",
    "end": "47520"
  },
  {
    "text": "jacket four years only got one jacket though wrote some books uh have some letters I can put after my name however",
    "start": "47520",
    "end": "55039"
  },
  {
    "text": "I'm not a member of the iOS developer program all right so so what am I here to talk about",
    "start": "55039",
    "end": "60879"
  },
  {
    "start": "58000",
    "end": "113000"
  },
  {
    "text": "today so uh first I'll I'll start off with saying like why I looked at NFC um",
    "start": "60879",
    "end": "65920"
  },
  {
    "text": "and it's because of that guy right there yeah that guy um and then uh talk",
    "start": "65920",
    "end": "72159"
  },
  {
    "text": "about some very basic NFC stuff and then uh I'll explain how I wrote a fuzzer",
    "start": "72159",
    "end": "77759"
  },
  {
    "text": "that you can fuzz the NFC stack on phones with um and then I'll look at the apps beyond beyond the the low-level",
    "start": "77759",
    "end": "84240"
  },
  {
    "text": "code so like what what apps deal with NFC even after uh you've given them the data um and then I'll have some like",
    "start": "84240",
    "end": "91680"
  },
  {
    "text": "hopefully cool demos and videos and stuff for you at the end um so so basically the the talk uh I looked at I",
    "start": "91680",
    "end": "98240"
  },
  {
    "text": "spent like 9 months on this so in the fall there weren't that many devices around um uh so so the only ones that really",
    "start": "98240",
    "end": "104720"
  },
  {
    "text": "had Android at the time were Nexus S and Nokia N9 that I had access to so those those are the phones I looked at uh",
    "start": "104720",
    "end": "110640"
  },
  {
    "text": "initially and I got a Galaxy Nexus later okay so so why NFC well Moxy told me",
    "start": "110640",
    "end": "116159"
  },
  {
    "start": "113000",
    "end": "180000"
  },
  {
    "text": "that it would be easy to find bugs in NFC he was wrong there but uh at least it got me thinking about it and so like",
    "start": "116159",
    "end": "121920"
  },
  {
    "text": "NFC is actually like kind of a cool technology so uh for one thing you know you know John Evans says that iPhones",
    "start": "121920",
    "end": "128399"
  },
  {
    "text": "are going to have it and I like iPhones so I want to know about that um all Nokia phones pretty soon will have it uh",
    "start": "128399",
    "end": "135280"
  },
  {
    "text": "the you know Samsung a lot of Samsung phones Android phones have it um and uh",
    "start": "135280",
    "end": "140800"
  },
  {
    "text": "you know supposedly Windows Phone 8 will have it on a lot of their devices so anyway there's there's going to be a lot of devices coming out with this",
    "start": "140800",
    "end": "146239"
  },
  {
    "text": "technology and so it's nice to know whether uh you know there's going to be security problems uh associated with",
    "start": "146239",
    "end": "151280"
  },
  {
    "text": "that and the other thing is you know I learned I cut my hacking teeth in the you know late '9s early 2000s and back",
    "start": "151280",
    "end": "158400"
  },
  {
    "text": "then everything was server side so you know HTTP exploit or SSH server exploit and uh for me like browser exploits it's",
    "start": "158400",
    "end": "166080"
  },
  {
    "text": "like oh but then you know you got to get the guy to go to your website it's sort of you know painful so CFC is kind of cool I think because you know you don't",
    "start": "166080",
    "end": "172879"
  },
  {
    "text": "have to necessarily have the user do anything um and then of course the other reason I I was sort of interested is is",
    "start": "172879",
    "end": "178959"
  },
  {
    "text": "it's hard i like hard stuff okay so um like I said my my motivation this talk",
    "start": "178959",
    "end": "184959"
  },
  {
    "start": "180000",
    "end": "216000"
  },
  {
    "text": "is to see whether you can break into a phone with NFC uh there's lots of other",
    "start": "184959",
    "end": "190239"
  },
  {
    "text": "topics NFC topics um out there so uh you know like is our payment system secure",
    "start": "190239",
    "end": "197040"
  },
  {
    "text": "can you can you brute force you know the the Google Wallet PIN can you get free you know parking can you get free gym",
    "start": "197040",
    "end": "203760"
  },
  {
    "text": "memberships can you you know get free snacks so these are all like really cool topics and and interesting but that's not what my talk's about so my talk is",
    "start": "203760",
    "end": "210159"
  },
  {
    "text": "about you know the attack service that that uh you know having these phones",
    "start": "210159",
    "end": "215879"
  },
  {
    "text": "introduces all right so uh I didn't do any of that like fun stuff but I did at least scan the black badges to see what",
    "start": "215879",
    "end": "221760"
  },
  {
    "start": "216000",
    "end": "234000"
  },
  {
    "text": "was on them so this is this is a couple badges that I scanned uh you can see the data on them and by by the end you'll",
    "start": "221760",
    "end": "228319"
  },
  {
    "text": "understand what what some of that data means at least but it's it's uh it's not anything too too exciting at least you",
    "start": "228319",
    "end": "234480"
  },
  {
    "start": "234000",
    "end": "307000"
  },
  {
    "text": "know I I I went out you know last night and had fun instead of trying to reverse engineer those cards all right so so who",
    "start": "234480",
    "end": "241200"
  },
  {
    "text": "is who's done similar work than than me on on this particular topic of seeing whether you can you know this introduces",
    "start": "241200",
    "end": "247920"
  },
  {
    "text": "a tax service well Kolner a couple years ago gave a talk where he he did some fuzzing of the NC stack um but back then",
    "start": "247920",
    "end": "254319"
  },
  {
    "text": "he did it really manually it was like you know write a tag present the tag write a tag present the tag and so you",
    "start": "254319",
    "end": "259840"
  },
  {
    "text": "know after probably like a couple hours that he got bored um so I wanted to sort of automate that and then at SummerCon",
    "start": "259840",
    "end": "266080"
  },
  {
    "text": "he actually introduced a way you could you could simulate um NFC traffic by",
    "start": "266080",
    "end": "272160"
  },
  {
    "text": "doing memory injection in Android so with that you could fuzz as well although I don't know if he's actually done the fuzzing the closest um work to",
    "start": "272160",
    "end": "279840"
  },
  {
    "text": "to this was by a couple academic people who looked at the Nokia 6212 and and they saw whether you could you could uh",
    "start": "279840",
    "end": "286560"
  },
  {
    "text": "you know break into the phone basically and uh some of the results I have for the N9 are pretty similar since they're",
    "start": "286560",
    "end": "291600"
  },
  {
    "text": "both Nokia phones and then like a month ago Dan Rosenberg found some uh vulnerabilities in the Linux kernel uh",
    "start": "291600",
    "end": "297680"
  },
  {
    "text": "NOC stack right now that code's not being used it's for hardware that's not available yet um but still it just shows",
    "start": "297680",
    "end": "302800"
  },
  {
    "text": "that you know there's there's there's potential bugs in the NOC stacks okay so that's that's the motivation i I",
    "start": "302800",
    "end": "310000"
  },
  {
    "start": "307000",
    "end": "375000"
  },
  {
    "text": "really wanted to write tools that would help people test NFC implementations because right now there really aren't",
    "start": "310000",
    "end": "315520"
  },
  {
    "text": "any um and if I happen to find some bugs on the way you know that's really cool too so uh let's talk about NFC so NFC is",
    "start": "315520",
    "end": "324960"
  },
  {
    "text": "basically uh based on RFID it it runs at 13.56 MHz at least initially there's",
    "start": "324960",
    "end": "331600"
  },
  {
    "text": "some other uh frequencies used um along the way uh it uses the same standards as",
    "start": "331600",
    "end": "337000"
  },
  {
    "text": "RFID uh the thing that makes it different than RFID mostly is that it's designed to be very close proximity so",
    "start": "337000",
    "end": "344080"
  },
  {
    "text": "uh the the specifications say like 10 cm sometimes i've never seen that the the the more realistic operating range is",
    "start": "344080",
    "end": "350880"
  },
  {
    "text": "like you know a few centimeters um and and for that reason you see a lot of design design decisions like we don't",
    "start": "350880",
    "end": "357600"
  },
  {
    "text": "need encryption because no one can get that close and stuff um but uh other",
    "start": "357600",
    "end": "363199"
  },
  {
    "text": "some people have said they can read it across the room with like big you know mega antennas and stuff but that's not I don't do any of that and then the data",
    "start": "363199",
    "end": "369440"
  },
  {
    "text": "rates are you know quite slow so you you wouldn't want to transfer a ton of data uh with NFC even if you",
    "start": "369440",
    "end": "375319"
  },
  {
    "text": "could um so here's here's a couple videos i don't know if you can see them very well just to show you like in",
    "start": "375319",
    "end": "380960"
  },
  {
    "text": "practice how close you can be so I have a NFC hotel card key that's what that",
    "start": "380960",
    "end": "386000"
  },
  {
    "text": "white thing is and it's in it's in my in my wallet in my pocket and well not really mine on you know a simulated",
    "start": "386000",
    "end": "392639"
  },
  {
    "text": "person and uh so I can read it so so basically you know it can read like that and then over here in this little clip",
    "start": "392639",
    "end": "398639"
  },
  {
    "text": "you can see you know that's about how close you got to be so you don't have to touch but you know you're definitely going to have to be pretty close to to",
    "start": "398639",
    "end": "405280"
  },
  {
    "text": "that so so when you think about like you know what kind of attacks could you do well you could you know on a crowded",
    "start": "405280",
    "end": "412160"
  },
  {
    "text": "subway or something you could conceivably get really close to a phone or like you know right by someone's you",
    "start": "412160",
    "end": "417400"
  },
  {
    "text": "know pants pocket or something i don't know but like a more realistic attack probably is if you know replacing an NFC",
    "start": "417400",
    "end": "423599"
  },
  {
    "text": "reader uh you know that you're using to pay for a cab or something with a malicious one or you know sort of the",
    "start": "423599",
    "end": "428880"
  },
  {
    "text": "equivalent of card skimming uh you know you put another NFC device or you know some NFC tags are just like stickers so",
    "start": "428880",
    "end": "435120"
  },
  {
    "text": "you just stick a sticker somewhere or uh you know you replace an NFC antenna",
    "start": "435120",
    "end": "440800"
  },
  {
    "text": "that's you know on a movie poster with yours or something like that so there's lots of ways you could conceivably do it",
    "start": "440800",
    "end": "446319"
  },
  {
    "start": "446000",
    "end": "466000"
  },
  {
    "text": "um so let's see how you would in practice so is Todd Manning in the audience todd Manning are you here oh",
    "start": "446319",
    "end": "453759"
  },
  {
    "text": "right there okay so Tom Manny was a part of an experiment I was running and he he didn't know that until right now uh to",
    "start": "453759",
    "end": "459919"
  },
  {
    "text": "see to see whether I could read his his hotel card key um without him knowing it",
    "start": "459919",
    "end": "465440"
  },
  {
    "text": "so So let's see if I could so and Josh here was was our our our crack film",
    "start": "465440",
    "end": "470599"
  },
  {
    "text": "technician so So I'm the guy in the in the green and and Todd's in the checkered shirt so uh I'm going to",
    "start": "470599",
    "end": "476960"
  },
  {
    "text": "subtly try to uh read the tag right now out of his pants pocket let's see",
    "start": "476960",
    "end": "484360"
  },
  {
    "text": "he's He was never the wiser if if Oh I heard I could turn the volume you can hear our our idol chatter while while",
    "start": "484639",
    "end": "490479"
  },
  {
    "text": "this is going on and I do have to say though not everyone could pull this off i am a trained NSA agent um so so here",
    "start": "490479",
    "end": "497440"
  },
  {
    "text": "we are in the parking lot and trying to you know the moving target so I you know the the the elevator was easy but you",
    "start": "497440",
    "end": "503840"
  },
  {
    "text": "know the moving target's a little harder so so so I I have to admit though I",
    "start": "503840",
    "end": "509840"
  },
  {
    "text": "never actually read his his card key and uh and then when I when I filed him back to his room that night I found out why",
    "start": "509840",
    "end": "515760"
  },
  {
    "text": "he went to get in his room and his key was in his front pocket but I I think it would have",
    "start": "515760",
    "end": "520800"
  },
  {
    "text": "worked had he had it in his back pocket like you know me and and J here had it so oh well that was that was my foray",
    "start": "520800",
    "end": "527360"
  },
  {
    "text": "into real attacks all right so so when when So that was a card key so card keys are",
    "start": "527360",
    "end": "533279"
  },
  {
    "start": "529000",
    "end": "583000"
  },
  {
    "text": "kind of always on when is NSD enabled on your on your actual device and so basically it's it's on whenever your",
    "start": "533279",
    "end": "539040"
  },
  {
    "text": "phone is uh awake so like you know when your phone goes asleep and the screen's black it's not on and when the screen's",
    "start": "539040",
    "end": "545519"
  },
  {
    "text": "on it's it's on um some some exceptions to that is once Ice Cream Sandwich came out in Android uh if you have a passcode",
    "start": "545519",
    "end": "551519"
  },
  {
    "text": "on your phone the NFC chip is only on when the passcode has been entered so when your phone's unlocked um for the",
    "start": "551519",
    "end": "557279"
  },
  {
    "text": "Nokia N9 which is the other phone I looked at NFC is on then but it sort of behaves differently but if you had a lowle bug you could get to it if you had",
    "start": "557279",
    "end": "563680"
  },
  {
    "text": "one of these high level bugs I'll talk about later you can't get to those so so basically if the phone's unlocked uh",
    "start": "563680",
    "end": "568880"
  },
  {
    "text": "then it's definitely uh available and then what if your so imagine you have uh",
    "start": "568880",
    "end": "574560"
  },
  {
    "text": "you know your friend and you want to own their phone because that's what friends do and uh their phone is asleep in their",
    "start": "574560",
    "end": "580399"
  },
  {
    "text": "back pocket and and you want to wake it up well you can wake it up it's easy enough right so here's an FC tag the",
    "start": "580399",
    "end": "585600"
  },
  {
    "start": "583000",
    "end": "609000"
  },
  {
    "text": "phone's asleep so the time tag doesn't work now I'll just you know I know my friend's text or phone number so I'll",
    "start": "585600",
    "end": "591040"
  },
  {
    "text": "just send him a text message so send him a text message and then uh it wakes up",
    "start": "591040",
    "end": "596320"
  },
  {
    "text": "the phone and now the NFC is enabled so you're walking along send him a text message you know pop them on the butt",
    "start": "596320",
    "end": "601920"
  },
  {
    "text": "and and you own their phone if you have bugs which we haven't talked about yet so you've at least been able to interact",
    "start": "601920",
    "end": "607680"
  },
  {
    "text": "with your NFC chip okay so there's basically two ways that NFC works uh there's uh passive and",
    "start": "607680",
    "end": "615120"
  },
  {
    "start": "609000",
    "end": "653000"
  },
  {
    "text": "and active so passive is is you know what I've been showing you uh so so when the new iPhone with NFC comes out you",
    "start": "615120",
    "end": "621120"
  },
  {
    "text": "would just be like tag phone so the the the tags are real simple they're just like like this one is just a sticker",
    "start": "621120",
    "end": "627200"
  },
  {
    "text": "right it's just a sticker with like an antenna basically um and so the tags they don't need power they don't need",
    "start": "627200",
    "end": "633600"
  },
  {
    "text": "batteries or anything like that so they can be very small um and and all the power is supplied by the the reading",
    "start": "633600",
    "end": "639839"
  },
  {
    "text": "device in this case a phone um active communication is a little different so there's there's two actual phones or two",
    "start": "639839",
    "end": "645680"
  },
  {
    "text": "active devices that communicate back and forth and so that's basically the two modes that you'll see for uh for",
    "start": "645680",
    "end": "652519"
  },
  {
    "text": "NFC so there's there's a lot of specifications uh for for NC and I spent a lot of time reading a lot of these um",
    "start": "652519",
    "end": "659279"
  },
  {
    "start": "653000",
    "end": "672000"
  },
  {
    "text": "and we'll go through sort of the important ones and and I should say the way the talks arranged is you learn about NFC because you have to understand",
    "start": "659279",
    "end": "665600"
  },
  {
    "text": "like you know why there where there would be bugs and what the bugs are and stuff later so so bear with me through this part especially if you if you know",
    "start": "665600",
    "end": "671120"
  },
  {
    "text": "NFC so uh so basically it's like the low level stuff is on the bottom and the high level stuff's on top so we'll start",
    "start": "671120",
    "end": "677680"
  },
  {
    "text": "at the low level and talk about about that so uh at the low levels it's basically you know radio waves going",
    "start": "677680",
    "end": "683680"
  },
  {
    "start": "678000",
    "end": "699000"
  },
  {
    "text": "back and forth either between you know the the passive device and the act device or two acting devices um this is a an FFT plot I took of a phone talking",
    "start": "683680",
    "end": "692399"
  },
  {
    "text": "to a tag and you can see it's at 13.56 MHz not that big a deal it's very slow",
    "start": "692399",
    "end": "698079"
  },
  {
    "text": "like I said 106 kilobits um and then if you want to like at this level basically you're seeing you know",
    "start": "698079",
    "end": "703880"
  },
  {
    "start": "699000",
    "end": "757000"
  },
  {
    "text": "waveforms and so uh this is a waveform I captured and using uh a USRP and you can",
    "start": "703880",
    "end": "711200"
  },
  {
    "text": "see basically the way it works is whenever the the waveform dips below a certain threshold then you get uh a zero",
    "start": "711200",
    "end": "718399"
  },
  {
    "text": "bit and whenever it's above it you get one bit so you can see you can't see real real little there's some lines here but it's the same thing I wrote here and",
    "start": "718399",
    "end": "724959"
  },
  {
    "text": "then so then you get this this this uh you know stream of line crossings and then there's there's decoding in this",
    "start": "724959",
    "end": "731120"
  },
  {
    "text": "case it's this Manchester decoding it decodes into an actual bitst stream in this case these bits and then you can",
    "start": "731120",
    "end": "737519"
  },
  {
    "text": "decode that into actual hex and in this case this waveform is uh corresponds to",
    "start": "737519",
    "end": "742959"
  },
  {
    "text": "this sends wreck which we'll talk about in a minute so this is like the wake up uh for for NFC so it's kind of hard",
    "start": "742959",
    "end": "749440"
  },
  {
    "text": "right I don't like to do that i like like IDA Pro and stuff so I stayed away from the radio waves the next level up",
    "start": "749440",
    "end": "756000"
  },
  {
    "text": "is like initialization anti- collision",
    "start": "756000",
    "end": "761880"
  },
  {
    "start": "757000",
    "end": "784000"
  },
  {
    "text": "uh activation stuff like that so basically it's this is like how devices when they learn that there's another",
    "start": "762079",
    "end": "767120"
  },
  {
    "text": "device in in their radio you know within their uh you know within range uh how to start up the communication you know",
    "start": "767120",
    "end": "773680"
  },
  {
    "text": "figure out what's going on for higher levels uh but there's basically not much going on here and uh I I actually didn't",
    "start": "773680",
    "end": "779360"
  },
  {
    "text": "fudge this level i could have um but there's so little data as you'll see that it didn't seem worth it for the for the trouble all right now we started to",
    "start": "779360",
    "end": "786480"
  },
  {
    "text": "get into more of the meat of the protocols um so before up to this point there's only been like two or three ways that they could communicate now you'll",
    "start": "786480",
    "end": "792959"
  },
  {
    "text": "see there's like a whole lot of ways that that MC works so uh you got there's lots of",
    "start": "792959",
    "end": "798639"
  },
  {
    "text": "different chips and cards and ways that that peers can communicate so like you know this is a I don't even know what",
    "start": "798639",
    "end": "805360"
  },
  {
    "text": "this one is but like there's ultralite cards and and these Topaz cards and uh",
    "start": "805360",
    "end": "810800"
  },
  {
    "text": "so there's there's lots of different kinds of of of tags that you can use and they all communicate a little",
    "start": "810800",
    "end": "816760"
  },
  {
    "text": "differently then at the bottom is is the the the protocol you typically see for for",
    "start": "816760",
    "end": "821959"
  },
  {
    "text": "peerto-peer um so so let's dig into a couple of those that I actually look at um in more detail later um so one is the",
    "start": "821959",
    "end": "828800"
  },
  {
    "text": "one you'll see for type 2 also called micro Ultralite so in here uh basically",
    "start": "828800",
    "end": "834720"
  },
  {
    "text": "the so the command set is what the phone can do to can ask the tag so it can basically read or write or you know",
    "start": "834720",
    "end": "840160"
  },
  {
    "text": "decide where where it wants to do and the type of data that the tag can send back is represented in this diagram so",
    "start": "840160",
    "end": "847199"
  },
  {
    "text": "the first few byes are things like you know a serial number basically and then you get this thing called a capability",
    "start": "847199",
    "end": "853040"
  },
  {
    "text": "container which contains information like version number uh amount of data to expect stuff like that and then the",
    "start": "853040",
    "end": "859519"
  },
  {
    "text": "actual data that it's trying to transfer is you know starts there where where it says data so that's what what uh you see",
    "start": "859519",
    "end": "866079"
  },
  {
    "text": "for an ultralite cards contain this kind of information and then uh another kind of",
    "start": "866079",
    "end": "871760"
  },
  {
    "text": "of card that it turns out later that I I can fuzz is this type or card here it's",
    "start": "871760",
    "end": "877360"
  },
  {
    "text": "a little different so basically the card contains sort of a file system and uh what you do is you you select I'll talk",
    "start": "877360",
    "end": "884639"
  },
  {
    "text": "about in a second but but you select first the capability container file and you can read it and it again has stuff like version information and size and",
    "start": "884639",
    "end": "890399"
  },
  {
    "text": "stuff but this one also tells you where to find you know the the the file that contains the data so then you can then",
    "start": "890399",
    "end": "896639"
  },
  {
    "text": "uh the the device can then ask the the tag hey what you know then give me this file right so uh the the the typical",
    "start": "896639",
    "end": "904959"
  },
  {
    "start": "902000",
    "end": "931000"
  },
  {
    "text": "flow of this thing is like for for this type four is like okay give me uh you know I want to talk to you okay and then",
    "start": "904959",
    "end": "911440"
  },
  {
    "text": "it's like okay I want to select the capability container file okay I want to read from the capabilities container file okay you know now I want to select",
    "start": "911440",
    "end": "918399"
  },
  {
    "text": "the end file end is the the highle data we'll talk about in a second it's like okay now I want to read the end data so",
    "start": "918399",
    "end": "924320"
  },
  {
    "text": "that's that's how so you can imagine a lot of interactions going back and forth between the tag and the and the",
    "start": "924320",
    "end": "931720"
  },
  {
    "start": "931000",
    "end": "962000"
  },
  {
    "text": "Guys is there some water all right so uh next up is",
    "start": "931720",
    "end": "938399"
  },
  {
    "text": "peerto-peer communication so before it was just like a tag reading to uh I mean",
    "start": "938399",
    "end": "943600"
  },
  {
    "text": "a phone reading from a tag now it's like two phones talking to each other so there's data that goes back and forth um so there's uh and there's lots",
    "start": "943600",
    "end": "951680"
  },
  {
    "text": "of different types of packets that you can have packets PDUs they call them but uh the ones that are bold are the ones",
    "start": "951680",
    "end": "958000"
  },
  {
    "text": "that I that you'll actually see if you're pretending to be a device um so this is this is sort of the the the the",
    "start": "958000",
    "end": "964800"
  },
  {
    "start": "962000",
    "end": "993000"
  },
  {
    "text": "data flow you'll see for this so the first one sends a connect um",
    "start": "964800",
    "end": "970560"
  },
  {
    "text": "with some some parameters about like how it wants to connect the next one sends a CC which means connection complete then",
    "start": "970560",
    "end": "977839"
  },
  {
    "text": "the first guy sends an I1 which stands for information then the one the the target responds with either more",
    "start": "977839",
    "end": "983839"
  },
  {
    "text": "information or says uh you know I acknowledging that it received the information and then this goes back and",
    "start": "983839",
    "end": "988959"
  },
  {
    "text": "forth as long as you want until one side disconnects it's pretty simple um and",
    "start": "988959",
    "end": "994480"
  },
  {
    "start": "993000",
    "end": "1033000"
  },
  {
    "text": "then on top of LCP there's this higher level protocol uh because LCV actually",
    "start": "994480",
    "end": "999519"
  },
  {
    "text": "connects to to what's called a transport endpoint and from from my experience I've only seen two uh endpoints one is",
    "start": "999519",
    "end": "1007519"
  },
  {
    "text": "NPP for NDF push protocol and this is what you see a lot on Android and the other one is SNMP snap and that one is",
    "start": "1007519",
    "end": "1014800"
  },
  {
    "text": "basically everything else besides Android but in particular the Nokia phones had this one so you connect to a",
    "start": "1014800",
    "end": "1020320"
  },
  {
    "text": "service endpoint and then you send your data back and forth and everything's great okay so uh we've done everything",
    "start": "1020320",
    "end": "1027760"
  },
  {
    "text": "below that now we're up to the top level so so the actual data that's been transferred through all this uh you know communication back and forth",
    "start": "1027760",
    "end": "1034959"
  },
  {
    "start": "1033000",
    "end": "1053000"
  },
  {
    "text": "um so the the the format of the application data is called NDF NFC data exchange format and it's it's some",
    "start": "1034959",
    "end": "1041600"
  },
  {
    "text": "binary format it's it's like type link value kind of stuff uh and then there's",
    "start": "1041600",
    "end": "1047038"
  },
  {
    "text": "different specifications for the types of data that can be uh inside of the end",
    "start": "1047039",
    "end": "1052600"
  },
  {
    "text": "message so so if you're like me and you know you read all these specs and you're like oh god what are they talking about",
    "start": "1052600",
    "end": "1058559"
  },
  {
    "start": "1053000",
    "end": "1072000"
  },
  {
    "text": "like I need to see see the data so I so like I'll show you guys a capture of a phone talking to a micro ultralite chip",
    "start": "1058559",
    "end": "1066160"
  },
  {
    "text": "actually a NFC reader talking to a micro ultralite chip and I captured it using this Prox Mark",
    "start": "1066160",
    "end": "1071880"
  },
  {
    "text": "device all right so this is this is what the data looks like uh below or above the dotted line is the low-level uh",
    "start": "1071880",
    "end": "1079039"
  },
  {
    "start": "1072000",
    "end": "1169000"
  },
  {
    "text": "initial initialization stuff and then below or below the line is the um type 2",
    "start": "1079039",
    "end": "1084640"
  },
  {
    "text": "specific protocols so it basically starts out like uh up",
    "start": "1084640",
    "end": "1090799"
  },
  {
    "text": "here so this is that send wreck I mentioned earlier so it says it says wake up and then this guy says uh okay",
    "start": "1090799",
    "end": "1097039"
  },
  {
    "text": "um I have seven bytes in my serial number and then this guy says okay send them to me and then he",
    "start": "1097039",
    "end": "1103160"
  },
  {
    "text": "says okay I can't send you seven but I'll send you these three and then this guy says okay I got these three and then",
    "start": "1103160",
    "end": "1109039"
  },
  {
    "text": "this guy says good and then he says give send me the rest and then he says okay here's the rest and then he says this is",
    "start": "1109039",
    "end": "1115440"
  },
  {
    "text": "what I got and he says good so that's basically it it's very simple um the only thing that I left out was was uh in",
    "start": "1115440",
    "end": "1122880"
  },
  {
    "text": "these communications is also actually communicating that okay and also I'm a type two tag so when we get to the part",
    "start": "1122880",
    "end": "1129039"
  },
  {
    "text": "where we use the high level protocols make sure he talks to me in type two so so then they get down here and he starts",
    "start": "1129039",
    "end": "1134799"
  },
  {
    "text": "talking type two uh the the NFC reader so he reads some data um from from the",
    "start": "1134799",
    "end": "1141039"
  },
  {
    "text": "the eighth column down in that chart I showed you i don't know why um and then uh this is the data that the card sends",
    "start": "1141039",
    "end": "1147720"
  },
  {
    "text": "back then he reads the third column which contain like the capability container and stuff and so he reads that",
    "start": "1147720",
    "end": "1153200"
  },
  {
    "text": "and then he he reads the fourth one down and then he starts to get the actual data so so now you can start to imagine",
    "start": "1153200",
    "end": "1158320"
  },
  {
    "text": "like how you would fuzz this right so like there's lots of So I ignored this cuz it didn't seem like there was anything there and it was hard um but",
    "start": "1158320",
    "end": "1164320"
  },
  {
    "text": "down here you start to see like lots of data and binary data and like that that always makes my mouth",
    "start": "1164320",
    "end": "1169400"
  },
  {
    "start": "1169000",
    "end": "1272000"
  },
  {
    "text": "water okay so uh I pulled the data part of this message out to break it out even",
    "start": "1169400",
    "end": "1174880"
  },
  {
    "text": "further so you can see what endf data looks like and and this is the end of data for that message and so again it's",
    "start": "1174880",
    "end": "1179919"
  },
  {
    "text": "just like the first bite is it says \"Hey I'm an end message.\" And then he says how long he is and then he says he's a",
    "start": "1179919",
    "end": "1186640"
  },
  {
    "text": "message so MB is message begin message end which means message begin message end so it means it's complete there's",
    "start": "1186640",
    "end": "1192160"
  },
  {
    "text": "not you don't have like a bunch of of messages and short record which means the length is going to be one bite instead of four and so on so then you",
    "start": "1192160",
    "end": "1198799"
  },
  {
    "text": "get a type and blah blah blah blah and and so there's there's basically specifications for each of these so this is a type T for text and so there's a",
    "start": "1198799",
    "end": "1205679"
  },
  {
    "text": "specification that tells you how to read that so it's like okay it's English and it says you know sub ultra light or",
    "start": "1205679",
    "end": "1211520"
  },
  {
    "text": "whatever and then uh and there's a terminator so this is basically what the data looks like that's going to whenever",
    "start": "1211520",
    "end": "1216559"
  },
  {
    "text": "you touch a tag to a phone what what's going back and forth all right oh and then here is the NF data that's on your",
    "start": "1216559",
    "end": "1223640"
  },
  {
    "text": "badge i just broke it out a little bit um so it's it's similar to the other one cuz it's NF so again you get a message",
    "start": "1223640",
    "end": "1229760"
  },
  {
    "text": "you get a link that's much bigger um this time it's a message begin it's not a message end so there was more data",
    "start": "1229760",
    "end": "1235200"
  },
  {
    "text": "coming i didn't copy it all you get a type link the type is uh pbcard.netbc",
    "start": "1235200",
    "end": "1241360"
  },
  {
    "text": "card i don't know what that is but it's a special type that's defin not defined in the specification so it's like",
    "start": "1241360",
    "end": "1246640"
  },
  {
    "text": "proprietary right and then there's data some proprietary data i don't know what it is you could figure it out and it's probably got like all our social",
    "start": "1246640",
    "end": "1252480"
  },
  {
    "text": "security numbers and stuff okay so so now you you you know you're you're experts in in NFC",
    "start": "1252480",
    "end": "1259720"
  },
  {
    "text": "communication so you have to think back and say like you know where where might there be bugs like where should I where",
    "start": "1259720",
    "end": "1265360"
  },
  {
    "text": "should I focus so um let let's look at at one of",
    "start": "1265360",
    "end": "1271600"
  },
  {
    "text": "the the two uh operating systems I looked at to see what you know where",
    "start": "1271600",
    "end": "1276880"
  },
  {
    "text": "where the bugs might be so starting on the left you're in the kernel right uh in the kernel there's a driver to talk",
    "start": "1276880",
    "end": "1283039"
  },
  {
    "text": "to the actual hardware the NFC hardware um and then in userland there's",
    "start": "1283039",
    "end": "1288159"
  },
  {
    "text": "a service an NFC service and that's what deals with all the NFC data that comes in in Android the service is written in",
    "start": "1288159",
    "end": "1295159"
  },
  {
    "text": "Java but it does contain a couple native code libraries uh where you can imagine there being some bugs and then once the",
    "start": "1295159",
    "end": "1301600"
  },
  {
    "text": "service has has the data it passes it on to whichever application is intended to receive that data um the the the",
    "start": "1301600",
    "end": "1308080"
  },
  {
    "text": "application that you usually see in Android is called t tags and again this is some some uh Java application so um",
    "start": "1308080",
    "end": "1314799"
  },
  {
    "text": "you know from a tagger perspective there's a little bit of native code um a lot of Java so you know maybe not so",
    "start": "1314799",
    "end": "1320120"
  },
  {
    "text": "exciting uh the equivalent picture in MIGO which is what the Nokia N9 runs is",
    "start": "1320120",
    "end": "1325919"
  },
  {
    "text": "uh is is like this it's basically the same so you've got kernel and driver a service and then you know applications",
    "start": "1325919",
    "end": "1332000"
  },
  {
    "text": "that deal with the data once the service is done with it the the biggest difference from from an attacker's",
    "start": "1332000",
    "end": "1337120"
  },
  {
    "text": "perspective is everything is native code here so the service is written in you know C or something and it has a bunch",
    "start": "1337120",
    "end": "1342480"
  },
  {
    "text": "of libraries native code libraries and then the the application called which is called connection dialogues um it's also",
    "start": "1342480",
    "end": "1349360"
  },
  {
    "text": "written in some native code and uh so so you can imagine like memory corruption bugs sort of all over the system",
    "start": "1349360",
    "end": "1355159"
  },
  {
    "text": "here um so so at this point you you're just like okay so there could be bugs in",
    "start": "1355159",
    "end": "1361039"
  },
  {
    "text": "like the way you parse NFC and then there also could be bugs in the applications that deal with the NFC data",
    "start": "1361039",
    "end": "1366240"
  },
  {
    "text": "once you get it so we need to like check out both of those those places um so to to do the low-level uh",
    "start": "1366240",
    "end": "1374159"
  },
  {
    "start": "1370000",
    "end": "1416000"
  },
  {
    "text": "the inspection the low-level NFC parsing code uh I thought I was like well uh I I like the fuzz so let's see if we can",
    "start": "1374159",
    "end": "1379919"
  },
  {
    "text": "write a fuzzer to do this so to fuzz NFC basically three steps first one is test case generation and so you know write",
    "start": "1379919",
    "end": "1386159"
  },
  {
    "text": "invalid endfs or invalid you know capability containers or something like that um and then the like the hard part",
    "start": "1386159",
    "end": "1392960"
  },
  {
    "text": "uh for NFC is then getting that onto a phone so you you know it's like reading a tag you have to you know make the phone think it's reading a tag and of",
    "start": "1392960",
    "end": "1400320"
  },
  {
    "text": "course you know phones are designed so that reading a tag means you take a tag you take a phone you put them together and then you separate them right and",
    "start": "1400320",
    "end": "1406720"
  },
  {
    "text": "unless like I have like a ton of interns like that's going to that's going to be hard so you have to figure out some way",
    "start": "1406720",
    "end": "1411760"
  },
  {
    "text": "to automate that and then the final step of course is monitoring for crashes so how did I do test case",
    "start": "1411760",
    "end": "1418320"
  },
  {
    "start": "1416000",
    "end": "1458000"
  },
  {
    "text": "generation um and I should say at the end of the slide I'm going to give you a URL where you can download all my fuzzers and all that stuff so all this",
    "start": "1418320",
    "end": "1424240"
  },
  {
    "text": "all the stuff I'm talking about you can download uh today if you want um because I want you guys to find find bugs in NFC",
    "start": "1424240",
    "end": "1431960"
  },
  {
    "text": "stacks so uh so I did a couple approaches first you know my my infamous",
    "start": "1431960",
    "end": "1438080"
  },
  {
    "text": "you know Charlie Miller fuzzer that is like the dumbest fuzz on earth so I implemented that of course so you just",
    "start": "1438080",
    "end": "1443679"
  },
  {
    "text": "take valid data you flip bits add bits that sort of stuff and so you you can",
    "start": "1443679",
    "end": "1448880"
  },
  {
    "text": "see like the types of valid data I started with are like you know information PDUs capability containers",
    "start": "1448880",
    "end": "1454000"
  },
  {
    "text": "endusts and stuff like that and so I I generated a bunch of test cases that way",
    "start": "1454000",
    "end": "1459200"
  },
  {
    "start": "1458000",
    "end": "1473000"
  },
  {
    "text": "and then I also um went the the extra mile for this research to uh to generate",
    "start": "1459200",
    "end": "1464640"
  },
  {
    "text": "some some smart fuzzing um so I use solely to to generate end defs that you know are are valid but long and stuff",
    "start": "1464640",
    "end": "1471520"
  },
  {
    "text": "like that um so then then you have to ask how the heck are you going to get these so",
    "start": "1471520",
    "end": "1477200"
  },
  {
    "start": "1473000",
    "end": "1489000"
  },
  {
    "text": "generating test cases is easy the hard part is getting to the phone like I said before Colin did this sort of by hand",
    "start": "1477200",
    "end": "1482880"
  },
  {
    "text": "once um but I want to know like how else how else can I do it so that I don't have to like you know build a Lego robot",
    "start": "1482880",
    "end": "1488960"
  },
  {
    "text": "or something so the first thing I thought to try was well I'll just get a an MC card reader and then see what to",
    "start": "1488960",
    "end": "1495360"
  },
  {
    "start": "1489000",
    "end": "1496000"
  },
  {
    "text": "do but it turns out there's lots of lots of readers out there and they all kind of claim that they do this but none of",
    "start": "1495360",
    "end": "1500960"
  },
  {
    "text": "them really seem to and then there's lots of software to run the hardware and you have to figure out which",
    "start": "1500960",
    "end": "1506640"
  },
  {
    "text": "combinations work and for a long time I couldn't find a combination that worked um you know one way you could",
    "start": "1506640",
    "end": "1512240"
  },
  {
    "start": "1510000",
    "end": "1534000"
  },
  {
    "text": "think about is like well I'll just pretend I'll do everything from from scratch so you know from the radio level up I'll just emulate everything i'll",
    "start": "1512240",
    "end": "1518000"
  },
  {
    "text": "pretend to be an AFC tag because I'm I can do radio so I tried that uh with",
    "start": "1518000",
    "end": "1523279"
  },
  {
    "text": "this USRP um I wrote all this code to do it and uh you know you have all these",
    "start": "1523279",
    "end": "1528880"
  },
  {
    "text": "crazy waveforms like this you have to decode and figure out what it is and then you know send them the next message back and uh it's really hard so and then",
    "start": "1528880",
    "end": "1538480"
  },
  {
    "start": "1534000",
    "end": "1567000"
  },
  {
    "text": "even if you're smart enough to do that which I don't think I was then what happens is you have to do it fast so",
    "start": "1538480",
    "end": "1545279"
  },
  {
    "text": "like you know the card is designed to be like uh you know here's some data and then the phone's like okay give me the",
    "start": "1545279",
    "end": "1550559"
  },
  {
    "text": "next data and if you don't give it the next data fast it's like oh I'm done with you so I think even if I could do",
    "start": "1550559",
    "end": "1556240"
  },
  {
    "text": "this like perfectly fast even the speed of the USB getting the data from the you know from my computer to the USRP I",
    "start": "1556240",
    "end": "1562480"
  },
  {
    "text": "think that would have been too much so if you can do this great it was beyond what I what I could do then you could",
    "start": "1562480",
    "end": "1568400"
  },
  {
    "text": "use Colin's memory injection one uh you know that that certainly would probably work some some issues with that is that",
    "start": "1568400",
    "end": "1574559"
  },
  {
    "text": "it's it's OS specific so like it would only work at least now on Android um the other thing is the bugs that I'm gonna talk about in",
    "start": "1574559",
    "end": "1581840"
  },
  {
    "text": "a little bit i I don't think there are I think there are more like timing bugs so it's it's not something you could",
    "start": "1581840",
    "end": "1586960"
  },
  {
    "text": "probably do with memory injection so well so there's some drawbacks to that method too there's certainly drawbacks",
    "start": "1586960",
    "end": "1592400"
  },
  {
    "start": "1591000",
    "end": "1685000"
  },
  {
    "text": "with my method as well but uh you know I lived with that so I did eventually with the help of some people and at the end",
    "start": "1592400",
    "end": "1598240"
  },
  {
    "text": "I'll thank a bunch of people who who made this this possible uh find a reader and some software that would actually I could do what's called card emulation",
    "start": "1598240",
    "end": "1604400"
  },
  {
    "text": "which means I could pretend I was a tag or I could pre pretend I was another pure device so the so the two",
    "start": "1604400",
    "end": "1611279"
  },
  {
    "text": "combinations that work well is this ACR122U along with lib",
    "start": "1611279",
    "end": "1617559"
  },
  {
    "text": "NFC so I could emulate type two and type four cards with that and then with this other reader this 3711 uh I and then",
    "start": "1617559",
    "end": "1625679"
  },
  {
    "text": "this software called NFCPY I could I could do LLCP to a phone so with that I'm basically in in",
    "start": "1625679",
    "end": "1632640"
  },
  {
    "text": "business i can I can start to uh emulate tags and and you know put fuzz data in",
    "start": "1632640",
    "end": "1638080"
  },
  {
    "text": "them and watch what happens so with what I had at my disposal I could fuzz the green parts of",
    "start": "1638080",
    "end": "1643840"
  },
  {
    "text": "the protocol so there's some tag types I couldn't do if you you know you could you could write you know software to do",
    "start": "1643840",
    "end": "1649679"
  },
  {
    "text": "that i just didn't do it and uh uh but it's possible it's like physically possible it's just I didn't do it and",
    "start": "1649679",
    "end": "1655520"
  },
  {
    "text": "then I can't get down to the radio waves because uh you you know the hardware doesn't really support that so anyway I",
    "start": "1655520",
    "end": "1660640"
  },
  {
    "text": "could fuzz like this so there's still lots of stuff out there for for people to fuzz that I didn't fuzz um so let's",
    "start": "1660640",
    "end": "1665919"
  },
  {
    "text": "start about with end of fuzzing and how I did that so this was really easy because there's software in in Lib NFC",
    "start": "1665919",
    "end": "1672159"
  },
  {
    "text": "that that basically emulates a tag and so I just you know create some crazy end up data to send it to the the program",
    "start": "1672159",
    "end": "1678320"
  },
  {
    "text": "and it emulates a tag and and everything's easy um and then to do the low sort of",
    "start": "1678320",
    "end": "1684480"
  },
  {
    "text": "lower memory type two fuzzing and back in this picture remember uh now instead of just fuzzing",
    "start": "1684480",
    "end": "1690480"
  },
  {
    "start": "1685000",
    "end": "1730000"
  },
  {
    "text": "the data I fuzz the higher level stuff so the capability container uh you know",
    "start": "1690480",
    "end": "1695840"
  },
  {
    "text": "the serial number anything like that so then I can fuzz that by modifying the the tools that come with MLC",
    "start": "1695840",
    "end": "1703080"
  },
  {
    "text": "so then for type four fuzzing remember it was this like file system so now what I do is I fuzz this capability container",
    "start": "1703840",
    "end": "1710840"
  },
  {
    "text": "file again I just had to um you know make some changes to the the programs that were there already um so that I",
    "start": "1710840",
    "end": "1717039"
  },
  {
    "text": "could I could write fuzz capability container files and you know then it so it would just again it would read the",
    "start": "1717039",
    "end": "1722720"
  },
  {
    "text": "capability container file and then sometimes it would go on and read the end file but I didn't really care about the end file at this part and then for",
    "start": "1722720",
    "end": "1728880"
  },
  {
    "text": "the LLCP fuzzing again I just modified things that were in the existing tool sets I",
    "start": "1728880",
    "end": "1734000"
  },
  {
    "start": "1730000",
    "end": "1742000"
  },
  {
    "text": "had access to so to where it would it would read in and uh you know fuzz connect PDUs and and fuzz information",
    "start": "1734000",
    "end": "1740320"
  },
  {
    "text": "PDUs and send them to the device um the only thing that was left was okay so I can emulate a tag but how",
    "start": "1740320",
    "end": "1747840"
  },
  {
    "text": "do I emulate like the setting the phone down on the tag and and bringing it back up and so it turns out that the way you",
    "start": "1747840",
    "end": "1753840"
  },
  {
    "text": "can do that uh you know in software without you know people and stuff is uh",
    "start": "1753840",
    "end": "1761120"
  },
  {
    "text": "if you if you turn the NFC off and then set the tag set it on the tag and then",
    "start": "1761120",
    "end": "1766159"
  },
  {
    "text": "you turn the NFC on the phone acts like the tag just showed up sort of magically",
    "start": "1766159",
    "end": "1771279"
  },
  {
    "text": "um so so what I do is I just turn that you know by toggling the NFC on and off it thinks tags are just sort of showing",
    "start": "1771279",
    "end": "1776880"
  },
  {
    "text": "up and it just it just happens that when the tags show up they're different every time because I'm fuzzing it and so",
    "start": "1776880",
    "end": "1783760"
  },
  {
    "text": "there's this uh NFC service you can call in uh Android you can turn it on and off",
    "start": "1783760",
    "end": "1790000"
  },
  {
    "text": "with this command I give there and then for and you'll actually see a little check check mark you know going away and",
    "start": "1790000",
    "end": "1795200"
  },
  {
    "text": "coming back and then there's uh for MIGO I just kill the service and restart it",
    "start": "1795200",
    "end": "1800960"
  },
  {
    "start": "1799000",
    "end": "1843000"
  },
  {
    "text": "all right so this is basically uh the last element is that these readers weren't really meant to emulate like",
    "start": "1800960",
    "end": "1806640"
  },
  {
    "text": "10,000 tags in a row so after like a you know a little while they sort of freeze up and and and won't work anymore and",
    "start": "1806640",
    "end": "1813440"
  },
  {
    "text": "there's nothing you can do like in software bot where they what you the fix is you unplug it and plug it back in a",
    "start": "1813440",
    "end": "1820159"
  },
  {
    "text": "hard reset right um and again like I didn't want to build like some although I did consider it this a robot that was",
    "start": "1820159",
    "end": "1825360"
  },
  {
    "text": "just like you know so uh what I did was I found this USB port uh USB hub that",
    "start": "1825360",
    "end": "1832399"
  },
  {
    "text": "you can control the power to with software so I could like turn the power off on on that port and so it was kind of like I turned you know the device off",
    "start": "1832399",
    "end": "1838559"
  },
  {
    "text": "so anyway and you can see like uh the water damage in my house in the in the basement in the",
    "start": "1838559",
    "end": "1844279"
  },
  {
    "start": "1843000",
    "end": "1884000"
  },
  {
    "text": "background okay and then uh so so everything's cool the only thing left is to check for crashes uh in Android",
    "start": "1844279",
    "end": "1849440"
  },
  {
    "text": "that's easy logcat will will show you whenever anything crashes amigo like I don't think anyone's really looked at",
    "start": "1849440",
    "end": "1854880"
  },
  {
    "text": "MIGO it's sort of a obscure OS um so what I did there was I just used GDB and",
    "start": "1854880",
    "end": "1860159"
  },
  {
    "text": "attached to the the MC demon and and looked for crashes that way and then since I thought well maybe other stuff's",
    "start": "1860159",
    "end": "1865440"
  },
  {
    "text": "going to be crashing besides the MC demon I just did a PS and uh you know recorded all the PIDs um of the",
    "start": "1865440",
    "end": "1871840"
  },
  {
    "text": "processes and then after I sent sent it I checked to see that none of those PIDs changed or like no new processes showed",
    "start": "1871840",
    "end": "1877600"
  },
  {
    "text": "up or went away or anything like that and as you'll see I actually didn't find any bugs in the low level amigo stack so",
    "start": "1877600",
    "end": "1883440"
  },
  {
    "text": "I probably screwed that up okay and then uh the other thing I",
    "start": "1883440",
    "end": "1889520"
  },
  {
    "start": "1884000",
    "end": "1921000"
  },
  {
    "text": "did was like I would send uh you know a fuzzed tag to the phone and then I would",
    "start": "1889520",
    "end": "1896399"
  },
  {
    "text": "send a good tag and make sure that it showed up to make sure like I hadn't done something weird to service and the way you do that is pretty easy so in",
    "start": "1896399",
    "end": "1902399"
  },
  {
    "text": "Android tags the the default application for dealing with this stuff it it records it in a SQLite database you can",
    "start": "1902399",
    "end": "1908240"
  },
  {
    "text": "just query the database and make sure that the good one showed up and on MIGO if you turn on the NFC demon with this",
    "start": "1908240",
    "end": "1914880"
  },
  {
    "text": "extra logging option then it just shows up in SIS log so you can just parse this log and make sure the good ends are",
    "start": "1914880",
    "end": "1920399"
  },
  {
    "text": "showing up so so anyway so then I had you know a fuzzer working so you know it's these movies are are entirely lame",
    "start": "1920399",
    "end": "1926720"
  },
  {
    "start": "1921000",
    "end": "1977000"
  },
  {
    "text": "but it took me 6 months to to make this so I I have to show it um so this is the fuzzer running so it's like oh that was",
    "start": "1926720",
    "end": "1932640"
  },
  {
    "text": "a that was a bad one this is a good one it can handle the good one and then the bad one it's like \"Oh I can't read that",
    "start": "1932640",
    "end": "1937840"
  },
  {
    "text": "tag.\" And then you know then this is the N9 and it's like \"Oh here's a good one.\" So it's like boring but again like it",
    "start": "1937840",
    "end": "1944559"
  },
  {
    "text": "was nine months of my life or something 6 months i guess write the pleasure so then here is this this one this one is this is a Nexus S so uh so then this is",
    "start": "1944559",
    "end": "1953840"
  },
  {
    "text": "a good one and then the bad one actually doesn't show up because it's so bad and evil but then the next good one shows up and it's you know you can even hear it",
    "start": "1953840",
    "end": "1960640"
  },
  {
    "text": "dinging it's very cool so this is so uh so like in my house it would just be like bing bing like all night and uh so",
    "start": "1960640",
    "end": "1970320"
  },
  {
    "text": "like sometimes my kids like I hear one of my kids would be like hey what's that what's that noise the other one was like oh it's just it's just dad doing that",
    "start": "1970320",
    "end": "1976080"
  },
  {
    "text": "fuzzing thing so anyway and then I had so there was this one one of the readers actually was",
    "start": "1976080",
    "end": "1981600"
  },
  {
    "start": "1977000",
    "end": "2017000"
  },
  {
    "text": "like sometimes it would just go like super loud and so I had that's",
    "start": "1981600",
    "end": "1987120"
  },
  {
    "text": "why I was in the basement doing that fuzzing because I was like ah I can't even like I I tried like putting a pillow on it and stuff but it was so",
    "start": "1987120",
    "end": "1993519"
  },
  {
    "text": "loud I had to put in the basement all right so what did I fuzz uh so I didn't fuzz the latest and greatest it was the",
    "start": "1993519",
    "end": "1999279"
  },
  {
    "text": "latest and greatest uh when I started fuzzing but it was a long time ago uh next is us running 233 gingerbread is",
    "start": "1999279",
    "end": "2005279"
  },
  {
    "text": "what I did for Android and Nokia N912 har matten PR12 is what I was",
    "start": "2005279",
    "end": "2010720"
  },
  {
    "text": "fuzzing for for uh the lowle Nokia stuff and like you saw it's like it's pretty slow right um so I did like around",
    "start": "2010720",
    "end": "2017519"
  },
  {
    "text": "50,000 for each one here's the the test cases broken out as like low-level stuff for different types LCP which is the",
    "start": "2017519",
    "end": "2024159"
  },
  {
    "text": "peerto-peer and then like tons and tons of ends all right so So what did I find i",
    "start": "2024159",
    "end": "2029279"
  },
  {
    "start": "2027000",
    "end": "2062000"
  },
  {
    "text": "already gave away the the you know the punch line that in the on the MIGO side I didn't find anything on the Android",
    "start": "2029279",
    "end": "2034640"
  },
  {
    "text": "side I found some stuff so so it doesn't take long at all like you know 10 test cases and you'll start to see this so so",
    "start": "2034640",
    "end": "2041919"
  },
  {
    "text": "tags like falls over real easy but they're just Java exceptions so it's not really security um important but at least you know that like it's",
    "start": "2041919",
    "end": "2049480"
  },
  {
    "text": "working um then if you fuzz a little more instead of tags dying pretty soon the NFC service will start dying again",
    "start": "2049480",
    "end": "2055679"
  },
  {
    "text": "if you look at the logs you see here that it wasn't native code crashing and it was just a Java exception so again not not so",
    "start": "2055679",
    "end": "2061638"
  },
  {
    "text": "cool um finally then I started to find some native code crashes um one this is just a no pointer so again not so cool",
    "start": "2061639",
    "end": "2068000"
  },
  {
    "start": "2062000",
    "end": "2082000"
  },
  {
    "text": "but at least like I it was just sort of verifying that my fuzzer was working and catching things and stuff so if you send",
    "start": "2068000",
    "end": "2073679"
  },
  {
    "text": "a connection complete PDU before you send a connect PDU then it it dies because there's a nouinter exception",
    "start": "2073679",
    "end": "2078800"
  },
  {
    "text": "makes sense but they should probably check that um and then here's one that's",
    "start": "2078800",
    "end": "2084000"
  },
  {
    "text": "that's actually kind of cool so uh so the important thing I guess is just to realize this statement like LLCP",
    "start": "2084000",
    "end": "2091358"
  },
  {
    "text": "check LCP and then it dies and and abort so let's see what that one's all about you can look at the source code and find",
    "start": "2091359",
    "end": "2098640"
  },
  {
    "start": "2095000",
    "end": "2124000"
  },
  {
    "text": "that that line and it's right here so it's like up here it allocates something and then like when something goes wrong",
    "start": "2098640",
    "end": "2105359"
  },
  {
    "text": "it goes in here and it frees that thing and it jumps down to to this guy and down here it calls dnit and then it",
    "start": "2105359",
    "end": "2110800"
  },
  {
    "text": "frees it again this classical double free um and this is again in the the um",
    "start": "2110800",
    "end": "2117440"
  },
  {
    "text": "NFC demon on on on like versions of gingerbread on",
    "start": "2117440",
    "end": "2123880"
  },
  {
    "text": "Android um so so this is something that that got fixed in Ice Cream Sandwich and uh not not by me i didn't help them they",
    "start": "2123880",
    "end": "2130480"
  },
  {
    "start": "2124000",
    "end": "2143000"
  },
  {
    "text": "they did it on their own so that's cool uh so the so the good news is if you run ice cream sandwich you don't have to worry about that bug um if you run",
    "start": "2130480",
    "end": "2137280"
  },
  {
    "text": "gingerbread uh like apparently most people do then you you could still be vulnerable to that bug",
    "start": "2137280",
    "end": "2144560"
  },
  {
    "start": "2143000",
    "end": "2208000"
  },
  {
    "text": "um and then I found a bunch of other crashes and these are totally annoying so uh I found these these these crashes",
    "start": "2144560",
    "end": "2150720"
  },
  {
    "text": "they're definitely look to me like memory corruption bugs uh and no matter how many times I tried to replicate them",
    "start": "2150720",
    "end": "2156480"
  },
  {
    "text": "I couldn't what would happen is if I ran like a thousand test cases I would always get more or less the same number of crashes that look the same but like I",
    "start": "2156480",
    "end": "2162960"
  },
  {
    "text": "couldn't narrow it down to one and my reasoning and I tried like everything um so my reasoning is it must have",
    "start": "2162960",
    "end": "2168720"
  },
  {
    "text": "something to do with timing so and it's really hard to to you know replicate the timing so anyway but here's some crashes",
    "start": "2168720",
    "end": "2174200"
  },
  {
    "text": "that may still be an ice cream sandwich may or jelly bean or whatever or may not i have no idea they're still kind of fun",
    "start": "2174200",
    "end": "2181119"
  },
  {
    "text": "bugs so uh here's one where it aborts and and and DL Malik which usually means memory corruption uh and again these",
    "start": "2181119",
    "end": "2187440"
  },
  {
    "text": "might all just be one bug or they might be different bugs who knows here's one where it where it aborts in and free",
    "start": "2187440",
    "end": "2192960"
  },
  {
    "text": "here's one where it crashes in free and you can actually trace back and see what happened and it's trying to uh unlink a",
    "start": "2192960",
    "end": "2199599"
  },
  {
    "text": "chunk and the back pointer has been is like totally crazy so and again like that tells me it's probably memory",
    "start": "2199599",
    "end": "2205359"
  },
  {
    "text": "corruption and then there's another one that crashes in DL Malik so um anyway so there's there's",
    "start": "2205359",
    "end": "2211760"
  },
  {
    "text": "bugs out there uh at least there were in 233 so you know you know and what these",
    "start": "2211760",
    "end": "2217119"
  },
  {
    "text": "bugs would basically do is like you know if I did if Todd Manning or someone had his phone in his pocket and I'm walking",
    "start": "2217119",
    "end": "2222720"
  },
  {
    "text": "around with my hand by his his uh phone um then I could conceivably get code",
    "start": "2222720",
    "end": "2229920"
  },
  {
    "text": "execution inside of the NFC demon um but keep in mind on Android the NFC demon does not have like uh internet",
    "start": "2229920",
    "end": "2236320"
  },
  {
    "text": "permissions but it does have Bluetooth permissions which we'll see later is actually pretty cool okay so uh so so that was the",
    "start": "2236320",
    "end": "2243760"
  },
  {
    "text": "low-level code now let's look at the highle code and it turns out the highle code which I thought was going to take like 5% of my research time was actually",
    "start": "2243760",
    "end": "2250240"
  },
  {
    "text": "like the the most uh the most exciting part of the project so um so when you",
    "start": "2250240",
    "end": "2256160"
  },
  {
    "text": "look at it it's like okay so we've already basically looked at the service and down what what over here besides tags um you know deals with data doesn't",
    "start": "2256160",
    "end": "2265200"
  },
  {
    "text": "require user interaction and has bugs so at first glance when you look at",
    "start": "2265200",
    "end": "2271440"
  },
  {
    "start": "2267000",
    "end": "2302000"
  },
  {
    "text": "NFC and the high level apps it's like totally boring so this is gingerbread on the left it's like uh yeah text right",
    "start": "2271440",
    "end": "2278640"
  },
  {
    "text": "it's going to be tough to find a bug there in the middle ice cream sandwich same on the right is the connection dialogues on the Nokia M9 so it's like",
    "start": "2278640",
    "end": "2285520"
  },
  {
    "text": "you know it's going to be hard to find a bug if all it's doing is printing out like you know 20 characters or something and that's the thing about NFC it's like",
    "start": "2285520",
    "end": "2290800"
  },
  {
    "text": "well NFC tags have like 200 bytes of data at most it's going to be hard to find bugs and you know it I'm confident",
    "start": "2290800",
    "end": "2296720"
  },
  {
    "text": "that a lot of software developers can write code to parse 200 bytes without making too many",
    "start": "2296720",
    "end": "2301960"
  },
  {
    "text": "errors but then they want to make NFC like really cool and exciting and you",
    "start": "2301960",
    "end": "2307040"
  },
  {
    "start": "2302000",
    "end": "2325000"
  },
  {
    "text": "know fun and whatever so they added all these these features um so in Android",
    "start": "2307040",
    "end": "2312400"
  },
  {
    "text": "you can have like more than one NFC app besides tags you can you know download MC apps uh also there's this Android",
    "start": "2312400",
    "end": "2318480"
  },
  {
    "text": "beam uh and then they have these things for Nokia content sharing and Bluetooth pairing so so we'll talk about each of those and if there's security",
    "start": "2318480",
    "end": "2325720"
  },
  {
    "start": "2325000",
    "end": "2340000"
  },
  {
    "text": "significance so multiple apps not so exciting it just means that you can you could imagine like yeah sure tags is",
    "start": "2325720",
    "end": "2332640"
  },
  {
    "text": "rock solid but you know you download some other app from from you know Google play store and then uh you know you",
    "start": "2332640",
    "end": "2339359"
  },
  {
    "text": "could exploit that or something so so Android Beam is uh",
    "start": "2339359",
    "end": "2344800"
  },
  {
    "start": "2340000",
    "end": "2391000"
  },
  {
    "text": "something that they they that came out an ice cream sandwich that would allow you like you're jamming on your you know",
    "start": "2344800",
    "end": "2350400"
  },
  {
    "text": "your ice cream sandwich device and and you want to like share a picture of something with your friend who has you",
    "start": "2350400",
    "end": "2355440"
  },
  {
    "text": "know an Android device and so you kind of like put the phones sort of close to each other and press a button and it just like you know goes this this you",
    "start": "2355440",
    "end": "2361680"
  },
  {
    "text": "know goes over NFC and then they see what you're seeing you know it's you know that's that's pretty cool right um",
    "start": "2361680",
    "end": "2368079"
  },
  {
    "text": "and and the way now that you understand NFC you can I can actually tell you how that works and the way it works is uses",
    "start": "2368079",
    "end": "2373200"
  },
  {
    "text": "LCP because it's peers uh plus uh SS snap and then if that doesn't work then",
    "start": "2373200",
    "end": "2378880"
  },
  {
    "text": "they use MPPP um but the the thing that's funny is on when you're sending it so it says like touch the beam so the",
    "start": "2378880",
    "end": "2384240"
  },
  {
    "text": "guy who's sending it has to press something but the guy who receives it doesn't press anything it just shows up um which is you know I don't know",
    "start": "2384240",
    "end": "2391440"
  },
  {
    "start": "2391000",
    "end": "2424000"
  },
  {
    "text": "it's kind of easy and convenient but like uh like here you can actually share web pages right and I don't know if I",
    "start": "2391440",
    "end": "2396720"
  },
  {
    "text": "want people pushing web pages to my phone so uh you can see and if you want to",
    "start": "2396720",
    "end": "2402240"
  },
  {
    "text": "know which applications are are set up for Android beam it's all done with intents like everything else in Android",
    "start": "2402240",
    "end": "2407359"
  },
  {
    "text": "so you can just go through all the the Android manifest files and look for the ones that register the right intents and",
    "start": "2407359",
    "end": "2413200"
  },
  {
    "text": "if you do that for the version of ice cream sandwich which I looked at the only ones are browser the browser uh",
    "start": "2413200",
    "end": "2418560"
  },
  {
    "text": "contacts which is like you know your your address book and uh tags of course so um so it's actually the",
    "start": "2418560",
    "end": "2425839"
  },
  {
    "start": "2424000",
    "end": "2460000"
  },
  {
    "text": "browser one that that kind of freaks me out so like here's the phone right you get near it with a tag and all of a",
    "start": "2425839",
    "end": "2431040"
  },
  {
    "text": "sudden it takes you to a website of its choosing right and the user didn't do anything so you know I'm I'm less",
    "start": "2431040",
    "end": "2438000"
  },
  {
    "text": "confident that's that a developer can write a parser for HTML MP3s GIFs JPEGs",
    "start": "2438000",
    "end": "2445119"
  },
  {
    "text": "you know fonts videos everything else and not make a mistake than I am them writing something to parse ndef right so",
    "start": "2445119",
    "end": "2451119"
  },
  {
    "text": "so for me it's it's it's it's a little surprising that a phone can you know",
    "start": "2451119",
    "end": "2456560"
  },
  {
    "text": "with with a tag that I can I can send you to a website um oh so here",
    "start": "2456560",
    "end": "2462440"
  },
  {
    "text": "finally my assistants are going to show you like a pretty cool demo so um so",
    "start": "2462440",
    "end": "2467520"
  },
  {
    "text": "these two guys worked hard to uh to make a cool demo for me so uh let's see if",
    "start": "2467520",
    "end": "2473760"
  },
  {
    "text": "it'll work i have I have a video backup because I don't trust them though so if you saw us scrambling there that",
    "start": "2473760",
    "end": "2479839"
  },
  {
    "text": "was because uh you know they were going to get here a half hour early so we could work on the demo and they showed",
    "start": "2479839",
    "end": "2484960"
  },
  {
    "text": "up 5 minutes before my talk let's see uh make this bigger",
    "start": "2484960",
    "end": "2491400"
  },
  {
    "text": "oops okay so what's going to happen here is I have a netcat listener uh he has a phone with with ice",
    "start": "2491400",
    "end": "2499599"
  },
  {
    "text": "cream sandwich 401 um and uh and then",
    "start": "2499599",
    "end": "2505359"
  },
  {
    "text": "they have a tag as well and so they're going to touch the tag and then a shell's going to show up on the phone",
    "start": "2505359",
    "end": "2510560"
  },
  {
    "text": "look at look at see he's just minding his his own business on the phone uh so",
    "start": "2510560",
    "end": "2516160"
  },
  {
    "text": "let's see if anything happens and then if you look at the phone uh is there anything happening on the phone our",
    "start": "2516160",
    "end": "2523359"
  },
  {
    "text": "internet might be down oh like what happened let's do again so",
    "start": "2523359",
    "end": "2529599"
  },
  {
    "text": "then you're like hey like my browser showed up and then disappeared but I'm going to just continue to talk on the phone as if nothing happened all",
    "start": "2529599",
    "end": "2537119"
  },
  {
    "text": "right so now so that time it it actually worked um so uh so now I have an interactive shell oops what is it it's",
    "start": "2537119",
    "end": "2544760"
  },
  {
    "text": "uh so yeah so hand for these guys they wrote this exploit it's really [Applause]",
    "start": "2544760",
    "end": "2552569"
  },
  {
    "text": "cool so anyway you can So it you know the the the takeaway is it's like touch",
    "start": "2553880",
    "end": "2559920"
  },
  {
    "text": "a tag get a shell right and uh you know it's it's sort of frightening so so this",
    "start": "2559920",
    "end": "2565280"
  },
  {
    "text": "you know it's so this bug that they wrote the exploit for it's a webkit bug it's a it's the same web kit bug they",
    "start": "2565280",
    "end": "2570800"
  },
  {
    "text": "talked about in Steven's talk today if you saw that so it's not really an NFC bug but still it's uh you know I can the",
    "start": "2570800",
    "end": "2577839"
  },
  {
    "text": "fact that I can get a shell just and all I did was get near your phone is like pretty pretty awesome I think so uh",
    "start": "2577839",
    "end": "2583760"
  },
  {
    "text": "anyway uh great job on that it was a lot of hard work it's a cool exploit so thanks a lot to those guys for that um",
    "start": "2583760",
    "end": "2591280"
  },
  {
    "text": "and and there's Yeah [Applause]",
    "start": "2591280",
    "end": "2596560"
  },
  {
    "start": "2596000",
    "end": "2625000"
  },
  {
    "text": "okay so uh up there's the backup video we don't need that we We did it live it only took two times in the video it only",
    "start": "2596560",
    "end": "2602720"
  },
  {
    "text": "took one time as far as you can tell so uh so so sort of the takeaway",
    "start": "2602720",
    "end": "2608880"
  },
  {
    "text": "from that is you know initially you're like okay here's the attack service right it's it's like you know some a couple native code libraries not much",
    "start": "2608880",
    "end": "2615520"
  },
  {
    "text": "mostly Java this Java you know tags application but the real attack service is this the browser right and and so",
    "start": "2615520",
    "end": "2622400"
  },
  {
    "text": "that's that's uh pretty screwed up all right so So what about Nokia like I've been picking on Android there but it",
    "start": "2622400",
    "end": "2628480"
  },
  {
    "start": "2625000",
    "end": "2667000"
  },
  {
    "text": "turns out Nokia is even uh in a worse position so they have their thing they don't call it Beam they call it content",
    "start": "2628480",
    "end": "2635160"
  },
  {
    "text": "sharing and it's basically the same thing it's like you put two N9s close to each other and you can share stuff um",
    "start": "2635160",
    "end": "2640880"
  },
  {
    "text": "and again without user interaction and uh so on Android there's there's a setting for NFC on off and that's it you",
    "start": "2640880",
    "end": "2646720"
  },
  {
    "text": "got no other choices and on N9 you get a second setting that you can choose so",
    "start": "2646720",
    "end": "2651839"
  },
  {
    "text": "it's called confirm sharing and connecting so it's like well that sounds unsecure um but the thing is even if you have",
    "start": "2651839",
    "end": "2658720"
  },
  {
    "text": "that on I can still push files to your phone and without you doing anything so uh we'll talk about what that actually does later and it's actually a good",
    "start": "2658720",
    "end": "2665359"
  },
  {
    "text": "setting that you should have on so uh so here's an example of of like what I'm",
    "start": "2665359",
    "end": "2670640"
  },
  {
    "text": "talking about so if you'll notice so this is N9 bluetooth is turned off because like only crazy people would",
    "start": "2670640",
    "end": "2676400"
  },
  {
    "text": "would run Bluetooth right so I get it near another device um you can see like oh look Bluetooth's on now what happened",
    "start": "2676400",
    "end": "2683119"
  },
  {
    "text": "i didn't touch anything oh wait it's downloading something well you know it can download files i don't care about that but uh you know it's just download",
    "start": "2683119",
    "end": "2690480"
  },
  {
    "text": "oh it's rendering it too but you know it's probably just like an image or something so it's okay it'll take a",
    "start": "2690480",
    "end": "2696640"
  },
  {
    "text": "while because N9s are very slow but um it's like yeah it's a JPEG or something",
    "start": "2696640",
    "end": "2701760"
  },
  {
    "text": "it's like oh crap it's a PowerPoint you know no one can write a PowerPoint parser properly oh uh so the attack",
    "start": "2701760",
    "end": "2707440"
  },
  {
    "text": "service goes goes from you know this this end parser to to almost everything",
    "start": "2707440",
    "end": "2712640"
  },
  {
    "text": "so you can't do the browser on on the M9 but you can do basically everything else so like all the image formats video",
    "start": "2712640",
    "end": "2717920"
  },
  {
    "text": "formats audio formats and then the thing that's super frightening is the Office suite so like PDFs Word documents Excel",
    "start": "2717920",
    "end": "2726079"
  },
  {
    "text": "spreadsheets and stuff like that and again there's nothing you can do if NFC is on there that that setting that that",
    "start": "2726079",
    "end": "2731920"
  },
  {
    "text": "sounds secure doesn't actually help you and having Bluetooth off which is the way they actually transfer the file",
    "start": "2731920",
    "end": "2737040"
  },
  {
    "text": "doesn't help you either because this turns on Bluetooth for you but it is convenient um so so here's",
    "start": "2737040",
    "end": "2744720"
  },
  {
    "start": "2740000",
    "end": "2750000"
  },
  {
    "text": "here's again this is what you think the attack service is but the real tech service is this okay so uh so so then I want to",
    "start": "2744720",
    "end": "2753359"
  },
  {
    "start": "2750000",
    "end": "2791000"
  },
  {
    "text": "like you know I want to actually write an exploit say I want to own uh you know",
    "start": "2753359",
    "end": "2758400"
  },
  {
    "text": "Travis Goodspeed i understand he has an end so I want to own his phone and steal all his stuff um so what do you do well",
    "start": "2758400",
    "end": "2764960"
  },
  {
    "text": "the latest N9 which is 1.3 uh it come it ships with a with vulnerable versions of software so one you can look at is lib",
    "start": "2764960",
    "end": "2772240"
  },
  {
    "text": "PNG so it comes with 1 1242 but if you go to the lib PNG website you'll see there's at least two critical um",
    "start": "2772240",
    "end": "2778000"
  },
  {
    "text": "warnings for that so you could write a lib PNG bug you get near the person it you know it ships over PNG and you own",
    "start": "2778000",
    "end": "2784880"
  },
  {
    "text": "them but if you know for me like using a public bug is like so pass a I want to",
    "start": "2784880",
    "end": "2790880"
  },
  {
    "text": "find my zero days right so I I fuzzed for like a couple days uh you know some some of their you know high level apps",
    "start": "2790880",
    "end": "2797040"
  },
  {
    "start": "2791000",
    "end": "2808000"
  },
  {
    "text": "to see what I could find so I found this like PowerPoint bug it freeze some random pointer uh this PDF bug that is",
    "start": "2797040",
    "end": "2802960"
  },
  {
    "text": "uh you know it lets you write stuff um but but the best bug I found and I I just found it like last week um cuz I",
    "start": "2802960",
    "end": "2810000"
  },
  {
    "start": "2808000",
    "end": "2893000"
  },
  {
    "text": "was bored um is this bug so this is a bug that's in the way they process word",
    "start": "2810000",
    "end": "2815280"
  },
  {
    "text": "documents and it's also in K office too so it's a K office zero day if anyone uses that product um in Linux uh I doubt",
    "start": "2815280",
    "end": "2822880"
  },
  {
    "text": "there's like probably three people in the world I could totally own with this but um so so the way it works is there's",
    "start": "2822880",
    "end": "2828160"
  },
  {
    "text": "you know it's reading in a word document and it it it does an allocation here based on some number that you've you've",
    "start": "2828160",
    "end": "2833680"
  },
  {
    "text": "given a long time ago and then it reads in another short here and then it starts",
    "start": "2833680",
    "end": "2839839"
  },
  {
    "text": "copying that number of bytes um from from the data stream into this buffer that was allocated with some other",
    "start": "2839839",
    "end": "2845440"
  },
  {
    "text": "things so it's a it's a classic heap overflow you control the length of the",
    "start": "2845440",
    "end": "2850640"
  },
  {
    "text": "allocation the length of the data that's getting copied in the and the contents so it it's you know sort of the easiest",
    "start": "2850640",
    "end": "2855760"
  },
  {
    "text": "one you can imagine and if you still don't believe me that I could have I could have exploited but I ran out of time um here's the file I wrote so uh it",
    "start": "2855760",
    "end": "2862160"
  },
  {
    "text": "here's the link and then here's the data so it crashes and some random place that",
    "start": "2862160",
    "end": "2867520"
  },
  {
    "text": "it didn't know where that was um one thing I got to say is like the the tool chain on N9 is way better than the tool",
    "start": "2867520",
    "end": "2872720"
  },
  {
    "text": "chain on on Android get your act together Google um but anyway so it crashed if you go in the",
    "start": "2872720",
    "end": "2878160"
  },
  {
    "text": "back trace it crashes here and how why did it crash well it loaded from R3 something into R12 and then it branched",
    "start": "2878160",
    "end": "2884079"
  },
  {
    "text": "to R12 and what was R3 well I controlled that so I could have gotten control of program counter with like you know five",
    "start": "2884079",
    "end": "2889839"
  },
  {
    "text": "more minutes of effort so uh there's there's your zero day for the end um so",
    "start": "2889839",
    "end": "2896400"
  },
  {
    "start": "2893000",
    "end": "2942000"
  },
  {
    "text": "uh so that's that's what you can do no matter Oops hold on a second i don't want to show you that yet so that's",
    "start": "2896400",
    "end": "2902640"
  },
  {
    "text": "that's what you can do pause that's what you can do no matter what they did but um suppose then that that they didn't",
    "start": "2902640",
    "end": "2910240"
  },
  {
    "text": "change that set that that secure setting of kind you know inform me so if you don't flip that on which is by default",
    "start": "2910240",
    "end": "2915520"
  },
  {
    "text": "it's off then you can do this Bluetooth pairing which is really crazy so uh if you Google Nokia N9 NFC all you'll see",
    "start": "2915520",
    "end": "2922640"
  },
  {
    "text": "is like a thousand versions of of this this uh video so it's like dude is like",
    "start": "2922640",
    "end": "2927680"
  },
  {
    "text": "jamming to his music and then uh and I actually So I went and I bought this speaker it's right here i can show it to",
    "start": "2927680",
    "end": "2934480"
  },
  {
    "text": "you it's pretty cool so he touches the phone to the speaker and the speaker",
    "start": "2934480",
    "end": "2940319"
  },
  {
    "text": "starts playing your music and he didn't touch a key right it's like how the hell does that happen so I bought a speaker",
    "start": "2940319",
    "end": "2947599"
  },
  {
    "start": "2942000",
    "end": "2992000"
  },
  {
    "text": "and uh my N9's broken so I can't show you exactly but I'll show you like that it works uh on Android too so um let's",
    "start": "2947599",
    "end": "2956400"
  },
  {
    "text": "see how do I how do I play music see I only use my phone for hacking purposes not for",
    "start": "2956400",
    "end": "2962040"
  },
  {
    "text": "enjoyment so like here is here it's playing music you probably can't hear it right but uh like you just set it near",
    "start": "2962040",
    "end": "2968559"
  },
  {
    "text": "here and it's like So and then it just like starts",
    "start": "2968559",
    "end": "2974640"
  },
  {
    "text": "playing on the speaker i don't know if you can still hear but it's like how did that happen and I",
    "start": "2974640",
    "end": "2980720"
  },
  {
    "text": "thought I must have turned off something because I think on Android usually it throws up a dialogue but uh the thing is",
    "start": "2980720",
    "end": "2986079"
  },
  {
    "text": "on on N9 it doesn't and got it so uh so",
    "start": "2986079",
    "end": "2991280"
  },
  {
    "text": "let's see what you can do with that so how does it work if you if you dig in and you figure out what the hell's going on it turns out that there's a",
    "start": "2991280",
    "end": "2998000"
  },
  {
    "text": "particular NFC end message that then allows you to pair with to you Bluetooth",
    "start": "2998000",
    "end": "3005280"
  },
  {
    "text": "pair with a device uh again this only works if you if you use the uh if you if you haven't turned",
    "start": "3005280",
    "end": "3012079"
  },
  {
    "text": "on this extra setting so this is what the NF message looks like you give it Bluetooth address to pair with a PIN and",
    "start": "3012079",
    "end": "3018319"
  },
  {
    "text": "uh you know the name of the device so So like my whole life I've wanted I've wanted root root shells right for me but",
    "start": "3018319",
    "end": "3026079"
  },
  {
    "text": "it turns out that what I really wanted was this th this is this is actually better than root shells so like it's",
    "start": "3026079",
    "end": "3032480"
  },
  {
    "text": "hard to write exploits but it's easy to pair it turns out so um here's a video I made cuz I didn't want to do it live uh",
    "start": "3032480",
    "end": "3039119"
  },
  {
    "text": "so here's a phone bluetooth is off right um I I I touch a tag here there's",
    "start": "3039119",
    "end": "3046160"
  },
  {
    "text": "my tag i touch it to it it it it just dings um and and then that's it right so",
    "start": "3046160",
    "end": "3051520"
  },
  {
    "text": "there nothing going on the phone now over on my computer so what's secretly happening underneath is that it's paired with my computer if you look up here in",
    "start": "3051520",
    "end": "3058000"
  },
  {
    "text": "a second you'll see I'm trying to like So up here it's like you are now paired with the N9 awesome so uh the user",
    "start": "3058000",
    "end": "3065440"
  },
  {
    "text": "didn't do anything so now I can do things like you know mount the N9's file system to my computer and you know read",
    "start": "3065440",
    "end": "3070559"
  },
  {
    "text": "all the files so there's there's like the files on on my thing and meanwhile on the phone there's like nothing going on if",
    "start": "3070559",
    "end": "3077040"
  },
  {
    "text": "you notice like if you if you were like a genius you would have noticed the little blue light that says like Bluetooth is on but uh if otherwise",
    "start": "3077040",
    "end": "3083440"
  },
  {
    "text": "there's not no uh indication so then you can see like Oh wow the sound's on um so",
    "start": "3083440",
    "end": "3089440"
  },
  {
    "text": "you can see like here's the pictures that people have taken with their camera here's pictures that you downloaded here's your music that you like uh you",
    "start": "3089440",
    "end": "3096480"
  },
  {
    "text": "could just download this stuff if you wanted here's like you know word documents so you can access all the files in the file system um and you know",
    "start": "3096480",
    "end": "3102400"
  },
  {
    "text": "I didn't have to write like ASR bypass exploit i just had to run that tool okay",
    "start": "3102400",
    "end": "3108079"
  },
  {
    "text": "so then you can also do things like besides reading files you can do things like sending a text message so here I am sending a text message to my phone",
    "start": "3108079",
    "end": "3116920"
  },
  {
    "text": "and it shows up on my phone so so there there's me sending the text message to",
    "start": "3116920",
    "end": "3122400"
  },
  {
    "text": "me um anyway so you can send text messages then you can uh you can read all the files you can access uh all the",
    "start": "3122400",
    "end": "3129680"
  },
  {
    "text": "contacts they have so you know all the the people they have in their phone book that includes the ones that are stored",
    "start": "3129680",
    "end": "3134960"
  },
  {
    "text": "sort of on the file system and also the stored on the SIM card so uh you can see here in a second it's a movie's almost",
    "start": "3134960",
    "end": "3141359"
  },
  {
    "text": "over I think so uh here's here's all the the contacts that the person has",
    "start": "3141359",
    "end": "3147359"
  },
  {
    "text": "then like the coolest thing is then you can actually uh make phone calls too so",
    "start": "3147359",
    "end": "3152559"
  },
  {
    "text": "here I am making a phone call and I'm trying to be very subtle so that you all don't secretly find out my phone number",
    "start": "3152559",
    "end": "3159040"
  },
  {
    "text": "haha you'll never know my phone [Music] number um and then uh I just so and then",
    "start": "3159040",
    "end": "3166559"
  },
  {
    "text": "you actually see something going on here that you see that the phone's dialing um and then on this side you see that the",
    "start": "3166559",
    "end": "3171599"
  },
  {
    "text": "phone's running down so anyway uh you can get complete control of of the Nokia 9 with a with an NFC tag as long as they",
    "start": "3171599",
    "end": "3178000"
  },
  {
    "text": "don't have the paranoid setting set um with with like basically no no tools at all um but if if they have that if if",
    "start": "3178000",
    "end": "3185440"
  },
  {
    "text": "they're paranoid and they flip that switch then you can get them with the with the word document parsing bug so So",
    "start": "3185440",
    "end": "3190720"
  },
  {
    "text": "no matter what they're screwed um so this is what it looks like if you try to do the uh the pairing",
    "start": "3190720",
    "end": "3197760"
  },
  {
    "text": "attack and you have that setting switch it's like do you want them to connect and then you can just hit no and and nothing bad happens okay so So that so",
    "start": "3197760",
    "end": "3205280"
  },
  {
    "start": "3202000",
    "end": "3232000"
  },
  {
    "text": "that's basically it so uh in summary so NFC Hey look someone's",
    "start": "3205280",
    "end": "3210800"
  },
  {
    "text": "calling me um so NFC opens up like a whole new sort of attack service server",
    "start": "3210800",
    "end": "3216200"
  },
  {
    "text": "side nfc tax stacks are like really hard to test which is uh why I wrote code to",
    "start": "3216200",
    "end": "3222160"
  },
  {
    "text": "do it and now you guys can do it too um the the biggest takeaway is like before you push a web page or something to me",
    "start": "3222160",
    "end": "3228400"
  },
  {
    "text": "like for God's sakes give me the option to say no and uh you know that's basically it",
    "start": "3228400",
    "end": "3234160"
  },
  {
    "start": "3232000",
    "end": "3238000"
  },
  {
    "text": "so so here's the code if you want to download all the code tiny URL FC files",
    "start": "3234160",
    "end": "3239520"
  },
  {
    "text": "and then uh lots of people I have to thank for this uh I you know it's way out of my comfort zone so uh it was",
    "start": "3239520",
    "end": "3246880"
  },
  {
    "text": "partially fun these two guys were awesome a lot of other people helped me out um that's it thanks",
    "start": "3246880",
    "end": "3255400"
  },
  {
    "start": "3250000",
    "end": "3261000"
  },
  {
    "text": "[Applause]",
    "start": "3258870",
    "end": "3263639"
  }
]