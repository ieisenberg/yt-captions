[
  {
    "start": "0",
    "end": "190000"
  },
  {
    "text": "[Music]",
    "start": "910",
    "end": "9120"
  },
  {
    "text": "hi everyone my name is timor yunusoff and my presentation today is hand in",
    "start": "9120",
    "end": "15040"
  },
  {
    "text": "your pocket without you noticing and this presentation is a fascinating",
    "start": "15040",
    "end": "20480"
  },
  {
    "text": "detective story about how we found vulnerabilities in apple pay samsung pay",
    "start": "20480",
    "end": "26000"
  },
  {
    "text": "and gpa mobile wallets normally research is done at home in a",
    "start": "26000",
    "end": "31199"
  },
  {
    "text": "warm and safe environment over this time i had to travel a lot and use london",
    "start": "31199",
    "end": "37280"
  },
  {
    "text": "underground and this research was done during the national lockdown in the uk and that",
    "start": "37280",
    "end": "43360"
  },
  {
    "text": "meant that all non-essential travels were prohibited so from one side it was not a question",
    "start": "43360",
    "end": "50160"
  },
  {
    "text": "if i could be fired if i would not finish this research in time from another side i obviously felt in a",
    "start": "50160",
    "end": "56399"
  },
  {
    "text": "little bit of gray area so from one side i was doing my daily job security research by entering and",
    "start": "56399",
    "end": "63680"
  },
  {
    "text": "leaving london metra or london tube how it's called here from another site every",
    "start": "63680",
    "end": "69119"
  },
  {
    "text": "time i was expecting someone approaching me and asking what the hell i'm doing here passing the case with some strange",
    "start": "69119",
    "end": "76400"
  },
  {
    "text": "devices attached to my body and living straight away without actual traveling",
    "start": "76400",
    "end": "82080"
  },
  {
    "text": "that's why i put this presentation in this form of detective story the story i'm going to",
    "start": "82080",
    "end": "88240"
  },
  {
    "text": "tell you today and like in every detective story we have suspects we have some mystery and",
    "start": "88240",
    "end": "94640"
  },
  {
    "text": "we will have some unsolved questions that we will try to solve uh let me introduce what general public",
    "start": "94640",
    "end": "101840"
  },
  {
    "text": "thinks of mobile wallets what banks and other companies like apple samsung how",
    "start": "101840",
    "end": "107119"
  },
  {
    "text": "they present bio wallets to the audience for this purpose we will look at the",
    "start": "107119",
    "end": "112320"
  },
  {
    "text": "most common statements from media mobile wallets have overtaken contactless cards in australia in 2021",
    "start": "112320",
    "end": "121520"
  },
  {
    "text": "almost 50 million trained journeys were made using contactless payments within",
    "start": "121520",
    "end": "127040"
  },
  {
    "text": "the uk only within one month so it's quite a lot",
    "start": "127040",
    "end": "132400"
  },
  {
    "text": "uh mobile wallets are more secure than payment cards uh digital wallets and obviously their",
    "start": "132400",
    "end": "140000"
  },
  {
    "text": "owners are well protected against fraud",
    "start": "140000",
    "end": "145040"
  },
  {
    "text": "we were doing security research about payment cards and car terminals for",
    "start": "145040",
    "end": "150480"
  },
  {
    "text": "quite a while and after our last research in that field and all",
    "start": "150480",
    "end": "156560"
  },
  {
    "text": "these fascinating statements about how amazing mobile wallets are we have decided to make our own little",
    "start": "156560",
    "end": "162480"
  },
  {
    "text": "investigation and ask a few questions ourselves so this is the main body of this",
    "start": "162480",
    "end": "169280"
  },
  {
    "text": "detective story so our mystery will try to solve so these questions are could",
    "start": "169280",
    "end": "174720"
  },
  {
    "text": "mobile wallet security actually protect your wallet if the phone was stolen",
    "start": "174720",
    "end": "181440"
  },
  {
    "text": "are you liable for the fraud if someone had stolen your phone",
    "start": "181440",
    "end": "186640"
  },
  {
    "text": "and if it's not you liable who is liable",
    "start": "186640",
    "end": "191519"
  },
  {
    "start": "190000",
    "end": "369000"
  },
  {
    "text": "why are we talking mostly about uh lost or stolen devices",
    "start": "191920",
    "end": "199200"
  },
  {
    "text": "well simply because it's very hard to clone emv cars and their descendants",
    "start": "199200",
    "end": "204480"
  },
  {
    "text": "mobile wallets uh that's why the main type of fraud against these cards and wallets is known",
    "start": "204480",
    "end": "211040"
  },
  {
    "text": "as lost and stolen when malicious actors use stolen devices or cars to make purchases without",
    "start": "211040",
    "end": "217760"
  },
  {
    "text": "knowing a pin or any other card holder secrets and last statistics from the uk finance body",
    "start": "217760",
    "end": "225920"
  },
  {
    "text": "is like in 2020 it was almost 80 million pounds lost within a year with more than",
    "start": "225920",
    "end": "233760"
  },
  {
    "text": "300 000 uh cases of floss and stone fraud and",
    "start": "233760",
    "end": "240239"
  },
  {
    "text": "surprisingly these numbers are around 20 less than average statistics over the",
    "start": "240239",
    "end": "246319"
  },
  {
    "text": "previous four years so before numbers were almost 100 million pounds when last",
    "start": "246319",
    "end": "252319"
  },
  {
    "text": "year it was dropped twenty percent uh okay it's twenty percent less however",
    "start": "252319",
    "end": "258400"
  },
  {
    "text": "it's still eighty million pounds almost eight million pounds lost",
    "start": "258400",
    "end": "263520"
  },
  {
    "text": "before we'll go into our investigation let let me quickly make an overview of",
    "start": "263520",
    "end": "269919"
  },
  {
    "text": "the history of emv and wallets so emv standing for europa visa and mastercard",
    "start": "269919",
    "end": "276639"
  },
  {
    "text": "and it has come in 90s to tackle different issues related to max drive",
    "start": "276639",
    "end": "281919"
  },
  {
    "text": "and current present transactions so this issue is meant to be solved using smart card on your indie cards so",
    "start": "281919",
    "end": "289440"
  },
  {
    "text": "smart card is used for three security features offline authentication card",
    "start": "289440",
    "end": "294800"
  },
  {
    "text": "holder verification and transaction authorization we're already talking about all the security features and for",
    "start": "294800",
    "end": "302160"
  },
  {
    "text": "the purpose of today's presentation we'll focus only on one security feature transaction",
    "start": "302160",
    "end": "308639"
  },
  {
    "text": "authorization that is made with the transaction cryptogram when you're paying with your mobile",
    "start": "308639",
    "end": "315039"
  },
  {
    "text": "wallet payment terminal will request at the end a cryptogram using a generate ac",
    "start": "315039",
    "end": "321199"
  },
  {
    "text": "command generate generate application cryptogram terminal will present a lot of fields uh",
    "start": "321199",
    "end": "327680"
  },
  {
    "text": "that are required by a mobile wallet like amount currency date unique number",
    "start": "327680",
    "end": "333840"
  },
  {
    "text": "it's worth noting that not all of these fields will be the part of the payment cryptogram as we found in 2018 during",
    "start": "333840",
    "end": "341440"
  },
  {
    "text": "our previous research and then mobile wallet take all this data and create a digital signature",
    "start": "341440",
    "end": "348880"
  },
  {
    "text": "hmac digest from using 3ds from all these essential fields and that",
    "start": "348880",
    "end": "356240"
  },
  {
    "text": "will be a payment cryptogram if you are talking about the cards this",
    "start": "356240",
    "end": "361360"
  },
  {
    "text": "cryptogram will be checked in the issuing bank on the hsam hardware secure",
    "start": "361360",
    "end": "366479"
  },
  {
    "text": "module but what happens in terms of mobile wallets so how mobile will it work main feature",
    "start": "366479",
    "end": "374400"
  },
  {
    "start": "369000",
    "end": "514000"
  },
  {
    "text": "of the mobile wallet is a tokenization process so car details that you will enter in your phone then you will be",
    "start": "374400",
    "end": "381520"
  },
  {
    "text": "sent to the tokenization service of visa or mastercard and if your issuing bank will confirm",
    "start": "381520",
    "end": "388400"
  },
  {
    "text": "that you entered all the requisites correctly and they are actual customer card holder",
    "start": "388400",
    "end": "394720"
  },
  {
    "text": "your card will be replaced with a token on your mobile phone instead so think of",
    "start": "394720",
    "end": "400800"
  },
  {
    "text": "talking as a virtual card with some limitations that is issued by visa or mastercard",
    "start": "400800",
    "end": "410000"
  },
  {
    "text": "and from now on each transactions will be authorized on the tokenization service not in the your",
    "start": "410000",
    "end": "418080"
  },
  {
    "text": "issuing bank so all in the risk-based steps all cryptographic",
    "start": "418080",
    "end": "423520"
  },
  {
    "text": "features all cryptographic steps will be happening either on the device mobile",
    "start": "423520",
    "end": "428880"
  },
  {
    "text": "wallet uh that is certified by visa or mastercard or on the tokenization service of peace",
    "start": "428880",
    "end": "436000"
  },
  {
    "text": "and mastercard uh first of all apple is in samsung and google",
    "start": "436000",
    "end": "441919"
  },
  {
    "text": "here they do not process payment data they just do some things on the edge",
    "start": "441919",
    "end": "448160"
  },
  {
    "text": "device and then send it to visa mastercard and all magic will happen",
    "start": "448160",
    "end": "454319"
  },
  {
    "text": "somewhere else so uh even it can't it's not easy to",
    "start": "454319",
    "end": "460479"
  },
  {
    "text": "implement any changes even on the device because these devices are certified it",
    "start": "460479",
    "end": "465759"
  },
  {
    "text": "is a must card and you can't just uh inform apple or something saying hey we found",
    "start": "465759",
    "end": "472319"
  },
  {
    "text": "this vulnerabilities you need to change that they will say hey we are certified we can't just implement any random",
    "start": "472319",
    "end": "478240"
  },
  {
    "text": "changes and banking this picture your issuing bank basically will",
    "start": "478240",
    "end": "485039"
  },
  {
    "text": "just check that you have enough money on your account that your card was not locked marked or stolen",
    "start": "485039",
    "end": "491360"
  },
  {
    "text": "and potentially will get some additional metadata like the merchant that time",
    "start": "491360",
    "end": "497280"
  },
  {
    "text": "date but they will not bother by analyzing emv fields do all risk management checks",
    "start": "497280",
    "end": "504639"
  },
  {
    "text": "because it's not their responsibility anymore from now on it's the problem of apple or visa for example",
    "start": "504639",
    "end": "512000"
  },
  {
    "text": "and this is the source of the problem so uh",
    "start": "512000",
    "end": "517279"
  },
  {
    "start": "514000",
    "end": "680000"
  },
  {
    "text": "now when you have some background we'll start in the narrative of our investigation in 2019 we looked at gpay",
    "start": "517279",
    "end": "525519"
  },
  {
    "text": "that by that time was the only mobile wallet allowing payments on lock devices",
    "start": "525519",
    "end": "532480"
  },
  {
    "text": "when apple and samsung actually required their phones to have passcodes and to be unlocked uh",
    "start": "532480",
    "end": "540160"
  },
  {
    "text": "during the payments and that became a big obstacle for the transport system as shown in the",
    "start": "540160",
    "end": "546560"
  },
  {
    "text": "beginning money that are spent using on on transportation are really",
    "start": "546560",
    "end": "552720"
  },
  {
    "text": "big that's why in 2019 both apple and samsung had",
    "start": "552720",
    "end": "557839"
  },
  {
    "text": "introduced their transport systems or transit systems so",
    "start": "557839",
    "end": "563279"
  },
  {
    "text": "what does it mean you choose one of your cards that are enrolled on your mobile wallet set it up as a default transport",
    "start": "563279",
    "end": "569200"
  },
  {
    "text": "card and from now on you can use this card without unlocking your phone when you pay for example in london",
    "start": "569200",
    "end": "575839"
  },
  {
    "text": "underground so that was the winter of 2019 when i",
    "start": "575839",
    "end": "581279"
  },
  {
    "text": "decided to go and test apple pay transport cards using tfl",
    "start": "581279",
    "end": "587440"
  },
  {
    "text": "for london terminals i was equipped with proxmark attached to my iphone a few wires",
    "start": "587440",
    "end": "594880"
  },
  {
    "text": "covered with my clothes and a rooted jailbroken iphone and i started tapping and",
    "start": "594880",
    "end": "601440"
  },
  {
    "text": "recording all the traffic and events on the phone trying to find how exactly this feature",
    "start": "601440",
    "end": "607120"
  },
  {
    "text": "works uh it would be fair to say that i was quite disappointed when i saw",
    "start": "607120",
    "end": "614000"
  },
  {
    "text": "nothing unusual in traffic so as a normal transaction uh with this",
    "start": "614000",
    "end": "619920"
  },
  {
    "text": "normal card you have a wake up wake up call that is sent by the nfc reader",
    "start": "619920",
    "end": "626079"
  },
  {
    "text": "and if that activates the nfc field then you get the anti-collision",
    "start": "626079",
    "end": "631519"
  },
  {
    "text": "information exchange and then you will get the first paypass or pay wave request which is",
    "start": "631519",
    "end": "637519"
  },
  {
    "text": "called apdu request but the problem is that if you're trying to",
    "start": "637519",
    "end": "643760"
  },
  {
    "text": "send wake up nfc command using a normal nc reader unlocked iphone",
    "start": "643760",
    "end": "650640"
  },
  {
    "text": "you can't get anything back so i was expecting some other additional",
    "start": "650640",
    "end": "656320"
  },
  {
    "text": "information being exchanged and sniffed but i didn't see anything after a while i became a little bit",
    "start": "656320",
    "end": "663120"
  },
  {
    "text": "paranoid had some odd ideas how they may i don't know use gps data or some other",
    "start": "663120",
    "end": "670399"
  },
  {
    "text": "say channel information uh being exchanged in order to activate nfc fields",
    "start": "670399",
    "end": "676880"
  },
  {
    "text": "uh but i didn't find anything like that after months of unsuccessful journeys to",
    "start": "676880",
    "end": "683920"
  },
  {
    "start": "680000",
    "end": "860000"
  },
  {
    "text": "london underground uh considerations of buying a tfl reader",
    "start": "683920",
    "end": "689120"
  },
  {
    "text": "myself digging all over the internet about how transport reader works how",
    "start": "689120",
    "end": "694480"
  },
  {
    "text": "apple transit works apple valley additional services which is the uh",
    "start": "694480",
    "end": "701200"
  },
  {
    "text": "the main idea of uh these additional features on apple pay uh i",
    "start": "701200",
    "end": "707920"
  },
  {
    "text": "finally got announcement that samsung had introduced their own transport scheme and i was thinking well okay",
    "start": "707920",
    "end": "714000"
  },
  {
    "text": "that's another chance then uh it turned out quickly that even if",
    "start": "714000",
    "end": "720320"
  },
  {
    "text": "samsung pay phone is locked nfc fields still always work",
    "start": "720320",
    "end": "725600"
  },
  {
    "text": "and interacts with just a regular nfc reader so i was very excited to check",
    "start": "725600",
    "end": "732160"
  },
  {
    "text": "and look how exactly they ensure that payment is made in public transport",
    "start": "732160",
    "end": "738639"
  },
  {
    "text": "so this is an example of a cryptogram request for visa transcript card on the locked",
    "start": "738639",
    "end": "744800"
  },
  {
    "text": "samsung phone you have the generate application cryptogram header",
    "start": "744800",
    "end": "750320"
  },
  {
    "text": "uh then you have a terminal transaction qualifiers that indicate that offline",
    "start": "750320",
    "end": "755519"
  },
  {
    "text": "data authentication is required you see uh",
    "start": "755519",
    "end": "760959"
  },
  {
    "text": "terminals do not authorize transactions online instead because it will take much longer time and that will create a",
    "start": "761440",
    "end": "768399"
  },
  {
    "text": "massive backlog for people who are trying to get into underground",
    "start": "768399",
    "end": "773839"
  },
  {
    "text": "instead of that they're using offline data authentication to ensure that the card is genuine and doing online",
    "start": "773839",
    "end": "781040"
  },
  {
    "text": "authorization with a slight delay that's why you don't get notifications that you spend money immediately",
    "start": "781040",
    "end": "788480"
  },
  {
    "text": "then you have the merchant name and location in the request that indicates that this is",
    "start": "788480",
    "end": "794480"
  },
  {
    "text": "that was done in monster on the bond street station then you have additional fields amount",
    "start": "794480",
    "end": "800880"
  },
  {
    "text": "currency dates on so on and the amount here is zero so at the beginning",
    "start": "800880",
    "end": "806000"
  },
  {
    "text": "uh nfc leader nfc terminal on london underground tries to authorize you with",
    "start": "806000",
    "end": "811519"
  },
  {
    "text": "zero pounds or zero whatever and in back uh phone will provide a",
    "start": "811519",
    "end": "819760"
  },
  {
    "text": "cryptogram type indicating that this is an online cryptogram aopc application transaction counter",
    "start": "819760",
    "end": "826639"
  },
  {
    "text": "card verification results uh which is sort of risk management uh results from",
    "start": "826639",
    "end": "832720"
  },
  {
    "text": "the card side will also indicate that this is uh rqc",
    "start": "832720",
    "end": "838000"
  },
  {
    "text": "cryptogram was returned and the cryptograph itself so the payment cryptogram as i said already it's a 3ds",
    "start": "838000",
    "end": "846959"
  },
  {
    "text": "digital uh signature of all essential fields like amount",
    "start": "846959",
    "end": "853839"
  },
  {
    "text": "currency application transaction counter cvr and so on",
    "start": "853839",
    "end": "860399"
  },
  {
    "text": "uh the question was can i use this stolen",
    "start": "860399",
    "end": "865680"
  },
  {
    "text": "locked samsung phone with transport visa card to buy for example products in",
    "start": "865680",
    "end": "872320"
  },
  {
    "text": "mcdonald's and the answer unfortunately was no",
    "start": "872320",
    "end": "877760"
  },
  {
    "text": "you see if ttq does not require offline authentication or amount is not equal to zero",
    "start": "877760",
    "end": "886079"
  },
  {
    "text": "uh samsung phone will respond with 6985 which stands for conditions of use not",
    "start": "886079",
    "end": "892720"
  },
  {
    "text": "satisfied that's why you can't go and buy something from mcdonald's",
    "start": "892720",
    "end": "899440"
  },
  {
    "text": "because the price will not be zero okay uh what if mastercard is a default",
    "start": "899440",
    "end": "905440"
  },
  {
    "text": "transport card then uh same request generate ac in a slightly",
    "start": "905440",
    "end": "910720"
  },
  {
    "text": "different format also indicates that cart requires an offline data",
    "start": "910720",
    "end": "916000"
  },
  {
    "text": "authentication and mastercard always requires offline data authentication among the zero instead of name of",
    "start": "916000",
    "end": "923120"
  },
  {
    "text": "merchant they provide the merchant category code which also is a subset of",
    "start": "923120",
    "end": "928480"
  },
  {
    "text": "transport for one one one and other fields amount",
    "start": "928480",
    "end": "933920"
  },
  {
    "text": "currency so on and so on and pretty much the same answer back uh",
    "start": "933920",
    "end": "941040"
  },
  {
    "text": "now what is going to happen if you will try to pay again",
    "start": "941040",
    "end": "946320"
  },
  {
    "text": "let's say mcdonald's yeah if amount is not zero or if",
    "start": "946320",
    "end": "952399"
  },
  {
    "text": "mcc merchant category code is not transferred instead of 6985",
    "start": "952399",
    "end": "959519"
  },
  {
    "text": "uh phone will provide an aec cryptogram so ac cryptogram is a decline cryptogram",
    "start": "959519",
    "end": "966160"
  },
  {
    "text": "also used for further risk management risk assessment for probably some fraud",
    "start": "966160",
    "end": "971680"
  },
  {
    "text": "or things like that uh so it's it has a different cryptogram type",
    "start": "971680",
    "end": "976880"
  },
  {
    "text": "field it has the same consecutive application transaction counter so will be the previous transaction plus one and",
    "start": "976880",
    "end": "983920"
  },
  {
    "text": "then plus one plus one and so on uh in cvr field you also will see that ac",
    "start": "983920",
    "end": "992160"
  },
  {
    "text": "cryptogram was returned which i didn't know at the beginning and the you you get the cryptogram which looks",
    "start": "992160",
    "end": "998880"
  },
  {
    "text": "pretty much the same because it's uh hmac you don't understand what is inside right",
    "start": "998880",
    "end": "1005120"
  },
  {
    "start": "1004000",
    "end": "1087000"
  },
  {
    "text": "so the question was again can i use this data to make a purchase",
    "start": "1005120",
    "end": "1010560"
  },
  {
    "text": "and i had got feeling very strong one that the answer was yes",
    "start": "1010560",
    "end": "1016160"
  },
  {
    "text": "so you see i looked at that as if",
    "start": "1016160",
    "end": "1022079"
  },
  {
    "text": "all they have done is they've changed the cryptogram type field and everything else was looking the same and that's why",
    "start": "1022079",
    "end": "1030400"
  },
  {
    "text": "uh they probably use the same hmac function from the same data",
    "start": "1030400",
    "end": "1036558"
  },
  {
    "text": "and uh create a cryptogram so all i needed to do is to change the cryptogram type from",
    "start": "1036559",
    "end": "1043120"
  },
  {
    "text": "zero zero back to eight zero online cryptogram",
    "start": "1043120",
    "end": "1048480"
  },
  {
    "text": "uh and i didn't need to change atc nothing",
    "start": "1048480",
    "end": "1054160"
  },
  {
    "text": "so i tried to do this using man in the middle attack but uh at the beginning unfortunately",
    "start": "1054160",
    "end": "1061200"
  },
  {
    "text": "transaction didn't go through because of a very simple reason any fields are modified during the",
    "start": "1061200",
    "end": "1067360"
  },
  {
    "text": "communication between mastercard wallet or cart and a terminal transaction will",
    "start": "1067360",
    "end": "1072400"
  },
  {
    "text": "be declined because of offline data authentication checks to check all the fields that were exchanged using the",
    "start": "1072400",
    "end": "1080559"
  },
  {
    "text": "public encryption and that's why transaction is cancelled on",
    "start": "1080559",
    "end": "1086320"
  },
  {
    "text": "the terminal and here one very good research helped me out",
    "start": "1086320",
    "end": "1092240"
  },
  {
    "start": "1087000",
    "end": "1198000"
  },
  {
    "text": "in 2020 researchers from the eth university in zurich had shown how",
    "start": "1092240",
    "end": "1099120"
  },
  {
    "text": "mastercard cards can pretend to be visa cards and therefore bypass mandatory",
    "start": "1099120",
    "end": "1105520"
  },
  {
    "text": "offline data authentication because for visa cards it's not mandatory in most of the terminals",
    "start": "1105520",
    "end": "1112240"
  },
  {
    "text": "so this is how the attack looks in the end so step one you need to pretend to be a",
    "start": "1112240",
    "end": "1119200"
  },
  {
    "text": "visa wallet for the terminal using cardboard mix-up attack then you're requesting a payment",
    "start": "1119200",
    "end": "1125360"
  },
  {
    "text": "cryptogram from the locked samsung phone uh getting an ac cryptogram back and you",
    "start": "1125360",
    "end": "1130960"
  },
  {
    "text": "replace the cryptogram type field from ac to aiqc online cryptogram and presenting the ac",
    "start": "1130960",
    "end": "1138640"
  },
  {
    "text": "cryptogram cvr fields that will confirm that this is ac to the terminal than to acquire an",
    "start": "1138640",
    "end": "1145600"
  },
  {
    "text": "emission bank to the tokenization in fact and cryptogram this type of cryptogram",
    "start": "1145600",
    "end": "1152720"
  },
  {
    "text": "surprisingly will be accepted on mastercard tokenization service which is called mds",
    "start": "1152720",
    "end": "1159600"
  },
  {
    "text": "so this is a video we have a phone samsung phone we have a reader and our men in the middle configuration",
    "start": "1159600",
    "end": "1168000"
  },
  {
    "text": "so we are trying to make a payment and you see cc that uh phone syncs",
    "start": "1168000",
    "end": "1175280"
  },
  {
    "text": "that payment actually didn't go through however",
    "start": "1175280",
    "end": "1180559"
  },
  {
    "text": "it did go through and",
    "start": "1180559",
    "end": "1184480"
  },
  {
    "text": "you also see that terminal thinks that this is a visa card because of the",
    "start": "1186799",
    "end": "1193039"
  },
  {
    "text": "carbon mix up attack but in fact it is a master character",
    "start": "1193039",
    "end": "1198880"
  },
  {
    "start": "1198000",
    "end": "1329000"
  },
  {
    "text": "so now the remaining question was is there any other way i could actually attack",
    "start": "1198960",
    "end": "1206000"
  },
  {
    "text": "visa cards so the answer is yes let's see in details",
    "start": "1206000",
    "end": "1212480"
  },
  {
    "text": "what exact information terminal sends to the bank during the authorization request so the payment terminal sends",
    "start": "1212480",
    "end": "1219280"
  },
  {
    "text": "the characterization request that it described in iso 8583",
    "start": "1219280",
    "end": "1224480"
  },
  {
    "text": "and where it presents the card number masked card number amount attractive",
    "start": "1224480",
    "end": "1229600"
  },
  {
    "text": "equivalent also masked and if you're talking about emv transactions",
    "start": "1229600",
    "end": "1234720"
  },
  {
    "text": "or nfc transactions it will have an additional field which is called field 55 where it contains all",
    "start": "1234720",
    "end": "1241280"
  },
  {
    "text": "uh tags and values that terminal and card exchange",
    "start": "1241280",
    "end": "1246400"
  },
  {
    "text": "in a one big chunk so you see here that you have a mount in",
    "start": "1246400",
    "end": "1251840"
  },
  {
    "text": "two places so first place in this field zero two where",
    "start": "1251840",
    "end": "1256880"
  },
  {
    "text": "terminal asks how much exactly money should be charged and the second is in",
    "start": "1256880",
    "end": "1263919"
  },
  {
    "text": "field 55 which shown what exact amount cryptogram has signed",
    "start": "1263919",
    "end": "1271360"
  },
  {
    "text": "and if you have the access to these iso fields which is called transaction stream fraud you can basically put one",
    "start": "1271360",
    "end": "1278480"
  },
  {
    "text": "amount in the actual charge field zero two but in the icc data field still will be",
    "start": "1278480",
    "end": "1286080"
  },
  {
    "text": "zero and it'll still be work so this is how attack against visa cards",
    "start": "1286080",
    "end": "1291200"
  },
  {
    "text": "on samsung pay looks like we are requesting and stealing a cryptogram for",
    "start": "1291200",
    "end": "1297799"
  },
  {
    "text": "0.00 from the locked samsung phone yeah then we are making an iso 8583",
    "start": "1297799",
    "end": "1305360"
  },
  {
    "text": "actualization request where we put our cryptogram from a transaction stream",
    "start": "1305360",
    "end": "1310559"
  },
  {
    "text": "uh with a different amount which is uh not zero",
    "start": "1310559",
    "end": "1316640"
  },
  {
    "text": "and even though cryptogram will be accepted on the visa",
    "start": "1316640",
    "end": "1322000"
  },
  {
    "text": "tokenization services which stands for bts and one pound will be charged from",
    "start": "1322000",
    "end": "1327760"
  },
  {
    "text": "the stone cryptogram so i was very pleased to confirm all",
    "start": "1327760",
    "end": "1332960"
  },
  {
    "text": "these findings by using a few different cards and i informed samsung about them",
    "start": "1332960",
    "end": "1339120"
  },
  {
    "text": "uh mastercard visa but after a few weeks i still had very",
    "start": "1339120",
    "end": "1344799"
  },
  {
    "text": "itchy feet and really wanted to crack on with apple pay by that time i still didn't know how to",
    "start": "1344799",
    "end": "1351919"
  },
  {
    "text": "activate nfc field on the phone on the iphone so the only type of terminals",
    "start": "1351919",
    "end": "1357440"
  },
  {
    "text": "that work for me were located in london underground that's why i had to travel a lot and i",
    "start": "1357440",
    "end": "1364720"
  },
  {
    "text": "realized that i could actually apply the same scenario as shown",
    "start": "1364720",
    "end": "1370960"
  },
  {
    "text": "this visa card on samsung pay with modification on point of sales uh again apple against",
    "start": "1370960",
    "end": "1378400"
  },
  {
    "text": "apple pay so all i need to do is to steal zero pound cryptogram from apple",
    "start": "1378400",
    "end": "1383760"
  },
  {
    "text": "pay when i type an iphone in london underground and then put it in the transaction stream",
    "start": "1383760",
    "end": "1388960"
  },
  {
    "text": "at home and i figured out how exactly to do that",
    "start": "1388960",
    "end": "1394240"
  },
  {
    "text": "so id is quite simple i took proxmark and i tried to pay with",
    "start": "1394240",
    "end": "1400320"
  },
  {
    "text": "my locked iphone and then pull out the phone in the very last second before transaction will be",
    "start": "1400320",
    "end": "1407039"
  },
  {
    "text": "finished and the purchase will be authorized so as as you know it took",
    "start": "1407039",
    "end": "1412240"
  },
  {
    "text": "sometimes quite a while to hold the phone around the london underground",
    "start": "1412240",
    "end": "1417679"
  },
  {
    "text": "tab uh in the c reader and uh",
    "start": "1417679",
    "end": "1423360"
  },
  {
    "text": "so the idea is to steal the transaction before the all the exchange will be finished and",
    "start": "1423360",
    "end": "1430080"
  },
  {
    "text": "sniff this transaction and reuse it later so you see visa cards normally exchange a lot of information after the",
    "start": "1430080",
    "end": "1437440"
  },
  {
    "text": "transaction cryptogram has been presented when mastercard cards normally present",
    "start": "1437440",
    "end": "1443600"
  },
  {
    "text": "all the data before and cryptogram right at the end so if i would be able to intercept the",
    "start": "1443600",
    "end": "1449600"
  },
  {
    "text": "cryptogram but the payment not go through i could take this cryptogram put it in",
    "start": "1449600",
    "end": "1455520"
  },
  {
    "text": "transaction stream modify the amount and reuse this cryptograph and see if transaction will be",
    "start": "1455520",
    "end": "1461840"
  },
  {
    "text": "accepted or not after a few more trips to one underground that",
    "start": "1461840",
    "end": "1467440"
  },
  {
    "start": "1463000",
    "end": "1534000"
  },
  {
    "text": "worked out so i was pleased again but after that i really got into quite a",
    "start": "1467440",
    "end": "1475120"
  },
  {
    "text": "desperation phase i urgently needed to understand how to activate transport",
    "start": "1475120",
    "end": "1482000"
  },
  {
    "text": "mode on iphones so i had a few options there i",
    "start": "1482000",
    "end": "1487520"
  },
  {
    "text": "was using the help of uh my colleague artem who is a reverse engineer",
    "start": "1487520",
    "end": "1493600"
  },
  {
    "text": "and uh i used the help of alexi salson",
    "start": "1493600",
    "end": "1499279"
  },
  {
    "text": "ex colleague we made a lot of research together who is a hardware engineer",
    "start": "1499279",
    "end": "1505279"
  },
  {
    "text": "and artem was trying to implement some hooks into jailbroken i",
    "start": "1505279",
    "end": "1511840"
  },
  {
    "text": "was trying to reverse engineer the apple pay binaries",
    "start": "1511840",
    "end": "1517039"
  },
  {
    "text": "when alex simply recommended me to use hydra nfc instead of proxmog",
    "start": "1517039",
    "end": "1523919"
  },
  {
    "text": "so surprisingly it turns out that proxmark is a little bit raw product for some features where",
    "start": "1523919",
    "end": "1531520"
  },
  {
    "text": "hydra and c is more substantial and hydrogen c actually had shown",
    "start": "1531520",
    "end": "1537360"
  },
  {
    "start": "1534000",
    "end": "1645000"
  },
  {
    "text": "something to me so before the first wake up call i started seeing these short 15 bytes",
    "start": "1537360",
    "end": "1545840"
  },
  {
    "text": "stream in fact by that time i was thinking that",
    "start": "1545840",
    "end": "1552080"
  },
  {
    "text": "apple will use something like really additional services apple was that uses public key exchange so i was",
    "start": "1553360",
    "end": "1560720"
  },
  {
    "text": "expecting some really really long strings with public keys and things like that and i could not expect that only",
    "start": "1560720",
    "end": "1567279"
  },
  {
    "text": "one short 15 byte stream could do this magic uh but i tried a few times to",
    "start": "1567279",
    "end": "1572960"
  },
  {
    "text": "replay this uh special stream and and guess what so you see the iphone is even",
    "start": "1572960",
    "end": "1580640"
  },
  {
    "text": "dead yeah and it has you even have a notification that you",
    "start": "1580640",
    "end": "1587279"
  },
  {
    "text": "still can use transport cards even the iphone is uncharged",
    "start": "1587279",
    "end": "1593440"
  },
  {
    "text": "and here you go the card is red from the",
    "start": "1593520",
    "end": "1598760"
  },
  {
    "text": "[Music] uncharted iphone",
    "start": "1598760",
    "end": "1602960"
  },
  {
    "text": "now let's look more in details what information",
    "start": "1605520",
    "end": "1610559"
  },
  {
    "text": "apple wallet requests and how does it react it feels satisfying",
    "start": "1610559",
    "end": "1616559"
  },
  {
    "text": "so amount for apple pay could be innocent which is surprised",
    "start": "1616559",
    "end": "1621600"
  },
  {
    "text": "uh maybe they are preparing for some transportation systems which don't",
    "start": "1621600",
    "end": "1626799"
  },
  {
    "text": "require transactions only for xera i don't know but",
    "start": "1626799",
    "end": "1631840"
  },
  {
    "text": "they check mcc field and it should be transferred and if mcc field is not transport uh",
    "start": "1631840",
    "end": "1640159"
  },
  {
    "text": "apple phone will respond 6986 which stands for comment not allowed",
    "start": "1640159",
    "end": "1645500"
  },
  {
    "start": "1645000",
    "end": "1802000"
  },
  {
    "text": "[Music] and by that time i we found these around june 2021",
    "start": "1645500",
    "end": "1652640"
  },
  {
    "text": "mastercard has already fixed uh",
    "start": "1652640",
    "end": "1658399"
  },
  {
    "text": "current brand mix-up attack so i was not able to do the same things and bypass",
    "start": "1659600",
    "end": "1665360"
  },
  {
    "text": "tampering of mcc codes so how attack would look",
    "start": "1665360",
    "end": "1671520"
  },
  {
    "text": "after 2021 we are requesting a cryptogram from locked apple phone yeah",
    "start": "1671520",
    "end": "1677279"
  },
  {
    "text": "for one pound two pound three pounds whatever it doesn't matter and then we use modified point of sale to",
    "start": "1677279",
    "end": "1684240"
  },
  {
    "text": "insert uh cryptogram and transaction stream fraud in transaction stream to bypass offline data authentication on",
    "start": "1684240",
    "end": "1690960"
  },
  {
    "text": "the terminal and this cryptogram again will be accepted on on the mastercard",
    "start": "1690960",
    "end": "1697200"
  },
  {
    "text": "tokenization service and that's uh as we mentioned before apple pay",
    "start": "1697200",
    "end": "1704480"
  },
  {
    "text": "doesn't check that if the amount is 0 or not and i started thinking okay then",
    "start": "1704480",
    "end": "1711600"
  },
  {
    "text": "probably that means that i would be able to pay these visa cards uh so",
    "start": "1711600",
    "end": "1717200"
  },
  {
    "text": "again visa requires uh offline authentication which is still doesn't matter because the cryptogram is",
    "start": "1717200",
    "end": "1723600"
  },
  {
    "text": "presented in the plain text amount could be anything and then back it will return",
    "start": "1723600",
    "end": "1728880"
  },
  {
    "text": "an additional normal arpc cryptogram with uh everything will be working as normal so",
    "start": "1728880",
    "end": "1737440"
  },
  {
    "text": "this is an example of gamma i've recorded what around june",
    "start": "1737440",
    "end": "1742480"
  },
  {
    "text": "we have the latest iphone with the latest operating system reader on payment for one pound and",
    "start": "1742480",
    "end": "1752799"
  },
  {
    "text": "our men in the middle device sends this 15 byte string right before",
    "start": "1752799",
    "end": "1759039"
  },
  {
    "text": "trying to create a bridge between the terminal and the phone",
    "start": "1759039",
    "end": "1766440"
  },
  {
    "text": "so",
    "start": "1772559",
    "end": "1775559"
  },
  {
    "text": "and here you go card is activated transaction been completed purchase",
    "start": "1788320",
    "end": "1797039"
  },
  {
    "text": "been successful",
    "start": "1797039",
    "end": "1800000"
  },
  {
    "start": "1802000",
    "end": "1982000"
  },
  {
    "text": "so this is our detective story and like in every detective story we had",
    "start": "1802880",
    "end": "1808240"
  },
  {
    "text": "suspects we had some mystery and we had even some unsolved questions",
    "start": "1808240",
    "end": "1813919"
  },
  {
    "text": "so mystery here was how to make payments unlocked and lost apple or samsung",
    "start": "1813919",
    "end": "1820159"
  },
  {
    "text": "phones using apple or samsung paid and prime suspects here were obviously",
    "start": "1820159",
    "end": "1826240"
  },
  {
    "text": "apple samsung visa and mastercard and we can download our own technical",
    "start": "1826240",
    "end": "1832240"
  },
  {
    "text": "expertise that had shown how is it possible to conduct such crime",
    "start": "1832240",
    "end": "1837840"
  },
  {
    "text": "but more interesting is how to avoid that so what mobile wallet vendors and card",
    "start": "1837840",
    "end": "1844480"
  },
  {
    "text": "systems have done wrong main problem here is inconsistency as you can see",
    "start": "1844480",
    "end": "1850799"
  },
  {
    "text": "mobile phone presents an ac cryptogram for uh declining where uh",
    "start": "1850799",
    "end": "1856399"
  },
  {
    "text": "these and mastercard accepts ac cryptogram as an online cryptograph and mobile vendors and card vendors",
    "start": "1856399",
    "end": "1864480"
  },
  {
    "text": "should work together and instead of that samsung and apple",
    "start": "1864480",
    "end": "1870000"
  },
  {
    "text": "they both claimed during the responsible discovery process that the problems we've sent to them are not on their side",
    "start": "1870000",
    "end": "1877200"
  },
  {
    "text": "they're lying somewhere else and passing information into this and mastercard which we never heard back from",
    "start": "1877200",
    "end": "1883760"
  },
  {
    "text": "unfortunate next cda uh the most modern form of flight data",
    "start": "1883760",
    "end": "1890559"
  },
  {
    "text": "authentication is a very powerful tool yeah a very powerful instrument allows",
    "start": "1890559",
    "end": "1897200"
  },
  {
    "text": "for in any tampering of any data we also would recommend to put mcc or",
    "start": "1897200",
    "end": "1904399"
  },
  {
    "text": "merchant name as a part of the cryptogram input i don't know why still no card brands do this",
    "start": "1904399",
    "end": "1912159"
  },
  {
    "text": "another thing is that for example mastercard puts a team verification status in the cvr",
    "start": "1912159",
    "end": "1919200"
  },
  {
    "text": "fields so if the phone is uh was unlocked they will put the pin that",
    "start": "1919200",
    "end": "1924480"
  },
  {
    "text": "offline publication has been conducted and that would mean that the purchase",
    "start": "1924480",
    "end": "1929840"
  },
  {
    "text": "can be made anywhere however if this date is not indicated that pin",
    "start": "1929840",
    "end": "1934960"
  },
  {
    "text": "verification wasn't done that means that in this case payments should be done only within the",
    "start": "1934960",
    "end": "1941519"
  },
  {
    "text": "limited merchant category codes like transport for mobile mobiles there is obviously",
    "start": "1941519",
    "end": "1948320"
  },
  {
    "text": "also some sort of mediation uh such as do not present a c cryptogram at all and",
    "start": "1948320",
    "end": "1954559"
  },
  {
    "text": "return application transaction counter equal to zero zero for",
    "start": "1954559",
    "end": "1959760"
  },
  {
    "text": "not all type of cryptograms and obviously in terms of apple it would",
    "start": "1959760",
    "end": "1966320"
  },
  {
    "text": "be really nice if they would finally implement some real secure authentication process for transport",
    "start": "1966320",
    "end": "1972480"
  },
  {
    "text": "systems like they use in apple really additional services such as public key",
    "start": "1972480",
    "end": "1978880"
  },
  {
    "text": "environment or infrastructure so",
    "start": "1978880",
    "end": "1985039"
  },
  {
    "text": "now you see a little bit whole picture from a previous slide of the whole",
    "start": "1985039",
    "end": "1990320"
  },
  {
    "text": "payment process and you see that green parts are",
    "start": "1990320",
    "end": "1995679"
  },
  {
    "text": "parts where they are responsible for money their money holders and their people or",
    "start": "1995679",
    "end": "2003519"
  },
  {
    "text": "entities who will be suffering from fraud where red parts are someone within this",
    "start": "2003519",
    "end": "2009840"
  },
  {
    "text": "process who actually could and should do something unfortunately they don't",
    "start": "2009840",
    "end": "2015679"
  },
  {
    "text": "so let's just look at the simple example someone had stolen your phone you didn't",
    "start": "2015679",
    "end": "2021039"
  },
  {
    "text": "have a chance to block the card and if anyone uh would apply",
    "start": "2021039",
    "end": "2026480"
  },
  {
    "text": "somehow findings to make purchases and store fraudulent purchases let's say buy",
    "start": "2026480",
    "end": "2032000"
  },
  {
    "text": "an expensive mobile phone in the supermarket what's going to happen yeah you'll get a notification of the",
    "start": "2032000",
    "end": "2038799"
  },
  {
    "text": "purchase call your bank block the card but after a short investigation you're",
    "start": "2038799",
    "end": "2044000"
  },
  {
    "text": "reaching bank won't even have a proof that you actually did not disclose a pin to anyone or that it was not you who",
    "start": "2044000",
    "end": "2051679"
  },
  {
    "text": "made this uh fraudulent purchase they simply can't see that the phone was not unlocked",
    "start": "2051679",
    "end": "2058878"
  },
  {
    "text": "because tokenization services normally do not pass them such a session information",
    "start": "2058879",
    "end": "2064720"
  },
  {
    "text": "yeah now obviously mobile vendors would claim that it's simply impossible to pay using log devices",
    "start": "2064720",
    "end": "2071280"
  },
  {
    "text": "and they generally trying to stay away from payment data and they would be like okay",
    "start": "2071280",
    "end": "2077839"
  },
  {
    "text": "you need to speak to your issuing ban this is none of our business yeah and at",
    "start": "2077839",
    "end": "2082960"
  },
  {
    "text": "the end they all probably will say that you should block card system if you've realized that your phone is lost",
    "start": "2082960",
    "end": "2091760"
  },
  {
    "start": "2090000",
    "end": "2208000"
  },
  {
    "text": "so our statistics shown when we tested eight different mastercard cards that",
    "start": "2091760",
    "end": "2096878"
  },
  {
    "text": "four vulnerable to this uh type of attacks two were able to",
    "start": "2096879",
    "end": "2103040"
  },
  {
    "text": "uh even we were able to make purchases in any uh terminals with two of them two",
    "start": "2103040",
    "end": "2108960"
  },
  {
    "text": "other required uh modified uh terminals means that cryptogram",
    "start": "2108960",
    "end": "2114000"
  },
  {
    "text": "should be put directly in in a transaction stream surprisingly",
    "start": "2114000",
    "end": "2119119"
  },
  {
    "text": "none of russian cars that we've tested mastercard cars were not vulnerable that",
    "start": "2119119",
    "end": "2124720"
  },
  {
    "text": "means that different countries have different rules on their master characterization service",
    "start": "2124720",
    "end": "2131119"
  },
  {
    "text": "where visa cards vulnerable from all regions that we've seen",
    "start": "2131119",
    "end": "2138400"
  },
  {
    "text": "we also tested apple pay card samsung pay and additional vulnerabilities that",
    "start": "2138560",
    "end": "2144079"
  },
  {
    "text": "we found on g-pay against mastercard cards you can look at",
    "start": "2144079",
    "end": "2149680"
  },
  {
    "text": "these findings in our weight paper and unfortunately none of vendors",
    "start": "2149680",
    "end": "2155359"
  },
  {
    "text": "we reached out never got back to us with anything promising so they were either",
    "start": "2155359",
    "end": "2160480"
  },
  {
    "text": "playing competitive trying to shift responsibility one to each other or didn't come back to us at all",
    "start": "2160480",
    "end": "2167920"
  },
  {
    "text": "so thanks for everyone who especially who helped me with this project with the submission with slides with",
    "start": "2167920",
    "end": "2174640"
  },
  {
    "text": "preparations you are awesome guys uh download the white paper from",
    "start": "2174640",
    "end": "2180280"
  },
  {
    "text": "paymentvillage.org you can find more statistics all the technical details all",
    "start": "2180280",
    "end": "2185440"
  },
  {
    "text": "the information against g-pay we will find out what crypt atc stands for",
    "start": "2185440",
    "end": "2191119"
  },
  {
    "text": "wyoming stripe still working on every gpa mastercard cards and so on thanks so",
    "start": "2191119",
    "end": "2196320"
  },
  {
    "text": "much [Music]",
    "start": "2196320",
    "end": "2207729"
  },
  {
    "text": "you",
    "start": "2208240",
    "end": "2210320"
  }
]