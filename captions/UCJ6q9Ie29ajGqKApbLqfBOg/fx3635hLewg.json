[
  {
    "start": "0",
    "end": "65000"
  },
  {
    "text": "thank you everyone for coming appreciate having you here so we're here today to talk about a tool that we created called",
    "start": "30",
    "end": "7350"
  },
  {
    "text": "caldera that automates adversary emulation so I'll introduce what that means in just a minute but first I want",
    "start": "7350",
    "end": "15059"
  },
  {
    "text": "to tell you about who we are so my name is Douglas Miller I'm a researcher at a",
    "start": "15059",
    "end": "20279"
  },
  {
    "text": "company called mitre that runs research and development centers for the United States government",
    "start": "20279",
    "end": "26460"
  },
  {
    "text": "I'm a senior cyber security engineer so if you've heard of attack that's ATT",
    "start": "26460",
    "end": "31560"
  },
  {
    "text": "ampersand CK that's a threat repository that we made at mitre I worked on that I",
    "start": "31560",
    "end": "38280"
  },
  {
    "text": "also do a bunch of applied red teaming in my day job as well and I'll let my",
    "start": "38280",
    "end": "43500"
  },
  {
    "text": "colleague Andy introduce himself sounds",
    "start": "43500",
    "end": "53430"
  },
  {
    "text": "like it okay my name is Andy I also work at mitre I work on attack as well and",
    "start": "53430",
    "end": "59100"
  },
  {
    "text": "also some AI research really bad at bios okay so with that of the way what is",
    "start": "59100",
    "end": "67290"
  },
  {
    "start": "65000",
    "end": "523000"
  },
  {
    "text": "ever star emulation so I it's a term that we use within mitre but I didn't",
    "start": "67290",
    "end": "73799"
  },
  {
    "text": "know if it's a term that other people understand and Google tells us that pretty much nobody uses that term so I'm",
    "start": "73799",
    "end": "80790"
  },
  {
    "text": "gonna tell you what it means but first I want to introduce you to the problem that we're trying to solve and basically",
    "start": "80790",
    "end": "87840"
  },
  {
    "text": "the problem is the false negative problem so if you're if you're like me you're thinking false and negative and",
    "start": "87840",
    "end": "94680"
  },
  {
    "text": "like going through the mental math of like true positive okay false positive false negative false negative let me",
    "start": "94680",
    "end": "100890"
  },
  {
    "text": "help you out a false negative is the stuff that you should have detected but didn't so as a",
    "start": "100890",
    "end": "107130"
  },
  {
    "text": "network defender this is like the stuff that bad guys do that you have no visibility over and the idea here is you",
    "start": "107130",
    "end": "115110"
  },
  {
    "text": "want to detect that stuff right and I mean so let's like quick show of hands",
    "start": "115110",
    "end": "120350"
  },
  {
    "text": "who here is confident that they can detect every single attack possible",
    "start": "120350",
    "end": "125790"
  },
  {
    "text": "against their network I mean it's a sonoda raise their hands right and I",
    "start": "125790",
    "end": "130979"
  },
  {
    "text": "mean if someone did raise their hand I would want whatever doing because you know because that's",
    "start": "130979",
    "end": "137370"
  },
  {
    "text": "kind of like the panacea right I mean everyone knows we're vulnerable so if",
    "start": "137370",
    "end": "142409"
  },
  {
    "text": "you think about like other domains you know not just cyber this is somewhat of",
    "start": "142409",
    "end": "147569"
  },
  {
    "text": "a solved problem so in a in a previous life I worked at an electronics company and they have a big lab in at the",
    "start": "147569",
    "end": "156810"
  },
  {
    "text": "company I used to work at dedicated to just stress testing devices you know so they'd have a machine that just pressed",
    "start": "156810",
    "end": "162840"
  },
  {
    "text": "a button millions of times to see how long it would take for that button to fail and most organizations don't really",
    "start": "162840",
    "end": "171599"
  },
  {
    "text": "do that I mean it's a hard problem cyber is much more complicated than just pressing a button but this is the best",
    "start": "171599",
    "end": "177540"
  },
  {
    "text": "way to tell if you know you're safe by testing your network and that's the idea",
    "start": "177540",
    "end": "183780"
  },
  {
    "text": "behind adversary emulation so you introduce a realistic adversary so it's",
    "start": "183780",
    "end": "189450"
  },
  {
    "text": "something as real as you can make it onto your network and see how far the attacker gets ideally you know you",
    "start": "189450",
    "end": "196650"
  },
  {
    "text": "control the adversary you'll want to take a real adversary and put it on your network but you can hire much really",
    "start": "196650",
    "end": "203400"
  },
  {
    "text": "smart keyless to do it or use it to a light caldera and think about this for a",
    "start": "203400",
    "end": "209069"
  },
  {
    "text": "second so if you have an adversary you can actually see you know how far did the adversary get did they were they",
    "start": "209069",
    "end": "215190"
  },
  {
    "text": "able to move from my endpoint workstations to you know my my like core Enclave did I detect them did I not",
    "start": "215190",
    "end": "222569"
  },
  {
    "text": "detect them and then you can sort of you know peel back the curtains and think about what mitigations you could put in",
    "start": "222569",
    "end": "228299"
  },
  {
    "text": "place how can I prevent this in the future and how can I prove my detection",
    "start": "228299",
    "end": "234530"
  },
  {
    "text": "so this idea kind of works in a cycle so",
    "start": "234530",
    "end": "240840"
  },
  {
    "text": "it's not good enough to just do this once I mean it's like it's like any other thing it's like penetration testing it's like vulnerable scanning",
    "start": "240840",
    "end": "246329"
  },
  {
    "text": "you can't just do this one so you have to keep doing it over and over again so you start by emulating the adversary",
    "start": "246329",
    "end": "252120"
  },
  {
    "text": "right and then you kind of do some inspection so did it did we succeed did we detect how can we improve and then",
    "start": "252120",
    "end": "258389"
  },
  {
    "text": "you go back and you think about what changes you can make to improve your network and so Caldera the tool really",
    "start": "258389",
    "end": "265979"
  },
  {
    "text": "sits is just piece of this puzzle the rest of this is something that you have to do as you",
    "start": "265979",
    "end": "271729"
  },
  {
    "text": "know as a human as a network defender so there are a couple of key pieces to",
    "start": "271729",
    "end": "277909"
  },
  {
    "text": "making adversary emulation work and I already talked about a few of them but you really need to make it as realistic",
    "start": "277909",
    "end": "283219"
  },
  {
    "text": "as possible you want the adversary to be like a real adversary and this is different from a lot of other testing",
    "start": "283219",
    "end": "289849"
  },
  {
    "text": "mechanisms so you think about vulnerability scanning you think about penetration testing even red teaming if",
    "start": "289849",
    "end": "296389"
  },
  {
    "text": "any of you are familiar with that this you know red teaming for example you're",
    "start": "296389",
    "end": "302090"
  },
  {
    "text": "really looking at trying not to get caught so if you're a red team you don't want the blue team to catch you that's",
    "start": "302090",
    "end": "307370"
  },
  {
    "text": "not what ever sorry emulation is if the blue team catches you that means you good job for the blue",
    "start": "307370",
    "end": "312830"
  },
  {
    "text": "team what's important is you want to be real you want to use the same techniques you want to use the same tactics you're",
    "start": "312830",
    "end": "318349"
  },
  {
    "text": "going to use the same tools as what attackers are going to use on your network against your organization you",
    "start": "318349",
    "end": "324529"
  },
  {
    "text": "want to be end-to-end and this is a big one so this really differentiates it from something like pen testing where",
    "start": "324529",
    "end": "329689"
  },
  {
    "text": "you're really just looking for those perimeter holes in your network with an end-to-end adversary emulation you get",
    "start": "329689",
    "end": "335180"
  },
  {
    "text": "in and that's just to start you want to go all the way towards you know whatever the full compromise is for",
    "start": "335180",
    "end": "340550"
  },
  {
    "text": "your network so compromising the domain controller getting domain admin exfilling the critical data off your",
    "start": "340550",
    "end": "347270"
  },
  {
    "text": "network that's where you want to stop you want to do the whole spectrum and you want to be repeatable so you don't",
    "start": "347270",
    "end": "353120"
  },
  {
    "text": "want to just do this once you want to be able to do it multiple times and measure the improvement and your security",
    "start": "353120",
    "end": "358219"
  },
  {
    "text": "posture as you implement mitigations and you know try to improve your security so",
    "start": "358219",
    "end": "365180"
  },
  {
    "text": "this is the tool it's it actually exists I know I've been kind of talking high-level and introducing the concepts",
    "start": "365180",
    "end": "370789"
  },
  {
    "text": "but I want you to at least have a mental picture for what we did while we're talking about it so this is the",
    "start": "370789",
    "end": "378259"
  },
  {
    "text": "operation screen this is kind of like the core piece of how it works so there's there's a lot going on here",
    "start": "378259",
    "end": "384020"
  },
  {
    "text": "and well we'll dive into it but you have a picture of your network the box the",
    "start": "384020",
    "end": "389509"
  },
  {
    "text": "bubbles here are the different computers that are taking part in the exercise and then you've got kind of a running screen",
    "start": "389509",
    "end": "394969"
  },
  {
    "text": "on the right-hand side of everything that the system is doing all the steps that is taking",
    "start": "394969",
    "end": "401050"
  },
  {
    "text": "so kind of an overview of how the tool works so the first thing to do is you install a small service shim on every",
    "start": "401060",
    "end": "407420"
  },
  {
    "text": "computer that you're going to be using to participate so this is just a small Windows program the system itself is",
    "start": "407420",
    "end": "414620"
  },
  {
    "text": "window specific so unlike you know you learn in university most of the world",
    "start": "414620",
    "end": "420020"
  },
  {
    "text": "still runs on Windows sadly or not sadly but so it is window specific you install",
    "start": "420020",
    "end": "427760"
  },
  {
    "text": "the service shim you create an adversary by giving it capabilities so these are things like Pradesh WMI lateral movement",
    "start": "427760",
    "end": "436360"
  },
  {
    "text": "exfil and then you just basically click go and the system knows how to compose",
    "start": "436360",
    "end": "443600"
  },
  {
    "text": "the pieces together that you tell it to do so while the system is running it'll tell you what's going on it will say",
    "start": "443600",
    "end": "449870"
  },
  {
    "text": "well what it's doing and afterwards it'll kind of show you an overview of what happened and it does have a cleanup",
    "start": "449870",
    "end": "455660"
  },
  {
    "text": "function so anything that happens in the network files that are dropped processes that are created services that are",
    "start": "455660",
    "end": "460730"
  },
  {
    "text": "created all that stuff gets cleaned up you know most people want that so so",
    "start": "460730",
    "end": "467900"
  },
  {
    "text": "they're kind of three key components to designing a system that automates ever",
    "start": "467900",
    "end": "473690"
  },
  {
    "text": "stimulation and the first one is what the adversary is able to do for the feature set that the adversary has and",
    "start": "473690",
    "end": "480230"
  },
  {
    "text": "the the thing that we used is something that we also created called attack so of course we use it but it is actually a",
    "start": "480230",
    "end": "486800"
  },
  {
    "text": "really good model and II will talk about this in a minute we also so the another piece of it it's not just what the",
    "start": "486800",
    "end": "493400"
  },
  {
    "text": "adversary can do but how it can do it so the choices that the adversary makes and this is a really interesting really fun",
    "start": "493400",
    "end": "499820"
  },
  {
    "text": "problem that we worked on and the last part is sort of all the extra stuff so all the glue you know the stuff that",
    "start": "499820",
    "end": "506840"
  },
  {
    "text": "parses command line output all that fun stuff so we did all three of these things and we'll talk about them in detail oops so with that I'm gonna hand",
    "start": "506840",
    "end": "518180"
  },
  {
    "text": "it off to my colleague Andy for the adversary model and hear me oh cool",
    "start": "518180",
    "end": "526310"
  },
  {
    "start": "523000",
    "end": "648000"
  },
  {
    "text": "thanks Doug yes I'm gonna talk a bit about the adversary model first we were designing caldera we you know we we see",
    "start": "526310",
    "end": "533270"
  },
  {
    "text": "long-term like red teaming pentest things like using exploits or vulnerabilities and configuration",
    "start": "533270",
    "end": "538610"
  },
  {
    "text": "simulations all very useful tools but when we were designing caldera we didn't necessarily want to go that route we",
    "start": "538610",
    "end": "545060"
  },
  {
    "text": "wanted to focus on adversary emulation and using a what kind of showing what a real adversary would do after they get",
    "start": "545060",
    "end": "550970"
  },
  {
    "text": "into your network really focusing on that post compromised aspect so this led",
    "start": "550970",
    "end": "556100"
  },
  {
    "text": "us to use the mitre attack framework I'm not going to go through it in detail but it's essentially a higher fidelity model",
    "start": "556100",
    "end": "563780"
  },
  {
    "text": "that focuses on kind of what the adversary does after they exploit them they get into your network News reporter",
    "start": "563780",
    "end": "570380"
  },
  {
    "text": "doesn't really work but it's all publicly available online attacked at mitre org it's awesome I recommend it for it almost almost everything but we",
    "start": "570380",
    "end": "578960"
  },
  {
    "text": "basically taken the right of exploit kill chain phases and broken them down into ten high-level adversary tactical",
    "start": "578960",
    "end": "585140"
  },
  {
    "text": "goals see persistence privilege escalation defensive age and lateral movement execration all those kind of",
    "start": "585140",
    "end": "591230"
  },
  {
    "text": "normal things you read about you know adversaries doing and then we enumerate the techniques that are available to the",
    "start": "591230",
    "end": "596930"
  },
  {
    "text": "adversary to achieve those tactical goals so as an example if you look second from the bottom upper left hand",
    "start": "596930",
    "end": "602900"
  },
  {
    "text": "corner legitimate credentials is a way an adversary can use to maintain persistence or privilege escalation or",
    "start": "602900",
    "end": "608420"
  },
  {
    "text": "even defense evasion one of the key features of attack is that everything in",
    "start": "608420",
    "end": "613910"
  },
  {
    "text": "the model all these techniques are backed up with real open source intelligence so we've identified",
    "start": "613910",
    "end": "619220"
  },
  {
    "text": "publicly available threat reports to say hey adversaries actually do these things these are the things that they actually",
    "start": "619220",
    "end": "625370"
  },
  {
    "text": "do that's been useful for caldera because we want to focus on that real component of emulating a real adversary",
    "start": "625370",
    "end": "631420"
  },
  {
    "text": "this is a brief enumeration of the things that are currently encoded into caldera based on attack we have",
    "start": "631420",
    "end": "638450"
  },
  {
    "text": "persistence privilege escalation defense evasion execution exfiltration discovery kind of all the kind of the main things",
    "start": "638450",
    "end": "643760"
  },
  {
    "text": "that you need to emulate that full adversary lifecycle so I'm gonna switch",
    "start": "643760",
    "end": "649970"
  },
  {
    "start": "648000",
    "end": "717000"
  },
  {
    "text": "gears a little bit and talk now about the decision-making component and when we first made caldera we took a finite",
    "start": "649970",
    "end": "656690"
  },
  {
    "text": "state machine approach where we would basically scan for hosts we would select a target it would scan the target move",
    "start": "656690",
    "end": "663620"
  },
  {
    "text": "laterally to that target and then dump credentials and this worked well was successful I went through it kind of",
    "start": "663620",
    "end": "669800"
  },
  {
    "text": "iterated through this process but there were some downsides first it was hard to add new techniques every time we wanted",
    "start": "669800",
    "end": "676220"
  },
  {
    "text": "to add something we had to fully recompute the finite state machine if I want to establish persistence where does that fit in with relationship to all the",
    "start": "676220",
    "end": "682820"
  },
  {
    "text": "other actions I have it was also very hard to configure an operation to be specific if I want to pick and choose",
    "start": "682820",
    "end": "689420"
  },
  {
    "text": "which one of these actions how do I make sure that the finite state machine that results from it actually works then the",
    "start": "689420",
    "end": "695840"
  },
  {
    "text": "other downside was it was very predictable when it was executing it would just keep running through this loop repeatedly repeatedly you can see",
    "start": "695840",
    "end": "702500"
  },
  {
    "text": "in this visualization I don't know if it renders too well on the screen but out there just kind of iterated through there over and over and over again and",
    "start": "702500",
    "end": "708980"
  },
  {
    "text": "if I'm a defender you know and I'm seeing something that might look like that it's a little easier to detect and",
    "start": "708980",
    "end": "715550"
  },
  {
    "text": "something that's doing a little bit more to blend in so we decided to go to the drawing board and consider okay how do",
    "start": "715550",
    "end": "722210"
  },
  {
    "start": "717000",
    "end": "808000"
  },
  {
    "text": "we actually design this decision-making engine and we thought to ourselves okay humans we typically have you know lots",
    "start": "722210",
    "end": "729140"
  },
  {
    "text": "of this domain knowledge domain inference and we're looking at things we're kind of guessing things what we're",
    "start": "729140",
    "end": "734570"
  },
  {
    "text": "doing targeting TTP selection all of these things you know and you know do we dump creds or do I launch an exploit",
    "start": "734570",
    "end": "740360"
  },
  {
    "text": "what's the right technique to use in this specific situation and all that stuff we we need to automate it as",
    "start": "740360",
    "end": "746750"
  },
  {
    "text": "Caldera so we came up with some requirements you know we want to make intelligent choices for adversary womp",
    "start": "746750",
    "end": "752930"
  },
  {
    "text": "we want to achieve tactical objective like an adversary does we really want to easily incorporate new techniques I",
    "start": "752930",
    "end": "758930"
  },
  {
    "text": "don't want to have to recompute a finite state machine I just want to make a new technique throw it into the system and let it go I also want to work in new and",
    "start": "758930",
    "end": "766520"
  },
  {
    "text": "unknown environments by then I mean I don't want to have to configure caldera and say okay these are the hosts that",
    "start": "766520",
    "end": "772250"
  },
  {
    "text": "are on my network these are the credentials that are on my network these are the shares I don't want to tell it any of that I want to tell caldera okay",
    "start": "772250",
    "end": "778820"
  },
  {
    "text": "Ivan you know it's installed go go have fun go go dude go go be an adversary I also want to bury the operations and",
    "start": "778820",
    "end": "785720"
  },
  {
    "text": "then finally I want to chain weaknesses from multiple for maximum effect what I",
    "start": "785720",
    "end": "790820"
  },
  {
    "text": "mean by that is I don't want to just you know pop a box I want to take a little",
    "start": "790820",
    "end": "797570"
  },
  {
    "text": "vulnerability maybe I get some creds and then I can mount a file share copy something over and then execute that remotely training",
    "start": "797570",
    "end": "804290"
  },
  {
    "text": "these little things together that create a larger attack pattern so to kind of motivate some of the things I'm going to",
    "start": "804290",
    "end": "809660"
  },
  {
    "start": "808000",
    "end": "942000"
  },
  {
    "text": "talk about I took very very toys simple example let's say you got host 1 and host 2 I've got a rat running on host 1",
    "start": "809660",
    "end": "815870"
  },
  {
    "text": "I've identified that there's some sensitive files on house 2 and I want to exfiltrate them so I might have this",
    "start": "815870",
    "end": "822800"
  },
  {
    "text": "kind of this bag of TTP is exploiting a vulnerability mounting a file share or copying a file Remote Desktop the",
    "start": "822800",
    "end": "829670"
  },
  {
    "text": "question is how do I arrange these different TTP's into my goal how do i how do i chain them together to actual",
    "start": "829670",
    "end": "836240"
  },
  {
    "text": "trait data so let's look at the specific example of an action here I want to talk",
    "start": "836240",
    "end": "841790"
  },
  {
    "text": "about copying a file from host 1 to house to what we might want to do and understanding this action is enumerate",
    "start": "841790",
    "end": "848030"
  },
  {
    "text": "what the requirements are and here in the question is well what do I need to do to copy this rat file over to the",
    "start": "848030",
    "end": "854510"
  },
  {
    "text": "other host first I need a working rat on the source host on host 1 I need a mounted file share from host 2 on the",
    "start": "854510",
    "end": "861470"
  },
  {
    "text": "house 1 and I need to write access to that file share a little more technically we might call these",
    "start": "861470",
    "end": "867050"
  },
  {
    "text": "requirements the preconditions of the specific technique then the question is what happens after I copied this rat",
    "start": "867050",
    "end": "873110"
  },
  {
    "text": "file over well there's going to be a new file on the target host and that file will contain the wrap yeah more",
    "start": "873110",
    "end": "879500"
  },
  {
    "text": "technically I might call these the post conditions and so the idea of one of the main ideas of caldera and I'll go into",
    "start": "879500",
    "end": "884750"
  },
  {
    "text": "this later again is to take these techniques and decompose them into their preconditions or their requirements and",
    "start": "884750",
    "end": "890540"
  },
  {
    "text": "their post conditions which are their consequences what's nice is I might say ok let's say my goal is over here on the right to",
    "start": "890540",
    "end": "896360"
  },
  {
    "text": "copy a file I'm gonna get that file on the target which is my goal that's what that's what I'm looking for in order to",
    "start": "896360",
    "end": "901760"
  },
  {
    "text": "execute copying a file I need a mounted amount to share oh look I can take mount",
    "start": "901760",
    "end": "906980"
  },
  {
    "text": "share is another action and the consequence of mountain mounted share is getting that mouth a share so if I mount",
    "start": "906980",
    "end": "912350"
  },
  {
    "text": "the share then I can copy a file but the mount to share I need credentials so getting back we're training it back",
    "start": "912350",
    "end": "917800"
  },
  {
    "text": "again 1 say ok if I dump credentials I'm gonna get those credentials that I needed and so to jump into this chain I",
    "start": "917800",
    "end": "924590"
  },
  {
    "text": "just need an elevated rat running on host 1 which is what I started out with again more terminology we might call",
    "start": "924590",
    "end": "932120"
  },
  {
    "text": "this sequence of actions a plant is basically just kind of these actions together Matt again we have the preconditions and",
    "start": "932120",
    "end": "938120"
  },
  {
    "text": "the post conditions that kind of make them logically flow so this is kind of",
    "start": "938120",
    "end": "943819"
  },
  {
    "text": "the core caldera idea instead of prescribing explicitly what we want the decision engine to do we're gonna move",
    "start": "943819",
    "end": "950089"
  },
  {
    "text": "towards something that's dynamic and model-based essentially we want to tag every single action all of our",
    "start": "950089",
    "end": "955399"
  },
  {
    "text": "techniques with the preconditions are the requirements and the post conditions which are the consequences of executing",
    "start": "955399",
    "end": "961160"
  },
  {
    "text": "a technique now I no longer need to explicitly tell caldera what it needs to do instead it can compare what it knows",
    "start": "961160",
    "end": "968750"
  },
  {
    "text": "about its current state to the preconditions the preconditions of its",
    "start": "968750",
    "end": "974240"
  },
  {
    "text": "available actions and then it can determine which action it should execute as an added bonus by having",
    "start": "974240",
    "end": "979610"
  },
  {
    "text": "preconditions and postconditions I can now plan for the future if I dump financials now that will help me execute",
    "start": "979610",
    "end": "985910"
  },
  {
    "text": "lateral movements sometime in the future so it's not a presentation if I don't make a forced chess analogy but in chess",
    "start": "985910",
    "end": "993290"
  },
  {
    "text": "we basically we kind of also have a little bit of preconditions and postconditions going on here from a",
    "start": "993290",
    "end": "998360"
  },
  {
    "text": "precondition perspective we we can essentially use the rules of the game",
    "start": "998360",
    "end": "1003879"
  },
  {
    "text": "basically how the pieces move as the preconditions along with the logical you know invariants of the game here we can",
    "start": "1003879",
    "end": "1010600"
  },
  {
    "text": "see how that rook is in check and that's a requirement that I have that the king has to get out of check and I can either",
    "start": "1010600",
    "end": "1016689"
  },
  {
    "text": "move my king to the right or interpose a piece in front of the room to stop the check from an emulation sense we might",
    "start": "1016689",
    "end": "1022689"
  },
  {
    "text": "say given an escalated foothold I can dump credentials I can add or modify registry keys I can set up scheduled",
    "start": "1022689",
    "end": "1028089"
  },
  {
    "text": "tasks do all sorts of fun stuff now postconditions can tell you what",
    "start": "1028089",
    "end": "1033400"
  },
  {
    "text": "happens after doing something and chess we might say okay if black moves a bishop over there and white might take",
    "start": "1033400",
    "end": "1040120"
  },
  {
    "text": "the Queen and then black will take the bishop King moves over and then the knight puts the white king in check and",
    "start": "1040120",
    "end": "1045959"
  },
  {
    "text": "black is Bobby Fischer so it's all funny games from an emulation standpoint what",
    "start": "1045959",
    "end": "1051669"
  },
  {
    "start": "1049000",
    "end": "1199000"
  },
  {
    "text": "we can essentially do is start chaining actions together towards achieving something we dump credentials and we laterally move we might add or modify",
    "start": "1051669",
    "end": "1058059"
  },
  {
    "text": "registry keys and then dump credentials we essentially construct a a search space of all the possible plans and all",
    "start": "1058059",
    "end": "1065470"
  },
  {
    "text": "the possible actions so jumping back to the running example how do i how do I go back from host 1",
    "start": "1065470",
    "end": "1072180"
  },
  {
    "text": "and host 2 well the idea is again I can chain these actions together so here's an example plan where I'm using copy",
    "start": "1072180",
    "end": "1078540"
  },
  {
    "text": "file to move laterally first I'd dump credentials then I mount the network share then I copy the file remotely",
    "start": "1078540",
    "end": "1084870"
  },
  {
    "text": "execute it and then finally now that I have code execution after the remote execution actual trade data from host to",
    "start": "1084870",
    "end": "1090590"
  },
  {
    "text": "another plan is I might want to just immediately jump jump out that jump the",
    "start": "1090590",
    "end": "1096180"
  },
  {
    "text": "gun exploit a vulnerability from 1 to 2 the next will trade data then another plan might be I'm gonna dump credentials",
    "start": "1096180",
    "end": "1102270"
  },
  {
    "text": "I'm gonna use RDP then I'm gonna excellent rate big data from host 2 so",
    "start": "1102270",
    "end": "1107370"
  },
  {
    "text": "the question is ok I could enumerate all these plans look ahead in the future find all these things that achieve my goals but which is the right plan to",
    "start": "1107370",
    "end": "1115590"
  },
  {
    "text": "execute or rather which is the first action to execute and what we did is we",
    "start": "1115590",
    "end": "1120660"
  },
  {
    "text": "designed a caldera heuristic essentially we assign each plan a score based on the",
    "start": "1120660",
    "end": "1127500"
  },
  {
    "text": "reward of the actions in that plan and that that score is kind of a sum sum or",
    "start": "1127500",
    "end": "1134490"
  },
  {
    "text": "a summation of the weighted rewards preferring to to achieve the goals earlier than later so in this example I",
    "start": "1134490",
    "end": "1141390"
  },
  {
    "text": "might say ok I love exfiltrating data that's gonna get a reward of 100 I like dumping credentials it's not bad",
    "start": "1141390",
    "end": "1148410"
  },
  {
    "text": "gonna give that a reward of 50 it's not as good as exfiltrating that data but you know those credentials might be useful in the future so that's gonna get",
    "start": "1148410",
    "end": "1154560"
  },
  {
    "text": "a 50 copying a file is fun too it's not as good as credits or exfiltration but I",
    "start": "1154560",
    "end": "1160650"
  },
  {
    "text": "might have signed that 5 and then everything else I don't really care about it those are all means to end so I'm gonna sign them all one so with that",
    "start": "1160650",
    "end": "1168060"
  },
  {
    "text": "all said plan 3 using RDP for lateral movement kind of becomes the best choice",
    "start": "1168060",
    "end": "1173580"
  },
  {
    "text": "because I'm dumping Fred's right away I'm using already P which I don't really get a reward for it but then I'm",
    "start": "1173580",
    "end": "1178710"
  },
  {
    "text": "achieving my goal you can pair that to plan number one I'm dumping creds which is good but I'm not exfiltrating data",
    "start": "1178710",
    "end": "1184680"
  },
  {
    "text": "until much further down the line I have to do a lot more things to actually get to that point then plan number 2 is",
    "start": "1184680",
    "end": "1190280"
  },
  {
    "text": "exploiting a vulnerability which isn't very worthwhile for me and then actual trading data and so when you kind of",
    "start": "1190280",
    "end": "1196350"
  },
  {
    "text": "compute all all the rewards and the scores plan 3 becomes the best so the next thing we need with caldera",
    "start": "1196350",
    "end": "1202420"
  },
  {
    "start": "1199000",
    "end": "1314000"
  },
  {
    "text": "is a data model to talk about the preconditions and postconditions it's easy for me to kind of verbalize",
    "start": "1202420",
    "end": "1208300"
  },
  {
    "text": "them and say I need this and I need that but we need a way for caldera to do this all automatically so calderas language",
    "start": "1208300",
    "end": "1214840"
  },
  {
    "text": "basically has objects and type fields where the objects reference kind of common windows things as well as other",
    "start": "1214840",
    "end": "1223420"
  },
  {
    "text": "things them are useful for for the adversary I'll give a couple examples of them and then the other thing is that",
    "start": "1223420",
    "end": "1232780"
  },
  {
    "text": "fields specify the properties of the objects and then we restrict that by type and again I think it's better to",
    "start": "1232780",
    "end": "1239440"
  },
  {
    "text": "walk through with an example so here's an example host object on the left you can see we have host that's the object",
    "start": "1239440",
    "end": "1245530"
  },
  {
    "text": "type host has eight different fields you have the fully qualified domain name which is a string you have a list of",
    "start": "1245530",
    "end": "1252310"
  },
  {
    "text": "admins that's a list of type list host name DNS DNS domain name again strings",
    "start": "1252310",
    "end": "1258490"
  },
  {
    "text": "all these different things an OS version which is just a reference to another object in the data model as an example",
    "start": "1258490",
    "end": "1264550"
  },
  {
    "text": "host we have the fully qualified domain name of PC one two three four the admins are Andy and Doug the host name is PC",
    "start": "1264550",
    "end": "1271090"
  },
  {
    "text": "one two three four and so on and so forth and this kind of breaks down the",
    "start": "1271090",
    "end": "1276550"
  },
  {
    "text": "entire model it's a little or this is the majority of the model there you can see on the bottom there's like plus",
    "start": "1276550",
    "end": "1281680"
  },
  {
    "text": "seven plus 11 but you know with the things that we have here though are kind of common",
    "start": "1281680",
    "end": "1287590"
  },
  {
    "text": "things that we tend to talk about like scheduled tasks services processes registry keys users shares files hosts",
    "start": "1287590",
    "end": "1295030"
  },
  {
    "text": "all these fun things and then with eat within each you have the fields that that caldera cares about some of these",
    "start": "1295030",
    "end": "1301840"
  },
  {
    "text": "are a little more specific for calderas execution like time delta measures the",
    "start": "1301840",
    "end": "1307000"
  },
  {
    "text": "difference the the time difference between two two hosts and we actually have an object to represent that so we",
    "start": "1307000",
    "end": "1316000"
  },
  {
    "start": "1314000",
    "end": "1390000"
  },
  {
    "text": "have a data model that's awesome now we need a syntax actually declare the actions and so caldera also has a syntax",
    "start": "1316000",
    "end": "1322150"
  },
  {
    "text": "with which we describe the preconditions and postconditions we have preconditions post conditions a not equal in variant and then pre",
    "start": "1322150",
    "end": "1329710"
  },
  {
    "text": "properties and post properties be very honest it's a little confusing we have documentation that is",
    "start": "1329710",
    "end": "1335560"
  },
  {
    "text": "available online that can describe a little bit better but I just wanted to flash real quick say that there is a",
    "start": "1335560",
    "end": "1342490"
  },
  {
    "text": "syntax it works but if you but if you're interested we have more stuff online so",
    "start": "1342490",
    "end": "1348270"
  },
  {
    "text": "bringing everything together we kind of have a five-step plan and no I vas",
    "start": "1348270",
    "end": "1355420"
  },
  {
    "text": "except listed there but we update the world state and figure out what we know what is actually true in this",
    "start": "1355420",
    "end": "1360610"
  },
  {
    "text": "environment then we use the preconditions to figure out all of our valid actions that we can execute in this current time step then we construct",
    "start": "1360610",
    "end": "1367570"
  },
  {
    "text": "plans that lead off with those actions so I again look towards the future and chaining actions together with the",
    "start": "1367570",
    "end": "1372940"
  },
  {
    "text": "preconditions and postconditions then I run the heuristic to determine the best plan out of all the plans that I",
    "start": "1372940",
    "end": "1378190"
  },
  {
    "text": "identified and I execute that first action in the best plan last I repeat",
    "start": "1378190",
    "end": "1383560"
  },
  {
    "text": "there the response is kind of jump back into this cycle and go through as I compromise the network and achieve my",
    "start": "1383560",
    "end": "1388750"
  },
  {
    "text": "goals so that's it we're done preconditions and postconditions you know we can dynamically construct plans",
    "start": "1388750",
    "end": "1394950"
  },
  {
    "start": "1390000",
    "end": "1494000"
  },
  {
    "text": "we can construct them to make intelligent choices it's easy very easy to incorporate new techniques all we",
    "start": "1394950",
    "end": "1401110"
  },
  {
    "text": "have to do define the precondition is to find the post conditions define technically what you need to execute",
    "start": "1401110",
    "end": "1406480"
  },
  {
    "text": "then you're done you just throw it in there it figures it all out it's perfect we can modify the rewards as well as the",
    "start": "1406480",
    "end": "1413320"
  },
  {
    "text": "actions we want to have in the operation and that can help us vary what we're doing we can chain weaknesses together",
    "start": "1413320",
    "end": "1418750"
  },
  {
    "text": "because we have the preconditions and the post conditions that we can function in new environments and there's an asterisk there because well that's",
    "start": "1418750",
    "end": "1425800"
  },
  {
    "text": "actually a little harder said than done it turns out doing this deterministically it's kind of hard",
    "start": "1425800",
    "end": "1431880"
  },
  {
    "text": "sometimes when I dump credentials I'm gonna get very useful credentials I might land on a box and dump credentials",
    "start": "1431880",
    "end": "1438040"
  },
  {
    "text": "I know it's a domain admin that's wonderful I'm basically done sometimes I might land on a box dump credentials and",
    "start": "1438040",
    "end": "1443500"
  },
  {
    "text": "find credentials that are completely useless so when I'm constructing plans it turns out this can be kind of",
    "start": "1443500",
    "end": "1449440"
  },
  {
    "text": "disruptive because I don't know exactly what the outcome of some of these actions might be and in reality handling",
    "start": "1449440",
    "end": "1455410"
  },
  {
    "text": "uncertainty is a very very difficult problem and we have a couple of papers that are available on some of the ideas",
    "start": "1455410",
    "end": "1461380"
  },
  {
    "text": "that we've considered some of the things that we're doing then and those are also available",
    "start": "1461380",
    "end": "1466510"
  },
  {
    "text": "if you're really interested in this I'd recommend it in this problem I'd recommend this paper by York Hoffman",
    "start": "1466510",
    "end": "1472030"
  },
  {
    "text": "which kind of decomposes this entire problem of using planning for red",
    "start": "1472030",
    "end": "1477580"
  },
  {
    "text": "teaming based on the action model which is whether or not actions can remove",
    "start": "1477580",
    "end": "1484450"
  },
  {
    "text": "information from your knowledge base wells your uncertainty model which is whether or not you can fully observe the network and we kind of lie somewhere in",
    "start": "1484450",
    "end": "1492070"
  },
  {
    "text": "the middle of there but long story short we have our own approach which is a very quick fix with something we call hints",
    "start": "1492070",
    "end": "1499559"
  },
  {
    "start": "1494000",
    "end": "1559000"
  },
  {
    "text": "essentially if we can't predict the outcome of an action we have a a someone",
    "start": "1499559",
    "end": "1507760"
  },
  {
    "text": "hard-coded field that provides a hint to the planner as its training the actions together to figure out what the outcome",
    "start": "1507760",
    "end": "1513790"
  },
  {
    "text": "might be and in our case right now what we're doing is we just have the best outcome as the hint so another great",
    "start": "1513790",
    "end": "1521200"
  },
  {
    "text": "example here but you if you look and see this as like the state search graph if I start out and try doing everything",
    "start": "1521200",
    "end": "1526360"
  },
  {
    "text": "deterministically I might only be able to identify this one top plan if I have hints though I can then say okay maybe I",
    "start": "1526360",
    "end": "1533530"
  },
  {
    "text": "have these other outcomes of this first action and that's going to lead to these other potential branches and chaining",
    "start": "1533530",
    "end": "1539620"
  },
  {
    "text": "that again further we can start constructing a much larger search search tree so what Caldera does is it's able",
    "start": "1539620",
    "end": "1545350"
  },
  {
    "text": "to do this internally as its choosing an action it'll execute this first action observe the real responses then update",
    "start": "1545350",
    "end": "1552190"
  },
  {
    "text": "its knowledge base and move through whichever is actually corresponding to what's going on in the real world I",
    "start": "1552190",
    "end": "1557679"
  },
  {
    "text": "think with that I will give it back to Doug so if you're if you're more of a",
    "start": "1557679",
    "end": "1566350"
  },
  {
    "start": "1559000",
    "end": "1636000"
  },
  {
    "text": "software programmer like me this is the section will care about so this is more of the architecture and how the tool is",
    "start": "1566350",
    "end": "1571600"
  },
  {
    "text": "constructed so this is a very general overview of the software we have a",
    "start": "1571600",
    "end": "1577780"
  },
  {
    "text": "server component that's the thing that makes decisions all the planning the Andy just talked about happens on the server and the server makes connections",
    "start": "1577780",
    "end": "1584860"
  },
  {
    "text": "to all the clients which are running on systems that are partaking in the emulation exercise so you can see there",
    "start": "1584860",
    "end": "1591970"
  },
  {
    "text": "a couple components in the server there's an HTTP server which you can access as an administrator there's a",
    "start": "1591970",
    "end": "1597429"
  },
  {
    "text": "nice little web interface the next you before that you can kind of see what's going on you can configure everything there's a database under the",
    "start": "1597429",
    "end": "1604360"
  },
  {
    "text": "hood stores everything we have the planner and the execution engine which is kind of all the extra stuff that ties",
    "start": "1604360",
    "end": "1611830"
  },
  {
    "text": "everything together on the clients themselves there's a service that kind of keeps track of all the bookkeeping so",
    "start": "1611830",
    "end": "1618700"
  },
  {
    "text": "I mentioned that the operation can be cleaned up automatically afterwards that's the job of the service in this",
    "start": "1618700",
    "end": "1624850"
  },
  {
    "text": "picture it's called the agent and we have rats so the rats are the things the",
    "start": "1624850",
    "end": "1629890"
  },
  {
    "text": "the pieces of software that actually do all the running of the command lines all the emulation bits so the system itself",
    "start": "1629890",
    "end": "1638800"
  },
  {
    "text": "written in Python 3 the rat is written in c-sharp database we uses MongoDB",
    "start": "1638800",
    "end": "1646060"
  },
  {
    "text": "whoever faces JavaScript the logic which is sort of the underlying implementation",
    "start": "1646060",
    "end": "1651910"
  },
  {
    "text": "of the preconditions and postconditions the Andy talked about that's all written in a language called PI data log that's",
    "start": "1651910",
    "end": "1658660"
  },
  {
    "text": "kind of that's very interesting but it's outside of the scope of this talk but if you're interested in that come talk to",
    "start": "1658660",
    "end": "1663880"
  },
  {
    "text": "me and I'll give you an earful about that after the presentations over so probably the moment that you've all been",
    "start": "1663880",
    "end": "1671140"
  },
  {
    "start": "1666000",
    "end": "1698000"
  },
  {
    "text": "waiting for the demo and we have a live demo so hopefully everything works I",
    "start": "1671140",
    "end": "1677050"
  },
  {
    "text": "know that's a little bit it's a little bit crazy so just bear with me as I get",
    "start": "1677050",
    "end": "1683830"
  },
  {
    "text": "that set up so this is the software",
    "start": "1683830",
    "end": "1691300"
  },
  {
    "text": "that's not software oops try again okay this is the software we",
    "start": "1691300",
    "end": "1700420"
  },
  {
    "start": "1698000",
    "end": "1715000"
  },
  {
    "text": "have a small network running locally on this laptop so we have a domain controller and for host right for dos",
    "start": "1700420",
    "end": "1707200"
  },
  {
    "text": "for Windows 8.1 machines so I'm gonna",
    "start": "1707200",
    "end": "1712240"
  },
  {
    "text": "just kind of breeze through this but we'll take a look so this these are the adversaries these are like the core",
    "start": "1712240",
    "end": "1718270"
  },
  {
    "start": "1715000",
    "end": "1794000"
  },
  {
    "text": "building blocks of how you configure caldera so we have a few built-in ones I made a special one for this",
    "start": "1718270",
    "end": "1724410"
  },
  {
    "text": "presentation it's called advanced and these are the eight or nine different steps so it'll",
    "start": "1724410",
    "end": "1732160"
  },
  {
    "text": "be able to to dump credentials it'll do a bunch of different discovery steps so it'll query",
    "start": "1732160",
    "end": "1738039"
  },
  {
    "text": "for local administrators it'll dump repeaters it'll get information about",
    "start": "1738039",
    "end": "1743559"
  },
  {
    "text": "the domain it can do privacy so we've purposely configured the starting system to have a probe s1 err ability yeah oh",
    "start": "1743559",
    "end": "1751950"
  },
  {
    "text": "yes thank you right is that good a little bit more",
    "start": "1751950",
    "end": "1759909"
  },
  {
    "text": "sure all right hopefully that's been enough not everything will fit on the screen so I'll just have to scroll so it can do",
    "start": "1759909",
    "end": "1769119"
  },
  {
    "text": "service local probe ask we have purposely configured a service that's vulnerable to this so the service I",
    "start": "1769119",
    "end": "1776080"
  },
  {
    "text": "think we made it so the binary has is world writable so you can overwrite the",
    "start": "1776080",
    "end": "1781299"
  },
  {
    "text": "service so cold air will be able to do that if everything goes well and it can",
    "start": "1781299",
    "end": "1786909"
  },
  {
    "text": "do a lateral movement I think we have passed the hash copy and WMI for lateral",
    "start": "1786909",
    "end": "1792309"
  },
  {
    "text": "movement so that's what the adversary looks like so I'm just gonna go over here and I'm gonna create an operation",
    "start": "1792309",
    "end": "1798330"
  },
  {
    "start": "1794000",
    "end": "2063000"
  },
  {
    "text": "and let's see give it a name so I'll name this blackhat to the adversary we're using these are the adversaries",
    "start": "1798330",
    "end": "1804970"
  },
  {
    "text": "I'll pick the one that I was just showing you we can also select a network in this case I'm using the demo network",
    "start": "1804970",
    "end": "1810759"
  },
  {
    "text": "and the starting host and then there's some sort of startup options here so",
    "start": "1810759",
    "end": "1816629"
  },
  {
    "text": "because you kind of you know you need a way to kick off the operation Collier has a built-in feature to just",
    "start": "1816629",
    "end": "1823119"
  },
  {
    "text": "spin up the first rat automatically that's kind of like cheating but if you think about it sort of the equivalent of",
    "start": "1823119",
    "end": "1829359"
  },
  {
    "text": "like launching a spear phishing email and have someone click on malicious document so if you select the bootstrap",
    "start": "1829359",
    "end": "1835840"
  },
  {
    "text": "option which is what I'm going to do just for sake of time it'll spin up the first kind of patient zero wrap",
    "start": "1835840",
    "end": "1841179"
  },
  {
    "text": "automatically and there are a few more configuration options here but I'm gonna select the active user as the initial",
    "start": "1841179",
    "end": "1848379"
  },
  {
    "text": "context so this is an unprivileged domain user not the admin on the first system and we'll hit go",
    "start": "1848379",
    "end": "1857660"
  },
  {
    "text": "[Music] and if everything goes well I'm gonna",
    "start": "1857660",
    "end": "1863049"
  },
  {
    "text": "zoom out here because it doesn't fit well on the screen zoomed in so you can",
    "start": "1863049",
    "end": "1870580"
  },
  {
    "text": "see there are bubbles and colors so the bubbles represent the hosts the colors will change is the status of the",
    "start": "1870580",
    "end": "1876309"
  },
  {
    "text": "operation changes so one of them is yellow that's the starting host and",
    "start": "1876309",
    "end": "1881399"
  },
  {
    "text": "yellow means it's a nun elevated process blue in this case means that Caldera",
    "start": "1881399",
    "end": "1888519"
  },
  {
    "text": "knows the about the existence of the other host but doesn't have any anything running on them right now so that if",
    "start": "1888519",
    "end": "1894010"
  },
  {
    "text": "they haven't been laterally moved to so you can see on the right hand side it's doing some things so the the bubble just",
    "start": "1894010",
    "end": "1903850"
  },
  {
    "text": "changed to red so that means Pervez occurred you can see it looks for",
    "start": "1903850",
    "end": "1909370"
  },
  {
    "text": "pillage escalation vectors right there and then the next step attempted to escalate which succeeded so",
    "start": "1909370",
    "end": "1916450"
  },
  {
    "text": "I'm going to scroll down here so we can keep seeing what's going on so I dumped creds after that it's doing admin",
    "start": "1916450",
    "end": "1924730"
  },
  {
    "text": "enumeration right now so it enumerated administrators of 8xo 1 it used passed",
    "start": "1924730",
    "end": "1930340"
  },
  {
    "text": "the hash copy to move an implant over to 8xo 2 and now it's it executing that",
    "start": "1930340",
    "end": "1937210"
  },
  {
    "text": "which succeeded so it's dumping creds now on to and it's pretty much gonna",
    "start": "1937210",
    "end": "1943059"
  },
  {
    "text": "keep going at this point if everything is going well and it'll migrate its way",
    "start": "1943059",
    "end": "1949179"
  },
  {
    "text": "through the network one of the things I",
    "start": "1949179",
    "end": "1955299"
  },
  {
    "text": "didn't mention is and you can't really see this from the visualization but the",
    "start": "1955299",
    "end": "1960789"
  },
  {
    "text": "first toast that it started on a deck so one had two accounts on it actually was",
    "start": "1960789",
    "end": "1966010"
  },
  {
    "text": "just one account yes so it had one account so it got creds on the first toast and then when it moved to a deck",
    "start": "1966010",
    "end": "1971320"
  },
  {
    "text": "so two there was another account that it found and so it used that account to move to three and four and and the",
    "start": "1971320",
    "end": "1977230"
  },
  {
    "text": "reason it needed to do that is because the administrators were configured differently so it's complete and now",
    "start": "1977230",
    "end": "1984010"
  },
  {
    "text": "it's doing cleanup so it's everything changed back to normal because it's deleted everything and",
    "start": "1984010",
    "end": "1991050"
  },
  {
    "text": "yeah it's done now so we can see so this is this description here it's just a",
    "start": "1991050",
    "end": "1996180"
  },
  {
    "text": "very high-level description each of these boxes represents an individual step so we can click on one of them to",
    "start": "1996180",
    "end": "2003500"
  },
  {
    "text": "get more information what's good one here let's let's do one of the cred ones yeah",
    "start": "2003500",
    "end": "2012050"
  },
  {
    "text": "so let's look at meme cats so you can get information we've used attacks so",
    "start": "2012050",
    "end": "2017630"
  },
  {
    "text": "everything in attack Andy mentioned their techniques and tactics so we have those configured so you can see sort of",
    "start": "2017630",
    "end": "2024980"
  },
  {
    "text": "at a high level what this step is and this is the actual command line that was",
    "start": "2024980",
    "end": "2030740"
  },
  {
    "text": "executed and the standardout so if you're familiar with me me cats this is me me cat's output so this is gonna give",
    "start": "2030740",
    "end": "2036350"
  },
  {
    "text": "you all the you know all the stuff there's the password right there this is a it's a fake domain so don't worry so",
    "start": "2036350",
    "end": "2045980"
  },
  {
    "text": "I'm gonna show you now one other thing I'm gonna kind of highlight the positives of using a non state machine",
    "start": "2045980",
    "end": "2054378"
  },
  {
    "text": "based model so I'm gonna just change some of the techniques that the adversary uses so if I go back and I'm",
    "start": "2054379",
    "end": "2062870"
  },
  {
    "text": "gonna I'm gonna edit this adversary so this was the adversary we started with and I'm gonna hit edit and I'm gonna",
    "start": "2062870",
    "end": "2070850"
  },
  {
    "start": "2063000",
    "end": "2121000"
  },
  {
    "text": "make a couple changes so I'm gonna start it off this time as a system so as an",
    "start": "2070850",
    "end": "2075919"
  },
  {
    "text": "elevated process but I'm just gonna leave the privacy options in there so you'll see it it doesn't need those",
    "start": "2075919",
    "end": "2081408"
  },
  {
    "text": "so it doesn't really matter if I leave them in the system is smart enough yeah it uses the the planning to just know",
    "start": "2081409",
    "end": "2087648"
  },
  {
    "text": "that that's not useful I'm gonna change the lateral movement technique so instead of doing WMI which is this step",
    "start": "2087649",
    "end": "2095090"
  },
  {
    "text": "I'm gonna unselect that and it's going to use pass the hash FC which is just a",
    "start": "2095090",
    "end": "2100250"
  },
  {
    "text": "different lateral movement step it's gonna instead of doing pass the hash",
    "start": "2100250",
    "end": "2105320"
  },
  {
    "text": "copy for file copy I'm gonna use net use which is just a different copy technique",
    "start": "2105320",
    "end": "2112130"
  },
  {
    "text": "so for that I need copy file and that use",
    "start": "2112130",
    "end": "2117670"
  },
  {
    "text": "so I've done it I've submitted and then let's go back and run another operation so right so everything's gonna be the",
    "start": "2121250",
    "end": "2128990"
  },
  {
    "text": "same except I'm gonna start a system now so it won't need to probe esque anymore",
    "start": "2128990",
    "end": "2135130"
  },
  {
    "text": "so there we go so things are running you can see it started as red it discovered these other",
    "start": "2135130",
    "end": "2142400"
  },
  {
    "text": "systems after it did the first step here a new writing on computers and it's just",
    "start": "2142400",
    "end": "2147710"
  },
  {
    "text": "gonna if everything goes well it's just gonna keep doing this thing one of the",
    "start": "2147710",
    "end": "2153650"
  },
  {
    "text": "interesting things is Andy mentioned operates with zero prior knowledge so everything that it does in this",
    "start": "2153650",
    "end": "2159319"
  },
  {
    "text": "operation it's all the information that it gathers is sort of siloed off so it's not using anything that I discovered in",
    "start": "2159319",
    "end": "2165319"
  },
  {
    "text": "previous operations in this one that would be kind of like cheating I guess so it's everything that it's doing it's",
    "start": "2165319",
    "end": "2172400"
  },
  {
    "text": "doing fresh as if it you know just stepped onto this network for the first time so it's kind of chugging through it",
    "start": "2172400",
    "end": "2186410"
  },
  {
    "text": "didn't do the probe asked it it just went directly to running Mimi Katz did a",
    "start": "2186410",
    "end": "2191480"
  },
  {
    "text": "bunch of enumeration steps it mounted the network share so and then it copied in implants past the hash SC Randi me",
    "start": "2191480",
    "end": "2201050"
  },
  {
    "text": "cats on this new a new host that that it acquired it's gonna keep doing this same process so it'll mount the network share",
    "start": "2201050",
    "end": "2208010"
  },
  {
    "text": "copy an implant pass the SFC run Mimi Katz once that completes and it should",
    "start": "2208010",
    "end": "2216200"
  },
  {
    "text": "get the final cred and then it will be able to move to 8 x o3 after that so",
    "start": "2216200",
    "end": "2226990"
  },
  {
    "text": "so yeah I'm glad that demo worked that was good so as you can see I mean it's",
    "start": "2229590",
    "end": "2242380"
  },
  {
    "text": "it's actually running fairly quickly which is surprising given like all the",
    "start": "2242380",
    "end": "2247870"
  },
  {
    "text": "you know complexity that's happening under the hood we could support I think 15 to 20 hosts roughly before the",
    "start": "2247870",
    "end": "2256150"
  },
  {
    "text": "computational complexity just gets too difficult to build all the plans so it",
    "start": "2256150",
    "end": "2261880"
  },
  {
    "text": "if that kind of gives you an idea of the scope of the project and and what's applicable okay so it's done let me",
    "start": "2261880",
    "end": "2271150"
  },
  {
    "text": "switch back to the presentation cool so",
    "start": "2271150",
    "end": "2285390"
  },
  {
    "start": "2281000",
    "end": "2370000"
  },
  {
    "text": "you can kind of walk through like what happened under the hood during that from",
    "start": "2285390",
    "end": "2290500"
  },
  {
    "text": "more of like an architectural standpoint so we've got the architecture diagram here and this is just gonna show two",
    "start": "2290500",
    "end": "2296470"
  },
  {
    "text": "hosts so the first thing you do you issue start command tells the server",
    "start": "2296470",
    "end": "2303030"
  },
  {
    "text": "please run an operation gives it all the configuration information and sends the",
    "start": "2303030",
    "end": "2308710"
  },
  {
    "text": "first command to the agent if you're doing a bootstrap in this case we are the agent will spin up a rat for you and",
    "start": "2308710",
    "end": "2315490"
  },
  {
    "text": "then that rat will check in with the agent and the agent will register that check in with the server and then that",
    "start": "2315490",
    "end": "2321400"
  },
  {
    "text": "updates the database and triggers the planner and the execution engine to continue running an operation so then",
    "start": "2321400",
    "end": "2328570"
  },
  {
    "text": "the rattle you asked for a command to execute and then that gets passed again through the server and makes its way to",
    "start": "2328570",
    "end": "2334690"
  },
  {
    "text": "the planner and so now the planner has to start you know thinking about okay what makes sense to run what command I",
    "start": "2334690",
    "end": "2340570"
  },
  {
    "text": "want to issue what stepped on to execute during this operation and once it makes",
    "start": "2340570",
    "end": "2345700"
  },
  {
    "text": "the decision you know in this case maybe it wants to do SC creates so it's going to create a service to laterally move",
    "start": "2345700",
    "end": "2351700"
  },
  {
    "text": "it'll pass that decision all the way through down to the agent and then the agent issues that command to the rat the",
    "start": "2351700",
    "end": "2358600"
  },
  {
    "text": "rat executes sit and a result of SC create is a new rats run a remote host and then it'll check in",
    "start": "2358600",
    "end": "2364880"
  },
  {
    "text": "and so this is where it starts to get repetitive the process kind of continues",
    "start": "2364880",
    "end": "2370270"
  },
  {
    "start": "2370000",
    "end": "2439000"
  },
  {
    "text": "so that's you know that's the application that's how it works there",
    "start": "2370270",
    "end": "2376670"
  },
  {
    "text": "are much use cases internally we're using it in mitre to test analytics and",
    "start": "2376670",
    "end": "2382340"
  },
  {
    "text": "to develop new analytics we have so that's one of the primary aspects I",
    "start": "2382340",
    "end": "2389390"
  },
  {
    "text": "think is network defenders you know the idea of every simulation is to do adversary like things and to see how",
    "start": "2389390",
    "end": "2394640"
  },
  {
    "text": "your defenses respond one of the other things you can do is if you just want like bad guy data if you want to run",
    "start": "2394640",
    "end": "2401540"
  },
  {
    "text": "something and see what happens you can use caldera it's really great for that and another you know thing that",
    "start": "2401540",
    "end": "2408260"
  },
  {
    "text": "you might want to do if you actually have a red team or blue team and you want to train them it makes a little bit",
    "start": "2408260",
    "end": "2413270"
  },
  {
    "text": "more sense for a blue team you know you can put them up against an automatic adversary and we have some timing",
    "start": "2413270",
    "end": "2418790"
  },
  {
    "text": "configurations so you can actually slow caldera down if you want to be a little more fair to your blue team and you can",
    "start": "2418790",
    "end": "2426410"
  },
  {
    "text": "do that you can also use it to train you know if you have like a bunch of new guys and you just want to show them kind",
    "start": "2426410",
    "end": "2432110"
  },
  {
    "text": "of the overall flow and just give them something to look at you could do use caldera for that as well so the the code",
    "start": "2432110",
    "end": "2441530"
  },
  {
    "start": "2439000",
    "end": "2479000"
  },
  {
    "text": "it's open source the whole project is open we want participation from the community that's why we're presenting at",
    "start": "2441530",
    "end": "2447530"
  },
  {
    "text": "blackhat will pretty much you know anything that's reasonable we'll accept we pull request bug fixes if you have",
    "start": "2447530",
    "end": "2455120"
  },
  {
    "text": "new techniques we have 30 or so techniques implemented but if if there are more there definitely more and if",
    "start": "2455120",
    "end": "2460250"
  },
  {
    "text": "you want to implement something and send us a pull request we're open to that absolutely and if you know if you want",
    "start": "2460250",
    "end": "2466100"
  },
  {
    "text": "to integrate caldera with with new frameworks if you want to add ap is 100% okay and we showed you the data model",
    "start": "2466100",
    "end": "2472910"
  },
  {
    "text": "there's always more that you can add to that so if you have an idea for a new object to add open to that as well I hit",
    "start": "2472910",
    "end": "2481010"
  },
  {
    "start": "2479000",
    "end": "2501000"
  },
  {
    "text": "there a lot there's honestly there's a lot of stuff happening in this area I put a bunch of tools up here this will",
    "start": "2481010",
    "end": "2487550"
  },
  {
    "text": "be available I mean can't really like type URLs from this slide but there are a lot of tools available we'll post the",
    "start": "2487550",
    "end": "2493340"
  },
  {
    "text": "presentation and you'll be able to you know click on visit some of these pages there's some really cool stuff",
    "start": "2493340",
    "end": "2498350"
  },
  {
    "text": "that's happening in this area and I have to plug some of the other efforts that some of our Co researchers are doing we",
    "start": "2498350",
    "end": "2506780"
  },
  {
    "start": "2501000",
    "end": "2531000"
  },
  {
    "text": "have a project called brawl that does automatic read bot vs. blue bot cyber games so called here's the red bot in",
    "start": "2506780",
    "end": "2513140"
  },
  {
    "text": "this case there are other blue BOTS that try to detect or prevent Caldera from doing stuff we we've publicly released a",
    "start": "2513140",
    "end": "2519619"
  },
  {
    "text": "bunch of data so this is all sensor data that's been collected of stuff that caldera is doing it's mostly system on",
    "start": "2519619",
    "end": "2524990"
  },
  {
    "text": "data if you're familiar with that and there are a few other efforts that we have in this area as well so just to",
    "start": "2524990",
    "end": "2533090"
  },
  {
    "text": "kind of bring it back up to the beginning false negative problem it's it's really hard I mean it's hard to",
    "start": "2533090",
    "end": "2539030"
  },
  {
    "text": "know what you're missing and I think one of the good ways that you can address this is by introducing a realistic",
    "start": "2539030",
    "end": "2545390"
  },
  {
    "text": "emulated adversary on your network you know it's kind of a really nice standing checked just to see what you know what",
    "start": "2545390",
    "end": "2551450"
  },
  {
    "text": "your network is vulnerable to you didn't really talk about this but it's",
    "start": "2551450",
    "end": "2556850"
  },
  {
    "text": "important to mention that caldera we think it's really good research it's cool that you can do this stuff",
    "start": "2556850",
    "end": "2562700"
  },
  {
    "text": "automatically but I don't know if it's ever going to be able to fully replace a human adversary I mean humans are",
    "start": "2562700",
    "end": "2569480"
  },
  {
    "text": "creative humans can you know make inferences these are things that are really hard for a program to do quite",
    "start": "2569480",
    "end": "2576770"
  },
  {
    "text": "frankly but that being said caldera is you know you don't need a lot of smarts",
    "start": "2576770",
    "end": "2581840"
  },
  {
    "text": "to set up an around caldera and it still does a lot of things and can give you meaningful output but it does complement",
    "start": "2581840",
    "end": "2588800"
  },
  {
    "text": "a human adversary a human red team you know pre and post conditions we spend a",
    "start": "2588800",
    "end": "2595100"
  },
  {
    "text": "lot of time talking about that hopefully we didn't bore you I think it's really interesting and if you get anything from",
    "start": "2595100",
    "end": "2600260"
  },
  {
    "text": "this talk it's that thinking about this problem as a planning problem can be",
    "start": "2600260",
    "end": "2605540"
  },
  {
    "text": "really powerful and you know finally this is this is a difficult problem",
    "start": "2605540",
    "end": "2610760"
  },
  {
    "text": "we're open sourcing it because we think it can help the community and you know help us help you so and finally this is",
    "start": "2610760",
    "end": "2619580"
  },
  {
    "start": "2617000",
    "end": "2728000"
  },
  {
    "text": "the github this is the repo feel free to download the code and use it so with",
    "start": "2619580",
    "end": "2627530"
  },
  {
    "text": "that are there any questions for me or Andy I think there's a",
    "start": "2627530",
    "end": "2638150"
  },
  {
    "text": "microphone coming down for you",
    "start": "2638150",
    "end": "2641650"
  },
  {
    "text": "[Music]",
    "start": "2649840",
    "end": "2652999"
  },
  {
    "text": "[Music]",
    "start": "2699990",
    "end": "2703190"
  },
  {
    "text": "yeah so yeah so we looked a little bit",
    "start": "2727140",
    "end": "2732280"
  },
  {
    "start": "2728000",
    "end": "3132000"
  },
  {
    "text": "into that one of the papers that we have we try to incorporate what do we do if",
    "start": "2732280",
    "end": "2737800"
  },
  {
    "text": "there's like a defender looking for us and the idea there it was a very Toya example but the idea was like certain",
    "start": "2737800",
    "end": "2745480"
  },
  {
    "text": "types of lateral movement are easier to detect than other types of lateral movement and be very blunt it was easier",
    "start": "2745480",
    "end": "2753280"
  },
  {
    "text": "to roll that into that reward score and say I'm just gonna try to do a full full ordering of the actions with the reward",
    "start": "2753280",
    "end": "2759970"
  },
  {
    "text": "square ideally it would be better to say I have a reward for executing this and then I have a cost or a risk which is",
    "start": "2759970",
    "end": "2767020"
  },
  {
    "text": "you know and then combining the two somewhere else as opposed to like immediately in that score so we haven't looked in looked into it like",
    "start": "2767020",
    "end": "2773770"
  },
  {
    "text": "necessarily at that level which is the right level but we've kind of done a",
    "start": "2773770",
    "end": "2779740"
  },
  {
    "text": "little bit of exploration there and I think that that might be some interesting research for us to go down",
    "start": "2779740",
    "end": "2785430"
  },
  {
    "text": "[Music] yeah yeah so I so I would consider this",
    "start": "2805530",
    "end": "2816309"
  },
  {
    "text": "a prototype so I wouldn't like put this on your production environment yeah why",
    "start": "2816309",
    "end": "2831519"
  },
  {
    "text": "not I mean so so I mean this software you know it's a it's a prototype",
    "start": "2831519",
    "end": "2837730"
  },
  {
    "text": "we're researchers so we don't like build products so the quality to software it's",
    "start": "2837730",
    "end": "2843460"
  },
  {
    "text": "as good as we can make it but we're researchers right and we don't have unlimited resources with that being said",
    "start": "2843460",
    "end": "2849190"
  },
  {
    "text": "we've tried to make it as robust as possible we haven't done like a complete",
    "start": "2849190",
    "end": "2855240"
  },
  {
    "text": "like you know like spent like thousands of dollars doing like an audit or anything so you we try to make it as",
    "start": "2855240",
    "end": "2862450"
  },
  {
    "text": "secure as possible but no guarantees that you know there's not something that we just missed that being said I mean",
    "start": "2862450",
    "end": "2868599"
  },
  {
    "text": "code is open open source and so if anyone finds any problems with it yeah",
    "start": "2868599",
    "end": "2874890"
  },
  {
    "text": "[Music] yes can't make any promises but we do",
    "start": "2879980",
    "end": "2885830"
  },
  {
    "text": "yeah oh so the question was do we plan",
    "start": "2885830",
    "end": "2891109"
  },
  {
    "text": "to expand to Linux and the answer is we we can't make any promises but we plan to is there another question over here",
    "start": "2891109",
    "end": "2901960"
  },
  {
    "text": "yep",
    "start": "2904300",
    "end": "2907300"
  },
  {
    "text": "earlier he said you can choose a target you want so data exfiltration or maybe a",
    "start": "2912800",
    "end": "2919320"
  },
  {
    "text": "denial-of-service can you show us so what what you will do to change this",
    "start": "2919320",
    "end": "2925710"
  },
  {
    "text": "target o to like specifically select the target uh okay I didn't see I'm sorry",
    "start": "2925710",
    "end": "2933030"
  },
  {
    "text": "wait well so we were you asking how you",
    "start": "2933030",
    "end": "2942480"
  },
  {
    "text": "specifically select a target yes okay",
    "start": "2942480",
    "end": "2947780"
  },
  {
    "text": "we're not quite at the level where you can specifically say like go compromise",
    "start": "2948980",
    "end": "2954780"
  },
  {
    "text": "a specific host it's more of that so the",
    "start": "2954780",
    "end": "2960690"
  },
  {
    "text": "way the way the system works is it you you give it all the capabilities and then it uses as many as it can so it",
    "start": "2960690",
    "end": "2969540"
  },
  {
    "text": "would be pretty easy to modify the software to put in a stopping condition so like you know if you wanted it to",
    "start": "2969540",
    "end": "2975330"
  },
  {
    "text": "stop after it got to a specific host you can just have it detect you know and",
    "start": "2975330",
    "end": "2980730"
  },
  {
    "text": "like a conditional statement stop here we haven't built that into the software and that's because in our research it's",
    "start": "2980730",
    "end": "2987390"
  },
  {
    "text": "most useful to have the software just get as far as possible always and compromise as many hosts as it can so I",
    "start": "2987390",
    "end": "2995600"
  },
  {
    "text": "don't know if that answers your question okay thank you",
    "start": "2995600",
    "end": "3002830"
  },
  {
    "text": "I think one of you guys mentioned that you're doing research in AI and I imagine you know that's where we're",
    "start": "3008770",
    "end": "3015460"
  },
  {
    "text": "going with this can you just touch upon what you're doing right now or you know and perhaps",
    "start": "3015460",
    "end": "3022540"
  },
  {
    "text": "with you know the roadmap is or it's going yeah it's a little more along the",
    "start": "3022540",
    "end": "3027820"
  },
  {
    "text": "lines of classical ai we're not quite getting into that you know fun reinforcement learning alphago fun stuff",
    "start": "3027820",
    "end": "3034840"
  },
  {
    "text": "we've looked a little bit into stuff like that but it's hard but I think more",
    "start": "3034840",
    "end": "3043000"
  },
  {
    "text": "you know when we're using AI work we're taking a lot of stuff from the automated planning community and that's kind of",
    "start": "3043000",
    "end": "3049420"
  },
  {
    "text": "the big area we're looking to branch heavily into things like Markov decision processes goal based planning I get",
    "start": "3049420",
    "end": "3056530"
  },
  {
    "text": "different kinds of heuristics things like that are our main kind of directions in that area another one is",
    "start": "3056530",
    "end": "3062470"
  },
  {
    "text": "you know being able to do better inference learning is possible and not",
    "start": "3062470",
    "end": "3070240"
  },
  {
    "text": "strictly in the reinforcement learning kind of kind of category but there's other things you might also want want to",
    "start": "3070240",
    "end": "3076000"
  },
  {
    "text": "try to learn like maybe playing with the heuristic function can I learn a good function based on my you know certain",
    "start": "3076000",
    "end": "3083470"
  },
  {
    "text": "parameters or a prior experiences I will",
    "start": "3083470",
    "end": "3090730"
  },
  {
    "text": "say one of the problems in this domain is getting good data so I mean if you want to do something like a",
    "start": "3090730",
    "end": "3096150"
  },
  {
    "text": "learning-based algorithm you'd like you really need like hundreds of different like examples of people's networks that",
    "start": "3096150",
    "end": "3104140"
  },
  {
    "text": "have been compromised and getting like one of those examples is really hard so that makes this feel kind of extra",
    "start": "3104140",
    "end": "3111490"
  },
  {
    "text": "challenging I mean it's not like you can just download like 5,000 images of cats or something you know so",
    "start": "3111490",
    "end": "3119250"
  },
  {
    "text": "okay thank you",
    "start": "3125690",
    "end": "3130700"
  }
]