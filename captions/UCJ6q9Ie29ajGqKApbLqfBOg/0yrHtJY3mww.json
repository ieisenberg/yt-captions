[
  {
    "text": "hello everyone this is when the front door becom the back door the security Paradox of",
    "start": "2639",
    "end": "8280"
  },
  {
    "text": "osdp my name is Iran Jacob I'm head of research at Otoro and I have here with",
    "start": "8280",
    "end": "14879"
  },
  {
    "text": "me um Ariel harush from team and Kil which is not presenting with us today",
    "start": "14879",
    "end": "20080"
  },
  {
    "text": "but was also part of this research um just a little bit about us",
    "start": "20080",
    "end": "25160"
  },
  {
    "text": "we have all been researching industrial cyber security for the last years as part as our work at Otoro and Industrial",
    "start": "25160",
    "end": "32920"
  },
  {
    "text": "cyber Security Solutions provider and we are all located in Israel and due to the current world",
    "start": "32920",
    "end": "39960"
  },
  {
    "text": "situation we are presenting remotely and we all Hope For Better Days to",
    "start": "39960",
    "end": "46160"
  },
  {
    "text": "Come As part as our daily walk we had the chance to walk with different types",
    "start": "46160",
    "end": "52239"
  },
  {
    "text": "of manufacturing facilities critical infrastructure and smart transportation and on many of these we",
    "start": "52239",
    "end": "59960"
  },
  {
    "text": "you notice the use of physical Access Control Systems which are the systems that let you in and out of secured areas",
    "start": "59960",
    "end": "66520"
  },
  {
    "text": "or facilities using your access card a code tag or even your",
    "start": "66520",
    "end": "73000"
  },
  {
    "text": "fingerprint and at some point we've wondered if these components might put facilities that we are working with at",
    "start": "73000",
    "end": "80000"
  },
  {
    "text": "risk and we decide to check this out and uh today we are going to um discuss a",
    "start": "80000",
    "end": "87680"
  },
  {
    "text": "few related subjects first first we're going to start with a quick overview",
    "start": "87680",
    "end": "93399"
  },
  {
    "text": "about physical Access Control Systems and especially the latest protocol in town",
    "start": "93399",
    "end": "99079"
  },
  {
    "text": "OSP then we will continue with detailing uh methods that we've discovered for bypassing latest access control um for",
    "start": "99079",
    "end": "107280"
  },
  {
    "text": "unite access to secure areas and for last we will detail how attacks on o DP",
    "start": "107280",
    "end": "114079"
  },
  {
    "text": "communication stocks may lead to a breach of the internal IP network of the facility directly from a serial",
    "start": "114079",
    "end": "120719"
  },
  {
    "text": "connection at the front door and arel is going to cover this",
    "start": "120719",
    "end": "126560"
  },
  {
    "text": "later so how does physical Access Control Systems look like first we have",
    "start": "127479",
    "end": "132760"
  },
  {
    "text": "the employee or Personnel trying to get in and they should have some kind of identification for getting access and",
    "start": "132760",
    "end": "139200"
  },
  {
    "text": "this could be contact test card RFID tag biometric or just a keypad",
    "start": "139200",
    "end": "145280"
  },
  {
    "text": "code and this identification is then passed to the access control wiers which",
    "start": "145280",
    "end": "151000"
  },
  {
    "text": "are located right outside of the door and uh usually are uh not secured by uh",
    "start": "151000",
    "end": "158599"
  },
  {
    "text": "additional uh additional uh methods except maybe guard if this is",
    "start": "158599",
    "end": "166640"
  },
  {
    "text": "the front door or a camera and we're are going to discuss uh this later but behind this reader there",
    "start": "166640",
    "end": "173760"
  },
  {
    "text": "is an very important part the um serial connection and this serial connection is",
    "start": "173760",
    "end": "179560"
  },
  {
    "text": "connect connected to the controller and the controller is the one",
    "start": "179560",
    "end": "185480"
  },
  {
    "text": "that is deciding if any door is getting open or close so it is connected to the doors and also connected to the exit",
    "start": "185480",
    "end": "192720"
  },
  {
    "text": "buttons or sensors and to manage this controller we have some EET interfaces",
    "start": "192720",
    "end": "200480"
  },
  {
    "text": "uh administrator can just connect to the controller um over for example HTTP service and configure the controller and",
    "start": "200480",
    "end": "207879"
  },
  {
    "text": "another option is to integrate the with some centralized security server and This Server can manage the organization",
    "start": "207879",
    "end": "215400"
  },
  {
    "text": "identities in a central location so having this once the user",
    "start": "215400",
    "end": "220920"
  },
  {
    "text": "try to enter the Cure area the ID first will be presented to the reader then the",
    "start": "220920",
    "end": "226560"
  },
  {
    "text": "reader will pass it over the S communication to the controller and if",
    "start": "226560",
    "end": "231799"
  },
  {
    "text": "valid the controller will open the relevant door along these um",
    "start": "231799",
    "end": "240400"
  },
  {
    "text": "different uh presentations and research work were done about physical Access",
    "start": "240400",
    "end": "245920"
  },
  {
    "text": "Control security and different attacks were demonstrated it is starting from attacking the contactless access cards",
    "start": "245920",
    "end": "253200"
  },
  {
    "text": "encryption or using physical overrides at the reader and even triggering the exit",
    "start": "253200",
    "end": "259639"
  },
  {
    "text": "sensors from outside or given some pre access to the inter Network trying to",
    "start": "259639",
    "end": "264840"
  },
  {
    "text": "attack from the inside um the Access Controller over the EET interface",
    "start": "264840",
    "end": "271000"
  },
  {
    "text": "but one of the most dominant attack was on the serial um reader to controller",
    "start": "271000",
    "end": "277160"
  },
  {
    "text": "Channel and this is because that this communication was broken from security",
    "start": "277160",
    "end": "282720"
  },
  {
    "text": "perspective for many years and lately had some significant improvements and we",
    "start": "282720",
    "end": "288000"
  },
  {
    "text": "are going to discuss this connectivity and focusing on OSP the new and secure",
    "start": "288000",
    "end": "293120"
  },
  {
    "text": "protocols that is expected to overcome many of the known security issues that were presented in this area till",
    "start": "293120",
    "end": "302080"
  },
  {
    "text": "now so there are two common protocols for reader control communication first is wegend which is",
    "start": "303759",
    "end": "310960"
  },
  {
    "text": "the dominant protocol and interface it is available since the late '70s so it's",
    "start": "310960",
    "end": "316160"
  },
  {
    "text": "old and therefore has limited capabilities and no security by designs",
    "start": "316160",
    "end": "322240"
  },
  {
    "text": "so for is now it has been proving uh proven to be insecure and you can find",
    "start": "322240",
    "end": "328120"
  },
  {
    "text": "many tools that uh main tools that can assist you to",
    "start": "328120",
    "end": "334360"
  },
  {
    "text": "just e drop communication replay uh other user credentials and basically",
    "start": "334360",
    "end": "339800"
  },
  {
    "text": "open the door on demand and since then we have the",
    "start": "339800",
    "end": "345360"
  },
  {
    "text": "security industri Association developing a new protocol the open supervised device protocol which is already",
    "start": "345360",
    "end": "352120"
  },
  {
    "text": "increasingly deployed using rs485 physical layer and OSP is not only providing new",
    "start": "352120",
    "end": "359360"
  },
  {
    "text": "possib abilities and new functionalities it also provides an option for secure Channel and if configured properly",
    "start": "359360",
    "end": "367280"
  },
  {
    "text": "attackers should not have the ability to e drop or perform replay PS and this is a big if and earlier this",
    "start": "367280",
    "end": "376560"
  },
  {
    "text": "year Bishop Fox team have elaborated about different attacks that might be performed against solutions that were",
    "start": "376560",
    "end": "382479"
  },
  {
    "text": "not fully implementing ostp security and not configuring uh all the security",
    "start": "382479",
    "end": "388400"
  },
  {
    "text": "configuration properly or enforcing the security they even made a small embedded",
    "start": "388400",
    "end": "393479"
  },
  {
    "text": "tool that intercept and exploit these kind of incorrect",
    "start": "393479",
    "end": "398680"
  },
  {
    "text": "setups but even though it can be easily configured insecurely and some",
    "start": "398680",
    "end": "404479"
  },
  {
    "text": "encryption practices are not the best once it is configured properly it is not",
    "start": "404479",
    "end": "409599"
  },
  {
    "text": "as bad in terms of Defending against practical attacks and can be assumed relatively",
    "start": "409599",
    "end": "416280"
  },
  {
    "text": "secure well during this session we're going to check this out and we will only focus on fully secured and properly",
    "start": "416280",
    "end": "422639"
  },
  {
    "text": "deployed OSP setups we will discuss two attack scenarios first we'll try to bypass",
    "start": "422639",
    "end": "429120"
  },
  {
    "text": "acction control and just open doors without any authorization or pure knowledge and second we're going to try",
    "start": "429120",
    "end": "436520"
  },
  {
    "text": "to go a bit farther and AR is going to try to challenge the protocol",
    "start": "436520",
    "end": "442160"
  },
  {
    "text": "implementation in order to gain remote code execution on the controller and",
    "start": "442160",
    "end": "447680"
  },
  {
    "text": "this should lead to a foothold in the internal IP network directly from the front door and this is especially",
    "start": "447680",
    "end": "453759"
  },
  {
    "text": "interesting because it is going to demonstrate end to endend serial to EET",
    "start": "453759",
    "end": "459960"
  },
  {
    "text": "attack so let's start with the classic use case and try to open some",
    "start": "460280",
    "end": "465599"
  },
  {
    "text": "doors first we need to have some setup for playing around with the ocp communication so we've set up a simple",
    "start": "465599",
    "end": "473080"
  },
  {
    "text": "main the middle lab we've got the physical controller on the right and reader on the left and our laptop in the",
    "start": "473080",
    "end": "479599"
  },
  {
    "text": "middle then using a cheap RS 485 adapters we've connected both sides to",
    "start": "479599",
    "end": "485120"
  },
  {
    "text": "the laptop and implemented and M the middle Logic for intercepting thep",
    "start": "485120",
    "end": "492280"
  },
  {
    "text": "communication this way when a card is presented the communication will go right through our laptop and we can",
    "start": "492280",
    "end": "498720"
  },
  {
    "text": "freely modify block delay or forward any communication by the way if you are",
    "start": "498720",
    "end": "506039"
  },
  {
    "text": "interested in doing this for red teaming you should check out out melon the small",
    "start": "506039",
    "end": "511360"
  },
  {
    "text": "Hardware that was developed by Bishop Fox and this one implements this setup",
    "start": "511360",
    "end": "516399"
  },
  {
    "text": "over almost a coin size hardware and it's",
    "start": "516399",
    "end": "521479"
  },
  {
    "text": "great also worth noting that for some tests due to some missing function Security functionalities in our physical",
    "start": "521479",
    "end": "528399"
  },
  {
    "text": "controller we've used a virtual controller setup based on the great open source library library Lio sdp and this",
    "start": "528399",
    "end": "537160"
  },
  {
    "text": "is also a great setup if someone is interested to to try this at home and not willing to buy an exp expensive",
    "start": "537160",
    "end": "544680"
  },
  {
    "text": "controller so let's take a look at how a connection to the ostp is being",
    "start": "546320",
    "end": "551480"
  },
  {
    "text": "performed in reality we have the physical reader and in back there is a c connected to the controller and if we",
    "start": "551480",
    "end": "558279"
  },
  {
    "text": "open the box of the reader unscrewing the screen the bottom uh we can just see",
    "start": "558279",
    "end": "564680"
  },
  {
    "text": "here a cable and connect directly to it",
    "start": "564680",
    "end": "571360"
  },
  {
    "text": "but since we are discussing a fully secured installation we can't ignore temper protection and temper protection",
    "start": "571920",
    "end": "578880"
  },
  {
    "text": "is widely available feature of readers providing the controller with indication",
    "start": "578880",
    "end": "583959"
  },
  {
    "text": "based on the sensor inside the reader box if the reader was",
    "start": "583959",
    "end": "590560"
  },
  {
    "text": "opened and as long as the reader box is closed The Temper protection line will be active and everything will be okay",
    "start": "590600",
    "end": "597000"
  },
  {
    "text": "but once open the temp protection line will be off and the controller will have indication for compromise and trigger an",
    "start": "597000",
    "end": "604360"
  },
  {
    "text": "alert on this home system if you have one and by the way with OSP The Temper",
    "start": "604360",
    "end": "610880"
  },
  {
    "text": "protection can also be sent directly over the rs485",
    "start": "610880",
    "end": "617360"
  },
  {
    "text": "channel so for testing potential ways to bypass this we've connected a small green lead light to The Temper",
    "start": "618720",
    "end": "625240"
  },
  {
    "text": "protection signal and now when the cas Cas is closed the lead",
    "start": "625240",
    "end": "630920"
  },
  {
    "text": "light is on and once it is open it is turned off and we have an indication of",
    "start": "630920",
    "end": "638959"
  },
  {
    "text": "compromise and after working on this for a while the one and only has created a",
    "start": "639360",
    "end": "644800"
  },
  {
    "text": "very sophisticated hacking tool made of selected pieces of hardware and using this tool we can uh cover the internal",
    "start": "644800",
    "end": "652079"
  },
  {
    "text": "tamper protection sensor and this allows us to expose the wires without triggering any alarms and",
    "start": "652079",
    "end": "659760"
  },
  {
    "text": "it looks something like this so we are going to insert this tool from the",
    "start": "659760",
    "end": "665079"
  },
  {
    "text": "bottom of the device and just cover the sensor without triggering the alarm and",
    "start": "665079",
    "end": "670720"
  },
  {
    "text": "when used um end to end it should look something like this uh we slightly open",
    "start": "670720",
    "end": "676560"
  },
  {
    "text": "the bottom without triggering an alarm and then inserting the tool carefully is covering the internal",
    "start": "676560",
    "end": "683680"
  },
  {
    "text": "sensor until we see the cable right there and during all these time the",
    "start": "683680",
    "end": "689480"
  },
  {
    "text": "green light is still indicating that everything is okay so there might be other sensors",
    "start": "689480",
    "end": "697040"
  },
  {
    "text": "that will be harder to overcome and it does raise the effort required from",
    "start": "697040",
    "end": "702120"
  },
  {
    "text": "potential attacker so we won't give up on temp protection yet but in general",
    "start": "702120",
    "end": "708279"
  },
  {
    "text": "temp protection is not enough and should not be trusted on its",
    "start": "708279",
    "end": "713120"
  },
  {
    "text": "own let's continue to uh OSP protocol well now that we can",
    "start": "716480",
    "end": "722519"
  },
  {
    "text": "physically inter intercept the ocp communication um we must understand how the ostp communication looks like and in",
    "start": "722519",
    "end": "729880"
  },
  {
    "text": "ostp we have two sides for communication we have the controller the CP and the",
    "start": "729880",
    "end": "735959"
  },
  {
    "text": "reader the PD and both are continuously communicating even if they do not have",
    "start": "735959",
    "end": "741519"
  },
  {
    "text": "any information to pass and the communication is always initialized by the CP sending some command and PD",
    "start": "741519",
    "end": "747160"
  },
  {
    "text": "sending back a reply and even if they do not have anything to send it they would",
    "start": "747160",
    "end": "753360"
  },
  {
    "text": "just send a pull and respond with a and it's just going Going On Till There is",
    "start": "753360",
    "end": "759760"
  },
  {
    "text": "some information to pass when discussing secure sdp communication things get a little bit",
    "start": "759760",
    "end": "767240"
  },
  {
    "text": "more complicated so we'll try to keep some part simplified first we have to initialize a",
    "start": "767240",
    "end": "775160"
  },
  {
    "text": "secure Channel and for this both the PD and CP should should have a pre-shared",
    "start": "775160",
    "end": "780199"
  },
  {
    "text": "secret and this secret is a secure channel base key",
    "start": "780199",
    "end": "785519"
  },
  {
    "text": "orbk and once we have this SCB set on both sides the CP can send a random challenge",
    "start": "786600",
    "end": "795680"
  },
  {
    "text": "to the PD and the PD will use this challenge to create a session specific",
    "start": "795680",
    "end": "801120"
  },
  {
    "text": "uh keys and we'll send back a proof of",
    "start": "801120",
    "end": "806600"
  },
  {
    "text": "successfully encrypting data using this key to the the CP along another random",
    "start": "806600",
    "end": "811680"
  },
  {
    "text": "Challenge and the CP will do the same from his side and validate the proof of the PD and send back the proof and we",
    "start": "811680",
    "end": "821160"
  },
  {
    "text": "have both sides mutually authenticated and having uh unique session keys for",
    "start": "821160",
    "end": "827199"
  },
  {
    "text": "this secure Channel but this is not enough and to avoid replay attacks where an attacker",
    "start": "827199",
    "end": "834199"
  },
  {
    "text": "is just sending the same encrypted message again we must have",
    "start": "834199",
    "end": "840160"
  },
  {
    "text": "H make sure that each message is encrypted a bit differently even if it",
    "start": "840160",
    "end": "845959"
  },
  {
    "text": "contains the same data and for this we have the IV the initialization vector",
    "start": "845959",
    "end": "852759"
  },
  {
    "text": "and the IV is used to randomize the encryption so same messages will not end up with the same Cipher text so as long",
    "start": "852759",
    "end": "861040"
  },
  {
    "text": "as IV is different the cipher text will be different in ostp IV for each message is",
    "start": "861040",
    "end": "869519"
  },
  {
    "text": "based on the previous message data or more accurately on the last message",
    "start": "869519",
    "end": "874600"
  },
  {
    "text": "message authentication code so it would look something like this the Mac for the",
    "start": "874600",
    "end": "879839"
  },
  {
    "text": "First Command will be used for the IV for of",
    "start": "879839",
    "end": "885519"
  },
  {
    "text": "the first reply and the Mac for first of the first reply will be used as the IV of the next command and so",
    "start": "885519",
    "end": "892959"
  },
  {
    "text": "on and what about the IV for first message well it is based on the last",
    "start": "892959",
    "end": "900759"
  },
  {
    "text": "message that we are sending during the channel initialization",
    "start": "900759",
    "end": "907079"
  },
  {
    "text": "and basically it would look something like this and uh the information that a PD send inside of the AR I reply will be",
    "start": "907079",
    "end": "916199"
  },
  {
    "text": "served as uh IV for the First",
    "start": "916199",
    "end": "921240"
  },
  {
    "text": "Command great so now we have everything that we need for secure Channel",
    "start": "922000",
    "end": "927360"
  },
  {
    "text": "communication and if someone will enter the building with a valid card and then attacker will try to",
    "start": "927360",
    "end": "934480"
  },
  {
    "text": "replay the message then it will discover that this",
    "start": "934480",
    "end": "939759"
  },
  {
    "text": "message will not work because the IV it is using is old and at this point the",
    "start": "939759",
    "end": "945560"
  },
  {
    "text": "controller will expect uh other IV and the encryption will be",
    "start": "945560",
    "end": "950920"
  },
  {
    "text": "incorrect and we had an idea uh at this point about what if we could just revert",
    "start": "950920",
    "end": "959959"
  },
  {
    "text": "back the I this might allow us to use all the messages",
    "start": "959959",
    "end": "965240"
  },
  {
    "text": "again and we have the Armic I request which is actually setting the first IV",
    "start": "965240",
    "end": "970759"
  },
  {
    "text": "of the CP communication so if for some reason it will be accepted at this",
    "start": "970759",
    "end": "976720"
  },
  {
    "text": "point we could just um end up with reverting IV to be the",
    "start": "976720",
    "end": "982480"
  },
  {
    "text": "same as was in the beginning of SK channel uh session and as long as the CP is consistent with its request since the",
    "start": "982480",
    "end": "989519"
  },
  {
    "text": "start of the secure Channel we can just resend the whole secure channel",
    "start": "989519",
    "end": "996480"
  },
  {
    "text": "from the beginning and until we are reaching the the reply uh with the valid",
    "start": "996480",
    "end": "1003759"
  },
  {
    "text": "card and basically the door should open",
    "start": "1003759",
    "end": "1009000"
  },
  {
    "text": "and we've managed to to implement this against uh the lib ostp controllers that",
    "start": "1009000",
    "end": "1015639"
  },
  {
    "text": "we've used and uh this is a great library and sidas from the maintaining",
    "start": "1015639",
    "end": "1022360"
  },
  {
    "text": "this library was very professional and very responsive and helped to fix everything",
    "start": "1022360",
    "end": "1028600"
  },
  {
    "text": "quickly and while it might work on other implementation as well it is still an",
    "start": "1028600",
    "end": "1034240"
  },
  {
    "text": "implementation ER and even though it can be configured better in thep specs and we should",
    "start": "1034240",
    "end": "1040918"
  },
  {
    "text": "discuss if aric I message is needed or should be verified we've decided to look",
    "start": "1040919",
    "end": "1046558"
  },
  {
    "text": "for something more robust so we went back to the OSP specs and",
    "start": "1046559",
    "end": "1053280"
  },
  {
    "text": "we've looked for something more generic and at this point we've noticed an interesting reply message the PD busy",
    "start": "1053280",
    "end": "1061480"
  },
  {
    "text": "reply and the PD busy reply is a simple message that a PD can send in order to",
    "start": "1061480",
    "end": "1067520"
  },
  {
    "text": "notify the CP that it is taking some time for processing previous commands",
    "start": "1067520",
    "end": "1073200"
  },
  {
    "text": "and it won't manage to respond within the replay timeout defined by the protocol so to keep the CP aware and the",
    "start": "1073200",
    "end": "1080919"
  },
  {
    "text": "session active it notifies that it is busy but still there and it might not",
    "start": "1080919",
    "end": "1086840"
  },
  {
    "text": "sound very exciting but there are two interesting facts about this pdbs",
    "start": "1086840",
    "end": "1091960"
  },
  {
    "text": "message first it is encrypted even during secure Channel it will always be",
    "start": "1091960",
    "end": "1099200"
  },
  {
    "text": "encrypted and second it can be sent continuously but why is it interesting",
    "start": "1099200",
    "end": "1107000"
  },
  {
    "text": "first we must understand how time delays in OSP secure Channel looks like so in",
    "start": "1107000",
    "end": "1112960"
  },
  {
    "text": "general if an attacker would try to get in the middle of secure Channel after 8",
    "start": "1112960",
    "end": "1119559"
  },
  {
    "text": "Seconds of delaying the communication the channel will break and both sides will initialize a new secure Channel but",
    "start": "1119559",
    "end": "1127000"
  },
  {
    "text": "if an attacker will use the pdb message even in the middle of the secure Channel",
    "start": "1127000",
    "end": "1132159"
  },
  {
    "text": "it will reset the 8sec timeout and it can be done",
    "start": "1132159",
    "end": "1137440"
  },
  {
    "text": "continuously now this is interesting because if the delayed message is a valid entry request it means that the",
    "start": "1137440",
    "end": "1144520"
  },
  {
    "text": "attacker has full control on when the message will be delivered",
    "start": "1144520",
    "end": "1150919"
  },
  {
    "text": "and resulting in controlling the exact timing for opening the",
    "start": "1150919",
    "end": "1156520"
  },
  {
    "text": "door for example an ATT can delay this valid message as long as needed till the user will give up or at least let him",
    "start": "1156520",
    "end": "1164120"
  },
  {
    "text": "try and at this point attacker can easily stop with the pdbs messages and",
    "start": "1164120",
    "end": "1169159"
  },
  {
    "text": "release the valid car data on his behalf and the door will be",
    "start": "1169159",
    "end": "1177200"
  },
  {
    "text": "open and afterwards of course the legit user can try again and everything will work and everyone will be",
    "start": "1177200",
    "end": "1184960"
  },
  {
    "text": "happy so this does require some very basic social engineering skills but it",
    "start": "1185240",
    "end": "1190440"
  },
  {
    "text": "will eventually walk and get you in and it is expected to affect all implementation that are following the",
    "start": "1190440",
    "end": "1197120"
  },
  {
    "text": "specs accurately and following some discussions with the security industrial Association",
    "start": "1197120",
    "end": "1203799"
  },
  {
    "text": "representative it would take time for being mitigated and users should take",
    "start": "1203799",
    "end": "1209120"
  },
  {
    "text": "some precautions till then I hope it will be sooner than",
    "start": "1209120",
    "end": "1214760"
  },
  {
    "text": "later and a short demo for this attack will basically show how uh once a card",
    "start": "1214760",
    "end": "1221679"
  },
  {
    "text": "is uh captured the main middle will delay the communication with pdb",
    "start": "1221679",
    "end": "1227159"
  },
  {
    "text": "messages uh till enter will be pressed and the message will be released and you",
    "start": "1227159",
    "end": "1232919"
  },
  {
    "text": "can see on the bottom left indication that the door was",
    "start": "1232919",
    "end": "1237400"
  },
  {
    "text": "open so so far we've mainly discuss discussed the risk of breaching access",
    "start": "1239360",
    "end": "1245440"
  },
  {
    "text": "control and gaining physical access but ostp also brings new opportunities for the",
    "start": "1245440",
    "end": "1252639"
  },
  {
    "text": "attack and it is basically because ostp enables a lot of new from functionalities it is starting from as",
    "start": "1253919",
    "end": "1261240"
  },
  {
    "text": "encryption continue to status report remote reader configuration transfer Advanced Data formats and even remote",
    "start": "1261240",
    "end": "1268880"
  },
  {
    "text": "funware update and all of these cost come at the cost of increase",
    "start": "1268880",
    "end": "1276080"
  },
  {
    "text": "complexity when inspecting the open source implementations online we've seen it very clearly while W implementations",
    "start": "1276080",
    "end": "1283320"
  },
  {
    "text": "are only around 200 lines of codes ostp ones are over 4K not including the",
    "start": "1283320",
    "end": "1288760"
  },
  {
    "text": "linked libraries and we all note that with increased complexity there are more bugs",
    "start": "1288760",
    "end": "1296400"
  },
  {
    "text": "and memory corruption bugs that sometimes may be risky have been present",
    "start": "1296400",
    "end": "1301480"
  },
  {
    "text": "in Lio sdp and after looking for a while we found a new one that allow us to C",
    "start": "1301480",
    "end": "1306799"
  },
  {
    "text": "den of service even during secure Chanel so in St there is some potential",
    "start": "1306799",
    "end": "1313080"
  },
  {
    "text": "here and this is kind of a security Paradox on one hand we want to to reduce risk",
    "start": "1313080",
    "end": "1319600"
  },
  {
    "text": "from classic attacks and on the other hand we understand that we are increasing other attack surfaces",
    "start": "1319600",
    "end": "1328240"
  },
  {
    "text": "significantly this leads us to our next part where we are going to",
    "start": "1329159",
    "end": "1334200"
  },
  {
    "text": "try to go beyond access control and to discuss how we are going to get into the",
    "start": "1334200",
    "end": "1339279"
  },
  {
    "text": "IP network from the front door and by the way if you're interested in this kind of Serial IP attacks earlier this",
    "start": "1339279",
    "end": "1346960"
  },
  {
    "text": "year just W discuss this IP to seral attack for post exploitation",
    "start": "1346960",
    "end": "1352559"
  },
  {
    "text": "so if you're interested it was also checking out so in my chapter I'm going to",
    "start": "1352559",
    "end": "1358760"
  },
  {
    "text": "discuss about getting a foothold in the internal IP network so just a short reminder we have",
    "start": "1358760",
    "end": "1365440"
  },
  {
    "text": "our attacker which tempered over the wires and his goal is gaining access from the serial to the",
    "start": "1365440",
    "end": "1372200"
  },
  {
    "text": "EET in order to achieve our purpose we targeted our axis controller and as part",
    "start": "1372200",
    "end": "1377400"
  },
  {
    "text": "of that we needed the frameware as well as gaining debug abilities on it the first step toward our goal is",
    "start": "1377400",
    "end": "1385039"
  },
  {
    "text": "extracting the CPS frameware by doing so we gained access to most of the files which one of them is PX which is the",
    "start": "1385039",
    "end": "1391840"
  },
  {
    "text": "main process that handles the osdp communication so after getting the relevant binaries what's next debugging",
    "start": "1391840",
    "end": "1400360"
  },
  {
    "text": "reseearch do thep implementation will be much easier once we are capable of debugging the system so first we find",
    "start": "1400360",
    "end": "1407000"
  },
  {
    "text": "our way into a privileged shell on the system which was possible by using the existing web interface of the device",
    "start": "1407000",
    "end": "1412799"
  },
  {
    "text": "where you allowed to upload files of your own we uploaded netcut NS HTML file",
    "start": "1412799",
    "end": "1418559"
  },
  {
    "text": "which contained a short line of executing net",
    "start": "1418559",
    "end": "1422760"
  },
  {
    "text": "cut on top of the ne session we activated the SSH service by doing so we've got an access device which",
    "start": "1425279",
    "end": "1432000"
  },
  {
    "text": "communicates with us over SSH and also GDB which is a debugging tool that we've",
    "start": "1432000",
    "end": "1437360"
  },
  {
    "text": "used to dynamically debug the controller after our setup is ready for",
    "start": "1437360",
    "end": "1443880"
  },
  {
    "text": "research we were needed to highlight a few relevant areas to research we looked into any area that will be that we will",
    "start": "1443880",
    "end": "1450240"
  },
  {
    "text": "be able to exploit even when attacking a secure Channel it might be a secure Channel",
    "start": "1450240",
    "end": "1456520"
  },
  {
    "text": "handshake it might be the secure Channel handshake maybe the DP head processing",
    "start": "1456520",
    "end": "1463240"
  },
  {
    "text": "or the message receiver logic let's take a look into the message receiver logic and see if can find any",
    "start": "1463240",
    "end": "1469120"
  },
  {
    "text": "interesting issues there so what do we need to know about that message re a logic well basically",
    "start": "1469120",
    "end": "1476960"
  },
  {
    "text": "it performed before secure Channel validation or initialization and as you can see in the message processing flow right after the",
    "start": "1476960",
    "end": "1483679"
  },
  {
    "text": "PD sends any kind of message the fil thing in the flow of the CP is the message to see a",
    "start": "1483679",
    "end": "1489840"
  },
  {
    "text": "logic let's understand the basic flow of message receiving when a pocket arrives there is a buffer fixed size of 100 ex",
    "start": "1490640",
    "end": "1497559"
  },
  {
    "text": "bites which will contain the message when the second packet arrives the same process occurs on the same",
    "start": "1497559",
    "end": "1505360"
  },
  {
    "text": "buffer when a message is sent with more than one part the following happens the first part is being written to our",
    "start": "1505360",
    "end": "1512000"
  },
  {
    "text": "buffer as we already know the program analyzes the header and understand that it's not the whole message so when a new",
    "start": "1512000",
    "end": "1519399"
  },
  {
    "text": "pcket arrives the program allocates new buffer or one of 100 exas plus the size",
    "start": "1519399",
    "end": "1524840"
  },
  {
    "text": "of the first chunk and finally the program rewrites the first half to the new buffer and",
    "start": "1524840",
    "end": "1531279"
  },
  {
    "text": "then it adds the second part of the message as shown when a pocket arrives",
    "start": "1531279",
    "end": "1538039"
  },
  {
    "text": "the additional bite length from the previous pocket is being calculated and the buffer allocated accordingly then the additional bites",
    "start": "1538039",
    "end": "1545000"
  },
  {
    "text": "are being copied now let's check let's check this code that's supposed to read from the",
    "start": "1545000",
    "end": "1551159"
  },
  {
    "text": "serial and the second pocket and write it to the allocated buffer it's WR",
    "start": "1551159",
    "end": "1556399"
  },
  {
    "text": "amount of additional bite length Plus 100 exas from the S which is the size of our",
    "start": "1556399",
    "end": "1563360"
  },
  {
    "text": "buffer but here's the problem it starts writing within an offset from the buffer",
    "start": "1563679",
    "end": "1569080"
  },
  {
    "text": "to not override the additional bites it just copied to sum up we have our buffer PTR",
    "start": "1569080",
    "end": "1576000"
  },
  {
    "text": "size 100 xas plus additional B length the data we read from the serial connection which is in the length of our",
    "start": "1576000",
    "end": "1582279"
  },
  {
    "text": "buff PPR and finally we write our data to the and Fin we write the data we read",
    "start": "1582279",
    "end": "1589799"
  },
  {
    "text": "to our buffer but from an offset of additional B lens this is what leads to",
    "start": "1589799",
    "end": "1595440"
  },
  {
    "text": "an overflow let's look at the at this on the form of message",
    "start": "1595440",
    "end": "1601919"
  },
  {
    "text": "flow first a message arrives with additional information after that a second message",
    "start": "1601919",
    "end": "1608720"
  },
  {
    "text": "with a size of 100 xas plus additional byes length is being sent the program will allocate the",
    "start": "1608720",
    "end": "1615240"
  },
  {
    "text": "buffer according to the first pcket of 100 xas plus additional B lens and will'll rewrite the additional bit from",
    "start": "1615240",
    "end": "1621399"
  },
  {
    "text": "the first pocket to the new buffer The Next Step will be writing the",
    "start": "1621399",
    "end": "1627360"
  },
  {
    "text": "new bucket content starting from the offset in the buffer with the size of 100 xas plus additional bite",
    "start": "1627360",
    "end": "1633960"
  },
  {
    "text": "length and as you can see a overflow is",
    "start": "1633960",
    "end": "1638840"
  },
  {
    "text": "Accused well now that we've got an overflow primitive let's see what is the potential of such attack",
    "start": "1642600",
    "end": "1649080"
  },
  {
    "text": "let's look at the following example which based on our process memory assuming that we are writing to",
    "start": "1649080",
    "end": "1655080"
  },
  {
    "text": "buffer and we can write above its area we might override the empty chunk and even the interest the interesting one if",
    "start": "1655080",
    "end": "1662519"
  },
  {
    "text": "you look at the interesting structure we will find out that it contains callback function",
    "start": "1662519",
    "end": "1667600"
  },
  {
    "text": "PTR by overriding this kind of pointer when the program will try to execute the code at that pointer we will be able to",
    "start": "1667600",
    "end": "1674399"
  },
  {
    "text": "execute a code of our choice more in general e overflow might",
    "start": "1674399",
    "end": "1680200"
  },
  {
    "text": "also lead to arbitrary behaviors such as do PE and Etc in our case the example",
    "start": "1680200",
    "end": "1685840"
  },
  {
    "text": "I've showed slide before shows exactly what happened in our program we've got our buffer our empty chunk the interesting",
    "start": "1685840",
    "end": "1694399"
  },
  {
    "text": "structure and a call pointer to",
    "start": "1694399",
    "end": "1699240"
  },
  {
    "text": "override we've managed to exploit the varability in an unstable and statistic way but as you can see it illustrate the",
    "start": "1700440",
    "end": "1707080"
  },
  {
    "text": "potential of it we've managed to listen on PX IOD as a bind shell and of course a motivated attacker could Implement",
    "start": "1707080",
    "end": "1713480"
  },
  {
    "text": "such attack to access into the land over the ostp",
    "start": "1713480",
    "end": "1717799"
  },
  {
    "text": "communication after the findings of different vulnerabilities we wanted to create the fing framework that will",
    "start": "1719720",
    "end": "1724799"
  },
  {
    "text": "allow us to assess different osdp devices and implementations using the framework we",
    "start": "1724799",
    "end": "1730320"
  },
  {
    "text": "were able to detect several more vulnerabilities which will be discussed later on some research has already been done",
    "start": "1730320",
    "end": "1737279"
  },
  {
    "text": "around serial f for example the project of IC Village from Defcon but still it's",
    "start": "1737279",
    "end": "1742399"
  },
  {
    "text": "not commonly rare our assessment tool is in the",
    "start": "1742399",
    "end": "1747559"
  },
  {
    "text": "existing architecture just sit in the middle of the comp on the middle man computer by inspecting the packets we",
    "start": "1747559",
    "end": "1754360"
  },
  {
    "text": "have the C to implement different features over it and for those of you of you who wondering in the upcoming future",
    "start": "1754360",
    "end": "1761679"
  },
  {
    "text": "the tool will be released as an open source here we have just a short and",
    "start": "1761679",
    "end": "1767120"
  },
  {
    "text": "quick brief to the ACT ual tool with all its features but due to the short time I won't dive into",
    "start": "1767120",
    "end": "1774039"
  },
  {
    "text": "it the features the feature that I will be focusing on is the mutation fuz in",
    "start": "1774039",
    "end": "1780440"
  },
  {
    "text": "the example below we can see a simple mutation of message code 50 which basically for each message that arrives",
    "start": "1780440",
    "end": "1786799"
  },
  {
    "text": "and being processed by the fer its message code changes to",
    "start": "1786799",
    "end": "1792480"
  },
  {
    "text": "50 so let's take a look at the main features among the mutation fuzer first",
    "start": "1793279",
    "end": "1798880"
  },
  {
    "text": "there are many available fuzing Primitives the development process of New Primitives is very short and simple",
    "start": "1798880",
    "end": "1805480"
  },
  {
    "text": "as you can see in the picture each function defines new primitive and also the fer is backed up",
    "start": "1805480",
    "end": "1811640"
  },
  {
    "text": "by a logger which logs every step on the way including rushes that are being",
    "start": "1811640",
    "end": "1817360"
  },
  {
    "text": "detected here we can see another example of the fuzer with some random mutations remove payload random message code and",
    "start": "1817880",
    "end": "1826960"
  },
  {
    "text": "Etc covering three zero days viabilities we discovered including two Hep over for",
    "start": "1826960",
    "end": "1832360"
  },
  {
    "text": "variabilities on the controller will prove that this kind of attacker are already feasible",
    "start": "1832360",
    "end": "1839518"
  },
  {
    "text": "nowadays so let's dive into the first vulnerability as part of message code 50",
    "start": "1839679",
    "end": "1845440"
  },
  {
    "text": "the program allocates a buffer the size of that allocated buffer is calculated based on the payload of the message",
    "start": "1845440",
    "end": "1851480"
  },
  {
    "text": "using OB DP get message data size function let's assume the calculated size is 10 XEL simply our buffer will be",
    "start": "1851480",
    "end": "1859600"
  },
  {
    "text": "allocated accordingly now let's see what happened when we send message code 50 XA pcket",
    "start": "1859600",
    "end": "1866440"
  },
  {
    "text": "without payload the function tries again to calculate the size of the buffer to",
    "start": "1866440",
    "end": "1871559"
  },
  {
    "text": "allocate but this time we received a negative number and a",
    "start": "1871559",
    "end": "1877320"
  },
  {
    "text": "crush so what just happened off thep get message data size",
    "start": "1877320",
    "end": "1882679"
  },
  {
    "text": "Le on signed number when calling malok the signed number casted to unsigned",
    "start": "1882679",
    "end": "1887919"
  },
  {
    "text": "resulting a huge number as a result when Malo tries to allocate that that amount",
    "start": "1887919",
    "end": "1893080"
  },
  {
    "text": "of bytes the program crashes we also observed G V output which indicates as well about that",
    "start": "1893080",
    "end": "1901279"
  },
  {
    "text": "crash here we can see the fer detect the crush I've just explained on green we have our message code and right after it",
    "start": "1901760",
    "end": "1908200"
  },
  {
    "text": "on red the check some without any pay between them in the following video we will see",
    "start": "1908200",
    "end": "1915360"
  },
  {
    "text": "the how the CP actually crash in real time and stop receiving input from the",
    "start": "1915360",
    "end": "1921159"
  },
  {
    "text": "PD now let's take a look over the second Crush which by a coincidence in is in matches called 50x as well it's for",
    "start": "1935440",
    "end": "1943440"
  },
  {
    "text": "saying that there is no connection between the two variabilities except sharing the same message code",
    "start": "1943440",
    "end": "1948960"
  },
  {
    "text": "so as part of processing the payload the following happens the function calculates a value based on the payload",
    "start": "1948960",
    "end": "1955120"
  },
  {
    "text": "data on indexes three and four the calculation formula is simple as shown it multiplies the fourth bite with one",
    "start": "1955120",
    "end": "1961960"
  },
  {
    "text": "hand under the xas and adds the third by to it next the program iterates starting",
    "start": "1961960",
    "end": "1968840"
  },
  {
    "text": "from the payload of the pcket all the way through the payload of the pcket plus the calculated",
    "start": "1968840",
    "end": "1975039"
  },
  {
    "text": "value for each index if its value is divided by 8 it will override",
    "start": "1975039",
    "end": "1980519"
  },
  {
    "text": "it when iterating huge range as shown above we will get an e overflow which potentially might over crucial data that",
    "start": "1980519",
    "end": "1987760"
  },
  {
    "text": "will cause arbitary behaviors of the",
    "start": "1987760",
    "end": "1991799"
  },
  {
    "text": "process okay so to summarize it is clear the new risk that are em emerging from",
    "start": "1993679",
    "end": "2001159"
  },
  {
    "text": "the osdp and we were not used to see this kind of risk before and this is only the",
    "start": "2001159",
    "end": "2008760"
  },
  {
    "text": "beginning because OSP is a relatively new protocol and it will continue to",
    "start": "2008760",
    "end": "2014039"
  },
  {
    "text": "evolve and include more functionalities and obviously vendors will leverage its",
    "start": "2014039",
    "end": "2020120"
  },
  {
    "text": "flexibility and already doing it uh for allowing proprietary functionalities of",
    "start": "2020120",
    "end": "2025559"
  },
  {
    "text": "their own I guess we're also going to see more and more opportunities for new attack",
    "start": "2025559",
    "end": "2031639"
  },
  {
    "text": "Scar and so might not even require an attacker to open the readers's physical",
    "start": "2031639",
    "end": "2037159"
  },
  {
    "text": "box or even Target the security server directly so there is a lot of potential",
    "start": "2037159",
    "end": "2044679"
  },
  {
    "text": "for new kind of attacks in OSP but if we take a few uh",
    "start": "2044679",
    "end": "2051878"
  },
  {
    "text": "precautions uh we might reduce significantly any risk from the attacks",
    "start": "2051879",
    "end": "2057118"
  },
  {
    "text": "that we've discussed so far and also from future attacks that might come uh",
    "start": "2057119",
    "end": "2062878"
  },
  {
    "text": "in the near future first we must remember that OSP",
    "start": "2062879",
    "end": "2068358"
  },
  {
    "text": "is new and it is not perfect it is defending from non attacks",
    "start": "2068359",
    "end": "2075440"
  },
  {
    "text": "and as long it is configured as it is configured carefully it is pretty much",
    "start": "2075440",
    "end": "2080599"
  },
  {
    "text": "doing the job but it should not be trusted blindly and for most users we",
    "start": "2080599",
    "end": "2085800"
  },
  {
    "text": "still recommend uh using a camera or making sure the guard is is veryy no one",
    "start": "2085800",
    "end": "2092280"
  },
  {
    "text": "is playing with readers second s connections in general",
    "start": "2092280",
    "end": "2099079"
  },
  {
    "text": "while they are not commonly addressed as part of Standard Security audits some of them should and please make sure to",
    "start": "2099079",
    "end": "2106119"
  },
  {
    "text": "verify they are at least not exposed to the public and better be just addressed",
    "start": "2106119",
    "end": "2111560"
  },
  {
    "text": "similarly to exposed ethernet connections when possible and third working on proper",
    "start": "2111560",
    "end": "2119720"
  },
  {
    "text": "monitoring and control logs can uh provide a lot of information that can indicate",
    "start": "2119720",
    "end": "2126320"
  },
  {
    "text": "compromise uh can assist with detecting different attacks many of the attacks that we mention here and assessing the",
    "start": "2126320",
    "end": "2132680"
  },
  {
    "text": "quality of products can also reduce a lot of risks and low hanging FR just waiting for attackers to",
    "start": "2132680",
    "end": "2141559"
  },
  {
    "text": "exploit of course Ariel mentioned our main the middle Tool uh this tool can assist with assessing these devices on",
    "start": "2142760",
    "end": "2150480"
  },
  {
    "text": "your lab or as a vendor and we recommend using it as automated way to assess",
    "start": "2150480",
    "end": "2156720"
  },
  {
    "text": "different solutions thank you for listening and please feel",
    "start": "2156720",
    "end": "2162079"
  },
  {
    "text": "free to contact any of us for any additional questions or comments and uh",
    "start": "2162079",
    "end": "2167280"
  },
  {
    "text": "stay stay safe thank you",
    "start": "2167280",
    "end": "2174240"
  }
]