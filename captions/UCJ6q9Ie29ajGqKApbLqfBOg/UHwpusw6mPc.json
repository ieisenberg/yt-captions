[
  {
    "start": "0",
    "end": "150000"
  },
  {
    "text": "hi everyone welcome I am Thomas Cohen and I mean I'm walking at wix.com",
    "start": "30",
    "end": "7290"
  },
  {
    "text": "currently leading the iron D security team me and my team are responsible for",
    "start": "7290",
    "end": "12870"
  },
  {
    "text": "all physical security aspects of all productions operations including the",
    "start": "12870",
    "end": "18510"
  },
  {
    "text": "application the infrastructure instant response and everything um",
    "start": "18510",
    "end": "23519"
  },
  {
    "text": "and I'm here to talk about hi about how to create a botnet by abusing Chrome",
    "start": "23519",
    "end": "30179"
  },
  {
    "text": "extensions um and I won't start with my personal and my personal experience so",
    "start": "30179",
    "end": "36840"
  },
  {
    "text": "the first big challenge me and my team had to add with the bots was on April 2",
    "start": "36840",
    "end": "42980"
  },
  {
    "text": "2016 it was a regular there in the office and suddenly a dramatic increase",
    "start": "42980",
    "end": "49559"
  },
  {
    "text": "in the new user signup event rate happened so that this basically means",
    "start": "49559",
    "end": "56550"
  },
  {
    "text": "that a lot of users are sign up a lot more than in planned unusual and and we",
    "start": "56550",
    "end": "64198"
  },
  {
    "text": "started checking things and we saw that all these requests are not originated in the same ip or even country so we",
    "start": "64199",
    "end": "72240"
  },
  {
    "text": "started to understand that we are coping with what we generally call a bot attack",
    "start": "72240",
    "end": "78409"
  },
  {
    "text": "now before we dive into their instant interesting part of this attack few",
    "start": "78409",
    "end": "83939"
  },
  {
    "text": "words about BOTS so um according to a Imperva the",
    "start": "83939",
    "end": "92159"
  },
  {
    "text": "majority of the traffic in the Internet today is done by BOTS most boats are bad",
    "start": "92159",
    "end": "97560"
  },
  {
    "text": "BOTS and most of the bad boards impersonators impersonators out bots",
    "start": "97560",
    "end": "104009"
  },
  {
    "text": "that that fake user human behavior in",
    "start": "104009",
    "end": "109530"
  },
  {
    "text": "websites and they cause big headaches to internet companies because they they",
    "start": "109530",
    "end": "114990"
  },
  {
    "text": "blend into the websites a regular traffic and make it very hard and do",
    "start": "114990",
    "end": "120719"
  },
  {
    "text": "malicious stuff and make it very very hard for for for the for the website to",
    "start": "120719",
    "end": "126479"
  },
  {
    "text": "distinguish distinguish between the legit request and the bottle quest",
    "start": "126479",
    "end": "132920"
  },
  {
    "text": "so back in our vector attack we started investigated deeper what what",
    "start": "133620",
    "end": "140530"
  },
  {
    "text": "is the original origin of this request and we found few patterns so and this is",
    "start": "140530",
    "end": "149050"
  },
  {
    "text": "what we knew during the investigation of this attack the first thing that we",
    "start": "149050",
    "end": "154210"
  },
  {
    "start": "150000",
    "end": "150000"
  },
  {
    "text": "noticed is that most of the increase in",
    "start": "154210",
    "end": "159820"
  },
  {
    "text": "the sign up event is is originated in Latin America countries and it was this",
    "start": "159820",
    "end": "166900"
  },
  {
    "text": "was where very will because it was in high numbers and as well as most of the",
    "start": "166900",
    "end": "172560"
  },
  {
    "text": "even almost all of the clients were coming with chrome with Google Chrome",
    "start": "172560",
    "end": "179070"
  },
  {
    "text": "second things we've noticed that for some reason I mean we did not know the",
    "start": "179070",
    "end": "184720"
  },
  {
    "text": "reason at the time the signup form used to say to send the signup request to to",
    "start": "184720",
    "end": "194170"
  },
  {
    "text": "to our servers was inside it was in a frame inside a facebook tab there was a",
    "start": "194170",
    "end": "201040"
  },
  {
    "text": "facebook tab and we saw that the requests are coming from a frame that within is within the Facebook tab we",
    "start": "201040",
    "end": "207250"
  },
  {
    "text": "didn't understand like I said what it means or it meant but we'll see in a second why it was like this third thing",
    "start": "207250",
    "end": "214570"
  },
  {
    "text": "that we saw so little into about weeks weeks is a website creation platform",
    "start": "214570",
    "end": "220450"
  },
  {
    "text": "anyone the Internet can come a sign and sign up and create his own website for",
    "start": "220450",
    "end": "226030"
  },
  {
    "text": "free and so what we've noticed is that a lot of users that sign up to a new",
    "start": "226030",
    "end": "234820"
  },
  {
    "text": "account and win weeks and only a 10 seconds after the signup event we see",
    "start": "234820",
    "end": "240280"
  },
  {
    "text": "that the user publishes a new week's website now this is real because and ten",
    "start": "240280",
    "end": "247060"
  },
  {
    "text": "seconds is obviously not enough to edit your website and then publish it so we",
    "start": "247060",
    "end": "252160"
  },
  {
    "text": "this is the this is the point when when we got a good pattern and we started to to distinguish distinguish between the",
    "start": "252160",
    "end": "259420"
  },
  {
    "text": "legit requests of users and this bot requests and so we went",
    "start": "259420",
    "end": "265970"
  },
  {
    "text": "I went and and looked what were these websites abou about and this is what we",
    "start": "265970",
    "end": "272870"
  },
  {
    "text": "found all the websites that were create in this way in that tent the second",
    "start": "272870",
    "end": "278210"
  },
  {
    "text": "pattern led to an attack page when this is in English and what we see in here is",
    "start": "278210",
    "end": "286700"
  },
  {
    "text": "there is a common scam attack page it says that if you want to see who looked",
    "start": "286700",
    "end": "293390"
  },
  {
    "text": "at your profile at Facebook you can install a Chrome extension and and see",
    "start": "293390",
    "end": "300290"
  },
  {
    "text": "who who view your profile as a bonus by the way you can also always see what is",
    "start": "300290",
    "end": "305750"
  },
  {
    "text": "the meaning of your name if you want but let's let's go anyway let's click on",
    "start": "305750",
    "end": "311240"
  },
  {
    "text": "start and see what we get so we click on start and we do get to",
    "start": "311240",
    "end": "318680"
  },
  {
    "text": "the real Google Chrome Web Store okay this is the original Google Chrome Web",
    "start": "318680",
    "end": "323720"
  },
  {
    "text": "Store it has an extension called Viad 30 something we didn't recognize this",
    "start": "323720",
    "end": "331280"
  },
  {
    "text": "extension and but we needs to edit stone that this attack has to do with this",
    "start": "331280",
    "end": "336350"
  },
  {
    "text": "extension so we started investigating the extension and following the code the",
    "start": "336350",
    "end": "343880"
  },
  {
    "text": "code was highly appreciated and we we had help from some guy from a lot of",
    "start": "343880",
    "end": "350960"
  },
  {
    "text": "guys including parameter X which is a company and that fights bots that we use and this is what we found",
    "start": "350960",
    "end": "359979"
  },
  {
    "start": "360000",
    "end": "360000"
  },
  {
    "text": "once the extension is installed the first thing it does is inject code into",
    "start": "360580",
    "end": "366620"
  },
  {
    "text": "Facebook tab and now Chrome extensions are with the with proper permissions",
    "start": "366620",
    "end": "371900"
  },
  {
    "text": "like this one has have the ability to inject JavaScript code into tabs so the",
    "start": "371900",
    "end": "380120"
  },
  {
    "text": "first thing that this extension does is inject code into Facebook why Facebook I guess because everyone is on Facebook",
    "start": "380120",
    "end": "385910"
  },
  {
    "text": "all the time and other reasons we'll see in a minute next thing it does the code",
    "start": "385910",
    "end": "392390"
  },
  {
    "text": "that is injected into the Facebook tab opens a week's iframe this is what we",
    "start": "392390",
    "end": "397849"
  },
  {
    "text": "saw before and this iframe is transparent the victim user does not see anything is",
    "start": "397849",
    "end": "404870"
  },
  {
    "text": "that you cannot notice anything but the frame is is reading two weeks signup",
    "start": "404870",
    "end": "411860"
  },
  {
    "text": "form then from within the frame and attacks",
    "start": "411860",
    "end": "417110"
  },
  {
    "text": "request is is fired to our two weeks sign up a serval now one quick question",
    "start": "417110",
    "end": "425720"
  },
  {
    "text": "why would the attacker even need to open a weeks iframe I mean he has the ability of an extension he can inject just",
    "start": "425720",
    "end": "432230"
  },
  {
    "text": "inject code into Facebook and then send request the signup request two weeks from Facebook tab to week server this is",
    "start": "432230",
    "end": "439400"
  },
  {
    "text": "the extension is able to do that to do it because it does not have the limitation of course origin request of",
    "start": "439400",
    "end": "446890"
  },
  {
    "text": "same origin sorry now the answer here is",
    "start": "446890",
    "end": "451970"
  },
  {
    "text": "that because of this we have basic or",
    "start": "451970",
    "end": "457370"
  },
  {
    "text": "even more than basic bot detection system and if you if the attacker just",
    "start": "457370",
    "end": "463580"
  },
  {
    "text": "send a design up request just from any tab on the Internet it fails because this request does not",
    "start": "463580",
    "end": "471260"
  },
  {
    "text": "have the right the proper cookies and headers and access tokens and and things",
    "start": "471260",
    "end": "477290"
  },
  {
    "text": "that we do in the signup form before the user comes to the signup a endpoint so",
    "start": "477290",
    "end": "483830"
  },
  {
    "text": "this is this fails however and if okay",
    "start": "483830",
    "end": "493010"
  },
  {
    "text": "so once somewhat small thing the attacker wants to send the request to",
    "start": "493010",
    "end": "498050"
  },
  {
    "text": "sign up to the - - - the sign observable from the page that runs the signup form but extension but he but you don't want",
    "start": "498050",
    "end": "507350"
  },
  {
    "text": "to open a new tab to the victim because the this will be visible to the user and there are no invisible tabs in chrome so",
    "start": "507350",
    "end": "515210"
  },
  {
    "text": "if you want to open new tab the user has to see it so instead of that the attacker just injected code into",
    "start": "515210",
    "end": "521750"
  },
  {
    "text": "Facebook that creates an iframe of which signup form in the Facebook page and",
    "start": "521750",
    "end": "529420"
  },
  {
    "text": "when the request is sent for with in this with this I framed the",
    "start": "529420",
    "end": "535160"
  },
  {
    "text": "succeeds now I remind you that this iframe was it was entirely transparent so the user did",
    "start": "535160",
    "end": "542310"
  },
  {
    "text": "not notice anything but his browser his Facebook tab sent a sign-up request two weeks and it",
    "start": "542310",
    "end": "548850"
  },
  {
    "text": "worked okay let's go back to the extension course of action go on with",
    "start": "548850",
    "end": "554280"
  },
  {
    "text": "that so we saw that that it was inject code into Facebook then open a week's",
    "start": "554280",
    "end": "559470"
  },
  {
    "text": "iframe then send the signup request from within the frame and the next thing he",
    "start": "559470",
    "end": "565620"
  },
  {
    "text": "does is after signing up a new a new week's user it publishes a new website",
    "start": "565620",
    "end": "571080"
  },
  {
    "text": "now all the websites lead to one page that we saw before",
    "start": "571080",
    "end": "576890"
  },
  {
    "text": "this website has a newly created URL and the extension then takes this URL and",
    "start": "576890",
    "end": "585080"
  },
  {
    "text": "distribute the link the you this URL the attack page URL of the week's web site",
    "start": "585080",
    "end": "590550"
  },
  {
    "text": "among all Facebook friends of the victim using Facebook messaging the last thing",
    "start": "590550",
    "end": "598890"
  },
  {
    "text": "that this extension does after this distribution phase is submitting is",
    "start": "598890",
    "end": "604320"
  },
  {
    "text": "using the users the victims Google Google authorization token it submits a",
    "start": "604320",
    "end": "609750"
  },
  {
    "text": "review of five stars in Google Web Store of the malicious extension okay cool so",
    "start": "609750",
    "end": "618780"
  },
  {
    "text": "this is what extended did extension did but my question here is why would the",
    "start": "618780",
    "end": "626400"
  },
  {
    "text": "attacker even need weeks in this in this campaign I mean can't he just inject",
    "start": "626400",
    "end": "632550"
  },
  {
    "text": "code to Facebook and then distribute his link to that did his attack page to to the friends of the victims why would he",
    "start": "632550",
    "end": "639870"
  },
  {
    "text": "need weeks on the way so the answer here is the tweaks was used to distribute a",
    "start": "639870",
    "end": "647760"
  },
  {
    "start": "645000",
    "end": "645000"
  },
  {
    "text": "malware and the whole part of the whole role of weeks in his campaign was just",
    "start": "647760",
    "end": "654750"
  },
  {
    "text": "was to supply disposable URLs okay the attacker did not want to send all the",
    "start": "654750",
    "end": "659940"
  },
  {
    "text": "victims the same URL that off his server his attack serval because it's easier",
    "start": "659940",
    "end": "666360"
  },
  {
    "text": "this this way it's easier for Facebook to detect adblock this attack every victim opened a new accountant in weeks",
    "start": "666360",
    "end": "673320"
  },
  {
    "text": "and created a new website and sent the new URL to his friends and then the",
    "start": "673320",
    "end": "679380"
  },
  {
    "text": "attack was fully distributed okay so",
    "start": "679380",
    "end": "684450"
  },
  {
    "text": "what will be described so far is obviously only the infection phase of this attack obviously after after the",
    "start": "684450",
    "end": "692880"
  },
  {
    "text": "infection these bots are used to gang one thing and you guessed right",
    "start": "692880",
    "end": "698430"
  },
  {
    "text": "it's money and so both masters do with this with with their botnets a lot of",
    "start": "698430",
    "end": "705000"
  },
  {
    "text": "things you're familiar with I guess and they send spam for me they're on DDoS attacks scrape website run click frauds",
    "start": "705000",
    "end": "712110"
  },
  {
    "text": "and they make money after we have to fit as many as the more boss that they have",
    "start": "712110",
    "end": "719310"
  },
  {
    "text": "they make more money of course they can also put this bot for rent and get money",
    "start": "719310",
    "end": "727320"
  },
  {
    "text": "for doing these operations for other people or on top of that you can always",
    "start": "727320",
    "end": "732500"
  },
  {
    "text": "still steal personal information or sense the information from the victims",
    "start": "732500",
    "end": "737520"
  },
  {
    "text": "and lateral move through their networks so this is what they do after after the",
    "start": "737520",
    "end": "743130"
  },
  {
    "text": "the infection phase after the campaign of the infection and I'm here to talk about the infection phase and and I want",
    "start": "743130",
    "end": "750029"
  },
  {
    "text": "to show you another example that happened just two months later at June",
    "start": "750029",
    "end": "756930"
  },
  {
    "text": "to think 2016 so in April we struggled with this this which this attack attack",
    "start": "756930",
    "end": "765660"
  },
  {
    "text": "actors for a while and in the end we blocked them but two months later and a",
    "start": "765660",
    "end": "771600"
  },
  {
    "text": "new attack came to our knowledge it was in the news and it says it said that a",
    "start": "771600",
    "end": "781589"
  },
  {
    "text": "Facebook comment tagging malware is spreading via Google Chrome and the warning is if you receive a facebook",
    "start": "781589",
    "end": "786899"
  },
  {
    "text": "notification regarding a friend tagging you in a comment be very careful because it can be a malware now this attack what",
    "start": "786899",
    "end": "794819"
  },
  {
    "text": "named tag me if you can buy you don't",
    "start": "794819",
    "end": "799949"
  },
  {
    "text": "know is researcher in Kaspersky Labs and he published a very detailed report",
    "start": "799949",
    "end": "805139"
  },
  {
    "text": "about this attack and the thing is that when I saw there it was a report on this",
    "start": "805139",
    "end": "811769"
  },
  {
    "text": "attack and you this was the same attackers that attacked us two months before how did I know it you'll see in a",
    "start": "811769",
    "end": "819119"
  },
  {
    "text": "second let's see how this attacked walked so the first thing that the",
    "start": "819119",
    "end": "824579"
  },
  {
    "text": "victim see is a notification on Facebook that a friend of his has tagged him in a",
    "start": "824579",
    "end": "830579"
  },
  {
    "text": "comment upon clicking this comment after short facebook warning that you are",
    "start": "830579",
    "end": "837389"
  },
  {
    "text": "getting out of Facebook jay-z file is immediately downloaded to the victims",
    "start": "837389",
    "end": "843959"
  },
  {
    "text": "browser now a jay-z file is a is access and executable on all Windows machines",
    "start": "843959",
    "end": "850889"
  },
  {
    "text": "and and if I'm going to the next step and I'm clicking this Jessie file and if",
    "start": "850889",
    "end": "858299"
  },
  {
    "text": "you will in the malware is run runs on my machine so what it does this malware",
    "start": "858299",
    "end": "866419"
  },
  {
    "text": "it's firstly it cause it causes Chrome to crash then it creates a copy of",
    "start": "866419",
    "end": "873629"
  },
  {
    "text": "Chrome Exe file just with a little addition a malicious extension installed on the new",
    "start": "873629",
    "end": "880679"
  },
  {
    "text": "chrome process then when the egg when chrome is reopened the extension runs",
    "start": "880679",
    "end": "888689"
  },
  {
    "text": "and does two simple things the first it uploads a new jay-z file to the victims",
    "start": "888689",
    "end": "896939"
  },
  {
    "text": "Google Drive using the Google or Google authorization token the next thing it",
    "start": "896939",
    "end": "902100"
  },
  {
    "text": "does it takes the URL one little more",
    "start": "902100",
    "end": "907350"
  },
  {
    "text": "thing it makes this file public to everyone so other victims could get this URL of the",
    "start": "907350",
    "end": "914729"
  },
  {
    "text": "jay-z file and access it so after that it takes the URL of the jay-z file",
    "start": "914729",
    "end": "920759"
  },
  {
    "text": "upload it to a Google Drive and distribute it and using Facebook",
    "start": "920759",
    "end": "926459"
  },
  {
    "text": "commenting plugin and as we saw before what it does it",
    "start": "926459",
    "end": "931740"
  },
  {
    "text": "creates a comment with a tag of all these friends that lead to the newly",
    "start": "931740",
    "end": "938070"
  },
  {
    "text": "created JC file in the victims Google Drive is that clear so one of the",
    "start": "938070",
    "end": "947930"
  },
  {
    "text": "victims friends on Facebook opens a clicks on this notification and the",
    "start": "947930",
    "end": "954180"
  },
  {
    "text": "whole thing runs over and over again and we got an exponential growth infection",
    "start": "954180",
    "end": "960330"
  },
  {
    "text": "process you must be asking yourselves",
    "start": "960330",
    "end": "969450"
  },
  {
    "text": "how did these attackers and create a notification that lead to a download of",
    "start": "969450",
    "end": "975030"
  },
  {
    "text": "a JC file so this is very interesting but it's too long for this talk you can",
    "start": "975030",
    "end": "981660"
  },
  {
    "text": "find more more details in the white paper of this dis presentation or in Donna's report in more details about",
    "start": "981660",
    "end": "989670"
  },
  {
    "text": "this attack tag me if you can very interesting so we saw two attacks I",
    "start": "989670",
    "end": "996020"
  },
  {
    "text": "promise to tell you how I knew that it were the same attackers so the",
    "start": "996020",
    "end": "1001760"
  },
  {
    "text": "extensions that were used in both the text were very similar and they use",
    "start": "1001760",
    "end": "1007120"
  },
  {
    "text": "mutual code snippets called code parts and also used in some in some cases the",
    "start": "1007120",
    "end": "1013580"
  },
  {
    "text": "same domains belonging to that these attackers this is how we knew for sure that it's the same attackers and now in",
    "start": "1013580",
    "end": "1021920"
  },
  {
    "text": "these two attacks that we saw there's a pattern okay this is this is how it goes this is also how are you recognize that",
    "start": "1021920",
    "end": "1029420"
  },
  {
    "text": "it was the same attackers it all starts with a user clicking in the first attack",
    "start": "1029420",
    "end": "1035569"
  },
  {
    "text": "it was user clicking on a Facebook and message on a second attack it was a notification then somehow an extension a",
    "start": "1035570",
    "end": "1043339"
  },
  {
    "text": "malicious chrome extension is installed on his browser and in the first attack",
    "start": "1043339",
    "end": "1049640"
  },
  {
    "text": "it was a the user had to install it from the web store in a second attack and executable the JC file created the sixth",
    "start": "1049640",
    "end": "1056840"
  },
  {
    "text": "install this extension next thing the extension runs and create a new malicious payload instance",
    "start": "1056840",
    "end": "1063950"
  },
  {
    "text": "in the weeks attack it was a new Wix website that that that offers you to",
    "start": "1063950",
    "end": "1070220"
  },
  {
    "text": "install the extension in a second attack it was a JC file upload to it uploaded",
    "start": "1070220",
    "end": "1075410"
  },
  {
    "text": "to the users Google Drive then it always takes the URL of the newly of the newly",
    "start": "1075410",
    "end": "1080660"
  },
  {
    "text": "created payload instance and send it somehow among to all Facebook friends of",
    "start": "1080660",
    "end": "1086690"
  },
  {
    "text": "the victim can be with messages or notifications one as we saw before one",
    "start": "1086690",
    "end": "1092000"
  },
  {
    "text": "of the fu victims friends click and then the whole thing runs over and over again",
    "start": "1092000",
    "end": "1099250"
  },
  {
    "text": "now the company's abused in these two campaigns and we reviewed are not mine",
    "start": "1099250",
    "end": "1106850"
  },
  {
    "text": "of companies right we are talking about Facebook Google and vidcom and the three",
    "start": "1106850",
    "end": "1112160"
  },
  {
    "start": "1107000",
    "end": "1107000"
  },
  {
    "text": "of them the this magical bot somehow comes and defeats their body detection",
    "start": "1112160",
    "end": "1118400"
  },
  {
    "text": "systems of all these companies all day all the company all the em the services",
    "start": "1118400",
    "end": "1123620"
  },
  {
    "text": "that we were discussing discussing upload a file to Google Drive send fed",
    "start": "1123620",
    "end": "1129890"
  },
  {
    "text": "with Facebook messages it all have bought protection mechanisms on them so how why why do common bot common BOTS",
    "start": "1129890",
    "end": "1138590"
  },
  {
    "text": "fail to bypass this protection and these BOTS succeeds so let's have a second to",
    "start": "1138590",
    "end": "1145280"
  },
  {
    "text": "analyze what makes a good bot so the goal of good bot is to look as human as",
    "start": "1145280",
    "end": "1153680"
  },
  {
    "start": "1147000",
    "end": "1147000"
  },
  {
    "text": "he can right it has to the good but will",
    "start": "1153680",
    "end": "1158900"
  },
  {
    "text": "want website to think that he is a human that is sitting on his computer and surfing at the Internet using his",
    "start": "1158900",
    "end": "1165500"
  },
  {
    "text": "browser right so um and how do popular",
    "start": "1165500",
    "end": "1174020"
  },
  {
    "text": "bot protection techniques walk okay the first thing that what protection mechanism a challenge BOTS to what BOTS",
    "start": "1174020",
    "end": "1182240"
  },
  {
    "text": "with is JavaScript most boss today run JavaScript but you can always create a",
    "start": "1182240",
    "end": "1189860"
  },
  {
    "text": "tailor-made JavaScript calculation to a client ending on his version of the version",
    "start": "1189860",
    "end": "1196700"
  },
  {
    "text": "that he claims he is for example if I if I'm claiming that I'm running a chrome",
    "start": "1196700",
    "end": "1202340"
  },
  {
    "text": "in some version there are specific JavaScript challenges that can be that",
    "start": "1202340",
    "end": "1208160"
  },
  {
    "text": "can be given to the twist client and and if it's a if if it's if it's not a real",
    "start": "1208160",
    "end": "1214280"
  },
  {
    "text": "home chrome browser it the odds are that he will not succeed now this problem is",
    "start": "1214280",
    "end": "1220940"
  },
  {
    "text": "solved he solved in our case right because Dex our extension is running as",
    "start": "1220940",
    "end": "1226330"
  },
  {
    "text": "sorry our bot is running as a Chrome extension which runs inside chrome so",
    "start": "1226330",
    "end": "1232940"
  },
  {
    "text": "you can give us you can give this bot whatever JavaScript challenges that you",
    "start": "1232940",
    "end": "1238520"
  },
  {
    "text": "want he will we will cope with it successfully the second thing is what I",
    "start": "1238520",
    "end": "1245330"
  },
  {
    "text": "like to call human context so this includes a lot of stuff for exam for",
    "start": "1245330",
    "end": "1252140"
  },
  {
    "text": "example a mouse movement and keystrokes and all the human behavior that that",
    "start": "1252140",
    "end": "1258230"
  },
  {
    "text": "involves when you surf the Internet in addition it also um the user context",
    "start": "1258230",
    "end": "1267320"
  },
  {
    "text": "here is very important as we saw in weeks if you just there's a flow of of",
    "start": "1267320",
    "end": "1273190"
  },
  {
    "text": "events that should happen when a user for instance signing up to two to two",
    "start": "1273190",
    "end": "1280520"
  },
  {
    "text": "apps to a way to story to a website first it has to go through the signup form and only then he can send a signup",
    "start": "1280520",
    "end": "1287240"
  },
  {
    "text": "request um so this bot need to somehow",
    "start": "1287240",
    "end": "1294050"
  },
  {
    "text": "get into context of a real user now the best way to get into a context of a user",
    "start": "1294050",
    "end": "1300950"
  },
  {
    "text": "is to inject JavaScript code into the users active tabs right if i if I'm able",
    "start": "1300950",
    "end": "1307280"
  },
  {
    "text": "to put my code into the users real active tabs that you walk with for",
    "start": "1307280",
    "end": "1312860"
  },
  {
    "text": "example Facebook I can get his context and with the site um and this is",
    "start": "1312860",
    "end": "1322429"
  },
  {
    "text": "actually what browser extensions are all about getting the context of the user",
    "start": "1322429",
    "end": "1328670"
  },
  {
    "text": "injecting JavaScript into active tabs now if you ask yourselves how didn't how",
    "start": "1328670",
    "end": "1335090"
  },
  {
    "text": "did Facebook and Google and not block this attack or block extensions from",
    "start": "1335090",
    "end": "1342740"
  },
  {
    "text": "doing this these operations the answer is that it's not a bug it's a feature if",
    "start": "1342740",
    "end": "1350210"
  },
  {
    "text": "you think about it extensions should be able to do all these kind of stuff to",
    "start": "1350210",
    "end": "1356000"
  },
  {
    "text": "send send Facebook messages and upload a a and upload a file to Google Drive and",
    "start": "1356000",
    "end": "1361670"
  },
  {
    "text": "and actually anything else that people wants to have a on the Internet in with",
    "start": "1361670",
    "end": "1366740"
  },
  {
    "text": "Chrome with extensions so this and this",
    "start": "1366740",
    "end": "1374390"
  },
  {
    "text": "makes BOTS that ran on on browser extensions very power very powerful tool",
    "start": "1374390",
    "end": "1381160"
  },
  {
    "text": "let's have a second to see the to understand the full capabilities of an",
    "start": "1381160",
    "end": "1387620"
  },
  {
    "text": "extension let's have a second to see there to review the manifest file of the",
    "start": "1387620",
    "end": "1393440"
  },
  {
    "start": "1392000",
    "end": "1392000"
  },
  {
    "text": "extension that we saw before attacking weeks so in the red and the word frame",
    "start": "1393440",
    "end": "1401540"
  },
  {
    "text": "you can see the name of the extension viadon Locker and they that these",
    "start": "1401540",
    "end": "1406880"
  },
  {
    "text": "attackers used a name of an already existing extension that was already in",
    "start": "1406880",
    "end": "1413870"
  },
  {
    "text": "the in the store I guess they as they figured out that it's easier that way to",
    "start": "1413870",
    "end": "1418940"
  },
  {
    "text": "pass Google's screening process in the webstore so what we see here and this is",
    "start": "1418940",
    "end": "1424760"
  },
  {
    "text": "the most important part of the manifest it has a permission to to fire",
    "start": "1424760",
    "end": "1431060"
  },
  {
    "text": "cross-origin requests to any destination he wants on the internet and this also",
    "start": "1431060",
    "end": "1437240"
  },
  {
    "text": "allows this extension to inject JavaScript code into any tab of the URL",
    "start": "1437240",
    "end": "1443390"
  },
  {
    "text": "that the user is using what else we have access to all user cookies in all tabs",
    "start": "1443390",
    "end": "1449840"
  },
  {
    "text": "that by the way includes also HTTP only cookies next thing we see is that the",
    "start": "1449840",
    "end": "1457490"
  },
  {
    "text": "extension had has a back on script back on script runs in",
    "start": "1457490",
    "end": "1463180"
  },
  {
    "text": "the background once the extension is installed and let's have a look at this get that script what we see here so this",
    "start": "1463180",
    "end": "1473290"
  },
  {
    "start": "1468000",
    "end": "1468000"
  },
  {
    "text": "background script is actually the command and control system of the attacker I'll explain let's see what it does so",
    "start": "1473290",
    "end": "1480190"
  },
  {
    "text": "first every time it adds it adds a listener that is triggered every time a tab tab is is updated any energy on any",
    "start": "1480190",
    "end": "1490690"
  },
  {
    "text": "change on a tab and then it goes to a server belonging to that Tucker this is",
    "start": "1490690",
    "end": "1496210"
  },
  {
    "text": "what what you see here and gets a file called data dot GS which is the commands",
    "start": "1496210",
    "end": "1502120"
  },
  {
    "text": "file to this bot from the attacker server then it takes this data j as a",
    "start": "1502120",
    "end": "1509850"
  },
  {
    "text": "script from the attacker service and eggs and using the chrome API tabs a",
    "start": "1509850",
    "end": "1515550"
  },
  {
    "text": "copy I tabs dot execute script it runs it on the active tab so this actually",
    "start": "1515550",
    "end": "1525780"
  },
  {
    "text": "make this bot not static I mean the attacker is able to adjust his attack",
    "start": "1525780",
    "end": "1533800"
  },
  {
    "text": "all the time he can always change the a commands file that is that is served to",
    "start": "1533800",
    "end": "1541780"
  },
  {
    "text": "his boss he can also create a commands file specifically for every domain that",
    "start": "1541780",
    "end": "1547480"
  },
  {
    "text": "is updated for example I want to send a send messages on facebook and I want to",
    "start": "1547480",
    "end": "1552910"
  },
  {
    "text": "upload if I'm on Google I want to upload the file or whatever and this makes this",
    "start": "1552910",
    "end": "1560380"
  },
  {
    "text": "is a very powerful thing because it allows the attacker to change his attack",
    "start": "1560380",
    "end": "1566410"
  },
  {
    "text": "according to to what happens for example I told you before that we had we saw",
    "start": "1566410",
    "end": "1573550"
  },
  {
    "text": "that users that only ten seconds after the sign up they publish the site so we",
    "start": "1573550",
    "end": "1579700"
  },
  {
    "text": "set out to ourselves okay that's easy let's just unpublish a web sites that",
    "start": "1579700",
    "end": "1585430"
  },
  {
    "text": "are published only less than 20 seconds after the sign up event and we started",
    "start": "1585430",
    "end": "1591820"
  },
  {
    "text": "I'll publish this we this website and the attacked stopped for about half an hour and then the",
    "start": "1591820",
    "end": "1598750"
  },
  {
    "text": "attacker just changed the commands file to run to like have a randomized timeout",
    "start": "1598750",
    "end": "1605320"
  },
  {
    "text": "between the sign up link event and and and the published website event all",
    "start": "1605320",
    "end": "1613929"
  },
  {
    "text": "these makes browser extension the perfect but it can struggle it can cope",
    "start": "1613929",
    "end": "1620559"
  },
  {
    "text": "with any JavaScript challenge it can run it can inject code in the context of the",
    "start": "1620559",
    "end": "1626559"
  },
  {
    "text": "user the thing is that it's just too",
    "start": "1626559",
    "end": "1635679"
  },
  {
    "text": "much work right I mean this campaigns a",
    "start": "1635679",
    "end": "1641070"
  },
  {
    "start": "1637000",
    "end": "1637000"
  },
  {
    "text": "required much effort from these attackers to run and if they had to if",
    "start": "1641070",
    "end": "1648700"
  },
  {
    "text": "you want to distribute your own malicious extension you have to somehow pass the screening process of Google Web",
    "start": "1648700",
    "end": "1656950"
  },
  {
    "text": "Store and and smuggle your malicious extension into the store after that you",
    "start": "1656950",
    "end": "1663309"
  },
  {
    "text": "have to somehow persuade and convince victim users to install this extension",
    "start": "1663309",
    "end": "1669760"
  },
  {
    "text": "or in the other hand which is complicated as well somehow one executable on on these victims also once",
    "start": "1669760",
    "end": "1679720"
  },
  {
    "text": "if your malicious extension is in the Google Web Store once you have your extension is revealed as malicious",
    "start": "1679720",
    "end": "1687149"
  },
  {
    "text": "Google remotely and installs your extension from all connected devices so",
    "start": "1687149",
    "end": "1694179"
  },
  {
    "text": "you lose all the bots that you collected so how can we make it easier the thing",
    "start": "1694179",
    "end": "1705159"
  },
  {
    "start": "1700000",
    "end": "1700000"
  },
  {
    "text": "is that to get the abilities of an extension we don't necessarily have to create and distribute our own malicious",
    "start": "1705159",
    "end": "1712899"
  },
  {
    "text": "extension if we just had an ability to run JavaScript in the context of Chrome",
    "start": "1712899",
    "end": "1720880"
  },
  {
    "text": "extensions that will be enough right okay running",
    "start": "1720880",
    "end": "1726610"
  },
  {
    "text": "javascript in the context of web application I know XSS so instead of",
    "start": "1726610",
    "end": "1734530"
  },
  {
    "text": "explaining the difference between exercising webpages and extensions let's just have a look at some recent examples",
    "start": "1734530",
    "end": "1740500"
  },
  {
    "text": "and the first example I want show here is the Adobe Acrobat extension exercise",
    "start": "1740500",
    "end": "1746740"
  },
  {
    "start": "1744000",
    "end": "1744000"
  },
  {
    "text": "now this extension aims to allow users to turn to convert any web page into a",
    "start": "1746740",
    "end": "1752799"
  },
  {
    "text": "PDF file and on January 16 while it had",
    "start": "1752799",
    "end": "1758230"
  },
  {
    "text": "30 million installations by the way the Adobe installed it automatically without",
    "start": "1758230",
    "end": "1765400"
  },
  {
    "text": "users awareness on on all devices that had Ted Adobe Acrobat Reader on it",
    "start": "1765400",
    "end": "1771400"
  },
  {
    "text": "that's why it got so many users 30 million users just fought for",
    "start": "1771400",
    "end": "1777549"
  },
  {
    "text": "proportions and the mere ibotta tech",
    "start": "1777549",
    "end": "1782610"
  },
  {
    "text": "that was the largest attack the bullet about a tech that was not was noticed is",
    "start": "1782610",
    "end": "1789130"
  },
  {
    "text": "estimated to be tens of millions of devices so it's the the same numbers",
    "start": "1789130",
    "end": "1796059"
  },
  {
    "text": "more or less and so on general 16 well it had 30 million installations and a",
    "start": "1796059",
    "end": "1803320"
  },
  {
    "text": "researcher from Google project zero Tabby's Oh Mandi and reported this",
    "start": "1803320",
    "end": "1811690"
  },
  {
    "text": "extension is vulnerable to dom-based xss now this is a services report I can I",
    "start": "1811690",
    "end": "1820210"
  },
  {
    "text": "know that you don't see a lot of a lot of it but it included a POC code we can",
    "start": "1820210",
    "end": "1826210"
  },
  {
    "text": "see that the directive or ability lies in an extension page called frame dot",
    "start": "1826210",
    "end": "1834340"
  },
  {
    "text": "HTML and our payload is here inside a parameter called message and if we put",
    "start": "1834340",
    "end": "1840700"
  },
  {
    "text": "HTML here at this the this runs on the X",
    "start": "1840700",
    "end": "1845919"
  },
  {
    "text": "extension page now it's one ability almost allowed Universal XSS and but it",
    "start": "1845919",
    "end": "1854919"
  },
  {
    "text": "didn't before at least from what I tried",
    "start": "1854919",
    "end": "1860080"
  },
  {
    "text": "why so let's see where the vulnerability is it's pretty straightforward here's",
    "start": "1860080",
    "end": "1866110"
  },
  {
    "text": "how our our payload in a requested message it gets into STR status and then",
    "start": "1866110",
    "end": "1871360"
  },
  {
    "text": "STR statuses get gets into the raw HTML of the title of this page so that's",
    "start": "1871360",
    "end": "1878170"
  },
  {
    "text": "really a common easy truth trivial case",
    "start": "1878170",
    "end": "1883630"
  },
  {
    "text": "of XSS it's so trivial that actually Google CSP content security policy",
    "start": "1883630",
    "end": "1890550"
  },
  {
    "text": "blocks a JavaScript execution in this case now Tabitha mandi in his Linds the report",
    "start": "1890550",
    "end": "1897490"
  },
  {
    "text": "mentioned that there's a way to to pivot that to confucian but I didn't invest too much effort on that I'll show you",
    "start": "1897490",
    "end": "1904600"
  },
  {
    "text": "other examples the thing is that there's nothing new here okay what I'm showing",
    "start": "1904600",
    "end": "1909970"
  },
  {
    "start": "1908000",
    "end": "1908000"
  },
  {
    "text": "the exercise some extensions it's something that mr. Kotter with an oz oz",
    "start": "1909970",
    "end": "1915790"
  },
  {
    "text": "born already shown here in black hat on 2012 so I wanted to say that that that",
    "start": "1915790",
    "end": "1923980"
  },
  {
    "text": "might the topic here is not XSS on extensions it's how to create a botnet",
    "start": "1923980",
    "end": "1930760"
  },
  {
    "text": "abusing these extensions and one",
    "start": "1930760",
    "end": "1936670"
  },
  {
    "text": "addition is that the is there is something that was changed since 2012",
    "start": "1936670",
    "end": "1941980"
  },
  {
    "text": "and this is the content security policy of Chrome extensions since 2014 Google",
    "start": "1941980",
    "end": "1950760"
  },
  {
    "start": "1943000",
    "end": "1943000"
  },
  {
    "text": "enforced a default CSP context security policy on all the extensions this",
    "start": "1950760",
    "end": "1957670"
  },
  {
    "text": "prevents a lot of trivial common and Java code injections including this case",
    "start": "1957670",
    "end": "1966580"
  },
  {
    "text": "of Adobe it for example prevents inline scripts and it prevents eval functions and yeah so",
    "start": "1966580",
    "end": "1976960"
  },
  {
    "text": "it wouldn't comment Java JavaScript injections that this was in my opinion a very important move from Google side",
    "start": "1976960",
    "end": "1983710"
  },
  {
    "text": "because before that there were a lot of cross-site scripting vulnerabilities in",
    "start": "1983710",
    "end": "1990010"
  },
  {
    "text": "a lot of extensions and this while it made a a lot of walk for extension developers",
    "start": "1990010",
    "end": "1996250"
  },
  {
    "text": "because they have to take all the their their buggy inline scripts into into the",
    "start": "1996250",
    "end": "2003020"
  },
  {
    "text": "extension its I I think it saved saved",
    "start": "2003020",
    "end": "2008520"
  },
  {
    "text": "us from an XSS extent extension exercise horror scenario um and I wanted to show",
    "start": "2008520",
    "end": "2015809"
  },
  {
    "text": "you that because the thing is that this P is not enough it's a generic policy",
    "start": "2015809",
    "end": "2023400"
  },
  {
    "text": "the default CSP and thinking that a generic policy will cover all the cases is is wrong and let's see an example",
    "start": "2023400",
    "end": "2031679"
  },
  {
    "text": "let's move to the next example which is the avg web tune-up extension this",
    "start": "2031679",
    "end": "2040110"
  },
  {
    "start": "2034000",
    "end": "2034000"
  },
  {
    "text": "extension aims to protect users browser and but on December 2015",
    "start": "2040110",
    "end": "2048200"
  },
  {
    "text": "well it had 9 million installations the same guys the same guy at mr. Treviso",
    "start": "2048200",
    "end": "2054060"
  },
  {
    "text": "Mandi found this extension to be vulnerable to to have several critical",
    "start": "2054060",
    "end": "2060720"
  },
  {
    "text": "vulnerabilities including XSS and in",
    "start": "2060720",
    "end": "2065940"
  },
  {
    "text": "this case CSP did not walk and I will show how short we shall show why and",
    "start": "2065940",
    "end": "2072658"
  },
  {
    "text": "this is Travis and a report the hilarious thing here is that his his is",
    "start": "2072659",
    "end": "2078300"
  },
  {
    "text": "the signature disappointed Travis the obvious if you're here you're my hero",
    "start": "2078300",
    "end": "2083790"
  },
  {
    "text": "I mean this is an extension that aims to protect users and it actually made all",
    "start": "2083790",
    "end": "2091378"
  },
  {
    "text": "day all these browser all these users hackable in several ways so I'm gonna",
    "start": "2091379",
    "end": "2102480"
  },
  {
    "text": "I'm going to run a little demo of this XSS that allowed it's it's an it's a",
    "start": "2102480",
    "end": "2107790"
  },
  {
    "text": "universal exercise meaning that you can inject code a on on victims that runs",
    "start": "2107790",
    "end": "2113640"
  },
  {
    "text": "this extension to any time to any domain let's have a quick look",
    "start": "2113640",
    "end": "2120650"
  },
  {
    "text": "so what we see here is the exploitation POC a code it's it's a little it's it's",
    "start": "2123099",
    "end": "2130869"
  },
  {
    "text": "basically the the POC code by it by mr. Normandy with some adjustments that I",
    "start": "2130869",
    "end": "2137440"
  },
  {
    "text": "added actually it's let's look on this farm which is similar what we see here is",
    "start": "2137440",
    "end": "2143760"
  },
  {
    "text": "that there's a loop that sends a wind",
    "start": "2143760",
    "end": "2149140"
  },
  {
    "text": "that post window messages with the",
    "start": "2149140",
    "end": "2155020"
  },
  {
    "text": "message now if you if you pay close closer attention you can see that the",
    "start": "2155020",
    "end": "2161230"
  },
  {
    "text": "payment the message is sent to the window of of the attack page itself it",
    "start": "2161230",
    "end": "2167140"
  },
  {
    "text": "is that the attack page okay this is the page that I'm going to send victims in order to attack them now that the attack",
    "start": "2167140",
    "end": "2174160"
  },
  {
    "text": "page sent a post message to the same window it runs on okay so this is weird",
    "start": "2174160",
    "end": "2180670"
  },
  {
    "text": "because we are sending a message short to our own window the thing is that the",
    "start": "2180670",
    "end": "2186220"
  },
  {
    "text": "extension also inject content script into our attack page because it inject",
    "start": "2186220",
    "end": "2193720"
  },
  {
    "text": "it eject the script to any just any page and for some reason it also listens to",
    "start": "2193720",
    "end": "2201580"
  },
  {
    "text": "this messages okay we see it in a second in the in the extension cord but what I",
    "start": "2201580",
    "end": "2207070"
  },
  {
    "text": "wanted to show here is that in this inside this mesh missed message I indicate an action that I call navigate",
    "start": "2207070",
    "end": "2214869"
  },
  {
    "text": "and I give also date data in the data I give you our L the URL is a JavaScript",
    "start": "2214869",
    "end": "2221830"
  },
  {
    "text": "column URL that runs this script on the on the on the active tab now just for",
    "start": "2221830",
    "end": "2232720"
  },
  {
    "text": "explain it the navigate the navigate action causes the extension to to update",
    "start": "2232720",
    "end": "2239859"
  },
  {
    "text": "a tab an open tab with our URL to navigate to our URL and our you already",
    "start": "2239859",
    "end": "2245770"
  },
  {
    "text": "the JavaScript code you can see that there is a for loop that you can notice",
    "start": "2245770",
    "end": "2252160"
  },
  {
    "text": "that there is a table ID year here and and I'm going to and three thousand a messages like this",
    "start": "2252160",
    "end": "2261160"
  },
  {
    "text": "with all the cob IDs of all I all my tabs and in these tabs I'm going to",
    "start": "2261160",
    "end": "2266350"
  },
  {
    "text": "check if it runs on black a.com if it runs on black a.com if it's a black dot",
    "start": "2266350",
    "end": "2271750"
  },
  {
    "text": "com tab I'm going to inject the beef framework a code in order to gain",
    "start": "2271750",
    "end": "2278410"
  },
  {
    "text": "control over this tab and just a quick look at the epicord of the extension so",
    "start": "2278410",
    "end": "2288040"
  },
  {
    "text": "what we see here is this is the background script on the of the X extension you can see that there's a",
    "start": "2288040",
    "end": "2295000"
  },
  {
    "text": "function called navigate and it takes our message here here is our message the",
    "start": "2295000",
    "end": "2301630"
  },
  {
    "text": "data of the message and run this function navigate and this function in turn you can see it here uses qualm api",
    "start": "2301630",
    "end": "2309850"
  },
  {
    "text": "and traps update in order to update the",
    "start": "2309850",
    "end": "2314920"
  },
  {
    "text": "table ID that we chose to the URL that we chose here this is the URL so why",
    "start": "2314920",
    "end": "2325980"
  },
  {
    "text": "let's let's run it and then you explain why CSP is not effective here",
    "start": "2325980",
    "end": "2331770"
  },
  {
    "text": "okay so I have a Blackett page and I am",
    "start": "2331770",
    "end": "2338590"
  },
  {
    "text": "going to refresh it to show you that everything is normal and let's turn on",
    "start": "2338590",
    "end": "2346450"
  },
  {
    "text": "the avg web tune-up the vulnerable version of this extension now is on and I'm also going to delete this this is",
    "start": "2346450",
    "end": "2355360"
  },
  {
    "text": "Biff I'm going to delete this is aam be M by the way this is our attack page",
    "start": "2355360",
    "end": "2362740"
  },
  {
    "text": "okay that you just saw this is the code that you just saw and you can see that",
    "start": "2362740",
    "end": "2368230"
  },
  {
    "text": "after injecting the beef and the beef page of the beef script it also alerts",
    "start": "2368230",
    "end": "2373240"
  },
  {
    "text": "that we have a hook so we've got the blackheads the blackheads window here",
    "start": "2373240",
    "end": "2379170"
  },
  {
    "text": "you see there are no online browser and beef and now I'm going to refresh this",
    "start": "2379170",
    "end": "2385030"
  },
  {
    "text": "page as you see we've got another",
    "start": "2385030",
    "end": "2391620"
  },
  {
    "text": "I injected code to blackhat without any any vulnerability on blackett okay just",
    "start": "2393140",
    "end": "2400130"
  },
  {
    "text": "by abusing this extension you can also see that now the beef the beef double",
    "start": "2400130",
    "end": "2408560"
  },
  {
    "text": "javascript is injected into the page and the best beef requests are starting to run and we can see that in beef we have",
    "start": "2408560",
    "end": "2417110"
  },
  {
    "text": "a new a new hook browser in a hoop tab and now the thing is that attackers can",
    "start": "2417110",
    "end": "2427240"
  },
  {
    "text": "can use these vulnerable extensions in",
    "start": "2427240",
    "end": "2433190"
  },
  {
    "text": "order to run scenario 1 campaigns just like the ones that we saw earlier if I",
    "start": "2433190",
    "end": "2440660"
  },
  {
    "text": "get control gain control over Gmail and Facebook which I will I will show in a second and I can send my payload my",
    "start": "2440660",
    "end": "2449630"
  },
  {
    "text": "attack page which is the data credit we saw two other victims using Facebook and",
    "start": "2449630",
    "end": "2455720"
  },
  {
    "text": "distribute my payload effectively through social networks in order to create by my botnet my chrome extensions",
    "start": "2455720",
    "end": "2463070"
  },
  {
    "text": "botnet and not again just a quick example from beef you can do something",
    "start": "2463070",
    "end": "2471050"
  },
  {
    "text": "like this a fake notification bar on the page and just one second and what the",
    "start": "2471050",
    "end": "2481820"
  },
  {
    "text": "victim will see is something like that additional plugins required to display",
    "start": "2481820",
    "end": "2490430"
  },
  {
    "text": "this this page and if you click it a JC file is downloaded and then this in this",
    "start": "2490430",
    "end": "2496700"
  },
  {
    "text": "example it's a JC file that can act like the J's file that we saw in the tag me if you can attack",
    "start": "2496700",
    "end": "2504190"
  },
  {
    "text": "thank you and the last thing I want to",
    "start": "2505090",
    "end": "2512410"
  },
  {
    "text": "show here is how I inject code also to Facebook and Google and in this case",
    "start": "2512410",
    "end": "2517450"
  },
  {
    "text": "Google Drive this is another file very similar what it does it checks if I'm on",
    "start": "2517450",
    "end": "2523690"
  },
  {
    "text": "Facebook on Google and then just right that we have a success on the domain let's run it and you can see that we've",
    "start": "2523690",
    "end": "2532930"
  },
  {
    "text": "got XSS on Facebook and Google Drive okay",
    "start": "2532930",
    "end": "2540870"
  },
  {
    "text": "getting back to the presentation great so why is CSP not blocking this kind of",
    "start": "2549410",
    "end": "2558800"
  },
  {
    "text": "exercise the reason here is that there is no generic JavaScript injection here",
    "start": "2558800",
    "end": "2566000"
  },
  {
    "text": "there's no inline script there is no eval okay all we all all we do is sending a post",
    "start": "2566000",
    "end": "2572540"
  },
  {
    "text": "message to our own window and the extension listens in in the in the code",
    "start": "2572540",
    "end": "2578690"
  },
  {
    "text": "that it injects to our window to these messages and then pass it to the background script of the extension now",
    "start": "2578690",
    "end": "2585650"
  },
  {
    "text": "the background script has the ability to update tabs and adjust update that you",
    "start": "2585650",
    "end": "2591770"
  },
  {
    "text": "are URL of the tab so I'm not I'm not even injecting it's it's not the the",
    "start": "2591770",
    "end": "2600050"
  },
  {
    "text": "application that injects the code is not the page itself is the background script of the extension that he's able to",
    "start": "2600050",
    "end": "2605990"
  },
  {
    "text": "control the tabs because it has permissions and one small example I want",
    "start": "2605990",
    "end": "2616040"
  },
  {
    "text": "show a also show is JSON view how many in the room have this extension installed or had it in the past okay",
    "start": "2616040",
    "end": "2624260"
  },
  {
    "text": "great there are a lot of people with this extension and it was for a year and a",
    "start": "2624260",
    "end": "2630560"
  },
  {
    "text": "half since that it was since February 2015 till November 2016 it was vulnerable to",
    "start": "2630560",
    "end": "2636950"
  },
  {
    "text": "XSS and no one there were reports",
    "start": "2636950",
    "end": "2643119"
  },
  {
    "text": "bye-bye mr. Joe veneks on this XSS and no one repaired it a quick quick demo",
    "start": "2643720",
    "end": "2651290"
  },
  {
    "text": "second demonstration is this so let's",
    "start": "2651290",
    "end": "2661520"
  },
  {
    "text": "let's open the enable the JSON view",
    "start": "2661520",
    "end": "2666560"
  },
  {
    "text": "extension you can see here that there's a page on wix.com which has a category",
    "start": "2666560",
    "end": "2672860"
  },
  {
    "text": "that I I put input here and this is the input you can see",
    "start": "2672860",
    "end": "2679960"
  },
  {
    "text": "this is the input and the thing here is",
    "start": "2680850",
    "end": "2686190"
  },
  {
    "text": "that a lot of websites including weeks take input and make and generate a JSON",
    "start": "2686190",
    "end": "2693750"
  },
  {
    "text": "file out of it so this is this is the JSON file that it contains my input and",
    "start": "2693750",
    "end": "2700740"
  },
  {
    "text": "if I run it I can see that I have an exercise and this this example is very",
    "start": "2700740",
    "end": "2707760"
  },
  {
    "text": "different from the from the other from the first one that I showed you and CSP",
    "start": "2707760",
    "end": "2713370"
  },
  {
    "text": "does not block it as well great",
    "start": "2713370",
    "end": "2720630"
  },
  {
    "text": "and one second okay I think I'm finished",
    "start": "2720630",
    "end": "2728100"
  },
  {
    "text": "it's time for questions [Applause]",
    "start": "2728100",
    "end": "2740400"
  }
]