[
  {
    "text": "Windows kernel graphics driver attack surface by Ilya vents poodle",
    "start": "240",
    "end": "6200"
  },
  {
    "text": "okay Lucy looks like that works awesome so yes I will be talking about Windows",
    "start": "6200",
    "end": "11460"
  },
  {
    "text": "kernel graphics driver attack surface as just mentioned my name is Julia van spindle I am the director of penetration",
    "start": "11460",
    "end": "18150"
  },
  {
    "text": "testing at i/o active Hydra penetration testing Co reviews lead teams basically",
    "start": "18150",
    "end": "25680"
  },
  {
    "text": "break stuff for fun and profit and sometimes advise on how to fix things",
    "start": "25680",
    "end": "30769"
  },
  {
    "text": "right so let's dive in what is this what's my agenda obviously you so I'll start up I'll do slide about what stick",
    "start": "30769",
    "end": "37620"
  },
  {
    "text": "is about on that we to gives the 50,000 feet view of what these drivers are like",
    "start": "37620",
    "end": "42710"
  },
  {
    "text": "and then I sort of dive into the entry points where I say well they're in reports and these are the conditions under which these that your points can",
    "start": "42710",
    "end": "49649"
  },
  {
    "text": "be entered into and then once once that's covered and so how you get there from how do you get to the kernel stuff",
    "start": "49649",
    "end": "55770"
  },
  {
    "text": "usually and once I cover all that stuff I sort of I'll do a demo of a tool that shows how this thing works",
    "start": "55770",
    "end": "63000"
  },
  {
    "text": "and in the last part sort of putting it all together is where the fun begins where I'll talk about how to fuzz these",
    "start": "63000",
    "end": "68909"
  },
  {
    "text": "things out of first engineering and I'll do a small demo of how to fuzz a driver",
    "start": "68909",
    "end": "74390"
  },
  {
    "text": "so what is this talk about well it's as its help excited about Windows graphics drivers specifically WDDM graphic",
    "start": "74390",
    "end": "81240"
  },
  {
    "text": "drivers SD Windows display driver model which is a new driver model I'll talk",
    "start": "81240",
    "end": "87299"
  },
  {
    "text": "about that in a few slides as for the audience the target audience",
    "start": "87299",
    "end": "93299"
  },
  {
    "text": "I guess people that would audit graphics drivers the perfect target audience but also developers I mean if you're a",
    "start": "93299",
    "end": "99689"
  },
  {
    "text": "developer it it's nice to know what T attack surface is there's a fair amount of developer documentation and it tells",
    "start": "99689",
    "end": "105689"
  },
  {
    "text": "you how to write a driver but it's it's not written for hacker so he doesn't tell you this is attack surface this",
    "start": "105689",
    "end": "110909"
  },
  {
    "text": "isn't so I'd like to believe that my presentation gives you a better coverage on that so if you're writing graphics",
    "start": "110909",
    "end": "116850"
  },
  {
    "text": "drivers I'd like to believe that this is also useful to you and the other Atari",
    "start": "116850",
    "end": "123180"
  },
  {
    "text": "audience is just generally curious people right if you want to know about the Windows kernel or something like that then there is hopefully some",
    "start": "123180",
    "end": "129750"
  },
  {
    "text": "interesting stuff in this presentation as for all needed to follow this presentation some",
    "start": "129750",
    "end": "135700"
  },
  {
    "text": "basic knowledge of Windows kernel stuff is is useful since it's not that much like other windows drivers it's not",
    "start": "135700",
    "end": "142300"
  },
  {
    "text": "necessary but it's useful to understand some concepts right so Windows graphic",
    "start": "142300",
    "end": "148480"
  },
  {
    "text": "drivers there's two models there's the old model before we know is Vista and the new model WDDM after or Vista and",
    "start": "148480",
    "end": "156370"
  },
  {
    "text": "onwards the old molecule XP DM r XD DM at Windows 2000 Windows XP its legacy it",
    "start": "156370",
    "end": "162940"
  },
  {
    "text": "is no longer support as of Windows 8 and it's not stuff I'll cover in this",
    "start": "162940",
    "end": "167950"
  },
  {
    "text": "presentation it's it looks completely different and so I'm not covering it I will be covering the attack surface for",
    "start": "167950",
    "end": "173799"
  },
  {
    "text": "WDDM drivers or you know Windows display driver model and so the first version of that came out with vista and then when",
    "start": "173799",
    "end": "180310"
  },
  {
    "text": "seven and more evolved version came out and windows 8 they added a bunch of new features and he put one a number of",
    "start": "180310",
    "end": "186970"
  },
  {
    "text": "other features got at it like miracast and those kind of things I won't obviously describe the entire model",
    "start": "186970",
    "end": "193239"
  },
  {
    "text": "because we'll be here a week from now but I will describe the parts that are",
    "start": "193239",
    "end": "198250"
  },
  {
    "text": "interesting from a security perspective alone if there's anything like driver wise that you have questions about or not quite sure about the dr.dre is",
    "start": "198250",
    "end": "205150"
  },
  {
    "text": "actually pretty good it just doesn't focus on the security part so before we dive in specifics who",
    "start": "205150",
    "end": "212140"
  },
  {
    "text": "actually makes these things because it turns out there's a pretty large number of graphics drivers obviously the",
    "start": "212140",
    "end": "218620"
  },
  {
    "text": "individual individual hardware vendors right in Vidia AMD Intel Qualcomm fire",
    "start": "218620",
    "end": "224650"
  },
  {
    "text": "may truck as support they make drivers and those are the ones that excuse me expose a lot of tax refers because",
    "start": "224650",
    "end": "229989"
  },
  {
    "text": "they're very rich right because they expose all the magic of these karts right and as we know graphics crash",
    "start": "229989",
    "end": "236079"
  },
  {
    "text": "nowadays are very very advanced pieces of hardware and so transfer tools are generally very rich",
    "start": "236079",
    "end": "241150"
  },
  {
    "text": "they'll tell the images for these things will generally be several megabytes large and while that might not mean much",
    "start": "241150",
    "end": "246609"
  },
  {
    "text": "for a graphics driver to be ten megabytes or for any Windows driver to be ten megabytes is enormous it means",
    "start": "246609",
    "end": "252850"
  },
  {
    "text": "there's a lot in there so that obviously those are the drivers that we know",
    "start": "252850",
    "end": "258489"
  },
  {
    "text": "there's others obviously there's the basic fallback this is sort of the bare minimum display driver just comes from",
    "start": "258489",
    "end": "263680"
  },
  {
    "text": "Microsoft this comes in box windows if you have no graphics drivers you fall back to this there is it much there I've",
    "start": "263680",
    "end": "269560"
  },
  {
    "text": "looked I wouldn't work too much about tell us it does the bare minimum and you see that because no your graphics kind",
    "start": "269560",
    "end": "275860"
  },
  {
    "text": "of suck when you in that with those drivers and ender you have sort of the special-purpose drivers right so for",
    "start": "275860",
    "end": "282010"
  },
  {
    "text": "example virtualization they each virtualization software comes with its own windows guests drivers Sophia more",
    "start": "282010",
    "end": "289090"
  },
  {
    "text": "has of VirtualBox has and parallels has a and pretty much all of them have them if you have a window windows guests",
    "start": "289090",
    "end": "294700"
  },
  {
    "text": "they'll have sort of the guest and install additions whatever they'll come with a graphics driver and in there",
    "start": "294700",
    "end": "300850"
  },
  {
    "text": "usually a lot thinner than the than the individual hardware drivers because they",
    "start": "300850",
    "end": "305920"
  },
  {
    "text": "have like one narrow purpose right and then there's a few others writers stuff like virtual display these these come",
    "start": "305920",
    "end": "313330"
  },
  {
    "text": "from smaller smaller companies again these are usually relatively small",
    "start": "313330",
    "end": "318700"
  },
  {
    "text": "because they have like one narrow purpose but they could still I mean they would still expose interesting attack surface right okay so yeah so let's talk",
    "start": "318700",
    "end": "328270"
  },
  {
    "text": "about w vm w vm is sort of it's a split model where as much of a driver as",
    "start": "328270",
    "end": "334540"
  },
  {
    "text": "possible runs and usually and and then the the bits of the driver that can't run in usual and end up in in kernel at",
    "start": "334540",
    "end": "341920"
  },
  {
    "text": "least that that's how WDDM was designed and so there's this model where user land talks to kernel and I'll I'll talk",
    "start": "341920",
    "end": "348700"
  },
  {
    "text": "about that interface in a lot more depth later on and so there's this move was",
    "start": "348700",
    "end": "353950"
  },
  {
    "text": "done for stability and reliability and I found this really really awesome quote on MSDN about why it was done says in",
    "start": "353950",
    "end": "361720"
  },
  {
    "text": "Windows XP display drivers which are large and complex can be a major source of system instability these drivers",
    "start": "361720",
    "end": "367840"
  },
  {
    "text": "execute entirely in kernel mode deep in the system code and hence a single problem driver will often force the",
    "start": "367840",
    "end": "373390"
  },
  {
    "text": "entire system to reboot basically you get a blue screen right if something goes really wrong it says according to",
    "start": "373390",
    "end": "378520"
  },
  {
    "text": "crash now so data collected during the Windows XP time frame display drivers are responsible for up to 20 percent of",
    "start": "378520",
    "end": "384460"
  },
  {
    "text": "all blue screens that is throughout the windows ecosystem right 20 percent at that's and that's what the old mal XP",
    "start": "384460",
    "end": "391150"
  },
  {
    "text": "DDM right because everything ran in kernel and so one single mistake anywhere you get a crash and so WDM set",
    "start": "391150",
    "end": "398590"
  },
  {
    "text": "out to change that and said well what we're gonna do is are going to take as much as we can move it to use a land and then if you're gonna crash",
    "start": "398590",
    "end": "404320"
  },
  {
    "text": "there then that the process just crashes and you could restart and it starts over",
    "start": "404320",
    "end": "409360"
  },
  {
    "text": "but you don't take the system with you and only to the parts at half 20 Karla things you can't do from use land oh the",
    "start": "409360",
    "end": "414640"
  },
  {
    "text": "peripheral stuff only that will run in kernel it's not to say that the the user",
    "start": "414640",
    "end": "420460"
  },
  {
    "text": "and drivers don't have interesting attack service I mean they do right they there's a encoders and decoders in there they could have like binary planting",
    "start": "420460",
    "end": "426640"
  },
  {
    "text": "attacks some api's maybe indirectly exposed through the web through stuff like WebGL so the use of these are what",
    "start": "426640",
    "end": "433450"
  },
  {
    "text": "stuff still hasn't Racine tax refers but it's not what I'll cover in this presentation I'll only focus on the",
    "start": "433450",
    "end": "438490"
  },
  {
    "text": "criminal stuff where we know where the interfaces are relatively well defined and we know we can pick and point and",
    "start": "438490",
    "end": "445090"
  },
  {
    "text": "say that's that's attack surface so this",
    "start": "445090",
    "end": "451750"
  },
  {
    "text": "is kind of what it looks like this is a rough few though but if you take okay so",
    "start": "451750",
    "end": "459040"
  },
  {
    "text": "if you take any piece of like a program this this will be your program and then",
    "start": "459040",
    "end": "464110"
  },
  {
    "text": "it will go out and this will be the direct3d stuff and this will be your",
    "start": "464110",
    "end": "471400"
  },
  {
    "text": "opens your faces and this will be your OpenGL I solve a client driver and so this so this is the this so this will be",
    "start": "471400",
    "end": "478000"
  },
  {
    "text": "this is the user Lant graphic driver stuff right and they all end up calling",
    "start": "478000",
    "end": "483070"
  },
  {
    "text": "it because they have to go to their they have to go to their kernel driver they end up going to winter 2k and it's very",
    "start": "483070",
    "end": "490690"
  },
  {
    "text": "very thin it's just a cisco layer it's five instructions basically it goes in to use land goes does syscall and then",
    "start": "490690",
    "end": "496900"
  },
  {
    "text": "and then you know once the skull it's done it returns back and then obviously",
    "start": "496900",
    "end": "502110"
  },
  {
    "text": "GDI you know it's relatively thin but it has to do marshaling and validation and",
    "start": "502110",
    "end": "509020"
  },
  {
    "text": "capturing all that stuff so some things do happen here some things do happen",
    "start": "509020",
    "end": "514719"
  },
  {
    "text": "here and then it goes through the 10x the dxg kernel which is dyers that",
    "start": "514719",
    "end": "521260"
  },
  {
    "text": "kernel basically which is another driver so boat with dyrdek a noxious at age",
    "start": "521260",
    "end": "527920"
  },
  {
    "text": "eight and dxg kernel or sis or drivers but they're really essential parts of",
    "start": "527920",
    "end": "533080"
  },
  {
    "text": "Windows but it's part of the graphic shop system so it's technically not pirate a colonel",
    "start": "533080",
    "end": "538310"
  },
  {
    "text": "or like the Corps Colonel because not NCOs but windows won't do anything without these things so they're pretty",
    "start": "538310",
    "end": "544580"
  },
  {
    "text": "much a waste air and then the the TX colonel basically ends up calling into",
    "start": "544580",
    "end": "549790"
  },
  {
    "text": "this thing which is the the graphic driver which is the attacks are for which is what we're going to discuss but",
    "start": "549790",
    "end": "557150"
  },
  {
    "text": "this is sort of a rough overview ders there's a lot of layers in between all of this stuff but I think this is more or less captures it so what does w vm k",
    "start": "557150",
    "end": "569900"
  },
  {
    "text": "be driver looks like like a skeleton what's the bare minimum you have to do right let somebody write 20 and they put",
    "start": "569900",
    "end": "576050"
  },
  {
    "text": "in front of you to say start auditing what do you what does it look like well it'll look like I mean it there'll be",
    "start": "576050",
    "end": "582260"
  },
  {
    "text": "lots other stuff in Europe but this is this is it won't do anything without this right and this basically means you",
    "start": "582260",
    "end": "590600"
  },
  {
    "text": "you start off making a driver entry function which is the way any Windows",
    "start": "590600",
    "end": "596900"
  },
  {
    "text": "driver starts technically he doesn't have to be call when driving a tree you",
    "start": "596900",
    "end": "602150"
  },
  {
    "text": "can give it a different name and if you jump through number hoops and will still work but they're pretty much all cult",
    "start": "602150",
    "end": "607910"
  },
  {
    "text": "driver entry because it's convenient and then what happens is you fill out the",
    "start": "607910",
    "end": "613190"
  },
  {
    "text": "structure called trevor initialization theta which basically holds a number of callbacks that say well if the user is",
    "start": "613190",
    "end": "619220"
  },
  {
    "text": "going to do this graphics operation or dis graphics operation or this graph reputation or a number of which then",
    "start": "619220",
    "end": "624350"
  },
  {
    "text": "these call in the winter Takeda this and the DX kernel will go to your drivers",
    "start": "624350",
    "end": "631190"
  },
  {
    "text": "say oh it's oh is this operation then it's this callback for this driver and it'll call your callback right and then",
    "start": "631190",
    "end": "640180"
  },
  {
    "text": "once you have a structure filled out you call t HCK initialize and that basically",
    "start": "640180",
    "end": "645290"
  },
  {
    "text": "that function basically goes to the DI shoreland says hey here's my set of callbacks now you know about them when",
    "start": "645290",
    "end": "651320"
  },
  {
    "text": "somebody does this operation find dry callback and call back in to me",
    "start": "651320",
    "end": "656480"
  },
  {
    "text": "so the interesting thing about this is that you unlike almost any other driver",
    "start": "656480",
    "end": "661700"
  },
  {
    "text": "in Windows there are no herbs there are no axles it's nothing like WDM",
    "start": "661700",
    "end": "666819"
  },
  {
    "text": "you never pass the i/o manager but if none of that stuff is then if that's not enough stuff is there for a graphics",
    "start": "666819",
    "end": "673899"
  },
  {
    "text": "driver it has its complete completely different path yeah there's a very",
    "start": "673899",
    "end": "681069"
  },
  {
    "text": "similar variant of this which is basically so you can make a kernel only display driver where you have no user",
    "start": "681069",
    "end": "686979"
  },
  {
    "text": "land equivalent and it's it's a fairly similar callback model a fairly similar",
    "start": "686979",
    "end": "693039"
  },
  {
    "text": "function to call fairly similar structs fill out but the callbacks are slightly different depending on which operation",
    "start": "693039",
    "end": "699129"
  },
  {
    "text": "happens so this callback this just is",
    "start": "699129",
    "end": "706029"
  },
  {
    "text": "the structure the structure that I spoke of obviously contains a large number of",
    "start": "706029",
    "end": "711489"
  },
  {
    "text": "callbacks it's 40 or 50 maybe 60 very very large number as a security guy I'm",
    "start": "711489",
    "end": "717850"
  },
  {
    "text": "only interested in the things that expose attack surface right what is it that I can call from user land where I can pass like raw bytes that I know it's",
    "start": "717850",
    "end": "724539"
  },
  {
    "text": "going to parse right that's the stuff you care about right and so there's sort of the you know there are things that",
    "start": "724539",
    "end": "729609"
  },
  {
    "text": "you have very little control over as an attacker you know things that'll happen because someone so needs to happen but",
    "start": "729609",
    "end": "734649"
  },
  {
    "text": "you don't get to pass it into data right so from a hackers point of view we don't",
    "start": "734649",
    "end": "739689"
  },
  {
    "text": "care about those callbacks right and then here some we have some indirect control over some things and may or may",
    "start": "739689",
    "end": "745449"
  },
  {
    "text": "not be interesting depending on what the driver does and how it does these things and answer the third category sort of D",
    "start": "745449",
    "end": "750579"
  },
  {
    "text": "where you get to like be like hey here's a blob of data and I can pass you two",
    "start": "750579",
    "end": "755709"
  },
  {
    "text": "gigabytes of bytes and it'll just parse right that's the stuff we care about",
    "start": "755709",
    "end": "760779"
  },
  {
    "text": "right that's the attack surface so that's what we're concerned about and that's what I well-well talk about",
    "start": "760779",
    "end": "767939"
  },
  {
    "text": "before I dive into the entry points of the driver stuff there's a few things I",
    "start": "770339",
    "end": "776350"
  },
  {
    "text": "want to say about synchronization because so WDM has its own synchronization model and this is",
    "start": "776350",
    "end": "783039"
  },
  {
    "text": "interesting to keep in mind if you go look at these drives in you see something that looks like like a race",
    "start": "783039",
    "end": "788739"
  },
  {
    "text": "condition that you need to know this model because otherwise you'll go like oh that's the race case then it turns out it's not because of the",
    "start": "788739",
    "end": "794350"
  },
  {
    "text": "synchronization while around WDDM so there's this interesting it's there disorder there's four levels to it and",
    "start": "794350",
    "end": "799419"
  },
  {
    "text": "they they call level three to level zero so level three is the most strict of in level zero is pretty much wide open so level three",
    "start": "799419",
    "end": "806509"
  },
  {
    "text": "sort of the well you can't be doing anything basically only a single threat may ever enter the GPU has to be idle",
    "start": "806509",
    "end": "811550"
  },
  {
    "text": "there's no DNA before the process Oh video memory has to be evicted from CPU so basically the if the card is doing",
    "start": "811550",
    "end": "816829"
  },
  {
    "text": "anything you're sitting there blocking until the and until it's still nothing's happening so three is very restrictive",
    "start": "816829",
    "end": "823490"
  },
  {
    "text": "to streamers the same except figure memory doesn't have to be a victor to the host CPU one is sort of the is a way",
    "start": "823490",
    "end": "831199"
  },
  {
    "text": "more liberal in the sense that depending on who which thread and from which code pad gets called in to it there's these",
    "start": "831199",
    "end": "837110"
  },
  {
    "text": "it gets divided up in these classes and from each class only one thread may enter and then zero is basically like",
    "start": "837110",
    "end": "845420"
  },
  {
    "text": "completely react anybody can call whenever they want however and this is interesting to know because even in this",
    "start": "845420",
    "end": "851180"
  },
  {
    "text": "liberal zero level Co courtesy is allowed but no two",
    "start": "851180",
    "end": "857269"
  },
  {
    "text": "concurrent threads belong to the same process may enter and that's interesting when you think about race conditions",
    "start": "857269",
    "end": "864920"
  },
  {
    "text": "because a lot of cases you'll have these resources that are shared among a process so different threads will have the same resource but different threads",
    "start": "864920",
    "end": "871910"
  },
  {
    "text": "a different processes more chair so you'll have a lot of things that look like your education even though it made something may be called under single",
    "start": "871910",
    "end": "878420"
  },
  {
    "text": "ization level 0 it just won't be race condition because of the way it was designed",
    "start": "878420",
    "end": "884230"
  },
  {
    "text": "ok so now that we have entry ports the signals a stuff out it away let's dive into the entry points I went over I went",
    "start": "885130",
    "end": "896540"
  },
  {
    "text": "over the list of them in and they're fairly well document on MSDN if you want to know you can go over them you can read them and you you will waste a week",
    "start": "896540",
    "end": "903620"
  },
  {
    "text": "or so trying to figure out what all of that means so maybe longer and I've come down to is like a small list of",
    "start": "903620",
    "end": "909170"
  },
  {
    "text": "callbacks where I can be like yeah that that's attack surface like that's where the bugs are gonna be and so basically",
    "start": "909170",
    "end": "917829"
  },
  {
    "text": "there's sort of four callbacks one is escape ones render ones allocation info 1 squared after escape is basically the",
    "start": "917829",
    "end": "925009"
  },
  {
    "text": "graphics driver equivalent of I octaves I'm even though model headed to but it",
    "start": "925009",
    "end": "931279"
  },
  {
    "text": "was it was slightly different but it was the same concept and so basically the escapes work by",
    "start": "931279",
    "end": "936319"
  },
  {
    "text": "basically just being like you know here's a blob of data and then and render obviously goes you know once you've done something you say render and",
    "start": "936319",
    "end": "941749"
  },
  {
    "text": "it'll render allocations basically to get like some DMA buffers and stuff done and Cori adapter is basically where you",
    "start": "941749",
    "end": "948379"
  },
  {
    "text": "can go to a graphics card or the driver and say hey give me this kind of information give me this kind of",
    "start": "948379",
    "end": "953389"
  },
  {
    "text": "information or give me this kind of information so before I dive into these",
    "start": "953389",
    "end": "959259"
  },
  {
    "text": "so one of things I want to get what I want to get or cover is not just so what",
    "start": "959259",
    "end": "965420"
  },
  {
    "text": "the entry points are but how do you get there from user land because it's all nice and well to sort of have a list of these to do this is your inter point but",
    "start": "965420",
    "end": "971959"
  },
  {
    "text": "how do you actually call into it right so before we get into it I want to like just give like a very small brief look",
    "start": "971959",
    "end": "979279"
  },
  {
    "text": "over you know how do you how do you write it angel eyes usually a piece that gets to a graphics driver right and then",
    "start": "979279",
    "end": "986689"
  },
  {
    "text": "once I got that I'll go into the callbacks and I'm going to call back I'll be like okay this is this is the",
    "start": "986689",
    "end": "991850"
  },
  {
    "text": "the way work the way I'll do it is I'll say okay this is the the current face and this is what it does and how it",
    "start": "991850",
    "end": "997160"
  },
  {
    "text": "works and when it acts where the attack surfaces and I'll be like and this is the user land function you call to get",
    "start": "997160",
    "end": "1003220"
  },
  {
    "text": "there and how in sorted order between these things I know it's a little bit dry but it's sort of the run-up to the",
    "start": "1003220",
    "end": "1009279"
  },
  {
    "text": "fun part which is what you get to do to fuzzing universe engineer because if you don't know the first part you're not",
    "start": "1009279",
    "end": "1014470"
  },
  {
    "text": "going to get anywhere if you don't know how the interface works you can't audit it you can't fuzz it right so please bear with me for I don't",
    "start": "1014470",
    "end": "1021730"
  },
  {
    "text": "know 15 minutes maybe so the driving point installation stuff I'm going to",
    "start": "1021730",
    "end": "1029230"
  },
  {
    "text": "assume that you have done like trivial graphics programming before in Windows user land and what I mean is like you've",
    "start": "1029230",
    "end": "1036279"
  },
  {
    "text": "you've used GDI you know what what it like a device context handle is and and",
    "start": "1036279",
    "end": "1041949"
  },
  {
    "text": "that kind of stuff right so we start off with a handle to a device context which is a GI world that's what you start off",
    "start": "1041949",
    "end": "1047409"
  },
  {
    "text": "with that's your handle to anything you want to do if you want to print something you use the HDC if you want to do something graph you do you use the",
    "start": "1047409",
    "end": "1053470"
  },
  {
    "text": "HDC right so we assume we come from DDI world we have an HCC from DS you see",
    "start": "1053470",
    "end": "1059889"
  },
  {
    "text": "it's sort of the it's there's sort of three steps you have to do to sort of get to the WDDM driver software you can",
    "start": "1059889",
    "end": "1066039"
  },
  {
    "text": "really start doing stuff right first thing is you have to WDDM to call",
    "start": "1066039",
    "end": "1071080"
  },
  {
    "text": "back still they don't really care about HCC's they have what they call adapter handles so you want to go from agency to",
    "start": "1071080",
    "end": "1076240"
  },
  {
    "text": "an adapter handle once you have an adapter handle you want to get a device handle out of it and once there's a",
    "start": "1076240",
    "end": "1081610"
  },
  {
    "text": "number of things you can do once you have a device handle but there's also a number of things you can't do until you create a context for your device so the",
    "start": "1081610",
    "end": "1088539"
  },
  {
    "text": "step is right once you have an HTC step one is converted agency to adapt panel and then created if I say know how to do",
    "start": "1088539",
    "end": "1095110"
  },
  {
    "text": "that handle and then get a context for that device and it's basically it's a",
    "start": "1095110",
    "end": "1100779"
  },
  {
    "text": "set of fairly simple functions that you call and so these are the functions",
    "start": "1100779",
    "end": "1106750"
  },
  {
    "text": "themselves there's I haven't been able to find any program that or sample code",
    "start": "1106750",
    "end": "1112059"
  },
  {
    "text": "that tells you how to do it but two functions themselves for documenting MSDN so you basically fill out the",
    "start": "1112059",
    "end": "1117640"
  },
  {
    "text": "structure which say hey here's my htc and then you call d3d kmt open adapter",
    "start": "1117640",
    "end": "1123520"
  },
  {
    "text": "from HTC you Pat and you pass it the structure and if it succeeds it goes and",
    "start": "1123520",
    "end": "1128559"
  },
  {
    "text": "says okay here's your adapter once you have your dapped handle you want to get",
    "start": "1128559",
    "end": "1133690"
  },
  {
    "text": "to fight handle out of it which is similar process you fill out structure you say well here's my adapter handle",
    "start": "1133690",
    "end": "1139299"
  },
  {
    "text": "and then you call t30 can be create device and if that succeeds you basically give back device handle okay",
    "start": "1139299",
    "end": "1146520"
  },
  {
    "text": "right so and then the step three used to create a context for the device so the",
    "start": "1146520",
    "end": "1154330"
  },
  {
    "text": "previous lead if I obtain so my signal you now have is the stuff you pass along to most of your calls to to the kernel",
    "start": "1154330",
    "end": "1161350"
  },
  {
    "text": "stuff for the kernel driver and so don't do anything you need to create a device context for the device in most cases you",
    "start": "1161350",
    "end": "1167799"
  },
  {
    "text": "need a device context depending what you want to do some things do work without device context but when you create a",
    "start": "1167799",
    "end": "1175120"
  },
  {
    "text": "device context things like setting up command buffers that you pass back and forth between each land kernel that's",
    "start": "1175120",
    "end": "1180880"
  },
  {
    "text": "what happens when you sort create a device context these are all things the driver does on your behalf like it'll do allocations in user space",
    "start": "1180880",
    "end": "1187059"
  },
  {
    "text": "on your behalf that get passed back and forth there so when you create a device",
    "start": "1187059",
    "end": "1194620"
  },
  {
    "text": "context there's actually there's always so attacks refers here so when you make this call to kernel",
    "start": "1194620",
    "end": "1200800"
  },
  {
    "text": "you you get to provide a pointer which says okay here's data and you get quite a size and says okay here's data and",
    "start": "1200800",
    "end": "1206710"
  },
  {
    "text": "it's not it's not so that pointer in length is it's up to the driver to do with it a like it they can do it at anything",
    "start": "1206710",
    "end": "1213670"
  },
  {
    "text": "they want the the documentation doesn't say that has to be structure anyway it's just a pointer no lengths most drivers",
    "start": "1213670",
    "end": "1220870"
  },
  {
    "text": "I've seen at this point don't really do much with this which is data at this point but it's up to the driver so some",
    "start": "1220870",
    "end": "1227710"
  },
  {
    "text": "drivers may just take that data and just implement an arbitrary protocol and start doing all sorts of parsing so",
    "start": "1227710",
    "end": "1233830"
  },
  {
    "text": "there is potential attack surface when you create a context but it's completely",
    "start": "1233830",
    "end": "1239020"
  },
  {
    "text": "driver dependence so this is basically",
    "start": "1239020",
    "end": "1247840"
  },
  {
    "text": "you know it's the same the similar constants before where you fill out a",
    "start": "1247840",
    "end": "1252850"
  },
  {
    "text": "structure and then you say well here's my device handle and you and then you call the create AB TV",
    "start": "1252850",
    "end": "1258610"
  },
  {
    "text": "KMD create context and if that succeeds then you get a context and there's so",
    "start": "1258610",
    "end": "1264310"
  },
  {
    "text": "and the structure you pass basically is this thing and and these are interesting",
    "start": "1264310",
    "end": "1272080"
  },
  {
    "text": "ones right is private driver data size and private driver data if the driver",
    "start": "1272080",
    "end": "1279100"
  },
  {
    "text": "has a parser for that that's tax RIF is that stuff you care about right if you ever if you're gonna write it faster",
    "start": "1279100",
    "end": "1284890"
  },
  {
    "text": "that those are things you want to fuss okay and then yeah so when you're when",
    "start": "1284890",
    "end": "1298150"
  },
  {
    "text": "you're done so these are certainly output buffers so this is when you create contexts a driver does a number of things on your behalf so it'll create",
    "start": "1298150",
    "end": "1305410"
  },
  {
    "text": "a command buffer and it'll map it into your address space so you don't get the map it but you could you control it and",
    "start": "1305410",
    "end": "1311890"
  },
  {
    "text": "it's in your address space and this is the the buffer that's gonna be used when you send commands back and forth between",
    "start": "1311890",
    "end": "1317110"
  },
  {
    "text": "user and kernel that's the buffer that's going to be used and then we'll talk a bit more about that later but these are sort of",
    "start": "1317110",
    "end": "1323650"
  },
  {
    "text": "allocations stuff that happens when you create a context that the driver does on your behalf",
    "start": "1323650",
    "end": "1329400"
  },
  {
    "text": "ok so now that I've sort of covered the sort of you know how do I actually get",
    "start": "1329400",
    "end": "1334509"
  },
  {
    "text": "to talk to this thing where do you start there's I'll talk about the four entry points that I that I mentioned by",
    "start": "1334509",
    "end": "1340169"
  },
  {
    "text": "previously which is escape render allocation and and query adapter right",
    "start": "1340169",
    "end": "1345489"
  },
  {
    "text": "so a start off would escape the callback is called dxg KDDI escape and as i",
    "start": "1345489",
    "end": "1351849"
  },
  {
    "text": "mentioned before this is di aqwal of graphics drivers right so if you're familiar with general windows drivers",
    "start": "1351849",
    "end": "1358709"
  },
  {
    "text": "obviously i oculus is usually the main thing where you go and look for bugs graphics drivers it's d it's escape it's",
    "start": "1358709",
    "end": "1365739"
  },
  {
    "text": "a similar concept it's just the arguments are different this is very much like the oil so if you had the old",
    "start": "1365739",
    "end": "1372629"
  },
  {
    "text": "display model there's a function called x2 scape which is this is pretty much the equivalent of that and where X",
    "start": "1372629",
    "end": "1379449"
  },
  {
    "text": "escape sort of separates out a function number and then you get a blob of data and for WDM that's sort of there's no",
    "start": "1379449",
    "end": "1387009"
  },
  {
    "text": "type anymore there's just the blob of data so what that means is there there's no structures there's no predefined",
    "start": "1387009",
    "end": "1393609"
  },
  {
    "text": "protocol at all it's the driver is free to implement it any way it sees fit",
    "start": "1393609",
    "end": "1399449"
  },
  {
    "text": "yeah same as you MSDN describes it as that function shares information with user move them this way driver but it's",
    "start": "1400499",
    "end": "1406989"
  },
  {
    "text": "it's the graphics driver I octal equivalent basically and this this falls",
    "start": "1406989",
    "end": "1412690"
  },
  {
    "text": "under threading level two so race conditions in the scape callbacks",
    "start": "1412690",
    "end": "1419459"
  },
  {
    "text": "unlikely not not saying it's impossible but it's unlikely so what does this look",
    "start": "1419459",
    "end": "1425619"
  },
  {
    "text": "like well the the current face kind of looks like this so if if you're gonna",
    "start": "1425619",
    "end": "1432940"
  },
  {
    "text": "audit a driver if you have implement one you basically that the callback will F is function and it'll look like this",
    "start": "1432940",
    "end": "1438879"
  },
  {
    "text": "this is the sort of the predefined how this function looks like and the thing",
    "start": "1438879",
    "end": "1444159"
  },
  {
    "text": "you care about is the second argument is a structure that gets passed on and it'll continue to handle device and a",
    "start": "1444159",
    "end": "1450129"
  },
  {
    "text": "couple of flags in the context and from a tax point of view generally to other things you know will care about because",
    "start": "1450129",
    "end": "1455289"
  },
  {
    "text": "you don't control them but the interesting parts is obviously the driver data in the driver data size because that says this is stuff that",
    "start": "1455289",
    "end": "1462069"
  },
  {
    "text": "came from user mantis is attacker control content that's that's potential tax or anything that touches that has to",
    "start": "1462069",
    "end": "1468039"
  },
  {
    "text": "do sense of validation or you know though or things will go very wrong so yeah a",
    "start": "1468039",
    "end": "1474880"
  },
  {
    "text": "few more things about this I started looking into it and because I wanted to see what the conditions are around this data and so this private driver data is",
    "start": "1474880",
    "end": "1482710"
  },
  {
    "text": "probe they captured and if you don't know what probe that capture means is that it's sort of these are kernel",
    "start": "1482710",
    "end": "1488620"
  },
  {
    "text": "concepts that that that are terms that come from the windows world for kernel concept probe means that they before it",
    "start": "1488620",
    "end": "1497140"
  },
  {
    "text": "named the data is handed to you the windows chroma has made sure that this piece of data is that that you passed",
    "start": "1497140",
    "end": "1504340"
  },
  {
    "text": "Musil and that it's valid that it's valid and it's in in userland range in that it's mapped and all the",
    "start": "1504340",
    "end": "1510820"
  },
  {
    "text": "kind of stuff and captures means that once they've done that it's been it's been mirrored into kernel address space",
    "start": "1510820",
    "end": "1517380"
  },
  {
    "text": "so what that means is that while you he wasn't active control the content you",
    "start": "1517380",
    "end": "1523150"
  },
  {
    "text": "don't control the memory itself you can tun map it while the drivers trying to do things all those problems don't occur",
    "start": "1523150",
    "end": "1529000"
  },
  {
    "text": "because it's prob'ly captured but we want that us attack have full control",
    "start": "1529000",
    "end": "1534280"
  },
  {
    "text": "over the content between sending this from from your usual and function to the actual driver there's no validation of",
    "start": "1534280",
    "end": "1540850"
  },
  {
    "text": "the content that happens so every bit that ends up every bit ends up and in",
    "start": "1540850",
    "end": "1546250"
  },
  {
    "text": "this interface in the private data that's a tax or if you control that prior to this function it's never been",
    "start": "1546250",
    "end": "1553299"
  },
  {
    "text": "validated and there's no link strictures on this so what one of the things is usually when he adds kind of interfaces",
    "start": "1553299",
    "end": "1558700"
  },
  {
    "text": "one of the things people then do is when I dude is kind of out like probing caption they'll be like well but we'll",
    "start": "1558700",
    "end": "1564250"
  },
  {
    "text": "put a link restriction will say well you get to use I don't know 10 pages or 100 pages or whatnot in a WDM case there is",
    "start": "1564250",
    "end": "1571419"
  },
  {
    "text": "no link restrictions because the Terminator size is a you wind",
    "start": "1571419",
    "end": "1577299"
  },
  {
    "text": "technically there is a link restriction in the sense that it's restricted to four gigabytes but you know for hereby",
    "start": "1577299",
    "end": "1582520"
  },
  {
    "text": "it should give you enough attack surface right and so deployment capturing is",
    "start": "1582520",
    "end": "1588820"
  },
  {
    "text": "interesting because it means you don't have any kind of validation because the the memories are there of course if the protocol allows the protocol between",
    "start": "1588820",
    "end": "1595990"
  },
  {
    "text": "user monie kernel mode allows for any kind of embedded pointers in in that length then obviously those pointers to",
    "start": "1595990",
    "end": "1601360"
  },
  {
    "text": "lead propably captured and so forth um so how do you talk to stuff from user Lant well",
    "start": "1601360",
    "end": "1607230"
  },
  {
    "text": "it's it's as before basically it's a function call t3d kmt escape and it has",
    "start": "1607230",
    "end": "1612750"
  },
  {
    "text": "a structure and the structures is sanam is DN and again it so the structure isn't exactly the same but there's you",
    "start": "1612750",
    "end": "1619410"
  },
  {
    "text": "know they look very similar right is it an app door handle an advice handle and type flags in the context and these are",
    "start": "1619410",
    "end": "1626700"
  },
  {
    "text": "things obviously as I said before that where there isn't that much attacks reference but you know it's the driver",
    "start": "1626700",
    "end": "1633450"
  },
  {
    "text": "data editor have attained a size that are interesting and important and that's that's where bugs are going to be and it's really not like it's a function but",
    "start": "1633450",
    "end": "1641280"
  },
  {
    "text": "it's it's really just a system call there's nothing happens so what's funny is that if you look at if you look at",
    "start": "1641280",
    "end": "1646290"
  },
  {
    "text": "seeing Ida and you look at the export table it's called d3d KMD escape but then if you go to the micro symbol",
    "start": "1646290",
    "end": "1652380"
  },
  {
    "text": "server the symbol server comes back and says that's not theatre DK me escape that's NT GDIT da dee dee dee dee is",
    "start": "1652380",
    "end": "1658679"
  },
  {
    "text": "cake which means it's a system call right it just happens to be one that's exported under a different name so these",
    "start": "1658679",
    "end": "1664530"
  },
  {
    "text": "functions are really just you it's very raw door there's the the layer between user and kernel that where you hand off",
    "start": "1664530",
    "end": "1671520"
  },
  {
    "text": "your data it's pretty thin it's yeah it's for instructions right right so",
    "start": "1671520",
    "end": "1681179"
  },
  {
    "text": "that's sort of the sort of the dry entry point for for escape asks for render",
    "start": "1681179",
    "end": "1692630"
  },
  {
    "text": "it's a similar kind of call back this one happens basically when you want to render something you go and say rendered",
    "start": "1692630",
    "end": "1698370"
  },
  {
    "text": "right it's a hard rendering a lot use a motel GPU render from a command buffer",
    "start": "1698370",
    "end": "1704120"
  },
  {
    "text": "it's sort of a similar concept where this is your callback and this is the structure you pass it and so this the",
    "start": "1704120",
    "end": "1711809"
  },
  {
    "text": "command and this pacification loose in this is stuff that's set up on your behalf when you create a context and",
    "start": "1711809",
    "end": "1717990"
  },
  {
    "text": "what's interesting about these is that both command and patch location lists in or mapped in user land so they're mapped",
    "start": "1717990",
    "end": "1724620"
  },
  {
    "text": "in your address space so you don't control the pointer where it's mapped you def pond'rous fixed but it's in your",
    "start": "1724620",
    "end": "1729870"
  },
  {
    "text": "address space and that is interesting in the sense that way",
    "start": "1729870",
    "end": "1735020"
  },
  {
    "text": "the driver has to touch it because you can you can still have a second thread and usual and when you say Oh",
    "start": "1735020",
    "end": "1740630"
  },
  {
    "text": "while it's fixed I can still on map this thing right and then if the if if your",
    "start": "1740630",
    "end": "1745850"
  },
  {
    "text": "kernel equivalent doesn't account for the on mapping they're all still bad things can happen and the other thing is",
    "start": "1745850",
    "end": "1751460"
  },
  {
    "text": "because it's in user land you can also have even if you account for this on mapping you can have all these these",
    "start": "1751460",
    "end": "1756830"
  },
  {
    "text": "race conditions where because you will validate something that structure like you validate something in a command buffer for example right say bite XYZ it",
    "start": "1756830",
    "end": "1763760"
  },
  {
    "text": "has to be this value or this value and then after you validate and you can have a second tour newsl and it's just",
    "start": "1763760",
    "end": "1769010"
  },
  {
    "text": "overwrite zip and old son your validation is no longer valid so it's interesting to note that while the",
    "start": "1769010",
    "end": "1775220"
  },
  {
    "text": "pond'rous fixed you can still sort of change the content under the underneath the driver without your knowledge",
    "start": "1775220",
    "end": "1782530"
  },
  {
    "text": "right so grandma for a bachelor's okay so cool and and so actually interesting",
    "start": "1782530",
    "end": "1789500"
  },
  {
    "text": "is that MSDN says specifically notes this right they say well they this comes",
    "start": "1789500",
    "end": "1795260"
  },
  {
    "text": "from from using water so driver and so this will a mini port driver must use try accept coat an oldest otherwise you",
    "start": "1795260",
    "end": "1801470"
  },
  {
    "text": "know some of your maps that then you crash and WDM actually gives you Emma",
    "start": "1801470",
    "end": "1807170"
  },
  {
    "text": "teen actually gives you tells you gives you sample code try to do this and this",
    "start": "1807170",
    "end": "1812960"
  },
  {
    "text": "is when I looked at it before I fully understood to create context I was like well if they're if they come from userland shouldn't you be probing and",
    "start": "1812960",
    "end": "1819830"
  },
  {
    "text": "capturing stuff before you do this and because afterwards I was like oh a crate contact actually Maps this stuff on your",
    "start": "1819830",
    "end": "1826550"
  },
  {
    "text": "behalf so you don't control the point it just happens to be in your address space i mister there dude there's no there's",
    "start": "1826550",
    "end": "1832730"
  },
  {
    "text": "no probing that happens here because it doesn't need to be probed it's already been probed but you still need to do a",
    "start": "1832730",
    "end": "1837980"
  },
  {
    "text": "try except yeah so usually does actually",
    "start": "1837980",
    "end": "1843290"
  },
  {
    "text": "get to do this because right yeah happy what's covered dislike awesome",
    "start": "1843290",
    "end": "1849890"
  },
  {
    "text": "so I have an example of how JEWS and actually this is this is from a real driver and this is already been fixed so this is um this is from the VirtualBox",
    "start": "1849890",
    "end": "1858740"
  },
  {
    "text": "driver and so this is this is the render callback and it basically go well this",
    "start": "1858740",
    "end": "1865310"
  },
  {
    "text": "is this is your your your private data buffer right he here you command buffer right here and",
    "start": "1865310",
    "end": "1870740"
  },
  {
    "text": "then they say they touch this stuff but there's no try/except so this can obviously blue screen right this",
    "start": "1870740",
    "end": "1876470"
  },
  {
    "text": "consumer real driver so this is real code that that has done it wrong hasn't done what Emma Jian said you should do",
    "start": "1876470",
    "end": "1883720"
  },
  {
    "text": "so that's one example of not having a try except that's one example of the",
    "start": "1883720",
    "end": "1891260"
  },
  {
    "text": "same driver in the same function we're not this isn't just a crash this is actually this is sort of a this is a",
    "start": "1891260",
    "end": "1897530"
  },
  {
    "text": "race condition right we get it gets sort of a time of check time of use condition where you know the disappoint it comes",
    "start": "1897530",
    "end": "1903620"
  },
  {
    "text": "from the command buffer and then there's this validation that happens here and an average validation that data gets used",
    "start": "1903620",
    "end": "1910490"
  },
  {
    "text": "but because it points to user land between validation in between use I can have a second thread and just overwrite",
    "start": "1910490",
    "end": "1916520"
  },
  {
    "text": "the data and then all the checks that happen here or no longer valid so and",
    "start": "1916520",
    "end": "1921890"
  },
  {
    "text": "this is this is the the same driver the different bug this this one has been fixed to this is a bone tumor VirtualBox",
    "start": "1921890",
    "end": "1928280"
  },
  {
    "text": "and I believe work will fix them in a CPU in April so it's been there's been fixed for a while so you because their",
    "start": "1928280",
    "end": "1936020"
  },
  {
    "text": "drivers open sore I used it to sort of start off my research that sort of guiding me towards what these things look like because you know it's it's",
    "start": "1936020",
    "end": "1941720"
  },
  {
    "text": "easier to read Co C++ code than it is to look at I tango like I wonder what this",
    "start": "1941720",
    "end": "1947180"
  },
  {
    "text": "structure does alright so how do we talk",
    "start": "1947180",
    "end": "1954080"
  },
  {
    "text": "to this thing from user land well it's kind of the same thing right there's a there's a function for it and there's a structure and again the structures and",
    "start": "1954080",
    "end": "1960500"
  },
  {
    "text": "isn't the same as the kernel structure but it's very similar right so when you go from kernel to user motors they're",
    "start": "1960500",
    "end": "1966710"
  },
  {
    "text": "sort of translation between these structures that happen right but they it contains the same kind of information",
    "start": "1966710",
    "end": "1971890"
  },
  {
    "text": "and again it's really just even though it's a function it's if you go to the symbol server similar services actually",
    "start": "1971890",
    "end": "1977630"
  },
  {
    "text": "this is just a very thin syscall wrapper okay so allocation so this one basically",
    "start": "1977630",
    "end": "1983870"
  },
  {
    "text": "does allocation unusual ins behalf to allocate memory and this is it senior",
    "start": "1983870",
    "end": "1988910"
  },
  {
    "text": "system memory or video memory depending on which flags you set and so the kernel callback basically it's called DG DX g",
    "start": "1988910",
    "end": "1997520"
  },
  {
    "text": "KDDI create allocation and this is fairly similar stuff to the previous thing ones I covered",
    "start": "1997520",
    "end": "2002790"
  },
  {
    "text": "where you the second argument is the structure and this structure basically",
    "start": "2002790",
    "end": "2008530"
  },
  {
    "text": "contains a number of things that us attack her very little control over but it also contains a private private data",
    "start": "2008530",
    "end": "2015130"
  },
  {
    "text": "pointer and a private data size which again as we know that's a tax surface that's completely up to drive around how",
    "start": "2015130",
    "end": "2020320"
  },
  {
    "text": "they want to implement it now I didn't want to parse it and the data is completely controlled by user land right",
    "start": "2020320",
    "end": "2025350"
  },
  {
    "text": "and then so there's a second structure there which is P allocation info which",
    "start": "2025350",
    "end": "2031600"
  },
  {
    "text": "and these you can have a list of patient info numbers and each one of those will have their own private data size so you have this you can have a private a size",
    "start": "2031600",
    "end": "2037360"
  },
  {
    "text": "and then a list of private sizes and all of this is a tax or if and all of it goes through like one system call so",
    "start": "2037360",
    "end": "2042610"
  },
  {
    "text": "there's there's a fair amount of potential tax surface here so right yeah",
    "start": "2042610",
    "end": "2050740"
  },
  {
    "text": "cover this okay so how do you how do we get from the usual and same kind of thing right there's a function for this",
    "start": "2050740",
    "end": "2057250"
  },
  {
    "text": "and there's a structure which is which isn't the same as the kernel one but it looks very similar and you know again if",
    "start": "2057250",
    "end": "2063610"
  },
  {
    "text": "you look at it in just in an assembler and you go to the symbol server microsomal services actually it's really",
    "start": "2063610",
    "end": "2069398"
  },
  {
    "text": "system call and it's you know and it's these four instructions okay so out of",
    "start": "2069399",
    "end": "2077679"
  },
  {
    "text": "four one query adapter create a pers a little bit different because of the previous tree I covered all have these",
    "start": "2077679",
    "end": "2083220"
  },
  {
    "text": "these input buffers where you go and to the driver and say well parse this parse this so there's re I can see your entry",
    "start": "2083220",
    "end": "2090100"
  },
  {
    "text": "points right the thing I found interesting with entry with create after is that it it's not so much importance",
    "start": "2090100",
    "end": "2095108"
  },
  {
    "text": "is the exit points so you go to driving to say hand me this back and depending on what you what you tell it some of",
    "start": "2095109",
    "end": "2101619"
  },
  {
    "text": "them have these predefined structures that have to be this big or this big or so forth but some of them can have these these blobs right and when you get blobs",
    "start": "2101619",
    "end": "2108760"
  },
  {
    "text": "back from kernel it's so interesting when you start inspecting them and see if you can find like a member in the",
    "start": "2108760",
    "end": "2114910"
  },
  {
    "text": "structure that wasn't initialized or some kind of compiler slack space that was added somewhere or you know bits and",
    "start": "2114910",
    "end": "2121840"
  },
  {
    "text": "bytes or ranges of bytes that are that we're never written to and so you get these leaks of under sliced kernel",
    "start": "2121840",
    "end": "2129520"
  },
  {
    "text": "memory back and so I've seen a few of these and inquiry adapters",
    "start": "2129520",
    "end": "2135510"
  },
  {
    "text": "and so yeah same deals before I did it folks for this and you do there's",
    "start": "2135670",
    "end": "2141800"
  },
  {
    "text": "there's a structure you pass it and so there's an input buffer an output buffer",
    "start": "2141800",
    "end": "2146930"
  },
  {
    "text": "because so depending on which query adapter so there's a there's a type you say in depending which type it'll expect",
    "start": "2146930",
    "end": "2154670"
  },
  {
    "text": "different structures so some will have input and some will have output actually most have output but only a handful of",
    "start": "2154670",
    "end": "2160220"
  },
  {
    "text": "input so yeah as I mention for is interesting entry and exit points this",
    "start": "2160220",
    "end": "2168440"
  },
  {
    "text": "is a data that is being passed and from usually an but more more importantly it's the exit points or the things that",
    "start": "2168440",
    "end": "2175160"
  },
  {
    "text": "are interesting where you get oldest data back from drivers and you and just if you start looking at these things",
    "start": "2175160",
    "end": "2180440"
  },
  {
    "text": "like every so often you'll see something where if you do the same call five or ten times over like they'll be like this",
    "start": "2180440",
    "end": "2185960"
  },
  {
    "text": "range of bytes that like just ran and we seem to contain garbage or or maybe",
    "start": "2185960",
    "end": "2191690"
  },
  {
    "text": "it'll be some structure in one but no instruction the other maybe when you like go like wow that that one looks",
    "start": "2191690",
    "end": "2197360"
  },
  {
    "text": "like it like it's like it's an information leak right and then you go look at the driver or you go look at the",
    "start": "2197360",
    "end": "2204050"
  },
  {
    "text": "assembly or code if you have it and quite often when you have those kind of situations you'll have you'll have an",
    "start": "2204050",
    "end": "2211910"
  },
  {
    "text": "information leak okay right so how you're talking from using the same",
    "start": "2211910",
    "end": "2217040"
  },
  {
    "text": "procedure right there's a function for this and it's a structure which isn't quite the same as the kernel structure but they're very closely closely related",
    "start": "2217040",
    "end": "2224590"
  },
  {
    "text": "and again it's it's even though MSDSs its function it's not really a function",
    "start": "2224590",
    "end": "2230450"
  },
  {
    "text": "it's a system call so yeah so when I start looking at the at some of these",
    "start": "2230450",
    "end": "2237080"
  },
  {
    "text": "drivers there's a number of things I found that that and and haven't really gotten all that far drives because there's many of them in and do lead up",
    "start": "2237080",
    "end": "2243950"
  },
  {
    "text": "of these things sort of took took a lot of my time but when I started looking at them there's sort of three things I",
    "start": "2243950",
    "end": "2249110"
  },
  {
    "text": "found that were fairly obvious where that I think and and these it's not like",
    "start": "2249110",
    "end": "2255110"
  },
  {
    "text": "these are new but it's sort of I want to reiterate beat to make sure that if you're ever going to be involved in writing a graphics driver please keep",
    "start": "2255110",
    "end": "2261950"
  },
  {
    "text": "these things in mind first of all out of bound read or write write when you take a buffer where you know data comes from",
    "start": "2261950",
    "end": "2268990"
  },
  {
    "text": "comes from an attacker right every bit counts every bite counts right if you if you",
    "start": "2268990",
    "end": "2274370"
  },
  {
    "text": "take the buffer and you read out first or the second bite and you haven't validated that the second bite is there",
    "start": "2274370",
    "end": "2279740"
  },
  {
    "text": "you just assume that's wrong right and usually you might get away with it right in curly what you don't write that reading that second bite can be a blue",
    "start": "2279740",
    "end": "2286640"
  },
  {
    "text": "screen right because the first bite could be the end of a page and the second page couldn't be mapped and old son you get a blue screen right so these",
    "start": "2286640",
    "end": "2292040"
  },
  {
    "text": "things really matter when you write kernel code right and and I don't about rights are usually something where if",
    "start": "2292040",
    "end": "2297740"
  },
  {
    "text": "you're a developer you go like well that's memory corruption we we understand and so people tend to be very careful with those things but out of",
    "start": "2297740",
    "end": "2302960"
  },
  {
    "text": "bound reads people tend not to be very careful with that even though you still end up with a blue screen so so that's",
    "start": "2302960",
    "end": "2309770"
  },
  {
    "text": "very common and I wish people when they write kernel code go like even out of boundaries you know you have to be",
    "start": "2309770",
    "end": "2314930"
  },
  {
    "text": "really really careful that that's one a second when I saw is and this was through a lot of drivers surprisingly is",
    "start": "2314930",
    "end": "2321770"
  },
  {
    "text": "that it won't be like the debug code but it'll be like the debugger keys",
    "start": "2321770",
    "end": "2328220"
  },
  {
    "text": "themselves will be gone but all the surrounding context for debug code is still there so you'll see these creation",
    "start": "2328220",
    "end": "2334250"
  },
  {
    "text": "of strings saying well function X Y set does this and it's supposed to do so and so even though it will never get printed",
    "start": "2334250",
    "end": "2340190"
  },
  {
    "text": "the strings are still there and so if you're a reverse or Dirac driver that's very very useful because all of a sudden",
    "start": "2340190",
    "end": "2346670"
  },
  {
    "text": "you're telling me what drivers doing and I don't have to you know spend a night looking at all this weird assembly so",
    "start": "2346670",
    "end": "2355520"
  },
  {
    "text": "when you when you make driver a new shipper make sure you delete all the debug code and not just the actual print",
    "start": "2355520",
    "end": "2362090"
  },
  {
    "text": "call but the surrounding code as well to make sure that you know you don't make it easier on people and you have to and",
    "start": "2362090",
    "end": "2368600"
  },
  {
    "text": "the third one I saw his camera which rabbit was but one of them made sort of their own library of all these energy",
    "start": "2368600",
    "end": "2374960"
  },
  {
    "text": "energy overflow routines which let's just say they it was there and ruling",
    "start": "2374960",
    "end": "2383990"
  },
  {
    "text": "the role for these kind of safety routines it's generally a bad idea because you know one mistake in you know",
    "start": "2383990",
    "end": "2389750"
  },
  {
    "text": "it doesn't and your entire safety goes away right whereas the winner scrum has its own immature library routines I mean",
    "start": "2389750",
    "end": "2397130"
  },
  {
    "text": "it's sort of a fixed point right if first of all they're very very well tested it's highly likely there'll be a",
    "start": "2397130",
    "end": "2402170"
  },
  {
    "text": "bug the windows leadership library routines and even if there are it's not your fault it's Microsoft and they'll fix it",
    "start": "2402170",
    "end": "2409109"
  },
  {
    "text": "when if you find one right so don't roll your own don't use the don't make your own",
    "start": "2409109",
    "end": "2414930"
  },
  {
    "text": "integer overflow checking functions used the ones that are in colonel they're",
    "start": "2414930",
    "end": "2419970"
  },
  {
    "text": "available to you stuff like archie eluent ad and so forth use those okay right okay that's the dry",
    "start": "2419970",
    "end": "2427680"
  },
  {
    "text": "stuff awesome so how do you so now right new floor then to talk to talk to that",
    "start": "2427680",
    "end": "2436079"
  },
  {
    "text": "work well turns out it's slightly more difficult than I thought it was because",
    "start": "2436079",
    "end": "2441690"
  },
  {
    "text": "while the API should document name is the N the actual headers they're not there you can't find them they're not",
    "start": "2441690",
    "end": "2448440"
  },
  {
    "text": "anywhere and this is mostly meant for OpenGL installment client drivers tough",
    "start": "2448440",
    "end": "2453509"
  },
  {
    "text": "so unless you're writing that you're not really supposed to be calling these things even though they're exported and",
    "start": "2453509",
    "end": "2459119"
  },
  {
    "text": "so there is there's a death kit for this and the name is Ian says well to obtain license you know email this team and so",
    "start": "2459119",
    "end": "2465630"
  },
  {
    "text": "and so I didn't I didn't do that because I wanted to get through the hackers point of view for this without having",
    "start": "2465630",
    "end": "2470819"
  },
  {
    "text": "that but because the structure of doc my name is Janna you know getting like a partially working implementation is",
    "start": "2470819",
    "end": "2476549"
  },
  {
    "text": "really easy because you just you know copy face room is the end to the editor and it works or if you don't want to use",
    "start": "2476549",
    "end": "2483660"
  },
  {
    "text": "that you could use the car api's but I'm not a huge fan anyway once you have",
    "start": "2483660",
    "end": "2488819"
  },
  {
    "text": "those headers working it's just a case of load library get proc address and you can start using these things okay so",
    "start": "2488819",
    "end": "2497059"
  },
  {
    "text": "once you have a full program and in I did all these tests what you really what what I really want to do is write a",
    "start": "2497059",
    "end": "2502710"
  },
  {
    "text": "program where I could hook the api's and see because every driver is different right and so I want to know what the",
    "start": "2502710",
    "end": "2508529"
  },
  {
    "text": "protocol is between UMD AMD and the only way to really see that is to sort of start snooping data see what what real",
    "start": "2508529",
    "end": "2514710"
  },
  {
    "text": "data looks like and so I wrote a small utility to sort of be like where I hook",
    "start": "2514710",
    "end": "2520799"
  },
  {
    "text": "escape render create allocation and it create afternoon full for for for a driver and then see what what happens",
    "start": "2520799",
    "end": "2527279"
  },
  {
    "text": "and where that happens and so I will see if I can demo this keep your fingers",
    "start": "2527279",
    "end": "2533369"
  },
  {
    "text": "crossed because you know demos don't always work so the the best program or an easy",
    "start": "2533369",
    "end": "2539069"
  },
  {
    "text": "program I found where you can easily snoop data is is Maxis PowerPoint if you",
    "start": "2539069",
    "end": "2544920"
  },
  {
    "text": "work because it's all graphics and every time you do a slight transition there's all sorts of rendering it has to happen and it you control the transition right",
    "start": "2544920",
    "end": "2550859"
  },
  {
    "text": "because you get to say when it's like girls I'm sorry I used make sure the PowerPoint Viewer and now that thus far",
    "start": "2550859",
    "end": "2556259"
  },
  {
    "text": "has worked pretty well when I first want to do is I wanted to have like a stock vanilla windows without any kind of",
    "start": "2556259",
    "end": "2563039"
  },
  {
    "text": "graph driver that is just the windows and I thought I had one of those in the VM of course I wake up this morning and I would fly through the presentation I",
    "start": "2563039",
    "end": "2569190"
  },
  {
    "text": "can't find two VM so I can't actually show you what a stock windows looks like when it does these things but uh I can't",
    "start": "2569190",
    "end": "2576089"
  },
  {
    "text": "show you but I can tell you basically furbish light transition if you have a stock windows without any kind of more",
    "start": "2576089",
    "end": "2581579"
  },
  {
    "text": "advanced graphics driver you'll see for every transition there will be like one call to render more call to render more call to render and that's pretty much it",
    "start": "2581579",
    "end": "2587900"
  },
  {
    "text": "this is a old netbook that I have it hasn't an old AMD cart but you get to",
    "start": "2587900",
    "end": "2595019"
  },
  {
    "text": "see all the magic that happens like the true magic of what these carts do like",
    "start": "2595019",
    "end": "2600269"
  },
  {
    "text": "the the stuff that happens behind your back but that makes things you know much better than if you just use standard",
    "start": "2600269",
    "end": "2605369"
  },
  {
    "text": "Windows cards so I picked some random presentation off the Internet I don't know what this is but so and then you",
    "start": "2605369",
    "end": "2613400"
  },
  {
    "text": "hook it okay and let's hope this works you do a slide transition and this is",
    "start": "2613400",
    "end": "2619019"
  },
  {
    "text": "all this is all AMD driver magic that happens behind your back right and this",
    "start": "2619019",
    "end": "2625890"
  },
  {
    "text": "this looks slow but it's only slow because I'm hooking it and my tool is really really slow but you'll see so",
    "start": "2625890",
    "end": "2632220"
  },
  {
    "text": "this is all so you see this is this will be an escape and this all these these all these bytes here that's that's AMD",
    "start": "2632220",
    "end": "2637710"
  },
  {
    "text": "that's AMD protocol right that's user goes to driver and says do this do this do this this isn't described anywhere else this",
    "start": "2637710",
    "end": "2644400"
  },
  {
    "text": "is and nothing there's no spec that's maybe there's but there's no public expect that says that's to be this or",
    "start": "2644400",
    "end": "2650339"
  },
  {
    "text": "this or this and so now once you sniffed it this thing is really important because once I know what you spider look",
    "start": "2650339",
    "end": "2655680"
  },
  {
    "text": "look like I could I can try and mimic it and see if I can get any bugs out of it right so did that that was my that was",
    "start": "2655680",
    "end": "2662549"
  },
  {
    "text": "my tool it'll be released it'll be",
    "start": "2662549",
    "end": "2667890"
  },
  {
    "text": "released on our website hopefully today but I can't guarantee that but anyway it'll be released soon uh so right so now we have",
    "start": "2667890",
    "end": "2675600"
  },
  {
    "text": "all that how do put it all together right so fuzzing so once we have a",
    "start": "2675600",
    "end": "2680850"
  },
  {
    "text": "snooping tool creating a mutating fuzzer is relatively easy right you take crap hold on there we go right",
    "start": "2680850",
    "end": "2690690"
  },
  {
    "text": "so and it is that this so yeah putting it all together fuzzing reverse engineering so once we have to the",
    "start": "2690690",
    "end": "2697470"
  },
  {
    "text": "snooping tool you just take the data I just showed you and you can sort of write a tool around and says well that you take that as your template right to",
    "start": "2697470",
    "end": "2703920"
  },
  {
    "text": "fallow by it's you you you saw which sniffer right you know that's valid because that was a MD client talked AMD",
    "start": "2703920",
    "end": "2709680"
  },
  {
    "text": "you slant on AMD kernel and it succeeded so you know that's a valid and you so you try to take that and then mutate it",
    "start": "2709680",
    "end": "2717090"
  },
  {
    "text": "and see if something happens or if nothing happens and and so as I build a",
    "start": "2717090",
    "end": "2722310"
  },
  {
    "text": "small fuss around that that that that does that and so you basically do that in a loop and until hopefully something",
    "start": "2722310",
    "end": "2730470"
  },
  {
    "text": "crashed and if it doesn't you you if he doesn't know I'll get back down in exercise but I also have a small name of",
    "start": "2730470",
    "end": "2737520"
  },
  {
    "text": "that and I hope it'll work but okay okay",
    "start": "2737520",
    "end": "2747330"
  },
  {
    "text": "let's see if this will works yeah oh yeah there we go so that so that",
    "start": "2747330",
    "end": "2753950"
  },
  {
    "text": "if you just start meeting this stuff these things crash and so I did I did I",
    "start": "2753950",
    "end": "2761850"
  },
  {
    "text": "did report this to the MD guys and they they have fixed it and I was told that there's gonna be an update somewhere in",
    "start": "2761850",
    "end": "2767730"
  },
  {
    "text": "August this month you probably might know more about this",
    "start": "2767730",
    "end": "2772160"
  },
  {
    "text": "right so the problems in this a new driver the problems that I found with this fuzzer then report AMD and they fix",
    "start": "2780259",
    "end": "2786029"
  },
  {
    "text": "them and the Apache are coming out somewhere this month yeah so they're coming out few days few weeks so this",
    "start": "2786029",
    "end": "2791789"
  },
  {
    "text": "stuff's going to get fixed soon so this is how easy can be defensive stuff right",
    "start": "2791789",
    "end": "2797759"
  },
  {
    "text": "so you basically do this in the loop and then you know folks come out so sometimes server steering will be",
    "start": "2797759",
    "end": "2803699"
  },
  {
    "text": "needed because you want to see you know what the bug looks like what it is how it works right and so there's actually",
    "start": "2803699",
    "end": "2810900"
  },
  {
    "text": "this book about version that came out a few months ago and my buddy Bruce Dan wrote it and he had this interesting",
    "start": "2810900",
    "end": "2816630"
  },
  {
    "text": "quote which I just have to put in here oh god damn it yeah there we go so that says if the process of for",
    "start": "2816630",
    "end": "2823799"
  },
  {
    "text": "engineering windows drivers could be modeled as discrete tasks 90% is understanding how the thing works and",
    "start": "2823799",
    "end": "2829949"
  },
  {
    "text": "only 10% is understanding assembly that is all to build up until this has been there because otherwise you can read all",
    "start": "2829949",
    "end": "2835289"
  },
  {
    "text": "the assembly you want you don't know what it means right now that we know what is what the callback looks like and",
    "start": "2835289",
    "end": "2840509"
  },
  {
    "text": "we know what the arguments look like reverse any of your stuff is trivial right it becomes really easy so I've",
    "start": "2840509",
    "end": "2846479"
  },
  {
    "text": "shown before right you do this dx/dt initialize and you pass it a callback and this stuff is actually a little bit",
    "start": "2846479",
    "end": "2851969"
  },
  {
    "text": "tricky when you look at it first time in December because DX jkh lies is an",
    "start": "2851969",
    "end": "2857519"
  },
  {
    "text": "inline function which means you don't go out and call it there's no there's",
    "start": "2857519",
    "end": "2862679"
  },
  {
    "text": "there's no symbol for this it's just it's assembly that gets sort of mapped into your image right and so you",
    "start": "2862679",
    "end": "2869219"
  },
  {
    "text": "basically this I did this is a I made I made a debug driver so that's because you see a symbol because it comes with a",
    "start": "2869219",
    "end": "2875579"
  },
  {
    "text": "PD file but usually you just see a call to you know an address so just look like",
    "start": "2875579",
    "end": "2882150"
  },
  {
    "text": "when you get this call to this function and in this function basically okay so",
    "start": "2882150",
    "end": "2888119"
  },
  {
    "text": "basically what happens is how does this callback really work well it goes and loads the DX kernel it it's usually",
    "start": "2888119",
    "end": "2896099"
  },
  {
    "text": "already there but in case it's not it gets loaded and what I think it's loaded you get a pointer to a device object and",
    "start": "2896099",
    "end": "2901199"
  },
  {
    "text": "you do a knock hole Nats bias object video device function 10 min either on",
    "start": "2901199",
    "end": "2906929"
  },
  {
    "text": "the access I don't know exactly what that does but that's what that's what this function does so and then",
    "start": "2906929",
    "end": "2912000"
  },
  {
    "text": "back function pointer and you call that function pointer would with the method",
    "start": "2912000",
    "end": "2917850"
  },
  {
    "text": "you you register right and everything is because because of stuff in line and so you won't see that call you'll just see",
    "start": "2917850",
    "end": "2924060"
  },
  {
    "text": "these these set of instructions that do this so when you see this or D set of",
    "start": "2924060",
    "end": "2929400"
  },
  {
    "text": "things that's when you know a call back it's right the set of callbacks get registered the table itself is",
    "start": "2929400",
    "end": "2938400"
  },
  {
    "text": "interesting because that's where you find a callback right that's where only entry points are so you want to find that thing right it's it's it can be",
    "start": "2938400",
    "end": "2945270"
  },
  {
    "text": "created or shortened different ways and it's usually pretty trivial to find these things it'll be you know they'll",
    "start": "2945270",
    "end": "2951900"
  },
  {
    "text": "be fill out on the stack or they'll have some dedicated function to fill out a global array of these things are usually pretty easy to find like it'll look",
    "start": "2951900",
    "end": "2958440"
  },
  {
    "text": "something like this where like this will be a dedicated function that just you know writes a bunch of callbacks to a to",
    "start": "2958440",
    "end": "2965250"
  },
  {
    "text": "a global structure or this is something that writes just to the sack and then that pointer to that array it gets",
    "start": "2965250",
    "end": "2970710"
  },
  {
    "text": "handed back to kernel and the actual structure looks like this right it's",
    "start": "2970710",
    "end": "2977370"
  },
  {
    "text": "basically just the structure of all these callbacks and some of which are they'll be they'll be escape and",
    "start": "2977370",
    "end": "2984090"
  },
  {
    "text": "render and query adapter and so forth and so mapping these mapping this structure back to the Ida stuff is",
    "start": "2984090",
    "end": "2991050"
  },
  {
    "text": "pretty easy and I started doing it here but this this stuff is really is pretty easy so once you get to the stuff where",
    "start": "2991050",
    "end": "2999390"
  },
  {
    "text": "you get to private and handling right this is where it gets interesting this is sort of where once you see that in a disassembler it feels very much like",
    "start": "2999390",
    "end": "3005750"
  },
  {
    "text": "you're looking at a network protocol handler where you get a pointer in the",
    "start": "3005750",
    "end": "3011210"
  },
  {
    "text": "length and it does and you'll have like a it will generally have like a header with like a type link value and then",
    "start": "3011210",
    "end": "3017180"
  },
  {
    "text": "it'll work based on whatever to type it's a little it'll call back into all these things and you'll see like a",
    "start": "3017180",
    "end": "3022190"
  },
  {
    "text": "switch case right this is this is one driver I came in which one it is but it's it's it's pretty much where you",
    "start": "3022190",
    "end": "3028250"
  },
  {
    "text": "know they'll go well this is the callback and then this is the type and then for every type there's basically",
    "start": "3028250",
    "end": "3033500"
  },
  {
    "text": "not a function that gets called right so this is this is pretty standard stuff like once you get here like you can you also you kind of start smelling the bugs",
    "start": "3033500",
    "end": "3040100"
  },
  {
    "text": "you like you know where's the good stuff right so that this is we're searching",
    "start": "3040100",
    "end": "3045590"
  },
  {
    "text": "these you get identikit a little bit excited but this that once you get there it's",
    "start": "3045590",
    "end": "3051200"
  },
  {
    "text": "that's that's where the good stuff happens right so when you start doing combine to Swit runtime testing one it",
    "start": "3051200",
    "end": "3058670"
  },
  {
    "text": "so one of the things you want to look at is sort of the return values basically gives you says you tells you either",
    "start": "3058670",
    "end": "3064309"
  },
  {
    "text": "failure or success and then failure",
    "start": "3064309",
    "end": "3069769"
  },
  {
    "text": "success usually zero and success will be any number of anti status codes usually the one you see the most but something",
    "start": "3069769",
    "end": "3075559"
  },
  {
    "text": "wrong happen is status invalid parameter which is 0xe a bunch of zeros D and when",
    "start": "3075559",
    "end": "3081410"
  },
  {
    "text": "you do like when you fuss the stuff in a loop and you see everything comes back with just status develop parameter",
    "start": "3081410",
    "end": "3087469"
  },
  {
    "text": "without anything else that usually means that the driver has some kind of very early on length checking and I've seen",
    "start": "3087469",
    "end": "3095329"
  },
  {
    "text": "some of them have it some of them don't I think this one came from the Intel driver and so basically this is this",
    "start": "3095329",
    "end": "3102440"
  },
  {
    "text": "function called direct like immediately after the DHD callback and basically you",
    "start": "3102440",
    "end": "3111949"
  },
  {
    "text": "see basically that they say well driver size has to be at least this length and the length has to match exactly with",
    "start": "3111949",
    "end": "3119528"
  },
  {
    "text": "the link has to match exactly we just embed a link if you like and once you see that piece of code you'd be like oh",
    "start": "3119680",
    "end": "3125959"
  },
  {
    "text": "well now if I just implement this logic in my fuzzer you get past all this stuff and all the sudden you run the fuzzer",
    "start": "3125959",
    "end": "3131900"
  },
  {
    "text": "and there's like immediate blue screens right so so if you see this a behavior",
    "start": "3131900",
    "end": "3138140"
  },
  {
    "text": "where just everything stands Val parameter just go look for that early bound check somewhere because once you",
    "start": "3138140",
    "end": "3143569"
  },
  {
    "text": "get past that you know the fuzzer starts finding stuff again so yeah as a summary",
    "start": "3143569",
    "end": "3149930"
  },
  {
    "text": "so pretty much almost done yeah wvm has been around since Vista it's evolved over time there are several interesting",
    "start": "3149930",
    "end": "3155239"
  },
  {
    "text": "trust management entry points escape render location query adapter there might be a few others but I just haven't",
    "start": "3155239",
    "end": "3161509"
  },
  {
    "text": "gotten around to it like in WDM for Windows 8.1 they add there was support",
    "start": "3161509",
    "end": "3167059"
  },
  {
    "text": "at it for a miracast which is this remote display protocol which may have interesting attack service but haven't",
    "start": "3167059",
    "end": "3173779"
  },
  {
    "text": "gotten there yet most of the attacks are of control data sent from unity community is not saying eyes anyway",
    "start": "3173779",
    "end": "3179640"
  },
  {
    "text": "gets implanted anyway they want which is interesting because that's your attack surface right so it's it's not structured like like WDM drivers there's",
    "start": "3179640",
    "end": "3187020"
  },
  {
    "text": "no works there's no iocked holes there's none of that you know what the last okay",
    "start": "3187020",
    "end": "3197430"
  },
  {
    "text": "so as a conclusion this has been pretty much untouched attack service up until",
    "start": "3197430",
    "end": "3203040"
  },
  {
    "text": "now I start looking at this stuff and you make this fuzzer and most of drivers you try it against they'll all fall at",
    "start": "3203040",
    "end": "3210030"
  },
  {
    "text": "some point so it's interesting to see that that it's untouched AK service and",
    "start": "3210030",
    "end": "3215430"
  },
  {
    "text": "and so there's work to be done here but I think it's gonna get better so I reported to DMV you guys for",
    "start": "3215430",
    "end": "3220710"
  },
  {
    "text": "example and then they fixed a bunch of these things and I've ordered some others and they're working on patches too so I'm I think it's going to get",
    "start": "3220710",
    "end": "3228630"
  },
  {
    "text": "better but at the present time it's not great and so there's some work to be done but it'll get better I think anyway",
    "start": "3228630",
    "end": "3236850"
  },
  {
    "text": "that's it anybody have any questions speak now forever hold your peace",
    "start": "3236850",
    "end": "3243380"
  },
  {
    "text": "so so your question is whether when I think about the design of WDM in terms of entry point and intact surface okay",
    "start": "3255830",
    "end": "3265300"
  },
  {
    "text": "there are some things I like there some things I didn't whenever you have like",
    "start": "3265300",
    "end": "3271040"
  },
  {
    "text": "probing capturing I think that's good because it takes away a lot of the attacks Rufus I think things would be you'd have less",
    "start": "3271040",
    "end": "3279650"
  },
  {
    "text": "attack surface or things that are easily more easily checked or controlled when you have a more structured way of passing data of course the downside of",
    "start": "3279650",
    "end": "3287120"
  },
  {
    "text": "that is that you as the driver developer lose some control right so it's this",
    "start": "3287120",
    "end": "3292970"
  },
  {
    "text": "double it's sort the other ones of course you know stuff like when you do a renderer and you get all these you slant",
    "start": "3292970",
    "end": "3299530"
  },
  {
    "text": "pointers there's a lot of extra checking that needs to happen and obviously you could optimize that and do pro mean",
    "start": "3299530",
    "end": "3305180"
  },
  {
    "text": "capturing but then you lose performance right so it's you get this weird trade-off so I think overall it's I",
    "start": "3305180",
    "end": "3311180"
  },
  {
    "text": "think it's good there's very few things where I go like you know this one's really bad but you you can see where the",
    "start": "3311180",
    "end": "3316520"
  },
  {
    "text": "guys who designed stuff at Microsoft sat down and said well this is a trade-off right we could do this better for",
    "start": "3316520",
    "end": "3322520"
  },
  {
    "text": "security but it would cost us right and if you're talking about graphics you know you want performance right you want",
    "start": "3322520",
    "end": "3327530"
  },
  {
    "text": "that stuff right so some trainers have to be made I think it's pretty good I from a security point of view I like it",
    "start": "3327530",
    "end": "3333230"
  },
  {
    "text": "yeah things that could be better but the previous model who is a lot worse so I think it's pretty good yeah did I answer",
    "start": "3333230",
    "end": "3341570"
  },
  {
    "text": "the question awesome any other questions oh yeah oh yeah am I going to read the",
    "start": "3341570",
    "end": "3351650"
  },
  {
    "text": "faster ah that's a good question I still haven't made up my mind yet I'm planning",
    "start": "3351650",
    "end": "3357230"
  },
  {
    "text": "to at some point maybe you know I think if I do it right now it'll piss off a",
    "start": "3357230",
    "end": "3363440"
  },
  {
    "text": "number of people I want to release you trust me it's a question I've asked myself for a while and hopefully at some",
    "start": "3363440",
    "end": "3370280"
  },
  {
    "text": "point but I can't say that right now any",
    "start": "3370280",
    "end": "3377600"
  },
  {
    "text": "other questions also yes I'm done thanks for listening hope you enjoyed it",
    "start": "3377600",
    "end": "3386500"
  }
]