[
  {
    "text": "[Music] foreign",
    "start": "1730",
    "end": "6720"
  },
  {
    "text": "security expert at Ledger my daily rule is to evaluate Hardware wallets against fault injection and search General",
    "start": "10880",
    "end": "17279"
  },
  {
    "text": "attacks and today I'm going to present unlimited results breaking firmware",
    "start": "17279",
    "end": "22380"
  },
  {
    "text": "encryption of esp32 V3 it's a joint work between me and Olivier rivo and Adrienne",
    "start": "22380",
    "end": "28800"
  },
  {
    "text": "tier well why I'm going to to do this presentation today",
    "start": "28800",
    "end": "36239"
  },
  {
    "text": "I think most of you you know esp32 it's a very well-known microcontroller it's a",
    "start": "36239",
    "end": "42000"
  },
  {
    "text": "low power SOC it has been deployed in the market since several years and espresso actually",
    "start": "42000",
    "end": "49500"
  },
  {
    "text": "announced it's selling like 100 million devices in the market by 2018.",
    "start": "49500",
    "end": "54780"
  },
  {
    "text": "and what's very important for me is that it recently it has been deployed as a main microcontroller",
    "start": "54780",
    "end": "60719"
  },
  {
    "text": "in the hardware wallet called Zed the vendor is block stream and if you are going to open the",
    "start": "60719",
    "end": "67500"
  },
  {
    "text": "hardware wallet actually you are going to find an esp32 V3 chip and also an",
    "start": "67500",
    "end": "73080"
  },
  {
    "text": "external flash memory however the external flash memory is used to store the an encrypted firmware however the",
    "start": "73080",
    "end": "81360"
  },
  {
    "text": "firmware encryption key is stored in the esp32 V3 so my role actually is to evaluate this",
    "start": "81360",
    "end": "87840"
  },
  {
    "text": "Hardware wallet against fault injection and search channel attacks in order to extract this key",
    "start": "87840",
    "end": "95600"
  },
  {
    "text": "why esp32v3 not esp32v1 for example by",
    "start": "95939",
    "end": "101340"
  },
  {
    "text": "the way there is no any esp32 V2 so regarding esp32v1 it was attacked by",
    "start": "101340",
    "end": "108659"
  },
  {
    "text": "limited results in 2019 the main idea is that they already",
    "start": "108659",
    "end": "113700"
  },
  {
    "text": "attacked the secure Boot and Flash encryption mechanisms they used power a",
    "start": "113700",
    "end": "119460"
  },
  {
    "text": "powerful injection using bar glitches in order to perturb the effuse protection bits during the",
    "start": "119460",
    "end": "126719"
  },
  {
    "text": "power up and after successful forces they already obtained the ifuse keys the",
    "start": "126719",
    "end": "133080"
  },
  {
    "text": "firmware encryption and secure boot keys as a reaction against this attack",
    "start": "133080",
    "end": "138180"
  },
  {
    "text": "expressive announced esp32v3 by 20 2020 and the main idea is to patch",
    "start": "138180",
    "end": "147120"
  },
  {
    "text": "a the new version against the the attack of limited results",
    "start": "147120",
    "end": "152520"
  },
  {
    "text": "so the new version esp32v3 has several features",
    "start": "152520",
    "end": "158340"
  },
  {
    "text": "like new secure boot they use a an RSA based secure boot in order to avoid",
    "start": "158340",
    "end": "164400"
  },
  {
    "text": "storing any private keys inside the effuse and also as announced by espresso",
    "start": "164400",
    "end": "169739"
  },
  {
    "text": "that the new version contains Contour measures against fault injection attacks by hardware and software",
    "start": "169739",
    "end": "177980"
  },
  {
    "text": "well the outline of my presentation first I'm going to present the security feature of esp32 V3",
    "start": "178920",
    "end": "186599"
  },
  {
    "text": "and also after that I'm going to to show you a homemade fault injection setup that I'm going to use it in order to",
    "start": "186599",
    "end": "193140"
  },
  {
    "text": "evaluate esp32 V1 I mean to reproduce attack of limited results using",
    "start": "193140",
    "end": "198420"
  },
  {
    "text": "electromagnetic filter injection and after that applying the same scenario on esp32v3",
    "start": "198420",
    "end": "205260"
  },
  {
    "text": "and after that I'm going to discover a new attack path using side Channel attacks to break the firmware encryption",
    "start": "205260",
    "end": "212340"
  },
  {
    "text": "and then I'm going to to make the attack practical on a hardware wallet I mean",
    "start": "212340",
    "end": "217739"
  },
  {
    "text": "the jet Hardware wallet that I already showed previously and I'm going to terminate by the vendor reply and the",
    "start": "217739",
    "end": "223680"
  },
  {
    "text": "conclusion so regarding the esp32 security features",
    "start": "223680",
    "end": "229799"
  },
  {
    "text": "well esp32 has a lot of features but let me concentrate on the security feature",
    "start": "229799",
    "end": "234959"
  },
  {
    "text": "of the chip itself so it has secure boot it has flash encryption and also 128",
    "start": "234959",
    "end": "241980"
  },
  {
    "text": "bytes of OTP in order to store some secrets and also",
    "start": "241980",
    "end": "247140"
  },
  {
    "text": "some crypto Hardware accelerators such as es RSA",
    "start": "247140",
    "end": "252379"
  },
  {
    "text": "random number generators and elliptic curve as well you can use the ESP tool",
    "start": "252379",
    "end": "257519"
  },
  {
    "text": "in order to activate the above features and the ESP tool it's an open source tool which delivered by espressive and",
    "start": "257519",
    "end": "264900"
  },
  {
    "text": "you can find it online on GitHub for example well regarding the ifuse organization",
    "start": "264900",
    "end": "271500"
  },
  {
    "text": "the ifus as I told you it's like 128 bytes and it's divided into four slots",
    "start": "271500",
    "end": "278759"
  },
  {
    "text": "for example the first slots the first slot is used and reserved for the system for the system purposes in order to",
    "start": "278759",
    "end": "286139"
  },
  {
    "text": "store the setting of the of the chip itself I mean the the flash encryption mode the secure boot if it's activated",
    "start": "286139",
    "end": "292680"
  },
  {
    "text": "or not for example and you can find block one and block 2 in order to store flash encryption keys and also the",
    "start": "292680",
    "end": "299820"
  },
  {
    "text": "secure boot keys in a row and the last slot block 3 is used for the user application itself",
    "start": "299820",
    "end": "306120"
  },
  {
    "text": "well let me say that it's impossible to to get access by the software on block",
    "start": "306120",
    "end": "311699"
  },
  {
    "text": "one and block two because they are protected using ifuse protection bits",
    "start": "311699",
    "end": "316919"
  },
  {
    "text": "which are restored in the boot ROM itself and uh the only entity which is",
    "start": "316919",
    "end": "322500"
  },
  {
    "text": "responsible for reading those keys actually is is a hardware of esp32 that",
    "start": "322500",
    "end": "328320"
  },
  {
    "text": "already use this kind of of keys during the power up in order to whatever to to",
    "start": "328320",
    "end": "335160"
  },
  {
    "text": "perform the flash decryption or to perform as well as a secure boot",
    "start": "335160",
    "end": "340560"
  },
  {
    "text": "well let me talk about secure Boot and they have two versions of secure boot",
    "start": "340560",
    "end": "345780"
  },
  {
    "text": "they have secure boot version one for example so the main idea is that if you have a firmware the firmware had it has",
    "start": "345780",
    "end": "353100"
  },
  {
    "text": "a good loader and the public key the main idea is that you have a key which is stored in Block 2 for example which",
    "start": "353100",
    "end": "359940"
  },
  {
    "text": "is responsible for the secure Boot and this key is used to encrypt the bootloader and the public key using",
    "start": "359940",
    "end": "366800"
  },
  {
    "text": "es-256 and after that the output is hashed using shaft 512 in order to",
    "start": "366800",
    "end": "372300"
  },
  {
    "text": "generate what we call a digest and the digestive the digest is a store outside",
    "start": "372300",
    "end": "378120"
  },
  {
    "text": "in the in the flash memory and during the power up the same process is executed",
    "start": "378120",
    "end": "384960"
  },
  {
    "text": "and after that the comparison is performed in order to to take the decision to continue or not based on the",
    "start": "384960",
    "end": "391560"
  },
  {
    "text": "comparison if it's correct or not well regarding regarding the flash encryption",
    "start": "391560",
    "end": "397259"
  },
  {
    "text": "as I told you it's a security feature of esp32 the main idea is to protect the the",
    "start": "397259",
    "end": "404160"
  },
  {
    "text": "firmware which is stored outside in the external flash from any axis",
    "start": "404160",
    "end": "411060"
  },
  {
    "text": "well as a flash encryption uses block one for uh for encrypting and decrypting",
    "start": "411060",
    "end": "417060"
  },
  {
    "text": "the Flash content and in order to encrypt The Flash they use es decryption and in order to",
    "start": "417060",
    "end": "423840"
  },
  {
    "text": "decrypt The Flash they use es encryption and the during the power up the flash",
    "start": "423840",
    "end": "428880"
  },
  {
    "text": "decryption for example is performed however they use something called the key tweak in order to change the key",
    "start": "428880",
    "end": "436139"
  },
  {
    "text": "every 32 bytes and this key tweak is like an address dependent so if you know",
    "start": "436139",
    "end": "442500"
  },
  {
    "text": "the address you can generate the key tweak so at the end you will find it will be like a constant and it's only",
    "start": "442500",
    "end": "448979"
  },
  {
    "text": "used to change the key of research to two bytes the first slot which is is manipulated",
    "start": "448979",
    "end": "454979"
  },
  {
    "text": "from the flesh during the power up is a bootloader data which is is stored",
    "start": "454979",
    "end": "460860"
  },
  {
    "text": "at address uh one key decimal hexadecim so you can use the following commands in",
    "start": "460860",
    "end": "467099"
  },
  {
    "text": "order to activate and store uh the flash encryption key through the ESP tool",
    "start": "467099",
    "end": "475380"
  },
  {
    "text": "theft the attack of limited results well as a concentrated on glitching the ifuse",
    "start": "475380",
    "end": "482220"
  },
  {
    "text": "protection bits during the power up you can see here in the red the already register support trace the power",
    "start": "482220",
    "end": "488940"
  },
  {
    "text": "consumption Trace during the power up and in yellow is a voltage as a voltage",
    "start": "488940",
    "end": "494220"
  },
  {
    "text": "source to the to the chip itself you can find that during the power up they start to inject some glitches you can see here",
    "start": "494220",
    "end": "501120"
  },
  {
    "text": "the voltage drop and this is the correct moment that the already glitched the",
    "start": "501120",
    "end": "506220"
  },
  {
    "text": "ifuse protection bits once they already performed a successful fault after that",
    "start": "506220",
    "end": "511500"
  },
  {
    "text": "they can execute the memory read command in order to dump the ifuse slots containing the flash encryption key and",
    "start": "511500",
    "end": "517440"
  },
  {
    "text": "the secure boot let me talk now about the voltage",
    "start": "517440",
    "end": "524580"
  },
  {
    "text": "injection setup why we need or why we perform uh fault",
    "start": "524580",
    "end": "531060"
  },
  {
    "text": "faults so the main idea is to perturb the chip during the execution of sensitive operations for example if you",
    "start": "531060",
    "end": "538320"
  },
  {
    "text": "if you have a secure boot which is running you can inject let me say electromagnetic fault",
    "start": "538320",
    "end": "544620"
  },
  {
    "text": "injection or laser or pole power fault injection in order to bypass the the",
    "start": "544620",
    "end": "549779"
  },
  {
    "text": "security or the or the signature verification during the execution of secure boot",
    "start": "549779",
    "end": "555899"
  },
  {
    "text": "and also if you have an es which is running you can inject faults during the execution of the es in order to execute",
    "start": "555899",
    "end": "563640"
  },
  {
    "text": "or to attack the key using a differential filter analysis for example",
    "start": "563640",
    "end": "569540"
  },
  {
    "text": "well I'm going to concentrate in my evaluation about electromagnetic faulty injection and I'm",
    "start": "572040",
    "end": "579480"
  },
  {
    "text": "going to use a homemade fault injection tool we call it silicon toaster in order",
    "start": "579480",
    "end": "584880"
  },
  {
    "text": "to inject the electromagnetic pulses the main idea that you have a very high",
    "start": "584880",
    "end": "589980"
  },
  {
    "text": "voltage which is stored in the caps and this voltage actually is applied to the or into the electromagnetic",
    "start": "589980",
    "end": "597500"
  },
  {
    "text": "electromagnetic probe here which is like a coil in order to generate a current",
    "start": "597500",
    "end": "603120"
  },
  {
    "text": "and the current is going to generate an electromagnetic field and the electromagnetic field is going to be in",
    "start": "603120",
    "end": "608820"
  },
  {
    "text": "touch with the surface of the chip trying to generate or to perturb the",
    "start": "608820",
    "end": "613920"
  },
  {
    "text": "chip and trying to inject faults the tool is able to inject faults up to",
    "start": "613920",
    "end": "619320"
  },
  {
    "text": "one k volts and I'm going to use it for the evolution",
    "start": "619320",
    "end": "626420"
  },
  {
    "text": "well in order to obtain a very stable setup we decided to fabricate a BCB",
    "start": "626580",
    "end": "632399"
  },
  {
    "text": "so the main idea is that you have an esp32 here and on the top of the PCB",
    "start": "632399",
    "end": "639540"
  },
  {
    "text": "and after that there's the external flash and we select it actually to have some vdd pins or eyes here in order to",
    "start": "639540",
    "end": "647700"
  },
  {
    "text": "control the value of the vdt during the experiment and also there is an external",
    "start": "647700",
    "end": "653160"
  },
  {
    "text": "oscillator here in order to control the clock well regarding the electromagnetic",
    "start": "653160",
    "end": "659820"
  },
  {
    "text": "faulty injection setup so I'm using a silicon toaster in order to inject the electromagnetic pulses and also I'm",
    "start": "659820",
    "end": "666600"
  },
  {
    "text": "using an oscillator here in order to monitor the power consumption during the",
    "start": "666600",
    "end": "671940"
  },
  {
    "text": "experiment and I'm using the x y z table here in order to move the Probe on the",
    "start": "671940",
    "end": "678000"
  },
  {
    "text": "surface of the chip and also I'm using a scaffold which is a board which is fabricated inside our",
    "start": "678000",
    "end": "686240"
  },
  {
    "text": "the computer well the dictionary",
    "start": "688079",
    "end": "694200"
  },
  {
    "text": "for the first time I'm trying to to prove that the ability of of of the",
    "start": "694200",
    "end": "701339"
  },
  {
    "text": "electromagnetic voltage injection tool in order to inject successful faults so I'm going to first apply",
    "start": "701339",
    "end": "708839"
  },
  {
    "text": "um fault injection on a glitchable application on a very simple application code on esp32v1 the only thing to do",
    "start": "708839",
    "end": "717060"
  },
  {
    "text": "that the target actually is to is to be sure that the the tools that I have is",
    "start": "717060",
    "end": "722940"
  },
  {
    "text": "effective and to keep some parameters in order to go for the next step so next step of",
    "start": "722940",
    "end": "728579"
  },
  {
    "text": "course is to reproduce the attack of limited results and after that I'm going to follow the",
    "start": "728579",
    "end": "734040"
  },
  {
    "text": "same scenario that I did on esp32v1 and repeat it again on esp62 V3 to see if",
    "start": "734040",
    "end": "740339"
  },
  {
    "text": "there's a difference or not well let's talk about the electromagnetic fault injection on",
    "start": "740339",
    "end": "746279"
  },
  {
    "text": "esp62v1 you can see here on the left this is a",
    "start": "746279",
    "end": "751500"
  },
  {
    "text": "glitchable code there is a loop and the main idea is to inject a code to",
    "start": "751500",
    "end": "758180"
  },
  {
    "text": "the counter and on the same time I'm going to to scan the electromagnetic Probe on the chip surface here",
    "start": "760500",
    "end": "769279"
  },
  {
    "text": "well after scanning all the chip surface using 500 voltage I mean the is a pulse",
    "start": "771360",
    "end": "777959"
  },
  {
    "text": "value and regarding the polarity of the of the pulse I mean I'm injecting a positive polarity and I'm scanning 500",
    "start": "777959",
    "end": "785339"
  },
  {
    "text": "trials per spot and the motor stable is like to 200 micrometer I found here",
    "start": "785339",
    "end": "792839"
  },
  {
    "text": "upper on the right I found a very interesting Zone where I obtained successful faults that I was able to to",
    "start": "792839",
    "end": "800279"
  },
  {
    "text": "skip from the loop so this means that the fault injection tool that I have is effective and I can obtain some",
    "start": "800279",
    "end": "805740"
  },
  {
    "text": "successful faults using it so now the next step is to reproduce now the attack of limited results on esp62v1",
    "start": "805740",
    "end": "813899"
  },
  {
    "text": "well the steps is that I followed it's like the first thing is that you have you",
    "start": "813899",
    "end": "819480"
  },
  {
    "text": "have a firmware you encrypt you store the firmware encrypted and the external flash",
    "start": "819480",
    "end": "825360"
  },
  {
    "text": "and after that you enable uh you enables a firmware encryption through is a",
    "start": "825360",
    "end": "831660"
  },
  {
    "text": "command that I show here and after that I started to track the power consumption of the chip during",
    "start": "831660",
    "end": "837800"
  },
  {
    "text": "or while the flash encryption is enabled I found that",
    "start": "837800",
    "end": "842880"
  },
  {
    "text": "there is a very interesting early activity here after the power up",
    "start": "842880",
    "end": "848040"
  },
  {
    "text": "that may be very interesting in order to shoot or to inject faults during this period why because I make I'm expecting",
    "start": "848040",
    "end": "854220"
  },
  {
    "text": "that the if use fault the ifuse protection bits are manipulated during this this time",
    "start": "854220",
    "end": "861600"
  },
  {
    "text": "well so the scenario that I use the I used only one single filter injection",
    "start": "861600",
    "end": "866700"
  },
  {
    "text": "pulse here it's a count and after that I'm going to initialize the policy generator to to deliver like the pulse",
    "start": "866700",
    "end": "873300"
  },
  {
    "text": "switch and also the offset and to control them and after that I'm going to restart the chip and the during the",
    "start": "873300",
    "end": "879180"
  },
  {
    "text": "restart I'm going to inject some faults and in case of a successful fault after",
    "start": "879180",
    "end": "884339"
  },
  {
    "text": "that I'm go I'm going to execute the read memory command in order to dump the effuse",
    "start": "884339",
    "end": "891560"
  },
  {
    "text": "surface I already obtained some successful faults however I obtained two different",
    "start": "892139",
    "end": "898560"
  },
  {
    "text": "successful faults here you can find after the experiment log for example",
    "start": "898560",
    "end": "904260"
  },
  {
    "text": "here Loop Number Four you can find this is the correct key that that I already stored however in five I flipped the",
    "start": "904260",
    "end": "913440"
  },
  {
    "text": "this key by only one one bit here why there is only one bit difference",
    "start": "913440",
    "end": "919800"
  },
  {
    "text": "because there is a chance that when I injected the faulted during the power up maybe I also corrupted the the value of",
    "start": "919800",
    "end": "927660"
  },
  {
    "text": "the ifus which are manipulated from from the chip itself so this it's not a",
    "start": "927660",
    "end": "933120"
  },
  {
    "text": "permanent fault actually but it may happen if you if you already inject a",
    "start": "933120",
    "end": "938220"
  },
  {
    "text": "fault during a certain time during its power up",
    "start": "938220",
    "end": "943339"
  },
  {
    "text": "so I started to register the board traces in case of successful faults and",
    "start": "943560",
    "end": "948899"
  },
  {
    "text": "here you can find this is the correct timing and you can find here the effect of the electromagnetic uh pulse during",
    "start": "948899",
    "end": "955920"
  },
  {
    "text": "the power up and on the right here you can find the The Zone where I already",
    "start": "955920",
    "end": "961199"
  },
  {
    "text": "obtained the successful Force",
    "start": "961199",
    "end": "964940"
  },
  {
    "text": "evaluation so I already you injected successful faults in order to dump the",
    "start": "967199",
    "end": "973139"
  },
  {
    "text": "ifuse reproducing the attack of limited results on asp32v1 I used only a single fault",
    "start": "973139",
    "end": "980339"
  },
  {
    "text": "single fault pulse and the success rate was close to 0.6 percentage",
    "start": "980339",
    "end": "986639"
  },
  {
    "text": "and now lets me pre-produce or take the same scenario on esp32 V3",
    "start": "986639",
    "end": "993959"
  },
  {
    "text": "well let me recap the counter measures that has been added to uh to esp32 V3 so zero",
    "start": "993959",
    "end": "1003279"
  },
  {
    "text": "more es for example so the store only is public key which is not secret and safe",
    "start": "1005300",
    "end": "1011480"
  },
  {
    "text": "uses and also the new version is hard is hardened against faulty injection attacks and software on the hardware as",
    "start": "1011480",
    "end": "1018800"
  },
  {
    "text": "announced by expressive and also they added another features called uart disable in order to stop the",
    "start": "1018800",
    "end": "1025220"
  },
  {
    "text": "communication with the bootstrom to execute this kind of read memory commands",
    "start": "1025220",
    "end": "1030760"
  },
  {
    "text": "so the same scenario I have the glitchable application and I started to scan again",
    "start": "1031220",
    "end": "1036459"
  },
  {
    "text": "esp32 V3 chip using the electromagnetic fault injection",
    "start": "1036459",
    "end": "1042260"
  },
  {
    "text": "I kept the same attack parameters and I obtained also a successful fault I'm I",
    "start": "1042260",
    "end": "1048199"
  },
  {
    "text": "mean trying to skip from the loop of the glitchable application so I was able to",
    "start": "1048199",
    "end": "1053780"
  },
  {
    "text": "to skip successfully from this Loop and you can find here there is a very interesting Zone that I already obtained",
    "start": "1053780",
    "end": "1059840"
  },
  {
    "text": "successful faults well this means that esp62v3 is not equipped with a fault",
    "start": "1059840",
    "end": "1067760"
  },
  {
    "text": "injection counter measures like for example glitch detectors or something like that so the chip doesn't have any",
    "start": "1067760",
    "end": "1073760"
  },
  {
    "text": "Contour measures against fault injection but let me now try the attack of the",
    "start": "1073760",
    "end": "1078980"
  },
  {
    "text": "effus uh on asp32 V3 I followed the same scenario I have a",
    "start": "1078980",
    "end": "1086179"
  },
  {
    "text": "key I stored it in the fuses I enabled the firmware flash encryption and I",
    "start": "1086179",
    "end": "1091580"
  },
  {
    "text": "stored the encrypted flash in the external memory and I started to to track the power",
    "start": "1091580",
    "end": "1098179"
  },
  {
    "text": "consumption and I found that the power consumption during the power up in case of esp32 V3 is completely different from",
    "start": "1098179",
    "end": "1105380"
  },
  {
    "text": "esp32 V1 so you can see now the difference there there is a three uh different blocks",
    "start": "1105380",
    "end": "1112400"
  },
  {
    "text": "which are added here so this means that they don't have the same boot ROM",
    "start": "1112400",
    "end": "1118460"
  },
  {
    "text": "they may have some verification blocks which are added in order to fight against fault injection attacks well",
    "start": "1118460",
    "end": "1124760"
  },
  {
    "text": "this means that I need multiple faults in order to perform a successful attack",
    "start": "1124760",
    "end": "1130280"
  },
  {
    "text": "so I changed the attack scenario I try to randomize the number of faults and also I follow",
    "start": "1130280",
    "end": "1137600"
  },
  {
    "text": "the same scenario here I initialize the policy generator and also I restarted the chip trying to inject faults during",
    "start": "1137600",
    "end": "1143360"
  },
  {
    "text": "the power up and after that in case of a successful fault I already I will execute the if you read memory command",
    "start": "1143360",
    "end": "1152059"
  },
  {
    "text": "I would like to stress here on not activating that you are disabled for the moment okay",
    "start": "1152059",
    "end": "1159679"
  },
  {
    "text": "well unfortunately I have not obtained any successful fault the only thing that",
    "start": "1159679",
    "end": "1164900"
  },
  {
    "text": "I obtained I obtained zeros which is the case that the success the fault is not",
    "start": "1164900",
    "end": "1170480"
  },
  {
    "text": "successful or I obtained as a timeout why I obtained a lot of timeout that ship got crashed several times because",
    "start": "1170480",
    "end": "1176960"
  },
  {
    "text": "of I injected electromagnetic faulty injection several pulses in a row so",
    "start": "1176960",
    "end": "1182000"
  },
  {
    "text": "this means that the electromagnetic fault injection is very aggressive to the chip if you are injecting several",
    "start": "1182000",
    "end": "1187940"
  },
  {
    "text": "pulses in a row try and the chip got crashed several times actually so for",
    "start": "1187940",
    "end": "1193880"
  },
  {
    "text": "the moment I'm I'm like in a situation that okay I have a new version of the",
    "start": "1193880",
    "end": "1199100"
  },
  {
    "text": "chip it seems that esp32v3 has a different boot drum that contains counter measures",
    "start": "1199100",
    "end": "1205160"
  },
  {
    "text": "against fault injection attacks and multiple fault faults may be needed but unfortunately using electromagnetic",
    "start": "1205160",
    "end": "1212360"
  },
  {
    "text": "faulty injection several pulses are very aggressive to this achievement I obtained a lot of time out so I have to",
    "start": "1212360",
    "end": "1219440"
  },
  {
    "text": "find another attack scenario or another attack path well during the the investigation of the",
    "start": "1219440",
    "end": "1226520"
  },
  {
    "text": "ifuse attack I started to look at the documents of expressive trying to find something different to do so I just",
    "start": "1226520",
    "end": "1234320"
  },
  {
    "text": "found that they didn't talk about side Channel attacks there is no any counter measure so maybe if I'm going to switch",
    "start": "1234320",
    "end": "1241400"
  },
  {
    "text": "the text scenario to side Channel attacks and targeting The Flash decryption maybe I'm going to gain",
    "start": "1241400",
    "end": "1248419"
  },
  {
    "text": "well so it's a motivation for me to have a chip that which already batched",
    "start": "1248419",
    "end": "1253760"
  },
  {
    "text": "and to find another attack scenario so what I'm I I have been thinking to do is",
    "start": "1253760",
    "end": "1259039"
  },
  {
    "text": "to Target The Flash encryption decryption during the power up and after that if I will do that",
    "start": "1259039",
    "end": "1266360"
  },
  {
    "text": "successfully I can control the flash content and after that I can perform what we call correlation power analysis",
    "start": "1266360",
    "end": "1273320"
  },
  {
    "text": "in order to attack the flesh encryption or decryption key but before",
    "start": "1273320",
    "end": "1280419"
  },
  {
    "text": "describing the attack in detail let me stress on some search channel basics",
    "start": "1280419",
    "end": "1285919"
  },
  {
    "text": "for example like leakage detection so why we need leakage detection so assume that you have an es and the es is",
    "start": "1285919",
    "end": "1292640"
  },
  {
    "text": "running on on on on a chip and the power consumption of the chip",
    "start": "1292640",
    "end": "1297679"
  },
  {
    "text": "for example is very low and you are not able to identify the rounds of the es so it's better to perform this kind of of",
    "start": "1297679",
    "end": "1304400"
  },
  {
    "text": "statistical tools like leakage detection in order to localize exactly where is",
    "start": "1304400",
    "end": "1309559"
  },
  {
    "text": "the ES so we use it actually to reduce the time of the evaluation and there are several techniques in the",
    "start": "1309559",
    "end": "1317419"
  },
  {
    "text": "literature that you can find for example the SNR the signal to noise ratio in icv",
    "start": "1317419",
    "end": "1323059"
  },
  {
    "text": "or the t-test for example here I'm I'm going to use SNR signal to noise ratio that you can uh use it using the for the",
    "start": "1323059",
    "end": "1331820"
  },
  {
    "text": "following formula here where X is the real trades real portraits and Y is a",
    "start": "1331820",
    "end": "1337039"
  },
  {
    "text": "label uh of the value regarding the correlation power analysis",
    "start": "1337039",
    "end": "1343640"
  },
  {
    "text": "it's a it's a very well known side Channel attack and the main idea is that for example if",
    "start": "1343640",
    "end": "1348679"
  },
  {
    "text": "you have an es or you have a crypto operation and when you measure the power consumption during the execution of this",
    "start": "1348679",
    "end": "1354620"
  },
  {
    "text": "crypto operation the power consumption is like a key dependent so this means that",
    "start": "1354620",
    "end": "1359780"
  },
  {
    "text": "if you have an es and you are going to register the power consumption traces during the execution of this es you can",
    "start": "1359780",
    "end": "1366559"
  },
  {
    "text": "build an offline model for example trying to assume all the keys if you are",
    "start": "1366559",
    "end": "1372500"
  },
  {
    "text": "targeting one byte of the key so you are going to have a 256 assumptions of the",
    "start": "1372500",
    "end": "1377720"
  },
  {
    "text": "key and after that the correct assumption is going to give the maximum correlation between the model and the",
    "start": "1377720",
    "end": "1384740"
  },
  {
    "text": "measurement itself well after the model you can use several leakage leakage",
    "start": "1384740",
    "end": "1389960"
  },
  {
    "text": "models such as Heming weight or Hamming distance for example and if you are targeting the yes we prefer we always",
    "start": "1389960",
    "end": "1396440"
  },
  {
    "text": "prefer to perform the Hamming weight on the Xbox's output of the Xbox because we we believe that the Xbox is the most",
    "start": "1396440",
    "end": "1403460"
  },
  {
    "text": "consuming part during the execution of the ES so China Tech setup so what I need for",
    "start": "1403460",
    "end": "1410419"
  },
  {
    "text": "the moment I need a high-end oscilloscope in order to capture the power traces during the power up",
    "start": "1410419",
    "end": "1416360"
  },
  {
    "text": "and also I have an esp32 chip on the top of scaffold board and after that I'm",
    "start": "1416360",
    "end": "1422659"
  },
  {
    "text": "going to enable The Flash encryption mechanism let me recap again what happens during",
    "start": "1422659",
    "end": "1429679"
  },
  {
    "text": "the flash encryption so it's used to protect the external memory and there is a key which is stored in",
    "start": "1429679",
    "end": "1436700"
  },
  {
    "text": "Block one which is used for encrypting and decrypting the Flash and this key is tweaked every 32 bytes",
    "start": "1436700",
    "end": "1443480"
  },
  {
    "text": "however the first address which is manipulated from the external flash is address 1K which is a bootloader which",
    "start": "1443480",
    "end": "1451039"
  },
  {
    "text": "is stored in the external flash so this means that if I can control the the",
    "start": "1451039",
    "end": "1456980"
  },
  {
    "text": "address which is uh which is like a bootloader it's external flash and then I can Target the the firmware decryption",
    "start": "1456980",
    "end": "1465380"
  },
  {
    "text": "during the power up I can gain and I can perform this kind of Channel attacks",
    "start": "1465380",
    "end": "1471760"
  },
  {
    "text": "well I started to to look at the power consumption during during the power up",
    "start": "1472280",
    "end": "1479000"
  },
  {
    "text": "while the firmware encryption is is activated so you can find here in red",
    "start": "1479000",
    "end": "1484400"
  },
  {
    "text": "the power consumption of the chip and in yellow I started to spy on the",
    "start": "1484400",
    "end": "1489980"
  },
  {
    "text": "SPI clock of the external flash in order to see where the data is manipulated",
    "start": "1489980",
    "end": "1495500"
  },
  {
    "text": "because as I told you the first slot which is manipulated is the bootloader which is stored at address 1K so you can",
    "start": "1495500",
    "end": "1502880"
  },
  {
    "text": "see here there are two slots flash encryption one I mean the communication",
    "start": "1502880",
    "end": "1508659"
  },
  {
    "text": "one and also communication too and after that there are two zones A and B so for",
    "start": "1508659",
    "end": "1516200"
  },
  {
    "text": "the moment the first slot of the bootloader I mean the first 32 bytes are manipulated",
    "start": "1516200",
    "end": "1522100"
  },
  {
    "text": "whether in a or in B zone so in order to know exactly where the the 32 bytes are",
    "start": "1522100",
    "end": "1530539"
  },
  {
    "text": "manipulated I am going to perform an SNR on the value of the bootloader itself so",
    "start": "1530539",
    "end": "1536120"
  },
  {
    "text": "I'm going to follow the scenario I have some some random 32 bytes for example to",
    "start": "1536120",
    "end": "1542059"
  },
  {
    "text": "generate and after that I'm going to raise the Flash and write is a bytes on the flash at address",
    "start": "1542059",
    "end": "1548659"
  },
  {
    "text": "one key this hexadecimal and after that I'm going to restart the chip and then",
    "start": "1548659",
    "end": "1554120"
  },
  {
    "text": "capture a Power Trace well I started to look at Zone a for",
    "start": "1554120",
    "end": "1560059"
  },
  {
    "text": "example and running the SNR on the on the bootloader values and it seems that the SNR curve is here",
    "start": "1560059",
    "end": "1567620"
  },
  {
    "text": "the 32 values of the of the of the of the bootloader you can find here the SNR",
    "start": "1567620",
    "end": "1573440"
  },
  {
    "text": "is very noisy so this means that um the first 32 bytes are not manipulated",
    "start": "1573440",
    "end": "1579380"
  },
  {
    "text": "during the Zone actually and after that I tried to to do the same but around Zoom B for example so I find",
    "start": "1579380",
    "end": "1587360"
  },
  {
    "text": "a very a very clear SNR here you can find a 32",
    "start": "1587360",
    "end": "1593320"
  },
  {
    "text": "Peaks that means that the values the 32 bytes of the bootloader are manipulated",
    "start": "1593320",
    "end": "1600080"
  },
  {
    "text": "here in Zoom B so this means that after manipulating the first slot from the",
    "start": "1600080",
    "end": "1606140"
  },
  {
    "text": "bootloader so this means that the flash decryption is performed just after",
    "start": "1606140",
    "end": "1611480"
  },
  {
    "text": "in order to know where is the es exactly performing",
    "start": "1611480",
    "end": "1617000"
  },
  {
    "text": "you can see that I have a 32 bytes are manipulated from uh from The Flash",
    "start": "1617000",
    "end": "1623000"
  },
  {
    "text": "are divided into 16 bytes each one and after that there is an es which is running two times in order to decrypt",
    "start": "1623000",
    "end": "1630020"
  },
  {
    "text": "The Flash so I started to um to trigger where the ciphertext of the",
    "start": "1630020",
    "end": "1636860"
  },
  {
    "text": "first slot and the second slot is the ciphertext are manipulated where exactly so now I can see that okay I have the",
    "start": "1636860",
    "end": "1644840"
  },
  {
    "text": "SNL on the plain text in the zoom and also I have for example the ciphertext",
    "start": "1644840",
    "end": "1649940"
  },
  {
    "text": "the SNL on the ciphertext so in between there will be the ES so I targeted the SNR of the first slot",
    "start": "1649940",
    "end": "1657320"
  },
  {
    "text": "of the ciphertext I find there are some bytes which are here so this means that",
    "start": "1657320",
    "end": "1663740"
  },
  {
    "text": "the es encryption of the first slot are executed just before",
    "start": "1663740",
    "end": "1669140"
  },
  {
    "text": "and also I I repeated the same to Target the snare of the of the last 16 bytes of",
    "start": "1669140",
    "end": "1677360"
  },
  {
    "text": "the bootloader which is a store that address one key here so this means that",
    "start": "1677360",
    "end": "1683179"
  },
  {
    "text": "before the zones there is the es which is executed so now I'm pretty sure about",
    "start": "1683179",
    "end": "1688400"
  },
  {
    "text": "the es where it's manipulated I mean the es for example of the second part of the",
    "start": "1688400",
    "end": "1694880"
  },
  {
    "text": "bootloader so it may be manipulated here actually so I can perform the side channel here",
    "start": "1694880",
    "end": "1702080"
  },
  {
    "text": "well for the moment I don't have the ability to store several keys and change the key every",
    "start": "1702080",
    "end": "1709220"
  },
  {
    "text": "time on the OTP because it's like on OTP so I won't be able to to know where the",
    "start": "1709220",
    "end": "1715880"
  },
  {
    "text": "intermediate values of of the years are manipulated but in order to be sure from",
    "start": "1715880",
    "end": "1721779"
  },
  {
    "text": "the time zone of the execution of the years I started to reverse the results of the CPA I know for example history",
    "start": "1721779",
    "end": "1728600"
  },
  {
    "text": "and I started to to Target the history to run correlation",
    "start": "1728600",
    "end": "1734240"
  },
  {
    "text": "power analysis and to see the maximum correlation of the Q3 for example where I can find the maximum Peak so if I can",
    "start": "1734240",
    "end": "1741500"
  },
  {
    "text": "find the maximum peak of the correct key this means that yes this zone is the es where uh where's for example the second",
    "start": "1741500",
    "end": "1749500"
  },
  {
    "text": "bootloader slot are encrypted during this Zoom so I found several maximum",
    "start": "1749500",
    "end": "1755480"
  },
  {
    "text": "peaks of K3 for example the correct history here one two and three so now I'm pretty sure",
    "start": "1755480",
    "end": "1762260"
  },
  {
    "text": "that the es is executed here but the problems that I have now is that I",
    "start": "1762260",
    "end": "1768380"
  },
  {
    "text": "already okay I I managed to get 100K traces but using the external flash",
    "start": "1768380",
    "end": "1773419"
  },
  {
    "text": "every time I write and erase uh there is The Flash writing and erasing limitation",
    "start": "1773419",
    "end": "1778700"
  },
  {
    "text": "so I'm I'm just limited with 100K traces so every time I have to uh I have to",
    "start": "1778700",
    "end": "1784940"
  },
  {
    "text": "remove the remove the Flash and solder another another Flash and I found there is uh there's a certain difference",
    "start": "1784940",
    "end": "1790700"
  },
  {
    "text": "between the behavior because of the noise that that may be generated from",
    "start": "1790700",
    "end": "1795880"
  },
  {
    "text": "changing the flesh every time so we took the decision actually in order to to",
    "start": "1795880",
    "end": "1802279"
  },
  {
    "text": "make a flash emulator I mean to to store the 32 bytes the random 32 bytes on",
    "start": "1802279",
    "end": "1807380"
  },
  {
    "text": "shift register on a scaffold and deliver it to the MCU during the power up so in",
    "start": "1807380",
    "end": "1812539"
  },
  {
    "text": "this case I will be able to register unlimited traces",
    "start": "1812539",
    "end": "1817480"
  },
  {
    "text": "well when I removed the Flash and I used the flash Emirate emulator I was able to",
    "start": "1817640",
    "end": "1823039"
  },
  {
    "text": "to find and improve actually the signal to noise ratio of the of the power consumption",
    "start": "1823039",
    "end": "1828860"
  },
  {
    "text": "and you can find here for example several Power traces which are uh which are up to to each other's and what",
    "start": "1828860",
    "end": "1836779"
  },
  {
    "text": "I used here I used a very simple alignment to in order to align them to to be ready for performing this kind of",
    "start": "1836779",
    "end": "1842720"
  },
  {
    "text": "correlation power analysis and I started to track history the",
    "start": "1842720",
    "end": "1847820"
  },
  {
    "text": "correct history for example so I found here this is a maximum correlation of the correct key I mean Q3 you can find",
    "start": "1847820",
    "end": "1854720"
  },
  {
    "text": "it's a it's a there's a very big difference between the correct key and other key assumptions so this means that",
    "start": "1854720",
    "end": "1861260"
  },
  {
    "text": "I'm able to perform a correlation power analysis here successfully well regarding the model",
    "start": "1861260",
    "end": "1868399"
  },
  {
    "text": "uh the leakage model that I used I used the Hamming weight for the for the first",
    "start": "1868399",
    "end": "1873500"
  },
  {
    "text": "round and for the second round I use the Hamming distance between the two boxes of the first round and the second round",
    "start": "1873500",
    "end": "1879220"
  },
  {
    "text": "and and actually this this kind of tweak to find the model of the second round it",
    "start": "1879220",
    "end": "1886159"
  },
  {
    "text": "helped me to to attack some keys that I already I was not able to attack them using the normal Hamming weight model",
    "start": "1886159",
    "end": "1893840"
  },
  {
    "text": "like the first round otherwise you are going to find three keys which are not very well uh",
    "start": "1893840",
    "end": "1900559"
  },
  {
    "text": "attacked successfully so you have to do some Brute Force attacks for example in order to attack those keys",
    "start": "1900559",
    "end": "1907520"
  },
  {
    "text": "well so now I was able to collect more traces I was able to for example to get",
    "start": "1907520",
    "end": "1912820"
  },
  {
    "text": "2 million traces so I got I got like 2 million traces I aligned with them and I",
    "start": "1912820",
    "end": "1918620"
  },
  {
    "text": "started to uh to to perform what we call a key rank in order to measure the",
    "start": "1918620",
    "end": "1924620"
  },
  {
    "text": "success of the uh of the attack I mean the key rank when you increase number of traces the correct key should goes to",
    "start": "1924620",
    "end": "1931340"
  },
  {
    "text": "one this means this is the correct key and I was able to attack all the keys",
    "start": "1931340",
    "end": "1936620"
  },
  {
    "text": "except key zero for example within like 400k traces however if you would like to",
    "start": "1936620",
    "end": "1942380"
  },
  {
    "text": "attack k0 and you don't like to brute force it you have to wait for example for uh two million traces in order to",
    "start": "1942380",
    "end": "1948559"
  },
  {
    "text": "attack it successfully well for the moment I have to also",
    "start": "1948559",
    "end": "1954679"
  },
  {
    "text": "activate the other security features of esp32 V3 like secure Boot and uart",
    "start": "1954679",
    "end": "1961460"
  },
  {
    "text": "disable and for me actually this kind of security features are not very important",
    "start": "1961460",
    "end": "1967220"
  },
  {
    "text": "because a secure boot is already executed after the flash decryption so the first the first operation that which",
    "start": "1967220",
    "end": "1975020"
  },
  {
    "text": "is performed is The Flash encryption and also for the UR disabled here we don't care about you all disabled because we",
    "start": "1975020",
    "end": "1981320"
  },
  {
    "text": "we are not communicating with the chip uh with the boot ROM of the chip in order to execute this kind of read",
    "start": "1981320",
    "end": "1986659"
  },
  {
    "text": "memory command because I'm using uh the flash emulator",
    "start": "1986659",
    "end": "1992840"
  },
  {
    "text": "so after activating all the security features I was able to attack all the",
    "start": "1992840",
    "end": "1998059"
  },
  {
    "text": "keys all the keys of firmware encryption that used for firmware encryptions and 32",
    "start": "1998059",
    "end": "2003700"
  },
  {
    "text": "bytes of the key as I told you there is only key zero here which is not stable but you have to wait for more traces up",
    "start": "2003700",
    "end": "2011799"
  },
  {
    "text": "to one one million and a half for example to to get a very stable attack or to Brute Force risky and this is very",
    "start": "2011799",
    "end": "2019059"
  },
  {
    "text": "easy actually so it was a practical attack now so I started to invest the attack results",
    "start": "2019059",
    "end": "2025419"
  },
  {
    "text": "that I obtained in order to uh to attack the hardware wallet that I mentioned it",
    "start": "2025419",
    "end": "2031480"
  },
  {
    "text": "at the beginning which is Jed wallet it's a block Stream So as I told you that Z is an open source and open",
    "start": "2031480",
    "end": "2038320"
  },
  {
    "text": "Hardware wallet unfortunately it doesn't store the pin inside the MCU itself the",
    "start": "2038320",
    "end": "2043539"
  },
  {
    "text": "pin is is verified on the server of block stream",
    "start": "2043539",
    "end": "2048638"
  },
  {
    "text": "so the only thing that I can perform now is the FL the",
    "start": "2048639",
    "end": "2054339"
  },
  {
    "text": "the external flash it has a public key and a private key of the user that can communicate with a server of block",
    "start": "2054339",
    "end": "2060940"
  },
  {
    "text": "Stream So if I am able to uh if I'm able to attack the private key of",
    "start": "2060940",
    "end": "2066760"
  },
  {
    "text": "the user this means that I can clone the device and inject some back doors",
    "start": "2066760",
    "end": "2072358"
  },
  {
    "text": "so what I did actually is just to remove the esp32 from V3 from the from the red",
    "start": "2074080",
    "end": "2081280"
  },
  {
    "text": "wallet and plug it inside my setup just solder it in on the PCB and it start to",
    "start": "2081280",
    "end": "2086858"
  },
  {
    "text": "repeat the experiment and I was able to dump all the keys as I told you within like 400 kit races",
    "start": "2086859",
    "end": "2094960"
  },
  {
    "text": "I have all the keys except key zero which can be brought forced easily",
    "start": "2094960",
    "end": "2101040"
  },
  {
    "text": "so now you can find that this is the encrypted firmware of that and I use the keys that I already dumped by side",
    "start": "2101380",
    "end": "2107500"
  },
  {
    "text": "Channel attack in order to decrypt and I was able to obtain the private key of the user that which is used for the",
    "start": "2107500",
    "end": "2113740"
  },
  {
    "text": "communication with the block stream server so now I can clone the wallet I can",
    "start": "2113740",
    "end": "2119020"
  },
  {
    "text": "inject the back door for example to perform transaction to substituted addresses what we call like even made attack",
    "start": "2119020",
    "end": "2127380"
  },
  {
    "text": "let me talk about the vendor reply and the conclusion I started to communicate with espressive",
    "start": "2129880",
    "end": "2136660"
  },
  {
    "text": "in October last year and we started to to talk each other",
    "start": "2136660",
    "end": "2142900"
  },
  {
    "text": "about the counter measures and how they can improve the product actually and in",
    "start": "2142900",
    "end": "2149140"
  },
  {
    "text": "may they published an a security advisory about the attack and the conclusion of the security advisory is",
    "start": "2149140",
    "end": "2155619"
  },
  {
    "text": "that this attack is applicable to all esp32 chips in the market including esp32 V3 and period versions",
    "start": "2155619",
    "end": "2164820"
  },
  {
    "text": "esp32 S2 C3 S3 well and unfortunately they won't be",
    "start": "2164820",
    "end": "2171820"
  },
  {
    "text": "able to patch this kind of vulnerabilities what they have to do is to change the Silicon and and actually in their security",
    "start": "2171820",
    "end": "2179079"
  },
  {
    "text": "advisory they wrote that the future products of espresso food contain this",
    "start": "2179079",
    "end": "2184240"
  },
  {
    "text": "kind of Contour measures against side Channel attacks so let me conclude",
    "start": "2184240",
    "end": "2191859"
  },
  {
    "text": "you can see that I already presented a a deep Hardware evaluation for asp32 V3",
    "start": "2191859",
    "end": "2198700"
  },
  {
    "text": "using electromagnetic filter injection and side Channel attacks so by experimental results I proved that esp32",
    "start": "2198700",
    "end": "2205300"
  },
  {
    "text": "has a hardened boot ROM against faulty injection attacks",
    "start": "2205300",
    "end": "2210579"
  },
  {
    "text": "and also when I found that I am not able to attack the trip using electromagnetic",
    "start": "2210579",
    "end": "2217119"
  },
  {
    "text": "fault injection I changed the scenario the text scenario to side Channel attacks and I was able to dump the",
    "start": "2217119",
    "end": "2223599"
  },
  {
    "text": "overall key which is used for the firmware encryption using like 400k traces",
    "start": "2223599",
    "end": "2229900"
  },
  {
    "text": "and the attack is generic and works on all the products of espressive",
    "start": "2229900",
    "end": "2235780"
  },
  {
    "text": "and well at the end I would like just to say that protecting against faulty injection is not sufficient and also the",
    "start": "2235780",
    "end": "2241839"
  },
  {
    "text": "vendor should consider this kind of attacks and to combine them with the faulty injection so this means that if",
    "start": "2241839",
    "end": "2248320"
  },
  {
    "text": "you if you are a vendor so you have to consider seriously combining fault injection inside Channel attacks counter",
    "start": "2248320",
    "end": "2254260"
  },
  {
    "text": "measures together thank you very much foreign",
    "start": "2254260",
    "end": "2260280"
  },
  {
    "text": "[Music]",
    "start": "2260280",
    "end": "2263399"
  },
  {
    "text": "[Music]",
    "start": "2267240",
    "end": "2270340"
  }
]