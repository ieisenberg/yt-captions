[
  {
    "start": "0",
    "end": "22000"
  },
  {
    "text": "Aloha and welcome to my talk on",
    "start": "30",
    "end": "2280"
  },
  {
    "text": "offensive malware analysis so my name is",
    "start": "2280",
    "end": "5730"
  },
  {
    "text": "Patrick I've worked for a variety of",
    "start": "5730",
    "end": "8160"
  },
  {
    "text": "acronym places I'm currently the chief",
    "start": "8160",
    "end": "10410"
  },
  {
    "text": "security researcher at cynic so briefly",
    "start": "10410",
    "end": "12870"
  },
  {
    "text": "semuc does crowdsource upon our ability",
    "start": "12870",
    "end": "15179"
  },
  {
    "text": "to discovery with vetted security",
    "start": "15179",
    "end": "17070"
  },
  {
    "text": "researchers I'd love to chat more about",
    "start": "17070",
    "end": "18630"
  },
  {
    "text": "this after the talk or check out cynic",
    "start": "18630",
    "end": "21330"
  },
  {
    "text": "calm okay so today we're gonna be",
    "start": "21330",
    "end": "24480"
  },
  {
    "start": "22000",
    "end": "68000"
  },
  {
    "text": "talking about analyzing an intriguing",
    "start": "24480",
    "end": "26849"
  },
  {
    "text": "piece of mac malware named a fruit fly",
    "start": "26849",
    "end": "29310"
  },
  {
    "text": "but the way we're gonna do this analysis",
    "start": "29310",
    "end": "31439"
  },
  {
    "text": "is somewhat different so we're gonna",
    "start": "31439",
    "end": "33719"
  },
  {
    "text": "start with a brief overview of the",
    "start": "33719",
    "end": "35550"
  },
  {
    "text": "malware and this brief triage your goal",
    "start": "35550",
    "end": "38100"
  },
  {
    "text": "is basically so that we have enough of",
    "start": "38100",
    "end": "40710"
  },
  {
    "text": "an understanding so that we can build a",
    "start": "40710",
    "end": "42629"
  },
  {
    "text": "custom command and control server we're",
    "start": "42629",
    "end": "45120"
  },
  {
    "text": "then gonna talk about some tools and",
    "start": "45120",
    "end": "46950"
  },
  {
    "text": "techniques that allow us to monitor the",
    "start": "46950",
    "end": "50100"
  },
  {
    "text": "malware while we task it we're then",
    "start": "50100",
    "end": "52260"
  },
  {
    "text": "going to jump into building the custom",
    "start": "52260",
    "end": "54059"
  },
  {
    "text": "command control server before talking",
    "start": "54059",
    "end": "56039"
  },
  {
    "text": "about tasking uh which will allow us to",
    "start": "56039",
    "end": "58620"
  },
  {
    "text": "understand its capabilities by just",
    "start": "58620",
    "end": "60600"
  },
  {
    "text": "asking the right questions and then",
    "start": "60600",
    "end": "62340"
  },
  {
    "text": "finally we'll talk about what happened",
    "start": "62340",
    "end": "63960"
  },
  {
    "text": "when I put this custom command and",
    "start": "63960",
    "end": "65760"
  },
  {
    "text": "control server on the internet so the",
    "start": "65760",
    "end": "69330"
  },
  {
    "start": "68000",
    "end": "117000"
  },
  {
    "text": "goal here is to comprehensively analyze",
    "start": "69330",
    "end": "71939"
  },
  {
    "text": "fruit fly but do do so in a more",
    "start": "71939",
    "end": "74250"
  },
  {
    "text": "efficient way so traditional methods of",
    "start": "74250",
    "end": "77130"
  },
  {
    "text": "malware analysis are usually done with",
    "start": "77130",
    "end": "79320"
  },
  {
    "text": "debuggers or disassemblies and yeah",
    "start": "79320",
    "end": "81780"
  },
  {
    "text": "these techniques work but they're rather",
    "start": "81780",
    "end": "83700"
  },
  {
    "text": "slow now I didn't have access to a",
    "start": "83700",
    "end": "87150"
  },
  {
    "text": "command and control server but I figured",
    "start": "87150",
    "end": "89369"
  },
  {
    "text": "if I wrote my own I then be able to task",
    "start": "89369",
    "end": "92549"
  },
  {
    "text": "the malware and then observe its",
    "start": "92549",
    "end": "94710"
  },
  {
    "text": "responses this process then I assumed",
    "start": "94710",
    "end": "97500"
  },
  {
    "text": "would allow me to coerce the malware to",
    "start": "97500",
    "end": "100259"
  },
  {
    "text": "reveal its capabilities simply by asking",
    "start": "100259",
    "end": "102360"
  },
  {
    "text": "the right questions I figured this",
    "start": "102360",
    "end": "104520"
  },
  {
    "text": "technique would be a lot faster and an",
    "start": "104520",
    "end": "106829"
  },
  {
    "text": "upside is in some way you can take over",
    "start": "106829",
    "end": "109470"
  },
  {
    "text": "the domain or the address that the",
    "start": "109470",
    "end": "111180"
  },
  {
    "text": "malware is beginning to perhaps you can",
    "start": "111180",
    "end": "113189"
  },
  {
    "text": "hijack all the attackers pieces of",
    "start": "113189",
    "end": "115770"
  },
  {
    "text": "malware so as I mentioned the target of",
    "start": "115770",
    "end": "118920"
  },
  {
    "text": "this analysis is a Mac malware specimen",
    "start": "118920",
    "end": "121890"
  },
  {
    "text": "named fruit fly now before we build our",
    "start": "121890",
    "end": "125100"
  },
  {
    "text": "custom command and control server we",
    "start": "125100",
    "end": "127259"
  },
  {
    "text": "need to perform a basic triage so we can",
    "start": "127259",
    "end": "129569"
  },
  {
    "text": "answer two questions and that is what",
    "start": "129569",
    "end": "132330"
  },
  {
    "text": "address does the malware try to connect",
    "start": "132330",
    "end": "134700"
  },
  {
    "text": "to for its command control server and",
    "start": "134700",
    "end": "136950"
  },
  {
    "text": "then also what protocol does it speak",
    "start": "136950",
    "end": "138629"
  },
  {
    "text": "this will allow us then to create a",
    "start": "138629",
    "end": "140370"
  },
  {
    "text": "custom command and control server that",
    "start": "140370",
    "end": "142410"
  },
  {
    "text": "is compatible with Malory so a fruit fly",
    "start": "142410",
    "end": "146250"
  },
  {
    "start": "145000",
    "end": "186000"
  },
  {
    "text": "was discovered in January by my friend",
    "start": "146250",
    "end": "148500"
  },
  {
    "text": "Thomas Reid at Malwarebytes and he",
    "start": "148500",
    "end": "150959"
  },
  {
    "text": "blogged about it giving a great overview",
    "start": "150959",
    "end": "152940"
  },
  {
    "text": "of the capabilities of the malware he",
    "start": "152940",
    "end": "155370"
  },
  {
    "text": "also talked about various components and",
    "start": "155370",
    "end": "157500"
  },
  {
    "text": "it's method method of persistence it's a",
    "start": "157500",
    "end": "160620"
  },
  {
    "text": "fairly standard backdoor but it's very",
    "start": "160620",
    "end": "162629"
  },
  {
    "text": "feature complete and has some unusual",
    "start": "162629",
    "end": "164550"
  },
  {
    "text": "features that are more surveillance",
    "start": "164550",
    "end": "167030"
  },
  {
    "text": "related for example can turn on the",
    "start": "167030",
    "end": "169440"
  },
  {
    "text": "webcam and even interact with the mouse",
    "start": "169440",
    "end": "171360"
  },
  {
    "text": "and keyboard now we don't know the",
    "start": "171360",
    "end": "173670"
  },
  {
    "text": "infection vector but if we had to guess",
    "start": "173670",
    "end": "175349"
  },
  {
    "text": "maybe a malicious email document Trojan",
    "start": "175349",
    "end": "178080"
  },
  {
    "text": "application an infected website however",
    "start": "178080",
    "end": "180989"
  },
  {
    "text": "we never found an installer so perhaps",
    "start": "180989",
    "end": "182970"
  },
  {
    "text": "there's a different infection mechanism",
    "start": "182970",
    "end": "185099"
  },
  {
    "text": "altogether so today we're gonna be",
    "start": "185099",
    "end": "187890"
  },
  {
    "start": "186000",
    "end": "218000"
  },
  {
    "text": "talking about variant B marionette B was",
    "start": "187890",
    "end": "190620"
  },
  {
    "text": "submitted to virustotal a few weeks",
    "start": "190620",
    "end": "192659"
  },
  {
    "text": "after variant a and even though variant",
    "start": "192659",
    "end": "195300"
  },
  {
    "text": "a at the time was being detected by",
    "start": "195300",
    "end": "197610"
  },
  {
    "text": "antivirus engines variant B originally",
    "start": "197610",
    "end": "199980"
  },
  {
    "text": "was not now was submitted to virus total",
    "start": "199980",
    "end": "202920"
  },
  {
    "text": "with the name of fps odd",
    "start": "202920",
    "end": "204870"
  },
  {
    "text": "I believe that's to mimic a common flash",
    "start": "204870",
    "end": "207510"
  },
  {
    "text": "player component and like various like",
    "start": "207510",
    "end": "210120"
  },
  {
    "text": "variant a the main malware component was",
    "start": "210120",
    "end": "213360"
  },
  {
    "text": "an obvious gated Perl script and Perl",
    "start": "213360",
    "end": "215940"
  },
  {
    "text": "kind of interesting so as I mentioned",
    "start": "215940",
    "end": "219299"
  },
  {
    "start": "218000",
    "end": "261000"
  },
  {
    "text": "our goal is to build a custom command",
    "start": "219299",
    "end": "221159"
  },
  {
    "text": "and control server and so we need to",
    "start": "221159",
    "end": "223290"
  },
  {
    "text": "know the address that the malware tries",
    "start": "223290",
    "end": "225030"
  },
  {
    "text": "to connect out to so we can place our",
    "start": "225030",
    "end": "226860"
  },
  {
    "text": "command control server there at least in",
    "start": "226860",
    "end": "228299"
  },
  {
    "text": "a lab setup and then also understand its",
    "start": "228299",
    "end": "230819"
  },
  {
    "text": "protocol so that we can communicate with",
    "start": "230819",
    "end": "232890"
  },
  {
    "text": "them our so let's now briefly talk about",
    "start": "232890",
    "end": "235980"
  },
  {
    "text": "triaging the script to get this",
    "start": "235980",
    "end": "238080"
  },
  {
    "text": "information so the first thing we can do",
    "start": "238080",
    "end": "240510"
  },
  {
    "text": "is we can beautify the scripts its",
    "start": "240510",
    "end": "242790"
  },
  {
    "text": "obfuscated minimized perl so by",
    "start": "242790",
    "end": "244709"
  },
  {
    "text": "beautifying it variable names and",
    "start": "244709",
    "end": "246900"
  },
  {
    "text": "subroutines are still obvious gated or",
    "start": "246900",
    "end": "248730"
  },
  {
    "text": "meaningless but at least it's formatted",
    "start": "248730",
    "end": "251700"
  },
  {
    "text": "more better so we can see if we looked",
    "start": "251700",
    "end": "254549"
  },
  {
    "text": "at the formatted script it starts with a",
    "start": "254549",
    "end": "256590"
  },
  {
    "text": "variety of imports some subroutines and",
    "start": "256590",
    "end": "259350"
  },
  {
    "text": "then is followed by the main logic so",
    "start": "259350",
    "end": "262770"
  },
  {
    "start": "261000",
    "end": "322000"
  },
  {
    "text": "briefly let's look at these subroutines",
    "start": "262770",
    "end": "264900"
  },
  {
    "text": "on the slide created",
    "start": "264900",
    "end": "266290"
  },
  {
    "text": "table describing all the subroutines and",
    "start": "266290",
    "end": "268780"
  },
  {
    "text": "their rather meaningless names now these",
    "start": "268780",
    "end": "271390"
  },
  {
    "text": "subroutines are not the core logic of",
    "start": "271390",
    "end": "273460"
  },
  {
    "text": "the Malheur but their helper functions",
    "start": "273460",
    "end": "275950"
  },
  {
    "text": "that can provide a lot of insight into",
    "start": "275950",
    "end": "277960"
  },
  {
    "text": "the protocol of the matter so for",
    "start": "277960",
    "end": "280480"
  },
  {
    "text": "example we have subroutine G G is used",
    "start": "280480",
    "end": "283480"
  },
  {
    "text": "to send data to the command and control",
    "start": "283480",
    "end": "284950"
  },
  {
    "text": "server so for example if we see a",
    "start": "284950",
    "end": "287470"
  },
  {
    "text": "command invoking the subroutine G it'll",
    "start": "287470",
    "end": "290650"
  },
  {
    "text": "probably show us at least how many bytes",
    "start": "290650",
    "end": "292180"
  },
  {
    "text": "it's gonna send back to our command and",
    "start": "292180",
    "end": "293590"
  },
  {
    "text": "control server and then we can extend",
    "start": "293590",
    "end": "296140"
  },
  {
    "text": "our command control server to handle",
    "start": "296140",
    "end": "297820"
  },
  {
    "text": "that command response somewhere",
    "start": "297820",
    "end": "299830"
  },
  {
    "text": "similarly the subroutine J receives some",
    "start": "299830",
    "end": "303280"
  },
  {
    "text": "number of bytes from the command control",
    "start": "303280",
    "end": "304900"
  },
  {
    "text": "server so again if a command invokes say",
    "start": "304900",
    "end": "307480"
  },
  {
    "text": "j9 we know that it expects nine",
    "start": "307480",
    "end": "310570"
  },
  {
    "text": "additional bytes for that command so",
    "start": "310570",
    "end": "312970"
  },
  {
    "text": "again we can then customize our command",
    "start": "312970",
    "end": "315250"
  },
  {
    "text": "control server to make sure for that",
    "start": "315250",
    "end": "316780"
  },
  {
    "text": "command we pass nine additional bytes",
    "start": "316780",
    "end": "319000"
  },
  {
    "text": "even if originally we don't know what",
    "start": "319000",
    "end": "320680"
  },
  {
    "text": "those nine bytes should be so after the",
    "start": "320680",
    "end": "324040"
  },
  {
    "start": "322000",
    "end": "369000"
  },
  {
    "text": "subroutines the malware decodes and",
    "start": "324040",
    "end": "326290"
  },
  {
    "text": "strings which turn out to be the",
    "start": "326290",
    "end": "328330"
  },
  {
    "text": "addresses of the backup and primary",
    "start": "328330",
    "end": "330610"
  },
  {
    "text": "command and control servers one way to",
    "start": "330610",
    "end": "333130"
  },
  {
    "text": "debug these or rather decode these is",
    "start": "333130",
    "end": "335140"
  },
  {
    "text": "just to debug and step over the",
    "start": "335140",
    "end": "337240"
  },
  {
    "text": "subroutine that performs the string",
    "start": "337240",
    "end": "338910"
  },
  {
    "text": "decoding so we can do that by executing",
    "start": "338910",
    "end": "341680"
  },
  {
    "text": "Perl - D this will run the malware in a",
    "start": "341680",
    "end": "344860"
  },
  {
    "text": "Perl debugging session and we're not",
    "start": "344860",
    "end": "346780"
  },
  {
    "text": "gonna do bug the entire malware because",
    "start": "346780",
    "end": "349180"
  },
  {
    "text": "that would take away too long but we can",
    "start": "349180",
    "end": "350710"
  },
  {
    "text": "simply step over this routine and then",
    "start": "350710",
    "end": "353470"
  },
  {
    "text": "print out the values and very easily we",
    "start": "353470",
    "end": "355750"
  },
  {
    "text": "can see that there the IP addresses and",
    "start": "355750",
    "end": "357580"
  },
  {
    "text": "URLs of the primary command control",
    "start": "357580",
    "end": "359800"
  },
  {
    "text": "servers albeit reversed not on slide",
    "start": "359800",
    "end": "362260"
  },
  {
    "text": "there's some code that we can see uses",
    "start": "362260",
    "end": "364750"
  },
  {
    "text": "these addresses to connect to the",
    "start": "364750",
    "end": "366490"
  },
  {
    "text": "attackers command control server now",
    "start": "366490",
    "end": "369730"
  },
  {
    "text": "after decoding the addresses of the",
    "start": "369730",
    "end": "371560"
  },
  {
    "text": "primary and backup command control",
    "start": "371560",
    "end": "373330"
  },
  {
    "text": "servers the malware processes some",
    "start": "373330",
    "end": "376030"
  },
  {
    "text": "command line arguments hides its process",
    "start": "376030",
    "end": "379000"
  },
  {
    "text": "and then unpacked some binary data so if",
    "start": "379000",
    "end": "382600"
  },
  {
    "text": "we look at the code that processes the",
    "start": "382600",
    "end": "384760"
  },
  {
    "text": "command line arguments we can see it",
    "start": "384760",
    "end": "386860"
  },
  {
    "text": "looks for a port or an address colon",
    "start": "386860",
    "end": "389500"
  },
  {
    "text": "port of a custom or command and control",
    "start": "389500",
    "end": "391630"
  },
  {
    "text": "server this is awesome because this",
    "start": "391630",
    "end": "394210"
  },
  {
    "text": "means we can now specify via the command",
    "start": "394210",
    "end": "396430"
  },
  {
    "text": "line the address of our own command and",
    "start": "396430",
    "end": "398200"
  },
  {
    "text": "control server for",
    "start": "398200",
    "end": "399600"
  },
  {
    "text": "skin analysis purposes it's definitely",
    "start": "399600",
    "end": "401240"
  },
  {
    "text": "facilitates analysis",
    "start": "401240",
    "end": "403110"
  },
  {
    "text": "terms of processing process hiding it",
    "start": "403110",
    "end": "405870"
  },
  {
    "text": "just sets our v-0 to Java this is really",
    "start": "405870",
    "end": "409020"
  },
  {
    "text": "not a sophisticated technique but we can",
    "start": "409020",
    "end": "411150"
  },
  {
    "text": "see that at least terminal and tools",
    "start": "411150",
    "end": "413100"
  },
  {
    "text": "such as PS are fooled so if you do a PS",
    "start": "413100",
    "end": "415590"
  },
  {
    "text": "list thing you'll actually see a process",
    "start": "415590",
    "end": "417510"
  },
  {
    "text": "named Java instead of the malicious Perl",
    "start": "417510",
    "end": "419910"
  },
  {
    "text": "script executing and what about that",
    "start": "419910",
    "end": "422070"
  },
  {
    "text": "encoded data that turns out to be an",
    "start": "422070",
    "end": "423840"
  },
  {
    "text": "embedded mock Oh binary that we will",
    "start": "423840",
    "end": "426030"
  },
  {
    "text": "talk about shortly finally we get to the",
    "start": "426030",
    "end": "429690"
  },
  {
    "start": "428000",
    "end": "460000"
  },
  {
    "text": "main processing loop which does two",
    "start": "429690",
    "end": "431700"
  },
  {
    "text": "things it checks in with a command",
    "start": "431700",
    "end": "433590"
  },
  {
    "text": "control server sending version of them",
    "start": "433590",
    "end": "435840"
  },
  {
    "text": "our host name and username and then it",
    "start": "435840",
    "end": "438450"
  },
  {
    "text": "votes invokes the J sub routine to",
    "start": "438450",
    "end": "441570"
  },
  {
    "text": "receive one additional byte which then",
    "start": "441570",
    "end": "443520"
  },
  {
    "text": "processes via a massive if else if loop",
    "start": "443520",
    "end": "447540"
  },
  {
    "text": "and what this is all doing is checking",
    "start": "447540",
    "end": "450090"
  },
  {
    "text": "in with the command control server and",
    "start": "450090",
    "end": "451650"
  },
  {
    "text": "then getting a numeric command to",
    "start": "451650",
    "end": "454020"
  },
  {
    "text": "execute and then once it executes that",
    "start": "454020",
    "end": "455820"
  },
  {
    "text": "command it sends the response back to",
    "start": "455820",
    "end": "457530"
  },
  {
    "text": "the server and just repeats forever okay",
    "start": "457530",
    "end": "461130"
  },
  {
    "start": "460000",
    "end": "490000"
  },
  {
    "text": "so know the address of the command",
    "start": "461130",
    "end": "463140"
  },
  {
    "text": "control servers more importantly we",
    "start": "463140",
    "end": "464730"
  },
  {
    "text": "actually know that via the command line",
    "start": "464730",
    "end": "466470"
  },
  {
    "text": "we can specify our own we also",
    "start": "466470",
    "end": "468840"
  },
  {
    "text": "understand the basic protocol now before",
    "start": "468840",
    "end": "471810"
  },
  {
    "text": "we start building the custom command and",
    "start": "471810",
    "end": "473430"
  },
  {
    "text": "control server let's talk about being",
    "start": "473430",
    "end": "475230"
  },
  {
    "text": "able to passively monitor the Malheur",
    "start": "475230",
    "end": "477000"
  },
  {
    "text": "this is very important because even if",
    "start": "477000",
    "end": "479460"
  },
  {
    "text": "we can't ask the malware if we have no",
    "start": "479460",
    "end": "481140"
  },
  {
    "text": "way to observe what it's doing and the",
    "start": "481140",
    "end": "483120"
  },
  {
    "text": "tasking is kind of pointless imagine",
    "start": "483120",
    "end": "484980"
  },
  {
    "text": "some command say six returns a zero one",
    "start": "484980",
    "end": "488310"
  },
  {
    "text": "like what does that even mean",
    "start": "488310",
    "end": "490700"
  },
  {
    "start": "490000",
    "end": "515000"
  },
  {
    "text": "so what do we want to monitor well",
    "start": "490700",
    "end": "492930"
  },
  {
    "text": "basically as much as possible because a",
    "start": "492930",
    "end": "495360"
  },
  {
    "text": "given command might create files write",
    "start": "495360",
    "end": "497700"
  },
  {
    "text": "files read from files might spawn",
    "start": "497700",
    "end": "499500"
  },
  {
    "text": "processes it might execute shell",
    "start": "499500",
    "end": "501390"
  },
  {
    "text": "commands it might interact with the",
    "start": "501390",
    "end": "503340"
  },
  {
    "text": "mouse the keyboard and even send back",
    "start": "503340",
    "end": "505290"
  },
  {
    "text": "some interesting data via the network so",
    "start": "505290",
    "end": "507750"
  },
  {
    "text": "we should monitor for all these events",
    "start": "507750",
    "end": "509580"
  },
  {
    "text": "so that we can again understand the",
    "start": "509580",
    "end": "511710"
  },
  {
    "text": "malware's capabilities just via tasking",
    "start": "511710",
    "end": "515210"
  },
  {
    "start": "515000",
    "end": "553000"
  },
  {
    "text": "so let's take a closer look at each of",
    "start": "515210",
    "end": "517770"
  },
  {
    "text": "these network monitoring pretty easy to",
    "start": "517770",
    "end": "520169"
  },
  {
    "text": "do because there's built-in tools and",
    "start": "520169",
    "end": "521729"
  },
  {
    "text": "capabilities already so top of the slide",
    "start": "521729",
    "end": "523890"
  },
  {
    "text": "you can see that when we run TCP dump we",
    "start": "523890",
    "end": "526140"
  },
  {
    "text": "can see the malware connecting out",
    "start": "526140",
    "end": "527700"
  },
  {
    "text": "trying to resolve its command control",
    "start": "527700",
    "end": "529380"
  },
  {
    "text": "server again this is another way what",
    "start": "529380",
    "end": "530970"
  },
  {
    "text": "you could deter",
    "start": "530970",
    "end": "531600"
  },
  {
    "text": "the address of the CNC server now we'll",
    "start": "531600",
    "end": "534149"
  },
  {
    "text": "talk about tasking more but on the",
    "start": "534149",
    "end": "536040"
  },
  {
    "text": "bottom of the slide we can see a network",
    "start": "536040",
    "end": "537990"
  },
  {
    "text": "capture from a Wireshark when the",
    "start": "537990",
    "end": "540569"
  },
  {
    "text": "malware is responding to command number",
    "start": "540569",
    "end": "542670"
  },
  {
    "text": "13 now originally we have no idea what",
    "start": "542670",
    "end": "544980"
  },
  {
    "text": "command number 13 does but if we look at",
    "start": "544980",
    "end": "546990"
  },
  {
    "text": "the network capture we can see this",
    "start": "546990",
    "end": "549180"
  },
  {
    "text": "command returns the location where the",
    "start": "549180",
    "end": "551220"
  },
  {
    "text": "malware is installed next up file",
    "start": "551220",
    "end": "554759"
  },
  {
    "start": "553000",
    "end": "585000"
  },
  {
    "text": "monitoring again pretty simple there's a",
    "start": "554759",
    "end": "556800"
  },
  {
    "text": "built-in utility FS usage on Mac OS you",
    "start": "556800",
    "end": "560399"
  },
  {
    "text": "can execute this as route and it will",
    "start": "560399",
    "end": "562050"
  },
  {
    "text": "monitor for file o events this is",
    "start": "562050",
    "end": "565319"
  },
  {
    "text": "important because a variety of commands",
    "start": "565319",
    "end": "567420"
  },
  {
    "text": "will cause the malware to drop its",
    "start": "567420",
    "end": "570120"
  },
  {
    "text": "embedded mock Oh binary and we can see",
    "start": "570120",
    "end": "573120"
  },
  {
    "text": "the the file monitor that this is saved",
    "start": "573120",
    "end": "575250"
  },
  {
    "text": "to slash temp slash client so then we",
    "start": "575250",
    "end": "577740"
  },
  {
    "text": "can grab that and analyze that we",
    "start": "577740",
    "end": "580410"
  },
  {
    "text": "actually don't have to do much analysis",
    "start": "580410",
    "end": "581819"
  },
  {
    "text": "because again we're just gonna task them",
    "start": "581819",
    "end": "583410"
  },
  {
    "text": "out and see what it does next is process",
    "start": "583410",
    "end": "587610"
  },
  {
    "start": "585000",
    "end": "628000"
  },
  {
    "text": "monitoring now unfortunately as far as I",
    "start": "587610",
    "end": "590069"
  },
  {
    "text": "know there was no open source free user",
    "start": "590069",
    "end": "592529"
  },
  {
    "text": "mode process monitoring utility for Mac",
    "start": "592529",
    "end": "595110"
  },
  {
    "text": "OS so I decided to write my own what it",
    "start": "595110",
    "end": "597720"
  },
  {
    "text": "does is it interfaces with the audit",
    "start": "597720",
    "end": "599519"
  },
  {
    "text": "subsystem it's really actually easy to",
    "start": "599519",
    "end": "602220"
  },
  {
    "text": "do once you link the library you can see",
    "start": "602220",
    "end": "604170"
  },
  {
    "text": "code on the slide it's about five or six",
    "start": "604170",
    "end": "606810"
  },
  {
    "text": "lines of code basically you link in the",
    "start": "606810",
    "end": "608939"
  },
  {
    "text": "library instantiate a process monitor",
    "start": "608939",
    "end": "611250"
  },
  {
    "text": "object and then pass it a block that",
    "start": "611250",
    "end": "613319"
  },
  {
    "text": "will be automatically executed by the",
    "start": "613319",
    "end": "615000"
  },
  {
    "text": "library every time a process starts so",
    "start": "615000",
    "end": "618089"
  },
  {
    "text": "for example via command number 11 we can",
    "start": "618089",
    "end": "620459"
  },
  {
    "text": "see that when the process monitor runs",
    "start": "620459",
    "end": "622230"
  },
  {
    "text": "it sees the malware executing the PWD",
    "start": "622230",
    "end": "625319"
  },
  {
    "text": "command to get the current working",
    "start": "625319",
    "end": "626399"
  },
  {
    "text": "directory I also wanted a mouse and",
    "start": "626399",
    "end": "629699"
  },
  {
    "start": "628000",
    "end": "649000"
  },
  {
    "text": "keyboard sniffer I found some old",
    "start": "629699",
    "end": "631230"
  },
  {
    "text": "proof-of-concept code that would",
    "start": "631230",
    "end": "632579"
  },
  {
    "text": "intercept and modify these events so I",
    "start": "632579",
    "end": "635040"
  },
  {
    "text": "updated that for Mac OS and turned it",
    "start": "635040",
    "end": "636810"
  },
  {
    "text": "into a pure sniffer",
    "start": "636810",
    "end": "638240"
  },
  {
    "text": "so it'll capture both mouse and keyboard",
    "start": "638240",
    "end": "640829"
  },
  {
    "text": "events so now you can see if we type or",
    "start": "640829",
    "end": "643079"
  },
  {
    "text": "move the mouse a sniffer will detect",
    "start": "643079",
    "end": "644880"
  },
  {
    "text": "these events which again will be very",
    "start": "644880",
    "end": "646380"
  },
  {
    "text": "useful via the tasking of our malware",
    "start": "646380",
    "end": "648589"
  },
  {
    "text": "all right on to building our custom",
    "start": "648589",
    "end": "651449"
  },
  {
    "start": "649000",
    "end": "681000"
  },
  {
    "text": "command control server recall we can",
    "start": "651449",
    "end": "654149"
  },
  {
    "text": "specify the address of the command",
    "start": "654149",
    "end": "656100"
  },
  {
    "text": "control server via the command line and",
    "start": "656100",
    "end": "657990"
  },
  {
    "text": "we also understand the basic protocol",
    "start": "657990",
    "end": "659699"
  },
  {
    "text": "malware checks in send some client",
    "start": "659699",
    "end": "661649"
  },
  {
    "text": "information and then expects a single",
    "start": "661649",
    "end": "663449"
  },
  {
    "text": "command single byte command X",
    "start": "663449",
    "end": "665160"
  },
  {
    "text": "so we can start by just writing some",
    "start": "665160",
    "end": "667680"
  },
  {
    "text": "Python code that accepts a connection if",
    "start": "667680",
    "end": "669960"
  },
  {
    "text": "we do this run this the top you can see",
    "start": "669960",
    "end": "672180"
  },
  {
    "text": "we execute the malware the command line",
    "start": "672180",
    "end": "674040"
  },
  {
    "text": "we provide it the address of our command",
    "start": "674040",
    "end": "675690"
  },
  {
    "text": "control server and the malware connects",
    "start": "675690",
    "end": "677550"
  },
  {
    "text": "okay not that exciting but baby steps so",
    "start": "677550",
    "end": "682650"
  },
  {
    "start": "681000",
    "end": "714000"
  },
  {
    "text": "what does the malware do when it",
    "start": "682650",
    "end": "684210"
  },
  {
    "text": "originally connects what does it check",
    "start": "684210",
    "end": "686160"
  },
  {
    "text": "in so as we mentioned it sends some data",
    "start": "686160",
    "end": "688530"
  },
  {
    "text": "but what is the format of this so we can",
    "start": "688530",
    "end": "691140"
  },
  {
    "text": "briefly look at the malicious Perl",
    "start": "691140",
    "end": "693060"
  },
  {
    "text": "script and we can see it packing and",
    "start": "693060",
    "end": "694680"
  },
  {
    "text": "then sending back some strings via the G",
    "start": "694680",
    "end": "696960"
  },
  {
    "text": "subroutine and it said ins things like",
    "start": "696960",
    "end": "699300"
  },
  {
    "text": "the version name host name and user name",
    "start": "699300",
    "end": "702060"
  },
  {
    "text": "so what we can do is we can then extend",
    "start": "702060",
    "end": "704280"
  },
  {
    "text": "our custom command and control server to",
    "start": "704280",
    "end": "706530"
  },
  {
    "text": "process and parse this data so that",
    "start": "706530",
    "end": "708600"
  },
  {
    "text": "whenever a piece of malware connects we",
    "start": "708600",
    "end": "711030"
  },
  {
    "text": "can dump this to standard out or save",
    "start": "711030",
    "end": "713280"
  },
  {
    "text": "this to a file now the meat of the",
    "start": "713280",
    "end": "716340"
  },
  {
    "start": "714000",
    "end": "775000"
  },
  {
    "text": "custom command control server is",
    "start": "716340",
    "end": "717720"
  },
  {
    "text": "obviously tasking and handling command",
    "start": "717720",
    "end": "720000"
  },
  {
    "text": "responses turns out there's about 25 or",
    "start": "720000",
    "end": "722460"
  },
  {
    "text": "so commands some of these have sub",
    "start": "722460",
    "end": "724560"
  },
  {
    "text": "commands bringing the total to about 50",
    "start": "724560",
    "end": "726750"
  },
  {
    "text": "so what I did was I built the custom",
    "start": "726750",
    "end": "728880"
  },
  {
    "text": "command and control server to support",
    "start": "728880",
    "end": "730830"
  },
  {
    "text": "all of these now I originally didn't",
    "start": "730830",
    "end": "733320"
  },
  {
    "text": "know what all these commands would",
    "start": "733320",
    "end": "734610"
  },
  {
    "text": "actually do so what I did for each",
    "start": "734610",
    "end": "736470"
  },
  {
    "text": "command is I would triage the command to",
    "start": "736470",
    "end": "738960"
  },
  {
    "text": "look for any command specific protocol",
    "start": "738960",
    "end": "741150"
  },
  {
    "text": "for example does that command expect",
    "start": "741150",
    "end": "743430"
  },
  {
    "text": "additional bytes and also what is the",
    "start": "743430",
    "end": "745800"
  },
  {
    "text": "format of the response then I still",
    "start": "745800",
    "end": "748110"
  },
  {
    "text": "wouldn't know what the the command",
    "start": "748110",
    "end": "749910"
  },
  {
    "text": "actually did but I would task and",
    "start": "749910",
    "end": "752010"
  },
  {
    "text": "observe the response so here's a very",
    "start": "752010",
    "end": "754230"
  },
  {
    "text": "simple example command number 11 we can",
    "start": "754230",
    "end": "757020"
  },
  {
    "text": "see that it expects no additional data",
    "start": "757020",
    "end": "759290"
  },
  {
    "text": "but then responds via the G subroutine",
    "start": "759290",
    "end": "762360"
  },
  {
    "text": "sending back a single byte and then a",
    "start": "762360",
    "end": "764310"
  },
  {
    "text": "variable length of the string so what we",
    "start": "764310",
    "end": "766470"
  },
  {
    "text": "can do is we can extend their custom",
    "start": "766470",
    "end": "768210"
  },
  {
    "text": "command and control server and then we",
    "start": "768210",
    "end": "769980"
  },
  {
    "text": "can see when we support this command",
    "start": "769980",
    "end": "772260"
  },
  {
    "text": "that it's the malware returning its",
    "start": "772260",
    "end": "773760"
  },
  {
    "text": "current working directory okay so now we",
    "start": "773760",
    "end": "777390"
  },
  {
    "text": "task again we've got our monitoring",
    "start": "777390",
    "end": "780150"
  },
  {
    "text": "capabilities we're monitoring file",
    "start": "780150",
    "end": "781590"
  },
  {
    "text": "system network traffic mouse keyboard",
    "start": "781590",
    "end": "783990"
  },
  {
    "text": "processes and also our custom command",
    "start": "783990",
    "end": "786570"
  },
  {
    "text": "and control server now unfortunately we",
    "start": "786570",
    "end": "788580"
  },
  {
    "text": "don't have time to go through all the",
    "start": "788580",
    "end": "790170"
  },
  {
    "text": "commands but let's look at how we can",
    "start": "790170",
    "end": "792150"
  },
  {
    "text": "expose some of the more interesting ones",
    "start": "792150",
    "end": "793680"
  },
  {
    "text": "just via tasking and again when I",
    "start": "793680",
    "end": "795840"
  },
  {
    "text": "started this tasking I had no idea what",
    "start": "795840",
    "end": "797640"
  },
  {
    "text": "these commands",
    "start": "797640",
    "end": "799680"
  },
  {
    "start": "799000",
    "end": "842000"
  },
  {
    "text": "so let's start with command number two",
    "start": "799680",
    "end": "802120"
  },
  {
    "text": "if we look at the Perl script to briefly",
    "start": "802120",
    "end": "805180"
  },
  {
    "text": "triage this command we can see it",
    "start": "805180",
    "end": "807249"
  },
  {
    "text": "invokes J to read an additional byte",
    "start": "807249",
    "end": "809529"
  },
  {
    "text": "from the command control server invokes",
    "start": "809529",
    "end": "811480"
  },
  {
    "text": "the V subroutine which drops and",
    "start": "811480",
    "end": "813790"
  },
  {
    "text": "executes that embedded mock Oh binary",
    "start": "813790",
    "end": "816009"
  },
  {
    "text": "and then invokes the G subroutine to",
    "start": "816009",
    "end": "818379"
  },
  {
    "text": "send some response back to the server so",
    "start": "818379",
    "end": "820959"
  },
  {
    "text": "now we understand the format of the",
    "start": "820959",
    "end": "822699"
  },
  {
    "text": "protocol but again we have no idea what",
    "start": "822699",
    "end": "824649"
  },
  {
    "text": "this command actually does so if we send",
    "start": "824649",
    "end": "827259"
  },
  {
    "text": "them our command number two and for that",
    "start": "827259",
    "end": "829329"
  },
  {
    "text": "second byte just execute zero or or",
    "start": "829329",
    "end": "832180"
  },
  {
    "text": "rather pass zero we can see yes the file",
    "start": "832180",
    "end": "834699"
  },
  {
    "text": "monitor detects that the malware is",
    "start": "834699",
    "end": "836259"
  },
  {
    "text": "dropping this embedded maka binary and",
    "start": "836259",
    "end": "838540"
  },
  {
    "text": "then the process monitor shows that it",
    "start": "838540",
    "end": "840790"
  },
  {
    "text": "is then being executed then via the",
    "start": "840790",
    "end": "844149"
  },
  {
    "text": "network capture we can see it sends back",
    "start": "844149",
    "end": "845889"
  },
  {
    "text": "some large amount of data one Mag+",
    "start": "845889",
    "end": "848079"
  },
  {
    "text": "so what we can do is we can extend their",
    "start": "848079",
    "end": "850180"
  },
  {
    "text": "custom command server so that for",
    "start": "850180",
    "end": "852160"
  },
  {
    "text": "command number two we know it's gonna",
    "start": "852160",
    "end": "853540"
  },
  {
    "text": "send us back a large chunk of data and",
    "start": "853540",
    "end": "855309"
  },
  {
    "text": "write that out to the filesystem we can",
    "start": "855309",
    "end": "857860"
  },
  {
    "text": "then dump that file in a hex editor or",
    "start": "857860",
    "end": "860319"
  },
  {
    "text": "run the file command and we can see it's",
    "start": "860319",
    "end": "861850"
  },
  {
    "text": "actually a PNG image and then once we",
    "start": "861850",
    "end": "864459"
  },
  {
    "text": "open that image we can see that it's a",
    "start": "864459",
    "end": "866199"
  },
  {
    "text": "screen capture so now we know command",
    "start": "866199",
    "end": "868029"
  },
  {
    "text": "number two is the screen capture command",
    "start": "868029",
    "end": "870519"
  },
  {
    "text": "again we just figured this out via",
    "start": "870519",
    "end": "872860"
  },
  {
    "text": "tasking now remember this command though",
    "start": "872860",
    "end": "875980"
  },
  {
    "text": "takes a second additional light again I",
    "start": "875980",
    "end": "878829"
  },
  {
    "text": "had no idea what this was I passed it at",
    "start": "878829",
    "end": "880660"
  },
  {
    "text": "0 and it returned the screenshot but we",
    "start": "880660",
    "end": "882999"
  },
  {
    "text": "have the ability to task the malware so",
    "start": "882999",
    "end": "885249"
  },
  {
    "text": "we can just send various values for this",
    "start": "885249",
    "end": "887620"
  },
  {
    "text": "second byte and see what the malware",
    "start": "887620",
    "end": "889569"
  },
  {
    "text": "does how it responds this is really the",
    "start": "889569",
    "end": "891519"
  },
  {
    "text": "power of the custom command control",
    "start": "891519",
    "end": "893769"
  },
  {
    "text": "server and task we don't have to do any",
    "start": "893769",
    "end": "895089"
  },
  {
    "text": "additional reverse engineer so we can",
    "start": "895089",
    "end": "897339"
  },
  {
    "text": "see on the slide a table of contents",
    "start": "897339",
    "end": "898839"
  },
  {
    "text": "basically the results and we can see",
    "start": "898839",
    "end": "900759"
  },
  {
    "text": "that the second byte influences both the",
    "start": "900759",
    "end": "903100"
  },
  {
    "text": "type and quality of the screen capture",
    "start": "903100",
    "end": "905499"
  },
  {
    "text": "for example you pass at a1 it sends back",
    "start": "905499",
    "end": "907929"
  },
  {
    "text": "a low resolution black and white PNG",
    "start": "907929",
    "end": "910240"
  },
  {
    "text": "while a10 will send back a low res jpg",
    "start": "910240",
    "end": "912699"
  },
  {
    "text": "image all right on to command number 8",
    "start": "912699",
    "end": "916480"
  },
  {
    "text": "again we briefly first triage this",
    "start": "916480",
    "end": "919120"
  },
  {
    "text": "command we see it expects additional 9",
    "start": "919120",
    "end": "921490"
  },
  {
    "text": "bytes again it then drops and execs that",
    "start": "921490",
    "end": "924160"
  },
  {
    "text": "embedded binary passing in those 9 bytes",
    "start": "924160",
    "end": "926410"
  },
  {
    "text": "and for its response it only sends back",
    "start": "926410",
    "end": "929019"
  },
  {
    "text": "one byte which is either 0",
    "start": "929019",
    "end": "931340"
  },
  {
    "text": "or one so unlike the screen capture",
    "start": "931340",
    "end": "933320"
  },
  {
    "text": "command looking at the response we have",
    "start": "933320",
    "end": "935120"
  },
  {
    "text": "no idea what this command does like what",
    "start": "935120",
    "end": "936980"
  },
  {
    "text": "does this year I mean what is the one",
    "start": "936980",
    "end": "938270"
  },
  {
    "text": "what did the malware I even do vocal",
    "start": "938270",
    "end": "940610"
  },
  {
    "text": "only tasks passed me in zero one two",
    "start": "940610",
    "end": "942500"
  },
  {
    "text": "three four five six for those additional",
    "start": "942500",
    "end": "944000"
  },
  {
    "text": "nine bytes we see the mouth sniffer",
    "start": "944000",
    "end": "946520"
  },
  {
    "text": "registers and event no move to the XY",
    "start": "946520",
    "end": "949279"
  },
  {
    "text": "coordinates we specified so if you watch",
    "start": "949279",
    "end": "951350"
  },
  {
    "text": "very closely on the screen you're gonna",
    "start": "951350",
    "end": "954080"
  },
  {
    "text": "see me tasking the malware and move the",
    "start": "954080",
    "end": "956930"
  },
  {
    "text": "mouse moved amazing right okay so what",
    "start": "956930",
    "end": "961100"
  },
  {
    "text": "about that second byte again we know the",
    "start": "961100",
    "end": "963650"
  },
  {
    "text": "last eight bytes are the XY coordinates",
    "start": "963650",
    "end": "966470"
  },
  {
    "text": "but we don't know what that initial bite",
    "start": "966470",
    "end": "969200"
  },
  {
    "text": "is again we can just task and see what",
    "start": "969200",
    "end": "971810"
  },
  {
    "text": "happens and via the mouse sniffer we can",
    "start": "971810",
    "end": "974000"
  },
  {
    "text": "then enumerate exactly what this second",
    "start": "974000",
    "end": "976430"
  },
  {
    "text": "flight does so we can see on the slide",
    "start": "976430",
    "end": "978320"
  },
  {
    "text": "this is essentially a sub command for",
    "start": "978320",
    "end": "980060"
  },
  {
    "text": "the Mouse command and it will do things",
    "start": "980060",
    "end": "982339"
  },
  {
    "text": "like tell the mouse to either left click",
    "start": "982339",
    "end": "983779"
  },
  {
    "text": "double click right click click and drag",
    "start": "983779",
    "end": "986300"
  },
  {
    "text": "again this is rather neat capability for",
    "start": "986300",
    "end": "988460"
  },
  {
    "text": "a piece of malware to have because it",
    "start": "988460",
    "end": "990440"
  },
  {
    "text": "allows a remote adversary to actually",
    "start": "990440",
    "end": "992390"
  },
  {
    "text": "interact with UI elements on an infected",
    "start": "992390",
    "end": "994370"
  },
  {
    "text": "host so again watch closely",
    "start": "994370",
    "end": "996770"
  },
  {
    "text": "what we're gonna do is we're going to",
    "start": "996770",
    "end": "997760"
  },
  {
    "text": "task the malware to tell the security",
    "start": "997760",
    "end": "1001000"
  },
  {
    "text": "prompt to go away ok that's a little",
    "start": "1001000",
    "end": "1004120"
  },
  {
    "text": "more exciting all right so the final",
    "start": "1004120",
    "end": "1006940"
  },
  {
    "text": "command I'm going to talk about is",
    "start": "1006940",
    "end": "1008080"
  },
  {
    "text": "command number 16 and 17 again triage",
    "start": "1008080",
    "end": "1010720"
  },
  {
    "text": "depan to understand the protocol we see",
    "start": "1010720",
    "end": "1012760"
  },
  {
    "text": "it invokes j with a 1 meaning it wants",
    "start": "1012760",
    "end": "1015550"
  },
  {
    "text": "our command and control server to send",
    "start": "1015550",
    "end": "1016810"
  },
  {
    "text": "one additional byte and then invoked V",
    "start": "1016810",
    "end": "1019510"
  },
  {
    "text": "which again we know drops and executes",
    "start": "1019510",
    "end": "1021250"
  },
  {
    "text": "that embedded Mokpo binary and the",
    "start": "1021250",
    "end": "1023830"
  },
  {
    "text": "process monitor and file monitor shows",
    "start": "1023830",
    "end": "1025928"
  },
  {
    "text": "that happening most interestingly though",
    "start": "1025929",
    "end": "1028150"
  },
  {
    "text": "the keyboard sniffer lights up for",
    "start": "1028150",
    "end": "1030970"
  },
  {
    "text": "example if we send command number 16 and",
    "start": "1030970",
    "end": "1033250"
  },
  {
    "text": "a value of 65 for the second byte we can",
    "start": "1033250",
    "end": "1036520"
  },
  {
    "text": "see that the keyboard sniffer shows a",
    "start": "1036520",
    "end": "1038678"
  },
  {
    "text": "key down event for the letter A and then",
    "start": "1038679",
    "end": "1042188"
  },
  {
    "text": "if we send the command number 17 it",
    "start": "1042189",
    "end": "1044678"
  },
  {
    "text": "generates a key up value for that same",
    "start": "1044679",
    "end": "1046870"
  },
  {
    "text": "letter so now we have the ability to",
    "start": "1046870",
    "end": "1048730"
  },
  {
    "text": "remotely interact with keyboard or type",
    "start": "1048730",
    "end": "1050980"
  },
  {
    "text": "on an infected host so again watch",
    "start": "1050980",
    "end": "1052960"
  },
  {
    "text": "closely we can now attack the malware",
    "start": "1052960",
    "end": "1054730"
  },
  {
    "text": "and write things on the screen so for",
    "start": "1054730",
    "end": "1057070"
  },
  {
    "text": "example we can say hi",
    "start": "1057070",
    "end": "1060590"
  },
  {
    "start": "1060000",
    "end": "1124000"
  },
  {
    "text": "so I repeated this process for all",
    "start": "1060590",
    "end": "1063139"
  },
  {
    "text": "commands and what this allowed me to do",
    "start": "1063139",
    "end": "1065210"
  },
  {
    "text": "is understand comprehensively the",
    "start": "1065210",
    "end": "1067460"
  },
  {
    "text": "capabilities of them our just yet asking",
    "start": "1067460",
    "end": "1070070"
  },
  {
    "text": "you know people always say communication",
    "start": "1070070",
    "end": "1072230"
  },
  {
    "text": "is key this obviously applies to human",
    "start": "1072230",
    "end": "1074299"
  },
  {
    "text": "beings so I've been told but here it",
    "start": "1074299",
    "end": "1076249"
  },
  {
    "text": "also applies to malware as well so we",
    "start": "1076249",
    "end": "1079279"
  },
  {
    "text": "talked about some of the most",
    "start": "1079279",
    "end": "1080179"
  },
  {
    "text": "interesting commands but a few others of",
    "start": "1080179",
    "end": "1082399"
  },
  {
    "text": "note the malware supports the ability to",
    "start": "1082399",
    "end": "1084289"
  },
  {
    "text": "execute system commands shell commands",
    "start": "1084289",
    "end": "1087080"
  },
  {
    "text": "list processes upload files execute",
    "start": "1087080",
    "end": "1090049"
  },
  {
    "text": "files and one of the one that's",
    "start": "1090049",
    "end": "1091669"
  },
  {
    "text": "incredibly interesting at least to me is",
    "start": "1091669",
    "end": "1093769"
  },
  {
    "text": "that you can set an alert that the",
    "start": "1093769",
    "end": "1096889"
  },
  {
    "text": "malware will tell the attacker when the",
    "start": "1096889",
    "end": "1099049"
  },
  {
    "text": "user is interactive or actually using",
    "start": "1099049",
    "end": "1101570"
  },
  {
    "text": "the computer obviously this malware is",
    "start": "1101570",
    "end": "1103730"
  },
  {
    "text": "designed for interactive operations and",
    "start": "1103730",
    "end": "1106850"
  },
  {
    "text": "if you're doing inter-app interactive",
    "start": "1106850",
    "end": "1108860"
  },
  {
    "text": "operations on an infected host moving",
    "start": "1108860",
    "end": "1110720"
  },
  {
    "text": "the mouse perhaps turning on the webcam",
    "start": "1110720",
    "end": "1112279"
  },
  {
    "text": "you don't want to be doing that stuff",
    "start": "1112279",
    "end": "1113690"
  },
  {
    "text": "when the user is there because those",
    "start": "1113690",
    "end": "1115220"
  },
  {
    "text": "things have very clear visual indicators",
    "start": "1115220",
    "end": "1117470"
  },
  {
    "text": "which would obviously give away the fact",
    "start": "1117470",
    "end": "1119779"
  },
  {
    "text": "that the malware was on the system now",
    "start": "1119779",
    "end": "1122840"
  },
  {
    "text": "be really bad all-sec all right so now",
    "start": "1122840",
    "end": "1125570"
  },
  {
    "start": "1124000",
    "end": "1131000"
  },
  {
    "text": "we have a fully compatible custom",
    "start": "1125570",
    "end": "1127759"
  },
  {
    "text": "command and control server so let's go",
    "start": "1127759",
    "end": "1129350"
  },
  {
    "text": "hunt some flies now if you ping the",
    "start": "1129350",
    "end": "1133669"
  },
  {
    "start": "1131000",
    "end": "1148000"
  },
  {
    "text": "primary command control servers they're",
    "start": "1133669",
    "end": "1135619"
  },
  {
    "text": "all offline they've resolved to 127 dot",
    "start": "1135619",
    "end": "1137990"
  },
  {
    "text": "0 dot 0 dot 1 but if you recall we",
    "start": "1137990",
    "end": "1141110"
  },
  {
    "text": "decrypted some backup command and",
    "start": "1141110",
    "end": "1143210"
  },
  {
    "text": "control servers and guess what",
    "start": "1143210",
    "end": "1144889"
  },
  {
    "text": "they were available for registration I",
    "start": "1144889",
    "end": "1147080"
  },
  {
    "text": "was stoked so what I did was I",
    "start": "1147080",
    "end": "1150499"
  },
  {
    "start": "1148000",
    "end": "1257000"
  },
  {
    "text": "registered the URLs and configured the",
    "start": "1150499",
    "end": "1152809"
  },
  {
    "text": "DNS to point to my custom command and",
    "start": "1152809",
    "end": "1155210"
  },
  {
    "text": "control server and immediately a ton of",
    "start": "1155210",
    "end": "1157850"
  },
  {
    "text": "infected fruit fly victims are hosts",
    "start": "1157850",
    "end": "1160399"
  },
  {
    "text": "connected to me and recall for each",
    "start": "1160399",
    "end": "1162740"
  },
  {
    "text": "connection we get a username a computer",
    "start": "1162740",
    "end": "1165169"
  },
  {
    "text": "name that coupled with the IP address",
    "start": "1165169",
    "end": "1167330"
  },
  {
    "text": "can provide us very very easy way to",
    "start": "1167330",
    "end": "1170240"
  },
  {
    "text": "identify the victims so for example if I",
    "start": "1170240",
    "end": "1172549"
  },
  {
    "text": "was infected you would see an IP address",
    "start": "1172549",
    "end": "1174710"
  },
  {
    "text": "in Hawaii you would see the username",
    "start": "1174710",
    "end": "1177409"
  },
  {
    "text": "being Patrick and the host name which on",
    "start": "1177409",
    "end": "1179749"
  },
  {
    "text": "Macs is usually a combination of your",
    "start": "1179749",
    "end": "1181220"
  },
  {
    "text": "first and last name being Patrick or",
    "start": "1181220",
    "end": "1182960"
  },
  {
    "text": "saying you can hop on LinkedIn or Google",
    "start": "1182960",
    "end": "1186139"
  },
  {
    "text": "Google Patrick world Hawaii and you",
    "start": "1186139",
    "end": "1187429"
  },
  {
    "text": "would very easily be able to identify me",
    "start": "1187429",
    "end": "1189500"
  },
  {
    "text": "as a victim of this malware now I'm",
    "start": "1189500",
    "end": "1192470"
  },
  {
    "text": "confident to say that this now where",
    "start": "1192470",
    "end": "1194330"
  },
  {
    "text": "is not designed by nation states or",
    "start": "1194330",
    "end": "1196909"
  },
  {
    "text": "state-sponsored hackers based on the",
    "start": "1196909",
    "end": "1199399"
  },
  {
    "text": "victims again I could see who the",
    "start": "1199399",
    "end": "1201260"
  },
  {
    "text": "victims were the majority turned out to",
    "start": "1201260",
    "end": "1203179"
  },
  {
    "text": "be in the United States 90% plus and",
    "start": "1203179",
    "end": "1205610"
  },
  {
    "text": "once I kind of look at the victims based",
    "start": "1205610",
    "end": "1207740"
  },
  {
    "text": "on their names and IP addresses they",
    "start": "1207740",
    "end": "1209299"
  },
  {
    "text": "appear to be normal everyday people",
    "start": "1209299",
    "end": "1211100"
  },
  {
    "text": "again these are not the type of people",
    "start": "1211100",
    "end": "1213049"
  },
  {
    "text": "that nation-state malware targets these",
    "start": "1213049",
    "end": "1216110"
  },
  {
    "text": "people are normally targeted by",
    "start": "1216110",
    "end": "1217399"
  },
  {
    "text": "financially motivated cybercrime malware",
    "start": "1217399",
    "end": "1219890"
  },
  {
    "text": "however such malware generally has",
    "start": "1219890",
    "end": "1221899"
  },
  {
    "text": "features to make money keylogger to",
    "start": "1221899",
    "end": "1224510"
  },
  {
    "text": "capture credit cards perhaps hijacking",
    "start": "1224510",
    "end": "1226730"
  },
  {
    "text": "their search page injecting ads or",
    "start": "1226730",
    "end": "1228710"
  },
  {
    "text": "answering files this malware had none of",
    "start": "1228710",
    "end": "1231139"
  },
  {
    "text": "that so unfortunately this leaves pretty",
    "start": "1231139",
    "end": "1233299"
  },
  {
    "text": "much a third option was that the smell",
    "start": "1233299",
    "end": "1235100"
  },
  {
    "text": "was designed by hacker single adversary",
    "start": "1235100",
    "end": "1238340"
  },
  {
    "text": "whose goal was to basically spy on",
    "start": "1238340",
    "end": "1240620"
  },
  {
    "text": "individual people or families so really",
    "start": "1240620",
    "end": "1244039"
  },
  {
    "text": "kind of creepy so I headed off the",
    "start": "1244039",
    "end": "1246940"
  },
  {
    "text": "addresses of the command control servers",
    "start": "1246940",
    "end": "1249019"
  },
  {
    "text": "to law enforcement as well as the",
    "start": "1249019",
    "end": "1251389"
  },
  {
    "text": "technical analysis of the malware and",
    "start": "1251389",
    "end": "1253850"
  },
  {
    "text": "victim lists good news is they are now",
    "start": "1253850",
    "end": "1256100"
  },
  {
    "text": "involved and that's about all I can say",
    "start": "1256100",
    "end": "1259250"
  },
  {
    "start": "1257000",
    "end": "1306000"
  },
  {
    "text": "about that so let's start wrapping up",
    "start": "1259250",
    "end": "1263019"
  },
  {
    "text": "today we illustrated how to fully",
    "start": "1263019",
    "end": "1266240"
  },
  {
    "text": "analyze a fairly complex piece of",
    "start": "1266240",
    "end": "1269210"
  },
  {
    "text": "malware just by asking the right",
    "start": "1269210",
    "end": "1270830"
  },
  {
    "text": "questions again in three steps we built",
    "start": "1270830",
    "end": "1273740"
  },
  {
    "text": "a custom command control server we task",
    "start": "1273740",
    "end": "1276200"
  },
  {
    "text": "the malware and then we observe the",
    "start": "1276200",
    "end": "1278389"
  },
  {
    "text": "mauers response to reveal its",
    "start": "1278389",
    "end": "1279980"
  },
  {
    "text": "capabilities along the way we had to",
    "start": "1279980",
    "end": "1282019"
  },
  {
    "text": "write some neat Mac OS monitoring tools",
    "start": "1282019",
    "end": "1284720"
  },
  {
    "text": "these will be made available online",
    "start": "1284720",
    "end": "1286700"
  },
  {
    "text": "fully open sourced and the end result",
    "start": "1286700",
    "end": "1288830"
  },
  {
    "text": "was a full analysis of Mac OS fruit fly",
    "start": "1288830",
    "end": "1291649"
  },
  {
    "text": "it variant B we are also able to uncover",
    "start": "1291649",
    "end": "1294169"
  },
  {
    "text": "a vast number of victims and collaborate",
    "start": "1294169",
    "end": "1297470"
  },
  {
    "text": "with law enforcement of course we could",
    "start": "1297470",
    "end": "1299149"
  },
  {
    "text": "have hijacked the victims as well",
    "start": "1299149",
    "end": "1300409"
  },
  {
    "text": "because we had capabilities to talk to",
    "start": "1300409",
    "end": "1302269"
  },
  {
    "text": "them now err but I probably won't be",
    "start": "1302269",
    "end": "1304940"
  },
  {
    "text": "here talking about it if I had done that",
    "start": "1304940",
    "end": "1306519"
  },
  {
    "start": "1306000",
    "end": "1420000"
  },
  {
    "text": "so people always ask me how can you",
    "start": "1306519",
    "end": "1308899"
  },
  {
    "text": "protect against these insidious threats",
    "start": "1308899",
    "end": "1310700"
  },
  {
    "text": "or Mac malware in general obviously it's",
    "start": "1310700",
    "end": "1312889"
  },
  {
    "text": "best to perform best security practices",
    "start": "1312889",
    "end": "1315350"
  },
  {
    "text": "run a patched fully updated operating",
    "start": "1315350",
    "end": "1317809"
  },
  {
    "text": "system but I also think it's important",
    "start": "1317809",
    "end": "1319760"
  },
  {
    "text": "to run third-party security tools so in",
    "start": "1319760",
    "end": "1321950"
  },
  {
    "text": "my free time I write free Mac security",
    "start": "1321950",
    "end": "1323659"
  },
  {
    "text": "tools first and foremost to protect my",
    "start": "1323659",
    "end": "1325700"
  },
  {
    "text": "own Mac",
    "start": "1325700",
    "end": "1326740"
  },
  {
    "text": "selfish but then also make them freely",
    "start": "1326740",
    "end": "1329110"
  },
  {
    "text": "available on line they run a small max",
    "start": "1329110",
    "end": "1331809"
  },
  {
    "text": "security website called Objective C comm",
    "start": "1331809",
    "end": "1334000"
  },
  {
    "text": "some of the tools that could have",
    "start": "1334000",
    "end": "1335500"
  },
  {
    "text": "thwarted this malware block block",
    "start": "1335500",
    "end": "1337360"
  },
  {
    "text": "monitors for persistence attempts so if",
    "start": "1337360",
    "end": "1339730"
  },
  {
    "text": "this malware used an installer to",
    "start": "1339730",
    "end": "1341260"
  },
  {
    "text": "persist would have detected it Lulu is",
    "start": "1341260",
    "end": "1343960"
  },
  {
    "text": "open source free Mac OS firewall and",
    "start": "1343960",
    "end": "1346150"
  },
  {
    "text": "demoing tomorrow at blackhat personal",
    "start": "1346150",
    "end": "1347679"
  },
  {
    "text": "and it could obviously detect when the",
    "start": "1347679",
    "end": "1349809"
  },
  {
    "text": "malware goes to begin out knock knock is",
    "start": "1349809",
    "end": "1352179"
  },
  {
    "text": "like auto runs for Mac it will show you",
    "start": "1352179",
    "end": "1354160"
  },
  {
    "text": "all persistently installed items on your",
    "start": "1354160",
    "end": "1357010"
  },
  {
    "text": "system and here you can see it's",
    "start": "1357010",
    "end": "1358630"
  },
  {
    "text": "flagging the malware because it's",
    "start": "1358630",
    "end": "1360790"
  },
  {
    "text": "unsigned and also virus total has some",
    "start": "1360790",
    "end": "1363190"
  },
  {
    "text": "signatures for it",
    "start": "1363190",
    "end": "1364030"
  },
  {
    "text": "and then over site is unique utility",
    "start": "1364030",
    "end": "1366010"
  },
  {
    "text": "that I wrote that monitors do webcam and",
    "start": "1366010",
    "end": "1368290"
  },
  {
    "text": "mic so even if an attacker has infected",
    "start": "1368290",
    "end": "1371050"
  },
  {
    "text": "your system and can turn on your webcam",
    "start": "1371050",
    "end": "1373000"
  },
  {
    "text": "when you're away from your computer for",
    "start": "1373000",
    "end": "1374800"
  },
  {
    "text": "example in your bedroom when walking",
    "start": "1374800",
    "end": "1376179"
  },
  {
    "text": "around in your underwear or laughs when",
    "start": "1376179",
    "end": "1378940"
  },
  {
    "text": "you come back to your computer there'll",
    "start": "1378940",
    "end": "1379990"
  },
  {
    "text": "be a big pop up saying you know process",
    "start": "1379990",
    "end": "1381700"
  },
  {
    "text": "X basically just turned on the webcam",
    "start": "1381700",
    "end": "1383590"
  },
  {
    "text": "it's a good way to uncover such",
    "start": "1383590",
    "end": "1385360"
  },
  {
    "text": "insidious malware",
    "start": "1385360",
    "end": "1387150"
  },
  {
    "text": "okay so that's a wrap again thank you",
    "start": "1387150",
    "end": "1390160"
  },
  {
    "text": "for attending my talk if you're a",
    "start": "1390160",
    "end": "1392590"
  },
  {
    "text": "freelance hacker researcher check out",
    "start": "1392590",
    "end": "1394420"
  },
  {
    "text": "Cenac comm we're also hiring so if this",
    "start": "1394420",
    "end": "1397210"
  },
  {
    "text": "kind of stuff is interesting and you",
    "start": "1397210",
    "end": "1398950"
  },
  {
    "text": "want to come work in Hawaii with me",
    "start": "1398950",
    "end": "1400570"
  },
  {
    "text": "hacking on this stuff shoot me my resume",
    "start": "1400570",
    "end": "1402520"
  },
  {
    "text": "or check out Cenac comm so I think we",
    "start": "1402520",
    "end": "1405070"
  },
  {
    "text": "have about a minute or two so if there's",
    "start": "1405070",
    "end": "1406960"
  },
  {
    "text": "any questions I'll take those now I'll",
    "start": "1406960",
    "end": "1408880"
  },
  {
    "text": "also be around after the talk if you",
    "start": "1408880",
    "end": "1410950"
  },
  {
    "text": "want to chat as well",
    "start": "1410950",
    "end": "1413880"
  },
  {
    "text": "[Applause]",
    "start": "1416970",
    "end": "1422499"
  }
]