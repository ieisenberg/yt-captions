[
  {
    "text": "exploits to exploit the Unicode problem on that web server and remember what I told you it's the they just tidied up",
    "start": "640",
    "end": "7160"
  },
  {
    "text": "versions of the Expo that he ran through the browser it's exactly the same thing did anybody have any difficulty with",
    "start": "7160",
    "end": "13040"
  },
  {
    "text": "them with unic scan or uni XE",
    "start": "13040",
    "end": "19000"
  },
  {
    "text": "did oh",
    "start": "22039",
    "end": "26039"
  },
  {
    "text": "um yeah uh you'll notice that when you run",
    "start": "34280",
    "end": "40480"
  },
  {
    "text": "the unic scan tools it Cycles through a number of different directories and a number of different variations of the",
    "start": "40480",
    "end": "47600"
  },
  {
    "text": "SQL encoding uh that's because we're search directory that's executable and",
    "start": "47600",
    "end": "52800"
  },
  {
    "text": "we're looking at different ways of encoding those um strings in in the hope",
    "start": "52800",
    "end": "59160"
  },
  {
    "text": "of finding a server that's vulnerable and with time we database of strings",
    "start": "59160",
    "end": "64239"
  },
  {
    "text": "that work in different configurations um and that's basically what it does so it's just sort of brute forcing through",
    "start": "64239",
    "end": "69759"
  },
  {
    "text": "different options um I don't know are there any questions on on that everyone have you able to",
    "start": "69759",
    "end": "77240"
  },
  {
    "text": "create a directory um now the directories that you've created I want to ask you as we move forward now we're going to be hacking into SQL into SQL",
    "start": "77240",
    "end": "84000"
  },
  {
    "text": "and into Microsoft servers a lot I'm going to ask you that when we do do that whenever you put files down anywhere",
    "start": "84000",
    "end": "90479"
  },
  {
    "text": "that you create a directory for yourself and use that directory I don't really care much where it is but um I would",
    "start": "90479",
    "end": "98320"
  },
  {
    "text": "like you to try and use that directory if you can it's just keeps keep keeps you out of each other's hair um then for",
    "start": "98320",
    "end": "106240"
  },
  {
    "text": "the next pra uh it's necessary that that user directory was created in um CET Pub",
    "start": "106240",
    "end": "113600"
  },
  {
    "text": "scripts so if you if you didn't manage to do that don't you just ask howon to give you a hand so that everyone does have a directory um because you're going",
    "start": "113600",
    "end": "120320"
  },
  {
    "text": "to be working from",
    "start": "120320",
    "end": "123039"
  },
  {
    "text": "it yeah so and and that your directory must be in your machine username because",
    "start": "127160",
    "end": "133120"
  },
  {
    "text": "what's going to happen is the all the class underscore scripts they read your name of your workstation and they kind",
    "start": "133120",
    "end": "139160"
  },
  {
    "text": "of force you to go to certain places um and and that's why the directory needs",
    "start": "139160",
    "end": "144720"
  },
  {
    "text": "to map like that okay so no problems with unic scan or uni XE okay the the exe is just a",
    "start": "144720",
    "end": "152000"
  },
  {
    "text": "pull to exe version of the written for Windows the results from the uni scanner",
    "start": "152000",
    "end": "159120"
  },
  {
    "text": "getting a directory listing in croot finding the file password.txt everyone get that no",
    "start": "159120",
    "end": "166720"
  },
  {
    "text": "difficulties um it was just it was just a there was a password oh no no we put the file there",
    "start": "166720",
    "end": "173480"
  },
  {
    "text": "as an example doesn't have any real meaning um I think the trickier stuff comes when we get to the MS Query 32",
    "start": "173480",
    "end": "179599"
  },
  {
    "text": "stuff did anybody get stuck there with firing up creating your DSN and firing",
    "start": "179599",
    "end": "185040"
  },
  {
    "text": "up MS Query 32 right nobody got stuck you understand the difference you the RO",
    "start": "185040",
    "end": "190519"
  },
  {
    "text": "of the DSM which defines the connection to the inves the correct",
    "start": "190519",
    "end": "196920"
  },
  {
    "text": "Drive um and then the query analyzer which uses the obbc connection to",
    "start": "197159",
    "end": "203720"
  },
  {
    "text": "connect the single analyzer to talk to various of databases and so T forms are",
    "start": "203959",
    "end": "210239"
  },
  {
    "text": "kind of a middle we layer between your analy so were we connecting had we been",
    "start": "210239",
    "end": "215280"
  },
  {
    "text": "connecting to a Oracle server or a sideb server eb2 or whatever the case may be we would just with a different kind of",
    "start": "215280",
    "end": "222879"
  },
  {
    "text": "dri and so we'd be able to talk to any of them in the same way um and SQL is fundamentally the same so your queries",
    "start": "222879",
    "end": "228959"
  },
  {
    "text": "would look the same way now um",
    "start": "228959",
    "end": "234280"
  },
  {
    "text": "equal ESS password is blank because uh tyon told us that in the previous",
    "start": "244360",
    "end": "251120"
  },
  {
    "text": "exercise and I then get confronted with",
    "start": "251120",
    "end": "255920"
  },
  {
    "text": "this complex looking",
    "start": "256199",
    "end": "259880"
  },
  {
    "text": "things I couldn't tell you exactly what all of them do and I don't think you really need to to know I I would",
    "start": "263040",
    "end": "269160"
  },
  {
    "text": "approach this by by looking through it for something that looks interesting and I would probably if this had been a real",
    "start": "269160",
    "end": "274520"
  },
  {
    "text": "life scenario explore every one of them and try to understand their nature and if I figure out what it was I might",
    "start": "274520",
    "end": "279560"
  },
  {
    "text": "Google for it but eventually you would figure that these are all pretty much system tables and as you go through this",
    "start": "279560",
    "end": "284639"
  },
  {
    "text": "and you look at all of them way down here eventually see this users table now this users table differs",
    "start": "284639",
    "end": "292400"
  },
  {
    "text": "from the rest it sort of stands out um and it differs from the rest because this is a user created table it's not a",
    "start": "292400",
    "end": "298800"
  },
  {
    "text": "SQL system table table it doesn't store SQL usernames and databases in this particular instance this table",
    "start": "298800",
    "end": "305280"
  },
  {
    "text": "Stores um usernames and passwords that are used by an application so there's",
    "start": "305280",
    "end": "311440"
  },
  {
    "text": "some from what you have you you don't know this giving you the background there's some application that is asking",
    "start": "311440",
    "end": "317199"
  },
  {
    "text": "users to log in and it's checking their username and password against the data stored in this table on the SQL",
    "start": "317199",
    "end": "323840"
  },
  {
    "text": "Server all right so when you log into that application which I'll show you in a little while two two two sets of",
    "start": "323840",
    "end": "329720"
  },
  {
    "text": "authentication are happening the application is logging into the SQL Server as essay or as something else and",
    "start": "329720",
    "end": "336520"
  },
  {
    "text": "running a query to pull your username and password from this table and then it's comparing the username and password",
    "start": "336520",
    "end": "342919"
  },
  {
    "text": "that you try to log in with against the username password that's stored here that's what this table is is being used",
    "start": "342919",
    "end": "349080"
  },
  {
    "text": "for and so now I've run a query against that database different kinds of exploits um",
    "start": "349080",
    "end": "355800"
  },
  {
    "text": "we said primary and secondary maybe that I've now found my primary information",
    "start": "355800",
    "end": "362039"
  },
  {
    "text": "may be that I find a credit cards table in here or or um whatever there's tons",
    "start": "362039",
    "end": "367599"
  },
  {
    "text": "and tons of things that get stored in these kinds of databases at the office in the men's room we allow the guys to",
    "start": "367599",
    "end": "373400"
  },
  {
    "text": "stick up screenshots from really nice hacks that they've pulled and most of the guys have got like a little war cry",
    "start": "373400",
    "end": "379280"
  },
  {
    "text": "like um Haruno says I'm Amazed by the Simplicity of it all and R for says",
    "start": "379280",
    "end": "384360"
  },
  {
    "text": "another day another hack and he's got things like and and they sort of put up screenshots that are really nice and one",
    "start": "384360",
    "end": "390000"
  },
  {
    "text": "we've got is of a database where they store the username the password and then the password prompt you know have you",
    "start": "390000",
    "end": "395800"
  },
  {
    "text": "forgotten your password and then you you put a question and an answer look at the questions and answers",
    "start": "395800",
    "end": "402160"
  },
  {
    "text": "that people give and that's just phally hilarious so I won't go into what they",
    "start": "402160",
    "end": "407680"
  },
  {
    "text": "are most of them are rude um so that may be the data that you want you know um",
    "start": "407680",
    "end": "413560"
  },
  {
    "text": "could be that's what you're looking for um smaller modern banking systems for example are often run of this kind of",
    "start": "413560",
    "end": "419759"
  },
  {
    "text": "database so uh small country you want to start a small Bank service maybe a few",
    "start": "419759",
    "end": "425800"
  },
  {
    "text": "hundred, customers and you want to do it all electronically you can now go to companies like Phoenix here in the",
    "start": "425800",
    "end": "431919"
  },
  {
    "text": "states and say I want to buy a bank and you buy the entire system and the bank is run on a database like this so you",
    "start": "431919",
    "end": "437560"
  },
  {
    "text": "get into the SQL database it's all there right all the transactions the transaction logs are",
    "start": "437560",
    "end": "443960"
  },
  {
    "text": "made but in this case we're looking for a bit we're looking for control over the server",
    "start": "443960",
    "end": "450080"
  },
  {
    "text": "now if we go and have a look over here what you're seeing there is the actual is the syntax of the actual SQL query",
    "start": "450080",
    "end": "457280"
  },
  {
    "text": "bio SQL analyzer to the SQL Server via obbc they're executing a select uh what",
    "start": "457280",
    "end": "463240"
  },
  {
    "text": "do we call it a select statement or select they're selecting uh two columns",
    "start": "463240",
    "end": "469840"
  },
  {
    "text": "from the table users which is located in the master",
    "start": "469840",
    "end": "475840"
  },
  {
    "text": "database I could rewrite that sort of in my pingon SQL I say um",
    "start": "475840",
    "end": "484800"
  },
  {
    "text": "select from",
    "start": "485080",
    "end": "488879"
  },
  {
    "text": "Mon and I get much the same thing I could take it a step further and",
    "start": "492280",
    "end": "498039"
  },
  {
    "text": "say",
    "start": "498039",
    "end": "501039"
  },
  {
    "text": "B",
    "start": "511599",
    "end": "514599"
  },
  {
    "text": "the simply didn't happen Happ",
    "start": "565360",
    "end": "570320"
  },
  {
    "text": "into Mar dot dot",
    "start": "582760",
    "end": "589360"
  },
  {
    "text": "users that",
    "start": "590720",
    "end": "594720"
  },
  {
    "text": "and if I go back and I start from",
    "start": "608360",
    "end": "612959"
  },
  {
    "text": "again yeah I've added a user yes I can do select from I can do insert I can do drop um I can do create tables I can do",
    "start": "620360",
    "end": "627519"
  },
  {
    "text": "a whole lot of data related things right um and because I'm SI I can",
    "start": "627519",
    "end": "634320"
  },
  {
    "text": "probably create new databases can probably do a degree of user Administration I can do a whole lot of stuff and one of the things that I can",
    "start": "634320",
    "end": "641360"
  },
  {
    "text": "do on Microsoft SQL and on the majority in one form or another on majority of",
    "start": "641360",
    "end": "647120"
  },
  {
    "text": "other um SQL Server database server applications is I can do something",
    "start": "647120",
    "end": "652639"
  },
  {
    "text": "called an exec what an exec is going to do is it's going to evoke what we call a stored procedure which is really",
    "start": "652639",
    "end": "659440"
  },
  {
    "text": "function stored somewhere in the database somewhere in one of the default databases which the SQL Server can",
    "start": "659440",
    "end": "666120"
  },
  {
    "text": "execute on my behalf right so now I'm moving beyond just running queries against the data itself I'm actually",
    "start": "666120",
    "end": "672360"
  },
  {
    "text": "asking the SQL Server to do something active and typically the sorts of things you do is create new users enumerate",
    "start": "672360",
    "end": "678519"
  },
  {
    "text": "users enumerate the databases and maybe establish a connection to another database but they take it further also",
    "start": "678519",
    "end": "684839"
  },
  {
    "text": "with SQL you can ask SQL to send emails or other forms of notification you can askl to map drives um and there's a list",
    "start": "684839",
    "end": "691279"
  },
  {
    "text": "of dozens and dozens of um of of stor procedures and what they call Extended stor procedures which which you can then",
    "start": "691279",
    "end": "698240"
  },
  {
    "text": "ask SQL to run using this exec command and a thanks and by far the most interesting",
    "start": "698240",
    "end": "704959"
  },
  {
    "text": "of them for and on SQL something called XP cmore CMD shell which is an extended",
    "start": "704959",
    "end": "711399"
  },
  {
    "text": "thought procedure which evokes a Windows command interpreter right and then you",
    "start": "711399",
    "end": "716760"
  },
  {
    "text": "can pass it you can pass that function as a parameter any dos command and it'll run it I",
    "start": "716760",
    "end": "724120"
  },
  {
    "text": "can sorry to give the location master and then in Brackets and in",
    "start": "725959",
    "end": "733199"
  },
  {
    "text": "quotes I'm going to say",
    "start": "733199",
    "end": "739160"
  },
  {
    "text": "C I don't know the brackets wrong I you don't need to back on your",
    "start": "746800",
    "end": "752519"
  },
  {
    "text": "side is executing a command and returning the output of the command to me as opposed to a quer against the",
    "start": "758880",
    "end": "766600"
  },
  {
    "text": "database and now I'm running with the privilege of the SQL service on this machine which by default is system as",
    "start": "766600",
    "end": "773320"
  },
  {
    "text": "opposed to with the uni code exploits where my privileges were those of I use a computer name okay and this is really",
    "start": "773320",
    "end": "781519"
  },
  {
    "text": "where um essay uh SQL access becomes dangerous now not all database",
    "start": "781519",
    "end": "786760"
  },
  {
    "text": "implementations will have XP command shell but most of them have something like that or or at least some forms of",
    "start": "786760",
    "end": "792760"
  },
  {
    "text": "uh stor procedures which allow me to do stuff that uh that's interesting so",
    "start": "792760",
    "end": "800240"
  },
  {
    "text": "um the advanc for this for this exercise",
    "start": "800240",
    "end": "807440"
  },
  {
    "text": "of a what can we call the DNS tunnel to list the files in a given directory now",
    "start": "807440",
    "end": "813000"
  },
  {
    "text": "the background to that is this what I've shown you here is how we can connect directly via TCP to the SQL Server log",
    "start": "813000",
    "end": "819920"
  },
  {
    "text": "in and run a command often I'm not able to log directly into",
    "start": "819920",
    "end": "827000"
  },
  {
    "text": "the server but I am able to ask it to run commands for me um an example of",
    "start": "827000",
    "end": "832040"
  },
  {
    "text": "that is where a web application connects via obbc to a SQL server and most of you",
    "start": "832040",
    "end": "838480"
  },
  {
    "text": "will be familiar with architecture you have a DMZ located somewhere in the DMZ is a web server which has some kind of",
    "start": "838480",
    "end": "844279"
  },
  {
    "text": "interactive application it allows you to log in or it allows you to run queries or it allows you to do interactive stuff",
    "start": "844279",
    "end": "850800"
  },
  {
    "text": "and it's getting that data from a server and typically or very often it gets it from something like this like a SQL",
    "start": "850800",
    "end": "856560"
  },
  {
    "text": "Server now that SQL Server could be located on the machine itself on the same server where the web server sits or",
    "start": "856560",
    "end": "863240"
  },
  {
    "text": "it could be located somewhere else either in the DMZ or an e-commerce Network or somewhere in the private",
    "start": "863240",
    "end": "868440"
  },
  {
    "text": "Network you could have a server running this data depending on the nature of I guess so now what's going to happen is",
    "start": "868440",
    "end": "874360"
  },
  {
    "text": "you send a query you log into the web server for example the web server using",
    "start": "874360",
    "end": "879959"
  },
  {
    "text": "or PHP or whatever the case may be builds a query and submits that query to the SQL Server right so you don't",
    "start": "879959",
    "end": "885920"
  },
  {
    "text": "connect to the SQL Server directly the web server connects and uh using various forms of attacks which we'll discuss in",
    "start": "885920",
    "end": "891680"
  },
  {
    "text": "a minute I may be able to inject query",
    "start": "891680",
    "end": "896759"
  },
  {
    "text": "into the query being sent from the web server to to the equl server they following me so what that means is it",
    "start": "896759",
    "end": "903079"
  },
  {
    "text": "may happen depending on thousand different factors it may happen that I can influence the query being sent by",
    "start": "903079",
    "end": "909000"
  },
  {
    "text": "the web server to the SQL server and get it to do something like this which is",
    "start": "909000",
    "end": "914120"
  },
  {
    "text": "great problem is I don't see this output I have no interactivity this is not even",
    "start": "914120",
    "end": "919399"
  },
  {
    "text": "not being executed on the web server it's being executed all the way back on the SQL the have seen whether that stuff",
    "start": "919399",
    "end": "927360"
  },
  {
    "text": "works or not so what I do is I try and prod the SQL Server into sending me some",
    "start": "927360",
    "end": "933440"
  },
  {
    "text": "indication that the command that I've injected um is actually working right",
    "start": "933440",
    "end": "938839"
  },
  {
    "text": "and I do that by doing an NS",
    "start": "938839",
    "end": "944199"
  },
  {
    "text": "lookup be recognize and I directed at a web server that I control uh",
    "start": "954279",
    "end": "960000"
  },
  {
    "text": "uni server control 1921 68 252 freaking",
    "start": "960000",
    "end": "967880"
  },
  {
    "text": "man I'm sorry see I thought there was a problem",
    "start": "967880",
    "end": "973600"
  },
  {
    "text": "with that thank you and then what I'm going to do is on",
    "start": "973600",
    "end": "979360"
  },
  {
    "text": "a unique server somewhere that I control I'm going to use TCP dump which is a simple packet",
    "start": "979360",
    "end": "986040"
  },
  {
    "text": "sniffer I'm going to say",
    "start": "986040",
    "end": "990519"
  },
  {
    "text": "okay so there's a little sniffer running there I'm going to execute the command and over here you see the query",
    "start": "1016440",
    "end": "1025600"
  },
  {
    "text": "through all right so what I've done is I've used SQL to force the the SQL Server to",
    "start": "1025600",
    "end": "1032918"
  },
  {
    "text": "execute a command I told the dud in his look up using my IP address as a server",
    "start": "1032919",
    "end": "1038640"
  },
  {
    "text": "and on my IP address I see that query coming in and so I know that my command",
    "start": "1038640",
    "end": "1043678"
  },
  {
    "text": "is executed now in this particular instance I know that anyway because I can see the output remember I'm I'm sort",
    "start": "1043679",
    "end": "1049200"
  },
  {
    "text": "of trying to prepare you scenario where perhaps you can get the server to run the command but not see the up directly",
    "start": "1049200",
    "end": "1057080"
  },
  {
    "text": "okay there's no guarantee that 53 will there's no guarantee that 53 is going to",
    "start": "1057080",
    "end": "1062320"
  },
  {
    "text": "come to me but I've got a fairly good chance that it will compared to all other network protocols it's probably my",
    "start": "1062320",
    "end": "1068039"
  },
  {
    "text": "best chance and I don't have to specify the IP address of the server where the lookup is to be done I could for",
    "start": "1068039",
    "end": "1074840"
  },
  {
    "text": "example change my query to read this",
    "start": "1074840",
    "end": "1080158"
  },
  {
    "text": "and because I manage the DNS server responsible for the sense post.net domain I can run my sniff on that server",
    "start": "1089840",
    "end": "1096440"
  },
  {
    "text": "and that DNS packet will then request packet will find its way to me is this making sense I'm seeing some blank",
    "start": "1096440",
    "end": "1104200"
  },
  {
    "text": "stairs can um if I can direct the output to a specific",
    "start": "1106760",
    "end": "1113159"
  },
  {
    "text": "server the way I did in the first example all right then I don't have to be running a DNS server at all the",
    "start": "1113159",
    "end": "1118320"
  },
  {
    "text": "disadvantage there is that I'm requesting the SQL Server to send a UDP packet straight out which the F may not",
    "start": "1118320",
    "end": "1123840"
  },
  {
    "text": "allow it to do using the second method right by tagging something to the end of",
    "start": "1123840",
    "end": "1129640"
  },
  {
    "text": "a domain that I control even if the SQL Server can't send packet straight up it's going to send the request to its",
    "start": "1129640",
    "end": "1135480"
  },
  {
    "text": "primary to its DNS resolver that's going to send it to its DNS resol that's going to send it eventually all the way to my",
    "start": "1135480",
    "end": "1142120"
  },
  {
    "text": "um to my name server that I control in that case I do have to have a registered name server guys still with me so so even if",
    "start": "1142120",
    "end": "1149440"
  },
  {
    "text": "the machine can't talk directly out eventually that UDP packet that dnf request is going to find its way and I see it coming through over here so I",
    "start": "1149440",
    "end": "1155360"
  },
  {
    "text": "know that the seqence executed the command and I can now extend",
    "start": "1155360",
    "end": "1160520"
  },
  {
    "text": "that Loop stuff that we played with yesterday so over here this is just for practice I can say",
    "start": "1160520",
    "end": "1166320"
  },
  {
    "text": "four percentage of don't have too much time in it um use",
    "start": "1166320",
    "end": "1174880"
  },
  {
    "text": "back in the SE",
    "start": "1186480",
    "end": "1193559"
  },
  {
    "text": "and this",
    "start": "1199919",
    "end": "1207000"
  },
  {
    "text": "do practice and there you",
    "start": "1210720",
    "end": "1214640"
  },
  {
    "text": "go that's not right",
    "start": "1215960",
    "end": "1220399"
  },
  {
    "text": "okay okay now you see that for every file in the C drive this is now my local",
    "start": "1254679",
    "end": "1261000"
  },
  {
    "text": "machine right I'm not hacking anything yet I'm just testing it for every file in the roots of the C drive my machine",
    "start": "1261000",
    "end": "1266559"
  },
  {
    "text": "is sending out two UDP packets requesting the DNS name associated with that",
    "start": "1266559",
    "end": "1272720"
  },
  {
    "text": "file okay particular it the command and for each line as it comes out my machine doing the lookup saying hey what what is",
    "start": "1272720",
    "end": "1278480"
  },
  {
    "text": "this associated with and it's doing it twice because um because it didn't work the first time so I don't need it to",
    "start": "1278480",
    "end": "1283960"
  },
  {
    "text": "resolve it's just sending the data out and so I'm using UDP packets to Tunnel the output of come on oh I'm GNA just",
    "start": "1283960",
    "end": "1291120"
  },
  {
    "text": "change",
    "start": "1291120",
    "end": "1294120"
  },
  {
    "text": "on this little piece of code which I just",
    "start": "1299000",
    "end": "1304000"
  },
  {
    "text": "pull a low",
    "start": "1311240",
    "end": "1315480"
  },
  {
    "text": "no no no sorry it's a nice idea but",
    "start": "1322640",
    "end": "1327840"
  },
  {
    "text": "no okay now what I'm going to do is I'm going to replace this whole command here",
    "start": "1327840",
    "end": "1333120"
  },
  {
    "text": "all the way up to there with that sense",
    "start": "1333120",
    "end": "1339919"
  },
  {
    "text": "post.net and with a little bit of luck voila",
    "start": "1340760",
    "end": "1348360"
  },
  {
    "text": "so you see the bit to the left of the dosens post.net is the other the F Maps",
    "start": "1350559",
    "end": "1357120"
  },
  {
    "text": "documents IET Pub Etc and with a little bit of hacking sorry because the first",
    "start": "1358080",
    "end": "1363760"
  },
  {
    "text": "request fails so send out a second request I could probably set it with an NS lookup flag I would even look um now",
    "start": "1363760",
    "end": "1369799"
  },
  {
    "text": "with a little bit of hacking with like or script hacking on this side I can pause the files out and with the an",
    "start": "1369799",
    "end": "1375799"
  },
  {
    "text": "amazing amount of for Loop and command line hacking you can get your commands",
    "start": "1375799",
    "end": "1381520"
  },
  {
    "text": "out to such a degree that you can have a fully interactive prompt we took control of a primary domain controller within a",
    "start": "1381520",
    "end": "1389480"
  },
  {
    "text": "bank from the internet once using this technique where we never saw the output of our Command ip config add user change",
    "start": "1389480",
    "end": "1397360"
  },
  {
    "text": "password um remember the the quality of your output is relatively",
    "start": "1397360",
    "end": "1402440"
  },
  {
    "text": "unimportant um as as far as interactivity is going I want to be able to send the command which I can do very effectively and I want to have some",
    "start": "1402440",
    "end": "1408919"
  },
  {
    "text": "indication that the command is working and I want to be able to get my data up so if I do an IP config and it sort of comes out a little bit broken like this",
    "start": "1408919",
    "end": "1415520"
  },
  {
    "text": "that's okay I can pull the data out do a net stat see what the routes are numerate the users all of that can work",
    "start": "1415520",
    "end": "1422080"
  },
  {
    "text": "and most of the dos commands would allow me some degree of control over the formatting right so I can for like this",
    "start": "1422080",
    "end": "1428480"
  },
  {
    "text": "the SLB /x that I did when I did the dur that tells me to drop the Tells dur to",
    "start": "1428480",
    "end": "1434120"
  },
  {
    "text": "drop the headers it doesn't say directory of blah blah blah date blah blah blah it just gives gives the files",
    "start": "1434120",
    "end": "1439440"
  },
  {
    "text": "and the /x Tells it to send it out an 8.3 format so I don't get file names with spaces in them and so I ensure that",
    "start": "1439440",
    "end": "1446039"
  },
  {
    "text": "all my files come through in a way that I can easily read them okay so with a combination of those two things I can",
    "start": "1446039",
    "end": "1451159"
  },
  {
    "text": "get it and all of this going proxied via UDP out okay regardless of how far",
    "start": "1451159",
    "end": "1457559"
  },
  {
    "text": "buried the server is inside the private Network regardless of what its actual IP addresses etc etc if you want to upload",
    "start": "1457559",
    "end": "1464440"
  },
  {
    "text": "something in that's that's difficult uploading something in is significantly more difficult it's uh it's just as",
    "start": "1464440",
    "end": "1470200"
  },
  {
    "text": "important we can talk about that um in a little while but as far as uploading things in there's no single Golden Rule",
    "start": "1470200",
    "end": "1476640"
  },
  {
    "text": "there are a lot of different things you can try depending on the scenario one thing you can do with SQL is you can",
    "start": "1476640",
    "end": "1481880"
  },
  {
    "text": "write a SQL query which uses an open row Source command to literally make another",
    "start": "1481880",
    "end": "1486960"
  },
  {
    "text": "connection to another server so I can run one query which tells this SQL Server to make a connection to my SQL",
    "start": "1486960",
    "end": "1492919"
  },
  {
    "text": "server and copy across a table and then run another query that tells it to take that table and write it to the file",
    "start": "1492919",
    "end": "1498919"
  },
  {
    "text": "system um so you can do that sort of thing for example but that's all going to depend on what the specific",
    "start": "1498919",
    "end": "1504399"
  },
  {
    "text": "configuration is we'll play with that kind of thinking in a minute all right it's Advanced I'm you now because I want",
    "start": "1504399",
    "end": "1510360"
  },
  {
    "text": "you to um you're going to see the value of it in a little while okay so again in this particular context where I have a",
    "start": "1510360",
    "end": "1516200"
  },
  {
    "text": "direct connection to SQL Server doing this doesn't make a heck of a lot of sense but uh in a minute I'm going to",
    "start": "1516200",
    "end": "1521799"
  },
  {
    "text": "show you a scenario where you don't have a direct connection to the SQL server but you're still able to execute SQL",
    "start": "1521799",
    "end": "1527600"
  },
  {
    "text": "queries and then this sort of thing does make a lot more sense yes let's say we have way get that",
    "start": "1527600",
    "end": "1536120"
  },
  {
    "text": "out yeah let's say the only way you can get it out is",
    "start": "1536600",
    "end": "1542039"
  },
  {
    "text": "image yeah what but this a spot question um I",
    "start": "1542039",
    "end": "1549159"
  },
  {
    "text": "don't really want to spend too much now we're going to be spending quite a lot of time on it in a little while um and the answer is I don't know and it's",
    "start": "1549159",
    "end": "1555600"
  },
  {
    "text": "going to vary um in the back of the guy in fact to answer your question look on the back of the guide there's a case",
    "start": "1555600",
    "end": "1561159"
  },
  {
    "text": "study um which in fact addresses exactly that question it's a question where we're executing commands on a SQL Server",
    "start": "1561159",
    "end": "1567440"
  },
  {
    "text": "which is buried deep inside the network um and we're not able to communicate with it directly and what we did then is",
    "start": "1567440",
    "end": "1573600"
  },
  {
    "text": "we basically set up a series of map drives and move the data closer and closer to the perimeter of the network",
    "start": "1573600",
    "end": "1579200"
  },
  {
    "text": "by mapping drives out and eventually wrote it to a web rout where we could access it um and it took I honest it",
    "start": "1579200",
    "end": "1586120"
  },
  {
    "text": "took weeks it took weeks and weeks to do it was very you're working blind um but",
    "start": "1586120",
    "end": "1591559"
  },
  {
    "text": "so there there are various ways and it's it's by the time you get to this point where you're executing commands and now",
    "start": "1591559",
    "end": "1597399"
  },
  {
    "text": "you want to start building your channel and stuff uh we say it's like trying to fix a carart of the exhaust pipe so",
    "start": "1597399",
    "end": "1602760"
  },
  {
    "text": "you've got your hand in there and you're like yeah I think this is the carburetor um let me just pull this here and see if",
    "start": "1602760",
    "end": "1607840"
  },
  {
    "text": "the engine goes faster and then it doesn't so you're like okay that wasn't the carburetor it must be something else and then you're like okay this is the",
    "start": "1607840",
    "end": "1613919"
  },
  {
    "text": "alternator I can recognize it so if I can pull this out here and plug it in of the they up I dropped it and now you're",
    "start": "1613919",
    "end": "1620360"
  },
  {
    "text": "stuck and it's like okay now I have to go and find it again and you go all the way down here it's exactly like that so unfortunately I can't tell you any quick",
    "start": "1620360",
    "end": "1626080"
  },
  {
    "text": "onwers look at the case that'll give you an idea of one of the things that we could ecommerce.com all right but I we need on because we",
    "start": "1626080",
    "end": "1633320"
  },
  {
    "text": "got a lot of interesting and important things to cover everyone's still feeling fresh did I put my speaker on right so",
    "start": "1633320",
    "end": "1639840"
  },
  {
    "text": "what we did was um we went through fingerprinting and in the last section I",
    "start": "1639840",
    "end": "1645240"
  },
  {
    "text": "spoke about uh what I called identifying vulner abilities I said these are V abilities which exist on a machine",
    "start": "1645240",
    "end": "1651000"
  },
  {
    "text": "they've been previously discovered and documented by someone and our job is to try and figure out if they're there and",
    "start": "1651000",
    "end": "1656159"
  },
  {
    "text": "then what we did in the last PRACK is I just gave an example of how we would exploit some of those vulnerabilities and we looked at um two",
    "start": "1656159",
    "end": "1663120"
  },
  {
    "text": "in particular we looked at um the exporting the unic code vulnerability",
    "start": "1663120",
    "end": "1668679"
  },
  {
    "text": "using your browser and using the uni exe that exploiting the fact that the",
    "start": "1668679",
    "end": "1673840"
  },
  {
    "text": "guy's got a blank essay password right two fundamentally different kinds of weaknesses exploited andun Mally",
    "start": "1673840",
    "end": "1679000"
  },
  {
    "text": "different kinds of ways giving us different levels of privilege what I want to do now is I want to touch on",
    "start": "1679000",
    "end": "1685600"
  },
  {
    "text": "vulnerabilities that are not previously known or documented all right now if you",
    "start": "1685600",
    "end": "1690960"
  },
  {
    "text": "want to go into finding vulnerabilities in uh windows binaries for example you visit H's class or Greg Hogan's class",
    "start": "1690960",
    "end": "1697440"
  },
  {
    "text": "what I'm talking about here is a class of vulnerability we call back security vulnerability so we're looking at faults",
    "start": "1697440",
    "end": "1704880"
  },
  {
    "text": "in customized web applications be customized they can be commercial web",
    "start": "1704880",
    "end": "1711120"
  },
  {
    "text": "applications who who'd like to comment on why we're interested in finding vulnerabilities in commercial um web",
    "start": "1711120",
    "end": "1719039"
  },
  {
    "text": "applications multiple targets sorry multiple targets many people may have",
    "start": "1719039",
    "end": "1724760"
  },
  {
    "text": "EXA exactly well sorry I actually Mis phrased my question I said commercial I'm not interested only in commercial",
    "start": "1724760",
    "end": "1730080"
  },
  {
    "text": "but in web applications in general why would I be interested in finding vulnerability specifically in web applications",
    "start": "1730080",
    "end": "1737880"
  },
  {
    "text": "exactly there's two very very compelling reasons as Microsoft would put it um",
    "start": "1740120",
    "end": "1745760"
  },
  {
    "text": "they're there's so many of them and they're directly accessible like the gateway to to anyone's Network these",
    "start": "1745760",
    "end": "1752600"
  },
  {
    "text": "days the primary point of access is a web server it's a web application right so it's by far the most",
    "start": "1752600",
    "end": "1759000"
  },
  {
    "text": "prevalent um application on the internet and um and because it's interactive because",
    "start": "1759000",
    "end": "1766519"
  },
  {
    "text": "it have you have this whole thing between the web server and the database server it gives us a fair chance of getting into the into the private",
    "start": "1766519",
    "end": "1773240"
  },
  {
    "text": "network am I making sense I've really mangled my words badly but you understand what I'm saying basically there's a lot in them all right and",
    "start": "1773240",
    "end": "1779880"
  },
  {
    "text": "they're internet facing and very often they give us access to the private Network because the web application is",
    "start": "1779880",
    "end": "1785559"
  },
  {
    "text": "interacting with data on the inside I'm not talking about web servers I'm talking about applications running on",
    "start": "1785559",
    "end": "1791799"
  },
  {
    "text": "web servers that offer us some form of interactivity give me examples shopping s shopping sites e",
    "start": "1791799",
    "end": "1797399"
  },
  {
    "text": "shopping sites what else extra yeah extra night extra",
    "start": "1797399",
    "end": "1802679"
  },
  {
    "text": "net sites what else big one internet banking sites right",
    "start": "1802679",
    "end": "1809159"
  },
  {
    "text": "internet banking it's a big web application oh those all very secure",
    "start": "1809159",
    "end": "1814399"
  },
  {
    "text": "problems there um internet banking application I'll give you a statistic I can't give",
    "start": "1814399",
    "end": "1819679"
  },
  {
    "text": "you names but I've worked in the last year on",
    "start": "1819679",
    "end": "1825760"
  },
  {
    "text": "five major internet banking applications all of them and not because we're",
    "start": "1828799",
    "end": "1834039"
  },
  {
    "text": "particularly clever standard kind of stuff that I'm going to teach you now um and the reason that these things are so",
    "start": "1834039",
    "end": "1840200"
  },
  {
    "text": "insecure is because there's a there's a thinking gap between web application",
    "start": "1840200",
    "end": "1845519"
  },
  {
    "text": "developers and hackers in this space at the moment hackers are wearing a completely different hat when they look",
    "start": "1845519",
    "end": "1850679"
  },
  {
    "text": "at these things um and they're running way way ahead of the application developers the application developers",
    "start": "1850679",
    "end": "1856000"
  },
  {
    "text": "are still trying to solve other kinds of problem so um whereas Microsoft over the",
    "start": "1856000",
    "end": "1861360"
  },
  {
    "text": "last 2 3 four 5 years drilled and hammered and hammered and hammered about security uh these web application guys",
    "start": "1861360",
    "end": "1867440"
  },
  {
    "text": "haven't been no one's giving them a hard time yet uh firstly secondly most of",
    "start": "1867440",
    "end": "1873279"
  },
  {
    "text": "these guys are um locally seated that they're locally positioned they're not we're not talking about big companies",
    "start": "1873279",
    "end": "1879799"
  },
  {
    "text": "like Microsoft developing web applications we're talking about the bank's own developers this e-commerce Shop's own developers this Mom and Pop",
    "start": "1879799",
    "end": "1885919"
  },
  {
    "text": "store own Developers right um the companies used to be there used to be web design companies that used to do",
    "start": "1885919",
    "end": "1891039"
  },
  {
    "text": "these you know graphics and stuff they're like oh yeah we're bringing a guy who knows a bit of HTML oh we're bringing a guy who knows a bit of active",
    "start": "1891039",
    "end": "1896440"
  },
  {
    "text": "X or Flash we bring in a guy and knows a bit of this he surfs around reads a couple of books he's like oh wait hang on look I can give this a login page",
    "start": "1896440",
    "end": "1903080"
  },
  {
    "text": "suddenly oh look we can do this and the next thing you know he's building an interactive site um and he's raised the",
    "start": "1903080",
    "end": "1908480"
  },
  {
    "text": "security profile of the thing massively because now this connection is going to databases on the inside of the private Network um but it's still the same guy",
    "start": "1908480",
    "end": "1915760"
  },
  {
    "text": "right who started off his career writing um JavaScript like oh look at this popup all right so there's a big skills",
    "start": "1915760",
    "end": "1923399"
  },
  {
    "text": "deficit um at the moment with web applications so they're a very very interesting space to look at and the",
    "start": "1923399",
    "end": "1929000"
  },
  {
    "text": "final reason why they're interesting is because they're fundamentally challenges with web applications that are very very",
    "start": "1929000",
    "end": "1934159"
  },
  {
    "text": "hard to solve and the biggest of those challenges is what we call State tracking right when you log in to FTP",
    "start": "1934159",
    "end": "1941919"
  },
  {
    "text": "tnet SSH POP 3 any of those things you make a single TCP connection you",
    "start": "1941919",
    "end": "1947200"
  },
  {
    "text": "authenticate and as long as your connection is established you remain authenticated",
    "start": "1947200",
    "end": "1952919"
  },
  {
    "text": "right the minute your connection breaks you're no longer authenticated you have to log in again TCP is keeping state for",
    "start": "1952919",
    "end": "1958480"
  },
  {
    "text": "you now imagine a web application you make a connection to the web server you pull down the page Log In you connect",
    "start": "1958480",
    "end": "1964799"
  },
  {
    "text": "you disconnect all right now you sub you fill out the form username password you",
    "start": "1964799",
    "end": "1970039"
  },
  {
    "text": "submit it it gets posted connect disconnect all right you're like okay now I want to surve to this part of the",
    "start": "1970039",
    "end": "1976159"
  },
  {
    "text": "site I click on the link connect disconnect there's dozens hundreds of connections going in and out the whole time da da da",
    "start": "1976159",
    "end": "1981840"
  },
  {
    "text": "da da da and doing all of this as you're browsing around you're buying um you're buying fluffy slippers pink fluffy",
    "start": "1981840",
    "end": "1988720"
  },
  {
    "text": "slippers from an e-commerce site and you're like okay log in to my e-commerce site give them my details lick my profile blah blah blah you go to their",
    "start": "1988720",
    "end": "1995240"
  },
  {
    "text": "bed wear category you select Footwear slippers pink fluffy size four as you're moving around this um application the",
    "start": "1995240",
    "end": "2002720"
  },
  {
    "text": "whole time this web application somehow has to keep track of who you are right",
    "start": "2002720",
    "end": "2008080"
  },
  {
    "text": "who is this guy that that we we T him it's new connection where he is in the application and and what he is allowed",
    "start": "2008080",
    "end": "2014760"
  },
  {
    "text": "what he selected in the past right so he's already in this category he's already told us he wants his prices in dollars he's already told us he's got",
    "start": "2014760",
    "end": "2021320"
  },
  {
    "text": "this discount vouer um etc etc and what he's allowed and not allowed to do same with internet banking it's massively",
    "start": "2021320",
    "end": "2027399"
  },
  {
    "text": "complic applications handling multiple connections all the time so State tracking is a major Challenge and the",
    "start": "2027399",
    "end": "2032480"
  },
  {
    "text": "guys make mistakes and as hackers we want to try and identify and exploit those mistakes",
    "start": "2032480",
    "end": "2039720"
  },
  {
    "text": "sorts of things that we can look for this is all going to sound like Greek now but in a little while you'll start to understand it sort of thing we can",
    "start": "2040720",
    "end": "2047519"
  },
  {
    "text": "look for is what we call Direct traversal I showed you a form of directory traversal with the uni Cod thing it works like this you there's a",
    "start": "2047519",
    "end": "2055560"
  },
  {
    "text": "um a UD that a URL that allows you to download a file so you serve to this CGI",
    "start": "2055560",
    "end": "2060679"
  },
  {
    "text": "show file it has a question mark reflecting that there's going to be parameters and the first parameter is",
    "start": "2060679",
    "end": "2066320"
  },
  {
    "text": "cool is f and and it takes a file name so what happens is this CGI is going to",
    "start": "2066320",
    "end": "2071919"
  },
  {
    "text": "fetch that file somewhere from the file server format it perhaps in a certain way and send it to you that's what the",
    "start": "2071919",
    "end": "2077638"
  },
  {
    "text": "CGI does what we do is we take the file name we replace this file name with the",
    "start": "2077639",
    "end": "2083358"
  },
  {
    "text": "direct traversal and the file and the and the name of the ETC Shadow file and",
    "start": "2083359",
    "end": "2088638"
  },
  {
    "text": "I get the CGI to go and fetch the ETC Shadow file from the ETC directory and",
    "start": "2088639",
    "end": "2093679"
  },
  {
    "text": "pass it to me right what's the mistake that the programmer made",
    "start": "2093679",
    "end": "2099320"
  },
  {
    "text": "he's not checking for directory traversal right he's not doing prop input validation if Microsoft can do",
    "start": "2099720",
    "end": "2105400"
  },
  {
    "text": "that in the I team uh it doesn't surprise me that this guy doesn't do it",
    "start": "2105400",
    "end": "2110599"
  },
  {
    "text": "right he didn't know um and maybe he's smart enough he says oh wait hang on we'll check for dot dot slash so what I do I un encode my my request you didn't",
    "start": "2110599",
    "end": "2118760"
  },
  {
    "text": "know to check for that or I hex encode it all right he didn't know to check for that that's an example of direct R",
    "start": "2118760",
    "end": "2125119"
  },
  {
    "text": "traversal command execution um I submit think an example who is",
    "start": "2125119",
    "end": "2132040"
  },
  {
    "text": "remember who geek tools and who is what are those guys they're taking the name",
    "start": "2132040",
    "end": "2137359"
  },
  {
    "text": "of the DNS domain that I want to look at and they're passing it as a parameter to",
    "start": "2137359",
    "end": "2143359"
  },
  {
    "text": "some program that does the who is lookup right in fact we've got a copy of the",
    "start": "2143359",
    "end": "2148720"
  },
  {
    "text": "GTO one it's called proxy and and literally what they do is they take the DNS name and they pass it",
    "start": "2148720",
    "end": "2157400"
  },
  {
    "text": "to py. and they take the output and they to for you that's all they",
    "start": "2157400",
    "end": "2164000"
  },
  {
    "text": "do at the end of my domain name so an ampersand or a pipe or a or a or a um",
    "start": "2164000",
    "end": "2171839"
  },
  {
    "text": "semicolon or something that's understood by the particular operating system um that they're running on and I use it to",
    "start": "2171839",
    "end": "2177680"
  },
  {
    "text": "change chain my commands one behind the other you're understanding this right so",
    "start": "2177680",
    "end": "2184040"
  },
  {
    "text": "um so what happens is they take sst.com",
    "start": "2184040",
    "end": "2189319"
  },
  {
    "text": "semicolon Alis for example and the command that they end up executing is p",
    "start": "2189319",
    "end": "2195720"
  },
  {
    "text": "uh proxyl sense.com semicolon Alis and they pipe that all back to me and so I get them to execute commands on my",
    "start": "2195720",
    "end": "2202400"
  },
  {
    "text": "behalf again an input validation problem um SQL insertion I'm going to talk about in a in a in depth in a second and",
    "start": "2202400",
    "end": "2210040"
  },
  {
    "text": "essentially what we do there is we're trying to manipulate the query that's created by the website and sent to the database in such a way that we can get",
    "start": "2210040",
    "end": "2216119"
  },
  {
    "text": "the database to do something that it wasn't designed to do and finally State problems the um",
    "start": "2216119",
    "end": "2222560"
  },
  {
    "text": "like we said the server has to keep P not only but of where you are in the application and of what you're allowed",
    "start": "2222560",
    "end": "2228480"
  },
  {
    "text": "to do and it's a massive undertaking for a developer and because every page on a website is a distinct application right",
    "start": "2228480",
    "end": "2236079"
  },
  {
    "text": "it's view account. ASP transfer funds. ASP login.asp log out. ASP every one of",
    "start": "2236079",
    "end": "2242400"
  },
  {
    "text": "those is a different application so even if he does it right in 99% of his Pages he may be doing it wrong in just one all",
    "start": "2242400",
    "end": "2249599"
  },
  {
    "text": "right so the pro guy the odds are really against it let's have a look at one this is a",
    "start": "2249599",
    "end": "2254720"
  },
  {
    "text": "state PR State tracking problem uh this is an application that we wrote that's an automated scanner and what it does is",
    "start": "2254720",
    "end": "2260800"
  },
  {
    "text": "every day it runs a set of scans and it reports the results in a table like this and then you can see yeah you know sort",
    "start": "2260800",
    "end": "2268319"
  },
  {
    "text": "of how serious those results were and um if you want to view any of these reports you can click for example here on The",
    "start": "2268319",
    "end": "2274760"
  },
  {
    "text": "View link and it'll then take you to the details of this report now to get to this point in the page in the",
    "start": "2274760",
    "end": "2280880"
  },
  {
    "text": "application I first had to log in I gave my username and password the username and password were validated against data",
    "start": "2280880",
    "end": "2287000"
  },
  {
    "text": "that database and at that point the application generates a session ID which is a very long um 32 bytes random number",
    "start": "2287000",
    "end": "2296760"
  },
  {
    "text": "and it passes it back to me in the form of the URL so the tag onto the end of every URL that I can click on is the",
    "start": "2296760",
    "end": "2304280"
  },
  {
    "text": "session ID and you see it over here here's a long number over here here's a slightly truncated version of it a",
    "start": "2304280",
    "end": "2310599"
  },
  {
    "text": "truncated version of it so any one of these URLs that I clicked on is going to look like this it directs me to the actual CGI that I'm calling it passes it",
    "start": "2310599",
    "end": "2318440"
  },
  {
    "text": "the tracking number this thing over here and over here it passes it the report ID that I want to",
    "start": "2318440",
    "end": "2323760"
  },
  {
    "text": "view so by clicking on there I'm saying I want to view the report this is the",
    "start": "2323760",
    "end": "2329680"
  },
  {
    "text": "session ID that you assigned me when I logged in and this is the report that I want to",
    "start": "2329680",
    "end": "2335240"
  },
  {
    "text": "see okay and the web server then I'm going to evoke that CGI and hopefully show me the results of that report now",
    "start": "2335240",
    "end": "2342119"
  },
  {
    "text": "think about it from the programmer's point of view when you click on that he has to do a number of Security checks what's the first most obvious check that",
    "start": "2342119",
    "end": "2347760"
  },
  {
    "text": "he has to do session ID is valid he has to check that the session ID is valid so store it somewhere in the database he's",
    "start": "2347760",
    "end": "2354240"
  },
  {
    "text": "got this session ID um associated with my account and maybe associated with some so like you've been logged in since",
    "start": "2354240",
    "end": "2361200"
  },
  {
    "text": "and you've only got an hour before I time you up so the first thing he's going to do is going to say okay is this guy is this a valid session right it is",
    "start": "2361200",
    "end": "2368200"
  },
  {
    "text": "it's in the database and is it still valid based on the time yes it is but he has to do with something else who can",
    "start": "2368200",
    "end": "2374520"
  },
  {
    "text": "tell me what that",
    "start": "2374520",
    "end": "2377119"
  },
  {
    "text": "is he has to check whether the report that I'm wishing to",
    "start": "2381079",
    "end": "2386640"
  },
  {
    "text": "view legitimately belongs to the user who's associated with that session",
    "start": "2386640",
    "end": "2393560"
  },
  {
    "text": "ID okay because otherwise how would I attack this application",
    "start": "2393760",
    "end": "2399119"
  },
  {
    "text": "yeah I log in as a valid user I look at all these reports I see oh I've got 958 and over here I've got uh 994 and over",
    "start": "2399119",
    "end": "2406280"
  },
  {
    "text": "here I've got 1023 and obviously what's happening is as this machine is generating reports it's assigning them a",
    "start": "2406280",
    "end": "2411359"
  },
  {
    "text": "new report ID right sequentially and I can see that because there's gaps in mine so I'm thinking well between my 958",
    "start": "2411359",
    "end": "2419160"
  },
  {
    "text": "and my 9 UM 982 there's a whole lot of reports that probably belong to somebody else so I copy this URL out I paste it",
    "start": "2419160",
    "end": "2427119"
  },
  {
    "text": "into to the task barar my my address bar and I replace the 958 with the 884",
    "start": "2427119",
    "end": "2434119"
  },
  {
    "text": "whatever and what do you know the system checks are you authenticated yes and it pulls somebody else's report out of the",
    "start": "2434119",
    "end": "2439240"
  },
  {
    "text": "database and shows it to me very very common mistake it's a web it's a state tracking authentication problem not an",
    "start": "2439240",
    "end": "2445280"
  },
  {
    "text": "authentication authorization problem and you see this thing happening in Internet banking a lot for example I log in and",
    "start": "2445280",
    "end": "2451599"
  },
  {
    "text": "then I access somebody else's account by manipulating either the URL or the um",
    "start": "2451599",
    "end": "2457000"
  },
  {
    "text": "the value the data in the cookie or the hidden form fields that the developer is using to keep state of the application I",
    "start": "2457000",
    "end": "2463920"
  },
  {
    "text": "know this is complex and you haven't CG it's hard but in a while you'll see it actually in action and it'll make a bit",
    "start": "2463920",
    "end": "2468960"
  },
  {
    "text": "more sense this is one someone here was telling about that they told you about in the foundstone course again it's a",
    "start": "2468960",
    "end": "2475359"
  },
  {
    "text": "simplified version of an e-commerce application bear in mind what's happened here is um you've gone through this",
    "start": "2475359",
    "end": "2481400"
  },
  {
    "text": "entire bank process blah blah selecting categories colors sizes numbers whatever",
    "start": "2481400",
    "end": "2487079"
  },
  {
    "text": "and and eventually you get to this point where you say okay I'm going to buy this book and you're going to fill in the",
    "start": "2487079",
    "end": "2492200"
  },
  {
    "text": "number and the name of the book and the system has collected out of its database",
    "start": "2492200",
    "end": "2497240"
  },
  {
    "text": "the price of what that book is going to cost you right so once you've entered the number and the name you're going to",
    "start": "2497240",
    "end": "2504440"
  },
  {
    "text": "say submit and what this thing is typically going to do is it's going to take those values along with the price",
    "start": "2504440",
    "end": "2509520"
  },
  {
    "text": "which it previously pulled out of the database right and it's going to submit it to a CGI which typically is going to",
    "start": "2509520",
    "end": "2515800"
  },
  {
    "text": "then forward it to some kind of Ecom Gateway some sort of transaction program there's lots of service providers that do that they're going to deduct the",
    "start": "2515800",
    "end": "2521880"
  },
  {
    "text": "money from your they'll send a a a success code",
    "start": "2521880",
    "end": "2527560"
  },
  {
    "text": "back to the application application will say your transaction has been processed and forwarded on to shipping",
    "start": "2527560",
    "end": "2533280"
  },
  {
    "text": "right so I look at the source of this and I see that here's",
    "start": "2533280",
    "end": "2540720"
  },
  {
    "text": "the here's the um the number the value that I put in there is going to go get",
    "start": "2542839",
    "end": "2548599"
  },
  {
    "text": "stored with this variable the name is not in here and the price that they",
    "start": "2548599",
    "end": "2554079"
  },
  {
    "text": "previously collected is stored in this variable over here total price okay so",
    "start": "2554079",
    "end": "2559760"
  },
  {
    "text": "during a previous phase of this application they did the math and they figured out how much I'm going to have to pay right and they store that value",
    "start": "2559760",
    "end": "2566520"
  },
  {
    "text": "here in this hidden field within the application so what I do is I take this page I view the source I save it locally",
    "start": "2566520",
    "end": "2573640"
  },
  {
    "text": "to my machine right onto my dis then I go I edit this I take this $500 here out and",
    "start": "2573640",
    "end": "2580200"
  },
  {
    "text": "I replace it with $5 okay and then I pop like 100 in there",
    "start": "2580200",
    "end": "2585240"
  },
  {
    "text": "and the name of the book that I want and I say submit and what happens I end up posting to the CGI that it should",
    "start": "2585240",
    "end": "2591599"
  },
  {
    "text": "process 500 copies of my favorite um you know bird watching magazine for only a",
    "start": "2591599",
    "end": "2598119"
  },
  {
    "text": "total of $5 it's a very simplified example but it happens all the time do you understand and what's what mistake",
    "start": "2598119",
    "end": "2604400"
  },
  {
    "text": "is the developer making here they're relying on their highs he's using me and my browser as a",
    "start": "2604400",
    "end": "2609960"
  },
  {
    "text": "repository for his State data right CU he previously determined how much I'm supposed to pay during a previous part",
    "start": "2609960",
    "end": "2616040"
  },
  {
    "text": "of the application now he's like okay he has to pay 500 how am I going to remember that um I'll tell you what I",
    "start": "2616040",
    "end": "2621280"
  },
  {
    "text": "I'll write it into hidden field in the form so that when he submits I can just pull it out of the form again and he's",
    "start": "2621280",
    "end": "2627640"
  },
  {
    "text": "depending on me to safely store that data and I don't have to I save it to my machine I manipulate it using a number",
    "start": "2627640",
    "end": "2633520"
  },
  {
    "text": "of different techniques and I send it back to him and he's made the mistake of trusting the client",
    "start": "2633520",
    "end": "2641400"
  },
  {
    "text": "how exactly he should have some from a scratch pad that he saves in the database or yeah just do theer or do the",
    "start": "2646520",
    "end": "2652559"
  },
  {
    "text": "query or do the query again but in this case it's simple but there may be other stuff there may be for example you know",
    "start": "2652559",
    "end": "2658480"
  },
  {
    "text": "more complex information the characteristics the properties of the thing that you want to buy isn't as supposed to solve all this ASP has a",
    "start": "2658480",
    "end": "2664440"
  },
  {
    "text": "state variable can stick anything in it and yeah and he just uses a cookie to look it up to to a degree um yeah it",
    "start": "2664440",
    "end": "2672000"
  },
  {
    "text": "sort of does but not really there's still other similar issues depending on the complexity of the of the application",
    "start": "2672000",
    "end": "2677640"
  },
  {
    "text": "and and you'll see an example of some of them a little bit later also using to get I haven't yet no no and oh you have",
    "start": "2677640",
    "end": "2686359"
  },
  {
    "text": "you exactly there in this hotel no in another hotel um sent me this mail the other day",
    "start": "2686359",
    "end": "2694000"
  },
  {
    "text": "it says a famous car dealership we're working for they big model car that that you would all know some of you probably",
    "start": "2694000",
    "end": "2700319"
  },
  {
    "text": "drive them uses the middleman for secure payments exactly the kind of scenario that uh that we were talking about he",
    "start": "2700319",
    "end": "2706480"
  },
  {
    "text": "says you choose an item the item and the price is sent to the Gateway to handle the payment stuff wonder what happens if",
    "start": "2706480",
    "end": "2712000"
  },
  {
    "text": "we change the price before submitting the Gateway last count he had three t-shirts two beanies those those little",
    "start": "2712000",
    "end": "2717880"
  },
  {
    "text": "hats and a jacket for a total of 98 cents in the end these guys caught us out uh in a count and they wrote us a",
    "start": "2717880",
    "end": "2725400"
  },
  {
    "text": "very nice letter saying they appear have shift us shift us shift us three shirts",
    "start": "2725400",
    "end": "2730920"
  },
  {
    "text": "of B2 beanies in the jacket for9 clerical error would we mind either",
    "start": "2730920",
    "end": "2736040"
  },
  {
    "text": "returning the goods or paying the difference um but the the system did it and it happens all the time the sort of",
    "start": "2736040",
    "end": "2742160"
  },
  {
    "text": "thing happens all the time how do we find these kinds of errors in",
    "start": "2742160",
    "end": "2747800"
  },
  {
    "text": "applications how do we go about finding them sorry Source um yeah the HTML",
    "start": "2747800",
    "end": "2755000"
  },
  {
    "text": "Source remember you don't see the source code ever yeah Muses it's essentially a question",
    "start": "2755000",
    "end": "2760640"
  },
  {
    "text": "of elbow grease it's essentially a question of Surfing and surfing and surfing and surfing and asking all those",
    "start": "2760640",
    "end": "2766240"
  },
  {
    "text": "questions that I was telling you about previously who are these guys how do they work how do they their technology how do they know who I am at this point",
    "start": "2766240",
    "end": "2772880"
  },
  {
    "text": "what happens if I do this what happens if I do this and error forcing error forcing eror error forcing make it break",
    "start": "2772880",
    "end": "2779880"
  },
  {
    "text": "see how it behaves we'll see examples that a two another one you've all seen this now you have to concentrate this",
    "start": "2779880",
    "end": "2785960"
  },
  {
    "text": "really tricky you've all seen this right login and password typically what the guy do the",
    "start": "2785960",
    "end": "2792480"
  },
  {
    "text": "back end of this page and his ASP Source or in his PHP Source he's got a SQL query that's built like this he creates",
    "start": "2792480",
    "end": "2799640"
  },
  {
    "text": "a res result variable which is which is a a SQL query right and the SQL query",
    "start": "2799640",
    "end": "2804920"
  },
  {
    "text": "says select from the users table remember the database that we saw all the users where the card number equals",
    "start": "2804920",
    "end": "2812359"
  },
  {
    "text": "whatever is there and the pen number equals whatever is there now remember",
    "start": "2812359",
    "end": "2817640"
  },
  {
    "text": "our table that we saw this is how his thinking is going to work he's going to say I'll build this query right I insert",
    "start": "2817640",
    "end": "2824960"
  },
  {
    "text": "the card number and the pin that the user gave me and I send the query to the database the database runs through the",
    "start": "2824960",
    "end": "2830640"
  },
  {
    "text": "table looking for any records that match right if it finds a record that match matches it returns to and if I get",
    "start": "2830640",
    "end": "2838640"
  },
  {
    "text": "a record returned by the database I know that it found a matching user right in other words I know that this user is",
    "start": "2838640",
    "end": "2845119"
  },
  {
    "text": "valid and in in a number of particularly ASP",
    "start": "2845119",
    "end": "2850559"
  },
  {
    "text": "applications the logic the guy appes is if I send this query and I get a reply then I know that the user is valid and I",
    "start": "2850559",
    "end": "2857359"
  },
  {
    "text": "therefore log him in okay he checks if this at least more record in he checks to see if there's at",
    "start": "2857359",
    "end": "2863480"
  },
  {
    "text": "least one record and his and his logic is sound were you to enter a correct card number and an incorrect pin the",
    "start": "2863480",
    "end": "2869400"
  },
  {
    "text": "database would return no records where you to insert a correct pin but an incorrect card number database would",
    "start": "2869400",
    "end": "2875440"
  },
  {
    "text": "return no records and if both correct the database with return our records in other words if I get a record must be a",
    "start": "2875440",
    "end": "2880520"
  },
  {
    "text": "matching combination right Flawless lock so we do this that goes there that goes",
    "start": "2880520",
    "end": "2887000"
  },
  {
    "text": "in there so in that field I insert something that looks a little bit like that as a user me in that field I insert",
    "start": "2887000",
    "end": "2894720"
  },
  {
    "text": "a bit of crud now watch what the effect is of that on my database on my query my",
    "start": "2894720",
    "end": "2900000"
  },
  {
    "text": "query now is select all the records from the user table where the card number equals",
    "start": "2900000",
    "end": "2905559"
  },
  {
    "text": "X or or where 1 equals 1 and I take on the end this minus minus and what this",
    "start": "2905559",
    "end": "2912280"
  },
  {
    "text": "minus minus is it's for SQL a comment meaning that everything to the right of it gets ignored in the SQL query so in",
    "start": "2912280",
    "end": "2918920"
  },
  {
    "text": "essence that there Falls away now logically my query says give me back all the records where either the card number",
    "start": "2918920",
    "end": "2926200"
  },
  {
    "text": "equals x which is never going to be true or where 1 equals 1 which is always",
    "start": "2926200",
    "end": "2931720"
  },
  {
    "text": "going to be true always regardless of the content of that record that query is always going to be true so how many",
    "start": "2931720",
    "end": "2937040"
  },
  {
    "text": "records does the database return to me all of them if my logic said well if I",
    "start": "2937040",
    "end": "2943240"
  },
  {
    "text": "get more than zero then it must be valid then in this I'm now a valid user let me show you the exact code looks like that",
    "start": "2943240",
    "end": "2951440"
  },
  {
    "text": "select star from users where the user name equals and you see these red single quotes over",
    "start": "2951440",
    "end": "2957440"
  },
  {
    "text": "here uh these are single quotes that the that the developer is injecting to encapsulate the",
    "start": "2957440",
    "end": "2964520"
  },
  {
    "text": "variable all right so if we inser a value in there his total query now",
    "start": "2964520",
    "end": "2971400"
  },
  {
    "text": "looks like that see this single quote comes from there and this single quote",
    "start": "2971400",
    "end": "2976839"
  },
  {
    "text": "comes from there it's important the single quotes thing is important so I inject into the first",
    "start": "2976839",
    "end": "2983880"
  },
  {
    "text": "field something like test nicely encapsulated within single quotes into the second field I inject my own single",
    "start": "2983880",
    "end": "2991640"
  },
  {
    "text": "quote why cuz I need to terminate his if I don't do that I'm going going to get",
    "start": "2991640",
    "end": "2996960"
  },
  {
    "text": "an error message right my SQL will be unsound so I inject a single quote to termin it his I add my R1 equal 1 and",
    "start": "2996960",
    "end": "3002160"
  },
  {
    "text": "now that's aing single quote at the back which is going to break my query but I get rid of it by injecting the two comments so this single code Falls away",
    "start": "3002160",
    "end": "3009079"
  },
  {
    "text": "and it doesn't bother anything I've got a sound clear um SQL statement which now reads like this select start from the",
    "start": "3009079",
    "end": "3016040"
  },
  {
    "text": "user table where the username equals test and the password equals X or where",
    "start": "3016040",
    "end": "3023000"
  },
  {
    "text": "1al 1 which is always going to be true and in this case the thing is going to",
    "start": "3023000",
    "end": "3029400"
  },
  {
    "text": "return all the records now we can try that and and this we didn't make up this",
    "start": "3029400",
    "end": "3034880"
  },
  {
    "text": "was literally copied know ASP well",
    "start": "3034880",
    "end": "3039920"
  },
  {
    "text": "enough right 1015 10100 remember when we did the ncto scans against this machine we found an admin directory guys",
    "start": "3040720",
    "end": "3047920"
  },
  {
    "text": "remember that we said slash",
    "start": "3047920",
    "end": "3052838"
  },
  {
    "text": "admin and it said no now",
    "start": "3053720",
    "end": "3058640"
  },
  {
    "text": "this really good bit FAS than this we are",
    "start": "3067160",
    "end": "3072559"
  },
  {
    "text": "p is it",
    "start": "3074359",
    "end": "3077720"
  },
  {
    "text": "did let Che that on the right place there we go all right it looks like that",
    "start": "3079599",
    "end": "3085839"
  },
  {
    "text": "um let me show you this once and you're get a chance to you're going to get a chance",
    "start": "3085839",
    "end": "3091079"
  },
  {
    "text": "to try it out in a second right looks like that so if I for example go over here test",
    "start": "3091079",
    "end": "3097000"
  },
  {
    "text": "test H that was the DAT that was the password that I just injected into as I",
    "start": "3097000",
    "end": "3103040"
  },
  {
    "text": "just injected into the database there a little while ago right this is the same database but now I can't get you anymore I don't",
    "start": "3103040",
    "end": "3110640"
  },
  {
    "text": "think because if I'm right",
    "start": "3110640",
    "end": "3116160"
  },
  {
    "text": "the fire was should now be blocking it right so I no longer have direct access to that SQL Ser but this application is",
    "start": "3117920",
    "end": "3124280"
  },
  {
    "text": "logging in as saay to that SQL Server I can't see the SQL Server myself anymore",
    "start": "3124280",
    "end": "3129680"
  },
  {
    "text": "so let's forget test test be the admin admin tells me access",
    "start": "3129680",
    "end": "3135680"
  },
  {
    "text": "denied so I tell it test and I say x single quote space or 1",
    "start": "3135680",
    "end": "3147119"
  },
  {
    "text": "= 1 throw in the minus minus and it drops me in all right using",
    "start": "3147119",
    "end": "3153000"
  },
  {
    "text": "exactly that kind of problem now how do I find something like this on a site well typically what I'm going to do",
    "start": "3153000",
    "end": "3159520"
  },
  {
    "text": "is I'm going to try Force an error right so I'm going to do something like let me",
    "start": "3159520",
    "end": "3164559"
  },
  {
    "text": "just show you this quickly I'm going to do something like",
    "start": "3164559",
    "end": "3168440"
  },
  {
    "text": "this that's not right like this",
    "start": "3170960",
    "end": "3176760"
  },
  {
    "text": "and I'm going to make sure I've got this and this and this and some of these and",
    "start": "3177040",
    "end": "3182799"
  },
  {
    "text": "a whole lot of stuff like that we call this",
    "start": "3182799",
    "end": "3187200"
  },
  {
    "text": "fuzzing bam my application breaks why because the program is not properly trapping in input which is fundamentally",
    "start": "3188640",
    "end": "3195640"
  },
  {
    "text": "the problem with this thing and what I'm getting here is I'm getting the raw error back from I'm getting the raw",
    "start": "3195640",
    "end": "3202480"
  },
  {
    "text": "error back from from the SQL Server right and from this I can learn a lot I can learn that",
    "start": "3202480",
    "end": "3208559"
  },
  {
    "text": "they're running Microsoft SQL and I can learn that they're running obbc and I can learn that the programmer",
    "start": "3208559",
    "end": "3216079"
  },
  {
    "text": "is a not properly trapping input it's not properly sanitizing input all right",
    "start": "3216079",
    "end": "3221280"
  },
  {
    "text": "and I can learn that b he's not properly sanitizing output okay so I can try something else",
    "start": "3221280",
    "end": "3228079"
  },
  {
    "text": "and in this case I'm just going to put a single quote in this breaks again says unclosed",
    "start": "3228079",
    "end": "3234359"
  },
  {
    "text": "quotation mark before the character string single quote where does that come from it comes from this",
    "start": "3234359",
    "end": "3241079"
  },
  {
    "text": "application where I've injected a single quote and I'm left with something like this",
    "start": "3241079",
    "end": "3249240"
  },
  {
    "text": "this trading single quote that's what I've done so he's now got three single quotes somewhere in his query and it's breaking right and that tells me that",
    "start": "3249240",
    "end": "3256240"
  },
  {
    "text": "this thing is susceptible to this kind of problem",
    "start": "3256240",
    "end": "3261799"
  },
  {
    "text": "okay now um the X or one equals one",
    "start": "3261799",
    "end": "3267119"
  },
  {
    "text": "thing it's not it's just a very simple example of this right it's very and you're going to think it's so simple it's got to be Pat it's not Pat it",
    "start": "3267119",
    "end": "3274079"
  },
  {
    "text": "really happens it's real life I was telling some guys that um in a course I was once teaching in Belgium one of the",
    "start": "3274079",
    "end": "3280799"
  },
  {
    "text": "guys did it on his company in back while I was talking so I go try this 1 equals one bam and he got in because this code",
    "start": "3280799",
    "end": "3286760"
  },
  {
    "text": "is published and distributed as an example of how to handle this problem what's the problem well you've got a web",
    "start": "3286760",
    "end": "3292240"
  },
  {
    "text": "application you want to log your user in you're writing with ASP you got a SQL back end this is how you do it",
    "start": "3292240",
    "end": "3297520"
  },
  {
    "text": "and that's where we got it from so it's not that uncommon but it may be that the particular server that we're attacking",
    "start": "3297520",
    "end": "3302880"
  },
  {
    "text": "is not this simple so we want some tools that are going to help us to do this",
    "start": "3302880",
    "end": "3307960"
  },
  {
    "text": "error forcing and um analysis of the thing a little easier without having to",
    "start": "3307960",
    "end": "3313520"
  },
  {
    "text": "blindly type um into this Fork down here where I can't see and for example if I",
    "start": "3313520",
    "end": "3318760"
  },
  {
    "text": "only put two characters in here",
    "start": "3318760",
    "end": "3322799"
  },
  {
    "text": "broken",
    "start": "3326520",
    "end": "3328880"
  },
  {
    "text": "again supposed to be like a five letter thing here dis verion of",
    "start": "3337079",
    "end": "3342200"
  },
  {
    "text": "it uh the point I actually wanted to make is that sometimes a web application still have JavaScript in front of them",
    "start": "3342200",
    "end": "3347400"
  },
  {
    "text": "too so you enter a too long password or Too Short password will pop up a JavaScript saying oh your password is",
    "start": "3347400",
    "end": "3352799"
  },
  {
    "text": "too long or your password is too short that's not the server checking you that's the web page itself checking you long before the data ever gets to the",
    "start": "3352799",
    "end": "3359039"
  },
  {
    "text": "server and that stuff's going to get in my way when I want to do this sort of thing right so we're going to apply basically two major kinds of tools the",
    "start": "3359039",
    "end": "3366119"
  },
  {
    "text": "first kind of tool we're going to use is what we called a fuzzer what a fuzzer is going to do is it's going to crawl using a number of different techniques CW the",
    "start": "3366119",
    "end": "3372640"
  },
  {
    "text": "website and try and identify any um Active Components so parameters pared in",
    "start": "3372640",
    "end": "3377760"
  },
  {
    "text": "a URL um or fields in a form number of tools that do it with various degrees of",
    "start": "3377760",
    "end": "3385200"
  },
  {
    "text": "uh of success or failure we've got one called Millie X um which uses kind of a semi semi-automated approach to identify",
    "start": "3385200",
    "end": "3392160"
  },
  {
    "text": "all the fields and then what it does is it builds a string which looks something like that one at the bottom and it just",
    "start": "3392160",
    "end": "3398359"
  },
  {
    "text": "hits every form and every field every field and every form hits it da looking for any response that could be construed",
    "start": "3398359",
    "end": "3405000"
  },
  {
    "text": "as an error including like a 500 server error code word error and you can",
    "start": "3405000",
    "end": "3411319"
  },
  {
    "text": "program them usually to um you know to what to look for that's the one kind of tool we're going to that we use I'm not",
    "start": "3411319",
    "end": "3416880"
  },
  {
    "text": "going to use those tools in this class the other kind of tool we use is what web proxy proxy is going to do is it's",
    "start": "3416880",
    "end": "3423440"
  },
  {
    "text": "going to sit between your browser and the server and it's going to record everything that goes up and down so that",
    "start": "3423440",
    "end": "3429640"
  },
  {
    "text": "you can analyze later exactly what you sent and what you got back and so that you can intercept and modify exactly",
    "start": "3429640",
    "end": "3437440"
  },
  {
    "text": "what was sent and what came back one very good one of those something called the at State we",
    "start": "3437440",
    "end": "3443480"
  },
  {
    "text": "Prof which I'm going to fire over here now this is the freeware version it runs as a little Java appet on my machine",
    "start": "3443480",
    "end": "3449680"
  },
  {
    "text": "okay and it's now created a listen socket on my machine and P 5111 I then take my browser and I",
    "start": "3449680",
    "end": "3458079"
  },
  {
    "text": "configure it to Surf via 51 on my Local Host all right",
    "start": "3458079",
    "end": "3465880"
  },
  {
    "text": "now all my requests that be po bu with Java application I can then open up another",
    "start": "3465880",
    "end": "3474720"
  },
  {
    "text": "browser and I can surf to the keyword web proxy and it gives me the",
    "start": "3474720",
    "end": "3480880"
  },
  {
    "text": "interface all right so this is a little administrative interface for this tool and I'm surfing over",
    "start": "3480880",
    "end": "3486839"
  },
  {
    "text": "here so let's not go back I'm here now right and I'm going to say",
    "start": "3486839",
    "end": "3493559"
  },
  {
    "text": "test-1 and test-2 so I can identify the variables later and submit them all right and now",
    "start": "3493559",
    "end": "3501440"
  },
  {
    "text": "go to my web proxy and you see over here I've got a thing called the request editor",
    "start": "3501440",
    "end": "3506760"
  },
  {
    "text": "the request elector keeps a record of all the submissions that I made and here you can see it recorded that I submitted",
    "start": "3506760",
    "end": "3514440"
  },
  {
    "text": "to login. I click on that I can see the exact makeup of the",
    "start": "3514440",
    "end": "3521760"
  },
  {
    "text": "subing the IP address the method that I use the as HTTP the ASP section ID which",
    "start": "3521760",
    "end": "3529920"
  },
  {
    "text": "you referred um ID and here the two Val is I posted",
    "start": "3529920",
    "end": "3536799"
  },
  {
    "text": "the field username I posted test one password I posted um test two and I can",
    "start": "3536799",
    "end": "3544559"
  },
  {
    "text": "Reit this request now at any time just by hitting ENT it's just reposted that page and train me",
    "start": "3544559",
    "end": "3550440"
  },
  {
    "text": "the or I can go back and say well I'm going to replace this with a single quote and now I can see the single quote",
    "start": "3550440",
    "end": "3557599"
  },
  {
    "text": "right and this time I get the error or I can go back and say single",
    "start": "3557599",
    "end": "3563039"
  },
  {
    "text": "quote or 1 = 1 - you can see what I'm doing now kind",
    "start": "3563039",
    "end": "3570799"
  },
  {
    "text": "of and I broke",
    "start": "3571720",
    "end": "3575240"
  },
  {
    "text": "it all righty you understanding the what is the fundamental error that the programmer is making checking for input",
    "start": "3580880",
    "end": "3588480"
  },
  {
    "text": "he's not validating his input it's called input validation all right that's",
    "start": "3588480",
    "end": "3593520"
  },
  {
    "text": "fundamentally the problem yeah is he shouldn't be allow allowing me to put a semicolon or a minus minus into my",
    "start": "3593520",
    "end": "3599359"
  },
  {
    "text": "password fill just doesn't belong there all right um and solving finding and",
    "start": "3599359",
    "end": "3605119"
  },
  {
    "text": "solving things is really not that trivial for a programmer okay um I want to take this",
    "start": "3605119",
    "end": "3611000"
  },
  {
    "text": "one step further Before we or two steps further yeah one step",
    "start": "3611000",
    "end": "3617559"
  },
  {
    "text": "further before we tried ourselves the first thing I want you to understand very carefully is what I'm doing here is",
    "start": "3617559",
    "end": "3622680"
  },
  {
    "text": "is I'm fundamentally modifying the query being sent from the web server to the",
    "start": "3622680",
    "end": "3628480"
  },
  {
    "text": "SQL Server right so I'm actually doing a very ugly form of SQL Pro okay and the better I can understand",
    "start": "3628480",
    "end": "3636799"
  },
  {
    "text": "the nature of the query that he's sending using error forcing and the better uh and depending on the structure",
    "start": "3636799",
    "end": "3643880"
  },
  {
    "text": "of of his query um I can do just about anything using this that I could do",
    "start": "3643880",
    "end": "3650559"
  },
  {
    "text": "using pure SQL from a SQL analyzer so for example I could over here",
    "start": "3650559",
    "end": "3657920"
  },
  {
    "text": "add an order by the first fuel right so I'm telling it to sort the",
    "start": "3658440",
    "end": "3666760"
  },
  {
    "text": "query and that didn't help me much but let's order by the first field",
    "start": "3666760",
    "end": "3673039"
  },
  {
    "text": "descending and suddenly I'm another user right because now it's returning data in the other direction and I'm now",
    "start": "3673039",
    "end": "3679039"
  },
  {
    "text": "not logged in as the first user anymore I'm not logged in as the last user all right or I could say something like this",
    "start": "3679039",
    "end": "3687920"
  },
  {
    "text": "um where one equals 1 and",
    "start": "3688920",
    "end": "3697720"
  },
  {
    "text": "username equals",
    "start": "3697720",
    "end": "3704480"
  },
  {
    "text": "test",
    "start": "3704920",
    "end": "3707920"
  },
  {
    "text": "oops right so I can I can really as once I start to understand the query I can",
    "start": "3714000",
    "end": "3719200"
  },
  {
    "text": "sort of deal with it pretty much what I want and because SQL has this common thing it's really nice because",
    "start": "3719200",
    "end": "3725359"
  },
  {
    "text": "everything to the right of me I just lob away I don't have to worry about it other um databases which don't have that",
    "start": "3725359",
    "end": "3731160"
  },
  {
    "text": "force me to write my syntax in such a way that I literally plug in to the existing query and incorporate whatever",
    "start": "3731160",
    "end": "3736400"
  },
  {
    "text": "is to the right of where I'm injecting sequel I just throw what's to the right away because I've got comments very",
    "start": "3736400",
    "end": "3742119"
  },
  {
    "text": "nice and if I can do this what stops me from do",
    "start": "3742119",
    "end": "3748720"
  },
  {
    "text": "this",
    "start": "3759160",
    "end": "3762160"
  },
  {
    "text": "F goodbye",
    "start": "3767200",
    "end": "3771200"
  },
  {
    "text": "what's the problem here do this the other ways you were doing the stuff where it at least turned",
    "start": "3781359",
    "end": "3788200"
  },
  {
    "text": "something that then the AFK would actually",
    "start": "3788200",
    "end": "3793520"
  },
  {
    "text": "use yeah you're you're you're right you're absolutely right let me ask you this is my query",
    "start": "3794720",
    "end": "3800200"
  },
  {
    "text": "breaking no the query is working let's break the query",
    "start": "3800200",
    "end": "3807000"
  },
  {
    "text": "damn it's not going to break either hang on let's break the query by for example taking one of these out bam the query",
    "start": "3807520",
    "end": "3813599"
  },
  {
    "text": "breaks that's what would happen if the query was breaking my quer is not breaking my quer is going through the",
    "start": "3813599",
    "end": "3819440"
  },
  {
    "text": "problem is this command that I'm asking to be executed what's happening is physically on the SQL service you look",
    "start": "3819440",
    "end": "3825400"
  },
  {
    "text": "very very closely you see a little dos dos box pop up the door would run in the dot spot would",
    "start": "3825400",
    "end": "3831279"
  },
  {
    "text": "close there's no there's no communication of that back back to the web server somehow they can",
    "start": "3831279",
    "end": "3837760"
  },
  {
    "text": "automatically appear on my on my page and remember I was carrying on about the",
    "start": "3837760",
    "end": "3842880"
  },
  {
    "text": "DNS tunnels earlier that's where the NS tunnel thing becomes because I need somewhere for the SQL Server to tell me",
    "start": "3842880",
    "end": "3850319"
  },
  {
    "text": "that this command was executed so I don't do a dur here I replace my dur with an NS",
    "start": "3850319",
    "end": "3859400"
  },
  {
    "text": "lookup sh owns you at s",
    "start": "3859720",
    "end": "3868078"
  },
  {
    "text": "post.net not at got thought I was inventing DNS",
    "start": "3869039",
    "end": "3876920"
  },
  {
    "text": "right and I'm going to go here I'm going to use this little tricking and I don't know what the DNS what the IP address is",
    "start": "3877920",
    "end": "3883359"
  },
  {
    "text": "of the server anymore so I'm going to drop this",
    "start": "3883359",
    "end": "3887720"
  },
  {
    "text": "away now you're going to see all the new uh DNS queries coming in I throw that",
    "start": "3890039",
    "end": "3897640"
  },
  {
    "text": "and there you go all right so now I forced my SQL",
    "start": "3898079",
    "end": "3903960"
  },
  {
    "text": "Server to tell me basically that the commander successfully executed even I",
    "start": "3903960",
    "end": "3909279"
  },
  {
    "text": "have no direct coms with it and using the same techniques that we used earlier I can now start to do IP configs and",
    "start": "3909279",
    "end": "3917200"
  },
  {
    "text": "listing net users and AD users or whatever and essentially any comp that I execute is going through the file to the",
    "start": "3917200",
    "end": "3923319"
  },
  {
    "text": "web server being sent from the web server through the next F all the way to the SQL Server being executed with",
    "start": "3923319",
    "end": "3928799"
  },
  {
    "text": "system privileges right in the middle of their private Network all of it using legitimate traffic assuming the US",
    "start": "3928799",
    "end": "3935319"
  },
  {
    "text": "application the database assuming that the user that the database that log the user that the",
    "start": "3935319",
    "end": "3941079"
  },
  {
    "text": "application log into the database with has the Privileges um now there's a lot that guys can do to stop this apart from",
    "start": "3941079",
    "end": "3946200"
  },
  {
    "text": "just keing up the coding um there SQL lockdown stuff it's determing the Privileges of the SQL user etc etc if",
    "start": "3946200",
    "end": "3952359"
  },
  {
    "text": "you want to learn that stuff SQL security.com on the net there there the the guys to read they're very very",
    "start": "3952359",
    "end": "3958400"
  },
  {
    "text": "excellent I I don't get something uh when you did the CMD shell what what's actually",
    "start": "3958400",
    "end": "3965520"
  },
  {
    "text": "doing and it's returning it as a table that's what it's doing that's why that's",
    "start": "3965520",
    "end": "3970640"
  },
  {
    "text": "what we got from the esql triy yes really returned it as a table so why",
    "start": "3970640",
    "end": "3976720"
  },
  {
    "text": "didn't we just show it instead of the username and access granted the volume",
    "start": "3976720",
    "end": "3982480"
  },
  {
    "text": "well try and try and imagine what your query looks like I'm trying to imagine not what the query looks like but what the application is",
    "start": "3982480",
    "end": "3988480"
  },
  {
    "text": "doing the application is building the query it's sending the query to the server it's not displaying the results",
    "start": "3988480",
    "end": "3995640"
  },
  {
    "text": "it's interpreting the results and reacting appropriately the application is saying if I get a table if I get a",
    "start": "3995640",
    "end": "4002839"
  },
  {
    "text": "result back then I consider the user logged in and I show him this screen if I don't get the right results back I",
    "start": "4002839",
    "end": "4008119"
  },
  {
    "text": "consider him fake and I show him that screen there are other it's not coming from the it's not coming from the database it's coming from the it's the",
    "start": "4008119",
    "end": "4014160"
  },
  {
    "text": "application interpreting the results of the database there are other applications where um where they do show",
    "start": "4014160",
    "end": "4019559"
  },
  {
    "text": "you the database case you might see it yeah but in this particular case no did",
    "start": "4019559",
    "end": "4025520"
  },
  {
    "text": "you have a com yeah put put version or something like",
    "start": "4025520",
    "end": "4033480"
  },
  {
    "text": "that yeah instead of the old EXA just put in",
    "start": "4039359",
    "end": "4046680"
  },
  {
    "text": "silly he he called UVA I'm not sure",
    "start": "4065520",
    "end": "4070760"
  },
  {
    "text": "if if it was",
    "start": "4070760",
    "end": "4075079"
  },
  {
    "text": "I think if you could write a query I'll take it out now I think you must substitute the",
    "start": "4079960",
    "end": "4085318"
  },
  {
    "text": "user if if you could write a query that returned a result and inserted the value",
    "start": "4087039",
    "end": "4092520"
  },
  {
    "text": "of something else into the into the name field then you would get a welcome and",
    "start": "4092520",
    "end": "4097798"
  },
  {
    "text": "whatever that that name is you could do that the what you can do here is limited by how well you know SQL and how well",
    "start": "4097799",
    "end": "4104080"
  },
  {
    "text": "you can understand that guy's database and how you understand it is by forcing",
    "start": "4104080",
    "end": "4109318"
  },
  {
    "text": "different kinds um yeah that might",
    "start": "4109319",
    "end": "4114960"
  },
  {
    "text": "work um as username let's sheld",
    "start": "4114960",
    "end": "4120679"
  },
  {
    "text": "username no I don't want to get into it much um what I want you guys to do is to run with PRACK 12 which is essentially",
    "start": "4120679",
    "end": "4129040"
  },
  {
    "text": "this everything you put in the what we",
    "start": "4134440",
    "end": "4142758"
  },
  {
    "text": "learn the",
    "start": "4148480",
    "end": "4151600"
  },
  {
    "text": "keyboard I",
    "start": "4164359",
    "end": "4168359"
  },
  {
    "text": "it's not working if you wanted to do a union",
    "start": "4222640",
    "end": "4228840"
  },
  {
    "text": "select yeah but if I um on this right on that and I should",
    "start": "4241840",
    "end": "4250840"
  },
  {
    "text": "BR a select star from users where username equals",
    "start": "4259440",
    "end": "4265560"
  },
  {
    "text": "test and password equals do or one",
    "start": "4265560",
    "end": "4273400"
  },
  {
    "text": "Union okay select",
    "start": "4275159",
    "end": "4280280"
  },
  {
    "text": "okay well let me take this off like example",
    "start": "4289040",
    "end": "4293600"
  },
  {
    "text": "let by username and password I think so",
    "start": "4321199",
    "end": "4327400"
  },
  {
    "text": "yeah let me try this instead of",
    "start": "4327400",
    "end": "4332080"
  },
  {
    "text": "411 doesn't return any results here right so get rid of",
    "start": "4339560",
    "end": "4346159"
  },
  {
    "text": "and version as name uh version as",
    "start": "4346159",
    "end": "4354080"
  },
  {
    "text": "username comma attive version as",
    "start": "4354080",
    "end": "4359760"
  },
  {
    "text": "password then need that ha there you",
    "start": "4359760",
    "end": "4368760"
  },
  {
    "text": "go nice so there I got SQL to pull its version and return it as one of the",
    "start": "4369480",
    "end": "4376520"
  },
  {
    "text": "fields do that so you see the I think",
    "start": "4376520",
    "end": "4381840"
  },
  {
    "text": "see but I mean look how this look how this query looks now it's gets pretty hairy pretty quickly and the whole time",
    "start": "4384239",
    "end": "4392000"
  },
  {
    "text": "what you have to do is you have to bear in mind what he's done all the way to the left of you so that you can keep the",
    "start": "4392000",
    "end": "4397480"
  },
  {
    "text": "query actually um actually working and uh it's",
    "start": "4397480",
    "end": "4402960"
  },
  {
    "text": "night I mean it's it's horrible it's hard but you see how I have to return",
    "start": "4402960",
    "end": "4409440"
  },
  {
    "text": "the value in there because there's only one field of output that's being displayed and that's usern name yeah so if I can force the value",
    "start": "4409440",
    "end": "4415840"
  },
  {
    "text": "into username then it'll work that version is actually aore",
    "start": "4415840",
    "end": "4422600"
  },
  {
    "text": "procedure yeah I understand but the the problem is um the application is only thing the",
    "start": "4423480",
    "end": "4430880"
  },
  {
    "text": "application is displaying of the query is the username so now I could do",
    "start": "4430880",
    "end": "4437360"
  },
  {
    "text": "this um I don't know if you could but you can",
    "start": "4437600",
    "end": "4442840"
  },
  {
    "text": "now say can you do a select exact no you",
    "start": "4442840",
    "end": "4449840"
  },
  {
    "text": "can't so select or an exact yeah what are you trying to do you want to get",
    "start": "4449840",
    "end": "4457239"
  },
  {
    "text": "directory yeah into the username can I say Union um exec as you do exec as",
    "start": "4457239",
    "end": "4467040"
  },
  {
    "text": "let's try",
    "start": "4472239",
    "end": "4477320"
  },
  {
    "text": "exac master. XP c d I don't know SQL well enough to do all this neat",
    "start": "4477639",
    "end": "4485679"
  },
  {
    "text": "stuff as user",
    "start": "4488880",
    "end": "4493638"
  },
  {
    "text": "see it doesn't like me putting exec in there",
    "start": "4520719",
    "end": "4525120"
  },
  {
    "text": "I don't suppose you can do",
    "start": "4536360",
    "end": "4539560"
  },
  {
    "text": "this use his",
    "start": "4545040",
    "end": "4548560"
  },
  {
    "text": "name so this other one was pretty",
    "start": "4552920",
    "end": "4556920"
  },
  {
    "text": "it's gone now it's all gone all gone access T",
    "start": "4559000",
    "end": "4564400"
  },
  {
    "text": "KN um basically just do what I did now tried",
    "start": "4571000",
    "end": "4577239"
  },
  {
    "text": "out the internet uh it might be down",
    "start": "4581440",
    "end": "4586920"
  },
  {
    "text": "that was cool I like that you can put",
    "start": "4592880",
    "end": "4597360"
  },
  {
    "text": "the I that connection okay also the not that",
    "start": "4604199",
    "end": "4610120"
  },
  {
    "text": "difficult",
    "start": "4610120",
    "end": "4613120"
  },
  {
    "text": "um go after the for just say x you know single mm",
    "start": "4618840",
    "end": "4625880"
  },
  {
    "text": "sorry just single the um you need select add that version",
    "start": "4625880",
    "end": "4634159"
  },
  {
    "text": "comma one",
    "start": "4634159",
    "end": "4638560"
  },
  {
    "text": "okay um uh what did you say connections H",
    "start": "4642199",
    "end": "4648520"
  },
  {
    "text": "version that's just a number of connections I don't know",
    "start": "4651600",
    "end": "4656440"
  },
  {
    "text": "that play with all the different atts you can do",
    "start": "4659719",
    "end": "4664678"
  },
  {
    "text": "ad ad",
    "start": "4665320",
    "end": "4670199"
  },
  {
    "text": "adap slow h",
    "start": "4671639",
    "end": "4676840"
  },
  {
    "text": "add",
    "start": "4677280",
    "end": "4679480"
  },
  {
    "text": "that for those of you been watching this you understand what the union does in this case basically takes the output of",
    "start": "4689080",
    "end": "4695120"
  },
  {
    "text": "one query and tags it onto the bottom of the output of another query so I'm Sally",
    "start": "4695120",
    "end": "4701120"
  },
  {
    "text": "saying yeah so I'm Sally saying um turn all the the rows from his query and tag",
    "start": "4701120",
    "end": "4707719"
  },
  {
    "text": "all the rows from my query on onto the end yeah and um and the trick is that",
    "start": "4707719",
    "end": "4714000"
  },
  {
    "text": "you have to have in a union select you have to have your query have to Output the same number of columns as his which",
    "start": "4714000",
    "end": "4721760"
  },
  {
    "text": "is why I I tag this extra one here so that I'm returning two",
    "start": "4721760",
    "end": "4727000"
  },
  {
    "text": "columns and again it's just it's just ugly stuff",
    "start": "4727000",
    "end": "4733400"
  },
  {
    "text": "so yeah and just to put this into context",
    "start": "4736760",
    "end": "4744000"
  },
  {
    "text": "what we're busy with now is vulnerability exploitation we discovered these vulnerabilities and now we're",
    "start": "4744000",
    "end": "4749199"
  },
  {
    "text": "playing with different ways that we can um we can abuse",
    "start": "4749199",
    "end": "4755840"
  },
  {
    "text": "them um and sorry just another comment uh regarding the web proxy you'll see there's two versions of the web proxy",
    "start": "4762560",
    "end": "4768520"
  },
  {
    "text": "installed um there's a 2.0 which is or 2.1 which is the newer one and a 1.2 I",
    "start": "4768520",
    "end": "4773639"
  },
  {
    "text": "think which is the one that I've got um 2.1 is better but the but the evaluation",
    "start": "4773639",
    "end": "4779719"
  },
  {
    "text": "version that you've got is functionally limited whereas the 1.2 one you can do more stuff so I actually should have",
    "start": "4779719",
    "end": "4786040"
  },
  {
    "text": "mentioned it previously but if I were you I'd actually rather go for the 1.2 so sorry about that I I just",
    "start": "4786040",
    "end": "4793239"
  },
  {
    "text": "remembered um but it's a quick uninstall reinstall kind of doiki you can maybe do it for",
    "start": "4793239",
    "end": "4799440"
  },
  {
    "text": "for this exercise you'll be okay um but but for later exercises you may rather want the 1.2 one which is fully",
    "start": "4799440",
    "end": "4807158"
  },
  {
    "text": "functional um for this exercise it's fine use",
    "start": "4808159",
    "end": "4813000"
  },
  {
    "text": "2.1 yeah yeah oh no you don't have to SP this",
    "start": "4814400",
    "end": "4820239"
  },
  {
    "text": "side oh um this case so I on top of the on top of the",
    "start": "4821000",
    "end": "4830080"
  },
  {
    "text": "pack you would just want us to put that one for now it's okay there's a",
    "start": "4830080",
    "end": "4836080"
  },
  {
    "text": "there's I'm sorry that came out really badly but yeah would SP it in fact",
    "start": "4836080",
    "end": "4843120"
  },
  {
    "text": "there's another feature I told you earlier that we have",
    "start": "4843120",
    "end": "4848440"
  },
  {
    "text": "what I called a semi-automated um fuzzer right um so what a fuzzer does is that basically",
    "start": "4848440",
    "end": "4854159"
  },
  {
    "text": "we're going to use to Brute Force to all the fields throw a whole lot of rubbish in there and see if we get anything that looks like an error back and those are",
    "start": "4854159",
    "end": "4861320"
  },
  {
    "text": "then the fields that we're going to investigate and it's important like I said because you just remember that a web application is really a whole set of",
    "start": "4861320",
    "end": "4868560"
  },
  {
    "text": "discrete applications right so they may have different coding standards and we need",
    "start": "4868560",
    "end": "4873600"
  },
  {
    "text": "to investigate every field on every form and you can be talking about hundreds and hundreds of fields complex",
    "start": "4873600",
    "end": "4879000"
  },
  {
    "text": "application so I want to try and automate it as best as I can what we do is we use the um at stake file light to",
    "start": "4879000",
    "end": "4884600"
  },
  {
    "text": "function this function over here and basically what farer does is it logs my session so I'll get in by hand and",
    "start": "4884600",
    "end": "4892679"
  },
  {
    "text": "I'll surf through the entire site by hand um just throwing in as much data as I can into every possible form I'll",
    "start": "4892679",
    "end": "4899400"
  },
  {
    "text": "throw the data in and this thing's going to log it log it log log it log it and I'm done um I submit that log to our mli",
    "start": "4899400",
    "end": "4906400"
  },
  {
    "text": "X tool and Milli X is then going to run through the log and say okay these are all the fields and then run its fuzzer",
    "start": "4906400",
    "end": "4911560"
  },
  {
    "text": "against those fields and show you where it found stuff that's interesting that why who can tell me why do I take a",
    "start": "4911560",
    "end": "4917280"
  },
  {
    "text": "semi-auto automated approach as opposed to a completely automated",
    "start": "4917280",
    "end": "4922840"
  },
  {
    "text": "approach um yeah so I can kind of tell what's going on but because um where applications usually have a logical flow",
    "start": "4926360",
    "end": "4932880"
  },
  {
    "text": "that a fully automated tool isn't able to figure out right the fully automated tool is",
    "start": "4932880",
    "end": "4937960"
  },
  {
    "text": "just going to see a field and just throw everything into it so the field asks you um please enter uh please",
    "start": "4937960",
    "end": "4946080"
  },
  {
    "text": "enter your username and password so it goes like five and x and then the thing",
    "start": "4946080",
    "end": "4953000"
  },
  {
    "text": "says please enter your username and password so it goes C and four and it just keeps throwing it username and password and actually what you need to",
    "start": "4953000",
    "end": "4959400"
  },
  {
    "text": "do is you need to get a valid username password and log in so you can see the rest of the application um and so fully automated tools that try and Traverse or",
    "start": "4959400",
    "end": "4966239"
  },
  {
    "text": "spider the application very seldom work because um they're not able to understand the flow of the application",
    "start": "4966239",
    "end": "4971719"
  },
  {
    "text": "I'm talking sense yeah I been basically the whole problem is the login thing or something form based or Bas you know",
    "start": "4971719",
    "end": "4978440"
  },
  {
    "text": "basic indication something so you need to tell the application to log in first and then only start browsing otherwise",
    "start": "4978440",
    "end": "4984360"
  },
  {
    "text": "it just takes the first page where you get the prompt and it's like there's no problem just B out or it logs in if",
    "start": "4984360",
    "end": "4992159"
  },
  {
    "text": "you're giv it some of the tools where you can tell it to log in give it the username it logs in the second page of",
    "start": "4992159",
    "end": "4997679"
  },
  {
    "text": "this is the log out p l out again now tries to do the r says okay well there's no problem check the pag",
    "start": "4997679",
    "end": "5006159"
  },
  {
    "text": "that's that's why this sort of thing to date is really an automated way to check for it your scanners can't do it CU they",
    "start": "5006159",
    "end": "5012639"
  },
  {
    "text": "they can't understand the nature of the application um and of course so far",
    "start": "5012639",
    "end": "5017960"
  },
  {
    "text": "we're really looking at very simple technical errors um but sometimes the errors that we deal with are much more",
    "start": "5017960",
    "end": "5023360"
  },
  {
    "text": "complex logical errors so to do with how the application thinks rather than",
    "start": "5023360",
    "end": "5030880"
  },
  {
    "text": "yeah oh the one that",
    "start": "5045199",
    "end": "5050280"
  },
  {
    "text": "you",
    "start": "5052800",
    "end": "5055800"
  },
  {
    "text": "up",
    "start": "5063320",
    "end": "5066320"
  },
  {
    "text": "e",
    "start": "5093320",
    "end": "5096320"
  },
  {
    "text": "I",
    "start": "5123320",
    "end": "5126320"
  },
  {
    "text": "I",
    "start": "5153239",
    "end": "5156239"
  },
  {
    "text": "e",
    "start": "5183239",
    "end": "5186239"
  },
  {
    "text": "I",
    "start": "5213239",
    "end": "5216239"
  },
  {
    "text": "I",
    "start": "5243119",
    "end": "5246119"
  },
  {
    "text": "I",
    "start": "5273119",
    "end": "5276119"
  },
  {
    "text": "I",
    "start": "5303119",
    "end": "5306119"
  },
  {
    "text": "I",
    "start": "5333040",
    "end": "5336040"
  },
  {
    "text": "I",
    "start": "5363040",
    "end": "5366040"
  },
  {
    "text": "I",
    "start": "5393040",
    "end": "5396040"
  },
  {
    "text": "I",
    "start": "5422960",
    "end": "5425960"
  },
  {
    "text": "I",
    "start": "5452920",
    "end": "5455920"
  },
  {
    "text": "I",
    "start": "5482920",
    "end": "5485920"
  },
  {
    "text": "I",
    "start": "5512840",
    "end": "5515840"
  },
  {
    "text": "I I",
    "start": "5542840",
    "end": "5546880"
  }
]