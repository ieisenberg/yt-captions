[
  {
    "text": "good afternoon everybody and welcome to the 3:30 talk in the market share track this is Windows 7 internals and",
    "start": "80",
    "end": "8120"
  },
  {
    "text": "exploitability a couple uh reminders before we get started please silence your cell phones and then in your",
    "start": "8120",
    "end": "13960"
  },
  {
    "text": "package you should have gotten speaker feedback forms please take some time after the talk fill them out and turn",
    "start": "13960",
    "end": "19119"
  },
  {
    "text": "them in at the information booth it'd be very appreciated and with that H",
    "start": "19119",
    "end": "24759"
  },
  {
    "text": "Sasa hi oh now I'm going to talk about Windows Phone 7 of system and its",
    "start": "26199",
    "end": "34640"
  },
  {
    "text": "security I personally see it's this is a bit out of date sh me",
    "start": "34640",
    "end": "40800"
  },
  {
    "text": "anyway here's the agenda uh the main topic is Windows Phone 7 Operating",
    "start": "40800",
    "end": "48800"
  },
  {
    "text": "System I describe internals uh of this OS in overview and also describe",
    "start": "48800",
    "end": "57320"
  },
  {
    "text": "possibilities of exploitation I have used some tools and techniques to",
    "start": "57320",
    "end": "64198"
  },
  {
    "text": "analyze the system and I will talk also talk about RSE engineering of Windows",
    "start": "64199",
    "end": "70280"
  },
  {
    "text": "Phone 7 so let's get started first I need to talk about Windows Phone 7",
    "start": "70280",
    "end": "78960"
  },
  {
    "text": "overview Windows Phone 7 in the operating system develop by Microsoft",
    "start": "80400",
    "end": "87960"
  },
  {
    "text": "this operating system is B based on Windows C6 and it looks some special",
    "start": "87960",
    "end": "95000"
  },
  {
    "text": "components uh ported from Windows evident compact",
    "start": "95000",
    "end": "100119"
  },
  {
    "text": "7 the one of the features of Windows Phone 7 is strong",
    "start": "100119",
    "end": "106000"
  },
  {
    "text": "security applications are sandboxes in order to protect system and",
    "start": "106000",
    "end": "112479"
  },
  {
    "text": "user together and each applications are separated using capabilities and",
    "start": "112479",
    "end": "119920"
  },
  {
    "text": "Chambers which makes uh accessing on authorized resources nearly",
    "start": "119920",
    "end": "128160"
  },
  {
    "text": "impossible more interestingly uh normal Windows Phone 7 applications are not",
    "start": "128160",
    "end": "134040"
  },
  {
    "text": "authorized to use native code only net code is allowed well",
    "start": "134040",
    "end": "142400"
  },
  {
    "text": "native code could be exploitable so uh this is the format of",
    "start": "142400",
    "end": "149319"
  },
  {
    "text": "Windows Form application package it's very similar to Sil light one in fact",
    "start": "149319",
    "end": "155560"
  },
  {
    "text": "Windows Phone package is a silik package with a few extension the main difference is WM app",
    "start": "155560",
    "end": "164560"
  },
  {
    "text": "manifest.xml it's similar to Android Android",
    "start": "164560",
    "end": "170720"
  },
  {
    "text": "manifest.xml and declares app metadata such as ID and version information and",
    "start": "170720",
    "end": "178760"
  },
  {
    "text": "capability information I describe later this is the end for noral",
    "start": "178760",
    "end": "185680"
  },
  {
    "text": "applications but some preves applications have native code which is",
    "start": "185680",
    "end": "192239"
  },
  {
    "text": "it interestingly those application packages have native code DL and that be inter",
    "start": "192239",
    "end": "200080"
  },
  {
    "text": "manifest.xml which indicates existence of native",
    "start": "200080",
    "end": "206319"
  },
  {
    "text": "code well let's look at the security Windows pH 7 manifest degre capabilities",
    "start": "207720",
    "end": "215319"
  },
  {
    "text": "which determines resources to be authorized to use this is similar to",
    "start": "215319",
    "end": "220760"
  },
  {
    "text": "Android's permission system there are many capabilities indicating device",
    "start": "220760",
    "end": "226040"
  },
  {
    "text": "features such camera microphone sensors or and user or",
    "start": "226040",
    "end": "234760"
  },
  {
    "text": "device identification and uh more interestingly use special components",
    "start": "234760",
    "end": "241239"
  },
  {
    "text": "such as web browser so let's look at the windows for",
    "start": "241239",
    "end": "246920"
  },
  {
    "text": "Marketplace website this is the description page for Facebook app in",
    "start": "246920",
    "end": "253439"
  },
  {
    "text": "this page uh you will see app we use uh location services data services blah",
    "start": "253439",
    "end": "259639"
  },
  {
    "text": "blah blah this indicates uh and notifies what resources the app uses just like",
    "start": "259639",
    "end": "267199"
  },
  {
    "text": "Android one thing I'm a bit Waring is there's no confirmation like Android",
    "start": "267199",
    "end": "274039"
  },
  {
    "text": "what uh when you install the application instead uh Windows phone",
    "start": "274039",
    "end": "281240"
  },
  {
    "text": "application uh completely separated and unlike Android uh",
    "start": "281240",
    "end": "290880"
  },
  {
    "text": "there uh uh resources are managed by",
    "start": "292520",
    "end": "297560"
  },
  {
    "text": "capabilities very strictly",
    "start": "297560",
    "end": "301639"
  },
  {
    "text": "there's more most of capabilities are documented and authorized to use by",
    "start": "303160",
    "end": "309840"
  },
  {
    "text": "normal developers however there are some undocumented capabilities which enable",
    "start": "309840",
    "end": "316840"
  },
  {
    "text": "higher privileges for instance idap inter Services permits access to third party",
    "start": "316840",
    "end": "326080"
  },
  {
    "text": "services this is very interesting so I will talk about this later anyway",
    "start": "326080",
    "end": "333080"
  },
  {
    "text": "let's move on for now Chambers uh these features isolates",
    "start": "333080",
    "end": "340120"
  },
  {
    "text": "applications drivers by uh separate Chambers and separate policies the most important",
    "start": "340120",
    "end": "347800"
  },
  {
    "text": "part of this security policy and security model is the TCB stands for",
    "start": "347800",
    "end": "353680"
  },
  {
    "text": "trusted Computing base which uh Cano and some drivers recite",
    "start": "353680",
    "end": "360319"
  },
  {
    "text": "noral applications are isolated our LPC least previous chamber which has very",
    "start": "360319",
    "end": "367599"
  },
  {
    "text": "low Privileges and pure chamber model is good for security but not so flexible so",
    "start": "367599",
    "end": "375599"
  },
  {
    "text": "Windows Phone 7 uh gives additional permissions declar by capabilities this",
    "start": "375599",
    "end": "381680"
  },
  {
    "text": "will secure the device and keep application model",
    "start": "381680",
    "end": "387680"
  },
  {
    "text": "flexible in conr these security features looks modern secure welld designed it looks great so",
    "start": "388000",
    "end": "396840"
  },
  {
    "text": "only thing we need is to know how how good they are we need to analyze the",
    "start": "396840",
    "end": "403800"
  },
  {
    "text": "system if we want to know how good they",
    "start": "403800",
    "end": "409000"
  },
  {
    "text": "are so I will talk about the system I mean lowerer",
    "start": "410160",
    "end": "417479"
  },
  {
    "text": "implementation most of modern operating systems including Windows Phone 7 have",
    "start": "417919",
    "end": "423800"
  },
  {
    "text": "features for expor medication which makes a code uh which prevents AR code",
    "start": "423800",
    "end": "432240"
  },
  {
    "text": "execution I have started to analyze the system from this low layer",
    "start": "432240",
    "end": "438599"
  },
  {
    "text": "implementation here so I have to describe how I analyze",
    "start": "438599",
    "end": "444720"
  },
  {
    "text": "the system well I used unlocked Windows one device mainly",
    "start": "444720",
    "end": "451280"
  },
  {
    "text": "I use HTC 7 m and I used undented",
    "start": "451280",
    "end": "456960"
  },
  {
    "text": "features to learn native gold so I made custom DRL to analyze the system",
    "start": "456960",
    "end": "465159"
  },
  {
    "text": "interestingly native DRL for Windows bone 7 can be created using SDK for",
    "start": "465159",
    "end": "470840"
  },
  {
    "text": "Windows mobile 6 and of course I used reverse engineering techniques I will",
    "start": "470840",
    "end": "477680"
  },
  {
    "text": "talk about reverse engineering later it's",
    "start": "477680",
    "end": "483240"
  },
  {
    "text": "fun so let's get started from process memory so uh the layer looks very",
    "start": "485400",
    "end": "492360"
  },
  {
    "text": "similar to Windows C6 uh there's one GB of user VM H instead of 2 GB of normal",
    "start": "492360",
    "end": "501520"
  },
  {
    "text": "Windows NT and share the LL and m f",
    "start": "501520",
    "end": "506680"
  },
  {
    "text": "areas are located on higher memory areas unlike Windows C 4.2 which",
    "start": "506680",
    "end": "514640"
  },
  {
    "text": "is used by Windows M 6 all processes are properly separated just like Windows and",
    "start": "514640",
    "end": "521839"
  },
  {
    "text": "D this is pretty good so I use native code to uh generate memory M and it",
    "start": "521839",
    "end": "530000"
  },
  {
    "text": "seems DP dat data execution prevention is working quite",
    "start": "530000",
    "end": "537279"
  },
  {
    "text": "well well I however discovered about an application issue well I will talk about",
    "start": "537279",
    "end": "544880"
  },
  {
    "text": "this in exploitation part there's one more uh memory based uh",
    "start": "544880",
    "end": "552440"
  },
  {
    "text": "explo medication feature this feature randomizes memory",
    "start": "552440",
    "end": "558120"
  },
  {
    "text": "addresses used in the program and makes predicting specific code addresses and",
    "start": "558120",
    "end": "564360"
  },
  {
    "text": "exploiting them much much harder looking at the layout the most of",
    "start": "564360",
    "end": "570640"
  },
  {
    "text": "the layout areas are randomized so let's see some",
    "start": "570640",
    "end": "576959"
  },
  {
    "text": "details stack uh executable image Heap",
    "start": "576959",
    "end": "582959"
  },
  {
    "text": "virtual memory addresses uh all randomiz every time you launch the uh application",
    "start": "582959",
    "end": "590000"
  },
  {
    "text": "very good uh share DLS which include common",
    "start": "590000",
    "end": "596320"
  },
  {
    "text": "native DLS and memory M file area which",
    "start": "596320",
    "end": "601480"
  },
  {
    "text": "include uh common net assemblies are also randomized there are randomized",
    "start": "601480",
    "end": "608720"
  },
  {
    "text": "every time you boot the device this is not ideal but it's not uh it's",
    "start": "608720",
    "end": "615519"
  },
  {
    "text": "enough and there's more normally operting systems for arm",
    "start": "615519",
    "end": "623640"
  },
  {
    "text": "architectures uh uses swi instruction to make system calls however Windows Phone",
    "start": "623640",
    "end": "630000"
  },
  {
    "text": "7 uses completely different way to make system go in this operating system the",
    "start": "630000",
    "end": "637320"
  },
  {
    "text": "PSL calls the program makes PSL calls by",
    "start": "637320",
    "end": "643320"
  },
  {
    "text": "making a branch to specific address say these addresses are called trap",
    "start": "643320",
    "end": "650279"
  },
  {
    "text": "addresses and making branch to them we cause trap I mean",
    "start": "650279",
    "end": "657319"
  },
  {
    "text": "exception if if the exception H catches the PSL call it reli to the PSL H",
    "start": "658000",
    "end": "667880"
  },
  {
    "text": "and uh which could be a cner mode function or it could be a user mode",
    "start": "667880",
    "end": "675040"
  },
  {
    "text": "CB and the thing is uh predicting trap",
    "start": "675920",
    "end": "681279"
  },
  {
    "text": "addresses will make exploitation much easier fortunately Microsoft had done",
    "start": "681279",
    "end": "687639"
  },
  {
    "text": "well in Windows Phone 7 and latest versions",
    "start": "687639",
    "end": "693040"
  },
  {
    "text": "of Windows C the actual trap addresses are randomized by PSL trap seed which is",
    "start": "693040",
    "end": "700360"
  },
  {
    "text": "a part of counter shared memory called user K data similar to Windows uh shared",
    "start": "700360",
    "end": "706240"
  },
  {
    "text": "user data this makes exploitation and running system Gos in Windows one much",
    "start": "706240",
    "end": "714560"
  },
  {
    "text": "harder let's see the dis assembly uh this is the establish in COD eror and",
    "start": "714560",
    "end": "722320"
  },
  {
    "text": "making system go of M view of file in",
    "start": "722320",
    "end": "727800"
  },
  {
    "text": "process",
    "start": "727800",
    "end": "730800"
  },
  {
    "text": "uh okay okay ZX uh f11 FF o is uh base",
    "start": "741320",
    "end": "748800"
  },
  {
    "text": "trap address of VI file but this is not used directly",
    "start": "748800",
    "end": "759160"
  },
  {
    "text": "uh you see uh PSL trap seed is loaded",
    "start": "759160",
    "end": "768000"
  },
  {
    "text": "here and the trap addresses address is",
    "start": "768000",
    "end": "774040"
  },
  {
    "text": "randomized I mean exort using uh PSL trap seed and then made",
    "start": "774040",
    "end": "781600"
  },
  {
    "text": "Branch here pretty cool so in conclusion I discovered",
    "start": "781600",
    "end": "789839"
  },
  {
    "text": "almost all process memory areas are randomized this is pretty good however I",
    "start": "789839",
    "end": "795839"
  },
  {
    "text": "have also discovered something warning to me it's their uh allocation pattern",
    "start": "795839",
    "end": "802279"
  },
  {
    "text": "for instance uh Linux and map system codes makes LOM capap between two",
    "start": "802279",
    "end": "809560"
  },
  {
    "text": "allocations which significantly increases the strength",
    "start": "809560",
    "end": "815120"
  },
  {
    "text": "oflr however Windows Phone 7's implementation doesn't do so so it makes",
    "start": "815120",
    "end": "821480"
  },
  {
    "text": "Heap spray or similar techniques much easier and more reliable that's",
    "start": "821480",
    "end": "829199"
  },
  {
    "text": "woring but there's more security system applications uh sandbox and it seem hard",
    "start": "829320",
    "end": "836880"
  },
  {
    "text": "to take over the system this security uh feature is related to",
    "start": "836880",
    "end": "843759"
  },
  {
    "text": "two or three components the main components uh policy engine uh the and",
    "start": "843759",
    "end": "850360"
  },
  {
    "text": "security L all resource accesses are enforced by",
    "start": "850360",
    "end": "858320"
  },
  {
    "text": "the policy engine uh policy engine. DRL also this engine isolates applications",
    "start": "858320",
    "end": "864880"
  },
  {
    "text": "and deny and authorized accesses actual policy data is contained in the",
    "start": "864880",
    "end": "872279"
  },
  {
    "text": "policy database in specific location but we can see the policy data by viewing",
    "start": "872279",
    "end": "878079"
  },
  {
    "text": "policy XML file which is located in / Windows SLB policy. XML so let's see",
    "start": "878079",
    "end": "887440"
  },
  {
    "text": "this B",
    "start": "887440",
    "end": "894800"
  },
  {
    "text": "well okay",
    "start": "894800",
    "end": "898800"
  },
  {
    "text": "okay okay that's and this is a base policy. XML extracted from the device",
    "start": "904959",
    "end": "914560"
  },
  {
    "text": "uh it's quite readable by human and more",
    "start": "914560",
    "end": "920079"
  },
  {
    "text": "interestingly uh there are many many comments to",
    "start": "920079",
    "end": "925639"
  },
  {
    "text": "describe how policy does and it makes",
    "start": "925639",
    "end": "931920"
  },
  {
    "text": "understanding the policy much easier well looking at the policy I can",
    "start": "931920",
    "end": "937279"
  },
  {
    "text": "not find any critical design for this policy confirms the principle",
    "start": "937279",
    "end": "943120"
  },
  {
    "text": "of uh least prev and exploiting system seems difficult for",
    "start": "943120",
    "end": "951720"
  },
  {
    "text": "now oh",
    "start": "953720",
    "end": "957720"
  },
  {
    "text": "so let's move on there's one more the security loer uh verifies executables",
    "start": "965040",
    "end": "970880"
  },
  {
    "text": "and modules to before you run the applications and load the module this",
    "start": "970880",
    "end": "977360"
  },
  {
    "text": "security loader LV mode only allows modules contained in the L and modules",
    "start": "977360",
    "end": "983800"
  },
  {
    "text": "signed by Microsoft uh for instance all windows for Marketplace files are assigned by",
    "start": "983800",
    "end": "991360"
  },
  {
    "text": "Microsoft this is how Windows 4 Marketplace files Works actually",
    "start": "991360",
    "end": "998319"
  },
  {
    "text": "works this is good for security but not good for application developers so",
    "start": "998319",
    "end": "1003360"
  },
  {
    "text": "there's also a feature called developer unlock this feature authorizes uh",
    "start": "1003360",
    "end": "1009800"
  },
  {
    "text": "limited number of unsigned applications running according to specific regist",
    "start": "1009800",
    "end": "1016360"
  },
  {
    "text": "value well this security R looks similar to Apple's IOS but unlike that there's",
    "start": "1016360",
    "end": "1025959"
  },
  {
    "text": "no signatures are required for memory pages in other words executable memory",
    "start": "1025959",
    "end": "1033199"
  },
  {
    "text": "areas are simply executable not need to be signed by",
    "start": "1033199",
    "end": "1040160"
  },
  {
    "text": "Apple or something in conclusion I can say uh",
    "start": "1040160",
    "end": "1047280"
  },
  {
    "text": "this design seems uh good there are some issues actually",
    "start": "1047280",
    "end": "1053960"
  },
  {
    "text": "but it looks not critical for",
    "start": "1053960",
    "end": "1058240"
  },
  {
    "text": "now so let's move on to the next one reverse engineering it's fun okay",
    "start": "1062039",
    "end": "1069840"
  },
  {
    "text": "yeah unfortunately uh Windows Form 7 details are undented and it seem Black",
    "start": "1069840",
    "end": "1077640"
  },
  {
    "text": "Box blackbox but not actually it's not it's not BR",
    "start": "1077640",
    "end": "1083679"
  },
  {
    "text": "box and we can use reverse engineering technique for Windows C also it seems",
    "start": "1083679",
    "end": "1090760"
  },
  {
    "text": "you can reverse Windows 1 7 even you don't own",
    "start": "1090760",
    "end": "1096720"
  },
  {
    "text": "the device actually of course there are some obses",
    "start": "1096720",
    "end": "1103440"
  },
  {
    "text": "for re engineering but they can be created easily so I have made simple",
    "start": "1103440",
    "end": "1109600"
  },
  {
    "text": "corlection of python s name W7 helped to to make analysis easier uh I have missed",
    "start": "1109600",
    "end": "1118400"
  },
  {
    "text": "the tools to uh in conference CD but it will be available in black hat uh",
    "start": "1118400",
    "end": "1126400"
  },
  {
    "text": "archive space and most of all RSE engineering of",
    "start": "1126400",
    "end": "1132000"
  },
  {
    "text": "this oping system is not so difficult so let's do it",
    "start": "1132000",
    "end": "1139399"
  },
  {
    "text": "the first step to reverse engineering is ret retrieving files if you need to",
    "start": "1140520",
    "end": "1147760"
  },
  {
    "text": "analyze all system you will need OS image fortunately some oems like HC made",
    "start": "1147760",
    "end": "1155679"
  },
  {
    "text": "recovery image available also uh their webbased updat",
    "start": "1155679",
    "end": "1162760"
  },
  {
    "text": "files can be used these updated files are available for download from Microsoft website and can be extracted",
    "start": "1162760",
    "end": "1170080"
  },
  {
    "text": "as a cap archive however they are not ordinal P files and it will not correctly analyzed",
    "start": "1170080",
    "end": "1178159"
  },
  {
    "text": "in IO so we have to convert it and fix it before using I",
    "start": "1178159",
    "end": "1186600"
  },
  {
    "text": "Pro so uh oos image if you have oos image you can use exit damp or similar",
    "start": "1186600",
    "end": "1194559"
  },
  {
    "text": "uh R extraction tools available from XA devop website these tools will extract all the",
    "start": "1194559",
    "end": "1202200"
  },
  {
    "text": "files contained in the image but this is not the end the dump generated by uh XI",
    "start": "1202200",
    "end": "1210280"
  },
  {
    "text": "dump or similar tools has special format this is because Windows C Al contains P",
    "start": "1210280",
    "end": "1217280"
  },
  {
    "text": "files in specific format xib not PE so I",
    "start": "1217280",
    "end": "1223080"
  },
  {
    "text": "made simple script - x.p to convert IP",
    "start": "1223080",
    "end": "1229039"
  },
  {
    "text": "to PE from",
    "start": "1229039",
    "end": "1233880"
  },
  {
    "text": "yeah if you have web based updated files you can extract the file twice this is",
    "start": "1237120",
    "end": "1244320"
  },
  {
    "text": "because the cap file contains one or more package files which uh actually C",
    "start": "1244320",
    "end": "1251360"
  },
  {
    "text": "archives I we show you",
    "start": "1251360",
    "end": "1255880"
  },
  {
    "text": "so I already unpacked uh the actual updated C file",
    "start": "1262440",
    "end": "1270000"
  },
  {
    "text": "and there are many many many uh package file PK exchange",
    "start": "1270000",
    "end": "1277320"
  },
  {
    "text": "PKG but it's actually a cap archive so you can uh",
    "start": "1277320",
    "end": "1284320"
  },
  {
    "text": "extract easily so uh let's look at the folder here well",
    "start": "1284320",
    "end": "1293240"
  },
  {
    "text": "it contains P file actually but uh this is not enough",
    "start": "1293240",
    "end": "1302760"
  },
  {
    "text": "because these P files are not aligned properly and some part of headers are",
    "start": "1302760",
    "end": "1308240"
  },
  {
    "text": "corrupted so we have to fix the file using aa- updated.",
    "start": "1308240",
    "end": "1315000"
  },
  {
    "text": "py and this two re Reigns and fixes the B file to make RDA Pro",
    "start": "1315000",
    "end": "1322679"
  },
  {
    "text": "analyze the file",
    "start": "1322679",
    "end": "1325720"
  },
  {
    "text": "correctly talking of correctness we need to care about version of IDE Pro because",
    "start": "1330240",
    "end": "1336480"
  },
  {
    "text": "earlier version of IDE Pro had an analysis issue and the Windows Phone 7",
    "start": "1336480",
    "end": "1342159"
  },
  {
    "text": "modules well looking at the this sumary it's very clear the function and in the",
    "start": "1342159",
    "end": "1349559"
  },
  {
    "text": "fun uh first instruction this is not supposed to",
    "start": "1349559",
    "end": "1354919"
  },
  {
    "text": "happen it's not good I discovered why uh idea Pro did",
    "start": "1354919",
    "end": "1364320"
  },
  {
    "text": "not correctly handle function table more specifically the LSB or begin address of",
    "start": "1364320",
    "end": "1372200"
  },
  {
    "text": "the function so I added an option to load avoid this issue and it will make",
    "start": "1372200",
    "end": "1379760"
  },
  {
    "text": "analysis much better I also reported this issue to hex at and it's fixed in",
    "start": "1379760",
    "end": "1387679"
  },
  {
    "text": "ide Pro 6.3 Effects by fixing the files it's",
    "start": "1387679",
    "end": "1396279"
  },
  {
    "text": "very clear before you use the specific option you will see the red areas which",
    "start": "1396279",
    "end": "1402960"
  },
  {
    "text": "indicates code but not function but after you fix the files you",
    "start": "1402960",
    "end": "1409240"
  },
  {
    "text": "will see almost everything blue the code and uh code is in the function it makes",
    "start": "1409240",
    "end": "1417720"
  },
  {
    "text": "analysis uh almost correct there's",
    "start": "1417720",
    "end": "1423240"
  },
  {
    "text": "more you will use uh symbol F to analyze windows and key so how about symbols in",
    "start": "1423240",
    "end": "1432080"
  },
  {
    "text": "Windows one well I found de uh de",
    "start": "1432080",
    "end": "1438039"
  },
  {
    "text": "directory in here and interestingly simple you can",
    "start": "1438039",
    "end": "1444000"
  },
  {
    "text": "actually retrieve uh pdb files from welln Microsoft symbol pass that be7",
    "start": "1444000",
    "end": "1451720"
  },
  {
    "text": "help to have an option to fix deok directory to and load pdb file that's",
    "start": "1451720",
    "end": "1459960"
  },
  {
    "text": "all and there's one more thing to note about uh if you Lo the pdb file before",
    "start": "1459960",
    "end": "1466799"
  },
  {
    "text": "you analyze the file idea Pro won't analyze the file correctly and this is",
    "start": "1466799",
    "end": "1473320"
  },
  {
    "text": "an issue too so there's the tip we need to analyze the file then uh they load",
    "start": "1473320",
    "end": "1481559"
  },
  {
    "text": "the PDP file still loading pdpb files May",
    "start": "1481559",
    "end": "1486960"
  },
  {
    "text": "corrupt the analysis so I use Simple Ida person python to automate fix process",
    "start": "1486960",
    "end": "1494200"
  },
  {
    "text": "well let's see this in the demo",
    "start": "1494200",
    "end": "1499559"
  },
  {
    "text": "so I will start analyzing uh Pacman C.D uh which is a uh part of package",
    "start": "1508760",
    "end": "1517000"
  },
  {
    "text": "Manager in Windows phone",
    "start": "1517000",
    "end": "1522440"
  },
  {
    "text": "sorry oh that's",
    "start": "1522440",
    "end": "1527919"
  },
  {
    "text": "Okay Pacman cry. so let's start",
    "start": "1544600",
    "end": "1550559"
  },
  {
    "text": "analysis first uh choose the processor type",
    "start": "1551159",
    "end": "1556799"
  },
  {
    "text": "arm and uh edit architecture options to select um V7 A and",
    "start": "1556799",
    "end": "1565440"
  },
  {
    "text": "R okay that works so IDE Pro asks uh input",
    "start": "1565440",
    "end": "1574080"
  },
  {
    "text": "files has symbol and well this is quite",
    "start": "1574080",
    "end": "1580679"
  },
  {
    "text": "interesting but answer this no because uh this may corrup the analysis",
    "start": "1580679",
    "end": "1588520"
  },
  {
    "text": "no",
    "start": "1588520",
    "end": "1590919"
  },
  {
    "text": "here okay analyze so I enter a simple",
    "start": "1597559",
    "end": "1603399"
  },
  {
    "text": "idea person here to uh collect all sbase",
    "start": "1603399",
    "end": "1610480"
  },
  {
    "text": "function for",
    "start": "1617240",
    "end": "1621240"
  },
  {
    "text": "done so uh I have recorded the all s function to prevent uh corrupted",
    "start": "1650320",
    "end": "1659880"
  },
  {
    "text": "analysis then uh you can choose options here and disable all uh",
    "start": "1659880",
    "end": "1668200"
  },
  {
    "text": "automated analysis temporary then",
    "start": "1668200",
    "end": "1673760"
  },
  {
    "text": "uh load the pdb file well this",
    "start": "1673760",
    "end": "1680159"
  },
  {
    "text": "makes yeah analysis has just collapsed so let's fix this",
    "start": "1680159",
    "end": "1690480"
  },
  {
    "text": "okay okay let fix so I have fixed the uh actual function",
    "start": "1709399",
    "end": "1718039"
  },
  {
    "text": "so I can reenable the analysis and reanalyze the",
    "start": "1718039",
    "end": "1725200"
  },
  {
    "text": "program perfect well as you can see uh",
    "start": "1725200",
    "end": "1730720"
  },
  {
    "text": "there's many many symbols available",
    "start": "1730720",
    "end": "1736480"
  },
  {
    "text": "here as you can see oh pman c implemented in",
    "start": "1736480",
    "end": "1745519"
  },
  {
    "text": "C++ pretty good",
    "start": "1745519",
    "end": "1750480"
  },
  {
    "text": "well that's all as I show reos engineering of Windows 7",
    "start": "1751760",
    "end": "1759159"
  },
  {
    "text": "is not not so difficult you could analyze everything in operating system",
    "start": "1759159",
    "end": "1765799"
  },
  {
    "text": "thanks",
    "start": "1765799",
    "end": "1768799"
  },
  {
    "text": "so this is the end of reverse engineering part and now the exploitation",
    "start": "1771760",
    "end": "1778919"
  },
  {
    "text": "part so native components have been always targeted for a code execution and",
    "start": "1779679",
    "end": "1787440"
  },
  {
    "text": "we need to know what is exploitable there are several possibilities one",
    "start": "1787440",
    "end": "1793640"
  },
  {
    "text": "Microsoft component such as net core library and Internet",
    "start": "1793640",
    "end": "1799159"
  },
  {
    "text": "Explorer two third party components uh which include OEM drivers three native",
    "start": "1799159",
    "end": "1807640"
  },
  {
    "text": "code in third party application",
    "start": "1807640",
    "end": "1814039"
  },
  {
    "text": "well here's some observations one of them was memory in net that was",
    "start": "1814039",
    "end": "1822399"
  },
  {
    "text": "disappointing I found uh strings uh generated and dynamically all strings",
    "start": "1822399",
    "end": "1829120"
  },
  {
    "text": "are located in the user VM which access is r w and X in other words Dynamic",
    "start": "1829120",
    "end": "1839760"
  },
  {
    "text": "strings are executable it could lead to uh string technique if there are other",
    "start": "1839760",
    "end": "1848880"
  },
  {
    "text": "uh V here and if the attacker can spray",
    "start": "1848880",
    "end": "1855240"
  },
  {
    "text": "executable code AS uni code strings and control PC program counter using uh",
    "start": "1855240",
    "end": "1862000"
  },
  {
    "text": "Native vulnerability it's possible to execute Dynamic Str inside the",
    "start": "1862000",
    "end": "1868720"
  },
  {
    "text": "process the exploitation uh attacking native components using n uh net might be",
    "start": "1868720",
    "end": "1879080"
  },
  {
    "text": "possible the next one is native cod in third party applications unfortunately",
    "start": "1879760",
    "end": "1886720"
  },
  {
    "text": "or fortunately uh there's very few apps using native code according to Japanese",
    "start": "1886720",
    "end": "1893559"
  },
  {
    "text": "website there were 48 applications using native code most of them were uh used by",
    "start": "1893559",
    "end": "1900960"
  },
  {
    "text": "oems or carriers but there are some nem",
    "start": "1900960",
    "end": "1907240"
  },
  {
    "text": "uh non OEM applications which include Ador and Tangle video calls so I wonder",
    "start": "1907240",
    "end": "1915039"
  },
  {
    "text": "is native code vulnerable let's move on",
    "start": "1915039",
    "end": "1919840"
  },
  {
    "text": "in order to find such vulnerabilities uh there are several ways like static analysis using Ida Pro",
    "start": "1921320",
    "end": "1930320"
  },
  {
    "text": "or using fing I completely agree with this and I have planned to do so uh",
    "start": "1930320",
    "end": "1937600"
  },
  {
    "text": "until I find [Music] this well you see that uh this is the",
    "start": "1937600",
    "end": "1947919"
  },
  {
    "text": "strings window of IG Pro and it's the string says INF",
    "start": "1947919",
    "end": "1956919"
  },
  {
    "text": "1.2.1 copyright 1995-2003 Mark address well it's the",
    "start": "1956919",
    "end": "1965799"
  },
  {
    "text": "signature of old and rable Z",
    "start": "1965799",
    "end": "1971480"
  },
  {
    "text": "well unfortunately I cannot discr uh the what application had but I",
    "start": "1971480",
    "end": "1978039"
  },
  {
    "text": "can I think I can describe this vulnerability because it's existing",
    "start": "1978039",
    "end": "1985039"
  },
  {
    "text": "one sorry uh this formability is number CBE",
    "start": "1987559",
    "end": "1994320"
  },
  {
    "text": "2005 2096 2005 you",
    "start": "1994320",
    "end": "1999360"
  },
  {
    "text": "know uh this is the B over perity in Z",
    "start": "1999360",
    "end": "2004480"
  },
  {
    "text": "before version 1.2.3 the characteristics and exploitability of",
    "start": "2004480",
    "end": "2011519"
  },
  {
    "text": "this vulnerability will change according to uh the alloc function which is set by",
    "start": "2011519",
    "end": "2018000"
  },
  {
    "text": "every uh every application actually it was Heap Heap overflow which destroy",
    "start": "2018000",
    "end": "2025480"
  },
  {
    "text": "heat managed by local lock as a result it will result in",
    "start": "2025480",
    "end": "2031519"
  },
  {
    "text": "Crash well fortunately uh the attacker could override the memory but",
    "start": "2031519",
    "end": "2038320"
  },
  {
    "text": "attacker cannot control the content of overlight so I think it's not possible",
    "start": "2038320",
    "end": "2044200"
  },
  {
    "text": "to execute a code in this using this vulnerabilties and I also could not find",
    "start": "2044200",
    "end": "2052079"
  },
  {
    "text": "critical vulnerability which allows after code execution but well it",
    "start": "2052079",
    "end": "2059158"
  },
  {
    "text": "seems hopeful isn't",
    "start": "2059159",
    "end": "2064638"
  },
  {
    "text": "it so",
    "start": "2065320",
    "end": "2069320"
  },
  {
    "text": "post exploitation part so we assume the attacker can",
    "start": "2074040",
    "end": "2081720"
  },
  {
    "text": "execute a called in some applications but applications are",
    "start": "2081720",
    "end": "2087960"
  },
  {
    "text": "isolated and most of them have least privilege so just exporting one bability",
    "start": "2087960",
    "end": "2095599"
  },
  {
    "text": "is not enough the attacker have to get higher privileges to do something more",
    "start": "2095599",
    "end": "2102480"
  },
  {
    "text": "interesting for attackers I mean so I looked for uh possibilities of",
    "start": "2102480",
    "end": "2110320"
  },
  {
    "text": "previous excavation and I found this uh the this undocumented",
    "start": "2110320",
    "end": "2118320"
  },
  {
    "text": "capabilities idap inter Services I think this is a design R by",
    "start": "2118320",
    "end": "2125160"
  },
  {
    "text": "Microsoft uh this capability I cap inter Services allows access to third party",
    "start": "2125160",
    "end": "2131520"
  },
  {
    "text": "Services uh I mean inter Services I thought this capability is used uh just",
    "start": "2131520",
    "end": "2138960"
  },
  {
    "text": "for OEM applications but this is actually used but uh by known OEM apps",
    "start": "2138960",
    "end": "2147119"
  },
  {
    "text": "such as Tango video calls I discovered Tango video codes",
    "start": "2147119",
    "end": "2154520"
  },
  {
    "text": "have to modify specific registry value but it could also lead in prev",
    "start": "2154520",
    "end": "2162079"
  },
  {
    "text": "excretions why simple well some omem drivers could be",
    "start": "2162079",
    "end": "2169680"
  },
  {
    "text": "vulnerable and actually vulnerable I have actually no good",
    "start": "2169680",
    "end": "2175319"
  },
  {
    "text": "feelings about OEM drivers or interfaces because I and many hackers have found s",
    "start": "2175319",
    "end": "2182800"
  },
  {
    "text": "rooting or critical security vulnerabilities in OEM and drivers",
    "start": "2182800",
    "end": "2188640"
  },
  {
    "text": "interfaces customizations in Android devices many",
    "start": "2188640",
    "end": "2193720"
  },
  {
    "text": "Android devices I have seen several OEM interfaces which could bable or could",
    "start": "2193720",
    "end": "2201800"
  },
  {
    "text": "allow allow to much resource",
    "start": "2201800",
    "end": "2206640"
  },
  {
    "text": "accesses so uh this is a sketch of escaping",
    "start": "2208680",
    "end": "2215680"
  },
  {
    "text": "Chambers if idap inter Services apps are",
    "start": "2216000",
    "end": "2222240"
  },
  {
    "text": "compromised such as Tango video calls are is compromised uh the attacker can",
    "start": "2222240",
    "end": "2228520"
  },
  {
    "text": "access to inter Services some inter services are poorly designed and will",
    "start": "2228520",
    "end": "2235200"
  },
  {
    "text": "allow resources in other applications and the attacker will stay information",
    "start": "2235200",
    "end": "2240760"
  },
  {
    "text": "modified system blah blah blah",
    "start": "2240760",
    "end": "2244319"
  },
  {
    "text": "blah if even looking at the demo device uh which is hc7 mod the result was no",
    "start": "2246280",
    "end": "2253400"
  },
  {
    "text": "good they are previl interfaces to access file system",
    "start": "2253400",
    "end": "2259920"
  },
  {
    "text": "resis uh and more that R memory uh some interfaces are disabled",
    "start": "2259920",
    "end": "2267119"
  },
  {
    "text": "and or restricted in later versions but still uh improper access Vector remains",
    "start": "2267119",
    "end": "2275160"
  },
  {
    "text": "there some bity well I have plan to",
    "start": "2275160",
    "end": "2282640"
  },
  {
    "text": "demonstrate this but well I accidentally broke the demo environment so I",
    "start": "2282640",
    "end": "2290960"
  },
  {
    "text": "think I uh only thing I can do is show",
    "start": "2290960",
    "end": "2296440"
  },
  {
    "text": "the uh file storing from the",
    "start": "2296440",
    "end": "2304960"
  },
  {
    "text": "uh uh OEM interfaces",
    "start": "2305040",
    "end": "2310400"
  },
  {
    "text": "so uh stored po v file uh this is used",
    "start": "2310400",
    "end": "2317319"
  },
  {
    "text": "by outlock applications and it contains well",
    "start": "2317319",
    "end": "2325240"
  },
  {
    "text": "frankly very useful information for instance I I have uh assigned the Gmail",
    "start": "2325240",
    "end": "2332920"
  },
  {
    "text": "address to the Windows phone device so let's search for",
    "start": "2332920",
    "end": "2339400"
  },
  {
    "text": "Gmail here o.a. ffr at gmail.com here appears the",
    "start": "2339400",
    "end": "2348000"
  },
  {
    "text": "email address also uh you can",
    "start": "2348000",
    "end": "2354040"
  },
  {
    "text": "uh you can see the uh Center of uh",
    "start": "2356160",
    "end": "2363200"
  },
  {
    "text": "[Music] the the mail",
    "start": "2363200",
    "end": "2369280"
  },
  {
    "text": "and look at the some well",
    "start": "2369280",
    "end": "2376200"
  },
  {
    "text": "see no oh there's a message information uh I",
    "start": "2376200",
    "end": "2383400"
  },
  {
    "text": "have attached sample p. be it could also",
    "start": "2383400",
    "end": "2388880"
  },
  {
    "text": "showed uh actual sample uh sample fold being is uh located at same Outlook so",
    "start": "2388880",
    "end": "2397480"
  },
  {
    "text": "directory and I can steal the data as",
    "start": "2397480",
    "end": "2404119"
  },
  {
    "text": "well so in conclusion uh Windows Phone 7 is mostly",
    "start": "2411720",
    "end": "2418240"
  },
  {
    "text": "designed secure however some omem components drivers seem to be un concern",
    "start": "2418240",
    "end": "2426560"
  },
  {
    "text": "unconcerned about security and Microsoft allowed om to use one capabilties idap",
    "start": "2426560",
    "end": "2434640"
  },
  {
    "text": "inter Services I think privileges I mean capability separation",
    "start": "2434640",
    "end": "2441359"
  },
  {
    "text": "is very important Microsoft have should have been separated on capabilities",
    "start": "2441359",
    "end": "2447440"
  },
  {
    "text": "correctly and Microsoft should control orm capabil and its security",
    "start": "2447440",
    "end": "2456240"
  },
  {
    "text": "so I have described Windows 1 7 internals and some possibility of",
    "start": "2459599",
    "end": "2464640"
  },
  {
    "text": "exploitation so let's move on to the conclusion",
    "start": "2464640",
    "end": "2470319"
  },
  {
    "text": "here oh uh sbox and application systems",
    "start": "2470319",
    "end": "2476680"
  },
  {
    "text": "uh design secure conforming principle of this previous this is good but",
    "start": "2476680",
    "end": "2484880"
  },
  {
    "text": "uh and native code exporation uh operating system is designed well but",
    "start": "2484880",
    "end": "2492520"
  },
  {
    "text": "some concerns here regarding insufficient aslr and do",
    "start": "2492520",
    "end": "2498640"
  },
  {
    "text": "memory and more of that if the app with IAP inter Services cap rig is rable it",
    "start": "2498640",
    "end": "2507079"
  },
  {
    "text": "may result in sbox",
    "start": "2507079",
    "end": "2511520"
  },
  {
    "text": "bypass so in general conclusion we Windows Phone 7.x Implement implements",
    "start": "2514960",
    "end": "2521720"
  },
  {
    "text": "very strong sandbox however uh some there's some concerns here specifically",
    "start": "2521720",
    "end": "2529760"
  },
  {
    "text": "inter Services Orem interfaces and native code could be a design fure uh",
    "start": "2529760",
    "end": "2536040"
  },
  {
    "text": "design flow it have to be fixed in Windows Phone 8 and I guess it",
    "start": "2536040",
    "end": "2544240"
  },
  {
    "text": "will well uh Microsoft has recently announced",
    "start": "2545040",
    "end": "2550400"
  },
  {
    "text": "Windows One 8 operating system and announced Windows Phone 8 uses uses",
    "start": "2550400",
    "end": "2558359"
  },
  {
    "text": "shared Windows core same as Windows 8 so it it means anti coronus is coming to",
    "start": "2558359",
    "end": "2567040"
  },
  {
    "text": "Windows Phone 8 uh anus implements",
    "start": "2567040",
    "end": "2572720"
  },
  {
    "text": "proper uh mitigation feature or Advanced feature so I",
    "start": "2572720",
    "end": "2578720"
  },
  {
    "text": "expecting strong memory prot protection and exploit",
    "start": "2578720",
    "end": "2584160"
  },
  {
    "text": "mitigation and more that uh Windows Phone 8 allows n code access in default",
    "start": "2584160",
    "end": "2593160"
  },
  {
    "text": "so it will minimize idap inter services at X surface because",
    "start": "2593160",
    "end": "2599599"
  },
  {
    "text": "uh those application will no longer require to use such privileges",
    "start": "2599599",
    "end": "2608599"
  },
  {
    "text": "this this is good news for us so I have to say congrats Microsoft so uh this is",
    "start": "2609520",
    "end": "2619400"
  },
  {
    "text": "the uh end of the presentation and do you have any question",
    "start": "2619400",
    "end": "2626720"
  },
  {
    "text": "well I'm I'm",
    "start": "2626720",
    "end": "2631680"
  },
  {
    "text": "[Applause]",
    "start": "2633870",
    "end": "2637300"
  }
]