[
  {
    "text": "um this is the 92.2% market share track in this room",
    "start": "240",
    "end": "6000"
  },
  {
    "text": "and uh I am happy to introduce TT SAO and Nanaka Pan for exploitation of",
    "start": "6000",
    "end": "13920"
  },
  {
    "text": "Windows 8 Metro style apps all right um let's",
    "start": "13920",
    "end": "21320"
  },
  {
    "text": "start okay uh good morning everyone uh I'm TT and here's my our partners uh his",
    "start": "21320",
    "end": "28640"
  },
  {
    "text": "nana car and the topic of this talk is the build the subway line act and",
    "start": "28640",
    "end": "35079"
  },
  {
    "text": "exploitation of uh windows at metro star apps today we are going to tell you uh some",
    "start": "35079",
    "end": "41920"
  },
  {
    "text": "interesting findings about uh Windows 8 and the topic is like the subway and",
    "start": "41920",
    "end": "48960"
  },
  {
    "text": "that uh you have a metro so we have a subway and I hope after after the talk",
    "start": "48960",
    "end": "54879"
  },
  {
    "text": "uh you could understand you could know uh what the meaning uh we why we gave it",
    "start": "54879",
    "end": "59920"
  },
  {
    "text": "a",
    "start": "59920",
    "end": "62079"
  },
  {
    "text": "subway all right so um who are we um we are from Taiwan and we are security",
    "start": "66439",
    "end": "72479"
  },
  {
    "text": "researcher in Tremic and we are in the same team um our team is doing advanced",
    "start": "72479",
    "end": "79280"
  },
  {
    "text": "research and and we also trying to come out some solutions to solve",
    "start": "79280",
    "end": "86560"
  },
  {
    "text": "problems hi everyone my name you can call me Nanika i'm st",
    "start": "91320",
    "end": "97920"
  },
  {
    "text": "research engineer of t Michael my research topic include various research",
    "start": "97920",
    "end": "104479"
  },
  {
    "text": "is poly technique mway detection and mobile security especially on Windows",
    "start": "104479",
    "end": "110640"
  },
  {
    "text": "perform",
    "start": "110640",
    "end": "113640"
  },
  {
    "text": "hi uh I'm DT uh currently I'm I'm leading the team doing the research and I'm interested in many topics like um",
    "start": "118159",
    "end": "125439"
  },
  {
    "text": "especially on news new new uh new technology new security technology uh new thread uh new vulnerability uh",
    "start": "125439",
    "end": "132800"
  },
  {
    "text": "malware and target attack and Nika and I and I are partners for a long time uh",
    "start": "132800",
    "end": "140560"
  },
  {
    "text": "last year we uh have presented some researches uh about target attack and",
    "start": "140560",
    "end": "145599"
  },
  {
    "text": "document exploit in blackhead",
    "start": "145599",
    "end": "149640"
  },
  {
    "text": "we are also core members of uh the uh changer security group uh in Taiwan",
    "start": "152239",
    "end": "157760"
  },
  {
    "text": "which is a study group and the group hosts the um hikcom the conference and",
    "start": "157760",
    "end": "163599"
  },
  {
    "text": "it is the largest security and hacker conference in Taiwan and this year we",
    "start": "163599",
    "end": "168800"
  },
  {
    "text": "have more than 800",
    "start": "168800",
    "end": "172160"
  },
  {
    "text": "[Music] attendees okay so um this is last year when we uh when we were presenting and",
    "start": "174280",
    "end": "182480"
  },
  {
    "text": "we forgot to uh lock the door so um after an hour did have you",
    "start": "182480",
    "end": "190959"
  },
  {
    "text": "locked door yes yes the dark is the the door is locked this time and they um",
    "start": "190959",
    "end": "197040"
  },
  {
    "text": "yeah they don't have chance to escape yeah sorry we we we just want to make a joke uh to let you stay and no worries",
    "start": "197040",
    "end": "204360"
  },
  {
    "text": "and no sandbox by passing all right uh Windows 8",
    "start": "204360",
    "end": "211959"
  },
  {
    "text": "um Windows 8 is going to be uh released soon um this year uh we had some chance",
    "start": "211959",
    "end": "218319"
  },
  {
    "text": "to study Windows 8 and u we already found many interesting uh things so we",
    "start": "218319",
    "end": "225360"
  },
  {
    "text": "are going to share today and um have you ever used the uh Windows 8",
    "start": "225360",
    "end": "232280"
  },
  {
    "text": "anyone uh yeah uh think of Windows 8 um what impressed you the",
    "start": "232280",
    "end": "240200"
  },
  {
    "text": "most the UI",
    "start": "240200",
    "end": "244080"
  },
  {
    "text": "right yeah so uh it is very beautiful and very uh",
    "start": "248040",
    "end": "256239"
  },
  {
    "text": "fancy user uh it has a very beautiful and very fancy user interface it",
    "start": "256239",
    "end": "261680"
  },
  {
    "text": "introduced lots of uh security improvements it is very secure it is very",
    "start": "261680",
    "end": "268840"
  },
  {
    "text": "robust right so uh we totally agree um",
    "start": "268840",
    "end": "274080"
  },
  {
    "text": "yeah anyway uh we we would like to thank uh say thanks to Microsoft and they gave",
    "start": "274080",
    "end": "279919"
  },
  {
    "text": "us the chance to have this",
    "start": "279919",
    "end": "283199"
  },
  {
    "text": "talk okay so um here is the agenda of this talk um in the beginning uh we will",
    "start": "285639",
    "end": "291840"
  },
  {
    "text": "introduce the security security security design of metro star app and um to to to",
    "start": "291840",
    "end": "299360"
  },
  {
    "text": "uh describe how does it protect uh from a malicious app the second uh we will um",
    "start": "299360",
    "end": "306320"
  },
  {
    "text": "introduce uh we will introduce some general concepts to uh bypass an application sandbox you know there is a",
    "start": "306320",
    "end": "314400"
  },
  {
    "text": "sandbox in metro style apps and I will introduce this later",
    "start": "314400",
    "end": "320000"
  },
  {
    "text": "then uh we will start to analyze the problem uh from different point of view",
    "start": "320000",
    "end": "326800"
  },
  {
    "text": "uh from low to high levels from low to high layers and including like uh ALPC",
    "start": "326800",
    "end": "333520"
  },
  {
    "text": "COM uh WinRT and design logic and we will disclose some problems",
    "start": "333520",
    "end": "339919"
  },
  {
    "text": "we have discovered and uh we we have already report all of these issues to",
    "start": "339919",
    "end": "347160"
  },
  {
    "text": "MSRC and so we will also describe some uh responses uh from MSRC as",
    "start": "347160",
    "end": "354800"
  },
  {
    "text": "well okay so uh no doubt uh there are lots of security improvements",
    "start": "356120",
    "end": "361759"
  },
  {
    "text": "improvements uh in Windows 8 uh new internet explorer uh enhance protected",
    "start": "361759",
    "end": "367600"
  },
  {
    "text": "mode and boot protection and new exploit uh mitigation technology which can",
    "start": "367600",
    "end": "374160"
  },
  {
    "text": "mitigate exploit targeting user space application as well as well as uh kernel",
    "start": "374160",
    "end": "381639"
  },
  {
    "text": "vulnerabilities yeah so many uh features new features in Windows 8 and however",
    "start": "381639",
    "end": "387919"
  },
  {
    "text": "the most attractive thing is the Metro style",
    "start": "387919",
    "end": "393400"
  },
  {
    "text": "apps the user interface is really fancy and clear and easy to",
    "start": "393400",
    "end": "400120"
  },
  {
    "text": "use but um um introduction introducing a major site app might take two or three",
    "start": "400120",
    "end": "406560"
  },
  {
    "text": "hours so um we will not spend too much time on this in this talk uh we will",
    "start": "406560",
    "end": "411680"
  },
  {
    "text": "only focus on the most important security features of metro style",
    "start": "411680",
    "end": "418400"
  },
  {
    "text": "apps okay so um for the first thing uh from the security point of view the",
    "start": "419720",
    "end": "425599"
  },
  {
    "text": "first thing uh we can see is the capabilities limitation and setting in metro star apps",
    "start": "425599",
    "end": "432720"
  },
  {
    "text": "um Metro Star apps um developer must specify which resource they need to",
    "start": "432720",
    "end": "438560"
  },
  {
    "text": "access by declaring the cap capabilities in its package setting like this",
    "start": "438560",
    "end": "446720"
  },
  {
    "text": "each um capability they have to very clear to um clearly declare de declared",
    "start": "446720",
    "end": "454000"
  },
  {
    "text": "in the setting after uh submitting to the windows store uh it will be checked",
    "start": "454000",
    "end": "460560"
  },
  {
    "text": "and ensure a windows store will ensure uh the that uh the declare capability",
    "start": "460560",
    "end": "467680"
  },
  {
    "text": "match the description of the app so it is not allowed to access the resource it",
    "start": "467680",
    "end": "474720"
  },
  {
    "text": "doesn't declare so this it's a very restrict",
    "start": "474720",
    "end": "480720"
  },
  {
    "text": "limitation the capability uh includes three types of resource uh network file",
    "start": "482360",
    "end": "488000"
  },
  {
    "text": "system and device a network includes uh like um to be uh the app you want to be",
    "start": "488000",
    "end": "495440"
  },
  {
    "text": "a client application or you want to be a server application or uh some uh",
    "start": "495440",
    "end": "500560"
  },
  {
    "text": "internet uh capability you want to connect to internet or in internet only like this setting and uh file system the",
    "start": "500560",
    "end": "508560"
  },
  {
    "text": "second file system includes the file location you can access there are only a",
    "start": "508560",
    "end": "514240"
  },
  {
    "text": "few places the Metro style apps can access like this your app can only access uh document",
    "start": "514240",
    "end": "521360"
  },
  {
    "text": "picture or um music uh video or um yeah if you didn't grant this permission to",
    "start": "521360",
    "end": "528800"
  },
  {
    "text": "app the app cannot access uh any uh",
    "start": "528800",
    "end": "534519"
  },
  {
    "text": "folders and the device includes like uh GPS and microphone such uh devices uh",
    "start": "534519",
    "end": "541360"
  },
  {
    "text": "configuration and to specify uh the app can use these um devices and there's",
    "start": "541360",
    "end": "548320"
  },
  {
    "text": "exception only are the things uh things that are specific to an application like",
    "start": "548320",
    "end": "554320"
  },
  {
    "text": "a local storage this is uh this do not this does not uh require a",
    "start": "554320",
    "end": "561360"
  },
  {
    "text": "capabilities okay so um when you got the application the app um when user get",
    "start": "565399",
    "end": "572000"
  },
  {
    "text": "this uh app from Windows store they are notified um of all capability that the",
    "start": "572000",
    "end": "579920"
  },
  {
    "text": "app declares like this uh here shows the application has a location GPS and",
    "start": "579920",
    "end": "587600"
  },
  {
    "text": "internet capability",
    "start": "587600",
    "end": "591160"
  },
  {
    "text": "all right uh next feature uh Win RT",
    "start": "596000",
    "end": "600320"
  },
  {
    "text": "API okay um win RT API means uh Windows runtime it is a backbone of the uh new",
    "start": "605640",
    "end": "612959"
  },
  {
    "text": "metro star apps it provides a set of API that uh can be called from like uh C uh",
    "start": "612959",
    "end": "621600"
  },
  {
    "text": "C++ or HTML JavaScript so you may develop a metro style app uh even using",
    "start": "621600",
    "end": "628640"
  },
  {
    "text": "uh HTML JavaScript and Metro app need to use uh WinRT API to access resource from",
    "start": "628640",
    "end": "635920"
  },
  {
    "text": "operating system so um using uh win RT um the apps",
    "start": "635920",
    "end": "641839"
  },
  {
    "text": "create for win um are safe secure and",
    "start": "641839",
    "end": "648079"
  },
  {
    "text": "sandboxed so yeah you can see the architecture of the win RT and um yeah",
    "start": "651560",
    "end": "657839"
  },
  {
    "text": "WinRT API covers uh everything for metro star app yeah so basically winrt provides um",
    "start": "657839",
    "end": "665040"
  },
  {
    "text": "yeah everything for metro star apps need and writing metro star app uh you only",
    "start": "665040",
    "end": "670640"
  },
  {
    "text": "need to know win",
    "start": "670640",
    "end": "673760"
  },
  {
    "text": "API okay next feature uh this is the most important component and",
    "start": "677079",
    "end": "682920"
  },
  {
    "text": "architecture the um the app container sandbox it is an application sandbox",
    "start": "682920",
    "end": "689440"
  },
  {
    "text": "protect protecting uh system from a malicious",
    "start": "689440",
    "end": "694639"
  },
  {
    "text": "app okay what is an application sandbox um application sandbox is a mechanism to",
    "start": "696680",
    "end": "703360"
  },
  {
    "text": "isolate untrusted process and um protecting system from exploit attack",
    "start": "703360",
    "end": "710320"
  },
  {
    "text": "app container the the metro star app sandbox they name it app container app",
    "start": "710320",
    "end": "715600"
  },
  {
    "text": "container is a new sandbox design in Windows 8 and all metro star apps uh run",
    "start": "715600",
    "end": "721680"
  },
  {
    "text": "in a sandbox uh run in a security sandbox called app container that",
    "start": "721680",
    "end": "727600"
  },
  {
    "text": "isolate them from other metro apps and isolate from the operating system so um",
    "start": "727600",
    "end": "735200"
  },
  {
    "text": "this um isolated process uh which runs with very limited permission they need",
    "start": "735200",
    "end": "741440"
  },
  {
    "text": "to communicate with a broker process uh the broker broker process doing uh doing",
    "start": "741440",
    "end": "747600"
  },
  {
    "text": "some privilege actions of operations for metro app so um yeah um and they need an",
    "start": "747600",
    "end": "756800"
  },
  {
    "text": "IPC IPC mechanism to allow isolated process to communicate with broker so",
    "start": "756800",
    "end": "762959"
  },
  {
    "text": "your app need to um use use IPC mechanism to communicate with broker so",
    "start": "762959",
    "end": "768639"
  },
  {
    "text": "then broker can do do some privilege things for",
    "start": "768639",
    "end": "773920"
  },
  {
    "text": "you all right which means um Metro style app uh needs to be run in an app app",
    "start": "778279",
    "end": "785160"
  },
  {
    "text": "container and when the app uh want to do some privilege actions it needs to act",
    "start": "785160",
    "end": "791279"
  },
  {
    "text": "the broker process via IPC IPC communication like this picture shows",
    "start": "791279",
    "end": "797040"
  },
  {
    "text": "yeah and the picture shows how app container works",
    "start": "797040",
    "end": "802160"
  },
  {
    "text": "and yeah um each uh metros metro app are running in uh app container and app",
    "start": "802160",
    "end": "808720"
  },
  {
    "text": "container need to use uh win RT API to communicate with a broker",
    "start": "808720",
    "end": "813880"
  },
  {
    "text": "process and um two two app cont uh two metro app they cannot",
    "start": "813880",
    "end": "822240"
  },
  {
    "text": "communicate yeah uh each app has its own storage they need to use when RT API and",
    "start": "822440",
    "end": "829839"
  },
  {
    "text": "um so uh in terms of the sandbox bypassing uh the broker is usually the",
    "start": "829839",
    "end": "836320"
  },
  {
    "text": "first target we are thinking of um when we are thinking of sandbox bypassing the broker",
    "start": "836320",
    "end": "844320"
  },
  {
    "text": "process is the target okay so not only sandbox feature",
    "start": "844320",
    "end": "851680"
  },
  {
    "text": "I have introduced above um that like win or app container windows also um provide",
    "start": "851680",
    "end": "858160"
  },
  {
    "text": "lot windows also provide lots of security features to secure u metro star",
    "start": "858160",
    "end": "863199"
  },
  {
    "text": "apps such as uh app app signature um certification kit uh termetry feedbacks",
    "start": "863199",
    "end": "870320"
  },
  {
    "text": "yeah all of these uh features bring us the confidence yeah it's according to",
    "start": "870320",
    "end": "876000"
  },
  {
    "text": "Microsoft so uh we agree all of these designs is really provide um a security",
    "start": "876000",
    "end": "882079"
  },
  {
    "text": "execution environment for metro star apps so um I would say um exploit metro",
    "start": "882079",
    "end": "888720"
  },
  {
    "text": "star app is not",
    "start": "888720",
    "end": "891839"
  },
  {
    "text": "easy okay so conclude the uh in introduction above um app container",
    "start": "895480",
    "end": "901760"
  },
  {
    "text": "provides uh strict permission settings and a solid application and bars so from",
    "start": "901760",
    "end": "908240"
  },
  {
    "text": "technical perspect perspective um if you want to exploit the uh metro style app",
    "start": "908240",
    "end": "914399"
  },
  {
    "text": "the first step you have to deal with the app",
    "start": "914399",
    "end": "919600"
  },
  {
    "text": "container all right so let's see some previous work on um sandbox bypassing",
    "start": "923079",
    "end": "928560"
  },
  {
    "text": "the bypass bypassing um the application sandbars is very is a hot topic now yeah",
    "start": "928560",
    "end": "934880"
  },
  {
    "text": "because uh many application want um because they want to provide more secure environment they they will provide a",
    "start": "934880",
    "end": "941920"
  },
  {
    "text": "sandbox uh execution environment like uh Google Chrome Adobe Reader X",
    "start": "941920",
    "end": "948639"
  },
  {
    "text": "so um by pressing symbox you might think about these techniques for example the",
    "start": "948639",
    "end": "953759"
  },
  {
    "text": "first exploit kernel and privilege escal escalation vulnerability to escape",
    "start": "953759",
    "end": "959800"
  },
  {
    "text": "symbox take advantage of kernel directly or some exploit to escape escalate uh",
    "start": "959800",
    "end": "966800"
  },
  {
    "text": "your privilege and this is the first kind of attack then the second find",
    "start": "966800",
    "end": "972240"
  },
  {
    "text": "useful things on file system they're looking for accessible folders of files",
    "start": "972240",
    "end": "979440"
  },
  {
    "text": "and registries especially some writable location on the disk and to see uh what",
    "start": "979440",
    "end": "986160"
  },
  {
    "text": "we can do or what we can get from these places and or the third try to send some",
    "start": "986160",
    "end": "993839"
  },
  {
    "text": "message to or keyboard events to outside of sandbox like uh you can send some",
    "start": "993839",
    "end": "1000560"
  },
  {
    "text": "keyboard events and um other application or uh your operating system will will",
    "start": "1000560",
    "end": "1006720"
  },
  {
    "text": "take some action after they receive some window will take some actions um after",
    "start": "1006720",
    "end": "1012639"
  },
  {
    "text": "they receive this event yeah and um Okay and um there are the the um",
    "start": "1012639",
    "end": "1022000"
  },
  {
    "text": "leverage special handles yeah and leverage special handles means um some available handles",
    "start": "1022000",
    "end": "1029600"
  },
  {
    "text": "might be used to communicate with uh other process or resource uh enumerate",
    "start": "1029600",
    "end": "1035760"
  },
  {
    "text": "handles controlled by you um investigate which uh data could be modified by these",
    "start": "1035760",
    "end": "1041760"
  },
  {
    "text": "handles uh or try to see if we could uh send message or uh to other process by",
    "start": "1041760",
    "end": "1047918"
  },
  {
    "text": "these handles yeah so some special handle can be used to bypass symb okay so um however um except out of",
    "start": "1047919",
    "end": "1057039"
  },
  {
    "text": "this uh approach uh we are going to provide some new techniques targeting",
    "start": "1057039",
    "end": "1062160"
  },
  {
    "text": "especially targeting architecture of metro star apps and the app app container and we will introduce",
    "start": "1062160",
    "end": "1068960"
  },
  {
    "text": "introduce some techniques okay so let's see the attack",
    "start": "1068960",
    "end": "1077280"
  },
  {
    "text": "vectors okay so uh attacking the uh app container uh in order to bypass sandbox",
    "start": "1080440",
    "end": "1087039"
  },
  {
    "text": "uh usually the first target is the broker process uh in metro star apps uh",
    "start": "1087039",
    "end": "1092480"
  },
  {
    "text": "our target is the runtime broker in the windows app the runtime",
    "start": "1092480",
    "end": "1098799"
  },
  {
    "text": "broker okay so let's see more details um metro star apps are based on uh winrt",
    "start": "1099799",
    "end": "1107360"
  },
  {
    "text": "and winrt is basically a combased um API and metro star app um communicate with",
    "start": "1107360",
    "end": "1115039"
  },
  {
    "text": "the uh runtime broker u um through com interfaces the runtime broker is using",
    "start": "1115039",
    "end": "1122480"
  },
  {
    "text": "come to receive uh information as well so under com um there is a alpc uh",
    "start": "1122480",
    "end": "1130320"
  },
  {
    "text": "communication in kernel so this picture shows the flow of communication between",
    "start": "1130320",
    "end": "1135679"
  },
  {
    "text": "a metro star app and runtime bro runtime broker so the message uh the message",
    "start": "1135679",
    "end": "1142320"
  },
  {
    "text": "flow is um winrt comm and com and",
    "start": "1142320",
    "end": "1147440"
  },
  {
    "text": "runtime broker these three places uh that we can leverage to attack runtime broker we can",
    "start": "1147440",
    "end": "1154320"
  },
  {
    "text": "like uh intercept LPC communication and to send fake mail phone or crack uh data",
    "start": "1154320",
    "end": "1161520"
  },
  {
    "text": "here and also uh we can attack com server to uh leverage come um API com",
    "start": "1161520",
    "end": "1168360"
  },
  {
    "text": "communication and send the um uh attacking data here and also we can do",
    "start": "1168360",
    "end": "1174240"
  },
  {
    "text": "fuzzing on win RT",
    "start": "1174240",
    "end": "1177919"
  },
  {
    "text": "API all right so from architecture uh point of view there are three attack uh",
    "start": "1181640",
    "end": "1187360"
  },
  {
    "text": "vectors I I just showed LPCOM nt so now and uh we'll plus a design logic um we",
    "start": "1187360",
    "end": "1195760"
  },
  {
    "text": "are going to discuss four attack vectors in following",
    "start": "1195760",
    "end": "1201200"
  },
  {
    "text": "slide okay so the first uh is attack alpc so um by analyzing the uh metro",
    "start": "1201880",
    "end": "1209200"
  },
  {
    "text": "star app architecture we decide to concentrate on AOPC first because all",
    "start": "1209200",
    "end": "1214880"
  },
  {
    "text": "data are transferred by ALPC protocol uh in our design uh in our research of um",
    "start": "1214880",
    "end": "1221360"
  },
  {
    "text": "ALPC uh we found some API useful to help us better to understand the inner",
    "start": "1221360",
    "end": "1227120"
  },
  {
    "text": "communication uh in the kernel hence um we uh our next uh step is writing some",
    "start": "1227120",
    "end": "1233520"
  },
  {
    "text": "program to hook this API and this uh picture shows the LPC uh",
    "start": "1233520",
    "end": "1241200"
  },
  {
    "text": "data communication the client process establish an LPC port to communicate",
    "start": "1241200",
    "end": "1247200"
  },
  {
    "text": "with it server process through the message",
    "start": "1247200",
    "end": "1251760"
  },
  {
    "text": "queue okay and as you can see as you see in the picture um com is uh responsive",
    "start": "1253799",
    "end": "1261919"
  },
  {
    "text": "for the uh communication between metro star app and runtime broker for example",
    "start": "1261919",
    "end": "1268559"
  },
  {
    "text": "uh to access one file the flow of what access a file the metro star apps um",
    "start": "1268559",
    "end": "1275440"
  },
  {
    "text": "mure is request uh via com and uh then",
    "start": "1275440",
    "end": "1281360"
  },
  {
    "text": "pass it to runtime brok yeah and on the AOPC uh under",
    "start": "1281360",
    "end": "1286640"
  },
  {
    "text": "runtime worker part uh once uh it received the marshall request uh first",
    "start": "1286640",
    "end": "1292799"
  },
  {
    "text": "it have to unmarshall the request via com to get request data after a runtime broker su",
    "start": "1292799",
    "end": "1300320"
  },
  {
    "text": "successfully auditing the request and uh request privilege uh it opens the file",
    "start": "1300320",
    "end": "1307039"
  },
  {
    "text": "and bypass content to uh the following um bypass content back um following the",
    "start": "1307039",
    "end": "1314400"
  },
  {
    "text": "same mechanism to the uh metro star app so this is the flow between major star",
    "start": "1314400",
    "end": "1320559"
  },
  {
    "text": "app and runtime",
    "start": "1320559",
    "end": "1323600"
  },
  {
    "text": "blocker okay so to analyze ALPC uh we can use command LPC uh in wind debug and",
    "start": "1327240",
    "end": "1335840"
  },
  {
    "text": "uh use uh this uh to verify uh which process are communicating with um LPC",
    "start": "1335840",
    "end": "1343280"
  },
  {
    "text": "you can list all LPC uh communication here",
    "start": "1343280",
    "end": "1348960"
  },
  {
    "text": "here are API which related to LPC in Windows 8 and the red line shows some",
    "start": "1349480",
    "end": "1356880"
  },
  {
    "text": "important API that we are",
    "start": "1356880",
    "end": "1361520"
  },
  {
    "text": "interested okay so we are interested in this four API um like uh send AOPC send",
    "start": "1365000",
    "end": "1372720"
  },
  {
    "text": "weight uh receive port is in charge of uh send and receive data and uh create",
    "start": "1372720",
    "end": "1379440"
  },
  {
    "text": "port um is in charge of the procreating connect is pro um the connection um pro",
    "start": "1379440",
    "end": "1387760"
  },
  {
    "text": "connect uh connection um in charge of the port connect connection and accept",
    "start": "1387760",
    "end": "1393600"
  },
  {
    "text": "connect port is in charge of the um connection accepting of course so the",
    "start": "1393600",
    "end": "1398640"
  },
  {
    "text": "idea is similar to socket network socket so hook this hook this four API we can",
    "start": "1398640",
    "end": "1404000"
  },
  {
    "text": "get information that we want so uh in order to analyze communication",
    "start": "1404000",
    "end": "1410240"
  },
  {
    "text": "data uh here we provide four wind debug script to help debug so you can use um",
    "start": "1410240",
    "end": "1417039"
  },
  {
    "text": "as well so um this four script can grab communication data we also wrote some um",
    "start": "1417039",
    "end": "1423679"
  },
  {
    "text": "automatic casting program to metrostar app for metro star app testing so um by",
    "start": "1423679",
    "end": "1431120"
  },
  {
    "text": "continually uh sending crap data to uh ALPC um send weight receive port we can",
    "start": "1431120",
    "end": "1437760"
  },
  {
    "text": "try to some um to discover problems and please be noted that um",
    "start": "1437760",
    "end": "1444480"
  },
  {
    "text": "this hook is a global hook and you need to do some filtering to do uh to filter",
    "start": "1444480",
    "end": "1450000"
  },
  {
    "text": "message by process ID yeah so uh then you can get the",
    "start": "1450000",
    "end": "1456640"
  },
  {
    "text": "information only you want and these three scripts can help",
    "start": "1456640",
    "end": "1463760"
  },
  {
    "text": "you to hook uh this API these three API hook um AOPC create port um can help us",
    "start": "1463760",
    "end": "1471600"
  },
  {
    "text": "to know when is the AOPC port created and hook um connect port um we um we it",
    "start": "1471600",
    "end": "1481200"
  },
  {
    "text": "can help us to know when is the port connected and what is the name of the",
    "start": "1481200",
    "end": "1486840"
  },
  {
    "text": "port and hook um AOPC accept connect port um can help us to know when is the",
    "start": "1486840",
    "end": "1494240"
  },
  {
    "text": "connection been accepted okay so for the analyzing flow",
    "start": "1494240",
    "end": "1501600"
  },
  {
    "text": "first open a log file to write to the log file and the second hook on AOPC",
    "start": "1501600",
    "end": "1508320"
  },
  {
    "text": "create port function and then we can know when port is created the third launch the metro style app and then you",
    "start": "1508320",
    "end": "1516320"
  },
  {
    "text": "can uh uh then uh your hook will get a process ID and the fourth um hook this",
    "start": "1516320",
    "end": "1523200"
  },
  {
    "text": "API send word receive pole target your uh process ID to see their",
    "start": "1523200",
    "end": "1530559"
  },
  {
    "text": "information so by the script uh we have just mentioned uh this information is we",
    "start": "1533559",
    "end": "1538799"
  },
  {
    "text": "we we grab from the communication it is the example and this sample shows the uh",
    "start": "1538799",
    "end": "1545360"
  },
  {
    "text": "AOPC port is just created so uh when we launch an uh metro",
    "start": "1545360",
    "end": "1554240"
  },
  {
    "text": "star app we receive a here is the example we receive a class ID um class",
    "start": "1554240",
    "end": "1560880"
  },
  {
    "text": "ID data set corresponding to the this app this is our class ID",
    "start": "1560880",
    "end": "1570679"
  },
  {
    "text": "and this sample shows the class ID and interface ID and lock in uh we locked uh",
    "start": "1570880",
    "end": "1577120"
  },
  {
    "text": "in wind debug when runtime broker is launched by come local server it is uh class ID and is",
    "start": "1577120",
    "end": "1585120"
  },
  {
    "text": "interface ID okay so to do uh ALPC communication",
    "start": "1585120",
    "end": "1592960"
  },
  {
    "text": "fing uh we hook uh the um majorly we hook uh this API ALPC send and receive",
    "start": "1592960",
    "end": "1599360"
  },
  {
    "text": "port and in NDLL and to first the intercept data like this picture",
    "start": "1599360",
    "end": "1607120"
  },
  {
    "text": "shows all right so Nan will introduce the com server attack and um win your",
    "start": "1609640",
    "end": "1618080"
  },
  {
    "text": "attack take K server attack in the upper layer be reach uh by",
    "start": "1618760",
    "end": "1627440"
  },
  {
    "text": "come similarly we would like to test matros app using come one thing need to",
    "start": "1632760",
    "end": "1640480"
  },
  {
    "text": "know first uh in windows 8 and windows 7 the base address uh we get by this",
    "start": "1640480",
    "end": "1650240"
  },
  {
    "text": "uh is a kernel base instead of kernel",
    "start": "1650240",
    "end": "1655480"
  },
  {
    "text": "32.dl also in windows api in 32.dl",
    "start": "1655480",
    "end": "1662799"
  },
  {
    "text": "must be called through combust like",
    "start": "1662799",
    "end": "1669760"
  },
  {
    "text": "this this feature show the function this is which is for from",
    "start": "1677480",
    "end": "1685480"
  },
  {
    "text": "combase.dl and you can also see when we call or32 come",
    "start": "1685480",
    "end": "1692159"
  },
  {
    "text": "uh great instance it is redirect to comb based dio",
    "start": "1692159",
    "end": "1698600"
  },
  {
    "text": "so while we developing shoo we can use our API directory our own wing wing rt",
    "start": "1698600",
    "end": "1706600"
  },
  {
    "text": "API directly sure so this slide shows the difference uh uh between uh the uh",
    "start": "1706600",
    "end": "1713600"
  },
  {
    "text": "previous operating system and Windows 8 when we dealing with the",
    "start": "1713600",
    "end": "1720158"
  },
  {
    "text": "com so there are two purpose of com testing the first we want to test",
    "start": "1721559",
    "end": "1729720"
  },
  {
    "text": "the stability of cam servers and when to look for the problem like memory",
    "start": "1729720",
    "end": "1738679"
  },
  {
    "text": "correction also we want to see the function functionality of com servers",
    "start": "1738679",
    "end": "1746960"
  },
  {
    "text": "there might be some useful function can help us to do privilege operations",
    "start": "1746960",
    "end": "1754159"
  },
  {
    "text": "so uh basically we we we are interested in uh two things of about the com server the first is the stability of the com",
    "start": "1754159",
    "end": "1760960"
  },
  {
    "text": "server uh we can crash we can try to find memory box uh in com server and",
    "start": "1760960",
    "end": "1766480"
  },
  {
    "text": "also some uh com server can uh and can help us to do some um to provide",
    "start": "1766480",
    "end": "1772720"
  },
  {
    "text": "functions for us like uh we can ask com server to uh open open a file or to",
    "start": "1772720",
    "end": "1778559"
  },
  {
    "text": "connect to internet to send data to uh others yeah so come server sometimes can help us",
    "start": "1778559",
    "end": "1786559"
  },
  {
    "text": "so attack come server the first thing will be finding the target what come",
    "start": "1786559",
    "end": "1793520"
  },
  {
    "text": "server we can communicate with the major sty app major communicate with the",
    "start": "1793520",
    "end": "1799760"
  },
  {
    "text": "runtime booker so wrong type is the first one",
    "start": "1799760",
    "end": "1804640"
  },
  {
    "text": "target as best the wrong type is it possible to communicate with other com",
    "start": "1807080",
    "end": "1813480"
  },
  {
    "text": "server the answer is yes in our testing we use code to call com API in a app",
    "start": "1813480",
    "end": "1822840"
  },
  {
    "text": "container and we can communicate with other com servers which mean com server usually",
    "start": "1822840",
    "end": "1830240"
  },
  {
    "text": "provide provide a service for other com uh for other program so looking for a",
    "start": "1830240",
    "end": "1837039"
  },
  {
    "text": "usable com server might be a chance to escape from the same",
    "start": "1837039",
    "end": "1843840"
  },
  {
    "text": "box sometimes you can find a come server with higher",
    "start": "1845799",
    "end": "1851480"
  },
  {
    "text": "privilege in this simple T tip is a C server with high privilege",
    "start": "1851480",
    "end": "1860720"
  },
  {
    "text": "compromise this comes server means get a highest permissions",
    "start": "1860720",
    "end": "1866799"
  },
  {
    "text": "you might be noticed the uh the permission of tip uh come server is high",
    "start": "1866799",
    "end": "1871840"
  },
  {
    "text": "the high permission means like uh administrator permissions",
    "start": "1871840",
    "end": "1877200"
  },
  {
    "text": "so a compromised uh tip uh comes server you can get higher permissions",
    "start": "1877200",
    "end": "1884278"
  },
  {
    "text": "there are some common broker for example runtime broker I broker and double case",
    "start": "1884799",
    "end": "1893240"
  },
  {
    "text": "broker and uh there are so many come server how do",
    "start": "1893240",
    "end": "1900480"
  },
  {
    "text": "we know which one we can",
    "start": "1900480",
    "end": "1904960"
  },
  {
    "text": "use so we need to check permission first one thing we have to note that is a",
    "start": "1905880",
    "end": "1915720"
  },
  {
    "text": "large permission of com server it can only be large by metro app if all",
    "start": "1915720",
    "end": "1923519"
  },
  {
    "text": "application package permission is granted like",
    "start": "1923519",
    "end": "1929039"
  },
  {
    "text": "this so this one has to be granted then",
    "start": "1930200",
    "end": "1936159"
  },
  {
    "text": "major app can use this com server so uh not not all com servers you can",
    "start": "1936159",
    "end": "1943120"
  },
  {
    "text": "not all come server you can use so um basically if the com server u grant this",
    "start": "1943120",
    "end": "1948559"
  },
  {
    "text": "permission that uh um for metro star app so um with this uh set uh with this um",
    "start": "1948559",
    "end": "1956240"
  },
  {
    "text": "grant permission um metro style app can use this com",
    "start": "1956240",
    "end": "1961200"
  },
  {
    "text": "server to attack server first we must get a class ID and interface ID of a com",
    "start": "1961880",
    "end": "1968799"
  },
  {
    "text": "server by call grade instance API we can locate our target function by immerating",
    "start": "1968799",
    "end": "1976399"
  },
  {
    "text": "the video function pointer of this interface",
    "start": "1976399",
    "end": "1981440"
  },
  {
    "text": "if the com server come out come out with a median of high privilege it is useful",
    "start": "1981440",
    "end": "1988880"
  },
  {
    "text": "to bypass the AP contender retression after analyze uh this",
    "start": "1988880",
    "end": "1995120"
  },
  {
    "text": "interface we can also do some testing to the explore function if we can crash a",
    "start": "1995120",
    "end": "2002000"
  },
  {
    "text": "com server there are chance we can explore it",
    "start": "2002000",
    "end": "2007679"
  },
  {
    "text": "so basically there are three things you have to know before uh trying to to um",
    "start": "2007679",
    "end": "2013120"
  },
  {
    "text": "to to use the com server the first is the what comes server you can use the",
    "start": "2013120",
    "end": "2018720"
  },
  {
    "text": "second is the uh what is the class ID of the com server and then uh what is the",
    "start": "2018720",
    "end": "2024799"
  },
  {
    "text": "function ID the function uh the v v table the v table shows the the what is",
    "start": "2024799",
    "end": "2030080"
  },
  {
    "text": "a function uh we can use yeah so all these three things you have to know before you start try trying uh to uh",
    "start": "2030080",
    "end": "2038399"
  },
  {
    "text": "play with the cam server so there are",
    "start": "2038399",
    "end": "2044679"
  },
  {
    "text": "reo ID to large come server and uh you can see there are many interface we can",
    "start": "2044679",
    "end": "2052000"
  },
  {
    "text": "could try to use in uh IME",
    "start": "2052000",
    "end": "2057280"
  },
  {
    "text": "broker uh and this slide list uh press ID of come server with all application",
    "start": "2059960",
    "end": "2066679"
  },
  {
    "text": "package permission granted and also know the red light come with high",
    "start": "2066679",
    "end": "2073399"
  },
  {
    "text": "[Music]",
    "start": "2073400",
    "end": "2076518"
  },
  {
    "text": "privilege then how to uh find interface of cam",
    "start": "2079800",
    "end": "2087638"
  },
  {
    "text": "server the tool come view can help us emulate cam server interface this",
    "start": "2087639",
    "end": "2094079"
  },
  {
    "text": "picture show the interface is for by the UI host",
    "start": "2094079",
    "end": "2100240"
  },
  {
    "text": "class after got interface we need to get the functions come view can only retrieve",
    "start": "2102040",
    "end": "2109040"
  },
  {
    "text": "function v table address however ID pro can dig more details such as function",
    "start": "2109040",
    "end": "2115119"
  },
  {
    "text": "name and parameters see uh see the feature",
    "start": "2115119",
    "end": "2120720"
  },
  {
    "text": "so uh this feature shows the uh we now we have the class ID of the com server",
    "start": "2120720",
    "end": "2126480"
  },
  {
    "text": "and we also have the um function of the um com server and also we uh use ID pro",
    "start": "2126480",
    "end": "2133839"
  },
  {
    "text": "to see the um function name and also the parameters",
    "start": "2133839",
    "end": "2139440"
  },
  {
    "text": "now from this video we can know what function JIT debugging host to has",
    "start": "2139440",
    "end": "2145960"
  },
  {
    "text": "a as well as parameters [Music]",
    "start": "2145960",
    "end": "2152800"
  },
  {
    "text": "uh for testing come servers from metro sty app in is kind of tough jobs science",
    "start": "2152800",
    "end": "2161359"
  },
  {
    "text": "uh we need to write short call or assembly doing everything actually we",
    "start": "2161359",
    "end": "2167440"
  },
  {
    "text": "can test come server using desktop app because of three",
    "start": "2167440",
    "end": "2173119"
  },
  {
    "text": "reason it is much easier we can use most of APIs it's a better error handling use",
    "start": "2173119",
    "end": "2181760"
  },
  {
    "text": "desktop app we can do error handling easier debug we can attach count server",
    "start": "2181760",
    "end": "2188960"
  },
  {
    "text": "to debug we can know when server is crashed",
    "start": "2188960",
    "end": "2195800"
  },
  {
    "text": "yeah so um this uh picture shows that um you don't have to use uh when we when we",
    "start": "2196880",
    "end": "2203040"
  },
  {
    "text": "playing with the com server you don't have to use metro style because um because uh when you are sending um com",
    "start": "2203040",
    "end": "2209920"
  },
  {
    "text": "message to to um to broker process to uh or to com server uh in metro star app",
    "start": "2209920",
    "end": "2216560"
  },
  {
    "text": "you need to write sh code but so uh uh so uh we proposed idea that we can use a",
    "start": "2216560",
    "end": "2223119"
  },
  {
    "text": "desktop application which is much easier for",
    "start": "2223119",
    "end": "2227839"
  },
  {
    "text": "Uh in the next session we will show you how to attack wing art",
    "start": "2230079",
    "end": "2236470"
  },
  {
    "text": "[Music] API you must know API before fing it the",
    "start": "2236470",
    "end": "2242400"
  },
  {
    "text": "metro stab API can be carized in UI",
    "start": "2242400",
    "end": "2248079"
  },
  {
    "text": "device media communication and data and from dimensals",
    "start": "2248079",
    "end": "2255480"
  },
  {
    "text": "[Music] so",
    "start": "2255990",
    "end": "2261000"
  },
  {
    "text": "we testing put uh UI interface and the",
    "start": "2261000",
    "end": "2268760"
  },
  {
    "text": "device and the communication and data and",
    "start": "2268760",
    "end": "2275720"
  },
  {
    "text": "media and fundamentals then we uh outputed the",
    "start": "2275720",
    "end": "2282440"
  },
  {
    "text": "code as for the testing to wing RT we",
    "start": "2282440",
    "end": "2287520"
  },
  {
    "text": "can apply the same methods with other application fing such as internet sper",
    "start": "2287520",
    "end": "2295320"
  },
  {
    "text": "attempo agreement or text to all methods and see if something was going wrong",
    "start": "2295320",
    "end": "2303800"
  },
  {
    "text": "we we have to do is in iterating or",
    "start": "2303800",
    "end": "2309800"
  },
  {
    "text": "mutation and combination throughout each API each uh actually some memory",
    "start": "2309800",
    "end": "2319240"
  },
  {
    "text": "corporation can be caused the five line of code and this five lines uh uh we",
    "start": "2319240",
    "end": "2326240"
  },
  {
    "text": "report this uh vulnerability to Microsoft and this five five lines um of code can",
    "start": "2326240",
    "end": "2332280"
  },
  {
    "text": "crash a broker process according to our testing in",
    "start": "2332280",
    "end": "2341040"
  },
  {
    "text": "consumer preview version we have find a bug which lead to a memory",
    "start": "2341040",
    "end": "2348240"
  },
  {
    "text": "corporation and uh we use uh it's portable wind debug pluging to",
    "start": "2349960",
    "end": "2356720"
  },
  {
    "text": "investigate guy the this bug and found it to be portable",
    "start": "2356720",
    "end": "2364320"
  },
  {
    "text": "this picture shows called uh the world ptr ECX plus uh 18 and is sure public",
    "start": "2364320",
    "end": "2373760"
  },
  {
    "text": "explorable uh but unfortunately this bug was fixed uh in",
    "start": "2373760",
    "end": "2380480"
  },
  {
    "text": "release pre preview version we don't know we don't know uh",
    "start": "2380480",
    "end": "2386000"
  },
  {
    "text": "if there are chance to see it again in the future but it prove our testing",
    "start": "2386000",
    "end": "2392839"
  },
  {
    "text": "methods to be",
    "start": "2392839",
    "end": "2396320"
  },
  {
    "text": "workable all right so uh next section um uh yeah uh actually exploring major star",
    "start": "2399480",
    "end": "2406320"
  },
  {
    "text": "apps needs so much hard work um I I think it's not necessary uh not not",
    "start": "2406320",
    "end": "2412560"
  },
  {
    "text": "necessary to to write that like u something in kernel or to to do fuzzing",
    "start": "2412560",
    "end": "2418640"
  },
  {
    "text": "sometimes uh we are going to uh sometimes there are some easier way to bypassing box so uh we are going to show",
    "start": "2418640",
    "end": "2426000"
  },
  {
    "text": "you some design problems that uh we can still use to easily bypassing box we're",
    "start": "2426000",
    "end": "2431359"
  },
  {
    "text": "going to show you um how to bypass uh restrictions of uh internet connection",
    "start": "2431359",
    "end": "2437440"
  },
  {
    "text": "and uh we can I'm I'm going to show you the how to execute program and also",
    "start": "2437440",
    "end": "2443280"
  },
  {
    "text": "access file or folders that um even uh the um major uh the configuration",
    "start": "2443280",
    "end": "2449760"
  },
  {
    "text": "doesn't grant the permission okay so the first um bypass",
    "start": "2449760",
    "end": "2456400"
  },
  {
    "text": "internet connection a major star app doesn't have an internet capability is",
    "start": "2456400",
    "end": "2463040"
  },
  {
    "text": "it still can send information to internet",
    "start": "2463040",
    "end": "2468000"
  },
  {
    "text": "how the internet connection restriction of measur app uh only apply to itself so",
    "start": "2471960",
    "end": "2480000"
  },
  {
    "text": "we can still send data by opening an URL or HTML file or like MMS protocol using",
    "start": "2480000",
    "end": "2487760"
  },
  {
    "text": "uh the media um player to connect to internet so um other application will be",
    "start": "2487760",
    "end": "2494800"
  },
  {
    "text": "triggered when you when you open something and can connect to internet for you and can send data to internet as",
    "start": "2494800",
    "end": "2503079"
  },
  {
    "text": "well for example u we open yeah the URL will trigger um internet explorer or we",
    "start": "2503079",
    "end": "2510640"
  },
  {
    "text": "open MMS streaming and streaming link or open a document which uh embed some",
    "start": "2510640",
    "end": "2518160"
  },
  {
    "text": "component can could connect to internet so this way this way uh we can still",
    "start": "2518160",
    "end": "2523200"
  },
  {
    "text": "send information to internet even um metro star app uh doesn't has um doesn't",
    "start": "2523200",
    "end": "2529839"
  },
  {
    "text": "have the uh internet capabilities and here is the response",
    "start": "2529839",
    "end": "2535200"
  },
  {
    "text": "from MSRC they said uh such undesirable activities are highly uh detectable by",
    "start": "2535200",
    "end": "2542160"
  },
  {
    "text": "either user or every industry and once reported to Microsoft uh we have the",
    "start": "2542160",
    "end": "2548240"
  },
  {
    "text": "ability ability to remove the offending application from all users machine thus",
    "start": "2548240",
    "end": "2555200"
  },
  {
    "text": "uh protecting Windows 8",
    "start": "2555200",
    "end": "2558480"
  },
  {
    "text": "users but um I could give you a scenario like this um the first um the metro star",
    "start": "2560680",
    "end": "2568720"
  },
  {
    "text": "app um access uh the local sensitive information",
    "start": "2568720",
    "end": "2574800"
  },
  {
    "text": "sometimes m star app can access some information from local and because uh it",
    "start": "2574800",
    "end": "2580160"
  },
  {
    "text": "doesn't have internet aability so it can use some like open mms link and append",
    "start": "2580160",
    "end": "2586960"
  },
  {
    "text": "this sensitive information in the URL and send to internet so even metro app",
    "start": "2586960",
    "end": "2592160"
  },
  {
    "text": "doesn't have capability so still it still can send information to internet and um we don't we don't think that uh",
    "start": "2592160",
    "end": "2600560"
  },
  {
    "text": "users might uh be aware uh yeah do you Think will user be aware of the media",
    "start": "2600560",
    "end": "2606400"
  },
  {
    "text": "player is sending information to internet or they only know the media player is trying to play a video yeah",
    "start": "2606400",
    "end": "2614160"
  },
  {
    "text": "because it only can uh can see a media pop up yeah and um every every software",
    "start": "2614160",
    "end": "2622240"
  },
  {
    "text": "desktop software desktop security software is not easy to distinguish this",
    "start": "2622240",
    "end": "2627839"
  },
  {
    "text": "kind of behavior is malicious or not if we block off this kind of uh connection",
    "start": "2627839",
    "end": "2633839"
  },
  {
    "text": "uh it might cause some false alarm so it is still a chance for big",
    "start": "2633839",
    "end": "2641680"
  },
  {
    "text": "guys okay the second um bypass uh launch program limitation basically uh it is",
    "start": "2643000",
    "end": "2648880"
  },
  {
    "text": "not allowed to launch uh executable program in metro style app and now uh",
    "start": "2648880",
    "end": "2654880"
  },
  {
    "text": "I'm going to show you I'm I'm going to introduce uh three ways to by to bypass",
    "start": "2654880",
    "end": "2660240"
  },
  {
    "text": "uh program execution one two",
    "start": "2660240",
    "end": "2665400"
  },
  {
    "text": "three all right so the first uh the uh we can execute any program by inline",
    "start": "2665400",
    "end": "2671839"
  },
  {
    "text": "assembly or writing show code here is the example shows uh how we execute com",
    "start": "2671839",
    "end": "2678560"
  },
  {
    "text": "cmd.exe ES the command and you can",
    "start": "2678560",
    "end": "2683920"
  },
  {
    "text": "see yeah you can see the command is launched cmd is launched however it has",
    "start": "2691319",
    "end": "2697040"
  },
  {
    "text": "very uh limited um privilege even not able to not able to switch folder here",
    "start": "2697040",
    "end": "2703440"
  },
  {
    "text": "it want to switch to parent folder and access is denied",
    "start": "2703440",
    "end": "2709040"
  },
  {
    "text": "But anyway we we uh launched uh cmd success successfully and here you can",
    "start": "2710480",
    "end": "2716560"
  },
  {
    "text": "see the um the permission of the",
    "start": "2716560",
    "end": "2722920"
  },
  {
    "text": "cmd is app container so it's very limited",
    "start": "2722920",
    "end": "2728720"
  },
  {
    "text": "permission okay the second way uh click once package in our testing uh Windows",
    "start": "2730680",
    "end": "2736319"
  },
  {
    "text": "add a check file extension before before opening so um like exe or some other",
    "start": "2736319",
    "end": "2742880"
  },
  {
    "text": "executable file uh they are not allowed it to open to execute however um the",
    "start": "2742880",
    "end": "2749440"
  },
  {
    "text": "click once package application the file application or xbap file they are click",
    "start": "2749440",
    "end": "2756240"
  },
  {
    "text": "once package it is allowed to execute with higher permission um and can be",
    "start": "2756240",
    "end": "2762079"
  },
  {
    "text": "used to install files in the computer uh click once package is similar to the MSI",
    "start": "2762079",
    "end": "2768800"
  },
  {
    "text": "file it's a package and you can uh specify the files where you want to install",
    "start": "2768800",
    "end": "2775119"
  },
  {
    "text": "so yeah uh it is allowed to open this kind of file and you can specify some",
    "start": "2775119",
    "end": "2780480"
  },
  {
    "text": "actions here and with higher",
    "start": "2780480",
    "end": "2784640"
  },
  {
    "text": "permission okay the third way is the DL DLL hijacking and we found that uh",
    "start": "2785640",
    "end": "2792720"
  },
  {
    "text": "Internet Explorer in debug view debug view version of uh Windows 8 has a DL",
    "start": "2792720",
    "end": "2798560"
  },
  {
    "text": "hijacking vulnerability and drop a file and rename it to um trace",
    "start": "2798560",
    "end": "2804800"
  },
  {
    "text": "Uh",
    "start": "2804800",
    "end": "2807200"
  },
  {
    "text": "exN yeah you see I've traced extn.dl will be loaded from the desktop",
    "start": "2816119",
    "end": "2825799"
  },
  {
    "text": "so um this example shows that uh there might be some chance that you can find",
    "start": "2826560",
    "end": "2832079"
  },
  {
    "text": "some um D hijacking problems uh in some application not only internet explore",
    "start": "2832079",
    "end": "2838000"
  },
  {
    "text": "maybe office or some applications that you can launch from natural star app so",
    "start": "2838000",
    "end": "2844000"
  },
  {
    "text": "it is still possible okay so these three ways that",
    "start": "2844000",
    "end": "2849599"
  },
  {
    "text": "we can um execute our programs so MSRC",
    "start": "2849599",
    "end": "2856480"
  },
  {
    "text": "response yeah click once is the problem so they are going to fix in next Windows",
    "start": "2859800",
    "end": "2865520"
  },
  {
    "text": "8 release and for D hijacking uh we would uh they say when we would consider this",
    "start": "2865520",
    "end": "2872160"
  },
  {
    "text": "type of exploit a vulnerability in the desktop application rather than a",
    "start": "2872160",
    "end": "2878079"
  },
  {
    "text": "vulnerability in the metro starf or the platform so we continue it um to address",
    "start": "2878079",
    "end": "2885440"
  },
  {
    "text": "DOL hijacking bug in security updates as detailed in our security advis advisory",
    "start": "2885440",
    "end": "2891680"
  },
  {
    "text": "for insecure library loading yeah so um they are keeping keep",
    "start": "2891680",
    "end": "2896720"
  },
  {
    "text": "um uh investigating investigating this and fix the",
    "start": "2896720",
    "end": "2902160"
  },
  {
    "text": "problem okay okay the third uh the ne next um bypass file folder access uh",
    "start": "2902839",
    "end": "2908559"
  },
  {
    "text": "file in metro star app uh it is not allowed to access folders uh which is not specified in capability settings",
    "start": "2908559",
    "end": "2916000"
  },
  {
    "text": "even you grant permissions in capability settings there are only a few folders you can access like document uh video",
    "start": "2916000",
    "end": "2923200"
  },
  {
    "text": "music and photo so um how to bypass uh file folder",
    "start": "2923200",
    "end": "2931040"
  },
  {
    "text": "access let's see a demo",
    "start": "2931640",
    "end": "2935599"
  },
  {
    "text": "directive all right uh here you can see uh in the download folder there are some uh tools you have downloaded from",
    "start": "2947480",
    "end": "2955040"
  },
  {
    "text": "internet right so there are olay view debug and process explorer process",
    "start": "2955040",
    "end": "2961359"
  },
  {
    "text": "monitor now we launch the um process explorer yes this is the uh process",
    "start": "2961359",
    "end": "2968000"
  },
  {
    "text": "explorer and it's already debug yeah no problem is it is the only",
    "start": "2968000",
    "end": "2974839"
  },
  {
    "text": "debug all right now uh we uh we write uh we build um testing program testing",
    "start": "2974839",
    "end": "2982240"
  },
  {
    "text": "metro app and it is the we copy this uh we build uh this from uh it is a sample",
    "start": "2982240",
    "end": "2988720"
  },
  {
    "text": "from Windows SDK",
    "start": "2988720",
    "end": "2992440"
  },
  {
    "text": "and this app can uh download um download file from a remote address and you can",
    "start": "2994480",
    "end": "3000960"
  },
  {
    "text": "specify a file name a local file name here so this is very simple um",
    "start": "3000960",
    "end": "3008240"
  },
  {
    "text": "program so now we download file from our um iOS server and there is a welcome.png",
    "start": "3011079",
    "end": "3019599"
  },
  {
    "text": "png picture and we name it to",
    "start": "3019599",
    "end": "3025960"
  },
  {
    "text": "demo.png start download okay now pop up uh there is um",
    "start": "3025960",
    "end": "3034680"
  },
  {
    "text": "um file picker uh pop",
    "start": "3034680",
    "end": "3038960"
  },
  {
    "text": "up and here shows the files uh uh here's download folder and um here uh there's a",
    "start": "3040520",
    "end": "3048319"
  },
  {
    "text": "button and then download of course we click click this and after that uh there",
    "start": "3048319",
    "end": "3053599"
  },
  {
    "text": "is okay button we click okay now the picture is",
    "start": "3053599",
    "end": "3060760"
  },
  {
    "text": "downloaded yeah no problem",
    "start": "3060760",
    "end": "3065319"
  },
  {
    "text": "okay then uh then we go to the download folder to see again the picture is",
    "start": "3066800",
    "end": "3075480"
  },
  {
    "text": "okay but when we open the process explorer it has been changed to",
    "start": "3075480",
    "end": "3084640"
  },
  {
    "text": "calculator and also only debug the same has been changed has been",
    "start": "3085160",
    "end": "3091440"
  },
  {
    "text": "replaced to other binaries yeah so all executable in this",
    "start": "3091440",
    "end": "3096559"
  },
  {
    "text": "folder are replaced by probably uh malicious",
    "start": "3096559",
    "end": "3102800"
  },
  {
    "text": "programs okay so do you think uh in this scenario uh where user um uh notice",
    "start": "3106280",
    "end": "3112400"
  },
  {
    "text": "something um weird or something um bad here so I'm going to show you why",
    "start": "3112400",
    "end": "3122440"
  },
  {
    "text": "so um there is um except the file file um file um file restriction file access",
    "start": "3123920",
    "end": "3131920"
  },
  {
    "text": "restriction there is one exception the file picker this is um a broker process it is a broker",
    "start": "3131920",
    "end": "3140240"
  },
  {
    "text": "broker process with a median permission so uh um Metro style app uh provide this",
    "start": "3140240",
    "end": "3147680"
  },
  {
    "text": "uh broker for users that uh users that users can like uh that uh developer can",
    "start": "3147680",
    "end": "3154960"
  },
  {
    "text": "uh with users permission users grant permission that that let them can access",
    "start": "3154960",
    "end": "3160640"
  },
  {
    "text": "other folders except capability settings so even you didn't grant file access uh",
    "start": "3160640",
    "end": "3165760"
  },
  {
    "text": "permission to app the app still can use a set pick file or pick folder to let user choose",
    "start": "3165760",
    "end": "3174160"
  },
  {
    "text": "folders they want to access so user have to click okay such as save file in user",
    "start": "3174160",
    "end": "3182160"
  },
  {
    "text": "specific folders like save files in download folder or in desktop so after",
    "start": "3182160",
    "end": "3187599"
  },
  {
    "text": "user clicking okay the app can have full full control of the folder with broker",
    "start": "3187599",
    "end": "3194559"
  },
  {
    "text": "process permission yeah so that's why um our app",
    "start": "3194559",
    "end": "3200319"
  },
  {
    "text": "can have access to download folder and and we can take full control of the",
    "start": "3200319",
    "end": "3207760"
  },
  {
    "text": "folder yeah this shows the file picker uh user interface",
    "start": "3208520",
    "end": "3215160"
  },
  {
    "text": "all right so uh MSRC's uh respond um there this is a deliberate feature and",
    "start": "3216800",
    "end": "3225680"
  },
  {
    "text": "fully under uh the user the user control users should not",
    "start": "3225680",
    "end": "3232720"
  },
  {
    "text": "click okay to the file picker dialogue if they do not want the app to have",
    "start": "3232720",
    "end": "3237760"
  },
  {
    "text": "access to that folder tree we consider this under the users's control and as",
    "start": "3237760",
    "end": "3244079"
  },
  {
    "text": "such do not view it as a threat so",
    "start": "3244079",
    "end": "3249480"
  },
  {
    "text": "um yeah do you agree uh yeah because uh in our scenario um users doesn't aware",
    "start": "3249480",
    "end": "3255680"
  },
  {
    "text": "anything just just uh download a file and they just click okay and this trick",
    "start": "3255680",
    "end": "3262079"
  },
  {
    "text": "can be with some um some social engineering trick",
    "start": "3262079",
    "end": "3270440"
  },
  {
    "text": "[Music]",
    "start": "3272690",
    "end": "3275789"
  },
  {
    "text": "let me show you another example",
    "start": "3278240",
    "end": "3282440"
  },
  {
    "text": "so we start to build this",
    "start": "3283839",
    "end": "3287440"
  },
  {
    "text": "application and here is spar picker you see and and the folder now is",
    "start": "3293960",
    "end": "3301039"
  },
  {
    "text": "desktop so uh we can use some trick here that uh we user choose other",
    "start": "3303319",
    "end": "3310760"
  },
  {
    "text": "folder we doesn't allow we just uh please ask them please select select desktop then we can guide them to to the",
    "start": "3310760",
    "end": "3319280"
  },
  {
    "text": "folder we want to access please select",
    "start": "3319280",
    "end": "3324359"
  },
  {
    "text": "desktop so they have to choose okay",
    "start": "3324359",
    "end": "3329200"
  },
  {
    "text": "desktop okay so then and now we can access the um desktop folder and the",
    "start": "3329480",
    "end": "3335520"
  },
  {
    "text": "application is going to uh list all files from",
    "start": "3335520",
    "end": "3340880"
  },
  {
    "text": "desktop yeah list all files from desktop so uh with some social engineering trick",
    "start": "3341800",
    "end": "3346960"
  },
  {
    "text": "uh we can leverage this feature and big guy might use this as",
    "start": "3346960",
    "end": "3354720"
  },
  {
    "text": "well all right so conclusion um uh in this talk we introduce the security",
    "start": "3358520",
    "end": "3364160"
  },
  {
    "text": "design of app container and the methodology of metro star app vulnerability discovery how do we find",
    "start": "3364160",
    "end": "3370720"
  },
  {
    "text": "the problem how do we um uh to discover uh issues uh from different layers and",
    "start": "3370720",
    "end": "3377359"
  },
  {
    "text": "we also disclose some issues we have discovered and so there are some discussion security versus uh",
    "start": "3377359",
    "end": "3384559"
  },
  {
    "text": "convenience um a is it a never solve problem because sometimes we want to give more convenience for users for",
    "start": "3384559",
    "end": "3392200"
  },
  {
    "text": "developers there might have some security compromise right so and for the",
    "start": "3392200",
    "end": "3398720"
  },
  {
    "text": "file picker problem do user really know what will happen after clicking okay so",
    "start": "3398720",
    "end": "3404480"
  },
  {
    "text": "give user um permission or let user to make decision is it correct or yeah is",
    "start": "3404480",
    "end": "3411920"
  },
  {
    "text": "it a problem for users that yeah because most of users might not be aware of the",
    "start": "3411920",
    "end": "3421119"
  },
  {
    "text": "threat all right thanks uh this is our presentation about Windows 8 measures",
    "start": "3422119",
    "end": "3427359"
  },
  {
    "text": "app thank you thank you for listening",
    "start": "3427359",
    "end": "3431720"
  }
]