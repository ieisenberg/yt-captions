[
  {
    "text": "thank you all for being here I'm very",
    "start": "269",
    "end": "3600"
  },
  {
    "text": "excited to talk about this which is",
    "start": "3600",
    "end": "8300"
  },
  {
    "text": "braking braking boot loaders on the",
    "start": "8300",
    "end": "11280"
  },
  {
    "text": "cheap so we will talk about how we can",
    "start": "11280",
    "end": "15630"
  },
  {
    "text": "sometimes break embedded devices boot",
    "start": "15630",
    "end": "18449"
  },
  {
    "text": "loaders with just some cheap stuff or",
    "start": "18449",
    "end": "22320"
  },
  {
    "text": "straightforward stuff without using any",
    "start": "22320",
    "end": "26550"
  },
  {
    "text": "hard work equipment or sometimes",
    "start": "26550",
    "end": "29039"
  },
  {
    "text": "expensive stuff so first of all who we",
    "start": "29039",
    "end": "32398"
  },
  {
    "text": "are",
    "start": "32399",
    "end": "32820"
  },
  {
    "text": "I'm Cassie Mesa I'm a security",
    "start": "32820",
    "end": "34469"
  },
  {
    "text": "researcher I love anything related to",
    "start": "34469",
    "end": "37410"
  },
  {
    "text": "reverse engineering I have a strong",
    "start": "37410",
    "end": "39600"
  },
  {
    "text": "background in low-level security",
    "start": "39600",
    "end": "41070"
  },
  {
    "text": "research I've done this research with",
    "start": "41070",
    "end": "44309"
  },
  {
    "text": "David Oswald who is an associate",
    "start": "44309",
    "end": "46620"
  },
  {
    "text": "professor in the University of",
    "start": "46620",
    "end": "48059"
  },
  {
    "text": "Birmingham he has done a lot a lot of",
    "start": "48059",
    "end": "50910"
  },
  {
    "text": "research on embedded devices security",
    "start": "50910",
    "end": "53489"
  },
  {
    "text": "and hardware attacks and yes we have",
    "start": "53489",
    "end": "57059"
  },
  {
    "text": "David here as well and ok so just to",
    "start": "57059",
    "end": "61829"
  },
  {
    "text": "give an introduction so emply devices",
    "start": "61829",
    "end": "66119"
  },
  {
    "text": "and IOT devices are publicly available",
    "start": "66119",
    "end": "68689"
  },
  {
    "text": "and sometimes it's hard to put them in a",
    "start": "68689",
    "end": "72450"
  },
  {
    "text": "restricted environment so sometimes they",
    "start": "72450",
    "end": "76409"
  },
  {
    "text": "can't be processing some sensitive data",
    "start": "76409",
    "end": "78450"
  },
  {
    "text": "or some sort of encryption keys and",
    "start": "78450",
    "end": "82170"
  },
  {
    "text": "stuff like that so companies started",
    "start": "82170",
    "end": "84600"
  },
  {
    "text": "putting kind of like a logical lock on",
    "start": "84600",
    "end": "88380"
  },
  {
    "text": "on these days in these devices just to",
    "start": "88380",
    "end": "92750"
  },
  {
    "text": "prevent and put some restrictions to",
    "start": "92750",
    "end": "96450"
  },
  {
    "text": "prevent attackers from reading what's",
    "start": "96450",
    "end": "98400"
  },
  {
    "text": "inside these devices so they call it",
    "start": "98400",
    "end": "101130"
  },
  {
    "text": "code reader protection there are",
    "start": "101130",
    "end": "103079"
  },
  {
    "text": "different naming conventions from",
    "start": "103079",
    "end": "105540"
  },
  {
    "text": "different companies yes",
    "start": "105540",
    "end": "108630"
  },
  {
    "text": "so the bootloader that resides on the",
    "start": "108630",
    "end": "111030"
  },
  {
    "text": "rom of these devices is responsible of",
    "start": "111030",
    "end": "114420"
  },
  {
    "text": "checking if this protection is enabled",
    "start": "114420",
    "end": "117360"
  },
  {
    "text": "or not so it will decide to impose",
    "start": "117360",
    "end": "121310"
  },
  {
    "text": "restrictions and the device or not so",
    "start": "121310",
    "end": "124320"
  },
  {
    "text": "embedded boot loaders not like any other",
    "start": "124320",
    "end": "127560"
  },
  {
    "text": "bootloader they were not just like",
    "start": "127560",
    "end": "130039"
  },
  {
    "text": "initialize the device and stuff like",
    "start": "130039",
    "end": "134430"
  },
  {
    "text": "they are kind of dumped and we have to",
    "start": "134430",
    "end": "137160"
  },
  {
    "text": "tell them what they should do so there",
    "start": "137160",
    "end": "139530"
  },
  {
    "text": "are some bootloader commands that we can",
    "start": "139530",
    "end": "142440"
  },
  {
    "text": "use them to prove to program the device",
    "start": "142440",
    "end": "144390"
  },
  {
    "text": "read from the device do a lot of stuff",
    "start": "144390",
    "end": "148710"
  },
  {
    "text": "so so our research in our research we",
    "start": "148710",
    "end": "155010"
  },
  {
    "text": "grabbed three embedded devices the STM",
    "start": "155010",
    "end": "158580"
  },
  {
    "text": "eight which is based on some 8-bit",
    "start": "158580",
    "end": "162770"
  },
  {
    "text": "microcosm microarchitecture from",
    "start": "162770",
    "end": "165950"
  },
  {
    "text": "stmicroelectronics and the stm32 and LPC",
    "start": "165950",
    "end": "170190"
  },
  {
    "text": "one three four three there are two",
    "start": "170190",
    "end": "171960"
  },
  {
    "text": "widely used devices and they are both of",
    "start": "171960",
    "end": "174870"
  },
  {
    "text": "them are armed based so our research",
    "start": "174870",
    "end": "178800"
  },
  {
    "text": "results showed that the LPC one 343 has",
    "start": "178800",
    "end": "182430"
  },
  {
    "text": "a critical vulnerability in one of the",
    "start": "182430",
    "end": "184230"
  },
  {
    "text": "command commands which is the right to",
    "start": "184230",
    "end": "186240"
  },
  {
    "text": "ram command and also not only this",
    "start": "186240",
    "end": "190350"
  },
  {
    "text": "device Delpy c13 4 3 is affected others",
    "start": "190350",
    "end": "193980"
  },
  {
    "text": "other devices from the same family and",
    "start": "193980",
    "end": "195930"
  },
  {
    "text": "the LPC family are affected unless they",
    "start": "195930",
    "end": "198270"
  },
  {
    "text": "are using the memory management",
    "start": "198270",
    "end": "199940"
  },
  {
    "text": "sorry memory protection unit and we",
    "start": "199940",
    "end": "203820"
  },
  {
    "text": "managed to bypass some checks in the LPC",
    "start": "203820",
    "end": "208350"
  },
  {
    "text": "device that allowed us to break the",
    "start": "208350",
    "end": "212160"
  },
  {
    "text": "security of the device at least",
    "start": "212160",
    "end": "214560"
  },
  {
    "text": "depending on our research we found that",
    "start": "214560",
    "end": "216450"
  },
  {
    "text": "the STM 8 and the stm32 are secured",
    "start": "216450",
    "end": "221280"
  },
  {
    "text": "against",
    "start": "221280",
    "end": "222620"
  },
  {
    "text": "logical attacks and software based",
    "start": "222620",
    "end": "225240"
  },
  {
    "text": "attacks so just to give a little bit of",
    "start": "225240",
    "end": "229170"
  },
  {
    "text": "background about embedded stuff so",
    "start": "229170",
    "end": "231210"
  },
  {
    "text": "basically this graph explains how",
    "start": "231210",
    "end": "234780"
  },
  {
    "text": "embedded devices bootloaders work so at",
    "start": "234780",
    "end": "237780"
  },
  {
    "text": "first we whenever the device is",
    "start": "237780",
    "end": "240660"
  },
  {
    "text": "initialized or reset so the first thing",
    "start": "240660",
    "end": "244350"
  },
  {
    "text": "that it does as we said it checks if the",
    "start": "244350",
    "end": "246540"
  },
  {
    "text": "cord protection is enabled and if yes it",
    "start": "246540",
    "end": "250290"
  },
  {
    "text": "will impose some restrictions and on the",
    "start": "250290",
    "end": "252450"
  },
  {
    "text": "device so it will not allow as we can",
    "start": "252450",
    "end": "256140"
  },
  {
    "text": "see here the read command or the write",
    "start": "256140",
    "end": "258660"
  },
  {
    "text": "command or all that stuff and also there",
    "start": "258660",
    "end": "262440"
  },
  {
    "text": "are two ways whenever the bootloader is",
    "start": "262440",
    "end": "264270"
  },
  {
    "text": "initialized it can go",
    "start": "264270",
    "end": "266160"
  },
  {
    "text": "to the jump to the user code that you",
    "start": "266160",
    "end": "269970"
  },
  {
    "text": "flash Datanet or something or you can",
    "start": "269970",
    "end": "273090"
  },
  {
    "text": "enter the communication mode this mode",
    "start": "273090",
    "end": "276060"
  },
  {
    "text": "is where you start control the device",
    "start": "276060",
    "end": "279240"
  },
  {
    "text": "giving it commands and stuff like that",
    "start": "279240",
    "end": "282360"
  },
  {
    "text": "here we're code reader protection comes",
    "start": "282360",
    "end": "284310"
  },
  {
    "text": "in place here whereas the bootloader can",
    "start": "284310",
    "end": "288420"
  },
  {
    "text": "control and specify which commands that",
    "start": "288420",
    "end": "291870"
  },
  {
    "text": "you are allowed to do depending on the",
    "start": "291870",
    "end": "294570"
  },
  {
    "text": "code protection level that is configured",
    "start": "294570",
    "end": "298490"
  },
  {
    "text": "so we are we are saying that we analyze",
    "start": "298490",
    "end": "301260"
  },
  {
    "text": "bootloaders about how so it's pretty",
    "start": "301260",
    "end": "304830"
  },
  {
    "text": "simple sometimes so if we have a device",
    "start": "304830",
    "end": "307340"
  },
  {
    "text": "definitely you'll have not definitely",
    "start": "307340",
    "end": "310290"
  },
  {
    "text": "but mostly we'll have a datasheet for it",
    "start": "310290",
    "end": "312720"
  },
  {
    "text": "and this datasheet will has inside it",
    "start": "312720",
    "end": "315720"
  },
  {
    "text": "the memory mapping of the device so",
    "start": "315720",
    "end": "317760"
  },
  {
    "text": "basically we just look at the ROM and",
    "start": "317760",
    "end": "321570"
  },
  {
    "text": "see from from where it starts and where",
    "start": "321570",
    "end": "324750"
  },
  {
    "text": "it ends and then we flush some code that",
    "start": "324750",
    "end": "327750"
  },
  {
    "text": "looks like this that reads from that",
    "start": "327750",
    "end": "331620"
  },
  {
    "text": "address to this address and print the",
    "start": "331620",
    "end": "335520"
  },
  {
    "text": "contents of the ROM via UART",
    "start": "335520",
    "end": "338670"
  },
  {
    "text": "in to our serial terminal and yeah so",
    "start": "338670",
    "end": "343650"
  },
  {
    "text": "let's get started with our results for",
    "start": "343650",
    "end": "345780"
  },
  {
    "text": "the three devices so for first of all",
    "start": "345780",
    "end": "351750"
  },
  {
    "text": "the SDM eight so the SDM eight has just",
    "start": "351750",
    "end": "356130"
  },
  {
    "text": "one level of protection doesn't have any",
    "start": "356130",
    "end": "358740"
  },
  {
    "text": "other levels so just have one thing",
    "start": "358740",
    "end": "360870"
  },
  {
    "text": "whenever it's enabled it blocks any",
    "start": "360870",
    "end": "363600"
  },
  {
    "text": "communication with the bootloader so you",
    "start": "363600",
    "end": "365970"
  },
  {
    "text": "cannot connect contact the bootloader so",
    "start": "365970",
    "end": "368730"
  },
  {
    "text": "it's not like oh if the protection is",
    "start": "368730",
    "end": "370560"
  },
  {
    "text": "enabled you are still allowed to do some",
    "start": "370560",
    "end": "372570"
  },
  {
    "text": "commands no it just prevents you from",
    "start": "372570",
    "end": "376460"
  },
  {
    "text": "doing any communication in the",
    "start": "376460",
    "end": "378720"
  },
  {
    "text": "bootloader and directly jumps to the",
    "start": "378720",
    "end": "380820"
  },
  {
    "text": "user code here in the assembly snippet",
    "start": "380820",
    "end": "383190"
  },
  {
    "text": "we can see that is loading some values",
    "start": "383190",
    "end": "386430"
  },
  {
    "text": "from the address four eight zero zero",
    "start": "386430",
    "end": "389210"
  },
  {
    "text": "this is the others where the code",
    "start": "389210",
    "end": "391800"
  },
  {
    "text": "protection value is flashed so depending",
    "start": "391800",
    "end": "395550"
  },
  {
    "text": "on this value here it will compare it",
    "start": "395550",
    "end": "398100"
  },
  {
    "text": "and decide to and",
    "start": "398100",
    "end": "399870"
  },
  {
    "text": "the bootloader or run the user code so",
    "start": "399870",
    "end": "403980"
  },
  {
    "text": "it's a pretty simple device not a lot of",
    "start": "403980",
    "end": "406410"
  },
  {
    "text": "features so yeah that's so we think it's",
    "start": "406410",
    "end": "410160"
  },
  {
    "text": "secure because it doesn't allow any any",
    "start": "410160",
    "end": "412650"
  },
  {
    "text": "communication with the a with the",
    "start": "412650",
    "end": "414120"
  },
  {
    "text": "bootloader whenever the protection is",
    "start": "414120",
    "end": "415770"
  },
  {
    "text": "enabled so we go for the",
    "start": "415770",
    "end": "418310"
  },
  {
    "text": "stm32 so stm32 it has three levels of",
    "start": "418310",
    "end": "425430"
  },
  {
    "text": "brittle of protection from low lowest",
    "start": "425430",
    "end": "429830"
  },
  {
    "text": "restrictions to highest restrictions so",
    "start": "429830",
    "end": "433020"
  },
  {
    "text": "in every bootloader command function it",
    "start": "433020",
    "end": "436140"
  },
  {
    "text": "checks if the protection is enabled or",
    "start": "436140",
    "end": "439200"
  },
  {
    "text": "not",
    "start": "439200",
    "end": "439680"
  },
  {
    "text": "that's how checks for the further",
    "start": "439680",
    "end": "442200"
  },
  {
    "text": "protection so here's an snippet of the",
    "start": "442200",
    "end": "445280"
  },
  {
    "text": "simply code so here's the right to ram",
    "start": "445280",
    "end": "448410"
  },
  {
    "text": "command the beginning of it the first",
    "start": "448410",
    "end": "450570"
  },
  {
    "text": "thing that it does after the post",
    "start": "450570",
    "end": "452010"
  },
  {
    "text": "instruction it caused the function that",
    "start": "452010",
    "end": "455160"
  },
  {
    "text": "called that checks if the protection is",
    "start": "455160",
    "end": "457560"
  },
  {
    "text": "enabled stmicroelectronics call it our",
    "start": "457560",
    "end": "460200"
  },
  {
    "text": "DB read out protection as we said",
    "start": "460200",
    "end": "462540"
  },
  {
    "text": "different naming conventions and then it",
    "start": "462540",
    "end": "465030"
  },
  {
    "text": "decides to stop the command or or",
    "start": "465030",
    "end": "467880"
  },
  {
    "text": "allowed also it doesn't allow any",
    "start": "467880",
    "end": "471660"
  },
  {
    "text": "writing into memory or RAM even with the",
    "start": "471660",
    "end": "476730"
  },
  {
    "text": "lowest protection level we will see how",
    "start": "476730",
    "end": "479940"
  },
  {
    "text": "this is beneficial in the upcoming",
    "start": "479940",
    "end": "481890"
  },
  {
    "text": "slides also these are code only allowed",
    "start": "481890",
    "end": "484950"
  },
  {
    "text": "to access specific areas",
    "start": "484950",
    "end": "487460"
  },
  {
    "text": "in the memory so that's all for the",
    "start": "487460",
    "end": "490760"
  },
  {
    "text": "stm32 now we go for the interesting",
    "start": "490760",
    "end": "494510"
  },
  {
    "text": "stuff for the LPC guy yes so here is our",
    "start": "494510",
    "end": "499550"
  },
  {
    "text": "setup for exploitation so it's just a",
    "start": "499550",
    "end": "504080"
  },
  {
    "text": "UART cable straightforward and know any",
    "start": "504080",
    "end": "509810"
  },
  {
    "text": "glitching or that stuff so first of all",
    "start": "509810",
    "end": "514219"
  },
  {
    "text": "we will speak about previa the previous",
    "start": "514219",
    "end": "516650"
  },
  {
    "text": "research that has been done on LPC",
    "start": "516650",
    "end": "519650"
  },
  {
    "text": "family from NXP so basically I think",
    "start": "519650",
    "end": "523729"
  },
  {
    "text": "last year Chris Galinsky done some",
    "start": "523729",
    "end": "526400"
  },
  {
    "text": "research on this device and he found he",
    "start": "526400",
    "end": "530779"
  },
  {
    "text": "managed to break a code protection level",
    "start": "530779",
    "end": "533480"
  },
  {
    "text": "one on this device that we have here and",
    "start": "533480",
    "end": "537220"
  },
  {
    "text": "yes but he managed to break it using a",
    "start": "537220",
    "end": "540410"
  },
  {
    "text": "glitching attack fletching attacks",
    "start": "540410",
    "end": "542060"
  },
  {
    "text": "sometimes can be complicated and",
    "start": "542060",
    "end": "544460"
  },
  {
    "text": "sometimes you are forced to use some",
    "start": "544460",
    "end": "547390"
  },
  {
    "text": "expensive equipment and stuff like that",
    "start": "547390",
    "end": "549850"
  },
  {
    "text": "so in the upcoming slides we will show",
    "start": "549850",
    "end": "553100"
  },
  {
    "text": "how we broke the same level of",
    "start": "553100",
    "end": "555140"
  },
  {
    "text": "protection with the just software based",
    "start": "555140",
    "end": "557360"
  },
  {
    "text": "attacks attack without any use of",
    "start": "557360",
    "end": "561080"
  },
  {
    "text": "hardware attacks and also Chris found",
    "start": "561080",
    "end": "563900"
  },
  {
    "text": "that the code protection like any other",
    "start": "563900",
    "end": "566660"
  },
  {
    "text": "device is configured in some area and",
    "start": "566660",
    "end": "570680"
  },
  {
    "text": "some others in the flash and it gets",
    "start": "570680",
    "end": "573230"
  },
  {
    "text": "loaded inside the memory address 184 and",
    "start": "573230",
    "end": "577760"
  },
  {
    "text": "then compares this address 184 with the",
    "start": "577760",
    "end": "581740"
  },
  {
    "text": "actual configured coded protection value",
    "start": "581740",
    "end": "585380"
  },
  {
    "text": "to decide if the if the code protection",
    "start": "585380",
    "end": "590450"
  },
  {
    "text": "is enabled or not so yes basically how",
    "start": "590450",
    "end": "593029"
  },
  {
    "text": "this is how checks so yes like the stm32",
    "start": "593029",
    "end": "596990"
  },
  {
    "text": "of PC 1 3 4 3 has 3 levels of",
    "start": "596990",
    "end": "599630"
  },
  {
    "text": "protections and it has CRP one CRP to",
    "start": "599630",
    "end": "604730"
  },
  {
    "text": "CRP 3 with more restrictions CRP 3 it",
    "start": "604730",
    "end": "608630"
  },
  {
    "text": "doesn't allow anything as we can see yes",
    "start": "608630",
    "end": "612490"
  },
  {
    "text": "developers when they program these",
    "start": "612490",
    "end": "615920"
  },
  {
    "text": "devices they don't really know sometimes",
    "start": "615920",
    "end": "618500"
  },
  {
    "text": "the difference between",
    "start": "618500",
    "end": "620690"
  },
  {
    "text": "these different protection levels so",
    "start": "620690",
    "end": "622790"
  },
  {
    "text": "will they will go with the easiest one",
    "start": "622790",
    "end": "624560"
  },
  {
    "text": "to do or to program which is the CRP",
    "start": "624560",
    "end": "628160"
  },
  {
    "text": "level one the interesting thing",
    "start": "628160",
    "end": "631310"
  },
  {
    "text": "unlike the stm32 the the LPC 1 3 4 3 it",
    "start": "631310",
    "end": "636680"
  },
  {
    "text": "still allows the right to ram command",
    "start": "636680",
    "end": "638720"
  },
  {
    "text": "even when CRP level 1 is protection part",
    "start": "638720",
    "end": "643579"
  },
  {
    "text": "with some restrictions it's not allowed",
    "start": "643579",
    "end": "646250"
  },
  {
    "text": "to ride or neither says less than 300",
    "start": "646250",
    "end": "648470"
  },
  {
    "text": "inside the RAM why because as we saw in",
    "start": "648470",
    "end": "651800"
  },
  {
    "text": "the previous slide the the core the",
    "start": "651800",
    "end": "654649"
  },
  {
    "text": "protection value gets loaded in air",
    "start": "654649",
    "end": "656509"
  },
  {
    "text": "there's 184 inside the inside the ramp",
    "start": "656509",
    "end": "659300"
  },
  {
    "text": "so that these addresses basically four",
    "start": "659300",
    "end": "662509"
  },
  {
    "text": "code reader protection values and",
    "start": "662509",
    "end": "665350"
  },
  {
    "text": "bootloader stuff so it allows you to",
    "start": "665350",
    "end": "668060"
  },
  {
    "text": "write inside the RAM just it needs to",
    "start": "668060",
    "end": "671810"
  },
  {
    "text": "protect the the bootloader stuff also",
    "start": "671810",
    "end": "674600"
  },
  {
    "text": "another thing the read memory is not",
    "start": "674600",
    "end": "676850"
  },
  {
    "text": "allowed at all and even with the lowest",
    "start": "676850",
    "end": "678769"
  },
  {
    "text": "level of protection so here's the memory",
    "start": "678769",
    "end": "683089"
  },
  {
    "text": "layout of the of the LPC as we can see",
    "start": "683089",
    "end": "686300"
  },
  {
    "text": "here the address is less than 300 they",
    "start": "686300",
    "end": "688970"
  },
  {
    "text": "have the CRP value and the bootloader",
    "start": "688970",
    "end": "691519"
  },
  {
    "text": "stuff inside them and in the other area",
    "start": "691519",
    "end": "694279"
  },
  {
    "text": "of this tab of the of the of the RAM we",
    "start": "694279",
    "end": "697279"
  },
  {
    "text": "have the stack area on the other end of",
    "start": "697279",
    "end": "700370"
  },
  {
    "text": "the ramp so so basically after this we",
    "start": "700370",
    "end": "708319"
  },
  {
    "text": "we analyze the device and we found that",
    "start": "708319",
    "end": "711709"
  },
  {
    "text": "it's yes it's doing proper checks if you",
    "start": "711709",
    "end": "715880"
  },
  {
    "text": "are writing gonna address is less than",
    "start": "715880",
    "end": "718370"
  },
  {
    "text": "300 or not but we didn't find any checks",
    "start": "718370",
    "end": "724430"
  },
  {
    "text": "if someone is trying to touch the stack",
    "start": "724430",
    "end": "728569"
  },
  {
    "text": "or trying to write and addresses that at",
    "start": "728569",
    "end": "733490"
  },
  {
    "text": "addresses that belong to the stack so",
    "start": "733490",
    "end": "736720"
  },
  {
    "text": "here the vulnerability was here so we",
    "start": "736720",
    "end": "742009"
  },
  {
    "text": "managed to break the code protection",
    "start": "742009",
    "end": "744050"
  },
  {
    "text": "using return-oriented programming as we",
    "start": "744050",
    "end": "749209"
  },
  {
    "text": "will see in the upcoming slides so yes",
    "start": "749209",
    "end": "752059"
  },
  {
    "text": "here is",
    "start": "752059",
    "end": "753320"
  },
  {
    "text": "the assembly code it checks if CRP is",
    "start": "753320",
    "end": "758660"
  },
  {
    "text": "enabled if it's enable that go to it",
    "start": "758660",
    "end": "761030"
  },
  {
    "text": "jumps to this check to check if the",
    "start": "761030",
    "end": "765950"
  },
  {
    "text": "address is less than 300 or not and the",
    "start": "765950",
    "end": "769460"
  },
  {
    "text": "jumps and execute the command if the",
    "start": "769460",
    "end": "772100"
  },
  {
    "text": "address is above than 300 also here's",
    "start": "772100",
    "end": "777740"
  },
  {
    "text": "the the interesting part",
    "start": "777740",
    "end": "780080"
  },
  {
    "text": "no stack area protection we can see here",
    "start": "780080",
    "end": "783290"
  },
  {
    "text": "start writing to memory directly and",
    "start": "783290",
    "end": "787640"
  },
  {
    "text": "above there there are no checks that are",
    "start": "787640",
    "end": "791810"
  },
  {
    "text": "being done or anything to protect the",
    "start": "791810",
    "end": "794660"
  },
  {
    "text": "stack so we can see it just takes the",
    "start": "794660",
    "end": "797360"
  },
  {
    "text": "input string the bytes that we want to",
    "start": "797360",
    "end": "798950"
  },
  {
    "text": "write and directly starts writing",
    "start": "798950",
    "end": "801250"
  },
  {
    "text": "without any checks so okay",
    "start": "801250",
    "end": "805900"
  },
  {
    "text": "unlike the stm32 stm32 when when when",
    "start": "805900",
    "end": "810830"
  },
  {
    "text": "you call a command it jumps directly to",
    "start": "810830",
    "end": "815480"
  },
  {
    "text": "the like to the right command or to the",
    "start": "815480",
    "end": "817430"
  },
  {
    "text": "read command or stuff like that for the",
    "start": "817430",
    "end": "820220"
  },
  {
    "text": "LPC 1 3 4 3 there is a command handler",
    "start": "820220",
    "end": "824450"
  },
  {
    "text": "that accepts the commands and depending",
    "start": "824450",
    "end": "829700"
  },
  {
    "text": "on the CRP level that configure this",
    "start": "829700",
    "end": "831740"
  },
  {
    "text": "command handler will decide to block",
    "start": "831740",
    "end": "834650"
  },
  {
    "text": "this command or not so this resulted in",
    "start": "834650",
    "end": "840370"
  },
  {
    "text": "some command functions they don't have",
    "start": "840370",
    "end": "843740"
  },
  {
    "text": "any code protection code protection",
    "start": "843740",
    "end": "847970"
  },
  {
    "text": "checks inside them as we saw in the",
    "start": "847970",
    "end": "850670"
  },
  {
    "text": "stm32 like the write command there are",
    "start": "850670",
    "end": "855770"
  },
  {
    "text": "checks inside it but here since the",
    "start": "855770",
    "end": "860030"
  },
  {
    "text": "command handler is responsible for",
    "start": "860030",
    "end": "861740"
  },
  {
    "text": "checking some functions specially the",
    "start": "861740",
    "end": "865400"
  },
  {
    "text": "read command which is the interesting",
    "start": "865400",
    "end": "867590"
  },
  {
    "text": "function doesn't have any code coded",
    "start": "867590",
    "end": "871220"
  },
  {
    "text": "protection inside it so at first ok we",
    "start": "871220",
    "end": "876470"
  },
  {
    "text": "found the vulnerability in the assembly",
    "start": "876470",
    "end": "879650"
  },
  {
    "text": "so now we want to exploit it so at first",
    "start": "879650",
    "end": "882110"
  },
  {
    "text": "we try to build some kind of exploit",
    "start": "882110",
    "end": "886490"
  },
  {
    "text": "to exploit the device before in there",
    "start": "886490",
    "end": "889070"
  },
  {
    "text": "before enabling the coder protection and",
    "start": "889070",
    "end": "892959"
  },
  {
    "text": "yes so we kept overwriting addresses in",
    "start": "892959",
    "end": "896390"
  },
  {
    "text": "the stack area in order to find the the",
    "start": "896390",
    "end": "901720"
  },
  {
    "text": "return address and we found the return",
    "start": "901720",
    "end": "904610"
  },
  {
    "text": "address resides and one f5 for inside",
    "start": "904610",
    "end": "907760"
  },
  {
    "text": "the RAM so how we managed to find this",
    "start": "907760",
    "end": "911810"
  },
  {
    "text": "we kept overwriting addresses inside the",
    "start": "911810",
    "end": "914810"
  },
  {
    "text": "the stack area that will branch our code",
    "start": "914810",
    "end": "917570"
  },
  {
    "text": "to some function that will print just a",
    "start": "917570",
    "end": "920570"
  },
  {
    "text": "string and in the serial terminal so",
    "start": "920570",
    "end": "923300"
  },
  {
    "text": "yeah so we kept overwriting until we got",
    "start": "923300",
    "end": "926779"
  },
  {
    "text": "our string printed then okay this is the",
    "start": "926779",
    "end": "929240"
  },
  {
    "text": "return address then we enabled TRP and",
    "start": "929240",
    "end": "933430"
  },
  {
    "text": "we started our supplementation with CRP",
    "start": "933430",
    "end": "938029"
  },
  {
    "text": "level 1 enabled so at first we called",
    "start": "938029",
    "end": "941209"
  },
  {
    "text": "the write command ok we all the right",
    "start": "941209",
    "end": "945560"
  },
  {
    "text": "the return address of the write command",
    "start": "945560",
    "end": "948620"
  },
  {
    "text": "and make it jump somewhere inside the",
    "start": "948620",
    "end": "953810"
  },
  {
    "text": "read command why we didn't like jump to",
    "start": "953810",
    "end": "957079"
  },
  {
    "text": "the first instruction or for the read",
    "start": "957079",
    "end": "958910"
  },
  {
    "text": "command because we want to control the",
    "start": "958910",
    "end": "960950"
  },
  {
    "text": "stack we want to control the registers",
    "start": "960950",
    "end": "963110"
  },
  {
    "text": "so we had to bypass the push instruction",
    "start": "963110",
    "end": "967220"
  },
  {
    "text": "so we jumped somewhere inside this",
    "start": "967220",
    "end": "970250"
  },
  {
    "text": "function and then when when this",
    "start": "970250",
    "end": "975380"
  },
  {
    "text": "function ends execution when it needs to",
    "start": "975380",
    "end": "977990"
  },
  {
    "text": "return there will be no valid value is",
    "start": "977990",
    "end": "980570"
  },
  {
    "text": "waiting to get popped inside the PC so",
    "start": "980570",
    "end": "984050"
  },
  {
    "text": "this resulted in the device to crash and",
    "start": "984050",
    "end": "987290"
  },
  {
    "text": "you have to reset it okay that's a good",
    "start": "987290",
    "end": "989480"
  },
  {
    "text": "exploit and it will work fine but",
    "start": "989480",
    "end": "991579"
  },
  {
    "text": "sometimes when you may have some",
    "start": "991579",
    "end": "992990"
  },
  {
    "text": "interesting stuff inside the RAM and",
    "start": "992990",
    "end": "996170"
  },
  {
    "text": "you'll and it will be lost if you reset",
    "start": "996170",
    "end": "999350"
  },
  {
    "text": "the device so we thought about using",
    "start": "999350",
    "end": "1002649"
  },
  {
    "text": "return oriented programming to branch",
    "start": "1002649",
    "end": "1005800"
  },
  {
    "text": "our code and then to also to prevent the",
    "start": "1005800",
    "end": "1008950"
  },
  {
    "text": "device from crashing so basically we",
    "start": "1008950",
    "end": "1011140"
  },
  {
    "text": "made the read command to jump to some",
    "start": "1011140",
    "end": "1013600"
  },
  {
    "text": "Rob gadget and this returning and",
    "start": "1013600",
    "end": "1017650"
  },
  {
    "text": "programming gadget will",
    "start": "1017650",
    "end": "1019459"
  },
  {
    "text": "jump to some ice P function this ice be",
    "start": "1019459",
    "end": "1022970"
  },
  {
    "text": "function eventually will will call the",
    "start": "1022970",
    "end": "1025970"
  },
  {
    "text": "command handler again and ask you to",
    "start": "1025970",
    "end": "1028779"
  },
  {
    "text": "enter commands like nothing happened",
    "start": "1028779",
    "end": "1032260"
  },
  {
    "text": "here what we have done and the assembly",
    "start": "1032260",
    "end": "1036079"
  },
  {
    "text": "level as we can see here the right",
    "start": "1036079",
    "end": "1038209"
  },
  {
    "text": "command the PC ovett got overwritten and",
    "start": "1038209",
    "end": "1041740"
  },
  {
    "text": "we made it jump to this address",
    "start": "1041740",
    "end": "1044630"
  },
  {
    "text": "CFA inside the read command and when the",
    "start": "1044630",
    "end": "1048529"
  },
  {
    "text": "read command needs to enter sorry to",
    "start": "1048529",
    "end": "1050870"
  },
  {
    "text": "return we overrode the PC ovett with our",
    "start": "1050870",
    "end": "1055850"
  },
  {
    "text": "gadget address and then from our gadget",
    "start": "1055850",
    "end": "1059830"
  },
  {
    "text": "the PC of it we made the jump to some",
    "start": "1059830",
    "end": "1063860"
  },
  {
    "text": "isp function and then the stack all was",
    "start": "1063860",
    "end": "1067850"
  },
  {
    "text": "set up that this pc of this function",
    "start": "1067850",
    "end": "1071750"
  },
  {
    "text": "will has an address that will eventually",
    "start": "1071750",
    "end": "1075740"
  },
  {
    "text": "jump to the command handler so by itself",
    "start": "1075740",
    "end": "1079159"
  },
  {
    "text": "that this pc the black circle had this",
    "start": "1079159",
    "end": "1082580"
  },
  {
    "text": "address 1060 inside it and we found that",
    "start": "1082580",
    "end": "1086750"
  },
  {
    "text": "this 1060 has a branch and will jump",
    "start": "1086750",
    "end": "1090919"
  },
  {
    "text": "eventually to the command handler so",
    "start": "1090919",
    "end": "1093169"
  },
  {
    "text": "basically we were we overrode three pcs",
    "start": "1093169",
    "end": "1095690"
  },
  {
    "text": "and here's another representation of the",
    "start": "1095690",
    "end": "1100640"
  },
  {
    "text": "of the attack so these two slides are",
    "start": "1100640",
    "end": "1105049"
  },
  {
    "text": "really very connected together so as we",
    "start": "1105049",
    "end": "1109130"
  },
  {
    "text": "can see the PC of the read command",
    "start": "1109130",
    "end": "1111080"
  },
  {
    "text": "jumped inside the the blue area and then",
    "start": "1111080",
    "end": "1115940"
  },
  {
    "text": "which is the read command area and then",
    "start": "1115940",
    "end": "1118039"
  },
  {
    "text": "the PC of the read command area jump to",
    "start": "1118039",
    "end": "1120140"
  },
  {
    "text": "there to the red area which is the",
    "start": "1120140",
    "end": "1121700"
  },
  {
    "text": "gadget area and then from the gadget we",
    "start": "1121700",
    "end": "1125570"
  },
  {
    "text": "jump to that purple area",
    "start": "1125570",
    "end": "1129490"
  },
  {
    "text": "sorry then we found that the PC of this",
    "start": "1129490",
    "end": "1135110"
  },
  {
    "text": "is P function has this address inside it",
    "start": "1135110",
    "end": "1139450"
  },
  {
    "text": "1061 is the same as 1060 here but",
    "start": "1139450",
    "end": "1144529"
  },
  {
    "text": "because l pc one three four three uses",
    "start": "1144529",
    "end": "1147399"
  },
  {
    "text": "some mechanism that's called some mood",
    "start": "1147399",
    "end": "1151289"
  },
  {
    "text": "it makes they are this is plus one",
    "start": "1151289",
    "end": "1154110"
  },
  {
    "text": "inside the stack yes so we found this",
    "start": "1154110",
    "end": "1159900"
  },
  {
    "text": "others inside the PC so we didn't have",
    "start": "1159900",
    "end": "1161850"
  },
  {
    "text": "to overwrite another PC to to go to the",
    "start": "1161850",
    "end": "1165510"
  },
  {
    "text": "command Handler and so our final exploit",
    "start": "1165510",
    "end": "1170090"
  },
  {
    "text": "looked something like this so here is",
    "start": "1170090",
    "end": "1173400"
  },
  {
    "text": "the this is how the write command looks",
    "start": "1173400",
    "end": "1177360"
  },
  {
    "text": "so we tell it right W + 2 6 blah blah",
    "start": "1177360",
    "end": "1182549"
  },
  {
    "text": "blah or something this is the decimal",
    "start": "1182549",
    "end": "1184710"
  },
  {
    "text": "representation of the address 1f 5 4 +",
    "start": "1184710",
    "end": "1189020"
  },
  {
    "text": "45 44 is the number of bytes that we are",
    "start": "1189020",
    "end": "1193559"
  },
  {
    "text": "willing to write so we tell it start",
    "start": "1193559",
    "end": "1198360"
  },
  {
    "text": "writing from F 5 4 and starting from",
    "start": "1198360",
    "end": "1203250"
  },
  {
    "text": "that address write 45 44 bytes so at",
    "start": "1203250",
    "end": "1209850"
  },
  {
    "text": "first this this device doesn't accept",
    "start": "1209850",
    "end": "1213950"
  },
  {
    "text": "hexadecimal values so we had to encode",
    "start": "1213950",
    "end": "1217650"
  },
  {
    "text": "our our exploit and send it to the",
    "start": "1217650",
    "end": "1220380"
  },
  {
    "text": "device so he can understand it so as we",
    "start": "1220380",
    "end": "1224070"
  },
  {
    "text": "as we showed in the previous slides",
    "start": "1224070",
    "end": "1227030"
  },
  {
    "text": "this blue address is the PC of the right",
    "start": "1227030",
    "end": "1229740"
  },
  {
    "text": "to ram command and we made it jump to",
    "start": "1229740",
    "end": "1232440"
  },
  {
    "text": "the read command and that green address",
    "start": "1232440",
    "end": "1234510"
  },
  {
    "text": "is the PC of the of the read command and",
    "start": "1234510",
    "end": "1238080"
  },
  {
    "text": "then this purple address is the PC of",
    "start": "1238080",
    "end": "1242789"
  },
  {
    "text": "the gadget and as we said we don't have",
    "start": "1242789",
    "end": "1244980"
  },
  {
    "text": "to put the PC of that isp function",
    "start": "1244980",
    "end": "1247110"
  },
  {
    "text": "because by itself had it has the",
    "start": "1247110",
    "end": "1249870"
  },
  {
    "text": "appropriate address inside it here we",
    "start": "1249870",
    "end": "1253350"
  },
  {
    "text": "have something interesting the red",
    "start": "1253350",
    "end": "1255240"
  },
  {
    "text": "address which decides from where we",
    "start": "1255240",
    "end": "1259530"
  },
  {
    "text": "would like to read ok so since we are",
    "start": "1259530",
    "end": "1262070"
  },
  {
    "text": "calling the read command an abnormal way",
    "start": "1262070",
    "end": "1267350"
  },
  {
    "text": "ok we need to read but from where so we",
    "start": "1267350",
    "end": "1271890"
  },
  {
    "text": "found that the third register of the",
    "start": "1271890",
    "end": "1274049"
  },
  {
    "text": "read command is the register that",
    "start": "1274049",
    "end": "1277950"
  },
  {
    "text": "decides from which area to read in the",
    "start": "1277950",
    "end": "1283409"
  },
  {
    "text": "memory or Ram",
    "start": "1283409",
    "end": "1284490"
  },
  {
    "text": "so the value that's inside this register",
    "start": "1284490",
    "end": "1287430"
  },
  {
    "text": "decides from where to start reading so",
    "start": "1287430",
    "end": "1291030"
  },
  {
    "text": "here we put the 2 FC address which is",
    "start": "1291030",
    "end": "1293190"
  },
  {
    "text": "the address that has the configured CRP",
    "start": "1293190",
    "end": "1297270"
  },
  {
    "text": "value in the device so let's go and do",
    "start": "1297270",
    "end": "1305250"
  },
  {
    "text": "some magic ok we have the device",
    "start": "1305250",
    "end": "1310350"
  },
  {
    "text": "connected here and it can receive some",
    "start": "1310350",
    "end": "1312870"
  },
  {
    "text": "commands Jade means like the bootloader",
    "start": "1312870",
    "end": "1316190"
  },
  {
    "text": "version whatever so at first we show",
    "start": "1316190",
    "end": "1318840"
  },
  {
    "text": "that we tell it read from read for bytes",
    "start": "1318840",
    "end": "1322970"
  },
  {
    "text": "starting from others 0 ok it's returned",
    "start": "1322970",
    "end": "1328770"
  },
  {
    "text": "back",
    "start": "1328770",
    "end": "1329540"
  },
  {
    "text": "19:19 is the return code that means you",
    "start": "1329540",
    "end": "1333900"
  },
  {
    "text": "cannot use this command code reader",
    "start": "1333900",
    "end": "1336090"
  },
  {
    "text": "protection is enabled ok so we give it",
    "start": "1336090",
    "end": "1341450"
  },
  {
    "text": "the right command ok as we can see here",
    "start": "1341450",
    "end": "1347540"
  },
  {
    "text": "1300 means the command succeeded and",
    "start": "1347540",
    "end": "1351440"
  },
  {
    "text": "then we give it our exploit encoded",
    "start": "1351440",
    "end": "1356280"
  },
  {
    "text": "exploit so basically this is the same as",
    "start": "1356280",
    "end": "1359460"
  },
  {
    "text": "this but encoded so we take it boom so",
    "start": "1359460",
    "end": "1367410"
  },
  {
    "text": "yes we managed to read even with code",
    "start": "1367410",
    "end": "1371730"
  },
  {
    "text": "reader protection is enabled so yeah",
    "start": "1371730",
    "end": "1374430"
  },
  {
    "text": "again it gave us some encoded stuff so",
    "start": "1374430",
    "end": "1377220"
  },
  {
    "text": "we can take this stuff and decode them",
    "start": "1377220",
    "end": "1381360"
  },
  {
    "text": "and then we have basically what's inside",
    "start": "1381360",
    "end": "1386120"
  },
  {
    "text": "the device so just to conclude we",
    "start": "1386120",
    "end": "1393330"
  },
  {
    "text": "responsibly disclose this vulnerability",
    "start": "1393330",
    "end": "1395700"
  },
  {
    "text": "to NXP the acknowledged our work and",
    "start": "1395700",
    "end": "1399510"
  },
  {
    "text": "they updated their documentation to",
    "start": "1399510",
    "end": "1401430"
  },
  {
    "text": "encourage the users for using CRP level",
    "start": "1401430",
    "end": "1406620"
  },
  {
    "text": "1 and they they encourage encourage them",
    "start": "1406620",
    "end": "1411750"
  },
  {
    "text": "to go to CRP level 2 and 3 so from this",
    "start": "1411750",
    "end": "1416970"
  },
  {
    "text": "we conclude that",
    "start": "1416970",
    "end": "1418150"
  },
  {
    "text": "empty boot loaders normally are easy to",
    "start": "1418150",
    "end": "1420429"
  },
  {
    "text": "dump and easy to reverse-engineer and",
    "start": "1420429",
    "end": "1423299"
  },
  {
    "text": "sometimes this results in finding a lot",
    "start": "1423299",
    "end": "1426309"
  },
  {
    "text": "of logical attacks and widely available",
    "start": "1426309",
    "end": "1429760"
  },
  {
    "text": "devices and there are a lot of",
    "start": "1429760",
    "end": "1433950"
  },
  {
    "text": "vulnerabilities but they are just",
    "start": "1433950",
    "end": "1436360"
  },
  {
    "text": "waiting for someone to find them in such",
    "start": "1436360",
    "end": "1437950"
  },
  {
    "text": "devices and these boot these these",
    "start": "1437950",
    "end": "1441460"
  },
  {
    "text": "devices so yes as we said the main the",
    "start": "1441460",
    "end": "1444850"
  },
  {
    "text": "main thing here is we managed to break",
    "start": "1444850",
    "end": "1447250"
  },
  {
    "text": "this device with just using just this",
    "start": "1447250",
    "end": "1450580"
  },
  {
    "text": "cable which can cost five dollars or",
    "start": "1450580",
    "end": "1453100"
  },
  {
    "text": "something and yeah the full exploit and",
    "start": "1453100",
    "end": "1456789"
  },
  {
    "text": "the dump of the boot loader are",
    "start": "1456789",
    "end": "1459220"
  },
  {
    "text": "available on this github repo we will",
    "start": "1459220",
    "end": "1461890"
  },
  {
    "text": "add some more stuff later on and yeah",
    "start": "1461890",
    "end": "1465940"
  },
  {
    "text": "that's all thank you so much",
    "start": "1465940",
    "end": "1468270"
  },
  {
    "text": "[Applause]",
    "start": "1468270",
    "end": "1477140"
  }
]