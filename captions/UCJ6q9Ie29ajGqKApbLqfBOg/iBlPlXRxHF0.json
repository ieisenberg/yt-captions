[
  {
    "text": "as a start I'd like to take you on a brief journey on how we both met uh",
    "start": "2480",
    "end": "9200"
  },
  {
    "text": "because the things that binds us as cellular network researchers is also the",
    "start": "9200",
    "end": "15920"
  },
  {
    "text": "things that haunts us as cellular network researchers and I would categorize that into four categories so",
    "start": "15920",
    "end": "23600"
  },
  {
    "text": "the one thing is you have all these different access technologies once a decade you you need to build up a whole",
    "start": "23600",
    "end": "30960"
  },
  {
    "text": "new park of equipment and knowledge and and software um then you have all this",
    "start": "30960",
    "end": "37920"
  },
  {
    "text": "legacy protocols that the telco industry loves to use but they're inching closer and closer to more uh internetbased",
    "start": "37920",
    "end": "46079"
  },
  {
    "text": "technologies we have all this corner cases in the telecom world especially in cellular",
    "start": "46079",
    "end": "52920"
  },
  {
    "text": "networks for example um two operators with completely",
    "start": "52920",
    "end": "58879"
  },
  {
    "text": "different hardware software and configuration settings are trying actively trying to",
    "start": "58879",
    "end": "65198"
  },
  {
    "text": "mimic a consistent service to you as a roaming customer",
    "start": "65199",
    "end": "70360"
  },
  {
    "text": "um we have all this zero rating uh corner cases because not all traffic is",
    "start": "70360",
    "end": "76640"
  },
  {
    "text": "handled the same and some is accounted some is not accounted for um not",
    "start": "76640",
    "end": "82560"
  },
  {
    "text": "necessarily if you have like a data plan that includes streaming uh or not but",
    "start": "82560",
    "end": "88799"
  },
  {
    "text": "also uh traffic uh there's always some traffic that is allowed even if you don't have any allowance data allowance",
    "start": "88799",
    "end": "95840"
  },
  {
    "text": "left like uh connecting to the um credit card uh um services to pay for",
    "start": "95840",
    "end": "105759"
  },
  {
    "text": "uh for more data traffic we have all this geoblocked services uh geoblocked services",
    "start": "105759",
    "end": "111960"
  },
  {
    "text": "but the worst of all is actually the geography so I actually made a prison",
    "start": "111960",
    "end": "119040"
  },
  {
    "text": "because we as a cellular network researchers are always imprisoned within our own country where we might have two",
    "start": "119040",
    "end": "126079"
  },
  {
    "text": "three four network operators and whenever we have an idea",
    "start": "126079",
    "end": "132000"
  },
  {
    "text": "we come up uh with an exploit we only can test them against those three or",
    "start": "132000",
    "end": "138400"
  },
  {
    "text": "four network operators and so a few years back Gabriel had very neat ideas",
    "start": "138400",
    "end": "143920"
  },
  {
    "text": "how to dodge traffic accounting and he tested this with several uh Austrian",
    "start": "143920",
    "end": "150520"
  },
  {
    "text": "operators and I was like ah we need a solution to get a global picture how is",
    "start": "150520",
    "end": "156560"
  },
  {
    "text": "it with other countries and so a short example uh how can we do",
    "start": "156560",
    "end": "164560"
  },
  {
    "text": "measurements and what's the problem let's say we have in our toy",
    "start": "164560",
    "end": "170080"
  },
  {
    "text": "example just three countries and each of that has three network operators and now",
    "start": "170080",
    "end": "175840"
  },
  {
    "text": "I have one one SIM card with an Austin operator that can connect to my own operator and in each other country to",
    "start": "175840",
    "end": "182319"
  },
  {
    "text": "the free roaming partners however of course to get a better picture we need SIM cards of all",
    "start": "182319",
    "end": "190000"
  },
  {
    "text": "the free uh home network operators and then of course there's",
    "start": "190000",
    "end": "195920"
  },
  {
    "text": "more than just one data plan uh in with each network operator and we also want",
    "start": "195920",
    "end": "202159"
  },
  {
    "text": "to do the reverse measurements and so we end even if in this very small toy example we end up with n uh almost 190",
    "start": "202159",
    "end": "210760"
  },
  {
    "text": "combinations and so how do we scale that um and we could",
    "start": "210760",
    "end": "217120"
  },
  {
    "text": "either travel a lot or we had collect all the SIM cards in all the countries",
    "start": "217120",
    "end": "222640"
  },
  {
    "text": "and duplicate our setups and then declare bankruptcy um or uh we need to",
    "start": "222640",
    "end": "229280"
  },
  {
    "text": "find something new and so we opted for SIM tunneling for",
    "start": "229280",
    "end": "234799"
  },
  {
    "text": "uh um splitting or geograph decoupling the modem from the SIM card we're not",
    "start": "234799",
    "end": "240319"
  },
  {
    "text": "the first ones to do SIM tunneling over the internet however we are academic",
    "start": "240319",
    "end": "245519"
  },
  {
    "text": "researchers so we needed to do that dirt cheap and so um with in our setup we",
    "start": "245519",
    "end": "252959"
  },
  {
    "text": "have like our SIM cards uh mostly in in Austria and then we can virtually",
    "start": "252959",
    "end": "258400"
  },
  {
    "text": "connect them to different modems in different countries and there we can connect them to all the network",
    "start": "258400",
    "end": "264840"
  },
  {
    "text": "operators and uh we set that up with Linux network name spaces so basically",
    "start": "264840",
    "end": "271360"
  },
  {
    "text": "Docker containers so that we really get clean sterile measurements without any",
    "start": "271360",
    "end": "277280"
  },
  {
    "text": "background traffic and so how how did we make this cheap how can we like ship those",
    "start": "277280",
    "end": "283919"
  },
  {
    "text": "stations to friends and family and other researchers worldwide but we needed to",
    "start": "283919",
    "end": "289440"
  },
  {
    "text": "make it with a Raspberry Pi and with some common US Chinese uh",
    "start": "289440",
    "end": "297040"
  },
  {
    "text": "super cheap uh USB SIM card adapters and the SIM card uh was basically directly",
    "start": "297040",
    "end": "305600"
  },
  {
    "text": "connected to GPIO pins we uh ignored the the the clock line for example we know",
    "start": "305600",
    "end": "313680"
  },
  {
    "text": "which modem is in there we measure it once hardcoded in software don't have to",
    "start": "313680",
    "end": "318800"
  },
  {
    "text": "care about that so that's how we made it dirt cheap and so we made some measurements with that one problem that",
    "start": "318800",
    "end": "326160"
  },
  {
    "text": "we encountered is that especially in the Roman case it can take hours or days",
    "start": "326160",
    "end": "331919"
  },
  {
    "text": "until call data records are transmitted to the home network operator and show up",
    "start": "331919",
    "end": "337440"
  },
  {
    "text": "and so we needed a method to check the accounting rules abroad and so we uh",
    "start": "337440",
    "end": "344240"
  },
  {
    "text": "leveled them up in powers of two so that like the first measurement uses one",
    "start": "344240",
    "end": "349360"
  },
  {
    "text": "megabyte then two then four then eight and so when it when the traffic uh",
    "start": "349360",
    "end": "354639"
  },
  {
    "text": "accounting arrives hours or days later we can puzzle it together and know um",
    "start": "354639",
    "end": "360240"
  },
  {
    "text": "what what kind of traffic was accounted and which wasn't another interesting",
    "start": "360240",
    "end": "365520"
  },
  {
    "text": "thing that we did and encountered was ring back tone fingerprinting so ring",
    "start": "365520",
    "end": "372720"
  },
  {
    "text": "back tone is that that tone that you hear when you call someone uh and before",
    "start": "372720",
    "end": "378560"
  },
  {
    "text": "that person picks up and the interesting thing about that",
    "start": "378560",
    "end": "384080"
  },
  {
    "text": "is that it's usually generated by the target uh operator so that means if your",
    "start": "384080",
    "end": "391759"
  },
  {
    "text": "phone is abroad the visiting network operator generates that tone and if you",
    "start": "391759",
    "end": "398720"
  },
  {
    "text": "look at the spectrogram you can see they're kind of",
    "start": "398720",
    "end": "403759"
  },
  {
    "text": "different uh for example when in O2 in Germany has all the sidelopes but it",
    "start": "403759",
    "end": "410720"
  },
  {
    "text": "also has a different center frequency and a different amplitude and so if we take those and just plot the",
    "start": "410720",
    "end": "419280"
  },
  {
    "text": "frequency versus the amplitude you get a picture where you can clearly see that",
    "start": "419280",
    "end": "424960"
  },
  {
    "text": "with just one phone call uh we can distinguish where uh certain person",
    "start": "424960",
    "end": "431360"
  },
  {
    "text": "actually is well we know which operator and by extension we know which uh which",
    "start": "431360",
    "end": "437360"
  },
  {
    "text": "country because operators only operate in a specific country and so",
    "start": "437360",
    "end": "444919"
  },
  {
    "text": "um but however we can take that voice even further i mean voice is one of the",
    "start": "444919",
    "end": "450800"
  },
  {
    "text": "oldest technologies or modes of of operation for for cellular networks and",
    "start": "450800",
    "end": "457919"
  },
  {
    "text": "turns out the radio access network isn't the only one uh only way to access the core",
    "start": "457919",
    "end": "465120"
  },
  {
    "text": "network of an operator the services of an operator there's a second uh method",
    "start": "465120",
    "end": "470720"
  },
  {
    "text": "that's voice over Wi-Fi and voice over Wi-Fi I mean operators love voice over",
    "start": "470720",
    "end": "477039"
  },
  {
    "text": "Wi-Fi because they can they still get uh full revenue they can charge you fully",
    "start": "477039",
    "end": "483360"
  },
  {
    "text": "for the services but not provide the last mile you're paying with your own Wi-Fi router for that and that's a",
    "start": "483360",
    "end": "491599"
  },
  {
    "text": "pretty interesting technology because it also allows us allows us to break out of",
    "start": "491599",
    "end": "497440"
  },
  {
    "text": "this geographic prison because uh uh over the internet we can connect to all",
    "start": "497440",
    "end": "504080"
  },
  {
    "text": "the other operators that also um operate a voice over Wi-Fi gateway so how does",
    "start": "504080",
    "end": "511919"
  },
  {
    "text": "this work well this is the classic way your UEI your phone uh connects over uh",
    "start": "511919",
    "end": "519839"
  },
  {
    "text": "base station to the core network and from there to the voice subsystem of the",
    "start": "519839",
    "end": "525480"
  },
  {
    "text": "operator and your phone has then a SIM card and some configurations because",
    "start": "525480",
    "end": "531560"
  },
  {
    "text": "3GPP more or less forgot to create an auto configuration protocol for voice",
    "start": "531560",
    "end": "536959"
  },
  {
    "text": "over LT and voice over Wi-Fi but we'll come back to that later and so the",
    "start": "536959",
    "end": "542399"
  },
  {
    "text": "alternative way is that the network operator operates an EPDG which stands",
    "start": "542399",
    "end": "548560"
  },
  {
    "text": "for evolve packet um data gateway and is just a fancy word for an IPSAC",
    "start": "548560",
    "end": "554920"
  },
  {
    "text": "endpoint and then your phone can make an IPSAC tunnel to this EPDG connect to the",
    "start": "554920",
    "end": "561839"
  },
  {
    "text": "core network and from there to the voice services of the",
    "start": "561839",
    "end": "568639"
  },
  {
    "text": "operator okay so uh we're at the lower path here uh the packets go from the",
    "start": "569720",
    "end": "575279"
  },
  {
    "text": "UEIE to the EPDG and they traverse um the internet over a uh Wi-Fi access",
    "start": "575279",
    "end": "581440"
  },
  {
    "text": "point and obviously this Wi-Fi access point is not controlled by the operator so it's a third party Wi-Fi access point",
    "start": "581440",
    "end": "587760"
  },
  {
    "text": "maybe customers are connecting uh on an airport or on an IT security conference like Blackat so obviously um it needs to",
    "start": "587760",
    "end": "595680"
  },
  {
    "text": "be protected against threats and therefore it's um it's encapsulated in an IPSC via an ipsec tunnel in fact it's",
    "start": "595680",
    "end": "604080"
  },
  {
    "text": "three layers of this tunnel the very first one is an ike layer that is used for signaling and also for management of",
    "start": "604080",
    "end": "611040"
  },
  {
    "text": "the subsequent layers so for for layer two for layer three so for the initial um key agreement and also for the",
    "start": "611040",
    "end": "617760"
  },
  {
    "text": "rekeying uh this tunnel is used then on layer two we have an IP sec layer in",
    "start": "617760",
    "end": "623200"
  },
  {
    "text": "tunnel mode so this means that it's pretty much like a VPN it gives the customer an IP address within the",
    "start": "623200",
    "end": "629839"
  },
  {
    "text": "operator's range um also this this layer corresponds to the IMS APN on voiceover",
    "start": "629839",
    "end": "636360"
  },
  {
    "text": "LTE and finally we have the third layer layer three uh that is used for the",
    "start": "636360",
    "end": "641680"
  },
  {
    "text": "voice of IP traffic so for SIP and for the actual voice traffic and um yeah",
    "start": "641680",
    "end": "647279"
  },
  {
    "text": "this is secured via IPSAC as well but in transport mode and when we approached this topic",
    "start": "647279",
    "end": "655040"
  },
  {
    "text": "we simply kicked it off by recording a traffic dump of of my phone uh",
    "start": "655040",
    "end": "660240"
  },
  {
    "text": "connecting to my home operator and um this is the result so this is a Wireshark screenshot and as we can see",
    "start": "660240",
    "end": "667200"
  },
  {
    "text": "this is an Ike packet it's the handshake packet so the first ISA init packet that",
    "start": "667200",
    "end": "672480"
  },
  {
    "text": "goes from the smartphone towards the EPDG towards the operator and what happens here is that the smartphone it",
    "start": "672480",
    "end": "679839"
  },
  {
    "text": "communicates the target operator which security association so which ciphers for example it supports and since this",
    "start": "679839",
    "end": "686880"
  },
  {
    "text": "is a handshake packet the the operator will um take a look at this packet um it",
    "start": "686880",
    "end": "692880"
  },
  {
    "text": "also has some supported configurations and it will match those configurations from the client against their own one",
    "start": "692880",
    "end": "699760"
  },
  {
    "text": "and then uh they can agree on mutually supported um security associations what",
    "start": "699760",
    "end": "705279"
  },
  {
    "text": "also happens is that the client directly initiates a key exchange so in this case",
    "start": "705279",
    "end": "710720"
  },
  {
    "text": "my my home operator in Austria it was using um Diffy Helman key exchange group",
    "start": "710720",
    "end": "716560"
  },
  {
    "text": "two which is the 1024-bit prime group and this uh was not an ideal",
    "start": "716560",
    "end": "722800"
  },
  {
    "text": "choice because since 2015 uh we know due to a CCS paper that an academic team can",
    "start": "722800",
    "end": "729519"
  },
  {
    "text": "break 768 bit prime uh defy helman and nation states can even break 1024-bit",
    "start": "729519",
    "end": "734800"
  },
  {
    "text": "prime and of course this was 2015 so since then uh computers just got faster faster and cracking power is is cheaper",
    "start": "734800",
    "end": "741600"
  },
  {
    "text": "and more easily available so nowadays you can say that uh anything lower than 20 48 bit prime um mod prime group is is",
    "start": "741600",
    "end": "750320"
  },
  {
    "text": "considered as as not very secure so um yeah my operator obviously did not make",
    "start": "750320",
    "end": "755839"
  },
  {
    "text": "a very good choice here um and also I want to highlight that the key exchange is very important here so although we",
    "start": "755839",
    "end": "762560"
  },
  {
    "text": "have this other security associations like supported ciphers um a lot of um",
    "start": "762560",
    "end": "767680"
  },
  {
    "text": "security depends on the key exchange because even like if um a very secure",
    "start": "767680",
    "end": "772800"
  },
  {
    "text": "cipher is used uh if the the key exchange is weak that obviously undermines the the overall security of",
    "start": "772800",
    "end": "779279"
  },
  {
    "text": "of the connection so uh yeah it's very crucial to to use a um a strong enough",
    "start": "779279",
    "end": "784880"
  },
  {
    "text": "key exchange here and yeah our wack example already looks very suspicious",
    "start": "784880",
    "end": "790480"
  },
  {
    "text": "because it's a it's a weak uh cipher but this was just one operator this was just my home operator in Austria and of",
    "start": "790480",
    "end": "796959"
  },
  {
    "text": "course we are researchers we wanted to get the global picture so how do other commercial operators worldwide operators",
    "start": "796959",
    "end": "803600"
  },
  {
    "text": "behave here and of course something that is as well interesting is uh whether",
    "start": "803600",
    "end": "808720"
  },
  {
    "text": "they stick to specification or whether they uh they use for example deprecated ciphers but we also wanted to compare it",
    "start": "808720",
    "end": "815200"
  },
  {
    "text": "against the specification um so this brings me to the ETC free GP specification slide um",
    "start": "815200",
    "end": "822560"
  },
  {
    "text": "in this case um there are multiple uh specification documents that cover um the voice of Wi-Fi part but um",
    "start": "822560",
    "end": "829959"
  },
  {
    "text": "TS133 210 is the the most important one here uh that's kind of a telling name so",
    "start": "829959",
    "end": "835680"
  },
  {
    "text": "you can see that this is a lot of fun sadly I have to disappoint you because",
    "start": "835680",
    "end": "840880"
  },
  {
    "text": "we already did the work so we're not looking at this specification in in detail now uh but um yeah we kind of",
    "start": "840880",
    "end": "847519"
  },
  {
    "text": "extracted the supported defy helman groups over over time so over different versions of this specification document",
    "start": "847519",
    "end": "854720"
  },
  {
    "text": "and this is the result um the most important lines are the red and the yellow one uh the red line is the def",
    "start": "854720",
    "end": "862000"
  },
  {
    "text": "helman group two so 1024-bit prime that was also used by me my operator it was",
    "start": "862000",
    "end": "867199"
  },
  {
    "text": "pretty much the standard for like 10 years until 20 2011 then it was",
    "start": "867199",
    "end": "872320"
  },
  {
    "text": "discouraged for some years and finally 2016 maybe as a reaction to the CCS",
    "start": "872320",
    "end": "877440"
  },
  {
    "text": "paper it was deprecated so uh the major replacement is 2048 bit prime uh group",
    "start": "877440",
    "end": "883839"
  },
  {
    "text": "that is um yeah still considered as as the standard but um yeah 1024-bit prime",
    "start": "883839",
    "end": "890320"
  },
  {
    "text": "group shouldn't be used anymore but of course like this is this the the shell case so this is the specification and we",
    "start": "890320",
    "end": "897360"
  },
  {
    "text": "are interested in what happens in practice so therefore we had a three-fold um evaluation approach and",
    "start": "897360",
    "end": "904240"
  },
  {
    "text": "the first step was to take a look at the configuration files that are preloaded and that are present on smartphones so",
    "start": "904240",
    "end": "910800"
  },
  {
    "text": "these are operator specific configuration files the second step was to do some um penetration testing",
    "start": "910800",
    "end": "917680"
  },
  {
    "text": "against the IPA client that um that runs on the UE so on the smartphone and finally since um every EPDG is exposed",
    "start": "917680",
    "end": "925839"
  },
  {
    "text": "towards the internet we also did some active probing so this is also if you compare it to the uh radio case this is",
    "start": "925839",
    "end": "932720"
  },
  {
    "text": "a huge advantage for us as researcher because we do not need dedicated measurement equipment in every country",
    "start": "932720",
    "end": "938959"
  },
  {
    "text": "like we did with mobile Atlas but right now we can scan everything just from Austria from our server in Austria and",
    "start": "938959",
    "end": "946120"
  },
  {
    "text": "Vienna uh yeah let's take a look at at the results of the first um flank of the first step so um yeah sadly there is no",
    "start": "946120",
    "end": "954399"
  },
  {
    "text": "good um auto configuration script so what happened in practice is that uh operators or mainly manufacturers they",
    "start": "954399",
    "end": "961839"
  },
  {
    "text": "developed um approaches to to preload configurations um on onto the",
    "start": "961839",
    "end": "966959"
  },
  {
    "text": "smartphones and of course every manufacturer has a different way here so we tried to to cover uh multiple um",
    "start": "966959",
    "end": "974000"
  },
  {
    "text": "manufacturers and multiple devices and for example for Apple we were very um",
    "start": "974000",
    "end": "979120"
  },
  {
    "text": "yeah happy because there was already um an implemented solution by by Merlin by another researcher um that allowed to",
    "start": "979120",
    "end": "985920"
  },
  {
    "text": "download the corresponding profiles so the carrier profiles and we used this uh GitHub project to download them and then",
    "start": "985920",
    "end": "992240"
  },
  {
    "text": "evaluated the voice or Wi-Fi settings there and the key exchange groups that are supported by various operators uh",
    "start": "992240",
    "end": "999120"
  },
  {
    "text": "for Samsung it was also pretty straightforward so this was just an XML file that is sitting on the phone and",
    "start": "999120",
    "end": "1004959"
  },
  {
    "text": "that can also be extracted from um from smartphone ROMs from firm uh but on in",
    "start": "1004959",
    "end": "1011279"
  },
  {
    "text": "the contrary for Qualcomm this was uh not too easy because Qualcomm of course uses a proprietary format so this was an",
    "start": "1011279",
    "end": "1018480"
  },
  {
    "text": "MBN file format the modem configuration file format that we needed to reverse engineer and that um our student",
    "start": "1018480",
    "end": "1025360"
  },
  {
    "text": "assistant Philip gladly wrote the password for so we were able to to pass these files and the nice thing was that",
    "start": "1025360",
    "end": "1032558"
  },
  {
    "text": "this approach worked across multiple u manufacturers so as pretty much any any",
    "start": "1032559",
    "end": "1038400"
  },
  {
    "text": "uh smartphone that used a Qualcomm chipset uh was um yeah work for them we",
    "start": "1038400",
    "end": "1044400"
  },
  {
    "text": "were able to to uh uncover these um these configuration files and to use um",
    "start": "1044400",
    "end": "1051120"
  },
  {
    "text": "our past and then there's also um like for Google Pixel phones that they use a different approach so they mainly um use",
    "start": "1051120",
    "end": "1058640"
  },
  {
    "text": "some default values that are hardcoded within the the source code and we also inspected those and these are the",
    "start": "1058640",
    "end": "1064799"
  },
  {
    "text": "results so the first three rows in this graph uh are the deprecated uh groups",
    "start": "1064799",
    "end": "1070480"
  },
  {
    "text": "and as you can see there's still a lot of um stuff going on so uh operators",
    "start": "1070480",
    "end": "1076000"
  },
  {
    "text": "sorry the operators um still use these groups although they are deprecated um especially the 1024bit prime group that",
    "start": "1076000",
    "end": "1083600"
  },
  {
    "text": "also was used by my home operator is very um yeah in in in heavy usage still",
    "start": "1083600",
    "end": "1088960"
  },
  {
    "text": "u so my operator was not just one bad apple but u it's it's a repeating pattern for many other operators as",
    "start": "1088960",
    "end": "1095640"
  },
  {
    "text": "well yeah let's go to the second step so this is very similar also to the",
    "start": "1095640",
    "end": "1101840"
  },
  {
    "text": "configuration files every operator or every manufacturer every device handles",
    "start": "1101840",
    "end": "1106960"
  },
  {
    "text": "uh the IPA client differently so they use different um implementations for the",
    "start": "1106960",
    "end": "1112000"
  },
  {
    "text": "IPA client um and for example Qualcomm chipsets or Qualcomm phones with with",
    "start": "1112000",
    "end": "1117280"
  },
  {
    "text": "Qualcomm chipsets um they um they use an implementation that is mostly happening",
    "start": "1117280",
    "end": "1123039"
  },
  {
    "text": "in the bassband so on on the modem side and um other implementations like other",
    "start": "1123039",
    "end": "1129039"
  },
  {
    "text": "other phones like Samsung phones or MediaTek phones um they use uh implementations that are more exposed",
    "start": "1129039",
    "end": "1135200"
  },
  {
    "text": "towards the user space or that can happen in the user space the nice thing is that uh for reversing for reverse",
    "start": "1135200",
    "end": "1141840"
  },
  {
    "text": "engineering this is very convenient because we can simply uh hook those binaries uh using Freda or also we could",
    "start": "1141840",
    "end": "1149840"
  },
  {
    "text": "um do some traffic captures on on the corresponding voice of LT or voice of Wi-Fi interfaces so if you're interested",
    "start": "1149840",
    "end": "1156240"
  },
  {
    "text": "in doing some um yeah some reverse engineering of voiceover um LT or voice",
    "start": "1156240",
    "end": "1161440"
  },
  {
    "text": "over Wi-Fi you might want to use a Samsung MediaTek based phone",
    "start": "1161440",
    "end": "1166559"
  },
  {
    "text": "but for for this um for this topic uh we mainly focused on downgrade attacks that are possible within on this IP sec",
    "start": "1166559",
    "end": "1173600"
  },
  {
    "text": "client and within the Wi-Fi connection and these are the results so uh we've got an example here on the left hand",
    "start": "1173600",
    "end": "1180559"
  },
  {
    "text": "side this is um a handshake procedure where the client um supports the helman",
    "start": "1180559",
    "end": "1186480"
  },
  {
    "text": "group two and 14 and to save round trips it also um kind of prefers one group and",
    "start": "1186480",
    "end": "1193200"
  },
  {
    "text": "initiates the handshake um or the the key exchange using this key exchange method so in this case it uses and",
    "start": "1193200",
    "end": "1199919"
  },
  {
    "text": "prefers the securer group so um defy helman group 14 which is the 2048 bit",
    "start": "1199919",
    "end": "1205880"
  },
  {
    "text": "group um and what could happen in practice is of course that the target",
    "start": "1205880",
    "end": "1211520"
  },
  {
    "text": "operator would not support the felman group 14 uh so the protocol defines um",
    "start": "1211520",
    "end": "1218240"
  },
  {
    "text": "one packet that is called invalid key exchange uh payload packet uh that the server could use to um to change to",
    "start": "1218240",
    "end": "1226240"
  },
  {
    "text": "another defy helman key exchange um and then the client would discard its current state and it would simply start",
    "start": "1226240",
    "end": "1233200"
  },
  {
    "text": "over and respect the the server's choice so in this case it still supports the helman group two and 14 but it prefers",
    "start": "1233200",
    "end": "1239919"
  },
  {
    "text": "the helman group two so they would um continue using the fhelman uh group two",
    "start": "1239919",
    "end": "1245520"
  },
  {
    "text": "in this case uh what however could happen in practice is that um a",
    "start": "1245520",
    "end": "1250880"
  },
  {
    "text": "malicious um interceptor or anybody uh sitting between the UEE and the EPDG",
    "start": "1250880",
    "end": "1256799"
  },
  {
    "text": "could of course spoof this kind of packet and could then downgrade the the security of this connection so um in",
    "start": "1256799",
    "end": "1264320"
  },
  {
    "text": "this case the defy helman group two preference packet the invalid key exchange packet could be spoofed and",
    "start": "1264320",
    "end": "1269760"
  },
  {
    "text": "then uh they would simply use this key exchange group um of course this also",
    "start": "1269760",
    "end": "1275360"
  },
  {
    "text": "depends on the server settings so it could be mitigated uh by servers always demanding for the strongest group",
    "start": "1275360",
    "end": "1281440"
  },
  {
    "text": "however our server side measurements they showed that uh 41% of uh the servers they tolerated this weak",
    "start": "1281440",
    "end": "1288159"
  },
  {
    "text": "preference so for for them uh this attack was still feasible and possible uh we also um detected or found",
    "start": "1288159",
    "end": "1296640"
  },
  {
    "text": "um a second downgrade vulnerability this was only present on MediaTek clients and this was um more severe than um the",
    "start": "1296640",
    "end": "1304159"
  },
  {
    "text": "first one because this is this is more or less a protocol extension so it's yeah it's um it's not a vulnerability",
    "start": "1304159",
    "end": "1311360"
  },
  {
    "text": "although it could be exploited but this one clearly is a vulnerability um so in this case for",
    "start": "1311360",
    "end": "1318480"
  },
  {
    "text": "MediaTek clients uh they kind of forgot to also check whether the the key",
    "start": "1318480",
    "end": "1323919"
  },
  {
    "text": "exchange group that is requested within this invalid key exchange packet was also part of the initial proposal so in",
    "start": "1323919",
    "end": "1330400"
  },
  {
    "text": "this case the the client at the first line it just supports uh defy helman group 14 and it initiates the key",
    "start": "1330400",
    "end": "1336799"
  },
  {
    "text": "exchange using this group uh but then an interceptor could uh simply spoof this",
    "start": "1336799",
    "end": "1342000"
  },
  {
    "text": "um defy hel defy helman key exchange one group um and they would continue using",
    "start": "1342000",
    "end": "1348080"
  },
  {
    "text": "this group so that the client does not check whether the helman group one is actually allowed or not um and of course",
    "start": "1348080",
    "end": "1355200"
  },
  {
    "text": "like an attacker could always use this to to downgrade to the weakest group so for example to defy helmet group one 768",
    "start": "1355200",
    "end": "1362880"
  },
  {
    "text": "bit prime uh that is um dep deprecated or there actually was was never used to",
    "start": "1362880",
    "end": "1368000"
  },
  {
    "text": "be used um in the telco world of course the server side needs also um to support",
    "start": "1368000",
    "end": "1374880"
  },
  {
    "text": "this this key exchange group um and let's take a look at whether they do this or not um so the the goal for our",
    "start": "1374880",
    "end": "1382880"
  },
  {
    "text": "server side scans it was pretty much the same as for our client sites uh scans so we wanted to find out which groups which",
    "start": "1382880",
    "end": "1389840"
  },
  {
    "text": "defy helman groups are supported by EPDG servers and also how do EPDGs react if",
    "start": "1389840",
    "end": "1396400"
  },
  {
    "text": "um if client um if clients would prefer weaker than um the necessary groups",
    "start": "1396400",
    "end": "1401679"
  },
  {
    "text": "because many many things depend on on the behavior of the server here um so we",
    "start": "1401679",
    "end": "1407120"
  },
  {
    "text": "took a look at how how this um this connection procedure is going um",
    "start": "1407120",
    "end": "1412880"
  },
  {
    "text": "and uh what the client what your smartphone does when you um turn on voice Wi-Fi is it uses this pattern here",
    "start": "1412880",
    "end": "1419520"
  },
  {
    "text": "this EPDG pattern um and it uses the MCC and MNC of the current operator it fills",
    "start": "1419520",
    "end": "1425919"
  },
  {
    "text": "out this pattern and it would then resolve this IP address or this this domain to an IP address so you could",
    "start": "1425919",
    "end": "1431840"
  },
  {
    "text": "simply try it out with your own operators ID ids and see uh which which",
    "start": "1431840",
    "end": "1437280"
  },
  {
    "text": "IP address your target operator is using for the EPDG server and then as a second",
    "start": "1437280",
    "end": "1442559"
  },
  {
    "text": "step uh you actually have to do the handshake and for for this we reimplemented the I handshake uh with a",
    "start": "1442559",
    "end": "1449200"
  },
  {
    "text": "Python script uh using scap and here comes the result so uh for",
    "start": "1449200",
    "end": "1456000"
  },
  {
    "text": "the domain resolution we actually found 423 domains uh and 275 were responding",
    "start": "1456000",
    "end": "1462799"
  },
  {
    "text": "to our probing um and again we see the same picture basically as on the client side so the deprecated key exchange",
    "start": "1462799",
    "end": "1469600"
  },
  {
    "text": "group defy helman 2 1024-bit prime is the most popular one so it's um and also",
    "start": "1469600",
    "end": "1475360"
  },
  {
    "text": "like uh the one that was never specified for the telco world defment group one um is also supported by 40% of the servers",
    "start": "1475360",
    "end": "1483200"
  },
  {
    "text": "um so uh yeah this is u not very good um yeah regarding the weaker than",
    "start": "1483200",
    "end": "1490400"
  },
  {
    "text": "necessary um defy helman groups um yeah as already mentioned before like 41% of",
    "start": "1490400",
    "end": "1495919"
  },
  {
    "text": "the ms accepted um less secure methods um so this uh is not ideal 12% um",
    "start": "1495919",
    "end": "1503200"
  },
  {
    "text": "returned without any specific error 40% actually behaved correctly so uh they",
    "start": "1503200",
    "end": "1508720"
  },
  {
    "text": "they desired an upgrade to a stronger group and for the last 4% um we do not",
    "start": "1508720",
    "end": "1514880"
  },
  {
    "text": "actually know what what was going on there because they um actually requested a downgrade to the Fhelman one again so",
    "start": "1514880",
    "end": "1521279"
  },
  {
    "text": "to the weakest group um so this is a little bit strange uh maybe this",
    "start": "1521279",
    "end": "1526880"
  },
  {
    "text": "potentially this could be a panic mode and uh throw away all security principles and make it work at all costs",
    "start": "1526880",
    "end": "1532480"
  },
  {
    "text": "so um yeah but that that's what happens and now uh comes the maybe the",
    "start": "1532480",
    "end": "1539360"
  },
  {
    "text": "the most interesting part of the talk so although I'm using Linux and I'm a Linux guy I actually have to say thank you to",
    "start": "1539360",
    "end": "1546159"
  },
  {
    "text": "Microsoft because I was using Visual Studio Code um when inspecting the the server side scans the log files of our",
    "start": "1546159",
    "end": "1552640"
  },
  {
    "text": "scans and I was clicking on the key exchange value of one operator and suddenly I noticed that uh it reappears",
    "start": "1552640",
    "end": "1559919"
  },
  {
    "text": "in this file so it gets highlighted uh in other rows as well and this is a very",
    "start": "1559919",
    "end": "1565679"
  },
  {
    "text": "strange thing to happen and we'll now see uh what implications this actually",
    "start": "1565679",
    "end": "1571400"
  },
  {
    "text": "has okay so I promise this is the only slide with formulas on it but we'll have",
    "start": "1571400",
    "end": "1578000"
  },
  {
    "text": "to dig a little bit into how the helman key exchange work actually just the",
    "start": "1578000",
    "end": "1583600"
  },
  {
    "text": "first step so uh the defy helman group defines the public prime number p and",
    "start": "1583600",
    "end": "1590320"
  },
  {
    "text": "the and then the public integer g so so",
    "start": "1590320",
    "end": "1595360"
  },
  {
    "text": "that's in the defy helman group uh alis transmits its p uh the or its public key",
    "start": "1595360",
    "end": "1604799"
  },
  {
    "text": "over the wire how is it generated well we have this formula if we rearrange",
    "start": "1604799",
    "end": "1610559"
  },
  {
    "text": "that uh you can see that if P and G is static and capital A is static the only",
    "start": "1610559",
    "end": "1618640"
  },
  {
    "text": "variable left is uh lowerase A the private key and that can't be variable",
    "start": "1618640",
    "end": "1625039"
  },
  {
    "text": "then as well so this means that all these operators were using roundroin",
    "start": "1625039",
    "end": "1631279"
  },
  {
    "text": "style 10 public keys all over again and this means they all had the 10 the same",
    "start": "1631279",
    "end": "1637039"
  },
  {
    "text": "10 private keys so we had 16 operators worldwide all using the same private",
    "start": "1637039",
    "end": "1645960"
  },
  {
    "text": "keys that's kind of defeat the purpose like there are two things private keys",
    "start": "1645960",
    "end": "1652320"
  },
  {
    "text": "should adhere to first they should be random and second they should be private and none of them that is given here",
    "start": "1652320",
    "end": "1662519"
  },
  {
    "text": "so kind of a a big puzzle for us as I said 16 we found 16 operators on",
    "start": "1662679",
    "end": "1670880"
  },
  {
    "text": "three continents with roughly estimation estimated 140 million",
    "start": "1670880",
    "end": "1677159"
  },
  {
    "text": "subscribers and after some digging after doing some some showdown scans and",
    "start": "1677159",
    "end": "1682880"
  },
  {
    "text": "reading press releases it became clear they all used uh core network equipment from",
    "start": "1682880",
    "end": "1690760"
  },
  {
    "text": "ZTE so what to do with that well basically we have two responsible disclosures to",
    "start": "1690760",
    "end": "1697200"
  },
  {
    "text": "do and so end of February beginning of March",
    "start": "1697200",
    "end": "1702240"
  },
  {
    "text": "uh we had those two uh responsible disclosures one to Mediate Techch and",
    "start": "1702240",
    "end": "1707760"
  },
  {
    "text": "one to ZTE via the GSME and they couldn't be more different so MediaTek",
    "start": "1707760",
    "end": "1715200"
  },
  {
    "text": "was super fast in answering our emails but super scarce with all the details",
    "start": "1715200",
    "end": "1721919"
  },
  {
    "text": "all that we know actually we know only after the official um uh blog post came",
    "start": "1721919",
    "end": "1730279"
  },
  {
    "text": "out um we know for example that MediaTek used strong swen on older models but but",
    "start": "1730279",
    "end": "1738960"
  },
  {
    "text": "switched to a own implementation or to a different implementation uh for the newer chips for the 5G chips",
    "start": "1738960",
    "end": "1748240"
  },
  {
    "text": "um only like last week uh we got to know that it's actually their own",
    "start": "1748240",
    "end": "1754080"
  },
  {
    "text": "implementation so there's because we asked them well is this some is this an",
    "start": "1754080",
    "end": "1759120"
  },
  {
    "text": "error that we should upstream to to uh to to a different project okay",
    "start": "1759120",
    "end": "1766320"
  },
  {
    "text": "completely different uh uh thing was the responsible disclosure with setde which",
    "start": "1766320",
    "end": "1772159"
  },
  {
    "text": "we did over the GSMA which also informed all the operators they were very slow in",
    "start": "1772159",
    "end": "1778880"
  },
  {
    "text": "responding but we got much more information out of them so um we for",
    "start": "1778880",
    "end": "1785520"
  },
  {
    "text": "example um their explanation for this hard-coded 10 keys is that those are",
    "start": "1785520",
    "end": "1791840"
  },
  {
    "text": "leftovers from integration testing with some passive DNS scans uh we determined",
    "start": "1791840",
    "end": "1798559"
  },
  {
    "text": "that uh oh uh that the oldest um EPG",
    "start": "1798559",
    "end": "1804640"
  },
  {
    "text": "server uh started somewhere in 2016 and um ZTE confirmed that this error was",
    "start": "1804640",
    "end": "1813120"
  },
  {
    "text": "present since the very first version so for at least or something like around",
    "start": "1813120",
    "end": "1818399"
  },
  {
    "text": "eight years um we uh we have here a list of all the",
    "start": "1818399",
    "end": "1826120"
  },
  {
    "text": "operators and uh since we already had this scanning",
    "start": "1826120",
    "end": "1831720"
  },
  {
    "text": "infrastructure we just uh kept them going once a day once a day we rescanned",
    "start": "1831720",
    "end": "1838559"
  },
  {
    "text": "all the operators and uh we were able to plot this nice graph on how long it took",
    "start": "1838559",
    "end": "1845440"
  },
  {
    "text": "for the operators to patch their systems and it's steadily going down until it",
    "start": "1845440",
    "end": "1851200"
  },
  {
    "text": "suddenly didn't because a new operator uh in Pakistan uh popped suddenly up as",
    "start": "1851200",
    "end": "1857919"
  },
  {
    "text": "uh being vulnerable and again using this static keys uh so we got in touch with",
    "start": "1857919",
    "end": "1866600"
  },
  {
    "text": "ZTE and they explained well it's an uh it's a test setup it's not in production",
    "start": "1866600",
    "end": "1873360"
  },
  {
    "text": "now but uh before it goes into production they will patch it and uh so",
    "start": "1873360",
    "end": "1878399"
  },
  {
    "text": "by end of May uh we were down to zero vulnerable operators and we could like",
    "start": "1878399",
    "end": "1884880"
  },
  {
    "text": "pet ourselves and say well we changed the world for a better place and we forgot about that and uh the scripts the",
    "start": "1884880",
    "end": "1893760"
  },
  {
    "text": "chron job just ran uh still ran once a day and uh a few weeks ago we looked",
    "start": "1893760",
    "end": "1901600"
  },
  {
    "text": "into the data and we realized there are new operators popping",
    "start": "1901600",
    "end": "1907840"
  },
  {
    "text": "up with the same vulnerability and so no names here",
    "start": "1907840",
    "end": "1913279"
  },
  {
    "text": "because this is still under responsible disclosure with GSMA",
    "start": "1913279",
    "end": "1920559"
  },
  {
    "text": "um there's one limitation to our work we did our all our scans from Austria but",
    "start": "1920679",
    "end": "1926960"
  },
  {
    "text": "it as it turns out operators uh engage in geoblocking pretty heavily because uh",
    "start": "1926960",
    "end": "1933679"
  },
  {
    "text": "voice over Wi-Fi is also a good tool to dodge roaming fees so we have a another",
    "start": "1933679",
    "end": "1939919"
  },
  {
    "text": "paper on looking at um those limitations on the geoblocking practices of",
    "start": "1939919",
    "end": "1946399"
  },
  {
    "text": "operators blackhead asked us to boil down three",
    "start": "1946399",
    "end": "1954360"
  },
  {
    "text": "takeaways so um let's let's start with the first",
    "start": "1954360",
    "end": "1959640"
  },
  {
    "text": "one always remove code so in the in the MediaTek case they apparently just",
    "start": "1959640",
    "end": "1966880"
  },
  {
    "text": "yanked out the unwanted uh key exchange uh uh methods from their handshake but",
    "start": "1966880",
    "end": "1974799"
  },
  {
    "text": "never removed the code so it was still accessible and an attacker could trigger",
    "start": "1974799",
    "end": "1980080"
  },
  {
    "text": "the old code in there um so hackers will eventually find it",
    "start": "1980080",
    "end": "1987360"
  },
  {
    "text": "always remove that code use code inspection tools code covering tools if",
    "start": "1987360",
    "end": "1992960"
  },
  {
    "text": "something doesn't show up in your test coverage it better take a look if it's",
    "start": "1992960",
    "end": "1999679"
  },
  {
    "text": "actually needed the second thing is the we need deprecation paths built",
    "start": "1999679",
    "end": "2006880"
  },
  {
    "text": "into our cryptographic standards so just because uh the GS uh the the free GPP",
    "start": "2006880",
    "end": "2014080"
  },
  {
    "text": "standard declared a method as deprecated it doesn't mean that it was erased from",
    "start": "2014080",
    "end": "2019840"
  },
  {
    "text": "the world in the contrary if you look at this uh",
    "start": "2019840",
    "end": "2024880"
  },
  {
    "text": "CIA triangle with confidentiality integrity and availability availability",
    "start": "2024880",
    "end": "2030399"
  },
  {
    "text": "always wins because that's what generates revenue and so the operators will hesitate to actually",
    "start": "2030399",
    "end": "2037799"
  },
  {
    "text": "remove those uh old cryptographic protocols or key exchange methods or uh",
    "start": "2037799",
    "end": "2045600"
  },
  {
    "text": "shorter key lengths because they don't know how many clients were able to upgrade",
    "start": "2045600",
    "end": "2052200"
  },
  {
    "text": "but and and so this is like a reoccurring theme that we see all over again",
    "start": "2052200",
    "end": "2058919"
  },
  {
    "text": "um however we actually know how fast computing power increases over time we",
    "start": "2058919",
    "end": "2066240"
  },
  {
    "text": "have like or we have moose law we have um uh observations uh and we actually",
    "start": "2066240",
    "end": "2074000"
  },
  {
    "text": "could build a deprecation path into those protocols right from the beginning",
    "start": "2074000",
    "end": "2079599"
  },
  {
    "text": "so that it uh it's clear that at some point in the future those uh shorter key",
    "start": "2079599",
    "end": "2086000"
  },
  {
    "text": "lengths will not be supported anymore we don't have to do this dynamically as it",
    "start": "2086000",
    "end": "2092079"
  },
  {
    "text": "is in Bitcoin where it constantly measures the hash rate and then adjust the puzzle strength but just as an",
    "start": "2092079",
    "end": "2099119"
  },
  {
    "text": "estimation we know roughly uh from experience when we need to uh switch to",
    "start": "2099119",
    "end": "2105599"
  },
  {
    "text": "longer keys and the third thing is key freshness so that's why the stinky fish",
    "start": "2105599",
    "end": "2111599"
  },
  {
    "text": "here um for eight years even uh the most primitive",
    "start": "2111599",
    "end": "2119359"
  },
  {
    "text": "statistic anal analysis on the phone or on a client would have revealed that",
    "start": "2119359",
    "end": "2124800"
  },
  {
    "text": "those keys aren't fresh um there are cryptographic protocols",
    "start": "2124800",
    "end": "2131599"
  },
  {
    "text": "where uh both the client and the server actually can ensure uh algorithmically",
    "start": "2131599",
    "end": "2139760"
  },
  {
    "text": "and uh that newly generated keys or random numbers are actually fresh and",
    "start": "2139760",
    "end": "2146480"
  },
  {
    "text": "they can verify each other um but even like very simple statistical tests would",
    "start": "2146480",
    "end": "2152480"
  },
  {
    "text": "have revealed that and that could be implemented on a client itself",
    "start": "2152480",
    "end": "2158720"
  },
  {
    "text": "so all this uh this work uh that we presented now comes from free papers um",
    "start": "2159000",
    "end": "2166480"
  },
  {
    "text": "the so that's all in that uh uh URL there on GitHub we also have uh the",
    "start": "2166480",
    "end": "2173520"
  },
  {
    "text": "tools uh there uh so there is the tool for uh decompiling and decrypting the",
    "start": "2173520",
    "end": "2180480"
  },
  {
    "text": "Qualcomm configurations as well as a tool uh written in scape with scape",
    "start": "2180480",
    "end": "2186599"
  },
  {
    "text": "where you can test your own uh home network operator if it still uses those",
    "start": "2186599",
    "end": "2192640"
  },
  {
    "text": "vulnerable keys um since we have like three more minutes",
    "start": "2192640",
    "end": "2198079"
  },
  {
    "text": "I have one bonus anecdote um so it",
    "start": "2198079",
    "end": "2203440"
  },
  {
    "text": "actually turned out harder than expected to do the responsib responsible disclosure because spam filters got",
    "start": "2203440",
    "end": "2211440"
  },
  {
    "text": "really aggressive so when we reported all this vulnerable network operators",
    "start": "2211440",
    "end": "2217280"
  },
  {
    "text": "with their EPDG servers uh current state-of-the-art uh for many",
    "start": "2217280",
    "end": "2224680"
  },
  {
    "text": "um spam filters is to try to resolve what whatever looks like a DNS name in",
    "start": "2224680",
    "end": "2231599"
  },
  {
    "text": "the text and if that's IP address is on a block list as with some souththeast As",
    "start": "2231599",
    "end": "2239359"
  },
  {
    "text": "uh Asian uh operators us then they block that email uh so we actually had to",
    "start": "2239359",
    "end": "2246000"
  },
  {
    "text": "disguise those uh DNS names or switch to a different email account for that so uh",
    "start": "2246000",
    "end": "2252640"
  },
  {
    "text": "thanks a lot and I think we have time for maybe one or two",
    "start": "2252640",
    "end": "2258078"
  },
  {
    "text": "questions we're happy to see them",
    "start": "2259240",
    "end": "2264200"
  },
  {
    "text": "uh I forgot to mention so um the MediaTek vulnerability was uh uh the fix for that",
    "start": "2264720",
    "end": "2274000"
  },
  {
    "text": "was deployed I think in May or June with the Android security update so you don't have to throw away your old MediaTek",
    "start": "2274000",
    "end": "2280720"
  },
  {
    "text": "phones unless you're out of support then you Yeah",
    "start": "2280720",
    "end": "2286520"
  },
  {
    "text": "okay then thanks a lot and we are still around for seven minutes",
    "start": "2286720",
    "end": "2293079"
  }
]