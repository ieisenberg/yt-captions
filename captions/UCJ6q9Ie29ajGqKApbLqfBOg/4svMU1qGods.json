[
  {
    "start": "0",
    "end": "140000"
  },
  {
    "text": "I'm happy to be here to get a bit ELISA to present some of the work that the automotive security team at history has",
    "start": "0",
    "end": "5670"
  },
  {
    "text": "been working on the last year so today we've been talking about breaking cars and obviously we're not talking about",
    "start": "5670",
    "end": "11040"
  },
  {
    "text": "breaking cars by towing a big rock on them we really talk about breaking cars in a similar fashion attackers would",
    "start": "11040",
    "end": "17490"
  },
  {
    "text": "take when they try to break an embedded system so one of the first steps you want to achieve in when you start",
    "start": "17490",
    "end": "24510"
  },
  {
    "text": "breaking embedded systems is you want to get a certain understanding of the target you really meet this",
    "start": "24510",
    "end": "30150"
  },
  {
    "text": "understanding to a certain degree in order to move to the subsequent steps of identifying vulnerabilities and then",
    "start": "30150",
    "end": "36780"
  },
  {
    "text": "exploiting these vulnerabilities you all agree with me that in order to get this understanding it is efficient to you",
    "start": "36780",
    "end": "43530"
  },
  {
    "text": "have access to the firmer and there's exactly what the first half this thought will be about how to get the firmware",
    "start": "43530",
    "end": "48899"
  },
  {
    "text": "out of embedded systems and please note that whenever I'm talking about embedded systems I'm also talking about the",
    "start": "48899",
    "end": "54780"
  },
  {
    "text": "issues that you find in modern cars of today these little boxes that are present in these cars they're exactly as",
    "start": "54780",
    "end": "61320"
  },
  {
    "text": "an adult system it's a single microcontroller typically with functionality that's very specific put",
    "start": "61320",
    "end": "66780"
  },
  {
    "text": "in a box exactly what an embedded system is about so nowadays in the modern card",
    "start": "66780",
    "end": "72450"
  },
  {
    "text": "is a multitude of different issues all having their own functionality and this is a diagram of a bowling car that's",
    "start": "72450",
    "end": "78330"
  },
  {
    "text": "produced in 2018 and you see that there is a gateway there's an infotainment",
    "start": "78330",
    "end": "83340"
  },
  {
    "text": "system there's engine controls there's sensors there's an instrument cluster",
    "start": "83340",
    "end": "88530"
  },
  {
    "text": "there's all sorts of controllers and just like a metal systems distinct completely in all forms shapes and sizes",
    "start": "88530",
    "end": "94470"
  },
  {
    "text": "and then ice part is that all these issues they're stuck in cars everywhere",
    "start": "94470",
    "end": "99780"
  },
  {
    "text": "in the world anybody has an idea what this picture is about but these are all the cars the returned officer the",
    "start": "99780",
    "end": "105780"
  },
  {
    "text": "dissipates scandal and there's food with issues and these cars are not being used and the same holds off for cars that",
    "start": "105780",
    "end": "111930"
  },
  {
    "text": "crash so part might be broken but most of these issues are still intact and this means that you can typically buy",
    "start": "111930",
    "end": "118380"
  },
  {
    "text": "them very cheaply or your standard sources like eBay and once you start buying all these issues for a very cheap",
    "start": "118380",
    "end": "124680"
  },
  {
    "text": "price compared to the retail value you end up with lots of these years in your lap and I don't even know how many",
    "start": "124680",
    "end": "129929"
  },
  {
    "text": "issues we have in the lab nowadays this is something by the way he pioneered some of the work we talked",
    "start": "129929",
    "end": "135420"
  },
  {
    "text": "about today at this internship at whisker earlier this year so today we're",
    "start": "135420",
    "end": "141090"
  },
  {
    "start": "140000",
    "end": "140000"
  },
  {
    "text": "going to talk about the instrument cluster that's really the dashboard a new car that tells you how fast you're going how much cash you have if he",
    "start": "141090",
    "end": "147930"
  },
  {
    "text": "couldn't left if you going right everybody knows what it is right but the primary reason why we went for this",
    "start": "147930",
    "end": "153210"
  },
  {
    "text": "target is because it has something to look at it's one of the few issues that is in your car that actually has a",
    "start": "153210",
    "end": "158670"
  },
  {
    "text": "visual impact of the events of happening inside the device and who doesn't like",
    "start": "158670",
    "end": "163770"
  },
  {
    "text": "blinking lights right so we're talking about the first step of performing",
    "start": "163770",
    "end": "169680"
  },
  {
    "text": "exploits so get into this understanding of a particular target I mean it the firmware in order to do this properly so",
    "start": "169680",
    "end": "176640"
  },
  {
    "start": "176000",
    "end": "176000"
  },
  {
    "text": "how do we get the firmer out of this device well the easiest way would be if there's a official channel for example",
    "start": "176640",
    "end": "183270"
  },
  {
    "text": "we can extract the farmer from a firmware update or somebody already get to work for us so we can just simply",
    "start": "183270",
    "end": "189780"
  },
  {
    "text": "download the firmware from the internet however for the target that is waiting in front of us here this was not the case nobody did work and the opposite",
    "start": "189780",
    "end": "197130"
  },
  {
    "text": "channels did not allows access to the firmware so with the dashboard in hand we started looking at what the",
    "start": "197130",
    "end": "202920"
  },
  {
    "text": "possibilities were so there's some interfaces because obviously the dashboard has to communicate with the rest of the car there's likely a chip",
    "start": "202920",
    "end": "209430"
  },
  {
    "text": "inside and this chip is obviously getting some form of software but from outside we have no idea what's going on",
    "start": "209430",
    "end": "215400"
  },
  {
    "text": "so I really need to open the device in order to figure out what's going on there so once we open the device we",
    "start": "215400",
    "end": "220920"
  },
  {
    "text": "found indeed a microcontroller this microcontroller was talking to an EPROM chip we extracted the content using",
    "start": "220920",
    "end": "226620"
  },
  {
    "text": "standard tooling we identified lots of interesting data but we had no way of interpreting this data because we had no",
    "start": "226620",
    "end": "233970"
  },
  {
    "text": "understanding of the device and certainly the firmware was not stored here there's the death of there's the",
    "start": "233970",
    "end": "241320"
  },
  {
    "text": "display and that was the reason in order to buy this dashboard because it looks cool however there's also no",
    "start": "241320",
    "end": "247500"
  },
  {
    "text": "functionality to get to the firmer more interestingly we identified several debug interfaces and these are on the",
    "start": "247500",
    "end": "255660"
  },
  {
    "text": "chip they're implemented there by the manufacturer to allow access to the internals of the device but the",
    "start": "255660",
    "end": "261269"
  },
  {
    "text": "manufacturer of this dashboard they did their work properly and they protected this deep interfaces so also this could not be",
    "start": "261270",
    "end": "267150"
  },
  {
    "text": "used to get access to the internals of this device so then we're left with a",
    "start": "267150",
    "end": "272490"
  },
  {
    "text": "bunch of inputs and outputs that we do not understand and the canvas interface that is used to communicate communicate",
    "start": "272490",
    "end": "278520"
  },
  {
    "text": "to the rest of the car but you have no idea what's running here we have no idea what software that's running there but",
    "start": "278520",
    "end": "284190"
  },
  {
    "text": "quickly we realized after analyzing multiple dashboards and multiple other issues that most of them actually can",
    "start": "284190",
    "end": "291300"
  },
  {
    "text": "talk UDS and that's standard protocol that is used by the manufacturers and",
    "start": "291300",
    "end": "297660"
  },
  {
    "text": "the garages in order to pull the car when something is wrong or you can identify what part is failing or what",
    "start": "297660",
    "end": "303870"
  },
  {
    "text": "part might need replacement but also this standard the stripes or mechanisms",
    "start": "303870",
    "end": "310080"
  },
  {
    "text": "to get data in and out of the device for example this is typically used to perform a firmware upgrade or to set",
    "start": "310080",
    "end": "316200"
  },
  {
    "text": "certain configuration options however as you can already imagine some of the",
    "start": "316200",
    "end": "322050"
  },
  {
    "text": "functionalities security-critical so they also demanded a specification security access check that prevents",
    "start": "322050",
    "end": "327630"
  },
  {
    "text": "malicious uses or malicious access to this functionality and the standard includes all sorts of other",
    "start": "327630",
    "end": "333450"
  },
  {
    "text": "functionality than interesting which we will not talk about today so after",
    "start": "333450",
    "end": "338490"
  },
  {
    "start": "337000",
    "end": "337000"
  },
  {
    "text": "analyzing this UDS attack very briefly we indeed identified the functionality in order to hit a ride memory however we",
    "start": "338490",
    "end": "345240"
  },
  {
    "text": "also identified that it was properly protected and without having the right secrets we could not access this",
    "start": "345240",
    "end": "350280"
  },
  {
    "text": "functionality so another approach would be to actually perform vulnerability",
    "start": "350280",
    "end": "355620"
  },
  {
    "text": "analyzes in order to identify a vulnerability and then exploit this however without having access to the fervor and you're still looking for it",
    "start": "355620",
    "end": "361919"
  },
  {
    "text": "this is not an easy task and be like easy things so why would you try to do something difficult if there's",
    "start": "361919",
    "end": "368640"
  },
  {
    "text": "easier manners so let's have a look at the internals of our dashboard again and there's one interface we did not",
    "start": "368640",
    "end": "374039"
  },
  {
    "text": "talk about that you can control and that's the voltage provided to chip so we could off the original voltage in",
    "start": "374039",
    "end": "381030"
  },
  {
    "text": "order to provide your own and it allows us full control over what kind of voltage signal is provided to the target",
    "start": "381030",
    "end": "386100"
  },
  {
    "text": "and once you're capable of doing this you can do some very nifty and that's typically referred to as voltage fault",
    "start": "386100",
    "end": "391950"
  },
  {
    "text": "injection or voltage glitching so how does this work well we all know a chip",
    "start": "391950",
    "end": "396960"
  },
  {
    "text": "needs a stable power of a stable we do not temper a bit of thought whatsoever in this case but we provide",
    "start": "396960",
    "end": "403310"
  },
  {
    "text": "our own photo signal and because of the characteristics of the chip we need to provide a certain for the signal that's",
    "start": "403310",
    "end": "409700"
  },
  {
    "text": "between certain boundaries so in this case it needs to be between 5 point 5 volts and 1 point 8 volt if the voltage",
    "start": "409700",
    "end": "415340"
  },
  {
    "text": "is supplied beyond these boundaries then the behavior of the chip is not guaranteed anyone so if you're a",
    "start": "415340",
    "end": "421730"
  },
  {
    "text": "developer you do not want to go beyond these boundaries and because we control",
    "start": "421730",
    "end": "427070"
  },
  {
    "text": "this focus ourselves we can pull it down and then a chip will stop so we have some form of control over the",
    "start": "427070",
    "end": "432500"
  },
  {
    "text": "microcontroller but obviously stopping the chip is not very useful for us but",
    "start": "432500",
    "end": "437630"
  },
  {
    "text": "if we do this only for a smart moment in time we can make the chip misbehave because it's only running for smart",
    "start": "437630",
    "end": "443540"
  },
  {
    "text": "amongst a small amount of time outside of the intended conditions and this",
    "start": "443540",
    "end": "449180"
  },
  {
    "text": "allows us to change it only at that time without affecting its continuation so really the chip after the glitch is",
    "start": "449180",
    "end": "455210"
  },
  {
    "text": "injected is still operating as it ended and all the software that's running there is still executing as intended so",
    "start": "455210",
    "end": "462140"
  },
  {
    "start": "462000",
    "end": "462000"
  },
  {
    "text": "in order to inject these glasses you need tooling you need specialized tooling we need special voltage hold",
    "start": "462140",
    "end": "467810"
  },
  {
    "text": "injection tooling and nowadays this tooling is easily available and there's open-source variants there's commercial",
    "start": "467810",
    "end": "473780"
  },
  {
    "text": "tooling but the key point here is that fault injection attacks are not something any more that are only performed with specialized labs it is",
    "start": "473780",
    "end": "481160"
  },
  {
    "text": "really something that's available to the masses and this is also something you see in the public domain where lots lots",
    "start": "481160",
    "end": "488180"
  },
  {
    "text": "of people are talking about how about hot injection especially if you compare this to 5 or 10 years ago so the big",
    "start": "488180",
    "end": "495620"
  },
  {
    "start": "494000",
    "end": "494000"
  },
  {
    "text": "question always is that I often get asked is what goes wrong when you're injecting these glitches and that's not",
    "start": "495620",
    "end": "500660"
  },
  {
    "text": "an easy task away from a functional point of view equatorial state if you provide an unstable voltage signal or an",
    "start": "500660",
    "end": "507500"
  },
  {
    "text": "unstable rock signal to the chip the chip will start misbehaving and simply said that's exactly that but to give you",
    "start": "507500",
    "end": "514550"
  },
  {
    "text": "an idea of the things that can go wrong is that the contents that are stored in memory or the contents that are stored",
    "start": "514550",
    "end": "520940"
  },
  {
    "start": "516000",
    "end": "516000"
  },
  {
    "text": "in registers once you start injecting these glitches at the moment in time when you read these registers or memory",
    "start": "520940",
    "end": "527060"
  },
  {
    "text": "is not guaranteed anymore the value that's stored there is correctly transferred over the to your processor and the same thing",
    "start": "527060",
    "end": "534050"
  },
  {
    "text": "holds up for axial data that's retained there once you start injecting these glitches it is not guaranteed that the",
    "start": "534050",
    "end": "539239"
  },
  {
    "text": "data there will be the intended value and more importantly by injecting these",
    "start": "539239",
    "end": "545149"
  },
  {
    "text": "glitches we also have an impact on the processing system responsible for executing your software we really can",
    "start": "545149",
    "end": "551749"
  },
  {
    "text": "change instructions by injecting these races and you can already imagine if you can change instructions you will change",
    "start": "551749",
    "end": "558529"
  },
  {
    "text": "the solver and including the intended behavior of this software and bottom",
    "start": "558529",
    "end": "563749"
  },
  {
    "text": "line you really have to keep in mind that whenever somebody is doing fault injection on a target you cannot trust",
    "start": "563749",
    "end": "570170"
  },
  {
    "text": "the expected behavior of this target anymore any intended things will happen so which can be anticipated but some are",
    "start": "570170",
    "end": "577610"
  },
  {
    "text": "more difficult to anticipate so we can modify instructions you can modify data",
    "start": "577610",
    "end": "582999"
  },
  {
    "text": "yes it also means we can skip instructions and please keep in mind",
    "start": "582999",
    "end": "588470"
  },
  {
    "text": "that whatever we're talking about today is not specific to this dashboard it's not specific to the software running on",
    "start": "588470",
    "end": "593959"
  },
  {
    "text": "the desktop or the platform on which the software is running it's really applicable to everything that is not",
    "start": "593959",
    "end": "599540"
  },
  {
    "text": "specifically considering fault injection when it's designed so enough of the",
    "start": "599540",
    "end": "605360"
  },
  {
    "text": "theory let's actually do something useful so let's start this example so I",
    "start": "605360",
    "end": "611869"
  },
  {
    "text": "mentioned this correction edge which is used to protect the hitting a writing of memory well typically this is",
    "start": "611869",
    "end": "617660"
  },
  {
    "text": "implemented as follows the user the client the hacker whoever talks to the issue in this case design sort request",
    "start": "617660",
    "end": "624679"
  },
  {
    "text": "access gets the channels back performs the transformation on this channel is using a secret sense the responds back",
    "start": "624679",
    "end": "631059"
  },
  {
    "text": "these few checks if the response and the same response is computed on there and it's the same then it proves that both",
    "start": "631059",
    "end": "637160"
  },
  {
    "text": "the develop user and the issue have access to the same secret that the attacker should not have oh if you",
    "start": "637160",
    "end": "643910"
  },
  {
    "text": "remember that they can change instructions it's probably probably possible to change the internal behavior",
    "start": "643910",
    "end": "649819"
  },
  {
    "text": "of that conditional statement by injecting the glitch at that moment in time and that's exactly what we started",
    "start": "649819",
    "end": "655369"
  },
  {
    "start": "655000",
    "end": "655000"
  },
  {
    "text": "doing however on this dashboard we were not successful and it's not because they",
    "start": "655369",
    "end": "661819"
  },
  {
    "text": "could not eject this yet you're perfectly fine injecting these days but the thing was there was a practical hurdle that made his attack not",
    "start": "661819",
    "end": "668000"
  },
  {
    "text": "practical for us cause every three times the centre home response because they do",
    "start": "668000",
    "end": "673730"
  },
  {
    "text": "not have access to the secret a 10-minute delay was set until we could do three responses again you will see",
    "start": "673730",
    "end": "680780"
  },
  {
    "text": "later during the demonstration that is really needed to send a lot of experiments to the target in order to",
    "start": "680780",
    "end": "686630"
  },
  {
    "text": "find the right shape of the glitch in order to find that successful glitch so sometimes you just have to move on",
    "start": "686630",
    "end": "692150"
  },
  {
    "text": "remember we're trying to find something easy we don't want to over complicate these things we just want the firmer so",
    "start": "692150",
    "end": "699140"
  },
  {
    "text": "at the end of the day we want the fervor by reading out some memory so the functionality that's implemented in the",
    "start": "699140",
    "end": "704870"
  },
  {
    "text": "UDS solver is the read memory by address command and we can actually issue this",
    "start": "704870",
    "end": "710540"
  },
  {
    "text": "remote without being authenticated to the security access check so there is something in the issue that verifies if",
    "start": "710540",
    "end": "717020"
  },
  {
    "text": "you're already authenticated or not and exactly that check is exactly the same as where the response was being verified",
    "start": "717020",
    "end": "723080"
  },
  {
    "text": "so if we inject the glitch at that moment in time we will actually be capable of running this command without",
    "start": "723080",
    "end": "729560"
  },
  {
    "text": "having access to the sequence used to authenticate yourself to the target and the best thing here is there's no",
    "start": "729560",
    "end": "735800"
  },
  {
    "text": "10-minute delay they can issue this command with the whole response as many times as we want we're only limited by",
    "start": "735800",
    "end": "742160"
  },
  {
    "text": "the communication speed towards the target so we started doing this and we were successful in this dashboard we",
    "start": "742160",
    "end": "748190"
  },
  {
    "start": "745000",
    "end": "745000"
  },
  {
    "text": "actually did the same attack by the memory by address commands implanted on multiple dashboards on different issues",
    "start": "748190",
    "end": "754160"
  },
  {
    "text": "all of them designed around different microcontrollers showing that this attack is really generic and depending",
    "start": "754160",
    "end": "761420"
  },
  {
    "text": "on the target because we were still bound by the restrictions in the software some of the targets led us to",
    "start": "761420",
    "end": "767030"
  },
  {
    "text": "expect 40 bytes at a time so allowed us to get 100 bytes at a time some allowed the staircase 500 bytes at",
    "start": "767030",
    "end": "773180"
  },
  {
    "text": "a time and also because these microcontrollers were different the internal memories were different as well",
    "start": "773180",
    "end": "778580"
  },
  {
    "text": "so some of them had 500 kilobytes memory the others at 4 megabytes you can really",
    "start": "778580",
    "end": "784610"
  },
  {
    "text": "imagine that if you consider the fact that the amount of bytes you can extract the amount of the success rate of the",
    "start": "784610",
    "end": "792320"
  },
  {
    "text": "glitches and the internal memory size it changes a little bit how much time it takes to get the internal memory result",
    "start": "792320",
    "end": "797420"
  },
  {
    "text": "however we were successful on all targets where this particular command was implemented so",
    "start": "797420",
    "end": "805040"
  },
  {
    "text": "enough talking let's actually show you something we're not changing to the other laptop yet first I would like to",
    "start": "805040",
    "end": "811280"
  },
  {
    "start": "809000",
    "end": "809000"
  },
  {
    "text": "walk you through the setup that we actually have you laid in from the vessel so we have a laptop so a basic",
    "start": "811280",
    "end": "816530"
  },
  {
    "text": "computer and it communicates to our FPAA based later and this glacier has two responsibilities it needs to inject it",
    "start": "816530",
    "end": "823970"
  },
  {
    "text": "lit so it provides an arbitrary voltage signal to the target in which it can inject this weight and it needs to time",
    "start": "823970",
    "end": "829400"
  },
  {
    "text": "this we'll talk about that later and there's a reset signal so like I said when you start injecting these",
    "start": "829400",
    "end": "834980"
  },
  {
    "text": "glitches and it and things will happen and sometimes the chip will get stuck and in that case you need to reset the",
    "start": "834980",
    "end": "841520"
  },
  {
    "text": "chip to nonstate in order to continue your experiments again and then also because we communicate to the dashboard",
    "start": "841520",
    "end": "848720"
  },
  {
    "text": "using canvas interface we need to be able to speak chemists so we have our own canvas interface with Satyricon",
    "start": "848720",
    "end": "854810"
  },
  {
    "text": "which implements additional functionality and in this case we only use one specific thing here is that this",
    "start": "854810",
    "end": "861260"
  },
  {
    "text": "capable setting a trigger signal that allows us to time the glitch at the specific moment in time at the moment it",
    "start": "861260",
    "end": "866720"
  },
  {
    "text": "sends the command so at the moment it's thanks to honk responds we will talk about this a little bit more and this is",
    "start": "866720",
    "end": "872960"
  },
  {
    "text": "the actual command that we're sending so we're trying to read from an actual target 40x bite from a 2-0 and if you",
    "start": "872960",
    "end": "880940"
  },
  {
    "text": "get these bytes out it's a problem because it should not be possible to read this particular address and these",
    "start": "880940",
    "end": "886430"
  },
  {
    "text": "are the first 64 bytes of the firmware that we invested in so everybody that",
    "start": "886430",
    "end": "894260"
  },
  {
    "text": "does some hardware hacking you know that once you start putting things together if cables going everywhere and obviously",
    "start": "894260",
    "end": "900110"
  },
  {
    "text": "this is the exact same set of the relay Infirmary obviously it's not possible to take this set up in the plane and",
    "start": "900110",
    "end": "906430"
  },
  {
    "text": "guarantee that it's gonna work your life on States in Vegas right so we had to do something in order to practice together",
    "start": "906430",
    "end": "913430"
  },
  {
    "text": "in order that it would fit in a luggage put it in check in luggage and open that up here in Vegas again in order for this",
    "start": "913430",
    "end": "919880"
  },
  {
    "text": "setup to work and this is exactly what we are playing in from the vision nothing is different before we switch to",
    "start": "919880",
    "end": "927920"
  },
  {
    "start": "926000",
    "end": "926000"
  },
  {
    "text": "the other laptop to show the demo I want to walk you through the oscilloscope window you're going to see so at the dream signal with one here on",
    "start": "927920",
    "end": "935720"
  },
  {
    "text": "top that's the voltage supplied to the target and the little dip you see there",
    "start": "935720",
    "end": "940730"
  },
  {
    "text": "this label glitch lets the actual glitch we're injecting into this for the signal in order to make the chip do something",
    "start": "940730",
    "end": "946129"
  },
  {
    "text": "else they have signal that is the command being sent towards the target and",
    "start": "946129",
    "end": "951139"
  },
  {
    "text": "response is the response coming back it's embedded in the same signal because the compass interface is a bus so",
    "start": "951139",
    "end": "958100"
  },
  {
    "text": "everything goes over the same signal and the third one the blue one is a trigger",
    "start": "958100",
    "end": "963379"
  },
  {
    "text": "so this is the signal that is set just before the command is being sent out as you can see the signal goes up just",
    "start": "963379",
    "end": "969019"
  },
  {
    "text": "before and this signals taken in by the FPAA based literature in order to time the the glitch and the timing of this",
    "start": "969019",
    "end": "976730"
  },
  {
    "text": "clicks is actually set by The Glades delay so this is the time between the trigger and the moment the case is",
    "start": "976730",
    "end": "982040"
  },
  {
    "text": "injected and then there's two other parameters you need to play with and they have an impact in the shape of the",
    "start": "982040",
    "end": "987350"
  },
  {
    "text": "glitch so how the glitch is observed by the target and that is the glitch with",
    "start": "987350",
    "end": "992360"
  },
  {
    "text": "such as what this is called here the case duration so that is the width of the pulse that goes down and there's the",
    "start": "992360",
    "end": "998810"
  },
  {
    "text": "gates voltage and that's really the amplitudes towards the tip is being made in the voltage signal one thing that the",
    "start": "998810",
    "end": "1009240"
  },
  {
    "start": "1006000",
    "end": "1006000"
  },
  {
    "text": "registration and the gates foetus have in common is that a form some form of",
    "start": "1009240",
    "end": "1014529"
  },
  {
    "text": "relationship because they define the shape of this place so if you glitch too",
    "start": "1014529",
    "end": "1020050"
  },
  {
    "text": "strong so the combination between eaglets foetus and the glyphs race is too strong then the target is not capable of continuing anymore and we",
    "start": "1020050",
    "end": "1026589"
  },
  {
    "text": "want that right we want to send the response inject the glitch but also get the data from the firmware back so we're",
    "start": "1026589",
    "end": "1032980"
  },
  {
    "text": "going to top that you see all the combinations where the base was too strong the yellow area on the bottom right is it a green area and these are",
    "start": "1032980",
    "end": "1039640"
  },
  {
    "text": "all the glitches where the combination is too weak so there's no impact on the target whatsoever between those two",
    "start": "1039640",
    "end": "1046360"
  },
  {
    "text": "areas you see something interesting you see all these red dots and these are actually all successful places where we",
    "start": "1046360",
    "end": "1052059"
  },
  {
    "text": "extracted 40x bytes from the internal firmware of this device so in order to",
    "start": "1052059",
    "end": "1057100"
  },
  {
    "text": "increase the success rate which is important because we need a lot of glitches in order to get four megabytes of internal memory out we can focus",
    "start": "1057100",
    "end": "1064840"
  },
  {
    "text": "on the parameter space there are these red dots appear and this increases the success rate and it also allows us to",
    "start": "1064840",
    "end": "1070299"
  },
  {
    "text": "actually do this here life in States if you could not increase the success rate it would not be possible can we switch",
    "start": "1070299",
    "end": "1077049"
  },
  {
    "text": "to the other laptop so what you see here on the left side is the exact same",
    "start": "1077049",
    "end": "1083649"
  },
  {
    "text": "picture from the accessibility show cell before mr. voltage there's the communication there's a tape and on the",
    "start": "1083649",
    "end": "1089830"
  },
  {
    "text": "right side you actually see the communication towards RF behavior",
    "start": "1089830",
    "end": "1095110"
  },
  {
    "text": "so on the first column you see you polar that represents exactly the same as the plot game for two week yellow for too",
    "start": "1095110",
    "end": "1101259"
  },
  {
    "text": "strong a cat for successfully and then we see that since we are here in this room we performed roughly 3000",
    "start": "1101259",
    "end": "1108059"
  },
  {
    "text": "experiments we deviate the glitch delay which is nanoseconds a little bit we fix",
    "start": "1108059",
    "end": "1114039"
  },
  {
    "text": "the glitch duration because there's this relationship between the glyph duration and the glitch voltage we randomize the",
    "start": "1114039",
    "end": "1119710"
  },
  {
    "text": "cleats for this a little bit because one thing to realize is that the parameters of itlet's they're also affected by the",
    "start": "1119710",
    "end": "1126039"
  },
  {
    "text": "ambient temperature so the temperature in the Netherlands where the problem is different than in this casino here in",
    "start": "1126039",
    "end": "1131470"
  },
  {
    "text": "Vegas where the air conditioning is brutal but if something would go wrong",
    "start": "1131470",
    "end": "1138669"
  },
  {
    "text": "we could change the parameters here we're not going to do that but more importantly for the people that know UDS",
    "start": "1138669",
    "end": "1144580"
  },
  {
    "text": "what we see here in the data problem is actually the response of the target so the first by this oh I'm gonna interrupt",
    "start": "1144580",
    "end": "1150399"
  },
  {
    "text": "myself this is actually a successful glitch these are the 40 bytes from the internal firmer that is laying in front",
    "start": "1150399",
    "end": "1156639"
  },
  {
    "text": "of me that should not come out here live on stage in Vegas it's pretty cool but what you can see here in the data here",
    "start": "1156639",
    "end": "1163330"
  },
  {
    "text": "is that seven half is 0.23 means we are sending the heat memory by address 33",
    "start": "1163330",
    "end": "1169240"
  },
  {
    "text": "means you're not authenticated well that's all as expected well because this is called true we save one of the",
    "start": "1169240",
    "end": "1174879"
  },
  {
    "text": "results notice this is the exact same experience we started today so this successful result is also obtained here",
    "start": "1174879",
    "end": "1181600"
  },
  {
    "text": "live on stage so what you can see here is the 63 that means did is to collect the",
    "start": "1181600",
    "end": "1188440"
  },
  {
    "text": "turncoat and the rest of these bytes are exceeded 40 X bytes are interested in typically what's stored there are the",
    "start": "1188440",
    "end": "1194080"
  },
  {
    "text": "reset vector and the exception factors for the people that are good at mechanician you see all of the same",
    "start": "1194080",
    "end": "1200020"
  },
  {
    "text": "fights going on so probably it's the great data so what I'm interested in is",
    "start": "1200020",
    "end": "1206230"
  },
  {
    "text": "how many glitches did we get since the beginning and this is the tool to plot our experiments so this is the same the",
    "start": "1206230",
    "end": "1212530"
  },
  {
    "text": "videos for plotting the plot I showed you earlier you see by the red diamonds",
    "start": "1212530",
    "end": "1218170"
  },
  {
    "text": "that we did not get too many glitches but at least we got some and it really shows the fault injection is not too",
    "start": "1218170",
    "end": "1224710"
  },
  {
    "text": "difficult you can do here live on stage on a real car or on a real target from a modern car that's being produced",
    "start": "1224710",
    "end": "1231090"
  },
  {
    "text": "recently can we back to go back to the other laptop so you probably noticed and",
    "start": "1231090",
    "end": "1241720"
  },
  {
    "start": "1239000",
    "end": "1239000"
  },
  {
    "text": "I already said it there's not a 100% success rate and you would like to build",
    "start": "1241720",
    "end": "1247120"
  },
  {
    "text": "up to a skosh as you can get to this on a percent success rate especially when you need thousands of successful",
    "start": "1247120",
    "end": "1252880"
  },
  {
    "text": "glitches in order to get the internal firmware out well you probably already saw it in your sales code window is that",
    "start": "1252880",
    "end": "1259570"
  },
  {
    "text": "there's something interesting going on the reference point that we used to glitch is it's a moment in time the",
    "start": "1259570",
    "end": "1266020"
  },
  {
    "text": "command we send out is the same moment in time but the response that comes back from the target is not always at the same moment in time and is this because",
    "start": "1266020",
    "end": "1273220"
  },
  {
    "text": "our reference point is decoupled from the moment we want a glitch from the event we want to do it it's not composed",
    "start": "1273220",
    "end": "1278950"
  },
  {
    "text": "to the authentication check so in order to increase the success rate significantly we need a way to couple",
    "start": "1278950",
    "end": "1286920"
  },
  {
    "text": "the reference points to the other indication check and this is something that's certainly possible it increases",
    "start": "1286920",
    "end": "1293050"
  },
  {
    "text": "the complexity of the setup and this is really something is for another day so after having enough successful",
    "start": "1293050",
    "end": "1300010"
  },
  {
    "text": "glitches you got the firmware out but the firmer at the end of the day there might be some strings in there but this is just a binary book what are we gonna",
    "start": "1300010",
    "end": "1307330"
  },
  {
    "text": "do with this firmer and this is exactly where Elesha comes into play so hi",
    "start": "1307330",
    "end": "1314680"
  },
  {
    "text": "so this is basically the story so far we have a part of firmware it's a huge",
    "start": "1314680",
    "end": "1320620"
  },
  {
    "text": "binary blow up and we want to do something with it the idea was understanding so just kind of to go back",
    "start": "1320620",
    "end": "1326320"
  },
  {
    "text": "to the high-level plan here we wanted to get the firmware it was a great success we did it here on stage",
    "start": "1326320",
    "end": "1332470"
  },
  {
    "start": "1328000",
    "end": "1328000"
  },
  {
    "text": "there were glitches and the next step I hope you can guess is to do some kind of reverse engineering but the reverse",
    "start": "1332470",
    "end": "1339820"
  },
  {
    "text": "engineering of course isn't the goal here the goal is to obtain this understanding that we had in the first place and why do we want this",
    "start": "1339820",
    "end": "1346030"
  },
  {
    "text": "understanding well different people might have different goals you might want to do some chip tuning on your engine you might want some kind of",
    "start": "1346030",
    "end": "1352450"
  },
  {
    "text": "secrets maybe to make aftermarket tools you might want to actually find some vulnerabilities probably very popular",
    "start": "1352450",
    "end": "1358570"
  },
  {
    "text": "here so it should be easy right we have this firmware blob we could do some kind of static analysis and everything will",
    "start": "1358570",
    "end": "1365260"
  },
  {
    "start": "1363000",
    "end": "1363000"
  },
  {
    "text": "be clear and kind of the typical way this works is you have her some kind of operating system code maybe Linux",
    "start": "1365260",
    "end": "1370720"
  },
  {
    "text": "VxWorks Q and X and you have some kind of ECU specific code maybe something to drive your display to handle inputs maybe an",
    "start": "1370720",
    "end": "1377830"
  },
  {
    "text": "application on your file system and you can simply reverse engineer this application of course and the automotive",
    "start": "1377830",
    "end": "1383590"
  },
  {
    "text": "world for these is used for many issues this is not how it works what actually",
    "start": "1383590",
    "end": "1389200"
  },
  {
    "text": "happens is you get a blob and okay you might say okay but they're still going",
    "start": "1389200",
    "end": "1394450"
  },
  {
    "text": "to be something like maybe we ought on operating system but it's still kind of separate and you're going to have some custom code one of the big problems is",
    "start": "1394450",
    "end": "1401020"
  },
  {
    "text": "this is not quite how it works what actually happens is you have a huge amount of generated code so you have",
    "start": "1401020",
    "end": "1407260"
  },
  {
    "text": "some kind of configuration and might differ to a market might differ per brand of the car per model of the car",
    "start": "1407260",
    "end": "1414669"
  },
  {
    "text": "and you also have these models which defined at a very high level using something like Simulink on this old",
    "start": "1414669",
    "end": "1420850"
  },
  {
    "text": "generator generated code which goes into your firmware block worse the parts of your operating system code are also",
    "start": "1420850",
    "end": "1427659"
  },
  {
    "text": "generated from this system so you might say okay we can just kind of match these operating system functions but often",
    "start": "1427659",
    "end": "1433030"
  },
  {
    "text": "these actually look very very different so that means we end up with kind of",
    "start": "1433030",
    "end": "1438159"
  },
  {
    "text": "incomprehensible blobs this is a screenshot from either post graph tool and as you can guess by the fact I'm",
    "start": "1438159",
    "end": "1443530"
  },
  {
    "text": "saying Ida Pro the good news is the firmware we're going to be looking at which is the firmware running on this",
    "start": "1443530",
    "end": "1448929"
  },
  {
    "start": "1444000",
    "end": "1444000"
  },
  {
    "text": "instrument cluster we've been glittery bright in front of us is supported by popular static analysis tools I must say",
    "start": "1448929",
    "end": "1455080"
  },
  {
    "text": "at this point we're clearly trying to keep this anonymous many of you can pretty kind of guess what's going on but",
    "start": "1455080",
    "end": "1460720"
  },
  {
    "text": "we don't want to pick on a specific manufacturer or specific processor as nique said this is a very",
    "start": "1460720",
    "end": "1466240"
  },
  {
    "text": "generic problem and so we're just gonna leave the architecture anonymous and the",
    "start": "1466240",
    "end": "1472270"
  },
  {
    "text": "fun thing is we chose an interesting target that it's not actually that well supported by your first engineering",
    "start": "1472270",
    "end": "1477970"
  },
  {
    "text": "tours well that's fine you can patch these up that's a known problem kind of",
    "start": "1477970",
    "end": "1483880"
  },
  {
    "text": "our worst problem is we talked okay this is very complex static analysis are gonna be a pain but dynamic analysis",
    "start": "1483880",
    "end": "1489910"
  },
  {
    "text": "should come to our rescue and let us get understanding quickly of course this architecture is also not",
    "start": "1489910",
    "end": "1495370"
  },
  {
    "text": "supported by any standard dynamic analysis tools so if you don't have any tools then what you do as a reverse",
    "start": "1495370",
    "end": "1501280"
  },
  {
    "text": "engineer you make some tools so I'm going to quickly go through how we vote an emulator let us do dynamic analysis",
    "start": "1501280",
    "end": "1507070"
  },
  {
    "text": "on this firmware so we go back to our kind of initial view we open up the",
    "start": "1507070",
    "end": "1512980"
  },
  {
    "start": "1509000",
    "end": "1509000"
  },
  {
    "text": "instrument cluster and what kind of things have in now what are we going to need in our emulator in order to",
    "start": "1512980",
    "end": "1518620"
  },
  {
    "text": "actually behave the same as the instrument cluster here well we have a microcontroller so we're going to need",
    "start": "1518620",
    "end": "1523930"
  },
  {
    "text": "to emulate this instruction set it's not supported by QEMU and so forth but sure we're also gonna need all these",
    "start": "1523930",
    "end": "1529630"
  },
  {
    "text": "peripherals we're gonna need timers interrupts all kinds of this boring stuff but we also have this e form in this plate that's",
    "start": "1529630",
    "end": "1535690"
  },
  {
    "text": "fine we can emulate those too but then they're connected by I squared C we're going to I squared C we're going to need",
    "start": "1535690",
    "end": "1541030"
  },
  {
    "text": "IO we're going to need cam okay so let's actually look how painful is this to do",
    "start": "1541030",
    "end": "1546490"
  },
  {
    "text": "we can emulate the CPU architecture itself which is just a lot of reading data sheets it's boring but you can do",
    "start": "1546490",
    "end": "1552940"
  },
  {
    "start": "1547000",
    "end": "1547000"
  },
  {
    "text": "it it's a good opportunity to take advantage if you've once ever wanted to",
    "start": "1552940",
    "end": "1558850"
  },
  {
    "text": "write a game point emulator that kind of thing is really good experience for this kind of thing but then the complicated",
    "start": "1558850",
    "end": "1564430"
  },
  {
    "start": "1563000",
    "end": "1563000"
  },
  {
    "text": "part is all these peripherals the good news is again we're not going perfection all we need is to get the firmware",
    "start": "1564430",
    "end": "1570700"
  },
  {
    "text": "running in the correct way and it turns out you can actually stop out all of these perforce and if ECU is often very",
    "start": "1570700",
    "end": "1576610"
  },
  {
    "text": "concerned about their power supply in their clocks this dedicated hardware and these chips for monitoring these things",
    "start": "1576610",
    "end": "1581860"
  },
  {
    "text": "but we don't really care we can just lie to the firmware and say everything is absolutely fine sometimes we just don't",
    "start": "1581860",
    "end": "1587680"
  },
  {
    "text": "implement these perforce then we just not actually as much work as it seems so how painful is it to actually do this",
    "start": "1587680",
    "end": "1593650"
  },
  {
    "start": "1592000",
    "end": "1592000"
  },
  {
    "text": "well I wrote before Christmas last year an emulator for this target and I was",
    "start": "1593650",
    "end": "1599350"
  },
  {
    "text": "kind of working about a week of work it was a sleepless work my family were away and of course I",
    "start": "1599350",
    "end": "1604990"
  },
  {
    "text": "decide to spend my free time winding a crazy emulator for this thing and I have",
    "start": "1604990",
    "end": "1610660"
  },
  {
    "text": "had a chance doing this before but still it's something that's fun to do and I'm sure many of you can can do this and",
    "start": "1610660",
    "end": "1617110"
  },
  {
    "text": "it's fun to try at least for something like the Gameboy and how much code in it you can guess if I did it in a week it's",
    "start": "1617110",
    "end": "1623500"
  },
  {
    "text": "not that much code it's about 3,000 lines of code in the end not including so with a neat toss and we're going to",
    "start": "1623500",
    "end": "1629200"
  },
  {
    "text": "show in a moment but this was enough to make it work so this is surprisingly practical a lot of people say in no way",
    "start": "1629200",
    "end": "1635440"
  },
  {
    "text": "this is way too complicated but you can certainly get this working relatively efficiently so why did we do it in the",
    "start": "1635440",
    "end": "1643360"
  },
  {
    "start": "1642000",
    "end": "1642000"
  },
  {
    "text": "first place we're going for understanding right then we got a bit distracted here suddenly we have an emulator it's a week of work why would",
    "start": "1643360",
    "end": "1648880"
  },
  {
    "text": "you did this well obviously it lets us debug things that she's single step through the code which gives you a",
    "start": "1648880",
    "end": "1654220"
  },
  {
    "text": "reasonable idea of what's going on set breakpoints it also allows you to hook",
    "start": "1654220",
    "end": "1659410"
  },
  {
    "text": "up a wheel can network you can hook this emulator up to socket can on Linux that",
    "start": "1659410",
    "end": "1665410"
  },
  {
    "text": "means you can use standard camp penetration testing tools but also you can hook it up to your actual car which",
    "start": "1665410",
    "end": "1670990"
  },
  {
    "text": "you took your instrument cluster form or simply other issues from the car and that lets you have a much relatively",
    "start": "1670990",
    "end": "1677760"
  },
  {
    "text": "real environment and you don't have to go kind of trying to work out which can",
    "start": "1677760",
    "end": "1683200"
  },
  {
    "text": "messages you have to play but it also means that you can play some neat dynamic analysis tricks these are",
    "start": "1683200",
    "end": "1689650"
  },
  {
    "text": "relatively standard but I'm going to quickly go through the tricks that we found useful here the first one of which",
    "start": "1689650",
    "end": "1695080"
  },
  {
    "start": "1694000",
    "end": "1694000"
  },
  {
    "text": "is execution tracing so this is a screenshot for Ida Pro I've named things nicely here this is the function responsible for doing the checksums on",
    "start": "1695080",
    "end": "1702730"
  },
  {
    "text": "top of the content of the EEPROM in this device but of course if you don't have names for this you just have this huge",
    "start": "1702730",
    "end": "1708520"
  },
  {
    "text": "blob of firmware how enough you meant to go no what's going on well the first track first trick used to see which code",
    "start": "1708520",
    "end": "1714670"
  },
  {
    "text": "is actually being executed because I we know from experience one of my colleagues tried just doing the",
    "start": "1714670",
    "end": "1719980"
  },
  {
    "text": "traditional static analysis approach on this firmware it turns if you start at the start and just kind of look at the",
    "start": "1719980",
    "end": "1725290"
  },
  {
    "text": "functions that looked likely to be executed you will find a UDS implementation in there somewhere but",
    "start": "1725290",
    "end": "1730780"
  },
  {
    "text": "it's the wrong UDS implementation there's actually two yes implementations on this thing and only one of them is used during normal",
    "start": "1730780",
    "end": "1736930"
  },
  {
    "text": "one time so you really want to know what code is actually being used but that's fine you can just have a bunch of",
    "start": "1736930",
    "end": "1743140"
  },
  {
    "text": "candidate instructions in your static analysis tour like Ida which might get executed you run it in the emulator and",
    "start": "1743140",
    "end": "1749410"
  },
  {
    "text": "now you know which instructure's did get executed and then you can just add color codings your static analysis tour and",
    "start": "1749410",
    "end": "1754690"
  },
  {
    "text": "this makes things much easier but the reason I picked the EEPROM checksum example here is what happens if we run",
    "start": "1754690",
    "end": "1761260"
  },
  {
    "text": "the emulator again but we flip some bits in the EEPROM what happens well certainly a different path gex executed",
    "start": "1761260",
    "end": "1767380"
  },
  {
    "text": "and this is quite a neat trick that once you have some kind of dynamic analysis touring it really it lets you see",
    "start": "1767380",
    "end": "1773590"
  },
  {
    "text": "oh-hoh we changed this input or we changed this state and suddenly this",
    "start": "1773590",
    "end": "1778780"
  },
  {
    "text": "code is executed that must be your error path or that must be whatever's responsible handling this code there's",
    "start": "1778780",
    "end": "1784330"
  },
  {
    "text": "also something called taint analysis which we use very useful so the idea is",
    "start": "1784330",
    "end": "1789430"
  },
  {
    "start": "1786000",
    "end": "1786000"
  },
  {
    "text": "that you have some kind of input to your program in this case we're going to pick a canned message which you see why in a",
    "start": "1789430",
    "end": "1796030"
  },
  {
    "text": "moment and the idea is that you would pertain to this canned message you give it some kind of color and then when the",
    "start": "1796030",
    "end": "1804400"
  },
  {
    "text": "firmware reads from this purple with this canned message and write it to memory which is on the left side of the",
    "start": "1804400",
    "end": "1810400"
  },
  {
    "text": "screen here then you propagate the taint so you also kind of keep track of this and you can do that because you have an",
    "start": "1810400",
    "end": "1816370"
  },
  {
    "text": "emulator it also tours like Avatar to which do this for more standard",
    "start": "1816370",
    "end": "1821560"
  },
  {
    "text": "architectures and again you can propagate this chain so if you copy from one location in memory to another war between registers then you also",
    "start": "1821560",
    "end": "1828790"
  },
  {
    "text": "propagate the taint and eventually when you do something with it effects control flow with this data then you can say I",
    "start": "1828790",
    "end": "1835180"
  },
  {
    "text": "have this comparison depends on the input and so why is this useful word let's go all the way back to this",
    "start": "1835180",
    "end": "1840520"
  },
  {
    "text": "annoying security access check that flummoxed us a bit earlier we have this",
    "start": "1840520",
    "end": "1846220"
  },
  {
    "text": "response so it's a challenge response mechanism so we send some random response to the emulator in response to",
    "start": "1846220",
    "end": "1852490"
  },
  {
    "text": "the security access check and we propagate this taint and then at some point the emulative is going to execute",
    "start": "1852490",
    "end": "1858850"
  },
  {
    "text": "the comparison which checks is this the correct response and then a hat so what we've actually done is we found where",
    "start": "1858850",
    "end": "1865060"
  },
  {
    "text": "this comparison is which means we found a KO this responsible for this and it turns out you could just repeat this once you",
    "start": "1865060",
    "end": "1870610"
  },
  {
    "text": "have an emulator working you can take a bunch of different firmware and you can simply find these comparisons and find where is this security access function",
    "start": "1870610",
    "end": "1877509"
  },
  {
    "text": "and certainly you can calculate your own responses I'm going to show you a quick",
    "start": "1877509",
    "end": "1882730"
  },
  {
    "start": "1881000",
    "end": "1881000"
  },
  {
    "text": "demo of another way in which having an emulator really helps you understand",
    "start": "1882730",
    "end": "1888789"
  },
  {
    "text": "these things but first I'm just going to give you kind of a very pretty incorrect viewpoint over a high level of how this",
    "start": "1888789",
    "end": "1895450"
  },
  {
    "text": "automotive software works at least on this instrument cluster so I kind of had a global tea you have some kind of",
    "start": "1895450",
    "end": "1901419"
  },
  {
    "text": "software components which we don't care about inside the software component you have different tasks so the real-time",
    "start": "1901419",
    "end": "1907179"
  },
  {
    "text": "operating system is going to be scheduling these different tasks with different priorities and so if you have a higher priority task for example on",
    "start": "1907179",
    "end": "1915730"
  },
  {
    "text": "the dashboard some of your warning lights are much more important than say something repeating your car video names",
    "start": "1915730",
    "end": "1923440"
  },
  {
    "text": "and then inside that you have these things called runner boards which are basically individual pieces of code",
    "start": "1923440",
    "end": "1928899"
  },
  {
    "text": "responsible kind of football action and you also have communication between them so you have an avro coming in on the",
    "start": "1928899",
    "end": "1934389"
  },
  {
    "text": "left that might be an incoming security access message the first one of all might be possible for handling UDS and",
    "start": "1934389",
    "end": "1940059"
  },
  {
    "text": "then it might wake up and offer belabor that's responsible for actually handling the specific UDS message you responded",
    "start": "1940059",
    "end": "1948129"
  },
  {
    "text": "with so this is actually the emulator life in action and this is a",
    "start": "1948129",
    "end": "1954220"
  },
  {
    "text": "visualization view that kind of lets you see on a timeline basis what's going on so the further to the right you go as",
    "start": "1954220",
    "end": "1961210"
  },
  {
    "text": "increased time and we're running this into your time so I'm going to filter the events of it also everywhere with a",
    "start": "1961210",
    "end": "1967840"
  },
  {
    "text": "different event for example at the top here you have can messages you have intimate handlers and below here you",
    "start": "1967840",
    "end": "1974830"
  },
  {
    "text": "actually have tasks and then you have some individual adabot so if I pause the simulation a moment and go back to the start of the execution then you can see",
    "start": "1974830",
    "end": "1982240"
  },
  {
    "text": "that the start of the execution we have a timer starting up where the early an EPROM we have one task which is very",
    "start": "1982240",
    "end": "1988029"
  },
  {
    "text": "suspiciously firing basically when the EEPROM interrupts are happening when there's something being read from the",
    "start": "1988029",
    "end": "1993100"
  },
  {
    "text": "EEPROM and then you have these vulnerables which are also happening at the same time and we can look at this and actually say AHA these are",
    "start": "1993100",
    "end": "2000059"
  },
  {
    "text": "responsible for doing this of course you need to know where the tasks and wonder balls are but you can find those surprisingly easy once you",
    "start": "2000059",
    "end": "2006639"
  },
  {
    "text": "know what you're looking for so give you another example we discussed earlier about the this jitter that we saw when",
    "start": "2006639",
    "end": "2015519"
  },
  {
    "text": "sending a security access message and if we do the same in the emulator so this",
    "start": "2015519",
    "end": "2020830"
  },
  {
    "text": "line here if that represents incoming count messages and this line here at the top that's the outgoing kam message",
    "start": "2020830",
    "end": "2027460"
  },
  {
    "text": "which responds to the read memory by address which was giving us all this jitter so if I hold down a key on my",
    "start": "2027460",
    "end": "2034539"
  },
  {
    "text": "keyboard this kind of repeatedly sends these messages you see you're actually seeing a lot of jitter there and the",
    "start": "2034539",
    "end": "2039969"
  },
  {
    "text": "reason why can be seen here so what's happened here is we've received a canned message but at the time there's a task",
    "start": "2039969",
    "end": "2047019"
  },
  {
    "text": "running and that task happens to be higher priority than task is responsible for handling our UDS messages and that",
    "start": "2047019",
    "end": "2053378"
  },
  {
    "text": "means that the response simply gets delayed until that task is finished on the tasks and the runner post",
    "start": "2053379",
    "end": "2059378"
  },
  {
    "text": "responsible for handling the read memory by address a hand dot and this means that it's basically entirely dependent",
    "start": "2059379",
    "end": "2065799"
  },
  {
    "text": "on the internal task state of this thing what's happening which interrupts are burning exactly when the response is",
    "start": "2065799",
    "end": "2070960"
  },
  {
    "text": "sent and that means the jitter is maybe inevitable and you can do a few cool things with this so I'm going to bring",
    "start": "2070960",
    "end": "2077500"
  },
  {
    "text": "up the dashboard here we're going to leave it running and you can see there's",
    "start": "2077500",
    "end": "2083378"
  },
  {
    "text": "no left indicator light showing on the dashboard here what I can do is I can switch to a lender terminal and use a",
    "start": "2083379",
    "end": "2090220"
  },
  {
    "text": "standard socket hand tool to send a message here which should turn on the Left indicator and if I do that then the",
    "start": "2090220",
    "end": "2096608"
  },
  {
    "text": "lifter indicator does turn on it's a city example but this is fun to set up we don't actually do this in",
    "start": "2096609",
    "end": "2102819"
  },
  {
    "text": "practice setting up fake dashboards to kind of know what's going on but I gives you an idea you can really use standard ice touring here so just to kind of wrap",
    "start": "2102819",
    "end": "2112900"
  },
  {
    "start": "2112000",
    "end": "2112000"
  },
  {
    "text": "up what we've seen so far we shown your hardware is going to portray you it's basically the message here fault",
    "start": "2112900",
    "end": "2118750"
  },
  {
    "text": "injection lets attackers really pull the ground out from under your software so",
    "start": "2118750",
    "end": "2124089"
  },
  {
    "text": "the eminating a dashboards not too tricky it's something you can actually do it works for many issues and many",
    "start": "2124089",
    "end": "2129430"
  },
  {
    "text": "embedded systems and we know the false rejection attacks on UTS there such as one we described they're pretty core",
    "start": "2129430",
    "end": "2135070"
  },
  {
    "text": "but the thing is if you have an ECU if you need to get the firmware out of an issue and a better system how many of",
    "start": "2135070",
    "end": "2140980"
  },
  {
    "text": "you are going to look back to this black hat talk and go I know I learned about this really cool attack I can replicate",
    "start": "2140980",
    "end": "2146410"
  },
  {
    "text": "that that sounds efficient and easy just any hands I'm not seeing a lot of",
    "start": "2146410",
    "end": "2151540"
  },
  {
    "text": "support here and it's not an efficient attack it's crazily overcomplicated I mean it's nice it works it was really",
    "start": "2151540",
    "end": "2158350"
  },
  {
    "text": "neat work but it turns out actually there were much easier ways to get firmware out of these things so if we go",
    "start": "2158350",
    "end": "2163630"
  },
  {
    "text": "back to kind of our high-level view let's go back to our assumptions one of the things we kind of dismissed at the",
    "start": "2163630",
    "end": "2168970"
  },
  {
    "text": "start was this debug port because maybe it's locked down maybe there's a password but there is almost certainly",
    "start": "2168970",
    "end": "2174820"
  },
  {
    "text": "going to be some kind of debugging space on this thing and the bad news is generally this debug interface",
    "start": "2174820",
    "end": "2179920"
  },
  {
    "start": "2179000",
    "end": "2179000"
  },
  {
    "text": "protection is implemented in software in some kind of butuan and I hope you've learnt your hardware's going to betray",
    "start": "2179920",
    "end": "2185380"
  },
  {
    "text": "you if you have software we can change the software from underneath you we install the ditch here - oh the glitch",
    "start": "2185380",
    "end": "2191170"
  },
  {
    "text": "here and the debug port will open and what's amazing about this is you only have to be successful once for this to",
    "start": "2191170",
    "end": "2198130"
  },
  {
    "text": "work you just open this debugging space once and you can pull all of the firmware out and this trick also works",
    "start": "2198130",
    "end": "2203530"
  },
  {
    "text": "on pretty much for many of the ECU's that we've looked at what else can we do here well we saw all these cables and",
    "start": "2203530",
    "end": "2210070"
  },
  {
    "text": "stuff this is very fiddly but how about instead of heading attacking the voltage we just head straight for the MCU so",
    "start": "2210070",
    "end": "2216970"
  },
  {
    "text": "this is an electromagnetic force injection probe so this sense basically",
    "start": "2216970",
    "end": "2222220"
  },
  {
    "text": "electromagnetic pulses for the distance you usually have it somewhat closer to the chip for it to work but basically it",
    "start": "2222220",
    "end": "2228250"
  },
  {
    "text": "generates thoughts using electromagnetic forces and again the Vark commercial",
    "start": "2228250",
    "end": "2234310"
  },
  {
    "start": "2233000",
    "end": "2233000"
  },
  {
    "text": "tools available for this there's chip shouter which i hear will be available any day now or looking forward to it there's also commercial",
    "start": "2234310",
    "end": "2240550"
  },
  {
    "text": "risk your tools and this open source tools for those of you who are even crazier and again these tools they're",
    "start": "2240550",
    "end": "2246820"
  },
  {
    "text": "really available to the masses so this is something that people are actually doing and it's something you can actually do it may be more expensive to",
    "start": "2246820",
    "end": "2253900"
  },
  {
    "text": "get started on but it does mean you don't have to worry about all these cables so just a kind of hammer at this",
    "start": "2253900",
    "end": "2260200"
  },
  {
    "start": "2258000",
    "end": "2258000"
  },
  {
    "text": "point home a bit that's universal we're not picking on what device or one ECU it works on pretty much everything all CPUs",
    "start": "2260200",
    "end": "2267310"
  },
  {
    "text": "all microcontrollers and it works on all software so it works on this issue from where whether you can also play these games on that and Meeker",
    "start": "2267310",
    "end": "2274360"
  },
  {
    "text": "and other colleagues previously presented work on how to do this question is what can we do about this so",
    "start": "2274360",
    "end": "2281619"
  },
  {
    "text": "if you have an ECU or you have an embedded device and you want to defend against attackers who we're going to be",
    "start": "2281619",
    "end": "2287680"
  },
  {
    "text": "using its fault injection techniques what can you do so we're going to go over kind of three broad categories here the first one is",
    "start": "2287680",
    "end": "2294160"
  },
  {
    "start": "2294000",
    "end": "2294000"
  },
  {
    "text": "you could do something about the hardware so that's I think a lot of people's natural response the hardware's",
    "start": "2294160",
    "end": "2299470"
  },
  {
    "text": "betraying you but why on earth is it doing that can't we do something about this so one thing you can do is try and",
    "start": "2299470",
    "end": "2307210"
  },
  {
    "text": "preserve the integrity of your system try and stop it from portraying you here so you can try and add some kind of",
    "start": "2307210",
    "end": "2314410"
  },
  {
    "text": "party checks to memory you might also help defend against row hammer and these kind of attacks or you can use some kind",
    "start": "2314410",
    "end": "2320680"
  },
  {
    "text": "of mechanism such as running the same code or two processors to make sure your code is being executed and you're not",
    "start": "2320680",
    "end": "2325720"
  },
  {
    "text": "mutating or skipping instructions at least in the automotive industry the bad news is that these are generally",
    "start": "2325720",
    "end": "2331180"
  },
  {
    "text": "implemented for safety purposes and two of my other colleagues knew some amiibo have previously done research on how it",
    "start": "2331180",
    "end": "2338740"
  },
  {
    "text": "turns out these safety mechanisms don't actually work for security security awareness hackers are deliberately doing",
    "start": "2338740",
    "end": "2344230"
  },
  {
    "text": "fault rejection or a very different thing and just it's a kind of a remind",
    "start": "2344230",
    "end": "2349450"
  },
  {
    "text": "you don't forget about the debug interfaces they can be a real problem they leave a real gap in your defense",
    "start": "2349450",
    "end": "2356260"
  },
  {
    "text": "model it doesn't matter how much you secure your software if an attacker can just use the debug interface and break",
    "start": "2356260",
    "end": "2362830"
  },
  {
    "text": "all your security what else can you do well we mentioned software on this device so what can you do about this",
    "start": "2362830",
    "end": "2369700"
  },
  {
    "start": "2366000",
    "end": "2366000"
  },
  {
    "text": "there's an awful lot of things you can do here there were papers about this you can just go and google this but just to",
    "start": "2369700",
    "end": "2374920"
  },
  {
    "text": "give you kind of two broad ideas you know that things are kind of going to go wrong so how about you add redundancy so",
    "start": "2374920",
    "end": "2381640"
  },
  {
    "text": "for example if you're going to check where the user is authenticated before UDS read by read memory by address",
    "start": "2381640",
    "end": "2387850"
  },
  {
    "text": "succeeds how about you do that check twice so make sure that you can be successful in the automotive industry",
    "start": "2387850",
    "end": "2393700"
  },
  {
    "text": "this is something called software lock step we're in a more software based manner for example you might want to run",
    "start": "2393700",
    "end": "2399040"
  },
  {
    "text": "a ball twice or slightly different versions of one of those twice and compare the out but these are they might help but",
    "start": "2399040",
    "end": "2407230"
  },
  {
    "text": "they're definitely not silver bullets the other thing you can do remember it's just well you just assume there's going",
    "start": "2407230",
    "end": "2412960"
  },
  {
    "text": "to be an attacker they're going to default ejection you can make their life harder so you can add random delays you",
    "start": "2412960",
    "end": "2419680"
  },
  {
    "text": "saw that jitter from earlier which reduces our success rate if you deliver with the add random delays everywhere so",
    "start": "2419680",
    "end": "2425589"
  },
  {
    "text": "that we can't synchronize to any trigger at all then that means that these kind of fortunate campaigns do take more time",
    "start": "2425589",
    "end": "2431950"
  },
  {
    "text": "then you can also do some kind of control flow integrity for example you can have a counter and make sure that",
    "start": "2431950",
    "end": "2438220"
  },
  {
    "text": "the counter has been incremented the correct number of times by each bit of the code but you can read more about this company thing online so we looked a",
    "start": "2438220",
    "end": "2444490"
  },
  {
    "text": "hardware we'd have to software what else can you do well you can actually improve your design in the first place",
    "start": "2444490",
    "end": "2449589"
  },
  {
    "start": "2448000",
    "end": "2448000"
  },
  {
    "text": "so both of them here for this security access check we just pulled out the firmware a lot of these easy is and you",
    "start": "2449589",
    "end": "2456279"
  },
  {
    "text": "just look at the firmware and the code is right there to calculate these UDS responses one thing you can do is",
    "start": "2456279",
    "end": "2464019"
  },
  {
    "text": "instead of putting the keys the secrets that you need to calculate these responses in software instead you put",
    "start": "2464019",
    "end": "2470710"
  },
  {
    "text": "them in in your processor itself into some kind of fuses and then you use some kind of hardened cryptographic engine",
    "start": "2470710",
    "end": "2476559"
  },
  {
    "text": "available in many many more than automotive ECU's and and you said we",
    "start": "2476559",
    "end": "2483190"
  },
  {
    "text": "don't expose the keys the software so if an attacker obtains the firmware that still doesn't let them calculate the",
    "start": "2483190",
    "end": "2488799"
  },
  {
    "text": "responses themselves of course a much better idea is simply use asymmetric cryptography if you only have a public",
    "start": "2488799",
    "end": "2495609"
  },
  {
    "text": "key on your ECU then it's not going to matter how many nifty attacks an",
    "start": "2495609",
    "end": "2501339"
  },
  {
    "text": "attacker can pull on this they're still not going to manage to get the private key for your data center and I managed",
    "start": "2501339",
    "end": "2507849"
  },
  {
    "text": "to calculate these things itself but of course what's most important is combine",
    "start": "2507849",
    "end": "2514269"
  },
  {
    "text": "all of those techniques you should use artist hardened microprocessor don't",
    "start": "2514269",
    "end": "2519670"
  },
  {
    "text": "just use something that you're hoping is going to be kind of ok get something",
    "start": "2519670",
    "end": "2524980"
  },
  {
    "text": "that actually been tested or tested yourself harden your software or it is hard and the important parts of your software",
    "start": "2524980",
    "end": "2531160"
  },
  {
    "text": "trying to harden everything is just not really viable at least at the moment",
    "start": "2531160",
    "end": "2536590"
  },
  {
    "text": "and please bear this in mind when you're making your design so the key takeaways",
    "start": "2536590",
    "end": "2543100"
  },
  {
    "start": "2541000",
    "end": "2541000"
  },
  {
    "text": "I hope you're taking away from this report is of course your hardware is going to betray you and that it doesn't",
    "start": "2543100",
    "end": "2548680"
  },
  {
    "text": "matter if you fix all the vulnerabilities in your software which you won't that still doesn't mean that your device is going to be secure I hope",
    "start": "2548680",
    "end": "2556000"
  },
  {
    "text": "you take away that it's not that part is she fort I promise you it's not as hard",
    "start": "2556000",
    "end": "2561010"
  },
  {
    "text": "as before to avoid these kind of fun every laters you do have to get some experience in this but if nothing else",
    "start": "2561010",
    "end": "2567430"
  },
  {
    "text": "go and write one for fun and of course your firmware is going to be extracted I'm emphasizing don't point your secrets",
    "start": "2567430",
    "end": "2574420"
  },
  {
    "text": "in your firmware but of course the reason for this is that an attackers will obtain your firmware wherever as we",
    "start": "2574420",
    "end": "2582490"
  },
  {
    "text": "said in the start maybe for some upgrade process maybe by leaks of some kind or",
    "start": "2582490",
    "end": "2589120"
  },
  {
    "text": "any of the other mechanisms we talked about so I'd like to thank the colleagues who worked on this this is on",
    "start": "2589120",
    "end": "2596140"
  },
  {
    "text": "the left side Emily who were served one of my colleagues a brilliant reverse engineer who really did this trick start",
    "start": "2596140",
    "end": "2602530"
  },
  {
    "text": "doing static analysis tonic install the firmware just trying to work out what when it doesn't work I mean I love",
    "start": "2602530",
    "end": "2608650"
  },
  {
    "text": "static analysis but it's a terrible idea for trying to analyze this kind of",
    "start": "2608650",
    "end": "2614440"
  },
  {
    "text": "firmware santi who you saw earlier who was responsible for doing some of the fi",
    "start": "2614440",
    "end": "2620620"
  },
  {
    "text": "setups on this dashboard certainly mmm oh and the O's who did some awful work you can find their papers linked from",
    "start": "2620620",
    "end": "2626890"
  },
  {
    "text": "the slides or on the whisky website so this work was done at whisker as Nick",
    "start": "2626890",
    "end": "2633310"
  },
  {
    "start": "2630000",
    "end": "2630000"
  },
  {
    "text": "said Nick is a he's shy but he's a head of the automotive her team at whisker so",
    "start": "2633310",
    "end": "2638980"
  },
  {
    "text": "he knows all about this don't listen to him oh we realized there were so many code UDS this is all wise and I thought",
    "start": "2638980",
    "end": "2645190"
  },
  {
    "text": "the first of August I'm a PhD student of ducek so I leave her whisk your behind so thanks very much and I hope you have",
    "start": "2645190",
    "end": "2652210"
  },
  {
    "text": "questions [Applause] nice",
    "start": "2652210",
    "end": "2659110"
  },
  {
    "text": "[Applause]",
    "start": "2659860",
    "end": "2664559"
  },
  {
    "text": "it's for me hard to see if anybody has questions but I don't think I see anybody hi Ron I just had one question",
    "start": "2681470",
    "end": "2689200"
  },
  {
    "text": "some of the processors that I've been involved with have Glick glitch",
    "start": "2689200",
    "end": "2694900"
  },
  {
    "text": "detection at least it's supposed to be a glitch to ginger how effective or goes",
    "start": "2694900",
    "end": "2700790"
  },
  {
    "text": "at the fitti or Lachie power glitching yeah that's the question is that there's",
    "start": "2700790",
    "end": "2708890"
  },
  {
    "text": "chips out there that have specific countermeasures in there to prevent glitch attacks these things are always a",
    "start": "2708890",
    "end": "2716330"
  },
  {
    "text": "bit difficult to answer however if you look for example at smart cards where",
    "start": "2716330",
    "end": "2721880"
  },
  {
    "text": "glitchet X actually originated from these people laughing those were the first targets where people started doing",
    "start": "2721880",
    "end": "2727850"
  },
  {
    "text": "fault injection and those were also the first targets where countermeasures were",
    "start": "2727850",
    "end": "2733370"
  },
  {
    "text": "is being implemented and in order to perform a fault injection attack on search target it's not as easy as here",
    "start": "2733370",
    "end": "2739850"
  },
  {
    "text": "and it's my opinion but I'm quite",
    "start": "2739850",
    "end": "2745040"
  },
  {
    "text": "content to state that if you want to perform a fault injection attack on such targets it will become a specialized lab",
    "start": "2745040",
    "end": "2752030"
  },
  {
    "text": "attack if you'll not be using the tooling that we have in front of here you vote this fault injection",
    "start": "2752030",
    "end": "2758240"
  },
  {
    "text": "you really have to resort to a more sophisticated form injection like shooting lasers at the chip for example",
    "start": "2758240",
    "end": "2763940"
  },
  {
    "text": "and opening the package but obviously as always it really depends on the effectiveness of the countermeasure and",
    "start": "2763940",
    "end": "2769340"
  },
  {
    "text": "whatever I'm saying is not guaranteed to be true for all targets but maybe it's also important to say that these are",
    "start": "2769340",
    "end": "2775670"
  },
  {
    "text": "easy use they're in your car they're often safety critical and voltage fluctuations are a fact of life and",
    "start": "2775670",
    "end": "2781640"
  },
  {
    "text": "these kind of vehicles you can't just start shutting down things if you detect voltage glitching which is one of the",
    "start": "2781640",
    "end": "2789140"
  },
  {
    "text": "ways you can implement these ditch detectors so you need to actually survive these kind of glitches because",
    "start": "2789140",
    "end": "2795320"
  },
  {
    "text": "they do happen if you like and you can't just stop your car so safety is a real problem for ECU's in particular here",
    "start": "2795320",
    "end": "2801220"
  },
  {
    "text": "thank you I really enjoyed your talk I",
    "start": "2801220",
    "end": "2809660"
  },
  {
    "text": "know you're trying to stay away from any specifics or anything like that",
    "start": "2809660",
    "end": "2815109"
  },
  {
    "text": "have you ever emulated a microprocessor that as a memory management unit sort of",
    "start": "2815109",
    "end": "2825509"
  },
  {
    "text": "that's it it's a good question because that's not adding the complexity I can say that the week I coded for this",
    "start": "2825959",
    "end": "2832299"
  },
  {
    "text": "emulator does not import implementing the memory management in this thing I think honestly for me at least I have",
    "start": "2832299",
    "end": "2839890"
  },
  {
    "text": "implemented thing process with mmm used before emulators for them and it's",
    "start": "2839890",
    "end": "2845079"
  },
  {
    "text": "frustrating for me not so much because of the complexity of writing the thing but it makes it slower I mean at some",
    "start": "2845079",
    "end": "2850539"
  },
  {
    "text": "point the speed of these things really gets annoying but the good news is the more complicated your protesters get the",
    "start": "2850539",
    "end": "2856809"
  },
  {
    "text": "more likely it is it might be running something like the nips QNX vxworks and that's a lot easier to work with without",
    "start": "2856809",
    "end": "2862150"
  },
  {
    "text": "having to resort to this but so if you did if you did have to do an MMU you",
    "start": "2862150",
    "end": "2868599"
  },
  {
    "text": "probably are not going if you do have to emulate it MMU you're probably not going",
    "start": "2868599",
    "end": "2875559"
  },
  {
    "text": "to approach it this way I don't know I think I would stead approach it this way but it it makes it more painful the more",
    "start": "2875559",
    "end": "2882609"
  },
  {
    "text": "complicated your processors get and I think that's maybe the way a lot of the automotive market is going but again for",
    "start": "2882609",
    "end": "2888880"
  },
  {
    "text": "ECU in particular you want relatively simple processors if you didn't get away with it thank you",
    "start": "2888880",
    "end": "2895180"
  },
  {
    "text": "but thanks do you release the code for",
    "start": "2895180",
    "end": "2900430"
  },
  {
    "text": "your emulator or you you're planning to it's a good question and I think",
    "start": "2900430",
    "end": "2905769"
  },
  {
    "text": "definitely not because we want to keep the processor anonymous and I think doing that for the emulator is not a good idea I'm hoping to at least extract",
    "start": "2905769",
    "end": "2913209"
  },
  {
    "text": "useful things from this and and actually get something open-source at least the",
    "start": "2913209",
    "end": "2920529"
  },
  {
    "text": "visualization side but yeah I wish I could so good in that case could you elaborate a little bit more on how you",
    "start": "2920529",
    "end": "2927249"
  },
  {
    "text": "approached in writing the emulator so you took presumably you started off with some existing emulators and use that as",
    "start": "2927249",
    "end": "2935019"
  },
  {
    "text": "a pattern or so no this is entirely from scratch that's why I'm saying writing a gameboy emulator the question is did I",
    "start": "2935019",
    "end": "2940779"
  },
  {
    "text": "base it on something else this is - a scratch but if you want to talk more about this I'd love to talk more in the",
    "start": "2940779",
    "end": "2946359"
  },
  {
    "text": "wrap-up room and we can also show you the Injection set up yeah the interests of",
    "start": "2946359",
    "end": "2952810"
  },
  {
    "text": "respecting everyone's time we're going to move questions across the hall to the rep room thank you",
    "start": "2952810",
    "end": "2959460"
  }
]