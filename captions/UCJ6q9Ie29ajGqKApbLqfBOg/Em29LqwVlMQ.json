[
  {
    "text": "[Music]",
    "start": "20",
    "end": "3090"
  },
  {
    "text": "welcome to black hat briefings held November 21st through the 22nd 2001 in Amsterdam this is videotape number 13B a",
    "start": "19320",
    "end": "27359"
  },
  {
    "text": "continuation",
    "start": "27359",
    "end": "30359"
  },
  {
    "text": "welcome back okay good",
    "start": "36360",
    "end": "42399"
  },
  {
    "text": "now what I want to do now is we're just going to talk a little bit about some real life scenarios here",
    "start": "42399",
    "end": "50160"
  },
  {
    "text": "um where people have chosen to develop their websites in such a",
    "start": "50160",
    "end": "56440"
  },
  {
    "text": "way that um might not that that Expos them to potential",
    "start": "56440",
    "end": "64000"
  },
  {
    "text": "vulnerabilities um I'm not going to hack into a bank I'm not going to do anything like that because uh you know I got a wife",
    "start": "64000",
    "end": "71119"
  },
  {
    "text": "and kids so but what I am going to do this is going to be probably the most expensive demo in all time because I'm",
    "start": "71119",
    "end": "77400"
  },
  {
    "text": "dialing an international call to connect up inside of the kapulsky at about $10 a",
    "start": "77400",
    "end": "86719"
  },
  {
    "text": "minute but I'm using a stolen credit card number to pay for this so it's",
    "start": "88560",
    "end": "94399"
  },
  {
    "text": "uh kidding kidding Mr",
    "start": "94399",
    "end": "101360"
  },
  {
    "text": "cameraman okay so what I'm going to do is connect up",
    "start": "110840",
    "end": "116680"
  },
  {
    "text": "without you people seeing is it going to",
    "start": "120399",
    "end": "127399"
  },
  {
    "text": "connect huh oh yeah well let me connect up first",
    "start": "129200",
    "end": "136720"
  },
  {
    "text": "like I'm going to let you guys see my dialup number",
    "start": "136720",
    "end": "141599"
  },
  {
    "text": "right I'm sure you hey go for it I don't need to make it easy for you we got Tim",
    "start": "144959",
    "end": "152080"
  },
  {
    "text": "back there scribbling down my number so I'll show him watch this I'll get home and it'll be a nice email waiting for",
    "start": "152080",
    "end": "158800"
  },
  {
    "text": "me assuming they actually gave me a connection",
    "start": "172640",
    "end": "177840"
  },
  {
    "text": "that doesn't sound like a good",
    "start": "180360",
    "end": "183440"
  },
  {
    "text": "sound be right",
    "start": "200440",
    "end": "204040"
  },
  {
    "text": "back no he's not going to give me is it that's the a problem no nobody trusts",
    "start": "205840",
    "end": "211239"
  },
  {
    "text": "anybody here I mean sitting like a guy I've known for years sitting there with him he's got his laptop and he's like",
    "start": "211239",
    "end": "218120"
  },
  {
    "text": "gets up to go to the bathroom and locks his keyboard you know and walks I'm like dude come on like I'm gonna be stopped",
    "start": "218120",
    "end": "226560"
  },
  {
    "text": "by you locking the keyboard so um they're going to fix",
    "start": "226560",
    "end": "234239"
  },
  {
    "text": "that um I actually had everything set up but it kind of fell through apparently",
    "start": "234239",
    "end": "240519"
  },
  {
    "text": "that um I had a local dial up and all that good stuff we can all just kind of go into the business office as well and",
    "start": "240519",
    "end": "249640"
  },
  {
    "text": "uh and show you so while they're doing that I'm",
    "start": "249640",
    "end": "255360"
  },
  {
    "text": "going to shift gears and kind of talk about this uh this second guy",
    "start": "255360",
    "end": "262199"
  },
  {
    "text": "first there's really two ways to exploit",
    "start": "268440",
    "end": "276400"
  },
  {
    "text": "conditions over the web one is for us as remote clients",
    "start": "276400",
    "end": "284840"
  },
  {
    "text": "to use SQL injection and directory traversal and buffer",
    "start": "284840",
    "end": "291600"
  },
  {
    "text": "overflows to compromise the web servers the other which really I don't I",
    "start": "291600",
    "end": "298639"
  },
  {
    "text": "don't think a lot of people pay too much attention to because it's not necessarily real sexy",
    "start": "298639",
    "end": "306320"
  },
  {
    "text": "is taking a little bit more time and using server side",
    "start": "306320",
    "end": "311520"
  },
  {
    "text": "components to compromise some of your clients people who come to your",
    "start": "311520",
    "end": "317880"
  },
  {
    "text": "site right",
    "start": "317880",
    "end": "322560"
  },
  {
    "text": "so there is even in Windows 2000 which by default will be using Kerberos to",
    "start": "325120",
    "end": "331800"
  },
  {
    "text": "authenticate clients internally there's still the use of the",
    "start": "331800",
    "end": "337479"
  },
  {
    "text": "LM hash structure ntlm credentials uh inside Windows",
    "start": "337479",
    "end": "344440"
  },
  {
    "text": "2000 for one accessing a legacy server will resort to an nlm",
    "start": "344440",
    "end": "352639"
  },
  {
    "text": "credential being automatically passed um telnet server allows you to make a connect",
    "start": "352639",
    "end": "359600"
  },
  {
    "text": "connection to a remote tet server and pass your nlm credentials over Port",
    "start": "359600",
    "end": "365639"
  },
  {
    "text": "23 that would all be internal so if you have the client um the server set up to",
    "start": "365639",
    "end": "372360"
  },
  {
    "text": "do that and the client connects they could authenticate to a secure server by",
    "start": "372360",
    "end": "378400"
  },
  {
    "text": "using their currently logged on credentials who's familiar with uh the telnet exploit in regard to Windows 2000",
    "start": "378400",
    "end": "385400"
  },
  {
    "text": "for that that uh Dill dog wrote talk nlm which was a a rogue tet server that was",
    "start": "385400",
    "end": "393319"
  },
  {
    "text": "sitting out there on the network um Internet Explorer would automatically",
    "start": "393319",
    "end": "401560"
  },
  {
    "text": "parse a tnet request and pass that request onto the telnet",
    "start": "401560",
    "end": "406800"
  },
  {
    "text": "client so you could send embedded in a URL or part of the URL itself",
    "start": "406800",
    "end": "414479"
  },
  {
    "text": "tnet to the Box ID you got it set now",
    "start": "414479",
    "end": "421520"
  },
  {
    "text": "we can't dial international it goes what it is",
    "start": "422039",
    "end": "428680"
  },
  {
    "text": "great so what was I saying where am I",
    "start": "428680",
    "end": "437360"
  },
  {
    "text": "Ur all right I was in the Bahamas for a minute there it's kind of nice",
    "start": "437360",
    "end": "442680"
  },
  {
    "text": "um you could initiate a automatic connection to tet w w w",
    "start": "442680",
    "end": "450039"
  },
  {
    "text": "and with this code running on the back end the box would automatically try to authenticate you using ntlm it was kind",
    "start": "450039",
    "end": "457120"
  },
  {
    "text": "of cool so you'd get their username and password I like stuff like that um I",
    "start": "457120",
    "end": "463400"
  },
  {
    "text": "like to be able to silently get people's usernames and passwords because I think it's kind of fun not that we would ever do anything",
    "start": "463400",
    "end": "471120"
  },
  {
    "text": "with it but who all is",
    "start": "471120",
    "end": "476159"
  },
  {
    "text": "a you're not going to answer me who who all runs the SQL Server 2000 Enterprise",
    "start": "476159",
    "end": "483440"
  },
  {
    "text": "tools any of the client connectivity tools on their box or msde yeah thanks for being honest okay",
    "start": "483440",
    "end": "492360"
  },
  {
    "text": "well when you install those some interesting things happen",
    "start": "492360",
    "end": "498159"
  },
  {
    "text": "back in Windows 2000 God did I actually say back in Windows 2000 it's already",
    "start": "498159",
    "end": "506479"
  },
  {
    "text": "um I'm going to I'm going to back up just for a second you saw that we were talking about",
    "start": "506479",
    "end": "511720"
  },
  {
    "text": "integrated authentication with SQL Server back with SQL Server 7 that was",
    "start": "511720",
    "end": "518000"
  },
  {
    "text": "done via a name pipe session so if you told SQL Server to use integrated",
    "start": "518000",
    "end": "527120"
  },
  {
    "text": "authentication a name pipe session over 139 was created between you and the server and then that's how it would",
    "start": "527600",
    "end": "533920"
  },
  {
    "text": "automatically authenticate you you had to have 139 open to the SQL Server which was fine it's an internal",
    "start": "533920",
    "end": "540800"
  },
  {
    "text": "box everybody when you're blocking credentials at the firewall SMB what porch do you",
    "start": "540800",
    "end": "550480"
  },
  {
    "text": "block 139 and 445 what what else do you",
    "start": "550800",
    "end": "559240"
  },
  {
    "text": "block What's huh good",
    "start": "560240",
    "end": "565279"
  },
  {
    "text": "man so I'm not going to get him is that coming in or going",
    "start": "565279",
    "end": "571240"
  },
  {
    "text": "out do you allow outbound sessions from a connected do you allow outbound",
    "start": "571240",
    "end": "576839"
  },
  {
    "text": "established do you allow inbound established maybe so what's neat is that in SQL",
    "start": "576839",
    "end": "586040"
  },
  {
    "text": "2000 they introduced this new library called dbet lib do I go into all",
    "start": "586040",
    "end": "592279"
  },
  {
    "text": "this yeah You' think I would know because oop",
    "start": "592279",
    "end": "600160"
  },
  {
    "text": "little too much there they introduced a new library called dbn net lib and it",
    "start": "600160",
    "end": "605760"
  },
  {
    "text": "was really cool because dbet lib supports integrated authentication over IP without having to use name pipes it",
    "start": "605760",
    "end": "613600"
  },
  {
    "text": "does it over Port 1433 so if you go to the",
    "start": "613600",
    "end": "620360"
  },
  {
    "text": "client and you tell it to use dbet lib which is now the default for IP sockets in Windows 2000 on the client side and",
    "start": "620360",
    "end": "627680"
  },
  {
    "text": "the server which is SS that lib or whatever you can automatically",
    "start": "627680",
    "end": "633360"
  },
  {
    "text": "authenticate your people over 1433 so I got to thinking about well",
    "start": "633360",
    "end": "638680"
  },
  {
    "text": "that's really pretty cool because now my anlm credentials can go out",
    "start": "638680",
    "end": "644160"
  },
  {
    "text": "1433 and then I went my credentials can go out",
    "start": "644160",
    "end": "650240"
  },
  {
    "text": "1433 you know and we're not blocking that necessarily in many cases we have 1433",
    "start": "650240",
    "end": "657920"
  },
  {
    "text": "open explicitly server to server queries through the firewall where you have one query that's",
    "start": "657920",
    "end": "664560"
  },
  {
    "text": "going to be uh participating in some other query of a a sister company",
    "start": "664560",
    "end": "670200"
  },
  {
    "text": "partner whatever you have and those are okay because we always encrypt that",
    "start": "670200",
    "end": "676200"
  },
  {
    "text": "traffic but the point is that from an infrastructure standpoint 1433 outbound",
    "start": "676200",
    "end": "682320"
  },
  {
    "text": "is not by default closed on everybody's firewall so really all we had to do was",
    "start": "682320",
    "end": "688279"
  },
  {
    "text": "figure out how to get the client to make a dbet lib reference how do you get the",
    "start": "688279",
    "end": "693560"
  },
  {
    "text": "client to do that well it really wasn't a huge deal because in Windows 2000 the only",
    "start": "693560",
    "end": "699279"
  },
  {
    "text": "way you got dbet lib was to go to a client and install msde on",
    "start": "699279",
    "end": "704680"
  },
  {
    "text": "it or um install the Enterprise tools like",
    "start": "704680",
    "end": "711240"
  },
  {
    "text": "this guy's running Windows 2000 Pro so all I can do is load SQL",
    "start": "711240",
    "end": "718120"
  },
  {
    "text": "server on him well what's interesting is that we're good oh pardon",
    "start": "718120",
    "end": "729959"
  },
  {
    "text": "me oh ah the super secret phone I'm",
    "start": "729959",
    "end": "736639"
  },
  {
    "text": "sorry uh one second maybe we won't need Ping's dialup",
    "start": "746000",
    "end": "753920"
  },
  {
    "text": "stuff maybe I will what's causing ntlm is the ntlm SSP",
    "start": "756000",
    "end": "763720"
  },
  {
    "text": "provider for Windows NT okay it's still there if we have a SQL 2000",
    "start": "763720",
    "end": "773199"
  },
  {
    "text": "server if you have a SQL 2000 server Well here here's what happens",
    "start": "773199",
    "end": "780320"
  },
  {
    "text": "what we want to do is if you had",
    "start": "780320",
    "end": "786480"
  },
  {
    "text": "loaded on a client SQL Server 2000 already has this it supports incoming",
    "start": "786480",
    "end": "792959"
  },
  {
    "text": "1433 sessions obviously SQL Server so it's going to take 1433 in but on that",
    "start": "792959",
    "end": "798320"
  },
  {
    "text": "same IP Channel it will now authenticate the user so before any client that you wanted to use ntlm had to use the name",
    "start": "798320",
    "end": "805199"
  },
  {
    "text": "pipes client Library client Library",
    "start": "805199",
    "end": "811120"
  },
  {
    "text": "um the and and so now we don't have to do that it's a one-size fits-all library",
    "start": "814040",
    "end": "820320"
  },
  {
    "text": "dbet lib does encryption over I mean it does a it supports encryption",
    "start": "820320",
    "end": "825880"
  },
  {
    "text": "multi-protocol multiprotocol encryption um automatic authentication integrated",
    "start": "825880",
    "end": "831279"
  },
  {
    "text": "authentication rather all that good stuff that's what dbet lib does so when you installed the client",
    "start": "831279",
    "end": "839680"
  },
  {
    "text": "side tools on a workstation not only did it install dbet",
    "start": "839680",
    "end": "845600"
  },
  {
    "text": "lib but it install some ActiveX controls that we use to",
    "start": "845600",
    "end": "851560"
  },
  {
    "text": "enumerate um some of the SQL Server objects but",
    "start": "851560",
    "end": "856639"
  },
  {
    "text": "even outside of that before we even go there if I know that dbet lib is on",
    "start": "856639",
    "end": "863360"
  },
  {
    "text": "somebody's box which really wouldn't be that hard",
    "start": "863360",
    "end": "869519"
  },
  {
    "text": "to do if I go to Microsoft SQL Server developer news",
    "start": "869519",
    "end": "875240"
  },
  {
    "text": "groups one can pretty much bet that all of those developers have the client side tools on",
    "start": "875240",
    "end": "882160"
  },
  {
    "text": "their box and you have their email address so you email these guys and and",
    "start": "882160",
    "end": "889399"
  },
  {
    "text": "your your SQL Server developers are typically who to the system and they",
    "start": "889399",
    "end": "896360"
  },
  {
    "text": "administrators typically so what we can do this is a",
    "start": "896360",
    "end": "902880"
  },
  {
    "text": "lame this is a lame way of getting them to connect if I do client side",
    "start": "902880",
    "end": "909040"
  },
  {
    "text": "HTML and I instantiate a new ActiveX object on client side",
    "start": "909040",
    "end": "914279"
  },
  {
    "text": "HTML and they have scripting running and they've prompted for domain for data",
    "start": "914279",
    "end": "921480"
  },
  {
    "text": "sources across a domain there's a lot of ifs there what I can simply do is remember",
    "start": "921480",
    "end": "927959"
  },
  {
    "text": "our connection string same thing this is happening on the",
    "start": "927959",
    "end": "933319"
  },
  {
    "text": "client so I have a web page on my server we're good great thank you sir I",
    "start": "933319",
    "end": "939279"
  },
  {
    "text": "appreciate it thanks for all your trouble",
    "start": "939279",
    "end": "945920"
  },
  {
    "text": "um I would have this object tag in an HTML document on my website well not my",
    "start": "948959",
    "end": "955720"
  },
  {
    "text": "website the evil guy would have this on his website so he would have you go to the website you're looking at something",
    "start": "955720",
    "end": "962759"
  },
  {
    "text": "or send you an HTML mail now this object would get instantiated and here's what we're doing connection string blah blah",
    "start": "962759",
    "end": "969480"
  },
  {
    "text": "blah SQL Server persistent security false initial catalog is pubs which we",
    "start": "969480",
    "end": "974720"
  },
  {
    "text": "you know I'll have on my server here's the IP address of the server network library equals dbet lib",
    "start": "974720",
    "end": "983240"
  },
  {
    "text": "well what's neat is in the adodb connection string I get to specify what library the client uses",
    "start": "983240",
    "end": "990399"
  },
  {
    "text": "so if you have this on your server on your client what happens is it will pop up",
    "start": "990399",
    "end": "999079"
  },
  {
    "text": "and say do you want to access you're about",
    "start": "999079",
    "end": "1006040"
  },
  {
    "text": "to access a data source in another domain do you want to do",
    "start": "1006040",
    "end": "1012000"
  },
  {
    "text": "that a lot of people say yes to that I can tell you um",
    "start": "1012000",
    "end": "1020079"
  },
  {
    "text": "because that's what they want to do particularly if on the site I say click here to get this data or",
    "start": "1020079",
    "end": "1026600"
  },
  {
    "text": "something for and if you if you engineer it right you say um access my data",
    "start": "1026600",
    "end": "1032640"
  },
  {
    "text": "source with this so and so so you've already use the term data source and so they go okay I want to access the data",
    "start": "1032640",
    "end": "1038640"
  },
  {
    "text": "source and they click the button and then they get a security warning that all it says is you're about to access a do a record Source from a different",
    "start": "1038640",
    "end": "1045199"
  },
  {
    "text": "domain and they go okay yeah so they click it this object gets",
    "start": "1045199",
    "end": "1051280"
  },
  {
    "text": "instantiated and right there over Port 1433 outgo their username and their nlm",
    "start": "1051880",
    "end": "1060080"
  },
  {
    "text": "hatch and I get to collect it he he got me set so I don't need",
    "start": "1060080",
    "end": "1065640"
  },
  {
    "text": "yours but I might just keep it anyway I might just hand it out to",
    "start": "1065640",
    "end": "1072600"
  },
  {
    "text": "everybody hey thank",
    "start": "1072600",
    "end": "1076039"
  },
  {
    "text": "you so in the initial",
    "start": "1077840",
    "end": "1084520"
  },
  {
    "text": "um in the initial demos of doing this I",
    "start": "1084520",
    "end": "1089559"
  },
  {
    "text": "just wanted to do a capture on the network just to show you what was happening you would",
    "start": "1089559",
    "end": "1095280"
  },
  {
    "text": "see 1433 get um pass pass those",
    "start": "1095280",
    "end": "1102360"
  },
  {
    "text": "credentials so what I wanted to do here is kind of Beef It Up a little",
    "start": "1104480",
    "end": "1110720"
  },
  {
    "text": "bit getting making having to do all of that is lame right going through all the",
    "start": "1110720",
    "end": "1118919"
  },
  {
    "text": "they have to have active X they have to have said to prompt",
    "start": "1118919",
    "end": "1124080"
  },
  {
    "text": "for uh accessing a domain Source across the network and by default it's",
    "start": "1124080",
    "end": "1131840"
  },
  {
    "text": "off but what's cool is there's this active X object called SQL namespace",
    "start": "1131840",
    "end": "1140080"
  },
  {
    "text": "which whenever you install on the client when you inst all when you install the",
    "start": "1141240",
    "end": "1147240"
  },
  {
    "text": "client tools this ActiveX object is marked safe for",
    "start": "1147240",
    "end": "1154000"
  },
  {
    "text": "scripting yes SM so not only is it marked safe for",
    "start": "1154200",
    "end": "1160280"
  },
  {
    "text": "scripting it also as does the adodb connection object it also allows me to",
    "start": "1160280",
    "end": "1169240"
  },
  {
    "text": "specify the network library so all we do is",
    "start": "1169240",
    "end": "1178039"
  },
  {
    "text": "say NS equals new ActiveX data or ActiveX object SQL namespace initialize",
    "start": "1178039",
    "end": "1185760"
  },
  {
    "text": "I just call it Grabber um set the IP address trusted",
    "start": "1185760",
    "end": "1192080"
  },
  {
    "text": "connection yes network library dbet li. dll and guess what absolutely silent you",
    "start": "1192080",
    "end": "1199320"
  },
  {
    "text": "go to the web page you're reading everything you don't even know that this object got instantiated the next thing you know I've already got your n I've",
    "start": "1199320",
    "end": "1206520"
  },
  {
    "text": "got in clear text your n username and password and the nlm",
    "start": "1206520",
    "end": "1212679"
  },
  {
    "text": "hash now there's not a whole lot I can necessarily do with that I can sit there",
    "start": "1212679",
    "end": "1218960"
  },
  {
    "text": "and crack on it depending on how",
    "start": "1218960",
    "end": "1224640"
  },
  {
    "text": "uh how strong the password is you know it it might take me three months to do",
    "start": "1224640",
    "end": "1231240"
  },
  {
    "text": "it but so what I mean we've got racks and racks of servers well now okay I don't have racks and racks I mean but",
    "start": "1231240",
    "end": "1238000"
  },
  {
    "text": "I've got a bunch of servers so those guys can just be sitting there and once",
    "start": "1238000",
    "end": "1243640"
  },
  {
    "text": "I get it I've got it the other thing we can do is like SMB relay type things and pass the",
    "start": "1243640",
    "end": "1251640"
  },
  {
    "text": "hash so what to to kind of illustrate this",
    "start": "1251640",
    "end": "1257799"
  },
  {
    "text": "um I went to Linux to write a little",
    "start": "1265400",
    "end": "1271799"
  },
  {
    "text": "app oh I'm sorry yeah tada",
    "start": "1274080",
    "end": "1281760"
  },
  {
    "text": "[Music] Tada don't make me restart it",
    "start": "1289700",
    "end": "1298120"
  },
  {
    "text": "again well it's on it's just not getting the",
    "start": "1302159",
    "end": "1306640"
  },
  {
    "text": "signal our you should be blocking 1433 outbound",
    "start": "1312039",
    "end": "1320240"
  },
  {
    "text": "connections you should be",
    "start": "1320240",
    "end": "1325400"
  },
  {
    "text": "um applying Service Pack two to your workstations because I brought this up",
    "start": "1325720",
    "end": "1332000"
  },
  {
    "text": "to Microsoft I do that first typically I do that first I find an issue I go and I",
    "start": "1332000",
    "end": "1337200"
  },
  {
    "text": "tell them about it and I let them do kind of what they want to do with it so in service pack two of SQL Server they",
    "start": "1337200",
    "end": "1343400"
  },
  {
    "text": "made these objects not safe for scripting by default my issue with that is that",
    "start": "1343400",
    "end": "1349919"
  },
  {
    "text": "people don't go around to the client boxes and install the service pack for SQL Server you go to the SQL server and",
    "start": "1349919",
    "end": "1357000"
  },
  {
    "text": "install the service pack so that is something that you need to",
    "start": "1357000",
    "end": "1364600"
  },
  {
    "text": "do um so what I wanted to show you is that this is uh",
    "start": "1364600",
    "end": "1370600"
  },
  {
    "text": "not I'm going to have to reboot",
    "start": "1370679",
    "end": "1375240"
  },
  {
    "text": "wait the only time I've ever had any weird issues with the Vio is whenever I use",
    "start": "1387400",
    "end": "1395400"
  },
  {
    "text": "the port replicator on one of",
    "start": "1395400",
    "end": "1400520"
  },
  {
    "text": "these one of these units because once I turn it",
    "start": "1400520",
    "end": "1407200"
  },
  {
    "text": "off who",
    "start": "1407200",
    "end": "1410440"
  },
  {
    "text": "so just give me a second to reboot that so and this really isn't a huge",
    "start": "1415520",
    "end": "1421120"
  },
  {
    "text": "deal I mean the vulnerability landscape on this guy is somewhat",
    "start": "1421120",
    "end": "1426480"
  },
  {
    "text": "limited but there's a bigger message here and",
    "start": "1426480",
    "end": "1434080"
  },
  {
    "text": "that's that's that sometimes we never really know what",
    "start": "1434080",
    "end": "1439880"
  },
  {
    "text": "processes are sending out our credentials I mean it wasn't explicit it",
    "start": "1439880",
    "end": "1445520"
  },
  {
    "text": "you know they didn't come out and say okay well now with dbet lib 1433 will use for unlm credentials and to me I'd",
    "start": "1445520",
    "end": "1452960"
  },
  {
    "text": "like to know that so the real lesson is even in Windows 2000 I mean in Windows NT we're",
    "start": "1452960",
    "end": "1460039"
  },
  {
    "text": "all kind of hip to nlm and the LM hash and how weak it is right I mean we use",
    "start": "1460039",
    "end": "1465720"
  },
  {
    "text": "lowfat crack and we sniff the connections and all that but in 2000 we kind of think okay we're all curb Ross",
    "start": "1465720",
    "end": "1471760"
  },
  {
    "text": "everything's cool but um that doesn't mean that you don't have",
    "start": "1471760",
    "end": "1479120"
  },
  {
    "text": "to harden your Windows NT server and client installations is it working yay",
    "start": "1479120",
    "end": "1485120"
  },
  {
    "text": "and there was much rejoicing well now that was a money python reference hey I got it",
    "start": "1485120",
    "end": "1493880"
  },
  {
    "text": "yeah rough crowd so inside of Windows NT the group policy",
    "start": "1495360",
    "end": "1502960"
  },
  {
    "text": "there's a setting that allows you to set nlm version two which is strong encryption",
    "start": "1502960",
    "end": "1509279"
  },
  {
    "text": "128bit ntlm and you can sign server and client",
    "start": "1509279",
    "end": "1515080"
  },
  {
    "text": "Communications that's the kind of stuff that you need to",
    "start": "1515080",
    "end": "1519519"
  },
  {
    "text": "do have to set something on the clients to or that is setting it on CLI Group",
    "start": "1520360",
    "end": "1525399"
  },
  {
    "text": "Policy will set it on the clients you have a minimum client level of connectivity with nlm",
    "start": "1525399",
    "end": "1531000"
  },
  {
    "text": "credentials yep we active directory if you it it",
    "start": "1531000",
    "end": "1537520"
  },
  {
    "text": "depends you can actually there is support for ntlm version 2 for Windows 95 clients um and it's on the Windows",
    "start": "1537520",
    "end": "1544600"
  },
  {
    "text": "2000 client CD so you have to go through and do that if you're in a 2000 if you're in a if you have pre-2000 boxes",
    "start": "1544600",
    "end": "1551559"
  },
  {
    "text": "out there which I guess a lot of people still do",
    "start": "1551559",
    "end": "1556639"
  },
  {
    "text": "um everyone close your eyes not a single one of",
    "start": "1556919",
    "end": "1565520"
  },
  {
    "text": "you um if you still have those Legacy clients then you're going to have a",
    "start": "1565520",
    "end": "1571520"
  },
  {
    "text": "little bit more work to do and that's why border infrastructure is so important you know really anytime a",
    "start": "1571520",
    "end": "1577960"
  },
  {
    "text": "packet leaves the trusted Network it needs to be",
    "start": "1577960",
    "end": "1583399"
  },
  {
    "text": "constraint so only let like the gentleman in the back you know know only",
    "start": "1583399",
    "end": "1589600"
  },
  {
    "text": "allow out what has to be allowed out um unfortunately we still tend to",
    "start": "1589600",
    "end": "1594919"
  },
  {
    "text": "see people with the you know the optin or however you want to call it the the",
    "start": "1594919",
    "end": "1600039"
  },
  {
    "text": "mentality of I'm going to set up a firewall and I'm going to close down the bad",
    "start": "1600039",
    "end": "1605200"
  },
  {
    "text": "stuff when what you really need to do is set up a firewall close down absolutely everything and open up what you have to",
    "start": "1605200",
    "end": "1612880"
  },
  {
    "text": "have and if you do that then a lot of these types of attacks are mitigated",
    "start": "1612880",
    "end": "1619679"
  },
  {
    "text": "but when you do this I mean when you can get a silent SMB connection like that it's pretty it's pretty cool so let's",
    "start": "1619679",
    "end": "1625640"
  },
  {
    "text": "just show you real",
    "start": "1625640",
    "end": "1630840"
  },
  {
    "text": "quick yes but here's the trick now I was kind of pissed at this",
    "start": "1637960",
    "end": "1644679"
  },
  {
    "text": "too Windows XP in the default installation now ships with dbn net lib",
    "start": "1644679",
    "end": "1652320"
  },
  {
    "text": "on it even the home edition of Windows XP has this dll on",
    "start": "1652320",
    "end": "1660360"
  },
  {
    "text": "it granted I don't have a safe for scripting active X control that allows me to instantiate that object and set up",
    "start": "1660360",
    "end": "1667640"
  },
  {
    "text": "a back Channel connection to where I can grab the credentials but what else can we",
    "start": "1667640",
    "end": "1673200"
  },
  {
    "text": "do when uh",
    "start": "1673279",
    "end": "1678960"
  },
  {
    "text": "when the windows distribution starts to include support",
    "start": "1678960",
    "end": "1685279"
  },
  {
    "text": "for dbet lib on it already registered on the machine you know that tells me that",
    "start": "1685279",
    "end": "1694000"
  },
  {
    "text": "their data enabled model is getting very",
    "start": "1694000",
    "end": "1699320"
  },
  {
    "text": "big I mean and it it was fine for us before you had to load the client slide",
    "start": "1699320",
    "end": "1704880"
  },
  {
    "text": "tools we're assuming we know what it does yes we want to use use IP to do NT based authentication that kind of tells",
    "start": "1704880",
    "end": "1711200"
  },
  {
    "text": "us what we're doing here but but now you don't know anymore you don't know where that's going to be",
    "start": "1711200",
    "end": "1717200"
  },
  {
    "text": "used and what else it's possible of doing okay so let's just take a quick",
    "start": "1717200",
    "end": "1722320"
  },
  {
    "text": "look at it and then we'll do the demo are we out at 5:15",
    "start": "1722320",
    "end": "1727360"
  },
  {
    "text": "5:30 how much time do we have God this so unprofessional how long",
    "start": "1727360",
    "end": "1732399"
  },
  {
    "text": "do I talk it is not 4:45",
    "start": "1732399",
    "end": "1739320"
  },
  {
    "text": "is when I'm",
    "start": "1740200",
    "end": "1742720"
  },
  {
    "text": "through well okay well wait a",
    "start": "1746559",
    "end": "1751200"
  },
  {
    "text": "okay and then I'm out of here well okay wait wait wait",
    "start": "1755399",
    "end": "1760600"
  },
  {
    "text": "okay see now I'm like Deering the headlights what am I doing oh my God oh my God",
    "start": "1763519",
    "end": "1769720"
  },
  {
    "text": "okay so I'm going to open up",
    "start": "1769720",
    "end": "1772960"
  },
  {
    "text": "VMware no sorry that's mandre 80 this is Red",
    "start": "1775720",
    "end": "1782000"
  },
  {
    "text": "Hat 71 as if I I say that like I know what I'm",
    "start": "1782000",
    "end": "1787840"
  },
  {
    "text": "talking about with Linux yeah why mandroid Linux over",
    "start": "1787840",
    "end": "1793080"
  },
  {
    "text": "there one of the reasons I chose to write this under Linux is because um and let me clarify that I didn't write this",
    "start": "1793080",
    "end": "1801159"
  },
  {
    "text": "tool I took dild dog's ntlm talk nlm code and changed it granted it was a",
    "start": "1801159",
    "end": "1809399"
  },
  {
    "text": "substantial change the the packet structure for a tnet authentication is",
    "start": "1809399",
    "end": "1816120"
  },
  {
    "text": "supremely easy I mean it's and so far as the not his code wasn't supremely easy he did an excellent job",
    "start": "1816120",
    "end": "1824000"
  },
  {
    "text": "um the client communication was simple on this guy it becomes very very",
    "start": "1824000",
    "end": "1830000"
  },
  {
    "text": "difficult difficult for me",
    "start": "1830000",
    "end": "1834720"
  },
  {
    "text": "um so what we're going to do is I've got that guy compiled this is called",
    "start": "1836360",
    "end": "1843320"
  },
  {
    "text": "squeal get it SQL but it's telling me your credentials so it's a",
    "start": "1843320",
    "end": "1850159"
  },
  {
    "text": "squeal I thought long and hard on that come on thank you thank you I made it up",
    "start": "1851159",
    "end": "1857440"
  },
  {
    "text": "myself I'd like to thank uh stanah and Robert Plant all right so this guy is listening",
    "start": "1857440",
    "end": "1867120"
  },
  {
    "text": "on 1433 and hopefully this new VMware 3.0",
    "start": "1867120",
    "end": "1872519"
  },
  {
    "text": "is not going to do what it did earlier we I kind of need to Bree through this pretty quickly",
    "start": "1872519",
    "end": "1879240"
  },
  {
    "text": "um so I've just got got a client side guy",
    "start": "1886120",
    "end": "1891240"
  },
  {
    "text": "here blah blah blah blah so here's the same code basically",
    "start": "1912120",
    "end": "1918000"
  },
  {
    "text": "that I have up here except you see my internal",
    "start": "1918000",
    "end": "1927278"
  },
  {
    "text": "address is it that",
    "start": "1931960",
    "end": "1935518"
  },
  {
    "text": "50 yep",
    "start": "1940279",
    "end": "1944279"
  },
  {
    "text": "so I open up an email I'm sorry I open up a a web oh",
    "start": "1957799",
    "end": "1965559"
  },
  {
    "text": "come on get me out of there",
    "start": "1965559",
    "end": "1970120"
  },
  {
    "text": "nope let me show you what we had on the browser side",
    "start": "1970639",
    "end": "1978880"
  },
  {
    "text": "that's too much for the",
    "start": "1981120",
    "end": "1984080"
  },
  {
    "text": "laptop sending a it response okay the all the website does",
    "start": "1990679",
    "end": "1997480"
  },
  {
    "text": "is just say hey please call me or whatever this would be the equivalent of an HTML",
    "start": "1997480",
    "end": "2003960"
  },
  {
    "text": "mail there were no warnings of course you didn't see me do it I can hit ref brush again no warnings no anything automatically instantiated that object",
    "start": "2004480",
    "end": "2011399"
  },
  {
    "text": "so what's happening on the red hat box hopefully is that it's",
    "start": "2011399",
    "end": "2017519"
  },
  {
    "text": "grabbing probably timed out the Squealer box is listening on",
    "start": "2021799",
    "end": "2030080"
  },
  {
    "text": "1433 waiting for a call nlm authentication call to come in",
    "start": "2030080",
    "end": "2035960"
  },
  {
    "text": "negotiates nlm sends me a challenge I send it a uh",
    "start": "2035960",
    "end": "2041039"
  },
  {
    "text": "response and then it dumps the uh the hash out for me just the same way the",
    "start": "2041039",
    "end": "2046960"
  },
  {
    "text": "talk in tlm did now on this one it said that the negotiation failed I'm thinking it timed out between the uh the two",
    "start": "2046960",
    "end": "2055520"
  },
  {
    "text": "sessions so you didn't actually get to see it display it on the screen and no",
    "start": "2055520",
    "end": "2061599"
  },
  {
    "text": "Round of Applause for that but um rather than making rather than",
    "start": "2061599",
    "end": "2067358"
  },
  {
    "text": "working on on the timeouts on that guy right now I'm going to jump over to my other exploit and we'll come back to this okay if we have time and I've got",
    "start": "2067359",
    "end": "2075878"
  },
  {
    "text": "the code and all of that stuff the thing the thing to remember is that with all of this development going",
    "start": "2075879",
    "end": "2082760"
  },
  {
    "text": "on that we we have to be very careful with",
    "start": "2082760",
    "end": "2089878"
  },
  {
    "text": "whom we give the tools to the user rights that those people have on those machines and really more importantly we",
    "start": "2089879",
    "end": "2097079"
  },
  {
    "text": "have to continue to have a mindset of security and depth where you do a check here and then",
    "start": "2097079",
    "end": "2104920"
  },
  {
    "text": "you do a check there like we did on the secure development side right where even though",
    "start": "2104920",
    "end": "2112280"
  },
  {
    "text": "we know that there's little chance of them doing anything we still do a couple of checks here we tighten down SQL",
    "start": "2112280",
    "end": "2117640"
  },
  {
    "text": "Server over here we use um Windows integrated authentication okay",
    "start": "2117640",
    "end": "2125760"
  },
  {
    "text": "so now I'm going to connect",
    "start": "2125760",
    "end": "2131760"
  },
  {
    "text": "up sorry I mean I I do want to trust everybody but I'm not going to connect",
    "start": "2132000",
    "end": "2138960"
  },
  {
    "text": "up with my thing what you saying I'm sorry please don't get",
    "start": "2138960",
    "end": "2144000"
  },
  {
    "text": "mad and hopefully I won't have to reboot again",
    "start": "2144000",
    "end": "2149480"
  },
  {
    "text": "hopefully I won't have to reboot all right so just bear with me one moment please",
    "start": "2149480",
    "end": "2159079"
  },
  {
    "text": "so I'm going to connect up to the Batcave with a super secret dialup number that takes me into a non- routed",
    "start": "2166920",
    "end": "2173880"
  },
  {
    "text": "Network and that's the cool thing is that now if they're tracing",
    "start": "2174480",
    "end": "2179599"
  },
  {
    "text": "this it looks like it's coming from Charleston South Carolina",
    "start": "2179599",
    "end": "2185560"
  },
  {
    "text": "[Music]",
    "start": "2186540",
    "end": "2192059"
  },
  {
    "text": "you guys yeah there we go yeah then it's on",
    "start": "2194160",
    "end": "2200160"
  },
  {
    "text": "my [Music] chest it's okay yeah now we have it on video",
    "start": "2200160",
    "end": "2208078"
  },
  {
    "text": "great I'm changing it okay it's like the American Express",
    "start": "2211560",
    "end": "2218880"
  },
  {
    "text": "commercials where they actually have a picture of the real card and you're",
    "start": "2218880",
    "end": "2224640"
  },
  {
    "text": "like yeah I'd like to buy that all right so we're connected up at",
    "start": "2224640",
    "end": "2229839"
  },
  {
    "text": "a measley 264 who's familiar with Steve Gibson's",
    "start": "2229839",
    "end": "2239559"
  },
  {
    "text": "site what um it has some interesting capabilities",
    "start": "2240359",
    "end": "2249319"
  },
  {
    "text": "yes no",
    "start": "2249319",
    "end": "2256119"
  },
  {
    "text": "um Mr Gibson has a site that allows us to",
    "start": "2256119",
    "end": "2263839"
  },
  {
    "text": "um us and more than 10 million other folks to scan our computer computers to",
    "start": "2271280",
    "end": "2278640"
  },
  {
    "text": "find out what ports are",
    "start": "2278640",
    "end": "2281640"
  },
  {
    "text": "open there was a lot of discussion about Windows xp's propensity to be the",
    "start": "2285160",
    "end": "2293319"
  },
  {
    "text": "new denial of service preference for script kitties and hackers everywhere",
    "start": "2293319",
    "end": "2298680"
  },
  {
    "text": "because of its support for raw sockets as if nothing else had raw",
    "start": "2298680",
    "end": "2303960"
  },
  {
    "text": "sockets before which it always has had uh",
    "start": "2303960",
    "end": "2309440"
  },
  {
    "text": "um part part of what he allows us to do is to protect",
    "start": "2310119",
    "end": "2316920"
  },
  {
    "text": "ourselves from Microsoft and who he thinks is um a very very bad developer",
    "start": "2316920",
    "end": "2323960"
  },
  {
    "text": "and evil incarnate and he allows us to do that by going to this Shields up site um it's a",
    "start": "2323960",
    "end": "2332079"
  },
  {
    "text": "secure site so nobody gets to really see what's going on here you're about to",
    "start": "2332079",
    "end": "2337280"
  },
  {
    "text": "pass pass yes in the future do not show it to me",
    "start": "2337280",
    "end": "2342119"
  },
  {
    "text": "again okay so for those of you who haven't who",
    "start": "2344359",
    "end": "2350160"
  },
  {
    "text": "has actually used this site who is a fan of Mr",
    "start": "2350160",
    "end": "2357040"
  },
  {
    "text": "Gibson yay who is not a fan of Mr Gibson I'm just curious and I'm not going to make a",
    "start": "2357040",
    "end": "2363160"
  },
  {
    "text": "value judgment",
    "start": "2363160",
    "end": "2366520"
  },
  {
    "text": "so here's what happens we go to this",
    "start": "2369000",
    "end": "2374800"
  },
  {
    "text": "site and from here we can test our Shields and probe our",
    "start": "2377359",
    "end": "2383240"
  },
  {
    "text": "ports I'm going to say to start with test my",
    "start": "2383400",
    "end": "2388760"
  },
  {
    "text": "Shields so it tells us our IP address this is actually the IP address of a box in",
    "start": "2388760",
    "end": "2394839"
  },
  {
    "text": "Charleston but it's proxy right so I'm in so what he's doing is he accepts a",
    "start": "2394839",
    "end": "2401079"
  },
  {
    "text": "connection from us takes the IP address out of the HTTP header and then pumps",
    "start": "2401079",
    "end": "2406920"
  },
  {
    "text": "that in to his dll up here that performs the",
    "start": "2406920",
    "end": "2414359"
  },
  {
    "text": "scanning for us tells if it's 139 is open this is a relatively simple",
    "start": "2414359",
    "end": "2421960"
  },
  {
    "text": "test and he's told me that I'm a good little boy because he couldn't do anything on one 39 so now what we're",
    "start": "2421960",
    "end": "2429400"
  },
  {
    "text": "going to do is go to probe my ports and this does a little bit more of",
    "start": "2429400",
    "end": "2436240"
  },
  {
    "text": "an intensive scan identifying the most commonly abused open",
    "start": "2436240",
    "end": "2445200"
  },
  {
    "text": "ports tells me about 21 23 basically does a really nice scan",
    "start": "2445200",
    "end": "2451200"
  },
  {
    "text": "of my box now everything is closed and stealth on this box except 25 as far as his",
    "start": "2451200",
    "end": "2459359"
  },
  {
    "text": "system can see so that's good I had like a passing grade now you'll see up here in the URL",
    "start": "2459359",
    "end": "2466839"
  },
  {
    "text": "there's really nothing that identifies what my IP address is so how is he doing it how does he identify what our IP",
    "start": "2466839",
    "end": "2473880"
  },
  {
    "text": "address is I thought that",
    "start": "2473880",
    "end": "2479319"
  },
  {
    "text": "too no I was asking how you mean this R",
    "start": "2479319",
    "end": "2486640"
  },
  {
    "text": "whatever if you change them around make right but that's not where that",
    "start": "2486640",
    "end": "2491920"
  },
  {
    "text": "comes from but here what here's what we'll uh I'm going to view the",
    "start": "2491920",
    "end": "2499040"
  },
  {
    "text": "source of this document actually I'm going to view the source of the previous",
    "start": "2499040",
    "end": "2506119"
  },
  {
    "text": "document the probe my",
    "start": "2507160",
    "end": "2510960"
  },
  {
    "text": "ports now let me look for what would be a dumb way of doing",
    "start": "2515200",
    "end": "2521318"
  },
  {
    "text": "it hidden nope hidden internet server that's not",
    "start": "2522920",
    "end": "2528000"
  },
  {
    "text": "it well look at you there input type is",
    "start": "2528000",
    "end": "2534880"
  },
  {
    "text": "hidden value equals A2 YF L JB which happens to be an eight",
    "start": "2534880",
    "end": "2543079"
  },
  {
    "text": "character alpha numeric string which oddly enough Maps right over to the octets of our IP",
    "start": "2543079",
    "end": "2551960"
  },
  {
    "text": "address so in a client's side HTML document he's chosen to",
    "start": "2552280",
    "end": "2561000"
  },
  {
    "text": "identify my IP address in a hidden HTML tag so let's go file save I mean file",
    "start": "2561000",
    "end": "2570920"
  },
  {
    "text": "save as",
    "start": "2570920",
    "end": "2576119"
  },
  {
    "text": "back slgc",
    "start": "2576119",
    "end": "2580440"
  },
  {
    "text": "HTM oh I could have just done it right there",
    "start": "2585319",
    "end": "2589640"
  },
  {
    "text": "huh open this up here we have back where our hidden field",
    "start": "2603559",
    "end": "2609960"
  },
  {
    "text": "was and I'm going to have my post action be",
    "start": "2609960",
    "end": "2615760"
  },
  {
    "text": "HTTP grc.com",
    "start": "2615760",
    "end": "2619800"
  },
  {
    "text": "SLX yep file save",
    "start": "2621160",
    "end": "2628880"
  },
  {
    "text": "that so what do you say we mess around with",
    "start": "2628880",
    "end": "2634960"
  },
  {
    "text": "this value instead of JB let's put who",
    "start": "2634960",
    "end": "2643280"
  },
  {
    "text": "knows um m",
    "start": "2643280",
    "end": "2647400"
  },
  {
    "text": "o save now we still don't know what that value is we still don't we're assuming",
    "start": "2649800",
    "end": "2656440"
  },
  {
    "text": "it's the IP address that's somehow cryptographically represented",
    "start": "2656440",
    "end": "2663559"
  },
  {
    "text": "well well it is indeed change the first two",
    "start": "2677319",
    "end": "2684839"
  },
  {
    "text": "octets of the IP address",
    "start": "2684839",
    "end": "2691119"
  },
  {
    "text": "so FTP on whatever this box is wherever in the world it is is closed",
    "start": "2691119",
    "end": "2698920"
  },
  {
    "text": "https is closed everything else is stealth well good for",
    "start": "2699319",
    "end": "2704318"
  },
  {
    "text": "them however I'm the one looking at the information",
    "start": "2705240",
    "end": "2712839"
  },
  {
    "text": "so in an application that's designed to be used for",
    "start": "2713000",
    "end": "2720400"
  },
  {
    "text": "security designed by a security",
    "start": "2720400",
    "end": "2724920"
  },
  {
    "text": "professional we've introduced hidden HTML tags that represent the IP address",
    "start": "2725960",
    "end": "2732960"
  },
  {
    "text": "that with a very simple basic edit allows us to change some of the characters",
    "start": "2732960",
    "end": "2738440"
  },
  {
    "text": "around post into his server and not just SC scan someone else's",
    "start": "2738440",
    "end": "2744880"
  },
  {
    "text": "machine but scan someone else's the machine and give me the",
    "start": "2744880",
    "end": "2751400"
  },
  {
    "text": "results now we're not going to be able to just sit here all day and fuss around with this cryptographic hash of the IP",
    "start": "2751520",
    "end": "2757920"
  },
  {
    "text": "address right and this really doesn't matter too",
    "start": "2757920",
    "end": "2763400"
  },
  {
    "text": "much because you know after all we don't know what the hash is well I kind of do but",
    "start": "2763400",
    "end": "2771000"
  },
  {
    "text": "I'm not telling but I'm going to tell you why it doesn't matter what's",
    "start": "2771000",
    "end": "2778680"
  },
  {
    "text": "uh give me an IP address",
    "start": "2778680",
    "end": "2784000"
  },
  {
    "text": "somebody what a public IP address that you'll know will uh wait here we",
    "start": "2785599",
    "end": "2792599"
  },
  {
    "text": "go wait wait ping",
    "start": "2792599",
    "end": "2797800"
  },
  {
    "text": "www.microsoft.com canis oh yeah that's right they've got icmp off of there",
    "start": "2798200",
    "end": "2805720"
  },
  {
    "text": "um",
    "start": "2807520",
    "end": "2810520"
  },
  {
    "text": "Cisco oh you know what I don't have my firewall client installed on this guy so the uh dial up's not going to go out of",
    "start": "2813160",
    "end": "2819160"
  },
  {
    "text": "him um but DHCP should have I mean DNS should have still tried to resolve",
    "start": "2819160",
    "end": "2825599"
  },
  {
    "text": "it huh 17. who",
    "start": "2825599",
    "end": "2834079"
  },
  {
    "text": "254 Z 921 that's apples 91 I was going to say wow that",
    "start": "2834079",
    "end": "2842960"
  },
  {
    "text": "might be apples maybe that's the problem",
    "start": "2842960",
    "end": "2848839"
  },
  {
    "text": "okay um so we saw",
    "start": "2851920",
    "end": "2858599"
  },
  {
    "text": "earlier a reference on his site to oop we don't have much",
    "start": "2858599",
    "end": "2867119"
  },
  {
    "text": "time this little applet of his called uh IP",
    "start": "2867119",
    "end": "2872319"
  },
  {
    "text": "agent free IP agent okay",
    "start": "2872319",
    "end": "2877720"
  },
  {
    "text": "I'll take",
    "start": "2877720",
    "end": "2880200"
  },
  {
    "text": "it IP agent does some interesting things like supporting multiple IP",
    "start": "2883559",
    "end": "2893440"
  },
  {
    "text": "addresses multiple IPS before I do",
    "start": "2893440",
    "end": "2899880"
  },
  {
    "text": "this o stop stop get hold of yourself man",
    "start": "2901599",
    "end": "2908400"
  },
  {
    "text": "let's",
    "start": "2915319",
    "end": "2917599"
  },
  {
    "text": "see 17.",
    "start": "2921079",
    "end": "2925000"
  },
  {
    "text": "what yes",
    "start": "2933559",
    "end": "2937559"
  },
  {
    "text": "oh that's a nice little sound 17 25409",
    "start": "2946960",
    "end": "2956359"
  },
  {
    "text": "there we go so courtesy of Mr Gibson we are now",
    "start": "2975359",
    "end": "2981200"
  },
  {
    "text": "scanning Apple's computers and returning the results set",
    "start": "2981200",
    "end": "2986280"
  },
  {
    "text": "to me so any IP that we want we now have a",
    "start": "2986280",
    "end": "2991520"
  },
  {
    "text": "scanning proxy available to us which will allow us to",
    "start": "2991520",
    "end": "2996760"
  },
  {
    "text": "gathers some really rich information now notice",
    "start": "2996760",
    "end": "3003079"
  },
  {
    "text": "and previously to me doing this if you look in the",
    "start": "3003079",
    "end": "3008960"
  },
  {
    "text": "URL since I have multiple IP addresses there you have the",
    "start": "3008960",
    "end": "3016000"
  },
  {
    "text": "representation of the IP address directly in the URL so what this allows us to do is we",
    "start": "3016000",
    "end": "3022880"
  },
  {
    "text": "can either cryptographically attack the hash",
    "start": "3022880",
    "end": "3028000"
  },
  {
    "text": "whatever the little algorithm which my guess uneducated guess without really even looking at the algorithm might be a",
    "start": "3028000",
    "end": "3034400"
  },
  {
    "text": "shift bit register but I wouldn't know because",
    "start": "3034400",
    "end": "3040079"
  },
  {
    "text": "that would not be legal I guess I don't know I don't I mean I'm not worried about dmca for",
    "start": "3040079",
    "end": "3045359"
  },
  {
    "text": "stuff like that but that would allow you to",
    "start": "3045359",
    "end": "3050920"
  },
  {
    "text": "programmatically script this stuff so with the",
    "start": "3050920",
    "end": "3058000"
  },
  {
    "text": "T1 we could script oh I don't know a million simultaneous requests against",
    "start": "3058000",
    "end": "3064680"
  },
  {
    "text": "somebody's IP address to send a series of Nano probes to their",
    "start": "3064680",
    "end": "3071000"
  },
  {
    "text": "box one after another",
    "start": "3071000",
    "end": "3074400"
  },
  {
    "text": "continuously in effect we could use him to pose a distributed really wouldn't be",
    "start": "3076280",
    "end": "3082640"
  },
  {
    "text": "distributed but a denial of service attack on somebody else's box",
    "start": "3082640",
    "end": "3088559"
  },
  {
    "text": "so my humble statement would be we don't necessarily need to worry about raw",
    "start": "3091520",
    "end": "3096760"
  },
  {
    "text": "sockets problems with Microsoft as Gibson says but more importantly we might want to worry about Gibson",
    "start": "3096760",
    "end": "3105280"
  },
  {
    "text": "himself so this can be scripted as I said and all the results pushed out and",
    "start": "3106640",
    "end": "3112920"
  },
  {
    "text": "it can also be abused now how can we have prevented this I mean who I actually think this is",
    "start": "3112920",
    "end": "3120079"
  },
  {
    "text": "somewhat of an important it's kind of a big deal because I can scan other people's boxes",
    "start": "3120079",
    "end": "3127280"
  },
  {
    "text": "remotely scripti how could we pre prevented this",
    "start": "3127280",
    "end": "3133680"
  },
  {
    "text": "from a design standpoint",
    "start": "3133680",
    "end": "3140480"
  },
  {
    "text": "pardon he Pro he may have been able to use a session variable the one important",
    "start": "3140960",
    "end": "3146079"
  },
  {
    "text": "thing is that he's already gotten the IP address of the unit and he's taken the IP address of",
    "start": "3146079",
    "end": "3152400"
  },
  {
    "text": "the unit earlier on in the session and now he trusts me that he the",
    "start": "3152400",
    "end": "3158960"
  },
  {
    "text": "only variable he uses now is that one variable it would be extremely simple to",
    "start": "3158960",
    "end": "3166680"
  },
  {
    "text": "in this code check the current HTTP header remote",
    "start": "3166680",
    "end": "3173680"
  },
  {
    "text": "address and say okay I'm aware that I got the IP address that I'm supposed to",
    "start": "3173680",
    "end": "3179079"
  },
  {
    "text": "be scanning which is your IP address supposedly but just to be on the safe",
    "start": "3179079",
    "end": "3185839"
  },
  {
    "text": "side before I perform the scan against the box and all your ports let me look at the current session IP address and do",
    "start": "3185839",
    "end": "3192760"
  },
  {
    "text": "they match and if not don't do it you doesn't do",
    "start": "3192760",
    "end": "3200039"
  },
  {
    "text": "that to me the current session",
    "start": "3200079",
    "end": "3205319"
  },
  {
    "text": "validation uh would stop pretty much this whole process now notice how he",
    "start": "3205319",
    "end": "3210400"
  },
  {
    "text": "dumps it into a dll which means that there's a secondary process that's executing this",
    "start": "3210400",
    "end": "3217079"
  },
  {
    "text": "right even if he did that it would probably still be possible for me",
    "start": "3217079",
    "end": "3223359"
  },
  {
    "text": "to dump the request or multiple hundreds of thousands of requests to his",
    "start": "3223359",
    "end": "3231200"
  },
  {
    "text": "system and it it very well may be able to scan somebody else's box but at least",
    "start": "3231200",
    "end": "3236960"
  },
  {
    "text": "it wouldn't give me the results that's really the main issue here from a abuse",
    "start": "3236960",
    "end": "3244440"
  },
  {
    "text": "standpoint um I don't know when somebody's going to alert him to this there was something",
    "start": "3244440",
    "end": "3251280"
  },
  {
    "text": "similar to this that happened with a hacked version of the IP agent you know a year",
    "start": "3251280",
    "end": "3256599"
  },
  {
    "text": "ago and it was fixed in the IP agent but with this m multi-protocol",
    "start": "3256599",
    "end": "3264599"
  },
  {
    "text": "support pulling the IP address directly from the stack without even validating it and then presenting the push buttons",
    "start": "3264599",
    "end": "3270960"
  },
  {
    "text": "for me to scan is another part of the problem",
    "start": "3270960",
    "end": "3276799"
  },
  {
    "text": "remember give me a uh give me another IP address real",
    "start": "3276799",
    "end": "3283200"
  },
  {
    "text": "quick oh yeah five or",
    "start": "3284359",
    "end": "3291519"
  },
  {
    "text": "two three and a half all right so what I was going to show",
    "start": "3292760",
    "end": "3300079"
  },
  {
    "text": "you but",
    "start": "3300079",
    "end": "3303400"
  },
  {
    "text": "can't we can't [Music] now was that you know you could stack",
    "start": "3305760",
    "end": "3311599"
  },
  {
    "text": "your whole stack with IPS and go down one after another and just scan them all",
    "start": "3311599",
    "end": "3317079"
  },
  {
    "text": "all day long so those are the kind of functionality First Security last issues",
    "start": "3317079",
    "end": "3324839"
  },
  {
    "text": "that continue to be prevalent here on the internet I think it's particularly ironic right now he writes on he writes",
    "start": "3324839",
    "end": "3332240"
  },
  {
    "text": "on the same page where you pushed about goodam is well he did language assem",
    "start": "3332240",
    "end": "3339400"
  },
  {
    "text": "what it yes it",
    "start": "3339400",
    "end": "3344119"
  },
  {
    "text": "did so um I wish we had more time I was going to show you some other cool stuff but I guess that's all let me um are",
    "start": "3344880",
    "end": "3351720"
  },
  {
    "text": "there any quick questions before we all go drink how long is this",
    "start": "3351720",
    "end": "3358119"
  },
  {
    "text": "P well there's 10 million some OD scans being",
    "start": "3358119",
    "end": "3363559"
  },
  {
    "text": "done I'm probably responsible for 4 million of them myself",
    "start": "3363559",
    "end": "3369480"
  },
  {
    "text": "um I'd say that's been over the course of I don't know several years",
    "start": "3369480",
    "end": "3376760"
  },
  {
    "text": "now so I mean and and you you know can uh",
    "start": "3377720",
    "end": "3386838"
  },
  {
    "text": "IP agent has but the it's a newer version that supposedly fixed these",
    "start": "3387039",
    "end": "3392920"
  },
  {
    "text": "issues so all these were made public chose not to fix them",
    "start": "3392920",
    "end": "3398799"
  },
  {
    "text": "um and you know is and and I guess the other the other message is is that it it",
    "start": "3398799",
    "end": "3407400"
  },
  {
    "text": "doesn't just insecure processes don't just put you at risk they put other people at risk because tonight you know people are",
    "start": "3407400",
    "end": "3414400"
  },
  {
    "text": "going to be scanning the NSA right I mean not",
    "start": "3414400",
    "end": "3421240"
  },
  {
    "text": "right but they're going to be other people's boxes are going to be scanned and there's going to be absolutely no",
    "start": "3421640",
    "end": "3427440"
  },
  {
    "text": "retribution for those people and it's something that they shouldn't do but something that people do do but anyway",
    "start": "3427440",
    "end": "3432680"
  },
  {
    "text": "any any questions I know we're gotta get public pardon get yes I'm sorry thank",
    "start": "3432680",
    "end": "3440640"
  },
  {
    "text": "you very much um squeal and all of the things that we've done here",
    "start": "3440640",
    "end": "3447160"
  },
  {
    "text": "will be on the Hammer Of God website when I get back I'll post all this stuff up um www. hammer of God I don't trace",
    "start": "3447160",
    "end": "3456640"
  },
  {
    "text": "don't track you don't have to register or anything just go to the go to the conferences section and um you'll be",
    "start": "3456640",
    "end": "3463000"
  },
  {
    "text": "able to download the PowerPoint presentation I'll have all of these samples up there if you want to look at",
    "start": "3463000",
    "end": "3468960"
  },
  {
    "text": "them just remember now that the samples are wrong okay I mean they're on I I can see",
    "start": "3468960",
    "end": "3476839"
  },
  {
    "text": "it now hey man we got this from 10 it's like oh my God so I'll have all of that",
    "start": "3476839",
    "end": "3482119"
  },
  {
    "text": "stuff up there for everybody to uh to take a look at um thank you very much",
    "start": "3482119",
    "end": "3487880"
  },
  {
    "text": "wait wait thank you um this also has some good SQL injection and security and",
    "start": "3487880",
    "end": "3493640"
  },
  {
    "text": "stuff like that um all this is on the hammer God website if you have questions",
    "start": "3493640",
    "end": "3499000"
  },
  {
    "text": "or comments I'm Thor at Hammer Of God send me an email and I will reply to you um I'd like to thank you all very much",
    "start": "3499000",
    "end": "3505240"
  },
  {
    "text": "for your time and have a excellent resta black [Applause]",
    "start": "3505240",
    "end": "3516159"
  },
  {
    "text": "hat",
    "start": "3535039",
    "end": "3538039"
  },
  {
    "text": "e",
    "start": "3565039",
    "end": "3568039"
  },
  {
    "text": "e",
    "start": "3595039",
    "end": "3598039"
  },
  {
    "text": "e",
    "start": "3624960",
    "end": "3627960"
  },
  {
    "text": "e",
    "start": "3654920",
    "end": "3657920"
  },
  {
    "text": "e e",
    "start": "3684920",
    "end": "3688880"
  },
  {
    "text": "e",
    "start": "3774839",
    "end": "3777839"
  },
  {
    "text": "e",
    "start": "3804760",
    "end": "3807760"
  },
  {
    "text": "e",
    "start": "3834720",
    "end": "3837720"
  },
  {
    "text": "e for",
    "start": "3864720",
    "end": "3868680"
  }
]