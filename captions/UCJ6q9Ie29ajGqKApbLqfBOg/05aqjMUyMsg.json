[
  {
    "text": "[Music] [Laughter]",
    "start": "1610",
    "end": "10260"
  },
  {
    "text": "we're in uh track s Mass Effect and our next speaker is Zach cutp with from SQL",
    "start": "10960",
    "end": "17680"
  },
  {
    "text": "injection emits overflows and I just want to remind everybody that we do have a microphone over here on the side so",
    "start": "17680",
    "end": "23599"
  },
  {
    "text": "that when it comes question and answer if he can't hear you you can use the mic",
    "start": "23599",
    "end": "28960"
  },
  {
    "text": "Z all right all right thanks a lot for coming",
    "start": "28960",
    "end": "35399"
  },
  {
    "text": "coming to hear my talk everybody it's a lot of people out there hope this talk doesn't suck all right okay so uh like",
    "start": "35399",
    "end": "44520"
  },
  {
    "text": "you said my name is Zachary cutlip and I'm going to be talking to you today about rooting uh and hacking Soho",
    "start": "44520",
    "end": "51280"
  },
  {
    "text": "routers now",
    "start": "51280",
    "end": "57239"
  },
  {
    "text": "okay all right before I actually get into the meat of the Hawk I just want to give a couple of shout outs um first of",
    "start": "57239",
    "end": "63039"
  },
  {
    "text": "all is my company tactical Network Solutions at TNS they let me hack on stuff and they also pay me money um I",
    "start": "63039",
    "end": "71560"
  },
  {
    "text": "don't think they figured out that I would probably do it for free so anyway it's a pretty sweet gig uh also my",
    "start": "71560",
    "end": "76759"
  },
  {
    "text": "friend and colleague Craig Hefner um when you sit next to Craig every day it's a little bit like cheating because",
    "start": "76759",
    "end": "83240"
  },
  {
    "text": "problems that should be hard just kind of become easy when Craig is around so I really appreciate Craig's help in all of",
    "start": "83240",
    "end": "89360"
  },
  {
    "text": "this okay um what am I going what am I going to be talking to you about today um so",
    "start": "89360",
    "end": "95799"
  },
  {
    "text": "first I'm going to go into some novel uses of SQL injection that you may or may not have thought about I'm also",
    "start": "95799",
    "end": "103280"
  },
  {
    "text": "going to be talking about the actual mechanics of how buffer overflows work on the myips CPU architecture um there's",
    "start": "103280",
    "end": "110840"
  },
  {
    "text": "just not a lot of information about myips and buffer overflows at least that I came across so I did quite a bit of",
    "start": "110840",
    "end": "116039"
  },
  {
    "text": "learning about that in in this project also I'm going to be dropping some OD on Netgear routers because OD days make",
    "start": "116039",
    "end": "123079"
  },
  {
    "text": "every talk more fun so going to be sharing some of those with you and I'm going to be sharing some uh embedded",
    "start": "123079",
    "end": "130239"
  },
  {
    "text": "device uh investigation techniques that are useful to me and I think will'll be useful to you if you're investigating",
    "start": "130239",
    "end": "135879"
  },
  {
    "text": "Soho routers and other types of uh kind of similar embedded devices um I'll be concluding with a",
    "start": "135879",
    "end": "143560"
  },
  {
    "text": "live demo uh I know whenever I go to a talk and it doesn't somehow end in a",
    "start": "143560",
    "end": "149040"
  },
  {
    "text": "root promt it's almost like the talk didn't even happen so hopefully I'm not going to disappoint you in that way and",
    "start": "149040",
    "end": "155120"
  },
  {
    "text": "then after all that um hopefully we'll have some time time for some questions I'll be happy to take any questions if we have",
    "start": "155120",
    "end": "160840"
  },
  {
    "text": "time uh before I get into the technical material I just want to say I had to be pretty brutal with what I could include",
    "start": "160840",
    "end": "167560"
  },
  {
    "text": "in in the presentation just due to time constraints so there's a lot of material in the white paper which you should have",
    "start": "167560",
    "end": "173000"
  },
  {
    "text": "on your conference CD and if you find this talk to be interesting I encourage you to read read the paper I actually",
    "start": "173000",
    "end": "178239"
  },
  {
    "text": "walk you through Soup To Nuts how I discovered and developed these these exploits so hopefully you'll find that",
    "start": "178239",
    "end": "184400"
  },
  {
    "text": "interesting all right so why do we why do we attack Soho routers to begin with",
    "start": "184400",
    "end": "190159"
  },
  {
    "text": "what's the motivation there well a successful compromise of a wireless Soho",
    "start": "190159",
    "end": "195519"
  },
  {
    "text": "router actually yields a pretty privileged vantage point to the attacker on a user's Network so for example um",
    "start": "195519",
    "end": "203519"
  },
  {
    "text": "attacking attacking and compromising one of these routers exposes potentially multiple connected users to subsequent",
    "start": "203519",
    "end": "210400"
  },
  {
    "text": "attack also uh it exposes all of those users internet-based Communications to",
    "start": "210400",
    "end": "215560"
  },
  {
    "text": "interception and manipulation in addition to that it's certainly not unheard of for people to",
    "start": "215560",
    "end": "221599"
  },
  {
    "text": "bring these devices into work for a variety of reasons sometimes legitimate sometimes not so much so a successful",
    "start": "221599",
    "end": "228400"
  },
  {
    "text": "compromise of a Soho router on a corporate Network can sometimes serve as kind of a side door into an otherwise",
    "start": "228400",
    "end": "234360"
  },
  {
    "text": "well-defended Network now the specific device I'm going to be talking about today is this",
    "start": "234360",
    "end": "239680"
  },
  {
    "text": "NETGEAR wndr 3700 now besides being a just a wireless",
    "start": "239680",
    "end": "245000"
  },
  {
    "text": "router it also has some enhanced capabilities like it'll serve up multimedia uh to your PlayStation or",
    "start": "245000",
    "end": "251879"
  },
  {
    "text": "your network connected television also it has a little s server built in and if",
    "start": "251879",
    "end": "257000"
  },
  {
    "text": "you plug a USB drive into it with some files it'll serve up those files over the network to um you know to your other",
    "start": "257000",
    "end": "263479"
  },
  {
    "text": "computers on on the network when you go on Amazon or new EG and kind of sort by",
    "start": "263479",
    "end": "268800"
  },
  {
    "text": "the number of review use of devices you actually see this falling into easily in the top five so it's a really pretty",
    "start": "268800",
    "end": "274840"
  },
  {
    "text": "popular device in large part I think due to these enhanced enhanced capabilities now here's one particular review um on",
    "start": "274840",
    "end": "282400"
  },
  {
    "text": "Amazon that suggests that there's potentially a lot of",
    "start": "282400",
    "end": "287560"
  },
  {
    "text": "fun to be had with this device um so that bodess well I think anyway so",
    "start": "287560",
    "end": "293759"
  },
  {
    "text": "besides the 3700 um I also downloaded an impact and did some binary analysis and",
    "start": "293759",
    "end": "299759"
  },
  {
    "text": "Ida um on the most recent two firmwares on the 3800 4,000 and 4,400 and at least",
    "start": "299759",
    "end": "307080"
  },
  {
    "text": "my initial investigation suggests that those devices also are vulnerable to the same exploits that I'm going to be",
    "start": "307080",
    "end": "312960"
  },
  {
    "text": "talking to you about today all right so when you get a new toy uh one of the",
    "start": "312960",
    "end": "318360"
  },
  {
    "text": "first steps in your analysis can be uh to take it apart and actually see what good stuff you find on the inside in",
    "start": "318360",
    "end": "325960"
  },
  {
    "text": "this case we find this art header and the art header is really useful to connect up a uart to USB adapter and",
    "start": "325960",
    "end": "333520"
  },
  {
    "text": "that actually lets you connect to the device via a terminal application like mincom and get yourself a root prompt on",
    "start": "333520",
    "end": "339479"
  },
  {
    "text": "the device now that's really useful for debugging and developing some more complicated exploits like one of the",
    "start": "339479",
    "end": "345880"
  },
  {
    "text": "ones that I'll show you later um because it lets you get a debugger on there and and actually connect to it with a",
    "start": "345880",
    "end": "351000"
  },
  {
    "text": "debugger um also on the back we have uh we have a USB port right because it's a",
    "start": "351000",
    "end": "356199"
  },
  {
    "text": "network attached storage server um it's useful ful to us this USB port because",
    "start": "356199",
    "end": "362000"
  },
  {
    "text": "the application I'm going to be talking about creates its sqlite database on the USB drive if that drive is plugged in",
    "start": "362000",
    "end": "368639"
  },
  {
    "text": "and that makes it easy to then get the database off the off the device and onto your workstation for",
    "start": "368639",
    "end": "374599"
  },
  {
    "text": "analysis also you um for some more complicated exploits like I said you'll need a debugger so you can put the",
    "start": "374599",
    "end": "380400"
  },
  {
    "text": "debugger on the USB drive and plug it in rather than trying to get the debugger onto the device some other way which can",
    "start": "380400",
    "end": "385919"
  },
  {
    "text": "be sometimes a little complicated so one of the first steps to analyzing the",
    "start": "385919",
    "end": "392479"
  },
  {
    "text": "software on the device is just to go to the vendor website or FTP site and download the firmware update file now",
    "start": "392479",
    "end": "399680"
  },
  {
    "text": "I'm not going to go into the technical details of unpacking firmware Craig's blog actually covers this in great",
    "start": "399680",
    "end": "405919"
  },
  {
    "text": "detail there's a lot of information about firmware unpacking and Analysis on Craig's blog so if you're interested in",
    "start": "405919",
    "end": "411360"
  },
  {
    "text": "that I suggest you check out Craig's blog and in fact there's a picture of Craig uh I think he actually maintains",
    "start": "411360",
    "end": "416639"
  },
  {
    "text": "the blog using a soldering iron I don't really know how he does that he's pretty crazy um anyway once we get the firmware",
    "start": "416639",
    "end": "424319"
  },
  {
    "text": "um it's a pretty easy uh man to just extract out the operating system kernel and one of the things that we see is",
    "start": "424319",
    "end": "429919"
  },
  {
    "text": "that we're running Linux on this device now that's really advantageous for a couple of reasons one is from an",
    "start": "429919",
    "end": "437919"
  },
  {
    "text": "analysis perspective it opens up a whole wealth of tools and techniques to you if if you're familiar with Linux and you're",
    "start": "437919",
    "end": "444240"
  },
  {
    "text": "already working with Linux everything that you kind of know and your and your tool chain and your processes are pretty portable this device because it's",
    "start": "444240",
    "end": "450960"
  },
  {
    "text": "running Linux and it's just a matter of compiling tools uh that can work on the device like debuggers and things like",
    "start": "450960",
    "end": "456479"
  },
  {
    "text": "that also once you've successfully compromised the device now you have a whole well whole set of attack tools",
    "start": "456479",
    "end": "462879"
  },
  {
    "text": "that are you know potential candidates to put on the device and a system matter of cross compiling them and loading on",
    "start": "462879",
    "end": "468720"
  },
  {
    "text": "there the next step is we can unpack and extract the squashfs file system that's",
    "start": "468720",
    "end": "474560"
  },
  {
    "text": "in the firmware and once we do that we find this interesting application mini",
    "start": "474560",
    "end": "480319"
  },
  {
    "text": "DLNA now why is it called mini dna. XE even though we're on a Linux system the",
    "start": "480319",
    "end": "487039"
  },
  {
    "text": "truth is I don't know um I don't know if that's even knowable but at any rate we're dealing with this application mini",
    "start": "487039",
    "end": "493400"
  },
  {
    "text": "DLNA uh that actually provides the devices multimedia capability so what is DLNA well it",
    "start": "493400",
    "end": "501720"
  },
  {
    "text": "stands for digital living network Alliance and it basically refers to a set of specifications that allow devices",
    "start": "501720",
    "end": "508159"
  },
  {
    "text": "to share multimedia files with each other so your DLNA connected television or Playstation can locate video and",
    "start": "508159",
    "end": "515120"
  },
  {
    "text": "music files on your network and then play them back for you but more importantly to us what DLNA represents",
    "start": "515120",
    "end": "522000"
  },
  {
    "text": "is a tax surface right any kind of extra features on this device above and beyond",
    "start": "522000",
    "end": "527880"
  },
  {
    "text": "their um core routing and Wi-Fi capability are additional opportunities",
    "start": "527880",
    "end": "533360"
  },
  {
    "text": "to find yourself some easy OD days write up a paper and maybe even submit it to a security conference right so uh the DNA",
    "start": "533360",
    "end": "541680"
  },
  {
    "text": "application is is an interesting Target for our research now going on the internet and just kind of seeing what",
    "start": "541680",
    "end": "547560"
  },
  {
    "text": "the internet knows about mini DNA uh we quickly discover that mini DNA is actually an open source project hosted",
    "start": "547560",
    "end": "553720"
  },
  {
    "text": "on Source Forge now I spend quite a bit of time in Ida Pro but I have to confess",
    "start": "553720",
    "end": "559480"
  },
  {
    "text": "my reversing skills aren't still to the point aren't quite to the point where I don't want to see source code so this",
    "start": "559480",
    "end": "564959"
  },
  {
    "text": "was actually a pretty pretty lucky find for me and our exercise now are analysis essentially becomes an exercise in",
    "start": "564959",
    "end": "570920"
  },
  {
    "text": "source code analysis so it's pretty easy just to run strings across your binary and see what",
    "start": "570920",
    "end": "577079"
  },
  {
    "text": "version string is in there and then check out the right version of of the application from Source forage and just start combing through the source and",
    "start": "577079",
    "end": "583600"
  },
  {
    "text": "looking for some low hanging fruit and um when I was doing this I was initially",
    "start": "583600",
    "end": "589079"
  },
  {
    "text": "looking for buffer overflows and I hadn't really considered the SQL injection angle um because we normally",
    "start": "589079",
    "end": "596079"
  },
  {
    "text": "think of SQL injection as a means of accessing sensitive or valuable data right but",
    "start": "596079",
    "end": "602680"
  },
  {
    "text": "what if the data in the database that you got a SQL injection for isn't sensitive or valuable well I would",
    "start": "602680",
    "end": "608680"
  },
  {
    "text": "submit that it's still potentially an opportunity to violate some developer assumptions and you know what happens",
    "start": "608680",
    "end": "615160"
  },
  {
    "text": "when you assume right you end up looking like an ass so I think the the opportunity for SQL injection here could",
    "start": "615160",
    "end": "621560"
  },
  {
    "text": "be kind of interesting now we can just kind of grip through the source code and look for some suspect SQL queries and",
    "start": "621560",
    "end": "628480"
  },
  {
    "text": "there are a bunch of candidates and one in particular pops out because like I said in the beginning I was actually looking for a buffer overflow and it's",
    "start": "628480",
    "end": "635360"
  },
  {
    "text": "this unbounded Sprint F now I have to say this isn't actually an opportunity",
    "start": "635360",
    "end": "640639"
  },
  {
    "text": "to get execution on the system unfortunately the most you can do here by overflowing this buffer is is Crash the application but no worries we we",
    "start": "640639",
    "end": "648320"
  },
  {
    "text": "still have a candidate for SQL injection what's happening in this function is",
    "start": "648320",
    "end": "653639"
  },
  {
    "text": "when the DLNA client wants to browse albamar it sends an HTTP get to the",
    "start": "653639",
    "end": "659639"
  },
  {
    "text": "application and then the application um pulls out the numeric ID in the URL and",
    "start": "659639",
    "end": "666000"
  },
  {
    "text": "passes that numeric ID into a SQL query and then it pulls out whatever path uh",
    "start": "666000",
    "end": "671440"
  },
  {
    "text": "is in the database that points to the album Mark and then serves that back up in response to the HTTP get here's a",
    "start": "671440",
    "end": "676480"
  },
  {
    "text": "closer look at at what's going on here at the uh at this frf and then the subsequent SQL um SQL query now we can",
    "start": "676480",
    "end": "683959"
  },
  {
    "text": "simulate what's happening just by taking that URL and putting it into our web browser and requesting",
    "start": "683959",
    "end": "690160"
  },
  {
    "text": "albumart ID number one now the the URL is actually being tokenized on the dash so everything the dash and after it's",
    "start": "690160",
    "end": "696279"
  },
  {
    "text": "just ignored so as you can see you can put whatever string after the dash you want but at any rate the album art is",
    "start": "696279",
    "end": "701600"
  },
  {
    "text": "served up now to test to see if we have a working SQL injection is actually pretty easy we just go to",
    "start": "701600",
    "end": "708560"
  },
  {
    "text": "WG and we give WG the same URL that we put in the web browser except after the",
    "start": "708560",
    "end": "713800"
  },
  {
    "text": "numeric albumart ID we terminate the SQL query with a semicolon and then put our put in our injected SQL query and here's",
    "start": "713800",
    "end": "720480"
  },
  {
    "text": "a SQL query that will attempt to create a bogus record in the database now like I said you can just pull the database",
    "start": "720480",
    "end": "726240"
  },
  {
    "text": "then off of your USB drive and then analyze it and when you do sure enough you see an a record got created with uh",
    "start": "726240",
    "end": "733120"
  },
  {
    "text": "ID 31337 so we have a working SQL injection",
    "start": "733120",
    "end": "739399"
  },
  {
    "text": "but there's some good news and bad news with this vulnerability so first of all it's trivial to exploit and we have full",
    "start": "739399",
    "end": "746480"
  },
  {
    "text": "control over the database and we can execute virtually any SQL query we want with this injection the bad news is",
    "start": "746480",
    "end": "753279"
  },
  {
    "text": "there's no valuable information really in the database right because it's just metad dat about songs and videos in fact",
    "start": "753279",
    "end": "759959"
  },
  {
    "text": "if the database is completely blown away it immediately gets recreated so it does this attack doesn't really yield you a",
    "start": "759959",
    "end": "765320"
  },
  {
    "text": "lot of access however if we go back to the vulnerable function that I showed you earlier what is happening is it it's",
    "start": "765320",
    "end": "771839"
  },
  {
    "text": "getting that result from that SQL query which contains a path to an albumart file the results from the SQL quer query",
    "start": "771839",
    "end": "779360"
  },
  {
    "text": "are not sanitized at all so whatever that path points to gets served up in response to the HTTP get if we look at a",
    "start": "779360",
    "end": "787000"
  },
  {
    "text": "legitimate entry in the database for an Alamar file we see it it it literally is an absolute path to a file on the file",
    "start": "787000",
    "end": "793240"
  },
  {
    "text": "system so maybe we can just create a uh use our SQL injection to create a record that points to something else uh again",
    "start": "793240",
    "end": "800000"
  },
  {
    "text": "going back to WG get um maybe we can create a record that points to Etsy password and then with a",
    "start": "800000",
    "end": "806000"
  },
  {
    "text": "subsequent WG pull back that fake album Arc file that we've created a record for and we see the contents of it are ety",
    "start": "806000",
    "end": "814000"
  },
  {
    "text": "password more to the point your admin password in clear text",
    "start": "814000",
    "end": "820519"
  },
  {
    "text": "okay so you might even say we have a bonus vulnerability here that they're storing passwords in clear text on the file system um so at this point in two",
    "start": "820519",
    "end": "828160"
  },
  {
    "text": "WG commands I've gotten the admin password to your router so I could log on to the admin interface and let's say",
    "start": "828160",
    "end": "834959"
  },
  {
    "text": "change DNS settings mess around with routing tables maybe even upload a",
    "start": "834959",
    "end": "840320"
  },
  {
    "text": "Trojan uh firmware to your device and take full take full control over it that",
    "start": "840320",
    "end": "845959"
  },
  {
    "text": "way but we haven't yet gotten code execution on the device and like I promised at the beginning I want to give",
    "start": "845959",
    "end": "852240"
  },
  {
    "text": "you a root shell so I'm not going to stop until we have a root shell on the device now if like me you read a1's",
    "start": "852240",
    "end": "861680"
  },
  {
    "text": "simal stack smashing paper and then we're disappointed to find that it doesn't really work that way in the real",
    "start": "861680",
    "end": "867320"
  },
  {
    "text": "world for a variety of reasons chiefly among them it isn't 1996 anymore I can",
    "start": "867320",
    "end": "873000"
  },
  {
    "text": "reassure you that you need to look no farther than Soho routers okay and we can just kind of grap through the source",
    "start": "873000",
    "end": "878920"
  },
  {
    "text": "code for some risky string handling functions like stir cat sprintf and and stir copy and we see a ton of potential",
    "start": "878920",
    "end": "886320"
  },
  {
    "text": "opportunities for buffer overflows now if you missed that let me give you a closer look that's 265 potential",
    "start": "886320",
    "end": "892440"
  },
  {
    "text": "opportunities for execution in this one application this is completely ridiculous one in particular stood out",
    "start": "892440",
    "end": "899120"
  },
  {
    "text": "and caught my eye in this really gnarly function that I've abbreviated way down so we can fit it on the screen and this",
    "start": "899120",
    "end": "905759"
  },
  {
    "text": "is this function is called callback and callback is handling the results of SQL queries and let me give you a closer",
    "start": "905759",
    "end": "912440"
  },
  {
    "text": "look at this unbounded sprintf here um so what we're doing is actually creating",
    "start": "912440",
    "end": "919079"
  },
  {
    "text": "a um creating a URL string with several fields from the result of a SQL query",
    "start": "919079",
    "end": "924839"
  },
  {
    "text": "and one field in particular is called albumart now let's look at the seal query that whose results were processing",
    "start": "924839",
    "end": "931319"
  },
  {
    "text": "it's this kind of big left join and I'll give you a closer look and there are a couple of details I want to call out to",
    "start": "931319",
    "end": "936720"
  },
  {
    "text": "you one is album art is a field on the details table and this query is a left join on",
    "start": "936720",
    "end": "943839"
  },
  {
    "text": "the details and objects table and that's going to be kind of important in a bit um and and and I'll get to that in a",
    "start": "943839",
    "end": "950079"
  },
  {
    "text": "minute but when we look at the schema for the details table we see that albumart is an integer in that table and",
    "start": "950079",
    "end": "957920"
  },
  {
    "text": "there are two things to note about that one is due to a feature in SQL light called type Affinity if SQL light can",
    "start": "957920",
    "end": "965120"
  },
  {
    "text": "store the value in Alamar as an integer it will if it can't it'll just store the",
    "start": "965120",
    "end": "970639"
  },
  {
    "text": "raw bytes which is awesome because that'll let us potentially store a string in the albumart",
    "start": "970639",
    "end": "976839"
  },
  {
    "text": "field also callback the call the vulnerable function is attempting to validate the results of the SQL query",
    "start": "976839",
    "end": "984480"
  },
  {
    "text": "using the a2i function now if you know how a2i works you know that all you need to do is pass it a string that starts",
    "start": "984480",
    "end": "990040"
  },
  {
    "text": "with a number and then everything after the number is ignored right so this is actually no validation at all and is",
    "start": "990040",
    "end": "995959"
  },
  {
    "text": "pretty easy to buypass do we have an exploitable buffer overflow we have a buffer overflow but",
    "start": "995959",
    "end": "1002000"
  },
  {
    "text": "is it exploitable well we have full control over the database and if we're going to exploit it somehow we need to",
    "start": "1002000",
    "end": "1009360"
  },
  {
    "text": "Stage some Shell Code in the database and then subsequently trigger a query of the State uh of the Shell Code back out",
    "start": "1009360",
    "end": "1015800"
  },
  {
    "text": "of the database so it gets executed we are dealing with a limitation",
    "start": "1015800",
    "end": "1020920"
  },
  {
    "text": "regarding our SQL injection like I said it's an it can crash the program but this particular SQL injection couldn't",
    "start": "1020920",
    "end": "1027319"
  },
  {
    "text": "actually get get you execution by itself we need to limit um each SQL injection to about 128 bytes by the time you take",
    "start": "1027319",
    "end": "1034480"
  },
  {
    "text": "into account overhead like with the SQL syntax and things like that we're trying to overflow a buffer that's 512 bytes",
    "start": "1034480",
    "end": "1041360"
  },
  {
    "text": "big so how do you do that fortunately SQL light comes to the rescue with the concatenation operator so just in",
    "start": "1041360",
    "end": "1048038"
  },
  {
    "text": "multiple passes you can build up your string in the database as long as you need it to",
    "start": "1048039",
    "end": "1053320"
  },
  {
    "text": "be so how do you trigger a query of the staged exploit well when I was initially",
    "start": "1053320",
    "end": "1060120"
  },
  {
    "text": "developing the exploit I was actually modeling a an entire DLNA client in Python using this Library called",
    "start": "1060120",
    "end": "1065679"
  },
  {
    "text": "coherence and that was a little flaky because uh due to the way ssdp and UPnP",
    "start": "1065679",
    "end": "1071440"
  },
  {
    "text": "works sometimes it would trigger the exploit immediately sometimes it would take a little while it was pretty annoying what I ended up doing is just",
    "start": "1071440",
    "end": "1077480"
  },
  {
    "text": "capturing the conversation in wire shark like so and then popping out the necessary soap request that will trigger",
    "start": "1077480",
    "end": "1084360"
  },
  {
    "text": "the exploit and you can just play back that soap request using WG and just bail on the coherence Library",
    "start": "1084360",
    "end": "1090559"
  },
  {
    "text": "altogether now you're going to need a couple things to develop this exploit so first you're going to need console",
    "start": "1090559",
    "end": "1095640"
  },
  {
    "text": "access to the device via the UR uh connector that I showed you earlier also you're going to need GDB",
    "start": "1095640",
    "end": "1102360"
  },
  {
    "text": "server cross compiled for myips and you're going to need GDB on your workstation compiled for the myips Target architecture",
    "start": "1102360",
    "end": "1110000"
  },
  {
    "text": "in order to test the vulnerability just attach GDB server to the Target process on the device and connect your local GDB",
    "start": "1110000",
    "end": "1115960"
  },
  {
    "text": "over the network to that GDB server and then use WG to Stage a couple of Records",
    "start": "1115960",
    "end": "1121600"
  },
  {
    "text": "in the database that will satisfy the left join and then start building up your overflow data in the database and",
    "start": "1121600",
    "end": "1128240"
  },
  {
    "text": "then use WG to post soap request so how much overflow data do you need to build",
    "start": "1128240",
    "end": "1133960"
  },
  {
    "text": "up in the database well it's a pretty simple matter of just repeating that process until you get a crash",
    "start": "1133960",
    "end": "1139000"
  },
  {
    "text": "in GDB and then to trigger the exploit this ridiculous WG incantation will",
    "start": "1139000",
    "end": "1144360"
  },
  {
    "text": "actually post your soap request when you do that if you get a crash in GDB",
    "start": "1144360",
    "end": "1150360"
  },
  {
    "text": "hopefully you see something beautiful like this um here we have highlighted in yellow program counter containing our",
    "start": "1150360",
    "end": "1157280"
  },
  {
    "text": "our data and program counter is analogous to EIP on x86 in addition to that you have all of",
    "start": "1157280",
    "end": "1163520"
  },
  {
    "text": "these s registers also uh containing our data and the S registers are are just general purpose registers on",
    "start": "1163520",
    "end": "1171080"
  },
  {
    "text": "myips so we control the program counter which means that we can control execution and decide for ourselves what",
    "start": "1171080",
    "end": "1177240"
  },
  {
    "text": "the program should do next but and we also control all of these s registers and that's incredibly useful for",
    "start": "1177240",
    "end": "1183240"
  },
  {
    "text": "developing a r exploit which we're going to have to do in a little bit but",
    "start": "1183240",
    "end": "1188440"
  },
  {
    "text": "controlling the program counter isn't the same as actually getting execution and I have to say in developing this",
    "start": "1188440",
    "end": "1193799"
  },
  {
    "text": "exploit I had the program counter really easily I mean as you can see this is this is is a pretty trivial",
    "start": "1193799",
    "end": "1199600"
  },
  {
    "text": "vulnerability actually getting execution to work reliably on the system was where",
    "start": "1199600",
    "end": "1204960"
  },
  {
    "text": "I actually spent probably 85% of my time so we have some challenges ahead of us",
    "start": "1204960",
    "end": "1210480"
  },
  {
    "text": "first is the fact that the stack is randomized so we have to somehow find a way to defeat that um also there are",
    "start": "1210480",
    "end": "1216240"
  },
  {
    "text": "some idiosyncrasies with the myips architecture that you may not be familiar with and you may be",
    "start": "1216240",
    "end": "1221720"
  },
  {
    "text": "disappointed to know that Rob is somewhat limited on mips uh compared to x86 if you're familiar with hell works",
    "start": "1221720",
    "end": "1228799"
  },
  {
    "text": "there we also have to deal with some bad characters uh not just due to htdp but due to the fact that we're exploiting a",
    "start": "1228799",
    "end": "1234840"
  },
  {
    "text": "SQL injection there are some things working to our advantage though uh first even",
    "start": "1234840",
    "end": "1241559"
  },
  {
    "text": "though the stack is randomized uh the Heap and libraries aren't so we'll be able to take take advantage of that to",
    "start": "1241559",
    "end": "1247320"
  },
  {
    "text": "find a lot of R Gadgets in the libraries that we'll be able to make use of the stack also is executable so assuming we",
    "start": "1247320",
    "end": "1253799"
  },
  {
    "text": "can locate the stack we should be able to return into it and execute our Shell Code so how does R on mips differ from",
    "start": "1253799",
    "end": "1262000"
  },
  {
    "text": "x86 um well one of the the biggest problem is the fact that all myip instructions are 4 bytes long and myip",
    "start": "1262000",
    "end": "1268880"
  },
  {
    "text": "memory accesses have to be aligned on 4 bytes and what this basically means for you is that there's no opportunity to",
    "start": "1268880",
    "end": "1275440"
  },
  {
    "text": "return into the middle of an instruction and have that instruction be decoded as some other instruction this really",
    "start": "1275440",
    "end": "1280480"
  },
  {
    "text": "reduces the number of R gadgets that you can potentially take advantage of fortunately we can still find some",
    "start": "1280480",
    "end": "1286720"
  },
  {
    "text": "pretty good rck gadgets that do things like manipulate registers load data that we control into program counter and even",
    "start": "1286720",
    "end": "1293360"
  },
  {
    "text": "um help locate the stack and defeat aslr so how do you locate the stack",
    "start": "1293360",
    "end": "1299279"
  },
  {
    "text": "using R um here's my gratuitous uh ID Pro screenshot showing a number an",
    "start": "1299279",
    "end": "1304480"
  },
  {
    "text": "instruction sequence that loads several offsets from the stack pointer into registers S3 4 and six and then",
    "start": "1304480",
    "end": "1311480"
  },
  {
    "text": "subsequently jumps to whatever is in register as zero now remember that we control all of the S register so all we",
    "start": "1311480",
    "end": "1317679"
  },
  {
    "text": "have to do is make sure that s0 contains the address of another rap Gadget that will in turn jump to whatever is in",
    "start": "1317679",
    "end": "1324080"
  },
  {
    "text": "register s34 or 6 and that gets us back into the stack all right myips cach coherency um",
    "start": "1324080",
    "end": "1332120"
  },
  {
    "text": "is kind of an interesting problem that we have to deal with myips has two parallel caches on the CPU one for",
    "start": "1332120",
    "end": "1337720"
  },
  {
    "text": "instructions and one for data our payload was written to the stack is data",
    "start": "1337720",
    "end": "1342960"
  },
  {
    "text": "which means it it's residing in the data cache and not in main memory uh until that cach is flushed and so we can't",
    "start": "1342960",
    "end": "1349799"
  },
  {
    "text": "execute our payload until it gets flushed out to main memory so how do you flush the cash well you could just do a",
    "start": "1349799",
    "end": "1356200"
  },
  {
    "text": "really big right to the stack and fill up the cach and trigger a flush but you might not be able to overflow a buffer",
    "start": "1356200",
    "end": "1361840"
  },
  {
    "text": "with that much data fortunately Linux provides a cash flush system call that",
    "start": "1361840",
    "end": "1367360"
  },
  {
    "text": "you can use and in fact I believe if you check the man page for cash flush it'll even tell you that the system call is",
    "start": "1367360",
    "end": "1373960"
  },
  {
    "text": "only implemented on myips so there there you go um if you you can set up the parameters for cache flush properly and",
    "start": "1373960",
    "end": "1380880"
  },
  {
    "text": "then R into it then you can force the cache to be flushed and then start executing your code off the",
    "start": "1380880",
    "end": "1387039"
  },
  {
    "text": "stack we also have to deal with bad characters so bad characters are not an original problem right so spaces break",
    "start": "1387039",
    "end": "1394360"
  },
  {
    "text": "HTTP uh null bites Break String handling functions but we're also exploiting a",
    "start": "1394360",
    "end": "1399720"
  },
  {
    "text": "SQL injection and sqlite has its own set of characters that it'll specially interpret unless they're properly",
    "start": "1399720",
    "end": "1405200"
  },
  {
    "text": "escaped fortunately sqlite provides an escape sequence that we can use so it's just a matter of escaping any of those",
    "start": "1405200",
    "end": "1411559"
  },
  {
    "text": "bad characters when they're in your shell code and fortunately that escape sequence doesn't conflict with any of",
    "start": "1411559",
    "end": "1416880"
  },
  {
    "text": "the other Bad characters for HTTP or anything else so you just Escape your sqlite bad characters like that and and",
    "start": "1416880",
    "end": "1424400"
  },
  {
    "text": "that takes care of that problem now the knop instruction on myips is kind of a pain right because it's all no bites um",
    "start": "1424400",
    "end": "1431640"
  },
  {
    "text": "but it's not too hard to deal with you just need to use some other instruction that's either inert or doesn't have any",
    "start": "1431640",
    "end": "1436919"
  },
  {
    "text": "effects that you care about and so that's that's how you deal with that problem now this is where I actually",
    "start": "1436919",
    "end": "1443880"
  },
  {
    "text": "spent most of my work most of my time on this on this project this was just kind of",
    "start": "1443880",
    "end": "1449080"
  },
  {
    "text": "ridiculous metlo provides you with one payload and one encoder for myips and I",
    "start": "1449080",
    "end": "1455440"
  },
  {
    "text": "was never able to get it to work if I attached to the process and single Ste through the decoding and execution of",
    "start": "1455440",
    "end": "1461360"
  },
  {
    "text": "the payload in a debugger it would work every time if I didn't have a debugger attached to it it would crash every time",
    "start": "1461360",
    "end": "1468000"
  },
  {
    "text": "and I never did sort out what the problem was there and I I'm really embarrassed to say how long I spent",
    "start": "1468000",
    "end": "1474279"
  },
  {
    "text": "trying to sort through that what I ended up doing was just bailing on Metate altogether wrote my own payload that",
    "start": "1474279",
    "end": "1479799"
  },
  {
    "text": "doesn't have any null bites in it and then therefore doesn't need a decoder now um kind just kind of a TP if",
    "start": "1479799",
    "end": "1485960"
  },
  {
    "text": "indianist sort of messes around with your head the way it does mine and we're dealing with a little Indian architecture here um you can do things",
    "start": "1485960",
    "end": "1492600"
  },
  {
    "text": "like set your callback IP address to all 10 so that bite order doesn't matter and then do that and until you get issues",
    "start": "1492600",
    "end": "1498880"
  },
  {
    "text": "with your payload sorted out and then figure out the indianness later or don't figure it out at all as the case may be",
    "start": "1498880",
    "end": "1505279"
  },
  {
    "text": "like I did um anyway in a bit when I show you the exploit um you'll actually",
    "start": "1505279",
    "end": "1511279"
  },
  {
    "text": "see the exploit staging the Overflow data in three pieces so there's the initial overflow data which is just sort",
    "start": "1511279",
    "end": "1517360"
  },
  {
    "text": "of a random string that overflows the buffer and there's a r chain which overwrites the return address and sets",
    "start": "1517360",
    "end": "1522640"
  },
  {
    "text": "up a sequence sequence of rap gadgets that will do things like flush the cache and uh help us locate the stack and then",
    "start": "1522640",
    "end": "1530159"
  },
  {
    "text": "the third piece is the actual TCP connect back payload which will connect back to our system and give us a root",
    "start": "1530159",
    "end": "1537000"
  },
  {
    "text": "cell okay now it's time for a little demo now in the demo um I'm actually",
    "start": "1537000",
    "end": "1543120"
  },
  {
    "text": "going to show you uh two exploits uh one is the exploit that extracts sensitive files from the system and then the",
    "start": "1543120",
    "end": "1549679"
  },
  {
    "text": "second exploit um exploits the buffer overflow giving us a root prompt once um",
    "start": "1549679",
    "end": "1555720"
  },
  {
    "text": "once we have the root prompt then I'll Al i' also like to show you how you can start uploading some files to the system",
    "start": "1555720",
    "end": "1560840"
  },
  {
    "text": "to transform it into kind of a a useful attack platform now bear bear with me",
    "start": "1560840",
    "end": "1566960"
  },
  {
    "text": "for just a second while I switch screen modes um I want to be able to mirror the",
    "start": "1566960",
    "end": "1572000"
  },
  {
    "text": "display so that I can see the same thing you're seeing right so we go over",
    "start": "1572000",
    "end": "1578679"
  },
  {
    "text": "here see I'm going to kill these terminal sessions try them again oh I think I see",
    "start": "1580720",
    "end": "1587799"
  },
  {
    "text": "what the problem is display let's let the demo Gods be with",
    "start": "1587799",
    "end": "1595000"
  },
  {
    "text": "us all right confirm that sweet all",
    "start": "1595000",
    "end": "1602760"
  },
  {
    "text": "right let's go",
    "start": "1608039",
    "end": "1611600"
  },
  {
    "text": "demo it's going to work there we go resize these terminal Windows a",
    "start": "1613640",
    "end": "1621480"
  },
  {
    "text": "bit okay all right so the first exploit like",
    "start": "1628399",
    "end": "1633720"
  },
  {
    "text": "I said will allow us to actually extract uh some sensitive files from the file system now um in the slides I actually",
    "start": "1633720",
    "end": "1641279"
  },
  {
    "text": "showed you extract I showed you extracting Etsy password now I have to confess that Etsy password only gets",
    "start": "1641279",
    "end": "1646760"
  },
  {
    "text": "created on the system when you plug in a USB drive because for some reason samb creates it but let's just punt on at the",
    "start": "1646760",
    "end": "1653480"
  },
  {
    "text": "password since that's not always going to be available and maybe let's actually try grabbing the entire device",
    "start": "1653480",
    "end": "1659080"
  },
  {
    "text": "configuration so I've wrapped up the um I wrapped up the exploit in a little",
    "start": "1659080",
    "end": "1665320"
  },
  {
    "text": "python script and I'm going to tell it to give us Dev MTD Block",
    "start": "1665320",
    "end": "1671360"
  },
  {
    "text": "14 and this um this block device actually points to is a way of accessing",
    "start": "1671360",
    "end": "1676840"
  },
  {
    "text": "nvram so if we can get that we have all of nvram and the entire devices configuration",
    "start": "1676840",
    "end": "1684559"
  },
  {
    "text": "so what's going on try it",
    "start": "1685919",
    "end": "1691960"
  },
  {
    "text": "again okay so what we see here is the exploit actually uh deleting making sure the old record isn't already there then",
    "start": "1697440",
    "end": "1704440"
  },
  {
    "text": "creates a new record that points to Dev MTD block zero and then gives us a URL that we can pull back our fake albar",
    "start": "1704440",
    "end": "1714120"
  },
  {
    "text": "file so if you run strings across what we've",
    "start": "1714120",
    "end": "1719158"
  },
  {
    "text": "got and grap for things like",
    "start": "1719880",
    "end": "1724519"
  },
  {
    "text": "password ah thanks okay then we start seeing things like WPA",
    "start": "1728000",
    "end": "1734519"
  },
  {
    "text": "passwords admin passwords um there's all there's all kinds of interesting configuration data in there so we have",
    "start": "1734519",
    "end": "1741399"
  },
  {
    "text": "the entirety of nvram the entire devices configuration in one really trivial text",
    "start": "1741399",
    "end": "1746480"
  },
  {
    "text": "PL vulnerability all right the next one that I want to show you is where we",
    "start": "1746480",
    "end": "1753000"
  },
  {
    "text": "exploit the buffer overflow and we actually get a root a root shell so um I",
    "start": "1753000",
    "end": "1758760"
  },
  {
    "text": "wrote a little program here that this is basically like netcat listening for a connection but uh I wrote it in Python",
    "start": "1758760",
    "end": "1764760"
  },
  {
    "text": "to give us a little bit better output um so I'm going to use",
    "start": "1764760",
    "end": "1770240"
  },
  {
    "text": "that and then that's in the right window and then in the left window I'm actually going to run the um run the",
    "start": "1770240",
    "end": "1778640"
  },
  {
    "text": "xplit and we'll see it in injecting the pieces of the payload and um once it's",
    "start": "1779279",
    "end": "1785960"
  },
  {
    "text": "doing once it has done that and triggered the exploit then we'll actually see the connection come in in",
    "start": "1785960",
    "end": "1791080"
  },
  {
    "text": "the rightand window it's also giving us a running SQL",
    "start": "1791080",
    "end": "1798360"
  },
  {
    "text": "injection",
    "start": "1798360",
    "end": "1800799"
  },
  {
    "text": "count and then we should see the connection come in here in the right hand",
    "start": "1806760",
    "end": "1813000"
  },
  {
    "text": "window boo what has just",
    "start": "1815039",
    "end": "1821480"
  },
  {
    "text": "happened well that kind of sucks all right I'm going to reboot the router I'm",
    "start": "1824159",
    "end": "1829320"
  },
  {
    "text": "assuming we crash the application oh no I know what the problem is okay while I'm rebooting the router uh so the only",
    "start": "1829320",
    "end": "1835640"
  },
  {
    "text": "time this exploit ever fails is when I actually forget to set my callback IP address properly um so presumably the",
    "start": "1835640",
    "end": "1842960"
  },
  {
    "text": "exploit worked and I just didn't have the right IP address",
    "start": "1842960",
    "end": "1847640"
  },
  {
    "text": "so there we go all right we'll give it we'll give it one more",
    "start": "1853679",
    "end": "1861759"
  },
  {
    "text": "try wait for the router to come back up so then in a bit and I'm hope I'm not",
    "start": "1862200",
    "end": "1868399"
  },
  {
    "text": "running out of time I think I'm doing okay um then in a in a bit once we get the root prompt then um then like I said",
    "start": "1868399",
    "end": "1875519"
  },
  {
    "text": "I'll actually show you how we can start uh start loading some tools on the",
    "start": "1875519",
    "end": "1880799"
  },
  {
    "text": "device and kind of transform it into an attack platform I'm going to use my album",
    "start": "1880799",
    "end": "1888200"
  },
  {
    "text": "alart inject uh Pro uh tool again because it's it won't crash the program but it'll let me know",
    "start": "1888200",
    "end": "1895760"
  },
  {
    "text": "um okay so so the application is up and running that's good okay let's try one",
    "start": "1895760",
    "end": "1900919"
  },
  {
    "text": "more time start up callback",
    "start": "1900919",
    "end": "1905638"
  },
  {
    "text": "server okay so it's clearing out the existing exploit data in case that happened to be there in the",
    "start": "1906200",
    "end": "1912240"
  },
  {
    "text": "database it's staging the exploit my progress bar never looks right if the windows was too small",
    "start": "1912240",
    "end": "1920960"
  },
  {
    "text": "um staging the exploit and then in a bit we should see",
    "start": "1921279",
    "end": "1928480"
  },
  {
    "text": "the connection coming",
    "start": "1928480",
    "end": "1931440"
  },
  {
    "text": "in okay there we",
    "start": "1936679",
    "end": "1940240"
  },
  {
    "text": "go all right reprompt right a promise to reprompt and then there we go so it's",
    "start": "1943039",
    "end": "1948159"
  },
  {
    "text": "like this talk almost happened um okay so sometimes on on these little",
    "start": "1948159",
    "end": "1954559"
  },
  {
    "text": "embedded devices the only kind of uh service that you have running might be something like a tet session in fact I'm",
    "start": "1954559",
    "end": "1960559"
  },
  {
    "text": "going to start up a tet server right here um just because our our shell",
    "start": "1960559",
    "end": "1968159"
  },
  {
    "text": "session is is um is not a very good one you we don't have any command history or",
    "start": "1968159",
    "end": "1973519"
  },
  {
    "text": "anything like that so actually let me start up tet and then exit out and and then um and then tet into it so we have",
    "start": "1973519",
    "end": "1980399"
  },
  {
    "text": "a little bit more of a usable environment okay so now now we're now",
    "start": "1980399",
    "end": "1987320"
  },
  {
    "text": "we're T neted in so sometimes the only service you have available to you is tnet and that you don't really have a",
    "start": "1987320",
    "end": "1993679"
  },
  {
    "text": "way of getting files onto the system so I wrote a little program called tet FTP which will actually transfer binary",
    "start": "1993679",
    "end": "2000000"
  },
  {
    "text": "files over a tnet session um that's pretty useful so that's not what I",
    "start": "2000000",
    "end": "2005960"
  },
  {
    "text": "wanted okay",
    "start": "2005960",
    "end": "2011080"
  },
  {
    "text": "so this program actually takes is is actually kind of slow so um you don't",
    "start": "2011080",
    "end": "2016279"
  },
  {
    "text": "really want to use it to transfer very large files so what I'm doing is transferring a tftp client and then once",
    "start": "2016279",
    "end": "2021960"
  },
  {
    "text": "we have the tftp client on there we can use it to pull down some some larger files and I think the tftp client",
    "start": "2021960",
    "end": "2028039"
  },
  {
    "text": "compressed that I'm uploading is like 22k and it takes like a little over a minute to upload it so once I get tftp",
    "start": "2028039",
    "end": "2038159"
  },
  {
    "text": "on there then I can go over here to my toet session and uncompress tftp and use",
    "start": "2038159",
    "end": "2044240"
  },
  {
    "text": "it to pull some other files on there and um in a bit I'll show you how that I can",
    "start": "2044240",
    "end": "2051000"
  },
  {
    "text": "put TCP dump on there and I've uh gone ahead and cross-compiled TCB dump for mips little Indian and then we can use",
    "start": "2051000",
    "end": "2057878"
  },
  {
    "text": "TCB dump to start sniffing traffic that is coming through the router which is potentially everyone's traffic you know",
    "start": "2057879",
    "end": "2063839"
  },
  {
    "text": "who who is on the network wait just a little bit for this to finish off and uh all it's doing is",
    "start": "2063839",
    "end": "2070599"
  },
  {
    "text": "basically um calling the echo command on on on the on the remote in and passing in you know hex escaped um a hex escaped",
    "start": "2070599",
    "end": "2078398"
  },
  {
    "text": "representation of the binary file and it just drops it into SLT okay and then I I at the same time I",
    "start": "2078399",
    "end": "2086280"
  },
  {
    "text": "also started up a little tftp server so um let me actually go on to",
    "start": "2086280",
    "end": "2092079"
  },
  {
    "text": "the uh go into the toet session and then use tftp to",
    "start": "2092079",
    "end": "2099200"
  },
  {
    "text": "transfer a file okay and then we've got TCP dump on",
    "start": "2099200",
    "end": "2108119"
  },
  {
    "text": "there so now there you go we're sniffing traffic coming across the",
    "start": "2108119",
    "end": "2113540"
  },
  {
    "text": "[Applause] device okay um I ask you to bear bear",
    "start": "2113540",
    "end": "2121920"
  },
  {
    "text": "with me just a little bit longer while I uh while I switch displays and I just want to finish off a couple slides and",
    "start": "2121920",
    "end": "2129480"
  },
  {
    "text": "then we should have I think plenty of time for some Q&A all",
    "start": "2129480",
    "end": "2135119"
  },
  {
    "text": "right okay so what could have been done so this",
    "start": "2135119",
    "end": "2141119"
  },
  {
    "text": "device would be a little bit less insecure well I would submit that first",
    "start": "2141119",
    "end": "2146480"
  },
  {
    "text": "and foremost like it or not this device isn't just a piece of consumer electronics gear it isn't just a toy it",
    "start": "2146480",
    "end": "2153880"
  },
  {
    "text": "actually plays a critical security role on a users's Network right it's a boundary device it's a it's a firewall",
    "start": "2153880",
    "end": "2160920"
  },
  {
    "text": "um it should have security requirements established for it from the get-go and those requirements should be uh designed",
    "start": "2160920",
    "end": "2166880"
  },
  {
    "text": "for and developed for and tested okay so for example it should be capable of",
    "start": "2166880",
    "end": "2172079"
  },
  {
    "text": "self- protection which it clearly has failed at right it should also be capable of affording you some level of",
    "start": "2172079",
    "end": "2178760"
  },
  {
    "text": "network protection which again it clearly has failed at I can get on the device and start attacking your network",
    "start": "2178760",
    "end": "2184480"
  },
  {
    "text": "um I can actually turn the device against you so um this this isn't just a",
    "start": "2184480",
    "end": "2189839"
  },
  {
    "text": "toy that you use to serve up multimedia it actually should be protecting you it should be protecting your",
    "start": "2189839",
    "end": "2195920"
  },
  {
    "text": "network also I would submit that just better coding practices would go a long",
    "start": "2195920",
    "end": "2201160"
  },
  {
    "text": "way I mean it isn't it isn't 1996 anymore why are we still using unbounded",
    "start": "2201160",
    "end": "2208000"
  },
  {
    "text": "Sprint defs and stir copies can someone please explain that to me um that's a rhetorical question please no and answer",
    "start": "2208000",
    "end": "2214000"
  },
  {
    "text": "but there are functions that help you do the balance checking and SQL light even",
    "start": "2214000",
    "end": "2220160"
  },
  {
    "text": "provides you functions that if you use them properly will help protect you against SQL injection and none of that",
    "start": "2220160",
    "end": "2225880"
  },
  {
    "text": "is being used and they're actually really easy to use so just some better coding practices I think would go along",
    "start": "2225880",
    "end": "2233119"
  },
  {
    "text": "way um some amount of privilege separation uh we have the benefit of of",
    "start": "2233119",
    "end": "2238640"
  },
  {
    "text": "uh working of of of using Linux here right so Linux is capable of um having",
    "start": "2238640",
    "end": "2245359"
  },
  {
    "text": "multiple users and unprivileged users and yet everything on this device is running as user ID zero um there's no",
    "start": "2245359",
    "end": "2252280"
  },
  {
    "text": "reason for the DNA server to be running as user ID zero it isn't doing anything",
    "start": "2252280",
    "end": "2257680"
  },
  {
    "text": "privileged it doesn't even bind to any privileged ports okay so just having maybe multiple users and separating",
    "start": "2257680",
    "end": "2264760"
  },
  {
    "text": "things out that way would also help now a lot of people's experience uh",
    "start": "2264760",
    "end": "2270800"
  },
  {
    "text": "with SE Linux may be the thing that you turn off when you install Fedora on your laptop because you don't want it to",
    "start": "2270800",
    "end": "2276599"
  },
  {
    "text": "break your stuff right um I used to work for a company called tracus and at tracus we had a lot of experiences",
    "start": "2276599",
    "end": "2282920"
  },
  {
    "text": "developing hardened appliances using SE Linux and I can tell you that that Appliance type devices are actually an",
    "start": "2282920",
    "end": "2288560"
  },
  {
    "text": "area where SE Linux does really well because there are very few applications on the system that you need to confine",
    "start": "2288560",
    "end": "2294960"
  },
  {
    "text": "um and you have very little um uh direct user interaction and um and and you don't",
    "start": "2294960",
    "end": "2302640"
  },
  {
    "text": "have users adding and removing applications and creating data like that so uh as Linux actually potentially uh",
    "start": "2302640",
    "end": "2308160"
  },
  {
    "text": "could do really well on this system and in fact if the system H was compiled with Linux and had an enforcing policy",
    "start": "2308160",
    "end": "2313880"
  },
  {
    "text": "it would completely mitigate both of the exploits the application wouldn't be allowed to access sensitive files the",
    "start": "2313880",
    "end": "2319720"
  },
  {
    "text": "application also wouldn't be allowed to execute programs so if you did successfully um exploit a buffer",
    "start": "2319720",
    "end": "2324800"
  },
  {
    "text": "overflow you would have a very limited environment to work with you wouldn't be able to execute bsh for example so it",
    "start": "2324800",
    "end": "2331079"
  },
  {
    "text": "should theoretically be possible at least to develop a single s Linux policy and apply it across the board to all the",
    "start": "2331079",
    "end": "2336800"
  },
  {
    "text": "devices and just add and remove policy modules as you need to confine uh different features all right so what's",
    "start": "2336800",
    "end": "2344040"
  },
  {
    "text": "the upshot here well the developer here in this case has assumed well well-formed data",
    "start": "2344040",
    "end": "2351440"
  },
  {
    "text": "right because only his application ever puts data in in the database so how could anything in the database be bad um",
    "start": "2351440",
    "end": "2358920"
  },
  {
    "text": "well we're able to compromise the database and violate those assumptions and we're able to do that even though",
    "start": "2358920",
    "end": "2365359"
  },
  {
    "text": "nothing in the database is self is particularly valuable all",
    "start": "2365359",
    "end": "2371319"
  },
  {
    "text": "right here's my contact information if anyone after black hat after the talk wants to get in touch with me and has",
    "start": "2371319",
    "end": "2377400"
  },
  {
    "text": "any questions feel free to get in touch with me that way but uh while we're here today I'm also happy to take uh to take",
    "start": "2377400",
    "end": "2385200"
  },
  {
    "text": "any questions right now that you may have yes WP",
    "start": "2385200",
    "end": "2392480"
  },
  {
    "text": "on from this maker you go there Tri or try to P additional firmware from other",
    "start": "2392480",
    "end": "2400560"
  },
  {
    "text": "vendors that may use the same base for the same the same",
    "start": "2400560",
    "end": "2406200"
  },
  {
    "text": "same so so so I so I believe the question is um once we've analyzed this",
    "start": "2408280",
    "end": "2414960"
  },
  {
    "text": "firmware and found these vulnerabilities then do we um go and look at other firmwares from other vendors that may be",
    "start": "2414960",
    "end": "2421359"
  },
  {
    "text": "using the same system on a chip um and and the and the Ser firmware could be based on the same SDK and software stack",
    "start": "2421359",
    "end": "2428040"
  },
  {
    "text": "that is actually something at TNS that we do do quite a bit of and I can tell you there are a number of vendors and",
    "start": "2428040",
    "end": "2434720"
  },
  {
    "text": "Netgear so far isn't among them but there are a number of vendors where when we're analyzing the firmware we actually",
    "start": "2434720",
    "end": "2440520"
  },
  {
    "text": "find strings from multiple vendors in the firmware um so this this this sort",
    "start": "2440520",
    "end": "2446319"
  },
  {
    "text": "of thing happens all the time where you you find some vulnerabilities and those same vulnerabilities are present in",
    "start": "2446319",
    "end": "2451400"
  },
  {
    "text": "other firmwares if you disable you're safe with some of the ex",
    "start": "2451400",
    "end": "2458640"
  },
  {
    "text": "you talk about and can you actually disable that I have encountered so many routers where you just can't no that's",
    "start": "2458640",
    "end": "2466160"
  },
  {
    "text": "that's a very good question so the question is if you turn off DLNA on this router are you protected from these",
    "start": "2466160",
    "end": "2471760"
  },
  {
    "text": "specific exploits and is it even possible to turn off DLNA on this router",
    "start": "2471760",
    "end": "2477079"
  },
  {
    "text": "yes it is uh that's a configuration option you can turn off DLNA um often times in the case uh like like like you",
    "start": "2477079",
    "end": "2484319"
  },
  {
    "text": "pointed out um there are features that you try to turn off and either it just doesn't respect your wishes or there's no option to turn it off so yeah you can",
    "start": "2484319",
    "end": "2491240"
  },
  {
    "text": "turn off DNA in this router and if you do these specific exploits won't work I will tell you that we've got a bag of",
    "start": "2491240",
    "end": "2497359"
  },
  {
    "text": "tricks on this router that I'm not going to share with you today that have nothing to do with DLNA um so there's",
    "start": "2497359",
    "end": "2502960"
  },
  {
    "text": "some other things that you can't protect yourself",
    "start": "2502960",
    "end": "2506400"
  },
  {
    "text": "against that okay that that's that's a good question so the question is is DNA listening on the public interface no it",
    "start": "2510079",
    "end": "2516880"
  },
  {
    "text": "is not um and so the specific exploits that uh that I showed you today in their",
    "start": "2516880",
    "end": "2522119"
  },
  {
    "text": "current state only work on the land interface um I have a couple things to say about that one is if you're familiar",
    "start": "2522119",
    "end": "2527760"
  },
  {
    "text": "with Reaver in WPS which uh uh which TNS also released this device is vulnerable",
    "start": "2527760",
    "end": "2534359"
  },
  {
    "text": "to Reaver so as long as you're on the premisis you can you can exract the WPA key that way and get on the land also",
    "start": "2534359",
    "end": "2541520"
  },
  {
    "text": "Craig briefed a tool uh at blackhead a couple of years ago called rebind and",
    "start": "2541520",
    "end": "2546599"
  },
  {
    "text": "rebind pro is able to proxy HTTP requests through a victim's web browser using JavaScript to the lands side of",
    "start": "2546599",
    "end": "2553520"
  },
  {
    "text": "the router now I haven't yet gotten these exploits to work with Craig's rebind tool mainly because the",
    "start": "2553520",
    "end": "2559079"
  },
  {
    "text": "JavaScript mingles my SQL injection but it is at least in theory possible to make that happen from the internet using",
    "start": "2559079",
    "end": "2565119"
  },
  {
    "text": "rebind so I think there was a question from this direction",
    "start": "2565119",
    "end": "2570680"
  },
  {
    "text": "okay all right uh yes why don't you use tell that enable",
    "start": "2570680",
    "end": "2577400"
  },
  {
    "text": "oh yeah no no that's a good question yeah so the device has actually has its own little back door password it's got",
    "start": "2577400",
    "end": "2582599"
  },
  {
    "text": "tet already running and so why did I go to the trouble of writing up a paper and submitting it to black hat talking about",
    "start": "2582599",
    "end": "2587640"
  },
  {
    "text": "buffer overflows and SQL injection when we can just use T neted able to turn on the past you know to turn on um tnet uh",
    "start": "2587640",
    "end": "2595319"
  },
  {
    "text": "well so there actually a lot of easier ways on this device not just through tnet um the reason I did it this way is",
    "start": "2595319",
    "end": "2601440"
  },
  {
    "text": "because I thought it was actually a pretty interesting talk um there's not a lot out there on myips overflow so I",
    "start": "2601440",
    "end": "2606559"
  },
  {
    "text": "kind of wanted to be able to talk about that and and it was kind of fun to sort of combine the SQL injection and exploited buffer overflow so mainly",
    "start": "2606559",
    "end": "2613359"
  },
  {
    "text": "because I thought the exploits were a lot of fun yeah uh yes over",
    "start": "2613359",
    "end": "2619400"
  },
  {
    "text": "here was response uh no I did not submit these uh uh these vulnerabilities these",
    "start": "2619400",
    "end": "2626280"
  },
  {
    "text": "vulnerabilities to nare and I suspected someone might ask that question so I was prepared ahead of time with our",
    "start": "2626280",
    "end": "2632000"
  },
  {
    "text": "company's official policy and tactical Network Solutions official policy is not to re report vulnerabilities to",
    "start": "2632000",
    "end": "2640960"
  },
  {
    "text": "vendors any other questions have you looked at ways to actually replace the entire firware on",
    "start": "2642079",
    "end": "2650040"
  },
  {
    "text": "on the device so that it performs the function it's supposed to but then in the background gives you all the",
    "start": "2650040",
    "end": "2658200"
  },
  {
    "text": "functionality oh so so okay I I think your question is have I looked at a way",
    "start": "2658319",
    "end": "2664040"
  },
  {
    "text": "to replace the firmware so that it is behaving the same way it always does but I've maybe trojaned the firmware um yeah",
    "start": "2664040",
    "end": "2671119"
  },
  {
    "text": "that that that that actually is a a a a personal project that I have going on not with this router but with some other",
    "start": "2671119",
    "end": "2676640"
  },
  {
    "text": "routers but I mean it's very easy to modify the firmware and then and then repack it and as long as it passes",
    "start": "2676640",
    "end": "2682680"
  },
  {
    "text": "whatever checks some you know the device is looking for like it's not it's not cryptographically signed or anything",
    "start": "2682680",
    "end": "2687839"
  },
  {
    "text": "like that so yes so you could theoretically troen the firmware and and do that mm any other",
    "start": "2687839",
    "end": "2694960"
  },
  {
    "text": "questions well awesome um I tell you what I really",
    "start": "2694960",
    "end": "2701359"
  },
  {
    "text": "appreciate everybody you know coming out to hear my talk and and uh uh you know taking the time to listen to me bble I I",
    "start": "2701359",
    "end": "2707800"
  },
  {
    "text": "hope this was pretty interesting to everyone so thanks a lot for",
    "start": "2707800",
    "end": "2712280"
  },
  {
    "text": "coming",
    "start": "2716359",
    "end": "2719359"
  }
]