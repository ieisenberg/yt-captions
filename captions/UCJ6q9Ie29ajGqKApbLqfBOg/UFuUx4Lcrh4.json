[
  {
    "text": "[Music]",
    "start": "1560",
    "end": "9180"
  },
  {
    "text": "[Music]",
    "start": "18090",
    "end": "42360"
  },
  {
    "text": "for right",
    "start": "57320",
    "end": "61320"
  },
  {
    "text": "hi ow that's loud hello I'm uh David mayor I'm from",
    "start": "64879",
    "end": "71240"
  },
  {
    "text": "Georgia Tech I uh just lost my PowerPoint presentation had to run outside and grab another copy of it if",
    "start": "71240",
    "end": "78479"
  },
  {
    "text": "you think skydiving is fun you should try losing your presentation right before a speech to see what adrenaline feels",
    "start": "78479",
    "end": "85759"
  },
  {
    "text": "like so it's it's that time I suppose sure you",
    "start": "86479",
    "end": "92000"
  },
  {
    "text": "guys don't want to go see another speech something better cooler faster",
    "start": "92000",
    "end": "98840"
  },
  {
    "text": "nope yeah I'm stuck how many uh how many people here",
    "start": "98840",
    "end": "105360"
  },
  {
    "text": "are from Corporate America you know not universities okay how many people are",
    "start": "105360",
    "end": "112280"
  },
  {
    "text": "from like educational institutions how many are from the",
    "start": "112280",
    "end": "118079"
  },
  {
    "text": "government I paid my taxes this year I um we begin in a second I suppose if",
    "start": "118079",
    "end": "128080"
  },
  {
    "text": "uh if I seem a bit lost it's because this is my first uh presentation from a large group of people well this isn't a",
    "start": "128080",
    "end": "134200"
  },
  {
    "text": "particularly large group it's larger than I've ever spoke in front of before my first black hat so if I'm doing something wrong let me know I have no",
    "start": "134200",
    "end": "140480"
  },
  {
    "text": "problems with being corrected um yeah I suppose that's about it we",
    "start": "140480",
    "end": "146640"
  },
  {
    "text": "should begin like I said my name is David mayor I'm from the Georgia Institute of Technology where we uh we",
    "start": "146640",
    "end": "152680"
  },
  {
    "text": "don't believe in firewalls we don't really have that many on campus especially at the border which is a big problem because we seem to get Port",
    "start": "152680",
    "end": "162080"
  },
  {
    "text": "scanned and attacked a lot now I know you're surprised being the university people want to hack us but uh it happens",
    "start": "162080",
    "end": "169800"
  },
  {
    "text": "we uh in L of firewalls we uh we try to build a a very good IDs infrastructure",
    "start": "169800",
    "end": "176000"
  },
  {
    "text": "uh starting at the border which was which was kind of hard at first but we had we we eventually got it working and",
    "start": "176000",
    "end": "182239"
  },
  {
    "text": "the biggest problem we found is that uh on Dual o12s we were aggregating the",
    "start": "182239",
    "end": "187360"
  },
  {
    "text": "data to a single point on the Dual o12s we seem to have a lot of false positives uh",
    "start": "187360",
    "end": "194799"
  },
  {
    "text": "which was a which was a really large problem for us am I is my volume",
    "start": "194799",
    "end": "200280"
  },
  {
    "text": "okay all right this was a very large problem for us we uh we were getting 10",
    "start": "200280",
    "end": "205440"
  },
  {
    "text": "or so million alerts a day um and for a small three person group that's that's",
    "start": "205440",
    "end": "211680"
  },
  {
    "text": "kind of hard to parse and even with some some some built-in uh even with us",
    "start": "211680",
    "end": "216799"
  },
  {
    "text": "building some of our own tools you know modified GPS and whatnot looking for things that seem interesting we still",
    "start": "216799",
    "end": "223000"
  },
  {
    "text": "had a big problem because the amount of data was just so overwhelming",
    "start": "223000",
    "end": "228519"
  },
  {
    "text": "um that that that's what led me to the uh the idea for the talk today a practical event correlation system for",
    "start": "228519",
    "end": "234480"
  },
  {
    "text": "security tools there's lots of vendors that do this but being an educational institute we don't have tons and tons of",
    "start": "234480",
    "end": "239560"
  },
  {
    "text": "money to spend on them so we could either do without or write our own so we uh we we opted for to write our own path",
    "start": "239560",
    "end": "247040"
  },
  {
    "text": "um basically uh what I'm going to talk about today is how you can build your own it's surprisingly simple if you",
    "start": "247040",
    "end": "254599"
  },
  {
    "text": "don't want to go too complex uh the biggest problem I was",
    "start": "254599",
    "end": "259919"
  },
  {
    "text": "trying to address while doing this was the information overload as I mentioned before we we just spent entirely too much time chasing uh you know a single",
    "start": "259919",
    "end": "267120"
  },
  {
    "text": "host that was doing multiple port scans as opposed to missing the one loan Intruder did you have a",
    "start": "267120",
    "end": "274360"
  },
  {
    "text": "question oh okay uh instead of chasing the one loan Intruder that was the uh",
    "start": "274360",
    "end": "280240"
  },
  {
    "text": "that was actually compromising machines we",
    "start": "280240",
    "end": "286080"
  },
  {
    "text": "um the the false poses was were just outrageous being a large campus with two",
    "start": "286080",
    "end": "291199"
  },
  {
    "text": "and a half class BS we could not accurately um look through the data",
    "start": "291199",
    "end": "298440"
  },
  {
    "text": "we would every everybody here with is familiar with IDs technology",
    "start": "298440",
    "end": "303639"
  },
  {
    "text": "correct well we we would see IDs alerts going to machines uh you know every I'm sure everybody's experienced this uh",
    "start": "303639",
    "end": "310080"
  },
  {
    "text": "mssql worms going to Linux machines and it gets alerted to be a critical machine uh a critical alert so we have to spend",
    "start": "310080",
    "end": "316479"
  },
  {
    "text": "time mitigating that only to nm- it and find out that it was only a a Linux machine and they don't run mssql and you",
    "start": "316479",
    "end": "323880"
  },
  {
    "text": "know the reverse was true we would see a lot of the slapper the the slapper worms the SSL chunking coding problem",
    "start": "323880",
    "end": "330360"
  },
  {
    "text": "uh attacking Windows machines and we know they don't run anything secure so we uh we were trying to cut down on that",
    "start": "330360",
    "end": "337000"
  },
  {
    "text": "to to see past basically what the big problems were and get to the individual host that were actually doing things we",
    "start": "337000",
    "end": "343199"
  },
  {
    "text": "deem were bad this uh as I said before we had",
    "start": "343199",
    "end": "348440"
  },
  {
    "text": "several large we'd have large amounts of data we had to go through and this would uh this would mean that we couldn't",
    "start": "348440",
    "end": "355000"
  },
  {
    "text": "really respond to attacks in real time for instance if somebody were doing a sshc C32 exploit against a Solaris",
    "start": "355000",
    "end": "361880"
  },
  {
    "text": "machine that was against a Linux machine that was a database server we uh we couldn't see it and do anything in time",
    "start": "361880",
    "end": "368440"
  },
  {
    "text": "to stop it uh the best we could hope for was an audit Trail so we could later on go back and try to mitigate what what",
    "start": "368440",
    "end": "376440"
  },
  {
    "text": "happened which uh which isn't really acceptable to a lot of security uh a lot",
    "start": "376440",
    "end": "382080"
  },
  {
    "text": "of security practices although blocking in real time would",
    "start": "382080",
    "end": "387479"
  },
  {
    "text": "require basically cting down on a false",
    "start": "387479",
    "end": "391560"
  },
  {
    "text": "um why write it yourself is a is a good question there's lots of vendors that do this I mean there's there's lots of",
    "start": "392800",
    "end": "399000"
  },
  {
    "text": "vendors that do this and I'm not advocating that you you don't use their product or that you you don't spend any",
    "start": "399000",
    "end": "406120"
  },
  {
    "text": "money on it I'm I'm just simply wanting to show you how easy it is to cut to",
    "start": "406120",
    "end": "411919"
  },
  {
    "text": "implement an 8020 solution you know you can catch 80% of the uh of the solution for a a significant return on investment",
    "start": "411919",
    "end": "419039"
  },
  {
    "text": "and then know use something else for the other 20% there's lots of vendors that do this like open arcite guarded net",
    "start": "419039",
    "end": "425360"
  },
  {
    "text": "ecurity net forensic Cisco ISS sem anch micromuse and network intelligence some",
    "start": "425360",
    "end": "431639"
  },
  {
    "text": "of these people are here and they have good Solutions and I'm not suggesting that there's anything wrong with them",
    "start": "431639",
    "end": "437360"
  },
  {
    "text": "just some people don't have the money to uh to buy them but you still need the",
    "start": "437360",
    "end": "442599"
  },
  {
    "text": "technology things to keep in mind when you write or buy a product like this are are things they do for you one of one of",
    "start": "442599",
    "end": "448800"
  },
  {
    "text": "the big things you want want uh with security event correlation is normalization of data basically what a",
    "start": "448800",
    "end": "454520"
  },
  {
    "text": "security event what a what security event correlation is is you have a lot of different security tools uh that that",
    "start": "454520",
    "end": "460360"
  },
  {
    "text": "generate a lot of data which is different than 10 years ago when security individuals didn't have enough",
    "start": "460360",
    "end": "466639"
  },
  {
    "text": "data to efficiently understand what was going on their Network now you've got everything from you know TCP dump which can be used",
    "start": "466639",
    "end": "473400"
  },
  {
    "text": "as an effective security tool to you know th multi uh multi-million dollar Security Solutions from ERS and they all",
    "start": "473400",
    "end": "480759"
  },
  {
    "text": "have one thing in common is they generate a lot of data uh checkpoint firewalls pix firewalls IP tables even",
    "start": "480759",
    "end": "487560"
  },
  {
    "text": "nesus nmap all these all these tools you'll use will generate a lot of data now some of this data is you can't use I",
    "start": "487560",
    "end": "496319"
  },
  {
    "text": "it's U it's throwaway data for instance um in my solution I I don't really deal",
    "start": "496319",
    "end": "503759"
  },
  {
    "text": "with filtered ports that well from an map scan so all that stuff's discarded the um",
    "start": "503759",
    "end": "510599"
  },
  {
    "text": "the biggest thing is that you make all these tools work together in an efficient way that will allow you to uh",
    "start": "510599",
    "end": "517518"
  },
  {
    "text": "use information efficiently sorry I'm a little bit nervous uh the biggest thing you want is",
    "start": "517519",
    "end": "522800"
  },
  {
    "text": "normalization of data you have all these security tools for instance an intrusion detection system a port scanner a vulnerability scanner a passive",
    "start": "522800",
    "end": "528519"
  },
  {
    "text": "fingerprint detection tool and perhaps a host based or a network-based firewall",
    "start": "528519",
    "end": "533640"
  },
  {
    "text": "you want all the information to work together or give you basically one view of it now now in order to do this you",
    "start": "533640",
    "end": "540600"
  },
  {
    "text": "generally have to either write something to takes the output of the Tool uh like",
    "start": "540600",
    "end": "545760"
  },
  {
    "text": "a like a sensor on the machine that's running on and normalize the data so the correlation as you can understand or you",
    "start": "545760",
    "end": "551440"
  },
  {
    "text": "have to uh you have to have a something like a Cy log server set up where all your different tools locked to the syis",
    "start": "551440",
    "end": "556600"
  },
  {
    "text": "log server and the correlation takes it from the correlation engine takes it from there but the big point is before the correlation engine actually gets the",
    "start": "556600",
    "end": "562880"
  },
  {
    "text": "data it should be a normalized format uh for two very important reasons this makes you understand your data much",
    "start": "562880",
    "end": "568800"
  },
  {
    "text": "easier and this makes extending the correlation engine a lot easier because the engine I'm going to show uh the the",
    "start": "568800",
    "end": "575279"
  },
  {
    "text": "the theory behind the engine I'm going to show today is a very simple engine but it can be extended very well so you",
    "start": "575279",
    "end": "581360"
  },
  {
    "text": "want to deal with uh normalization of data you you want uh you want your data normal format uh so you can go to a",
    "start": "581360",
    "end": "587800"
  },
  {
    "text": "single point you pull out information from your IDs and your vulnerability scanner and a single XML document for",
    "start": "587800",
    "end": "593600"
  },
  {
    "text": "instance that that's always good thing aggregation uh you want to see if the aggregation is effective a lot of people",
    "start": "593600",
    "end": "601160"
  },
  {
    "text": "buy security uh uh correlation systems and they'll have a problem where they'll have one aggregation point which all the",
    "start": "601160",
    "end": "608040"
  },
  {
    "text": "security tools send their information to but they have an overwhelming large amount of tools for instance 30,000 host",
    "start": "608040",
    "end": "615320"
  },
  {
    "text": "sensors and uh it's all being reported to one machine what you basically have at that point is a built-in denial of",
    "start": "615320",
    "end": "621560"
  },
  {
    "text": "service attack you're going to knock your agregation machine right off the line and if you can't get the data this system solution is no good to you so you",
    "start": "621560",
    "end": "628120"
  },
  {
    "text": "got to make sure that the aggregation Point scales well you've got to make sure that um one of the biggest benefits",
    "start": "628120",
    "end": "635160"
  },
  {
    "text": "this is going to buy you is reduction of data which is the entire point of this you want less data so it's easier for",
    "start": "635160",
    "end": "640959"
  },
  {
    "text": "you to parse understand and respond to you want to make sure that your aggregation uh your aggregation point is",
    "start": "640959",
    "end": "647120"
  },
  {
    "text": "reducing data as it goes to the correlation engine and the the biggest thing and a",
    "start": "647120",
    "end": "652360"
  },
  {
    "text": "lot of people uh have have have experienced this is you have to change",
    "start": "652360",
    "end": "657560"
  },
  {
    "text": "your network or the way your business does business to accommodate a security",
    "start": "657560",
    "end": "663399"
  },
  {
    "text": "product and that that's not a good thing a security product should efficiently integrate into your network the way it",
    "start": "663399",
    "end": "670160"
  },
  {
    "text": "is it should complement not cause changes now of course if you have a totally insecure Network putting it behind a firewall does change things",
    "start": "670160",
    "end": "677320"
  },
  {
    "text": "dramatically but you don't want to have to do strange things like have to build a a your own ver your own separate",
    "start": "677320",
    "end": "683720"
  },
  {
    "text": "Network just for the uh aggregation of data that's that that's not giving you a good return on investment you're not",
    "start": "683720",
    "end": "689519"
  },
  {
    "text": "spending your time actually fixing problems if you're spending a ton of time just building an infrastructure for",
    "start": "689519",
    "end": "694880"
  },
  {
    "text": "what's going to fix your problems you want to you want to look at your correlation engine now this is a",
    "start": "694880",
    "end": "701000"
  },
  {
    "text": "big point this seems kind of like a no-brainer it's a no-brainer to me um",
    "start": "701000",
    "end": "706560"
  },
  {
    "text": "but you want to make sure your correlation engine works and by works that means can you uh can you reduce the",
    "start": "706560",
    "end": "713560"
  },
  {
    "text": "amount of attacks you're seeing against uh Linux H for instance uh are",
    "start": "713560",
    "end": "719279"
  },
  {
    "text": "are you cting the number of false positives you're seeing is it is is it is it being beneficial to you are you spending less time going through the",
    "start": "719279",
    "end": "725760"
  },
  {
    "text": "drudgery of network forensics and more time actually responding to things uh you want to see how extensible it is a",
    "start": "725760",
    "end": "731240"
  },
  {
    "text": "lot of people I I I've never been to a company or or an organization in my entire life that has all commercially",
    "start": "731240",
    "end": "737199"
  },
  {
    "text": "bought apps a lot of a lot of people's applications are grown in-house and you want to make sure that you can extend",
    "start": "737199",
    "end": "743480"
  },
  {
    "text": "whatever you buy or build to include uh that technology for instance",
    "start": "743480",
    "end": "749800"
  },
  {
    "text": "if a uh if a university were to write their own backup software but the backup software has a buffer overflow you want",
    "start": "749800",
    "end": "755639"
  },
  {
    "text": "to make sure that the uh the correlation the correlation engine can understand that when it sees a packet of this type",
    "start": "755639",
    "end": "761839"
  },
  {
    "text": "going to this host then more than likely that's a bad uh that's a bad that's an",
    "start": "761839",
    "end": "767760"
  },
  {
    "text": "attack um a lot of a one of the downfalls of most commercial products",
    "start": "767760",
    "end": "773480"
  },
  {
    "text": "are they are not that extensible in addition to this you want to see what technology you're using",
    "start": "773480",
    "end": "779760"
  },
  {
    "text": "um by technology I mean how are you coming uh how are you coming about your correlation are you just doing large data mining sets are you just doing",
    "start": "779760",
    "end": "786760"
  },
  {
    "text": "staring Compares on different packets to previously stored vulnerability scans uh that that makes a that makes a big",
    "start": "786760",
    "end": "793399"
  },
  {
    "text": "difference when you look at the scaling aspect of this correlation engine and how efficient it would",
    "start": "793399",
    "end": "799040"
  },
  {
    "text": "be and I've already mentioned the inh house developed apps visualization this is this is one of the most key points of",
    "start": "799040",
    "end": "806120"
  },
  {
    "text": "of a correlation engine or a solution such as this people Overlook it will it be able to effectively show you how to",
    "start": "806120",
    "end": "814040"
  },
  {
    "text": "better protect your network if uh if it if it can do all you know if it's doing the best correlation",
    "start": "814040",
    "end": "820839"
  },
  {
    "text": "in the world but it can effectively communicate that to the user it it's not it's not doing good can uh also in",
    "start": "820839",
    "end": "828399"
  },
  {
    "text": "addition to this one one of the biggest uh a big downfall is that you can't look",
    "start": "828399",
    "end": "833440"
  },
  {
    "text": "at the raw output of your security tools meaning that you can't look at the packet contents of your IDs",
    "start": "833440",
    "end": "839560"
  },
  {
    "text": "you just have to trust in the uh the correlation engine telling you that it's a bad it's a bad",
    "start": "839560",
    "end": "845040"
  },
  {
    "text": "thing uh also one of the things uh that a lot of people like is a single click response for instance if a if an",
    "start": "845040",
    "end": "852240"
  },
  {
    "text": "infected host inside your network is peing um bad packets everywhere you can",
    "start": "852240",
    "end": "858120"
  },
  {
    "text": "click a button on your guey and disable the disable the port that would uh that's always nice uh reporting uh is a",
    "start": "858120",
    "end": "866199"
  },
  {
    "text": "very important thing especially for trending you can use your trending reports to determine what kind of",
    "start": "866199",
    "end": "872399"
  },
  {
    "text": "network attack you're seeing how you're seeing it and uh how best to solve it this is good for uh for you know next",
    "start": "872399",
    "end": "879279"
  },
  {
    "text": "year when you're buying new security products you know what to focus on also uh what type of reporting",
    "start": "879279",
    "end": "885320"
  },
  {
    "text": "mechanisms are supported will your correlation tool report to a third party or will it uh or is it a completely",
    "start": "885320",
    "end": "892800"
  },
  {
    "text": "inhouse solution is a proprietary solution for instance can you have your correlation engine s SNMP traps HP open",
    "start": "892800",
    "end": "898800"
  },
  {
    "text": "View would would be a good thing to look at does it have a built-in alert capabilities where it can page your",
    "start": "898800",
    "end": "904279"
  },
  {
    "text": "system administrator if there's a problem uh can it create a trouble ticket things like that uh",
    "start": "904279",
    "end": "909440"
  },
  {
    "text": "interoperability uh is a is one of the most important parts of this because if you can't take all the",
    "start": "909440",
    "end": "915839"
  },
  {
    "text": "security tools you're using and make them work together this isn't a very good solution in very few places buy all",
    "start": "915839",
    "end": "921199"
  },
  {
    "text": "their security products from one vendor somebody might buy their vulnerability scanner from ISS their their intrusion",
    "start": "921199",
    "end": "926880"
  },
  {
    "text": "detection system from intereses and and trip wire for host change detection and",
    "start": "926880",
    "end": "931959"
  },
  {
    "text": "with a lot of single vendor solutions they don't really work that well with things that that company doesn't make so",
    "start": "931959",
    "end": "937839"
  },
  {
    "text": "you want to keep this in mind you want to keep in mind also when you're designing your correlation engine one of the biggest aspects I",
    "start": "937839",
    "end": "944440"
  },
  {
    "text": "mentioned this earlier is Price It's these things are expensive it takes a lot of intelligence to do this and it's",
    "start": "944440",
    "end": "950399"
  },
  {
    "text": "not cheap there's several approaches you can take to building your own uh your own",
    "start": "950399",
    "end": "955480"
  },
  {
    "text": "correlation engine you can do a large technical approach or small simple",
    "start": "955480",
    "end": "960639"
  },
  {
    "text": "approach we're going to discuss both of those the the large approach is generally things that will correlate",
    "start": "960639",
    "end": "965959"
  },
  {
    "text": "several different Technologies firewalls IDs vulnerability scanner even W temp logs from Linux machines and Dr Watson",
    "start": "965959",
    "end": "973759"
  },
  {
    "text": "logs from uh from Windows machines uh you you you you want to you want to",
    "start": "973759",
    "end": "978839"
  },
  {
    "text": "incorporate as many Technologies as possible for a the most complete view of your network you want an advanced",
    "start": "978839",
    "end": "984079"
  },
  {
    "text": "correlation engine you want it to be able to deal with abstract information meaning that that it saw a port scan on",
    "start": "984079",
    "end": "991639"
  },
  {
    "text": "it saw a port scan to this machine uh 3 weeks ago and today it saw a tet session to Port 22 from off your site and",
    "start": "991639",
    "end": "999800"
  },
  {
    "text": "tomorrow it saw one packet sent to it a an abstract correlation engine should be",
    "start": "999800",
    "end": "1004920"
  },
  {
    "text": "able to take all that information and say I don't know if an attacks going on but there's definitely worth something",
    "start": "1004920",
    "end": "1010079"
  },
  {
    "text": "looking at there you need you need data mining capabilties for what I just mentioned you need to be able to look at your trends for the last month last 6",
    "start": "1010079",
    "end": "1016600"
  },
  {
    "text": "months last year because unless you're unless you're only concerned about stopping script kitties or automated",
    "start": "1016600",
    "end": "1022839"
  },
  {
    "text": "attacks a general attacker will be a will take their time and be methodical",
    "start": "1022839",
    "end": "1028038"
  },
  {
    "text": "about their attack meaning it's not going to be quickly it's not something you're going to see quickly you're going to take time to Recon their target",
    "start": "1028039",
    "end": "1034360"
  },
  {
    "text": "they're going to take time to prep it and then that should compromise and with things with the Advent of Technology",
    "start": "1034360",
    "end": "1040160"
  },
  {
    "text": "like covert Channel Communications it's making this kind of correlation harder and",
    "start": "1040160",
    "end": "1046679"
  },
  {
    "text": "harder it should be able to keep IND it should be able to keep in-depth heal information now one of the one of the",
    "start": "1046760",
    "end": "1052400"
  },
  {
    "text": "biggest problems with this type of correlation is the size that U the size",
    "start": "1052400",
    "end": "1057440"
  },
  {
    "text": "of data of what you're storing it's going to get pretty big most people want to use something like a sand for this",
    "start": "1057440",
    "end": "1062600"
  },
  {
    "text": "but you you want to keep in-depth hope information you want to keep uh the operating system type you want to keep what ports are open what services are",
    "start": "1062600",
    "end": "1068559"
  },
  {
    "text": "running uh you want to keep a list of who it's it's talking to who it has talked to uh this helps uh one one of",
    "start": "1068559",
    "end": "1076280"
  },
  {
    "text": "the biggest things we would do by hand is notice if if a machine was compromised uh we could take the the",
    "start": "1076280",
    "end": "1082320"
  },
  {
    "text": "compromising host and we could find all the other machines that it talked to and then take those uh those machines and do",
    "start": "1082320",
    "end": "1089000"
  },
  {
    "text": "an audit on them and more than likely we found it's not one single compromise it's been a string of compromises which",
    "start": "1089000",
    "end": "1094679"
  },
  {
    "text": "is one of the things you'd want in advanced correlation is to be able to do and as I said before to be able to DET take complex",
    "start": "1094679",
    "end": "1101080"
  },
  {
    "text": "attacks uh the small approach is what we're going to use it uses fewer Technologies U my engine only uses U",
    "start": "1101080",
    "end": "1107360"
  },
  {
    "text": "vulnerability scanning intrusion detection and host space changes uh I do",
    "start": "1107360",
    "end": "1113880"
  },
  {
    "text": "I'll discuss that later but it it's it's a very practical approach you when you're doing this you want to start off",
    "start": "1113880",
    "end": "1119240"
  },
  {
    "text": "with something small you don't want to put something you don't want to have a goal that's too far outside of your",
    "start": "1119240",
    "end": "1124760"
  },
  {
    "text": "reach you want to make sure it's attainable you want a very basic engine you keep very basic coost information",
    "start": "1124760",
    "end": "1130400"
  },
  {
    "text": "keep this for trending purposes like what ports are open uh an operating",
    "start": "1130400",
    "end": "1135480"
  },
  {
    "text": "system type both active and passive you want to do very basic correlation for instance snort season alert and um based",
    "start": "1135480",
    "end": "1144120"
  },
  {
    "text": "on the alert uh it can reference the host information tell you if that attack is going to be successful or not it's",
    "start": "1144120",
    "end": "1150799"
  },
  {
    "text": "useful for only very basic tasks in this uh in this realm but it will cut down on um the mass of false positives you want",
    "start": "1150799",
    "end": "1158039"
  },
  {
    "text": "to retain very little information for data mining and trending because generally the design of a tool",
    "start": "1158039",
    "end": "1164240"
  },
  {
    "text": "like this isn't going to be optimized for large large data mins although you want to main enough to understand that a",
    "start": "1164240",
    "end": "1170880"
  },
  {
    "text": "month ago that Port 31337 was open on this machine so you want to keep it's a",
    "start": "1170880",
    "end": "1176000"
  },
  {
    "text": "tradeoff between size and space you want a very specific scope you uh you do not",
    "start": "1176000",
    "end": "1182600"
  },
  {
    "text": "want to start with a with a scope that says I want to build a correlation engine that works with everything and",
    "start": "1182600",
    "end": "1188799"
  },
  {
    "text": "correlates all types of attacks it it it never happen you have to start with a very basic scope and the scope the scope",
    "start": "1188799",
    "end": "1194640"
  },
  {
    "text": "that I started with was I want my IDs my vulnerability detection of my vulnerability scanners to to to share",
    "start": "1194640",
    "end": "1201799"
  },
  {
    "text": "information and cut down the number of false positives we're seeing what moving on to reasons why",
    "start": "1201799",
    "end": "1210320"
  },
  {
    "text": "this is uh good to do customization of your environment uh nobody really does",
    "start": "1210320",
    "end": "1215400"
  },
  {
    "text": "know your environment better than you it's hard for a security consultant to come in take a network diagram and",
    "start": "1215400",
    "end": "1221559"
  },
  {
    "text": "understand the flow and build a good correlation solution for you in the two weeks or month they're that they're",
    "start": "1221559",
    "end": "1226960"
  },
  {
    "text": "spending on your site um this is mostly because there there really are no two networks that are the same i' I I've",
    "start": "1226960",
    "end": "1232760"
  },
  {
    "text": "done a lot of Consulting in my life and I've never seen two networks set up the same way so if you start with an",
    "start": "1232760",
    "end": "1239280"
  },
  {
    "text": "in-depth knowledge of your network you're already a step ahead of people who are riding who are building these correlation",
    "start": "1239280",
    "end": "1245320"
  },
  {
    "text": "engines we we we we briefly discussed it but the uh the in-house applications and procedures are are very important for",
    "start": "1245320",
    "end": "1251640"
  },
  {
    "text": "instance your take backup system any Financial applications your company may have written there's several companies",
    "start": "1251640",
    "end": "1257080"
  },
  {
    "text": "who write as we said several in-house applications you want your correlation engine to take advantage of these you",
    "start": "1257080",
    "end": "1263159"
  },
  {
    "text": "want it to watch these because these services are just as vulnerable to anything else being attacked and you",
    "start": "1263159",
    "end": "1268840"
  },
  {
    "text": "don't want to leave them out in the cold these systems should augment your infrastructure not cause you to rebuild",
    "start": "1268840",
    "end": "1274640"
  },
  {
    "text": "it from scratch we talked about this I I mentioned this once again before briefly",
    "start": "1274640",
    "end": "1279760"
  },
  {
    "text": "you don't want to have to rebuild your network based on uh based on a security tool working correctly it should augment",
    "start": "1279760",
    "end": "1286919"
  },
  {
    "text": "and work with what you have am I boring everybody no I'm just wondering say",
    "start": "1286919",
    "end": "1293840"
  },
  {
    "text": "again stand stand oh I I'm sorry I can't do that I if I stand still I'm like a fish",
    "start": "1293840",
    "end": "1300960"
  },
  {
    "text": "I'll sink and that's no good so you you really want to uh you you really I I let",
    "start": "1300960",
    "end": "1309120"
  },
  {
    "text": "me start from let me start when I approached this problem I had an in-depth knowledge of the network I was",
    "start": "1309120",
    "end": "1314360"
  },
  {
    "text": "working with I knew that I couldn't get the network admins to change the way the network was working and I also knew all",
    "start": "1314360",
    "end": "1321600"
  },
  {
    "text": "the in-house software that was written in policies and procedures so I had a large advantage over most other people would do this and this is one of the",
    "start": "1321600",
    "end": "1328080"
  },
  {
    "text": "best reasons to do it yourself before we get started we talked about your scope you got to have clear",
    "start": "1328080",
    "end": "1333200"
  },
  {
    "text": "goals we're building a small correlation engine we're only using five tools nmap nessus trip wire snort and p0f is",
    "start": "1333200",
    "end": "1339880"
  },
  {
    "text": "everybody familiar with p0f it's a passive fingerprinting tool you run it on a box in promiscuous mode",
    "start": "1339880",
    "end": "1347840"
  },
  {
    "text": "and it can give you you a a semi accurate guess of what a machine is simply by the the the the type of",
    "start": "1347840",
    "end": "1354760"
  },
  {
    "text": "traffic it sees this is important because more and more personal firewalls and and things of this type are becoming",
    "start": "1354760",
    "end": "1361320"
  },
  {
    "text": "more and more prevalent meaning that an map scan isn't going to be able to accurately detect what the operating system is um",
    "start": "1361320",
    "end": "1370159"
  },
  {
    "text": "or even attempt at all uh for instance and oh sorry about that in my group we",
    "start": "1370159",
    "end": "1377679"
  },
  {
    "text": "uh we are a part of a campus we're not",
    "start": "1377679",
    "end": "1383400"
  },
  {
    "text": "trusted by anybody and no part of the campus trusts each other so most most people with personal firewalls and PCs",
    "start": "1383400",
    "end": "1389320"
  },
  {
    "text": "and whatnot block everything that they they don't explicitly allow so I can't even port scan a machine and uh that may",
    "start": "1389320",
    "end": "1397520"
  },
  {
    "text": "be in another department this is a problem with correlation because you need to know at least what operating systems it's running and manually you",
    "start": "1397520",
    "end": "1404120"
  },
  {
    "text": "can do this really easily by Banner checking if it's a web server or things like that",
    "start": "1404120",
    "end": "1409760"
  },
  {
    "text": "but you when you're automating this it's a bit harder your D your data",
    "start": "1409760",
    "end": "1415600"
  },
  {
    "text": "normalization is uh is something to keep in mind you got to make sure your data is created in a simple easy to",
    "start": "1415600",
    "end": "1421880"
  },
  {
    "text": "understand format all my examples are going to be text strings they fi separated by the pipe character very",
    "start": "1421880",
    "end": "1428320"
  },
  {
    "text": "easy to understand very easy to process now realistically when you're building this you",
    "start": "1428320",
    "end": "1434159"
  },
  {
    "text": "wouldn't do you have a question no real realistically when when you're building this you wouldn't want to do that you",
    "start": "1434159",
    "end": "1439799"
  },
  {
    "text": "want to use a binary format or something to save space and time uh you want to make sure that the output generated by",
    "start": "1439799",
    "end": "1446400"
  },
  {
    "text": "your sensors are going to be the same language basically which makes it easier",
    "start": "1446400",
    "end": "1452080"
  },
  {
    "text": "to write the correlation engine for we're going to go with an agent based approach which basically means",
    "start": "1452080",
    "end": "1457840"
  },
  {
    "text": "we're going to write some Python scripts or we have some Python scripts that sit on these hosts that run these tools and",
    "start": "1457840",
    "end": "1463200"
  },
  {
    "text": "they're going to um they're going to actually take the information out of the tool they're going to normalize it send it to our aggregation Point uh this this",
    "start": "1463200",
    "end": "1470399"
  },
  {
    "text": "cuts down this cuts down somewhat on some of the technical problems of data normalization however it adds a level of",
    "start": "1470399",
    "end": "1475919"
  },
  {
    "text": "complexity that you have agents to maintain the agents uh the agents",
    "start": "1475919",
    "end": "1483200"
  },
  {
    "text": "primarily should be gathering information and as much as possible reducing it because you want as little",
    "start": "1483200",
    "end": "1489159"
  },
  {
    "text": "as little as possible s your aggregation point which again will reduce the data we're going to make a multi-tier system",
    "start": "1489159",
    "end": "1494840"
  },
  {
    "text": "uh everybody familiar with three tier two-tier client server these types we we",
    "start": "1494840",
    "end": "1499919"
  },
  {
    "text": "want a system that's going to be redundant the security system won't be any good to us if it uh if it's down if",
    "start": "1499919",
    "end": "1505240"
  },
  {
    "text": "it's broken uh it also makes the system more flexible and extensible that's one of the big goals we have here is uh is",
    "start": "1505240",
    "end": "1511679"
  },
  {
    "text": "extending uh extending our um our system we network lency is going to be a",
    "start": "1511679",
    "end": "1519600"
  },
  {
    "text": "big deal and I I actually forgot to put it on the slide but you should definitely have a network time server",
    "start": "1519600",
    "end": "1525600"
  },
  {
    "text": "you should have all your machines that are doing this synced but timing for this is very important you should want real-time",
    "start": "1525600",
    "end": "1532159"
  },
  {
    "text": "capabilities meaning that it can alert people in real time when when an attack is happening this means that when uh",
    "start": "1532159",
    "end": "1538200"
  },
  {
    "text": "when you see that hacker doing the SSH attack it can inform you and you can actively stop it uh this is one of our",
    "start": "1538200",
    "end": "1546600"
  },
  {
    "text": "this is one of the hardest things to do but it's it's necessary for a system like this to succeed you want to you",
    "start": "1546600",
    "end": "1552360"
  },
  {
    "text": "want a configurable alerting system meaning that if it's a mssql Slammer worm hitting a l box you don't ignore it",
    "start": "1552360",
    "end": "1560200"
  },
  {
    "text": "because it's good to know that there's somebody out there that there's a host out there that's doing this but you also don't want it to be a critical alert so",
    "start": "1560200",
    "end": "1566559"
  },
  {
    "text": "you want to be able to build in flexibility of reporting so that when you get an i attack against a Windows machine it's a little bit more critical",
    "start": "1566559",
    "end": "1573240"
  },
  {
    "text": "than a uh than a Slammer attack against a Windows machine uh slapper attack I mean so we're going to go back to our",
    "start": "1573240",
    "end": "1579240"
  },
  {
    "text": "scope the tools we're going to work with I wrote this presentation based only on open source tools uh we have it running",
    "start": "1579240",
    "end": "1586520"
  },
  {
    "text": "with several closed Source tool tools uh such as lanop and ISS and anasis but for",
    "start": "1586520",
    "end": "1592559"
  },
  {
    "text": "this speech only we're going with uh closed Source I mean open source excuse me um and we want to go with to",
    "start": "1592559",
    "end": "1599159"
  },
  {
    "text": "high-tech versus low Tech we discussed this briefly complex methods of data mining we're we're going to avoid that",
    "start": "1599159",
    "end": "1604919"
  },
  {
    "text": "we want a good attack recognition of the Hightech method has a good attack recognition system uh the low Tech we",
    "start": "1604919",
    "end": "1611080"
  },
  {
    "text": "just want basically a simple event-driven model we want a very simple attack recognition system we basically",
    "start": "1611080",
    "end": "1616600"
  },
  {
    "text": "what we're trying to do is make sure that a alert seen by snort will alert us only if it's going to be uh a successful",
    "start": "1616600",
    "end": "1623440"
  },
  {
    "text": "attack we don't really care at this point if it's if it fails because that's good for",
    "start": "1623440",
    "end": "1628720"
  },
  {
    "text": "us an engine like this won't work with complex attacks so things like a man- in-the-middle attack",
    "start": "1628720",
    "end": "1635520"
  },
  {
    "text": "or a sequence number base attack this won't work with that that well which is a was a serious",
    "start": "1635520",
    "end": "1641640"
  },
  {
    "text": "problem we um we are we are wholly a datab based",
    "start": "1641640",
    "end": "1648559"
  },
  {
    "text": "tool which means we we can only work with data we we work with data we're given and we have to",
    "start": "1648559",
    "end": "1655919"
  },
  {
    "text": "collect and store the data I got to tell you I'm really nervous I'm sorry I'm sounding like a blabbering idiot",
    "start": "1655919",
    "end": "1662720"
  },
  {
    "text": "um what do we need to accomplish our task we need host information this is the biggest part we need information on",
    "start": "1662720",
    "end": "1668080"
  },
  {
    "text": "all the machines you want protected uh good things to start with and this isn't a hard and fast rule but good things to start with are your host name your IP",
    "start": "1668080",
    "end": "1674480"
  },
  {
    "text": "address your active and passive OS fingerprints your date your host was first found uh found the day of host was",
    "start": "1674480",
    "end": "1680880"
  },
  {
    "text": "first found the last time that you updated this host record your open port your list of current vulnerabilities",
    "start": "1680880",
    "end": "1686399"
  },
  {
    "text": "we're going get into how we do that later and list of last IPS that connected to that host and this is also for data mining per uh light data mining",
    "start": "1686399",
    "end": "1694200"
  },
  {
    "text": "purposes um security alerts if any which means currently that a host is attacking",
    "start": "1694200",
    "end": "1701600"
  },
  {
    "text": "uh an outside host is attacking this host what it Threat Level is and that's something that that we created to identify the risk that a a target has",
    "start": "1701600",
    "end": "1709200"
  },
  {
    "text": "and a a unique host identifier and we do this to make uh referencing this host much easier now what I did is I uh this",
    "start": "1709200",
    "end": "1717080"
  },
  {
    "text": "engine is written mostly in C uh and it's going to be released open source if if anybody wants it uh but what what I",
    "start": "1717080",
    "end": "1723919"
  },
  {
    "text": "mainly do is uh this is just a structure um every time I find a new host I Mal",
    "start": "1723919",
    "end": "1729240"
  },
  {
    "text": "the memory for it uh and it gets pushed onto a singly link list",
    "start": "1729240",
    "end": "1735279"
  },
  {
    "text": "um and every so often I have a process that goes an a to singly link list for information it doesn't have like its",
    "start": "1735279",
    "end": "1742720"
  },
  {
    "text": "host name it might have a host name but not an IP address it might have a passive fingerprint but not an active",
    "start": "1742720",
    "end": "1747799"
  },
  {
    "text": "fingerprint it might not have a list of open ports we're going to get into what it does for that information later but",
    "start": "1747799",
    "end": "1753200"
  },
  {
    "text": "you want a continuity of information because this is basically the heart of the system you need this information to make everything",
    "start": "1753200",
    "end": "1759840"
  },
  {
    "text": "work we're going to go talk about vulnerability scans everybody's run nessus retina ISS things like that this",
    "start": "1759840",
    "end": "1766039"
  },
  {
    "text": "is this is basically how we're doing our correlation we need upto-date scans you need to scan often and you need to scan",
    "start": "1766039",
    "end": "1772399"
  },
  {
    "text": "deeply uh without these the uh the correlation is just not going to work well you want to do it often",
    "start": "1772399",
    "end": "1779080"
  },
  {
    "text": "because everybody knows networks change uh time will skew your results for",
    "start": "1779080",
    "end": "1784840"
  },
  {
    "text": "instance uh if you do your your n updates on time uh and you do a scan uh",
    "start": "1784840",
    "end": "1790000"
  },
  {
    "text": "today for instance of a host and next week a vulner a vulnerability could be released on Monday and next Thursday you",
    "start": "1790000",
    "end": "1797880"
  },
  {
    "text": "uh your correlation system will still think if you haven't if you haven't updated it that this host is is not",
    "start": "1797880",
    "end": "1802960"
  },
  {
    "text": "vulnerable to anything which which is not good you want you want uh you want",
    "start": "1802960",
    "end": "1808080"
  },
  {
    "text": "an intrusion detection system this is key uh I use snort uh most any",
    "start": "1808080",
    "end": "1814000"
  },
  {
    "text": "commercial tool will work uh but you basically have to have something generates in in real time we use a",
    "start": "1814000",
    "end": "1819960"
  },
  {
    "text": "sniffy method although inline inline ipss inline prevention systems are getting more and more popular but all",
    "start": "1819960",
    "end": "1827240"
  },
  {
    "text": "you basically need is something to generate alerts",
    "start": "1827240",
    "end": "1831320"
  },
  {
    "text": "yes",
    "start": "1835200",
    "end": "1838200"
  },
  {
    "text": "yes well being that my network is oh I'm sorry uh he was asking why I",
    "start": "1842480",
    "end": "1849159"
  },
  {
    "text": "have both active and passive fingerprinting and why since it's my network don't I rely on what the truth",
    "start": "1849159",
    "end": "1855559"
  },
  {
    "text": "is and this is a problem with my network we have 2 and a half class bees they are carved up in between different schools",
    "start": "1855559",
    "end": "1862320"
  },
  {
    "text": "uh different schools in different departments if we were to if we were to try to maintain a entral list of that it",
    "start": "1862320",
    "end": "1868480"
  },
  {
    "text": "would fail uh because a lot of a lot of the problems are initially DHCP uh this",
    "start": "1868480",
    "end": "1874360"
  },
  {
    "text": "that would that would break also you have an admin that that decides that this Windows box is broken and he needs",
    "start": "1874360",
    "end": "1880320"
  },
  {
    "text": "to reinstall it he's going to put Linux on it and not inform you for 3 weeks in that 3 week span that machine is",
    "start": "1880320",
    "end": "1885399"
  },
  {
    "text": "vulnerable to Linux attacks while your correlation engine only thinks it's vulnerable to Windows attacks so this is",
    "start": "1885399",
    "end": "1890799"
  },
  {
    "text": "the trust but verified method you can do that in fact we we do do that we have a central list but we don't rely on a",
    "start": "1890799",
    "end": "1897399"
  },
  {
    "text": "central list only we rely on information we can find because not everything's always kept up to",
    "start": "1897399",
    "end": "1905000"
  },
  {
    "text": "date you what oh",
    "start": "1906039",
    "end": "1910600"
  },
  {
    "text": "yeah well he he's asking why I have two fields for both active and passive uh we",
    "start": "1913919",
    "end": "1921240"
  },
  {
    "text": "we're seeing more and more host space firewalls and whatnot where a active fingerprint becomes harder to get but",
    "start": "1921240",
    "end": "1927279"
  },
  {
    "text": "it's better to have a fingerprint of some kind than a fingerprint not at all does that make",
    "start": "1927279",
    "end": "1932519"
  },
  {
    "text": "sense because the the system gathers data from our from our campus border so if you go out to the internet you have",
    "start": "1932519",
    "end": "1938519"
  },
  {
    "text": "to go buy it so passively I can pull all the packets I want and analyze it without actively scanning things um",
    "start": "1938519",
    "end": "1948000"
  },
  {
    "text": "generally I try you want both but generally uh you've got to have at least",
    "start": "1948000",
    "end": "1954799"
  },
  {
    "text": "one because it's you're dead in water basically without them because the",
    "start": "1954799",
    "end": "1960080"
  },
  {
    "text": "correlation engine works on the principle of it knows what operating systems are and what services it's running what",
    "start": "1960080",
    "end": "1965679"
  },
  {
    "text": "vulnerable what vulnerabilities it has without that it it doesn't work at all and it's better to have a guess than nothing at all did that answer your",
    "start": "1965679",
    "end": "1974639"
  },
  {
    "text": "question how long should we store data we we store data for a six-month period we store all the data we can now there's",
    "start": "1974639",
    "end": "1980919"
  },
  {
    "text": "there's there's size constraints there which are mostly Hardware 6 months of data uh 6 months of data of this type",
    "start": "1980919",
    "end": "1986480"
  },
  {
    "text": "gets very very big uh especially since we're updating our records every",
    "start": "1986480",
    "end": "1992080"
  },
  {
    "text": "day uh so if it it's depending on your network if",
    "start": "1992080",
    "end": "1997320"
  },
  {
    "text": "for instance if you're dealing with a with a company with one class one class C that's going to be a lot different than R2 and a half class BS or even a",
    "start": "1997320",
    "end": "2003360"
  },
  {
    "text": "company with a Class A um so it's all depending on your company",
    "start": "2003360",
    "end": "2008840"
  },
  {
    "text": "and the the the re the the the the longer we store data the more suspect it",
    "start": "2008840",
    "end": "2013919"
  },
  {
    "text": "becomes as as we said things change over time so we we we want to keep upto-date information but we want to don't want to",
    "start": "2013919",
    "end": "2020360"
  },
  {
    "text": "trust older information explicitly because the question you just asked it changes over",
    "start": "2020360",
    "end": "2025480"
  },
  {
    "text": "time are we violating any policies and this was just kind of thrown in as an afterthought um being that we're a",
    "start": "2025480",
    "end": "2032039"
  },
  {
    "text": "university we we have several acts we have to abide by the the Hippa act and things like that and they they they deal",
    "start": "2032039",
    "end": "2039480"
  },
  {
    "text": "with how you store information about students employees things like that so storing for instance an aim session from",
    "start": "2039480",
    "end": "2046559"
  },
  {
    "text": "somebody because one of the uh one of the tools that I can show you how to integrate is aim sniff storing an aim",
    "start": "2046559",
    "end": "2052638"
  },
  {
    "text": "storing an aim conversation from a student over time it's kind of illegal well actually it's it's an invasion of privacy and it's illegal under the hip",
    "start": "2052639",
    "end": "2059398"
  },
  {
    "text": "act and we we can't do that so you want to make sure that while you're doing this you're not doing anything that's",
    "start": "2059399",
    "end": "2064878"
  },
  {
    "text": "violating anybody's anybody's data retention policies which uh the legal department for your company should be",
    "start": "2064879",
    "end": "2070440"
  },
  {
    "text": "able to inform you what that is",
    "start": "2070440",
    "end": "2074040"
  },
  {
    "text": "yes that's is that's is he he uh his question was uh about your general usage",
    "start": "2089960",
    "end": "2095839"
  },
  {
    "text": "policy as most every company and I'd be surprised if they don't now has a general usage policy saying how you can",
    "start": "2095839",
    "end": "2101680"
  },
  {
    "text": "use your network and what the company's rights are in auditing Network traffic and your machine because it's technically company policy and that that",
    "start": "2101680",
    "end": "2108960"
  },
  {
    "text": "gets into a that gets into a very sticky situation especially in universities because technically this is true",
    "start": "2108960",
    "end": "2114359"
  },
  {
    "text": "everybody scans your Mach everybody when you uh when you come to the university your machine is on our Network we can",
    "start": "2114359",
    "end": "2120320"
  },
  {
    "text": "audit it at will uh but policy implementation of that policy",
    "start": "2120320",
    "end": "2125960"
  },
  {
    "text": "is a little bit differently than the the spirit of the policy we can't go into a dorm room and randomly look through a",
    "start": "2125960",
    "end": "2132240"
  },
  {
    "text": "through a hard drive for pornography uh that's a violation of the person the",
    "start": "2132240",
    "end": "2137800"
  },
  {
    "text": "personal policy and at this time our legal department informs us that although the conversations are",
    "start": "2137800",
    "end": "2144119"
  },
  {
    "text": "traversing our Network that unless it's something sus that's part of an ongoing",
    "start": "2144119",
    "end": "2149280"
  },
  {
    "text": "investigation we have no real reason to be reading people's conversations which is true so we're we're invading their",
    "start": "2149280",
    "end": "2155119"
  },
  {
    "text": "privacy when we do it so we don't we we we prefer not to invade privacy",
    "start": "2155119",
    "end": "2160280"
  },
  {
    "text": "which is kind of strange for a security person say but it's true uh also dealing that we're we're",
    "start": "2160280",
    "end": "2167440"
  },
  {
    "text": "we're a research institute that does a lot of research you don't want to make sure you're not storing any sense of information I have",
    "start": "2167440",
    "end": "2174160"
  },
  {
    "text": "a funny story about that where a top secret cleared a a person was sending an",
    "start": "2174160",
    "end": "2179520"
  },
  {
    "text": "email that contained top secret information over a public network and our sniffer CAU it uh and following uh",
    "start": "2179520",
    "end": "2186680"
  },
  {
    "text": "following policy went was informed and they found out we had a sniffer they took the hard drives from the sniffer too so you want to make sure when you do",
    "start": "2186680",
    "end": "2193079"
  },
  {
    "text": "this you're not you're not storing any any information that that might be considered sensitive you want you want a",
    "start": "2193079",
    "end": "2199720"
  },
  {
    "text": "very clear goal of the information you want to gather for our engine we're only Gathering host",
    "start": "2199720",
    "end": "2204839"
  },
  {
    "text": "information uh to either determine whether a attack will succeed or",
    "start": "2204839",
    "end": "2209920"
  },
  {
    "text": "fail did that answer your question right pitfalls feature creep I rented this big",
    "start": "2209920",
    "end": "2216040"
  },
  {
    "text": "time when you sat down I'm a coder which is probably why I'm such a bad speaker but I'm a coder by nature and I I when I",
    "start": "2216040",
    "end": "2222400"
  },
  {
    "text": "sat down I was like okay I only want something that's going to take snort output and compare it to a nus database",
    "start": "2222400",
    "end": "2228440"
  },
  {
    "text": "and see if it works uh see if the attack fail or succeed and after a day or so",
    "start": "2228440",
    "end": "2233920"
  },
  {
    "text": "working on this I'm like you know it' be really cool if I could if if I could uh have it scan on demand so if it gets a",
    "start": "2233920",
    "end": "2239440"
  },
  {
    "text": "snort alert for a machine it doesn't already have you can go out and scan it and see if it's vulnerable and uh this",
    "start": "2239440",
    "end": "2245599"
  },
  {
    "text": "was a big problem for me was before I knew it this this program I was writing was was going to cure cancer and I control the space shuttle so you you",
    "start": "2245599",
    "end": "2252560"
  },
  {
    "text": "want to avoid that uh and it's very easy to do because with the sensibility of the engine you're it's it's tempting to",
    "start": "2252560",
    "end": "2259359"
  },
  {
    "text": "just keep adding little things to it and that's more of a that's more of a coding thing than than a security thing but",
    "start": "2259359",
    "end": "2265319"
  },
  {
    "text": "it's one of the big pitfalls I ran into uh adding new functionality the the",
    "start": "2265319",
    "end": "2271079"
  },
  {
    "text": "passive fingerprinting was actually the the the one thing that got in I couldn't I needed it because I couldn't get the",
    "start": "2271079",
    "end": "2277680"
  },
  {
    "text": "accurate Port scans of machines as I said before so I needed some way to figure out how to do it it wasn't the original scope but it but it seemed to",
    "start": "2277680",
    "end": "2283640"
  },
  {
    "text": "work out for me complexity you don't want to do things that are too complex you uh you have a lot of data you're",
    "start": "2283640",
    "end": "2289520"
  },
  {
    "text": "tempted to start implementing data mining algorithms make sure your basic engine works before you uh oh my",
    "start": "2289520",
    "end": "2297280"
  },
  {
    "text": "God talk about embarrassing this is not my",
    "start": "2299200",
    "end": "2303880"
  },
  {
    "text": "day sorry about that uh you don't want to do things that are too complex um these are different say",
    "start": "2305520",
    "end": "2315440"
  },
  {
    "text": "again no no but I have to say mcaffrey is the best virus scanner I've ever seen",
    "start": "2316319",
    "end": "2323640"
  },
  {
    "text": "I highly recommend it there's uh there's several different uh there's several different ways you",
    "start": "2323640",
    "end": "2329240"
  },
  {
    "text": "can do this and this is the next couple slides just giving you ideas of ways to",
    "start": "2329240",
    "end": "2335079"
  },
  {
    "text": "do it we do an agent on on a machine uh the nus machine the individual machine",
    "start": "2335079",
    "end": "2340680"
  },
  {
    "text": "that reports to an aggregation point which attempts to do data reduction before it reports it to a correlation engine which is uh actually it's couple",
    "start": "2340680",
    "end": "2348240"
  },
  {
    "text": "down but there there there's all there's all kinds of ways you can do this uh you can have an agent report to an aggregation engine which reports to a",
    "start": "2348240",
    "end": "2354560"
  },
  {
    "text": "machine running correlation engine that actually does SQL uh SQL queries against another machine that that insulates you",
    "start": "2354560",
    "end": "2361079"
  },
  {
    "text": "against a lot of uh Network failure something fails you can have it fell over to something else because as we said before we really",
    "start": "2361079",
    "end": "2368400"
  },
  {
    "text": "want to keep this up that was not all of them I suppose it",
    "start": "2368400",
    "end": "2375599"
  },
  {
    "text": "was how did I get there all right well these these are all the uh the different types and you can",
    "start": "2375599",
    "end": "2382560"
  },
  {
    "text": "you can read them if you want the distributed is the the distributed is the most reliable meaning that you can",
    "start": "2382560",
    "end": "2389560"
  },
  {
    "text": "have several different points to do several different jobs you can have code in your timeout you can have code in your sensors that if it times out",
    "start": "2389560",
    "end": "2395000"
  },
  {
    "text": "speaking to your first aggregation point it can touch to second aggregation point you have code uh timeout code in your uh",
    "start": "2395000",
    "end": "2401359"
  },
  {
    "text": "you have timeout code in your aggregation uh software that if you can't typ to correlation engine a it",
    "start": "2401359",
    "end": "2406880"
  },
  {
    "text": "tyes to correlation engine B and then your correlation code actually dumps everything in the same database so it it",
    "start": "2406880",
    "end": "2412800"
  },
  {
    "text": "would it would work",
    "start": "2412800",
    "end": "2415640"
  },
  {
    "text": "sir he's asking how I make sure that uh that my system is not vulnerable to man in the middle attack how I'm making sure",
    "start": "2424240",
    "end": "2430800"
  },
  {
    "text": "that my my system my sof the the information I'm getting isn't monitored in route to the the Final",
    "start": "2430800",
    "end": "2437400"
  },
  {
    "text": "Destination SSL uh actually the next version of this",
    "start": "2437400",
    "end": "2444160"
  },
  {
    "text": "engine is going to have hashing of the alerts and the actions but as of right now it's just",
    "start": "2444160",
    "end": "2449720"
  },
  {
    "text": "SSL this isn't by the way this is an engine I would take the open source today and uh try to run your production",
    "start": "2449720",
    "end": "2455359"
  },
  {
    "text": "Network tomorrow that that's not a good idea this talk is more about how you can build your own than you know how mine",
    "start": "2455359",
    "end": "2461520"
  },
  {
    "text": "works sir",
    "start": "2461520",
    "end": "2465920"
  },
  {
    "text": "consider I did consider that but that violates my you shouldn't have to change your network to make a security solution",
    "start": "2470800",
    "end": "2477480"
  },
  {
    "text": "fit ideology it it would work we have a lot of things set up like that and if",
    "start": "2477480",
    "end": "2482839"
  },
  {
    "text": "you have the me if you have the means by all means that's the most secure way to do it um unless you use vlans then",
    "start": "2482839",
    "end": "2489640"
  },
  {
    "text": "that's bad but that is one that is one approach but I wanted my information to travel over",
    "start": "2489640",
    "end": "2497160"
  },
  {
    "text": "the public network I didn't want to have to build an entir separate Network for my solution to work do",
    "start": "2497160",
    "end": "2504480"
  },
  {
    "text": "that all right we're going to use the dist in my speech I'm going to talk about the Distributing model of architecture uh it's flexible allows",
    "start": "2504480",
    "end": "2511480"
  },
  {
    "text": "most customization as I as I told you before you can have the theel for timeouts and whatnot it allows for",
    "start": "2511480",
    "end": "2516880"
  },
  {
    "text": "product sub uh sub uh substitution as as you see fit for instance if you want to",
    "start": "2516880",
    "end": "2523359"
  },
  {
    "text": "update your aggregation code it's not a big deal because you have several other aggregation points you can talk to so as",
    "start": "2523359",
    "end": "2529560"
  },
  {
    "text": "you update it it uh won't be a problem same with your correlation engineer your sensors as long as it's distributed you",
    "start": "2529560",
    "end": "2536560"
  },
  {
    "text": "you don't have to worry about a single point of failure which is what you want to avoid it allows for a stage",
    "start": "2536560",
    "end": "2541599"
  },
  {
    "text": "development which is uh how we did this things to consider languages I wrote my",
    "start": "2541599",
    "end": "2547319"
  },
  {
    "text": "engine in C because I like c c is fast Java is not I'm not going to engage in a holy war about Java I just don't like it",
    "start": "2547319",
    "end": "2553920"
  },
  {
    "text": "um I WR I wrote all my stuff and see uh but you know write whatever a version of",
    "start": "2553920",
    "end": "2558960"
  },
  {
    "text": "this is running in our College of computing is written in Pearl so you can really write anything you want you want",
    "start": "2558960",
    "end": "2564640"
  },
  {
    "text": "a multi- thread uh that's a pretty good idea uh considering the task you have",
    "start": "2564640",
    "end": "2570359"
  },
  {
    "text": "you have for uh the typical setup for my engine is I have a a socket listening thread a correlation thread and a DB",
    "start": "2570359",
    "end": "2577839"
  },
  {
    "text": "thread and they all work together to do the uh the correlation uh I can't really imagine doing it that well as a single",
    "start": "2577839",
    "end": "2583920"
  },
  {
    "text": "threaded model but it it is possible make sure whatever language you choose there's",
    "start": "2583920",
    "end": "2589359"
  },
  {
    "text": "good apis to the tools you're going to use for instance I use the mySQL database as my back end make sure whatever language you use you can talk",
    "start": "2589359",
    "end": "2595880"
  },
  {
    "text": "to whatever tools you want to use to uh to build it the engine uh more so than",
    "start": "2595880",
    "end": "2601800"
  },
  {
    "text": "any other part of the uh the tool needs to be as fast as possible you're going to be munging a lot of data so you want",
    "start": "2601800",
    "end": "2607240"
  },
  {
    "text": "as much speed as you can get the the sensors the route I went the sensors are",
    "start": "2607240",
    "end": "2612440"
  },
  {
    "text": "Python scripts uh so they're slower and a little interpreted but the performance",
    "start": "2612440",
    "end": "2618119"
  },
  {
    "text": "game we're getting is not going to be on the sensor side it's going to be on the correlation engine",
    "start": "2618119",
    "end": "2623319"
  },
  {
    "text": "side you want to when you're when you're developing this you want to take into account this is a system that might be",
    "start": "2625960",
    "end": "2632400"
  },
  {
    "text": "in place for a long time everybody's I'm sure everybody's had that experience where they had to build a solution in 10 days this only going to be two months",
    "start": "2632400",
    "end": "2638240"
  },
  {
    "text": "and it's going to be replaced with something better that's how this actually got started uh it was going to be replaced by a a commercial system and",
    "start": "2638240",
    "end": "2646119"
  },
  {
    "text": "that was a year or so ago and we still don't have the commercial system so in the design phase although this might just be a stepping stone to a commercial",
    "start": "2646119",
    "end": "2652480"
  },
  {
    "text": "system or something else you want to make sure that it's it's not going to it will stand the test of time little",
    "start": "2652480",
    "end": "2660079"
  },
  {
    "text": "little problems with this is you hard code IP addresses or what not to your code I mean this is all basic coding",
    "start": "2660079",
    "end": "2665599"
  },
  {
    "text": "stuff but these are these are pitfalls I run into you you hard codee IP addresses you hard code signatures and things like",
    "start": "2665599",
    "end": "2671400"
  },
  {
    "text": "that to your your code it that makes maintaining it harder and one of the things we want to shoot for and aside",
    "start": "2671400",
    "end": "2677359"
  },
  {
    "text": "from it sensibility is maintainability operating systems I'm uh",
    "start": "2677359",
    "end": "2683440"
  },
  {
    "text": "all this stuff works on Linux um my sensors my aggregation point my correlation engine all Linux that does",
    "start": "2683440",
    "end": "2690319"
  },
  {
    "text": "not mean that other operating systems it won't work on in fact uh pting a python script to Windows to uh to run a Windows",
    "start": "2690319",
    "end": "2696839"
  },
  {
    "text": "tool tool or a Windows version of trip wire is Trivial to do I just haven't",
    "start": "2696839",
    "end": "2702040"
  },
  {
    "text": "done it yet uh that's one of the reasons why I want to go with with an interpreted",
    "start": "2702040",
    "end": "2708119"
  },
  {
    "text": "language like python for the sensors that's supporting it to other platforms is",
    "start": "2708119",
    "end": "2714559"
  },
  {
    "text": "easier uh storage we're back to the storage data retention um you don't want",
    "start": "2714559",
    "end": "2719800"
  },
  {
    "text": "to you want to make sure that wherever you're storing this you have a big enough box and your database uh your",
    "start": "2719800",
    "end": "2724920"
  },
  {
    "text": "database can handle it database is the the database we use gets very large which makes uh SQL queries very slow",
    "start": "2724920",
    "end": "2732160"
  },
  {
    "text": "sometimes which will in turn make correlating the next event very slow so as a flow of events come in uh you",
    "start": "2732160",
    "end": "2738760"
  },
  {
    "text": "update this host that has this new open port you update to this host with this new vulnerability you have to make SQL",
    "start": "2738760",
    "end": "2744520"
  },
  {
    "text": "quer queries for those over time uh it gets it gets a little bit slower and you",
    "start": "2744520",
    "end": "2749559"
  },
  {
    "text": "don't want to be waiting on an SQL quity for a port update to uh to finish while you have a critical alert pending in a",
    "start": "2749559",
    "end": "2755640"
  },
  {
    "text": "queue um which brings us to traffic uh you",
    "start": "2755640",
    "end": "2762880"
  },
  {
    "text": "traffic is what this is all about you want to analyze your traffic as well as possible the biggest thing you want to",
    "start": "2762880",
    "end": "2768400"
  },
  {
    "text": "do and I keep harping on this because it's the biggest one of the most important steps of this is data reduction for instance on your sensor",
    "start": "2768400",
    "end": "2775440"
  },
  {
    "text": "you're going to notice that a a a machine outside that is uh scanning in",
    "start": "2775440",
    "end": "2781280"
  },
  {
    "text": "will generate there will be an alarm generated for every host that scans um which it isn't that useful to us that's",
    "start": "2781280",
    "end": "2788119"
  },
  {
    "text": "duplication of data although these machines are being scanned which is uh it becomes it becomes a tradeoff so",
    "start": "2788119",
    "end": "2795960"
  },
  {
    "text": "in in my Approach what I've done is uh I have a host record for the machine that's doing the scanning the offender",
    "start": "2795960",
    "end": "2803079"
  },
  {
    "text": "and then it will let the last 10 IP addresses is scanned and the each sensor",
    "start": "2803079",
    "end": "2808240"
  },
  {
    "text": "has a copy of the the of of these of of these lists and as it updates it can",
    "start": "2808240",
    "end": "2814240"
  },
  {
    "text": "update the list and send it back to correlation engine this uh this cuts",
    "start": "2814240",
    "end": "2819319"
  },
  {
    "text": "down on your sensor just sending every alert to the correlation engine because you want you want to cut down as much as",
    "start": "2819319",
    "end": "2824760"
  },
  {
    "text": "possible you also want to avoid duplication of data if uh you don't want",
    "start": "2824760",
    "end": "2830200"
  },
  {
    "text": "to send an alert to a correlation engine every time a machine Port scans a new machine you don't have to send the entire alert all you have to do is send",
    "start": "2830200",
    "end": "2836359"
  },
  {
    "text": "the uh the time of the last scan for instance you just send differentials which cuts down on data you also don't",
    "start": "2836359",
    "end": "2842720"
  },
  {
    "text": "want to be sending large amounts of data to your aggregation correlation engin you might in vertly cause a n service",
    "start": "2842720",
    "end": "2849720"
  },
  {
    "text": "attack bottle bottlenecks and this is a this is an interes problem we had to overcome the aggregation Point has to be",
    "start": "2849720",
    "end": "2857640"
  },
  {
    "text": "beefy enough to handle all the sensors that's communicating with it which is kind of hard if you have thousands of",
    "start": "2857640",
    "end": "2862960"
  },
  {
    "text": "sensors uh so you got to make sure you have enough aggregation points so that when your data is being communicated to",
    "start": "2862960",
    "end": "2868800"
  },
  {
    "text": "it you're it's it's available you got to make sure your engine can keep up with the amount of data it has to process you",
    "start": "2868800",
    "end": "2874319"
  },
  {
    "text": "got to make sure your database isn't going to die and interoperability we uh we have an",
    "start": "2874319",
    "end": "2880240"
  },
  {
    "text": "existing Network management solution in place and I don't want to replace that with my tool I just want to make it",
    "start": "2880240",
    "end": "2886240"
  },
  {
    "text": "aware of Me by sending SNP traps and whatnot other correlation tools uh this",
    "start": "2886240",
    "end": "2892960"
  },
  {
    "text": "this may be a stepping stone for many people into a commercial product and if that is the case then uh you want your",
    "start": "2892960",
    "end": "2899319"
  },
  {
    "text": "tool to work with other tools some tools uh take XML input as uh as alerts and",
    "start": "2899319",
    "end": "2905760"
  },
  {
    "text": "that's that's pretty easy to do uh also in in a lot of places well universities",
    "start": "2905760",
    "end": "2913400"
  },
  {
    "text": "mostly it's not as prevalent in uh in Industry you have several different groups that do the same job like for",
    "start": "2913400",
    "end": "2919800"
  },
  {
    "text": "instance at Georgia Tech we have the College of computing we have the College of Engineering and we have uh the industrial science department who have",
    "start": "2919800",
    "end": "2926520"
  },
  {
    "text": "all their own IT staff and they want to take care of all their stuff internal they don't want anyone else to touch it",
    "start": "2926520",
    "end": "2932119"
  },
  {
    "text": "so if this is the case in an organization you're in you want to make sure that your correlation engine",
    "start": "2932119",
    "end": "2937400"
  },
  {
    "text": "can inform them of stuff that's going on and likewise if they have a correlation engine it informs",
    "start": "2937400",
    "end": "2944880"
  },
  {
    "text": "you",
    "start": "2947200",
    "end": "2950200"
  },
  {
    "text": "sure say",
    "start": "2956119",
    "end": "2959599"
  },
  {
    "text": "sir yes my tool is designed to integrate into anything if you want to integrate my tool into your 57 Chevy it will work",
    "start": "2964480",
    "end": "2971960"
  },
  {
    "text": "it's uh it's designed to be as extensible as possible actually the speaker that's coming right after me uh",
    "start": "2971960",
    "end": "2977280"
  },
  {
    "text": "I can't remember his name he's speaking on spider is uh is one of the things I'm interested in integrating with uh but",
    "start": "2977280",
    "end": "2983599"
  },
  {
    "text": "it's designed to integrate with other things uh and I have thought about it it's just we haven't had the time to do",
    "start": "2983599",
    "end": "2989400"
  },
  {
    "text": "it yet uh he was asking if if I thought about integrating my tool with others",
    "start": "2989400",
    "end": "2995319"
  },
  {
    "text": "um communic a we're going to get data from point A to point B he asked a question earlier uh how do I keep it",
    "start": "2995319",
    "end": "3001520"
  },
  {
    "text": "secure we do everything over SSL tunneling uh with certificate authentication that gives you some me",
    "start": "3001520",
    "end": "3007520"
  },
  {
    "text": "measure of security uh if you're a determined attacker it's trivially defeatable but it will keep the script",
    "start": "3007520",
    "end": "3012720"
  },
  {
    "text": "kitties out which is what I was going for believe it or not on my college campus we have lots of script kitties uh",
    "start": "3012720",
    "end": "3018599"
  },
  {
    "text": "we have a thick agent which means an agent does as much processing as possible before it sends the data to an aggregation point which means when the",
    "start": "3018599",
    "end": "3025200"
  },
  {
    "text": "agent uh when the agent first loads up and request a list of host info for the ranges it's protecting from the",
    "start": "3025200",
    "end": "3031200"
  },
  {
    "text": "correlation engine so it's going to basically get a list of all the uh all the machines that it's watching",
    "start": "3031200",
    "end": "3037400"
  },
  {
    "text": "uh and anything that can be reduced on the agent side will be which is helping",
    "start": "3037400",
    "end": "3042720"
  },
  {
    "text": "our correlation engine as a whole the normalization uh this was originally designed to work with an with XML uh",
    "start": "3042720",
    "end": "3050319"
  },
  {
    "text": "which is as everybody know great industry standard and there's many open source parsers that exist for this if",
    "start": "3050319",
    "end": "3055559"
  },
  {
    "text": "you don't want to write your own I eventually went with a uh with a custom",
    "start": "3055559",
    "end": "3060720"
  },
  {
    "text": "uh communication scheme simply because I wanted to um I wanted more granular control over",
    "start": "3060720",
    "end": "3067880"
  },
  {
    "text": "it which I'm not saying XML doesn't give me it's just that I wanted to write my",
    "start": "3067880",
    "end": "3073079"
  },
  {
    "text": "own this is how the agent actually does a data reduction the agent will boot up",
    "start": "3073079",
    "end": "3079760"
  },
  {
    "text": "it has a config file it grabs a config file and it looks for the type of agent it is which is either an intrusion agent",
    "start": "3079760",
    "end": "3086920"
  },
  {
    "text": "or a scanning agent it will then uh determine based on its role pull a list of information from the correlation",
    "start": "3086920",
    "end": "3093440"
  },
  {
    "text": "engine and that information is the host information for the host that's protecting uh it it has a local copy it",
    "start": "3093440",
    "end": "3100400"
  },
  {
    "text": "tries to pull from first but if a copy is too old it will go to correlation engine or if the the hash on the uh the",
    "start": "3100400",
    "end": "3108119"
  },
  {
    "text": "information has been changed it will go to correlation engine um informational alerts which are like this host now has",
    "start": "3108119",
    "end": "3115520"
  },
  {
    "text": "Port ad open well only be sent if uh if if it's new if uh it won't as it does a",
    "start": "3115520",
    "end": "3121359"
  },
  {
    "text": "port scan of something it won't send ports to the correlation engine that already exist or that it already knows",
    "start": "3121359",
    "end": "3126440"
  },
  {
    "text": "about it will only send uh new things which uh which helps out a lot uh simply",
    "start": "3126440",
    "end": "3132119"
  },
  {
    "text": "because the the less time you spend on the the trivial things the more time you can spend doing the important stuff um",
    "start": "3132119",
    "end": "3138520"
  },
  {
    "text": "the change S tack information uh when the intrusion sensor detects an attack",
    "start": "3138520",
    "end": "3143599"
  },
  {
    "text": "that's sent immediately we want that sent as quickly as possible the engine the engine config uh tells",
    "start": "3143599",
    "end": "3150440"
  },
  {
    "text": "the engine the address ranges of everything is being configured uh being protected meaning that you this is where",
    "start": "3150440",
    "end": "3156760"
  },
  {
    "text": "I have all of our uh all of our IP addresses we're worried about in it a network Baseline has to be created first",
    "start": "3156760",
    "end": "3162960"
  },
  {
    "text": "to start with this is a vulnerability scan of everything you're protecting without that it's kind of hard to detect",
    "start": "3162960",
    "end": "3168760"
  },
  {
    "text": "changes because everything's a change uh which was the original way it was designed I decided not to go with",
    "start": "3168760",
    "end": "3174640"
  },
  {
    "text": "that because as uh as new things happen it would actually bog the system down so",
    "start": "3174640",
    "end": "3180559"
  },
  {
    "text": "I want I want you want to start off with a good Baseline the information differences are received by the engine applied to host information in memory",
    "start": "3180559",
    "end": "3186880"
  },
  {
    "text": "and rent to the database as soon as possible I do as much as possible in memory it's a lot faster than uh quaring",
    "start": "3186880",
    "end": "3193359"
  },
  {
    "text": "the engine now if you are running multiple correlation engines you got to write to the database as quickly as possible because your other engine might",
    "start": "3193359",
    "end": "3199720"
  },
  {
    "text": "need that information you have only memory it it's a trade-off and that that's up to the individual",
    "start": "3199720",
    "end": "3205000"
  },
  {
    "text": "coder uh I designed my own um my own communication protocol for that and it it's a really simple protocol please",
    "start": "3205000",
    "end": "3210920"
  },
  {
    "text": "don't laugh but it's just a uh a simple text string FS F separated by pipes and",
    "start": "3210920",
    "end": "3217799"
  },
  {
    "text": "uh as you can see um it has actually these aren't",
    "start": "3217799",
    "end": "3224440"
  },
  {
    "text": "capitalized in uh in the actual protocol they the uh the actual bold face are all",
    "start": "3224440",
    "end": "3230920"
  },
  {
    "text": "lowercase um basically what it is is I I I have a one of one of these things",
    "start": "3230920",
    "end": "3237359"
  },
  {
    "text": "action colon in a value pipe time colon in a value pipe uh this this is for",
    "start": "3237359",
    "end": "3243920"
  },
  {
    "text": "making parsing easier you can build your string in any real form uh you can go through and string to it and it it makes",
    "start": "3243920",
    "end": "3250079"
  },
  {
    "text": "parsing a lot makes parsing somewhat easier um basically what we start off with is an action zero is informational",
    "start": "3250079",
    "end": "3257319"
  },
  {
    "text": "and an informational alert is the type of uh the type of alert it is we have a we have a new Port open we have a new",
    "start": "3257319",
    "end": "3263400"
  },
  {
    "text": "host we found this host changed inform uh this host changed operating system type this is uh this is anything that's",
    "start": "3263400",
    "end": "3269359"
  },
  {
    "text": "not an intrusion basically one is an alert an alert is an intrusion so basically when we when we designed our",
    "start": "3269359",
    "end": "3275880"
  },
  {
    "text": "our parsing structure uh we said if not you know if if one we parse first if not you we worry about later now this engine",
    "start": "3275880",
    "end": "3283839"
  },
  {
    "text": "has the ability and we're going to get into this a little bit later to request sensors do stuff for it like if it if it",
    "start": "3283839",
    "end": "3289839"
  },
  {
    "text": "gets an alert for for a uh for a machine it doesn't have any host information for it will go find a host information it",
    "start": "3289839",
    "end": "3296720"
  },
  {
    "text": "won't be as accurate at this time because this is after a probable attack has happened but it once again is better than nothing so when the engine is",
    "start": "3296720",
    "end": "3303960"
  },
  {
    "text": "requesting something uh that that's that fills that to a two and a three is a request from that response and the",
    "start": "3303960",
    "end": "3309680"
  },
  {
    "text": "request from the response is processed just like anything else that uh that comes in time is a time uh is epic time",
    "start": "3309680",
    "end": "3316000"
  },
  {
    "text": "since uh 70 uh as I mentioned before everything on the network is ntpd so we",
    "start": "3316000",
    "end": "3321599"
  },
  {
    "text": "can uh we can keep a pretty good uh a pretty good accounting of What's Happen happening at one time uh with with the",
    "start": "3321599",
    "end": "3328400"
  },
  {
    "text": "time skew some things might not work quite right sensor ID",
    "start": "3328400",
    "end": "3334680"
  },
  {
    "text": "um I require an ntp uh CL we require an ntp client to be installed on everything",
    "start": "3342559",
    "end": "3348760"
  },
  {
    "text": "which is why in my client there is no ntp client on the next version there is an ntp client that is uh built in",
    "start": "3348760",
    "end": "3356680"
  },
  {
    "text": "uh but at this time because this was originally built to work on our Network we didn't need it because everything",
    "start": "3356680",
    "end": "3361880"
  },
  {
    "text": "worked on ntp anyway uh and if it didn't we uh we would require it when we're installing the uh the",
    "start": "3361880",
    "end": "3367880"
  },
  {
    "text": "sensor a sensor ID has several roles whether it's originating or or the",
    "start": "3367880",
    "end": "3373280"
  },
  {
    "text": "destination of the alert but basically it's just a it's just an INT that uh that's a unique identifier for that",
    "start": "3373280",
    "end": "3379280"
  },
  {
    "text": "sentencer the source is the I said it's the source of the action whatever it may be Des is destination of the action uh",
    "start": "3379280",
    "end": "3386319"
  },
  {
    "text": "Port these are different uh different things can happen uh Port change Vol ID",
    "start": "3386319",
    "end": "3392920"
  },
  {
    "text": "the attack Sid is the S snort ID of the attack as we use the snort ID a lot",
    "start": "3392920",
    "end": "3401440"
  },
  {
    "text": "uh the threat level is a unique value we came up with based on how many machines",
    "start": "3401599",
    "end": "3406920"
  },
  {
    "text": "are talking to it how many uh security alerts we've seen whether it be low or high",
    "start": "3406920",
    "end": "3412920"
  },
  {
    "text": "uh what basically do what the current so we can go into a host table in query",
    "start": "3412920",
    "end": "3418400"
  },
  {
    "text": "with something like select star from host info where Threat Level is greater than",
    "start": "3418400",
    "end": "3424240"
  },
  {
    "text": "50 um we try to limit we limit our host level at 100 uh request ID is the type",
    "start": "3424240",
    "end": "3430920"
  },
  {
    "text": "of request this is Implement by the engine when it's sending out a request to a sensor a zero is a port scan one is",
    "start": "3430920",
    "end": "3436880"
  },
  {
    "text": "IDs logging and two checks for intrusion which means that if a if a machine's running a host sensor on it and um",
    "start": "3436880",
    "end": "3444559"
  },
  {
    "text": "actually I'll get to that in a second I don't want to get of myself uh this is basically a a a breakdown on how this",
    "start": "3444559",
    "end": "3453039"
  },
  {
    "text": "protocol Works uh we there there's a request validation function when it first gets when it first gets a request",
    "start": "3453039",
    "end": "3459359"
  },
  {
    "text": "make sure it's a valid a valid request uh if it's not it's dropped there are several things that have to happen for",
    "start": "3459359",
    "end": "3465200"
  },
  {
    "text": "it to be a valid request uh a string must contain at least action time and sensor it's got to contain at least",
    "start": "3465200",
    "end": "3472280"
  },
  {
    "text": "those three Fields if nothing more whenever an informational alert is created the source set to the machine that had the change if no type change is",
    "start": "3472280",
    "end": "3479520"
  },
  {
    "text": "sent it is not a valid request which means if the action is an informational update but there is no Port change or",
    "start": "3479520",
    "end": "3486359"
  },
  {
    "text": "whatnot it doesn't uh it doesn't update it I mean it's an invalid request when alert is generated sources is set to the",
    "start": "3486359",
    "end": "3492680"
  },
  {
    "text": "attacker destination is sent to the victim so if you have an attack alert and we don't have one of these these two fields in it's an invalid alert even if",
    "start": "3492680",
    "end": "3499839"
  },
  {
    "text": "we don't put the uh the type of attack if action is set to alert there is no attack",
    "start": "3499839",
    "end": "3506680"
  },
  {
    "text": "and it's an invalid request when an engine makes a request to a sensor set to the ID of the sensor and the request",
    "start": "3506680",
    "end": "3512359"
  },
  {
    "text": "uh the request is uh what's destined to the source is sent to the IP to execute the request on basically what this means",
    "start": "3512359",
    "end": "3519079"
  },
  {
    "text": "is when the engine decides that it needs some information it doesn't have like the process I mentioned that that goes",
    "start": "3519079",
    "end": "3524520"
  },
  {
    "text": "through an audits to make sure it has a passive active fingerprint uh last change time or whatnot basically when",
    "start": "3524520",
    "end": "3530880"
  },
  {
    "text": "the engine makes a request it it sets the the the the ID of the sensor it wants to execute the request and the",
    "start": "3530880",
    "end": "3537799"
  },
  {
    "text": "source is set to the uh the request to the sensor that uh set to the IP address",
    "start": "3537799",
    "end": "3542960"
  },
  {
    "text": "that's going to be executed on and then of course there there's a censor field these are examples of it this kind of",
    "start": "3542960",
    "end": "3548720"
  },
  {
    "text": "got wrapped because of uh science constraints but this is what a uh the",
    "start": "3548720",
    "end": "3554440"
  },
  {
    "text": "first one is what a uh an updating of host profile looks like basically uh we've got action zero time is the time",
    "start": "3554440",
    "end": "3561119"
  },
  {
    "text": "in Epic uh the sensor ID the source and what's changed that's the plus 80t is",
    "start": "3561119",
    "end": "3567520"
  },
  {
    "text": "telling me that I now have an open TCP Port which as you can see if everybody",
    "start": "3567520",
    "end": "3572920"
  },
  {
    "text": "if anybody's ever written C this is a pretty easy string to parse from a c standpoint uh and it's got four more",
    "start": "3572920",
    "end": "3579920"
  },
  {
    "text": "examples the the sensor alerting the engine to an attack the engine requesting the port scan of a host and",
    "start": "3579920",
    "end": "3584960"
  },
  {
    "text": "the engine uh the result of the request does anybody have any questions about",
    "start": "3584960",
    "end": "3591480"
  },
  {
    "text": "this uh sensors say again",
    "start": "3592200",
    "end": "3597799"
  },
  {
    "text": "uh I want to write my own there's no good reason not to I just want to write my",
    "start": "3598640",
    "end": "3603880"
  },
  {
    "text": "own uh the N version is wholly XML but the original version uh was a custom uh",
    "start": "3603880",
    "end": "3611440"
  },
  {
    "text": "string for paring um what sensors we're using IDs uh",
    "start": "3611440",
    "end": "3617680"
  },
  {
    "text": "vulnerability passive and host change detection basically uh I going to do the flow no not yet basically the way this",
    "start": "3617680",
    "end": "3624520"
  },
  {
    "text": "this this works is um uh imagine if you will a network",
    "start": "3624520",
    "end": "3630119"
  },
  {
    "text": "a slam well let's go with the L exploit decom exploit a decom exploit is sent to",
    "start": "3630119",
    "end": "3636880"
  },
  {
    "text": "a a Linux machine snort sees it there's a rule for it it Flags it uh the the",
    "start": "3636880",
    "end": "3643039"
  },
  {
    "text": "sensor has has the uh the host information for that host says dcom exploit is a Windows exploit this is a",
    "start": "3643039",
    "end": "3649079"
  },
  {
    "text": "Linux machine will not work let's send an informational alert saying uh telling it to increment its Threat Level but",
    "start": "3649079",
    "end": "3654960"
  },
  {
    "text": "that's about it uh the the the the resulting the flip side of that is you have a old Linux",
    "start": "3654960",
    "end": "3661880"
  },
  {
    "text": "machine running an older version of SSH um somebody does a crc32 exploit",
    "start": "3661880",
    "end": "3667920"
  },
  {
    "text": "against it the the the the snort sensor picks it up uh the sensor says well this",
    "start": "3667920",
    "end": "3673039"
  },
  {
    "text": "is a crc32 exploit this this machine is running uh SSH let's generate an alert",
    "start": "3673039",
    "end": "3679400"
  },
  {
    "text": "sent to correlation engine the correlation correlation engine will receive it it will look at the uh the",
    "start": "3679400",
    "end": "3686200"
  },
  {
    "text": "nesus IDS that uh are currently vulnerable on that box it will determine that this snort ID is vulnerable uh is a",
    "start": "3686200",
    "end": "3694880"
  },
  {
    "text": "has a high success rate against this n ID it will increment a threat level and alert someone that's basically how how",
    "start": "3694880",
    "end": "3701200"
  },
  {
    "text": "the flow works so actually next couple slides are kind of dumb they're um",
    "start": "3701200",
    "end": "3707720"
  },
  {
    "text": "they're they're just stuff about the effective placement of the IDS you know you have to have it in promiscuous mode for it to work well you should try to",
    "start": "3707720",
    "end": "3713200"
  },
  {
    "text": "limit the amount of address ranges per sensor to cut down in noise your vulnerability scanner uh we have a",
    "start": "3713200",
    "end": "3720480"
  },
  {
    "text": "unique setup with a vulnerability scanner as we have we don't have a firewall at our boorder but we have access control lists to block things",
    "start": "3720480",
    "end": "3726319"
  },
  {
    "text": "like Port 135 and 139 and we one of the things we use this for is accidental",
    "start": "3726319",
    "end": "3732520"
  },
  {
    "text": "deletions of those Access Control lists it's happened a couple times so we have",
    "start": "3732520",
    "end": "3737559"
  },
  {
    "text": "a unique view of the host inside where we can see all these ports uh sever of these ports are being uh blocked by the",
    "start": "3737559",
    "end": "3745119"
  },
  {
    "text": "router now an outside host is also scanning it and if the outside host and the inside host uh have basically the",
    "start": "3745119",
    "end": "3751559"
  },
  {
    "text": "same view then uh then Something's Happened and we can tell that something's wrong with the router um",
    "start": "3751559",
    "end": "3759359"
  },
  {
    "text": "which is which is one great use of of this we generally I generally use nmap just for Port scanning uh because N is a",
    "start": "3759359",
    "end": "3764680"
  },
  {
    "text": "bit Overkill every everybody who's ever run you know V ability scanner knows just to get the port information on the host of only build the scan a bit of an",
    "start": "3764680",
    "end": "3771119"
  },
  {
    "text": "Overkill which is why I'm using inmap and nessus instead of just nessus although you can make a you you can",
    "start": "3771119",
    "end": "3776480"
  },
  {
    "text": "craft your requests to have your nessus engine do your nmap request and report it back but it was just simpler to have",
    "start": "3776480",
    "end": "3782119"
  },
  {
    "text": "a python script at Z nmap and Report the results uh network speed Network size",
    "start": "3782119",
    "end": "3787920"
  },
  {
    "text": "number of attacks this is all gauging information on your network how big is your network what do you want to protect",
    "start": "3787920",
    "end": "3794880"
  },
  {
    "text": "how fast is your network uh do you have something that can sniff it a lot of problems with a correlation engine are",
    "start": "3794880",
    "end": "3801680"
  },
  {
    "text": "our ids's to drop packets we we found we found this out that if you are not getting an accurate if",
    "start": "3801680",
    "end": "3809520"
  },
  {
    "text": "you're not getting accurate Network information your correlation engine is pretty useless meaning that if you're missing every third packet you might be",
    "start": "3809520",
    "end": "3816119"
  },
  {
    "text": "missing an attack and your correlation is not going to be able to help you with that so when you designed the placement of your your sensors and whatnot and",
    "start": "3816119",
    "end": "3822000"
  },
  {
    "text": "make sure that you're not dropping packets the number of attacks our correlation engine deals with a large",
    "start": "3822000",
    "end": "3828279"
  },
  {
    "text": "number of attacks this is um this is because everybody likes",
    "start": "3828279",
    "end": "3833720"
  },
  {
    "text": "Georgia Tech I suppose um we try to prioritize attacks based on as",
    "start": "3833720",
    "end": "3839640"
  },
  {
    "text": "I've said several times based on it success if it if it if it could work",
    "start": "3839640",
    "end": "3846599"
  },
  {
    "text": "yes that's uh that's what we do",
    "start": "3851400",
    "end": "3857200"
  },
  {
    "text": "now have you ever heard of a scan Rand by Dan Kaminsky no I ah Dan kinsky gave",
    "start": "3860440",
    "end": "3866520"
  },
  {
    "text": "a great speech yesterday and scan ran is a high-speed Port scanner that enables that whereas scanning for one port in a",
    "start": "3866520",
    "end": "3874359"
  },
  {
    "text": "uh in a two and a half class piece takes two hours within map with scan Rand we can scan the entire campus obiously 5535",
    "start": "3874359",
    "end": "3881520"
  },
  {
    "text": "TCP ports in uh in a little over an hour well we do UDP that was just my TCP",
    "start": "3881520",
    "end": "3889279"
  },
  {
    "text": "example uh we we we we do do that now based on what your correlation engine is",
    "start": "3889279",
    "end": "3895119"
  },
  {
    "text": "protecting which is part of your your engaging method you might not be we might not decide to protect all two and",
    "start": "3895119",
    "end": "3900960"
  },
  {
    "text": "a half class beeds we have half of a class speed dedicated to resnet which are students we might decide that that's",
    "start": "3900960",
    "end": "3906960"
  },
  {
    "text": "the wild west we just don't want to protect that so we would configure a correlation engine not to worry about those host only scan or only scan",
    "start": "3906960",
    "end": "3913599"
  },
  {
    "text": "critical host that we worry about uh but I try to make sure my host",
    "start": "3913599",
    "end": "3919240"
  },
  {
    "text": "records don't get older than 24 hours because like I said lots of things",
    "start": "3919240",
    "end": "3924839"
  },
  {
    "text": "change if if somebody comes in today and decides that they uh they want to run a new service on their box that's that",
    "start": "3924839",
    "end": "3931240"
  },
  {
    "text": "that's uh that's bad you want to know about it generally before an attacker does and 24-hour periods uh is generally",
    "start": "3931240",
    "end": "3939279"
  },
  {
    "text": "you know at least in C some part of one work day unless it's the weekend but I I",
    "start": "3939279",
    "end": "3945599"
  },
  {
    "text": "I feel strongly that you need to keep upto-date information on this his uh his question I should repeat",
    "start": "3945599",
    "end": "3952799"
  },
  {
    "text": "it first was uh uh we have 2 and half class PES which is a lot of hosts and he",
    "start": "3952799",
    "end": "3958760"
  },
  {
    "text": "was asking if uh if I scan all of those every 24 hours and uh yes yes we",
    "start": "3958760",
    "end": "3965079"
  },
  {
    "text": "do we uh which was my scan R example active sensors versus passive sensors",
    "start": "3965079",
    "end": "3971319"
  },
  {
    "text": "active sensors are sensors that canot only receive or can only generate requests but receive requests from the",
    "start": "3971319",
    "end": "3977079"
  },
  {
    "text": "uh the correlation engine and update them uh an example of this request would be a uh an nmap sensor nmap sensors",
    "start": "3977079",
    "end": "3984599"
  },
  {
    "text": "generate information based B on their their General Normal scanning patterns also when needs be the correlation",
    "start": "3984599",
    "end": "3990480"
  },
  {
    "text": "engine can request that the end map sensor do a scan of a particular host and Report the results this is an active",
    "start": "3990480",
    "end": "3996559"
  },
  {
    "text": "sensor active sensors ENC can Encompass many different things on several hosts this can go up to including uh firewall",
    "start": "3996559",
    "end": "4002960"
  },
  {
    "text": "rules where we have several hosts where if there's a problem uh we can when when",
    "start": "4002960",
    "end": "4010119"
  },
  {
    "text": "there's an attacking host found we can uh you go through the correlation engine and the correlation engine will request",
    "start": "4010119",
    "end": "4015640"
  },
  {
    "text": "that the host be blocked via IP tables or Dro in the host. deny at least uh so",
    "start": "4015640",
    "end": "4022480"
  },
  {
    "text": "it's basically anything that can generate uh you can generate and receive request from correlation generate",
    "start": "4022480",
    "end": "4027640"
  },
  {
    "text": "request for and receive request from the correlation engine passive are sensors that only generate information that goes",
    "start": "4027640",
    "end": "4033240"
  },
  {
    "text": "to it p0f is an example of a passive sensor because it doesn't do anything other than remotely Sniff and uh send",
    "start": "4033240",
    "end": "4041279"
  },
  {
    "text": "information to correlation engine the engine what it does our engine is only going to verify the",
    "start": "4041279",
    "end": "4047279"
  },
  {
    "text": "attacks being if an attack being seen may may succeed it maintains the host information for all engine all the",
    "start": "4047279",
    "end": "4053720"
  },
  {
    "text": "agents and makes necessary alerts to responsible parties engine is kept very simple uh the correlation engines is a",
    "start": "4053720",
    "end": "4059960"
  },
  {
    "text": "little less than 5,000 lines to see so it's a pretty simple uh pretty simple engine uh unnecessary",
    "start": "4059960",
    "end": "4067440"
  },
  {
    "text": "functions uh somebody asked about integrating an ntp client into it uh",
    "start": "4067440",
    "end": "4072680"
  },
  {
    "text": "that's best left being handled by something else although the agents will have that feature we talked about",
    "start": "4072680",
    "end": "4077839"
  },
  {
    "text": "feature creep and uh the hard program the main resolve Loop because there's a there's a main Loop that all the threads",
    "start": "4077839",
    "end": "4084799"
  },
  {
    "text": "uh basically go through and this is the the logic that the",
    "start": "4084799",
    "end": "4089920"
  },
  {
    "text": "uh the correlation engine uses if an IDs alarm is created and sent",
    "start": "4089920",
    "end": "4095799"
  },
  {
    "text": "to it sent to the engine as soon as possible a question based on stored host",
    "start": "4095799",
    "end": "4102238"
  },
  {
    "text": "information is you can determine if the attack is likely to succeed and change the host Threat Level host Threat Level is what we care about because that's",
    "start": "4102239",
    "end": "4107440"
  },
  {
    "text": "what we see as uh as users of the system a thread will audit a q for machines",
    "start": "4107440",
    "end": "4112480"
  },
  {
    "text": "with Threat Level greater than a set value we have a threshold our um our Threat Level goes up to 100 we have a",
    "start": "4112480",
    "end": "4118798"
  },
  {
    "text": "threshold of 50 just informational alerts can't get can't get the threat level higher than 50 but if your Threat",
    "start": "4118799",
    "end": "4125560"
  },
  {
    "text": "Level is higher than 50 something strange going on uh it can inform the admin if a host has an active sensor the",
    "start": "4125560",
    "end": "4132040"
  },
  {
    "text": "information the engine can request the host check itself to see if it's been comp meaning that if trip wire is on this",
    "start": "4132040",
    "end": "4137758"
  },
  {
    "text": "host and in uh in it host table it sees that uh that it has it it can generate a",
    "start": "4137759",
    "end": "4143679"
  },
  {
    "text": "request to run trip wire and Report the results seeing if anything's been modified or if uh there's any new files",
    "start": "4143679",
    "end": "4150318"
  },
  {
    "text": "on the file system things like that uh which which kind of is is is a strange problem because every time you run trip",
    "start": "4150319",
    "end": "4156318"
  },
  {
    "text": "wire uh it finds like temp files and things like that we had to deal with parsing those out which is actually a",
    "start": "4156319",
    "end": "4161758"
  },
  {
    "text": "problem with this system because if you hide most of what you're doing in a temp file and attemp directory we're going to kind of miss it on on the host checks",
    "start": "4161759",
    "end": "4168520"
  },
  {
    "text": "but that's all fixed in the next version uh data the host information I I said this before uh for simple ease of",
    "start": "4168520",
    "end": "4175238"
  },
  {
    "text": "use uh for ease of example of what I'm showing is simp a simple Link Link list",
    "start": "4175239",
    "end": "4180719"
  },
  {
    "text": "contains all the information uh we have on a host everything I I like linked list for Simplicity because even you",
    "start": "4180719",
    "end": "4186679"
  },
  {
    "text": "know freshman CS students understand what a linked list is so when I'm explaining it to somebody I don't have to go into great detail about how link",
    "start": "4186679",
    "end": "4192960"
  },
  {
    "text": "list Works uh so everything basic is a length list U my alert Q is a length",
    "start": "4192960",
    "end": "4198480"
  },
  {
    "text": "list my alert Q is a queue that holds all the machines that are currently uh waiting to be processed for alert",
    "start": "4198480",
    "end": "4203800"
  },
  {
    "text": "information CU active queue request queue and censor queue they all have their their descriptions of what they do",
    "start": "4203800",
    "end": "4210880"
  },
  {
    "text": "um but basically we we we have a whole bunch of singly linked lists that we Traverse for",
    "start": "4210880",
    "end": "4217080"
  },
  {
    "text": "information uh this is how it works step byep if there's anything the alert Q waiting if so we process them",
    "start": "4217080",
    "end": "4223080"
  },
  {
    "text": "immediately are there any actions waiting be processed which is informational updates things like that we process uh we we read them off the",
    "start": "4223080",
    "end": "4230199"
  },
  {
    "text": "socket and we put them in the appropriate queue we determine if an action is an informational or alert um",
    "start": "4230199",
    "end": "4237560"
  },
  {
    "text": "because we we basically just read this off the socket so we determine if it's an informational uh action or if it's an",
    "start": "4237560",
    "end": "4242920"
  },
  {
    "text": "alert if it's alert we uh we put it in the alert cube right away if it's an action we put it in the action Cube once",
    "start": "4242920",
    "end": "4249600"
  },
  {
    "text": "again we go back and we check check the alert CU see if we have anything new that we just put in there if so we process it",
    "start": "4249600",
    "end": "4255679"
  },
  {
    "text": "uh then we check the information key process as permitting this is what what where the prioritizing of uh of",
    "start": "4255679",
    "end": "4261120"
  },
  {
    "text": "information came in uh we we will much rather process alerts and information uh",
    "start": "4261120",
    "end": "4269880"
  },
  {
    "text": "although it's there's a slighty window for for for for processing information uh this is basically the",
    "start": "4269880",
    "end": "4275760"
  },
  {
    "text": "alert process step by step uh by the way you guys don't have",
    "start": "4275760",
    "end": "4280880"
  },
  {
    "text": "this this PowerPoint presentation because it was uh it was updated yesterday but it will be available on black hat site uh",
    "start": "4280880",
    "end": "4288640"
  },
  {
    "text": "shortly um this is how the alert processing happens determine what host is being",
    "start": "4288640",
    "end": "4294920"
  },
  {
    "text": "attacked and what attack is uh what the attack is by parsing the string check the active alert Q to see if there's an",
    "start": "4294920",
    "end": "4300560"
  },
  {
    "text": "ongoing attack meaning if this is a second alert received for the same host check the host information for the",
    "start": "4300560",
    "end": "4305760"
  },
  {
    "text": "victim determine if attack may or may not suceed based on cve information this is outdated C I don't use CV anymore I",
    "start": "4305760",
    "end": "4312360"
  },
  {
    "text": "have a uh I have a l i have language I I wrote to uh to do this which uh isn't",
    "start": "4312360",
    "end": "4318880"
  },
  {
    "text": "better than CV it it just works better for this tool if if if tech has a good chance to succeed give the host a",
    "start": "4318880",
    "end": "4324400"
  },
  {
    "text": "critical Threat Level if it has a low likelihood of success give a low Threat Level warning so the admins will know something's going on but it's not",
    "start": "4324400",
    "end": "4330560"
  },
  {
    "text": "critical uh check the host information see if there's an active host sensor on it if so send a request to do a self",
    "start": "4330560",
    "end": "4335719"
  },
  {
    "text": "check until otherwise informed response is received then a requ if a response",
    "start": "4335719",
    "end": "4340800"
  },
  {
    "text": "hased that the host been compromised take steps lock the machine down this is what we're talking about the host the n in the IP tables uh if you have a",
    "start": "4340800",
    "end": "4347440"
  },
  {
    "text": "checkpoint or IP IP IP table based firewall you can lock it down uh check",
    "start": "4347440",
    "end": "4352880"
  },
  {
    "text": "to see if any alerts have been acknowledged if so remove them from the alert queue eliminating the false positives these are this is the same",
    "start": "4352880",
    "end": "4358719"
  },
  {
    "text": "example I've been using um most of the day the uh the mssql slam War so we can we can bu that uh this is how uh how it",
    "start": "4358719",
    "end": "4368080"
  },
  {
    "text": "works we we during the SL during the hi of a slim worm we were receiving several million alerts per minute which is",
    "start": "4368080",
    "end": "4376320"
  },
  {
    "text": "which was actually uh bad and this correlation engine uh helped cut a lot of those down so we were able to find",
    "start": "4376320",
    "end": "4383080"
  },
  {
    "text": "just a unique host that were infected with Slammer instead of every alert generated by the host uh vnl is a language I just",
    "start": "4383080",
    "end": "4389639"
  },
  {
    "text": "mentioned vulnerability normalization language what is it it's a way of comparing unlike things it sounds kind of strange but basically it allows you",
    "start": "4389639",
    "end": "4395840"
  },
  {
    "text": "to take two different things like a snort ID and a nessus ID and determine",
    "start": "4395840",
    "end": "4401800"
  },
  {
    "text": "if it going work well uh if the attack is going to succeed uh it's it's used on both the engine and the sensor uh mostly",
    "start": "4401800",
    "end": "4408960"
  },
  {
    "text": "in the engine uh it's a simple language like the uh the communication protocol simple easy to read this is what the vnl",
    "start": "4408960",
    "end": "4416400"
  },
  {
    "text": "protocol looks like and down at the bottom is an example of it",
    "start": "4416400",
    "end": "4423000"
  },
  {
    "text": "um is there any questions on that",
    "start": "4424800",
    "end": "4430239"
  },
  {
    "text": "yes yes next version this was this was my my lots of",
    "start": "4430239",
    "end": "4435840"
  },
  {
    "text": "mistakes version everybody has those have you have you used ISS 1.0 lots of mistakes but 70 is pretty good not",
    "start": "4435840",
    "end": "4442360"
  },
  {
    "text": "that's a vendor picture or anything just just an example uh concerns U bottlenecks too",
    "start": "4442360",
    "end": "4448960"
  },
  {
    "text": "much information created on a large Network that's a possibility man I'm not get PL like that that's sus",
    "start": "4448960",
    "end": "4455360"
  },
  {
    "text": "extendability uh engine should be designed to evolve we've talked about this essential",
    "start": "4455360",
    "end": "4461199"
  },
  {
    "text": "goals um we've talked about all this I I got ahead of myself action on my",
    "start": "4461199",
    "end": "4467560"
  },
  {
    "text": "slides by by explaining some things uh problems you are only as good as your tools meaning that if you're necess if",
    "start": "4467560",
    "end": "4473560"
  },
  {
    "text": "your neus plugins are out of date you are out of date you no longer have a good functioning correlation system you",
    "start": "4473560",
    "end": "4479199"
  },
  {
    "text": "uh you can miss things your IDs rules are the same way um maintenance things that will break communication between",
    "start": "4479199",
    "end": "4484960"
  },
  {
    "text": "the hosts you need to you need to make sure you have a you need to make sure that that's not a",
    "start": "4484960",
    "end": "4491120"
  },
  {
    "text": "problem uh things that will break misconfigure urations we we we originally misconfigure we originally",
    "start": "4491120",
    "end": "4497760"
  },
  {
    "text": "had some bad code to determin every host that had a port open as a critical vulnerable host so you want you want to",
    "start": "4497760",
    "end": "4504840"
  },
  {
    "text": "watch out for those P follows there are many things uh in the future that this will work with almost any open open",
    "start": "4504840",
    "end": "4512000"
  },
  {
    "text": "source tool you can integrate into this commercial tools uh if you're if anybody runs a lanop or a ISS uh or an interes",
    "start": "4512000",
    "end": "4520679"
  },
  {
    "text": "uh IDs we have python code that will extract information from uh from them",
    "start": "4520679",
    "end": "4525960"
  },
  {
    "text": "and uh run it um making the engine more complex more data mining what the next",
    "start": "4525960",
    "end": "4531920"
  },
  {
    "text": "time I give this talk we're going to go it's going to be much better talk but it will go from the uh the very simple basic engine to a more advanced cor uh",
    "start": "4531920",
    "end": "4539239"
  },
  {
    "text": "correlation engine on dark security is anybody familiar with this term dark security is where you protect",
    "start": "4539239",
    "end": "4546560"
  },
  {
    "text": "people you don't know they don't know you're protecting uh which was actually originated by a guy named Thad Starner",
    "start": "4546560",
    "end": "4552679"
  },
  {
    "text": "who does who does a lot of ubiquitous computing stuff uh it came out of a uh",
    "start": "4552679",
    "end": "4558120"
  },
  {
    "text": "experiment where people on a Navy ship wore badges uh that would talked to an RFID when it walked through the door so",
    "start": "4558120",
    "end": "4563920"
  },
  {
    "text": "they could plot the path of a person walking um so basically a captain of a ship could tell where people were at any",
    "start": "4563920",
    "end": "4570040"
  },
  {
    "text": "time uh but people really don't know that's how it works so it's it's",
    "start": "4570040",
    "end": "4576199"
  },
  {
    "text": "something similar one of one of the things a correlation engine does is everybody has security badges um they",
    "start": "4576199",
    "end": "4581320"
  },
  {
    "text": "allow you to badge in and out of buildings checking in the morning and whatnot one of the things that my correlation engine the current version",
    "start": "4581320",
    "end": "4587120"
  },
  {
    "text": "We Run does is check to see if you're in the office if you're in the office and your machine if you're not in the office and your machine is doing a lot of",
    "start": "4587120",
    "end": "4592920"
  },
  {
    "text": "traffic uh that's that's kind of strange now if if if you've connected to your machine from home and you're doing a lot",
    "start": "4592920",
    "end": "4598920"
  },
  {
    "text": "of traffic that's one thing but if it's looking for things that are compromised while you're not there if it's 3:00 a.m.",
    "start": "4598920",
    "end": "4604639"
  },
  {
    "text": "and your machine's doing 40 megabits of traffic there there's only something wrong with that",
    "start": "4604639",
    "end": "4610520"
  },
  {
    "text": "uh that that's one of the examples of the more abstract things that be that can be added to the correlation",
    "start": "4610520",
    "end": "4616520"
  },
  {
    "text": "engine um more types of sensors we talked about this basically any kind of Open Source",
    "start": "4616520",
    "end": "4622679"
  },
  {
    "text": "tool and hope that was it yep any",
    "start": "4622679",
    "end": "4629159"
  },
  {
    "text": "questions comments suggestions should I stop speaking publicly I think I should",
    "start": "4629159",
    "end": "4636440"
  },
  {
    "text": "yes no um the",
    "start": "4640480",
    "end": "4646239"
  },
  {
    "text": "that was a a part and as soon as you mentioned I realized I left that entire thing out of the out of the speech the",
    "start": "4646239",
    "end": "4651520"
  },
  {
    "text": "uh there's basically a the vnl where you write rules that say this snort ID can't",
    "start": "4651520",
    "end": "4658400"
  },
  {
    "text": "be penetrated by this machine uh so your engine basically checks the vnl for",
    "start": "4658400",
    "end": "4665400"
  },
  {
    "text": "what's uh what's vulnerable what's not so when it gets a snort ID U with the Sid it it checks uh it checks against",
    "start": "4665400",
    "end": "4671760"
  },
  {
    "text": "the uh the the vnl rules to see if that Sid is vulnerable by anything on that that's currently running on that",
    "start": "4671760",
    "end": "4679520"
  },
  {
    "text": "machine yes that's the mangual process but after",
    "start": "4681120",
    "end": "4687440"
  },
  {
    "text": "that it's all animated uh you generate those by hand",
    "start": "4687440",
    "end": "4693280"
  },
  {
    "text": "was that what you were asking oh okay yeah those those those you actually write those much much like he would",
    "start": "4693280",
    "end": "4699000"
  },
  {
    "text": "write a snort rule uh that basically says uh this this uh this Sid campign",
    "start": "4699000",
    "end": "4706000"
  },
  {
    "text": "trading machine with this uh with this nesus ID so that lets you put only only attacks you're really interested in in",
    "start": "4706000",
    "end": "4712320"
  },
  {
    "text": "putting in place for instance both have a lot of really esoteric attacks that you probably never see like attacks",
    "start": "4712320",
    "end": "4718159"
  },
  {
    "text": "against Alcatel phones we've never actually seen that so we prun that rule out uh so we we only have things we're",
    "start": "4718159",
    "end": "4724040"
  },
  {
    "text": "interested in in our VL yes",
    "start": "4724040",
    "end": "4730679"
  },
  {
    "text": "sir yeah that was the other part I left out uh the I'm I'm I'm really sorry this is the",
    "start": "4731360",
    "end": "4736760"
  },
  {
    "text": "first time i' I've done public speaking like this but uh what it is is a PHP front end to the uh to the database and",
    "start": "4736760",
    "end": "4744760"
  },
  {
    "text": "it's it's really simple to write I I picked PHP because PHP is really simple to write and extend",
    "start": "4744760",
    "end": "4751960"
  },
  {
    "text": "sir yes sir",
    "start": "4751960",
    "end": "4756120"
  },
  {
    "text": "this the the engine I'm describing here was the absolute first engine we wrote which was being released open source the current engine uh if a vulnerability",
    "start": "4778920",
    "end": "4787040"
  },
  {
    "text": "scan detects a host that is currently vulnerable to something it will send an alert to a intrusion sensor to up the uh",
    "start": "4787040",
    "end": "4794880"
  },
  {
    "text": "uh the watchability of that host is what we call we call it the watch Level so it it it it it keeps logging for that host",
    "start": "4794880",
    "end": "4801280"
  },
  {
    "text": "a little bit longer than than it does other hosts uh so basically what we want is it",
    "start": "4801280",
    "end": "4806840"
  },
  {
    "text": "triggering off both the intrusion and the vulnerability",
    "start": "4806840",
    "end": "4811000"
  },
  {
    "text": "side right right right right well this is this is the 8020 solution we're trying to get as much as possible in the",
    "start": "4817520",
    "end": "4823239"
  },
  {
    "text": "first version um the next version there's there's different kinds of",
    "start": "4823239",
    "end": "4828679"
  },
  {
    "text": "intrusion sensors which will uh help mitigate some of those those",
    "start": "4828679",
    "end": "4834719"
  },
  {
    "text": "doubts because is I I also doubt that snort is going to catch every attack but",
    "start": "4834719",
    "end": "4840280"
  },
  {
    "text": "it's a better start than",
    "start": "4840280",
    "end": "4843239"
  },
  {
    "text": "nothing yes",
    "start": "4845639",
    "end": "4849639"
  },
  {
    "text": "uh it took a month or so to go",
    "start": "4873920",
    "end": "4879199"
  },
  {
    "text": "from idea to production we saw a reduction down to about 3 ,000 alerts a",
    "start": "4879199",
    "end": "4885440"
  },
  {
    "text": "day from around 10 million which made it much more manageable on our",
    "start": "4885440",
    "end": "4891120"
  },
  {
    "text": "part oh that was just me it took about a month but well there yeah there are 24 hours a",
    "start": "4894080",
    "end": "4901280"
  },
  {
    "text": "day this was mostly done not not not because not not for Georgia Tech but because I just wanted to write a tool",
    "start": "4901280",
    "end": "4907960"
  },
  {
    "text": "that that that would do this that could be released open source yeah",
    "start": "4907960",
    "end": "4915960"
  },
  {
    "text": "well I don't have much of a life I just code I'm sure a lot of people share that",
    "start": "4915960",
    "end": "4921000"
  },
  {
    "text": "senent so it it didn't it wasn't really that much of a change it was it was a month of uh evenings and",
    "start": "4921000",
    "end": "4926760"
  },
  {
    "text": "weekends uh and the biggest part was the testing to make sure that everything scaled well because I would design",
    "start": "4926760",
    "end": "4933320"
  },
  {
    "text": "initially on my network at home and then I would go in install a couple sensors and I would go from generating like 15",
    "start": "4933320",
    "end": "4939600"
  },
  {
    "text": "to 20 alerts a minute to generating 15 to 20,000 alerts a minute and that would that that would kill the code so it had",
    "start": "4939600",
    "end": "4946159"
  },
  {
    "text": "to be I had a a learning period of making sure it scaled",
    "start": "4946159",
    "end": "4952040"
  },
  {
    "text": "well we haven't seen a top end uh is anybody familiar with the spike fuzzer by",
    "start": "4952159",
    "end": "4958199"
  },
  {
    "text": "davel uh we we we fuzz it a lot and it hasn't crashed yet so we we don't I",
    "start": "4958199",
    "end": "4963719"
  },
  {
    "text": "don't have a theoretical maximum it's based on the hardware you're running it on and your there's so many smaller",
    "start": "4963719",
    "end": "4969440"
  },
  {
    "text": "parts that would uh would make up your maximum number of alerts you can handle per minute or per day or whatnot",
    "start": "4969440",
    "end": "4976440"
  },
  {
    "text": "your yes uh it's posic threaded which is",
    "start": "4977560",
    "end": "4982600"
  },
  {
    "text": "what my my engine is designed to run on a Linux machine uh I'm working on the the python and whatnot for Windows",
    "start": "4982600",
    "end": "4988679"
  },
  {
    "text": "machines uh I don't think I'm going to report the engine to Windows but it will it works well on Linux",
    "start": "4988679",
    "end": "4997000"
  },
  {
    "text": "yes well we had to implement some data reduction uh we six months ago we can't",
    "start": "5000560",
    "end": "5005719"
  },
  {
    "text": "see everything we can see on the same host today um we can see six months ago",
    "start": "5005719",
    "end": "5012000"
  },
  {
    "text": "we can see the host and the information uh like the operating system type and whatnot we don't keep the",
    "start": "5012000",
    "end": "5018040"
  },
  {
    "text": "vulnerability uh information after a month or the the open port information but we keep that it was found we use",
    "start": "5018040",
    "end": "5024320"
  },
  {
    "text": "MySQL and it uh it scales pretty well although it's designed where you can",
    "start": "5024320",
    "end": "5029600"
  },
  {
    "text": "remove MySQL and drop in any database you want as long as a SQL compliant database",
    "start": "5029600",
    "end": "5034960"
  },
  {
    "text": "and I didn't tell you guys where to get the tool it it'll be on the black hat side as well should have a checklist of things I",
    "start": "5034960",
    "end": "5041000"
  },
  {
    "text": "forgot any any other questions comments suggestions",
    "start": "5041000",
    "end": "5047719"
  },
  {
    "text": "yes Spike well the uh the that's not so much for uh for testing the tool as",
    "start": "5049880",
    "end": "5058080"
  },
  {
    "text": "testing uh testing the load and the the quality of the code itself are you",
    "start": "5058080",
    "end": "5064840"
  },
  {
    "text": "familiar with the spike fuzzer uh well there's there's a guy running around here named David Tel and",
    "start": "5064840",
    "end": "5071440"
  },
  {
    "text": "if if you stop him asking about he'll tell you all about it but basically it's a a testing methodology where you generate everything that could possibly",
    "start": "5071440",
    "end": "5078000"
  },
  {
    "text": "be seen and throw it at the engine and see what happens uh so we haven't we haven't had a crash under heavy load but",
    "start": "5078000",
    "end": "5084639"
  },
  {
    "text": "I can accurately gauge what it scales to based on uh Hardware requirements and",
    "start": "5084639",
    "end": "5092440"
  },
  {
    "text": "whatnot any other questions oh",
    "start": "5092440",
    "end": "5096320"
  },
  {
    "text": "yes uh about 900 gigabytes we have it in a it's run it's",
    "start": "5100679",
    "end": "5106239"
  },
  {
    "text": "being stored on a sunbox uh v880 with a bunch of 73 gig",
    "start": "5106239",
    "end": "5112280"
  },
  {
    "text": "discs yes well right now uh we don't handle it",
    "start": "5112280",
    "end": "5119560"
  },
  {
    "text": "very well we're going to replace the mySQL database with an Oracle database um",
    "start": "5119560",
    "end": "5124960"
  },
  {
    "text": "and rewrite a lot of uh a lot of the the simpley that we're we're uh we're the",
    "start": "5124960",
    "end": "5132400"
  },
  {
    "text": "the the minus API with plsql stuff to make it",
    "start": "5132400",
    "end": "5136719"
  },
  {
    "text": "faster can do in a period of",
    "start": "5141960",
    "end": "5145920"
  },
  {
    "text": "time we can do close to 700 per second and that's running on a dual",
    "start": "5147520",
    "end": "5153520"
  },
  {
    "text": "processor 2. 4 GHz machine uh running a 24820 kernel right now with a",
    "start": "5153520",
    "end": "5162760"
  },
  {
    "text": "uh oh I'm sorry uh that's on a 2.4 GHz uh Linux machine with a uh 2418 uh Linux",
    "start": "5162880",
    "end": "5171199"
  },
  {
    "text": "kernel with a uh with a Ultra 160 um",
    "start": "5171199",
    "end": "5176280"
  },
  {
    "text": "drive or drives that's the uh that's mySQL database uh now what we do is after an",
    "start": "5176280",
    "end": "5183400"
  },
  {
    "text": "amount of time we will replicate that database to uh to a machine with uh much more space which is the sun",
    "start": "5183400",
    "end": "5191678"
  },
  {
    "text": "v88 we don't insert directly into the va8 we we have a a",
    "start": "5193920",
    "end": "5200480"
  },
  {
    "text": "mediator any other questions thank you for",
    "start": "5201920",
    "end": "5209119"
  },
  {
    "text": "coming please really as I as I mentioned this is is my first speech so if if some of you want to say around and tell me",
    "start": "5211800",
    "end": "5217239"
  },
  {
    "text": "why I did wrong I'd be more than happy to talk to you thanks a",
    "start": "5217239",
    "end": "5222480"
  },
  {
    "text": "lot",
    "start": "5243119",
    "end": "5246119"
  },
  {
    "text": "e for",
    "start": "5273119",
    "end": "5277159"
  }
]