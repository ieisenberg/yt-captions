[
  {
    "start": "0",
    "end": "12000"
  },
  {
    "text": "good morning our welcome to the session evading active directory evading",
    "start": "30",
    "end": "6930"
  },
  {
    "text": "Microsoft a da for Active Directory domination I am nickel-metal speaker for this talk",
    "start": "6930",
    "end": "13580"
  },
  {
    "start": "12000",
    "end": "83000"
  },
  {
    "text": "before we begin couple of things about me I'm a red teamer hacker speak a lot",
    "start": "13580",
    "end": "20910"
  },
  {
    "text": "at conferences trainer conferences I'm with pentesteracademy.com you can find",
    "start": "20910",
    "end": "26279"
  },
  {
    "text": "me on twitter as nikhil underscore mi TT so please go follow me i blog on lab of",
    "start": "26279",
    "end": "33450"
  },
  {
    "text": "a penetration tester calm which is my home on the interwebs and all my ongoing",
    "start": "33450",
    "end": "40950"
  },
  {
    "text": "projects works research whatever i like to blog about it there I maintain to",
    "start": "40950",
    "end": "46980"
  },
  {
    "text": "open-source tool kits on github you can find me as Samrat ashok on github account alia and nishang Caudill is a",
    "start": "46980",
    "end": "54270"
  },
  {
    "text": "toolkit which you can use to create ready to use caches for arduino based",
    "start": "54270",
    "end": "60719"
  },
  {
    "text": "devices you burn it to a unit device plug it into to a box and it will do",
    "start": "60719",
    "end": "66000"
  },
  {
    "text": "interesting stuff for you and nation is there are some there are more users of",
    "start": "66000",
    "end": "71430"
  },
  {
    "text": "nishan it's a framework or collection of powershell scripts which we can use in",
    "start": "71430",
    "end": "77549"
  },
  {
    "text": "various phases of penetration test alright I'm generally interested in",
    "start": "77549",
    "end": "84380"
  },
  {
    "text": "different ways of breaking into the machines where of course I have the permission to do so and if there are",
    "start": "84380",
    "end": "91950"
  },
  {
    "text": "difference tools which come in my way while doing that I would generally like",
    "start": "91950",
    "end": "98100"
  },
  {
    "text": "to find bypasses I previously spoken at Def Con blackhat multiple times",
    "start": "98100",
    "end": "104159"
  },
  {
    "text": "trained at cancer cursed and few more conferences so what we are going to",
    "start": "104159",
    "end": "109409"
  },
  {
    "start": "107000",
    "end": "200000"
  },
  {
    "text": "discuss here is we'll start with what a TAS if what is the architecture if there are",
    "start": "109409",
    "end": "116280"
  },
  {
    "text": "there are some of you who have not seen it or do not know about it we'll quickly",
    "start": "116280",
    "end": "121439"
  },
  {
    "text": "go through it what are the detections what are the kind of attacks which 8080",
    "start": "121439",
    "end": "127710"
  },
  {
    "text": "detects what are the alerts how they are managed etc then we'll and see how we can as as a good attacker",
    "start": "127710",
    "end": "139160"
  },
  {
    "text": "how it is possible to bypass 88 headline attacks like and useful ones as well as",
    "start": "139160",
    "end": "145700"
  },
  {
    "text": "one like oh pass the hash golden ticket etc how is it possible to use them and",
    "start": "145700",
    "end": "151970"
  },
  {
    "text": "still not get detected then we'll move on see how we can modify our attack",
    "start": "151970",
    "end": "158450"
  },
  {
    "text": "chains or penetration testing methodology or whatever you want to call it to simply avoid talking to the domain",
    "start": "158450",
    "end": "166310"
  },
  {
    "text": "controller and the say TA then we'll have a look at couple of attack chains",
    "start": "166310",
    "end": "171739"
  },
  {
    "text": "or methodologies which assuming the domain administration domain admin",
    "start": "171739",
    "end": "177049"
  },
  {
    "text": "privileges are the goal and so domain dominance that is once you have domain",
    "start": "177049",
    "end": "182269"
  },
  {
    "text": "admin privileges you can clearly have a domination over a domain then next comes",
    "start": "182269",
    "end": "188690"
  },
  {
    "text": "attacking a TA or once that we have enough privileges is it possible to",
    "start": "188690",
    "end": "196069"
  },
  {
    "text": "attack a TA in some sense or some method then we'll conclude with that so what is",
    "start": "196069",
    "end": "202160"
  },
  {
    "start": "200000",
    "end": "223000"
  },
  {
    "text": "Microsoft a TA so I'll read out the definition advanced threat analytics a",
    "start": "202160",
    "end": "207829"
  },
  {
    "text": "TA is an on-premises platform that helps protect your enterprise from multiple",
    "start": "207829",
    "end": "214790"
  },
  {
    "text": "types of advanced targeted cyber attacks and insider threats pretty common when",
    "start": "214790",
    "end": "219829"
  },
  {
    "text": "the definition so how it works is whatever is the traffic being sent to",
    "start": "219829",
    "end": "227450"
  },
  {
    "start": "223000",
    "end": "249000"
  },
  {
    "text": "your domain controller one of the domain controls or all of them depends on the type of implementation you want it reads",
    "start": "227450",
    "end": "233989"
  },
  {
    "text": "certain protocols what protocols like Kerberos DNS LDAP SMB etc the read this",
    "start": "233989",
    "end": "241700"
  },
  {
    "text": "tool or the censors of this tool reads those protocols and then try to detect",
    "start": "241700",
    "end": "247359"
  },
  {
    "text": "an attacker in two ways anomaly and user",
    "start": "247359",
    "end": "253639"
  },
  {
    "text": "behavior UBA so in this talk we are going to focus on the animal based attacks which attack on day 180 has I",
    "start": "253639",
    "end": "261169"
  },
  {
    "text": "think 21 days of learning period before it can start in this 21 days period it builds a",
    "start": "261169",
    "end": "268760"
  },
  {
    "text": "profile of each and every user and box and then it can actually detect UBA or",
    "start": "268760",
    "end": "274820"
  },
  {
    "text": "behavior a detection but the animal detection starts from day one and that",
    "start": "274820",
    "end": "280490"
  },
  {
    "text": "is something which we are going to focus on on the talk the lab configuration",
    "start": "280490",
    "end": "287480"
  },
  {
    "start": "283000",
    "end": "339000"
  },
  {
    "text": "which I have used and which I'll be going to use for the live demonstrations so I've worked on a TA one dot sound",
    "start": "287480",
    "end": "294680"
  },
  {
    "text": "then 1.8 came I came out like last month tested interesting things on that as",
    "start": "294680",
    "end": "299930"
  },
  {
    "text": "well the ATS sensors for installation in my",
    "start": "299930",
    "end": "305120"
  },
  {
    "text": "environment it has been used in my classes as well so more than 400 attackers students have tested their",
    "start": "305120",
    "end": "311660"
  },
  {
    "text": "hands on so one thing I can guarantee you that the bypass is we which we have",
    "start": "311660",
    "end": "318950"
  },
  {
    "text": "a look at here have been thoroughly tested I am using so there are two ways",
    "start": "318950",
    "end": "324380"
  },
  {
    "text": "of implementation of ETA I am using a lightweight gateway that is the sensor",
    "start": "324380",
    "end": "330290"
  },
  {
    "text": "is living on to the domain controller it's not a separate box so that doesn't make any difference to the detection as",
    "start": "330290",
    "end": "337130"
  },
  {
    "text": "far as I know we're just wanting to let that out so the threats of interests",
    "start": "337130",
    "end": "343040"
  },
  {
    "start": "339000",
    "end": "560000"
  },
  {
    "text": "which ata detects it it takes so many things so for my particular methodology",
    "start": "343040",
    "end": "348260"
  },
  {
    "text": "I always saw these detection if I'm not trying to bypass a tour in the initial",
    "start": "348260",
    "end": "355660"
  },
  {
    "text": "days when I found out what a T is and how it detects things these are some of the attacks which it detects so in",
    "start": "355660",
    "end": "363110"
  },
  {
    "text": "Drakon phase account a numeration you know if you would like to get interesting data from the domain like",
    "start": "363110",
    "end": "369380"
  },
  {
    "text": "list of computers member computers users interesting group memberships leadership",
    "start": "369380",
    "end": "375830"
  },
  {
    "text": "like domain admins Enterprise admins etc then compromised credentials brute-force",
    "start": "375830",
    "end": "382040"
  },
  {
    "text": "attacks unusual protocol implementation we'll see what this is abnormal behavior",
    "start": "382040",
    "end": "388840"
  },
  {
    "text": "so for me once again we are not going to focus on abnormal behavior detection is here but that's something which",
    "start": "388840",
    "end": "394669"
  },
  {
    "text": "interested me initially then in the lateral movement face and is 488 really kicks in attacks like",
    "start": "394669",
    "end": "402890"
  },
  {
    "text": "golden ticket or pasta hash reuse of tokens remote code execution attempts on",
    "start": "402890",
    "end": "408490"
  },
  {
    "text": "on to the domain controller and of course domain dominance so so we are",
    "start": "408490",
    "end": "414290"
  },
  {
    "text": "golden ticket comes over here and malicious replications free quests our famous DC sync attack so all of this has",
    "start": "414290",
    "end": "420500"
  },
  {
    "text": "been taken from the Microsoft documentation now let's quickly jump in",
    "start": "420500",
    "end": "426050"
  },
  {
    "text": "and see how an attacker gets detected so this is an example if you run any tool",
    "start": "426050",
    "end": "433100"
  },
  {
    "text": "like net view or Power View or even the simple net commands let's say you run net probe domain admins slash domain",
    "start": "433100",
    "end": "440240"
  },
  {
    "text": "this is something which your ATM console will show you now recon using directory",
    "start": "440240",
    "end": "447710"
  },
  {
    "text": "services and emulation or reckon using Assembly session enumeration with a medium severity which is fine I mean",
    "start": "447710",
    "end": "455390"
  },
  {
    "text": "direct getting your record detected is fine as long as you are not dealing with",
    "start": "455390",
    "end": "463190"
  },
  {
    "text": "an organization which takes its you know security really seriously later on when",
    "start": "463190",
    "end": "470030"
  },
  {
    "text": "we'll have a look at the console you will see that not only this is detected or let me show you that right away this",
    "start": "470030",
    "end": "476750"
  },
  {
    "text": "is how it looks like on to the ATA console so if I have an SMB session",
    "start": "476750",
    "end": "485660"
  },
  {
    "text": "enumeration right here this so you can",
    "start": "485660",
    "end": "493550"
  },
  {
    "text": "not only see that it was done against the domain controller but from the box",
    "start": "493550",
    "end": "499550"
  },
  {
    "text": "from the user so that makes when when I first encountered that encountered a TA",
    "start": "499550",
    "end": "505900"
  },
  {
    "text": "this is the thing which worried me your session enumeration getting detected or",
    "start": "505900",
    "end": "510920"
  },
  {
    "text": "raising couple of flags which gets marked as resolve is fine but this tool can pinpoint on a particular box and",
    "start": "510920",
    "end": "518510"
  },
  {
    "text": "user which was ready for me at the very first time this slowly you once you",
    "start": "518510",
    "end": "526430"
  },
  {
    "text": "start playing with a TA you get to understand how it detects things for example in case",
    "start": "526430",
    "end": "533030"
  },
  {
    "text": "any work on a TA generally at least up to 1.7 88 does not really mind DC giving",
    "start": "533030",
    "end": "542750"
  },
  {
    "text": "out the information that is if you ask give me the list of computers it's fine",
    "start": "542750",
    "end": "548530"
  },
  {
    "text": "give me the membership of domain admins group that's fine as well as long as then you do not go back to the DC and do",
    "start": "548530",
    "end": "555770"
  },
  {
    "text": "some intrusive enumeration and now that's what's that intrusive enumeration we'll come back to that in a moment so",
    "start": "555770",
    "end": "563750"
  },
  {
    "start": "560000",
    "end": "709000"
  },
  {
    "text": "if you do not use we are going to use Power View here in this demo which I",
    "start": "563750",
    "end": "569120"
  },
  {
    "text": "have ready for you if you are not using your tools blindly and know what they do",
    "start": "569120",
    "end": "575030"
  },
  {
    "text": "it is not really hard to bypass 8-year so a not poking the DC once again not",
    "start": "575030",
    "end": "583580"
  },
  {
    "text": "poking the DC is the key understand this ATA looks at all the traffic which goes",
    "start": "583580",
    "end": "589220"
  },
  {
    "text": "to the DC some protocols which goes to the DC so as long as you are talking to the deceive you in a really normal way",
    "start": "589220",
    "end": "596270"
  },
  {
    "text": "normal conversation or avoiding it at all you won't be detected so let's have",
    "start": "596270",
    "end": "603620"
  },
  {
    "text": "a look at the example of hunting for a domain admin token also called user",
    "start": "603620",
    "end": "609530"
  },
  {
    "text": "hunting a very very popular method with the red teamers so in power view use",
    "start": "609530",
    "end": "615140"
  },
  {
    "text": "invoke user hunter for this what this hunting means you go to the domain",
    "start": "615140",
    "end": "621050"
  },
  {
    "text": "controller asks us for two things first give me a list of all the boxes second",
    "start": "621050",
    "end": "627500"
  },
  {
    "text": "give me the list of the domain admins then it goes to each and every box and",
    "start": "627500",
    "end": "633110"
  },
  {
    "text": "asks for two things give me the current sessions and current logins and then the",
    "start": "633110",
    "end": "638420"
  },
  {
    "text": "tool matches if current session our current logon users has membership of",
    "start": "638420",
    "end": "644060"
  },
  {
    "text": "the domain admins which it has that's how these are hunting works now yep so",
    "start": "644060",
    "end": "653030"
  },
  {
    "text": "the way to bypass it is this when you run a run and I'm taking power of you",
    "start": "653030",
    "end": "660200"
  },
  {
    "text": "just as an example because I work a lot on PowerShell and that's an awesome tool",
    "start": "660200",
    "end": "665770"
  },
  {
    "text": "if you request a list of machines from a domain controller before running Power",
    "start": "666010",
    "end": "672370"
  },
  {
    "text": "View blindly on that because when you run invoke user enter once again it automatically fetches the list of all",
    "start": "672370",
    "end": "677950"
  },
  {
    "text": "boxes and runs enumeration on them make sure that you do not run that user",
    "start": "677950",
    "end": "684730"
  },
  {
    "text": "hunting specifically on to the domain controller that's it if you do that and if I would like to",
    "start": "684730",
    "end": "692740"
  },
  {
    "text": "show a demonstration of that in a moment if you do that that doesn't get detected",
    "start": "692740",
    "end": "697930"
  },
  {
    "text": "retrieve the information from the DC like computer names and domain admin membership but do not retrieve",
    "start": "697930",
    "end": "704170"
  },
  {
    "text": "information like currently logged on users or current sessions and you will be good another interesting record",
    "start": "704170",
    "end": "711820"
  },
  {
    "start": "709000",
    "end": "736000"
  },
  {
    "text": "mechanism which ata can't catch is SP and scanning so those of you who are not",
    "start": "711820",
    "end": "717640"
  },
  {
    "text": "aware so a service principle link is used by Kerberos to keep track of",
    "start": "717640",
    "end": "723070"
  },
  {
    "text": "service accounts in an Active Directory environment to put it the easy way if",
    "start": "723070",
    "end": "728350"
  },
  {
    "text": "you do Espeon scanning once again for which you can use individual scripts or Power View that doesn't get detected as",
    "start": "728350",
    "end": "735100"
  },
  {
    "text": "well so let's have a look at how we can",
    "start": "735100",
    "end": "740440"
  },
  {
    "start": "736000",
    "end": "997000"
  },
  {
    "text": "actually use Power View and still evade detection so we have 80 a 1.8 here so",
    "start": "740440",
    "end": "754060"
  },
  {
    "text": "there has been no detection up to now now what I do here this machine Alondra",
    "start": "754060",
    "end": "761980"
  },
  {
    "text": "to and please do don't do or do to me from the Wi-Fi what this machine does has it's a part of the domain the user",
    "start": "761980",
    "end": "769480"
  },
  {
    "text": "is not any special user I don't think he not even a local admin on the box or if",
    "start": "769480",
    "end": "775510"
  },
  {
    "text": "it is that's the max privileges it has it's a normal domain user so what we can",
    "start": "775510",
    "end": "780610"
  },
  {
    "text": "do with these privileges if this mis'able till the back the the partial session",
    "start": "780610",
    "end": "786060"
  },
  {
    "text": "yes thanks so and I'm not going to do any recorded demos so let's see how it",
    "start": "786060",
    "end": "794260"
  },
  {
    "text": "goes let's load power view here I think it is",
    "start": "794260",
    "end": "805150"
  },
  {
    "text": "jicama now not using invoke user hunter",
    "start": "805150",
    "end": "812830"
  },
  {
    "text": "directly what we can do is something like this so we get a list of all the",
    "start": "812830",
    "end": "821950"
  },
  {
    "text": "boxes in this domain right next thing which we can run is this which is not",
    "start": "821950",
    "end": "828490"
  },
  {
    "text": "required although we can leave this part to invoke user hunter but just in case",
    "start": "828490",
    "end": "835150"
  },
  {
    "text": "let's see what are the different domain",
    "start": "835150",
    "end": "845710"
  },
  {
    "text": "admins so there are two domain admins so",
    "start": "845710",
    "end": "857230"
  },
  {
    "text": "what we would have done or what many of us red teamers are guilty of doing is",
    "start": "857230",
    "end": "862390"
  },
  {
    "text": "something like this after these obligatory domain enumeration things what we do is simply something like this",
    "start": "862390",
    "end": "870550"
  },
  {
    "text": "invoke user hunter and then we wait invoke user and terror power does it's",
    "start": "870550",
    "end": "876730"
  },
  {
    "text": "magic then it tried to target that box where a domain admin is logged in which is almost correct just have a look at",
    "start": "876730",
    "end": "886270"
  },
  {
    "text": "the list returned by DD see it lists itself as well right so the only",
    "start": "886270",
    "end": "892900"
  },
  {
    "text": "modification you need to do here is save this list to a file let's say this o the",
    "start": "892900",
    "end": "900730"
  },
  {
    "text": "font is really small",
    "start": "900730",
    "end": "903570"
  },
  {
    "text": "something like this even if this is not visible what we have changed here is the",
    "start": "908010",
    "end": "914620"
  },
  {
    "text": "first box that is let's just not run user hunting on to the DC what we'll do",
    "start": "914620",
    "end": "922240"
  },
  {
    "text": "in place of that is this we're going to",
    "start": "922240",
    "end": "931120"
  },
  {
    "text": "use the computer file option which comes with power view Pass or list of",
    "start": "931120",
    "end": "936310"
  },
  {
    "text": "computers and now if you see it doesn't",
    "start": "936310",
    "end": "941380"
  },
  {
    "text": "go to the DC to get a list of the boxes because we have provided that and now it",
    "start": "941380",
    "end": "949270"
  },
  {
    "text": "goes to each and every box and looks for if there is a box where our domain admin is logged in and that is it",
    "start": "949270",
    "end": "956190"
  },
  {
    "text": "81 detected why because you have not executed the inclusives intuitive enumeration against the domain",
    "start": "956190",
    "end": "963280"
  },
  {
    "text": "controller just very normal things you know getting a list of boxes it's almost this thing so that's what we did when we",
    "start": "963280",
    "end": "973390"
  },
  {
    "text": "run get net computer that's how you",
    "start": "973390",
    "end": "979360"
  },
  {
    "text": "avoid rec on and is this powerful really you can use this against any sort of enumeration if you are going to have a",
    "start": "979360",
    "end": "986410"
  },
  {
    "text": "look for local admin access on all the boxes use computer file parameter just avoid the intrusion one for the DC",
    "start": "986410",
    "end": "995110"
  },
  {
    "text": "that's that's a trick now brute force how many of you actually use brute",
    "start": "995110",
    "end": "1002490"
  },
  {
    "start": "997000",
    "end": "1199000"
  },
  {
    "text": "forcing in Active Directory environments come on is there no one who uses brute",
    "start": "1002490",
    "end": "1008880"
  },
  {
    "text": "force attacks in Active Directory yeah one of you Wow so of course you should",
    "start": "1008880",
    "end": "1016680"
  },
  {
    "text": "you should use Active Directory force in Active Directory environments just use a modified version use a single password",
    "start": "1016680",
    "end": "1023520"
  },
  {
    "text": "and try to get across the boxes you know there is no password policy in the world",
    "start": "1023520",
    "end": "1029910"
  },
  {
    "text": "in production and I there won't be any which law which locks a user account on",
    "start": "1029910",
    "end": "1035280"
  },
  {
    "text": "a single wrong attempt right and that's that's a well-known trick really well known one so if we do this there's no detection as",
    "start": "1035280",
    "end": "1043959"
  },
  {
    "text": "well so how a normal one gets detected it gets directed like this so that's a",
    "start": "1043960",
    "end": "1054070"
  },
  {
    "text": "normal root force when you try multiple passwords against a user accesses number",
    "start": "1054070",
    "end": "1062050"
  },
  {
    "text": "of authentication failures five zero sound within few seconds so if you actually run walk with a TA and try to",
    "start": "1062050",
    "end": "1070000"
  },
  {
    "text": "see how it detects things it's once",
    "start": "1070000",
    "end": "1075370"
  },
  {
    "text": "again it's not really hard to get around it so if we go here of the next thing",
    "start": "1075370",
    "end": "1086290"
  },
  {
    "text": "which we are going to use is in the brute force group which in this part of",
    "start": "1086290",
    "end": "1091330"
  },
  {
    "text": "the nishang toolkit let's run it",
    "start": "1091330",
    "end": "1099149"
  },
  {
    "text": "so small no directory or dictionaries",
    "start": "1110650",
    "end": "1116920"
  },
  {
    "text": "are not directly a small dictionary just 500 or some passwords it's the same one which was used when there was detection",
    "start": "1116920",
    "end": "1123670"
  },
  {
    "text": "what we did we tried a single password across the Active Directory single",
    "start": "1123670",
    "end": "1131800"
  },
  {
    "text": "password for each user that's a well-known technique doesn't get detected and now once we we are through",
    "start": "1131800",
    "end": "1146350"
  },
  {
    "text": "the enumeration part the next one or where the the actual meat is the labor movement part so what we have done so",
    "start": "1146350",
    "end": "1154690"
  },
  {
    "text": "the demonstrations are not freely connected for a reason which we'll get to know later on we started with",
    "start": "1154690",
    "end": "1160600"
  },
  {
    "text": "enumeration found out that domain admin is logged in into a box then we brute force let's say a domain",
    "start": "1160600",
    "end": "1166660"
  },
  {
    "text": "user which is a local admin on that particular box right that makes sense now once we are local administrator on",
    "start": "1166660",
    "end": "1174520"
  },
  {
    "text": "that box where the domain admin token is available we can let's say we got our hands on to the credentials of the",
    "start": "1174520",
    "end": "1181450"
  },
  {
    "text": "domain admin by croatians I mean it's secrets ntlm hash AES keys what over",
    "start": "1181450",
    "end": "1188559"
  },
  {
    "text": "pasta hash attack is you can create valid Kerberos tickets from ntlm hash or ES keys so Benjamin the guy who wrote",
    "start": "1188559",
    "end": "1195760"
  },
  {
    "text": "mimic ants as a detailed blog post about this you can have a look at it now when",
    "start": "1195760",
    "end": "1202270"
  },
  {
    "start": "1199000",
    "end": "1354000"
  },
  {
    "text": "you create a session with the domain controller that is you establish the",
    "start": "1202270",
    "end": "1208990"
  },
  {
    "text": "connection you want to want access to a resource when you requested at EDD Eric",
    "start": "1208990",
    "end": "1215410"
  },
  {
    "text": "is the packet which gets sent and I don't know if that's visible or not but this is how it looks like when it is",
    "start": "1215410",
    "end": "1222220"
  },
  {
    "text": "normal e type so in the pre pre auth data there is a field called e type which is",
    "start": "1222220",
    "end": "1228400"
  },
  {
    "text": "aes-256 c TSH McAfee t1 something which",
    "start": "1228400",
    "end": "1234070"
  },
  {
    "text": "is the normal one this is something which you got to have a look at when",
    "start": "1234070",
    "end": "1239200"
  },
  {
    "text": "you're using clear text passwords but as soon as you use ntlm hash for",
    "start": "1239200",
    "end": "1247110"
  },
  {
    "text": "creating an overpass the hash attack or creating a Kerberos ticket and then you request a TGT from the KDC or the domain",
    "start": "1247110",
    "end": "1255390"
  },
  {
    "text": "controller or the key distribution center that's following the same thing then you get to see this the e type is",
    "start": "1255390",
    "end": "1265080"
  },
  {
    "text": "two ungraded to our 4-h Mac md5 and that's what and this is the command",
    "start": "1265080",
    "end": "1272010"
  },
  {
    "text": "which most of us use right you know the username the domain and the ntlm hash",
    "start": "1272010",
    "end": "1278300"
  },
  {
    "text": "this is what a tier detects exactly this is the type of anomalies which is which",
    "start": "1278300",
    "end": "1284160"
  },
  {
    "text": "it is looking for lazy attackers so and there are two detections basically one",
    "start": "1284160",
    "end": "1290010"
  },
  {
    "text": "encryption download activity and once again if you look closely",
    "start": "1290010",
    "end": "1295890"
  },
  {
    "text": "88 tells you how it caught you pens down",
    "start": "1295890",
    "end": "1301010"
  },
  {
    "text": "is required so what does it read the encryption method of the encrypted",
    "start": "1301010",
    "end": "1306780"
  },
  {
    "text": "timestamp field of s repeat message was downgraded I mean there can't be",
    "start": "1306780",
    "end": "1311940"
  },
  {
    "text": "anything clearer than that then that telling you in your face that try to increase you to improve your techniques",
    "start": "1311940",
    "end": "1319050"
  },
  {
    "text": "do not rely on tools blindly and there is another detection unusual protocol",
    "start": "1319050",
    "end": "1325770"
  },
  {
    "text": "implementation which actually I it was not possible for me to zero in on the",
    "start": "1325770",
    "end": "1332250"
  },
  {
    "text": "reason of detection what my wild guess was this if you look for supported",
    "start": "1332250",
    "end": "1338430"
  },
  {
    "text": "encryption types in the normal one these six items are there in the ntlm one or",
    "start": "1338430",
    "end": "1343530"
  },
  {
    "text": "there are these seven items and in the AES one once again quite similar to the normal one not the exact ones so it",
    "start": "1343530",
    "end": "1352230"
  },
  {
    "text": "could be that as well but if you use AES keys you might have",
    "start": "1352230",
    "end": "1358200"
  },
  {
    "start": "1354000",
    "end": "1392000"
  },
  {
    "text": "guessed what happens if you use aes-128 or AES 256 in place of the ntlm hash now",
    "start": "1358200",
    "end": "1367680"
  },
  {
    "text": "there is no detection once again Benjamin says here and that's what I have tested AES keys can only be",
    "start": "1367680",
    "end": "1375270"
  },
  {
    "text": "replaced on a dot that is you can use the EES Keys either on 8.1 10 or 2012 r2 all you need",
    "start": "1375270",
    "end": "1382650"
  },
  {
    "text": "to have this specific patch on the boxes which actually doesn't make this attack",
    "start": "1382650",
    "end": "1389160"
  },
  {
    "text": "any harder so if you're over pasta hash",
    "start": "1389160",
    "end": "1394500"
  },
  {
    "start": "1392000",
    "end": "1528000"
  },
  {
    "text": "attack gets detected use AES keys and how does that look like",
    "start": "1394500",
    "end": "1399950"
  },
  {
    "text": "so let me show you that from a 2012 r2 box let's see if I have mimic ants here",
    "start": "1399950",
    "end": "1415880"
  },
  {
    "text": "oops so in place of ntlm hash you're using",
    "start": "1426030",
    "end": "1432669"
  },
  {
    "text": "all the three secrets here AES 256 a es 128 and ntlm hash as well",
    "start": "1432669",
    "end": "1439889"
  },
  {
    "text": "so we got our so you can see that here",
    "start": "1439889",
    "end": "1446639"
  },
  {
    "text": "compare this with when you run mimic ads just with the ntlm hash all these fields",
    "start": "1446639",
    "end": "1452649"
  },
  {
    "text": "are null in those cases which they are not right now so if I try to access any",
    "start": "1452649",
    "end": "1462359"
  },
  {
    "text": "resource on to the domain controller right now I can do that that means it if",
    "start": "1462359",
    "end": "1472359"
  },
  {
    "text": "you have secrets of the copy TGT account not only the on ntlm hash I'm sorry that",
    "start": "1472359",
    "end": "1479139"
  },
  {
    "text": "comes later on right now we are on the domain admin if you have hashes of the of a domain administrator there's no",
    "start": "1479139",
    "end": "1487330"
  },
  {
    "text": "need to use ntlm hash go for AES keys and you would be fine there would be any",
    "start": "1487330",
    "end": "1493869"
  },
  {
    "text": "detection so if we go here just with no",
    "start": "1493869",
    "end": "1502179"
  },
  {
    "text": "detection how it gets detected it's something like this or this so that's",
    "start": "1502179",
    "end": "1510100"
  },
  {
    "text": "your over pasta hash detection which it T actually tells you in your face that I",
    "start": "1510100",
    "end": "1516489"
  },
  {
    "text": "caught your or pasta hash right once you have your over pasta hash attack you can",
    "start": "1516489",
    "end": "1526419"
  },
  {
    "text": "also do something once you start reading how it detected there some interesting things you can do for example you can",
    "start": "1526419",
    "end": "1532779"
  },
  {
    "start": "1528000",
    "end": "1613000"
  },
  {
    "text": "create fake events you know use whatever username in this command here and that",
    "start": "1532779",
    "end": "1541119"
  },
  {
    "text": "that's without a year so if you want it to get detected but some of it someone else's username you know your colleague",
    "start": "1541119",
    "end": "1548139"
  },
  {
    "text": "who got promoted but you for not something like that now just getting",
    "start": "1548139",
    "end": "1553570"
  },
  {
    "text": "anything if you want just to distract defenders or for some other reason if",
    "start": "1553570",
    "end": "1559450"
  },
  {
    "text": "you would like to create false detection so you can use this normal over pasta hash attack but in",
    "start": "1559450",
    "end": "1565150"
  },
  {
    "text": "this /user option of who maquettes if you are using mimic ads for that use whatever username you want make sure",
    "start": "1565150",
    "end": "1571419"
  },
  {
    "text": "that you use a correct one so that it gets attracted also if you use a",
    "start": "1571419",
    "end": "1578230"
  },
  {
    "text": "non-existent one you can see here that it still gets detected but the username field is unknown so maybe just to create",
    "start": "1578230",
    "end": "1585880"
  },
  {
    "text": "panic or create distraction you can use this now also you can see that if you",
    "start": "1585880",
    "end": "1592780"
  },
  {
    "text": "know of course that needs a little little bit of work in itself ATS opposed",
    "start": "1592780",
    "end": "1598299"
  },
  {
    "text": "to creating honey users or honey tokens you just create a user in your domain",
    "start": "1598299",
    "end": "1603669"
  },
  {
    "text": "and tell it here that this is a honey token or a bread crumb or a deception user you can create alerts for that user",
    "start": "1603669",
    "end": "1610809"
  },
  {
    "text": "as well whatever user any user in the domain now once you have domain admin",
    "start": "1610809",
    "end": "1616510"
  },
  {
    "start": "1613000",
    "end": "1748000"
  },
  {
    "text": "privileges the next step for domain dominance is to have a persistence there",
    "start": "1616510",
    "end": "1623530"
  },
  {
    "text": "and it it would be amazing if that persistence comes with domain admin privileges that's what we are going to",
    "start": "1623530",
    "end": "1631000"
  },
  {
    "text": "do now let's create a golden ticket attack so those of you are not aware of",
    "start": "1631000",
    "end": "1637750"
  },
  {
    "text": "a the golden ticket attack allows you to come back anytime later on once you have",
    "start": "1637750",
    "end": "1644230"
  },
  {
    "text": "da access pull the car BTD t-accounts hash come back later on this after maybe",
    "start": "1644230",
    "end": "1650049"
  },
  {
    "text": "let's say six months create a valid TGT and access any resource as the domain",
    "start": "1650049",
    "end": "1655360"
  },
  {
    "text": "admin that's what the golden ticket attack is so it was discussed by skip",
    "start": "1655360",
    "end": "1660940"
  },
  {
    "text": "that wall an immense I mean a couple of years back at blackhat now because it's",
    "start": "1660940",
    "end": "1667179"
  },
  {
    "text": "a valid tgd the action now moves to the TGS Rick Rick packet and it looks like",
    "start": "1667179",
    "end": "1674650"
  },
  {
    "text": "this a normal one this is how a normal golden ticket and one thing which I",
    "start": "1674650",
    "end": "1682000"
  },
  {
    "text": "would like to emphasize is golden tickets persistence is based on non-changing Corbett EDT password so",
    "start": "1682000",
    "end": "1690539"
  },
  {
    "text": "that's that's the trust anchor point if the car BT GT password is",
    "start": "1690539",
    "end": "1696130"
  },
  {
    "text": "a couple of times then your golden ticket attack will fail so with that this is how a normal TGS Rick packet",
    "start": "1696130",
    "end": "1704260"
  },
  {
    "text": "rooks rike you know in the same way we did for overpass the hatch attack if we",
    "start": "1704260",
    "end": "1711429"
  },
  {
    "text": "go here and see the e-type in the TGS sugar packet it's aes-256 ETS H Mac",
    "start": "1711429",
    "end": "1718120"
  },
  {
    "text": "shi-wan now this is how it looks like if you use",
    "start": "1718120",
    "end": "1723309"
  },
  {
    "text": "the ntlm hash of the kirby TGT account or clearly a downgrade and that is what",
    "start": "1723309",
    "end": "1730690"
  },
  {
    "text": "exactly we meet a TA is looking for so this is the command which we generally use for creating a world untick it",
    "start": "1730690",
    "end": "1738179"
  },
  {
    "text": "whatever user name domain seed of the domain and the ntlm hash of the COBE TTT",
    "start": "1738179",
    "end": "1744429"
  },
  {
    "text": "account that's what we use normally right so this is clearly an animal e and",
    "start": "1744429",
    "end": "1752350"
  },
  {
    "start": "1748000",
    "end": "2070000"
  },
  {
    "text": "it gets detected as encryption down grid activity once again if you open up the",
    "start": "1752350",
    "end": "1758250"
  },
  {
    "text": "encryption downgrade activity here let",
    "start": "1758250",
    "end": "1763809"
  },
  {
    "text": "me hello if",
    "start": "1763809",
    "end": "1766559"
  },
  {
    "text": "this thing so from so this is an older",
    "start": "1771110",
    "end": "1777600"
  },
  {
    "text": "one or ps user 11 a golden ticket has been detected why because the TTT field",
    "start": "1777600",
    "end": "1785910"
  },
  {
    "text": "of TJ's rigged message has been downgraded based on previously learned",
    "start": "1785910",
    "end": "1791520"
  },
  {
    "text": "behavior fair enough so let's make it normal and how do we do it no points for",
    "start": "1791520",
    "end": "1801300"
  },
  {
    "text": "guessing once again using AES keys and because this time we are not sending the",
    "start": "1801300",
    "end": "1808140"
  },
  {
    "text": "users keys we can simply run it from whatever box we want there's no need to run it from a 2012 r2 box or have a",
    "start": "1808140",
    "end": "1815520"
  },
  {
    "text": "specific patch over there so let's see",
    "start": "1815520",
    "end": "1823610"
  },
  {
    "text": "can we access any resource on to the domain controller right now no we can't",
    "start": "1824180",
    "end": "1834049"
  },
  {
    "text": "okay let's create a note not this one let's create a quickly create a golden",
    "start": "1840560",
    "end": "1848030"
  },
  {
    "text": "ticket and see so do we have many cats",
    "start": "1848030",
    "end": "1855800"
  },
  {
    "text": "here so we are using AES 256 for the",
    "start": "1855800",
    "end": "1865160"
  },
  {
    "text": "Kirby TDD account here and can we access",
    "start": "1865160",
    "end": "1870560"
  },
  {
    "text": "a resource now on to the domain controller yes of course we can I mean",
    "start": "1870560",
    "end": "1875660"
  },
  {
    "text": "now we have a golden ticket we can pretty much access any resource in the entire domain and there's no detection",
    "start": "1875660",
    "end": "1885860"
  },
  {
    "text": "of this so this one that you see is from yesterday when I was testing things so",
    "start": "1885860",
    "end": "1893650"
  },
  {
    "text": "you normalize your traffic and there would be no detection that's the key so",
    "start": "1893650",
    "end": "1900620"
  },
  {
    "text": "once again 8080 attacks golden ticket use AES keys so I was quite happy with so I would like to say this and I have a",
    "start": "1900620",
    "end": "1908240"
  },
  {
    "text": "slide for that I'll I worked with the ATA team it was fantastic but up to this time it was very good with ATM and I was",
    "start": "1908240",
    "end": "1915980"
  },
  {
    "text": "respecting whatever it was doing but for some strange reason this happened you",
    "start": "1915980",
    "end": "1922400"
  },
  {
    "text": "know if you create a golden ticket with ntlm hash but you use the username as",
    "start": "1922400",
    "end": "1928790"
  },
  {
    "text": "something which is not in the domain you make something up that thing doesn't get detected and that is something which is",
    "start": "1928790",
    "end": "1934910"
  },
  {
    "text": "really bad so how does this work in the",
    "start": "1934910",
    "end": "1940430"
  },
  {
    "text": "in the command you use the usual one you simply use something like this and this",
    "start": "1940430",
    "end": "1945620"
  },
  {
    "text": "is very interesting because in my class I had questions like if we cannot",
    "start": "1945620",
    "end": "1950920"
  },
  {
    "text": "retrieve the AES key somehow because the DC sync is one of the best methods and",
    "start": "1950920",
    "end": "1958180"
  },
  {
    "text": "given that I have to give this to a TA no matter from where you run DC sync from the same domain at least for me I",
    "start": "1958180",
    "end": "1966170"
  },
  {
    "text": "couldn't couldn't find any way to not get detected so this was this was very",
    "start": "1966170",
    "end": "1973040"
  },
  {
    "text": "interesting for me just with the ntlm hash known nothing else we'll just use the username to be",
    "start": "1973040",
    "end": "1978499"
  },
  {
    "text": "something else and you would be fine and I initially of course thought that and",
    "start": "1978499",
    "end": "1983629"
  },
  {
    "text": "I'm not this making this up when I submit it slide said for blackhat this is exactly what I wrote there I hope",
    "start": "1983629",
    "end": "1989779"
  },
  {
    "text": "this is a Mis configuration in my lab because I couldn't fathom that this is this could be possible but later on it",
    "start": "1989779",
    "end": "1996440"
  },
  {
    "text": "turns out that this was this is true I mean and this is true up to 1.8 as well",
    "start": "1996440",
    "end": "2002110"
  },
  {
    "text": "most of the things which we are discussing are true for a 1.8 so let me",
    "start": "2002110",
    "end": "2010299"
  },
  {
    "text": "see if I have a demo of this as well",
    "start": "2010299",
    "end": "2013799"
  },
  {
    "text": "okay and I need to be a bit faster now",
    "start": "2017879",
    "end": "2022259"
  },
  {
    "text": "so I purged the tickets can I access any resource on the domain controller right",
    "start": "2023789",
    "end": "2030249"
  },
  {
    "text": "now No",
    "start": "2030249",
    "end": "2032820"
  },
  {
    "text": "and the only difference in this command and the previous one is that I use a",
    "start": "2039340",
    "end": "2046919"
  },
  {
    "text": "non-existent username so the username",
    "start": "2046919",
    "end": "2054878"
  },
  {
    "text": "here is non-existent and I can once",
    "start": "2054879",
    "end": "2062950"
  },
  {
    "text": "again access resources that is persistence is still there so very",
    "start": "2062950",
    "end": "2069429"
  },
  {
    "text": "interesting in 1.8 81 dot s specifically",
    "start": "2069429",
    "end": "2076510"
  },
  {
    "start": "2070000",
    "end": "2214000"
  },
  {
    "text": "it was introduced or a feature was introduced for detection based on the",
    "start": "2076510",
    "end": "2081550"
  },
  {
    "text": "ticket lifetime and I'd read it from the release notes if a Kerberos ticket is",
    "start": "2081550",
    "end": "2087520"
  },
  {
    "text": "used for more than the allowed lifetime 80 will detect as a suspicious activity obviously blunts the attack now you",
    "start": "2087520",
    "end": "2094569"
  },
  {
    "text": "cannot simply create a golden ticket and take it with your home come back six",
    "start": "2094569",
    "end": "2100180"
  },
  {
    "text": "months later and use it that sort of careful careless attacks are not",
    "start": "2100180",
    "end": "2105250"
  },
  {
    "text": "possible but keep this in mind it is the so there are two is around it",
    "start": "2105250",
    "end": "2110260"
  },
  {
    "text": "first one it is the copy TDT hash and not your tickets save to the file which",
    "start": "2110260",
    "end": "2115569"
  },
  {
    "text": "provides you persistence so stop doing something like this where you create the",
    "start": "2115569",
    "end": "2121420"
  },
  {
    "text": "golden ticket save it to the file and use it later on that would be a dead",
    "start": "2121420",
    "end": "2126490"
  },
  {
    "text": "giveaway why because of this thing if you see whenever you create a golden ticket there is a lifetime attached to",
    "start": "2126490",
    "end": "2134050"
  },
  {
    "text": "it or for that matter any TGT there is a lifetime attached to it if you create it",
    "start": "2134050",
    "end": "2139960"
  },
  {
    "text": "today and use it six months later the detection would be quite obvious and all",
    "start": "2139960",
    "end": "2147130"
  },
  {
    "text": "almost all of the domains have a lifetime on on a ticket and if you use a ticket witches off its lifetime that's",
    "start": "2147130",
    "end": "2153579"
  },
  {
    "text": "that giveaway so don't save your tickets on to the disk otherwise this is how lifetime",
    "start": "2153579",
    "end": "2160480"
  },
  {
    "text": "based detection looks like you know our ticket was used so allowed maximum in my",
    "start": "2160480",
    "end": "2166599"
  },
  {
    "text": "domain for testing is one hours and there was a ticket use for 275 hours",
    "start": "2166599",
    "end": "2172589"
  },
  {
    "text": "now keep the ticket lifetime in mind if",
    "start": "2180940",
    "end": "2186289"
  },
  {
    "text": "you don't know it it's in the wiki of the mimikatz you can actually set a lifetime of a golden ticket while",
    "start": "2186289",
    "end": "2192170"
  },
  {
    "text": "creating it so keep that in mind as well you can use start offset and add in",
    "start": "2192170",
    "end": "2197569"
  },
  {
    "text": "options to set lifetime of a ticket and never leave your the golden ticket in",
    "start": "2197569",
    "end": "2203210"
  },
  {
    "text": "memory purge it as soon as you're over done with the things project otherwise the detection which I assured you just",
    "start": "2203210",
    "end": "2210380"
  },
  {
    "text": "now would be there ready ready to catch you now there are some interesting",
    "start": "2210380",
    "end": "2217430"
  },
  {
    "start": "2214000",
    "end": "2283000"
  },
  {
    "text": "attacks like constrained delegation where you have the ability to access any",
    "start": "2217430",
    "end": "2223700"
  },
  {
    "text": "service to access a particular service by impersonating any user so there is no",
    "start": "2223700",
    "end": "2229460"
  },
  {
    "text": "demonstration unfortunately for that it doesn't get detected why service",
    "start": "2229460",
    "end": "2236359"
  },
  {
    "text": "accounts support only rc4 encryption and this what this I learned while",
    "start": "2236359",
    "end": "2243410"
  },
  {
    "text": "discussing my talk with the ATA team I didn't knew that in advance of service",
    "start": "2243410",
    "end": "2249229"
  },
  {
    "text": "accounts support only rc4 encryption when you use ntlm hash of a service account to exploit or to abuse",
    "start": "2249229",
    "end": "2256910"
  },
  {
    "text": "constraint delegation it's still the same thing there is no downgrade so therefore there is no",
    "start": "2256910",
    "end": "2263630"
  },
  {
    "text": "detection once again if you run DC sync sort of attack using constrained",
    "start": "2263630",
    "end": "2270259"
  },
  {
    "text": "delegation you will still get detected DC syncs detection as for eyes I know it's been rock-solid couldn't find",
    "start": "2270259",
    "end": "2278150"
  },
  {
    "text": "anything really interesting when comes deceasing just one thing and this is",
    "start": "2278150",
    "end": "2286279"
  },
  {
    "start": "2283000",
    "end": "2374000"
  },
  {
    "text": "when when I was discussing this thing or during my training the last day some of",
    "start": "2286279",
    "end": "2291529"
  },
  {
    "text": "my students or attendees did not agree for them the first part no the second",
    "start": "2291529",
    "end": "2300410"
  },
  {
    "text": "part if even if you run DC sync from a domain admin of a child domain for them",
    "start": "2300410",
    "end": "2306950"
  },
  {
    "text": "it was getting detected for me it was not so let's nevertheless let's have a look",
    "start": "2306950",
    "end": "2314060"
  },
  {
    "text": "at couple of attacks across to us trusts which doesn't get detected one is the",
    "start": "2314060",
    "end": "2319609"
  },
  {
    "text": "well-known way of detailed here the well-known one when you get access to",
    "start": "2319609",
    "end": "2324760"
  },
  {
    "text": "the as L to the dome as a domain administrator in a child domain and you",
    "start": "2324760",
    "end": "2329960"
  },
  {
    "text": "escalate your privileges to enterprise admin there is no detection at all why",
    "start": "2329960",
    "end": "2337220"
  },
  {
    "text": "because that interval T DT is still using our C for hash so no detection if",
    "start": "2337220",
    "end": "2344810"
  },
  {
    "text": "you run a replication or a DC sync from a child domain the child domain controller in during my testing that was",
    "start": "2344810",
    "end": "2353089"
  },
  {
    "text": "not detected right so that is the only DC sync bypass or avoidance I know of",
    "start": "2353089",
    "end": "2360818"
  },
  {
    "text": "none xed plaintext passwords you can expect we in test plaintext passwords",
    "start": "2360910",
    "end": "2366650"
  },
  {
    "text": "using variety of ways there are so many instances where you can get your hands",
    "start": "2366650",
    "end": "2371660"
  },
  {
    "text": "on in those cases animal based detections are of no use if you can't bypass it just avoid it how do",
    "start": "2371660",
    "end": "2378680"
  },
  {
    "start": "2374000",
    "end": "2398000"
  },
  {
    "text": "you avoid it here by not talking to the domain controller like attacks like",
    "start": "2378680",
    "end": "2385010"
  },
  {
    "text": "silver ticket let's say you target a server which has a sequence of cycle server running on it you target the",
    "start": "2385010",
    "end": "2393050"
  },
  {
    "text": "service account of that particular sequel server get access to it in a text like these because there is no",
    "start": "2393050",
    "end": "2400069"
  },
  {
    "start": "2398000",
    "end": "2410000"
  },
  {
    "text": "communication to the DC there is no detection right Kerberos to attack minimal interaction",
    "start": "2400069",
    "end": "2407690"
  },
  {
    "text": "with the DC just request a valid TDS save it to the disk crack it offline no",
    "start": "2407690",
    "end": "2415130"
  },
  {
    "start": "2410000",
    "end": "2454000"
  },
  {
    "text": "detection variants of Kerberos you request if you go back here save a s rap",
    "start": "2415130",
    "end": "2423079"
  },
  {
    "text": "to the disk CBS CBS rep to the days would force it offline no detection for",
    "start": "2423079",
    "end": "2430609"
  },
  {
    "text": "set s pn on a user request TGS save it to the days would force offline no",
    "start": "2430609",
    "end": "2436160"
  },
  {
    "text": "detection why because we are not even talking to the domain controller or if there is any talking it's just",
    "start": "2436160",
    "end": "2442069"
  },
  {
    "text": "requesting a Kerberos ticket sequel servers attack a sequel server",
    "start": "2442069",
    "end": "2447109"
  },
  {
    "text": "move across the database layer and aadya is not even designed to catch these sort",
    "start": "2447109",
    "end": "2453829"
  },
  {
    "text": "of attacks off of course no detection if it is not really looking at the traffic",
    "start": "2453829",
    "end": "2459079"
  },
  {
    "start": "2454000",
    "end": "2460000"
  },
  {
    "text": "they can be an interaction right a couple of attack chains which I think I",
    "start": "2459079",
    "end": "2464630"
  },
  {
    "start": "2460000",
    "end": "2469000"
  },
  {
    "text": "should skip right now because I have couple of interesting things and I have like seven or eight minutes left or let",
    "start": "2464630",
    "end": "2472040"
  },
  {
    "start": "2469000",
    "end": "2498000"
  },
  {
    "text": "me quickly go through this it's Espeon scanning for sequel servers gain access to a sequel server by brute",
    "start": "2472040",
    "end": "2477410"
  },
  {
    "text": "forcing the SA account or some Thor sequel injection or whatever you want move around in the database layers by",
    "start": "2477410",
    "end": "2483740"
  },
  {
    "text": "exploiting linked databases and then later on if you are a pure goal of your",
    "start": "2483740",
    "end": "2490960"
  },
  {
    "text": "assessment is domain admin privileges go for it okay lets me let me skip the",
    "start": "2490960",
    "end": "2497480"
  },
  {
    "text": "attack chain to limitations LDAP as IPSec ESB these are two protocols which",
    "start": "2497480",
    "end": "2504589"
  },
  {
    "start": "2498000",
    "end": "2525000"
  },
  {
    "text": "are documented that ata can't have a look at there are only certain protocols which eighty look at if there is no",
    "start": "2504589",
    "end": "2513740"
  },
  {
    "text": "detection there is no animal e signature of an attack it won't get detected something which I someone blogged about",
    "start": "2513740",
    "end": "2520310"
  },
  {
    "text": "at medium and and we blogged it this attack doesn't get detected as well now",
    "start": "2520310",
    "end": "2528260"
  },
  {
    "start": "2525000",
    "end": "2608000"
  },
  {
    "text": "if we want to attack the deployment of ata that is it is fine as long as we can",
    "start": "2528260",
    "end": "2534380"
  },
  {
    "text": "bypass or avoid it what are our options if you would like to directly heads on target ata first you can identify ata by",
    "start": "2534380",
    "end": "2543710"
  },
  {
    "text": "a simple banner Grabel which is fine now ATS subscribes to that theory that if",
    "start": "2543710",
    "end": "2549200"
  },
  {
    "text": "you have administrative access on our box it's game over what does that mean",
    "start": "2549200",
    "end": "2554960"
  },
  {
    "text": "if you have so ATF use remember the diagram has a system part and a console part so the console is where you know",
    "start": "2554960",
    "end": "2563839"
  },
  {
    "text": "this console is on the system so the ATS system is that box where 88 pulls all",
    "start": "2563839",
    "end": "2569990"
  },
  {
    "text": "the traffic and whatever and do all its magic so if you have admin access ended on that box all the local",
    "start": "2569990",
    "end": "2577670"
  },
  {
    "text": "administrator users of that box have access to a TA console what does that mean if you have deployed a TA as part",
    "start": "2577670",
    "end": "2584569"
  },
  {
    "text": "of your domain and the ATA system is also part of your domain and you get your hands on to a domain administrator",
    "start": "2584569",
    "end": "2590770"
  },
  {
    "text": "it would be possible for you to access a TA console what is 80 console this this",
    "start": "2590770",
    "end": "2596359"
  },
  {
    "text": "thing this is 80 console you can access it using any such user which is okay",
    "start": "2596359",
    "end": "2604430"
  },
  {
    "text": "that's just using authentication for something else now the backend MongoDB",
    "start": "2604430",
    "end": "2611540"
  },
  {
    "start": "2608000",
    "end": "2628000"
  },
  {
    "text": "which ATI uses to store things has no password all that listens only on the",
    "start": "2611540",
    "end": "2618740"
  },
  {
    "text": "local loopback but once again if you have access to the box there are so many things you can do you can read users",
    "start": "2618740",
    "end": "2624980"
  },
  {
    "text": "profiles how it is detected things what it is storing and we can do something",
    "start": "2624980",
    "end": "2630290"
  },
  {
    "start": "2628000",
    "end": "2650000"
  },
  {
    "text": "like this if there is an alert we can actually change the identity on that",
    "start": "2630290",
    "end": "2636470"
  },
  {
    "text": "alert right so here it was Oh PS terminal SC term admin user which was",
    "start": "2636470",
    "end": "2645440"
  },
  {
    "text": "doing interesting things then we changed it and can blame it on someone else even",
    "start": "2645440",
    "end": "2651230"
  },
  {
    "start": "2650000",
    "end": "2663000"
  },
  {
    "text": "easier is to set the visibility of alerts you can just change is visible to",
    "start": "2651230",
    "end": "2657380"
  },
  {
    "text": "false and an alert would be gone from the console without leaving any trace so",
    "start": "2657380",
    "end": "2665270"
  },
  {
    "start": "2663000",
    "end": "2686000"
  },
  {
    "text": "what are the defenses against the evasions of course as soon as fixes are",
    "start": "2665270",
    "end": "2670640"
  },
  {
    "text": "there upgrade your ata and the normal ones the the run-of-the-mill defenses do",
    "start": "2670640",
    "end": "2676760"
  },
  {
    "text": "not allow your domain admins to log into whatever box they wish to or possible",
    "start": "2676760",
    "end": "2683329"
  },
  {
    "text": "architectural changes suggested here securing privileged access how do you avoid ata even when it is updated later",
    "start": "2683329",
    "end": "2690829"
  },
  {
    "start": "2686000",
    "end": "2745000"
  },
  {
    "text": "on why the temptation of escalating to",
    "start": "2690829",
    "end": "2696890"
  },
  {
    "text": "domain admin privileges without understanding Active Directory environment there are so many",
    "start": "2696890",
    "end": "2702609"
  },
  {
    "text": "breadcrumbs and honey tokens and honey users out there that going at the very",
    "start": "2702609",
    "end": "2708020"
  },
  {
    "text": "first moment for the lowest hanging fruit should not be there you know as soon as",
    "start": "2708020",
    "end": "2713210"
  },
  {
    "text": "you spot that okay in my very first enumeration I found out a box where I'm a local admin and a domain admin is",
    "start": "2713210",
    "end": "2719360"
  },
  {
    "text": "logged in there that could be a deception so be mindful of that and",
    "start": "2719360",
    "end": "2725390"
  },
  {
    "text": "reduce communication to the DC please do not create a golden ticket just so that",
    "start": "2725390",
    "end": "2731240"
  },
  {
    "text": "you can write about that in your report that look how badly screw your environment is I've got a golden ticket",
    "start": "2731240",
    "end": "2737720"
  },
  {
    "text": "no not for that if you actually want to persist your terms of engagement say",
    "start": "2737720",
    "end": "2742910"
  },
  {
    "text": "that only then go for it so for limitations of this research or",
    "start": "2742910",
    "end": "2750170"
  },
  {
    "start": "2745000",
    "end": "2768000"
  },
  {
    "text": "talk has been focused only on the bypasses for animal based detections of course there are so many of these",
    "start": "2750170",
    "end": "2756800"
  },
  {
    "text": "things which may get detected in actual environment when user behavior detection is implemented couldn't test that though",
    "start": "2756800",
    "end": "2765310"
  },
  {
    "text": "in case you are getting detected use avoidance techniques and big thanks to",
    "start": "2765310",
    "end": "2771380"
  },
  {
    "start": "2768000",
    "end": "2800000"
  },
  {
    "text": "the ATA team I know some of you guys are here so it was fantastic to work with",
    "start": "2771380",
    "end": "2776990"
  },
  {
    "text": "them those I would quickly like to say this out I've worked with em SRC last",
    "start": "2776990",
    "end": "2782030"
  },
  {
    "text": "year as well and while speaking about MZ it's a new Microsoft so they actually",
    "start": "2782030",
    "end": "2788510"
  },
  {
    "text": "encourage you to go after their products as far as that isn't what my experiences being go after their products and find",
    "start": "2788510",
    "end": "2795710"
  },
  {
    "text": "find the right guy and they will actually appreciate your work so to sum",
    "start": "2795710",
    "end": "2803600"
  },
  {
    "start": "2800000",
    "end": "2835000"
  },
  {
    "text": "it up it is possible to bypass detections by a TA by modifying",
    "start": "2803600",
    "end": "2808790"
  },
  {
    "text": "well-known attacks a little bit so that they appear normal to to the direction sensors modification of attack",
    "start": "2808790",
    "end": "2815870"
  },
  {
    "text": "methodology and staying focus on goals of your assessment that is not talking",
    "start": "2815870",
    "end": "2821480"
  },
  {
    "text": "to the DC and necessarily is effective and despite its limitations ata still",
    "start": "2821480",
    "end": "2827990"
  },
  {
    "text": "provides interesting insight to do your Active Directory environment so you may",
    "start": "2827990",
    "end": "2834050"
  },
  {
    "text": "be still keep using it and that is all you know once again you can follow me on",
    "start": "2834050",
    "end": "2840020"
  },
  {
    "start": "2835000",
    "end": "2863000"
  },
  {
    "text": "Twitter here I would love that brought me email either on my personal",
    "start": "2840020",
    "end": "2845150"
  },
  {
    "text": "ID or more my company ID for if you want to hire me and all the slides all the",
    "start": "2845150",
    "end": "2851300"
  },
  {
    "text": "slides blogs etc would be available on my blog and on my github thank you very",
    "start": "2851300",
    "end": "2856430"
  },
  {
    "text": "much [Applause]",
    "start": "2856430",
    "end": "2865599"
  }
]