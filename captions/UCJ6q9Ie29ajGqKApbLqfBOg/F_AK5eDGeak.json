[
  {
    "start": "0",
    "end": "508000"
  },
  {
    "text": "hello how are you today me I shall say",
    "start": "0",
    "end": "4470"
  },
  {
    "text": "I'm a little bit nervous it's the first",
    "start": "4470",
    "end": "6270"
  },
  {
    "text": "time that I get to speak at blackhat and",
    "start": "6270",
    "end": "8340"
  },
  {
    "text": "it's amazing here but there's also",
    "start": "8340",
    "end": "11099"
  },
  {
    "text": "something else that I want to get off my",
    "start": "11099",
    "end": "13380"
  },
  {
    "text": "chest this this talk is about a project",
    "start": "13380",
    "end": "16560"
  },
  {
    "text": "called blue peel and if you love movies",
    "start": "16560",
    "end": "19680"
  },
  {
    "text": "this rings a bell right but I shall tell",
    "start": "19680",
    "end": "22830"
  },
  {
    "text": "you that I never watched the Matrix",
    "start": "22830",
    "end": "25260"
  },
  {
    "text": "movie so sorry I thought you needed to",
    "start": "25260",
    "end": "27810"
  },
  {
    "text": "know but so Who am I I'm yeah I have",
    "start": "27810",
    "end": "32398"
  },
  {
    "text": "poor taste in movies and I work in Rome",
    "start": "32399",
    "end": "35010"
  },
  {
    "text": "at sabaeans University in the last",
    "start": "35010",
    "end": "37110"
  },
  {
    "text": "couple years my postdoc have been",
    "start": "37110",
    "end": "38850"
  },
  {
    "text": "working on software security problems",
    "start": "38850",
    "end": "41070"
  },
  {
    "text": "including malware analysis we are here",
    "start": "41070",
    "end": "43800"
  },
  {
    "text": "code obfuscation could reduce attacks",
    "start": "43800",
    "end": "46289"
  },
  {
    "text": "more generally binary analysis freedom",
    "start": "46289",
    "end": "48570"
  },
  {
    "text": "but we are here to talk about a problem",
    "start": "48570",
    "end": "52140"
  },
  {
    "text": "in malware analysis the problem of",
    "start": "52140",
    "end": "54870"
  },
  {
    "text": "malware evasion so we have samples",
    "start": "54870",
    "end": "57920"
  },
  {
    "text": "increasingly more complex they try to",
    "start": "57920",
    "end": "60300"
  },
  {
    "text": "withstand dynamic analysis that we want",
    "start": "60300",
    "end": "63000"
  },
  {
    "text": "to perform by using adversarial",
    "start": "63000",
    "end": "65250"
  },
  {
    "text": "techniques to detect analysis systems",
    "start": "65250",
    "end": "67380"
  },
  {
    "text": "and hide their true colors as",
    "start": "67380",
    "end": "71400"
  },
  {
    "text": "researchers as a community we try to",
    "start": "71400",
    "end": "74040"
  },
  {
    "text": "react by coming up with better designs",
    "start": "74040",
    "end": "76619"
  },
  {
    "text": "more transparent designs for instance",
    "start": "76619",
    "end": "79530"
  },
  {
    "text": "for send boxes now we have virtual",
    "start": "79530",
    "end": "82020"
  },
  {
    "text": "machine introspection techniques where",
    "start": "82020",
    "end": "84330"
  },
  {
    "text": "we moved the analysis outside the",
    "start": "84330",
    "end": "87150"
  },
  {
    "text": "virtualized environment to minimize the",
    "start": "87150",
    "end": "89340"
  },
  {
    "text": "the artifacts that we introduce in the",
    "start": "89340",
    "end": "92159"
  },
  {
    "text": "process and this is great right and when",
    "start": "92159",
    "end": "95610"
  },
  {
    "text": "I first start working on this project I",
    "start": "95610",
    "end": "97979"
  },
  {
    "text": "asked myself and I'm asking you now what",
    "start": "97979",
    "end": "101040"
  },
  {
    "text": "happens next when you have an",
    "start": "101040",
    "end": "102960"
  },
  {
    "text": "interesting sample and you need to",
    "start": "102960",
    "end": "105030"
  },
  {
    "text": "analyze this sample you need to dissect",
    "start": "105030",
    "end": "106590"
  },
  {
    "text": "this sample what happens well sometimes",
    "start": "106590",
    "end": "110790"
  },
  {
    "text": "you ending up facing the same",
    "start": "110790",
    "end": "112829"
  },
  {
    "text": "adversarial techniques that we have",
    "start": "112829",
    "end": "115470"
  },
  {
    "text": "solutions for the automatic stage but",
    "start": "115470",
    "end": "117630"
  },
  {
    "text": "when you're a malware analyst you have",
    "start": "117630",
    "end": "119070"
  },
  {
    "text": "to waste quite some time disarming red",
    "start": "119070",
    "end": "121860"
  },
  {
    "text": "pills for several elevations there have",
    "start": "121860",
    "end": "125009"
  },
  {
    "text": "been some proposals too recently to use",
    "start": "125009",
    "end": "128190"
  },
  {
    "text": "virtual machine introspection also for",
    "start": "128190",
    "end": "130349"
  },
  {
    "text": "debugging but if you're a malware",
    "start": "130349",
    "end": "132900"
  },
  {
    "text": "analyst and you've been",
    "start": "132900",
    "end": "134069"
  },
  {
    "text": "this for quite some time you have your",
    "start": "134069",
    "end": "136920"
  },
  {
    "text": "tools that you love for monitoring Auto",
    "start": "136920",
    "end": "140010"
  },
  {
    "text": "not just a debugger but many third-party",
    "start": "140010",
    "end": "142140"
  },
  {
    "text": "tools for monitoring maybe you don't",
    "start": "142140",
    "end": "145079"
  },
  {
    "text": "like Symantec apps unless you really",
    "start": "145079",
    "end": "147450"
  },
  {
    "text": "have to monitoring sometimes it's just",
    "start": "147450",
    "end": "151200"
  },
  {
    "text": "one part of the story you also need to",
    "start": "151200",
    "end": "153930"
  },
  {
    "text": "alter behaviors to change behaviors so",
    "start": "153930",
    "end": "156959"
  },
  {
    "text": "you are introducing artifacts in this",
    "start": "156959",
    "end": "160739"
  },
  {
    "text": "talk I'm going to first give you the",
    "start": "160739",
    "end": "162720"
  },
  {
    "text": "pitch the high level bits what we did",
    "start": "162720",
    "end": "165150"
  },
  {
    "text": "with blue pill and I will be detailing",
    "start": "165150",
    "end": "167220"
  },
  {
    "text": "how we did that and how I think blue",
    "start": "167220",
    "end": "170069"
  },
  {
    "text": "pill can be helping monger analysts in",
    "start": "170069",
    "end": "172139"
  },
  {
    "text": "their daily life so those approaches",
    "start": "172139",
    "end": "176069"
  },
  {
    "text": "that I was mentioning they try to",
    "start": "176069",
    "end": "177900"
  },
  {
    "text": "achieve transparency with a passive",
    "start": "177900",
    "end": "180510"
  },
  {
    "text": "approach and by that I mean that they",
    "start": "180510",
    "end": "182879"
  },
  {
    "text": "just minimize the artifacts in the",
    "start": "182879",
    "end": "185159"
  },
  {
    "text": "design but when you're dissecting a",
    "start": "185159",
    "end": "187739"
  },
  {
    "text": "sample it's a little bit different you",
    "start": "187739",
    "end": "189720"
  },
  {
    "text": "might be introducing artifacts yourself",
    "start": "189720",
    "end": "191760"
  },
  {
    "text": "and we try to follow an active approach",
    "start": "191760",
    "end": "194939"
  },
  {
    "text": "so the idea is that we create a blue",
    "start": "194939",
    "end": "198599"
  },
  {
    "text": "pill for malware that will give a sample",
    "start": "198599",
    "end": "200849"
  },
  {
    "text": "delusion that it's executing on a",
    "start": "200849",
    "end": "202889"
  },
  {
    "text": "machine and a victim machine while",
    "start": "202889",
    "end": "205049"
  },
  {
    "text": "actually you're there digging into it",
    "start": "205049",
    "end": "207180"
  },
  {
    "text": "and analyzing it we want to neutralize",
    "start": "207180",
    "end": "209519"
  },
  {
    "text": "the red pills and malware has four",
    "start": "209519",
    "end": "211979"
  },
  {
    "text": "revisions the idea is that you have to",
    "start": "211979",
    "end": "216180"
  },
  {
    "text": "fake answers to every query that a",
    "start": "216180",
    "end": "219090"
  },
  {
    "text": "malware can make in a coordinated manner",
    "start": "219090",
    "end": "221879"
  },
  {
    "text": "but there's more to it than that we we",
    "start": "221879",
    "end": "224849"
  },
  {
    "text": "want to enhance the section capabilities",
    "start": "224849",
    "end": "227190"
  },
  {
    "text": "for analysts we want to for instance for",
    "start": "227190",
    "end": "229979"
  },
  {
    "text": "starters we want to hide the artifacts",
    "start": "229979",
    "end": "232379"
  },
  {
    "text": "of third-party monitoring tools that you",
    "start": "232379",
    "end": "234629"
  },
  {
    "text": "run alongside your debugger we want to",
    "start": "234629",
    "end": "237510"
  },
  {
    "text": "provide features to apply code edits",
    "start": "237510",
    "end": "241290"
  },
  {
    "text": "change the code in a stealthy manner and",
    "start": "241290",
    "end": "244729"
  },
  {
    "text": "we want the systems to be extensible",
    "start": "244729",
    "end": "247769"
  },
  {
    "text": "customizable by the user if the user",
    "start": "247769",
    "end": "250019"
  },
  {
    "text": "needs a new hook in the system should be",
    "start": "250019",
    "end": "252269"
  },
  {
    "text": "easy to extend the system to deal with",
    "start": "252269",
    "end": "254879"
  },
  {
    "text": "new patterns in your inner work and when",
    "start": "254879",
    "end": "259109"
  },
  {
    "text": "I started working on this of course we",
    "start": "259109",
    "end": "261269"
  },
  {
    "text": "had to study the literature on evasions",
    "start": "261269",
    "end": "263909"
  },
  {
    "text": "and you know there is so much ground",
    "start": "263909",
    "end": "267840"
  },
  {
    "text": "you have Hardware artifacts hypervisor",
    "start": "267840",
    "end": "271800"
  },
  {
    "text": "artifacts software setup Windows install",
    "start": "271800",
    "end": "274470"
  },
  {
    "text": "where entire state of the machine up",
    "start": "274470",
    "end": "277050"
  },
  {
    "text": "time there is a lot right many angles to",
    "start": "277050",
    "end": "279810"
  },
  {
    "text": "cover and multirotors are smart they",
    "start": "279810",
    "end": "284640"
  },
  {
    "text": "might make coordinated queries with",
    "start": "284640",
    "end": "286800"
  },
  {
    "text": "different primitives in case you're",
    "start": "286800",
    "end": "288420"
  },
  {
    "text": "trying to fake the state of your system",
    "start": "288420",
    "end": "291650"
  },
  {
    "text": "evasions might be general you might be",
    "start": "291650",
    "end": "294390"
  },
  {
    "text": "looking for overheads or you might be",
    "start": "294390",
    "end": "296520"
  },
  {
    "text": "looking for that specific artifact of",
    "start": "296520",
    "end": "298620"
  },
  {
    "text": "that sandbox or debugger so I'm",
    "start": "298620",
    "end": "301740"
  },
  {
    "text": "sometimes adjusting the systems to react",
    "start": "301740",
    "end": "304290"
  },
  {
    "text": "to new evasion this takes time to",
    "start": "304290",
    "end": "306360"
  },
  {
    "text": "rethink the design or to make some",
    "start": "306360",
    "end": "308100"
  },
  {
    "text": "changes we react slowly some time and so",
    "start": "308100",
    "end": "311520"
  },
  {
    "text": "it's time I tell you what we actually",
    "start": "311520",
    "end": "313200"
  },
  {
    "text": "did with blue pill which I like to think",
    "start": "313200",
    "end": "317190"
  },
  {
    "text": "of blue pill as a dynamic analysis",
    "start": "317190",
    "end": "319170"
  },
  {
    "text": "framework for malware where we build on",
    "start": "319170",
    "end": "322050"
  },
  {
    "text": "this intuition just parroting we could",
    "start": "322050",
    "end": "324300"
  },
  {
    "text": "call it where you observe check and",
    "start": "324300",
    "end": "327780"
  },
  {
    "text": "replace observe I mean that we intercept",
    "start": "327780",
    "end": "331470"
  },
  {
    "text": "some potentially evasive queries that a",
    "start": "331470",
    "end": "334920"
  },
  {
    "text": "sample can make in the system we check",
    "start": "334920",
    "end": "337470"
  },
  {
    "text": "whether the value that the system will",
    "start": "337470",
    "end": "340230"
  },
  {
    "text": "normally return is likely to give away",
    "start": "340230",
    "end": "342870"
  },
  {
    "text": "the presence of an user behind the",
    "start": "342870",
    "end": "346740"
  },
  {
    "text": "system or of the system itself or in",
    "start": "346740",
    "end": "349320"
  },
  {
    "text": "other words if this value wouldn't meet",
    "start": "349320",
    "end": "352320"
  },
  {
    "text": "the samples expectations and in that",
    "start": "352320",
    "end": "355170"
  },
  {
    "text": "case we have to fix this value will",
    "start": "355170",
    "end": "356880"
  },
  {
    "text": "replace the value with something that in",
    "start": "356880",
    "end": "359160"
  },
  {
    "text": "our opinion can work for the sample on",
    "start": "359160",
    "end": "361890"
  },
  {
    "text": "top of that we are able to implement a",
    "start": "361890",
    "end": "364050"
  },
  {
    "text": "full-fledged mongrel analysis system on",
    "start": "364050",
    "end": "366240"
  },
  {
    "text": "top of this paradigm and we use dynamic",
    "start": "366240",
    "end": "369900"
  },
  {
    "text": "panel instrumentation good-old EBI EBI",
    "start": "369900",
    "end": "373110"
  },
  {
    "text": "has been around for a couple of decades",
    "start": "373110",
    "end": "375750"
  },
  {
    "text": "in software security it's why well it's",
    "start": "375750",
    "end": "380250"
  },
  {
    "text": "it's very easy to use it's easy to write",
    "start": "380250",
    "end": "382860"
  },
  {
    "text": "a dbi tool to do some monitoring tasks",
    "start": "382860",
    "end": "386550"
  },
  {
    "text": "so it's easy to extend a dbi system you",
    "start": "386550",
    "end": "389730"
  },
  {
    "text": "don't have semantic gaps actually you",
    "start": "389730",
    "end": "391530"
  },
  {
    "text": "operate in the same address space of the",
    "start": "391530",
    "end": "393510"
  },
  {
    "text": "program that you are analyzing this",
    "start": "393510",
    "end": "395790"
  },
  {
    "text": "means that you can be calling API of the",
    "start": "395790",
    "end": "399480"
  },
  {
    "text": "operating system to make",
    "start": "399480",
    "end": "401009"
  },
  {
    "text": "inspections or you can even be opening",
    "start": "401009",
    "end": "402809"
  },
  {
    "text": "file soon you have quite freedom if you",
    "start": "402809",
    "end": "406469"
  },
  {
    "text": "want to fake answers",
    "start": "406469",
    "end": "407729"
  },
  {
    "text": "DBI is focusing the the actions it's",
    "start": "407729",
    "end": "410309"
  },
  {
    "text": "restricting the impact on a single",
    "start": "410309",
    "end": "412860"
  },
  {
    "text": "process so you have better control on",
    "start": "412860",
    "end": "415080"
  },
  {
    "text": "this faking process and one big",
    "start": "415080",
    "end": "418199"
  },
  {
    "text": "advantage of the DVI abstraction is that",
    "start": "418199",
    "end": "420419"
  },
  {
    "text": "it's going to hide the code that",
    "start": "420419",
    "end": "422610"
  },
  {
    "text": "performs the analysis from the code that",
    "start": "422610",
    "end": "425520"
  },
  {
    "text": "gets analyzed there is a catch though",
    "start": "425520",
    "end": "428939"
  },
  {
    "text": "DBI works only in user space at least",
    "start": "428939",
    "end": "431729"
  },
  {
    "text": "most epi engines their user space we can",
    "start": "431729",
    "end": "434430"
  },
  {
    "text": "only do user LAN malware we have to do",
    "start": "434430",
    "end": "439710"
  },
  {
    "text": "observe check replace right so we have",
    "start": "439710",
    "end": "442499"
  },
  {
    "text": "to play some probes some hooks and we",
    "start": "442499",
    "end": "445439"
  },
  {
    "text": "start from low-level facts that you",
    "start": "445439",
    "end": "447270"
  },
  {
    "text": "might give away using special",
    "start": "447270",
    "end": "449039"
  },
  {
    "text": "instructions think of CPU ID or DTSC",
    "start": "449039",
    "end": "452219"
  },
  {
    "text": "those instructions but then you also",
    "start": "452219",
    "end": "455039"
  },
  {
    "text": "have high-level queries you have library",
    "start": "455039",
    "end": "457379"
  },
  {
    "text": "functions for to look for files",
    "start": "457379",
    "end": "459330"
  },
  {
    "text": "processes drivers of this kind of stuff",
    "start": "459330",
    "end": "461819"
  },
  {
    "text": "and you know malware authors they know",
    "start": "461819",
    "end": "465120"
  },
  {
    "text": "Windows internals very well so they",
    "start": "465120",
    "end": "467819"
  },
  {
    "text": "might be using system calls directly",
    "start": "467819",
    "end": "470129"
  },
  {
    "text": "system calls that this library function",
    "start": "470129",
    "end": "472620"
  },
  {
    "text": "used down there that might use system",
    "start": "472620",
    "end": "474599"
  },
  {
    "text": "calls directly so when you're writing",
    "start": "474599",
    "end": "476550"
  },
  {
    "text": "such a system it's it's better if you",
    "start": "476550",
    "end": "481249"
  },
  {
    "text": "you know place destroy mentation a",
    "start": "481249",
    "end": "483809"
  },
  {
    "text": "system call level so you are able to",
    "start": "483809",
    "end": "485610"
  },
  {
    "text": "catch in a single spot multiple library",
    "start": "485610",
    "end": "487800"
  },
  {
    "text": "implementation you have to take care of",
    "start": "487800",
    "end": "490919"
  },
  {
    "text": "exceptions exceptional control flow or",
    "start": "490919",
    "end": "493289"
  },
  {
    "text": "the windows management instrumentation",
    "start": "493289",
    "end": "495050"
  },
  {
    "text": "subsystem for queries that you can make",
    "start": "495050",
    "end": "498029"
  },
  {
    "text": "and it's important that for an analyst",
    "start": "498029",
    "end": "500939"
  },
  {
    "text": "these hooks are easy to extend or even",
    "start": "500939",
    "end": "503550"
  },
  {
    "text": "to create new ones because at some point",
    "start": "503550",
    "end": "505199"
  },
  {
    "text": "you're going to need them to dynamic",
    "start": "505199",
    "end": "509219"
  },
  {
    "start": "508000",
    "end": "609000"
  },
  {
    "text": "analysis so this means that we are",
    "start": "509219",
    "end": "512029"
  },
  {
    "text": "executing stuff under stein into the",
    "start": "512029",
    "end": "515250"
  },
  {
    "text": "equation so we have two enemies one is",
    "start": "515250",
    "end": "518459"
  },
  {
    "text": "hover detection we are analyzing",
    "start": "518459",
    "end": "520440"
  },
  {
    "text": "something we are slowing down the",
    "start": "520440",
    "end": "522690"
  },
  {
    "text": "execution so you may look for that for",
    "start": "522690",
    "end": "525510"
  },
  {
    "text": "those hot rods or the the sample might",
    "start": "525510",
    "end": "529649"
  },
  {
    "text": "play with us and play with our time",
    "start": "529649",
    "end": "532290"
  },
  {
    "text": "budget using stalling techniques",
    "start": "532290",
    "end": "534870"
  },
  {
    "text": "a lot of sleep operations that you have",
    "start": "534870",
    "end": "537600"
  },
  {
    "text": "to patch you can try to face both",
    "start": "537600",
    "end": "541470"
  },
  {
    "text": "problems by patching time-related",
    "start": "541470",
    "end": "543750"
  },
  {
    "text": "operations but you have to be wise in",
    "start": "543750",
    "end": "546720"
  },
  {
    "text": "that you need to you cannot patch them",
    "start": "546720",
    "end": "549330"
  },
  {
    "text": "independently you need to expose a",
    "start": "549330",
    "end": "551490"
  },
  {
    "text": "consistent view of the system so I'm",
    "start": "551490",
    "end": "553470"
  },
  {
    "text": "open the time and so you need a",
    "start": "553470",
    "end": "555960"
  },
  {
    "text": "coordinated faking also you can think",
    "start": "555960",
    "end": "559470"
  },
  {
    "text": "okay I'm going to fast forward time when",
    "start": "559470",
    "end": "561960"
  },
  {
    "text": "you try to sleep for that long or you",
    "start": "561960",
    "end": "563940"
  },
  {
    "text": "try to do many short sleep operations",
    "start": "563940",
    "end": "566880"
  },
  {
    "text": "but you have to keep track of the time",
    "start": "566880",
    "end": "569370"
  },
  {
    "text": "that a sample wants to sleep for because",
    "start": "569370",
    "end": "572070"
  },
  {
    "text": "when you're going to forge a value for a",
    "start": "572070",
    "end": "574470"
  },
  {
    "text": "time query then you also need to take",
    "start": "574470",
    "end": "576360"
  },
  {
    "text": "that time into the question okay you",
    "start": "576360",
    "end": "579480"
  },
  {
    "text": "might be telling me now but this is",
    "start": "579480",
    "end": "581279"
  },
  {
    "text": "hardly sound and I I agree with you it's",
    "start": "581279",
    "end": "584279"
  },
  {
    "text": "not but can work in practice for the",
    "start": "584279",
    "end": "586920"
  },
  {
    "text": "time patterns time related patterns that",
    "start": "586920",
    "end": "590370"
  },
  {
    "text": "we see in malware and if you do this for",
    "start": "590370",
    "end": "594120"
  },
  {
    "text": "a single process it's easier compared to",
    "start": "594120",
    "end": "596940"
  },
  {
    "text": "accelerating an entire virtual machine",
    "start": "596940",
    "end": "599100"
  },
  {
    "text": "because if you don't do that's right",
    "start": "599100",
    "end": "600450"
  },
  {
    "text": "Michaels instabilities inside the",
    "start": "600450",
    "end": "603060"
  },
  {
    "text": "operating system implementation you need",
    "start": "603060",
    "end": "605010"
  },
  {
    "text": "to distinguish what you are accelerating",
    "start": "605010",
    "end": "608450"
  },
  {
    "text": "yeah so far it's like I've been",
    "start": "608450",
    "end": "611490"
  },
  {
    "text": "presenting you as sandbox right so you",
    "start": "611490",
    "end": "613680"
  },
  {
    "text": "want to know how you make this section",
    "start": "613680",
    "end": "615750"
  },
  {
    "text": "here so we offer a gdb remote interface",
    "start": "615750",
    "end": "619650"
  },
  {
    "text": "for debugging so you can plug your",
    "start": "619650",
    "end": "621779"
  },
  {
    "text": "debugger on top of gdb remote protocol",
    "start": "621779",
    "end": "624900"
  },
  {
    "text": "which is offered by Intel pin this",
    "start": "624900",
    "end": "627839"
  },
  {
    "text": "dynamic manner instrumentation framework",
    "start": "627839",
    "end": "629520"
  },
  {
    "text": "we had to strengthen this interface to",
    "start": "629520",
    "end": "632760"
  },
  {
    "text": "deal with with some with the",
    "start": "632760",
    "end": "634860"
  },
  {
    "text": "peculiarities of the malware domain some",
    "start": "634860",
    "end": "637200"
  },
  {
    "text": "debugger detection stuff like that but",
    "start": "637200",
    "end": "639720"
  },
  {
    "text": "at the same time we also had to add",
    "start": "639720",
    "end": "641850"
  },
  {
    "text": "hooks to protect to shield the artifacts",
    "start": "641850",
    "end": "645150"
  },
  {
    "text": "that you have with monitoring tools when",
    "start": "645150",
    "end": "647010"
  },
  {
    "text": "you are intercepting network traffic",
    "start": "647010",
    "end": "648540"
  },
  {
    "text": "this kind of stuff so we hide those",
    "start": "648540",
    "end": "651209"
  },
  {
    "text": "artifacts plus high management code",
    "start": "651209",
    "end": "655680"
  },
  {
    "text": "edits so the idea is that we want users",
    "start": "655680",
    "end": "659220"
  },
  {
    "text": "to be able to change instructions in a",
    "start": "659220",
    "end": "661529"
  },
  {
    "text": "sample but if the sample tries to look",
    "start": "661529",
    "end": "664650"
  },
  {
    "text": "up its own code normally we'll see the",
    "start": "664650",
    "end": "666720"
  },
  {
    "text": "changes right",
    "start": "666720",
    "end": "667710"
  },
  {
    "text": "but with EBI the nice thing is that you",
    "start": "667710",
    "end": "670290"
  },
  {
    "text": "have a decouple view or what you execute",
    "start": "670290",
    "end": "672570"
  },
  {
    "text": "and what's the original code so we are",
    "start": "672570",
    "end": "674760"
  },
  {
    "text": "able to intervene the JIT compilation",
    "start": "674760",
    "end": "676320"
  },
  {
    "text": "process that happens in the dbi engine",
    "start": "676320",
    "end": "679050"
  },
  {
    "text": "to replace the original instructions",
    "start": "679050",
    "end": "680880"
  },
  {
    "text": "with some trampoline to a region so this",
    "start": "680880",
    "end": "683550"
  },
  {
    "text": "means that from starting with one bite",
    "start": "683550",
    "end": "685620"
  },
  {
    "text": "you can squeeze in a patch of arbitrary",
    "start": "685620",
    "end": "687630"
  },
  {
    "text": "length and the sample will still see the",
    "start": "687630",
    "end": "689820"
  },
  {
    "text": "original instructions and I have a",
    "start": "689820",
    "end": "692940"
  },
  {
    "text": "confession to make I lied to you or",
    "start": "692940",
    "end": "695399"
  },
  {
    "start": "695000",
    "end": "793000"
  },
  {
    "text": "let's say I omitted something from you",
    "start": "695399",
    "end": "697920"
  },
  {
    "text": "and I haven't been addressing DBI",
    "start": "697920",
    "end": "700770"
  },
  {
    "text": "evasions so previous blackhat editions",
    "start": "700770",
    "end": "703890"
  },
  {
    "text": "we had very nice talks on ways that you",
    "start": "703890",
    "end": "706649"
  },
  {
    "text": "came detect the presence of DB I itself",
    "start": "706649",
    "end": "708959"
  },
  {
    "text": "and earlier this year I worked on this",
    "start": "708959",
    "end": "712290"
  },
  {
    "text": "issue CCS paper on using the BI for",
    "start": "712290",
    "end": "715620"
  },
  {
    "text": "security and how I got caught red-handed",
    "start": "715620",
    "end": "718610"
  },
  {
    "text": "we we devised a library of mitigations",
    "start": "718610",
    "end": "722880"
  },
  {
    "text": "that we also use in blue peel and",
    "start": "722880",
    "end": "725940"
  },
  {
    "text": "actually we extend those mitigations to",
    "start": "725940",
    "end": "728130"
  },
  {
    "text": "deal with time over it and further",
    "start": "728130",
    "end": "730320"
  },
  {
    "text": "artifacts that they arise when you're",
    "start": "730320",
    "end": "732180"
  },
  {
    "text": "debugging there's one more thing",
    "start": "732180",
    "end": "736589"
  },
  {
    "text": "that is that I like in this in this",
    "start": "736589",
    "end": "740279"
  },
  {
    "text": "project is that you have dynamic manner",
    "start": "740279",
    "end": "742950"
  },
  {
    "text": "instrumentation you're able to device",
    "start": "742950",
    "end": "745110"
  },
  {
    "text": "your analysis why don't we use powerful",
    "start": "745110",
    "end": "748529"
  },
  {
    "text": "existing program analysis that are",
    "start": "748529",
    "end": "750930"
  },
  {
    "text": "useful for reverse engineering where I",
    "start": "750930",
    "end": "753209"
  },
  {
    "text": "think of taint analysis so normally when",
    "start": "753209",
    "end": "756060"
  },
  {
    "text": "you use the internal assess or symbolic",
    "start": "756060",
    "end": "757920"
  },
  {
    "text": "execution and black box manner you hit",
    "start": "757920",
    "end": "760890"
  },
  {
    "text": "the wall so you have scalability or in",
    "start": "760890",
    "end": "763380"
  },
  {
    "text": "procedure you have this kind of problem",
    "start": "763380",
    "end": "765570"
  },
  {
    "text": "but what if you put this analysis under",
    "start": "765570",
    "end": "770040"
  },
  {
    "text": "the control of an analyst so let's say",
    "start": "770040",
    "end": "772560"
  },
  {
    "text": "that you spot something interesting",
    "start": "772560",
    "end": "774570"
  },
  {
    "text": "during the dissection not before",
    "start": "774570",
    "end": "776339"
  },
  {
    "text": "starting the analysis so you might",
    "start": "776339",
    "end": "778290"
  },
  {
    "text": "decide okay I want to put a tenth mark",
    "start": "778290",
    "end": "780510"
  },
  {
    "text": "on this buffer and I want to see how the",
    "start": "780510",
    "end": "782880"
  },
  {
    "text": "program is going to manipulate those",
    "start": "782880",
    "end": "784470"
  },
  {
    "text": "data and I will be getting back to this",
    "start": "784470",
    "end": "786570"
  },
  {
    "text": "in a little bit it's time that I show",
    "start": "786570",
    "end": "789870"
  },
  {
    "text": "you how you can actually use blue peel",
    "start": "789870",
    "end": "792589"
  },
  {
    "text": "so this is what you will do today I",
    "start": "792589",
    "end": "795450"
  },
  {
    "start": "793000",
    "end": "905000"
  },
  {
    "text": "think you have a number of sand boxes",
    "start": "795450",
    "end": "797790"
  },
  {
    "text": "for the automatic stage you get your",
    "start": "797790",
    "end": "800279"
  },
  {
    "text": "reports",
    "start": "800279",
    "end": "801150"
  },
  {
    "text": "and then you moved to the dissection",
    "start": "801150",
    "end": "802560"
  },
  {
    "text": "stage the manual stage so you start in",
    "start": "802560",
    "end": "806130"
  },
  {
    "text": "your debugging in your debugging session",
    "start": "806130",
    "end": "808640"
  },
  {
    "text": "you have to discern a run mirror of red",
    "start": "808640",
    "end": "811620"
  },
  {
    "text": "pills for your hypervisor because maybe",
    "start": "811620",
    "end": "813720"
  },
  {
    "text": "you're using VirtualBox VM ware so you",
    "start": "813720",
    "end": "816300"
  },
  {
    "text": "need to disarm those pills this arm",
    "start": "816300",
    "end": "818490"
  },
  {
    "text": "feels for debuggers you waste some time",
    "start": "818490",
    "end": "820680"
  },
  {
    "text": "right and then then you meet a new",
    "start": "820680",
    "end": "823080"
  },
  {
    "text": "version one day and you have to think",
    "start": "823080",
    "end": "825690"
  },
  {
    "text": "hard how to fight this evasion and my",
    "start": "825690",
    "end": "829260"
  },
  {
    "text": "you came up with a solution eventually",
    "start": "829260",
    "end": "830960"
  },
  {
    "text": "you have an adult illusion and you know",
    "start": "830960",
    "end": "834480"
  },
  {
    "text": "you restart the analysis but when it",
    "start": "834480",
    "end": "837240"
  },
  {
    "text": "faced another sample it's like you're",
    "start": "837240",
    "end": "840750"
  },
  {
    "text": "going to start over right with new pill",
    "start": "840750",
    "end": "843690"
  },
  {
    "text": "we try to put everything in a single",
    "start": "843690",
    "end": "846210"
  },
  {
    "text": "piece in a single box we try to",
    "start": "846210",
    "end": "848700"
  },
  {
    "text": "reconcile automatic and manual analysis",
    "start": "848700",
    "end": "850980"
  },
  {
    "text": "by that I mean that for starters so you",
    "start": "850980",
    "end": "855660"
  },
  {
    "text": "get your report from your sandbox or a",
    "start": "855660",
    "end": "857640"
  },
  {
    "text": "shorter smaller report in blue pill you",
    "start": "857640",
    "end": "860280"
  },
  {
    "text": "start the dissection phase and we're",
    "start": "860280",
    "end": "863190"
  },
  {
    "text": "shielding you from the red pills that we",
    "start": "863190",
    "end": "866760"
  },
  {
    "text": "already know for debuggers hypervisors",
    "start": "866760",
    "end": "869880"
  },
  {
    "text": "all this stuff then maybe you brought",
    "start": "869880",
    "end": "871950"
  },
  {
    "text": "some hooks that monitor specific aspects",
    "start": "871950",
    "end": "874650"
  },
  {
    "text": "of the system or they change them you",
    "start": "874650",
    "end": "876750"
  },
  {
    "text": "made a new evasion and what you do of",
    "start": "876750",
    "end": "879240"
  },
  {
    "text": "course you still have to think hard to",
    "start": "879240",
    "end": "881820"
  },
  {
    "text": "fight the evasion but you can add some",
    "start": "881820",
    "end": "884430"
  },
  {
    "text": "hooks to the system you make some you",
    "start": "884430",
    "end": "886800"
  },
  {
    "text": "make some attempts eventually figure out",
    "start": "886800",
    "end": "889020"
  },
  {
    "text": "the solution a countermeasure but this",
    "start": "889020",
    "end": "891720"
  },
  {
    "text": "time as part of a feedback loop this",
    "start": "891720",
    "end": "893850"
  },
  {
    "text": "countermeasure is going to extend the",
    "start": "893850",
    "end": "896310"
  },
  {
    "text": "system so the human agent is going to",
    "start": "896310",
    "end": "898830"
  },
  {
    "text": "extend the system and so you can reuse",
    "start": "898830",
    "end": "901640"
  },
  {
    "text": "your work next time we trained this way",
    "start": "901640",
    "end": "907230"
  },
  {
    "text": "to make our implementation stronger we",
    "start": "907230",
    "end": "910500"
  },
  {
    "text": "started with tools like al qussair",
    "start": "910500",
    "end": "913140"
  },
  {
    "text": "or all the red pills that are they're",
    "start": "913140",
    "end": "915720"
  },
  {
    "text": "out there for debugging hypervisors and",
    "start": "915720",
    "end": "918890"
  },
  {
    "text": "then we move to complex malware we took",
    "start": "918890",
    "end": "922920"
  },
  {
    "text": "on quite a few notable samples with",
    "start": "922920",
    "end": "925560"
  },
  {
    "text": "exotic evasions this kind of stuff but",
    "start": "925560",
    "end": "928320"
  },
  {
    "text": "we learned a lot also from executable",
    "start": "928320",
    "end": "930570"
  },
  {
    "text": "protectors so there are protectors like",
    "start": "930570",
    "end": "933240"
  },
  {
    "text": "the EM protect that",
    "start": "933240",
    "end": "934510"
  },
  {
    "text": "have very nasty elegant tricks to disarm",
    "start": "934510",
    "end": "937750"
  },
  {
    "text": "and but yeah maybe you're not sold on",
    "start": "937750",
    "end": "942070"
  },
  {
    "text": "this one yet you might even myself I",
    "start": "942070",
    "end": "944710"
  },
  {
    "text": "thought maybe I'm biased this really",
    "start": "944710",
    "end": "946330"
  },
  {
    "text": "that extensible the system so we we we",
    "start": "946330",
    "end": "951070"
  },
  {
    "text": "made this experiment we took some",
    "start": "951070",
    "end": "952960"
  },
  {
    "text": "computer science students and we give we",
    "start": "952960",
    "end": "955210"
  },
  {
    "text": "gave them some notable evasive malware",
    "start": "955210",
    "end": "958000"
  },
  {
    "text": "we gave them for team for team is a",
    "start": "958000",
    "end": "961870"
  },
  {
    "text": "sample that three years ago was able to",
    "start": "961870",
    "end": "964660"
  },
  {
    "text": "evade nearly any sandbox that was around",
    "start": "964660",
    "end": "968040"
  },
  {
    "text": "send send boxes but they had also",
    "start": "968040",
    "end": "971800"
  },
  {
    "text": "countermeasures for human analysts or AV",
    "start": "971800",
    "end": "975070"
  },
  {
    "text": "products fire was all kind of stuff more",
    "start": "975070",
    "end": "977740"
  },
  {
    "text": "than four hundred evasive tricks in one",
    "start": "977740",
    "end": "980230"
  },
  {
    "text": "sample so this is a masterpiece for",
    "start": "980230",
    "end": "982270"
  },
  {
    "text": "evasion there is a very nice report from",
    "start": "982270",
    "end": "986080"
  },
  {
    "text": "Sentinel one so we we knew this report",
    "start": "986080",
    "end": "989590"
  },
  {
    "text": "the students didn't high square",
    "start": "989590",
    "end": "991600"
  },
  {
    "text": "we knew that one hook was missing in",
    "start": "991600",
    "end": "994570"
  },
  {
    "text": "blue pill for anti enumerate key what we",
    "start": "994570",
    "end": "998050"
  },
  {
    "text": "didn't know is that was another evasion",
    "start": "998050",
    "end": "1000390"
  },
  {
    "text": "that was undocumented even in that",
    "start": "1000390",
    "end": "1002490"
  },
  {
    "text": "report about animal display settings but",
    "start": "1002490",
    "end": "1005550"
  },
  {
    "text": "first thing first ante enumerate key so",
    "start": "1005550",
    "end": "1010670"
  },
  {
    "text": "an initial analysis in blue pill",
    "start": "1010670",
    "end": "1013560"
  },
  {
    "start": "1011000",
    "end": "1097000"
  },
  {
    "text": "revealed quite a few evasive queries the",
    "start": "1013560",
    "end": "1016500"
  },
  {
    "text": "students decided to focus on this one",
    "start": "1016500",
    "end": "1019740"
  },
  {
    "text": "that was based on antique query system",
    "start": "1019740",
    "end": "1022920"
  },
  {
    "text": "information so we already handle that",
    "start": "1022920",
    "end": "1027150"
  },
  {
    "text": "evasion but the students decide to put a",
    "start": "1027150",
    "end": "1029250"
  },
  {
    "text": "taint mark on the output of this system",
    "start": "1029250",
    "end": "1032610"
  },
  {
    "text": "call to see how for symbol process this",
    "start": "1032610",
    "end": "1035819"
  },
  {
    "text": "data and this revealed the presence of",
    "start": "1035820",
    "end": "1038189"
  },
  {
    "text": "watch our string processing functions so",
    "start": "1038190",
    "end": "1041490"
  },
  {
    "text": "they brought some hooks just to",
    "start": "1041490",
    "end": "1043230"
  },
  {
    "text": "intercept those functions and print the",
    "start": "1043230",
    "end": "1045209"
  },
  {
    "text": "arguments at some point this debug",
    "start": "1045209",
    "end": "1048329"
  },
  {
    "text": "string appeared so what they had to do",
    "start": "1048329",
    "end": "1051150"
  },
  {
    "text": "is to write a hook to make this",
    "start": "1051150",
    "end": "1054870"
  },
  {
    "text": "disappear so they trace back the string",
    "start": "1054870",
    "end": "1057990"
  },
  {
    "text": "from to the anti enumerate key is called",
    "start": "1057990",
    "end": "1061170"
  },
  {
    "text": "the Interceptor this is call and when",
    "start": "1061170",
    "end": "1064260"
  },
  {
    "text": "the parameter is key basic information",
    "start": "1064260",
    "end": "1066900"
  },
  {
    "text": "and",
    "start": "1066900",
    "end": "1068190"
  },
  {
    "text": "the name field of this structure",
    "start": "1068190",
    "end": "1069900"
  },
  {
    "text": "contains VirtualBox they replace it with",
    "start": "1069900",
    "end": "1072150"
  },
  {
    "text": "some random string and this works it's",
    "start": "1072150",
    "end": "1075810"
  },
  {
    "text": "not enough though there was this other",
    "start": "1075810",
    "end": "1078570"
  },
  {
    "text": "evasion which actually revealed the",
    "start": "1078570",
    "end": "1081690"
  },
  {
    "text": "presence of the VirtualBox when you're",
    "start": "1081690",
    "end": "1084660"
  },
  {
    "text": "looking for the mode supported by a",
    "start": "1084660",
    "end": "1087390"
  },
  {
    "text": "display there will be a VirtualBox",
    "start": "1087390",
    "end": "1089940"
  },
  {
    "text": "string coming out and this is a simple",
    "start": "1089940",
    "end": "1092430"
  },
  {
    "text": "countermeasure to defeat this evasion",
    "start": "1092430",
    "end": "1096410"
  },
  {
    "text": "what would you like to do next will",
    "start": "1096410",
    "end": "1099150"
  },
  {
    "start": "1097000",
    "end": "1182000"
  },
  {
    "text": "actively working on blue pill we would",
    "start": "1099150",
    "end": "1102210"
  },
  {
    "text": "like to add other features that can help",
    "start": "1102210",
    "end": "1104220"
  },
  {
    "text": "other analysis tasks like robust API",
    "start": "1104220",
    "end": "1107910"
  },
  {
    "text": "tracing or malware unpacking but we also",
    "start": "1107910",
    "end": "1111180"
  },
  {
    "text": "like to see how much of this can be",
    "start": "1111180",
    "end": "1113820"
  },
  {
    "text": "applied to virtual machine introspection",
    "start": "1113820",
    "end": "1116010"
  },
  {
    "text": "technology for instance when you're",
    "start": "1116010",
    "end": "1117600"
  },
  {
    "text": "dealing with targeted malware where",
    "start": "1117600",
    "end": "1120540"
  },
  {
    "text": "transparency is just one part of the",
    "start": "1120540",
    "end": "1122880"
  },
  {
    "text": "story you also have targeted attempts we",
    "start": "1122880",
    "end": "1126660"
  },
  {
    "text": "have an upcoming research paper on this",
    "start": "1126660",
    "end": "1128760"
  },
  {
    "text": "one but what we'll really hop out of",
    "start": "1128760",
    "end": "1132510"
  },
  {
    "text": "this is that people are going to give us",
    "start": "1132510",
    "end": "1135570"
  },
  {
    "text": "feedback this is the reason why we are",
    "start": "1135570",
    "end": "1138360"
  },
  {
    "text": "releasing blue pill as open source we",
    "start": "1138360",
    "end": "1141330"
  },
  {
    "text": "really hope to hear from the community",
    "start": "1141330",
    "end": "1143100"
  },
  {
    "text": "if the community is going to contribute",
    "start": "1143100",
    "end": "1145980"
  },
  {
    "text": "to this project it will be amazing and I",
    "start": "1145980",
    "end": "1149160"
  },
  {
    "text": "would like to conclude my talk by saying",
    "start": "1149160",
    "end": "1152100"
  },
  {
    "text": "that if your you're a malware on OS you",
    "start": "1152100",
    "end": "1155130"
  },
  {
    "text": "know your time is precious you don't",
    "start": "1155130",
    "end": "1156780"
  },
  {
    "text": "want to waste that disarming non red",
    "start": "1156780",
    "end": "1159750"
  },
  {
    "text": "pills doing this repetitive work but if",
    "start": "1159750",
    "end": "1162750"
  },
  {
    "text": "you're an employer and you're employing",
    "start": "1162750",
    "end": "1164670"
  },
  {
    "text": "malware analysts you know that malware",
    "start": "1164670",
    "end": "1166230"
  },
  {
    "text": "analysts aren't cheap either so um yeah",
    "start": "1166230",
    "end": "1170010"
  },
  {
    "text": "I hope that blue pill can be useful for",
    "start": "1170010",
    "end": "1172170"
  },
  {
    "text": "for dealing with evasive malware thank",
    "start": "1172170",
    "end": "1174750"
  },
  {
    "text": "you very much",
    "start": "1174750",
    "end": "1176730"
  },
  {
    "text": "[Applause]",
    "start": "1176730",
    "end": "1184789"
  }
]