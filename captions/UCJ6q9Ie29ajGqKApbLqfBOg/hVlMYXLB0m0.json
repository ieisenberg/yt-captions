[
  {
    "start": "0",
    "end": "50000"
  },
  {
    "text": "hi everyone welcome to black hat 2015 thank you so much for being here couple",
    "start": "359",
    "end": "5600"
  },
  {
    "text": "quick announcements um there will be a reception tonight in the business Hall",
    "start": "5600",
    "end": "10840"
  },
  {
    "text": "at 5:30 the business Hall is located in Shoreline a room uh the pony Awards will",
    "start": "10840",
    "end": "17720"
  },
  {
    "text": "be taking place tonight in Mandalay Bay BCD room at 6",
    "start": "17720",
    "end": "24480"
  },
  {
    "text": "p.m. and you are currently in Mandalay Bay G8",
    "start": "24480",
    "end": "30480"
  },
  {
    "text": "for the session big game hunting the peculiarities of nation state malware",
    "start": "30480",
    "end": "36280"
  },
  {
    "text": "research with Morgan Marquee bore and Marion Marshal thank you so much and",
    "start": "36280",
    "end": "43320"
  },
  {
    "text": "please make sure to uh silence your cell phones enjoy the",
    "start": "43320",
    "end": "49000"
  },
  {
    "text": "talk thank you awesome t t great look sounds like we're live so uh welcome to",
    "start": "49000",
    "end": "55440"
  },
  {
    "start": "50000",
    "end": "103000"
  },
  {
    "text": "big game hunting peculiarities in nation state malware research",
    "start": "55440",
    "end": "60640"
  },
  {
    "text": "uh I'm Morgan M Bo and I'm currently the director of security at firstlook media",
    "start": "60640",
    "end": "66799"
  },
  {
    "text": "and I'm also a researcher at the citizen Lab at the University of Toronto hello everyone my name is Marin",
    "start": "66799",
    "end": "72520"
  },
  {
    "text": "mle I'm a senior malel researcher at a US startup named cyfor and today I'm",
    "start": "72520",
    "end": "79439"
  },
  {
    "text": "very happy to be part of the probably most the worst blackhe talk in history",
    "start": "79439",
    "end": "85200"
  },
  {
    "text": "um we're here today uh a female speaker and a",
    "start": "85200",
    "end": "90680"
  },
  {
    "text": "uh dark skinned speaker we're very sad to miss our third part unfortunately",
    "start": "90680",
    "end": "96240"
  },
  {
    "text": "cladio couldn't make it today um you know we are we are all",
    "start": "96240",
    "end": "102479"
  },
  {
    "text": "cladio so yeah we've got a lot to get through so you should probably get on with it um so we're going to talk about",
    "start": "102799",
    "end": "110079"
  },
  {
    "text": "the peculiarities of nation state malware research today so we we'll kind of talk a bit about uh the rise of",
    "start": "110079",
    "end": "115200"
  },
  {
    "text": "threat intelligence how the AV industry sort of transitioned to that and some of the practices",
    "start": "115200",
    "end": "120600"
  },
  {
    "text": "um we'll talk about a novel approach in binary attribution and some of the more",
    "start": "120600",
    "end": "126159"
  },
  {
    "text": "unpleasant side effects of being targets of Espionage uh we'll cover lies that",
    "start": "126159",
    "end": "133080"
  },
  {
    "text": "vendors tell and when things actually get bizar personal I'm not sure Twitter has been the best for our industry um",
    "start": "133080",
    "end": "139360"
  },
  {
    "text": "and then you at the end you know because you're all going to be experts on this topic we're going to kind of have a Choose Your Own Adventure you know",
    "start": "139360",
    "end": "145879"
  },
  {
    "text": "analyze along with us nation state malware session um so but in order to lend a bit of context",
    "start": "145879",
    "end": "152920"
  },
  {
    "text": "to all of this um you some of you might remember back in sort of early 2010 when",
    "start": "152920",
    "end": "158760"
  },
  {
    "text": "Google announced that they' been hacked by China um the hack occurred in 2009",
    "start": "158760",
    "end": "164680"
  },
  {
    "text": "but a lot of the narrative that sort of in uh happened over the next six months",
    "start": "164680",
    "end": "170000"
  },
  {
    "text": "or so was you know we learned that it wasn't just Google that was hacked by China that Silicon Valley had been hacked by China and then you know we",
    "start": "170000",
    "end": "176360"
  },
  {
    "text": "kind of learned that everybody had been hacked by China and there was a lot of like you know sort of beating and finger wagging and you know China how could you",
    "start": "176360",
    "end": "182440"
  },
  {
    "text": "hack our beloved Silicon Valley companies we're very angry with you um and then of course we learned that it",
    "start": "182440",
    "end": "187920"
  },
  {
    "text": "wasn't just China that was hacking everybody um you know some of you guys might remember an incident at the",
    "start": "187920",
    "end": "194040"
  },
  {
    "text": "beginning of the mid 2010 2011 um you",
    "start": "194040",
    "end": "199200"
  },
  {
    "text": "know stuck net was discovered the world's first cyber digital cyber cyber weapon um and you know this was",
    "start": "199200",
    "end": "207200"
  },
  {
    "text": "allegedly a joint effort by the US and isra to sabotage Iran's nuclear program",
    "start": "207200",
    "end": "212680"
  },
  {
    "text": "um this actually led to a whole family of sort of Israeli malware falling out uh kasperski called it the Tilted",
    "start": "212680",
    "end": "219120"
  },
  {
    "text": "platform I think we had Dooku as well um gal uh and I mean attribution is tricky",
    "start": "219120",
    "end": "226599"
  },
  {
    "text": "right but so they they called it the Tilted platform because of the uh",
    "start": "226599",
    "end": "232000"
  },
  {
    "text": "tendency of the malware to create temp files that started with a tied",
    "start": "232000",
    "end": "237360"
  },
  {
    "text": "d uh more recently the malware used by the allegedly",
    "start": "237720",
    "end": "244000"
  },
  {
    "start": "238000",
    "end": "287000"
  },
  {
    "text": "British government um called Regin was outed it was the Snowden documents",
    "start": "244000",
    "end": "249239"
  },
  {
    "text": "revealed that the gchq had hacked uh telecommunications provider belgacom and",
    "start": "249239",
    "end": "255120"
  },
  {
    "text": "also the European Union and you know a variety of people released analysis on this and I'm going to talk a little bit more about it later and as it turns out",
    "start": "255120",
    "end": "263000"
  },
  {
    "text": "the uh British intelligence hasn't been the only European uh intelligence service being active on the nation state",
    "start": "263000",
    "end": "269440"
  },
  {
    "text": "m sector um just recently uh interesting documents were leaked by uh Edward",
    "start": "269440",
    "end": "275160"
  },
  {
    "text": "Snowden published by the in Germany revealing that the French government uh was also using Espionage tools to uh spy",
    "start": "275160",
    "end": "283160"
  },
  {
    "text": "on institutions in the Middle East right so most recently you probably",
    "start": "283160",
    "end": "289880"
  },
  {
    "text": "remember that kasperski produced a big report around equation which is sort of allegedly the nsa's malware uh so I mean",
    "start": "289880",
    "end": "297080"
  },
  {
    "text": "that the sort of the takeaway from this is that you know everybody's hacking everybody all the time or or at least",
    "start": "297080",
    "end": "304600"
  },
  {
    "text": "all of the big countries are sort of using hacking as a tool of Espionage and that the smaller countries wish that",
    "start": "304600",
    "end": "310080"
  },
  {
    "text": "they were um I mean we also learned some other interesting things uh Wikileaks",
    "start": "310080",
    "end": "315960"
  },
  {
    "text": "released the Spy files in 2011 12 uh and you know this was a sort",
    "start": "315960",
    "end": "322160"
  },
  {
    "text": "of a series of promotional materials from conferences where sort of surveillance equipment and capability was sold uh from these we learned that",
    "start": "322160",
    "end": "330479"
  },
  {
    "text": "hacking team finfisher and vuin were selling exploits and implants and Trojans and that sort of thing and you",
    "start": "330479",
    "end": "336520"
  },
  {
    "text": "know then over the next few years we learned that actually everybody was selling exploits and implants and Trojans uh someone tried to sell me some",
    "start": "336520",
    "end": "343199"
  },
  {
    "text": "at the door um so what what this has actually meant for the the the sort of",
    "start": "343199",
    "end": "350000"
  },
  {
    "text": "the state of the industry is that I mean for anyone who has wandered the vendor",
    "start": "350000",
    "end": "355759"
  },
  {
    "text": "hall or in fact is even staying in this hotel you know I woke up in the morning and there was a tag on my door which said you need more threat intelligence",
    "start": "355759",
    "end": "363000"
  },
  {
    "text": "um and so so this is actually kind of LED from sort of Av which was sort of once the redheaded stepchild of the",
    "start": "363000",
    "end": "368120"
  },
  {
    "text": "security scene like malare wasn't actually very cool only sort of EV has rebranded itself as threat Intel um so",
    "start": "368120",
    "end": "376240"
  },
  {
    "text": "we call it AV 2.0 cuz some of you are probably familiar with the Web 2.0 statement that if you're not paying for",
    "start": "376240",
    "end": "381840"
  },
  {
    "text": "the software then you are the product well EV 2.0 has managed to do one bidder",
    "start": "381840",
    "end": "387039"
  },
  {
    "text": "you're the product and you're still paying for their software this is kind of strange right so um let",
    "start": "387039",
    "end": "393800"
  },
  {
    "text": "me tell you about myself a bit I am actually I grew up in antivirus so that's how I started on mware and watched it become the threat",
    "start": "393800",
    "end": "399880"
  },
  {
    "text": "intelligence industry um but how how did that happen and why why are the customers the the product um so we see",
    "start": "399880",
    "end": "406280"
  },
  {
    "text": "some very very interesting shifts um the most peculiar shift uh I perceived in the past few years was the the mware",
    "start": "406280",
    "end": "412759"
  },
  {
    "text": "detection uh has kind of transitioned to melbour watching so still our security products try to stop melbour and try to",
    "start": "412759",
    "end": "419120"
  },
  {
    "text": "detect and detain it but what is also happening is that our security products are noway watching malare trying to get",
    "start": "419120",
    "end": "425039"
  },
  {
    "text": "their Teter data and intelligence about what the m is doing where it comes from who operat it who rode it and who else",
    "start": "425039",
    "end": "431680"
  },
  {
    "text": "is affected by the same kind of M so imagine like something um something like",
    "start": "431680",
    "end": "437599"
  },
  {
    "text": "a a robbery at the house so what we see in the fat toil industry is uh an",
    "start": "437599",
    "end": "443759"
  },
  {
    "text": "ongoing robbery you have a house that is being breached by thieves who are going",
    "start": "443759",
    "end": "449919"
  },
  {
    "text": "in stealing stuff and going out again um in real world this will be stopped the the will be detained um in threat to",
    "start": "449919",
    "end": "456919"
  },
  {
    "text": "Industry companies security companies are watching these thieves going into company networks watching the thieves uh",
    "start": "456919",
    "end": "463639"
  },
  {
    "text": "spreading in the company Network watching the thieves uh draging data off the company Network and then they're like investigating where did the thieves",
    "start": "463639",
    "end": "470800"
  },
  {
    "text": "come from why did the thieves steal exactly what they stole um what was the intention of the these where the th of",
    "start": "470800",
    "end": "476240"
  },
  {
    "text": "other targets as well and then they write a report about why the thieves were following the targets so if you",
    "start": "476240",
    "end": "482479"
  },
  {
    "text": "compare this with uh the threaten to with with the real world you see there's something something weird going on right",
    "start": "482479",
    "end": "488520"
  },
  {
    "text": "so we have this uh in fact more watching we have actor tracking in F we very",
    "start": "488520",
    "end": "495120"
  },
  {
    "text": "interested uh who our actors are and another peculiar thing in this industry",
    "start": "495120",
    "end": "500240"
  },
  {
    "text": "is that all of a sudden actors and their malware and they intentions are very good publicity for the companies who",
    "start": "500240",
    "end": "505960"
  },
  {
    "text": "actually detect this kind of uh activity so we have um our famous Mel being",
    "start": "505960",
    "end": "514159"
  },
  {
    "text": "numbered being uh tag with names being type logos and um the most interesting",
    "start": "514159",
    "end": "521080"
  },
  {
    "text": "part of this is probably the precious trous as I call it um the highly highly",
    "start": "521080",
    "end": "527080"
  },
  {
    "text": "targeted nation state M so we have our press Treasures which are particularly",
    "start": "527080",
    "end": "532279"
  },
  {
    "text": "interesting for publicity because they actually cause public interest they are",
    "start": "532279",
    "end": "537959"
  },
  {
    "text": "of public interest and they do in fact not Target a large group of people so as a security company",
    "start": "537959",
    "end": "544160"
  },
  {
    "text": "you're not in danger to actually um uh and your customers by publishing",
    "start": "544160",
    "end": "550079"
  },
  {
    "text": "this kind of threat but you create a lot of publicity this is why they're precious",
    "start": "550079",
    "end": "555640"
  },
  {
    "text": "Treasures um how do you find these pressure stress actually like like searching for a needle and a hch we have",
    "start": "555640",
    "end": "561800"
  },
  {
    "text": "these huge hchs of thousands and and more than thousands and thousands more",
    "start": "561800",
    "end": "566920"
  },
  {
    "text": "than thousands of Mel samples each day depending on which report you read uh the numbers rise and fall but what is",
    "start": "566920",
    "end": "573720"
  },
  {
    "text": "happening with all these samples with the hyex is they're being traded they're being sent out they're being spread",
    "start": "573720",
    "end": "579000"
  },
  {
    "text": "everyone has the same sample set or should have the same sample set and process them accordingly they're being",
    "start": "579000",
    "end": "584120"
  },
  {
    "text": "taged they're being categorized um what happens though uh when you are searching for these precious thres that are Nation",
    "start": "584120",
    "end": "591000"
  },
  {
    "text": "MERS you're not happy with the hasts because you can't find your needle in this HC so what we're going to be",
    "start": "591000",
    "end": "596800"
  },
  {
    "text": "talking about today is the needle processing we want to find our needles um for finding the needles in these H",
    "start": "596800",
    "end": "602880"
  },
  {
    "text": "Stacks you have various different uh means and options to gather your data um",
    "start": "602880",
    "end": "608120"
  },
  {
    "text": "the most wellknown one and least documented one is the threat intelligence I've been talking about threat intelligence Al but let me tell",
    "start": "608120",
    "end": "614279"
  },
  {
    "text": "you there is no really feasible grabbable definition for threat intelligence same happens with Telemetry",
    "start": "614279",
    "end": "620560"
  },
  {
    "text": "data these are like the vocabularies you see on on security vendors blogs and saying oh we found this through our",
    "start": "620560",
    "end": "627040"
  },
  {
    "text": "Telemetry system what is telemetry data I'm going to be speaking about this in a",
    "start": "627040",
    "end": "632560"
  },
  {
    "text": "second more but teley and threat intelligence are very good sources to help us find stuff that we already know",
    "start": "632560",
    "end": "640079"
  },
  {
    "text": "find indicators or use indicators that we have to find other samples to the indicators that we had um another just",
    "start": "640079",
    "end": "648120"
  },
  {
    "text": "uh recently evolved method of finding our needles in the htic our leaked documents Edward Snowden was the um well",
    "start": "648120",
    "end": "658639"
  },
  {
    "text": "let me call him star on this on this stage to leak documents to um enable",
    "start": "658639",
    "end": "664440"
  },
  {
    "text": "analysts to link to credibly link binaries to actors another way to find our needles",
    "start": "664440",
    "end": "671600"
  },
  {
    "text": "are of course infected Machines of people who were infected with nation state M and last but not least my",
    "start": "671600",
    "end": "676800"
  },
  {
    "text": "favorite one and most pocar one the gossip I still can't quite believe how much actually really valuable",
    "start": "676800",
    "end": "683680"
  },
  {
    "text": "information in our business is exchanged from one person to another while we",
    "start": "683680",
    "end": "688880"
  },
  {
    "text": "think we in the digital age all right um let me get back to the Telemetry data uh",
    "start": "688880",
    "end": "695720"
  },
  {
    "start": "691000",
    "end": "816000"
  },
  {
    "text": "I call this our endpoint Wars so Telemetry data is effectively data collected from infected",
    "start": "695720",
    "end": "702519"
  },
  {
    "text": "endpoints to get this data one would need an endpoint agent so actually for",
    "start": "702519",
    "end": "708279"
  },
  {
    "text": "in in um we didn't call these endpoint agents we didn't call these endpoint agents until uh we read our first gner",
    "start": "708279",
    "end": "715639"
  },
  {
    "text": "reports where we learned that we are actually working on ination so this is the inter engines as they were invented",
    "start": "715639",
    "end": "721639"
  },
  {
    "text": "to detect threats these inations are fed with thread indicators these threat indicators are used to detect threats",
    "start": "721639",
    "end": "727040"
  },
  {
    "text": "and to uh mitigate uh threats um and also to exchange data so what happens",
    "start": "727040",
    "end": "734199"
  },
  {
    "text": "when you have an endpoint agent on your machine is this agent who receives data from the security company and sends back",
    "start": "734199",
    "end": "739880"
  },
  {
    "text": "data from the infections on your machine this works the following way so we have our endpoint agent the endpoint agent is",
    "start": "739880",
    "end": "745639"
  },
  {
    "text": "fed with thread indicators these were initially signatures nowadays it's ioc's and I don't know which new names were",
    "start": "745639",
    "end": "751800"
  },
  {
    "text": "invented so we have our indicators that are sent to the agent and the agent uh sends back QA data q& a because the",
    "start": "751800",
    "end": "759120"
  },
  {
    "text": "threat indicators need quality assurance so these indicators are sent to the endpoints and they're tested of course",
    "start": "759120",
    "end": "765320"
  },
  {
    "text": "not every indicator is initially live when being sent to to to a test system uh to an endpoint system and also they",
    "start": "765320",
    "end": "772880"
  },
  {
    "text": "could turn out over time to be false positives or to be uh high risk indicators that need higher evaluation",
    "start": "772880",
    "end": "779600"
  },
  {
    "text": "or whatever so this QA data is very important for actually improving the threat indicators what happens though",
    "start": "779600",
    "end": "785639"
  },
  {
    "text": "with this data there is um information being collected from the machines such as signature hits time stamps about when",
    "start": "785639",
    "end": "792720"
  },
  {
    "text": "the signature hit a certain sample um the hit frequencies how often the sample was detected and of course the sample itself so what these endpoint agents do",
    "start": "792720",
    "end": "800440"
  },
  {
    "text": "is they uh test their signatures on the machines and send back the samples they",
    "start": "800440",
    "end": "806320"
  },
  {
    "text": "detected to have the security company check what the sample actually does and if it's a false positive or not or if",
    "start": "806320",
    "end": "812519"
  },
  {
    "text": "it's a evolving threat or whatever so we have this sent exchange of data what is",
    "start": "812519",
    "end": "817760"
  },
  {
    "text": "happening in the endpoint Wars backstage um of course this is all evolving around signature generation testing but what we",
    "start": "817760",
    "end": "824720"
  },
  {
    "text": "have there um what evolved in the recent years for for quality insurance are silent signatures so security companies",
    "start": "824720",
    "end": "831480"
  },
  {
    "text": "can send out silent signatures to test them on an endo and see if in a short",
    "start": "831480",
    "end": "836759"
  },
  {
    "text": "frequency uh in a short amount of time they uh hit on samples in high frequency",
    "start": "836759",
    "end": "842360"
  },
  {
    "text": "which would tell them it's either a very fast spreading threat or false",
    "start": "842360",
    "end": "847759"
  },
  {
    "text": "positive but these s signatures can also be used of course for grabbing binaries and effectively lead to a certain amount",
    "start": "847759",
    "end": "854959"
  },
  {
    "text": "of teture data threat indicators which help security companies analyze the needles that I've been talking",
    "start": "854959",
    "end": "861560"
  },
  {
    "text": "about in the end of course uh sure tetri data in the end but uh we have security",
    "start": "861560",
    "end": "868199"
  },
  {
    "text": "products that are mostly not free as you might know uh which are still uh of",
    "start": "868199",
    "end": "873720"
  },
  {
    "text": "course adding to the security of the person installing them but also adding to the actual telet data to the value of",
    "start": "873720",
    "end": "880079"
  },
  {
    "text": "the security vendor another very interesting peculiarity uh we have been watching the",
    "start": "880079",
    "end": "886120"
  },
  {
    "text": "past years are the Frenemies and the fungus and mongus as we call them um I",
    "start": "886120",
    "end": "891920"
  },
  {
    "text": "told you a lot of a lot of interesting data is exchanged from person to person a lot of interesting information is as",
    "start": "891920",
    "end": "897959"
  },
  {
    "text": "as gossip um so what happened in our industry is that we have a lot of",
    "start": "897959",
    "end": "903800"
  },
  {
    "text": "friendenemies so you might find yourself all of a sudden uh being good friends with a person which you had never",
    "start": "903800",
    "end": "909399"
  },
  {
    "text": "expected to talk to you um because you might have information that this person is interested in this is a very uh",
    "start": "909399",
    "end": "916360"
  },
  {
    "text": "social experience that some of us might have anyway uh you might also find yourself in a situation where people you",
    "start": "916360",
    "end": "923639"
  },
  {
    "text": "you trusted or you thought were your friends actually are more interested in the m we have then uh in your friendship",
    "start": "923639",
    "end": "932000"
  },
  {
    "text": "so we might not get into detail here but we have some very interesting experience with our friend me right so I mean the",
    "start": "932000",
    "end": "941000"
  },
  {
    "text": "the interesting thing with a lot of the the sort of the big nation state malware campaigns that have come out is that you know sort of someone will release a",
    "start": "941000",
    "end": "948000"
  },
  {
    "text": "report like oh we we discovered this um but it's frequently you know a lot of a",
    "start": "948000",
    "end": "956199"
  },
  {
    "text": "lot of this stuff is is known by multiple actors release um so when I",
    "start": "956199",
    "end": "961720"
  },
  {
    "text": "started looking at Region um a little while ago I discovered that it was kind of like the the worst kept secret in the",
    "start": "961720",
    "end": "967040"
  },
  {
    "text": "threat intelligence industry um and and that there was actually a variety of large companies that had known about",
    "start": "967040",
    "end": "972079"
  },
  {
    "text": "this for years uh Microsoft had definitions going for back for it for a really long time uh kasperski semantic",
    "start": "972079",
    "end": "977959"
  },
  {
    "text": "some other AV companies knew about it and so I was working on this um I worked on with a variety of very smart people",
    "start": "977959",
    "end": "984279"
  },
  {
    "text": "and I was working on releasing it with with claudo um when it it it got leaked",
    "start": "984279",
    "end": "990040"
  },
  {
    "text": "that that we were going to publish uh very shortly um at which point I think",
    "start": "990040",
    "end": "995079"
  },
  {
    "text": "semantic published a report on a Sunday night which is the first time they've ever done that uh kasperski followed up",
    "start": "995079",
    "end": "1000600"
  },
  {
    "text": "very shortly afterwards and we were sort of a couple of hours after kasperski now unless you think this is this is not",
    "start": "1000600",
    "end": "1006319"
  },
  {
    "text": "there's no bitterness here I'm just sort of relating this as an example of a story um but I mean this is this is",
    "start": "1006319",
    "end": "1012600"
  },
  {
    "text": "actually sort of one of the things when you're looking at samples you'll actually discover that a lot of people have them um and then there's this kind",
    "start": "1012600",
    "end": "1017880"
  },
  {
    "text": "of like jostling like you going to release those or maybe I'll release those you know sort of um yeah and so it actually all gets kind of",
    "start": "1017880",
    "end": "1025720"
  },
  {
    "start": "1025000",
    "end": "1524000"
  },
  {
    "text": "complicated anyway before we get to our big game hunting into the big game um um",
    "start": "1025880",
    "end": "1031160"
  },
  {
    "text": "recently there were some very very sad stories about big game actually being hunted down so let me tell you um while",
    "start": "1031160",
    "end": "1037678"
  },
  {
    "text": "while we handed on our big game we actually didn't didn't hurt real",
    "start": "1037679",
    "end": "1043038"
  },
  {
    "text": "game so I mean the thing is that our our industry actually forgets about CEs",
    "start": "1043039",
    "end": "1049679"
  },
  {
    "text": "um we're more interested in the gun that shot cisil how sophisticated the bullet",
    "start": "1049679",
    "end": "1055320"
  },
  {
    "text": "that killed cisil was and you know maybe maybe whether or not we can blame the bullet manufacturer for any wrongdoing",
    "start": "1055320",
    "end": "1062799"
  },
  {
    "text": "um so I mean these these kind of twin facets of you know attribution you know",
    "start": "1062799",
    "end": "1068360"
  },
  {
    "text": "like who did it who built it who wrode it uh who operated it and how sophisticated is it like you know on a",
    "start": "1068360",
    "end": "1074280"
  },
  {
    "text": "scale of one to stuck knit would you give this a nine um you know it it's",
    "start": "1074280",
    "end": "1079480"
  },
  {
    "text": "kind of interesting because I've I've had really bizarre interactions with people from AV companies at conferences",
    "start": "1079480",
    "end": "1085919"
  },
  {
    "text": "so I'm going to do a little test here like so so I used to work at Google and and Google has this thing where if they",
    "start": "1085919",
    "end": "1092480"
  },
  {
    "text": "think you've been targeted by nation state malware they'll put a banner on your Gmail account are people here familiar with that anyone like raise",
    "start": "1092480",
    "end": "1098400"
  },
  {
    "text": "your hands a few people how many people here have actually received this",
    "start": "1098400",
    "end": "1103880"
  },
  {
    "text": "Banner right no you can't do a handwavy thing it doesn't work like that but",
    "start": "1103880",
    "end": "1109600"
  },
  {
    "text": "but well so a couple of years ago I attended a an Arab bloggers conference",
    "start": "1109600",
    "end": "1114840"
  },
  {
    "text": "in the Middle East where a lot of people had done independent blogging about the political situation during the Arab",
    "start": "1114840",
    "end": "1120400"
  },
  {
    "text": "Spring and I was sort of talking to them about security and I asked the same question and it was actually about half of the audience um and so I was I was",
    "start": "1120400",
    "end": "1128520"
  },
  {
    "text": "talking to an antivirus researcher who actually said to me like hey where do",
    "start": "1128520",
    "end": "1133919"
  },
  {
    "text": "you get some of these samples that you know you've publishing this is all very interesting stuff and I was like oh you",
    "start": "1133919",
    "end": "1139360"
  },
  {
    "text": "know actually like people at a Target like send them to me and he was like what it's it's cheating I was like",
    "start": "1139360",
    "end": "1146840"
  },
  {
    "text": "cheating how is it cheating it's like oh no no you're not doing enough needle processing have you heard of the Hast",
    "start": "1146840",
    "end": "1152120"
  },
  {
    "text": "stack it's large a lot of samples in it um which which I think actually sort of reflects you know the sort of interests",
    "start": "1152120",
    "end": "1158480"
  },
  {
    "text": "of the industry which is really not people related at all um unfortunately",
    "start": "1158480",
    "end": "1163679"
  },
  {
    "text": "in in certain situations right like especially in countries where rule of law is not particularly robust uh",
    "start": "1163679",
    "end": "1169120"
  },
  {
    "text": "countries in conflict and that sort of thing you know Espionage is a tool that is used to enforce you know more kinetic",
    "start": "1169120",
    "end": "1177240"
  },
  {
    "text": "things um so rather quickly this guy's name is t Kim he's a Syrian activist um",
    "start": "1177240",
    "end": "1184480"
  },
  {
    "text": "he was seized by the Syrian police uh he was tortured and beaten he thought he was going to die and this line always",
    "start": "1184480",
    "end": "1191000"
  },
  {
    "text": "stuck with me uh this is a computer by the way that contains an image of the compromised hard drive uh which contains",
    "start": "1191000",
    "end": "1197000"
  },
  {
    "text": "a rat which recorded his Escape conversation and so forth um he said my computer was arrested before me uh This",
    "start": "1197000",
    "end": "1204480"
  },
  {
    "text": "Woman's name is elishah Hab uh she is probably unknown to most people in this audience but you're probably familiar",
    "start": "1204480",
    "end": "1211080"
  },
  {
    "text": "with this she's actually basically finfisher patient zero and that she was actually the person who was like wait",
    "start": "1211080",
    "end": "1216799"
  },
  {
    "text": "this email looks really suspicious and it ended up on my plate um and I did a body of work with the citizen lab which",
    "start": "1216799",
    "end": "1222159"
  },
  {
    "text": "led to the first public attribution of finfisher samples uh her husband gazi fan uh seized",
    "start": "1222159",
    "end": "1229200"
  },
  {
    "text": "uh by the bin Security Forces no one knew what had happened to him held for 48 days",
    "start": "1229200",
    "end": "1236240"
  },
  {
    "text": "for what was it spreading political misinformation mainly through comments",
    "start": "1236240",
    "end": "1241520"
  },
  {
    "text": "on Facebook uh this guy Ahmed manso as a United arabit pro-democracy activist um",
    "start": "1241520",
    "end": "1249080"
  },
  {
    "text": "he was giving talks about well democracy in the Middle East was an interesting topic and he was being physically beaten",
    "start": "1249080",
    "end": "1256600"
  },
  {
    "text": "um after some of the talks he was given he wasn't really sure how people knew where he was going to be um I did some",
    "start": "1256600",
    "end": "1262200"
  },
  {
    "text": "analysis on his hard drive and I found out that he had a hacking team implant",
    "start": "1262200",
    "end": "1267559"
  },
  {
    "text": "on it um has have people here heard of hacking team yeah I know right um good he from",
    "start": "1267559",
    "end": "1275159"
  },
  {
    "text": "hacking team wants to himself um no you know I I'm sorry I suffer from hacking",
    "start": "1275159",
    "end": "1280440"
  },
  {
    "text": "Freer as a medical condition um but but yeah so the hacking team",
    "start": "1280440",
    "end": "1285640"
  },
  {
    "text": "sample actually talked to this IP address which is actually in a very small range which pointed briefly to the",
    "start": "1285640",
    "end": "1293240"
  },
  {
    "text": "office of the shik um and people say attribution is tricky come on",
    "start": "1293240",
    "end": "1298440"
  },
  {
    "text": "uh so this brings us to the case of Alberto nisman which some of you may be familiar with so he was an Argentine",
    "start": "1298440",
    "end": "1304799"
  },
  {
    "text": "lawyer um and he was investigating the bombing of a Jewish Community Center killed 94 people and there was sort of",
    "start": "1304799",
    "end": "1312559"
  },
  {
    "text": "accusations of political scaly that the Argentine government had covered up Iran's involvement in exchange for oil I",
    "start": "1312559",
    "end": "1320400"
  },
  {
    "text": "mean and he was going to bring charges against the the president of Argentina",
    "start": "1320400",
    "end": "1326320"
  },
  {
    "text": "as well of several high ranking cabinet ministers uh unfortunately he was found dead of gunshot wound to the head under",
    "start": "1326320",
    "end": "1333159"
  },
  {
    "text": "very suspicious circumstances um there were no Powder burns on his hand it was ruled of suicide but a lot of people",
    "start": "1333159",
    "end": "1339720"
  },
  {
    "text": "thought that you know he maybe he was murdered because of the charges and this sort of lead to protests around Argentina it's a really big deal and",
    "start": "1339720",
    "end": "1346799"
  },
  {
    "text": "kind of you know it's you know sort of conspiracy of JFK proportions in Argentina um now where this pertains to",
    "start": "1346799",
    "end": "1353880"
  },
  {
    "text": "this talk is that police were doing investigation because apparently he had",
    "start": "1353880",
    "end": "1359600"
  },
  {
    "text": "a conversation with the head of the Argentine security intelligence Services the day he died uh so they were trying to confirm this so they started doing",
    "start": "1359600",
    "end": "1365720"
  },
  {
    "text": "forensics on his devices uh now this was reported in a very small Argentinian paper uh this paper then said that the",
    "start": "1365720",
    "end": "1375360"
  },
  {
    "text": "police had uploaded a bunch of files from his computers to an online antivirus",
    "start": "1375360",
    "end": "1383320"
  },
  {
    "text": "scanner Telemetry Telemetry um he and",
    "start": "1383320",
    "end": "1389600"
  },
  {
    "text": "they publish the name of the file uh which is enough so I had a look for this",
    "start": "1389600",
    "end": "1394799"
  },
  {
    "text": "this file matches one sample and one sample only uploaded from baneras um it is",
    "start": "1394799",
    "end": "1404320"
  },
  {
    "text": "a multiplatform implant rat access Tool",
    "start": "1405000",
    "end": "1410159"
  },
  {
    "text": "uh this is a screenshot of the the control screen um so it started its life as as frutus uh which was sort of a",
    "start": "1410159",
    "end": "1417320"
  },
  {
    "text": "proof of concept Android malware and then it got Rewritten as adwind which became like a four sale uh remote access",
    "start": "1417320",
    "end": "1424919"
  },
  {
    "text": "Tool uh then it was rebadged again as un recom and continued to be sold and it's currently doing the rounds as alien spy",
    "start": "1424919",
    "end": "1431400"
  },
  {
    "text": "I think like uh crowd strike wrote about it being used in targeted attacks this sample on contagio um so as you can see",
    "start": "1431400",
    "end": "1438159"
  },
  {
    "text": "it capture your screen listen to your phone calls uh take photos or all the sort of stuff that You' expect from one",
    "start": "1438159",
    "end": "1443960"
  },
  {
    "text": "of these types of implants um now you know we look looking at this malware you",
    "start": "1443960",
    "end": "1451039"
  },
  {
    "text": "know it we're able to discover command and control domains and then link other malware samples to command and control",
    "start": "1451039",
    "end": "1456760"
  },
  {
    "text": "domains I look at Network indicators where these command and control domains were situated uh and so on and so forth",
    "start": "1456760",
    "end": "1463080"
  },
  {
    "text": "um other targeting by the same actors so so this group the people who compromise",
    "start": "1463080",
    "end": "1468640"
  },
  {
    "text": "him uh were targeting other people uh this was the targeting lure on one of them um it's it's like a fake document",
    "start": "1468640",
    "end": "1476480"
  },
  {
    "text": "from the embassy of Ecuador well maybe the document is real but it was definitely bearing malware treats",
    "start": "1476480",
    "end": "1482720"
  },
  {
    "text": "um and and so this this relates to the sale of Sab aeronautic equipment I think",
    "start": "1482720",
    "end": "1490039"
  },
  {
    "text": "between you Brazil and Argentina um if we look at the compilation time on uh",
    "start": "1490039",
    "end": "1497559"
  },
  {
    "text": "the m malware it looks like they started spying on him 6 weeks before he died his",
    "start": "1497559",
    "end": "1502799"
  },
  {
    "text": "death was his January 18th this year and the malware was built on the 1st of",
    "start": "1502799",
    "end": "1507960"
  },
  {
    "text": "December 2014 um network-based indicators point to actors in Argentina and",
    "start": "1507960",
    "end": "1515000"
  },
  {
    "text": "Uruguay uh we also see the used of Hosting services in the US Germany and Sweden so you know could have been",
    "start": "1515000",
    "end": "1523279"
  },
  {
    "text": "anyone right so now you have seen it attribution can be tricky attribution can be absolutely not tricky attribution can anything um there's a general public",
    "start": "1523279",
    "end": "1530520"
  },
  {
    "text": "perspection perception that attribution is frequently done based on binaries which is not true attributions almost",
    "start": "1530520",
    "end": "1536960"
  },
  {
    "text": "never done based on a binary but based on the context of the binary however there's interesting cases such as like B",
    "start": "1536960",
    "end": "1543120"
  },
  {
    "text": "bar which uh is allegedly French government mware that I mentioned before",
    "start": "1543120",
    "end": "1549640"
  },
  {
    "text": "uh when talking about the leaked document um this document uh I mentioned",
    "start": "1549640",
    "end": "1555640"
  },
  {
    "text": "describes an Espionage tool as sophisticated the spish tool named Babar which was supposedly operated by the",
    "start": "1555640",
    "end": "1562679"
  },
  {
    "text": "French government to spy on individuals in Canada uh people publishing this",
    "start": "1562679",
    "end": "1568840"
  },
  {
    "text": "document or people writing this document were the Canadian intelligence service um so Babar was one of these cases where",
    "start": "1568840",
    "end": "1576520"
  },
  {
    "text": "Frenemies kicked in and uh what actually happened was that the document was leaked before most of",
    "start": "1576520",
    "end": "1584279"
  },
  {
    "text": "the uh researchers in the security Community got their hands on the sample so as soon as the document were published in February uh people are like",
    "start": "1584279",
    "end": "1591399"
  },
  {
    "text": "oh my God have you seen Babar samples maybe I would like to have such a such a dropper to analyze and publish on it",
    "start": "1591399",
    "end": "1598279"
  },
  {
    "text": "however we managed to get our hands on these samples before most others uh funny enough and Babar and figur out",
    "start": "1598279",
    "end": "1606320"
  },
  {
    "text": "that Babar actually didn't come alone Babar is an spean asran out for Al s",
    "start": "1606320",
    "end": "1612200"
  },
  {
    "text": "different contents on on a machine but Babar was not the only tool they had used Babar was uh only the only chion",
    "start": "1612200",
    "end": "1619120"
  },
  {
    "text": "that was documented in this uh paper happen subar had a relative named Bunny",
    "start": "1619120",
    "end": "1625880"
  },
  {
    "text": "Bunny was another uh troan actually a scripting bot bunny Incorporated a Lu script interpreter which done Luis",
    "start": "1625880",
    "end": "1632720"
  },
  {
    "text": "scripts and Chang Its Behavior to a certain extent at run time but bunny was",
    "start": "1632720",
    "end": "1638080"
  },
  {
    "text": "not even the only relative that were more that was Casper and that was Dino and that was anbot so we had all these",
    "start": "1638080",
    "end": "1644679"
  },
  {
    "text": "different families and for me like as as a binary analyst I look at the binaries and I say okay I I see these are related",
    "start": "1644679",
    "end": "1650600"
  },
  {
    "text": "they share code they share mechanisms they share tactics they share I don't know what um this is just very difficult",
    "start": "1650600",
    "end": "1657120"
  },
  {
    "text": "to explain to another person who is not into binaries and it's very difficult to prove so we thought there has to be a",
    "start": "1657120",
    "end": "1663039"
  },
  {
    "text": "better way to actually link binaries credibly with each other to link the binaries together to eventually get this",
    "start": "1663039",
    "end": "1668640"
  },
  {
    "text": "kind of attribution chain where you can link families with each other and Link at least one of these families to a",
    "start": "1668640",
    "end": "1673720"
  },
  {
    "text": "certain actor so the idea we came up with is binary",
    "start": "1673720",
    "end": "1680880"
  },
  {
    "start": "1679000",
    "end": "1736000"
  },
  {
    "text": "stylometry right because what you usually see is well let me call it",
    "start": "1681440",
    "end": "1686679"
  },
  {
    "text": "flimsy attribution where you see that analysts base their conclusions",
    "start": "1686679",
    "end": "1691760"
  },
  {
    "text": "or base their public conclusions on facts that are hard to understand and",
    "start": "1691760",
    "end": "1697120"
  },
  {
    "text": "hard to prove or hard to counter proove uh from outside so what we try to do is",
    "start": "1697120",
    "end": "1703840"
  },
  {
    "text": "give analyst the tool to actually uh make a strong statement about their",
    "start": "1703840",
    "end": "1710000"
  },
  {
    "text": "assumptions um you might have realized attribution and and binary anything about binaries is is a misery business",
    "start": "1710000",
    "end": "1717080"
  },
  {
    "text": "you generally always want to know uh who wrote the malare who controlled the malare who were the victims and what was",
    "start": "1717080",
    "end": "1722320"
  },
  {
    "text": "the aim of the operation be other people are interested in what the binary actually does but these kind of",
    "start": "1722320",
    "end": "1728320"
  },
  {
    "text": "questions are very hard to to answer from from standpoint of of a binary analyst so you have the binary you",
    "start": "1728320",
    "end": "1733760"
  },
  {
    "text": "always never can answer these kind of questions so we what we actually want is we want to link a binary into a context",
    "start": "1733760",
    "end": "1740039"
  },
  {
    "start": "1736000",
    "end": "1769000"
  },
  {
    "text": "we want to know okay I have this binary and um it was talking these kind of people these were the operators this is what what you wanted we want the context",
    "start": "1740039",
    "end": "1747039"
  },
  {
    "text": "we can't get the context from the binary what we can get is a link from a binary",
    "start": "1747039",
    "end": "1753080"
  },
  {
    "text": "to another binary so if we had the chance that we have a binary which is in the context like it was with Babar we",
    "start": "1753080",
    "end": "1759200"
  },
  {
    "text": "can manage to have the other binaries just linked to Babar and this way link them to the alleged operators and French",
    "start": "1759200",
    "end": "1766360"
  },
  {
    "text": "government in this case we have win situation um how do we do that let's take a step back um the term",
    "start": "1766360",
    "end": "1773799"
  },
  {
    "start": "1769000",
    "end": "1927000"
  },
  {
    "text": "of of stomry actually comes from text interpretation so text stomry helps uh",
    "start": "1773799",
    "end": "1779880"
  },
  {
    "text": "authorship attribution on pieces of text or in pieces of codes uh uh source code",
    "start": "1779880",
    "end": "1785240"
  },
  {
    "text": "so what academics say about this is um source code can be attributed to its",
    "start": "1785240",
    "end": "1790279"
  },
  {
    "text": "author based on a considerably large set of samples we can say this this code was",
    "start": "1790279",
    "end": "1795960"
  },
  {
    "text": "written by a certain person um there's even been research trying to link binaries like compiled binaries to",
    "start": "1795960",
    "end": "1802200"
  },
  {
    "text": "their authors now there's there's a big set of problems with this in in malare attribution um basically what what",
    "start": "1802200",
    "end": "1809279"
  },
  {
    "text": "you're interested in when when analyzing malare you're not you're not after that guy the person who who wrote the malware",
    "start": "1809279",
    "end": "1817440"
  },
  {
    "text": "but you want the operator or the owner of of the malware so this is the first",
    "start": "1817440",
    "end": "1822480"
  },
  {
    "text": "problem second problem is that with the classical stomry traits with the attributes they use for stomry",
    "start": "1822480",
    "end": "1828480"
  },
  {
    "text": "you you're not going to find in compiled binaries so usually a compiler or afterwards a disassem or DEC compiler",
    "start": "1828480",
    "end": "1834360"
  },
  {
    "text": "wash away everything that that the person left in a binary so what you see there are different kinds of attributes",
    "start": "1834360",
    "end": "1840519"
  },
  {
    "text": "which require different kinds of methods um let's way we we try to uh do",
    "start": "1840519",
    "end": "1846600"
  },
  {
    "text": "datafication on our our e results so we as reverse Engineers we see there's like",
    "start": "1846600",
    "end": "1851760"
  },
  {
    "text": "hand writing we can see this binary was written by the by the same authors as the other one because it uses the same",
    "start": "1851760",
    "end": "1857679"
  },
  {
    "text": "Tech ICS and the same style but how do we how do we put it into Data so what we",
    "start": "1857679",
    "end": "1862720"
  },
  {
    "text": "try to do uh is spread our domains usually the attribute set for text",
    "start": "1862720",
    "end": "1868760"
  },
  {
    "text": "symetry involves um blank spaces it involves variable names it involves uh",
    "start": "1868760",
    "end": "1875120"
  },
  {
    "text": "placement of comments Etc all of this you don't have in binary so what you try to do with the binaries where create",
    "start": "1875120",
    "end": "1880720"
  },
  {
    "text": "different domains where you collect attributes and try to get big sets of",
    "start": "1880720",
    "end": "1886279"
  },
  {
    "text": "attributes the problem We additionally have with mware is that attributes are frequently faked or randomized so M",
    "start": "1886279",
    "end": "1893200"
  },
  {
    "text": "tries to hide its origin of course um but the assumption is that um it is",
    "start": "1893200",
    "end": "1899279"
  },
  {
    "text": "never possible to eradicate or falsify all the attributes that one can collect from a binary so if we can manage to",
    "start": "1899279",
    "end": "1905919"
  },
  {
    "text": "grab a considerably big set of of attributes we can conclude that not all of these attributes are fake at the same",
    "start": "1905919",
    "end": "1912960"
  },
  {
    "text": "time our goal is to even out human influence as I mentioned we don't want the code of the binary and we don't want",
    "start": "1912960",
    "end": "1919679"
  },
  {
    "text": "to classify the compiler we want to classify the actor or the uh user of the",
    "start": "1919679",
    "end": "1927120"
  },
  {
    "text": "mware all right here I collected uh all the different attributes that I described now have a very quick look and",
    "start": "1928320",
    "end": "1935000"
  },
  {
    "text": "learn them all the best uh not forget them no I'm kidding um these are the the",
    "start": "1935000",
    "end": "1940240"
  },
  {
    "text": "four categories that I mentioned so we try to spread the attributes to as many",
    "start": "1940240",
    "end": "1945720"
  },
  {
    "text": "categories as we can grab to be sure to not search for a human uh author so we",
    "start": "1945720",
    "end": "1952799"
  },
  {
    "text": "the string constants the implementation tra the custom features and the infrastructure to raise uh the level uh",
    "start": "1952799",
    "end": "1959720"
  },
  {
    "text": "on which we're searching for related binaries to not find the compiler or the",
    "start": "1959720",
    "end": "1964799"
  },
  {
    "text": "human but the actor here we did the proof of concept on the animal F uh malware you can see",
    "start": "1964799",
    "end": "1972039"
  },
  {
    "start": "1967000",
    "end": "2061000"
  },
  {
    "text": "me collecting a lot of different attributes and putting them all together in spreadsheets I particularly like",
    "start": "1972039",
    "end": "1977440"
  },
  {
    "text": "spreadsheets cheat I'm kidding again um sure you can see the yellow lines uh",
    "start": "1977440",
    "end": "1984039"
  },
  {
    "text": "indicate an overlap as I interpreted it in the different binaries and you can see that uh the different families here",
    "start": "1984039",
    "end": "1989840"
  },
  {
    "text": "shown and B bu and Babar are certainly related because there's a lot of yellow beautiful um what does it tell us Animal",
    "start": "1989840",
    "end": "1997919"
  },
  {
    "text": "Farm uh gave away a beautiful case study because the binaries really come with a lot of uh shared trades um in the end",
    "start": "1997919",
    "end": "2004840"
  },
  {
    "text": "this helped us link them all to Babar and conclusively to the alleged operator",
    "start": "2004840",
    "end": "2010240"
  },
  {
    "text": "the French government so we have a bar um which was linked to the bunny mare which was linked to nbot which was",
    "start": "2010240",
    "end": "2016679"
  },
  {
    "text": "linked to Casper which was linked to dino which was linked to nbot again so it's beautiful picture and now we can",
    "start": "2016679",
    "end": "2021919"
  },
  {
    "text": "actually draw conclusions so we have the bar which was spying we have bunny which",
    "start": "2021919",
    "end": "2027840"
  },
  {
    "text": "was spread through a spare fishing campaign and then Adobe C we know Casper was spying in Syria he was being spread",
    "start": "2027840",
    "end": "2034320"
  },
  {
    "text": "as a reconnaissance Mel in Syria in 2014 and we know that samples popped up in Iran so what we can finally conclude is",
    "start": "2034320",
    "end": "2041440"
  },
  {
    "text": "that this small families give away the interest of the actual actor of the operator of animal F War and what it",
    "start": "2041440",
    "end": "2048000"
  },
  {
    "text": "also tells us is that the alleged operator the French government had a denal service botnet that was running in",
    "start": "2048000",
    "end": "2054800"
  },
  {
    "text": "2009 which is why the hell would the French government need a denal service but net we'll probably never",
    "start": "2054800",
    "end": "2062280"
  },
  {
    "start": "2061000",
    "end": "2084000"
  },
  {
    "text": "know [Music] so it's it's important you know and part",
    "start": "2062280",
    "end": "2068280"
  },
  {
    "text": "of part of what this this approach is designed to do is sort of you know firm up a bit of Science and attribution",
    "start": "2068280",
    "end": "2073638"
  },
  {
    "text": "because a lot of a lot of what we have in in the industry is currently what I'd call soft attribution you know like a",
    "start": "2073639",
    "end": "2079200"
  },
  {
    "text": "temp file with a tilted D or or something like that um and so for instance you know the the the region is",
    "start": "2079200",
    "end": "2085919"
  },
  {
    "start": "2084000",
    "end": "2104000"
  },
  {
    "text": "actually the analysis we did on that is a really great example um and so so this malware was linked to uh you know an",
    "start": "2085919",
    "end": "2092320"
  },
  {
    "text": "attack on the European Union uh conducted by us and British intelligence now I mean Ren actually again one of",
    "start": "2092320",
    "end": "2100480"
  },
  {
    "text": "these not well-kept secrets in the sort of antivirus industry uh it actually showed up on a a private malware mailing",
    "start": "2100480",
    "end": "2107720"
  },
  {
    "start": "2104000",
    "end": "2130000"
  },
  {
    "text": "list like maybe like nine months before publication and that the thread was on difficult to reverse Chinese malware and",
    "start": "2107720",
    "end": "2114520"
  },
  {
    "text": "you know people were posting samples and like oh my God this uses this cool obis technique and this does this and this does that and someone posted these",
    "start": "2114520",
    "end": "2121119"
  },
  {
    "text": "samples and you know I was sort of reading the mail list and then like check out the super interesting Chinese",
    "start": "2121119",
    "end": "2126760"
  },
  {
    "text": "AP mail that I like okay whatever and then sort of you know 2 hours later like",
    "start": "2126760",
    "end": "2132079"
  },
  {
    "start": "2130000",
    "end": "2168000"
  },
  {
    "text": "yeah I'm not not sure that's China I was like hm okay that looks interesting um",
    "start": "2132079",
    "end": "2138480"
  },
  {
    "text": "and so using a technique much the same as Marian describes you know with with with uh the sort of Animal Farm barar",
    "start": "2138480",
    "end": "2144560"
  },
  {
    "text": "and Bunny and Dino so of malware um together with a lot of very clever people I spent you know many many many",
    "start": "2144560",
    "end": "2151480"
  },
  {
    "text": "months sort of putting together a picture of this sort of Highly sophisticated and full featured implant",
    "start": "2151480",
    "end": "2157040"
  },
  {
    "text": "kit um that had many different moving components of course you know you find you know this looks like it's related",
    "start": "2157040",
    "end": "2162800"
  },
  {
    "text": "and you're trying to figure out what it does and again you sort of get to speak to the motivators of the actors and so",
    "start": "2162800",
    "end": "2168240"
  },
  {
    "start": "2168000",
    "end": "2217000"
  },
  {
    "text": "you know finally we we found a sample uh which looked like this um and so it was",
    "start": "2168240",
    "end": "2174240"
  },
  {
    "text": "it was in a zip file now now as you can see it actually contained a region sample uh but it also contained a bunch",
    "start": "2174240",
    "end": "2180480"
  },
  {
    "text": "of other data which gives us binary context um and so what we have is we",
    "start": "2180480",
    "end": "2186240"
  },
  {
    "text": "have the log of a forensics tool run on the system we have procmon logs which",
    "start": "2186240",
    "end": "2192079"
  },
  {
    "text": "sort of you know that it's process monitor it's a tool for inspecting what's going on in a Windows system and so on and so forth now we have the",
    "start": "2192079",
    "end": "2198920"
  },
  {
    "text": "origin sample right if we look at the other files we can find out where the binary",
    "start": "2198920",
    "end": "2205160"
  },
  {
    "text": "was found and so this was found on in a domain called BGC on company called",
    "start": "2205160",
    "end": "2210920"
  },
  {
    "text": "belgom uh not sure if you've heard of them uh so we have the username and ID and for those of you who have a long",
    "start": "2210920",
    "end": "2216599"
  },
  {
    "text": "memory Britain's GQ hacked Belgian telecoms firm I was like yes attribution",
    "start": "2216599",
    "end": "2223119"
  },
  {
    "start": "2217000",
    "end": "2257000"
  },
  {
    "text": "although this is actually what I would call a soft attribute right because it's like well I mean really what you have is",
    "start": "2223119",
    "end": "2228880"
  },
  {
    "text": "you have belom was hacked by the gchq you have some malware that was used on",
    "start": "2228880",
    "end": "2234359"
  },
  {
    "text": "the belgacom network but maybe maybe it was the French you know I mean belgom",
    "start": "2234359",
    "end": "2240040"
  },
  {
    "text": "could have been hacked by multiple actors like I mean if you if you look at the malware and that sort of thing there's sort of a strong suggestion but",
    "start": "2240040",
    "end": "2245200"
  },
  {
    "text": "this is what we call sort of a soft attribute right whereas the the hard attribution came",
    "start": "2245200",
    "end": "2250319"
  },
  {
    "text": "later um when people shaking the Snowden documents uh found some code which fell",
    "start": "2250319",
    "end": "2256839"
  },
  {
    "text": "out which was called querty uh now now querty uh kasperski said in a blog post",
    "start": "2256839",
    "end": "2262800"
  },
  {
    "start": "2257000",
    "end": "2298000"
  },
  {
    "text": "looking at the code closely we conclude that the conerty malware is identical in functionality to the region uh 50251",
    "start": "2262800",
    "end": "2270040"
  },
  {
    "text": "plug-in uh a friend of mine said it better I think when he said even blind Freddy could see that equ is a origin",
    "start": "2270040",
    "end": "2276359"
  },
  {
    "text": "plugin uh um so yeah this is what we call a hard attribute and that we actually have leaked documents from the",
    "start": "2276359",
    "end": "2282800"
  },
  {
    "text": "code authors you know and this this links to code that was links to code that was found elsewhere of R and which",
    "start": "2282800",
    "end": "2288680"
  },
  {
    "text": "sort of links back back back and then you know it's it's exactly what Marian had a great pretty diagram of describing",
    "start": "2288680",
    "end": "2295720"
  },
  {
    "text": "what happened um with Bara um now of course one of the the real peculiarities",
    "start": "2295720",
    "end": "2303040"
  },
  {
    "start": "2298000",
    "end": "2349000"
  },
  {
    "text": "of doing this type of research was that you know you release resear search you releasee papers and of course people who",
    "start": "2303040",
    "end": "2310000"
  },
  {
    "text": "are paid to do professional Espionage there's not a like oh damn you got me that's a nice work kid keep that up um",
    "start": "2310000",
    "end": "2317599"
  },
  {
    "text": "you know I mean you guys are probably familiar with this guy Clapper uh because he he he was put in a really unfortunate situation where he was asked",
    "start": "2317599",
    "end": "2323520"
  },
  {
    "text": "if the NSA was spying upon millions or tens of millions of Americans and he sort of didn't want to admit it on National Television so he sort of did",
    "start": "2323520",
    "end": "2329200"
  },
  {
    "text": "the head rub and said oh not wittingly um which he he later on when it came out that he lied sort of said he tried to",
    "start": "2329200",
    "end": "2335440"
  },
  {
    "text": "answer in the least untruthful manner possible posible um now there's actually been like sort",
    "start": "2335440",
    "end": "2341480"
  },
  {
    "text": "of a bunch of people that have been implicated in the production of of nation state malware uh that have told sort of wild Lies when sort of",
    "start": "2341480",
    "end": "2348240"
  },
  {
    "text": "confronted uh I mean finfisher you know sold Bahrain Egypt lied about it they",
    "start": "2348240",
    "end": "2354800"
  },
  {
    "start": "2349000",
    "end": "2371000"
  },
  {
    "text": "got hacked their docks came out found that they did um hacking team recently ran into some trouble as we know um so I",
    "start": "2354800",
    "end": "2361480"
  },
  {
    "text": "mean they've said stuff like this you know in the past there's absolutely no evidence that links us to these samples",
    "start": "2361480",
    "end": "2366880"
  },
  {
    "text": "um and of course you know well I could be talking about any one of a number of cases um I mean",
    "start": "2366880",
    "end": "2373319"
  },
  {
    "text": "the lies sort of continued even after they got hacked here's a screenshot of the assist edman who was like the attackers are spitting a lot of lies about our company it's simply not true",
    "start": "2373319",
    "end": "2379880"
  },
  {
    "text": "don't download the torrent it contains a virus and of course the exse security lead of Twitter John Adams was like no",
    "start": "2379880",
    "end": "2386880"
  },
  {
    "text": "the tent contains all of your viruses which you sell um which I found this",
    "start": "2386880",
    "end": "2392839"
  },
  {
    "text": "sort of an interesting exchange uh simply because Twitter since when do people who sell capability to nation",
    "start": "2392839",
    "end": "2399400"
  },
  {
    "text": "states take to Twitter to argue with security researchers about whether or not they say the stuff they say is true so this game has gotten really bizarrely",
    "start": "2399400",
    "end": "2406160"
  },
  {
    "text": "personal um like I've I've sort of been harassed and lambasted on Twitter by",
    "start": "2406160",
    "end": "2411240"
  },
  {
    "text": "various people working for companies selling surveillance equipment and surveillance gear um and in fact you",
    "start": "2411240",
    "end": "2418560"
  },
  {
    "start": "2417000",
    "end": "2437000"
  },
  {
    "text": "know hacking team released this statement publicly about me where they said that I was a tieless wolf Cryer on",
    "start": "2418560",
    "end": "2423720"
  },
  {
    "text": "the issue of privacy as I Define it and and then of course link this to the fact that I clearly love aiding criminals or",
    "start": "2423720",
    "end": "2429400"
  },
  {
    "text": "terrorists um I mean again I'm sure it's just business um I mean they only",
    "start": "2429400",
    "end": "2434760"
  },
  {
    "text": "mention me 117 times in their leaked email archive um and then of course there's the photos of me and audio",
    "start": "2434760",
    "end": "2440200"
  },
  {
    "start": "2437000",
    "end": "2442000"
  },
  {
    "text": "recordings and that sort of thing but again I'm sure it's just business um I",
    "start": "2440200",
    "end": "2445359"
  },
  {
    "text": "actually think they should have thanked me uh because if in the leaked emails you actually this email so they they're",
    "start": "2445359",
    "end": "2453040"
  },
  {
    "text": "meeting with a customer called Phoebe so they use these cool code names we can't figure out who they are",
    "start": "2453040",
    "end": "2458160"
  },
  {
    "text": "um but I mean as you can see later on down in the article they've got a link to FBI quietly formed secret of nit",
    "start": "2458160",
    "end": "2463440"
  },
  {
    "text": "surveillance unit um and they say if anything good came out",
    "start": "2463440",
    "end": "2470079"
  },
  {
    "text": "of the citizen lab articles is that it brought them to contact us to see if it was true it was way more than they expected thank you citizen lab like wait",
    "start": "2470079",
    "end": "2477640"
  },
  {
    "text": "what did the FBI read one of my reports and then decide to purchase the software",
    "start": "2477640",
    "end": "2484119"
  },
  {
    "start": "2483000",
    "end": "2522000"
  },
  {
    "text": "like ah this game just gets weirder and weirder like that uh not an intended result um so I mean today we've talked",
    "start": "2484119",
    "end": "2491880"
  },
  {
    "text": "sort of about a bunch of peculiarities with um discussed a bunch of the",
    "start": "2491880",
    "end": "2497079"
  },
  {
    "text": "imination state families hard and soft attribution a novel approach to Binary",
    "start": "2497079",
    "end": "2503040"
  },
  {
    "text": "context and I think now it's time for us to do",
    "start": "2503040",
    "end": "2508960"
  },
  {
    "text": "kind of like a Choose Your Own Adventure malware story because because everyone here is is now experts cuz that's why",
    "start": "2508960",
    "end": "2514599"
  },
  {
    "text": "you pay to come to black hat um so let's let's do this together we're going to",
    "start": "2514599",
    "end": "2519640"
  },
  {
    "text": "introduce a malware family we call CH cat yes sh cat I mean we all like cats a",
    "start": "2519640",
    "end": "2527240"
  },
  {
    "text": "lot right especially cats on YouTube um so the the name of the M Family actually",
    "start": "2527240",
    "end": "2533200"
  },
  {
    "text": "to be honest we came up with yesterday only because we didn't have a name for it before we had multiple names for it",
    "start": "2533200",
    "end": "2538520"
  },
  {
    "text": "before we we went through the the AP numbering we had ap69 AP 666 we called",
    "start": "2538520",
    "end": "2544240"
  },
  {
    "text": "it Firefly and based on on the classical approach to give Melville just arbitrary n we decided to stick to the Cross",
    "start": "2544240",
    "end": "2550079"
  },
  {
    "text": "strike naming convention and call it a cat so what is sh cat shra cat is uh",
    "start": "2550079",
    "end": "2556520"
  },
  {
    "text": "effectively five samples that we dug up uh with compilation time stamps ranging from 2002 to 2011 which is a kind of old",
    "start": "2556520",
    "end": "2565280"
  },
  {
    "text": "malare family that has been around for a long time yeah so I mean first thing it stands out is actually the longevity of",
    "start": "2565280",
    "end": "2571880"
  },
  {
    "start": "2569000",
    "end": "2588000"
  },
  {
    "text": "the malware so this is either one person or a group of people writing malware together over nine years which is quite",
    "start": "2571880",
    "end": "2578880"
  },
  {
    "text": "a long time I mean if we think of other malware families that lasted that long we're thinking stocks net equation uh region you know some of the the more",
    "start": "2578880",
    "end": "2585720"
  },
  {
    "text": "well funded operations the oldest sample of sharat",
    "start": "2585720",
    "end": "2591920"
  },
  {
    "start": "2588000",
    "end": "2613000"
  },
  {
    "text": "uh as mention comp in 202 is a pretty small and pretty plain binary um it",
    "start": "2591920",
    "end": "2597280"
  },
  {
    "text": "comes with some some string ofation with exor Andes for security products on the system as a defense mechanism um",
    "start": "2597280",
    "end": "2604480"
  },
  {
    "text": "including a executable named dummy I see so um I'm not sure which security",
    "start": "2604480",
    "end": "2609920"
  },
  {
    "text": "product that is if you could point me to a direction be very thankful um this sample is a control component talking to",
    "start": "2609920",
    "end": "2617800"
  },
  {
    "start": "2613000",
    "end": "2628000"
  },
  {
    "text": "a device driver uh and sending out two different uh ioc TS uh we still didn't",
    "start": "2617800",
    "end": "2622920"
  },
  {
    "text": "get our hands on the driver if you could help us out there we'd be very happy as well anyway the sample itself was an",
    "start": "2622920",
    "end": "2630240"
  },
  {
    "start": "2628000",
    "end": "2647000"
  },
  {
    "text": "orchestrator component which dropped another executable named DXE which would",
    "start": "2630240",
    "end": "2635440"
  },
  {
    "text": "be used to launch and monor other processes this is used as a harness so the the launched process doesn't pop up",
    "start": "2635440",
    "end": "2641920"
  },
  {
    "text": "on the security product and can actually still be controlled by the launching uh component but what is actually peculiar",
    "start": "2641920",
    "end": "2648280"
  },
  {
    "start": "2647000",
    "end": "2696000"
  },
  {
    "text": "about the sample is um oops I mentioned that that the",
    "start": "2648280",
    "end": "2654480"
  },
  {
    "text": "sample is actually prepared to run on old windows versions with old windows versions I mean around Windows 95 to",
    "start": "2654480",
    "end": "2661280"
  },
  {
    "text": "Windows me um we know this based on the apis that were used that were deprecated afterwards but also because there's a",
    "start": "2661280",
    "end": "2667599"
  },
  {
    "text": "checking function in there for uh checking the P header of the drop executable searching for an NE value now",
    "start": "2667599",
    "end": "2674000"
  },
  {
    "text": "if you look for NE value that means new executable which is the binary format uh Windows used before the PE uh header",
    "start": "2674000",
    "end": "2681400"
  },
  {
    "text": "format uh the new executable uh was used was introduced with Microsoft DOS 4.0",
    "start": "2681400",
    "end": "2689000"
  },
  {
    "text": "and used on Windows 16 bit platforms so at this time we got really interested in",
    "start": "2689000",
    "end": "2694720"
  },
  {
    "text": "the kind of malare right so so this takes us to a next group of samples uh written possibly more in the modern era",
    "start": "2694720",
    "end": "2701800"
  },
  {
    "start": "2696000",
    "end": "2729000"
  },
  {
    "text": "uh between 2007 and 2009 um however the",
    "start": "2701800",
    "end": "2707680"
  },
  {
    "text": "you know implementation Straits user strings and so forth indicate that the malware is targeting windows in Te as a platform I mean Windows NT seems like a",
    "start": "2707680",
    "end": "2714880"
  },
  {
    "text": "reasonably old platform to be targeting in like 2009 however as you might remember governments Chang technology",
    "start": "2714880",
    "end": "2721400"
  },
  {
    "text": "platforms very very slowly uh US Government complaining a lot when Microsoft deprecated both in4 and Windows XP",
    "start": "2721400",
    "end": "2728960"
  },
  {
    "text": "yes we were prepared to do archaeology there um but what's more interesting about the sample is it's a persistence",
    "start": "2729640",
    "end": "2736800"
  },
  {
    "text": "method it doesn't do the the center tricks but uses a shell extension or installs itself a shell extension for",
    "start": "2736800",
    "end": "2743359"
  },
  {
    "text": "the icon Handler in the windows shell which on Modern operating systems will be Windows Explorer so every time the",
    "start": "2743359",
    "end": "2749000"
  },
  {
    "text": "Explorer loads an icon for a specific file toop the shell extension this",
    "start": "2749000",
    "end": "2754319"
  },
  {
    "text": "malware is executed um what is interesting though that the mare checks on Startup uh if it's",
    "start": "2754319",
    "end": "2761599"
  },
  {
    "text": "running in the context of the propman window so if the window of of the process is running in uh is in prman now",
    "start": "2761599",
    "end": "2768680"
  },
  {
    "text": "if you look at um the Explorer that exe doesn't run in a window called prman um prman actually stands for program",
    "start": "2768680",
    "end": "2774599"
  },
  {
    "text": "manager which is the shell before the Windows Explorer uh being introduced to",
    "start": "2774599",
    "end": "2780040"
  },
  {
    "text": "Windows 3.1 and being dicated with uh Windows Vista so the samples we're",
    "start": "2780040",
    "end": "2785079"
  },
  {
    "text": "looking at wouldn't even run anymore on a Windows VOR or",
    "start": "2785079",
    "end": "2790160"
  },
  {
    "start": "2789000",
    "end": "2831000"
  },
  {
    "text": "older furthermore um these samples were mainly implants to monitor uh terminal",
    "start": "2790359",
    "end": "2795400"
  },
  {
    "text": "or sessions also they will install Global hooks to monitor certain system activity",
    "start": "2795400",
    "end": "2801920"
  },
  {
    "text": "and characters typed into the machine and also the sample would load the custom dll which again we didn't get our",
    "start": "2801920",
    "end": "2807359"
  },
  {
    "text": "hands on so if you have any hints we'd be very thankful um Ste is loaded and uh",
    "start": "2807359",
    "end": "2813200"
  },
  {
    "text": "six experts are loaded from the Ste so this point in",
    "start": "2813200",
    "end": "2818800"
  },
  {
    "text": "time we felt a bit like archaeologists digging in Graves so sort of less",
    "start": "2818800",
    "end": "2825079"
  },
  {
    "text": "malware analysis and more malware grave robbing um Qui",
    "start": "2825079",
    "end": "2832319"
  },
  {
    "start": "2831000",
    "end": "2854000"
  },
  {
    "text": "quickly what this mware family also did uh sorry what these binaries did uh just",
    "start": "2833720",
    "end": "2839200"
  },
  {
    "text": "like his ancestors used the same string of thec method and be very evasive when it came to network sniffers so it would",
    "start": "2839200",
    "end": "2845079"
  },
  {
    "text": "again evade uh from security products and just not execute certain functionality when certain security",
    "start": "2845079",
    "end": "2851440"
  },
  {
    "text": "products were present um this one as far uh as to the the",
    "start": "2851440",
    "end": "2857680"
  },
  {
    "start": "2854000",
    "end": "2913000"
  },
  {
    "text": "stealthy network communication so the samples were very very uh careful not to",
    "start": "2857680",
    "end": "2864119"
  },
  {
    "text": "take off any security product on the machines just by uh being very stealthy",
    "start": "2864119",
    "end": "2869200"
  },
  {
    "text": "and it's communication it used different methods to make it way out of the corporate Network including dial up",
    "start": "2869200",
    "end": "2874960"
  },
  {
    "text": "connections which I'm not sure if anyone in here still uses a dial up Connection in this corporate Network um the samples used nine or more",
    "start": "2874960",
    "end": "2882760"
  },
  {
    "text": "CNC servers and would iterate between them and communicate to them in infrequent intervals which we consider",
    "start": "2882760",
    "end": "2888839"
  },
  {
    "text": "as very stealthy uh considering that the model was compiled from 2007 to",
    "start": "2888839",
    "end": "2893920"
  },
  {
    "text": "2009 so we have an actor which tries to be very very evasive as the",
    "start": "2893920",
    "end": "2899280"
  },
  {
    "text": "communication uh to the remote server was done by injected code to the standard browser uh to to an instance of",
    "start": "2899280",
    "end": "2905839"
  },
  {
    "text": "the standard browser which is frequently used to bypass firewalls and local security",
    "start": "2905839",
    "end": "2912760"
  },
  {
    "start": "2913000",
    "end": "2973000"
  },
  {
    "text": "settings furthermore uh we have newer samples from the same family which show",
    "start": "2913359",
    "end": "2919000"
  },
  {
    "text": "approximately the same functionality but have a special module to grab security settings from kasperski security",
    "start": "2919000",
    "end": "2925559"
  },
  {
    "text": "products now this is interesting because usually what we see in malare is that it tries to find uh settings or or just to",
    "start": "2925559",
    "end": "2933000"
  },
  {
    "text": "find and debate security products of multiple vendors but this one was just out for kasperski products so this leads",
    "start": "2933000",
    "end": "2938880"
  },
  {
    "text": "us to believe that the ATT riding the malware actually knew very well which environment they were infecting they",
    "start": "2938880",
    "end": "2944200"
  },
  {
    "text": "knew the operating system the new the network settings the new the security products installed in the systems so we",
    "start": "2944200",
    "end": "2949559"
  },
  {
    "text": "have a very very targeted attack and an interesting fact that we",
    "start": "2949559",
    "end": "2955599"
  },
  {
    "text": "didn't tell you yet was the uh naming Convention of fils that would be created",
    "start": "2955599",
    "end": "2962960"
  },
  {
    "text": "by this kind of mware so all of our uh eled chesar cat M samples would drop",
    "start": "2962960",
    "end": "2970119"
  },
  {
    "text": "temp f um starting with a tilt",
    "start": "2970119",
    "end": "2976559"
  },
  {
    "text": "so the temples will be named tilt DF and then a random value so you may remember",
    "start": "2976559",
    "end": "2984240"
  },
  {
    "text": "Marian's binary stylometry approach from before if we apply that to this malware then we can discover that the act wait",
    "start": "2984240",
    "end": "2990160"
  },
  {
    "text": "we've got 45 seconds left that that approach is actually really laborious um so what we're going to do is we're going",
    "start": "2990160",
    "end": "2996119"
  },
  {
    "start": "2994000",
    "end": "3007000"
  },
  {
    "text": "to use the attribution magic eight ball to figure out who this was uh so if the audience would like to roll with me",
    "start": "2996119",
    "end": "3001680"
  },
  {
    "text": "shake the magic eight ball and we will discover that the person behind this long and targeted maware campaign was",
    "start": "3001680",
    "end": "3008880"
  },
  {
    "start": "3007000",
    "end": "3027000"
  },
  {
    "text": "China fantastic all right thanks a lot guys we are Morgan Marian and cladio In",
    "start": "3008880",
    "end": "3017640"
  },
  {
    "text": "Absentia thank you very much for your attention",
    "start": "3017640",
    "end": "3022440"
  },
  {
    "text": "[Applause]",
    "start": "3025740",
    "end": "3029710"
  }
]