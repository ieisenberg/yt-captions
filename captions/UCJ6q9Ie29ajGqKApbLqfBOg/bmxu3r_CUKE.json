[
  {
    "text": "this session is Bitcoin transaction malleability theory and practice we're",
    "start": "80",
    "end": "5359"
  },
  {
    "text": "going to hear from Daniel Chik and Ben",
    "start": "5359",
    "end": "9200"
  },
  {
    "text": "Hayek um okay nice to meet you all um I Ben Hayak and I'm and and we are",
    "start": "26640",
    "end": "34960"
  },
  {
    "text": "security researchers at trust waves spal Labs we actually help protect people",
    "start": "34960",
    "end": "40239"
  },
  {
    "text": "against zero days and client side threats today we're are going to show",
    "start": "40239",
    "end": "45559"
  },
  {
    "text": "you not only what Bitcoin transaction malleability is but how to actually do",
    "start": "45559",
    "end": "50640"
  },
  {
    "text": "it yourselves in practice now for those of you who are not familiar with Bitcoin transaction",
    "start": "50640",
    "end": "57359"
  },
  {
    "text": "Mobility let me say let me just say that it was used to steal millions of dollars",
    "start": "57359",
    "end": "63120"
  },
  {
    "text": "from Stock Exchange websites s such as empty GA and",
    "start": "63120",
    "end": "70080"
  },
  {
    "text": "others okay okay um we are going to give a",
    "start": "70080",
    "end": "76040"
  },
  {
    "text": "quick overview on bitcoin we'll examine in depth how to place a transaction",
    "start": "76040",
    "end": "81360"
  },
  {
    "text": "we'll explain how and what is transaction Mal ability and we will show how the money",
    "start": "81360",
    "end": "88119"
  },
  {
    "text": "haste in empty gos apparently happened and finally we'll present a live demo of",
    "start": "88119",
    "end": "95040"
  },
  {
    "text": "the transaction Mal ability in practice more than a year ago when I",
    "start": "95040",
    "end": "101759"
  },
  {
    "text": "first heard about Bitcoins I was thinking that I finally found a way to get rich",
    "start": "101759",
    "end": "107479"
  },
  {
    "text": "quickly but when I looked at the price of Bitcoin I realized that I kind of",
    "start": "107479",
    "end": "113560"
  },
  {
    "text": "missed the train because in the past several months the price climbed rapidly from a few dollars to like 90 bucks and",
    "start": "113560",
    "end": "121640"
  },
  {
    "text": "there's no way that it will go even higher than that oh well I'm I might I might was",
    "start": "121640",
    "end": "129239"
  },
  {
    "text": "wrong about it but there's no way that it will go even higher than that so I",
    "start": "129239",
    "end": "134840"
  },
  {
    "text": "decided to read a little bit about this Mining and I realized that uh if I use",
    "start": "134840",
    "end": "140599"
  },
  {
    "text": "my computer to do mining which I had no clue what it means I might find some",
    "start": "140599",
    "end": "145879"
  },
  {
    "text": "Bitcoins awesome so three weeks later I had two machines with four of the top",
    "start": "145879",
    "end": "152080"
  },
  {
    "text": "graphic cards 7970 I started to do mining well after a",
    "start": "152080",
    "end": "159360"
  },
  {
    "text": "while uh as you can see I didn't get rich and those graphic cards are well",
    "start": "159360",
    "end": "164959"
  },
  {
    "text": "stored in the original boxes standing for sale on",
    "start": "164959",
    "end": "170280"
  },
  {
    "text": "eBay you know what but Ben story isn't funnier than mine because his mining",
    "start": "171319",
    "end": "176360"
  },
  {
    "text": "machine was actually his personal computer standing in his room room walking all night long doing a terrible",
    "start": "176360",
    "end": "182200"
  },
  {
    "text": "noise I remember him coming to office so tired with Big Red Eyes Crying that he",
    "start": "182200",
    "end": "187799"
  },
  {
    "text": "couldn't sleep even bought ear plugs you know but uh after a while he also gave",
    "start": "187799",
    "end": "195080"
  },
  {
    "text": "up with this mining stuff and stopped doing it uh so as you can see also didn't get",
    "start": "195080",
    "end": "201599"
  },
  {
    "text": "rich but uh we both learned a lot about Bitcoins the fact that we found the",
    "start": "201599",
    "end": "207920"
  },
  {
    "text": "concept of Bitcoin very interesting the fact that it's a peer-to-peer network no company or organization controls it and",
    "start": "207920",
    "end": "215120"
  },
  {
    "text": "can still function properly is amazing also the fact that the number of Bitcoins is limited there are like 22",
    "start": "215120",
    "end": "221400"
  },
  {
    "text": "million Bitcoins and in order to have a wallet you don't need an ID so it's pretty much Anonymous well well we",
    "start": "221400",
    "end": "228959"
  },
  {
    "text": "didn't really gather here to uh discuss the greatness of Bitcoin we are actually here to explain this really",
    "start": "228959",
    "end": "236319"
  },
  {
    "text": "extraordinary attack called Bitcoin transaction Mobility for you to understand this attack let me",
    "start": "236319",
    "end": "243360"
  },
  {
    "text": "first go over and explain the relevant components of the Bitcoin",
    "start": "243360",
    "end": "249319"
  },
  {
    "text": "protocol so one of the most important components in the Bitcoin protocol is a",
    "start": "249319",
    "end": "254799"
  },
  {
    "text": "block and a block is simply a container of transactions if you want to read a",
    "start": "254799",
    "end": "260160"
  },
  {
    "text": "certain transaction you'll have to access its block well since it's a peer-to-peer",
    "start": "260160",
    "end": "265800"
  },
  {
    "text": "Network every individual can simply uh send a new block a fake block to the",
    "start": "265800",
    "end": "272639"
  },
  {
    "text": "network but only the valid ones will get included in something we call a",
    "start": "272639",
    "end": "278160"
  },
  {
    "text": "blockchain and a blockchain is simply all the valid blocks chained together",
    "start": "278160",
    "end": "284000"
  },
  {
    "text": "from the beginning of the currency up up to today now every block contains an an",
    "start": "284000",
    "end": "291400"
  },
  {
    "text": "hash of an older block as its previous block hash value and that's what makes",
    "start": "291400",
    "end": "297080"
  },
  {
    "text": "it a part of the block of the blockchain yeah and also in this peer-to-peer",
    "start": "297080",
    "end": "303280"
  },
  {
    "text": "Network as long as the majority of the participants are honest the blockchain could not get",
    "start": "303280",
    "end": "312320"
  },
  {
    "text": "manipulated so this is the block header structure and the first thing that I",
    "start": "312479",
    "end": "317800"
  },
  {
    "text": "will uh like to mention here is the magic number which is simply a static value that represent the the currency",
    "start": "317800",
    "end": "324680"
  },
  {
    "text": "let's say the value that you see on the screen would be Bitcoin but other values",
    "start": "324680",
    "end": "329720"
  },
  {
    "text": "such as Litecoin or feathercoin will have different magic numbers and therefore they can work simultaneously",
    "start": "329720",
    "end": "337199"
  },
  {
    "text": "because of that fact so the next thing is the block header which is critical for the mining",
    "start": "337199",
    "end": "343960"
  },
  {
    "text": "process if you are familiar with Mining and we'll explain mining in a moment",
    "start": "343960",
    "end": "349120"
  },
  {
    "text": "okay finally the transactions as we said a block is a container of transactions",
    "start": "349120",
    "end": "356039"
  },
  {
    "text": "so there's a list of of of transactions inside every block",
    "start": "356039",
    "end": "361639"
  },
  {
    "text": "so this is the block header structure and before we go and explain",
    "start": "362000",
    "end": "367440"
  },
  {
    "text": "the relevant Parts in the block header structure let me first stop here and answer a question that really bothered",
    "start": "367440",
    "end": "373680"
  },
  {
    "text": "me personally when I first started in the Bitcoin business so when I did so I",
    "start": "373680",
    "end": "380759"
  },
  {
    "text": "I wanted to make money out of nothing right like like any of us so I just uh",
    "start": "380759",
    "end": "387479"
  },
  {
    "text": "knew that I need to start a certain a certain mining program and watch some numbers watch some Brute Force and",
    "start": "387479",
    "end": "393240"
  },
  {
    "text": "hashes and get coins get money get",
    "start": "393240",
    "end": "398360"
  },
  {
    "text": "rich and uh well it didn't work out that well but I learned that these hashes",
    "start": "398360",
    "end": "404520"
  },
  {
    "text": "were I I wonder where are they coming from so these hashes were are coming from the Block header data all of these",
    "start": "404520",
    "end": "411120"
  },
  {
    "text": "data is being hashed to create that the to create many hashes uh in order to",
    "start": "411120",
    "end": "416960"
  },
  {
    "text": "solve a block and in order to use this data to make many many hashes until you",
    "start": "416960",
    "end": "422599"
  },
  {
    "text": "hit the correct one there's a no one value and the no is simply a static number that you try I mean a random",
    "start": "422599",
    "end": "429199"
  },
  {
    "text": "number actually that you are uh changing in in the mining efforts until you hit",
    "start": "429199",
    "end": "434599"
  },
  {
    "text": "the correct one as and as we mentioned in the blockchain the hash of the previous block which places this block",
    "start": "434599",
    "end": "441039"
  },
  {
    "text": "in the blockchain so what is mining",
    "start": "441039",
    "end": "447680"
  },
  {
    "text": "well people are trying to to transfer coins to one another on daily basis",
    "start": "447680",
    "end": "453520"
  },
  {
    "text": "right people just generate transactions let's say you are trying to uh transfer",
    "start": "453520",
    "end": "458840"
  },
  {
    "text": "coins let's say uh this guy is trying to transfer coins to the rest of the",
    "start": "458840",
    "end": "464080"
  },
  {
    "text": "audience he's a a really great guy by the way no you know what let's say you are",
    "start": "464080",
    "end": "470120"
  },
  {
    "text": "trying to transfer coins to us okay please do so that means that there are pending",
    "start": "470120",
    "end": "476599"
  },
  {
    "text": "transactions on the network pretty much all the time and we need someone or something to",
    "start": "476599",
    "end": "484639"
  },
  {
    "text": "confirm these transactions and that's where mining comes in so every Miner in the peer-to-peer",
    "start": "484639",
    "end": "493159"
  },
  {
    "text": "Network collects all of the pending transactions store them in the memory",
    "start": "493159",
    "end": "498840"
  },
  {
    "text": "then it uses them to build a theoretical block then he used computing power in",
    "start": "498840",
    "end": "506599"
  },
  {
    "text": "order to generate hashes from these block and if if if the hashes are going",
    "start": "506599",
    "end": "512080"
  },
  {
    "text": "to be lowered than a certain Target set by the current difficulty then uh the",
    "start": "512080",
    "end": "517760"
  },
  {
    "text": "the the individual minor will solve that block and if if that was the case then",
    "start": "517760",
    "end": "524959"
  },
  {
    "text": "he will broadcast this new block into the network and two interesting facts will",
    "start": "524959",
    "end": "531680"
  },
  {
    "text": "actually happen here the first one is that all of the pending transactions inside that solved block would now get",
    "start": "531680",
    "end": "539200"
  },
  {
    "text": "conf fed and this guy will be really happy and the second thing that will",
    "start": "539200",
    "end": "545560"
  },
  {
    "text": "happen is that that particular Min solve that block will be rewarded for his effort with 25 Bitcoin as for",
    "start": "545560",
    "end": "554920"
  },
  {
    "text": "today so we know that the concept of mining may sound confusing to some of",
    "start": "554920",
    "end": "560839"
  },
  {
    "text": "the people and it's really hard to explain it in like a a minute or so so we decided to do it right",
    "start": "560839",
    "end": "567640"
  },
  {
    "text": "now on your chair or if you were lucky enough to collect them at our booth they are supposed to",
    "start": "567640",
    "end": "574519"
  },
  {
    "text": "be Flyers everybody got Flyers",
    "start": "574519",
    "end": "579560"
  },
  {
    "text": "right yeah well it's not going to get you any free drinks or anything so yeah",
    "start": "580040",
    "end": "585320"
  },
  {
    "text": "um but what the point yeah so on the back side of these flyers there are hex",
    "start": "585320",
    "end": "591839"
  },
  {
    "text": "numbers let's say these numbers are your hashes okay so we want you to look at",
    "start": "591839",
    "end": "598760"
  },
  {
    "text": "these numbers really carefully because we're about to expose our own hash in the presentation",
    "start": "598760",
    "end": "606079"
  },
  {
    "text": "and if your number is going to be lower than the number you're about to see we want you to raise your",
    "start": "606079",
    "end": "613240"
  },
  {
    "text": "hand but do it really quickly because only the first two people will win a",
    "start": "613240",
    "end": "619640"
  },
  {
    "text": "prize okay ready well this guy I see and did you",
    "start": "619640",
    "end": "629880"
  },
  {
    "text": "see I think it was first and not sure was I think that that was the a guy",
    "start": "629880",
    "end": "638440"
  },
  {
    "text": "back there and this guy okay awesome okay so Daniel please reward them with",
    "start": "638440",
    "end": "643560"
  },
  {
    "text": "this worthless uh Bitcoin paper",
    "start": "643560",
    "end": "648839"
  },
  {
    "text": "okay here you go and can I see the flyer",
    "start": "651600",
    "end": "660680"
  },
  {
    "text": "oh no no it's not the right one can I see yeah this is one is good",
    "start": "661920",
    "end": "670639"
  },
  {
    "text": "here you go awesome well we was just kidding",
    "start": "670639",
    "end": "676200"
  },
  {
    "text": "actually these These are uh pretty valuable you can redeem them in our booth for a really cool price it's a",
    "start": "676200",
    "end": "683360"
  },
  {
    "text": "hble watch so congratulations",
    "start": "683360",
    "end": "688320"
  },
  {
    "text": "[Applause]",
    "start": "688640",
    "end": "692970"
  },
  {
    "text": "okay so um after we saw uh how the",
    "start": "693680",
    "end": "699480"
  },
  {
    "text": "mining process is very important part of the Bitcoin Network and also very profitable for the lucky",
    "start": "699480",
    "end": "706000"
  },
  {
    "text": "winners um in on a high level perspective the mining process is",
    "start": "706000",
    "end": "711639"
  },
  {
    "text": "translated into some additional important goals in the Bitcoin Network beside the transaction confirmations",
    "start": "711639",
    "end": "720040"
  },
  {
    "text": "so first it keeps the network steady as long as more participants running the",
    "start": "720040",
    "end": "726240"
  },
  {
    "text": "Bitcoin client lower the chances that a single person or group of people will",
    "start": "726240",
    "end": "732040"
  },
  {
    "text": "take control of the network and second it helps to store and",
    "start": "732040",
    "end": "737480"
  },
  {
    "text": "keep the entire records of the blockchain which makes the network much more",
    "start": "737480",
    "end": "744040"
  },
  {
    "text": "reliable so before we are going to talk about the interesting stuff let's do a quick wrap up we have talked about a",
    "start": "745120",
    "end": "751199"
  },
  {
    "text": "block which is a container of transaction we have also talked about the blockchain that holds the entire",
    "start": "751199",
    "end": "758120"
  },
  {
    "text": "records of the Bitcoin Network and finally the block solving process which",
    "start": "758120",
    "end": "764320"
  },
  {
    "text": "is used to keep the network steady and executing transactions from one wallet to",
    "start": "764320",
    "end": "769920"
  },
  {
    "text": "another which leads us to transactions transactions are basically",
    "start": "769920",
    "end": "776839"
  },
  {
    "text": "the core of the Bitcoin currency or any other currency in fact for now there is",
    "start": "776839",
    "end": "782399"
  },
  {
    "text": "no acceptable or formal way to physically trade with",
    "start": "782399",
    "end": "788320"
  },
  {
    "text": "Bitcoins uh it has to be done online so let's take a look on a high",
    "start": "788320",
    "end": "794560"
  },
  {
    "text": "level on the Bitcoin transaction process let's say Alice wants to give Bob 100",
    "start": "794560",
    "end": "801120"
  },
  {
    "text": "Bitcoins so Alice machine just generate a new block a transaction and broadcast",
    "start": "801120",
    "end": "807360"
  },
  {
    "text": "it to the network this transaction along with other transactions are collected by the miners",
    "start": "807360",
    "end": "814040"
  },
  {
    "text": "and inserted into a block and after a while when the block is solved the transaction is",
    "start": "814040",
    "end": "820760"
  },
  {
    "text": "confirmed I would like to mention that the screenshots that you're about to see are taken from an environment of a coin",
    "start": "820760",
    "end": "826639"
  },
  {
    "text": "called my coin which is used for the purpose of this presentation we use the default Bitcoin client source code to",
    "start": "826639",
    "end": "833160"
  },
  {
    "text": "compile mcoin which is functioning exactly like the regular Bitcoin client",
    "start": "833160",
    "end": "839639"
  },
  {
    "text": "okay so so again Alice wants to give Bob 100 Bitcoins if we take a look on the",
    "start": "839639",
    "end": "846480"
  },
  {
    "text": "Bitcoin client we can see on the pay two field that I inserted Bob's wallet address which is a nice representation",
    "start": "846480",
    "end": "853920"
  },
  {
    "text": "of Bob's publicy once I click okay the transaction is going to be verified",
    "start": "853920",
    "end": "860240"
  },
  {
    "text": "locally to ensure that I have enough funds in my account to commit the transaction and then the Bitcoin client",
    "start": "860240",
    "end": "868639"
  },
  {
    "text": "just generate uh the transaction and broadcast it across the network if we take a look on the",
    "start": "868639",
    "end": "876120"
  },
  {
    "text": "transaction history on the Bitcoin CLI we can see on the state status property that it says that the transaction is not",
    "start": "876120",
    "end": "883800"
  },
  {
    "text": "confirmed yet it says zero confirmation and it also says that the transaction",
    "start": "883800",
    "end": "889839"
  },
  {
    "text": "has been broadcasted through a single node since I had only one peer connected",
    "start": "889839",
    "end": "894920"
  },
  {
    "text": "to my machine at this point the miners who",
    "start": "894920",
    "end": "900240"
  },
  {
    "text": "want to solve the block and win the reward will query the peer to receive",
    "start": "900240",
    "end": "905680"
  },
  {
    "text": "the relevant block that should be solved here for example is a tool that is used",
    "start": "905680",
    "end": "911320"
  },
  {
    "text": "to doing the mining process which is publicly available the script executes",
    "start": "911320",
    "end": "916399"
  },
  {
    "text": "hashes while changing the Nots every time as been explained earlier until it hits the correct hash",
    "start": "916399",
    "end": "923199"
  },
  {
    "text": "that fits the current Target here for example the correct h",
    "start": "923199",
    "end": "929720"
  },
  {
    "text": "block has been found it says accepted and it says yay okay so after the block is St that",
    "start": "929720",
    "end": "937759"
  },
  {
    "text": "the block is uh broadcasted to the network and the transaction is confirmed as you can see and Bitcoins as be",
    "start": "937759",
    "end": "945319"
  },
  {
    "text": "transfer from Alice to B",
    "start": "945319",
    "end": "951240"
  },
  {
    "text": "okay in our real Finance world we are used to transfer money from one to another by using cash or by using bank",
    "start": "951240",
    "end": "958560"
  },
  {
    "text": "account like transferring money from one account to",
    "start": "958560",
    "end": "964000"
  },
  {
    "text": "another um but eventually at the end of the day",
    "start": "964040",
    "end": "970319"
  },
  {
    "text": "I can count how much money I have whether if it's in cash or in my bank account let's say I have this $5 bill if",
    "start": "970319",
    "end": "978440"
  },
  {
    "text": "Ben asks me from where I got it where I can tell him anything I can tell him",
    "start": "978440",
    "end": "984120"
  },
  {
    "text": "that I found it on the street or maybe I even found it at the casino at the roulet table okay",
    "start": "984120",
    "end": "989680"
  },
  {
    "text": "but you won't really have a way to verify my answer in the Bitcoin World it works",
    "start": "989680",
    "end": "995480"
  },
  {
    "text": "differently one person or it might be more accurate to say one wallet address",
    "start": "995480",
    "end": "1001639"
  },
  {
    "text": "doesn't hold its balance it is simply calculated from all the previous transactions that related to the same",
    "start": "1001639",
    "end": "1007839"
  },
  {
    "text": "wallet address the incoming and the outo outgoing",
    "start": "1007839",
    "end": "1013040"
  },
  {
    "text": "transactions because the money is not really being transferred from one wallet",
    "start": "1013040",
    "end": "1018120"
  },
  {
    "text": "to another let's say that someone let let's call him Jeff gave me 100 Bitcoins okay and",
    "start": "1018120",
    "end": "1026038"
  },
  {
    "text": "now I want to give Ben 100 Bitcoins so I will take a note and I will write Jeff",
    "start": "1026039",
    "end": "1032880"
  },
  {
    "text": "gave me Daniel 100 Bitcoins okay and I'm giving Ben 100 Bitcoins and the same",
    "start": "1032880",
    "end": "1040640"
  },
  {
    "text": "goes for every transaction that Ben will want to commit so we can actually say that",
    "start": "1040640",
    "end": "1047240"
  },
  {
    "text": "transactions are composed from two main components the first one is the inputs",
    "start": "1047240",
    "end": "1053000"
  },
  {
    "text": "which is the proof that an individual has enough unspent coins to transfer and the second one is outputs",
    "start": "1053000",
    "end": "1061320"
  },
  {
    "text": "which includes the addresses where to send the coins this way no one can spend coins",
    "start": "1061320",
    "end": "1069760"
  },
  {
    "text": "unless he or she has them because a reference to the previous valid",
    "start": "1069760",
    "end": "1074840"
  },
  {
    "text": "transaction must be included in every transaction in addition it also disables the option",
    "start": "1074840",
    "end": "1082559"
  },
  {
    "text": "of trying tricking the system by spending the same coins more than once because once you have used a specific",
    "start": "1082559",
    "end": "1089360"
  },
  {
    "text": "reference for a transaction you won't be able to use the same reference",
    "start": "1089360",
    "end": "1095240"
  },
  {
    "text": "again okay thank you well now that you have all the relevant",
    "start": "1096360",
    "end": "1102799"
  },
  {
    "text": "information that you need to understand transaction malleability we are finally about to explain it so this is a really",
    "start": "1102799",
    "end": "1109799"
  },
  {
    "text": "good time to wake up so first in order to simplify things",
    "start": "1109799",
    "end": "1116440"
  },
  {
    "text": "let's let's assume that we have a lottery company that let's assume that",
    "start": "1116440",
    "end": "1121559"
  },
  {
    "text": "actually we have a peer-to-peer Network that is being used by this lottery company to inform people that they want",
    "start": "1121559",
    "end": "1127960"
  },
  {
    "text": "a prize okay prizes are nice Al always so uh um the winner receives a message",
    "start": "1127960",
    "end": "1135799"
  },
  {
    "text": "from the lottery company in a peer-to-peer Network and let's go over this message first we have a length",
    "start": "1135799",
    "end": "1141799"
  },
  {
    "text": "which is pretty simple right a length of the upcoming content then we have the content itself which says that this",
    "start": "1141799",
    "end": "1148919"
  },
  {
    "text": "message was coming from a lottery company and your prize is a car pretty",
    "start": "1148919",
    "end": "1154760"
  },
  {
    "text": "cool so then we have a length again and the identity of the winner let's say it",
    "start": "1154760",
    "end": "1160080"
  },
  {
    "text": "was me was Ben okay so this is a peer-to-peer Network so we",
    "start": "1160080",
    "end": "1167559"
  },
  {
    "text": "cannot use these uh these sensitive values like a car or or",
    "start": "1167559",
    "end": "1174200"
  },
  {
    "text": "or identity of the winner people can grab this this message and change it so",
    "start": "1174200",
    "end": "1180600"
  },
  {
    "text": "so uh we want to uh to make sure that no one manipulated the content of this",
    "start": "1180600",
    "end": "1185960"
  },
  {
    "text": "message let's say for example if someone uh changed the prize to his favorite summer vacation",
    "start": "1185960",
    "end": "1192520"
  },
  {
    "text": "Vegas so in order to avoid such such manipulation we have to add something",
    "start": "1192520",
    "end": "1198760"
  },
  {
    "text": "that will sign then the sensitive parts so that message includes a",
    "start": "1198760",
    "end": "1204480"
  },
  {
    "text": "signature okay and finally to create an identifier for this",
    "start": "1204480",
    "end": "1210320"
  },
  {
    "text": "message so people can track this message we use hash algorithm and that's creates",
    "start": "1210320",
    "end": "1215880"
  },
  {
    "text": "a unique hash for this particular message so once I get this message",
    "start": "1215880",
    "end": "1223000"
  },
  {
    "text": "because I'm the winner once I get this message I can go to the car company and",
    "start": "1223000",
    "end": "1229240"
  },
  {
    "text": "say hey please give me my car well the cashier over there will say okay let's",
    "start": "1229240",
    "end": "1236640"
  },
  {
    "text": "validate this message he'll go and see that okay this is a lottery company that we are working with please give me your",
    "start": "1236640",
    "end": "1243679"
  },
  {
    "text": "ID and I will check it out and he checks that we I am really I really am the",
    "start": "1243679",
    "end": "1248720"
  },
  {
    "text": "winner of this message so he will say wait a want wait a moment let me just",
    "start": "1248720",
    "end": "1254760"
  },
  {
    "text": "write or save this hash of this unique message in our database so you cannot",
    "start": "1254760",
    "end": "1260679"
  },
  {
    "text": "really use it again and he marked it as already spent so I cannot like go and",
    "start": "1260679",
    "end": "1267720"
  },
  {
    "text": "take another car so do you guys see any flaw and this",
    "start": "1267720",
    "end": "1277000"
  },
  {
    "text": "implementation do you see anything that can be changed or anything that can be",
    "start": "1277000",
    "end": "1282080"
  },
  {
    "text": "done to hawk or do something awful or win some more prizes",
    "start": "1282080",
    "end": "1289760"
  },
  {
    "text": "well let me help you what if I can add or change anything",
    "start": "1289760",
    "end": "1296960"
  },
  {
    "text": "that is not sensitive in this message if I can do that hashing this",
    "start": "1296960",
    "end": "1304760"
  },
  {
    "text": "different data will be uh we we will have a different result we generate a different",
    "start": "1304760",
    "end": "1310039"
  },
  {
    "text": "message ID while the signature will stay completely valid because I added",
    "start": "1310039",
    "end": "1315080"
  },
  {
    "text": "something that is not um you know sensitive so if I can do that then I can take my",
    "start": "1315080",
    "end": "1322840"
  },
  {
    "text": "new car drive to the car company and say Hey I want a car and and the cashier",
    "start": "1322840",
    "end": "1329360"
  },
  {
    "text": "will say over will he will watch me watch my face will say oh yeah yeah you're familiar but you know what let's",
    "start": "1329360",
    "end": "1336039"
  },
  {
    "text": "check this message and he will validate all the sensitive parts in this message and will say okay the signature is",
    "start": "1336039",
    "end": "1342320"
  },
  {
    "text": "perfectly okay but wait I know what you're trying to do let's check our",
    "start": "1342320",
    "end": "1347520"
  },
  {
    "text": "database for this message ID and guess what he won't see this",
    "start": "1347520",
    "end": "1352640"
  },
  {
    "text": "message ID because I managed to change it so now I have to figure out how to",
    "start": "1352640",
    "end": "1358200"
  },
  {
    "text": "drive two cars back home and I want two cars so this is",
    "start": "1358200",
    "end": "1364480"
  },
  {
    "text": "pretty much the concept and these are my cars by the way so so this is the",
    "start": "1364480",
    "end": "1369799"
  },
  {
    "text": "concept of transaction ability you add or change something without breaking the signature and",
    "start": "1369799",
    "end": "1376600"
  },
  {
    "text": "therefore uh you abuse systems that tracks only uh the ID of",
    "start": "1376600",
    "end": "1383080"
  },
  {
    "text": "this message so well enough with the examples and stuff like that let's look at a a",
    "start": "1383080",
    "end": "1390120"
  },
  {
    "text": "real transaction okay this is a real transaction that is being uh this is a",
    "start": "1390120",
    "end": "1395640"
  },
  {
    "text": "real transaction structure actually U from the Bitcoin protocol okay so look",
    "start": "1395640",
    "end": "1402679"
  },
  {
    "text": "at the structure and what was done in the transaction first we have the length which is represented by a single bite",
    "start": "1402679",
    "end": "1409279"
  },
  {
    "text": "that's really important the length uh this length is representing the script",
    "start": "1409279",
    "end": "1414720"
  },
  {
    "text": "Sig okay and the script Sig is up codes in the Bitcoin protocol it's it's really",
    "start": "1414720",
    "end": "1420279"
  },
  {
    "text": "not really relevant for the purpose of this presentation but believe me it's it",
    "start": "1420279",
    "end": "1425320"
  },
  {
    "text": "includes the references that uh Daniel uh explained in transactions which uh proves that you",
    "start": "1425320",
    "end": "1432159"
  },
  {
    "text": "have the coins that you're willing to transfer because there's no other way so there are the references inside that and",
    "start": "1432159",
    "end": "1437480"
  },
  {
    "text": "there's the senders address the the lottery address to validate that what this message was really coming from a",
    "start": "1437480",
    "end": "1443760"
  },
  {
    "text": "certain Source okay next we have the amount this is a real transaction yeah so we have the",
    "start": "1443760",
    "end": "1451320"
  },
  {
    "text": "amount of how many Bitcoins or how many coins we are trying to transfer okay and also we have the",
    "start": "1451320",
    "end": "1458360"
  },
  {
    "text": "script Pub Key which once again op codes but believe me this is the W the",
    "start": "1458360",
    "end": "1464039"
  },
  {
    "text": "Winner's address or the the target of this transaction who is going going to get these",
    "start": "1464039",
    "end": "1470799"
  },
  {
    "text": "coins okay so uh finally once again exactly like the lottery company to",
    "start": "1470799",
    "end": "1476520"
  },
  {
    "text": "identify that message we use hash algorithm and that's just basically to",
    "start": "1476520",
    "end": "1481640"
  },
  {
    "text": "to create a unique value to this specific Fields okay but listen very carefully because",
    "start": "1481640",
    "end": "1490120"
  },
  {
    "text": "look what what happens when we have a very long script for example if we have",
    "start": "1490120",
    "end": "1496919"
  },
  {
    "text": "many many references that we need to include in a legitimate transaction let's say I got this uh coins from Jeff",
    "start": "1496919",
    "end": "1503960"
  },
  {
    "text": "and I got some coins from Daniel so I have many references so in a legitimate way I need",
    "start": "1503960",
    "end": "1510480"
  },
  {
    "text": "more than just one bite to represent the size of the script",
    "start": "1510480",
    "end": "1516559"
  },
  {
    "text": "see so the answer for that in a legitimate way is push data up",
    "start": "1516559",
    "end": "1523440"
  },
  {
    "text": "codes if we add push data up code to the pro to the Bitcoin protocol",
    "start": "1523440",
    "end": "1529000"
  },
  {
    "text": "that that is actually doing an amazing thing the next two bytes after that push",
    "start": "1529000",
    "end": "1536080"
  },
  {
    "text": "data bite will represent the size but now in two",
    "start": "1536080",
    "end": "1542039"
  },
  {
    "text": "bytes so there are three uh three different push data there's push data",
    "start": "1542039",
    "end": "1547840"
  },
  {
    "text": "for itself push data two and push data four for different sizes so this is a",
    "start": "1547840",
    "end": "1553399"
  },
  {
    "text": "legitimate way and we'll see how they used it in transaction M ability to steal",
    "start": "1553399",
    "end": "1558840"
  },
  {
    "text": "Millions okay yeah two",
    "start": "1558840",
    "end": "1564840"
  },
  {
    "text": "bites so let's look at a practical example with numbers right because we love it so there's a a a 32 bytes long",
    "start": "1565120",
    "end": "1574120"
  },
  {
    "text": "of a script the size is 32 bytes okay and we are willing to transfer from the",
    "start": "1574120",
    "end": "1580000"
  },
  {
    "text": "lottery company from anyone to anyone uh 40 bit points that's that's that's a",
    "start": "1580000",
    "end": "1586159"
  },
  {
    "text": "transaction so in order to mutate this transaction to use transaction malleability over this",
    "start": "1586159",
    "end": "1593640"
  },
  {
    "text": "transaction we add a prefix of a 4D op",
    "start": "1593640",
    "end": "1598720"
  },
  {
    "text": "code which is push data 2 and add a suffix of zero byte so we",
    "start": "1598720",
    "end": "1605399"
  },
  {
    "text": "manag to add two different bytes to the original transaction without breaking",
    "start": "1605399",
    "end": "1610679"
  },
  {
    "text": "the signature there are many methods to uh to do uh transaction liability this",
    "start": "1610679",
    "end": "1616480"
  },
  {
    "text": "is this is one example but as long as you you don't break the signature everything is",
    "start": "1616480",
    "end": "1622440"
  },
  {
    "text": "fine okay so the same size are now represented by",
    "start": "1622799",
    "end": "1629559"
  },
  {
    "text": "two different bites so we didn't break the size as well because 32 is exactly equal to 0032 just different amount of",
    "start": "1629559",
    "end": "1638039"
  },
  {
    "text": "bytes and that and that's actually transaction ability technique so we have",
    "start": "1638039",
    "end": "1644640"
  },
  {
    "text": "the standard transaction versus the mutated one and all all that you need to",
    "start": "1644640",
    "end": "1650159"
  },
  {
    "text": "see here is that um down there you see different transaction IDs and that means",
    "start": "1650159",
    "end": "1655679"
  },
  {
    "text": "two cars right so so we have two different",
    "start": "1655679",
    "end": "1663200"
  },
  {
    "text": "transactions with the same amount of coins being transferred from the same",
    "start": "1663200",
    "end": "1668519"
  },
  {
    "text": "source to the exact same destination but one of them is mutated so that creates a",
    "start": "1668519",
    "end": "1675840"
  },
  {
    "text": "race condition between these two and we want to make sure that the mutated one",
    "start": "1675840",
    "end": "1681080"
  },
  {
    "text": "wins this race condition so there there are techniques like sending too many peers but you need",
    "start": "1681080",
    "end": "1687279"
  },
  {
    "text": "to do uh to win this R race condition so apparently nothing really",
    "start": "1687279",
    "end": "1694159"
  },
  {
    "text": "nothing bad really happened because you managed to transfer 40 coins from one",
    "start": "1694159",
    "end": "1700799"
  },
  {
    "text": "source to a to a uh one destination but as Daniel said you",
    "start": "1700799",
    "end": "1706480"
  },
  {
    "text": "cannot use the reference again so so the original transaction will be marked as already spent and will be rejected",
    "start": "1706480",
    "end": "1713799"
  },
  {
    "text": "Forever by the network so it will not get into any block anymore so",
    "start": "1713799",
    "end": "1722120"
  },
  {
    "text": "uh um to steal money using this technique or to show you how it's done",
    "start": "1722120",
    "end": "1728480"
  },
  {
    "text": "how it was done in empty go still like $600 million as they claim Danny will just explain how to do",
    "start": "1728480",
    "end": "1735919"
  },
  {
    "text": "it okay awesome so it's very interesting and now we are going to see how empty go",
    "start": "1735919",
    "end": "1743360"
  },
  {
    "text": "apparently fell for this trick on February 10 this year mty go",
    "start": "1743360",
    "end": "1749919"
  },
  {
    "text": "published an announcement they claimed that most of the Bitcoins were stolen due to a vulnerability in the Bitcoin",
    "start": "1749919",
    "end": "1756840"
  },
  {
    "text": "protocol which is the transaction meability okay so let's assume we have an attacker",
    "start": "1756840",
    "end": "1763679"
  },
  {
    "text": "that wish to steal money from mtg's website okay and this attacker has an account in",
    "start": "1763679",
    "end": "1770799"
  },
  {
    "text": "empty Go's website so far so good the and the attacker wants to send",
    "start": "1770799",
    "end": "1777799"
  },
  {
    "text": "money from his account in MTG to his personal wallet address MTG say no problem because so",
    "start": "1777799",
    "end": "1786200"
  },
  {
    "text": "far the operation is legit withdraw amount of money from your account in",
    "start": "1786200",
    "end": "1792080"
  },
  {
    "text": "empty box is fine to your personal wallet address and they generate a fresh new transaction and broadcast it to the",
    "start": "1792080",
    "end": "1799600"
  },
  {
    "text": "network and they also save the transaction ID in their database the one that is marked in",
    "start": "1799600",
    "end": "1806440"
  },
  {
    "text": "yellow meanwhile the attacker listen carefully to the network to the peers in the network and try to grab this this",
    "start": "1806440",
    "end": "1813679"
  },
  {
    "text": "transaction as fast as he can and then he perform the transaction meability",
    "start": "1813679",
    "end": "1819200"
  },
  {
    "text": "as like uh Ben explained now as you can see the",
    "start": "1819200",
    "end": "1824880"
  },
  {
    "text": "transaction ID is different from the original the mutated is different from the original",
    "start": "1824880",
    "end": "1830960"
  },
  {
    "text": "one and then he tries as fast as he can to send this mutated transaction to the",
    "start": "1830960",
    "end": "1837600"
  },
  {
    "text": "peers on the network that hopefully have not received the original transaction",
    "start": "1837600",
    "end": "1842760"
  },
  {
    "text": "yet if his scam was successful his transaction is going to be inserted into",
    "start": "1842760",
    "end": "1848440"
  },
  {
    "text": "the next block rather than the original one meaning that",
    "start": "1848440",
    "end": "1854279"
  },
  {
    "text": "now his wallet address is going to be rewarded with 30",
    "start": "1854279",
    "end": "1859519"
  },
  {
    "text": "Bitcoins if we stop for a minute and take a look on this picture everything looks fine I mean he",
    "start": "1859519",
    "end": "1866279"
  },
  {
    "text": "just withdraw some Bitcoins from his account in empty go and send it to his",
    "start": "1866279",
    "end": "1871679"
  },
  {
    "text": "uh personal wallet address but if we look look closely we can see that the",
    "start": "1871679",
    "end": "1877480"
  },
  {
    "text": "transaction ID is different okay the red against the yellow meaning",
    "start": "1877480",
    "end": "1883360"
  },
  {
    "text": "that the original transa the original transaction",
    "start": "1883360",
    "end": "1888519"
  },
  {
    "text": "is now considered as invalid because the reference that has been used in the",
    "start": "1888519",
    "end": "1894240"
  },
  {
    "text": "mutated transaction is also being used by the original one and cannot be used more than",
    "start": "1894240",
    "end": "1900440"
  },
  {
    "text": "once so it means that the original transaction is not going to be inserted",
    "start": "1900440",
    "end": "1905480"
  },
  {
    "text": "not in the next block not the other one and not ever again and it will keep remain",
    "start": "1905480",
    "end": "1911360"
  },
  {
    "text": "unconfirmed when empty go looked on this transaction this transaction ID they see",
    "start": "1911360",
    "end": "1917320"
  },
  {
    "text": "that something went went wrong because the transaction is invalid it's unconfirmed and they think that they",
    "start": "1917320",
    "end": "1924000"
  },
  {
    "text": "believe that the coins were not delivered to the poor Customer because",
    "start": "1924000",
    "end": "1929360"
  },
  {
    "text": "according to their records they see that the transaction was never accured um and therefore they generate",
    "start": "1929360",
    "end": "1938120"
  },
  {
    "text": "completely the new completely new transaction and send another 30 Bitcoins",
    "start": "1938120",
    "end": "1944399"
  },
  {
    "text": "to the attacker from the own personal wallet",
    "start": "1944399",
    "end": "1950120"
  },
  {
    "text": "and the attacker can do this process over and over again as long as he wants",
    "start": "1950120",
    "end": "1955159"
  },
  {
    "text": "and finally the attacker is",
    "start": "1955159",
    "end": "1959759"
  },
  {
    "text": "Happy okay now let's see how it actually can we can do it in practice so we're",
    "start": "1961880",
    "end": "1967000"
  },
  {
    "text": "going to do a live demo okay can I go to the Caribbean too um I'm not",
    "start": "1967000",
    "end": "1973760"
  },
  {
    "text": "sure thank you so this on this part you will see a live",
    "start": "1975440",
    "end": "1982360"
  },
  {
    "text": "demo of um um like a environment that we",
    "start": "1982360",
    "end": "1987840"
  },
  {
    "text": "made for this presentation and you we you heard us talking and you know explaining all this stuff but you're now",
    "start": "1987840",
    "end": "1995639"
  },
  {
    "text": "about to see how to actually do it and uh replicate what was uh apparently what",
    "start": "1995639",
    "end": "2001080"
  },
  {
    "text": "apparently happened to empty gax when they had like this H huge haste in like",
    "start": "2001080",
    "end": "2008200"
  },
  {
    "text": "$600 million were stor right I mean that's what they",
    "start": "2008200",
    "end": "2015799"
  },
  {
    "text": "said so we have uh in this um demo we have three different computers okay",
    "start": "2016840",
    "end": "2023960"
  },
  {
    "text": "three three different machines that we are about to use the attacker's machine is a machintosh just remember that and",
    "start": "2023960",
    "end": "2030840"
  },
  {
    "text": "you can see that he has zero my coins my coins is just a coin that we created for the purpose of this presentation and",
    "start": "2030840",
    "end": "2037480"
  },
  {
    "text": "this is going to be the attacker's computer okay this is the backand the",
    "start": "2037480",
    "end": "2046360"
  },
  {
    "text": "wallet of the the company that we are uh attacking the stock exchange company",
    "start": "2046360",
    "end": "2051839"
  },
  {
    "text": "we'll call it BD box",
    "start": "2051839",
    "end": "2055399"
  },
  {
    "text": "okay and now this is the third computer which is completely independent it's just like doing Mining and if you",
    "start": "2057440",
    "end": "2064398"
  },
  {
    "text": "remember mining helps us confirm transactions so this will do will do only mining so",
    "start": "2064399",
    "end": "2071200"
  },
  {
    "text": "nothing complex you don't need to watch these blue uh black screens and",
    "start": "2071200",
    "end": "2077839"
  },
  {
    "text": "understanding so let's uh let's start we have uh we have a a website that we are",
    "start": "2077839",
    "end": "2085919"
  },
  {
    "text": "that holds our coins okay we have we are logged in as blackhe hat 2014 okay as the attacker this is the",
    "start": "2085919",
    "end": "2093240"
  },
  {
    "text": "name of the attacker and we have available FS only 30 my coins",
    "start": "2093240",
    "end": "2098760"
  },
  {
    "text": "okay so we'll go to our wallet and copy these um the wallet address and put it",
    "start": "2098760",
    "end": "2105960"
  },
  {
    "text": "right here then we are willing to withdraw all the my that we have okay 30",
    "start": "2105960",
    "end": "2112680"
  },
  {
    "text": "so once we click withraw the the bdbx website the stock exchange website will generate a a new",
    "start": "2112680",
    "end": "2119839"
  },
  {
    "text": "transaction will broadcast it to the entire network okay so you can see there's now a pen in our history there's",
    "start": "2119839",
    "end": "2125880"
  },
  {
    "text": "a pending transaction with 30 my coins targeted to our wallet address so we",
    "start": "2125880",
    "end": "2131839"
  },
  {
    "text": "want to mutate this transaction we want to um steal money okay so we take the transaction",
    "start": "2131839",
    "end": "2138079"
  },
  {
    "text": "ID okay and we use a a client a Bitcoin client which is publicly available",
    "start": "2138079",
    "end": "2143720"
  },
  {
    "text": "everybody can use it to grab the raw data of this",
    "start": "2143720",
    "end": "2150359"
  },
  {
    "text": "transaction and this transaction this is the hex bite this is the binary that have um that uh that is be I all these",
    "start": "2150359",
    "end": "2158319"
  },
  {
    "text": "transaction data so for the purpose of this presentation",
    "start": "2158319",
    "end": "2164599"
  },
  {
    "text": "we'll do this part manually but we made a tool for you and you can do it",
    "start": "2164599",
    "end": "2170480"
  },
  {
    "text": "completely automatically but you just need to win a race condition and such so we'll parse this Mal so you can see how",
    "start": "2170480",
    "end": "2177440"
  },
  {
    "text": "it's done so the first the first part is the version in every transaction there's",
    "start": "2177440",
    "end": "2182839"
  },
  {
    "text": "the version and the next bite is going to be the number of incoming",
    "start": "2182839",
    "end": "2188319"
  },
  {
    "text": "transactions okay so we write it right there then there's the previous transaction hash just don't don't really",
    "start": "2188319",
    "end": "2196160"
  },
  {
    "text": "uh it's it's not really important right now just parsing okay procing correctly um then we have the",
    "start": "2196160",
    "end": "2204640"
  },
  {
    "text": "sequence and this is where it starts to be interesting 6B is the total length of all the script",
    "start": "2206240",
    "end": "2213119"
  },
  {
    "text": "sees in this particular transaction okay so we copied the 6B and we're going to",
    "start": "2213119",
    "end": "2219520"
  },
  {
    "text": "do to follow a certain logic to do transaction M ability the next bite is 48 which is the length of the upcoming",
    "start": "2219520",
    "end": "2227000"
  },
  {
    "text": "script seek if you remember that moving red part then you'll see that right here",
    "start": "2227000",
    "end": "2233160"
  },
  {
    "text": "so let's take the scripts itself that we are willing to mutate",
    "start": "2233160",
    "end": "2239520"
  },
  {
    "text": "yeah just do it really carefully okay and the rest of this",
    "start": "2239520",
    "end": "2247119"
  },
  {
    "text": "transaction this is just the rest of the transaction not really important okay it's just the",
    "start": "2247119",
    "end": "2254000"
  },
  {
    "text": "important part is to leave it untouched so the signature won't break okay so",
    "start": "2254000",
    "end": "2259400"
  },
  {
    "text": "we'll follow this logic to do transaction liability first we'll take the total length the",
    "start": "2259400",
    "end": "2266240"
  },
  {
    "text": "6B okay take it and put it right here in the logic that we prepared in advance",
    "start": "2266240",
    "end": "2272960"
  },
  {
    "text": "and you see plus two because we are about to add two bytes but you will see this in a minute in a minute and we take the length of the script Sig",
    "start": "2272960",
    "end": "2279760"
  },
  {
    "text": "and put it between these values 4D if you remember that's push data too that means that 48 now has two by I mean the",
    "start": "2279760",
    "end": "2287359"
  },
  {
    "text": "next two bytes are going to represent the size of script six so we add a zero byte also to represent the same size but",
    "start": "2287359",
    "end": "2295359"
  },
  {
    "text": "with two different bites 48 or 0 48 take the the the original script",
    "start": "2295359",
    "end": "2302359"
  },
  {
    "text": "see put it here okay and",
    "start": "2302359",
    "end": "2309160"
  },
  {
    "text": "add do the math okay 6 b + 2 equals 6D so we just fixed the length so nothing",
    "start": "2309160",
    "end": "2315720"
  },
  {
    "text": "will break because we added two bites okay so now we'll take the the relevant",
    "start": "2315720",
    "end": "2321319"
  },
  {
    "text": "parts from the original transaction just leave it untouched and we paste the fixed size",
    "start": "2321319",
    "end": "2330680"
  },
  {
    "text": "with two more bytes 60 then we paste the mutated script SE",
    "start": "2330680",
    "end": "2337480"
  },
  {
    "text": "with push data too and everything remember push data is legitimate but we use it to make it to do bad",
    "start": "2337480",
    "end": "2344480"
  },
  {
    "text": "things now we take the the rest of the transaction paste it untouch again and",
    "start": "2344480",
    "end": "2350720"
  },
  {
    "text": "you can see the only difference that we did is adding push data and repres",
    "start": "2350720",
    "end": "2356040"
  },
  {
    "text": "representing it with two bytes instead of one so we managed to add something that is not",
    "start": "2356040",
    "end": "2362119"
  },
  {
    "text": "sensitive okay so we'll close the client now and once again again the the tool would do",
    "start": "2362119",
    "end": "2368760"
  },
  {
    "text": "all all these parts automatically we just do it to win to make sure we win the rise",
    "start": "2368760",
    "end": "2374599"
  },
  {
    "text": "condition okay and now we will uh use a script to send this transaction to",
    "start": "2374599",
    "end": "2380839"
  },
  {
    "text": "broadcast the mutated transaction to the entire network the new version of our",
    "start": "2380839",
    "end": "2386680"
  },
  {
    "text": "transaction so there will be two two different trans two uh different transactions with uh you're missing some",
    "start": "2386680",
    "end": "2394160"
  },
  {
    "text": "bites I think you have",
    "start": "2394160",
    "end": "2399920"
  },
  {
    "text": "connection just a",
    "start": "2400359",
    "end": "2403720"
  },
  {
    "text": "minute so well we have uh we will eventually we'll have uh the same",
    "start": "2406640",
    "end": "2412240"
  },
  {
    "text": "transaction we just push data okay that's all that that we need to",
    "start": "2412240",
    "end": "2417720"
  },
  {
    "text": "do I think there is a connection problem",
    "start": "2417720",
    "end": "2422838"
  },
  {
    "text": "yeah somebody told me earlier that if something goes wrong blame Microsoft but",
    "start": "2427920",
    "end": "2433280"
  },
  {
    "text": "this is a Macintosh",
    "start": "2433280",
    "end": "2437640"
  },
  {
    "text": "so don't worry that's the end of the presentation pretty soon so we just want",
    "start": "2441920",
    "end": "2447720"
  },
  {
    "text": "to show you to show it to you okay oh there it is okay",
    "start": "2447720",
    "end": "2453119"
  },
  {
    "text": "um yeah that was just a connection problem IP um was wrong I think um okay",
    "start": "2453119",
    "end": "2459440"
  },
  {
    "text": "so just a reminder we made the we made transactional ability over an original transaction we added 40 and a zero by",
    "start": "2459440",
    "end": "2466599"
  },
  {
    "text": "that's all okay so just look at the at the BD box this is the original transaction it's still pending they",
    "start": "2466599",
    "end": "2474040"
  },
  {
    "text": "don't see anything wrong here it's refresh still pending the original transaction of 30 mic ones are trying",
    "start": "2474040",
    "end": "2479280"
  },
  {
    "text": "are being uh transferred okay it's still pending nothing bad happen",
    "start": "2479280",
    "end": "2484920"
  },
  {
    "text": "so let's go and do some mining so the mutated transaction will",
    "start": "2484920",
    "end": "2491280"
  },
  {
    "text": "get confirmed any transactions will get confirmed any anything that uh is",
    "start": "2491280",
    "end": "2497280"
  },
  {
    "text": "included in in the certain block that will be solded all the pending transactions that this guy want to",
    "start": "2497280",
    "end": "2502400"
  },
  {
    "text": "wanted to give you so um let's wait for the confirmation and this is this is the",
    "start": "2502400",
    "end": "2507760"
  },
  {
    "text": "part when we cannot control like when you're doing mining you just brute force and you hope that you hit a certain",
    "start": "2507760",
    "end": "2514520"
  },
  {
    "text": "Target okay so we got a first confirmation that was pretty cool quick and uh we're BD box needs to wait for",
    "start": "2514520",
    "end": "2521119"
  },
  {
    "text": "for two confirmations so uh all we need to to do now is wait for the second",
    "start": "2521119",
    "end": "2526440"
  },
  {
    "text": "confirmation and see what happens all right so there's the second",
    "start": "2526440",
    "end": "2532359"
  },
  {
    "text": "confirmation okay let's see okay we have 30 m points yeah we have 30 m points so well",
    "start": "2532720",
    "end": "2542400"
  },
  {
    "text": "this is this is what we we plan to do right we withraw 30 so nothing wrong here right I don't know why you're",
    "start": "2542400",
    "end": "2547480"
  },
  {
    "text": "clapping I'm not sure but but yeah um so but but but look at what happens if we",
    "start": "2547480",
    "end": "2553119"
  },
  {
    "text": "hit refresh there let's see what happens with the original transaction okay oh now oh you see it",
    "start": "2553119",
    "end": "2561240"
  },
  {
    "text": "failed so they think it failed they track transaction ID and they think the transaction failed but we actually got",
    "start": "2561240",
    "end": "2567680"
  },
  {
    "text": "the coins already so look at what what they will do they will say okay the poor customer",
    "start": "2567680",
    "end": "2574040"
  },
  {
    "text": "didn't receive his coins they it failed because of the transaction ID so they will regenerate a",
    "start": "2574040",
    "end": "2581400"
  },
  {
    "text": "new transaction with 30 more Bitcoins H more m coins",
    "start": "2581400",
    "end": "2586800"
  },
  {
    "text": "sorry just hit another refresh and voila we have it we have",
    "start": "2586800",
    "end": "2595079"
  },
  {
    "text": "another pending transaction from BD box uh targeted to our wallet so there's",
    "start": "2595079",
    "end": "2602920"
  },
  {
    "text": "another 30 and now we have to wait for for m siging to so that this this transaction",
    "start": "2602920",
    "end": "2609880"
  },
  {
    "text": "will also get confirmed but you know what will happen then next we will have 60 my coins even though we only had 30",
    "start": "2609880",
    "end": "2618839"
  },
  {
    "text": "in their wallet we managed to steal an extra 30 don't don't try to this at the",
    "start": "2618839",
    "end": "2625040"
  },
  {
    "text": "casino any tricks like that will be very bad will end very bad for you because there's a serious security guys not that",
    "start": "2625040",
    "end": "2631800"
  },
  {
    "text": "I tried but you know so uh this this is",
    "start": "2631800",
    "end": "2637599"
  },
  {
    "text": "transaction M ability actually already happened we're actually just waiting for a normal",
    "start": "2637599",
    "end": "2643000"
  },
  {
    "text": "confirmation so uh you can see the 60 uh the 60 um microns in our wallet so we",
    "start": "2643000",
    "end": "2650920"
  },
  {
    "text": "have to to wait for the mining okay so that's pretty much it and",
    "start": "2650920",
    "end": "2657480"
  },
  {
    "text": "um you you ready with that may",
    "start": "2657480",
    "end": "2664480"
  },
  {
    "text": "depending this wait right here so we hope that the transa the the",
    "start": "2665640",
    "end": "2673240"
  },
  {
    "text": "mining was okay let's see and there it",
    "start": "2673240",
    "end": "2680920"
  },
  {
    "text": "is there that's it you see two different transactions one of them is failed",
    "start": "2683559",
    "end": "2689280"
  },
  {
    "text": "apparently from their point of view this is the transaction history in BD boxes that's that that represent what they see",
    "start": "2689280",
    "end": "2696160"
  },
  {
    "text": "but we have six okay we have 60 mcoins and you can see that there's zero available FS because",
    "start": "2696160",
    "end": "2702319"
  },
  {
    "text": "we use all the 30 that we had we didn't have 60 but we used all the coins that",
    "start": "2702319",
    "end": "2707440"
  },
  {
    "text": "we had and we actually stole 30 my coins from them for",
    "start": "2707440",
    "end": "2714440"
  },
  {
    "text": "them well this is was really cool yeah except for yeah okay um",
    "start": "2714480",
    "end": "2724000"
  },
  {
    "text": "so the transaction meability actually vulnerability has exist for like a long",
    "start": "2724000",
    "end": "2729079"
  },
  {
    "text": "time three years ago something like that and but only after the incident of empty",
    "start": "2729079",
    "end": "2734319"
  },
  {
    "text": "gos the Bitcoin developers decided to release a patch that fixed this vulnerability even though the real",
    "start": "2734319",
    "end": "2740920"
  },
  {
    "text": "problem as you can you you just saw uh are not related uh to the Bitcoin",
    "start": "2740920",
    "end": "2746280"
  },
  {
    "text": "protocol the Bitcoin protocol uh rather to the implementation so let's take a",
    "start": "2746280",
    "end": "2752400"
  },
  {
    "text": "look on the part of the code that fixed this vulnerability",
    "start": "2752400",
    "end": "2757318"
  },
  {
    "text": "okay uh the Bitcoin developers added a new function called E standard TX which",
    "start": "2765440",
    "end": "2771040"
  },
  {
    "text": "is basically verifies that transaction format is according to their standard it makes multiple verification",
    "start": "2771040",
    "end": "2779079"
  },
  {
    "text": "that uh part of it related to the transaction meability",
    "start": "2779079",
    "end": "2784760"
  },
  {
    "text": "bless you uh um so if we'll take a look on the part of the code that handled the",
    "start": "2784760",
    "end": "2790760"
  },
  {
    "text": "transaction relability we can see that from now on every peer need to check whether at the push data up code is",
    "start": "2790760",
    "end": "2798359"
  },
  {
    "text": "included in the transaction that was not necessary and if it does he drops the",
    "start": "2798359",
    "end": "2804880"
  },
  {
    "text": "transaction if you look closely on the second if condition with the push data",
    "start": "2804880",
    "end": "2810000"
  },
  {
    "text": "two we can see it checks whether the push data two is included in the transaction and if it does it also",
    "start": "2810000",
    "end": "2816000"
  },
  {
    "text": "checks whether uh the length of the script Sig is lower than douf and if it",
    "start": "2816000",
    "end": "2823079"
  },
  {
    "text": "does it marks the transaction as invalid well it's a good thing that they remembered right because people use this",
    "start": "2823079",
    "end": "2830920"
  },
  {
    "text": "attack to steal millions of dollars and then then remember okay we need to do something and they only fixed one",
    "start": "2830920",
    "end": "2836040"
  },
  {
    "text": "technique by the way this is just one technique so actually that's it everyone",
    "start": "2836040",
    "end": "2842359"
  },
  {
    "text": "we really happy that you came and we had a great time and you hope that you enjoyed as well uh we wrote a tool that",
    "start": "2842359",
    "end": "2850400"
  },
  {
    "text": "that doing and simulate the entire process of the Bitcoin transaction meability you are welcome to do it on",
    "start": "2850400",
    "end": "2856440"
  },
  {
    "text": "your own personal environment personal environment Bitcoin Network and that's",
    "start": "2856440",
    "end": "2863119"
  },
  {
    "text": "it here's our our emails we are going to be around the conference probably at the",
    "start": "2863119",
    "end": "2869040"
  },
  {
    "text": "casino the roulette table something like that uh but you're welcome to contact us and we hope you enjoyed thank you thank",
    "start": "2869040",
    "end": "2876200"
  },
  {
    "text": "you very much yeah",
    "start": "2876200",
    "end": "2879880"
  }
]