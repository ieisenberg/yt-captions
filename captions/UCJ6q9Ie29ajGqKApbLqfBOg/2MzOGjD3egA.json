[
  {
    "start": "0",
    "end": "83000"
  },
  {
    "text": "the sound of knowledge [Music]",
    "start": "120",
    "end": "12429"
  },
  {
    "text": "Incorporated on uh Advance buffer overruns he uh he' coated up he' reverse",
    "start": "13360",
    "end": "18680"
  },
  {
    "text": "engineered and uh coded up a unique buffer overrun as an example of uh how",
    "start": "18680",
    "end": "23880"
  },
  {
    "text": "it's possible without having Source access to still find buffer overruns in",
    "start": "23880",
    "end": "29039"
  },
  {
    "text": "commented or uncom commented uh source code and while he's talking along he",
    "start": "29039",
    "end": "34480"
  },
  {
    "text": "kind of slips in a a brand new vulnerability that that people are talked about but it as far as I know uh",
    "start": "34480",
    "end": "40079"
  },
  {
    "text": "hasn't been published on bug track or even really written about and it was sort of this transition from ring 3 to",
    "start": "40079",
    "end": "46160"
  },
  {
    "text": "ring zero in Windows NT from user space into kernel space and uh which shouldn't",
    "start": "46160",
    "end": "52359"
  },
  {
    "text": "be able to happen it sort of breaks the whole NT model of security and then he just moved on and talked about some",
    "start": "52359",
    "end": "58399"
  },
  {
    "text": "other stuff and so we said well why don't you come back and and talk maybe about this a little bit more in depth",
    "start": "58399",
    "end": "63800"
  },
  {
    "text": "and and talk about uh finding these overflows so Joey's come over uh to hang",
    "start": "63800",
    "end": "69560"
  },
  {
    "text": "out in Vegas for the week and give you this presentation which has not been",
    "start": "69560",
    "end": "74840"
  },
  {
    "text": "heard uh before so let's welcome [Applause]",
    "start": "74840",
    "end": "82439"
  },
  {
    "text": "Joey all right thanks guys and um as uh theyve already introduced my",
    "start": "82439",
    "end": "88119"
  },
  {
    "start": "83000",
    "end": "142000"
  },
  {
    "text": "name is Joey and and um today I would like to um sort of like uh Carry On from",
    "start": "88119",
    "end": "95200"
  },
  {
    "text": "where I lived uh in Singapore and talk more about U",
    "start": "95200",
    "end": "100439"
  },
  {
    "text": "how we can take or what technologies that which would let us",
    "start": "100439",
    "end": "106360"
  },
  {
    "text": "take the exploits from userland into kernel mode and uh the main reason why I would",
    "start": "106360",
    "end": "113280"
  },
  {
    "text": "like to talk about that is that um I think everybody is familiar and everybody knows like how bad it is to",
    "start": "113280",
    "end": "118320"
  },
  {
    "text": "get owned but but uh it's not exactly appreciated how",
    "start": "118320",
    "end": "125280"
  },
  {
    "text": "badly you can get owned or like um to which level the impact can",
    "start": "125280",
    "end": "133280"
  },
  {
    "text": "be especially like um excuse",
    "start": "133280",
    "end": "138239"
  },
  {
    "text": "me especially um on the Windows n when you look at all the uh existing exploits",
    "start": "140840",
    "end": "147760"
  },
  {
    "text": "which are out there they are more or less along the lines of",
    "start": "147760",
    "end": "154319"
  },
  {
    "text": "U either running some program or spawning a command shell or doing",
    "start": "154319",
    "end": "160000"
  },
  {
    "text": "something which is U limited to a user mode process and uh today my focus would be",
    "start": "160000",
    "end": "166959"
  },
  {
    "text": "to take you through sort of like a an overview or chronology of how these",
    "start": "166959",
    "end": "174599"
  },
  {
    "text": "things came about and where we have gone and what information we have for the time being",
    "start": "174599",
    "end": "180480"
  },
  {
    "text": "and talk about how or what cool or uncool stuff is being done through",
    "start": "180480",
    "end": "187159"
  },
  {
    "text": "remote or local exploits in NT and 2K and uh talk about taking it to the next",
    "start": "187159",
    "end": "193400"
  },
  {
    "text": "level which is like to take it into ring zero and",
    "start": "193400",
    "end": "198440"
  },
  {
    "text": "actually own The Trusted Computing base itself and the reasons why we want why",
    "start": "198440",
    "end": "205360"
  },
  {
    "text": "we want people would do it and how possibly they can do it",
    "start": "205360",
    "end": "210519"
  },
  {
    "text": "and uh how we might want to prevent it or how we would want to respond to",
    "start": "210519",
    "end": "216599"
  },
  {
    "text": "it but this talk is not going to be about uh a super cool Silver Bullet",
    "start": "216599",
    "end": "222040"
  },
  {
    "text": "exploit that will like crack ENT that's not what it's all about it's about the impact of being",
    "start": "222040",
    "end": "231840"
  },
  {
    "text": "owned so um having said that uh let's carry on and um",
    "start": "231840",
    "end": "240200"
  },
  {
    "text": "well as the slide explains um we are looking at a situation where we assume",
    "start": "240200",
    "end": "246920"
  },
  {
    "text": "that an intruder has already gained administrative or higher level",
    "start": "246920",
    "end": "252319"
  },
  {
    "text": "privileges for example like system context or administrative privileges on your machine either through for example",
    "start": "252319",
    "end": "257400"
  },
  {
    "text": "like a remote buffer overflow or either to some kind of U misconfiguration in a",
    "start": "257400",
    "end": "263800"
  },
  {
    "text": "program or for example um this is one example I would like to give which hasn't been uh greatly looked at uh like",
    "start": "263800",
    "end": "272880"
  },
  {
    "text": "most Microsoft transaction server components if you really look at them they run in the system context and I",
    "start": "272880",
    "end": "279680"
  },
  {
    "text": "have come across couple of third party applications which have",
    "start": "279680",
    "end": "284720"
  },
  {
    "text": "configurable Comm objects which actually read the registry and um",
    "start": "284720",
    "end": "291440"
  },
  {
    "text": "instantiate other components for so for for example like a plug-in model where",
    "start": "291440",
    "end": "297520"
  },
  {
    "text": "other third party applications can actually come and reg register their interfaces and the main MTS component",
    "start": "297520",
    "end": "303039"
  },
  {
    "text": "will instantiate those interfaces with through their proper operation but the",
    "start": "303039",
    "end": "309240"
  },
  {
    "text": "thing is there is no authentication between the actual application providers",
    "start": "309240",
    "end": "314320"
  },
  {
    "text": "component architecture and the third party plugins so technically if anybody",
    "start": "314320",
    "end": "319840"
  },
  {
    "text": "can just register a plugin in the system these guys will run it run it",
    "start": "319840",
    "end": "324919"
  },
  {
    "text": "under the system context which which is what their components are running under so",
    "start": "324919",
    "end": "331479"
  },
  {
    "text": "so in that kind of situation um an attacker can Elevate their privileges",
    "start": "331880",
    "end": "338120"
  },
  {
    "text": "into the system context like really easily and",
    "start": "338120",
    "end": "343400"
  },
  {
    "text": "U that gives him a lot of potential because there are certain operating system features of Windows NT or 2000",
    "start": "343400",
    "end": "352520"
  },
  {
    "text": "which is not by default even given to the administrator but when you get to local",
    "start": "352520",
    "end": "358120"
  },
  {
    "text": "system context that is the security context of The Trusted Computing base you can technically do anything you",
    "start": "358120",
    "end": "363919"
  },
  {
    "text": "want to do and U it is scary how easily you can do",
    "start": "363919",
    "end": "369680"
  },
  {
    "text": "this so for example our playing field will be",
    "start": "369680",
    "end": "374720"
  },
  {
    "text": "a an environment where a system has already been infiltrated and the",
    "start": "374720",
    "end": "381120"
  },
  {
    "text": "Intruder has the ability to run malicious code on the system either at and either at the security context of",
    "start": "381120",
    "end": "387680"
  },
  {
    "text": "the administrator or local system well I mean um when you it's not",
    "start": "387680",
    "end": "395720"
  },
  {
    "text": "as difficult to get uh local system",
    "start": "395720",
    "end": "400919"
  },
  {
    "text": "security context from the administrator itself because I mean it can it can be very simple it can be just as simple as",
    "start": "400919",
    "end": "406000"
  },
  {
    "text": "uh getting your malicious code and uh scheduling it through the at service to",
    "start": "406000",
    "end": "411840"
  },
  {
    "text": "run at a specific time and it'll run is run as a local system",
    "start": "411840",
    "end": "418400"
  },
  {
    "text": "so the assumption is that you have elevated Privileges and you can run malicious",
    "start": "418400",
    "end": "423759"
  },
  {
    "text": "code in that system at that elevated [Music]",
    "start": "423759",
    "end": "431429"
  },
  {
    "text": "privilege okay um as security researchers systems administrators or anyone who really um",
    "start": "434280",
    "end": "443520"
  },
  {
    "start": "435000",
    "end": "758000"
  },
  {
    "text": "does give a damn about their systems this is what we're trying to achieve",
    "start": "443520",
    "end": "448680"
  },
  {
    "text": "here um first we need to understand U the",
    "start": "448680",
    "end": "453720"
  },
  {
    "text": "nature of security vulnerabilities that would allow arbitary code execution now",
    "start": "453720",
    "end": "459360"
  },
  {
    "text": "I mean I can remember back in even",
    "start": "459360",
    "end": "464520"
  },
  {
    "text": "as even in '98 I can remember people saying like oh buff over flows that doesn't happen in N that doesn't happen",
    "start": "464520",
    "end": "469879"
  },
  {
    "text": "in 2K and these are like the people who were responsible for major server application",
    "start": "469879",
    "end": "475159"
  },
  {
    "text": "development and uh even today today with a lot of",
    "start": "475159",
    "end": "482159"
  },
  {
    "text": "awareness still some people don't realize that um buff overflows and",
    "start": "482159",
    "end": "487919"
  },
  {
    "text": "format string exploits and things like that are actually possible under NTN 2K so our first task is to actually",
    "start": "487919",
    "end": "496120"
  },
  {
    "text": "understand how or understand the fact that we can",
    "start": "496120",
    "end": "503199"
  },
  {
    "text": "have exploits which can very easily execute malicious code under Windows NT and 2000 systems but I mean today for",
    "start": "503199",
    "end": "510479"
  },
  {
    "text": "the most part through the hard work and pain of a lot of people and a lot of good research people do realize that for",
    "start": "510479",
    "end": "517320"
  },
  {
    "text": "the most part but uh the second step is to actually",
    "start": "517320",
    "end": "525320"
  },
  {
    "text": "understand what technologies uh person with malicious",
    "start": "525320",
    "end": "531360"
  },
  {
    "text": "intent can use once he has the ability to actually either remotely or locally execute malicious code at elevated",
    "start": "531360",
    "end": "538200"
  },
  {
    "text": "privileges now understanding technology is very important because U if we are to",
    "start": "538200",
    "end": "545480"
  },
  {
    "text": "address the impact on the system which is or rather the potential impact on the",
    "start": "545480",
    "end": "550800"
  },
  {
    "text": "system through these exploits we have to understand what technologies or what",
    "start": "550800",
    "end": "556160"
  },
  {
    "text": "class of Technologies are at the disposal of the attacker and what he can",
    "start": "556160",
    "end": "562040"
  },
  {
    "text": "use so it is very important that we understand these Technologies so that we",
    "start": "562040",
    "end": "568880"
  },
  {
    "text": "can and have a clearer idea of what they can potentially do and",
    "start": "568880",
    "end": "576240"
  },
  {
    "text": "U there are certain products out there and there are certain products that are actually coming up which take a broad",
    "start": "576240",
    "end": "582640"
  },
  {
    "text": "look at these Technologies and try to think of innovative ways",
    "start": "582640",
    "end": "589120"
  },
  {
    "text": "to attack or prevent the use of these Technologies under a specific set of circumstances",
    "start": "589320",
    "end": "596000"
  },
  {
    "text": "that might be used in this kind of exploit situation and",
    "start": "596000",
    "end": "602880"
  },
  {
    "text": "um of course after that I mean once we know what technologies these guys can use the next step is to actually go on",
    "start": "602880",
    "end": "609240"
  },
  {
    "text": "and see um what can be actually achieved through",
    "start": "609240",
    "end": "614440"
  },
  {
    "text": "these through the use of these Technologies",
    "start": "614440",
    "end": "619279"
  },
  {
    "text": "now we understand that uh from programming perspective that almost",
    "start": "619600",
    "end": "625120"
  },
  {
    "text": "anything can be done on any system provided that you have enough security es and the technology to do that but in",
    "start": "625120",
    "end": "634480"
  },
  {
    "text": "a exploit scenario where there's a lot of restrictions and a lot",
    "start": "634480",
    "end": "641600"
  },
  {
    "text": "of like Unwritten rules that you have to live by or abide",
    "start": "641600",
    "end": "646800"
  },
  {
    "text": "by the full potential of these Technologies cannot be utilized to their full capacity",
    "start": "646800",
    "end": "655240"
  },
  {
    "text": "because I mean you had to work within certain limitations not like writing a standard user mod Kel mode application",
    "start": "655240",
    "end": "661800"
  },
  {
    "text": "so in uh in understanding and responding to these threats we need to understand",
    "start": "661800",
    "end": "667440"
  },
  {
    "text": "using these Technologies what exactly they can do and what exactly they can't",
    "start": "667440",
    "end": "672920"
  },
  {
    "text": "do now in a user mode environment where like a lot of exploits do actually",
    "start": "672920",
    "end": "678279"
  },
  {
    "text": "operate in right now the impact is",
    "start": "678279",
    "end": "683880"
  },
  {
    "text": "somewhat well I wouldn't say minimal but it's it's somewhat manageable either through better",
    "start": "683880",
    "end": "689839"
  },
  {
    "text": "awareness or better monitoring of your systems or through specialized software it is better manageable than uh in",
    "start": "689839",
    "end": "697440"
  },
  {
    "text": "situations which I would discuss",
    "start": "697440",
    "end": "701519"
  },
  {
    "text": "[Music]",
    "start": "702880",
    "end": "705940"
  },
  {
    "text": "later excuse me and uh once we understand all this",
    "start": "709519",
    "end": "716240"
  },
  {
    "text": "and once we realize how much of threat this actually is I think our goal here is",
    "start": "716240",
    "end": "725200"
  },
  {
    "text": "to make sure that we can respond properly to a threat of this",
    "start": "725200",
    "end": "731880"
  },
  {
    "text": "kind and U as software venders and researchers we can go out and U explore",
    "start": "731880",
    "end": "739760"
  },
  {
    "text": "new technologies that would make this kind of attacks more difficult or well I",
    "start": "739760",
    "end": "746240"
  },
  {
    "text": "wouldn't say impossible but uh more difficult actually sort of like raise the bar higher than where it is right",
    "start": "746240",
    "end": "753480"
  },
  {
    "start": "758000",
    "end": "919000"
  },
  {
    "text": "now for example these malicious code execution scenarios I would like to take a win3 to",
    "start": "758279",
    "end": "764600"
  },
  {
    "text": "buff overflow which is like the one of the simplest most widely known and one of the most straightforward ways of",
    "start": "764600",
    "end": "771279"
  },
  {
    "text": "getting malicious score to execute in elevator Privileges and um just to give a",
    "start": "771279",
    "end": "777279"
  },
  {
    "text": "background and uh for further education I would like to point out some resources",
    "start": "777279",
    "end": "783600"
  },
  {
    "text": "which are out there uh first I would like to point out uh a F's excellent article in Frack",
    "start": "783600",
    "end": "790000"
  },
  {
    "text": "about uh what it was titled smashing the stack for Fun and",
    "start": "790000",
    "end": "796079"
  },
  {
    "text": "Profit I think it was one of the pioneering articles if I'm not",
    "start": "796079",
    "end": "801560"
  },
  {
    "text": "mistaken and then um afterwards I think uh this was like lf1 article was pretty",
    "start": "801560",
    "end": "808440"
  },
  {
    "text": "much generous break and um after that I think solar designer did a lot of work",
    "start": "808440",
    "end": "815760"
  },
  {
    "text": "on win32 exploits and overflows and I think he published a few of them but to",
    "start": "815760",
    "end": "822920"
  },
  {
    "text": "my knowledge it hasn't been like uh widely publicized or at least not many",
    "start": "822920",
    "end": "829000"
  },
  {
    "text": "people have seen it but if I can remember right it was U he published a CGI overflow which which would actually",
    "start": "829000",
    "end": "837160"
  },
  {
    "text": "um download a file and execute it so as far as I can remember that was",
    "start": "837160",
    "end": "842959"
  },
  {
    "text": "one of the very first work and that should be available on uset so if you search for a solar designer and buff",
    "start": "842959",
    "end": "850519"
  },
  {
    "text": "overflow you'll probably come across it and U then there was dild doogs text",
    "start": "850519",
    "end": "856839"
  },
  {
    "text": "which was called the tire of Windows buff overflow and I think it was more of a",
    "start": "856839",
    "end": "865639"
  },
  {
    "text": "heap overflow which I can't remember but uh it was very good reading text as well and then barab published his",
    "start": "865639",
    "end": "873000"
  },
  {
    "text": "inspirational article on Frack about U how to reverse engineer and write an actual exploit sort of like uh putting",
    "start": "873000",
    "end": "880399"
  },
  {
    "text": "everything together so like you take an application you reverse engineer it this is how you find the holes and this is",
    "start": "880399",
    "end": "886160"
  },
  {
    "text": "how you exploit it and Greg hogland has been doing a great",
    "start": "886160",
    "end": "891199"
  },
  {
    "text": "job talking about the Technologies behind uh actually exploiting buff",
    "start": "891199",
    "end": "897519"
  },
  {
    "text": "overflow vulnerabilities and and um I think most of you might have been present at his talk yesterday and he did",
    "start": "897519",
    "end": "903959"
  },
  {
    "text": "a great talk in Singapore as well and then um I did a piece on Buff overflows in Singapore as well and uh",
    "start": "903959",
    "end": "911320"
  },
  {
    "text": "the presentation should be available",
    "start": "911320",
    "end": "914680"
  },
  {
    "text": "online so um first let's take a look at um basically the payload that has been",
    "start": "918360",
    "end": "925639"
  },
  {
    "start": "919000",
    "end": "1041000"
  },
  {
    "text": "delivered so far through win32 exploits",
    "start": "925639",
    "end": "930600"
  },
  {
    "text": "like initially um the first one was I think um I saw it in solar designers",
    "start": "931519",
    "end": "938480"
  },
  {
    "text": "work if I remember right what it did was it U exploited a",
    "start": "938480",
    "end": "945199"
  },
  {
    "text": "CGI executable and it let you upload a file into the script directory and then",
    "start": "945199",
    "end": "952360"
  },
  {
    "text": "executed VI HTTP so the sole purpose of the exploit was to actually let a",
    "start": "952360",
    "end": "957600"
  },
  {
    "text": "file get a file to be uploaded and write it to the file system and uh you would",
    "start": "957600",
    "end": "962839"
  },
  {
    "text": "just do an HTTP query and since it is in a executable directory which has",
    "start": "962839",
    "end": "968199"
  },
  {
    "text": "executable permissions you can execute it through the web so that actual",
    "start": "968199",
    "end": "973839"
  },
  {
    "text": "executable can contain any of your secondary payload for example like whatever you want to do",
    "start": "973839",
    "end": "980160"
  },
  {
    "text": "like even troen the system or whatever and uh then there was a kind of",
    "start": "980160",
    "end": "985959"
  },
  {
    "text": "interesting and unique exploit which was um written a while back again",
    "start": "985959",
    "end": "991000"
  },
  {
    "text": "which actually enabled the disabled guest account and changed it password and added it to the administrative group",
    "start": "991000",
    "end": "997800"
  },
  {
    "text": "all through remote exploit and then of course we saw",
    "start": "997800",
    "end": "1003319"
  },
  {
    "text": "uh code that would actually download a Tran executable and actually execute it",
    "start": "1003319",
    "end": "1009120"
  },
  {
    "text": "through the exploit itself and uh there have a code which would actually download netcat and bind",
    "start": "1009120",
    "end": "1016160"
  },
  {
    "text": "it to a port so you can actually have a command shell and U then we moved on and uh I think bab",
    "start": "1016160",
    "end": "1025038"
  },
  {
    "text": "Jack showed some excellent code in his Frack article where he would actually um",
    "start": "1025039",
    "end": "1030600"
  },
  {
    "text": "without downloading anything he would actually spawn command cmd.exe and bind a command shell to a TCP",
    "start": "1030600",
    "end": "1037640"
  },
  {
    "text": "port and um after that of course uh",
    "start": "1040839",
    "end": "1045918"
  },
  {
    "start": "1041000",
    "end": "1243000"
  },
  {
    "text": "there was the reverse command shell now I would like to take a few minutes and",
    "start": "1045919",
    "end": "1051840"
  },
  {
    "text": "actually um look at this reverse command shell a little bit deeper because uh",
    "start": "1051840",
    "end": "1057240"
  },
  {
    "text": "personally I think it's not been appreciated much it has been around but",
    "start": "1057240",
    "end": "1063240"
  },
  {
    "text": "U the advantages of it has not been really realized so to speak",
    "start": "1063240",
    "end": "1070240"
  },
  {
    "text": "now in a situation where you have firewalls or route access control is",
    "start": "1070240",
    "end": "1076440"
  },
  {
    "text": "protecting certain entities within your",
    "start": "1076440",
    "end": "1081840"
  },
  {
    "text": "network lot of buff overflow vulnerabilities and exploits which are remote which would actually let give the",
    "start": "1081840",
    "end": "1088360"
  },
  {
    "text": "attacker a chance to further exploit would um for the most",
    "start": "1088360",
    "end": "1095720"
  },
  {
    "text": "part I mean would fail because for example if like in the previous what I",
    "start": "1095720",
    "end": "1101760"
  },
  {
    "text": "previously went through for example if uh they use payload which would actually",
    "start": "1101760",
    "end": "1108480"
  },
  {
    "text": "enable the guest account and add it to the administrative group if your firewall doesn't allow any net bias",
    "start": "1108480",
    "end": "1114919"
  },
  {
    "text": "traffic it wouldn't do any good or even if U all incoming connections are",
    "start": "1114919",
    "end": "1121200"
  },
  {
    "text": "restricted except for certain Services certain legitimate Services which are running on the host even binding",
    "start": "1121200",
    "end": "1127720"
  },
  {
    "text": "or port and actually sporting a command shell once somebody connects wouldn't work at all because nobody would be able",
    "start": "1127720",
    "end": "1133919"
  },
  {
    "text": "to connect through the firewall of the router now the interesting thing about the reverse shell is that it actually",
    "start": "1133919",
    "end": "1139760"
  },
  {
    "text": "lets the attacker to get the host to connect back to the attacker's",
    "start": "1139760",
    "end": "1144960"
  },
  {
    "text": "machine so in most situations what I have seen in the Enterprise is that um",
    "start": "1144960",
    "end": "1150919"
  },
  {
    "text": "incoming connections are restricted to these hosts based on whatever the ports they which are running legitimate services but uh for the most part",
    "start": "1150919",
    "end": "1158039"
  },
  {
    "text": "outgoing connections are unsanctioned so in this kind of scenario",
    "start": "1158039",
    "end": "1163440"
  },
  {
    "text": "a reverse command shell is very very very advantageous because it would just let the it would just make the attack",
    "start": "1163440",
    "end": "1168559"
  },
  {
    "text": "like listen on one of his ports and once exploit Cod is run it'll come and connect back to him and give him command",
    "start": "1168559",
    "end": "1175240"
  },
  {
    "text": "Shell through that he can continue whatever he wants to",
    "start": "1175240",
    "end": "1180520"
  },
  {
    "text": "continue and uh most network based and host based intrution detection systems",
    "start": "1180520",
    "end": "1187280"
  },
  {
    "text": "only think about incoming connections like um most intrustion detection systems which are hor based has rules",
    "start": "1187280",
    "end": "1193960"
  },
  {
    "text": "like which say Okay allow only 10 10 tet connections for this h for this session",
    "start": "1193960",
    "end": "1200039"
  },
  {
    "text": "or only one tailet connection through this application or whatever so there's a lot",
    "start": "1200039",
    "end": "1208360"
  },
  {
    "text": "of focus on incoming traffic but for ex but for outgoing traffic it is",
    "start": "1208360",
    "end": "1213480"
  },
  {
    "text": "unsanctioned for the most part and most in detection systems are not even",
    "start": "1213480",
    "end": "1218600"
  },
  {
    "text": "concerned about uh basically the outgoing traffic because it's monitoring only incoming",
    "start": "1218600",
    "end": "1224200"
  },
  {
    "text": "traffic for suspicious activities anomalies non exploits and things like that so even in that",
    "start": "1224200",
    "end": "1231280"
  },
  {
    "text": "sense the reverse command shell is advantageous because the host is actually going out and connecting",
    "start": "1231280",
    "end": "1237240"
  },
  {
    "text": "outside and the the other thing is that um the actual initial attack process and",
    "start": "1242640",
    "end": "1251600"
  },
  {
    "start": "1243000",
    "end": "1383000"
  },
  {
    "text": "U subsequent exploits which is which are conducted through",
    "start": "1251600",
    "end": "1259200"
  },
  {
    "text": "the exploitation is sort of decoupled so",
    "start": "1259200",
    "end": "1264240"
  },
  {
    "text": "that you don't have to actually do it from the same machine so the initial exploitation process can be sort of",
    "start": "1264240",
    "end": "1271720"
  },
  {
    "text": "indirectly performed if necessary like for an example if",
    "start": "1271720",
    "end": "1277720"
  },
  {
    "text": "uh if I do not have access to a server",
    "start": "1277760",
    "end": "1283120"
  },
  {
    "text": "through a firewall and then I mean there's nothing I can do because I can't connect and",
    "start": "1283120",
    "end": "1288279"
  },
  {
    "text": "exploit the service at all but imagine situation where there's a malicious attacker and there's this host which the",
    "start": "1288279",
    "end": "1295600"
  },
  {
    "text": "malicious attacker can't reach but there is another machine on that Network which",
    "start": "1295600",
    "end": "1301520"
  },
  {
    "text": "can actually access that service and that machine is used for something like checking mail so for example someone can",
    "start": "1301520",
    "end": "1307440"
  },
  {
    "text": "use an exploit in the Outlook send the mail Outlook gets exploited boom and that will actually mount an attack",
    "start": "1307440",
    "end": "1315279"
  },
  {
    "text": "against the host because he can access it and then the host will will connect back to the Hacker's machine and say hey we done",
    "start": "1315279",
    "end": "1322200"
  },
  {
    "text": "so you can since the initial attack process and the subsequent exploitation is actually",
    "start": "1322200",
    "end": "1328640"
  },
  {
    "text": "decoupled people can have",
    "start": "1328640",
    "end": "1333760"
  },
  {
    "text": "indirect techniques to actually perform the initial exploitation and after that",
    "start": "1333760",
    "end": "1339520"
  },
  {
    "text": "since the host is coming connecting back to you you know that it's been exploited and you can go ahead and do whatever the",
    "start": "1339520",
    "end": "1345360"
  },
  {
    "text": "malicious intent that they have in mind so the reverse command is quite powerful",
    "start": "1345360",
    "end": "1352880"
  },
  {
    "text": "in that sense and U so we need to understand this and we have to wherever",
    "start": "1352880",
    "end": "1362720"
  },
  {
    "text": "possible have some kind of emphasis in the outgoing connections as well as the",
    "start": "1362720",
    "end": "1368960"
  },
  {
    "text": "incoming traffic connections because in this kind of scenario whatever the sanctions or whatever the",
    "start": "1368960",
    "end": "1375360"
  },
  {
    "text": "monitoring performed on incoming traffic wouldn't make much sense",
    "start": "1375360",
    "end": "1379960"
  },
  {
    "start": "1383000",
    "end": "1652000"
  },
  {
    "text": "and then of course uh there's always a situation in buff overflow vulnerability is that U you are limited to a certain",
    "start": "1383520",
    "end": "1389840"
  },
  {
    "text": "size restriction of malicious code that you can execute so whatever you do has to be",
    "start": "1389840",
    "end": "1398679"
  },
  {
    "text": "done in a certain way that the code is not too large I mean there's nothing much you can do I guess that's uh that",
    "start": "1398679",
    "end": "1405039"
  },
  {
    "text": "was one of the main reasons why the spawning of a command shell was actually being pursued at the time",
    "start": "1405039",
    "end": "1412159"
  },
  {
    "text": "because from an initial exploit there there was nothing much you can do I mean maybe download a file execute something",
    "start": "1412159",
    "end": "1417679"
  },
  {
    "text": "but to have further control and to continue the further exploitation it was",
    "start": "1417679",
    "end": "1423200"
  },
  {
    "text": "necessary that you do something else which would give you control and which",
    "start": "1423200",
    "end": "1428360"
  },
  {
    "text": "would let you maintain the control so the command sh the command",
    "start": "1428360",
    "end": "1434640"
  },
  {
    "text": "shelf ping process would actually give you that",
    "start": "1434640",
    "end": "1439880"
  },
  {
    "text": "now the problem with commercial sporing process as far as the exploit I have seen so far is that uh if you rename",
    "start": "1440120",
    "end": "1446200"
  },
  {
    "text": "your command interpreter most of these exploits will be broken so the attack would actually have",
    "start": "1446200",
    "end": "1452440"
  },
  {
    "text": "to Brute Force the new name of your command shell command shell executable as well and since to actually perform",
    "start": "1452440",
    "end": "1459880"
  },
  {
    "text": "the functionality of a command shell requires a significant amount of code it is not likely that in most cases that",
    "start": "1459880",
    "end": "1466279"
  },
  {
    "text": "all that functionality will be coded into the exploit itself but well I mean needless to say",
    "start": "1466279",
    "end": "1472720"
  },
  {
    "text": "that there will be a new way of exploits to actually address that situation as",
    "start": "1472720",
    "end": "1478720"
  },
  {
    "text": "well where the attacker can actually download the command shell from the attacker's machine and execute it there",
    "start": "1478720",
    "end": "1485520"
  },
  {
    "text": "so I mean it's not a solution but it will raise the bar against most the script kitties out there who are using",
    "start": "1485520",
    "end": "1491080"
  },
  {
    "text": "existing exploits to break into other machines because all these exploits for",
    "start": "1491080",
    "end": "1496440"
  },
  {
    "text": "the time being what I have seen spawn a command shell now this double payload what I'm",
    "start": "1496440",
    "end": "1503640"
  },
  {
    "text": "talking about here is actually a I think I think the double payload is wrong word because it can be multi-tier payload",
    "start": "1503640",
    "end": "1511159"
  },
  {
    "text": "what happens is that in the most ex restrictive situations you",
    "start": "1511159",
    "end": "1517279"
  },
  {
    "text": "write small Shell Code which would actually do nothing except fetch some",
    "start": "1517279",
    "end": "1525039"
  },
  {
    "text": "larger or more complicated and sophisticated Shell Code from wherever location and prepare an execution",
    "start": "1525039",
    "end": "1532039"
  },
  {
    "text": "environment for it within the current process or a different process address space and then fish the code and put it",
    "start": "1532039",
    "end": "1538360"
  },
  {
    "text": "there relocate it and execute it and the second tier code can be since you are",
    "start": "1538360",
    "end": "1544080"
  },
  {
    "text": "fishing it there won't be any restrictions as to the size or there won't be any restrictions as to what",
    "start": "1544080",
    "end": "1550480"
  },
  {
    "text": "kind of character it the code can comprise of and uh things like now in the strings or",
    "start": "1550480",
    "end": "1558039"
  },
  {
    "text": "whatever I those problems won't be there at all because you are fetching this code so what you have is that you address the situation with very",
    "start": "1558039",
    "end": "1565240"
  },
  {
    "text": "restrictive code which only does the simple task of allocating an ex",
    "start": "1565240",
    "end": "1570559"
  },
  {
    "text": "execution environment fetching the second of payload relocating it and",
    "start": "1570559",
    "end": "1577279"
  },
  {
    "text": "executing it from there so if you look at",
    "start": "1577279",
    "end": "1583200"
  },
  {
    "text": "it in a user mode perspective the potential of this technique is",
    "start": "1583200",
    "end": "1588919"
  },
  {
    "text": "quite High because you can virtually do anything and there are",
    "start": "1588919",
    "end": "1595440"
  },
  {
    "text": "public exploits which actually use this technique and uh the one exploit was",
    "start": "1595440",
    "end": "1602159"
  },
  {
    "text": "used in a situation where the initial exploitation was a 250 by buffer which",
    "start": "1602159",
    "end": "1607399"
  },
  {
    "text": "was fragmented as well so there's nothing much you could do with it but the second exploit code could be all the",
    "start": "1607399",
    "end": "1613880"
  },
  {
    "text": "way up to 64k and one once you have 64k of malicious code execute in there you can",
    "start": "1613880",
    "end": "1619960"
  },
  {
    "text": "pretty much do anything I mean you can mount even a third layer of attack where you can fish more complicated code and",
    "start": "1619960",
    "end": "1625679"
  },
  {
    "text": "execute it so this kind of cascading code which",
    "start": "1625679",
    "end": "1631600"
  },
  {
    "text": "actually after the initial exploitation which is performed with a very small",
    "start": "1631600",
    "end": "1636840"
  },
  {
    "text": "payload can be the power can be elevated to Great extents from a user mode",
    "start": "1636840",
    "end": "1642399"
  },
  {
    "text": "perspective at least for the time being",
    "start": "1642399",
    "end": "1649520"
  },
  {
    "start": "1652000",
    "end": "1882000"
  },
  {
    "text": "and uh then there is recycling payload which can be used in the most",
    "start": "1653240",
    "end": "1660559"
  },
  {
    "text": "restrictive environments now when I was expl",
    "start": "1660559",
    "end": "1665640"
  },
  {
    "text": "explaining the reverse Shell Code I was saying that since there is no since",
    "start": "1665640",
    "end": "1670880"
  },
  {
    "text": "there are no sanctions on outgoing traffic it is very feasible to use it now what if there was for example uh",
    "start": "1670880",
    "end": "1679360"
  },
  {
    "text": "sanctions on outgoing traffic as well say that I have a web server and I have configured my firewalls and roue access",
    "start": "1679360",
    "end": "1685200"
  },
  {
    "text": "list so then it can only take incoming TCP connections and that's it it can't",
    "start": "1685200",
    "end": "1691240"
  },
  {
    "text": "connect anywhere on its own or no other services can be reached through the firewall of the route access list so in",
    "start": "1691240",
    "end": "1698640"
  },
  {
    "text": "that kind of situation even reversal code won't work because it can't actually create a connection to the",
    "start": "1698640",
    "end": "1704679"
  },
  {
    "text": "outside so in that kind of situations what would you",
    "start": "1704679",
    "end": "1710279"
  },
  {
    "text": "do let's take a typical example of a web server or even a CGI",
    "start": "1710279",
    "end": "1719440"
  },
  {
    "text": "script when you take the web server you actually for example let's take I",
    "start": "1719440",
    "end": "1725760"
  },
  {
    "text": "IIs and IPI server extension in an isap API Ser extension when you first create",
    "start": "1725760",
    "end": "1734320"
  },
  {
    "text": "a connection and pass the request that ipdl gets control and the",
    "start": "1734320",
    "end": "1739360"
  },
  {
    "text": "socket is still kept open and the I dll is pass a socket handle if it needs to",
    "start": "1739360",
    "end": "1745159"
  },
  {
    "text": "do further network communication over that same handle so if I if someone was",
    "start": "1745159",
    "end": "1750200"
  },
  {
    "text": "to actually go out and exploit an isap dll all that person has to do is actually read the structure which is",
    "start": "1750200",
    "end": "1757080"
  },
  {
    "text": "passed to the isap DL by IIs and you can get a hold of function pointer table",
    "start": "1757080",
    "end": "1762640"
  },
  {
    "text": "which would let you actually read and write over the same network connection",
    "start": "1762640",
    "end": "1768840"
  },
  {
    "text": "and uh even if it's not an ipdl or it's a standard CGI and in most cases most",
    "start": "1768840",
    "end": "1776000"
  },
  {
    "text": "web servers don't terminate the the connection and without certain period of",
    "start": "1776000",
    "end": "1782320"
  },
  {
    "text": "time basically it leites till the script to timeout and after that only terminates the connection so once you",
    "start": "1782320",
    "end": "1788880"
  },
  {
    "text": "exploit that program you can scan in the web service memory or you can hard code in web",
    "start": "1788880",
    "end": "1795640"
  },
  {
    "text": "servers memory where the actual socket handle for this network communication resides and through your exploit you can",
    "start": "1795640",
    "end": "1801640"
  },
  {
    "text": "use the same network communication basically like the socket handle and you can do whatever the rest you want to do",
    "start": "1801640",
    "end": "1808760"
  },
  {
    "text": "through the exact same network communication Channel which has already been established in legitimate manner so the implications are that even",
    "start": "1808760",
    "end": "1815640"
  },
  {
    "text": "in the strictest environment where you can't have any outgoing connections since",
    "start": "1815640",
    "end": "1823080"
  },
  {
    "text": "you're using the established legitimate connection you can still perform whatever the task you have you can you",
    "start": "1823080",
    "end": "1829120"
  },
  {
    "text": "want to perform and uh coupled with that and the cascading",
    "start": "1829120",
    "end": "1837200"
  },
  {
    "text": "Shell Code techniques there's a lot of impact from",
    "start": "1837200",
    "end": "1842440"
  },
  {
    "text": "the network point of view because that kind of attack would be",
    "start": "1842440",
    "end": "1849120"
  },
  {
    "text": "extremely difficult or even impossible to stop from a network point of view and access list point of view and the",
    "start": "1849120",
    "end": "1855039"
  },
  {
    "text": "potential that it offers for larger andar larger code to be executed on the system in a systematic",
    "start": "1855039",
    "end": "1862279"
  },
  {
    "text": "way gives opens like a new door",
    "start": "1862279",
    "end": "1867399"
  },
  {
    "text": "to performing a lot of complicated functions which was unprecedented in",
    "start": "1867399",
    "end": "1873919"
  },
  {
    "text": "certain wi exploit exploitation situations because of the Shell Code",
    "start": "1873919",
    "end": "1879679"
  },
  {
    "text": "limitations now having looked at all these techniques one common thing all these",
    "start": "1879679",
    "end": "1886480"
  },
  {
    "start": "1882000",
    "end": "2014000"
  },
  {
    "text": "techniques have is that uh they exclusively deal with user mode",
    "start": "1886480",
    "end": "1892760"
  },
  {
    "text": "basically they perform whatever the functions they perform in the context of a user address space",
    "start": "1892760",
    "end": "1898360"
  },
  {
    "text": "application so since user address space application",
    "start": "1898360",
    "end": "1904880"
  },
  {
    "text": "is not powerful enough to have significant impact on the key",
    "start": "1904880",
    "end": "1911840"
  },
  {
    "text": "operating system functionality itself the products which are actually developed to either look for this kind",
    "start": "1911840",
    "end": "1919760"
  },
  {
    "text": "of inconsistencies or prevent this kind of inconsistencies they are very successful",
    "start": "1919760",
    "end": "1926799"
  },
  {
    "text": "in in both cases and in detection as well",
    "start": "1926799",
    "end": "1931919"
  },
  {
    "text": "because they the functions that are performed in user mode can be very",
    "start": "1931919",
    "end": "1937519"
  },
  {
    "text": "easily traced detected and acted upon I mean there are already products out there which does this sort of thing now",
    "start": "1937519",
    "end": "1945200"
  },
  {
    "text": "for example like cybercop monitor which is an intution detection system and which is host",
    "start": "1945200",
    "end": "1950279"
  },
  {
    "text": "based does this lot of this kind of monitoring like monitoring for suspicious",
    "start": "1950279",
    "end": "1955799"
  },
  {
    "text": "activity and um there's DP y of course which looks for like file system and system",
    "start": "1955799",
    "end": "1962399"
  },
  {
    "text": "inconsistencies and um I think JD Glazer did some excellent work in Windows n and",
    "start": "1963039",
    "end": "1968720"
  },
  {
    "text": "wind 2K forensics and U that URL should still contain most of the tools that he",
    "start": "1968720",
    "end": "1974600"
  },
  {
    "text": "has used using tools and Technologies like this it is very easy to detect",
    "start": "1974600",
    "end": "1982600"
  },
  {
    "text": "assess and manage and even contact this kind of user mode exploitation",
    "start": "1982600",
    "end": "1989000"
  },
  {
    "text": "processes because the other programs which the tools we use can work with the operating",
    "start": "1989000",
    "end": "1995279"
  },
  {
    "text": "system to detect this kind of activity and since the malicious code does not do anything against the operating system",
    "start": "1995279",
    "end": "2002639"
  },
  {
    "text": "functionality they are very easily detected in that sense I mean there stealthiness is very low",
    "start": "2002639",
    "end": "2011278"
  },
  {
    "start": "2014000",
    "end": "2224000"
  },
  {
    "text": "so the next wave of exploits we what we are probably going to see will have a",
    "start": "2014279",
    "end": "2019960"
  },
  {
    "text": "lot of things to do with the actual operating system and uh the situation is that",
    "start": "2019960",
    "end": "2026480"
  },
  {
    "text": "since most of these exploits already have enough privileges to actually go",
    "start": "2026480",
    "end": "2031559"
  },
  {
    "text": "and severely affect the operating system functionality it's just a matter of of",
    "start": "2031919",
    "end": "2037240"
  },
  {
    "text": "time before a new way of wave of wi 32 exploits are going to appear or rather I wouldn't say win32 exploits because that",
    "start": "2037240",
    "end": "2042840"
  },
  {
    "text": "would be wrong Windows NT and Windows 2000 exploits will appear which would go",
    "start": "2042840",
    "end": "2047919"
  },
  {
    "text": "out and either disable modify",
    "start": "2047919",
    "end": "2053800"
  },
  {
    "text": "or even for in some cases enhance the operating system functionality to suit the malicious",
    "start": "2053800",
    "end": "2060520"
  },
  {
    "text": "needs or malicious intent of the exploitation code",
    "start": "2060520",
    "end": "2065878"
  },
  {
    "text": "now if we look at why exactly an exploit or malicious code",
    "start": "2065879",
    "end": "2073320"
  },
  {
    "text": "would want to violate the trusted Computing base and violate the key operational",
    "start": "2073320",
    "end": "2078440"
  },
  {
    "text": "functionalities of the operating system itself well first of all it's about",
    "start": "2078440",
    "end": "2085800"
  },
  {
    "text": "Stealth it's about owning a system and living there not being detected",
    "start": "2085800",
    "end": "2092480"
  },
  {
    "text": "so to maintain the ownership of the own system it is necessary that you maintain",
    "start": "2092480",
    "end": "2098720"
  },
  {
    "text": "the maximum stealth in order to do that and in order",
    "start": "2098720",
    "end": "2103960"
  },
  {
    "text": "to work against the products which are already installed on the system or would be used by an administrator to detect",
    "start": "2103960",
    "end": "2110720"
  },
  {
    "text": "and attack this kind of um",
    "start": "2110720",
    "end": "2116839"
  },
  {
    "text": "Behavior one might want to actually go into the trusted Computing",
    "start": "2117079",
    "end": "2122200"
  },
  {
    "text": "base and let's look at a wider scenario where somebody exploits a system for",
    "start": "2122200",
    "end": "2128599"
  },
  {
    "text": "malicious information gathering purposes in that kind of situation",
    "start": "2128599",
    "end": "2133839"
  },
  {
    "text": "what the amount of information you can gather as a user mode process is a lot",
    "start": "2133839",
    "end": "2141560"
  },
  {
    "text": "but it's limited to a certain extent and if you're looking at like",
    "start": "2141560",
    "end": "2146640"
  },
  {
    "text": "some Advanced pying capability which is systemwide for example like U if",
    "start": "2146640",
    "end": "2155160"
  },
  {
    "text": "a if an intr wants to see analyze every single program",
    "start": "2155160",
    "end": "2161560"
  },
  {
    "text": "you're running and uh look for valuable information within those programs in a sort of generic",
    "start": "2161560",
    "end": "2168079"
  },
  {
    "text": "fashion it's very difficult to do from user mode program or for example if that person",
    "start": "2168079",
    "end": "2174160"
  },
  {
    "text": "wants to have advanced keyboard capturing functionality say for uh say to do it in",
    "start": "2174160",
    "end": "2180760"
  },
  {
    "text": "a fashion where it would be a lot more reliable and it would be undetectable say for example actually Pat the",
    "start": "2180760",
    "end": "2186760"
  },
  {
    "text": "keyboard driver and look at all the keyboard codes and every time a key is pressed you can see which threads",
    "start": "2186760",
    "end": "2192319"
  },
  {
    "text": "message CU these keys are going to and then you can check the win32 status of that application and possibly deduce",
    "start": "2192319",
    "end": "2198680"
  },
  {
    "text": "whether this is going to a for example a password box to do this kind of advanced",
    "start": "2198680",
    "end": "2205520"
  },
  {
    "text": "stuff a user mode program is most of the time insufficient so that is another",
    "start": "2205520",
    "end": "2211640"
  },
  {
    "text": "reason why malicious code which is running on",
    "start": "2211640",
    "end": "2216720"
  },
  {
    "text": "an exploited system would want to violate the trusted Computing",
    "start": "2216720",
    "end": "2221520"
  },
  {
    "start": "2224000",
    "end": "2554000"
  },
  {
    "text": "base and U the other one would be to",
    "start": "2224599",
    "end": "2231160"
  },
  {
    "text": "introduce subtle but malicious changes to the functionality of the operating system",
    "start": "2231160",
    "end": "2238319"
  },
  {
    "text": "say for example like if someone wants to corrupt the status of an existing",
    "start": "2238319",
    "end": "2244400"
  },
  {
    "text": "database over time to make sure that every sing record that is written to the database is corrupted in some form or",
    "start": "2244400",
    "end": "2251359"
  },
  {
    "text": "files written to the file system is corrupted in some form or maybe it is encrypted made a copy somewhere",
    "start": "2251359",
    "end": "2257800"
  },
  {
    "text": "else for every application to do that kind of subtle but powerful",
    "start": "2257800",
    "end": "2266079"
  },
  {
    "text": "changes to the overall functionality of a system regardless of which processes we are talking about",
    "start": "2266079",
    "end": "2272599"
  },
  {
    "text": "here an an exploit might want to actually get into the trusted Computing",
    "start": "2272599",
    "end": "2280359"
  },
  {
    "text": "base and the other one is that um if you look at from a host based point of view",
    "start": "2280440",
    "end": "2285800"
  },
  {
    "text": "I mean there are a lot of personal firewalls out there there are a lot of other applications which look for like",
    "start": "2285800",
    "end": "2292800"
  },
  {
    "text": "which applications are uh communicating or which ports and stuff like that so if",
    "start": "2292800",
    "end": "2298280"
  },
  {
    "text": "if actually user mode process opens a connection to the outside or",
    "start": "2298280",
    "end": "2303680"
  },
  {
    "text": "does some form of network interaction through user mode it'll be very easy to detect so what if that what if that",
    "start": "2303680",
    "end": "2312280"
  },
  {
    "text": "same thing can be done in a totally undetectable level from a host point of",
    "start": "2312280",
    "end": "2318000"
  },
  {
    "text": "view I mean of course one can argue that uh over the network you can look for",
    "start": "2318000",
    "end": "2323760"
  },
  {
    "text": "suspicious activity I mean that's just the way it is but from a host based point of",
    "start": "2323760",
    "end": "2329760"
  },
  {
    "text": "view like for example if I'm using a personal firewall and I have set a rule saying that only these programs can",
    "start": "2329760",
    "end": "2336079"
  },
  {
    "text": "communicate through these ports and to these addresses and if the attacker wants to bypass that just using the user",
    "start": "2336079",
    "end": "2344160"
  },
  {
    "text": "mode API won't work and if it is a well written TDI based personal",
    "start": "2344160",
    "end": "2351480"
  },
  {
    "text": "firewall doing direct TDI won't work either so a person might actually resort",
    "start": "2351480",
    "end": "2357880"
  },
  {
    "text": "to actually hooking the TCP I.C which is the wi n wi 2K TCP I stack and use the",
    "start": "2357880",
    "end": "2365079"
  },
  {
    "text": "internal routines there itself to implement your c network operation",
    "start": "2365079",
    "end": "2370800"
  },
  {
    "text": "channels like for example I have seen u a c Communication channel implemented to",
    "start": "2370800",
    "end": "2377119"
  },
  {
    "text": "ycmp on Windows 2000 what it does is it actually hooks a certain function which",
    "start": "2377119",
    "end": "2382720"
  },
  {
    "text": "gets called every time an icmp packet is reached the system receives an icmp packet and the actual packet contents",
    "start": "2382720",
    "end": "2389560"
  },
  {
    "text": "are like given to this function so if a malicious program was to actually hook this function and take a look at",
    "start": "2389560",
    "end": "2397400"
  },
  {
    "text": "the actual code or the actual commands or whatever is sent over the network with in that",
    "start": "2397400",
    "end": "2403520"
  },
  {
    "text": "icmp packet it can Implement its command Channel through that and discard",
    "start": "2403520",
    "end": "2408800"
  },
  {
    "text": "whatever the package which it's using and not let the operating system see whatever it's using",
    "start": "2408800",
    "end": "2416079"
  },
  {
    "text": "so the main idea here is that almost all the tools out there which",
    "start": "2416079",
    "end": "2422760"
  },
  {
    "text": "are supposed to prevent or make it more difficult for this kind",
    "start": "2422760",
    "end": "2430240"
  },
  {
    "text": "of exploitation is actually using the functionality of the operating system for its usage it is relying on the",
    "start": "2430240",
    "end": "2437680"
  },
  {
    "text": "operating system and is relying on the integrity and the trust it has placed on the operating system for its",
    "start": "2437680",
    "end": "2445319"
  },
  {
    "text": "functionality it's like they want to catch the bad guys but they still do trust the operating system and without",
    "start": "2445319",
    "end": "2451319"
  },
  {
    "text": "the operating system they can't catch the bad guys so what the bad guys want to do is actually go and change the",
    "start": "2451319",
    "end": "2457240"
  },
  {
    "text": "operating system so that operating system would either lie or destroy these",
    "start": "2457240",
    "end": "2462280"
  },
  {
    "text": "programs which are actually supposed to catch the bad guys",
    "start": "2462280",
    "end": "2468359"
  },
  {
    "text": "so from a security research point of view these protective applications",
    "start": "2468640",
    "end": "2475680"
  },
  {
    "text": "should and some are actually approaching this problem and uh trying to look into",
    "start": "2475680",
    "end": "2482280"
  },
  {
    "text": "ways how they can deal with this kind of manipulation with the operating system",
    "start": "2482280",
    "end": "2487640"
  },
  {
    "text": "it has already been demonstrated how things like trip wire can be very easily subverted through this kind of oping",
    "start": "2487640",
    "end": "2493319"
  },
  {
    "text": "system manipulation and uh like I was explaining I'm it's very simple to do",
    "start": "2493319",
    "end": "2500200"
  },
  {
    "text": "host at least in a host based situation undetectable Network traffic so I mean those are the reasons",
    "start": "2500200",
    "end": "2507040"
  },
  {
    "text": "why people will want to take the exploitation to the next level and take",
    "start": "2507040",
    "end": "2514480"
  },
  {
    "text": "it from user mode into the Rings zero kernel itself and it'll be very very hard to",
    "start": "2514480",
    "end": "2521480"
  },
  {
    "text": "detect and it'll be very very hard to actually count at gamst unless you",
    "start": "2521480",
    "end": "2529400"
  },
  {
    "text": "really understand what these Technologies are all about and how these things can be done the key here is to",
    "start": "2529400",
    "end": "2535079"
  },
  {
    "text": "understand what kind of Technologies would offer",
    "start": "2535079",
    "end": "2540839"
  },
  {
    "text": "these exploits to inject itself or become a part of the",
    "start": "2540839",
    "end": "2547559"
  },
  {
    "text": "trusted Computing base in order to violate",
    "start": "2547559",
    "end": "2551319"
  },
  {
    "text": "it now I would like to take as an example of what has been done already in this",
    "start": "2553720",
    "end": "2561800"
  },
  {
    "start": "2554000",
    "end": "2849000"
  },
  {
    "text": "area mostly the standard technique",
    "start": "2561800",
    "end": "2568720"
  },
  {
    "text": "for this kind of Kernel mode interaction is the use of a kernel mode",
    "start": "2568720",
    "end": "2575520"
  },
  {
    "text": "driver and for the most part this is the only technique people know about on how to",
    "start": "2575520",
    "end": "2584480"
  },
  {
    "text": "load code into the kernel now there has been a lot of work done in",
    "start": "2584480",
    "end": "2591119"
  },
  {
    "text": "this area as well as far as to using the as far as using the kernel mode driver",
    "start": "2591119",
    "end": "2597440"
  },
  {
    "text": "model and exploiting The Trusted Computing base to the point where it's very easily demonstratable that these",
    "start": "2597440",
    "end": "2602720"
  },
  {
    "text": "are the impacts of this kind of attacks so I think Greg did a great paper on",
    "start": "2602720",
    "end": "2610119"
  },
  {
    "text": "this in frack and uh in there he patched SC access check which is a kernel mode",
    "start": "2610119",
    "end": "2616319"
  },
  {
    "text": "function of the security reference Monitor and what it would what it did was like a two by patch and uh it gave",
    "start": "2616319",
    "end": "2625079"
  },
  {
    "text": "all access to all objects by everybody and and once the canel is violated like",
    "start": "2625079",
    "end": "2632240"
  },
  {
    "text": "that none of the access permissions on an N 2K system would matter at all so if you have like auditing on a file system",
    "start": "2632240",
    "end": "2640200"
  },
  {
    "text": "for denied access that won't get you anywhere because all access will be granted",
    "start": "2640200",
    "end": "2645520"
  },
  {
    "text": "regardless and how many people would actually look at the memory image of their kernel and see like has somebody",
    "start": "2645520",
    "end": "2651359"
  },
  {
    "text": "actually written to this that stuff doesn't happen in real world so",
    "start": "2651359",
    "end": "2657720"
  },
  {
    "text": "uh this is a threat we really need to address because I mean okay people now look at certain ports and say hey maybe",
    "start": "2657720",
    "end": "2666280"
  },
  {
    "text": "I'm trojanized but uh how many people actually look at their kernel I mean",
    "start": "2666280",
    "end": "2672800"
  },
  {
    "text": "how people actually now look at loading device drivers I mean okay",
    "start": "2672800",
    "end": "2678920"
  },
  {
    "text": "there is there is trusted device drivers and device driver signing and all that",
    "start": "2678920",
    "end": "2684559"
  },
  {
    "text": "so that U there is a like a",
    "start": "2684559",
    "end": "2690599"
  },
  {
    "text": "more slightly more secure way of like loading device drivers I mean administrator just wouldn't load any device driver anymore I hope as no at",
    "start": "2690599",
    "end": "2699200"
  },
  {
    "text": "least at least they will look for a signed device driver which is trusted",
    "start": "2699200",
    "end": "2704520"
  },
  {
    "text": "so we are getting somewhere but when it comes to actual kernel",
    "start": "2704520",
    "end": "2709680"
  },
  {
    "text": "exploitation um people just don't look at it and uh",
    "start": "2709680",
    "end": "2716400"
  },
  {
    "text": "I'm sure like uh most of the people who are involved in like computer forensics as well I don't know whether they",
    "start": "2716400",
    "end": "2722880"
  },
  {
    "text": "actually look at this stuff because now say for example trip wire if trip wire was to look at the",
    "start": "2722880",
    "end": "2730880"
  },
  {
    "text": "system's integrity and what if the O lies to tripy saying that hey the file system is",
    "start": "2730880",
    "end": "2736160"
  },
  {
    "text": "okay nobody touched it you're doing fine and tripy wouldn't like actually give",
    "start": "2736160",
    "end": "2741400"
  },
  {
    "text": "any alarm and I know that it has been done in salaris where they have I think uh job uh demonstrated how trip can be",
    "start": "2741400",
    "end": "2749440"
  },
  {
    "text": "subverted and this has been done in NTI as well but uh unfortunately it's not public",
    "start": "2749440",
    "end": "2754880"
  },
  {
    "text": "information so this has been done against a couple of other in detection systems as",
    "start": "2754880",
    "end": "2760720"
  },
  {
    "text": "well and so this stuff is definitely out there so we need to realize that this",
    "start": "2760720",
    "end": "2767839"
  },
  {
    "text": "stuff is out there and people do these things so we need to counteract against",
    "start": "2767839",
    "end": "2773480"
  },
  {
    "text": "it but the problem here is that it is a very challenging area it is a very",
    "start": "2773480",
    "end": "2781480"
  },
  {
    "text": "challenging task to address all these issues because",
    "start": "2781480",
    "end": "2787799"
  },
  {
    "text": "it's a new area for most and for most products which are",
    "start": "2787960",
    "end": "2793559"
  },
  {
    "text": "actually relying for this kind of functionality from the O itself it's a shift in Paradigm to actually say like",
    "start": "2793559",
    "end": "2800000"
  },
  {
    "text": "hey to help with the U to help with the O I want to do things my way and uh the",
    "start": "2800000",
    "end": "2805119"
  },
  {
    "text": "technical details involved in the process is also very difficult",
    "start": "2805119",
    "end": "2810240"
  },
  {
    "text": "and even from a software development point of view to manage that kind of a complex",
    "start": "2810240",
    "end": "2816760"
  },
  {
    "text": "application which does so many sort of non-standard or non-",
    "start": "2816760",
    "end": "2822400"
  },
  {
    "text": "Microsoft approved interactions with the operating system is a is a big task but in light",
    "start": "2822400",
    "end": "2830079"
  },
  {
    "text": "of all these exploits and before the new wave of public exploi are going to hit",
    "start": "2830079",
    "end": "2835480"
  },
  {
    "text": "us which are using these techniques it is absolutely necessary that we understand this the impact of",
    "start": "2835480",
    "end": "2842160"
  },
  {
    "text": "these things and uh try to address it now",
    "start": "2842160",
    "end": "2847720"
  },
  {
    "start": "2849000",
    "end": "3599000"
  },
  {
    "text": "the actual uh kernel mode injection techniques Beyond loading a kernel mode",
    "start": "2850480",
    "end": "2857760"
  },
  {
    "text": "driver I want to discuss these things but um the only thing is that this is",
    "start": "2858119",
    "end": "2864599"
  },
  {
    "text": "like extremely Technical and uh a lot of source code demonstrations would help",
    "start": "2864599",
    "end": "2871160"
  },
  {
    "text": "but unfortunately um most of the work which we have done in this area remain",
    "start": "2871160",
    "end": "2878880"
  },
  {
    "text": "proprietary so it is not exactly",
    "start": "2878880",
    "end": "2884319"
  },
  {
    "text": "easy to go out and demonstrate these techniques and explain these techniques because okay uh maybe not many people",
    "start": "2884319",
    "end": "2893359"
  },
  {
    "text": "are aware of this but um kernel mode driver is not I should actually mentioned this first but a kernel mode",
    "start": "2893359",
    "end": "2898839"
  },
  {
    "text": "driver is not the only way to inject code into ring zero in Windows NTI and",
    "start": "2898839",
    "end": "2904240"
  },
  {
    "text": "Windows 2000 and this has been a known fact for The Last 5 Years at at least",
    "start": "2904240",
    "end": "2910960"
  },
  {
    "text": "so monitoring against or protecting from kernel mode drivers is",
    "start": "2910960",
    "end": "2917000"
  },
  {
    "text": "not the end to these kind of problems and uh if you are bug track",
    "start": "2917000",
    "end": "2923160"
  },
  {
    "text": "readers I think uh there was a recent thread to which uh Greg hogland",
    "start": "2923160",
    "end": "2929119"
  },
  {
    "text": "contributed quite a lot about U The Never Ending chess game when it comes to",
    "start": "2929119",
    "end": "2936000"
  },
  {
    "text": "this area so as far as actual Technologies I would like I would like to point out",
    "start": "2936000",
    "end": "2943319"
  },
  {
    "text": "three one is a kernel mode buff overflow I've seen enough third party",
    "start": "2943319",
    "end": "2948799"
  },
  {
    "text": "applications which has their kernel mode components which are vulnerable to buff overflows and uh for the most part for",
    "start": "2948799",
    "end": "2955920"
  },
  {
    "text": "the time being for the most part these vulnerabilities are not really exploited because uh the main",
    "start": "2955920",
    "end": "2963079"
  },
  {
    "text": "reason is that v32 overflow Tech technology won't work in ring zero",
    "start": "2963079",
    "end": "2969240"
  },
  {
    "text": "so at for the most part what it amount is a local denial of service when you're",
    "start": "2969240",
    "end": "2974319"
  },
  {
    "text": "the administrator so how difficult is that so",
    "start": "2974319",
    "end": "2980318"
  },
  {
    "text": "um I would like to actually go over that technology as",
    "start": "2981280",
    "end": "2986760"
  },
  {
    "text": "well now the difficulty there is actually explaining these Concepts and",
    "start": "2987160",
    "end": "2994200"
  },
  {
    "text": "Technologies in know uh in a fashion where I can actually explain it at a",
    "start": "2994200",
    "end": "3000240"
  },
  {
    "text": "talk without using much code or demonstration programs so maybe I'll try that when I",
    "start": "3000240",
    "end": "3007880"
  },
  {
    "text": "move on to the Deep knowledge track or maybe we should U have a technical",
    "start": "3007880",
    "end": "3013799"
  },
  {
    "text": "breakout session where I would uh answer take questions and answer questions for anybody who's",
    "start": "3013799",
    "end": "3019559"
  },
  {
    "text": "interested in this area but as I was saying earlier I would point out the three techniques or other",
    "start": "3019559",
    "end": "3026559"
  },
  {
    "text": "some of the tech techniques out there which can be used to load malicious code into kernel mode without actually using",
    "start": "3026559",
    "end": "3032960"
  },
  {
    "text": "device drivers like I said earlier one is like Buffalo buff flow situations in",
    "start": "3032960",
    "end": "3038480"
  },
  {
    "text": "U third party or operating system kernel mode trusted components and the second is that",
    "start": "3038480",
    "end": "3045640"
  },
  {
    "text": "uh Windows 2000 and Windows NT has a certain kernel mode section object",
    "start": "3045640",
    "end": "3053480"
  },
  {
    "text": "which is created when the memory manager is in initialized called device physical memory and this section is like okay",
    "start": "3053480",
    "end": "3061160"
  },
  {
    "text": "kernel if you are not familiar kernel mode sections are the kernel mode counterpart of what in the win32 world",
    "start": "3061160",
    "end": "3067240"
  },
  {
    "text": "which we know as file mappings or file mapping objects there are two ways to actually",
    "start": "3067240",
    "end": "3073799"
  },
  {
    "text": "create a section object where a section object can either be backed up by a physical or other an existing file in",
    "start": "3073799",
    "end": "3080280"
  },
  {
    "text": "the file system or the system virtual memory now",
    "start": "3080280",
    "end": "3085960"
  },
  {
    "text": "the uniqueness of this device physical memory is that the memory manager creates",
    "start": "3085960",
    "end": "3091839"
  },
  {
    "text": "it and it back it up neither by virtual memory nor a file system file but the",
    "start": "3091839",
    "end": "3096960"
  },
  {
    "text": "physical memory of the system so why is this used this is used by the",
    "start": "3096960",
    "end": "3103640"
  },
  {
    "text": "operating system for it internal functionality where operating system requires the access to physical memory",
    "start": "3103640",
    "end": "3110760"
  },
  {
    "text": "one scenario is when the your graphics driver is being initialized your graphic driver needs to read its parameter",
    "start": "3110760",
    "end": "3118480"
  },
  {
    "text": "information from the PCI address space basically which is memory map R course",
    "start": "3118480",
    "end": "3123599"
  },
  {
    "text": "so to read that this needs to access physical memory so the operating system would use the device physical memory to access that",
    "start": "3123599",
    "end": "3129520"
  },
  {
    "text": "information and the other thing is in um 16bit programs when when you're using a",
    "start": "3129520",
    "end": "3134799"
  },
  {
    "text": "Dos virtual machine certain physical memory areas have to be consistent within the virtual",
    "start": "3134799",
    "end": "3140079"
  },
  {
    "text": "machine space as well so the kernel uses the device physical memory section to actually read that information from",
    "start": "3140079",
    "end": "3145280"
  },
  {
    "text": "physical memory and map it to the v86 environment where the 16-bit process is running in so this is the reason why",
    "start": "3145280",
    "end": "3153280"
  },
  {
    "text": "device physical memory exists it's not because Microsoft wanted to install back door and if you take off the access to",
    "start": "3153280",
    "end": "3160040"
  },
  {
    "text": "device physical memory you will break these parts of the operating system plus perhaps legitimate programs which will",
    "start": "3160040",
    "end": "3166640"
  },
  {
    "text": "use it but uh to date I haven't come across any program either from Microsoft",
    "start": "3166640",
    "end": "3172280"
  },
  {
    "text": "or otherwise which actually uses device physic memory except for when it's been",
    "start": "3172280",
    "end": "3177440"
  },
  {
    "text": "used in the colel in these areas I discussed earlier and uh the second is",
    "start": "3177440",
    "end": "3185880"
  },
  {
    "text": "um in ZW set system information which is a native API call used to set or query",
    "start": "3185880",
    "end": "3194440"
  },
  {
    "text": "various operating system parameters this can actually be used to",
    "start": "3194440",
    "end": "3200240"
  },
  {
    "text": "load uh an image into the kernel add space and execute it what happens is uh",
    "start": "3200240",
    "end": "3206680"
  },
  {
    "text": "this function has an information class called um system load and call Image",
    "start": "3206680",
    "end": "3212280"
  },
  {
    "text": "well there is system load image and system unload image as well but this can only be used in ring zero itself which",
    "start": "3212280",
    "end": "3217799"
  },
  {
    "text": "are which can be used by a device driver or like a colel mode component to actually load an image to make the",
    "start": "3217799",
    "end": "3223240"
  },
  {
    "text": "process easier but the system load and call Image would actually load any",
    "start": "3223240",
    "end": "3228599"
  },
  {
    "text": "portable executable image into the kernel create a ring zero thread and execute",
    "start": "3228599",
    "end": "3234160"
  },
  {
    "text": "it and it'll execute it in the same process context of whatever the process which call this function",
    "start": "3234160",
    "end": "3242319"
  },
  {
    "text": "so that can that technique can be utilized to inject code into ring",
    "start": "3242319",
    "end": "3248520"
  },
  {
    "text": "zero so um having uh said that I think uh I",
    "start": "3249240",
    "end": "3256200"
  },
  {
    "text": "think I've gone a little bit over my time on this one I think I'll be moving to the Deep knowledge track so if anybody's interested can come over there",
    "start": "3256200",
    "end": "3264319"
  },
  {
    "text": "and u maybe I'll do a technical breakout session or maybe I'll explain a little bit more on these Technologies as to",
    "start": "3264319",
    "end": "3270520"
  },
  {
    "text": "like how the kernel mode injection could work but then again there's still the Obstacle of how to exactly do it",
    "start": "3270520",
    "end": "3279240"
  },
  {
    "text": "yeah oh uh the last native AP function yeah ZW set system information and the",
    "start": "3279520",
    "end": "3286880"
  },
  {
    "text": "information class we are dealing with is system load and call Image I think it is",
    "start": "3286880",
    "end": "3292040"
  },
  {
    "text": "uh number 38 if I remember right",
    "start": "3292040",
    "end": "3297079"
  },
  {
    "text": "all right guys U thank [Music]",
    "start": "3298920",
    "end": "3305489"
  },
  {
    "text": "you",
    "start": "3324000",
    "end": "3327000"
  },
  {
    "text": "e",
    "start": "3473799",
    "end": "3476799"
  }
]