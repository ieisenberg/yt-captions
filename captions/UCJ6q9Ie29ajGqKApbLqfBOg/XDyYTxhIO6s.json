[
  {
    "text": "hello and thank you for coming today",
    "start": "2600",
    "end": "5080"
  },
  {
    "text": "I'll be talking through a couple of",
    "start": "5080",
    "end": "6680"
  },
  {
    "text": "cases where a Sugar CRM vulnerability",
    "start": "6680",
    "end": "9599"
  },
  {
    "text": "led to ads accounts being compromised to",
    "start": "9599",
    "end": "12920"
  },
  {
    "text": "start us off how many of your",
    "start": "12920",
    "end": "14599"
  },
  {
    "text": "organizations have a cloud environment I",
    "start": "14599",
    "end": "17160"
  },
  {
    "text": "just see a brief raise of",
    "start": "17160",
    "end": "18840"
  },
  {
    "text": "hands okay quite a few of you and how",
    "start": "18840",
    "end": "22119"
  },
  {
    "text": "many of you have thought about the",
    "start": "22119",
    "end": "23519"
  },
  {
    "text": "unique attack surface that exists in the",
    "start": "23519",
    "end": "25760"
  },
  {
    "text": "cloud can see another raise of hands",
    "start": "25760",
    "end": "28480"
  },
  {
    "text": "okay not as many of you So today we're",
    "start": "28480",
    "end": "31000"
  },
  {
    "text": "going to talk about how the attack",
    "start": "31000",
    "end": "32480"
  },
  {
    "text": "surface is different in the cloud and",
    "start": "32480",
    "end": "34640"
  },
  {
    "text": "talk about some remediation steps that",
    "start": "34640",
    "end": "36760"
  },
  {
    "text": "organizations can take to protect",
    "start": "36760",
    "end": "40160"
  },
  {
    "text": "themselves for a brief introduction my",
    "start": "40160",
    "end": "42559"
  },
  {
    "text": "name is Margaret Zimmerman and I'm A",
    "start": "42559",
    "end": "44239"
  },
  {
    "text": "Cloud incident responder at unit 42 unit",
    "start": "44239",
    "end": "47520"
  },
  {
    "text": "42 is the incident response proactive",
    "start": "47520",
    "end": "50520"
  },
  {
    "text": "Security Services and threat",
    "start": "50520",
    "end": "52239"
  },
  {
    "text": "intelligence arm of paloalto networks",
    "start": "52239",
    "end": "55160"
  },
  {
    "text": "for a brief description of what I do",
    "start": "55160",
    "end": "57000"
  },
  {
    "text": "day-to-day whenever we have a case come",
    "start": "57000",
    "end": "59559"
  },
  {
    "text": "in that has any resemblance of a cloud",
    "start": "59559",
    "end": "63160"
  },
  {
    "text": "component I'm brought in to make sure",
    "start": "63160",
    "end": "65320"
  },
  {
    "text": "that we consider the unique uh attack",
    "start": "65320",
    "end": "68080"
  },
  {
    "text": "vectors and unique uh services that",
    "start": "68080",
    "end": "70840"
  },
  {
    "text": "exist in the",
    "start": "70840",
    "end": "72960"
  },
  {
    "text": "cloud at a high level we're going to be",
    "start": "72960",
    "end": "75200"
  },
  {
    "text": "using the miter attack Matrix to guide",
    "start": "75200",
    "end": "77000"
  },
  {
    "text": "our walkthrough of these cases we'll",
    "start": "77000",
    "end": "79320"
  },
  {
    "text": "start with the initial attack Vector",
    "start": "79320",
    "end": "81040"
  },
  {
    "text": "which was the sugar serum vulnerability",
    "start": "81040",
    "end": "83600"
  },
  {
    "text": "which is cve 2023",
    "start": "83600",
    "end": "86880"
  },
  {
    "text": "22952 and as a brief note this sugar",
    "start": "86880",
    "end": "89960"
  },
  {
    "text": "serum vulnerability is what was",
    "start": "89960",
    "end": "92240"
  },
  {
    "text": "exploited in these cases and it's not an",
    "start": "92240",
    "end": "94159"
  },
  {
    "text": "AWS vulnerability in fact these sugar",
    "start": "94159",
    "end": "97040"
  },
  {
    "text": "serum vulnerabilities could have been",
    "start": "97040",
    "end": "98880"
  },
  {
    "text": "exploited in any Cloud",
    "start": "98880",
    "end": "100799"
  },
  {
    "text": "environment after this we'll walk",
    "start": "100799",
    "end": "102680"
  },
  {
    "text": "through the rest of the cases and talk",
    "start": "102680",
    "end": "104560"
  },
  {
    "text": "about some remediation steps that",
    "start": "104560",
    "end": "106200"
  },
  {
    "text": "organizations can take to protect",
    "start": "106200",
    "end": "109320"
  },
  {
    "text": "themselves of the 14 miter uh attack",
    "start": "109320",
    "end": "113000"
  },
  {
    "text": "tactics we'll be looking at nine of them",
    "start": "113000",
    "end": "116240"
  },
  {
    "text": "I've included the nine that we'll be",
    "start": "116240",
    "end": "117799"
  },
  {
    "text": "looking at in the order that we'll talk",
    "start": "117799",
    "end": "119520"
  },
  {
    "text": "through them",
    "start": "119520",
    "end": "121439"
  },
  {
    "text": "them let's take a look at that Sugar CRM",
    "start": "121439",
    "end": "124719"
  },
  {
    "text": "vulnerability Sugar CRM is a customer",
    "start": "124719",
    "end": "127360"
  },
  {
    "text": "relationship management system that",
    "start": "127360",
    "end": "129479"
  },
  {
    "text": "focuses on Cross team collaboration and",
    "start": "129479",
    "end": "132200"
  },
  {
    "text": "it has a ton of different features such",
    "start": "132200",
    "end": "134480"
  },
  {
    "text": "as a quote management system tools for",
    "start": "134480",
    "end": "136680"
  },
  {
    "text": "sales forecasting and marketing campaign",
    "start": "136680",
    "end": "138920"
  },
  {
    "text": "tools because of this wide range of",
    "start": "138920",
    "end": "141599"
  },
  {
    "text": "features they obviously have a wide",
    "start": "141599",
    "end": "143560"
  },
  {
    "text": "range of customers such as customers in",
    "start": "143560",
    "end": "146160"
  },
  {
    "text": "the audio industry clothing retailers as",
    "start": "146160",
    "end": "148959"
  },
  {
    "text": "well as Financial service companies",
    "start": "148959",
    "end": "151599"
  },
  {
    "text": "digging into the threat actor mindset a",
    "start": "151599",
    "end": "153560"
  },
  {
    "text": "little more there's various reasons why",
    "start": "153560",
    "end": "155840"
  },
  {
    "text": "they target different companies and",
    "start": "155840",
    "end": "157640"
  },
  {
    "text": "software in the case of Sugar CRM it's",
    "start": "157640",
    "end": "160760"
  },
  {
    "text": "actually the customer databases that are",
    "start": "160760",
    "end": "163080"
  },
  {
    "text": "most interesting to threat actors with",
    "start": "163080",
    "end": "165879"
  },
  {
    "text": "in these databases there's email",
    "start": "165879",
    "end": "168000"
  },
  {
    "text": "addresses contact information account",
    "start": "168000",
    "end": "170680"
  },
  {
    "text": "information and quote details all of",
    "start": "170680",
    "end": "173400"
  },
  {
    "text": "these things threat actors are super",
    "start": "173400",
    "end": "175280"
  },
  {
    "text": "interested in and if they were to",
    "start": "175280",
    "end": "177280"
  },
  {
    "text": "compromise the database they try to sell",
    "start": "177280",
    "end": "179280"
  },
  {
    "text": "this information",
    "start": "179280",
    "end": "180480"
  },
  {
    "text": "or turn around and try to extort their",
    "start": "180480",
    "end": "182319"
  },
  {
    "text": "victims for more money according to the",
    "start": "182319",
    "end": "185360"
  },
  {
    "text": "nist National vulnerability database",
    "start": "185360",
    "end": "187760"
  },
  {
    "text": "this vulnerability was initially",
    "start": "187760",
    "end": "189560"
  },
  {
    "text": "published on January 11th 2023 with a",
    "start": "189560",
    "end": "192519"
  },
  {
    "text": "base score of",
    "start": "192519",
    "end": "193920"
  },
  {
    "text": "8.8 this vulnerability allows threat",
    "start": "193920",
    "end": "196599"
  },
  {
    "text": "actors to inject custom PHP code into",
    "start": "196599",
    "end": "200000"
  },
  {
    "text": "the email templates module due to",
    "start": "200000",
    "end": "202280"
  },
  {
    "text": "missing input validation I put a red box",
    "start": "202280",
    "end": "205480"
  },
  {
    "text": "around where that module fits in with",
    "start": "205480",
    "end": "207239"
  },
  {
    "text": "the rest of the sugar serum modules now",
    "start": "207239",
    "end": "210439"
  },
  {
    "text": "this is a remote code execution",
    "start": "210439",
    "end": "212319"
  },
  {
    "text": "vulnerability so once it is exploited",
    "start": "212319",
    "end": "215239"
  },
  {
    "text": "the threat actors have direct access to",
    "start": "215239",
    "end": "217319"
  },
  {
    "text": "the underl servers running the software",
    "start": "217319",
    "end": "220640"
  },
  {
    "text": "in in our cases those were Amazon",
    "start": "220640",
    "end": "223080"
  },
  {
    "text": "elastic Cloud compute instances which",
    "start": "223080",
    "end": "225879"
  },
  {
    "text": "you can think of as a virtual machine",
    "start": "225879",
    "end": "228519"
  },
  {
    "text": "because these servers are hosted in an",
    "start": "228519",
    "end": "230760"
  },
  {
    "text": "adase environment this leads to Unique",
    "start": "230760",
    "end": "233120"
  },
  {
    "text": "attack factors that we're going to talk",
    "start": "233120",
    "end": "236560"
  },
  {
    "text": "through once a thread actor gains access",
    "start": "236560",
    "end": "239360"
  },
  {
    "text": "to an ec2 instance in order to gain",
    "start": "239360",
    "end": "241840"
  },
  {
    "text": "further access to the rest of the AWS",
    "start": "241840",
    "end": "243959"
  },
  {
    "text": "account and move laterally to the",
    "start": "243959",
    "end": "245840"
  },
  {
    "text": "control plane they need to compromise",
    "start": "245840",
    "end": "248439"
  },
  {
    "text": "credentials there's a large difference",
    "start": "248439",
    "end": "250680"
  },
  {
    "text": "between threat actors that can",
    "start": "250680",
    "end": "252079"
  },
  {
    "text": "compromise the data plane versus the",
    "start": "252079",
    "end": "254040"
  },
  {
    "text": "control plane you can think of the data",
    "start": "254040",
    "end": "256560"
  },
  {
    "text": "plane as providing the core components",
    "start": "256560",
    "end": "258320"
  },
  {
    "text": "of a service such as the running of an",
    "start": "258320",
    "end": "260519"
  },
  {
    "text": "ec2 instance or placing an object in an",
    "start": "260519",
    "end": "263120"
  },
  {
    "text": "S3 bucket the control plane is a layer",
    "start": "263120",
    "end": "266400"
  },
  {
    "text": "above that and it controls the creation",
    "start": "266400",
    "end": "268720"
  },
  {
    "text": "of resources as well as provides the",
    "start": "268720",
    "end": "271199"
  },
  {
    "text": "apis used to interact with the various",
    "start": "271199",
    "end": "274160"
  },
  {
    "text": "Services if the control plane is",
    "start": "274160",
    "end": "276320"
  },
  {
    "text": "compromised that greatly expands the",
    "start": "276320",
    "end": "278520"
  },
  {
    "text": "attack surface for a thread actor what",
    "start": "278520",
    "end": "281240"
  },
  {
    "text": "we saw in our cases was that these sugar",
    "start": "281240",
    "end": "284160"
  },
  {
    "text": "serum ec2 instances were compromised and",
    "start": "284160",
    "end": "287400"
  },
  {
    "text": "from there the thread actors were able",
    "start": "287400",
    "end": "288880"
  },
  {
    "text": "to grab access keys off of the hosts",
    "start": "288880",
    "end": "292039"
  },
  {
    "text": "those access Keys belong to AWS identity",
    "start": "292039",
    "end": "295000"
  },
  {
    "text": "and access management users which",
    "start": "295000",
    "end": "297360"
  },
  {
    "text": "allowed the thread actors to get to the",
    "start": "297360",
    "end": "299000"
  },
  {
    "text": "control plane",
    "start": "299000",
    "end": "300160"
  },
  {
    "text": "and modify relational database service",
    "start": "300160",
    "end": "302479"
  },
  {
    "text": "resources as well as ec2",
    "start": "302479",
    "end": "305919"
  },
  {
    "text": "resources let's take a look at why it",
    "start": "305919",
    "end": "308120"
  },
  {
    "text": "was so simple to find those credentials",
    "start": "308120",
    "end": "309639"
  },
  {
    "text": "in the first place in these cases the",
    "start": "309639",
    "end": "312600"
  },
  {
    "text": "thread actors were able to obtain",
    "start": "312600",
    "end": "314720"
  },
  {
    "text": "long-term access keys from the",
    "start": "314720",
    "end": "316639"
  },
  {
    "text": "credentials file located on the host",
    "start": "316639",
    "end": "319720"
  },
  {
    "text": "adrias provides documentation about the",
    "start": "319720",
    "end": "322080"
  },
  {
    "text": "different prefixes associated with each",
    "start": "322080",
    "end": "324080"
  },
  {
    "text": "resource type as well as the location of",
    "start": "324080",
    "end": "326440"
  },
  {
    "text": "this credentials file the long-term aess",
    "start": "326440",
    "end": "329759"
  },
  {
    "text": "keys that we're interested in start with",
    "start": "329759",
    "end": "331759"
  },
  {
    "text": "the four letters a k i a and this",
    "start": "331759",
    "end": "334440"
  },
  {
    "text": "credentials file is located under the",
    "start": "334440",
    "end": "336479"
  },
  {
    "text": "hidden AWS directory under each user it",
    "start": "336479",
    "end": "340479"
  },
  {
    "text": "really depends on how you authenticate",
    "start": "340479",
    "end": "342120"
  },
  {
    "text": "to ads",
    "start": "342120",
    "end": "344360"
  },
  {
    "text": "and it depends on how you authenticate",
    "start": "344360",
    "end": "347000"
  },
  {
    "text": "to ad OBS and depending on how you do",
    "start": "347000",
    "end": "349520"
  },
  {
    "text": "that different credentials will be left",
    "start": "349520",
    "end": "351120"
  },
  {
    "text": "in this file I've included an example at",
    "start": "351120",
    "end": "354000"
  },
  {
    "text": "the top of the screen of what this",
    "start": "354000",
    "end": "355680"
  },
  {
    "text": "credentials file looks like one thing",
    "start": "355680",
    "end": "358440"
  },
  {
    "text": "you will know is these credentials are",
    "start": "358440",
    "end": "360160"
  },
  {
    "text": "stored in plain text so if the threat",
    "start": "360160",
    "end": "363120"
  },
  {
    "text": "actor were to compromise the host and",
    "start": "363120",
    "end": "364800"
  },
  {
    "text": "this file existed on the host it's super",
    "start": "364800",
    "end": "367160"
  },
  {
    "text": "easy to just open it up and grab what's",
    "start": "367160",
    "end": "369440"
  },
  {
    "text": "ever in there these credentials are",
    "start": "369440",
    "end": "372280"
  },
  {
    "text": "exactly what the thread actors need for",
    "start": "372280",
    "end": "374039"
  },
  {
    "text": "lateral movement let's take a look to",
    "start": "374039",
    "end": "376319"
  },
  {
    "text": "see what the thread actors did next in",
    "start": "376319",
    "end": "377880"
  },
  {
    "text": "the discovery",
    "start": "377880",
    "end": "379800"
  },
  {
    "text": "phase the First Command we saw the",
    "start": "379800",
    "end": "382280"
  },
  {
    "text": "thread actors run before doing anything",
    "start": "382280",
    "end": "384520"
  },
  {
    "text": "else was this get Coler identity command",
    "start": "384520",
    "end": "387639"
  },
  {
    "text": "we see this over and over in cases that",
    "start": "387639",
    "end": "389680"
  },
  {
    "text": "this is always the first call that a",
    "start": "389680",
    "end": "391400"
  },
  {
    "text": "thread actor performs you can think of",
    "start": "391400",
    "end": "393880"
  },
  {
    "text": "git caller identity is the who am I of",
    "start": "393880",
    "end": "396440"
  },
  {
    "text": "AWS and it returns various details about",
    "start": "396440",
    "end": "399160"
  },
  {
    "text": "the role or user that performed the call",
    "start": "399160",
    "end": "402160"
  },
  {
    "text": "I've included an example response on the",
    "start": "402160",
    "end": "404440"
  },
  {
    "text": "screen and it Returns the user ID which",
    "start": "404440",
    "end": "407840"
  },
  {
    "text": "is the unique identifier of the entity",
    "start": "407840",
    "end": "410080"
  },
  {
    "text": "that performed the call as well as the",
    "start": "410080",
    "end": "412280"
  },
  {
    "text": "12-digit AWS account ID and it also",
    "start": "412280",
    "end": "415520"
  },
  {
    "text": "Returns the Amazon resource name which",
    "start": "415520",
    "end": "417720"
  },
  {
    "text": "contains the 12-digit account ID",
    "start": "417720",
    "end": "420240"
  },
  {
    "text": "as well as the human readable name of",
    "start": "420240",
    "end": "422000"
  },
  {
    "text": "the user or role that performed the call",
    "start": "422000",
    "end": "425199"
  },
  {
    "text": "this gives the thread actors a good",
    "start": "425199",
    "end": "426800"
  },
  {
    "text": "Baseline understanding of what",
    "start": "426800",
    "end": "428520"
  },
  {
    "text": "credentials they have compromised from",
    "start": "428520",
    "end": "431160"
  },
  {
    "text": "here the thread actors moved on to",
    "start": "431160",
    "end": "433960"
  },
  {
    "text": "scanning to determine what existed",
    "start": "433960",
    "end": "436560"
  },
  {
    "text": "outside of the compromised ec2 instances",
    "start": "436560",
    "end": "439319"
  },
  {
    "text": "the threat actors used a variety of",
    "start": "439319",
    "end": "441360"
  },
  {
    "text": "tools the first one we saw them used was",
    "start": "441360",
    "end": "444199"
  },
  {
    "text": "paku paku is an open source AWS",
    "start": "444199",
    "end": "447479"
  },
  {
    "text": "exploitation framework that is designed",
    "start": "447479",
    "end": "449759"
  },
  {
    "text": "to be the metas equivalent in the cloud",
    "start": "449759",
    "end": "453000"
  },
  {
    "text": "now with paku what was super interesting",
    "start": "453000",
    "end": "455639"
  },
  {
    "text": "was it actually already existed on the",
    "start": "455639",
    "end": "457879"
  },
  {
    "text": "hosts either due to penetration testing",
    "start": "457879",
    "end": "460639"
  },
  {
    "text": "activity or other user activity so the",
    "start": "460639",
    "end": "463680"
  },
  {
    "text": "thread actors just lived off the land",
    "start": "463680",
    "end": "466879"
  },
  {
    "text": "now with Scout Suite it is a security",
    "start": "466879",
    "end": "469120"
  },
  {
    "text": "auditing tool traditionally used for",
    "start": "469120",
    "end": "471159"
  },
  {
    "text": "security posture assessments of cloud",
    "start": "471159",
    "end": "473520"
  },
  {
    "text": "environments unlike paku Scout was not",
    "start": "473520",
    "end": "476879"
  },
  {
    "text": "downloaded on the hosts and we saw that",
    "start": "476879",
    "end": "479159"
  },
  {
    "text": "the threat actors used it based off of",
    "start": "479159",
    "end": "481360"
  },
  {
    "text": "the user agent in the cloud TR logs and",
    "start": "481360",
    "end": "484159"
  },
  {
    "text": "again I've included an example of what",
    "start": "484159",
    "end": "485919"
  },
  {
    "text": "that user agent looks like at the bottom",
    "start": "485919",
    "end": "487639"
  },
  {
    "text": "of the",
    "start": "487639",
    "end": "488479"
  },
  {
    "text": "screen with both of these tools the",
    "start": "488479",
    "end": "491080"
  },
  {
    "text": "thread actors are able to get a good lay",
    "start": "491080",
    "end": "493120"
  },
  {
    "text": "of the land of this AWS",
    "start": "493120",
    "end": "496159"
  },
  {
    "text": "account with these tools the thread",
    "start": "496159",
    "end": "498479"
  },
  {
    "text": "actors scanned a variety of services we",
    "start": "498479",
    "end": "501159"
  },
  {
    "text": "saw describe and list commands for all",
    "start": "501159",
    "end": "503599"
  },
  {
    "text": "the different services such as ec2 S3 I",
    "start": "503599",
    "end": "506599"
  },
  {
    "text": "am and the list goes on what's most",
    "start": "506599",
    "end": "509520"
  },
  {
    "text": "interesting though is actually the",
    "start": "509520",
    "end": "511479"
  },
  {
    "text": "organizations and the cost and usage",
    "start": "511479",
    "end": "513640"
  },
  {
    "text": "service calls now why would a threat",
    "start": "513640",
    "end": "516919"
  },
  {
    "text": "actor be interested in these Services",
    "start": "516919",
    "end": "519640"
  },
  {
    "text": "there's actually some unique information",
    "start": "519640",
    "end": "521360"
  },
  {
    "text": "that you can get from",
    "start": "521360",
    "end": "523039"
  },
  {
    "text": "them ABS organizations is a centralized",
    "start": "523039",
    "end": "526320"
  },
  {
    "text": "place to manage multiple AWS AWS",
    "start": "526320",
    "end": "529040"
  },
  {
    "text": "accounts and",
    "start": "529040",
    "end": "530279"
  },
  {
    "text": "resources of the AWS organization calls",
    "start": "530279",
    "end": "533800"
  },
  {
    "text": "three of them stand out the first one is",
    "start": "533800",
    "end": "536760"
  },
  {
    "text": "the list organizational unit for parent",
    "start": "536760",
    "end": "539839"
  },
  {
    "text": "this returns all the organizational unit",
    "start": "539839",
    "end": "542320"
  },
  {
    "text": "IDs the second one is this list accounts",
    "start": "542320",
    "end": "545560"
  },
  {
    "text": "and this returns all of the account IDs",
    "start": "545560",
    "end": "548120"
  },
  {
    "text": "for each",
    "start": "548120",
    "end": "549160"
  },
  {
    "text": "OU now this final one is the one that's",
    "start": "549160",
    "end": "551760"
  },
  {
    "text": "the most interesting it's the describe",
    "start": "551760",
    "end": "554000"
  },
  {
    "text": "organization API and this Returns the",
    "start": "554000",
    "end": "557120"
  },
  {
    "text": "master account ID as well as the root",
    "start": "557120",
    "end": "559360"
  },
  {
    "text": "email address for that account the email",
    "start": "559360",
    "end": "562640"
  },
  {
    "text": "address is exactly what the thread",
    "start": "562640",
    "end": "564399"
  },
  {
    "text": "actors need if they want to try to log",
    "start": "564399",
    "end": "566440"
  },
  {
    "text": "in as root and it's a kind of a big deal",
    "start": "566440",
    "end": "569279"
  },
  {
    "text": "it's so accessible because there's no",
    "start": "569279",
    "end": "571120"
  },
  {
    "text": "limits to what the root user can",
    "start": "571120",
    "end": "573680"
  },
  {
    "text": "do the final piece of the discovery",
    "start": "573680",
    "end": "576079"
  },
  {
    "text": "phase is this get cost and usage API it",
    "start": "576079",
    "end": "579839"
  },
  {
    "text": "might seem strange but again provides",
    "start": "579839",
    "end": "581920"
  },
  {
    "text": "some interesting Account Details on the",
    "start": "581920",
    "end": "584640"
  },
  {
    "text": "left I've included an example request",
    "start": "584640",
    "end": "586959"
  },
  {
    "text": "parameters and from the cloud chair logs",
    "start": "586959",
    "end": "589600"
  },
  {
    "text": "we can see the time period that the",
    "start": "589600",
    "end": "591399"
  },
  {
    "text": "thread actors requested as well as the",
    "start": "591399",
    "end": "593440"
  },
  {
    "text": "granularity of metrics on the right I've",
    "start": "593440",
    "end": "596600"
  },
  {
    "text": "included an example response when",
    "start": "596600",
    "end": "599519"
  },
  {
    "text": "reviewing the results you can tell the",
    "start": "599519",
    "end": "601440"
  },
  {
    "text": "general spend within an AWS account with",
    "start": "601440",
    "end": "604760"
  },
  {
    "text": "that spend you can actually tell how",
    "start": "604760",
    "end": "606720"
  },
  {
    "text": "active or not an account is if there's a",
    "start": "606720",
    "end": "609560"
  },
  {
    "text": "large amount of spend within an ews",
    "start": "609560",
    "end": "611600"
  },
  {
    "text": "account that means there's a ton of",
    "start": "611600",
    "end": "613560"
  },
  {
    "text": "resources so if you're a threat actor",
    "start": "613560",
    "end": "615800"
  },
  {
    "text": "you know that there's a ton of resources",
    "start": "615800",
    "end": "617920"
  },
  {
    "text": "that exist so if you spin up anything",
    "start": "617920",
    "end": "620079"
  },
  {
    "text": "new it'll most likely blend in on the",
    "start": "620079",
    "end": "623079"
  },
  {
    "text": "other hand if there's a small amount of",
    "start": "623079",
    "end": "625399"
  },
  {
    "text": "spend that means there's not a lot of",
    "start": "625399",
    "end": "627200"
  },
  {
    "text": "resources and so the thre actors know",
    "start": "627200",
    "end": "629839"
  },
  {
    "text": "that if they spin up new resources it'll",
    "start": "629839",
    "end": "632000"
  },
  {
    "text": "stand out a lot",
    "start": "632000",
    "end": "633600"
  },
  {
    "text": "more with both of these Services the",
    "start": "633600",
    "end": "636160"
  },
  {
    "text": "thread actors now have a good",
    "start": "636160",
    "end": "637800"
  },
  {
    "text": "understanding of the account structure",
    "start": "637800",
    "end": "639639"
  },
  {
    "text": "as well as the usage Within These",
    "start": "639639",
    "end": "641200"
  },
  {
    "text": "accounts and this is a great example of",
    "start": "641200",
    "end": "643720"
  },
  {
    "text": "why the attack service is different in",
    "start": "643720",
    "end": "645440"
  },
  {
    "text": "the cloud because these seemingly",
    "start": "645440",
    "end": "647320"
  },
  {
    "text": "inocula API calls actually provide some",
    "start": "647320",
    "end": "650480"
  },
  {
    "text": "helpful information for a thread actor",
    "start": "650480",
    "end": "652920"
  },
  {
    "text": "let's see what they did",
    "start": "652920",
    "end": "654600"
  },
  {
    "text": "next the thread actors progressed from",
    "start": "654600",
    "end": "657240"
  },
  {
    "text": "performing Discovery against all follow",
    "start": "657240",
    "end": "659240"
  },
  {
    "text": "the account to taking action on various",
    "start": "659240",
    "end": "661720"
  },
  {
    "text": "services from the discovery calls",
    "start": "661720",
    "end": "664160"
  },
  {
    "text": "against the RDS service the thread",
    "start": "664160",
    "end": "666200"
  },
  {
    "text": "actors were able to get database names",
    "start": "666200",
    "end": "668480"
  },
  {
    "text": "what security groups were attached as",
    "start": "668480",
    "end": "670399"
  },
  {
    "text": "well as names of",
    "start": "670399",
    "end": "671760"
  },
  {
    "text": "snapshots this allows the thread act to",
    "start": "671760",
    "end": "674519"
  },
  {
    "text": "narrow their focus to specific RDS",
    "start": "674519",
    "end": "676880"
  },
  {
    "text": "databases of interest for data",
    "start": "676880",
    "end": "680279"
  },
  {
    "text": "extration we finally see the thread",
    "start": "680279",
    "end": "682519"
  },
  {
    "text": "actors progress to taking action we saw",
    "start": "682519",
    "end": "685639"
  },
  {
    "text": "them laterally move from the Sugar CRM",
    "start": "685639",
    "end": "688200"
  },
  {
    "text": "ec2 and es to the control plane and",
    "start": "688200",
    "end": "691399"
  },
  {
    "text": "modify RDS resources we first saw them",
    "start": "691399",
    "end": "694880"
  },
  {
    "text": "create brand new snapshots from the",
    "start": "694880",
    "end": "697320"
  },
  {
    "text": "running sugar serum databases and from",
    "start": "697320",
    "end": "700079"
  },
  {
    "text": "there we saw them modify pre-existing",
    "start": "700079",
    "end": "702440"
  },
  {
    "text": "security groups that already allowed",
    "start": "702440",
    "end": "704399"
  },
  {
    "text": "Port 22 for that SSH access and we saw",
    "start": "704399",
    "end": "707560"
  },
  {
    "text": "them add Port 3306 for",
    "start": "707560",
    "end": "710639"
  },
  {
    "text": "MySQL after this the thread actors moved",
    "start": "710639",
    "end": "713240"
  },
  {
    "text": "on to",
    "start": "713240",
    "end": "714160"
  },
  {
    "text": "extration they used those snapshots they",
    "start": "714160",
    "end": "717360"
  },
  {
    "text": "just created to create brand new RDS",
    "start": "717360",
    "end": "720680"
  },
  {
    "text": "databases and made them publicly",
    "start": "720680",
    "end": "723000"
  },
  {
    "text": "accessible from here they attached the",
    "start": "723000",
    "end": "725240"
  },
  {
    "text": "security group they",
    "start": "725240",
    "end": "726639"
  },
  {
    "text": "modified they also changed that Master",
    "start": "726639",
    "end": "729320"
  },
  {
    "text": "user password to let them log in now",
    "start": "729320",
    "end": "733360"
  },
  {
    "text": "luckily for us as instant responders",
    "start": "733360",
    "end": "735519"
  },
  {
    "text": "these snapshots were not deleted so we",
    "start": "735519",
    "end": "737839"
  },
  {
    "text": "know exactly what data was publicly",
    "start": "737839",
    "end": "740399"
  },
  {
    "text": "accessible on the other hand we were not",
    "start": "740399",
    "end": "743800"
  },
  {
    "text": "able to tell uh how much data was",
    "start": "743800",
    "end": "746440"
  },
  {
    "text": "exfiltrated depending on the case so the",
    "start": "746440",
    "end": "749720"
  },
  {
    "text": "organizations that had VPC flow logs",
    "start": "749720",
    "end": "752240"
  },
  {
    "text": "enabled we could tell exactly how many",
    "start": "752240",
    "end": "754800"
  },
  {
    "text": "bytes left the network with the cases",
    "start": "754800",
    "end": "757720"
  },
  {
    "text": "that did not have it enabled we were",
    "start": "757720",
    "end": "759600"
  },
  {
    "text": "unable to tell exactly how much data",
    "start": "759600",
    "end": "761639"
  },
  {
    "text": "left the",
    "start": "761639",
    "end": "763040"
  },
  {
    "text": "network one thing I wanted to note that",
    "start": "763040",
    "end": "765320"
  },
  {
    "text": "was kind of fun was during the discovery",
    "start": "765320",
    "end": "767639"
  },
  {
    "text": "phase of the attack everything was",
    "start": "767639",
    "end": "769440"
  },
  {
    "text": "clearly automated because it happened",
    "start": "769440",
    "end": "771360"
  },
  {
    "text": "very quickly in a short time span once",
    "start": "771360",
    "end": "774120"
  },
  {
    "text": "the thread actors moved beyond extration",
    "start": "774120",
    "end": "776839"
  },
  {
    "text": "the time between these apis took a a lot",
    "start": "776839",
    "end": "779079"
  },
  {
    "text": "longer we actually saw a bunch of typos",
    "start": "779079",
    "end": "781600"
  },
  {
    "text": "so it's kind of fun to see the",
    "start": "781600",
    "end": "782760"
  },
  {
    "text": "difference between the automated",
    "start": "782760",
    "end": "784720"
  },
  {
    "text": "Discovery piece and then the Hands-On",
    "start": "784720",
    "end": "786480"
  },
  {
    "text": "keyboard uh rest of the",
    "start": "786480",
    "end": "789760"
  },
  {
    "text": "attacks the thread actors also did a lot",
    "start": "789760",
    "end": "792360"
  },
  {
    "text": "of work on the ec2 instance side of",
    "start": "792360",
    "end": "794279"
  },
  {
    "text": "things from these API calls they're able",
    "start": "794279",
    "end": "797160"
  },
  {
    "text": "to tell the names of ec2 instances the",
    "start": "797160",
    "end": "799639"
  },
  {
    "text": "network setup as well as what security",
    "start": "799639",
    "end": "801680"
  },
  {
    "text": "groups",
    "start": "801680",
    "end": "802720"
  },
  {
    "text": "existed this gives the thread actors a",
    "start": "802720",
    "end": "805040"
  },
  {
    "text": "good Baseline understanding of where to",
    "start": "805040",
    "end": "807720"
  },
  {
    "text": "start modifying resource for",
    "start": "807720",
    "end": "810760"
  },
  {
    "text": "ec2 the first thing that we saw the",
    "start": "810760",
    "end": "812920"
  },
  {
    "text": "thread actors do was create a brand new",
    "start": "812920",
    "end": "815760"
  },
  {
    "text": "Amazon machine image from the running",
    "start": "815760",
    "end": "817920"
  },
  {
    "text": "sugar serum ec2 instances from there we",
    "start": "817920",
    "end": "821279"
  },
  {
    "text": "saw them import a new key from their",
    "start": "821279",
    "end": "824399"
  },
  {
    "text": "public key pair now what do you do with",
    "start": "824399",
    "end": "827560"
  },
  {
    "text": "an Ami and a key pair you create a brand",
    "start": "827560",
    "end": "830839"
  },
  {
    "text": "new ec2 instance and that's exactly what",
    "start": "830839",
    "end": "833279"
  },
  {
    "text": "the thread actors did they also attached",
    "start": "833279",
    "end": "836240"
  },
  {
    "text": "the pre-existing security group that",
    "start": "836240",
    "end": "838160"
  },
  {
    "text": "already allowed Port 22 for the SSH",
    "start": "838160",
    "end": "841839"
  },
  {
    "text": "access now the thread actors did not",
    "start": "841839",
    "end": "844600"
  },
  {
    "text": "just do all of their work in the same",
    "start": "844600",
    "end": "846399"
  },
  {
    "text": "regions that these organizations had",
    "start": "846399",
    "end": "848199"
  },
  {
    "text": "these their infrastructure they actually",
    "start": "848199",
    "end": "850920"
  },
  {
    "text": "changed regions to non-used regions and",
    "start": "850920",
    "end": "853639"
  },
  {
    "text": "performed actions there as well the",
    "start": "853639",
    "end": "856000"
  },
  {
    "text": "first thing they did was create a brand",
    "start": "856000",
    "end": "857600"
  },
  {
    "text": "new security group that allowed Port 22",
    "start": "857600",
    "end": "860120"
  },
  {
    "text": "for the SSH access from there they",
    "start": "860120",
    "end": "863160"
  },
  {
    "text": "reimported a key pair and because it's a",
    "start": "863160",
    "end": "865920"
  },
  {
    "text": "different region they couldn't use the",
    "start": "865920",
    "end": "867480"
  },
  {
    "text": "key pair they already imported",
    "start": "867480",
    "end": "869199"
  },
  {
    "text": "so again they had to make a new one and",
    "start": "869199",
    "end": "871880"
  },
  {
    "text": "with that they created a brand new ec2",
    "start": "871880",
    "end": "874040"
  },
  {
    "text": "instance but this time they used the Ami",
    "start": "874040",
    "end": "877240"
  },
  {
    "text": "that was publicly accessible from the",
    "start": "877240",
    "end": "879040"
  },
  {
    "text": "ews",
    "start": "879040",
    "end": "880360"
  },
  {
    "text": "marketplace one thing I do want to note",
    "start": "880360",
    "end": "882639"
  },
  {
    "text": "is that these thread actors did not have",
    "start": "882639",
    "end": "884360"
  },
  {
    "text": "to create new vpcs they used the default",
    "start": "884360",
    "end": "887079"
  },
  {
    "text": "vpcs that are available in every region",
    "start": "887079",
    "end": "889759"
  },
  {
    "text": "and they also did not change anything",
    "start": "889759",
    "end": "891399"
  },
  {
    "text": "with the network",
    "start": "891399",
    "end": "892680"
  },
  {
    "text": "configuration we'll talk about this in",
    "start": "892680",
    "end": "894680"
  },
  {
    "text": "the recommendation section but this is a",
    "start": "894680",
    "end": "896680"
  },
  {
    "text": "great example of why we recommend",
    "start": "896680",
    "end": "898880"
  },
  {
    "text": "enabling G Duty and other services in",
    "start": "898880",
    "end": "901560"
  },
  {
    "text": "all regions by default there's nothing",
    "start": "901560",
    "end": "904920"
  },
  {
    "text": "stopping threat actors or anyone else",
    "start": "904920",
    "end": "907040"
  },
  {
    "text": "from that matter from creating resources",
    "start": "907040",
    "end": "909480"
  },
  {
    "text": "in different regions and so you want to",
    "start": "909480",
    "end": "911600"
  },
  {
    "text": "make sure that your security protections",
    "start": "911600",
    "end": "913279"
  },
  {
    "text": "are in place",
    "start": "913279",
    "end": "915519"
  },
  {
    "text": "accordingly for the privilege escalation",
    "start": "915519",
    "end": "917920"
  },
  {
    "text": "portion of this attack we did not see",
    "start": "917920",
    "end": "920120"
  },
  {
    "text": "the thread actors try to create new IM",
    "start": "920120",
    "end": "922199"
  },
  {
    "text": "users like we have seen in other cases",
    "start": "922199",
    "end": "925120"
  },
  {
    "text": "instead we just saw the threat actors",
    "start": "925120",
    "end": "926800"
  },
  {
    "text": "attempt to log in as rout they did take",
    "start": "926800",
    "end": "929920"
  },
  {
    "text": "the information that they obtained from",
    "start": "929920",
    "end": "932240"
  },
  {
    "text": "the organization API calls and they use",
    "start": "932240",
    "end": "934880"
  },
  {
    "text": "that to try to log in as rout luckily",
    "start": "934880",
    "end": "937600"
  },
  {
    "text": "for these organizations those root",
    "start": "937600",
    "end": "939480"
  },
  {
    "text": "logins did fail I've included an example",
    "start": "939480",
    "end": "942639"
  },
  {
    "text": "of what the cloud TR looks like for that",
    "start": "942639",
    "end": "944160"
  },
  {
    "text": "failed",
    "start": "944160",
    "end": "945319"
  },
  {
    "text": "login and luckily for us as incident",
    "start": "945319",
    "end": "948160"
  },
  {
    "text": "responders when you're looking at these",
    "start": "948160",
    "end": "950079"
  },
  {
    "text": "Cloud TR logs the root login logins",
    "start": "950079",
    "end": "953000"
  },
  {
    "text": "Stand",
    "start": "953000",
    "end": "955399"
  },
  {
    "text": "Out Beyond logging in attempting to log",
    "start": "955399",
    "end": "958399"
  },
  {
    "text": "in route these thread actors did not do",
    "start": "958399",
    "end": "960560"
  },
  {
    "text": "much in the way of persistence the most",
    "start": "960560",
    "end": "962839"
  },
  {
    "text": "clear attempt was creating ec2 instances",
    "start": "962839",
    "end": "966079"
  },
  {
    "text": "in different regions than the rest of",
    "start": "966079",
    "end": "967800"
  },
  {
    "text": "the",
    "start": "967800",
    "end": "968560"
  },
  {
    "text": "infrastructure organizations typically",
    "start": "968560",
    "end": "970920"
  },
  {
    "text": "pick one or two regions to host the",
    "start": "970920",
    "end": "973319"
  },
  {
    "text": "majority of their infrastructure and so",
    "start": "973319",
    "end": "975759"
  },
  {
    "text": "when you're in the AWS console there's",
    "start": "975759",
    "end": "977880"
  },
  {
    "text": "no reason to switch to different regions",
    "start": "977880",
    "end": "979639"
  },
  {
    "text": "to see what resources might exist and so",
    "start": "979639",
    "end": "982240"
  },
  {
    "text": "this does enable longer persistence for",
    "start": "982240",
    "end": "984079"
  },
  {
    "text": "the threat",
    "start": "984079",
    "end": "985279"
  },
  {
    "text": "actor again similarly to those root",
    "start": "985279",
    "end": "987920"
  },
  {
    "text": "login attempts the new ec2 instances in",
    "start": "987920",
    "end": "990560"
  },
  {
    "text": "different regions greatly stood out in",
    "start": "990560",
    "end": "992519"
  },
  {
    "text": "the cloud trail",
    "start": "992519",
    "end": "994759"
  },
  {
    "text": "Logs with these attacks there is",
    "start": "994759",
    "end": "997680"
  },
  {
    "text": "different time periods between when the",
    "start": "997680",
    "end": "999360"
  },
  {
    "text": "compromise happened and when these",
    "start": "999360",
    "end": "1001160"
  },
  {
    "text": "organizations knew that they had an",
    "start": "1001160",
    "end": "1002800"
  },
  {
    "text": "issue and this is exactly when the",
    "start": "1002800",
    "end": "1005000"
  },
  {
    "text": "thread actors need to be stealthy in",
    "start": "1005000",
    "end": "1006800"
  },
  {
    "text": "order to evade defenses we saw them",
    "start": "1006800",
    "end": "1009600"
  },
  {
    "text": "deploy resources in non-standard regions",
    "start": "1009600",
    "end": "1012880"
  },
  {
    "text": "well we also noticed that thread actors",
    "start": "1012880",
    "end": "1014800"
  },
  {
    "text": "turned ec2 instances on and off there's",
    "start": "1014800",
    "end": "1018480"
  },
  {
    "text": "there's a couple reasons they might do",
    "start": "1018480",
    "end": "1020319"
  },
  {
    "text": "this the first one is visibility when",
    "start": "1020319",
    "end": "1023519"
  },
  {
    "text": "you're in the AWS console on the ec2",
    "start": "1023519",
    "end": "1026120"
  },
  {
    "text": "page it defaults to showing only running",
    "start": "1026120",
    "end": "1028360"
  },
  {
    "text": "ec2 instances and so unless you're",
    "start": "1028360",
    "end": "1031000"
  },
  {
    "text": "explicitly looking for non-running ec2",
    "start": "1031000",
    "end": "1033240"
  },
  {
    "text": "instances the threat actor instances",
    "start": "1033240",
    "end": "1035880"
  },
  {
    "text": "will stay hidden once they're in a",
    "start": "1035880",
    "end": "1037520"
  },
  {
    "text": "stopped",
    "start": "1037520",
    "end": "1039520"
  },
  {
    "text": "State the stopped State also serves the",
    "start": "1039520",
    "end": "1042240"
  },
  {
    "text": "dual purpose of not incurring extra",
    "start": "1042240",
    "end": "1044760"
  },
  {
    "text": "costs if an organization has tight",
    "start": "1044760",
    "end": "1047520"
  },
  {
    "text": "notification around costs once an ec2",
    "start": "1047520",
    "end": "1050880"
  },
  {
    "text": "instance is placed in that stop state it",
    "start": "1050880",
    "end": "1053280"
  },
  {
    "text": "does not incur extra costs and is",
    "start": "1053280",
    "end": "1055280"
  },
  {
    "text": "another way to evade defenses in these",
    "start": "1055280",
    "end": "1058080"
  },
  {
    "text": "cases we did not see the threat actors",
    "start": "1058080",
    "end": "1060000"
  },
  {
    "text": "attempt to perform other defensive",
    "start": "1060000",
    "end": "1061720"
  },
  {
    "text": "evasion techniques such as stopping",
    "start": "1061720",
    "end": "1063760"
  },
  {
    "text": "cloud trail or disabling guard",
    "start": "1063760",
    "end": "1066799"
  },
  {
    "text": "Duty that wraps up the case walkthrough",
    "start": "1066799",
    "end": "1069880"
  },
  {
    "text": "at a high level we saw the initial",
    "start": "1069880",
    "end": "1071760"
  },
  {
    "text": "compromise with the sugar serum",
    "start": "1071760",
    "end": "1073640"
  },
  {
    "text": "vulnerability and we saw the threat",
    "start": "1073640",
    "end": "1075440"
  },
  {
    "text": "actors grab access keys from the",
    "start": "1075440",
    "end": "1077559"
  },
  {
    "text": "compromise host",
    "start": "1077559",
    "end": "1079120"
  },
  {
    "text": "this allowed them to move laterally to",
    "start": "1079120",
    "end": "1080840"
  },
  {
    "text": "the control plane these keys were stored",
    "start": "1080840",
    "end": "1083400"
  },
  {
    "text": "in plain text so super easy for the",
    "start": "1083400",
    "end": "1085360"
  },
  {
    "text": "thread actors to grab them and then use",
    "start": "1085360",
    "end": "1087360"
  },
  {
    "text": "them for Discovery activity the most",
    "start": "1087360",
    "end": "1089840"
  },
  {
    "text": "interesting piece around Discovery was",
    "start": "1089840",
    "end": "1091640"
  },
  {
    "text": "the organizations and the cost and usage",
    "start": "1091640",
    "end": "1093840"
  },
  {
    "text": "API calls from there the thread actors",
    "start": "1093840",
    "end": "1096720"
  },
  {
    "text": "made public RDS databases as well as",
    "start": "1096720",
    "end": "1099679"
  },
  {
    "text": "created resources in a bunch of",
    "start": "1099679",
    "end": "1101440"
  },
  {
    "text": "different regions we also saw the thread",
    "start": "1101440",
    "end": "1104080"
  },
  {
    "text": "actors stop and start those resources to",
    "start": "1104080",
    "end": "1106559"
  },
  {
    "text": "attempt to evade detection",
    "start": "1106559",
    "end": "1109200"
  },
  {
    "text": "and finally we saw them attempt to log",
    "start": "1109200",
    "end": "1111120"
  },
  {
    "text": "in as route for privilege",
    "start": "1111120",
    "end": "1113640"
  },
  {
    "text": "escalation for the attack overall we saw",
    "start": "1113640",
    "end": "1116880"
  },
  {
    "text": "the cases take anywhere between 21 and",
    "start": "1116880",
    "end": "1119480"
  },
  {
    "text": "27 days but for the AWS specific",
    "start": "1119480",
    "end": "1122760"
  },
  {
    "text": "portions of these attacks they took only",
    "start": "1122760",
    "end": "1125039"
  },
  {
    "text": "between two and 4",
    "start": "1125039",
    "end": "1127200"
  },
  {
    "text": "days for our remediation steps we're",
    "start": "1127200",
    "end": "1129840"
  },
  {
    "text": "going to cover a few different topics",
    "start": "1129840",
    "end": "1132120"
  },
  {
    "text": "we're going to talk about various ways",
    "start": "1132120",
    "end": "1133679"
  },
  {
    "text": "to protect those access Keys as well as",
    "start": "1133679",
    "end": "1136039"
  },
  {
    "text": "the importance of writing granular IM",
    "start": "1136039",
    "end": "1138880"
  },
  {
    "text": "policies we'll also talk about the",
    "start": "1138880",
    "end": "1141000"
  },
  {
    "text": "importance of monitoring root as well as",
    "start": "1141000",
    "end": "1143520"
  },
  {
    "text": "enabling other Security",
    "start": "1143520",
    "end": "1145720"
  },
  {
    "text": "Services let's start with how to protect",
    "start": "1145720",
    "end": "1147960"
  },
  {
    "text": "those access Keys We constantly see",
    "start": "1147960",
    "end": "1150880"
  },
  {
    "text": "access Keys be the root cause of these",
    "start": "1150880",
    "end": "1152960"
  },
  {
    "text": "AWS cases and so it is vital that they",
    "start": "1152960",
    "end": "1155600"
  },
  {
    "text": "are used",
    "start": "1155600",
    "end": "1156720"
  },
  {
    "text": "correctly I would love to say just don't",
    "start": "1156720",
    "end": "1159280"
  },
  {
    "text": "use them but that's not the world we",
    "start": "1159280",
    "end": "1161159"
  },
  {
    "text": "live in tons of applications and",
    "start": "1161159",
    "end": "1163679"
  },
  {
    "text": "processes still depend on hard-coded",
    "start": "1163679",
    "end": "1165799"
  },
  {
    "text": "access keys and so this is the fine line",
    "start": "1165799",
    "end": "1168280"
  },
  {
    "text": "between usability and security what we",
    "start": "1168280",
    "end": "1171280"
  },
  {
    "text": "recommend though is not storing them on",
    "start": "1171280",
    "end": "1173000"
  },
  {
    "text": "the host themselves if someone does log",
    "start": "1173000",
    "end": "1175520"
  },
  {
    "text": "onto a host and they store credentials",
    "start": "1175520",
    "end": "1177480"
  },
  {
    "text": "in this credentials file we recommend",
    "start": "1177480",
    "end": "1179640"
  },
  {
    "text": "that they clean up after themselves when",
    "start": "1179640",
    "end": "1182039"
  },
  {
    "text": "they're done or a process exists at an",
    "start": "1182039",
    "end": "1184640"
  },
  {
    "text": "organizational level that goes through",
    "start": "1184640",
    "end": "1186640"
  },
  {
    "text": "and cleans up these credentials files",
    "start": "1186640",
    "end": "1189240"
  },
  {
    "text": "that way if a thread actor does",
    "start": "1189240",
    "end": "1190799"
  },
  {
    "text": "compromise the host there's not access",
    "start": "1190799",
    "end": "1192880"
  },
  {
    "text": "Keys lying around we also recommend that",
    "start": "1192880",
    "end": "1196120"
  },
  {
    "text": "you rotate them on a schedule the longer",
    "start": "1196120",
    "end": "1198799"
  },
  {
    "text": "lived an axis key the more chance it has",
    "start": "1198799",
    "end": "1201400"
  },
  {
    "text": "of being compromised and so you want to",
    "start": "1201400",
    "end": "1203640"
  },
  {
    "text": "consistently rotate them and delete",
    "start": "1203640",
    "end": "1206520"
  },
  {
    "text": "unused access keys to help protect your",
    "start": "1206520",
    "end": "1209200"
  },
  {
    "text": "ads account the best part is all of this",
    "start": "1209200",
    "end": "1212760"
  },
  {
    "text": "can be",
    "start": "1212760",
    "end": "1214600"
  },
  {
    "text": "automated along the lines of access Keys",
    "start": "1214600",
    "end": "1217200"
  },
  {
    "text": "we have to talk about permissions",
    "start": "1217200",
    "end": "1218919"
  },
  {
    "text": "attached to users the threat actors were",
    "start": "1218919",
    "end": "1221640"
  },
  {
    "text": "able to accomplish all that they could",
    "start": "1221640",
    "end": "1223559"
  },
  {
    "text": "in these cases due to expansive",
    "start": "1223559",
    "end": "1225720"
  },
  {
    "text": "permissions attached to these users I",
    "start": "1225720",
    "end": "1228480"
  },
  {
    "text": "know it's much easier to write wide",
    "start": "1228480",
    "end": "1230360"
  },
  {
    "text": "openen policies and permissions but it's",
    "start": "1230360",
    "end": "1232840"
  },
  {
    "text": "absolutely worth spending the extra time",
    "start": "1232840",
    "end": "1235240"
  },
  {
    "text": "to write and maintained narrowly scoped",
    "start": "1235240",
    "end": "1238240"
  },
  {
    "text": "permissions uh to help protect your adws",
    "start": "1238240",
    "end": "1241240"
  },
  {
    "text": "account I will say there's a ton of",
    "start": "1241240",
    "end": "1243400"
  },
  {
    "text": "resources online for how to write them",
    "start": "1243400",
    "end": "1245360"
  },
  {
    "text": "and AWS has their IM access analyzer",
    "start": "1245360",
    "end": "1248240"
  },
  {
    "text": "tool as well but one thing I do want to",
    "start": "1248240",
    "end": "1251360"
  },
  {
    "text": "note is that if a product says that they",
    "start": "1251360",
    "end": "1254360"
  },
  {
    "text": "need expansive permissions such as the",
    "start": "1254360",
    "end": "1256919"
  },
  {
    "text": "example on the left where it looks looks",
    "start": "1256919",
    "end": "1258280"
  },
  {
    "text": "like service star it is not worth the",
    "start": "1258280",
    "end": "1261159"
  },
  {
    "text": "security of your account to not narrow",
    "start": "1261159",
    "end": "1263559"
  },
  {
    "text": "the scope of those permissions to",
    "start": "1263559",
    "end": "1265360"
  },
  {
    "text": "exactly what this user needs such as the",
    "start": "1265360",
    "end": "1267960"
  },
  {
    "text": "example on the",
    "start": "1267960",
    "end": "1270880"
  },
  {
    "text": "right one thing we also recommend is",
    "start": "1271520",
    "end": "1274159"
  },
  {
    "text": "enabling monitoring around route it",
    "start": "1274159",
    "end": "1276840"
  },
  {
    "text": "should not be used other than a handful",
    "start": "1276840",
    "end": "1279159"
  },
  {
    "text": "of account management tasks and so it's",
    "start": "1279159",
    "end": "1281640"
  },
  {
    "text": "a super high fidelity for your most",
    "start": "1281640",
    "end": "1284279"
  },
  {
    "text": "valuable account on the left is a",
    "start": "1284279",
    "end": "1286799"
  },
  {
    "text": "cloudwatch metrics that provides that",
    "start": "1286799",
    "end": "1289120"
  },
  {
    "text": "you can turn into an alert and as a side",
    "start": "1289120",
    "end": "1292320"
  },
  {
    "text": "note please please please always enable",
    "start": "1292320",
    "end": "1294840"
  },
  {
    "text": "MFA on Route there's no restrictions to",
    "start": "1294840",
    "end": "1297799"
  },
  {
    "text": "what R can do so you really want to",
    "start": "1297799",
    "end": "1299760"
  },
  {
    "text": "protect it with MFA as well as a long",
    "start": "1299760",
    "end": "1303679"
  },
  {
    "text": "password and last but not least let's",
    "start": "1303679",
    "end": "1306279"
  },
  {
    "text": "talk about logging there were gaps in",
    "start": "1306279",
    "end": "1308799"
  },
  {
    "text": "these cases due to insufficient logging",
    "start": "1308799",
    "end": "1311159"
  },
  {
    "text": "and Security Services not being enabled",
    "start": "1311159",
    "end": "1314120"
  },
  {
    "text": "we can always pull the default 90 days",
    "start": "1314120",
    "end": "1316440"
  },
  {
    "text": "from the cloud trail API but it's a lot",
    "start": "1316440",
    "end": "1319000"
  },
  {
    "text": "more helpful to have a full history of",
    "start": "1319000",
    "end": "1320679"
  },
  {
    "text": "an account we also recommend enabling",
    "start": "1320679",
    "end": "1323600"
  },
  {
    "text": "guard Duty and making sure those those",
    "start": "1323600",
    "end": "1326559"
  },
  {
    "text": "alerts are actually sent to teams that",
    "start": "1326559",
    "end": "1328400"
  },
  {
    "text": "will respond to them based off of",
    "start": "1328400",
    "end": "1330600"
  },
  {
    "text": "severity in the cases that had guard",
    "start": "1330600",
    "end": "1333080"
  },
  {
    "text": "Duty enabled it did indeed catch these",
    "start": "1333080",
    "end": "1335720"
  },
  {
    "text": "access keys that were compromised and",
    "start": "1335720",
    "end": "1337720"
  },
  {
    "text": "it's just another great way to protect",
    "start": "1337720",
    "end": "1339279"
  },
  {
    "text": "your accounts with both cloud trail and",
    "start": "1339279",
    "end": "1342320"
  },
  {
    "text": "guard Duty we recommend enabling them in",
    "start": "1342320",
    "end": "1344520"
  },
  {
    "text": "all regions again as you saw in these",
    "start": "1344520",
    "end": "1347159"
  },
  {
    "text": "cases the threat vors did not just stay",
    "start": "1347159",
    "end": "1349120"
  },
  {
    "text": "in one region so why would you only try",
    "start": "1349120",
    "end": "1351279"
  },
  {
    "text": "to protect and monitor the regions that",
    "start": "1351279",
    "end": "1353279"
  },
  {
    "text": "your infrastructure are in we also",
    "start": "1353279",
    "end": "1356360"
  },
  {
    "text": "recommend the enable VPC flow logs again",
    "start": "1356360",
    "end": "1359559"
  },
  {
    "text": "you saw that was super helpful for data",
    "start": "1359559",
    "end": "1361440"
  },
  {
    "text": "accelration but it's also helpful for",
    "start": "1361440",
    "end": "1363679"
  },
  {
    "text": "General Network",
    "start": "1363679",
    "end": "1365480"
  },
  {
    "text": "troubleshooting for all of these logs",
    "start": "1365480",
    "end": "1367640"
  },
  {
    "text": "you do want to make sure you have a good",
    "start": "1367640",
    "end": "1369120"
  },
  {
    "text": "retention period compromise can even",
    "start": "1369120",
    "end": "1371600"
  },
  {
    "text": "happen in your development account and",
    "start": "1371600",
    "end": "1373679"
  },
  {
    "text": "so you want to make sure that you have",
    "start": "1373679",
    "end": "1375120"
  },
  {
    "text": "the logs around long enough so when you",
    "start": "1375120",
    "end": "1378159"
  },
  {
    "text": "do recognize you have an issue you have",
    "start": "1378159",
    "end": "1380039"
  },
  {
    "text": "the logs that you need to help",
    "start": "1380039",
    "end": "1383120"
  },
  {
    "text": "respond before I wrap it up I wanted to",
    "start": "1383120",
    "end": "1385679"
  },
  {
    "text": "cover a few key takeaways you always",
    "start": "1385679",
    "end": "1388520"
  },
  {
    "text": "want to make sure that you clean up and",
    "start": "1388520",
    "end": "1390520"
  },
  {
    "text": "monitor those access Keys they're",
    "start": "1390520",
    "end": "1392799"
  },
  {
    "text": "extremely valuable in AWS and you want",
    "start": "1392799",
    "end": "1395240"
  },
  {
    "text": "to do what you can to protect them you",
    "start": "1395240",
    "end": "1398120"
  },
  {
    "text": "also want to make sure to monitor for",
    "start": "1398120",
    "end": "1400039"
  },
  {
    "text": "abnormal activity in these cases",
    "start": "1400039",
    "end": "1403240"
  },
  {
    "text": "everything that we talked about today",
    "start": "1403240",
    "end": "1405159"
  },
  {
    "text": "was visible in the cloud CH logs and",
    "start": "1405159",
    "end": "1407679"
  },
  {
    "text": "it's all detectable so you want to make",
    "start": "1407679",
    "end": "1409720"
  },
  {
    "text": "sure that you stay vigilant for when",
    "start": "1409720",
    "end": "1411600"
  },
  {
    "text": "this does happen in your account you",
    "start": "1411600",
    "end": "1414159"
  },
  {
    "text": "also want to make sure you enforce",
    "start": "1414159",
    "end": "1415520"
  },
  {
    "text": "granular permissions if the",
    "start": "1415520",
    "end": "1417760"
  },
  {
    "text": "organizations has scoped the permissions",
    "start": "1417760",
    "end": "1419919"
  },
  {
    "text": "for these compromised users to exactly",
    "start": "1419919",
    "end": "1422440"
  },
  {
    "text": "what was needed in these cases it would",
    "start": "1422440",
    "end": "1424480"
  },
  {
    "text": "have stopped these thread actors in",
    "start": "1424480",
    "end": "1426400"
  },
  {
    "text": "their",
    "start": "1426400",
    "end": "1427960"
  },
  {
    "text": "tracks that wraps up my presentation for",
    "start": "1427960",
    "end": "1430559"
  },
  {
    "text": "today I hope you enjoyed it and learned",
    "start": "1430559",
    "end": "1432840"
  },
  {
    "text": "something new along the way thank",
    "start": "1432840",
    "end": "1436360"
  },
  {
    "text": "you",
    "start": "1436880",
    "end": "1439880"
  }
]