[
  {
    "start": "0",
    "end": "62000"
  },
  {
    "text": "[Music]",
    "start": "1570",
    "end": "29670"
  },
  {
    "text": "so the objectives and what I want to cover today is a very a somewhat narrow",
    "start": "31279",
    "end": "36440"
  },
  {
    "text": "topic web application session strength and what what that really implies is how how is session management handled in a",
    "start": "36440",
    "end": "43120"
  },
  {
    "text": "web application and how can it be handled po what happens when it's handled poorly how can it be handled",
    "start": "43120",
    "end": "49440"
  },
  {
    "text": "well and uh some of the implications basically those implications are going to be you know impersonating someone",
    "start": "49440",
    "end": "55280"
  },
  {
    "text": "else or stealing someone else's information be it username and password email address financial",
    "start": "55280",
    "end": "61199"
  },
  {
    "text": "information one of the important things that I think uh I wanted to talk about session strength was that it's not like",
    "start": "61199",
    "end": "67080"
  },
  {
    "start": "62000",
    "end": "118000"
  },
  {
    "text": "syntax errors uh the well-known the well-known attacks are SQL injection and HTML injection or cross-site scripting",
    "start": "67080",
    "end": "74200"
  },
  {
    "text": "and those are very easy attacks to to launch they're easy attacks to to look at because they just they they just rely",
    "start": "74200",
    "end": "81439"
  },
  {
    "text": "on modifying the syntax of of a URL you know insert insert an apostrophe here",
    "start": "81439",
    "end": "86960"
  },
  {
    "text": "insert a couple script tags there and you have an attack that successful I think those are those are valid but it's",
    "start": "86960",
    "end": "92880"
  },
  {
    "text": "also important to understand that even if you have good input validation filters that's not necessarily going to",
    "start": "92880",
    "end": "98600"
  },
  {
    "text": "defend your application as much as you need it to so as I was saying uh syntax errors",
    "start": "98600",
    "end": "104600"
  },
  {
    "text": "are are pretty they're they're very common they're somewhat easy to fix from the perspective of coding you can apply",
    "start": "104600",
    "end": "110799"
  },
  {
    "text": "uh input validation filters throughout your system now I'm going to take a one quick Divergence here and if anyone's",
    "start": "110799",
    "end": "116320"
  },
  {
    "text": "familiar with Windows XP and uh the issue of raw socket that uh Windows XP is a security measure",
    "start": "116320",
    "end": "122560"
  },
  {
    "start": "118000",
    "end": "173000"
  },
  {
    "text": "is considering dropping raw socket support from uh the Service Pack 2 now",
    "start": "122560",
    "end": "128039"
  },
  {
    "text": "whatever your opinion is about this you may or may not agree that we could do the same thing we could also improve security by dropping apostrophe support",
    "start": "128039",
    "end": "135920"
  },
  {
    "text": "from Internet Explorer or even inter or even from IIs so for example uh like raw",
    "start": "135920",
    "end": "142080"
  },
  {
    "text": "sockets raw sockets you know you hack you have to hack into a site through a core configuration buffer overflow",
    "start": "142080",
    "end": "148040"
  },
  {
    "text": "something like that then raw sockets allowed you to run an IRC or run a distributed denial service if we removed",
    "start": "148040",
    "end": "154519"
  },
  {
    "text": "if we remove the apostrophe from IAS or the apostrophe from Internet Explorer voila our security woes would be over",
    "start": "154519",
    "end": "161640"
  },
  {
    "text": "and just in case you aren't familiar with the the the raw sockets uh issues and security implications I am being a",
    "start": "161640",
    "end": "167480"
  },
  {
    "text": "little bit sarcastic with that so if you do decide to email Microsoft don't blame",
    "start": "167480",
    "end": "173239"
  },
  {
    "start": "173000",
    "end": "225000"
  },
  {
    "text": "me let's go back to session state so quick overview session state is",
    "start": "173239",
    "end": "178959"
  },
  {
    "text": "necessary because HTTP is a stateless protocol all the information receives",
    "start": "178959",
    "end": "184080"
  },
  {
    "text": "are very discret packets so that just basically means that you're you're going to Amazon and you're buying a book",
    "start": "184080",
    "end": "190200"
  },
  {
    "text": "you're putting that book in your cart you decide to go to checkout but then you want to add another book so you add",
    "start": "190200",
    "end": "195519"
  },
  {
    "text": "another book to your cart maybe you add some DVDs or maybe you add something else to the cart and through all this",
    "start": "195519",
    "end": "201000"
  },
  {
    "text": "through all out all this transaction the web server has to keep track that uh",
    "start": "201000",
    "end": "206519"
  },
  {
    "text": "that Joe is putting all of Joe's uh books into one cart and Alice is putting",
    "start": "206519",
    "end": "212080"
  },
  {
    "text": "all of her books into another cart and basically have to keep that information separate especially because when you go",
    "start": "212080",
    "end": "217360"
  },
  {
    "text": "to the checkout process Joe should not be presented with Alice's uh credit card",
    "start": "217360",
    "end": "224159"
  },
  {
    "text": "information and one final note I will throughout I'll talk about session tokens because session cookies there",
    "start": "224159",
    "end": "231080"
  },
  {
    "start": "225000",
    "end": "255000"
  },
  {
    "text": "there's there's a very specific definition of a session cookie they're only valid while a browser is open while a browser exists and many times web",
    "start": "231080",
    "end": "238360"
  },
  {
    "text": "applications will handle sessions with that cookie but there are many other places where the session token in other",
    "start": "238360",
    "end": "244560"
  },
  {
    "text": "words that identifier that identifies the user to the server can be tracked it can be tracked within form form Fields",
    "start": "244560",
    "end": "251280"
  },
  {
    "text": "it can be tracked within headers and it can also be tracked within cookies so what's the what are the",
    "start": "251280",
    "end": "258239"
  },
  {
    "start": "255000",
    "end": "388000"
  },
  {
    "text": "threats why should we worry about session session strength session security the goal of the attack is you",
    "start": "258239",
    "end": "264000"
  },
  {
    "text": "want to access information under someone else's credentials and this is similar to brute 4 very similar to guessing",
    "start": "264000",
    "end": "270800"
  },
  {
    "text": "someone's username and password but it can actually be somewhat simpler than having to guess two different types of",
    "start": "270800",
    "end": "276720"
  },
  {
    "text": "two pieces of information you don't have to necessarily you don't have to know a valid account name and a valid password",
    "start": "276720",
    "end": "282400"
  },
  {
    "text": "if I want to tack Alice I have to find out Alice's username and Alice's password however if I want to do a",
    "start": "282400",
    "end": "288720"
  },
  {
    "text": "session attack and I want to actually attack the session identifier the session cookie that identifies Alice",
    "start": "288720",
    "end": "294759"
  },
  {
    "text": "perhaps I just need to guess a simp a single random number perhaps that r that number isn't isn't too random and we can",
    "start": "294759",
    "end": "301080"
  },
  {
    "text": "guess it based on time stamps or something like that by the same token we can't necessarily attack one particular",
    "start": "301080",
    "end": "307560"
  },
  {
    "text": "user uh if we wanted to attack Alice we would log in with Alice's username then we' try and guess different passwords",
    "start": "307560",
    "end": "313840"
  },
  {
    "text": "however with lots of Brute Force session attacks you you have a larger Target pool because you're just guessing",
    "start": "313840",
    "end": "318960"
  },
  {
    "text": "numbers so you're not necessarily going to get Alice you might get Bob or Charles but either way you're going to get someone else's uh critical",
    "start": "318960",
    "end": "326919"
  },
  {
    "text": "information uh additionally too you don't have to Target a single page in the web application for example using a",
    "start": "326919",
    "end": "333759"
  },
  {
    "text": "Brute Force attack you have to Target the username and password login page with a session ID you just have to",
    "start": "333759",
    "end": "340280"
  },
  {
    "text": "attack a part of the web application one of the URLs that that accepts that session cookie that could be when you",
    "start": "340280",
    "end": "346319"
  },
  {
    "text": "view your profile it could be on a checkout page it could be on the it could be on the login page it could be",
    "start": "346319",
    "end": "351759"
  },
  {
    "text": "on the homepage it's any so what that implies is that this type of attack this",
    "start": "351759",
    "end": "357080"
  },
  {
    "text": "type of Brute Force attack is a lot hard can be a lot harder to identify based on heris sixs because you're not going to",
    "start": "357080",
    "end": "363440"
  },
  {
    "text": "you don't have to make a thousand requests for the same login.asp for example you can distribute those",
    "start": "363440",
    "end": "368520"
  },
  {
    "text": "thousand requests amongst 50 or 100 different URLs um and finally uh session IDs are",
    "start": "368520",
    "end": "376720"
  },
  {
    "text": "better uh should be better than usernames and passwords because you can control the key space you can control",
    "start": "376720",
    "end": "382840"
  },
  {
    "text": "the entropy of the values and how random these values are going to be so do a",
    "start": "382840",
    "end": "388800"
  },
  {
    "start": "388000",
    "end": "457000"
  },
  {
    "text": "quick talk about spaces and what I mean by that if you have a username let's just imagine that your username uh",
    "start": "388800",
    "end": "394840"
  },
  {
    "text": "should be six characters you have 64 symbols which is pretty much a alpha numeric and perhaps the at symbol with",
    "start": "394840",
    "end": "401280"
  },
  {
    "text": "that your your key space is about 36 bits large your if your password can be alpha numeric and add punctuation you",
    "start": "401280",
    "end": "409000"
  },
  {
    "text": "have about 96 different characters you have a key space that's about 40 bits big when you talk about session IDs",
    "start": "409000",
    "end": "415960"
  },
  {
    "text": "often the r those random values they're just going to be a 32-bit value or 64 bit or 128 or 256 value now those sound",
    "start": "415960",
    "end": "424240"
  },
  {
    "text": "large but those aren't necessarily large for example 12 128bit value can be easily created with an md5 hash same",
    "start": "424240",
    "end": "431280"
  },
  {
    "text": "with the sh uh the 256 Val bit value can be created with a shaash but I'll show a",
    "start": "431280",
    "end": "437080"
  },
  {
    "text": "little bit later that just because you have a large amount of bits does not mean that you have a very large amount",
    "start": "437080",
    "end": "442360"
  },
  {
    "text": "of entropy and it doesn't mean that your session IDs that are supposed to be random are actually well protected",
    "start": "442360",
    "end": "450319"
  },
  {
    "text": "uh this is just another point about key spaces and why uh the the login you want",
    "start": "450639",
    "end": "455800"
  },
  {
    "text": "to you want to you you still want to have a strong username and password to complement your session session strength",
    "start": "455800",
    "end": "462759"
  },
  {
    "start": "457000",
    "end": "539000"
  },
  {
    "text": "because humans are very poor entropy generators you can they'll have poor passwords you know your username is",
    "start": "462759",
    "end": "468520"
  },
  {
    "text": "password or password one or password Fu or you try and you know uh substitute",
    "start": "468520",
    "end": "473560"
  },
  {
    "text": "letters with vowels or numbers and vowels even strict password policies can reduce the key space B and I just threw",
    "start": "473560",
    "end": "480560"
  },
  {
    "text": "a bunch of um notes up there that for example if you had a if you had a strict password policy that said your Char your",
    "start": "480560",
    "end": "488759"
  },
  {
    "text": "uh password must be six characters it must contain one digit and one special",
    "start": "488759",
    "end": "493879"
  },
  {
    "text": "character consider that punctuation your key space is only about 30 bits whereas out of 96 possible symbols it should",
    "start": "493879",
    "end": "501360"
  },
  {
    "text": "have been about uh 40 bits in size so these are still these are still very large numbers it still doesn't mean that",
    "start": "501360",
    "end": "508240"
  },
  {
    "text": "your your uh Brute Force attack is going to be that much easier especially against a website and across a network",
    "start": "508240",
    "end": "513800"
  },
  {
    "text": "but what it means is that you have a very significant reduction in the amount of Randomness or the amount of possible",
    "start": "513800",
    "end": "519680"
  },
  {
    "text": "keys or possible values that an attacker has to guess and it's important to take this type of thinking with and just",
    "start": "519680",
    "end": "526560"
  },
  {
    "text": "Illustrated with usernames and passwords because that's the exact type of uh correlation that I want to make with",
    "start": "526560",
    "end": "532399"
  },
  {
    "text": "random numbers or not so random numbers so we have uh basically three",
    "start": "532399",
    "end": "537800"
  },
  {
    "text": "different types of session attacks you can analyze the token for deterministic string content that means that the",
    "start": "537800",
    "end": "544760"
  },
  {
    "start": "539000",
    "end": "744000"
  },
  {
    "text": "session ID is actually your username or maybe it's your user ID or maybe it's just based on your email address so",
    "start": "544760",
    "end": "550880"
  },
  {
    "text": "after you log in you have to provide your username and password the application accepts you identifies you",
    "start": "550880",
    "end": "557079"
  },
  {
    "text": "as authenticated and then just then just tracks you throughout the application based on your username that's very poor",
    "start": "557079",
    "end": "563320"
  },
  {
    "text": "that can be strong uh user authentication but very poor session management because it's very trivial to",
    "start": "563320",
    "end": "568760"
  },
  {
    "text": "guess someone else username and just go through a list of different email addresses until you get a valid user You",
    "start": "568760",
    "end": "574399"
  },
  {
    "text": "can predict a token with by doing that you basically you're looking for some",
    "start": "574399",
    "end": "579519"
  },
  {
    "text": "mathematical property that it has it may be that it has very low entropy may be based on time stamps maybe permanently",
    "start": "579519",
    "end": "586200"
  },
  {
    "text": "increasing in steps of one or maybe Perman permanently increasing in steps of 100 you can apply some types of um",
    "start": "586200",
    "end": "593800"
  },
  {
    "text": "regression models or some statistical analysis to see hey how random is this token and am I actually going to be able",
    "start": "593800",
    "end": "600160"
  },
  {
    "text": "to model it or model it or or be able to model a very small window so that I only have to make 1,000 guesses in order to",
    "start": "600160",
    "end": "606720"
  },
  {
    "text": "get a hit rather than 50,000 guesses in order to get a hit and finally you can also just guess a token and that way",
    "start": "606720",
    "end": "613600"
  },
  {
    "text": "you're just blindly you You' you you've taken a cookie and you've said well this is what it looks like I'm just going to start messing with values just to see",
    "start": "613600",
    "end": "620200"
  },
  {
    "text": "what happens and you may get lucky and you may not so these are an important",
    "start": "620200",
    "end": "625680"
  },
  {
    "text": "thing about these types of attacks is that what you're attacking at is the server you're directing your attack towards the server but your victim is",
    "start": "625680",
    "end": "632519"
  },
  {
    "text": "actually other users of the application the session attacks are done in order to steal to grab someone else's password or",
    "start": "632519",
    "end": "639680"
  },
  {
    "text": "to grab their personal information or basically to that you know view your personal profile page so you're",
    "start": "639680",
    "end": "645279"
  },
  {
    "text": "attacking someone else much like uh cross-site scripting tends to attack other users of the system rather than",
    "start": "645279",
    "end": "651440"
  },
  {
    "text": "the actual system itself so you're not using a session a session attack to grab",
    "start": "651440",
    "end": "656480"
  },
  {
    "text": "everything out of the database you're doing this to grab other users and what's important is that depending on",
    "start": "656480",
    "end": "662279"
  },
  {
    "text": "how this the token is created and managed that the other users don't have to actually be active on the system so",
    "start": "662279",
    "end": "668560"
  },
  {
    "text": "it's basically just a onet to",
    "start": "668560",
    "end": "671760"
  },
  {
    "text": "one absolutely the question was what about stealing it and I actually have the next slide describing user directed",
    "start": "682720",
    "end": "689519"
  },
  {
    "text": "attacks and in those cases th those types of attacks are just as legitimate against web applications and in that",
    "start": "689519",
    "end": "696040"
  },
  {
    "text": "case you can sniff it sniff it with a if it's clear text TCP dump D sniff on a",
    "start": "696040",
    "end": "701279"
  },
  {
    "text": "wireless network you can sniff it that way you can hijack someone's session as well and you can also just steal it",
    "start": "701279",
    "end": "707959"
  },
  {
    "text": "either if it's in a shared shared internet cafe where you can uh sniff the",
    "start": "707959",
    "end": "713760"
  },
  {
    "text": "browser or you just walk up to the browser after someone has left click the back back button and perhaps they didn't",
    "start": "713760",
    "end": "719079"
  },
  {
    "text": "even log out of the application so there are definitely there are many many different um ways of attacking the",
    "start": "719079",
    "end": "725720"
  },
  {
    "text": "session management and I wanted to focus on the server directed attacks rather than these types of user directed",
    "start": "725720",
    "end": "730800"
  },
  {
    "text": "attacks because uh protecting against sniffing protecting against theft is often can often be dealt with in other",
    "start": "730800",
    "end": "737560"
  },
  {
    "text": "in in other uh layers besides the application layer and in fact it can also be difficult to defend against in",
    "start": "737560",
    "end": "743199"
  },
  {
    "text": "the application layer so the question is the the main focus is how do I figure out which value",
    "start": "743199",
    "end": "749760"
  },
  {
    "text": "is used as a session token and then what and then how do I figure out if that session token is random how can I figure",
    "start": "749760",
    "end": "755800"
  },
  {
    "text": "out if I can predict it or how long is it going to take me to guess a valid token so I'll have I have about four uh",
    "start": "755800",
    "end": "763040"
  },
  {
    "text": "uh live examples that I can that will just talk to describe different the implications of how they manage tokens",
    "start": "763040",
    "end": "768920"
  },
  {
    "text": "and what that means so and a lot of this is going to be relative security I don't necessarily",
    "start": "768920",
    "end": "775279"
  },
  {
    "text": "believe that a static token which I'll describe in Define in a littleit bit is any can be more or less secure than a",
    "start": "775279",
    "end": "782000"
  },
  {
    "text": "dynamic token and vice versa there's that it's it's very relative to the implementation and how you manage a",
    "start": "782000",
    "end": "788560"
  },
  {
    "text": "session cookie how you manage this uh piece of information because the session token is basically equivalent to a",
    "start": "788560",
    "end": "795519"
  },
  {
    "text": "password it identifies that user and so it has to be treated as a confidential piece of",
    "start": "795519",
    "end": "801760"
  },
  {
    "start": "801000",
    "end": "910000"
  },
  {
    "text": "information so we have two types of of token man token creation I should say rather than token management you can",
    "start": "801760",
    "end": "807880"
  },
  {
    "text": "have a static token what that means is that the whenever you log into a web application you receive the same token",
    "start": "807880",
    "end": "813360"
  },
  {
    "text": "value every single time that means you enter your username and password and on a Monday you're given uh a session ID or",
    "start": "813360",
    "end": "820839"
  },
  {
    "text": "a session token that says mike 12345 or it says Jane 89",
    "start": "820839",
    "end": "827320"
  },
  {
    "text": "897b and if you logged in on and then if you logged out and you logged back in on Wednesday you would get that exact same",
    "start": "827320",
    "end": "832839"
  },
  {
    "text": "token so in other words that session token is static for that particular user now when when that happens you can your",
    "start": "832839",
    "end": "841000"
  },
  {
    "text": "target pool is actually all users of the application if you can figure out how how a token is created then you can say",
    "start": "841000",
    "end": "848360"
  },
  {
    "text": "oh it's the username plus a five-digit random number you can say aha all I need",
    "start": "848360",
    "end": "854279"
  },
  {
    "text": "to do is find out all these people usernames and and a and a five-digit random number because that token is",
    "start": "854279",
    "end": "860959"
  },
  {
    "text": "valid on the on the application 24 hours a day 7 days a week so your target pool",
    "start": "860959",
    "end": "866399"
  },
  {
    "text": "suddenly is increased so if you're launching an attack and you want to try and and you can only and you can send 10,000 guesses per hour then in those",
    "start": "866399",
    "end": "874519"
  },
  {
    "text": "10,000 guesses your chance your chances of of getting a hit are much higher than",
    "start": "874519",
    "end": "879880"
  },
  {
    "text": "if those these values these tokens were actually Dynamic a dynamic token means that you get a different random number",
    "start": "879880",
    "end": "886240"
  },
  {
    "text": "each time you log into the application so you log in on Monday you get a 32-bit number you log out you log in on Tuesday",
    "start": "886240",
    "end": "893320"
  },
  {
    "text": "you get an entirely different number what this implies is that your target pool in other words your the amount of",
    "start": "893320",
    "end": "900000"
  },
  {
    "text": "valid tokens that are available to you when you when you launch your 10,000 10,000 guesses is much smaller so it's",
    "start": "900000",
    "end": "906839"
  },
  {
    "text": "just it's basically plain probability your dart board with a dynamic token tends to be smaller than if you're using",
    "start": "906839",
    "end": "912560"
  },
  {
    "start": "910000",
    "end": "971000"
  },
  {
    "text": "a static token so and that this assumes that you're use that you're creating it",
    "start": "912560",
    "end": "917839"
  },
  {
    "text": "very in a very um uh in a very random manner because you can still then  yourself if you have a dynamic",
    "start": "917839",
    "end": "923040"
  },
  {
    "text": "token that is just simply time of day plus one or time of daytimes two some",
    "start": "923040",
    "end": "928440"
  },
  {
    "text": "type of simple transformation so and and dynamic tokens just to give you an idea of what those",
    "start": "928440",
    "end": "934759"
  },
  {
    "text": "are would be the ASP session ID uh PHP session ID J session ID these are the",
    "start": "934759",
    "end": "940319"
  },
  {
    "text": "types of tokens that are created by the the application engines and then on the co on the code end you actually have a",
    "start": "940319",
    "end": "945920"
  },
  {
    "text": "server object that you can that you can query that you can that you can give users tokens that's the one you",
    "start": "945920",
    "end": "951800"
  },
  {
    "text": "manage so go ahead and and now I want to talk about a couple examples give you some that way we can talk about some",
    "start": "951800",
    "end": "958560"
  },
  {
    "text": "some real life scenarios and give you an idea of what this really means and how this looks like in the Wild on the internet so the first example is a token",
    "start": "958560",
    "end": "965519"
  },
  {
    "text": "in a cookie it's a static token and it's trivially trivially deterministic",
    "start": "965519",
    "end": "970639"
  },
  {
    "text": "content so I'll Define to go over what static is and why it's so",
    "start": "970639",
    "end": "976839"
  },
  {
    "start": "971000",
    "end": "996000"
  },
  {
    "text": "easy you have for example think.com and when you log in it gives you a nice",
    "start": "976839",
    "end": "981920"
  },
  {
    "text": "welcome and it's tells you what your user number is and I have it circled in red there if you can't see the number is",
    "start": "981920",
    "end": "987120"
  },
  {
    "text": "12f 938 9 that's a very simple number it's a um six digit it's 16 digits and",
    "start": "987120",
    "end": "994560"
  },
  {
    "text": "it's heximal now if we if we were look at the token what we would want the cookie",
    "start": "994560",
    "end": "1000399"
  },
  {
    "start": "996000",
    "end": "1018000"
  },
  {
    "text": "value during the request we see that there are several cookies here if we want when we want to automate or if we",
    "start": "1000399",
    "end": "1006519"
  },
  {
    "text": "want to manually go through the process of actually trying to figure out which of these tokens handles the the session",
    "start": "1006519",
    "end": "1012600"
  },
  {
    "text": "we have to go through and we have to say okay we'll submit our request with cookie equals true or we'll we'll delete",
    "start": "1012600",
    "end": "1018519"
  },
  {
    "text": "sorry we'll delete the first cookie send a request and we'll see if we get back this page then we'll delete the second",
    "start": "1018519",
    "end": "1025360"
  },
  {
    "text": "cookie so we'll only be sending two out of the four cookies we'll send the request see if we get back to this page",
    "start": "1025360",
    "end": "1031480"
  },
  {
    "text": "we'll continue to delete cookies until we only get to a combination of one or two cookies that gives us this page in",
    "start": "1031480",
    "end": "1038120"
  },
  {
    "text": "other words a valid page so out of the four cookies that are set in this site",
    "start": "1038120",
    "end": "1043798"
  },
  {
    "text": "only two are required to identify the session one is called The Lucky Monkey and one is the spunky monkey and only of",
    "start": "1043799",
    "end": "1051360"
  },
  {
    "text": "those two only one is required to actually identify a user so in reality what we have here are four cookies two",
    "start": "1051360",
    "end": "1058919"
  },
  {
    "text": "of which are necessary for a session however only one of which is necessary to identify the user so what this means",
    "start": "1058919",
    "end": "1065960"
  },
  {
    "text": "is that if I'm a if I'm a r if I'm an attacker and I want to Target someone randomly I have to I of the four cookies",
    "start": "1065960",
    "end": "1072160"
  },
  {
    "text": "that I receive I only need to guess one of them so what I would do then is I would",
    "start": "1072160",
    "end": "1080640"
  },
  {
    "start": "1075000",
    "end": "1167000"
  },
  {
    "text": "start to sorry I keep switching around is I would take this this cookie string",
    "start": "1080640",
    "end": "1086200"
  },
  {
    "text": "and i' take the Lucky Monkey value here that's 12f 93 A9 I just create a",
    "start": "1086200",
    "end": "1093559"
  },
  {
    "text": "loop I create a value 1 12300 Z and I just increment that for however many",
    "start": "1093559",
    "end": "1099840"
  },
  {
    "text": "times I wish and I keep sending out this request and I try and I'll collect and see whenever I get a hit now I did this",
    "start": "1099840",
    "end": "1107280"
  },
  {
    "text": "and over 10,000 requests I got 27 270 different valid accounts",
    "start": "1107280",
    "end": "1113520"
  },
  {
    "text": "over a period of about 3 hours just because I was doing this requests very slowly so this is an example of very of",
    "start": "1113520",
    "end": "1120200"
  },
  {
    "text": "a static token this Lucky Monkey value is your user ID basically and that's what identifies you when you log in it",
    "start": "1120200",
    "end": "1126679"
  },
  {
    "text": "never changes whether or not you're logged in plus I can attack someone by",
    "start": "1126679",
    "end": "1131880"
  },
  {
    "text": "grabbing their their email addresses by just guessing this value and they don't have to be logged in for example if I",
    "start": "1131880",
    "end": "1137960"
  },
  {
    "text": "was doing a cross scripting attack that was trying to steal their password or steal something about them they would actually have to be logged into the",
    "start": "1137960",
    "end": "1144240"
  },
  {
    "text": "application they would have to navigate to my cross scripting payload and Bam they're HIIT in this case they can be at",
    "start": "1144240",
    "end": "1151840"
  },
  {
    "text": "home asleep in bed and I'm attacking the accounts and I'm collecting email",
    "start": "1151840",
    "end": "1157559"
  },
  {
    "text": "addresses so this is both this is the user identifier and the session identifier are independent in this case",
    "start": "1157559",
    "end": "1165360"
  },
  {
    "text": "in other words you can authenticate to the system and but and you get a username you submit your username and",
    "start": "1165360",
    "end": "1170559"
  },
  {
    "text": "password and the server gives you a token that identifies you however that token is not tied to you actually being",
    "start": "1170559",
    "end": "1176960"
  },
  {
    "text": "successfully authenticated that token is just static every single time so that's really an authorization problem it also",
    "start": "1176960",
    "end": "1183480"
  },
  {
    "text": "implicitly trusts the client side and implicitly trust that you're sending the correct Lucky Monkey value for your",
    "start": "1183480",
    "end": "1189600"
  },
  {
    "text": "username obviously anything sent to the client can be can be uh manipulated so I can simply change the value from me to",
    "start": "1189600",
    "end": "1196240"
  },
  {
    "text": "someone else also the lucky values derived from a very small pool of numbers now 16 to 7th is actually about",
    "start": "1196240",
    "end": "1204320"
  },
  {
    "start": "1203000",
    "end": "1296000"
  },
  {
    "text": "270 Mill 270 million different po different values that sounds like a large number however it's even even with",
    "start": "1204320",
    "end": "1213120"
  },
  {
    "text": "that value if if there are only about 26,000 or 27,000 users of this website",
    "start": "1213120",
    "end": "1220200"
  },
  {
    "text": "if I have if I send 10,000 guesses per hour in one hour I have just about 100%",
    "start": "1220200",
    "end": "1226320"
  },
  {
    "text": "chance of getting at least one valid account and in this case I got about 270 valid accounts so it's very very simple",
    "start": "1226320",
    "end": "1234280"
  },
  {
    "text": "one of the reasons this was an insecured uh token was that it always increased as well so that if I log in and I get 1 two",
    "start": "1234280",
    "end": "1242520"
  },
  {
    "text": "3 4 five is my is my is user ID then all I have to do is wait a week and I know",
    "start": "1242520",
    "end": "1248000"
  },
  {
    "text": "that after a week if any new any new user that is logged into this application has a token that's greater",
    "start": "1248000",
    "end": "1254000"
  },
  {
    "text": "than 1 2 3 4 5 and I log in a week later I see what and create a new account account I see what account number that",
    "start": "1254000",
    "end": "1260720"
  },
  {
    "text": "is and now I have a window between of a starting value and an ending value and perhaps there there's there a range of",
    "start": "1260720",
    "end": "1267880"
  },
  {
    "text": "50,000 potential users I can just Target 50,000 different user IDs until I get a",
    "start": "1267880",
    "end": "1273919"
  },
  {
    "text": "valid one so that's another reason that session tokens should be taken from a uniformly distributed random",
    "start": "1273919",
    "end": "1280720"
  },
  {
    "text": "pool so in this a little bit more about this the attack it's only done in about",
    "start": "1280720",
    "end": "1285919"
  },
  {
    "text": "actually I did 168 minutes of work took two minutes to write us for Loop 160",
    "start": "1285919",
    "end": "1291400"
  },
  {
    "text": "minutes to wait and watch and collect email addresses and of course you can do this this type of attack can be done if",
    "start": "1291400",
    "end": "1297520"
  },
  {
    "text": "you want to do more than one one request per second and you want to do this over instead of a period of two or three",
    "start": "1297520",
    "end": "1303760"
  },
  {
    "text": "hours you can take do it over a period of a week the other problem with the static token is that the attacker is not",
    "start": "1303760",
    "end": "1309840"
  },
  {
    "text": "limited in any way by uh session timeouts it's not limited in any way by",
    "start": "1309840",
    "end": "1315320"
  },
  {
    "text": "activity of the site you can do this in a very uh in a scan that flies below the radar because the user user ID 1 2 3 45",
    "start": "1315320",
    "end": "1323520"
  },
  {
    "text": "is always valid on the on the on the web application so I could do my attack one per hour over a period of a week and",
    "start": "1323520",
    "end": "1330200"
  },
  {
    "text": "perhaps I'm going to get and I'm never going to show up in an IDs log and perhaps I'll get some valid",
    "start": "1330200",
    "end": "1337880"
  },
  {
    "start": "1336000",
    "end": "1353000"
  },
  {
    "text": "hits so we move on to the next one and talking about pepsy and this is a very very simple it talked about this time",
    "start": "1338960",
    "end": "1345679"
  },
  {
    "text": "the the token is encoded and it's actually stored in HTML in an HTML form",
    "start": "1345679",
    "end": "1351120"
  },
  {
    "text": "and a hidden uh form tag so uh just an example of the login page uh which again",
    "start": "1351120",
    "end": "1356799"
  },
  {
    "start": "1353000",
    "end": "1411000"
  },
  {
    "text": "this is just a very simple join Pepsi marketing uh email you know there's",
    "start": "1356799",
    "end": "1362039"
  },
  {
    "text": "nothing too exciting here but it does demonstrate the request now the the uh",
    "start": "1362039",
    "end": "1368240"
  },
  {
    "text": "is actually the HTTP request if you notice in the cookie there are there are",
    "start": "1368240",
    "end": "1373559"
  },
  {
    "text": "two ASP session ID cookies being sent here well at first this looks good",
    "start": "1373559",
    "end": "1378679"
  },
  {
    "text": "because this might this looks like it means that this the the web application is actually relying on the ASP session",
    "start": "1378679",
    "end": "1384640"
  },
  {
    "text": "ID it's using a serers side session management however if we start and look at if we start to play around with it",
    "start": "1384640",
    "end": "1391120"
  },
  {
    "text": "we'll notice that none of the ASP session ID cookies are actually used so they're being set simply because by",
    "start": "1391120",
    "end": "1396320"
  },
  {
    "text": "default IAS is sending them but the application isn't using them so that's that's uh bad stuff number one however",
    "start": "1396320",
    "end": "1404600"
  },
  {
    "text": "you have you do have to have a valid username and password to be able to log in to this system and you can't Target",
    "start": "1404600",
    "end": "1410440"
  },
  {
    "text": "other users just by changing the post data down here in the in the bottom so",
    "start": "1410440",
    "end": "1416240"
  },
  {
    "text": "you actually have to so session management is basically defined by submit your username and password every",
    "start": "1416240",
    "end": "1422720"
  },
  {
    "text": "single time it works for this type of web application because there's only two pages one is to update your profile and",
    "start": "1422720",
    "end": "1428320"
  },
  {
    "text": "the second one is to verify the update so that's why um in this case it's not too bad so the session Integrity is well",
    "start": "1428320",
    "end": "1436200"
  },
  {
    "start": "1434000",
    "end": "1471000"
  },
  {
    "text": "kept however the session confidentiality is still another matter and this is where we have an encoded base 64 value",
    "start": "1436200",
    "end": "1444159"
  },
  {
    "text": "as well as um your your own password in clear text sent in the actual HTML of",
    "start": "1444159",
    "end": "1451679"
  },
  {
    "text": "the website so this illustrates a point where even if you have a strong session",
    "start": "1451679",
    "end": "1457919"
  },
  {
    "text": "management if you're doing everything over HTTP and if you're doing every you you can someone can just sniff the",
    "start": "1457919",
    "end": "1463760"
  },
  {
    "text": "attack and they'll get your username they'll get your password they'll get session information in this case there's",
    "start": "1463760",
    "end": "1469080"
  },
  {
    "text": "a token called session ID and if we do a base 64 decode on it we'll see that that",
    "start": "1469080",
    "end": "1474399"
  },
  {
    "start": "1471000",
    "end": "1501000"
  },
  {
    "text": "there's some interesting stuff in there we have an email address and we have a timestamp so already if there's",
    "start": "1474399",
    "end": "1482039"
  },
  {
    "text": "potentially uh if unfortunately this one doesn't have anything too exciting besides an email address and a timestamp",
    "start": "1482039",
    "end": "1488559"
  },
  {
    "text": "but it shows that encoding is encoding is not necessarily a step for security",
    "start": "1488559",
    "end": "1494520"
  },
  {
    "text": "it's just there to obate something but we can still delve into it and find what type of information is in the web app in",
    "start": "1494520",
    "end": "1500480"
  },
  {
    "text": "the web app a couple more observations about this Pepsi example is that the session",
    "start": "1500480",
    "end": "1508120"
  },
  {
    "text": "ID value doesn't contain any sense of information that's already included elsewhere in plain text for example",
    "start": "1508120",
    "end": "1513919"
  },
  {
    "start": "1512000",
    "end": "1836000"
  },
  {
    "text": "looking at the this HTML snippet you already have the this hidden tag which has your username and another hidden tag",
    "start": "1513919",
    "end": "1520440"
  },
  {
    "text": "that has your password so it doesn't really matter if you have strong session management because everything is done",
    "start": "1520440",
    "end": "1525679"
  },
  {
    "text": "over HTTP and your username and password being echoed back in plain text so this",
    "start": "1525679",
    "end": "1530960"
  },
  {
    "text": "is a type where you need to have strong confidentiality implemented as well as strong uh session",
    "start": "1530960",
    "end": "1537679"
  },
  {
    "text": "management now again in the first in the Think Geek example I was able to log in",
    "start": "1537679",
    "end": "1543559"
  },
  {
    "text": "and get us get my own session uh user ID and then just start replaying other session IDs until I was successful in",
    "start": "1543559",
    "end": "1550200"
  },
  {
    "text": "this case I actually have to every every time I try to guess someone's user ID I",
    "start": "1550200",
    "end": "1555720"
  },
  {
    "text": "actually have to submit their password as well so in this case I'm not going to be able to sit down write a for a simple for Loop and enumerate users of the",
    "start": "1555720",
    "end": "1564200"
  },
  {
    "text": "application uh another example of session management of cookie manipulation or token management is",
    "start": "1564200",
    "end": "1570159"
  },
  {
    "text": "Hotmail and more specifically or more generally is passport in this case uh",
    "start": "1570159",
    "end": "1576559"
  },
  {
    "text": "passport uses two cookies to identify users uses an MSP off cookie and an MSP",
    "start": "1576559",
    "end": "1582880"
  },
  {
    "text": "Prof cookie both of these are base 64 encoded values but they're also",
    "start": "1582880",
    "end": "1588720"
  },
  {
    "text": "encrypted with triple de so they're very secure in other words I'm not going to be able to do what I did with Pepsi and",
    "start": "1588720",
    "end": "1594480"
  },
  {
    "text": "just do a base 64d code and see my email address and see a timestamp so I'm I I",
    "start": "1594480",
    "end": "1600080"
  },
  {
    "text": "would actually have to be able to decrypt this information and see what type of profile is stored here what type",
    "start": "1600080",
    "end": "1605559"
  },
  {
    "text": "of user authentication or authorization or access roles are defined within this",
    "start": "1605559",
    "end": "1610919"
  },
  {
    "text": "cookie so this is a more secure method of uh token management but it also means",
    "start": "1610919",
    "end": "1616520"
  },
  {
    "text": "that you have to have encryption and you have to and which can be a um",
    "start": "1616520",
    "end": "1621840"
  },
  {
    "text": "performance impact on your web application now of course Microsoft and passport are able to throw 10,000 plus",
    "start": "1621840",
    "end": "1627520"
  },
  {
    "text": "web servers and handle a lot of this so they don't have to worry about it as much however there's still threats to",
    "start": "1627520",
    "end": "1633640"
  },
  {
    "text": "this where you can replay these cookies for example these two cookies I've list that I put up here I actually I I",
    "start": "1633640",
    "end": "1639919"
  },
  {
    "text": "changed them a little bit so that they wouldn't be valid but if you were to take two valid MSP Prof and MSP off",
    "start": "1639919",
    "end": "1646880"
  },
  {
    "text": "cookies from someone else you can replay them and you can actually impersonate that user and and basically be there",
    "start": "1646880",
    "end": "1653200"
  },
  {
    "text": "inside their passport account or Hotmail account and not have to have their username and password so this is another",
    "start": "1653200",
    "end": "1659720"
  },
  {
    "text": "example why um session strength and grabbing session cookies and session tokens are a good way to bypass secure",
    "start": "1659720",
    "end": "1667159"
  },
  {
    "text": "uh secure brute force and uh measures iTunes music store is another",
    "start": "1667159",
    "end": "1673080"
  },
  {
    "text": "one that's interesting this this example shows a mix of static and random tokens",
    "start": "1673080",
    "end": "1678480"
  },
  {
    "text": "and instead of being placed within a cookie or instead of being placed within the HTML in a hidden form tag they",
    "start": "1678480",
    "end": "1684760"
  },
  {
    "text": "actually uh iTunes actually creates Uh custom headers so we have the iTunes music store and here's a simple get",
    "start": "1684760",
    "end": "1691679"
  },
  {
    "text": "request for it you can see there's an X token and an XD Sid header that have been set the combination of those two is",
    "start": "1691679",
    "end": "1699559"
  },
  {
    "text": "what is used to handle the user session so if I were able to guess anyone if I were able to guess someone's X token and",
    "start": "1699559",
    "end": "1706440"
  },
  {
    "text": "X Sid value then I could go and look and see what's in their shopping cart for example and and I can impersonate that",
    "start": "1706440",
    "end": "1714200"
  },
  {
    "text": "user and I don't have to guess their username and password so and if we break it down we",
    "start": "1714200",
    "end": "1719240"
  },
  {
    "text": "notice that even though the X token seems to be a very large number it's really just a six it's really just a",
    "start": "1719240",
    "end": "1724960"
  },
  {
    "text": "timestamp and in fact in it's not even a time stamp that's going to be difficult for us to attack that's the random part",
    "start": "1724960",
    "end": "1731640"
  },
  {
    "text": "of this this value there's only 86 there's only 86,400 seconds in a day so",
    "start": "1731640",
    "end": "1737519"
  },
  {
    "text": "that that limits our our our attack pull right there however the the XD Sid token",
    "start": "1737519",
    "end": "1743840"
  },
  {
    "text": "is about a 30 it's an 8 to n digit number it's probably a 32bit number and that's that one is static for everyone",
    "start": "1743840",
    "end": "1750880"
  },
  {
    "text": "and but that one or that sorry that one is random for everyone but what happens is that we have to guess a combination",
    "start": "1750880",
    "end": "1756919"
  },
  {
    "text": "of those two so still we have a very large pool that's going to be difficult for us to attack so this is an example",
    "start": "1756919",
    "end": "1763840"
  },
  {
    "text": "of a mix of a static token and a dynamic token but it's still going to be resistant to us trying to guess what's",
    "start": "1763840",
    "end": "1770080"
  },
  {
    "text": "going on another one uh I think this is my",
    "start": "1770080",
    "end": "1776200"
  },
  {
    "text": "final example slash code uh for example start on slash dot or I just chose to to",
    "start": "1776200",
    "end": "1782039"
  },
  {
    "text": "uh throw up here example Mac slash what this is an example of a static token",
    "start": "1782039",
    "end": "1788200"
  },
  {
    "text": "again that's static for the user every time you log in if you look at the cookie value initially you get a lot of",
    "start": "1788200",
    "end": "1794080"
  },
  {
    "text": "URL encoded characters that once you start decoding them you get basically to",
    "start": "1794080",
    "end": "1799720"
  },
  {
    "text": "a uh five-digit number which is your user ID followed by two colons followed",
    "start": "1799720",
    "end": "1805720"
  },
  {
    "text": "by the md5 some hash of your password now there are two different things about",
    "start": "1805720",
    "end": "1810960"
  },
  {
    "text": "this one is that you can this you can reverse engineer the password that if",
    "start": "1810960",
    "end": "1816720"
  },
  {
    "text": "you were able to get someone else's uh cookie value you can just dump this md5 sum into John the Ripper or something",
    "start": "1816720",
    "end": "1822919"
  },
  {
    "text": "like that and you can brute force their password this offline attack so that's easy and that that's pretty well known",
    "start": "1822919",
    "end": "1829399"
  },
  {
    "text": "uh what I think is what I want to highlight with this is just the why static tokens can be very bad",
    "start": "1829399",
    "end": "1836240"
  },
  {
    "text": "because the uh one of the reasons that in this case the key space the entropy",
    "start": "1836240",
    "end": "1841559"
  },
  {
    "text": "or the randomness of your of your token of your session cookie is highly influenced by the user it's basically",
    "start": "1841559",
    "end": "1847559"
  },
  {
    "text": "based on it's on your based on your password so even though an md5 sum can be 128bit value and it might look very",
    "start": "1847559",
    "end": "1854960"
  },
  {
    "text": "random in reality it's not it may not be my password is only ABC or my password",
    "start": "1854960",
    "end": "1860399"
  },
  {
    "text": "is you know Fubar or something like that it's going to be very trivial to attack that because humans aren't very good",
    "start": "1860399",
    "end": "1865519"
  },
  {
    "text": "entropy generators also in the event of a compromise or if this or or just for",
    "start": "1865519",
    "end": "1871639"
  },
  {
    "text": "the administrator's edification the token can't be changed or can't be regenerated without any any interaction",
    "start": "1871639",
    "end": "1878720"
  },
  {
    "text": "from the user so for example if you are worried about if you want to do a a reset of all of your session IDs or if",
    "start": "1878720",
    "end": "1885240"
  },
  {
    "text": "you want to Reed your session management function or if you want to do a small modification your session management the",
    "start": "1885240",
    "end": "1891880"
  },
  {
    "text": "tokens the actual cookies that your management is using are all can all controlled by the users because they're",
    "start": "1891880",
    "end": "1897600"
  },
  {
    "text": "based on the user ID and they're based on their password so if even if I wanted to disable someone's if I wanted to",
    "start": "1897600",
    "end": "1904279"
  },
  {
    "text": "protect someone because I think they've been using a an internet cafe and I want to change their their um their session",
    "start": "1904279",
    "end": "1910880"
  },
  {
    "text": "cookie their session token I can't because it's based on a password it's static for the entire time so that's",
    "start": "1910880",
    "end": "1915960"
  },
  {
    "text": "what another drawback of having a static token is versus a dynamic token such as the ASP session ID additionally and the",
    "start": "1915960",
    "end": "1923080"
  },
  {
    "text": "final bullet point there is that in this case the token can be attacked offline because it's the md5 sum of uh of your",
    "start": "1923080",
    "end": "1929120"
  },
  {
    "text": "password so there and rather than just launching a bunch of guesses at the server you just grab the token do a",
    "start": "1929120",
    "end": "1934919"
  },
  {
    "text": "Brute Force attack and you've got their complete access to this user so again a summary about static",
    "start": "1934919",
    "end": "1942000"
  },
  {
    "text": "tokens is that with the static token the user is not inhibited At All by session",
    "start": "1942000",
    "end": "1947480"
  },
  {
    "start": "1943000",
    "end": "2129000"
  },
  {
    "text": "expert ation even if you have good a session expiration that if there's a period of inactivity after 30 minutes or",
    "start": "1947480",
    "end": "1953159"
  },
  {
    "text": "after 2 hours or even if there's a log out button on the application that session token that session cookie is not",
    "start": "1953159",
    "end": "1959840"
  },
  {
    "text": "protected by that the attacker can still launch it because that session cookie is still valid on the server Additionally",
    "start": "1959840",
    "end": "1966360"
  },
  {
    "text": "the victim doesn't actually have to be active a static token means that that",
    "start": "1966360",
    "end": "1971399"
  },
  {
    "text": "the victim doesn't actually have to be going through news groups looking at their financial information uh",
    "start": "1971399",
    "end": "1976840"
  },
  {
    "text": "responding reading through forums in order for the attack to succeed the probability of success also increases",
    "start": "1976840",
    "end": "1983200"
  },
  {
    "text": "with the number of total users of the system in other words if they're only if you have a say A medium width uh",
    "start": "1983200",
    "end": "1989880"
  },
  {
    "text": "bandwidth web or mediumsized website that gets perhaps uh 1,000 hits per hour",
    "start": "1989880",
    "end": "1995639"
  },
  {
    "text": "on for a dynamic token you have a chance you have a Target pool of 1,000 if",
    "start": "1995639",
    "end": "2000799"
  },
  {
    "text": "however there are 1 million users of that application and they use static tokens you have a Target pool of 1",
    "start": "2000799",
    "end": "2006159"
  },
  {
    "text": "million users that's a Phenom phal difference in your chances of guessing a valid token it's also more likely to enable",
    "start": "2006159",
    "end": "2013639"
  },
  {
    "text": "the attacker to Target a specific victim and a lot of times if there's a deterministic Content such as a username",
    "start": "2013639",
    "end": "2019600"
  },
  {
    "text": "or such as a email address or a user ID then it can be very easy to to see what",
    "start": "2019600",
    "end": "2025720"
  },
  {
    "text": "else what if it's a forum to see what other usernames are or to see what other uh email addresses are and and attack",
    "start": "2025720",
    "end": "2032039"
  },
  {
    "text": "that as part of the token Dynamic tokens on the other hand if they're taken from a brand them pool",
    "start": "2032039",
    "end": "2038159"
  },
  {
    "text": "and if they're properly handled are actually inhibits the attacker because now session expiration means something",
    "start": "2038159",
    "end": "2044840"
  },
  {
    "text": "if the session token is only valid for 20 minutes before the user actually after inactivity then you only have a 20",
    "start": "2044840",
    "end": "2051480"
  },
  {
    "text": "minute time period of guessing a of guessing a valid token additionally your target pool like I said is only equal to",
    "start": "2051480",
    "end": "2058560"
  },
  {
    "text": "the size of the number of active users on the application rather than the number of total users that's only is",
    "start": "2058560",
    "end": "2063919"
  },
  {
    "text": "going to be less than the number of total users so You' Al you've also Limited the attack space that the",
    "start": "2063919",
    "end": "2068960"
  },
  {
    "text": "attacker has available so with the dynamic tokens",
    "start": "2068960",
    "end": "2074679"
  },
  {
    "text": "going down that route which is much better route you still have to have a very strongly strongly generated",
    "start": "2074679",
    "end": "2081000"
  },
  {
    "text": "strongly random token now you can do this with a B with some different you can do this mathematically to identify",
    "start": "2081000",
    "end": "2087280"
  },
  {
    "text": "is my pseudo random number generator actually generating something that's random you know is it working does it",
    "start": "2087280",
    "end": "2093118"
  },
  {
    "text": "can can someone create you know s s a plus cosine B that actually models my",
    "start": "2093119",
    "end": "2098599"
  },
  {
    "text": "what I thought was a prettyy good random number generator you can do this through um entropy doing furer analysis with",
    "start": "2098599",
    "end": "2106240"
  },
  {
    "text": "looking for time looking for frequency dependencies looking for different um associations with times and nonlinear",
    "start": "2106240",
    "end": "2113440"
  },
  {
    "text": "time series this La this third bullet the nonlinear time series if you're familiar with the bind view paper that",
    "start": "2113440",
    "end": "2118720"
  },
  {
    "text": "came out uh two or three years ago they applied a very similar thing to the tcpip uh initial sequence number so",
    "start": "2118720",
    "end": "2125000"
  },
  {
    "text": "predicting initial sequence numbers and I have a couple graphs that I'll show there um uh one of the one of the good",
    "start": "2125000",
    "end": "2132480"
  },
  {
    "start": "2129000",
    "end": "2250000"
  },
  {
    "text": "things that that you can do is to take do a phase space analysis what this means is this is similar to the the bind",
    "start": "2132480",
    "end": "2139240"
  },
  {
    "text": "view paper is taking a string of random numbers or a string of of observed values and you basically map them you",
    "start": "2139240",
    "end": "2146720"
  },
  {
    "text": "map their differences or you map them so that the the value at time sequence one",
    "start": "2146720",
    "end": "2151839"
  },
  {
    "text": "is subtracted from the value at time sequence n plus one and you do that and what that does it actually acts like a a",
    "start": "2151839",
    "end": "2158480"
  },
  {
    "text": "high pass filter it reduces a lot of trend information for example it's very if when you do this you can very easily",
    "start": "2158480",
    "end": "2164480"
  },
  {
    "text": "identify that you have increasing values if you have if you have a session ID",
    "start": "2164480",
    "end": "2169880"
  },
  {
    "text": "that goes one then two then three then four then five if you do phas Bas analysis on it you and or if you do a",
    "start": "2169880",
    "end": "2176480"
  },
  {
    "text": "difference of them so if you take the value at time one and then the value at time two and you subtract them it's all",
    "start": "2176480",
    "end": "2183160"
  },
  {
    "text": "it's going to be Perman it's going to be constant value it's be constant value of one and it's a lot easier to identif ify",
    "start": "2183160",
    "end": "2188200"
  },
  {
    "text": "that this that this this is a um a random number generator that actually is not random at all you can also do some",
    "start": "2188200",
    "end": "2195640"
  },
  {
    "text": "entropy calculations uh again this just really you can this just basically is a",
    "start": "2195640",
    "end": "2201280"
  },
  {
    "text": "a product of the probability of a number showing up times as log is again you need very large sample spaces to do this",
    "start": "2201280",
    "end": "2208440"
  },
  {
    "text": "this is why in practicality it's not necessarily you don't want you have you actually have to have large uh",
    "start": "2208440",
    "end": "2215359"
  },
  {
    "text": "observation time so you need perhaps 10 ,000 values or 20,000 values to see if a random number generator is truly random",
    "start": "2215359",
    "end": "2222560"
  },
  {
    "text": "so that's why I have just the math here and not actual uh code that goes through",
    "start": "2222560",
    "end": "2228240"
  },
  {
    "text": "it more importantly and and part of the reason there too is that if you rely on the ASP session ID and the PHP session",
    "start": "2228240",
    "end": "2234960"
  },
  {
    "text": "ID in other words the application generated tokens or generated sessions those are the ones to rely on and those",
    "start": "2234960",
    "end": "2241119"
  },
  {
    "text": "are the ones to use properly because a lot of work has gone into producing them and same idea with crypto that you",
    "start": "2241119",
    "end": "2246839"
  },
  {
    "text": "should that everyone admonishes you don't try and roll your own encryption scheme because",
    "start": "2246839",
    "end": "2252520"
  },
  {
    "start": "2250000",
    "end": "2301000"
  },
  {
    "text": "you're you're bound to make mistakes and even with encryption schemes for example DVD uh the DVD CSS that was broken not",
    "start": "2252520",
    "end": "2260520"
  },
  {
    "text": "because Dez was broken or because the encryption was broken it was broken because of poor Key Management someone",
    "start": "2260520",
    "end": "2266000"
  },
  {
    "text": "was able to see a key the same with uh being able to run Linux on your Xbox using um uh the mech Warrior CD the mech",
    "start": "2266000",
    "end": "2272760"
  },
  {
    "text": "Warrior game that was that the way to do that was done not because someone broke the encryption scheme but because",
    "start": "2272760",
    "end": "2278720"
  },
  {
    "text": "someone broke the key management the same thing can be applied with session management that use the ASP session ID",
    "start": "2278720",
    "end": "2285240"
  },
  {
    "text": "object use this the session object use your PHP session object rather than using trying to create your own session",
    "start": "2285240",
    "end": "2291400"
  },
  {
    "text": "identifiers and create trying to say I'm going to have a username plus a 32-bit Value Plus a Tim stamp that can lead you",
    "start": "2291400",
    "end": "2298200"
  },
  {
    "text": "down to uh some very insecure paths additionally too transformation",
    "start": "2298200",
    "end": "2304520"
  },
  {
    "text": "does not increase Randomness in other in other words let's just say uh you have you're going to you're going to give",
    "start": "2304520",
    "end": "2309599"
  },
  {
    "text": "everyone a time stamp of when they log in and that's their session token you can uh you can do that the date plus",
    "start": "2309599",
    "end": "2315800"
  },
  {
    "text": "percent s you know if you do that from the Unix command line you'll get the date the DI stamp that's a 32-bit value",
    "start": "2315800",
    "end": "2322359"
  },
  {
    "text": "but it's not a very random value if you take the md5 hash of that you can create a 128bit value well that sounds like",
    "start": "2322359",
    "end": "2329200"
  },
  {
    "text": "better doesn't it or the Sha one hash of that creates a 256bit value but in all",
    "start": "2329200",
    "end": "2334560"
  },
  {
    "text": "three of those cases you haven't increased the randomness you haven't haven't increased the entropy you haven't increased any of the security of",
    "start": "2334560",
    "end": "2340800"
  },
  {
    "text": "that token so that's why when you just as uh it's not matter of bits or it's",
    "start": "2340800",
    "end": "2346560"
  },
  {
    "text": "not a matter of the size of the session token this necessarily implies how secure it is it's actually how random it",
    "start": "2346560",
    "end": "2352760"
  },
  {
    "text": "is or what's the entropy of that token because you can still trivially guess these and your pool your seeds are still",
    "start": "2352760",
    "end": "2358640"
  },
  {
    "text": "really small and as I've been saying so you",
    "start": "2358640",
    "end": "2365240"
  },
  {
    "start": "2364000",
    "end": "2480000"
  },
  {
    "text": "have many web servers web applications that provide that have methods to provide the random session IDs and these",
    "start": "2365240",
    "end": "2370839"
  },
  {
    "text": "are the ones that you that it's much better to use but and use properly and",
    "start": "2370839",
    "end": "2376640"
  },
  {
    "text": "they're the ones that you can that you can trust and you know you want to say these are generated randomly uh very",
    "start": "2376640",
    "end": "2382359"
  },
  {
    "text": "quickly if you've seen I have four graphs here that show that show quote unquote the randomness of these values",
    "start": "2382359",
    "end": "2389640"
  },
  {
    "text": "and for example this is a a phase space diagram of the ASP session ID basically",
    "start": "2389640",
    "end": "2395800"
  },
  {
    "text": "the interpretation of a graph like this basically you look at it and you say how large is it in this case the the one",
    "start": "2395800",
    "end": "2402440"
  },
  {
    "text": "this axis is is um 2 * 10 the 50th so we have at least a large range the next",
    "start": "2402440",
    "end": "2408319"
  },
  {
    "text": "question you ask yourself is it very is it does it have a large dispersal around it and if it has a large distribution",
    "start": "2408319",
    "end": "2415119"
  },
  {
    "text": "that implies there's a uniform distribution around here and it's very random so if you do a a time if you do a",
    "start": "2415119",
    "end": "2422000"
  },
  {
    "text": "phas based analysis of of your of your session token and you plot it you see a widely disperse graph you're going to",
    "start": "2422000",
    "end": "2428480"
  },
  {
    "text": "say oh there's no time dependency here it looks like it probably is a very random value if you do a session if this",
    "start": "2428480",
    "end": "2435400"
  },
  {
    "text": "is the net session ID again it's it's about four * 10 50th so we have very",
    "start": "2435400",
    "end": "2440960"
  },
  {
    "text": "large range but you notice clumping now in this case it seems like maybe perhaps",
    "start": "2440960",
    "end": "2446200"
  },
  {
    "text": "there's less Randomness here because there's clumping there might be more of a Time dependency now in this fact this",
    "start": "2446200",
    "end": "2452599"
  },
  {
    "text": "clumping is only because we have a small observation pool we only did about 4,000 values collected",
    "start": "2452599",
    "end": "2457880"
  },
  {
    "text": "so even even though we only collected four values it looks like it's it may not be too random because there's",
    "start": "2457880",
    "end": "2463319"
  },
  {
    "text": "clumping but if you were actually to extend this over a longer period of time a longer observation time you see that",
    "start": "2463319",
    "end": "2468640"
  },
  {
    "text": "the the dispersal of it would be would grow and grow so it's basically what I'm saying is I'm make just making another",
    "start": "2468640",
    "end": "2473800"
  },
  {
    "text": "case that use the ASP session ID use the net session ID tokens because at least",
    "start": "2473800",
    "end": "2478880"
  },
  {
    "text": "from this point of view they do appear random same thing with PHP PHP has uh",
    "start": "2478880",
    "end": "2484040"
  },
  {
    "start": "2480000",
    "end": "2509000"
  },
  {
    "text": "gone through a couple iterations of insecurity and security versus the generation of their tokens now from a",
    "start": "2484040",
    "end": "2489839"
  },
  {
    "text": "PHP 4 4.0 series from which this is gathered uh you can see that the graph",
    "start": "2489839",
    "end": "2495319"
  },
  {
    "text": "shows a very very dispersed uh distribution so once again that implies that there's not a there's not a heavy",
    "start": "2495319",
    "end": "2501880"
  },
  {
    "text": "time dependency and all which implies then that it's going to be more difficult to predict and model this type",
    "start": "2501880",
    "end": "2507440"
  },
  {
    "text": "of uh random number generator uh finally uh one more is the",
    "start": "2507440",
    "end": "2512560"
  },
  {
    "start": "2509000",
    "end": "2557000"
  },
  {
    "text": "the J session ID generated through um uh Java application engines once again this",
    "start": "2512560",
    "end": "2517880"
  },
  {
    "text": "just shows that the the application engine provides a session management provides a random value that is in fact",
    "start": "2517880",
    "end": "2525280"
  },
  {
    "text": "going to be very random and probably sufficient for any needs that you're going to run into now and the importance",
    "start": "2525280",
    "end": "2531280"
  },
  {
    "text": "then is to use these Dynamic tokens assign these Dynamic tokens to the user and then apply the authorization and",
    "start": "2531280",
    "end": "2538079"
  },
  {
    "text": "authentication uh information to these tokens not to addition add additional cookies that say user username equals",
    "start": "2538079",
    "end": "2545200"
  },
  {
    "text": "this or my that you can modify during attacks so uh talking about counter",
    "start": "2545200",
    "end": "2552000"
  },
  {
    "text": "measures then you have of course input validation you always need strong passwords and authentication systems you",
    "start": "2552000",
    "end": "2557359"
  },
  {
    "text": "always need but a session attack renders both of those pretty much useless",
    "start": "2557359",
    "end": "2562880"
  },
  {
    "text": "because it's hard to predict it's hard to protect from a session ID attack with an IDs and it's hard to protect against",
    "start": "2562880",
    "end": "2569680"
  },
  {
    "text": "a session attack through input validation filters so what should a session token",
    "start": "2569680",
    "end": "2575079"
  },
  {
    "start": "2573000",
    "end": "2673000"
  },
  {
    "text": "do what should this session cookie do for your on your website what it should do it should temporarily identify the",
    "start": "2575079",
    "end": "2581079"
  },
  {
    "text": "user with a session token and that identification does not have to be based on an attribute of the user in other",
    "start": "2581079",
    "end": "2587160"
  },
  {
    "text": "words the that that attribute doesn't have to mean that it's the based on the username it's based on the email address",
    "start": "2587160",
    "end": "2593400"
  },
  {
    "text": "it just has to be some something that's random that's a random value that for this 20 minutes or so or 30 minutes",
    "start": "2593400",
    "end": "2599720"
  },
  {
    "text": "identifies the user the the session token or the or any cookies should not describe the user in other words it",
    "start": "2599720",
    "end": "2606319"
  },
  {
    "text": "shouldn't have profile file information once again the username or the password it definitely should not have privilege",
    "start": "2606319",
    "end": "2611720"
  },
  {
    "text": "information such as user or admin CU privilege information can lead you to",
    "start": "2611720",
    "end": "2616920"
  },
  {
    "text": "other types of semantic attacks where you flip a cookie that says is admin equals false to is admin equals true",
    "start": "2616920",
    "end": "2623319"
  },
  {
    "text": "suddenly you've logged in as your own user but you've given yourself elevated privileges and also it shouldn't contain",
    "start": "2623319",
    "end": "2629079"
  },
  {
    "text": "sensitive information this PPA or PPI information information such as your social security number such as um uh",
    "start": "2629079",
    "end": "2637119"
  },
  {
    "text": "financial information bank account credit card information none of that should be associated with the session",
    "start": "2637119",
    "end": "2642200"
  },
  {
    "text": "token that's being passed to the client what they should be done is being handled on the on the server side that",
    "start": "2642200",
    "end": "2648200"
  },
  {
    "text": "so that the server says okay here's my session ID my session token I'm going to store in memory the username associated",
    "start": "2648200",
    "end": "2655640"
  },
  {
    "text": "with this random value or the social security number associated with random number and every request does a look up",
    "start": "2655640",
    "end": "2661520"
  },
  {
    "text": "in memory of that value so that's why this user the server side session objects to describe the user to give the",
    "start": "2661520",
    "end": "2668640"
  },
  {
    "text": "site privileges the profile information the data privileges what they can access additionally SE session",
    "start": "2668640",
    "end": "2675760"
  },
  {
    "start": "2673000",
    "end": "3002000"
  },
  {
    "text": "expiration is very important to session management you should expire under several circumstances the logout button",
    "start": "2675760",
    "end": "2682920"
  },
  {
    "text": "the logout button should work if the logout button just redirects you to the homepage but it doesn't delete the",
    "start": "2682920",
    "end": "2688319"
  },
  {
    "text": "cookie from the client and it and it doesn't delete the cookie from the server then in an internet cafe someone",
    "start": "2688319",
    "end": "2694119"
  },
  {
    "text": "just needs to walk up to that server click the back button and then they're still logged in as you they can change your password they can update your",
    "start": "2694119",
    "end": "2700760"
  },
  {
    "text": "profile they can change the email address so that you can request a new password and have it emailed to you uh",
    "start": "2700760",
    "end": "2707200"
  },
  {
    "text": "additionally there should after um depending on the sensitivity of your application the session should expire or",
    "start": "2707200",
    "end": "2714599"
  },
  {
    "text": "or Force the user to reauthenticate after a set period of time for if you're",
    "start": "2714599",
    "end": "2720400"
  },
  {
    "text": "doing a financial uh application where you're where you're handling bank account or trading information you may",
    "start": "2720400",
    "end": "2726640"
  },
  {
    "text": "want to force the user to reauthenticate every 30 minutes or perhaps every 45 minutes regardless of inactivity just to",
    "start": "2726640",
    "end": "2733319"
  },
  {
    "text": "make sure that the user is still who they say they are and just to Pro to uh",
    "start": "2733319",
    "end": "2738359"
  },
  {
    "text": "reinforce the the security of that session then of course session in activity after a period of 20 minutes 30",
    "start": "2738359",
    "end": "2744960"
  },
  {
    "text": "minutes 40 minutes uh perhaps 2 hours 8 hours you should always expire those tokens because the longer that session",
    "start": "2744960",
    "end": "2751599"
  },
  {
    "text": "token is valid on the server the the longer it's there for it to be attacked and the larger pool you have to attack",
    "start": "2751599",
    "end": "2757760"
  },
  {
    "text": "so by reducing it you reduce the you uh help for environments where computer",
    "start": "2757760",
    "end": "2763480"
  },
  {
    "text": "where physical access is very hard to control to a use to a computer or computers are in shared environments and",
    "start": "2763480",
    "end": "2770319"
  },
  {
    "text": "also decreases the target pool that attackers have towards that token uh one question",
    "start": "2770319",
    "end": "2779640"
  },
  {
    "text": "right the question is is what you know what's the correlation what are the good what are the good guidelines to be able to say I have I have n end amount of",
    "start": "2799520",
    "end": "2808000"
  },
  {
    "text": "users uh you know end amount of request say requests per hour valid users per",
    "start": "2808000",
    "end": "2813319"
  },
  {
    "text": "hour what should the session timeout be and what should the key space big should can is a 32-bit value sufficient is a",
    "start": "2813319",
    "end": "2820040"
  },
  {
    "text": "64-bit value sufficient uh the answer to that is I I initially I had I had a",
    "start": "2820040",
    "end": "2825359"
  },
  {
    "text": "slide that had those metrics and initially what I found is that if you have if you have a a high bandwith",
    "start": "2825359",
    "end": "2831599"
  },
  {
    "text": "website a million say a million uh hits per day and say you have 10,000 concurrent users per hour and you have a",
    "start": "2831599",
    "end": "2838400"
  },
  {
    "text": "session timeout of 20 minutes so you have 10,000 user per hour a session window uh timeout window of 20 minutes",
    "start": "2838400",
    "end": "2846640"
  },
  {
    "text": "and and um you're using a 32-bit value if I during that time if I launch uh the",
    "start": "2846640",
    "end": "2853040"
  },
  {
    "text": "attack of uh it was a 10,000 requests per second for or 10,000",
    "start": "2853040",
    "end": "2858559"
  },
  {
    "text": "requests at one request per second I still had a a percent chance of of about",
    "start": "2858559",
    "end": "2864800"
  },
  {
    "text": "0.0027 to guess it even with a 32-bit value now that assumes that you're using",
    "start": "2864800",
    "end": "2870200"
  },
  {
    "text": "Dynamic tokens so a 32-bit value can still be pretty secure if you even for",
    "start": "2870200",
    "end": "2875800"
  },
  {
    "text": "large bandwith websit if you have uh so I think 1,000 users per uh 1,000 10,000",
    "start": "2875800",
    "end": "2881640"
  },
  {
    "text": "users per hour and you have a session time out of 20 minutes 32 bits can actually be sufficient however that 32",
    "start": "2881640",
    "end": "2888520"
  },
  {
    "text": "bits does have to be random and it has to be and um it has to be you have to make sure you do all the other caveats",
    "start": "2888520",
    "end": "2895040"
  },
  {
    "text": "such as expiring and doing session timeout so there I initially I didn't",
    "start": "2895040",
    "end": "2900440"
  },
  {
    "text": "think there was too much of a difference between 32bit and 64bit uh one of one of",
    "start": "2900440",
    "end": "2905760"
  },
  {
    "text": "the S one of the SED thoughts I had on that was that with 32 bits however you",
    "start": "2905760",
    "end": "2910960"
  },
  {
    "text": "still may have a potential for someone profiling your random number generator",
    "start": "2910960",
    "end": "2916240"
  },
  {
    "text": "because uh because right now uh uh you have uh uh getting close to a lot of uh",
    "start": "2916240",
    "end": "2923559"
  },
  {
    "text": "storage space so it's very easy to put uh one one terabyte of storage space",
    "start": "2923559",
    "end": "2928640"
  },
  {
    "text": "onto a desktop computer or two or three desktops comp desktop computers and you have very high amount of uh CPU",
    "start": "2928640",
    "end": "2935520"
  },
  {
    "text": "utilization available to you so what you can do is you can take a 32-bit random number generator you can take say the",
    "start": "2935520",
    "end": "2941920"
  },
  {
    "text": "first thousand values and then you can say and you can say okay these are all the seeds that produce these values you",
    "start": "2941920",
    "end": "2948280"
  },
  {
    "text": "can profile someone's random number generator and that's a bit of an aside and I don't have any good you know any",
    "start": "2948280",
    "end": "2954440"
  },
  {
    "text": "good metrics on the feasibility of that attack that's you know perhaps a white paper for something else but um the the",
    "start": "2954440",
    "end": "2959920"
  },
  {
    "text": "long withed the longwinded answer to that was if you use if you have a um if you use dynamic",
    "start": "2959920",
    "end": "2966680"
  },
  {
    "text": "dnamic tokens you have small time windows in other words you only expect people to be to be active between 20 and",
    "start": "2966680",
    "end": "2973000"
  },
  {
    "text": "30 minutes uh on your website and you have a high amount of users 10,000",
    "start": "2973000",
    "end": "2978040"
  },
  {
    "text": "unique users per hour then 32-bit values it can still mean that an attacker doing",
    "start": "2978040",
    "end": "2984680"
  },
  {
    "text": "10,000 requests over a period of one hour only has has much less than a 1%",
    "start": "2984680",
    "end": "2989920"
  },
  {
    "text": "chance of success now of course that there's a lot of variables there about how many requests to make per second but",
    "start": "2989920",
    "end": "2995920"
  },
  {
    "text": "that that was an in thing um but what I what I did say what",
    "start": "2995920",
    "end": "3001440"
  },
  {
    "text": "I do say is that uh because you if you're the owner of the application what you can do is Observe and model the",
    "start": "3001440",
    "end": "3008079"
  },
  {
    "start": "3002000",
    "end": "3067000"
  },
  {
    "text": "behavior of your of your users to try and answer these questions of how long should my session management be or how",
    "start": "3008079",
    "end": "3014480"
  },
  {
    "text": "long should an inactive timeout period be how many concurrent users do I have because you can create metrics you can",
    "start": "3014480",
    "end": "3020200"
  },
  {
    "text": "say how many users do I have concurrently on my web applications what's the average amount of time that",
    "start": "3020200",
    "end": "3025480"
  },
  {
    "text": "they're active how many of them actually use the logout feature what that means is that if they using a log out Fe if if",
    "start": "3025480",
    "end": "3031680"
  },
  {
    "text": "a lot of people are using a log out feature that's good if not a lot of people are using the logout feature then you may want to shorten the amount of",
    "start": "3031680",
    "end": "3038359"
  },
  {
    "text": "the the inact the the inactive time before you expire it and also if you have a remember me feature if if a large",
    "start": "3038359",
    "end": "3045640"
  },
  {
    "text": "amount of users use a remember me feature well that also that's that counters the inactive period time out",
    "start": "3045640",
    "end": "3052040"
  },
  {
    "text": "because what remember me says is that you can instead of being expiring your session after",
    "start": "3052040",
    "end": "3057440"
  },
  {
    "text": "uh 20 minutes or 30 minutes you can log in once and then 2 days later still go",
    "start": "3057440",
    "end": "3062480"
  },
  {
    "text": "to the application you don't have to reive your password again uh as a final countermeasure data",
    "start": "3062480",
    "end": "3070160"
  },
  {
    "start": "3067000",
    "end": "3136000"
  },
  {
    "text": "security I think is also important because these these types of attacks session management attacks attack other",
    "start": "3070160",
    "end": "3076160"
  },
  {
    "text": "users of the application that you want to protect those other users information B the easy",
    "start": "3076160",
    "end": "3082440"
  },
  {
    "text": "way to do that is with masking credit card numbers only only provide the last five digits of the credit card only",
    "start": "3082440",
    "end": "3088079"
  },
  {
    "text": "provide the last three digits for example of the social security number and also only mask out the password but",
    "start": "3088079",
    "end": "3095240"
  },
  {
    "text": "mask it out with a a a fixed length string so that some even someone can't guess say oh this this person has a five",
    "start": "3095240",
    "end": "3102079"
  },
  {
    "text": "character password this person has a seven character password use a fix length string also for very um for",
    "start": "3102079",
    "end": "3108240"
  },
  {
    "text": "important transactions perhaps change when you change your password or you update your email address or you um",
    "start": "3108240",
    "end": "3115599"
  },
  {
    "text": "access a uh on bank account or you transfer funds you can also just ask the",
    "start": "3115599",
    "end": "3121119"
  },
  {
    "text": "user to reauthenticate you pop up a window says Please Please provide your your password before you complete this",
    "start": "3121119",
    "end": "3127359"
  },
  {
    "text": "transaction that prevents the user from stealing stealing the session token and replaying it in order to uh change your",
    "start": "3127359",
    "end": "3134680"
  },
  {
    "text": "email address for example so quick summary of that um if I",
    "start": "3134680",
    "end": "3141160"
  },
  {
    "start": "3136000",
    "end": "3599000"
  },
  {
    "text": "haven't confused you too much hopefully or if I haven't gone off on too many tangents is that looking at a at a as a",
    "start": "3141160",
    "end": "3146880"
  },
  {
    "text": "session token there are four things that to look for you can see how it's generated is it static or is it Dynamic",
    "start": "3146880",
    "end": "3154000"
  },
  {
    "text": "is does it change does it change each time the user logs in is it and or does it stay the same every time the user",
    "start": "3154000",
    "end": "3160319"
  },
  {
    "text": "logs in look at the content does it temporarily identify the user in other words does it have some type of",
    "start": "3160319",
    "end": "3165880"
  },
  {
    "text": "anonymous random value or does it permanently describe the user does it have their email address does it have a password does it have a or an a username",
    "start": "3165880",
    "end": "3173280"
  },
  {
    "text": "does it have a user ID look at the transformation is it just encoded encrypted is it hashed because you can",
    "start": "3173280",
    "end": "3180280"
  },
  {
    "text": "do some uh brute for guessing analysis on hashed values to see what was actually used to generate it maybe it",
    "start": "3180280",
    "end": "3186119"
  },
  {
    "text": "was only timestamps used to generate these hash values so you can quickly reverse engineer that and attack the",
    "start": "3186119",
    "end": "3191799"
  },
  {
    "text": "session management that way and then of course you uh as a man manually you look at the token usage can you replay it can",
    "start": "3191799",
    "end": "3199280"
  },
  {
    "text": "you take someone else's token and replay it to change their password can you what other what other pieces of cookie what",
    "start": "3199280",
    "end": "3205400"
  },
  {
    "text": "other what other piece of information are necessary to complete certain transactions and then I have references",
    "start": "3205400",
    "end": "3213240"
  },
  {
    "text": "and a couple helpful tips but at this point I like to open up for any questions you may have",
    "start": "3213240",
    "end": "3220960"
  },
  {
    "text": "the question is about how what if if say we're using Dynamic tokens so we want to have we want to give a user have them",
    "start": "3250359",
    "end": "3255640"
  },
  {
    "text": "authenticate only once but still change that session token on the user but do it so that they don't have to",
    "start": "3255640",
    "end": "3261160"
  },
  {
    "text": "reauthenticate or there's no interaction required and in fact PHP I think 4.1 or",
    "start": "3261160",
    "end": "3267040"
  },
  {
    "text": "4.31 provides a session regenerate function which does exactly that so PHP",
    "start": "3267040",
    "end": "3272799"
  },
  {
    "text": "provides the function to uh you log in and it's very good for example to give when you have an anonymous user the",
    "start": "3272799",
    "end": "3279240"
  },
  {
    "text": "anonymous user goes to the login page they get us they get a a session token they log in they've given their username",
    "start": "3279240",
    "end": "3285359"
  },
  {
    "text": "and password rather than having them M keep the same session token they had as as an anonymous user use the PHP session",
    "start": "3285359",
    "end": "3292760"
  },
  {
    "text": "regenerate give them a new token and you can do this over a period of time so that you're changing it uh another thing",
    "start": "3292760",
    "end": "3299440"
  },
  {
    "text": "that you can do for example PHP groupware takes this to the extreme where it's almost like chasing a tennis",
    "start": "3299440",
    "end": "3304640"
  },
  {
    "text": "ball every single page request has a new has has a new session token so you have",
    "start": "3304640",
    "end": "3309839"
  },
  {
    "text": "to go from page the login page to the view profile page with the correct session token then when you click the to",
    "start": "3309839",
    "end": "3316280"
  },
  {
    "text": "go from The View profile to the you know change email address you're given a new session session ID so that's actually",
    "start": "3316280",
    "end": "3323079"
  },
  {
    "text": "taking it to to an extreme where you actually have to have the exact user user token and the exact page session ID",
    "start": "3323079",
    "end": "3330079"
  },
  {
    "text": "for it another thing that is done is actually um page-based session handling uh yahooo does this they call it uh",
    "start": "3330079",
    "end": "3336720"
  },
  {
    "text": "crumbs I think MSN does this a couple other sites do this by placing crumbs not cookies inside the web page that c a",
    "start": "3336720",
    "end": "3344440"
  },
  {
    "text": "page request actually has a session associated with it so that particular page is only valid for a particular user",
    "start": "3344440",
    "end": "3350760"
  },
  {
    "text": "or for a particular amount of time a couple questions",
    "start": "3350760",
    "end": "3356839"
  },
  {
    "text": "Yeah question common theme was 10,000 10,000 requests per hour as the attacker that is uh that's once again the very",
    "start": "3364160",
    "end": "3371079"
  },
  {
    "text": "arbitrary random value uh there's no there there's no you know uh statistical reason for that there's no good reason",
    "start": "3371079",
    "end": "3377039"
  },
  {
    "text": "for that that's simply an easy number to to to talk about and it's also one of",
    "start": "3377039",
    "end": "3382440"
  },
  {
    "text": "the reasons I I did chose it was perhaps thinking that 10,000 seem to be about",
    "start": "3382440",
    "end": "3388319"
  },
  {
    "text": "right for uh going underneath an IDs going underneath for example apache's",
    "start": "3388319",
    "end": "3393559"
  },
  {
    "text": "mod sasive uh type of module so there so the point of the and so but it's also",
    "start": "3393559",
    "end": "3401480"
  },
  {
    "text": "what I didn't mention is that there are there other countermeasures to these to having uh many many types of requests",
    "start": "3401480",
    "end": "3407079"
  },
  {
    "text": "and the reason that the importance on Dynamic tokens is that when you have a dynamic token you have a small time",
    "start": "3407079",
    "end": "3413039"
  },
  {
    "text": "period so the attacker has to do 10,000 or 20,000 ,000 or 30,000 requests per hour in order to get a or per 20 minutes",
    "start": "3413039",
    "end": "3420520"
  },
  {
    "text": "in order to get a valid attack however if you have a static token a token that doesn't change it doesn't matter what",
    "start": "3420520",
    "end": "3425920"
  },
  {
    "text": "the request per hour is of the attacker the the the request rate can be one per day can be one per week because as long",
    "start": "3425920",
    "end": "3432520"
  },
  {
    "text": "as the website is up as long as there are users who have created accounts on the on the web server it doesn't really",
    "start": "3432520",
    "end": "3438599"
  },
  {
    "text": "matter how many attacks you do it's just whatever your patience is and whatever your paranoia level is about being seen",
    "start": "3438599",
    "end": "3445359"
  },
  {
    "text": "by a log analysis tool or by a firewall Ru uh Rule and second question here oh yeah go",
    "start": "3445359",
    "end": "3454880"
  },
  {
    "text": "ahead uh well the session regenerate it basically it gives you the the the one",
    "start": "3465799",
    "end": "3471400"
  },
  {
    "text": "slide I did show was the the the phase based analysis of of PHP which has nice wide distribution over I think it was a",
    "start": "3471400",
    "end": "3478359"
  },
  {
    "text": "32bit window size or 38 bit excuse me and um uh and the session regenerate",
    "start": "3478359",
    "end": "3484799"
  },
  {
    "text": "function it just basically gives it it does goes through exact same same thing as a as a new user would would receive a",
    "start": "3484799",
    "end": "3491920"
  },
  {
    "text": "session token from so session regenerate doesn't introduce any new um algorithmically it doesn't introduce any",
    "start": "3491920",
    "end": "3498200"
  },
  {
    "text": "new um problems no time dependency other questions",
    "start": "3498200",
    "end": "3505720"
  },
  {
    "text": "that",
    "start": "3506960",
    "end": "3509200"
  },
  {
    "text": "sorry from uh from what any particular",
    "start": "3518160",
    "end": "3523480"
  },
  {
    "text": "perspective oh oh well I haven't I I haven't looked at any sslvpn so and to see you know to see",
    "start": "3524079",
    "end": "3530839"
  },
  {
    "text": "what the how that how the sessions managed so I can't I can't answer yes to that it'd be more of with that I would",
    "start": "3530839",
    "end": "3537400"
  },
  {
    "text": "you know I'd suspect and just counter with what what where is the actual where is the the session being handled whether",
    "start": "3537400",
    "end": "3543720"
  },
  {
    "text": "it's being handled by the um the SSL session and then whatever is protected behind it for example speaking to web",
    "start": "3543720",
    "end": "3550599"
  },
  {
    "text": "apps does the web app using the ASP session ID or is it simply or is it using just a user ID and assuming the",
    "start": "3550599",
    "end": "3557200"
  },
  {
    "text": "sslvpn is handling that particular session so it's kind of an invasive answer only because I haven't looked at",
    "start": "3557200",
    "end": "3563760"
  },
  {
    "text": "looked at this",
    "start": "3563760",
    "end": "3567160"
  },
  {
    "text": "well the question is a lot of them use Java and you know does that make it any less or more secure and uh I think that",
    "start": "3577880",
    "end": "3584359"
  },
  {
    "text": "the the choice of the choice of language is is not is um the session management",
    "start": "3584359",
    "end": "3589880"
  },
  {
    "text": "is agnostic to or should be agnostic to choice of language because it's the it's how you generate the token to how you",
    "start": "3589880",
    "end": "3597000"
  },
  {
    "text": "manage the token in other words does it expire does what's the Rand what's the random number pool that it comes from",
    "start": "3597000",
    "end": "3602920"
  },
  {
    "text": "and then uh external to that is how what other attributes from the client are you looking at in order to to do to do data",
    "start": "3602920",
    "end": "3610280"
  },
  {
    "text": "lookups for example even if you're using ASP session ID or PHP session ID to manage the the session but you're but",
    "start": "3610280",
    "end": "3616960"
  },
  {
    "text": "you're giving each user a a cookie value called user ID equals one two and what Valu is 1 2 3 4 if you're doing your",
    "start": "3616960",
    "end": "3623799"
  },
  {
    "text": "database request by looking at that cookie value then then you have very insecure session management because all the attacker",
    "start": "3623799",
    "end": "3629960"
  },
  {
    "text": "needs to do is change that cookie value and it doesn't matter what the session was they just they have a valid session",
    "start": "3629960",
    "end": "3636319"
  },
  {
    "text": "however if you do if on the server side you do a session look up and you say s session object you know Fu tell me what",
    "start": "3636319",
    "end": "3644200"
  },
  {
    "text": "uh user ID you are associated with this and the session I object tells you I'm associated with you know user ID 1 2 3 4",
    "start": "3644200",
    "end": "3651480"
  },
  {
    "text": "you do the data lookup based on that then you have a securely managed so that's why the language doesn't really",
    "start": "3651480",
    "end": "3656880"
  },
  {
    "text": "matter it's the the handling the manipulation of the the data and what you handle and pass back between the",
    "start": "3656880",
    "end": "3662160"
  },
  {
    "text": "client that is going to be the the Achilles heel other question",
    "start": "3662160",
    "end": "3670920"
  },
  {
    "text": "yeah that's absolutely valid if anyone didn't hear it's uh taking taking passport as an example um Hotmail uses",
    "start": "3700440",
    "end": "3707119"
  },
  {
    "text": "passport and name you know name four other sites that use it if you wanted to attack uh you wanted to go through a a",
    "start": "3707119",
    "end": "3713480"
  },
  {
    "text": "plain text attack or you wanted to or a a bit flipping attack against uh passport uh MSP o and MSP Prof cookies",
    "start": "3713480",
    "end": "3721400"
  },
  {
    "text": "you could do this against uh three different websites and against a thousand different or 100 different URLs",
    "start": "3721400",
    "end": "3726960"
  },
  {
    "text": "on each website so the attack pool greatly increases so that's definitely that's definitely a valid point too and",
    "start": "3726960",
    "end": "3733559"
  },
  {
    "text": "one of the things that that I didn't uh really emphasize too much is what the the size the the attack pool you know",
    "start": "3733559",
    "end": "3740079"
  },
  {
    "text": "the request per hour request per minute what's really necessary because I think from it's more it's more important to",
    "start": "3740079",
    "end": "3746319"
  },
  {
    "text": "Simply from the application end use Dynamic tokens decrease the time window",
    "start": "3746319",
    "end": "3751640"
  },
  {
    "text": "because you can't you can't stop someone from have from you running a zombie Network and having 100 different",
    "start": "3751640",
    "end": "3757279"
  },
  {
    "text": "computers doing 100 attacks each per minute versus having 10 computers at",
    "start": "3757279",
    "end": "3762839"
  },
  {
    "text": "2,000 attacks those numbers they're they're too easy to change so it has to be done really from a application",
    "start": "3762839",
    "end": "3768559"
  },
  {
    "text": "standpoint is where you're going to is where you're going to build your confidence you're going to build the security of the the management bring one",
    "start": "3768559",
    "end": "3775359"
  },
  {
    "text": "step",
    "start": "3775359",
    "end": "3777838"
  },
  {
    "text": "that's true and that's why and that's why uh I do actually kind of now regret uh not having put in a good metric on",
    "start": "3795000",
    "end": "3802279"
  },
  {
    "text": "you know should you have a 32-bit should you have a 64-bit should you have a 12 8 uh probably as a as a rule I think the",
    "start": "3802279",
    "end": "3809079"
  },
  {
    "text": "um I think PHP takes it from a a 40 to somewhere 40 to 64 I forget the the the",
    "start": "3809079",
    "end": "3814480"
  },
  {
    "text": "the actual number but if if if you're using whatever your seed value is even if it's 30 if you're using a 32-bit",
    "start": "3814480",
    "end": "3821160"
  },
  {
    "text": "random number and you're turning to taking hash you know putting into md5 s it's still a 32-bit it still seems",
    "start": "3821160",
    "end": "3827440"
  },
  {
    "text": "pretty good but you have to counter that with how many valid users you have on your system most I was trying to think",
    "start": "3827440",
    "end": "3834240"
  },
  {
    "text": "of good examples of this but I don't know how how many systems out there have more than one 10 million or or 20",
    "start": "3834240",
    "end": "3840200"
  },
  {
    "text": "million different registered users of the system when you have say you have 20 million registered users valid users on",
    "start": "3840200",
    "end": "3847039"
  },
  {
    "text": "a system you have extremely large Target pool so then that just increases the chances of a successful hit when you're",
    "start": "3847039",
    "end": "3853960"
  },
  {
    "text": "using static tokens but when you go to the dynamic token range it's it's a function of how many valid users are",
    "start": "3853960",
    "end": "3860359"
  },
  {
    "text": "there per minute unique users per minute and what is the average time that user is active",
    "start": "3860359",
    "end": "3867720"
  },
  {
    "text": "uh do you mean uh do you mean if the if the server expects you to to send the username and password each",
    "start": "3888359",
    "end": "3894640"
  },
  {
    "text": "time so so for example that would be sort of like using a basic goth over htps so if you if you if you had if you",
    "start": "3894640",
    "end": "3901760"
  },
  {
    "text": "had a web application that was expecting you know username password each time then that that's your that is your",
    "start": "3901760",
    "end": "3906799"
  },
  {
    "text": "session management so your session token is username password it's based on that entropy so in that case every single",
    "start": "3906799",
    "end": "3913319"
  },
  {
    "text": "request requires a valid credentials and there's no in that case I I can't",
    "start": "3913319",
    "end": "3918480"
  },
  {
    "text": "imagine that's more secure less secure than having a strong token it's definitely not less secure than",
    "start": "3918480",
    "end": "3923520"
  },
  {
    "text": "generating a dynamic token and just having that person use the session cookie because you're what you're doing",
    "start": "3923520",
    "end": "3928599"
  },
  {
    "text": "you're authenticating each request so the the the the drawback here is that when you only authenticate the login you",
    "start": "3928599",
    "end": "3935640"
  },
  {
    "text": "give the user an insecure session cookie and then you ignore the user from that point",
    "start": "3935640",
    "end": "3941400"
  },
  {
    "text": "on yeah AB absolutely yeah",
    "start": "3953240",
    "end": "3957640"
  },
  {
    "text": "well yeah what happens is that I didn't mention Brute Force because Brute Force has many other potentials to it you can",
    "start": "3964000",
    "end": "3969279"
  },
  {
    "text": "either brute force a particular account and try many different passwords or you can brute force a particular password",
    "start": "3969279",
    "end": "3975200"
  },
  {
    "text": "across many accounts uh for example uh imagine a financial institution where you're your um user ID is your social",
    "start": "3975200",
    "end": "3982240"
  },
  {
    "text": "security number and I and I I know there are some some um banks that actually use this some 401K management uh tool",
    "start": "3982240",
    "end": "3989079"
  },
  {
    "text": "websites that actually do this and your user ID is based on your your um social security number and a four-digit pin for",
    "start": "3989079",
    "end": "3996079"
  },
  {
    "text": "example so take the pin of 7777 and just guess uh different Social Security numbers until you get a hint but one of",
    "start": "3996079",
    "end": "4002920"
  },
  {
    "text": "the the implications of having uh the username and password P every single authentication is that one you need to",
    "start": "4002920",
    "end": "4009279"
  },
  {
    "text": "make you need you definitely need you need to of course ensure the confidentiality of the session because",
    "start": "4009279",
    "end": "4015680"
  },
  {
    "text": "with if you were to if it's not over htps if you're to steal the username and password once then you can log in at any",
    "start": "4015680",
    "end": "4022160"
  },
  {
    "text": "other time if it's dynamically generated you steal the you and you steal the session token you can still only log in",
    "start": "4022160",
    "end": "4028640"
  },
  {
    "text": "during that 20 minute or 30 minute time window you can't wait a week and then be able to log in so there's one",
    "start": "4028640",
    "end": "4034039"
  },
  {
    "text": "implication there of using the username and password another implic implication of using username and password is that",
    "start": "4034039",
    "end": "4039839"
  },
  {
    "text": "if you have any type of anti- brute forcing or if you have any type of uh login restriction such as uh restricting",
    "start": "4039839",
    "end": "4046000"
  },
  {
    "text": "concurrent login or lck out then it's much it's much more harder to control because you have to apply it not just to",
    "start": "4046000",
    "end": "4051720"
  },
  {
    "text": "the login page but you have to apply to every single page that's being P those credentials are being passed to so once",
    "start": "4051720",
    "end": "4058000"
  },
  {
    "text": "again it's a it's a develop it's a development Choice it's an architecture choice of of where you're going to",
    "start": "4058000",
    "end": "4063039"
  },
  {
    "text": "handle uh user credentials your user authentication versus session management session",
    "start": "4063039",
    "end": "4068279"
  },
  {
    "text": "authentication other questions cool I think it took us right",
    "start": "4068279",
    "end": "4073920"
  },
  {
    "text": "up to almost the end question",
    "start": "4073920",
    "end": "4078880"
  },
  {
    "text": "yeah so so with that the first the first thing would be uh verifying just the first thing I would I would you know",
    "start": "4126480",
    "end": "4132040"
  },
  {
    "text": "just verifying that the all the cooking that they're sending they're actually you know they're using and they're actually using all if they Define four",
    "start": "4132040",
    "end": "4138838"
  },
  {
    "text": "cookies have to be set for the session you know verify that all four cookies do have to be set and that goes back for",
    "start": "4138839",
    "end": "4144600"
  },
  {
    "text": "example to the Think Geek example where you're given four cookies but only you only need one of them to be a particular",
    "start": "4144600",
    "end": "4149838"
  },
  {
    "text": "user and it's easy to change them but then for you know for checking the um",
    "start": "4149839",
    "end": "4156080"
  },
  {
    "text": "you know automating trying to to t to check is the encryption good or is it",
    "start": "4156080",
    "end": "4161159"
  },
  {
    "text": "Randomness good I I can't give you a good uh a good response on the encryption but definitely one one of the",
    "start": "4161159",
    "end": "4167480"
  },
  {
    "text": "things I would would would start with is just taking taking a large sample size grab a large samples of these cookies do",
    "start": "4167480",
    "end": "4174159"
  },
  {
    "text": "a face bace plot of them try that you know pretty pretty three 3D graphs are are pretty to look at and they can",
    "start": "4174159",
    "end": "4180120"
  },
  {
    "text": "convey some information and for example uh the the ones I had up here just by looking at them they they can they uh",
    "start": "4180120",
    "end": "4186798"
  },
  {
    "text": "give you qualified information they say this looks very disperse they don't give you Quantified so you know you can't say",
    "start": "4186799",
    "end": "4193080"
  },
  {
    "text": "that because this has a standard deviation of 1.0 it's better because this one has a standard deviation of 1.1",
    "start": "4193080",
    "end": "4200080"
  },
  {
    "text": "so but phase Bas can give you can give you underlying time dependencies that might show you predictability and then",
    "start": "4200080",
    "end": "4205920"
  },
  {
    "text": "also to uh just examine the entropy if they are doing uh encryption or they're doing if they're if whatever",
    "start": "4205920",
    "end": "4212679"
  },
  {
    "text": "transformation they're doing if it if they're that transformation for example if it's MD say it's taking a time stamp",
    "start": "4212679",
    "end": "4218719"
  },
  {
    "text": "to md5 you're still taking 32 bits to 128 bits but you haven't increased the entropy if you if you just take a look",
    "start": "4218719",
    "end": "4225440"
  },
  {
    "text": "at take a thousand values take 100,000 values what have you and just see how how many actual bits of entropy you have",
    "start": "4225440",
    "end": "4232239"
  },
  {
    "text": "and even so with time stamps is 32 bits but over a small period of time you're only really looking at 16 bits or maybe",
    "start": "4232239",
    "end": "4239000"
  },
  {
    "text": "even 10 bits of entropy 10 bits is only uh what about five a little under a little under 5,000 values so that's very",
    "start": "4239000",
    "end": "4246440"
  },
  {
    "text": "it's very easy to attack that in a small time period so so that'd be one answer",
    "start": "4246440",
    "end": "4253599"
  },
  {
    "text": "yeah yeah the graphs can the graphs can definitely speak a thousand you know thousand words whether you have distribution or you have Clump or",
    "start": "4255880",
    "end": "4262440"
  },
  {
    "text": "patterns more importantly patterns are ones to look at",
    "start": "4262440",
    "end": "4267198"
  },
  {
    "text": "question um well I would say I I think that using stat Dynamic tokens in PHP is",
    "start": "4274520",
    "end": "4280760"
  },
  {
    "text": "a question and I think very simply is that if you use PHP session session object and their session ID then you got",
    "start": "4280760",
    "end": "4287520"
  },
  {
    "text": "the dynamic and if anytime you're rolling your own cookie you're using the set cookie then you have the potential",
    "start": "4287520",
    "end": "4292760"
  },
  {
    "text": "for a static token or the very least you're using some type of static",
    "start": "4292760",
    "end": "4297719"
  },
  {
    "text": "identifier yeah I'm going to yeah I'll cross my fingers when I say it's okay to assume because you know I don't get",
    "start": "4302840",
    "end": "4308040"
  },
  {
    "text": "burned but of course I think I that's why I put up the these graphs just to show the pretty graph showing that these",
    "start": "4308040",
    "end": "4313679"
  },
  {
    "text": "have large distribution they don't exhibit any any time dependencies so whether you have ASP session idnet",
    "start": "4313679",
    "end": "4319600"
  },
  {
    "text": "session management PHP or uh Tom Cats J session ID know trust those trust what",
    "start": "4319600",
    "end": "4324840"
  },
  {
    "text": "has been used same the same cor corollary with use Dez use AES rather",
    "start": "4324840",
    "end": "4329920"
  },
  {
    "text": "than trying to use exor some type of you know fancy homegrown",
    "start": "4329920",
    "end": "4335280"
  },
  {
    "text": "crypto and I think thanks thank you for the questions appreciate them and do have to close so that next session can",
    "start": "4336920",
    "end": "4342840"
  },
  {
    "text": "come up thank you I",
    "start": "4342840",
    "end": "4348159"
  }
]