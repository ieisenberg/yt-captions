[
  {
    "text": "the talk that I'm gonna give today is called owning a building it's really a look at access control and facility",
    "start": "89",
    "end": "5279"
  },
  {
    "text": "management systems and so hopefully you come away with this thanks to blackhat for having me out here it's an amazing experience and",
    "start": "5279",
    "end": "11690"
  },
  {
    "text": "hopefully you guys will learn something Europe so a little bit about me that's",
    "start": "11690",
    "end": "16800"
  },
  {
    "text": "my handle on twitter if you want to follow me if you go to Twitter and look at my bio it says that I'm a Madagascan",
    "start": "16800",
    "end": "22590"
  },
  {
    "text": "use olive smuggler it's kind of an old story we can talk about at the bar but that is really me I'm currently director",
    "start": "22590",
    "end": "28980"
  },
  {
    "text": "of vulnerability research and threat intelligence at Qualis I had a startup that we basically spun it up called spear point that was acquired by another",
    "start": "28980",
    "end": "34950"
  },
  {
    "text": "company called silence and I worked at Google previously I was a tech lead for a Google security team called whoops",
    "start": "34950",
    "end": "40350"
  },
  {
    "text": "really good experience there whoop stands for web or other product security so it's pretty neat um I was also a",
    "start": "40350",
    "end": "47039"
  },
  {
    "text": "release engineer for Google Plus I worked at Microsoft as well I was a security program manager for Internet",
    "start": "47039",
    "end": "53010"
  },
  {
    "text": "Explorer it's a piece of software pi never heard of but I also did some release engineering for online services so pretty neat stuff I have a couple",
    "start": "53010",
    "end": "60359"
  },
  {
    "text": "degrees I don't think it really matters here but um published a couple of books but I actually booked this guy here so",
    "start": "60359",
    "end": "66180"
  },
  {
    "text": "co-author but I think most importantly been looking into industrial control systems over the last couple years and",
    "start": "66180",
    "end": "71790"
  },
  {
    "text": "we have about it says thirty publicly credited you know ics-cert advisories I",
    "start": "71790",
    "end": "77490"
  },
  {
    "text": "think it's a little bit more and I still think I did this with a colleague of mine I still think we are like the top",
    "start": "77490",
    "end": "83100"
  },
  {
    "text": "you know group to have the most ICS or advisories if that means anything to anyone so but we've worked with a lot of",
    "start": "83100",
    "end": "88799"
  },
  {
    "text": "different vendors that we report over a thousand different issues to DHS mostly involving industrial control system so",
    "start": "88799",
    "end": "93990"
  },
  {
    "text": "some of them will probably never be fixed and if we find an interesting time you can probable so but I wanted to talk",
    "start": "93990",
    "end": "101880"
  },
  {
    "text": "to you about facility management controls and buildings essentially and so why you know you always want to ask",
    "start": "101880",
    "end": "107369"
  },
  {
    "text": "yourself why why is it important to me so we actually know that buildings are being attacked so if you look at this",
    "start": "107369",
    "end": "113610"
  },
  {
    "text": "ics-cert monthly monitor from last year it was the January to March monthly monitor there's a link up there if you want take a look at it for yourself we",
    "start": "113610",
    "end": "120299"
  },
  {
    "text": "know that publicly acknowledged there's two buildings that were attacked their energy management systems were attacked",
    "start": "120299",
    "end": "125340"
  },
  {
    "text": "so one was a state facility I don't know where it was but basically a government",
    "start": "125340",
    "end": "131550"
  },
  {
    "text": "facility blowing to a state so a state agency of some kind the other one was a manufacturing plant in New Jersey so and when you",
    "start": "131550",
    "end": "138579"
  },
  {
    "text": "think about these these incidents so the way that I think about it is most of the damage that someone would probably do",
    "start": "138579",
    "end": "144310"
  },
  {
    "text": "via energy management system or a facility management system will probably go on notice in fact if something",
    "start": "144310",
    "end": "149530"
  },
  {
    "text": "changes or something breaks I probably just call a technician and the technician will probably just change whatever broke so in order for someone",
    "start": "149530",
    "end": "155829"
  },
  {
    "text": "to be called in specifically an order for DHS to be called in to investigate something it's probably pretty significant so if your air conditioning",
    "start": "155829",
    "end": "162939"
  },
  {
    "text": "goes out even if it's a very sensitive facility like a hospital or surgical center you might be able to fix it",
    "start": "162939",
    "end": "169120"
  },
  {
    "text": "pretty quickly right but to have some kind of effect where it's so bad that you want to reach out to some place like",
    "start": "169120",
    "end": "174579"
  },
  {
    "text": "DHS that's probably really bad right so the details of what happened here they're not revealed but just kind of",
    "start": "174579",
    "end": "181510"
  },
  {
    "text": "you know maybe pulling some threads here and trying to figure out what happened you know to the end organization it's",
    "start": "181510",
    "end": "187510"
  },
  {
    "text": "hard to say and the reason that it's hard to say is because each building management system is the same but the",
    "start": "187510",
    "end": "193659"
  },
  {
    "text": "buildings that they manage are all different right so pretty much every single building that you'll run into the",
    "start": "193659",
    "end": "198940"
  },
  {
    "text": "way that they're configured and the way that the building management system runs the building whether it's energy management or access control or just",
    "start": "198940",
    "end": "205000"
  },
  {
    "text": "environmental control usually it's done differently from even the building that's gonna be next door so that's something that's very important to",
    "start": "205000",
    "end": "210549"
  },
  {
    "text": "understand so the more you understand about the various pieces which kind of stay the same the better but when you actually take",
    "start": "210549",
    "end": "216819"
  },
  {
    "text": "over a building the facility management system or the energy management system pretty much every time you do it's gonna be different right so you know what is",
    "start": "216819",
    "end": "224440"
  },
  {
    "text": "the facility management system they're very invisible if you haven't fortune one if you're a fortune 1000 if you have",
    "start": "224440",
    "end": "230409"
  },
  {
    "text": "a corporate campus if you have a badge reader on a door that you go into for work you actually have facility",
    "start": "230409",
    "end": "236049"
  },
  {
    "text": "management system building management system building automation system whatever you want to call it you actually have those in the building this",
    "start": "236049",
    "end": "241930"
  },
  {
    "text": "facility that we're in right now has tons of facility management systems in it so it includes things like card",
    "start": "241930",
    "end": "247930"
  },
  {
    "text": "access it's not magic you know a lot of times what happens is the little badge reader on the door it doesn't make a",
    "start": "247930",
    "end": "253299"
  },
  {
    "text": "decision by itself what it does it just collects data and basically sends it off to a controller someplace and the",
    "start": "253299",
    "end": "258639"
  },
  {
    "text": "controller actually forwards at someplace else whether it's a database lookup or other some other type of lookup basically does the logic and an",
    "start": "258639",
    "end": "264849"
  },
  {
    "text": "application server and then sends data back saying you should unlock or not unlock or do something else so same thing with video",
    "start": "264849",
    "end": "270560"
  },
  {
    "text": "right so every modern facility has surveillance a lot of times what's going to be what's going to be allowed is the",
    "start": "270560",
    "end": "276950"
  },
  {
    "text": "people doing the surveillance can probably pan the camera or zoom in zoom out take a look at things switch cameras",
    "start": "276950",
    "end": "282520"
  },
  {
    "text": "you know back in the day this used to be closed-circuit but all this is moved to IP now so it's pretty interesting a lot",
    "start": "282520",
    "end": "287900"
  },
  {
    "text": "of its managed over HTTP intrusion so when I say intrusion I'm not talking about like snort or anything like that",
    "start": "287900",
    "end": "294170"
  },
  {
    "text": "I'm talking about like if someone breaks a window or kicks in the door if it's a if it's a modern facility alarm is gonna",
    "start": "294170",
    "end": "300140"
  },
  {
    "text": "go off and someone's gonna get notified the way that they do that is via sensors when the sensors detect that a window",
    "start": "300140",
    "end": "305270"
  },
  {
    "text": "has been broken or doors been kicked in it'll actually send a signal someplace saying hey something bad just happened you should either a trigger alarm a",
    "start": "305270",
    "end": "311540"
  },
  {
    "text": "silent alarm a real alarm contact security make a phone call there's all sorts of different things that can happen so these are physical intrusion",
    "start": "311540",
    "end": "317720"
  },
  {
    "text": "devices elevators when you badge into an elevator with your with your room key and say hey I need to go to the 19th",
    "start": "317720",
    "end": "323690"
  },
  {
    "text": "floor or whatever there's actually a computer on the back end that's making that decision saying hey should this person be allowed to get off on that",
    "start": "323690",
    "end": "329660"
  },
  {
    "text": "floor or not right so HVAC we're gonna cover some of these examples here for HVAC specifically this is probably the most",
    "start": "329660",
    "end": "336620"
  },
  {
    "text": "common facility management system that we see in general and the reason this is probably one of the most common facility",
    "start": "336620",
    "end": "342560"
  },
  {
    "text": "management systems that we see is not because it's cool it's because it's very cost effective so when businesses do",
    "start": "342560",
    "end": "348290"
  },
  {
    "text": "HVAC via building management system they're doing it because it's cost-effective they're gonna save money",
    "start": "348290",
    "end": "353420"
  },
  {
    "text": "and I'll give you an example of how they save money so we looked at a data center here a couple years ago and basically if",
    "start": "353420",
    "end": "360590"
  },
  {
    "text": "you have a data center it's going to have building automation systems the environmental controls for the data center are gonna be controlled by",
    "start": "360590",
    "end": "366170"
  },
  {
    "text": "computers those are facility management systems those are building automation systems building management systems and",
    "start": "366170",
    "end": "371540"
  },
  {
    "text": "what this particular data center was doing was it was basically monitoring the prices of energy so if it were",
    "start": "371540",
    "end": "377930"
  },
  {
    "text": "cheaper to run on fuel it would switch all the energy to fuel if it were cheaper to run off the grid it would switch to the grid if it was cheaper to",
    "start": "377930",
    "end": "385040"
  },
  {
    "text": "pull in cold air from the outside as opposed to just generating cold air via the air conditioners it would do that",
    "start": "385040",
    "end": "390560"
  },
  {
    "text": "and so what I was doing is just understanding what's the cheapest way to basically cool this data center and constantly readjusting all the time and",
    "start": "390560",
    "end": "397310"
  },
  {
    "text": "this resulted in like tremendous cost savings for the organization that installed these systems and that's why they did it they didn't",
    "start": "397310",
    "end": "402530"
  },
  {
    "text": "do it because it was cool they did it cuz they at the end of the day they know it that they're gonna save money and that's why a lot of buildings have",
    "start": "402530",
    "end": "407540"
  },
  {
    "text": "building management systems in them especially things for environmental control same up lighting it's becoming",
    "start": "407540",
    "end": "413000"
  },
  {
    "text": "more and more common to control lighting via you know like building management system it's the same reason just for",
    "start": "413000",
    "end": "418940"
  },
  {
    "text": "cost-effectiveness energy energy savings cost savings so and you can actually do",
    "start": "418940",
    "end": "423950"
  },
  {
    "text": "a really cool thing so if you live in a building and you shared that building with a lot of other folks and you get an",
    "start": "423950",
    "end": "429350"
  },
  {
    "text": "electricity bill it's probably done by a building management system the building management system understands what your electricity usage is for a given point",
    "start": "429350",
    "end": "435950"
  },
  {
    "text": "in time and then basically sends you a bill for that particular usage right so it's pretty cool it's pretty interesting stuff and so what we're starting to see",
    "start": "435950",
    "end": "443060"
  },
  {
    "text": "that's pretty recent as consolidation of all these different systems so if you look at these systems in the past",
    "start": "443060",
    "end": "448370"
  },
  {
    "text": "they've all been these different siloed systems that basically never talk to each other but we're actually starting",
    "start": "448370",
    "end": "453440"
  },
  {
    "text": "to see now is they're all starting to be consolidated together a good example of something that's already consolidated",
    "start": "453440",
    "end": "458570"
  },
  {
    "text": "together in a very meaningful way our fire alarming systems we've taken a look at a number of different fire alarming",
    "start": "458570",
    "end": "464600"
  },
  {
    "text": "systems so if a fire alarm goes off in like a facility like this it's gonna trigger a bunch of different events so",
    "start": "464600",
    "end": "470360"
  },
  {
    "text": "the fire alarming system is probably going to notify our fire department someplace and say hey look based on the sensors that I have in the",
    "start": "470360",
    "end": "476030"
  },
  {
    "text": "facility I think the fire is this big it's on this floor it's this type of fire fire whether it's chemical or wood or whatever it's gonna notify those",
    "start": "476030",
    "end": "482630"
  },
  {
    "text": "people there but it'll also do really interesting things like maybe it'll turn off the HVAC systems for that particular floor so the smoke won't get put into",
    "start": "482630",
    "end": "489590"
  },
  {
    "text": "the ducts and things like that maybe it'll turn off certain electrical systems maybe it'll disable the elevator so we're starting to see that these",
    "start": "489590",
    "end": "495380"
  },
  {
    "text": "building management systems are starting to be consolidated they're all starting to talk to each other and they basically can control each other which is actually",
    "start": "495380",
    "end": "501620"
  },
  {
    "text": "really interesting I'm gonna talk about a couple different volunteer and the",
    "start": "501620",
    "end": "506810"
  },
  {
    "text": "reason I think this one is there's just a bunch of different vulnerabilities but the reason I think these ones are interesting it's called I call this a device password retrieval vulnerability",
    "start": "506810",
    "end": "513560"
  },
  {
    "text": "the reason I think this was interesting it's because all the building management systems ever looked at have this",
    "start": "513560",
    "end": "518690"
  },
  {
    "text": "vulnerability for some reason where you can actually just touch the building management system remotely and pull the password out so I don't know if it's",
    "start": "518690",
    "end": "525920"
  },
  {
    "text": "like one person basically working on all these building management systems or if it's just some weird thing or design the",
    "start": "525920",
    "end": "531080"
  },
  {
    "text": "way these folks are taught but we've come across to cut a couple different so these two building management systems",
    "start": "531080",
    "end": "536240"
  },
  {
    "text": "are presented up here the Niagra framework and medicine they're probably two of the most popular building managed systems in the world so",
    "start": "536240",
    "end": "541880"
  },
  {
    "text": "and so for the Niagra basically an authenticated user can retrieve the device password that's just the end of",
    "start": "541880",
    "end": "546889"
  },
  {
    "text": "story device passwords actually encode it so it's not encrypted it's not hashed or anything like that if you know how they",
    "start": "546889",
    "end": "552230"
  },
  {
    "text": "encode it you can decode it so we know how they encoded it so we can decode the passwords and then once you decode the password you can have the clear text",
    "start": "552230",
    "end": "558199"
  },
  {
    "text": "password you can log in to any with any account that you want you most likely want to log in with the administrator",
    "start": "558199",
    "end": "563870"
  },
  {
    "text": "account and so whatever system that building management system is running on it can run on three different platforms",
    "start": "563870",
    "end": "570230"
  },
  {
    "text": "it can run on Windows it can run on Q and X and it can run on links right so if you get it on a Windows box off",
    "start": "570230",
    "end": "576709"
  },
  {
    "text": "system if you get it on a Q an Xbox or Linux box you get root so because the framework is running as root and that's",
    "start": "576709",
    "end": "583130"
  },
  {
    "text": "pretty cool because you get root on the underlying device right so if that device is connected to something via",
    "start": "583130",
    "end": "588860"
  },
  {
    "text": "unauthenticated protocol or clear-text protocol like bacnet or Modbus whatever it's connected to or whatever network",
    "start": "588860",
    "end": "594889"
  },
  {
    "text": "it's on you'll be able to talk to those devices as well if it's a if it's a Windows machine since your system you'll",
    "start": "594889",
    "end": "600320"
  },
  {
    "text": "be able to extract any kind of creds off of there so if an admin and logged in to their or domain admin or something like that you'll be able to get their",
    "start": "600320",
    "end": "605720"
  },
  {
    "text": "password off that's kind of same with the medicine authenticated user can retrieve the device password in this",
    "start": "605720",
    "end": "612380"
  },
  {
    "text": "case the passwords actually hashed its shot one but you can also do an authenticated password reset for any",
    "start": "612380",
    "end": "617930"
  },
  {
    "text": "user so if for some reason one of the users like the admin user has a really stout password you could just password",
    "start": "617930",
    "end": "623779"
  },
  {
    "text": "reset and then log in with any password that you want right so essentially it's authentication well essentially that's",
    "start": "623779",
    "end": "629149"
  },
  {
    "text": "an authentication bypass but there are other bugs that just allow you to do authentication bypasses call various",
    "start": "629149",
    "end": "634699"
  },
  {
    "text": "things to interact with the device and make it do things and then there's also a way to compromise the underlying",
    "start": "634699",
    "end": "641060"
  },
  {
    "text": "system which is always interesting because the frameworks are really good in fact they're developed to allow",
    "start": "641060",
    "end": "646519"
  },
  {
    "text": "engineers and operators to easily manage the devices that they're connected to right because you don't want engineers",
    "start": "646519",
    "end": "652010"
  },
  {
    "text": "to have to write Modbus or back at every single time they want to adjust the temperature point for an HVAC system so",
    "start": "652010",
    "end": "657500"
  },
  {
    "text": "you want to make it very easy for them you want them to literally click a button and type in a you know temperature and have that temperature",
    "start": "657500",
    "end": "664850"
  },
  {
    "text": "point set to an HVAC system so if you can compromise the underlying system you",
    "start": "664850",
    "end": "670250"
  },
  {
    "text": "don't have to worry about any of the restrictions that the framework puts in so if the framework has some type of restriction that says hey I don't like",
    "start": "670250",
    "end": "676399"
  },
  {
    "text": "you I don't like it when you send malformed Modbus or BACnet to that particular device I don't want to allow that if you've compromised an underlying",
    "start": "676399",
    "end": "683360"
  },
  {
    "text": "system you can just do it yourself you can just do whatever you want right so compromise of the underlying system is always interesting when it comes to",
    "start": "683360",
    "end": "689060"
  },
  {
    "text": "devices like this and then of course for lateral escalation you know lateral escalation reasons a compromising the",
    "start": "689060",
    "end": "695569"
  },
  {
    "text": "underlying system is always important as well so this is the tritium Niagra framework it's not on this device that's",
    "start": "695569",
    "end": "701720"
  },
  {
    "text": "what they look like you know it's like an industrial box it's like a steel box you apply find in a closet someplace this is Johnson controlled medicine",
    "start": "701720",
    "end": "708740"
  },
  {
    "text": "little controller you'll probably find this in a closet someplace as well this is not something that you would see like mounted onto the wall on your hotel room",
    "start": "708740",
    "end": "715190"
  },
  {
    "text": "this is actually the controller so the you know the thermostat and the environmental controls in your room",
    "start": "715190",
    "end": "720319"
  },
  {
    "text": "would actually communicate to this device someplace in a closet somewhere so the first thing we want to talk about",
    "start": "720319",
    "end": "726050"
  },
  {
    "text": "is physical security because much like regular computers if you have physical access to one of these devices the",
    "start": "726050",
    "end": "731360"
  },
  {
    "text": "controllers it's game over it's by design every single vendor every single person acknowledges that that's",
    "start": "731360",
    "end": "736519"
  },
  {
    "text": "why they always recommend that you lock these things up and don't allow anyone to have physical access to it right so a",
    "start": "736519",
    "end": "741529"
  },
  {
    "text": "lot of times they'll have console access or if you can get to it you can either plug in usually via serial rs-232 rs-485",
    "start": "741529",
    "end": "747889"
  },
  {
    "text": "and you'll just have a shell essentially on the device usually at a very privileged level so the technician and",
    "start": "747889",
    "end": "753800"
  },
  {
    "text": "services passwords they almost always work when you have physical access to the device so if you know a technician or service credential you should be able",
    "start": "753800",
    "end": "759319"
  },
  {
    "text": "to log into this device pretty simply and then most importantly is whatever network gets connected to you if you",
    "start": "759319",
    "end": "764660"
  },
  {
    "text": "have physical access to it you'll have access to that network as well and so and the reason that's important is because you'll have access to things",
    "start": "764660",
    "end": "770899"
  },
  {
    "text": "like BACnet the building you know building automation and control network it's an unauthenticated protocol it's",
    "start": "770899",
    "end": "776000"
  },
  {
    "text": "clear text so basically devices are just sitting listening on this network to bacnet and if you get onto that network",
    "start": "776000",
    "end": "782750"
  },
  {
    "text": "somehow you'll be able to talk to all the devices on the network that's just the way it's designed so and the cool",
    "start": "782750",
    "end": "788720"
  },
  {
    "text": "thing about that is a good friend of mine Michael toker he actually wrote a script to enumerate BACnet devices and",
    "start": "788720",
    "end": "795740"
  },
  {
    "text": "he put it into nmap so you can go to digital bonds website and you can actually download this",
    "start": "795740",
    "end": "801500"
  },
  {
    "text": "this and Matt and Matt script it's intended to be run on an internal network but nothing is stopping anyone",
    "start": "801500",
    "end": "807080"
  },
  {
    "text": "from running it on the Internet right so in fact if you do run it on the internet you will actually find bacnet devices listening on the internet so this",
    "start": "807080",
    "end": "813800"
  },
  {
    "text": "particular one is a biomed boiler system so and as you can see with industrial",
    "start": "813800",
    "end": "819440"
  },
  {
    "text": "control systems they a lot oftentimes they like to give up a lot of information about what they are so the",
    "start": "819440",
    "end": "825770"
  },
  {
    "text": "way that this is the way that this enumeration actually works is pretty clever what mike basically did here was",
    "start": "825770",
    "end": "831320"
  },
  {
    "text": "there's a way to query a system where it's in the spec where the device will",
    "start": "831320",
    "end": "836330"
  },
  {
    "text": "actually respond with an error right and so if you see that error message you know that that's actually a back net enabled device and then once you know",
    "start": "836330",
    "end": "842570"
  },
  {
    "text": "that it's a back net enabled device you can actually query it for information like this all right so this is the end map plug the end map script that's",
    "start": "842570",
    "end": "849920"
  },
  {
    "text": "that's there so anyone can download this and you can actually start running this on your internal network to find out where your back net devices are so",
    "start": "849920",
    "end": "856660"
  },
  {
    "text": "pretty interesting stuff so the physical access piece it's extremely important",
    "start": "856660",
    "end": "862070"
  },
  {
    "text": "right because once you have access to the back net the building automation control network you'll be able to talk",
    "start": "862070",
    "end": "867230"
  },
  {
    "text": "to any device on the network so and having physical control over a public",
    "start": "867230",
    "end": "872270"
  },
  {
    "text": "building it's really hard right it's very very hard so take this device here",
    "start": "872270",
    "end": "877310"
  },
  {
    "text": "for example it's little hard to see this actually thermostat and on the bottom it's got a rj45 jack so it's it's not",
    "start": "877310",
    "end": "885200"
  },
  {
    "text": "like a network tack this actually I would jack to basically jack into the back net but this device actually",
    "start": "885200",
    "end": "890600"
  },
  {
    "text": "there's probably a better picture does anyone know where this device was where I took this picture at where's that no",
    "start": "890600",
    "end": "900050"
  },
  {
    "text": "what's not here yeah yeah this was taken at a Atlanta Airport so hundreds of",
    "start": "900050",
    "end": "907790"
  },
  {
    "text": "these thermostats everywhere right and if you plug into one of them you get on back net you can talk to any device",
    "start": "907790",
    "end": "913460"
  },
  {
    "text": "that's on the airport back net right so pretty interesting so what about this one anyone know where I found this one",
    "start": "913460",
    "end": "920290"
  },
  {
    "text": "this one's really dirty like this is the dirtiest thing I ever saw and that's why I took a picture of it I was like that's pretty interesting so because there's",
    "start": "920290",
    "end": "927080"
  },
  {
    "text": "hundreds of these hundreds of them this is at sea like I said it's really dirty so same thing rj45 jack on the bottom",
    "start": "927080",
    "end": "934490"
  },
  {
    "text": "you plug into that bacnet is that actually at Salt Lake City Airport so if you have a public",
    "start": "934490",
    "end": "939860"
  },
  {
    "text": "facility and you have things like this telling you right now it's almost impossible to keep someone off the",
    "start": "939860",
    "end": "945290"
  },
  {
    "text": "building automation control network especially if you have access points like this where someone can just plug in so and so more about the vulnerabilities",
    "start": "945290",
    "end": "954530"
  },
  {
    "text": "so the Niagra framework we reported a couple different vulnerabilities to them and said hey you really need fix T's and",
    "start": "954530",
    "end": "961370"
  },
  {
    "text": "so they did and so some of the vulnerabilities that we came across the password retrieval even the way that",
    "start": "961370",
    "end": "966860"
  },
  {
    "text": "they store their passwords the encoded way that they answer we called it in crashing they actually fixed it now they hash their passwords and they use a salt",
    "start": "966860",
    "end": "973040"
  },
  {
    "text": "so it's pretty cool so I'm gonna show a couple slides here about the you know about the vulnerabilities but if you",
    "start": "973040",
    "end": "978200"
  },
  {
    "text": "actually download the latest patch those vulnerabilities don't work anymore so that's pretty neat - this on the other",
    "start": "978200",
    "end": "983360"
  },
  {
    "text": "hand we contacted them in November we always contact people through DHS right",
    "start": "983360",
    "end": "988520"
  },
  {
    "text": "so we have a third party that can kind of track and say hey this is when they notified us or whatever so that was April 22nd and we never heard back to",
    "start": "988520",
    "end": "995870"
  },
  {
    "text": "them so actually until last week they're like hey what are you guys gonna talk about next week like I don't know maybe",
    "start": "995870",
    "end": "1001660"
  },
  {
    "text": "your device so well if we look deeper into medicine which is what we're going to kind of deep dive into today the device that we",
    "start": "1001660",
    "end": "1008440"
  },
  {
    "text": "have actually runs when c/e so that's actually really really interesting because a lot of the tools",
    "start": "1008440",
    "end": "1013450"
  },
  {
    "text": "that we have can basically disassemble anything that we haven't went segi pretty easily right so in fact when we",
    "start": "1013450",
    "end": "1018670"
  },
  {
    "text": "load a lot of the portable executables into Ida Pro it says hey these are x86 executables so it's pretty cool and then",
    "start": "1018670",
    "end": "1026050"
  },
  {
    "text": "some of the files are actually dotnet assemblies we're gonna look at one of the dotnet assemblies here in a bit and so if we look at the file system so if",
    "start": "1026050",
    "end": "1032470"
  },
  {
    "text": "you get one of these devices you get access to a device or you have some kind of exploit or wherever or you actually",
    "start": "1032470",
    "end": "1037540"
  },
  {
    "text": "own a device we look at the actual way it works as a meta device so there's a flash on there it's not it's not a drive",
    "start": "1037540",
    "end": "1043420"
  },
  {
    "text": "you can't go to Lexi Cole or anything like that it just says slash right if you go to slash medicine that's where all the audit logs and configuration",
    "start": "1043420",
    "end": "1049780"
  },
  {
    "text": "files are right so it's pretty important there's also another directory called missus slash secure DB security VX ml",
    "start": "1049780",
    "end": "1056230"
  },
  {
    "text": "that's a that's a file those basically contains all the users and passwords to the device in an XML file",
    "start": "1056230",
    "end": "1061510"
  },
  {
    "text": "they are hashed right there sha-1 so there's an account on a mat assist device it's on every single men assist",
    "start": "1061510",
    "end": "1067660"
  },
  {
    "text": "device called metastasis that is the medicine system agent that is user ID one that is essentially the",
    "start": "1067660",
    "end": "1075130"
  },
  {
    "text": "admin for medicines devices that's the user account name and so when you look",
    "start": "1075130",
    "end": "1080530"
  },
  {
    "text": "at the security DB XML file this is what you'll see so you'll see the user ID of one you'll see a table of users user ID",
    "start": "1080530",
    "end": "1086950"
  },
  {
    "text": "one and you'll see a lot of interesting things like for example there is no account lockout for this this account",
    "start": "1086950",
    "end": "1093070"
  },
  {
    "text": "right because it's admin and this account essentially never never expires so pretty neat and it can't be it's not",
    "start": "1093070",
    "end": "1099250"
  },
  {
    "text": "disabled obviously you could not by the fault as well so I guess you could maybe change these I don't know what it would",
    "start": "1099250",
    "end": "1105130"
  },
  {
    "text": "do if you disabled the sysadmin account I'm not sure this is agent account not really sure so most obvious things the",
    "start": "1105130",
    "end": "1113410"
  },
  {
    "text": "version of Wincy II that is running on the med assist device actually has a shell or if you just tell that to it it'll actually drop you into a shell",
    "start": "1113410",
    "end": "1120100"
  },
  {
    "text": "where your system right so if you're actually looking for these on the internal network that's probably the",
    "start": "1120100",
    "end": "1125290"
  },
  {
    "text": "easiest way to own one of these devices right they also usually have on authenticated FTP open as well so you",
    "start": "1125290",
    "end": "1131050"
  },
  {
    "text": "can FTP into it grab the the security DB dot XML file get all the passwords crack",
    "start": "1131050",
    "end": "1136570"
  },
  {
    "text": "all the passwords or whatever so pretty interesting but probably not to do that because you have to tell me which gives you a show anyway all right so pretty",
    "start": "1136570",
    "end": "1142060"
  },
  {
    "text": "neat yeah I don't know who made that decision right but like is this what needs to happen like no more for you",
    "start": "1142060",
    "end": "1148030"
  },
  {
    "text": "right no more so a little bit more about the filesystem there's slash storage that can check",
    "start": "1148030",
    "end": "1154540"
  },
  {
    "text": "that contains a bunch of crash dumps and it contains a bunch of memory dumps as well so if the device ever crashes for",
    "start": "1154540",
    "end": "1159640"
  },
  {
    "text": "any reason that's where those files are going to be held those are pretty interesting especially maybe for doing forensics or something like that to see",
    "start": "1159640",
    "end": "1165190"
  },
  {
    "text": "why a particular device crashed and you know what caused it so storage last metastasize preferences that's where the",
    "start": "1165190",
    "end": "1171970"
  },
  {
    "text": "user system preferences are stored very interesting and then there's another directory storage medicine secure DB as",
    "start": "1171970",
    "end": "1177580"
  },
  {
    "text": "a copy of the security DVD XML file if you don't want to use the XML file you can actually use a real database file",
    "start": "1177580",
    "end": "1183820"
  },
  {
    "text": "it's called it's an SDF file which is basically like a compact compact file",
    "start": "1183820",
    "end": "1188920"
  },
  {
    "text": "format you can connect to it via just regular Davis driver and basically query it's it's basically the same thing as a",
    "start": "1188920",
    "end": "1195190"
  },
  {
    "text": "security benign XML it's got the username and password to some of the configuration stuff for users so but",
    "start": "1195190",
    "end": "1201490"
  },
  {
    "text": "what's important to me is the thing that's probably gonna be facing if someone tries to lock down the shell and the FTP is the web interface",
    "start": "1201490",
    "end": "1207820"
  },
  {
    "text": "because that's how engineers and operators actually manage these devices this is a web interface so if you look",
    "start": "1207820",
    "end": "1214540"
  },
  {
    "text": "at storage medicine uproot / meta cysts X X X the XS the X's are actually the",
    "start": "1214540",
    "end": "1219670"
  },
  {
    "text": "versions that's where the application logic for the web interface is so very interesting to me the web route actually",
    "start": "1219670",
    "end": "1225610"
  },
  {
    "text": "contains like 50 jars and if you actually connect to the web interface those jars will get downloaded to your",
    "start": "1225610",
    "end": "1231490"
  },
  {
    "text": "local system it med assist does this tritium does this I don't know why they do this but it ends up putting like 50",
    "start": "1231490",
    "end": "1237280"
  },
  {
    "text": "and if they get some tritium installations it'll put like a hundred jars on your local filesystem so not",
    "start": "1237280",
    "end": "1242860"
  },
  {
    "text": "it's on the server but they'll also get pushed your client so which is pretty crazy and then so if we look at a /ws",
    "start": "1242860",
    "end": "1250720"
  },
  {
    "text": "there's actually a web service code in there that's pretty cool and so if we",
    "start": "1250720",
    "end": "1255760"
  },
  {
    "text": "look at how the application logic is implemented if we look at /ws which is for web servers /bin we actually see",
    "start": "1255760",
    "end": "1262090"
  },
  {
    "text": "precompiled dotnet assemblies in there so they don't just have like aspx files where you can just read the source code",
    "start": "1262090",
    "end": "1267310"
  },
  {
    "text": "right but anyone that knows dotnet knows that it's you know I also it's easily like basically reversed right so you can",
    "start": "1267310",
    "end": "1274360"
  },
  {
    "text": "get the source code if you have the binaries if you have the DLL so I'm not sure of the engineers that Menace's were aware of that or not but so as soon as",
    "start": "1274360",
    "end": "1280720"
  },
  {
    "text": "you get the DLL is you can basically get the source code for all the details so and reversing diviners actually revealed some pretty interesting books so when we",
    "start": "1280720",
    "end": "1289300"
  },
  {
    "text": "look at the dotnet assemblies we see things that will retrieve a directory listing from the device which is pretty",
    "start": "1289300",
    "end": "1295180"
  },
  {
    "text": "cool upload arbitrary files to arbitrary locations which is really neat there's",
    "start": "1295180",
    "end": "1300520"
  },
  {
    "text": "also web services to retreat retrieve user information including the password hash right because retrieving a password",
    "start": "1300520",
    "end": "1307270"
  },
  {
    "text": "hash is a really highly requested feature that's super popular right so every device should have some web",
    "start": "1307270",
    "end": "1312910"
  },
  {
    "text": "service to retrieve a user's password hash and so if we take a look at web service command DLL this is what we see",
    "start": "1312910",
    "end": "1319840"
  },
  {
    "text": "and on that reflector right so there's a bunch of different classes in here probably the most important to me right",
    "start": "1319840",
    "end": "1324880"
  },
  {
    "text": "now is dot security right so if we take a look at that security it has a bunch of different methods that we can call",
    "start": "1324880",
    "end": "1330970"
  },
  {
    "text": "one of which is the administration service and if we look at you know a lot of things that are stored in there we",
    "start": "1330970",
    "end": "1336340"
  },
  {
    "text": "basically like a method called get user property which takes an int which is a user ID so this is pretty valuable since",
    "start": "1336340",
    "end": "1343630"
  },
  {
    "text": "we know that the medicine sis agent is always user ID one that's pretty cool and if we look at the",
    "start": "1343630",
    "end": "1348640"
  },
  {
    "text": "description it always returns a property for a single user stored in the database whether that's the XML file or the actual database file pretty interesting",
    "start": "1348640",
    "end": "1354909"
  },
  {
    "text": "stuff so if we look at a different DLL subsystem is that common dot DLL we see",
    "start": "1354909",
    "end": "1360159"
  },
  {
    "text": "that it also has a dot security as well and if we dig a little bit deeper in there and subsystems command dot DLL we",
    "start": "1360159",
    "end": "1365860"
  },
  {
    "text": "see a function called principle store right and this is basically where user names and passwords and user information",
    "start": "1365860",
    "end": "1371559"
  },
  {
    "text": "is getting written and retrieved from the device so never mind the inter",
    "start": "1371559",
    "end": "1376690"
  },
  {
    "text": "computer user and the metastasis agent default password don't worry about that for now pretty straightforward but the",
    "start": "1376690",
    "end": "1383320"
  },
  {
    "text": "principle store is pretty interesting because it takes a user ID and a login name and then if we look at how that",
    "start": "1383320",
    "end": "1388360"
  },
  {
    "text": "thing actually works essentially just grabs all the information about a particular user and just puts in an",
    "start": "1388360",
    "end": "1393399"
  },
  {
    "text": "object and so if a web service ever calls it it'll just return this giant blob of data which is really interesting",
    "start": "1393399",
    "end": "1398470"
  },
  {
    "text": "right so principle store get user property and so the way that we would actually call this web service is just",
    "start": "1398470",
    "end": "1404770"
  },
  {
    "text": "by going to the security slash admin service not a SaaS MX web service and",
    "start": "1404770",
    "end": "1410020"
  },
  {
    "text": "just doing a simple post requests like you know like like any good web service and just say hey I want to use get user",
    "start": "1410020",
    "end": "1415929"
  },
  {
    "text": "property and give me user ID one and it'll give you a response like this right the most important thing is likely",
    "start": "1415929",
    "end": "1422230"
  },
  {
    "text": "the username and of course the password hash for the device for that particular user right pretty cool so so writing a",
    "start": "1422230",
    "end": "1432250"
  },
  {
    "text": "web service to retrieve a user password is pretty bad but it gets worse if you",
    "start": "1432250",
    "end": "1438159"
  },
  {
    "text": "just forget to do one thing does anyone know what that one thing is if you",
    "start": "1438159",
    "end": "1445750"
  },
  {
    "text": "forget to put the web search behind authentication right so if the web service is available to authenticated users then anyone can retrieve the",
    "start": "1445750",
    "end": "1453250"
  },
  {
    "text": "password hash for any user on the device right and so I was like wow and so last",
    "start": "1453250",
    "end": "1458620"
  },
  {
    "text": "week when they're like hey we just were interested when medicines actually contacted me again they're like hey we're gonna give a talk next week sorry",
    "start": "1458620",
    "end": "1465399"
  },
  {
    "text": "we hadn't talked to you in the last three months but we're just kind of interested in how you would fix it vulnerability like we know how we would",
    "start": "1465399",
    "end": "1472210"
  },
  {
    "text": "fix it the word is kind of interested in what your thoughts are and I was like well first off you probably don't need to retrieve people's passwords second",
    "start": "1472210",
    "end": "1478720"
  },
  {
    "text": "off you should probably put this behind authentication right so you know I was talking to I was like wow you know",
    "start": "1478720",
    "end": "1483730"
  },
  {
    "text": "whoever wrote that web service like had one job right like hey you had one job",
    "start": "1483730",
    "end": "1489130"
  },
  {
    "text": "you had one job right you wrote this web service and you forgot to put it behind",
    "start": "1489130",
    "end": "1494410"
  },
  {
    "text": "authentication right you had one job like man it's pretty bad so that's pretty cool though so when you",
    "start": "1494410",
    "end": "1501610"
  },
  {
    "text": "get a username and a password and you log into a device this is what you'll see and so this is interesting because I",
    "start": "1501610",
    "end": "1507130"
  },
  {
    "text": "always want to show people this because a lot of times people are very intimidated by things like building management systems facility management",
    "start": "1507130",
    "end": "1513310"
  },
  {
    "text": "systems they think it's just weird thing you know where you drop in and it's like totally you know you can't comprehend",
    "start": "1513310",
    "end": "1518500"
  },
  {
    "text": "what's going on that it's the furthest thing from the truth in fact when you log into a built a modern building management system you're",
    "start": "1518500",
    "end": "1523900"
  },
  {
    "text": "gonna see something like this right it's very user friendly it's usually just a web interface for you just say hey look",
    "start": "1523900",
    "end": "1529120"
  },
  {
    "text": "I want to push this button and reset this set point for this particular device or do whatever it is so if you",
    "start": "1529120",
    "end": "1534310"
  },
  {
    "text": "drop down to the underlying device and you want to communicate to a device in a way that's not intended to be communicated to things get a little bit",
    "start": "1534310",
    "end": "1539590"
  },
  {
    "text": "more complicated we actually have to understand the protocols law sort of stuff but for the most part if you want to do a lot of damage to a building and",
    "start": "1539590",
    "end": "1544960"
  },
  {
    "text": "you log into the building management system you just have to point and click so it's pretty straightforward and so I",
    "start": "1544960",
    "end": "1550450"
  },
  {
    "text": "want to talk to you about how prevalent these building management systems are on the Internet right because this is actually really important most important part of the",
    "start": "1550450",
    "end": "1556360"
  },
  {
    "text": "whole talk we basically created this enumeration effort to find as many building management systems on the",
    "start": "1556360",
    "end": "1561550"
  },
  {
    "text": "Internet as we could so initially based off showed an but we moved to some custom scanners in ec2 right so we found",
    "start": "1561550",
    "end": "1568900"
  },
  {
    "text": "like 50,000 buildings right most of them are most of them exposed to internet they're exposed to the internet most",
    "start": "1568900",
    "end": "1574150"
  },
  {
    "text": "summer out dated right so we could run exploits against them basically take over the buildings in any way that we want so stadiums hospitals police",
    "start": "1574150",
    "end": "1580450"
  },
  {
    "text": "stations prisons military installations like everything you can imagine in fact I brought with me excel spreadsheet of",
    "start": "1580450",
    "end": "1588280"
  },
  {
    "text": "stuff that I found on the internet we can just if you want to I'll just let you guys say hey I want to search your police station and I'll just like you",
    "start": "1588280",
    "end": "1594160"
  },
  {
    "text": "know control left we can find police stations so all total probably bout 500 bucks to buy the devices from eBay and",
    "start": "1594160",
    "end": "1602110"
  },
  {
    "text": "to in for the ec2 time right so not too expensive okay so they're",
    "start": "1602110",
    "end": "1608050"
  },
  {
    "text": "actually really prevalent on the internet right so what I'll show you here is some stuff that we've done okay",
    "start": "1608050",
    "end": "1623170"
  },
  {
    "text": "so this is my list of stuff right so hold on hold on I'll go to the top and",
    "start": "1623170",
    "end": "1631530"
  },
  {
    "text": "so what you guys know search for but I",
    "start": "1631530",
    "end": "1639420"
  },
  {
    "text": "I've actually looked at stuff in Singapore so there's like some health agencies that I found this spreadsheet",
    "start": "1639420",
    "end": "1646690"
  },
  {
    "text": "that I have actually doesn't have the location um I could easily do it but um and usually when I start on show down I",
    "start": "1646690",
    "end": "1652360"
  },
  {
    "text": "do it by locations why that's probably the best place that's probably the best way to find stuff but this just has names right so if we just have to",
    "start": "1652360",
    "end": "1658720"
  },
  {
    "text": "basically pick names we can find things with certain names right so how about",
    "start": "1658720",
    "end": "1663760"
  },
  {
    "text": "like Bank right that's pretty popular once a bank so there's one right there there's a little one right there alright",
    "start": "1663760",
    "end": "1669970"
  },
  {
    "text": "so there's one right there okay so lots of banks right so those are not names I picked those are those are",
    "start": "1669970",
    "end": "1676270"
  },
  {
    "text": "station names so the devices have these names inside of them right and I'll show you how we got we got these station names here in a second so anything else",
    "start": "1676270",
    "end": "1685230"
  },
  {
    "text": "school donut Street I don't know school there's definitely a",
    "start": "1686580",
    "end": "1693400"
  },
  {
    "text": "lot of schools schools are very popular yep tons of schools",
    "start": "1693400",
    "end": "1699070"
  },
  {
    "text": "defense I don't see any defense in there",
    "start": "1699070",
    "end": "1705509"
  },
  {
    "text": "okay thank God good good good move",
    "start": "1707190",
    "end": "1713590"
  },
  {
    "text": "Hospital hospital hospital some hospitals definitely some hospitals when",
    "start": "1713590",
    "end": "1720790"
  },
  {
    "text": "I say Fox it's basically a protocol that I'm using Johnson is basically a big",
    "start": "1720790",
    "end": "1726400"
  },
  {
    "text": "integrator so I just kind of tag these because I think they're interesting so let me show you how I got this data",
    "start": "1726400",
    "end": "1731890"
  },
  {
    "text": "that's pretty it's pretty straightforward so have some tools basically a really",
    "start": "1731890",
    "end": "1739930"
  },
  {
    "text": "simple script I just get IP addresses for things that I think our building management systems or you could just",
    "start": "1739930",
    "end": "1745570"
  },
  {
    "text": "scan the entire internet like call you know the ipv4 space and you can just say hey run this Python script right and so",
    "start": "1745570",
    "end": "1751930"
  },
  {
    "text": "it'll just take that list of IPs and it just looks up basically like you know the back that thing that we saw there's",
    "start": "1751930",
    "end": "1757720"
  },
  {
    "text": "another protocol called Fox or certain particular building management systems I just query that service and just say hey",
    "start": "1757720",
    "end": "1763240"
  },
  {
    "text": "give me all the data you have about you and so what you basically get is something that's returned like this so",
    "start": "1763240",
    "end": "1769000"
  },
  {
    "text": "at the top is basically what we call the station name so it says Fox that's just",
    "start": "1769000",
    "end": "1774100"
  },
  {
    "text": "a tag for me DSC underscore WS not really sure what that is but it tells us",
    "start": "1774100",
    "end": "1781030"
  },
  {
    "text": "a like a whole bunch of information right so for example this thing's running on Windows XP right so that's pretty interesting it also tells me the",
    "start": "1781030",
    "end": "1787480"
  },
  {
    "text": "exact version that this particular building management system is running as well so which is extremely helpful if I have a bunch of different exploits I",
    "start": "1787480",
    "end": "1793480"
  },
  {
    "text": "know which exploits will work right and tells me what timezone it's in it also tells me what the license ID is for a",
    "start": "1793480",
    "end": "1799300"
  },
  {
    "text": "particular device right so I have another tool where I can take a license ID let's see so this is the license",
    "start": "1799300",
    "end": "1805930"
  },
  {
    "text": "right here so I have another tool or I can say hey given a particular license I",
    "start": "1805930",
    "end": "1813400"
  },
  {
    "text": "want to look up what's basically enabled for that particular license right so this XML file is the actual license that",
    "start": "1813400",
    "end": "1821140"
  },
  {
    "text": "the customer would purchase and the cool thing about this license is it tells you all the features that they're authorized",
    "start": "1821140",
    "end": "1826840"
  },
  {
    "text": "to run right and so if I find a particular component or if I'm looking for something in particular I can",
    "start": "1826840",
    "end": "1832390"
  },
  {
    "text": "basically look at the license files and understand what it is that I want to go after so for example like like NRI",
    "start": "1832390",
    "end": "1839560"
  },
  {
    "text": "drivers right NRI drivers may only be used for certain things like let's say power metering for example and I just",
    "start": "1839560",
    "end": "1844960"
  },
  {
    "text": "want to look at power meters I can just say hey give me all the licenses they have n re-enabled and then you can just",
    "start": "1844960",
    "end": "1850510"
  },
  {
    "text": "start from there right pretty cool stuff and then at the bottom is basically a different different way of parsing the",
    "start": "1850510",
    "end": "1856630"
  },
  {
    "text": "data and so we didn't know what DSC was but now we do because we know that the project for this device is actually dr.",
    "start": "1856630",
    "end": "1862179"
  },
  {
    "text": "Surgery Center so we just enumerate a building management system for a surgery center right so that's not good",
    "start": "1862179",
    "end": "1867669"
  },
  {
    "text": "it's not good I don't know if I need to tell you that that is not good so pretty interesting stuff right so the good",
    "start": "1867669",
    "end": "1874090"
  },
  {
    "text": "thing is I was going to share the Python script up to everyone and say hey look if you want to enumerate this stuff here's this Python script but then",
    "start": "1874090",
    "end": "1880389"
  },
  {
    "text": "everyone will be running this psych scan across like the internet trying to find these buildings and stuff and so instead",
    "start": "1880389",
    "end": "1886029"
  },
  {
    "text": "what we did is we just I just talked to the guys I showed and I said hey why don't you guys just do this that way no one else has to scan for it and so we",
    "start": "1886029",
    "end": "1892779"
  },
  {
    "text": "take a look at this and this is basically how you would query it it's the same information here right and there's fifteen thousand three hundred",
    "start": "1892779",
    "end": "1899620"
  },
  {
    "text": "sixty seven buildings that can be identified with just this method right so not every building management system",
    "start": "1899620",
    "end": "1904840"
  },
  {
    "text": "has this particular method enabled so as you can see there are a lot of buildings online so the top one there universe",
    "start": "1904840",
    "end": "1910510"
  },
  {
    "text": "California but what I want what I want to actually show you here is um this is actually more interesting to me here so",
    "start": "1910510",
    "end": "1916269"
  },
  {
    "text": "let's take a look at this one I know it's kind of hard to see but if we take a look at this particular one the",
    "start": "1916269",
    "end": "1921549"
  },
  {
    "text": "station ID is North Star Financial right so I'm guessing that's some kind of Bank",
    "start": "1921549",
    "end": "1927279"
  },
  {
    "text": "right let's take a look at the one below it as well so this is a good one to hotel diamond right so that's pretty",
    "start": "1927279",
    "end": "1934149"
  },
  {
    "text": "interesting and then if we take a look at this one here peer eighty admin right",
    "start": "1934149",
    "end": "1939309"
  },
  {
    "text": "so but it could be a variety of things this one here is a vine 500 so but the",
    "start": "1939309",
    "end": "1946090"
  },
  {
    "text": "reason I want to point that out is because if we look at where these IPS bar would not forget the geolocation",
    "start": "1946090",
    "end": "1952000"
  },
  {
    "text": "just for a second but if we look at where these IPS are there are not in an organizational IP space it's actually an",
    "start": "1952000",
    "end": "1957970"
  },
  {
    "text": "isp IP address space so this one is cox communication this is North Star Financial so it's not in North Star",
    "start": "1957970",
    "end": "1964330"
  },
  {
    "text": "financials IP blocks right and if we look at Hotel Dimond it's an AT&T",
    "start": "1964330",
    "end": "1970630"
  },
  {
    "text": "Internet services IP address space so it's not in hotel diamonds IP address space",
    "start": "1970630",
    "end": "1975910"
  },
  {
    "text": "right this is really important so if we look at pure eighty admin it's not in",
    "start": "1975910",
    "end": "1980950"
  },
  {
    "text": "peer eighty admins IP space it's in eighteen t Internet services space and the reason that this is the case is",
    "start": "1980950",
    "end": "1987130"
  },
  {
    "text": "because when you buy a building management system you don't have your employees install the building",
    "start": "1987130",
    "end": "1992500"
  },
  {
    "text": "management system for you you always hire a third party contractor that guys and hardhats come in and they install it for you right and those folks",
    "start": "1992500",
    "end": "1998920"
  },
  {
    "text": "are known as integrators and so what these integrators will do is they'll take down your requirements so for a",
    "start": "1998920",
    "end": "2004050"
  },
  {
    "text": "place like this they'll say hey look I want it to be cool in every single room I want the temperature of variance to be this and this and I want to be able to",
    "start": "2004050",
    "end": "2009750"
  },
  {
    "text": "turn on and turn off all the ACS for all the single rooms from one centralized location and the interviewer goes I can",
    "start": "2009750",
    "end": "2015060"
  },
  {
    "text": "do that and they pick out the the particular devices that they want to install probably one of the two that we showed you here or maybe some variant of",
    "start": "2015060",
    "end": "2021360"
  },
  {
    "text": "it and they'll install it into the building right and then what they'll do is sending someone out to a building to",
    "start": "2021360",
    "end": "2027720"
  },
  {
    "text": "basically do maintenance is actually really expensive so what they like to do is take a cable modem or DSL line walk",
    "start": "2027720",
    "end": "2034110"
  },
  {
    "text": "into the closet run a line to it and hook their building management system up to the DSL line that's why we see so",
    "start": "2034110",
    "end": "2039630"
  },
  {
    "text": "many building management systems in commercial IP ISPs IP spaces so in fact",
    "start": "2039630",
    "end": "2046020"
  },
  {
    "text": "if you are looking for your own building management systems online it's probably not in your IP block the only place I",
    "start": "2046020",
    "end": "2052590"
  },
  {
    "text": "really see them in in in an organizational IP block are schools like this top one here this is California",
    "start": "2052590",
    "end": "2059970"
  },
  {
    "text": "State University Network so universities for some reason they have their building management systems in their own IP blocks for everything",
    "start": "2059970",
    "end": "2066090"
  },
  {
    "text": "else it's usually in a commercial ISP space someplace so if you're looking for these systems scanning your IP block is",
    "start": "2066090",
    "end": "2072480"
  },
  {
    "text": "probably not the way to go instead what you'll need to do is basically scan the internet and look for other metadata that's associated that could be your",
    "start": "2072480",
    "end": "2078419"
  },
  {
    "text": "system right so let's see if there's any ones here pretty cool stuff",
    "start": "2078419",
    "end": "2086600"
  },
  {
    "text": "so a lot of stuff on the internet you can go to showdown down instead of running Python scripts you can actually",
    "start": "2090090",
    "end": "2095740"
  },
  {
    "text": "look up stuff as well so um it can be on",
    "start": "2095740",
    "end": "2101110"
  },
  {
    "text": "my ipv6 yeah yeah it supports ipv6 definitely yep ipv4 too much more common though so um",
    "start": "2101110",
    "end": "2108010"
  },
  {
    "text": "just kind of a run through of the exploit so there's a bunch of different vulnerabilities where you can pull down various configuration files this one's",
    "start": "2108010",
    "end": "2114310"
  },
  {
    "text": "actually patched this is what the configuration file for our tritium system looks like so we can pull this thing down there's a section here that",
    "start": "2114310",
    "end": "2121060"
  },
  {
    "text": "has the usernames and passwords of passwords encoded so we just get the encoded password if we know how the",
    "start": "2121060",
    "end": "2126160"
  },
  {
    "text": "passwords encoded we can just decode it so this password just happens to be decoded to anyone's guests so pretty",
    "start": "2126160",
    "end": "2131440"
  },
  {
    "text": "interesting I don't think I'm gonna release this well I don't know how productive it is but you can find these things it's very trivial to write yourself so",
    "start": "2131440",
    "end": "2138730"
  },
  {
    "text": "it's patched though and so some of the more interesting control systems that we've seen in like building management",
    "start": "2138730",
    "end": "2144400"
  },
  {
    "text": "systems really cool right like this right here is a HVAC unit right so the user interface is actually really",
    "start": "2144400",
    "end": "2149770"
  },
  {
    "text": "intuitive and on how you use it so something like that it's also pretty cool boiler system right this is PI one",
    "start": "2149770",
    "end": "2156790"
  },
  {
    "text": "my favorite ones like Gables residential tower it's like man you just take a little building it's pretty cool Golf Galaxy so the reason I have this",
    "start": "2156790",
    "end": "2164380"
  },
  {
    "text": "screen shot here is once again we're talking about how all these building management systems are kind of consolidating so when we take a look at",
    "start": "2164380",
    "end": "2170620"
  },
  {
    "text": "this particular facility management system we see a bunch of different things that right so we see site emergency phase loss outdoor",
    "start": "2170620",
    "end": "2175840"
  },
  {
    "text": "temperatures all and then we see security systems so this is an instance where the security system is actually",
    "start": "2175840",
    "end": "2181060"
  },
  {
    "text": "tied into the facility management system right it's pretty neat and so that way we know that if we were able to actually compromise the underlying device we can",
    "start": "2181060",
    "end": "2188050"
  },
  {
    "text": "actually talk to security systems if you want to what those security systems are I'm not sure but pretty interesting",
    "start": "2188050",
    "end": "2193570"
  },
  {
    "text": "stuff so this one's really cool as well does anyone know C PP is open charging",
    "start": "2193570",
    "end": "2200170"
  },
  {
    "text": "protocol right so this is like an electric charging stance in place so",
    "start": "2200170",
    "end": "2205510"
  },
  {
    "text": "that's pretty neat and then I guess those white lists right there that's like badges of people who can can go up",
    "start": "2205510",
    "end": "2210610"
  },
  {
    "text": "to the charging station and actually use the electricity so pretty cool stuff we found this one a little while ago I was",
    "start": "2210610",
    "end": "2218290"
  },
  {
    "text": "very surprised it was available to the internet with no authentication we actually have a list of buildings",
    "start": "2218290",
    "end": "2223510"
  },
  {
    "text": "there's about 2,000 that we know of where if you can just guess the IP address you're actually on the building",
    "start": "2223510",
    "end": "2230470"
  },
  {
    "text": "management system so this yeah this is one that we found it's pretty",
    "start": "2230470",
    "end": "2236770"
  },
  {
    "text": "interesting right or like wow it's pretty cool so yeah that's pretty cool um we're like why would they set this up",
    "start": "2236770",
    "end": "2243310"
  },
  {
    "text": "but uh back here this is the environmental controls it's like all the different sections that they have for the arena basically that's the",
    "start": "2243310",
    "end": "2249730"
  },
  {
    "text": "environmental control for them I'm thinking probably the most important pieces would be like the equipment room where the temperature has to be like um highly regulated maybe I don't know but",
    "start": "2249730",
    "end": "2256690"
  },
  {
    "text": "this is probably more important as a breaker status so when you look at pr5 those are actually all the breakers that",
    "start": "2256690",
    "end": "2262330"
  },
  {
    "text": "are on or off at any given moment right so this is attached to breakers it's pretty interesting so those are breaker",
    "start": "2262330",
    "end": "2268330"
  },
  {
    "text": "status right there so there's some there's some upses over there up spawn ups to on there's some other things pr5",
    "start": "2268330",
    "end": "2274060"
  },
  {
    "text": "there's there was like ten of these PR one two it's PR ten so bunch of different things and then using the tool",
    "start": "2274060",
    "end": "2279550"
  },
  {
    "text": "that we had we can identify exactly who installed this thing la installations we contacted them on the phone we said hey",
    "start": "2279550",
    "end": "2285460"
  },
  {
    "text": "dude you should probably take this thing off line the station name which is important to give us context because this was in a commercial ISP space right",
    "start": "2285460",
    "end": "2293350"
  },
  {
    "text": "so if we don't know like station names or things like that it's kind of hard to tell who the thing belongs to you or",
    "start": "2293350",
    "end": "2298600"
  },
  {
    "text": "what facility it's being used to run and then of course we have the time zone which just helps us confirm like yeah",
    "start": "2298600",
    "end": "2303700"
  },
  {
    "text": "this is probably actually for real later we found out that indeed was real and the reason this device would actually",
    "start": "2303700",
    "end": "2309070"
  },
  {
    "text": "put into place is because the Olympic broadcasting folks needed building management system to be comfortable while they're doing all their",
    "start": "2309070",
    "end": "2314320"
  },
  {
    "text": "broadcasting so they took it offline pretty quickly so pretty interesting stuff running Windows 7 so let's take a",
    "start": "2314320",
    "end": "2324040"
  },
  {
    "text": "look at some of the building management systems on the internet so I have a list about 2000 I'm not gonna share all mm",
    "start": "2324040",
    "end": "2330400"
  },
  {
    "text": "everyone but if you look hard enough you'll find on yourself so but let's see what we can we can find here have a VM",
    "start": "2330400",
    "end": "2335740"
  },
  {
    "text": "here setup we can take a look at you know what it's like to basically interact with the building management",
    "start": "2335740",
    "end": "2340900"
  },
  {
    "text": "system so if you were to run an exploit and my password retrieval and basically",
    "start": "2340900",
    "end": "2346210"
  },
  {
    "text": "pull a password down decoder or whatever a crack it and then logged in this is basically what you would see right and so this one's pretty cool no",
    "start": "2346210",
    "end": "2352450"
  },
  {
    "text": "authentication like you just browse to the IP address for this one because I can't run an exploit against the internet facing system right I'm not",
    "start": "2352450",
    "end": "2357970"
  },
  {
    "text": "gonna do that but I have a list of 2000 systems where if you just guess the IP it drops you into this right so",
    "start": "2357970",
    "end": "2363520"
  },
  {
    "text": "basically if you run an exploit get the password or if you just find one of these 2,000 IP addresses and go to the",
    "start": "2363520",
    "end": "2369400"
  },
  {
    "text": "IP address it actually drops you into the building management system right so what I like to do is there's a file",
    "start": "2369400",
    "end": "2375880"
  },
  {
    "text": "folder for this particular building management system there's this PA px this is like the actual user interface",
    "start": "2375880",
    "end": "2380890"
  },
  {
    "text": "files right so what we want to do is basically say hey look I want to take a look at you know the first floor and the",
    "start": "2380890",
    "end": "2388120"
  },
  {
    "text": "mezzanine here so in a way that I would do that is just go views and then WB px",
    "start": "2388120",
    "end": "2393760"
  },
  {
    "text": "view and basically what's gonna happen is load that interface for me so then the interface is just much more valuable",
    "start": "2393760",
    "end": "2399130"
  },
  {
    "text": "but you can see you know based on the left-hand side I'm not limited to the user interface phoner to do other things",
    "start": "2399130",
    "end": "2404140"
  },
  {
    "text": "there's a lot of other things that you could do without being limited by the user interface right in fact if I wanted",
    "start": "2404140",
    "end": "2410080"
  },
  {
    "text": "to I could just privilege escalate and own the underlying device itself and then do whatever I want to any of the attached devices right and so the cool",
    "start": "2410080",
    "end": "2416530"
  },
  {
    "text": "thing is once you kind of look at some of these building management systems more and more you start to understand what all this stuff means right so like",
    "start": "2416530",
    "end": "2423040"
  },
  {
    "text": "if we look at second right which is probably the second floor a lot of these things are separated by floors and zones",
    "start": "2423040",
    "end": "2428140"
  },
  {
    "text": "right it's just a way of kind of separating particular devices out and things like that so taking a little bit",
    "start": "2428140",
    "end": "2434320"
  },
  {
    "text": "of time here load but it and this is all based on Java so that's why it's so slow and that's why I'm running to BN because",
    "start": "2434320",
    "end": "2439960"
  },
  {
    "text": "there's no way I would live my regular box so yeah but a lot of times what",
    "start": "2439960",
    "end": "2445510"
  },
  {
    "text": "you'll see and that's the single it's here in just a second are things like this which are floor plans it'll show",
    "start": "2445510",
    "end": "2451510"
  },
  {
    "text": "you this it's gonna render here in just one second it'll show you a floor plan it basically shows you like all the",
    "start": "2451510",
    "end": "2456910"
  },
  {
    "text": "environmental controls for this particular building right and what is running where and obviously you can change some of this stuff but what's",
    "start": "2456910",
    "end": "2463270"
  },
  {
    "text": "also cool so as that thing is loading",
    "start": "2463270",
    "end": "2469330"
  },
  {
    "text": "let's take a look at another one right so this one's pretty cool because what the integrators actually like to do is",
    "start": "2469330",
    "end": "2474790"
  },
  {
    "text": "actually tell you what building it's managing right and so they'll have a picture of it and saying hey this is the building that's being managed right and",
    "start": "2474790",
    "end": "2481570"
  },
  {
    "text": "that's the address so if you wanted to stand across the street mean like this is awesome you could do that if you wanted to right",
    "start": "2481570",
    "end": "2487090"
  },
  {
    "text": "and once again it's for user friendly it's a little slow going",
    "start": "2487090",
    "end": "2493089"
  },
  {
    "text": "here like I said it's Java so it takes a",
    "start": "2493089",
    "end": "2500980"
  },
  {
    "text": "little while I tried to load this beforehand let me see for her actually still up",
    "start": "2500980",
    "end": "2506068"
  },
  {
    "text": "okay we are it's just taking time that's all yet a lot of these have like little",
    "start": "2507509",
    "end": "2514180"
  },
  {
    "text": "animations and stuff to kind of tell you what's going on let's see let's look at",
    "start": "2514180",
    "end": "2525789"
  },
  {
    "text": "the pumps",
    "start": "2525789",
    "end": "2528119"
  },
  {
    "text": "so once again the user interface is pretty intuitive and a lot of times what",
    "start": "2543010",
    "end": "2548920"
  },
  {
    "text": "they'll allow is they'll just allow you to basically to change commands on the bottom right so if I hover over this",
    "start": "2548920",
    "end": "2554200"
  },
  {
    "text": "thing I'm not gonna click it but if you hover over this thing you'll actually see that their buttons right and so this is how an operator",
    "start": "2554200",
    "end": "2561310"
  },
  {
    "text": "like a real engineer would actually manage a building right and so so if you",
    "start": "2561310",
    "end": "2566650"
  },
  {
    "text": "put your building online to the internet without no authentication anyone can manage your building right so it's",
    "start": "2566650",
    "end": "2572410"
  },
  {
    "text": "pretty simple yeah I'll talk about alarms here in a second this is pretty",
    "start": "2572410",
    "end": "2578200"
  },
  {
    "text": "cool too it's like a loop loop control let's load this thing up so alarms in",
    "start": "2578200",
    "end": "2583240"
  },
  {
    "text": "most cases when you see the word alarm in a building management system it's not like a physical alarm that's going to go",
    "start": "2583240",
    "end": "2588910"
  },
  {
    "text": "off what folks usually do is they'll set up criteria to be notified for something",
    "start": "2588910",
    "end": "2594700"
  },
  {
    "text": "and that's considered an alarm so if a temperature gets too high or if the temperature goes too low or if something",
    "start": "2594700",
    "end": "2600550"
  },
  {
    "text": "is turned off at a time it's supposed to be turned on they can create an alarm and so what will happen is if that criteria is met either someone gets an",
    "start": "2600550",
    "end": "2607930"
  },
  {
    "text": "SMS message or a phone call or something like that and an alarm goes off so when you see the word alarm it's not usually",
    "start": "2607930",
    "end": "2614320"
  },
  {
    "text": "like a real physical alarm going off it's just like a set point yeah so this is pretty cool once again you can like",
    "start": "2614320",
    "end": "2619780"
  },
  {
    "text": "hover over the command and so if you want to click that thing you would turn the pump on right it's pretty",
    "start": "2619780",
    "end": "2624790"
  },
  {
    "text": "straightforward the way that this actually works is they code this interface if you click this button it passes a command to the",
    "start": "2624790",
    "end": "2630820"
  },
  {
    "text": "underlying framework the framework basically transmits translates that into whatever protocol is attached to the",
    "start": "2630820",
    "end": "2635830"
  },
  {
    "text": "actual device whether that's bacnet or Modbus or some other custom protocol and it sends it out to the device that's",
    "start": "2635830",
    "end": "2641170"
  },
  {
    "text": "listening and this in this case it would be some kind of pump and then the pump understands that protocol either turns",
    "start": "2641170",
    "end": "2646210"
  },
  {
    "text": "on or adjust a set point and responds back saying hey I'm on now and then this user interface just displays it in a",
    "start": "2646210",
    "end": "2651670"
  },
  {
    "text": "nice way so that's all this user interface is doing so if you understand underlying protocols you can actually",
    "start": "2651670",
    "end": "2656859"
  },
  {
    "text": "jump to the underlying system and tell the device to do whatever you want right so in this case there's only one command",
    "start": "2656859",
    "end": "2662170"
  },
  {
    "text": "really right like turn off and turn on right but if you wanted to you could jump to the underlying device and say hey turn on and spin really fast or or",
    "start": "2662170",
    "end": "2669400"
  },
  {
    "text": "don't ever turn on ever again or or run an exploit against the device come telling you device are not very robust",
    "start": "2669400",
    "end": "2674740"
  },
  {
    "text": "they're not meant to be messed with in anyways so let's see this is also",
    "start": "2674740",
    "end": "2680099"
  },
  {
    "text": "really cool the chilled water system it just kind of shows you what's going on and off enable statuses and then I",
    "start": "2680099",
    "end": "2685979"
  },
  {
    "text": "wanted to load up one other one here this one right here so here's one with lights right there's employee lights here customer lights outdoor lights",
    "start": "2685979",
    "end": "2694259"
  },
  {
    "text": "this one else why actually has energy management as well right you can turn power on and off that's where stuff so",
    "start": "2694259",
    "end": "2699839"
  },
  {
    "text": "that's what building management systems look like right and I'm telling you right now if your Fortune 1000 or our",
    "start": "2699839",
    "end": "2705390"
  },
  {
    "text": "corporate building or if you have a corporate campus you have these system somewhere telling you right now you have these system somewhere hopefully you're",
    "start": "2705390",
    "end": "2711359"
  },
  {
    "text": "not one of these guys that we pulled out that has no authentication to theirs but you could be right so I hope you're not",
    "start": "2711359",
    "end": "2718249"
  },
  {
    "text": "and so okay so a little bit about access",
    "start": "2718249",
    "end": "2727259"
  },
  {
    "text": "control systems I had a demo for this access control system I'm not gonna show it cuz the vendor pass nicely and it was",
    "start": "2727259",
    "end": "2732869"
  },
  {
    "text": "pretty proactive and it's none of its fix I will talk about one little piece tip but I want to talk about the systems in general so for the most part when we",
    "start": "2732869",
    "end": "2740700"
  },
  {
    "text": "think about access control we think about these devices right like you badge into a door someplace it does some",
    "start": "2740700",
    "end": "2745859"
  },
  {
    "text": "signaling it tries to identify who you are and sends it back to this device and then a door magically unlocks it's",
    "start": "2745859",
    "end": "2751440"
  },
  {
    "text": "pretty cool so I get I had access to one of these systems here I thought this one was really cool right because you put",
    "start": "2751440",
    "end": "2757979"
  },
  {
    "text": "your hand on it and then you badge in it checks the badge to see if it's the right badge but hey someone could have stolen your badge right so and then it",
    "start": "2757979",
    "end": "2764640"
  },
  {
    "text": "basically read your handprint says oh yeah this is really Billy we should let them in so the crazy thing about it is",
    "start": "2764640",
    "end": "2770729"
  },
  {
    "text": "every single one of these devices can be open with that key so yeah that key",
    "start": "2770729",
    "end": "2777569"
  },
  {
    "text": "right there so that key cost me like six dollars so yeah so super expensive I",
    "start": "2777569",
    "end": "2782880"
  },
  {
    "text": "know it's probably out of most people's price range but if you really want to get access to some of these doors my",
    "start": "2782880",
    "end": "2788309"
  },
  {
    "text": "view might be useful right so and so if you actually pull that thing off the wall you'll see that there is not a",
    "start": "2788309",
    "end": "2793739"
  },
  {
    "text": "magical unicorn there making a decision as to what should happen and said there's just wires right and so and this",
    "start": "2793739",
    "end": "2799559"
  },
  {
    "text": "is kind of the heart of it right the building management systems a lot of people are very intimidated by them but at the end of the day they're really just computers communicating over",
    "start": "2799559",
    "end": "2805469"
  },
  {
    "text": "networks right so they may be using weird protocols or weird you know kind of like weird networks but",
    "start": "2805469",
    "end": "2810530"
  },
  {
    "text": "it's really just computers in the networks and so and this one has like this is the reason I have this screenshot here is it",
    "start": "2810530",
    "end": "2816590"
  },
  {
    "text": "actually kind of describes what is going on here right and so for the most part all that's happening is once a decision",
    "start": "2816590",
    "end": "2823430"
  },
  {
    "text": "is made usually not by the usually not by the system themselves they can make the decision by themselves they can't have a",
    "start": "2823430",
    "end": "2829070"
  },
  {
    "text": "user database on the actual device itself but for the most part they don't do that for the most part the decision",
    "start": "2829070",
    "end": "2834740"
  },
  {
    "text": "is actually made somewhere else right and a basically a signal gets sent back saying yeah you should let them in in some weird cases where maybe you have a",
    "start": "2834740",
    "end": "2841310"
  },
  {
    "text": "remote station that's way far off and the user list doesn't change very often you can actually put the user on the",
    "start": "2841310",
    "end": "2846560"
  },
  {
    "text": "device itself but that's usually not the case right and then if we look at some of the wires here like the outputs why",
    "start": "2846560",
    "end": "2852260"
  },
  {
    "text": "are five and six basically control the door lock that's just as simple as that so usually it's just about applying the",
    "start": "2852260",
    "end": "2858740"
  },
  {
    "text": "right voltage to the right wire that's all it is if you have physical access right because physical access is pretty",
    "start": "2858740",
    "end": "2863870"
  },
  {
    "text": "much game over so in a simplified way if you go to a like a badging system or something like",
    "start": "2863870",
    "end": "2870440"
  },
  {
    "text": "that and you badge in what's going to happen is either over serial or IP a signal is gonna get sent to a computer",
    "start": "2870440",
    "end": "2876770"
  },
  {
    "text": "saying hey this person just patched in and this is their number and usually the application servers going to look up on a database saying hey does this person",
    "start": "2876770",
    "end": "2882680"
  },
  {
    "text": "exist in my database and what are they authorized to access it's going to send it back to the application so we're",
    "start": "2882680",
    "end": "2887900"
  },
  {
    "text": "saying these these are the permissions for that particular user all right and then back over serial or IP it's going",
    "start": "2887900",
    "end": "2894230"
  },
  {
    "text": "to send this signal back to the device saying hey this is what we know about this person and then the device actually",
    "start": "2894230",
    "end": "2899810"
  },
  {
    "text": "just supplies you know voltage to a particular lock and says unlock or lock or whatever so usually five volts or two",
    "start": "2899810",
    "end": "2904880"
  },
  {
    "text": "are 12 volts pretty straightforward so physical access trumps everything",
    "start": "2904880",
    "end": "2910280"
  },
  {
    "text": "right so if you go to a badging system and pull it off the wall there just give me a wire behind it right not unicorn",
    "start": "2910280",
    "end": "2915680"
  },
  {
    "text": "it's just a wire so and typically some of those wires are actually gonna go to the lock and usually it's just 5 or 12",
    "start": "2915680",
    "end": "2922040"
  },
  {
    "text": "volts applied to that wire that's gonna open that lock or sometimes it's a serial replay because the door may have",
    "start": "2922040",
    "end": "2927380"
  },
  {
    "text": "a controller itself right so a controller connected to another controller so obviously it requires physical access and then this usually",
    "start": "2927380",
    "end": "2934940"
  },
  {
    "text": "requires disassembly of a device right usually have to take a device off the wall so you have to be really careful about tamper alarms because these",
    "start": "2934940",
    "end": "2940700"
  },
  {
    "text": "manufacturers know that if you take the device off the log and gain access to the wires that it's basically gonna be defeated so a lot of them have",
    "start": "2940700",
    "end": "2946740"
  },
  {
    "text": "tamper alarms where if you pull the device off the wall or if like like I did when i unlock the the device itself",
    "start": "2946740",
    "end": "2952350"
  },
  {
    "text": "it actually has a tamper mechanism that'll send a signal to the application server saying hey someone just unlocked me just open me up so you have to be",
    "start": "2952350",
    "end": "2958530"
  },
  {
    "text": "careful of that typically installed on Windows machines this application server itself right so probably the most",
    "start": "2958530",
    "end": "2965130"
  },
  {
    "text": "popular access control software are these three here right with the top one probably the most popular access control",
    "start": "2965130",
    "end": "2972180"
  },
  {
    "text": "system that I've ever seen secure right they have a lot of different versions every datacenter that I've ever been to",
    "start": "2972180",
    "end": "2978030"
  },
  {
    "text": "uses secure every single data center ever been to so if you're doing an",
    "start": "2978030",
    "end": "2983520"
  },
  {
    "text": "internal pen test and you basically want to gain access to some of these systems or you want to gain access to some door",
    "start": "2983520",
    "end": "2988770"
  },
  {
    "text": "or some place or gain access to a data center or whatever cuz the physical is in in play let's say you have something",
    "start": "2988770",
    "end": "2994950"
  },
  {
    "text": "like domain admin this is how you would find it it's how we find these things so we know what the uninstall keys are for",
    "start": "2994950",
    "end": "2999960"
  },
  {
    "text": "these devices and so if we have privileged creds we can just say hey tell me where this thing is installed and it'll tell us like hey there's a",
    "start": "2999960",
    "end": "3006950"
  },
  {
    "text": "secure database installed on this particular machine here and then once we gain access to the machine once again",
    "start": "3006950",
    "end": "3012620"
  },
  {
    "text": "it's a human machine interface it looks just like this right so this is a secure or actually sorry this is door net sorry",
    "start": "3012620",
    "end": "3019160"
  },
  {
    "text": "carried or not then so and when you want to unlock something this is real we actually did this during like a pen test",
    "start": "3019160",
    "end": "3025190"
  },
  {
    "text": "physical pen test you literally just select the door that you want and click unlock see that a little top the GUI",
    "start": "3025190",
    "end": "3030350"
  },
  {
    "text": "it's pretty cool so you don't have to understand that underlying protocol or anything like that although if you were really leet you could understand the",
    "start": "3030350",
    "end": "3035870"
  },
  {
    "text": "underlying protocol just send it yourself or you can gain access to the GUI and press the unlock button and the door will unlock right so it's it's",
    "start": "3035870",
    "end": "3043460"
  },
  {
    "text": "pretty cool adding rogue users to particular groups it's usually pretty difficult to detect right a lot of",
    "start": "3043460",
    "end": "3050000"
  },
  {
    "text": "people are looking for that stuff so I'm just some basic general information about secure like I said that's probably",
    "start": "3050000",
    "end": "3055970"
  },
  {
    "text": "the most if you know if you're a fortune 1000 deep I have secured probably it's",
    "start": "3055970",
    "end": "3061280"
  },
  {
    "text": "just progress that's the database administrator account so if you find a sequel server that has this progress account some weird tables I'll show you",
    "start": "3061280",
    "end": "3067580"
  },
  {
    "text": "here in a second or like secure sequel that's the default database name that's probably a secure database server that",
    "start": "3067580",
    "end": "3074840"
  },
  {
    "text": "means that is controlling your access controls for your facility if you get if you own that database you basically don't all have access control for the",
    "start": "3074840",
    "end": "3080889"
  },
  {
    "text": "facility so for Kerry there could be a there could be a file for carried or net",
    "start": "3080889",
    "end": "3087129"
  },
  {
    "text": "or it could be in a database the database the name is usually DHS underscore main and usually uses Windows",
    "start": "3087129",
    "end": "3093819"
  },
  {
    "text": "authentication right so it doesn't have its own account that it uses usually usually uses Windows off but you can change that of course if you want to so",
    "start": "3093819",
    "end": "3100179"
  },
  {
    "text": "data structures are kind of complicated so this is the database structure from a secure database at the backend so and it",
    "start": "3100179",
    "end": "3106149"
  },
  {
    "text": "stores a lot of different things right but probably most interesting to us are the t card which is the card information",
    "start": "3106149",
    "end": "3112299"
  },
  {
    "text": "the journal which is basically everything that's going on and the person right and also a person has all",
    "start": "3112299",
    "end": "3117939"
  },
  {
    "text": "the card numbers and a particular pin for the card so I'll store the database",
    "start": "3117939",
    "end": "3123059"
  },
  {
    "text": "create stuff so we're getting real close here so if you're asking yourself hey I",
    "start": "3123059",
    "end": "3129999"
  },
  {
    "text": "want to audit my organization where do I start all right so we gave you the showed and stuff you can go do that right now and",
    "start": "3129999",
    "end": "3135939"
  },
  {
    "text": "look for your organization online if you have certain protocols the BACnet scanner is gonna be actually it's",
    "start": "3135939",
    "end": "3141369"
  },
  {
    "text": "already out so you can go download that so our end mapping stuff try to find some of your facility manager systems on the internet or the internal network or",
    "start": "3141369",
    "end": "3148689"
  },
  {
    "text": "what I like to do is go to your facilities department so because a lot of times this is not run by IT it's",
    "start": "3148689",
    "end": "3155169"
  },
  {
    "text": "actually run by your facilities department and say hey we're or our tritium boxes right where are my johnson",
    "start": "3155169",
    "end": "3161469"
  },
  {
    "text": "control boxes where my automated logic where's my delta controls you know and have them tell you where this stuff is",
    "start": "3161469",
    "end": "3166599"
  },
  {
    "text": "or give you the software so you can take a look at it and on it it's things like that cool stuff those are facility",
    "start": "3166599",
    "end": "3172299"
  },
  {
    "text": "management systems you're probably using one of those if you want access control",
    "start": "3172299",
    "end": "3177669"
  },
  {
    "text": "stuff go to your physical security folks instead of saying hey you can have access control just say hey where's the",
    "start": "3177669",
    "end": "3183699"
  },
  {
    "text": "secure database well where's the secure software I want to see you I wanna take a look at it or where's the license",
    "start": "3183699",
    "end": "3188709"
  },
  {
    "text": "because I want to audit it or do whatever or carry or slot right hand to the pennmen so or if you have domain",
    "start": "3188709",
    "end": "3194979"
  },
  {
    "text": "admin or privilege privilege creds you can just scan for the the class I use which we gave in the slides here so for the surveillance system it's physical",
    "start": "3194979",
    "end": "3201099"
  },
  {
    "text": "security folks use those systems that you would ask for but the best people to ask are your data center folks because",
    "start": "3201099",
    "end": "3207429"
  },
  {
    "text": "they have everything they have everything you can imagine facility management systems they have the access control systems they have the",
    "start": "3207429",
    "end": "3213670"
  },
  {
    "text": "energy management systems they have everything so if you go to your data center folks and said hey I want to take a look at all the software they probably",
    "start": "3213670",
    "end": "3219040"
  },
  {
    "text": "have it they probably have it implemented but you have to ask nicely because otherwise they won't give it to you so I do want to take some questions",
    "start": "3219040",
    "end": "3227460"
  },
  {
    "text": "that's hard so that is one thing to kind of keep in mind right so yeah actly",
    "start": "3234719",
    "end": "3241989"
  },
  {
    "text": "control-z so that's a really good question one thing to keep in mind is",
    "start": "3241989",
    "end": "3248640"
  },
  {
    "text": "I've always classified building management systems and facility management systems as ICS industrial",
    "start": "3248640",
    "end": "3255069"
  },
  {
    "text": "control systems right so this kind of falls under ICS and ICS almost always",
    "start": "3255069",
    "end": "3260469"
  },
  {
    "text": "controls a process so you have computer systems and other systems embedded systems but they are there to control a",
    "start": "3260469",
    "end": "3266559"
  },
  {
    "text": "process right and so undoing software mistakes it's pretty easy control Z I'm",
    "start": "3266559",
    "end": "3272109"
  },
  {
    "text": "doing a process mistake is hard if not impossible so if you are auditing these",
    "start": "3272109",
    "end": "3277419"
  },
  {
    "text": "systems and you turn something on you can't take that back it is a physical",
    "start": "3277419",
    "end": "3283089"
  },
  {
    "text": "event that has occurred someplace right so you cannot undo that you can turn it off but you may not undo what that",
    "start": "3283089",
    "end": "3288909"
  },
  {
    "text": "process had cost right so if you are doing auditing against these systems you have to be really careful about that and",
    "start": "3288909",
    "end": "3295390"
  },
  {
    "text": "you always have to understand that the interfaces while it looks very cartoonish and it looks like it looks",
    "start": "3295390",
    "end": "3301869"
  },
  {
    "text": "very innocent it's actually controlling a process someplace so if you turn on a boiler like the fire is going to get lit",
    "start": "3301869",
    "end": "3309669"
  },
  {
    "text": "right and you won't be able to make it to like I don't want to ever have done that it's too late it's a process that's",
    "start": "3309669",
    "end": "3314919"
  },
  {
    "text": "occurred you can't take it back it's not a VMware you can revert back to a snapshot right so a very good question",
    "start": "3314919",
    "end": "3320619"
  },
  {
    "text": "always controls a process so you always have to keep that in the back in line",
    "start": "3320619",
    "end": "3325889"
  },
  {
    "text": "anything else",
    "start": "3325889",
    "end": "3329130"
  },
  {
    "text": "that that's a good point usually when folks did you guys hear the question so the",
    "start": "3342380",
    "end": "3349760"
  },
  {
    "text": "question was it's likely that most chief security officers don't understand that",
    "start": "3349760",
    "end": "3355520"
  },
  {
    "text": "this falls under their purview essentially so they don't understand that this is a risk they don't understand that the building's online they don't understand how to find it",
    "start": "3355520",
    "end": "3361880"
  },
  {
    "text": "there's no software to go manage this sort of stuff that's actually really good question and a really good point because usually when",
    "start": "3361880",
    "end": "3367640"
  },
  {
    "text": "we talk to folks and they're like how can we get a better handle of our facility management systems and how do we secure these things do we need to",
    "start": "3367640",
    "end": "3373760"
  },
  {
    "text": "change passwords and I'm like well the first step is to organize your self in a way that you can manage these things so",
    "start": "3373760",
    "end": "3380330"
  },
  {
    "text": "the last couple of slides that we had it said hey go talk to your facilities guys go talk to your physical security guys go talk to your data center folks",
    "start": "3380330",
    "end": "3386920"
  },
  {
    "text": "usually what you have to understand is who owns this from an administrative standpoint is it the facilities folks is",
    "start": "3386920",
    "end": "3394220"
  },
  {
    "text": "it IT is it the physical security folks is it your data center folks because that matters right and you have to get",
    "start": "3394220",
    "end": "3400070"
  },
  {
    "text": "that done first so if you are a security person in an IT department and you walk",
    "start": "3400070",
    "end": "3405290"
  },
  {
    "text": "into the data center or you walk into the physical security department or you walk into the facilities department say",
    "start": "3405290",
    "end": "3410510"
  },
  {
    "text": "hey I want to do these audits it's likely they report to someone else they don't report to the that's just the CIO or maybe they don't even like the",
    "start": "3410510",
    "end": "3417470"
  },
  {
    "text": "CSO may not be in their direct chain they may report to a CEO right the facilities guys maybe sometimes a report",
    "start": "3417470",
    "end": "3423770"
  },
  {
    "text": "to finance or whatever right because corporate real estate or River so that's a really good point so if you want to get your arms around this from a",
    "start": "3423770",
    "end": "3430340"
  },
  {
    "text": "strategic perspective you have to organize yourself to where you have control of these and in a way that makes",
    "start": "3430340",
    "end": "3435980"
  },
  {
    "text": "sense so it may be under the CSO may be under the CIO I don't know what that looks like for your organization but you",
    "start": "3435980",
    "end": "3442130"
  },
  {
    "text": "have to do something right especially when a lot of the exposure is created by third parties like the integrators like",
    "start": "3442130",
    "end": "3447590"
  },
  {
    "text": "we saw your building managed systems gonna be an AT&T IP address space someplace that's hard that's a hard",
    "start": "3447590",
    "end": "3453500"
  },
  {
    "text": "problem right so good question so organizing yourself in a way to where the person that does have basically",
    "start": "3453500",
    "end": "3460880"
  },
  {
    "text": "responsibility for these building management systems it's clear to them that this falls under their responsibility that is the first step",
    "start": "3460880",
    "end": "3466640"
  },
  {
    "text": "before you do any technical stuff from a strategic standpoint that's the first step and then once you have that in",
    "start": "3466640",
    "end": "3472220"
  },
  {
    "text": "place you know the rest of it can kind of fall into play how you want to manage it that sort of things so we have seen some",
    "start": "3472220",
    "end": "3478099"
  },
  {
    "text": "really interesting things where the responsibility has shifted hands so for",
    "start": "3478099",
    "end": "3483230"
  },
  {
    "text": "example we go to some organization I would say which one and we're like hey you know you have your building",
    "start": "3483230",
    "end": "3488839"
  },
  {
    "text": "management systems online and they're like oh we didn't know or like oh yeah it's an 18 t IP address space and",
    "start": "3488839",
    "end": "3493970"
  },
  {
    "text": "they're like okay that that's crazy and then they go talk to the facilities folks and like oh yeah we knew about this all time right and then the IT",
    "start": "3493970",
    "end": "3499880"
  },
  {
    "text": "folks is the CIO is like you guys don't have any clue as to what you're doing these are computer systems we're taking",
    "start": "3499880",
    "end": "3505220"
  },
  {
    "text": "them over and so they they took them over and they put them into didn't put",
    "start": "3505220",
    "end": "3510230"
  },
  {
    "text": "them into the Corp IT space but they put them under the Corp IT security policies and then what they ended up finding is",
    "start": "3510230",
    "end": "3516529"
  },
  {
    "text": "like these devices act really weird for example yep a check controllers",
    "start": "3516529",
    "end": "3521630"
  },
  {
    "text": "phoning home to places that are like on known black lists you know and you had like all sorts of internet activity",
    "start": "3521630",
    "end": "3526640"
  },
  {
    "text": "we're like certain protocols we're getting sent over the Internet right and and then they basically asked",
    "start": "3526640",
    "end": "3531799"
  },
  {
    "text": "us like should these devices ever be doing this like no they should never be doing that right and they didn't know this was happening because the",
    "start": "3531799",
    "end": "3538309"
  },
  {
    "text": "responsibility was very unclear and so facilities is running these things with literally servers under someone's desk",
    "start": "3538309",
    "end": "3543950"
  },
  {
    "text": "right plug into some Comcast modem someplace and so all the other scrutiny that happens for egress filtering and",
    "start": "3543950",
    "end": "3551059"
  },
  {
    "text": "all the other stuff is just being missed right so really good point don't push",
    "start": "3551059",
    "end": "3556640"
  },
  {
    "text": "the buttons on the internet facing stuff so don't do that please anything else so",
    "start": "3556640",
    "end": "3568849"
  },
  {
    "text": "that's a good question I don't know like every building is different and so depending on the components that are",
    "start": "3568849",
    "end": "3574700"
  },
  {
    "text": "attached to I don't know what could happen so because it's likely that your fans",
    "start": "3574700",
    "end": "3580130"
  },
  {
    "text": "that run your HVAC your boiler or whatever those are probably different for every single building so it's hard",
    "start": "3580130",
    "end": "3585349"
  },
  {
    "text": "for me to generalize and just say well if you have access to a boiler to Copiah do this what I'm thinking is you probably have to have like access to you",
    "start": "3585349",
    "end": "3593000"
  },
  {
    "text": "know the questions should probably be more like if you have access to this specific type of equipment configured in",
    "start": "3593000",
    "end": "3598279"
  },
  {
    "text": "this way what type of damage could you do right and so or laid out in a certain configuration or whatever I don't I",
    "start": "3598279",
    "end": "3603980"
  },
  {
    "text": "don't know so but we do have a project that's we're going to do this year where we're working with an integrator",
    "start": "3603980",
    "end": "3609710"
  },
  {
    "text": "the East Coast and the integrator is basically it's pretty cool because they go into new facilities and they set up",
    "start": "3609710",
    "end": "3616640"
  },
  {
    "text": "building management systems right and they they rip out all this old equipment and what they're gonna actually do is",
    "start": "3616640",
    "end": "3621920"
  },
  {
    "text": "set up that old equipment into basically like a fake building magic network and we're gonna try to see exactly what it",
    "start": "3621920",
    "end": "3627560"
  },
  {
    "text": "is that we can do like whether we can set a boiler on fire or do crazy stuff right because you can't do that during",
    "start": "3627560",
    "end": "3633589"
  },
  {
    "text": "pen tests so but um if we have equipment that they're gonna throw away anyway or scrap they don't have any prop any",
    "start": "3633589",
    "end": "3640160"
  },
  {
    "text": "problems with us doing damage to the systems right so yeah good question I can tell you this the systems are not",
    "start": "3640160",
    "end": "3647599"
  },
  {
    "text": "designed to be messed with so like your boiler is not robust and hopefully",
    "start": "3647599",
    "end": "3653030"
  },
  {
    "text": "there's physical security mechanisms that prevent like catastrophic damage mm-hmm but I'm pretty confident like",
    "start": "3653030",
    "end": "3658369"
  },
  {
    "text": "just being able to just break it that's probably well within scope pretty probably pretty easy so whether or not",
    "start": "3658369",
    "end": "3664130"
  },
  {
    "text": "we can like set a building on fire something like that I don't know that's what we're gonna try to look at this year but as far as just breaking",
    "start": "3664130",
    "end": "3670070"
  },
  {
    "text": "equipment I'm pretty sure you can just break it if you want to so what that means to your business I don't know it",
    "start": "3670070",
    "end": "3675890"
  },
  {
    "text": "depends on how your business is using your building management systems",
    "start": "3675890",
    "end": "3680470"
  },
  {
    "text": "what like can you repeat the question",
    "start": "3689310",
    "end": "3694200"
  },
  {
    "text": "yeah so that's a that's a good point I think a lot of folks don't realize that",
    "start": "3703930",
    "end": "3709670"
  },
  {
    "text": "they're building management systems can be controlled remotely so the the biggest problem is probably understanding that if you have a",
    "start": "3709670",
    "end": "3715760"
  },
  {
    "text": "building management system it's probably likely that your integrator is managing it remotely so I mean that's why we see",
    "start": "3715760",
    "end": "3722060"
  },
  {
    "text": "all these building management systems on the internet like the corporations don't put them them put them there themselves the integrator puts puts it there for",
    "start": "3722060",
    "end": "3728840"
  },
  {
    "text": "them so what's likely is if you want to restrict remote management to some of these systems you probably have to work",
    "start": "3728840",
    "end": "3734330"
  },
  {
    "text": "with your integrator in fact we've seen that every single time is the the owning organization the bank or whatever they",
    "start": "3734330",
    "end": "3740390"
  },
  {
    "text": "actually have to tell their integrator like hey look you're not going to log into the web interface over the internet you're gonna ask us for access to this",
    "start": "3740390",
    "end": "3747290"
  },
  {
    "text": "specific segment we're gonna allow for a given point in time and then you're gonna do your remote management and when",
    "start": "3747290",
    "end": "3752450"
  },
  {
    "text": "you're done we're gonna turn it off and so the integrator has to call so they can still do remote management but the",
    "start": "3752450",
    "end": "3758300"
  },
  {
    "text": "organization can now control the remote management in a way that makes sense to them right so that's a good question",
    "start": "3758300",
    "end": "3765400"
  },
  {
    "text": "yeah I mean at the end of the day you know what I tell integrators is like hey",
    "start": "3768550",
    "end": "3774470"
  },
  {
    "text": "a VPN appliances like a couple hundred dollars you know getting in front of your devices because in my opinion",
    "start": "3774470",
    "end": "3781490"
  },
  {
    "text": "they're not robust enough to be internet facing even if you have all the security mechanisms and configurations done",
    "start": "3781490",
    "end": "3786680"
  },
  {
    "text": "correctly I mean as obvious by the exploits that we have right so I don't think having this thing on the Internet",
    "start": "3786680",
    "end": "3792920"
  },
  {
    "text": "is a good idea at all well I hope you",
    "start": "3792920",
    "end": "3799310"
  },
  {
    "text": "guys well",
    "start": "3799310",
    "end": "3801670"
  },
  {
    "text": "yeah",
    "start": "3805930",
    "end": "3808930"
  },
  {
    "text": "really bad that basically is a question about patch management like so for example the tritium niagara boxes",
    "start": "3814940",
    "end": "3821329"
  },
  {
    "text": "there's patches for all the vulnerabilities that we had reported to them if you look on the internet and you",
    "start": "3821329",
    "end": "3827000"
  },
  {
    "text": "do the enumeration the boxes will tell you what version they're running you'll see that almost none of them are fully patched so it's really poor and why",
    "start": "3827000",
    "end": "3834859"
  },
  {
    "text": "that's the case I don't know I don't know if it's because those devices are run by facilities whether they actually",
    "start": "3834859",
    "end": "3840530"
  },
  {
    "text": "belong to an integrator and they're just being leased by the end organization or whether people just don't care I'm not sure but the reality is is that if you",
    "start": "3840530",
    "end": "3848630"
  },
  {
    "text": "find a device that's on the internet it's probably not patched if you find it in your internal network that is",
    "start": "3848630",
    "end": "3853880"
  },
  {
    "text": "probably really not patched ever right so yeah to do like just enumeration and",
    "start": "3853880",
    "end": "3862160"
  },
  {
    "text": "it sort stuff yeah so the end map script",
    "start": "3862160",
    "end": "3867920"
  },
  {
    "text": "you can download that from Digital bonds web site and then the Python script that I have that's actually built into show",
    "start": "3867920",
    "end": "3874010"
  },
  {
    "text": "Dan now so yeah it's just the port you just query for the port 1911 yeah and",
    "start": "3874010",
    "end": "3880549"
  },
  {
    "text": "you'll get a list of a bunch of stuff yeah and then john hasn't hooked the guy who runs showed in he hasn't hooked up",
    "start": "3880549",
    "end": "3887329"
  },
  {
    "text": "query capabilities yet but if you just query for that port it'll just dump everything that it has that it's done in",
    "start": "3887329",
    "end": "3892910"
  },
  {
    "text": "the last internet scan it's like a couple you know ten twenty thousand devices so and then you know grep for",
    "start": "3892910",
    "end": "3900470"
  },
  {
    "text": "your company name if there's no more",
    "start": "3900470",
    "end": "3906559"
  },
  {
    "text": "questions thanks for attending I really appreciate it so",
    "start": "3906559",
    "end": "3910690"
  }
]