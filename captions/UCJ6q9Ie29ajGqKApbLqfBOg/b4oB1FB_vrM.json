[
  {
    "start": "0",
    "end": "120000"
  },
  {
    "text": "good morning everyone welcome to TCP injection",
    "start": "160",
    "end": "5240"
  },
  {
    "text": "attacks in the wild a large scale study you are in the Mandalay Bay EF and",
    "start": "5240",
    "end": "13400"
  },
  {
    "text": "your speaker today is Gabby NBI a few things before we begin stop by",
    "start": "13400",
    "end": "21119"
  },
  {
    "text": "the business Hall located in Bayside AB the black hat Arsenal is on Palm foyer",
    "start": "21119",
    "end": "28359"
  },
  {
    "text": "on level three and of course of course the Arsenal reception is at",
    "start": "28359",
    "end": "34000"
  },
  {
    "text": "1,700 if you haven't picked up your merchandise today today is your last chance to visit the black ha hat swags",
    "start": "34000",
    "end": "41440"
  },
  {
    "text": "uh and bookstore and visit the C Linux lab on Mandalay Bay a and thank you for",
    "start": "41440",
    "end": "48160"
  },
  {
    "text": "putting your phone on vibrate it makes it easier for the rest of us to ignore the ringing while you wait for your",
    "start": "48160",
    "end": "54280"
  },
  {
    "text": "voicemail to pick up and without further Ado I present Gabby",
    "start": "54280",
    "end": "61920"
  },
  {
    "text": "hi everybody H thank you all for coming today I'm really excited to share with you some interesting results um of a",
    "start": "64320",
    "end": "71400"
  },
  {
    "text": "large scale survey we've conducted in order to search and analyze TCP",
    "start": "71400",
    "end": "77040"
  },
  {
    "text": "injection attacks in the wild throughout the study we have examined more than 1.5",
    "start": "77040",
    "end": "82320"
  },
  {
    "text": "pabit of web traffic coming in from web servers having in total 1.5 million",
    "start": "82320",
    "end": "88479"
  },
  {
    "text": "unique IP addresses uh to the best of our knowledge this is the first large scale uh internet survey of this cop",
    "start": "88479",
    "end": "95880"
  },
  {
    "text": "that aims to study the practice of TCP injection attacks in the wild",
    "start": "95880",
    "end": "101520"
  },
  {
    "text": "what we wanted to do is uh to understand what kind of TCP injection attacks are",
    "start": "101520",
    "end": "106640"
  },
  {
    "text": "are currently going on in the wild uh to what purpose and who are the entities behind those",
    "start": "106640",
    "end": "112399"
  },
  {
    "text": "injections uh the collaborators of In This research were Jam Kik and Yosi",
    "start": "112399",
    "end": "119000"
  },
  {
    "text": "Rubin uh before we begin just a quick introduction again my name is Gabby",
    "start": "119000",
    "end": "124960"
  },
  {
    "start": "120000",
    "end": "120000"
  },
  {
    "text": "Gabby nak and I'm a fellow at the National Lab in Israel which is part of a larger company called Raphael I'm also",
    "start": "124960",
    "end": "131080"
  },
  {
    "text": "an aent lecturer and researcher at the techon and I spend most of my time doing",
    "start": "131080",
    "end": "136599"
  },
  {
    "text": "uh network security research okay so this is my agenda for",
    "start": "136599",
    "end": "141720"
  },
  {
    "text": "the talk uh first off I will uh Define exactly what is TCP injection and how we",
    "start": "141720",
    "end": "149160"
  },
  {
    "text": "can identif TCP injections then I will touch on the mon on the networks spe monitor where in which we identify those",
    "start": "149160",
    "end": "156560"
  },
  {
    "text": "injections H then I will explain I will give you several examples of the TCP",
    "start": "156560",
    "end": "162879"
  },
  {
    "text": "injections we have found and what purpose uh they served and uh I will",
    "start": "162879",
    "end": "168879"
  },
  {
    "text": "describe our attempt to uh identify the entities behind those injections and",
    "start": "168879",
    "end": "174159"
  },
  {
    "text": "finally I will touch on a a proposed client side mitigation that ends to block those",
    "start": "174159",
    "end": "181760"
  },
  {
    "start": "181000",
    "end": "181000"
  },
  {
    "text": "injections okay now let's start with the basics what is exactly a TCP injection a",
    "start": "182360",
    "end": "187879"
  },
  {
    "text": "TCP injection is the event in which a third party adds to an existing TCP",
    "start": "187879",
    "end": "193599"
  },
  {
    "text": "session um a false packet and the false packet is sent to either one of the",
    "start": "193599",
    "end": "199360"
  },
  {
    "text": "peers of the TCP session uh as if it were a legitimate uh",
    "start": "199360",
    "end": "205000"
  },
  {
    "text": "packet uh now uh in this study we focused only on HT TP session on web",
    "start": "205000",
    "end": "210920"
  },
  {
    "text": "traffic and of course TCP injection can only occur for unprotected traffic so",
    "start": "210920",
    "end": "217159"
  },
  {
    "text": "injection cannot occur for https in addition uh throughout our",
    "start": "217159",
    "end": "223120"
  },
  {
    "text": "study we we've encountered mostly of practically all of the injections we encountered were done uh by on paath",
    "start": "223120",
    "end": "230840"
  },
  {
    "text": "entities meaning uh entities that has full control on the data path and can",
    "start": "230840",
    "end": "236319"
  },
  {
    "text": "EAS drop all the TCP uh all the all the packets of the TCP session generally there are an ISP a government or an",
    "start": "236319",
    "end": "243640"
  },
  {
    "text": "attacker which compromise the router of an ISP or a government uh actually throughout the presentation I will show",
    "start": "243640",
    "end": "250000"
  },
  {
    "text": "you show you example of TCP injection attacks performed by all three of the uh",
    "start": "250000",
    "end": "255319"
  },
  {
    "text": "the entities and uh we assume that the",
    "start": "255319",
    "end": "260600"
  },
  {
    "text": "injections are done out of band uh meaning that uh the injector does not",
    "start": "260600",
    "end": "266080"
  },
  {
    "text": "update or delete or drop uh the legitimate packets later on I will uh",
    "start": "266080",
    "end": "271479"
  },
  {
    "text": "explain why we need to assume that and I will also explain why indeed this",
    "start": "271479",
    "end": "276560"
  },
  {
    "text": "assumption holds in practice um TCP injections are generally",
    "start": "276560",
    "end": "284240"
  },
  {
    "start": "279000",
    "end": "279000"
  },
  {
    "text": "not a new technique as an attack technique they are not new TCP injection probably is as old as TCP itself it has",
    "start": "284240",
    "end": "291880"
  },
  {
    "text": "been reported in the past that uh H it is used by ISP to throttle and",
    "start": "291880",
    "end": "297720"
  },
  {
    "text": "peer-to-peer traffic on their network but simply injecting uh TCP reset",
    "start": "297720",
    "end": "303520"
  },
  {
    "text": "messages um it is also used for sensorship by injecting 4",
    "start": "303520",
    "end": "309759"
  },
  {
    "text": "443 HTTP responses actually numerous injections we have found indeed are",
    "start": "309759",
    "end": "315520"
  },
  {
    "text": "sensorship related and of course discuss discuss them later and according to the Snowden",
    "start": "315520",
    "end": "322000"
  },
  {
    "text": "documents we know that the NSA is heavily invested in TCP injection attacks they call it the quantum",
    "start": "322000",
    "end": "327960"
  },
  {
    "text": "operation and inject malicious payload in order to compromise the the client's",
    "start": "327960",
    "end": "336199"
  },
  {
    "start": "336000",
    "end": "336000"
  },
  {
    "text": "machine so now let me walk you through uh a typical progression of a TCP",
    "start": "336360",
    "end": "343160"
  },
  {
    "text": "injection attack let's say we have on on the right a a web server that is trying",
    "start": "343160",
    "end": "348319"
  },
  {
    "text": "to deliver content to the client on the left and we have an attacker on the network or an injector that tries to",
    "start": "348319",
    "end": "355560"
  },
  {
    "text": "modify in some way the website delivered to the client now for the sake of the",
    "start": "355560",
    "end": "360960"
  },
  {
    "text": "example let's say that the uh the content it wishes to alter resides on",
    "start": "360960",
    "end": "366520"
  },
  {
    "text": "the third packet the web server is about to send the uh to the client so we start",
    "start": "366520",
    "end": "372919"
  },
  {
    "text": "by having the web server send the first excuse me first couple of",
    "start": "372919",
    "end": "379960"
  },
  {
    "text": "uh uh pockets and um afterwards the the",
    "start": "379960",
    "end": "385360"
  },
  {
    "text": "attacker crafts a forged packet with the forged content",
    "start": "385360",
    "end": "391400"
  },
  {
    "text": "um and the important thing here is that the sequence number the TCP sequence number of the of the forge packet must",
    "start": "391560",
    "end": "398120"
  },
  {
    "text": "have uh the same sequence number as that of the legitimate third packet packet",
    "start": "398120",
    "end": "404280"
  },
  {
    "text": "the the web server is about to send to the client so it sends it off to the",
    "start": "404280",
    "end": "410240"
  },
  {
    "text": "client and of course the uh the actual server sends the legitimate third pocket",
    "start": "410240",
    "end": "416199"
  },
  {
    "text": "himself now according to our assumption this is an out of band in injection so the third packet the legitimate packet",
    "start": "416199",
    "end": "423879"
  },
  {
    "text": "will not be dropped by the injector so what we have here is actually that the client will receive two packets with the",
    "start": "423879",
    "end": "430160"
  },
  {
    "text": "same sequence number and this is a race a race between the two packets um if the",
    "start": "430160",
    "end": "435720"
  },
  {
    "text": "forge packet arrives to the client before the legitimate packet then the forge bytes will be processed by the TCP",
    "start": "435720",
    "end": "441759"
  },
  {
    "text": "stack and will be delivered to the browser and the legitimate packet would simply be dropped by the TCP stack as an",
    "start": "441759",
    "end": "448520"
  },
  {
    "text": "unnecessary r transmission the TCP stock will see the legitimate packet and you will say okay I already got those bytes",
    "start": "448520",
    "end": "455440"
  },
  {
    "text": "with the same sequence number I don't need them and it will throw it away and the client will see the the forge the",
    "start": "455440",
    "end": "462800"
  },
  {
    "text": "website of course if for some reason um the legitimate packet would win the race",
    "start": "462800",
    "end": "469159"
  },
  {
    "text": "then uh of course the injection will be unsuccessful now this is where we done",
    "start": "469159",
    "end": "475039"
  },
  {
    "text": "our monitoring uh right on the border router of the edge Network work very close to the uh to the client this is",
    "start": "475039",
    "end": "483000"
  },
  {
    "text": "where we we uh search for injections and we identified injections",
    "start": "483000",
    "end": "489639"
  },
  {
    "start": "486000",
    "end": "486000"
  },
  {
    "text": "uh by pretty straightforward we simply um identified pair of pockets that are",
    "start": "489639",
    "end": "495280"
  },
  {
    "text": "in a race meaning uh two packets in the same session that have the same sequence",
    "start": "495280",
    "end": "501400"
  },
  {
    "text": "number but a different payload this is the crucial thing a different payload and this event should not happen in",
    "start": "501400",
    "end": "508440"
  },
  {
    "text": "normal TCP session at all um and if does happen if two two packets having the",
    "start": "508440",
    "end": "515518"
  },
  {
    "text": "same sequence number carry a different payload then this is very indicative of a TCP injection",
    "start": "515519",
    "end": "523080"
  },
  {
    "text": "attack um now as you can see here um we are able to identify a TCP injection",
    "start": "523080",
    "end": "529920"
  },
  {
    "text": "simply because uh the injector uh did not drop the legitimate packet this is",
    "start": "529920",
    "end": "535360"
  },
  {
    "text": "why we can do it so probably most of you now ask yourself why the heck wouldn't",
    "start": "535360",
    "end": "540720"
  },
  {
    "text": "the injector drop the legitimate pocket it would make our life a lot harder to identify those those",
    "start": "540720",
    "end": "548720"
  },
  {
    "start": "548000",
    "end": "548000"
  },
  {
    "text": "injections and the answer is simply performance and reliability uh most of the injections we",
    "start": "548720",
    "end": "555040"
  },
  {
    "text": "have found are are done by Network operators and for a network operator to drop a a packet it needs to deploy a",
    "start": "555040",
    "end": "562839"
  },
  {
    "text": "middle box that uh U has some kind of a logic that decides which packets to pass",
    "start": "562839",
    "end": "568360"
  },
  {
    "text": "and which packet to Dr it doesn't have to be a separate middle box it could be an additional logic in the in an",
    "start": "568360",
    "end": "574720"
  },
  {
    "text": "existing middle box but this logic now presents an additional single foil to",
    "start": "574720",
    "end": "579839"
  },
  {
    "text": "failure in the network uh because if this logic fails for some reason because of a bug in the code then the all",
    "start": "579839",
    "end": "586600"
  },
  {
    "text": "production traffic now uh stops and if this logic now becomes loaded then the",
    "start": "586600",
    "end": "592880"
  },
  {
    "text": "all production traffic of the network operator simply slows down and network operators hate",
    "start": "592880",
    "end": "599839"
  },
  {
    "text": "um single point of failures and performance Bon X in the network this is why they much prefer to do uh uh this",
    "start": "599839",
    "end": "607920"
  },
  {
    "text": "kind of injection uh by simply out of band by just placing a tap or Port mirror that simply copies all the",
    "start": "607920",
    "end": "614320"
  },
  {
    "text": "production TR uh traffic to the injector functionality which decides uh when to",
    "start": "614320",
    "end": "621040"
  },
  {
    "text": "uh inject the the packet and if this injector functionality fails or become",
    "start": "621040",
    "end": "626720"
  },
  {
    "text": "loaded then it doesn't interfere with the flow of the production traffic and it is much less riskier for the network",
    "start": "626720",
    "end": "633160"
  },
  {
    "text": "operator to do that so this is why they prefer to do an injection out of band and the legitimate packets do not get",
    "start": "633160",
    "end": "641720"
  },
  {
    "text": "dropped okay so these are the networks we monitor to search for injections in",
    "start": "641720",
    "end": "647240"
  },
  {
    "text": "total we monitor the networks of three universities and one Enterprise uh I cannot reveal the the",
    "start": "647240",
    "end": "653120"
  },
  {
    "text": "actual details of the networks but because we signed an NDA but uh it doesn't really matter um",
    "start": "653120",
    "end": "659560"
  },
  {
    "text": "the networks serviced more than 75,000 users and as I said in total we",
    "start": "659560",
    "end": "664680"
  },
  {
    "text": "monitored one than more than 1.5 pits of data of web",
    "start": "664680",
    "end": "670120"
  },
  {
    "text": "traffic and this is the big table that summarizes all or most of the injections",
    "start": "670120",
    "end": "676079"
  },
  {
    "text": "uh we have found uh we partitioned the injections into 14",
    "start": "676079",
    "end": "682440"
  },
  {
    "text": "groups uh based on the injected resource and here you can see in the table that",
    "start": "682440",
    "end": "687760"
  },
  {
    "text": "uh this is the name of the group uh we've given the destination site meaning the the site that was injected to uh the",
    "start": "687760",
    "end": "695959"
  },
  {
    "text": "the site that the content of which was altered uh the location of the site here you can see that the majority of the",
    "start": "695959",
    "end": "702200"
  },
  {
    "text": "sites reside within China and this gives you the first clue that the entities that inject the traffic and inject do",
    "start": "702200",
    "end": "709320"
  },
  {
    "text": "the TCP injection actually are injector are Chinese injectors uh this is the short",
    "start": "709320",
    "end": "716399"
  },
  {
    "text": "description of the injected resource and the purpose uh eight out of the 14 injection groups",
    "start": "716399",
    "end": "723240"
  },
  {
    "text": "are were had the purpose uh to inject and to inject advertisement to add an",
    "start": "723240",
    "end": "729240"
  },
  {
    "text": "advertisement to the website of course uh this is in order to increase the the revenue of the of the injector to make",
    "start": "729240",
    "end": "736440"
  },
  {
    "text": "more money by injecting the advertisement four of the groups had",
    "start": "736440",
    "end": "741760"
  },
  {
    "text": "distinct indications of malicious intent to compromise the client and two of them",
    "start": "741760",
    "end": "747199"
  },
  {
    "text": "had aimed to block content but they were not sensorship related uh there were",
    "start": "747199",
    "end": "754680"
  },
  {
    "text": "other injections we have found that were sensorship related and we and I will",
    "start": "754680",
    "end": "759880"
  },
  {
    "text": "talk about them later on so first talk let's talk about the add injection uh this is a a a snapshot",
    "start": "759880",
    "end": "768639"
  },
  {
    "start": "762000",
    "end": "762000"
  },
  {
    "text": "of the Apple's website taken a few years ago before we did our research and",
    "start": "768639",
    "end": "773880"
  },
  {
    "text": "what's wrong with this with this with this picture uh the advertisement yes of",
    "start": "773880",
    "end": "780440"
  },
  {
    "text": "course the advertisement uh at the bottom this is not organic to the web page and this advertisement was injected",
    "start": "780440",
    "end": "786839"
  },
  {
    "text": "a few years ago by uh an American ISP to all its customers it is called CMA",
    "start": "786839",
    "end": "793959"
  },
  {
    "text": "Communications and actually over the past few years several isps have been",
    "start": "793959",
    "end": "799240"
  },
  {
    "text": "been identified uh to inject advertisement uh to their",
    "start": "799240",
    "end": "804880"
  },
  {
    "text": "customers and the thing is that uh in all of those instances is uh the ISP",
    "start": "804880",
    "end": "810320"
  },
  {
    "text": "which injected advertisement was always the edge ISP meaning the ISP that was closest to the uh to the client it was",
    "start": "810320",
    "end": "817560"
  },
  {
    "text": "his first hop to the internet and let me just illustrate this for you again we have on the right web server and on the",
    "start": "817560",
    "end": "824560"
  },
  {
    "start": "820000",
    "end": "820000"
  },
  {
    "text": "left a whole bunch of clients that uh are serviced by different Edge isps and",
    "start": "824560",
    "end": "831360"
  },
  {
    "text": "let's say that one of them is an injector that wishes to inject advertisement uh so that that mean that",
    "start": "831360",
    "end": "838519"
  },
  {
    "text": "all only the users that are serviced by that EDP uh will see the advertisement",
    "start": "838519",
    "end": "843759"
  },
  {
    "text": "and of course all the other users uh will not see the um the advertisement so in general",
    "start": "843759",
    "end": "851199"
  },
  {
    "text": "up until our work it has been General assumption that only edps inject uh",
    "start": "851199",
    "end": "858040"
  },
  {
    "text": "advertisement in this walk we are the first to notice that also non",
    "start": "858040",
    "end": "863320"
  },
  {
    "text": "edps uh also inject advertisement and this is much more serious because",
    "start": "863320",
    "end": "868800"
  },
  {
    "text": "because now they can inject advertisement to all internet users uh",
    "start": "868800",
    "end": "874160"
  },
  {
    "text": "because they simply control all the traffic coming out of the web",
    "start": "874160",
    "end": "879360"
  },
  {
    "text": "server so here is one of those injections uh here you can see here the",
    "start": "879839",
    "end": "885680"
  },
  {
    "text": "user simply browsed the uh to a website called tk.com just uh doesn't really",
    "start": "885680",
    "end": "892120"
  },
  {
    "text": "matter and uh the website refer the user to a resource at cnzz dcom cnzz is a",
    "start": "892120",
    "end": "899920"
  },
  {
    "text": "Chinese service that tracks user statistics much like Google analytics so",
    "start": "899920",
    "end": "905199"
  },
  {
    "text": "I assume that many uh website in China uses this uh service so this is the um",
    "start": "905199",
    "end": "912920"
  },
  {
    "text": "this is the request to cnzz decom and in response to that uh request the user got",
    "start": "912920",
    "end": "919279"
  },
  {
    "text": "two responses the left one is the valid response from the actual website from zzz.com here you can see just the uh",
    "start": "919279",
    "end": "927800"
  },
  {
    "text": "there is a JavaScript code and the right one is the injected uh uh response",
    "start": "927800",
    "end": "933880"
  },
  {
    "text": "injected somewhere along the between the server and the client and this is simply a redirection a 30 or2 redirection to",
    "start": "933880",
    "end": "940880"
  },
  {
    "text": "another JavaScript code named google. JS it's located at the Domain 899",
    "start": "940880",
    "end": "948000"
  },
  {
    "text": "j.com now after we Analyze This JavaScript we've seen that this JavaScript simply redirect redirect the",
    "start": "948000",
    "end": "955399"
  },
  {
    "text": "user through an affiliate uh ad networks and until it reaches the Google ad",
    "start": "955399",
    "end": "960720"
  },
  {
    "text": "networks and then um the user is simply served with an advertisement and",
    "start": "960720",
    "end": "965759"
  },
  {
    "text": "probably of course the injector had U some sort of a gain uh from this U",
    "start": "965759",
    "end": "973079"
  },
  {
    "text": "injection probably I got revenue sharing with this affiliate ad",
    "start": "973079",
    "end": "978519"
  },
  {
    "text": "Network yet another example of an advertisement injection uh is for user",
    "start": "978519",
    "end": "985120"
  },
  {
    "start": "979000",
    "end": "979000"
  },
  {
    "text": "who browsed the uh gis.com which is is a Chinese company that provides social",
    "start": "985120",
    "end": "990600"
  },
  {
    "text": "sharing toolbar again on the left the valid response and on the right the",
    "start": "990600",
    "end": "995639"
  },
  {
    "text": "forge response and this time also redirection but this time using the",
    "start": "995639",
    "end": "1001000"
  },
  {
    "text": "https metat tag refresh uh which simply redirects the user uh to the URL you see",
    "start": "1001000",
    "end": "1007680"
  },
  {
    "text": "down below and at this time the user was redirected to by.com the Chinese search",
    "start": "1007680",
    "end": "1014560"
  },
  {
    "text": "engine uh with the search stem onu uh the fashion store and simply the here",
    "start": "1014560",
    "end": "1020600"
  },
  {
    "text": "the user was served with all the search results for uniku and of course the the",
    "start": "1020600",
    "end": "1026438"
  },
  {
    "text": "injector did not forget to add to the URL uh the the referral tag as you can",
    "start": "1026439",
    "end": "1031720"
  },
  {
    "text": "see here right here uh this is actually allows the byu.com uh to identify which site U",
    "start": "1031720",
    "end": "1041079"
  },
  {
    "text": "referred the user to make that search and this actually allows for Revenue sharing between byu.com and the site",
    "start": "1041079",
    "end": "1047959"
  },
  {
    "text": "that refer the uh uh this uh the user so this is again as you can see H the",
    "start": "1047959",
    "end": "1054679"
  },
  {
    "text": "injector made money out of it yet another example here now there's",
    "start": "1054679",
    "end": "1060880"
  },
  {
    "text": "not really a redirection but simply the injected response added a JavaScript code which simply pops out an image as",
    "start": "1060880",
    "end": "1068720"
  },
  {
    "text": "you can see right here and um it prompts the user to download an executable at",
    "start": "1068720",
    "end": "1075400"
  },
  {
    "text": "first we saw that we thought that the executable was malicious but after we looked at it it was it seem like",
    "start": "1075400",
    "end": "1082280"
  },
  {
    "text": "a legitimate antivirus called kingsoft security okay so up until now uh you've",
    "start": "1082280",
    "end": "1090120"
  },
  {
    "start": "1087000",
    "end": "1087000"
  },
  {
    "text": "seen only examples of uh injections which uh of",
    "start": "1090120",
    "end": "1095520"
  },
  {
    "text": "advertisements uh but there were only were also injections that had the malicious",
    "start": "1095520",
    "end": "1101760"
  },
  {
    "text": "intent like one of these uh in this injection uh the an Android device Tri",
    "start": "1101760",
    "end": "1108559"
  },
  {
    "text": "to download an APK from a a third party",
    "start": "1108559",
    "end": "1113919"
  },
  {
    "text": "website and and the user got Forge response uh again a three or two three",
    "start": "1113919",
    "end": "1120640"
  },
  {
    "text": "or2 redirection to download the APK from yet another uh IP address according to",
    "start": "1120640",
    "end": "1126120"
  },
  {
    "text": "the bot Scout service this IP address is flagged as a bot and once we retrieve",
    "start": "1126120",
    "end": "1131559"
  },
  {
    "text": "the the alternative APK um we found out that it was a actually flagged as a",
    "start": "1131559",
    "end": "1139200"
  },
  {
    "text": "by by an antivirus as a malicious payload uh it was a welln Android thran",
    "start": "1139200",
    "end": "1147080"
  },
  {
    "text": "so actually what happened here is that user tried to download an APK uh from some website and it was silently",
    "start": "1147080",
    "end": "1153360"
  },
  {
    "text": "redirected uh to another site to download the a malicious",
    "start": "1153360",
    "end": "1160080"
  },
  {
    "text": "APK yet another injection H this time for an American website um actually",
    "start": "1160080",
    "end": "1166240"
  },
  {
    "text": "victimize the users of many gamblings sites all from a single vantage point and this injection",
    "start": "1166240",
    "end": "1173600"
  },
  {
    "text": "targeted the the website gpa. org gpwa",
    "start": "1173600",
    "end": "1178720"
  },
  {
    "text": "is the acronym of gambling a portal web Masters Association this is the association uh of the website",
    "start": "1178720",
    "end": "1186440"
  },
  {
    "text": "administrators of gambling site apparently there is such an association and uh this Association runs",
    "start": "1186440",
    "end": "1192960"
  },
  {
    "text": "a certification program and every gambling site that meets this certification program uh it gets",
    "start": "1192960",
    "end": "1199200"
  },
  {
    "text": "approved by gpwa and um it gets to so show a a seal",
    "start": "1199200",
    "end": "1206640"
  },
  {
    "text": "on its website that ws that gpwa approved the site there's nearly",
    "start": "1206640",
    "end": "1212679"
  },
  {
    "text": "2500 gambling site that are approved by gpwa one of them for example is online",
    "start": "1212679",
    "end": "1219480"
  },
  {
    "text": "casinos city.com uh which as you can see at the bottom shows the gpwa seal H now",
    "start": "1219480",
    "end": "1225919"
  },
  {
    "text": "interestingly enough in many of the sites uh this seal is saved as a",
    "start": "1225919",
    "end": "1231280"
  },
  {
    "text": "resource not locally in the in the site but um remotely on gpa. org this means",
    "start": "1231280",
    "end": "1239640"
  },
  {
    "text": "that every user that for example views online casino city.com will be referred",
    "start": "1239640",
    "end": "1246240"
  },
  {
    "text": "also to uh gpa. org to fetch the the resource for example this is a a request",
    "start": "1246240",
    "end": "1254159"
  },
  {
    "text": "for a such a resource this is for a another website called European soer",
    "start": "1254159",
    "end": "1260559"
  },
  {
    "text": "statistics.com another website that is approved by",
    "start": "1260559",
    "end": "1266039"
  },
  {
    "start": "1266000",
    "end": "1266000"
  },
  {
    "text": "gpwa and the H injected response the forge response that the user got is",
    "start": "1266039",
    "end": "1272320"
  },
  {
    "text": "actually JavaScript um which as you can see here uh the JavaScript on the right simply",
    "start": "1272320",
    "end": "1279840"
  },
  {
    "text": "read redirects the user to another JavaScript but this time it is located at at the Domain QP wa.org which is a",
    "start": "1279840",
    "end": "1287600"
  },
  {
    "text": "suspicious ly similar to gpa. org and qpa is registered under a Romanian",
    "start": "1287600",
    "end": "1295440"
  },
  {
    "text": "citizen which is not affiliate to gpwa and probably just it is just a",
    "start": "1295440",
    "end": "1301480"
  },
  {
    "text": "bogus identity and actually we learned that um this",
    "start": "1301480",
    "end": "1308559"
  },
  {
    "text": "injection um only happens for H once for every IP address meaning that if there",
    "start": "1308559",
    "end": "1315960"
  },
  {
    "text": "was an injection to a client the client will not be get injected H again and",
    "start": "1315960",
    "end": "1321640"
  },
  {
    "text": "actually if you can uh read this JavaScript you will see that the JavaScript will not run twice on the",
    "start": "1321640",
    "end": "1326799"
  },
  {
    "text": "same uh machine so the here the attacker was very careful not to run his malicious code H twice on the same uh",
    "start": "1326799",
    "end": "1334720"
  },
  {
    "text": "machine unfortunately we couldn't retrieve the the actual malicious uh",
    "start": "1334720",
    "end": "1340480"
  },
  {
    "text": "JavaScript H but we talked to the GPA gpwa Fox and we learned that uh uh",
    "start": "1340480",
    "end": "1347120"
  },
  {
    "text": "probably what happened is that the attacker actually compromised one of the routers of the RP and simply injected uh",
    "start": "1347120",
    "end": "1354840"
  },
  {
    "text": "this Forge response to all their users and um um",
    "start": "1354840",
    "end": "1362600"
  },
  {
    "text": "um actually okay and uh probably what happened here is that the the the user H",
    "start": "1362600",
    "end": "1368799"
  },
  {
    "text": "the attacker compromised the the client's browser according to the GP",
    "start": "1368799",
    "end": "1373880"
  },
  {
    "text": "gpwa Fox the the only intention was to uh add the advertisement and the spoof",
    "start": "1373880",
    "end": "1381919"
  },
  {
    "text": "affiliate tags but probably my guess is that because the attack is so sophisticated the the attacker had to",
    "start": "1381919",
    "end": "1389080"
  },
  {
    "text": "compromise the router and uh do all these injection probably it has greater",
    "start": "1389080",
    "end": "1394360"
  },
  {
    "text": "Ambitions but greater Ambitions but uh I can't I can't really",
    "start": "1394360",
    "end": "1400240"
  },
  {
    "start": "1400000",
    "end": "1400000"
  },
  {
    "text": "know so all the injections I've shown you so far uh were",
    "start": "1400240",
    "end": "1406080"
  },
  {
    "text": "actually commercially motivated both the advertisement injection and the malicious injections all of them serving",
    "start": "1406080",
    "end": "1412679"
  },
  {
    "text": "uh the injector to make more money H there are all Cate all another",
    "start": "1412679",
    "end": "1419360"
  },
  {
    "text": "category of injections which are politically motivated and not financially motivated which aim to do a",
    "start": "1419360",
    "end": "1426480"
  },
  {
    "text": "censorship so indeed we encountered numerous injections of a censorship all of them",
    "start": "1426480",
    "end": "1434360"
  },
  {
    "text": "are by the Chinese government and um most of them look",
    "start": "1434360",
    "end": "1439400"
  },
  {
    "text": "pretty much like this uh they had the The Forbidden response code 403 and this",
    "start": "1439400",
    "end": "1447159"
  },
  {
    "text": "and this uh body response body we simply just uh uh showed the user aonic message",
    "start": "1447159",
    "end": "1454760"
  },
  {
    "text": "that says the uh the due to laws and regulations the the site cannot be uh",
    "start": "1454760",
    "end": "1460600"
  },
  {
    "text": "shown to the user now the interesting thing here is that we monitor networks",
    "start": "1460600",
    "end": "1466039"
  },
  {
    "text": "outside of China which means that the Chinese government actually blocked uh",
    "start": "1466039",
    "end": "1471120"
  },
  {
    "text": "users outside of China from accessing uh content within China and this is a in",
    "start": "1471120",
    "end": "1477559"
  },
  {
    "text": "contradiction to the classic censorship in which uh the government blocks",
    "start": "1477559",
    "end": "1482640"
  },
  {
    "text": "content of Chinese users uh block Chinese users from seeing content",
    "start": "1482640",
    "end": "1488640"
  },
  {
    "text": "outside of China so here we we learned that the Chinese government not only censors Chinese citizens but also users",
    "start": "1488640",
    "end": "1496559"
  },
  {
    "text": "outside of China which is interesting and now in the next step we",
    "start": "1496559",
    "end": "1502520"
  },
  {
    "start": "1499000",
    "end": "1499000"
  },
  {
    "text": "try to reproduce the the injections uh I will let you first I will let you know",
    "start": "1502520",
    "end": "1507559"
  },
  {
    "text": "that uh for each injection group we only seen it the injections excuse me the",
    "start": "1507559",
    "end": "1513720"
  },
  {
    "text": "injections of each injection Group H we will only encounter it for just a short period of time just a day or two",
    "start": "1513720",
    "end": "1520720"
  },
  {
    "text": "afterwards the injections of that same injection group uh we were not",
    "start": "1520720",
    "end": "1526679"
  },
  {
    "text": "encountered so we tried to reproduce those injections again we simply tried to send the uh the original HTTP request",
    "start": "1526679",
    "end": "1535520"
  },
  {
    "text": "that triggered the um the original injection we observed and here are the",
    "start": "1535520",
    "end": "1541760"
  },
  {
    "text": "results big fat nothing none of the injections uh we were able to uh",
    "start": "1541760",
    "end": "1547880"
  },
  {
    "text": "reproduce simply zero and this was actually a big disappointment H but after the initial",
    "start": "1547880",
    "end": "1556279"
  },
  {
    "text": "publication of this work came to the rescue a researcher named Eric helvik as",
    "start": "1556279",
    "end": "1561320"
  },
  {
    "text": "you probably or some of you may know him as the author of the popular Network minor and he also tried to reproduce the",
    "start": "1561320",
    "end": "1568559"
  },
  {
    "text": "injections and he was more successful than than we are he managed to reproduce",
    "start": "1568559",
    "end": "1574960"
  },
  {
    "text": "Two of the uh injection groups out of the 14 but after a few weeks he also uh",
    "start": "1574960",
    "end": "1582559"
  },
  {
    "text": "didn't manage to reproduce the those injections too so all this uh from all",
    "start": "1582559",
    "end": "1588000"
  },
  {
    "text": "this we come to the conclusions that probably uh commercially motivated injections uh are um perhaps transient",
    "start": "1588000",
    "end": "1595480"
  },
  {
    "text": "in nature by the way the sensorship injections we were able to reproduce all the time but this was less interesting",
    "start": "1595480",
    "end": "1602120"
  },
  {
    "text": "for us because we knew that uh the Chinese government was involved H we wanted to reproduce the the commercial",
    "start": "1602120",
    "end": "1609159"
  },
  {
    "text": "uh injections so probably those injections are transient in nature meaning that uh",
    "start": "1609159",
    "end": "1615360"
  },
  {
    "text": "the injector targets a certain weapon website just for a day or two before it moves on to other websites and this is",
    "start": "1615360",
    "end": "1622120"
  },
  {
    "text": "probably just to uh be under the radar and um to not draw too much attention",
    "start": "1622120",
    "end": "1628720"
  },
  {
    "text": "and maybe for a day or two the users the users will not notice the injection or",
    "start": "1628720",
    "end": "1633760"
  },
  {
    "text": "the site administrator will not uh spend too much effort to investigate this",
    "start": "1633760",
    "end": "1640120"
  },
  {
    "start": "1640000",
    "end": "1640000"
  },
  {
    "text": "injection so now we H turned our attention to um to find out what is the",
    "start": "1640120",
    "end": "1646720"
  },
  {
    "text": "identity of the actual injectors behind those injections",
    "start": "1646720",
    "end": "1651799"
  },
  {
    "text": "first we tried of course to identify those injectors but but quickly we realized that it was nearly impossible",
    "start": "1651799",
    "end": "1657840"
  },
  {
    "text": "because there is not not really any identifyed information inside the injected payload so actually what we",
    "start": "1657840",
    "end": "1664679"
  },
  {
    "text": "tried to do is identify the location of the injectors from which network they",
    "start": "1664679",
    "end": "1669880"
  },
  {
    "text": "injected the pcket was was triggered and more specifically we tried to identify",
    "start": "1669880",
    "end": "1676880"
  },
  {
    "text": "the autonomous system from which the injected pocket was was triggered by",
    "start": "1676880",
    "end": "1683120"
  },
  {
    "text": "identify the autonomous system we can identify the entity that is responsible to the infrastructure uh from which uh",
    "start": "1683120",
    "end": "1690519"
  },
  {
    "text": "the uh the injected pocket was triggered and now I remind you that all the the",
    "start": "1690519",
    "end": "1696120"
  },
  {
    "text": "injections were performed on path meaning that the injector had access to",
    "start": "1696120",
    "end": "1701320"
  },
  {
    "text": "the infrastructure so uh The Entity that is responsible to that infrastructure",
    "start": "1701320",
    "end": "1706880"
  },
  {
    "text": "has to be responsible for the injections um so uh we use the to do",
    "start": "1706880",
    "end": "1713720"
  },
  {
    "start": "1709000",
    "end": "1709000"
  },
  {
    "text": "that we use the simple listic uh based on the TTL value in the IP header of the injected",
    "start": "1713720",
    "end": "1719919"
  },
  {
    "text": "packet um and this in this we Leverage The Common Insight that initial TTL",
    "start": "1719919",
    "end": "1725720"
  },
  {
    "text": "values are usually have four distinct values most commonly they are",
    "start": "1725720",
    "end": "1732679"
  },
  {
    "text": "either 32 64 128 or 255 this is the most uh common values",
    "start": "1732679",
    "end": "1738880"
  },
  {
    "text": "for initial TTL H values set by the operating system for example I think uh",
    "start": "1738880",
    "end": "1744440"
  },
  {
    "text": "Linux most flavors of Linux uh set the initial TTL value for of their IP",
    "start": "1744440",
    "end": "1749919"
  },
  {
    "text": "packets to 64 I think and maybe Windows 255 but I don't really remember but this",
    "start": "1749919",
    "end": "1755799"
  },
  {
    "text": "is the um uh the most common",
    "start": "1755799",
    "end": "1761240"
  },
  {
    "text": "values uh so actually what we tried uh to do is based on these common values to",
    "start": "1761240",
    "end": "1767679"
  },
  {
    "text": "estimate the number of hops the the injected packets Traverse for example if we see an injected packet with a TTL",
    "start": "1767679",
    "end": "1774240"
  },
  {
    "text": "value of 59 then most probably the initial TTL value of that packet was 64",
    "start": "1774240",
    "end": "1780399"
  },
  {
    "text": "it cannot be 32 uh and it probably uh is not 128 or",
    "start": "1780399",
    "end": "1786880"
  },
  {
    "text": "255 because these values are too high so it most probably was 64 uh then uh then most probably the the",
    "start": "1786880",
    "end": "1795760"
  },
  {
    "text": "injected packet simply Trav first five Hops uh um along the the path",
    "start": "1795760",
    "end": "1802600"
  },
  {
    "text": "and if we actually um um H know the path",
    "start": "1802600",
    "end": "1808279"
  },
  {
    "text": "between the server the injected web server and the client and we assume that",
    "start": "1808279",
    "end": "1813440"
  },
  {
    "text": "the ejected packet was triggered along the path from the server to the client so we can uh simply uh pinpoint the",
    "start": "1813440",
    "end": "1820679"
  },
  {
    "text": "location of the of the injector by simply just counting the number of hops",
    "start": "1820679",
    "end": "1826080"
  },
  {
    "text": "from the client back to towards the server and in this case the",
    "start": "1826080",
    "end": "1831279"
  },
  {
    "text": "fifth hop from the client actually gives us the location of the",
    "start": "1831279",
    "end": "1837440"
  },
  {
    "text": "injection and these are the results of our analysis um as you can see here um",
    "start": "1837440",
    "end": "1844760"
  },
  {
    "start": "1838000",
    "end": "1838000"
  },
  {
    "text": "uh in most of our uh in most of the injections uh we uh we've seen that",
    "start": "1844760",
    "end": "1851000"
  },
  {
    "text": "injector resides only uh between two to five hops away from the actual website",
    "start": "1851000",
    "end": "1857240"
  },
  {
    "text": "it was injected pretty close to the actual website in all in all the cases",
    "start": "1857240",
    "end": "1862519"
  },
  {
    "text": "uh the injector resided within the autonomous system of the",
    "start": "1862519",
    "end": "1868880"
  },
  {
    "text": "website H which is if you can think if you think about it it's pretty makes sense because uh the",
    "start": "1868880",
    "end": "1876519"
  },
  {
    "text": "injector would like to sit as close to the web server as possible and as you can see at the table",
    "start": "1876519",
    "end": "1885639"
  },
  {
    "text": "H the okay it went out okay um so uh as you",
    "start": "1885639",
    "end": "1892120"
  },
  {
    "text": "can see here at the table on the on the bottom these are the entities that are",
    "start": "1892120",
    "end": "1898200"
  },
  {
    "text": "responsible for the isps that are responsible to this autonomous system and as you can see here the the two of",
    "start": "1898200",
    "end": "1905039"
  },
  {
    "text": "two isps were responsible to the majority of the injections China Unicom and China Telecom which are the most",
    "start": "1905039",
    "end": "1911440"
  },
  {
    "text": "perhaps the largest isps in China and all of Asia and uh we are not certain that this",
    "start": "1911440",
    "end": "1918279"
  },
  {
    "text": "actually were these entities are excuse me these",
    "start": "1918279",
    "end": "1923440"
  },
  {
    "text": "entities are actually um um responsible the direct",
    "start": "1923440",
    "end": "1929440"
  },
  {
    "text": "responsible the direct cause for this injections uh but they're on the",
    "start": "1929440",
    "end": "1935360"
  },
  {
    "text": "infrastructure and we know that the injector sits on the infrastructure so probably they are and the US ISP",
    "start": "1935360",
    "end": "1942919"
  },
  {
    "text": "information information technology systems related to the gpw a case and we",
    "start": "1942919",
    "end": "1948600"
  },
  {
    "text": "know that this ISP was not responsible for the injection because the attacker simply compromised one of its",
    "start": "1948600",
    "end": "1955840"
  },
  {
    "text": "routers so uh for the last few minutes I would like to touch on the the",
    "start": "1955840",
    "end": "1961159"
  },
  {
    "text": "mitigations of the injections uh the best mitigation here is simply using",
    "start": "1961159",
    "end": "1966200"
  },
  {
    "text": "https if the uh the TCP packets are authenticated then they can cannot uh",
    "start": "1966200",
    "end": "1972799"
  },
  {
    "text": "the injection cannot happen unfortunately uh still many websites do not support https so we wanted to Now",
    "start": "1972799",
    "end": "1981039"
  },
  {
    "text": "search for another mitigation which is dependent only on the client and allows",
    "start": "1981039",
    "end": "1986799"
  },
  {
    "text": "it to block injections even if even if it cannot use",
    "start": "1986799",
    "end": "1992200"
  },
  {
    "text": "https so the naive approach here can be for example uh just uh search for R",
    "start": "1992200",
    "end": "1999240"
  },
  {
    "text": "buckets on the incoming traffic to the client much exactly the same way as we",
    "start": "1999240",
    "end": "2004600"
  },
  {
    "text": "did in our monitoring system but just do it on the client and but this only allows to",
    "start": "2004600",
    "end": "2011760"
  },
  {
    "text": "detect the injection in order to block the injection uh we need actually to delay each and every packet for say like",
    "start": "2011760",
    "end": "2018799"
  },
  {
    "text": "200 milliseconds uh in order to make sure that uh the current packet do not have",
    "start": "2018799",
    "end": "2025639"
  },
  {
    "text": "other packets that are racing it h only after 200 milliseconds that we do not",
    "start": "2025639",
    "end": "2031240"
  },
  {
    "text": "detect the race can we uh let the pocket pass and 200 a millisecond per pcket",
    "start": "2031240",
    "end": "2038159"
  },
  {
    "text": "builds up to a lot of uh delay it substantially increases uh the lad time",
    "start": "2038159",
    "end": "2044720"
  },
  {
    "text": "uh so actually an improved approach and might leverage an Insight",
    "start": "2044720",
    "end": "2050200"
  },
  {
    "text": "we had uh while we investigated the injected uh uh packets all in almost all",
    "start": "2050200",
    "end": "2056560"
  },
  {
    "text": "of the injected packet we have seen uh the IP ID and the TTL values in the IP",
    "start": "2056560",
    "end": "2061679"
  },
  {
    "text": "header of the injected pcket had abnormal values meaning they were not in sync with the TTL values and the IP ID",
    "start": "2061679",
    "end": "2069280"
  },
  {
    "text": "of all the other packets in the injected TCP session so we actually can leverage",
    "start": "2069280",
    "end": "2074560"
  },
  {
    "text": "this by simply just delaying only the packets that show abnormal values of",
    "start": "2074560",
    "end": "2080158"
  },
  {
    "text": "ipid and TT TTL and only for those packets search for AAS H this allows us",
    "start": "2080159",
    "end": "2087398"
  },
  {
    "text": "to delay only a very small fraction of the the packets of course and this is a",
    "start": "2087399",
    "end": "2093599"
  },
  {
    "text": "big butt here uh there is uh if if the injector uh tries to mimic the same ipid",
    "start": "2093599",
    "end": "2101480"
  },
  {
    "text": "and TTL values as that of the H the legitimate packets of the TCP session",
    "start": "2101480",
    "end": "2107440"
  },
  {
    "text": "then of course um it will not uh work as this uh this mitigation would not work",
    "start": "2107440",
    "end": "2115560"
  },
  {
    "text": "uh but still at least the injections we have found uh We've shown that we've",
    "start": "2115560",
    "end": "2121160"
  },
  {
    "text": "seen that all of the injections the injector simply do not try to mimic the iprd and TTL",
    "start": "2121160",
    "end": "2128599"
  },
  {
    "start": "2128000",
    "end": "2128000"
  },
  {
    "text": "values um so these are the results so we did a small experiment on the on benign",
    "start": "2128599",
    "end": "2135280"
  },
  {
    "text": "traffic that has no injections and uh on um on all the injected sessions we found",
    "start": "2135280",
    "end": "2143599"
  },
  {
    "text": "and um indeed the Nave approach as we expected uh increases substantially increases the low time of the web page",
    "start": "2143599",
    "end": "2150359"
  },
  {
    "text": "however the pro approach which delays only uh the packets with the um uh with",
    "start": "2150359",
    "end": "2156800"
  },
  {
    "text": "with the abnormal TTL or ipid value have a much moderate increase H but it it is",
    "start": "2156800",
    "end": "2162640"
  },
  {
    "text": "on the expense of some missed uh H injections again injections that were",
    "start": "2162640",
    "end": "2169839"
  },
  {
    "text": "the their ipid or TTL value were not that different from the legitimate uh",
    "start": "2169839",
    "end": "2175800"
  },
  {
    "text": "values of the of the other packets in the TCP session okay uh so with that um I would",
    "start": "2175800",
    "end": "2183520"
  },
  {
    "start": "2180000",
    "end": "2180000"
  },
  {
    "text": "like to conclude with the blackhead sound bites so this is these are my sound bites and the main takeaway from",
    "start": "2183520",
    "end": "2189920"
  },
  {
    "text": "the presentation uh TCP injection is a powerful technique that is deployed",
    "start": "2189920",
    "end": "2195880"
  },
  {
    "text": "currently on the Internet by isps government and",
    "start": "2195880",
    "end": "2200920"
  },
  {
    "text": "attackers uh we learned that Chinese isp's Ed Rog advertisements uh to",
    "start": "2200920",
    "end": "2207599"
  },
  {
    "text": "websites accessed by all internet users not only Chinese users and when possible",
    "start": "2207599",
    "end": "2213839"
  },
  {
    "text": "use your IDs to detect those injections uh as you have seen detection of",
    "start": "2213839",
    "end": "2219560"
  },
  {
    "text": "injections it's pretty straightforward and uh if you want to block those injection you can use our proposed",
    "start": "2219560",
    "end": "2226720"
  },
  {
    "text": "method and finally we published samples of those injections uh so if you are uh",
    "start": "2226720",
    "end": "2233079"
  },
  {
    "text": "you are interested and you want to dig in you very welcome to do so and here's the link and the link is also at the at",
    "start": "2233079",
    "end": "2240720"
  },
  {
    "text": "the white in the white paper that will be published so with that I would like",
    "start": "2240720",
    "end": "2246119"
  },
  {
    "text": "to thank you very much uh and if you have any other questions I will be happy to",
    "start": "2246119",
    "end": "2252720"
  },
  {
    "text": "answer thank",
    "start": "2252720",
    "end": "2255920"
  },
  {
    "text": "you okay yes please",
    "start": "2262680",
    "end": "2269530"
  },
  {
    "text": "[Music] yes how the hackers guess the CP",
    "start": "2269530",
    "end": "2275040"
  },
  {
    "text": "sequence this is because they are are at the on path and actually can see the TCP",
    "start": "2275040",
    "end": "2281359"
  },
  {
    "text": "sequence number of the T legitimate TCP session so they don't have to guess simply see it okay observe the the",
    "start": "2281359",
    "end": "2289359"
  },
  {
    "text": "sequence numbers yeah doesn't the aware of the cont yes",
    "start": "2289359",
    "end": "2298880"
  },
  {
    "text": "the always the uh the injector is always aware beforehand of the actual uh",
    "start": "2298880",
    "end": "2305800"
  },
  {
    "text": "content of the original website it does it own its homework uh he knows exactly",
    "start": "2305800",
    "end": "2311520"
  },
  {
    "text": "what he wants to inject and what is the original content and where it should be",
    "start": "2311520",
    "end": "2317440"
  },
  {
    "text": "injected so it the injector is well prep prepared for this",
    "start": "2317440",
    "end": "2324200"
  }
]