[
  {
    "text": "[Music] foreign",
    "start": "1730",
    "end": "6720"
  },
  {
    "text": "thank you very much so uh welcome to my my black cap briefing controlling the",
    "start": "7700",
    "end": "12900"
  },
  {
    "text": "source of using source code Management Systems I'm Brett Hawkins I'm with the adversary simulation team at IBM X-Force",
    "start": "12900",
    "end": "18180"
  },
  {
    "text": "red so agenda for today I'm going to go over an introduction just as some kind of key motivators around this research then I'm",
    "start": "18180",
    "end": "24660"
  },
  {
    "text": "going to get into a background on source code Management Systems where I'll then I'll go into diving deep into attacking three popular source code Management",
    "start": "24660",
    "end": "31019"
  },
  {
    "text": "Systems including GitHub enterprise gitlab Enterprise and bitbucket then I'm going to go over a tool that I wrote",
    "start": "31019",
    "end": "36960"
  },
  {
    "text": "called sem kit to help facilitate these attacks I have three demos put together we are going to see a software supply chain attack you're also going to see",
    "start": "36960",
    "end": "43500"
  },
  {
    "text": "lateral movement from source code Management Systems to other devops systems and I'll wrap things up with a",
    "start": "43500",
    "end": "48600"
  },
  {
    "text": "defensive considerations and a conclusion so just a little bit about me so I'm",
    "start": "48600",
    "end": "54360"
  },
  {
    "text": "Brett I'm on the adversary simulation team next Force Red where we do two to three month engagements uh kind of going",
    "start": "54360",
    "end": "59699"
  },
  {
    "text": "after an organization's crown jewels testing their detection response capabilities uh prior to my time at X-Force red I wore a number of different",
    "start": "59699",
    "end": "66600"
  },
  {
    "text": "hats both on the offensive and defensive side at mandian JP Morgan Chase and the James smucker company I've spoken at a",
    "start": "66600",
    "end": "73320"
  },
  {
    "text": "number of conferences including Derby con Wild West hackens Fest b-sides and hackers teaching hackers I'm also an",
    "start": "73320",
    "end": "79320"
  },
  {
    "text": "open source tool author so I'm the author of sharp assist and visibility cloak and now SCM kit and I was a",
    "start": "79320",
    "end": "84900"
  },
  {
    "text": "contributor to the due diligence project so first off how did this research come about uh firstly just real world",
    "start": "84900",
    "end": "90720"
  },
  {
    "text": "experience attacking these systems more and more our clients are asking us to go after these systems just because of the",
    "start": "90720",
    "end": "96119"
  },
  {
    "text": "role that they play if you think about in today's world software's running on everything it's running on our cars it's",
    "start": "96119",
    "end": "101220"
  },
  {
    "text": "running our Traffic Control Systems our medical devices and much more okay and that software running is source code",
    "start": "101220",
    "end": "106799"
  },
  {
    "text": "that source code is developed and maintained Within These source code Management Systems which makes them a very juicy Target from an attacker",
    "start": "106799",
    "end": "112320"
  },
  {
    "text": "perspective and we're starting to see that too so if you look at the lapsis group in the last year has claimed doing",
    "start": "112320",
    "end": "118020"
  },
  {
    "text": "source code theft to some large organizations there with Microsoft with their Azure devops instance T-Mobile via",
    "start": "118020",
    "end": "123479"
  },
  {
    "text": "their bitbucket instance and then Samsung and globin with their GitHub Enterprise instance and obviously in the last two years software supply chain",
    "start": "123479",
    "end": "129420"
  },
  {
    "text": "attacks have there have really become more popular if you look at the solarwinds breach for example that really enabled the compromise of",
    "start": "129420",
    "end": "135420"
  },
  {
    "text": "multiple organizations in both the private and the public sector",
    "start": "135420",
    "end": "140360"
  },
  {
    "text": "I have two main goals with this research so the first one was to bring more attention to securing these systems and",
    "start": "140819",
    "end": "146040"
  },
  {
    "text": "black hat is the perfect platform to do that secondly there's not much research out there right now on attacking and",
    "start": "146040",
    "end": "151140"
  },
  {
    "text": "defending these source code Management Systems so it's my goal that this is going to inspire future research on defending these critical systems",
    "start": "151140",
    "end": "158160"
  },
  {
    "text": "whether you're on offense or defense you're going to get something out of this talk you're going to learn some different attacks and errors against source code Management Systems you're",
    "start": "158160",
    "end": "164220"
  },
  {
    "text": "going to learn how to defend these systems and lastly from an offensive perspective you're going to learn how to abuse these systems from both a",
    "start": "164220",
    "end": "169860"
  },
  {
    "text": "privileged and a non-privileged context and just before I get started you know my perspective on this you know I'm",
    "start": "169860",
    "end": "175560"
  },
  {
    "text": "currently a red team operator I've been doing it for a long time prior to that I was a blue teamer so that's the perspective that I bring with this",
    "start": "175560",
    "end": "180840"
  },
  {
    "text": "research you know I'm not a devops engineer I'm not a software developer and I'm not a system administrator",
    "start": "180840",
    "end": "186480"
  },
  {
    "text": "so now we're gonna get into background some source code Management Systems so first off what is the source code management system to put it very simply",
    "start": "186480",
    "end": "192300"
  },
  {
    "text": "it manages source code repositories it allows multiple developers to work on code at the same time track issues you",
    "start": "192300",
    "end": "198480"
  },
  {
    "text": "know and it integrates with other systems within the devops pipeline right so other CI CD systems",
    "start": "198480",
    "end": "203700"
  },
  {
    "text": "um and if you look at kind of three popular systems that I included for This research now these are three most popular that we see on our engagements",
    "start": "203700",
    "end": "209819"
  },
  {
    "text": "so that's kind of why I chose these for research so GitHub Enterprise GitHub Enterprise and then bitbucket server we",
    "start": "209819",
    "end": "215340"
  },
  {
    "text": "see bitbucket Server more than bitbucket Cloud on engagements so that's where I focus on the bit bucket side all of",
    "start": "215340",
    "end": "220440"
  },
  {
    "text": "these though they support different hosting options whether you host them on premise or in the cloud and they also support Integrations into the devops",
    "start": "220440",
    "end": "226739"
  },
  {
    "text": "pipeline and when you talk about the devops pipeline these systems lie within the build phase so you kind of have your",
    "start": "226739",
    "end": "233640"
  },
  {
    "text": "your Source codes developed and then you know it's built tested deployed and then ran in production and as you can see",
    "start": "233640",
    "end": "240000"
  },
  {
    "text": "here all other phases in the devops pipeline rely on the Integrity of the",
    "start": "240000",
    "end": "245159"
  },
  {
    "text": "source code that is developed and maintained Within These systems and when you talk about source code Integrity let's talk about software",
    "start": "245159",
    "end": "251640"
  },
  {
    "text": "supply chain attacks so for a software supply chain attack an attacker is simply injecting themselves into the",
    "start": "251640",
    "end": "256680"
  },
  {
    "text": "development process at some point to deploy malicious code there's two angles to this you can either go after the build Integrity like the solarwinds",
    "start": "256680",
    "end": "263100"
  },
  {
    "text": "attackers did or you can go after the source Integrity so my research specifically focuses on scenarios B and",
    "start": "263100",
    "end": "268919"
  },
  {
    "text": "C in that diagram around going after these source code Management systems and you're going to see a demo of doing a",
    "start": "268919",
    "end": "274139"
  },
  {
    "text": "software supply chain attack in this presentation you're also another useful scenario from",
    "start": "274139",
    "end": "280199"
  },
  {
    "text": "a source code Management System point is these can be initial access points to other systems in the devops pipeline so",
    "start": "280199",
    "end": "286080"
  },
  {
    "text": "because they have integration set up if you're able to compromise one of these systems you could for example pivot to a CI CD platform pivot to a distribution",
    "start": "286080",
    "end": "292800"
  },
  {
    "text": "platform and you're also going to see this in the demos as well",
    "start": "292800",
    "end": "298340"
  },
  {
    "text": "okay all right so now we're going to cover attacking and defending GitHub Enterprise",
    "start": "300960",
    "end": "307039"
  },
  {
    "text": "so the term Enterprise with GitHub Enterprise is going to refer to the entire GitHub Enterprise instance an",
    "start": "307919",
    "end": "314340"
  },
  {
    "text": "organization within GitHub Enterprise so an Enterprise can have one-to-many organizations underneath it and you have",
    "start": "314340",
    "end": "320580"
  },
  {
    "text": "different Enterprise roles and also organization roles within GitHub Enterprise you also have different roles for",
    "start": "320580",
    "end": "326940"
  },
  {
    "text": "repositories so whether you can oh you can you just read a repository do you have right access admin access Etc and",
    "start": "326940",
    "end": "334380"
  },
  {
    "text": "then you have access token scope so in order to access the rest API you can authenticate with an access token or an",
    "start": "334380",
    "end": "340320"
  },
  {
    "text": "API token and you have different Scopes applied to this and that basically tells you what you're authorized to do with that access",
    "start": "340320",
    "end": "346380"
  },
  {
    "text": "token to the rest API and you're going to see kind of the",
    "start": "346380",
    "end": "351419"
  },
  {
    "text": "abuse of the rest API in this presentation so um you know going to be abusing that and all these you know all these systems",
    "start": "351419",
    "end": "357360"
  },
  {
    "text": "today so each of them have a rest API that is basically a programmatic interface that you can interact with them to do different functionality",
    "start": "357360",
    "end": "365060"
  },
  {
    "text": "so now we're going to go through the different attacks and areas against GitHub Enterprise now this isn't an exhaustive list these are just ones that",
    "start": "366419",
    "end": "372720"
  },
  {
    "text": "I've researched and also that our team has used during engagements for full details on all these scenarios make sure",
    "start": "372720",
    "end": "378300"
  },
  {
    "text": "you check out my white paper which I'll have a link at the end of the presentation it'll also be shared on the",
    "start": "378300",
    "end": "384000"
  },
  {
    "text": "black hat site so let's talk about reconnaissance so in",
    "start": "384000",
    "end": "389220"
  },
  {
    "text": "terms of reconnaissance on GitHub Enterprise really focusing on three primary aspects so focusing on",
    "start": "389220",
    "end": "394680"
  },
  {
    "text": "repositories files and code because those are going to be the most value to an attacker from a reconnaissance",
    "start": "394680",
    "end": "400199"
  },
  {
    "text": "standpoint now you can do this reconnaissance either via the web interface the rest API or you can also",
    "start": "400199",
    "end": "405479"
  },
  {
    "text": "do that with my sem kit tool that I'll be showing later in terms of logging for this reconnaissance this activity is going to",
    "start": "405479",
    "end": "412319"
  },
  {
    "text": "log in the ha proxy log and I've got a search criteria there with a screenshot of me filtering for some of my",
    "start": "412319",
    "end": "417360"
  },
  {
    "text": "reconnaissance activity so you can see me there kind of searching for things like password or Jenkins file",
    "start": "417360",
    "end": "424199"
  },
  {
    "text": "another attack you can do in GitHub Enterprise is a repository takeover so the site admin role in GitHub Enterprise",
    "start": "424199",
    "end": "430139"
  },
  {
    "text": "is like the admin role within GitHub Enterprise if you are a site admin you can unlock any repository for modify",
    "start": "430139",
    "end": "436440"
  },
  {
    "text": "access and that includes private repositories so you can see in the screenshot on the left there's a private repository and",
    "start": "436440",
    "end": "443160"
  },
  {
    "text": "then on the screenshot on the right I'm using my site admin access to unlock that repository where I have full access",
    "start": "443160",
    "end": "448740"
  },
  {
    "text": "to all of its uh all of its settings and you know any code in that repo",
    "start": "448740",
    "end": "454440"
  },
  {
    "text": "in terms of logging for this attack this is going to be logged in the audit log on the GitHub Enterprise server and the",
    "start": "454440",
    "end": "459960"
  },
  {
    "text": "search criteria there for finding this activity is action repo.staff underscore unlock now all the search criteria and",
    "start": "459960",
    "end": "466259"
  },
  {
    "text": "logs you're going to see through here I have them all included in the blog post and the white paper so you can take a look at those afterwards",
    "start": "466259",
    "end": "472680"
  },
  {
    "text": "another attack you can do in GitHub Enterprise as a site admin is you can do user impersonation so you have two",
    "start": "472680",
    "end": "477900"
  },
  {
    "text": "options for this you can either do an impersonate user login and you can do that via the web interface as you can see in that screenshot or a stealthier",
    "start": "477900",
    "end": "484620"
  },
  {
    "text": "option is you can use an impersonation token now you can create an impersonation token either via the web",
    "start": "484620",
    "end": "489960"
  },
  {
    "text": "interface or the rest API and when you create an impersonation token for a user that user cannot see that impersonation",
    "start": "489960",
    "end": "496919"
  },
  {
    "text": "token only other site admins can see that that user is being impersonated",
    "start": "496919",
    "end": "503479"
  },
  {
    "text": "this activity is going to also be logged and the audit log and get the GitHub Enterprise server and I've got a few different search criterias there listed",
    "start": "504120",
    "end": "510479"
  },
  {
    "text": "as far as how you can detect this activity again all these the search Criterion the logs will be included they're included in the blog post in the",
    "start": "510479",
    "end": "516899"
  },
  {
    "text": "white paper another attack you can do is you can promote a user to site admin so if",
    "start": "516899",
    "end": "522180"
  },
  {
    "text": "you're a site admin you can promote any other user site admin or demote end user from site admin where could this be",
    "start": "522180",
    "end": "527700"
  },
  {
    "text": "useful let's say you've compromised the site admin account and you're worried uh you know you're worried about them you",
    "start": "527700",
    "end": "532860"
  },
  {
    "text": "know basically you're worried about the blue team being your tail right and so you kind of want to switch to another user but keep that site admin access so",
    "start": "532860",
    "end": "539220"
  },
  {
    "text": "you can promote another user to site admin switch to that other user and this activity is also be logged in",
    "start": "539220",
    "end": "545459"
  },
  {
    "text": "the audit log I've got a couple different search criteria listed there and what's nice about the the uh the",
    "start": "545459",
    "end": "550620"
  },
  {
    "text": "audit log is that it'll tell you whether something was done via the API or not so it'll tell you whether something was abused via the API so you can see in",
    "start": "550620",
    "end": "557100"
  },
  {
    "text": "that screenshot there it says this was promoted via the API by the a Dumbledore user",
    "start": "557100",
    "end": "563100"
  },
  {
    "text": "three options for persistence in GitHub Enterprise so it's you know obviously from Attack perspective you want to maintain persistent access to you know",
    "start": "563100",
    "end": "570060"
  },
  {
    "text": "those systems so you can do that with personal access tokens and you can create those as a normal user via the",
    "start": "570060",
    "end": "575100"
  },
  {
    "text": "web interface Yelp Enterprise doesn't give you the ability to use the rest API to create personal access tokens",
    "start": "575100",
    "end": "581580"
  },
  {
    "text": "you can also use impersonation tokens like I mentioned previously and then the last option is you can also use SSH keys",
    "start": "581580",
    "end": "587459"
  },
  {
    "text": "for persistence and you can do this as a normal user either via the web interface rest API or you could use sem kit for",
    "start": "587459",
    "end": "593940"
  },
  {
    "text": "that the persistence activity is also going to be logged within the GitHub",
    "start": "593940",
    "end": "599040"
  },
  {
    "text": "Enterprise audit log as you can see kind of the screenshot there me filtering for some of my activity",
    "start": "599040",
    "end": "604920"
  },
  {
    "text": "the last thing I want to mention for GitHub Enterprise is the Management console so the management there's a",
    "start": "604920",
    "end": "609959"
  },
  {
    "text": "couple main consoles in GitHub Enterprise so you have the Management console and then you have the site admin console the Management console is where",
    "start": "609959",
    "end": "615600"
  },
  {
    "text": "you can configure the entire Enterprise instance and you access this via a single shared password",
    "start": "615600",
    "end": "621060"
  },
  {
    "text": "the site admin console is specifically for managing different facets of an organization so think like you know",
    "start": "621060",
    "end": "626580"
  },
  {
    "text": "role-based access for users and such but some different things you can do in the Management console is you can for",
    "start": "626580",
    "end": "631860"
  },
  {
    "text": "example add your public SSH key to the GitHub Enterprise instance so that you can SSH to the server itself",
    "start": "631860",
    "end": "639360"
  },
  {
    "text": "once on the server um there's a few different interesting things that you can do the default SSH Port is 122 and you'll SSH with the",
    "start": "639360",
    "end": "646800"
  },
  {
    "text": "admin user account one thing you can do is list the GitHub Enterprise configuration via the ghe config command",
    "start": "646800",
    "end": "652320"
  },
  {
    "text": "this could contain active directory credentials depending on what the server is integrated with another file of",
    "start": "652320",
    "end": "657540"
  },
  {
    "text": "interest on the server is the secrets configuration file the secrets configuration file could contain",
    "start": "657540",
    "end": "663000"
  },
  {
    "text": "API keys or SSH Keys depending on what GitHub Enterprise is integrated with in that environment",
    "start": "663000",
    "end": "669660"
  },
  {
    "text": "in terms of logging so for example adding stuff you know like adding public SSH keys in the Management console",
    "start": "669660",
    "end": "676019"
  },
  {
    "text": "that's going to be logged in the management log so you can see I have a screenshot there where I'm filtering for some of my activity adding the SSH keys",
    "start": "676019",
    "end": "682980"
  },
  {
    "text": "in that Management console now we're going to get into attacking gitlab Enterprise",
    "start": "682980",
    "end": "689279"
  },
  {
    "text": "so gilab Enterprise is going to hear the term project and you can use project or repository interchangeably they mean the",
    "start": "689279",
    "end": "695519"
  },
  {
    "text": "same thing you know project and host code track issues and contain CI CD Pipelines",
    "start": "695519",
    "end": "701100"
  },
  {
    "text": "and there's five you know five permissions for a project or repository you can see there from an attacker",
    "start": "701100",
    "end": "706380"
  },
  {
    "text": "perspective you're going to want to compromise a user that has developer or higher permissions and just like with GitHub Enterprise if you want to use an",
    "start": "706380",
    "end": "712860"
  },
  {
    "text": "access token or an API key there's different Scopes that are applied to that that authorize you for what you're allowed to do within the rest API",
    "start": "712860",
    "end": "720720"
  },
  {
    "text": "and just like you know GitHub Enterprise there's a bunch of different things you can do with the rest API and you're going to see that in the demos",
    "start": "720720",
    "end": "727860"
  },
  {
    "text": "these are the tax scenarios that I'll be covering again not an exhaustive list you know just ones that I've researched",
    "start": "727860",
    "end": "733019"
  },
  {
    "text": "and full details on these attacks um will be are in the white paper uh additionally a number of these you can",
    "start": "733019",
    "end": "739019"
  },
  {
    "text": "perform with the sem kit tool so just like GitHub Enterprise you know reconnaissance is important in Gate lab",
    "start": "739019",
    "end": "744899"
  },
  {
    "text": "Enterprise focusing on repositories files and code you can do this with the web interface rest API or sem kit",
    "start": "744899",
    "end": "752519"
  },
  {
    "text": "now in terms of logging something that I thought was interesting so this activity is logged on the production log and API log but if you see the screenshot on the",
    "start": "752519",
    "end": "759120"
  },
  {
    "text": "top right the the activity as far as what I was performing with constants for was actually being filtered so an",
    "start": "759120",
    "end": "765060"
  },
  {
    "text": "alternative approach I ended up using the access log and the screenshot below you can see when I use the access log",
    "start": "765060",
    "end": "771360"
  },
  {
    "text": "filtering for reconnaissance activity I could actually see that activity",
    "start": "771360",
    "end": "776600"
  },
  {
    "text": "just like with GitHub Enterprise you can also impersonate other users so if you are an admin role within gitlab",
    "start": "777420",
    "end": "782579"
  },
  {
    "text": "Enterprise you can either do an impersonate user login via the web interface as you can see in that screenshot or the stealthier option",
    "start": "782579",
    "end": "788880"
  },
  {
    "text": "again is creating impersonation token and you can do that via the web interface or the rest API and again only other",
    "start": "788880",
    "end": "795839"
  },
  {
    "text": "admin users can see that an impersonation token was created for that user that user has no clue that they are",
    "start": "795839",
    "end": "801600"
  },
  {
    "text": "being impersonated and this is going to be logged in both the production log and the API log on",
    "start": "801600",
    "end": "807480"
  },
  {
    "text": "the gitlab Enterprise server I've got some search criteria there again all the search criteria and all the important",
    "start": "807480",
    "end": "812519"
  },
  {
    "text": "logs are all included in the blog post and also the white paper so I've just got a screenshot there for me filtering",
    "start": "812519",
    "end": "817980"
  },
  {
    "text": "for some impersonation token activity another thing you can do just like the",
    "start": "817980",
    "end": "823800"
  },
  {
    "text": "other system you can promote a user to admin so if you're an admin and gitlab Enterprise you can promote a use any user to admin or demote any user from",
    "start": "823800",
    "end": "830279"
  },
  {
    "text": "admin you can do this via the web interface rest API or SCM kit",
    "start": "830279",
    "end": "836220"
  },
  {
    "text": "and this activity is also going to be logged in the production log and API log so you can see a screenshot there for example I'll be filtering for that user",
    "start": "836220",
    "end": "842700"
  },
  {
    "text": "promotion activity same three persistence options with gitlab Enterprise with a couple caveats",
    "start": "842700",
    "end": "848279"
  },
  {
    "text": "so you can create personal access tokens as a normal user in the web interface or",
    "start": "848279",
    "end": "853440"
  },
  {
    "text": "gitlab Enterprise gives you the ability to do this via the rest API as well but you have to be an administrative user",
    "start": "853440",
    "end": "858959"
  },
  {
    "text": "you also have impersonation tokens but that requires administrative permissions and then the last option is SSH Keys",
    "start": "858959",
    "end": "865320"
  },
  {
    "text": "which you can create those as a normal user either via the web interface rest API or sem kit",
    "start": "865320",
    "end": "872040"
  },
  {
    "text": "again the production log and API log is where this activity is going to be logged so the screenshot in the top shows me filtering for some personal",
    "start": "872040",
    "end": "877680"
  },
  {
    "text": "access token activity and the screenshot on the bottom shows me filtering from for some SSH key activity",
    "start": "877680",
    "end": "884579"
  },
  {
    "text": "so another attack here is around you can modify a continuous integration or continuous delivery Pipeline with",
    "start": "884579",
    "end": "890880"
  },
  {
    "text": "thinkit lab Enterprise so in gitlab Enterprise there's a concept of these gitlab Runners gitlab Runners will",
    "start": "890880",
    "end": "896579"
  },
  {
    "text": "execute instructions from a gitlab CI configuration file from that configuration file it's going",
    "start": "896579",
    "end": "902339"
  },
  {
    "text": "to be named.gitlab.ci.yml and it's going to be in the root of the repository so you're",
    "start": "902339",
    "end": "908100"
  },
  {
    "text": "going to need developer maintainer or owner role for that project to modify that file once you do though that's",
    "start": "908100",
    "end": "913980"
  },
  {
    "text": "going to trigger the pipeline to run for that project in terms of reconnaissance to find you know repositories that have",
    "start": "913980",
    "end": "919560"
  },
  {
    "text": "gitlab Runners available to your compromised user there are some reconnaissance modules with an sem kit that you can do that",
    "start": "919560",
    "end": "926880"
  },
  {
    "text": "so in terms of updating this configuration file via the web interface it's going to be logged in the production log but obviously you can",
    "start": "926880",
    "end": "932639"
  },
  {
    "text": "just update this file via the git command line tool so really any updates to the gitlab CI configuration file",
    "start": "932639",
    "end": "938399"
  },
  {
    "text": "should be heavily scrutinized and require an approver before being pushed so the last mention here for gitlab",
    "start": "938399",
    "end": "945300"
  },
  {
    "text": "Enterprise is around SSH access so a few different interesting things from an attacker perspective a gitlab",
    "start": "945300",
    "end": "951779"
  },
  {
    "text": "configuration file on the server so that can contain credentials like active directory credentials depending on what",
    "start": "951779",
    "end": "957120"
  },
  {
    "text": "the system's integrated with there's also a gitlab Secrets file and that could contain API Keys as well again",
    "start": "957120",
    "end": "962639"
  },
  {
    "text": "depending on what Integrations are in place and lastly there's a postgres SQL database on gitlab Enterprise there's",
    "start": "962639",
    "end": "970079"
  },
  {
    "text": "some interesting things in there so you can see in that screenshot I'm filtering like a user's table for usernames",
    "start": "970079",
    "end": "975360"
  },
  {
    "text": "encrypted passwords and one-time password backup code so those are three interesting things from an attacker",
    "start": "975360",
    "end": "980639"
  },
  {
    "text": "perspective if you have access SSH access to the gitlab Enterprise server",
    "start": "980639",
    "end": "986279"
  },
  {
    "text": "so the last system I'm going to cover attacking is bitbucket and then we're going to get into some demos and SCM kit",
    "start": "986279",
    "end": "992160"
  },
  {
    "text": "so in bitbucket there's also the concept of project and this is specifically bitbucket servers what I focused on and",
    "start": "992160",
    "end": "998639"
  },
  {
    "text": "a project can contain one-to-many repositories it's kind of like a container for one of my repositories",
    "start": "998639",
    "end": "1004160"
  },
  {
    "text": "there's four main permission levels in bitbucket server you have Global permissions that's going to tell you what type of user you are and then you",
    "start": "1004160",
    "end": "1009980"
  },
  {
    "text": "also have permissions in projects and repos so whether you are an admin to them write access read access Etc and",
    "start": "1009980",
    "end": "1016820"
  },
  {
    "text": "then lastly just like the other two systems there's different Scopes that can apply to access tokens they're called HTTP access tokens in bitbucket",
    "start": "1016820",
    "end": "1023660"
  },
  {
    "text": "server and something that's different though with bitbucket server is those access tokens are only scoped to be able",
    "start": "1023660",
    "end": "1029058"
  },
  {
    "text": "to interact with repositories or projects having said that though there's a number",
    "start": "1029059",
    "end": "1034339"
  },
  {
    "text": "of other different things you can do with the rest API in bitbucket server you would just have to authenticate with like a stolen cookie or a username",
    "start": "1034339",
    "end": "1040760"
  },
  {
    "text": "password and these are attacks I'll go through for bitbucket Server again not an",
    "start": "1040760",
    "end": "1045798"
  },
  {
    "text": "exhaustive list uh full details on these attacks are in the white paper and you can perform a number of these with sem",
    "start": "1045799",
    "end": "1052040"
  },
  {
    "text": "kit so just like the others you can do reconnaissance via the web interface rest API or sem kit however one thing",
    "start": "1052040",
    "end": "1060559"
  },
  {
    "text": "that I found was interesting when I was uh you know testing doing this research is that this activity is logged in the",
    "start": "1060559",
    "end": "1066260"
  },
  {
    "text": "bitbucket log however I had to increase the logging level in order for my reconnaissance activity to show up so",
    "start": "1066260",
    "end": "1072320"
  },
  {
    "text": "once I did increase the logging level you can see there that my queries for searching for like API Keys whatever I",
    "start": "1072320",
    "end": "1077660"
  },
  {
    "text": "was performing reconnaissance for was actually showing up just like the other two systems if",
    "start": "1077660",
    "end": "1083419"
  },
  {
    "text": "you're an admin you can promote any user to admin or demote end user from admin and you can do this via the web",
    "start": "1083419",
    "end": "1088640"
  },
  {
    "text": "interface rest API or sem kit this activity is going to be logged in",
    "start": "1088640",
    "end": "1093799"
  },
  {
    "text": "both the access log and in the audit log so you can see there I have a screenshot kind of showing my user promotion",
    "start": "1093799",
    "end": "1100760"
  },
  {
    "text": "activity within the access log so two options for persistence with",
    "start": "1100760",
    "end": "1106340"
  },
  {
    "text": "bitbucket server you'll notice that impersonation tokens are missing and that's because there's not a concept of impersonation tokens within bitbucket",
    "start": "1106340",
    "end": "1113120"
  },
  {
    "text": "server you can either create personal access tokens or SSH Keys as a normal user and you can do this via the web interface rest API or SCM kit",
    "start": "1113120",
    "end": "1122000"
  },
  {
    "text": "and that activity will also be logged in the access log and audit log I've got a screenshot there for some of my SSH key",
    "start": "1122000",
    "end": "1127700"
  },
  {
    "text": "Edition activity just another reminder all the logs uh for for this activity and search criteria is all included in",
    "start": "1127700",
    "end": "1134240"
  },
  {
    "text": "the blog post and the white paper which I'll have links to at the end of the presentation",
    "start": "1134240",
    "end": "1139360"
  },
  {
    "text": "so the last attack for bitbucket server is around modifying cic pipelines so similar to gitlab Enterprise but a",
    "start": "1139520",
    "end": "1145640"
  },
  {
    "text": "little bit different so bitbucket is an atlassian product uh they all at lasting also has a product called bamboo and",
    "start": "1145640",
    "end": "1152360"
  },
  {
    "text": "bamboo can be used as a CI CD pipeline so if a bit bucket repo is using bamboo",
    "start": "1152360",
    "end": "1158539"
  },
  {
    "text": "as a CI CD pipeline it's going to have a bamboo Dash specs directory within the root of the repository and it's going to",
    "start": "1158539",
    "end": "1164240"
  },
  {
    "text": "have a configuration file within that folder so it's either going to have a yaml file which is bamboo.yaml as you can see in that screenshot or it's going",
    "start": "1164240",
    "end": "1171020"
  },
  {
    "text": "to be a Java spec file and it'll be pom.xml and you're going to need write or admin access to the repo to modify",
    "start": "1171020",
    "end": "1177740"
  },
  {
    "text": "that configuration file but once you do that's going to trigger that pipeline to run automatically so you can see in the",
    "start": "1177740",
    "end": "1183500"
  },
  {
    "text": "screenshot there I'm adding some lines to the bamboo configuration file to trigger the pipeline",
    "start": "1183500",
    "end": "1188780"
  },
  {
    "text": "this activity is going to be logged in the bamboo log on the bamboo server so you can see a screenshot there of some",
    "start": "1188780",
    "end": "1194539"
  },
  {
    "text": "of my activity uh updating this file so again just like gitlab Enterprise any commits to these CI CD configuration",
    "start": "1194539",
    "end": "1201679"
  },
  {
    "text": "files should be heavily scrutinized so as you saw with these three systems there's a bunch of different things you",
    "start": "1201679",
    "end": "1208100"
  },
  {
    "text": "can do with the rest API and so I wanted to create a tool that would help automate that because I didn't want to",
    "start": "1208100",
    "end": "1213440"
  },
  {
    "text": "have to keep looking up the API documentation and doing curl requests during engagement so that's where sem kit came about",
    "start": "1213440",
    "end": "1219320"
  },
  {
    "text": "so sem kit is a source code management attack toolkit I wrote it in c-sharp so it can be ran in memory with command",
    "start": "1219320",
    "end": "1225320"
  },
  {
    "text": "control Frameworks like Cobalt strike I have the URL there to the tool I just pushed it this week I also did a full",
    "start": "1225320",
    "end": "1231620"
  },
  {
    "text": "presentation on the tool at black hat Arsenal this week as well it supports attacking GitHub enterprise gitlab",
    "start": "1231620",
    "end": "1237500"
  },
  {
    "text": "Enterprise and bitbucket server and has multiple modules for doing things like reconnaissance privilege escalation and",
    "start": "1237500",
    "end": "1243320"
  },
  {
    "text": "persistence so here's an example screenshot of running sem kit memory you're going to",
    "start": "1243320",
    "end": "1248900"
  },
  {
    "text": "see these in the demos but this just shows me using a utility called inline execute assembly which is developed by a",
    "start": "1248900",
    "end": "1254720"
  },
  {
    "text": "member of X-Force red as well Sean Jones to be able to run SCM kit in memory so here I'm doing a the code search module",
    "start": "1254720",
    "end": "1261260"
  },
  {
    "text": "searching for API secrets here's an example of using sem kit to do",
    "start": "1261260",
    "end": "1266480"
  },
  {
    "text": "privilege escalation on GitHub Enterprise by at promoting a user to site admin",
    "start": "1266480",
    "end": "1272299"
  },
  {
    "text": "and here's an example of doing persistence in gitlab Enterprise via a personal access token",
    "start": "1272299",
    "end": "1278419"
  },
  {
    "text": "so now we're going to do the demos so first demo I have put together I'm going to do a software supply chain attack on",
    "start": "1278419",
    "end": "1283880"
  },
  {
    "text": "GitHub Enterprise second demo I'm going to do lateral movement from gitlab Enterprise to artifactory which is a package repository system and then the",
    "start": "1283880",
    "end": "1290720"
  },
  {
    "text": "third demo I'm going to show doing lateral movement from bitbucket server to Jenkins",
    "start": "1290720",
    "end": "1296020"
  },
  {
    "text": "okay so just to set the stage here we have access to GitHub Enterprise right now as",
    "start": "1309020",
    "end": "1314539"
  },
  {
    "text": "a compromised user hpotter and we are interested in gaining uh at modify",
    "start": "1314539",
    "end": "1319640"
  },
  {
    "text": "access to the wandos repository Wando s is a fictitious piece of software that",
    "start": "1319640",
    "end": "1325460"
  },
  {
    "text": "runs on all wands within the Wizarding World so we want to be able to gain modify access to this repository so that",
    "start": "1325460",
    "end": "1330919"
  },
  {
    "text": "we can perform a software supply chain attack so the first thing we're going to do with sem kit as our compromised hpotter user who's just a normal user is",
    "start": "1330919",
    "end": "1337460"
  },
  {
    "text": "we're going to do the search repo module with an sem kit searching for wandos so we're going to go ahead and run this",
    "start": "1337460",
    "end": "1343340"
  },
  {
    "text": "command within Cobalt strike I'm going to go ahead and paste this in here",
    "start": "1343340",
    "end": "1349960"
  },
  {
    "text": "all right so we're going to run this command and what you're going to see is that RH Potter user cannot see the wandos repository all right so it must",
    "start": "1351620",
    "end": "1357380"
  },
  {
    "text": "be some sort of like private repository that we can't see however as part of this operation we found an API key on a file share now",
    "start": "1357380",
    "end": "1365179"
  },
  {
    "text": "during our engagements we commonly find API keys on user workstations file shares internal wikis and stuff like",
    "start": "1365179",
    "end": "1370880"
  },
  {
    "text": "that so we found this API key and we want to validate this API key and see what privileges it has so to do that",
    "start": "1370880",
    "end": "1376400"
  },
  {
    "text": "we're going to use sem kit with the prism module authenticating with that API key",
    "start": "1376400",
    "end": "1381559"
  },
  {
    "text": "so we're going to go ahead and run this command here and see if this API key is valid that we found on a file share and what privileges it has",
    "start": "1381559",
    "end": "1388580"
  },
  {
    "text": "and what you're going to see here this API key that we found and this is a scenario that you know we do during engagements our adversary simulation",
    "start": "1388580",
    "end": "1394880"
  },
  {
    "text": "engagements we have actually conducted this scenario so this has site admin access so we had the site admin API key",
    "start": "1394880",
    "end": "1400340"
  },
  {
    "text": "and we have a regular compromise user hpotter so what we're going to do is we're going to use sem kit with the add",
    "start": "1400340",
    "end": "1406220"
  },
  {
    "text": "admin module and that API key and we're going to promote our compromised hpotter user to site admin so we're going to run",
    "start": "1406220",
    "end": "1413299"
  },
  {
    "text": "this command here",
    "start": "1413299",
    "end": "1415899"
  },
  {
    "text": "and we're going to see is H Potter will be added to the site admin role so now if we go back to the GitHub",
    "start": "1419659",
    "end": "1425240"
  },
  {
    "text": "Enterprise web interface and refresh what you're going to see is there going to be there's going to be a rocket ship",
    "start": "1425240",
    "end": "1430820"
  },
  {
    "text": "show up on the top right and that is the site admin console within GitHub Enterprise so now we have site admin access within",
    "start": "1430820",
    "end": "1437600"
  },
  {
    "text": "GitHub Enterprise we're going to take a look at the users and see if there's any interesting users this devops user looks pretty",
    "start": "1437600",
    "end": "1443720"
  },
  {
    "text": "interesting you know we're interested to see if maybe this user has some private repositories so we're going to drill into here this",
    "start": "1443720",
    "end": "1449659"
  },
  {
    "text": "user has two private repositories so we're going to check those out and what you're going to see is that",
    "start": "1449659",
    "end": "1455419"
  },
  {
    "text": "user devops user actually owns the wandos repository which is private and that's why we couldn't see that as our",
    "start": "1455419",
    "end": "1460760"
  },
  {
    "text": "normal hpotter user so there's two options here you can either do a user impersonation",
    "start": "1460760",
    "end": "1467120"
  },
  {
    "text": "attack to impersonate that user devops user or what we're going to do is we're going to do a repository takeover by",
    "start": "1467120",
    "end": "1473240"
  },
  {
    "text": "unlocking this Repository so we're going to go ahead unlock this by default and GitHub Enterprise this",
    "start": "1473240",
    "end": "1479360"
  },
  {
    "text": "repository is going to be unlocked for two hours so you have to provide a reason here and this is all logged on the GitHub",
    "start": "1479360",
    "end": "1485600"
  },
  {
    "text": "Enterprise server so now this this repository the One OS repository is locked for hpotter so now",
    "start": "1485600",
    "end": "1491360"
  },
  {
    "text": "we should have full access to the repo and its code and all of its settings so now we're going to go back",
    "start": "1491360",
    "end": "1497720"
  },
  {
    "text": "and you're going to see here that now we will have access to the Repository",
    "start": "1497720",
    "end": "1503179"
  },
  {
    "text": "and just to kind of further prove this we're going to show kind of just with the get command line tool we can also clone the repository down as well with",
    "start": "1503179",
    "end": "1509840"
  },
  {
    "text": "the hpod or user now so kind of this attack path we were you know a normal user we found a site admin API key on a",
    "start": "1509840",
    "end": "1516799"
  },
  {
    "text": "file share we use that API key to promote our compromised user to site admin where we performed a repository",
    "start": "1516799",
    "end": "1522919"
  },
  {
    "text": "takeover on the wand OS repository and now we can you know modify that software as part of a software supply chain",
    "start": "1522919",
    "end": "1528860"
  },
  {
    "text": "attack the second demo I'm going to show doing a lateral movement from gitlab",
    "start": "1528860",
    "end": "1534740"
  },
  {
    "text": "Enterprise to artifactory which is a package repository system so as I mentioned in gitlab Enterprise",
    "start": "1534740",
    "end": "1540260"
  },
  {
    "text": "there's these concepts of gitlab Runners and they will execute uh instructions in a gitlab CI configuration file so we're",
    "start": "1540260",
    "end": "1547159"
  },
  {
    "text": "going to perform reconnaissance with our compromised user and see if our user has access to any gitlab runners",
    "start": "1547159",
    "end": "1552919"
  },
  {
    "text": "so we're first going to do this list Runner module with SCM kit so we're going to go ahead and",
    "start": "1552919",
    "end": "1558020"
  },
  {
    "text": "authenticate here and see if our user has access to any gitlab runners and what repositories those Runners are",
    "start": "1558020",
    "end": "1563120"
  },
  {
    "text": "assigned to and you're going to see we're going to get a few a few hits here um the secret spells directory is the",
    "start": "1563120",
    "end": "1568880"
  },
  {
    "text": "one we're gonna end up focusing on so we we have access to some Runners now like let's go ahead and do some",
    "start": "1568880",
    "end": "1574100"
  },
  {
    "text": "reconnaissance for that gitlab CI configuration file and we're going to cross reference Runners that we have access to with gitlab CI configuration",
    "start": "1574100",
    "end": "1581659"
  },
  {
    "text": "files basically repos that have both and so we're going to do the search File module search for gitlab.ci with sem kit",
    "start": "1581659",
    "end": "1589520"
  },
  {
    "text": "and there's going to be a couple hits to come up but again we're going to focus on this secret spells directory here",
    "start": "1589520",
    "end": "1595880"
  },
  {
    "text": "so you can see here the secret spells directory has the CI configuration file and it also has a gitlab runner that we",
    "start": "1595880",
    "end": "1601760"
  },
  {
    "text": "have access to so we're going to go ahead and go to this repo and try to modify this configuration file now I'm",
    "start": "1601760",
    "end": "1608059"
  },
  {
    "text": "doing this via the web interface just for demo purposes but obviously you can do this via the git command line tool and in this environment specifically",
    "start": "1608059",
    "end": "1614480"
  },
  {
    "text": "what you're going to see is there's some integration between gitlab and artifactory so it's basically pushing a",
    "start": "1614480",
    "end": "1620419"
  },
  {
    "text": "file to artifactory which is a package repository system and you can see",
    "start": "1620419",
    "end": "1625460"
  },
  {
    "text": "what it's doing is it's authenticating with a username and password for artifactory to push this file so what we",
    "start": "1625460",
    "end": "1630980"
  },
  {
    "text": "want is we want to get these credentials so we're going to modify this configuration file to print out the",
    "start": "1630980",
    "end": "1637039"
  },
  {
    "text": "artifactory username and password that it is being used so we're going to go ahead and update this file",
    "start": "1637039",
    "end": "1642679"
  },
  {
    "text": "and again once you update this CI configuration file that's going to trigger the pipeline to run automatically",
    "start": "1642679",
    "end": "1648260"
  },
  {
    "text": "so we're going to go ahead and commit our changes",
    "start": "1648260",
    "end": "1651760"
  },
  {
    "text": "all right so you're going to see that it's going to validate that it's that it's a good configuration file and then what we're going to do is we're going to",
    "start": "1653900",
    "end": "1660140"
  },
  {
    "text": "go look at the pipeline and take a look at our job and make sure that it ran",
    "start": "1660140",
    "end": "1666080"
  },
  {
    "text": "and what we should see in our the job output for our newly modified job with that configuration file is the",
    "start": "1666080",
    "end": "1671900"
  },
  {
    "text": "artifactory credentials now why could this be useful from an attacker perspective if you have access to artifactory you know you could upload",
    "start": "1671900",
    "end": "1678260"
  },
  {
    "text": "malicious packages right that are used in other projects or that are deployed so we're going to go ahead you can see",
    "start": "1678260",
    "end": "1683960"
  },
  {
    "text": "our pipeline ran take a look at our job and we're going to view the job output and what you're going to see in the",
    "start": "1683960",
    "end": "1690080"
  },
  {
    "text": "bottom there is it did print out the credentials that was being that were being used so the artifactor username and the password",
    "start": "1690080",
    "end": "1696320"
  },
  {
    "text": "so we're going to go ahead and validate these credentials by logging into artifactory let's go log in here with the admin username",
    "start": "1696320",
    "end": "1703279"
  },
  {
    "text": "also if you haven't noticed uh my lab I'm a big Harry Potter nerd so that's why I've got uh all this you know",
    "start": "1703279",
    "end": "1709220"
  },
  {
    "text": "Hogwarts Hogwarts stuff set up so I'm a huge Harry Potter nerd so you can see here we have access to",
    "start": "1709220",
    "end": "1714799"
  },
  {
    "text": "artifactory where again now we have access we can upload malicious packages uh you know we kind of completed that",
    "start": "1714799",
    "end": "1719840"
  },
  {
    "text": "lateral movement from gitlab Enterprise to artifactory last demo I'm going to show is doing",
    "start": "1719840",
    "end": "1726200"
  },
  {
    "text": "lateral movement from bitbucket server to Jenkins so Jenkins is a build system cicd system",
    "start": "1726200",
    "end": "1733299"
  },
  {
    "text": "and Jenkins can be used obviously to build applications so if there's an integration set up between a source code",
    "start": "1733299",
    "end": "1740120"
  },
  {
    "text": "management system and Jenkins it will run what's called a Jenkins configuration file right in a source code management repository and that name",
    "start": "1740120",
    "end": "1746840"
  },
  {
    "text": "of that configuration file is going to be Jenkins file so what we're doing with our compromised user is we're using SCM",
    "start": "1746840",
    "end": "1752179"
  },
  {
    "text": "kit and we're searching for any Jenkins CI configurations file with the search File module searching for Jenkins file",
    "start": "1752179",
    "end": "1759020"
  },
  {
    "text": "so we're gonna go ahead and run this search here",
    "start": "1759020",
    "end": "1762520"
  },
  {
    "text": "and you're going to see a couple instances pop up we're going to focus on this Marauders map app directory so we're going to go to this Marauders map",
    "start": "1765860",
    "end": "1772460"
  },
  {
    "text": "app repo and try to modify this Jenkins CI configuration file now our goal here with this file so when",
    "start": "1772460",
    "end": "1779659"
  },
  {
    "text": "Jenkins runs the cic CI CD configuration file it runs on the Jenkins server itself so what we're interested in is we",
    "start": "1779659",
    "end": "1786559"
  },
  {
    "text": "want to perform lateral movement to Jenkins so what we're going to do in this configuration file and again I'm doing this in the web interface you",
    "start": "1786559",
    "end": "1792740"
  },
  {
    "text": "could do it via the git command line tool as well what we're going to do is we're going to have it execute some commands to add our public SSH key to",
    "start": "1792740",
    "end": "1800179"
  },
  {
    "text": "the authorized Keys file for the Jenkins user account that way we can SSH to the Jenkins server as a Jenkins user account",
    "start": "1800179",
    "end": "1807140"
  },
  {
    "text": "now this can be prevented on the Jenkins side if you have like sandboxing in place for groovy scripting",
    "start": "1807140",
    "end": "1812899"
  },
  {
    "text": "so I'm going to go ahead and update this Jenkins file and you know typically like in a real world environment like during",
    "start": "1812899",
    "end": "1818480"
  },
  {
    "text": "engagements you just you know kind of let you know Jenkins run on whatever schedule it's running on to pull the updated configuration file especially if",
    "start": "1818480",
    "end": "1825080"
  },
  {
    "text": "you haven't compromised the Jenkins server um for this case in this demo I'm just going to run this Jenkins job manually",
    "start": "1825080",
    "end": "1830960"
  },
  {
    "text": "um so that we can see the results so we're going to go ahead and run this Jenkins job and again it's going to pull that updated Jenkins CI configuration",
    "start": "1830960",
    "end": "1838039"
  },
  {
    "text": "file from that repository and run it and it's going to run the actions that we just put in there so it's going to run",
    "start": "1838039",
    "end": "1843559"
  },
  {
    "text": "who am I the host name and then add our public SSH key from our our private public SSH key pair",
    "start": "1843559",
    "end": "1849799"
  },
  {
    "text": "to the authorized Keys file so you can see there that that ran so now we should be able to SSH to the",
    "start": "1849799",
    "end": "1856760"
  },
  {
    "text": "Jenkins server as the Jenkins user account so we're gonna go ahead and SSH here with our our Associated private SSH key",
    "start": "1856760",
    "end": "1863960"
  },
  {
    "text": "with the public SSH key we added and you can see there we've successfully pivoted from uh from over to Jenkins from",
    "start": "1863960",
    "end": "1871340"
  },
  {
    "text": "bitbucket so this kind of shows an example of being able to take take advantage of those Integrations with",
    "start": "1871340",
    "end": "1876860"
  },
  {
    "text": "source code Management Systems to Pivot to build systems",
    "start": "1876860",
    "end": "1881500"
  },
  {
    "text": "so defensive considerations for the sem kit tool itself I have a yarrow file",
    "start": "1887539",
    "end": "1892880"
  },
  {
    "text": "within the repository with status static signatures that you can apply for attackers if they were to use this Tool",
    "start": "1892880",
    "end": "1897980"
  },
  {
    "text": "uh in its default State I also have a static user agent string within the tool so that you have I have listed there now",
    "start": "1897980",
    "end": "1904340"
  },
  {
    "text": "the reason for this is again to detect activity with this tool so I have a snort rule that's including the sem kit",
    "start": "1904340",
    "end": "1909620"
  },
  {
    "text": "repo for this additionally in your web proxies you can add rules for this user agent string",
    "start": "1909620",
    "end": "1915080"
  },
  {
    "text": "lastly any access tokens or SSH keys that are created with sem kit the names",
    "start": "1915080",
    "end": "1921500"
  },
  {
    "text": "are going to be prepended with SCM kit Dash so you can put rules in your source code Management Systems to detect any",
    "start": "1921500",
    "end": "1927260"
  },
  {
    "text": "access tokens or SSH keys that are created with this in the beginning of the name",
    "start": "1927260",
    "end": "1932980"
  },
  {
    "text": "I'm not going to get into these logs and the log filters and details just because again they're included within the blog",
    "start": "1933080",
    "end": "1938419"
  },
  {
    "text": "post and in the white paper but for GitHub Enterprise make sure you get these three logs forwarded to your sim",
    "start": "1938419",
    "end": "1946700"
  },
  {
    "text": "and then I've got some rules that you can apply to detect the activity that I showed today within GitHub Enterprise",
    "start": "1946700",
    "end": "1953299"
  },
  {
    "text": "for gitlab Enterprise make sure you get your application log production log API log and web log forward to your sim",
    "start": "1953299",
    "end": "1961419"
  },
  {
    "text": "and then make sure you get these rules applied for the activity I showed all the way you know reconnaissance user impersonation all those different",
    "start": "1963740",
    "end": "1969620"
  },
  {
    "text": "attacks that I showed lastly with bitbucket server make sure you get the access log audit log and",
    "start": "1969620",
    "end": "1976399"
  },
  {
    "text": "bitbucket log forward to your sim and then on the bamboo server make sure you have your bamboo log for it to your sim",
    "start": "1976399",
    "end": "1981620"
  },
  {
    "text": "as well again all these rules for all of these and all the logs you need to forward to",
    "start": "1981620",
    "end": "1987260"
  },
  {
    "text": "your to your sim they're all included in the blog post and the white paper in terms of configuration guidance",
    "start": "1987260",
    "end": "1993919"
  },
  {
    "text": "across the board for source code Management Systems in terms of personal access tokens and SSH Keys make sure",
    "start": "1993919",
    "end": "1999679"
  },
  {
    "text": "that you set an automatic expiration date and don't allow users to create these with no expiration date think of",
    "start": "1999679",
    "end": "2005740"
  },
  {
    "text": "these like passwords like we have expiration dates for passwords so we should do the same thing for Access tokens and SSH keys in terms of access",
    "start": "2005740",
    "end": "2013000"
  },
  {
    "text": "and authorization limit the number of administrator accounts Within These systems you know at maximum or at",
    "start": "2013000",
    "end": "2018580"
  },
  {
    "text": "minimum there needs to be two you need to have a primary admin and a backup but there shouldn't be more unless absolutely necessary you know the more",
    "start": "2018580",
    "end": "2024760"
  },
  {
    "text": "admin users the more attack surface for an attacker make sure you enable multi-factor",
    "start": "2024760",
    "end": "2029799"
  },
  {
    "text": "authentication and lastly disable user impersonation as you saw I took advantage of that that feature within",
    "start": "2029799",
    "end": "2035860"
  },
  {
    "text": "GitHub Enterprise and gitlab Enterprise in terms of repository access and code",
    "start": "2035860",
    "end": "2041019"
  },
  {
    "text": "commits operate on a policy of least privilege so don't just give everybody access to all repositories additionally make sure",
    "start": "2041019",
    "end": "2047799"
  },
  {
    "text": "that you delete code branches in a sufficient time so I've seen time and time again where a developer will create",
    "start": "2047799",
    "end": "2053500"
  },
  {
    "text": "some sort of like testing code Branch they'll commit credentials to it and kind of leave it left over for our red",
    "start": "2053500",
    "end": "2059080"
  },
  {
    "text": "team to find like additionally whenever users are making code commits require at least one",
    "start": "2059080",
    "end": "2065260"
  },
  {
    "text": "approver for that commit so they can actually review to make sure there was nothing malicious in that commit and require sign commits either via gpg keys",
    "start": "2065260",
    "end": "2072280"
  },
  {
    "text": "or certificates in terms of logging so you saw I showed a bunch of different logs that you can",
    "start": "2072280",
    "end": "2077919"
  },
  {
    "text": "use and some different detection rules so make sure that you get those logs that I have forwarded to your sim and",
    "start": "2077919",
    "end": "2083800"
  },
  {
    "text": "additionally as you saw with you know systems like bitbucket server I had to increase the logging level to detect that reconnaissance activity so increase",
    "start": "2083800",
    "end": "2090040"
  },
  {
    "text": "the logging level when needed as well so in conclusion you know these systems",
    "start": "2090040",
    "end": "2097180"
  },
  {
    "text": "they contain some of the most you know sensitive information organizations and they're really a critical critical piece",
    "start": "2097180",
    "end": "2102280"
  },
  {
    "text": "to organizations and a key component in the devops like life cycle where attackers are really focusing on these",
    "start": "2102280",
    "end": "2108099"
  },
  {
    "text": "more and more because again software runs on practically everything today between our cars Traffic Control Systems",
    "start": "2108099",
    "end": "2113440"
  },
  {
    "text": "Right medical devices right so these systems are very important depending on the organization right",
    "start": "2113440",
    "end": "2118540"
  },
  {
    "text": "compromise of a source code management system in one organization could lead to compromise within another organization",
    "start": "2118540",
    "end": "2125260"
  },
  {
    "text": "and then lastly you know these systems they really do need more visibility and they need more research from the",
    "start": "2125260",
    "end": "2130660"
  },
  {
    "text": "community so kind of a call to action to you all is to you know I really hope to see future research and somebody take",
    "start": "2130660",
    "end": "2136960"
  },
  {
    "text": "this research to the next level to further defend these systems before I wrap up here I just have some",
    "start": "2136960",
    "end": "2143500"
  },
  {
    "text": "acknowledgments uh without these people they supported me through this entire research project and gave me tons of",
    "start": "2143500",
    "end": "2150099"
  },
  {
    "text": "really great feedback uh without them I would not be standing here today so I want to thank Chris Thompson Daniel",
    "start": "2150099",
    "end": "2155560"
  },
  {
    "text": "Crowley Dimitri Patrick Fussell and Reuben boonen",
    "start": "2155560",
    "end": "2161280"
  },
  {
    "text": "so as I mentioned the blog post and the white paper URL I'll leave this up here that's got the white paper's gonna have",
    "start": "2161500",
    "end": "2167980"
  },
  {
    "text": "full details on what I talked about today if you have any questions feel free to hit me up on Twitter or Discord",
    "start": "2167980",
    "end": "2174220"
  },
  {
    "text": "or come talk to me after on the hallway I'm happy to answer anybody's questions",
    "start": "2174220",
    "end": "2179320"
  },
  {
    "text": "uh with that that's it and I thank you very much [Applause] [Music]",
    "start": "2179320",
    "end": "2187290"
  },
  {
    "text": "[Music]",
    "start": "2191130",
    "end": "2194238"
  }
]