[
  {
    "text": "thanks a lot for coming to our talk our talk is 525 techniques to gather threat",
    "start": "0",
    "end": "6089"
  },
  {
    "text": "Intel and track actors it's a talk by proof point colleagues someone is the",
    "start": "6089",
    "end": "13349"
  },
  {
    "text": "main contributor of this particular research it's done most of the groundwork and he will be staying behind",
    "start": "13349",
    "end": "19830"
  },
  {
    "text": "after the talk so feel very welcome to stay around and get to know him and we",
    "start": "19830",
    "end": "26310"
  },
  {
    "text": "can you know exchange Intel and our experiences with these techniques okay",
    "start": "26310",
    "end": "33420"
  },
  {
    "text": "hi guys thanks thanks for coming my name is Sam Wong I'm a senior researcher as propyne our let's talk",
    "start": "33420",
    "end": "40590"
  },
  {
    "text": "when will be presenter I hope you guys enjoy his talk thank you all right",
    "start": "40590",
    "end": "50390"
  },
  {
    "text": "my name is Wayne I was cofounders armored eyes technologies into 13 crew",
    "start": "50789",
    "end": "57329"
  },
  {
    "text": "point acquired armor eyes technologies so now I'm VP of engineering at Proofpoint and one of my roles is to",
    "start": "57329",
    "end": "65549"
  },
  {
    "text": "lead a team and study all of these actors really closely and when I we say",
    "start": "65549",
    "end": "71210"
  },
  {
    "text": "study all these actors we want to know who they are what tools they use we want to have oh their source code we want to",
    "start": "71210",
    "end": "78330"
  },
  {
    "text": "know exactly what they're doing on a day to day basis which means we we don't",
    "start": "78330",
    "end": "83549"
  },
  {
    "text": "want just to look at their malware and reverse their exploit and understand you",
    "start": "83549",
    "end": "92490"
  },
  {
    "text": "know what their malware and exploits are doing want to understand everything that they do in their daily operations so",
    "start": "92490",
    "end": "99750"
  },
  {
    "text": "over the past few years after joining prove point we have given lots of talks",
    "start": "99750",
    "end": "105780"
  },
  {
    "text": "on various very well-known actors we're ability to discuss a lot of information",
    "start": "105780",
    "end": "112110"
  },
  {
    "text": "um so one question that we always get asked is how do you guys find all this",
    "start": "112110",
    "end": "117659"
  },
  {
    "text": "stuff you can't you can't find all this stuff by just looking at the malware or by reversing and so this talk we're",
    "start": "117659",
    "end": "124500"
  },
  {
    "text": "going to be sharing with you 25 techniques that we often use and for",
    "start": "124500",
    "end": "130470"
  },
  {
    "text": "every technique we'll give you some examples of how we actually applied that particular",
    "start": "130470",
    "end": "136470"
  },
  {
    "text": "technique against some actor and what Intel we were able to extract by using",
    "start": "136470",
    "end": "143400"
  },
  {
    "text": "that technique so showcase 25 methods",
    "start": "143400",
    "end": "148950"
  },
  {
    "text": "for gathering thread Intel for over 30 real cases mostly against web-based command and control servers operated by",
    "start": "148950",
    "end": "156450"
  },
  {
    "text": "actors and why are we going to do it because actors are quite careless with",
    "start": "156450",
    "end": "162030"
  },
  {
    "text": "their server configuration and with the way they write their code how do we do",
    "start": "162030",
    "end": "168360"
  },
  {
    "text": "it pen testing application code review and finally we will show that",
    "start": "168360",
    "end": "175890"
  },
  {
    "text": "intelligence-gathering is key to an intelligence based security strategy and make a conclusion all right on to method",
    "start": "175890",
    "end": "184890"
  },
  {
    "text": "1 now today there's a lot of sand boxes so for all of us security researchers we",
    "start": "184890",
    "end": "192060"
  },
  {
    "text": "just on a daily basis end up with huge lists of c2 URLs right command and",
    "start": "192060",
    "end": "199620"
  },
  {
    "text": "control URLs that are generated by these CN boxes so now we have just lots and",
    "start": "199620",
    "end": "205320"
  },
  {
    "text": "lots of URLs that are being accessed by",
    "start": "205320",
    "end": "212990"
  },
  {
    "text": "malware that's captured in our sand boxes and from these URLs our",
    "start": "212990",
    "end": "219830"
  },
  {
    "text": "investigation starts method 1 analytics",
    "start": "219830",
    "end": "225000"
  },
  {
    "text": "beacons some of these Uros command control URLs or c2 URLs that you have on",
    "start": "225000",
    "end": "232530"
  },
  {
    "text": "you in your hands will be analytics beacons that these malware so when our",
    "start": "232530",
    "end": "238860"
  },
  {
    "text": "calls home they will be linking to their command and control panel or command and",
    "start": "238860",
    "end": "244950"
  },
  {
    "text": "control server to upload stolen data and also to retrieve further commands to",
    "start": "244950",
    "end": "251790"
  },
  {
    "text": "execute on the infected endpoint at the same time sometimes there will also push",
    "start": "251790",
    "end": "258810"
  },
  {
    "text": "out a beacon to a public analytic service because these actors do not want",
    "start": "258810",
    "end": "264510"
  },
  {
    "text": "to maintain and run their own analytics so they're using something like Google",
    "start": "264510",
    "end": "269580"
  },
  {
    "text": "Analytics to just keep track and analyze all their victims and so through our",
    "start": "269580",
    "end": "277910"
  },
  {
    "text": "captured URLs in our sandbox for example we found on the nerd Jack's",
    "start": "277910",
    "end": "285270"
  },
  {
    "text": "analytics page which was open to the public muhr jack is a superfish variant that",
    "start": "285270",
    "end": "292260"
  },
  {
    "text": "was shipped in some models of some",
    "start": "292260",
    "end": "297840"
  },
  {
    "text": "vendors no books in the past and became well-known right all right so and from",
    "start": "297840",
    "end": "302850"
  },
  {
    "text": "the from the analytics page which is openly available",
    "start": "302850",
    "end": "308930"
  },
  {
    "text": "we learned that hey they're actually",
    "start": "308930",
    "end": "315210"
  },
  {
    "text": "targeting mostly Brazil not if everything else and we started our Intel",
    "start": "315210",
    "end": "320550"
  },
  {
    "text": "collection from that perspective okay so beacon oolitic method to open",
    "start": "320550",
    "end": "327690"
  },
  {
    "text": "directories once you have all of those URLs you can write a script to start to",
    "start": "327690",
    "end": "333810"
  },
  {
    "text": "probe for open directories and there are lots and lots of them we'll give an example that we found with",
    "start": "333810",
    "end": "340680"
  },
  {
    "text": "the crypto wall actors from their open directories that we discovered you can",
    "start": "340680",
    "end": "348450"
  },
  {
    "text": "we can see all right so you can get",
    "start": "348450",
    "end": "359250"
  },
  {
    "text": "their malware you also can have a look that sendmail de AR AR is their tool",
    "start": "359250",
    "end": "367440"
  },
  {
    "text": "that they use to send out their spam right so you can get your hands on the tool just by finding their open",
    "start": "367440",
    "end": "375840"
  },
  {
    "text": "directories and and on your right side we have the outlook email harvester",
    "start": "375840",
    "end": "382280"
  },
  {
    "text": "directory where their email harvester is harvesting all these victim emails from",
    "start": "382280",
    "end": "388800"
  },
  {
    "text": "the infected endpoints and then there's they're uploading it to their server but",
    "start": "388800",
    "end": "395490"
  },
  {
    "text": "that directory is open so we can see that for example what we learn from here",
    "start": "395490",
    "end": "400870"
  },
  {
    "text": "it's alright so there they're absolutely grouping their campaigns according to",
    "start": "400870",
    "end": "406180"
  },
  {
    "text": "location and when these malware upload are the extracted emails back to their",
    "start": "406180",
    "end": "412870"
  },
  {
    "text": "command-and-control on its stored in different folders such as Canada France",
    "start": "412870",
    "end": "419080"
  },
  {
    "text": "Spain United Kingdom United States right so so just from that we know we",
    "start": "419080",
    "end": "424419"
  },
  {
    "text": "understand which regions that they have been targeting at the time of this",
    "start": "424419",
    "end": "430090"
  },
  {
    "text": "discovery and we were another example is",
    "start": "430090",
    "end": "435700"
  },
  {
    "text": "with dried X 120 and they're targeting the UK we had an open directory of all",
    "start": "435700",
    "end": "443110"
  },
  {
    "text": "their files and their tools and at the same time you can see that in this",
    "start": "443110",
    "end": "453669"
  },
  {
    "text": "directory they have a list of all of the emails that they were targeting in UK",
    "start": "453669",
    "end": "462060"
  },
  {
    "text": "all right magnifier is not being very",
    "start": "470320",
    "end": "477190"
  },
  {
    "text": "friendly to me",
    "start": "477190",
    "end": "479970"
  },
  {
    "text": "[Music]",
    "start": "486130",
    "end": "489269"
  },
  {
    "text": "okay sorry about that",
    "start": "495610",
    "end": "499060"
  },
  {
    "text": "all right so open directories apply to the dried X 120 actor method three",
    "start": "501599",
    "end": "509490"
  },
  {
    "text": "fuzzing common file names so now you get a sense of what you can do with these",
    "start": "509490",
    "end": "515518"
  },
  {
    "text": "URLs right you can run a fuzzer and start to just fuzz these URLs again",
    "start": "515519",
    "end": "521310"
  },
  {
    "text": "very commonly found names and again we're successful with the Nerds nerd",
    "start": "521310",
    "end": "526620"
  },
  {
    "text": "Jack's group we found a stat PHP which was openly accessible no credentials",
    "start": "526620",
    "end": "533490"
  },
  {
    "text": "required and it was it's a part of the control panel it was listing now their infection statistics so we can see that",
    "start": "533490",
    "end": "541430"
  },
  {
    "text": "for example they had total 6 6 million distributions their last their active",
    "start": "541430",
    "end": "549720"
  },
  {
    "text": "infection in the past 15 days was about twenty thirty eight thousand okay and",
    "start": "549720",
    "end": "555779"
  },
  {
    "text": "this was this was done through our fuzzer another successful example",
    "start": "555779",
    "end": "563690"
  },
  {
    "text": "against the UM downloader actor which was targeting Brazil at that",
    "start": "563690",
    "end": "569910"
  },
  {
    "text": "time we were able to find their yeah",
    "start": "569910",
    "end": "577050"
  },
  {
    "text": "point dot PHP which is their their",
    "start": "577050",
    "end": "582899"
  },
  {
    "text": "command-and-control URL and we know we didn't know that they called it that but we just bust it out and then we were",
    "start": "582899",
    "end": "590550"
  },
  {
    "text": "able to access their command-and-control so usually when these actors build their",
    "start": "590550",
    "end": "597209"
  },
  {
    "text": "botnets they'll have a command and control server where all of their botnets are",
    "start": "597209",
    "end": "603300"
  },
  {
    "text": "connecting back to sending oldest Oland data back to and that server usually has a command and control panel um so one of",
    "start": "603300",
    "end": "612480"
  },
  {
    "text": "our main targets is getting access to this command and control panel that's one big target of ours when you're using",
    "start": "612480",
    "end": "620430"
  },
  {
    "text": "these techniques the other target that we want to get is many of these actors",
    "start": "620430",
    "end": "626519"
  },
  {
    "text": "love to use what we call web shelves alongside their own control panels to",
    "start": "626519",
    "end": "633180"
  },
  {
    "text": "manage the servers and what we mean by web shows are stuff like wso shelves are",
    "start": "633180",
    "end": "639809"
  },
  {
    "text": "back doors that provide as much feature as a shared hosting cPanel modify files",
    "start": "639809",
    "end": "649079"
  },
  {
    "text": "delete files upload download files execute system commands things like that",
    "start": "649079",
    "end": "655149"
  },
  {
    "text": "and because writing their their own panel takes some quite some effort so",
    "start": "655149",
    "end": "662230"
  },
  {
    "text": "they would always not always a lot of them leave some hidden shell public",
    "start": "662230",
    "end": "668579"
  },
  {
    "text": "publicly available hidden shell somewhere for them just to easily be",
    "start": "668579",
    "end": "675610"
  },
  {
    "text": "able to manage their servers and so these would be you know are two targets",
    "start": "675610",
    "end": "680619"
  },
  {
    "text": "and this one we're showing that we're successful against the UNK downloader group and we found their command and",
    "start": "680619",
    "end": "685749"
  },
  {
    "text": "control are on panel which did not require authentication so once we hit",
    "start": "685749",
    "end": "692079"
  },
  {
    "text": "that URL with directly able to access their command and control and get all of their statistics and this we have",
    "start": "692079",
    "end": "701649"
  },
  {
    "text": "success also with the low key stealer previously known as pony and this is not",
    "start": "701649",
    "end": "710230"
  },
  {
    "text": "their command and control but this is a web shell that is that they hit",
    "start": "710230",
    "end": "715660"
  },
  {
    "text": "somewhere in their command and control server that we found so we've given you examples of fuzzing URLs to get access",
    "start": "715660",
    "end": "723610"
  },
  {
    "text": "to command and control panels as well as web shows metaphor alright so now we've",
    "start": "723610",
    "end": "731439"
  },
  {
    "text": "lost all these URLs we found open directories we found come in command and control panels we found web shells um",
    "start": "731439",
    "end": "738689"
  },
  {
    "text": "but if we haven't if at this stage you haven't identified where the command and",
    "start": "738689",
    "end": "745360"
  },
  {
    "text": "control our panel is what that exact URL is if you still couldn't figure out then",
    "start": "745360",
    "end": "752619"
  },
  {
    "text": "you would have to start to understand the file structure right so you're not we're not that lucky",
    "start": "752619",
    "end": "757629"
  },
  {
    "text": "we couldn't find where their command and control our panel URL is and we're going",
    "start": "757629",
    "end": "763540"
  },
  {
    "text": "to have to do a little bit more work we're going to have to understand their file structure",
    "start": "763540",
    "end": "768740"
  },
  {
    "text": "and one technique that we can use is Apaches server status module for example",
    "start": "768740",
    "end": "777020"
  },
  {
    "text": "the low-key password stealer group turns this module on named their Apaches and",
    "start": "777020",
    "end": "784480"
  },
  {
    "text": "so when we found their command-and-control server we were able to find a you know slash server that",
    "start": "784480",
    "end": "792380"
  },
  {
    "text": "status and we're able to list out I'm",
    "start": "792380",
    "end": "798350"
  },
  {
    "text": "going to try to use the magnifier again hopefully this time it's not gonna",
    "start": "798350",
    "end": "804880"
  },
  {
    "text": "alright okay it's a little bit small alright so anyways so what happens so",
    "start": "807370",
    "end": "814670"
  },
  {
    "text": "service status just list out all of the HTTP requests to that server right so",
    "start": "814670",
    "end": "819740"
  },
  {
    "text": "what you're going to so we're going to assume that that you know some time the",
    "start": "819740",
    "end": "825560"
  },
  {
    "text": "actor is going to log in that there is a command and control panel somewhere and some time the actor is going to access",
    "start": "825560",
    "end": "831980"
  },
  {
    "text": "that command and control panel and click on some buttons and those buttons are going to trigger HTP request back to",
    "start": "831980",
    "end": "840200"
  },
  {
    "text": "their server and those requests are going to get locked in their server status module and you can see here that",
    "start": "840200",
    "end": "849410"
  },
  {
    "text": "we locked a get request and we're able to find from their use that URL and we",
    "start": "849410",
    "end": "858380"
  },
  {
    "text": "found it's a quite new newly developed control panel its lock your password",
    "start": "858380",
    "end": "864230"
  },
  {
    "text": "stealer + lock key + and so when you click so this is one control panel and",
    "start": "864230",
    "end": "869780"
  },
  {
    "text": "when you click on that plus menu it actually takes you to another command",
    "start": "869780",
    "end": "876290"
  },
  {
    "text": "and control panel based on the neutrino bomb there are two command and control panels integrated together relatively",
    "start": "876290",
    "end": "883070"
  },
  {
    "text": "new stuff and this was discovered through server status module of Apaches",
    "start": "883070",
    "end": "891040"
  },
  {
    "text": "another example crypto wall the crypto wall actors love this module leave it on",
    "start": "891040",
    "end": "898010"
  },
  {
    "text": "allows us to just constantly monitor they're HTTP requests through that found",
    "start": "898010",
    "end": "904620"
  },
  {
    "text": "initially we found a post request that led us right to the actual URL of their",
    "start": "904620",
    "end": "912600"
  },
  {
    "text": "command-and-control and this is crystal wall PHP error messages uh we love th P",
    "start": "912600",
    "end": "921389"
  },
  {
    "text": "error messages right just somehow trigger an error in their PHP code and the code is going to dump out if they",
    "start": "921389",
    "end": "928319"
  },
  {
    "text": "turn it on it's going to dump out all of the directory information and so here in",
    "start": "928319",
    "end": "934769"
  },
  {
    "text": "this word against a trojan group that we",
    "start": "934769",
    "end": "942360"
  },
  {
    "text": "were tracking and so from there and this although it looks you know pretty simple",
    "start": "942360",
    "end": "947850"
  },
  {
    "text": "is their command and control so again from PHP Earth they turn it on we looked",
    "start": "947850",
    "end": "953579"
  },
  {
    "text": "at the URLs we figure out which one was caused by the actor is logging into",
    "start": "953579",
    "end": "959519"
  },
  {
    "text": "their control command control panel and we found their command and control panel",
    "start": "959519",
    "end": "964639"
  },
  {
    "text": "not everybody use Python some actors like to use PHP some actors do use",
    "start": "964639",
    "end": "970620"
  },
  {
    "text": "Python right and so if you kind of realize that okay this actor is using Python for their command and control",
    "start": "970620",
    "end": "976649"
  },
  {
    "text": "server or you can use Django if they turn the Django debug on and and who",
    "start": "976649",
    "end": "985410"
  },
  {
    "text": "turned it on when we were researching this ass box they were one of the super",
    "start": "985410",
    "end": "991560"
  },
  {
    "text": "active spam actors a few years back turn it on allowed us to list out their URL",
    "start": "991560",
    "end": "1001160"
  },
  {
    "text": "mapping and that's a feature for the Django debug mode and from their URL",
    "start": "1001160",
    "end": "1007160"
  },
  {
    "text": "mapping we're able to map out their Python API and so remotely by calling",
    "start": "1007160",
    "end": "1012980"
  },
  {
    "text": "that API we figure it out all right so what is these guys what were these guys",
    "start": "1012980",
    "end": "1018800"
  },
  {
    "text": "doing they ran their marketplace their own underground marketplace to buy in",
    "start": "1018800",
    "end": "1024558"
  },
  {
    "text": "mass volume our shared hosting cPanel and mint username and password and also",
    "start": "1024559",
    "end": "1031010"
  },
  {
    "text": "WordPress and then username and passwords it was all traded on there",
    "start": "1031010",
    "end": "1036020"
  },
  {
    "text": "marketplace they paid quite some money on it and because we were able to call",
    "start": "1036020",
    "end": "1041600"
  },
  {
    "text": "their Python API we're able to see for example to your right we receive every all of the password files that was being",
    "start": "1041600",
    "end": "1050240"
  },
  {
    "text": "traded on that platform so eventually we figured out that they and after they get",
    "start": "1050240",
    "end": "1058940"
  },
  {
    "text": "these they buy these on cPanel admin user names or WordPress user names they",
    "start": "1058940",
    "end": "1064850"
  },
  {
    "text": "try to get into the websites and inject AWS Oh web show and we found that the",
    "start": "1064850",
    "end": "1071210"
  },
  {
    "text": "number of WS OS that they owned by unique domain name with more than 3 million by unique file name almost 8",
    "start": "1071210",
    "end": "1078620"
  },
  {
    "text": "million SMTP accounts almost 2 million right so they own a lot of assets and by",
    "start": "1078620",
    "end": "1084800"
  },
  {
    "text": "the way guys what people think the this group is dead they're not spreading malware anymore but they're not it",
    "start": "1084800",
    "end": "1091460"
  },
  {
    "text": "they're they're doing porn fraud since beginning of last year I bet you nobody knew that so once we get familiar with",
    "start": "1091460",
    "end": "1101720"
  },
  {
    "text": "their file structure and able to reverse out their infrastructure we can then",
    "start": "1101720",
    "end": "1108350"
  },
  {
    "text": "almost forever track these actors and act before they actually launch a new",
    "start": "1108350",
    "end": "1117050"
  },
  {
    "text": "campaign or a new type of attack ok progress now we know the c2 style",
    "start": "1117050",
    "end": "1124010"
  },
  {
    "text": "structure and perhaps already found some command and control and as you saw in",
    "start": "1124010",
    "end": "1130820"
  },
  {
    "text": "some previous screenshots some command and controller I we found it it's there but it needs authentication right if we",
    "start": "1130820",
    "end": "1137830"
  },
  {
    "text": "so how do we get ourselves authenticated into that command and control panel one",
    "start": "1137830",
    "end": "1146300"
  },
  {
    "text": "one technique that we can look for is insufficient authentication and for us",
    "start": "1146300",
    "end": "1153140"
  },
  {
    "text": "they worked against the hence etre downloader actor and what they did was",
    "start": "1153140",
    "end": "1158600"
  },
  {
    "text": "whenever they're not happy whenever they're not happy with your password and happy with your IP they'll not",
    "start": "1158600",
    "end": "1165440"
  },
  {
    "text": "authenticate you right they'll log you out or they won't let you login but on their coat was written so poorly",
    "start": "1165440",
    "end": "1172249"
  },
  {
    "text": "that all they did was change the HTTP status to a 302 redirect but all of the",
    "start": "1172249",
    "end": "1180079"
  },
  {
    "text": "content is there so on by using Burt proxy and just change that HTTP our 302",
    "start": "1180079",
    "end": "1188599"
  },
  {
    "text": "code to a 200 we surely enough had access to their command and control okay",
    "start": "1188599",
    "end": "1196940"
  },
  {
    "text": "and you know you would wonder if a lot",
    "start": "1196940",
    "end": "1203179"
  },
  {
    "text": "of a lot of actors or so poor at their code well we have at least another",
    "start": "1203179",
    "end": "1208879"
  },
  {
    "text": "example where we succeeded using this technique the Android marcher malware actor arm and we were able to get access",
    "start": "1208879",
    "end": "1216889"
  },
  {
    "text": "to the command and control this way by changing the HTTP return code and we found out that this actor they were they",
    "start": "1216889",
    "end": "1224929"
  },
  {
    "text": "were spreading android banking Trojans and fishing for banking online banking",
    "start": "1224929",
    "end": "1232639"
  },
  {
    "text": "passwords and also stealing banking SMS from Android phones okay",
    "start": "1232639",
    "end": "1240019"
  },
  {
    "text": "so let's assume that through some techniques we have authenticated ourselves into a command and control",
    "start": "1240019",
    "end": "1246469"
  },
  {
    "text": "panel so we've identified the c2 URL and we've authenticated ourselves can we",
    "start": "1246469",
    "end": "1252889"
  },
  {
    "text": "expand laterally is there a need to expand laterally there certainly is a",
    "start": "1252889",
    "end": "1259820"
  },
  {
    "text": "need because we found out that some actors love to host many many many",
    "start": "1259820",
    "end": "1266539"
  },
  {
    "text": "control panel command and control panels on the same server and key base for",
    "start": "1266539",
    "end": "1273079"
  },
  {
    "text": "example they're mostly operated by a Nigerians this actor loves to run",
    "start": "1273079",
    "end": "1279169"
  },
  {
    "text": "multiple C to command and C to control panels on a single server and and so we",
    "start": "1279169",
    "end": "1290119"
  },
  {
    "text": "can use a technique called session fixation they had this vulnerability so what happens is when you're logging into",
    "start": "1290119",
    "end": "1295700"
  },
  {
    "text": "any one of their panels they set a section variable called locked-in",
    "start": "1295700",
    "end": "1303010"
  },
  {
    "text": "- true so once you're locked into one of their panels actually you're just automatically locked into all of their",
    "start": "1303010",
    "end": "1309990"
  },
  {
    "text": "panels this vulnerability is called session fixation and it's worked for us",
    "start": "1309990",
    "end": "1315790"
  },
  {
    "text": "against the key based actor and we hear about it on and this is how their",
    "start": "1315790",
    "end": "1321280"
  },
  {
    "text": "command and control panel looks like their admin panel and there are many",
    "start": "1321280",
    "end": "1327100"
  },
  {
    "text": "many of this panel on their server that we just laterally expand it to and um",
    "start": "1327100",
    "end": "1337590"
  },
  {
    "text": "now when we get access to their control",
    "start": "1337590",
    "end": "1343090"
  },
  {
    "text": "panels it's it's a lot of interesting things that we see for example we were wondering you know what what these guys",
    "start": "1343090",
    "end": "1349510"
  },
  {
    "text": "were up to and because they somehow install their own bots on their own on",
    "start": "1349510",
    "end": "1355299"
  },
  {
    "text": "their own system and the box taking screenshots and sending it to the server and we just click and seal the",
    "start": "1355299",
    "end": "1361419"
  },
  {
    "text": "screenshot we're able to follow what they were doing uh you know every day and so we're looking at your screenshots",
    "start": "1361419",
    "end": "1368530"
  },
  {
    "text": "realized that okay this is targeted business email compromised this actor this is what they focused on VEC is when",
    "start": "1368530",
    "end": "1375370"
  },
  {
    "text": "you target a business you are and you hack the emails of both a buyer and a",
    "start": "1375370",
    "end": "1384220"
  },
  {
    "text": "seller and you just monitoring commit you know you spend the time you have humans are you monitoring their",
    "start": "1384220",
    "end": "1390160"
  },
  {
    "text": "exchanges and right when payments about to happen you see somebody send an",
    "start": "1390160",
    "end": "1395410"
  },
  {
    "text": "invoice let's say I'm the seller I sent an invoice to a buyer and both of our",
    "start": "1395410",
    "end": "1401890"
  },
  {
    "text": "emails are being monitored by these guys and they're using chat to just you know you can see all their exchanges on chat",
    "start": "1401890",
    "end": "1409350"
  },
  {
    "text": "the the buyer receives the invoice they'll very quickly get that invoice",
    "start": "1409350",
    "end": "1415120"
  },
  {
    "text": "modify it then the second email you know",
    "start": "1415120",
    "end": "1421169"
  },
  {
    "text": "seemingly to be from the seller and say oh sorry we're changing our wiring",
    "start": "1421169",
    "end": "1428230"
  },
  {
    "text": "instructions right please because of this reason that please wire to this",
    "start": "1428230",
    "end": "1433419"
  },
  {
    "text": "bank account instead not that easy to detect because they're",
    "start": "1433419",
    "end": "1441339"
  },
  {
    "text": "not they're not for any malware they're not spending exploits and it's highly manual right just another email coming",
    "start": "1441339",
    "end": "1447609"
  },
  {
    "text": "in um and so we're able to see like this child you can't see it but it's saying hey and they just send an invoice right",
    "start": "1447609",
    "end": "1455139"
  },
  {
    "text": "so we have four days to get this done because in four days they're going to pay um so you can see all there you know",
    "start": "1455139",
    "end": "1461589"
  },
  {
    "text": "all their communication through their command and control",
    "start": "1461589",
    "end": "1468089"
  },
  {
    "text": "how about directly gets in the password what if I want to use any of these textures gets their password right it",
    "start": "1468089",
    "end": "1474999"
  },
  {
    "text": "works it worked against the black mu k our banker actor ah you know they had a",
    "start": "1474999",
    "end": "1484049"
  },
  {
    "text": "they had a logging interface and password was root very easy type it in",
    "start": "1484049",
    "end": "1489819"
  },
  {
    "text": "you know and and by the way it's uh it's an Asian you know we stare at fees on",
    "start": "1489819",
    "end": "1496389"
  },
  {
    "text": "piano so much it's just by looking at the layout I know it's a Asian panel somehow okay so I don't know different",
    "start": "1496389",
    "end": "1503469"
  },
  {
    "text": "different different countries just have different tastes for design it just",
    "start": "1503469",
    "end": "1508779"
  },
  {
    "text": "looks very Asian okay and it worked also",
    "start": "1508779",
    "end": "1513819"
  },
  {
    "text": "for server stage actually they're well known actor and again w so she'll we got",
    "start": "1513819",
    "end": "1523449"
  },
  {
    "text": "ourselves in we had a backdoor web shell into their entire infrastructure I want",
    "start": "1523449",
    "end": "1528639"
  },
  {
    "text": "to take a guess at their a numeric password anybody one-two-three-four",
    "start": "1528639",
    "end": "1533979"
  },
  {
    "text": "close it's one all right so that's a lot of hi all right we were able to track",
    "start": "1533979",
    "end": "1541719"
  },
  {
    "text": "them for ages just like typing name one and we found out for example while they",
    "start": "1541719",
    "end": "1547389"
  },
  {
    "text": "were using these arm in the cloud online on services to help them verify this",
    "start": "1547389",
    "end": "1554139"
  },
  {
    "text": "actor is special in that they put their malware they try to put their malware in",
    "start": "1554139",
    "end": "1560679"
  },
  {
    "text": "legitimate websites and then email out you know links pointing to those malware for people to download and when most",
    "start": "1560679",
    "end": "1567789"
  },
  {
    "text": "actors do this how they put that piece of malware onto websites it's by like ass rocks in underground markets",
    "start": "1567789",
    "end": "1577990"
  },
  {
    "text": "buying off shared hosting or WordPress and then username and passwords this",
    "start": "1577990",
    "end": "1583780"
  },
  {
    "text": "group actually has the ability to hack themselves so they actually perform hacking themselves and try to compromise",
    "start": "1583780",
    "end": "1590350"
  },
  {
    "text": "the websites that they want to inject malware into that makes them special the",
    "start": "1590350",
    "end": "1596230"
  },
  {
    "text": "other thing that made them special was for example they were buying SMTP passwords and when most actors Bias MTP",
    "start": "1596230",
    "end": "1605020"
  },
  {
    "text": "passwords they have this tool this script that would validate every single",
    "start": "1605020",
    "end": "1610660"
  },
  {
    "text": "password entry right they would try to authenticate every entry against that",
    "start": "1610660",
    "end": "1615880"
  },
  {
    "text": "particular SMTP server and see if that entry is working or not what they're",
    "start": "1615880",
    "end": "1621520"
  },
  {
    "text": "doing is they paying somebody do it and they're hosting this service ah you know",
    "start": "1621520",
    "end": "1626620"
  },
  {
    "text": "a paid service to help you validate the text file that you just bought with SMTP",
    "start": "1626620",
    "end": "1634060"
  },
  {
    "text": "username and passwords and so that was new to us we didn't we we saw a lot of those tools we never saw an online",
    "start": "1634060",
    "end": "1640840"
  },
  {
    "text": "service being offered commercially to these actors and speaking of passwords",
    "start": "1640840",
    "end": "1649740"
  },
  {
    "text": "how else can we get the end in how let's say we you know we want to use these techniques to complicated try to get",
    "start": "1649740",
    "end": "1656650"
  },
  {
    "text": "passwords couldn't get through what else can we do one thing that we could look for is",
    "start": "1656650",
    "end": "1661870"
  },
  {
    "text": "hard-coded passwords or download config files and you work for us would be what",
    "start": "1661870",
    "end": "1666910"
  },
  {
    "text": "we call the IRS II bought actor there they're not very well known so nobody has given them a name yet in their",
    "start": "1666910",
    "end": "1675540"
  },
  {
    "text": "malware we reverse out that they do two things after they steal data from",
    "start": "1675540",
    "end": "1684130"
  },
  {
    "text": "compromised endpoints they they use FTP to upload data back to their FTP servers",
    "start": "1684130",
    "end": "1690280"
  },
  {
    "text": "and for the FTP username and password into two things they either hard-coded",
    "start": "1690280",
    "end": "1696730"
  },
  {
    "text": "inside their malware or they hard-code a URL inside their malware and then the",
    "start": "1696730",
    "end": "1703060"
  },
  {
    "text": "malware go and download load a file from that URL that has the FTP username and password in it right so",
    "start": "1703060",
    "end": "1710860"
  },
  {
    "text": "by reversing a PITA the malware that you have at hand a lot of times you will get",
    "start": "1710860",
    "end": "1718799"
  },
  {
    "text": "hard-coded credentials that you that you can use and so so we're able to because",
    "start": "1718799",
    "end": "1726850"
  },
  {
    "text": "we have there and and in this group we believe doesn't have a command and concede to candle they don't have the",
    "start": "1726850",
    "end": "1733330"
  },
  {
    "text": "panel they just use FTP on but we have their SFTP password so we get access to",
    "start": "1733330",
    "end": "1739270"
  },
  {
    "text": "all their files and we can see just who exactly are they targeting and are they",
    "start": "1739270",
    "end": "1744340"
  },
  {
    "text": "infecting method 11 okay so we just",
    "start": "1744340",
    "end": "1751539"
  },
  {
    "text": "talked about reversing and what goes in hand you know hand in hand with reversing is about code review right if",
    "start": "1751539",
    "end": "1760870"
  },
  {
    "text": "you're able to reverse out stuff useful stuff how about let's try a code review well ok interesting but then we have to",
    "start": "1760870",
    "end": "1768130"
  },
  {
    "text": "get their source code first to do that what we can do is for example we can do",
    "start": "1768130",
    "end": "1775120"
  },
  {
    "text": "will show you a few techniques but one thing that we can do is for example folder names right folder name dot zip",
    "start": "1775120",
    "end": "1781360"
  },
  {
    "text": "usually may contain a back you know a backup are as of that entire directory",
    "start": "1781360",
    "end": "1789419"
  },
  {
    "text": "and and also so what we did is what we",
    "start": "1789419",
    "end": "1794440"
  },
  {
    "text": "do is we have some other scripts that we that we wrote that tries to you know",
    "start": "1794440",
    "end": "1802230"
  },
  {
    "text": "fuss folder names or URLs just trying to download stuff and when you're able to",
    "start": "1802230",
    "end": "1807760"
  },
  {
    "text": "download stuff a lot of times you will hit upon source code and and the other",
    "start": "1807760",
    "end": "1814809"
  },
  {
    "text": "the other the other common way is in in previous examples we showed you that",
    "start": "1814809",
    "end": "1821260"
  },
  {
    "text": "sometimes you can get access to their web shells right and a web shell is just",
    "start": "1821260",
    "end": "1826270"
  },
  {
    "text": "a remote management interface you can download every single file so usually once you get access to a web shell what",
    "start": "1826270",
    "end": "1834400"
  },
  {
    "text": "you would be doing is downloading your source code okay and then you can start you can",
    "start": "1834400",
    "end": "1840530"
  },
  {
    "text": "carry out a code review process against your source code and one thing you can",
    "start": "1840530",
    "end": "1845570"
  },
  {
    "text": "look for is cross I scripting and this when we did an experiment now now you",
    "start": "1845570",
    "end": "1851420"
  },
  {
    "text": "asked you know does cross-site scripting really work how effective is it you know",
    "start": "1851420",
    "end": "1857180"
  },
  {
    "text": "conceptually you can alert something what can you really steal somebody's cookie and then use it to authenticate",
    "start": "1857180",
    "end": "1864380"
  },
  {
    "text": "yourself so we did was we did it against this group the ISR stealer actor",
    "start": "1864380",
    "end": "1871310"
  },
  {
    "text": "they have cross-site scripting in their code they weren't checking for they",
    "start": "1871310",
    "end": "1877370"
  },
  {
    "text": "weren't checking for their the variables that get variables that they were using they were checking for the user agent",
    "start": "1877370",
    "end": "1884180"
  },
  {
    "text": "string on so we're able to cross item and it's a persistent cross-site so what",
    "start": "1884180",
    "end": "1893150"
  },
  {
    "text": "happens is their panel allows our uploading of stuff and they store some",
    "start": "1893150",
    "end": "1900500"
  },
  {
    "text": "data into database so when their boss upload stuff right they swear that those",
    "start": "1900500",
    "end": "1905800"
  },
  {
    "text": "the uploaded data in database they check for the user agent string and the agent",
    "start": "1905800",
    "end": "1911180"
  },
  {
    "text": "string is special so they figure they're checking for that then then they be safe so that means we can uh we can cross",
    "start": "1911180",
    "end": "1920060"
  },
  {
    "text": "like them the experiment what that we did we found that this actor had a large",
    "start": "1920060",
    "end": "1928610"
  },
  {
    "text": "number of control panel instances they had 170 panels on their different assets",
    "start": "1928610",
    "end": "1936370"
  },
  {
    "text": "so we wrote a script inject the persistent cross-site to get their cookies the experiment lasted two weeks",
    "start": "1936370",
    "end": "1944210"
  },
  {
    "text": "we received 103 cookies that allowed us that allowed us to successfully",
    "start": "1944210",
    "end": "1950120"
  },
  {
    "text": "authenticate into their control panel so the success rate was 60% over the two",
    "start": "1950120",
    "end": "1956300"
  },
  {
    "text": "weeks that was pretty high and by looking at the data we saw that on sixty",
    "start": "1956300",
    "end": "1962060"
  },
  {
    "text": "to sixty six thousand victims have had their data stolen by this group they're",
    "start": "1962060",
    "end": "1968450"
  },
  {
    "text": "awesome locally in Nigeria method 13 back door when we do code",
    "start": "1968450",
    "end": "1975800"
  },
  {
    "text": "review why interesting thing that you want to look for that may not exist in",
    "start": "1975800",
    "end": "1981430"
  },
  {
    "text": "in you know code written by normal people are deliberately injected back",
    "start": "1981430",
    "end": "1990320"
  },
  {
    "text": "doors and we found an interesting one in the Zeus robot Panther God groups",
    "start": "1990320",
    "end": "1997720"
  },
  {
    "text": "somehow these groups use the same version of Zeus that they probably",
    "start": "1997720",
    "end": "2003130"
  },
  {
    "text": "bought from somebody and somebody injected a backdoor into the that",
    "start": "2003130",
    "end": "2013060"
  },
  {
    "text": "version of Zeus when it would never figure it out who but the coat was there",
    "start": "2013060",
    "end": "2018700"
  },
  {
    "text": "it was just two lines very simple PHP gets you know get a variable eval it and",
    "start": "2018700",
    "end": "2024700"
  },
  {
    "text": "so if you know where that code is you hit you you have arbitrary file access",
    "start": "2024700",
    "end": "2030790"
  },
  {
    "text": "and a command execution in their infrastructure and this lasted for a",
    "start": "2030790",
    "end": "2035950"
  },
  {
    "text": "very long time everybody tracked them for over many",
    "start": "2035950",
    "end": "2041800"
  },
  {
    "text": "years and so and so here is how that that shell worked on so we're listing",
    "start": "2041800",
    "end": "2048370"
  },
  {
    "text": "out their directory here okay so this is looking for backdoors inside actors",
    "start": "2048370",
    "end": "2054730"
  },
  {
    "text": "source code method fourteen remote command execution due to coding there",
    "start": "2054730",
    "end": "2061629"
  },
  {
    "text": "and we found that the zoo Citadel over ice eleven actor had a vulnerability",
    "start": "2061630",
    "end": "2069070"
  },
  {
    "text": "that allowed remote code execution um and you can see here that it's it's",
    "start": "2069070",
    "end": "2078159"
  },
  {
    "text": "getting it's constructing commands and it's using a variable files to construct",
    "start": "2078160",
    "end": "2086530"
  },
  {
    "text": "a command called CLI and they execute that command that file variable hasn't been sanitized",
    "start": "2086530",
    "end": "2095409"
  },
  {
    "text": "or checked before it being used to construct a command and that makes a",
    "start": "2095410",
    "end": "2101680"
  },
  {
    "text": "remote command execution and so by popping up our verb we filled",
    "start": "2101680",
    "end": "2108280"
  },
  {
    "text": "into files variable with our script",
    "start": "2108280",
    "end": "2113640"
  },
  {
    "text": "which echoed out phpinfo to a file and we loaded that file",
    "start": "2113640",
    "end": "2118660"
  },
  {
    "text": "boom works which means then we can just upload a wso shell or any web shell of",
    "start": "2118660",
    "end": "2125140"
  },
  {
    "text": "our preference onto their server and from then on we have full access to their server so that's remote command",
    "start": "2125140",
    "end": "2132430"
  },
  {
    "text": "execution inside actor Shoko a source code method 15 everybody knows about",
    "start": "2132430",
    "end": "2139660"
  },
  {
    "text": "psycho injection right there's a lot of sequel injection in their code Android off fake malware are vulnerable to",
    "start": "2139660",
    "end": "2149650"
  },
  {
    "text": "sequel injection very simple the I'm a variable was used to construct their",
    "start": "2149650",
    "end": "2155410"
  },
  {
    "text": "sequel command wasn't sanitized before being used didn't use repair parameters",
    "start": "2155410",
    "end": "2163930"
  },
  {
    "text": "for their sequel axis and and so we were able to sequence them so ones are able",
    "start": "2163930",
    "end": "2169960"
  },
  {
    "text": "to sequel and jetsam we can up we can execute system command upload files or",
    "start": "2169960",
    "end": "2175870"
  },
  {
    "text": "just rip out their database method 16 all right so at this point if some of",
    "start": "2175870",
    "end": "2183250"
  },
  {
    "text": "these techniques succeeded we probably have access to their admin control panel",
    "start": "2183250",
    "end": "2188320"
  },
  {
    "text": "we probably also have a shell in place that allows us just completely that",
    "start": "2188320",
    "end": "2195460"
  },
  {
    "text": "offers complete ownership of their servers and infrastructure but how about",
    "start": "2195460",
    "end": "2203230"
  },
  {
    "text": "just just routing the server what if we just just want absolute control of their server ok then what we can do other",
    "start": "2203230",
    "end": "2214360"
  },
  {
    "text": "techniques that we can do one is for example this group there there see two",
    "start": "2214360",
    "end": "2223960"
  },
  {
    "text": "panel is is in Java so quite quite unique and they were using HFS which was",
    "start": "2223960",
    "end": "2232000"
  },
  {
    "text": "vulnerable to remote command execution so it's this vulnerability wasn't due to their code",
    "start": "2232000",
    "end": "2237420"
  },
  {
    "text": "but they were using vulnerable software and we're able to just leverage that and",
    "start": "2237420",
    "end": "2242430"
  },
  {
    "text": "we and remotely execute commands and from there we can then upload a shell or",
    "start": "2242430",
    "end": "2249729"
  },
  {
    "text": "show shock very well-known vulnerability and you'd be surprised",
    "start": "2249729",
    "end": "2255239"
  },
  {
    "text": "Sutra TDS is one of the most well known TDS is that these actors just just love",
    "start": "2255239",
    "end": "2261849"
  },
  {
    "text": "to use right on so they're using the TDS to filter out unwanted IPs to kind of",
    "start": "2261849",
    "end": "2269410"
  },
  {
    "text": "act as a shield between their infrastructure and arm and vendor",
    "start": "2269410",
    "end": "2275410"
  },
  {
    "text": "scanners so TDS they use TDS is to only allow naive traffic to access their",
    "start": "2275410",
    "end": "2282130"
  },
  {
    "text": "malware and attempt to block all access by security vendors search engines",
    "start": "2282130",
    "end": "2288069"
  },
  {
    "text": "robots and things like that food for TDs was vulnerable to show shock so",
    "start": "2288069",
    "end": "2294700"
  },
  {
    "text": "whichever actor was using TDS we got a show right I method 18 Java on",
    "start": "2294700",
    "end": "2304900"
  },
  {
    "text": "sterilized vulnerability fake angry for example a an Android piece of malware",
    "start": "2304900",
    "end": "2312150"
  },
  {
    "text": "was vulnerable was written Java and has this vulnerability again using you know",
    "start": "2312150",
    "end": "2318369"
  },
  {
    "text": "unpatched out outdated software and we leverage that okay so now let's say some",
    "start": "2318369",
    "end": "2330910"
  },
  {
    "text": "of these techniques must have worked and we we can execute arbitrary commands so",
    "start": "2330910",
    "end": "2337269"
  },
  {
    "text": "so basically we own we own their infrastructure what you will find at this point is it's good because you're",
    "start": "2337269",
    "end": "2344319"
  },
  {
    "text": "just getting too much data and and there's so many actors so many servers to to analyze right how do you how do",
    "start": "2344319",
    "end": "2352059"
  },
  {
    "text": "you very quickly get an understanding of what this actor is doing what are they",
    "start": "2352059",
    "end": "2357519"
  },
  {
    "text": "about what type of malware they spreading if it's still active things like that",
    "start": "2357519",
    "end": "2362829"
  },
  {
    "text": "one thing that saw that works well for us is then to access their webalizer or",
    "start": "2362829",
    "end": "2369249"
  },
  {
    "text": "aw stat data the because from these web logs access logs right you would able to see all right so",
    "start": "2369249",
    "end": "2375910"
  },
  {
    "text": "you would direct you would immediately see all right so you know this particular URL is mostly accessed it is",
    "start": "2375910",
    "end": "2383559"
  },
  {
    "text": "most frequently accessed so it's probably ah their heartbeat their",
    "start": "2383559",
    "end": "2390339"
  },
  {
    "text": "command-and-control heartbeat from their bondage to this command and control panel um and it will tell you a lot of",
    "start": "2390339",
    "end": "2397630"
  },
  {
    "text": "things and sometimes they host malware to be downloaded directly on this command and control server and so if a",
    "start": "2397630",
    "end": "2405250"
  },
  {
    "text": "lot of malware gets down you know gets downloaded from that single URL it's",
    "start": "2405250",
    "end": "2410769"
  },
  {
    "text": "going to be a very frequently accessed URL and it will also show up in these web analytics so what we would do is we",
    "start": "2410769",
    "end": "2418779"
  },
  {
    "text": "would take their lock you know if they have the turn-on will just pop up the report have a look or if we can access",
    "start": "2418779",
    "end": "2425380"
  },
  {
    "text": "get access to their web server locks will pump it through and a traffic",
    "start": "2425380",
    "end": "2432490"
  },
  {
    "text": "analyzer and get a report ok method 20",
    "start": "2432490",
    "end": "2437549"
  },
  {
    "text": "some were some more complicated or complex techniques path traversal matric",
    "start": "2437549",
    "end": "2445299"
  },
  {
    "text": "pause this is a a malware that targets",
    "start": "2445299",
    "end": "2450480"
  },
  {
    "text": "point-of-sale systems and what they did was they were well their coat was",
    "start": "2450480",
    "end": "2457480"
  },
  {
    "text": "vulnerable to arbitrary file upload or patch reversal and so we're able to",
    "start": "2457480",
    "end": "2464609"
  },
  {
    "text": "upload a shell and also get access to",
    "start": "2464609",
    "end": "2469990"
  },
  {
    "text": "their command and control panel now let's talk about file upload",
    "start": "2469990",
    "end": "2475630"
  },
  {
    "text": "vulnerabilities there are three types of file upload vulnerabilities that you can look for usually in these in these",
    "start": "2475630",
    "end": "2482140"
  },
  {
    "text": "actors infrastructure we were successful with the for example Jha who spambot",
    "start": "2482140",
    "end": "2488380"
  },
  {
    "text": "they had an unrestricted file upload vulnerability this was their panel this is how their",
    "start": "2488380",
    "end": "2494349"
  },
  {
    "text": "panel looks like and you can it allowed the actor to upload newer versions of",
    "start": "2494349",
    "end": "2501250"
  },
  {
    "text": "their malware binary on to this server for download it has if you look at the code",
    "start": "2501250",
    "end": "2507789"
  },
  {
    "text": "on its unrestricted so they're not checking for the file extension they're",
    "start": "2507789",
    "end": "2513339"
  },
  {
    "text": "not checking for anything right so what you do immediately when you see that is upload a web shell and you're in another",
    "start": "2513339",
    "end": "2521849"
  },
  {
    "text": "example to neutrino HTTP bot this group this is their control panel and um they",
    "start": "2521849",
    "end": "2535059"
  },
  {
    "text": "had arbitrary ah-ah you see okay this is",
    "start": "2535059",
    "end": "2542170"
  },
  {
    "text": "restricted all right skip okay so let's",
    "start": "2542170",
    "end": "2549849"
  },
  {
    "text": "talk about the god ox pot okay oh let's uh let's do it okay okay it's going to",
    "start": "2549849",
    "end": "2558519"
  },
  {
    "text": "take some time but made a video for you",
    "start": "2558519",
    "end": "2563549"
  },
  {
    "text": "okay so let's have a look okay so we're",
    "start": "2563549",
    "end": "2568930"
  },
  {
    "text": "looking at their piano code right now for their file upload feature and we can",
    "start": "2568930",
    "end": "2579640"
  },
  {
    "text": "see all right so it's checking for user agent string and it's checking for your IP right so it does have checks when you",
    "start": "2579640",
    "end": "2587529"
  },
  {
    "text": "try to upload files on to this panel through this panel it's going to check whether your user agent stream fulfills",
    "start": "2587529",
    "end": "2595209"
  },
  {
    "text": "their criteria uh it's also going to check for your IP and you can also you",
    "start": "2595209",
    "end": "2601180"
  },
  {
    "text": "can only do multi-part right so content type they're sensitive about content type so they have quite a few checks in",
    "start": "2601180",
    "end": "2609400"
  },
  {
    "text": "place as we can see here and the user agent we can see the user agent strings",
    "start": "2609400",
    "end": "2614799"
  },
  {
    "text": "that they like so when we implement our exploit we would be using that",
    "start": "2614799",
    "end": "2620019"
  },
  {
    "text": "particular user agent string um and of course if they don't if at any time you",
    "start": "2620019",
    "end": "2626199"
  },
  {
    "text": "fail their checks they're going to log your IP into their database and then they'll forever be and you see all of",
    "start": "2626199",
    "end": "2633400"
  },
  {
    "text": "that in their code and so when we built the exploit we would be routing to anonymize IP so that it's",
    "start": "2633400",
    "end": "2642280"
  },
  {
    "text": "okay if we fail for a few times in the day in our IPs so you can see here that",
    "start": "2642280",
    "end": "2649600"
  },
  {
    "text": "okay they also care about HTTP referer the buffer cannot be new but they don't",
    "start": "2649600",
    "end": "2654760"
  },
  {
    "text": "need a particular referee so as long as there is a referee they're happy okay",
    "start": "2654760",
    "end": "2664000"
  },
  {
    "text": "so whenever I'm there whenever they're not happy they'll just give you a page",
    "start": "2664000",
    "end": "2670330"
  },
  {
    "text": "not found there right as we can see here okay so 404 not found so this actor",
    "start": "2670330",
    "end": "2678190"
  },
  {
    "text": "they're implementing a lot of checks are they allow file upload so now how do we",
    "start": "2678190",
    "end": "2687490"
  },
  {
    "text": "here it's the file upload function and",
    "start": "2687490",
    "end": "2694170"
  },
  {
    "text": "how do we get past all of these checks",
    "start": "2695670",
    "end": "2701410"
  },
  {
    "text": "okay now and be able to manipulate the the see and and be able to manipulate",
    "start": "2701410",
    "end": "2711460"
  },
  {
    "text": "something right so what we want to manipulate is the file name in most of these cases we can get back get past all",
    "start": "2711460",
    "end": "2719260"
  },
  {
    "text": "of their checks we can set the right age three we can have the right IP in place we can we can set everything up but",
    "start": "2719260",
    "end": "2725910"
  },
  {
    "text": "they're going to be checking for the file name and we found out that okay that you could what you can see here is",
    "start": "2725910",
    "end": "2732880"
  },
  {
    "text": "they're not checking the file name so we want to we want to upload something that's thought PHP into somewhere that's",
    "start": "2732880",
    "end": "2740620"
  },
  {
    "text": "publicly accessible then we can upload a web show and go access that URL and then",
    "start": "2740620",
    "end": "2746800"
  },
  {
    "text": "we're in so for this one we're reviewing the code you can see here they're not",
    "start": "2746800",
    "end": "2751990"
  },
  {
    "text": "checking for extension which is good news but then for the upload directory",
    "start": "2751990",
    "end": "2758680"
  },
  {
    "text": "they disabled on PHP so we're able to upload a shoulder PHP for example into",
    "start": "2758680",
    "end": "2765640"
  },
  {
    "text": "that directory no problem we can tell that from the code but it won't execute so we're going to have to",
    "start": "2765640",
    "end": "2771650"
  },
  {
    "text": "get around that and upload to another directory that has PHP enabled so we're",
    "start": "2771650",
    "end": "2777290"
  },
  {
    "text": "going to want to use dot dot at the parent directory right on so how do we",
    "start": "2777290",
    "end": "2782930"
  },
  {
    "text": "do that so you can see they turned on",
    "start": "2782930",
    "end": "2789050"
  },
  {
    "text": "the PHP flag off for the upload",
    "start": "2789050",
    "end": "2794330"
  },
  {
    "text": "directory and it turns out that if you",
    "start": "2794330",
    "end": "2800180"
  },
  {
    "text": "look at the code here on their appending the IP address of the uploader at the",
    "start": "2800180",
    "end": "2806930"
  },
  {
    "text": "front of the file name so the file name will look like IP address plus specified",
    "start": "2806930",
    "end": "2812000"
  },
  {
    "text": "file name and the IP address is not detected they're getting the IP address from a cookie and they're not checking",
    "start": "2812000",
    "end": "2818720"
  },
  {
    "text": "that cookie okay so done right this step",
    "start": "2818720",
    "end": "2824240"
  },
  {
    "text": "all right good news we can get in we're going to do is set set our cookie that",
    "start": "2824240",
    "end": "2830870"
  },
  {
    "text": "IP manipulate the file name it's going to concatenate the actual file name at",
    "start": "2830870",
    "end": "2836960"
  },
  {
    "text": "the back of that IP address right so it's IP concatenate file name so what",
    "start": "2836960",
    "end": "2842060"
  },
  {
    "text": "we're going to do is we're just going to fulfill all of the criteria and then",
    "start": "2842060",
    "end": "2847340"
  },
  {
    "text": "we're going to stop the concatenation and how we do that is with a Newell character it's it since recently been",
    "start": "2847340",
    "end": "2855260"
  },
  {
    "text": "fixed by PHP but still in still a lot of implementations as the older version and",
    "start": "2855260",
    "end": "2861560"
  },
  {
    "text": "so so you can see dot dot test right so parent directory test is we want where",
    "start": "2861560",
    "end": "2868100"
  },
  {
    "text": "we want to upload specify that stop the concatenation with a new a noble",
    "start": "2868100",
    "end": "2875030"
  },
  {
    "text": "character run it against the panel and",
    "start": "2875030",
    "end": "2884320"
  },
  {
    "text": "go access it here we go okay so if we",
    "start": "2884320",
    "end": "2890660"
  },
  {
    "text": "can upload a PHP we can love to upload any PHP and basically then we have",
    "start": "2890660",
    "end": "2897500"
  },
  {
    "text": "ownership okay so this is method 22 satisfy prerequisites",
    "start": "2897500",
    "end": "2904360"
  },
  {
    "text": "we're making good progress okay see to communications a lot of times they don't",
    "start": "2904360",
    "end": "2909890"
  },
  {
    "text": "check but they don't check for anything but they have a shared key ah for their",
    "start": "2909890",
    "end": "2917000"
  },
  {
    "text": "communication so which means you don't know the share key you can't talk to",
    "start": "2917000",
    "end": "2922160"
  },
  {
    "text": "that particular upload mechanism so what we want to do in this case very simply",
    "start": "2922160",
    "end": "2927830"
  },
  {
    "text": "reverse the malware get our hands on the on the hard coded key or if we're able",
    "start": "2927830",
    "end": "2937130"
  },
  {
    "text": "to get if we can able to somehow get their source code we can see the shared",
    "start": "2937130",
    "end": "2943280"
  },
  {
    "text": "key in this case we didn't have their source code reversed out on their",
    "start": "2943280",
    "end": "2948760"
  },
  {
    "text": "malware got the shared key uploaded a shell went back using that shell",
    "start": "2948760",
    "end": "2955120"
  },
  {
    "text": "retrieved the their source code and verify there it was it was exactly the",
    "start": "2955120",
    "end": "2961880"
  },
  {
    "text": "key that we used and we use this against the garlic spot group it's a zero-day by the way hasn't been",
    "start": "2961880",
    "end": "2968570"
  },
  {
    "text": "talked about yet okay finally um so so",
    "start": "2968570",
    "end": "2978590"
  },
  {
    "text": "we you know um we shared a lot of techniques to get ourselves access to",
    "start": "2978590",
    "end": "2986450"
  },
  {
    "text": "the actor infrastructure and once we have we found their backdoor that they",
    "start": "2986450",
    "end": "2992870"
  },
  {
    "text": "don't know about that's somebody injected into them for example for the for the root juice robot group or we've",
    "start": "2992870",
    "end": "3001660"
  },
  {
    "text": "injected a web shell into the infrastructure we can then track this actor for a very long time",
    "start": "3001660",
    "end": "3006880"
  },
  {
    "text": "so lastly while performing all these operations against their c2 server we",
    "start": "3006880",
    "end": "3012730"
  },
  {
    "text": "have to understand that most of them place reverse proxies in front of their c2 servers in jinks reverse proxies",
    "start": "3012730",
    "end": "3020830"
  },
  {
    "text": "right so although we're playing with this server blah blah blah sometimes for correlation for attribution purposes we",
    "start": "3020830",
    "end": "3028000"
  },
  {
    "text": "want to know what the what's a real domain and IP of that particular c2",
    "start": "3028000",
    "end": "3033790"
  },
  {
    "text": "server and so how can we do that very quickly one one thing that was successful for us",
    "start": "3033790",
    "end": "3040880"
  },
  {
    "text": "was the set cookie HTTP response header",
    "start": "3040880",
    "end": "3046910"
  },
  {
    "text": "right so in the cookies if they're sending any cookies then from that age that the set cookie HTTP response header",
    "start": "3046910",
    "end": "3053650"
  },
  {
    "text": "you would be able to know the actual C two servers domain name and it worked",
    "start": "3053650",
    "end": "3059480"
  },
  {
    "text": "very well for us for example for northern goat and this information allowed us to you know get to to locate",
    "start": "3059480",
    "end": "3071600"
  },
  {
    "text": "north northern goats infrastructure and to eventually own their infrastructure and publish a lot of studies on this",
    "start": "3071600",
    "end": "3079160"
  },
  {
    "text": "group how about their IP address what worked for us for the Droid X 120 group",
    "start": "3079160",
    "end": "3085670"
  },
  {
    "text": "was phpinfo okay a lot of them have some type of pH",
    "start": "3085670",
    "end": "3090980"
  },
  {
    "text": "info somewhere forget it their ID is there okay conclusion we have showed you",
    "start": "3090980",
    "end": "3099170"
  },
  {
    "text": "25 proven threat Intel gathering techniques that would allow us to",
    "start": "3099170",
    "end": "3104450"
  },
  {
    "text": "understand who's behind the campaign who's been targeted understand infrastructure and tools and use and",
    "start": "3104450",
    "end": "3112070"
  },
  {
    "text": "this explains why in our research we're able to you know disclose all of their",
    "start": "3112070",
    "end": "3119600"
  },
  {
    "text": "tools their processes their infrastructures by using these techniques over a long period of time",
    "start": "3119600",
    "end": "3127030"
  },
  {
    "text": "cracking and doing attribution attribution to the actors obtain",
    "start": "3127030",
    "end": "3133220"
  },
  {
    "text": "unreleased malware which ups our detection efficacy and understand actor",
    "start": "3133220",
    "end": "3139760"
  },
  {
    "text": "operations and strategies for example we showed you screenshots right of you know",
    "start": "3139760",
    "end": "3145250"
  },
  {
    "text": "that these actors the BC actors doing their daily business most c2 panels",
    "start": "3145250",
    "end": "3152480"
  },
  {
    "text": "contain vulnerabilities so if you are familiar with these techniques and you",
    "start": "3152480",
    "end": "3158510"
  },
  {
    "text": "spend time you're going to get a lot of Intel that ends our talk thank you very",
    "start": "3158510",
    "end": "3164210"
  },
  {
    "text": "much for coming yeah thank you",
    "start": "3164210",
    "end": "3170120"
  }
]