[
  {
    "text": "last talk of the day is detecting",
    "start": "0",
    "end": "3720"
  },
  {
    "text": "malicious files with Yarra rules as they",
    "start": "3720",
    "end": "6810"
  },
  {
    "text": "traverse the network by David Byrne ah",
    "start": "6810",
    "end": "8750"
  },
  {
    "text": "thank you",
    "start": "8750",
    "end": "11780"
  },
  {
    "text": "hi thank you very much thank you welcome",
    "start": "13309",
    "end": "20189"
  },
  {
    "text": "to my talk so asked you mentioned this",
    "start": "20189",
    "end": "25350"
  },
  {
    "text": "talk will be about how to detect",
    "start": "25350",
    "end": "27480"
  },
  {
    "text": "malicious files with general rules as",
    "start": "27480",
    "end": "29460"
  },
  {
    "text": "they are traversing the network so a",
    "start": "29460",
    "end": "33180"
  },
  {
    "text": "little bit about myself",
    "start": "33180",
    "end": "34710"
  },
  {
    "text": "I'm a little security researcher of C",
    "start": "34710",
    "end": "37980"
  },
  {
    "text": "labs I have around 10 years of",
    "start": "37980",
    "end": "40800"
  },
  {
    "text": "experience in digital forensics and",
    "start": "40800",
    "end": "42809"
  },
  {
    "text": "Incident Response I have 9 VX",
    "start": "42809",
    "end": "45270"
  },
  {
    "text": "certifications and I'm a sense mentor in",
    "start": "45270",
    "end": "48030"
  },
  {
    "text": "Latin America in addition to hunting for",
    "start": "48030",
    "end": "51809"
  },
  {
    "text": "threats I really like to hunt for free",
    "start": "51809",
    "end": "54989"
  },
  {
    "text": "public pianos that is one of my hobbies",
    "start": "54989",
    "end": "57050"
  },
  {
    "text": "and I really love it so as you can see",
    "start": "57050",
    "end": "59940"
  },
  {
    "text": "that's me on a public piano in Paris and",
    "start": "59940",
    "end": "63960"
  },
  {
    "text": "I think that there should be more public",
    "start": "63960",
    "end": "66510"
  },
  {
    "text": "pianos in Las Vegas so back to hunting",
    "start": "66510",
    "end": "70110"
  },
  {
    "text": "for threads",
    "start": "70110",
    "end": "70790"
  },
  {
    "text": "why are you Cure I want to help blue",
    "start": "70790",
    "end": "73860"
  },
  {
    "text": "teamers detect malicious files using",
    "start": "73860",
    "end": "77850"
  },
  {
    "text": "yellow rules and the seek framework and",
    "start": "77850",
    "end": "80939"
  },
  {
    "text": "the good thing about it is that they are",
    "start": "80939",
    "end": "84950"
  },
  {
    "text": "open source projects so I also create it",
    "start": "84950",
    "end": "88920"
  },
  {
    "text": "like a custom script a custom Python",
    "start": "88920",
    "end": "90780"
  },
  {
    "text": "script that will be also available to",
    "start": "90780",
    "end": "94470"
  },
  {
    "text": "you so that you can enable this",
    "start": "94470",
    "end": "96210"
  },
  {
    "text": "capability on your networks on your",
    "start": "96210",
    "end": "99570"
  },
  {
    "text": "enterprises so what is yaara well gerrae",
    "start": "99570",
    "end": "103799"
  },
  {
    "text": "is a tool created by Victor Manuel",
    "start": "103799",
    "end": "107189"
  },
  {
    "text": "Alvarez from your Stora and it can be",
    "start": "107189",
    "end": "109799"
  },
  {
    "text": "used to identify malware families",
    "start": "109799",
    "end": "114170"
  },
  {
    "text": "malware samples and create descriptions",
    "start": "114170",
    "end": "117630"
  },
  {
    "text": "for this malware families now the other",
    "start": "117630",
    "end": "120930"
  },
  {
    "text": "component is seek and we'll explain it",
    "start": "120930",
    "end": "124710"
  },
  {
    "text": "later here's a small sample of yellow",
    "start": "124710",
    "end": "127920"
  },
  {
    "text": "rule so we have three parts the first",
    "start": "127920",
    "end": "131940"
  },
  {
    "text": "part is that make",
    "start": "131940",
    "end": "133770"
  },
  {
    "text": "the data section in which we will add",
    "start": "133770",
    "end": "136080"
  },
  {
    "text": "information about the description of the",
    "start": "136080",
    "end": "138660"
  },
  {
    "text": "rule what can it do what can it identify",
    "start": "138660",
    "end": "142010"
  },
  {
    "text": "also we can add some other information",
    "start": "142010",
    "end": "145050"
  },
  {
    "text": "such as the author and any licensing",
    "start": "145050",
    "end": "147840"
  },
  {
    "text": "restrictions that we have then the",
    "start": "147840",
    "end": "151920"
  },
  {
    "text": "second part is the string section in",
    "start": "151920",
    "end": "154440"
  },
  {
    "text": "which we can have string patterns also",
    "start": "154440",
    "end": "158820"
  },
  {
    "text": "binary patterns and regular expressions",
    "start": "158820",
    "end": "161840"
  },
  {
    "text": "based on the observations that we",
    "start": "161840",
    "end": "165120"
  },
  {
    "text": "identify on the malware that we are",
    "start": "165120",
    "end": "167250"
  },
  {
    "text": "analyzing so then we have the",
    "start": "167250",
    "end": "171540"
  },
  {
    "text": "conditional section in which we specify",
    "start": "171540",
    "end": "174120"
  },
  {
    "text": "the logical condition in which we are",
    "start": "174120",
    "end": "176760"
  },
  {
    "text": "going to use those strings those regular",
    "start": "176760",
    "end": "179130"
  },
  {
    "text": "expressions or binary patterns and we",
    "start": "179130",
    "end": "181470"
  },
  {
    "text": "can additionally specify some other",
    "start": "181470",
    "end": "183750"
  },
  {
    "text": "things such as file signatures so now",
    "start": "183750",
    "end": "188280"
  },
  {
    "text": "I'm going to show you a general rule",
    "start": "188280",
    "end": "190170"
  },
  {
    "text": "that I created that I developed that is",
    "start": "190170",
    "end": "195270"
  },
  {
    "text": "used to detect Microsoft Word documents",
    "start": "195270",
    "end": "198480"
  },
  {
    "text": "that have strings related with automatic",
    "start": "198480",
    "end": "201959"
  },
  {
    "text": "execution and that are very used in",
    "start": "201959",
    "end": "205950"
  },
  {
    "text": "phishing attacks",
    "start": "205950",
    "end": "207050"
  },
  {
    "text": "so here you can see that I specified",
    "start": "207050",
    "end": "209900"
  },
  {
    "text": "license and I added the description the",
    "start": "209900",
    "end": "213420"
  },
  {
    "text": "author name and then we have four",
    "start": "213420",
    "end": "216360"
  },
  {
    "text": "strings so the very first two strings",
    "start": "216360",
    "end": "219030"
  },
  {
    "text": "are related with automatic execution",
    "start": "219030",
    "end": "222630"
  },
  {
    "text": "they are functions within the VBA code",
    "start": "222630",
    "end": "226680"
  },
  {
    "text": "in the word document and basically the",
    "start": "226680",
    "end": "230670"
  },
  {
    "text": "auto open run scope whenever the",
    "start": "230670",
    "end": "234000"
  },
  {
    "text": "document is open and macros are enabled",
    "start": "234000",
    "end": "237000"
  },
  {
    "text": "and auto close runs code whenever the",
    "start": "237000",
    "end": "240150"
  },
  {
    "text": "document is closed and obviously the the",
    "start": "240150",
    "end": "243060"
  },
  {
    "text": "macro code is enabled and then the last",
    "start": "243060",
    "end": "245370"
  },
  {
    "text": "two strings are contained on documents",
    "start": "245370",
    "end": "248490"
  },
  {
    "text": "that have macro code so now let's go to",
    "start": "248490",
    "end": "251730"
  },
  {
    "text": "the final section and we can see that on",
    "start": "251730",
    "end": "254520"
  },
  {
    "text": "the very beginning I have conditions to",
    "start": "254520",
    "end": "256829"
  },
  {
    "text": "identify the file signature of those",
    "start": "256830",
    "end": "259890"
  },
  {
    "text": "files and on the second part I specify",
    "start": "259890",
    "end": "263580"
  },
  {
    "text": "the condition the logical condition in",
    "start": "263580",
    "end": "266040"
  },
  {
    "text": "which the strings are used",
    "start": "266040",
    "end": "267530"
  },
  {
    "text": "so I want to verify that all the strings",
    "start": "267530",
    "end": "270380"
  },
  {
    "text": "related to macro are enabled are",
    "start": "270380",
    "end": "273470"
  },
  {
    "text": "contained on that file and at least one",
    "start": "273470",
    "end": "277490"
  },
  {
    "text": "string that identifies automatic",
    "start": "277490",
    "end": "280580"
  },
  {
    "text": "execution so I decided to show this rule",
    "start": "280580",
    "end": "284600"
  },
  {
    "text": "because it is going to be demonstrated",
    "start": "284600",
    "end": "287780"
  },
  {
    "text": "later on an attack that I have now the",
    "start": "287780",
    "end": "293660"
  },
  {
    "text": "other component SiC framework seek is",
    "start": "293660",
    "end": "295910"
  },
  {
    "text": "very very powerful",
    "start": "295910",
    "end": "297110"
  },
  {
    "text": "and it used to be known as bra and they",
    "start": "297110",
    "end": "300320"
  },
  {
    "text": "recently change its name so it can",
    "start": "300320",
    "end": "303169"
  },
  {
    "text": "basically analyze the network traffic",
    "start": "303169",
    "end": "305419"
  },
  {
    "text": "and create by default a lot of locks",
    "start": "305419",
    "end": "308660"
  },
  {
    "text": "that are going to provide a lot of",
    "start": "308660",
    "end": "310340"
  },
  {
    "text": "visibility to the environment so it",
    "start": "310340",
    "end": "314750"
  },
  {
    "text": "turns out that it can natively extract",
    "start": "314750",
    "end": "317840"
  },
  {
    "text": "files from the clear text protocols that",
    "start": "317840",
    "end": "320300"
  },
  {
    "text": "it observes but you have to enable that",
    "start": "320300",
    "end": "322760"
  },
  {
    "text": "functionality and seek so",
    "start": "322760",
    "end": "327410"
  },
  {
    "text": "gerrae has been traditionally used",
    "start": "327410",
    "end": "329390"
  },
  {
    "text": "mainly on the endpoint to detect",
    "start": "329390",
    "end": "332000"
  },
  {
    "text": "malicious files but I noticed that",
    "start": "332000",
    "end": "334910"
  },
  {
    "text": "whenever I wanted to attack Isis files",
    "start": "334910",
    "end": "337370"
  },
  {
    "text": "on the network I couldn't find a readily",
    "start": "337370",
    "end": "341090"
  },
  {
    "text": "available tool to do this so I found",
    "start": "341090",
    "end": "343520"
  },
  {
    "text": "that these two tools can be integrated",
    "start": "343520",
    "end": "345890"
  },
  {
    "text": "very easily to enable that functionality",
    "start": "345890",
    "end": "348440"
  },
  {
    "text": "and their open source tools so you have",
    "start": "348440",
    "end": "352760"
  },
  {
    "text": "your typical enterprise network diagram",
    "start": "352760",
    "end": "355850"
  },
  {
    "text": "and you have to decide where to place a",
    "start": "355850",
    "end": "359210"
  },
  {
    "text": "spam port that could be on your course",
    "start": "359210",
    "end": "363650"
  },
  {
    "text": "which then you send that spam port to",
    "start": "363650",
    "end": "366800"
  },
  {
    "text": "your six sensor and by default you will",
    "start": "366800",
    "end": "369169"
  },
  {
    "text": "have your event-driven IDs logs created",
    "start": "369169",
    "end": "372020"
  },
  {
    "text": "by SiC but if you enable that",
    "start": "372020",
    "end": "374000"
  },
  {
    "text": "functionality for file extraction you'll",
    "start": "374000",
    "end": "376100"
  },
  {
    "text": "also have a lot of files to analyze then",
    "start": "376100",
    "end": "379630"
  },
  {
    "text": "you can enable that they are scanning on",
    "start": "379630",
    "end": "382220"
  },
  {
    "text": "the extracted files and you can send an",
    "start": "382220",
    "end": "385970"
  },
  {
    "text": "alert to the security team that you have",
    "start": "385970",
    "end": "388040"
  },
  {
    "text": "so that they can take action on any",
    "start": "388040",
    "end": "391610"
  },
  {
    "text": "detection that you have with your arrows",
    "start": "391610",
    "end": "394220"
  },
  {
    "text": "and by having the event-driven ideas",
    "start": "394220",
    "end": "397010"
  },
  {
    "text": "logs you can enrich that alert",
    "start": "397010",
    "end": "399650"
  },
  {
    "text": "to better help the analysts decide if",
    "start": "399650",
    "end": "402979"
  },
  {
    "text": "it's a false positive or a true positive",
    "start": "402979",
    "end": "404990"
  },
  {
    "text": "and take action on that event so to",
    "start": "404990",
    "end": "409040"
  },
  {
    "text": "enable the for extraction and seek it is",
    "start": "409040",
    "end": "411530"
  },
  {
    "text": "very easy you simply have to go to the",
    "start": "411530",
    "end": "413780"
  },
  {
    "text": "configuration file and enable a default",
    "start": "413780",
    "end": "416840"
  },
  {
    "text": "file that it already has and it is",
    "start": "416840",
    "end": "419479"
  },
  {
    "text": "basically the extractor all files",
    "start": "419479",
    "end": "422110"
  },
  {
    "text": "directive you have to add that to your",
    "start": "422110",
    "end": "425000"
  },
  {
    "text": "main configuration file and then deploy",
    "start": "425000",
    "end": "430790"
  },
  {
    "text": "the configuration again and that's it",
    "start": "430790",
    "end": "433160"
  },
  {
    "text": "it's going to extract all the files but",
    "start": "433160",
    "end": "436000"
  },
  {
    "text": "it also extract files from SSL",
    "start": "436000",
    "end": "439070"
  },
  {
    "text": "communications so you don't actually",
    "start": "439070",
    "end": "441110"
  },
  {
    "text": "have the content you only have details",
    "start": "441110",
    "end": "443780"
  },
  {
    "text": "about the SSL communication so another",
    "start": "443780",
    "end": "447740"
  },
  {
    "text": "approach would be to not extract every",
    "start": "447740",
    "end": "450020"
  },
  {
    "text": "file so only target very specific NIMH",
    "start": "450020",
    "end": "453680"
  },
  {
    "text": "types that are used commonly for malware",
    "start": "453680",
    "end": "456560"
  },
  {
    "text": "delivery so these will have the benefit",
    "start": "456560",
    "end": "459620"
  },
  {
    "text": "that files will be retained for longer",
    "start": "459620",
    "end": "461210"
  },
  {
    "text": "you will have increased performance but",
    "start": "461210",
    "end": "464300"
  },
  {
    "text": "it is a trade-off because if the",
    "start": "464300",
    "end": "466280"
  },
  {
    "text": "attacker is using a mid type that you",
    "start": "466280",
    "end": "468770"
  },
  {
    "text": "are not extracting he could evade",
    "start": "468770",
    "end": "470419"
  },
  {
    "text": "detection so here here are the files",
    "start": "470419",
    "end": "475070"
  },
  {
    "text": "that you could extract are which are",
    "start": "475070",
    "end": "478970"
  },
  {
    "text": "commonly used on malware delivery so I",
    "start": "478970",
    "end": "482990"
  },
  {
    "text": "decided to extract compressed files",
    "start": "482990",
    "end": "485510"
  },
  {
    "text": "Microsoft Word documents PDF files RTF",
    "start": "485510",
    "end": "488570"
  },
  {
    "text": "files and text files that could also",
    "start": "488570",
    "end": "491570"
  },
  {
    "text": "allow you to detect some powershell",
    "start": "491570",
    "end": "494000"
  },
  {
    "text": "JavaScript VBS based attacks if you're",
    "start": "494000",
    "end": "498229"
  },
  {
    "text": "interested on how to do this I also",
    "start": "498229",
    "end": "500270"
  },
  {
    "text": "wrote a white paper that will be",
    "start": "500270",
    "end": "502400"
  },
  {
    "text": "available on the black hat media server",
    "start": "502400",
    "end": "504500"
  },
  {
    "text": "and that will have the exact",
    "start": "504500",
    "end": "507070"
  },
  {
    "text": "configuration file that I use to extract",
    "start": "507070",
    "end": "509870"
  },
  {
    "text": "very specific meme types and as you can",
    "start": "509870",
    "end": "512779"
  },
  {
    "text": "see it is very clear to understand how",
    "start": "512779",
    "end": "515209"
  },
  {
    "text": "it works and you can easily extend it to",
    "start": "515209",
    "end": "517669"
  },
  {
    "text": "add or remove any mean types so we'll",
    "start": "517669",
    "end": "522560"
  },
  {
    "text": "have our spam port we will send that to",
    "start": "522560",
    "end": "526339"
  },
  {
    "text": "our six sensor and now that we have",
    "start": "526339",
    "end": "528230"
  },
  {
    "text": "configured the file extraction",
    "start": "528230",
    "end": "529880"
  },
  {
    "text": "functionality we",
    "start": "529880",
    "end": "531670"
  },
  {
    "text": "send those files to a specific folder of",
    "start": "531670",
    "end": "534550"
  },
  {
    "text": "extracted files then we will have a cron",
    "start": "534550",
    "end": "539560"
  },
  {
    "text": "job that will run my custom Python",
    "start": "539560",
    "end": "542890"
  },
  {
    "text": "script every minute and that custom",
    "start": "542890",
    "end": "548710"
  },
  {
    "text": "script will take all the general rules",
    "start": "548710",
    "end": "551500"
  },
  {
    "text": "that are defined on a specific folder",
    "start": "551500",
    "end": "553570"
  },
  {
    "text": "and will scan all the extracted files",
    "start": "553570",
    "end": "556270"
  },
  {
    "text": "from seek with those rules and if there",
    "start": "556270",
    "end": "559870"
  },
  {
    "text": "is any match it will go to the sick",
    "start": "559870",
    "end": "563410"
  },
  {
    "text": "locks and get additional contexts such",
    "start": "563410",
    "end": "566500"
  },
  {
    "text": "as the IP addresses that were involved",
    "start": "566500",
    "end": "568570"
  },
  {
    "text": "at URL the domain name user agent and",
    "start": "568570",
    "end": "572970"
  },
  {
    "text": "other fields and will copy those alerted",
    "start": "572970",
    "end": "577300"
  },
  {
    "text": "files to another folder so that they can",
    "start": "577300",
    "end": "580060"
  },
  {
    "text": "be retained for a longer period then it",
    "start": "580060",
    "end": "582850"
  },
  {
    "text": "will send the analyst an email alert",
    "start": "582850",
    "end": "584830"
  },
  {
    "text": "that will contain all the context and",
    "start": "584830",
    "end": "588220"
  },
  {
    "text": "after that it will remove all the files",
    "start": "588220",
    "end": "592030"
  },
  {
    "text": "contain on the extracted files folder so",
    "start": "592030",
    "end": "594790"
  },
  {
    "text": "that on the next minute the scan will be",
    "start": "594790",
    "end": "598600"
  },
  {
    "text": "much faster because we will only have to",
    "start": "598600",
    "end": "600880"
  },
  {
    "text": "scan the files that were extracted on",
    "start": "600880",
    "end": "602650"
  },
  {
    "text": "that minute and then it repeats in my",
    "start": "602650",
    "end": "607000"
  },
  {
    "text": "experience I have been successful at",
    "start": "607000",
    "end": "610270"
  },
  {
    "text": "running this script every minute but",
    "start": "610270",
    "end": "612100"
  },
  {
    "text": "obviously that will can change based on",
    "start": "612100",
    "end": "614620"
  },
  {
    "text": "how large your network is how many files",
    "start": "614620",
    "end": "617650"
  },
  {
    "text": "it sees so it can be configurable based",
    "start": "617650",
    "end": "620230"
  },
  {
    "text": "on your environments so what there are",
    "start": "620230",
    "end": "624340"
  },
  {
    "text": "rules to enable on your environment I",
    "start": "624340",
    "end": "628090"
  },
  {
    "text": "think that every organization should",
    "start": "628090",
    "end": "631030"
  },
  {
    "text": "have a security team able to write the",
    "start": "631030",
    "end": "635290"
  },
  {
    "text": "own general rules to identify any",
    "start": "635290",
    "end": "637450"
  },
  {
    "text": "campaigns that they they spot on the",
    "start": "637450",
    "end": "641110"
  },
  {
    "text": "wire to identify malgor families but",
    "start": "641110",
    "end": "644410"
  },
  {
    "text": "also you have to use the resources from",
    "start": "644410",
    "end": "646870"
  },
  {
    "text": "the community so locally yellow rules",
    "start": "646870",
    "end": "650200"
  },
  {
    "text": "are available and there are many groups",
    "start": "650200",
    "end": "653140"
  },
  {
    "text": "that that provide very good quality",
    "start": "653140",
    "end": "655000"
  },
  {
    "text": "error rules such as your team sir teams",
    "start": "655000",
    "end": "658390"
  },
  {
    "text": "all around the world we also have the",
    "start": "658390",
    "end": "660550"
  },
  {
    "text": "very talented Florian Roth who provides",
    "start": "660550",
    "end": "663010"
  },
  {
    "text": "a lot of very good error rules so the",
    "start": "663010",
    "end": "665290"
  },
  {
    "text": "community",
    "start": "665290",
    "end": "665980"
  },
  {
    "text": "and we also have the generous project",
    "start": "665980",
    "end": "668290"
  },
  {
    "text": "that provides air rules for free and",
    "start": "668290",
    "end": "670000"
  },
  {
    "text": "also public threat research that is",
    "start": "670000",
    "end": "674830"
  },
  {
    "text": "provided by various security vendors on",
    "start": "674830",
    "end": "678040"
  },
  {
    "text": "their information about the threat that",
    "start": "678040",
    "end": "679750"
  },
  {
    "text": "they do they normally include indicators",
    "start": "679750",
    "end": "681700"
  },
  {
    "text": "of compromise but also they include a",
    "start": "681700",
    "end": "684280"
  },
  {
    "text": "section with general rules that detect",
    "start": "684280",
    "end": "687160"
  },
  {
    "text": "the artifacts of the campaign's that",
    "start": "687160",
    "end": "689650"
  },
  {
    "text": "they analyze you also have some closed",
    "start": "689650",
    "end": "693790"
  },
  {
    "text": "threat research groups like the Jared",
    "start": "693790",
    "end": "695980"
  },
  {
    "text": "change community so to demonstrate this",
    "start": "695980",
    "end": "700420"
  },
  {
    "text": "capability I decided to focus on a very",
    "start": "700420",
    "end": "704460"
  },
  {
    "text": "prevalent threat attack vector that is",
    "start": "704460",
    "end": "707920"
  },
  {
    "text": "basically the Microsoft Word documents",
    "start": "707920",
    "end": "710620"
  },
  {
    "text": "with malicious code and as you can see",
    "start": "710620",
    "end": "713370"
  },
  {
    "text": "this threat attack vector has been used",
    "start": "713370",
    "end": "716620"
  },
  {
    "text": "for years and at least 2014 and the",
    "start": "716620",
    "end": "723120"
  },
  {
    "text": "latest example that I found was of the",
    "start": "723120",
    "end": "727780"
  },
  {
    "text": "last month right so and I think it's",
    "start": "727780",
    "end": "730900"
  },
  {
    "text": "still going to be used a lot so that is",
    "start": "730900",
    "end": "733420"
  },
  {
    "text": "why I decided to create a Jared we take",
    "start": "733420",
    "end": "736030"
  },
  {
    "text": "this kind of files so basically this",
    "start": "736030",
    "end": "740260"
  },
  {
    "text": "threat of attack vector is normally used",
    "start": "740260",
    "end": "742480"
  },
  {
    "text": "on phishing emails and as you can see on",
    "start": "742480",
    "end": "745120"
  },
  {
    "text": "the screen here I'm using a proof of",
    "start": "745120",
    "end": "747010"
  },
  {
    "text": "concept the server that I used to test",
    "start": "747010",
    "end": "751060"
  },
  {
    "text": "this kind of consulate functionality",
    "start": "751060",
    "end": "752800"
  },
  {
    "text": "this kind of detection capability so it",
    "start": "752800",
    "end": "756280"
  },
  {
    "text": "includes whatever lure to make the user",
    "start": "756280",
    "end": "759310"
  },
  {
    "text": "click on the link and download an",
    "start": "759310",
    "end": "761550"
  },
  {
    "text": "invoice so now I'm going to play this",
    "start": "761550",
    "end": "766300"
  },
  {
    "text": "demo for you to see how it works",
    "start": "766300",
    "end": "770040"
  },
  {
    "text": "so they used user clicks on the link the",
    "start": "773590",
    "end": "776740"
  },
  {
    "text": "file is downloaded the user opens the",
    "start": "776740",
    "end": "778840"
  },
  {
    "text": "file and while the user is reading this",
    "start": "778840",
    "end": "781720"
  },
  {
    "text": "document he sees that he has to enable",
    "start": "781720",
    "end": "786310"
  },
  {
    "text": "the macro code and he proceeds enables",
    "start": "786310",
    "end": "790300"
  },
  {
    "text": "the macro and the code runs on his",
    "start": "790300",
    "end": "794470"
  },
  {
    "text": "machine boy but by this time six already",
    "start": "794470",
    "end": "798070"
  },
  {
    "text": "extracted the file and I already scan it",
    "start": "798070",
    "end": "800529"
  },
  {
    "text": "with Yara and sent the security analyst",
    "start": "800529",
    "end": "803710"
  },
  {
    "text": "and alert an email alert which includes",
    "start": "803710",
    "end": "806080"
  },
  {
    "text": "all the information required to act and",
    "start": "806080",
    "end": "809700"
  },
  {
    "text": "do something about it so it is only a",
    "start": "809700",
    "end": "813130"
  },
  {
    "text": "detection control the code is already",
    "start": "813130",
    "end": "816130"
  },
  {
    "text": "running on the big team but it has not",
    "start": "816130",
    "end": "820360"
  },
  {
    "text": "passed a lot of time before that so as",
    "start": "820360",
    "end": "823620"
  },
  {
    "text": "you can see the analyst now has the",
    "start": "823620",
    "end": "827080"
  },
  {
    "text": "information and he can act and do",
    "start": "827080",
    "end": "829510"
  },
  {
    "text": "something about it so now I am going to",
    "start": "829510",
    "end": "832420"
  },
  {
    "text": "show you what details are contained on",
    "start": "832420",
    "end": "835089"
  },
  {
    "text": "that email so the very first part is the",
    "start": "835089",
    "end": "841830"
  },
  {
    "text": "general rules that were alerted so here",
    "start": "841830",
    "end": "845740"
  },
  {
    "text": "in this example I have two of my rules",
    "start": "845740",
    "end": "849070"
  },
  {
    "text": "that I wrote triggered on this file but",
    "start": "849070",
    "end": "852430"
  },
  {
    "text": "in addition to that I also have a rule",
    "start": "852430",
    "end": "854890"
  },
  {
    "text": "of a trusted third party in this case",
    "start": "854890",
    "end": "857140"
  },
  {
    "text": "Florian Road that had a rule that also",
    "start": "857140",
    "end": "861880"
  },
  {
    "text": "detected this file so basically if we",
    "start": "861880",
    "end": "864760"
  },
  {
    "text": "have more detections or more general",
    "start": "864760",
    "end": "868120"
  },
  {
    "text": "rules it is higher confidence then we",
    "start": "868120",
    "end": "874089"
  },
  {
    "text": "include details about the network",
    "start": "874089",
    "end": "875710"
  },
  {
    "text": "communication if the file is very large",
    "start": "875710",
    "end": "878890"
  },
  {
    "text": "and it cannot be added as an attachment",
    "start": "878890",
    "end": "880750"
  },
  {
    "text": "that to that email we place it we are",
    "start": "880750",
    "end": "885790"
  },
  {
    "text": "basically the path where it will be",
    "start": "885790",
    "end": "887800"
  },
  {
    "text": "stored on the six sensor so the analyst",
    "start": "887800",
    "end": "890860"
  },
  {
    "text": "can go to that path and retrieve the",
    "start": "890860",
    "end": "893350"
  },
  {
    "text": "file for additional analysis then we",
    "start": "893350",
    "end": "896200"
  },
  {
    "text": "also have the IP address of the",
    "start": "896200",
    "end": "900089"
  },
  {
    "text": "command-and-control server or the",
    "start": "900089",
    "end": "901900"
  },
  {
    "text": "delivery server that was used in this",
    "start": "901900",
    "end": "903820"
  },
  {
    "text": "attack and also the IP address of the",
    "start": "903820",
    "end": "906640"
  },
  {
    "text": "client",
    "start": "906640",
    "end": "907329"
  },
  {
    "text": "clicked on the link and also the HTTP",
    "start": "907329",
    "end": "911439"
  },
  {
    "text": "HTTP details such as you are I demand",
    "start": "911439",
    "end": "915339"
  },
  {
    "text": "method in addition to other fields such",
    "start": "915339",
    "end": "917739"
  },
  {
    "text": "as user agent we also include if the",
    "start": "917739",
    "end": "923739"
  },
  {
    "text": "file is smaller than the Atrisco defined",
    "start": "923739",
    "end": "925779"
  },
  {
    "text": "on the script we include it at as an",
    "start": "925779",
    "end": "927699"
  },
  {
    "text": "attachment and it is protected with a",
    "start": "927699",
    "end": "930189"
  },
  {
    "text": "password so basically we can move it to",
    "start": "930189",
    "end": "933129"
  },
  {
    "text": "an isolated environment to an idle",
    "start": "933129",
    "end": "935589"
  },
  {
    "text": "analyze it further and with this I",
    "start": "935589",
    "end": "938709"
  },
  {
    "text": "conclude my demonstration and I want to",
    "start": "938709",
    "end": "942569"
  },
  {
    "text": "end by talking about the challenges and",
    "start": "942569",
    "end": "946360"
  },
  {
    "text": "the next steps of this project well the",
    "start": "946360",
    "end": "949689"
  },
  {
    "text": "greatest challenge is the fine-tuning",
    "start": "949689",
    "end": "951720"
  },
  {
    "text": "because it can be initially hard to",
    "start": "951720",
    "end": "957189"
  },
  {
    "text": "decide what you are used to enable from",
    "start": "957189",
    "end": "960040"
  },
  {
    "text": "third-party specially because you",
    "start": "960040",
    "end": "962850"
  },
  {
    "text": "sometimes are not sure of the quality",
    "start": "962850",
    "end": "965619"
  },
  {
    "text": "that they have so you have to test that",
    "start": "965619",
    "end": "969549"
  },
  {
    "text": "and really make an effort on deciding",
    "start": "969549",
    "end": "972939"
  },
  {
    "text": "what third-party rules to enable in",
    "start": "972939",
    "end": "975489"
  },
  {
    "text": "addition to your own rules then it will",
    "start": "975489",
    "end": "978329"
  },
  {
    "text": "also require some tuning to decide what",
    "start": "978329",
    "end": "981910"
  },
  {
    "text": "meantimes to enable depending on how",
    "start": "981910",
    "end": "983769"
  },
  {
    "text": "much traffic you see and your",
    "start": "983769",
    "end": "985209"
  },
  {
    "text": "environment how big it is and if you",
    "start": "985209",
    "end": "987399"
  },
  {
    "text": "decide to make it a very targeted",
    "start": "987399",
    "end": "988839"
  },
  {
    "text": "extraction or maybe extract more files",
    "start": "988839",
    "end": "992910"
  },
  {
    "text": "now let's talk about the next steps on",
    "start": "992910",
    "end": "996879"
  },
  {
    "text": "the next versions of this project I'm",
    "start": "996879",
    "end": "999069"
  },
  {
    "text": "going to automatically create an event",
    "start": "999069",
    "end": "1001769"
  },
  {
    "text": "on the Miss p-- platform which is",
    "start": "1001769",
    "end": "1004889"
  },
  {
    "text": "basically another open-source project",
    "start": "1004889",
    "end": "1007999"
  },
  {
    "text": "created by the",
    "start": "1007999",
    "end": "1011910"
  },
  {
    "text": "look Sandberg sir team that is used on",
    "start": "1011910",
    "end": "1016120"
  },
  {
    "text": "all the first community so basically a",
    "start": "1016120",
    "end": "1019209"
  },
  {
    "text": "lot of computer emergency response teams",
    "start": "1019209",
    "end": "1022240"
  },
  {
    "text": "around the world use this tool and with",
    "start": "1022240",
    "end": "1025720"
  },
  {
    "text": "this I'm not only going to send an email",
    "start": "1025720",
    "end": "1027640"
  },
  {
    "text": "alert but also automatically create that",
    "start": "1027640",
    "end": "1029860"
  },
  {
    "text": "event on our threat intelligence",
    "start": "1029860",
    "end": "1031540"
  },
  {
    "text": "platform so that we can share indicators",
    "start": "1031540",
    "end": "1033730"
  },
  {
    "text": "rapidly with other security teams and",
    "start": "1033730",
    "end": "1036938"
  },
  {
    "text": "also I'm going to send the alert to",
    "start": "1036939",
    "end": "1039790"
  },
  {
    "text": "elasticsearch and syslog and have some",
    "start": "1039790",
    "end": "1043678"
  },
  {
    "text": "support for exclusions also exclude by",
    "start": "1043679",
    "end": "1047589"
  },
  {
    "text": "domain URL IP address etc and see if",
    "start": "1047589",
    "end": "1052510"
  },
  {
    "text": "there is any support to integrate it",
    "start": "1052510",
    "end": "1055150"
  },
  {
    "text": "with solutions that can open SSL traffic",
    "start": "1055150",
    "end": "1058059"
  },
  {
    "text": "so right now I don't know if that would",
    "start": "1058059",
    "end": "1060940"
  },
  {
    "text": "be possible but for sure I'm going to",
    "start": "1060940",
    "end": "1063010"
  },
  {
    "text": "test that",
    "start": "1063010",
    "end": "1065160"
  },
  {
    "text": "then I will migrate the Python script",
    "start": "1065160",
    "end": "1068169"
  },
  {
    "text": "that I develop from version to version 3",
    "start": "1068169",
    "end": "1070480"
  },
  {
    "text": "and evaluate an integration with sandbox",
    "start": "1070480",
    "end": "1075280"
  },
  {
    "text": "and sewer solutions",
    "start": "1075280",
    "end": "1077549"
  },
  {
    "text": "feel free to download my script from",
    "start": "1077549",
    "end": "1080440"
  },
  {
    "text": "that resource",
    "start": "1080440",
    "end": "1083730"
  },
  {
    "text": "and there's a white paper as I mentioned",
    "start": "1087430",
    "end": "1090310"
  },
  {
    "text": "previously and it has more details on",
    "start": "1090310",
    "end": "1092740"
  },
  {
    "text": "how to enable file extraction and the",
    "start": "1092740",
    "end": "1097200"
  },
  {
    "text": "components of this solution so the key",
    "start": "1097200",
    "end": "1101980"
  },
  {
    "text": "takeaways",
    "start": "1101980",
    "end": "1102730"
  },
  {
    "text": "gerrae detection can be implemented not",
    "start": "1102730",
    "end": "1106270"
  },
  {
    "text": "only on the end point but on the network",
    "start": "1106270",
    "end": "1109060"
  },
  {
    "text": "as well network based Jerell detection",
    "start": "1109060",
    "end": "1112540"
  },
  {
    "text": "can be implemented with seek which is an",
    "start": "1112540",
    "end": "1115300"
  },
  {
    "text": "open source and free platform and",
    "start": "1115300",
    "end": "1118530"
  },
  {
    "text": "network based",
    "start": "1118530",
    "end": "1119950"
  },
  {
    "text": "gerrae detection is generally faster in",
    "start": "1119950",
    "end": "1123010"
  },
  {
    "text": "my experience than scanning all the file",
    "start": "1123010",
    "end": "1127060"
  },
  {
    "text": "system of a specific endpoint which",
    "start": "1127060",
    "end": "1129340"
  },
  {
    "text": "normally stresses the endpoint and",
    "start": "1129340",
    "end": "1131200"
  },
  {
    "text": "causes performance issues in my",
    "start": "1131200",
    "end": "1134470"
  },
  {
    "text": "experience scanning all the extracted",
    "start": "1134470",
    "end": "1137140"
  },
  {
    "text": "files of on one minute is very very fast",
    "start": "1137140",
    "end": "1141600"
  },
  {
    "text": "obviously it can take longer on a larger",
    "start": "1141600",
    "end": "1145300"
  },
  {
    "text": "environment so finally I want to end",
    "start": "1145300",
    "end": "1149560"
  },
  {
    "text": "this presentation thinking to the open",
    "start": "1149560",
    "end": "1153850"
  },
  {
    "text": "source products that I used and that are",
    "start": "1153850",
    "end": "1156730"
  },
  {
    "text": "really great the stick project the yarra",
    "start": "1156730",
    "end": "1159250"
  },
  {
    "text": "project and also to the threat",
    "start": "1159250",
    "end": "1161920"
  },
  {
    "text": "researchers that share information with",
    "start": "1161920",
    "end": "1165700"
  },
  {
    "text": "the community so Victor Manuel Alvarez",
    "start": "1165700",
    "end": "1169180"
  },
  {
    "text": "Milla parkour and the direct change deep",
    "start": "1169180",
    "end": "1171370"
  },
  {
    "text": "end research community florian growth",
    "start": "1171370",
    "end": "1173260"
  },
  {
    "text": "and year Stevens Bradford malware and",
    "start": "1173260",
    "end": "1176470"
  },
  {
    "text": "traffic analysis net sense I see 13",
    "start": "1176470",
    "end": "1179950"
  },
  {
    "text": "security vendors that decide to share",
    "start": "1179950",
    "end": "1182530"
  },
  {
    "text": "general rules on the threat research",
    "start": "1182530",
    "end": "1184690"
  },
  {
    "text": "papers that they do and release to the",
    "start": "1184690",
    "end": "1187720"
  },
  {
    "text": "public and with that I want to thank you",
    "start": "1187720",
    "end": "1190720"
  },
  {
    "text": "for coming here and listening to me do",
    "start": "1190720",
    "end": "1194230"
  },
  {
    "text": "you have any questions",
    "start": "1194230",
    "end": "1197070"
  },
  {
    "text": "thank you thank you very much",
    "start": "1200940",
    "end": "1202910"
  },
  {
    "text": "[Applause]",
    "start": "1202910",
    "end": "1208669"
  }
]