[
  {
    "text": "okay good morning everybody are you ready for an awesome talk yeah I need your energy okay so my",
    "start": "2760",
    "end": "11000"
  },
  {
    "text": "name is toml bar and I'm the VP of security research at safebridge and",
    "start": "11000",
    "end": "16080"
  },
  {
    "text": "actually this is our 10 qualified talk to black at USA I've been around for 20",
    "start": "16080",
    "end": "21840"
  },
  {
    "text": "years I've um spoken in many conferences and this year I was qualified to speak",
    "start": "21840",
    "end": "28039"
  },
  {
    "text": "two blacket talk and one talk hi everyone I'm schm Cohen and I've",
    "start": "28039",
    "end": "34200"
  },
  {
    "text": "been working in cyber security field for about 5 years now I began my career as a developer and later moved on to a",
    "start": "34200",
    "end": "40239"
  },
  {
    "text": "security research position where I did AP marware research today my primary focus is vulnerability research at save",
    "start": "40239",
    "end": "46840"
  },
  {
    "text": "bridge and actually this is my first time in black hat so I hope you find this talk interesting and back to you",
    "start": "46840",
    "end": "53199"
  },
  {
    "text": "tomor thank you so let's begin we will start by introducing our research goal",
    "start": "53199",
    "end": "59440"
  },
  {
    "text": "and approach apprach then we will detail step by step on how we discover this",
    "start": "59440",
    "end": "65000"
  },
  {
    "text": "vulnerability and now we use it with in more than 10 different attack vectors so",
    "start": "65000",
    "end": "70720"
  },
  {
    "text": "we have seven demos so keep tuned and we will close the talk",
    "start": "70720",
    "end": "76159"
  },
  {
    "text": "with our takeaways the vendor response and the GitHub repository before leaving",
    "start": "76159",
    "end": "81960"
  },
  {
    "text": "time for Q&A so during the last year our team was",
    "start": "81960",
    "end": "88000"
  },
  {
    "text": "focused on EDR arbitrary Del vulnerabilities our fellow team member Ora presented his iido research a",
    "start": "88000",
    "end": "96360"
  },
  {
    "text": "mislead Defender and additional edrs to delete the wrong file by abusing time of",
    "start": "96360",
    "end": "103560"
  },
  {
    "text": "check time of use vulnerability resulting in total deletion of all user",
    "start": "103560",
    "end": "109600"
  },
  {
    "text": "and Os files after a restart then om and myself conducted our",
    "start": "109600",
    "end": "116799"
  },
  {
    "text": "second research that we presented here on this stage yesterday and we found a",
    "start": "116799",
    "end": "122119"
  },
  {
    "text": "way to insert delete or modifi any Defender by signatures by initiating the",
    "start": "122119",
    "end": "128920"
  },
  {
    "text": "defender signature update the attack vectors that were achieved were arbitrary deletions of both user and Os",
    "start": "128920",
    "end": "136720"
  },
  {
    "text": "file and generic bypass of any known marware in the world and even even",
    "start": "136720",
    "end": "142080"
  },
  {
    "text": "possible local privilege escalation but although these vulnerabilities are",
    "start": "142080",
    "end": "147560"
  },
  {
    "text": "awesome right uh uh they are limited to only local attack vectors and in this",
    "start": "147560",
    "end": "155200"
  },
  {
    "text": "research we will explain how we were able to discover remote attack vectors",
    "start": "155200",
    "end": "161159"
  },
  {
    "text": "and deletion of critical files so our goal is to be able to",
    "start": "161159",
    "end": "166680"
  },
  {
    "text": "confuse EDR products by remotely implanting a mar signature into legit",
    "start": "166680",
    "end": "172959"
  },
  {
    "text": "files and making them believe the legit files are actually malicious for an",
    "start": "172959",
    "end": "178800"
  },
  {
    "text": "analogy the Defender usually recognize Tor Swift as benign we will try to implant a small",
    "start": "178800",
    "end": "186120"
  },
  {
    "text": "modification Mark and Defender will think that the tail of sweet is actually",
    "start": "186120",
    "end": "191640"
  },
  {
    "text": "Mal actually malicious evil and do his best to eliminate it so something like",
    "start": "191640",
    "end": "199319"
  },
  {
    "text": "that so to conclude our teaser what will you say if we can remotely delete your",
    "start": "200360",
    "end": "206840"
  },
  {
    "text": "critical files over the internet without authentication even if you use different",
    "start": "206840",
    "end": "213640"
  },
  {
    "text": "security controls or use Windows or Linux fully patched servers in the next hour we are going to",
    "start": "213640",
    "end": "221840"
  },
  {
    "text": "prove that this is definitely possible we add three challenges first",
    "start": "221840",
    "end": "228879"
  },
  {
    "text": "false positive or False Alarm are known problems for a long time and security",
    "start": "228879",
    "end": "234920"
  },
  {
    "text": "controls which are installed on hundreds of millions of endpoints are already probably immune to false positive right",
    "start": "234920",
    "end": "242519"
  },
  {
    "text": "but moreover the false positive we are aiming to achieve are even more rare",
    "start": "242519",
    "end": "248760"
  },
  {
    "text": "since we would like to trigger the bite signature engine which considered to be",
    "start": "248760",
    "end": "253959"
  },
  {
    "text": "the most trusted lay with the lowest false positive rate right and last the",
    "start": "253959",
    "end": "259440"
  },
  {
    "text": "last challenge was how to trigger it from remote so let's begin the goal of the",
    "start": "259440",
    "end": "267479"
  },
  {
    "text": "step one is to find a signature that will trigger automatic deletion",
    "start": "267479",
    "end": "272680"
  },
  {
    "text": "when appended to a hour empty file we decided to use blackbox approach",
    "start": "272680",
    "end": "280240"
  },
  {
    "text": "instead of a white box since each security vends product use a different",
    "start": "280240",
    "end": "285600"
  },
  {
    "text": "proprietary database format and the research goal was to discover as many",
    "start": "285600",
    "end": "290800"
  },
  {
    "text": "vulnerabilities in many as many products as possible and blackbox was the best",
    "start": "290800",
    "end": "296600"
  },
  {
    "text": "strategy for that we also decided to focus first on",
    "start": "296600",
    "end": "301840"
  },
  {
    "text": "Windows Defender which is the default EDR installed in hundred of millions of Windows agent and server on even more",
    "start": "301840",
    "end": "308600"
  },
  {
    "text": "and we assume that virus total use Windows Defender same engine as the",
    "start": "308600",
    "end": "314479"
  },
  {
    "text": "regular Windows Defender installed on every endpoint Vos total also provided",
    "start": "314479",
    "end": "321199"
  },
  {
    "text": "easy hunting capabilities for example query for all detected marwar by",
    "start": "321199",
    "end": "327199"
  },
  {
    "text": "Microsoft and limited by 200 by size binaries as you can see above we run",
    "start": "327199",
    "end": "334960"
  },
  {
    "text": "this query and got 3600 results the first example is a binary",
    "start": "334960",
    "end": "342400"
  },
  {
    "text": "detected as a joke VBS terrier marware family the file size is 120",
    "start": "342400",
    "end": "349840"
  },
  {
    "text": "bytes we verified that this file is indeed detected by Defender agent so we",
    "start": "349840",
    "end": "356840"
  },
  {
    "text": "understood that our query provided us with a good",
    "start": "356840",
    "end": "362199"
  },
  {
    "text": "start now we decided to minimize the file to a minimal bite signature that",
    "start": "362199",
    "end": "367960"
  },
  {
    "text": "will still trigger Defender let's go over a simple example to understand our",
    "start": "367960",
    "end": "374639"
  },
  {
    "text": "technique as we can see in the example we started with the X ABC Y string and",
    "start": "374639",
    "end": "382759"
  },
  {
    "text": "it's a detected signature let's say it's a detected signature so we remove the first letter X and wrote the file to",
    "start": "382759",
    "end": "389280"
  },
  {
    "text": "this in order to trigger Defender to scan the file again we still got a detection so it means that X is not part",
    "start": "389280",
    "end": "396919"
  },
  {
    "text": "of the signature but when we removed a and wrot it to disk we got a detection",
    "start": "396919",
    "end": "403960"
  },
  {
    "text": "so it's a central part of the signature B and C were essential too and finally",
    "start": "403960",
    "end": "409080"
  },
  {
    "text": "we removed the last y we got detection so Y is not a part of the signature and the final minimal signature is ABC right",
    "start": "409080",
    "end": "416360"
  },
  {
    "text": "it's very easy so back to our our joke VBS file we",
    "start": "416360",
    "end": "421720"
  },
  {
    "text": "started with 120 letters and in the same way we manually started to remove each",
    "start": "421720",
    "end": "427400"
  },
  {
    "text": "letter of the militia signature and scanning the file again the result was a",
    "start": "427400",
    "end": "433360"
  },
  {
    "text": "71 character length signature marked in red that's that's all by alone triggers",
    "start": "433360",
    "end": "440520"
  },
  {
    "text": "Defender we can see that window Defender indeed detect our file as malicious but the alert is medium and the file is not",
    "start": "440520",
    "end": "448599"
  },
  {
    "text": "automatically deleted and the default action is manually steps required as you can see which is not",
    "start": "448599",
    "end": "455720"
  },
  {
    "text": "good for us so we decided to learn more about Defender threat Levels by reading the",
    "start": "455720",
    "end": "465039"
  },
  {
    "text": "documentation the MP threat class includes an interesting Field named severity ad we found out that there are",
    "start": "465280",
    "end": "473120"
  },
  {
    "text": "four levels of threat severities low moderate high and critical and severe",
    "start": "473120",
    "end": "480319"
  },
  {
    "text": "sorry and the default action to be taken for each threat severity we assume that the most severe",
    "start": "480319",
    "end": "486800"
  },
  {
    "text": "Threat Level will probably have a more severe default remediation action and we",
    "start": "486800",
    "end": "492440"
  },
  {
    "text": "verified our assumption was correct by reversing Defender as you can see on the",
    "start": "492440",
    "end": "497479"
  },
  {
    "text": "right it's a little bit small I hope you can see it and this is the logic of the scanner looking deeper we found out that",
    "start": "497479",
    "end": "505639"
  },
  {
    "text": "the class MP thread detection which includes the addition action bit mask",
    "start": "505639",
    "end": "510800"
  },
  {
    "text": "with all possible action Defender supports to mitigate a threat so our",
    "start": "510800",
    "end": "516599"
  },
  {
    "text": "goal is to find a severe level signature that will trigger automatic deletion of",
    "start": "516599",
    "end": "522159"
  },
  {
    "text": "our file we found this short jscript as the",
    "start": "522159",
    "end": "527360"
  },
  {
    "text": "minimal signature of malicious toan in red we can see that Windows Defender",
    "start": "527360",
    "end": "532800"
  },
  {
    "text": "found it as a severe but this is actually a special script case since the",
    "start": "532800",
    "end": "538600"
  },
  {
    "text": "file was was not entirely deleted but only the script part was removed from the file this is a nice progress but we",
    "start": "538600",
    "end": "546440"
  },
  {
    "text": "would like to have the ability to delete the entire content of the file and not the script right so it's not good",
    "start": "546440",
    "end": "553360"
  },
  {
    "text": "enough so we continue our manual search for the right signature but it took us",
    "start": "553360",
    "end": "559399"
  },
  {
    "text": "too much time and failed attempts so we understood that we should shift from",
    "start": "559399",
    "end": "565160"
  },
  {
    "text": "manual process into an automatic process",
    "start": "565160",
    "end": "570519"
  },
  {
    "text": "so we downloaded all the 36 under malw from our original virus total hunting",
    "start": "570519",
    "end": "576320"
  },
  {
    "text": "query and develop a first very basic tool to automatically extract the",
    "start": "576320",
    "end": "581920"
  },
  {
    "text": "minimal signature from each marware as I said the script was very",
    "start": "581920",
    "end": "587079"
  },
  {
    "text": "basic just automating the manual process that we describ we found out that large part of",
    "start": "587079",
    "end": "594640"
  },
  {
    "text": "the sample were actually a variant of the same marware eventually we found",
    "start": "594640",
    "end": "600200"
  },
  {
    "text": "only 130 unique signatures but how do you know which",
    "start": "600200",
    "end": "608600"
  },
  {
    "text": "will be the best signature since we assume that there are going to be limitation in the implanting of the",
    "start": "608600",
    "end": "616279"
  },
  {
    "text": "signatures in legit files we had to prioritize the different signatures in",
    "start": "616279",
    "end": "622440"
  },
  {
    "text": "order to find the best signature in the database with the minimum limitation we believe that the alpha",
    "start": "622440",
    "end": "629640"
  },
  {
    "text": "numeric signature will have less limitation we also might have length",
    "start": "629640",
    "end": "635519"
  },
  {
    "text": "limitations so we would like to use very short signature we found a signature marked in",
    "start": "635519",
    "end": "643680"
  },
  {
    "text": "red little bit small uh which seemed to be the best candidate since it was only",
    "start": "643680",
    "end": "648959"
  },
  {
    "text": "alpha numeric the signature is actually a base 64 of the acar signature which is",
    "start": "648959",
    "end": "655920"
  },
  {
    "text": "the standard antivirus test file but according to the iico specification edrs",
    "start": "655920",
    "end": "662760"
  },
  {
    "text": "limit the detection and it's only triggering if the target file contain the exact signature without any extra",
    "start": "662760",
    "end": "671079"
  },
  {
    "text": "extra characters after it and it's the same for the big 64 version and we verified that it's not working so again",
    "start": "671079",
    "end": "679760"
  },
  {
    "text": "it's not good signature for our purposes but then we found the second signature which is only 15 characters",
    "start": "679760",
    "end": "687600"
  },
  {
    "text": "length and consist of only two types of non-al numeric characters a slash and a",
    "start": "687600",
    "end": "694120"
  },
  {
    "text": "curly brackets let's try to manually added it to an empty",
    "start": "694120",
    "end": "699320"
  },
  {
    "text": "file and it worked this signature caused the deletion of our own file and it was",
    "start": "699320",
    "end": "705680"
  },
  {
    "text": "the first time we managed to find a minimal signature which successfully trigger automatic deletion of our",
    "start": "705680",
    "end": "713480"
  },
  {
    "text": "file but deleting our own empty file is not interesting our next next step was",
    "start": "713480",
    "end": "719959"
  },
  {
    "text": "quite obvious verifying that we can manually append the signature to a",
    "start": "719959",
    "end": "725480"
  },
  {
    "text": "Target legit file and not to our own file we tried to manually append this",
    "start": "725480",
    "end": "731839"
  },
  {
    "text": "signature in the middle of another existing document and for our surprise",
    "start": "731839",
    "end": "736920"
  },
  {
    "text": "it didn't work so we developed another faster",
    "start": "736920",
    "end": "742040"
  },
  {
    "text": "minimizer which called Defender scan exported function instead of dropping",
    "start": "742040",
    "end": "747600"
  },
  {
    "text": "each iteration to this and waiting for the detection as we did in the first",
    "start": "747600",
    "end": "752839"
  },
  {
    "text": "minimizer this is much faster since Defender does not quentine files at all",
    "start": "752839",
    "end": "758839"
  },
  {
    "text": "using this technique the tool reads the target marware from excluded path and replace",
    "start": "758839",
    "end": "765360"
  },
  {
    "text": "each bite with the letter Z and wean it if the verdict tends to be nine then it",
    "start": "765360",
    "end": "770480"
  },
  {
    "text": "restore the Z to the original bites let's see an example of running our",
    "start": "770480",
    "end": "776440"
  },
  {
    "text": "minimizer on a larger file on Mim get binary this is the output after",
    "start": "776440",
    "end": "785320"
  },
  {
    "text": "minimization for any extension Windows Defender will check if the file is a",
    "start": "785320",
    "end": "791000"
  },
  {
    "text": "portable executable file by checking if the file start with the magic bytes MZ",
    "start": "791000",
    "end": "797480"
  },
  {
    "text": "and if the content in the EFA New Field offset is equal to PE as you can see at",
    "start": "797480",
    "end": "805040"
  },
  {
    "text": "the offset 120 there if this is a PE file it will scan for signatures in the",
    "start": "805040",
    "end": "812079"
  },
  {
    "text": "entire file until it will reach the mimic at signature as you can see in this example it will be in the offset",
    "start": "812079",
    "end": "820880"
  },
  {
    "text": "d130 this file with textual extension and with",
    "start": "821800",
    "end": "827079"
  },
  {
    "text": "99% the letter Z is detected by Defender as mimicet so it's crazy",
    "start": "827079",
    "end": "833839"
  },
  {
    "text": "right so when we appended mimicet signature to a middle of legit portable",
    "start": "833839",
    "end": "838959"
  },
  {
    "text": "executable file it worked the problem is that we could not think of any",
    "start": "838959",
    "end": "844880"
  },
  {
    "text": "interesting Vector on PE because if the user already have privilege to write to",
    "start": "844880",
    "end": "850480"
  },
  {
    "text": "the p is probably can delete it anyway right so we have to focus on",
    "start": "850480",
    "end": "855800"
  },
  {
    "text": "non-executable files and understand the reason why it failed to detect it in our",
    "start": "855800",
    "end": "861959"
  },
  {
    "text": "signature using our signature so we develop additional tool to understand",
    "start": "861959",
    "end": "867399"
  },
  {
    "text": "the non PE limitation the tool tried to embed the same signature in incremental offset from the",
    "start": "867399",
    "end": "874040"
  },
  {
    "text": "beginning of the file to its end we found out very interesting stuff that in",
    "start": "874040",
    "end": "880680"
  },
  {
    "text": "the case of non PE Defender does not scan the entire file probably for",
    "start": "880680",
    "end": "886600"
  },
  {
    "text": "efficiency reason it scans only the first and last 4,030 bytes it means that",
    "start": "886600",
    "end": "894480"
  },
  {
    "text": "we must append our signatures to those section in the Target file and if we can",
    "start": "894480",
    "end": "899639"
  },
  {
    "text": "do that we will be able to delete nonp file",
    "start": "899639",
    "end": "904720"
  },
  {
    "text": "automatically so until this point we were focused on learning how to locally trigger automatic deltion now we should",
    "start": "904880",
    "end": "913639"
  },
  {
    "text": "plan how to achieve remote attack vectors so we needed a way to somehow",
    "start": "913639",
    "end": "920320"
  },
  {
    "text": "make a privileged service to write our data to a remote file the first idea",
    "start": "920320",
    "end": "927000"
  },
  {
    "text": "that come into our mind where if we will be able to send an HTTP",
    "start": "927000",
    "end": "932440"
  },
  {
    "text": "request with our signature to a web server and this web server we log our",
    "start": "932440",
    "end": "938480"
  },
  {
    "text": "request we will be able to trigger remote deletion right the remot remote",
    "start": "938480",
    "end": "944000"
  },
  {
    "text": "deletion of the defender installed on the web server to delete the log but we",
    "start": "944000",
    "end": "949160"
  },
  {
    "text": "wonder which HTTP field to use so we wonder around we look around and found",
    "start": "949160",
    "end": "954480"
  },
  {
    "text": "that IIs log contains a user agent field and it's a long free text ring which is",
    "start": "954480",
    "end": "961519"
  },
  {
    "text": "written entirely to a daily single log file of all client request not just our",
    "start": "961519",
    "end": "968000"
  },
  {
    "text": "request all customer request in the same day so this should be the perfect place",
    "start": "968000",
    "end": "973279"
  },
  {
    "text": "to include our signature will continue from",
    "start": "973279",
    "end": "978519"
  },
  {
    "text": "here thank you Tom so now let's explore our first",
    "start": "978519",
    "end": "985000"
  },
  {
    "text": "attack Vector remote deletion of IIs web server log",
    "start": "985000",
    "end": "990519"
  },
  {
    "text": "in this demo we will see a remote deltion of IIs web server logs we ran",
    "start": "991000",
    "end": "997440"
  },
  {
    "text": "this attack on latest Windows 11 machine and I'm starting by getting the IP",
    "start": "997440",
    "end": "1002639"
  },
  {
    "text": "address of the victim machine then I will I will serve to the",
    "start": "1002639",
    "end": "1007839"
  },
  {
    "text": "web server and it just to show you that logs has been written to the log file",
    "start": "1007839",
    "end": "1014040"
  },
  {
    "text": "now let's navigate to the logs folder where we will see our access log file file with the logs that's been",
    "start": "1014040",
    "end": "1021560"
  },
  {
    "text": "written so navigating to the logs folder and there it is these are the logs that",
    "start": "1021560",
    "end": "1027480"
  },
  {
    "text": "has been written from our session now now I'm using a simple python script",
    "start": "1027480",
    "end": "1033640"
  },
  {
    "text": "to send a numerous amount of malicious user agents to the web server it will",
    "start": "1033640",
    "end": "1040678"
  },
  {
    "text": "take few seconds and then we will see how it will affect the access log file",
    "start": "1040679",
    "end": "1046199"
  },
  {
    "text": "so waiting few seconds it's done now let's see the access log",
    "start": "1046199",
    "end": "1052880"
  },
  {
    "text": "file and the first time it didn't work because the the logs hasn't been written",
    "start": "1052880",
    "end": "1058640"
  },
  {
    "text": "yet to the log file but the second time we try to access it it's not no longer available theer trigger triggered and it",
    "start": "1058640",
    "end": "1066320"
  },
  {
    "text": "acted as malicious therefore it's no longer available and it will be deleted after a reboot so the access log file",
    "start": "1066320",
    "end": "1073080"
  },
  {
    "text": "will be deleted as you saw in the demo and you can see in this picture Defender detects",
    "start": "1073080",
    "end": "1078799"
  },
  {
    "text": "the IAS log as an RTF exploit and it will be deleted after",
    "start": "1078799",
    "end": "1084520"
  },
  {
    "text": "reboot well I is a good example for Windows servers but most web servers",
    "start": "1084799",
    "end": "1090559"
  },
  {
    "text": "install on Linux and in Linux there is no EDR installed by default so we aim to",
    "start": "1090559",
    "end": "1096760"
  },
  {
    "text": "trigger other EDR solutions that are likely to be installed on Linux web",
    "start": "1096760",
    "end": "1102039"
  },
  {
    "text": "servers as you can see according to Gartner magic warant these are the leading EDR products on the market",
    "start": "1102039",
    "end": "1109120"
  },
  {
    "text": "we aim at them since they are likely to be installed on Enterprise",
    "start": "1109120",
    "end": "1114200"
  },
  {
    "text": "servers as of now we confirm the effectiveness of our technique and we",
    "start": "1114960",
    "end": "1120120"
  },
  {
    "text": "now have the ability to automatically reduce the size of signatures in a way that would trigger automatic deletion",
    "start": "1120120",
    "end": "1126600"
  },
  {
    "text": "with this knowledge The Next Step was quite obvious we wanted to create a database of what we name as evil",
    "start": "1126600",
    "end": "1132360"
  },
  {
    "text": "signatures for various leading EDR vendors this database will allow us to perform a single signature queries",
    "start": "1132360",
    "end": "1139799"
  },
  {
    "text": "capable of triggering most if not all of the EDR Solutions this method is beneficial for remote attacks when we",
    "start": "1139799",
    "end": "1146559"
  },
  {
    "text": "don't know which EDR is installed on the remote machine so we wanted to check if our",
    "start": "1146559",
    "end": "1153919"
  },
  {
    "text": "method works on EDR products other than Defender and we discover that EDR products have different behaviors some",
    "start": "1153919",
    "end": "1161080"
  },
  {
    "text": "of them only scale files with specific extensions some worked only if the signature were presented in the",
    "start": "1161080",
    "end": "1166600"
  },
  {
    "text": "beginning of the file and some them uses machine learning algorithms in order to dedex files which are not vulnerable to",
    "start": "1166600",
    "end": "1172480"
  },
  {
    "text": "our attack vectors this reduce our attack vectors against gu against those",
    "start": "1172480",
    "end": "1178080"
  },
  {
    "text": "edrs after searching for leading ADR product that suits our needs we found out that kasperski EDR for Linux does",
    "start": "1178080",
    "end": "1184480"
  },
  {
    "text": "exactly what we are looking for therefore in the next Linux examples we will focus on targeting servers with",
    "start": "1184480",
    "end": "1190400"
  },
  {
    "text": "kasperski EDR install on them by the way another side goal that",
    "start": "1190400",
    "end": "1195799"
  },
  {
    "text": "we had is to find the signature that we trigger most most of the vulnerable edrs it will be perfect in the case when we",
    "start": "1195799",
    "end": "1202200"
  },
  {
    "text": "don't know which EDR is installed on the target machine after some tries we found the signature for triggering kasperski",
    "start": "1202200",
    "end": "1209080"
  },
  {
    "text": "but it also triggered Defender so now let's see a demo of",
    "start": "1209080",
    "end": "1214520"
  },
  {
    "text": "remotely delete engine X web server logs installed on Linux with",
    "start": "1214520",
    "end": "1220240"
  },
  {
    "text": "kasperski so here we can see on the right side a simple Ubunto machine with engine X web server installed on it as",
    "start": "1221520",
    "end": "1228000"
  },
  {
    "text": "you can see I'm trying now to remove manually the log files we from a weak",
    "start": "1228000",
    "end": "1233919"
  },
  {
    "text": "from a weak user and it won't be it won't work because the wick user doesn't have permissions to delete this log file",
    "start": "1233919",
    "end": "1241400"
  },
  {
    "text": "now I will just watch the access log file and see how we can affect it so",
    "start": "1241400",
    "end": "1246640"
  },
  {
    "text": "putting a watch on the log file okay now let's hit few time refresh",
    "start": "1246640",
    "end": "1254039"
  },
  {
    "text": "and we can see that if each refresh will cause the logs to be written now I will use another simple python",
    "start": "1254039",
    "end": "1261120"
  },
  {
    "text": "script to insert manually a user agent so I'm starting by inserting a test user",
    "start": "1261120",
    "end": "1268600"
  },
  {
    "text": "agent just to show you that it's working so test and test two works works and now",
    "start": "1268600",
    "end": "1274679"
  },
  {
    "text": "I will insert a malicious signature as a user agents and let's see what will",
    "start": "1274679",
    "end": "1279840"
  },
  {
    "text": "happen so malicious signature hit enter and at the moment that I hit in enter",
    "start": "1279840",
    "end": "1284919"
  },
  {
    "text": "this file is deleted it's no longer available cu py delete it and let's see",
    "start": "1284919",
    "end": "1290000"
  },
  {
    "text": "if we can restore it maybe we can restore it and everything will be fine trying to restore it",
    "start": "1290000",
    "end": "1296440"
  },
  {
    "text": "and nope it just kept deleting again and again because kasperski detects it it's",
    "start": "1296440",
    "end": "1302919"
  },
  {
    "text": "a malicious the same method works on",
    "start": "1302919",
    "end": "1308559"
  },
  {
    "text": "Apache web servers as well so to sum up by using a short signature we allegedly",
    "start": "1308559",
    "end": "1314919"
  },
  {
    "text": "will be able to delete up to 35% of web sever logs in the world that's pretty",
    "start": "1314919",
    "end": "1320400"
  },
  {
    "text": "amazing we prove it only with kasperski on Linux but it can be expanded to other Securities vendors as well in the next",
    "start": "1320400",
    "end": "1327520"
  },
  {
    "text": "few slide we are going to show short examples of different attack vectors that we thought",
    "start": "1327520",
    "end": "1334360"
  },
  {
    "text": "of the first one will be FTP server not only web server logs are at risk Fila",
    "start": "1334360",
    "end": "1340840"
  },
  {
    "text": "FTP server for example would be at risk too this time using a minimized",
    "start": "1340840",
    "end": "1346039"
  },
  {
    "text": "signature from the invoke mimicet Powershell malware we use its username",
    "start": "1346039",
    "end": "1351240"
  },
  {
    "text": "for the FTP login this malicious username will be written to the FTP",
    "start": "1351240",
    "end": "1356600"
  },
  {
    "text": "server logs which will cause Defender to delete them so no more FTP logs at this",
    "start": "1356600",
    "end": "1363440"
  },
  {
    "text": "machine another one is an email attack scenario using mailla Thunderbird this time the attacker sends",
    "start": "1363440",
    "end": "1371360"
  },
  {
    "text": "an email to the victim with a subject that includes our malicious signature",
    "start": "1371360",
    "end": "1376799"
  },
  {
    "text": "then as designed Mozilla Thunderbird stores the entire inbox in a single textual file that contains our signature",
    "start": "1376799",
    "end": "1385080"
  },
  {
    "text": "the local inbox will be removed by the EDR and thunderbar will try to download it again this will cause a Non-Stop Loop",
    "start": "1385080",
    "end": "1392679"
  },
  {
    "text": "of downloading and deleting the inbox file another cool Vector is by executing",
    "start": "1392679",
    "end": "1400080"
  },
  {
    "text": "a corrupted MSI file the subject field in the MSI properties will include the",
    "start": "1400080",
    "end": "1405440"
  },
  {
    "text": "evil signature this will cause log record that contains the evil signature",
    "start": "1405440",
    "end": "1410799"
  },
  {
    "text": "to be appended to the application Windows Event log file which will trigger um Defender that will delete",
    "start": "1410799",
    "end": "1418120"
  },
  {
    "text": "this file so the event log file will be deleted because we put the evil",
    "start": "1418120",
    "end": "1423440"
  },
  {
    "text": "signature in the properties this is not the end what about achieving deletion of Windows",
    "start": "1423440",
    "end": "1430320"
  },
  {
    "text": "security log files but remotely this time is it possible yes the answer is",
    "start": "1430320",
    "end": "1435919"
  },
  {
    "text": "yes by attempting to perform remote login to the machine via SMB using a",
    "start": "1435919",
    "end": "1441080"
  },
  {
    "text": "malicious username we can remotely insert malicious records into the security event log file if we repeat",
    "start": "1441080",
    "end": "1448120"
  },
  {
    "text": "this process enough times the records will end up at the end of the log file resulting their",
    "start": "1448120",
    "end": "1454880"
  },
  {
    "text": "deletion let's see a demo of that so again running latest Windows 11",
    "start": "1454880",
    "end": "1463400"
  },
  {
    "text": "machine and I'm starting by getting the IP address of the targetting machine and on the left side I will run a SMB",
    "start": "1463440",
    "end": "1471159"
  },
  {
    "text": "login script that will try many times to log in with a malicious username it will take few minutes but we",
    "start": "1471159",
    "end": "1479120"
  },
  {
    "text": "short up the video and now I will scan the windows log folder and let's see",
    "start": "1479120",
    "end": "1484679"
  },
  {
    "text": "what will happen so let's open the scan option in Windows Defender and navigate",
    "start": "1484679",
    "end": "1491360"
  },
  {
    "text": "to the Windows Event log uh",
    "start": "1491360",
    "end": "1496559"
  },
  {
    "text": "folder hitting scan and now the security event log file is considered as mimik",
    "start": "1496760",
    "end": "1502480"
  },
  {
    "text": "cat's malicious file so after reboot it will delete it with all the security event logs that you have on your",
    "start": "1502480",
    "end": "1509399"
  },
  {
    "text": "computer self cannibalism let's see how we trick Defender to delete its own log",
    "start": "1509399",
    "end": "1514799"
  },
  {
    "text": "on detection logs from a weak user so we started by creating a folder",
    "start": "1514799",
    "end": "1523640"
  },
  {
    "text": "um again running on latest Windows 11 machine of course and it we start by uh",
    "start": "1523640",
    "end": "1529039"
  },
  {
    "text": "creating a new folder and name it as a militia signature so we have a signature that suits a folder name let's put the",
    "start": "1529039",
    "end": "1536919"
  },
  {
    "text": "name as the folder and a Defender just jump in and say this ISS now it's",
    "start": "1536919",
    "end": "1544399"
  },
  {
    "text": "malicious and this activity will be added to Defender",
    "start": "1544399",
    "end": "1550399"
  },
  {
    "text": "logs file which if we now scan them we will see that it's now malicious so just",
    "start": "1550399",
    "end": "1557720"
  },
  {
    "text": "just a few seconds we will go into Defender logs files folder there it is and let's see how",
    "start": "1557720",
    "end": "1565080"
  },
  {
    "text": "many file it's not only one file actually it's many files that are now considered as malicious all the",
    "start": "1565080",
    "end": "1570240"
  },
  {
    "text": "detection logs that Defender has all the detection history will be deleted so it's a perfect way to um you know um",
    "start": "1570240",
    "end": "1578799"
  },
  {
    "text": "clean up evidence okay so now we understand that we can remotely delete logs but we can",
    "start": "1578799",
    "end": "1585880"
  },
  {
    "text": "achieve even more let me you a question what happens to logs in",
    "start": "1585880",
    "end": "1591000"
  },
  {
    "text": "Enterprises well as all rivers flow to the Sea all logs flow to a seim",
    "start": "1591000",
    "end": "1597240"
  },
  {
    "text": "database for example splank which is a central point to monitor search and",
    "start": "1597240",
    "end": "1602520"
  },
  {
    "text": "analyze logs let's see how we may trigger a domino effect against",
    "start": "1602520",
    "end": "1608679"
  },
  {
    "text": "Splunk so we started by verifying that by manually adding a log file with a",
    "start": "1608679",
    "end": "1614640"
  },
  {
    "text": "name that includes an evil signature SPL will write the name of the file to its",
    "start": "1614640",
    "end": "1620640"
  },
  {
    "text": "own database which will cause Defender to delete entire splank",
    "start": "1620640",
    "end": "1625919"
  },
  {
    "text": "DB the same goal can achieve automatically as a resulting of the domino effect when an in infected",
    "start": "1625919",
    "end": "1633039"
  },
  {
    "text": "Windows Event log file will be collected by splank it will be added to splank DB",
    "start": "1633039",
    "end": "1639120"
  },
  {
    "text": "which again cause Defender to delete it so think about it Spang DB completely",
    "start": "1639120",
    "end": "1644840"
  },
  {
    "text": "gone logs are definitely not the only thing that we can attack let's see two virtual machine attacks vectors that",
    "start": "1644840",
    "end": "1651679"
  },
  {
    "text": "done under VMware we started by taking a look on the v miix file of the guest machine",
    "start": "1651679",
    "end": "1658799"
  },
  {
    "text": "which is the configuration file of the VM this file is mandatory for the machine to boot up the machine cannot",
    "start": "1658799",
    "end": "1666159"
  },
  {
    "text": "boot up without it we wanted to check if the guest machine can write data to this",
    "start": "1666159",
    "end": "1671360"
  },
  {
    "text": "file in order to implant our malicious signature in this file we search SE for communication",
    "start": "1671360",
    "end": "1679000"
  },
  {
    "text": "originated from the guest machine to the host and after digging a little bit we found out the VMware tools provide a",
    "start": "1679000",
    "end": "1685640"
  },
  {
    "text": "tool called RPC tool this tool allows you to communicate with the host machine",
    "start": "1685640",
    "end": "1690880"
  },
  {
    "text": "one of the things that can be done with RPC tool is to set Global variables that some of them are like the guest info",
    "start": "1690880",
    "end": "1696640"
  },
  {
    "text": "detail data as you can see in the picture this these variables are kept in",
    "start": "1696640",
    "end": "1701960"
  },
  {
    "text": "the vmx file at the host machine so if I'll set this variable to malicious it",
    "start": "1701960",
    "end": "1708440"
  },
  {
    "text": "means that this file on the host machine will be malicious and maybe Defender will delete it let's",
    "start": "1708440",
    "end": "1714679"
  },
  {
    "text": "see so as you can see at the moment that I executing the command from this",
    "start": "1714679",
    "end": "1720960"
  },
  {
    "text": "terminal the machine is completely freeze and we get an error message that the vmix file is unavailable because",
    "start": "1720960",
    "end": "1726679"
  },
  {
    "text": "it's malicious which means that the guest machine cannot boot up again so it's complete do attack from the guest",
    "start": "1726679",
    "end": "1733960"
  },
  {
    "text": "machine but wait there is even more this is nice but it targets only the",
    "start": "1733960",
    "end": "1739200"
  },
  {
    "text": "configuration file what about targeting the virtual machine data itself is it",
    "start": "1739200",
    "end": "1745200"
  },
  {
    "text": "possible yes the answer is yes we did it by creating numerous amount of malicious",
    "start": "1745200",
    "end": "1751000"
  },
  {
    "text": "files as you can see in this demo and we write them into the disk so writing many",
    "start": "1751000",
    "end": "1756240"
  },
  {
    "text": "many many malicious files into the disk will cause those file to be written in the vmdk files which are files on the",
    "start": "1756240",
    "end": "1763039"
  },
  {
    "text": "host machine so in the host machine you have vmdk files that contains the data of the machine we are writing a lot of",
    "start": "1763039",
    "end": "1770200"
  },
  {
    "text": "malicious files into um this folder so I will put a one malicious files and this",
    "start": "1770200",
    "end": "1776039"
  },
  {
    "text": "script will just duplicate them a lot of time like 100,000 times and at the",
    "start": "1776039",
    "end": "1781720"
  },
  {
    "text": "moment it will end I will reboot the machine and let's see what will",
    "start": "1781720",
    "end": "1787279"
  },
  {
    "text": "happen so rebooting the machine actually I shut it down but it's the",
    "start": "1787279",
    "end": "1794158"
  },
  {
    "text": "same and Defender jumped in the host machine and saying that the vmdk files are",
    "start": "1794399",
    "end": "1800399"
  },
  {
    "text": "malicious so even if I will try to boot up the machine again it just won't work so in a case that someone is in the",
    "start": "1800399",
    "end": "1808039"
  },
  {
    "text": "guest machine and doing this action no one can H it can just get inside the",
    "start": "1808039",
    "end": "1813600"
  },
  {
    "text": "machine again now Tom will continue by talking",
    "start": "1813600",
    "end": "1819320"
  },
  {
    "text": "about remote deletion of production data bases so have you like it so far okay",
    "start": "1819320",
    "end": "1827440"
  },
  {
    "text": "okay thank you thank you thank you but we saved the best for last so",
    "start": "1827440",
    "end": "1835480"
  },
  {
    "text": "the crown jewels of most organization are not stored in files but rather in",
    "start": "1835480",
    "end": "1841159"
  },
  {
    "text": "databases right uh so only we only show you how to delete files can we also",
    "start": "1841159",
    "end": "1847799"
  },
  {
    "text": "remotely delete entire production database over the Internet let's see an",
    "start": "1847799",
    "end": "1852880"
  },
  {
    "text": "example usually user don't have privilege to directly insert a query to",
    "start": "1852880",
    "end": "1859600"
  },
  {
    "text": "a remote database but the scenario of a website using a database in the back end",
    "start": "1859600",
    "end": "1866399"
  },
  {
    "text": "is very common and if this database have if this website sorry has a form which",
    "start": "1866399",
    "end": "1873880"
  },
  {
    "text": "we can send data to to be stored in the DB for example registered a new user or",
    "start": "1873880",
    "end": "1880039"
  },
  {
    "text": "any other mean we can remotely trigger Defender to delete the database with no",
    "start": "1880039",
    "end": "1885320"
  },
  {
    "text": "authentication required and this is a very common attack Vector let's see a demo so in this demo we are going to",
    "start": "1885320",
    "end": "1892360"
  },
  {
    "text": "implant our own invoke mimicet signature into Maria DB database via a website",
    "start": "1892360",
    "end": "1899039"
  },
  {
    "text": "form and try to trigger Defender to delete the database let's start the",
    "start": "1899039",
    "end": "1904440"
  },
  {
    "text": "demo so this is just an example of a simple form that we created we will just",
    "start": "1904440",
    "end": "1911279"
  },
  {
    "text": "insert test signatures in order to see that it works we have a second page that",
    "start": "1911279",
    "end": "1916399"
  },
  {
    "text": "viewed the to content and we can see that the insertion succeeded right and",
    "start": "1916399",
    "end": "1921559"
  },
  {
    "text": "we'll do it again just to show it's working okay now we'll go to the",
    "start": "1921559",
    "end": "1927159"
  },
  {
    "text": "malicious part and we'll do it slowly but uh we will insert the name malicious",
    "start": "1927159",
    "end": "1934960"
  },
  {
    "text": "and in the middle we'll just put our simple signature and now we'll try to",
    "start": "1934960",
    "end": "1940360"
  },
  {
    "text": "view the database and we can see that it's worked it's inserted into the",
    "start": "1940360",
    "end": "1946080"
  },
  {
    "text": "database now we'll just keep doing like regular activities we will watch at",
    "start": "1946080",
    "end": "1954200"
  },
  {
    "text": "logs let's open a log file close it and just doing regular",
    "start": "1954200",
    "end": "1961919"
  },
  {
    "text": "stuff like viewing the port not changing it even just okay and boom Defender will",
    "start": "1961919",
    "end": "1968559"
  },
  {
    "text": "trigger and it will trigger a lot of default action and it detected it as",
    "start": "1968559",
    "end": "1974159"
  },
  {
    "text": "mimics and this is the database the entire database file is detected as mimicet because just one string so you",
    "start": "1974159",
    "end": "1981480"
  },
  {
    "text": "saw it's very short one the database may be terabytes of data Fender doesn't care",
    "start": "1981480",
    "end": "1987120"
  },
  {
    "text": "it delet all the all the database we try to reconnect denial of service uh okay",
    "start": "1987120",
    "end": "1994000"
  },
  {
    "text": "let's try to insert something I don't know let's see if we can like revive it in in any",
    "start": "1994000",
    "end": "2000720"
  },
  {
    "text": "way maybe no sorry uh not working so you",
    "start": "2000720",
    "end": "2008080"
  },
  {
    "text": "have permanent denial of service even if you do a service restart OS restart if",
    "start": "2008080",
    "end": "2014720"
  },
  {
    "text": "you have a backup you try to restore from backup won't work the database is gone you have a permanent denal of",
    "start": "2014720",
    "end": "2022720"
  },
  {
    "text": "service okay so we tried this attack on the most popular databases out",
    "start": "2022720",
    "end": "2029559"
  },
  {
    "text": "there and the attack work both on Windows and Linux as well I will show",
    "start": "2029559",
    "end": "2036159"
  },
  {
    "text": "you another example example against my SQL database and kasperski as the",
    "start": "2036159",
    "end": "2041200"
  },
  {
    "text": "vulnerable EDR this time so we running on",
    "start": "2041200",
    "end": "2048158"
  },
  {
    "text": "Linux we running MySQL we have a different form we will",
    "start": "2048159",
    "end": "2054000"
  },
  {
    "text": "test it in the same way we can see that it's at the",
    "start": "2054000",
    "end": "2059200"
  },
  {
    "text": "beginning it includes some records we will add our own this is just for testing you can see that it worked the",
    "start": "2059200",
    "end": "2066440"
  },
  {
    "text": "test f the test string is there now we'll copy our signature for",
    "start": "2066440",
    "end": "2073919"
  },
  {
    "text": "kasperski which works also for Defender and we can see that it was inserted automatically to the database and after",
    "start": "2073919",
    "end": "2081560"
  },
  {
    "text": "just a second kasperski detect the database as malicious let's try to",
    "start": "2081560",
    "end": "2088040"
  },
  {
    "text": "restore it first we'll try to see if it's working now it's not working",
    "start": "2088040",
    "end": "2094800"
  },
  {
    "text": "anymore you lose connection then we'll try to restore the",
    "start": "2094800",
    "end": "2101200"
  },
  {
    "text": "files and not working as well so what what can you do at that",
    "start": "2101240",
    "end": "2108400"
  },
  {
    "text": "point and let's try again to insert",
    "start": "2108680",
    "end": "2113760"
  },
  {
    "text": "something believe me it it won't",
    "start": "2113760",
    "end": "2118400"
  },
  {
    "text": "work and we'll also show you that the backend script cannot connect",
    "start": "2120040",
    "end": "2128119"
  },
  {
    "text": "and this is actually game",
    "start": "2128119",
    "end": "2132480"
  },
  {
    "text": "over okay so in the same way we were able to remotely delete postgress SQ",
    "start": "2133640",
    "end": "2140680"
  },
  {
    "text": "light and mongodb on both Linux and windows and we will release the Demos in",
    "start": "2140680",
    "end": "2147720"
  },
  {
    "text": "our GitHub repository all of them so imagine how many major website uses",
    "start": "2147720",
    "end": "2154720"
  },
  {
    "text": "those four different databases out ouder but until now we saw multiple",
    "start": "2154720",
    "end": "2161960"
  },
  {
    "text": "remote attacks vectors against servers and web services now we will demonstrate",
    "start": "2161960",
    "end": "2167520"
  },
  {
    "text": "the opposite attack when a web server can attack the client browser so this",
    "start": "2167520",
    "end": "2174599"
  },
  {
    "text": "time the attacko sends a link to the victim and when the victim clicks it his",
    "start": "2174599",
    "end": "2180200"
  },
  {
    "text": "browser will send an HTTP request to the malicious web server and the malicious",
    "start": "2180200",
    "end": "2185520"
  },
  {
    "text": "web server will return the signature in the response for example let's say in the cookie and then the browser will",
    "start": "2185520",
    "end": "2193200"
  },
  {
    "text": "loog the respond to its own DB and Defender will delete it so this is an",
    "start": "2193200",
    "end": "2198400"
  },
  {
    "text": "example of a remote deletion of Chrome history and web data databases just an",
    "start": "2198400",
    "end": "2205800"
  },
  {
    "text": "example we can do a lot more in this attack Vector as well so we believe that the 10 attack",
    "start": "2205800",
    "end": "2213280"
  },
  {
    "text": "vectors we have discovered are just the tip of the the iceberg and regarding",
    "start": "2213280",
    "end": "2219119"
  },
  {
    "text": "Cloud attacks literally the sky is not the limit since Defender is embedded in",
    "start": "2219119",
    "end": "2226440"
  },
  {
    "text": "multiple critical points in all major clouds vendors so imagine what can be",
    "start": "2226440",
    "end": "2232359"
  },
  {
    "text": "the damage there to conclude the vulnerability root",
    "start": "2232359",
    "end": "2237800"
  },
  {
    "text": "cause Windows Defender is in a catch22 syndrome it cannot it cannot allow a",
    "start": "2237800",
    "end": "2244079"
  },
  {
    "text": "marer to exist on the user endpoint but this can be used against it and the",
    "start": "2244079",
    "end": "2249880"
  },
  {
    "text": "reason for the false positive is because it relies on Legacy binary signature",
    "start": "2249880",
    "end": "2255160"
  },
  {
    "text": "detection which is sensitive for a small modification instead of machine learning",
    "start": "2255160",
    "end": "2261079"
  },
  {
    "text": "algorithms which consider multiple features and probably won't detect",
    "start": "2261079",
    "end": "2267240"
  },
  {
    "text": "MySQL special format database as a VBS marware",
    "start": "2267240",
    "end": "2272520"
  },
  {
    "text": "right so we reported to the relevant vendors uh at the beginning of the year and",
    "start": "2272520",
    "end": "2279280"
  },
  {
    "text": "Microsoft issued a fix to the vulnerability on April and assigned this cve ID the patch fixed some of the",
    "start": "2279280",
    "end": "2286400"
  },
  {
    "text": "attack vectors but even after the fix we were able to achieve remote deletion in",
    "start": "2286400",
    "end": "2292800"
  },
  {
    "text": "some of the attack vectors but not remote DB deletion so we reported once",
    "start": "2292800",
    "end": "2298560"
  },
  {
    "text": "again and Microsoft decided this time based on the left working attack Vector that it's a moderate denial of service",
    "start": "2298560",
    "end": "2306079"
  },
  {
    "text": "and May fix them at a later Point kaspi did not release a patch they do plan to",
    "start": "2306079",
    "end": "2313160"
  },
  {
    "text": "mitigate the attacks but currently as far as we know all attack vectors are",
    "start": "2313160",
    "end": "2318359"
  },
  {
    "text": "still possible this is the giup repository",
    "start": "2318359",
    "end": "2323680"
  },
  {
    "text": "where you can find our EDR racer tool we just release it now which support all",
    "start": "2323680",
    "end": "2329440"
  },
  {
    "text": "the attack vectors we have discovered and even allow you to expand them to a",
    "start": "2329440",
    "end": "2334720"
  },
  {
    "text": "new attack Vector easily so I'll wait few seconds to allow you to take a picture if you",
    "start": "2334720",
    "end": "2341839"
  },
  {
    "text": "want thank you thank you [Applause]",
    "start": "2344240",
    "end": "2352960"
  },
  {
    "text": "everyone",
    "start": "2352960",
    "end": "2355960"
  }
]