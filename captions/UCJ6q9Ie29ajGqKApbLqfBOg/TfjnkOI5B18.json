[
  {
    "text": "all right so this talk is going to be covering mobile application wrapping um",
    "start": "160",
    "end": "5480"
  },
  {
    "text": "this is relevant for BYOD um mobile application management deployment like",
    "start": "5480",
    "end": "10519"
  },
  {
    "text": "uh Solutions and we kind of ran into this um while we were doing some uh of",
    "start": "10519",
    "end": "15599"
  },
  {
    "text": "our own like testing for clients and then we did some of our own research on it so really it's a pretty cool",
    "start": "15599",
    "end": "21720"
  },
  {
    "text": "technology it's new um not a lot of research out there for it so we just thought it would be a cool thing to look",
    "start": "21720",
    "end": "27960"
  },
  {
    "text": "at so some high level um like things that",
    "start": "27960",
    "end": "34160"
  },
  {
    "text": "we're going to cover uh we're going to give do a quick overview of BYOD risks and uh threat scenarios and the reason",
    "start": "34160",
    "end": "41160"
  },
  {
    "text": "we're going to do this is just to get an idea of like what are some of the main risks when you're doing a BYOD I'm going",
    "start": "41160",
    "end": "48160"
  },
  {
    "text": "to assume everyone here knows bring your own device already so I'm not going to go into details with that but more of",
    "start": "48160",
    "end": "53719"
  },
  {
    "text": "like what are the the risks that an organization who's doing one of these deployments should consider um just so",
    "start": "53719",
    "end": "59519"
  },
  {
    "text": "we can stack that up all right we have these Solutions um different vendors different types of solutions how well do",
    "start": "59519",
    "end": "65400"
  },
  {
    "text": "these actually protect against those risks um then we do a quick comparison of you know there's typically two",
    "start": "65400",
    "end": "72640"
  },
  {
    "text": "approaches to BU there's like MDM and M MDM you know there's mobile device",
    "start": "72640",
    "end": "78000"
  },
  {
    "text": "management and then there's M mobile application management we'll we'll compare and contrast on why why why does",
    "start": "78000",
    "end": "84200"
  },
  {
    "text": "am exist what are some of the use cases for it um then we'll start getting into",
    "start": "84200",
    "end": "89640"
  },
  {
    "text": "some of the the more technical stuff and we'll talk about some solution some test cases that we did during our research um",
    "start": "89640",
    "end": "96600"
  },
  {
    "text": "and then dive into some of common vulnerability patterns that we found with different solutions um out there um",
    "start": "96600",
    "end": "103960"
  },
  {
    "text": "and lastly we'll we'll do some sort of conclusion talk about a testing checklist that you know we can all use",
    "start": "103960",
    "end": "109759"
  },
  {
    "text": "to help make these products more secure in the long run so uh a little bit more about the",
    "start": "109759",
    "end": "118280"
  },
  {
    "text": "research you know it's the uh you know the current there currently",
    "start": "118280",
    "end": "124039"
  },
  {
    "text": "there's like it's being used more and more by organizations and it's really cutting edge and I haven't seen any",
    "start": "124039",
    "end": "130679"
  },
  {
    "text": "research out there for it um so just something that you know we think that this should be looked at um and the",
    "start": "130679",
    "end": "139200"
  },
  {
    "text": "interesting thing is why isn't there a lot of research on it if you think about it a lot of these uh these commercial",
    "start": "139200",
    "end": "145800"
  },
  {
    "text": "Solutions are really hard to get your hands on um like either you assess these",
    "start": "145800",
    "end": "151560"
  },
  {
    "text": "things for clients who you know are really interested in you know getting these things tested to see if they're",
    "start": "151560",
    "end": "157200"
  },
  {
    "text": "secure or not or you have to somehow get it through like a demo and going through",
    "start": "157200",
    "end": "163000"
  },
  {
    "text": "these demo processes like it's pretty pretty annoying uh I know when I did uh",
    "start": "163000",
    "end": "169599"
  },
  {
    "text": "uh got access to one um you know you kind of got to go through like live demos with these guys and then you start",
    "start": "169599",
    "end": "176280"
  },
  {
    "text": "getting like invoice emails like every other day like hey are you guys ready to buy and I'm like no no not yet can I get",
    "start": "176280",
    "end": "182200"
  },
  {
    "text": "another extension for like another week and he still but then you know you have to pretend like you're interested in the product or else he'll never get your",
    "start": "182200",
    "end": "187920"
  },
  {
    "text": "hands on it um so you know we're getting doing the research is hard um so I have",
    "start": "187920",
    "end": "194799"
  },
  {
    "text": "a feeling that's probably why there's not a lot of um existing research for these types of",
    "start": "194799",
    "end": "200480"
  },
  {
    "text": "solutions um it builds on so last year at uh ABC uh USA I did some initial",
    "start": "200480",
    "end": "207040"
  },
  {
    "text": "research on secure containers just talking about some uh like ways they've been how they're implemented and some",
    "start": "207040",
    "end": "213200"
  },
  {
    "text": "common security bugs we saw so now we you know we're going to see this later on that um and these app wrapping",
    "start": "213200",
    "end": "219480"
  },
  {
    "text": "Solutions at the end of the day they are secure containers the goal is to protect the data they're storing these things in",
    "start": "219480",
    "end": "225439"
  },
  {
    "text": "Secure containers uh so a lot of that stuff applied for these but now we get to see it you know out in the real world",
    "start": "225439",
    "end": "231400"
  },
  {
    "text": "and how it worked in like commercial Solutions um",
    "start": "231400",
    "end": "239280"
  },
  {
    "text": "yeah um yeah so we just wanted to share some of the common vulnerability patterns um and kind of you know how can",
    "start": "241480",
    "end": "248120"
  },
  {
    "text": "we make these Solutions uh Stronger um and it's key key thing about this presentation is we're going to be vendor",
    "start": "248120",
    "end": "254439"
  },
  {
    "text": "agnostic so like I'm not going to be dropping names of any of the vendors we uh looked at um you know multiple",
    "start": "254439",
    "end": "261239"
  },
  {
    "text": "reasons you know we don't want to show preference for one vendor over another and I also don't want to have to you",
    "start": "261239",
    "end": "268400"
  },
  {
    "text": "know avoid see assist letters while I'm on stage um because I'm talking badly about a vendor um so I just just like",
    "start": "268400",
    "end": "275720"
  },
  {
    "text": "that picture I just want to hold hands and be friends with everyone but at the same time you know talk about like what",
    "start": "275720",
    "end": "281639"
  },
  {
    "text": "are some of the common vulnerabilities that we did find so so that you know we can make these Solutions",
    "start": "281639",
    "end": "288639"
  },
  {
    "text": "stronger so let's dive into some of the major BYOD risks um obviously if you're",
    "start": "288639",
    "end": "295120"
  },
  {
    "text": "doing BYOD your their employees are going to be using their own personal",
    "start": "295120",
    "end": "300280"
  },
  {
    "text": "device and they're going to be loading organization data on them so a lot of sensitive data there's emails contacts",
    "start": "300280",
    "end": "306520"
  },
  {
    "text": "your address book your calendars probably even like client certificates to authenticate through",
    "start": "306520",
    "end": "311960"
  },
  {
    "text": "some VPN and access internal apps Enterprise application storing sensitive documents or other type of type of data",
    "start": "311960",
    "end": "320360"
  },
  {
    "text": "so you know this one's pretty obvious right uh lost or stolen device if I'm able to steal your device and gain",
    "start": "320360",
    "end": "326759"
  },
  {
    "text": "access to that data you know that's bad um this should be some controls in place to prevent that from",
    "start": "326759",
    "end": "332479"
  },
  {
    "text": "happening um stolen device backup data you know that data that's stored on the",
    "start": "332479",
    "end": "338400"
  },
  {
    "text": "organization data is not always going to be on your device you know nowadays backups are stored in the cloud they can",
    "start": "338400",
    "end": "344520"
  },
  {
    "text": "be stored on your workstations when you're doing backups so you know while you're on your workstation you know",
    "start": "344520",
    "end": "350120"
  },
  {
    "text": "personal workstation at home that's probably not the most secure system out",
    "start": "350120",
    "end": "355400"
  },
  {
    "text": "there and there's a good chance you're like downloading you know Frozen from bit toring off some Chinese dude and you",
    "start": "355400",
    "end": "361960"
  },
  {
    "text": "don't you don't these systems are not made to be like secure it's your personal device you so having sensitive",
    "start": "361960",
    "end": "368479"
  },
  {
    "text": "data on it could be uh an issue uh disgruntled former employees",
    "start": "368479",
    "end": "374039"
  },
  {
    "text": "you know you have an employee works for your company one day he's gone the next day you know he might be angry got fired",
    "start": "374039",
    "end": "380880"
  },
  {
    "text": "um or you know just left there should be some security controls in place for an organization to say all right he's no",
    "start": "380880",
    "end": "387520"
  },
  {
    "text": "longer working for us even though he had data on his device there should be a way for me to wipe it uh for example and",
    "start": "387520",
    "end": "394560"
  },
  {
    "text": "prevent that device from accessing our networks malware malicious apps you know",
    "start": "394560",
    "end": "400680"
  },
  {
    "text": "it's your personal device if I'm side loading apps on my device or downloading stuff from the App Store there should be",
    "start": "400680",
    "end": "407080"
  },
  {
    "text": "no way for those applications to gain access to organization",
    "start": "407080",
    "end": "412599"
  },
  {
    "text": "data um unended devices you leave your phone there for a second I decide to",
    "start": "412599",
    "end": "418319"
  },
  {
    "text": "pick it up this should be controls in place that allow me to not be able to just open up the mail app or do whatever",
    "start": "418319",
    "end": "424120"
  },
  {
    "text": "on your device without actually having um you know this should be waste things around to prevent that from",
    "start": "424120",
    "end": "431000"
  },
  {
    "text": "happening bypassing client restrictions so there's going to be some forms of uh",
    "start": "431000",
    "end": "436560"
  },
  {
    "text": "client restrictions like maybe you don't want people uh running it on a jailbroken device or maybe you don't",
    "start": "436560",
    "end": "442680"
  },
  {
    "text": "want your employees doing like copy paste and putting it into some other thing or maybe you don't want you want",
    "start": "442680",
    "end": "448400"
  },
  {
    "text": "the at the the organization data to only be available in a certain app and not be",
    "start": "448400",
    "end": "454199"
  },
  {
    "text": "used outside of it malicious users on a network you know",
    "start": "454199",
    "end": "460039"
  },
  {
    "text": "you're at Starbucks doing whatever you do on your phone you know they should be",
    "start": "460039",
    "end": "465159"
  },
  {
    "text": "controls in place that ensures that the data is protected over the network um and then obviously with all",
    "start": "465159",
    "end": "471039"
  },
  {
    "text": "BYOD deployments since it is your mobile device talking to a server there are going to be some internet facing end",
    "start": "471039",
    "end": "477680"
  },
  {
    "text": "points those should be protected um out of scope for the for our research",
    "start": "477680",
    "end": "482800"
  },
  {
    "text": "we're mostly worried about uh focusing our research on just the client side of things so we we kind of eliminated",
    "start": "482800",
    "end": "489120"
  },
  {
    "text": "anything that's server based um from this research so the goal for buod is",
    "start": "489120",
    "end": "496520"
  },
  {
    "text": "essentially protect protect the data you know um and it's easy to say well maybe",
    "start": "496520",
    "end": "503080"
  },
  {
    "text": "you shouldn't you shouldn't be storing the data on the device but it's the real in the real world that's not feasible",
    "start": "503080",
    "end": "508680"
  },
  {
    "text": "you need to store the data um I need to have access to you know my email while",
    "start": "508680",
    "end": "514279"
  },
  {
    "text": "I'm underground or not not online like and just for like performance reasons",
    "start": "514279",
    "end": "519440"
  },
  {
    "text": "caching is around sto that data needs to persist on my device it's just it's",
    "start": "519440",
    "end": "525200"
  },
  {
    "text": "something that has to be done um and then there's the two approaches the MDM and M and the MDM is",
    "start": "525200",
    "end": "534720"
  },
  {
    "text": "the goal is to protect um to kind of manage the device but at the uh OS",
    "start": "534720",
    "end": "542040"
  },
  {
    "text": "device level so if I'm going to be setting policies it's going to be at the device level so if this this is your",
    "start": "542040",
    "end": "548160"
  },
  {
    "text": "personal device um if I'm going to set like a uh passcode policy for like eight",
    "start": "548160",
    "end": "555000"
  },
  {
    "text": "characters and time out for like three three minutes or something like that you",
    "start": "555000",
    "end": "560519"
  },
  {
    "text": "know this is going to affect your whole experience of using that device where am",
    "start": "560519",
    "end": "566360"
  },
  {
    "text": "the goal is to be at the app level so you can keep using your mobile device the way you always used it like if you",
    "start": "566360",
    "end": "574040"
  },
  {
    "text": "don't want to have a passcode on your device so be it since everything's being enforced at the app level um you can",
    "start": "574040",
    "end": "580720"
  },
  {
    "text": "enforce the policies there and there's a lot of uh B vendors",
    "start": "580720",
    "end": "588320"
  },
  {
    "text": "um so just so you have an idea of like what are some of the the big names you might actually like recognize some of",
    "start": "588320",
    "end": "594519"
  },
  {
    "text": "them and this shows like this is based off of the magic quadrant um and Enterprise Mobility management Suites by",
    "start": "594519",
    "end": "601440"
  },
  {
    "text": "uh Gartner and apparently this is like the deao thing that everyone like quotes in their U their white papers and like",
    "start": "601440",
    "end": "608480"
  },
  {
    "text": "their uh you know their their main site saying hey we're a market leader in bu",
    "start": "608480",
    "end": "615040"
  },
  {
    "text": "or whatever uh so essentially it's like a it's like a quadrant and anyone who's in the top right those are considered",
    "start": "615040",
    "end": "620560"
  },
  {
    "text": "the the top players by uh",
    "start": "620560",
    "end": "624399"
  },
  {
    "text": "Gartner so for MDM how is you know since it's all done at the uh device level you",
    "start": "627000",
    "end": "633079"
  },
  {
    "text": "know very high level overview I'm not going to spend a lot of time on it you know device does some enrollment to an",
    "start": "633079",
    "end": "638200"
  },
  {
    "text": "MDM server um from there the MDM server can push device level policies can do push",
    "start": "638200",
    "end": "644720"
  },
  {
    "text": "uh um push security commands to the device so those get uh invoked",
    "start": "644720",
    "end": "649959"
  },
  {
    "text": "immediately um query information from the device installed there bunch of other stuff that it can do and a lot of",
    "start": "649959",
    "end": "655920"
  },
  {
    "text": "this stuff is really dependent on the OS as well and what supports um there's a",
    "start": "655920",
    "end": "661920"
  },
  {
    "text": "lot of existing research in MDM U I think David who's right here uh did some stuff a couple years ago on MDM",
    "start": "661920",
    "end": "668399"
  },
  {
    "text": "especially for iOS and then earlier uh yesterday there was another presentation on mobile device mismanagement which",
    "start": "668399",
    "end": "674920"
  },
  {
    "text": "talked about a lot of the MDM stuff the main drawbacks um with MDM",
    "start": "674920",
    "end": "683120"
  },
  {
    "text": "which a couple of them I covered so there's the strict policies you know you're kind of hindering your personal",
    "start": "683120",
    "end": "689000"
  },
  {
    "text": "EXP experience when you're using these MDM if your organization is um doing",
    "start": "689000",
    "end": "694720"
  },
  {
    "text": "strict policies right um the implementation is OS dependent so depending on how the operating",
    "start": "694720",
    "end": "702839"
  },
  {
    "text": "system um what apis it exposes that's what the MDM server can actually enforce",
    "start": "702839",
    "end": "709000"
  },
  {
    "text": "so you know if it has something to install apps or remove apps or protect data in certain apps it all depends on",
    "start": "709000",
    "end": "715399"
  },
  {
    "text": "what it actually uh supports uh then there's some privacy",
    "start": "715399",
    "end": "720440"
  },
  {
    "text": "concerns you know like I'm giving this company now act the ability to wipe my",
    "start": "720440",
    "end": "726279"
  },
  {
    "text": "entire device at will um if I left the company how do I know if like what if",
    "start": "726279",
    "end": "732279"
  },
  {
    "text": "they decide a WIP mind device and I didn't want them to do that that's something I wouldn't want them to do um",
    "start": "732279",
    "end": "738760"
  },
  {
    "text": "and also they can query a lot of information from your device like installed apps you know if I have like",
    "start": "738760",
    "end": "745240"
  },
  {
    "text": "the new Kim Kardashian game installing my device I want to actually use it in my own privacy I don't want the C ad to",
    "start": "745240",
    "end": "752360"
  },
  {
    "text": "know that I'm actually running it um and data protection so like the",
    "start": "752360",
    "end": "757480"
  },
  {
    "text": "encryption it's not it's really hard to enforce how effective that encryption is going to be so let's use iOS for an",
    "start": "757480",
    "end": "764959"
  },
  {
    "text": "example what an organization can do is they can set a passcode uh policy you",
    "start": "764959",
    "end": "770639"
  },
  {
    "text": "know enforce passcode um and that'll turn on data protection and data protection can be used by apps on a",
    "start": "770639",
    "end": "777279"
  },
  {
    "text": "device however data protection is kind of like an opt in um especially before iOS 7 if a developer didn't use the",
    "start": "777279",
    "end": "784639"
  },
  {
    "text": "right apis and set the proper attributes that data would still be stored un encrypted um as of iOS 7 it now has a",
    "start": "784639",
    "end": "791920"
  },
  {
    "text": "little more strict um option but it's not the the most strong one like right",
    "start": "791920",
    "end": "797399"
  },
  {
    "text": "now I think the default is that it'll encrypt it with a key that's available once you enter your passcode once on",
    "start": "797399",
    "end": "803360"
  },
  {
    "text": "your device then it'll be persistent memory until then where the more secure option is the one that persists a key",
    "start": "803360",
    "end": "810560"
  },
  {
    "text": "but then when you go into a locked State it'll remove it from memory so it's you",
    "start": "810560",
    "end": "815959"
  },
  {
    "text": "kind of uh you know you're not getting that full uh encryption it's a little unsure you know if I'm running an old",
    "start": "815959",
    "end": "822600"
  },
  {
    "text": "iPad uh cuz I don't want to buy a new one for some reason that's going to be running iOS like five because I can't",
    "start": "822600",
    "end": "829120"
  },
  {
    "text": "upgrade anymore you can't really protect the data at that point so where does where does uh ma",
    "start": "829120",
    "end": "836920"
  },
  {
    "text": "come in so ma as I mentioned ear protection at the app layer um but it",
    "start": "836920",
    "end": "843600"
  },
  {
    "text": "requires development of like secure containers which could be a little tricky right and complex and it",
    "start": "843600",
    "end": "851199"
  },
  {
    "text": "leverages this um technology called like this call it application wrapping where",
    "start": "851199",
    "end": "856839"
  },
  {
    "text": "you you're you have these existing applications and I want to add security to these existing uh mobile apps and",
    "start": "856839",
    "end": "864920"
  },
  {
    "text": "that's what app wrapping is so here's a really high level overview so you have",
    "start": "864920",
    "end": "871279"
  },
  {
    "text": "um an organization might have like their own custom mail application their own custom uh calendar application and then",
    "start": "871279",
    "end": "878160"
  },
  {
    "text": "these are going to be the apps that you're going to be accessing your or data uh from and then an enter you might",
    "start": "878160",
    "end": "884680"
  },
  {
    "text": "actually have Enterprise apps you know your company might have their own you know custom apps that they developed",
    "start": "884680",
    "end": "890040"
  },
  {
    "text": "in-house that they want to deploy as well they all get wrapped suddenly you come out and now you can enforce policy",
    "start": "890040",
    "end": "896759"
  },
  {
    "text": "like you can enforce authentication you can enforce data encryption so on and so forth so just like that app icon got",
    "start": "896759",
    "end": "904480"
  },
  {
    "text": "injected with something um there's a these apps are getting injected with some uh some",
    "start": "904480",
    "end": "912079"
  },
  {
    "text": "security um so high level overview with some pictures because it's always",
    "start": "912160",
    "end": "917240"
  },
  {
    "text": "clearer with pictures um so you have an existing mobile app the solutions typically will",
    "start": "917240",
    "end": "924839"
  },
  {
    "text": "supply you with some form of a wrapping utility um and this wrapping utility",
    "start": "924839",
    "end": "930639"
  },
  {
    "text": "utility will uh inject uh some wrapping code and we'll go over in detail and how",
    "start": "930639",
    "end": "936959"
  },
  {
    "text": "what are some approaches to injecting into an existing application um so this is causing some",
    "start": "936959",
    "end": "942800"
  },
  {
    "text": "uh modification of the executables uh and then it'll have to resign the application and this",
    "start": "942800",
    "end": "949360"
  },
  {
    "text": "resigning is going to be with an Enterprise certificate um and why do we have to reassign it",
    "start": "949360",
    "end": "956000"
  },
  {
    "text": "obviously you just changed the executable it won't run on a mobile device unless you resign it again so now",
    "start": "956000",
    "end": "963600"
  },
  {
    "text": "you have this brand new resigned uh wrapped application um you're going to",
    "start": "963600",
    "end": "968720"
  },
  {
    "text": "upload it to some M um like management server um then the employees have their",
    "start": "968720",
    "end": "976880"
  },
  {
    "text": "mobile device they go to the App Store of their choice download agents A M",
    "start": "976880",
    "end": "982360"
  },
  {
    "text": "agent this is what I'm going to refer to it as throughout the presentation um you",
    "start": "982360",
    "end": "987759"
  },
  {
    "text": "log in usually with their active directory credentials or whatnot to this maam management server they might get",
    "start": "987759",
    "end": "994680"
  },
  {
    "text": "like you'll likely see like a store of oh what are some of the available apps that I can install or maybe they'll just",
    "start": "994680",
    "end": "1000880"
  },
  {
    "text": "get pushed down once you use the app but now from here this is where how the wrapped apps actually get pushed to your",
    "start": "1000880",
    "end": "1007279"
  },
  {
    "text": "device um and then all of these wrapped apps will then contain uh secure",
    "start": "1007279",
    "end": "1015199"
  },
  {
    "text": "containers so let's walk through uh an example of IOS app wrapping um so this is with u",
    "start": "1015199",
    "end": "1023079"
  },
  {
    "text": "one of the solutions and um I'm not going to say this is how it works for every solution this is just",
    "start": "1023079",
    "end": "1029000"
  },
  {
    "text": "one test case so we'll walk through how the process that we did you can probably apply it to whichever one if you ever",
    "start": "1029000",
    "end": "1035400"
  },
  {
    "text": "get around to it so what's the first step when you're trying to uh determine",
    "start": "1035400",
    "end": "1040558"
  },
  {
    "text": "the change what changed right with you know let's say something got patched you obviously get something the pre- patch",
    "start": "1040559",
    "end": "1046880"
  },
  {
    "text": "executable and the post patch executable diff them and you know where to start looking right so I did the same thing I",
    "start": "1046880",
    "end": "1053000"
  },
  {
    "text": "got a pre um pre-wrapped um like IPA file and then a",
    "start": "1053000",
    "end": "1058640"
  },
  {
    "text": "post wrapped IPA file and then open unzipped it compared the the executable",
    "start": "1058640",
    "end": "1065799"
  },
  {
    "text": "and then diffed them open opened it up in a hex dier tool point it out in in",
    "start": "1065799",
    "end": "1071760"
  },
  {
    "text": "red you know where where there was a change um executables in iOS they're",
    "start": "1071760",
    "end": "1076960"
  },
  {
    "text": "Maco executables so so I open it up in a nice Mao gooey go to the offset of where",
    "start": "1076960",
    "end": "1083200"
  },
  {
    "text": "the changes were and then you know that's going to point you in the right direction of all right this is where um",
    "start": "1083200",
    "end": "1089360"
  },
  {
    "text": "something changed like they modified some this portion of the binary so what was",
    "start": "1089360",
    "end": "1095480"
  },
  {
    "text": "changed uh they added in a new LC load uh dib uh command to it so this is just",
    "start": "1095480",
    "end": "1102159"
  },
  {
    "text": "adding in a brand new Dynamic library to the to the Maco executable so now every time you run that um application you",
    "start": "1102159",
    "end": "1110080"
  },
  {
    "text": "have code injection like immediately like you are able to like start running",
    "start": "1110080",
    "end": "1115679"
  },
  {
    "text": "code um and then they also added in the dynamic Library which is going to contain all of the code that they uh",
    "start": "1115679",
    "end": "1122240"
  },
  {
    "text": "they want to execute so we talked how are they actually adding the security",
    "start": "1122240",
    "end": "1127360"
  },
  {
    "text": "right this Dynamic library with Objective C at least you have the ability to do something called method",
    "start": "1127360",
    "end": "1132960"
  },
  {
    "text": "swizzling which is you can take an existing um implementation and kind of swap it for your own",
    "start": "1132960",
    "end": "1139480"
  },
  {
    "text": "implementation so let's say you have um application did begin launching or",
    "start": "1139480",
    "end": "1146320"
  },
  {
    "text": "whatever whatever that runs whenever IOS app starts right and I want to say I",
    "start": "1146320",
    "end": "1151919"
  },
  {
    "text": "don't want you I don't want to run this right away I want to run my own version where I can actually stop execution and",
    "start": "1151919",
    "end": "1157799"
  },
  {
    "text": "enforce authentication I can do that now um and then once you authenticate I'll just call the original function again so",
    "start": "1157799",
    "end": "1164559"
  },
  {
    "text": "that's how they achieve uh code execution and this kind of goes into play with um",
    "start": "1164559",
    "end": "1171559"
  },
  {
    "text": "how are they protect like adding crypto right if you think about it now you can do swizzling for pretty much any like",
    "start": "1171559",
    "end": "1178720"
  },
  {
    "text": "API right so let's say you have a NS file Handler and you're you're writing data to a file you can also Swizzle that",
    "start": "1178720",
    "end": "1186240"
  },
  {
    "text": "method and say all right don't just write to the file encrypt it before you write to the file and when you're going",
    "start": "1186240",
    "end": "1191799"
  },
  {
    "text": "to read it don't just read it decrypt it first and then read it um so this is how you're adding um kind of that Lo to",
    "start": "1191799",
    "end": "1199679"
  },
  {
    "text": "it and last but not least well actually not last but the other thing in the executable that changed was the code",
    "start": "1199679",
    "end": "1206039"
  },
  {
    "text": "signature which is what we expected or else it would never actually",
    "start": "1206039",
    "end": "1210960"
  },
  {
    "text": "run and then if we look at the info that pist file for the application and this",
    "start": "1211559",
    "end": "1217640"
  },
  {
    "text": "is like the main config file for iOS apps you can see that they defined the brand new URL scheme um so this this",
    "start": "1217640",
    "end": "1225039"
  },
  {
    "text": "creates kind of like a new entry point to your application that probably didn't",
    "start": "1225039",
    "end": "1230080"
  },
  {
    "text": "know it was there before but now it is surprise um but this is like the main way that the M agent the one that just",
    "start": "1230080",
    "end": "1237840"
  },
  {
    "text": "installed you onto the device and is the m agent should be like the considered like the brains of the operation this is",
    "start": "1237840",
    "end": "1244480"
  },
  {
    "text": "what's communicating with the server and like retrieving like commands like oh um",
    "start": "1244480",
    "end": "1250360"
  },
  {
    "text": "is there an updated policy or is there lock initiated or is there like a wipe initiated like it's listening like it's",
    "start": "1250360",
    "end": "1257320"
  },
  {
    "text": "pulling for these commands so it needs a way to transmit those commands over to",
    "start": "1257320",
    "end": "1263080"
  },
  {
    "text": "these wrapped apps so this entry point that it adds is the main thing to how",
    "start": "1263080",
    "end": "1268360"
  },
  {
    "text": "the M agent would actually uh start communication to those uh",
    "start": "1268360",
    "end": "1274720"
  },
  {
    "text": "apps how about Android Android um if we crack open the",
    "start": "1275559",
    "end": "1281240"
  },
  {
    "text": "the post uh wrapped APK file you can easily see that they've added some new",
    "start": "1281240",
    "end": "1287000"
  },
  {
    "text": "ndk uh Library so this is like native code um and then if you crack open um",
    "start": "1287000",
    "end": "1294640"
  },
  {
    "text": "you know you have the the Dex bite code you do like Dex to jar and then you can",
    "start": "1294640",
    "end": "1299960"
  },
  {
    "text": "decompile the jar code and then um uh get some readable Java code and this is",
    "start": "1299960",
    "end": "1305159"
  },
  {
    "text": "how you know step one of how to determine oh what changed all right I can look at the code and see what",
    "start": "1305159",
    "end": "1311440"
  },
  {
    "text": "changed um so I opened up the main activity for this sample app that we",
    "start": "1311440",
    "end": "1316760"
  },
  {
    "text": "wrote you know it's just a app doesn't really do much but I just wanted to see",
    "start": "1316760",
    "end": "1321880"
  },
  {
    "text": "how do they get how does it achieve code execution um so I go look look at it and",
    "start": "1321880",
    "end": "1327760"
  },
  {
    "text": "it's like um main activity extends activity which is what I had right but then if you actually scroll up over to",
    "start": "1327760",
    "end": "1334279"
  },
  {
    "text": "the import statements it's not calling the Android activity anymore it's now calling their version of an activity",
    "start": "1334279",
    "end": "1341840"
  },
  {
    "text": "which they just added on to the code and then if you look throughout the",
    "start": "1341840",
    "end": "1348279"
  },
  {
    "text": "code code um the code just consisted of bunch of test different ways you can write data right um and make requests",
    "start": "1348279",
    "end": "1355559"
  },
  {
    "text": "and all that stuff just I can test to see what was actually being wrapped and all a good chunk of like the common apis",
    "start": "1355559",
    "end": "1362080"
  },
  {
    "text": "they're all just swapped um this is pretty much implying that the Dex bite",
    "start": "1362080",
    "end": "1367480"
  },
  {
    "text": "code was actually modif like literally like modified like from whatever I had",
    "start": "1367480",
    "end": "1372600"
  },
  {
    "text": "as my uh like uh see what example like a",
    "start": "1372600",
    "end": "1377720"
  },
  {
    "text": "file right or the clipboard manager or my web view I didn't write that that's",
    "start": "1377720",
    "end": "1383840"
  },
  {
    "text": "that was totally changed at the bite code level and it's now calling their version of all that code so simple way",
    "start": "1383840",
    "end": "1390159"
  },
  {
    "text": "to actually um do this there there's like a library out there called ASM Dex",
    "start": "1390159",
    "end": "1395360"
  },
  {
    "text": "library and it just allows you to actually modify B uh Dex B code as",
    "start": "1395360",
    "end": "1401200"
  },
  {
    "text": "needed um so how about entry points um you open up the Manifest file and then",
    "start": "1401760",
    "end": "1406840"
  },
  {
    "text": "there's a large amount of uh additions to like the for entry points and",
    "start": "1406840",
    "end": "1413440"
  },
  {
    "text": "especially in Android since there's so many ways to do IPC there's like content providers activities Services broadcast",
    "start": "1413440",
    "end": "1420039"
  },
  {
    "text": "receivers and they pretty much added a little bit of everything up in",
    "start": "1420039",
    "end": "1425440"
  },
  {
    "text": "there so another high level overview right just so you get the big picture here in the in the M world you're going",
    "start": "1425440",
    "end": "1432679"
  },
  {
    "text": "to have your native apps you know your native uh mail app your calendar app",
    "start": "1432679",
    "end": "1438279"
  },
  {
    "text": "that that's for your personal use great but then for all the Enterprise data or",
    "start": "1438279",
    "end": "1443760"
  },
  {
    "text": "organization data you're going to have the M agent and then you're going to have wrapped managed apps so a custom",
    "start": "1443760",
    "end": "1449960"
  },
  {
    "text": "like a mail app um a wrapped document viewer app a wrapped address book",
    "start": "1449960",
    "end": "1455559"
  },
  {
    "text": "whatnot right and these are going to be secured these can enforce actual policies those can enforce data uh",
    "start": "1455559",
    "end": "1463240"
  },
  {
    "text": "protection um however you know what you and what you don't want is any scenario",
    "start": "1463240",
    "end": "1469360"
  },
  {
    "text": "where I can go from one of those wrapped apps out into a native app because now I",
    "start": "1469360",
    "end": "1474440"
  },
  {
    "text": "can't control that data",
    "start": "1474440",
    "end": "1477759"
  },
  {
    "text": "anymore so what are let's is a like a comparison right here",
    "start": "1480120",
    "end": "1486360"
  },
  {
    "text": "um uh so what are why why would someone use M over U MDM well the plus is you",
    "start": "1486360",
    "end": "1493360"
  },
  {
    "text": "get a little more um the device it personal experience is a lot little",
    "start": "1493360",
    "end": "1498679"
  },
  {
    "text": "better because you don't you don't need to enforce strict policy at the device level if I want to use Twitter whenever",
    "start": "1498679",
    "end": "1504000"
  },
  {
    "text": "with like a four digigit passcode and have access to it at all times and not have to unlock and enter my passcode all",
    "start": "1504000",
    "end": "1510640"
  },
  {
    "text": "the time I can do that but if I want to access organization data I'm probably going to have some strict policies just",
    "start": "1510640",
    "end": "1515880"
  },
  {
    "text": "to access those apps uh less privacy issues you can't query anything that you're not you know",
    "start": "1515880",
    "end": "1522440"
  },
  {
    "text": "as much as MDM does because now you're kind of restricted to the the sandbox and what it allows you to do",
    "start": "1522440",
    "end": "1530320"
  },
  {
    "text": "um and you can enforce uh security better because it's this is all custom stuff I if I want to enforce my uh",
    "start": "1530399",
    "end": "1538320"
  },
  {
    "text": "cryptography and my security I can do that because we can actually write it um",
    "start": "1538320",
    "end": "1544080"
  },
  {
    "text": "however it's like a double-edged sword right now you're dealing with custom",
    "start": "1544080",
    "end": "1549159"
  },
  {
    "text": "crypto implementations which everyone knows no one does right um custom IPC",
    "start": "1549159",
    "end": "1554320"
  },
  {
    "text": "implementations because there's a lot of IPC occurring between that m agent and",
    "start": "1554320",
    "end": "1559679"
  },
  {
    "text": "the the raft applications and um there's also like uh",
    "start": "1559679",
    "end": "1566080"
  },
  {
    "text": "the application experience you know you're used to using your native apps you know now you have to use like these",
    "start": "1566080",
    "end": "1571440"
  },
  {
    "text": "raft apps that might not be as good so there's that and then there's also like",
    "start": "1571440",
    "end": "1576760"
  },
  {
    "text": "these security commands um from our experiences you know they're not they don't have the ability to I'm they could",
    "start": "1576760",
    "end": "1583520"
  },
  {
    "text": "probably pull pull it off to do like push notification kind of thing but it's rarely ever seen so lot of times you",
    "start": "1583520",
    "end": "1588919"
  },
  {
    "text": "have to deal with some of the OS level restrictions and have an application running and then pull to the server to",
    "start": "1588919",
    "end": "1595000"
  },
  {
    "text": "see if there's a new command and when you're dealing with like device wipes and all that stuff you kind of want those those to trigger um",
    "start": "1595000",
    "end": "1603960"
  },
  {
    "text": "immediately so let's talk about like some of the security uh checks we're going to be doing um we're we're going",
    "start": "1605120",
    "end": "1610880"
  },
  {
    "text": "to look at some of the like uh container authentication um the",
    "start": "1610880",
    "end": "1616240"
  },
  {
    "text": "cryptography uh the completeness of the secure container so when I say completeness what that means is um you",
    "start": "1616240",
    "end": "1624440"
  },
  {
    "text": "know you're doing app wrapping you've got your cryptography great but like how do how how effective is that",
    "start": "1624440",
    "end": "1632080"
  },
  {
    "text": "cryptography at encrypting everything that needs to be encrypted like maybe if I use one API it encrypts but if I use",
    "start": "1632080",
    "end": "1638880"
  },
  {
    "text": "this other API which they forgot about then it won't be encrypted so like testing how how effective that is um the",
    "start": "1638880",
    "end": "1646120"
  },
  {
    "text": "IPC how that's implemented to ensure to that another app can get access to it um",
    "start": "1646120",
    "end": "1652039"
  },
  {
    "text": "the effectiveness of the security commands so if I issue wipes how effective uh would that be and then um",
    "start": "1652039",
    "end": "1659760"
  },
  {
    "text": "policy configuration features like what what policies does a server actually have available to uh to us to actually",
    "start": "1659760",
    "end": "1667159"
  },
  {
    "text": "you know uh protect us from like some of the the BYOD risks um we're actually going to skip",
    "start": "1667159",
    "end": "1673200"
  },
  {
    "text": "over the policy configuration stuff we'll include that in the white paper because there's a lot of cool stuff to",
    "start": "1673200",
    "end": "1679399"
  },
  {
    "text": "cover that that's kind of boring all right so let's go into some",
    "start": "1679399",
    "end": "1685080"
  },
  {
    "text": "actual bug stuff um so when I think of like a secure container I like to think",
    "start": "1685080",
    "end": "1691880"
  },
  {
    "text": "of it like as long there's like three principles where if you break one of these you probably have a broken",
    "start": "1691880",
    "end": "1698679"
  },
  {
    "text": "solution um so all data um stored stored by the app should be encrypted",
    "start": "1698679",
    "end": "1705200"
  },
  {
    "text": "seamlessly um the strength of the crypto should never rely on any device level",
    "start": "1705200",
    "end": "1710279"
  },
  {
    "text": "policy and uh crypto Keys must only be retrievable after or or derived after",
    "start": "1710279",
    "end": "1716320"
  },
  {
    "text": "you've fully authenticated so let's dive into um one",
    "start": "1716320",
    "end": "1722760"
  },
  {
    "text": "a a vulnerability pattern here so we're doing some reversing of a of a solution",
    "start": "1722760",
    "end": "1729519"
  },
  {
    "text": "right um we're going through the the logic of the authentication and then it",
    "start": "1729519",
    "end": "1734799"
  },
  {
    "text": "we determined that the actual like passcode that you",
    "start": "1734799",
    "end": "1739880"
  },
  {
    "text": "entered on the device wasn't used to actually derive the encryption key protecting the data so what that means",
    "start": "1739880",
    "end": "1747600"
  },
  {
    "text": "is that all the key material stored on the device was stored like all the key material used to protect the data was",
    "start": "1747600",
    "end": "1753519"
  },
  {
    "text": "stored on the device as well um so the offline like authentication logic you",
    "start": "1753519",
    "end": "1759720"
  },
  {
    "text": "know if I'm trying to get access to a document Offline that was all like client side logic and as you can imagine",
    "start": "1759720",
    "end": "1765320"
  },
  {
    "text": "that can always be bypassed um and it violates principles two and",
    "start": "1765320",
    "end": "1771559"
  },
  {
    "text": "three and kind of makes this solution no provides you no real protection at all",
    "start": "1771559",
    "end": "1777159"
  },
  {
    "text": "it's just aisc at that point you're storing something encrypted but you're storing the keys like right next to it",
    "start": "1777159",
    "end": "1782799"
  },
  {
    "text": "so it's um makes no sense so let's walk through how this",
    "start": "1782799",
    "end": "1789240"
  },
  {
    "text": "could be actually exploited right there's multiple ways to go about this you know I could go and try to reverse",
    "start": "1789240",
    "end": "1796039"
  },
  {
    "text": "the key derivation logic or oh did you get the data from here that data that data put them together hash them and",
    "start": "1796039",
    "end": "1803200"
  },
  {
    "text": "then you suddenly got a key and then you decrypted it there's a lot of work to try to figure all that out so we we took",
    "start": "1803200",
    "end": "1809200"
  },
  {
    "text": "a little shortcut here um there's uh so we wrote a test app",
    "start": "1809200",
    "end": "1815840"
  },
  {
    "text": "just writes this line this is just some plain text Data um and then wrot wrote",
    "start": "1815840",
    "end": "1821320"
  },
  {
    "text": "it using the right to file iOS method which is just common and I'm expecting",
    "start": "1821320",
    "end": "1827279"
  },
  {
    "text": "this to be wrapped and stored encrypted on the device um so it's wrapped install",
    "start": "1827279",
    "end": "1833559"
  },
  {
    "text": "the device run the app you know ssh in um to my iPad cat it out to make sure",
    "start": "1833559",
    "end": "1841200"
  },
  {
    "text": "it's actually stored encrypted I see gobleg I'm like all right looks legit",
    "start": "1841200",
    "end": "1846760"
  },
  {
    "text": "next um so then I you know the approach we took for this is you know if I'm able",
    "start": "1846760",
    "end": "1853159"
  },
  {
    "text": "to in um inject into the running process I can start",
    "start": "1853159",
    "end": "1858679"
  },
  {
    "text": "actually um kind of maybe leveraging that wrapping code um so I can just like",
    "start": "1858679",
    "end": "1864120"
  },
  {
    "text": "inject into it and read that file and then I'm assuming that once I try to",
    "start": "1864120",
    "end": "1869480"
  },
  {
    "text": "read that file my read will actually be wrapped as well and it'll just decrypt",
    "start": "1869480",
    "end": "1874639"
  },
  {
    "text": "the file for me without me having to do any reverse engineering whatsoever so I use Crypt for this for",
    "start": "1874639",
    "end": "1881320"
  },
  {
    "text": "iOS um sure if you want to learn more about it you can look at the 20,000",
    "start": "1881320",
    "end": "1886440"
  },
  {
    "text": "presentations that talk about it um it's really simple it's like a mixture weird mixture of like JavaScript",
    "start": "1886440",
    "end": "1893639"
  },
  {
    "text": "and Objective C so I just wrote a simple uh script that just tries to read that file using the NS file Handler um object",
    "start": "1893639",
    "end": "1903200"
  },
  {
    "text": "and um hopefully that gets wrapped right and to like add a little kicker to this",
    "start": "1903200",
    "end": "1908399"
  },
  {
    "text": "you know even if you were to trigger like a enter the app in a lock state so I don't like I'm currently not",
    "start": "1908399",
    "end": "1914519"
  },
  {
    "text": "authenticated to the app I need to authenticate I can still just the process is still running right so I can",
    "start": "1914519",
    "end": "1921279"
  },
  {
    "text": "just um use site uh get the process ID for the process and then uh use Crypt",
    "start": "1921279",
    "end": "1926720"
  },
  {
    "text": "run my script and then I can retrieve back a plain text version of that data without doing any reversing whatsoever",
    "start": "1926720",
    "end": "1934240"
  },
  {
    "text": "well other than figuring finding the bug to begin with another common pattern for",
    "start": "1934240",
    "end": "1941480"
  },
  {
    "text": "authentication is like the decoupling of the passcode verification and the key derivation derivation",
    "start": "1941480",
    "end": "1948480"
  },
  {
    "text": "um so what that means is you know you might have like an offline passcode um",
    "start": "1948480",
    "end": "1953600"
  },
  {
    "text": "prompt and then to access your data right you might be deriving the actual",
    "start": "1953600",
    "end": "1958799"
  },
  {
    "text": "encryption key properly you're you're you're doing like pbkdf2 with 20,000 iterations with like secure salt doing",
    "start": "1958799",
    "end": "1965320"
  },
  {
    "text": "doing the whole bag of tricks right but like there might be some logic before that key derivation where it's actually",
    "start": "1965320",
    "end": "1972679"
  },
  {
    "text": "you know doing some sort of uh like a check some like it's trying to validate where that passcode is correct before it",
    "start": "1972679",
    "end": "1978919"
  },
  {
    "text": "starts deriving a key um so this is like a common bug that we found where the key derivation is probably",
    "start": "1978919",
    "end": "1985960"
  },
  {
    "text": "could be strong but then you have this really weak um passcode verification",
    "start": "1985960",
    "end": "1991559"
  },
  {
    "text": "that I can now use that logic to actually Brute Force instead of brute forcing the key derivation so we found",
    "start": "1991559",
    "end": "1998159"
  },
  {
    "text": "one uh bug where they were doing an unsalted shot 256 um as that passcode verification",
    "start": "1998159",
    "end": "2005440"
  },
  {
    "text": "which is pretty terrible considering um not all solutions do this but sometimes",
    "start": "2005440",
    "end": "2011080"
  },
  {
    "text": "Enterprises actually use their active directory credentials as the passcode to their M um uh devices because they have",
    "start": "2011080",
    "end": "2019679"
  },
  {
    "text": "those accounts they have those passcodes already um they're maintained already and it's just so they don't have to",
    "start": "2019679",
    "end": "2026080"
  },
  {
    "text": "memorize multiple passcodes so if I'm able to steal your device and do this really quick offline Brute Force because",
    "start": "2026080",
    "end": "2032519"
  },
  {
    "text": "it's unsalted shot 256 and get access to your active directory that's pretty ter",
    "start": "2032519",
    "end": "2039720"
  },
  {
    "text": "um so here's just like some output we just we found this um seed hash in like",
    "start": "2041000",
    "end": "2046120"
  },
  {
    "text": "a config file and then using some like uh straight up python you're able to just verify whether my passcode matches",
    "start": "2046120",
    "end": "2053679"
  },
  {
    "text": "it and it does uh let's get into some crypto",
    "start": "2053679",
    "end": "2060560"
  },
  {
    "text": "stuff so crypto's really hard um and there's so many ways to do",
    "start": "2060560",
    "end": "2066919"
  },
  {
    "text": "it wrong and it all depends you know what algorithms you're using what modes you're using like there's just different types of attacks for different types of",
    "start": "2066919",
    "end": "2073398"
  },
  {
    "text": "crypto and it's you know I'm not going to cover it right now because that you can have like I'll take a whole class",
    "start": "2073399",
    "end": "2079280"
  },
  {
    "text": "for a whole semester just covering these things but I'm going to discuss why",
    "start": "2079280",
    "end": "2084398"
  },
  {
    "text": "these are going to be common right so what we've found is that you know the the de facto library to use in these",
    "start": "2084399",
    "end": "2092040"
  },
  {
    "text": "Solutions typically open SSL so you're always going to see like this open SSL",
    "start": "2092040",
    "end": "2097400"
  },
  {
    "text": "um low like um Native Library um injected right and why do they use open",
    "start": "2097400",
    "end": "2104560"
  },
  {
    "text": "SSL because it's fips compliant and you can say all right Chuck Chuck Chuck Chuck and fips compliant Right add it to",
    "start": "2104560",
    "end": "2111440"
  },
  {
    "text": "my white paper I'm good to go but the problem is that with OP SSL it's not really a highlevel library like maybe if",
    "start": "2111440",
    "end": "2117880"
  },
  {
    "text": "you're familiar with like kizar or something like that where tries to eliminate some of the difficulties of crypto from like",
    "start": "2117880",
    "end": "2124000"
  },
  {
    "text": "developers um you know it tries to do things as right as a can or knows how to",
    "start": "2124000",
    "end": "2130160"
  },
  {
    "text": "with open as a cell you're working with pretty lowlevel uh stuff right now and there's a high potential of having",
    "start": "2130160",
    "end": "2136480"
  },
  {
    "text": "implementation flaws when you're doing that",
    "start": "2136480",
    "end": "2142720"
  },
  {
    "text": "um what I will talk about is um one interesting kind of bug that we' found",
    "start": "2144440",
    "end": "2150160"
  },
  {
    "text": "in in the solutions but uh that I really don't see haven't really seen other people talk about so I guess I'll talk",
    "start": "2150160",
    "end": "2156319"
  },
  {
    "text": "about it um so let's let's think of this scenario",
    "start": "2156319",
    "end": "2161800"
  },
  {
    "text": "right you have this master key right you know I I'm telling you don't store it as",
    "start": "2161800",
    "end": "2166960"
  },
  {
    "text": "a string object um but keep a and you're commonly going to see this though",
    "start": "2166960",
    "end": "2172040"
  },
  {
    "text": "because I've seen solutions that leverage SQL Cipher um to do some of",
    "start": "2172040",
    "end": "2177200"
  },
  {
    "text": "like their sqlite encryption um and the problem with like SQL Cipher is that like if you look at",
    "start": "2177200",
    "end": "2183440"
  },
  {
    "text": "the the function there the second parameter that's going to be the the P code that's going to use to actually you",
    "start": "2183440",
    "end": "2189480"
  },
  {
    "text": "know protect that that derive a encryption key and protect that data right um so now you know you're you're",
    "start": "2189480",
    "end": "2197359"
  },
  {
    "text": "passing in some secret um as a string and there's a high potential that",
    "start": "2197359",
    "end": "2202400"
  },
  {
    "text": "they're probably going to reuse the same master key that's used to protect all the data as that value so what's the the",
    "start": "2202400",
    "end": "2209079"
  },
  {
    "text": "risks here right um storing is a string you know there's a good chance it might be stored in the Heap and then if it's",
    "start": "2209079",
    "end": "2215040"
  },
  {
    "text": "on the Heap there's a good chance that it'll persist for a pretty long time due",
    "start": "2215040",
    "end": "2220319"
  },
  {
    "text": "to like garbage collection not happening very quickly um and for my own testing I've done this for like 15 minutes or so",
    "start": "2220319",
    "end": "2226400"
  },
  {
    "text": "and it still persists in memory um but another cool bug which I'll talk about is more of like this uh character",
    "start": "2226400",
    "end": "2233760"
  },
  {
    "text": "encoding a subtle bug that can like kill the",
    "start": "2233760",
    "end": "2238800"
  },
  {
    "text": "entropy uh so here's like some code that we got from like an offis gated um",
    "start": "2238800",
    "end": "2245040"
  },
  {
    "text": "solution um you know the the cool thing about the sure you can offis skate a lot",
    "start": "2245040",
    "end": "2251240"
  },
  {
    "text": "of the the custom code but then you're never going to be able to off offis skate kind of like pbk the PB uh e key",
    "start": "2251240",
    "end": "2258079"
  },
  {
    "text": "speec library because that's like kind of built into um Android so that kind of",
    "start": "2258079",
    "end": "2263200"
  },
  {
    "text": "it's if you're trying to like figure out how to hit these sweet spots you know there's a good chance they're probably",
    "start": "2263200",
    "end": "2268800"
  },
  {
    "text": "going to be using this to derive an encryption key so you can just search for these in the code and be like all right this is where the Magic's",
    "start": "2268800",
    "end": "2274880"
  },
  {
    "text": "happening all right so we look at it and we're like oh okay they got 20,000 iterations the they're taking in the",
    "start": "2274880",
    "end": "2281760"
  },
  {
    "text": "first two parameters and they're they're going to be using that as like a salt and the something else and they're",
    "start": "2281760",
    "end": "2288119"
  },
  {
    "text": "creating a 256 uh bit key that's going to then be assigned to an array of byte",
    "start": "2288119",
    "end": "2294880"
  },
  {
    "text": "um variable and then uh array of bytes and then um the return value is is just",
    "start": "2294880",
    "end": "2301760"
  },
  {
    "text": "passing it into a string Okay so",
    "start": "2301760",
    "end": "2308800"
  },
  {
    "text": "let's look at um you know one of the approaches that I take when I'm dealing with like office gated code and trying",
    "start": "2310319",
    "end": "2315920"
  },
  {
    "text": "to reverse these Solutions is I use like sub mobile substrate which I'm not going to go into details because it take like",
    "start": "2315920",
    "end": "2322359"
  },
  {
    "text": "20 minutes but if you know if you look at my old presentation I talk about it more but approaches I I take is I find",
    "start": "2322359",
    "end": "2329280"
  },
  {
    "text": "interesting functions I hook them print out the parameters um if it's op",
    "start": "2329280",
    "end": "2334560"
  },
  {
    "text": "fiscated there's a cool trick that lets you um that I used to just it's kind of",
    "start": "2334560",
    "end": "2339839"
  },
  {
    "text": "like a if you use like GDB you need like a BT but it kind of like I just throw a stack trace and just print it out just",
    "start": "2339839",
    "end": "2346040"
  },
  {
    "text": "so I can get a call flow of the application be like all right uh I just hooked this but now I know exactly you",
    "start": "2346040",
    "end": "2352560"
  },
  {
    "text": "know what call that and then what call that and I can get an idea of like what's the the flow without having to go",
    "start": "2352560",
    "end": "2358160"
  },
  {
    "text": "crazy on the officiated code searching like all right what called fe. E.Z and then oh that got called by A.G by you",
    "start": "2358160",
    "end": "2366079"
  },
  {
    "text": "know it's a lot less confusing um so first you know I print out the",
    "start": "2366079",
    "end": "2371920"
  },
  {
    "text": "parameters it takes in my passcode it takes in uh some really long value it's probably like",
    "start": "2371920",
    "end": "2377800"
  },
  {
    "text": "assault um then I have my my call Flow that I can use to do additional",
    "start": "2377800",
    "end": "2384880"
  },
  {
    "text": "reversing and then at the bottom you'll see that in red text is the return value",
    "start": "2384880",
    "end": "2390200"
  },
  {
    "text": "so let's let's look at what the return value is and um what's interesting about",
    "start": "2390200",
    "end": "2396359"
  },
  {
    "text": "this is that what what the hell are these efb fbds that are all up in my uh",
    "start": "2396359",
    "end": "2401680"
  },
  {
    "text": "master key now and the problem is that when if we go",
    "start": "2401680",
    "end": "2408000"
  },
  {
    "text": "back and look at what the return value is it took that that uh that uh the",
    "start": "2409240",
    "end": "2415240"
  },
  {
    "text": "derived key and that that's going to contain the full bite range of uh that's",
    "start": "2415240",
    "end": "2420440"
  },
  {
    "text": "possible and then it's going to be set to the string value right and the interesting thing is that for Android",
    "start": "2420440",
    "end": "2427079"
  },
  {
    "text": "and this applies to pretty much anything but for Android it's going to uh the default Char set is utf8 so a lot of the",
    "start": "2427079",
    "end": "2434319"
  },
  {
    "text": "the the bite values that are coming out are not going to be supported by utf8 so what it does is it's like oh I don't",
    "start": "2434319",
    "end": "2440680"
  },
  {
    "text": "support this character I'm just going to assign this new one replacement Char and",
    "start": "2440680",
    "end": "2445760"
  },
  {
    "text": "that's efb fbd so what essentially What's Happening Here is that you're killing the entropy of that Master",
    "start": "2445760",
    "end": "2451440"
  },
  {
    "text": "string uh master key um in this case it went from like 32 bytes to 22 bytes but",
    "start": "2451440",
    "end": "2457680"
  },
  {
    "text": "if you think about it you know it all depends on what the output of pbkdf2 is going to be and that could range from",
    "start": "2457680",
    "end": "2464839"
  },
  {
    "text": "pretty much anything it's like random right um and if you're dealing with like uh you know this one's like 256 bit but",
    "start": "2464839",
    "end": "2471240"
  },
  {
    "text": "if you're dealing with like 128 bit keys and you start killing a lot of this entropy you know now it's getting to uh",
    "start": "2471240",
    "end": "2478680"
  },
  {
    "text": "scenarios where you know some of these issues can uh potentially be suceptible to like",
    "start": "2478680",
    "end": "2485640"
  },
  {
    "text": "attacks um in complete secure containers so everything that is um",
    "start": "2485680",
    "end": "2491880"
  },
  {
    "text": "supposed to be encrypted should be encrypted so what is our what was our approach to finding these types of",
    "start": "2491880",
    "end": "2497000"
  },
  {
    "text": "issues we developed the test harness you know we cracked open uh documentation",
    "start": "2497000",
    "end": "2502880"
  },
  {
    "text": "looked at at the all the apis and we're like all right this probably writes some data this writes data that might cach",
    "start": "2502880",
    "end": "2508920"
  },
  {
    "text": "data that caches data and we just wrote test harness applications and then got them wrapped and then we see what what",
    "start": "2508920",
    "end": "2515400"
  },
  {
    "text": "got stored in PL text what didn't so let's walk through some of the common",
    "start": "2515400",
    "end": "2521000"
  },
  {
    "text": "apis that we saw that were missed so for iOS um we saw that keychain stuff",
    "start": "2521000",
    "end": "2527520"
  },
  {
    "text": "typically weren't uh wrapped um why why it wasn't wrapped I'm not sure maybe",
    "start": "2527520",
    "end": "2532640"
  },
  {
    "text": "they think that keychain is secure already but if you're not relying on device level policies the keychain you",
    "start": "2532640",
    "end": "2539960"
  },
  {
    "text": "know if you can't enforce passcode on the device level the keychain is not very secure NS user defaults which um",
    "start": "2539960",
    "end": "2547800"
  },
  {
    "text": "kind of surprised but uh it's pretty bad because you know four out of 10 pentests",
    "start": "2547800",
    "end": "2553720"
  },
  {
    "text": "you know I see that people that's like a go-to place for people to store their credentials apparently but so them not",
    "start": "2553720",
    "end": "2561280"
  },
  {
    "text": "protecting NSU or defaults would be an issue iCloud apis um interesting about",
    "start": "2561280",
    "end": "2566960"
  },
  {
    "text": "iCloud apis you're writing data directly to the iCloud but it stores a cast version of it on the device as well",
    "start": "2566960",
    "end": "2575160"
  },
  {
    "text": "maybe they didn't take that into consideration um so they they just didn't encrypt it",
    "start": "2575160",
    "end": "2580960"
  },
  {
    "text": "um with Objective C you can write in line C or C++ and then um so if I was to",
    "start": "2580960",
    "end": "2587640"
  },
  {
    "text": "write an app and then decide I don't want to use Objective C I'm cool I'm going to write use f right and write my",
    "start": "2587640",
    "end": "2593160"
  },
  {
    "text": "data that way then that data would be stored unencrypted even though it was wrapped uh web views you know you got",
    "start": "2593160",
    "end": "2599839"
  },
  {
    "text": "HTML 5 you got a SQL light data local storage all that stuff this might be common to see that those they didn't",
    "start": "2599839",
    "end": "2606720"
  },
  {
    "text": "take those into consideration persistent HTTP cookies you know you're creating an Sul request",
    "start": "2606720",
    "end": "2614200"
  },
  {
    "text": "and then suddenly a persistent cookie gets set by your main organization's SSO",
    "start": "2614200",
    "end": "2619400"
  },
  {
    "text": "server service the that persistent cookie which is like the keys to the kingdom could be stored in plain text",
    "start": "2619400",
    "end": "2627599"
  },
  {
    "text": "um document caching so when I say document cache I'm talking about you probably use uh iOS right you open up a",
    "start": "2627599",
    "end": "2635200"
  },
  {
    "text": "file gives you an option open in you can pick which app you want to use it the moment you pick another app a copy of",
    "start": "2635200",
    "end": "2642119"
  },
  {
    "text": "that file gets made to that other app just to bypass kind of like the sandbox restrictions so copy gets made behind",
    "start": "2642119",
    "end": "2649119"
  },
  {
    "text": "the scenes um we found that that copied file never gets encrypted and stored",
    "start": "2649119",
    "end": "2655359"
  },
  {
    "text": "properly so there's another thing to look at and file names we'll we'll talk about a cool thing about file names and",
    "start": "2655359",
    "end": "2662520"
  },
  {
    "text": "why that could potentially be an issue but like one thing off the top of my head is you know one of the most common",
    "start": "2662520",
    "end": "2669319"
  },
  {
    "text": "apps are going to be like a mail app for example right and what mail apps have file attachments and it's good chance",
    "start": "2669319",
    "end": "2675920"
  },
  {
    "text": "those file attachments will likely contain sensitive data how about Android some stuff we saw",
    "start": "2675920",
    "end": "2683400"
  },
  {
    "text": "where like file system um ndk was was never wrapped um an interesting bug that",
    "start": "2683400",
    "end": "2690680"
  },
  {
    "text": "we ran into uh was like um uh symbolic links so like this one",
    "start": "2690680",
    "end": "2697160"
  },
  {
    "text": "was pretty interesting where they had some logic where depending on the symbolic link it'll decide to encrypt it",
    "start": "2697160",
    "end": "2703200"
  },
  {
    "text": "or not and then they forgot like SL SD card so that's like the worst possible place on an Android device to could",
    "start": "2703200",
    "end": "2709359"
  },
  {
    "text": "store data because there's no file system permissions and it's a external media um and the worst thing is that",
    "start": "2709359",
    "end": "2716720"
  },
  {
    "text": "since they're not encrypting it they have no idea that it was was actually stored there so if you were to do like a",
    "start": "2716720",
    "end": "2722119"
  },
  {
    "text": "remote wipe that data would still stay on that SD card and never get wiped",
    "start": "2722119",
    "end": "2728559"
  },
  {
    "text": "um web views um any sort of like reflection where you can run commands like do runtime exact to write to a file",
    "start": "2728559",
    "end": "2735640"
  },
  {
    "text": "or do like Java Reflection those wouldn't be protected and uh file names",
    "start": "2735640",
    "end": "2740800"
  },
  {
    "text": "as well how about IPC so IPC relies he like",
    "start": "2740800",
    "end": "2748040"
  },
  {
    "text": "this solution relies heavily on IPC and I talked about that earlier right what kind type of data is being passed",
    "start": "2748040",
    "end": "2753880"
  },
  {
    "text": "between these the IPC there going to be policy so updates to policy saying all",
    "start": "2753880",
    "end": "2759119"
  },
  {
    "text": "right this app this specific app here should have a timeout of 5 minutes and",
    "start": "2759119",
    "end": "2764760"
  },
  {
    "text": "then uh data jailbreak detection and forbid I um open ends from there or",
    "start": "2764760",
    "end": "2770800"
  },
  {
    "text": "forbid copy paste that you can enforce a lot of stuff and this is all managed at the app level so each app can have",
    "start": "2770800",
    "end": "2776920"
  },
  {
    "text": "different sets of U policies so there's needs to be a way for the M agent to",
    "start": "2776920",
    "end": "2782720"
  },
  {
    "text": "communicate that stuff and this is how it does it uh commands if it needs to wipe from like the M agent and wipe another",
    "start": "2782720",
    "end": "2790119"
  },
  {
    "text": "app it's going to be passed through this IPC as well um crypto Keys could be",
    "start": "2790119",
    "end": "2795200"
  },
  {
    "text": "potentially passed through here and maybe even offline authentication uh data so maybe an app needs to actually",
    "start": "2795200",
    "end": "2803520"
  },
  {
    "text": "um do offline authentication so that data the data required to pull that off",
    "start": "2803520",
    "end": "2809599"
  },
  {
    "text": "like to you know do do a pbkdf2 and then compare it with something that data",
    "start": "2809599",
    "end": "2814640"
  },
  {
    "text": "would be passed in so what are some considerations for IPC",
    "start": "2814640",
    "end": "2820000"
  },
  {
    "text": "um there's keychain access groups right the problem with keychain access groups is the m agent is going to be signed by",
    "start": "2820000",
    "end": "2827200"
  },
  {
    "text": "the vendor you download it from the app store that's going to contain a signature from the vendor the wrapped",
    "start": "2827200",
    "end": "2833480"
  },
  {
    "text": "applications are going to contain signatures from um your Enterprise uh so",
    "start": "2833480",
    "end": "2839680"
  },
  {
    "text": "totally different developers you can't even leverage access groups for this URL schemes provides uh a way to call into",
    "start": "2839680",
    "end": "2848079"
  },
  {
    "text": "another app but that's a terrible user experience if you're using an app and then suddenly it starts flipping between",
    "start": "2848079",
    "end": "2853599"
  },
  {
    "text": "applications that's going to provide a pretty bad user experience but it does provide the ability to do some form of",
    "start": "2853599",
    "end": "2859440"
  },
  {
    "text": "authorization controls based on the bundle ID and there's data size limitations",
    "start": "2859440",
    "end": "2864599"
  },
  {
    "text": "since it's just a query string uh so the common way to do IPC on these Solutions is the UI pasteboard and um you know the",
    "start": "2864599",
    "end": "2873720"
  },
  {
    "text": "why does it why do they use UI PBO because it allows large data and it has a better user experience this",
    "start": "2873720",
    "end": "2879720"
  },
  {
    "text": "can all be done in the background just pulling for it to see that retrieving data and modifying that data uh the",
    "start": "2879720",
    "end": "2886200"
  },
  {
    "text": "problem is with the UI pasteboard is that if you know the key or the name to access that pasteboard any app on the",
    "start": "2886200",
    "end": "2892160"
  },
  {
    "text": "device can access it as well um so the main security cons considerations are it",
    "start": "2892160",
    "end": "2897760"
  },
  {
    "text": "can be read or Modified by anyone um so it should be encrypted but then you start thinking how do I protect the key",
    "start": "2897760",
    "end": "2903960"
  },
  {
    "text": "how do I get this key that I'm doing this crypto from one app to another so",
    "start": "2903960",
    "end": "2909160"
  },
  {
    "text": "that's something that you need to audit on your own and figure out how that key exchange is actually happening um common",
    "start": "2909160",
    "end": "2916240"
  },
  {
    "text": "way to pull this off is using URL schemes but that's tricky on itself they have to do the authorization right and",
    "start": "2916240",
    "end": "2921960"
  },
  {
    "text": "they have to in order to avoid like malicious apps you have to keep track of what apps you've installed which ones",
    "start": "2921960",
    "end": "2928200"
  },
  {
    "text": "you've uninstalled just so you know it's not a an app that you're not expecting for Android you have intense",
    "start": "2928200",
    "end": "2935359"
  },
  {
    "text": "but the same type of issues uh apply here where it's Al the the permissions for Android are all signature based but",
    "start": "2935359",
    "end": "2942160"
  },
  {
    "text": "you're signed by two different app uh developers so you can't really uh Leverage The built-in security controls",
    "start": "2942160",
    "end": "2948520"
  },
  {
    "text": "for intense so you're going to see a lot of programmatic checks um within the",
    "start": "2948520",
    "end": "2953640"
  },
  {
    "text": "applications and apps can verify the the app that just performed that call by doing like binder get calling uid using",
    "start": "2953640",
    "end": "2961079"
  },
  {
    "text": "the package manager app and then you get an application name but then that application name could of course not",
    "start": "2961079",
    "end": "2967359"
  },
  {
    "text": "could be like a a malicious app spoofing it um that's why mobile agent needs to",
    "start": "2967359",
    "end": "2973280"
  },
  {
    "text": "keep track of what apps is installed or uninstalled since an app name only one",
    "start": "2973280",
    "end": "2978760"
  },
  {
    "text": "app with the same name can exist on a",
    "start": "2978760",
    "end": "2982520"
  },
  {
    "text": "device um so here's an interesting attack dealing with the unencrypted file",
    "start": "2983920",
    "end": "2989760"
  },
  {
    "text": "names right so we found we looked at an Android manifest we found an activity",
    "start": "2989760",
    "end": "2994839"
  },
  {
    "text": "that was exposed even though an application is like at um",
    "start": "2994839",
    "end": "3001040"
  },
  {
    "text": "if you're not enforcing that authentication on um every single activity it can pretty much be um root",
    "start": "3001040",
    "end": "3009359"
  },
  {
    "text": "force and I can hit that activity and not actually authenticate so using like ADB shell no rooting no rooting required",
    "start": "3009359",
    "end": "3016599"
  },
  {
    "text": "or anything like that I can invoke uh activity and potentially bypass the whole login screen so here's like a app",
    "start": "3016599",
    "end": "3024000"
  },
  {
    "text": "I'm currently unauthenticated I'm like all right cool if I just type that ad plug it in type the ADB command I can",
    "start": "3024000",
    "end": "3030640"
  },
  {
    "text": "then bypass it um and access any unencrypted file data that was on there",
    "start": "3030640",
    "end": "3035720"
  },
  {
    "text": "without having to actually do any work um so it's kind of",
    "start": "3035720",
    "end": "3041400"
  },
  {
    "text": "interesting um effectiveness of security commands um this might seem pretty",
    "start": "3041680",
    "end": "3049079"
  },
  {
    "text": "obvious but like the common thing we saw seen with M Solutions that they need to be running so that they can pull uh you",
    "start": "3049079",
    "end": "3055440"
  },
  {
    "text": "need to ensure that all the application data is R is deleted even though that seems really obvious it's not always the",
    "start": "3055440",
    "end": "3062000"
  },
  {
    "text": "case uh wipes should apply to the agent and the wrapped apps a lot of times we saw it apply to one but not not",
    "start": "3062000",
    "end": "3070880"
  },
  {
    "text": "everything and lastly let's get into the conclusions so initial research found",
    "start": "3070920",
    "end": "3077720"
  },
  {
    "text": "you know we uncovered some vulnerabilities um all the vulnerabilities we we've uh found we've",
    "start": "3077720",
    "end": "3083440"
  },
  {
    "text": "disclosed to the to the vendors um they've all been responsive and most of",
    "start": "3083440",
    "end": "3088480"
  },
  {
    "text": "them have been fixed already um but the problem is that you know and the security posture for these ma Solutions",
    "start": "3088480",
    "end": "3094200"
  },
  {
    "text": "have gotten better over time um we've been doing this stuff for the past year and they've dramatically gotten",
    "start": "3094200",
    "end": "3101880"
  },
  {
    "text": "better um however you know it's it's you know it's it's I've only looked at a",
    "start": "3101880",
    "end": "3107839"
  },
  {
    "text": "small subset of them so there's still more that can be done so what I want to",
    "start": "3107839",
    "end": "3113440"
  },
  {
    "text": "what I'm pretty much doing is like from the testing that we've done we've been developing like these checklists of what",
    "start": "3113440",
    "end": "3120079"
  },
  {
    "text": "are what are some of the things we're actually testing for when we looking at these Solutions uh so we developed like",
    "start": "3120079",
    "end": "3125880"
  },
  {
    "text": "um like right now we're like over 50 different Security checks um so",
    "start": "3125880",
    "end": "3131000"
  },
  {
    "text": "hopefully everyone can like Leverage these you know if you're a organization and you're shopping around for these",
    "start": "3131000",
    "end": "3136799"
  },
  {
    "text": "Solutions maybe you can use this checklist to you know ask the right questions to the vendors like are you",
    "start": "3136799",
    "end": "3143000"
  },
  {
    "text": "guys doing this are you guys doing this are you guys how are you guys doing that you know you're you're equipped you're",
    "start": "3143000",
    "end": "3148119"
  },
  {
    "text": "you're smarter with these checks you know what to ask for if you're a vendor you know now you have the ability to say",
    "start": "3148119",
    "end": "3154760"
  },
  {
    "text": "oh cool now I have a baseline actually let's let's double check our solution",
    "start": "3154760",
    "end": "3160400"
  },
  {
    "text": "make sure we're actually like following these types of security practices and we're not vulnerable to these types of",
    "start": "3160400",
    "end": "3166400"
  },
  {
    "text": "attacks and for security testers now we have like a a baseline or like now we",
    "start": "3166400",
    "end": "3171480"
  },
  {
    "text": "know if if you get put on an assessment to to test one of these for like your client",
    "start": "3171480",
    "end": "3177319"
  },
  {
    "text": "now you have something to work with to actually get started",
    "start": "3177319",
    "end": "3182400"
  },
  {
    "text": "with um so shout outs to my partner who couldn't make it um but he helped out a",
    "start": "3182680",
    "end": "3188520"
  },
  {
    "text": "lot uh GDs research team for giving me the time to work on this and for QA my",
    "start": "3188520",
    "end": "3194559"
  },
  {
    "text": "stuff and then um the white paper it's going to be much pretty long um covers a",
    "start": "3194559",
    "end": "3200559"
  },
  {
    "text": "lot of stuff that I couldn't didn't have time to cover here um and it's going to have the whole checklist thing in there",
    "start": "3200559",
    "end": "3207160"
  },
  {
    "text": "so we're still working on it but it's going to be released and don't worry I'm actually going to release it I hate when people say they're going to release",
    "start": "3207160",
    "end": "3213000"
  },
  {
    "text": "something and don't do it um so pay attention to our Twitter and our blog",
    "start": "3213000",
    "end": "3218799"
  },
  {
    "text": "and it'll be announced sometime soon thank you",
    "start": "3218799",
    "end": "3223850"
  },
  {
    "text": "[Applause]",
    "start": "3223850",
    "end": "3231580"
  }
]