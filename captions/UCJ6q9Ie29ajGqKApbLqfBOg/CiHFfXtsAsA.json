[
  {
    "start": "0",
    "end": "84000"
  },
  {
    "text": "[Music]",
    "start": "1700",
    "end": "4810"
  },
  {
    "text": "now it is my pleasure to Welcome to the stage Jasper Von vundenberg",
    "start": "7460",
    "end": "14099"
  },
  {
    "text": "thank you have a good time thanks thanks everybody for coming it's great",
    "start": "14099",
    "end": "20039"
  },
  {
    "text": "to be black at black and back back at black hat geez that's a tongue twister a couple of months ago I came across",
    "start": "20039",
    "end": "27660"
  },
  {
    "text": "this picture and I just stared at it in awe for for a little while even though I know what it",
    "start": "27660",
    "end": "33960"
  },
  {
    "text": "is it's kind of a cool piece of art and Technology it almost looks like alien technology if you if you look at it",
    "start": "33960",
    "end": "41160"
  },
  {
    "text": "um so I've been in security for about 20 years Hardware security about 15. so I",
    "start": "41160",
    "end": "46440"
  },
  {
    "text": "know what this this bad boy is um and you know if you don't you probably are carrying a couple million",
    "start": "46440",
    "end": "53280"
  },
  {
    "text": "or a couple billion of this in your pocket as well um it's also the hero and the villain of",
    "start": "53280",
    "end": "60000"
  },
  {
    "text": "our of our story today but I'll get into that into a second so",
    "start": "60000",
    "end": "65939"
  },
  {
    "text": "like I mentioned I'm into security for a while um since last year I can call myself an author as well together with Colin",
    "start": "65939",
    "end": "72180"
  },
  {
    "text": "offline I wrote a book on Hardware hacking and you might not be able to see it from",
    "start": "72180",
    "end": "78600"
  },
  {
    "text": "the distance that picture is a little outdated it's more like like this now",
    "start": "78600",
    "end": "84080"
  },
  {
    "start": "84000",
    "end": "293000"
  },
  {
    "text": "let's get back to that uh that pretty picture so what this actually is it's a um it's a",
    "start": "84119",
    "end": "91259"
  },
  {
    "text": "flip-flop and the flip-flop is nothing more than sort of a one bit memory that",
    "start": "91259",
    "end": "96780"
  },
  {
    "text": "is um inside any chip so it kind of holds the current state of the chip",
    "start": "96780",
    "end": "102600"
  },
  {
    "text": "and it's both what we need to have chips operate but it also has a problem",
    "start": "102600",
    "end": "112020"
  },
  {
    "text": "and to understand that problem we have to dig into a little bit on how these these things work so",
    "start": "112020",
    "end": "117360"
  },
  {
    "text": "um a flip flop it's like a one bit memory cell if you will it takes two inputs a d which is zero or one and a",
    "start": "117360",
    "end": "125579"
  },
  {
    "text": "clock and it has an output Q signal and all it",
    "start": "125579",
    "end": "130739"
  },
  {
    "text": "does is as soon as there's a rising Edge in the clock it stores the value of D and from that moment on the value of Q",
    "start": "130739",
    "end": "138000"
  },
  {
    "text": "the output becomes D and it holds this as long as the clock is stable or or on",
    "start": "138000",
    "end": "144120"
  },
  {
    "text": "a falling Edge not so far so good that's sort of what it functionally does",
    "start": "144120",
    "end": "149879"
  },
  {
    "text": "the problem that I was alluding to is that it actually leaks a bit of information",
    "start": "149879",
    "end": "155280"
  },
  {
    "text": "so when the output switches from zero to one or one to zero the consumption the",
    "start": "155280",
    "end": "160680"
  },
  {
    "text": "power consumption of the flip flop is actually a little bit of a spike",
    "start": "160680",
    "end": "165840"
  },
  {
    "text": "not much obviously it's just one cell but it's it's more than if it's not",
    "start": "165840",
    "end": "171780"
  },
  {
    "text": "switching so conceptually what you can do is if it's",
    "start": "171780",
    "end": "179160"
  },
  {
    "text": "time equals zero let's say we know that the input value um is a is a zero or it's actually",
    "start": "179160",
    "end": "186420"
  },
  {
    "text": "stored at zero and we measure a power Spike now we",
    "start": "186420",
    "end": "191459"
  },
  {
    "text": "actually know that this bit has flipped from a zero to a one and if we measure the power being",
    "start": "191459",
    "end": "197400"
  },
  {
    "text": "constant then we know that has remained the same",
    "start": "197400",
    "end": "202040"
  },
  {
    "text": "so this becomes problematic when you look at algorithms like AES",
    "start": "202500",
    "end": "207959"
  },
  {
    "text": "so AES is an encryption algorithm it takes in 128 bits of plain text it has",
    "start": "207959",
    "end": "213900"
  },
  {
    "text": "128 bits of key and it produces 128-bit cyber text then if you have a hardware implementation oftentimes you'll have",
    "start": "213900",
    "end": "221040"
  },
  {
    "text": "128 flip-flops that each store one bit of the state",
    "start": "221040",
    "end": "227120"
  },
  {
    "text": "one of the first operations in AES is what's called a round key Edition",
    "start": "227519",
    "end": "232620"
  },
  {
    "text": "and it basically takes the plain text and it exhorts the key onto it now",
    "start": "232620",
    "end": "238860"
  },
  {
    "text": "the problem here at least it might be a problem is if we",
    "start": "238860",
    "end": "245220"
  },
  {
    "text": "can measure the power consumption of each of these 128 bit flip flops individually because we can assume we",
    "start": "245220",
    "end": "251400"
  },
  {
    "text": "know the plain text and if there's a power Spike that we know that the key bit was actually one because the value",
    "start": "251400",
    "end": "257100"
  },
  {
    "text": "changed we xored it if the power stays pretty flat we know that the key equals zero so this is a",
    "start": "257100",
    "end": "263820"
  },
  {
    "text": "problem I'm I'm gonna in this presentation skim over lots of details",
    "start": "263820",
    "end": "270419"
  },
  {
    "text": "um so you can ask me afterwards but I'm not not intending to make this into a 30",
    "start": "270419",
    "end": "275820"
  },
  {
    "text": "minute power analysis lecture so there's some incorrectness here but you know just intuitively try to understand that",
    "start": "275820",
    "end": "281160"
  },
  {
    "text": "this power relates to keys um there's not a problem though in my",
    "start": "281160",
    "end": "287280"
  },
  {
    "text": "arguments which is that I'm somehow assuming that I can measure the power consumption of a single flip-flop",
    "start": "287280",
    "end": "293520"
  },
  {
    "text": "now this terms to be a practical problem and even though it may leak you can",
    "start": "293520",
    "end": "299280"
  },
  {
    "text": "really easily measure that so let's take a look at what we can do",
    "start": "299280",
    "end": "307340"
  },
  {
    "text": "so what you see here is same flip flop again but now in its",
    "start": "308940",
    "end": "314699"
  },
  {
    "text": "context inside of the chip design so you see all this quickly lines that's sort of inside the Flip Flop and all the",
    "start": "314699",
    "end": "321780"
  },
  {
    "text": "other ones are the connections to the neighboring cells so this can be other flip-flops and anguits and or Gates and",
    "start": "321780",
    "end": "328020"
  },
  {
    "text": "all that fine Boolean logic that that sits on a chip so let's zoom out a little bit so this is what it looks like",
    "start": "328020",
    "end": "335100"
  },
  {
    "text": "you'll see more of these cells if we zoom out even further you see in these yellow bands you see part of the What's",
    "start": "335100",
    "end": "341759"
  },
  {
    "text": "called the power distribution Network in the black squiggly still is our flip-flop there then we zoom out even",
    "start": "341759",
    "end": "348479"
  },
  {
    "text": "further you start seeing sort of the edges of the IP block that this is in so on the left it's a little bit wider a",
    "start": "348479",
    "end": "354900"
  },
  {
    "text": "little bit more space there that's actually the edge where sort of the bus comes out",
    "start": "354900",
    "end": "360360"
  },
  {
    "text": "if we see about even further now you can start seeing a couple of other blocks",
    "start": "360360",
    "end": "365400"
  },
  {
    "text": "so the one on the right is actually um Pico rv32 core which is a risk 5 really",
    "start": "365400",
    "end": "371880"
  },
  {
    "text": "small CPU there's some memory interfacing Logic on the on the left bottom side and at the top you see a",
    "start": "371880",
    "end": "380220"
  },
  {
    "text": "one kilobyte SRAM amazing the size we have did I mention this is a really old",
    "start": "380220",
    "end": "386520"
  },
  {
    "text": "technology this tip so this is actually the full tip we we",
    "start": "386520",
    "end": "391860"
  },
  {
    "text": "date this out as a test tip somewhere in June um on a 150 nanometer process so it's",
    "start": "391860",
    "end": "400380"
  },
  {
    "text": "like like 20 years old or something but it's something you can do on a very small budget",
    "start": "400380",
    "end": "407400"
  },
  {
    "text": "um so there's a couple of Pico cores in here and a couple as scores and that memory Etc we're just gonna play with it",
    "start": "407400",
    "end": "413759"
  },
  {
    "text": "once we get it back do some side tunnel and fold experiments on it",
    "start": "413759",
    "end": "419060"
  },
  {
    "text": "so we've sort of zoomed out from this one flip all the way to an entire chip and",
    "start": "419639",
    "end": "425819"
  },
  {
    "text": "that we can measure so we can take a chip you see on the right hand side of this",
    "start": "425819",
    "end": "432300"
  },
  {
    "text": "picture in the the green PCB you see another chip not the one I just showed you but you see a",
    "start": "432300",
    "end": "437940"
  },
  {
    "text": "PCB we can do electromagnetic probing of that so you see a little probe over it",
    "start": "437940",
    "end": "443520"
  },
  {
    "text": "we can do current probing that's the little yellow box to the side of it and I'm on the left you see an oscilloscope",
    "start": "443520",
    "end": "449280"
  },
  {
    "text": "where we capture these these signals and for the purpose of this talk I'm",
    "start": "449280",
    "end": "454440"
  },
  {
    "text": "going to talk about power analysis electromagnetic analysis is similar in a way enough that I don't have to talk",
    "start": "454440",
    "end": "461039"
  },
  {
    "text": "about the differences here so how can we",
    "start": "461039",
    "end": "468720"
  },
  {
    "text": "use these signals to actually extract the full key because we we can't measure the individual flip flops but what we",
    "start": "468720",
    "end": "474960"
  },
  {
    "text": "can do is we can take lots of measurements of AF operating take power traces take en traces and then perform a",
    "start": "474960",
    "end": "483240"
  },
  {
    "text": "magic trick called correlation power analysis and what's CPA for short what CPA does",
    "start": "483240",
    "end": "490440"
  },
  {
    "text": "is you take an AES engine you send it various plain texts differing plain",
    "start": "490440",
    "end": "496020"
  },
  {
    "text": "texts and what you're going to try to do is you're going to try to model what the",
    "start": "496020",
    "end": "502139"
  },
  {
    "text": "power would look like if a certain key byte would be correct",
    "start": "502139",
    "end": "507300"
  },
  {
    "text": "so I'm going to say well if my key byte is zero then I kind of know by the",
    "start": "507300",
    "end": "512640"
  },
  {
    "text": "design of IES what bits flips I should see given a certain plain text and I can match that against the trace",
    "start": "512640",
    "end": "519240"
  },
  {
    "text": "if my match is correct and I say well that's probably a right part of the kit",
    "start": "519240",
    "end": "524880"
  },
  {
    "text": "I'm doing this for a sub key so in this case a key bite I'm making 200 256",
    "start": "524880",
    "end": "530880"
  },
  {
    "text": "predictions I'm going to do that for each key byte and sort of the one that matches my",
    "start": "530880",
    "end": "538380"
  },
  {
    "text": "where the model matches my link it's best I'm going to call that the right key and I read some repeat this 16 times",
    "start": "538380",
    "end": "544080"
  },
  {
    "text": "and then I have the full key um so this is again bit hand wavy but just for you to get an understanding we",
    "start": "544080",
    "end": "550380"
  },
  {
    "text": "can apply statistics and sort of using this modeled power",
    "start": "550380",
    "end": "555420"
  },
  {
    "text": "consumption we can match it against reality and find out what the what the key should look like",
    "start": "555420",
    "end": "561199"
  },
  {
    "text": "there's a problem here um we're doing this post silicon so we have",
    "start": "562620",
    "end": "567899"
  },
  {
    "text": "a chip actually in our lab and you know as soon as you find leakage you're too late you can't fix that chip anymore you",
    "start": "567899",
    "end": "575279"
  },
  {
    "text": "you know you feed it back to the manufacturers and they say thank you and we're going to fix the next chip iteration or maybe two down the line",
    "start": "575279",
    "end": "582000"
  },
  {
    "text": "depending on what their manufacturing pipeline looks like um so yeah with post silicon we can fix",
    "start": "582000",
    "end": "587640"
  },
  {
    "text": "the next chip and what I'm going to try to argue today is pre-silic and we can fix the current chip",
    "start": "587640",
    "end": "594440"
  },
  {
    "start": "594000",
    "end": "782000"
  },
  {
    "text": "and we do that by simulation the chip doesn't exist yet so this is the best we can do",
    "start": "595440",
    "end": "601140"
  },
  {
    "text": "so what are the ingredients that we we need for this",
    "start": "601140",
    "end": "606560"
  },
  {
    "text": "that's sort of four basic uh ones one is is that chip design so you need what's called a net list",
    "start": "608040",
    "end": "614820"
  },
  {
    "text": "and the net list is nothing more than basically all the gates in the chip and their connections so much if and Gates",
    "start": "614820",
    "end": "620880"
  },
  {
    "text": "or Gates not Gates Etc plus the connections between them that's a net list",
    "start": "620880",
    "end": "626839"
  },
  {
    "text": "ideally you also want to know where things are placed but for the purpose of some simulations you don't",
    "start": "626839",
    "end": "633440"
  },
  {
    "text": "then we need to know the behavior as well so if we send a particular plain",
    "start": "633440",
    "end": "638700"
  },
  {
    "text": "text to to this net list what are all the toggles that are sort of logically",
    "start": "638700",
    "end": "644040"
  },
  {
    "text": "happening so for each of the gates you kind of capture the state is it you know outputting a one or a zero over time and",
    "start": "644040",
    "end": "651240"
  },
  {
    "text": "you put this in what's called a vcd file so that's sort of the logic side then in",
    "start": "651240",
    "end": "656940"
  },
  {
    "text": "order to convert that logic to power we need models for each cell",
    "start": "656940",
    "end": "662040"
  },
  {
    "text": "and these are contained in what's called Liberty files basically for every cell it explains",
    "start": "662040",
    "end": "668760"
  },
  {
    "text": "when transitions happen what the power consumption is so all of these inputs you feed into",
    "start": "668760",
    "end": "675060"
  },
  {
    "text": "your favorite Power simulation tool and you run it on your your beautiful Mainframe that you have in your lab",
    "start": "675060",
    "end": "681180"
  },
  {
    "text": "and then you can essentially do the same we did before with the power traces but",
    "start": "681180",
    "end": "688260"
  },
  {
    "text": "before I get into that that Mainframe isn't very fast don't do it on that one actually",
    "start": "688260",
    "end": "694019"
  },
  {
    "text": "um but on a modern CPU these simulations are actually quite doable so if you",
    "start": "694019",
    "end": "701519"
  },
  {
    "text": "focus on what you see in the Stables is a number of AES cores we've tried this on",
    "start": "701519",
    "end": "707040"
  },
  {
    "text": "and in the right most three columns you see for different simulation accuracies",
    "start": "707040",
    "end": "713640"
  },
  {
    "text": "so one at RTL one both synthesis and one post placing round how long it took for",
    "start": "713640",
    "end": "718680"
  },
  {
    "text": "us to simulate 256 traces and this all varies from half an hour to like 13",
    "start": "718680",
    "end": "724920"
  },
  {
    "text": "hours or so um so definitely not like entering you",
    "start": "724920",
    "end": "730620"
  },
  {
    "text": "have your results but this is something you can run overnight and still get a bunch of traces",
    "start": "730620",
    "end": "737480"
  },
  {
    "text": "so just like with your oscilloscope before we now take these same traces we run plain text so we run our modeling we",
    "start": "738899",
    "end": "745800"
  },
  {
    "text": "run our CPA and out comes leakage or not and",
    "start": "745800",
    "end": "752579"
  },
  {
    "text": "that usually shows up like you know some sort of correlation Trace as we call it with a peak somewhere and that Peak",
    "start": "752579",
    "end": "759240"
  },
  {
    "text": "indicates well at this point in time there's a statistically um",
    "start": "759240",
    "end": "764399"
  },
  {
    "text": "significant leakage it's something that could be exploited to get keys out of a system",
    "start": "764399",
    "end": "771180"
  },
  {
    "text": "um there's a problem with this how do I how do I go from this to actually fixing my design",
    "start": "771180",
    "end": "777660"
  },
  {
    "text": "and that's kind of where the research that we did starts so",
    "start": "777660",
    "end": "783200"
  },
  {
    "start": "782000",
    "end": "1151000"
  },
  {
    "text": "when something leaks doesn't actually help fix it you can only observe that it",
    "start": "783200",
    "end": "788519"
  },
  {
    "text": "leaks and at what point in time but it doesn't tell you like you know these are the gates if you have to go and fix",
    "start": "788519",
    "end": "794760"
  },
  {
    "text": "so that's where our research called skate comes in it's all blue team stuff",
    "start": "794760",
    "end": "800820"
  },
  {
    "text": "we're going to go fix stuff now so if you're a red team or you know go on to hacking",
    "start": "800820",
    "end": "806279"
  },
  {
    "text": "um so we know when in time something's happening but but",
    "start": "806279",
    "end": "811620"
  },
  {
    "text": "where is it leaking so the idea behind this is that we are",
    "start": "811620",
    "end": "818639"
  },
  {
    "text": "going to correlate net switches to uh to a leakage model so essentially what we're going to do is",
    "start": "818639",
    "end": "825300"
  },
  {
    "text": "we're going to take the logic on a chip and remember as soon as something",
    "start": "825300",
    "end": "831959"
  },
  {
    "text": "switches it consumes more power so if we see during the when period so",
    "start": "831959",
    "end": "837600"
  },
  {
    "text": "on the right hand side we call the red box the leakage time interval but basically the part of the time when",
    "start": "837600",
    "end": "843839"
  },
  {
    "text": "something leaks and we can statistically look at um you know the peaks in power there as",
    "start": "843839",
    "end": "850200"
  },
  {
    "text": "well now if a particular net always sort of seems to correspond to",
    "start": "850200",
    "end": "856620"
  },
  {
    "text": "its switches with a higher Peak on the right hand side you can argue there's actually a statistical relation between",
    "start": "856620",
    "end": "861660"
  },
  {
    "text": "those two so you can start going down to Nets that leak",
    "start": "861660",
    "end": "866820"
  },
  {
    "text": "inside of a chip and what comes out of this is basically a ranked list of leaky",
    "start": "866820",
    "end": "873720"
  },
  {
    "text": "Gates so you can start arguing you know in in this small contrived example it's",
    "start": "873720",
    "end": "880860"
  },
  {
    "text": "actually the S boxes that seem to leak so let's take a little bit deeper look",
    "start": "880860",
    "end": "886079"
  },
  {
    "text": "at the math here so um when we have these vcd traces what we're",
    "start": "886079",
    "end": "892199"
  },
  {
    "text": "actually going to do is we're going to apply a very simple transformation on it because the theory is as soon as",
    "start": "892199",
    "end": "897779"
  },
  {
    "text": "something switches it will consume more power so our power model is as soon as a",
    "start": "897779",
    "end": "903360"
  },
  {
    "text": "particular net switches it consumes power one if something doesn't switch then it",
    "start": "903360",
    "end": "909420"
  },
  {
    "text": "assumes power minus one and that's enough of a power model like we're doing correlations on this we",
    "start": "909420",
    "end": "914880"
  },
  {
    "text": "don't have to do anything too fancy and we calculate this for every net and for every simulation that we run",
    "start": "914880",
    "end": "923899"
  },
  {
    "text": "then we take these these test vectors and we're going to match for every net",
    "start": "924540",
    "end": "929639"
  },
  {
    "text": "for every simulation where do the toggles basically align with small increases in power and if something",
    "start": "929639",
    "end": "936120"
  },
  {
    "text": "doesn't toggle where does it align with a lower power consumption and from that we do basically a Pearson",
    "start": "936120",
    "end": "943980"
  },
  {
    "text": "correlation so we can correlate for every net how much it contributes to the uh the",
    "start": "943980",
    "end": "951360"
  },
  {
    "text": "power linkage and that gives us basically the point in the tip where the league is at the very lowest level like",
    "start": "951360",
    "end": "957540"
  },
  {
    "text": "we're talking about Nets which you can which are driven by an output gate and you can go back to the gate where it",
    "start": "957540",
    "end": "962940"
  },
  {
    "text": "leaks so once we've established that we can start sort of zooming out again because",
    "start": "962940",
    "end": "969660"
  },
  {
    "text": "individual gates are also it's if you're a software person it's looking like at like individual bits of a binary",
    "start": "969660",
    "end": "976019"
  },
  {
    "text": "right that don't make a lot of sense until you start sort of reverse engineering and ideally going back to",
    "start": "976019",
    "end": "981899"
  },
  {
    "text": "your source code where where that particular piece has has meaning again so similar in in Hardware design so",
    "start": "981899",
    "end": "989579"
  },
  {
    "text": "um Hardware Designs are always sort of hierarchical so what I showed you before",
    "start": "989579",
    "end": "994639"
  },
  {
    "text": "in terms of the chip layout we have the top level as they call it then we have you know the risk five cores and a bunch",
    "start": "994639",
    "end": "1001100"
  },
  {
    "text": "of AES scores and I zoom into AES and that has like a round logic and inside the round logic there's s boxes and you",
    "start": "1001100",
    "end": "1008240"
  },
  {
    "text": "know it goes all the way down and eventually you get to individual Gates so if you tell your synthesis tool like",
    "start": "1008240",
    "end": "1014899"
  },
  {
    "text": "maintain the hierarchy or track the hierarchy you can go back from gates to",
    "start": "1014899",
    "end": "1020139"
  },
  {
    "text": "basically parts of the original design and",
    "start": "1020139",
    "end": "1025520"
  },
  {
    "text": "what I find kind of cool this is one of our earlier results where you know you",
    "start": "1025520",
    "end": "1030558"
  },
  {
    "text": "never know when you start applying your method what's what it's going to come up with but immediately we saw that that the S",
    "start": "1030559",
    "end": "1036980"
  },
  {
    "text": "boxes sort of floated to the top so this long list is basically parts of the",
    "start": "1036980",
    "end": "1043040"
  },
  {
    "text": "hierarchy the individual dots you see are individual Gates and the shading is that that correlation",
    "start": "1043040",
    "end": "1049880"
  },
  {
    "text": "value so the the darker the color the higher the correlation the more it leaks and the more dots the more of these",
    "start": "1049880",
    "end": "1056539"
  },
  {
    "text": "Gates there are in a particular part of the hierarchy so you see those S boxes they have the most Gates and also the",
    "start": "1056539",
    "end": "1062900"
  },
  {
    "text": "highest leakage and that's where you would expect it this was an unprotected implementation so this was really sort",
    "start": "1062900",
    "end": "1068059"
  },
  {
    "text": "of a nice validation of what we were doing there's also some other parts of",
    "start": "1068059",
    "end": "1073400"
  },
  {
    "text": "the hierarchy where it's obvious like there's round key generation and key memory but there's",
    "start": "1073400",
    "end": "1078740"
  },
  {
    "text": "other stuff that where the name doesn't really say hey I'm leaking to me at least like block registers and who knows",
    "start": "1078740",
    "end": "1085100"
  },
  {
    "text": "what so this analysis already starts showing some areas where you won't necessarily think there's leakage",
    "start": "1085100",
    "end": "1094240"
  },
  {
    "text": "we can go up even further this was another experiment where we took yet another AES core on the left top left",
    "start": "1095360",
    "end": "1103340"
  },
  {
    "text": "you see this Picos slash g something so these are the gate numbers that come out",
    "start": "1103340",
    "end": "1109160"
  },
  {
    "text": "of the synthesis tool and each of them is related back to",
    "start": "1109160",
    "end": "1114380"
  },
  {
    "text": "basically a line and a character in The Source Code file and this is part of that leaky gate list",
    "start": "1114380",
    "end": "1120200"
  },
  {
    "text": "and it was kind of cool to see that at least these four Gates they all went back literally to the xor operation",
    "start": "1120200",
    "end": "1126440"
  },
  {
    "text": "where we took data and key and we mix them together so this is that add Brown key operation I was talking about",
    "start": "1126440",
    "end": "1132260"
  },
  {
    "text": "earlier as well um so yeah from from sort of",
    "start": "1132260",
    "end": "1139100"
  },
  {
    "text": "very high level and doing statistics we went down the gates and then we went back up to the source code but now we're",
    "start": "1139100",
    "end": "1144980"
  },
  {
    "text": "sort of in in the land where developers can do something about it right now you know where your problem is",
    "start": "1144980",
    "end": "1151899"
  },
  {
    "start": "1151000",
    "end": "1449000"
  },
  {
    "text": "so the next step is counter major testing",
    "start": "1152539",
    "end": "1157700"
  },
  {
    "text": "so the attacks that I'm just talking about they've been around for two and a half decades or so now so people have",
    "start": "1157700",
    "end": "1163160"
  },
  {
    "text": "been thinking about all kinds of counter measures for a while um and obviously when you put them in",
    "start": "1163160",
    "end": "1169520"
  },
  {
    "text": "Silicon you can measure them and again there the problem is if you find leakage it's too late so let's do counter",
    "start": "1169520",
    "end": "1176900"
  },
  {
    "text": "measure testing in simulation",
    "start": "1176900",
    "end": "1180580"
  },
  {
    "text": "and really the question that you're asking is it doesn't work right before you write your code you don't really",
    "start": "1183679",
    "end": "1189559"
  },
  {
    "text": "know if it's very heavily armored or whether it's fluffy",
    "start": "1189559",
    "end": "1195279"
  },
  {
    "text": "um I have to bore you a little bit with with",
    "start": "1195620",
    "end": "1200679"
  },
  {
    "text": "masking so masking is a a common countermeasure you can look up there's",
    "start": "1200679",
    "end": "1206360"
  },
  {
    "text": "various literature about it um really what it's doing intuitively it's",
    "start": "1206360",
    "end": "1212360"
  },
  {
    "text": "it's trying to break the relation that CPA is exploiting so with CPA we take like data which we",
    "start": "1212360",
    "end": "1219679"
  },
  {
    "text": "know and an unknown key and we're going to start making predictions about this key what masking does is it adds a third",
    "start": "1219679",
    "end": "1226700"
  },
  {
    "text": "variable so we have data a key and some random variable that keeps on changing every",
    "start": "1226700",
    "end": "1231740"
  },
  {
    "text": "time and we can't predict this it actually breaks our ability to",
    "start": "1231740",
    "end": "1237320"
  },
  {
    "text": "um to match the leakage model to the data that's being processed and masking work this is masking in AES",
    "start": "1237320",
    "end": "1244700"
  },
  {
    "text": "on the left hand side it's sort of vanilla as on the right it's with masking you see everywhere these plus",
    "start": "1244700",
    "end": "1250280"
  },
  {
    "text": "x's and these are basically xor operations where we xor some mask onto",
    "start": "1250280",
    "end": "1255679"
  },
  {
    "text": "the data and what's really important is that you make sure that your data is always masked and that the mask regularly",
    "start": "1255679",
    "end": "1262520"
  },
  {
    "text": "rotates there's some other attacks that you can do if the mask is constant everywhere so you see this variable X",
    "start": "1262520",
    "end": "1268760"
  },
  {
    "text": "keeps on keeps on changing and then eventually sort of at the end of AES you unmask your value and then you have the",
    "start": "1268760",
    "end": "1274820"
  },
  {
    "text": "ciphertext so we did a case study so we implemented",
    "start": "1274820",
    "end": "1282919"
  },
  {
    "text": "our own AES design and we added some just off the shelf",
    "start": "1282919",
    "end": "1288380"
  },
  {
    "text": "literature masking to that and first we turned off the masking so",
    "start": "1288380",
    "end": "1294440"
  },
  {
    "text": "we're the same design but we could turn it off or I think we basically made the mask always zero or something like that",
    "start": "1294440",
    "end": "1299780"
  },
  {
    "text": "so we didn't change the design we just turned off masking and what we can do then is run our CPA",
    "start": "1299780",
    "end": "1308360"
  },
  {
    "text": "um in this case tvla but let's let's just say CVA the CPA and we see these red",
    "start": "1308360",
    "end": "1314840"
  },
  {
    "text": "dots which basically indicate when there's leakage so we know that this thing leaks that's as predicted there",
    "start": "1314840",
    "end": "1321500"
  },
  {
    "text": "were you know counter measures were off so what we're expecting is now that we",
    "start": "1321500",
    "end": "1327200"
  },
  {
    "text": "when once we turn the countermeasures on all these red dots should disappear according to Theory at least",
    "start": "1327200",
    "end": "1335559"
  },
  {
    "text": "of course that didn't happen so on the left hand side you see the no",
    "start": "1335659",
    "end": "1340940"
  },
  {
    "text": "masking picture on the right hand side you see it with masking and even though the number of leakage points went from",
    "start": "1340940",
    "end": "1347000"
  },
  {
    "text": "10 to 5 there was still leakage there and it was significant and it would be enough to to break this implementation",
    "start": "1347000",
    "end": "1353960"
  },
  {
    "text": "and we kind of we didn't understand it at first because",
    "start": "1353960",
    "end": "1359000"
  },
  {
    "text": "when we looked at the source code it all looked fine like The Masks were being passed",
    "start": "1359000",
    "end": "1365200"
  },
  {
    "text": "so we used skate and we started going down to the gate level and trying to figure out in this case we actually had",
    "start": "1365200",
    "end": "1371419"
  },
  {
    "text": "to stay at gate level to figure out what was going on and what turned out is that",
    "start": "1371419",
    "end": "1376520"
  },
  {
    "text": "um the synthesis tool for software people your compiler",
    "start": "1376520",
    "end": "1381620"
  },
  {
    "text": "decided to optimize this design and it flipped two X4 operations around",
    "start": "1381620",
    "end": "1386659"
  },
  {
    "text": "now these two operations happen to be the remasking so normally when you remask you first apply the new mask with",
    "start": "1386659",
    "end": "1393320"
  },
  {
    "text": "an xor and then you xor out the old mask so that you never have sort of an unmasked value but the synthetics tool",
    "start": "1393320",
    "end": "1400460"
  },
  {
    "text": "is optimizing and somehow these tools never optimized for security and it flipped these things around so it",
    "start": "1400460",
    "end": "1407840"
  },
  {
    "text": "first unmasked which means that the values are in the clear for a little while and then it",
    "start": "1407840",
    "end": "1414080"
  },
  {
    "text": "remastered so it completely threw off the countermeasure",
    "start": "1414080",
    "end": "1419539"
  },
  {
    "text": "so yeah once you have that insight and you dig into it then you can find out what's going on you can tell your since",
    "start": "1419539",
    "end": "1425659"
  },
  {
    "text": "the synthesis tool basically don't optimize certain things and then it maintained the operation and on the",
    "start": "1425659",
    "end": "1432919"
  },
  {
    "text": "right hand side take note of the y-axis here that's a bit zoomed in there's no more red dots essentially the leakage is",
    "start": "1432919",
    "end": "1439340"
  },
  {
    "text": "gone as we as we would have originally expected and when you looked into that list yeah the orders of the Mask was was",
    "start": "1439340",
    "end": "1446720"
  },
  {
    "text": "maintained well that's all uh really nice but",
    "start": "1446720",
    "end": "1455419"
  },
  {
    "start": "1449000",
    "end": "1782000"
  },
  {
    "text": "it's not just about the AES core itself and that's I think an Insight that we've gradually been",
    "start": "1455419",
    "end": "1461539"
  },
  {
    "text": "been getting as we dig more into the details because historically sites at least from our point of view as a lab we",
    "start": "1461539",
    "end": "1468080"
  },
  {
    "text": "were just testing chips we didn't have designs we didn't have this kind of insight like it either leaked or it didn't and we kind of knew what the",
    "start": "1468080",
    "end": "1474559"
  },
  {
    "text": "position on the chip was where it leads if you're doing em um but now we have sort of an unprecedented",
    "start": "1474559",
    "end": "1481700"
  },
  {
    "text": "look into all the details of what was going on so like let's let's just zoom out a little bit and take an entire SOC",
    "start": "1481700",
    "end": "1488600"
  },
  {
    "text": "and then try to simulate that because maybe the AES score is fine but we don't know if the rest of the house is on fire",
    "start": "1488600",
    "end": "1495760"
  },
  {
    "text": "so we took an SOC which is a little different than the one I just showed you",
    "start": "1496760",
    "end": "1503240"
  },
  {
    "text": "um but it's basically a small SOC with a CPU cord some peripherals some memory and an as accelerator",
    "start": "1503240",
    "end": "1510140"
  },
  {
    "text": "and we loaded this piece of software on it and basically what you're seeing here is",
    "start": "1510140",
    "end": "1516020"
  },
  {
    "text": "that it's in sort of in the blue instructions there it's first loading the plain text so it's loading 32 bits",
    "start": "1516020",
    "end": "1522500"
  },
  {
    "text": "for memory and then it's storing it in as engine and doing that four times so it transfers 128 bits",
    "start": "1522500",
    "end": "1529279"
  },
  {
    "text": "and it does the same for the key so it's loading 32 bits at a time storing it in the as engine and then the CPU Basics",
    "start": "1529279",
    "end": "1535640"
  },
  {
    "text": "says go encrypt and it's going into a busy weight so it actually just kind of",
    "start": "1535640",
    "end": "1540740"
  },
  {
    "text": "pulls the as engine for you know are you not 999 are you done are you done um so we",
    "start": "1540740",
    "end": "1546620"
  },
  {
    "text": "put this in our power simulations and this is sort of a very common look if",
    "start": "1546620",
    "end": "1555260"
  },
  {
    "text": "you you're used to looking at powered faces where you sort of see the CPU doing something first on this case we",
    "start": "1555260",
    "end": "1561200"
  },
  {
    "text": "know it's writing the plain text in the key then it switches to the AES engine",
    "start": "1561200",
    "end": "1566299"
  },
  {
    "text": "says you know go and you see sort of this higher active like as engines that",
    "start": "1566299",
    "end": "1571580"
  },
  {
    "text": "have a lot of switching activity way more than the simple CPU here so you expect more power consumption and you",
    "start": "1571580",
    "end": "1578299"
  },
  {
    "text": "see that here if you squint a little bit you can see like a rep like 10 round",
    "start": "1578299",
    "end": "1583640"
  },
  {
    "text": "repetitions happening as well we started 10 rounds of AES and after that the CPU takes over again and retrieves the the",
    "start": "1583640",
    "end": "1590000"
  },
  {
    "text": "ciphertext um what I found really cool is you can",
    "start": "1590000",
    "end": "1595220"
  },
  {
    "text": "actually see some of the sort of the internals of the CPU Behavior as well so",
    "start": "1595220",
    "end": "1600500"
  },
  {
    "text": "um from your computer architecture 101 class you may remember pipeline hazards",
    "start": "1600500",
    "end": "1606020"
  },
  {
    "text": "and pipeline stalls so what's happening in the CPU is when it fetches to 32 bits",
    "start": "1606020",
    "end": "1611059"
  },
  {
    "text": "from memory it actually already starts executing that store instruction but the",
    "start": "1611059",
    "end": "1616220"
  },
  {
    "text": "store instruction needs to wait for the data to come in to the CPU before it can actually do the store and you see that",
    "start": "1616220",
    "end": "1622100"
  },
  {
    "text": "in these little divots in the in the power consumption there so you see this really you can kind of kind of Trace",
    "start": "1622100",
    "end": "1628880"
  },
  {
    "text": "every instruction through its execution and then near the end the CPU kicks off the as accelerator and then it's kind of",
    "start": "1628880",
    "end": "1636080"
  },
  {
    "text": "holds there now apart from geeking out over that let's",
    "start": "1636080",
    "end": "1642020"
  },
  {
    "text": "let's go back to leakage so this was again an AES Engine with no counter measure so we expect leakage",
    "start": "1642020",
    "end": "1648620"
  },
  {
    "text": "here um but what we also saw",
    "start": "1648620",
    "end": "1654380"
  },
  {
    "text": "maybe not entirely unexpected was a whole bunch of leakage before the as engine even started",
    "start": "1654380",
    "end": "1662480"
  },
  {
    "text": "so you see a couple of little Peaks that align with round one of the AES that's just leakage from the as engine but",
    "start": "1662480",
    "end": "1669440"
  },
  {
    "text": "there's a whole bunch of stuff happening before that and it's kind of interesting if you look at",
    "start": "1669440",
    "end": "1675320"
  },
  {
    "text": "this from from a designer's point of view because very often you have a hardware designer who makes an AES",
    "start": "1675320",
    "end": "1681620"
  },
  {
    "text": "engine and they'll work on the counter measures and maybe they'll even simulate it and they figure out it's all fine",
    "start": "1681620",
    "end": "1688100"
  },
  {
    "text": "um and then there's also a software developer who says you know I'm just following my the you know I'm writing my",
    "start": "1688100",
    "end": "1695299"
  },
  {
    "text": "code in C micro architecture or sock layouts are not my domain I can't really fix",
    "start": "1695299",
    "end": "1701419"
  },
  {
    "text": "anything there but maybe there's a whole bunch of leakage that's happening there so",
    "start": "1701419",
    "end": "1706580"
  },
  {
    "text": "there's sort of a gap when you when you engineer these chips and who really looks at the leakage that's happening",
    "start": "1706580",
    "end": "1712940"
  },
  {
    "text": "outside of the AES engine",
    "start": "1712940",
    "end": "1716740"
  },
  {
    "text": "and we can zoom into that a little bit further because we can locate where these gates",
    "start": "1718520",
    "end": "1724159"
  },
  {
    "text": "are we can locate where they are in hierarchy and we actually find that there's a whole bunch of leakage that's",
    "start": "1724159",
    "end": "1729200"
  },
  {
    "text": "happening in the risk 5 CPU which you may expect right it's handling key",
    "start": "1729200",
    "end": "1734480"
  },
  {
    "text": "material um it's kind of cool that you can kind of see where it is it's in alus and in",
    "start": "1734480",
    "end": "1740000"
  },
  {
    "text": "the register files Etc but what surprises is that's actually the peripherals were leaking key material as",
    "start": "1740000",
    "end": "1746539"
  },
  {
    "text": "well and that's surprising because they're not it's not their job to deal with key material at all",
    "start": "1746539",
    "end": "1753140"
  },
  {
    "text": "um the problem is they're hanging off at the same bus as the CPU and as engine",
    "start": "1753140",
    "end": "1758240"
  },
  {
    "text": "so as soon as key material is being transferred over that bus there's some transistor activity there",
    "start": "1758240",
    "end": "1764360"
  },
  {
    "text": "even though they might not actually do anything with that data there's still some switching activity there that sort",
    "start": "1764360",
    "end": "1770419"
  },
  {
    "text": "of amplifies the the leakage so yeah one of our conclusions here here",
    "start": "1770419",
    "end": "1776000"
  },
  {
    "text": "really was look it's just found an unexpected places if you don't look here you're not going to find it",
    "start": "1776000",
    "end": "1782679"
  },
  {
    "start": "1782000",
    "end": "1906000"
  },
  {
    "text": "so um a little bit about future work um",
    "start": "1782840",
    "end": "1789320"
  },
  {
    "text": "future work meaning we dream of this it doesn't exist today um one of the insights we had is",
    "start": "1789320",
    "end": "1796760"
  },
  {
    "text": "um if you look at the Leaky Gates only in the design it's actually quite a subset of the full design",
    "start": "1796760",
    "end": "1803419"
  },
  {
    "text": "so I'm going to talk for instance about AES counter or AES mask encounter",
    "start": "1803419",
    "end": "1808580"
  },
  {
    "text": "measures these things doubled area which is expensive",
    "start": "1808580",
    "end": "1813740"
  },
  {
    "text": "um if we can isolate the leakage to like 10 30 of the design even if we would",
    "start": "1813740",
    "end": "1820520"
  },
  {
    "text": "like double the area on only those Gates we'd still be cheaper than doing a",
    "start": "1820520",
    "end": "1825860"
  },
  {
    "text": "full-blown masking so we're sort of looking at this from an encounter measure injection",
    "start": "1825860",
    "end": "1831860"
  },
  {
    "text": "standpoint like if we have this list of gates can we do a netless transformation to get a more secure design out",
    "start": "1831860",
    "end": "1839320"
  },
  {
    "text": "once you have that you can also start thinking about design space exploration so Hardware designers are often trading",
    "start": "1839320",
    "end": "1846860"
  },
  {
    "text": "off power performance area and security is actually a fourth dimension in that",
    "start": "1846860",
    "end": "1853039"
  },
  {
    "text": "so security comes at a cost tighter power performs their area so once you start looking at security as hey we have",
    "start": "1853039",
    "end": "1861020"
  },
  {
    "text": "a list of leaky Gates I can try applying countermeasures on the top 10 Gates and on the top 100",
    "start": "1861020",
    "end": "1866360"
  },
  {
    "text": "gates in the top 1000 Gates and see how it affects my power performance in area",
    "start": "1866360",
    "end": "1871520"
  },
  {
    "text": "and as a designer I can start making these trade-offs between security and you know the cost of it",
    "start": "1871520",
    "end": "1879039"
  },
  {
    "text": "and then finally in um in Hardware design there's sort of an important Point called sign off",
    "start": "1879440",
    "end": "1885200"
  },
  {
    "text": "where you take various metrics over your design you say okay this is good enough to go into fabrication",
    "start": "1885200",
    "end": "1891860"
  },
  {
    "text": "and really what we would love to see is basically a security sign off as well or we said this is secure enough to go into",
    "start": "1891860",
    "end": "1898279"
  },
  {
    "text": "fabrication and we can come up with a bunch of metrics based on on side Channel analysis that that could help",
    "start": "1898279",
    "end": "1904220"
  },
  {
    "text": "that um before I get into conclusions some",
    "start": "1904220",
    "end": "1909559"
  },
  {
    "start": "1906000",
    "end": "2121000"
  },
  {
    "text": "some caveats so these simulations are limited by how many CPU cores you throw",
    "start": "1909559",
    "end": "1915500"
  },
  {
    "text": "at it but also the design size so you didn't see the latest you know Intel",
    "start": "1915500",
    "end": "1922240"
  },
  {
    "text": "12th generation 4 in my slides because that's not stuff we can simulate but you",
    "start": "1922240",
    "end": "1927380"
  },
  {
    "text": "know AES scores simple socs definitely something that's that's within reach and",
    "start": "1927380",
    "end": "1933500"
  },
  {
    "text": "you could theoretically throw more CPU core than the simulation as well and speed it up that way",
    "start": "1933500",
    "end": "1940760"
  },
  {
    "text": "um accuracy wise we're relying on these Eda simulators so the reason we taped",
    "start": "1940760",
    "end": "1947000"
  },
  {
    "text": "out that chip which is coming back in October keep your fingers crossed that they actually work",
    "start": "1947000",
    "end": "1952279"
  },
  {
    "text": "um is so we have a full design we can run it through skate and we can look at the Chip And basically cross cross check",
    "start": "1952279",
    "end": "1958820"
  },
  {
    "text": "our our results with with reality now these EDI simulators aren't",
    "start": "1958820",
    "end": "1964340"
  },
  {
    "text": "new they've been you know trusted and tried for a long time but there's been new in this side Channel or",
    "start": "1964340",
    "end": "1971360"
  },
  {
    "text": "new users inside sales is kind of new so that's that's really the use case we're testing",
    "start": "1971360",
    "end": "1977120"
  },
  {
    "text": "so concluding um both silicon we can fix the next chip if we find leakage but with pre-silicon",
    "start": "1977120",
    "end": "1984020"
  },
  {
    "text": "we can fix the current chip but only if we know where the leakage is if you just know when that's that's not actionable",
    "start": "1984020",
    "end": "1992299"
  },
  {
    "text": "um we also find that it's just doing manual review of designs is not",
    "start": "1992299",
    "end": "1997580"
  },
  {
    "text": "sufficient you really want to approach this with Statistics simulations Etc because the leakage is found in in",
    "start": "1997580",
    "end": "2004179"
  },
  {
    "text": "unexpected places and you're not going to find it if you don't know don't know where to look um",
    "start": "2004179",
    "end": "2009880"
  },
  {
    "text": "what gets me excited actually even though I apparently know a little bit about side",
    "start": "2009880",
    "end": "2015159"
  },
  {
    "text": "Channel analysis to actually do this analysis you don't need that much knowledge about it so these tools are",
    "start": "2015159",
    "end": "2022659"
  },
  {
    "text": "sort of within the domain of Hardware developers and those are the people who really have to fix it in the end we",
    "start": "2022659",
    "end": "2027940"
  },
  {
    "text": "don't want everybody to have to become a side Channel expert",
    "start": "2027940",
    "end": "2033100"
  },
  {
    "text": "and then yeah there's a couple of interesting uh future directions in terms of automatic counter measures sign",
    "start": "2033100",
    "end": "2038919"
  },
  {
    "text": "off and the Silicon validation that I just spoke about",
    "start": "2038919",
    "end": "2043679"
  },
  {
    "text": "so I didn't do this alone um I stole a bunch of slides from",
    "start": "2044679",
    "end": "2050679"
  },
  {
    "text": "um one of my Escape colleagues Patrick Soma the WPI um",
    "start": "2050679",
    "end": "2056020"
  },
  {
    "text": "yeah I've worked together with a number of institutes so WPI Purdue and then",
    "start": "2056020",
    "end": "2061599"
  },
  {
    "text": "rescue and intrinsics are two industry Partners we all made this happening happen",
    "start": "2061599",
    "end": "2067839"
  },
  {
    "text": "um one cool shout out I want to do is to the zero to Asic course if you want to get into Hardware",
    "start": "2067839",
    "end": "2074200"
  },
  {
    "text": "um maybe even tape out your own chips design go talk to medfin and follow this course I've done it I've had a lot of",
    "start": "2074200",
    "end": "2080080"
  },
  {
    "text": "fun and you know with the basic basis for the chip chip out we did and I don't consider myself a hardware designer at",
    "start": "2080080",
    "end": "2086138"
  },
  {
    "text": "all I'm not but I made it work um and then there's a scientific paper",
    "start": "2086139",
    "end": "2092020"
  },
  {
    "text": "here on an architecture correlation analysis can have a look at and if you're interested in the Hands-On not",
    "start": "2092020",
    "end": "2098200"
  },
  {
    "text": "the simulated side of Hardware hacking you can also check out the book that Carl and I wrote and with that I have",
    "start": "2098200",
    "end": "2105400"
  },
  {
    "text": "four minutes and four seconds for questions [Applause]",
    "start": "2105400",
    "end": "2112910"
  },
  {
    "text": "[Music]",
    "start": "2112910",
    "end": "2116020"
  },
  {
    "text": "[Music]",
    "start": "2119870",
    "end": "2122960"
  }
]