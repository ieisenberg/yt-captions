[
  {
    "text": "[Music] [Laughter]",
    "start": "1610",
    "end": "10260"
  },
  {
    "text": "this is Strike six pin pad Pawn by Mills and Rafal",
    "start": "10800",
    "end": "17520"
  },
  {
    "text": "so hello everyone um thanks for coming to our presentation",
    "start": "17520",
    "end": "22800"
  },
  {
    "text": "today um in this presentation we will be talking about H the security research",
    "start": "22800",
    "end": "27880"
  },
  {
    "text": "that we have performed in payment terminals um we'll we'll share with you how much fun we have had um looking at this",
    "start": "27880",
    "end": "33800"
  },
  {
    "text": "technology what will cover um well we'll have an introduction first um we'll see",
    "start": "33800",
    "end": "39640"
  },
  {
    "text": "why we decided to uh look at payment Terminals and um the approach that we took for looking at these devices and",
    "start": "39640",
    "end": "46760"
  },
  {
    "text": "finding software vulnerabilities and we look at the payment terminal ecosystem and we'll see",
    "start": "46760",
    "end": "52440"
  },
  {
    "text": "the different components that form the payment terminal ecosystem and how do they tie",
    "start": "52440",
    "end": "57519"
  },
  {
    "text": "together um then we'll move move on to cheap F ping and EMV we won't go too much in detail on EMV and we will just",
    "start": "57519",
    "end": "64640"
  },
  {
    "text": "be focusing on the aspects that are relevant for this presentation then we'll describe on",
    "start": "64640",
    "end": "69759"
  },
  {
    "text": "details in detail um the approach that we took for testing EMB we'll have three",
    "start": "69759",
    "end": "75000"
  },
  {
    "text": "different case studies and for three different er er widely used terminal H",
    "start": "75000",
    "end": "81040"
  },
  {
    "text": "currently and for these three case studies we'll have a demo for each of them so I hope you guys enjoy um and",
    "start": "81040",
    "end": "87439"
  },
  {
    "text": "just at the end we'll have a a conclusion um we'll discuss the future work that we plan to do on on This",
    "start": "87439",
    "end": "93840"
  },
  {
    "text": "research and we'll have some time for questions and answers my name is Rafa um I work as a",
    "start": "93840",
    "end": "101200"
  },
  {
    "text": "security consultant and security researcher for MWR info Security in the UK I've done some Innovative research in",
    "start": "101200",
    "end": "108280"
  },
  {
    "text": "the past on the areas of USB H finding and exploiting vulnerabilities in USB",
    "start": "108280",
    "end": "113880"
  },
  {
    "text": "drivers and also in a smart car software um finding and exploiting vulnerabilities of software that handers",
    "start": "113880",
    "end": "120360"
  },
  {
    "text": "input um that come from from the mar car itself hi uh my name is Neils um I'm",
    "start": "120360",
    "end": "126360"
  },
  {
    "text": "heading the research at NWR um some of you might have seen uh the exploits I've",
    "start": "126360",
    "end": "132239"
  },
  {
    "text": "demonstrated at uh pwn toone 2009 and 2010 and since then I've focused mostly",
    "start": "132239",
    "end": "138319"
  },
  {
    "text": "on Android security um research uh both Raff and I give the um Android security",
    "start": "138319",
    "end": "144959"
  },
  {
    "text": "Workshop as well so why",
    "start": "144959",
    "end": "150400"
  },
  {
    "text": "payment terminals well we realized that um Android spest wasn't as um as much",
    "start": "150400",
    "end": "155760"
  },
  {
    "text": "money as we thought um um no seriously now um payment terminals are widely used",
    "start": "155760",
    "end": "162280"
  },
  {
    "text": "um rarely you will see you will go for dinner and pay with cash or or do shopping and pay with cash people",
    "start": "162280",
    "end": "168239"
  },
  {
    "text": "normally use a debit card or credit card personally I I even sometimes pay a",
    "start": "168239",
    "end": "173440"
  },
  {
    "text": "single coffee with with my with my card um they're also attractive because of",
    "start": "173440",
    "end": "178720"
  },
  {
    "text": "the data that they handle um the transactions of the process payment transactions and they are very",
    "start": "178720",
    "end": "183799"
  },
  {
    "text": "attractive for an attacker um primarily from a financial perspective um the payment authorization",
    "start": "183799",
    "end": "190920"
  },
  {
    "text": "mechanism from the point of view of a of a merchant or a retailer the person that had to you the the device when you seees",
    "start": "190920",
    "end": "198040"
  },
  {
    "text": "in the in on the display um payment successful um that retailer trust that",
    "start": "198040",
    "end": "203159"
  },
  {
    "text": "terminals being a successful payment because they are more and more powerful and they have uh more",
    "start": "203159",
    "end": "208959"
  },
  {
    "text": "functionality um and with more functionality the attack surface attack surface increase",
    "start": "208959",
    "end": "215319"
  },
  {
    "text": "we see payment terminals that has Wireless uh Bluetooth um they can be administered remotely and they can",
    "start": "215319",
    "end": "222000"
  },
  {
    "text": "render adverts um and this all this helps to the to the attack surface of",
    "start": "222000",
    "end": "227280"
  },
  {
    "text": "the device and because it's the single point of fa failure H for the merchant and the card holder that is using these",
    "start": "227280",
    "end": "235159"
  },
  {
    "text": "devices for electronic payments they been they've been previous",
    "start": "235159",
    "end": "241280"
  },
  {
    "text": "attacks and these have been focused on H Hardware mainly um we have seen terminal",
    "start": "241280",
    "end": "246560"
  },
  {
    "text": "scheming H where H the hardware is modified to gather this data some of these uh techniques are um relatively",
    "start": "246560",
    "end": "254519"
  },
  {
    "text": "Advanced where they gather information and then they send this information via Wireless of Bluetooth to the attacker a",
    "start": "254519",
    "end": "261120"
  },
  {
    "text": "little bit more of a a less elegant attack are attackers that actually um",
    "start": "261120",
    "end": "268840"
  },
  {
    "text": "replace ly the device for a malicious device that um is identical to the",
    "start": "268840",
    "end": "274160"
  },
  {
    "text": "legitimate legitimate ter terminal itself um we have seen also more sophisticated attacks um where a",
    "start": "274160",
    "end": "281120"
  },
  {
    "text": "malicious developer or engineer actually manipulate the application or develop application that um H gather information",
    "start": "281120",
    "end": "288479"
  },
  {
    "text": "about the payment transactions um there is a very good uh interesting paper from",
    "start": "288479",
    "end": "293600"
  },
  {
    "text": "MasterCard um titled understanding terminal manipulation at the point of sale and this talks um a little bit bit",
    "start": "293600",
    "end": "299800"
  },
  {
    "text": "about this H type of uh of attacks um something that is very interesting is H",
    "start": "299800",
    "end": "305680"
  },
  {
    "text": "ER when it talks about what criminals do to gather information and how they go to",
    "start": "305680",
    "end": "311759"
  },
  {
    "text": "er er internet ER oceans to actually purchase these tment terminal payment",
    "start": "311759",
    "end": "319560"
  },
  {
    "text": "terminals um so they can gather information how do they work and the technology that they use and so the",
    "start": "319560",
    "end": "325440"
  },
  {
    "text": "attacks can be more targeted um in the same way um this also",
    "start": "325440",
    "end": "330600"
  },
  {
    "text": "describe a little bit about how um they will also Target a specific payment",
    "start": "330600",
    "end": "336560"
  },
  {
    "text": "terminals that are used in a specific retailer h Shop um this is something very",
    "start": "336560",
    "end": "343400"
  },
  {
    "text": "interesting that we found on the internet in a in a forum post uh from a freelancer um I for those that cannot",
    "start": "343400",
    "end": "351840"
  },
  {
    "text": "read it from the far is basically say it's a asking for for someone to do a",
    "start": "351840",
    "end": "357960"
  },
  {
    "text": "job the budget is between 3,500,000 and we need someone who can",
    "start": "357960",
    "end": "363639"
  },
  {
    "text": "modify a payment terminals um so that it will record track one track two and ping",
    "start": "363639",
    "end": "370319"
  },
  {
    "text": "for debit credit card transaction and credit card transaction need to print out receip I need to have a menu for",
    "start": "370319",
    "end": "376560"
  },
  {
    "text": "debit car and credit um if car with chip is enter it",
    "start": "376560",
    "end": "381960"
  },
  {
    "text": "should say error please please swipe car that's not dodgy at all is",
    "start": "381960",
    "end": "387680"
  },
  {
    "text": "it so we can see that there is people out there already um putting some intelligence on how to um perform this",
    "start": "388400",
    "end": "397840"
  },
  {
    "text": "perform these type of attacks and actually look at um how attacking these payment terminals soare Securities well payment",
    "start": "397840",
    "end": "405120"
  },
  {
    "text": "terminals are essentially a small computer um they run a payment terminal application um to handle the payment",
    "start": "405120",
    "end": "412160"
  },
  {
    "text": "transactions and as as any other computer uh that takes data and process data um and run applications their",
    "start": "412160",
    "end": "419720"
  },
  {
    "text": "sofware vulnerabilities the attack surface can be based on the hardware",
    "start": "419720",
    "end": "425199"
  },
  {
    "text": "peripherals that are on the device such as the magnetic stripe um chip and pin",
    "start": "425199",
    "end": "430400"
  },
  {
    "text": "the network communication um serial Port jtac setup menu if the attacker has got",
    "start": "430400",
    "end": "435680"
  },
  {
    "text": "access to to physical access to the to the device itself the research approach that we",
    "start": "435680",
    "end": "442400"
  },
  {
    "text": "took was to um to see if it was possible to find software vulnerabilities in this",
    "start": "442400",
    "end": "448759"
  },
  {
    "text": "payment terminal the approach that we took was completely from a blackbox pers perspect",
    "start": "448759",
    "end": "454960"
  },
  {
    "text": "perspective um and only using public available information that is available",
    "start": "454960",
    "end": "460400"
  },
  {
    "text": "to anyone in the on the internet although it would have been very useful to have access to the SDK of some of",
    "start": "460400",
    "end": "466759"
  },
  {
    "text": "these terminals um this would also put us under an NDA and we wouldn't be able to share this information with you today",
    "start": "466759",
    "end": "473759"
  },
  {
    "text": "guys um for this H research um we purchase a a payment terminals mainly",
    "start": "473759",
    "end": "482199"
  },
  {
    "text": "from eBay and um other providers which would rather prefer to meet up in a car",
    "start": "482199",
    "end": "489120"
  },
  {
    "text": "park and they would only accept cash um um using second hand terminal from uh",
    "start": "489120",
    "end": "496919"
  },
  {
    "text": "from eBay um is very interesting because um in the majority that we have purchased uh they were already set up",
    "start": "496919",
    "end": "504440"
  },
  {
    "text": "for payments they have a payment application installed and they were ready to go so anyone up for a",
    "start": "504440",
    "end": "512440"
  },
  {
    "text": "refund um so the were configure basically what is been happening is that um It's relatively easy to get these",
    "start": "512440",
    "end": "518919"
  },
  {
    "text": "terminals from the internet and relatively cheap mainly because with the recession and a lot of retailer",
    "start": "518919",
    "end": "524200"
  },
  {
    "text": "companies going into Administration and we have a situation where these",
    "start": "524200",
    "end": "529240"
  },
  {
    "text": "terminals are being treated as asset which people just remove it from the",
    "start": "529240",
    "end": "534399"
  },
  {
    "text": "shop when they go into Administration and they just sell it and it doesn't seem to be a control where this ter are",
    "start": "534399",
    "end": "539600"
  },
  {
    "text": "WIP before before they go on on on on oceans um this picture here um is our",
    "start": "539600",
    "end": "547880"
  },
  {
    "text": "lab as you can see there is different type of terminals from different vendors with different H functionality some of",
    "start": "547880",
    "end": "554800"
  },
  {
    "text": "them are chip and ping other are are signature based H payment terminals um",
    "start": "554800",
    "end": "560320"
  },
  {
    "text": "and this picture actually reflects uh very well the current H share market of",
    "start": "560320",
    "end": "566000"
  },
  {
    "text": "payment terminals in the UK",
    "start": "566000",
    "end": "571120"
  },
  {
    "text": "the common setups that we have seen um are as follow and we've seen a dam terminals that are connected to a post",
    "start": "571279",
    "end": "577920"
  },
  {
    "text": "system being the post system the H PC that the ER person in the shop actually",
    "start": "577920",
    "end": "585040"
  },
  {
    "text": "uh perform the the payment trans transactions these Dum terminals are actually very simple and there's very",
    "start": "585040",
    "end": "591720"
  },
  {
    "text": "little functionality within them most of the core payment functionality is happening in the post um the post send",
    "start": "591720",
    "end": "598600"
  },
  {
    "text": "commands to to the H to the terminal and the terminal it basically acts as a um",
    "start": "598600",
    "end": "604360"
  },
  {
    "text": "interface for the user to enter the card we've seing other type of terminals that",
    "start": "604360",
    "end": "609519"
  },
  {
    "text": "are more powerful and more of the core functionality is happening H within the terminal itself where the pay where they",
    "start": "609519",
    "end": "617120"
  },
  {
    "text": "will have a payment application running that will handle the payment transactions these payment applications",
    "start": "617120",
    "end": "623200"
  },
  {
    "text": "can come uh from the vendor um third parties that have access to the SDK and they develop applications or they are",
    "start": "623200",
    "end": "629480"
  },
  {
    "text": "slightly modified vendor applications with um the company logo or the welcome",
    "start": "629480",
    "end": "634680"
  },
  {
    "text": "message um the way this terminals connect and we've seen they can connect",
    "start": "634680",
    "end": "640320"
  },
  {
    "text": "to internal systems or they can connect to third party H providers um going through through the",
    "start": "640320",
    "end": "647720"
  },
  {
    "text": "internet so this is the payment terminal ecosystem where the different parties H",
    "start": "647720",
    "end": "652880"
  },
  {
    "text": "that handle payment terminals lift we have the manufacturer who um design and",
    "start": "652880",
    "end": "659040"
  },
  {
    "text": "manufactur the payment terminals the manufacturers will provide the terminals",
    "start": "659040",
    "end": "664240"
  },
  {
    "text": "to the acquirer the acquirer act as a third party company um who um sells services",
    "start": "664240",
    "end": "671240"
  },
  {
    "text": "to the retailer such as setting up the terminal um personalizing the payment",
    "start": "671240",
    "end": "676519"
  },
  {
    "text": "applications um doing any general maintenance service that are required and the retailer is actually the",
    "start": "676519",
    "end": "683160"
  },
  {
    "text": "consumer of the those payment terminals um the ones that are going to be using these terminals to take a um er payment",
    "start": "683160",
    "end": "693320"
  },
  {
    "text": "transactions the manufacturer also provide the SDK and the require um",
    "start": "693320",
    "end": "698920"
  },
  {
    "text": "development tools for the developer to develop the application and sign the applications the developer will develop",
    "start": "698920",
    "end": "706000"
  },
  {
    "text": "applications for the acquirer and for the retailer we've seen in cases where",
    "start": "706000",
    "end": "711680"
  },
  {
    "text": "actually the manufacturer can deal straight away with the retailer and provide all these services in one",
    "start": "711680",
    "end": "720959"
  },
  {
    "text": "um one particular focus of our research was um um chip and pin payments so where",
    "start": "723639",
    "end": "729560"
  },
  {
    "text": "a smart card is used to make the payment um some of you might not have come across that especially if you're from",
    "start": "729560",
    "end": "736240"
  },
  {
    "text": "the US so we'll give a quick introduction of what what that is so Chip and pin payments are a major",
    "start": "736240",
    "end": "741760"
  },
  {
    "text": "Improvement o over mexri payments um it's very widely implemented in Europe",
    "start": "741760",
    "end": "747240"
  },
  {
    "text": "uh in the UK for example every single payment will be a chip and pin payment unless you have a credit card from the",
    "start": "747240",
    "end": "752880"
  },
  {
    "text": "US or from other countries that that do chip and pin um basically the payments",
    "start": "752880",
    "end": "758279"
  },
  {
    "text": "are split up between offline and online payments for an offline payment the payment terminal itself will verify the",
    "start": "758279",
    "end": "765079"
  },
  {
    "text": "uh the authenticity of the of the card and the user will verify the pin against the",
    "start": "765079",
    "end": "771279"
  },
  {
    "text": "card and with online payments the terminal will connect back to the bank or to the payment provider and the",
    "start": "771279",
    "end": "777360"
  },
  {
    "text": "payment provider will provide authorization for this payment um compared to the max stripe",
    "start": "777360",
    "end": "784839"
  },
  {
    "text": "the the chip allows for much better user authentication um it can from one from",
    "start": "784839",
    "end": "790839"
  },
  {
    "text": "one point of view it can hold much more static data which uh authenticates the card so much more information that uh",
    "start": "790839",
    "end": "798440"
  },
  {
    "text": "will that can be signed by the bank for example to say and this is a valid card or signed by the card issuer um and it",
    "start": "798440",
    "end": "806160"
  },
  {
    "text": "also actively um allows you to sign sign payment so a card is now able to sign",
    "start": "806160",
    "end": "812279"
  },
  {
    "text": "information which represent the payment uh by generating a so-called cryptogram",
    "start": "812279",
    "end": "817959"
  },
  {
    "text": "um in the case of Chip and pin payments the one side is a chip the other side is the pin and the pin number uh now",
    "start": "817959",
    "end": "824680"
  },
  {
    "text": "replaces signature or IDs which are um commonly used in the US for uh",
    "start": "824680",
    "end": "829959"
  },
  {
    "text": "authenication of of card holders um quite interestingly the US is also",
    "start": "829959",
    "end": "837079"
  },
  {
    "text": "about to or there are a lot of discussions around adapting chip and pin and making chip and pin payments",
    "start": "837079",
    "end": "843040"
  },
  {
    "text": "mandatory U while it is already mandatory in in a lot of other countries in the",
    "start": "843040",
    "end": "849279"
  },
  {
    "text": "world um really really quick um just to understand the the next few slides as well an introduction into smart cards",
    "start": "849279",
    "end": "856320"
  },
  {
    "text": "and how smart cards communicate with host systems such as payment terminals uh when you insert a smart card into a",
    "start": "856320",
    "end": "863360"
  },
  {
    "text": "uh a payment terminal it is powered up by the payment terminal and as the first response to this powering up as smart",
    "start": "863360",
    "end": "869040"
  },
  {
    "text": "card will send an answer to reset to the device and this answer to reset will hold information about the protocols",
    "start": "869040",
    "end": "875120"
  },
  {
    "text": "that are spoken by the uh by the smart card um the the type of um uh type of",
    "start": "875120",
    "end": "881959"
  },
  {
    "text": "smart card um and an ID for for the type of smart card as well and then the the",
    "start": "881959",
    "end": "887040"
  },
  {
    "text": "host or the payment terminal um always sends commands U commands are apus which",
    "start": "887040",
    "end": "892639"
  },
  {
    "text": "is CH for application D protocol data units and the host system will all always send this AP PD use uh to the",
    "start": "892639",
    "end": "900360"
  },
  {
    "text": "smart card and the smart card only ever responds to request sents by a house so",
    "start": "900360",
    "end": "905959"
  },
  {
    "text": "the the smart cut itself was never initiating any um any",
    "start": "905959",
    "end": "912240"
  },
  {
    "text": "communication um the de facto standard for chip and pin payments is EMV which",
    "start": "912759",
    "end": "918880"
  },
  {
    "text": "is sought for europay MasterCard and Visa so this is a standard created by the uh most prominent uh card issuers um",
    "start": "918880",
    "end": "928680"
  },
  {
    "text": "it is used for mostly for for credit and debit cards but also um for gift cards",
    "start": "928680",
    "end": "933800"
  },
  {
    "text": "so you might go into a a shopping mall and might might buy a gift card there and that will use the same standard uh",
    "start": "933800",
    "end": "940800"
  },
  {
    "text": "very interestingly um NFC payments very very often use EMV as well as a",
    "start": "940800",
    "end": "946600"
  },
  {
    "text": "underlying protocol for communicating between the NFC Reader and the NFC uh",
    "start": "946600",
    "end": "952120"
  },
  {
    "text": "smart card and there are some older implementations uh specifically in the US which use older protocols but but",
    "start": "952120",
    "end": "959000"
  },
  {
    "text": "nowadays almost all all of them use um EMV for communication and EMV defines aspects of",
    "start": "959000",
    "end": "965959"
  },
  {
    "text": "this communication between the smart card and the payment terminal such as uh multiple card applications so you can",
    "start": "965959",
    "end": "972759"
  },
  {
    "text": "theoretically you can have one credit card which has a visa application and a MasterCard application and some other",
    "start": "972759",
    "end": "978959"
  },
  {
    "text": "payment applications on this card and uh while making the the payment the",
    "start": "978959",
    "end": "984199"
  },
  {
    "text": "terminal decides which of these uh so-called uh application to select for",
    "start": "984199",
    "end": "990079"
  },
  {
    "text": "for making the payment um and it holds um a lot of data which identifies the",
    "start": "990079",
    "end": "996639"
  },
  {
    "text": "card and which gives the terminal more information about the card and this will include um not the pin the uh primary",
    "start": "996639",
    "end": "1003720"
  },
  {
    "text": "account number the pin is not sort as data obviously in there expiry date and then also information um which um",
    "start": "1003720",
    "end": "1011800"
  },
  {
    "text": "specify what uh specific methods for card holder verification are supported",
    "start": "1011800",
    "end": "1017240"
  },
  {
    "text": "by the uh by by the smart card and other things um",
    "start": "1017240",
    "end": "1022519"
  },
  {
    "text": "and it also defines how pins are verified and and several other aspects as well and there's a um uh a very",
    "start": "1022519",
    "end": "1029360"
  },
  {
    "text": "useful resource on the internet which is uh EMV lab.org and that gives you a lot of information on how em Works uh what",
    "start": "1029360",
    "end": "1036240"
  },
  {
    "text": "kind of Texs are are used to store the data and what data is stored on these",
    "start": "1036240",
    "end": "1041520"
  },
  {
    "text": "cards um for us specifically interesting when when we were doing this research where the EM records in this case uh",
    "start": "1041520",
    "end": "1048919"
  },
  {
    "text": "payment terminal is issuing several read records commands against the smart card",
    "start": "1048919",
    "end": "1054039"
  },
  {
    "text": "and it responds with uh the EM records which are stored in a tlv data format so",
    "start": "1054039",
    "end": "1059720"
  },
  {
    "text": "you have Tech lengths value which we see in asn1 for example quite often and",
    "start": "1059720",
    "end": "1064840"
  },
  {
    "text": "passing of these these uh kind of data which you have seen also in asn1 fairly",
    "start": "1064840",
    "end": "1070200"
  },
  {
    "text": "often is is quite error prone because you have the length specified and then a value which doesn't necessarily need to",
    "start": "1070200",
    "end": "1076320"
  },
  {
    "text": "match the length and so on and this is an example of how data can be stored on",
    "start": "1076320",
    "end": "1081600"
  },
  {
    "text": "a card um it is uh so so these these data structures can also be nested so we",
    "start": "1081600",
    "end": "1087600"
  },
  {
    "text": "see a record template first and then the expiry date effective date and the",
    "start": "1087600",
    "end": "1092880"
  },
  {
    "text": "primary account number as well so that's all stored in in these uh Records on the",
    "start": "1092880",
    "end": "1098480"
  },
  {
    "text": "card um if you want to know more about how these uh payment terminals are",
    "start": "1098480",
    "end": "1103640"
  },
  {
    "text": "implemented how chip and pin uh payments are often implemented and a lot of information about EMV and the whole um",
    "start": "1103640",
    "end": "1111039"
  },
  {
    "text": "process of implementing EMV that's a very good book to to to read up on this um implementing electronic card payment",
    "start": "1111039",
    "end": "1117840"
  },
  {
    "text": "systems by by Christen Ru and that was very helpful in our research as",
    "start": "1117840",
    "end": "1123760"
  },
  {
    "text": "well so the next thing we did um well was to test how these smart cards",
    "start": "1123799",
    "end": "1131120"
  },
  {
    "text": "communicate with the p payment Terminals and to see how they communicate with the payment terminals in order to find",
    "start": "1131120",
    "end": "1136720"
  },
  {
    "text": "issues in this communication um our first approach was man in the midling smart cut communication um this",
    "start": "1136720",
    "end": "1144320"
  },
  {
    "text": "device some of you might have seen a few uh where are into satellite TV hacking",
    "start": "1144320",
    "end": "1149679"
  },
  {
    "text": "um it's a device which you plug into into any any smartcut host device and",
    "start": "1149679",
    "end": "1155080"
  },
  {
    "text": "then you plug the smart card into this device and connect it with the serial port to your to your PC um and",
    "start": "1155080",
    "end": "1162559"
  },
  {
    "text": "theoretically it should show you the communication uh however we found this uh to be very depending on the timing of",
    "start": "1162559",
    "end": "1169600"
  },
  {
    "text": "the payment terminal and timing of the card and we got it to work on some terminals with some cards but it was",
    "start": "1169600",
    "end": "1175360"
  },
  {
    "text": "wasn't very reliable um there's another solution for that um uh called The Smart",
    "start": "1175360",
    "end": "1181120"
  },
  {
    "text": "Card detective U which we weren't able to get hold on for this research unfortunately um so we had to find",
    "start": "1181120",
    "end": "1188240"
  },
  {
    "text": "another way of doing this and what we decided to do is to implement a smart card which locks commands sent to the",
    "start": "1188240",
    "end": "1194880"
  },
  {
    "text": "smart card by a payment terminal and also a programmable by us to program it",
    "start": "1194880",
    "end": "1200799"
  },
  {
    "text": "with uh with responses to respond to a payment terminal um we decided to go for",
    "start": "1200799",
    "end": "1206400"
  },
  {
    "text": "a sequence of responses so basically you have two options here you can say that you want uh the smart card to respond to",
    "start": "1206400",
    "end": "1213799"
  },
  {
    "text": "specific um specific requests in in in that way um which is not the best way of",
    "start": "1213799",
    "end": "1221400"
  },
  {
    "text": "doing that we found for EMV because you might have requests which based on the C current state of the card result in",
    "start": "1221400",
    "end": "1228200"
  },
  {
    "text": "different uh responses so we decided to program it with a sequence so static",
    "start": "1228200",
    "end": "1233400"
  },
  {
    "text": "sequence of responses so answer to the first request was this response answer",
    "start": "1233400",
    "end": "1238679"
  },
  {
    "text": "which is the second request was this response and we found that if you if you use the same card against the payment",
    "start": "1238679",
    "end": "1243760"
  },
  {
    "text": "terminal that this sequence will always be the same so that work well for us um",
    "start": "1243760",
    "end": "1249080"
  },
  {
    "text": "just from a practical point of view for the implementation we use basic cards which is basically basic programming on",
    "start": "1249080",
    "end": "1255640"
  },
  {
    "text": "Smart cards which is kind of ugly but much easier to set up uh than Java cards",
    "start": "1255640",
    "end": "1261280"
  },
  {
    "text": "um actually in setting up an development environment especially when working with mult multiple people on a project for",
    "start": "1261280",
    "end": "1268559"
  },
  {
    "text": "Java cards which works for everyone is um probably impossible um so so we",
    "start": "1268559",
    "end": "1273799"
  },
  {
    "text": "decided to go for basic cards which comes with a very well integrated development environment which you can",
    "start": "1273799",
    "end": "1279559"
  },
  {
    "text": "straight away install and then you have to program basic but but it's still better than setting up Java Cod",
    "start": "1279559",
    "end": "1285559"
  },
  {
    "text": "development environments so basically what what happens um and",
    "start": "1285559",
    "end": "1291440"
  },
  {
    "text": "how we how we uh manage to to see the communication between a payment terminal using this smart card is as follows we",
    "start": "1291440",
    "end": "1298919"
  },
  {
    "text": "plug in our program basic card uh with our specific program which does the logging and which can hold a sequence of",
    "start": "1298919",
    "end": "1305080"
  },
  {
    "text": "responses we plug that into a payment terminal it will then lock all the",
    "start": "1305080",
    "end": "1310360"
  },
  {
    "text": "commands sent to it um by the payment terminal on the card and in the next",
    "start": "1310360",
    "end": "1316039"
  },
  {
    "text": "step we plug it back into our PC and to this PC we have a valid card so valid",
    "start": "1316039",
    "end": "1322240"
  },
  {
    "text": "credit card connected as well and U the PC will now replay all the respon uh",
    "start": "1322240",
    "end": "1327400"
  },
  {
    "text": "requests it has seen from the payment terminal it will um replay them back to",
    "start": "1327400",
    "end": "1332640"
  },
  {
    "text": "the valid card and store the the responses it sees from the valid card",
    "start": "1332640",
    "end": "1338159"
  },
  {
    "text": "back onto um our basic card and then we repeat the process until um we don't get",
    "start": "1338159",
    "end": "1345080"
  },
  {
    "text": "any new requests that are sent by the payment terminal and we can um we can",
    "start": "1345080",
    "end": "1350919"
  },
  {
    "text": "this way then we can build a card which works against payment Terminals and which at least kind of clones the card",
    "start": "1350919",
    "end": "1356720"
  },
  {
    "text": "it won't clone the card up to a point where you can actually make payments with it because there's some crypto magic happening as well however you can",
    "start": "1356720",
    "end": "1363360"
  },
  {
    "text": "clone it so that you can get fairly deep down into the protocol and look at the protocol and look at what is happening",
    "start": "1363360",
    "end": "1369120"
  },
  {
    "text": "in this communication so that's basically what we used to look at at several payment",
    "start": "1369120",
    "end": "1375600"
  },
  {
    "text": "terminals uh we in this presentation we included three of our payment terminals",
    "start": "1375600",
    "end": "1381360"
  },
  {
    "text": "that we have been looking at um so these these payment terminals we",
    "start": "1381360",
    "end": "1387200"
  },
  {
    "text": "so we as we said we looked at a bunch um of payment Terminals and um our research",
    "start": "1387200",
    "end": "1393559"
  },
  {
    "text": "was fairly gold driven so we wanted to find and exploit the uh some security software security vulnerabilities in",
    "start": "1393559",
    "end": "1399960"
  },
  {
    "text": "these payment terminals um and these were the terminals where we first were able to to get some progress to get some",
    "start": "1399960",
    "end": "1406679"
  },
  {
    "text": "understanding of how they work and find find vulnerabilities in them as well um all the vulnerabilities are currently",
    "start": "1406679",
    "end": "1412480"
  },
  {
    "text": "with the vendors um and there's one of the vulnerabilities is patched already",
    "start": "1412480",
    "end": "1417880"
  },
  {
    "text": "which is quite impressive um and um for in our presentation we don't want to",
    "start": "1417880",
    "end": "1423200"
  },
  {
    "text": "name and shame any vendors uh specifically because we don't have a fair viiew so we can't say we have tested all the payment terminals in in",
    "start": "1423200",
    "end": "1430279"
  },
  {
    "text": "the same manner because we went for the first ones where where we got lucky and found vulnerabilities um and because the",
    "start": "1430279",
    "end": "1437559"
  },
  {
    "text": "vulner abilities are not patched yet and even though there's a patch for one vulnerability it will take um uh I I",
    "start": "1437559",
    "end": "1444960"
  },
  {
    "text": "suppose it will take quite a while to patch these in every shop that is out there so we won't include any uh uh",
    "start": "1444960",
    "end": "1452240"
  },
  {
    "text": "vulnerability details either so the first payment terminal is",
    "start": "1452240",
    "end": "1457279"
  },
  {
    "text": "this one um you might have come across this terminal if you if you like to buy your coffee at your coffee shop around",
    "start": "1457279",
    "end": "1463400"
  },
  {
    "text": "the corner on on any corner here in the US um and and this terminal is so it's",
    "start": "1463400",
    "end": "1469480"
  },
  {
    "text": "very widely used in in the in the UK as well it's used in the US in the US you would stripe your card and in the UK you",
    "start": "1469480",
    "end": "1476000"
  },
  {
    "text": "will use chip and pin on these terminals um it is actually connected often connected through Ethernet so it has an",
    "start": "1476000",
    "end": "1481880"
  },
  {
    "text": "Ethernet port on the back um a Serial Port um it has a buil in modem to to",
    "start": "1481880",
    "end": "1486960"
  },
  {
    "text": "talk through the phone line um and a integrated printer as",
    "start": "1486960",
    "end": "1492480"
  },
  {
    "text": "well the first thing that we were able to do and uh if you follow us in Twitter you will have seen this picture was to",
    "start": "1493200",
    "end": "1500120"
  },
  {
    "text": "trigger a a stack based buffer overflow through the network communication of these terminals um fairly",
    "start": "1500120",
    "end": "1507279"
  },
  {
    "text": "straightforward St stack based buffer overflow with a lot of control on our side so we we almost were able to get",
    "start": "1507279",
    "end": "1514039"
  },
  {
    "text": "any characters in there any lengths of data basically the perfect situation for us and that's that's one of the reasons",
    "start": "1514039",
    "end": "1520720"
  },
  {
    "text": "why we focus on this terminal then um this Tech based buffer overflow we",
    "start": "1520720",
    "end": "1525880"
  },
  {
    "text": "were then able to use by sending a lot of data in there and um so so on on this screen what you see is uh only very",
    "start": "1525880",
    "end": "1532640"
  },
  {
    "text": "limited information of and that was all the debugging information that was available to us as well so we didn't",
    "start": "1532640",
    "end": "1539120"
  },
  {
    "text": "have a debugger running on the devices we didn't have um more registers than this or a more detailed bu report the",
    "start": "1539120",
    "end": "1546679"
  },
  {
    "text": "only thing that we had had was the status register uh program counter link",
    "start": "1546679",
    "end": "1551880"
  },
  {
    "text": "register and the address that led to the crash um um by sending in a lot of data in um",
    "start": "1551880",
    "end": "1560919"
  },
  {
    "text": "we we made it to to crash not while while returning from the function which had the stack buffer overflow in it but",
    "start": "1560919",
    "end": "1566520"
  },
  {
    "text": "instead crash at the end of the stack and that gave us an idea where the stack is located on these devices at which",
    "start": "1566520",
    "end": "1573080"
  },
  {
    "text": "address range which then allowed us to jump into the deck you won't see any of the um any of the memory protections",
    "start": "1573080",
    "end": "1579679"
  },
  {
    "text": "that are common in in computer or um uh mobile phone systems um so we were able",
    "start": "1579679",
    "end": "1586720"
  },
  {
    "text": "to execute code know on this device but we didn't have much information what code to execute from this error look we",
    "start": "1586720",
    "end": "1594039"
  },
  {
    "text": "we can make a good guess and say this is an arm platform um which at least allowed allowed us to to guess what kind",
    "start": "1594039",
    "end": "1601000"
  },
  {
    "text": "of instructions to execute but um we had to do very careful probing and manual",
    "start": "1601000",
    "end": "1606760"
  },
  {
    "text": "manual manual memory dumping like you see here uh so that is uh a partial dump",
    "start": "1606760",
    "end": "1612240"
  },
  {
    "text": "of the stack on the system uh to give us ideas of where uh where where the the",
    "start": "1612240",
    "end": "1618039"
  },
  {
    "text": "binaries are located where where the Heap is located and so on um until we",
    "start": "1618039",
    "end": "1623559"
  },
  {
    "text": "got up to a point where we were able to have enough information about the system mostly done by manual dumping to dump",
    "start": "1623559",
    "end": "1630880"
  },
  {
    "text": "the memory back to us arbitrary memory regions through the ethernet connections through the TCP connection that already",
    "start": "1630880",
    "end": "1636600"
  },
  {
    "text": "existed because that's what we used to trigger the fault um and that finally allowed us to properly analyze the",
    "start": "1636600",
    "end": "1642600"
  },
  {
    "text": "application we got an idea how systems call on this um custom operating system work uh we have never seen any",
    "start": "1642600",
    "end": "1649080"
  },
  {
    "text": "references uh to to this specific operating system um for all that we know",
    "start": "1649080",
    "end": "1655039"
  },
  {
    "text": "it's it's custom to these systems and it also allowed us to find more weaknesses in the systems um some of them so in",
    "start": "1655039",
    "end": "1662120"
  },
  {
    "text": "this case we have a third party payment application running on there by a third party payment provider um and in some",
    "start": "1662120",
    "end": "1669279"
  },
  {
    "text": "cases we found hardcoded passwords in the application so you you actually have a check for the um password from the",
    "start": "1669279",
    "end": "1676799"
  },
  {
    "text": "configuration file for example for the setup menu and then a second check if that fails against the hardcoded value",
    "start": "1676799",
    "end": "1683559"
  },
  {
    "text": "um and we also F found other vulnerabilities and we were able to find vulnerabilities in handling of Chip and",
    "start": "1683559",
    "end": "1690840"
  },
  {
    "text": "pin",
    "start": "1690840",
    "end": "1693080"
  },
  {
    "text": "payments so um the question here is how we got the stack dump out of the device",
    "start": "1696519",
    "end": "1702000"
  },
  {
    "text": "so we were able to exe so we had some information about memory layout so we had the stack address already um and",
    "start": "1702000",
    "end": "1708720"
  },
  {
    "text": "then by executing code and executing so at the beginning you will just end up executing code like if this address",
    "start": "1708720",
    "end": "1715519"
  },
  {
    "text": "contains this value then go in into an endless loop and we see the device getting stuck or uh jump to the value of",
    "start": "1715519",
    "end": "1722960"
  },
  {
    "text": "the address at that address and we will get the error lock and showing you the the content at this this address and",
    "start": "1722960",
    "end": "1729000"
  },
  {
    "text": "then slowly you can Pro progress at some point you get some code back and that gives you an idea of how to print onto",
    "start": "1729000",
    "end": "1735679"
  },
  {
    "text": "the screen and then finally we were able to use that to dump more data up to a point where we were able to dump that",
    "start": "1735679",
    "end": "1741519"
  },
  {
    "text": "back through the TCP connection and then we can can basically read all the memory from the",
    "start": "1741519",
    "end": "1747000"
  },
  {
    "text": "device um so the the first chip and pin vulnerability that we found in here is",
    "start": "1747000",
    "end": "1753000"
  },
  {
    "text": "again a fairly straightforward um stack stack based buffer overflow in the handling of EMB uh Tex so that's that's",
    "start": "1753000",
    "end": "1759919"
  },
  {
    "text": "the records that we have seen previously and it allows us for arbitrary code execution now for the implementation of",
    "start": "1759919",
    "end": "1767200"
  },
  {
    "text": "um an exploit against the devices um a single response to an to an apdu request",
    "start": "1767200",
    "end": "1773480"
  },
  {
    "text": "to the smart card won't be enough to hold all the data especially not in this case where we will only be able to",
    "start": "1773480",
    "end": "1780039"
  },
  {
    "text": "control 40 bytes really after after triggering the crash uh however we were able to use these 40 bytes to do return",
    "start": "1780039",
    "end": "1787279"
  },
  {
    "text": "oriented programming to call the methods that request more data from the smart card um in order to retrieve more data",
    "start": "1787279",
    "end": "1794480"
  },
  {
    "text": "from the smart cut which then contained our second stage of the payload and the second stage um was um well around 200",
    "start": "1794480",
    "end": "1804279"
  },
  {
    "text": "bytes of Control Data allowed us then to implement a Shell Code which can almost load an arbitrary amount um of data from",
    "start": "1804279",
    "end": "1812960"
  },
  {
    "text": "the smart cut into the memory and then we are able to execute and this as our our uh final payload and in the",
    "start": "1812960",
    "end": "1820640"
  },
  {
    "text": "demonstration that we will show now um this payload is actually 870 bytes of arm sum instructions",
    "start": "1820640",
    "end": "1828440"
  },
  {
    "text": "and that will be our first",
    "start": "1828440",
    "end": "1831480"
  },
  {
    "text": "demonstration so this is the terminal you already have seen on the picture previously I hope you can um at least",
    "start": "1838080",
    "end": "1846279"
  },
  {
    "text": "fairly well see the screen but that should be fine and in this case we demonstrate um how to use a malicious",
    "start": "1846279",
    "end": "1853600"
  },
  {
    "text": "smart cut and this is our malicious smart cut and does anyone recognize the",
    "start": "1853600",
    "end": "1860159"
  },
  {
    "text": "game very good so we start a payment process on the device in this case it",
    "start": "1860159",
    "end": "1866240"
  },
  {
    "text": "tries to connect to the bank Network um obviously we haven't connected these systems to a bank network but this one",
    "start": "1866240",
    "end": "1871600"
  },
  {
    "text": "is set up to accept offline payments as well and that's what we will do now so we start an offline payment it will be a",
    "start": "1871600",
    "end": "1878080"
  },
  {
    "text": "sale in or anyone after refund um we start a uh start a sale enter an amount",
    "start": "1878080",
    "end": "1885320"
  },
  {
    "text": "and that would would be what is happening in an actual shop so uh the merchant will start the payment process",
    "start": "1885320",
    "end": "1892120"
  },
  {
    "text": "uh enter reference number and then uh the customers asked to insert or swipe",
    "start": "1892120",
    "end": "1897279"
  },
  {
    "text": "the card uh this this payment terminal was used in the UK so we inserted chip and pin card uh which is this specific",
    "start": "1897279",
    "end": "1904039"
  },
  {
    "text": "card and that will trigger the stack based buffer overflow through um through",
    "start": "1904039",
    "end": "1910039"
  },
  {
    "text": "um the the weaknesses and The Smart Card handling on this device we'll insert the card uh we'll read the data from the",
    "start": "1910039",
    "end": "1916519"
  },
  {
    "text": "device and then it starts the racing game on the",
    "start": "1916519",
    "end": "1920760"
  },
  {
    "text": "[Music] [Applause] device and game over and also quite",
    "start": "1924190",
    "end": "1931440"
  },
  {
    "text": "interestingly on the card printer we see how it prints the score uh in this case",
    "start": "1931440",
    "end": "1936559"
  },
  {
    "text": "46 um the record in the office is at 75 um which is very",
    "start": "1936559",
    "end": "1943639"
  },
  {
    "text": "impressive um gameplay on these devices is actually quite good and they are",
    "start": "1943639",
    "end": "1949120"
  },
  {
    "text": "powerful powerful enough to run these kind of games as",
    "start": "1949120",
    "end": "1954240"
  },
  {
    "text": "well it is a presentation so our first demonstration um that's what you see on",
    "start": "1956679",
    "end": "1962919"
  },
  {
    "text": "the terminal uh printing of the score and the mwls pin pad racer game and",
    "start": "1962919",
    "end": "1968720"
  },
  {
    "text": "that's the card that was used to trigger this issue so what have you seen here we have",
    "start": "1968720",
    "end": "1974480"
  },
  {
    "text": "code execution in the context of the payment application um we reported this issue to the vendor",
    "start": "1974480",
    "end": "1980519"
  },
  {
    "text": "and the vendor is currently working on a fix um interesting is so okay this was a",
    "start": "1980519",
    "end": "1986279"
  },
  {
    "text": "game but the only playing a game on these devices is not the only thing that you can do with this kind of",
    "start": "1986279",
    "end": "1991360"
  },
  {
    "text": "vulnerabilities uh we used this game to demonstrate that we have full control over the printer and the display on",
    "start": "1991360",
    "end": "1997279"
  },
  {
    "text": "these devices if you know where a merchant and the display says that the payment has been approved in the same",
    "start": "1997279",
    "end": "2002559"
  },
  {
    "text": "way as the actual application does and it prints out the valid receipt then you probably think that the payment got",
    "start": "2002559",
    "end": "2008600"
  },
  {
    "text": "approved U but there won't be any money uh arriving on in your bank account",
    "start": "2008600",
    "end": "2014919"
  },
  {
    "text": "um we'll see some more uh practical payloads later",
    "start": "2014919",
    "end": "2020880"
  },
  {
    "text": "on uh so so this one uh what we demonstrated here was a weakness in the payment application that runs on the",
    "start": "2026240",
    "end": "2032519"
  },
  {
    "text": "payment terminal um um we will cover of our operating system in future work later um",
    "start": "2032519",
    "end": "2040039"
  },
  {
    "text": "so in the the next case study um will be presented by",
    "start": "2040039",
    "end": "2045480"
  },
  {
    "text": "Rafa so this payment terminal here is a little bit um more different to the one that Nils uh just uh presented um these",
    "start": "2046279",
    "end": "2054520"
  },
  {
    "text": "are why they use in the US where chip and ping is not established yet um where you use basically signature payment base",
    "start": "2054520",
    "end": "2063520"
  },
  {
    "text": "payments um they have a nice touch screen full color where you can actually",
    "start": "2063520",
    "end": "2068839"
  },
  {
    "text": "use to to sign your your payment um they have a 32 bit bit arm processor um they",
    "start": "2068839",
    "end": "2074440"
  },
  {
    "text": "run embeded Linux and they also have PC box installed which as you can imagine is very very useful and these terminals",
    "start": "2074440",
    "end": "2080480"
  },
  {
    "text": "I would say are more the ones that are more similar to a computer",
    "start": "2080480",
    "end": "2086679"
  },
  {
    "text": "itself um the hardware peripherals um add to the attack surface um some of",
    "start": "2087280",
    "end": "2092520"
  },
  {
    "text": "them have um a smart card reader um SIM card reader uh magnetic C reader for the",
    "start": "2092520",
    "end": "2098520"
  },
  {
    "text": "signature payments they can also have contactless payments if they require NFC Hardware is plug into it they will have",
    "start": "2098520",
    "end": "2104599"
  },
  {
    "text": "a USB port ether port and rs232 there's two um interesting security features in this um uh payment",
    "start": "2104599",
    "end": "2112320"
  },
  {
    "text": "terminal the first one is binary signing for the application for the payment application so um to protect against a",
    "start": "2112320",
    "end": "2120320"
  },
  {
    "text": "applic payment application uh tampering for malicious purposes um physical",
    "start": "2120320",
    "end": "2125640"
  },
  {
    "text": "tamper protection mechanism uh which is a pain if you drop the device on the",
    "start": "2125640",
    "end": "2131480"
  },
  {
    "text": "floor um these payment terminals come with a built-in H application from the",
    "start": "2132000",
    "end": "2137320"
  },
  {
    "text": "from the vendor which are used to uh manage the terminal when you have physical access to it um this built-in",
    "start": "2137320",
    "end": "2143880"
  },
  {
    "text": "application all allows to allows you to set up a lot of configuration settings and also allows you to configure the",
    "start": "2143880",
    "end": "2149760"
  },
  {
    "text": "device to be remote to be manage remotely um on top of that we will have",
    "start": "2149760",
    "end": "2156200"
  },
  {
    "text": "the payment appli application we handles the the payment transactions and is what the user will be H basically exposed to",
    "start": "2156200",
    "end": "2164280"
  },
  {
    "text": "um they are very interesting functionality in this terminal um they render multimedia adverts so when you",
    "start": "2164280",
    "end": "2169440"
  },
  {
    "text": "are purchasing ER with this terminals you can actually be seen adverse with it",
    "start": "2169440",
    "end": "2176440"
  },
  {
    "text": "and they have a remote administrative interface so retailers um that has 300",
    "start": "2176440",
    "end": "2181560"
  },
  {
    "text": "of these payment terminals can actually manage this device from a centralized location and they can um connect to the",
    "start": "2181560",
    "end": "2188079"
  },
  {
    "text": "internet um if the devices have in a local network they won't um but if the if these devices needs to connect to a",
    "start": "2188079",
    "end": "2195000"
  },
  {
    "text": "remote interface that is on the internet they they will be able to connect to those",
    "start": "2195000",
    "end": "2200839"
  },
  {
    "text": "devices and the demo that we're going to be seen",
    "start": "2200839",
    "end": "2206040"
  },
  {
    "text": "so okay so this is the payment terminal um",
    "start": "2215680",
    "end": "2222640"
  },
  {
    "text": "as we can see there is a let me just say",
    "start": "2222640",
    "end": "2228000"
  },
  {
    "text": "thisly this is the building application that the um administrator will use to manage the devices um here we can see",
    "start": "2228000",
    "end": "2235560"
  },
  {
    "text": "the different functionality that is available um you can set up FTP it looks very much like a the functionality that",
    "start": "2235560",
    "end": "2242200"
  },
  {
    "text": "you will find in a in a in a Linux system um you can set up um debac",
    "start": "2242200",
    "end": "2248000"
  },
  {
    "text": "functionality you can enable teret um what we are going to be doing",
    "start": "2248000",
    "end": "2253480"
  },
  {
    "text": "um is a restarting the",
    "start": "2253480",
    "end": "2257920"
  },
  {
    "text": "device and the demonstration that we're going to H show here is how we can exploit um weaknesses in the network",
    "start": "2261720",
    "end": "2269040"
  },
  {
    "text": "communication between the device and the remote administrative server that these devices connect to so these devices",
    "start": "2269040",
    "end": "2275920"
  },
  {
    "text": "actually Act as a client um when they require um a administrative functions",
    "start": "2275920",
    "end": "2282359"
  },
  {
    "text": "they will attempt to connect to the remote a server and what we are doing here for the for the purpose of the demo",
    "start": "2282359",
    "end": "2289000"
  },
  {
    "text": "is rebooting the device um we this the user won't the user or the customer in",
    "start": "2289000",
    "end": "2294520"
  },
  {
    "text": "the shop would actually not be seeing this they will be exposed with the payment application for just but just to",
    "start": "2294520",
    "end": "2301119"
  },
  {
    "text": "demonstrate that um the communication is happening at reboot and can be also set up in periodic times to connect to the",
    "start": "2301119",
    "end": "2308160"
  },
  {
    "text": "administrative server um we are going through through this interface essentially um this n network weakness",
    "start": "2308160",
    "end": "2315720"
  },
  {
    "text": "the weaknesses in the network communication um could allow an attacker to um er spoof the remote server and",
    "start": "2315720",
    "end": "2323440"
  },
  {
    "text": "launch uh an attack to the payment terminal ER itself um this is basically",
    "start": "2323440",
    "end": "2329480"
  },
  {
    "text": "using functionality available on the built-in application so takes a little bit of",
    "start": "2329480",
    "end": "2337119"
  },
  {
    "text": "time to boot up I was expecting that so it's almost there so now we can see that",
    "start": "2337119",
    "end": "2342720"
  },
  {
    "text": "um the application the terminal is booting up and now what it's going to be trying",
    "start": "2342720",
    "end": "2349000"
  },
  {
    "text": "to do is to connect to the remote administrative",
    "start": "2349000",
    "end": "2353760"
  },
  {
    "text": "server so what we do from here is to impersonate the remote server we have",
    "start": "2361160",
    "end": "2368000"
  },
  {
    "text": "our malicious script that we can",
    "start": "2368000",
    "end": "2372240"
  },
  {
    "text": "run we specify the IP address of the client the",
    "start": "2374680",
    "end": "2380920"
  },
  {
    "text": "terminal our IP",
    "start": "2382200",
    "end": "2386160"
  },
  {
    "text": "address and we launch the",
    "start": "2389520",
    "end": "2393280"
  },
  {
    "text": "attack",
    "start": "2395400",
    "end": "2398400"
  },
  {
    "text": "now then impersonation is happening and we'll be launching our malicious application into the",
    "start": "2403839",
    "end": "2410240"
  },
  {
    "text": "terminal",
    "start": "2425359",
    "end": "2428359"
  },
  {
    "text": "the the question so your question was whether",
    "start": "2432359",
    "end": "2439079"
  },
  {
    "text": "there um it's not to a signature dig digital signatures required for the",
    "start": "2439079",
    "end": "2444319"
  },
  {
    "text": "application that run on these devices um for legitimate applications it is uh if",
    "start": "2444319",
    "end": "2449560"
  },
  {
    "text": "you decide not to go through the normal startup process of application and start directly from the underlying operating",
    "start": "2449560",
    "end": "2455960"
  },
  {
    "text": "system and that this signature is not enforced um what our payload has also",
    "start": "2455960",
    "end": "2461800"
  },
  {
    "text": "done is to enable 10 net on the Remote device and change the root password of the device so we can do",
    "start": "2461800",
    "end": "2470800"
  },
  {
    "text": "that and luckily that allows us to stop that demo as",
    "start": "2473240",
    "end": "2478680"
  },
  {
    "text": "well [Music]",
    "start": "2485240",
    "end": "2492759"
  },
  {
    "text": "so what we have seen in this demo is a full system compromise we have been able to run our unsigned application with the",
    "start": "2501440",
    "end": "2507800"
  },
  {
    "text": "access that we have had to the device we have changed the root password the root password uh on the device and also",
    "start": "2507800",
    "end": "2513800"
  },
  {
    "text": "enable internet which allow us to uh connect conect",
    "start": "2513800",
    "end": "2518480"
  },
  {
    "text": "remotely and that leads us to our third and and last demonstration on another payment",
    "start": "2520560",
    "end": "2526960"
  },
  {
    "text": "terminal uh this is this uh the specific payment terminal um very popular in the",
    "start": "2526960",
    "end": "2532240"
  },
  {
    "text": "UK and I've seen it in the US as well and um has uh similar sorts of",
    "start": "2532240",
    "end": "2538680"
  },
  {
    "text": "connectivity um EET Port serial Port uh and so on um it runs uh",
    "start": "2538680",
    "end": "2546800"
  },
  {
    "text": "um the vendor software um however a slight modification of the vendor software by a payment provider",
    "start": "2546800",
    "end": "2556838"
  },
  {
    "text": "um um it uses the same custom operating system U maybe a newer version of that",
    "start": "2557480",
    "end": "2563000"
  },
  {
    "text": "as as the terminal in our first demonstration um which actually helped quite a lot because we by now we",
    "start": "2563000",
    "end": "2569920"
  },
  {
    "text": "understand that um operating system fairly well um the the same application",
    "start": "2569920",
    "end": "2575559"
  },
  {
    "text": "is used on M multiple devices so it's not specific to this device the demonstration it is uh uh specific to uh",
    "start": "2575559",
    "end": "2582960"
  },
  {
    "text": "the payment application used on these devices um and when we were looking at",
    "start": "2582960",
    "end": "2589760"
  },
  {
    "text": "uh at finding flaws in the um chb and pin passing we noted that the code",
    "start": "2589760",
    "end": "2595440"
  },
  {
    "text": "quality for passing um the EMV protocol was considerably be better than on the",
    "start": "2595440",
    "end": "2602520"
  },
  {
    "text": "first terminal that we were looking at um still we were able to find um vulnerabilities and those",
    "start": "2602520",
    "end": "2608480"
  },
  {
    "text": "vulnerabilities were deeper down in the protocol and they weren't as straightforward to find or exploit as uh",
    "start": "2608480",
    "end": "2614960"
  },
  {
    "text": "the the previous vulnerabilities um interestingly we again found so first of",
    "start": "2614960",
    "end": "2620359"
  },
  {
    "text": "all on almost all of the terminals that we bought off of eBay we found that the",
    "start": "2620359",
    "end": "2626000"
  },
  {
    "text": "default passwords are not changed by the people that are using these terminals which is quite shocking but then also there are hardcoded passwords in this",
    "start": "2626000",
    "end": "2632880"
  },
  {
    "text": "case there is the so-called super mega password uh which which can be disabled in the configuration files but wasn't",
    "start": "2632880",
    "end": "2638800"
  },
  {
    "text": "disabled in any of the cases that we have seen and that will allow you to get around any password prompt on the",
    "start": "2638800",
    "end": "2645839"
  },
  {
    "text": "device so that's our start demonstration",
    "start": "2646040",
    "end": "2650920"
  },
  {
    "text": "then bear with me a second to get that",
    "start": "2656480",
    "end": "2661760"
  },
  {
    "text": "up we got a lot of reflection here",
    "start": "2663240",
    "end": "2668000"
  },
  {
    "text": "that I think that works fairly well um the the strip of of tape you see on",
    "start": "2677359",
    "end": "2683839"
  },
  {
    "text": "there is because this for this demonstration we will use an actual credit card and I really would prefer if",
    "start": "2683839",
    "end": "2689720"
  },
  {
    "text": "not all of you have my credit card number or at least the number for this specific card um so what we do in this",
    "start": "2689720",
    "end": "2698000"
  },
  {
    "text": "uh in this presentation is we have a our first card um which looks like this uh",
    "start": "2698000",
    "end": "2704960"
  },
  {
    "text": "so that is Tinker and Tinker bable will go ahead and put the pixie dust into the device uh the pixie dust in this case",
    "start": "2704960",
    "end": "2711400"
  },
  {
    "text": "being um uh some kind of back door which modifies",
    "start": "2711400",
    "end": "2717240"
  },
  {
    "text": "uh the payment application in a way that after this pixel dust has been put into the device um it will record all the",
    "start": "2717240",
    "end": "2723880"
  },
  {
    "text": "credit card numbers and pin numbers that are put in to the device after this so again we start a payment process by",
    "start": "2723880",
    "end": "2730200"
  },
  {
    "text": "inserting the card and from the Merchant's point of",
    "start": "2730200",
    "end": "2736960"
  },
  {
    "text": "view the payment process goes ahead as usual they will put in a value for the",
    "start": "2736960",
    "end": "2742319"
  },
  {
    "text": "uh for the transaction um and then it displays card error um a criminal",
    "start": "2742319",
    "end": "2748559"
  },
  {
    "text": "probably now would go ahead and say oh um there must be something wrong with my my credit card can I pay by cash and",
    "start": "2748559",
    "end": "2755880"
  },
  {
    "text": "instead and then leave the shop at this point our malicious code is",
    "start": "2755880",
    "end": "2763720"
  },
  {
    "text": "on the device and um it will hook any payments that will be happening on the",
    "start": "2763720",
    "end": "2768920"
  },
  {
    "text": "device after this so we can now go ahead um with a valid credit card which is",
    "start": "2768920",
    "end": "2775440"
  },
  {
    "text": "this one um and um make a payment so the next",
    "start": "2775440",
    "end": "2780640"
  },
  {
    "text": "customer comes into the shop and uses the same device to make a payment on the device and that pay P will go through um",
    "start": "2780640",
    "end": "2787960"
  },
  {
    "text": "as it normally would uh Merchant is asks for the amount of the payment um puts",
    "start": "2787960",
    "end": "2793960"
  },
  {
    "text": "that in and then um the the card holder is asked to put in the pin obviously",
    "start": "2793960",
    "end": "2799880"
  },
  {
    "text": "they will shield um the pin pad and hit enter and now it tries to uh connect to",
    "start": "2799880",
    "end": "2807440"
  },
  {
    "text": "a bank in this case it would use the modem to connect to a bank uh which is not working because it's not connected",
    "start": "2807440",
    "end": "2812480"
  },
  {
    "text": "to a phone line we'll have several attempts of that and then decline the payment because we weren't able to verify the card holder if this uh device",
    "start": "2812480",
    "end": "2820160"
  },
  {
    "text": "would be connected to a bank then the payment would go through us uh as it would",
    "start": "2820160",
    "end": "2827040"
  },
  {
    "text": "normally and now several other payments can happen um I'll better keep this receipt it has my card number on it as",
    "start": "2827280",
    "end": "2834000"
  },
  {
    "text": "well um so several payments will happen throughout the day and all of these payments will be locked um and now the",
    "start": "2834000",
    "end": "2840760"
  },
  {
    "text": "the criminal at the end of the day comes back with a second smart card which is winie Winnie the Poo",
    "start": "2840760",
    "end": "2847599"
  },
  {
    "text": "retrieving the honey from the payment terminal uh the honey in this case being",
    "start": "2847599",
    "end": "2853760"
  },
  {
    "text": "credit card numbers and pin numbers so when ether poo goes ahead uh makes a payment on the",
    "start": "2853760",
    "end": "2861280"
  },
  {
    "text": "device um and this includes a small demonstration as well because you we can now put in the value for the payment um",
    "start": "2861280",
    "end": "2868839"
  },
  {
    "text": "and because we are we have control over the payment terminal um it did authorize the payment without asking us even for a",
    "start": "2868839",
    "end": "2875200"
  },
  {
    "text": "pin so you see an OS code there and also uh it has printed the valid",
    "start": "2875200",
    "end": "2881559"
  },
  {
    "text": "receipt which you see here um so no card holder verification was required and the",
    "start": "2881559",
    "end": "2887440"
  },
  {
    "text": "payment has been approved um for so this would usually say master card and the",
    "start": "2887440",
    "end": "2892480"
  },
  {
    "text": "card number probably shouldn't have 31337 in it um so that from the point of",
    "start": "2892480",
    "end": "2898319"
  },
  {
    "text": "view of the merchant this this payment has been approved um more interestingly",
    "start": "2898319",
    "end": "2903400"
  },
  {
    "text": "for the criminal is not that they were able to acquire goods for 1010 that um",
    "start": "2903400",
    "end": "2908559"
  },
  {
    "text": "without paying for it more interestingly is that all the credit card numbers and",
    "start": "2908559",
    "end": "2914200"
  },
  {
    "text": "pin numbers that have been used throughout the day on this terminal have been locked to uh the wi the PO card so",
    "start": "2914200",
    "end": "2921079"
  },
  {
    "text": "uh what we do next is um the criminal will go to their",
    "start": "2921079",
    "end": "2928680"
  },
  {
    "text": "laptop and um execute the hash in script with underscore height so that I don't",
    "start": "2932640",
    "end": "2940119"
  },
  {
    "text": "have to show you my credit card number um so that will X out some digits of the",
    "start": "2940119",
    "end": "2945359"
  },
  {
    "text": "of the credit card and also X out most of the pin number um criminal will go",
    "start": "2945359",
    "end": "2951160"
  },
  {
    "text": "ahead uh insert the the payment card uh the the militia second card into the",
    "start": "2951160",
    "end": "2956920"
  },
  {
    "text": "card reader and then execute the script and that is the locked credit",
    "start": "2956920",
    "end": "2962680"
  },
  {
    "text": "card number in the pin um scramble in this case um retrieve back from the from",
    "start": "2962680",
    "end": "2968760"
  },
  {
    "text": "the payment [Applause]",
    "start": "2968760",
    "end": "2974099"
  },
  {
    "text": "terminal so I demo um again tinell for infecting the",
    "start": "2978640",
    "end": "2984319"
  },
  {
    "text": "device and when is a poo for retrieving the C+ uh c um the credit card numbers",
    "start": "2984319",
    "end": "2989880"
  },
  {
    "text": "and the PIN numbers um again code execution in the context of a payment application we have demonstrated to what",
    "start": "2989880",
    "end": "2995960"
  },
  {
    "text": "else we can do with this kind of pay uh uh code execution uh we can approve",
    "start": "2995960",
    "end": "3001359"
  },
  {
    "text": "payments um and we can also um um modify",
    "start": "3001359",
    "end": "3007200"
  },
  {
    "text": "the terminal so it records credit card numbers and pin numbers uh this vulnerability was reported to the vendor",
    "start": "3007200",
    "end": "3012799"
  },
  {
    "text": "at the beginning of July after we found it and the they already have a patch for",
    "start": "3012799",
    "end": "3017839"
  },
  {
    "text": "the is this issue that's less than 3 weeks to to get the patch for the issue out uh which is really uh quite",
    "start": "3017839",
    "end": "3024839"
  },
  {
    "text": "impressive especially with um vendors of embedded Hardware we have seen far worse than that um",
    "start": "3024839",
    "end": "3032040"
  },
  {
    "text": "unfortunately uh U it will take some time for all the um shops and Merchants",
    "start": "3032040",
    "end": "3038079"
  },
  {
    "text": "to to set uh to um adapt this patch and also to for the new software version to",
    "start": "3038079",
    "end": "3043280"
  },
  {
    "text": "go through the uh verification or certification",
    "start": "3043280",
    "end": "3048520"
  },
  {
    "text": "processes right what else is there to do um uh there there there was um a mention",
    "start": "3050119",
    "end": "3056839"
  },
  {
    "text": "of the operating system and security of the operating system before um so it",
    "start": "3056839",
    "end": "3062599"
  },
  {
    "text": "from from what we know it's completely custom built there might be um privilege",
    "start": "3062599",
    "end": "3067960"
  },
  {
    "text": "escalation vulnerabilities uh you can maybe exploit some of the system calls um something very interesting to look",
    "start": "3067960",
    "end": "3074079"
  },
  {
    "text": "into um firmware updates for the operating system itself um they are signed and encrypted at least to our",
    "start": "3074079",
    "end": "3082119"
  },
  {
    "text": "knowledge encrypted so by by looking further into the operating system system uh we might get an idea of uh and we we",
    "start": "3082119",
    "end": "3088799"
  },
  {
    "text": "might be able to verify and this uh the signature checks and encryption um there's a lot of other code in there",
    "start": "3088799",
    "end": "3095240"
  },
  {
    "text": "which is custom to this terminal we have a custom Wi-Fi stack Bluetooth stack and the network stack is uh customly written",
    "start": "3095240",
    "end": "3102240"
  },
  {
    "text": "and and um usually implemented in the in user mode as well um there are a lot of",
    "start": "3102240",
    "end": "3108640"
  },
  {
    "text": "other payloads that we can play with um properly approving payments so that the merchant will think that this payment",
    "start": "3108640",
    "end": "3115119"
  },
  {
    "text": "was approved using a pin uh and a valid card without it actually being a valid",
    "start": "3115119",
    "end": "3120520"
  },
  {
    "text": "card um and also because all of these devices Implement signature checks uh",
    "start": "3120520",
    "end": "3125960"
  },
  {
    "text": "currently our payloads are not uh persistent on persistent on the device um on reboot these these payloads will",
    "start": "3125960",
    "end": "3133480"
  },
  {
    "text": "get lost from the device uh which is from a forensic point of view great um but maybe not if you want to have a",
    "start": "3133480",
    "end": "3139880"
  },
  {
    "text": "large scale attacks against these systems um so there are some ideas around how to uh we might be able to",
    "start": "3139880",
    "end": "3147160"
  },
  {
    "text": "achieve persistence on the devices for example modifying the configuration files because they are not signed and if",
    "start": "3147160",
    "end": "3152720"
  },
  {
    "text": "we trigger issues in the passing of the configuration files then we might be able to gain persistence on these",
    "start": "3152720",
    "end": "3158040"
  },
  {
    "text": "devices as well and then also looking into NFC would be quite interesting as I",
    "start": "3158040",
    "end": "3163680"
  },
  {
    "text": "said before most of the NFC payments are made using EMV and the EMV standard as well so similar issues or maybe even the",
    "start": "3163680",
    "end": "3170480"
  },
  {
    "text": "same issues might work against these devices",
    "start": "3170480",
    "end": "3175920"
  },
  {
    "text": "very quick conclusion um there's a lot of trust into these payment terminals um",
    "start": "3175920",
    "end": "3180960"
  },
  {
    "text": "the merchants trust them to tell them whether the the payment was legitimate",
    "start": "3180960",
    "end": "3186760"
  },
  {
    "text": "and card holders trust them with their uh card details and pin numbers they don't have another option than doing so",
    "start": "3186760",
    "end": "3195160"
  },
  {
    "text": "um uh we have seen a lot of cases where the default passwords were not changed uh some of them had hardcoded passwords",
    "start": "3195160",
    "end": "3202200"
  },
  {
    "text": "additionally um and we have seen a lot of effort put into the pH physical security against scamming and so on on",
    "start": "3202200",
    "end": "3209280"
  },
  {
    "text": "these devices um it would be good to see a similar efforts for the software security as",
    "start": "3209280",
    "end": "3215440"
  },
  {
    "text": "well um and finally we demonstrated how",
    "start": "3215440",
    "end": "3220640"
  },
  {
    "text": "um uh memory Corruptions vulnerability in the handling of of user input like uh",
    "start": "3220640",
    "end": "3226440"
  },
  {
    "text": "chip and pin cards can be used to inject code and run code on these devices and we have seen some payloads uh which",
    "start": "3226440",
    "end": "3234319"
  },
  {
    "text": "allow us to explode that any",
    "start": "3234319",
    "end": "3240160"
  },
  {
    "text": "questions yeah can you",
    "start": "3241319",
    "end": "3246359"
  },
  {
    "text": "turn um we haven't looked into the storage of keys um I would assume they",
    "start": "3253960",
    "end": "3259559"
  },
  {
    "text": "are securely hidden away from the applications um um but we haven't looked",
    "start": "3259559",
    "end": "3265000"
  },
  {
    "text": "at into that at all um yeah that's another",
    "start": "3265000",
    "end": "3271760"
  },
  {
    "text": "one so sorry I can't hear",
    "start": "3277599",
    "end": "3281880"
  },
  {
    "text": "you um my my current implementation but that is um um only because I was lazy",
    "start": "3288799",
    "end": "3297280"
  },
  {
    "text": "will allow you to store something like 20 30 card card payments uh my smart card itself has a storage of 60k um I",
    "start": "3297280",
    "end": "3305280"
  },
  {
    "text": "need um 8 bytes to store the card number and currently another four bytes to",
    "start": "3305280",
    "end": "3310680"
  },
  {
    "text": "store the PIN number so you can make your own calculations how many that would",
    "start": "3310680",
    "end": "3316480"
  },
  {
    "text": "be any other",
    "start": "3317880",
    "end": "3321400"
  },
  {
    "text": "questions",
    "start": "3324000",
    "end": "3327000"
  },
  {
    "text": "bices ches",
    "start": "3330240",
    "end": "3334359"
  },
  {
    "text": "are",
    "start": "3354000",
    "end": "3357000"
  },
  {
    "text": "yeah so this was a comment around the software updates and how long it will take um for them to actually get to the",
    "start": "3362720",
    "end": "3369160"
  },
  {
    "text": "to the merchants um yeah so and that it might not happen at all but we have seen cases like um in",
    "start": "3369160",
    "end": "3376480"
  },
  {
    "text": "the first demonstration where an update channels through the internet access by the payment provider so that might be an",
    "start": "3376480",
    "end": "3382440"
  },
  {
    "text": "opportunity to get patches more quickly to to the payment terminals as",
    "start": "3382440",
    "end": "3388280"
  },
  {
    "text": "well any",
    "start": "3388280",
    "end": "3391440"
  },
  {
    "text": "more so in so with with all of the terminals we have been looking at you can exchange the application if you have",
    "start": "3402400",
    "end": "3409240"
  },
  {
    "text": "uh the developer key that is set up on the devices uh on some of them we have seen that happening through through an",
    "start": "3409240",
    "end": "3415640"
  },
  {
    "text": "internet connection so the same connection to the payment provider that is used to to process the payments can",
    "start": "3415640",
    "end": "3420880"
  },
  {
    "text": "also be used to update the devices it is is very dependent on the terminal that you're looking",
    "start": "3420880",
    "end": "3427319"
  },
  {
    "text": "at any more questions nice",
    "start": "3427920",
    "end": "3435119"
  },
  {
    "text": "one",
    "start": "3443799",
    "end": "3446799"
  },
  {
    "text": "okay this question was around whether we were able to make the terminal accept um offline payments even though it should",
    "start": "3453079",
    "end": "3459440"
  },
  {
    "text": "do an online verification or was configured to do so um with the kind of access that we have um it's it's more",
    "start": "3459440",
    "end": "3467039"
  },
  {
    "text": "about what what you display on the screen so we weren't able to approve any payments in the backend systems at all",
    "start": "3467039",
    "end": "3472839"
  },
  {
    "text": "and no money will eventually make it to the to the merchant either um however",
    "start": "3472839",
    "end": "3478599"
  },
  {
    "text": "what we were able to do is make the merchant think that a payment has been approved and that you can do with uh",
    "start": "3478599",
    "end": "3484799"
  },
  {
    "text": "with whatever payment you want because we control the screen and the printer and we can print that this was an online",
    "start": "3484799",
    "end": "3490359"
  },
  {
    "text": "payment or make it appear that it is connecting to a bank while it",
    "start": "3490359",
    "end": "3495720"
  },
  {
    "text": "isn't uh theoretically you would probably be able to do so uh we haven't we haven't attempted at",
    "start": "3499400",
    "end": "3506559"
  },
  {
    "text": "that any more questions thank",
    "start": "3506559",
    "end": "3513318"
  },
  {
    "text": "you",
    "start": "3516799",
    "end": "3519799"
  }
]