[
  {
    "text": "good afternoon everyone and thanks for attending my talk uh diving into spoiler",
    "start": "2800",
    "end": "9080"
  },
  {
    "text": "discovering LP and RC vulnerabilities in Windows printer drivers Uh my name is",
    "start": "9080",
    "end": "16160"
  },
  {
    "text": "Nan Pong and this is a joint work with Joan Y Uh first of all uh please allow us to",
    "start": "16160",
    "end": "25039"
  },
  {
    "text": "introduce ourself Uh my name is Jun Pong also known as Edward Pong in Twitter and",
    "start": "25039",
    "end": "32320"
  },
  {
    "text": "I'm a associate professor for Huajong University of Science and Technology and",
    "start": "32320",
    "end": "39040"
  },
  {
    "text": "in the meantime I'm also a security research at cyberwin I got my PhD degree in",
    "start": "39040",
    "end": "46200"
  },
  {
    "text": "cryptography but actually I interesting in all area of computer science I work",
    "start": "46200",
    "end": "52559"
  },
  {
    "text": "in both defensive and offensive security Previously I have published many",
    "start": "52559",
    "end": "58399"
  },
  {
    "text": "research in both industry and academia To get more information about Ming you",
    "start": "58399",
    "end": "64239"
  },
  {
    "text": "can find it in my personal Google site And I'm also a bug hunter in the",
    "start": "64239",
    "end": "71280"
  },
  {
    "text": "past six years Uh here are some of my bug in the past six years And most of",
    "start": "71280",
    "end": "77040"
  },
  {
    "text": "them time I'm doing a vulnerability hunting on Windows or some web",
    "start": "77040",
    "end": "82080"
  },
  {
    "text": "applications uh and today I'm going to talk about how do we find some of those bugs in",
    "start": "82080",
    "end": "90200"
  },
  {
    "text": "sporter and this page is about uh my c-orker just he is a security researcher",
    "start": "90200",
    "end": "97360"
  },
  {
    "text": "at cyber quon and now he focus on fuzzing and windows application",
    "start": "97360",
    "end": "104798"
  },
  {
    "text": "security here is the agenda of this talk first we will give an introduction to",
    "start": "105479",
    "end": "111680"
  },
  {
    "text": "the sporter and the sporter bugs Then we will talk about the new",
    "start": "111680",
    "end": "116880"
  },
  {
    "text": "attack surface we found in sporter the Windows printer driver rendering After",
    "start": "116880",
    "end": "122560"
  },
  {
    "text": "that we will dive into the XPX uh format and found vulnerability in",
    "start": "122560",
    "end": "129920"
  },
  {
    "text": "it First the introduction uh in this session I will give a",
    "start": "130680",
    "end": "136480"
  },
  {
    "text": "introduction to the print spoiler service and its vulnerability in the past",
    "start": "136480",
    "end": "144080"
  },
  {
    "text": "So uh what is a spoiler spoiler is actually a windows service It is",
    "start": "144239",
    "end": "150480"
  },
  {
    "text": "dedicated program and software that essentially manage the order of the documents to processed to the printer",
    "start": "150480",
    "end": "160519"
  },
  {
    "text": "Just like the picture shows print spoiler allow you to send the document",
    "start": "161599",
    "end": "166640"
  },
  {
    "text": "to the printer and where some some other uh one is still printing but it holds it",
    "start": "166640",
    "end": "173599"
  },
  {
    "text": "in the quill until the current job has been",
    "start": "173599",
    "end": "178640"
  },
  {
    "text": "finished Spoiler actually doing more than that Print spoiler in Windows",
    "start": "179640",
    "end": "184800"
  },
  {
    "text": "actually has more to do than just spawning and print document It expose",
    "start": "184800",
    "end": "190159"
  },
  {
    "text": "the functionality for add or remove a new printer and allow user to config",
    "start": "190159",
    "end": "197519"
  },
  {
    "text": "this new printer Support high level function call into a print",
    "start": "197519",
    "end": "203080"
  },
  {
    "text": "jobs Receive printer jobs and schedule your print jobs for",
    "start": "203080",
    "end": "208200"
  },
  {
    "text": "printing Windows printer is based on uh the Windows RPC By using the export RPC",
    "start": "208200",
    "end": "217080"
  },
  {
    "text": "interface a user can add a new printer and can fully control the",
    "start": "217080",
    "end": "223440"
  },
  {
    "text": "printer Then we can config this printer create some print jobs print to printer jobs to the",
    "start": "223440",
    "end": "230720"
  },
  {
    "text": "printer port or manage those printer jobs All of the above are complete by",
    "start": "230720",
    "end": "236319"
  },
  {
    "text": "the high privilege process uh sport sx The main component of the",
    "start": "236319",
    "end": "242799"
  },
  {
    "text": "RPC core is a local SPL But the client can actually interact",
    "start": "242799",
    "end": "248720"
  },
  {
    "text": "with the sporter locally or remotely which will provide pro provide us local",
    "start": "248720",
    "end": "254480"
  },
  {
    "text": "and remote attack surface We are not going to talk too",
    "start": "254480",
    "end": "260479"
  },
  {
    "text": "much of the basic of the spoiler but there has been a lot published research",
    "start": "260479",
    "end": "265520"
  },
  {
    "text": "about the prince sporter before I suggest you can read them uh by yourself",
    "start": "265520",
    "end": "271199"
  },
  {
    "text": "after the talk Print spoiler is very hot in cyber",
    "start": "271199",
    "end": "277680"
  },
  {
    "text": "security There are many reason for it First the spoiler used to run with very",
    "start": "277680",
    "end": "284720"
  },
  {
    "text": "high privilege and not code from network which is prone to security issues",
    "start": "284720",
    "end": "291160"
  },
  {
    "text": "Second print printerb account for 9% of all Windows case report to Microsoft",
    "start": "291160",
    "end": "298960"
  },
  {
    "text": "according to MSRC blogs Third there are a lot exported",
    "start": "298960",
    "end": "305199"
  },
  {
    "text": "vulnerability in sporter in the past few years and some of the vulnerability is",
    "start": "305199",
    "end": "310880"
  },
  {
    "text": "very high impact and attract a lot attention for",
    "start": "310880",
    "end": "316280"
  },
  {
    "text": "example the stex printer exportation and the print line mail box",
    "start": "316280",
    "end": "322560"
  },
  {
    "text": "and so on For last 14 years there are a lot",
    "start": "322560",
    "end": "329440"
  },
  {
    "text": "printer bug has been exported in the wild and this picture show its history",
    "start": "329440",
    "end": "338280"
  },
  {
    "text": "the vulnerabilities in printer uh numerals But most of all the famous bug",
    "start": "345199",
    "end": "352880"
  },
  {
    "text": "but but almost all the famous bug follows some familiar pattern in the past including the past redirection",
    "start": "352880",
    "end": "361400"
  },
  {
    "text": "attack the past traversal vulnerability the arbitrary dload loading bugs and the",
    "start": "361400",
    "end": "368560"
  },
  {
    "text": "memory corruption bugs and some other logical",
    "start": "368560",
    "end": "373720"
  },
  {
    "text": "bugs due to the extensive fair operation performed by the printer",
    "start": "373720",
    "end": "379199"
  },
  {
    "text": "The majority of those vulnerability are used to base on symbolic symbolic link",
    "start": "379199",
    "end": "385840"
  },
  {
    "text": "attack in Windows Among those vulnerability",
    "start": "385840",
    "end": "391280"
  },
  {
    "text": "uh print is one of the uh very expensive one uh as it's easy to export stable and",
    "start": "391280",
    "end": "399600"
  },
  {
    "text": "can lead to remote code execution on Windows operating systems",
    "start": "399600",
    "end": "406039"
  },
  {
    "text": "This is a example of the print line mail It the cause of print mail is improper",
    "start": "406240",
    "end": "412000"
  },
  {
    "text": "checks in printer's RPC interface function When a attacker send a special",
    "start": "412000",
    "end": "418400"
  },
  {
    "text": "craft RPC to the remote print server it can cause a server to know the",
    "start": "418400",
    "end": "425199"
  },
  {
    "text": "malicious D uh local located on the attacker machine leading to remote code",
    "start": "425199",
    "end": "430880"
  },
  {
    "text": "execution Uh for more story about this bug we",
    "start": "430880",
    "end": "436000"
  },
  {
    "text": "refer you we refer you to watch our previous talk uh in blacka us",
    "start": "436000",
    "end": "443280"
  },
  {
    "text": "2021 but after print nl uh Microsoft has put a lot e effort in fixing printer",
    "start": "443880",
    "end": "451960"
  },
  {
    "text": "bugs in 2022 Microsoft has fixed 63",
    "start": "451960",
    "end": "457919"
  },
  {
    "text": "vulnerability uh uh 33 vulnerability uh for print spoiler and some of Microsoft",
    "start": "457919",
    "end": "464960"
  },
  {
    "text": "fix even broken the print spoiler for many times which causing usability",
    "start": "464960",
    "end": "472080"
  },
  {
    "text": "issues Except fixing bugs Microsoft also introduced many new mitigation for print",
    "start": "474599",
    "end": "480960"
  },
  {
    "text": "spoiler For example it has add junction redirection protection to block password",
    "start": "480960",
    "end": "487759"
  },
  {
    "text": "redirection attacks and it also add signature checks to prevent arbitrary D",
    "start": "487759",
    "end": "494520"
  },
  {
    "text": "loading which was abused before This will make make exporting the print",
    "start": "494520",
    "end": "500800"
  },
  {
    "text": "sporter much harder Is spoiler secure after all the",
    "start": "500800",
    "end": "506960"
  },
  {
    "text": "facts uh last year we decide to dive into spoiler again and try to find some",
    "start": "506960",
    "end": "513919"
  },
  {
    "text": "new bug So let's start our new journey on the",
    "start": "513919",
    "end": "521039"
  },
  {
    "text": "spoiler The new attack surface Windows printer driver",
    "start": "521640",
    "end": "528639"
  },
  {
    "text": "rendering When exploring new attack surface we prefer to look at the",
    "start": "530120",
    "end": "535880"
  },
  {
    "text": "architecture And in this time we find that the rendering component it seems",
    "start": "535880",
    "end": "542399"
  },
  {
    "text": "that it has not been deeply researched before Although spoiler has been",
    "start": "542399",
    "end": "548080"
  },
  {
    "text": "researched for many many years in our experience complex",
    "start": "548080",
    "end": "553680"
  },
  {
    "text": "rendering module often have many bugs So we deciding to explore this area",
    "start": "553680",
    "end": "563720"
  },
  {
    "text": "We will begin our introduction with a a common print example in our dining life When using",
    "start": "564880",
    "end": "572839"
  },
  {
    "text": "printers we often need to print a document We will open a document for",
    "start": "572839",
    "end": "578480"
  },
  {
    "text": "example in word Then we select the printer driver and process to",
    "start": "578480",
    "end": "583640"
  },
  {
    "text": "print In this context the print driver play the role of the re",
    "start": "583640",
    "end": "590040"
  },
  {
    "text": "rendering just like the picture shows Let's break down this scenario in",
    "start": "590040",
    "end": "598000"
  },
  {
    "text": "more details Word is a common JA application",
    "start": "598000",
    "end": "603519"
  },
  {
    "text": "which is used in user mode It will use the Microsoft XPX document converter to",
    "start": "603519",
    "end": "610880"
  },
  {
    "text": "transform the document into XPX format Then it send the RPC call to the",
    "start": "610880",
    "end": "618360"
  },
  {
    "text": "sporter The spooler will use the XPX support to save and rendering using the",
    "start": "618360",
    "end": "625680"
  },
  {
    "text": "spoiler driver The rendering process converts the XPX format into print",
    "start": "625680",
    "end": "633120"
  },
  {
    "text": "control language which is a language used by the printer",
    "start": "633120",
    "end": "639360"
  },
  {
    "text": "device Printer operate in two mode V3 mode and V4 mode The W3 mode is the",
    "start": "642760",
    "end": "652399"
  },
  {
    "text": "older one It is directly used by the sporter service to node the printer",
    "start": "652399",
    "end": "658000"
  },
  {
    "text": "driver and perform the rendering And for the W4 mode it will",
    "start": "658000",
    "end": "664880"
  },
  {
    "text": "create a subprocess print fleet pipe service to know the printer driver and",
    "start": "664880",
    "end": "670560"
  },
  {
    "text": "do the rendering A crash a crash in V43 mode",
    "start": "670560",
    "end": "676000"
  },
  {
    "text": "can cause the entire printer service to become deny of service Well in W for",
    "start": "676000",
    "end": "682160"
  },
  {
    "text": "mode it would only result in the restart of a single",
    "start": "682160",
    "end": "687839"
  },
  {
    "text": "process So what impact could a rendering vulnerability have so our answer is a",
    "start": "689480",
    "end": "697120"
  },
  {
    "text": "local privilege explanation R LP and remote code",
    "start": "697120",
    "end": "703200"
  },
  {
    "text": "execution Here is a attack scenario First",
    "start": "703560",
    "end": "708720"
  },
  {
    "text": "uh let's look at the uh LP uh attack scenario It allow the local user to",
    "start": "708720",
    "end": "715440"
  },
  {
    "text": "elevate their privilege to the system level The attacker will use a print API",
    "start": "715440",
    "end": "721839"
  },
  {
    "text": "to send malicious malicious XPX to the print drivers When the driver",
    "start": "721839",
    "end": "728720"
  },
  {
    "text": "uh rendering this evil XPX files it will be exported then get the system",
    "start": "728720",
    "end": "737600"
  },
  {
    "text": "privilege Then we want to introduce a remote code exclusion attack scenario An",
    "start": "738839",
    "end": "744600"
  },
  {
    "text": "authenticated attacker with normal privilege could also send a modified XPX",
    "start": "744600",
    "end": "750240"
  },
  {
    "text": "file to a shared printer which can result in remote code exclusion",
    "start": "750240",
    "end": "757600"
  },
  {
    "text": "The attacker will use the print API to send malicious XPX to the SH",
    "start": "757600",
    "end": "762920"
  },
  {
    "text": "printer over SMB or some other measure",
    "start": "762920",
    "end": "768399"
  },
  {
    "text": "when the printer driver rendering this EVO XPS file and it will be exported as",
    "start": "768399",
    "end": "776959"
  },
  {
    "text": "rce in addition to uh normal RPC call uh",
    "start": "778040",
    "end": "783720"
  },
  {
    "text": "remotely the vulnerability can also trigger using uh remote desktop protocol",
    "start": "783720",
    "end": "789720"
  },
  {
    "text": "RDP First the attacker need to convince the victim to connect to the remote",
    "start": "789720",
    "end": "795519"
  },
  {
    "text": "desktop server Then the attacker can use a remote desktop print channel to",
    "start": "795519",
    "end": "802160"
  },
  {
    "text": "connect the victim's printer driver So the attacker can use the print API to",
    "start": "802160",
    "end": "807920"
  },
  {
    "text": "request a malicious print job to achieve remote code",
    "start": "807920",
    "end": "813759"
  },
  {
    "text": "execution And the next part uh dive into the XPX uh format so we can find some",
    "start": "814360",
    "end": "821279"
  },
  {
    "text": "vulnerability here Uh here I will hand over a talk to my c-orker just but",
    "start": "821279",
    "end": "828440"
  },
  {
    "text": "however he can not be here uh on site because of the visa issues but he has",
    "start": "828440",
    "end": "835680"
  },
  {
    "text": "record his talk Hi everyone I am here the next",
    "start": "835680",
    "end": "842560"
  },
  {
    "text": "session will be present by me Let's dive into the SPS",
    "start": "842560",
    "end": "848920"
  },
  {
    "text": "form The for SPS is the open SML paper",
    "start": "848920",
    "end": "855079"
  },
  {
    "text": "specification is an open specification for page description language and a",
    "start": "855079",
    "end": "861279"
  },
  {
    "text": "fixed document format As the name suggests is an open",
    "start": "861279",
    "end": "867199"
  },
  {
    "text": "XML format This format is widely used in office applications",
    "start": "867199",
    "end": "874480"
  },
  {
    "text": "You use deep compression technology to store documents When we check the SPS",
    "start": "874480",
    "end": "880880"
  },
  {
    "text": "field we will get the SML field and some resource",
    "start": "880880",
    "end": "886639"
  },
  {
    "text": "field The SML field is important in this format as it allies the content of each",
    "start": "886760",
    "end": "895639"
  },
  {
    "text": "page Let me give an example to show how it works The XML contained in the square will",
    "start": "895639",
    "end": "903040"
  },
  {
    "text": "create a page like this when it's ranked In the previous session on attack",
    "start": "903040",
    "end": "911360"
  },
  {
    "text": "surfing we talked about print document using the word application which relies",
    "start": "911360",
    "end": "918240"
  },
  {
    "text": "on the GDI print API This method requires converting other",
    "start": "918240",
    "end": "924560"
  },
  {
    "text": "formats to SPS before printing which is slow It doesn't allow",
    "start": "924560",
    "end": "930720"
  },
  {
    "text": "for precise control over the SPS content So we prefer to use the SPS print API to",
    "start": "930720",
    "end": "939600"
  },
  {
    "text": "directly send t the SPS field to the spooler service",
    "start": "939600",
    "end": "947040"
  },
  {
    "text": "In Windows 10 we can use the SPS viewer comes pre-installed in",
    "start": "947040",
    "end": "954120"
  },
  {
    "text": "Windows to open the SPS field and send them to the",
    "start": "954120",
    "end": "959639"
  },
  {
    "text": "printer However the SPS didn't become popular and Microsoft has",
    "start": "959639",
    "end": "968800"
  },
  {
    "text": "remove or we can make our own application to use the SPS print",
    "start": "969320",
    "end": "975959"
  },
  {
    "text": "API The most important function in the SPS print API is the star SPS print",
    "start": "975959",
    "end": "987519"
  },
  {
    "text": "job It connects to a printer using the printer's name as a parameter If you",
    "start": "988199",
    "end": "996079"
  },
  {
    "text": "need to connect a remote printer you have to enter the SMB",
    "start": "996079",
    "end": "1003160"
  },
  {
    "text": "port Then we will use the document string to send our SPS field into the",
    "start": "1003160",
    "end": "1011399"
  },
  {
    "text": "document using the I string read function With the introduction and",
    "start": "1011399",
    "end": "1018079"
  },
  {
    "text": "preparation out of the way let's begin our journey to discover vulnerabilities",
    "start": "1018079",
    "end": "1023199"
  },
  {
    "text": "The first part is vulnerabilities in resource",
    "start": "1023199",
    "end": "1028240"
  },
  {
    "text": "passing Just like the most rendering formats SPS also supports custom embed",
    "start": "1029000",
    "end": "1036720"
  },
  {
    "text": "fonts but they need to be officiated Here we use a simple diagram",
    "start": "1036720",
    "end": "1043520"
  },
  {
    "text": "to explain the deepation It used the field name as a key to",
    "start": "1043520",
    "end": "1049440"
  },
  {
    "text": "perform an SOR operations with the first 32 bytes of the",
    "start": "1049440",
    "end": "1057360"
  },
  {
    "text": "F There are so many research on F before so we won't discuss the detail of F",
    "start": "1059000",
    "end": "1066320"
  },
  {
    "text": "today We prely refer to one phone vulnerability to ruin all poster by",
    "start": "1066320",
    "end": "1074480"
  },
  {
    "text": "Mercy Jurro Jack or Google Pres zero This article has provide us with a",
    "start": "1074480",
    "end": "1083440"
  },
  {
    "text": "lot valuable information We discover nine CVS in the",
    "start": "1083440",
    "end": "1090559"
  },
  {
    "text": "phone passing with bike store print driver rendering Four CVES are remote",
    "start": "1090559",
    "end": "1097440"
  },
  {
    "text": "code execution vulnerability Five CVS are information disclosure",
    "start": "1097440",
    "end": "1104840"
  },
  {
    "text": "vulnerabilities Here we choose two vulnerabilities to introduce First one",
    "start": "1104840",
    "end": "1110160"
  },
  {
    "text": "is CVE 2023 243 Microsoft Postgrade and PCL's class",
    "start": "1110160",
    "end": "1119120"
  },
  {
    "text": "spring print driver information disclosure vulnerability is an out boss read vulnerability in",
    "start": "1119120",
    "end": "1126640"
  },
  {
    "text": "true type parsing and the offset was not checked during the pausing of the",
    "start": "1126640",
    "end": "1133880"
  },
  {
    "text": "table is an common vulnerability pattern in form",
    "start": "1133880",
    "end": "1139559"
  },
  {
    "text": "pausing and the unique point here is the crash call stock it will crash in the",
    "start": "1139559",
    "end": "1147840"
  },
  {
    "text": "string buffer right the function string buffer right",
    "start": "1147840",
    "end": "1154160"
  },
  {
    "text": "is actually used for the output string So you will write our boss data to the",
    "start": "1154160",
    "end": "1162240"
  },
  {
    "text": "output field In this way we can easily turn it",
    "start": "1162240",
    "end": "1167640"
  },
  {
    "text": "into an information leak",
    "start": "1167640",
    "end": "1172679"
  },
  {
    "text": "The second case is the CE 2023 23403 mic store postgrade and PCL's",
    "start": "1173840",
    "end": "1182400"
  },
  {
    "text": "class print driver ring remote code execution",
    "start": "1182400",
    "end": "1187640"
  },
  {
    "text": "vulnerability is an our boss write vulnerability in open tie",
    "start": "1187640",
    "end": "1193320"
  },
  {
    "text": "parsing in the open tie form a special table is the CFF table The CFF table",
    "start": "1193320",
    "end": "1201760"
  },
  {
    "text": "stand for the compact form font forming which is a compressed font data",
    "start": "1201760",
    "end": "1209440"
  },
  {
    "text": "form as known as postgrade type one fonts in the CFF form",
    "start": "1209440",
    "end": "1217000"
  },
  {
    "text": "specification refine the statement An operator may be proceeded by R2 um mess",
    "start": "1217000",
    "end": "1227120"
  },
  {
    "text": "of 48 operators However wherever the code",
    "start": "1227120",
    "end": "1233360"
  },
  {
    "text": "correctly checks for this is our",
    "start": "1233360",
    "end": "1238400"
  },
  {
    "text": "question So we conduct the test and found that there was no check here The",
    "start": "1239880",
    "end": "1246159"
  },
  {
    "text": "code directly all lock an area of C height",
    "start": "1246159",
    "end": "1253679"
  },
  {
    "text": "48 but did not perform any check If there are more than 48",
    "start": "1253960",
    "end": "1260280"
  },
  {
    "text": "operators it will result in an our bot",
    "start": "1260280",
    "end": "1265760"
  },
  {
    "text": "right The second part of resource passing is the column management The",
    "start": "1269159",
    "end": "1274320"
  },
  {
    "text": "column instrument is support in W4 print drivers The common resource file is the",
    "start": "1274320",
    "end": "1280960"
  },
  {
    "text": "ICC profile which for name is international color",
    "start": "1280960",
    "end": "1287080"
  },
  {
    "text": "consortium color profiles The intent of this format is to provide a cost plane",
    "start": "1287080",
    "end": "1295200"
  },
  {
    "text": "for device profile format",
    "start": "1295200",
    "end": "1300600"
  },
  {
    "text": "The ICC profile is used in the SML to describe the page We will modify the",
    "start": "1301120",
    "end": "1308880"
  },
  {
    "text": "previous example by replacing the default colors with an ICC profile to",
    "start": "1308880",
    "end": "1315919"
  },
  {
    "text": "ensure the same color representation across different",
    "start": "1315919",
    "end": "1322480"
  },
  {
    "text": "device Next we need to learn about the format of the ICC profile The standard",
    "start": "1323720",
    "end": "1331120"
  },
  {
    "text": "way is to read specification We found that the ICC",
    "start": "1331120",
    "end": "1336320"
  },
  {
    "text": "format is similar to fonts but we only have limited public resource",
    "start": "1336320",
    "end": "1343799"
  },
  {
    "text": "available They will require more time for document reading and reverse",
    "start": "1343799",
    "end": "1350000"
  },
  {
    "text": "engineering However we don't want to spend too much",
    "start": "1350000",
    "end": "1357200"
  },
  {
    "text": "time learning the format So we need a method to discover",
    "start": "1357200",
    "end": "1363320"
  },
  {
    "text": "vulnerabilities more quickly The method we chose is",
    "start": "1363320",
    "end": "1372559"
  },
  {
    "text": "fing We first saw a WFL which is the most common fuzzing to for the Windows",
    "start": "1372840",
    "end": "1380919"
  },
  {
    "text": "Pall but we did not succeed The ideal scenary for VFL as shown by",
    "start": "1380919",
    "end": "1390000"
  },
  {
    "text": "the ong square is to use an application",
    "start": "1390000",
    "end": "1395120"
  },
  {
    "text": "as a as a harness to load the target library and then call the target",
    "start": "1395120",
    "end": "1402080"
  },
  {
    "text": "function However the scenario of print driver",
    "start": "1402080",
    "end": "1407320"
  },
  {
    "text": "rendering is that we use our application to send the RPC core to the spooler",
    "start": "1407320",
    "end": "1415240"
  },
  {
    "text": "surveys and the spooler surveys will create the subprocess print filter pilot service to",
    "start": "1415240",
    "end": "1424480"
  },
  {
    "text": "load the target driver and then rendering It's quite challenging to",
    "start": "1424480",
    "end": "1431120"
  },
  {
    "text": "write a harness to load print driver and rank directly",
    "start": "1431120",
    "end": "1438360"
  },
  {
    "text": "Next we try using waterf developed by overcloak is an",
    "start": "1439360",
    "end": "1448679"
  },
  {
    "text": "distribute code coverage guide customable cost for",
    "start": "1448679",
    "end": "1456120"
  },
  {
    "text": "snapshot base file for attacking user and kernel mode",
    "start": "1456120",
    "end": "1462799"
  },
  {
    "text": "targets running on Microsoft Windows It seems very suitable for our",
    "start": "1462799",
    "end": "1470679"
  },
  {
    "text": "needs In this fing process we need to set a break point in the passing of the",
    "start": "1470679",
    "end": "1478400"
  },
  {
    "text": "resource code Say the snapshure and then use the father to start fuzzing from the",
    "start": "1478400",
    "end": "1486480"
  },
  {
    "text": "snureer This father enable us to complete fing",
    "start": "1486480",
    "end": "1494080"
  },
  {
    "text": "under the print driver and we are thankful for the great",
    "start": "1494080",
    "end": "1501159"
  },
  {
    "text": "father We discover nice CVS in the ICC profile passing with the Microsoft print",
    "start": "1501159",
    "end": "1509679"
  },
  {
    "text": "driver rendering ACVEs are remote code execution",
    "start": "1509679",
    "end": "1516279"
  },
  {
    "text": "vulnerability Only one CVE is the information disclosure",
    "start": "1516279",
    "end": "1524559"
  },
  {
    "text": "vulnerability Here we will introduce the vulnerability pattern using a specific",
    "start": "1525000",
    "end": "1531279"
  },
  {
    "text": "case The case is the CV 2023",
    "start": "1531279",
    "end": "1538679"
  },
  {
    "text": "24909 Microsoft postgrade and PCL's class print driver remote code execution",
    "start": "1538679",
    "end": "1547960"
  },
  {
    "text": "vulnerability is an integr overflow vulnerability It was happen in passing",
    "start": "1547960",
    "end": "1555039"
  },
  {
    "text": "the profile discretion tag The tech in this contest will use the",
    "start": "1555039",
    "end": "1562440"
  },
  {
    "text": "length fail to describe the side of the stone",
    "start": "1562440",
    "end": "1568440"
  },
  {
    "text": "buffer But the code lack the check against the",
    "start": "1568440",
    "end": "1573559"
  },
  {
    "text": "length If the lens is smaller than the buffer size will result an",
    "start": "1573559",
    "end": "1581840"
  },
  {
    "text": "outbre and if the lens is very large",
    "start": "1581880",
    "end": "1587200"
  },
  {
    "text": "causing an",
    "start": "1587200",
    "end": "1590080"
  },
  {
    "text": "integr pausing let's briefly review SML ML in",
    "start": "1598840",
    "end": "1607200"
  },
  {
    "text": "SPS is quite different when it comes to passing resource in",
    "start": "1611320",
    "end": "1617320"
  },
  {
    "text": "SML The resource fell is in binary format which is hard to read directly",
    "start": "1617320",
    "end": "1625200"
  },
  {
    "text": "but easy to mutate for fuzzing On the other hand SML is easy to read",
    "start": "1625200",
    "end": "1633600"
  },
  {
    "text": "but not as easy to mutate For the resource build they can",
    "start": "1633600",
    "end": "1639279"
  },
  {
    "text": "perform the same function across different applications make them",
    "start": "1639279",
    "end": "1646080"
  },
  {
    "text": "easy to connect But the SML file are designed",
    "start": "1646080",
    "end": "1653720"
  },
  {
    "text": "specifically for software and the and the direct use of the SPS field is",
    "start": "1653720",
    "end": "1662679"
  },
  {
    "text": "widespread making it difficult to",
    "start": "1662679",
    "end": "1668360"
  },
  {
    "text": "connect So we had to generate the XML file oursel We need to read uh",
    "start": "1668360",
    "end": "1679399"
  },
  {
    "text": "496 page SPS documents and then create the",
    "start": "1679399",
    "end": "1685559"
  },
  {
    "text": "corresponding SML But we don't want to do that Instead",
    "start": "1685559",
    "end": "1693520"
  },
  {
    "text": "we aim to automate the generation process",
    "start": "1693520",
    "end": "1699880"
  },
  {
    "text": "We found that the document recruits an SSD field which is typically used for",
    "start": "1700799",
    "end": "1712880"
  },
  {
    "text": "validating SML formats Can",
    "start": "1713080",
    "end": "1718760"
  },
  {
    "text": "we review the process and use the XSD to",
    "start": "1718760",
    "end": "1723919"
  },
  {
    "text": "generate the SML we made the following try",
    "start": "1723919",
    "end": "1732240"
  },
  {
    "text": "First using the SSD to extract the",
    "start": "1732240",
    "end": "1737399"
  },
  {
    "text": "tags and adding some mutation a",
    "start": "1737399",
    "end": "1742440"
  },
  {
    "text": "lodgement to generate the corresponding",
    "start": "1742440",
    "end": "1747960"
  },
  {
    "text": "SML Then we package it together with other resource film into an SPS field",
    "start": "1747960",
    "end": "1758080"
  },
  {
    "text": "However the fields generated this way sometimes does not meet the requirements",
    "start": "1758080",
    "end": "1765600"
  },
  {
    "text": "for the print driver rendering We need to debug and perform",
    "start": "1765600",
    "end": "1772159"
  },
  {
    "text": "reverse engineering to identify the cause In this process we found that the",
    "start": "1772159",
    "end": "1780960"
  },
  {
    "text": "print driver renderings records the error",
    "start": "1780960",
    "end": "1786520"
  },
  {
    "text": "logs So we want to use the error log to",
    "start": "1786520",
    "end": "1791720"
  },
  {
    "text": "improve our document",
    "start": "1791720",
    "end": "1797080"
  },
  {
    "text": "We may try to send the arrows log along with the SPS document to the large",
    "start": "1799840",
    "end": "1808480"
  },
  {
    "text": "language model to repair the SML",
    "start": "1808480",
    "end": "1813799"
  },
  {
    "text": "field This way help us save some time to repair the",
    "start": "1813799",
    "end": "1821520"
  },
  {
    "text": "documents Here we discovered more vulnerabilities and",
    "start": "1822919",
    "end": "1828440"
  },
  {
    "text": "obtain 12 CVES Most of them is the remote code",
    "start": "1828440",
    "end": "1834880"
  },
  {
    "text": "execution vulnerability We appreciate Microsoft's effect in facing all the",
    "start": "1834880",
    "end": "1843278"
  },
  {
    "text": "vulnerabilities We will introduce the vulnerability pattern using a specific case The case is CV",
    "start": "1844440",
    "end": "1852440"
  },
  {
    "text": "2023 24927 The weakness of the vulnerability",
    "start": "1852440",
    "end": "1858159"
  },
  {
    "text": "is type conclusion The yellow square here",
    "start": "1858159",
    "end": "1864640"
  },
  {
    "text": "describe a correct SML and the calling",
    "start": "1864640",
    "end": "1869720"
  },
  {
    "text": "process During the rendering the SA pause draw function is called to pass",
    "start": "1869720",
    "end": "1878640"
  },
  {
    "text": "the tag step by step If the true tag of pass stroke is",
    "start": "1878640",
    "end": "1886480"
  },
  {
    "text": "solid color brush the correspondingly offset function of the v",
    "start": "1886480",
    "end": "1893399"
  },
  {
    "text": "table sid color brush drop is called However",
    "start": "1893399",
    "end": "1900640"
  },
  {
    "text": "if our pass stroke lacks a CH tag it will call a incorrect function in",
    "start": "1900640",
    "end": "1909279"
  },
  {
    "text": "the V table leading to a tight confusion",
    "start": "1909279",
    "end": "1915120"
  },
  {
    "text": "vulnerability After our effect we report many vulnerability case to Microsoft",
    "start": "1917240",
    "end": "1926000"
  },
  {
    "text": "They realized there were many problems with the attack surface and to action to fix",
    "start": "1926000",
    "end": "1933679"
  },
  {
    "text": "the",
    "start": "1933679",
    "end": "1936000"
  },
  {
    "text": "document We start to wonder if that was enough So we shift our focus to test the",
    "start": "1938760",
    "end": "1947600"
  },
  {
    "text": "print drivers or other companies",
    "start": "1947600",
    "end": "1953039"
  },
  {
    "text": "So the third part is vulnerability in third party",
    "start": "1953039",
    "end": "1958120"
  },
  {
    "text": "driver After investigating several common",
    "start": "1958120",
    "end": "1963480"
  },
  {
    "text": "print companies we found that some still depend on Microsoft",
    "start": "1963480",
    "end": "1970600"
  },
  {
    "text": "disconnected drivers for their printing while others had implement their own",
    "start": "1970600",
    "end": "1976960"
  },
  {
    "text": "custom drivers Some companies use their own printer",
    "start": "1976960",
    "end": "1984120"
  },
  {
    "text": "drivers such as HP D and Conan while",
    "start": "1984120",
    "end": "1989440"
  },
  {
    "text": "others still rely on Microsoft print drivers like Cuseria",
    "start": "1989440",
    "end": "1997880"
  },
  {
    "text": "We discover vulnerabilities in this customer print drivers and ret report",
    "start": "1997919",
    "end": "2004960"
  },
  {
    "text": "them to their security departments such as",
    "start": "2004960",
    "end": "2011440"
  },
  {
    "text": "HP Microsoft has now enabled a new architecture for printers called Windows",
    "start": "2011960",
    "end": "2019720"
  },
  {
    "text": "proteti print mode In this mode loading third party models is not allowed SPS",
    "start": "2019720",
    "end": "2027760"
  },
  {
    "text": "rendering will be performed under users permissions Common spool task privilege",
    "start": "2027760",
    "end": "2035919"
  },
  {
    "text": "will be done grindy and many mitigations has been",
    "start": "2035919",
    "end": "2042360"
  },
  {
    "text": "added as shown in the diagram Printer related task are now handled by",
    "start": "2042360",
    "end": "2050358"
  },
  {
    "text": "spooler worker point s which runs in a restricted service",
    "start": "2050359",
    "end": "2057599"
  },
  {
    "text": "contains rather than system the windows protective print",
    "start": "2057599",
    "end": "2064040"
  },
  {
    "text": "mood will significantly reduce the attack surface or printers and mitigate",
    "start": "2064040",
    "end": "2071679"
  },
  {
    "text": "the impact of vulnerability Next I will hand the microphone back to",
    "start": "2071679",
    "end": "2078320"
  },
  {
    "text": "my c-orker Jinyang Pong to summarize",
    "start": "2078320",
    "end": "2083599"
  },
  {
    "text": "Okay Uh the last part the summary So uh in this talk we review",
    "start": "2083599",
    "end": "2091200"
  },
  {
    "text": "some of the old bug for print sporter and we diving into principer again and",
    "start": "2091200",
    "end": "2097520"
  },
  {
    "text": "find a new attack surface in it By diving into this new attack surface we",
    "start": "2097520",
    "end": "2103920"
  },
  {
    "text": "find more than 13 CVE in print sporter which is rce and lp vulnerability in",
    "start": "2103920",
    "end": "2110599"
  },
  {
    "text": "windows and those bug happens in resource passing xml passing of windows",
    "start": "2110599",
    "end": "2116640"
  },
  {
    "text": "driver printer and we also find some bugs in third party printer drivers",
    "start": "2116640",
    "end": "2124680"
  },
  {
    "text": "So the takeaways you can always find some new attack surface if re you really dive",
    "start": "2125680",
    "end": "2132480"
  },
  {
    "text": "into it The principal service is researched for many years uh by security",
    "start": "2132480",
    "end": "2139680"
  },
  {
    "text": "researcher but it still has so many bugs So if you really dive into some",
    "start": "2139680",
    "end": "2147280"
  },
  {
    "text": "attack surface uh deep enough you can find new bugs And that's the most important",
    "start": "2147280",
    "end": "2154920"
  },
  {
    "text": "is as I always says disable your sporter if you don't need",
    "start": "2154920",
    "end": "2160440"
  },
  {
    "text": "it And that's all for my talk Thanks for listening",
    "start": "2160440",
    "end": "2165520"
  },
  {
    "text": "[Applause]",
    "start": "2165520",
    "end": "2171679"
  }
]