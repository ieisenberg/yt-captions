[
  {
    "text": "[Music]",
    "start": "2200",
    "end": "10639"
  },
  {
    "text": "[Music]",
    "start": "26420",
    "end": "29499"
  },
  {
    "text": "[Music]",
    "start": "34240",
    "end": "40240"
  },
  {
    "text": "I don't know if I'm just going to skip over whole sections because that means I'd probably have to do a slide about every 30 seconds and that might be just a bit too fast uh quick introduction my",
    "start": "43760",
    "end": "51320"
  },
  {
    "text": "name is Greg hogland I'm probably most welln for uh my work on rot kit.com site and stuff related to rootkits uh couple",
    "start": "51320",
    "end": "59559"
  },
  {
    "text": "years ago I started a company called senic and I worked for about 3 years on a product called hail storm which is a",
    "start": "59559",
    "end": "65119"
  },
  {
    "text": "fault injector for the network blackbox injection style um I've since graduated from that thinking process and I'm",
    "start": "65119",
    "end": "71119"
  },
  {
    "text": "trying to integrate a whole bunch of different concepts into a single cohesive process for finding bugs and",
    "start": "71119",
    "end": "76600"
  },
  {
    "text": "software um so I call this the gray box process some of you may have been to the",
    "start": "76600",
    "end": "82159"
  },
  {
    "text": "E and Y Booth over there I noticed they were talking about gry box and I actually am not in cahoots with them I",
    "start": "82159",
    "end": "87439"
  },
  {
    "text": "uh I went over and asked them their definition and fortunately it's pretty close to mind so there won't be any confusion",
    "start": "87439",
    "end": "94040"
  },
  {
    "text": "there um now I have a new company uh I've since left senic I'm my new company's called hbgary and what we do is we exploit",
    "start": "94040",
    "end": "101759"
  },
  {
    "text": "software the whole point of this company is to develop survivable payloads that",
    "start": "101759",
    "end": "106840"
  },
  {
    "text": "work in the field and that they Dependable in nature and so part of that process is of course finding bugs oday",
    "start": "106840",
    "end": "113719"
  },
  {
    "text": "or testing bugs testing exploits against variety of targets um so this is",
    "start": "113719",
    "end": "118960"
  },
  {
    "text": "obviously something to value for me but I don't think there's a product here uh all the stuff I'm going to show you for the most part is stuff that we're going",
    "start": "118960",
    "end": "125039"
  },
  {
    "text": "to be releasing for free or have released for free off the website the reason why is that people who are reverse engineering software there",
    "start": "125039",
    "end": "130640"
  },
  {
    "text": "aren't very many of you out there there's not enough of you to to validate having a product so it's going to be",
    "start": "130640",
    "end": "135720"
  },
  {
    "text": "basically all free um and of course this is uh something you shouldn't trivialize",
    "start": "135720",
    "end": "141800"
  },
  {
    "text": "the process uh is taking what's otherwise of black art and making it something that's repeatable consistent",
    "start": "141800",
    "end": "147959"
  },
  {
    "text": "and overall that's going to save you a cra load of money if you're developing exploits which I know is something that",
    "start": "147959",
    "end": "154599"
  },
  {
    "text": "a lot of people are doing now um the fun part of this is",
    "start": "154599",
    "end": "160480"
  },
  {
    "text": "that I'm a deconstructionist many many of you probably are too and it means that you're you really like to take",
    "start": "160480",
    "end": "166280"
  },
  {
    "text": "things apart I'd much rather take something apart than build it um and there's something about this secret",
    "start": "166280",
    "end": "172519"
  },
  {
    "text": "knowledge of having some kind of oday or other thing that you know appeals to our deep psych and uh this is an age-old",
    "start": "172519",
    "end": "179040"
  },
  {
    "text": "battle uh which probably goes back to the days when uh people invented crypto and secret messages were passed around",
    "start": "179040",
    "end": "185360"
  },
  {
    "text": "and then other people figured out how to decipher the crypto the ciphers and the codes and took it apart and this battle",
    "start": "185360",
    "end": "190519"
  },
  {
    "text": "still goes on today now there's a much better reason a",
    "start": "190519",
    "end": "196280"
  },
  {
    "text": "much more uh concrete reason to be looking for oday or trying to exploit software exploits are worth Cold Hard",
    "start": "196280",
    "end": "203440"
  },
  {
    "text": "Cash plain and simple I think it's ridiculous some of the people in the community who sell their exploits to ID",
    "start": "203440",
    "end": "209000"
  },
  {
    "text": "defense for $50 a vulnerability could be worth six figures easy think about what a remote",
    "start": "209000",
    "end": "215280"
  },
  {
    "text": "oday in Cisco would be like in the hands of a drug cartel or in the hands of a",
    "start": "215280",
    "end": "220439"
  },
  {
    "text": "military and if nobody else knew about it think about how powerful that is from the software vendors point of you it's",
    "start": "220439",
    "end": "227680"
  },
  {
    "text": "easy to see over 100k value in an exploit because that's about how much it's going to cost a large software",
    "start": "227680",
    "end": "233280"
  },
  {
    "text": "vendor to fix a bug if it goes into deployment and everybody finds out about",
    "start": "233280",
    "end": "238400"
  },
  {
    "text": "it and they have to deal with the pr cost of that the other thing is that exploits are worth worth lives if we",
    "start": "238400",
    "end": "244599"
  },
  {
    "text": "have an exploit that works from remote we have this concept of standoff now we can do something that may have required",
    "start": "244599",
    "end": "250680"
  },
  {
    "text": "a physical penetration before which means that we aren't putting a solders life in danger and exploits are obviously",
    "start": "250680",
    "end": "257320"
  },
  {
    "text": "strategic because if you can get something into a computational system computational systems are used to make",
    "start": "257320",
    "end": "263360"
  },
  {
    "text": "decisions and if you can change the way those decisions are being made you get ahead of your enemy's decision cycle and",
    "start": "263360",
    "end": "269240"
  },
  {
    "text": "that's exact L the point of information operations now exploits don't last long",
    "start": "269240",
    "end": "276000"
  },
  {
    "text": "uh their Sur survivability depends on uh nobody else knowing about them if somebody does know about it they can",
    "start": "276000",
    "end": "281160"
  },
  {
    "text": "obviously patch against it or detect it as soon as you use a new exploit very",
    "start": "281160",
    "end": "287400"
  },
  {
    "text": "moment you do it you have you run the risk of compromising that asset because a person you just attacked May sniff",
    "start": "287400",
    "end": "292600"
  },
  {
    "text": "that and be aware of it so that means that there's a time between when you",
    "start": "292600",
    "end": "297680"
  },
  {
    "text": "have a new weapon and when that weapon is probably not going to be as useful the other thing is that if you're doing",
    "start": "297680",
    "end": "302800"
  },
  {
    "text": "this in a lab the public may find that same vulnerability and alternatively your enemy may find the same",
    "start": "302800",
    "end": "308360"
  },
  {
    "text": "vulnerability and thus the value of that goes down so this is the mission statement in",
    "start": "308360",
    "end": "314840"
  },
  {
    "text": "order to maintain a battle Advantage your offensive information capabilities",
    "start": "314840",
    "end": "319880"
  },
  {
    "text": "must include a lab process for finding and exploiting new software bugs that is a constant ongoing",
    "start": "319880",
    "end": "327120"
  },
  {
    "text": "process so I broke the uh talk in a couple chapters uh the first one is the",
    "start": "327120",
    "end": "332280"
  },
  {
    "text": "bugs I'm then going to talk about some of the tools that we have and towards the end of the talk I'll show some pretty pictures um so chapter one The",
    "start": "332280",
    "end": "339080"
  },
  {
    "text": "Bugs I have four classifications of these uh the biggest one of course everybody's aware of is buffer overflows",
    "start": "339080",
    "end": "345280"
  },
  {
    "text": "um lack of balance checking or arithmetic errors causing these um a more obscure but equally powerful attack",
    "start": "345280",
    "end": "352160"
  },
  {
    "text": "can be is parsing problems now this is a new area buffer overflows by the way are going to go away pretty soon uh probably",
    "start": "352160",
    "end": "359080"
  },
  {
    "text": "give it next 5 to 10 years and you're not going to see too many of these out there anymore you can already see it many pieces of software uh are not",
    "start": "359080",
    "end": "365680"
  },
  {
    "text": "vulnerable to simple buffer overflows the previously were um parsing problems are interesting General State",
    "start": "365680",
    "end": "372479"
  },
  {
    "text": "corruption uh is just kind of a more General problem of the parsing problem and then race",
    "start": "372479",
    "end": "378840"
  },
  {
    "text": "conditions so obviously this is old news everybody has talked about buffer overflows to death um I think the only",
    "start": "378840",
    "end": "385360"
  },
  {
    "text": "point I'm trying to make here is that they're still common but they're going away rapidly as compiler Technologies",
    "start": "385360",
    "end": "391319"
  },
  {
    "text": "are being upgraded to get rid of this issue uh Microsoft I think will be",
    "start": "391319",
    "end": "396720"
  },
  {
    "text": "producing the most secure code uh in the entire industry within five",
    "start": "396720",
    "end": "402000"
  },
  {
    "text": "years so parsing problems let's move on to something more interesting um they are not solved by better compilers",
    "start": "402440",
    "end": "409440"
  },
  {
    "text": "rather they're solved by having good algorithms and most human beings are not very good at designing good algorithms",
    "start": "409440",
    "end": "415680"
  },
  {
    "text": "um so there's this idea I had that maybe if someone build a standards uh some standards for algorithms we would have",
    "start": "415680",
    "end": "422080"
  },
  {
    "text": "some peer review on that similar to crypto and these things would get better uh but the fact is I don't think this is",
    "start": "422080",
    "end": "427840"
  },
  {
    "text": "ever really going to happen because people don't really like standards and everybody makes exceptions to the rules so I think for a long time we're going",
    "start": "427840",
    "end": "433919"
  },
  {
    "text": "to be looking at parsing issues General state is just a different term I use it's more general for the same issue you",
    "start": "433919",
    "end": "440160"
  },
  {
    "text": "have a set of states in the Target computer uh there are many more states there than the Builders of that system",
    "start": "440160",
    "end": "445919"
  },
  {
    "text": "intended to be there think about it emergent States right there could be potentially thousands or millions of",
    "start": "445919",
    "end": "453280"
  },
  {
    "text": "possible States in a given application do you think that the programmers who wrote that were considering all those",
    "start": "453280",
    "end": "458720"
  },
  {
    "text": "possibilities when they wrote it oh no no they weren't at all what they were doing is running their compiler over and over again until all the errors went",
    "start": "458720",
    "end": "464840"
  },
  {
    "text": "away and as soon as that happens they ship it over to QA and if QA doesn't spy any problems it's out and QA in most",
    "start": "464840",
    "end": "471440"
  },
  {
    "text": "places they they're not very",
    "start": "471440",
    "end": "475960"
  },
  {
    "text": "good um so General State exploits would be a situation where I can send a set of commands in exactly the right order thus",
    "start": "476759",
    "end": "484039"
  },
  {
    "text": "manipulating the state of the target machine into a insecure State and thus performing an exploit at that point now",
    "start": "484039",
    "end": "489720"
  },
  {
    "text": "this could be solved by using provably correct systems now that's a very old idea but how many of you have actually",
    "start": "489720",
    "end": "495240"
  },
  {
    "text": "seen a provably correct system has anybody here ever seen a system built if you have have you seen how much it cost",
    "start": "495240",
    "end": "501960"
  },
  {
    "text": "to build a system like that and once it was built how long was it actually used in the field before it was replaced by",
    "start": "501960",
    "end": "507159"
  },
  {
    "text": "newer and better technology I think you get my point race conditions are the buffer overflow of the future in",
    "start": "507159",
    "end": "513479"
  },
  {
    "text": "my opinion uh we're going to have more distribution of agents and other things that have to stay in contact with other",
    "start": "513479",
    "end": "519640"
  },
  {
    "text": "with each other and stay synchronized so uh I'm not going to talk too much more about race conditions in this talk but",
    "start": "519640",
    "end": "526320"
  },
  {
    "text": "uh it's the type of thing that uh I smell a lot of potential for exploits in the future uh when we have a lot of",
    "start": "526320",
    "end": "531360"
  },
  {
    "text": "different nodes that have to communicate it's very easy obviously for them to get desynchronized from one another all",
    "start": "531360",
    "end": "536959"
  },
  {
    "text": "right so now I'm going to talk about gray box I'm actually going to give you a little little history of the different testing methodologies that are out there",
    "start": "536959",
    "end": "542680"
  },
  {
    "text": "it's uh I'm not going to blavor them too much because I'm sure most of you know all this so I'll go quickly through these slides um but quick definition",
    "start": "542680",
    "end": "549480"
  },
  {
    "text": "here graybox is to combine a set of tools including first and foremost static analysis and then augment that",
    "start": "549480",
    "end": "556920"
  },
  {
    "text": "with runtime analysis to correct your data set static analysis is not going to answer all the questions that need to be",
    "start": "556920",
    "end": "563399"
  },
  {
    "text": "answered about the software and thus at runtime you can gather additional data and augment your data set and learn",
    "start": "563399",
    "end": "569120"
  },
  {
    "text": "things otherwise would not have been able to see so white box is in theory operating",
    "start": "569120",
    "end": "575240"
  },
  {
    "text": "with full knowledge of the system anybody who's read source code or looked at binary analysis knows that's a load",
    "start": "575240",
    "end": "580440"
  },
  {
    "text": "of crap even though we call it white box we have no idea what the intent of the Builder of that system was we get a tiny",
    "start": "580440",
    "end": "586079"
  },
  {
    "text": "little sliver of what they were looking at obviously we have tools like Ida Pro",
    "start": "586079",
    "end": "592480"
  },
  {
    "text": "that help us with this uh the term used is dead listings typically when we have a disassembly and I think that source",
    "start": "592480",
    "end": "599839"
  },
  {
    "text": "code uh in this case it's just merely documentation for the binary itself very good documentation mind you but we're",
    "start": "599839",
    "end": "606959"
  },
  {
    "text": "concerned about the binary uh the most important thing is we're not actually executing the software so in our process",
    "start": "606959",
    "end": "613040"
  },
  {
    "text": "that we're still developing our graybox process the first thing we do is we run it through a product that we have built called Bug scan and we immediately",
    "start": "613040",
    "end": "619920"
  },
  {
    "text": "obtain like instantly a quick report of how bad the",
    "start": "619920",
    "end": "625120"
  },
  {
    "text": "situation is uh schematically identifiable vulnerabilities are put into a report we can scan a whole bunch",
    "start": "625120",
    "end": "631200"
  },
  {
    "text": "of binaries up front and figure out where we're going to prioritize ourselves if this one over here has a",
    "start": "631200",
    "end": "636920"
  },
  {
    "text": "bunch of really good coding practices going on and this one over here has a bunch of bad ones we know where we can you know put the",
    "start": "636920",
    "end": "643959"
  },
  {
    "text": "muscle now if we're actually going to go further than just looking at the binary we're going to obviously do an Ida dead listing of that and Ida is the best",
    "start": "645240",
    "end": "652480"
  },
  {
    "text": "program out there for managing dead listings because it allows you to comment them cross reference jump all around it's not the fastest decompiler I",
    "start": "652480",
    "end": "659560"
  },
  {
    "text": "can put something in Ida and it'll decompile in maybe three or four minutes same program in PE dasm will uh",
    "start": "659560",
    "end": "665720"
  },
  {
    "text": "disassemble in something like 30 seconds and it has full cross referencing as well so even though it is not the fastest disassemble it's certainly the",
    "start": "665720",
    "end": "672079"
  },
  {
    "text": "easiest to use now static analysis is never going",
    "start": "672079",
    "end": "678920"
  },
  {
    "text": "to answer this question you can't say that something is exploitable until you exploit it so obviously we've got to go",
    "start": "678920",
    "end": "685959"
  },
  {
    "text": "further than just looking at dead listings every automatic analys tool has this problem and you cannot remove the",
    "start": "685959",
    "end": "692959"
  },
  {
    "text": "human auditor from the loop the human mind is the best pattern matching system we have but unfortunately we are",
    "start": "692959",
    "end": "699920"
  },
  {
    "text": "expensive and slow so what I found is that we spend a",
    "start": "699920",
    "end": "705079"
  },
  {
    "text": "lot of time as an auditor doing things that are tedious and mundane like writing down hex addresses on a napkin late at",
    "start": "705079",
    "end": "710720"
  },
  {
    "text": "night this stuff needs to be automated and so that's where I'm approaching this from I'm not trying to build a magic",
    "start": "710720",
    "end": "715880"
  },
  {
    "text": "tool that solves all our problems I'm trying to make tools allow the auditor to stay in the zone don't get out of the",
    "start": "715880",
    "end": "721720"
  },
  {
    "text": "source code to go do this other thing that's completely meaningless you know to my thinking process um another thing to note about",
    "start": "721720",
    "end": "728480"
  },
  {
    "text": "static analysis I think this is important even if you don't take the time to actually find an exploit you got",
    "start": "728480",
    "end": "733560"
  },
  {
    "text": "to ask yourself does it matter what if I do have a Sprint F or a stir copy in there and this particular interface",
    "start": "733560",
    "end": "739120"
  },
  {
    "text": "isn't exposed to any user Supply data from the network but it's in a dll what can I say about the developers that",
    "start": "739120",
    "end": "745120"
  },
  {
    "text": "going to be working at this company 10 years from now absolutely nothing they may reuse that in a different module",
    "start": "745120",
    "end": "751320"
  },
  {
    "text": "expose it suddenly so by that token I think it's valuable to consider that every possible vulnerability is",
    "start": "751320",
    "end": "756760"
  },
  {
    "text": "important enough to to Warrant it being fixed if you're on the defensive",
    "start": "756760",
    "end": "762880"
  },
  {
    "text": "side now automatic bug detection requires a schematic for what that vulnerability looks like so things that",
    "start": "763320",
    "end": "769199"
  },
  {
    "text": "are easy to detect schematically are sign to unsign conversion errors uh bad API calls format string",
    "start": "769199",
    "end": "776959"
  },
  {
    "text": "buffer overflows um this is effective if we can get Ida",
    "start": "776959",
    "end": "782920"
  },
  {
    "text": "or our disassembler to find all the instructions uh this isn't always possible and there's all kinds of little",
    "start": "782920",
    "end": "789320"
  },
  {
    "text": "issues that come up like calling to registers or having these undocumented structures that obviously you're not",
    "start": "789320",
    "end": "794600"
  },
  {
    "text": "going to know unless you run the program and look at it uh pure static analysis is not going to answer these",
    "start": "794600",
    "end": "799959"
  },
  {
    "text": "questions many branching decisions are made based upon user Supply data every time you see a compare followed by a",
    "start": "799959",
    "end": "806360"
  },
  {
    "text": "jump if not equal or a jump if larger than these things uh these are influenceable by the user",
    "start": "806360",
    "end": "811800"
  },
  {
    "text": "so we want to track where all the branching decisions are being made this helps us increase our code coverage if we're doing a test we want to increase",
    "start": "811800",
    "end": "818399"
  },
  {
    "text": "the code coverage as much as possible because every Branch you know there could be a potential for a problem in there now for a static analyzer to do",
    "start": "818399",
    "end": "825399"
  },
  {
    "text": "this it has to emulate execution at some point I pait the emulation of the",
    "start": "825399",
    "end": "830680"
  },
  {
    "text": "execution is equal to just simply running the program to begin with",
    "start": "830680",
    "end": "837120"
  },
  {
    "text": "another issue that I've run into a lot is when I'm back tracing uh if I'm back",
    "start": "846880",
    "end": "852279"
  },
  {
    "text": "tracing data I often run into I call them runouts uh we'll go back a certain distance and there won't be any",
    "start": "852279",
    "end": "857360"
  },
  {
    "text": "locations cross referen to me but I know something's there this happens for example with message handlers and",
    "start": "857360",
    "end": "863000"
  },
  {
    "text": "windows so this is another issue that we run into doing static analysis that if we had runtime analysis is almost",
    "start": "863000",
    "end": "869399"
  },
  {
    "text": "instantly solved now",
    "start": "869399",
    "end": "875600"
  },
  {
    "text": "blackbox if we're going to do runtime analysis we have to be able to exercise the software for most software it's",
    "start": "875600",
    "end": "881120"
  },
  {
    "text": "going to be more difficult than just tell netting to the port or sending things by a netcat uh as many of you have probably",
    "start": "881120",
    "end": "887240"
  },
  {
    "text": "realized clients and servers maintain state with one another and client code can be very complex I learned this when",
    "start": "887240",
    "end": "894720"
  },
  {
    "text": "I was working with hailstorm and I was trying to model some very complex protocols Soma being one of them do you",
    "start": "894720",
    "end": "901279"
  },
  {
    "text": "realize how difficult it is to build Soma packets and maintain State completely from scratch it's hard and",
    "start": "901279",
    "end": "907560"
  },
  {
    "text": "it's very difficult for someone who's not familiar with protocols to get any kind of value out of that because they're not going to be able to build",
    "start": "907560",
    "end": "913519"
  },
  {
    "text": "those mod those protocol models themselves um now some fuzzers I mentioned in hail storm uh there's one",
    "start": "913519",
    "end": "918759"
  },
  {
    "text": "that's very good from Dave Vel Spike uh you're going to need something uh and to do these this",
    "start": "918759",
    "end": "925199"
  },
  {
    "text": "fuzzing from a tool like this you're going to require deep protocol knowledge blackbox has a couple disadvantages when",
    "start": "925199",
    "end": "931920"
  },
  {
    "text": "you're doing input injection it can take a great deal of time to complete a run a sequence I've run a blackbox injection",
    "start": "931920",
    "end": "937720"
  },
  {
    "text": "against a Target overnight come in the next morning it's still running that happens if the program is running slow",
    "start": "937720",
    "end": "943880"
  },
  {
    "text": "that obviously compounds this is just a brute forcing problem and unfortunately most of the blackbox stuff that I've",
    "start": "943880",
    "end": "949920"
  },
  {
    "text": "been exposed to doesn't get very deep code coverage it just gets in just a tiny bit you mean maybe one or two% into",
    "start": "949920",
    "end": "956600"
  },
  {
    "text": "the where it's receiving but it does work as this screenshot illustrates uh this is something I did last year I'm",
    "start": "956600",
    "end": "962199"
  },
  {
    "text": "running hailstorm against Microsoft SQL server and I'm just changing literally",
    "start": "962199",
    "end": "967399"
  },
  {
    "text": "random data into a field I mean this is as simple as it gets and we get a buffer overflow now it's really cool because",
    "start": "967399",
    "end": "974440"
  },
  {
    "text": "I'm actually running rational purify on the binary as I'm doing this and you can see in rational purify the actual",
    "start": "974440",
    "end": "980600"
  },
  {
    "text": "addresses that are having memory corruption so using blackbox in conjunction with an instrumentation of",
    "start": "980600",
    "end": "986399"
  },
  {
    "text": "the target which is what you know purify does Matt what's the name of that one Val grind Val grind for Linux does the",
    "start": "986399",
    "end": "992680"
  },
  {
    "text": "same thing um you will get actual code addresses where corruption is occurring and that helps a lot especially if",
    "start": "992680",
    "end": "998240"
  },
  {
    "text": "you're on the uh offensive side now uh I just talked about this so",
    "start": "998240",
    "end": "1004079"
  },
  {
    "text": "I'm not going to talk about it again uh now one of the cool techniques that I've been working on lately is just instrumenting clients uh so one of the",
    "start": "1004079",
    "end": "1012360"
  },
  {
    "text": "targets that I've been analyzing is Microsoft SQL server and it accepts connections over Port 1433 and I didn't",
    "start": "1012360",
    "end": "1019600"
  },
  {
    "text": "want to build those those uh transactions by hand so there's this really cool program called free TDS well",
    "start": "1019600",
    "end": "1025199"
  },
  {
    "text": "free TDs is open sourced so it's very easy for me to go and add additional code to the client to make it hostile to",
    "start": "1025199",
    "end": "1031678"
  },
  {
    "text": "mutate it and so this is a very effective way to Target Target an executable and don't make the mistake of",
    "start": "1031679",
    "end": "1038438"
  },
  {
    "text": "thinking you can't have a client you're going to need some kind of client that allows you to mutate the transactions uh you could man in the middle of packets I",
    "start": "1038439",
    "end": "1044640"
  },
  {
    "text": "know some of you are thinking about that but think about when uh you have an authentication sequence and then post authentication and now it's all",
    "start": "1044640",
    "end": "1050280"
  },
  {
    "text": "encrypted Man In The Middle on the packet doesn't really work very well",
    "start": "1050280",
    "end": "1055160"
  },
  {
    "text": "anymore if you don't have the source code to your client you can hook the client this is a possibility uh you can",
    "start": "1057640",
    "end": "1064880"
  },
  {
    "text": "just put a breakpoint on a location and swap uh a memory pointer to a different memory pointer if the buffer that you're",
    "start": "1064880",
    "end": "1071039"
  },
  {
    "text": "playing around with uh is not going to change in size you can just write over the existing memory and just change some",
    "start": "1071039",
    "end": "1076799"
  },
  {
    "text": "values there that works as well um using a debugger I mean it's simple",
    "start": "1076799",
    "end": "1083760"
  },
  {
    "text": "technology now gray box is combining these tools together if you use a program debugger you're already to some",
    "start": "1084679",
    "end": "1090280"
  },
  {
    "text": "extent performing graybox analysis now obviously we're doing this at runtime so we can observe everything about the",
    "start": "1090280",
    "end": "1096000"
  },
  {
    "text": "target every single instruction which is executed we can observe and we can trace",
    "start": "1096000",
    "end": "1101679"
  },
  {
    "text": "data and that's more important than anything it's obviously a very interactive process this is something",
    "start": "1101679",
    "end": "1108039"
  },
  {
    "text": "where you're going to be sitting there or the practitioner is going to be sitting there working with this thing resetting the state of the program",
    "start": "1108039",
    "end": "1114159"
  },
  {
    "text": "changing some value walking forward seeing what happens again the human pattern matching system is back online",
    "start": "1114159",
    "end": "1119880"
  },
  {
    "text": "and getting what it needs so there's a whole list of tools there that are used now all the stuff that I've been working",
    "start": "1119880",
    "end": "1125120"
  },
  {
    "text": "on is all is all windows-based and so I think it's worth mentioning Fenris at this point because it just does a lot of",
    "start": "1125120",
    "end": "1130520"
  },
  {
    "text": "the stuff that is uh that I'm talking about and it does it for Linux and this is going to be obtained somewhere",
    "start": "1130520",
    "end": "1136039"
  },
  {
    "text": "through a link off bind View now I'm going to talk about bug scan",
    "start": "1136039",
    "end": "1142159"
  },
  {
    "text": "very briefly this is the only thing that I have that's actually a product the rest of the stuff is all",
    "start": "1142159",
    "end": "1148280"
  },
  {
    "text": "tools um the key here that the biggest thing I learned when I was building hail storm is that you can't make a product really complicated so the coolest thing",
    "start": "1148280",
    "end": "1155120"
  },
  {
    "text": "about bug scan is that it's extremely simple to use you put the binary in you get the report out it doesn't tell you",
    "start": "1155120",
    "end": "1161120"
  },
  {
    "text": "if the exploit if it's exploitable of course it just gives you a hint of where the locations might be but it takes 30",
    "start": "1161120",
    "end": "1166520"
  },
  {
    "text": "seconds not 30 hours to do this work scalability now so here's how it works",
    "start": "1166520",
    "end": "1173799"
  },
  {
    "text": "has a web interface you submit the binary hit upload get the report oh wait did you miss that let me go back submit",
    "start": "1173799",
    "end": "1180000"
  },
  {
    "text": "the binary get the report now the report items are pretty",
    "start": "1180000",
    "end": "1185120"
  },
  {
    "text": "cool they're red yellow green uh yellow is like a coding error red is like we believe this to possibly take user input",
    "start": "1185120",
    "end": "1190720"
  },
  {
    "text": "from the network or something to that effect and a green is actually a reward if we see a um good coding practice like",
    "start": "1190720",
    "end": "1196679"
  },
  {
    "text": "an strn copy for example uh it would be marked green now I have a couple of reports I'm going to show you uh I",
    "start": "1196679",
    "end": "1203400"
  },
  {
    "text": "cannot tell you the vendors for these products so don't ask but I'm going to show you some reports on the",
    "start": "1203400",
    "end": "1209679"
  },
  {
    "text": "field uh for this particular talk I did different different targets for my last",
    "start": "1209679",
    "end": "1215120"
  },
  {
    "text": "talk the one I gave in Amsterdam uh this one I'm just going to have a couple of SQL servers up here uh here's one of",
    "start": "1215120",
    "end": "1221000"
  },
  {
    "text": "them where the number of s SW print FS numbers close to 400 there's 200 Sprint FS uh these are",
    "start": "1221000",
    "end": "1228280"
  },
  {
    "text": "all by the way API calls which are no NOS per the",
    "start": "1228280",
    "end": "1233320"
  },
  {
    "text": "book uh writing secure code a required reading at Microsoft that's a quote from",
    "start": "1233320",
    "end": "1238880"
  },
  {
    "text": "Bill Gates it's on the cover of the book now this looks kind of bad right",
    "start": "1238880",
    "end": "1244240"
  },
  {
    "text": "there a big numbers here I'm about to show you something that's going to blow your socks off this is so",
    "start": "1244240",
    "end": "1250080"
  },
  {
    "text": "bad this is another leading database this one by the way is Unbreakable",
    "start": "1250080",
    "end": "1255810"
  },
  {
    "text": "[Applause]",
    "start": "1255810",
    "end": "1258990"
  },
  {
    "text": "I'm not going to say any more about that now let's say I had run an analysis",
    "start": "1260840",
    "end": "1266120"
  },
  {
    "text": "like this and I got uh some really good information now I actually want to use",
    "start": "1266120",
    "end": "1271760"
  },
  {
    "text": "it right off the bat here's something I can do right off the bat in my lab if I want to find an exploit I call this red",
    "start": "1271760",
    "end": "1277039"
  },
  {
    "text": "pointing I take all the break all the memory locations where I found a suspect location and I drop a break point on",
    "start": "1277039",
    "end": "1282799"
  },
  {
    "text": "them and I run the target I mean this is taking me five minutes and it's very simple to do it's obviously going to only catch a very low hand in Fruit so",
    "start": "1282799",
    "end": "1290000"
  },
  {
    "text": "um for this example I I downloaded a a proxy server like two days ago from from",
    "start": "1290000",
    "end": "1295440"
  },
  {
    "text": "Two Cows I know it's cheating you know it's but whatever so here in Oli debug I'm just hit Control G type an elster",
    "start": "1295440",
    "end": "1301480"
  },
  {
    "text": "copy a I'm going to set a breako right there very simple to do on the algro surf proxy server I I tell that in and I",
    "start": "1301480",
    "end": "1308080"
  },
  {
    "text": "say I want to connect to this host called foosball and what happens immediately boom I hit a breakpoint and",
    "start": "1308080",
    "end": "1313400"
  },
  {
    "text": "look at the little stack Trace there elster cop a you see it and my user Supply data is being used there",
    "start": "1313400",
    "end": "1319520"
  },
  {
    "text": "just like that okay now this tool that I just",
    "start": "1319520",
    "end": "1325120"
  },
  {
    "text": "showed you bug scan you can all use it for free go to this website if you were",
    "start": "1325120",
    "end": "1330200"
  },
  {
    "text": "at black hat and you can you know tell us who you are and stuff we'll give you a 60-day free use we have it online so",
    "start": "1330200",
    "end": "1336039"
  },
  {
    "text": "you can try it put anything you want in there see what you can find it's a lot of fun it's actually I'll warn you it's very addictive you'll be like oh I found",
    "start": "1336039",
    "end": "1342840"
  },
  {
    "text": "some problems in this that was pretty interesting um okay I'll try this other thing boy that's really bad I'll bet you",
    "start": "1342840",
    "end": "1348240"
  },
  {
    "text": "this other is a piece of too that a okay uh did everybody get a chance to",
    "start": "1348240",
    "end": "1355679"
  },
  {
    "text": "see that I it's in the printed materials I think so all right uh now let's talk about uh some more real world stuff with",
    "start": "1355679",
    "end": "1361679"
  },
  {
    "text": "what we're doing in the lab with our graybox things now all this technology we're releasing for free off the website as we polish it up now the reason why I",
    "start": "1361679",
    "end": "1369000"
  },
  {
    "text": "call it hard stuff is not mostly experts are just going to be the people to use",
    "start": "1369000",
    "end": "1374240"
  },
  {
    "text": "this these are people who have skills in runtime debugging they know what assembly looks like they know how to read assembly code uh they have",
    "start": "1374240",
    "end": "1381200"
  },
  {
    "text": "experience dealing with protocols and they have technical knowledge of what program programming bugs look like so",
    "start": "1381200",
    "end": "1387640"
  },
  {
    "text": "for most of you that means you've sat down and tried to find bugs in software before and you actually can get around",
    "start": "1387640",
    "end": "1393039"
  },
  {
    "text": "in there a little bit um so an example of how you might use this uh is a",
    "start": "1393039",
    "end": "1398320"
  },
  {
    "text": "parsing problem um I just since I was on proxy server page 2al I downloaded a couple of them and I found a problem in",
    "start": "1398320",
    "end": "1404440"
  },
  {
    "text": "a different one um so let's say we have a Target uh Sprint F and we want to see if we can get in there and we get into",
    "start": "1404440",
    "end": "1410600"
  },
  {
    "text": "Ida and we see a couple of locations here we see a branching decision being made based upon the result of a stirer",
    "start": "1410600",
    "end": "1416960"
  },
  {
    "text": "now if you note my little uh comment up there I happen to notice that the argument to stirer at runtime was being",
    "start": "1416960",
    "end": "1422679"
  },
  {
    "text": "pushed uh hex 23 which is a hash sign so I know that a hash sign controls whether",
    "start": "1422679",
    "end": "1427919"
  },
  {
    "text": "or not a branch here and so it was very easy for me once I did the runtime analysis and saw what the actual value",
    "start": "1427919",
    "end": "1434120"
  },
  {
    "text": "was so go down and actually for the pop three proxy here put a hash sign in",
    "start": "1434120",
    "end": "1439240"
  },
  {
    "text": "there okay very easy and I did actually then go down the branch and hit the",
    "start": "1439240",
    "end": "1444919"
  },
  {
    "text": "sprintf and look what happens both pieces let me show back I'll go back one here notice I have Hogan and then pound",
    "start": "1444919",
    "end": "1451480"
  },
  {
    "text": "sign and then my uh web address up there okay so going down here both of those",
    "start": "1451480",
    "end": "1456520"
  },
  {
    "text": "strings are getting pasted in with percent as with a sprintf here so and you can see the result the very top line",
    "start": "1456520",
    "end": "1462600"
  },
  {
    "text": "is actually the final string so obviously we can make overly large strings here as well now I have a code named Tempest",
    "start": "1462600",
    "end": "1470159"
  },
  {
    "text": "I've lately been known to come up with really horrible code names for things um Tempest being one of them considering",
    "start": "1470159",
    "end": "1475720"
  },
  {
    "text": "it's already used for something else uh so there's the website you can download some of this stuff um I've also created",
    "start": "1475720",
    "end": "1482840"
  },
  {
    "text": "two Source Forge projects uh for restart and speed break two other tools and",
    "start": "1482840",
    "end": "1488080"
  },
  {
    "text": "hopefully I'll do more Source Forge project projects as we get the stuff polished um so the whole point of this exercise is to connect your inputs with",
    "start": "1488080",
    "end": "1494399"
  },
  {
    "text": "the bugs user supplied input over here possible bug over here I want to make sure I can get the input all the way down over there um obviously they can",
    "start": "1494399",
    "end": "1500559"
  },
  {
    "text": "help you verify an exploit build a working exploit this is an offensive stance more importantly this goes back",
    "start": "1500559",
    "end": "1505960"
  },
  {
    "text": "to the workflow the stuff I'm working on is about a workflow and that helps you get more stuff done faster and helps you",
    "start": "1505960",
    "end": "1511120"
  },
  {
    "text": "scale up your operation so here's a screenshot of something from Tempest um this is a static analysis at this point",
    "start": "1511120",
    "end": "1516880"
  },
  {
    "text": "I haven't done any runtime analysis these are code locations that are branching down there where the see the",
    "start": "1516880",
    "end": "1522080"
  },
  {
    "text": "red around the uh the square that's a Sprint F call and then up above it are all the code locations as far as control",
    "start": "1522080",
    "end": "1528720"
  },
  {
    "text": "flow is concerned that lead up to the sprinf possibly now what I'll do is I'll paint",
    "start": "1528720",
    "end": "1535000"
  },
  {
    "text": "those locations as I instrument the Target and run with it now my eventual goal is to have this",
    "start": "1535000",
    "end": "1540799"
  },
  {
    "text": "be self-learning if I see a branching location a branch decision based upon user data I'd like to be able to stop",
    "start": "1540799",
    "end": "1547000"
  },
  {
    "text": "the program change the value and rerun it from that point forward so we actually started doing that we have a",
    "start": "1547000",
    "end": "1552440"
  },
  {
    "text": "program called restart and that's one of them that's on Source Forge it is the coolest thing you've ever seen we can freeze a program we can read all the",
    "start": "1552440",
    "end": "1559240"
  },
  {
    "text": "process memory store it off and then as it turns out if you restore that process",
    "start": "1559240",
    "end": "1564760"
  },
  {
    "text": "memory at any time in the future it restores the program back to its original state I actually ran it on",
    "start": "1564760",
    "end": "1569799"
  },
  {
    "text": "Winamp so I have this really cool techno stream going I freeze it in speed or in uh and restart and then I let it go",
    "start": "1569799",
    "end": "1576640"
  },
  {
    "text": "again so it's going and then like hit hit restart and it's like resetting itself over and over again so I'm like",
    "start": "1576640",
    "end": "1583520"
  },
  {
    "text": "remixing I'm not gray boxing I'm beat boxing",
    "start": "1583520",
    "end": "1588720"
  },
  {
    "text": "Keith made me do that okay um so how do we actually measure the code locations if we uh",
    "start": "1592279",
    "end": "1599919"
  },
  {
    "text": "while we're running so we take each of the code locations and set a break point at the top this was a trick that helar gave me uh about two years ago and I've",
    "start": "1599919",
    "end": "1607360"
  },
  {
    "text": "been using it it's very nice so we just set a insert a cc for x86 in here and we have a break",
    "start": "1607360",
    "end": "1613799"
  },
  {
    "text": "point and then this is what I was just describing the process snapshots so we have actually read using V virtual query",
    "start": "1613799",
    "end": "1620360"
  },
  {
    "text": "ex and there's a variety of flags that have to be set and you'll see them listed on the side there and we go through the whole process space from",
    "start": "1620360",
    "end": "1626039"
  },
  {
    "text": "zero to top and we grab anything we can and save it off um so moving on uh",
    "start": "1626039",
    "end": "1631720"
  },
  {
    "text": "flybys and drill Downs that's that's what we're going to get when we start using this technology we'll see that we hit a code block above a potential",
    "start": "1631720",
    "end": "1638159"
  },
  {
    "text": "location that's a flyby we want to hit it so that's the drill",
    "start": "1638159",
    "end": "1643360"
  },
  {
    "text": "down now for a code FL for tracing the data you can see here I've selected uh my color scheme's a little weird but I",
    "start": "1643360",
    "end": "1649559"
  },
  {
    "text": "selected the block on the bottom and I can see everywhere where it branches to and that's kind of neat uh the graphs",
    "start": "1649559",
    "end": "1655440"
  },
  {
    "text": "can get a little complicated uh here's a better example actually trillian IRC dll I have assigned to unsign mismatch on",
    "start": "1655440",
    "end": "1661360"
  },
  {
    "text": "the bottom and up on top I've selected it and this is actually you can tell right off the bat for me using this I",
    "start": "1661360",
    "end": "1666559"
  },
  {
    "text": "can tell that's a switch statement all those locations are all the cases of the switch statement and so I select it and I can see which items on the case",
    "start": "1666559",
    "end": "1673200"
  },
  {
    "text": "statement are going to lead down to the sign to unsign mismatch now here's another trick that I",
    "start": "1673200",
    "end": "1678480"
  },
  {
    "text": "uh came up with that we've been using Boron tagging uh let's say that we don't want to actually single step Trace from",
    "start": "1678480",
    "end": "1683519"
  },
  {
    "text": "a wsa receive from all the way through the code rather uh we just pick a string",
    "start": "1683519",
    "end": "1689360"
  },
  {
    "text": "let's say it's root kit or something and we type that into our request that we're sending to the client great goes in let",
    "start": "1689360",
    "end": "1696519"
  },
  {
    "text": "it process stop break into Oli debug scan memory Oli dbug has a great memory",
    "start": "1696519",
    "end": "1702440"
  },
  {
    "text": "scanning memory search function scan all the way through memory find the locations that still have that string in",
    "start": "1702440",
    "end": "1708000"
  },
  {
    "text": "it that you just typed in you can do the same thing with soft ice um if you do a search by the way for like let's say",
    "start": "1708000",
    "end": "1714840"
  },
  {
    "text": "root kit put in something like rootkit 666 because sometimes you'll hit the location that you that just took your",
    "start": "1714840",
    "end": "1720960"
  },
  {
    "text": "command you don't want it you know you want to tell the difference so anyways uh you'll scan through you set a break point on those memory locations and the",
    "start": "1720960",
    "end": "1727080"
  },
  {
    "text": "next time they're read from or written to you get a break point and you're right in the code that's dealing with us as a supplied data it works really well",
    "start": "1727080",
    "end": "1733760"
  },
  {
    "text": "unfortunately it doesn't work all the time uh one of the times where it wouldn't work is if that memory is cleared shortly after you run the",
    "start": "1733760",
    "end": "1740640"
  },
  {
    "text": "request and that does happen occasionally um other times it may be different memory altogether just being",
    "start": "1740640",
    "end": "1745720"
  },
  {
    "text": "used so you don't hit the break point um so here's kind of how it would",
    "start": "1745720",
    "end": "1751120"
  },
  {
    "text": "work let's say we're going to Leap Frog uh every single time the memories written to or read from for the for the",
    "start": "1751120",
    "end": "1757039"
  },
  {
    "text": "boring tag was we're going to Leap Frog we're just going to we're going to see each location and then just let it run again Leap Frog to the next time it does",
    "start": "1757039",
    "end": "1763640"
  },
  {
    "text": "it and then the next time that it does it and so forth we're going to end up with these little call these little question ERS of code graph they won't be",
    "start": "1763640",
    "end": "1770440"
  },
  {
    "text": "connected but that's okay so there's a call to receive writes memory out",
    "start": "1770440",
    "end": "1775840"
  },
  {
    "text": "here now we change the page protection on this page of memory so it'll cause an",
    "start": "1775840",
    "end": "1781279"
  },
  {
    "text": "exception whenever there's any read or write event to it and then any single time we have any event against this",
    "start": "1781279",
    "end": "1787320"
  },
  {
    "text": "particular location we can cross reference against the address and the length of the buffer and determine if it's against our user suppli",
    "start": "1787320",
    "end": "1795600"
  },
  {
    "text": "data so that's on tagging um unfortunately with oie you can only set",
    "start": "1796480",
    "end": "1802200"
  },
  {
    "text": "one at a time and so I'm working on a tool to to put like multiples in",
    "start": "1802200",
    "end": "1807279"
  },
  {
    "text": "there uh the next big goal by the way is data flow analysis uh I don't have a",
    "start": "1807279",
    "end": "1812720"
  },
  {
    "text": "really good tool yet so there's nothing released on this but the idea behind data flow analysis is obviously I can be",
    "start": "1812720",
    "end": "1818200"
  },
  {
    "text": "with the tools I already showed you I can detect when someone reads a piece of memory or writes to it so by that token I should be able to follow that memory",
    "start": "1818200",
    "end": "1824679"
  },
  {
    "text": "as it propagates Forward there should not be any point in the control flow where I wouldn't be able to determine if",
    "start": "1824679",
    "end": "1830440"
  },
  {
    "text": "the data flow if the data in question is been moved somewhere else or copied or any of that so I should be able to roll",
    "start": "1830440",
    "end": "1836399"
  },
  {
    "text": "all the way forward and do complete data flow analysis at runtime here is a prototype for that I actually wrote some",
    "start": "1836399",
    "end": "1842440"
  },
  {
    "text": "code here shortly before I gave the RSA version of this presentation U this is a real data flow using that kind of",
    "start": "1842440",
    "end": "1849360"
  },
  {
    "text": "concept I just showed you here uh on the left hand side are registers and on the right hand side is either stack or heat",
    "start": "1849360",
    "end": "1854840"
  },
  {
    "text": "memory and I'm actually tracing I use a supply piece of data forward now",
    "start": "1854840",
    "end": "1860440"
  },
  {
    "text": "unfortunately you see how it goes off the bottom of the screen it goes off the bottom of the screen like to China so",
    "start": "1860440",
    "end": "1866559"
  },
  {
    "text": "that's a problem that still needs to be solved uh now talking about these kinds of things graphing can be a problem too",
    "start": "1866559",
    "end": "1873320"
  },
  {
    "text": "I showed you some cool graphs but to be honest I searched for some really pretty ones most of my graphs right now are",
    "start": "1873320",
    "end": "1878639"
  },
  {
    "text": "ugly as Sin there's millions of things just pasted on top of each other and so that's still a problem I'm trying to",
    "start": "1878639",
    "end": "1884880"
  },
  {
    "text": "solve graph complexity is a is a hard problem um so I've come up with a couple things I was playing around with",
    "start": "1884880",
    "end": "1890279"
  },
  {
    "text": "hyperbolic trees is one of them this is actually all the locations in an FTP server that I have uh leading up to a",
    "start": "1890279",
    "end": "1896320"
  },
  {
    "text": "possibly vulnerable Sprint de location you can grab this globe it's rendered an openg and turn it it's really cool but",
    "start": "1896320",
    "end": "1902880"
  },
  {
    "text": "the thing is it's like what happens if you have something that's a little bit more complex than this don't make the mistake of thinking hyperbolic graphing",
    "start": "1902880",
    "end": "1908120"
  },
  {
    "text": "is going to solve every possible control flow in a application it looks pretty my friends but it's completely",
    "start": "1908120",
    "end": "1916320"
  },
  {
    "text": "useless oops sorry uh you can download this tool it's called walrus off of the address listed",
    "start": "1916440",
    "end": "1924799"
  },
  {
    "text": "there now um in terms of getting rid of extra stuff in the data set obviously we want to filter out stuff we don't care",
    "start": "1924799",
    "end": "1930159"
  },
  {
    "text": "about let's not look at Sprint up so that don't contain a percent s in them uh if the off off by one error that we",
    "start": "1930159",
    "end": "1935519"
  },
  {
    "text": "detected is smaller than the stack size we're dealing with and we know that we obviously aren't going to look at it so we're just talking about we just got to have good filters to get past a lot of",
    "start": "1935519",
    "end": "1941639"
  },
  {
    "text": "the stuff up front um so I'm going to reiterate some of the things I just showed you uh how",
    "start": "1941639",
    "end": "1946840"
  },
  {
    "text": "the process would work work the first thing we'll do is ID locations in the code using static analysis and perform",
    "start": "1946840",
    "end": "1953480"
  },
  {
    "text": "static traces you can see that data there then we'll fuzz the inputs while",
    "start": "1953480",
    "end": "1960760"
  },
  {
    "text": "measuring instrumenting the Target and here I'm painting every Square that's painted gray I've visited using that's",
    "start": "1960760",
    "end": "1966880"
  },
  {
    "text": "the breakpoint trick and so my goal is to get down to the location and you can see I actually hit it",
    "start": "1966880",
    "end": "1973159"
  },
  {
    "text": "there this is really cool this is part of temp vest all the potential vulner locations are listed on the left there",
    "start": "1973159",
    "end": "1980480"
  },
  {
    "text": "in this UI and I can actually assign each of these to an engineer it actually",
    "start": "1980480",
    "end": "1985519"
  },
  {
    "text": "has like a problem tracking system built into it so I can I believe me when you do this you'll have like the previous",
    "start": "1985519",
    "end": "1991799"
  },
  {
    "text": "example uh 2,900 and some odd locations you want to analyze forget it if you",
    "start": "1991799",
    "end": "1996919"
  },
  {
    "text": "don't have a tool like this to tell you where you are in the whole thing you're going to get totally swamped you're going to get disheartened you know how",
    "start": "1996919",
    "end": "2002120"
  },
  {
    "text": "much work do I have left to do and that can be the killer so here you know I can assign a hundred of these things to one",
    "start": "2002120",
    "end": "2007440"
  },
  {
    "text": "guy 100 to another guy and they can actually set values on there like uh it's assigned uh location not uh",
    "start": "2007440",
    "end": "2013840"
  },
  {
    "text": "exploitable location visited unknown if exploitable and so forth and you can close out each of these potential",
    "start": "2013840",
    "end": "2019960"
  },
  {
    "text": "locations over time that's so valuable it's more valuable than having the the OD day",
    "start": "2019960",
    "end": "2025880"
  },
  {
    "text": "okay um now here's an example of something uh in the last talk where I actually using Tempest was able to find",
    "start": "2025880",
    "end": "2032559"
  },
  {
    "text": "a bug really fast so there's an FTP server called Black Moon the previous",
    "start": "2032559",
    "end": "2038159"
  },
  {
    "text": "talk I didn't say who the vendor was here but it's one of those two cows programs so I don't really care um the",
    "start": "2038159",
    "end": "2044559"
  },
  {
    "text": "authentic pre-authentication I just just enter your username all right so I put in my username and I'm seeing in in temp",
    "start": "2044559",
    "end": "2053079"
  },
  {
    "text": "pass a runtime sampling of the data as it's going past I immediately see these select statements that have my username",
    "start": "2053079",
    "end": "2058599"
  },
  {
    "text": "in them or using a database to tell if you're you know obviously a correct user",
    "start": "2058599",
    "end": "2063638"
  },
  {
    "text": "and so I think this is a really funny example because it's SQL injection attack but some something that's not the",
    "start": "2063639",
    "end": "2069760"
  },
  {
    "text": "web this is so cool I mean this is gry box working for you it took me no time at all to find this",
    "start": "2069760",
    "end": "2075200"
  },
  {
    "text": "problem so were there any faults okay if there are faults or things that are",
    "start": "2075200",
    "end": "2080560"
  },
  {
    "text": "interesting we can annotate that particular line so that one maybe is assigned to my engineer John and John",
    "start": "2080560",
    "end": "2085960"
  },
  {
    "text": "writes in there that you know hey look it looks like there's a select statement blah blah blah and now you can leave that alone and keep working and we can",
    "start": "2085960",
    "end": "2092480"
  },
  {
    "text": "come back to it so annotations are very helpful now this is step two how many of",
    "start": "2092480",
    "end": "2099160"
  },
  {
    "text": "the branches remain unresolved so in this graph I've colored it differently orange",
    "start": "2099160",
    "end": "2106680"
  },
  {
    "text": "locations are conditional branches where we've only exercised one side of the",
    "start": "2106680",
    "end": "2111960"
  },
  {
    "text": "branch jump if not equal only one side went this way so we know that potentially we can increase our code",
    "start": "2111960",
    "end": "2117720"
  },
  {
    "text": "coverage here at this point so we can go look at the Assembly Language at that point and determine how it is that it's",
    "start": "2117720",
    "end": "2123720"
  },
  {
    "text": "making that decision is it making it on a compare against user Supply data if so we can control that and we can increase",
    "start": "2123720",
    "end": "2129560"
  },
  {
    "text": "our code coverage um in this particular example if the locations are surrounded in green uh user Supply data is actually",
    "start": "2129560",
    "end": "2136240"
  },
  {
    "text": "being used in that in that particular location of code so our data flow analysis is it",
    "start": "2136240",
    "end": "2144160"
  },
  {
    "text": "user control blah blah blah modifier our input fuzzer to compensate for that problem that's the self- learning code",
    "start": "2144160",
    "end": "2149200"
  },
  {
    "text": "coverage I just talked about so in this example here I would go to the nearest flyby that's the grade out location up",
    "start": "2149200",
    "end": "2155400"
  },
  {
    "text": "above and I attempt a drill down based upon user of Supply data and watching what's happening and make forcing the",
    "start": "2155400",
    "end": "2161520"
  },
  {
    "text": "branching to continue down that tree not all control flows as identified by Ida are going to be even",
    "start": "2161520",
    "end": "2168040"
  },
  {
    "text": "exercisable sometimes there's just things that will never happen because there's some Global state or something that's being checked you can't control",
    "start": "2168040",
    "end": "2174079"
  },
  {
    "text": "it from a user supplied variable maybe it's a configuration setting that changes the way that works anyways",
    "start": "2174079",
    "end": "2180200"
  },
  {
    "text": "enough said about that um so I've ripped through this hope we have a hope I didn't finish too early",
    "start": "2180200",
    "end": "2187800"
  },
  {
    "text": "um the conclusion of this is that there's a process by which you can connect user supplied input with the",
    "start": "2187800",
    "end": "2193880"
  },
  {
    "text": "Target locations in the code you can trace your data and control flow at runtime to do this and you can tune your",
    "start": "2193880",
    "end": "2199000"
  },
  {
    "text": "fuzzer to increase your code coverage um only a certain percentage of the bugs that you attempt to do this with are",
    "start": "2199000",
    "end": "2204160"
  },
  {
    "text": "actually going to be exploitable of course in fact it's a very small percentage uh there's my website where you can get both bug scan and some of",
    "start": "2204160",
    "end": "2210400"
  },
  {
    "text": "the tools I've been talking about and here's dve Vel site for Spike uh you can go download that as",
    "start": "2210400",
    "end": "2216200"
  },
  {
    "text": "well the best stuff is something we're just using internally it's not a commercial product um so don't call us",
    "start": "2216200",
    "end": "2222880"
  },
  {
    "text": "for tech support thank you very much um I take some",
    "start": "2222880",
    "end": "2229800"
  },
  {
    "text": "questions yes sir the restart only available in",
    "start": "2231480",
    "end": "2238160"
  },
  {
    "text": "Windows uh the question is is the restart program only available in Windows the one that I have written is",
    "start": "2238160",
    "end": "2244560"
  },
  {
    "text": "only for Windows but the concept of how it works is equally applicable to any other like Linux for example",
    "start": "2244560",
    "end": "2252119"
  },
  {
    "text": "um I'm not familiar with that anybody",
    "start": "2252119",
    "end": "2259160"
  },
  {
    "text": "else yes sir you think there's any chance",
    "start": "2259440",
    "end": "2265040"
  },
  {
    "text": "that do you mean the same algorithms or the tools they're actually using the",
    "start": "2273880",
    "end": "2279040"
  },
  {
    "text": "AL um the question the question was if I got it right um would the algorithms being used in Hardware testing be",
    "start": "2279040",
    "end": "2285599"
  },
  {
    "text": "applicable here um and I think that I think there's a lot of Prior work in",
    "start": "2285599",
    "end": "2290760"
  },
  {
    "text": "this area that I myself haven't even had the chance to research um I've just started on this stuff I uh think that",
    "start": "2290760",
    "end": "2296480"
  },
  {
    "text": "anything in the testing Arena that from an algorithm point of view especially with hardware and stuff like that would probably be valuable maybe to be",
    "start": "2296480",
    "end": "2302160"
  },
  {
    "text": "integrated here it depends I mean some of this stuff is just so weird that you run into and it's hard to say anything",
    "start": "2302160",
    "end": "2307880"
  },
  {
    "text": "about it up ahead of time until you actually see it you know what I mean yes",
    "start": "2307880",
    "end": "2314559"
  },
  {
    "text": "sir um okay so the question was well variations in the way memory might",
    "start": "2324760",
    "end": "2332200"
  },
  {
    "text": "be allocated or such where a DLo may be remapped to going to cause any problems with multiple runs um I'm not",
    "start": "2332200",
    "end": "2340640"
  },
  {
    "text": "correlating multiple runs currently so I haven't had a chance to run into that problem uh I will say that with with oi",
    "start": "2340640",
    "end": "2347480"
  },
  {
    "text": "debug uh it doesn't have any problem finding it even if it's been rebased so you're not going to run into it as a",
    "start": "2347480",
    "end": "2352640"
  },
  {
    "text": "problem for finding a breakpoints to begin with however if you collect the break points and you store them off as",
    "start": "2352640",
    "end": "2358599"
  },
  {
    "text": "addresses and then just restore those addresses you most certainly would run into a problem if it was rebased the",
    "start": "2358599",
    "end": "2363880"
  },
  {
    "text": "break points would end up in the wrong locations",
    "start": "2363880",
    "end": "2368079"
  },
  {
    "text": "anybody else yes sir the question is how does restart",
    "start": "2369319",
    "end": "2375480"
  },
  {
    "text": "deal with open file handles and and whatnot um I'll restate the question as how would restart deal with any external",
    "start": "2375480",
    "end": "2381800"
  },
  {
    "text": "data outside of the problem it doesn't it doesn't and that's obviously a problem uh you could try snapshotting",
    "start": "2381800",
    "end": "2388839"
  },
  {
    "text": "other things but at some point it just becomes a real hard problem to try to capture the state in the system as it gets too big",
    "start": "2388839",
    "end": "2397000"
  },
  {
    "text": "anybody else yes sir you sold many exploits have I sold many exploits I cannot comment on any of that work I'm",
    "start": "2397440",
    "end": "2405040"
  },
  {
    "text": "sorry anybody else oh sorry",
    "start": "2405040",
    "end": "2412400"
  },
  {
    "text": "podiums",
    "start": "2414319",
    "end": "2417319"
  },
  {
    "text": "yes the middle that has visit links to the around it how did",
    "start": "2423520",
    "end": "2431440"
  },
  {
    "text": "that um okay so let's say uh the question is there's a control flow that's mapped and I've got gray down",
    "start": "2431440",
    "end": "2437960"
  },
  {
    "text": "below and gray up above and a white in the middle which means not visited uh the answer to that is that's some sort",
    "start": "2437960",
    "end": "2444040"
  },
  {
    "text": "of bug in Tempest it most certainly should visit that location on its way down there um",
    "start": "2444040",
    "end": "2449920"
  },
  {
    "text": "the it's it may not be a bug in Tempest it may just simply be the initial white box analysis didn't resolve that control",
    "start": "2449920",
    "end": "2455400"
  },
  {
    "text": "branch and so it was never a to be graphed to begin with um there is a way to fix that is to is to map additional",
    "start": "2455400",
    "end": "2461720"
  },
  {
    "text": "control flow at runtime now the current way that Tempest is implemented is it takes the control FL flow from the",
    "start": "2461720",
    "end": "2467400"
  },
  {
    "text": "static analysis and just augments that data set doesn't add additional branches on the Fly I think that would solve the",
    "start": "2467400",
    "end": "2474920"
  },
  {
    "text": "problem you had a yes sir the",
    "start": "2475200",
    "end": "2480839"
  },
  {
    "text": "accy least for the HS um what are the accuracy rates for bug scan um well if bug scan says that",
    "start": "2480839",
    "end": "2487599"
  },
  {
    "text": "there's a location there that matches one of our schematic patterns then it's 100% accurate um but of course buan is",
    "start": "2487599",
    "end": "2494359"
  },
  {
    "text": "not going to be able to tell you if user Supply data is being used in that location and it's certainly not going to be able to tell you if it's exploitable",
    "start": "2494359",
    "end": "2501200"
  },
  {
    "text": "uh but it's going to tell you a lot more than you would know without having to get into a like an Ida disassembler or something just on your own and because",
    "start": "2501200",
    "end": "2508280"
  },
  {
    "text": "you can submit files to it in huge batches and queue them up you can get a lot of work done overnight and come in in the morning and sort through a big",
    "start": "2508280",
    "end": "2513319"
  },
  {
    "text": "pile of reports and do something fun with that sir you had a question",
    "start": "2513319",
    "end": "2519240"
  },
  {
    "text": "U the question is have have we run against encrypted binaries um to this at this point in time I haven't tried to",
    "start": "2524599",
    "end": "2529760"
  },
  {
    "text": "use uh any of the runtime stuff against uh code that is self decrypting now I think that's an interesting question",
    "start": "2529760",
    "end": "2535960"
  },
  {
    "text": "because I think runtime analysis would be the only situation where you'd even be able to get a handle on something like that so it would obviously be a",
    "start": "2535960",
    "end": "2542119"
  },
  {
    "text": "really hard challenge but you're obviously not going to get anywhere with it from a static analysis point of view unless you have some magic plugin that",
    "start": "2542119",
    "end": "2547880"
  },
  {
    "text": "knows how to reverse the trick that's being performed there yes Ryan okay",
    "start": "2547880",
    "end": "2555720"
  },
  {
    "text": "com right okay so Ryan's pointing out a very common method to deal with this problem is you get it to an unpacked",
    "start": "2562599",
    "end": "2567640"
  },
  {
    "text": "State prior to doing the the analysis and there's tools out there for many of the Packers there's many unpackers you",
    "start": "2567640",
    "end": "2573839"
  },
  {
    "text": "just got to find one that works yes sir",
    "start": "2573839",
    "end": "2578720"
  },
  {
    "text": "oh absolutely not um so the question was uh what kinds of uh binary files will",
    "start": "2587720",
    "end": "2592800"
  },
  {
    "text": "bugs can support and if something comes up from the demo account would we report anything based on that absolutely not we",
    "start": "2592800",
    "end": "2598520"
  },
  {
    "text": "would never report anything based on that um the the analysis uh bug skan",
    "start": "2598520",
    "end": "2603800"
  },
  {
    "text": "engine can deal with a lot of different Hardware platforms but current currently in the marketing literature we're only",
    "start": "2603800",
    "end": "2608880"
  },
  {
    "text": "saying CN C++ code written for uh Linux and windows now CN C++ code is even a",
    "start": "2608880",
    "end": "2615680"
  },
  {
    "text": "little bit misleading because we're not analyzing source code we're analyzing binaries but the patterns we're looking for are based on libc and other things",
    "start": "2615680",
    "end": "2621359"
  },
  {
    "text": "that would be used if you were using a c compiler so at this point C and C++ Linux",
    "start": "2621359",
    "end": "2627880"
  },
  {
    "text": "Windows you can throw elf in there you can throw uh spark code you can throw AIS code in there you can do all kinds",
    "start": "2629200",
    "end": "2634480"
  },
  {
    "text": "of things we just don't make any promises about what you'll find that's not currently supported but it'll actually create a report you can see",
    "start": "2634480",
    "end": "2640240"
  },
  {
    "text": "what it looks like yes",
    "start": "2640240",
    "end": "2644920"
  },
  {
    "text": "sir so the question is what do the schematics for bug scam look like um boy I wish my product guy Matt was up here",
    "start": "2649839",
    "end": "2656160"
  },
  {
    "text": "now um first of all look for uh imported function calls that are known to be uh",
    "start": "2656160",
    "end": "2662640"
  },
  {
    "text": "poor programming practice and it will look at the arguments pass to the call so let's say it's a s printf and it'll",
    "start": "2662640",
    "end": "2669680"
  },
  {
    "text": "look to see for example if the first argument is a hardcoded offset to the file or is it something that's given",
    "start": "2669680",
    "end": "2676200"
  },
  {
    "text": "from outside the function if it's given from outside the function it's a possible uh format string problem there",
    "start": "2676200",
    "end": "2681319"
  },
  {
    "text": "right so I'll do that kind of analysis it will do control flow analysis back from the location about 64 levels and",
    "start": "2681319",
    "end": "2689800"
  },
  {
    "text": "stop and it'll try to cross reference to see if any user Supply data may be used in the same area but it's not going to",
    "start": "2689800",
    "end": "2695520"
  },
  {
    "text": "do data flow analysis step by step all the way down from them receive for example so that's just that'll increase",
    "start": "2695520",
    "end": "2701920"
  },
  {
    "text": "the chances that you have a problem but it's again not going to say 100% certain whether or not you actually have an exploit on your",
    "start": "2701920",
    "end": "2708640"
  },
  {
    "text": "hands okay so the question is how would you add a rule definition it's very simple um there all there's a series of",
    "start": "2712280",
    "end": "2717599"
  },
  {
    "text": "text files that you modify and in there there a number of different fields that you can set it'll help control this the",
    "start": "2717599",
    "end": "2722839"
  },
  {
    "text": "static analysis anybody else yes sir",
    "start": "2722839",
    "end": "2730880"
  },
  {
    "text": "com.com uh what's been going on with rick.com uh other than it's always up and down like a",
    "start": "2730880",
    "end": "2735960"
  },
  {
    "text": "yo-yo just in terms of what you're working on well I gave a really good class um on rits here at black hat at",
    "start": "2735960",
    "end": "2742359"
  },
  {
    "text": "the beginning of the week and we covered some really neat technology uh how to hide processes using uh EO structures",
    "start": "2742359",
    "end": "2748720"
  },
  {
    "text": "rather than system call hooks um but if you attended the class on detecting root kits uh I haven't met that fell yet I",
    "start": "2748720",
    "end": "2755920"
  },
  {
    "text": "hope to have drinks with him tonight um he actually knows about that trick and and address that in his talk um there's",
    "start": "2755920",
    "end": "2764040"
  },
  {
    "text": "I'll just say this there's other ways to get around all the stuff that he talked about and I'm not going to talk to anybody about that those are not going",
    "start": "2764040",
    "end": "2770240"
  },
  {
    "text": "to be released any more",
    "start": "2770240",
    "end": "2777920"
  },
  {
    "text": "questions all right thanks [Applause]",
    "start": "2778520",
    "end": "2785920"
  },
  {
    "text": "guys",
    "start": "2785920",
    "end": "2788920"
  },
  {
    "text": "e",
    "start": "2815839",
    "end": "2818839"
  },
  {
    "text": "e",
    "start": "2845839",
    "end": "2848839"
  },
  {
    "text": "e",
    "start": "2875839",
    "end": "2878839"
  },
  {
    "text": "e",
    "start": "2905760",
    "end": "2908760"
  },
  {
    "text": "e",
    "start": "2935720",
    "end": "2938720"
  },
  {
    "text": "e",
    "start": "2965720",
    "end": "2968720"
  },
  {
    "text": "e",
    "start": "2995640",
    "end": "2998640"
  },
  {
    "text": "e",
    "start": "3025640",
    "end": "3028640"
  },
  {
    "text": "e",
    "start": "3055640",
    "end": "3058640"
  },
  {
    "text": "e",
    "start": "3085559",
    "end": "3088559"
  },
  {
    "text": "e",
    "start": "3115520",
    "end": "3118520"
  },
  {
    "text": "e",
    "start": "3145520",
    "end": "3148520"
  },
  {
    "text": "e",
    "start": "3175440",
    "end": "3178440"
  },
  {
    "text": "e e",
    "start": "3205440",
    "end": "3209480"
  },
  {
    "text": "e",
    "start": "3295319",
    "end": "3298319"
  },
  {
    "text": "e",
    "start": "3325319",
    "end": "3328319"
  },
  {
    "text": "e",
    "start": "3355240",
    "end": "3358240"
  },
  {
    "text": "e",
    "start": "3385240",
    "end": "3388240"
  },
  {
    "text": "e",
    "start": "3415240",
    "end": "3418240"
  },
  {
    "text": "e",
    "start": "3445160",
    "end": "3448160"
  },
  {
    "text": "e",
    "start": "3475119",
    "end": "3478119"
  },
  {
    "text": "e",
    "start": "3505119",
    "end": "3508119"
  },
  {
    "text": "e",
    "start": "3535039",
    "end": "3538039"
  },
  {
    "text": "e",
    "start": "3565039",
    "end": "3568039"
  },
  {
    "text": "e",
    "start": "3595039",
    "end": "3598039"
  },
  {
    "text": "e",
    "start": "3624960",
    "end": "3627960"
  },
  {
    "text": "e",
    "start": "3654920",
    "end": "3657920"
  },
  {
    "text": "e",
    "start": "3684920",
    "end": "3687920"
  },
  {
    "text": "e",
    "start": "3714839",
    "end": "3717839"
  },
  {
    "text": "e e",
    "start": "3744839",
    "end": "3748880"
  }
]