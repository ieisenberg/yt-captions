[
  {
    "start": "0",
    "end": "63000"
  },
  {
    "text": "the session is bad USB your speakers are going to be Jacob Lel and Carsten",
    "start": "160",
    "end": "8560"
  },
  {
    "text": "Null a very good morning um thank you all for coming out this early i hope you all had a great Las Vegas night and are",
    "start": "15720",
    "end": "23199"
  },
  {
    "text": "ready for some hacking fun in the morning um we're here to present a new",
    "start": "23199",
    "end": "28240"
  },
  {
    "text": "class of attacks one that originates at USB devices and attacks computers and",
    "start": "28240",
    "end": "33680"
  },
  {
    "text": "the like um here was Jakob uh we're both working at a hacking lab in Berlin um",
    "start": "33680",
    "end": "40320"
  },
  {
    "text": "where our focus is typically not computer security but embedded security in fact this is the first time that we",
    "start": "40320",
    "end": "46000"
  },
  {
    "text": "ever looked at computer security and naturally we took an embedded angle that",
    "start": "46000",
    "end": "51280"
  },
  {
    "text": "is um looking at embedded processors living in USB devices and thinking about",
    "start": "51280",
    "end": "57680"
  },
  {
    "text": "how those could be repurposed um in malicious ways um before getting into",
    "start": "57680",
    "end": "64239"
  },
  {
    "start": "63000",
    "end": "174000"
  },
  {
    "text": "the details let's start with the first demo just so you have an idea of of what",
    "start": "64239",
    "end": "69760"
  },
  {
    "text": "we're all going to be talking about and especially what we're not going to talk about so standard USB thumb drive um",
    "start": "69760",
    "end": "78159"
  },
  {
    "text": "standard Windows computer plug that in here um should show up as a new disc",
    "start": "78159",
    "end": "84640"
  },
  {
    "text": "empty disc as empty as it gets you can even um reformat it so this there's",
    "start": "84640",
    "end": "90159"
  },
  {
    "text": "nothing on this disc so this isn't a talk about viruses on USB flash drives",
    "start": "90159",
    "end": "96560"
  },
  {
    "text": "in the storage partition all right um we will see in a couple of second what this",
    "start": "96560",
    "end": "101600"
  },
  {
    "text": "talk is about",
    "start": "101600",
    "end": "105240"
  },
  {
    "text": "let me say another thing what this is not about this is not exploiting a Windows software vulnerability that",
    "start": "112799",
    "end": "117920"
  },
  {
    "text": "could be patched so this is not research on on USB software stacks on Windows or",
    "start": "117920",
    "end": "123600"
  },
  {
    "text": "any other operating system here you just saw what what this talk is about this USB device turning into a different USB",
    "start": "123600",
    "end": "130560"
  },
  {
    "text": "device in this case a keyboard device and exploiting this computer what this did in this split second that you saw um",
    "start": "130560",
    "end": "138239"
  },
  {
    "text": "downloaded um through PowerShell a um metap remote shell and now this computer",
    "start": "138239",
    "end": "144080"
  },
  {
    "text": "is remote controlled and um the sky's is the limit as to what a remote attacker",
    "start": "144080",
    "end": "149440"
  },
  {
    "text": "can do now but uh we're not focused uh in this talk on what you can do once the virus is installed on a computer uh",
    "start": "149440",
    "end": "156239"
  },
  {
    "text": "we're focused on deploying the virus onto the computer and that is what just happened a USB stick uh deployed the",
    "start": "156239",
    "end": "163840"
  },
  {
    "text": "virus onto a computer even though uh with any traditional defense method like",
    "start": "163840",
    "end": "169120"
  },
  {
    "text": "virus scanning um the files on on the stick clearly would not have found this",
    "start": "169120",
    "end": "174599"
  },
  {
    "start": "174000",
    "end": "258000"
  },
  {
    "text": "um so before going into into further uh tech scenarios um let's clear out a",
    "start": "174599",
    "end": "180959"
  },
  {
    "text": "couple of of basics of the USB technology um get a feel for for how",
    "start": "180959",
    "end": "186319"
  },
  {
    "text": "these devices are supposed to work what the what levels of freedom the standard uh gives them um and then um look into",
    "start": "186319",
    "end": "194800"
  },
  {
    "text": "how we can change the behavior through reprogrammed peripherals um and then we'll look at a couple more attack",
    "start": "194800",
    "end": "201480"
  },
  {
    "text": "scenarios um USB very popular technology um couple basics",
    "start": "201480",
    "end": "207959"
  },
  {
    "text": "um most if not every USB uh connected peripheral has a controller chip this is",
    "start": "207959",
    "end": "215200"
  },
  {
    "text": "a chip that you would never have interacted with because if for instance you're interacting with a USB thumb",
    "start": "215200",
    "end": "221120"
  },
  {
    "text": "drive you're interacting with a flash drive which stores uh files for you um",
    "start": "221120",
    "end": "226799"
  },
  {
    "text": "that same flash drive stores a firmware which is executed in a small processor",
    "start": "226799",
    "end": "231840"
  },
  {
    "text": "on the chip so this all happens magically when you plug in the stick uh",
    "start": "231840",
    "end": "237040"
  },
  {
    "text": "and you nor neither you nor the operating system will ever see what's happening on this chip it is what talks",
    "start": "237040",
    "end": "243680"
  },
  {
    "text": "USB right the NAND flash chip obviously cannot speak USB out of the box this is",
    "start": "243680",
    "end": "250239"
  },
  {
    "text": "the chip brokering and this is the chip uh or the type of chip we want to focus",
    "start": "250239",
    "end": "256239"
  },
  {
    "text": "on in this presentation so uh these chips they are um identifiable through a",
    "start": "256239",
    "end": "263120"
  },
  {
    "start": "258000",
    "end": "389000"
  },
  {
    "text": "number of different um different methods uh first of all um they are telling the",
    "start": "263120",
    "end": "269280"
  },
  {
    "text": "computer what functions they're offering um for instance the the one that I just plugged in at first it said it's a mass",
    "start": "269280",
    "end": "276720"
  },
  {
    "text": "storage device um consequently uh it's shown as a as a drive um but it can of",
    "start": "276720",
    "end": "283199"
  },
  {
    "text": "course have have many other ones and in fact it's not even limited to a single functional class think of a webcam with",
    "start": "283199",
    "end": "289600"
  },
  {
    "text": "a built-in microphone that um that tells the computer it's actually two different",
    "start": "289600",
    "end": "295120"
  },
  {
    "text": "devices so that two different drivers can be loaded and so forth um there's a",
    "start": "295120",
    "end": "300240"
  },
  {
    "text": "there's a um orthogonal concept to these interfaces these are the the so-called end points think of them as TCP ports",
    "start": "300240",
    "end": "308880"
  },
  {
    "text": "where the USB stick receives and sends from um actual user data there's always",
    "start": "308880",
    "end": "314800"
  },
  {
    "text": "the endpoint zero which is the one that that basically the basic communication happens um through which it's negotiated",
    "start": "314800",
    "end": "321759"
  },
  {
    "text": "what type of device it is and so forth and then different u devices have different types of endpoints and again",
    "start": "321759",
    "end": "328479"
  },
  {
    "text": "it's not limited to to a certain set um you see that for instance the webcam has",
    "start": "328479",
    "end": "334000"
  },
  {
    "text": "many more endpoints than than a mass storage device because it does more things in parallel um and then these",
    "start": "334000",
    "end": "340560"
  },
  {
    "text": "these devices are identified through serial number And as you already see here there's no fixed length of the",
    "start": "340560",
    "end": "346240"
  },
  {
    "text": "serial numbers in fact um a lot of device classes don't even mandate a serial number um so for for the most",
    "start": "346240",
    "end": "354000"
  },
  {
    "text": "part USB does not have a reliable unique identifier which is why if you plug in a",
    "start": "354000",
    "end": "360000"
  },
  {
    "text": "USB stick um it has to go through some kind of negotiation and as everybody knows the computer um has several USB",
    "start": "360000",
    "end": "367120"
  },
  {
    "text": "ports which can be multiplied through USB hubs so at any one USB controller chip inside the computer there can be",
    "start": "367120",
    "end": "373840"
  },
  {
    "text": "many different USB devices and it's hard to tell for the computer how many actual",
    "start": "373840",
    "end": "378880"
  },
  {
    "text": "physical devices there are right so there's no one to one correlation as to the port they're connected in and",
    "start": "378880",
    "end": "384639"
  },
  {
    "text": "there's no one to one um correlation as to the interfaces it provides right so",
    "start": "384639",
    "end": "390639"
  },
  {
    "start": "389000",
    "end": "504000"
  },
  {
    "text": "every time a new stick is plugged in it goes through uh a registration process",
    "start": "390639",
    "end": "395840"
  },
  {
    "text": "so the the device boots up goes through its boot loader um and sends a registration message um to which the",
    "start": "395840",
    "end": "403680"
  },
  {
    "text": "computer responds with an address this is a temporary address think of like an is um um an IP address assigned by DHCP",
    "start": "403680",
    "end": "410080"
  },
  {
    "text": "server um and then the the USB device sends its descriptor saying I'm I'm an",
    "start": "410080",
    "end": "416000"
  },
  {
    "text": "audio device for instance uh I'm I'm a video device i'm a mass storage device um and then the computer loads the",
    "start": "416000",
    "end": "422319"
  },
  {
    "text": "appropriate driver um so this is the stage at which you could get into USB driver hacking um but we're not going to",
    "start": "422319",
    "end": "429199"
  },
  {
    "text": "touch that today um the driver then sets the configuration of the device they",
    "start": "429199",
    "end": "434479"
  },
  {
    "text": "they resume normal operation and now the one important um aspect for for the",
    "start": "434479",
    "end": "440160"
  },
  {
    "text": "attacks that we're going to show today the USB device is allowed to go through this registration again at any point in",
    "start": "440160",
    "end": "446319"
  },
  {
    "text": "time um and this has useful applications there used to be um USB devices maybe",
    "start": "446319",
    "end": "452160"
  },
  {
    "text": "they still are that first showed you a CDROM drive from which you had to install a driver and then once the",
    "start": "452160",
    "end": "458400"
  },
  {
    "text": "driver was active the the device would switch over to whatever the device was like uh for instance a 3G modem um you",
    "start": "458400",
    "end": "466000"
  },
  {
    "text": "first had to install the driver from a CDROM so at some point in time the the 3G modem um decides to switch from CDROM",
    "start": "466000",
    "end": "473120"
  },
  {
    "text": "to modem um and now taking these things together that the computer does not know",
    "start": "473120",
    "end": "479440"
  },
  {
    "text": "how many devices are currently connected and that they can change the persona at",
    "start": "479440",
    "end": "484479"
  },
  {
    "text": "any point in time um that gives us all the tools we need u for malicious activity um assuming though that USB",
    "start": "484479",
    "end": "493680"
  },
  {
    "text": "devices can be reprogrammed that you can take an off-the-shelf mass storage device for instance and make it behave",
    "start": "493680",
    "end": "499919"
  },
  {
    "text": "like a keyboard and how that's possible is uh what's Jakob gonna walk you",
    "start": "499919",
    "end": "506160"
  },
  {
    "start": "504000",
    "end": "805000"
  },
  {
    "text": "through next so I'll walk you through the",
    "start": "506160",
    "end": "511599"
  },
  {
    "text": "process of how we how we got to in the firmware and understood the firmware update process and how we reverse",
    "start": "511599",
    "end": "518399"
  },
  {
    "text": "engineered the firmware and how we managed to install our own patches to the firmware the first step is",
    "start": "518399",
    "end": "524800"
  },
  {
    "text": "understanding and documenting the firmware upgrade process and it started with a quick internet search which",
    "start": "524800",
    "end": "530080"
  },
  {
    "text": "resulted in some leaked firmware update tools which allow upgrading the firmware and setting and changing settings such",
    "start": "530080",
    "end": "536399"
  },
  {
    "text": "as the product name or the vendor ID or product ID of a USB stick",
    "start": "536399",
    "end": "541839"
  },
  {
    "text": "and we we we started these tools and sniffed the communication between the",
    "start": "541839",
    "end": "548160"
  },
  {
    "text": "the firmware updator and the USB stick using Wireshark and when taking a look at the",
    "start": "548160",
    "end": "554959"
  },
  {
    "text": "Wireshark dumps you can see that the firmware update process works via custom scazzy commands via the USB M storage",
    "start": "554959",
    "end": "562800"
  },
  {
    "text": "protocol which is just a tiny wrapper around scazzy commands",
    "start": "562800",
    "end": "567920"
  },
  {
    "text": "and then we could reverse engineer the firmware update process and replay the custom scuzzy commands and actually",
    "start": "567920",
    "end": "576320"
  },
  {
    "text": "write our own update tools for these USB sticks and during this process we",
    "start": "576320",
    "end": "581760"
  },
  {
    "text": "obviously pricked a lot of the USB sticks but you can can recover a pricked USB stick by short circuiting some of",
    "start": "581760",
    "end": "588880"
  },
  {
    "text": "the flash IO pins because the controller has a fixed bootloader which loads the actual firmware from the big NAND flash",
    "start": "588880",
    "end": "594880"
  },
  {
    "text": "chip and if this if it can't load the firmware from the flash chip it will",
    "start": "594880",
    "end": "600800"
  },
  {
    "text": "stay in the bootloader mode and and you can reprogram it again right",
    "start": "600800",
    "end": "608880"
  },
  {
    "text": "now that we have understood the firmware update process we wanted to take a look at the firmware files and we quickly",
    "start": "608880",
    "end": "615279"
  },
  {
    "text": "found out that the firmware files are contain valid 80-51 code but there's a",
    "start": "615279",
    "end": "622000"
  },
  {
    "text": "small problem the firmware files are a lot bigger than the 16- bit or 64 kilobyte address space of the 80-51",
    "start": "622000",
    "end": "630120"
  },
  {
    "text": "architecture and this leads to the conclusion that it has to use some kind of MMU like memory banking to map parts",
    "start": "630120",
    "end": "638480"
  },
  {
    "text": "of a firmware to certain addresses in the address space and we wanted to",
    "start": "638480",
    "end": "643839"
  },
  {
    "text": "understand this memory banking and know which block is loaded to which address in the address space before actually starting to reverse engineer the",
    "start": "643839",
    "end": "650160"
  },
  {
    "text": "firmware and in order to do so we used some horistics to find valid call",
    "start": "650160",
    "end": "655920"
  },
  {
    "text": "instructions in the binary code and we alo and we used some heristics as well",
    "start": "655920",
    "end": "662640"
  },
  {
    "text": "to find valid function starts in the binary code and then we guessed an",
    "start": "662640",
    "end": "668320"
  },
  {
    "text": "address where code block might be loaded to the address space and counted the number of matches between the call",
    "start": "668320",
    "end": "674440"
  },
  {
    "text": "destinations which are encoded as absolute addresses for the 80-51 architecture to the function starts we",
    "start": "674440",
    "end": "681600"
  },
  {
    "text": "found and the highest number of matches leads to the correct address where where the code is loaded to and this saved us",
    "start": "681600",
    "end": "688399"
  },
  {
    "text": "a lot of time for understanding the memory banking mechanism and the next step was to use some other heristics to",
    "start": "688399",
    "end": "695519"
  },
  {
    "text": "find valid USB descriptors in the binary and these USB descriptors provide a good",
    "start": "695519",
    "end": "701680"
  },
  {
    "text": "starting point at reverse engineering the firmware and then we could load our",
    "start": "701680",
    "end": "708079"
  },
  {
    "text": "firmware files into IDA Pro and start reverse engineering the firmware",
    "start": "708079",
    "end": "713720"
  },
  {
    "text": "unfortunately it was relatively complex and we didn't manage to understand everything since we had practically no",
    "start": "713720",
    "end": "720240"
  },
  {
    "text": "strings except the USB descriptors and we had no documentation about the",
    "start": "720240",
    "end": "725360"
  },
  {
    "text": "peripherals of the AT51 controller core but we could find some hooking points",
    "start": "725360",
    "end": "731760"
  },
  {
    "text": "where we could manipulate the USB functionality the device provides and we have and so we could start start",
    "start": "731760",
    "end": "741920"
  },
  {
    "text": "manipulating the firmware and adding hooks and injecting our own code to unused spaces of the firmware luckily",
    "start": "741920",
    "end": "748000"
  },
  {
    "text": "for us there are a lot of unused empty spaces in the firmware files and and since we didn't want to",
    "start": "748000",
    "end": "755440"
  },
  {
    "text": "implement all our changes in assembly we also created some custom linker scripts",
    "start": "755440",
    "end": "761160"
  },
  {
    "text": "which compile C code and assembly code and link it everything together and",
    "start": "761160",
    "end": "766320"
  },
  {
    "text": "inject it to unused areas of the firmware files and so we could implement",
    "start": "766320",
    "end": "771680"
  },
  {
    "text": "some other functionalities on these USB sticks right well we we mainly concentrated on USB M storage devices on",
    "start": "771680",
    "end": "779440"
  },
  {
    "text": "two two different types of controllers but the same process should work for a lot of other devices as well such as",
    "start": "779440",
    "end": "785200"
  },
  {
    "text": "webcams or USB SATA bridges which are used for external hard disk drives or",
    "start": "785200",
    "end": "790959"
  },
  {
    "text": "printers or maybe even keyboards and many more devices now that we have understood how",
    "start": "790959",
    "end": "798720"
  },
  {
    "text": "we could reverse engineer and patch the firmware let's let's go to our next demonstration",
    "start": "798720",
    "end": "805120"
  },
  {
    "text": "right so just just to emphasize that point um we did not break everything about USB with this research we looked",
    "start": "805120",
    "end": "812399"
  },
  {
    "text": "at two very popular USB controller chips reverse engineered those found how to reprogram them and we'd have to go",
    "start": "812399",
    "end": "818560"
  },
  {
    "text": "through the same process multiple more times to get coverage over all device classes but there's nothing prohibiting",
    "start": "818560",
    "end": "824959"
  },
  {
    "text": "somebody from doing so we spend maybe two months on the first chip then a months on the second chip so if you have",
    "start": "824959",
    "end": "830959"
  },
  {
    "text": "um sufficient resources you will achieve great coverage over many USB",
    "start": "830959",
    "end": "836600"
  },
  {
    "text": "devices all right onto the next demo",
    "start": "836600",
    "end": "841040"
  },
  {
    "start": "840000",
    "end": "880000"
  },
  {
    "text": "then so now I attach a new and totally unprepared offtheshelf USB stick to the",
    "start": "842440",
    "end": "848160"
  },
  {
    "text": "computer which has been infected in the first demonstration",
    "start": "848160",
    "end": "853079"
  },
  {
    "text": "and as you can see it installs the device driver and you see the new new drive E appearing for a moment but then",
    "start": "853440",
    "end": "860000"
  },
  {
    "text": "the new drive disappears again so what's happening is that the virus we have installed in the first in the first",
    "start": "860000",
    "end": "867399"
  },
  {
    "text": "demo reproduces itself to the new USB stick and reprograms the firmware of the",
    "start": "867399",
    "end": "872800"
  },
  {
    "text": "USB stick well now that it has installed a new firmware to it I will take take it",
    "start": "872800",
    "end": "878560"
  },
  {
    "text": "over to our Linux notebook over here",
    "start": "878560",
    "end": "883279"
  },
  {
    "start": "880000",
    "end": "910000"
  },
  {
    "text": "this way",
    "start": "887680",
    "end": "891000"
  },
  {
    "text": "so one moment is screen setting",
    "start": "900000",
    "end": "904639"
  },
  {
    "text": "uh yeah so so now I attach the same USB stick",
    "start": "909079",
    "end": "916480"
  },
  {
    "start": "910000",
    "end": "977000"
  },
  {
    "text": "which has been infected with a virus to to a Linux notebook and as you can see",
    "start": "916480",
    "end": "921600"
  },
  {
    "text": "in the file manager as you can see here a new USB disc has appeared but and if",
    "start": "921600",
    "end": "927760"
  },
  {
    "text": "we wait some time it will convert itself to a USB keyboard but this time it is",
    "start": "927760",
    "end": "932800"
  },
  {
    "text": "attached to a Linux system and so it has to use a different keystroke sequence to infect the Linux system but it can",
    "start": "932800",
    "end": "938880"
  },
  {
    "text": "detect during the USB enumeration that it is now attached to a Linux system and",
    "start": "938880",
    "end": "943920"
  },
  {
    "text": "as you have seen now it has opened a command prompt and entered as entered one command and so it has now infected",
    "start": "943920",
    "end": "950720"
  },
  {
    "text": "the Linux system so what you have seen now seen here is a self reproducing",
    "start": "950720",
    "end": "956160"
  },
  {
    "text": "virus which can spread between Windows and Linux systems via standard of a shave USB sticks and it reproduces it",
    "start": "956160",
    "end": "963519"
  },
  {
    "text": "itself to to new USB sticks without the user noticing [Applause]",
    "start": "963519",
    "end": "978459"
  },
  {
    "start": "977000",
    "end": "1065000"
  },
  {
    "text": "that's but there was a small problem with making the safe reproducing virus",
    "start": "980279",
    "end": "985440"
  },
  {
    "text": "work with Linux systems with the emulated USB keyboard we can only infect the user which is currently into the",
    "start": "985440",
    "end": "991759"
  },
  {
    "text": "Linux system but in order to reprogram the firmware of a USB stick we need root",
    "start": "991759",
    "end": "997600"
  },
  {
    "text": "privileges on the systems and so we need to find a way to escalate to root privileges and we didn't want to use a",
    "start": "997600",
    "end": "1003759"
  },
  {
    "text": "zero day which will be fixed next week so we we used a more generic approach",
    "start": "1003759",
    "end": "1009160"
  },
  {
    "text": "and so the basic idea is to steal the password when the users enters the password for doing an administrative",
    "start": "1009160",
    "end": "1015600"
  },
  {
    "text": "action such as installing software using or or or for unlocking the screen and",
    "start": "1015600",
    "end": "1021680"
  },
  {
    "text": "when the user enters the password our virus steals the password via an LD",
    "start": "1021680",
    "end": "1026880"
  },
  {
    "text": "preload library to which is loaded into the screen saver binary and then it takes this password",
    "start": "1026880",
    "end": "1033199"
  },
  {
    "text": "and escalates to root privileges using sudo so it just exploits the way the",
    "start": "1033199",
    "end": "1039520"
  },
  {
    "text": "system is designed and it obvious and it requires the user to be logged in as an",
    "start": "1039520",
    "end": "1045038"
  },
  {
    "text": "administrative account which can so that you can use sudo to gain root privileges but the default user account of most",
    "start": "1045039",
    "end": "1051280"
  },
  {
    "text": "Linux distribution is a privileged account and most users have a have a",
    "start": "1051280",
    "end": "1057200"
  },
  {
    "text": "privileges to use sudo with their own password to gain root privileges",
    "start": "1057200",
    "end": "1063559"
  },
  {
    "text": "um all right um that was u two examples out of this",
    "start": "1064280",
    "end": "1070480"
  },
  {
    "start": "1065000",
    "end": "1127000"
  },
  {
    "text": "family of attacks um where one USB device becomes another now this family",
    "start": "1070480",
    "end": "1075760"
  },
  {
    "text": "um is is huge and we are only seeing the tip of the iceberg so far um it is",
    "start": "1075760",
    "end": "1080960"
  },
  {
    "text": "flexible in multiple dimensions um your emulation target doesn't have to be a",
    "start": "1080960",
    "end": "1086000"
  },
  {
    "text": "keyboard other USB devices also uh provide um malicious potential and uh we",
    "start": "1086000",
    "end": "1092880"
  },
  {
    "text": "reprogrammed this this other um USB controller just to show that it's not not tied to to any one manufacturer or",
    "start": "1092880",
    "end": "1100240"
  },
  {
    "text": "chip this being a USB 2 chip that we've seen so far this now is a USB 3 controller we reprogrammed that to be a",
    "start": "1100240",
    "end": "1107360"
  },
  {
    "text": "different device and one that may be even harder to to detect",
    "start": "1107360",
    "end": "1114280"
  },
  {
    "text": "um so pay very close attention what happens now this is almost almost",
    "start": "1114280",
    "end": "1119360"
  },
  {
    "text": "impossible to see what's Oh the screen oh sorry yes thank",
    "start": "1119360",
    "end": "1126799"
  },
  {
    "text": "you i hope I think I have to do it again",
    "start": "1126799",
    "end": "1134080"
  },
  {
    "start": "1127000",
    "end": "1230000"
  },
  {
    "text": "yeah no it's there fine all right so plugging in this this",
    "start": "1134520",
    "end": "1142720"
  },
  {
    "text": "USB 3",
    "start": "1142720",
    "end": "1145520"
  },
  {
    "text": "controller h this time nothing showed oh yeah it it did extreme did Did anybody see it did",
    "start": "1147799",
    "end": "1155200"
  },
  {
    "text": "anybody see the flickering in this symbol no seriously there was a",
    "start": "1155200",
    "end": "1160960"
  },
  {
    "text": "flickering so um because what happens is uh that it's",
    "start": "1160960",
    "end": "1166160"
  },
  {
    "text": "not just connected to Wi-Fi network now but also through a wired Ethernet even though there's no Ethernet cable coming",
    "start": "1166160",
    "end": "1172480"
  },
  {
    "text": "out of this machine so what we're emulating is an is an Ethernet uh card",
    "start": "1172480",
    "end": "1178120"
  },
  {
    "text": "and one that huh okay internet is slow in this room",
    "start": "1178120",
    "end": "1185280"
  },
  {
    "text": "but should still work one that um changes how this computer browses the",
    "start": "1185280",
    "end": "1191039"
  },
  {
    "text": "internet so we'll go to a Oops nope that didn't work",
    "start": "1191039",
    "end": "1196640"
  },
  {
    "text": "okay well let's try it one more time um",
    "start": "1207480",
    "end": "1213160"
  },
  {
    "text": "Nope that does not seem to work since this is pretty redundant with the next demo we'll we'll show anyway um let's",
    "start": "1224240",
    "end": "1230240"
  },
  {
    "text": "just uh cut cut to the uh to the resolution of what we would have seen here um so we go we go to a website that",
    "start": "1230240",
    "end": "1238000"
  },
  {
    "text": "is otherwise trusted um but this computer now access it from a completely different server because what we",
    "start": "1238000",
    "end": "1244640"
  },
  {
    "text": "implemented on this uh USB thumb drive um is a uh an Ethernet adapter that you",
    "start": "1244640",
    "end": "1250799"
  },
  {
    "start": "1247000",
    "end": "1328000"
  },
  {
    "text": "saw but also DHCP server and the DHCP server assigns a new IP address to the",
    "start": "1250799",
    "end": "1256960"
  },
  {
    "text": "machine but also new DNS server on the internet what it doesn't assign is a default gateway so it tells the computer",
    "start": "1256960",
    "end": "1264799"
  },
  {
    "text": "please use this DNS server without telling it how to reach that DNS server so the computer will still browse",
    "start": "1264799",
    "end": "1271440"
  },
  {
    "text": "through the established connection um the USB stick can't forward packets to the internet uh but the computer can",
    "start": "1271440",
    "end": "1277520"
  },
  {
    "text": "through through its wireless connection and now this DNS server was supposed to",
    "start": "1277520",
    "end": "1283360"
  },
  {
    "text": "um modify uh the paypal.com to our server and then of course you're typing",
    "start": "1283360",
    "end": "1288400"
  },
  {
    "text": "in your password to a wrong uh server um",
    "start": "1288400",
    "end": "1293440"
  },
  {
    "text": "so that was the the second idea that came to mind um now it works now it works you all want to see it yeah all",
    "start": "1293440",
    "end": "1303120"
  },
  {
    "text": "right um okay so he did not sneakily just edit",
    "start": "1307960",
    "end": "1313679"
  },
  {
    "text": "the etc hosts file now you don't it's not not yet on the overhead so hope it's",
    "start": "1313679",
    "end": "1319840"
  },
  {
    "text": "not yeah",
    "start": "1319840",
    "end": "1323080"
  },
  {
    "text": "okay it does not work but as I said it's redundant with the next demo anyway um",
    "start": "1325200",
    "end": "1330400"
  },
  {
    "start": "1328000",
    "end": "1409000"
  },
  {
    "text": "which we'll get to in a second um but let's discuss for for a moment um our",
    "start": "1330400",
    "end": "1336000"
  },
  {
    "text": "approach to using USB devices and the trust that we usually assert with that um USB is so popular because it's",
    "start": "1336000",
    "end": "1342559"
  },
  {
    "text": "extremely easy to use and it it is the secure way of exchanging files because the alternative always is to send it",
    "start": "1342559",
    "end": "1349120"
  },
  {
    "text": "through unencrypted emails or through whatever cloud service you don't trust so USB devices have conquered the world",
    "start": "1349120",
    "end": "1356240"
  },
  {
    "text": "as um a device that we trust in and if we look at a thumb drive we trust it as",
    "start": "1356240",
    "end": "1361520"
  },
  {
    "text": "a thumb drive and we know to run a virus scanner because it could contain a virus and if we allow somebody to plug in",
    "start": "1361520",
    "end": "1367280"
  },
  {
    "text": "their their USB keyboard into our computer we trust them a lot more because now they can type commands on our behalf",
    "start": "1367280",
    "end": "1374360"
  },
  {
    "text": "um this research breaks down these trust differences if you're plugging in any",
    "start": "1374360",
    "end": "1379840"
  },
  {
    "text": "USB device in the future uh you'll have to assume that any type of possible USB peripheral is now",
    "start": "1379840",
    "end": "1387919"
  },
  {
    "text": "running on this USB thumb drive and um this of course uh changes our whole approach to USB I would hope um to",
    "start": "1387919",
    "end": "1395360"
  },
  {
    "text": "emphasize this it's um not just a situation where somebody else gives you a USB peripheral that uh you have to be",
    "start": "1395360",
    "end": "1402559"
  },
  {
    "text": "careful about it's even uh when when they attach it to your computer vice",
    "start": "1402559",
    "end": "1407760"
  },
  {
    "text": "versa or even in shared environments so for instance let's look at a cloud environment um some uh cloud instances",
    "start": "1407760",
    "end": "1414880"
  },
  {
    "start": "1409000",
    "end": "1490000"
  },
  {
    "text": "their their backup storage is connected over USB um imagine the situation where the VMware tenant um now reprograms this",
    "start": "1414880",
    "end": "1423520"
  },
  {
    "text": "USB controller chip to become two devices by default that second device is",
    "start": "1423520",
    "end": "1428960"
  },
  {
    "text": "connected to the host computer so uh wherever USB is involved we are bridging",
    "start": "1428960",
    "end": "1435120"
  },
  {
    "text": "um what should be barriers of trust where where you're trying to contain people so USB is a technology that needs",
    "start": "1435120",
    "end": "1442480"
  },
  {
    "text": "to be used uh with lots of care and lots of reflection as to who could have",
    "start": "1442480",
    "end": "1447520"
  },
  {
    "text": "influenced this USB device in the past and that is in a nutshell we need to use USB way different from how we're using",
    "start": "1447520",
    "end": "1454400"
  },
  {
    "text": "it today um but with that said um let's get into into one more last demo um to",
    "start": "1454400",
    "end": "1462320"
  },
  {
    "text": "show another dimension in which this family um of attacks is is flexible and that is of course the the host of of the",
    "start": "1462320",
    "end": "1469520"
  },
  {
    "text": "attack can be different we saw two different thumb drives here but thumb drives clearly is not the only device that speaks USB uh and Jakob is now",
    "start": "1469520",
    "end": "1477440"
  },
  {
    "text": "going to show an attack from probably the easiest to use USB attack firmware",
    "start": "1477440",
    "end": "1482559"
  },
  {
    "text": "and that is um an Android phone so here's a standard Android phone",
    "start": "1482559",
    "end": "1489360"
  },
  {
    "text": "we have hooked this phone and installed a small script and now let's attach this phone to this computer just for charging",
    "start": "1489360",
    "end": "1495520"
  },
  {
    "text": "the phone and let's see what",
    "start": "1495520",
    "end": "1501000"
  },
  {
    "text": "happens there you don't see too much happening",
    "start": "1501000",
    "end": "1507200"
  },
  {
    "text": "but but again if if you know what's going on you will see that there's an additional network device connected now",
    "start": "1508159",
    "end": "1514000"
  },
  {
    "text": "but again not nothing that the user would have would have noted",
    "start": "1514000",
    "end": "1519640"
  },
  {
    "text": "so now let's let's open the internet and go to",
    "start": "1520000",
    "end": "1525440"
  },
  {
    "text": "paypal.com and see now let's look into the site and see what",
    "start": "1530760",
    "end": "1536799"
  },
  {
    "text": "happens well we are still at the start page even if you have tried to look in no error message nothing but let's see",
    "start": "1538600",
    "end": "1545919"
  },
  {
    "text": "what happened well we haven't visited the real PayPal site we have visited a fake",
    "start": "1545919",
    "end": "1551679"
  },
  {
    "text": "site for we have set up for this demonstration and now let's take a look what happened well here's the username",
    "start": "1551679",
    "end": "1558400"
  },
  {
    "text": "and password I've typed",
    "start": "1558400",
    "end": "1561679"
  },
  {
    "text": "in and all this was possible with a standard Android phone which which was just attached to the computer for",
    "start": "1565640",
    "end": "1571840"
  },
  {
    "text": "charging the phone mhm",
    "start": "1571840",
    "end": "1577080"
  },
  {
    "text": "um well if if we if if we have time in the end we'll show the same attack again from the from the USB thumb drive",
    "start": "1577080",
    "end": "1583200"
  },
  {
    "text": "apparently it works now whatever the bug was before um just one last note on on the on the Android attack um we did",
    "start": "1583200",
    "end": "1590080"
  },
  {
    "text": "release that on our web page just this morning um not because it's it's uh the greatest research but because it gives",
    "start": "1590080",
    "end": "1596480"
  },
  {
    "text": "you a tool now um to see if your defenses hold against this type of attack will you detect that a phone just",
    "start": "1596480",
    "end": "1603120"
  },
  {
    "text": "turned into an Ethernet adapter right and if if you're running any type of",
    "start": "1603120",
    "end": "1608159"
  },
  {
    "text": "device control software DLP solutions all the ones that we have seen do not",
    "start": "1608159",
    "end": "1613200"
  },
  {
    "text": "protect from this attack um they're very retroactive in the sense that they know there can be viruses on USB mass storage",
    "start": "1613200",
    "end": "1620400"
  },
  {
    "text": "devices so they block USB mass storage devices any other USB device class is",
    "start": "1620400",
    "end": "1626240"
  },
  {
    "text": "unaffected by device control software right now but that's hopefully going to change in the future and when it does",
    "start": "1626240",
    "end": "1632240"
  },
  {
    "text": "and when your vendor tells you that your solution now is secure against this download our script run it on an Android",
    "start": "1632240",
    "end": "1637600"
  },
  {
    "text": "phone and see if it detects this as malicious right um one one as a note on",
    "start": "1637600",
    "end": "1643440"
  },
  {
    "text": "on attacks from phones while these may may look uh easy and not not quite as",
    "start": "1643440",
    "end": "1649200"
  },
  {
    "text": "dangerous at the ones as the ones from thumb drives because everybody assumes phones to be reprogrammable they do",
    "start": "1649200",
    "end": "1654240"
  },
  {
    "text": "break down another trust barrier and that is the two- factor authentication trust barrier that that at least in",
    "start": "1654240",
    "end": "1660240"
  },
  {
    "text": "Europe we used for online banking where you assume that your phone sometimes gets hacked and you assume that your",
    "start": "1660240",
    "end": "1665760"
  },
  {
    "text": "computer sometimes gets hacked but you assume that they'll never get hacked by the same person at the same time so as",
    "start": "1665760",
    "end": "1671679"
  },
  {
    "text": "long as one of them is unaffected by your online payment criminal uh you can do safe online banking now that's",
    "start": "1671679",
    "end": "1678159"
  },
  {
    "text": "assuming that they're working independently as soon as you connect them for charging for instance over USB",
    "start": "1678159",
    "end": "1683840"
  },
  {
    "text": "this type of attack breaks down this trust barrier and breaks down basically two-factor authentication in in the",
    "start": "1683840",
    "end": "1690559"
  },
  {
    "text": "computer uh Android phone split right um moving on to one last example that we",
    "start": "1690559",
    "end": "1697360"
  },
  {
    "start": "1694000",
    "end": "1804000"
  },
  {
    "text": "implemented there's a couple more ideas that that we didn't have time to implement and we won't have time to demo",
    "start": "1697360",
    "end": "1702480"
  },
  {
    "text": "this um he here's what a lot of you will will be reminded of as as a boot sector",
    "start": "1702480",
    "end": "1709200"
  },
  {
    "text": "virus it works pretty much the same way we had to add to to the components that we have already demoed just one more",
    "start": "1709200",
    "end": "1714559"
  },
  {
    "text": "thing and that is a distinguisher between operating systems you already saw how we distinguish between Windows",
    "start": "1714559",
    "end": "1720240"
  },
  {
    "text": "and Linux so a distinguisher between those classes of of u communication partners and the BIOS the BIOS again",
    "start": "1720240",
    "end": "1727520"
  },
  {
    "text": "does a different USB enumeration so we can distinguish it and we are emulating on on one thumb drive actually two thumb",
    "start": "1727520",
    "end": "1734480"
  },
  {
    "text": "drives and if need be a keyboard and if if it's connected to an operating system",
    "start": "1734480",
    "end": "1739840"
  },
  {
    "text": "you'll only ever see one thumb drive okay and it's a benign thumb drives again you can delete everything on it",
    "start": "1739840",
    "end": "1745120"
  },
  {
    "text": "that doesn't affect the second thumb drive is only shown while the computer boots and in fact the computer will boot",
    "start": "1745120",
    "end": "1751360"
  },
  {
    "text": "from that thumb drive if it's so configured and if it isn't emulating getting a keyboard to press F12 or",
    "start": "1751360",
    "end": "1757760"
  },
  {
    "text": "whatever is needed on your computer to make it boot from the thumb drive and this other small thumb drive uh has a",
    "start": "1757760",
    "end": "1765279"
  },
  {
    "text": "rootkit on it that boots pre your operating system and can infect other USB devices can infect operating system",
    "start": "1765279",
    "end": "1772240"
  },
  {
    "text": "again not going into what the virus can do in a computer this is a perfect deployment channel for a uh virus if",
    "start": "1772240",
    "end": "1780080"
  },
  {
    "text": "your defenses rely on software running on the computer because that software will only start when the virus is",
    "start": "1780080",
    "end": "1785840"
  },
  {
    "text": "already there having taken control of everything right so boot sector virus brought back in this millennia",
    "start": "1785840",
    "end": "1793559"
  },
  {
    "text": "um all right so um these were the the attacks that that we had prepared and",
    "start": "1793559",
    "end": "1798960"
  },
  {
    "text": "that we uh played around with um there's there's a couple more um that you can uh",
    "start": "1798960",
    "end": "1804559"
  },
  {
    "start": "1804000",
    "end": "2055000"
  },
  {
    "text": "think of um for instance messing with the data um that somebody writes on the",
    "start": "1804559",
    "end": "1810080"
  },
  {
    "text": "flash chip again the the USB controller chip sits in the middle it broke of course it can change things it can hide",
    "start": "1810080",
    "end": "1816640"
  },
  {
    "text": "files instead of deleting them it can even rewrite them on the fly um as you",
    "start": "1816640",
    "end": "1822399"
  },
  {
    "text": "are as you're writing a benign file it can put a virus in there and in fact it can be smart about it and give you back",
    "start": "1822399",
    "end": "1829120"
  },
  {
    "text": "the original file when you read from it but as soon as you start intacting with it when it when it looks like it's not a",
    "start": "1829120",
    "end": "1835279"
  },
  {
    "text": "virus scanner looking at the file then you can play back a different file so basically you give the virus scanner one",
    "start": "1835279",
    "end": "1840880"
  },
  {
    "text": "file and you give the the actual execute another file if you're smart about it again we we are not really computer",
    "start": "1840880",
    "end": "1846399"
  },
  {
    "text": "security people so somebody else will have to figure out the the mechanics of this um obviously with a keyboard and a",
    "start": "1846399",
    "end": "1854640"
  },
  {
    "text": "file on a on a thumb drive you can flash your bias right if you had a malicious bias so there could be a back and forth",
    "start": "1854640",
    "end": "1860960"
  },
  {
    "text": "USB uh disc at boot flashing the bias and the biases flashing USB disc so this",
    "start": "1860960",
    "end": "1866720"
  },
  {
    "text": "could very well be a virus propagating without the help of any operating system",
    "start": "1866720",
    "end": "1871760"
  },
  {
    "text": "um but here again it would be accustomed to biases and um my my understanding is that biases uh that there isn't the one",
    "start": "1871760",
    "end": "1879120"
  },
  {
    "text": "bias to rule them all like it seems to be the case for for the USB controller chips where there's one main",
    "start": "1879120",
    "end": "1884880"
  },
  {
    "text": "manufacturer to have a big chunk of this market um but we have seen from from some intelligence organization leaks",
    "start": "1884880",
    "end": "1892000"
  },
  {
    "text": "that at least they are playing with biosis and that they are reflashing the popular ones on Dell and HP and Huawei",
    "start": "1892000",
    "end": "1898080"
  },
  {
    "text": "and Ericson equipment um you can go to to other device classes",
    "start": "1898080",
    "end": "1903279"
  },
  {
    "text": "like for instance there's USB displays right very low resolution obviously but if somebody came up with a defense like",
    "start": "1903279",
    "end": "1910720"
  },
  {
    "text": "um a rearranged pin pad assuming that the USB attacker is blind right you get",
    "start": "1910720",
    "end": "1916080"
  },
  {
    "text": "the keyboard but you don't get any feedback uh you could create that feedback through a uh a spoof display",
    "start": "1916080",
    "end": "1922799"
  },
  {
    "text": "probably not on the controller chips that we looked at again the 80-51 um chips uh pretty slow Um but let's say on",
    "start": "1922799",
    "end": "1930480"
  },
  {
    "text": "an Android phone that would be no problem at all to uh get visual feedback for the attack that you're currently",
    "start": "1930480",
    "end": "1936200"
  },
  {
    "text": "executing right um now let me let me perhaps stretch one thing that only came",
    "start": "1936200",
    "end": "1943519"
  },
  {
    "text": "to mind when I started thinking about this research a little bit more um clearly this is a problem for for for",
    "start": "1943519",
    "end": "1950279"
  },
  {
    "text": "infection computers get infected more easily when USB viruses exist however",
    "start": "1950279",
    "end": "1956559"
  },
  {
    "text": "the the actual gamecher here is persistence infecting a computer that",
    "start": "1956559",
    "end": "1962880"
  },
  {
    "text": "happens all the time through many methods right and then what you do then is you reinstall your computer perhaps",
    "start": "1962880",
    "end": "1969039"
  },
  {
    "text": "change all your passwords and you recover from the infection in a world where USB um attacks",
    "start": "1969039",
    "end": "1977559"
  },
  {
    "text": "exist there's no clear path to disinfection right so it could be that",
    "start": "1977559",
    "end": "1983120"
  },
  {
    "text": "the the USB thumb drive that you're trying to reinstall your operating system from that that's already infected",
    "start": "1983120",
    "end": "1988799"
  },
  {
    "text": "that your USB keyboard is infected that any USB peripheral is infected even the",
    "start": "1988799",
    "end": "1994159"
  },
  {
    "text": "ones built into your computer right a lot of computers have a webcam um that's",
    "start": "1994159",
    "end": "1999279"
  },
  {
    "text": "connected over USB internally and somebody last year uh showed how the the ones in in Max I believe uh could be",
    "start": "1999279",
    "end": "2006159"
  },
  {
    "text": "reprogrammed they just wanted the green light to stay off but if you can reprogram it that way maybe you can",
    "start": "2006159",
    "end": "2011760"
  },
  {
    "text": "throw in a couple of keyboard emulation attacks so how do you now recover from a virus infection if that virus infection",
    "start": "2011760",
    "end": "2018799"
  },
  {
    "text": "started messing with some of your devices and how do you estimate the spread of this virus assuming that some",
    "start": "2018799",
    "end": "2024880"
  },
  {
    "text": "of your USB devices wonder from computer to computer right i think this is um",
    "start": "2024880",
    "end": "2030720"
  },
  {
    "text": "this is the fundamental issue here uh and one that's not going to be resolved with a software patch as I showed um",
    "start": "2030720",
    "end": "2037200"
  },
  {
    "text": "going in um everything works as intended usb is supposed to be flexible you want to have the cap capacity to switch from",
    "start": "2037200",
    "end": "2044640"
  },
  {
    "text": "one device class to another it's very useful but at the same time this is incompatible with trust and from trust",
    "start": "2044640",
    "end": "2051919"
  },
  {
    "text": "environments perhaps USB uh should be removed um now let's talk about a couple",
    "start": "2051919",
    "end": "2059040"
  },
  {
    "start": "2055000",
    "end": "2084000"
  },
  {
    "text": "of the defenses that could be there and those defenses are mostly against the initial infection uh some of them also",
    "start": "2059040",
    "end": "2065919"
  },
  {
    "text": "about uh the the persistence um unfortunately there's no clear do this",
    "start": "2065919",
    "end": "2071599"
  },
  {
    "text": "today and you are safe type of uh solution um pretty much everything at least that we could come up with uh is",
    "start": "2071599",
    "end": "2078158"
  },
  {
    "text": "either impractical or uh a strong inhibitor to productiveness and",
    "start": "2078159",
    "end": "2083520"
  },
  {
    "text": "usefulness of USB um so the the the first thing that comes to mind analogous",
    "start": "2083520",
    "end": "2089839"
  },
  {
    "text": "to firewalling is a white list of USB devices that you trust you connect the",
    "start": "2089839",
    "end": "2095200"
  },
  {
    "text": "USB device for the first time and the computer asks you do you want a new thumb drive to be connected and trusted",
    "start": "2095200",
    "end": "2101200"
  },
  {
    "text": "or do you want a new keyboard to be connected and trusted and um at least some users would notice that of course",
    "start": "2101200",
    "end": "2107119"
  },
  {
    "text": "they don't want to trust a new keyboard after plugging in a thumb drive but that does not exist as an operating feature",
    "start": "2107119",
    "end": "2113839"
  },
  {
    "text": "operating system feature yet um other standards that are as flexible as USB",
    "start": "2113839",
    "end": "2118960"
  },
  {
    "text": "they have this look at Bluetooth for instance part of the pairing um is the",
    "start": "2118960",
    "end": "2124079"
  },
  {
    "text": "device class and you cannot just spawn another device from a once paired um device so um Bluetooth already has this",
    "start": "2124079",
    "end": "2132560"
  },
  {
    "text": "but probably because of its history of wireless um they they wanted more security but something like that could",
    "start": "2132560",
    "end": "2138640"
  },
  {
    "text": "be introduced in USB if devices were uniquely",
    "start": "2138640",
    "end": "2144520"
  },
  {
    "text": "identifiable and remember on the very first slide I said serial numbers are optional so they're not uniquely",
    "start": "2144520",
    "end": "2150640"
  },
  {
    "text": "identifiable as soon as you tell your computer yes trust USB keyboards from let's say Cherry you trust them all",
    "start": "2150640",
    "end": "2157760"
  },
  {
    "text": "there's no way of distinguishing them and as soon as the the the virus knows that there's a cherry keyboard on your",
    "start": "2157760",
    "end": "2163760"
  },
  {
    "text": "white list it just spoofs that indistinguishable no serial number that one would have to guess so even the very",
    "start": "2163760",
    "end": "2169440"
  },
  {
    "text": "basics for firewalling like unique addresses is missing from USB right at",
    "start": "2169440",
    "end": "2175200"
  },
  {
    "text": "least from those USB classes that are most dangerous like keyboards um so that",
    "start": "2175200",
    "end": "2180560"
  },
  {
    "text": "doesn't seem to be a uh a complete or even available solution in today's operating systems um you could of course",
    "start": "2180560",
    "end": "2187920"
  },
  {
    "text": "take a blacklist approach instead of whitelisting you just say these device classes they're out you know all keyboards all Ethernet devices but",
    "start": "2187920",
    "end": "2194800"
  },
  {
    "text": "there'll probably always be a couple of new device classes that you're chasing and even if you found them all this",
    "start": "2194800",
    "end": "2200400"
  },
  {
    "text": "would be basically analog just to to switching off USB right in addition if",
    "start": "2200400",
    "end": "2205520"
  },
  {
    "text": "you do this through software it only protects the operating system after it's booted all the attacks",
    "start": "2205520",
    "end": "2212800"
  },
  {
    "text": "the boot sector virus and so forth that work on the pre-operating system level against your BIOS for instance those",
    "start": "2212800",
    "end": "2219119"
  },
  {
    "text": "would not be covered by anything other than physically disabling USB right people were talking about super gluing",
    "start": "2219119",
    "end": "2225680"
  },
  {
    "text": "your your USB devices right um of course this is a great inhibitor to uh to to",
    "start": "2225680",
    "end": "2231119"
  },
  {
    "text": "the usefulness of USB and at that point we could just stop stop having USB which is in nobody's interest um so taking an",
    "start": "2231119",
    "end": "2238880"
  },
  {
    "text": "a um a couple of other ideas from computer security since firewalling doesn't seem to work let's do virus",
    "start": "2238880",
    "end": "2244160"
  },
  {
    "text": "scanning right let's uh maybe even behavioralbased analysis right run whatever firmware there is and see if it",
    "start": "2244160",
    "end": "2250720"
  },
  {
    "text": "ever turns into anything else now the problem here is that this firmware isn't in a readily accessible file uh you can",
    "start": "2250720",
    "end": "2257599"
  },
  {
    "text": "read it back this is how we started working with these these sticks you read it from a stick and then you change it",
    "start": "2257599",
    "end": "2263200"
  },
  {
    "text": "and you write it back however you're relying on functions that this very firmware you're trying to read out",
    "start": "2263200",
    "end": "2269760"
  },
  {
    "text": "offers you so a malicious firmware will just play back a different one a benign",
    "start": "2269760",
    "end": "2275200"
  },
  {
    "text": "one if you ask it for it right uh so virus scanning really uh isn't possible",
    "start": "2275200",
    "end": "2280640"
  },
  {
    "text": "here um because the the firmware can can lock itself down and never be read back",
    "start": "2280640",
    "end": "2285680"
  },
  {
    "text": "um now you could you could ask for USB devices that are just not reprogrammable anymore or much harder to reprogram um",
    "start": "2285680",
    "end": "2293359"
  },
  {
    "text": "code signing is the established method to uh to for the the um vendor to vouch",
    "start": "2293359",
    "end": "2298720"
  },
  {
    "text": "that this is a benign non-malicious firmware and then the the signature u is",
    "start": "2298720",
    "end": "2303839"
  },
  {
    "text": "tested by the USB device before it flashes this new firmware supposedly such controller chips exist even from",
    "start": "2303839",
    "end": "2309760"
  },
  {
    "text": "the companies where we reverse engineer the controllers um but they're telling us that those are not popular in the",
    "start": "2309760",
    "end": "2315599"
  },
  {
    "text": "market um perhaps because of cost perhaps because there isn't an established PKI where sub vendors could",
    "start": "2315599",
    "end": "2322640"
  },
  {
    "text": "then be assigned signing certificates and all so for whatever reason this doesn't seem to be a near-term solution",
    "start": "2322640",
    "end": "2328960"
  },
  {
    "text": "either um which leaves one very easy idea and that is just lock your firmware down in the in the factory the last",
    "start": "2328960",
    "end": "2336240"
  },
  {
    "text": "thing you do after flashing and testing your firmware flip a switch and make",
    "start": "2336240",
    "end": "2341280"
  },
  {
    "text": "sure it's not going to be reprogrammed again very easy solution um and something that uh Jeff uh noted in his",
    "start": "2341280",
    "end": "2348720"
  },
  {
    "text": "um in his keynote was something that we had in biases um um physically as a",
    "start": "2348720",
    "end": "2354480"
  },
  {
    "text": "switch but you can just as well make this a software switch and basically a fuse you burn it once never go back",
    "start": "2354480",
    "end": "2359920"
  },
  {
    "text": "right um so this is something that I would like to see in USB devices and audited by many of you um so that we can",
    "start": "2359920",
    "end": "2368000"
  },
  {
    "text": "uh conquer back a a little sphere of trusted USB devices where we say this exact controller chip was this fuse",
    "start": "2368000",
    "end": "2374800"
  },
  {
    "text": "blown cannot be reprogrammed so if you plug it into a computer you can you can",
    "start": "2374800",
    "end": "2380240"
  },
  {
    "text": "be assured that it acts as a thumb drive and not as a keyboard right um so hopefully we can we can all together",
    "start": "2380240",
    "end": "2386800"
  },
  {
    "text": "work towards such devices you drive demand and we show how they're still uh",
    "start": "2386800",
    "end": "2392040"
  },
  {
    "text": "breakable um now um I didn't want to leave on such a such a depressing note",
    "start": "2392040",
    "end": "2398480"
  },
  {
    "text": "that there is uh there is really no defense from this right now um so here here's the upside of all of this open",
    "start": "2398480",
    "end": "2404480"
  },
  {
    "start": "2402000",
    "end": "2579000"
  },
  {
    "text": "open hardware right you have chips and you can do with them whatever you want um and this is actually how we got",
    "start": "2404480",
    "end": "2410160"
  },
  {
    "text": "started on this whole idea of reprogramming USB controller chips um we",
    "start": "2410160",
    "end": "2415599"
  },
  {
    "text": "uh we had this issue of of of uh uh GSM rainbow tables you may remember that I",
    "start": "2415599",
    "end": "2422160"
  },
  {
    "text": "presented that yeah uh years ago uh and so we use those to crack GSM calls it",
    "start": "2422160",
    "end": "2427920"
  },
  {
    "text": "just takes forever to crack a call uh because what what happens um is these these rainbow tables in our case are two",
    "start": "2427920",
    "end": "2434280"
  },
  {
    "text": "terabytes um you um you you you have to search them many times like 10,000 times",
    "start": "2434280",
    "end": "2441040"
  },
  {
    "text": "and every search looks like you have a little string and then you look up in memory in RAM where where this string",
    "start": "2441040",
    "end": "2447280"
  },
  {
    "text": "could be in your rainbow table you get the approximate region you read back that region you go through the region",
    "start": "2447280",
    "end": "2452640"
  },
  {
    "text": "you search for the string in most cases you don't find it take the next string and you do that 10,000 times and then",
    "start": "2452640",
    "end": "2458240"
  },
  {
    "text": "you find the string bingo you crack a GSM call now this is very simple work to",
    "start": "2458240",
    "end": "2463920"
  },
  {
    "text": "take to take a blob of data and compare it with a string and this is data that",
    "start": "2463920",
    "end": "2469680"
  },
  {
    "text": "we outsource to the USB controller chips so these are some some 100 USB sticks",
    "start": "2469680",
    "end": "2475599"
  },
  {
    "text": "connected to one computer and they're all working in parallel um comparing data now we noticed though when we",
    "start": "2475599",
    "end": "2482800"
  },
  {
    "text": "finished this that it's not actually giving us a performance boost it does solve the previous bottleneck this was",
    "start": "2482800",
    "end": "2488319"
  },
  {
    "text": "communication between our our hard disks or SSDs with the host just those",
    "start": "2488319",
    "end": "2493760"
  },
  {
    "text": "interfaces are are clocked soon but it introduced a new bottleneck these USB controller chips are just not fast",
    "start": "2493760",
    "end": "2499760"
  },
  {
    "text": "enough these old controller chips we noticed that the the newer chip we reverse engineered is much much faster",
    "start": "2499760",
    "end": "2505920"
  },
  {
    "text": "so um that there would be hope for us again to to speed up our GSM cracking but that's so long past we're probably",
    "start": "2505920",
    "end": "2511599"
  },
  {
    "text": "not going to revisit that but if you have a database application um that works on very simple uh instruction and",
    "start": "2511599",
    "end": "2518960"
  },
  {
    "text": "mostly comes back with nothing you need basically a prefiltering this would be great and you cannot just do it on USB",
    "start": "2518960",
    "end": "2525440"
  },
  {
    "text": "thumb drives you can do it on on SATA controllers so SATA to USB bridges so",
    "start": "2525440",
    "end": "2530560"
  },
  {
    "text": "you can actually connect an SSD or something proper behind this right um other people are also looking into how",
    "start": "2530560",
    "end": "2536720"
  },
  {
    "text": "to repurpose these controller chips constructively uh there's one one project in particular Flow Switch um",
    "start": "2536720",
    "end": "2544000"
  },
  {
    "text": "they're looking into building a very very cheap FPGA to USB3 bridge so those",
    "start": "2544000",
    "end": "2549520"
  },
  {
    "text": "chips are typically expensive at least the ones that are popular in FPGA design and they want to repurpose one of these",
    "start": "2549520",
    "end": "2555200"
  },
  {
    "text": "existing u couple sense type chips um so there's definitely a case to be made for",
    "start": "2555200",
    "end": "2560240"
  },
  {
    "text": "open hardware um and people playing around with hardware but absolutely not in trusted environments so there needs",
    "start": "2560240",
    "end": "2566720"
  },
  {
    "text": "to be some some line drawn somewhere between hardware that is repurposable and hardware that can be trusted to be",
    "start": "2566720",
    "end": "2573359"
  },
  {
    "text": "swapped between computers that you that you don't implicitly trust um all right",
    "start": "2573359",
    "end": "2578400"
  },
  {
    "text": "with that that thank you very much for your attention [Applause]",
    "start": "2578400",
    "end": "2585760"
  },
  {
    "start": "2579000",
    "end": "2670000"
  },
  {
    "text": "[Applause] any questions",
    "start": "2588020",
    "end": "2595640"
  },
  {
    "text": "xbox we don't want to blame any one vendor so",
    "start": "2597440",
    "end": "2602880"
  },
  {
    "text": "we're not we're not yet yet telling which ones but they did get pretty",
    "start": "2602880",
    "end": "2608680"
  },
  {
    "text": "angry in Taipei um any other questions go ahead",
    "start": "2608680",
    "end": "2616160"
  },
  {
    "text": "do you also modify USB oh do we modify USB hubs uh not because they're they're",
    "start": "2616160",
    "end": "2622640"
  },
  {
    "text": "really just transparent hubs like in a in a they also have this oh interesting so",
    "start": "2622640",
    "end": "2629760"
  },
  {
    "text": "can you modify USB hub to become a device uh that's an interesting question we have not investigated that but",
    "start": "2629760",
    "end": "2635520"
  },
  {
    "text": "there's certainly controllers in there i feel like they're more uh they're more fit for purpose right",
    "start": "2635520",
    "end": "2643720"
  },
  {
    "text": "right yes good question so in in in the first two demos in fact um of course we",
    "start": "2651119",
    "end": "2656720"
  },
  {
    "text": "are installing software that then runs on a computer right um as I said this is an infection method this is not an",
    "start": "2656720",
    "end": "2663599"
  },
  {
    "text": "exploitation method so throw in your exploitation method that you made sure virus scanners don't detect and you're",
    "start": "2663599",
    "end": "2668960"
  },
  {
    "text": "good but you still need that second",
    "start": "2668960",
    "end": "2672240"
  }
]