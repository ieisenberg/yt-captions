[
  {
    "text": "okay good afternoon everyone my name is",
    "start": "30",
    "end": "2399"
  },
  {
    "text": "Chris branch I'm a systems engineer",
    "start": "2399",
    "end": "4170"
  },
  {
    "text": "working for CloudFlare which is an",
    "start": "4170",
    "end": "5879"
  },
  {
    "text": "internet security and performance",
    "start": "5879",
    "end": "7770"
  },
  {
    "text": "company I'm substituting for John Graham",
    "start": "7770",
    "end": "11190"
  },
  {
    "text": "coming who couldn't be here today here's",
    "start": "11190",
    "end": "13170"
  },
  {
    "text": "a CTO of CloudFlare and my diet bot I",
    "start": "13170",
    "end": "16650"
  },
  {
    "text": "normally focus on the implementation so",
    "start": "16650",
    "end": "19289"
  },
  {
    "text": "as far as I see web attacks there are",
    "start": "19289",
    "end": "21330"
  },
  {
    "text": "ways to prevent the botnet getting",
    "start": "21330",
    "end": "22529"
  },
  {
    "text": "bigger but we felt it would be",
    "start": "22529",
    "end": "24359"
  },
  {
    "text": "interesting to show you some of the",
    "start": "24359",
    "end": "26340"
  },
  {
    "text": "things that people actually do given an",
    "start": "26340",
    "end": "28859"
  },
  {
    "text": "arbitrary code execution vulnerability",
    "start": "28859",
    "end": "31590"
  },
  {
    "text": "what do people actually do with that",
    "start": "31590",
    "end": "33210"
  },
  {
    "text": "power is it just shell codes or is it",
    "start": "33210",
    "end": "34829"
  },
  {
    "text": "something more",
    "start": "34829",
    "end": "37160"
  },
  {
    "text": "so cloud flow is in the unique position",
    "start": "37940",
    "end": "40350"
  },
  {
    "text": "of being alpha see all these attacks as",
    "start": "40350",
    "end": "42450"
  },
  {
    "text": "it stops them flare flow is one is",
    "start": "42450",
    "end": "45090"
  },
  {
    "text": "largest DNS server and caching reverse",
    "start": "45090",
    "end": "47340"
  },
  {
    "text": "proxy deployments worldwide an important",
    "start": "47340",
    "end": "49860"
  },
  {
    "text": "part of our security is the West the Web",
    "start": "49860",
    "end": "53010"
  },
  {
    "text": "Application Firewall it blocks attacks",
    "start": "53010",
    "end": "55500"
  },
  {
    "text": "that match a particular type atom and",
    "start": "55500",
    "end": "57379"
  },
  {
    "text": "prevent them from reaching the origin",
    "start": "57379",
    "end": "59430"
  },
  {
    "text": "server and prevent it from compromised",
    "start": "59430",
    "end": "61760"
  },
  {
    "text": "we see a lots of attacks from attack",
    "start": "61760",
    "end": "64619"
  },
  {
    "text": "assem attacking to have some frequency",
    "start": "64619",
    "end": "66570"
  },
  {
    "text": "blocker we also see a lot of people",
    "start": "66570",
    "end": "69540"
  },
  {
    "text": "trying old attacks as well as the newest",
    "start": "69540",
    "end": "71729"
  },
  {
    "text": "ones that we see CBS 4 so today we're",
    "start": "71729",
    "end": "75450"
  },
  {
    "text": "going to talk about two particularly",
    "start": "75450",
    "end": "76950"
  },
  {
    "text": "high profile attacks one from two years",
    "start": "76950",
    "end": "78750"
  },
  {
    "text": "ago which is shell shop and one from",
    "start": "78750",
    "end": "81330"
  },
  {
    "text": "nifty earlier this year which is image",
    "start": "81330",
    "end": "82890"
  },
  {
    "text": "tragic",
    "start": "82890",
    "end": "83460"
  },
  {
    "text": "they're both arbitrary code execution",
    "start": "83460",
    "end": "85560"
  },
  {
    "text": "vulnerabilities so it's come from",
    "start": "85560",
    "end": "87689"
  },
  {
    "text": "trusting user input when they shouldn't",
    "start": "87689",
    "end": "89280"
  },
  {
    "text": "do but there isn't a high profile is",
    "start": "89280",
    "end": "91590"
  },
  {
    "text": "because they're extremely easy to",
    "start": "91590",
    "end": "93000"
  },
  {
    "text": "exploit and a lot software is vulnerable",
    "start": "93000",
    "end": "95460"
  },
  {
    "text": "in the shell shock its own lines because",
    "start": "95460",
    "end": "98790"
  },
  {
    "text": "it affects the bash bourne-again shell",
    "start": "98790",
    "end": "102409"
  },
  {
    "text": "it's actually a very old bug but the",
    "start": "102409",
    "end": "105689"
  },
  {
    "text": "implications were only probably diseased",
    "start": "105689",
    "end": "107670"
  },
  {
    "text": "about two years ago",
    "start": "107670",
    "end": "109220"
  },
  {
    "text": "it's caused by a fairly obscure feature",
    "start": "109220",
    "end": "112020"
  },
  {
    "text": "in bash which lets you export functions",
    "start": "112020",
    "end": "114030"
  },
  {
    "text": "as environment variables they can be",
    "start": "114030",
    "end": "116009"
  },
  {
    "text": "executed by a child process this command",
    "start": "116009",
    "end": "119880"
  },
  {
    "text": "line here will show you if you're",
    "start": "119880",
    "end": "121770"
  },
  {
    "text": "vulnerable wires to shell shock and if",
    "start": "121770",
    "end": "124079"
  },
  {
    "text": "you're vulnerable it will execute the",
    "start": "124079",
    "end": "126540"
  },
  {
    "text": "echo vulnerable and put in volleyball",
    "start": "126540",
    "end": "128099"
  },
  {
    "text": "before execute the actual commands you",
    "start": "128099",
    "end": "130020"
  },
  {
    "text": "intend to execute",
    "start": "130020",
    "end": "133009"
  },
  {
    "text": "normally you export an exsisting",
    "start": "133140",
    "end": "135820"
  },
  {
    "text": "function definition in bash fires and",
    "start": "135820",
    "end": "137710"
  },
  {
    "text": "the export commands you say export - f",
    "start": "137710",
    "end": "139780"
  },
  {
    "text": "and then the name of an existing",
    "start": "139780",
    "end": "140920"
  },
  {
    "text": "function but environment variable was",
    "start": "140920",
    "end": "143620"
  },
  {
    "text": "ultimately just strings so nothing stops",
    "start": "143620",
    "end": "146470"
  },
  {
    "text": "you from crossing a function definition",
    "start": "146470",
    "end": "147940"
  },
  {
    "text": "in the exact same way that flash does",
    "start": "147940",
    "end": "150960"
  },
  {
    "text": "when bash the sex the photo shoot an",
    "start": "150960",
    "end": "153790"
  },
  {
    "text": "environment variable that looks like a",
    "start": "153790",
    "end": "155140"
  },
  {
    "text": "function definition such as one at the",
    "start": "155140",
    "end": "157360"
  },
  {
    "text": "top it will execute the environment",
    "start": "157360",
    "end": "159910"
  },
  {
    "text": "variable as a command line and when bash",
    "start": "159910",
    "end": "163060"
  },
  {
    "text": "does it that's fine because the only",
    "start": "163060",
    "end": "164710"
  },
  {
    "text": "thing that in that environment variable",
    "start": "164710",
    "end": "166030"
  },
  {
    "text": "is a function definition nothing",
    "start": "166030",
    "end": "167970"
  },
  {
    "text": "afterwards so no side-effects but as the",
    "start": "167970",
    "end": "171760"
  },
  {
    "text": "human use mash we can do more than that",
    "start": "171760",
    "end": "173620"
  },
  {
    "text": "we can append arbitrary commands to it",
    "start": "173620",
    "end": "176920"
  },
  {
    "text": "as in the second case and then when you",
    "start": "176920",
    "end": "180190"
  },
  {
    "text": "execute bash bash you'll look for",
    "start": "180190",
    "end": "182410"
  },
  {
    "text": "environment variables that look like",
    "start": "182410",
    "end": "184150"
  },
  {
    "text": "function definitions and execute this",
    "start": "184150",
    "end": "186100"
  },
  {
    "text": "command line and then we're not good and",
    "start": "186100",
    "end": "191020"
  },
  {
    "text": "caused by trusting user input when it",
    "start": "191020",
    "end": "193390"
  },
  {
    "text": "probably shouldn't have done now how",
    "start": "193390",
    "end": "196480"
  },
  {
    "text": "does it affect the web the examples",
    "start": "196480",
    "end": "198010"
  },
  {
    "text": "before you already has show access you",
    "start": "198010",
    "end": "200890"
  },
  {
    "text": "could execute in mind yourself if you",
    "start": "200890",
    "end": "202450"
  },
  {
    "text": "wanted but imagine if it was if the",
    "start": "202450",
    "end": "205660"
  },
  {
    "text": "environment was passed and more",
    "start": "205660",
    "end": "207100"
  },
  {
    "text": "privileged process like you each ones do",
    "start": "207100",
    "end": "209410"
  },
  {
    "text": "do or if you got to remote server to",
    "start": "209410",
    "end": "212709"
  },
  {
    "text": "execute the function to an environment",
    "start": "212709",
    "end": "215290"
  },
  {
    "text": "variable unfortunately for us this is",
    "start": "215290",
    "end": "218080"
  },
  {
    "text": "exactly what the CGI specification does",
    "start": "218080",
    "end": "220450"
  },
  {
    "text": "it passes HTTP request headers as",
    "start": "220450",
    "end": "223420"
  },
  {
    "text": "environment variables things like user",
    "start": "223420",
    "end": "226180"
  },
  {
    "text": "agents refer content type so as soon as",
    "start": "226180",
    "end": "229959"
  },
  {
    "text": "you run a shell from the CGI scripts",
    "start": "229959",
    "end": "232209"
  },
  {
    "text": "that's in heavens the parent environment",
    "start": "232209",
    "end": "234280"
  },
  {
    "text": "you are vulnerable to shell shock things",
    "start": "234280",
    "end": "237520"
  },
  {
    "text": "spawn abilities include but are not",
    "start": "237520",
    "end": "239830"
  },
  {
    "text": "limited to remotely ejecting the DVD on",
    "start": "239830",
    "end": "241959"
  },
  {
    "text": "their web server this is a natural",
    "start": "241959",
    "end": "244420"
  },
  {
    "text": "request that CloudFlare some blocks but",
    "start": "244420",
    "end": "247180"
  },
  {
    "text": "you can imagine much more evil exploit",
    "start": "247180",
    "end": "250060"
  },
  {
    "text": "from happen so when the CD is released",
    "start": "250060",
    "end": "255580"
  },
  {
    "text": "we rolled out to west wall for our",
    "start": "255580",
    "end": "257140"
  },
  {
    "text": "paying customers so they were Emilia",
    "start": "257140",
    "end": "260709"
  },
  {
    "text": "text from Michelle shop if even if they",
    "start": "260710",
    "end": "262630"
  },
  {
    "text": "hadn't catch",
    "start": "262630",
    "end": "263520"
  },
  {
    "text": "and once we established it the rules",
    "start": "263520",
    "end": "266490"
  },
  {
    "text": "good sweet fun is it to our free",
    "start": "266490",
    "end": "267900"
  },
  {
    "text": "customers to better protect the internet",
    "start": "267900",
    "end": "270289"
  },
  {
    "text": "at the same time you also measure the",
    "start": "270289",
    "end": "272669"
  },
  {
    "text": "amount of attack attempts we saw trying",
    "start": "272669",
    "end": "275610"
  },
  {
    "text": "to exploit the shell shop from ability",
    "start": "275610",
    "end": "277669"
  },
  {
    "text": "as soon as we turned on we saw tens of",
    "start": "277669",
    "end": "280380"
  },
  {
    "text": "fifteen facts per second with occasional",
    "start": "280380",
    "end": "282150"
  },
  {
    "text": "bursts of activity as a specific website",
    "start": "282150",
    "end": "284130"
  },
  {
    "text": "was targeted even survey 30 years later",
    "start": "284130",
    "end": "286889"
  },
  {
    "text": "is typically around five attacks a day",
    "start": "286889",
    "end": "291020"
  },
  {
    "text": "so the subject what the reactions what",
    "start": "291020",
    "end": "294090"
  },
  {
    "text": "do we actually see what did people do",
    "start": "294090",
    "end": "295680"
  },
  {
    "text": "with our three code execution well apart",
    "start": "295680",
    "end": "299099"
  },
  {
    "text": "from injecting CD drive and other",
    "start": "299099",
    "end": "300810"
  },
  {
    "text": "physical strengths lots of things like",
    "start": "300810",
    "end": "303720"
  },
  {
    "text": "data exfiltration so guessing accesses",
    "start": "303720",
    "end": "306990"
  },
  {
    "text": "nobody or subs WIB laser is one thing",
    "start": "306990",
    "end": "309360"
  },
  {
    "text": "but you want to try and find a root user",
    "start": "309360",
    "end": "311099"
  },
  {
    "text": "and exploit system that way the hope",
    "start": "311099",
    "end": "314490"
  },
  {
    "text": "here in the first command is that the",
    "start": "314490",
    "end": "316169"
  },
  {
    "text": "standardout will contain the password",
    "start": "316169",
    "end": "319169"
  },
  {
    "text": "file somewhere in the HTTP response not",
    "start": "319169",
    "end": "322440"
  },
  {
    "text": "everyone was confident about like",
    "start": "322440",
    "end": "323639"
  },
  {
    "text": "working so they opted to email",
    "start": "323639",
    "end": "325590"
  },
  {
    "text": "themselves data instead many attacks",
    "start": "325590",
    "end": "330419"
  },
  {
    "text": "that we see are simple reconnaissance",
    "start": "330419",
    "end": "331949"
  },
  {
    "text": "and the attacker will make a victim",
    "start": "331949",
    "end": "334050"
  },
  {
    "text": "server contact the server under their",
    "start": "334050",
    "end": "335610"
  },
  {
    "text": "control with a stream identifying the",
    "start": "335610",
    "end": "337770"
  },
  {
    "text": "web science",
    "start": "337770",
    "end": "338360"
  },
  {
    "text": "so this first attack uses pink and",
    "start": "338360",
    "end": "341520"
  },
  {
    "text": "encodes a payload in the ICMP packet the",
    "start": "341520",
    "end": "344820"
  },
  {
    "text": "second uses a usually HTTP request in",
    "start": "344820",
    "end": "348030"
  },
  {
    "text": "either case the attacker will look",
    "start": "348030",
    "end": "349650"
  },
  {
    "text": "through the logs and correlate IP",
    "start": "349650",
    "end": "352080"
  },
  {
    "text": "address making these requests with the",
    "start": "352080",
    "end": "354199"
  },
  {
    "text": "websites that were attacked this is a",
    "start": "354199",
    "end": "358889"
  },
  {
    "text": "particular problem for a service by",
    "start": "358889",
    "end": "360569"
  },
  {
    "text": "CloudFlare um the way the reverse",
    "start": "360569",
    "end": "363300"
  },
  {
    "text": "caching proxy works is we send the",
    "start": "363300",
    "end": "365520"
  },
  {
    "text": "request to us which obscures the origin",
    "start": "365520",
    "end": "367469"
  },
  {
    "text": "IP address if the origin IP address is",
    "start": "367469",
    "end": "370349"
  },
  {
    "text": "revealed then our deal off session could",
    "start": "370349",
    "end": "372509"
  },
  {
    "text": "be circumvented by attacking the origin",
    "start": "372509",
    "end": "374159"
  },
  {
    "text": "directly so we can only hope these were",
    "start": "374159",
    "end": "376710"
  },
  {
    "text": "more innocuous white hats attempt to",
    "start": "376710",
    "end": "378780"
  },
  {
    "text": "identify site and depending on the setup",
    "start": "378780",
    "end": "382889"
  },
  {
    "text": "of the web server this particular",
    "start": "382889",
    "end": "385259"
  },
  {
    "text": "example where we sleep sophistical",
    "start": "385259",
    "end": "386969"
  },
  {
    "text": "minutes could be a denial service",
    "start": "386969",
    "end": "388669"
  },
  {
    "text": "imagine if you will you have an old",
    "start": "388669",
    "end": "390990"
  },
  {
    "text": "Apache version with a fix workup or",
    "start": "390990",
    "end": "393270"
  },
  {
    "text": "processes",
    "start": "393270",
    "end": "394950"
  },
  {
    "text": "if you block the request by speaking for",
    "start": "394950",
    "end": "396780"
  },
  {
    "text": "a minute then after a few requests you",
    "start": "396780",
    "end": "398910"
  },
  {
    "text": "can completely exhaust the poor work",
    "start": "398910",
    "end": "401160"
  },
  {
    "text": "processes and deny service to anyone",
    "start": "401160",
    "end": "402930"
  },
  {
    "text": "else it could also be just out spam way",
    "start": "402930",
    "end": "407550"
  },
  {
    "text": "of determining if the server responds or",
    "start": "407550",
    "end": "409290"
  },
  {
    "text": "not by seeing if the request one is",
    "start": "409290",
    "end": "411420"
  },
  {
    "text": "lower than normal",
    "start": "411420",
    "end": "413720"
  },
  {
    "text": "look why limit yourself to one come on",
    "start": "413720",
    "end": "416160"
  },
  {
    "text": "she'll go to what we all expecting and",
    "start": "416160",
    "end": "418220"
  },
  {
    "text": "but there's more than one way to skin",
    "start": "418220",
    "end": "420240"
  },
  {
    "text": "again most people was playfully assumed",
    "start": "420240",
    "end": "423750"
  },
  {
    "text": "that pole is going to be installed on",
    "start": "423750",
    "end": "425340"
  },
  {
    "text": "any web server probably right especially",
    "start": "425340",
    "end": "427500"
  },
  {
    "text": "if there's a second CGI a more",
    "start": "427500",
    "end": "430590"
  },
  {
    "text": "interesting attack we saw was someone",
    "start": "430590",
    "end": "432360"
  },
  {
    "text": "trying to masquerade as the prime IV of",
    "start": "432360",
    "end": "434700"
  },
  {
    "text": "data service the irony is versus admin",
    "start": "434700",
    "end": "438510"
  },
  {
    "text": "scene is in their list of processes is",
    "start": "438510",
    "end": "440790"
  },
  {
    "text": "they might not choose to close it",
    "start": "440790",
    "end": "442380"
  },
  {
    "text": "because they want to make sure they're",
    "start": "442380",
    "end": "443580"
  },
  {
    "text": "protected by antivirus menacing when",
    "start": "443580",
    "end": "445680"
  },
  {
    "text": "actually just like and malware",
    "start": "445680",
    "end": "449419"
  },
  {
    "text": "so the path passes that we commonly saw",
    "start": "450290",
    "end": "454260"
  },
  {
    "text": "attacked or the route which makes sense",
    "start": "454260",
    "end": "456000"
  },
  {
    "text": "and we also see some more specific",
    "start": "456000",
    "end": "458670"
  },
  {
    "text": "patterns you actually see if you search",
    "start": "458670",
    "end": "461220"
  },
  {
    "text": "for some of these as shellshock malware",
    "start": "461220",
    "end": "464040"
  },
  {
    "text": "which is packaged in that to the attack",
    "start": "464040",
    "end": "465480"
  },
  {
    "text": "sees past as well which is probably what",
    "start": "465480",
    "end": "468570"
  },
  {
    "text": "the common types mail but these paths",
    "start": "468570",
    "end": "472770"
  },
  {
    "text": "match pretty closely to the Barracuda",
    "start": "472770",
    "end": "475320"
  },
  {
    "text": "firewall appliance and cpanel",
    "start": "475320",
    "end": "477240"
  },
  {
    "text": "installations the danger that we have",
    "start": "477240",
    "end": "480570"
  },
  {
    "text": "two years on from the initial",
    "start": "480570",
    "end": "483600"
  },
  {
    "text": "vulnerability when hopefully everyone is",
    "start": "483600",
    "end": "485310"
  },
  {
    "text": "patched is hardware prices might not be",
    "start": "485310",
    "end": "487560"
  },
  {
    "text": "patched if you plug in the science that",
    "start": "487560",
    "end": "489810"
  },
  {
    "text": "is made two years ago and you have an",
    "start": "489810",
    "end": "491160"
  },
  {
    "text": "updates that yet then there's a little",
    "start": "491160",
    "end": "492510"
  },
  {
    "text": "possibility that it gets compromised by",
    "start": "492510",
    "end": "494370"
  },
  {
    "text": "shell shock and as assuming you even",
    "start": "494370",
    "end": "496800"
  },
  {
    "text": "have a way to update it so let's move on",
    "start": "496800",
    "end": "501420"
  },
  {
    "text": "to a more recent foldability",
    "start": "501420",
    "end": "502710"
  },
  {
    "text": "english tragic the author's felt the you",
    "start": "502710",
    "end": "507120"
  },
  {
    "text": "your bugs wouldn't be taken seriously",
    "start": "507120",
    "end": "508740"
  },
  {
    "text": "and as it had a cool name and logo",
    "start": "508740",
    "end": "510470"
  },
  {
    "text": "probably ryan and when it was revealed",
    "start": "510470",
    "end": "514950"
  },
  {
    "text": "the similarities to shell shock were as",
    "start": "514950",
    "end": "518430"
  },
  {
    "text": "widespread",
    "start": "518430",
    "end": "520140"
  },
  {
    "text": "the reason is similar is the ubiquity of",
    "start": "520140",
    "end": "522450"
  },
  {
    "text": "the compromised software many web",
    "start": "522450",
    "end": "524400"
  },
  {
    "text": "applications use image magic for image",
    "start": "524400",
    "end": "526230"
  },
  {
    "text": "processing it has bindings to pop",
    "start": "526230",
    "end": "528390"
  },
  {
    "text": "the languages and frameworks and because",
    "start": "528390",
    "end": "531690"
  },
  {
    "text": "it is another example of an arbitrary",
    "start": "531690",
    "end": "533820"
  },
  {
    "text": "code execution it may not be as simple",
    "start": "533820",
    "end": "536550"
  },
  {
    "text": "with sending a specially crafted HTTP",
    "start": "536550",
    "end": "539580"
  },
  {
    "text": "header you have to find delete an HTML",
    "start": "539580",
    "end": "542370"
  },
  {
    "text": "form and upload it and hope the",
    "start": "542370",
    "end": "544170"
  },
  {
    "text": "application will insert it as an image",
    "start": "544170",
    "end": "546020"
  },
  {
    "text": "but that's still not too difficult to",
    "start": "546020",
    "end": "549060"
  },
  {
    "text": "achieve as long as you've got a payload",
    "start": "549060",
    "end": "553520"
  },
  {
    "text": "so a common way that you might exploit a",
    "start": "554510",
    "end": "558450"
  },
  {
    "text": "website is by looking at open source",
    "start": "558450",
    "end": "561510"
  },
  {
    "text": "software that actually uses image magic",
    "start": "561510",
    "end": "563160"
  },
  {
    "text": "and there's a large class of software's",
    "start": "563160",
    "end": "565770"
  },
  {
    "text": "up fallens blogs CMS's and obviously",
    "start": "565770",
    "end": "569340"
  },
  {
    "text": "photo uploading sites so the what makes",
    "start": "569340",
    "end": "573660"
  },
  {
    "text": "is easy for the attacker is they can",
    "start": "573660",
    "end": "575220"
  },
  {
    "text": "craft an exploit for a particular",
    "start": "575220",
    "end": "576870"
  },
  {
    "text": "software package and once they've done",
    "start": "576870",
    "end": "579090"
  },
  {
    "text": "that some hundreds and thousands",
    "start": "579090",
    "end": "581130"
  },
  {
    "text": "websites are vulnerable so how does it",
    "start": "581130",
    "end": "585300"
  },
  {
    "text": "actually happen",
    "start": "585300",
    "end": "586140"
  },
  {
    "text": "the problem is introduced by image",
    "start": "586140",
    "end": "588180"
  },
  {
    "text": "magics magic if versus this file was",
    "start": "588180",
    "end": "591000"
  },
  {
    "text": "using the external commands it defines",
    "start": "591000",
    "end": "593820"
  },
  {
    "text": "the commands that are used for different",
    "start": "593820",
    "end": "595730"
  },
  {
    "text": "codecs in an external file core",
    "start": "595730",
    "end": "598440"
  },
  {
    "text": "delegates that XML to dreams fine",
    "start": "598440",
    "end": "602960"
  },
  {
    "text": "unfortunately because these are actual",
    "start": "603110",
    "end": "605490"
  },
  {
    "text": "command strings you have to be quite",
    "start": "605490",
    "end": "606840"
  },
  {
    "text": "careful in much the same way that you",
    "start": "606840",
    "end": "608580"
  },
  {
    "text": "have to be careful when constructing",
    "start": "608580",
    "end": "610080"
  },
  {
    "text": "sequel queries in this particular HTTP",
    "start": "610080",
    "end": "613230"
  },
  {
    "text": "codec we weren't careful the % parameter",
    "start": "613230",
    "end": "615930"
  },
  {
    "text": "was not adequately quoted double quotes",
    "start": "615930",
    "end": "617760"
  },
  {
    "text": "format escapes so this allows you to",
    "start": "617760",
    "end": "621120"
  },
  {
    "text": "break out imagine you starts off with a",
    "start": "621120",
    "end": "623580"
  },
  {
    "text": "legit looking URL and then append your",
    "start": "623580",
    "end": "627510"
  },
  {
    "text": "own custom code here's an example of a",
    "start": "627510",
    "end": "632160"
  },
  {
    "text": "malicious as you please starts off",
    "start": "632160",
    "end": "634530"
  },
  {
    "text": "innocuously but here in verse we have",
    "start": "634530",
    "end": "637230"
  },
  {
    "text": "the image type which references an",
    "start": "637230",
    "end": "639990"
  },
  {
    "text": "external resource effort not quite at",
    "start": "639990",
    "end": "642900"
  },
  {
    "text": "the ends we break out of the quoting and",
    "start": "642900",
    "end": "646710"
  },
  {
    "text": "we list become a directory content if",
    "start": "646710",
    "end": "651000"
  },
  {
    "text": "you copy that and save it to a file try",
    "start": "651000",
    "end": "653940"
  },
  {
    "text": "to run it through image magic you'll see",
    "start": "653940",
    "end": "655980"
  },
  {
    "text": "this it will list the current directory",
    "start": "655980",
    "end": "658530"
  },
  {
    "text": "content as well as convert your file",
    "start": "658530",
    "end": "662660"
  },
  {
    "text": "many of the problems were not SVG they",
    "start": "662930",
    "end": "666329"
  },
  {
    "text": "were actually caused by MVG which are",
    "start": "666329",
    "end": "668759"
  },
  {
    "text": "magic crates or graphics now this is a",
    "start": "668759",
    "end": "670800"
  },
  {
    "text": "language designed by the image magic",
    "start": "670800",
    "end": "672750"
  },
  {
    "text": "implementers used to generate images in",
    "start": "672750",
    "end": "675690"
  },
  {
    "text": "a more convenient way on the command",
    "start": "675690",
    "end": "677220"
  },
  {
    "text": "line or in the file unfortunately they",
    "start": "677220",
    "end": "679889"
  },
  {
    "text": "have a lot of capabilities which have",
    "start": "679889",
    "end": "681779"
  },
  {
    "text": "not suitable for user inputs so one more",
    "start": "681779",
    "end": "686100"
  },
  {
    "text": "example is it can download arbitrary",
    "start": "686100",
    "end": "688529"
  },
  {
    "text": "files off the internet not great can",
    "start": "688529",
    "end": "691139"
  },
  {
    "text": "also call it server side request",
    "start": "691139",
    "end": "692519"
  },
  {
    "text": "forgeries it also has a few custom",
    "start": "692519",
    "end": "695459"
  },
  {
    "text": "schemes so here we have one for having a",
    "start": "695459",
    "end": "698310"
  },
  {
    "text": "sentry file what do you do after",
    "start": "698310",
    "end": "699899"
  },
  {
    "text": "assembly file you delete it not good you",
    "start": "699899",
    "end": "704910"
  },
  {
    "text": "can also use it to read files so if you",
    "start": "704910",
    "end": "707730"
  },
  {
    "text": "have a text file you want to output it",
    "start": "707730",
    "end": "709500"
  },
  {
    "text": "as you take seems convenient",
    "start": "709500",
    "end": "711060"
  },
  {
    "text": "unless that text file is a list of all",
    "start": "711060",
    "end": "713100"
  },
  {
    "text": "your usernames we designed a way to",
    "start": "713100",
    "end": "717779"
  },
  {
    "text": "block this in our way here is the rate",
    "start": "717779",
    "end": "721110"
  },
  {
    "text": "expression and it's easier to digest",
    "start": "721110",
    "end": "723410"
  },
  {
    "text": "state machine form essentially what we",
    "start": "723410",
    "end": "727829"
  },
  {
    "text": "try to do is block both SVG and nvg so",
    "start": "727829",
    "end": "731220"
  },
  {
    "text": "the first first two lines will block",
    "start": "731220",
    "end": "734420"
  },
  {
    "text": "HTTP requests using the official mp3 and",
    "start": "734420",
    "end": "738060"
  },
  {
    "text": "a second to revenge the data",
    "start": "738060",
    "end": "739410"
  },
  {
    "text": "exfiltration and deletion",
    "start": "739410",
    "end": "740880"
  },
  {
    "text": "vulnerabilities apply only here's the",
    "start": "740880",
    "end": "747750"
  },
  {
    "text": "most popular payload you saw using MV g",
    "start": "747750",
    "end": "750029"
  },
  {
    "text": "and not s teaching it is similar to the",
    "start": "750029",
    "end": "753569"
  },
  {
    "text": "reconnaissance attacks used in the show",
    "start": "753569",
    "end": "755430"
  },
  {
    "text": "shop vulnerability the image didn't",
    "start": "755430",
    "end": "759630"
  },
  {
    "text": "exist so if you actually try to run this",
    "start": "759630",
    "end": "762750"
  },
  {
    "text": "as a MV g I convert this mu G it would",
    "start": "762750",
    "end": "765449"
  },
  {
    "text": "look like the file it was reference X X",
    "start": "765449",
    "end": "767639"
  },
  {
    "text": "it would also make a callback to the",
    "start": "767639",
    "end": "770160"
  },
  {
    "text": "attackers the main the second favorite",
    "start": "770160",
    "end": "774930"
  },
  {
    "text": "was actually SVG because it's kept this",
    "start": "774930",
    "end": "778050"
  },
  {
    "text": "possible view table",
    "start": "778050",
    "end": "779670"
  },
  {
    "text": "codecs which you don't use for example",
    "start": "779670",
    "end": "781769"
  },
  {
    "text": "in v3",
    "start": "781769",
    "end": "783389"
  },
  {
    "text": "there's probably more access from using",
    "start": "783389",
    "end": "785670"
  },
  {
    "text": "SVG which is less likely to be rejected",
    "start": "785670",
    "end": "787740"
  },
  {
    "text": "by the application layer above the image",
    "start": "787740",
    "end": "789779"
  },
  {
    "text": "logic magic",
    "start": "789779",
    "end": "792438"
  },
  {
    "text": "here's another more interesting one",
    "start": "794240",
    "end": "795860"
  },
  {
    "text": "which merely downloads files that",
    "start": "795860",
    "end": "797660"
  },
  {
    "text": "doesn't do anything further with it we",
    "start": "797660",
    "end": "800300"
  },
  {
    "text": "suspect this part of the larger attack",
    "start": "800300",
    "end": "802300"
  },
  {
    "text": "or perhaps as a way to not draw",
    "start": "802300",
    "end": "805399"
  },
  {
    "text": "attention to the attack sector that the",
    "start": "805399",
    "end": "808520"
  },
  {
    "text": "effect was using and this one of course",
    "start": "808520",
    "end": "813740"
  },
  {
    "text": "paralyzed the shell and just wanted to",
    "start": "813740",
    "end": "817250"
  },
  {
    "text": "use in Python the source code was",
    "start": "817250",
    "end": "819680"
  },
  {
    "text": "actually available and we're going to",
    "start": "819680",
    "end": "821750"
  },
  {
    "text": "have a look at it right now so here we",
    "start": "821750",
    "end": "825950"
  },
  {
    "text": "see we have a FN user always a fan of",
    "start": "825950",
    "end": "829190"
  },
  {
    "text": "mine and if any notice this happening",
    "start": "829190",
    "end": "832550"
  },
  {
    "text": "the size to inspect what this what",
    "start": "832550",
    "end": "835730"
  },
  {
    "text": "this code is doing they see in a process",
    "start": "835730",
    "end": "837709"
  },
  {
    "text": "list they wonder what happens they can",
    "start": "837709",
    "end": "839810"
  },
  {
    "text": "feel relaxed because it was with",
    "start": "839810",
    "end": "841700"
  },
  {
    "text": "somebody Google's security team I mean",
    "start": "841700",
    "end": "843410"
  },
  {
    "text": "you all know they can't be evil so you",
    "start": "843410",
    "end": "845930"
  },
  {
    "text": "can feel happy about that and",
    "start": "845930",
    "end": "847930"
  },
  {
    "text": "surprisingly is quite well written it",
    "start": "847930",
    "end": "849800"
  },
  {
    "text": "has a sniff you the arguments even",
    "start": "849800",
    "end": "853160"
  },
  {
    "text": "though the only person using it should",
    "start": "853160",
    "end": "854690"
  },
  {
    "text": "possibly know what it does but the code",
    "start": "854690",
    "end": "858680"
  },
  {
    "text": "itself is pretty simple it's nothing",
    "start": "858680",
    "end": "861520"
  },
  {
    "text": "particularly spectacular isn't even had",
    "start": "861520",
    "end": "864680"
  },
  {
    "text": "lower handling five elided some of the",
    "start": "864680",
    "end": "867589"
  },
  {
    "text": "environment sets up and particular where",
    "start": "867589",
    "end": "869930"
  },
  {
    "text": "we create a pseudo seats for life",
    "start": "869930",
    "end": "872390"
  },
  {
    "text": "plays pretty straightforward so why stop",
    "start": "872390",
    "end": "877100"
  },
  {
    "text": "there why not have some Michelle go tell",
    "start": "877100",
    "end": "878810"
  },
  {
    "text": "coach coach golf this one is pipes or",
    "start": "878810",
    "end": "882079"
  },
  {
    "text": "into the single line and we actually",
    "start": "882079",
    "end": "884180"
  },
  {
    "text": "generate the file and then excuses",
    "start": "884180",
    "end": "886459"
  },
  {
    "text": "prices by about this one where we",
    "start": "886459",
    "end": "890690"
  },
  {
    "text": "actually we don't even bother trying to",
    "start": "890690",
    "end": "893570"
  },
  {
    "text": "have an image we just create a new batch",
    "start": "893570",
    "end": "895940"
  },
  {
    "text": "session and redirects it to the TCP this",
    "start": "895940",
    "end": "900529"
  },
  {
    "text": "is a bit more robust because now we're",
    "start": "900529",
    "end": "902000"
  },
  {
    "text": "not scientific child parent process and",
    "start": "902000",
    "end": "905320"
  },
  {
    "text": "nothing will be complete without using",
    "start": "905320",
    "end": "907459"
  },
  {
    "text": "the duct tape or the internet NZ and",
    "start": "907459",
    "end": "909850"
  },
  {
    "text": "here we actually do have a good ascent",
    "start": "909850",
    "end": "912380"
  },
  {
    "text": "to hide what you're doing using the",
    "start": "912380",
    "end": "914149"
  },
  {
    "text": "Ridgid image and the command line is",
    "start": "914149",
    "end": "915860"
  },
  {
    "text": "possibly the shortest but definitely my",
    "start": "915860",
    "end": "917810"
  },
  {
    "text": "favorite attack method so in conclusion",
    "start": "917810",
    "end": "922640"
  },
  {
    "text": "people do a lot of interesting things",
    "start": "922640",
    "end": "924500"
  },
  {
    "text": "but the main takeaway is that if you",
    "start": "924500",
    "end": "926839"
  },
  {
    "text": "don't patch you probably will get",
    "start": "926839",
    "end": "928030"
  },
  {
    "text": "act when an exploit is easy to create a",
    "start": "928030",
    "end": "931480"
  },
  {
    "text": "shell shock an image tragic art it's a",
    "start": "931480",
    "end": "933100"
  },
  {
    "text": "matter of hours before your site gets",
    "start": "933100",
    "end": "934540"
  },
  {
    "text": "canned lots of people were trying lots",
    "start": "934540",
    "end": "936970"
  },
  {
    "text": "of different things if it was a",
    "start": "936970",
    "end": "939130"
  },
  {
    "text": "difficult exploit people would just use",
    "start": "939130",
    "end": "940600"
  },
  {
    "text": "the proof of concept or the first one",
    "start": "940600",
    "end": "942160"
  },
  {
    "text": "that's release and not go any further so",
    "start": "942160",
    "end": "944260"
  },
  {
    "text": "that's always a scary prospect if you",
    "start": "944260",
    "end": "947620"
  },
  {
    "text": "like patch if you're like me the worst",
    "start": "947620",
    "end": "949300"
  },
  {
    "text": "thing that will happen is your CD Drive",
    "start": "949300",
    "end": "951070"
  },
  {
    "text": "will just pop out one day and you're not",
    "start": "951070",
    "end": "952690"
  },
  {
    "text": "know why if you're not lucky or even",
    "start": "952690",
    "end": "955930"
  },
  {
    "text": "worse you happen to be in the wrong time",
    "start": "955930",
    "end": "957820"
  },
  {
    "text": "zone and be asleep when the",
    "start": "957820",
    "end": "959110"
  },
  {
    "text": "vulnerability is released you might wake",
    "start": "959110",
    "end": "961450"
  },
  {
    "text": "up to a nicely supplied so even if you",
    "start": "961450",
    "end": "964420"
  },
  {
    "text": "think you properly femicides your inputs",
    "start": "964420",
    "end": "965950"
  },
  {
    "text": "third-party dependencies might not the",
    "start": "965950",
    "end": "968890"
  },
  {
    "text": "show shot vulnerability and imagemagick",
    "start": "968890",
    "end": "970300"
  },
  {
    "text": "vulnerability were not caused by bad",
    "start": "970300",
    "end": "972010"
  },
  {
    "text": "application code is caused by bad",
    "start": "972010",
    "end": "973900"
  },
  {
    "text": "library code or just something so basic",
    "start": "973900",
    "end": "976240"
  },
  {
    "text": "in a system that you don't think about",
    "start": "976240",
    "end": "977620"
  },
  {
    "text": "it one way to solve it is to obviously",
    "start": "977620",
    "end": "981760"
  },
  {
    "text": "patch your systems but if you don't",
    "start": "981760",
    "end": "983650"
  },
  {
    "text": "cause you can't or if you have a old",
    "start": "983650",
    "end": "986370"
  },
  {
    "text": "system or Hardware pipes the car be",
    "start": "986370",
    "end": "988720"
  },
  {
    "text": "patched then just try to block it",
    "start": "988720",
    "end": "990850"
  },
  {
    "text": "otherwise using the RAF or similar if",
    "start": "990850",
    "end": "996280"
  },
  {
    "text": "anyone have any questions",
    "start": "996280",
    "end": "999210"
  },
  {
    "text": "if do we have a microphone",
    "start": "1000500",
    "end": "1005090"
  },
  {
    "text": "ah I guess not I either listening",
    "start": "1023649",
    "end": "1029398"
  }
]