[
  {
    "start": "0",
    "end": "91000"
  },
  {
    "text": "good afternoon blackhat welcome to one of the final sessions of the day before we get started just one big announcement",
    "start": "0",
    "end": "6870"
  },
  {
    "text": "if we would appreciate if you would put all of your mobile devices into some kind of silent mode we are of course",
    "start": "6870",
    "end": "12059"
  },
  {
    "text": "recording this talk and so if there are too many interruptions we're going to have to lock the doors and start the talk from scratch I'm sure you want to",
    "start": "12059",
    "end": "18210"
  },
  {
    "text": "get to dinner sometime tonight the there's only two things that you can't",
    "start": "18210",
    "end": "23220"
  },
  {
    "text": "leave blackhat without one of them is a profound new knowledge of security and",
    "start": "23220",
    "end": "29369"
  },
  {
    "text": "the things around it and the others merchandise the merchandise shop will be open until 6 o'clock today up there on",
    "start": "29369",
    "end": "34980"
  },
  {
    "text": "level 2 you are an Islander a I my name is dr. John Griffin and it is my great",
    "start": "34980",
    "end": "40739"
  },
  {
    "text": "pleasure to introduce Christopher Jacobi a consultant from Sweden who works for",
    "start": "40739",
    "end": "46469"
  },
  {
    "text": "f-secure I've asked all of the speakers I've introduced for something interesting to say about them in the",
    "start": "46469",
    "end": "51570"
  },
  {
    "text": "talk and his was very interesting he wanted everybody to know that he collects vinyl records and that he DJ's",
    "start": "51570",
    "end": "56969"
  },
  {
    "text": "at parties using those vinyl records and it just so happens that tonight",
    "start": "56969",
    "end": "62250"
  },
  {
    "text": "August 8th he is available if anybody has a party and needs a DJ with some vinyl records at it having said that the",
    "start": "62250",
    "end": "70530"
  },
  {
    "text": "talk today is command injection I rules in load sorry you can probably read it",
    "start": "70530",
    "end": "75780"
  },
  {
    "text": "on the slide command injection in I rules load balancer scripts Christopher Jacobi welcome to the stage thank John",
    "start": "75780",
    "end": "85939"
  },
  {
    "text": "thanks dr. John wow it's bright ok my name is Christopher and I work for",
    "start": "85939",
    "end": "94710"
  },
  {
    "start": "91000",
    "end": "146000"
  },
  {
    "text": "s secure Sweden I'm a security consultant and I do pen testing and I",
    "start": "94710",
    "end": "99810"
  },
  {
    "text": "have a team of consultants back in Sweden were eagerly watching this and",
    "start": "99810",
    "end": "104909"
  },
  {
    "text": "and I should mention Ola and Posse initially who this year was nominated to",
    "start": "104909",
    "end": "112680"
  },
  {
    "text": "the pony Awards and for their research on cold boot attacks in BitLocker",
    "start": "112680",
    "end": "119600"
  },
  {
    "text": "William said they were helped me set up this presentation and the demos you're going to see and yes press given me a",
    "start": "119600",
    "end": "124710"
  },
  {
    "text": "moral support and thank you for turning out over to the light side I've had a lot of support from f5 during this",
    "start": "124710",
    "end": "131620"
  },
  {
    "text": "and I've reported a lot of bugs in my past and f5 has given me the most or the",
    "start": "131620",
    "end": "136959"
  },
  {
    "text": "best response ever so far and I'm really impressed by that thank you a lot for that and thanks for being here",
    "start": "136959",
    "end": "144840"
  },
  {
    "text": "so we offer consultancy services around the globe and I'm really happy to have",
    "start": "146010",
    "end": "151659"
  },
  {
    "text": "had the support from almost all offices in one way or another during this research and thanks you guys everyone",
    "start": "151659",
    "end": "158319"
  },
  {
    "text": "who has been supporting me so load balancers f5 big IP devices are way more",
    "start": "158319",
    "end": "165370"
  },
  {
    "text": "than load balancers and I'm not here to advertise for a product of another company but I have to say it's an",
    "start": "165370",
    "end": "170890"
  },
  {
    "text": "advanced piece of equipment they can do a lot of things and I'd call it a",
    "start": "170890",
    "end": "176140"
  },
  {
    "text": "gateway I call it the session manager and also a load balancer so what does",
    "start": "176140",
    "end": "182500"
  },
  {
    "text": "the load balancer do imagine you have a lot of traffic from the internet going to your back-end services being an HTTP",
    "start": "182500",
    "end": "190450"
  },
  {
    "text": "service for instance managing a lot of traffic is expensive and it's hard to do",
    "start": "190450",
    "end": "196299"
  },
  {
    "text": "with one given service and especially if you have a complex session setup let's say you have an intranet or something",
    "start": "196299",
    "end": "203169"
  },
  {
    "text": "then that internet will have cookies support for for managing who's logged in",
    "start": "203169",
    "end": "208930"
  },
  {
    "text": "or not and also this divot this device will manage that for you it will also",
    "start": "208930",
    "end": "214239"
  },
  {
    "text": "manage the TLS sessions and host your TLS session keys and synchronize between",
    "start": "214239",
    "end": "219459"
  },
  {
    "text": "itself and I think it's a pretty awesome product that has handled a lot of load throughout the years and it's pretty",
    "start": "219459",
    "end": "225310"
  },
  {
    "text": "stable and really cool so I'm not here to flame this product at all that said",
    "start": "225310",
    "end": "230799"
  },
  {
    "text": "there are weaknesses in all products and it's all about how you react to them right these vulnerabilities are pretty",
    "start": "230799",
    "end": "237879"
  },
  {
    "text": "serious and they're hard for f5 to cope with because these are in user supplied",
    "start": "237879",
    "end": "244150"
  },
  {
    "text": "configurations and I'll show much more about that throughout this presentation",
    "start": "244150",
    "end": "250769"
  },
  {
    "text": "so I rules I rules is something that belongs inside of this load balancer",
    "start": "250769",
    "end": "256930"
  },
  {
    "start": "251000",
    "end": "373000"
  },
  {
    "text": "device that defines where the packet goes does it go to one back-end server",
    "start": "256930",
    "end": "263770"
  },
  {
    "text": "or another and how do you define that yeah you set up the bathroom rule saying that this packet has a header way they're valid",
    "start": "263770",
    "end": "270050"
  },
  {
    "text": "cookies so it goes to the login page or it has something invalid so it doesn't go anywhere or it goes to a logout page",
    "start": "270050",
    "end": "275900"
  },
  {
    "text": "or something and that's a that's the thing you want to do inside of the load",
    "start": "275900",
    "end": "281000"
  },
  {
    "text": "balancer before heading back in servers because sometimes you can have denial of service attacks you can have a lot of",
    "start": "281000",
    "end": "286400"
  },
  {
    "text": "things happening that you want to filter out already in the load balancer and those scripts can become pretty complicated in this case we have a",
    "start": "286400",
    "end": "293420"
  },
  {
    "text": "really really simple script that we're looking at and that's a caching I rule and this rule checks if a request",
    "start": "293420",
    "end": "300350"
  },
  {
    "text": "contains a get line looking for the favicon file that's a file that's the icon file in there in the request if it",
    "start": "300350",
    "end": "306980"
  },
  {
    "text": "contains that then we would just respond with a favicon file without even consulting the backend web server and this feature is pretty neat because",
    "start": "306980",
    "end": "312950"
  },
  {
    "text": "that's like in a useless load for a back-end server and it just presents a",
    "start": "312950",
    "end": "318260"
  },
  {
    "text": "unified front with the logo to the web browser okay and a more complex example is if",
    "start": "318260",
    "end": "328040"
  },
  {
    "text": "you have localization for instance here's a get request that's asking for the index page and you could have a",
    "start": "328040",
    "end": "335120"
  },
  {
    "text": "forwarding script that goes to different back-end servers depending on whether",
    "start": "335120",
    "end": "340280"
  },
  {
    "text": "it's a request that comes from the Spanish browser or another browser and in those cases the backend server will",
    "start": "340280",
    "end": "346610"
  },
  {
    "text": "reply with a localized linguistic server a response to back to the browser so",
    "start": "346610",
    "end": "352370"
  },
  {
    "text": "that you can have a localized website and this is also very nice feature obviously because a localization is",
    "start": "352370",
    "end": "358640"
  },
  {
    "text": "always a tricky issue and the reason why I mentioned this is because there's always an interaction between the load",
    "start": "358640",
    "end": "364760"
  },
  {
    "text": "balancer step and the back-end server and this is the the way of the flow and they now you're starting to get the idea",
    "start": "364760",
    "end": "369950"
  },
  {
    "text": "what the product does I guess okay so I want to talk about I rules the language",
    "start": "369950",
    "end": "377930"
  },
  {
    "start": "373000",
    "end": "457000"
  },
  {
    "text": "I rules so back in 2001 the version of tickle or TCL was released called",
    "start": "377930",
    "end": "383330"
  },
  {
    "text": "8.4 and this version this version was",
    "start": "383330",
    "end": "389510"
  },
  {
    "text": "used to fork off and build AI rules and the product has been building on its",
    "start": "389510",
    "end": "394520"
  },
  {
    "text": "sense and I rules introduced by simply vacation so the scripts don't have to be",
    "start": "394520",
    "end": "400129"
  },
  {
    "text": "as complicated as these ones in this case what you're looking at on the left-hand side it's a typical tickle",
    "start": "400129",
    "end": "405530"
  },
  {
    "text": "script that would not be a valid I rule because it does file operations this is a common program that tries to translate",
    "start": "405530",
    "end": "412879"
  },
  {
    "text": "file endings or line endings inside of a file to from the UNIX type file endings",
    "start": "412879",
    "end": "417889"
  },
  {
    "text": "to the dost type file ending and this is something that would not work inside of I rule because it does a local file",
    "start": "417889",
    "end": "423379"
  },
  {
    "text": "stuff and the reason why this is blocked out is because you don't want customers to break out of the I rule environment",
    "start": "423379",
    "end": "431150"
  },
  {
    "text": "and take over the device in the first place and it would just complicate things it will break things and it wouldn't yeah so to simplify the",
    "start": "431150",
    "end": "438259"
  },
  {
    "text": "language they're basically excluded okay tickle is return-oriented programming but it also has exception handling which",
    "start": "438259",
    "end": "445460"
  },
  {
    "text": "means if an exception or cure you can catch it this is something that can really really ease up the situation if",
    "start": "445460",
    "end": "451849"
  },
  {
    "text": "you're in trouble with this kind of injection I'll try to discuss that later",
    "start": "451849",
    "end": "457000"
  },
  {
    "start": "457000",
    "end": "495000"
  },
  {
    "text": "so here's a simple script it doesn't redirect the HCP redirect to a page called hello world and it has an event",
    "start": "457000",
    "end": "464089"
  },
  {
    "text": "called when when it's actually a command and he should be request is an argument and then there is a third argument which",
    "start": "464089",
    "end": "469969"
  },
  {
    "text": "is the curly brace that opens up for a body argument with a HTTP redirect",
    "start": "469969",
    "end": "475310"
  },
  {
    "text": "function okay I'm gonna go through the syntax of this language a lot because",
    "start": "475310",
    "end": "480469"
  },
  {
    "text": "this vulnerability and what we're talking about here has to do with syntax so we need to understand the language in order to write the files and I'm",
    "start": "480469",
    "end": "486589"
  },
  {
    "text": "thinking the people who are watching this on YouTube later they will want to learn this specifically because you want",
    "start": "486589",
    "end": "492289"
  },
  {
    "text": "to write secure code if you're a pen",
    "start": "492289",
    "end": "498020"
  },
  {
    "start": "495000",
    "end": "540000"
  },
  {
    "text": "tester or if you are a bug bounty specialist then you will be want to wanting to looking at for this the",
    "start": "498020",
    "end": "505129"
  },
  {
    "text": "yellow Mart server header this is a high GPA response header that you normally find in a file like the five favicon",
    "start": "505129",
    "end": "511939"
  },
  {
    "text": "file it's presented every time there is HTTP call a color redirect so the code so before is redirecting to hello world",
    "start": "511939",
    "end": "518180"
  },
  {
    "text": "and it looks like this in the response and it's a server colon big-ip because the big IP responded to your request",
    "start": "518180",
    "end": "524180"
  },
  {
    "text": "this indicates to an attacker that this is in a big IP device and that's something that you as an attacker might",
    "start": "524180",
    "end": "529520"
  },
  {
    "text": "be looking for essentially we do this with every HTTP",
    "start": "529520",
    "end": "535510"
  },
  {
    "text": "server in the world that we could find and we produce this beautiful map so",
    "start": "535510",
    "end": "541060"
  },
  {
    "start": "540000",
    "end": "598000"
  },
  {
    "text": "this is the planet we live on and I want to use this map to emphasize the gravity",
    "start": "541060",
    "end": "548140"
  },
  {
    "text": "of this because this is a very popular product a lot of people use this and the",
    "start": "548140",
    "end": "553660"
  },
  {
    "text": "colors you're seeing is responses we got from a request to the Save icon file when we try to reach that HTTP server",
    "start": "553660",
    "end": "559959"
  },
  {
    "text": "well it said big IP in the answer and there's a lot in the US but there's a lot of the Europe's as well especially",
    "start": "559959",
    "end": "565959"
  },
  {
    "text": "in in Germany and it's big in Japan these devices protect and and serve web",
    "start": "565959",
    "end": "574480"
  },
  {
    "text": "requests of different kinds to to organizations worldwide essentially as",
    "start": "574480",
    "end": "579700"
  },
  {
    "text": "you can see and there's loads of them which means there's loads of arrows and loads of configurations and loads of",
    "start": "579700",
    "end": "585459"
  },
  {
    "text": "complexity and that means it's very hard to make an outreach even for a secure and f5 combined to reach all these",
    "start": "585459",
    "end": "591490"
  },
  {
    "text": "people who are doing this and tell them this is how I write the correct rules for this ok so let's talk about syntax",
    "start": "591490",
    "end": "601260"
  },
  {
    "start": "598000",
    "end": "685000"
  },
  {
    "text": "tickle or TCL tickle support tickle supports argument substitution that",
    "start": "601260",
    "end": "606910"
  },
  {
    "text": "means that the arguments are being handled by the interpreter prior to execution",
    "start": "606910",
    "end": "612070"
  },
  {
    "text": "that's a nonsensical censored sentence for a lot of people here so I'm gonna show some examples usually in a",
    "start": "612070",
    "end": "619390"
  },
  {
    "text": "programming language when you write a string you surround it with quotes",
    "start": "619390",
    "end": "624779"
  },
  {
    "text": "number one line here shows quotes in tickle or in arrows you do not do that",
    "start": "624779",
    "end": "633100"
  },
  {
    "text": "because it's you surround your strings with quotes you also make that line",
    "start": "633100",
    "end": "639490"
  },
  {
    "text": "executable I'm going to explain that in much detail later it's surrounded with brackets that's the hardpack 'its you",
    "start": "639490",
    "end": "646600"
  },
  {
    "text": "make that line executable you make that into something that will execute if you surround it with braces like the one you",
    "start": "646600",
    "end": "652990"
  },
  {
    "text": "got on your teeth or these guys then you have a string so number three is the correct way of handling strings and this",
    "start": "652990",
    "end": "659829"
  },
  {
    "text": "is important to remember every time you're handing a string do it inside of braces and you can also do uncoated arguments",
    "start": "659829",
    "end": "667839"
  },
  {
    "text": "which is an argument to a function like the command here that does not have any of these and that can end up in various",
    "start": "667839",
    "end": "675459"
  },
  {
    "text": "states sometimes it's safe and sometimes it's unsafe and I'll try to give example so when it switch and it's kind of hard",
    "start": "675459",
    "end": "682449"
  },
  {
    "text": "to keep track of so use braces when you can so what happens if you have coded",
    "start": "682449",
    "end": "688269"
  },
  {
    "start": "685000",
    "end": "760000"
  },
  {
    "text": "evaluation there is a document called the Decalogue and it was written in the",
    "start": "688269",
    "end": "693490"
  },
  {
    "text": "90s or from the developers article when they started defining the language and it's the rules of substitution it's the",
    "start": "693490",
    "end": "699339"
  },
  {
    "text": "rules of how the language is supposed to be interpreted so initially a script is running and it's being parts and the",
    "start": "699339",
    "end": "705910"
  },
  {
    "text": "first thing it looks for is the command which is the first word on the line before space and then you have the",
    "start": "705910",
    "end": "712000"
  },
  {
    "text": "argument and the argument here is quoted in this example if there is a quote around the argument then the tickle",
    "start": "712000",
    "end": "719949"
  },
  {
    "text": "interpreter will replace the content of that argument with something so if the",
    "start": "719949",
    "end": "725139"
  },
  {
    "text": "content contains a variable that variable will be resolved if that line actually contains in executing thing",
    "start": "725139",
    "end": "731860"
  },
  {
    "text": "like the heart bracket we assault number two in the list then it would execute that prior to running the function that",
    "start": "731860",
    "end": "738459"
  },
  {
    "text": "it arguments to so inside of braces inside of brackets if a word contains an",
    "start": "738459",
    "end": "744190"
  },
  {
    "text": "open bracket then the ticular performs command substitution this is exactly what happens when you do backticks in",
    "start": "744190",
    "end": "749589"
  },
  {
    "text": "bash I think that makes more sense to think of in that way so as an attacker",
    "start": "749589",
    "end": "755170"
  },
  {
    "text": "we want to use brackets and we want to look for cases where quotes are used so",
    "start": "755170",
    "end": "761130"
  },
  {
    "text": "ticular injections essentially is just like when Bart Simpson calls up MO and asked if L is",
    "start": "761130",
    "end": "767560"
  },
  {
    "text": "there and he says L hoo yeah you know the owl named coholic in the last name and he's hold on who's alcoholic is",
    "start": "767560",
    "end": "773680"
  },
  {
    "text": "there any alcoholics here and everyone laughs because obviously everyone's an alcoholic in his bar and and that means",
    "start": "773680",
    "end": "779699"
  },
  {
    "text": "contextualizing something that he doesn't really understand the concept of it yet but once it comes together he",
    "start": "779699",
    "end": "786850"
  },
  {
    "text": "realizes that is is made a fool of and everyone laughs at him so what happens",
    "start": "786850",
    "end": "794649"
  },
  {
    "text": "if you have own uncoded arguments this is an interesting case because uncoated arguments can be",
    "start": "794649",
    "end": "801559"
  },
  {
    "text": "treated differently by different functions functions here are Kamal commands because this is one of the first script languages if you have a",
    "start": "801559",
    "end": "809059"
  },
  {
    "text": "number one line here there is after that's like sleep in any other language",
    "start": "809059",
    "end": "814669"
  },
  {
    "text": "it says waits one second and then it runs whatever is in body so if body contains something executable",
    "start": "814669",
    "end": "820309"
  },
  {
    "text": "it will run it or provide a syntax error while it's the same thing it has a body argument so every time you do a while",
    "start": "820309",
    "end": "826759"
  },
  {
    "text": "loop it goes on forever in this case wild one then it executes body forever its statements can be trick too into",
    "start": "826759",
    "end": "833749"
  },
  {
    "text": "executing something as well and switch statements and so on I'll show a full",
    "start": "833749",
    "end": "838819"
  },
  {
    "text": "list of those later but now you know that there could be body arguments to",
    "start": "838819",
    "end": "845089"
  },
  {
    "start": "842000",
    "end": "889000"
  },
  {
    "text": "something okay there could also in in the body argument you could also have",
    "start": "845089",
    "end": "850100"
  },
  {
    "text": "quotes so in this case this is it a prior art collected from the analytical",
    "start": "850100",
    "end": "855289"
  },
  {
    "text": "wiki this has been around for a long time but very few people have read it and this is why I'm here to inform you okay if the argument to catch which has",
    "start": "855289",
    "end": "865339"
  },
  {
    "text": "a body argument catches catching exceptions if the body argument the catch is starting with quotes then those",
    "start": "865339",
    "end": "871309"
  },
  {
    "text": "codes will be or the inside of those codes will be command substituted and then catch will execute whatever it's",
    "start": "871309",
    "end": "876829"
  },
  {
    "text": "inside there so the order of things what's gonna happen when this is running",
    "start": "876829",
    "end": "882199"
  },
  {
    "text": "is I set variable to error which is a function or a command and it has the argument hold this will happen so the",
    "start": "882199",
    "end": "892579"
  },
  {
    "text": "interpreter will instead of running catch will first replace whatever's inside of the quote so it will replace",
    "start": "892579",
    "end": "898629"
  },
  {
    "text": "variable with heart bracket error pod okay and then it will actually execute",
    "start": "898629",
    "end": "905359"
  },
  {
    "text": "pwned or error-prone and typo'd on the screen prior to running puts and catching the herb which is a bit",
    "start": "905359",
    "end": "912319"
  },
  {
    "text": "confusing to some and I've seen exactly this line catch and then quote in a lot of scripts out there because if I rules",
    "start": "912319",
    "end": "918679"
  },
  {
    "text": "there is a there's a community then you go to a site called dev central the ref fiver or comm sorry that's pretty",
    "start": "918679",
    "end": "925999"
  },
  {
    "text": "brilliant it's an open community everyone helps out but sometimes people provide examples dangerous and this can always happen you",
    "start": "925999",
    "end": "932810"
  },
  {
    "text": "know that happens on stackoverflow as well but we need to talk about this nose so that people who actually start",
    "start": "932810",
    "end": "938360"
  },
  {
    "text": "informing each other or they're the problems you can run into if you do this on dev central you can download a lot of",
    "start": "938360",
    "end": "944089"
  },
  {
    "text": "code snippet examples that people are using when they get started with this and a lot of those examples contains exactly that catch quote something which",
    "start": "944089",
    "end": "950899"
  },
  {
    "text": "is very very dangerous because anything inside a variable if that's user control can lead to execution here's a list of",
    "start": "950899",
    "end": "959980"
  },
  {
    "text": "functions or commands this is the list of commands that has body arguments and",
    "start": "959980",
    "end": "965779"
  },
  {
    "text": "all of these do some kind of evaluation or what's running and essentially this",
    "start": "965779",
    "end": "971240"
  },
  {
    "text": "is the majority of the language in the end I might be missing some I might be in having added some that are wrong but",
    "start": "971240",
    "end": "978050"
  },
  {
    "text": "essentially these are the ones that has body functions that I could find and all of these you have to take care to look",
    "start": "978050",
    "end": "984290"
  },
  {
    "text": "at arguments and not use quotes in the arguments of any of these because that means execution okay sometimes it can",
    "start": "984290",
    "end": "992450"
  },
  {
    "text": "also be dangerous to not use any quotation at all because if you have like you saw before an argument without quotes then it will lead to execution as",
    "start": "992450",
    "end": "999829"
  },
  {
    "text": "well in the body then there's these three",
    "start": "999829",
    "end": "1005260"
  },
  {
    "text": "guys everyone who says a hacker conference usually knows that eval or evaluation is dangerous evil is a",
    "start": "1005260",
    "end": "1012160"
  },
  {
    "text": "function that actually just evaluates whatever is going on and executes it it's it's dangerous but people still do",
    "start": "1012160",
    "end": "1017829"
  },
  {
    "text": "it so let's talk about that eval could be said to be evil you can probably avoid using eval and",
    "start": "1017829",
    "end": "1024459"
  },
  {
    "text": "you can probably be good without it subs does substitution it's actually safer way of doing the same thing because it",
    "start": "1024459",
    "end": "1030370"
  },
  {
    "text": "subs do you have an option that says there's no commands and that means that whatever is in the arguments it will not",
    "start": "1030370",
    "end": "1036490"
  },
  {
    "text": "look for hard brackets and it will not execute the the code in there if you do",
    "start": "1036490",
    "end": "1043720"
  },
  {
    "text": "the argument - no comments okay expert is a function you cannot live without",
    "start": "1043720",
    "end": "1048850"
  },
  {
    "text": "because expert is math expert is where you perform addition between two things",
    "start": "1048850",
    "end": "1054610"
  },
  {
    "text": "so if I want to add one plus one I do it with expert expert means to do any type",
    "start": "1054610",
    "end": "1060400"
  },
  {
    "text": "of aromatics and expert also does command evaluation because in maths you need to figure out",
    "start": "1060400",
    "end": "1066090"
  },
  {
    "text": "what's going on before you can add something so you need to actually run the method run the functions in the",
    "start": "1066090",
    "end": "1071220"
  },
  {
    "text": "argument list prior to prior to making",
    "start": "1071220",
    "end": "1076440"
  },
  {
    "text": "the math essentially and that's an important in from piece of information",
    "start": "1076440",
    "end": "1081960"
  },
  {
    "text": "there so expert can be very very dangerous too here's the script I want",
    "start": "1081960",
    "end": "1088590"
  },
  {
    "start": "1086000",
    "end": "1222000"
  },
  {
    "text": "to show you some coding examples of how it can go wrong without us knowing it so I'm using an open source snippet called",
    "start": "1088590",
    "end": "1098130"
  },
  {
    "text": "the HS SR it's a guy called mark did a hyper super sideband requester that tool",
    "start": "1098130",
    "end": "1104340"
  },
  {
    "text": "is used to do client requests to back-end servers it's pretty awesome and it's the most downloaded piece of code",
    "start": "1104340",
    "end": "1109860"
  },
  {
    "text": "that I've seen I think it's the most people downloaded piece of code on death central which means it's the most",
    "start": "1109860",
    "end": "1115440"
  },
  {
    "text": "popular open source snippet there is in this community and it's slightly",
    "start": "1115440",
    "end": "1120660"
  },
  {
    "text": "vulnerable and I'm using it as an example because they have some kind of",
    "start": "1120660",
    "end": "1126180"
  },
  {
    "text": "defense mechanism that I'm going to soon so what's happening here is that you're running set status and you're calling",
    "start": "1126180",
    "end": "1132450"
  },
  {
    "text": "this function essentially and you're putting the URI in there URI is derived of except language which is a header",
    "start": "1132450",
    "end": "1138810"
  },
  {
    "text": "that the user can set so the user can say instead of E and that GB or something that's your linguistic",
    "start": "1138810",
    "end": "1144810"
  },
  {
    "text": "preferences they could set it to something malicious that would go into the you or I hate users are layer does",
    "start": "1144810",
    "end": "1151980"
  },
  {
    "text": "this there is a highlighted line here where it's trying trying to do a MMS",
    "start": "1151980",
    "end": "1160890"
  },
  {
    "text": "lookup or a DNS lookup of the hostname part of that the hostname part of that",
    "start": "1160890",
    "end": "1167460"
  },
  {
    "text": "URL if you do that like this here's an",
    "start": "1167460",
    "end": "1172650"
  },
  {
    "text": "eval that then quotes that means that the content will be resolved inside of the host name that the user now controls",
    "start": "1172650",
    "end": "1179160"
  },
  {
    "text": "because it's in the accept header then execution will occur when the eval runs",
    "start": "1179160",
    "end": "1186000"
  },
  {
    "text": "and the user does not even have to write a hard bracket to to perform execution because they're already in the line of",
    "start": "1186000",
    "end": "1191850"
  },
  {
    "text": "execution which means that all you have to do is type semicolon and then you tinu right tickle code as they want and",
    "start": "1191850",
    "end": "1197830"
  },
  {
    "text": "they're inside of the device the reason why I'm showing this piece of code is it's actually not vulnerable prior to",
    "start": "1197830",
    "end": "1204610"
  },
  {
    "text": "this there is a rig X that filters out unwanted characters which means that essentially it's sanitized in a way you",
    "start": "1204610",
    "end": "1211299"
  },
  {
    "text": "can make this line break you can make the script fault but you cannot make it execute and that's why I want to show",
    "start": "1211299",
    "end": "1217570"
  },
  {
    "text": "this particular example I tried to be responsible about this okay so",
    "start": "1217570",
    "end": "1223260"
  },
  {
    "start": "1222000",
    "end": "1272000"
  },
  {
    "text": "exploitation what you have to do as an attacker to do this and also as a",
    "start": "1223260",
    "end": "1228850"
  },
  {
    "text": "defender I guess is identified the fields there it's going to be used and substance is substituted by I rule so",
    "start": "1228850",
    "end": "1234610"
  },
  {
    "text": "imagine that you're an organization that's actually using AI rules maybe you actually want to make a list of all the valid user inputs and see where do they",
    "start": "1234610",
    "end": "1241179"
  },
  {
    "text": "go if you make that list and you have a better chance of defending yourself that is against these type of attacks okay so",
    "start": "1241179",
    "end": "1252309"
  },
  {
    "text": "as an attacker you want to inject ticka code or irulu code in to a request in",
    "start": "1252309",
    "end": "1257500"
  },
  {
    "text": "any type of field that you can think of and see if that code is actually running coming back to you and after you're done",
    "start": "1257500",
    "end": "1265179"
  },
  {
    "text": "this you try to identify any other type of external resource that I can pivot to get terminal ax permanent access into",
    "start": "1265179",
    "end": "1270820"
  },
  {
    "text": "this okay here's the video see if this works it does so here's the HTTP request",
    "start": "1270820",
    "end": "1277450"
  },
  {
    "start": "1272000",
    "end": "1340000"
  },
  {
    "text": "on top you see a regular web browser this is Internet Explorer and below you see burp burp is a tool that's",
    "start": "1277450",
    "end": "1283570"
  },
  {
    "text": "essentially acting as a proxy and now we can make changes to the request before we send it to the server so here's a few",
    "start": "1283570",
    "end": "1290320"
  },
  {
    "text": "headers that's interesting for us to look at there is a jet line the HTTP version number there is the user agent",
    "start": "1290320",
    "end": "1296409"
  },
  {
    "text": "we just passed there is the accept language that we exploded in the past and there's accept line which looks at",
    "start": "1296409",
    "end": "1303309"
  },
  {
    "text": "what type of requests or whatever responses we accept etc and and there is",
    "start": "1303309",
    "end": "1310120"
  },
  {
    "text": "plenty of injection possibilities we don't know now as an attacker what is vulnerable or not but we can get a hint",
    "start": "1310120",
    "end": "1316960"
  },
  {
    "text": "so there is two cookies being set in in my client my client has two cookies if",
    "start": "1316960",
    "end": "1322840"
  },
  {
    "text": "we look at the response it's actually is trying to set the word logged out into",
    "start": "1322840",
    "end": "1328179"
  },
  {
    "text": "the a session ID and suspicious thing so that's an attacker what I want to do now is to send this",
    "start": "1328179",
    "end": "1334090"
  },
  {
    "text": "request into the repeater Imbert and I can't tell you enough how much I love this tool but that's what not why I'm",
    "start": "1334090",
    "end": "1341860"
  },
  {
    "text": "here so if you select this line with the a session ID and you actually replace that",
    "start": "1341860",
    "end": "1347679"
  },
  {
    "text": "cookie value with a valid I rule line",
    "start": "1347679",
    "end": "1353220"
  },
  {
    "text": "here I'm using hard brackets because that means execution I type TCP colon colon respond that will make a response",
    "start": "1353220",
    "end": "1360659"
  },
  {
    "text": "prior to the HTTP header being sent and I use braces this is correct away then",
    "start": "1360659",
    "end": "1369190"
  },
  {
    "text": "all of a sudden tada you see hello being executed there see hello it's actually coming prior to the",
    "start": "1369190",
    "end": "1374919"
  },
  {
    "text": "HP request this means that I am in control of what's going on on the big IP",
    "start": "1374919",
    "end": "1380380"
  },
  {
    "text": "device right now for my request okay I can also run a function called HTTP",
    "start": "1380380",
    "end": "1385929"
  },
  {
    "text": "respond right now I'm getting the syntax wrong but usually that's not as effective as TCP respond because HTTP",
    "start": "1385929",
    "end": "1392140"
  },
  {
    "text": "respond can only be done once per request and if someone else is already doing it I can't do it twice it will produce an error message in the log and",
    "start": "1392140",
    "end": "1398770"
  },
  {
    "text": "someone we can actually detect that I'm trying to hack them as an attacker I don't want to do that so I'm using TCP",
    "start": "1398770",
    "end": "1404860"
  },
  {
    "text": "respond which always works and this gives me a safe way of defining or",
    "start": "1404860",
    "end": "1411870"
  },
  {
    "text": "determining if an input field is validated or not there is a command called info level zero as an attacker",
    "start": "1411870",
    "end": "1418270"
  },
  {
    "text": "it's a brilliant command because it gives me the source code of the current context I'm in and like I don't even",
    "start": "1418270",
    "end": "1425950"
  },
  {
    "text": "know what to compare that to that's a leftover from tickle I think that f5 could actually remove that command",
    "start": "1425950",
    "end": "1431470"
  },
  {
    "text": "without harming anyone here you can see the line that's dangerous I highlighted it now it's a substance cookie might be",
    "start": "1431470",
    "end": "1437980"
  },
  {
    "text": "vulnerable and it does the substitution on that that's the dangerous line there I think like if you just review code",
    "start": "1437980",
    "end": "1446950"
  },
  {
    "text": "like that it's pretty hard to determine what line is vulnerable unless you know",
    "start": "1446950",
    "end": "1452080"
  },
  {
    "text": "something about this you need this information that I'm giving you right now in order to protect yourself because",
    "start": "1452080",
    "end": "1457960"
  },
  {
    "text": "I see flaws everywhere now that I'm sorry look at it",
    "start": "1457960",
    "end": "1462630"
  },
  {
    "text": "so how do we take it further as an attacker you usually want to elevate your access maybe or maybe not like how",
    "start": "1462970",
    "end": "1469660"
  },
  {
    "text": "do we actually get persistent access in this right now we're in memory so we're inside of the interpreter which means",
    "start": "1469660",
    "end": "1475480"
  },
  {
    "text": "it's pretty hard to detect us there is logging optional logging that the user can use or not it's a function itself an",
    "start": "1475480",
    "end": "1483070"
  },
  {
    "text": "attacker wants to not be in the logs I guess to become persistent in memory for",
    "start": "1483070",
    "end": "1490750"
  },
  {
    "start": "1487000",
    "end": "1520000"
  },
  {
    "text": "a longer time there's something called table and table is used for synchronizing a key value store so",
    "start": "1490750",
    "end": "1496000"
  },
  {
    "text": "imagine you have a bunch of cookies and you want to store them in memory and synchronize those between devices this",
    "start": "1496000",
    "end": "1501460"
  },
  {
    "text": "is one of the most profound and also features with big IP products because they are always synchronized and it's",
    "start": "1501460",
    "end": "1507610"
  },
  {
    "text": "somehow magically always works and once this is synchronized as an attacker it's also interesting because that means",
    "start": "1507610",
    "end": "1513250"
  },
  {
    "text": "means I get access to all instances if I can use the session table or inject into",
    "start": "1513250",
    "end": "1518560"
  },
  {
    "text": "the session table the tation table syntax looks like this you can set lookup add replace that's the things you",
    "start": "1518560",
    "end": "1525250"
  },
  {
    "start": "1520000",
    "end": "1560000"
  },
  {
    "text": "would probably want to do and that means if I'm as an attacker have an injection in a code that actually uses table",
    "start": "1525250",
    "end": "1533490"
  },
  {
    "text": "anywhere then I can inject into that table and actually put code there that",
    "start": "1533490",
    "end": "1538750"
  },
  {
    "text": "will execute once that user logs in or does something so let's say I have a",
    "start": "1538750",
    "end": "1543910"
  },
  {
    "text": "user called admin and I want to get that users account literally you steal the cookie by doing a table lookup admin and",
    "start": "1543910",
    "end": "1550660"
  },
  {
    "text": "get that cookie I could probably do that or I'll replace the admin cookie with",
    "start": "1550660",
    "end": "1555760"
  },
  {
    "text": "more information that I want to use as an attacker this example I'm going to show now is a little bit complicated but",
    "start": "1555760",
    "end": "1563650"
  },
  {
    "start": "1560000",
    "end": "2137000"
  },
  {
    "text": "I'll try to walk you through it as we go this is a service that does DNS lookups for you and once you do DNS lookups",
    "start": "1563650",
    "end": "1571060"
  },
  {
    "text": "twice it's actually caching them so you don't have to do DNS lookups many times and I've stolen the line from hate Jesus",
    "start": "1571060",
    "end": "1576100"
  },
  {
    "text": "or the does the DNS lookup you see you have an example that actually works so as an attacker I already know now that",
    "start": "1576100",
    "end": "1582550"
  },
  {
    "text": "this is the field I'm looking for and I'm doing URL encoding that's important",
    "start": "1582550",
    "end": "1587890"
  },
  {
    "text": "URL encoding means that it's replacing the values with hex here and now it's try to make now it's trying to make a",
    "start": "1587890",
    "end": "1594160"
  },
  {
    "text": "DNS lookup on an empty string because that's what's returning from a TCP colon color",
    "start": "1594160",
    "end": "1599860"
  },
  {
    "text": "response test and that takes some time so bear with me and yeah so different",
    "start": "1599860",
    "end": "1610150"
  },
  {
    "text": "values need to be encoded differently this is a URL encoded value because it's on the on the request line so test is",
    "start": "1610150",
    "end": "1616960"
  },
  {
    "text": "coming back from the server that means that we have an injection point the next thing we do is to check the syntax or",
    "start": "1616960",
    "end": "1622600"
  },
  {
    "text": "check what kind of script we're running here so we're doing an info level zero now you're learning how to start",
    "start": "1622600",
    "end": "1628779"
  },
  {
    "text": "building an attack I think in four levels zero gives us the context to where we are and as always the response",
    "start": "1628779",
    "end": "1639970"
  },
  {
    "text": "takes time because now it's doing a DNS request of something empty in the background which is not a quick thing to",
    "start": "1639970",
    "end": "1647470"
  },
  {
    "text": "do it takes exactly 120 seconds actually I forgot to press go there I think the",
    "start": "1647470",
    "end": "1654010"
  },
  {
    "text": "timeout request is something controlled by a back-end feature that we will look into more later as well ah there we go",
    "start": "1654010",
    "end": "1661830"
  },
  {
    "text": "so info level zero should give us a full list of the source code running on this device as an attacker we want to know",
    "start": "1661830",
    "end": "1668380"
  },
  {
    "text": "what the code looks like because we want to exploit it further in this case oh sorry I'm scanning through the code for",
    "start": "1668380",
    "end": "1677080"
  },
  {
    "text": "eval because I happen to know that eval is the the keyword for the bad thing but as an attacker you also do code",
    "start": "1677080",
    "end": "1682929"
  },
  {
    "text": "reviewing here so you're reviewing what's going on and you see that there is two evals one is on the response from",
    "start": "1682929",
    "end": "1689200"
  },
  {
    "text": "the table lookup and there's one is from the result line that's the one the one in the below there is the one I stole",
    "start": "1689200",
    "end": "1695320"
  },
  {
    "text": "from HSS or and the one on top is the one that's looking for the cache it's",
    "start": "1695320",
    "end": "1702100"
  },
  {
    "text": "looking for the cache is picking up the value and this means you don't have to have to understand all of this right now",
    "start": "1702100",
    "end": "1707980"
  },
  {
    "text": "but this means essentially that I can inject something in both eval cases so once it's doing eval on the content of",
    "start": "1707980",
    "end": "1714100"
  },
  {
    "text": "something on a table so I can inject something that will execute when someone else looks in the cache that's the same",
    "start": "1714100",
    "end": "1721840"
  },
  {
    "text": "as overriding someone else's cookie for instance and since the injection point",
    "start": "1721840",
    "end": "1727720"
  },
  {
    "text": "is inside of quotes then I can simply write semicolon in the",
    "start": "1727720",
    "end": "1736179"
  },
  {
    "text": "beginning and this is why it's so hard to do input sanitization like usually you do input sanitization by saying oh",
    "start": "1736179",
    "end": "1741760"
  },
  {
    "text": "let's remove all bad characters there is a lot of bad characters here or the first one would be spaced semicolon or a",
    "start": "1741760",
    "end": "1748929"
  },
  {
    "text": "hard bracket that's the easiest so we're looking for localhost semicolon and then",
    "start": "1748929",
    "end": "1754120"
  },
  {
    "text": "obvious writing in the line as if I was in the ticket file okay and right now I'm writing a line saying table sets",
    "start": "1754120",
    "end": "1760840"
  },
  {
    "text": "that sub table cash so I'm overwrite any cash I know what it's name because I know the source I'm using the value",
    "start": "1760840",
    "end": "1767679"
  },
  {
    "text": "local host and for the low value local host I'm doing it TCB colon colon respond owned so that's something I",
    "start": "1767679",
    "end": "1775000"
  },
  {
    "text": "guess it could be doing XSS or whatever or something else and then I select that",
    "start": "1775000",
    "end": "1781300"
  },
  {
    "text": "line and URL encoded eventually so that is V response will be running in that",
    "start": "1781300",
    "end": "1787179"
  },
  {
    "text": "eval that I'm selecting there okay so",
    "start": "1787179",
    "end": "1797020"
  },
  {
    "text": "now I'm running it without URL encoding and that's not good this will produce a syntax error in the device as a defender",
    "start": "1797020",
    "end": "1803920"
  },
  {
    "text": "right now if you're looking into your log files your cm system somewhere it will say syntax error this is an",
    "start": "1803920",
    "end": "1810490"
  },
  {
    "text": "indicator of an attack if you make CMM trees and look for syntax errors then",
    "start": "1810490",
    "end": "1816580"
  },
  {
    "text": "you will actually know when people are successfully or about to successfully inject code in your into your device and",
    "start": "1816580",
    "end": "1822910"
  },
  {
    "text": "that's something that's very good to do so right now I'm poisoning the cache by adding executable code into the value of",
    "start": "1822910",
    "end": "1830110"
  },
  {
    "text": "localhost and right now just sets the string that is going to run later and",
    "start": "1830110",
    "end": "1835390"
  },
  {
    "text": "the next time I make a request to localhost from the cache it says owned and this will occur to anyone who tries",
    "start": "1835390",
    "end": "1842710"
  },
  {
    "text": "to make a request on localhost and this is how you become a stored man-in-the-middle this is a Mendel middle essentially because I'm stored in",
    "start": "1842710",
    "end": "1849070"
  },
  {
    "text": "memory and a mental middle on other people's requests so that's one attack",
    "start": "1849070",
    "end": "1854650"
  },
  {
    "text": "vector for for forgetting persistence",
    "start": "1854650",
    "end": "1859980"
  },
  {
    "text": "there's something interesting about this piece of code because if I take this piece of code and I put it inside of the code viewer in in",
    "start": "1859980",
    "end": "1869500"
  },
  {
    "text": "my big IP web interface there is something going on on line 17 then you",
    "start": "1869500",
    "end": "1877179"
  },
  {
    "text": "see it's very colourful I don't like reading text I like colors but line 17 is very colorful it says eval table",
    "start": "1877179",
    "end": "1883720"
  },
  {
    "text": "lookup - sub table all this is written with colors if you look at line 21 it",
    "start": "1883720",
    "end": "1888850"
  },
  {
    "text": "says evil and then quote and everything is blue and this indicates to me that the person who wrote this syntax",
    "start": "1888850",
    "end": "1894789"
  },
  {
    "text": "highlighter does not completely understand the language because the moment you're using a quote it's exactly",
    "start": "1894789",
    "end": "1900399"
  },
  {
    "text": "equivalent to using hard brackets they should be colored the same way so that you actually understand that this line",
    "start": "1900399",
    "end": "1906669"
  },
  {
    "text": "is not safe this is executing something it's dangerous this is my fifth descent",
    "start": "1906669",
    "end": "1912850"
  },
  {
    "text": "on on the colors there but yeah so other post exploitation possibilities where do",
    "start": "1912850",
    "end": "1919659"
  },
  {
    "text": "you want to go from here scanning the internal network yes you want to do that because now you're having some kind of a",
    "start": "1919659",
    "end": "1925179"
  },
  {
    "text": "man-in-the-middle situation you want to scan localhost yes you want to do that because your service is running locally and you want to attack internal",
    "start": "1925179",
    "end": "1932409"
  },
  {
    "text": "resources using the f5 big IP device as a pivot and here's the print screen of a",
    "start": "1932409",
    "end": "1940990"
  },
  {
    "text": "command called active node list - list lb : : server pool this line URL encoded",
    "start": "1940990",
    "end": "1947169"
  },
  {
    "text": "when you run this it actually gives you a list of the internal servers that you are serving or that f5 is serving and",
    "start": "1947169",
    "end": "1953320"
  },
  {
    "text": "this gives you an indication of one of the servers or the server network that you want to actually break into as an",
    "start": "1953320",
    "end": "1959470"
  },
  {
    "text": "attacker maybe you're curious about this how do you connect to this guy well here",
    "start": "1959470",
    "end": "1964629"
  },
  {
    "text": "is a snippet that actually does a port scan on that line so that's something",
    "start": "1964629",
    "end": "1969970"
  },
  {
    "text": "you might want to copy later from this slides if you do this for each it's",
    "start": "1969970",
    "end": "1975009"
  },
  {
    "text": "trying to go through FTP the web port and some other ports and it's trying to",
    "start": "1975009",
    "end": "1980259"
  },
  {
    "text": "connect to this back-end courts and it's listing if it's open or close so this is essentially a one line or two maybe one",
    "start": "1980259",
    "end": "1987190"
  },
  {
    "text": "line port scanner that it turns into so now we know something about the background device here imagine like it",
    "start": "1987190",
    "end": "1995080"
  },
  {
    "text": "says 421 it's FTP that's usually not very safe so as an attacker I'm",
    "start": "1995080",
    "end": "2000600"
  },
  {
    "text": "implementing my own FTP client obviously and this FTP client now does in a non",
    "start": "2000600",
    "end": "2005850"
  },
  {
    "text": "anonymous login and that means receive two lines which is the banner lines and the login prompt you type in user",
    "start": "2005850",
    "end": "2013080"
  },
  {
    "text": "nonnamous the password a @a and then once you're logged in it's actually says on the right hand side 2:30 user logged",
    "start": "2013080",
    "end": "2020370"
  },
  {
    "text": "in and if you are a bank and you're running this device make sure to",
    "start": "2020370",
    "end": "2025740"
  },
  {
    "text": "firewall it so it doesn't so it's not possible to do this type of connection because specifically for banks to use",
    "start": "2025740",
    "end": "2031770"
  },
  {
    "text": "mainframe machines mainframe machines are usually control or sometimes controlled or FTP and that's something",
    "start": "2031770",
    "end": "2037350"
  },
  {
    "text": "that could be very dangerous if that mainframe computer is exposed I hope that makes sense so here's the attack",
    "start": "2037350",
    "end": "2045899"
  },
  {
    "text": "saying what it looks like I make a get request but inside of that get request I'm also adding something extra that's",
    "start": "2045899",
    "end": "2051780"
  },
  {
    "text": "turns it into an FTP request in the backend there's an FTP response and results are being produced back to the",
    "start": "2051780",
    "end": "2056940"
  },
  {
    "text": "browser and the attacker now knows that I can log into this FTP or download files",
    "start": "2056940",
    "end": "2062510"
  },
  {
    "text": "here's another port scan I did unfortunately a bit smaller on localhost and this is interesting because",
    "start": "2062510",
    "end": "2068190"
  },
  {
    "text": "localhost has some services that are unusual to me one is 666 I think that's the port for doom the game it's probably",
    "start": "2068190",
    "end": "2075118"
  },
  {
    "text": "not do but and there's also one 8100 which is some kind of a and nodejs",
    "start": "2075119",
    "end": "2080760"
  },
  {
    "text": "service that I haven't investigated much 66 was interesting to me because that service was running as root and the",
    "start": "2080760",
    "end": "2087148"
  },
  {
    "text": "service is called MC PD and this looks",
    "start": "2087149",
    "end": "2092368"
  },
  {
    "text": "weird I guess this is a very common command that runs internally once every",
    "start": "2092369",
    "end": "2097950"
  },
  {
    "text": "minute or so and what the command does is that it makes it query all it queries",
    "start": "2097950",
    "end": "2102990"
  },
  {
    "text": "everything from the NCPD system module system module is a very central module",
    "start": "2102990",
    "end": "2108210"
  },
  {
    "text": "it's looks like a bit of a memory dump but it contains a list of of demons running on the device right now it",
    "start": "2108210",
    "end": "2114030"
  },
  {
    "text": "doesn't do any you anything useful but this is the packet that you will pick up if you do a TCP dump on your f5 device",
    "start": "2114030",
    "end": "2121170"
  },
  {
    "text": "on that port you will see this packet coming in over and over again so replaying that packet is something interesting it doesn't give us too many",
    "start": "2121170",
    "end": "2127589"
  },
  {
    "text": "secrets so someone reverse-engineered a bit of this protocol and the results were",
    "start": "2127589",
    "end": "2133020"
  },
  {
    "text": "interesting because MC PD is pretty powerful running his route and all this",
    "start": "2133020",
    "end": "2139890"
  },
  {
    "text": "is the result of the reversing so there is a size indicator a sequence that it doesn't seem to care about much I don't",
    "start": "2139890",
    "end": "2145380"
  },
  {
    "text": "know exactly why but you can put any value there every course ID always set to zero flag can't exactly remember the",
    "start": "2145380",
    "end": "2153390"
  },
  {
    "text": "key is what type of request you're making if you're making a query all or query something specific or execute",
    "start": "2153390",
    "end": "2159450"
  },
  {
    "text": "something you can execute things here actually I think that the web interface",
    "start": "2159450",
    "end": "2165840"
  },
  {
    "text": "that you manage this device over communicates with the back-end service using this language and the query is",
    "start": "2165840",
    "end": "2171540"
  },
  {
    "text": "that it's making when I'm clicking around the web interface I see all these packets coming and they are doing different types of queries and sometimes",
    "start": "2171540",
    "end": "2177660"
  },
  {
    "text": "they execute commands there is a type field an attribute size and that's the",
    "start": "2177660",
    "end": "2183240"
  },
  {
    "text": "size 12 the coming bytes the attribute name which is interesting because",
    "start": "2183240",
    "end": "2188940"
  },
  {
    "text": "there's a bunch of modules I think there is more than a thousand modules maybe not so much but it's like hundreds of",
    "start": "2188940",
    "end": "2195360"
  },
  {
    "text": "modules that you can query and get different information out of and I'm gonna give you a few examples for that",
    "start": "2195360",
    "end": "2200790"
  },
  {
    "text": "and then there is attribute data if you're making a execution then yeah then you're doing this and essentially and",
    "start": "2200790",
    "end": "2206640"
  },
  {
    "text": "the message this to me looks a bit like the SSH protocol I'm not gonna say anything more but it's very similar",
    "start": "2206640",
    "end": "2214520"
  },
  {
    "start": "2214000",
    "end": "2261000"
  },
  {
    "text": "here's a request to the module that handles all the users I don't know if",
    "start": "2215600",
    "end": "2220830"
  },
  {
    "text": "you can see this but on the third line of the heck stamp it says admin a few",
    "start": "2220830",
    "end": "2226590"
  },
  {
    "text": "lines more down this is user which is user and then it says Willy which is William sir the value set up this",
    "start": "2226590",
    "end": "2232620"
  },
  {
    "text": "machine for me and that command that I'm now running as an execution I'm",
    "start": "2232620",
    "end": "2238770"
  },
  {
    "text": "injecting code into the server so that it runs something the sense a packet to localhost and gives the result back to",
    "start": "2238770",
    "end": "2244800"
  },
  {
    "text": "me now gave me a full list of the users locally stored in the web admin UI",
    "start": "2244800",
    "end": "2253560"
  },
  {
    "text": "there's no passwords as far as I can see but there's that",
    "start": "2253560",
    "end": "2258890"
  },
  {
    "start": "2261000",
    "end": "2364000"
  },
  {
    "text": "here's an interesting one so here's a command that lists the source code of",
    "start": "2261330",
    "end": "2269870"
  },
  {
    "text": "tickle some critical environment so TMS H this particular environment where you",
    "start": "2269870",
    "end": "2276480"
  },
  {
    "text": "can do back in configuration remember I said something about the DNS lookup timeout that's something that you could",
    "start": "2276480",
    "end": "2282750"
  },
  {
    "text": "figure in the TNS H as far as I know so it's a system running as root with tickle as an interpreter another",
    "start": "2282750",
    "end": "2290310"
  },
  {
    "text": "interpreter than the iris this is not the same thing as an eye-roll i cannot run i rules from here but from",
    "start": "2290310",
    "end": "2296400"
  },
  {
    "text": "MC pd i can run i rules i can actually change the bait versus query all to execute instead i run TMS age commands",
    "start": "2296400",
    "end": "2305130"
  },
  {
    "text": "from here i think i have not done it but i think i can and if you look at the highlighted line on the right hand side",
    "start": "2305130",
    "end": "2311220"
  },
  {
    "text": "it's a function called yet item local only that returns an eval evaluation of",
    "start": "2311220",
    "end": "2319190"
  },
  {
    "text": "something long that i cannot pronounce and arguments that was supplied by the user is being evaluated this is a",
    "start": "2319190",
    "end": "2325320"
  },
  {
    "text": "dangerous function and i'm pretty sure that this can be used to elevate to more",
    "start": "2325320",
    "end": "2330330"
  },
  {
    "text": "privileges perhaps routes at some point I know it's vague at this point and I",
    "start": "2330330",
    "end": "2335400"
  },
  {
    "text": "haven't had time to do the complete research on this but I think elevation would probably go through some of these",
    "start": "2335400",
    "end": "2340740"
  },
  {
    "text": "scripts and this is something that I'm trying to work with f5 on 26 he has to make this code safe and I think there",
    "start": "2340740",
    "end": "2347730"
  },
  {
    "text": "can be a lot done to separate the context so that for instance a socket cannot even be open to localhost that",
    "start": "2347730",
    "end": "2353880"
  },
  {
    "text": "would be a pretty good start to avoid this kind of local privilege escalations",
    "start": "2353880",
    "end": "2362150"
  },
  {
    "text": "so what we're dealing with here is an attack chain where I have first I rule access I query the mCP D I get a",
    "start": "2362150",
    "end": "2369630"
  },
  {
    "start": "2364000",
    "end": "2425000"
  },
  {
    "text": "response like it executes some kind of MC PD command over 40m SH and do a TCL",
    "start": "2369630",
    "end": "2376770"
  },
  {
    "text": "injection in them TM SH environment something something and then get local privileges I'm",
    "start": "2376770",
    "end": "2382740"
  },
  {
    "text": "assuming I think this is the an attack pass to actually take permanent control of the device at this point I'm hoping",
    "start": "2382740",
    "end": "2389220"
  },
  {
    "text": "that this will be fixed soon and that there will be a separation and",
    "start": "2389220",
    "end": "2394920"
  },
  {
    "text": "keen on people not being harmed by this and I'm really really keen on trying to",
    "start": "2394920",
    "end": "2400350"
  },
  {
    "text": "make sure that people understand how dangerous I rule access can be if",
    "start": "2400350",
    "end": "2405510"
  },
  {
    "text": "someone else gets access and control of your I rules they can do really really bad things to your organization's they",
    "start": "2405510",
    "end": "2411840"
  },
  {
    "text": "can listen to your traffic they can inject things and reroute traffic in ways that you would want to avoid I",
    "start": "2411840",
    "end": "2419700"
  },
  {
    "text": "think okay so let's go as through a summary we have eleven minutes left",
    "start": "2419700",
    "end": "2425750"
  },
  {
    "text": "where we talk about detection because defense is very important TCL scan is a tool intended initially",
    "start": "2425750",
    "end": "2432960"
  },
  {
    "text": "for scanning for TCL injections in TCL tools I did not write this tool but I",
    "start": "2432960",
    "end": "2438390"
  },
  {
    "text": "fixed it because it would utterly broken it's written in rust and it takes a bit of working to get running but once you",
    "start": "2438390",
    "end": "2443940"
  },
  {
    "text": "do you can run it on your trail if you translate your eye rolls into pure tickle which you can get a script I",
    "start": "2443940",
    "end": "2449310"
  },
  {
    "text": "provided in my github if you run this tool you get highlights of all the lines",
    "start": "2449310",
    "end": "2455760"
  },
  {
    "text": "in the script that's dangerous or perhaps dangerous warnings and danger and that's something you want to integrate into your kit if you're using",
    "start": "2455760",
    "end": "2462480"
  },
  {
    "text": "it for version control of Eros you want to make sure that this tool is running",
    "start": "2462480",
    "end": "2468180"
  },
  {
    "text": "and shaking your lines because it will detect most of the problems you have and then you can get a bit of a spanking for",
    "start": "2468180",
    "end": "2475380"
  },
  {
    "text": "doing it wrong hopefully I have made a tool that's being released today at",
    "start": "2475380",
    "end": "2481890"
  },
  {
    "text": "blackhat right now it's available in burp suite if you have burp suite you go to the BAP store the burp app store and",
    "start": "2481890",
    "end": "2488670"
  },
  {
    "text": "you search for I rule detection this tool or I roll detector this tool will",
    "start": "2488670",
    "end": "2495540"
  },
  {
    "text": "try to replace every single field in a request if you mark if you request and you click right click and press Center",
    "start": "2495540",
    "end": "2502290"
  },
  {
    "text": "active scanner you'll get a report of every type of field that actually can be run for injection that causes the same",
    "start": "2502290",
    "end": "2509369"
  },
  {
    "text": "code to be running back to you and it's essentially doing what I showed in the slides previously but much more",
    "start": "2509369",
    "end": "2514770"
  },
  {
    "text": "automated and so far I found lots and lots of floss doing this I just download open source code don't review it at all",
    "start": "2514770",
    "end": "2521340"
  },
  {
    "text": "you just run it there and then I run this at all and it just finds the bugs for you if you're in bug bounty",
    "start": "2521340",
    "end": "2527190"
  },
  {
    "text": "this is a tool you're looking for if you are on the defense side this is a tool you're looking for okay so that's",
    "start": "2527190",
    "end": "2535830"
  },
  {
    "text": "available for free for you now unit testing this is a tool I did not write",
    "start": "2535830",
    "end": "2541560"
  },
  {
    "start": "2538000",
    "end": "2609000"
  },
  {
    "text": "either a nice and Weejun guy did and it's called testicle unfortunately I did",
    "start": "2541560",
    "end": "2549870"
  },
  {
    "text": "not choose that name so testicle if you seen it out it's it's at all the where",
    "start": "2549870",
    "end": "2557130"
  },
  {
    "text": "you can do unit testing for your eye roll see essentially you put up your eye rolls hopefully they're short and easy",
    "start": "2557130",
    "end": "2562770"
  },
  {
    "text": "to read and you can use unit testing and this can test your logic in the program because there's so many bugs that are",
    "start": "2562770",
    "end": "2568560"
  },
  {
    "text": "not related to what I'm talking about that you still want to catch like are there infinite loops are there cases",
    "start": "2568560",
    "end": "2573840"
  },
  {
    "text": "where you get a connection timeout are their errors bugs this tool fixes or finds that for you pretty easily and",
    "start": "2573840",
    "end": "2579810"
  },
  {
    "text": "that's also something you can integrate into a get hook when you're doing version control of your scripts I was",
    "start": "2579810",
    "end": "2585930"
  },
  {
    "text": "contributing a bit to this added adding cookie support and played around with HTTP when I did I had a bit of a problem",
    "start": "2585930",
    "end": "2592440"
  },
  {
    "text": "because I was trying out this thing with injections and this tool does not it",
    "start": "2592440",
    "end": "2599670"
  },
  {
    "text": "actually has a lot of injections in it it does evil all the time and because everyone does and so it also crashes if",
    "start": "2599670",
    "end": "2605760"
  },
  {
    "text": "you try to do that sorry so a summary",
    "start": "2605760",
    "end": "2612540"
  },
  {
    "start": "2609000",
    "end": "2711000"
  },
  {
    "text": "slide finally tickle is old and tried language but it's loosely defined which",
    "start": "2612540",
    "end": "2618600"
  },
  {
    "text": "means the position is very important for what you're doing the coding is even more important it's easy to fool for an",
    "start": "2618600",
    "end": "2624570"
  },
  {
    "text": "attacker it's hard to get a variable assignment the substitutions right it's very hard to do it right read the",
    "start": "2624570",
    "end": "2630870"
  },
  {
    "text": "document called at the Decalogue read my right paper released with this it will help a lot and i'm also giving a",
    "start": "2630870",
    "end": "2636180"
  },
  {
    "text": "description on how to do code review because the art of code review is not so easy but there is ways you can search",
    "start": "2636180",
    "end": "2641880"
  },
  {
    "text": "for certain things so you search for eval your search for subs and search for expert that's the first thing you do",
    "start": "2641880",
    "end": "2647310"
  },
  {
    "text": "then you start looking at how our while loops handle body arguments how are they",
    "start": "2647310",
    "end": "2652890"
  },
  {
    "text": "handled that sort of stuff take care to use bracing on the body arguments or",
    "start": "2652890",
    "end": "2659490"
  },
  {
    "text": "things so if something has to body argument use bracing used aural detector to detect if there is any",
    "start": "2659490",
    "end": "2666630"
  },
  {
    "text": "injection possibilities it's a pretty competent at this point I think there can be more features added to it if you",
    "start": "2666630",
    "end": "2673200"
  },
  {
    "text": "want to contribute it's open source just go ahead you can use tickle scan to review the code automatically review the",
    "start": "2673200",
    "end": "2680160"
  },
  {
    "text": "code it's in cache everything so do manual code review and know your and use testicle to try the logic and if",
    "start": "2680160",
    "end": "2691500"
  },
  {
    "text": "you cannot do a code review admit it and ask someone else like me to do it or you know whatever company because you need",
    "start": "2691500",
    "end": "2698220"
  },
  {
    "text": "to look at what you're doing you're responsible this is an advanced product you can do it wrong don't do it wrong",
    "start": "2698220",
    "end": "2703500"
  },
  {
    "text": "and if you think you might be doing it wrong ask someone else to do it for you",
    "start": "2703500",
    "end": "2709550"
  },
  {
    "text": "that's about my final slide I'm so happy for your focus and for you being here",
    "start": "2709550",
    "end": "2715200"
  },
  {
    "start": "2711000",
    "end": "2935000"
  },
  {
    "text": "listening to this and I hope this provided a new type of tool for your for",
    "start": "2715200",
    "end": "2720300"
  },
  {
    "text": "your future engagements thank you [Applause]",
    "start": "2720300",
    "end": "2725439"
  },
  {
    "text": "to ask questions there's microphones in the middle of the room please use those microphones hey thank you for your",
    "start": "2728420",
    "end": "2739050"
  },
  {
    "text": "presentation I was wondering though if you've looked at being able to steal a cell certificates through the eye roll",
    "start": "2739050",
    "end": "2745710"
  },
  {
    "text": "injection are they exposed in that space okay I did that yeah I think I ran an",
    "start": "2745710",
    "end": "2752070"
  },
  {
    "text": "MCP deep command once I hadn't documented well but I did an MCB D command once that gave me the private",
    "start": "2752070",
    "end": "2758580"
  },
  {
    "text": "keys I think and there might even be an arrow command to that but I'm not entirely sure but I'm but yeah you're",
    "start": "2758580",
    "end": "2765150"
  },
  {
    "text": "saying it's pretty sure you can do it yeah thank you yeah I got a nod from F fights my",
    "start": "2765150",
    "end": "2774840"
  },
  {
    "text": "question centers it around sanitization it sounds like if you sanitize all your input you know you shouldn't trust anything from an",
    "start": "2774840",
    "end": "2781170"
  },
  {
    "text": "external user anyway if you sanitize everybody not that you can't apply these also you should be okay yeah I think",
    "start": "2781170",
    "end": "2789180"
  },
  {
    "text": "that's a really good way to go sanitization goes a long way imagine you're sanitizing the user agent the",
    "start": "2789180",
    "end": "2796050"
  },
  {
    "text": "user agent contains hard brackets it contains semicolons like you can take",
    "start": "2796050",
    "end": "2801600"
  },
  {
    "text": "them away because then you're lying about the user agent so that's it's tricky you know it's like you can't do",
    "start": "2801600",
    "end": "2808350"
  },
  {
    "text": "it sometimes and please do so sometimes you just need to avoid putting things in dangerous positions - my",
    "start": "2808350",
    "end": "2817830"
  },
  {
    "text": "question is uh can you just use net can as a poor net can't as a poor-man's burp",
    "start": "2817830",
    "end": "2823170"
  },
  {
    "text": "suite yeah for sure I mean all this you can do netiquette and sometimes actually do",
    "start": "2823170",
    "end": "2828300"
  },
  {
    "text": "these requests directly in that cat definitely I guess you could probably port these tools that I put out there to",
    "start": "2828300",
    "end": "2834810"
  },
  {
    "text": "just run directly without having burp in the first place if that's what you want",
    "start": "2834810",
    "end": "2840859"
  },
  {
    "text": "hey thank you for this presentation did you get to look at maybe the competing",
    "start": "2840859",
    "end": "2846060"
  },
  {
    "text": "product so a ten and then a flex language I realized I was supposed to",
    "start": "2846060",
    "end": "2851100"
  },
  {
    "text": "repeat the questions did I look at competing product like eight and an eight flex language I did not I'm sorry about that but I tried to focus on this",
    "start": "2851100",
    "end": "2857700"
  },
  {
    "text": "ts get this much out of it as possible I am looking now and I'm about to look",
    "start": "2857700",
    "end": "2863040"
  },
  {
    "text": "and I've started to realize that this is a thing complexity always creates problems and yes there might be other",
    "start": "2863040",
    "end": "2869310"
  },
  {
    "text": "things there I have a few research projects awaiting related to similar",
    "start": "2869310",
    "end": "2874500"
  },
  {
    "text": "products products that I cannot disclose yet sorry but there will be more if you",
    "start": "2874500",
    "end": "2884430"
  },
  {
    "text": "have a wofe will it protect your bad eye rules which one takes priority the eye",
    "start": "2884430",
    "end": "2889800"
  },
  {
    "text": "roll or the walls yeah it's a good question I tried this with a wolf I I'm not 100% certain but I think the I will",
    "start": "2889800",
    "end": "2898109"
  },
  {
    "text": "came first and then the wolf in in my case and also the wolf at this point",
    "start": "2898109",
    "end": "2904290"
  },
  {
    "text": "does not have rules for these type of injections it's very hard to do in the first place honestly but I think the I",
    "start": "2904290",
    "end": "2912599"
  },
  {
    "text": "rule comes first which means that it does circumvent the wealth because the wealth is not intended for defending",
    "start": "2912599",
    "end": "2917730"
  },
  {
    "text": "death big-ip device since I can see you",
    "start": "2917730",
    "end": "2924839"
  },
  {
    "text": "I don't know if there's any more questions but welcome to thank you so much for joining the session if you have",
    "start": "2924839",
    "end": "2929849"
  },
  {
    "text": "further questions for our presenter please meet him in the hallway area thank you",
    "start": "2929849",
    "end": "2937040"
  }
]