[
  {
    "start": "0",
    "end": "11000"
  },
  {
    "text": "[Music]",
    "start": "740",
    "end": "4850"
  },
  {
    "text": "welcome everybody we're in track six over the air and in the device our next",
    "start": "10719",
    "end": "16039"
  },
  {
    "start": "11000",
    "end": "11000"
  },
  {
    "text": "speaker is Matthew rally with how many bricks does it take to crack a micro",
    "start": "16039",
    "end": "21880"
  },
  {
    "text": "cell uh all right so the slides that are on the the um CD are not up to date this",
    "start": "21880",
    "end": "30000"
  },
  {
    "text": "Link at the bottom has the slides on the white paper uh the white paper has a little bit more detail about than what",
    "start": "30000",
    "end": "35079"
  },
  {
    "text": "I'm going to be talking about but if anyone wants it it's all right there it'll also be on the last slide of the",
    "start": "35079",
    "end": "40200"
  },
  {
    "text": "presentation um so again my name is Matthew Raleigh I'm currently a senior security cons",
    "start": "40200",
    "end": "46879"
  },
  {
    "text": "consultant at Modano um I typically hate when people give backgrounds on themselves before they start the",
    "start": "46879",
    "end": "52280"
  },
  {
    "text": "presentation but I think it's pretty applicable to my talk uh it's going to go through Hardware level all the way to",
    "start": "52280",
    "end": "58039"
  },
  {
    "text": "software level however my background is always been in software so some of the stuff that I'm going to talk about in a",
    "start": "58039",
    "end": "64119"
  },
  {
    "text": "hardware perspective may or may not use the terminology correctly but just be a",
    "start": "64119",
    "end": "69600"
  },
  {
    "text": "forewarning about what I'm going to be talking about um so in terms of agenda uh this",
    "start": "69600",
    "end": "76759"
  },
  {
    "text": "talk is focusing strictly on the reversing from a hardware perspective all the way up to the software perspective of this specific micro cell",
    "start": "76759",
    "end": "83040"
  },
  {
    "text": "that I was looking at uh it's not focusing on any of the GSM or 3G technology so apologize if someone",
    "start": "83040",
    "end": "89280"
  },
  {
    "text": "anyone's here hoping for that uh there was good talks last year on that specific case uh but I'll start with the",
    "start": "89280",
    "end": "96200"
  },
  {
    "text": "device background then start talking about my battle with the network uh the communication that the device actually",
    "start": "96200",
    "end": "102079"
  },
  {
    "text": "performs then the cage which is actually just the surrounding cover of the device",
    "start": "102079",
    "end": "107119"
  },
  {
    "text": "then I'll get into the hardware aspects of it talking about the debug pins on the actual device uh going through SPI",
    "start": "107119",
    "end": "112759"
  },
  {
    "text": "JTAG serial communication that it performs and then um go to the soft",
    "start": "112759",
    "end": "117799"
  },
  {
    "text": "software aspect of it and looking at you some kernel reversing firmware extraction and binary",
    "start": "117799",
    "end": "125360"
  },
  {
    "text": "reversing uh so first background on this specific device uh I'm assuming everyone",
    "start": "125439",
    "end": "130479"
  },
  {
    "text": "here knows what a micro cell is it's a device that you plug into your internet connection at home and your cell phone",
    "start": "130479",
    "end": "136640"
  },
  {
    "text": "connects to it and back huls all of your cell communication through your network connection so it will instead of connect",
    "start": "136640",
    "end": "142959"
  },
  {
    "text": "your phone instead of connecting to a cell tower will connect to this device the one in particular I was looking at",
    "start": "142959",
    "end": "148280"
  },
  {
    "text": "had a webbased interface that was hosted on the service providers web page there was really no interaction that I could",
    "start": "148280",
    "end": "154319"
  },
  {
    "text": "have with the physical device that I had uh in my hands the configuration was done on an external web page and then",
    "start": "154319",
    "end": "161120"
  },
  {
    "text": "somehow pushed either to the device or pushed to to your phone which would allow you to connect to it uh you had to",
    "start": "161120",
    "end": "167080"
  },
  {
    "text": "provision specific phone numbers in that web page so not anyone who just comes into my apartment would connect to it um",
    "start": "167080",
    "end": "173239"
  },
  {
    "text": "and I think there was a maximum of 15 or 20 that you could actually uh allow to connect to your device",
    "start": "173239",
    "end": "181360"
  },
  {
    "text": "um I started looking at this device because my cell reception was horrible",
    "start": "181360",
    "end": "186560"
  },
  {
    "text": "in my apartment and somehow the service provider proactively sent me a card saying hey we notice a lot of your phone",
    "start": "186560",
    "end": "192519"
  },
  {
    "text": "calls are being dropped here's a free device if you go to the store and pick it up um at the same time I was at this",
    "start": "192519",
    "end": "199000"
  },
  {
    "text": "point in time I was working at interpretor group with which focused on mobile security so those two hand inand",
    "start": "199000",
    "end": "204319"
  },
  {
    "text": "kind of made sense to start looking at this device again I like I said before I've always been a software person",
    "start": "204319",
    "end": "210439"
  },
  {
    "text": "uh so I shukan last year Steven rley did a talk about hardware for software guys",
    "start": "210439",
    "end": "215920"
  },
  {
    "text": "which kind of also fed into this whole interest in trying to look at the hardware aspect of of security so it was",
    "start": "215920",
    "end": "222439"
  },
  {
    "text": "it was a good learning um learning tool for me so the first thing that I wanted to",
    "start": "222439",
    "end": "228840"
  },
  {
    "text": "look at when when reversing this device was network communication uh I didn't have to actually do anything physical to",
    "start": "228840",
    "end": "234560"
  },
  {
    "text": "it uh I was I connected the device to a server that I had in my apartment which with which had two Nicks and then just",
    "start": "234560",
    "end": "241560"
  },
  {
    "text": "monitored the communication uh it doesn't have any Wireless functionality in terms of Wi-Fi so I actually had to",
    "start": "241560",
    "end": "247480"
  },
  {
    "text": "physically connect this to a box but looking at TCB dump I saw https traffic",
    "start": "247480",
    "end": "252840"
  },
  {
    "text": "an IP set tunnel that was initialized and uh some multicast stuff which I kind of just didn't think about uh The Next",
    "start": "252840",
    "end": "260040"
  },
  {
    "text": "Step what what I tried was to uh get man in the middle of the traffic the https",
    "start": "260040",
    "end": "265080"
  },
  {
    "text": "traffic with mallerie which is a software that was written in tpus group that facilitated",
    "start": "265080",
    "end": "270240"
  },
  {
    "text": "all men in-the-middle communication uh and and manages all the certificates for you however it was all mutually",
    "start": "270240",
    "end": "277360"
  },
  {
    "text": "authenticated I couldn't get in the middle of the IPC tunnel and the multicast stuff was kind of confusing to",
    "start": "277360",
    "end": "282960"
  },
  {
    "text": "me so in this case the the network beat me on this one um I didn't gain any additional information from the device",
    "start": "282960",
    "end": "289600"
  },
  {
    "text": "looking at the network communication traffic it was essentially all encrypted uh the next thing I started",
    "start": "289600",
    "end": "295039"
  },
  {
    "text": "looking at was physically taking taking the device apart or looking at the cage um uh this is what the device looks like",
    "start": "295039",
    "end": "301840"
  },
  {
    "text": "there are two screws on the bottom of on the orange panel at the bottom underneath a piece of tape you unscrew",
    "start": "301840",
    "end": "308160"
  },
  {
    "text": "those the two white that then that orange panel can come off then the on the sides there's two white panels that",
    "start": "308160",
    "end": "314840"
  },
  {
    "text": "can come off as well and then finally the board is actually connected to the gray part in the middle so my idea was",
    "start": "314840",
    "end": "322680"
  },
  {
    "text": "to unscrew it and just start pulling everything apart and seeing what what would would happen after I did that I",
    "start": "322680",
    "end": "328360"
  },
  {
    "text": "tried booting it and um oh this is this is what it looks like disassembled uh you can see there's four",
    "start": "328360",
    "end": "334400"
  },
  {
    "text": "four panels the board would connect in the middle of it but after trying to boot it again it",
    "start": "334400",
    "end": "341080"
  },
  {
    "text": "didn't turn on uh it just sat there with a light flashing so another this is",
    "start": "341080",
    "end": "346840"
  },
  {
    "text": "Brick number one that I had on my hands however I called customer support",
    "start": "346840",
    "end": "352680"
  },
  {
    "text": "and and tried to convinced them that I had no idea what was going on the thing just stopped working",
    "start": "352680",
    "end": "358479"
  },
  {
    "text": "um and",
    "start": "358479",
    "end": "364319"
  },
  {
    "text": "uh so I I ended up after about 30 minutes of debugging the device within first tier support I ended up getting",
    "start": "364319",
    "end": "370520"
  },
  {
    "text": "the customer service support people or the the technical support people and they uh they were they kept saying that",
    "start": "370520",
    "end": "376160"
  },
  {
    "text": "the tamper flag was switched on their server end of things and or on their on",
    "start": "376160",
    "end": "381199"
  },
  {
    "text": "their console that they're looking at which to me I started to tried to start pushing buttons and trying to like tried",
    "start": "381199",
    "end": "386639"
  },
  {
    "text": "to dive further into that to see like hey can you just turn this tamper flag off so it works again and he was like it",
    "start": "386639",
    "end": "391919"
  },
  {
    "text": "doesn't work that way have you and they kept asking me if I had dropped the device or if I had pulled it apart at all and of course I said no but uh",
    "start": "391919",
    "end": "400160"
  },
  {
    "text": "eventually I ended up pulling a story out saying that the cleaning ladies had come in the day",
    "start": "400160",
    "end": "405440"
  },
  {
    "text": "before and they must have done something to it or it must have fallen off a ledge or something so in the end he just said",
    "start": "405440",
    "end": "411080"
  },
  {
    "text": "go to the store and um you can replace it for free we'll just give you a new one so I went to the store got a new one",
    "start": "411080",
    "end": "419039"
  },
  {
    "text": "and now it's Round Two Against the Cage this time I was a little bit more careful when I was pulling it apart I noticed this these these sets of jumpers",
    "start": "419039",
    "end": "426160"
  },
  {
    "text": "that were on the front and the back of the board so there's three jumpers this is this is this is the back of it but",
    "start": "426160",
    "end": "431759"
  },
  {
    "text": "there's these three jumpers and then that gray piece is underneath the jumpers the jumpers are just like the things that you put in the back of a",
    "start": "431759",
    "end": "437319"
  },
  {
    "text": "hard drive to determine if it's a master or a slave um but what I didn't notice",
    "start": "437319",
    "end": "443360"
  },
  {
    "text": "when I first took this apart was that when the the outside white parts of that cage are actually connected with a",
    "start": "443360",
    "end": "448560"
  },
  {
    "text": "little clip to these that great part so when you pull it apart those jumpers pop off um two of the jumpers or in my case",
    "start": "448560",
    "end": "455120"
  },
  {
    "text": "two of the jumpers were fake jumpers and one of them was actually real it completed a circuit on these two pins",
    "start": "455120",
    "end": "460280"
  },
  {
    "text": "that were on there so what what I was thinking that happened is when I turned it on it checked these jumpers to make sure that they were in the right",
    "start": "460280",
    "end": "466120"
  },
  {
    "text": "configuration and then it would send a signal if they weren't back to the mother ship to tell them that someone's",
    "start": "466120",
    "end": "473039"
  },
  {
    "text": "messing with this device you shouldn't let it move forward um so in order to get around",
    "start": "473039",
    "end": "479400"
  },
  {
    "text": "this when I was pulling off the bottom part I I could see like uh couple millimeters I had space to uh slide",
    "start": "479400",
    "end": "487680"
  },
  {
    "text": "something in so I just bought this saw from Home Depot looks like the one down there and I started sawing through these",
    "start": "487680",
    "end": "492840"
  },
  {
    "text": "little this the clip that was connected to the jumpers i' had never seen any sort of Hardware protection like this before and I was like it it just didn't",
    "start": "492840",
    "end": "499159"
  },
  {
    "text": "make sense to me and how easy it was to get around but I mean obviously they got me the first time um after doing that",
    "start": "499159",
    "end": "506440"
  },
  {
    "text": "sawing those off the jumper stayed on next time I booted it it worked fine I was able to",
    "start": "506440",
    "end": "511680"
  },
  {
    "text": "uh I was able to dismantle the cage and successfully boot the device on its own",
    "start": "511680",
    "end": "516919"
  },
  {
    "text": "uh just as a board without anything surrounding it so in this case I I beat the I beat the cage finally uh so this",
    "start": "516919",
    "end": "523518"
  },
  {
    "text": "is what the the board actually looks like uh there's uh the in green there's the main",
    "start": "523519",
    "end": "530399"
  },
  {
    "text": "components that are highlighted it's kind of you can see it pretty well uh and then in blue and red there are these",
    "start": "530399",
    "end": "536519"
  },
  {
    "text": "sets of um debug pins or what what I thought were debug pins that I was going to focus on first from a hardware",
    "start": "536519",
    "end": "541920"
  },
  {
    "text": "perspective because again I have no ability to communicate with this device and everything that's happening that I could see was all encrypted so I had to",
    "start": "541920",
    "end": "549200"
  },
  {
    "text": "figure out some way of actually communicating with it on the left there's a GPS chip um when you register",
    "start": "549200",
    "end": "554360"
  },
  {
    "text": "the device on the web page it uh it forces you to also give a specific",
    "start": "554360",
    "end": "559880"
  },
  {
    "text": "location of where it's going to be working for emergency 911 stuff like that um and then there's a r Link in the",
    "start": "559880",
    "end": "567800"
  },
  {
    "text": "middle the GSM portion under that heat sink in the middle bottom xyl link chip",
    "start": "567800",
    "end": "572839"
  },
  {
    "text": "that's a black box and then the Pico chip on the right which is under another heat",
    "start": "572839",
    "end": "578600"
  },
  {
    "text": "sink so the the four like different sets of debug pins that I'm going to go over",
    "start": "578640",
    "end": "583760"
  },
  {
    "text": "are just labeled I don't know exactly what the letters and numbers mean but",
    "start": "583760",
    "end": "589320"
  },
  {
    "text": "that's how I reference them throughout the rest of the talk so there's c541 jp12 5 and six pl1 and",
    "start": "589320",
    "end": "595680"
  },
  {
    "text": "pl2 so the first set of pins that I was looking at was a CS 541 which just were",
    "start": "595680",
    "end": "601000"
  },
  {
    "start": "596000",
    "end": "596000"
  },
  {
    "text": "holes in this in the board that um that looked like a header had just been",
    "start": "601000",
    "end": "606480"
  },
  {
    "text": "pulled off of it uh or just not been put into it um and the tool that I used to",
    "start": "606480",
    "end": "614120"
  },
  {
    "text": "actually analyze the data that was going over this is a called a solle logic analyzer logic analyzer um a logic",
    "start": "614120",
    "end": "619760"
  },
  {
    "text": "analyzer is a device that you actually plug into or you you set you connect to these specific Hardware pins and it will",
    "start": "619760",
    "end": "626920"
  },
  {
    "text": "sample those pins at every so at specific intervals in time and over a",
    "start": "626920",
    "end": "631959"
  },
  {
    "text": "specific amount of time and tell you if it's a one or a zero basically if it's a high voltage or no voltage and then from",
    "start": "631959",
    "end": "637279"
  },
  {
    "text": "there it can uh analyze that set of data and give you some a text representation",
    "start": "637279",
    "end": "642320"
  },
  {
    "text": "or a hex representation of what's actually being communicated over these pins so the workl that I was going to",
    "start": "642320",
    "end": "648000"
  },
  {
    "text": "use in order to determine what data was going on this was first to use a multimedia to make sure that uh once I",
    "start": "648000",
    "end": "654279"
  },
  {
    "text": "do plug my my my logic analyzer into this it's not going to blow up it's not sending a huge",
    "start": "654279",
    "end": "659600"
  },
  {
    "text": "um High signal that's going to actually cause the thing to fail uh from there I was going to plug the logic analyzer",
    "start": "659600",
    "end": "666000"
  },
  {
    "text": "into the pins start the logic software which runs on your computer and then um",
    "start": "666000",
    "end": "671639"
  },
  {
    "text": "plug the device in when I think data has been transmitted stop the logic software and then try to analyze it with uh the",
    "start": "671639",
    "end": "677959"
  },
  {
    "text": "preset analyzers that they have built into the logic software this",
    "start": "677959",
    "end": "684240"
  },
  {
    "text": "is this is what it looks like when uh when you plug all this stuff in um",
    "start": "684240",
    "end": "689480"
  },
  {
    "text": "as you can see it's uh it's very fun to do uh this case it was actually not the pins that I'm looking at now but on this",
    "start": "689480",
    "end": "695720"
  },
  {
    "text": "one I actually had 14 plugged into the logic the so that black box is the actual at the top of the image is the",
    "start": "695720",
    "end": "702480"
  },
  {
    "text": "the actual Cay logic analyzer that plugs into your computer and then the other side obviously plugs into the pins on",
    "start": "702480",
    "end": "707959"
  },
  {
    "text": "the board so after I after I started this and was following my methodology I see",
    "start": "707959",
    "end": "713639"
  },
  {
    "text": "the top which is a zoomed out version of this um I was sampling at 16 MHz which",
    "start": "713639",
    "end": "719320"
  },
  {
    "text": "uh was fairly high for this amount of pins um and this the top image is of",
    "start": "719320",
    "end": "725480"
  },
  {
    "text": "about 40 seconds of sampling 35 seconds of sampling as you can see there's just these little blips that are happening",
    "start": "725480",
    "end": "731560"
  },
  {
    "text": "there but when you zoom into it on the bottom you'll see that it's just each one of those blips is up and down and obviously the bottom means that there's",
    "start": "731560",
    "end": "737600"
  },
  {
    "text": "no uh nothing going over that pin and on the top means that there is something going over that pin so since there's",
    "start": "737600",
    "end": "743839"
  },
  {
    "text": "only one I was going through all these analyzers and knowing nothing about what any of this is uh I eventually end up",
    "start": "743839",
    "end": "750440"
  },
  {
    "text": "applying this async serial one to it which had a thing called Auto which Auto",
    "start": "750440",
    "end": "756320"
  },
  {
    "text": "automatically determined the B rate or the the how fast the it should be reading this and as you can see on the",
    "start": "756320",
    "end": "764560"
  },
  {
    "text": "on the the little bubbles above everything it automatically determined that all the there was actually data so it's like you can see that like backr",
    "start": "764560",
    "end": "771600"
  },
  {
    "text": "back sln on the on the last part of that so from there I was able to export that",
    "start": "771600",
    "end": "776920"
  },
  {
    "text": "data uh into a CSV file pulled it open into Excel and then copied and pasted",
    "start": "776920",
    "end": "782360"
  },
  {
    "text": "the specific pin that I was looking at into VI and this is and then did some manipulation so it wasn't you know one",
    "start": "782360",
    "end": "788920"
  },
  {
    "text": "character per line and this is what I ended up coming out with as you can see there's one specific string that that",
    "start": "788920",
    "end": "794079"
  },
  {
    "text": "shows up commonly through that and that's a dollar sign gpga A2 something something",
    "start": "794079",
    "end": "799800"
  },
  {
    "text": "something now after Googling that I just saw that it was GPS related data it was",
    "start": "799800",
    "end": "806000"
  },
  {
    "text": "however the GPS chip was sending its coordinates to some other chip whatever the receiving chip was uh it really",
    "start": "806000",
    "end": "813440"
  },
  {
    "text": "didn't interest me at all because I didn't that my goal is to gain access to the device and the the GPS stuff",
    "start": "813440",
    "end": "820199"
  },
  {
    "text": "whatever however reading on some of the fors people were saying that it would be cool if you could use this device in",
    "start": "820199",
    "end": "825440"
  },
  {
    "text": "other countries because then you won't have to roam but when you try to register it or when the GPS sends back",
    "start": "825440",
    "end": "830920"
  },
  {
    "text": "to home that you're in a different country the thing stops working so it's possible uh theoretically possible to",
    "start": "830920",
    "end": "837199"
  },
  {
    "text": "pull this chip off to First log all the data that's being transmitted pull the chip off create something else that's",
    "start": "837199",
    "end": "843959"
  },
  {
    "text": "just sending like your home address or your home GPS signals in the same format and you can bring it to another country",
    "start": "843959",
    "end": "850199"
  },
  {
    "text": "for example and start using your cell phone in that country um I don't know if that's possible but again not something",
    "start": "850199",
    "end": "856360"
  },
  {
    "text": "that I was really interested in so in this I in this case I I learned a lot of this Asing serial protocol and",
    "start": "856360",
    "end": "863759"
  },
  {
    "text": "uh how to actually get data off of off of these pins however it didn't get me any Step Closer to my goal of actually",
    "start": "863759",
    "end": "869680"
  },
  {
    "text": "gaining access to the device the next set of pins were a little bit more interesting they looked",
    "start": "869680",
    "end": "874759"
  },
  {
    "text": "exactly the same um were labeled jp1 uh which were right next to one of the r",
    "start": "874759",
    "end": "880519"
  },
  {
    "text": "the ra link chip uh I did basically the same workflow that I was talking about before plugging in the slay booting it",
    "start": "880519",
    "end": "886040"
  },
  {
    "text": "up starting the software and trying to analyze it um this is so this is the the",
    "start": "886040",
    "end": "891480"
  },
  {
    "text": "top is what the zoomed out version of the jp1 stuff uh as you can see the bottom on was what we were looking at",
    "start": "891480",
    "end": "896680"
  },
  {
    "text": "before as you can see there's just like little blips over time where as the jp1 there's this huge blob of data and then",
    "start": "896680",
    "end": "902399"
  },
  {
    "text": "nothing so you as you'll see later on or the next slide that that you can just",
    "start": "902399",
    "end": "908680"
  },
  {
    "text": "based on the pattern of the data that's going across specific uh debug pins you can kind of uh infer what what's",
    "start": "908680",
    "end": "916160"
  },
  {
    "text": "happening so after pulling all that data out I got um this what you can see at",
    "start": "916160",
    "end": "921680"
  },
  {
    "text": "the bottom you can actually see it's a a Linux boot prompt um you can say see at the bottom say this is asky Linux",
    "start": "921680",
    "end": "927279"
  },
  {
    "text": "version 2.6.2 and it ended up going all the way down to a login prompt so I was really excited",
    "start": "927279",
    "end": "935839"
  },
  {
    "text": "here um but so that eventually got me to a log and prompt and that's this is",
    "start": "935839",
    "end": "941759"
  },
  {
    "text": "going to be the focus of the software side of the talk so I'm going to skip skip over going further down into this",
    "start": "941759",
    "end": "946880"
  },
  {
    "text": "and go to the next set of pins but in this case um I I I got I feel like I won",
    "start": "946880",
    "end": "952480"
  },
  {
    "start": "948000",
    "end": "948000"
  },
  {
    "text": "this battle or this this round um the next set of pins I looked at were jp25 and six however there was",
    "start": "952480",
    "end": "960279"
  },
  {
    "start": "960000",
    "end": "960000"
  },
  {
    "text": "actually no data being transmitted over them that I could see um the Sol logic analy didn't show analyzer didn't show",
    "start": "960279",
    "end": "966040"
  },
  {
    "text": "me anything uh and then so that round was a draw there was",
    "start": "966040",
    "end": "971240"
  },
  {
    "text": "no show they didn't they didn't give me any information uh the next set of pins I",
    "start": "971240",
    "end": "977000"
  },
  {
    "text": "looked at were this pl2 which is the the as you can see my soldering skills are subpar but I was able there there's two",
    "start": "977000",
    "end": "983959"
  },
  {
    "text": "lines of seven seven pads on this device or on the on the set of pins and I I ended up soldering wires onto it in",
    "start": "983959",
    "end": "990480"
  },
  {
    "text": "order to connect these Gator clips from the C logic analyzer and obviously use the same",
    "start": "990480",
    "end": "995959"
  },
  {
    "text": "methodology as before um it's booting the device starting the software and this time I saw this which was actually",
    "start": "995959",
    "end": "1002079"
  },
  {
    "text": "a lot different than than what was seen before the three pins were actually transmitting data out of these 14 pins",
    "start": "1002079",
    "end": "1007720"
  },
  {
    "text": "when before was only one so I at shukan last year I I met Travis Goodspeed and I",
    "start": "1007720",
    "end": "1014279"
  },
  {
    "text": "know he was really good at uh Hardware reversing so I sent him this I was like have you ever seen this before do you have any clue what what type of data",
    "start": "1014279",
    "end": "1020440"
  },
  {
    "text": "this is and he said it's definitely SPI data but started giving me some pointers so I started researching SPI um and",
    "start": "1020440",
    "end": "1027880"
  },
  {
    "text": "without getting into too much detail of what SPI is it's it's just another communication protocol like the the async serial protocol and the logic",
    "start": "1027880",
    "end": "1034918"
  },
  {
    "text": "analyzer has a uh an analyzer to decode this data so these these points are the",
    "start": "1034919",
    "end": "1041520"
  },
  {
    "text": "key things to understanding on how you would be able to decode that data uh that I saw on these wires first is that",
    "start": "1041520",
    "end": "1047959"
  },
  {
    "text": "SPI has the ability to transmit data up to 100 MHz in speed so the first thing I",
    "start": "1047959",
    "end": "1053240"
  },
  {
    "text": "had to do was increase the speed of my logic analyzer sample rate uh the logic",
    "start": "1053240",
    "end": "1058919"
  },
  {
    "text": "the the actual Hardware has limitations on how fast it can actually sample things but you can configure the",
    "start": "1058919",
    "end": "1064440"
  },
  {
    "text": "software to sample things quicker with less pins being connected to it since I only had three pins uh I was able to",
    "start": "1064440",
    "end": "1071799"
  },
  {
    "text": "sample at 50 MHz so I had to to accept a risk that Poss it's possible that the",
    "start": "1071799",
    "end": "1077400"
  },
  {
    "text": "data that I was getting is not going to be anything because I wasn't able to sample fast enough um next is that SPI",
    "start": "1077400",
    "end": "1084960"
  },
  {
    "text": "communicates in a Master Slave mode and there's the ability to have multiple slaves so you can actually have multiple",
    "start": "1084960",
    "end": "1090559"
  },
  {
    "text": "chips communicating over one specific uh debug pad output uh there's four lines",
    "start": "1090559",
    "end": "1097520"
  },
  {
    "text": "in SPI the MOSI which is Master output slave input I always look at things from",
    "start": "1097520",
    "end": "1102720"
  },
  {
    "text": "the perspective of the master so and I just call that output Master input slave output which is put to the master and",
    "start": "1102720",
    "end": "1109600"
  },
  {
    "text": "then there's an enable or slave select line which will basically determine what slave you're communicating with uh when",
    "start": "1109600",
    "end": "1117320"
  },
  {
    "text": "you're actually sending data or retrieving data uh and finally there's a clock pin and so in in the acing serial",
    "start": "1117320",
    "end": "1123440"
  },
  {
    "text": "the clock was at that specific B rate that's that's when it knew when to sample things with SPI the clock is not",
    "start": "1123440",
    "end": "1129600"
  },
  {
    "text": "like a metronome clock uh it works in one of two different um variations when",
    "start": "1129600",
    "end": "1135280"
  },
  {
    "text": "the clock pin goes from high to low it will sample other other two pins the output or the input or vice versa when",
    "start": "1135280",
    "end": "1141000"
  },
  {
    "text": "the uh clock goes from low to high it'll sample the other two pins and say and so at that point in time when the clock pin",
    "start": "1141000",
    "end": "1147559"
  },
  {
    "text": "changes what is what are the the output and the input pins at either a one or a zero or a high or a low um after fig",
    "start": "1147559",
    "end": "1156520"
  },
  {
    "text": "after reading all this and understanding more about SPI you can see zoomed in you you can tell that that brown number one",
    "start": "1156520",
    "end": "1162280"
  },
  {
    "text": "is the clock pin and it's going at 16 different up and downs through each blob",
    "start": "1162280",
    "end": "1168480"
  },
  {
    "text": "uh then the the next one was the master output and the following one was the master",
    "start": "1168480",
    "end": "1173960"
  },
  {
    "text": "input uh however so this again you can see the the bubbles representing the",
    "start": "1173960",
    "end": "1179640"
  },
  {
    "text": "data that's above them um and I this specific configuration I had it at 8 bits per per character or per um I guess",
    "start": "1179640",
    "end": "1189720"
  },
  {
    "text": "character uh that which is the default however it could be 16 I kind of spent",
    "start": "1189720",
    "end": "1195520"
  },
  {
    "start": "1195000",
    "end": "1195000"
  },
  {
    "text": "way too much time trying to analyze that data and gave up um I could see that there was Data going",
    "start": "1195520",
    "end": "1200960"
  },
  {
    "text": "by but still this day I don't even know what that is uh so in this case the debug pins beat me uh so then I started",
    "start": "1200960",
    "end": "1208360"
  },
  {
    "text": "moving forward to the another set of debug pins which looked exactly the same as the last one just in a different",
    "start": "1208360",
    "end": "1214039"
  },
  {
    "text": "location on the board which was pl1 um there was no data like the other pins",
    "start": "1214039",
    "end": "1220000"
  },
  {
    "text": "being seen over this however someone at my old or at Modano told me that these uh scream JTAG they look like they",
    "start": "1220000",
    "end": "1226480"
  },
  {
    "text": "should be JTAG pinouts for whatever reason someone it was actually Cody who did a talk on Tuesday I I so I started",
    "start": "1226480",
    "end": "1233840"
  },
  {
    "text": "reading about JTAG trying to figure out what what I could do to um to get some",
    "start": "1233840",
    "end": "1239000"
  },
  {
    "text": "sort of data or some sort of anything from these pins um the before doing this the only thing that I knew about um",
    "start": "1239000",
    "end": "1246440"
  },
  {
    "text": "about JTAG was that I used this in cable modems before at a previous job to pull",
    "start": "1246440",
    "end": "1251960"
  },
  {
    "text": "and push firmware so my my hopes were that I was going to be able to do this to one of the other chips on the device",
    "start": "1251960",
    "end": "1258000"
  },
  {
    "text": "um and I knew that it was some sort of standard that developers used to debug chips after a board has already been",
    "start": "1258000",
    "end": "1263600"
  },
  {
    "text": "made so again after reading a lot about JTAG when without going into too much detail these are the set of points that",
    "start": "1263600",
    "end": "1269480"
  },
  {
    "text": "I needed to understand in order to communicate with this chip first is that I wasn't seeing any data because JTAG",
    "start": "1269480",
    "end": "1275200"
  },
  {
    "text": "pins on their own don't transmit any data the clock is actually outside of",
    "start": "1275200",
    "end": "1280400"
  },
  {
    "text": "the JTAG ports and that's what actually will determine if pin should be transmitting or receiving data so you",
    "start": "1280400",
    "end": "1286520"
  },
  {
    "text": "need a specific external cable you can't just you know plug in the slay logic analyzer because something else needs to",
    "start": "1286520",
    "end": "1292400"
  },
  {
    "text": "be triggering this clock up and down um so then from there there's five pins",
    "start": "1292400",
    "end": "1298320"
  },
  {
    "text": "that uh that need to be connected the vref TMS tck tdo and TDI",
    "start": "1298320",
    "end": "1304080"
  },
  {
    "text": "which I don't I I ended up figuring out what they actually meant but at the time I was just I was looking at pinouts and",
    "start": "1304080",
    "end": "1311000"
  },
  {
    "text": "then plugging it into oh this is TMS oh that should be TMS but there's 14 pins",
    "start": "1311000",
    "end": "1316080"
  },
  {
    "text": "on these pads so how do I know my my problem was how do I know which five pins should I be plugging in um the next",
    "start": "1316080",
    "end": "1323880"
  },
  {
    "text": "is that like SPI there can be multiple devices plugged into one JTAG pinout uh",
    "start": "1323880",
    "end": "1330320"
  },
  {
    "text": "which is called J they're they're called that and if there are multiple devices multiple chips connected to one pin out",
    "start": "1330320",
    "end": "1336640"
  },
  {
    "text": "they're Daisy chained together that's the terminology that they use uh and then finally that each chip that's",
    "start": "1336640",
    "end": "1343200"
  },
  {
    "text": "connected to this daisy chain is called a tap which is going to be important when trigging the software so first thing I",
    "start": "1343200",
    "end": "1349760"
  },
  {
    "text": "had to do was find a u JTAG cable that I could use uh I ended up purchasing this",
    "start": "1349760",
    "end": "1355279"
  },
  {
    "text": "uh Alx arm USB which had serial and USB capabilities I bought it on a whim just",
    "start": "1355279",
    "end": "1362200"
  },
  {
    "text": "cuz it was 50 bucks uh and then I used o Open OCD software it was open source and",
    "start": "1362200",
    "end": "1367320"
  },
  {
    "text": "it supports the cable that I had purchased already and the key point was that it had the ability to Auto",
    "start": "1367320",
    "end": "1373480"
  },
  {
    "text": "autodiscover Taps I didn't have to configure anything it would attempt to Auto determine if there's any JTAG chips",
    "start": "1373480",
    "end": "1379520"
  },
  {
    "text": "that are communicating on these pads um and reading through the documentation two key points stood out was one that it",
    "start": "1379520",
    "end": "1384840"
  },
  {
    "text": "can reliably defi determine the tap ID but unreliably determine the IR Len",
    "start": "1384840",
    "end": "1390400"
  },
  {
    "text": "which is instruction register length which I'll talk about later um so the methodology that I was",
    "start": "1390400",
    "end": "1396720"
  },
  {
    "text": "using in order to try to determine what pins are should be plugged into where was just Google searching common JTAG",
    "start": "1396720",
    "end": "1403720"
  },
  {
    "text": "pinouts that had two sets of seven seven had 14 pins in two sets of seven rows",
    "start": "1403720",
    "end": "1409840"
  },
  {
    "text": "two whatever um so the first thing if there's if there's any data coming out of any of",
    "start": "1409840",
    "end": "1415679"
  },
  {
    "text": "these pins definitely not JTAG because I know that JTAG doesn't turn doesn't transmit any data without an external",
    "start": "1415679",
    "end": "1422080"
  },
  {
    "text": "clock then uh I would try this common pin out and then flip the thing 180Â° and",
    "start": "1422080",
    "end": "1427840"
  },
  {
    "text": "then try it again uh Power on the device and then start this open OCD software to see it if it can autodiscover a specific",
    "start": "1427840",
    "end": "1434720"
  },
  {
    "text": "tap on the device or any taps so do you guys remember these uh",
    "start": "1434720",
    "end": "1441120"
  },
  {
    "text": "these games that are games quote unquote games that are sitting in um doctor's offices well this is how I felt trying",
    "start": "1441120",
    "end": "1447520"
  },
  {
    "text": "to uh trying to plug these things in between the the cable and the board I",
    "start": "1447520",
    "end": "1452600"
  },
  {
    "text": "for some reason I could not wrap my head around how to get I know whatever",
    "start": "1452600",
    "end": "1458080"
  },
  {
    "text": "anyways once I finally uh completed that game and I got the pinouts correct I",
    "start": "1458080",
    "end": "1464559"
  },
  {
    "text": "started open OC open OCD software and as you can see in the yellow it said that autois discovered a tap and it gives it",
    "start": "1464559",
    "end": "1470200"
  },
  {
    "text": "a specific expected ID which is some random number that I have no idea what I'm doing right now and then the",
    "start": "1470200",
    "end": "1476120"
  },
  {
    "text": "instruction length said two and then there's an error so I started using that ID in in Google",
    "start": "1476120",
    "end": "1483159"
  },
  {
    "text": "search uh that expected ID and it turns out that that ID matched exactly to the skyling chip that was near that set of",
    "start": "1483159",
    "end": "1490200"
  },
  {
    "text": "pinouts uh to the to the model number that was on that chip so the next step was to configure",
    "start": "1490200",
    "end": "1497240"
  },
  {
    "text": "the open CD uh software to communicate with with that chip and there's four",
    "start": "1497240",
    "end": "1503080"
  },
  {
    "text": "different four different things that you need um in order to do that first is the expected ID which it already gave me um",
    "start": "1503080",
    "end": "1510320"
  },
  {
    "text": "then the IR length the IR capture and the IR mask which I originally just started throwing some numbers at it and",
    "start": "1510320",
    "end": "1516919"
  },
  {
    "text": "seeing what what it did everything was turning out to be an error and then I I started reading uh about another concept",
    "start": "1516919",
    "end": "1523320"
  },
  {
    "text": "that's kind of hand inand with JTAG which is bsdl which is just a configuration file that uh tells tells a",
    "start": "1523320",
    "end": "1531480"
  },
  {
    "text": "developer how you can communicate over JTAG to a specific chip so jtab is a very loose protocol there's there's",
    "start": "1531480",
    "end": "1537919"
  },
  {
    "text": "minimal that's required for it to be implemented and developers or the chip manufacturers Implement all these",
    "start": "1537919",
    "end": "1544039"
  },
  {
    "text": "additional functionalities that is not necessarily public knowledge but fortunately for me the exy links people",
    "start": "1544039",
    "end": "1550799"
  },
  {
    "text": "allow you to download it for free this this bsdl file with just signing up uh on their web page and I saw in this file",
    "start": "1550799",
    "end": "1558039"
  },
  {
    "text": "there's one uh these two two things that I needed to configure the tab the instruction length instruction length",
    "start": "1558039",
    "end": "1564840"
  },
  {
    "text": "and the instruction capture which instruction length is instruction length is six and the instruction capture is uh",
    "start": "1564840",
    "end": "1571600"
  },
  {
    "text": "XXX x01 so modified my configuration file to add that add the tap in there",
    "start": "1571600",
    "end": "1577880"
  },
  {
    "text": "and this time I booted up or I started the open OCD software and um there's no errors which I thought one step further",
    "start": "1577880",
    "end": "1584720"
  },
  {
    "text": "this is awesome next thing I did was uh so open OCD Works in a client server uh",
    "start": "1584720",
    "end": "1590159"
  },
  {
    "text": "mode where the when you starting open OCD it opens up a port that you can tell it to and then another Port that you can",
    "start": "1590159",
    "end": "1597200"
  },
  {
    "text": "connect via GDB and send commands to so the first thing I did was throw sent",
    "start": "1597200",
    "end": "1603440"
  },
  {
    "text": "this command JTAG and nit which again didn't throw any errors it gave me the specific tap that it found the",
    "start": "1603440",
    "end": "1608760"
  },
  {
    "text": "manufacturer number the part number and the version number and so I'm like yes I'm on the right path however if I would",
    "start": "1608760",
    "end": "1616360"
  },
  {
    "text": "have thought about this before taking all the time of understanding JTAG I would have realized that the only thing",
    "start": "1616360",
    "end": "1621399"
  },
  {
    "text": "that I'm going to be able to communicate with is theing fpga and that's got no flash no",
    "start": "1621399",
    "end": "1627279"
  },
  {
    "text": "operating system and the only thing that I may be able to do is reprogram it so again kind of a fail on my part",
    "start": "1627279",
    "end": "1635320"
  },
  {
    "text": "but not because uh it was just because I simply didn't think I was I was getting ex I was getting excited and being",
    "start": "1635320",
    "end": "1641159"
  },
  {
    "text": "impatient so in this case I feel like the debug pins beat me out here I learned a lot about JTAG and um however",
    "start": "1641159",
    "end": "1649640"
  },
  {
    "start": "1643000",
    "end": "1643000"
  },
  {
    "text": "again no closer to my goal of actually gaining access to the device so",
    "start": "1649640",
    "end": "1654799"
  },
  {
    "text": "switching back to Switching gears now to the software level I looked at all of the pins and the only one that I had uh",
    "start": "1654799",
    "end": "1661159"
  },
  {
    "text": "any sort of path to gaining access to the device was the jp1 set of pins that ended up bringing me to a Linux boot",
    "start": "1661159",
    "end": "1667240"
  },
  {
    "text": "prompt um so I bought this 3v3 USB fddi cable that allowed me just to connect",
    "start": "1667240",
    "end": "1674039"
  },
  {
    "text": "through uh a screen terminal session at a specific bot and I was able to interact with with the device um what I",
    "start": "1674039",
    "end": "1681760"
  },
  {
    "text": "was doing though when when when powering on the device was I was plugging in the device then starting the the terminal",
    "start": "1681760",
    "end": "1687720"
  },
  {
    "text": "session and so I was missing the whole beginning part of the boot procedure and I was just getting to this login prompt",
    "start": "1687720",
    "end": "1693120"
  },
  {
    "text": "I was like what how I can I'm not I tried guessing obviously root R didn't work but um after a while I I ended up",
    "start": "1693120",
    "end": "1701480"
  },
  {
    "text": "keeping this the terminal session open and then powering on the device and I noticed this uh the beginning of uboot",
    "start": "1701480",
    "end": "1707559"
  },
  {
    "text": "is and it paused for like 2 seconds that you wouldn't really notice but after booting it about 50 times you actually",
    "start": "1707559",
    "end": "1714039"
  },
  {
    "text": "see this and uh number four and this is actually how it's spelled on the device I it's not a typo uh enter boot command",
    "start": "1714039",
    "end": "1721399"
  },
  {
    "text": "line interface so next time I powered it on I continuously press four and it dropped me into this uh bootloader",
    "start": "1721399",
    "end": "1727640"
  },
  {
    "text": "interface a you boot bootloader interface and me not knowing much of anything about boot loaders started reading once again uh and there's a help",
    "start": "1727640",
    "end": "1735080"
  },
  {
    "text": "command that showed me the available commands that I have on the specific device and after enumerating all the",
    "start": "1735080",
    "end": "1740919"
  },
  {
    "text": "commands that were available the only thing that I was really going to be helpful to me was uh this MD command",
    "start": "1740919",
    "end": "1746279"
  },
  {
    "text": "which is memory display so there's a flash ship that's that is somehow connected and I can read data off of",
    "start": "1746279",
    "end": "1752679"
  },
  {
    "text": "that so my my idea was to use that to dump data log it using screen and then",
    "start": "1752679",
    "end": "1759000"
  },
  {
    "text": "create a ruby script that uh trans transfers that data into a binary file",
    "start": "1759000",
    "end": "1766120"
  },
  {
    "text": "now thank thankfully doing when when re when Googling around on specifics for",
    "start": "1766120",
    "end": "1771679"
  },
  {
    "text": "this device there was an exploit workshop.org I don't even think the web page is up anymore but they gave me this",
    "start": "1771679",
    "end": "1778000"
  },
  {
    "text": "memory layout represent or memory layout of the specific device it actually wasn't even up when I found it I",
    "start": "1778000",
    "end": "1783399"
  },
  {
    "text": "actually I saved the file locally from a Google cach page but as you can see there's a 4 megabyte flash memory",
    "start": "1783399",
    "end": "1789559"
  },
  {
    "text": "address location so BFC through c0000 um that was my goal that was what",
    "start": "1789559",
    "end": "1794919"
  },
  {
    "text": "I wanted to start pulling off and start trying to because as you can see on the bottom there's you boot image L Linux",
    "start": "1794919",
    "end": "1800440"
  },
  {
    "text": "kernel image and some extras so I know this is booting Linux and it looks like Linux is on this portion of memory",
    "start": "1800440",
    "end": "1807039"
  },
  {
    "text": "somewhere so my goal was to try to uh use that to my advantage so um the memory display",
    "start": "1807039",
    "end": "1814039"
  },
  {
    "text": "command literally just outputs it straight to the screen like a hex editor would so I had to write a script that",
    "start": "1814039",
    "end": "1819760"
  },
  {
    "text": "you know took into account endianness and took into account specific memory address locations and was able to dump",
    "start": "1819760",
    "end": "1826559"
  },
  {
    "text": "this and then turn it into a file and then that file was nothing it was just a set of data after running a file on the",
    "start": "1826559",
    "end": "1832519"
  },
  {
    "text": "command however reading a bunch of blogs the this is this is like a common path that people go down when trying to",
    "start": "1832519",
    "end": "1838279"
  },
  {
    "text": "reverse firmware images so the next thing I wanted to look at was what can I gain from this Big Blob of data this 4",
    "start": "1838279",
    "end": "1845240"
  },
  {
    "text": "megabyte flash set of data that I have sitting in front of me um and doing this",
    "start": "1845240",
    "end": "1851360"
  },
  {
    "text": "there was three tools that always it was it was a common workflow with these three tools the first one is strings and",
    "start": "1851360",
    "end": "1857240"
  },
  {
    "text": "second one is file which I'm assuming everyone knows and the last one was this tool I don't know who wrote it but it's",
    "start": "1857240",
    "end": "1862440"
  },
  {
    "text": "called binwalk and what it does is it steps through a file and each specific bite in that file it will essentially",
    "start": "1862440",
    "end": "1869039"
  },
  {
    "text": "run the file command from that bite onto the end of the file uh it doesn't actually run it run the file command it",
    "start": "1869039",
    "end": "1875080"
  },
  {
    "text": "has its own implementation but uh that's essentially what it does to see if there's a file located within a some Big",
    "start": "1875080",
    "end": "1881720"
  },
  {
    "text": "Blob of data so the first thing that I did was this with the the full 4 megabyte flash",
    "start": "1881720",
    "end": "1888159"
  },
  {
    "text": "was a run file and it didn't give me anything strings didn't give me anything either however when running the bin bin",
    "start": "1888159",
    "end": "1893880"
  },
  {
    "text": "was it bin dump yeah B Dum on it uh you can see that that that representation at",
    "start": "1893880",
    "end": "1899600"
  },
  {
    "text": "the bottom there's a bunch of lzma partitions and two uh U umage Linux",
    "start": "1899600",
    "end": "1904840"
  },
  {
    "text": "images which directly uh related back to that exploit Workshop thing that I was",
    "start": "1904840",
    "end": "1910960"
  },
  {
    "text": "looking at the memory address layout so the first thing that I did was pull all those lzma uh",
    "start": "1910960",
    "end": "1917799"
  },
  {
    "text": "partitions out using DD um and then tried to un lzma them the only one that",
    "start": "1917799",
    "end": "1924320"
  },
  {
    "text": "actually successfully decompressed was this last one which I call lzma 4 running file on that just says it's",
    "start": "1924320",
    "end": "1929679"
  },
  {
    "text": "another set of data however running strings on it gave me one step closer and it's showing you know actual real",
    "start": "1929679",
    "end": "1935639"
  },
  {
    "text": "strings and data that's going that's coming that's in this in this file um again the next thing that I ran was",
    "start": "1935639",
    "end": "1941840"
  },
  {
    "text": "binwalk and I see a ton of lzma partitions or I call them partitions parts of parts of this file and some",
    "start": "1941840",
    "end": "1949039"
  },
  {
    "text": "squash file system images um when reading this I was reading or when doing",
    "start": "1949039",
    "end": "1954080"
  },
  {
    "text": "this I was reading a blog post about someone reversing uh reversing a router firmware and they were saying they were",
    "start": "1954080",
    "end": "1960519"
  },
  {
    "text": "explaining a trick of of they found a squash file system partition that existed within within a file and they",
    "start": "1960519",
    "end": "1967600"
  },
  {
    "text": "were able to modify the header to successfully uh unsquash that file system so that's where I originally",
    "start": "1967600",
    "end": "1973159"
  },
  {
    "text": "started focusing uh everything failed I I spent a couple days trying to get that that working however if I would have",
    "start": "1973159",
    "end": "1979039"
  },
  {
    "text": "just read this once again I was too excited trying to move too quickly you can see all the created dates on this",
    "start": "1979039",
    "end": "1984200"
  },
  {
    "text": "are way in the future which to me makes me think that that's definitely not anything of of use it's a false positive",
    "start": "1984200",
    "end": "1990120"
  },
  {
    "text": "of the binwalk tool so the next thing that I did was pulled out every single",
    "start": "1990120",
    "end": "1995240"
  },
  {
    "text": "one of those lzma partitions manually and uh again the last one was the only one that",
    "start": "1995240",
    "end": "2000840"
  },
  {
    "text": "decompressed so I call this 4.18 because it's the second it's the 18th part ition",
    "start": "2000840",
    "end": "2007320"
  },
  {
    "text": "that was in that file running file on it says something asky I didn't I I just said I saw asking and kept moving",
    "start": "2007320",
    "end": "2013279"
  },
  {
    "text": "forward running strings on it showed me this specific format of the file where it looked like there's some ID number",
    "start": "2013279",
    "end": "2018720"
  },
  {
    "text": "then an executable and then possibly the contents of that executable and running binwalk on it showed uh a ton of",
    "start": "2018720",
    "end": "2025000"
  },
  {
    "text": "binaries some more lzma stuff um but I felt like I was on the right path so",
    "start": "2025000",
    "end": "2030480"
  },
  {
    "text": "after Googling around a little bit I determined that this was uh actually a cpio archive um based on the format of",
    "start": "2030480",
    "end": "2036960"
  },
  {
    "text": "of the file however if I would have just read again the the file command it told",
    "start": "2036960",
    "end": "2042840"
  },
  {
    "text": "me exactly what this was uh so that was a waste a couple days but now I know how",
    "start": "2042840",
    "end": "2049878"
  },
  {
    "text": "to move forward so running CP I could I could see a list of files um",
    "start": "2049879",
    "end": "2057520"
  },
  {
    "text": "which however cpio has a limitation on it when it comes to extracting files",
    "start": "2057520",
    "end": "2065000"
  },
  {
    "text": "from the archive they go to their exact location there's no way of putting it into um uh like a reference directory",
    "start": "2065000",
    "end": "2071960"
  },
  {
    "text": "there's no there's no way of actually of giving it a root directory of where it should place all these files",
    "start": "2071960",
    "end": "2077520"
  },
  {
    "text": "it just places them like if it's Etsy password it will place it on Etsy password on your machine however there",
    "start": "2077520",
    "end": "2084118"
  },
  {
    "text": "was a nice little flag called Dash R which allowed me to interactively rename all 208 of these files and I did that",
    "start": "2084119",
    "end": "2092200"
  },
  {
    "text": "manually as well that was awesome um and yes after doing all this weeks later",
    "start": "2092200",
    "end": "2098880"
  },
  {
    "text": "people are like you know you could have done that a lot easier you know I was like yeah I know I was too excited I wanted to keep going um so the next the",
    "start": "2098880",
    "end": "2107800"
  },
  {
    "start": "2106000",
    "end": "2106000"
  },
  {
    "text": "next thing so I've got all these files now in a directory and it's it's a boot file system so I wanted to try to start",
    "start": "2107800",
    "end": "2113960"
  },
  {
    "text": "reversing them try to my again my goal is to gain access to to this device and all I have is um up to a Linux boot",
    "start": "2113960",
    "end": "2120400"
  },
  {
    "text": "prompt or Linux login prompt so I started reversing the applications that were in here and the there was three",
    "start": "2120400",
    "end": "2126280"
  },
  {
    "text": "main focuses of the reversing um first were these uh scripts that were in the",
    "start": "2126280",
    "end": "2131680"
  },
  {
    "text": "spin directory uh which were part of the boot procedure and that I could relate the strings that were being printed out",
    "start": "2131680",
    "end": "2138000"
  },
  {
    "text": "from there to the strings that existed in the scripts and then I also found that a lot of these binaries we're using",
    "start": "2138000",
    "end": "2143960"
  },
  {
    "text": "eval um which you'll see later directly directly relates to the boot procedure",
    "start": "2143960",
    "end": "2150839"
  },
  {
    "text": "and these scripts so on a kind of a side note um",
    "start": "2150839",
    "end": "2156599"
  },
  {
    "text": "there there's within that memory address layout there was also something that was defined as Pico config which had",
    "start": "2156599",
    "end": "2162960"
  },
  {
    "text": "basically a configuration that you could be that could be read from the the bootloader um that had a few things of",
    "start": "2162960",
    "end": "2170040"
  },
  {
    "text": "interest in there one was tamper proof which was a binary representation of the plugs that were on the front and the",
    "start": "2170040",
    "end": "2175599"
  },
  {
    "text": "back of the board so presumably I can pull those out overwrite tber proof to",
    "start": "2175599",
    "end": "2180640"
  },
  {
    "text": "all zeros and the device should still work uh I'm not sure if the um if it's",
    "start": "2180640",
    "end": "2186880"
  },
  {
    "text": "random for each new device or what but there's also the ability to put it in a learn mode and again would presumably",
    "start": "2186880",
    "end": "2193640"
  },
  {
    "text": "learn what the pin um the pin uh configuration is there's also a note in",
    "start": "2193640",
    "end": "2200119"
  },
  {
    "text": "there that show so the Pico config is just like a a key value pair in a tree uh I'll show you what it looks like next",
    "start": "2200119",
    "end": "2205560"
  },
  {
    "text": "slide but there's also what looked like a fir specifying a firmware image on a tfdp server at one some 192168 address",
    "start": "2205560",
    "end": "2213520"
  },
  {
    "text": "which was confusing to me because how was it getting to that uh that IP address and then the last",
    "start": "2213520",
    "end": "2220280"
  },
  {
    "text": "part was that there's a firewall node that I directly resembled exactly what I was seeing upon boot now this is what",
    "start": "2220280",
    "end": "2228359"
  },
  {
    "text": "the the Pico the top part of this this uh slide is the Pico config and specifically the firewall portion of it",
    "start": "2228359",
    "end": "2235160"
  },
  {
    "text": "as you can see these um the port protocol and the destination IP address",
    "start": "2235160",
    "end": "2240800"
  },
  {
    "text": "are directly related to what's happening at this IP tables command so again I",
    "start": "2240800",
    "end": "2246160"
  },
  {
    "text": "don't have access to this device and I was thinking if somehow I can override that and run a command I may be able to",
    "start": "2246160",
    "end": "2252599"
  },
  {
    "text": "do some sort of command injection to get access to this device um it turns out looking at one of",
    "start": "2252599",
    "end": "2259000"
  },
  {
    "text": "the executables that's reading this memory address location and um uh reading the configuration file and",
    "start": "2259000",
    "end": "2266560"
  },
  {
    "text": "calling these eval functions is it's actually calling eval sh- C and then",
    "start": "2266560",
    "end": "2272720"
  },
  {
    "text": "whatever IP table string that it determines from that memory address and and as you can see on the top one uh the",
    "start": "2272720",
    "end": "2278200"
  },
  {
    "text": "comment it's actually you can see it's a format string so there's a percent s in there so my idea was that if I can somehow override the IP address to run",
    "start": "2278200",
    "end": "2285920"
  },
  {
    "text": "some sort of command I may be able to gain access to this device first test of what I was just trying to do is Ping",
    "start": "2285920",
    "end": "2292280"
  },
  {
    "text": "something just or or do an echo of just seeing if I can get some sort of",
    "start": "2292280",
    "end": "2297359"
  },
  {
    "text": "output um so going back to uboot I was able Not only was able to read the memory on the flash chip I was also able",
    "start": "2297359",
    "end": "2303880"
  },
  {
    "text": "to write the memory however any attempt that I was trying do to modify this Pico config portion of memory was failing um",
    "start": "2303880",
    "end": "2311480"
  },
  {
    "text": "nothing was working I would I would write to it and then read the exact same bit back and it would it just wouldn't change I had no had no idea what was",
    "start": "2311480",
    "end": "2317800"
  },
  {
    "text": "going on then I noticed this thing called protect one of the commands um specifically in there's a print",
    "start": "2317800",
    "end": "2324599"
  },
  {
    "text": "environmental variables which is a set of environmental variables and commands so I saw this command _ B and it first",
    "start": "2324599",
    "end": "2331839"
  },
  {
    "text": "thing it says was protect off I was like awesome let's run it bad idea",
    "start": "2331839",
    "end": "2338240"
  },
  {
    "text": "uh if you actually continue to read the command it proceeds to erase the entire flash chip as well um so I now had a",
    "start": "2338240",
    "end": "2345119"
  },
  {
    "text": "second brick on my hand again called up customer service and uh said I don't",
    "start": "2345119",
    "end": "2350920"
  },
  {
    "text": "know what happened again 30 minutes of debugging uh this time they didn't say anything about a tamper flag but they",
    "start": "2350920",
    "end": "2357680"
  },
  {
    "text": "kept asking me if uh there's a power surge in my apartment because there's there's only one light that was just",
    "start": "2357680",
    "end": "2363359"
  },
  {
    "text": "solid which I assume means that you have a brick and uh I mean I I made have some",
    "start": "2363359",
    "end": "2369160"
  },
  {
    "text": "story like yeah yeah there was a storm last night it probably was that anyways I couldn't totally convince them that I",
    "start": "2369160",
    "end": "2375920"
  },
  {
    "text": "didn't know what was going on and it was like 2 hours wasted of my day so I ended up hanging up with them and I know I I",
    "start": "2375920",
    "end": "2383000"
  },
  {
    "text": "know from the last call that they take notes about everything that you're talking about so what I did was just go to the went to the store and said the",
    "start": "2383000",
    "end": "2389920"
  },
  {
    "text": "same stories before yeah I talked to the people at customer service they said I could just come in and replace it ladies were like all right let me look up the",
    "start": "2389920",
    "end": "2395119"
  },
  {
    "text": "notes and she just like read the first few sentences you're like all right perfectly here you go um however the",
    "start": "2395119",
    "end": "2401359"
  },
  {
    "text": "only the only problem was that uh they didn't have any in stock so I had to wait uh they had to get one shipped to",
    "start": "2401359",
    "end": "2407800"
  },
  {
    "text": "me now while doing this I remember looking at one of the bind dumps before and there was a Linux kernel image in",
    "start": "2407800",
    "end": "2414119"
  },
  {
    "start": "2409000",
    "end": "2409000"
  },
  {
    "text": "there so I wanted to start focusing on anything else I possibly could while I'm waiting for this device now also while",
    "start": "2414119",
    "end": "2420599"
  },
  {
    "text": "doing this I sent uh Etsy password I tried to crack it with John the Ripper uh it was it was in this really weird",
    "start": "2420599",
    "end": "2427480"
  },
  {
    "text": "format I had never seen before which was it was just a 13 character string where the hash is supposed to be uh someone",
    "start": "2427480",
    "end": "2433520"
  },
  {
    "text": "explained to me what it was before some old school hashing mechanism um so I really didn't",
    "start": "2433520",
    "end": "2438960"
  },
  {
    "text": "have any faith because I didn't think this was a legitimate Etsy password file I thought it was somehow dynamically being generated when the when the device",
    "start": "2438960",
    "end": "2445640"
  },
  {
    "text": "boots up um so I I sent that it was just running in the background on one of my servers at home um and then I move",
    "start": "2445640",
    "end": "2451280"
  },
  {
    "text": "forward to looking at this Linux kernel image U that's the bend up output as you can see image type OS kernel",
    "start": "2451280",
    "end": "2456960"
  },
  {
    "text": "image uh I found out based on some of the other information that was being used uh or that was being displayed upon",
    "start": "2456960",
    "end": "2463240"
  },
  {
    "text": "boot that uh this is the specific configuration that you needed to load it in Ida the start address is uh a the Ram",
    "start": "2463240",
    "end": "2471280"
  },
  {
    "text": "size is essentially the size of the file and then from there you'd have to go to the specific address location that it",
    "start": "2471280",
    "end": "2477640"
  },
  {
    "text": "starts running instructions from and have it have Ida start analyzing it so",
    "start": "2477640",
    "end": "2482720"
  },
  {
    "text": "after doing that I I got to a place where I have all these functions which is what's shown on the left but none of",
    "start": "2482720",
    "end": "2488760"
  },
  {
    "text": "them are named they're just I mean I'm one step closer but it doesn't really give me much I'm not going to go through",
    "start": "2488760",
    "end": "2494440"
  },
  {
    "text": "and analyze every single kernel level function that exists in this this huge firmware image but I did also notice",
    "start": "2494440",
    "end": "2501720"
  },
  {
    "text": "that on the rightand screenshot in the strings portion of idad there's what looks like to be function name somewhere",
    "start": "2501720",
    "end": "2508880"
  },
  {
    "text": "in this image or in this uh yeah in the in the image that I loaded so when I started looking at",
    "start": "2508880",
    "end": "2516599"
  },
  {
    "text": "specifically I was looking at the mem copy string that's in there I noticed if you can see on the the left hand side",
    "start": "2516599",
    "end": "2522079"
  },
  {
    "text": "the highlighted address location of the beginning of where meem the literally the string mem copy starts I used Ida to",
    "start": "2522079",
    "end": "2529319"
  },
  {
    "text": "search to see if that bite represent or that that set of bytes existed anywhere else in the image turns out in only one",
    "start": "2529319",
    "end": "2535400"
  },
  {
    "text": "other place it existed which is as you can see highlight on the right the the actual bite value is if you go from the",
    "start": "2535400",
    "end": "2540800"
  },
  {
    "text": "bottom up 8027 cd8 which directly is the exact um thing on the left I thought",
    "start": "2540800",
    "end": "2547480"
  },
  {
    "text": "that this could just be a coincidence um so I kept looking for further and after it was also the next set of bytes was",
    "start": "2547480",
    "end": "2555040"
  },
  {
    "text": "the exact start of one of the functions so I kind of made an assumption that it's either a function and a function",
    "start": "2555040",
    "end": "2563000"
  },
  {
    "text": "and then a string or the string and then the function in some some of that order so um I ended up writing a a ruby script",
    "start": "2563000",
    "end": "2571720"
  },
  {
    "text": "that pulled out all these these memory address locations from the file and created uh an Ida script that would um",
    "start": "2571720",
    "end": "2578359"
  },
  {
    "text": "load these memory address location or load this out the string literals into Ida and point them to specific memory",
    "start": "2578359",
    "end": "2584839"
  },
  {
    "text": "dress locations um after doing that I got a partial representation of what the kernel functions look like but um while",
    "start": "2584839",
    "end": "2594359"
  },
  {
    "start": "2593000",
    "end": "2593000"
  },
  {
    "text": "doing this I I got an email from Corey beninger he works at in tpus group and",
    "start": "2594359",
    "end": "2599760"
  },
  {
    "text": "he he pointed me to this uh GPL portion of the the uh the pamphlet that they",
    "start": "2599760",
    "end": "2604800"
  },
  {
    "text": "give you with the with the device and it basically says um there's a bunch of GPL",
    "start": "2604800",
    "end": "2610880"
  },
  {
    "text": "software in here if you want copies of it send 99 $9.99 for shipping and handling to this specific address uh oh",
    "start": "2610880",
    "end": "2617920"
  },
  {
    "text": "and by the way if you have any questions you can email us here so I sent an email to them saying I don't want to uh send",
    "start": "2617920",
    "end": "2624480"
  },
  {
    "text": "you $9.99 will you just send me the files and I just waited while doing this I still didn't have the device yet back",
    "start": "2624480",
    "end": "2629920"
  },
  {
    "text": "from from from the I almost slipped from the company that I was",
    "start": "2629920",
    "end": "2634960"
  },
  {
    "text": "using um um but fortunately Johnn the Ripper succeeded after 7 Days the root",
    "start": "2634960",
    "end": "2640400"
  },
  {
    "text": "SSH and sshd passwords both cracked we the same passwords it ended up being seven characters all lowercase um so now",
    "start": "2640400",
    "end": "2647760"
  },
  {
    "text": "I know that when I get this device I'd have root on it so I was really excited",
    "start": "2647760",
    "end": "2652960"
  },
  {
    "text": "um before I got the device I also got an email back from the company and they sent me two files or they sent me links",
    "start": "2652960",
    "end": "2659119"
  },
  {
    "text": "to two files the first one that was this dph 151 which was the full boot chain for the operating system that I'm",
    "start": "2659119",
    "end": "2665359"
  },
  {
    "text": "looking at literally a tutorial on how to build a firmware image on auntu for",
    "start": "2665359",
    "end": "2671440"
  },
  {
    "text": "this device and then um uh some this other IP access AP which",
    "start": "2671440",
    "end": "2677319"
  },
  {
    "text": "is uh some of the open source software for another chip that's on this on this",
    "start": "2677319",
    "end": "2682720"
  },
  {
    "text": "device now when I actually got the device back uh I was able to log in and start start",
    "start": "2682720",
    "end": "2690000"
  },
  {
    "text": "playing around try and understanding more of exactly what this was doing and um what happens when the when the device",
    "start": "2690000",
    "end": "2695680"
  },
  {
    "text": "boots boot it sends a gpio signal to another processor which they refer to as Pico uh that causes that chip to boot",
    "start": "2695680",
    "end": "2702880"
  },
  {
    "text": "that sends a ghtp request back to the chip that I am actually in which they they refer to as the router uh and so",
    "start": "2702880",
    "end": "2710440"
  },
  {
    "text": "and it requests an IP address from this sl30 address um then it configures IP",
    "start": "2710440",
    "end": "2717000"
  },
  {
    "text": "tables to forward a specific set of ports to that private IP address so so within this within that piece of",
    "start": "2717000",
    "end": "2722800"
  },
  {
    "text": "Hardware it's already gatting inside of itself somehow um none of those ports",
    "start": "2722800",
    "end": "2728880"
  },
  {
    "text": "were open that were being forwarded to the second processor but um it uses IP",
    "start": "2728880",
    "end": "2734520"
  },
  {
    "text": "tables to do that so presumably they they should be open at some point uh another thing was there's IP server",
    "start": "2734520",
    "end": "2740119"
  },
  {
    "text": "service running which allowed for interpress communication between the Pico uh the Pico processor and the",
    "start": "2740119",
    "end": "2746079"
  },
  {
    "text": "router processor to ask for things internally like uptime and has this been tampered with and whatnot then there's a",
    "start": "2746079",
    "end": "2753720"
  },
  {
    "text": "wizard uh service that was running that allowed for remote commands remote commands from uh over multicast from",
    "start": "2753720",
    "end": "2762280"
  },
  {
    "text": "third parties so somehow they the the company was able to had the ability to",
    "start": "2762280",
    "end": "2769000"
  },
  {
    "text": "perform actions on my device through this um this wi wizard function the last one I looked at was the CFG flash which",
    "start": "2769000",
    "end": "2778200"
  },
  {
    "text": "uh after looking at there was a this thing called config flash d so it's- s for Save DN for the name which is back",
    "start": "2778200",
    "end": "2786079"
  },
  {
    "text": "door and- V for one um which after booting that after sending that command",
    "start": "2786079",
    "end": "2792480"
  },
  {
    "text": "and booting the device up it binds tet to 0.0.0 so now I don't need to actually",
    "start": "2792480",
    "end": "2798200"
  },
  {
    "text": "plug in a physical cable to this device anymore I have access to it uh with just",
    "start": "2798200",
    "end": "2803599"
  },
  {
    "text": "through tetting of whatever IP address it requests from my",
    "start": "2803599",
    "end": "2808680"
  },
  {
    "text": "router now um the uh the fail overflow a couple",
    "start": "2808680",
    "end": "2814920"
  },
  {
    "text": "months ago did a blog post on this device and uh noted that there within",
    "start": "2814920",
    "end": "2821760"
  },
  {
    "text": "this within that wizard application there is a uh backd door packet command line which allows someone to send raw",
    "start": "2821760",
    "end": "2829599"
  },
  {
    "text": "commands that are literally executed with eval just straight up um and it",
    "start": "2829599",
    "end": "2836040"
  },
  {
    "text": "it's obviously intended functionality the developers meant to do this however now that it's public knowledge I'm assuming that they're going to maybe",
    "start": "2836040",
    "end": "2841960"
  },
  {
    "text": "take it out in the next version so I started looking further because um in",
    "start": "2841960",
    "end": "2847800"
  },
  {
    "text": "order to gain access to this device the first time I still need to plug in uh I still physically need to plug into the",
    "start": "2847800",
    "end": "2854040"
  },
  {
    "text": "device in order to run that backd door command so I I wanted to be able to get a device plug it in and not have to run",
    "start": "2854040",
    "end": "2859720"
  },
  {
    "text": "anything in order to gain access to it so uh I found this other backd door",
    "start": "2859720",
    "end": "2865040"
  },
  {
    "text": "packet load serial number function that it calls and remember the command injection with the IB table stuff well",
    "start": "2865040",
    "end": "2870240"
  },
  {
    "text": "it turns out it exists here as well um see it calls this CS CL Cent um set",
    "start": "2870240",
    "end": "2877559"
  },
  {
    "text": "serial number and percent s which comes from the packet that's being sent so if you just use back ticks or dollar sign",
    "start": "2877559",
    "end": "2884079"
  },
  {
    "text": "parentheses you can and then it calls eval sh so basically calls sh- C this specific command so you could use this",
    "start": "2884079",
    "end": "2891040"
  },
  {
    "text": "to uh send one packet to the device to start the back door unplug the device plug it back in the next time it boots",
    "start": "2891040",
    "end": "2897520"
  },
  {
    "text": "up you're going to have a tet bound to its public IP address or its local IP",
    "start": "2897520",
    "end": "2903800"
  },
  {
    "text": "address um so that's it I feel like I completely destroyed this device um and",
    "start": "2903800",
    "end": "2910960"
  },
  {
    "text": "uh I was able to gain access to it physically and able to get root and then",
    "start": "2910960",
    "end": "2916680"
  },
  {
    "text": "also have a soft rooting device of it a soft rooting functionality of it so I don't even need to pull it apart anymore",
    "start": "2916680",
    "end": "2923920"
  },
  {
    "text": "um so the answer to the question how many bricks did it take it only took two I was hoping there was going to be more",
    "start": "2923920",
    "end": "2929240"
  },
  {
    "start": "2924000",
    "end": "2924000"
  },
  {
    "text": "but I didn't actually have to pay for any ofone which is good um I wanted to give some thanks out to rajas Jeremy an",
    "start": "2929240",
    "end": "2937119"
  },
  {
    "text": "Cory beninger of intrepus group and they helped me a lot throughout this project Kurt Rosenfeld and Andrew zinberg and",
    "start": "2937119",
    "end": "2944319"
  },
  {
    "text": "then finally Travis Goodspeed uh that's it uh again the slides are and white paper are located on the IP address at",
    "start": "2944319",
    "end": "2950559"
  },
  {
    "text": "the bottom they'll also be on the mod on a research page at some point my name my email and my Twitter so does anybody",
    "start": "2950559",
    "end": "2956960"
  },
  {
    "text": "have any",
    "start": "2956960",
    "end": "2959359"
  },
  {
    "text": "questions all right well thank you guys no wait",
    "start": "2962040",
    "end": "2967520"
  },
  {
    "text": "you got access to this device have you been able to do",
    "start": "2970319",
    "end": "2974400"
  },
  {
    "text": "anything unfortunately the router Port so the question was I got access to the",
    "start": "2975960",
    "end": "2981079"
  },
  {
    "text": "device am I going to do was I able to do anything useful um the router portion of",
    "start": "2981079",
    "end": "2986839"
  },
  {
    "text": "the device which is what I talked about here know there's nothing useful that can happen into it in it however the",
    "start": "2986839",
    "end": "2993559"
  },
  {
    "text": "Pico portion is where all the fun stuff happens uh which I've also been able to G gain access to however not enough time",
    "start": "2993559",
    "end": "3000720"
  },
  {
    "text": "to talk about it in this presentation M anything",
    "start": "3000720",
    "end": "3007680"
  },
  {
    "text": "else all right thanks again",
    "start": "3007680",
    "end": "3012760"
  }
]