[
  {
    "start": "0",
    "end": "19000"
  },
  {
    "text": "all right Aloha and welcome to my talk",
    "start": "0",
    "end": "2040"
  },
  {
    "text": "on making and breaking mac firewalls my",
    "start": "2040",
    "end": "5549"
  },
  {
    "text": "name is Patrick I work at digital",
    "start": "5549",
    "end": "7770"
  },
  {
    "text": "security where we are creating",
    "start": "7770",
    "end": "9330"
  },
  {
    "text": "cybersecurity tools for the Mac",
    "start": "9330",
    "end": "11639"
  },
  {
    "text": "Enterprise I'm also the creator of the",
    "start": "11639",
    "end": "14099"
  },
  {
    "text": "Mac security website objective-c so",
    "start": "14099",
    "end": "18180"
  },
  {
    "text": "today we're gonna talk about creating or",
    "start": "18180",
    "end": "20460"
  },
  {
    "start": "19000",
    "end": "19000"
  },
  {
    "text": "making a firewall for Mac OS we're then",
    "start": "20460",
    "end": "23279"
  },
  {
    "text": "gonna shift gears we're gonna put on our",
    "start": "23279",
    "end": "24900"
  },
  {
    "text": "hack your hats and talk about then",
    "start": "24900",
    "end": "27210"
  },
  {
    "text": "breaking or bypassing such products so",
    "start": "27210",
    "end": "32430"
  },
  {
    "text": "about a year ago I decided hey I want to",
    "start": "32430",
    "end": "33899"
  },
  {
    "text": "write a firewall for Mac OS so this",
    "start": "33899",
    "end": "36960"
  },
  {
    "text": "section of the talk will describe that",
    "start": "36960",
    "end": "39270"
  },
  {
    "text": "process in creating a free Mac firewall",
    "start": "39270",
    "end": "42540"
  },
  {
    "text": "product called Lulu",
    "start": "42540",
    "end": "45469"
  },
  {
    "text": "so there's many reasons you might want",
    "start": "45469",
    "end": "48210"
  },
  {
    "start": "46000",
    "end": "46000"
  },
  {
    "text": "to create or install a firewall some of",
    "start": "48210",
    "end": "50670"
  },
  {
    "text": "the obvious ones are obviously to help",
    "start": "50670",
    "end": "52890"
  },
  {
    "text": "protect your privacy firewalls are also",
    "start": "52890",
    "end": "55680"
  },
  {
    "text": "good at sorting a cyber attacks so many",
    "start": "55680",
    "end": "58109"
  },
  {
    "text": "firewalls are able to generically detect",
    "start": "58109",
    "end": "60960"
  },
  {
    "text": "malware that perhaps has gotten onto",
    "start": "60960",
    "end": "63149"
  },
  {
    "text": "your system and now is trying to beacon",
    "start": "63149",
    "end": "65489"
  },
  {
    "text": "out perhaps to talk to a command and",
    "start": "65489",
    "end": "67110"
  },
  {
    "text": "control server so what our firewall will",
    "start": "67110",
    "end": "69540"
  },
  {
    "text": "do is monitor all network traffic and",
    "start": "69540",
    "end": "71460"
  },
  {
    "text": "allow trusted traffic while detecting",
    "start": "71460",
    "end": "74310"
  },
  {
    "text": "and blocking malicious or unauthorized",
    "start": "74310",
    "end": "76380"
  },
  {
    "text": "traffic now since we need to monitor all",
    "start": "76380",
    "end": "80790"
  },
  {
    "text": "network connections we are going to have",
    "start": "80790",
    "end": "82380"
  },
  {
    "text": "to write a kernel extension luckily in",
    "start": "82380",
    "end": "85110"
  },
  {
    "text": "Mac OS Apple provides something called",
    "start": "85110",
    "end": "87720"
  },
  {
    "text": "Network kernel extensions or NK ease and",
    "start": "87720",
    "end": "90930"
  },
  {
    "text": "they provide a way to modify or extend",
    "start": "90930",
    "end": "93930"
  },
  {
    "text": "the network infrastructure one type of",
    "start": "93930",
    "end": "97079"
  },
  {
    "text": "nke",
    "start": "97079",
    "end": "98009"
  },
  {
    "text": "is called a socket filter filter which",
    "start": "98009",
    "end": "100860"
  },
  {
    "text": "as its name obviously implies can filter",
    "start": "100860",
    "end": "103860"
  },
  {
    "text": "network traffic at the socket level",
    "start": "103860",
    "end": "105840"
  },
  {
    "text": "which for creating a firewall sounds",
    "start": "105840",
    "end": "108090"
  },
  {
    "text": "perfect so in order to filter network",
    "start": "108090",
    "end": "112920"
  },
  {
    "start": "110000",
    "end": "110000"
  },
  {
    "text": "traffic and connections we first have to",
    "start": "112920",
    "end": "115710"
  },
  {
    "text": "register a socket filter so you",
    "start": "115710",
    "end": "118530"
  },
  {
    "text": "accomplish this by first filling out a",
    "start": "118530",
    "end": "120810"
  },
  {
    "text": "socket filter structure and this",
    "start": "120810",
    "end": "123570"
  },
  {
    "text": "structure has various callbacks which",
    "start": "123570",
    "end": "126210"
  },
  {
    "text": "once registered will be invoked by the",
    "start": "126210",
    "end": "128190"
  },
  {
    "text": "operating system anytime a socket action",
    "start": "128190",
    "end": "131190"
  },
  {
    "text": "occurs this thing gives our fire",
    "start": "131190",
    "end": "133440"
  },
  {
    "text": "while the ability to monitor examine and",
    "start": "133440",
    "end": "136440"
  },
  {
    "text": "filter these socket actions now once",
    "start": "136440",
    "end": "140730"
  },
  {
    "text": "this socket filter structure has been",
    "start": "140730",
    "end": "143090"
  },
  {
    "text": "populated you invoke the socket filter",
    "start": "143090",
    "end": "146520"
  },
  {
    "text": "register function and this will as its",
    "start": "146520",
    "end": "149160"
  },
  {
    "text": "name implies register or install the",
    "start": "149160",
    "end": "151440"
  },
  {
    "text": "socket filter now besides that populated",
    "start": "151440",
    "end": "154860"
  },
  {
    "text": "structure structure we just discussed",
    "start": "154860",
    "end": "156540"
  },
  {
    "text": "this filter also takes the socket domain",
    "start": "156540",
    "end": "159570"
  },
  {
    "text": "type and the protocol so this means if",
    "start": "159570",
    "end": "162630"
  },
  {
    "text": "you want to filter multiple socket types",
    "start": "162630",
    "end": "165720"
  },
  {
    "text": "for example ipv4 ipv6 etc etc you have",
    "start": "165720",
    "end": "169260"
  },
  {
    "text": "to invoke this function multiple times",
    "start": "169260",
    "end": "172820"
  },
  {
    "text": "all right so now let's talk about these",
    "start": "172820",
    "end": "174930"
  },
  {
    "start": "173000",
    "end": "173000"
  },
  {
    "text": "callbacks which as I mentioned once your",
    "start": "174930",
    "end": "177300"
  },
  {
    "text": "socket filter is installed the operating",
    "start": "177300",
    "end": "179940"
  },
  {
    "text": "system will automatically invoked when",
    "start": "179940",
    "end": "181740"
  },
  {
    "text": "socket actions occur allowing your",
    "start": "181740",
    "end": "183780"
  },
  {
    "text": "firewall to examine and either allow or",
    "start": "183780",
    "end": "185610"
  },
  {
    "text": "block these events so first up we have",
    "start": "185610",
    "end": "188520"
  },
  {
    "text": "the attach callback as the slide",
    "start": "188520",
    "end": "190560"
  },
  {
    "text": "mentioned this is called anytime a",
    "start": "190560",
    "end": "192390"
  },
  {
    "text": "socket is created and it's called with",
    "start": "192390",
    "end": "194760"
  },
  {
    "text": "the actual socket and also a cookie",
    "start": "194760",
    "end": "197489"
  },
  {
    "text": "parameter which can hold any socket",
    "start": "197489",
    "end": "199950"
  },
  {
    "text": "specific data so here we allocate a",
    "start": "199950",
    "end": "203040"
  },
  {
    "text": "chunk of memory and then we store an",
    "start": "203040",
    "end": "205410"
  },
  {
    "text": "action based on the pit of the process",
    "start": "205410",
    "end": "207959"
  },
  {
    "text": "if it's a process we're going to allow",
    "start": "207959",
    "end": "209850"
  },
  {
    "text": "we set it to allow if it's a process we",
    "start": "209850",
    "end": "212160"
  },
  {
    "text": "want to block we set the action to block",
    "start": "212160",
    "end": "214770"
  },
  {
    "text": "and if it's a new process or something",
    "start": "214770",
    "end": "216690"
  },
  {
    "text": "that we don't recognize we set the",
    "start": "216690",
    "end": "218670"
  },
  {
    "text": "action to ask next up is the connect out",
    "start": "218670",
    "end": "223650"
  },
  {
    "text": "callback and this will be called by the",
    "start": "223650",
    "end": "225959"
  },
  {
    "text": "operating system anytime a socket",
    "start": "225959",
    "end": "228000"
  },
  {
    "text": "attempts to initiate an outgoing",
    "start": "228000",
    "end": "229920"
  },
  {
    "text": "connection it takes that same cookie",
    "start": "229920",
    "end": "232350"
  },
  {
    "text": "parameter which we've set to either",
    "start": "232350",
    "end": "234090"
  },
  {
    "text": "allow block or ask the socket and then",
    "start": "234090",
    "end": "237209"
  },
  {
    "text": "the remote address that the socket is",
    "start": "237209",
    "end": "239100"
  },
  {
    "text": "trying to connect to so we can examine",
    "start": "239100",
    "end": "240930"
  },
  {
    "text": "the endpoint now if we've previously set",
    "start": "240930",
    "end": "243930"
  },
  {
    "text": "the action to allow we just return okay",
    "start": "243930",
    "end": "246570"
  },
  {
    "text": "from this function this tells the",
    "start": "246570",
    "end": "248100"
  },
  {
    "text": "operating system we're cool with this",
    "start": "248100",
    "end": "249810"
  },
  {
    "text": "and it should be allowed if we want to",
    "start": "249810",
    "end": "251820"
  },
  {
    "text": "block this we just return an error from",
    "start": "251820",
    "end": "254040"
  },
  {
    "text": "this callback and this will tell the",
    "start": "254040",
    "end": "255600"
  },
  {
    "text": "operating system to block or deny the",
    "start": "255600",
    "end": "257340"
  },
  {
    "text": "connection now if the cookie has been",
    "start": "257340",
    "end": "260070"
  },
  {
    "text": "set to ask this means we we're not sure",
    "start": "260070",
    "end": "262079"
  },
  {
    "text": "what to do you know should we allow the",
    "start": "262080",
    "end": "263640"
  },
  {
    "text": "process should we block it we're just",
    "start": "263640",
    "end": "265020"
  },
  {
    "text": "not sure so we have to have some extra",
    "start": "265020",
    "end": "268170"
  },
  {
    "text": "so if we don't know what we should do",
    "start": "268170",
    "end": "271420"
  },
  {
    "text": "we're gonna have to ask some other",
    "start": "271420",
    "end": "273700"
  },
  {
    "text": "firewall components so the first thing",
    "start": "273700",
    "end": "276040"
  },
  {
    "text": "we do is still in the kernel we set the",
    "start": "276040",
    "end": "277900"
  },
  {
    "text": "thread to sleep basically pausing the",
    "start": "277900",
    "end": "279700"
  },
  {
    "text": "operation we then ask our user mode",
    "start": "279700",
    "end": "282400"
  },
  {
    "text": "firewall component daemon for assistance",
    "start": "282400",
    "end": "285280"
  },
  {
    "text": "and we pass the information that we have",
    "start": "285280",
    "end": "287530"
  },
  {
    "text": "from the kernel to user mode via shared",
    "start": "287530",
    "end": "290230"
  },
  {
    "text": "queue for example the pit and the socket",
    "start": "290230",
    "end": "292510"
  },
  {
    "text": "that's trying to initiate the outgoing",
    "start": "292510",
    "end": "294070"
  },
  {
    "text": "connection so the daemon now gets this",
    "start": "294070",
    "end": "297280"
  },
  {
    "text": "request from the kernel and what it does",
    "start": "297280",
    "end": "299350"
  },
  {
    "text": "is that map's a pit to a path and then",
    "start": "299350",
    "end": "301870"
  },
  {
    "text": "first checks if this path exists in the",
    "start": "301870",
    "end": "304510"
  },
  {
    "text": "rules database if it's not found meaning",
    "start": "304510",
    "end": "307060"
  },
  {
    "text": "it's a brand new application or a piece",
    "start": "307060",
    "end": "309040"
  },
  {
    "text": "of malware that's never been on the",
    "start": "309040",
    "end": "310630"
  },
  {
    "text": "system before what it then does is it",
    "start": "310630",
    "end": "312730"
  },
  {
    "text": "sends another message to another",
    "start": "312730",
    "end": "314770"
  },
  {
    "text": "firewall component that's running in the",
    "start": "314770",
    "end": "317170"
  },
  {
    "text": "user's UI session which will now",
    "start": "317170",
    "end": "319210"
  },
  {
    "text": "actually display the firewall alert to",
    "start": "319210",
    "end": "321910"
  },
  {
    "text": "the user so the user now has has to",
    "start": "321910",
    "end": "325720"
  },
  {
    "text": "basically answer the question should",
    "start": "325720",
    "end": "327790"
  },
  {
    "text": "they allow this connection and what we",
    "start": "327790",
    "end": "330100"
  },
  {
    "text": "do is we wait until they interact with",
    "start": "330100",
    "end": "331540"
  },
  {
    "text": "this alert once they've clicked either",
    "start": "331540",
    "end": "333880"
  },
  {
    "text": "allow or block this response is first",
    "start": "333880",
    "end": "336340"
  },
  {
    "text": "sent back to the daemon the daemon then",
    "start": "336340",
    "end": "338320"
  },
  {
    "text": "updates the rule database and then",
    "start": "338320",
    "end": "340360"
  },
  {
    "text": "propagates this response back into the",
    "start": "340360",
    "end": "342760"
  },
  {
    "text": "kernel via and i/o kit interface the",
    "start": "342760",
    "end": "345700"
  },
  {
    "text": "kernel extension wakes up the thread",
    "start": "345700",
    "end": "347980"
  },
  {
    "text": "that it had previously put asleep and",
    "start": "347980",
    "end": "349690"
  },
  {
    "text": "then applies the action that the user",
    "start": "349690",
    "end": "351610"
  },
  {
    "text": "specified either allowing or blocking",
    "start": "351610",
    "end": "353800"
  },
  {
    "text": "the connection so basically that at",
    "start": "353800",
    "end": "357610"
  },
  {
    "text": "least from a conceptual point of view is",
    "start": "357610",
    "end": "359410"
  },
  {
    "text": "all the pieces we need to build a",
    "start": "359410",
    "end": "361030"
  },
  {
    "text": "comprehensive kernel level firewall for",
    "start": "361030",
    "end": "362890"
  },
  {
    "text": "Mac OS so we put this all together we",
    "start": "362890",
    "end": "365380"
  },
  {
    "text": "have Lulu so mention Lulu is a free",
    "start": "365380",
    "end": "367870"
  },
  {
    "text": "firewall for Mac OS the entire source",
    "start": "367870",
    "end": "370690"
  },
  {
    "text": "code for this product is available on",
    "start": "370690",
    "end": "372490"
  },
  {
    "text": "Lion and as of today you can download",
    "start": "372490",
    "end": "374590"
  },
  {
    "text": "and install version 1.0 all right now",
    "start": "374590",
    "end": "379390"
  },
  {
    "text": "black hat is predominantly at least in",
    "start": "379390",
    "end": "381520"
  },
  {
    "text": "my opinion at a hacker conference so now",
    "start": "381520",
    "end": "383590"
  },
  {
    "text": "let's turn our attention to breaking or",
    "start": "383590",
    "end": "386350"
  },
  {
    "text": "bypassing these firewalls so imagine you",
    "start": "386350",
    "end": "390970"
  },
  {
    "text": "are an attacker or perhaps a piece of",
    "start": "390970",
    "end": "393310"
  },
  {
    "text": "malware that's made it to a host so",
    "start": "393310",
    "end": "395320"
  },
  {
    "text": "you've infected a system unfortunately",
    "start": "395320",
    "end": "396730"
  },
  {
    "text": "there is a firewall installed so what",
    "start": "396730",
    "end": "399520"
  },
  {
    "text": "your goal is pretty simple",
    "start": "399520",
    "end": "401050"
  },
  {
    "text": "it's to connect out to either a command",
    "start": "401050",
    "end": "403569"
  },
  {
    "text": "and control server for tasking or",
    "start": "403569",
    "end": "405159"
  },
  {
    "text": "perhaps to exfiltrate some data without",
    "start": "405159",
    "end": "407740"
  },
  {
    "text": "being blocked by whatever firewall is",
    "start": "407740",
    "end": "410050"
  },
  {
    "text": "installed on that system so in this part",
    "start": "410050",
    "end": "412569"
  },
  {
    "text": "of the talk we're first going to look at",
    "start": "412569",
    "end": "413740"
  },
  {
    "text": "some malware firewall aware malware",
    "start": "413740",
    "end": "416590"
  },
  {
    "text": "we're then going to talk about some",
    "start": "416590",
    "end": "418419"
  },
  {
    "text": "exploitable security flaws in firewall",
    "start": "418419",
    "end": "421090"
  },
  {
    "text": "products and then end with talking about",
    "start": "421090",
    "end": "423220"
  },
  {
    "text": "some of firewall bypasses so it's",
    "start": "423220",
    "end": "427210"
  },
  {
    "text": "actually very important for malware to",
    "start": "427210",
    "end": "428830"
  },
  {
    "text": "detect if there is a firewall on the box",
    "start": "428830",
    "end": "431680"
  },
  {
    "text": "because if they don't as we can see on",
    "start": "431680",
    "end": "433750"
  },
  {
    "text": "the slide this might be their undoing",
    "start": "433750",
    "end": "435250"
  },
  {
    "text": "the firewall might detect when the",
    "start": "435250",
    "end": "437500"
  },
  {
    "text": "malware which was previously undetected",
    "start": "437500",
    "end": "439240"
  },
  {
    "text": "connects out and that's alert the user",
    "start": "439240",
    "end": "441759"
  },
  {
    "text": "that there's something suspicious on",
    "start": "441759",
    "end": "443680"
  },
  {
    "text": "their box now I've yet to see any public",
    "start": "443680",
    "end": "447550"
  },
  {
    "text": "Mac malware that is proactively trying",
    "start": "447550",
    "end": "449770"
  },
  {
    "text": "to bat bypass firewall products but",
    "start": "449770",
    "end": "452710"
  },
  {
    "text": "there are some Mac malware specimens",
    "start": "452710",
    "end": "454659"
  },
  {
    "text": "that are firewall aware what I mean by",
    "start": "454659",
    "end": "457240"
  },
  {
    "text": "this is they actively look to see if any",
    "start": "457240",
    "end": "459400"
  },
  {
    "text": "firewall product is installed on the",
    "start": "459400",
    "end": "461259"
  },
  {
    "text": "system and if there is they will not",
    "start": "461259",
    "end": "463680"
  },
  {
    "text": "persistently infect that box so one",
    "start": "463680",
    "end": "466930"
  },
  {
    "text": "example is devil robber here is a",
    "start": "466930",
    "end": "469029"
  },
  {
    "text": "snippet of code from one of its scripts",
    "start": "469029",
    "end": "471550"
  },
  {
    "text": "install scripts and we can see what it's",
    "start": "471550",
    "end": "473680"
  },
  {
    "text": "doing is it's checking for the presence",
    "start": "473680",
    "end": "475630"
  },
  {
    "text": "of Little Snitch which is a popular",
    "start": "475630",
    "end": "477580"
  },
  {
    "text": "third-party firewall if it finds that",
    "start": "477580",
    "end": "480819"
  },
  {
    "text": "extension instead of infecting the",
    "start": "480819",
    "end": "483279"
  },
  {
    "text": "system persistently it just executes a",
    "start": "483279",
    "end": "486849"
  },
  {
    "text": "benign app version of the application it",
    "start": "486849",
    "end": "488979"
  },
  {
    "text": "infected and then exits so the author of",
    "start": "488979",
    "end": "491469"
  },
  {
    "text": "this malware basically said hey I don't",
    "start": "491469",
    "end": "494469"
  },
  {
    "start": "494000",
    "end": "494000"
  },
  {
    "text": "want to be detected so if there's a",
    "start": "494469",
    "end": "495819"
  },
  {
    "text": "firewall I'm just gonna bail all right",
    "start": "495819",
    "end": "498940"
  },
  {
    "text": "so now on to some real issues firewalls",
    "start": "498940",
    "end": "501819"
  },
  {
    "text": "are obviously rather complex pieces of",
    "start": "501819",
    "end": "504190"
  },
  {
    "text": "software they run with elevated",
    "start": "504190",
    "end": "506139"
  },
  {
    "text": "privileges in route or in the kernel and",
    "start": "506139",
    "end": "509310"
  },
  {
    "text": "unfortunately they're often not as",
    "start": "509310",
    "end": "511300"
  },
  {
    "text": "well-written as the operating system nor",
    "start": "511300",
    "end": "513399"
  },
  {
    "text": "as audited so they make great targets",
    "start": "513399",
    "end": "515500"
  },
  {
    "text": "for looking for local privilege",
    "start": "515500",
    "end": "517149"
  },
  {
    "text": "escalation vulnerabilities so a while",
    "start": "517149",
    "end": "520089"
  },
  {
    "text": "back I found a kernel bug in the Little",
    "start": "520089",
    "end": "522550"
  },
  {
    "text": "Snitch firewall driver basically it took",
    "start": "522550",
    "end": "525010"
  },
  {
    "text": "a 64-bit value from user mode and passed",
    "start": "525010",
    "end": "528190"
  },
  {
    "text": "this value to an allocation routine and",
    "start": "528190",
    "end": "530079"
  },
  {
    "text": "then a copy routine now the issue was",
    "start": "530079",
    "end": "533380"
  },
  {
    "text": "the",
    "start": "533380",
    "end": "534670"
  },
  {
    "text": "Haitian routine expected a 32-bit value",
    "start": "534670",
    "end": "537190"
  },
  {
    "text": "so it truncated the 64-bit value the",
    "start": "537190",
    "end": "540220"
  },
  {
    "text": "copy however used the full 64-bit value",
    "start": "540220",
    "end": "542790"
  },
  {
    "text": "meaning we could cause a controllable",
    "start": "542790",
    "end": "545440"
  },
  {
    "text": "mismatch between the allocation and the",
    "start": "545440",
    "end": "548170"
  },
  {
    "text": "copy routine",
    "start": "548170",
    "end": "549280"
  },
  {
    "text": "giving us an exploitable heap overflow",
    "start": "549280",
    "end": "551740"
  },
  {
    "text": "in the kernel another issue I found also",
    "start": "551740",
    "end": "555820"
  },
  {
    "text": "in Little Snitch when I was working on",
    "start": "555820",
    "end": "557230"
  },
  {
    "text": "these slides affects its installer or",
    "start": "557230",
    "end": "559240"
  },
  {
    "text": "updater component basically it would not",
    "start": "559240",
    "end": "561970"
  },
  {
    "text": "validate that the new firewall",
    "start": "561970",
    "end": "564340"
  },
  {
    "text": "components it was installing had not",
    "start": "564340",
    "end": "566470"
  },
  {
    "text": "been tampered so what a local",
    "start": "566470",
    "end": "568330"
  },
  {
    "text": "unprivileged attacker could do is modify",
    "start": "568330",
    "end": "571390"
  },
  {
    "text": "these components and then the privileged",
    "start": "571390",
    "end": "574330"
  },
  {
    "text": "firewall installer would naively use",
    "start": "574330",
    "end": "577300"
  },
  {
    "text": "these infected or modified components",
    "start": "577300",
    "end": "579640"
  },
  {
    "text": "and execute them as root basically",
    "start": "579640",
    "end": "581800"
  },
  {
    "text": "giving again a local and privilege",
    "start": "581800",
    "end": "583480"
  },
  {
    "text": "attacker root privileges all right so",
    "start": "583480",
    "end": "588100"
  },
  {
    "text": "now let's talk about bypassing these",
    "start": "588100",
    "end": "589720"
  },
  {
    "text": "products first we'll look at ways to",
    "start": "589720",
    "end": "591730"
  },
  {
    "text": "bypass various products so some specific",
    "start": "591730",
    "end": "594460"
  },
  {
    "text": "product specific bypasses and then we'll",
    "start": "594460",
    "end": "597490"
  },
  {
    "text": "talk about some more powerful",
    "start": "597490",
    "end": "599290"
  },
  {
    "text": "capabilities that can bypass all third",
    "start": "599290",
    "end": "601570"
  },
  {
    "text": "party firewalls again the goal is to",
    "start": "601570",
    "end": "604060"
  },
  {
    "text": "access the network without being blocked",
    "start": "604060",
    "end": "606040"
  },
  {
    "text": "by and installed firewall now I do want",
    "start": "606040",
    "end": "609070"
  },
  {
    "text": "to make one point and that is any",
    "start": "609070",
    "end": "610870"
  },
  {
    "text": "security tool that is proactively or",
    "start": "610870",
    "end": "613090"
  },
  {
    "text": "specifically targeted will be by",
    "start": "613090",
    "end": "615370"
  },
  {
    "text": "passable so in my opinion these aren't",
    "start": "615370",
    "end": "617950"
  },
  {
    "text": "necessarily security flaws like these",
    "start": "617950",
    "end": "619600"
  },
  {
    "text": "shouldn't be assigned CDs I think that's",
    "start": "619600",
    "end": "621310"
  },
  {
    "text": "kind of lame however they are very",
    "start": "621310",
    "end": "622840"
  },
  {
    "text": "important for attackers or malware which",
    "start": "622840",
    "end": "625630"
  },
  {
    "text": "might otherwise be detected or blocked",
    "start": "625630",
    "end": "628920"
  },
  {
    "text": "so first up we have radio silence radio",
    "start": "628920",
    "end": "631750"
  },
  {
    "text": "silence is a popular firewall for Mac OS",
    "start": "631750",
    "end": "634270"
  },
  {
    "text": "and by default it actually allows any",
    "start": "634270",
    "end": "636580"
  },
  {
    "text": "new process so it basically takes a more",
    "start": "636580",
    "end": "639100"
  },
  {
    "text": "blacklisting approach expecting the user",
    "start": "639100",
    "end": "641350"
  },
  {
    "text": "to blacklist a process now if you look",
    "start": "641350",
    "end": "644410"
  },
  {
    "text": "at the disassembly for it's blacklisting",
    "start": "644410",
    "end": "646600"
  },
  {
    "text": "logic in the kernel we can see it's",
    "start": "646600",
    "end": "648580"
  },
  {
    "text": "checking the name of a process and if",
    "start": "648580",
    "end": "650950"
  },
  {
    "text": "the process named is Launch D it cannot",
    "start": "650950",
    "end": "653560"
  },
  {
    "text": "be blacklisted more blocked so to test",
    "start": "653560",
    "end": "656950"
  },
  {
    "text": "this we create some malware and we name",
    "start": "656950",
    "end": "659020"
  },
  {
    "text": "it launch D doesn't matter where it is",
    "start": "659020",
    "end": "660730"
  },
  {
    "text": "just as long as its name is Launch D we",
    "start": "660730",
    "end": "663130"
  },
  {
    "text": "manually create a rule to blacklist the",
    "start": "663130",
    "end": "665470"
  },
  {
    "text": "malware and then we execute the malware",
    "start": "665470",
    "end": "667420"
  },
  {
    "text": "and low",
    "start": "667420",
    "end": "668089"
  },
  {
    "text": "hold even though there's a rule to",
    "start": "668089",
    "end": "669470"
  },
  {
    "text": "blacklist that it is allowed because it",
    "start": "669470",
    "end": "671839"
  },
  {
    "text": "matches on the name in the kernel so",
    "start": "671839",
    "end": "674240"
  },
  {
    "text": "this is kind of lame but you know it's a",
    "start": "674240",
    "end": "676279"
  },
  {
    "text": "full bypass another popular",
    "start": "676279",
    "end": "679639"
  },
  {
    "text": "Mac Firewall product is called hands-off",
    "start": "679639",
    "end": "681620"
  },
  {
    "text": "and it turns out we can fairly easily",
    "start": "681620",
    "end": "684259"
  },
  {
    "text": "bypass it via synthetic or",
    "start": "684259",
    "end": "686389"
  },
  {
    "text": "programmatically generated clicks so say",
    "start": "686389",
    "end": "689300"
  },
  {
    "text": "for example we want to execute curl curl",
    "start": "689300",
    "end": "691430"
  },
  {
    "text": "is used a lot by malware to download",
    "start": "691430",
    "end": "693709"
  },
  {
    "text": "other components maybe a second stage",
    "start": "693709",
    "end": "695990"
  },
  {
    "text": "implant etc etc so if we execute this",
    "start": "695990",
    "end": "698600"
  },
  {
    "text": "the firewall will detect that curl is",
    "start": "698600",
    "end": "700790"
  },
  {
    "text": "generating an outgoing connection which",
    "start": "700790",
    "end": "702439"
  },
  {
    "text": "is good but what an attacker or piece of",
    "start": "702439",
    "end": "704509"
  },
  {
    "text": "malware can then do is send a synthetic",
    "start": "704509",
    "end": "706430"
  },
  {
    "text": "mouse click to that alert to",
    "start": "706430",
    "end": "708170"
  },
  {
    "text": "programmatically click the allow button",
    "start": "708170",
    "end": "710029"
  },
  {
    "text": "this will allow the connection and",
    "start": "710029",
    "end": "712910"
  },
  {
    "text": "dismiss the alert and there's also ways",
    "start": "712910",
    "end": "715189"
  },
  {
    "text": "to do this invisibly so that the user",
    "start": "715189",
    "end": "716839"
  },
  {
    "text": "doesn't see the alert pop-up and the",
    "start": "716839",
    "end": "718670"
  },
  {
    "text": "mouse generate the click now odd to Lulu",
    "start": "718670",
    "end": "722600"
  },
  {
    "text": "as Lulu is open-source turns out it's",
    "start": "722600",
    "end": "724939"
  },
  {
    "text": "really not that hard to find a bypass by",
    "start": "724939",
    "end": "727610"
  },
  {
    "text": "default Lulu trusts Apple signed",
    "start": "727610",
    "end": "729829"
  },
  {
    "text": "binaries although it has a grey list of",
    "start": "729829",
    "end": "732470"
  },
  {
    "text": "Apple signed binaries that perhaps could",
    "start": "732470",
    "end": "734329"
  },
  {
    "text": "be utilized by malware to perform",
    "start": "734329",
    "end": "736160"
  },
  {
    "text": "malicious Network actions for example",
    "start": "736160",
    "end": "737600"
  },
  {
    "text": "curl and net cat so the question is can",
    "start": "737600",
    "end": "740870"
  },
  {
    "text": "we find a Apple sign system binary that",
    "start": "740870",
    "end": "743990"
  },
  {
    "text": "can allow us to do nefarious Network",
    "start": "743990",
    "end": "745910"
  },
  {
    "text": "actions but that is not on the grey list",
    "start": "745910",
    "end": "749230"
  },
  {
    "text": "the answer is of course yes turns out",
    "start": "749230",
    "end": "751970"
  },
  {
    "text": "you can actually use the Whois utility",
    "start": "751970",
    "end": "753860"
  },
  {
    "text": "to exfiltrate data this was news to me",
    "start": "753860",
    "end": "756639"
  },
  {
    "text": "since Whois is signed by Apple proper as",
    "start": "756639",
    "end": "760069"
  },
  {
    "text": "we can see on the slide when we use",
    "start": "760069",
    "end": "762529"
  },
  {
    "text": "Whois to exfiltrate data the firewall",
    "start": "762529",
    "end": "765139"
  },
  {
    "text": "Lulu will see the connection because",
    "start": "765139",
    "end": "766970"
  },
  {
    "text": "it's monitoring all connections globally",
    "start": "766970",
    "end": "768649"
  },
  {
    "text": "but since it's signed by Apple and not",
    "start": "768649",
    "end": "770959"
  },
  {
    "text": "on the grey list it is allowed finally",
    "start": "770959",
    "end": "775790"
  },
  {
    "text": "we have Little Snitch which is probably",
    "start": "775790",
    "end": "777259"
  },
  {
    "text": "the most popular or well-known Mac",
    "start": "777259",
    "end": "778999"
  },
  {
    "text": "security product and it turns out it has",
    "start": "778999",
    "end": "781100"
  },
  {
    "text": "an undeletable system rule to allow any",
    "start": "781100",
    "end": "783319"
  },
  {
    "text": "process to talk to icloud.com",
    "start": "783319",
    "end": "785749"
  },
  {
    "text": "this means any process even malware will",
    "start": "785749",
    "end": "788300"
  },
  {
    "text": "be able to talk to Apple's servers so to",
    "start": "788300",
    "end": "791509"
  },
  {
    "text": "test this we can create a rule to block",
    "start": "791509",
    "end": "794120"
  },
  {
    "text": "curl and then we can execute curl and",
    "start": "794120",
    "end": "796819"
  },
  {
    "text": "specify a URL that exists on iCloud and",
    "start": "796819",
    "end": "799549"
  },
  {
    "text": "turns out even if we have this rule",
    "start": "799549",
    "end": "801680"
  },
  {
    "text": "curl because of the end point has been",
    "start": "801680",
    "end": "803660"
  },
  {
    "text": "basically whitelisted it is allowed by",
    "start": "803660",
    "end": "805760"
  },
  {
    "text": "Little Snitch",
    "start": "805760",
    "end": "807550"
  },
  {
    "text": "so while back i reverse-engineered the",
    "start": "807550",
    "end": "810620"
  },
  {
    "text": "iCloud protocol and set up a command",
    "start": "810620",
    "end": "813230"
  },
  {
    "text": "control server on iDrive which is also",
    "start": "813230",
    "end": "815450"
  },
  {
    "text": "an iCloud domain of course just for",
    "start": "815450",
    "end": "817490"
  },
  {
    "text": "testing purposes so once we understand",
    "start": "817490",
    "end": "820130"
  },
  {
    "text": "the protocol we can write a script that",
    "start": "820130",
    "end": "821570"
  },
  {
    "text": "will export rate files for example",
    "start": "821570",
    "end": "823010"
  },
  {
    "text": "something called top-secret txt to",
    "start": "823010",
    "end": "826240"
  },
  {
    "text": "iCloud to the iDrive command control",
    "start": "826240",
    "end": "829130"
  },
  {
    "text": "server we have set up again little",
    "start": "829130",
    "end": "831440"
  },
  {
    "text": "snitch will see this connection but",
    "start": "831440",
    "end": "833029"
  },
  {
    "text": "because of the endpoint is allowed it",
    "start": "833029",
    "end": "834860"
  },
  {
    "text": "will allow the exfiltration to occur all",
    "start": "834860",
    "end": "838790"
  },
  {
    "start": "838000",
    "end": "838000"
  },
  {
    "text": "right so those were product specific",
    "start": "838790",
    "end": "840410"
  },
  {
    "text": "bypasses there kind of neat but they're",
    "start": "840410",
    "end": "841940"
  },
  {
    "text": "also kind of lame why well the attacker",
    "start": "841940",
    "end": "844220"
  },
  {
    "text": "will first have to enumerate what exact",
    "start": "844220",
    "end": "846350"
  },
  {
    "text": "product firewall product is installed",
    "start": "846350",
    "end": "848149"
  },
  {
    "text": "and then use one of these product",
    "start": "848149",
    "end": "849980"
  },
  {
    "text": "specific exploits so that's kind of a",
    "start": "849980",
    "end": "851990"
  },
  {
    "text": "pain in the butt now much much better",
    "start": "851990",
    "end": "854360"
  },
  {
    "text": "would would be to have a generic bypass",
    "start": "854360",
    "end": "857120"
  },
  {
    "text": "which would in type ass any installed",
    "start": "857120",
    "end": "860270"
  },
  {
    "text": "firewall basically saying I'm agnostic",
    "start": "860270",
    "end": "862190"
  },
  {
    "text": "to whatever firewall that's installed",
    "start": "862190",
    "end": "863690"
  },
  {
    "text": "I'm just gonna generically bypass this",
    "start": "863690",
    "end": "865100"
  },
  {
    "text": "and these are possible because firewalls",
    "start": "865100",
    "end": "868250"
  },
  {
    "text": "must allow some traffic on the network",
    "start": "868250",
    "end": "870770"
  },
  {
    "text": "for example system protocols system",
    "start": "870770",
    "end": "873680"
  },
  {
    "text": "binaries and also the user is probably",
    "start": "873680",
    "end": "875810"
  },
  {
    "text": "going to fully allow things like",
    "start": "875810",
    "end": "877279"
  },
  {
    "text": "browsers giving them indiscriminate",
    "start": "877279",
    "end": "879170"
  },
  {
    "text": "network access so to generically bypass",
    "start": "879170",
    "end": "882920"
  },
  {
    "text": "a system with a firewall we going to do",
    "start": "882920",
    "end": "884839"
  },
  {
    "text": "two things first we're going to",
    "start": "884839",
    "end": "886490"
  },
  {
    "text": "passively sniff and determine what",
    "start": "886490",
    "end": "889040"
  },
  {
    "text": "traffic the firewall is allowing out and",
    "start": "889040",
    "end": "891050"
  },
  {
    "text": "then we're going to abuse either these",
    "start": "891050",
    "end": "892910"
  },
  {
    "text": "protocols or these applications to",
    "start": "892910",
    "end": "894709"
  },
  {
    "text": "perform nefarious Network actions so",
    "start": "894709",
    "end": "899450"
  },
  {
    "text": "first to determine what processes or",
    "start": "899450",
    "end": "902450"
  },
  {
    "text": "protocols are allowed we can use the LSO",
    "start": "902450",
    "end": "905630"
  },
  {
    "text": "F utility which is built-in system",
    "start": "905630",
    "end": "907640"
  },
  {
    "text": "utility on Mac OS you can execute it",
    "start": "907640",
    "end": "909829"
  },
  {
    "text": "without any special privileges and it",
    "start": "909829",
    "end": "911779"
  },
  {
    "text": "will show you what network traffic is",
    "start": "911779",
    "end": "913940"
  },
  {
    "text": "allowed so this is a dump for my box we",
    "start": "913940",
    "end": "916220"
  },
  {
    "text": "can see things like chrome the browser",
    "start": "916220",
    "end": "919190"
  },
  {
    "text": "you know chat applications like slack",
    "start": "919190",
    "end": "920990"
  },
  {
    "text": "signal bunch of Adobe crap basically a",
    "start": "920990",
    "end": "923870"
  },
  {
    "text": "lot of stuff now some firewalls will",
    "start": "923870",
    "end": "926839"
  },
  {
    "text": "have endpoints specific rules meaning",
    "start": "926839",
    "end": "929510"
  },
  {
    "text": "that they might say ok Adobe is only",
    "start": "929510",
    "end": "931250"
  },
  {
    "text": "allowed to talk to the Adobe servers but",
    "start": "931250",
    "end": "933740"
  },
  {
    "text": "as I mentioned something like a browsers",
    "start": "933740",
    "end": "935360"
  },
  {
    "text": "go",
    "start": "935360",
    "end": "935630"
  },
  {
    "text": "to be able to talk to any remote web",
    "start": "935630",
    "end": "938090"
  },
  {
    "text": "server on port 80 or 443 of course also",
    "start": "938090",
    "end": "941660"
  },
  {
    "text": "a lot of these applications now talk to",
    "start": "941660",
    "end": "943190"
  },
  {
    "text": "the cloud for example AWS so even if",
    "start": "943190",
    "end": "945590"
  },
  {
    "text": "there's a rule to say I only want slack",
    "start": "945590",
    "end": "947150"
  },
  {
    "text": "to talk to the AWS infrastructure we can",
    "start": "947150",
    "end": "949850"
  },
  {
    "text": "probably also create a CNC on AWS okay",
    "start": "949850",
    "end": "955040"
  },
  {
    "start": "954000",
    "end": "954000"
  },
  {
    "text": "so now we know what traffic and what",
    "start": "955040",
    "end": "957110"
  },
  {
    "text": "processes are allowed or allowed to pass",
    "start": "957110",
    "end": "959300"
  },
  {
    "text": "through the firewall",
    "start": "959300",
    "end": "960200"
  },
  {
    "text": "so the first generic bypass were",
    "start": "960200",
    "end": "962480"
  },
  {
    "text": "actually going to indirectly exploit the",
    "start": "962480",
    "end": "964850"
  },
  {
    "text": "trust of a process via a trusted",
    "start": "964850",
    "end": "967490"
  },
  {
    "text": "protocol so on Mac DNS on Mac OS DNS",
    "start": "967490",
    "end": "971600"
  },
  {
    "text": "requests are handled by the system mdns",
    "start": "971600",
    "end": "975200"
  },
  {
    "text": "responder so if a random application or",
    "start": "975200",
    "end": "977660"
  },
  {
    "text": "a piece of malware wants to resolve a",
    "start": "977660",
    "end": "980240"
  },
  {
    "text": "domain this is sent locally to the",
    "start": "980240",
    "end": "982280"
  },
  {
    "text": "system daemon then the system daemon is",
    "start": "982280",
    "end": "984710"
  },
  {
    "text": "the one that actually generates the",
    "start": "984710",
    "end": "986210"
  },
  {
    "text": "network requests so the firewall is",
    "start": "986210",
    "end": "991190"
  },
  {
    "text": "gonna see this DNS request but it's",
    "start": "991190",
    "end": "992990"
  },
  {
    "text": "going to be coming from a trusted system",
    "start": "992990",
    "end": "995000"
  },
  {
    "text": "daemon which is generating all DNS",
    "start": "995000",
    "end": "998540"
  },
  {
    "text": "requests for the entire system so the",
    "start": "998540",
    "end": "1000610"
  },
  {
    "text": "firewall basically has no choice but to",
    "start": "1000610",
    "end": "1002320"
  },
  {
    "text": "allow it so what we can do is we can",
    "start": "1002320",
    "end": "1004690"
  },
  {
    "text": "basically build a DNS based CNC",
    "start": "1004690",
    "end": "1006640"
  },
  {
    "text": "mechanism which has been discussed",
    "start": "1006640",
    "end": "1007930"
  },
  {
    "text": "before and again since the firewall is",
    "start": "1007930",
    "end": "1010180"
  },
  {
    "text": "going to trust DNS requests from the",
    "start": "1010180",
    "end": "1012070"
  },
  {
    "text": "trusted Apple system daemon this will",
    "start": "1012070",
    "end": "1014140"
  },
  {
    "text": "allow us to have a full command and",
    "start": "1014140",
    "end": "1015670"
  },
  {
    "text": "control mechanism which can generically",
    "start": "1015670",
    "end": "1017860"
  },
  {
    "text": "bypass all third party firewalls next up",
    "start": "1017860",
    "end": "1021760"
  },
  {
    "start": "1021000",
    "end": "1021000"
  },
  {
    "text": "let's abuse browsers the simple fact is",
    "start": "1021760",
    "end": "1024250"
  },
  {
    "text": "if you have a browser installed even if",
    "start": "1024250",
    "end": "1026920"
  },
  {
    "text": "you also have a firewall installed",
    "start": "1026920",
    "end": "1028600"
  },
  {
    "text": "you're going to give the browser",
    "start": "1028600",
    "end": "1029850"
  },
  {
    "text": "generally indiscriminate access because",
    "start": "1029850",
    "end": "1032290"
  },
  {
    "text": "I mean think about it it browses to",
    "start": "1032290",
    "end": "1033520"
  },
  {
    "text": "hundreds of websites every day there's",
    "start": "1033520",
    "end": "1035230"
  },
  {
    "text": "no way you're just gonna sit and",
    "start": "1035230",
    "end": "1036188"
  },
  {
    "text": "whitelist all of them and of course this",
    "start": "1036189",
    "end": "1037959"
  },
  {
    "text": "is something that we can passively",
    "start": "1037959",
    "end": "1039310"
  },
  {
    "text": "determine via l sof we can for example",
    "start": "1039310",
    "end": "1041949"
  },
  {
    "text": "watch for a few hours even a few days",
    "start": "1041949",
    "end": "1043870"
  },
  {
    "text": "and build a profile of what traffic the",
    "start": "1043870",
    "end": "1045970"
  },
  {
    "text": "browser allows and then basically say",
    "start": "1045970",
    "end": "1047500"
  },
  {
    "text": "okay it looks like chrome is allowed to",
    "start": "1047500",
    "end": "1049720"
  },
  {
    "text": "talk to any network endpoint so the",
    "start": "1049720",
    "end": "1052510"
  },
  {
    "text": "first way we can abuse a browser to do",
    "start": "1052510",
    "end": "1054340"
  },
  {
    "text": "some malicious network activity based on",
    "start": "1054340",
    "end": "1057070"
  },
  {
    "text": "our behalf is via Apple script so on the",
    "start": "1057070",
    "end": "1059920"
  },
  {
    "text": "slide there's a few little Apple script",
    "start": "1059920",
    "end": "1061570"
  },
  {
    "text": "commands we're basically asking Safari",
    "start": "1061570",
    "end": "1063580"
  },
  {
    "text": "to invisibly browse to a remote attacker",
    "start": "1063580",
    "end": "1066550"
  },
  {
    "text": "controlled command-and-control server",
    "start": "1066550",
    "end": "1068950"
  },
  {
    "text": "again the firewall will see this request",
    "start": "1068950",
    "end": "1070720"
  },
  {
    "text": "but will allow it because it's coming",
    "start": "1070720",
    "end": "1072640"
  },
  {
    "text": "from the context of the users browser an",
    "start": "1072640",
    "end": "1077440"
  },
  {
    "text": "even better way to generically bypass",
    "start": "1077440",
    "end": "1079480"
  },
  {
    "text": "all firewalls is to abuse the browser's",
    "start": "1079480",
    "end": "1082120"
  },
  {
    "text": "command-line interfaces all the major",
    "start": "1082120",
    "end": "1084250"
  },
  {
    "text": "browsers now support synthetic browsing",
    "start": "1084250",
    "end": "1087370"
  },
  {
    "text": "via the command line really doesn't get",
    "start": "1087370",
    "end": "1089440"
  },
  {
    "text": "easier than this so again the firewall",
    "start": "1089440",
    "end": "1091810"
  },
  {
    "text": "will see these connections but will",
    "start": "1091810",
    "end": "1094060"
  },
  {
    "text": "allow them as it really just appears",
    "start": "1094060",
    "end": "1096130"
  },
  {
    "text": "like it's the users default browser",
    "start": "1096130",
    "end": "1097840"
  },
  {
    "text": "browsing to some endpoint which is what",
    "start": "1097840",
    "end": "1100030"
  },
  {
    "text": "browsers do yet another way to abuse any",
    "start": "1100030",
    "end": "1104740"
  },
  {
    "text": "application or trusted binary is to",
    "start": "1104740",
    "end": "1107830"
  },
  {
    "text": "inject a dynamic library into it once",
    "start": "1107830",
    "end": "1110800"
  },
  {
    "text": "the library or your code is in the",
    "start": "1110800",
    "end": "1112870"
  },
  {
    "text": "process context of this trusted process",
    "start": "1112870",
    "end": "1116020"
  },
  {
    "text": "from the firewalls point of view",
    "start": "1116020",
    "end": "1118300"
  },
  {
    "text": "whatever trust that application has will",
    "start": "1118300",
    "end": "1121420"
  },
  {
    "text": "be also given to that dynamic library so",
    "start": "1121420",
    "end": "1124090"
  },
  {
    "text": "for example if you have a chat",
    "start": "1124090",
    "end": "1125110"
  },
  {
    "text": "application or a browser that's allowed",
    "start": "1125110",
    "end": "1126940"
  },
  {
    "text": "to talk to any network endpoint you can",
    "start": "1126940",
    "end": "1129040"
  },
  {
    "text": "inject a dye Lib into that process the",
    "start": "1129040",
    "end": "1131740"
  },
  {
    "text": "firewall will also give that library",
    "start": "1131740",
    "end": "1133900"
  },
  {
    "text": "full access because it's checks or",
    "start": "1133900",
    "end": "1136060"
  },
  {
    "text": "insight is really only at the process",
    "start": "1136060",
    "end": "1137800"
  },
  {
    "text": "level now there's many ways to inject",
    "start": "1137800",
    "end": "1140350"
  },
  {
    "text": "dye lives into third-party applications",
    "start": "1140350",
    "end": "1142210"
  },
  {
    "text": "on Mac OS fortunately due to time",
    "start": "1142210",
    "end": "1144190"
  },
  {
    "text": "constraints we can't go through these",
    "start": "1144190",
    "end": "1145510"
  },
  {
    "text": "but I've listed them on the slide now",
    "start": "1145510",
    "end": "1148590"
  },
  {
    "start": "1148000",
    "end": "1148000"
  },
  {
    "text": "the final way to bypass firewalls invert",
    "start": "1148590",
    "end": "1152440"
  },
  {
    "text": "involves getting a malicious code",
    "start": "1152440",
    "end": "1153880"
  },
  {
    "text": "running in the kernel in short if an",
    "start": "1153880",
    "end": "1155980"
  },
  {
    "text": "attacker can get code running in ring",
    "start": "1155980",
    "end": "1158020"
  },
  {
    "text": "zero it's really game over from the",
    "start": "1158020",
    "end": "1160060"
  },
  {
    "text": "firewalls point of view first most",
    "start": "1160060",
    "end": "1162070"
  },
  {
    "text": "firewalls actually generically allow any",
    "start": "1162070",
    "end": "1164170"
  },
  {
    "text": "traffic that originates from the kernel",
    "start": "1164170",
    "end": "1166330"
  },
  {
    "text": "anyways so you can just generate an",
    "start": "1166330",
    "end": "1168580"
  },
  {
    "text": "outgoing network request the firewall",
    "start": "1168580",
    "end": "1170560"
  },
  {
    "text": "will see it but again since it's coming",
    "start": "1170560",
    "end": "1172390"
  },
  {
    "text": "from the context of the kernel it will",
    "start": "1172390",
    "end": "1174340"
  },
  {
    "text": "be allowed you can also do something",
    "start": "1174340",
    "end": "1177700"
  },
  {
    "text": "like generically unhook or uninstall the",
    "start": "1177700",
    "end": "1180400"
  },
  {
    "text": "socket filter firewall driver or",
    "start": "1180400",
    "end": "1182440"
  },
  {
    "text": "extension this will transparently",
    "start": "1182440",
    "end": "1184600"
  },
  {
    "text": "disable the firewall and then the",
    "start": "1184600",
    "end": "1186850"
  },
  {
    "text": "attackers code or any component in user",
    "start": "1186850",
    "end": "1189010"
  },
  {
    "text": "mode can generate outgoing connections",
    "start": "1189010",
    "end": "1191050"
  },
  {
    "text": "and since the firewall has been",
    "start": "1191050",
    "end": "1192430"
  },
  {
    "text": "effectively neutered this connection",
    "start": "1192430",
    "end": "1194380"
  },
  {
    "text": "will be allowed now a valid question is",
    "start": "1194380",
    "end": "1197650"
  },
  {
    "text": "how do we get code running in the kernel",
    "start": "1197650",
    "end": "1199120"
  },
  {
    "text": "recent versions of Mac OS require kernel",
    "start": "1199120",
    "end": "1202360"
  },
  {
    "text": "tensions to be signed so one way it's",
    "start": "1202360",
    "end": "1204580"
  },
  {
    "text": "just to bring a third-party driver that",
    "start": "1204580",
    "end": "1206620"
  },
  {
    "text": "has a vulnerability along with you to",
    "start": "1206620",
    "end": "1208960"
  },
  {
    "text": "the target you then load that driver it",
    "start": "1208960",
    "end": "1211060"
  },
  {
    "text": "will be allowed because it's validly",
    "start": "1211060",
    "end": "1212680"
  },
  {
    "text": "signed and then you can exploit the",
    "start": "1212680",
    "end": "1214600"
  },
  {
    "text": "vulnerability so for example we could",
    "start": "1214600",
    "end": "1216310"
  },
  {
    "text": "bring the Little Snitch Colonel",
    "start": "1216310",
    "end": "1217810"
  },
  {
    "text": "extension load it and then exploit it",
    "start": "1217810",
    "end": "1220420"
  },
  {
    "text": "eventually Apple does blacklist some of",
    "start": "1220420",
    "end": "1222820"
  },
  {
    "text": "these extensions but not for a very long",
    "start": "1222820",
    "end": "1224650"
  },
  {
    "text": "time and this is obviously only if they",
    "start": "1224650",
    "end": "1226150"
  },
  {
    "text": "know about the vulnerability this is",
    "start": "1226150",
    "end": "1227980"
  },
  {
    "text": "interesting because the slingshot apt",
    "start": "1227980",
    "end": "1229810"
  },
  {
    "text": "group did exactly this on Windows 2",
    "start": "1229810",
    "end": "1231820"
  },
  {
    "text": "VIPRE bypass Microsoft's kernel code",
    "start": "1231820",
    "end": "1234670"
  },
  {
    "text": "signing enforcement now I talked about",
    "start": "1234670",
    "end": "1238030"
  },
  {
    "text": "this attack at Def Con 2016 and since",
    "start": "1238030",
    "end": "1240670"
  },
  {
    "text": "then Apple has sought to mitigate this",
    "start": "1240670",
    "end": "1243700"
  },
  {
    "text": "by introducing a security mechanism",
    "start": "1243700",
    "end": "1245800"
  },
  {
    "text": "called user approved kernel extension",
    "start": "1245800",
    "end": "1248650"
  },
  {
    "text": "loading basically apple says ok even if",
    "start": "1248650",
    "end": "1251200"
  },
  {
    "text": "you have a third-party driver that's",
    "start": "1251200",
    "end": "1253120"
  },
  {
    "text": "validly signed if you try to load it",
    "start": "1253120",
    "end": "1255340"
  },
  {
    "text": "even if it's a legitimate driver we are",
    "start": "1255340",
    "end": "1257410"
  },
  {
    "text": "going to block it and prompt the user",
    "start": "1257410",
    "end": "1259350"
  },
  {
    "text": "turns out it was trivial to bypass this",
    "start": "1259350",
    "end": "1261700"
  },
  {
    "text": "via a synthetic click and although Apple",
    "start": "1261700",
    "end": "1263950"
  },
  {
    "text": "patches patch that unfortunately as is",
    "start": "1263950",
    "end": "1266530"
  },
  {
    "text": "the case with many Apple security",
    "start": "1266530",
    "end": "1267790"
  },
  {
    "text": "mechanisms it's still completely trivial",
    "start": "1267790",
    "end": "1269740"
  },
  {
    "text": "to bypass so since the introduction of",
    "start": "1269740",
    "end": "1271630"
  },
  {
    "text": "the security feature it's been",
    "start": "1271630",
    "end": "1272860"
  },
  {
    "text": "completely broken so I'm gonna give a",
    "start": "1272860",
    "end": "1274540"
  },
  {
    "text": "talk at DEFCON on this if you are more",
    "start": "1274540",
    "end": "1276160"
  },
  {
    "text": "interested in that all right so let's",
    "start": "1276160",
    "end": "1279310"
  },
  {
    "text": "wrap this up so today we talked about",
    "start": "1279310",
    "end": "1282220"
  },
  {
    "start": "1280000",
    "end": "1280000"
  },
  {
    "text": "making firewalls basically using a",
    "start": "1282220",
    "end": "1284860"
  },
  {
    "text": "socket filter it's really not too",
    "start": "1284860",
    "end": "1286990"
  },
  {
    "text": "complicated if you're interested more",
    "start": "1286990",
    "end": "1289060"
  },
  {
    "text": "some of the details or the source code",
    "start": "1289060",
    "end": "1291640"
  },
  {
    "text": "check out lulu again it's fully open",
    "start": "1291640",
    "end": "1293230"
  },
  {
    "text": "source lots of comments you can build it",
    "start": "1293230",
    "end": "1294790"
  },
  {
    "text": "compile it poke around and hopefully it",
    "start": "1294790",
    "end": "1296560"
  },
  {
    "text": "gives you a good idea exactly how you",
    "start": "1296560",
    "end": "1298090"
  },
  {
    "text": "would go about building such a firewall",
    "start": "1298090",
    "end": "1300060"
  },
  {
    "text": "we then talk about breaking firewalls",
    "start": "1300060",
    "end": "1302620"
  },
  {
    "text": "turns out yes they have security",
    "start": "1302620",
    "end": "1304150"
  },
  {
    "text": "vulnerabilities and unfortunately they",
    "start": "1304150",
    "end": "1305800"
  },
  {
    "text": "are pretty easy to generically bypass",
    "start": "1305800",
    "end": "1307900"
  },
  {
    "text": "now this doesn't mean all is lost but it",
    "start": "1307900",
    "end": "1310780"
  },
  {
    "text": "certainly makes a good case for",
    "start": "1310780",
    "end": "1312450"
  },
  {
    "text": "defense-in-depth",
    "start": "1312450",
    "end": "1313570"
  },
  {
    "text": "in my opinion you should have some other",
    "start": "1313570",
    "end": "1315310"
  },
  {
    "text": "security tools perhaps that are",
    "start": "1315310",
    "end": "1317290"
  },
  {
    "text": "detecting dial-up injections or perhaps",
    "start": "1317290",
    "end": "1320170"
  },
  {
    "text": "detecting if a browser is executed from",
    "start": "1320170",
    "end": "1322450"
  },
  {
    "text": "the command line more behavioral based",
    "start": "1322450",
    "end": "1324760"
  },
  {
    "text": "activities that might indicate a",
    "start": "1324760",
    "end": "1326650"
  },
  {
    "text": "precursor to an attack now a firewall I",
    "start": "1326650",
    "end": "1329500"
  },
  {
    "text": "don't think should be monitoring all",
    "start": "1329500",
    "end": "1331510"
  },
  {
    "text": "these other behavioral detections but",
    "start": "1331510",
    "end": "1333760"
  },
  {
    "text": "perhaps some other third party utility",
    "start": "1333760",
    "end": "1335710"
  },
  {
    "text": "can",
    "start": "1335710",
    "end": "1337710"
  },
  {
    "text": "also finally I'm stoked to announce that",
    "start": "1337710",
    "end": "1340150"
  },
  {
    "text": "I'm going to be organizing max security",
    "start": "1340150",
    "end": "1342700"
  },
  {
    "text": "conference called objective by the sea",
    "start": "1342700",
    "end": "1344770"
  },
  {
    "text": "it's gonna be this November in Maui we",
    "start": "1344770",
    "end": "1347890"
  },
  {
    "text": "got a great lineup of speakers and if",
    "start": "1347890",
    "end": "1350170"
  },
  {
    "text": "you're a supporter of objective-c which",
    "start": "1350170",
    "end": "1351760"
  },
  {
    "text": "you can be for $1 the conference is",
    "start": "1351760",
    "end": "1353320"
  },
  {
    "text": "actually completely free I can talk a",
    "start": "1353320",
    "end": "1356860"
  },
  {
    "text": "lot about how awesome speakers are",
    "start": "1356860",
    "end": "1358420"
  },
  {
    "text": "they're very awesome but you know come",
    "start": "1358420",
    "end": "1360460"
  },
  {
    "text": "on it's in Hawaii in November so if",
    "start": "1360460",
    "end": "1363340"
  },
  {
    "text": "you're interested check out objective by",
    "start": "1363340",
    "end": "1365110"
  },
  {
    "text": "the sea calm this is the resort it's",
    "start": "1365110",
    "end": "1367510"
  },
  {
    "text": "going to be held and again that's me a",
    "start": "1367510",
    "end": "1368920"
  },
  {
    "text": "lot of great talks about iOS and Mac",
    "start": "1368920",
    "end": "1370870"
  },
  {
    "text": "security alright that's a wrap",
    "start": "1370870",
    "end": "1374410"
  },
  {
    "start": "1373000",
    "end": "1373000"
  },
  {
    "text": "really want to say thank you for",
    "start": "1374410",
    "end": "1376030"
  },
  {
    "text": "attending also want to thank the",
    "start": "1376030",
    "end": "1377440"
  },
  {
    "text": "partners and Friends of objective-c",
    "start": "1377440",
    "end": "1378900"
  },
  {
    "text": "digital security and Malwarebytes and we",
    "start": "1378900",
    "end": "1382420"
  },
  {
    "text": "have about two minutes for questions and",
    "start": "1382420",
    "end": "1384490"
  },
  {
    "text": "also be around after the talk if there's",
    "start": "1384490",
    "end": "1386650"
  },
  {
    "text": "some more questions you'd like to",
    "start": "1386650",
    "end": "1388120"
  },
  {
    "text": "discuss",
    "start": "1388120",
    "end": "1390420"
  },
  {
    "text": "yeah great question so is in the Mojave",
    "start": "1403580",
    "end": "1406380"
  },
  {
    "text": "bet betas that are coming out how has",
    "start": "1406380",
    "end": "1408000"
  },
  {
    "text": "Apple basically implemented any security",
    "start": "1408000",
    "end": "1410220"
  },
  {
    "text": "features that may impact this and that's",
    "start": "1410220",
    "end": "1411810"
  },
  {
    "text": "a great question because they've",
    "start": "1411810",
    "end": "1413310"
  },
  {
    "text": "actually limited what certain",
    "start": "1413310",
    "end": "1414720"
  },
  {
    "text": "applications can do so for example you",
    "start": "1414720",
    "end": "1416910"
  },
  {
    "text": "can now no longer use Apple Script to",
    "start": "1416910",
    "end": "1418890"
  },
  {
    "text": "talk to another application so you can't",
    "start": "1418890",
    "end": "1421650"
  },
  {
    "text": "for example drive Safari via Apple",
    "start": "1421650",
    "end": "1423720"
  },
  {
    "text": "script unfortunately you can still do",
    "start": "1423720",
    "end": "1425970"
  },
  {
    "text": "things like various die live attacks or",
    "start": "1425970",
    "end": "1427890"
  },
  {
    "text": "execute Safari from the command line so",
    "start": "1427890",
    "end": "1430230"
  },
  {
    "text": "there's still multiple waves but they",
    "start": "1430230",
    "end": "1432150"
  },
  {
    "text": "are kind of blocking some of these",
    "start": "1432150",
    "end": "1434010"
  },
  {
    "text": "attack vectors some of the precursors to",
    "start": "1434010",
    "end": "1436680"
  },
  {
    "text": "the attacks so you know I think I would",
    "start": "1436680",
    "end": "1439020"
  },
  {
    "text": "definitely install it when it comes out",
    "start": "1439020",
    "end": "1440340"
  },
  {
    "text": "because it it does increase the bar in",
    "start": "1440340",
    "end": "1442050"
  },
  {
    "text": "terms of security so that's a good thing",
    "start": "1442050",
    "end": "1444650"
  },
  {
    "text": "any other questions I'm guessing this",
    "start": "1444650",
    "end": "1452160"
  },
  {
    "text": "applies to the built-in firewall as well",
    "start": "1452160",
    "end": "1454770"
  },
  {
    "text": "Oh excellent question so the built-in",
    "start": "1454770",
    "end": "1456990"
  },
  {
    "text": "firewall is is great but the problem is",
    "start": "1456990",
    "end": "1459330"
  },
  {
    "text": "it only monitors incoming connections so",
    "start": "1459330",
    "end": "1462480"
  },
  {
    "text": "any activity for example any malware",
    "start": "1462480",
    "end": "1464280"
  },
  {
    "text": "that gets on your system that tries to",
    "start": "1464280",
    "end": "1465810"
  },
  {
    "text": "connect out to a command control server",
    "start": "1465810",
    "end": "1467520"
  },
  {
    "text": "or exfiltrate data the built-in firewall",
    "start": "1467520",
    "end": "1470220"
  },
  {
    "text": "is not even looking at this traffic and",
    "start": "1470220",
    "end": "1472950"
  },
  {
    "text": "the majority of attacks affecting both",
    "start": "1472950",
    "end": "1475170"
  },
  {
    "text": "the enterprise and end-user and Mac",
    "start": "1475170",
    "end": "1477270"
  },
  {
    "text": "users that is going to be kind of that",
    "start": "1477270",
    "end": "1479490"
  },
  {
    "text": "behavior that the malware is going to",
    "start": "1479490",
    "end": "1481260"
  },
  {
    "text": "come in maybe via an email the users",
    "start": "1481260",
    "end": "1482910"
  },
  {
    "text": "going to be tricked into downloading and",
    "start": "1482910",
    "end": "1484470"
  },
  {
    "text": "running something so the first network",
    "start": "1484470",
    "end": "1486210"
  },
  {
    "text": "traffic that's actually going to be",
    "start": "1486210",
    "end": "1487470"
  },
  {
    "text": "generated is this outgoing traffic so",
    "start": "1487470",
    "end": "1489720"
  },
  {
    "text": "it's good to turn on the built-in",
    "start": "1489720",
    "end": "1490890"
  },
  {
    "text": "firewall but it really doesn't buy you",
    "start": "1490890",
    "end": "1492300"
  },
  {
    "text": "that much in my opinion and I think",
    "start": "1492300",
    "end": "1494100"
  },
  {
    "text": "Apple did this because they don't want",
    "start": "1494100",
    "end": "1495510"
  },
  {
    "text": "to annoy the average Mac user with",
    "start": "1495510",
    "end": "1497460"
  },
  {
    "text": "pop-ups when for example the browser",
    "start": "1497460",
    "end": "1499740"
  },
  {
    "text": "they installed tries to connect to the",
    "start": "1499740",
    "end": "1500970"
  },
  {
    "text": "internet because you know that would be",
    "start": "1500970",
    "end": "1502470"
  },
  {
    "text": "confusing to at least a handful of Mac",
    "start": "1502470",
    "end": "1504150"
  },
  {
    "text": "users and Apple usually airs on the side",
    "start": "1504150",
    "end": "1506040"
  },
  {
    "text": "of usability versus security awesome all",
    "start": "1506040",
    "end": "1511380"
  },
  {
    "text": "right we are out of time I will be here",
    "start": "1511380",
    "end": "1512850"
  },
  {
    "text": "for a few more questions again",
    "start": "1512850",
    "end": "1514170"
  },
  {
    "text": "Mahalo so much for attending my talk and",
    "start": "1514170",
    "end": "1516330"
  },
  {
    "text": "I hope to see you all in Hawaii this",
    "start": "1516330",
    "end": "1518280"
  },
  {
    "text": "November",
    "start": "1518280",
    "end": "1520640"
  }
]