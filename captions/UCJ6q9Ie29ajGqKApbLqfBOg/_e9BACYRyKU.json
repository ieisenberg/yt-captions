[
  {
    "start": "0",
    "end": "60000"
  },
  {
    "text": "[Music]",
    "start": "1130",
    "end": "14559"
  },
  {
    "text": "hey everyone today we present to you our research on a new dns vulnerability",
    "start": "14559",
    "end": "20160"
  },
  {
    "text": "class in dns service providers my name is shill and i lead the research team with the cloud security company",
    "start": "20160",
    "end": "26640"
  },
  {
    "text": "with me on the stage is ami the city of wisdom thank you it's really great to be here",
    "start": "26640",
    "end": "33120"
  },
  {
    "text": "just a bit background on the team and so we are in the wii research team a highly",
    "start": "33120",
    "end": "39440"
  },
  {
    "text": "experienced team of researchers many of us background from microsoft cloud security",
    "start": "39440",
    "end": "45760"
  },
  {
    "text": "and the goal of the team is to do groundbreaking cloud research and find vulnerabilities and risks and attack",
    "start": "45760",
    "end": "53039"
  },
  {
    "text": "paths that are unknown today that may affect cloud environments",
    "start": "53039",
    "end": "59600"
  },
  {
    "text": "so how do we get to a research on dns let's start from the beginning why dns",
    "start": "59600",
    "end": "66560"
  },
  {
    "start": "60000",
    "end": "184000"
  },
  {
    "text": "as a service so in fact dns as a service is one of the most important",
    "start": "66560",
    "end": "72400"
  },
  {
    "text": "and critical services that cloud providers give today to customers and",
    "start": "72400",
    "end": "77439"
  },
  {
    "text": "why is that dns first of all is the lifeblood of the internet but not only",
    "start": "77439",
    "end": "82880"
  },
  {
    "text": "for the internet the internal dns is the is the service that powers all of the",
    "start": "82880",
    "end": "88159"
  },
  {
    "text": "routing between endpoints between internal services within the company so dns is a critical service that companies",
    "start": "88159",
    "end": "95600"
  },
  {
    "text": "use and now companies are transitioning to use dns as a service",
    "start": "95600",
    "end": "100640"
  },
  {
    "text": "now it's not only that it's really impactful if i would be able to do something with dns the the the impact",
    "start": "100640",
    "end": "107840"
  },
  {
    "text": "could be huge because it affects not only the cloud resources the company has it's also affects",
    "start": "107840",
    "end": "114640"
  },
  {
    "text": "on-premise resources the company has first of all the domain the company domain is a company asset and the",
    "start": "114640",
    "end": "120960"
  },
  {
    "text": "endpoints of the company are using dns as well so if you think about it the effect of this",
    "start": "120960",
    "end": "127280"
  },
  {
    "text": "cloud service goes well above and beyond the actual resources that the company has in",
    "start": "127280",
    "end": "133360"
  },
  {
    "text": "the cloud and third and maybe most important for researchers",
    "start": "133360",
    "end": "139040"
  },
  {
    "text": "is that dns is highly complex it's a very ancient protocol it's with",
    "start": "139040",
    "end": "144800"
  },
  {
    "text": "us since the 1980s it has so many different implementations not only by",
    "start": "144800",
    "end": "150000"
  },
  {
    "text": "the providers but also to so many different dns clients and these dns clients can implement the dns and",
    "start": "150000",
    "end": "157760"
  },
  {
    "text": "algorithm in different ways more than that dns is not only routing on the internet",
    "start": "157760",
    "end": "163760"
  },
  {
    "text": "there's so many different protocols and algorithms used for dynamic dns and for",
    "start": "163760",
    "end": "169440"
  },
  {
    "text": "authentication over dns and those algorithms many of them were developed 10 or 20 or even 30 years ago so this",
    "start": "169440",
    "end": "177120"
  },
  {
    "text": "gives amazing attack surface for us to explore so we started looking into the",
    "start": "177120",
    "end": "182640"
  },
  {
    "text": "nss service and as cloud researchers obviously we started",
    "start": "182640",
    "end": "187920"
  },
  {
    "start": "184000",
    "end": "276000"
  },
  {
    "text": "from route 53 which is probably the one of the most popular dns services",
    "start": "187920",
    "end": "195040"
  },
  {
    "text": "provided by cloud providers and initially we looked at",
    "start": "195040",
    "end": "200319"
  },
  {
    "text": "misconfigurations that users can do within the platform for example if a user registers a domain to a cloud",
    "start": "200319",
    "end": "207120"
  },
  {
    "text": "object like a load balancer and the load also doesn't exist anymore so these kind of misconfigurations but as we started",
    "start": "207120",
    "end": "212799"
  },
  {
    "text": "learning more and more about route 53 we thought maybe we can actually find vulnerabilities in the way that the",
    "start": "212799",
    "end": "220080"
  },
  {
    "text": "service actually provides dns to customers and that's how we started the research into the vulnerabilities in",
    "start": "220080",
    "end": "226879"
  },
  {
    "text": "route 53 so um in the beginning",
    "start": "226879",
    "end": "233120"
  },
  {
    "text": "we thought about domain hijacking domain hijacking sounds scary if a malicious actor managed to hijack a",
    "start": "233120",
    "end": "240480"
  },
  {
    "text": "domain the effect can be massive and we thought it might be possible so",
    "start": "240480",
    "end": "245599"
  },
  {
    "text": "amazon has around 2 000 shared dns servers serving thousands of customers",
    "start": "245599",
    "end": "252080"
  },
  {
    "text": "it's basically the idea of dns as a service sharing dns servers with multiple customers so many customers are",
    "start": "252080",
    "end": "257519"
  },
  {
    "text": "managing their domains within the same server whenever customer is registering a domain on the platform they get full",
    "start": "257519",
    "end": "263919"
  },
  {
    "text": "shared name servers these are the servers that now manage the dns zone of that domain",
    "start": "263919",
    "end": "269520"
  },
  {
    "text": "our initial target was hijacking our own domain wiz.io",
    "start": "269520",
    "end": "276680"
  },
  {
    "start": "276000",
    "end": "320000"
  },
  {
    "text": "before we before going into details first brief",
    "start": "277440",
    "end": "282720"
  },
  {
    "text": "overview of how dns works each domain must have a dns server",
    "start": "282720",
    "end": "287840"
  },
  {
    "text": "called name server that will store its records many companies manage the name servers",
    "start": "287840",
    "end": "292880"
  },
  {
    "text": "themselves and many other companies use existing services like dns service providers in our case at quiz our domain",
    "start": "292880",
    "end": "300400"
  },
  {
    "text": "is hosted on amazon raw 53 and is managed on four name servers you see in the right of the slide",
    "start": "300400",
    "end": "307840"
  },
  {
    "text": "when a customer wants to connect to with server they query one of these servers",
    "start": "307840",
    "end": "313280"
  },
  {
    "text": "for the wiz.io domain so far so good",
    "start": "313280",
    "end": "319840"
  },
  {
    "start": "320000",
    "end": "366000"
  },
  {
    "text": "the thing about r53 is that all customers are using the same name servers and each client can manage",
    "start": "322639",
    "end": "328720"
  },
  {
    "text": "their domain on any server on the platform we can see in the slide that the amazon name server the",
    "start": "328720",
    "end": "336840"
  },
  {
    "text": "ns1334 which managed with domains it also contains domains of other customers",
    "start": "336840",
    "end": "343039"
  },
  {
    "text": "as you see in the right column and here we had an idea what would happen if we if we will",
    "start": "343039",
    "end": "350000"
  },
  {
    "text": "manage to add duplicate entry of wiz.io into the same server",
    "start": "350000",
    "end": "356319"
  },
  {
    "text": "this should be impossible but if we succeed might cause a conflict with the insane outcomes",
    "start": "356319",
    "end": "364759"
  },
  {
    "start": "366000",
    "end": "418000"
  },
  {
    "text": "um so we tried to host the with io on route 53 and to our surprise",
    "start": "367440",
    "end": "373120"
  },
  {
    "text": "it is possible anyone can register which domain they want on the platform",
    "start": "373120",
    "end": "378400"
  },
  {
    "text": "there is no restriction on whether the domain is already registered and there is no ownership verification",
    "start": "378400",
    "end": "384560"
  },
  {
    "text": "but as you can see in the slide we got four name servers other than those",
    "start": "384560",
    "end": "390400"
  },
  {
    "text": "yeah um other than the original with the name server",
    "start": "390400",
    "end": "396639"
  },
  {
    "text": "and we tried to add it again and again and again",
    "start": "396639",
    "end": "402800"
  },
  {
    "text": "and each time we got a different name server but we never got the same servers to reach the original wizard points",
    "start": "402800",
    "end": "409919"
  },
  {
    "text": "we try to register subdomains of with io and even paired the domain with special characters all without success",
    "start": "409919",
    "end": "417759"
  },
  {
    "text": "so after we failed to hijack the domain we try to think about the problem from a new angle",
    "start": "419759",
    "end": "425280"
  },
  {
    "text": "which domain can we possibly register in the platform that one",
    "start": "425280",
    "end": "431199"
  },
  {
    "text": "it does not exist in the name servers because if it is will not be able to register it on the same name servers",
    "start": "431199",
    "end": "438319"
  },
  {
    "text": "and two dns clients must query for it because if the domain is not queried it has no",
    "start": "438319",
    "end": "443759"
  },
  {
    "text": "effect so we thought about it and then we came",
    "start": "443759",
    "end": "449440"
  },
  {
    "text": "up with an idea what would happen if we register one of the official aws name servers on the",
    "start": "449440",
    "end": "455599"
  },
  {
    "text": "platform what would happen if we register one of the route 53 name servers under the same",
    "start": "455599",
    "end": "460960"
  },
  {
    "text": "name server um so we chose an arbitrary name server in this case is the",
    "start": "460960",
    "end": "467440"
  },
  {
    "text": "router 53 name server ns852 and we try to register it on the",
    "start": "467440",
    "end": "472560"
  },
  {
    "text": "platform enough times that at least once it would fall under the management of the same name server",
    "start": "472560",
    "end": "478560"
  },
  {
    "text": "let's do an illustration here you can see an illustration of auda",
    "start": "478560",
    "end": "484599"
  },
  {
    "start": "480000",
    "end": "515000"
  },
  {
    "text": "ns5e852 name server and official route 5397 looks like you can see it contains dns zones for",
    "start": "484599",
    "end": "492319"
  },
  {
    "text": "several of route 53 customers what do we um what do you what do you",
    "start": "492319",
    "end": "498160"
  },
  {
    "text": "think would happen if we managed to register the name server domain name the nsa 852",
    "start": "498160",
    "end": "505440"
  },
  {
    "text": "under its own management i totally don't know what would happen",
    "start": "505440",
    "end": "510960"
  },
  {
    "text": "but we must check it out so we tried it and it worked",
    "start": "510960",
    "end": "517200"
  },
  {
    "start": "515000",
    "end": "566000"
  },
  {
    "text": "as you can see in the slide our new domain is now managed within a name server with the same domain name",
    "start": "517200",
    "end": "523440"
  },
  {
    "text": "we were really excited we didn't know if it will have any impact but we had a",
    "start": "523440",
    "end": "528640"
  },
  {
    "text": "good feeling about this one to test the effect of what we did we decided to specify an angular code",
    "start": "528640",
    "end": "534640"
  },
  {
    "text": "pointing to our server so now if anyone is trying to talk to us",
    "start": "534640",
    "end": "541040"
  },
  {
    "text": "we would able to listen we ran tcp dump on our server and hope to see something interesting",
    "start": "541040",
    "end": "549680"
  },
  {
    "text": "surprisingly we started receiving thousands of requests from thousands of different ips we realized we were onto",
    "start": "549680",
    "end": "555920"
  },
  {
    "text": "something the next step in the research was to analyze all these dns queries and",
    "start": "555920",
    "end": "561600"
  },
  {
    "text": "figure out why are they coming to us",
    "start": "561600",
    "end": "567040"
  },
  {
    "start": "566000",
    "end": "735000"
  },
  {
    "text": "but wait why are we getting any traffic i mean think about it just",
    "start": "568000",
    "end": "574480"
  },
  {
    "text": "like we did with the with io if you register a domain on the wrong name server you're",
    "start": "574480",
    "end": "580320"
  },
  {
    "text": "not supposed to get any traffic we registered the name server on itself we didn't expect to get any traffic what's",
    "start": "580320",
    "end": "587600"
  },
  {
    "text": "going on so what we did initially is",
    "start": "587600",
    "end": "592640"
  },
  {
    "text": "just initial analysis trying to understand what kind of dns requests were seen and that became even more",
    "start": "592640",
    "end": "598240"
  },
  {
    "text": "weird because this was not just general dns traffic we were seeing dynamic dns",
    "start": "598240",
    "end": "604000"
  },
  {
    "text": "dynamic dns is traffic that you wouldn't expect to see at all in external",
    "start": "604000",
    "end": "609200"
  },
  {
    "text": "networks we were seeing ip addresses computer names domain names so let's see",
    "start": "609200",
    "end": "614880"
  },
  {
    "text": "how this look like so this is an example of a packet one of millions of packets we were seeing so we're seeing the",
    "start": "614880",
    "end": "621839"
  },
  {
    "text": "external ip of a computer an internet ip of a computer and a",
    "start": "621839",
    "end": "626959"
  },
  {
    "text": "computer name it really quickly became apparent that we are seeing millions of endpoints coming",
    "start": "626959",
    "end": "633519"
  },
  {
    "text": "from different organizations we had no clue at that point why are we seeing that what does it mean but there was",
    "start": "633519",
    "end": "640240"
  },
  {
    "text": "clearly something bigger going on and we definitely wanted to understand what what's behind this so",
    "start": "640240",
    "end": "647839"
  },
  {
    "text": "we actually dug deeper what we did is we registered not only one name server we",
    "start": "648079",
    "end": "654240"
  },
  {
    "text": "registered all 2000 name servers in aws and tried to figure out what are we actually seeing and we",
    "start": "654240",
    "end": "660640"
  },
  {
    "text": "started tapping into a portion of the worldwide dns traffic going to organizations the the we were seeing",
    "start": "660640",
    "end": "668000"
  },
  {
    "text": "more than a million endpoints coming from more than 15 000 organizations all of them using a route",
    "start": "668000",
    "end": "675360"
  },
  {
    "text": "53 as their dns service so it's huge amounts of data",
    "start": "675360",
    "end": "680800"
  },
  {
    "text": "coming from millions of endpoints but what's going on and when we dug deeper",
    "start": "680800",
    "end": "685839"
  },
  {
    "text": "we saw that there's it's coming from big companies fortune 500 companies more",
    "start": "685839",
    "end": "691839"
  },
  {
    "text": "than 100 government agencies so this is not just",
    "start": "691839",
    "end": "696880"
  },
  {
    "text": "a limited feed we're getting this is also high value targets that we're seeing so we",
    "start": "696880",
    "end": "703360"
  },
  {
    "text": "really need to figure out what's going on so let's just summarize what we know so",
    "start": "703360",
    "end": "709519"
  },
  {
    "text": "far we registered a domain name server to itself we didn't expect anything to",
    "start": "709519",
    "end": "715040"
  },
  {
    "text": "happen but what did happen is that we got millions of endpoints sending",
    "start": "715040",
    "end": "720959"
  },
  {
    "text": "dynamics dns traffic queries to us so what's going on the next step",
    "start": "720959",
    "end": "728399"
  },
  {
    "text": "is to dive deeper dive deeper into the world of dynamic dns",
    "start": "728399",
    "end": "734800"
  },
  {
    "start": "735000",
    "end": "760000"
  },
  {
    "text": "so what exactly is dynamic dns dynamic dns",
    "start": "736639",
    "end": "742480"
  },
  {
    "text": "is a dns extension specified in rfc 2136 and it allows clients to dynamically",
    "start": "742480",
    "end": "748639"
  },
  {
    "text": "update dns records of target dns server it is a commonly used 12 devices find",
    "start": "748639",
    "end": "755760"
  },
  {
    "text": "each other in internal windows networks let's see how it works",
    "start": "755760",
    "end": "761680"
  },
  {
    "text": "when my windows computer join the company's network and receive a new ip address",
    "start": "761680",
    "end": "766720"
  },
  {
    "text": "it updates the local dns server which is called master server on its new ip address",
    "start": "766720",
    "end": "772880"
  },
  {
    "text": "now when ami is trying to connect to my computer he can query the local dns server about chill pc",
    "start": "772880",
    "end": "780720"
  },
  {
    "text": "and the master server will answer with my correct with my current ipad ip address",
    "start": "780720",
    "end": "787600"
  },
  {
    "text": "so far so good but wait why endpoints send dns updates to our",
    "start": "787600",
    "end": "793760"
  },
  {
    "text": "server these are requests that should never leave the internal network",
    "start": "793760",
    "end": "799040"
  },
  {
    "text": "could it visit the endpoint sync of our server as their master server how do they even know how to find the",
    "start": "799040",
    "end": "805279"
  },
  {
    "text": "master server so it turns out that microsoft has its",
    "start": "805279",
    "end": "810720"
  },
  {
    "start": "807000",
    "end": "1024000"
  },
  {
    "text": "own algorithm for finding the master server it does not work exactly as specified in the rfc",
    "start": "810720",
    "end": "816560"
  },
  {
    "text": "so let's dive into the algorithm when a windows endpoint want to update",
    "start": "816560",
    "end": "822880"
  },
  {
    "text": "the internal master server for its new ip address it first needs to find it the endpoint will send a soa",
    "start": "822880",
    "end": "829920"
  },
  {
    "text": "query to the internal dns resolver on its own domain name the internal dns resolver knows",
    "start": "829920",
    "end": "838240"
  },
  {
    "text": "that the with io dns done is managed internally so when queried it will return the",
    "start": "838240",
    "end": "843600"
  },
  {
    "text": "internal master server within the server response so as you can see in the example um on",
    "start": "843600",
    "end": "850720"
  },
  {
    "text": "the slide the dns resolver returned the internal dns within the network",
    "start": "850720",
    "end": "857360"
  },
  {
    "text": "now when the endpoint found the master server it will update it as we saw in the previous illustration",
    "start": "857360",
    "end": "864720"
  },
  {
    "text": "and the update succeed so far so good but what happens if the",
    "start": "864720",
    "end": "871519"
  },
  {
    "text": "corporate dns resolver is not set correctly and does not contain a dns zone for the local domain",
    "start": "871519",
    "end": "877680"
  },
  {
    "text": "or what will happen if the computer is configured to work with external dns resolver which is unfamiliar with the",
    "start": "877680",
    "end": "883199"
  },
  {
    "text": "internal resources inside the network what happens when the computer leaves the organization and start working from",
    "start": "883199",
    "end": "889360"
  },
  {
    "text": "external dns resolvers provided by home routers in that cases when a computer query for",
    "start": "889360",
    "end": "894800"
  },
  {
    "text": "the copyright domain the dns observer will treat it as an external domain and return the master server",
    "start": "894800",
    "end": "901360"
  },
  {
    "text": "of the external domain just as it will do with any other domain name which is where the problem starts",
    "start": "901360",
    "end": "909600"
  },
  {
    "text": "so imagine an employee of with io decided to work from home like most of",
    "start": "910320",
    "end": "915600"
  },
  {
    "text": "us lately and connected to their home wifi the computer got an internal ip address",
    "start": "915600",
    "end": "922320"
  },
  {
    "text": "from the home router and now trying to find the local master server because the external dns resolver you're not",
    "start": "922320",
    "end": "928079"
  },
  {
    "text": "familiar with with io is going to resolve it just like any other domain because the domain is managed on route",
    "start": "928079",
    "end": "933839"
  },
  {
    "text": "53 it will return the wiz io master server as specified in route 53.",
    "start": "933839",
    "end": "940240"
  },
  {
    "text": "this is the primary server this is the master server that was specified in the soa",
    "start": "940240",
    "end": "946320"
  },
  {
    "text": "record within route 53 and this is the default record",
    "start": "946320",
    "end": "952160"
  },
  {
    "text": "the endpoint will then try to update the master server which is an amazon shared server that manages thousands of",
    "start": "952160",
    "end": "958560"
  },
  {
    "text": "customers um obviously amazon server does not support dynamic dns so the",
    "start": "958560",
    "end": "965759"
  },
  {
    "text": "update request will fail microsoft algorithm",
    "start": "965759",
    "end": "970880"
  },
  {
    "text": "does not give up here and believes it's still having a chance to find the master server the next step",
    "start": "970880",
    "end": "976000"
  },
  {
    "text": "will be to check if with io name servers have records of that that's the same master server",
    "start": "976000",
    "end": "982399"
  },
  {
    "text": "so the dns client connects directly to the ip address of the name servers and ask",
    "start": "982399",
    "end": "988720"
  },
  {
    "text": "them what is the ip address of the master server in our case it is the same domain as the",
    "start": "988720",
    "end": "994720"
  },
  {
    "text": "name server and here happens the interesting part",
    "start": "994720",
    "end": "1000320"
  },
  {
    "text": "in fact windows dns client queries the name server for itself and if you remember we've registered this dns zone",
    "start": "1000320",
    "end": "1007440"
  },
  {
    "text": "and here we can return any records we want so we returned our ip to the dns client",
    "start": "1007440",
    "end": "1015440"
  },
  {
    "text": "as you can see in the slide and now the computer will update our server with",
    "start": "1015440",
    "end": "1020560"
  },
  {
    "text": "dns updates this is crazy",
    "start": "1020560",
    "end": "1025559"
  },
  {
    "start": "1024000",
    "end": "1085000"
  },
  {
    "text": "so wha what did we learn so far so now we can start understanding why we",
    "start": "1026000",
    "end": "1033280"
  },
  {
    "text": "are getting so much traffic windows endpoints have a custom algorithm in order to actually implement dynamic dns",
    "start": "1033280",
    "end": "1040480"
  },
  {
    "text": "to find the master dns server and this algorithm is part of the algorithm",
    "start": "1040480",
    "end": "1046000"
  },
  {
    "text": "actually queries at some point the name server for its own name again this algorithm is geared towards",
    "start": "1046000",
    "end": "1053039"
  },
  {
    "text": "internal networks but when used on external dns providers then unexpected results occur and the unexpected result",
    "start": "1053039",
    "end": "1060559"
  },
  {
    "text": "is that when we put our malicious dna server it was actually getting traffic from the dynamic dns traffic from",
    "start": "1060559",
    "end": "1067840"
  },
  {
    "text": "millions of endpoints and so now we can start understanding the initial question",
    "start": "1067840",
    "end": "1073360"
  },
  {
    "text": "of why are we getting so much traffic so now the next question is is this traffic really interesting what",
    "start": "1073360",
    "end": "1079679"
  },
  {
    "text": "do we have in these millions of devices actually sending traffic to us",
    "start": "1079679",
    "end": "1085840"
  },
  {
    "start": "1085000",
    "end": "1147000"
  },
  {
    "text": "so as we started analyzing the traffic it soon became apparent what we've created",
    "start": "1085840",
    "end": "1093039"
  },
  {
    "text": "in a simple domain registration is a nation-state intelligence",
    "start": "1093039",
    "end": "1098160"
  },
  {
    "text": "capability we are able to actually map thousands and in in dozens of thousands",
    "start": "1098160",
    "end": "1105600"
  },
  {
    "text": "of organizations across millions of endpoints let's think about it if i have an",
    "start": "1105600",
    "end": "1111039"
  },
  {
    "text": "organization i can map the external ips what does that mean i can map office",
    "start": "1111039",
    "end": "1116160"
  },
  {
    "text": "locations home locations of the entire organization multiply that on tens of",
    "start": "1116160",
    "end": "1122080"
  },
  {
    "text": "thousands of organizations i can see internal ips that means i can start building internal ip ranges i can",
    "start": "1122080",
    "end": "1129440"
  },
  {
    "text": "see computer names that means that i can understand what the organization is doing i can understand and map their",
    "start": "1129440",
    "end": "1135039"
  },
  {
    "text": "internet network this is a full intelligence map on my hands from for",
    "start": "1135039",
    "end": "1141039"
  },
  {
    "text": "thousands of companies and and even government agencies let's see how it looks like",
    "start": "1141039",
    "end": "1147679"
  },
  {
    "start": "1147000",
    "end": "1192000"
  },
  {
    "text": "so let's start from what we call ib based intelligence we can map a company",
    "start": "1147679",
    "end": "1154799"
  },
  {
    "text": "and this is by the way one of the top services companies in the world we can map the entire company here you see more",
    "start": "1154799",
    "end": "1160799"
  },
  {
    "text": "than 40 000 endpoints that are actually spread around the world we can see all of their office branches we can see",
    "start": "1160799",
    "end": "1167120"
  },
  {
    "text": "their home locations all of their employees we can actually map them now imagine that for",
    "start": "1167120",
    "end": "1172960"
  },
  {
    "text": "government agencies for different companies right i can even zoom in on specific office locations here from this",
    "start": "1172960",
    "end": "1179760"
  },
  {
    "text": "office we saw 600 endpoints reporting to us so we have amazing intelligence on",
    "start": "1179760",
    "end": "1187200"
  },
  {
    "text": "thousands of companies but it doesn't stop there because we also have",
    "start": "1187200",
    "end": "1193039"
  },
  {
    "text": "the ability to leverage those kind of intelligence to actually ask interesting",
    "start": "1193039",
    "end": "1198559"
  },
  {
    "text": "questions like and these are just a few examples that we found there is the foreign assets control a",
    "start": "1198559",
    "end": "1205360"
  },
  {
    "text": "regulation that says that some companies are not supposed to work from some countries so that would be interesting",
    "start": "1205360",
    "end": "1211360"
  },
  {
    "text": "to find for example the specific western mining company has offices in the ivory",
    "start": "1211360",
    "end": "1217760"
  },
  {
    "text": "coast which is forbidden and again we see that simply from the data or another",
    "start": "1217760",
    "end": "1224159"
  },
  {
    "text": "interesting example a credit company has a subsidiary in iran and we can see",
    "start": "1224159",
    "end": "1231440"
  },
  {
    "text": "that there is a few locations here 13 endpoints we detected in iran",
    "start": "1231440",
    "end": "1237039"
  },
  {
    "text": "so just to understand the extent of this data this is really an intelligence capability we can see we're tapping into",
    "start": "1237039",
    "end": "1245039"
  },
  {
    "text": "dns traffic from so many organizations that it giving us a lot of visibility",
    "start": "1245039",
    "end": "1250080"
  },
  {
    "text": "into what's going on now this was external let's go deeper we are",
    "start": "1250080",
    "end": "1255679"
  },
  {
    "text": "actually seeing ip ranges we were able to map different ip ranges and the",
    "start": "1255679",
    "end": "1260720"
  },
  {
    "text": "actual network mapping of those organizations we can see for example this is the employee network this is the",
    "start": "1260720",
    "end": "1266799"
  },
  {
    "text": "cicd network this is the operational network now how do we know that we because we see the computer as ips we",
    "start": "1266799",
    "end": "1272880"
  },
  {
    "text": "see their names so if you combine them you can start understanding the actual role of each ip",
    "start": "1272880",
    "end": "1279760"
  },
  {
    "text": "range in the company so we are mapping external externally those organizations",
    "start": "1279760",
    "end": "1284880"
  },
  {
    "text": "and we are starting to build internal mapping but it doesn't stop there",
    "start": "1284880",
    "end": "1291360"
  },
  {
    "start": "1290000",
    "end": "1322000"
  },
  {
    "text": "we're also looking at computer names so the computer names also reveal information about the organizations like",
    "start": "1291360",
    "end": "1298880"
  },
  {
    "text": "this is a machine running windows i can see a build this machine is from finance right so",
    "start": "1298880",
    "end": "1305520"
  },
  {
    "text": "computer names help us build the intelligence map on the organizations that we're looking at",
    "start": "1305520",
    "end": "1311120"
  },
  {
    "text": "so we have thousands of companies we have the ability to map them",
    "start": "1311120",
    "end": "1316240"
  },
  {
    "text": "externally and internally is that all so it appears that we can even continue",
    "start": "1316240",
    "end": "1322640"
  },
  {
    "start": "1322000",
    "end": "1404000"
  },
  {
    "text": "we saw a lot of traffic coming up from mpv6 and that intrigued us there is a known",
    "start": "1322640",
    "end": "1329280"
  },
  {
    "text": "argument around the world about the security of ipv6 ipv6 doesn't",
    "start": "1329280",
    "end": "1334400"
  },
  {
    "text": "use not so there is a a possibility if i see a ipv6 address to actually access",
    "start": "1334400",
    "end": "1339919"
  },
  {
    "text": "the device directly so we tried it out we actually saw the six percent of the",
    "start": "1339919",
    "end": "1345440"
  },
  {
    "text": "ipv6 addresses that we were seeing and remember these are endpoints of companies",
    "start": "1345440",
    "end": "1351120"
  },
  {
    "text": "these are organizational endpoints six percent of them and maybe six",
    "start": "1351120",
    "end": "1356720"
  },
  {
    "text": "percent doesn't sound like a lot but six percent is actually thousands of companies that we are seeing endpoints",
    "start": "1356720",
    "end": "1363280"
  },
  {
    "text": "that we can actually directly access from the internet and have open protocols like smb rdp this is crazy",
    "start": "1363280",
    "end": "1370240"
  },
  {
    "text": "this is like actually allowing us to even start an attack using those addresses so i i know that there's",
    "start": "1370240",
    "end": "1377600"
  },
  {
    "text": "a big debate about ibv6 but what we are seeing here is very interesting data if i have a way like we have here to tap",
    "start": "1377600",
    "end": "1384400"
  },
  {
    "text": "into ipv6 addresses the argument that says an attacker would never be able to scan the ipv6 address range this",
    "start": "1384400",
    "end": "1391840"
  },
  {
    "text": "argument fails because using an example like tapping into dns allows us to see",
    "start": "1391840",
    "end": "1397360"
  },
  {
    "text": "millions of ips and basically potentially start attacking those devices",
    "start": "1397360",
    "end": "1402720"
  },
  {
    "text": "so just to to understand what we've seen here there we are able to build very",
    "start": "1402720",
    "end": "1409760"
  },
  {
    "start": "1404000",
    "end": "1458000"
  },
  {
    "text": "powerful capability now the scope is much much bigger than we initially thought we started from route 53",
    "start": "1409760",
    "end": "1416640"
  },
  {
    "text": "but then we continued on the research and we saw that additional service providers are susceptible to this",
    "start": "1416640",
    "end": "1423360"
  },
  {
    "text": "vulnerability and we believe that many many more are vulnerable they we are currently in this closure",
    "start": "1423360",
    "end": "1430080"
  },
  {
    "text": "process with several of them but this means the scorpio can be much more than just dns service providers it can be",
    "start": "1430080",
    "end": "1436159"
  },
  {
    "text": "domain registrars it can be shared hosting basically anyone that is providing dna services might be",
    "start": "1436159",
    "end": "1441760"
  },
  {
    "text": "susceptible to this attack and all could be vulnerable to this kind of name server hijacking so think about it if we",
    "start": "1441760",
    "end": "1448559"
  },
  {
    "text": "would have extended the attack what would be the scope and the number of endpoints that we could put into our in",
    "start": "1448559",
    "end": "1454640"
  },
  {
    "text": "new intelligence capability so",
    "start": "1454640",
    "end": "1460000"
  },
  {
    "start": "1458000",
    "end": "1481000"
  },
  {
    "text": "in terms of the timeline disclosure we worked with amazon ws and they acted",
    "start": "1460000",
    "end": "1465520"
  },
  {
    "text": "really quickly once we reported their vulnerability it was fixed so it was fixed by",
    "start": "1465520",
    "end": "1471279"
  },
  {
    "text": "february this year and there's two more club providers that are currently in a",
    "start": "1471279",
    "end": "1476320"
  },
  {
    "text": "disclosure process now how did they fix the vulnerability",
    "start": "1476320",
    "end": "1481840"
  },
  {
    "start": "1481000",
    "end": "1523000"
  },
  {
    "text": "so it's honestly pretty simple all they have to do is basically block the",
    "start": "1482000",
    "end": "1487279"
  },
  {
    "text": "ability to register the name servers and again you would even think why would they even",
    "start": "1487279",
    "end": "1493360"
  },
  {
    "text": "have never ever allowed us to register the name servers obviously we don't we don't own the name servers of aws and",
    "start": "1493360",
    "end": "1501440"
  },
  {
    "text": "maybe that will be part of the resolutions that could be for this kind of attacks so basically",
    "start": "1501440",
    "end": "1508799"
  },
  {
    "text": "what aws did is that you cannot register anymore the name servers and that blocked speci this specific type of",
    "start": "1508799",
    "end": "1515760"
  },
  {
    "text": "attack we also disclosed this to other cloud providers that are currently working on a fix and we also disclose",
    "start": "1515760",
    "end": "1522159"
  },
  {
    "text": "this to microsoft now what's important to say here is that microsoft told us that this is not a vulnerability and",
    "start": "1522159",
    "end": "1529279"
  },
  {
    "start": "1523000",
    "end": "1572000"
  },
  {
    "text": "they're right this is actually not vulnerability the the problem here is that the dns of the",
    "start": "1529279",
    "end": "1535520"
  },
  {
    "text": "company is misconfigured the misconfiguration here is that the public dns didn't expect the endpoints",
    "start": "1535520",
    "end": "1542799"
  },
  {
    "text": "to actually think the uh this public dns is their internet dns the problem here is",
    "start": "1542799",
    "end": "1549600"
  },
  {
    "text": "actually what i call sometimes international waters it's not exactly a vulnerability but still there it has a",
    "start": "1549600",
    "end": "1555360"
  },
  {
    "text": "huge impact so basically this mis-configuration happens in so many organizations that",
    "start": "1555360",
    "end": "1562559"
  },
  {
    "text": "the impact is huge but we can fix that so let's now talk a bit about how this",
    "start": "1562559",
    "end": "1568320"
  },
  {
    "text": "vulnerability can fix they can be fixed",
    "start": "1568320",
    "end": "1572240"
  },
  {
    "start": "1572000",
    "end": "1610000"
  },
  {
    "text": "so a dns providers want to ensure that they are not vulnerable should make sure it is impossible to register their own",
    "start": "1576240",
    "end": "1582559"
  },
  {
    "text": "domains on the platform yes providers who wants to have even a better security can also do",
    "start": "1582559",
    "end": "1588320"
  },
  {
    "text": "ongoing verification to ensure users are only registering their own domains in addition it is important to make sure",
    "start": "1588320",
    "end": "1595039"
  },
  {
    "text": "that the platform user cannot register a reserved name as specified in the dns rfcs",
    "start": "1595039",
    "end": "1601120"
  },
  {
    "text": "the rfc is full of reserve domains that should not be allowed to register and there is the registration may lead to",
    "start": "1601120",
    "end": "1607120"
  },
  {
    "text": "unexpected behavior for organizations that want to make sure",
    "start": "1607120",
    "end": "1613120"
  },
  {
    "start": "1610000",
    "end": "1657000"
  },
  {
    "text": "they are not vulnerable we recommend making sure that the primary name server in the soa record in the external dns",
    "start": "1613120",
    "end": "1621279"
  },
  {
    "text": "does not point to a default domain owned by the dns provider as you can see in the slide the default",
    "start": "1621279",
    "end": "1627039"
  },
  {
    "text": "primary name server that the domain owner receives when they add the domains to router 53 is the",
    "start": "1627039",
    "end": "1633200"
  },
  {
    "text": "first name of the the first name of the four name servers",
    "start": "1633200",
    "end": "1638320"
  },
  {
    "text": "which manage the dns zone changing it to the organization a primary",
    "start": "1638320",
    "end": "1644559"
  },
  {
    "text": "name server or even to an invalid subdomain under the domain will solve the problem and",
    "start": "1644559",
    "end": "1651120"
  },
  {
    "text": "will not allow potential attackers to register the domain on the platform",
    "start": "1651120",
    "end": "1656879"
  },
  {
    "start": "1657000",
    "end": "1723000"
  },
  {
    "text": "we are getting to the end of the presentation and i want to recommend some research directions for researchers",
    "start": "1658240",
    "end": "1663440"
  },
  {
    "text": "who may want to continue our research during the study we found more interesting domains that can be",
    "start": "1663440",
    "end": "1668960"
  },
  {
    "text": "registered on dns's service platforms any domain that is considered reserved by the rfc is interesting with some",
    "start": "1668960",
    "end": "1676399"
  },
  {
    "text": "playing with reverse dns reserve names like the dote alpa arpa",
    "start": "1676399",
    "end": "1681840"
  },
  {
    "text": "family and we managed to get connections from variety of endpoints",
    "start": "1681840",
    "end": "1687840"
  },
  {
    "text": "another research direction um we have is to scan dna servers in the world and try to update them with",
    "start": "1687840",
    "end": "1694159"
  },
  {
    "text": "dynamic dns shows there are servers that do not verify authentication and it will be",
    "start": "1694159",
    "end": "1699279"
  },
  {
    "text": "interesting to understand how many of them are there another research direction that we find",
    "start": "1699279",
    "end": "1705279"
  },
  {
    "text": "interesting is the ntlm authentication in dns updates perhaps it's possible to take advantage",
    "start": "1705279",
    "end": "1711840"
  },
  {
    "text": "of the fact that the computer in an organization is trying to authenticate with us it might allow some ntlm attacks",
    "start": "1711840",
    "end": "1718640"
  },
  {
    "text": "that could grant an attacker and an easy entry point into the exposed organization",
    "start": "1718640",
    "end": "1724559"
  },
  {
    "start": "1723000",
    "end": "1773000"
  },
  {
    "text": "so apparently a dynamic dns say enabled the authentication which sounds very reasonable letting anyone in the",
    "start": "1724559",
    "end": "1731120"
  },
  {
    "text": "organization to update any dns record they want sounds a bit risky windows computers perform authentication using",
    "start": "1731120",
    "end": "1737200"
  },
  {
    "text": "ntlm or kerberos over dns tsig to force endpoint to authenticate to us",
    "start": "1737200",
    "end": "1743039"
  },
  {
    "text": "all we have to do is to respond with a refused message to the update request the computer will then attempt to authenticate",
    "start": "1743039",
    "end": "1749200"
  },
  {
    "text": "not every computer had authentication with us and we do not know in what it depends",
    "start": "1749200",
    "end": "1755200"
  },
  {
    "text": "here we can see an authentication request we receive from a windows 10 computer using ntlm",
    "start": "1755200",
    "end": "1760880"
  },
  {
    "text": "the fact that it is possible to get a computer to do antenna negotiation with us sounds really cool and it may be",
    "start": "1760880",
    "end": "1766799"
  },
  {
    "text": "possible to leverage it we have not continued to stretch this research direction",
    "start": "1766799",
    "end": "1773919"
  },
  {
    "start": "1773000",
    "end": "1853000"
  },
  {
    "text": "so what have we seen just a quick summary and key takeaways we got to nation state",
    "start": "1774480",
    "end": "1782240"
  },
  {
    "text": "capabilities after doing a simple domain registration so",
    "start": "1782240",
    "end": "1787919"
  },
  {
    "text": "and this scope is not only for a specific service we saw that the scope may be much bigger",
    "start": "1787919",
    "end": "1794720"
  },
  {
    "text": "so there is a huge scope here but it's not only we believe it's not only the domain name",
    "start": "1794720",
    "end": "1801679"
  },
  {
    "text": "of the name server we believe there may be many additional domains that you might register that might break things",
    "start": "1801679",
    "end": "1808880"
  },
  {
    "text": "because as we saw here you can never expect what dns clients will do so we",
    "start": "1808880",
    "end": "1814240"
  },
  {
    "text": "see this as a new class of dns vulnerabilities that are trying to leverage the fact that dns as a service",
    "start": "1814240",
    "end": "1821120"
  },
  {
    "text": "works a bit differently than dns providers that we had on premise and and using that effect try to find completely",
    "start": "1821120",
    "end": "1828240"
  },
  {
    "text": "new attack vectors that are completely uncharted and maybe untraceable for companies",
    "start": "1828240",
    "end": "1834000"
  },
  {
    "text": "so thank you for uh taking the time and we we hope that the",
    "start": "1834000",
    "end": "1839360"
  },
  {
    "text": "security community would will start looking more into dns's service vulnerabilities we would",
    "start": "1839360",
    "end": "1845840"
  },
  {
    "text": "love to cooperate and work with anyone that would want to help us in further research",
    "start": "1845840",
    "end": "1852000"
  },
  {
    "text": "thank you",
    "start": "1852000",
    "end": "1854960"
  }
]