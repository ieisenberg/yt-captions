[
  {
    "text": "the session is mobile device mismanagement and thank you very much please enjoy the rest of the",
    "start": "120",
    "end": "7400"
  },
  {
    "text": "briefings hello everybody some uh quick introductions uh my name is Chris C Jo",
    "start": "10679",
    "end": "16278"
  },
  {
    "text": "I'm a director of Assessment Services for ncom security uh run our uh kind of",
    "start": "16279",
    "end": "21840"
  },
  {
    "text": "oversee the the ethical hacking offensive security penetration testing team as well as our assessment uh PCI",
    "start": "21840",
    "end": "28000"
  },
  {
    "text": "hippoc compliance all that sort of pen and paper for assessment side of things as well and this is Steven Breen go for",
    "start": "28000",
    "end": "33399"
  },
  {
    "text": "it I'm Steve Breen that's on I'm with uh NT com",
    "start": "33399",
    "end": "38600"
  },
  {
    "text": "security uh senior security consultant so we do penetration tests uh on my team",
    "start": "38600",
    "end": "44280"
  },
  {
    "text": "and I did the technical work for this project so a quick overview what we're",
    "start": "44280",
    "end": "50320"
  },
  {
    "text": "going to get into here a little uh quick introduction uh look at the MDM Market why all this matters uh how we got",
    "start": "50320",
    "end": "56719"
  },
  {
    "text": "started on some of the vulnerabilities we're going to be talking about today uh going into some detail on what we found",
    "start": "56719",
    "end": "62559"
  },
  {
    "text": "and what it means and then what we can do about it some of the the solutions getting around these vulnerabilities making sure this sort of thing doesn't",
    "start": "62559",
    "end": "69240"
  },
  {
    "text": "happen so getting into the introduction here the kind of the one of the big",
    "start": "69240",
    "end": "74479"
  },
  {
    "text": "themes that uh that we're touching on here is this this concept that everything increases the potential",
    "start": "74479",
    "end": "80240"
  },
  {
    "text": "attack surface even security software if you're putting anything out there on your Network anything in your",
    "start": "80240",
    "end": "85600"
  },
  {
    "text": "environment anything could potentially have vulnerabilities in it and uh so MDM",
    "start": "85600",
    "end": "90720"
  },
  {
    "text": "software being part of that that's kind of the basis of this talk um you know looking through some of the the recent",
    "start": "90720",
    "end": "96079"
  },
  {
    "text": "events heart bleed of course you know op SSL it's a piece of software designed for security it's supposed to keep our",
    "start": "96079",
    "end": "101799"
  },
  {
    "text": "communication safe and with a vulnerability like heart bed it's basically just giving us a false sense",
    "start": "101799",
    "end": "107360"
  },
  {
    "text": "of security there but some of these things get much worse uh there have been a few talks about antivirus uh going",
    "start": "107360",
    "end": "113479"
  },
  {
    "text": "back all the way to 2008 uh some vulnerabilities in the the decompression algorithms that were used in antivirus",
    "start": "113479",
    "end": "120719"
  },
  {
    "text": "products so now you you've got antivirus is actually a vector for malware to",
    "start": "120719",
    "end": "126119"
  },
  {
    "text": "infect your system so that's worse than a false sense of security that's actually opening up some new holes in your your systems that you wouldn't",
    "start": "126119",
    "end": "132200"
  },
  {
    "text": "otherwise have uh Barracuda we saw a few years back the um the backdoor passwords",
    "start": "132200",
    "end": "138080"
  },
  {
    "text": "uh backd door admin and root passwords and some of the Barracuda Network Security products uh that got shut down",
    "start": "138080",
    "end": "143160"
  },
  {
    "text": "pretty quick once somebody found those and so now we're getting into MDM uh and there was a a previous talk back in uh",
    "start": "143160",
    "end": "150800"
  },
  {
    "text": "2013 on some vulnerabilities in the admin consoles the web-based interfaces for administering the MDM products and",
    "start": "150800",
    "end": "158680"
  },
  {
    "text": "uh so we we're kind of building on that Concept in that we found some more of the same but we also took a a bit of a",
    "start": "158680",
    "end": "164480"
  },
  {
    "text": "deeper look into the communication protocols themselves some of the things on the uh the device",
    "start": "164480",
    "end": "170040"
  },
  {
    "text": "side so taking a quick look at the MDM Market how how prevalent is all of this",
    "start": "170040",
    "end": "175599"
  },
  {
    "text": "stuff um and and kind of what MDM is trying to accomplish here which I'm sure sure everybody in this room probably uh",
    "start": "175599",
    "end": "181879"
  },
  {
    "text": "has a pretty good idea but uh it's all about we've got this whole move towards bring your own device we've got all",
    "start": "181879",
    "end": "187599"
  },
  {
    "text": "these smartphones out there with uh with company data on it and that brings a bunch of problems from insecure",
    "start": "187599",
    "end": "193400"
  },
  {
    "text": "configurations privately owned devices that the company really doesn't have control over at the end of the day and",
    "start": "193400",
    "end": "199040"
  },
  {
    "text": "these things are small they're portable they're easy to lose and all that data gets lost with it so that's where we",
    "start": "199040",
    "end": "204920"
  },
  {
    "text": "bring our MDM software in we bring in that software to address these problems things like our policy enforcement the",
    "start": "204920",
    "end": "210720"
  },
  {
    "text": "remote wipe capability and device locking capability and so these are meant to address these initial problems",
    "start": "210720",
    "end": "216720"
  },
  {
    "text": "but funny enough some of these are the capabilities that we've managed to hijack in order to uh you know kind of",
    "start": "216720",
    "end": "222560"
  },
  {
    "text": "exploit some vulnerabilities uh as for deployment uh some some just numbers that we've pulled",
    "start": "222560",
    "end": "229040"
  },
  {
    "text": "out of uh surveys that we've seen that there's about 180 million Enterprise bod",
    "start": "229040",
    "end": "234400"
  },
  {
    "text": "devices out there uh we're this is expected to increase to 39 Million by next year so",
    "start": "234400",
    "end": "241439"
  },
  {
    "text": "this is growing very rapidly as companies are migrating to this BYOD model and uh the US region of course is",
    "start": "241439",
    "end": "248480"
  },
  {
    "text": "expected to be the leader in this with 68% of the market and uh some interesting numbers here about the",
    "start": "248480",
    "end": "255000"
  },
  {
    "text": "number of companies that have deployed MDM the number of companies that are looking into deploying it and evaluating",
    "start": "255000",
    "end": "261199"
  },
  {
    "text": "it and so we're looking at about 82% of companies either have it already are at",
    "start": "261199",
    "end": "266280"
  },
  {
    "text": "some stage in the process of thinking about getting MD M out there so these",
    "start": "266280",
    "end": "271360"
  },
  {
    "text": "issues that we're we're coming up with affect many and most of the the companies that are uh that are out there",
    "start": "271360",
    "end": "277919"
  },
  {
    "text": "with mobile devices and of course the vulnerabilities at the end of the day it's all about getting access to some",
    "start": "277919",
    "end": "284440"
  },
  {
    "text": "sort of sensitive data you know nobody's going to attack a device unless they're trying to steal something so some more",
    "start": "284440",
    "end": "290080"
  },
  {
    "text": "information about uh what people are accessing with these mobile devices and no surprise here email right at the top",
    "start": "290080",
    "end": "296120"
  },
  {
    "text": "of the list 95% of these are being used to access Corporate email and one of the things that uh you as a",
    "start": "296120",
    "end": "302400"
  },
  {
    "text": "pentester and just a general all-around security guy when I talk to people who aren't in the security field I often",
    "start": "302400",
    "end": "307960"
  },
  {
    "text": "hear that oh what do I care what if somebody sees my email I don't need a passcode on my phone who cares but email",
    "start": "307960",
    "end": "314919"
  },
  {
    "text": "is is kind of the core of our Digital Life I'm sure everybody here is already on board with that that you know you",
    "start": "314919",
    "end": "320639"
  },
  {
    "text": "just for one example is you go out and you hit that I want to reset my password link on some website and that's going to",
    "start": "320639",
    "end": "325880"
  },
  {
    "text": "go to your email so right there that alone if I control your email can pretty much take over all of your accounts",
    "start": "325880",
    "end": "331759"
  },
  {
    "text": "everything else that you've got out there besides email though we see a lot of office applications VPN access into a",
    "start": "331759",
    "end": "338560"
  },
  {
    "text": "network you know there's a great spot for an attacker if he can get in over that VPN automatically through a mobile",
    "start": "338560",
    "end": "343840"
  },
  {
    "text": "device now he's got a point that he can pivot inside your network inside your perimeter and start launching attacks",
    "start": "343840",
    "end": "349600"
  },
  {
    "text": "corporate file servers databases CRM the works all sorts of sensitive things that we wouldn't necessarily want somebody to",
    "start": "349600",
    "end": "356000"
  },
  {
    "text": "be able to hijack and get access to that information uh MDM it's a it's a fairly big Market",
    "start": "356000",
    "end": "362600"
  },
  {
    "text": "there's a lot of players out there right now a lot of products um this is a look at the Gartner quadrant and when uh we",
    "start": "362600",
    "end": "369080"
  },
  {
    "text": "were preparing to do this talk uh one of the things that Steve did here was a quick cve search on uh all the uh",
    "start": "369080",
    "end": "376120"
  },
  {
    "text": "vendors in the the top right quadrant there just to see what came up and we came up with no results no cves in any",
    "start": "376120",
    "end": "383120"
  },
  {
    "text": "of the top right quadrant MDM products so that was kind of an interesting thing",
    "start": "383120",
    "end": "388479"
  },
  {
    "text": "that here we are stumbling across vulnerabilities and we don't see any cves so this said to us that it probably",
    "start": "388479",
    "end": "394720"
  },
  {
    "text": "doesn't mean there are no vulnerabilities it means that nobody's really looking for these vulnerabilities",
    "start": "394720",
    "end": "400000"
  },
  {
    "text": "yet and uh something else we noticed is that some of these products actually share a common backend uh that there's",
    "start": "400000",
    "end": "407639"
  },
  {
    "text": "there's the API on the actual mobile devices that we'll talk about in a little bit more detail but that uh",
    "start": "407639",
    "end": "413360"
  },
  {
    "text": "there's also this common code base that a few different MDM vendors have basically used as the core of their",
    "start": "413360",
    "end": "419240"
  },
  {
    "text": "product so if we find a vulnerability in one MDM product it tends to show up in a few other products as",
    "start": "419240",
    "end": "426680"
  },
  {
    "text": "well and how this all started for us uh Steve mentioned we do uh penetration testing and this is kind of the the",
    "start": "427039",
    "end": "434080"
  },
  {
    "text": "value of a good penetration test uh this actually started with a few of our live pen tests on clients that uh that we",
    "start": "434080",
    "end": "441039"
  },
  {
    "text": "went out a client had some mobile devices and we started uh doing testing on their mobile devices and we wanted to",
    "start": "441039",
    "end": "447879"
  },
  {
    "text": "take basically the image that they were deploying on their corporate devices and put it on our our jailbroken iPad in the",
    "start": "447879",
    "end": "453240"
  },
  {
    "text": "lab for testing and pretty quickly we figured out that their MDM software",
    "start": "453240",
    "end": "458319"
  },
  {
    "text": "wasn't letting us run their image because of our jailbreaking so it took a few minutes and we figured out a way",
    "start": "458319",
    "end": "464039"
  },
  {
    "text": "around the jailbreak detection and uh so said um okay that's an interesting thing",
    "start": "464039",
    "end": "469680"
  },
  {
    "text": "and then on top of that uh we were doing another one on a client that had MDM deployed and fairly quickly once we",
    "start": "469680",
    "end": "477120"
  },
  {
    "text": "identified that MDM server we were able to find what looked like some default credentials uh get into the",
    "start": "477120",
    "end": "482639"
  },
  {
    "text": "administrative interface and then we found a remote code execution vulnerability in that administrative",
    "start": "482639",
    "end": "487800"
  },
  {
    "text": "interface so again that was pretty interesting so at that point we decided",
    "start": "487800",
    "end": "492960"
  },
  {
    "text": "it was time to head back to the lab and uh take a deeper look at these products take a deeper look at the communication",
    "start": "492960",
    "end": "499159"
  },
  {
    "text": "protocols and see what other sorts of things that uh that we could find and that's uh what we're here today to uh to",
    "start": "499159",
    "end": "505240"
  },
  {
    "text": "talk to you about so a few other quick points uh just on the vendor side and at this",
    "start": "505240",
    "end": "511960"
  },
  {
    "text": "point I'll I'll hand over to Steve but these things are pretty hard to test uh you know you had your your experience",
    "start": "511960",
    "end": "517159"
  },
  {
    "text": "with the uh getting some of the products here and this might be part of the reason why we didn't see very many cves",
    "start": "517159",
    "end": "522440"
  },
  {
    "text": "out there yeah I think that's definitely part of the reason uh it's not that they're hard to test and that it's",
    "start": "522440",
    "end": "529240"
  },
  {
    "text": "technically difficult it's just difficult to get your hands on this software it's big corporate software uh",
    "start": "529240",
    "end": "534760"
  },
  {
    "text": "they don't want to give demos out to anyone uh most people don't have the ability to go po poing around in their",
    "start": "534760",
    "end": "540360"
  },
  {
    "text": "company's production environment without getting a slap on the wrist uh and also there's even if you do have",
    "start": "540360",
    "end": "547680"
  },
  {
    "text": "that ability there really isn't that much tooling or information available uh just out there for people to go ahead",
    "start": "547680",
    "end": "553440"
  },
  {
    "text": "and test these things space",
    "start": "553440",
    "end": "559760"
  },
  {
    "text": "okay uh so with what we're about to present today we've disclosed so we worked with a few different vendors and",
    "start": "559760",
    "end": "566279"
  },
  {
    "text": "we disclosed these findings to the vendors uh they issued some patches and patches will be will continue to be",
    "start": "566279",
    "end": "573440"
  },
  {
    "text": "issued um so before we get into the technical details I just wanted to uh",
    "start": "573440",
    "end": "579360"
  },
  {
    "text": "say there there won't be a whole ton of really deep technical detail here uh",
    "start": "579360",
    "end": "585480"
  },
  {
    "text": "just because we we aren't allowed to mention vendor names uh at the moment because a lot of these issues in some of",
    "start": "585480",
    "end": "591800"
  },
  {
    "text": "the top products are currently unpatched and uh they're they're pretty serious a",
    "start": "591800",
    "end": "597440"
  },
  {
    "text": "few of them",
    "start": "597440",
    "end": "600720"
  },
  {
    "text": "um so for this particular project we really had a strong focus on iOS MDM and",
    "start": "605040",
    "end": "610399"
  },
  {
    "text": "there was a reason for that uh iOS uses a standard protocol for MDM it's part of",
    "start": "610399",
    "end": "616680"
  },
  {
    "text": "iOS itself um so all of the vendors have to implement this same protocol and what",
    "start": "616680",
    "end": "622959"
  },
  {
    "text": "we saw in the wild is that if one vendor was making a mistake uh often that same",
    "start": "622959",
    "end": "629079"
  },
  {
    "text": "mist mistake was made by some others uh Android on the other hand does not do",
    "start": "629079",
    "end": "634760"
  },
  {
    "text": "this they it's kind of uh kind of like the wild west of MDM and that it's",
    "start": "634760",
    "end": "639880"
  },
  {
    "text": "really up to vendors to implement their own Communications protocols uh it's",
    "start": "639880",
    "end": "645279"
  },
  {
    "text": "totally up to them to do things however they want and they just have a set of API calls that they can make uh that",
    "start": "645279",
    "end": "652200"
  },
  {
    "text": "does all the MDM functionality on the back end so on the second bullet point iOS",
    "start": "652200",
    "end": "658560"
  },
  {
    "text": "enforces an AP for MDM there's no way to do these MDM things except going through",
    "start": "658560",
    "end": "664440"
  },
  {
    "text": "ios's uh communication protocol and it it it it's really specified at a fairly",
    "start": "664440",
    "end": "669680"
  },
  {
    "text": "detailed level by Apple how you have to go about this uh and all of the code for MDM is",
    "start": "669680",
    "end": "676240"
  },
  {
    "text": "actually part of iOS so where we found a lot of these",
    "start": "676240",
    "end": "681480"
  },
  {
    "text": "vulnerabilities isn't actually in Apple's protocol it's actually in the uh server side software that's developed by",
    "start": "681480",
    "end": "688000"
  },
  {
    "text": "the vendors um it's not that Apple iOS MDM is inherently insecure it's just",
    "start": "688000",
    "end": "695000"
  },
  {
    "text": "that we found buggy uh buggy code and lots of vulnerabilities in a few",
    "start": "695000",
    "end": "700480"
  },
  {
    "text": "different products and i' I've already talked about this Android doesn't have that MDM",
    "start": "700480",
    "end": "706880"
  },
  {
    "text": "API and I'm going to I'm going to get into this more a little bit more later on what these like what this means to",
    "start": "706880",
    "end": "712600"
  },
  {
    "text": "have a standard messaging set so move on",
    "start": "712600",
    "end": "720279"
  },
  {
    "text": "uh so with MDM there's there's really two phases of like a part of the life cycle you have enrollment and then you",
    "start": "720279",
    "end": "726639"
  },
  {
    "text": "have uh routine communication between the device and the server so the enrollment process is the one uh you",
    "start": "726639",
    "end": "733040"
  },
  {
    "text": "have this device it doesn't have MDM installed on it it's totally unmanaged and then you go through some enrollment",
    "start": "733040",
    "end": "738680"
  },
  {
    "text": "process and now your device is managed by MDM so we're going to talk about that enrollment process first because we saw",
    "start": "738680",
    "end": "744800"
  },
  {
    "text": "a few bugs uh slip in there uh on iOS there are three dis inct phases for this",
    "start": "744800",
    "end": "750160"
  },
  {
    "text": "enrollment process you have authentication uh where the user is actually authenticating to the MDM",
    "start": "750160",
    "end": "755639"
  },
  {
    "text": "server and the reason you want to do this is because mdm's protecting a lot of really sensitive data like uh your",
    "start": "755639",
    "end": "763279"
  },
  {
    "text": "your domain credentials WPA2 pre-shared keys for your Enterprise Network uh just",
    "start": "763279",
    "end": "769279"
  },
  {
    "text": "a whole bunch of different stuff like that potentially VPN access and then uh after the user has",
    "start": "769279",
    "end": "776480"
  },
  {
    "text": "been authenticated there's this certificate enrollment step where uh the MDM server and the device will exchange",
    "start": "776480",
    "end": "783639"
  },
  {
    "text": "some uh certificates so they can communicate securely later in the",
    "start": "783639",
    "end": "788959"
  },
  {
    "text": "process and then once those certificates have been exchanged the server will actually push a whole bunch of",
    "start": "788959",
    "end": "794800"
  },
  {
    "text": "configuration and stuff down to the device and that if done correctly it should use those certificates and do",
    "start": "794800",
    "end": "801000"
  },
  {
    "text": "this in a in a secure way and it's worth mentioning that um",
    "start": "801000",
    "end": "807120"
  },
  {
    "text": "all of this both this and the the the routine communication between the server and the device all occurs over HTTP so",
    "start": "807120",
    "end": "814000"
  },
  {
    "text": "you can uh look at it with intercepting proxies pretty",
    "start": "814000",
    "end": "818439"
  },
  {
    "text": "easily um so I'm just going to go through a few of the issues we found with enrollment like I said we can't",
    "start": "820920",
    "end": "826320"
  },
  {
    "text": "really mention vendor names uh I mean this one I guess is pretty obvious but it's not that bad",
    "start": "826320",
    "end": "833279"
  },
  {
    "text": "uh so a lot of vendors are actually doing some parts of the enrollment process without encrypting",
    "start": "833279",
    "end": "839880"
  },
  {
    "text": "communication uh what we saw is usually the the authentication part where you send your username and password most of",
    "start": "839880",
    "end": "846199"
  },
  {
    "text": "the time that'll be encrypted uh but as anyone Who develops web applications know usually uh you're not sending your",
    "start": "846199",
    "end": "852399"
  },
  {
    "text": "username and password at every at every step you get some kind of cookie or an authorization token uh or something like",
    "start": "852399",
    "end": "858639"
  },
  {
    "text": "that and uh sometimes they'll drop the encrypted Channel when they start sending that token back and forth so",
    "start": "858639",
    "end": "865480"
  },
  {
    "text": "it's prone to interception um even when some even when",
    "start": "865480",
    "end": "870880"
  },
  {
    "text": "the the vendors are using encryption sometimes they will uh provide very easy",
    "start": "870880",
    "end": "877079"
  },
  {
    "text": "to ignore certificate errors so anyone who uses modern browsers knows that if a",
    "start": "877079",
    "end": "883279"
  },
  {
    "text": "if if you have a website presenting an invalid SSL certificate uh this big",
    "start": "883279",
    "end": "888759"
  },
  {
    "text": "nasty box pops up and tells you that uh the the certificate's invalid and uh",
    "start": "888759",
    "end": "896040"
  },
  {
    "text": "it's it's actually quite difficult or at least like kind of scary to get past that with MDM the uh this here is all",
    "start": "896040",
    "end": "903160"
  },
  {
    "text": "all you get it's not really that much information and it's not uh it's probably most people will just click",
    "start": "903160",
    "end": "908639"
  },
  {
    "text": "accept and uh you'll you'll be able to intercept credentials or tokens or",
    "start": "908639",
    "end": "914720"
  },
  {
    "text": "whatever um another another thing for this is enrollment usually usually the authentication involves some kind of",
    "start": "915000",
    "end": "921639"
  },
  {
    "text": "token at at least at some stage and sometimes these tokens are very easy to predict uh a couple of vendors are just",
    "start": "921639",
    "end": "928399"
  },
  {
    "text": "using tiny URL as uh as their token so you'll be given a token to enroll your",
    "start": "928399",
    "end": "933519"
  },
  {
    "text": "device and really all that token is is a reference to some tiny URL uh tiny URL link and those things uh",
    "start": "933519",
    "end": "942240"
  },
  {
    "text": "I mean there's just not that much entropy there it's only like five or six characters and anyone with access to",
    "start": "942240",
    "end": "947360"
  },
  {
    "text": "Tiny URL servers then has all your enrollment tokens uh these tokens are usually valid",
    "start": "947360",
    "end": "954600"
  },
  {
    "text": "well not usually uh they can be configured and often are to be valid forever uh and uh they they often leak",
    "start": "954600",
    "end": "961759"
  },
  {
    "text": "in a number of ways not just through tiny URL but some other providers for",
    "start": "961759",
    "end": "967600"
  },
  {
    "text": "example I think that's pretty clear is like another example of token leakage is one of the providers during that",
    "start": "967600",
    "end": "973759"
  },
  {
    "text": "certificate exchange process they were actually putting uh the secret token that no one should ever know in the uh",
    "start": "973759",
    "end": "982079"
  },
  {
    "text": "in the common name field of one of those certificates that gets pushed on the device so all an attacker has to do is",
    "start": "982079",
    "end": "988079"
  },
  {
    "text": "request Mutual SSL authentication from a website like I did here or from something else and uh I mean it's easy",
    "start": "988079",
    "end": "996079"
  },
  {
    "text": "enough the device will just send away the certificate and it has in the common name field this super secret",
    "start": "996079",
    "end": "1002839"
  },
  {
    "text": "token so what's the result of this so what we've talked about over the last minute or so is it's mostly this this",
    "start": "1003120",
    "end": "1008800"
  },
  {
    "text": "token leakage and like insecure communication and Le and uh gaining",
    "start": "1008800",
    "end": "1014040"
  },
  {
    "text": "access to someone's token or gaining access to MDI MDM as them uh so the",
    "start": "1014040",
    "end": "1020279"
  },
  {
    "text": "result is that you can impersonate the user within the MDM solution if you can get access to this token um and what",
    "start": "1020279",
    "end": "1027240"
  },
  {
    "text": "that means is you basically have access at that point to anything they get access to on their phone so if they have email and corporate networks and VPN and",
    "start": "1027240",
    "end": "1035360"
  },
  {
    "text": "uh all that good stuff then whoever whoever you're impersonating you all you have access to all that stuff on their",
    "start": "1035360",
    "end": "1041319"
  },
  {
    "text": "behalf uh and a talker could use this to Pivot into your network uh read Key",
    "start": "1041319",
    "end": "1046880"
  },
  {
    "text": "Personnel email uh",
    "start": "1046880",
    "end": "1050840"
  },
  {
    "text": "Etc so that was enrollment um we're going to get into the the more interesting part now this is the uh the",
    "start": "1052960",
    "end": "1060760"
  },
  {
    "text": "just routine communication between the device and the server so you have I'm",
    "start": "1060760",
    "end": "1065880"
  },
  {
    "text": "just going to describe at a high level how this works uh if if the MDM server",
    "start": "1065880",
    "end": "1071440"
  },
  {
    "text": "has something to say to your device or your device wants to talk to it this is kind of what happens so the MDM Server",
    "start": "1071440",
    "end": "1078520"
  },
  {
    "text": "doesn't talk directly to your device it actually goes through apple and it sends a message over APNs uh up to Apple",
    "start": "1078520",
    "end": "1085600"
  },
  {
    "text": "saying hey I have a message for device X in this case uh then Apple relays that",
    "start": "1085600",
    "end": "1091880"
  },
  {
    "text": "message and basically just says hey your MDM server has a message for",
    "start": "1091880",
    "end": "1097159"
  },
  {
    "text": "you the device will then pretty will just reach out over HTTP and this is an",
    "start": "1098840",
    "end": "1104000"
  },
  {
    "text": "example of a request we just used uh burp to to intercept this traffic so we",
    "start": "1104000",
    "end": "1109480"
  },
  {
    "text": "could look at what was going on uh so the the device reaches back to the server and it basically just says Hey",
    "start": "1109480",
    "end": "1116559"
  },
  {
    "text": "like I'm I'm idle uh ready to receive commands or ready to receive data or",
    "start": "1116559",
    "end": "1121679"
  },
  {
    "text": "just whatever the MDM server wants it to do and the server will reply to that uh",
    "start": "1121679",
    "end": "1128240"
  },
  {
    "text": "with a a number of different messages like depending what it wants the device to do it'll it'll tell it to do",
    "start": "1128240",
    "end": "1134080"
  },
  {
    "text": "something or it'll give it some data uh in this case it was telling it to uh",
    "start": "1134080",
    "end": "1139159"
  },
  {
    "text": "install a profile and that's the payload and uh the interesting thing about this particular payload and lots of other",
    "start": "1139159",
    "end": "1145120"
  },
  {
    "text": "ones is uh the stuff inside that that's just base 64 uh encoded or Bas 64",
    "start": "1145120",
    "end": "1151200"
  },
  {
    "text": "encrypted as some people like to call it it's a you can just decode that there",
    "start": "1151200",
    "end": "1156640"
  },
  {
    "text": "are like plain text domain credentials plain text WPA2 Keys uh so anyone who gets access to",
    "start": "1156640",
    "end": "1162960"
  },
  {
    "text": "that uh it's definitely not good",
    "start": "1162960",
    "end": "1168440"
  },
  {
    "text": "this is the just the list of commands that uh MDM and the device kind of",
    "start": "1171000",
    "end": "1176480"
  },
  {
    "text": "exchange so they can do a few different things the server uh so we have four columns these are different categories",
    "start": "1176480",
    "end": "1182000"
  },
  {
    "text": "of command you have Lo uh control device info configuration and then device to server messages the control commands are",
    "start": "1182000",
    "end": "1188640"
  },
  {
    "text": "pretty obvious it's just the uh MDM server telling the device to do something like lock yourself or wipe",
    "start": "1188640",
    "end": "1194600"
  },
  {
    "text": "yourself uh something like that the uh device info commands or the",
    "start": "1194600",
    "end": "1199640"
  },
  {
    "text": "server just requesting some information from the device uh configuration there it wants to install uh profiles change",
    "start": "1199640",
    "end": "1207320"
  },
  {
    "text": "settings that last message we saw was a configuration message um these ones are pretty interesting because a lot of",
    "start": "1207320",
    "end": "1213679"
  },
  {
    "text": "sensitive data gets pushed around in these configuration profiles and then you have device to server messages where",
    "start": "1213679",
    "end": "1219360"
  },
  {
    "text": "the device is actually reaching direct to the server without that initial thing from APNs that we talked about",
    "start": "1219360",
    "end": "1227840"
  },
  {
    "text": "so we're going to talk briefly about some of the issues that we saw Within These uh these products and the way",
    "start": "1231919",
    "end": "1237440"
  },
  {
    "text": "they're handling this protocol like I said the protocol has potential to be implemented well and it seems fairly",
    "start": "1237440",
    "end": "1243240"
  },
  {
    "text": "secure but uh some of the implementations definitely had uh had",
    "start": "1243240",
    "end": "1248799"
  },
  {
    "text": "some issues um so one thing is you you see on",
    "start": "1248799",
    "end": "1255600"
  },
  {
    "text": "the on the the big blacked out thing at the top that's that's the MDM signature",
    "start": "1255600",
    "end": "1260640"
  },
  {
    "text": "and uh what that is is the the device during that uh enrollment process when they exchange Keys the device is going",
    "start": "1260640",
    "end": "1268440"
  },
  {
    "text": "to use those keys to uh sign messages so that this is pretty much the this up",
    "start": "1268440",
    "end": "1273840"
  },
  {
    "text": "here is pretty much the authentication this is what tells the server that hey I am this device I've enrolled and uh you",
    "start": "1273840",
    "end": "1281480"
  },
  {
    "text": "can trust these messages they're coming from me a lot of products just totally",
    "start": "1281480",
    "end": "1287760"
  },
  {
    "text": "neglect to use that header at all so pretty much what you'll see is imagine this message without without this whole",
    "start": "1287760",
    "end": "1294240"
  },
  {
    "text": "piece it's all gone uh and and if you think about what so",
    "start": "1294240",
    "end": "1300760"
  },
  {
    "text": "who what well if that's not there then what is authenticating a user what is what is uh what is there in that message",
    "start": "1300760",
    "end": "1308240"
  },
  {
    "text": "that is um that's basically a a secret where so that anyone can't just go",
    "start": "1308240",
    "end": "1313559"
  },
  {
    "text": "sending messages on behalf of any device well it turns out the the cookies that you see in that message those are",
    "start": "1313559",
    "end": "1319000"
  },
  {
    "text": "totally ignored uh they don't they don't matter you can just delete them the only thing that matters is the device udid",
    "start": "1319000",
    "end": "1325440"
  },
  {
    "text": "and that's pretty much just uh that that allows if you know that you can send messages to the MDM server on behalf of",
    "start": "1325440",
    "end": "1332559"
  },
  {
    "text": "someone else's device uh so those definitely shouldn't be considered",
    "start": "1332559",
    "end": "1337640"
  },
  {
    "text": "secret in the past they've leaked by the millions uh they they're available to",
    "start": "1337640",
    "end": "1343240"
  },
  {
    "text": "Applications installed on the device they're they're just they're really not Secrets like someone can't change the",
    "start": "1343240",
    "end": "1348640"
  },
  {
    "text": "udid if they realize oh no someone got my udid uh well that's pretty much it for that device at that",
    "start": "1348640",
    "end": "1356158"
  },
  {
    "text": "point um so what what can you do if someone is is neglecting to include that",
    "start": "1357840",
    "end": "1363720"
  },
  {
    "text": "signature header uh so basically at this point we're saying they're neglecting to include authentication into the process",
    "start": "1363720",
    "end": "1369760"
  },
  {
    "text": "you can send messages to the MDM server on a device's behalf if you know that you did so you could uh basically dos uh",
    "start": "1369760",
    "end": "1379480"
  },
  {
    "text": "like you cause a denial of service condition by telling the server hey uh",
    "start": "1379480",
    "end": "1384880"
  },
  {
    "text": "here's a new APNs token for this device and it's just garbage or you could tell it hey uh here's a new APNs token and",
    "start": "1384880",
    "end": "1391080"
  },
  {
    "text": "pointed a different device or something uh and then the server has does not have the ability to communicate with that",
    "start": "1391080",
    "end": "1396880"
  },
  {
    "text": "device anymore um you can tell the server that devices don't want to be enrolled",
    "start": "1396880",
    "end": "1402400"
  },
  {
    "text": "anymore using the uh checkout message and depending on the vendor that does different things with some vendors uh as",
    "start": "1402400",
    "end": "1408960"
  },
  {
    "text": "soon as you tell them I want to check out they'll start sending you down those uh that sensitive profile data right",
    "start": "1408960",
    "end": "1414640"
  },
  {
    "text": "away they'll just try to Like reenroll You by sending you all this sensitive data uh we'll see that in a second and",
    "start": "1414640",
    "end": "1422240"
  },
  {
    "text": "uh another another thing you can do is you you may actually be able to trick the server into wiping someone's device",
    "start": "1422240",
    "end": "1429200"
  },
  {
    "text": "by uh so so the way you would do that is you can you send a message on behalf of",
    "start": "1429200",
    "end": "1434360"
  },
  {
    "text": "their device to the server and you say hey my device is jailbroken or like or",
    "start": "1434360",
    "end": "1439919"
  },
  {
    "text": "uh something like that like there are a whole bunch of settings you can you can send to the server uh or a whole bunch",
    "start": "1439919",
    "end": "1446000"
  },
  {
    "text": "of like when it requests information from you you can reply with something that you think like jailbroken like",
    "start": "1446000",
    "end": "1453200"
  },
  {
    "text": "something you think the company would disallow and a lot of uh MDM uh it it depends on the",
    "start": "1453200",
    "end": "1459640"
  },
  {
    "text": "configuration but many configurations are are set up so that if someone's device is jailbroken or has a malware",
    "start": "1459640",
    "end": "1465760"
  },
  {
    "text": "installed on it or something uh the MDM server will actually wipe that device so you can't so it's kind of a one-way",
    "start": "1465760",
    "end": "1472159"
  },
  {
    "text": "thing you can send messages to the server and it will uh it'll reply and so you might be able to force a device wipe",
    "start": "1472159",
    "end": "1478520"
  },
  {
    "text": "that way by kind of tricking the server into thinking that the device is out of",
    "start": "1478520",
    "end": "1483919"
  },
  {
    "text": "compliance and probably the most interesting attack is uh you can you can actually steal that sensitive profile",
    "start": "1483919",
    "end": "1490240"
  },
  {
    "text": "data in some some configurations completely remotely so how that works is",
    "start": "1490240",
    "end": "1496760"
  },
  {
    "text": "we we talked about this being um we talked about this being uh the the",
    "start": "1496760",
    "end": "1504200"
  },
  {
    "text": "device is initiating that communication process over to the server so it's it's basically reaching out and saying hey",
    "start": "1504200",
    "end": "1510440"
  },
  {
    "text": "I'm I'm idle and I'm ready to receive commands but anyone can send that message to the server so if you as the",
    "start": "1510440",
    "end": "1516240"
  },
  {
    "text": "attacker kind of sit there and spam the server saying uh I'm idle and I'm ready",
    "start": "1516240",
    "end": "1521480"
  },
  {
    "text": "I'm idle I'm idle I'm Idol eventually the server is going to have something to say back to that device and at the time",
    "start": "1521480",
    "end": "1528600"
  },
  {
    "text": "and when it finally does you as the attacker are going to catch that response or like I said with that with",
    "start": "1528600",
    "end": "1533799"
  },
  {
    "text": "that other message the checkout message you might even be able to influence this so you don't have to wait around all day for the server to uh send you that",
    "start": "1533799",
    "end": "1540120"
  },
  {
    "text": "sensitive data so uh you can you can actually so if you",
    "start": "1540120",
    "end": "1545279"
  },
  {
    "text": "can get that if you can if you can catch that which isn't that hard uh we created a POC to do it uh you can actually just",
    "start": "1545279",
    "end": "1553840"
  },
  {
    "text": "get like plain text domain credentials by base 64 decoding that uh the WPA keys for the network uh it's it's really it's",
    "start": "1553840",
    "end": "1561399"
  },
  {
    "text": "not that hard um so a mitigation for that for people who aren't using that MDM",
    "start": "1561399",
    "end": "1567760"
  },
  {
    "text": "signature header so if they neglect to include authentication uh there there's still",
    "start": "1567760",
    "end": "1573679"
  },
  {
    "text": "one thing in your way this this here this is a sometimes in some",
    "start": "1573679",
    "end": "1578880"
  },
  {
    "text": "configurations it's encrypted and it should always be really but uh it's it",
    "start": "1578880",
    "end": "1584080"
  },
  {
    "text": "if if it's encrypted then that kind of stops the attacker from from uh just decoding it and getting that plain Text",
    "start": "1584080",
    "end": "1590159"
  },
  {
    "text": "data but what we've seen actually is that very often that payload encryption is disabled in some products um and that",
    "start": "1590159",
    "end": "1597960"
  },
  {
    "text": "would allow you to uh to intercept all that data going back from the server to the",
    "start": "1597960",
    "end": "1604679"
  },
  {
    "text": "device um so some other things we saw within the same protocol uh it obviously",
    "start": "1609600",
    "end": "1615039"
  },
  {
    "text": "anytime you have untrusted data being processed by a server you have potential",
    "start": "1615039",
    "end": "1620080"
  },
  {
    "text": "for injection flaws uh and we found a number of injection flaws in some",
    "start": "1620080",
    "end": "1625559"
  },
  {
    "text": "products uh SQL injection uh uh xxe uh and we were actually so the",
    "start": "1625559",
    "end": "1634679"
  },
  {
    "text": "the problem with this is if you if you if you remember that MDM signature head or what that is is it's a signed uh it's",
    "start": "1634679",
    "end": "1640600"
  },
  {
    "text": "the message body it's it's signed with the those searchs that were exchanged so",
    "start": "1640600",
    "end": "1645760"
  },
  {
    "text": "how do you actually go and like put a SQL injection payload in here and uh",
    "start": "1645760",
    "end": "1651720"
  },
  {
    "text": "actually like perform that attack because anytime you make any minor change to the message you're going to be",
    "start": "1651720",
    "end": "1658799"
  },
  {
    "text": "uh invalidating that signature header and the server might not process it anymore um so we we actually created a",
    "start": "1658799",
    "end": "1664840"
  },
  {
    "text": "tool it's an EXT it's a burp extension we're not releasing it right now but we will be shortly um and it act it it uh",
    "start": "1664840",
    "end": "1673120"
  },
  {
    "text": "you can pull the the keys off a device that's enrolled and you can use this burp EX extension to send uh it'll it'll",
    "start": "1673120",
    "end": "1680799"
  },
  {
    "text": "basically just resign the messages for you so you put something in burp repeater and hit go and it'll resign the message and send it off so it it allows",
    "start": "1680799",
    "end": "1687640"
  },
  {
    "text": "you to uh uh put stuff in the like to make changes to the message and test for",
    "start": "1687640",
    "end": "1693399"
  },
  {
    "text": "some of these flaws interestingly though as we mentioned a lot of products either don't",
    "start": "1693399",
    "end": "1698919"
  },
  {
    "text": "care about the MDM signature header or if they do use it they don't always use it in all cases uh if you look hard",
    "start": "1698919",
    "end": "1707279"
  },
  {
    "text": "enough you'll probably be able to find in in most products at least one example of a message of this format it might not",
    "start": "1707279",
    "end": "1714600"
  },
  {
    "text": "be this particular one but uh that doesn't check the MDM signature header",
    "start": "1714600",
    "end": "1719679"
  },
  {
    "text": "or it does the processing on that data it'll process some of this data before it checks the MDM signature header so",
    "start": "1719679",
    "end": "1726279"
  },
  {
    "text": "even if your even if your header doesn't match you might still be able to get one of these injection attacks you might be",
    "start": "1726279",
    "end": "1732000"
  },
  {
    "text": "able to slip it in",
    "start": "1732000",
    "end": "1735600"
  },
  {
    "text": "and then there's uh flawed signature validation so what we we actually looked",
    "start": "1738399",
    "end": "1744120"
  },
  {
    "text": "at uh some of the products that were using this this MDM signature and",
    "start": "1744120",
    "end": "1749519"
  },
  {
    "text": "validating it um they they weren't always validating it properly uh there there are sometimes ways past it so for",
    "start": "1749519",
    "end": "1756919"
  },
  {
    "text": "example like horizontal privilege escalation vulnerabilities where you have uh you have a set of keys so you",
    "start": "1756919",
    "end": "1763600"
  },
  {
    "text": "have a device enrolled with MDM well what happens if you take here the udid and you point that at someone else's",
    "start": "1763600",
    "end": "1769679"
  },
  {
    "text": "device and uh send the message off what what's going to happen then does the product actually does it just check your",
    "start": "1769679",
    "end": "1776279"
  },
  {
    "text": "signature and see oh this is a valid signature for one of my users and then go ahead and run those run uh whatever",
    "start": "1776279",
    "end": "1782480"
  },
  {
    "text": "logic it runs based on the ud ID that you sent even though you like the you",
    "start": "1782480",
    "end": "1787640"
  },
  {
    "text": "are not enrolled with that UD ID someone else is uh that's one attack scenario another is actually just uh we saw",
    "start": "1787640",
    "end": "1794600"
  },
  {
    "text": "sometimes you can just sign messages with um it like you can just create your own CA and and just sign messages that",
    "start": "1794600",
    "end": "1801880"
  },
  {
    "text": "aren't uh signed by the the the uh vendor certificate and they're they're",
    "start": "1801880",
    "end": "1807519"
  },
  {
    "text": "not actually properly checking that so it's just like almost any any valid PK",
    "start": "1807519",
    "end": "1812640"
  },
  {
    "text": "pkcs7 signature that's all these are is just it's just PKS pkcs7 uh just",
    "start": "1812640",
    "end": "1818799"
  },
  {
    "text": "anything that's valid for the message body will slide through sometimes",
    "start": "1818799",
    "end": "1824679"
  },
  {
    "text": "um and that's that's what we were talking about there like some times sometimes they won't link the keys to",
    "start": "1824679",
    "end": "1830399"
  },
  {
    "text": "the user so you have you have the keys and it's not actually linked up to a specific account or uh they're not",
    "start": "1830399",
    "end": "1836399"
  },
  {
    "text": "they're not actually checking the the ca that issued these so a lot of these",
    "start": "1836399",
    "end": "1841519"
  },
  {
    "text": "issues are they're not specific to one vendor it's as you can see this message here uh this is just one example of one",
    "start": "1841519",
    "end": "1848320"
  },
  {
    "text": "of those messages that we talked about in the uh in the previous slide um but",
    "start": "1848320",
    "end": "1853720"
  },
  {
    "text": "these messages are standard and these are kind of specified by Apple Apple says what these messages should look",
    "start": "1853720",
    "end": "1859240"
  },
  {
    "text": "like uh what types of messages you can send and a lot of these problems are um",
    "start": "1859240",
    "end": "1865320"
  },
  {
    "text": "they're they're not vendor specific in that it's everyone's a lot of people are kind of making the same mistakes when they implement this protocol so even",
    "start": "1865320",
    "end": "1872120"
  },
  {
    "text": "though we're not we're not mentioning any vendor names uh it's it a part of that is also because a lot of this kind",
    "start": "1872120",
    "end": "1877440"
  },
  {
    "text": "of applies across different",
    "start": "1877440",
    "end": "1881080"
  },
  {
    "text": "products did you want to take it from here so getting a bit is this one back",
    "start": "1884120",
    "end": "1890159"
  },
  {
    "text": "on yet testing can we nope I don't think this",
    "start": "1890159",
    "end": "1898039"
  },
  {
    "text": "one's on yet you want to take mine yeah I think you're testing",
    "start": "1898039",
    "end": "1906880"
  },
  {
    "text": "nope my right",
    "start": "1912360",
    "end": "1917519"
  },
  {
    "text": "all right hopefully that's better so getting back around to what uh what all this actually means um taking a look at",
    "start": "1920399",
    "end": "1927039"
  },
  {
    "text": "some of these vulnerabilities and and putting them together uh things like the SQL injection uh that Steve was just",
    "start": "1927039",
    "end": "1932399"
  },
  {
    "text": "talking about uh along with some of the things like bypassing the the headers being able to uh to spoof the the MDM",
    "start": "1932399",
    "end": "1938760"
  },
  {
    "text": "signatures when you put all that together it basically spells remote code execution uh the ability to hit one of",
    "start": "1938760",
    "end": "1944840"
  },
  {
    "text": "these MDM servers from anywhere on the internet and just start running commands on it and you know get in and and grab",
    "start": "1944840",
    "end": "1951480"
  },
  {
    "text": "all the data domain credentials uh email whatever it is we want to get our hands on so so these are some pretty nasty",
    "start": "1951480",
    "end": "1958080"
  },
  {
    "text": "things we're talking about here and um trying to figure out a way around this we we put quite a bit of",
    "start": "1958080",
    "end": "1964639"
  },
  {
    "text": "thought into uh if somebody's a user of an MDM product what can they do to actually protect themselves from these",
    "start": "1964639",
    "end": "1971519"
  },
  {
    "text": "sorts of uh sorts of threats and unfortunately they kind of the big answer is wait for the vendor to patch",
    "start": "1971519",
    "end": "1977919"
  },
  {
    "text": "it um did I just go offline again I think I did is this one on it there we go so um",
    "start": "1977919",
    "end": "1986919"
  },
  {
    "text": "so it's the kind of thing that you just kind of have to wait for the vendors to patch these uh there's not really a whole lot that you can do on your own uh",
    "start": "1986919",
    "end": "1993399"
  },
  {
    "text": "we talked about things like oh what about just firewalling off the MDM server and of course that entirely",
    "start": "1993399",
    "end": "1998960"
  },
  {
    "text": "breaks MDM because in order for that thing to work it needs to be accessible from anywhere on the internet uh as we",
    "start": "1998960",
    "end": "2005080"
  },
  {
    "text": "saw with the the diagram of the regular routine communication it's the mobile device that's establishing the inbound connection to",
    "start": "2005080",
    "end": "2011320"
  },
  {
    "text": "the server to say hey do you have a message for me and we have no idea where our mobile devices are going to be it",
    "start": "2011320",
    "end": "2016760"
  },
  {
    "text": "could be at somebody's home network it could be at a Starbucks it could be on Verizon cellular network so we can't rely on just firewalling these things",
    "start": "2016760",
    "end": "2023320"
  },
  {
    "text": "off from the bad guys the way we normally do with the rest of our sensitive infrastructure that might have vulnerabilities in it so we're stuck we",
    "start": "2023320",
    "end": "2030320"
  },
  {
    "text": "have to keep this vulnerable piece of software out on the internet so we basically just have to rely on the",
    "start": "2030320",
    "end": "2035600"
  },
  {
    "text": "vendors for patches uh just about the only kind of Saving Grace that we thought might work there is something",
    "start": "2035600",
    "end": "2042200"
  },
  {
    "text": "like a web application firewall for some of the SQL injection but that would be kind of rough just trying to get a web",
    "start": "2042200",
    "end": "2048398"
  },
  {
    "text": "app firewall set up to be compatible with all of the things that MDM needs to use but it is something that might be",
    "start": "2048399",
    "end": "2054040"
  },
  {
    "text": "worth going down but that aside for today really what it comes down to for somebody who's using MDM or any other",
    "start": "2054040",
    "end": "2061480"
  },
  {
    "text": "security product out there bringing this back around to this kind of original concept of everything increases the attack surface is that um you have to",
    "start": "2061480",
    "end": "2069599"
  },
  {
    "text": "take a good hard look at what you've got out there and what you're deploying and why you're deploying it uh basically not",
    "start": "2069599",
    "end": "2076839"
  },
  {
    "text": "deploying anything unless there's a good business reason to do so and this isn't just security products this is",
    "start": "2076839",
    "end": "2082240"
  },
  {
    "text": "everything yeah you shouldn't just go out and grab whatever whizbang thing that seems neat throw it on the network expose it to the internet and wait for",
    "start": "2082240",
    "end": "2088320"
  },
  {
    "text": "somebody to hack into it uh security products you know if if you go out to the RSA show and and you see a vendor's",
    "start": "2088320",
    "end": "2094200"
  },
  {
    "text": "booth and it looks really cool and the demo is neat but you don't really have a practical need for this thing and you drop it on your network and nobody's",
    "start": "2094200",
    "end": "2101079"
  },
  {
    "text": "paying attention to it and nobody configures it and nobody patches it you're asking for trouble whether it's a security product or not so this is kind",
    "start": "2101079",
    "end": "2108160"
  },
  {
    "text": "of the first big thing is really sitting down and figuring out and this is something a lot of organizations don't really spend too much time on is",
    "start": "2108160",
    "end": "2114480"
  },
  {
    "text": "figuring out what you actually need and don't need and where it's appropriate to use these Technologies uh you know the",
    "start": "2114480",
    "end": "2120440"
  },
  {
    "text": "the big example on this with MDM that we're talking about here is let's say an organization does not have MDM and some",
    "start": "2120440",
    "end": "2127880"
  },
  {
    "text": "goes out and loses their mobile phone well then the person who picks that phone up has access to that person's",
    "start": "2127880",
    "end": "2134240"
  },
  {
    "text": "email and whatever other corporate resources that person had access to on the phone now if we go through a very",
    "start": "2134240",
    "end": "2140400"
  },
  {
    "text": "vulnerable MDM server out there facing the internet and somebody hacks into that they don't get one person's email",
    "start": "2140400",
    "end": "2146599"
  },
  {
    "text": "they get everyone's email everyone's domain credentials everyone's VPN access everyone's corporate data etc etc etc so",
    "start": "2146599",
    "end": "2154400"
  },
  {
    "text": "a vulnerable MDM server is more bad than a vulnerable mobile device without",
    "start": "2154400",
    "end": "2161280"
  },
  {
    "text": "MDM as long as the you know this type of vulnerability",
    "start": "2161280",
    "end": "2166559"
  },
  {
    "text": "exists and we also get into due diligence uh finding these vulnerabilities was not very tough uh",
    "start": "2166720",
    "end": "2173720"
  },
  {
    "text": "you know we mentioned that we originally came up with this whole concept while doing a pen test on some client systems and just kind of stumbled across these",
    "start": "2173720",
    "end": "2180800"
  },
  {
    "text": "as a way into their their uh their networks uh and onto their mobile devices and uh just this morning we were",
    "start": "2180800",
    "end": "2188040"
  },
  {
    "text": "sitting around between breakfast and this talk and the guys were actually testing one of the patches that a vendor",
    "start": "2188040",
    "end": "2193359"
  },
  {
    "text": "released and stumbled across another zero day vulnerability accidentally while trying to test one of the patches",
    "start": "2193359",
    "end": "2199720"
  },
  {
    "text": "so these things are not terribly difficult to find uh this is the kind of thing that if you're an organization",
    "start": "2199720",
    "end": "2205760"
  },
  {
    "text": "you're thinking about deploying MDM it would behoove you to get some of these products set them up ahead of time in a",
    "start": "2205760",
    "end": "2211839"
  },
  {
    "text": "in a controlled environment in a lab and maybe if you've got your own internal security team or if you have some pen",
    "start": "2211839",
    "end": "2217680"
  },
  {
    "text": "ation testers that you already work with take a shot at these things and just see how hard they are to actually break into",
    "start": "2217680",
    "end": "2223800"
  },
  {
    "text": "and see if there's any surprises there for you and again that's something we don't see a lot of organizations doing",
    "start": "2223800",
    "end": "2228839"
  },
  {
    "text": "they just buy things the vendor says oh yeah it's totally secure and it gets installed on the network on that promise",
    "start": "2228839",
    "end": "2235079"
  },
  {
    "text": "so uh it's it's worth taking a second look at a lot of these things and this isn't just MDM specific of",
    "start": "2235079",
    "end": "2241040"
  },
  {
    "text": "course and of course the proper care and feeding of these things uh once you get a product out on the network you know it",
    "start": "2241040",
    "end": "2247800"
  },
  {
    "text": "it's like Christmas when you get something new you open up the box and you want to play with it and you install it and you configure it and everything's all set up and then two or three years",
    "start": "2247800",
    "end": "2255240"
  },
  {
    "text": "later you realize that nobody's put security patches on it in six months to a year and the uh all these new features",
    "start": "2255240",
    "end": "2262760"
  },
  {
    "text": "came out that nobody's really changed the configuration settings and things might be more open than they need to be",
    "start": "2262760",
    "end": "2268480"
  },
  {
    "text": "and so it's the kind of thing that uh we definitely need to take a closer look at making sure that some once something's",
    "start": "2268480",
    "end": "2274480"
  },
  {
    "text": "deployed that we're doing the proper things to to keep up on it",
    "start": "2274480",
    "end": "2279440"
  },
  {
    "text": "and also doing real pen testing um this kind of goes in line with the other one that um you know much broader than just",
    "start": "2280800",
    "end": "2287400"
  },
  {
    "text": "a specific security product but um you know there's a lot of kind of pen tests out there that are really just",
    "start": "2287400",
    "end": "2293119"
  },
  {
    "text": "vulnerability scans let's look for any known cves and if there's none there we'll say that you're good and nobody",
    "start": "2293119",
    "end": "2299000"
  },
  {
    "text": "can hack into you and that's not necessarily the case if we as we've Dem demonstrated here that we were able to",
    "start": "2299000",
    "end": "2305880"
  },
  {
    "text": "in very short order go after one of our clients find some zero day vulnerabilities and break into the",
    "start": "2305880",
    "end": "2311240"
  },
  {
    "text": "network whereas somebody who's just looking for cve never would have stumbled across this stuff and wouldn't",
    "start": "2311240",
    "end": "2316640"
  },
  {
    "text": "have broken into that Network and so they're certainly not safe we know about the AP threats out there some of the",
    "start": "2316640",
    "end": "2322200"
  },
  {
    "text": "stuff that's coming from Eastern Europe all the fraud going on those guys are definitely not just looking for cve so",
    "start": "2322200",
    "end": "2328920"
  },
  {
    "text": "we shouldn't be either and then finally just looking across the organization at risk trying",
    "start": "2328920",
    "end": "2335280"
  },
  {
    "text": "to figure out you know this goes in hand with the the first point that if you're thinking about deploying MDM why are you",
    "start": "2335280",
    "end": "2341240"
  },
  {
    "text": "thinking about deploying it what is on these mobile devices that's so worth protecting and that can help guide your",
    "start": "2341240",
    "end": "2346800"
  },
  {
    "text": "decisions as to whether or not it's worth putting one of these products out there or whether you might be better off",
    "start": "2346800",
    "end": "2352079"
  },
  {
    "text": "just saying you know what this piece of information is too important maybe we're just better off not letting people",
    "start": "2352079",
    "end": "2357599"
  },
  {
    "text": "access this from a mobile device and move it somewhere else and avoid having these sorts of exposures to it uh and",
    "start": "2357599",
    "end": "2364160"
  },
  {
    "text": "again something that we don't see a lot of organizations doing we we run into to the the flat Network all too frequently",
    "start": "2364160",
    "end": "2369880"
  },
  {
    "text": "where it's just everybody has access to everything from everywhere and once somebody pokes one tiny little hole in",
    "start": "2369880",
    "end": "2375680"
  },
  {
    "text": "that Network and gets access whether it's through an MDM server or fishing a workstation or finding a mobile phone",
    "start": "2375680",
    "end": "2381480"
  },
  {
    "text": "sitting on the backseat of a taxi cab that's it you're done because the they're inside the perimeter and there's",
    "start": "2381480",
    "end": "2386680"
  },
  {
    "text": "no other Security in there to slow them down so we have to think about that as well is is looking at the data figuring",
    "start": "2386680",
    "end": "2392319"
  },
  {
    "text": "out what we should actually build a small Fortress around and keep separate from everything else",
    "start": "2392319",
    "end": "2398240"
  },
  {
    "text": "and then on the vendor side for the product vendors of course we've got some advice for them too because they're the only ones who can really fix the root",
    "start": "2398240",
    "end": "2404400"
  },
  {
    "text": "causes that are at the core of what we're talking about here today uh the big one is software development life",
    "start": "2404400",
    "end": "2409520"
  },
  {
    "text": "cycle you know we're talking about SQL injection it's 2014 why are we talking",
    "start": "2409520",
    "end": "2414599"
  },
  {
    "text": "about SQL injection go read oasp it's been in the top 10 for how long now so",
    "start": "2414599",
    "end": "2421160"
  },
  {
    "text": "so this is the kind of thing that you know your developers better be out there they better be aware of oasp they should",
    "start": "2421160",
    "end": "2426800"
  },
  {
    "text": "know how not to write these vulnerabilities your QA team should be looking for these vulnerabilities you",
    "start": "2426800",
    "end": "2432520"
  },
  {
    "text": "know it's kind of sad that it almost seems like the customers are the QA team that here we are pentesting people who",
    "start": "2432520",
    "end": "2438240"
  },
  {
    "text": "bought these products paid money for them and then here we are reporting the vulnerabilities back to the vendor that they already should have known about so",
    "start": "2438240",
    "end": "2445640"
  },
  {
    "text": "uh so it's making sure to to be on top of these things and actually look for them before pushing code out into the",
    "start": "2445640",
    "end": "2452680"
  },
  {
    "text": "wild and uh and of course not relying on security by obscurity which I fear is",
    "start": "2452680",
    "end": "2458040"
  },
  {
    "text": "kind of why a lot of these vulnerabilities snuck in here is that you look at these protocols and I I bet you there was some programmer somewhere",
    "start": "2458040",
    "end": "2464760"
  },
  {
    "text": "who said yeah well nobody's ever really going to take a look at these and and figure out how all this stuff works base",
    "start": "2464760",
    "end": "2470359"
  },
  {
    "text": "64 and code it that's good enough nobody you know it just looks like a jumble of data and the sad thing is for guys like",
    "start": "2470359",
    "end": "2476880"
  },
  {
    "text": "us and the bad guys out there it's actually probably quicker for us to reverse engineer one of these protocols",
    "start": "2476880",
    "end": "2482480"
  },
  {
    "text": "than it is for somebody else to sit down and write it so you know it's just a matter of pulling it up and proxy and",
    "start": "2482480",
    "end": "2488240"
  },
  {
    "text": "looking at it and flipping some switches and see what it all does so you can't rely on that you can't just rely on the",
    "start": "2488240",
    "end": "2494040"
  },
  {
    "text": "fact that oh it's our own obscure binary protocol somebody will figure it out if you can create it somebody can reverse",
    "start": "2494040",
    "end": "2499560"
  },
  {
    "text": "engineer it and then finally authenticating everything yeah we saw this where we've",
    "start": "2499560",
    "end": "2505960"
  },
  {
    "text": "got all these packets going back and forth across the network with MDM signature headers and all sorts of other",
    "start": "2505960",
    "end": "2511480"
  },
  {
    "text": "things that look authentication going on in these packets and nobody's actually checking them nobody's making making",
    "start": "2511480",
    "end": "2517440"
  },
  {
    "text": "sure that they line up with what they're supposed to be and that the certificates are the right certificates and that the",
    "start": "2517440",
    "end": "2522560"
  },
  {
    "text": "signatures are actually valid for whatever the data is so yeah we need to actually use all those authentication",
    "start": "2522560",
    "end": "2529560"
  },
  {
    "text": "mechanisms and make sure that every single packet every communication that comes in is checked in some sane way to",
    "start": "2529560",
    "end": "2536480"
  },
  {
    "text": "make sure that somebody's not out there impersonating a user causing some other kind of trouble um do you have anything",
    "start": "2536480",
    "end": "2541920"
  },
  {
    "text": "else to fill in or no I don't think so all right so so uh so that's it uh",
    "start": "2541920",
    "end": "2549359"
  },
  {
    "text": "Q&A time um I know you won't name vendors",
    "start": "2549359",
    "end": "2557119"
  },
  {
    "text": "but um there's one vendor you didn't name which was Apple you talk about obscurity",
    "start": "2557119",
    "end": "2562520"
  },
  {
    "text": "through you know the challenge here is that they put a protocol out and then they left it to a whole bunch of vendors",
    "start": "2562520",
    "end": "2567760"
  },
  {
    "text": "to implement it with no certification process really no validation um so who",
    "start": "2567760",
    "end": "2573720"
  },
  {
    "text": "is going to do that job because you know you know about the iron hack from a month ago where they got to the",
    "start": "2573720",
    "end": "2579000"
  },
  {
    "text": "insurance company Y and the vendor says well it's not our fault it was their server but the problem is there's too many layers and too many chains and even",
    "start": "2579000",
    "end": "2585520"
  },
  {
    "text": "your presentation theoretically violates Apple's guidelines cuz you're discussing",
    "start": "2585520",
    "end": "2590960"
  },
  {
    "text": "their protocol right yeah so how do we deal with that issue in general so the the issues we found here really aren't",
    "start": "2590960",
    "end": "2596880"
  },
  {
    "text": "issues in Apple's API itself um it it does seem that from what we've seen at least you know and we didn't dig into",
    "start": "2596880",
    "end": "2602760"
  },
  {
    "text": "that in too much detail it does seem that somebody could sit down and write an MDM solution that is fairly as secure",
    "start": "2602760",
    "end": "2610400"
  },
  {
    "text": "as you can get it using Apple's MDM protocol it's just the vendors that are slapping their custom code on top um I I",
    "start": "2610400",
    "end": "2617240"
  },
  {
    "text": "can't imagine Apple ever saying that they're going to take responsibility for going through and and validating that",
    "start": "2617240",
    "end": "2623359"
  },
  {
    "text": "everybody's code isn't doing something stupid so it's really up to I would say the users the the purchasers of these",
    "start": "2623359",
    "end": "2630040"
  },
  {
    "text": "products to hold the vendors accountable and say hey we're we're going to test your product before we install it and",
    "start": "2630040",
    "end": "2635640"
  },
  {
    "text": "we're not going to buy it if it's full of I I don't really see any other way around that",
    "start": "2635640",
    "end": "2641119"
  },
  {
    "text": "there there are there are a few things that are a bit of an exception to that like the the protocol the fact that it",
    "start": "2641119",
    "end": "2648040"
  },
  {
    "text": "allows for uh messages to go through unencrypted like those uh those payload",
    "start": "2648040",
    "end": "2653680"
  },
  {
    "text": "messages there's really no reason for them not to be encrypted so the protocol just shouldn't allow that like the device just shouldn't shouldn't do it uh",
    "start": "2653680",
    "end": "2661319"
  },
  {
    "text": "the fact that it allows for messages without that MDM signature header that's like there's no reason really for that to be an optional field um th those",
    "start": "2661319",
    "end": "2668200"
  },
  {
    "text": "things are on Apple's end but the really nasty stuff like the the SQL injection",
    "start": "2668200",
    "end": "2673520"
  },
  {
    "text": "uh I mean that's just like you have this MDM server it by definition has to be exposed to the internet at this end",
    "start": "2673520",
    "end": "2679079"
  },
  {
    "text": "point and there's SQL injection right in like the the main field so uh that stuff",
    "start": "2679079",
    "end": "2684520"
  },
  {
    "text": "is really the vendors the vendor issue they they just shouldn't have done",
    "start": "2684520",
    "end": "2689640"
  },
  {
    "text": "that did uh you guys see any differences between like Cloud Solutions versus on",
    "start": "2689960",
    "end": "2696319"
  },
  {
    "text": "Prim Solutions as far as attacks go yeah so we tested a few of these things and",
    "start": "2696319",
    "end": "2704000"
  },
  {
    "text": "some of them were the cloud Solutions but unfortunately we couldn't really uh take too many shots at the cloud",
    "start": "2704000",
    "end": "2709400"
  },
  {
    "text": "Solutions because we don't own them and we didn't have permission to so",
    "start": "2709400",
    "end": "2714599"
  },
  {
    "text": "uh I mean these issues obviously could very well be resident in the cloud",
    "start": "2714599",
    "end": "2719760"
  },
  {
    "text": "Solutions but we didn't get to really uh to do it so if you work for the Cloud",
    "start": "2719760",
    "end": "2725559"
  },
  {
    "text": "solution you can go try this uh hi you recommended that uh companies",
    "start": "2725559",
    "end": "2732480"
  },
  {
    "text": "uh do some penting and find some zero days in the product they bought uh how do you handle the fact that U some of",
    "start": "2732480",
    "end": "2739520"
  },
  {
    "text": "the vendors will prevent you from doing reverse engineering in the the legal agreement or come after you if you",
    "start": "2739520",
    "end": "2746480"
  },
  {
    "text": "disclose the the findings uh to them after that did you catch that missed",
    "start": "2746480",
    "end": "2752520"
  },
  {
    "text": "could could you repeat I missed some of that uh how do you handle the fact that uh if you find some zero days in some",
    "start": "2752520",
    "end": "2758119"
  },
  {
    "text": "products some of the vend the vendors uh will come back uh after you uh on these",
    "start": "2758119",
    "end": "2763680"
  },
  {
    "text": "issues or they will um um use the legal agreement in the when you purchase the",
    "start": "2763680",
    "end": "2770240"
  },
  {
    "text": "product uh against you so I think you're asking about like",
    "start": "2770240",
    "end": "2776400"
  },
  {
    "text": "disclosure like we yeah so we we disclosed all these vulnerabilities and",
    "start": "2776400",
    "end": "2781520"
  },
  {
    "text": "well before the the talk here um it's just been a really slow process back in",
    "start": "2781520",
    "end": "2786960"
  },
  {
    "text": "and forth with some of these vendors uh some of the vendors we we would disclose the vulnerability and they say they",
    "start": "2786960",
    "end": "2793599"
  },
  {
    "text": "would say they would issue a patch and say they fixed it and then it wasn't actually fixed or there were like five more instance of it somewhere else so uh",
    "start": "2793599",
    "end": "2801079"
  },
  {
    "text": "that's really why we didn't drop any vendor names here because some vendors were definitely worse than others yeah",
    "start": "2801079",
    "end": "2806640"
  },
  {
    "text": "the the other thing on there is um you know this kind of comes back to the point about the the difficulties we had",
    "start": "2806640",
    "end": "2812359"
  },
  {
    "text": "in testing some of these products that the vendors wouldn't give us demos there's there's just easy demo packages",
    "start": "2812359",
    "end": "2818319"
  },
  {
    "text": "out there available to use so as a as a purchaser of an MDM platform it may be",
    "start": "2818319",
    "end": "2824640"
  },
  {
    "text": "tough to go out and and get the vendor to actually like give you something to test or or have somebody run through you",
    "start": "2824640",
    "end": "2829760"
  },
  {
    "text": "know proof of concept and that's something that that again really it just comes down to putting pressure on the",
    "start": "2829760",
    "end": "2834960"
  },
  {
    "text": "sales guy who's trying to sell you an MDM product and say hey well we're not going to buy anything unless we get to test it so do you want to make a sale or",
    "start": "2834960",
    "end": "2842440"
  },
  {
    "text": "not and see what they say like some some of the vendors we worked with it was really one particular vendor it was",
    "start": "2842440",
    "end": "2848559"
  },
  {
    "text": "extremely difficult to get a trial for their software and it's it's almost like they were using that as a security measure like hey no one can really test",
    "start": "2848559",
    "end": "2854920"
  },
  {
    "text": "this CU we don't give it away but a few uh a few Google dorks and you can",
    "start": "2854920",
    "end": "2859960"
  },
  {
    "text": "probably find a zip file somewhere that has it in a backup like it's not it's definitely not a security",
    "start": "2859960",
    "end": "2867599"
  },
  {
    "text": "measure anybody else going once going twice all right thank you",
    "start": "2871000",
    "end": "2876970"
  },
  {
    "text": "[Applause]",
    "start": "2876970",
    "end": "2886019"
  }
]