[
  {
    "start": "0",
    "end": "47000"
  },
  {
    "text": "you are currently in the defense track and we are here to listen to intrusion detection along the",
    "start": "80",
    "end": "6640"
  },
  {
    "text": "kill chain presented by [Applause]",
    "start": "6640",
    "end": "14590"
  },
  {
    "text": "four hello test test one can you guys hear me all right all right thanks for",
    "start": "16960",
    "end": "22400"
  },
  {
    "text": "coming welcome um it's really good to be here and I appreciate you guys uh crowding in for me um we're going to",
    "start": "22400",
    "end": "29519"
  },
  {
    "text": "have fun today this is this is going to be something um I think you'll enjoy I hope um if any of you guys do U defense",
    "start": "29519",
    "end": "36920"
  },
  {
    "text": "and try to prevent people from breaking into organizations at Tech when they do uh that's what we're here to talk about",
    "start": "36920",
    "end": "42239"
  },
  {
    "text": "so uh hopefully uh you'll enjoy our time together I think you will so let's get",
    "start": "42239",
    "end": "48719"
  },
  {
    "start": "47000",
    "end": "87000"
  },
  {
    "text": "started so who am I this is probably the least interesting part but my name is",
    "start": "48719",
    "end": "54199"
  },
  {
    "text": "four I work at Facebook with a really awesome uh Team of very very smart",
    "start": "54199",
    "end": "59320"
  },
  {
    "text": "people uh that care a lot about our users's data and I do intrusion detection stuff",
    "start": "59320",
    "end": "67759"
  },
  {
    "text": "and I've been doing intrusion detection stuff for quite a while uh for a lot longer than I probably look",
    "start": "67759",
    "end": "75400"
  },
  {
    "text": "uh um in in fact it's possible that I've spent the majority of my adult life uh",
    "start": "75400",
    "end": "81200"
  },
  {
    "text": "my conscious adult life thinking about intrusion detection uh and that's not that's not",
    "start": "81200",
    "end": "86720"
  },
  {
    "text": "actually uh it's not actually joking so so this Talk's a little bit different I",
    "start": "86720",
    "end": "92000"
  },
  {
    "start": "87000",
    "end": "147000"
  },
  {
    "text": "know you guys have been going to a bunch of talks here at black hat I really appreciate you guys appreciate you guys coming to mind um we're going to do",
    "start": "92000",
    "end": "98000"
  },
  {
    "text": "things a little different here you know when I think back about what I like best about black hat talks you know there's a",
    "start": "98000",
    "end": "103840"
  },
  {
    "text": "lot of really good talks about some OD days and some really great technical talks and um you know we're definitely",
    "start": "103840",
    "end": "109640"
  },
  {
    "text": "going to cover a lot of technical content but when I think back about what I I really take away most from those things is I come up with a b a bunch of",
    "start": "109640",
    "end": "116320"
  },
  {
    "text": "ideas and I get really excited about stuff right and so this talk is actually designed with that in mind to try to get",
    "start": "116320",
    "end": "123240"
  },
  {
    "text": "you know I'm going to present some technical ideas but I also want to get you guys excited and I want to get you",
    "start": "123240",
    "end": "128440"
  },
  {
    "text": "guys thinking about this problem and working with me on this problem and so as such you know if you come away with",
    "start": "128440",
    "end": "134560"
  },
  {
    "text": "with it with you know with none of the technical content in your mind but excited and some new ideas of your own",
    "start": "134560",
    "end": "140360"
  },
  {
    "text": "then I will consider this mission accomplished um so if you come away yeah with just one idea uh I think that would",
    "start": "140360",
    "end": "148519"
  },
  {
    "start": "147000",
    "end": "178000"
  },
  {
    "text": "be worthwhile okay okay so this is a story in three acts um kind of like a a",
    "start": "148519",
    "end": "154680"
  },
  {
    "text": "Shakespearean tragedy not too different in fact uh with the act one we're going to talk a",
    "start": "154680",
    "end": "160480"
  },
  {
    "text": "little bit about where intrusion detection stands today right um how I",
    "start": "160480",
    "end": "165840"
  },
  {
    "text": "mean do you guys have how many of you guys have worked on intrusion detection or related Technologies right like the",
    "start": "165840",
    "end": "171400"
  },
  {
    "text": "majority of you okay thank you for for that so this is clearly something of Interest so let's talk a little bit",
    "start": "171400",
    "end": "178040"
  },
  {
    "start": "178000",
    "end": "225000"
  },
  {
    "text": "about where we're at now the security industry is estimated",
    "start": "178040",
    "end": "184400"
  },
  {
    "text": "roughly these things are hard to estimate but roughly at about a $35 billion a year industry $35 billion a",
    "start": "184400",
    "end": "191319"
  },
  {
    "text": "year the amount of money spent on um intrusion detection is likewise quite",
    "start": "191319",
    "end": "197280"
  },
  {
    "text": "high but also a little bit hard to pin down so according to IDC which is a research company they' they they say",
    "start": "197280",
    "end": "204239"
  },
  {
    "text": "that the sem Market alone is a $ 1.5 billion a year industry just the s",
    "start": "204239",
    "end": "209959"
  },
  {
    "text": "Market alone and so I think it's pretty clear even if it's hard to pin down the exact numbers",
    "start": "209959",
    "end": "217159"
  },
  {
    "text": "that intrusion detection is something we're spending a fair bit of money on and so the natural question for all of",
    "start": "217159",
    "end": "222840"
  },
  {
    "text": "us to ask ourselves is how well are these systems working for us right we got the shiny",
    "start": "222840",
    "end": "229120"
  },
  {
    "start": "225000",
    "end": "238000"
  },
  {
    "text": "Red Box you know on the rack it's like it's got not just one ethernet but three",
    "start": "229120",
    "end": "234239"
  },
  {
    "text": "connected to it so it's got to do something awesome right so let's talk a little bit about how",
    "start": "234239",
    "end": "240360"
  },
  {
    "start": "238000",
    "end": "315000"
  },
  {
    "text": "well these systems work so there's a couple of companies that do a really good thing for all of us and they and",
    "start": "240360",
    "end": "246640"
  },
  {
    "text": "these these companies actually produce these things that are that are these kind of reports these analytical reports",
    "start": "246640",
    "end": "252200"
  },
  {
    "text": "about the state of the industry now the most vulnerable of",
    "start": "252200",
    "end": "257280"
  },
  {
    "text": "these is is Verizon's data breach report and this has been out for several years now how many you guys have heard",
    "start": "257280",
    "end": "263440"
  },
  {
    "text": "of this report the Verizon data be oh okay cool so like most everybody awesome how many guys have actually read the",
    "start": "263440",
    "end": "269240"
  },
  {
    "text": "report from from cover to cover Okay cool so the most recent Verizon report is uh is awesome it's uh",
    "start": "269240",
    "end": "277800"
  },
  {
    "text": "you know got more data than ever it covers 855 uh cases it has uh data from not",
    "start": "277800",
    "end": "285280"
  },
  {
    "text": "just Verizon's incident response work which which in and of itself by the way covers a pretty broad swath of of",
    "start": "285280",
    "end": "291639"
  },
  {
    "text": "incidents right but it also includes a bunch of law enforcement data and over the years they've actually added to that",
    "start": "291639",
    "end": "297440"
  },
  {
    "text": "increasingly so they've got now not just secret service but they've got you know some foreign uh law enforcement agencies",
    "start": "297440",
    "end": "303880"
  },
  {
    "text": "involved so it's this pretty pretty decent story you know report that that covers a lot of the bases as far as",
    "start": "303880",
    "end": "310280"
  },
  {
    "text": "intrusions go now let's take a look at what they have to say about intrusion",
    "start": "310280",
    "end": "315560"
  },
  {
    "start": "315000",
    "end": "448000"
  },
  {
    "text": "detections efficacy so we'll start a little slow but just",
    "start": "315560",
    "end": "321240"
  },
  {
    "text": "kind of go through the data so the first thing that I noticed when I was reading the report was that",
    "start": "321240",
    "end": "326960"
  },
  {
    "text": "seven out of 10 targeted attacks happen against larger organiz ation this is probably not super",
    "start": "326960",
    "end": "332199"
  },
  {
    "text": "surprising right targeted attacks clearly are going to go after these larger orgs larger orgs by the way",
    "start": "332199",
    "end": "337880"
  },
  {
    "text": "Verizon defines as over a thousand employees so okay that's maybe not super",
    "start": "337880",
    "end": "343840"
  },
  {
    "text": "exciting but the interesting thing about that is you would expect that these larger orgs would be more likely to have",
    "start": "343840",
    "end": "349000"
  },
  {
    "text": "invested in intrusion detection systems of some kind right so now the data is starting to",
    "start": "349000",
    "end": "355000"
  },
  {
    "text": "look a little bit more interesting half of these intrusions that these various uh groups looked at",
    "start": "355000",
    "end": "362400"
  },
  {
    "text": "took months or years for them to discover now I think Discovery time is",
    "start": "362400",
    "end": "368360"
  },
  {
    "text": "one proxy maybe not the best proxy but one proxy for the efficacy of intrusion detection systems months or years to",
    "start": "368360",
    "end": "375880"
  },
  {
    "text": "discover an intrusion right that's it's kind of a long time don't you think H okay what",
    "start": "375880",
    "end": "384440"
  },
  {
    "text": "else do we have to say well it took months or years to discover the intrusion but in fact the attackers",
    "start": "384440",
    "end": "391880"
  },
  {
    "text": "compromised Us in minutes or less according to the report at least 71% of the",
    "start": "391880",
    "end": "397319"
  },
  {
    "text": "time okay that's not good this one's kind of a positive note",
    "start": "397319",
    "end": "403840"
  },
  {
    "text": "right so 75% of the time it took days or longer to exfiltrate data in larger",
    "start": "403840",
    "end": "409440"
  },
  {
    "text": "organizations so this is kind of cool this is one like sort of beam of light in an otherwise dark place right which",
    "start": "409440",
    "end": "416520"
  },
  {
    "text": "is that once they compromise you they do it pretty quickly but then they have to Rifle around in your drawers in order to figure out what",
    "start": "416520",
    "end": "423560"
  },
  {
    "text": "they're actually getting at uh what they're what they're looking for what accounts they want to escalate to and what data they're actually after right",
    "start": "423560",
    "end": "430120"
  },
  {
    "text": "so I just th put this kind of as a footnote right but but this is kind of cool so we have days or longer to of",
    "start": "430120",
    "end": "437800"
  },
  {
    "text": "them doing all kinds of stuff in order to detect them so when we get to the the the other acts of the play we're going",
    "start": "437800",
    "end": "444520"
  },
  {
    "text": "to we're going to see how we might be able to take that and use that to our advantage okay let's let's keep talking",
    "start": "444520",
    "end": "450879"
  },
  {
    "start": "448000",
    "end": "549000"
  },
  {
    "text": "about Verizon just a little bit more so the first thing of note is that",
    "start": "450879",
    "end": "457840"
  },
  {
    "text": "how do these things get discovered how do you find out about an intrusion so this is getting to the",
    "start": "457840",
    "end": "464120"
  },
  {
    "text": "heart of the matter right the the the very meat of the story these intrusions",
    "start": "464120",
    "end": "470240"
  },
  {
    "text": "get discovered most of the time by somebody else telling you at most",
    "start": "470240",
    "end": "477520"
  },
  {
    "text": "companies right half of them okay that doesn't sound too",
    "start": "477520",
    "end": "484319"
  },
  {
    "text": "bad for a larger or you know half of them discovered by a third party well that means right the other half detected by our intrusion detection Appliance",
    "start": "484319",
    "end": "492080"
  },
  {
    "text": "right uh no actually not so much so a",
    "start": "492080",
    "end": "498120"
  },
  {
    "text": "third of these detections are detected by your users saying",
    "start": "498120",
    "end": "503919"
  },
  {
    "text": "this right hey something's weird right something is up I assist admin notic",
    "start": "503919",
    "end": "509639"
  },
  {
    "text": "that there's a weird process running on their server that's not normal or a user that uh have a mouse cursor you guys",
    "start": "509639",
    "end": "517080"
  },
  {
    "text": "ever seen this where there's like a user and there's like a mouse cursor moving around and they're like oh I'm under attack so turns out some of the time",
    "start": "517080",
    "end": "524200"
  },
  {
    "text": "that's actually real um uh I actually had a real case once",
    "start": "524200",
    "end": "531839"
  },
  {
    "text": "where somebody uh had a wireless mouse and they were right next to An Elevator Shaft and every time the elevator went up and down their mouse cursor would",
    "start": "531839",
    "end": "537600"
  },
  {
    "text": "move and they thought it was an attacker anyway uh okay so all right so so the",
    "start": "537600",
    "end": "544240"
  },
  {
    "text": "story is starting to sound maybe not quite so Rosy",
    "start": "544240",
    "end": "549519"
  },
  {
    "start": "549000",
    "end": "642000"
  },
  {
    "text": "right purpose-built fraud detection systems classified by Verizon which is a",
    "start": "549519",
    "end": "555720"
  },
  {
    "text": "proxy for intrusion detection systems detected 5% 5% of of of the attacks that these",
    "start": "555720",
    "end": "563440"
  },
  {
    "text": "that this case load looked at 5% now how do you contrast that how do",
    "start": "563440",
    "end": "569079"
  },
  {
    "text": "we comp that well routine log review discovered 8% of",
    "start": "569079",
    "end": "576560"
  },
  {
    "text": "intrusions so my my shiny intrusion detection system against these targeted",
    "start": "576560",
    "end": "583360"
  },
  {
    "text": "threats uh or against all threats really Verizon Verizon covers all threats is is",
    "start": "583360",
    "end": "589440"
  },
  {
    "text": "worse than than a bunch of people sitting in a room looking at logs right if like I take random",
    "start": "589440",
    "end": "596160"
  },
  {
    "text": "samplings of you and have you look at my logs is that that's better according to the data than than an intrusion",
    "start": "596160",
    "end": "601480"
  },
  {
    "text": "detection system I mean that's pretty bad so so what do we have here we have",
    "start": "601480",
    "end": "607079"
  },
  {
    "text": "we have a case where routine log review is better than intrusion detection systems",
    "start": "607079",
    "end": "612279"
  },
  {
    "text": "and uh that we have a Sixx um six times",
    "start": "612279",
    "end": "618000"
  },
  {
    "text": "worse than a user noticing something is weird is is how good our intrusion detection system",
    "start": "618000",
    "end": "624560"
  },
  {
    "text": "is all right you might say well you know that's just one report he",
    "start": "624560",
    "end": "629839"
  },
  {
    "text": "you know that's got to be crazy right what I say is Houston we have a",
    "start": "629839",
    "end": "638600"
  },
  {
    "text": "problem okay let's so so so hold on all right it's just one report no big deal",
    "start": "638600",
    "end": "646279"
  },
  {
    "start": "642000",
    "end": "704000"
  },
  {
    "text": "right let's see what else we got let's look at some other data Maybe This is a off okay well there's another report out",
    "start": "646279",
    "end": "653160"
  },
  {
    "text": "there I mean I'm sure there's a bunch of reports I'm not going to be able to talk about all of them but another one that I I like is this is is one by a company",
    "start": "653160",
    "end": "658920"
  },
  {
    "text": "called they don't just throw parties where you get drunk at the shadow bar turns out",
    "start": "658920",
    "end": "664079"
  },
  {
    "text": "they actually do reports too um I actually I love mandant uh they're they're awesome um but they they have an",
    "start": "664079",
    "end": "671399"
  },
  {
    "text": "annual report as well and in their most recent report uh so so just a little background on Mandan how you guys",
    "start": "671399",
    "end": "677639"
  },
  {
    "text": "probably mostly know a little bit about mandant but just so you know their their report and their work is a little bit",
    "start": "677639",
    "end": "682720"
  },
  {
    "text": "more narrow than Verizon's report covers because it's actually more focused on the so-called AP the so-called targeted",
    "start": "682720",
    "end": "688040"
  },
  {
    "text": "attacks right and so the data is a little bit more skewed oh like Verizon's is a little bit more General whereas",
    "start": "688040",
    "end": "694480"
  },
  {
    "text": "mandant data is a little bit more specialized okay how well do you think",
    "start": "694480",
    "end": "699839"
  },
  {
    "text": "uh our intrusion detection systems do in Mandan",
    "start": "699839",
    "end": "704880"
  },
  {
    "start": "704000",
    "end": "750000"
  },
  {
    "text": "report well 6% of advanced Inus intrusions were detected by an internal",
    "start": "704880",
    "end": "710399"
  },
  {
    "text": "process 6% and guess what an internal process is",
    "start": "710399",
    "end": "715680"
  },
  {
    "text": "not as we learned in the last couple slides an intrusion detection system",
    "start": "715680",
    "end": "720920"
  },
  {
    "text": "right it could be manual log review it could be your users noticing something's weird right six% and in re in reality I",
    "start": "720920",
    "end": "729440"
  },
  {
    "text": "would surmise that in fact a small fraction of that is actually what was detected by an intrusion detection",
    "start": "729440",
    "end": "737680"
  },
  {
    "text": "system so now we have two corroborating data sources and to that I say Houston we",
    "start": "737720",
    "end": "744720"
  },
  {
    "text": "really have a problem",
    "start": "744720",
    "end": "748240"
  },
  {
    "start": "750000",
    "end": "814000"
  },
  {
    "text": "so all right some people sort of like climate",
    "start": "751600",
    "end": "756680"
  },
  {
    "text": "change may say Hey you know you're you're making up numbers or these these numbers are wrong right but the number",
    "start": "756680",
    "end": "763720"
  },
  {
    "text": "of you that rose that raised your hands makes me believe that you guys agree with me that you know what I'm talking",
    "start": "763720",
    "end": "769760"
  },
  {
    "text": "about that you know that these numbers aren't just fabricated numbers that this actually aligns with our intuition in",
    "start": "769760",
    "end": "775199"
  },
  {
    "text": "our experience to the extent that you have that experience against especially Advanced attacks our intrusion detection",
    "start": "775199",
    "end": "782440"
  },
  {
    "text": "systems are not working they're pathetic it's sad and if somebody like",
    "start": "782440",
    "end": "790399"
  },
  {
    "text": "me who cares very deeply about intrusion detection it's alarming in fact to have reached this place in the history of",
    "start": "790399",
    "end": "797480"
  },
  {
    "text": "computer security so alarming in fact that I actually quit the field of information security altogether for a",
    "start": "797480",
    "end": "803360"
  },
  {
    "text": "brief amount of time uh because I was so distraught",
    "start": "803360",
    "end": "809240"
  },
  {
    "text": "so that's part one the state of where we are with intrusion",
    "start": "810199",
    "end": "815839"
  },
  {
    "start": "814000",
    "end": "826000"
  },
  {
    "text": "detection now what can we do well let's start with first",
    "start": "815839",
    "end": "822480"
  },
  {
    "text": "principles let's start with what intrusion detection is all about what are we trying to accomplish with",
    "start": "822480",
    "end": "828320"
  },
  {
    "start": "826000",
    "end": "878000"
  },
  {
    "text": "intrusion detection well like all good first principles let's start with a definition this is my my definition I'm",
    "start": "828320",
    "end": "835680"
  },
  {
    "text": "sure yours is probably different but this one has served me well um the Art and Science of finding",
    "start": "835680",
    "end": "841440"
  },
  {
    "text": "actionable deviations between normal behavior and attacker Behavior fundamentally when you think about it",
    "start": "841440",
    "end": "846519"
  },
  {
    "text": "down to the core what you're doing in intrusion detection is you're separating the attacker from the",
    "start": "846519",
    "end": "852639"
  },
  {
    "text": "user it's like a centrifuge",
    "start": "852639",
    "end": "858839"
  },
  {
    "text": "right perhaps this this definition Rings more true now that we're in Vegas but this is perhaps a more concise way to uh",
    "start": "860959",
    "end": "868720"
  },
  {
    "text": "to diges this right and this definition is going to carry us forward into one of",
    "start": "868720",
    "end": "874000"
  },
  {
    "text": "my first principles that I think you need to really internalize and that's",
    "start": "874000",
    "end": "881839"
  },
  {
    "start": "878000",
    "end": "932000"
  },
  {
    "text": "this intrusion detection events are not binary Affairs this is the single",
    "start": "881880",
    "end": "887720"
  },
  {
    "text": "biggest mistake that pretty much everybody makes tell me if this sounds",
    "start": "887720",
    "end": "893519"
  },
  {
    "text": "familiar you plug in an intrusion detection system and you go through a process of tuning right right let's say",
    "start": "893519",
    "end": "899480"
  },
  {
    "text": "a nids a snort box or something like that you go through a process of tuning what does tuning involve well you turn",
    "start": "899480",
    "end": "905639"
  },
  {
    "text": "it on it creates a bunch of alerts and you turn them all off until it doesn't make any noise anymore",
    "start": "905639",
    "end": "912399"
  },
  {
    "text": "right you're laughing but it's true right this is what people do I'm not I'm not actually making this up right so",
    "start": "912399",
    "end": "919199"
  },
  {
    "text": "they turn every single thing off and then there's no alerts and then they say okay peace everything that happens after",
    "start": "919199",
    "end": "924600"
  },
  {
    "text": "this is going to be the attacker right",
    "start": "924600",
    "end": "930160"
  },
  {
    "start": "932000",
    "end": "996000"
  },
  {
    "text": "well this is what I call the false positive [Laughter]",
    "start": "932160",
    "end": "941199"
  },
  {
    "text": "fallacy the notion that things that create spirous events are of no use are of no value the",
    "start": "941199",
    "end": "951319"
  },
  {
    "text": "reality is that these noisy events that sometimes indicate false positive things",
    "start": "951319",
    "end": "957519"
  },
  {
    "text": "and sometime sometimes indicate attacker Behavior are in fact the most uh important thing in our Arsenal and these",
    "start": "957519",
    "end": "963959"
  },
  {
    "text": "are heavily underutilized it's sad what most people",
    "start": "963959",
    "end": "969319"
  },
  {
    "text": "want is a is a is a event that can you know email them to some mailing list and",
    "start": "969319",
    "end": "975040"
  },
  {
    "text": "Page them or whatever wake them up in the middle of the night you're owned right that's what everybody wants and so",
    "start": "975040",
    "end": "980880"
  },
  {
    "text": "everybody diligently goes and creates a bunch of events and you know they create a bunch of noise and then they turn them",
    "start": "980880",
    "end": "986279"
  },
  {
    "text": "off or you know once in a blue moon they alert and then everybody freaks out so everybody is after this mythical",
    "start": "986279",
    "end": "995600"
  },
  {
    "text": "event that will wake you up in the middle of the night",
    "start": "995600",
    "end": "1002279"
  },
  {
    "start": "996000",
    "end": "1036000"
  },
  {
    "text": "and tell you your own the reality is much more subtle",
    "start": "1002279",
    "end": "1007519"
  },
  {
    "text": "maybe there was one time in history in computer science and computer information security where you could do",
    "start": "1007519",
    "end": "1012680"
  },
  {
    "text": "that where you could create an event that would email you on some mailing list and would tell you your own",
    "start": "1012680",
    "end": "1020440"
  },
  {
    "text": "maybe but that day is not now that doesn't work against modern attackers we",
    "start": "1020440",
    "end": "1025798"
  },
  {
    "text": "need a more subtle approach we need a way to assimilate these noisy signals",
    "start": "1025799",
    "end": "1031720"
  },
  {
    "text": "into our Enterprise into our infrastructure and I'm going to tell you how to do this so the first thing I want",
    "start": "1031720",
    "end": "1037798"
  },
  {
    "start": "1036000",
    "end": "1079000"
  },
  {
    "text": "you to take away from this talk is the notion that all events are welcome that there is no such thing as a noisy",
    "start": "1037799",
    "end": "1044839"
  },
  {
    "text": "event right and so what I'm going to do right now is go through a process where",
    "start": "1044839",
    "end": "1050280"
  },
  {
    "text": "imagine you have this this landscape of events a landscape of things that can tell you that somebody's compromising",
    "start": "1050280",
    "end": "1055840"
  },
  {
    "text": "you that there's something suspicious going on and imagine if you have that landscape and that you want to rank",
    "start": "1055840",
    "end": "1061080"
  },
  {
    "text": "those things from a from let's say 1 to 10 okay so that one means you're owned",
    "start": "1061080",
    "end": "1066760"
  },
  {
    "text": "and 10 means nothing and in between from between nine and two are things that",
    "start": "1066760",
    "end": "1074080"
  },
  {
    "text": "have something to tell you about something suspicious going on right",
    "start": "1074080",
    "end": "1080320"
  },
  {
    "start": "1079000",
    "end": "1096000"
  },
  {
    "text": "okay so I'm going to go through a list of what I came up with these are some random examples you will have your own",
    "start": "1080320",
    "end": "1086240"
  },
  {
    "text": "of things that I think are representative of those levels on the noise on the noise graph on the no on",
    "start": "1086240",
    "end": "1092400"
  },
  {
    "text": "the noise uh number so number one being the the the most actionable is is this and this is",
    "start": "1092400",
    "end": "1099280"
  },
  {
    "start": "1096000",
    "end": "1198000"
  },
  {
    "text": "another concept that I think you've heard before this this idea of intelligence-driven detection does that",
    "start": "1099280",
    "end": "1105000"
  },
  {
    "text": "sound familiar intelligence-driven detection well that's basically the concept that um the better your",
    "start": "1105000",
    "end": "1111760"
  },
  {
    "text": "intelligence the more actionable your events are so let's say for example you happen to know some really good friends",
    "start": "1111760",
    "end": "1118559"
  },
  {
    "text": "that work at some three-letter agency or something I'm making this up by the way and they you know uh pass you some stuff",
    "start": "1118559",
    "end": "1125559"
  },
  {
    "text": "about some attacker you're worried about some DNS names that they're using as part of their command and control infrastructure right some um you know",
    "start": "1125559",
    "end": "1133159"
  },
  {
    "text": "registry keys or something that they've seen them do in the attack now if these are really rare and narrow to that",
    "start": "1133159",
    "end": "1140120"
  },
  {
    "text": "specific attack these things can actually be quite good if they're fresh right you know what I'm talking",
    "start": "1140120",
    "end": "1145440"
  },
  {
    "text": "about right sounds familiar so I put this as number one but this is based on",
    "start": "1145440",
    "end": "1151360"
  },
  {
    "text": "how good your intelligence is right there's plenty of open- source lists of DNS names that are actually not very",
    "start": "1151360",
    "end": "1157320"
  },
  {
    "text": "good at all and um so I put this as an example of one if you have a high quality DNS name then this may be the",
    "start": "1157320",
    "end": "1163960"
  },
  {
    "text": "wake you up in the middle of the night thing it may be okay um malicious PDF was sent to a",
    "start": "1163960",
    "end": "1169880"
  },
  {
    "text": "user how would you determine that well you know there's various ways tools vendor products and so on for analyzing",
    "start": "1169880",
    "end": "1175240"
  },
  {
    "text": "PDFs and so let's say for IM imagine you live in a certain you know land where you have these systems in place that can",
    "start": "1175240",
    "end": "1181679"
  },
  {
    "text": "analyze these things and you happen to see that it's a malicious PDF so maybe this is something as part of a fishing attack now here's the point that I'm",
    "start": "1181679",
    "end": "1187799"
  },
  {
    "text": "trying to make I'm not trying to get you to walk away with these examples I'm trying to get you to understand that there's different levels of events that",
    "start": "1187799",
    "end": "1194360"
  },
  {
    "text": "all have a place in the intrusion detection story that's what I want you to take away",
    "start": "1194360",
    "end": "1199919"
  },
  {
    "text": "okay so maybe you have logins for the same for for a user from disparate geolocations in a short amount of time",
    "start": "1199919",
    "end": "1206159"
  },
  {
    "text": "okay maybe that's weird right maybe they logged in from here and then you know a country thousands of miles away within",
    "start": "1206159",
    "end": "1212240"
  },
  {
    "text": "10 minutes okay now those of you that have done stuff like that know that there are some false positives there so",
    "start": "1212240",
    "end": "1218159"
  },
  {
    "text": "it's not quite a one it's not quite a wake you up in the middle of the night event right but it is interesting okay so again",
    "start": "1218159",
    "end": "1225440"
  },
  {
    "text": "intelligence-based detection net flow alerts based on uh known bad IP addresses that you get fed from somebody",
    "start": "1225440",
    "end": "1231480"
  },
  {
    "text": "that you trust that has a good quality set of of data net flow and and and network-based data is inherently in my",
    "start": "1231480",
    "end": "1237760"
  },
  {
    "text": "opinion more uh noisy um okay so I'm going to go through these quickly registry modifications so",
    "start": "1237760",
    "end": "1245280"
  },
  {
    "start": "1242000",
    "end": "1274000"
  },
  {
    "text": "uh I'll make this example a few times in the talk but you guys familiar with the run and run once keys right so that's like you know probably not even done",
    "start": "1245280",
    "end": "1251880"
  },
  {
    "text": "anymore but that was like a way that a lot of malware was you know maintaining persistence through reboots uh you know",
    "start": "1251880",
    "end": "1257880"
  },
  {
    "text": "back in the you know back in 2010 so um so antivirus alerts as you know",
    "start": "1257880",
    "end": "1266480"
  },
  {
    "text": "like antivirus has kind of slipped down the the the list a little bit over the years but it still has its place um so",
    "start": "1266480",
    "end": "1274360"
  },
  {
    "start": "1274000",
    "end": "1326000"
  },
  {
    "text": "this is a good one snort event for a blank user agent right so you know maybe somebody that has a blank user agent uh",
    "start": "1274360",
    "end": "1281000"
  },
  {
    "text": "is a is a is indication of a C2 um again this is kind of a 2010 2011 example but",
    "start": "1281000",
    "end": "1287400"
  },
  {
    "text": "hey what can you do um but my point is like maybe that's a number seven so do I want to have a every time some every",
    "start": "1287400",
    "end": "1293720"
  },
  {
    "text": "time I see a blank user agent on my network do I want to have somebody email me and wake me up in the middle of the night of course not right of course not",
    "start": "1293720",
    "end": "1299799"
  },
  {
    "text": "but is that something I can that's interesting is that something I can use in my intrusion program",
    "start": "1299799",
    "end": "1305400"
  },
  {
    "text": "absolutely all right so successful logins for Windows RDP um you know a snort imagine a snort event that alerted",
    "start": "1305400",
    "end": "1311520"
  },
  {
    "text": "anytime it saw any kind of encrypted traffic okay clearly not something you want to send an email to you every every",
    "start": "1311520",
    "end": "1317559"
  },
  {
    "text": "time it happens but still has a place in the intrusion story and then of course at the very bottom is this notion of raw",
    "start": "1317559",
    "end": "1324520"
  },
  {
    "text": "logs okay okay you guys still with me I know that was a little tedious trying to",
    "start": "1324520",
    "end": "1330679"
  },
  {
    "start": "1326000",
    "end": "1391000"
  },
  {
    "text": "move quickly okay all right you say okay well that's great for what do you do with all these",
    "start": "1330679",
    "end": "1337760"
  },
  {
    "text": "noisy events you know well guess what you put them through the event pipeline that's this thing that takes",
    "start": "1337760",
    "end": "1344600"
  },
  {
    "text": "these noisy events right and turns them into something that's useful and we're going to talk through this in",
    "start": "1344600",
    "end": "1350120"
  },
  {
    "text": "a little bit of detail you take your noisy event then it goes into a blacklisting stage identity translation",
    "start": "1350120",
    "end": "1357320"
  },
  {
    "text": "correlation context gets applied and then it gets analyzed by human being so",
    "start": "1357320",
    "end": "1362840"
  },
  {
    "text": "this is the process this is the pipeline for how your events these noisy events that I mentioned uh can be part of your",
    "start": "1362840",
    "end": "1368760"
  },
  {
    "text": "intrusion detection story right so the big the big thing I'm trying to tell you is you should instrument the crap out of",
    "start": "1368760",
    "end": "1375559"
  },
  {
    "text": "your environment you should go through and not be afraid to turn on the fire hose of things for like certain registry",
    "start": "1375559",
    "end": "1381760"
  },
  {
    "text": "actions or all kinds of noisy stuff happening in your network right we need to find a way to be able to take all",
    "start": "1381760",
    "end": "1387400"
  },
  {
    "text": "that data and find something interesting out of it okay so let's talk a little bit about",
    "start": "1387400",
    "end": "1394880"
  },
  {
    "start": "1391000",
    "end": "1538000"
  },
  {
    "text": "blacklisting so the noisy little event the HTTP with no user agent right it was a seven out of 10 remember so the",
    "start": "1394880",
    "end": "1401600"
  },
  {
    "text": "blacklisting stage is a process whereby we take those events and we want to push them as far up that stack as we can as",
    "start": "1401600",
    "end": "1407760"
  },
  {
    "text": "far towards number one as we can right with the recognition that it's not going to get all the way there that's okay",
    "start": "1407760",
    "end": "1413640"
  },
  {
    "text": "right that's okay we'll take our seven and we'll be okay with a four if we can get it up to a four we're good right",
    "start": "1413640",
    "end": "1419320"
  },
  {
    "text": "that's still progress and so what this is is taking out the most egregious false positives from the list and being",
    "start": "1419320",
    "end": "1424840"
  },
  {
    "text": "able to take those signals and drop those on the floor all right has anybody actually turned on a snort event for a",
    "start": "1424840",
    "end": "1430039"
  },
  {
    "text": "blank user agent before nobody willing to raise their hand um so I",
    "start": "1430039",
    "end": "1436320"
  },
  {
    "text": "have and uh so as soon as I did it I was like you know this again a few years back so this was actually kind of a cool",
    "start": "1436320",
    "end": "1441600"
  },
  {
    "text": "thing to do then um but I turned it on and what I found was uh I was like",
    "start": "1441600",
    "end": "1447480"
  },
  {
    "text": "excited and I was like ready to chase it down and sound sound the alarm and what I found was um that the things that were",
    "start": "1447480",
    "end": "1454520"
  },
  {
    "text": "triggering it was actually Fitbit so you know those dumb things that you put on your pocket and uh tells",
    "start": "1454520",
    "end": "1460159"
  },
  {
    "text": "you how many steps you take so so these things actually call back uh",
    "start": "1460159",
    "end": "1465360"
  },
  {
    "text": "to their service and you know for whatever reason they just like decided not to have RFC compliance and so they",
    "start": "1465360",
    "end": "1472760"
  },
  {
    "text": "um left out the user agent field I mean there's a user agent field it's just blink so anyway so the point is you",
    "start": "1472760",
    "end": "1480080"
  },
  {
    "text": "would take all those cases out so you would have a system where you get these you get these signals in there and then you say okay here's what I found I found",
    "start": "1480080",
    "end": "1487080"
  },
  {
    "text": "you know Fitbit all right we know those are you know false positive Okay blah blah blah there's these five things",
    "start": "1487080",
    "end": "1492559"
  },
  {
    "text": "right off the cuff I just took away a giant swath of events and like this sounds this sounds Maybe blame to you I",
    "start": "1492559",
    "end": "1499640"
  },
  {
    "text": "don't know but like actually this works really really well right and if you have a system whereby you can go back and",
    "start": "1499640",
    "end": "1507240"
  },
  {
    "text": "append it amend it amend this black listing for every single um event type whenever you feel like it it you you'll",
    "start": "1507240",
    "end": "1514080"
  },
  {
    "text": "find that it actually cuts down a shocking number of false positives just by itself now remember we still have",
    "start": "1514080",
    "end": "1520120"
  },
  {
    "text": "these events enabled so this is different than the snort example where you just turned on the sensor right remember and and and it turned off all",
    "start": "1520120",
    "end": "1526159"
  },
  {
    "text": "the things that alerted it's different than that right we're suppressing the things that we know are are are are false positives and",
    "start": "1526159",
    "end": "1534320"
  },
  {
    "text": "what we're doing is we're pushing that signal up that up that stack now the next stage is um identity translation",
    "start": "1534320",
    "end": "1542080"
  },
  {
    "start": "1538000",
    "end": "1709000"
  },
  {
    "text": "and when when you think of identity translation of course you think of Face Off and uh this is the most common uh",
    "start": "1542080",
    "end": "1548679"
  },
  {
    "text": "picture that I I always think of when I think of Face Off I don't know I don't know about you guys",
    "start": "1548679",
    "end": "1553720"
  },
  {
    "text": "but man there's some crazy stuff on Google image search I maybe this album's awesome I don't",
    "start": "1553720",
    "end": "1560120"
  },
  {
    "text": "know like I don't know but um okay so we got all these signals we've got them",
    "start": "1560120",
    "end": "1565360"
  },
  {
    "text": "past the blacklisting phase right and now we're going to do identity translation so we're going to take these",
    "start": "1565360",
    "end": "1571840"
  },
  {
    "text": "signals these events these signs of suspicious activity and we're going to",
    "start": "1571840",
    "end": "1577360"
  },
  {
    "text": "try to figure out how to how to apply a label to them so this is actually one of the coolest",
    "start": "1577360",
    "end": "1583880"
  },
  {
    "text": "most important uh pieces to the puzzle so think about the HTP user agent again",
    "start": "1583880",
    "end": "1589960"
  },
  {
    "text": "this is a problem I know you guys have tried to struggle with before you get an event on a network sensor and you only",
    "start": "1589960",
    "end": "1595399"
  },
  {
    "text": "have an IP address right you get an event on a host based thing and you only have a net bios name right you get an",
    "start": "1595399",
    "end": "1602120"
  },
  {
    "text": "event on a log and you only have a username is this sound familiar right well the solution to that is is identity",
    "start": "1602120",
    "end": "1608919"
  },
  {
    "text": "translation the way what you want to do is you get an event that has an identity attribute right that that that comes",
    "start": "1608919",
    "end": "1615760"
  },
  {
    "text": "along for the ride so let's say you have a network event it has a source IP right and that maps to something in your",
    "start": "1615760",
    "end": "1620960"
  },
  {
    "text": "environment a machine right a host now if you have a a a a a reasonable handle",
    "start": "1620960",
    "end": "1627440"
  },
  {
    "text": "on your machine inventory at your Enterprise what you can do is actually have a system that allows you to attach",
    "start": "1627440",
    "end": "1634919"
  },
  {
    "text": "labels to this event so you you have this initial event you've gotten all the noise taken away and now you can say all",
    "start": "1634919",
    "end": "1641520"
  },
  {
    "text": "right I know the source IP I know the machine I know what user was on that machine at that time right that's not",
    "start": "1641520",
    "end": "1647600"
  },
  {
    "text": "that hard and so you apply that username to that event as well Additionally you can apply you know",
    "start": "1647600",
    "end": "1655120"
  },
  {
    "text": "all the users that were on that machine if it's a multi-user host you can apply all the identity things that you can come up with Mac address you can apply",
    "start": "1655120",
    "end": "1662519"
  },
  {
    "text": "um uh you know various types of usernames if you have different usernames in your environment or something like that so the point is that",
    "start": "1662519",
    "end": "1668360"
  },
  {
    "text": "after an event exits this stage it's going to have every single possible identity that you can think of on there",
    "start": "1668360",
    "end": "1674799"
  },
  {
    "text": "that may apply to that event this is super important as we go into the correlation stage right because you're",
    "start": "1674799",
    "end": "1680039"
  },
  {
    "text": "going to be able to want you're going to want to have be able to compare apples to apples you're going to want to say okay I have a network event over here I",
    "start": "1680039",
    "end": "1686640"
  },
  {
    "text": "have a host Spas event over here right but you want to be able to look at them through the same lens we'll talk about that more in a minute right but it's",
    "start": "1686640",
    "end": "1693279"
  },
  {
    "text": "super super important to try to have some system that can apply these tags to these",
    "start": "1693279",
    "end": "1699039"
  },
  {
    "text": "events does this make sense are you guys with me hello okay I think you're lost in this picture",
    "start": "1699039",
    "end": "1705760"
  },
  {
    "text": "of bowwow okay so where are we we're winding our",
    "start": "1705760",
    "end": "1713360"
  },
  {
    "start": "1709000",
    "end": "1781000"
  },
  {
    "text": "little way through the through through the picture we've gotten the the the the false positives out of the way we've",
    "start": "1713360",
    "end": "1718519"
  },
  {
    "text": "gotten all these events now that have been pushed up the stack maybe we have a bunch of five events a bunch of two events a bunch of you know four events",
    "start": "1718519",
    "end": "1724880"
  },
  {
    "text": "and all these things are tagged with all the identities that we can come up with right the usernames the whatever",
    "start": "1724880",
    "end": "1730159"
  },
  {
    "text": "whatever now what do you do with that what do you do with that how do you turn it into something useful well I'm",
    "start": "1730159",
    "end": "1735919"
  },
  {
    "text": "going to offer you some ideas so this is classically known as",
    "start": "1735919",
    "end": "1740960"
  },
  {
    "text": "correlation in the industry although I I kind of shy I try to shy away from using these sort of Industry terms because",
    "start": "1740960",
    "end": "1746159"
  },
  {
    "text": "they're kind of loaded um because like everybody thinks a correlation they're like well that doesn't really work well",
    "start": "1746159",
    "end": "1751960"
  },
  {
    "text": "that's because you're doing it wrong so okay so what is correlation trying to",
    "start": "1751960",
    "end": "1758960"
  },
  {
    "text": "do so it's trying to take all these low so so we went around we instrumented everything we could in our environment",
    "start": "1758960",
    "end": "1764279"
  },
  {
    "text": "right we came up with every single noisy crappy thing we could come up with and we we sort of attached a meter to it we",
    "start": "1764279",
    "end": "1770279"
  },
  {
    "text": "created these events right so correlation is the process of taking these low events and sticking them together and then trying to surface",
    "start": "1770279",
    "end": "1777120"
  },
  {
    "text": "higher quality events okay make sense so so how do we",
    "start": "1777120",
    "end": "1783039"
  },
  {
    "start": "1781000",
    "end": "1822000"
  },
  {
    "text": "do that so we I'm going to introduce this concept of the attack plane",
    "start": "1783039",
    "end": "1789799"
  },
  {
    "text": "um hopefully it doesn't look like this this is the idea of having a lens I",
    "start": "1789799",
    "end": "1797679"
  },
  {
    "text": "when I say plane by the way I mean like a geometric plane not like a this",
    "start": "1797679",
    "end": "1803200"
  },
  {
    "text": "thing what I mean is basically like a a a dimensional Space by which you can stack these events on then you can",
    "start": "1803200",
    "end": "1809840"
  },
  {
    "text": "attach these events too right the plane is sort of the surface upon which you take all these noisy events and put them",
    "start": "1809840",
    "end": "1815880"
  },
  {
    "text": "together sort of like Legos right so let's look at kind of a simple example",
    "start": "1815880",
    "end": "1822039"
  },
  {
    "start": "1822000",
    "end": "1871000"
  },
  {
    "text": "if you will uh a kind of a trivial example of an attack plane so this example is the attack",
    "start": "1822039",
    "end": "1830840"
  },
  {
    "text": "plane is simply a host right this is actually a fairly classic type of correlation this is this is host based",
    "start": "1830840",
    "end": "1837919"
  },
  {
    "text": "correlation so this is the idea of taking all these noisy events right and",
    "start": "1837919",
    "end": "1843080"
  },
  {
    "text": "stacking them on a host lens right a host plane so a host is what an IP address in",
    "start": "1843080",
    "end": "1851000"
  },
  {
    "text": "this case and so you take every event that happens to have an IP address assigned to it attached to it right and",
    "start": "1851000",
    "end": "1856200"
  },
  {
    "text": "you put them together and so what does this tell you this tells you that this this machine happened to have not just",
    "start": "1856200",
    "end": "1862080"
  },
  {
    "text": "one thing that was going on that was suspicious but actually four things in this example right IP address 1.2.3.4",
    "start": "1862080",
    "end": "1868519"
  },
  {
    "text": "and if we look at the next uh the next page here you know this is a way you know you can see you could group you",
    "start": "1868519",
    "end": "1874600"
  },
  {
    "start": "1871000",
    "end": "1912000"
  },
  {
    "text": "know 1.2.3.4 events together you group 4.3.2 one's events together okay this is",
    "start": "1874600",
    "end": "1881240"
  },
  {
    "text": "not intended to be rocket science this is actually very classic vanilla correlation but it's my example my my my",
    "start": "1881240",
    "end": "1888519"
  },
  {
    "text": "illustration of what an attack plane is it's a uh it's a it's a lens upon which",
    "start": "1888519",
    "end": "1894720"
  },
  {
    "text": "to take to put your events does that make sense to people are you guys still with me yeah okay right not like I said",
    "start": "1894720",
    "end": "1902200"
  },
  {
    "text": "rocket science now let's see if we can come up with some more advanced types of attack",
    "start": "1902200",
    "end": "1907919"
  },
  {
    "text": "planes right and I bet we can so I'll have to introduce a couple of Concepts",
    "start": "1907919",
    "end": "1914399"
  },
  {
    "start": "1912000",
    "end": "2056000"
  },
  {
    "text": "before we get get there one of them is known as the kill chain so I I predict this is going to be one",
    "start": "1914399",
    "end": "1920240"
  },
  {
    "text": "of the hottest uh Trends in in uh in computer security or at least intrusion",
    "start": "1920240",
    "end": "1925440"
  },
  {
    "text": "detection this notion of the kill chain this is a cool concept um so this is something started",
    "start": "1925440",
    "end": "1932760"
  },
  {
    "text": "by the US military I believe or at least a military I think it was US military and it was basically this concept of",
    "start": "1932760",
    "end": "1940120"
  },
  {
    "text": "there's these various stages to an attack and I think the key the key point",
    "start": "1940120",
    "end": "1945399"
  },
  {
    "text": "is that there's a set of stages that are necessary for or any given attack to be successful so the military example and",
    "start": "1945399",
    "end": "1952320"
  },
  {
    "text": "if you're if there's military people in the room like I'm I'm not a military person so forgive my my my probably my",
    "start": "1952320",
    "end": "1957760"
  },
  {
    "text": "poor analogies but you know in a military context the way it works is you",
    "start": "1957760",
    "end": "1963679"
  },
  {
    "text": "know the the soldier has the eyes on the target they radio to HQ the HQ has to",
    "start": "1963679",
    "end": "1968720"
  },
  {
    "text": "confirm you know that they can pull the trigger and then the trigger can be pulled right and there's the point is",
    "start": "1968720",
    "end": "1975000"
  },
  {
    "text": "that there's a series of stages that are necessarily the case and so the US military has actually done some uh work",
    "start": "1975000",
    "end": "1980960"
  },
  {
    "text": "on two sides of this one how to accelerate the chain so in other words",
    "start": "1980960",
    "end": "1986320"
  },
  {
    "text": "how to make this whole process faster so that you can kill people more efficiently right and then the other",
    "start": "1986320",
    "end": "1993320"
  },
  {
    "text": "side of the fence as they say we recognize that our attackers are actually going to be going through this process that they're going to",
    "start": "1993320",
    "end": "1998399"
  },
  {
    "text": "necessarily have these stages in their attack and as such perhaps there's a way we can disrupt them at various stages in",
    "start": "1998399",
    "end": "2004840"
  },
  {
    "text": "the attack once we understand that they necessarily have to go through these St now some some some really smart guys",
    "start": "2004840",
    "end": "2011840"
  },
  {
    "text": "took this concept from the US military uh the guys were at Lockheed and they uh it's uh Hutchin clert and Amin if you",
    "start": "2011840",
    "end": "2019480"
  },
  {
    "text": "guys are here talk to you guys after um but uh they took that and brought it",
    "start": "2019480",
    "end": "2024559"
  },
  {
    "text": "into the information security domain right so the idea is that an information security ad uh attacker has to go",
    "start": "2024559",
    "end": "2030519"
  },
  {
    "text": "through a series of stages in order to attack a Target and the cool thing about this is that this is much more stable",
    "start": "2030519",
    "end": "2036679"
  },
  {
    "text": "than the given you know zero days that you'll hear about black hat right you'll hear about a bunch of zero days and",
    "start": "2036679",
    "end": "2042519"
  },
  {
    "text": "those are real and those are great talks but the point of this is is that the the the killchain the stages an attacker has",
    "start": "2042519",
    "end": "2048800"
  },
  {
    "text": "to go through are actually more stable and so if there's a way we can use that in our intrusion detection life cycle",
    "start": "2048800",
    "end": "2054200"
  },
  {
    "text": "that we may have a chance of detecting these things so let's go through this is this is my paraphrase version of the",
    "start": "2054200",
    "end": "2059760"
  },
  {
    "start": "2056000",
    "end": "2253000"
  },
  {
    "text": "cler uh aminan and Hutchin paper uh I've changed this um fairly significantly",
    "start": "2059760",
    "end": "2065800"
  },
  {
    "text": "actually from their version The Reason I did this is because I wanted to try to expand upon the stages that are involved",
    "start": "2065800",
    "end": "2071878"
  },
  {
    "text": "in the uh internal part of your organization right I wanted to kind of zoom in if you will on the parts where",
    "start": "2071879",
    "end": "2079040"
  },
  {
    "text": "they're they're actually attacking you right to try to illustrate the chances we might have for doing intrusion",
    "start": "2079040",
    "end": "2086000"
  },
  {
    "text": "detection okay so I'll go through the stages real quick you know you can come up with your own stages like whatever",
    "start": "2086000",
    "end": "2091960"
  },
  {
    "text": "right it doesn't really matter but okay so Recon is the initial stage where the attacker is setting up their structure",
    "start": "2091960",
    "end": "2098560"
  },
  {
    "text": "right they're they're doing some passive reconnaissance against your organization they're setting up their command and control infrastructure right sound",
    "start": "2098560",
    "end": "2106160"
  },
  {
    "text": "familiar right then there's attack delivery how does attack deliveries happen most often today anybody",
    "start": "2106160",
    "end": "2113760"
  },
  {
    "text": "know yeah email email is the transport mechanism you know you've got your PDFs you've got your drive by downloads right",
    "start": "2113760",
    "end": "2120520"
  },
  {
    "text": "those are probably the most common there's others of course um once that uh",
    "start": "2120520",
    "end": "2125599"
  },
  {
    "text": "delivery is accomplished the exploitation happens of the of the host right that PDF um compromises that",
    "start": "2125599",
    "end": "2131160"
  },
  {
    "text": "machine gets some code execution on there after that there's a command and control part um where that you know that",
    "start": "2131160",
    "end": "2138800"
  },
  {
    "text": "machine might download additional software for its uh beaconing and whatnot um and uh you know try to make",
    "start": "2138800",
    "end": "2145280"
  },
  {
    "text": "some HTTP requests or something like that U this is all pretty vanilla stuff after that you know at some point in the",
    "start": "2145280",
    "end": "2151560"
  },
  {
    "text": "future the the the the targeted attacker will take uh advantage of this uh",
    "start": "2151560",
    "end": "2156680"
  },
  {
    "text": "compromised machine and sort of become more active issue it specific commands right so one of those commands might be",
    "start": "2156680",
    "end": "2162800"
  },
  {
    "text": "to dump your your password hashes right this is pretty common internal Recon so once they've",
    "start": "2162800",
    "end": "2169520"
  },
  {
    "text": "gotten your machine compromise they're actually doing interactive command line stuff on that machine they'll start",
    "start": "2169520",
    "end": "2174800"
  },
  {
    "text": "looking around for and this is the part remember I said 71% of a tax or whatever it was takes uh you know days or longer",
    "start": "2174800",
    "end": "2181240"
  },
  {
    "text": "right this is the part where they're doing internal Recon they're looking at your documents they're looking at your your wikis or whatever you have",
    "start": "2181240",
    "end": "2187160"
  },
  {
    "text": "internally and trying to figure out who's got the passwords to the place that they want to get and how do your",
    "start": "2187160",
    "end": "2192520"
  },
  {
    "text": "systems work after they figured that out they do this lateral movement and this isn't a strictly linear uh graph it's important",
    "start": "2192520",
    "end": "2199359"
  },
  {
    "text": "to note there may be circular kind of things like they do some lateral movement and they do some more reconnaissance right so but the point is",
    "start": "2199359",
    "end": "2206319"
  },
  {
    "text": "um that these are the these are the general stages I think so then they become different users and so on then",
    "start": "2206319",
    "end": "2211680"
  },
  {
    "text": "they establish persistence usually some point along the chain maybe not at this point maybe a little earlier um and then",
    "start": "2211680",
    "end": "2217240"
  },
  {
    "text": "they stage the data that they're looking for assuming that they're actually taking data out and they exfiltrate the data do this sound familiar right this",
    "start": "2217240",
    "end": "2225400"
  },
  {
    "text": "is ring a bell okay so the point I'm trying to make is right like if you're",
    "start": "2225400",
    "end": "2230720"
  },
  {
    "text": "going around and you're trying to like detect some zero day on your network I mean that's cool but like the reality is",
    "start": "2230720",
    "end": "2236160"
  },
  {
    "text": "that your attackers are actually going through this strict series of patterns and so perhaps there's a way we can",
    "start": "2236160",
    "end": "2241880"
  },
  {
    "text": "leverage this in order to do intrusion detection what do you guys think maybe",
    "start": "2241880",
    "end": "2248599"
  },
  {
    "text": "okay so let's let's see so you guys cool with the kill chain yeah all right so remember our concept of attack",
    "start": "2248599",
    "end": "2255400"
  },
  {
    "start": "2253000",
    "end": "2429000"
  },
  {
    "text": "planes just a minute ago where we were grouping things by IP address yeah so let's go back to that for a minute right",
    "start": "2255400",
    "end": "2261640"
  },
  {
    "text": "and let's group things by a different notion let's group things by the killchain let's use a kill chain as our",
    "start": "2261640",
    "end": "2268480"
  },
  {
    "text": "attack plane okay so what we have here are three",
    "start": "2268480",
    "end": "2274359"
  },
  {
    "text": "different events the color coding is kind of supposed to represent noisy they are right the point is that any one of",
    "start": "2274359",
    "end": "2280400"
  },
  {
    "text": "these events by itself would never be enough to wake you up in the middle of the night okay so this is just a new way of",
    "start": "2280400",
    "end": "2287599"
  },
  {
    "text": "doing correlation so we've got all these events they come in one is the command and control so let's just take for a",
    "start": "2287599",
    "end": "2292640"
  },
  {
    "text": "stupid example the command and control is our blank user agent you know that's the way we've detected command and control is happening so when you detect",
    "start": "2292640",
    "end": "2299160"
  },
  {
    "text": "that at the instrumentation time you've applied the notion that it's a command and control part of the chain to the",
    "start": "2299160",
    "end": "2305079"
  },
  {
    "text": "event so the event has the fact that it's possibly part of a C2 it's got a certain",
    "start": "2305079",
    "end": "2310359"
  },
  {
    "text": "value for how noisy it is it's got all these different uh attributes of what identity it's got right so you've got an",
    "start": "2310359",
    "end": "2316960"
  },
  {
    "text": "IP address that comes off your network sensor but you've done the identity translation and so you've been able to figure out that it's uid Bob that was",
    "start": "2316960",
    "end": "2323599"
  },
  {
    "text": "actually on that machine at that time you know probably it has a bunch of identities but that's one of them and so",
    "start": "2323599",
    "end": "2328920"
  },
  {
    "text": "the one common denominator of all these events I you know I like common denominators as user IDs you know you can choose whatever you like but um you",
    "start": "2328920",
    "end": "2335880"
  },
  {
    "text": "know when you do your identity translation if you choose a common denominator of Bob then that allows you to of user ID then that that that that",
    "start": "2335880",
    "end": "2343280"
  },
  {
    "text": "allows you to to see these events kind of together okay so we've got um the",
    "start": "2343280",
    "end": "2349800"
  },
  {
    "text": "internal reconnaissance is what IR stands for so that's them rifling through your documents internal documents so maybe you have a system",
    "start": "2349800",
    "end": "2356960"
  },
  {
    "text": "that detects an egregious number of accesses to internal documents you know maybe that' be something",
    "start": "2356960",
    "end": "2364119"
  },
  {
    "text": "useful again egregious accesses to internal doents is not something you want to be woken up in the night for",
    "start": "2364240",
    "end": "2369599"
  },
  {
    "text": "right so it's it's kind of a lower confidence thing okay and then the other example is",
    "start": "2369599",
    "end": "2375359"
  },
  {
    "text": "exploitation that's what e is for and that you know my my trivial example of that is the registry run key change",
    "start": "2375359",
    "end": "2382440"
  },
  {
    "text": "right I mean you know these are dumb examples you can come up with much more sophisticated examples probably from listening to other talks here so then",
    "start": "2382440",
    "end": "2388599"
  },
  {
    "text": "you would group all these together and you would create a correlated event um and so the point is that you",
    "start": "2388599",
    "end": "2397520"
  },
  {
    "text": "can actually use the killchain Which is far more stable to kind of come up with a better correlation model and in fact",
    "start": "2397520",
    "end": "2404720"
  },
  {
    "text": "you know you guys are probably got a million ideas on this subject too can you guys come up with you know another",
    "start": "2404720",
    "end": "2411119"
  },
  {
    "text": "way of of thinking about these noisy events and context another way of correlating these events probably and I",
    "start": "2411119",
    "end": "2416680"
  },
  {
    "text": "think the most powerful intrusion detection system will be one that actually uses multiple correlation models to um group these",
    "start": "2416680",
    "end": "2423880"
  },
  {
    "text": "events okay so recall we're kind of winding our way through through um our",
    "start": "2423880",
    "end": "2430040"
  },
  {
    "text": "event pipeline we've decided that we love these noisy events that we previously",
    "start": "2430040",
    "end": "2435560"
  },
  {
    "text": "you know 40 minutes ago you hated right uh you've reduced the noise of",
    "start": "2435560",
    "end": "2441280"
  },
  {
    "text": "these events by doing blacklisting and then you've started to do some correlation right maybe you just",
    "start": "2441280",
    "end": "2446680"
  },
  {
    "text": "do simple IP based correlation maybe you do the killchain model maybe you have you know four or five other ways of doing correlation on your",
    "start": "2446680",
    "end": "2453240"
  },
  {
    "text": "own um so the next stage in the pipeline is called context",
    "start": "2453240",
    "end": "2459240"
  },
  {
    "start": "2457000",
    "end": "2478000"
  },
  {
    "text": "or out of context anybody know what this is from yeah",
    "start": "2459400",
    "end": "2467440"
  },
  {
    "text": "nice yeah I don't remember this episode myself but uh it looks",
    "start": "2468920",
    "end": "2475320"
  },
  {
    "text": "[Laughter] Whimsical okay so here we are",
    "start": "2475320",
    "end": "2484119"
  },
  {
    "start": "2478000",
    "end": "2644000"
  },
  {
    "text": "context so at the context stage we've gotten presumably we've done correlation and we've pushed our events up so we've",
    "start": "2484119",
    "end": "2490720"
  },
  {
    "text": "done the blacklisting we pushed our events up the stack we've put those those events that are push up the stack together and then we've popped them out",
    "start": "2490720",
    "end": "2496280"
  },
  {
    "text": "the other side right and now we have these events that hopefully somebody wants to look at right so what do we do",
    "start": "2496280",
    "end": "2502480"
  },
  {
    "text": "with those events do we just show them at somebody well I think we can do better than that right and this is where",
    "start": "2502480",
    "end": "2508000"
  },
  {
    "text": "the concept of situational awareness comes in you guys ever heard of that another military concept actually right",
    "start": "2508000",
    "end": "2514680"
  },
  {
    "text": "turns out they've been thinking about this stuff a little longer than we have um so the idea of context is that",
    "start": "2514680",
    "end": "2522880"
  },
  {
    "text": "there's a bunch of stuff in your environment that's actually useful that most people that do intrusion detection",
    "start": "2522880",
    "end": "2529359"
  },
  {
    "text": "aren't using and I think this is a big mistake you",
    "start": "2529359",
    "end": "2534560"
  },
  {
    "text": "see your systems that do intrusion detection aren't just for pumping out events they can actually be used to add",
    "start": "2534560",
    "end": "2541680"
  },
  {
    "text": "context to events that something else created this is actually a really powerful concept so let's say um you",
    "start": "2541680",
    "end": "2549240"
  },
  {
    "text": "know you've done your correlation you found a possible kill chain right and you have these three events right one's",
    "start": "2549240",
    "end": "2554319"
  },
  {
    "text": "a network event one's a host event and so on right and you want to shove that into some analyst's face and say hey",
    "start": "2554319",
    "end": "2559599"
  },
  {
    "text": "check this out like this looks crazy and so if you could pre-populate that that",
    "start": "2559599",
    "end": "2565400"
  },
  {
    "text": "event with a bunch of information about stuff in your environment that might be kind of cool",
    "start": "2565400",
    "end": "2572359"
  },
  {
    "text": "so one example is um maybe there's some relevant logs maybe you could actually",
    "start": "2572359",
    "end": "2577520"
  },
  {
    "text": "get the list of processes running on the machine itself at the time of the supposed compromise right there's a",
    "start": "2577520",
    "end": "2584880"
  },
  {
    "text": "bunch of this data that actually exists in your organization that nobody really knows how to include in the intrusion",
    "start": "2584880",
    "end": "2589920"
  },
  {
    "text": "detection story but it turns out it's actually super valuable when you're applying context when you're actually",
    "start": "2589920",
    "end": "2595960"
  },
  {
    "text": "analyzing the event and the goal here by the way is to reduce the amount of time that someone has to screw around looking at these events right so that they can",
    "start": "2595960",
    "end": "2603119"
  },
  {
    "text": "look at more in a day and so the",
    "start": "2603119",
    "end": "2608599"
  },
  {
    "text": "these various systems like a network forensic system for example may be able to bring to bear some network data on",
    "start": "2608599",
    "end": "2614920"
  },
  {
    "text": "that event that actually never alerted on it in the first place right think about your your company where you where",
    "start": "2614920",
    "end": "2620200"
  },
  {
    "text": "you work think about all the different stuff you've bought and you probably have a bunch right and think about the",
    "start": "2620200",
    "end": "2625920"
  },
  {
    "text": "fact that you know most people are probably just having those things send them emails or send them alerts right but you can actually use the apis of",
    "start": "2625920",
    "end": "2632480"
  },
  {
    "text": "those systems to get at more data to surface when it's time look at an event",
    "start": "2632480",
    "end": "2638359"
  },
  {
    "text": "so I think that's another important point this idea of context okay so um I want to talk a few",
    "start": "2638359",
    "end": "2646200"
  },
  {
    "start": "2644000",
    "end": "2774000"
  },
  {
    "text": "final thoughts here so one of the things that's interesting is I I don't I think they",
    "start": "2646200",
    "end": "2652680"
  },
  {
    "text": "dropped this this slogan some time ago but black Hat's slogan used to be digital self-defense does that sound",
    "start": "2652680",
    "end": "2658599"
  },
  {
    "text": "familiar I don't know what it's I don't know even know if they have a SL slogan anymore but you know I go to black hat I love black hat I go to all these talks",
    "start": "2658599",
    "end": "2665160"
  },
  {
    "text": "right and they're all about breaking right",
    "start": "2665160",
    "end": "2670800"
  },
  {
    "text": "and I mean you know black hat it's an offensive conference I get it right but like I talked to the organizers when I",
    "start": "2670800",
    "end": "2676000"
  },
  {
    "text": "submitted my talk and they told me that nobody actually submits defense",
    "start": "2676000",
    "end": "2681440"
  },
  {
    "text": "talks like and maybe that's why I'm here today you know and the only reason right but um nobody actually submits uh",
    "start": "2681440",
    "end": "2688440"
  },
  {
    "text": "defense talks like you know except for vendors vendors vendors do of course but",
    "start": "2688440",
    "end": "2693720"
  },
  {
    "text": "that's got its own issues but like given how the situation is in intrusion",
    "start": "2693720",
    "end": "2699160"
  },
  {
    "text": "detection like why the hell aren't people like you working on this why the",
    "start": "2699160",
    "end": "2704480"
  },
  {
    "text": "hell aren't smart people like yourself helping with this problem right like and maybe you are and maybe those people",
    "start": "2704480",
    "end": "2710599"
  },
  {
    "text": "that are just doing this stuff are like doing it in a silo and there's some people doing some awesome in the silos I happen to know that that some",
    "start": "2710599",
    "end": "2717640"
  },
  {
    "text": "people are but I want to talk to you because just like there's been kind of a thawing in recent years of talking about",
    "start": "2717640",
    "end": "2723960"
  },
  {
    "text": "data breaches I'd like to see a little more thawing of talking about intrusion detection because we're so right",
    "start": "2723960",
    "end": "2731880"
  },
  {
    "text": "and like you know I mean there's some",
    "start": "2731880",
    "end": "2736960"
  },
  {
    "text": "there's some people that are doing really good work and I know some of you are right but in general as a as a as a",
    "start": "2736960",
    "end": "2744119"
  },
  {
    "text": "as a society we're pretty well against attackers against modern attackers and like this just really kind",
    "start": "2744119",
    "end": "2749920"
  },
  {
    "text": "of like unacceptable right like you know these people are off like owning like",
    "start": "2749920",
    "end": "2755480"
  },
  {
    "text": "ring minus one like Rings I've never even heard of right and like in meantime like what are we doing right what are we",
    "start": "2755480",
    "end": "2764280"
  },
  {
    "text": "doing so anyway if you are passionate about this subject and I sincerely hope",
    "start": "2764280",
    "end": "2770119"
  },
  {
    "text": "you are um I would really love to talk to you um and so here's my contact",
    "start": "2770119",
    "end": "2776839"
  },
  {
    "start": "2774000",
    "end": "2801000"
  },
  {
    "text": "info and uh if anybody's doing anything remotely interesting in intrusion detection like please get in touch with",
    "start": "2776839",
    "end": "2782160"
  },
  {
    "text": "me because I want to I want to collaborate with you I'm passionate about the subject I think we can do a lot better as a as as a society and i'",
    "start": "2782160",
    "end": "2788440"
  },
  {
    "text": "I'd love to work with you to do it anyway thank you",
    "start": "2788440",
    "end": "2793680"
  },
  {
    "text": "[Applause]",
    "start": "2799340",
    "end": "2803349"
  }
]