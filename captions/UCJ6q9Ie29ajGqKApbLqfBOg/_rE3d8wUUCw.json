[
  {
    "text": "[Music] rock and roll um right the SD cards so",
    "start": "0",
    "end": "5359"
  },
  {
    "text": "what did they do they they even put a mode in there where they have this special diagnostic SD",
    "start": "5359",
    "end": "12679"
  },
  {
    "text": "card and you plug it in and you boot your device in the bootload mode and it actually starts executing code from your",
    "start": "12679",
    "end": "19080"
  },
  {
    "text": "SD card so you can even put in your whole own application at that point and",
    "start": "19080",
    "end": "24240"
  },
  {
    "text": "and take over the device so we use that trick uh oh not completely sure oh well here",
    "start": "24240",
    "end": "32360"
  },
  {
    "text": "here is because I have the thing here I don't have like a camera now to show you",
    "start": "32360",
    "end": "37600"
  },
  {
    "text": "what's what's happening so I made a few pictures although I I'm not very good at taking pictures either um I hope you can",
    "start": "37600",
    "end": "45320"
  },
  {
    "text": "see a little bit what they're doing by the way I forgot to say at the beginning I completely redid my presentation",
    "start": "45320",
    "end": "52680"
  },
  {
    "text": "compared to what you find in the book but big guess you've already notice it now um I put on sorry how can we get yeah I",
    "start": "52680",
    "end": "61719"
  },
  {
    "text": "put the presentation on our website the URLs on the last slide and I've put a whole page there with some stuff",
    "start": "61719",
    "end": "68400"
  },
  {
    "text": "recapping what I'm doing here and the the latest presentation is also on there",
    "start": "68400",
    "end": "73759"
  },
  {
    "text": "so anyway what you see here they have a big diagnostic menu with all kinds of tricks and tests and I wouldn't",
    "start": "73759",
    "end": "80159"
  },
  {
    "text": "recommend doing them all on your because I'm not sure if it survives um typically",
    "start": "80159",
    "end": "87000"
  },
  {
    "text": "there's one really dangerous part of phones that you don't want to mess with and that's that every device is tuned",
    "start": "87000",
    "end": "94040"
  },
  {
    "text": "and they have a parameter set in there um not so much in the pocket PC part but in the GM phone part that is tuned",
    "start": "94040",
    "end": "101880"
  },
  {
    "text": "specifically for your device if those parameters are lost it's dead you have to return it we hope we get a refund I",
    "start": "101880",
    "end": "108799"
  },
  {
    "text": "don't know um but you can't use anymore so this is a part that you really don't want to mess around with",
    "start": "108799",
    "end": "115680"
  },
  {
    "text": "um although I think these menus are are pretty okay",
    "start": "115680",
    "end": "121079"
  },
  {
    "text": "um okay in the sense that you don't want to flash uh zeros into your RAM I or",
    "start": "121079",
    "end": "128160"
  },
  {
    "text": "your flash R either because then it's dead also but at least most of the time you can recover so it has buil in uh flash tools",
    "start": "128160",
    "end": "136879"
  },
  {
    "text": "to flash from an SD card to an SD card you can just copy your your whole uh pocket PC uh uh around how can you get",
    "start": "136879",
    "end": "145319"
  },
  {
    "text": "to the next oh oh sorry the way you get to the",
    "start": "145319",
    "end": "151000"
  },
  {
    "text": "screens um depends most of the time what you do is you uh to get into the",
    "start": "151000",
    "end": "156239"
  },
  {
    "text": "bootloader mode you now it's showing let me put on the back light I'm not sure if you can see",
    "start": "156239",
    "end": "162200"
  },
  {
    "text": "it now it's showing the PIN code I have to enter PIN code to use device um what I do you press the power button you do a",
    "start": "162200",
    "end": "169959"
  },
  {
    "text": "soft reset and then it jumps into uh the bootloader mode and then it depends",
    "start": "169959",
    "end": "175800"
  },
  {
    "text": "which key you press what menu you get I think to get to that the screen",
    "start": "175800",
    "end": "182879"
  },
  {
    "text": "but I really read for the flash well I don't know for memory I think it's the calendar button but I",
    "start": "182879",
    "end": "189360"
  },
  {
    "text": "have no idea you can just at least press a button and see and reboot and try",
    "start": "189360",
    "end": "194519"
  },
  {
    "text": "another button in that sense you can't wipe your device yet um but don't press",
    "start": "194519",
    "end": "201560"
  },
  {
    "text": "twice anyway so if you um now soft reset again it just will reboot into the the",
    "start": "202200",
    "end": "208360"
  },
  {
    "text": "pocket PC and your back in in business so what we did",
    "start": "208360",
    "end": "213760"
  },
  {
    "text": "is we created uh such an SD card application that takes over the device",
    "start": "213760",
    "end": "220040"
  },
  {
    "text": "and starts running our own code and why because it's fun you can do it and and",
    "start": "220040",
    "end": "225959"
  },
  {
    "text": "also at some point you can start investigating the device from this angle because now there's no pocket PC running",
    "start": "225959",
    "end": "231560"
  },
  {
    "text": "at all I mean it's there it's the ram is still there it's volatile but but still present um and you can inspect the",
    "start": "231560",
    "end": "239280"
  },
  {
    "text": "device from this angle so what you see here okay the detection screen and our custom menu",
    "start": "239280",
    "end": "246239"
  },
  {
    "text": "that we made so our menu has some reused functions that are also present in the in the normal bootloader mode but you",
    "start": "246239",
    "end": "252920"
  },
  {
    "text": "also see uh RAM to SD so we can copy out the whole 32 megabytes of ram to an SD",
    "start": "252920",
    "end": "259440"
  },
  {
    "text": "card and look at it for instance um and another password menu so the password",
    "start": "259440",
    "end": "265320"
  },
  {
    "text": "menu uh if we go in there um you can show the pass password statistics on",
    "start": "265320",
    "end": "270759"
  },
  {
    "text": "this okay is it activated so in this case the screen Set uh first it says",
    "start": "270759",
    "end": "276800"
  },
  {
    "text": "found the Heap at this address so that that's where it found the marker and then it says password not set and",
    "start": "276800",
    "end": "283360"
  },
  {
    "text": "deactivated so in that set you can't use it oh that's funny R is",
    "start": "283360",
    "end": "292199"
  },
  {
    "text": "calling I pushing away um anyway so this is the the thing I",
    "start": "292199",
    "end": "299840"
  },
  {
    "text": "enter my password but I don't have it so what I do is I go in the boot loader um",
    "start": "299840",
    "end": "306479"
  },
  {
    "text": "just press action I go to the password menu I do show password stats now you",
    "start": "306479",
    "end": "313759"
  },
  {
    "text": "can't read it but here it says set an inactivated we saw it because we got the input screen",
    "start": "313759",
    "end": "320560"
  },
  {
    "text": "um now I can go to deactivate password press it it will tell me that the flags",
    "start": "320560",
    "end": "326680"
  },
  {
    "text": "have been set to to zero one in this case I still have it present I can either",
    "start": "326680",
    "end": "333120"
  },
  {
    "text": "deactivate it or wipe it in this case I deactivate it it it means that if I want",
    "start": "333120",
    "end": "338960"
  },
  {
    "text": "to change uh the password I need to know the old one if I wipe it I won't be",
    "start": "338960",
    "end": "344919"
  },
  {
    "text": "asked for an old one and I can just enter a new one so okay now I did this I",
    "start": "344919",
    "end": "350039"
  },
  {
    "text": "just reboot the device well look up I'll show you in a minute",
    "start": "350039",
    "end": "356160"
  },
  {
    "text": "um the point is I can even do this get in the device go back in the boot loader",
    "start": "356160",
    "end": "361560"
  },
  {
    "text": "say it needs to be activated again and put it back back on the desk and you'll you think it's still you know nicely and",
    "start": "361560",
    "end": "368919"
  },
  {
    "text": "protected by your PIN but it's not I've had access in the meantime okay",
    "start": "368919",
    "end": "374400"
  },
  {
    "text": "now it came up um the only thing it's now coming up with is uh my PIN for uh",
    "start": "374400",
    "end": "380560"
  },
  {
    "text": "the phone so it says okay you have a phone this is the phone display you see now it's not the display I had earlier",
    "start": "380560",
    "end": "388840"
  },
  {
    "text": "um one of thing I can do now is go to the start menu and I have a program called show pin well you can read this",
    "start": "388840",
    "end": "395680"
  },
  {
    "text": "either luckily because it's my pin um but it's my pin there so now I know the",
    "start": "395680",
    "end": "401319"
  },
  {
    "text": "pin and I can use this to to unlock the the DSM part",
    "start": "401319",
    "end": "407360"
  },
  {
    "text": "also okay so that's a little uh example of why a secure bootloader is something",
    "start": "407360",
    "end": "414319"
  },
  {
    "text": "you'll want if you want to have a secure device okay tools are the trade let's",
    "start": "414319",
    "end": "420319"
  },
  {
    "text": "see I've got about 10 minutes I guess",
    "start": "420319",
    "end": "424879"
  },
  {
    "text": "um what do I need if I want to really research such a device well the best place to go of",
    "start": "426199",
    "end": "433639"
  },
  {
    "text": "course is to to the people that build it uh in this case Microsoft and see what they have",
    "start": "433639",
    "end": "441000"
  },
  {
    "text": "available and actually that's quite a bit um if you compare it to the normal",
    "start": "443560",
    "end": "448879"
  },
  {
    "text": "official Studio that you have to pay for know msdn thing this is free you can",
    "start": "448879",
    "end": "455199"
  },
  {
    "text": "just download it for free um I guess they really need Developers for mobile stuff um because everything is free um",
    "start": "455199",
    "end": "464280"
  },
  {
    "text": "they even have a shared Source part where you can get a part of this kernel source uh to look at and they have it on",
    "start": "464280",
    "end": "472280"
  },
  {
    "text": "their website actually I think for the four version they even are giving away more",
    "start": "472280",
    "end": "478560"
  },
  {
    "text": "stuff than for the three version so you can now even download platform Builder and use that to create your own u r",
    "start": "478560",
    "end": "486240"
  },
  {
    "text": "images stuff like that I'm not sure if it's really complete but they are offering a whole set of development",
    "start": "486240",
    "end": "493360"
  },
  {
    "text": "tools for these [Music] devices oh yeah uh two interesting",
    "start": "493360",
    "end": "499840"
  },
  {
    "text": "things um even especially interesting to mention one is a remote debugger so you",
    "start": "499840",
    "end": "506400"
  },
  {
    "text": "put your device in active sync uh on your PC you have in Visual Studio the debugger",
    "start": "506400",
    "end": "512320"
  },
  {
    "text": "and it will debug remotely on your device so you can single step on your pocket PC through your code it's buggy",
    "start": "512320",
    "end": "520039"
  },
  {
    "text": "at least in the three version It's buggy but it works so you can really uh inspect registers and stuff like that",
    "start": "520039",
    "end": "527240"
  },
  {
    "text": "the other one is an emulator they have a full Intel uh version emulator of of the",
    "start": "527240",
    "end": "533600"
  },
  {
    "text": "pocket PC so they give you a ROM image that's already pre-built um and you can",
    "start": "533600",
    "end": "539160"
  },
  {
    "text": "just run it on your desktop and run your application in there and do remote debugging in there so that's also quite",
    "start": "539160",
    "end": "546480"
  },
  {
    "text": "powerful although you will have to of course this is arm and that's an Intel so it's not precisely the",
    "start": "546480",
    "end": "554800"
  },
  {
    "text": "same um the next part is it's an arm processor so uh if you really want to go",
    "start": "554800",
    "end": "560079"
  },
  {
    "text": "in there and and look at stuff that's that's got no public um no public uh Source or or or",
    "start": "560079",
    "end": "568160"
  },
  {
    "text": "description of it you will need something that goes deeper in this case Ida Pro is perfect because it has full",
    "start": "568160",
    "end": "574240"
  },
  {
    "text": "arm support arm actually is quite a simple",
    "start": "574240",
    "end": "580120"
  },
  {
    "text": "risk uh instruction set so it reads quite easily once you get used to it",
    "start": "580120",
    "end": "585680"
  },
  {
    "text": "it's not uh has not too many complex instructions um the only complexity that",
    "start": "585680",
    "end": "592079"
  },
  {
    "text": "I know is that that you have to know all the sign tests and stuff like that but once you know then it's pretty simple to",
    "start": "592079",
    "end": "598640"
  },
  {
    "text": "follow um I made some dll signatures uh for",
    "start": "598640",
    "end": "604839"
  },
  {
    "text": "because one of the things that's also maybe good to explain what's different about a pocket",
    "start": "604839",
    "end": "611040"
  },
  {
    "text": "PC is the ROM flash ROM that it's running out of and they have a concept",
    "start": "611040",
    "end": "617240"
  },
  {
    "text": "that they call execute in place which means that uh if you load a dll in your",
    "start": "617240",
    "end": "623399"
  },
  {
    "text": "program it's not loaded in your RAM not all of it the data parts are but the",
    "start": "623399",
    "end": "629600"
  },
  {
    "text": "executable part is actually mapped virtually from the ROM part directly and it's running in ROM so it's also so it",
    "start": "629600",
    "end": "636560"
  },
  {
    "text": "can't do self modification for instance because it's really running out of the r um a drawback of it for inspection wise",
    "start": "636560",
    "end": "644839"
  },
  {
    "text": "is that you can't copy all the the programs out of there so uh they made a",
    "start": "644839",
    "end": "650720"
  },
  {
    "text": "special flag in the file system that says this is a ROM file and you can't copy it out so if you try to copy it out",
    "start": "650720",
    "end": "656399"
  },
  {
    "text": "over active sync or try to copy it uh with uh by hand out of the device it",
    "start": "656399",
    "end": "661600"
  },
  {
    "text": "doesn't work it it the OS itself will prevent it of course there are tricks around it you can try and load it and",
    "start": "661600",
    "end": "668079"
  },
  {
    "text": "then write the the the memory dump to to to dis and stuff like that uh",
    "start": "668079",
    "end": "673560"
  },
  {
    "text": "fortunately um uh a colleague or friend developed an application that will take",
    "start": "673560",
    "end": "679639"
  },
  {
    "text": "a whole ROM image and fully take it apart and reconstruct all the uh DLS and",
    "start": "679639",
    "end": "685360"
  },
  {
    "text": "executables that are in there will just create a directory with all the files and all the stuff that's in the ROM",
    "start": "685360",
    "end": "690639"
  },
  {
    "text": "image so that makes it really easy to dissect what's in there I use those DLS",
    "start": "690639",
    "end": "696399"
  },
  {
    "text": "to create create signatures for Ida so you don't need to have all the DLS present you can use these signatures in",
    "start": "696399",
    "end": "703160"
  },
  {
    "text": "Ida and all the imports and exports will will be properly",
    "start": "703160",
    "end": "708360"
  },
  {
    "text": "named okay another part is also that Linux or Linux was ported to the ipeg",
    "start": "708920",
    "end": "715079"
  },
  {
    "text": "and this was a an effort by compac originally now HP so they already worked with HTC to get",
    "start": "715079",
    "end": "723720"
  },
  {
    "text": "Linux also a head start on this device so they help developing the wot loader they know of all the hardware gpio",
    "start": "723720",
    "end": "729880"
  },
  {
    "text": "connection stuff like that that doesn't automatically translate to this device",
    "start": "729880",
    "end": "735360"
  },
  {
    "text": "it doesn't mean that you can take the ipac Linux and run it on this thing I mean there's a different display driver",
    "start": "735360",
    "end": "741040"
  },
  {
    "text": "and stuff like that but still there's a lot of internal knowledge available on on how it works in the ipac and also",
    "start": "741040",
    "end": "747440"
  },
  {
    "text": "there they have a lot of tools Chang available to do cross compilation for arm for instance that we also use to",
    "start": "747440",
    "end": "752800"
  },
  {
    "text": "make the SD card for instance um as I said in the beginning this work",
    "start": "752800",
    "end": "760440"
  },
  {
    "text": "was not purely security related um a lot of the work we did as a group called The",
    "start": "760440",
    "end": "766120"
  },
  {
    "text": "XDA Developers we have a separate website and we have a lot of stuff on on the XDA uh uh that we found along those",
    "start": "766120",
    "end": "773959"
  },
  {
    "text": "uh uh well long nights of hacking um",
    "start": "773959",
    "end": "781079"
  },
  {
    "text": "what we did was first of all we made made some tools that I talked about the there aside from the D ROM",
    "start": "782279",
    "end": "789880"
  },
  {
    "text": "dumping tool there are some tools to do acting debugging kind of like the remote debugger does but then just from command",
    "start": "789880",
    "end": "798320"
  },
  {
    "text": "line we also wrote a tool based on the experience with how we talk to the GSM",
    "start": "798839",
    "end": "804320"
  },
  {
    "text": "part called the XDA manipulator um it uses the knowledge that we have on the the internals of the GSM part to first",
    "start": "804320",
    "end": "812480"
  },
  {
    "text": "of all of course unlock the device it can also change thei the the unique",
    "start": "812480",
    "end": "818160"
  },
  {
    "text": "serial number in the device to anything you want so it's not so unique",
    "start": "818160",
    "end": "824279"
  },
  {
    "text": "anymore it's all available on the website this is a little picture of what",
    "start": "824959",
    "end": "830320"
  },
  {
    "text": "it does it can also clear the call logs so if you're not interested in people knowing how much you called with a thing",
    "start": "830320",
    "end": "836399"
  },
  {
    "text": "or how often you call or whatever uh normally it's not you can't clear it so there's no option to clear the logs uh",
    "start": "836399",
    "end": "843240"
  },
  {
    "text": "in the GSM part of the phone and this tool will do that for you so to close uh off uh a little",
    "start": "843240",
    "end": "853279"
  },
  {
    "text": "future outlook to be honest your guess is as good as mine um I'm not really",
    "start": "853279",
    "end": "862199"
  },
  {
    "text": "following you know pocket PC development or anything I'm not an official pocket",
    "start": "862199",
    "end": "867360"
  },
  {
    "text": "PC developer I have no idea are precisely what what what Microsoft and uh wants to go and do with their net",
    "start": "867360",
    "end": "876079"
  },
  {
    "text": "development what I've seen is that there's a little more attention already for security",
    "start": "876079",
    "end": "881279"
  },
  {
    "text": "features but I I wonder still if it's really tuned to to real life use uh and",
    "start": "881279",
    "end": "887360"
  },
  {
    "text": "what's real life use you want to have something that's granular something that you can tune to you your use in the",
    "start": "887360",
    "end": "892959"
  },
  {
    "text": "organization you don't want to say you're not allowed to run or download anything on this thing or",
    "start": "892959",
    "end": "899639"
  },
  {
    "text": "uh you you you're you know do whatever you want but if you CR your device it's your",
    "start": "899639",
    "end": "906160"
  },
  {
    "text": "fault I see now a device that's that's immature not only in the sense that that",
    "start": "906160",
    "end": "912000"
  },
  {
    "text": "the DSM part is not really immature but also uh using Outlook and stuff like that is is immature in a sense that it's",
    "start": "912000",
    "end": "918120"
  },
  {
    "text": "that simple on one hand that's a good thing I mean there are loads less features in a pocket PC compared to",
    "start": "918120",
    "end": "925560"
  },
  {
    "text": "what's there on the on on Outlook in the desktop so the risk of running all kinds of stuff uh unintentionally is also uh",
    "start": "925560",
    "end": "933720"
  },
  {
    "text": "quite a bit less at the moment there's the risk that they just will move all those features from the desktop to this",
    "start": "933720",
    "end": "939759"
  },
  {
    "text": "device as as it becomes more powerful for some reason people think of",
    "start": "939759",
    "end": "947040"
  },
  {
    "text": "an embedded device as something uh well that's 10 times harder to get into while",
    "start": "947040",
    "end": "953440"
  },
  {
    "text": "uh if you look at it now it's almost you know becoming the same as as a desktop PC it's running Windows it's it's",
    "start": "953440",
    "end": "959440"
  },
  {
    "text": "the same API the same kind of code uh if you look at the knowledge that's out there uh as long as you look and and and",
    "start": "959440",
    "end": "967880"
  },
  {
    "text": "and try to find it it's there if you want to know how it internally Works how the bootloader Works how all that stuff",
    "start": "967880",
    "end": "973600"
  },
  {
    "text": "works it's not that hard uh compared to much of the other stuff that we've seen today and and the day",
    "start": "973600",
    "end": "981040"
  },
  {
    "text": "before what's the drawback of it becoming easier is of course that uh more bad applications will be made and",
    "start": "981199",
    "end": "988639"
  },
  {
    "text": "uh more attackers will be uh there trying to hack your your pdas so well",
    "start": "988639",
    "end": "994680"
  },
  {
    "text": "it's a mixed mixed future I'd say and uh I don't even know what my last slide",
    "start": "994680",
    "end": "1000319"
  },
  {
    "text": "was oh yeah um just a few thank yous to some people that that also worked on this stuff and uh that I used a lot of",
    "start": "1000319",
    "end": "1008199"
  },
  {
    "text": "interesting idea and caches from so um these are the",
    "start": "1008199",
    "end": "1013360"
  },
  {
    "text": "guys basically this was uh what I had to tell you uh are there any questions",
    "start": "1013360",
    "end": "1020639"
  },
  {
    "text": "who again again the doubt because uh did I",
    "start": "1022319",
    "end": "1027520"
  },
  {
    "text": "tell it right or ah in the back we it on the conso from",
    "start": "1027520",
    "end": "1034720"
  },
  {
    "text": "the serial connection between CPU phone and thec there was this",
    "start": "1034720",
    "end": "1042919"
  },
  {
    "text": "incomings of uh yeah",
    "start": "1045120",
    "end": "1050840"
  },
  {
    "text": "yeah yeah I'm not sure why there's first nothing and then a comma and then then a size thing 23 is the size of",
    "start": "1050960",
    "end": "1059840"
  },
  {
    "text": "this yeah",
    "start": "1059840",
    "end": "1064440"
  },
  {
    "text": "yeah what's your opinion how come vir Riders haven't yet",
    "start": "1065679",
    "end": "1073440"
  },
  {
    "text": "interested um maybe because uh they are still D expensive um I'm not sure it's it's",
    "start": "1076559",
    "end": "1082640"
  },
  {
    "text": "still not um I think this one cost something like 600 for and it was even",
    "start": "1082640",
    "end": "1089919"
  },
  {
    "text": "priced down so it's not something like the the the virus riders that typically",
    "start": "1089919",
    "end": "1096600"
  },
  {
    "text": "are not the the people with the most sophisticated uh equipment uh are using",
    "start": "1096600",
    "end": "1102799"
  },
  {
    "text": "at the moment that's I think that's one of the the main things behind it it's",
    "start": "1102799",
    "end": "1108080"
  },
  {
    "text": "not because it's possible and so it's either interest in it or exposure that",
    "start": "1108080",
    "end": "1115159"
  },
  {
    "text": "you can achieve with it that that's thetical m in the market is not that",
    "start": "1115159",
    "end": "1120360"
  },
  {
    "text": "high that that also yeah so if everyone would have one then",
    "start": "1120360",
    "end": "1125400"
  },
  {
    "text": "itget but as as expensive CE it well",
    "start": "1125400",
    "end": "1132440"
  },
  {
    "text": "that's true and and you see now also it it it's starting to increase a little bit more uh recently there was the seen",
    "start": "1132440",
    "end": "1138960"
  },
  {
    "text": "SMS bug posted that that now even a little bit more people although I mean",
    "start": "1138960",
    "end": "1144679"
  },
  {
    "text": "two years ago we were already finding such bugs so it's something that's um slowly thinking sinking in and but yeah",
    "start": "1144679",
    "end": "1152520"
  },
  {
    "text": "it's it's also usage that I think that's the main thing who is using it and who can use",
    "start": "1152520",
    "end": "1158760"
  },
  {
    "text": "it yeah think you think it will ever replace the use of uh laptop somehow I",
    "start": "1158760",
    "end": "1167200"
  },
  {
    "text": "believe the the Tey is embedded like the SD with the with the acceptable side of",
    "start": "1167200",
    "end": "1174200"
  },
  {
    "text": "memory blueto maybe requir with a 21",
    "start": "1174200",
    "end": "1180440"
  },
  {
    "text": "also and having those standard input outut interface somehow somehow I",
    "start": "1180440",
    "end": "1187200"
  },
  {
    "text": "believe in the near future we will find it as a replacement for laptop maybe if",
    "start": "1187200",
    "end": "1192720"
  },
  {
    "text": "can to use what blo as an interface between your keyboard and your your your",
    "start": "1192720",
    "end": "1199480"
  },
  {
    "text": "screen I your monitor and this device will be your",
    "start": "1199480",
    "end": "1204880"
  },
  {
    "text": "processor yeah the big question is do I see that this kind of thing will replace",
    "start": "1204880",
    "end": "1210440"
  },
  {
    "text": "the laptop I'm not completely sure I think uh I do see a case",
    "start": "1210440",
    "end": "1217440"
  },
  {
    "text": "where the the real CPU and the real data storage strings and springs and that",
    "start": "1217440",
    "end": "1222919"
  },
  {
    "text": "you'll get different IO so you'll get a big screen thing for uh in the office",
    "start": "1222919",
    "end": "1229240"
  },
  {
    "text": "and you'll get uh that all talks Bluetooth or whatever and you'll get a small user interface and you just clip",
    "start": "1229240",
    "end": "1235919"
  },
  {
    "text": "your thing somewhere in your in your belt and you'll have the phone part in your hand or the PDA part in your hand",
    "start": "1235919",
    "end": "1242120"
  },
  {
    "text": "and so it will concentrate to a single place so you you don't have to know where did I put it this this day and",
    "start": "1242120",
    "end": "1249039"
  },
  {
    "text": "where's my phone and where's my PDA if it really will replace laptop use I'm I'm not sure maybe if you wait long",
    "start": "1249039",
    "end": "1255960"
  },
  {
    "text": "enough but still there are quite some differences in usability and in in yeah what you're using it for um I think it",
    "start": "1255960",
    "end": "1264400"
  },
  {
    "text": "also depends on very much on what you're using it for and not what you could could use it for because in the end it's",
    "start": "1264400",
    "end": "1271440"
  },
  {
    "text": "it's what are you using it for and I think most people still yeah don't do that much",
    "start": "1271440",
    "end": "1278039"
  },
  {
    "text": "interesting stuff with it I mean still the basic communication part getting things out receiving things checking",
    "start": "1278039",
    "end": "1285240"
  },
  {
    "text": "things but not really you're not going to do development on it or something if",
    "start": "1285240",
    "end": "1291200"
  },
  {
    "text": "you can do it on a on a proper PC so I'm not sure if it really will replace all",
    "start": "1291200",
    "end": "1298600"
  },
  {
    "text": "usage any other",
    "start": "1298600",
    "end": "1302000"
  },
  {
    "text": "questions much talking about having anuses signature",
    "start": "1303760",
    "end": "1311000"
  },
  {
    "text": "basem although there are number of uh Ian vulnerabilities concerning the GSM",
    "start": "1311000",
    "end": "1317200"
  },
  {
    "text": "part also and and plus the yeah well it's the whole thing yeah",
    "start": "1317200",
    "end": "1324440"
  },
  {
    "text": "the virus thing hasn't really happened yet or and will it ever I I'm not sure U",
    "start": "1324440",
    "end": "1330080"
  },
  {
    "text": "I think one of the things is more it's not so far much an enduser thing as as",
    "start": "1330080",
    "end": "1335360"
  },
  {
    "text": "as a backbone thing I mean if I look at what the risk is if all the phones suddenly start sending stuff uh what it",
    "start": "1335360",
    "end": "1341960"
  },
  {
    "text": "would do to gsm network or uh what it would happen because if you have full access to the device I can refesh your",
    "start": "1341960",
    "end": "1348840"
  },
  {
    "text": "device also I can destroy it um if I can destroy all brand type phones for some",
    "start": "1348840",
    "end": "1355600"
  },
  {
    "text": "brand I mean the the cost of such an incident would be huge and I wonder how",
    "start": "1355600",
    "end": "1360760"
  },
  {
    "text": "much protection they have against that kind of level of damage for the end user",
    "start": "1360760",
    "end": "1366080"
  },
  {
    "text": "I'm not so sure if in yeah it's more the data that's on there it's not the fact that you can't use it or it's more the",
    "start": "1366080",
    "end": "1373320"
  },
  {
    "text": "data that you lose I've",
    "start": "1373320",
    "end": "1378799"
  },
  {
    "text": "you have any idea well I think you better ask it from the F secure guys I think they're also",
    "start": "1378799",
    "end": "1384799"
  },
  {
    "text": "here I'm I'm not familiar with it there was also someone in the end but I'm not",
    "start": "1384799",
    "end": "1390000"
  },
  {
    "text": "sure how am I doing with time sorry device and out how how it works or",
    "start": "1390000",
    "end": "1398400"
  },
  {
    "text": "you want to do more with it I heard some people are actually try to Linux to",
    "start": "1398400",
    "end": "1404640"
  },
  {
    "text": "it like that uh well we we also looked at Linux port but currently no one was",
    "start": "1404640",
    "end": "1410080"
  },
  {
    "text": "interested enough to to really put in the time and effort because it's quite still quite an effort but yeah we are",
    "start": "1410080",
    "end": "1415840"
  },
  {
    "text": "not only looking at this so I have some friends that are looking at creating a secure phone so it's doing crypto uh and",
    "start": "1415840",
    "end": "1422640"
  },
  {
    "text": "then using a data channel to to send crypto to the other side and you have a secure device for communication for",
    "start": "1422640",
    "end": "1428440"
  },
  {
    "text": "instance so it's also looking at it from a development angle and and this was just my my input into looking at the",
    "start": "1428440",
    "end": "1435200"
  },
  {
    "text": "security level okay that that was my presentation",
    "start": "1435200",
    "end": "1440440"
  },
  {
    "text": "um welcome to your last talk at blackhead um I'm FX of phenolate and",
    "start": "1443760",
    "end": "1449120"
  },
  {
    "text": "since nobody ever believes that phenolate consists of more people than just FX I just bought them here so",
    "start": "1449120",
    "end": "1455559"
  },
  {
    "text": "they're supposed to sit here and be nice and and actually do the advertisement um",
    "start": "1455559",
    "end": "1461240"
  },
  {
    "text": "while we switch tapes and stuff okay what we're talking about today is attacking networked embedded systems in",
    "start": "1461240",
    "end": "1467360"
  },
  {
    "text": "contrast to the stuff that that um job just talked about um we're actually looking at embedded systems that are",
    "start": "1467360",
    "end": "1474279"
  },
  {
    "text": "sitting on networks and are fairly widely used already um which you can't",
    "start": "1474279",
    "end": "1480840"
  },
  {
    "text": "really say about um XDA and stuff but so the session today is going to be about",
    "start": "1480840",
    "end": "1488360"
  },
  {
    "text": "design failures um typical things where someone just didn't think um and we're",
    "start": "1488360",
    "end": "1495799"
  },
  {
    "text": "talking about different design failures we saw in the Met systems and then we're talking about how to exploit one of",
    "start": "1495799",
    "end": "1501799"
  },
  {
    "text": "those and then of course there are those software vulnerabilities like someone didn't do something right and well we're",
    "start": "1501799",
    "end": "1509799"
  },
  {
    "text": "going to discuss some of those and see if we can exploit one so what's an embedded system for the",
    "start": "1509799",
    "end": "1516919"
  },
  {
    "text": "purpose of this talk um an embedded system is a small computer device",
    "start": "1516919",
    "end": "1522640"
  },
  {
    "text": "sitting in some box or maybe actually sitting in a car or whatever",
    "start": "1522640",
    "end": "1529000"
  },
  {
    "text": "it usually runs a custom operating system um not like the windows C stuff but more like monolithic code just built",
    "start": "1529000",
    "end": "1536679"
  },
  {
    "text": "for this one single purpose um the embedded system is fulfilling like for",
    "start": "1536679",
    "end": "1542320"
  },
  {
    "text": "routers it is supposed to for one packets from A to B um for embedded",
    "start": "1542320",
    "end": "1547440"
  },
  {
    "text": "systems like a BMW seven series it's supposed to like tell you all kinds of",
    "start": "1547440",
    "end": "1553039"
  },
  {
    "text": "stuff about your um gas and whatever so",
    "start": "1553039",
    "end": "1558120"
  },
  {
    "text": "um um this is what we're looking at we're actually um we actually spent",
    "start": "1558120",
    "end": "1563840"
  },
  {
    "text": "quite a while um looking at different operating system kind of things that run",
    "start": "1563840",
    "end": "1569279"
  },
  {
    "text": "little devices because it's kind of interesting to see um how much it it",
    "start": "1569279",
    "end": "1574799"
  },
  {
    "text": "didn't change in contrast to um commonly used operating systems now one thing is that those",
    "start": "1574799",
    "end": "1582960"
  },
  {
    "text": "cannot be updated easily if you got a buck in your 7 series BMW your computer",
    "start": "1582960",
    "end": "1589159"
  },
  {
    "text": "system there is not something like a link you click and download a patch and install it you can't even go and and",
    "start": "1589159",
    "end": "1596000"
  },
  {
    "text": "take a CD and put it in and say patch BMW um you actually have to go to your dealer and ask him to update the",
    "start": "1596000",
    "end": "1603960"
  },
  {
    "text": "embedded device in your car um well I'm actually the bad thing is that those",
    "start": "1603960",
    "end": "1610640"
  },
  {
    "text": "dealers usually don't even know what a computer is so um you might actually have a hard time patching this specific",
    "start": "1610640",
    "end": "1617720"
  },
  {
    "text": "embedd Itor systems and it's actually true for most of them and of course we have no or very very limited ability to",
    "start": "1617720",
    "end": "1625880"
  },
  {
    "text": "add third party software so if the system itself sucks badly um like with",
    "start": "1625880",
    "end": "1632240"
  },
  {
    "text": "Windows you go and buy all kinds of tools install them on windows so it sucks a little bit less well with",
    "start": "1632240",
    "end": "1639320"
  },
  {
    "text": "embedded systems you can't do that that's one of the core problems now design failures um are very",
    "start": "1639320",
    "end": "1647600"
  },
  {
    "text": "very common in embedded systems and this is not a classification but it's like the three most common things we see",
    "start": "1647600",
    "end": "1655159"
  },
  {
    "text": "first of all undocumented functionality stuff that is basically not supposed to",
    "start": "1655159",
    "end": "1660200"
  },
  {
    "text": "be there um and it's often something like developer back doors because well",
    "start": "1660200",
    "end": "1666440"
  },
  {
    "text": "if you start coding this thing you get um a board with the chipset with the",
    "start": "1666440",
    "end": "1672039"
  },
  {
    "text": "chip layout you can install your software try it out burn some elements",
    "start": "1672039",
    "end": "1677440"
  },
  {
    "text": "out of it um fix it try it again as soon as you decide as a developer okay it's",
    "start": "1677440",
    "end": "1683640"
  },
  {
    "text": "let's call it beta you install it on the real box and then um well if something",
    "start": "1683640",
    "end": "1689159"
  },
  {
    "text": "goes wrong you need a way to get back in and fix it so we often have developer",
    "start": "1689159",
    "end": "1694760"
  },
  {
    "text": "back doors and then we have something um I call outo something functions now take",
    "start": "1694760",
    "end": "1700760"
  },
  {
    "text": "the case of Joey I don't know IP um going and buy an istn router so Joey",
    "start": "1700760",
    "end": "1706960"
  },
  {
    "text": "takes the istn router out of the box um plugs it in hopefully he does not plug",
    "start": "1706960",
    "end": "1712799"
  },
  {
    "text": "ISDN in the ethernet port but well assumed he didn't blow the device up 5",
    "start": "1712799",
    "end": "1718399"
  },
  {
    "text": "minutes after he took it out of the box um he's going to get a CD put the CD in",
    "start": "1718399",
    "end": "1723760"
  },
  {
    "text": "a computer and basically say well install device now Joey doesn't know",
    "start": "1723760",
    "end": "1729200"
  },
  {
    "text": "anything about IP and the vendor is try to solve that by having out of something",
    "start": "1729200",
    "end": "1734720"
  },
  {
    "text": "features so there's little program on the CD um um besides having fancy",
    "start": "1734720",
    "end": "1740159"
  },
  {
    "text": "pictures and stuff um is going to use some very special method to find a device that's not configured and going",
    "start": "1740159",
    "end": "1746960"
  },
  {
    "text": "to configure it now the problem is that those configuration options are often still um",
    "start": "1746960",
    "end": "1755200"
  },
  {
    "text": "accessible and even remotely accessible while the device is already configured",
    "start": "1755200",
    "end": "1761399"
  },
  {
    "text": "and working well then we got problems with ignored standards which is kind of very",
    "start": "1761399",
    "end": "1767720"
  },
  {
    "text": "common um one type of embedded systems we're um especially interested in is Cisco",
    "start": "1767720",
    "end": "1773200"
  },
  {
    "text": "routers and they got those habits of um there is an RC for protocol and then you",
    "start": "1773200",
    "end": "1779840"
  },
  {
    "text": "go to the Cisco web page and if you find something on The Cisco web page uh it",
    "start": "1779840",
    "end": "1786039"
  },
  {
    "text": "will say Cisco's interpretation of this protocol so it's kind of like a little",
    "start": "1786039",
    "end": "1791279"
  },
  {
    "text": "bit different always and those are always the pitfalls and well of course undocumented",
    "start": "1791279",
    "end": "1798279"
  },
  {
    "text": "um uncontrolled increase in complexity is very very critical U we all know that",
    "start": "1798279",
    "end": "1804039"
  },
  {
    "text": "if you got marketing people in your company are working for um you know how that works they come downstairs and tell",
    "start": "1804039",
    "end": "1810440"
  },
  {
    "text": "you well we need the um no idea vrml interface for your um",
    "start": "1810440",
    "end": "1818760"
  },
  {
    "text": "little print server by um tomorrow close of business so um please go ahead and",
    "start": "1818760",
    "end": "1824039"
  },
  {
    "text": "and code a 3D interface to your print server now nobody is going to um complain about that anymore because it's",
    "start": "1824039",
    "end": "1830519"
  },
  {
    "text": "standard but there is no time to think about what are the possible influences",
    "start": "1830519",
    "end": "1836399"
  },
  {
    "text": "on all the other things we implemented the same way the 3 weeks before so there",
    "start": "1836399",
    "end": "1842159"
  },
  {
    "text": "might be actually like cross referencing things that don't work out now the first case um the loosen",
    "start": "1842159",
    "end": "1850200"
  },
  {
    "text": "brick is a firewall it's a layer two firewall it runs an an operating system",
    "start": "1850200",
    "end": "1855240"
  },
  {
    "text": "with the very interesting name of Inferno and it's a custom built operating system um written by the Babs",
    "start": "1855240",
    "end": "1862159"
  },
  {
    "text": "guys it's actually pretty good and so this firewall is a layer to firewall so",
    "start": "1862159",
    "end": "1867480"
  },
  {
    "text": "it's supposed to just Bridge the traffic through and well job packets that are",
    "start": "1867480",
    "end": "1872720"
  },
  {
    "text": "evil according to the configuration now the problem here is that the operating",
    "start": "1872720",
    "end": "1878559"
  },
  {
    "text": "system wasn't designed in the first place to be a firewall operating system so the um the whole AR handling stuff is",
    "start": "1878559",
    "end": "1886720"
  },
  {
    "text": "not very fitting for a firewall which means um it passes AR on always no",
    "start": "1886720",
    "end": "1893880"
  },
  {
    "text": "matter what the configuration says if you say drop everything and you send op request through the firewall you get op",
    "start": "1893880",
    "end": "1900200"
  },
  {
    "text": "reply fine so you can basically op scan um the whole through the firewall from",
    "start": "1900200",
    "end": "1905320"
  },
  {
    "text": "the outside now there are more issues with that um especially that it will",
    "start": "1905320",
    "end": "1910880"
  },
  {
    "text": "accept our reply poisoning from the outside or From Any Given interface for",
    "start": "1910880",
    "end": "1916720"
  },
  {
    "text": "that matter um with whatever IP address is there so um what you actually can do",
    "start": "1916720",
    "end": "1922840"
  },
  {
    "text": "is send op replies with um round NE addresses and known IP addresses and",
    "start": "1922840",
    "end": "1928480"
  },
  {
    "text": "disable communication for those specific IPS now it's really bad for this thing",
    "start": "1928480",
    "end": "1935320"
  },
  {
    "text": "here which is called the lsms management server um that's the one where you click",
    "start": "1935320",
    "end": "1941240"
  },
  {
    "text": "together your rules and then upload it to the firewall and that's also the one um you see the locks on",
    "start": "1941240",
    "end": "1948360"
  },
  {
    "text": "so basically what you do is send an R reply with the lsms IP and um disable",
    "start": "1948360",
    "end": "1954519"
  },
  {
    "text": "logging and configuration for the firewall which works fairly great and another thing was that they",
    "start": "1954519",
    "end": "1962399"
  },
  {
    "text": "decided um to save performance um to have the AR c not time out well it's",
    "start": "1962399",
    "end": "1969519"
  },
  {
    "text": "actually a good idea if you want to have performance because um well you don't have to re ask for the same make address",
    "start": "1969519",
    "end": "1977559"
  },
  {
    "text": "over and over again the bad thing is what happens if you get lots of lots and lots of op repes well guess what happens",
    "start": "1977559",
    "end": "1984600"
  },
  {
    "text": "it basically crashes and and pukes all over you um second case design failures",
    "start": "1984600",
    "end": "1991360"
  },
  {
    "text": "s and Rus this is one of those um out of something features that really um kick",
    "start": "1991360",
    "end": "1997240"
  },
  {
    "text": "you in about 10 years later um the way s solve that for small devices is um",
    "start": "1997240",
    "end": "2005399"
  },
  {
    "text": "having a UDP packet with the magic magic header it's basically like 8 bytes magic",
    "start": "2005399",
    "end": "2010799"
  },
  {
    "text": "number whatever um sent to the discard Port now normally the discard Port would",
    "start": "2010799",
    "end": "2016120"
  },
  {
    "text": "basically do what the name suggest discard the packet this one is going to fill it with all the critical",
    "start": "2016120",
    "end": "2022639"
  },
  {
    "text": "information like listed here um and send it back to you um and so to enable the FN tool to",
    "start": "2022639",
    "end": "2032120"
  },
  {
    "text": "actually make it um make it configure IP addresses and stuff um there is also",
    "start": "2032120",
    "end": "2038159"
  },
  {
    "text": "weigh in the same protocol over the discard Port um to set the SNMP",
    "start": "2038159",
    "end": "2043880"
  },
  {
    "text": "Community um put the SNMP right community in the packet uh put a new IP",
    "start": "2043880",
    "end": "2049320"
  },
  {
    "text": "address in um put a new name in and the net mask send it over and the device",
    "start": "2049320",
    "end": "2054480"
  },
  {
    "text": "will reconfigure itself okay problem here is they coded",
    "start": "2054480",
    "end": "2061000"
  },
  {
    "text": "that into Taos which is their operating system for everyone who has seen SN routers it's the one with the menus with",
    "start": "2061000",
    "end": "2067520"
  },
  {
    "text": "the asky menus um now the same operating system is used in Fairly big dial inin",
    "start": "2067520",
    "end": "2074440"
  },
  {
    "text": "routers as like handling multiple T1 connections and they still do this",
    "start": "2074440",
    "end": "2081440"
  },
  {
    "text": "protocol so you set up your big diin router being an ISP or whatever um and",
    "start": "2081440",
    "end": "2087079"
  },
  {
    "text": "well for security and since you heard about the Proto test suite for SNMP and",
    "start": "2087079",
    "end": "2092638"
  },
  {
    "text": "stuff um you basically disable SNMP which leads you to the assumption that",
    "start": "2092639",
    "end": "2097760"
  },
  {
    "text": "you do not need to change the default S&P right Community well then someone",
    "start": "2097760",
    "end": "2104079"
  },
  {
    "text": "can send a maybe spoofed UDP packet um to your router give it a new name a new",
    "start": "2104079",
    "end": "2110680"
  },
  {
    "text": "IP address and a new net mask which is fairly bad another thing essent came up with",
    "start": "2110680",
    "end": "2118800"
  },
  {
    "text": "and in this one they did it totally differently is they had an idea and in",
    "start": "2118800",
    "end": "2124200"
  },
  {
    "text": "instead of straight away implementing it um they wrote an out on it it's called atmp has nothing to do with utmp and is",
    "start": "2124200",
    "end": "2133240"
  },
  {
    "text": "the sent tunnel management protocol the idea is to have um dynamically created",
    "start": "2133240",
    "end": "2140280"
  },
  {
    "text": "GRE tunnels between SN devices so that the user behind the SN device the guy",
    "start": "2140280",
    "end": "2147320"
  },
  {
    "text": "over here can actually use the network he's dialing in the same way as he would",
    "start": "2147320",
    "end": "2152760"
  },
  {
    "text": "be when he is connected locally so basically what it does is enable your window Windows Network environment",
    "start": "2152760",
    "end": "2159800"
  },
  {
    "text": "browsing um well the concept as you see is fairly complicated you got s boxes",
    "start": "2159800",
    "end": "2165400"
  },
  {
    "text": "here um actually on the corporate land it's required to have an um radio server",
    "start": "2165400",
    "end": "2171520"
  },
  {
    "text": "and stuff like that um so you need quite a lot of devices unfortunately um they",
    "start": "2171520",
    "end": "2178560"
  },
  {
    "text": "kind of like broke the whole concept because every SN router talks this",
    "start": "2178560",
    "end": "2183680"
  },
  {
    "text": "protocol even if they don't have a radio server even if they are a small small dial in device whatever it talks this",
    "start": "2183680",
    "end": "2190720"
  },
  {
    "text": "protocol so um you send in a request for creating such a goe tunnel thingy and",
    "start": "2190720",
    "end": "2197640"
  },
  {
    "text": "it's supposed by RFC uh which is written by Asen to go out and um talk to the radio server and",
    "start": "2197640",
    "end": "2205359"
  },
  {
    "text": "find out if you're supposed to have a tunnel since it doesn't have a radio server it checks the local connection",
    "start": "2205359",
    "end": "2210960"
  },
  {
    "text": "profiles now those profiles are um not completely used so you usually have one",
    "start": "2210960",
    "end": "2217599"
  },
  {
    "text": "for dial out and one for dial in or whatever and you got like 30 that 30",
    "start": "2217599",
    "end": "2222800"
  },
  {
    "text": "profiles in the list so you send the packet and you don't name the connection",
    "start": "2222800",
    "end": "2228040"
  },
  {
    "text": "so you don't give it like a username or whatever that would be used for authentication and well it goes ahead",
    "start": "2228040",
    "end": "2235119"
  },
  {
    "text": "tests the profiles has an empty profile with of course an empty name and goes like empty empty that matches cool um",
    "start": "2235119",
    "end": "2242480"
  },
  {
    "text": "sends you back a query actually a challenge um for password authentication",
    "start": "2242480",
    "end": "2249280"
  },
  {
    "text": "well you just encrypt The Challenge and send it back it goes like okay empty password empty password matches here's",
    "start": "2249280",
    "end": "2255599"
  },
  {
    "text": "your GRE tunnel brilliant idea so what can you do with that um you basically talk atmp to",
    "start": "2255599",
    "end": "2263520"
  },
  {
    "text": "any given fent router that got this stuff enabled um which is by default and",
    "start": "2263520",
    "end": "2269720"
  },
  {
    "text": "well you get a GRE tunnel ID back so you can basically go to your Cisco or",
    "start": "2269720",
    "end": "2274839"
  },
  {
    "text": "whatever you use for GRE um give it a tunnel ID send it over um got the GRE",
    "start": "2274839",
    "end": "2280040"
  },
  {
    "text": "Tunnel right into the coroporate network and well of course the rest is game",
    "start": "2280040",
    "end": "2285599"
  },
  {
    "text": "over um next design figure Cisco enhan igrp well enhanc igp is a Cisco routing",
    "start": "2285599",
    "end": "2292640"
  },
  {
    "text": "protocol as most of you probably know and it uses automatic neighbor",
    "start": "2292640",
    "end": "2298359"
  },
  {
    "text": "Discovery and we start asking the question what's the maximum number of",
    "start": "2298359",
    "end": "2303880"
  },
  {
    "text": "neighbors well you start flooding the device with neighbor and um actually it doesn't really behave",
    "start": "2303880",
    "end": "2311880"
  },
  {
    "text": "bad so it doesn't crash and stuff um but it got a problem here with again the AR",
    "start": "2311880",
    "end": "2318560"
  },
  {
    "text": "cache usually Cisco being a networking company actually knows how to code AR and stuff so what they do is um they AR",
    "start": "2318560",
    "end": "2327319"
  },
  {
    "text": "three times and then time out well didn't find the host now with this writing protocol um the Hello message",
    "start": "2327319",
    "end": "2334400"
  },
  {
    "text": "you send to it is valid for a c certain amount of time which you provide in the",
    "start": "2334400",
    "end": "2339640"
  },
  {
    "text": "packet now every time their timer for seconds actually um goes one down they",
    "start": "2339640",
    "end": "2345400"
  },
  {
    "text": "figure oops we still need to talk to this guy so we ar again um so now you",
    "start": "2345400",
    "end": "2351280"
  },
  {
    "text": "send this default hello packet over with a non-existing ipu so it will um",
    "start": "2351280",
    "end": "2356560"
  },
  {
    "text": "actually 90 times AR for you because the timer say 30 seconds if you send more",
    "start": "2356560",
    "end": "2363240"
  },
  {
    "text": "than one it will up for all of them so basically the Cisco will use every",
    "start": "2363240",
    "end": "2368319"
  },
  {
    "text": "possible CPU second it has and every possible piece of bandwidth it has",
    "start": "2368319",
    "end": "2373599"
  },
  {
    "text": "connected to itself are being for this device which is a very efficient way to",
    "start": "2373599",
    "end": "2379119"
  },
  {
    "text": "have a network wide Deni of service attack um the really bad thing about",
    "start": "2379119",
    "end": "2384480"
  },
  {
    "text": "this is that the timer value you're providing is 16 bits so the maximum is about 18",
    "start": "2384480",
    "end": "2390119"
  },
  {
    "text": "hours okay that's another problem I got with this um with this whole I",
    "start": "2390119",
    "end": "2398319"
  },
  {
    "text": "um because all iOS versions are affected but well Cisco",
    "start": "2398319",
    "end": "2404400"
  },
  {
    "text": "did not decide to fix it because it's probably too complicated and so um I'm",
    "start": "2404400",
    "end": "2411000"
  },
  {
    "text": "not selling this device yet but if there is huge demand for it we're going to build those and sell",
    "start": "2411000",
    "end": "2418160"
  },
  {
    "text": "them okay let's exploit the design failure I think I'm way behind time yes I am um HP printers there's a lot of fun",
    "start": "2418160",
    "end": "2426839"
  },
  {
    "text": "you can have with with printers um and here's why they got various access methods um you can go to the printer",
    "start": "2426839",
    "end": "2433680"
  },
  {
    "text": "talet HTTP FTP SNMP and something called pgl now you can protect the printer for",
    "start": "2433680",
    "end": "2440839"
  },
  {
    "text": "talet and HTTP you can set an admin password um you can have IP based access",
    "start": "2440839",
    "end": "2447480"
  },
  {
    "text": "restrictions based on a source IP um you can have a pgl security password well",
    "start": "2447480",
    "end": "2454640"
  },
  {
    "text": "but those things are inconsistent as you see HTTP for example is not",
    "start": "2454640",
    "end": "2461520"
  },
  {
    "text": "protected by the um IP access restrictions same holds true for SNMP",
    "start": "2461520",
    "end": "2468000"
  },
  {
    "text": "now HP has the habit of putting undocumented um Mid variables in their",
    "start": "2468000",
    "end": "2474400"
  },
  {
    "text": "mibs that will basically return the password if you query them so we got a",
    "start": "2474400",
    "end": "2480079"
  },
  {
    "text": "variable here um there's several of those depends on the on the firmware of",
    "start": "2480079",
    "end": "2485800"
  },
  {
    "text": "the printer and well you SNMP read this variable and get the admin password back",
    "start": "2485800",
    "end": "2491880"
  },
  {
    "text": "which you can instantly use to browse to your printer enter the password and basically you just owned a printer now",
    "start": "2491880",
    "end": "2501000"
  },
  {
    "text": "there is way more convenient and effective way to do the same thing pgl",
    "start": "2501000",
    "end": "2506880"
  },
  {
    "text": "pgl the printer job language um is the stuff that runs basically the whole",
    "start": "2506880",
    "end": "2512720"
  },
  {
    "text": "printing process if you got networked HP printers and you got a HP driver",
    "start": "2512720",
    "end": "2517800"
  },
  {
    "text": "um this is what the HP driver talks to the printer to set up your print job um legal size paper um 600 DP whatever",
    "start": "2517800",
    "end": "2528040"
  },
  {
    "text": "um this whole thing relies on either non password which is in",
    "start": "2528040",
    "end": "2535000"
  },
  {
    "text": "110% the case um or a pgl security",
    "start": "2535000",
    "end": "2540160"
  },
  {
    "text": "password that's actually a number between 1 and 65 um 535 well this basically takes about 6",
    "start": "2540160",
    "end": "2547720"
  },
  {
    "text": "hours remotely remotely boot forcing because there's also no lockout",
    "start": "2547720",
    "end": "2552880"
  },
  {
    "text": "mechanism or whatever um and well now we're going to look at what you can do",
    "start": "2552880",
    "end": "2558480"
  },
  {
    "text": "with pgl on the printer besides printing pgl allows here to access the",
    "start": "2558480",
    "end": "2565040"
  },
  {
    "text": "pra's F system now most people say wait a minute why does the prer have a f system the prer has RAM and has Flash",
    "start": "2565040",
    "end": "2574280"
  },
  {
    "text": "and those file systems in the early mods are actually used to spool the jobs",
    "start": "2574280",
    "end": "2580680"
  },
  {
    "text": "because if you send over the job um it supposed to spool it and then print it out um well it has to store it some way",
    "start": "2580680",
    "end": "2588640"
  },
  {
    "text": "so they got a file system on it it also contains um PCR macros very common way",
    "start": "2588640",
    "end": "2596400"
  },
  {
    "text": "um to save your printing cost and and not go to printed shop have your letter had printed on paper and then put it in",
    "start": "2596400",
    "end": "2603359"
  },
  {
    "text": "a printer but instead of that uh you go and put a PC macro in your printer and",
    "start": "2603359",
    "end": "2610040"
  },
  {
    "text": "say well every time you print something put this letter head on it good idea now",
    "start": "2610040",
    "end": "2615280"
  },
  {
    "text": "we got access to this so we can actually change information in a company's letter head which probably would be the um bank",
    "start": "2615280",
    "end": "2622760"
  },
  {
    "text": "account number um well all nice and",
    "start": "2622760",
    "end": "2627880"
  },
  {
    "text": "funny but actually the later models got more F system content they got a web server with the web server content in",
    "start": "2627880",
    "end": "2635520"
  },
  {
    "text": "the file system and they got the firmware which was not available in the",
    "start": "2635520",
    "end": "2641440"
  },
  {
    "text": "earlier models to download and well they got subsystem configuration now you can",
    "start": "2641440",
    "end": "2647319"
  },
  {
    "text": "basically think of your printer as a pgl based file server and since print shops",
    "start": "2647319",
    "end": "2652640"
  },
  {
    "text": "tend to be very large you at least got about 8 megabytes of storage or whatever",
    "start": "2652640",
    "end": "2659119"
  },
  {
    "text": "but well there are printers out there um such as the um what's that tectronics",
    "start": "2659119",
    "end": "2665480"
  },
  {
    "text": "kind of thing um that basic basically yeah that basically got about 80",
    "start": "2665480",
    "end": "2671319"
  },
  {
    "text": "gb well you can store a lot of stuff on that um this is how file system actually",
    "start": "2671319",
    "end": "2678880"
  },
  {
    "text": "on HP printer looks like um you see there's a lot of stuff in here that's fairly interesting and we're going to",
    "start": "2678880",
    "end": "2686359"
  },
  {
    "text": "discuss how to use that because pgl itself is an",
    "start": "2686359",
    "end": "2692400"
  },
  {
    "text": "escape sequence-based um protocol or language so so it's very",
    "start": "2692400",
    "end": "2698520"
  },
  {
    "text": "unconvenient to use over netcat um and we start well being bored by copy and",
    "start": "2698520",
    "end": "2704880"
  },
  {
    "text": "pasting stuff into netcat so we actually wrote a library doing this and develop a",
    "start": "2704880",
    "end": "2712000"
  },
  {
    "text": "front end for um command line um which basically gives you the ability to read",
    "start": "2712000",
    "end": "2719280"
  },
  {
    "text": "environment variables of the pr modify them write them back um have full file system access um change this",
    "start": "2719280",
    "end": "2727480"
  },
  {
    "text": "messages and remove the pgl security Now what can you do with those features",
    "start": "2727480",
    "end": "2732960"
  },
  {
    "text": "first of all let's take the the least technical challenging but the most funny changing display",
    "start": "2732960",
    "end": "2739440"
  },
  {
    "text": "messages you can set the display message that's shown when the prer is ready and",
    "start": "2739440",
    "end": "2745280"
  },
  {
    "text": "idle um to something like I'm bored fairly interesting but you can",
    "start": "2745280",
    "end": "2751160"
  },
  {
    "text": "actually send a display message and Mark it as a critical failure so the pr we go",
    "start": "2751160",
    "end": "2757680"
  },
  {
    "text": "offline um the red light's flashing and might actually say something like insert",
    "start": "2757680",
    "end": "2763119"
  },
  {
    "text": "coin um which really confuses people there",
    "start": "2763119",
    "end": "2768730"
  },
  {
    "text": "[Applause] is yeah um there is another thing um",
    "start": "2768730",
    "end": "2775680"
  },
  {
    "text": "with the environment variables in the same context there is a environment variable called CP lock it is for",
    "start": "2775680",
    "end": "2782599"
  },
  {
    "text": "locking the front panel so while it flashes insert coin you you can actually set CP lock to maximum so no button on",
    "start": "2782599",
    "end": "2790079"
  },
  {
    "text": "the front panel will ever work again um this is well of course you can be really",
    "start": "2790079",
    "end": "2796200"
  },
  {
    "text": "evil and set environment variables for a number of copies um set it to hard 999",
    "start": "2796200",
    "end": "2802520"
  },
  {
    "text": "and it will print 999 copies of everything um but yeah you don't want to",
    "start": "2802520",
    "end": "2807800"
  },
  {
    "text": "like destroy the few Woods we still have out there um actually this guy over on",
    "start": "2807800",
    "end": "2814319"
  },
  {
    "text": "the wall wave to the crow please um actually went ahead and wrote a",
    "start": "2814319",
    "end": "2819640"
  },
  {
    "text": "Windows version for it so that MCS can actually start hecking printers um this",
    "start": "2819640",
    "end": "2825880"
  },
  {
    "text": "is how it looks like um notice the logo is no copyright violation um you see you",
    "start": "2825880",
    "end": "2832640"
  },
  {
    "text": "got the same features as discussed right here um f system environment variables",
    "start": "2832640",
    "end": "2838240"
  },
  {
    "text": "display and well this is how you access your PR now you got a browser like",
    "start": "2838240",
    "end": "2843559"
  },
  {
    "text": "interface and well of course you got those envir variables it will tell you what valid input is you're not required",
    "start": "2843559",
    "end": "2851119"
  },
  {
    "text": "to send valid input um and you can basically start playing with your",
    "start": "2851119",
    "end": "2856559"
  },
  {
    "text": "printer from the fun part to the scary part later versions of HP printers run",
    "start": "2856559",
    "end": "2862559"
  },
  {
    "text": "something that's called the shym the shym um is a Java virtual machine for",
    "start": "2862559",
    "end": "2868040"
  },
  {
    "text": "embedded systems um this is where it's officially supported 9,000 and those",
    "start": "2868040",
    "end": "2873920"
  },
  {
    "text": "four series pries here um the ,150 runs it as well and actually um we found out",
    "start": "2873920",
    "end": "2880839"
  },
  {
    "text": "that being unsupported it's the most stable platform um the shym comes completely with all",
    "start": "2880839",
    "end": "2889000"
  },
  {
    "text": "the stuff you need classes um the HTML files for the printer the graphics for",
    "start": "2889000",
    "end": "2895760"
  },
  {
    "text": "the web server um whatever is required so um by just exchanging those HTML",
    "start": "2895760",
    "end": "2904720"
  },
  {
    "text": "files and the graphics and stuff you you can basically build whatever you want on the web server of the printer now you",
    "start": "2904720",
    "end": "2911079"
  },
  {
    "text": "can one thing actually tried out is um you can run a p side of a",
    "start": "2911079",
    "end": "2918040"
  },
  {
    "text": "printer it all lives in a file system and we have seen that um we got full",
    "start": "2918920",
    "end": "2925240"
  },
  {
    "text": "file system access already so of course the next thing you're thinking about is",
    "start": "2925240",
    "end": "2930480"
  },
  {
    "text": "like putting stuff in the file system that's going to be executed well this thing here is from",
    "start": "2930480",
    "end": "2936040"
  },
  {
    "text": "the HP web page it basically says um shy is cool and it it's used all over the",
    "start": "2936040",
    "end": "2942880"
  },
  {
    "text": "place not only in printer um unfortunately that's true um we are",
    "start": "2942880",
    "end": "2949240"
  },
  {
    "text": "bound to see more HP stuff coming with shy VM now shym comes with something that's",
    "start": "2949240",
    "end": "2955599"
  },
  {
    "text": "called the loader service in case HP wants to improve whatever is on a prer",
    "start": "2955599",
    "end": "2963440"
  },
  {
    "text": "um with more functionality they can can upload Services now this loader has two",
    "start": "2963440",
    "end": "2971000"
  },
  {
    "text": "um issues for us first of all it validates jar signatures when you upload",
    "start": "2971000",
    "end": "2976480"
  },
  {
    "text": "a jar it has to be signed by HP and second of all it's so crappy it doesn't work now the second thing turned out to",
    "start": "2976480",
    "end": "2984160"
  },
  {
    "text": "be a good message because HP went ahead and said well this one sucks let's write",
    "start": "2984160",
    "end": "2989720"
  },
  {
    "text": "something that does not suck that badly and so they did and well this one is",
    "start": "2989720",
    "end": "2997760"
  },
  {
    "text": "shipped as a signed jar but itself does not validate if uploaded jar is signed",
    "start": "2997760",
    "end": "3005599"
  },
  {
    "text": "good for us now we can basically upload code but instead of using the web browser clicky clicky kind of way we can",
    "start": "3005599",
    "end": "3012799"
  },
  {
    "text": "actually go to the file system there is a text file called CS config and basically um modify the",
    "start": "3012799",
    "end": "3019640"
  },
  {
    "text": "settings and have it load different Java classes and execute the stuff now the",
    "start": "3019640",
    "end": "3024960"
  },
  {
    "text": "last Point here says all the classes and documentations are weable since um def content there are not HP claims that",
    "start": "3024960",
    "end": "3032000"
  },
  {
    "text": "there is no connection between def content and this decision but well the",
    "start": "3032000",
    "end": "3037119"
  },
  {
    "text": "stuff is no longer online luckily they released the whole shy server 4.0 under",
    "start": "3037119",
    "end": "3042720"
  },
  {
    "text": "the lgpl um right before they Clos the web page which really well didn't make sense",
    "start": "3042720",
    "end": "3050480"
  },
  {
    "text": "but there are still lots of locations in the internet where you can download it so if you want to write code for it this",
    "start": "3050480",
    "end": "3056280"
  },
  {
    "text": "is the place to go yeah this is basically the same thing you can upload easy loader to yeah via the web",
    "start": "3056280",
    "end": "3064240"
  },
  {
    "text": "interface um have it start and upload your jaw file or um upload your class",
    "start": "3064240",
    "end": "3070720"
  },
  {
    "text": "files and modify CS config same thing well problem here is shym isn't",
    "start": "3070720",
    "end": "3078799"
  },
  {
    "text": "really a patchy group code which means that um next to everything besides",
    "start": "3078799",
    "end": "3084000"
  },
  {
    "text": "moving the mouse kills it um too many threats shym kills um you",
    "start": "3084000",
    "end": "3090799"
  },
  {
    "text": "connect to unreachable host or port on some phone where versions it will die um",
    "start": "3090799",
    "end": "3097000"
  },
  {
    "text": "it doesn't always throw an exception which is fairly bad for Java because Java kind of like requires exceptions to",
    "start": "3097000",
    "end": "3104359"
  },
  {
    "text": "find out if something went wrong um and if you run shy on your host on your PC",
    "start": "3104359",
    "end": "3112920"
  },
  {
    "text": "um it will behave completely differently than on a PR well if you want to play with the stuff",
    "start": "3112920",
    "end": "3119640"
  },
  {
    "text": "this SNP variable here um is fairly important for you that's used to reset",
    "start": "3119640",
    "end": "3124720"
  },
  {
    "text": "the printer what can you do with that well",
    "start": "3124720",
    "end": "3130079"
  },
  {
    "text": "first thing we thought was it would be kind of neat if the port uh if the printer would actually start Port",
    "start": "3130079",
    "end": "3135680"
  },
  {
    "text": "scanning web servers um especially for IDs administrators it's a nightmare so",
    "start": "3135680",
    "end": "3142960"
  },
  {
    "text": "um we actually wrote a webbased port scanner um where you can enter the IP and the number of ports and if there is",
    "start": "3142960",
    "end": "3149640"
  },
  {
    "text": "the right firmware on it um you can basically have the printer port scan the web server or whatever you like um by",
    "start": "3149640",
    "end": "3157960"
  },
  {
    "text": "the way IDs correlation tools first of all we throw out all messages that are",
    "start": "3157960",
    "end": "3163599"
  },
  {
    "text": "sourced of prur because that can't happen um I thought that's fairly",
    "start": "3163599",
    "end": "3168799"
  },
  {
    "text": "interesting to um do as very first thing in the correlation process then we figured well you got a",
    "start": "3168799",
    "end": "3177319"
  },
  {
    "text": "password that's encrypted and you don't want to burn your um laptop CPU power",
    "start": "3177319",
    "end": "3182480"
  },
  {
    "text": "but the printer actually got myip CPUs um which are fairly fast and so we wrote",
    "start": "3182480",
    "end": "3189400"
  },
  {
    "text": "a web based crack tool for it where you can copy and paste your cryp string in there and and tell it the character set",
    "start": "3189400",
    "end": "3196440"
  },
  {
    "text": "to brute force and it's going to do the work and and put the character um put the password on a web page and you can",
    "start": "3196440",
    "end": "3204280"
  },
  {
    "text": "like 2 Days Later serve to the printer and and see if it corrected or not and then well based on this whole",
    "start": "3204280",
    "end": "3211480"
  },
  {
    "text": "IDs thing um lately we wrote um BNC",
    "start": "3211480",
    "end": "3217000"
  },
  {
    "text": "which is a transparent TCP proxy so you can basically tell it um let's see we got screenshots here yeah you can",
    "start": "3217000",
    "end": "3223400"
  },
  {
    "text": "basically tell it um the remote system and the remote port and the local printer port and like tunnel yourself",
    "start": "3223400",
    "end": "3228720"
  },
  {
    "text": "through a printer which is fairly interesting when you do it um to access",
    "start": "3228720",
    "end": "3235119"
  },
  {
    "text": "RSC things HP came up with for the shy VM um well shy service first of all are",
    "start": "3235440",
    "end": "3242640"
  },
  {
    "text": "fully trusted between each other so the same thing as um job was talking about in the phones is true here if the code",
    "start": "3242640",
    "end": "3250680"
  },
  {
    "text": "runs on a priner it can do whatever it wants there are several services offered",
    "start": "3250680",
    "end": "3256400"
  },
  {
    "text": "um by HP I'm not entirely sure um how many of those are still available um",
    "start": "3256400",
    "end": "3261520"
  },
  {
    "text": "just to mention two of those the Notifier service um can not ify You by",
    "start": "3261520",
    "end": "3267119"
  },
  {
    "text": "HTTP or email um if an interesting event happened now an interesting event is",
    "start": "3267119",
    "end": "3273040"
  },
  {
    "text": "defined by yourself so um I would for example Define um the CEO printing uh 6",
    "start": "3273040",
    "end": "3279079"
  },
  {
    "text": "in the evening as an interesting event and would really like to have a copy of this print job um the other service that",
    "start": "3279079",
    "end": "3287200"
  },
  {
    "text": "really really um matter us thinking is the shy mail service which is quote",
    "start": "3287200",
    "end": "3293000"
  },
  {
    "text": "designed to work across firewalls unquote No there is no new protocol there is no magic what it does is it has",
    "start": "3293000",
    "end": "3300000"
  },
  {
    "text": "an IP uh it has an email account somewhere outside let's say Hotmail and",
    "start": "3300000",
    "end": "3305200"
  },
  {
    "text": "it's constantly popping off mail from Hotmail and seeing if there is an command in there so if there is it will",
    "start": "3305200",
    "end": "3311680"
  },
  {
    "text": "execute a command and send you a reply fairly nice um so you don't have to touch the printer anymore you basically",
    "start": "3311680",
    "end": "3318400"
  },
  {
    "text": "send him an email so if you want to screw around in",
    "start": "3318400",
    "end": "3323839"
  },
  {
    "text": "companies usually the the days after blackheads are fairly bad for um companies that have lots of printers um",
    "start": "3323839",
    "end": "3331119"
  },
  {
    "text": "this is where you get the tools and well communicate with your people over the um",
    "start": "3331119",
    "end": "3337400"
  },
  {
    "text": "display and we go on to something bit more serious which is software",
    "start": "3337400",
    "end": "3344119"
  },
  {
    "text": "vulnerabilities um classic mistakes are also made in embedded systems embedded system developer are not any smarter",
    "start": "3344119",
    "end": "3351359"
  },
  {
    "text": "than those writing Windows code or whatever um they just got smaller devices",
    "start": "3351359",
    "end": "3357160"
  },
  {
    "text": "so they do the same things input validation FS format screen buffer overflow cross-site scripting you name",
    "start": "3357160",
    "end": "3363559"
  },
  {
    "text": "it the second Point here most HTTP demons are vulnerable um correction all",
    "start": "3363559",
    "end": "3371280"
  },
  {
    "text": "I have to see one single HTTP demon on an embedded device that's not totally toast example yesterday you might",
    "start": "3371280",
    "end": "3377400"
  },
  {
    "text": "actually have noticed that the internet connection here um went down for a while well they got three different DSL",
    "start": "3377400",
    "end": "3385680"
  },
  {
    "text": "routers three different brands three different web servers I tested one single",
    "start": "3385680",
    "end": "3390839"
  },
  {
    "text": "vulnerability they're all toast they all crashed it was like the first try three",
    "start": "3390839",
    "end": "3397640"
  },
  {
    "text": "different devices three different web servers same issue by the way if you want know what it is it was a long",
    "start": "3397640",
    "end": "3404280"
  },
  {
    "text": "username um so it it seems like the the fact that there are limited resources",
    "start": "3404280",
    "end": "3410359"
  },
  {
    "text": "and it's well like it's a black box nobody is going to do anything with it",
    "start": "3410359",
    "end": "3415680"
  },
  {
    "text": "um they just don't check stuff length checks um functionality input validation",
    "start": "3415680",
    "end": "3422319"
  },
  {
    "text": "whatever now other buffer overflows besides um Hotel DSL routers C routers",
    "start": "3422319",
    "end": "3429559"
  },
  {
    "text": "um now actually losen product fairly good router got a web server long URL get a request toast is the routed um",
    "start": "3429559",
    "end": "3436960"
  },
  {
    "text": "rather Network printers you don't even need to send along get request or whatever you just serve to the printer",
    "start": "3436960",
    "end": "3443520"
  },
  {
    "text": "it asks you for a password you hold the a key for a while F click on submit the printer is",
    "start": "3443520",
    "end": "3449440"
  },
  {
    "text": "gone um HP proov switch fairly funny thing because usually if you got SNMP",
    "start": "3449440",
    "end": "3455839"
  },
  {
    "text": "right um it doesn't matter you just own the thing and you can modify everything",
    "start": "3455839",
    "end": "3462280"
  },
  {
    "text": "but this vulnerability here is um very handy for attackers because you go there",
    "start": "3462280",
    "end": "3468280"
  },
  {
    "text": "um you fill this oid here with 85 characters and nothing happens this switch works perfectly",
    "start": "3468280",
    "end": "3476640"
  },
  {
    "text": "um now as soon as the administrator um has the idea of talting to the switch or",
    "start": "3476640",
    "end": "3482520"
  },
  {
    "text": "using the web interface the switch will crash which is very good if you're in a network and you're the Evo guy you fill",
    "start": "3482520",
    "end": "3489000"
  },
  {
    "text": "it up you start hacking around and as soon as the switch crashes you know someone is looking for",
    "start": "3489000",
    "end": "3494280"
  },
  {
    "text": "you and even stuff like really small things um the SE I9 is a pocket print",
    "start": "3494280",
    "end": "3501720"
  },
  {
    "text": "server size of a cigarette pack um for all the nonsmokers this is how a cigarette pack looks like and this one",
    "start": "3501720",
    "end": "3509599"
  },
  {
    "text": "same thing you get have a long get request it will crash which is very bad for the printers actually because if",
    "start": "3509599",
    "end": "3515680"
  },
  {
    "text": "it's connected to a laser printer for example um the laser printer really dislikes um being reseted um over the",
    "start": "3515680",
    "end": "3523480"
  },
  {
    "text": "centronics connection while printing something so you can basically destroy",
    "start": "3523480",
    "end": "3529440"
  },
  {
    "text": "the printer with it this is how the whole device looks like nobody is going to um consider this something that might",
    "start": "3529440",
    "end": "3537079"
  },
  {
    "text": "be vulnerable or something that might be even interesting for attackers but well",
    "start": "3537079",
    "end": "3542640"
  },
  {
    "text": "you can actually turn it into an a tech platform if you want now common misconceptions here",
    "start": "3542640",
    "end": "3549039"
  },
  {
    "text": "embedded systems are harder to exploit than multi-purpose operating systems um sure you don't have a",
    "start": "3549039",
    "end": "3556240"
  },
  {
    "text": "debugger you don't have the classic concept of a shell so what are you going to do um you have to reverse engineer",
    "start": "3556240",
    "end": "3562839"
  },
  {
    "text": "the whole thing because well there is no published API um it's all one big bunch of code um you sometimes don't even know",
    "start": "3562839",
    "end": "3570079"
  },
  {
    "text": "what CPU it's running on um you have to do that to need all the cist calls",
    "start": "3570079",
    "end": "3576039"
  },
  {
    "text": "Library calls stuff like that to actually make something happen and well since you're not going to do all this",
    "start": "3576039",
    "end": "3582559"
  },
  {
    "text": "the worst thing that will happen is well the device crashes reboots whatsoever I don't think",
    "start": "3582559",
    "end": "3589480"
  },
  {
    "text": "so let's see Cisco iOS is well first of all one of our major and preferred",
    "start": "3589480",
    "end": "3597200"
  },
  {
    "text": "playgrounds um and it's also a perfect example for an embedded system OS",
    "start": "3597200",
    "end": "3603000"
  },
  {
    "text": "because it's a huge chunk of code it doesn't have any API and it got lots of bugs",
    "start": "3603000",
    "end": "3608960"
  },
  {
    "text": "so we see if we can exploit an overflow condition in",
    "start": "3608960",
    "end": "3615000"
  },
  {
    "text": "iOS the thing is it's tightly integrated into the um operating system everything",
    "start": "3615000",
    "end": "3621880"
  },
  {
    "text": "is tightly integrated so if something goes wrong it would crash and well but according to Cisco's website",
    "start": "3621880",
    "end": "3629599"
  },
  {
    "text": "memory corruption is the absolute most common case for a Cisco to crash well so",
    "start": "3629599",
    "end": "3635559"
  },
  {
    "text": "that smells like a heap overflow there are in fact steak overflows but um the",
    "start": "3635559",
    "end": "3641480"
  },
  {
    "text": "most common thing is a heap overflow and well we use this tfp long file name",
    "start": "3641480",
    "end": "3647599"
  },
  {
    "text": "thing for the discussion here this is from The Cisco tfdp advisory the only",
    "start": "3647599",
    "end": "3652880"
  },
  {
    "text": "interesting part on it is actually that they still talk about um exploitation of the vulnerability might actually lead in",
    "start": "3652880",
    "end": "3659400"
  },
  {
    "text": "Deni of service and this is how it looks like on the console everyone who did security",
    "start": "3659400",
    "end": "3665480"
  },
  {
    "text": "research for a while might actually notice all those um for1 for1 for1 for one here so um we basically send way too",
    "start": "3665480",
    "end": "3672799"
  },
  {
    "text": "many A's for the F name and it crashes how does the Heap look on Cisco",
    "start": "3672799",
    "end": "3680359"
  },
  {
    "text": "Systems it's basically the same thing as on on most other common operating systems it's just a bunch of blocks",
    "start": "3680359",
    "end": "3687520"
  },
  {
    "text": "linked together in a double link list we have a next pointer and a previous pointer um it's hanging off a tree",
    "start": "3687520",
    "end": "3695839"
  },
  {
    "text": "structure and well a single block actually um is in multiple link",
    "start": "3695839",
    "end": "3703920"
  },
  {
    "text": "lists one block this is how it looks like um one of those boxes is 32 bytes",
    "start": "3703920",
    "end": "3711240"
  },
  {
    "text": "white and this is the header for everything you allocate in iOS if if you allocate one bite you get all of this so",
    "start": "3711240",
    "end": "3719680"
  },
  {
    "text": "if you ever wondered why you have to put in new memory into your Cisco box every time you need a new feature this is why",
    "start": "3719680",
    "end": "3726680"
  },
  {
    "text": "you got memory overhead of 40 bytes so what we got the static magic um the",
    "start": "3726680",
    "end": "3733200"
  },
  {
    "text": "process ID an allocation space check that's actually supposed to be used for",
    "start": "3733200",
    "end": "3738960"
  },
  {
    "text": "random canaries um well it's usually null or let's say it's always null um we",
    "start": "3738960",
    "end": "3745960"
  },
  {
    "text": "got addresses from who allocated it and how is it called we got the next pointer previous pointer we got a size field",
    "start": "3745960",
    "end": "3754079"
  },
  {
    "text": "with the usage bit if the block is used or not we got a reference count just to",
    "start": "3754079",
    "end": "3759319"
  },
  {
    "text": "make sure that we need another 32 bytes to reflect the one bit we just said here",
    "start": "3759319",
    "end": "3765400"
  },
  {
    "text": "um and we got a static canery that's called the Red Zone which is um used by",
    "start": "3765400",
    "end": "3771480"
  },
  {
    "text": "iOS to find out if it it up or not so um the idea here is to fill a host",
    "start": "3771480",
    "end": "3779599"
  },
  {
    "text": "block which is well we're hosted in this block so this is our data here um",
    "start": "3779599",
    "end": "3785559"
  },
  {
    "text": "overwrite the next header and basically influence the memory management so we",
    "start": "3785559",
    "end": "3790720"
  },
  {
    "text": "got arbitrary memory rights same thing as with Linux and windows Heap",
    "start": "3790720",
    "end": "3795839"
  },
  {
    "text": "overflows this is how it looks like that's the idea um now most of those pointer",
    "start": "3795839",
    "end": "3802799"
  },
  {
    "text": "exchanges even on um commonly used operating system that are exploited in Heap overflows are based of um",
    "start": "3802799",
    "end": "3809680"
  },
  {
    "text": "exploitation up on free so looking at How Free Works in iOS",
    "start": "3809680",
    "end": "3815319"
  },
  {
    "text": "is um we got this double link list here and on a free it actually has to take",
    "start": "3815319",
    "end": "3822319"
  },
  {
    "text": "one of those blocks out of the used list um and well fix the list so it actually",
    "start": "3822319",
    "end": "3829240"
  },
  {
    "text": "steps over to block so pointer exchange takes place interesting enough um this system",
    "start": "3829240",
    "end": "3836279"
  },
  {
    "text": "only with the information in the host block now here are the requirements um",
    "start": "3836279",
    "end": "3844279"
  },
  {
    "text": "my assumption is that at some point in time um the iOS people writing the code",
    "start": "3844279",
    "end": "3850200"
  },
  {
    "text": "figured out that they got way too many Heap overflows and since stuff keeps happening that is kind of funny when you",
    "start": "3850200",
    "end": "3856880"
  },
  {
    "text": "write in Heap regions you're not supposed to um they wrote a little process that is basically like a",
    "start": "3856880",
    "end": "3863240"
  },
  {
    "text": "babysitter um starts up every half a minute or whatever um and walks down the link list to find out if something went",
    "start": "3863240",
    "end": "3870279"
  },
  {
    "text": "wrong or not and this one checks if there is a magic which is as we know",
    "start": "3870279",
    "end": "3876440"
  },
  {
    "text": "static value it doesn't check all the stuff here including the next pointer it just ignores the next pointer it will",
    "start": "3876440",
    "end": "3882480"
  },
  {
    "text": "check the previous pointer it will check the size and the usage field and well it",
    "start": "3882480",
    "end": "3887760"
  },
  {
    "text": "will check the Red Zone and this check heaps process is the one where we just",
    "start": "3887760",
    "end": "3892880"
  },
  {
    "text": "saw the message saying Red Zone overflow blah blah I'm going to reboot um that's",
    "start": "3892880",
    "end": "3898119"
  },
  {
    "text": "the one so this is the only check we have to think about now as you might have seen here",
    "start": "3898119",
    "end": "3906760"
  },
  {
    "text": "the next pointer is actually not checked so since this is a static value and this",
    "start": "3906760",
    "end": "3912200"
  },
  {
    "text": "is all stuff nobody cares about um we can basically overflow up to here and make",
    "start": "3912200",
    "end": "3919279"
  },
  {
    "text": "it use this next pointer when it free this block so we take the first Target",
    "start": "3919279",
    "end": "3924880"
  },
  {
    "text": "2500 um as you see here we overflow the whole thing put some crap in there um the only",
    "start": "3924880",
    "end": "3933319"
  },
  {
    "text": "interesting part here is actually the Red Zone to close the first block um the",
    "start": "3933319",
    "end": "3938359"
  },
  {
    "text": "magic for the next header and then well we can put stuff in here and this down",
    "start": "3938359",
    "end": "3943480"
  },
  {
    "text": "here is the um memory address of the NV Ram anyone has an idea why NV Ram is",
    "start": "3943480",
    "end": "3949680"
  },
  {
    "text": "kind of important here anyone yeah",
    "start": "3949680",
    "end": "3956319"
  },
  {
    "text": "this is where the config lives now the config contains the passwords right and after all we want to attack the router",
    "start": "3956319",
    "end": "3963359"
  },
  {
    "text": "and actually take it over so by sending this it will perform the pointer",
    "start": "3963359",
    "end": "3969400"
  },
  {
    "text": "exchange and since on the 2500 every process is allowed to write in the NV",
    "start": "3969400",
    "end": "3975200"
  },
  {
    "text": "Ram it will take the other pointer the previous pointer and actually write it",
    "start": "3975200",
    "end": "3980359"
  },
  {
    "text": "right into the MV Ram now question is what's so cool about like writing",
    "start": "3980359",
    "end": "3986400"
  },
  {
    "text": "unpredictable crap into the EnV Ram um so cool about this is well the nvram is",
    "start": "3986400",
    "end": "3992240"
  },
  {
    "text": "checked so as soon as the device figures out oops something wrong um memory is",
    "start": "3992240",
    "end": "3998000"
  },
  {
    "text": "totally toast I just rode right into the NV Ram I'm going to reboot it's going to",
    "start": "3998000",
    "end": "4003799"
  },
  {
    "text": "do that reboot check if there is a config load the config calculate checkm",
    "start": "4003799",
    "end": "4010079"
  },
  {
    "text": "figure out the checkm doesn't match so I'm not running this config but to be",
    "start": "4010079",
    "end": "4015119"
  },
  {
    "text": "not useless piece of Chunk um sitting somewhere and and crying for help it's",
    "start": "4015119",
    "end": "4020480"
  },
  {
    "text": "actually crying for help on the network um it basically what we do is we send the exploit it we reboot and then",
    "start": "4020480",
    "end": "4027119"
  },
  {
    "text": "it will cry out on the network could someone please provide a configuration for me which we will happily",
    "start": "4027119",
    "end": "4035160"
  },
  {
    "text": "do but well beside being um very easy it",
    "start": "4035880",
    "end": "4041119"
  },
  {
    "text": "we have to be local and we have to provide the config on a local network and it has to be a 25 hour and we",
    "start": "4041119",
    "end": "4048000"
  },
  {
    "text": "actually want to do this remotely so we have to get around those requirements the first thing is the",
    "start": "4048000",
    "end": "4054920"
  },
  {
    "text": "previous pointer here as I say this one is um checked so um the previous pointer",
    "start": "4054920",
    "end": "4060480"
  },
  {
    "text": "is checked by this um fairly effective test here so there is only one single",
    "start": "4060480",
    "end": "4065799"
  },
  {
    "text": "solution for it um I didn't find a good way to predict it so um I um actually",
    "start": "4065799",
    "end": "4073200"
  },
  {
    "text": "took a brutal way to predict it but killing the device first uncontrolled overflow just a bunch of pH um and when",
    "start": "4073200",
    "end": "4080319"
  },
  {
    "text": "it comes back up we actually have an idea how the memory layout looks like",
    "start": "4080319",
    "end": "4085480"
  },
  {
    "text": "because every time it boots it will do the same things in the same serial um",
    "start": "4085480",
    "end": "4090720"
  },
  {
    "text": "matter and well so we actually know some addresses and we can use those in a",
    "start": "4090720",
    "end": "4097400"
  },
  {
    "text": "second overflow um writing this new BL header what we want to do here um when",
    "start": "4097400",
    "end": "4105758"
  },
  {
    "text": "we actually built the whole block header and step over the previous pointer is",
    "start": "4105759",
    "end": "4111359"
  },
  {
    "text": "this is the stuff we just discussed and then for a free memory block there's even more Header",
    "start": "4111359",
    "end": "4117159"
  },
  {
    "text": "information um just in case you you have enough memory um there is four byes",
    "start": "4117159",
    "end": "4124440"
  },
  {
    "text": "padding another magic another code address more padding more pading and",
    "start": "4124440",
    "end": "4129838"
  },
  {
    "text": "then we got a free next and a free previous pointer those pointers are used in another double in list for free",
    "start": "4129839",
    "end": "4137080"
  },
  {
    "text": "blocks so um those pointers are especially important when um blocks are",
    "start": "4137080",
    "end": "4143679"
  },
  {
    "text": "merged together you got two small memory blocks just freed and and iOS figures out oh they're next to each other so I",
    "start": "4143679",
    "end": "4149679"
  },
  {
    "text": "make one big block out of it and luckily those pointers are not checked",
    "start": "4149679",
    "end": "4155640"
  },
  {
    "text": "at all nobody cares about them so now we got the perfect place for arbitrary",
    "start": "4155640",
    "end": "4162278"
  },
  {
    "text": "memory right um by providing those two pointer here this is the PO exchange",
    "start": "4162279",
    "end": "4167400"
  },
  {
    "text": "taking place fairly predictable and well we also got the size field uh as I said",
    "start": "4167400",
    "end": "4174758"
  },
  {
    "text": "the size field is checked um but it is checked with a 32 um bit variable so as",
    "start": "4174759",
    "end": "4182480"
  },
  {
    "text": "soon as they calculate something um it they will shift data next and forth and",
    "start": "4182480",
    "end": "4188199"
  },
  {
    "text": "by providing this number here um they will actually have a 100% in overflow",
    "start": "4188199",
    "end": "4194278"
  },
  {
    "text": "and end up at the same place um after adding stuff that they started from so",
    "start": "4194279",
    "end": "4199880"
  },
  {
    "text": "it's always valid because it points to the same thing and well that's easy so",
    "start": "4199880",
    "end": "4205880"
  },
  {
    "text": "we can overflow up to the previous pointer and have an arbitrary memory right now what",
    "start": "4205880",
    "end": "4212080"
  },
  {
    "text": "to do with an arbitrary memory write we could say um well idiot and write it to",
    "start": "4212080",
    "end": "4218320"
  },
  {
    "text": "the console but the more effective thing to do here is find places in code that",
    "start": "4218320",
    "end": "4224920"
  },
  {
    "text": "will be used as return addresses there is a thing called a process array that's",
    "start": "4224920",
    "end": "4230239"
  },
  {
    "text": "basically array of all processes ordered by pit and those in turn every entry in",
    "start": "4230239",
    "end": "4236320"
  },
  {
    "text": "this array points to a huge chunk of memory that contains everything you wanted to know about the process and a",
    "start": "4236320",
    "end": "4241600"
  },
  {
    "text": "lots of stuff you didn't want to know but um the first two fields of this",
    "start": "4241600",
    "end": "4246719"
  },
  {
    "text": "block are actually the stack pointer and the um stack segment",
    "start": "4246719",
    "end": "4253360"
  },
  {
    "text": "address now we actually know where the stack is and since this is an embedded",
    "start": "4253360",
    "end": "4258560"
  },
  {
    "text": "system in a huge chunk of code there is no protection against one process writing in someone else's area um so we",
    "start": "4258560",
    "end": "4265320"
  },
  {
    "text": "basically can write into the stack um into the process array into process",
    "start": "4265320",
    "end": "4272360"
  },
  {
    "text": "information record into whatever we want um so we can override frame pointers return addresses all the juicy stuff we",
    "start": "4272360",
    "end": "4279520"
  },
  {
    "text": "know from um textbook exploitation the next thing is okay okay",
    "start": "4279520",
    "end": "4285520"
  },
  {
    "text": "we can take the processor overriding pointers and see um and and actually",
    "start": "4285520",
    "end": "4290760"
  },
  {
    "text": "make it execute our code but how do we deliver the code because the problem here is that on iOS if you send",
    "start": "4290760",
    "end": "4298320"
  },
  {
    "text": "something and it's freed it's actually over written it's actually deleted by OD",
    "start": "4298320",
    "end": "4305159"
  },
  {
    "text": "um I assume that they actually got really problems in an earlier version of iOS um using box that were already free",
    "start": "4305159",
    "end": "4313000"
  },
  {
    "text": "so they decided to really delete the memory um but since the fake header we are building um uses the free Header",
    "start": "4313000",
    "end": "4321000"
  },
  {
    "text": "information for free Block um for the pointer exchange it's already considered free so we can append the code at this",
    "start": "4321000",
    "end": "4329000"
  },
  {
    "text": "point and have it execute this code SH code um or however you call it",
    "start": "4329000",
    "end": "4336719"
  },
  {
    "text": "code for the pr U code for the uh routers um will be platform dependent",
    "start": "4336719",
    "end": "4342920"
  },
  {
    "text": "which is a bad thing you have to write new code for every different platform because Cisco tends to um maintain a zoo",
    "start": "4342920",
    "end": "4349920"
  },
  {
    "text": "of CPUs they support and well one example here is um based on a Cisco",
    "start": "4349920",
    "end": "4356840"
  },
  {
    "text": "1600 it got a normal Motorola um 68k CPU",
    "start": "4356840",
    "end": "4363320"
  },
  {
    "text": "and well this one has memory registers so since we are not allowed to directly",
    "start": "4363320",
    "end": "4370159"
  },
  {
    "text": "write into the NV Ram we have to write a piece of code that's going to disable the protection for the nvram and then",
    "start": "4370159",
    "end": "4376639"
  },
  {
    "text": "write crab to it this was the piece of code um",
    "start": "4376639",
    "end": "4382120"
  },
  {
    "text": "basically well it's textbook exploitation instead of um opening a",
    "start": "4382120",
    "end": "4387360"
  },
  {
    "text": "remote root shell we're just um disabling and vam at well the address was just on the",
    "start": "4387360",
    "end": "4395239"
  },
  {
    "text": "other slide here um at this address there is a register so all you have to do is like get this data into the",
    "start": "4395239",
    "end": "4402679"
  },
  {
    "text": "pointer and shift it and so get rid of the register um well and then you can of",
    "start": "4402679",
    "end": "4409560"
  },
  {
    "text": "course write that's the last line um some into the EnV R and we have",
    "start": "4409560",
    "end": "4415920"
  },
  {
    "text": "the same effect as before uh yeah the next thing is um oh no that's",
    "start": "4415920",
    "end": "4424800"
  },
  {
    "text": "the old one right and this is how it looks like um we have the device",
    "start": "4424800",
    "end": "4430719"
  },
  {
    "text": "crashing real badly boting up um we cuted this um the legal stuff out here",
    "start": "4430719",
    "end": "4437120"
  },
  {
    "text": "um asking for network configuration um network configuration contains the information how the config",
    "start": "4437120",
    "end": "4444320"
  },
  {
    "text": "is supposed to be called and then it goes downloading the config from our gftp host and being",
    "start": "4444320",
    "end": "4451760"
  },
  {
    "text": "happy we still have to be local which still sucks so let's do the same thing",
    "start": "4451760",
    "end": "4458800"
  },
  {
    "text": "remote um instead of invalidating the NM we just go ahead and um first of all",
    "start": "4458800",
    "end": "4465360"
  },
  {
    "text": "disable interrupts because it's an interrupt driven system and we don't want to have IOS interrupt our",
    "start": "4465360",
    "end": "4471920"
  },
  {
    "text": "exploitation um unprotect the MV Ram so we can write there um take a new",
    "start": "4471920",
    "end": "4479000"
  },
  {
    "text": "configuration calculate the length field and all this header crap which is fairly",
    "start": "4479000",
    "end": "4485120"
  },
  {
    "text": "static so nobody has to research what it really means um calculate the checkm for",
    "start": "4485120",
    "end": "4490719"
  },
  {
    "text": "it and write it into the NV Ram chip directly no support of iOS needed then",
    "start": "4490719",
    "end": "4496960"
  },
  {
    "text": "we just to be nice and clean reboot the device correctly well and get a new",
    "start": "4496960",
    "end": "4503280"
  },
  {
    "text": "configuration up and running this is how that looks like um it got the Overflow it got the fake",
    "start": "4503280",
    "end": "4510360"
  },
  {
    "text": "block then it got a bootstrap code um since this is a string overflow we got",
    "start": "4510360",
    "end": "4516040"
  },
  {
    "text": "this issue with Nile characters and all the all the crap so um what we're doing",
    "start": "4516040",
    "end": "4521159"
  },
  {
    "text": "is have a bootstrap code that will mod modify the rest of the code xor typical",
    "start": "4521159",
    "end": "4527840"
  },
  {
    "text": "thing and well this xor code is then taking the appended configuration and",
    "start": "4527840",
    "end": "4534639"
  },
  {
    "text": "write it into the EnV RAM and reboot the device this is how that looks like um",
    "start": "4534639",
    "end": "4540679"
  },
  {
    "text": "notice there is no more crying around for crash because we cleanly reboot it which has the nice side effect that um",
    "start": "4540679",
    "end": "4547440"
  },
  {
    "text": "even on router forensics it will say the device is rebooted by a Reload command",
    "start": "4547440",
    "end": "4552679"
  },
  {
    "text": "and nothing except for the new configuration indicates that someone play with it um here you see that it",
    "start": "4552679",
    "end": "4560800"
  },
  {
    "text": "boots up um finds a new interface because the configuration didn't mention it and well of course you provided the",
    "start": "4560800",
    "end": "4568239"
  },
  {
    "text": "configuration so you can tell it to your newly configured gotu router um enable",
    "start": "4568239",
    "end": "4574360"
  },
  {
    "text": "yourself and then play around this is how one of those fake",
    "start": "4574360",
    "end": "4580080"
  },
  {
    "text": "blocks we're building looks like um it looks scarier than it is actually um",
    "start": "4580080",
    "end": "4586239"
  },
  {
    "text": "it's just the stuff we already discussed here um and then we got this is the self",
    "start": "4586239",
    "end": "4593679"
  },
  {
    "text": "modification code that basically decodes the rest of the um config code and well",
    "start": "4593679",
    "end": "4601520"
  },
  {
    "text": "this is the clean reset I don't think I have time for the",
    "start": "4601520",
    "end": "4608239"
  },
  {
    "text": "second one or do I Keith you know when we're supposed to end",
    "start": "4608239",
    "end": "4616239"
  },
  {
    "text": "okay we can make that it's very interesting actually um it's called oops",
    "start": "4618600",
    "end": "4624679"
  },
  {
    "text": "PF oops PF as the name suggests is an oops in OPF um in contrast to the enhanced igop",
    "start": "4624679",
    "end": "4633239"
  },
  {
    "text": "thing we discuss in the design failures um Cisco routers actually crash with too",
    "start": "4633239",
    "end": "4638520"
  },
  {
    "text": "many neighbors in OPF um it looks like the guy who wrote",
    "start": "4638520",
    "end": "4643560"
  },
  {
    "text": "it or one of the guys who wrote never ever expected more than 255 neighbors so",
    "start": "4643560",
    "end": "4649040"
  },
  {
    "text": "he was living in class c network Rod now you got a network that's a little bit bigger you have the strong possibility",
    "start": "4649040",
    "end": "4656120"
  },
  {
    "text": "of having more than 255 Neighbors at least we can make it so um this one",
    "start": "4656120",
    "end": "4661920"
  },
  {
    "text": "builds a table and copies the table to a piece of memory um to do whatever it",
    "start": "4661920",
    "end": "4667760"
  },
  {
    "text": "does with those tables and well in this copy process it",
    "start": "4667760",
    "end": "4672840"
  },
  {
    "text": "copies it to an allocated memory block uh which is too small so um the big",
    "start": "4672840",
    "end": "4679159"
  },
  {
    "text": "difference here is one it is a different kind of memory because iOS of course has",
    "start": "4679159",
    "end": "4684920"
  },
  {
    "text": "more than one type of memory second it's not one single packet thingy and third",
    "start": "4684920",
    "end": "4691600"
  },
  {
    "text": "we are in a totally different position in terms of memory layout exploitability as I said it",
    "start": "4691600",
    "end": "4698920"
  },
  {
    "text": "builds a table this table consists of the router ID in OPF hello packet",
    "start": "4698920",
    "end": "4705760"
  },
  {
    "text": "um which has one big Advantage it allows Nile characters and the second big Advantage",
    "start": "4705760",
    "end": "4712480"
  },
  {
    "text": "is it's not checked you can put whatever you want in there as a router ID the",
    "start": "4712480",
    "end": "4717600"
  },
  {
    "text": "only thing you have to fulfill is have the IP Source um The Source IP for the",
    "start": "4717600",
    "end": "4722800"
  },
  {
    "text": "OPF hell um come from the right Network which is not too complicated to do",
    "start": "4722800",
    "end": "4728760"
  },
  {
    "text": "nowadays um well here's the memory thing we got IO",
    "start": "4728760",
    "end": "4735000"
  },
  {
    "text": "memory in um Cisco routers they decide and they they have a distinction between",
    "start": "4735000",
    "end": "4741600"
  },
  {
    "text": "main memory and IO memory which on so-called Sher memory RS like the small ones isn't really important since well",
    "start": "4741600",
    "end": "4749520"
  },
  {
    "text": "the name suggests Sher memory they share the memory it's all the same but on the bigger iron um it's actually physically",
    "start": "4749520",
    "end": "4756840"
  },
  {
    "text": "totally different and is used for fast forwarding stuff and so this design this",
    "start": "4756840",
    "end": "4763719"
  },
  {
    "text": "memory design is totally different than the classic we allocate something and keep it and and free it later it's fixed",
    "start": "4763719",
    "end": "4771320"
  },
  {
    "text": "size blocks you can actually change those but it's a number of fixed size blocks it's like in a t-shirt store you",
    "start": "4771320",
    "end": "4778320"
  },
  {
    "text": "got like small medium large extra large ttin and well this is all used for",
    "start": "4778320",
    "end": "4785760"
  },
  {
    "text": "Effective forwarding so when a packet comes in you're not supposed to allocate",
    "start": "4785760",
    "end": "4790800"
  },
  {
    "text": "memory look if the memory is actually yeah you got memory copy the packet in there uh move it over to another",
    "start": "4790800",
    "end": "4797520"
  },
  {
    "text": "interface send it out but you have fixed size buffers um that are the size of DMT",
    "start": "4797520",
    "end": "4802760"
  },
  {
    "text": "you for example for private buffers and you get like the packet in pck it out",
    "start": "4802760",
    "end": "4808960"
  },
  {
    "text": "cool now what we do with the oops pfx play is basically send in all the router",
    "start": "4809440",
    "end": "4815239"
  },
  {
    "text": "IDs and um for those of you who know um the in those um surprise things like um",
    "start": "4815239",
    "end": "4822239"
  },
  {
    "text": "little surprise X it's pretty much like a uming i exploit which is a German joke",
    "start": "4822239",
    "end": "4829920"
  },
  {
    "text": "sorry um didn't work here anyway um it's",
    "start": "4829920",
    "end": "4836000"
  },
  {
    "text": "pretty much like hey Cisco um take this piece it together for us and well use it",
    "start": "4836000",
    "end": "4842239"
  },
  {
    "text": "for something um we sent over those OPF hello packets and the table builds up at",
    "start": "4842239",
    "end": "4849320"
  },
  {
    "text": "some point in time it overflows the block header as we see here um this time",
    "start": "4849320",
    "end": "4854679"
  },
  {
    "text": "from bottom to top so um with",
    "start": "4854679",
    "end": "4860400"
  },
  {
    "text": "256 IP addresses we got a fairly large buffer well 1K and with overriding the",
    "start": "4860400",
    "end": "4868320"
  },
  {
    "text": "block header here we got the same situation as before not really because we're not at",
    "start": "4868320",
    "end": "4874719"
  },
  {
    "text": "the end of a memory Shain and as I said those blocks are not frequently",
    "start": "4874719",
    "end": "4879880"
  },
  {
    "text": "allocated and freed but they're kep static the only difference is they have thresholds for I need more blocks well",
    "start": "4879880",
    "end": "4887400"
  },
  {
    "text": "then it's going to increase the number of blocks obviously allocate memory and",
    "start": "4887400",
    "end": "4893400"
  },
  {
    "text": "um depending on those thresholds it's going to do that for a while and then um stop and then freeing them again to go",
    "start": "4893400",
    "end": "4898760"
  },
  {
    "text": "to the permanent level and whatever and so we're in the middle of it and we have",
    "start": "4898760",
    "end": "4904040"
  },
  {
    "text": "to use memory management tricks to convince it to do something well most of you actually know that with management",
    "start": "4904040",
    "end": "4910040"
  },
  {
    "text": "you sometimes have to like budget it to make it do something so it's a and here with a memory um this is how the iOS",
    "start": "4910040",
    "end": "4918639"
  },
  {
    "text": "sees it it has fixed addresses it knows where the buffer addresses are and moves",
    "start": "4918639",
    "end": "4924880"
  },
  {
    "text": "stuff in and out all the time without traversing down the link list because that would be too slow um for the memory",
    "start": "4924880",
    "end": "4931120"
  },
  {
    "text": "manager it's a link list so what we basically do is tell it well the next block is null which means we're the last",
    "start": "4931120",
    "end": "4938280"
  },
  {
    "text": "block um please do something with me and well iOS still works correct",
    "start": "4938280",
    "end": "4945280"
  },
  {
    "text": "correctly now this is how it looks like if you do it um and you show the io",
    "start": "4945280",
    "end": "4950719"
  },
  {
    "text": "memory um you see in the last line here or probably better in the boooks um that",
    "start": "4950719",
    "end": "4956480"
  },
  {
    "text": "the what field strongly indicates this is not a Cisco um memory allocation",
    "start": "4956480",
    "end": "4962040"
  },
  {
    "text": "taking place here and the nice thing about that is you do the Overflow and",
    "start": "4962040",
    "end": "4967199"
  },
  {
    "text": "the router stays stable because it still has all the addresses and still uses the",
    "start": "4967199",
    "end": "4973000"
  },
  {
    "text": "memory and copies stuff in and out it doesn't use the link list so the router is still stable now you can go",
    "start": "4973000",
    "end": "4979760"
  },
  {
    "text": "ahead and exceed the threshold by um blowing all kinds of trash traffic",
    "start": "4979760",
    "end": "4985600"
  },
  {
    "text": "through the router it's going to be ooh Lord need more buffers allocate buffers buffers then you stop sending then he's",
    "start": "4985600",
    "end": "4992480"
  },
  {
    "text": "got like lots of buffers checks okay um it says I'm supposed to like free those",
    "start": "4992480",
    "end": "4997719"
  },
  {
    "text": "buffers and go back to the normal permanent level as soon as it free it it executes your code so you're got to um",
    "start": "4997719",
    "end": "5005080"
  },
  {
    "text": "dormant exploit and next time you do a flood ping it's going to be an active",
    "start": "5005080",
    "end": "5011679"
  },
  {
    "text": "exploit yeah this is what I just said um heavy traffic complex routing updates um",
    "start": "5011679",
    "end": "5016960"
  },
  {
    "text": "you can also call the guy and say look there's this evil Cisco warm out there you have to go to the Cil and say buffer",
    "start": "5016960",
    "end": "5023080"
  },
  {
    "text": "is small permanent zero and then he's actually executing your code which might actually be an evil CIS one a minimum",
    "start": "5023080",
    "end": "5031120"
  },
  {
    "text": "iOS config because normally in those packets you don't have too much space but this is the minimum iOS config um",
    "start": "5031120",
    "end": "5039440"
  },
  {
    "text": "one should use with an IP address for one interface and route back to you don't forget that",
    "start": "5039440",
    "end": "5045840"
  },
  {
    "text": "part and this is how it looks like on a 2500 with oops BF um it boots up as you",
    "start": "5045840",
    "end": "5051840"
  },
  {
    "text": "see um finds new interfaces all surprised about it um and you can take",
    "start": "5051840",
    "end": "5058040"
  },
  {
    "text": "it over now this is the work to do the stuff I'm talking about here is not um",
    "start": "5058040",
    "end": "5064600"
  },
  {
    "text": "um a teos SSH exploit it's more like in the lab stuff um not for um field to use",
    "start": "5064600",
    "end": "5073440"
  },
  {
    "text": "so one could argue that you can't really well it's not really a danger so work to",
    "start": "5073440",
    "end": "5079480"
  },
  {
    "text": "do is actually to um get rid of all the gas word like the previous pointer and",
    "start": "5079480",
    "end": "5085080"
  },
  {
    "text": "um produce fairly stabiliz exploits and of course have the um code do different",
    "start": "5085080",
    "end": "5092239"
  },
  {
    "text": "things like runtime modification of the binary runtime modification of the config um anti forensics code that",
    "start": "5092239",
    "end": "5099840"
  },
  {
    "text": "stores in nvram stuff like um well not the crash information but",
    "start": "5099840",
    "end": "5106119"
  },
  {
    "text": "something different would suggest maybe a song text or whatever to entertain the",
    "start": "5106119",
    "end": "5112080"
  },
  {
    "text": "forensic expert um iOS exploits so what",
    "start": "5112080",
    "end": "5117239"
  },
  {
    "text": "um well those are not stable exploits as I said so what's the big deal here the",
    "start": "5117239",
    "end": "5122440"
  },
  {
    "text": "whole stuff is vulnerable to the C like every everything we got with CPU network",
    "start": "5122440",
    "end": "5129679"
  },
  {
    "text": "interface and a little bit of RAM is vulnerable and at some point in time some sick German guy is going to write",
    "start": "5129679",
    "end": "5136360"
  },
  {
    "text": "an exploit for it and make it his next attack platform and well it also those devices",
    "start": "5136360",
    "end": "5143840"
  },
  {
    "text": "contain important information SNMP communities Network layout radio Secrets",
    "start": "5143840",
    "end": "5151199"
  },
  {
    "text": "everything how to protect well first of all do not rely on one type of device",
    "start": "5151199",
    "end": "5157199"
  },
  {
    "text": "everything in your shop say Cisco on it you're toast well if everything in your shop says checkpoint on it your toast as",
    "start": "5157199",
    "end": "5164400"
  },
  {
    "text": "well but um different story consider all your network equipment",
    "start": "5164400",
    "end": "5170520"
  },
  {
    "text": "vulnerable um as I said there is not one single HTTP demon that is halfway good",
    "start": "5170520",
    "end": "5176040"
  },
  {
    "text": "coded now imagine what the rest of the protocol implementations are do not ignore stuff just because",
    "start": "5176040",
    "end": "5183400"
  },
  {
    "text": "it's small such a small print server got enough CPU power and uh enough RAM to outsmart a",
    "start": "5183400",
    "end": "5192119"
  },
  {
    "text": "bunch of um things that used to fly to the moon 20 years ago so it certainly",
    "start": "5192119",
    "end": "5198639"
  },
  {
    "text": "has the capability technically to run all kinds of Evil Code and well plan your device",
    "start": "5198639",
    "end": "5206119"
  },
  {
    "text": "management as you plan root lockin on Unix boxes if you tell them to your Cisco routers nobody needs an exploit",
    "start": "5206119",
    "end": "5215280"
  },
  {
    "text": "how to protect your HP printer um set an admin password turn it to the printer",
    "start": "5215280",
    "end": "5220960"
  },
  {
    "text": "you will see it doesn't ask for a password first thing set an admin password set SNMP read and write",
    "start": "5220960",
    "end": "5227600"
  },
  {
    "text": "communities um and pray that you don't have one of those firmwares that have a hardcoded SNMP rri",
    "start": "5227600",
    "end": "5234880"
  },
  {
    "text": "Community um you can use pgf protection but as I said it's easy to root Force so",
    "start": "5234880",
    "end": "5241719"
  },
  {
    "text": "you might actually just buy yourself a little bit of time remove the default loader from the Cs",
    "start": "5241719",
    "end": "5248239"
  },
  {
    "text": "config file well if there is no loader someone has to actually use um",
    "start": "5248239",
    "end": "5253880"
  },
  {
    "text": "the PFT tool or the hij tool um to upload code well and consider putting your",
    "start": "5253880",
    "end": "5260800"
  },
  {
    "text": "printers behind the IP filter device or if it's important and only the CEO prints on it there are still things you",
    "start": "5260800",
    "end": "5268320"
  },
  {
    "text": "can buy at shops that are called lpt cables just because the printer hasn't",
    "start": "5268320",
    "end": "5274199"
  },
  {
    "text": "network interface you're not forced to use it if it's critical just PLU it into",
    "start": "5274199",
    "end": "5279280"
  },
  {
    "text": "the backside of the CEO's PC nobody's going to hack that",
    "start": "5279280",
    "end": "5284760"
  },
  {
    "text": "part um well the first point I could not resist putting that in um if you know",
    "start": "5286840",
    "end": "5293000"
  },
  {
    "text": "some people at Cisco uh get the word out stop copying stuff in buffers that are",
    "start": "5293000",
    "end": "5299280"
  },
  {
    "text": "not big enough for it that will save them a lot of trouble",
    "start": "5299280",
    "end": "5304400"
  },
  {
    "text": "um keep your iOS up to date is also more like a joke because if you're running Cisco on a large scale you actually know",
    "start": "5304400",
    "end": "5310840"
  },
  {
    "text": "that if you install the latest IOS you got bleeding edge and it's probably more",
    "start": "5310840",
    "end": "5317239"
  },
  {
    "text": "effective denial service to have the latest IOS than any given finalet member",
    "start": "5317239",
    "end": "5322719"
  },
  {
    "text": "in your network um do not run unneeded services this is the oldest message",
    "start": "5322719",
    "end": "5327920"
  },
  {
    "text": "since passwords were invented do not run tftp if you don't use it",
    "start": "5327920",
    "end": "5334600"
  },
  {
    "text": "um the IDS signature here is a little bit problematic because the SN guys",
    "start": "5334600",
    "end": "5340840"
  },
  {
    "text": "actually told me a canac that it is fairly dangerous to put it in your IDs I didn't know that because um M",
    "start": "5340840",
    "end": "5349360"
  },
  {
    "text": "videos use exactly this bite sequence for framing and so some of the snort",
    "start": "5349360",
    "end": "5355800"
  },
  {
    "text": "guys tried it and actually had it I on the snort because when users downloaded",
    "start": "5355800",
    "end": "5361679"
  },
  {
    "text": "impex streams the snort was um crying all over the place that well the cisos",
    "start": "5361679",
    "end": "5366960"
  },
  {
    "text": "are under attack um but it works if you limit it to the Cisco device pce because if the",
    "start": "5366960",
    "end": "5374159"
  },
  {
    "text": "Cisco starts downloading MX streams it's too late um debu sanity is an undocumented",
    "start": "5374159",
    "end": "5381840"
  },
  {
    "text": "command on iOS it should actually be renamed to debug Insanity um because it",
    "start": "5381840",
    "end": "5387760"
  },
  {
    "text": "basically takes off check heaps um more often and has more restrictive tests but",
    "start": "5387760",
    "end": "5394239"
  },
  {
    "text": "um with all the exploits we wrote so far it always catched us after we did it so",
    "start": "5394239",
    "end": "5399480"
  },
  {
    "text": "that just um lowered the time you got for um code execution but that's not a",
    "start": "5399480",
    "end": "5405040"
  },
  {
    "text": "problem the Hardway is config register um zero which tells the device next time",
    "start": "5405040",
    "end": "5411400"
  },
  {
    "text": "you boot up stop and run one instead of loading anything so we can't reboot and",
    "start": "5411400",
    "end": "5418560"
  },
  {
    "text": "um well the device hangs in like the BIOS the thing about this is you have to",
    "start": "5418560",
    "end": "5424800"
  },
  {
    "text": "tell any everybody in your company about this otherwise someone is going to reload the box and then you get out the",
    "start": "5424800",
    "end": "5430560"
  },
  {
    "text": "car keys and a map and tell them where the router is located um give him a",
    "start": "5430560",
    "end": "5435840"
  },
  {
    "text": "console cable and send him on his way so isn't it reg in NV BR so that you can",
    "start": "5435840",
    "end": "5441520"
  },
  {
    "text": "actually change it yeah um well wait a minute the config register is in",
    "start": "5441520",
    "end": "5449800"
  },
  {
    "text": "nvram um but that's very modeled specific that's only for the shared",
    "start": "5449800",
    "end": "5455560"
  },
  {
    "text": "memory routers as far as I know I think there are actually um other protected areas in the bigger ones but for the",
    "start": "5455560",
    "end": "5463480"
  },
  {
    "text": "smaller ones it actually will work good idea",
    "start": "5463480",
    "end": "5468639"
  },
  {
    "text": "um perform logging on a separate segment because if someone is seeing your s lock message it's going by with all the",
    "start": "5468639",
    "end": "5475199"
  },
  {
    "text": "addresses where the stuff crash it's way easier to actually exploit it and",
    "start": "5475199",
    "end": "5481239"
  },
  {
    "text": "protect your s loock host we made it that's the last slide",
    "start": "5481239",
    "end": "5488480"
  },
  {
    "text": "um greets to all those people especially Jack ping thanks for letting all those",
    "start": "5488480",
    "end": "5494119"
  },
  {
    "text": "inent guys without the batches coming in here um thanks to you for listening and",
    "start": "5494119",
    "end": "5499719"
  },
  {
    "text": "and not running away before the conference closed and well I'm open for",
    "start": "5499719",
    "end": "5506840"
  },
  {
    "text": "questions that's what I thought",
    "start": "5507239",
    "end": "5511719"
  },
  {
    "text": "one",
    "start": "5518080",
    "end": "5521080"
  },
  {
    "text": "this",
    "start": "5551880",
    "end": "5554880"
  }
]