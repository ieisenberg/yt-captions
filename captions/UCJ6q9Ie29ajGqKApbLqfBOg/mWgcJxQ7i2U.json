[
  {
    "text": "hello everyone my name is Akil kotokoda and I am Eli Goldman and we are security researchers from Aqua security and in",
    "start": "2340",
    "end": "10019"
  },
  {
    "text": "this session we will demonstrate you several of accountabilities and flow that we found in some platforms so some",
    "start": "10019",
    "end": "15839"
  },
  {
    "text": "details about us Eli and I have previous experience in penetration testing and red teaming and we have tried to use",
    "start": "15839",
    "end": "21840"
  },
  {
    "text": "this experience in our research mindset currently we are mainly focused on vulnerabilities on the supply chain",
    "start": "21840",
    "end": "27480"
  },
  {
    "text": "space and in open source projects so we first want to start with Iron Man",
    "start": "27480",
    "end": "33000"
  },
  {
    "text": "sets for This research here in front of you are four famous articles about supply chain attacks each one of them",
    "start": "33000",
    "end": "39000"
  },
  {
    "text": "head or could have had destructive effects now each attack has its own",
    "start": "39000",
    "end": "44219"
  },
  {
    "text": "story behind it some begun maybe because of a secret exposed in a Docker image",
    "start": "44219",
    "end": "49320"
  },
  {
    "text": "file ever because a developer was hacked the possibilities are endless we see all the time today publications",
    "start": "49320",
    "end": "55980"
  },
  {
    "text": "of a malicious python package was uploaded uploaded to pewpie and this is a good thing it's a good step to another",
    "start": "55980",
    "end": "62039"
  },
  {
    "text": "Community but for us to be aware we don't just need to seek out malicious packages uploaded to the platform where",
    "start": "62039",
    "end": "68340"
  },
  {
    "text": "we consumer dependencies form we first need to understand what makes an attack a supply chain attack understand our",
    "start": "68340",
    "end": "74159"
  },
  {
    "text": "organization's point of exposure to supply chain attacks and defend at each point because attackers today have many",
    "start": "74159",
    "end": "80939"
  },
  {
    "text": "entry points to the organization from the from the moment the developer writes the code on his own laptop until the",
    "start": "80939",
    "end": "86939"
  },
  {
    "text": "binary is one in production that is why we want to raise awareness of attacks in each phase of the development flow so",
    "start": "86939",
    "end": "93960"
  },
  {
    "text": "first a quick recap of the development flow we first start with the ID where the developer writes his code then we",
    "start": "93960",
    "end": "101040"
  },
  {
    "text": "move on to the sem phase where the developer and his organization store their code after that we're in the registry phase",
    "start": "101040",
    "end": "107640"
  },
  {
    "text": "which includes attacks on the platform where we consume our dependencies from then we will arrive to the cicd phase",
    "start": "107640",
    "end": "113939"
  },
  {
    "text": "this phase takes everything up to here combines the code into one artifact and sometimes even deploy it",
    "start": "113939",
    "end": "120540"
  },
  {
    "text": "after that we are in the artifacts phase the artifacts phase is just like the register phase reporting on your point",
    "start": "120540",
    "end": "126780"
  },
  {
    "text": "of view are you a consumer of a package or a provider of a package for example and finally the runtime phase where our",
    "start": "126780",
    "end": "133680"
  },
  {
    "text": "code is being executed we speak here about original research that we've connected in each one of these phases",
    "start": "133680",
    "end": "139680"
  },
  {
    "text": "except the runtime phase starting with the IDE phase he will talk about research about Visual Studio code",
    "start": "139680",
    "end": "146879"
  },
  {
    "text": "extensions so first why this code there are many code editors as you can see here Sublime",
    "start": "146879",
    "end": "152520"
  },
  {
    "text": "IntelliJ and this code but this code is the most popular one how popular",
    "start": "152520",
    "end": "157680"
  },
  {
    "text": "according to a survey conducted by stack Overflow more than 74 percent of the users use vs code as their main IDE",
    "start": "157680",
    "end": "164760"
  },
  {
    "text": "now viscode is strong tool but its main power comes from its extensions there are many extensions varying from",
    "start": "164760",
    "end": "170640"
  },
  {
    "text": "prettifying the code that you write and ending with Git integration and debug tools how do you install these",
    "start": "170640",
    "end": "176760"
  },
  {
    "text": "extensions from the marketplace just go online search the extension you want to install and install it you can do it",
    "start": "176760",
    "end": "182700"
  },
  {
    "text": "from the web interface as you can see here or from the viscode application itself",
    "start": "182700",
    "end": "187739"
  },
  {
    "text": "now that we know how popular are this code and the extensions I want to shift",
    "start": "187739",
    "end": "192780"
  },
  {
    "text": "our view a bit when I tell you npm packages what are the associations that you are getting",
    "start": "192780",
    "end": "197940"
  },
  {
    "text": "so of course this is a security conference and probably most of us are thinking about malicious npm packages",
    "start": "197940",
    "end": "203879"
  },
  {
    "text": "and indeed when you search Google for malicious npm packages you see many results of packages stealing credit",
    "start": "203879",
    "end": "209700"
  },
  {
    "text": "cards and tokens and this is a good thing the Publications not the malicious packages but what happens when you",
    "start": "209700",
    "end": "215940"
  },
  {
    "text": "search for mesha's vs code extensions there are hardly any results there are",
    "start": "215940",
    "end": "221280"
  },
  {
    "text": "results about results about vulnerable extensions but it's important to state that vulnerable is not malicious and",
    "start": "221280",
    "end": "228120"
  },
  {
    "text": "there are two different things okay there aren't any Publications about malicious extensions but what can an",
    "start": "228120",
    "end": "235739"
  },
  {
    "text": "extension even do so the answer it can do anything the user can do it runs on the progress laptop can run ransomware",
    "start": "235739",
    "end": "242640"
  },
  {
    "text": "for example or even use the SSH key of the programmer to connect to the private repositories of visualization in GitHub",
    "start": "242640",
    "end": "249720"
  },
  {
    "text": "so now that we know the dangers of installing a malicious physical extensions we want to see how easy it is",
    "start": "249720",
    "end": "255060"
  },
  {
    "text": "to impersonate a popular extension in the marketplace fooling developers into installing it so that we chose spirit is",
    "start": "255060",
    "end": "263160"
  },
  {
    "text": "the fiscal extension that is in the top 10 installs in the marketplace we uploaded our own pretty with warranty I",
    "start": "263160",
    "end": "269880"
  },
  {
    "text": "want to see the differences and similarities let's take a closer look we can see marked at 1 the URL there is",
    "start": "269880",
    "end": "277320"
  },
  {
    "text": "a slight change but not many look at the URL what I really want to focus here on Watermark two and three in the image you",
    "start": "277320",
    "end": "284400"
  },
  {
    "text": "can see that they are identical this is because this is the Publishers and the extensions display name property it does",
    "start": "284400",
    "end": "292080"
  },
  {
    "text": "not have to be unique and you can put in there whatever you want and for example here we wrote prettier with two T's",
    "start": "292080",
    "end": "298759"
  },
  {
    "text": "there's also the installs and reviews which is a good measure to understand if the extension is okay or not but it can",
    "start": "298759",
    "end": "305820"
  },
  {
    "text": "be fabricated overall when we look at both these extensions it's very hard to distinguish which one is the original",
    "start": "305820",
    "end": "312240"
  },
  {
    "text": "one and which one is the person impersonating one but do not worry Microsoft is here to help us",
    "start": "312240",
    "end": "318600"
  },
  {
    "text": "they uploaded a guideline that says can I trust extensions from the marketplace okay that sounds good and in there they",
    "start": "318600",
    "end": "325500"
  },
  {
    "text": "tell you here are a few steps that you can take in order to make an informed decision and one of these steps is",
    "start": "325500",
    "end": "331740"
  },
  {
    "text": "take a look at the repository that is linked to the extension but we were able to fabricate the repository in the",
    "start": "331740",
    "end": "338580"
  },
  {
    "text": "extension to be the same so this does not help us at all in Microsoft defense other platforms has",
    "start": "338580",
    "end": "344820"
  },
  {
    "text": "destroyable as well now up to here we saw how we can make",
    "start": "344820",
    "end": "350340"
  },
  {
    "text": "the land page of the extension seems similar but how will someone even get to our extension when you search for",
    "start": "350340",
    "end": "356220"
  },
  {
    "text": "pritier in the marketplace there are many many results and your extension is not even here",
    "start": "356220",
    "end": "361919"
  },
  {
    "text": "but what happens when someone by mistake searches for Britain with one t",
    "start": "361919",
    "end": "367080"
  },
  {
    "text": "the answer is that our extension is the only result and you can even see there that in the Box it it results with the",
    "start": "367080",
    "end": "373740"
  },
  {
    "text": "display name property tweeted with 2T making it very hard to distinguish we took everything into account here",
    "start": "373740",
    "end": "380520"
  },
  {
    "text": "how easy it is to impersonate a purple extension in the marketplace and what a malicious extension can do in your",
    "start": "380520",
    "end": "386819"
  },
  {
    "text": "computer computer which is anything and decided to upload the POC we upload the pre-tier with one t so earlier it just",
    "start": "386819",
    "end": "393240"
  },
  {
    "text": "gave us a little ping when it was installed by a developer and the results are in front of you Another 48 Hours",
    "start": "393240",
    "end": "400979"
  },
  {
    "text": "more than 1 000 developers around the world installed our own personal extension each developer here could have",
    "start": "400979",
    "end": "408300"
  },
  {
    "text": "been the entry point Focus supply chain attack on his internal organization now just imagine the scenario of a real",
    "start": "408300",
    "end": "414720"
  },
  {
    "text": "attacker uploading a real malicious extension another flow I want to talk to you about",
    "start": "414720",
    "end": "420660"
  },
  {
    "text": "in the marketplace is the verified sign when we see this verified sign the associations that we are getting is that",
    "start": "420660",
    "end": "427259"
  },
  {
    "text": "the platform is validated that the person behind this page is indeed with lenses let's see an example of the",
    "start": "427259",
    "end": "433500"
  },
  {
    "text": "social accounts of LeBron James we can see we have Instagram Facebook and Twitter all of them he has a verified",
    "start": "433500",
    "end": "439080"
  },
  {
    "text": "sign all of them validated that LeBron James is Behind These Pages now let's",
    "start": "439080",
    "end": "444599"
  },
  {
    "text": "look at the verified sign in the marketplace here we can see we have semic load here that has an extension of",
    "start": "444599",
    "end": "451020"
  },
  {
    "text": "two installs okay and a verified sign when we put our Mouse on the verified sign we can see there is a little pop-up",
    "start": "451020",
    "end": "457620"
  },
  {
    "text": "that says Santa Claus has a verified ownership for the domain semi-cloud.net",
    "start": "457620",
    "end": "463319"
  },
  {
    "text": "wait what let's look at the requirements to even get a verified sign in the marketplace",
    "start": "463319",
    "end": "469740"
  },
  {
    "text": "you go online choose the publisher you want to verify enter an eligible domain which is just any domain prove that you",
    "start": "469740",
    "end": "478020"
  },
  {
    "text": "own this domain and that's it this means that any developer like semi-cloud here",
    "start": "478020",
    "end": "483479"
  },
  {
    "text": "can receive a verified sign Sam if you're present or listening to this recording nothing personal thank you for",
    "start": "483479",
    "end": "490080"
  },
  {
    "text": "your contribution to our research now the sharp eyes of you can see that they're verified sign location is near",
    "start": "490080",
    "end": "497160"
  },
  {
    "text": "the display name property what we did pretty with two things before just imagine the scenario of an attacker",
    "start": "497160",
    "end": "503160"
  },
  {
    "text": "receiving a verified sign and then changing the display in property to pretend with duties",
    "start": "503160",
    "end": "509160"
  },
  {
    "text": "probably the most suspecting developers will be full volume so now what I've showed you here are the requirements for",
    "start": "509160",
    "end": "516240"
  },
  {
    "text": "verified sign before the publication of our research after the publication Microsoft added a",
    "start": "516240",
    "end": "522479"
  },
  {
    "text": "little note that says if you change your if you change your display name property your verified badge will be revoked so",
    "start": "522479",
    "end": "528839"
  },
  {
    "text": "this is a good mitigation from the platform to minimize some of the risks another good thing we saw the result of",
    "start": "528839",
    "end": "535019"
  },
  {
    "text": "the research is that the real prettier receive the verified sign they did not have before the problem remains of what this",
    "start": "535019",
    "end": "541920"
  },
  {
    "text": "verified sign represents but it's a good step from the publisher side now we talked a lot about the",
    "start": "541920",
    "end": "548220"
  },
  {
    "text": "marketplace I want to dig a little deeper into what is an extension so an extension ends with Visa X which is just",
    "start": "548220",
    "end": "555959"
  },
  {
    "text": "a zip file and when you unzip this file you see there are many other files and in one of them a little magic file this",
    "start": "555959",
    "end": "562980"
  },
  {
    "text": "file is Packet Json so where do you remember package.json from npm packages what you need to",
    "start": "562980",
    "end": "569940"
  },
  {
    "text": "understand from now on is that a viscode extension is just like an npm package",
    "start": "569940",
    "end": "575100"
  },
  {
    "text": "and those are the all the dangers of npm packages like attacks on dependencies of dependencies but this is for another",
    "start": "575100",
    "end": "580800"
  },
  {
    "text": "session now we talked here before that there are a lot of publications of malicious npm",
    "start": "580800",
    "end": "586560"
  },
  {
    "text": "packages I want to introduce you to bextable backstable is a collection of",
    "start": "586560",
    "end": "591720"
  },
  {
    "text": "malicious open source packages hence including malicious npm packages that",
    "start": "591720",
    "end": "596820"
  },
  {
    "text": "was collected over the years it is how it looks like it has many details about different malicious",
    "start": "596820",
    "end": "602519"
  },
  {
    "text": "packages including the objective of the package like stealing tokens environment variables and the method of attack like",
    "start": "602519",
    "end": "609060"
  },
  {
    "text": "typos quoting here's an example of such a package you can see the code takes the",
    "start": "609060",
    "end": "614940"
  },
  {
    "text": "environment variable of the process and sends it to the attacker machine stealing the environment variables of",
    "start": "614940",
    "end": "620580"
  },
  {
    "text": "the attacked user now we took a look at many packages like this one in order to",
    "start": "620580",
    "end": "626279"
  },
  {
    "text": "search for patterns of malicious npm packages in order to find malicious vs",
    "start": "626279",
    "end": "632700"
  },
  {
    "text": "code extensions in the marketplace for that we used same group same rep is",
    "start": "632700",
    "end": "638459"
  },
  {
    "text": "a SAS tool that uses rules in order to search for patterns inside code here's a very simple rule that we wrote",
    "start": "638459",
    "end": "645360"
  },
  {
    "text": "that just searches for execution commands like exec and eval that happen after an HTTP event like a get request",
    "start": "645360",
    "end": "651720"
  },
  {
    "text": "we run it across the marketplace and here's the result that we found you can see that upon installation of",
    "start": "651720",
    "end": "657720"
  },
  {
    "text": "the extension the uh the computer will go to the attacker's machine make a get request",
    "start": "657720",
    "end": "663480"
  },
  {
    "text": "from the get request take the response data and send it to eval which is a command execution this means that when a",
    "start": "663480",
    "end": "670500"
  },
  {
    "text": "developer will install this malicious malicious extension upon installation the computer will go to the advanced",
    "start": "670500",
    "end": "676140"
  },
  {
    "text": "domain fetch code and run it locally now this can be a malicious extension or",
    "start": "676140",
    "end": "682260"
  },
  {
    "text": "just a very bad code written by developer I can tell you on top of that that the domain that you see here was",
    "start": "682260",
    "end": "689279"
  },
  {
    "text": "available for everyone to buy when we encounter this extension this means that even if this is not a malicious",
    "start": "689279",
    "end": "695339"
  },
  {
    "text": "extension an attacker could have bought this domain and attack legitimate users making it a malicious extension",
    "start": "695339",
    "end": "703140"
  },
  {
    "text": "either way we report it to Microsoft and they removed it from the marketplace of course",
    "start": "703140",
    "end": "708540"
  },
  {
    "text": "another thing we need to understand about extensions in the marketplace is that when we upload an extension it's",
    "start": "708540",
    "end": "714480"
  },
  {
    "text": "visible for everyone and we may by mistake leak secrets we scanned with",
    "start": "714480",
    "end": "720000"
  },
  {
    "text": "various scanning tools the marketplace and it is an example that we found you can see that when you open the Visa X of",
    "start": "720000",
    "end": "726180"
  },
  {
    "text": "the extension there are many files and here there is a little token file and what this token file holds",
    "start": "726180",
    "end": "732000"
  },
  {
    "text": "tokens tokens to the marketplace itself this means that when an attacker will",
    "start": "732000",
    "end": "737160"
  },
  {
    "text": "get this token he can publish a malicious extension under the name of an innocent publisher we found many other",
    "start": "737160",
    "end": "743519"
  },
  {
    "text": "tokens like AWS keys and many more of course everything is here was revoked and reported to the publishers",
    "start": "743519",
    "end": "751440"
  },
  {
    "text": "so a few mitigations recommendations for the IDE phase of the vs code extensions",
    "start": "751440",
    "end": "756720"
  },
  {
    "text": "first thing first the platforms and Publishers responsibility the platform",
    "start": "756720",
    "end": "761820"
  },
  {
    "text": "has a responsibility for us the consumers especially a platform where Anonymous users can upload an extension",
    "start": "761820",
    "end": "767579"
  },
  {
    "text": "to minimize our points of exposure we saw they mitigated some of the risks in",
    "start": "767579",
    "end": "772620"
  },
  {
    "text": "the verified sign but there are many other flaws that need to be taken care of the Publishers also have responsibility",
    "start": "772620",
    "end": "779220"
  },
  {
    "text": "there is a verified mechanism apply for IT Help users identify you",
    "start": "779220",
    "end": "786019"
  },
  {
    "text": "there is a brand new world out there or vulnerability is secrets and maybe even malicious activities in the marketplace",
    "start": "786920",
    "end": "793200"
  },
  {
    "text": "are you an extension developer be sure to scan your extensions for vulnerabilities and secrets before you",
    "start": "793200",
    "end": "799440"
  },
  {
    "text": "upload them to the marketplace you may never know which token you may have leaked by mistake starting a supply chain attack on your organization",
    "start": "799440",
    "end": "806940"
  },
  {
    "text": "most importantly we've shown here how we can attack developers even before they write their code we call it shift left",
    "start": "806940",
    "end": "813839"
  },
  {
    "text": "lift attacking the developers now these results were shown on this code in the marketplace but there are many more",
    "start": "813839",
    "end": "820560"
  },
  {
    "text": "ideas and their own Marketplace that probably have the same flaws",
    "start": "820560",
    "end": "826200"
  },
  {
    "text": "okay we finished with ID phase about this code and moving on to the SCM phase he",
    "start": "826200",
    "end": "832860"
  },
  {
    "text": "will talk about an attack called reprojecting so first what is reprojecting let's start with an example",
    "start": "832860",
    "end": "839399"
  },
  {
    "text": "assume an organization called marginization and within the repository called my lipo in order for user to",
    "start": "839399",
    "end": "845639"
  },
  {
    "text": "access this repository you'll need to browse the URL in front of you now the organization decides to change",
    "start": "845639",
    "end": "851519"
  },
  {
    "text": "their name to new organization so the users will need to access the new URL instead",
    "start": "851519",
    "end": "856680"
  },
  {
    "text": "however what will happen if a user accesses the old URL by mistake",
    "start": "856680",
    "end": "862500"
  },
  {
    "text": "there will be an HTTP redirect and everything will be okay but now because the organization changed",
    "start": "862500",
    "end": "868320"
  },
  {
    "text": "their name then my organization name is free for everyone to take what will happen if an attacker creates the",
    "start": "868320",
    "end": "874440"
  },
  {
    "text": "marginalization organization and reflect the my repo Repository there will no longer be a redirect and",
    "start": "874440",
    "end": "881820"
  },
  {
    "text": "users that access the old URL of the legitimate repository by mistake will actually access the attacker's",
    "start": "881820",
    "end": "887519"
  },
  {
    "text": "Repository this is the call of repo jacking there are more scenarios like transferring the ownership instead of rename but it's all",
    "start": "887519",
    "end": "894420"
  },
  {
    "text": "about the same now there are some restrictions deployed by GitHub of the capability of the",
    "start": "894420",
    "end": "900540"
  },
  {
    "text": "attacker of opening dual repository name but just in 2022 there were so many",
    "start": "900540",
    "end": "906300"
  },
  {
    "text": "bypasses to these restrictions defined by GitHub so as a result in our research",
    "start": "906300",
    "end": "911699"
  },
  {
    "text": "in our research and this presentation a repository that has a redirect for its",
    "start": "911699",
    "end": "916860"
  },
  {
    "text": "old name and the old name is available to take counted as vulnerable nevertheless",
    "start": "916860",
    "end": "922680"
  },
  {
    "text": "all the examples we're going to show here were fully exploitable even with the the protections deployed by GitHub",
    "start": "922680",
    "end": "930720"
  },
  {
    "text": "so up to here one is so the triple checking is just a redirect not happening right let's understand a few",
    "start": "930720",
    "end": "937139"
  },
  {
    "text": "exploitation scenarios for this attack a link in the code to the previous name this can be when in the code itself",
    "start": "937139",
    "end": "943860"
  },
  {
    "text": "there is a reference to your level repository to download the resource for example we're going to go module file a",
    "start": "943860",
    "end": "949620"
  },
  {
    "text": "go module Imports uh installation guide references this can be when in written instructions",
    "start": "949620",
    "end": "955740"
  },
  {
    "text": "there is a reference to the URL of the repository but when the organization changed their name they forgot to change",
    "start": "955740",
    "end": "961500"
  },
  {
    "text": "the written instructions we'll see an example of this and how to cover Link in post across the internet",
    "start": "961500",
    "end": "967320"
  },
  {
    "text": "and scenario of this someone recommends a specific tool in stack Overflow linking a repository after the answer",
    "start": "967320",
    "end": "972800"
  },
  {
    "text": "the only of the repository change the organization name but of course the stack Overflow enter remained the same",
    "start": "972800",
    "end": "979860"
  },
  {
    "text": "let's see some real life examples here we have a Google project Google Map steps that was probably transferred to",
    "start": "979860",
    "end": "986100"
  },
  {
    "text": "their ownership but they forgot to change the readme instructions let's take a closer look at the readme",
    "start": "986100",
    "end": "992040"
  },
  {
    "text": "here we can see Google is the access to do a git clone to the socratic map steps and not the Google Map steps and indeed",
    "start": "992040",
    "end": "998820"
  },
  {
    "text": "when you access this URL you get redirected to Google Map steps however when an attacker will create a Socratic",
    "start": "998820",
    "end": "1006079"
  },
  {
    "text": "organization and within the math steps repository they will no longer be a redirect and users that follow Google's",
    "start": "1006079",
    "end": "1012800"
  },
  {
    "text": "instructions will actually clone the attackers Repository when Google is accessed to do npm",
    "start": "1012800",
    "end": "1018620"
  },
  {
    "text": "install which will result in remote code execution of the attacker on Google users we made a POC on this repository",
    "start": "1018620",
    "end": "1025819"
  },
  {
    "text": "we opened a socatic organization and within it the Master's repository and the uploaded repository to give us a",
    "start": "1025819",
    "end": "1032000"
  },
  {
    "text": "little ping when npm install was executed we got number as a result of code execution on open source users and",
    "start": "1032000",
    "end": "1038839"
  },
  {
    "text": "developers of big companies another example I want to show you here is this installer sales script we can",
    "start": "1038839",
    "end": "1046100"
  },
  {
    "text": "see inside the script there is the download URI which points to a zip inside the repository that is vulnerable",
    "start": "1046100",
    "end": "1052460"
  },
  {
    "text": "to repo jacking now it it the script downloads this ZIP locally and unzips it",
    "start": "1052460",
    "end": "1058220"
  },
  {
    "text": "and from the zip takes the Dominos stage script and executes it",
    "start": "1058220",
    "end": "1063679"
  },
  {
    "text": "this means that when an attacker will create a yes graph organization that is in the download URI the s-gov",
    "start": "1063679",
    "end": "1069140"
  },
  {
    "text": "organization and within the Dominus repository users that execute the original install sh scripts will",
    "start": "1069140",
    "end": "1075559"
  },
  {
    "text": "actually download the zip of the attacker and execute the Dominos sales clip of the attacker",
    "start": "1075559",
    "end": "1081260"
  },
  {
    "text": "this is the proof that we control the sgov organization and within it we can open the Dominos Repository",
    "start": "1081260",
    "end": "1088760"
  },
  {
    "text": "now a third example I'll show you is just like the Google scenario of written instructions but it's a special case for",
    "start": "1088760",
    "end": "1094460"
  },
  {
    "text": "us so I'll show it anyway you can see in the written instructions they tell us to download an extension Visa X which is",
    "start": "1094460",
    "end": "1101179"
  },
  {
    "text": "a vs code extension and of course this link is vulnerable to repo jacking it's from the releases in",
    "start": "1101179",
    "end": "1106340"
  },
  {
    "text": "GitHub and when an attacker will create the old organization name Infinity repository they will no longer be a",
    "start": "1106340",
    "end": "1112760"
  },
  {
    "text": "redirects and users that press this download link will actually download the attacker's Discord extension now",
    "start": "1112760",
    "end": "1120380"
  },
  {
    "text": "actually this repository is what led us a research to understand what are the",
    "start": "1120380",
    "end": "1125419"
  },
  {
    "text": "dangers of installing a malicious vehicle extensions any dangers and the flaws in the marketplace that we've",
    "start": "1125419",
    "end": "1130520"
  },
  {
    "text": "shown before in order for an attacker to exploit this broadly he needs to know the previous",
    "start": "1130520",
    "end": "1136760"
  },
  {
    "text": "names of repositories for that he can use the gh1 projects this project",
    "start": "1136760",
    "end": "1141940"
  },
  {
    "text": "records all public activities on a public repository like commits and",
    "start": "1141940",
    "end": "1147260"
  },
  {
    "text": "pull requests this is a gold mine for researchers and attackers you can see here in the of",
    "start": "1147260",
    "end": "1154100"
  },
  {
    "text": "the data set there are specific download links of a specific years and months each link here contains millions of",
    "start": "1154100",
    "end": "1161059"
  },
  {
    "text": "repositories so what would we do with this information nothing beats a good statistic charts we took a random month",
    "start": "1161059",
    "end": "1167720"
  },
  {
    "text": "June 2019 and restarted all the repositories name from there that amounted to 125 million unique",
    "start": "1167720",
    "end": "1174500"
  },
  {
    "text": "repositories from that we took a random sample of one percent which is 1.25 million",
    "start": "1174500",
    "end": "1180380"
  },
  {
    "text": "repositories eject each one if it is vulnerable to repo jacking and the result",
    "start": "1180380",
    "end": "1185419"
  },
  {
    "text": "approximately 37 000 repositories available to repo jacking that is almost three percent",
    "start": "1185419",
    "end": "1191539"
  },
  {
    "text": "if you apply this stat on the entire GitHub out of 100 repositories out there three of them are vulnerable to repo",
    "start": "1191539",
    "end": "1198260"
  },
  {
    "text": "jacking and we have a way to find the previous name using these data sets we disclosed our findings to various",
    "start": "1198260",
    "end": "1204320"
  },
  {
    "text": "companies of the examples we saw here and many many more remember thanks to",
    "start": "1204320",
    "end": "1209840"
  },
  {
    "text": "the data sets if you change your name anytime in the past an attacker can't find your old name and explore it and",
    "start": "1209840",
    "end": "1215720"
  },
  {
    "text": "change references that being said we have a few mitigations recommendations we'd like to suggest check all the GitHub links in",
    "start": "1215720",
    "end": "1223820"
  },
  {
    "text": "your code now and periodically you may never know when a go model for example might change",
    "start": "1223820",
    "end": "1230120"
  },
  {
    "text": "their name do you want to change organization M sure do it but also keep it just as a",
    "start": "1230120",
    "end": "1236840"
  },
  {
    "text": "place over there so antaki won't be able to acquire it and exploit and change references do you want to sell it for vulnerable",
    "start": "1236840",
    "end": "1243080"
  },
  {
    "text": "repositories here is a little tip there is a high possibility of findings that's vulnerable repositories around",
    "start": "1243080",
    "end": "1248780"
  },
  {
    "text": "Acquisitions and mergers when they rename the organization okay we've finished with the ID phase",
    "start": "1248780",
    "end": "1256280"
  },
  {
    "text": "and the sem phase and now we're moving on to the registry phase so yeah",
    "start": "1256280",
    "end": "1261799"
  },
  {
    "text": "okay in this phase we will demonstrate use vulnerability that we found on npm and was fixed by there this",
    "start": "1261799",
    "end": "1267260"
  },
  {
    "text": "vulnerability will demonstrate you the risk for developer so what is package planting in the past npm registry allow",
    "start": "1267260",
    "end": "1274039"
  },
  {
    "text": "any user to add any other user as the new as the new owner of malicious packages",
    "start": "1274039",
    "end": "1279380"
  },
  {
    "text": "and as you can see here first of all attacker upload Alicia's package and then he add another user in which is the",
    "start": "1279380",
    "end": "1285080"
  },
  {
    "text": "new maintenance of the malicious packet and this is really simple Vector that could be done via the npm CLI first of",
    "start": "1285080",
    "end": "1291380"
  },
  {
    "text": "all attacker use npm publish in order to publish the package then attack any user",
    "start": "1291380",
    "end": "1296659"
  },
  {
    "text": "A Wish For example popular profile like npm and Facebook profile and of course",
    "start": "1296659",
    "end": "1301700"
  },
  {
    "text": "after this attacker remove himself in order to make the package seem to be more innocent",
    "start": "1301700",
    "end": "1307340"
  },
  {
    "text": "and this is how the malicious landing page of the package will look like as you can see if you or any other",
    "start": "1307340",
    "end": "1313340"
  },
  {
    "text": "developer in your organization somehow encountered this fancy malicious packet you might be full into installing it",
    "start": "1313340",
    "end": "1318860"
  },
  {
    "text": "because it seemed to be owned by user with a lot of reputation in the platform and it was also possible via the npm",
    "start": "1318860",
    "end": "1326059"
  },
  {
    "text": "website to add another user but the reason why I'm showing it here is there is another issue some of you may notice",
    "start": "1326059",
    "end": "1332600"
  },
  {
    "text": "that when attackers try to add another user as the new owner of his malicious packet you will get their 2fa status so",
    "start": "1332600",
    "end": "1339020"
  },
  {
    "text": "we have two information disclosed of course we write a wrote a script that",
    "start": "1339020",
    "end": "1344539"
  },
  {
    "text": "did this for us and we get a lot of 2fa status of many popular maintainers on npm and we get really interesting",
    "start": "1344539",
    "end": "1352100"
  },
  {
    "text": "statistics about the 2fa status of direct maintainer and indirect",
    "start": "1352100",
    "end": "1357200"
  },
  {
    "text": "maintenance of popular packages we report our fighting to npm which say they act they tracking this issue",
    "start": "1357200",
    "end": "1364340"
  },
  {
    "text": "internally and they actively working on fixing it and after some month they release a patch a confirmation mechanism",
    "start": "1364340",
    "end": "1370520"
  },
  {
    "text": "so now it's no longer possible and if you want to add another user as the owner of your package an email will be",
    "start": "1370520",
    "end": "1377480"
  },
  {
    "text": "sent to their email address and they need to approve it first there are some lessons that you can learn from the currency from the current",
    "start": "1377480",
    "end": "1383780"
  },
  {
    "text": "issue first of all if you are using npn it might be a good idea to check that all the packages under your scope really",
    "start": "1383780",
    "end": "1390200"
  },
  {
    "text": "belong to your scope because this Vector was possible in the past and you need to be always suspicious about the ownership",
    "start": "1390200",
    "end": "1397039"
  },
  {
    "text": "of your about the owners of your dependency now I know it sounds obvious and it's easier said than done so what",
    "start": "1397039",
    "end": "1403460"
  },
  {
    "text": "you can do in order to achieve this first of all you can evaluate open source project by using different",
    "start": "1403460",
    "end": "1408919"
  },
  {
    "text": "sources that are available today lag devdaps and socket Dev that actually give you security ranking of different",
    "start": "1408919",
    "end": "1414860"
  },
  {
    "text": "open source project and you can also use browser extension that do this thing for us and actually and actually collect",
    "start": "1414860",
    "end": "1422000"
  },
  {
    "text": "data from different sources okay we are on the cicd phase here we",
    "start": "1422000",
    "end": "1428059"
  },
  {
    "text": "will show you vulnerability that you found on traffic CI that could put at risk 10 of thousand of open source",
    "start": "1428059",
    "end": "1433940"
  },
  {
    "text": "project so our research began after we realized there had been a huge increase among",
    "start": "1433940",
    "end": "1439460"
  },
  {
    "text": "different CI providers over there if you think about it in the past Jenkins and Travis were the only available CI tools",
    "start": "1439460",
    "end": "1446480"
  },
  {
    "text": "but now we have GitHub action Circle CI Azure Pipeline and more and we start to",
    "start": "1446480",
    "end": "1451580"
  },
  {
    "text": "notice that many open source projects start to migrate between both different CI providers and sometimes it's possible",
    "start": "1451580",
    "end": "1457640"
  },
  {
    "text": "to find user to this they decide to move from Travis to GitHub action for example",
    "start": "1457640",
    "end": "1462919"
  },
  {
    "text": "and in is all the infrastructure on Travis to find some secret data",
    "start": "1462919",
    "end": "1468020"
  },
  {
    "text": "after we read a great article about eight flow about similar issue and we",
    "start": "1468020",
    "end": "1473539"
  },
  {
    "text": "decided took our research one step further and actually we found a lot of token of popular projects",
    "start": "1473539",
    "end": "1478760"
  },
  {
    "text": "while researching the API of Travis we found that actually one of the API Travis is vulnerable to idle which means",
    "start": "1478760",
    "end": "1485720"
  },
  {
    "text": "attacker could actually get any public log that ever exists in Travis API and within this log actually to search for",
    "start": "1485720",
    "end": "1493100"
  },
  {
    "text": "secrets and this is how it's look it's really simple all attackers you need to do is change the sequence number and",
    "start": "1493100",
    "end": "1498799"
  },
  {
    "text": "then it will get instant random build number it build output and we found",
    "start": "1498799",
    "end": "1504260"
  },
  {
    "text": "actually that there are more than 770 Millions available logs of different projects but we must admit that not all",
    "start": "1504260",
    "end": "1512419"
  },
  {
    "text": "the log in this range were available so we keep our research and found another API of traffic is available to idle this",
    "start": "1512419",
    "end": "1519500"
  },
  {
    "text": "time there are two interesting part about this issue first of all these sequence numbers start from 1 and it",
    "start": "1519500",
    "end": "1525679"
  },
  {
    "text": "will then it will it will really direct us to some S3 bucket and this will be",
    "start": "1525679",
    "end": "1532340"
  },
  {
    "text": "the exact same logs as we found in the first method but now logs that we found",
    "start": "1532340",
    "end": "1538039"
  },
  {
    "text": "in the first method and were accessible now have become available so we managed to bypass their restriction and expand",
    "start": "1538039",
    "end": "1545480"
  },
  {
    "text": "our attack surface and like the repo jacking research we like a lot of data so because we lazy we",
    "start": "1545480",
    "end": "1551779"
  },
  {
    "text": "decided to took only one percent of the available log which sell up to around 8 million slogs and then run different",
    "start": "1551779",
    "end": "1558320"
  },
  {
    "text": "scanning tools and our own word list and then we saw the price we got a lot of",
    "start": "1558320",
    "end": "1563779"
  },
  {
    "text": "token that related to really popular platform like GitHub AWS Docker app some",
    "start": "1563779",
    "end": "1568880"
  },
  {
    "text": "of the token that we found related to project with ten of thousands of GitHub actually form only one percent of the",
    "start": "1568880",
    "end": "1575000"
  },
  {
    "text": "log we found more than 73 000 of different token and in the chat if one of you you can",
    "start": "1575000",
    "end": "1581659"
  },
  {
    "text": "see the diversity of the token that we found a lot of token for defense usages and it's really important to say that",
    "start": "1581659",
    "end": "1587720"
  },
  {
    "text": "not all the token are equal and some exposure and danger more than other in order to understand how to use this",
    "start": "1587720",
    "end": "1595159"
  },
  {
    "text": "token we use the clear X project that contain a lot of token and the related API and this helps us to know how to",
    "start": "1595159",
    "end": "1600980"
  },
  {
    "text": "verify those token of course Travis tried to censor some of",
    "start": "1600980",
    "end": "1606500"
  },
  {
    "text": "the token that we found by the diversity of the token and the log where too much to handle you can see that only for",
    "start": "1606500",
    "end": "1612559"
  },
  {
    "text": "GitHub token we found more than 20 different aliases okay so let's connect all we have here",
    "start": "1612559",
    "end": "1619159"
  },
  {
    "text": "we had a lot of token that anyone can access a way to access a restriction",
    "start": "1619159",
    "end": "1624980"
  },
  {
    "text": "logs and a poor rate limiting process so we get it a really dangerous and critical situation",
    "start": "1624980",
    "end": "1631279"
  },
  {
    "text": "we import our finding to avci which which responded that this issue is by Design and they do not intend to fix it",
    "start": "1631279",
    "end": "1637760"
  },
  {
    "text": "great for us and of course after our research was widely published Travis",
    "start": "1637760",
    "end": "1643279"
  },
  {
    "text": "start mitigate the risk and deleted the logs we also report our filing to a respective service provider all of them",
    "start": "1643279",
    "end": "1649039"
  },
  {
    "text": "were aligned and initiated y key rotation and other verified that at least 50 percent of our findings were",
    "start": "1649039",
    "end": "1655100"
  },
  {
    "text": "still valid so what we can learn from the current issue first of all it might be a good idea to",
    "start": "1655100",
    "end": "1660919"
  },
  {
    "text": "delete any Legacy or old component that you have in or in your infrastructure because sometimes it can contains logs",
    "start": "1660919",
    "end": "1667580"
  },
  {
    "text": "and regardless logs it's important to rotate them periodically some of the",
    "start": "1667580",
    "end": "1672799"
  },
  {
    "text": "token that we found were 70 years old it's also important to give your third party token the only privilege they need",
    "start": "1672799",
    "end": "1679520"
  },
  {
    "text": "and it might be a good idea to scan any output from your development flow or",
    "start": "1679520",
    "end": "1684740"
  },
  {
    "text": "from any CI that you have with secret scanning tool and when you do so try to use different scanning tools because",
    "start": "1684740",
    "end": "1691100"
  },
  {
    "text": "each one of them have their own nuance and their own method for example some of them use entropy some of them use",
    "start": "1691100",
    "end": "1697340"
  },
  {
    "text": "pattern and in order to get fully visualization of exposed secrets you need to combine them together",
    "start": "1697340",
    "end": "1703700"
  },
  {
    "text": "okay now we are on the artifact phase here we'll demonstrate the vulnerability that we found on npm that can allow",
    "start": "1703700",
    "end": "1710299"
  },
  {
    "text": "attacker to disclose private package name so first of all what is private package on npm npm registry allow user",
    "start": "1710299",
    "end": "1717320"
  },
  {
    "text": "to upload to the public npm registry private package these packages is only available to to specific numbers of user",
    "start": "1717320",
    "end": "1724640"
  },
  {
    "text": "and organizations and as their name suggests the content and their name should not be available for anyone the",
    "start": "1724640",
    "end": "1731600"
  },
  {
    "text": "name of private package must consist of two parts first of all the username aka the scope and then the private package",
    "start": "1731600",
    "end": "1739159"
  },
  {
    "text": "name and what is timing attack when we refer to timing attack we refer to a method",
    "start": "1739159",
    "end": "1745340"
  },
  {
    "text": "for a for attacker to disclose sensitive data from the server only by observing",
    "start": "1745340",
    "end": "1750440"
  },
  {
    "text": "the they took the server to respawn for different input here for example attacker could only by observing the",
    "start": "1750440",
    "end": "1756919"
  },
  {
    "text": "time they took the npm API to respond for specific metadata of of private",
    "start": "1756919",
    "end": "1762020"
  },
  {
    "text": "package to figure if the package exists or not so how npm is vulnerable to timing",
    "start": "1762020",
    "end": "1768140"
  },
  {
    "text": "attack let's assume that attackers want to query npm API for a specific package",
    "start": "1768140",
    "end": "1773299"
  },
  {
    "text": "that called Secrets package of an organization that called random organization of course if he will try to do this as",
    "start": "1773299",
    "end": "1779899"
  },
  {
    "text": "Anonymous user it will not get any result in 404 but the interesting part",
    "start": "1779899",
    "end": "1785059"
  },
  {
    "text": "is not the 4004 and there has no any data about this package the interesting",
    "start": "1785059",
    "end": "1791539"
  },
  {
    "text": "part is the time they took the server to respond in our research we found that if attackers make around 5 requests in a",
    "start": "1791539",
    "end": "1798080"
  },
  {
    "text": "row it's possible to determine if the package exists or not basically if the package exists the respawn time will be",
    "start": "1798080",
    "end": "1805039"
  },
  {
    "text": "longer and if the package doesn't exist the respawn time will be shorter and will decrease over time because some",
    "start": "1805039",
    "end": "1811340"
  },
  {
    "text": "caching mechanism on npm and if you want more specific data in our research we found that if the package exists and you",
    "start": "1811340",
    "end": "1818539"
  },
  {
    "text": "try to query npm API for specific private package the server will respond",
    "start": "1818539",
    "end": "1823580"
  },
  {
    "text": "after 600 milliseconds and if the package doesn't exist the respond time will be under 100 millisecond",
    "start": "1823580",
    "end": "1831320"
  },
  {
    "text": "so our attacker can use this attack let's assume that attacker by using this method find a private package that",
    "start": "1831320",
    "end": "1837860"
  },
  {
    "text": "called a low ward of an organization that's called an e-test.org what attack you will try to do is to figure out if",
    "start": "1837860",
    "end": "1844580"
  },
  {
    "text": "there is another package under the public npm registry without the scope in",
    "start": "1844580",
    "end": "1850279"
  },
  {
    "text": "order to take other developer that forget to mention the scope of the package but in order to deeply understand this I",
    "start": "1850279",
    "end": "1857419"
  },
  {
    "text": "want to give an example from another platform Docker Hub if you know Docker app you know that when you try to upload",
    "start": "1857419",
    "end": "1863539"
  },
  {
    "text": "Docker image the name of Docker image must consist of two parts first of all the username and then the image name and",
    "start": "1863539",
    "end": "1871460"
  },
  {
    "text": "attacker or anyone cannot upload an image without a scope the only one that",
    "start": "1871460",
    "end": "1876799"
  },
  {
    "text": "could do it in Docker app is actually the docker app team themselves so we have scenario that is possible in npm",
    "start": "1876799",
    "end": "1882740"
  },
  {
    "text": "but it's not possible in Docker app and this lead us to our first takeaway here we need to unified security standard",
    "start": "1882740",
    "end": "1888919"
  },
  {
    "text": "between different registry on the supply chain space because each one of them",
    "start": "1888919",
    "end": "1893960"
  },
  {
    "text": "have their own nuance and mitigations and then PM have a lot of them but if we will combine all of them as Community we",
    "start": "1893960",
    "end": "1900260"
  },
  {
    "text": "actually improve the overall security of the supply supply chain space okay we disclose our finding to npm team",
    "start": "1900260",
    "end": "1908140"
  },
  {
    "text": "and which responded because some architectural limitation they cannot prevent such attack so it's still",
    "start": "1908140",
    "end": "1914360"
  },
  {
    "text": "possible and they even exclude this from the their back Bounty program but the",
    "start": "1914360",
    "end": "1920000"
  },
  {
    "text": "mitigation here is very simple all that new users need to do in order to mitigate the rescue is to create place",
    "start": "1920000",
    "end": "1925580"
  },
  {
    "text": "order package under the public npm registry and if you want to read more about other",
    "start": "1925580",
    "end": "1931460"
  },
  {
    "text": "attack Vector that you related to this issue there is a really great blog by npmting npm avoiding substitution",
    "start": "1931460",
    "end": "1938240"
  },
  {
    "text": "attacks and a security researcher it's always a good idea to check for timing attack in other platforms",
    "start": "1938240",
    "end": "1944659"
  },
  {
    "text": "so let's sum up all the points that we have here we've shown you a lot of different examples for different phases",
    "start": "1944659",
    "end": "1950720"
  },
  {
    "text": "we have talked about IDE extension about repo jacking package planting tokens on",
    "start": "1950720",
    "end": "1956600"
  },
  {
    "text": "cicds and even our attacker can find your private package on npm if you think",
    "start": "1956600",
    "end": "1962600"
  },
  {
    "text": "about it each of the example were really simple but their consequences might be",
    "start": "1962600",
    "end": "1968059"
  },
  {
    "text": "catastrophical for some organizations you need to ensure security at each",
    "start": "1968059",
    "end": "1973700"
  },
  {
    "text": "stage of the development flow we've shown you many mitigations for different risks but sometimes they will very",
    "start": "1973700",
    "end": "1980000"
  },
  {
    "text": "specific to the research description here on this college for example you need to understand how your organization",
    "start": "1980000",
    "end": "1985159"
  },
  {
    "text": "fits inside this development flow and do threat modeling to understand the different risks that you are exposed to",
    "start": "1985159",
    "end": "1992500"
  },
  {
    "text": "are you a security researcher be careful if the pocs that you upload do you",
    "start": "1992500",
    "end": "1998419"
  },
  {
    "text": "remember the CTX incident a security researcher uploaded a malicious python package to pewpie stealing environment",
    "start": "1998419",
    "end": "2005080"
  },
  {
    "text": "variables after there was a lot of traffic regarding this message package he uploaded a blog post that says do not",
    "start": "2005080",
    "end": "2011980"
  },
  {
    "text": "worry I'm a security researcher not a malicious actor I do not intend to do anything with your secrets and I deleted",
    "start": "2011980",
    "end": "2019000"
  },
  {
    "text": "them now of course no one can believe anything he says and now all the",
    "start": "2019000",
    "end": "2024640"
  },
  {
    "text": "organizations need to rotate the secrets and the security evaluations to understand if they were bleached by",
    "start": "2024640",
    "end": "2030940"
  },
  {
    "text": "using these secrets as a security researcher you need to understand when you upload the POC to",
    "start": "2030940",
    "end": "2036940"
  },
  {
    "text": "npm pupil or even the marketplace of this code you don't Target a single user",
    "start": "2036940",
    "end": "2042519"
  },
  {
    "text": "or a single company you target the whole open source community so things go out of hand very easily you need to be very",
    "start": "2042519",
    "end": "2049060"
  },
  {
    "text": "careful and our last point if you think about it all the security researchers and the",
    "start": "2049060",
    "end": "2056020"
  },
  {
    "text": "open source Community when we speak about vulnerabilities and attack vectors that related to supply chain they are",
    "start": "2056020",
    "end": "2062020"
  },
  {
    "text": "only focused on popular platform like npm go and pewpie but there are so many",
    "start": "2062020",
    "end": "2067540"
  },
  {
    "text": "other registry that sometimes vulnerable to the same issue but currently they do not get any attention from anyone and",
    "start": "2067540",
    "end": "2074320"
  },
  {
    "text": "they can expose a lot of organization to supply chain attacks thanks for listening everyone if you",
    "start": "2074320",
    "end": "2079960"
  },
  {
    "text": "have any questions feel free to contact us there or right now thank you [Applause]",
    "start": "2079960",
    "end": "2089339"
  }
]