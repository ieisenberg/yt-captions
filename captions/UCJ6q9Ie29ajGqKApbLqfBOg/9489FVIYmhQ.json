[
  {
    "text": "foreign",
    "start": "60",
    "end": "2659"
  },
  {
    "text": "T briefings held November 21st through the 22nd 2001 in Amsterdam this is video",
    "start": "22640",
    "end": "28740"
  },
  {
    "text": "tip number three routing protocol attacks by FX",
    "start": "28740",
    "end": "34160"
  },
  {
    "text": "session um first short introduction what is this about what can we do",
    "start": "42780",
    "end": "50340"
  },
  {
    "text": "we will look into different attacks scenarios and see in",
    "start": "50340",
    "end": "56699"
  },
  {
    "text": "general high level what can be done with protocol attacks",
    "start": "56699",
    "end": "61940"
  },
  {
    "text": "we go into layer 2 attacks using CDP STP vlans",
    "start": "61940",
    "end": "69479"
  },
  {
    "text": "we will also cover some Classics like icmp abuse and ARP interception",
    "start": "69479",
    "end": "76140"
  },
  {
    "text": "um we talk about Discovery and attacks on routers",
    "start": "76140",
    "end": "81600"
  },
  {
    "text": "and we will finish this session with a little bit fun with tunnels and so-called private IP",
    "start": "81600",
    "end": "89159"
  },
  {
    "text": "addresses according to RFC 1980.",
    "start": "89159",
    "end": "93979"
  },
  {
    "text": "well first of all the question is why should you actually bother with this kind of attacks you might think it's a",
    "start": "94200",
    "end": "101520"
  },
  {
    "text": "it's strange nobody really uses it so um",
    "start": "101520",
    "end": "107460"
  },
  {
    "text": "why it is why is it affecting the reality of my network today",
    "start": "107460",
    "end": "113880"
  },
  {
    "text": "um so to answer this question I actually will read something third wrote in their",
    "start": "113880",
    "end": "120720"
  },
  {
    "text": "latest paper about distributed enough service attacks and the upcoming Trends",
    "start": "120720",
    "end": "127380"
  },
  {
    "text": "and since it's pretty small here I will read it to you um third says of extreme concern is the",
    "start": "127380",
    "end": "134640"
  },
  {
    "text": "potential of routers being used for dos attacks based on the direct attacks against the routing protocols that",
    "start": "134640",
    "end": "141300"
  },
  {
    "text": "interconnect the networks comprising the internet we believe this to be an imminent and",
    "start": "141300",
    "end": "147720"
  },
  {
    "text": "real threat with potentially high impact so they're actually right and wrong at",
    "start": "147720",
    "end": "153900"
  },
  {
    "text": "the same time because um it is a real threat but why should you just use it for distributed denial",
    "start": "153900",
    "end": "160560"
  },
  {
    "text": "of service attacks so what threats are you actually facing",
    "start": "160560",
    "end": "169019"
  },
  {
    "text": "well in general um using traffic rerouting an ad taker",
    "start": "169019",
    "end": "177000"
  },
  {
    "text": "might be able to sniff data streams he would normally not see",
    "start": "177000",
    "end": "183019"
  },
  {
    "text": "he could actually prevent data from getting from A to B",
    "start": "183019",
    "end": "188220"
  },
  {
    "text": "um data like think of Zeus log messages any kind of logging accounting messages",
    "start": "188220",
    "end": "195360"
  },
  {
    "text": "um he could even modify the data on the way so back to the example of those log",
    "start": "195360",
    "end": "202560"
  },
  {
    "text": "messages the message used to say log in failed and it will say login succeeded",
    "start": "202560",
    "end": "211440"
  },
  {
    "text": "or he could actually impersonate a source or a destination of a",
    "start": "211440",
    "end": "216659"
  },
  {
    "text": "Communications stream and hereby giving them false sense of security",
    "start": "216659",
    "end": "222720"
  },
  {
    "text": "um this is most commonly referred to as like fake service or fake logins",
    "start": "222720",
    "end": "228060"
  },
  {
    "text": "but it's actually very effective let's go a little bit into ethics",
    "start": "228060",
    "end": "233700"
  },
  {
    "text": "scenarios um this is a sample Network and this microphone sucks",
    "start": "233700",
    "end": "239819"
  },
  {
    "text": "um on the left side there is what you would call a normal office",
    "start": "239819",
    "end": "245040"
  },
  {
    "text": "Lan with server PCS they're connected to each other by a hub which",
    "start": "245040",
    "end": "253680"
  },
  {
    "text": "is then uplinked to a switch over here oh by the way I'm using the Cisco",
    "start": "253680",
    "end": "259079"
  },
  {
    "text": "symbols here because I think most people are familiar with them but this doesn't",
    "start": "259079",
    "end": "265259"
  },
  {
    "text": "mean anything this attacks can be applied to most devices that do routing",
    "start": "265259",
    "end": "272300"
  },
  {
    "text": "yeah back to this um a sample Network first when a network was set up the",
    "start": "272460",
    "end": "279419"
  },
  {
    "text": "administrators decide to protect their server I call the server Target it's over here by a router running some kind",
    "start": "279419",
    "end": "286620"
  },
  {
    "text": "of fire warning software packet filtering um later on yeah we know how management",
    "start": "286620",
    "end": "293460"
  },
  {
    "text": "is management requests that we want to have high availability for this connection so",
    "start": "293460",
    "end": "300120"
  },
  {
    "text": "they put in place another router over here using hot standby",
    "start": "300120",
    "end": "306360"
  },
  {
    "text": "and of course nobody has time and nobody really cares about the routers so",
    "start": "306360",
    "end": "312300"
  },
  {
    "text": "um it was just overlooked that the second router doesn't run any kind of filtering or firewalling software",
    "start": "312300",
    "end": "319680"
  },
  {
    "text": "another router in this segment um participates down here in what we call",
    "start": "319680",
    "end": "325919"
  },
  {
    "text": "the inter router Network and this network actually talks igrp",
    "start": "325919",
    "end": "332160"
  },
  {
    "text": "and behind yet another router and yet another firewalling engine there",
    "start": "332160",
    "end": "337680"
  },
  {
    "text": "is a radio server to authenticate logins done on the routers",
    "start": "337680",
    "end": "343680"
  },
  {
    "text": "so we have this poor guy let's call him attacker",
    "start": "343680",
    "end": "348960"
  },
  {
    "text": "um he couldn't get a connection to the flat lamp of course it would have preferred a connection to the flat land",
    "start": "348960",
    "end": "355080"
  },
  {
    "text": "and just fire up his sniffer um yeah but he was ready to put directly",
    "start": "355080",
    "end": "360780"
  },
  {
    "text": "onto the switch so after sniffing for some minutes and seeing lots of Windows broadcasts he",
    "start": "360780",
    "end": "367259"
  },
  {
    "text": "figures this connection is directly to the switch so I would go for protocol attacks",
    "start": "367259",
    "end": "373440"
  },
  {
    "text": "so what could he do this one here shows the normal",
    "start": "373440",
    "end": "379560"
  },
  {
    "text": "traffic path from workstation victim to server Target",
    "start": "379560",
    "end": "385380"
  },
  {
    "text": "packets are sent through the office line here across the switch go through this firewalling router and go to the server",
    "start": "385380",
    "end": "392880"
  },
  {
    "text": "same way back so first thing adjective could do",
    "start": "392880",
    "end": "401280"
  },
  {
    "text": "is a layer 2 interception most of you probably know it we will discuss it in",
    "start": "401280",
    "end": "406620"
  },
  {
    "text": "detail later um it actually gives them the ability to",
    "start": "406620",
    "end": "411800"
  },
  {
    "text": "sniff all the traffic in this broadcast domain by routing all the traffic",
    "start": "411800",
    "end": "417240"
  },
  {
    "text": "through his machine which is pretty good for him",
    "start": "417240",
    "end": "423740"
  },
  {
    "text": "um the second thing I call this local redirection is just attic remodifies his",
    "start": "423780",
    "end": "429539"
  },
  {
    "text": "own routing table or ARP cache so his packets are actually sent through the",
    "start": "429539",
    "end": "436020"
  },
  {
    "text": "backup router who has its own IP and its own Mac address instead of the fire warning router and",
    "start": "436020",
    "end": "445319"
  },
  {
    "text": "so adjective can get to the server Target without passing through any kind of",
    "start": "445319",
    "end": "451800"
  },
  {
    "text": "filter software but unfortunately this doesn't work for the way back",
    "start": "451800",
    "end": "457220"
  },
  {
    "text": "so instead of using local redirection or",
    "start": "458340",
    "end": "464940"
  },
  {
    "text": "ARP especially this ARP interceptions Layer Two exceptions are easily picked",
    "start": "464940",
    "end": "470280"
  },
  {
    "text": "up by an IDs attacker decides he goes for directed interception because it just wants to",
    "start": "470280",
    "end": "477419"
  },
  {
    "text": "see the traffic between victim and Target and not between this other",
    "start": "477419",
    "end": "482639"
  },
  {
    "text": "unnamed guy here so what he does is an irdp attack",
    "start": "482639",
    "end": "489000"
  },
  {
    "text": "um he actually modifies the routing table of victim so the traffic is again routed through",
    "start": "489000",
    "end": "496020"
  },
  {
    "text": "his system instead of going directly to the router",
    "start": "496020",
    "end": "502280"
  },
  {
    "text": "based on the attacks shown in the last slides he decides that the answer is",
    "start": "504960",
    "end": "510300"
  },
  {
    "text": "coming from the server Target shouldn't actually go through the firewall because of course he wants to",
    "start": "510300",
    "end": "517320"
  },
  {
    "text": "do the full port scan full exploitation thing so he uses icmp redirect",
    "start": "517320",
    "end": "524880"
  },
  {
    "text": "and to actually tell the server Target here to go through this unprotected router instead of the protected router",
    "start": "524880",
    "end": "532560"
  },
  {
    "text": "and voila no more firewall in between yeah most attackers don't actually work",
    "start": "532560",
    "end": "540899"
  },
  {
    "text": "by procedures so yeah he went on a little bit too fast and yeah went straight through our",
    "start": "540899",
    "end": "548640"
  },
  {
    "text": "interception and all that and why he tries to hack server Target he realizes",
    "start": "548640",
    "end": "553860"
  },
  {
    "text": "well these two routers run hsrp and as a good air taker he knows hsrp is",
    "start": "553860",
    "end": "561240"
  },
  {
    "text": "an easy target so he actually now forces a switch over from this one to this router using hsrp",
    "start": "561240",
    "end": "570480"
  },
  {
    "text": "and finally gets rid of the firewalling stuff permanently",
    "start": "570480",
    "end": "576540"
  },
  {
    "text": "another normal traffic path",
    "start": "578459",
    "end": "583740"
  },
  {
    "text": "Aker tries to log in to router backup using telnet sessions which is of course",
    "start": "583740",
    "end": "590399"
  },
  {
    "text": "not best practice but he could also use SSH and his standard connection is perfectly",
    "start": "590399",
    "end": "597600"
  },
  {
    "text": "okay but unfortunately the router always goes down to this radio server here to",
    "start": "597600",
    "end": "603300"
  },
  {
    "text": "authenticate the login now while hacking into server Target um the attacker found the configuration",
    "start": "603300",
    "end": "610560"
  },
  {
    "text": "of this router and of course the first thing he did was breaking these very high security Cisco",
    "start": "610560",
    "end": "617760"
  },
  {
    "text": "password 7 encrypted passwords but as we know normal configuration",
    "start": "617760",
    "end": "623940"
  },
  {
    "text": "guidelines say these passwords are only used if the radio server is not available",
    "start": "623940",
    "end": "629820"
  },
  {
    "text": "so what he does is actually this the radio server not available",
    "start": "629820",
    "end": "635180"
  },
  {
    "text": "he uses a igrp routing protocol attack to create a routing Loop in this",
    "start": "635180",
    "end": "641399"
  },
  {
    "text": "Network here um and now he can turn it to router backup",
    "start": "641399",
    "end": "647579"
  },
  {
    "text": "who in turn realizes that he has no way to connect to the radio server and his",
    "start": "647579",
    "end": "653579"
  },
  {
    "text": "login he's successful we will discuss several",
    "start": "653579",
    "end": "661079"
  },
  {
    "text": "protocols that use multicast in this session and this slide is just here to illustrate how unpredictable multicast",
    "start": "661079",
    "end": "669660"
  },
  {
    "text": "can be um this is nearly unbelievable but I",
    "start": "669660",
    "end": "674880"
  },
  {
    "text": "actually tried this myself so this is a standard AIX installation",
    "start": "674880",
    "end": "681060"
  },
  {
    "text": "good IBM operating system and has a checkpoint firewall one on top",
    "start": "681060",
    "end": "686519"
  },
  {
    "text": "of it we would assume that this is the multicast domain for one",
    "start": "686519",
    "end": "693899"
  },
  {
    "text": "network and here we have the multicast domain for the other network",
    "start": "693899",
    "end": "699060"
  },
  {
    "text": "this is not true it's actually Four Watts multicast packets without even asking the",
    "start": "699060",
    "end": "705540"
  },
  {
    "text": "checkpoint software so even if you have a fire in between you can't be really sure that you",
    "start": "705540",
    "end": "711839"
  },
  {
    "text": "filtered multicast this is how it is",
    "start": "711839",
    "end": "717779"
  },
  {
    "text": "yeah yes",
    "start": "717779",
    "end": "722540"
  },
  {
    "text": "it's actually if you want to test that you go to no a which is Network options",
    "start": "723000",
    "end": "728720"
  },
  {
    "text": "and you see forward IP multicast is set to one and this actually",
    "start": "728720",
    "end": "736160"
  },
  {
    "text": "causes the AIX software the axip stack to forward the multicast without even",
    "start": "736160",
    "end": "742260"
  },
  {
    "text": "telling the checkpoint software okay so we saw the possible attack",
    "start": "742260",
    "end": "748920"
  },
  {
    "text": "scenarios um how do they work in theory",
    "start": "748920",
    "end": "754920"
  },
  {
    "text": "I hope everyone is familiar with the iso OC modem I assume so and why not",
    "start": "754920",
    "end": "761399"
  },
  {
    "text": "yeah so good so each layer has its own addressing of course",
    "start": "761399",
    "end": "767519"
  },
  {
    "text": "the physical layer uses directly connected links I think most of you actually followed",
    "start": "767519",
    "end": "773399"
  },
  {
    "text": "some cables in some computer rooms to find out which layer one addressing the switch used",
    "start": "773399",
    "end": "780060"
  },
  {
    "text": "Layer Two uses um data link addresses such as ethernet",
    "start": "780060",
    "end": "785760"
  },
  {
    "text": "Max or whatever layer 2 protocol you use layer three",
    "start": "785760",
    "end": "792660"
  },
  {
    "text": "uses the well-known IP addressing and routing layer 4 traffic is actually divided in",
    "start": "792660",
    "end": "800940"
  },
  {
    "text": "IP by ports and protocols the IP stack decides",
    "start": "800940",
    "end": "807560"
  },
  {
    "text": "using the protocol and the port which Services token token to which",
    "start": "807560",
    "end": "814019"
  },
  {
    "text": "service and this all leads to an application stream by modifying one of these addressing",
    "start": "814019",
    "end": "821779"
  },
  {
    "text": "mechanisms you can modify the flow of information in the network",
    "start": "821779",
    "end": "826800"
  },
  {
    "text": "and that's the whole idea of protocol attacks",
    "start": "826800",
    "end": "832100"
  },
  {
    "text": "and would be great to just gather yeah yeah okay for Layer Two",
    "start": "833880",
    "end": "840380"
  },
  {
    "text": "um it looks like this you conduct a man in the middle attack",
    "start": "840839",
    "end": "846480"
  },
  {
    "text": "you give false data link addresses to server and client server over here client over here",
    "start": "846480",
    "end": "853560"
  },
  {
    "text": "they normally talk to each other they find out which address the other one uses and",
    "start": "853560",
    "end": "859380"
  },
  {
    "text": "yeah you give them for its information both of them",
    "start": "859380",
    "end": "864720"
  },
  {
    "text": "and you will forward the traffic",
    "start": "864720",
    "end": "869240"
  },
  {
    "text": "um this mostly requires access to the broadcast domain of course because layer 2 attacks mostly require access to the",
    "start": "870540",
    "end": "878160"
  },
  {
    "text": "same layer 2 area but the biggest advantage of course is",
    "start": "878160",
    "end": "883500"
  },
  {
    "text": "you don't touch the layer 3 protocol that means IP and the world ISO OC stuff",
    "start": "883500",
    "end": "891420"
  },
  {
    "text": "here was designed so the layers are independent from each other and as long",
    "start": "891420",
    "end": "896579"
  },
  {
    "text": "as you work on Layer Two for the attacks most mechanisms to spot you that run on",
    "start": "896579",
    "end": "904139"
  },
  {
    "text": "layer 3 will not spot you so for layer 3 attack",
    "start": "904139",
    "end": "909899"
  },
  {
    "text": "um it works basically the same way you give Ford's Next Top information",
    "start": "909899",
    "end": "915779"
  },
  {
    "text": "to one of both parties which looks like this",
    "start": "915779",
    "end": "922380"
  },
  {
    "text": "um the advantage here of course is you can do things remotely it doesn't require",
    "start": "922380",
    "end": "927540"
  },
  {
    "text": "you to be on the same Layer Two segment um and as the text scenarios showed you",
    "start": "927540",
    "end": "934019"
  },
  {
    "text": "there are plenty ways to do it",
    "start": "934019",
    "end": "939320"
  },
  {
    "text": "so let's go into the protocols the first one Cisco Discovery protocol",
    "start": "940440",
    "end": "946500"
  },
  {
    "text": "is one of these that run on most networks and nobody really cares the intention",
    "start": "946500",
    "end": "953839"
  },
  {
    "text": "by designing this network was to make troubleshooting simpler for Cisco operators so have some where you added",
    "start": "953839",
    "end": "960839"
  },
  {
    "text": "feature to Cisco devices the protocol runs directly on data link",
    "start": "960839",
    "end": "965880"
  },
  {
    "text": "layer and provides information about device connected the medium whatever",
    "start": "965880",
    "end": "973079"
  },
  {
    "text": "so other ciscos can actually see this packet and have this you know iOS displayed so if you look for CDP",
    "start": "973079",
    "end": "980100"
  },
  {
    "text": "neighbors it will tell you here we have these ciscos connected to the cable",
    "start": "980100",
    "end": "986339"
  },
  {
    "text": "but the protocol informs an attacker who listens on your cable about IP",
    "start": "986339",
    "end": "993240"
  },
  {
    "text": "addresses software version platform capabilities native VLAN and so on",
    "start": "993240",
    "end": "999720"
  },
  {
    "text": "which can be used for attacks so this is how it looks like when you",
    "start": "999720",
    "end": "1006199"
  },
  {
    "text": "actually as an attacker scan for a CDP it has the device ID Port ID platform or",
    "start": "1006199",
    "end": "1014120"
  },
  {
    "text": "capability duplex the software ID which is very handy if you have some kind of Cisco",
    "start": "1014120",
    "end": "1019820"
  },
  {
    "text": "exploit at hand and some more",
    "start": "1019820",
    "end": "1025360"
  },
  {
    "text": "switches also do that so this is a switch giving away his information I",
    "start": "1025360",
    "end": "1032720"
  },
  {
    "text": "actually wonder where cat Defcon 1 was located doesn't matter",
    "start": "1032720",
    "end": "1037760"
  },
  {
    "text": "and on top of this CDP is vulnerable to memory exhaustion",
    "start": "1037760",
    "end": "1044298"
  },
  {
    "text": "attack that might negatively influence the capability of your Cisco device",
    "start": "1044299",
    "end": "1051380"
  },
  {
    "text": "means you're locked out so this happens if you actually flood a",
    "start": "1051380",
    "end": "1058400"
  },
  {
    "text": "Cisco with random CDP messages it has no more memory so it's unable to",
    "start": "1058400",
    "end": "1064039"
  },
  {
    "text": "accept routing protocol updates tenant sessions",
    "start": "1064039",
    "end": "1069380"
  },
  {
    "text": "anything that requires a little bit of memory is just no longer possible to",
    "start": "1069380",
    "end": "1074780"
  },
  {
    "text": "protect yourself from this to happen and to hide your where you build information from the",
    "start": "1074780",
    "end": "1081200"
  },
  {
    "text": "attacker because CDP has no real productive use to you just go to your",
    "start": "1081200",
    "end": "1087679"
  },
  {
    "text": "Cisco config and say no CDP run This is highly recommended",
    "start": "1087679",
    "end": "1094360"
  },
  {
    "text": "spanning tree or STP is used to calculate forward paths on Flat Earth",
    "start": "1097580",
    "end": "1103820"
  },
  {
    "text": "networks means switch networks anything that's not using routing",
    "start": "1103820",
    "end": "1109880"
  },
  {
    "text": "for the situation on the left side here it's pretty obvious that the switches",
    "start": "1109880",
    "end": "1115640"
  },
  {
    "text": "have to figure out some kind of distribution path of course because if I have a station",
    "start": "1115640",
    "end": "1122480"
  },
  {
    "text": "over here that's sending out a broadcast what would happen without the path",
    "start": "1122480",
    "end": "1128120"
  },
  {
    "text": "calculation the broadcast would go through the first switch over here to the second switch over here both would",
    "start": "1128120",
    "end": "1134600"
  },
  {
    "text": "receive the broadcast from the other switch would forward it again and you have a real nice broadcast store when",
    "start": "1134600",
    "end": "1140600"
  },
  {
    "text": "your network goes down so to prevent this",
    "start": "1140600",
    "end": "1145820"
  },
  {
    "text": "um so-called BPD use Bridge protocol data units are sent out by the switches",
    "start": "1145820",
    "end": "1151280"
  },
  {
    "text": "and they actually agree on a switch route which then leads to a logical",
    "start": "1151280",
    "end": "1156980"
  },
  {
    "text": "forwarding tree that I try to illustrate on the right side so S2 is forwarding everything to S1",
    "start": "1156980",
    "end": "1163520"
  },
  {
    "text": "who's the root switch and as one decides the distribution which prevents loops",
    "start": "1163520",
    "end": "1172059"
  },
  {
    "text": "so of course your possible attacks for larger networks sending out a lot of",
    "start": "1172940",
    "end": "1179720"
  },
  {
    "text": "more or less correct ppdus an attacker can force the switches into an",
    "start": "1179720",
    "end": "1186080"
  },
  {
    "text": "continuous recalculation of the path and hereby making the network real unstable",
    "start": "1186080",
    "end": "1192400"
  },
  {
    "text": "and most of you who actually work with networking equipment and how to debug",
    "start": "1192400",
    "end": "1198820"
  },
  {
    "text": "spanning tree issues in the past know how difficult it is to find that out",
    "start": "1198820",
    "end": "1205600"
  },
  {
    "text": "so he could actually send these and if he managed to send the right information",
    "start": "1206419",
    "end": "1213140"
  },
  {
    "text": "to the switches and he managed to gather enough information about the network he",
    "start": "1213140",
    "end": "1218960"
  },
  {
    "text": "might actually become the switch route with his station here",
    "start": "1218960",
    "end": "1224960"
  },
  {
    "text": "and suddenly in a very strong position because every ethernet frame is first forwarded to him",
    "start": "1224960",
    "end": "1230900"
  },
  {
    "text": "and it's perfectly transparent",
    "start": "1230900",
    "end": "1234640"
  },
  {
    "text": "okay talking about vlans IEEE 802.1q vlans",
    "start": "1236600",
    "end": "1243799"
  },
  {
    "text": "are very often used as a security solution well",
    "start": "1243799",
    "end": "1249380"
  },
  {
    "text": "when looking at the vlans in general it's not a great idea to use them as a",
    "start": "1249380",
    "end": "1255799"
  },
  {
    "text": "security solution especially not if you use any kind of VLAN trunking and this is well known but",
    "start": "1255799",
    "end": "1263840"
  },
  {
    "text": "I think it's interesting to see how it works um when you have vlans across multiple",
    "start": "1263840",
    "end": "1271520"
  },
  {
    "text": "switches you have one switch here and one here you have to interconnect them somehow so we have the green VLAN",
    "start": "1271520",
    "end": "1278840"
  },
  {
    "text": "here that's VLAN one and we have to Blue that we learned two um",
    "start": "1278840",
    "end": "1284299"
  },
  {
    "text": "and to get the information from VLAN one here to the VLAN one here it has to go",
    "start": "1284299",
    "end": "1291500"
  },
  {
    "text": "through router through What's called the trunk",
    "start": "1291500",
    "end": "1297080"
  },
  {
    "text": "this thick line um the frames actually get tacked with a",
    "start": "1297080",
    "end": "1303559"
  },
  {
    "text": "little Mark this is the following VLAN information and are sent into the trunk",
    "start": "1303559",
    "end": "1309080"
  },
  {
    "text": "and on the other side the text gets stripped off from the switch and the frame is sent to the right port",
    "start": "1309080",
    "end": "1317179"
  },
  {
    "text": "the tagging actually looks like this after the well-known destination and",
    "start": "1317179",
    "end": "1323840"
  },
  {
    "text": "source you have this little Tech protocol identifier which looks a bit different",
    "start": "1323840",
    "end": "1330740"
  },
  {
    "text": "for each and every layer 2 protocol this is ethernet 2 actually",
    "start": "1330740",
    "end": "1336880"
  },
  {
    "text": "it just identifies what's in there what's coming after the four bytes",
    "start": "1336880",
    "end": "1342080"
  },
  {
    "text": "tagging here and then you have to tack control information",
    "start": "1342080",
    "end": "1347360"
  },
  {
    "text": "here that has the user priority the canonical format identifier and the VLAN",
    "start": "1347360",
    "end": "1353840"
  },
  {
    "text": "ID oh well and then the normal stuff you know from ethernet frames like type and payload",
    "start": "1353840",
    "end": "1360740"
  },
  {
    "text": "follows so if an attacker",
    "start": "1360740",
    "end": "1366500"
  },
  {
    "text": "does the so-called VLAN hopping um he actually exploits the fact that some",
    "start": "1366500",
    "end": "1373220"
  },
  {
    "text": "switches accept Target frames or non-trunk ports what does it mean this which receives the frame that's",
    "start": "1373220",
    "end": "1380360"
  },
  {
    "text": "already tagged that's already prepared for transported over the trunk on a port",
    "start": "1380360",
    "end": "1386600"
  },
  {
    "text": "that's not part of the trunk basically the port is not connected to the router",
    "start": "1386600",
    "end": "1392659"
  },
  {
    "text": "and some switches accept this Frame and forward it this is the case in a default",
    "start": "1392659",
    "end": "1399020"
  },
  {
    "text": "installation on Cisco if you're coming from VLAN 1 you're actually allowed to send trunk",
    "start": "1399020",
    "end": "1406220"
  },
  {
    "text": "frames so that's what we try to illustrate here the attacker sends an already tag frame",
    "start": "1406220",
    "end": "1413960"
  },
  {
    "text": "to the switch here's the attack frame the frame of course has to be addressed",
    "start": "1413960",
    "end": "1421659"
  },
  {
    "text": "to victims Mac address already because we're talking Layer Two and",
    "start": "1421659",
    "end": "1427460"
  },
  {
    "text": "mechanisms as ARP don't work here and if everything works well",
    "start": "1427460",
    "end": "1434600"
  },
  {
    "text": "the frame is forwarded unmodified through the trunk and on the other side gets stripped off",
    "start": "1434600",
    "end": "1441260"
  },
  {
    "text": "and gets delivered to victim of course this is a one-way game",
    "start": "1441260",
    "end": "1447880"
  },
  {
    "text": "or you just install some kind of real strange Trojan on victim",
    "start": "1448700",
    "end": "1454940"
  },
  {
    "text": "to get the traffic back but then you probably don't need VLAN hopping",
    "start": "1454940",
    "end": "1461440"
  },
  {
    "text": "okay here comes a classic address resolution protocol most of you know that so I go through",
    "start": "1462260",
    "end": "1469100"
  },
  {
    "text": "this pretty fast host a wants to talk to host B somehow",
    "start": "1469100",
    "end": "1474820"
  },
  {
    "text": "figures that this is tender 1.102 um",
    "start": "1474820",
    "end": "1480559"
  },
  {
    "text": "yeah on a data link layer he finds out that what is the Mega address of this host so",
    "start": "1480559",
    "end": "1487700"
  },
  {
    "text": "he doesn't know ARP kicks in um",
    "start": "1487700",
    "end": "1492860"
  },
  {
    "text": "he sends out a broadcast shouting through the world Network hey",
    "start": "1492860",
    "end": "1498320"
  },
  {
    "text": "who is that what's your address Husby answers with the mega address and",
    "start": "1498320",
    "end": "1505700"
  },
  {
    "text": "host a can now communicate this is well known isn't it okay",
    "start": "1505700",
    "end": "1512000"
  },
  {
    "text": "so the interception of interception or Architects",
    "start": "1512000",
    "end": "1517720"
  },
  {
    "text": "will basically the way that the attacker knows that he will actually hear the Cry",
    "start": "1517720",
    "end": "1524179"
  },
  {
    "text": "for Help from host a since host a is doing a broadcast through the world broadcast domain he",
    "start": "1524179",
    "end": "1530240"
  },
  {
    "text": "would see this packet even on a switch so we have the same procedure here but",
    "start": "1530240",
    "end": "1536299"
  },
  {
    "text": "attacker could be more chatty or faster or just stress the point that he is",
    "start": "1536299",
    "end": "1541880"
  },
  {
    "text": "really host a or host b or whatever he wants to be um so everyone will believe him looks",
    "start": "1541880",
    "end": "1548360"
  },
  {
    "text": "like this here's the question here comes the legal answer attacker appears",
    "start": "1548360",
    "end": "1556159"
  },
  {
    "text": "another answer attacker answers with his own Mac address and well while I did he can",
    "start": "1556159",
    "end": "1563120"
  },
  {
    "text": "actually lie to both parties and um so they both believe that the other",
    "start": "1563120",
    "end": "1569120"
  },
  {
    "text": "side is actually attacker and now everyone is addressing ethernet frames to attacker",
    "start": "1569120",
    "end": "1576200"
  },
  {
    "text": "this is a classic layer 2 ARP interception is very powerful",
    "start": "1576200",
    "end": "1582679"
  },
  {
    "text": "because there is no real way for good protection only protection that you can",
    "start": "1582679",
    "end": "1588320"
  },
  {
    "text": "do is configure Mac addresses on switches hard-coded per Port which is a",
    "start": "1588320",
    "end": "1594200"
  },
  {
    "text": "high administrative effort and so this works pretty good",
    "start": "1594200",
    "end": "1600620"
  },
  {
    "text": "it even works on wireless networks ARB interception same way you have",
    "start": "1600620",
    "end": "1607700"
  },
  {
    "text": "victim victim talking to each other you run your ARP interception that's it",
    "start": "1607700",
    "end": "1612980"
  },
  {
    "text": "since access points on wireless networks are mostly hubs or switch-like devices",
    "start": "1612980",
    "end": "1620120"
  },
  {
    "text": "it's pretty obvious but of course if you want to you can write a white paper on it",
    "start": "1620120",
    "end": "1626559"
  },
  {
    "text": "architect risks so as a result which risks come into play when someone",
    "start": "1626900",
    "end": "1634039"
  },
  {
    "text": "is doing Architects on you he could sniff of course he could modify",
    "start": "1634039",
    "end": "1641059"
  },
  {
    "text": "the data stream why because the attacker has to forward the packets",
    "start": "1641059",
    "end": "1648799"
  },
  {
    "text": "it's actually forwarding packets so he doesn't have any time constraints",
    "start": "1648799",
    "end": "1655159"
  },
  {
    "text": "there he can forward the packets and have some kind of processing in between which modifies the packets automatically",
    "start": "1655159",
    "end": "1663620"
  },
  {
    "text": "it's not a race condition because he gets the packets directly addressed to him",
    "start": "1663620",
    "end": "1670220"
  },
  {
    "text": "he can block the traffic of course like if you do an up interception and you have IP chains running on your little",
    "start": "1670220",
    "end": "1676640"
  },
  {
    "text": "Linux box or IP tables you can actually say everything that looks like ipsec is",
    "start": "1676640",
    "end": "1683419"
  },
  {
    "text": "going down the pan so that's it so no ipsec is going to happen",
    "start": "1683419",
    "end": "1688880"
  },
  {
    "text": "you can do this with like SSL encrypted connections so your Force users that",
    "start": "1688880",
    "end": "1695240"
  },
  {
    "text": "actually have to talk to the server to use plain text so you can actually sniff",
    "start": "1695240",
    "end": "1700640"
  },
  {
    "text": "or you just do rerouting because it's forwarded to you",
    "start": "1700640",
    "end": "1706340"
  },
  {
    "text": "um you decide the next top of forwarding so you can actually use yet another router",
    "start": "1706340",
    "end": "1712220"
  },
  {
    "text": "that uses a completely different routing path and send to packets",
    "start": "1712220",
    "end": "1718520"
  },
  {
    "text": "through the network even your trusty DHCP protocol can be",
    "start": "1718520",
    "end": "1725360"
  },
  {
    "text": "used for that um yeah this slide is actually not in there so this is one of the cases where",
    "start": "1725360",
    "end": "1732679"
  },
  {
    "text": "you have to download the updated slides sorry okay so what can we do with the h3p",
    "start": "1732679",
    "end": "1739220"
  },
  {
    "text": "first the attacker takes out the real DHCP",
    "start": "1739220",
    "end": "1745760"
  },
  {
    "text": "server simply by requesting all available IP addresses there are tools to do that and it's",
    "start": "1745760",
    "end": "1752960"
  },
  {
    "text": "pretty fast IP addresses are a limited resource and if you request all of them",
    "start": "1752960",
    "end": "1758899"
  },
  {
    "text": "the DHCP server is no longer able to answer any kind of request",
    "start": "1758899",
    "end": "1765380"
  },
  {
    "text": "so now when the client asks for an RP attacker is the only one who can answer",
    "start": "1765380",
    "end": "1771740"
  },
  {
    "text": "so here host a request the HTTP config attacker supplies IP and configuration",
    "start": "1771740",
    "end": "1779919"
  },
  {
    "text": "which of course includes default gateway and DNS",
    "start": "1779919",
    "end": "1785539"
  },
  {
    "text": "and of course Edgar it's not going to supply the real default gateway in the real DNS because",
    "start": "1785539",
    "end": "1792320"
  },
  {
    "text": "yeah that would be a waste of time he uses his machines IP address as default",
    "start": "1792320",
    "end": "1798799"
  },
  {
    "text": "gateway and as DNS which makes host a let's say highly dependent on attacker's",
    "start": "1798799",
    "end": "1804919"
  },
  {
    "text": "host yeah and that's how it looks like",
    "start": "1804919",
    "end": "1812380"
  },
  {
    "text": "yeah let's speak about routers how do we do we find them in the first place because before we attack them we should",
    "start": "1813140",
    "end": "1820399"
  },
  {
    "text": "actually know where they are there are passive and active ways",
    "start": "1820399",
    "end": "1826520"
  },
  {
    "text": "to detect progress passive ways include find all kinds of",
    "start": "1826520",
    "end": "1832279"
  },
  {
    "text": "multicast broadcast traffic that's connected to routing protocols or we",
    "start": "1832279",
    "end": "1838640"
  },
  {
    "text": "listen to irdp Edward heisman's or we just",
    "start": "1838640",
    "end": "1844480"
  },
  {
    "text": "wait for any kind of CDP showing up so we actually see the routers when they",
    "start": "1844480",
    "end": "1850220"
  },
  {
    "text": "talk on the network um this actually gives us a lot of information but for the real fun",
    "start": "1850220",
    "end": "1858200"
  },
  {
    "text": "we go for active scanning we can scan for autonomous systems that",
    "start": "1858200",
    "end": "1866600"
  },
  {
    "text": "separation between routing protocol instances we can scan for them",
    "start": "1866600",
    "end": "1872620"
  },
  {
    "text": "we can send out router solicitations in irdp to find routers because they will",
    "start": "1872620",
    "end": "1879799"
  },
  {
    "text": "answer if they're configured to do so we can use the normal OS fingerprinting",
    "start": "1879799",
    "end": "1885679"
  },
  {
    "text": "stuff so when it says it's a Cisco then it's probably a router we can do",
    "start": "1885679",
    "end": "1892039"
  },
  {
    "text": "protocol scans and board skins for different routing protocol ports and protocols that have to be available",
    "start": "1892039",
    "end": "1899419"
  },
  {
    "text": "or we just go into the next best management system that looks like hpov",
    "start": "1899419",
    "end": "1905539"
  },
  {
    "text": "or whatever and request friendly a list of available routers which mostly gives",
    "start": "1905539",
    "end": "1911899"
  },
  {
    "text": "us the SNMP communities as well so discovering routers looks like this",
    "start": "1911899",
    "end": "1919340"
  },
  {
    "text": "you have the first four lines are passive discovered it's irdp from the",
    "start": "1919340",
    "end": "1926600"
  },
  {
    "text": "same host announcing two different default gateways enhance igrp two",
    "start": "1926600",
    "end": "1932480"
  },
  {
    "text": "different autonomous systems and what's neat it gives you the iOS version and the enhanced igrp version so again if",
    "start": "1932480",
    "end": "1940100"
  },
  {
    "text": "you have any kind of special exploit for the 11.1 here we go um the rest is actively discovered by in",
    "start": "1940100",
    "end": "1948320"
  },
  {
    "text": "this case by ISS just joining um then hands at GOP group membership and asking",
    "start": "1948320",
    "end": "1955159"
  },
  {
    "text": "friendly for the routing information and everything you get you see you have a lot of information you can use it's like",
    "start": "1955159",
    "end": "1961279"
  },
  {
    "text": "the destination networks if it is internal or external for external links it actually gives you",
    "start": "1961279",
    "end": "1968899"
  },
  {
    "text": "the source of this link like this is connected this is coming from yet another enhanced igrp router and yeah",
    "start": "1968899",
    "end": "1976159"
  },
  {
    "text": "you have everything you need to perform your attack so which tools do we have to discover",
    "start": "1976159",
    "end": "1983960"
  },
  {
    "text": "these that would be the ass we actually showed",
    "start": "1983960",
    "end": "1989179"
  },
  {
    "text": "in two sites here already The Ether protocol analyzer is real good",
    "start": "1989179",
    "end": "1996500"
  },
  {
    "text": "and if you prefer to do your stuff by hand go for this one you can use antop to find Central points",
    "start": "1996500",
    "end": "2005260"
  },
  {
    "text": "of communication in the network that actually leads you in the second place two routers",
    "start": "2005260",
    "end": "2012220"
  },
  {
    "text": "TCP dumps Dash e gives you data link addresses and",
    "start": "2012220",
    "end": "2017559"
  },
  {
    "text": "if the destination data link address does not match the destination IP address this one is addressed to the",
    "start": "2017559",
    "end": "2024159"
  },
  {
    "text": "next top which is probably a router or you just use nmap to scan for IP",
    "start": "2024159",
    "end": "2032019"
  },
  {
    "text": "protocols or ports you can ask the next DHCP server if he",
    "start": "2032019",
    "end": "2038260"
  },
  {
    "text": "would be so nice and Supply a default Wireless to you or as already mentioned",
    "start": "2038260",
    "end": "2043860"
  },
  {
    "text": "you take over a network management system and it gives you all the available routers and 32-bit High color",
    "start": "2043860",
    "end": "2053700"
  },
  {
    "text": "icmp router Discovery protocol irdp we actually mentioned it here",
    "start": "2056260",
    "end": "2061599"
  },
  {
    "text": "twice already um it's used to",
    "start": "2061599",
    "end": "2068200"
  },
  {
    "text": "have hosts relieved from the task of configuring the default gateway you know",
    "start": "2068200",
    "end": "2073960"
  },
  {
    "text": "the average Windows user has probably no idea what the default gateway is so",
    "start": "2073960",
    "end": "2080200"
  },
  {
    "text": "it's just left blank the router advertises himself as a router and the",
    "start": "2080200",
    "end": "2086378"
  },
  {
    "text": "Machine can actually access other networks so without us Edward tries themselves",
    "start": "2086379",
    "end": "2093300"
  },
  {
    "text": "hosts broadcast four routers which is called solicitation",
    "start": "2093300",
    "end": "2099280"
  },
  {
    "text": "um fixed routes if you have a default route configured on your host has normally a",
    "start": "2099280",
    "end": "2107140"
  },
  {
    "text": "higher priority means a lower Matrix um but the routes that you get via irdp",
    "start": "2107140",
    "end": "2115320"
  },
  {
    "text": "come right next to your hard-coded default gateway so the attack is very obvious",
    "start": "2115320",
    "end": "2123820"
  },
  {
    "text": "make yourself known as router kill the default router temporarily",
    "start": "2123820",
    "end": "2129420"
  },
  {
    "text": "sometimes you don't even have to do that um and then route the traffic which",
    "start": "2129420",
    "end": "2136060"
  },
  {
    "text": "looks like this you just disable this router here and everything goes through you",
    "start": "2136060",
    "end": "2143320"
  },
  {
    "text": "if you are in a network where the router is actually a dial on demand router or",
    "start": "2143320",
    "end": "2149800"
  },
  {
    "text": "anything else that takes more than let's say two seconds and to",
    "start": "2149800",
    "end": "2156060"
  },
  {
    "text": "get the line up this line here then you're happy because you don't need",
    "start": "2156060",
    "end": "2161560"
  },
  {
    "text": "to take out the router Windows is very funny um because it does irdp all the time",
    "start": "2161560",
    "end": "2168339"
  },
  {
    "text": "so you're sitting here do an irdp advertisements",
    "start": "2168339",
    "end": "2173440"
  },
  {
    "text": "um saying hey I'm a router but Windows already configured this router here as default gateway",
    "start": "2173440",
    "end": "2179740"
  },
  {
    "text": "you just wait till this line here is not online let's say it's a ISDN PPP",
    "start": "2179740",
    "end": "2187660"
  },
  {
    "text": "connection you just wait until this connection hit",
    "start": "2187660",
    "end": "2192760"
  },
  {
    "text": "the idle timer and went down then if this host is trying to connect to the internet",
    "start": "2192760",
    "end": "2199359"
  },
  {
    "text": "he is sending a packet over here of course forwarding this packet to the router the router figures oops line is",
    "start": "2199359",
    "end": "2206140"
  },
  {
    "text": "done have to get it up start styling and yeah this takes two seconds but in this",
    "start": "2206140",
    "end": "2211180"
  },
  {
    "text": "time this host here decides oh I saw another router that said he can do the job and he will actually forward the",
    "start": "2211180",
    "end": "2217060"
  },
  {
    "text": "packet to you and all you have to do is make host a happy like send anything back if",
    "start": "2217060",
    "end": "2225220"
  },
  {
    "text": "it was a sun request send back any kind of reset or whatever so he has the feeling he's actually",
    "start": "2225220",
    "end": "2231460"
  },
  {
    "text": "communicating that's fine and as soon as this line is online",
    "start": "2231460",
    "end": "2237099"
  },
  {
    "text": "you can really forward the traffic and you got the route without even touching this thing here",
    "start": "2237099",
    "end": "2245220"
  },
  {
    "text": "so this technique can be used directed or white like in broadcast",
    "start": "2246820",
    "end": "2253920"
  },
  {
    "text": "because you can send your irdp advertisements directly to one host or",
    "start": "2253920",
    "end": "2260020"
  },
  {
    "text": "as they are designed to the word broadcast domain Windows systems are actually the best",
    "start": "2260020",
    "end": "2266500"
  },
  {
    "text": "targets because first there yeah they don't like any kind of delay",
    "start": "2266500",
    "end": "2274839"
  },
  {
    "text": "in the communication so as soon as a delay happens they take the next best grower",
    "start": "2274839",
    "end": "2279940"
  },
  {
    "text": "and they do irdp all the time means even if the system is up and",
    "start": "2279940",
    "end": "2285520"
  },
  {
    "text": "running for let's say two days which would be kind of funny for Windows anyway",
    "start": "2285520",
    "end": "2291700"
  },
  {
    "text": "um then you can actually Force the system to use your router by having the special",
    "start": "2291700",
    "end": "2299140"
  },
  {
    "text": "preference field set to 1000 because they do a very funny thing um and I don't know why but what they do",
    "start": "2299140",
    "end": "2306460"
  },
  {
    "text": "is they take 1000 and subtract the preference sent in your irdp packet from",
    "start": "2306460",
    "end": "2314020"
  },
  {
    "text": "it and this actually gives them the metric well",
    "start": "2314020",
    "end": "2319660"
  },
  {
    "text": "so if you set it to 1000 you actually have a matrix of zero and you are the default router",
    "start": "2319660",
    "end": "2326440"
  },
  {
    "text": "Windows 2000 and line Oaks on the other hand are not even listening to this kind",
    "start": "2326440",
    "end": "2332079"
  },
  {
    "text": "of icmp so this is Kida Limited",
    "start": "2332079",
    "end": "2337560"
  },
  {
    "text": "icmp redirects were known to most of you probably",
    "start": "2337780",
    "end": "2344380"
  },
  {
    "text": "um are very handy and actually more powerful than most mostly assumed",
    "start": "2344380",
    "end": "2350320"
  },
  {
    "text": "the worm introduced to make routing more effective so this",
    "start": "2350320",
    "end": "2357339"
  },
  {
    "text": "is the normal way host a census traffic to router R1 because it",
    "start": "2357339",
    "end": "2364180"
  },
  {
    "text": "is configured this way um and router are one figures I'm",
    "start": "2364180",
    "end": "2370540"
  },
  {
    "text": "forwarding this Frame again to the same segment to another router with the same with the IP address in the same segment",
    "start": "2370540",
    "end": "2378820"
  },
  {
    "text": "this doesn't make sense so what he actually does is he tells host a c that doesn't make sense please",
    "start": "2378820",
    "end": "2386680"
  },
  {
    "text": "use router 2 for the next communication and of course",
    "start": "2386680",
    "end": "2392920"
  },
  {
    "text": "this works vice versa so if we want to attack something",
    "start": "2392920",
    "end": "2397960"
  },
  {
    "text": "you just make yourself the default gateway for this specific destination",
    "start": "2397960",
    "end": "2403540"
  },
  {
    "text": "you just tell host a sorry your routing wasn't that effective",
    "start": "2403540",
    "end": "2409960"
  },
  {
    "text": "could you like next time forward your package to me and he will do that",
    "start": "2409960",
    "end": "2416740"
  },
  {
    "text": "very important um two things first most systems require",
    "start": "2416740",
    "end": "2422619"
  },
  {
    "text": "that the icmp redirect packet carries 64-bit minimum of the offending packet",
    "start": "2422619",
    "end": "2429460"
  },
  {
    "text": "which makes actually sense because they want to know which destination address",
    "start": "2429460",
    "end": "2435700"
  },
  {
    "text": "actually caused this message so they know which communication actually has to go through",
    "start": "2435700",
    "end": "2442720"
  },
  {
    "text": "the new router which is you um next time they want to speak to it",
    "start": "2442720",
    "end": "2449140"
  },
  {
    "text": "the second thing is this being icmp running over IP",
    "start": "2449140",
    "end": "2456160"
  },
  {
    "text": "makes it usable remote if you carefully craft your rtmp",
    "start": "2456160",
    "end": "2462460"
  },
  {
    "text": "redirect packets you can actually Force Vol traffic path links like routes over",
    "start": "2462460",
    "end": "2469599"
  },
  {
    "text": "multiple routers to do what you want",
    "start": "2469599",
    "end": "2475680"
  },
  {
    "text": "so the most simple example for that is if you make the host B over here",
    "start": "2476140",
    "end": "2482140"
  },
  {
    "text": "um talk to you this is the absolute simple way because",
    "start": "2482140",
    "end": "2487359"
  },
  {
    "text": "you get the first packet from host B to you you construct an icmp redirect packet based on this information and",
    "start": "2487359",
    "end": "2494740"
  },
  {
    "text": "send it back and if he uses like multiple routers over here you can influence",
    "start": "2494740",
    "end": "2500680"
  },
  {
    "text": "which router he uses of course you always influence for the host you send",
    "start": "2500680",
    "end": "2505839"
  },
  {
    "text": "the icmp redirect to um you just influence his next talk so",
    "start": "2505839",
    "end": "2511240"
  },
  {
    "text": "if you have multiple routers in between like four hops you have to do four icmp",
    "start": "2511240",
    "end": "2517359"
  },
  {
    "text": "redirects to actually influence the road traffic path through routed Networks",
    "start": "2517359",
    "end": "2524460"
  },
  {
    "text": "host reactions how does it look like Windows loves icmp",
    "start": "2525579",
    "end": "2531160"
  },
  {
    "text": "really they're happily inserted into the routing table as a host route",
    "start": "2531160",
    "end": "2537040"
  },
  {
    "text": "so um this is on the other hand good for the defender because if someone is",
    "start": "2537040",
    "end": "2542800"
  },
  {
    "text": "playing icmp redirect tricks on you you just do route print and you see all the",
    "start": "2542800",
    "end": "2548380"
  },
  {
    "text": "host brows appearing in your routing table for Linux it pretty much depends on the",
    "start": "2548380",
    "end": "2553780"
  },
  {
    "text": "distribution what the default setting is so check your proc file system",
    "start": "2553780",
    "end": "2559359"
  },
  {
    "text": "s the redirect things even if they are accepted are not",
    "start": "2559359",
    "end": "2566320"
  },
  {
    "text": "showing up in your routing table you have to check the proc file system to see them",
    "start": "2566320",
    "end": "2572980"
  },
  {
    "text": "and of course if you want to test this in your lab Network",
    "start": "2572980",
    "end": "2578280"
  },
  {
    "text": "you can use Yuri's icmp redirect tool or just the one that's in the airpass suite",
    "start": "2578280",
    "end": "2586000"
  },
  {
    "text": "and this is how it looks like for Windows we had some redirects here Windows system was talking to these",
    "start": "2586000",
    "end": "2593380"
  },
  {
    "text": "hosts icmp redirect was sent with this as a default gateway",
    "start": "2593380",
    "end": "2600880"
  },
  {
    "text": "and yeah that's how it looks like so if you have something like this on",
    "start": "2600880",
    "end": "2607060"
  },
  {
    "text": "your windows box and you didn't configure them yourself you should actually start a sniffer and find out",
    "start": "2607060",
    "end": "2612640"
  },
  {
    "text": "what's going on routing protocol the first one interior",
    "start": "2612640",
    "end": "2620140"
  },
  {
    "text": "Gateway routing protocol igrp is a Cisco idea",
    "start": "2620140",
    "end": "2626500"
  },
  {
    "text": "um it has 65 535 means 2 to the power of 16 possible",
    "start": "2626500",
    "end": "2633579"
  },
  {
    "text": "autonomous systems which can of course be discovered what you do is what I call",
    "start": "2633579",
    "end": "2639160"
  },
  {
    "text": "autonomous system scanning it's basically the same as protocol scanning or Port scanning the only difference is",
    "start": "2639160",
    "end": "2645400"
  },
  {
    "text": "you iterate through all the possible autonomous systems and see who's answering",
    "start": "2645400",
    "end": "2650800"
  },
  {
    "text": "so you can actually discover them because the number of autonomous systems is the same as the number of TCP or UDP",
    "start": "2650800",
    "end": "2658240"
  },
  {
    "text": "ports in IP and you all know the port skin doesn't take like days it's pretty",
    "start": "2658240",
    "end": "2663819"
  },
  {
    "text": "fast so this is discoverable it uses no authentication thank you",
    "start": "2663819",
    "end": "2672099"
  },
  {
    "text": "um various data on link is used for calculating the metric which",
    "start": "2672099",
    "end": "2679420"
  },
  {
    "text": "means you have to delay bandwidth reliability load hop count",
    "start": "2679420",
    "end": "2686079"
  },
  {
    "text": "um Cisco sunshine face whatever and it's all calculated together",
    "start": "2686079",
    "end": "2692099"
  },
  {
    "text": "to come up with some kind of strange metric and of course if you provide this data",
    "start": "2692099",
    "end": "2699700"
  },
  {
    "text": "here in some kind of packet you send to the router you can obviously produce the",
    "start": "2699700",
    "end": "2706300"
  },
  {
    "text": "better link because you're not bound to reward constraints",
    "start": "2706300",
    "end": "2712000"
  },
  {
    "text": "a host can listen to igrp without saying anything this is",
    "start": "2712000",
    "end": "2717280"
  },
  {
    "text": "must know that called a passive interface so you should use protocol scans to find",
    "start": "2717280",
    "end": "2724420"
  },
  {
    "text": "out if this host is actually capable of listening to this protocol",
    "start": "2724420",
    "end": "2730060"
  },
  {
    "text": "and by making up updates or yeah actually by making up updates",
    "start": "2730060",
    "end": "2736240"
  },
  {
    "text": "um and crafting your delay bandwidth and reliability and load were used correctly",
    "start": "2736240",
    "end": "2744280"
  },
  {
    "text": "um you can introduce routes keep in mind though that neural network",
    "start": "2744280",
    "end": "2750160"
  },
  {
    "text": "The Source Network you claim to come from we all know this doesn't have to be",
    "start": "2750160",
    "end": "2755200"
  },
  {
    "text": "the network you're actually connected to um has to be enabled as possible source for",
    "start": "2755200",
    "end": "2761440"
  },
  {
    "text": "routing Updates this is the network statement in your Cisco config",
    "start": "2761440",
    "end": "2766800"
  },
  {
    "text": "so we will use igrp to discuss the General application of",
    "start": "2766900",
    "end": "2773020"
  },
  {
    "text": "routing protocol attacks with made up updates",
    "start": "2773020",
    "end": "2778800"
  },
  {
    "text": "we can use igrp to introduce new routes",
    "start": "2782619",
    "end": "2788680"
  },
  {
    "text": "sounds funny but what do we gain from doing this",
    "start": "2788680",
    "end": "2794380"
  },
  {
    "text": "our air taker has a simple goal he wants the password that host B over here",
    "start": "2794380",
    "end": "2802180"
  },
  {
    "text": "is sending to this nice little server over here that sadism",
    "start": "2802180",
    "end": "2807940"
  },
  {
    "text": "pop log in FTP whatever so but being over here",
    "start": "2807940",
    "end": "2815980"
  },
  {
    "text": "way on the other side of the routed Network there is no way to sniff the password",
    "start": "2815980",
    "end": "2821740"
  },
  {
    "text": "and well so what are we doing first first step he adds",
    "start": "2821740",
    "end": "2828819"
  },
  {
    "text": "a second IP address to his host which is actually as you can see the same IP",
    "start": "2828819",
    "end": "2833920"
  },
  {
    "text": "address as server has then he tells router 1",
    "start": "2833920",
    "end": "2840339"
  },
  {
    "text": "that he actually uses for this update router 3's IP address",
    "start": "2840339",
    "end": "2847060"
  },
  {
    "text": "as the spoof tools heat Health router 1 that 1001 or 3.2 is",
    "start": "2847060",
    "end": "2854200"
  },
  {
    "text": "real interface address is absolutely the best way to reach",
    "start": "2854200",
    "end": "2859900"
  },
  {
    "text": "um this 10.1 or 1.2",
    "start": "2859900",
    "end": "2865480"
  },
  {
    "text": "now he tells router 2 using r1's IP address that R1 is",
    "start": "2865480",
    "end": "2872380"
  },
  {
    "text": "absolutely the better way to reach 100102 and now if host B logs in and tries to",
    "start": "2872380",
    "end": "2880839"
  },
  {
    "text": "access 10.1.1.2 it's actually forwarded from this to the better next top R1 from R1",
    "start": "2880839",
    "end": "2888460"
  },
  {
    "text": "to the better next top editor and this one is running the fake server and so he",
    "start": "2888460",
    "end": "2893740"
  },
  {
    "text": "logs into attacker's machine and of course etiger gets the password",
    "start": "2893740",
    "end": "2901119"
  },
  {
    "text": "if for some reason Attica just wants to prevent communication between the two",
    "start": "2901119",
    "end": "2906220"
  },
  {
    "text": "um he can make up routing Loops he tells R3 that R1",
    "start": "2906220",
    "end": "2911319"
  },
  {
    "text": "is the best way to reach host B and he tells R1 that R3",
    "start": "2911319",
    "end": "2918760"
  },
  {
    "text": "is the best way to reach host B and then he enjoys seeing the packet using up its",
    "start": "2918760",
    "end": "2924460"
  },
  {
    "text": "TTR routing information protocol rip it's",
    "start": "2924460",
    "end": "2931900"
  },
  {
    "text": "probably one of the oldest still and use routing protocols it uses fixed Network sizes in the",
    "start": "2931900",
    "end": "2939280"
  },
  {
    "text": "version one um rep has no autonomous systems and just runs on top of UDP on Port 520 so",
    "start": "2939280",
    "end": "2947920"
  },
  {
    "text": "you just go for Port scans to find a rib V1 heavily depends on broadcasts",
    "start": "2947920",
    "end": "2954220"
  },
  {
    "text": "which makes it easy to set up but also easy to spot",
    "start": "2954220",
    "end": "2959440"
  },
  {
    "text": "um there is as you see a rip version 2. that can actually cope with variable sized subnets and it even supports clear",
    "start": "2959440",
    "end": "2968260"
  },
  {
    "text": "text authentication by the RFC or if you just have Cisco equipment you can use",
    "start": "2968260",
    "end": "2974020"
  },
  {
    "text": "the non-standard not compatible md5 Authentication",
    "start": "2974020",
    "end": "2980500"
  },
  {
    "text": "but basically the tags are the same um you can introduce routes",
    "start": "2980500",
    "end": "2987880"
  },
  {
    "text": "if you know the right authentication assumed someone is using grip V2",
    "start": "2987880",
    "end": "2993599"
  },
  {
    "text": "of course you have to watch out for the network boundaries in rip V1",
    "start": "2993599",
    "end": "2999339"
  },
  {
    "text": "um there is a thing that's called splitorizing with poison reverse algorithm that is designed to prevent",
    "start": "2999339",
    "end": "3005700"
  },
  {
    "text": "routing Loops in rip networks which actually works the way if the router gets a routing update he sends back the",
    "start": "3005700",
    "end": "3014099"
  },
  {
    "text": "same routing update to the source of the update with the modified Matrix that's infinite which is the number 16 in rip",
    "start": "3014099",
    "end": "3023099"
  },
  {
    "text": "so you have to watch out for this one if you want to do a routing Loop use three routers or whatever",
    "start": "3023099",
    "end": "3029760"
  },
  {
    "text": "and of course there are tools to send these things out",
    "start": "3029760",
    "end": "3036060"
  },
  {
    "text": "enhanced interior Gateway protocol or enhanced igrp is probably one of the",
    "start": "3036060",
    "end": "3041339"
  },
  {
    "text": "most used Cisco protocols because it's very easy",
    "start": "3041339",
    "end": "3046560"
  },
  {
    "text": "to set up and it's safe to be pretty effective um it has 2 to the power of 32 possible",
    "start": "3046560",
    "end": "3054599"
  },
  {
    "text": "autonomous systems but the iOS shell only suggests the first 65 535 and I've actually never",
    "start": "3054599",
    "end": "3063900"
  },
  {
    "text": "seen someone using a higher number for autonomous systems and I'm not even sure",
    "start": "3063900",
    "end": "3069540"
  },
  {
    "text": "if it is going to work but the protocol defines a 32-bit field for autonomous",
    "start": "3069540",
    "end": "3074819"
  },
  {
    "text": "system it still has no authentication and still uses a lot of different",
    "start": "3074819",
    "end": "3081660"
  },
  {
    "text": "information to calculate some kind of strange metric the only difference is to talk to",
    "start": "3081660",
    "end": "3088020"
  },
  {
    "text": "enhanced igrp routers you have to join as a neighbor you have to be a neighbor so you can",
    "start": "3088020",
    "end": "3094020"
  },
  {
    "text": "talk to them much like some closed up neighborhoods in the U.S",
    "start": "3094020",
    "end": "3099180"
  },
  {
    "text": "as always your Source network has to be enabled as a possible source for Route",
    "start": "3099180",
    "end": "3104520"
  },
  {
    "text": "updates or a possible place for a neighbor to be so if the Cisco config",
    "start": "3104520",
    "end": "3110040"
  },
  {
    "text": "doesn't say Network xyza and your not in there sorry this is not gonna",
    "start": "3110040",
    "end": "3117180"
  },
  {
    "text": "work so introducing a route here",
    "start": "3117180",
    "end": "3122339"
  },
  {
    "text": "is as I said the same procedure the only difference first you temporarily join as a neighbor",
    "start": "3122339",
    "end": "3129119"
  },
  {
    "text": "which is not difficult and then you introduce your let's call",
    "start": "3129119",
    "end": "3134700"
  },
  {
    "text": "it special routing information ospf open shortest path first",
    "start": "3134700",
    "end": "3143220"
  },
  {
    "text": "um is a pretty complex interior Gateway protocol and I go over this and the bgp",
    "start": "3143220",
    "end": "3149760"
  },
  {
    "text": "slide pretty fast because Nico and Sebastian are going to cover this more extensively",
    "start": "3149760",
    "end": "3156920"
  },
  {
    "text": "um yeah so it basically sends out link State advertisements in Halo packets and",
    "start": "3157559",
    "end": "3164819"
  },
  {
    "text": "to multicast address these ospf networks are split up in",
    "start": "3164819",
    "end": "3170880"
  },
  {
    "text": "areas and you can like spend half a year to design a big ospf Network",
    "start": "3170880",
    "end": "3177859"
  },
  {
    "text": "so ospf has a lot more security features than the other protocols we just",
    "start": "3177859",
    "end": "3183240"
  },
  {
    "text": "discussed but since ospf is so tricky most designs",
    "start": "3183240",
    "end": "3188819"
  },
  {
    "text": "are flawed and you can exploit that just to demonstrate the fact",
    "start": "3188819",
    "end": "3194880"
  },
  {
    "text": "um that ospf is complex we just took a complex attack instead of just sending",
    "start": "3194880",
    "end": "3201660"
  },
  {
    "text": "ospf information around which experiments have shown mostly leads to completely",
    "start": "3201660",
    "end": "3208200"
  },
  {
    "text": "deny of service and no intelligent attack um we just go for a combined layer two",
    "start": "3208200",
    "end": "3215640"
  },
  {
    "text": "layer 3 attack you have the router 1 here and router 2 here and they're all talking together",
    "start": "3215640",
    "end": "3222240"
  },
  {
    "text": "ospf and attacker just does first the layer 2",
    "start": "3222240",
    "end": "3228059"
  },
  {
    "text": "ARP interception very basic thing between the two oh we had a very funny discussion",
    "start": "3228059",
    "end": "3233760"
  },
  {
    "text": "because ospf runs mostly over multicast it was doubted that this is going to",
    "start": "3233760",
    "end": "3238800"
  },
  {
    "text": "work it's gonna work because the multicast is used for the lsas and if you have a communication to transfer",
    "start": "3238800",
    "end": "3245640"
  },
  {
    "text": "routing databases it's directed and it's again using ARP so you can do this",
    "start": "3245640",
    "end": "3252839"
  },
  {
    "text": "um yeah and when the database transfer goes there at a group gets it modifies",
    "start": "3252839",
    "end": "3259260"
  },
  {
    "text": "it sends it back into router 2 and he will distribute the false information",
    "start": "3259260",
    "end": "3264660"
  },
  {
    "text": "you should take care that you do this before the routing information becomes public",
    "start": "3264660",
    "end": "3270180"
  },
  {
    "text": "knowledge in the network because every router in ospf area knows the status of",
    "start": "3270180",
    "end": "3275640"
  },
  {
    "text": "the complete routing table so if you try to send in a fake route that's already",
    "start": "3275640",
    "end": "3281880"
  },
  {
    "text": "known in a routing table the specific one then the routers will stop challenge",
    "start": "3281880",
    "end": "3287819"
  },
  {
    "text": "this forged LSA and you will have a hard time to convince",
    "start": "3287819",
    "end": "3292980"
  },
  {
    "text": "all routers in this area that your routing information is the correct one",
    "start": "3292980",
    "end": "3299059"
  },
  {
    "text": "for Border Gateway protocol is an external exterior Gateway protocol it's",
    "start": "3299579",
    "end": "3306359"
  },
  {
    "text": "mentioned here only because it's Kit important and the audience probably knows why",
    "start": "3306359",
    "end": "3312359"
  },
  {
    "text": "pgp relies on TCP for communication there is an interior bgp and an exterior",
    "start": "3312359",
    "end": "3319079"
  },
  {
    "text": "bgp the interior one really needs some kind of interior",
    "start": "3319079",
    "end": "3326880"
  },
  {
    "text": "Gateway protocol to reach the neighbors so they can communicate via TCP",
    "start": "3326880",
    "end": "3333420"
  },
  {
    "text": "and sort of possible attack scenarios include",
    "start": "3333420",
    "end": "3340200"
  },
  {
    "text": "somehow sending bad updates you can intercept TCP",
    "start": "3340500",
    "end": "3346559"
  },
  {
    "text": "connection between two Neighbors or you just attack the interior Gateway",
    "start": "3346559",
    "end": "3352980"
  },
  {
    "text": "protocol that gives interior bgp the information how to reach the next neighbor",
    "start": "3352980",
    "end": "3359099"
  },
  {
    "text": "all these attacks are not really fully researched or to be more precise",
    "start": "3359099",
    "end": "3366559"
  },
  {
    "text": "these research results are not published so this is kind of yeah let's call it",
    "start": "3366559",
    "end": "3374339"
  },
  {
    "text": "not public knowledge more like underground knowledge about how to hack pgp4nets but yeah as a reference the",
    "start": "3374339",
    "end": "3382380"
  },
  {
    "text": "next speech will be more in deep here we go back to funny things hsrpe hot",
    "start": "3382380",
    "end": "3388680"
  },
  {
    "text": "standby router protocol yet another Cisco idea multiple routers share virtual IP",
    "start": "3388680",
    "end": "3395280"
  },
  {
    "text": "address and a virtual Mac address there is a default one but you can change that and",
    "start": "3395280",
    "end": "3400740"
  },
  {
    "text": "it doesn't help you the router that's active is active and is actually holding this",
    "start": "3400740",
    "end": "3407280"
  },
  {
    "text": "virtual IP address and is forwarding the traffic and all the others sit there and wait that the",
    "start": "3407280",
    "end": "3413579"
  },
  {
    "text": "first router dies much like management you sit there and wait that your boss is either kicked out or leaves the company",
    "start": "3413579",
    "end": "3420900"
  },
  {
    "text": "so the protocol talks over UDP multicast",
    "start": "3420900",
    "end": "3427020"
  },
  {
    "text": "and uses clear text eight character Authentication",
    "start": "3427020",
    "end": "3432660"
  },
  {
    "text": "um well you obviously can wait for the multicast to come through your machine and read this clear text authentication",
    "start": "3432660",
    "end": "3439440"
  },
  {
    "text": "but most people don't even bother to set the password the default password by the way is Cisco",
    "start": "3439440",
    "end": "3447599"
  },
  {
    "text": "um when an active router dies to standby routers fight for the active state",
    "start": "3447599",
    "end": "3453599"
  },
  {
    "text": "and whoever has the highest priority wins you see not much Security in here",
    "start": "3453599",
    "end": "3461420"
  },
  {
    "text": "the successor of hsrp called vrrp um is actually an",
    "start": "3461420",
    "end": "3467819"
  },
  {
    "text": "another RFC 2338 provides you with a little bit more",
    "start": "3467819",
    "end": "3473640"
  },
  {
    "text": "authentication because you can use the ipsec authentication headers",
    "start": "3473640",
    "end": "3479780"
  },
  {
    "text": "anyway we go for the Classic hsrp this is how it looks like",
    "start": "3479880",
    "end": "3484980"
  },
  {
    "text": "you have rather one router two they're talking hsrp um the blue thing here is this virtual",
    "start": "3484980",
    "end": "3490859"
  },
  {
    "text": "IP address so everyone is using router one to communicate to the let's call it",
    "start": "3490859",
    "end": "3496800"
  },
  {
    "text": "internet if you tell router 1 that router 2 is",
    "start": "3496800",
    "end": "3502319"
  },
  {
    "text": "actually way better machine and is brand new and router one should really use router 2 as",
    "start": "3502319",
    "end": "3509520"
  },
  {
    "text": "the active one um that works so router 2 gets the virtual IP address and a one talks via",
    "start": "3509520",
    "end": "3517740"
  },
  {
    "text": "router 2. of course you can tell both",
    "start": "3517740",
    "end": "3523440"
  },
  {
    "text": "hey I'm the super Cisco device and you should give me your virtual IP address and works like a champ you get which IP",
    "start": "3523440",
    "end": "3531420"
  },
  {
    "text": "address everyone is communicating over your host and it's perfectly transparent",
    "start": "3531420",
    "end": "3536700"
  },
  {
    "text": "to all clients thank you Cisco's recommendation",
    "start": "3536700",
    "end": "3542760"
  },
  {
    "text": "by now is to use ipsec for the communication hsrp",
    "start": "3542760",
    "end": "3548940"
  },
  {
    "text": "but as very trusty sources told me um this is not really working or at",
    "start": "3548940",
    "end": "3554579"
  },
  {
    "text": "least if you have more than two devices it's cater tricky so yeah",
    "start": "3554579",
    "end": "3561000"
  },
  {
    "text": "um watch out before you configure hsrp and you would be surprised to see how much",
    "start": "3561000",
    "end": "3567240"
  },
  {
    "text": "um let's call them e-commerce companies run two hsrp routers in front of their",
    "start": "3567240",
    "end": "3573960"
  },
  {
    "text": "firewall um to have high availability to the internet and didn't even bother to",
    "start": "3573960",
    "end": "3580260"
  },
  {
    "text": "change the password from Cisco to something something more creative like secure",
    "start": "3580260",
    "end": "3587059"
  },
  {
    "text": "after so much routing and yeah lots of paper we jump into tunnels",
    "start": "3588079",
    "end": "3595680"
  },
  {
    "text": "to make it perfectly clear we're not talking about ipsec tunnels here if I could break into ipse tunnels I would",
    "start": "3595680",
    "end": "3601980"
  },
  {
    "text": "probably not talk to you but have fun in your internet right now so",
    "start": "3601980",
    "end": "3607380"
  },
  {
    "text": "and we're talking about unencrypted tunnels which can be abused",
    "start": "3607380",
    "end": "3612420"
  },
  {
    "text": "since they're basically just encapsulation so the idea is to generate traffic",
    "start": "3612420",
    "end": "3620579"
  },
  {
    "text": "um as a normal participant of the VPN will do",
    "start": "3620579",
    "end": "3625760"
  },
  {
    "text": "encapsulated sent it to the tunnel destination router",
    "start": "3625760",
    "end": "3630780"
  },
  {
    "text": "with the spoof Source address in an outer packet of the defined tunnel",
    "start": "3630780",
    "end": "3636780"
  },
  {
    "text": "Source wherever answer get the packet into this VPN the",
    "start": "3636780",
    "end": "3642839"
  },
  {
    "text": "return path highly depends on the scenario final vulnerable protocols include IP",
    "start": "3642839",
    "end": "3650339"
  },
  {
    "text": "encapsulation ipv4 and ipv4 generic routing encapsulation and anything else",
    "start": "3650339",
    "end": "3656520"
  },
  {
    "text": "you might see that uses outer packet inner packet sent",
    "start": "3656520",
    "end": "3662960"
  },
  {
    "text": "so we go for an example generic routing encapsulation most used",
    "start": "3663780",
    "end": "3670940"
  },
  {
    "text": "um it's a general protocol that basically is designed to transport protocol a over protocol b in a backpack",
    "start": "3670980",
    "end": "3678420"
  },
  {
    "text": "that's it it's pretty simple in the definition the RFC is like a fast read",
    "start": "3678420",
    "end": "3685619"
  },
  {
    "text": "um you could transport ipv4 in V4 V6 and V4 ipx and V4 so on whatever you want to",
    "start": "3685619",
    "end": "3694260"
  },
  {
    "text": "combine the best authentication it can give you is a 32-bit fixed tunnel key",
    "start": "3694260",
    "end": "3701760"
  },
  {
    "text": "so yeah I mean you have to send out like four billion packets and this might take",
    "start": "3701760",
    "end": "3708540"
  },
  {
    "text": "some time but there's still a chance to brute force a 32-bit tunnel key",
    "start": "3708540",
    "end": "3714720"
  },
  {
    "text": "anyway um mostly this tunnel key isn't used because you have to configure it and",
    "start": "3714720",
    "end": "3720780"
  },
  {
    "text": "yeah you know configuring Keys No",
    "start": "3720780",
    "end": "3725880"
  },
  {
    "text": "it also supports sequence numbering to prevent tunnel attacks as the one I'm",
    "start": "3725880",
    "end": "3731819"
  },
  {
    "text": "going to show you on the next slide um but these sequence numbers are so weak and so badly implemented",
    "start": "3731819",
    "end": "3739500"
  },
  {
    "text": "um you can just plain ignore them first of all they don't use any kind of",
    "start": "3739500",
    "end": "3745260"
  },
  {
    "text": "cool sequencing as TCP is supposed to do um but they start by one and count",
    "start": "3745260",
    "end": "3752099"
  },
  {
    "text": "upward but if you just send packets without the sequence numbers the other channel router will assume oh",
    "start": "3752099",
    "end": "3760140"
  },
  {
    "text": "this one hasn't sequence numbers configured so yeah so I don't use them so you can really ignore this feature",
    "start": "3760140",
    "end": "3768119"
  },
  {
    "text": "and even more interesting is the fact that GRE can carry Source routing",
    "start": "3768119",
    "end": "3773339"
  },
  {
    "text": "information so on top of getting your packets into the tunnel you can actually tell him how",
    "start": "3773339",
    "end": "3779520"
  },
  {
    "text": "to route them after he decapsulated them Once Upon a Time",
    "start": "3779520",
    "end": "3785700"
  },
  {
    "text": "this is a very common situation at least in Europe um whoever is interested I can tell you the",
    "start": "3785700",
    "end": "3791940"
  },
  {
    "text": "companies and products that actually sell this here um the situation is we have a company on",
    "start": "3791940",
    "end": "3799079"
  },
  {
    "text": "the right side is the headquarter on the left side is one of their Branch",
    "start": "3799079",
    "end": "3805140"
  },
  {
    "text": "offices and they want to communicate to be really independent from these",
    "start": "3805140",
    "end": "3810740"
  },
  {
    "text": "registration Authority things they win for FC 1918 AP addresses",
    "start": "3810740",
    "end": "3818700"
  },
  {
    "text": "and configured the world network with a 10 thing here",
    "start": "3818700",
    "end": "3824880"
  },
  {
    "text": "so and now they want to save money they had lots of lease lines across Europe",
    "start": "3824880",
    "end": "3830460"
  },
  {
    "text": "and now they decide no this is not good so we asked our carrier for a solution",
    "start": "3830460",
    "end": "3835920"
  },
  {
    "text": "and of course the sales Droid of the carrier has a solution he calls it a VPN",
    "start": "3835920",
    "end": "3842880"
  },
  {
    "text": "um to Tunnel the traffic between their internet routers",
    "start": "3842880",
    "end": "3848040"
  },
  {
    "text": "they set up a network as Focus the default gateway in the branch office is this router",
    "start": "3848040",
    "end": "3854280"
  },
  {
    "text": "who in turn sends everything he gets on his interfaces into the tunnel so it",
    "start": "3854280",
    "end": "3860040"
  },
  {
    "text": "gets out here on the headquarter router the router on the headquarter just",
    "start": "3860040",
    "end": "3865380"
  },
  {
    "text": "tunnels all the traffic that's destinated to one of the branch offices because he's also responsible for",
    "start": "3865380",
    "end": "3870960"
  },
  {
    "text": "internet connectivity of the HQ now client 10 node 105.2 over here",
    "start": "3870960",
    "end": "3879299"
  },
  {
    "text": "can actually talk to the slice little server",
    "start": "3879299",
    "end": "3885119"
  },
  {
    "text": "so making the game more interesting to add security security is important",
    "start": "3885119",
    "end": "3890700"
  },
  {
    "text": "they figured so they configured security features the branch office router drops",
    "start": "3890700",
    "end": "3897960"
  },
  {
    "text": "everything that's not GRE and not coming from the HQ router okay",
    "start": "3897960",
    "end": "3904559"
  },
  {
    "text": "all outgoing traffic is forwarded into the tunnel nothing is gonna",
    "start": "3904559",
    "end": "3909839"
  },
  {
    "text": "leave the outside man interface of the branch office router that's not GRE",
    "start": "3909839",
    "end": "3915540"
  },
  {
    "text": "the HQ router blocks all incoming connections on the van interface",
    "start": "3915540",
    "end": "3923220"
  },
  {
    "text": "except for GE so they're pretty secure",
    "start": "3923220",
    "end": "3928740"
  },
  {
    "text": "well this is the situation and we have our",
    "start": "3928740",
    "end": "3934079"
  },
  {
    "text": "poor attacker he has his own Network and yeah after inspecting the situation",
    "start": "3934079",
    "end": "3943140"
  },
  {
    "text": "it looks like he has no chance to attack one of these computers because",
    "start": "3943140",
    "end": "3950040"
  },
  {
    "text": "not routable IP addresses there's no way to get in there he can't",
    "start": "3950040",
    "end": "3956460"
  },
  {
    "text": "even address the package because it would be dropped at the first ISP here like",
    "start": "3956460",
    "end": "3961619"
  },
  {
    "text": "who do you think you are that you address 10 networks in the internet so is he lost no he's not",
    "start": "3961619",
    "end": "3969780"
  },
  {
    "text": "he sets up another router we call this an attack router because",
    "start": "3969780",
    "end": "3975359"
  },
  {
    "text": "the purpose is actually to do either routing um",
    "start": "3975359",
    "end": "3980700"
  },
  {
    "text": "in this case this is some experimental software we wrote it should be on your",
    "start": "3980700",
    "end": "3985799"
  },
  {
    "text": "CD but you can actually do this with a well misconfigured Cisco as well",
    "start": "3985799",
    "end": "3993920"
  },
  {
    "text": "so then he actually makes this attack router the default gateway",
    "start": "3994079",
    "end": "4000380"
  },
  {
    "text": "for his traffic and he generates traffic that's directed to 10 note 105.2 his",
    "start": "4000380",
    "end": "4007819"
  },
  {
    "text": "Target system over here so this is the packet very simplistic IP frame",
    "start": "4007819",
    "end": "4015740"
  },
  {
    "text": "um this router here encapsulates the packet",
    "start": "4015740",
    "end": "4020839"
  },
  {
    "text": "and thus IPS spoofing of course using hq's Source address",
    "start": "4020839",
    "end": "4028940"
  },
  {
    "text": "Branch offices destination address GRE header and then the original packet",
    "start": "4028940",
    "end": "4036619"
  },
  {
    "text": "sent over here so the access lists are passed because all the requirements are",
    "start": "4036619",
    "end": "4042680"
  },
  {
    "text": "fulfilled the router will decapsulate it here",
    "start": "4042680",
    "end": "4048920"
  },
  {
    "text": "um yeah and according to his routing table since that 10 or 105.2 is reachable over",
    "start": "4048920",
    "end": "4055940"
  },
  {
    "text": "the ethernet interface and for what it to this post which means actually that attacker",
    "start": "4055940",
    "end": "4063559"
  },
  {
    "text": "reached the host now we say the back path depends on the scenario in this scenario attacker is",
    "start": "4063559",
    "end": "4070640"
  },
  {
    "text": "really lucky because this house hosts answers default gateway",
    "start": "4070640",
    "end": "4076940"
  },
  {
    "text": "is this device default rule is put it into the tunnel so it goes into the tunnel it goes out here gets",
    "start": "4076940",
    "end": "4083180"
  },
  {
    "text": "decapsulated this router since he is responsible for internet connectivity knows how to reach",
    "start": "4083180",
    "end": "4089839"
  },
  {
    "text": "this IP address because he has uplinked IP address for the ISP sends it out and voila finally attacker",
    "start": "4089839",
    "end": "4099020"
  },
  {
    "text": "is talking to non-realtable IP address which was supposedly protected by a GRE",
    "start": "4099020",
    "end": "4104838"
  },
  {
    "text": "tunnel and axis list on Cisco routers over the Internet voila no more",
    "start": "4104839",
    "end": "4112100"
  },
  {
    "text": "protection the same procedure can be used to attack",
    "start": "4112100",
    "end": "4118238"
  },
  {
    "text": "IPv6 hosts connected over ipv4 internet",
    "start": "4118239",
    "end": "4124460"
  },
  {
    "text": "whoever experiments with V6 Islands knows that the connection is actually",
    "start": "4124460",
    "end": "4129620"
  },
  {
    "text": "done by GRE um open to the next best V6 bone",
    "start": "4129620",
    "end": "4137480"
  },
  {
    "text": "connectivity so if you have a six island you connect by GRE",
    "start": "4137480",
    "end": "4142940"
  },
  {
    "text": "of course the way to the V6 host is you generate the V6 packet encapsulated in V4 and",
    "start": "4142940",
    "end": "4150859"
  },
  {
    "text": "send it to The Host the way back obviously doesn't work that well because as soon as the V6 enter",
    "start": "4150859",
    "end": "4157880"
  },
  {
    "text": "packet comes in here he figures this is not going to work",
    "start": "4157880",
    "end": "4163480"
  },
  {
    "text": "so this is a quick summary of the tools you as far as I know have them on the CD",
    "start": "4164540",
    "end": "4171140"
  },
  {
    "text": "um check back for updates and yeah you can download all this stuff",
    "start": "4171140",
    "end": "4176719"
  },
  {
    "text": "from this URL you have it on the slides summary",
    "start": "4176719",
    "end": "4182660"
  },
  {
    "text": "summary come on be nice thank you",
    "start": "4182660",
    "end": "4187940"
  },
  {
    "text": "so we saw there are many ways to alter a traffic path this is not a complete list so here",
    "start": "4187940",
    "end": "4197380"
  },
  {
    "text": "fantasy goes on and on and on um everything it uses any kind of",
    "start": "4197380",
    "end": "4202760"
  },
  {
    "text": "addressing or gives any kind of information dynamically from host a to whatever host B can be misused",
    "start": "4202760",
    "end": "4210320"
  },
  {
    "text": "most routing Protocols are insufficient protected which makes the routing protocol attacks very successful",
    "start": "4210320",
    "end": "4217699"
  },
  {
    "text": "and unencrypted tunneling represent a high risk there is still in very",
    "start": "4217699",
    "end": "4224120"
  },
  {
    "text": "widespread use at least in Germany um and they demonstrate the fact that",
    "start": "4224120",
    "end": "4230960"
  },
  {
    "text": "so-called private IP addresses are not a tool for protection they're just the two",
    "start": "4230960",
    "end": "4236060"
  },
  {
    "text": "to be independent from registration that's it so",
    "start": "4236060",
    "end": "4241100"
  },
  {
    "text": "this is the final slide um thanks to these people thanks to Nico",
    "start": "4241100",
    "end": "4246560"
  },
  {
    "text": "and Sebastian for assistance and of course to you people here and not falling",
    "start": "4246560",
    "end": "4253760"
  },
  {
    "text": "asleep okay minus one um and listening to me here and being here",
    "start": "4253760",
    "end": "4260060"
  },
  {
    "text": "at blackhead and whoever wants to earn such a shirt I'm wearing it has some",
    "start": "4260060",
    "end": "4266060"
  },
  {
    "text": "code on the back and if you're interested in getting one and you have fun with like simple reverse engineering",
    "start": "4266060",
    "end": "4273440"
  },
  {
    "text": "over two or three beers go to www.lab.org and yeah figure out what the",
    "start": "4273440",
    "end": "4279800"
  },
  {
    "text": "code does and send us an email and you will get a shirt thank you",
    "start": "4279800",
    "end": "4285639"
  },
  {
    "text": "foreign",
    "start": "4286219",
    "end": "4289219"
  }
]