[
  {
    "text": "so this is me when I was a kid uh and uh when I was a kid I was I was kind of a",
    "start": "2440",
    "end": "7879"
  },
  {
    "text": "pain I was a bit of a handful um for a couple reasons one I tended to talk a lot like all the time",
    "start": "7879",
    "end": "14759"
  },
  {
    "text": "um and two and this one might resonate with some of the folks that are in this room I had a tendency to break things a",
    "start": "14759",
    "end": "21199"
  },
  {
    "text": "lot right like I wouldn't mean to I'd pick something up I'd go to fiddle with it and next thing I know insides would",
    "start": "21199",
    "end": "27640"
  },
  {
    "text": "just sort of fall out and you go was broken or I'd see something that said under no circumstances should you ever",
    "start": "27640",
    "end": "33399"
  },
  {
    "text": "do this with this thing and I'd say well why not right what could what could happen and I would",
    "start": "33399",
    "end": "39320"
  },
  {
    "text": "try uh and for a variety of other reasons I was challenging um and I had",
    "start": "39320",
    "end": "45280"
  },
  {
    "text": "an aunt who is it there we go uh I had an aunt who I was very close with",
    "start": "45280",
    "end": "51920"
  },
  {
    "text": "um whose name was an screwy this is what we called her uh the story behind that's",
    "start": "51920",
    "end": "57520"
  },
  {
    "text": "for another time I only have 40 minutes today you can find me in a bar we'll talk about it but her name was an scur you'll have to take my word for it",
    "start": "57520",
    "end": "64000"
  },
  {
    "text": "um uh she's she's where I got that shirt I don't know if you can see it from the back of the room can can anybody read",
    "start": "64000",
    "end": "71479"
  },
  {
    "text": "that yeah it says here comes trouble that's right and on the back it said There Goes",
    "start": "71479",
    "end": "77200"
  },
  {
    "text": "trouble she got me this shirt she also is where I got my talkativeness from she like to tell a good story um and I was",
    "start": "77200",
    "end": "83040"
  },
  {
    "text": "at her place when I was older was a teenager and I was stepping through that doorway that's behind her now and I I was going over the gate there's a dog",
    "start": "83040",
    "end": "89159"
  },
  {
    "text": "gate there and I I went to step over I like saw my cousin if I remember right uh I said oh hey how are you doing it's",
    "start": "89159",
    "end": "95520"
  },
  {
    "text": "good talking to you I caught my foot gate went down I fell on the table I broke something tore the molding clear",
    "start": "95520",
    "end": "102000"
  },
  {
    "text": "off the wall this is in the middle of a party a big family gathering uh and my aunt said Jesus she",
    "start": "102000",
    "end": "107880"
  },
  {
    "text": "said I can't trust you to go 5 feet without breaking something she's like I swear to God if you can ever figure out",
    "start": "107880",
    "end": "113680"
  },
  {
    "text": "how to make a career out of talking too much and breaking you're going to do great and here we are",
    "start": "113680",
    "end": "120880"
  },
  {
    "text": "some 40 years later um so speaking of breaking things",
    "start": "120880",
    "end": "126920"
  },
  {
    "text": "things we fiddle around with uh we're going to talk today through uh what's really kind of an",
    "start": "126920",
    "end": "133840"
  },
  {
    "text": "example in a case study I'm going to talk a lot about this issue with Google I will say right up front the vast",
    "start": "133840",
    "end": "139000"
  },
  {
    "text": "majority of the things I'm going to talk about have been fixed don't work anymore which is cool I'm very glad to hear it",
    "start": "139000",
    "end": "145360"
  },
  {
    "text": "um so we're going to talk through this but more as a case study like this is a",
    "start": "145360",
    "end": "150959"
  },
  {
    "text": "little less really in my opinion about the specifics of this issue although they are fun and a little weird at times",
    "start": "150959",
    "end": "156239"
  },
  {
    "text": "um but more about the kind of lessons we can draw out from this um and one of the big big ones being around trust and",
    "start": "156239",
    "end": "164280"
  },
  {
    "text": "understanding what you trust how many people know what this is one of these dialogue boxes is yell it out go ahead it's",
    "start": "164280",
    "end": "171239"
  },
  {
    "text": "fine so off right it's right in the name of this presentation fantastic yeah this",
    "start": "171239",
    "end": "176400"
  },
  {
    "text": "is an no off consent dialog box right these are all of the Internet it's the sort of under underpinning of lots and lots of different things the modern era",
    "start": "176400",
    "end": "183640"
  },
  {
    "text": "if you want to give anything access to some resources you've got somewhere um chances are you're using a off to do it",
    "start": "183640",
    "end": "189519"
  },
  {
    "text": "it's better than giving out your username and password which incidentally is what we used to do right like used to be that if you wanted to give access to",
    "start": "189519",
    "end": "195599"
  },
  {
    "text": "an application you give it your username and password and could do everything you could do this is way better than that um but there's a lot of kind of",
    "start": "195599",
    "end": "204000"
  },
  {
    "text": "implied trust um I ask one more question how many people if I if I use the phrase and ask you to fill in the blank ooth is",
    "start": "204000",
    "end": "210319"
  },
  {
    "text": "a blank framework you would know what the answer is anybody go",
    "start": "210319",
    "end": "216040"
  },
  {
    "text": "ahead it's supposed to be authorization supposed to be an authorization framework right we're going to ignore like oidc the other things that have",
    "start": "216040",
    "end": "222200"
  },
  {
    "text": "been built on top at core it's an authorization framework right it's a way to Grant access post authentication it",
    "start": "222200",
    "end": "228439"
  },
  {
    "text": "assumes authentication of the user and it's a way for the user to Grant access afterwards this is mostly true but",
    "start": "228439",
    "end": "234079"
  },
  {
    "text": "there's a little bit inside right which is that bit up there where it says the application name applications",
    "start": "234079",
    "end": "240280"
  },
  {
    "text": "the things that you're granting access to do actually have to authenticate during this process it's not really something we talk about very much but",
    "start": "240280",
    "end": "245760"
  },
  {
    "text": "it's true and there's a lot of implied trust in here and that's really the big kind of takeway if you're if you're out",
    "start": "245760",
    "end": "251840"
  },
  {
    "text": "of the anybody management people suits I was a suit for like five years um now",
    "start": "251840",
    "end": "257799"
  },
  {
    "text": "this is mostly As dressed as I have to get but uh for the big high LEL takeaway",
    "start": "257799",
    "end": "263919"
  },
  {
    "text": "um this is really about understanding where you trust with your providers with protocols how things interact with each",
    "start": "263919",
    "end": "269840"
  },
  {
    "text": "other um I'm I'm very fortunate to work at a place I'm really excited to be able to talk about the things we're talking",
    "start": "269840",
    "end": "275960"
  },
  {
    "text": "about I work at a place that values data we're a data driven company work at two Sigma it's a we call a financial",
    "start": "275960",
    "end": "282000"
  },
  {
    "text": "Sciences company right we we talk about we derive value from the words world's data we take a scientific approach to",
    "start": "282000",
    "end": "287440"
  },
  {
    "text": "investment and that all floods down through everything we do engineering security everything so in security that",
    "start": "287440",
    "end": "294759"
  },
  {
    "text": "translates into treating controls like hypothesis not like a given not like an axiom like a hypothesis to be tested a",
    "start": "294759",
    "end": "301840"
  },
  {
    "text": "vendor says they do a thing or this thing works to block this we believe the right thing to do is to go kick the",
    "start": "301840",
    "end": "308000"
  },
  {
    "text": "tires make sure that's actually true it mudes the waters a little bit admittedly of the kind of classic Shar security model particularly when you're talking",
    "start": "308000",
    "end": "313600"
  },
  {
    "text": "about a SAS provider but it is pretty important particularly large modern providers where they have foot in",
    "start": "313600",
    "end": "321120"
  },
  {
    "text": "infrastructure platform of service s right and all those things kind of have to fit together when those things fit",
    "start": "321120",
    "end": "326639"
  },
  {
    "text": "together things tend to get interesting it's important that you understand where those trusts are and maybe as you learn",
    "start": "326639",
    "end": "333000"
  },
  {
    "text": "from the end of this maybe the thing you should trust is probably not native oo",
    "start": "333000",
    "end": "338080"
  },
  {
    "text": "applications and we'll talk a little bit about what Native applications are in a second but we're going to start with the demo we're going to do it backwards",
    "start": "338080",
    "end": "344280"
  },
  {
    "text": "usually demos go at the end right and do it backwards largely because this is how I",
    "start": "344280",
    "end": "350039"
  },
  {
    "text": "got there um The Accidental part of this is I actually wasn't looking for security issues when I found this I was",
    "start": "350039",
    "end": "355440"
  },
  {
    "text": "messing around with uh their hosted jupyter notebook service and I noticed some weird interactions when it wanted",
    "start": "355440",
    "end": "361080"
  },
  {
    "text": "to interact with drive it didn't say it was collaboratory it said it was something else I thought that was a little weird I didn't know anything",
    "start": "361080",
    "end": "366919"
  },
  {
    "text": "about off at the time so I had to kind of figure it out but that meant I started at more or less a fully functioning exploit this application",
    "start": "366919",
    "end": "372919"
  },
  {
    "text": "doing something that I didn't think it should and I had to work backwards to figure out what it was so that's where you're all going to start out I learned",
    "start": "372919",
    "end": "379680"
  },
  {
    "text": "a lot of things when I was doing this one of the things I learned I'm not a professional security researcher if this",
    "start": "379680",
    "end": "385080"
  },
  {
    "text": "wasn't obvious I haven't been in security for a long time I've done pen testing incident respon forensics lots",
    "start": "385080",
    "end": "390479"
  },
  {
    "text": "of things but not a researcher um if I were I probably would",
    "start": "390479",
    "end": "396000"
  },
  {
    "text": "have realized early on that if you're working with a cloud provider and you're giving them recommendations and you're asking them to fix things and they're going to do it that's great but they are",
    "start": "396000",
    "end": "402720"
  },
  {
    "text": "definitely going to break your demo yeah because they're fixing the problems which is awesome um so I didn't",
    "start": "402720",
    "end": "408680"
  },
  {
    "text": "have video at the time I did thankfully think to grab screenshots so we're going to walk through kind of the claymation version of how this stuff worked again",
    "start": "408680",
    "end": "415919"
  },
  {
    "text": "most of it doesn't work anymore which is cool um so this is a bootstrap site that",
    "start": "415919",
    "end": "422080"
  },
  {
    "text": "I set up uh to demonstrate how it's possible to allow uh an application",
    "start": "422080",
    "end": "427560"
  },
  {
    "text": "either another site to impersonate one of these Google applications that we talked about it's pretty straightforward",
    "start": "427560",
    "end": "433280"
  },
  {
    "text": "uh the code is dead simple so you start by clicking on that uh button down there",
    "start": "433280",
    "end": "438400"
  },
  {
    "text": "on the green side that says the untrusted app this is kind of our control group for our little experiment right and it brings up the untrusted",
    "start": "438400",
    "end": "445080"
  },
  {
    "text": "application yoare that's the application that I registered when you click and ask it to authoriz the yoare test",
    "start": "445080",
    "end": "450360"
  },
  {
    "text": "application you get an error message access blocked yoare has not gone through the validation process uh",
    "start": "450360",
    "end": "457479"
  },
  {
    "text": "Google has a pretty uh strict process for approving applications that want to get access to drive and email and",
    "start": "457479",
    "end": "463919"
  },
  {
    "text": "whatnot which is a good thing and uh I have not put my uware application",
    "start": "463919",
    "end": "469199"
  },
  {
    "text": "through that process when I registered this application I got a little client identifier a secret to help identify it",
    "start": "469199",
    "end": "475599"
  },
  {
    "text": "uh when I use that doesn't work now if we go back to to my website and we click",
    "start": "475599",
    "end": "481360"
  },
  {
    "text": "on the red pill little red button right now I'm going to execute the same code but I'm doing it using secrets that I",
    "start": "481360",
    "end": "487520"
  },
  {
    "text": "pulled out of these trusted Google applications and now you go in you click",
    "start": "487520",
    "end": "492759"
  },
  {
    "text": "the authorize button there's a giant warning box of course that says hey I'm about to get access to your data as part",
    "start": "492759",
    "end": "497800"
  },
  {
    "text": "of this process but and when you do now I'm not yoare anymore now I'm",
    "start": "497800",
    "end": "504280"
  },
  {
    "text": "Chrome that was cool uh first thing I found was actually not Chrome it was a differentli Cloud SDK which you'll see",
    "start": "504280",
    "end": "510599"
  },
  {
    "text": "other screenshots later um we did briefly find Chrome now this one was fixed almost immediately right uh it",
    "start": "510599",
    "end": "517959"
  },
  {
    "text": "shouldn't have been possible but such as it was um and you go through and you consent this works all the way through",
    "start": "517959",
    "end": "524039"
  },
  {
    "text": "the process uh at the end because of the way I do this and I'll show you what this how this happens um most of the",
    "start": "524039",
    "end": "530279"
  },
  {
    "text": "time in oos flows if you've Ed them when you authorize something your browser just kind of spins in the background real quick a few URLs go by and you just",
    "start": "530279",
    "end": "536360"
  },
  {
    "text": "get access in this case because of the way we're doing it there's a manual step uh it's a manual step that other",
    "start": "536360",
    "end": "542120"
  },
  {
    "text": "applications do use collaboratory is one of them or did at the time where you have to kind of copy a paste the code",
    "start": "542120",
    "end": "547839"
  },
  {
    "text": "back and forth you do you authorize it here and then I think it was just a little box that said congratulations it",
    "start": "547839",
    "end": "553600"
  },
  {
    "text": "worked but if you go in on the back end my little server you can see at the top right this is my python anywhere that's",
    "start": "553600",
    "end": "559839"
  },
  {
    "text": "where I ran this thing uh little note at the top that says ding authentication was successful that's the uh object ID",
    "start": "559839",
    "end": "567200"
  },
  {
    "text": "rather than printing credentials and O tokens since those things live forever U I just dumped the object identifier and",
    "start": "567200",
    "end": "574240"
  },
  {
    "text": "after that it's the first of the files that I was listing out of the user you can see it says for demo and voila you",
    "start": "574240",
    "end": "580560"
  },
  {
    "text": "can make a website into Chrome that's the magic trick you can be excited about that part",
    "start": "580560",
    "end": "587040"
  },
  {
    "text": "I was excited about that part you have to clap it's okay just be be excited it's fun it's an interesting part of the",
    "start": "587040",
    "end": "592920"
  },
  {
    "text": "process um and credit to my boss who was the one who said you know look if you want this to really land you've got to",
    "start": "592920",
    "end": "599720"
  },
  {
    "text": "you got to put a real demo together and you should probably use your Chrome one because I was using Cloud SDK at the time all right so let's talk about what",
    "start": "599720",
    "end": "605920"
  },
  {
    "text": "just happened um how many people know what just happened actually show hands how many people understood what they",
    "start": "605920",
    "end": "611480"
  },
  {
    "text": "just saw very few of you that's good I don't feel so bad I didn't either um I very",
    "start": "611480",
    "end": "617120"
  },
  {
    "text": "much wanted to understand what was happening but I didn't really know anything at oath at the time I didn't know anything about uh Google's",
    "start": "617120",
    "end": "623240"
  },
  {
    "text": "workspace security around their apis thankfully I work at a place that",
    "start": "623240",
    "end": "628720"
  },
  {
    "text": "does lots of experts knocking about uh and I work for people who value the idea",
    "start": "628720",
    "end": "634240"
  },
  {
    "text": "of going to chase this sort of thing down so I went and found some of the experts and uh they pointed me at some",
    "start": "634240",
    "end": "639959"
  },
  {
    "text": "you know the rfc's at the uh documentation information it's a little tricky to really get your head all the way around o off um this was something",
    "start": "639959",
    "end": "646720"
  },
  {
    "text": "they cluded me on earlier because there are the rfc's the original rfc's there's some rfcs that have been added on there's a bunch of like common practice",
    "start": "646720",
    "end": "652920"
  },
  {
    "text": "that isn't really part of the rfc's and then every implementor kind of does things a little bit differently so if you want to understand how any one um",
    "start": "652920",
    "end": "662480"
  },
  {
    "text": "ooth service works you kind of have to really study that particular implementation um I was kind of hoping",
    "start": "662480",
    "end": "669120"
  },
  {
    "text": "it was going to be easier than that but such as life um so I knocked around a lot but I eventually found uh uh this",
    "start": "669120",
    "end": "677920"
  },
  {
    "text": "diagram uh which is actually from like a beginners uh guide to ooth and it's it's",
    "start": "677920",
    "end": "683880"
  },
  {
    "text": "my favorite I found a bunch of others later but I really like this one because it lays out all the players that are involved in an ooth conversation across",
    "start": "683880",
    "end": "689519"
  },
  {
    "text": "the top and the steps they have to go through top to bottom so it's it's a little easier to follow o uh as a",
    "start": "689519",
    "end": "696800"
  },
  {
    "text": "protocol is it it works very very well but it is a little complicated part of the way it's comp part of the reason it's complicated is it's a sort of",
    "start": "696800",
    "end": "702959"
  },
  {
    "text": "asynchronous process you have to as the user tell an application that you want to give it access and then you have to",
    "start": "702959",
    "end": "709279"
  },
  {
    "text": "go fetch this like temporary credential for this particular flow you have to give that to the application the",
    "start": "709279",
    "end": "714320"
  },
  {
    "text": "application has to do something and that's all it's being laid out here don't worry about squinting too much we're going to zoom in on it this is",
    "start": "714320",
    "end": "719360"
  },
  {
    "text": "just to give you a mental map so that we can zoom back out occasionally you'll be able to see what's what's going on um so",
    "start": "719360",
    "end": "726360"
  },
  {
    "text": "uh this by the way is a specific flow there are lots of different ways to um",
    "start": "726360",
    "end": "732440"
  },
  {
    "text": "use oaf they call them different flows different mechanisms depending on whether you're giving access to an",
    "start": "732440",
    "end": "738120"
  },
  {
    "text": "application or you want to register your phone with a site or whatever the case is use different kinds of flows um this is the authorization code flow and it's",
    "start": "738120",
    "end": "744160"
  },
  {
    "text": "a very simple version of it it's not even a version that's used anymore by Google but we're going to through the simple version all right so let's go",
    "start": "744160",
    "end": "752199"
  },
  {
    "text": "back to our venerable consent box right those are those four players across the top right um and these are all",
    "start": "752199",
    "end": "760440"
  },
  {
    "text": "represented in this consent dialogue right the user that's you you and your browser are considered to be one entity",
    "start": "760440",
    "end": "765680"
  },
  {
    "text": "you're married in the ooth conversation because every everything you want to do you do through your browser all the consent everything else right so that's",
    "start": "765680",
    "end": "773240"
  },
  {
    "text": "you reflected your identifier yeah that's a real identifier but I I made this domain up for this demo there's",
    "start": "773240",
    "end": "778360"
  },
  {
    "text": "nothing there don't worry about it it is in fact where yoare lives though um and you have a job",
    "start": "778360",
    "end": "785160"
  },
  {
    "text": "to do you have to decide whether you're going to accept or you know deny this request that's your part as a user we",
    "start": "785160",
    "end": "791079"
  },
  {
    "text": "have the client application that's identified front and center up top it's the big thing that we're focusing on here the ability to impersonate those",
    "start": "791079",
    "end": "797600"
  },
  {
    "text": "clients there's the authorization server that's the thing you're talking to to exchange get that initial ephemeral",
    "start": "797600",
    "end": "802880"
  },
  {
    "text": "credential and exchange it for a real token that lives for a long time um and finally the resource server that's the thing you want to get access to and",
    "start": "802880",
    "end": "809279"
  },
  {
    "text": "that's reflected down there in the middle you see those those permissions you're probably familiar with seeing something like those in this case we're",
    "start": "809279",
    "end": "815000"
  },
  {
    "text": "saying you get to see edit create delete all of your Google drive files Google Drive that's the resource server and the",
    "start": "815000",
    "end": "822000"
  },
  {
    "text": "other things those are called Scopes you're scoping down the permissions you want to Grant this application so it can't do everything you can do it can",
    "start": "822000",
    "end": "828160"
  },
  {
    "text": "only do the things that you allowed it to do here um to make this handoff work",
    "start": "828160",
    "end": "833720"
  },
  {
    "text": "there's kind of there a bunch of steps um there's one kind of big chunk to get started",
    "start": "833720",
    "end": "839320"
  },
  {
    "text": "uh and each of these steps or each of these chunks there are controls in place",
    "start": "839320",
    "end": "845040"
  },
  {
    "text": "um baked into the RFC it doesn't matter which implementation you're talking about for preventing against client",
    "start": "845040",
    "end": "850519"
  },
  {
    "text": "impersonation right and we'll identify those as we go um I've been talking a lot about web base versus CLI for the",
    "start": "850519",
    "end": "857839"
  },
  {
    "text": "purpose of this demonstration we're going to use a CLI application um because it pauses the process you don't",
    "start": "857839",
    "end": "864240"
  },
  {
    "text": "get all those URLs spinning past and I can break out for you all the parameters we use um so this is what happens you",
    "start": "864240",
    "end": "869839"
  },
  {
    "text": "fire up a client whether you're doing it on a web interaction or you're doing from a command line a native application",
    "start": "869839",
    "end": "876399"
  },
  {
    "text": "you fire it up and it's going to point you at an authorization server right how",
    "start": "876399",
    "end": "881680"
  },
  {
    "text": "does it know where to point you well it knows because I mentioned earlier registration applications that want to use an ooth resource have to register",
    "start": "881680",
    "end": "888560"
  },
  {
    "text": "with the ooth provider up front um and then that provider will give them a unique unique identifier which is spelled out there on the client ID and",
    "start": "888560",
    "end": "895120"
  },
  {
    "text": "some other information so that's the first step use the user the client application you're",
    "start": "895120",
    "end": "900560"
  },
  {
    "text": "talking to each other you say app I want to give you access the app says okay go over here and go get me one of these",
    "start": "900560",
    "end": "906440"
  },
  {
    "text": "aeral tokens so you do your browser does this right and when you do we hit our",
    "start": "906440",
    "end": "911839"
  },
  {
    "text": "first security control so this is the user now and their browser talking to the authorization server and you go to",
    "start": "911839",
    "end": "918160"
  },
  {
    "text": "this URL right this client ID and before the authorization server puts that dialogue box up it's supposed to do some",
    "start": "918160",
    "end": "924440"
  },
  {
    "text": "things it's supposed to check whether the response type the code is what it expects it's supposed to check whether",
    "start": "924440",
    "end": "930800"
  },
  {
    "text": "the Scopes or what it what the application registered in the first place so a malicious application can't suddenly ask for email when it was only",
    "start": "930800",
    "end": "936880"
  },
  {
    "text": "ever supposed to have access to your calendar right but for the purpose of this conversation the big thing it has",
    "start": "936880",
    "end": "942199"
  },
  {
    "text": "to verify is the redirect URI redirect uis are basically for web-based applications when you register your",
    "start": "942199",
    "end": "947399"
  },
  {
    "text": "application you say this is my domain this is where I'm going to run my SAS whatever web-based application so when a",
    "start": "947399",
    "end": "953319"
  },
  {
    "text": "user comes to get a credential don't ever send them anywhere except the except here",
    "start": "953319",
    "end": "959360"
  },
  {
    "text": "this is to prevent a malicious actor from creating one of these URLs and putting their own malicious domain in",
    "start": "959360",
    "end": "964480"
  },
  {
    "text": "with your client identifier right that's great works very well in a",
    "start": "964480",
    "end": "971199"
  },
  {
    "text": "webbased scenario but we have a problem right now we're not in a we scenario we're in a command line application or an installed",
    "start": "971199",
    "end": "977600"
  },
  {
    "text": "application something on your phone right so what do we do any",
    "start": "977600",
    "end": "983560"
  },
  {
    "text": "guesses where do you redirect people when they're on their local machine and they need to access a networked",
    "start": "983560",
    "end": "991360"
  },
  {
    "text": "resource any guesses come on how do computers refer to themselves somebody's",
    "start": "991560",
    "end": "997560"
  },
  {
    "text": "got to have the shirt no all right Loop X Local Host Loop act interface is a",
    "start": "997560",
    "end": "1003680"
  },
  {
    "text": "specialized network interface that runs on a machine and it's there basically for the machine to be able to talk to itself and refer to itself so this is",
    "start": "1003680",
    "end": "1010120"
  },
  {
    "text": "how you do redirect Uris or supposed to for Native applications there are some",
    "start": "1010120",
    "end": "1015639"
  },
  {
    "text": "problems with this as well and they're they're contemplated elsewhere but we're going to put those to the side for today because there is a bigger issue which is",
    "start": "1015639",
    "end": "1022519"
  },
  {
    "text": "that's not what we did and I noticed this this is not a local host redirect",
    "start": "1022519",
    "end": "1029240"
  },
  {
    "text": "this is some weird string I'd never seen before so I checked it out and it was a little",
    "start": "1029240",
    "end": "1036760"
  },
  {
    "text": "weird I will warn you you can't unsee this bit so what does that redirect you",
    "start": "1036760",
    "end": "1041880"
  },
  {
    "text": "your I decode to it decodes to this string Ur n iatf WG off 2.0 I'm just",
    "start": "1041880",
    "end": "1047640"
  },
  {
    "text": "going to read this I don't use read off my slides but I'm going to here because I can't do this any more Justice than it's spelled out this value indicates",
    "start": "1047640",
    "end": "1053600"
  },
  {
    "text": "that Google's authorization server should return the authorization code in the browser's title bar",
    "start": "1053600",
    "end": "1061240"
  },
  {
    "text": "Boop now I don't know how many of you ever been involved in developing a secure message passing or credential",
    "start": "1061240",
    "end": "1066919"
  },
  {
    "text": "storage system um I don't know if you ever thought you know where we should put that put in the browser title bar",
    "start": "1066919",
    "end": "1072799"
  },
  {
    "text": "right that being said and it's easy for me to make the joke right and in high Insight but this is actually solving a real problem",
    "start": "1072799",
    "end": "1079080"
  },
  {
    "text": "um it took me a little while to find it out uh because again since it said I ETF to G right the thing I assumed this",
    "start": "1079080",
    "end": "1085320"
  },
  {
    "text": "meant it was part of the spec but I couldn't find it anywhere um so I knocked around and I found eventually the post from one of the folks who",
    "start": "1085320",
    "end": "1090840"
  },
  {
    "text": "co-wrote uh if I remember correctly the oath for Native apps RFC um this is an",
    "start": "1090840",
    "end": "1096080"
  },
  {
    "text": "excerpt of the post you should go look at it yourself don't take my word for it remember trust know what you're trusting",
    "start": "1096080",
    "end": "1101919"
  },
  {
    "text": "don't trust me look it up um he talks about this it says no no no it's not part of the spec we're not going to add it this is a specific thing",
    "start": "1101919",
    "end": "1109000"
  },
  {
    "text": "and it's really not something people should use without understanding the security implications of doing so because what we just heard right is",
    "start": "1109000",
    "end": "1115679"
  },
  {
    "text": "that's a static string authorization servers are supposed to validate redirect uis you can't do that if every",
    "start": "1115679",
    "end": "1122919"
  },
  {
    "text": "client is using the same redirect U they always validate right so if you're using this you've knocked out one of the",
    "start": "1122919",
    "end": "1128120"
  },
  {
    "text": "controls against client impersonation y says I don't really want to put effort into expanding all the reasons it's not",
    "start": "1128120",
    "end": "1133159"
  },
  {
    "text": "secure yeah I I wish I could but I don't have time to do it either they'll have to accept it for now on faith but there",
    "start": "1133159",
    "end": "1138320"
  },
  {
    "text": "there was a real problem that were're trying to solve at the time as I understand it uh which had to do with like Windows machines uh local firewalls",
    "start": "1138320",
    "end": "1144559"
  },
  {
    "text": "blocking redirects to loopbacks and it happens to be Windows scripting apparently you can read title bars for",
    "start": "1144559",
    "end": "1150440"
  },
  {
    "text": "other windows that the users got open so uh it is a clever hack I have to say um",
    "start": "1150440",
    "end": "1155880"
  },
  {
    "text": "obviously it's got weird security implications but you could understand you know we're trying to solve a hard problem all right so we've gotten",
    "start": "1155880",
    "end": "1162840"
  },
  {
    "text": "through our first chunk and we've gotten through our first security control against client impersonation we beat the redirect URI",
    "start": "1162840",
    "end": "1168760"
  },
  {
    "text": "okay so now assuming uh that the authorization server validates",
    "start": "1168760",
    "end": "1174080"
  },
  {
    "text": "everything else it brings up one of these consent dialogues that we've seen before now you and the authorization server are still talking to each other",
    "start": "1174080",
    "end": "1180679"
  },
  {
    "text": "and you click okay and as we saw you get this instruction to copy the code back now the interesting thing about this",
    "start": "1180679",
    "end": "1186080"
  },
  {
    "text": "from like a fishing perspective for example is everything we've seen so far is all valid infrastructure right this",
    "start": "1186080",
    "end": "1192679"
  },
  {
    "text": "is a valid consent dialogue box it's not a malicious URL if you tell your users to look for one they're not going to",
    "start": "1192679",
    "end": "1198480"
  },
  {
    "text": "find it this is legit the redirect is legit everything about this is a legitimate valid URL I'm not doing",
    "start": "1198480",
    "end": "1205760"
  },
  {
    "text": "anything with infrastructure all I'm doing is tricking it into behaving like a different",
    "start": "1205760",
    "end": "1211200"
  },
  {
    "text": "application uh so all the traditional guidance you give people about fishing doesn't necessarily hold yeah there's the initial web server that's running",
    "start": "1211200",
    "end": "1217280"
  },
  {
    "text": "that's malicious but uh it doesn't have to be a web server you could run it on cloud infrastructure somewhere if you wanted to but the whole rest of it when",
    "start": "1217280",
    "end": "1224440"
  },
  {
    "text": "you click the accept you don't even put a password in right you might ask your user did you put your password in if they think they got fished no no I",
    "start": "1224440",
    "end": "1229760"
  },
  {
    "text": "didn't I just clicked the Box all right you're probably fine they're not fine I assure",
    "start": "1229760",
    "end": "1235080"
  },
  {
    "text": "you um so assuming you go back through there you get that code um the user has to copy it across it's an extra hop for",
    "start": "1235080",
    "end": "1241919"
  },
  {
    "text": "this particular attack there are other ways to do it that don't evolve I think but it's cleaner to to demonstrate this",
    "start": "1241919",
    "end": "1247559"
  },
  {
    "text": "way um so then the application has to get",
    "start": "1247559",
    "end": "1253280"
  },
  {
    "text": "involved the application has to exchange that credential for this long-term token it needs that's what happens down at the",
    "start": "1253280",
    "end": "1259600"
  },
  {
    "text": "bottom so now we have the client app and the authorization server you as the user you're out of the you're out of the mix",
    "start": "1259600",
    "end": "1265880"
  },
  {
    "text": "your browser is not involved anymore here now the application that you wanted to authorize be it a web- based",
    "start": "1265880",
    "end": "1272120"
  },
  {
    "text": "application that got the code via redirect or a local application that you copied and pasted or did a local host redirect it has to go visit the",
    "start": "1272120",
    "end": "1278880"
  },
  {
    "text": "authorization server and exchange that ephemeral temporary credential for a permanent token they call refresh tokens",
    "start": "1278880",
    "end": "1286039"
  },
  {
    "text": "and I also get an access token uh to temporary access to the resource and it's that thing that they use to access",
    "start": "1286039",
    "end": "1292159"
  },
  {
    "text": "drive or box or LinkedIn you know whatever your provider is right um and so this is where we hit the",
    "start": "1292159",
    "end": "1299200"
  },
  {
    "text": "last of our uh security controls or the second of our security controls excuse me so first we have the redirect URI and",
    "start": "1299200",
    "end": "1306799"
  },
  {
    "text": "now we have client secret validation so when the application goes to cash that ephemeral token in it the Emeral string",
    "start": "1306799",
    "end": "1313520"
  },
  {
    "text": "in it has something else the client secret that Secret's given to it by the authorization server way back in the",
    "start": "1313520",
    "end": "1319960"
  },
  {
    "text": "beginning when we talked about registration authorization server gives it a unique secret that's its password",
    "start": "1319960",
    "end": "1325120"
  },
  {
    "text": "basically to authenticate itself okay so it has that secret and it has to use that secret when it's talking",
    "start": "1325120",
    "end": "1331919"
  },
  {
    "text": "to the authorization server to refresh to exchange for its token again this works great in a webbased scenario at",
    "start": "1331919",
    "end": "1338799"
  },
  {
    "text": "this point can anybody spot what the problem is if you've got a locally install the",
    "start": "1338799",
    "end": "1343960"
  },
  {
    "text": "client any reverse Engineers come on all right you're being a quiet bunch",
    "start": "1343960",
    "end": "1349520"
  },
  {
    "text": "out uh the problem here with an installed application is that you're running it in your execution environment",
    "start": "1349520",
    "end": "1354760"
  },
  {
    "text": "it's not in a trusted SAS hosted ironed out thing you have access to the application you know everything the",
    "start": "1354760",
    "end": "1360720"
  },
  {
    "text": "application knows including the application secret you can't protect secrets from the user who's who's using",
    "start": "1360720",
    "end": "1367480"
  },
  {
    "text": "them right doesn't really work that way um and these are pretty easy to find so uh like I said we found Cloud SDK",
    "start": "1367480",
    "end": "1375600"
  },
  {
    "text": "originally um and then went knocking about I was hoping there was only one and I thought well I should probably keep looking look around and we found",
    "start": "1375600",
    "end": "1381960"
  },
  {
    "text": "others we found them in source code repositories we found them in a few other places um there's one actually in the big query book The Big query CLI in",
    "start": "1381960",
    "end": "1390400"
  },
  {
    "text": "the big query book by Jordan like the big query guy right lays this out but this is it was really interesting it",
    "start": "1390400",
    "end": "1396840"
  },
  {
    "text": "sort of I think sheds a bit of light on on how the story might have come out and it's where you start could see that well",
    "start": "1396840",
    "end": "1402880"
  },
  {
    "text": "this seems a little nuts like this is totally something that could happen in just about anywhere any company",
    "start": "1402880",
    "end": "1408520"
  },
  {
    "text": "right U so he publishes these things and he says look yeah they're Secrets but these aren't really secret right yes if",
    "start": "1408520",
    "end": "1415320"
  },
  {
    "text": "somebody uh gains access to these things they can impersonate your client but in this case these aren't special clients",
    "start": "1415320",
    "end": "1421120"
  },
  {
    "text": "we're not going to trust them they don't they get no special privileges I think he said in Mel this post somewhere they",
    "start": "1421120",
    "end": "1426919"
  },
  {
    "text": "only use them to like figure out what applications for marketing purposes or or research purposes are are people are",
    "start": "1426919",
    "end": "1432440"
  },
  {
    "text": "using in order to access big query so they're not going to trust them right and that's important that's a clear",
    "start": "1432440",
    "end": "1439159"
  },
  {
    "text": "understanding of what the security issues are yeah okay fine you do these things but you're not going to trust the app and that's called out in the RFC",
    "start": "1439159",
    "end": "1445520"
  },
  {
    "text": "itself so the RFC one of the rfc's contemplates this problem in the case that an",
    "start": "1445520",
    "end": "1451039"
  },
  {
    "text": "authorization server requires a secret for a native application an installed application it recommends you don't do",
    "start": "1451039",
    "end": "1456919"
  },
  {
    "text": "this by the way it says don't put a key there if you do someday somebody might think it's important and relevant and",
    "start": "1456919",
    "end": "1462080"
  },
  {
    "text": "it's not but if you insist on doing so just make sure that you continue to treat it as a public trusted client it",
    "start": "1462080",
    "end": "1469360"
  },
  {
    "text": "would be dangerous to indicate to end users the trustworthiness of the",
    "start": "1469360",
    "end": "1475480"
  },
  {
    "text": "client so this is fine right back to our early Point understanding what you trust this is fine as long as you don't ever",
    "start": "1475480",
    "end": "1483039"
  },
  {
    "text": "trust those native applications",
    "start": "1483039",
    "end": "1488360"
  },
  {
    "text": "ah but it's not fine if you do so let's talk about what the trust looks like for this particular case and",
    "start": "1488360",
    "end": "1495919"
  },
  {
    "text": "it extends pretty far so once you get past pass that process of validation so we talked earlier already about this",
    "start": "1495919",
    "end": "1501120"
  },
  {
    "text": "initial check screen right when I'm running code with my secret I get blocked when I'm running code with one of these Google Secrets I don't get",
    "start": "1501120",
    "end": "1508120"
  },
  {
    "text": "blocked I pass through the validation process and I can authorize right if uh a user wants to go check the",
    "start": "1508120",
    "end": "1517080"
  },
  {
    "text": "applications that have access to it once we've gone through that consent process that token that the application's using",
    "start": "1517080",
    "end": "1523799"
  },
  {
    "text": "that is the impersonated application for all intents and purposes it's the cloud SDK or Chrome or whatever",
    "start": "1523799",
    "end": "1531120"
  },
  {
    "text": "to the user it's Cloud SDK to the Enterprise administrator which you'll see in a minute it's the cloud SDK to",
    "start": "1531120",
    "end": "1538399"
  },
  {
    "text": "Google when they present this information they in the uh you know like",
    "start": "1538399",
    "end": "1543559"
  },
  {
    "text": "my security settings of your account right you can see what apps have access to your data which by the way is an awesome feature I like this um and they",
    "start": "1543559",
    "end": "1551039"
  },
  {
    "text": "divide the world into two buckets the dirty dirty third party applications that you might not trust and then the",
    "start": "1551039",
    "end": "1556120"
  },
  {
    "text": "applications on the other side which which just says are trusted apps by Google don't install uninstall these",
    "start": "1556120",
    "end": "1561320"
  },
  {
    "text": "unless you don't use them anymore right when I use the key in my malicious",
    "start": "1561320",
    "end": "1566399"
  },
  {
    "text": "application that's where I show up that's pretty much it for end users",
    "start": "1566399",
    "end": "1571919"
  },
  {
    "text": "um because they don't have access to logging or other things really uh there's a little bit of uh authorization",
    "start": "1571919",
    "end": "1578159"
  },
  {
    "text": "information now where it shows you kind of last authentication or authorization to your account right um these things",
    "start": "1578159",
    "end": "1583760"
  },
  {
    "text": "show up there now I think they used to be a little spottier but but they do now which is not nice but other than that",
    "start": "1583760",
    "end": "1589399"
  },
  {
    "text": "it's kind of it for end users right but there are",
    "start": "1589399",
    "end": "1595039"
  },
  {
    "text": "Enterprises um who might also be interested in being able to lock these things out um and there are controls",
    "start": "1595039",
    "end": "1600159"
  },
  {
    "text": "Google provides that are pretty rich for dealing with API access right there's the ability to block remember we had",
    "start": "1600159",
    "end": "1605960"
  },
  {
    "text": "those dirty dirty third partyy applications as an administrator in a domain you can say I don't want my users to use any of those applications I don't",
    "start": "1605960",
    "end": "1612159"
  },
  {
    "text": "trust any of them but that is an ACL based on y",
    "start": "1612159",
    "end": "1618360"
  },
  {
    "text": "identifier right um and notably for these particular applications it doesn't affect the set of apps uh because",
    "start": "1618360",
    "end": "1625440"
  },
  {
    "text": "they're not considered third party they're first- party applications um you can also choose to trust if you want to just your company's internal",
    "start": "1625440",
    "end": "1630919"
  },
  {
    "text": "applications but that doesn't matter much um there is a place or there was at the time a spot that like individual",
    "start": "1630919",
    "end": "1637799"
  },
  {
    "text": "first-party applications are listed out and you can choose to enable or disable those Drive is up here for example which is one of the early things that we ran",
    "start": "1637799",
    "end": "1644000"
  },
  {
    "text": "into um drive for desktop excuse me like the syncing application although I'll say when I",
    "start": "1644000",
    "end": "1650679"
  },
  {
    "text": "first found that when it confused the hack out of me because I thought the consent dialogue was saying Google Drive wants access to Google Drive and I kept",
    "start": "1650679",
    "end": "1657159"
  },
  {
    "text": "thinking why are you asking me it seems like something you should just be able to do uh but it turns out it was the client that we were talking about I had",
    "start": "1657159",
    "end": "1662640"
  },
  {
    "text": "misread it but in any case uh applications that we're talking about don't show up here there's no no place",
    "start": "1662640",
    "end": "1668559"
  },
  {
    "text": "to turn those off um but there is one more spot so very deep deep deep down in the console there's this like firewall",
    "start": "1668559",
    "end": "1676120"
  },
  {
    "text": "old school firewall is kind of interface where you can specify individual oo IDs if you know what they are or if you know",
    "start": "1676120",
    "end": "1681320"
  },
  {
    "text": "the name you can look it up as well right um so you can do like in that previous screen for example if you wanted to say I want to allow all",
    "start": "1681320",
    "end": "1688440"
  },
  {
    "text": "applications but there's a couple that I don't like or I want to deny all of them but there's a couple I want to allow you can do it",
    "start": "1688440",
    "end": "1693600"
  },
  {
    "text": "here great so you can put the application in you get the little identifier and you can specify whether",
    "start": "1693600",
    "end": "1698919"
  },
  {
    "text": "you want to allow or block that thing perfect click submit but that doesn't",
    "start": "1698919",
    "end": "1704840"
  },
  {
    "text": "work there's some kind of hardcoded thing U results property of these",
    "start": "1704840",
    "end": "1710200"
  },
  {
    "text": "applications you can't block them in this interface you just get to fail it says try again later but it just doesn't work um I don't think this is actually I",
    "start": "1710200",
    "end": "1717519"
  },
  {
    "text": "I have no idea if this was even intentional it could just be a side effect of however was implemented who knows but the end result of all these things is if you are an Enterprise",
    "start": "1717519",
    "end": "1724279"
  },
  {
    "text": "administrator you're relying on those off identifiers as part of your Access Control lists then regardless of what",
    "start": "1724279",
    "end": "1731039"
  },
  {
    "text": "you do you can turn all those things off you lock it down put everything up to 11 short of turning the little switch that",
    "start": "1731039",
    "end": "1736240"
  },
  {
    "text": "says disable drive all together when I use a secret I can get in with these applications or I could at",
    "start": "1736240",
    "end": "1742279"
  },
  {
    "text": "the time um uh I Als referen in the description",
    "start": "1742279",
    "end": "1748320"
  },
  {
    "text": "kind of anti forensics incident response so I I cut my teeth doing incident response and forensics work years ago um",
    "start": "1748320",
    "end": "1755279"
  },
  {
    "text": "long time ago actually at this point uh so this is actually just a re screenshot",
    "start": "1755279",
    "end": "1761799"
  },
  {
    "text": "of the thing that we saw earlier um the kind of console that you look at but it's probably something your IR team might rely on as well right user calls",
    "start": "1761799",
    "end": "1768840"
  },
  {
    "text": "and says hey I think I might have gotten fished or we might have an incident our team is going to say all right well go in here look for any specious",
    "start": "1768840",
    "end": "1774120"
  },
  {
    "text": "applications maybe they looked themselves but again the applications don't show up as anything suspicious and",
    "start": "1774120",
    "end": "1779159"
  },
  {
    "text": "it prates all the way down to the logs this is a log export uh came out of our system I think these are actually our",
    "start": "1779159",
    "end": "1785200"
  },
  {
    "text": "field names I don't know that these mapped to the original field names but um so everywhere that this is recorded",
    "start": "1785200",
    "end": "1791399"
  },
  {
    "text": "even in the logs it presents itself as one of these trusted valid first party",
    "start": "1791399",
    "end": "1796519"
  },
  {
    "text": "applications I can tell you you know I did IR for a long time I did monitoring for a long time if you've got",
    "start": "1796519",
    "end": "1802559"
  },
  {
    "text": "applications like this um that a lot of people might be using Chrome the cloud SDK that I keep referring to uh if",
    "start": "1802559",
    "end": "1808600"
  },
  {
    "text": "people know administer their um gcp infrastructure with the g-cloud command that that's this thing that's what this",
    "start": "1808600",
    "end": "1814399"
  },
  {
    "text": "is right so you're going to see this pinged all the time you're probably going to put an allow list in for your anomaly detection or some such or tune",
    "start": "1814399",
    "end": "1820519"
  },
  {
    "text": "it down a little right um so it can mess with your ability to detect to do investigations if you're not paying",
    "start": "1820519",
    "end": "1826200"
  },
  {
    "text": "attention you do still get IP address and other things here so there's there's some hope but it certainly provides a",
    "start": "1826200",
    "end": "1832080"
  },
  {
    "text": "mechanism for an attacker to cover their tracks a bit um and I think not covered",
    "start": "1832080",
    "end": "1837440"
  },
  {
    "text": "here I go into the potential uh threat actors but um because it's not specific",
    "start": "1837440",
    "end": "1843039"
  },
  {
    "text": "to this problem it's just a property of ooth and ooth kind of attack so not specific to Google at all is that those",
    "start": "1843039",
    "end": "1850039"
  },
  {
    "text": "ooth credentials again those things those tokens um they're authorization layer they're post authentication so",
    "start": "1850039",
    "end": "1856480"
  },
  {
    "text": "again password resets have no effect on OA tokens so if user thinks they got",
    "start": "1856480",
    "end": "1861960"
  },
  {
    "text": "fished they reset their password Tacker still has access right um they go to check validate in their list of",
    "start": "1861960",
    "end": "1868440"
  },
  {
    "text": "applications Tacker still has access um again not a Google thing",
    "start": "1868440",
    "end": "1873480"
  },
  {
    "text": "that's just so off way it is um so let's talk through some threat",
    "start": "1873480",
    "end": "1879399"
  },
  {
    "text": "actors threat scenarios obviously there's generic external threat agents um one thing to",
    "start": "1879399",
    "end": "1886240"
  },
  {
    "text": "note I've been talking about driv a lot that's cuz that's the thing that I found um I haven't looked at all at any",
    "start": "1886240",
    "end": "1891399"
  },
  {
    "text": "applications that do this for Gmail the the bar for apps that have access to emails even higher than drive",
    "start": "1891399",
    "end": "1898720"
  },
  {
    "text": "applications um the verification process I mentioned earlier is actually pretty onerous for both scenarios you have to",
    "start": "1898720",
    "end": "1904000"
  },
  {
    "text": "like send in a description of your app and you have to like record a YouTube video of how it's going to work and what",
    "start": "1904000",
    "end": "1909159"
  },
  {
    "text": "you're going to do with all the Scopes it's like it's a pretty big deal um so I I for all I know there aren't anything",
    "start": "1909159",
    "end": "1915399"
  },
  {
    "text": "that can get access to to Gmail this is is just driver we've been largely talking about but still interesting potentially for an external attacker",
    "start": "1915399",
    "end": "1921440"
  },
  {
    "text": "although if they can't re-email out maybe a little less mischievous users Insider threats",
    "start": "1921440",
    "end": "1927919"
  },
  {
    "text": "absolutely right if you know that there's an application running around if you're just a mischievous user who's annoyed because the security team won't",
    "start": "1927919",
    "end": "1933600"
  },
  {
    "text": "let you use your favorite application well you just throw in this secret if it lets you and I've seen documentation for",
    "start": "1933600",
    "end": "1939000"
  },
  {
    "text": "applications online that talk about doing this hey if you're having trouble getting our app working use this client ID in secret so I don't know how many",
    "start": "1939000",
    "end": "1946440"
  },
  {
    "text": "like databas connectors or whatever else are running around out there that use these identifiers but there are a bunch um and then beyond chievous users",
    "start": "1946440",
    "end": "1955120"
  },
  {
    "text": "real Insider threats if you're if you're trying to protect against people exfiltrating information from inside the",
    "start": "1955120",
    "end": "1960360"
  },
  {
    "text": "company and you're using these oo based Access Control lists again here or anywhere else lots of other providers",
    "start": "1960360",
    "end": "1966919"
  },
  {
    "text": "not just Google use oath identifiers to build applic to build ACLS and they do",
    "start": "1966919",
    "end": "1972200"
  },
  {
    "text": "not necessarily Express to people I haven't seen any in fact that do the difference between an ooth identifier",
    "start": "1972200",
    "end": "1978559"
  },
  {
    "text": "that belongs to a native application and one that belongs to a trusted hosted application it's just it's totally opaque so you don't know when you're",
    "start": "1978559",
    "end": "1984399"
  },
  {
    "text": "trusting what you're actually saying so Insider threats this is great right now I can get data out to that",
    "start": "1984399",
    "end": "1991799"
  },
  {
    "text": "extent pentesters there any red teamers in the room you got a client site yeah and they're a Google shop and they've",
    "start": "1991799",
    "end": "1997440"
  },
  {
    "text": "locked a bunch of things down and you need a staging ground or a way to push data out this is this will probably work",
    "start": "1997440",
    "end": "2003760"
  },
  {
    "text": "um if you're a better developer than me you might even be able to get the current version working I could in the short time but who knows",
    "start": "2003760",
    "end": "2010200"
  },
  {
    "text": "right uh but I don't worry about any of those folks quite as much as the last category I mean we worry about Insider",
    "start": "2010200",
    "end": "2016519"
  },
  {
    "text": "threat I worry about Insider threat it's a big part of our security model um but this last category made me a little",
    "start": "2016519",
    "end": "2022679"
  },
  {
    "text": "jumpy it's part of why we really pushed and part of why we talked to some folks quietly U Target attackers so like I",
    "start": "2022679",
    "end": "2029279"
  },
  {
    "text": "said I I did a lot of incident response in my time uh sometimes dealing with you know advanced persistent threats or",
    "start": "2029279",
    "end": "2035720"
  },
  {
    "text": "whatever other mism we want want to use um and there is a certain class of attacker where this specific combination",
    "start": "2035720",
    "end": "2042360"
  },
  {
    "text": "of capabilities the ability to pull off a pretty convincing fishing attack the ability to quietly monitor what a user",
    "start": "2042360",
    "end": "2048240"
  },
  {
    "text": "is doing without them knowing to show up as a trusted uh party cover Your Tracks",
    "start": "2048240",
    "end": "2053960"
  },
  {
    "text": "the ability to maintain access past the traditional mechanisms for Recovery in",
    "start": "2053960",
    "end": "2059919"
  },
  {
    "text": "the event of account compromise there are very specific people who do scary things that would",
    "start": "2059919",
    "end": "2065720"
  },
  {
    "text": "like that particular set of credential and would not mind the extra hop of having to get somebody to put code somewhere in um that being said I have",
    "start": "2065720",
    "end": "2073280"
  },
  {
    "text": "not seen any of these things in the wild um I've not heard of any of them in the",
    "start": "2073280",
    "end": "2078800"
  },
  {
    "text": "wild except what I mentioned earlier about like tricky websites or whatnot that are just trying to get their apps",
    "start": "2078800",
    "end": "2083878"
  },
  {
    "text": "running and don't feel like going through the registration process I've seen a bunch of those but um I haven't seen any actual Lous activity I used to",
    "start": "2083879",
    "end": "2089720"
  },
  {
    "text": "work at places big Global shops I spent a lot of time in higher ed and Healthcare uh big fast computers Global",
    "start": "2089720",
    "end": "2095960"
  },
  {
    "text": "Networks hundreds of thousands of machines and users right so I used to have a lot more visibility into what was",
    "start": "2095960",
    "end": "2102240"
  },
  {
    "text": "happening on the internet U now I just see what we see I haven't seen any of this stuff yet and a few people I've",
    "start": "2102240",
    "end": "2108880"
  },
  {
    "text": "I've talked to a few people here and there and I haven't haven't heard of anybody else mentioning",
    "start": "2108880",
    "end": "2114040"
  },
  {
    "text": "either all right so we're going to wrap up um they mentioned this at the beginning for folks who want to head out",
    "start": "2114040",
    "end": "2119839"
  },
  {
    "text": "now because I know lunch is starting soon you feel free don't let me stop you um but I'm not going to move to the WAP",
    "start": "2119839",
    "end": "2125480"
  },
  {
    "text": "room which is what they do in most talk I'll be doing Q&A here so if you want to ask me questions that you're welcome to",
    "start": "2125480",
    "end": "2131240"
  },
  {
    "text": "um stick around if you do if you ask me a question or you tell me something if either of us learns anything from our",
    "start": "2131240",
    "end": "2136280"
  },
  {
    "text": "interaction it's a core part of being at two Sigma we value learning and studying so if we learn something from our",
    "start": "2136280",
    "end": "2141599"
  },
  {
    "text": "interaction you can have one of these fancy fancy decks to Sigma playing cards while supp last I have 20 I can't",
    "start": "2141599",
    "end": "2148480"
  },
  {
    "text": "imagine I'll get 20 questions but if I do great and you don't have to ask him here find me in the bar or in the hallway or wherever else I'm happy to",
    "start": "2148480",
    "end": "2154319"
  },
  {
    "text": "give away playing cards don't have to bring them back in the plane uh all right so let's wrap",
    "start": "2154319",
    "end": "2160359"
  },
  {
    "text": "up so again I know I had a few you know had a few Jabs here there this is not",
    "start": "2160359",
    "end": "2165760"
  },
  {
    "text": "just Google very much not just Google right other providers did maybe still do I",
    "start": "2165760",
    "end": "2173240"
  },
  {
    "text": "don't know trust that out of band URI that abomination of a URI string that we talked about earlier right definitely",
    "start": "2173240",
    "end": "2180359"
  },
  {
    "text": "other people who do that lots of providers use ooth identifiers again for",
    "start": "2180359",
    "end": "2185760"
  },
  {
    "text": "the basis of Access Control control lists that is trust if you're putting something into an access control list",
    "start": "2185760",
    "end": "2191200"
  },
  {
    "text": "you are lending it trust and I again have not seen any instances where it's",
    "start": "2191200",
    "end": "2197079"
  },
  {
    "text": "made clear the people who are using those systems that the access control list can contain things that they shouldn't ever trust and things that",
    "start": "2197079",
    "end": "2203480"
  },
  {
    "text": "they should right this is not a Google problem it's a lot of people problem",
    "start": "2203480",
    "end": "2209000"
  },
  {
    "text": "it's you problem if you're a security professional you're an engineer you're designing these things you have to",
    "start": "2209000",
    "end": "2214200"
  },
  {
    "text": "understand how this stuff works not just oh specifically in this case because you know this will go away and there'll be",
    "start": "2214200",
    "end": "2219520"
  },
  {
    "text": "five things that look like it I'm sure next month um but anytime you get",
    "start": "2219520",
    "end": "2225079"
  },
  {
    "text": "assertions about controls Access Control lists this can stop this we have this to prevent that um you got to ask you got",
    "start": "2225079",
    "end": "2233160"
  },
  {
    "text": "to push you got to understand how it's implemented do some critical thinking ask some hard questions one of the",
    "start": "2233160",
    "end": "2239079"
  },
  {
    "text": "things I like to do when I'm trying to assess the stuff out as I phrase uh an attack I'm trying to pull off as a",
    "start": "2239079",
    "end": "2245359"
  },
  {
    "text": "feature for a vendor and I say hey I've got a user trying to do this can you make this happen and sometimes the sales",
    "start": "2245359",
    "end": "2251280"
  },
  {
    "text": "Engineers are good at tracking that stuff down for you if you need them to um but not just externally too with your",
    "start": "2251280",
    "end": "2256640"
  },
  {
    "text": "partners you need to do the stuff with your own folks you need to do the stuff you've got to track down you've got to understand what those controls are treat",
    "start": "2256640",
    "end": "2262960"
  },
  {
    "text": "every control every assertion that's made to you in documentation anywhere else in the console as a hypothesis that you have to test",
    "start": "2262960",
    "end": "2270720"
  },
  {
    "text": "always and I know I kept referencing the secrets people would be mad at me if I didn't put them up so here they are",
    "start": "2270720",
    "end": "2276839"
  },
  {
    "text": "again really this doesn't work anymore for the most part uh there are various mitigations to",
    "start": "2276839",
    "end": "2283400"
  },
  {
    "text": "these things um in some cases it was just pulling support actually I should say uh globally Google's pulled support",
    "start": "2283400",
    "end": "2289800"
  },
  {
    "text": "for the out of- band URI that that awful URI that we talked about earlier so none",
    "start": "2289800",
    "end": "2295119"
  },
  {
    "text": "of the applications support that anymore if you try and use any application with that URI it'll fail this is awesome very",
    "start": "2295119",
    "end": "2300920"
  },
  {
    "text": "good news um but really the core problem is the trust that just an attack path problem",
    "start": "2300920",
    "end": "2307720"
  },
  {
    "text": "is always that you trust the application I think all of these things even CL I think actually in the cloud SDK cuz I",
    "start": "2307720",
    "end": "2313040"
  },
  {
    "text": "was reviewing the materials in the last week or so and I think the cloud SDK actually even shows up in third party",
    "start": "2313040",
    "end": "2318640"
  },
  {
    "text": "apps now in the console so even that isn't quite as privileged as it used to be which is nice um again most of these",
    "start": "2318640",
    "end": "2325200"
  },
  {
    "text": "things don't work anymore but these are the client IDs and secrets and I have no idea if this is the full list probably",
    "start": "2325200",
    "end": "2331000"
  },
  {
    "text": "isn't I can't imagine that me doing what I do found everything right this list",
    "start": "2331000",
    "end": "2336560"
  },
  {
    "text": "exists it's trusted and you have to know that you have to understand that that's true when you're making your own",
    "start": "2336560",
    "end": "2342240"
  },
  {
    "text": "security decisions and your own implementations so that's it um I hope",
    "start": "2342240",
    "end": "2347920"
  },
  {
    "text": "you enjoyed it I did thank you all for being here with me if you want to know more please stay ask me questions find me in the hallway U this is my contact",
    "start": "2347920",
    "end": "2354119"
  },
  {
    "text": "information you're welcome to reach out uh happy to help however I can and uh yeah it's my first time doing one of",
    "start": "2354119",
    "end": "2360119"
  },
  {
    "text": "these at black hat so this is kind of exciting thank you all for being here",
    "start": "2360119",
    "end": "2365119"
  },
  {
    "text": "cheers",
    "start": "2365440",
    "end": "2368440"
  },
  {
    "text": "questions if you have one step up go to the mic",
    "start": "2370760",
    "end": "2375078"
  },
  {
    "text": "ask oh there's somebody at the front I don't think he's hot can you I can also speak up good so that makes the whole",
    "start": "2376800",
    "end": "2386359"
  },
  {
    "text": "ACL concept invalid basically for this o like you can never really trust the",
    "start": "2386359",
    "end": "2394240"
  },
  {
    "text": "secrets the whole process Google has for making sure that you're responsible with",
    "start": "2394240",
    "end": "2400200"
  },
  {
    "text": "Google drive if you accesses doesn't make sense then right um I I wouldn't go",
    "start": "2400200",
    "end": "2406599"
  },
  {
    "text": "quite that far with what it's worth uh I I did at some point I went through various phases in this process most of them fueled by bourbon um uh and I",
    "start": "2406599",
    "end": "2414720"
  },
  {
    "text": "wouldn't go quite that far one again I want to emphasize not just a Google problem not lots lots of providers trust",
    "start": "2414720",
    "end": "2422160"
  },
  {
    "text": "native applications when they shouldn't um but yes it severely weakens the meaning of those controls right what",
    "start": "2422160",
    "end": "2428720"
  },
  {
    "text": "it what it means is you're trusting anybody who has access to that particular set of secrets in the",
    "start": "2428720",
    "end": "2433800"
  },
  {
    "text": "scenario in which one of these attacks can be pulled off you know copying the credential across or whatever else right",
    "start": "2433800",
    "end": "2439119"
  },
  {
    "text": "so you you have to move away from the it is secure or it isn't secure and into the all right we got to think through",
    "start": "2439119",
    "end": "2444160"
  },
  {
    "text": "the specific threat scenarios that we're talking about and whether or not this Access Control given these conditions is going to be effective there and if it's",
    "start": "2444160",
    "end": "2450079"
  },
  {
    "text": "not how do we have to patch it ourselves with monitoring or whatever else right um but I hear you I I totally get it",
    "start": "2450079",
    "end": "2455560"
  },
  {
    "text": "like you look at it you're like I this is all useless now it isn't necessarily right like I've seen lots of people try",
    "start": "2455560",
    "end": "2461520"
  },
  {
    "text": "and do authorizations with malicious applications they they fail all the time right so it's working but yeah I hear",
    "start": "2461520",
    "end": "2468520"
  },
  {
    "text": "you good thank you thank you other questions yeah um does implementing",
    "start": "2468520",
    "end": "2474920"
  },
  {
    "text": "pixie do anything to stop this Ah that's great somebody asked about Pixie so I didn't have time to put it in the show",
    "start": "2474920",
    "end": "2481079"
  },
  {
    "text": "uh but now I get to talk about it this is great so there actually a lot of references pixie is like the the new thing it's literally like pixie dust uh",
    "start": "2481079",
    "end": "2487200"
  },
  {
    "text": "for OA people you sprinkle it on Old flows and it makes them better um uh and",
    "start": "2487200",
    "end": "2492640"
  },
  {
    "text": "it's it's it actually is really good so what pixie does um and you can find documentation online the article talks",
    "start": "2492640",
    "end": "2498839"
  },
  {
    "text": "about the the way you deal with exposed secrets in clients and this problem um",
    "start": "2498839",
    "end": "2504640"
  },
  {
    "text": "is to use pixie uh it's only sort of true it's",
    "start": "2504640",
    "end": "2509800"
  },
  {
    "text": "true in scenario of mobile application so the way pixie works is it removes the static secret out of a client",
    "start": "2509800",
    "end": "2515079"
  },
  {
    "text": "application and it replaces it with do do you know the answer what does it replace it",
    "start": "2515079",
    "end": "2520160"
  },
  {
    "text": "with yeah it it it replaces it with literally anything you",
    "start": "2520160",
    "end": "2527240"
  },
  {
    "text": "want that value is made up by the application at the time of the specific interaction that's what pixie does so",
    "start": "2527240",
    "end": "2533079"
  },
  {
    "text": "you take a string right you hash it you base 64 encode it and you pass it along",
    "start": "2533079",
    "end": "2538680"
  },
  {
    "text": "with your request and then when you as the client go to exchange your token after you feed the raw value right this",
    "start": "2538680",
    "end": "2544960"
  },
  {
    "text": "sort of challenge response thing we do the all the time lots of places you feed the raw value to Google and it can validate that the raw value that you",
    "start": "2544960",
    "end": "2551720"
  },
  {
    "text": "gave it matches secret of front but again that doesn't protect against this particular problem because now you can",
    "start": "2551720",
    "end": "2557359"
  },
  {
    "text": "literally just use any secret you want not the valid client secret right um the scenario protects against for what it's",
    "start": "2557359",
    "end": "2563480"
  },
  {
    "text": "worth and we're going to swim out of my depth real quick but as I understand it is like places like mobile applications where you might be able to hook like",
    "start": "2563480",
    "end": "2570000"
  },
  {
    "text": "half of a conversation and so what you want to do is validate that the application that initiated the conversation is the same one that's",
    "start": "2570000",
    "end": "2576319"
  },
  {
    "text": "involved in the second half so that somebody didn't get to man in the middle of that um and for that threat scenario pixie is perfect and probably a bunch of",
    "start": "2576319",
    "end": "2583079"
  },
  {
    "text": "others that I don't know about because I don't understand the uh don't understand all of it but um yeah that's what it",
    "start": "2583079",
    "end": "2590160"
  },
  {
    "text": "does pixie replaces as I understand it the client secret with a value or it",
    "start": "2590160",
    "end": "2595319"
  },
  {
    "text": "doesn't necessarily replace it it says this in the documentation it says you can add this on you can still use a client secret but yeah so no",
    "start": "2595319",
    "end": "2603400"
  },
  {
    "text": "unfortunately not for this scenario",
    "start": "2603400",
    "end": "2608078"
  },
  {
    "text": "yeah oh sorry you were standing I listening to the answer that's fine other questions yeah I got one I don't",
    "start": "2608640",
    "end": "2614520"
  },
  {
    "text": "think this mic's on",
    "start": "2614520",
    "end": "2617400"
  },
  {
    "text": "though so you know lot of talking about we have other things like and all sorts",
    "start": "2619839",
    "end": "2626359"
  },
  {
    "text": "of other kind of auth authorization Frameworks almost this",
    "start": "2626359",
    "end": "2633599"
  },
  {
    "text": "at uh I think so I'll repeat in case anybody in the back here so the question was there's there's lots of other",
    "start": "2635079",
    "end": "2641040"
  },
  {
    "text": "authorization Frameworks and this feels like the kind of problem that might crop up in other places yeah probably I'm not",
    "start": "2641040",
    "end": "2647000"
  },
  {
    "text": "really be honest with I'm not an AM guy I never was I only learned it to figure out what the hell was going on here um",
    "start": "2647000",
    "end": "2653640"
  },
  {
    "text": "but yeah I agree if you have an instinct on it again this this whole thing started I used to have the slide on it",
    "start": "2653640",
    "end": "2659359"
  },
  {
    "text": "but I took it out because I clicked a button in in collab and when it asked for access to drive it said the first",
    "start": "2659359",
    "end": "2666119"
  },
  {
    "text": "time Google Drive wants access to Google Drive and that it said the cloud SDK wants access I was like I don't know what's happening here but I'm pretty",
    "start": "2666119",
    "end": "2671520"
  },
  {
    "text": "confident that an application is not supposed to say it's something else when it's trying to get access to my stuff that's all I do right and then I had to",
    "start": "2671520",
    "end": "2678119"
  },
  {
    "text": "kind of go off from there so if you spot something like this yeah go out check it out bang against it let me know I'd be super curious to hear what you",
    "start": "2678119",
    "end": "2685280"
  },
  {
    "text": "find yeah yeah um you said that Google isn't using these trusting these client",
    "start": "2685280",
    "end": "2692319"
  },
  {
    "text": "secrets for authorization anymore but are they still trusting it for their metrics and could you mess with their",
    "start": "2692319",
    "end": "2698119"
  },
  {
    "text": "metrics using these darn if I know don't work there probably at this point never",
    "start": "2698119",
    "end": "2703520"
  },
  {
    "text": "will expect they're gonna get any offers anytime soon um uh I have no idea but honestly that",
    "start": "2703520",
    "end": "2709800"
  },
  {
    "text": "kind of doesn't matter yeah maybe you could screw around with usage metrics but you know as the said in the book",
    "start": "2709800",
    "end": "2715200"
  },
  {
    "text": "earlier on you know I imagine it's not something they'd be super concerned about but it's a fair point yeah you",
    "start": "2715200",
    "end": "2721920"
  },
  {
    "text": "probably could and I don't um and uh I shouldn't just miss it out of hand I",
    "start": "2721920",
    "end": "2727440"
  },
  {
    "text": "really there could be lots of other if we generalize that question to are there other Downstream situations in which",
    "start": "2727440",
    "end": "2732880"
  },
  {
    "text": "this could be problematic I assume the answer is yes these are the ones that I can see I have no idea what things look",
    "start": "2732880",
    "end": "2739160"
  },
  {
    "text": "like in the back end right I generally have no specialized knowledge of how this is implemented or what Google does",
    "start": "2739160",
    "end": "2744280"
  },
  {
    "text": "or doesn't do um I do know that as a user they've got lots of uh like",
    "start": "2744280",
    "end": "2749480"
  },
  {
    "text": "detection capabilities and whatnot for like Target attackers when I was in this game I used to like my account used to",
    "start": "2749480",
    "end": "2755359"
  },
  {
    "text": "go off every once once in a while and be like hey somebody's screwing with you all right good to know thank you um so",
    "start": "2755359",
    "end": "2762040"
  },
  {
    "text": "those folks might pick up this kind of thing even if the attacker is valid I I have no idea",
    "start": "2762040",
    "end": "2768200"
  },
  {
    "text": "right yeah you uh mentioned that they've invalidated these Local Host attributes",
    "start": "2769040",
    "end": "2776319"
  },
  {
    "text": "of the UR that they can't be used anymore you know how are does that mean",
    "start": "2776319",
    "end": "2781559"
  },
  {
    "text": "that like a a CLI command to log in wouldn't work anymore at all or they come up with a new solution for that",
    "start": "2781559",
    "end": "2788440"
  },
  {
    "text": "they've come up with Solutions in various places some of them might be here but they're probably hiding you can",
    "start": "2788440",
    "end": "2793559"
  },
  {
    "text": "ask one them um but uh yeah so the cloud SDK now so g-cloud still has to work",
    "start": "2793559",
    "end": "2798839"
  },
  {
    "text": "right we can't make g-cloud not work anymore let's be honest I think this vulnerability is cool I do not want",
    "start": "2798839",
    "end": "2804800"
  },
  {
    "text": "g-cloud to stop working across the planet like I can't imagine what would happen right so uh when you use gcloud",
    "start": "2804800",
    "end": "2810920"
  },
  {
    "text": "now and you pass it the Special flag that says Don't launch the browser do something else it'll operate a couple",
    "start": "2810920",
    "end": "2816319"
  },
  {
    "text": "modes one of which is it just tells you to go execute it on a different machine that has internet access and then it does the browser based o off but there",
    "start": "2816319",
    "end": "2822240"
  },
  {
    "text": "is another version that still allows you to do a code copy across it just doesn't use that Ur it uses a sort of proxy",
    "start": "2822240",
    "end": "2827880"
  },
  {
    "text": "authentication and another online URI that URI is also static um so it also",
    "start": "2827880",
    "end": "2833680"
  },
  {
    "text": "kind of can't be validated but I haven't made this work yet um it uses pixie2 so you have to be able to throw one of",
    "start": "2833680",
    "end": "2840040"
  },
  {
    "text": "those values on um I haven't made it work in my demo yet uh so uh I should",
    "start": "2840040",
    "end": "2846160"
  },
  {
    "text": "note a lot of the stuff you have to do manually because most of the client libraries aren't designed to let you do",
    "start": "2846160",
    "end": "2851280"
  },
  {
    "text": "this kind of crap because you're never supposed to do it right so if you use any of the default libraries and you just like call the off Handler it it'll",
    "start": "2851280",
    "end": "2858640"
  },
  {
    "text": "fail because it doesn't expect you to do this so you have to like construct the uis manually basically to get it to do",
    "start": "2858640",
    "end": "2864440"
  },
  {
    "text": "something and again I I haven't made it work yet but uh I'm not a security researcher by trade I'm not a",
    "start": "2864440",
    "end": "2870400"
  },
  {
    "text": "particularly good software engineer so I'm sure somebody else could probably figure it out um but again that just does the the authorization so yeah maybe",
    "start": "2870400",
    "end": "2877599"
  },
  {
    "text": "the you could still get it to authorize but if it's listed as a third party application and it's no longer trusted in first party again the trust is the",
    "start": "2877599",
    "end": "2884680"
  },
  {
    "text": "problem um oh I'm not so worried about it then I can block it my admin domain I",
    "start": "2884680",
    "end": "2890359"
  },
  {
    "text": "can I can do all kinds of things other",
    "start": "2890359",
    "end": "2896839"
  },
  {
    "text": "questions all right well for the last 20 viewers so that hung out thanks for hanging in uh come find me wherever you",
    "start": "2897920",
    "end": "2903079"
  },
  {
    "text": "want cheers",
    "start": "2903079",
    "end": "2907640"
  }
]