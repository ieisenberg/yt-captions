[
  {
    "text": "good afternoon welcome to zero days and mitigations roadways to exploit in",
    "start": "0",
    "end": "6180"
  },
  {
    "text": "Secure connected BMW cars in South Seas Abe was zizang Tai Michael",
    "start": "6180",
    "end": "13559"
  },
  {
    "text": "gruffky Heinrich schwepper and venjai Zhang before we begin a few brief notes stop",
    "start": "13559",
    "end": "20340"
  },
  {
    "text": "by the business Hall located in Mandalay Bay Oceanside and Shoreline ballrooms on level two the black hat Arsenal is also",
    "start": "20340",
    "end": "28080"
  },
  {
    "text": "in the business Hall on level two lunch will be in Bayside a b from 1 to 2",
    "start": "28080",
    "end": "34140"
  },
  {
    "text": "30. and don't forget the merchandise store on level 2 and the session recordings from source of knowledge they",
    "start": "34140",
    "end": "40200"
  },
  {
    "text": "have a desk on every level and also thank you for putting your phone on vibrate and makes it easier for",
    "start": "40200",
    "end": "45660"
  },
  {
    "text": "the rest of us to ignore the ringing while we wait for your voicemail to pick it up our speakers",
    "start": "45660",
    "end": "52020"
  },
  {
    "text": "[Applause]",
    "start": "52020",
    "end": "58840"
  },
  {
    "text": "um okay um let's start today's topic and to this Topic's name is zero day and the",
    "start": "60359",
    "end": "66479"
  },
  {
    "text": "mitigations you're always to exploit and the secure connect to the BMW cars",
    "start": "66479",
    "end": "71760"
  },
  {
    "text": "I think today's topic will be a little bit special because we for uh we have",
    "start": "71760",
    "end": "76920"
  },
  {
    "text": "two group of person the first person is from King security lab we are focused on",
    "start": "76920",
    "end": "83159"
  },
  {
    "text": "how to find the weakness of the car and also another part from BMW proof and the",
    "start": "83159",
    "end": "89159"
  },
  {
    "text": "other experts to how to secure their car so two uh two kinds of things and we get",
    "start": "89159",
    "end": "96720"
  },
  {
    "text": "together to uh talk about how to secure a car first of all is uh what about us",
    "start": "96720",
    "end": "103920"
  },
  {
    "text": "um we are the researcher from the me and the children come from tencent King security lab and we are focused on the",
    "start": "103920",
    "end": "111600"
  },
  {
    "text": "research of connected car we have the two years of Tesla research and you must",
    "start": "111600",
    "end": "119579"
  },
  {
    "text": "know that and also this year will give the BMW research",
    "start": "119579",
    "end": "125479"
  },
  {
    "text": "uh first of all let's talk about some of the timeline we started the research at",
    "start": "125479",
    "end": "130879"
  },
  {
    "text": "2017. uh it's almost a tick as uh almost",
    "start": "130879",
    "end": "136020"
  },
  {
    "text": "a whole year to do the research because uh one of the difficult of uh to do the",
    "start": "136020",
    "end": "142500"
  },
  {
    "text": "research of BMW car is you had to reverse a lot of things you had to understand the complex architecture of",
    "start": "142500",
    "end": "149580"
  },
  {
    "text": "the car so um it spend the other almost a one year and then at last year we",
    "start": "149580",
    "end": "156000"
  },
  {
    "text": "report the problem to the R2 BMW group and we get help with each other we try",
    "start": "156000",
    "end": "162420"
  },
  {
    "text": "to talk about how to fix the problem and the details of everything and finally at",
    "start": "162420",
    "end": "168540"
  },
  {
    "text": "the August of last year finally we can let everything kind of be finished",
    "start": "168540",
    "end": "176280"
  },
  {
    "text": "that's the agenda before start the technical topic and I",
    "start": "176280",
    "end": "181980"
  },
  {
    "text": "want to ask a question that I really love to ask and how many guys have BMW",
    "start": "181980",
    "end": "187440"
  },
  {
    "text": "cars here what not too many not all of you right so it",
    "start": "187440",
    "end": "193980"
  },
  {
    "text": "seems BMW has a potential Market in USA right so um let's talk about the first of all",
    "start": "193980",
    "end": "200879"
  },
  {
    "text": "let's talk about the vehicle components and data exploration and I will give you a brief introduction of the how the",
    "start": "200879",
    "end": "208260"
  },
  {
    "text": "architecture of the BMW car first of all in the head unit uh head",
    "start": "208260",
    "end": "213540"
  },
  {
    "text": "unit is a very important part in our expansion exploiting because",
    "start": "213540",
    "end": "218819"
  },
  {
    "text": "um we we start the research of the car we just start from the head unit it's a",
    "start": "218819",
    "end": "225060"
  },
  {
    "text": "infotainment system and then we expand our research to the other components and",
    "start": "225060",
    "end": "230700"
  },
  {
    "text": "in BMW's cars they call it MBT had a unit and it's responsible for a lot of",
    "start": "230700",
    "end": "236939"
  },
  {
    "text": "media things and then at the TCB it's a we call it a",
    "start": "236939",
    "end": "243780"
  },
  {
    "text": "cheap box it's a telematic unit of the car and it can do it integrate an e-sim",
    "start": "243780",
    "end": "250439"
  },
  {
    "text": "in the in the TCB and it can go online at Supply the online services to the",
    "start": "250439",
    "end": "256380"
  },
  {
    "text": "both head unit and also the TCB itself and also um it has some telematics",
    "start": "256380",
    "end": "263040"
  },
  {
    "text": "function we will talk about later another important component is about the",
    "start": "263040",
    "end": "268440"
  },
  {
    "text": "Central Gateway uh the Central Gateway can uh almost responsible for such",
    "start": "268440",
    "end": "273720"
  },
  {
    "text": "things first of all about the OBD Diagnostic and then for the root to root",
    "start": "273720",
    "end": "280080"
  },
  {
    "text": "the cam message and the flag story messages uh to do the message transport",
    "start": "280080",
    "end": "285900"
  },
  {
    "text": "and also um it's off it gives there's a switch on",
    "start": "285900",
    "end": "291240"
  },
  {
    "text": "the well essential Gateway the OBD used ethernet and also the head unit to use",
    "start": "291240",
    "end": "297300"
  },
  {
    "text": "ethernet so you can diagnostic the head unit through the OBD side",
    "start": "297300",
    "end": "304160"
  },
  {
    "text": "then in our research we almost try to analyze this almost every uh attack",
    "start": "304440",
    "end": "312720"
  },
  {
    "text": "surfaces in the car for example the removes attack surfaces is uh is from",
    "start": "312720",
    "end": "319080"
  },
  {
    "text": "the tcbs through the back end there's cellular data we and also short message",
    "start": "319080",
    "end": "324539"
  },
  {
    "text": "we Analyze This attack surface and also in the nearby attack surfaces we have",
    "start": "324539",
    "end": "331380"
  },
  {
    "text": "the USB Bluetooth and also when you can uh one can touch the car you can we also",
    "start": "331380",
    "end": "338880"
  },
  {
    "text": "Analyze This the important attack surfaces OBD2",
    "start": "338880",
    "end": "344580"
  },
  {
    "text": "yeah let's talk about something um of the whole architecture of the car as you can see",
    "start": "344580",
    "end": "353520"
  },
  {
    "text": "um the head unit and the telematic Box TCB they are on the clay Cam4 it's um we",
    "start": "353520",
    "end": "359280"
  },
  {
    "text": "quite infotainment domain and you can use the OBD through the ethernet switch",
    "start": "359280",
    "end": "364560"
  },
  {
    "text": "to the header unit and also the French Gateway is responsible for the other",
    "start": "364560",
    "end": "370139"
  },
  {
    "text": "kinds of ECU for example like a body cam PD cache is this can and there's a lot",
    "start": "370139",
    "end": "375479"
  },
  {
    "text": "of issue on that so in this picture you can see if you can compromise the head",
    "start": "375479",
    "end": "380520"
  },
  {
    "text": "unit or the TCB it's not very uh at most of the time you cannot influence the",
    "start": "380520",
    "end": "387060"
  },
  {
    "text": "whole car because there are some domain isolation based on the canvas and also",
    "start": "387060",
    "end": "392280"
  },
  {
    "text": "the ethernet first of all it is about the local",
    "start": "392280",
    "end": "397440"
  },
  {
    "text": "exploration we can start to attack through the USB or the OBD and then we",
    "start": "397440",
    "end": "403440"
  },
  {
    "text": "can plant our back door to the head unit and the head unit can stand we let the",
    "start": "403440",
    "end": "409860"
  },
  {
    "text": "head unit to send cam messages and you can messages to the essential Gateway and finally the Central Gateway help us",
    "start": "409860",
    "end": "416759"
  },
  {
    "text": "use the helper to influence the other issues by the UDS messages",
    "start": "416759",
    "end": "422699"
  },
  {
    "text": "and there is about the remote exploration the remote exploring the the",
    "start": "422699",
    "end": "428340"
  },
  {
    "text": "last parts are the same like the local exploration but we now we can start to",
    "start": "428340",
    "end": "433919"
  },
  {
    "text": "attack this use the fake base station and we found some vulnerabilities to",
    "start": "433919",
    "end": "440520"
  },
  {
    "text": "plant our back door to the GCV and then we use the same thing to influence the other issues",
    "start": "440520",
    "end": "446639"
  },
  {
    "text": "and that is a talk about how to root the head unit and attention will give you the talk",
    "start": "446639",
    "end": "452900"
  },
  {
    "text": "okay uh in this part I will introduce local and remote ways to a lot of MBD",
    "start": "453780",
    "end": "459360"
  },
  {
    "text": "head unit by utilizing vulnerabilities we Fund in some vehicle services",
    "start": "459360",
    "end": "465620"
  },
  {
    "text": "um basically a meeting had a unit is comprised of two seasons the other layer system is actually Intel it's mainly",
    "start": "467220",
    "end": "474240"
  },
  {
    "text": "used to handle multimedia functions and provider",
    "start": "474240",
    "end": "479400"
  },
  {
    "text": "online so it's via telematical communication box which is also known as t-box and the low layer is actually a",
    "start": "479400",
    "end": "486900"
  },
  {
    "text": "simple system it's mainly responsible for canvas communication with the Central Gateway and between actual Intel",
    "start": "486900",
    "end": "493919"
  },
  {
    "text": "and the h3o has Intel systems they use mercury net for IPC communication",
    "start": "493919",
    "end": "499379"
  },
  {
    "text": "and the Avatar will always engineering the form of us but we identified the song vehicle services which are running",
    "start": "499379",
    "end": "506520"
  },
  {
    "text": "in the atrial Intel system and like diagnosis always navigation of data",
    "start": "506520",
    "end": "511740"
  },
  {
    "text": "service and the BMW connected to the drive service and this is always a resources can interact with the outside",
    "start": "511740",
    "end": "518880"
  },
  {
    "text": "via some common interfaces including a USB port OBD port and the 3G network",
    "start": "518880",
    "end": "526880"
  },
  {
    "text": "I will analyze the vulnerabilities in this Services Case by case and introduce",
    "start": "526880",
    "end": "532920"
  },
  {
    "text": "how to control HBO asymptal system to send the key messages onto the kicking bus",
    "start": "532920",
    "end": "539540"
  },
  {
    "text": "and when we started the two research on video he had a unit the first question is how to access the internal Network",
    "start": "541140",
    "end": "548339"
  },
  {
    "text": "because for MBT having unit the Wi-Fi interface is disabled but we find a USB",
    "start": "548339",
    "end": "554100"
  },
  {
    "text": "config file in the SQL Intel system uh let's uh let's config file can enable USB Ethernet interface and set up an",
    "start": "554100",
    "end": "562080"
  },
  {
    "text": "Ethernet Network in the system so if you're plugging a specific USB to",
    "start": "562080",
    "end": "567420"
  },
  {
    "text": "ethernet adapter like a d link USB dongle the actual Intel system will be",
    "start": "567420",
    "end": "573180"
  },
  {
    "text": "assigned a static IP address and then you can connect to the internal network",
    "start": "573180",
    "end": "578279"
  },
  {
    "text": "of the system and then we try to scan the TCP and ODB",
    "start": "578279",
    "end": "583980"
  },
  {
    "text": "ports and the scanning result is used to let the actual Intel system has no firewall filtering rules applied on the",
    "start": "583980",
    "end": "590820"
  },
  {
    "text": "USB Ethernet interface and leading to many internal services are exposed and",
    "start": "590820",
    "end": "596820"
  },
  {
    "text": "this expose the services on new attack entries to the system for for instance a diagnosis always is",
    "start": "596820",
    "end": "603959"
  },
  {
    "text": "running on TCP Port 6801 and the actual list diagnosis is always",
    "start": "603959",
    "end": "611100"
  },
  {
    "text": "running electrical Intel system is used to diagnose and then reconfigure a",
    "start": "611100",
    "end": "616380"
  },
  {
    "text": "meteor heavy unit unless uh dedicated the BMW diagnostic",
    "start": "616380",
    "end": "621779"
  },
  {
    "text": "tool for the communication with this service which is called the tool set and",
    "start": "621779",
    "end": "627060"
  },
  {
    "text": "the service internally implements a customer ODS protocol the community the",
    "start": "627060",
    "end": "633000"
  },
  {
    "text": "communication data between the service and the diagnostic tool is also based on",
    "start": "633000",
    "end": "638040"
  },
  {
    "text": "a customized protocol packet and with regard to the protocol packet",
    "start": "638040",
    "end": "644700"
  },
  {
    "text": "it's comprised packet header and the package body the orange area in the head",
    "start": "644700",
    "end": "649920"
  },
  {
    "text": "indicates the packaged body size and the green area impact body is resource Eco",
    "start": "649920",
    "end": "656399"
  },
  {
    "text": "address and the blue area is the destination essential address and for",
    "start": "656399",
    "end": "662339"
  },
  {
    "text": "standard UDS panel is safe in the land area in a packet body",
    "start": "662339",
    "end": "669019"
  },
  {
    "text": "and of the song it was engineering worker we found this uh an interesting",
    "start": "670620",
    "end": "677519"
  },
  {
    "text": "UDS diagnostic job which the receiver basis script from the diagnostic tool",
    "start": "677519",
    "end": "683220"
  },
  {
    "text": "and the land right in the best best script into the actual Intel file system",
    "start": "683220",
    "end": "688740"
  },
  {
    "text": "configuration",
    "start": "688740",
    "end": "691740"
  },
  {
    "text": "but in fact the best script is assigned by a private key before executing the",
    "start": "697440",
    "end": "703140"
  },
  {
    "text": "better script the connector second initial data should be sent to the service for digital verification so if",
    "start": "703140",
    "end": "710160"
  },
  {
    "text": "you cannot get a private key it's impossible to achieve the service into executing some modified basis script",
    "start": "710160",
    "end": "719720"
  },
  {
    "text": "is multi-threading and I went to con color this red are accessing the same batch script at the",
    "start": "722060",
    "end": "728880"
  },
  {
    "text": "same moment there's no uh rather save protections like a thread lock so it'll",
    "start": "728880",
    "end": "735300"
  },
  {
    "text": "lead to a classic talk to you with conditional vulnerability",
    "start": "735300",
    "end": "740120"
  },
  {
    "text": "and in order to exploit such a vulnerability we need to create the two con calendar threads for communicating",
    "start": "741540",
    "end": "748440"
  },
  {
    "text": "with these surveys one is targets rather it has sent the normal request and the",
    "start": "748440",
    "end": "753899"
  },
  {
    "text": "analysis thread is sent the malicious request when the darker thread is",
    "start": "753899",
    "end": "759360"
  },
  {
    "text": "finding the best script in memory with collectors donation the research thread",
    "start": "759360",
    "end": "765060"
  },
  {
    "text": "is always striving to rewrite the best scripted in file system uh but rodagus rather is always thinking",
    "start": "765060",
    "end": "772079"
  },
  {
    "text": "on the basic scraper in file system is never be uh it's never been modified during modification uh so other",
    "start": "772079",
    "end": "780240"
  },
  {
    "text": "successful verification the darkest rather or the executed script uh button",
    "start": "780240",
    "end": "785519"
  },
  {
    "text": "the best description has been modified by Lewis threader so by this way we were",
    "start": "785519",
    "end": "790680"
  },
  {
    "text": "able to uh execute the arbitrary batch commands in attribute Intel system with loot privileges",
    "start": "790680",
    "end": "798200"
  },
  {
    "text": "and the layer two is to deliver this product simply but we can spoil the list",
    "start": "798540",
    "end": "804360"
  },
  {
    "text": "service through a USB through ethernet adapter besides on a BMW car and OBD",
    "start": "804360",
    "end": "812100"
  },
  {
    "text": "internet cable can also set up an ethernet connection to large view Intel system so this point can also be",
    "start": "812100",
    "end": "819720"
  },
  {
    "text": "delivered to the service through Ethernet over OBD portal",
    "start": "819720",
    "end": "825120"
  },
  {
    "text": "and after we got to load the show from SEO Intel system from from this picture",
    "start": "825120",
    "end": "831420"
  },
  {
    "text": "we can see that HBO Intel and the HBO has Intel system I'm a thank you network networking",
    "start": "831420",
    "end": "840800"
  },
  {
    "text": "and the next door vulnerability was in the navigation map of the service always this is always continuously monitors USB",
    "start": "841800",
    "end": "849480"
  },
  {
    "text": "ports on NBT health unit and if a USB sticker is plugged in the service will",
    "start": "849480",
    "end": "855300"
  },
  {
    "text": "try to search and analyze and update the configure file from USB sticker which is",
    "start": "855300",
    "end": "861600"
  },
  {
    "text": "called manage ubd.nzdf let's update the config file keeps the",
    "start": "861600",
    "end": "867000"
  },
  {
    "text": "information about the compressed map files for navigation updater uh when navigation update the slot",
    "start": "867000",
    "end": "873839"
  },
  {
    "text": "theater the service also try to decompress network files from USB stick",
    "start": "873839",
    "end": "879000"
  },
  {
    "text": "into the actual Intel system and the before navigation update as",
    "start": "879000",
    "end": "886560"
  },
  {
    "text": "always decompress this map file from USB sticker it needs to pass the upper data",
    "start": "886560",
    "end": "892560"
  },
  {
    "text": "config file and extract a map file name for the compressor and from a recorder",
    "start": "892560",
    "end": "899339"
  },
  {
    "text": "snapshot we can see that the service the uses SS printf function to construct an",
    "start": "899339",
    "end": "906000"
  },
  {
    "text": "episode of file path with a map file name and the list map file name is",
    "start": "906000",
    "end": "911160"
  },
  {
    "text": "retrieved from the updated config file and the lower thing is there's no bundle",
    "start": "911160",
    "end": "917639"
  },
  {
    "text": "a band check on the file name buffer which is allocated On The Stack",
    "start": "917639",
    "end": "922920"
  },
  {
    "text": "so uh if the map file name in the updated config file could be modified with more than 1024 bytes",
    "start": "922920",
    "end": "930600"
  },
  {
    "text": "the final Next Step buffer or the overflowder",
    "start": "930600",
    "end": "935420"
  },
  {
    "text": "and uh in fact the list of the config file is not digitally signed so we we",
    "start": "936180",
    "end": "941880"
  },
  {
    "text": "can directly modify its content a language gravity that is updated configure file by putting numerous bytes",
    "start": "941880",
    "end": "949079"
  },
  {
    "text": "into the field of the map file name in this updated config file and as a result the standard buffer",
    "start": "949079",
    "end": "956579"
  },
  {
    "text": "overflow will be triggered the jewelry navigation map of data",
    "start": "956579",
    "end": "962240"
  },
  {
    "text": "and besides the service process has no Lego calorie protection and the aslr is",
    "start": "962820",
    "end": "968220"
  },
  {
    "text": "not enabled in the QRS operating system so it's a trivial to control the EIP register and using the RP with",
    "start": "968220",
    "end": "976740"
  },
  {
    "text": "successfully exploit a little stack above overflow and achieve the code execution in the actual Intel system",
    "start": "976740",
    "end": "983699"
  },
  {
    "text": "with new privileges and then another attractive feature in",
    "start": "983699",
    "end": "991259"
  },
  {
    "text": "MBT Hardware unit is a connective Drive service with not telematical communication box the connective driver",
    "start": "991259",
    "end": "998880"
  },
  {
    "text": "service can provide user with telemedical and online functions like a real-time traffic information",
    "start": "998880",
    "end": "1005480"
  },
  {
    "text": "online news and the online value and besides on in China if you bought a",
    "start": "1005480",
    "end": "1011720"
  },
  {
    "text": "new BMW car it was free to use to listen so it's about three years",
    "start": "1011720",
    "end": "1017620"
  },
  {
    "text": "and after we was engineering connected driver service we finally as a",
    "start": "1018139",
    "end": "1023720"
  },
  {
    "text": "provisioning profile which is used to configure this service and in in this",
    "start": "1023720",
    "end": "1029120"
  },
  {
    "text": "profile it defines the background URL of the online functions and in this picture",
    "start": "1029120",
    "end": "1035480"
  },
  {
    "text": "it's a URL for the online news function and it's used actually VPS which seems",
    "start": "1035480",
    "end": "1041780"
  },
  {
    "text": "to be secure and by analyzing the traffic between the",
    "start": "1041780",
    "end": "1048500"
  },
  {
    "text": "service and the background server we found the service of the sender uh send",
    "start": "1048500",
    "end": "1054020"
  },
  {
    "text": "a periodical we pass the tool background server and if you look back on the server responses some correct data the",
    "start": "1054020",
    "end": "1060140"
  },
  {
    "text": "service would try to uh to try to download a new profile from the background server to configure to",
    "start": "1060140",
    "end": "1066559"
  },
  {
    "text": "configure service uh in this picture uh we can see that the services and uh HTTP request to the",
    "start": "1066559",
    "end": "1074240"
  },
  {
    "text": "tool back on the server to download a new profile uh through the HTTP policy",
    "start": "1074240",
    "end": "1079760"
  },
  {
    "text": "and besides the new download data profile is just well edited by md5",
    "start": "1079760",
    "end": "1085460"
  },
  {
    "text": "algorithm so obviously this is really a security issue if you could if you could",
    "start": "1085460",
    "end": "1092600"
  },
  {
    "text": "intercept the HTTP traffic then you could hijack functions of the connected",
    "start": "1092600",
    "end": "1097880"
  },
  {
    "text": "driver service",
    "start": "1097880",
    "end": "1100539"
  },
  {
    "text": "3G and 2G networks so in order to intercept the GPS traffic we need to use",
    "start": "1109360",
    "end": "1116120"
  },
  {
    "text": "uh use RP and open BTS to set up a fake GSM based station",
    "start": "1116120",
    "end": "1123519"
  },
  {
    "text": "and the ones we are first in the telematical communication are to connect to our fake gsm-based station then we",
    "start": "1123980",
    "end": "1132080"
  },
  {
    "text": "can remotely trigger the polarization of data and deployed a new modified profile",
    "start": "1132080",
    "end": "1137480"
  },
  {
    "text": "to the service foreign modify the profile the online news URL has been changed",
    "start": "1137480",
    "end": "1144679"
  },
  {
    "text": "from hdps to http so later we can do a main Elemental attack against the online",
    "start": "1144679",
    "end": "1152059"
  },
  {
    "text": "news function",
    "start": "1152059",
    "end": "1154779"
  },
  {
    "text": "and actually the online news function in MBT health unit is processed by an",
    "start": "1157100",
    "end": "1162260"
  },
  {
    "text": "income browser in the system which is called a different control browser",
    "start": "1162260",
    "end": "1167360"
  },
  {
    "text": "and for security purposes a lot of console browser is running as a low probability",
    "start": "1167360",
    "end": "1172780"
  },
  {
    "text": "system which is uid S8",
    "start": "1172780",
    "end": "1177700"
  },
  {
    "text": "and since we have we have modified the online news UI with HTTP so that we can",
    "start": "1178940",
    "end": "1185360"
  },
  {
    "text": "manipulate HTTP uh traffic in our fake business station and according to the",
    "start": "1185360",
    "end": "1191000"
  },
  {
    "text": "browser usage and we will let a different control browser it's based on a webkin.ng",
    "start": "1191000",
    "end": "1197780"
  },
  {
    "text": "and we also fund the corresponding replicator library in a system which is",
    "start": "1197780",
    "end": "1202880"
  },
  {
    "text": "customized by hammer for current operating system and this webkit library",
    "start": "1202880",
    "end": "1208460"
  },
  {
    "text": "was really out of data and it had many in public and exploitable vulnerabilities",
    "start": "1208460",
    "end": "1215919"
  },
  {
    "text": "and finally uh we exploited a little deep control browser by and use of the",
    "start": "1217059",
    "end": "1223039"
  },
  {
    "text": "free vulnerability in the third function of just array object in the web killer",
    "start": "1223039",
    "end": "1228260"
  },
  {
    "text": "engine actually it was the same one abilities it was the same one ability we",
    "start": "1228260",
    "end": "1233780"
  },
  {
    "text": "used to exploit the Tesla income browser in 2000 in the year 2016.",
    "start": "1233780",
    "end": "1240620"
  },
  {
    "text": "and basically two of the expectations are similar but in this case here at some point internet should be noted",
    "start": "1240620",
    "end": "1247460"
  },
  {
    "text": "uh in a different control browser all the JavaScript objects are allocated on",
    "start": "1247460",
    "end": "1252559"
  },
  {
    "text": "the QRS system hip memory so we need some knowledges about the QRS hippo",
    "start": "1252559",
    "end": "1258620"
  },
  {
    "text": "memory management and in a different control browser let us know the it so let's also know a",
    "start": "1258620",
    "end": "1265100"
  },
  {
    "text": "writable buffer for the show called execution and in order to achieve the code Extrusion we modified the function",
    "start": "1265100",
    "end": "1272900"
  },
  {
    "text": "point of str2lt segment with the system function",
    "start": "1272900",
    "end": "1278360"
  },
  {
    "text": "address and the land in local JavaScript data function to trigger system function",
    "start": "1278360",
    "end": "1285440"
  },
  {
    "text": "internally and for more expectation details you can check out our web paper which will be",
    "start": "1285440",
    "end": "1292520"
  },
  {
    "text": "released on the blackhead website as mentioned before the different",
    "start": "1292520",
    "end": "1298400"
  },
  {
    "text": "control browser is running as a browser user so a network is adjusted a lot of",
    "start": "1298400",
    "end": "1304640"
  },
  {
    "text": "us get a local browser show but on the different control browser has no browser",
    "start": "1304640",
    "end": "1311240"
  },
  {
    "text": "sandbox protection and it has the ability to access the TCP Network so we",
    "start": "1311240",
    "end": "1318260"
  },
  {
    "text": "can level it will talk to this conditional vulnerability in a diagnosis always to get a little privileges from",
    "start": "1318260",
    "end": "1325400"
  },
  {
    "text": "this process as well and after we got to look at access on",
    "start": "1325400",
    "end": "1331820"
  },
  {
    "text": "the actual Intel system the next step is how to send obviously you can messages",
    "start": "1331820",
    "end": "1337039"
  },
  {
    "text": "onto location bus because as real Intel and the actual system are in the same Q",
    "start": "1337039",
    "end": "1343340"
  },
  {
    "text": "Net and luckily we found there's no password protection in the Q Network so",
    "start": "1343340",
    "end": "1349280"
  },
  {
    "text": "we can directly log into SRU Intel system with Bluetooth privileges",
    "start": "1349280",
    "end": "1356000"
  },
  {
    "text": "and the light field inhale system is responsible for canvas communication with a Central Gateway so and then we uh",
    "start": "1356000",
    "end": "1364400"
  },
  {
    "text": "there was engineering corresponding canvas driver and we found the list can transmit function which is used to send",
    "start": "1364400",
    "end": "1372020"
  },
  {
    "text": "the local messages uh so in the end we hook the list can transmit a function to send account",
    "start": "1372020",
    "end": "1378440"
  },
  {
    "text": "messages with object making ID and arbitrary can data onto the clicking bus",
    "start": "1378440",
    "end": "1385100"
  },
  {
    "text": "so investor but one guy will introduce how to remotely exploit the telematical",
    "start": "1385100",
    "end": "1390140"
  },
  {
    "text": "communication box okay",
    "start": "1390140",
    "end": "1396460"
  },
  {
    "text": "okay um actually this part should be uh it's supposed to be finished talking by uh",
    "start": "1396559",
    "end": "1402200"
  },
  {
    "text": "one of another College uh he's all who you want but he cannot come here for",
    "start": "1402200",
    "end": "1407840"
  },
  {
    "text": "some Visa problems so I will talk talk this section instead of him",
    "start": "1407840",
    "end": "1413179"
  },
  {
    "text": "and actually TCB um the exploit of the TCB is a very important part in our",
    "start": "1413179",
    "end": "1418539"
  },
  {
    "text": "exploration uh it helps to make finally make a remote remote attack",
    "start": "1418539",
    "end": "1426320"
  },
  {
    "text": "uh let's talk about some of the details of the TCB and there's two parts in the",
    "start": "1426320",
    "end": "1431419"
  },
  {
    "text": "TCB the first part is uh from qualcomm's Rex rtos and the next part is an auto",
    "start": "1431419",
    "end": "1437600"
  },
  {
    "text": "sound OS that's MCU to our communication with the canvas",
    "start": "1437600",
    "end": "1443720"
  },
  {
    "text": "and uh in the when we try to reverse the rtos we find that there's a lot of tasks",
    "start": "1443720",
    "end": "1450679"
  },
  {
    "text": "in the PCB in the rack OS so we mainly focus on such kinds of uh these kinds of",
    "start": "1450679",
    "end": "1457159"
  },
  {
    "text": "this tasks the first of all is about the ngtp it's the BMW developed protocol",
    "start": "1457159",
    "end": "1463100"
  },
  {
    "text": "it's a very important part and another thing is the SMS client and also removed",
    "start": "1463100",
    "end": "1468980"
  },
  {
    "text": "service and the elastic core and also there's a provisioning update",
    "start": "1468980",
    "end": "1474740"
  },
  {
    "text": "and all the details I will talk about later first of all the on GTP uh when we try",
    "start": "1474740",
    "end": "1480980"
  },
  {
    "text": "to reverse we find that because BMW car has a remote Services",
    "start": "1480980",
    "end": "1486380"
  },
  {
    "text": "you can uh you use it to um unlock the door and do something else",
    "start": "1486380",
    "end": "1492320"
  },
  {
    "text": "so also you can trick the provisioning update it's like to update the configuration in the TCB and so uh",
    "start": "1492320",
    "end": "1502460"
  },
  {
    "text": "after we uh released our white paper then we find there's actually there's a",
    "start": "1502460",
    "end": "1508299"
  },
  {
    "text": "team found on by the adac they have also a SolidWorks about the ngtp and but the",
    "start": "1508299",
    "end": "1517340"
  },
  {
    "text": "difference the difference is at that time they had to um they find the problem that the BMW used the HTTP but",
    "start": "1517340",
    "end": "1526520"
  },
  {
    "text": "time we had to face https we had had to find something to",
    "start": "1526520",
    "end": "1531740"
  },
  {
    "text": "um to bypass the https protection",
    "start": "1531740",
    "end": "1536620"
  },
  {
    "text": "first of all it will try we should QR recover the GTP messages it's the user",
    "start": "1536919",
    "end": "1542960"
  },
  {
    "text": "asm1 encoding and also it's encrypted but fortunately we find the data drives",
    "start": "1542960",
    "end": "1549559"
  },
  {
    "text": "a hardcode encryption keys so we can use this and buy a lot of reverse and that's",
    "start": "1549559",
    "end": "1555559"
  },
  {
    "text": "finished by oh we want that's very cool and finally we can decode the messages",
    "start": "1555559",
    "end": "1560900"
  },
  {
    "text": "and when you try to snipe the messages to the TCB then we can decode it and",
    "start": "1560900",
    "end": "1566419"
  },
  {
    "text": "also we can encode it and that's the that's the normal uh trigger process of the uh the NG gpus",
    "start": "1566419",
    "end": "1574880"
  },
  {
    "text": "first of all um when the car is shut down and the only the TCB is awake so",
    "start": "1574880",
    "end": "1580460"
  },
  {
    "text": "when you try to use the app to uh like unlock the door first of all it will",
    "start": "1580460",
    "end": "1585740"
  },
  {
    "text": "send a message to the TCB and tell the TCP let's wake the car and then the TCB",
    "start": "1585740",
    "end": "1591020"
  },
  {
    "text": "will make a previous connection to the server and they will transfer another",
    "start": "1591020",
    "end": "1596120"
  },
  {
    "text": "ngtp messages and to uh for example to do the unlock the door and there's",
    "start": "1596120",
    "end": "1601880"
  },
  {
    "text": "everything else so in this kind so in this picture we can see there's a seems",
    "start": "1601880",
    "end": "1607460"
  },
  {
    "text": "there's no problem because um the communication is protected by the uh by the https but we think uh we find",
    "start": "1607460",
    "end": "1615799"
  },
  {
    "text": "that BMW used ngtp to trick the remote Services also to wake the car what about",
    "start": "1615799",
    "end": "1622220"
  },
  {
    "text": "we send another messages with another kind of ngtp message to let the car",
    "start": "1622220",
    "end": "1627740"
  },
  {
    "text": "unlock the door and we success we only uh we find that the SMS and not there's no protection",
    "start": "1627740",
    "end": "1635600"
  },
  {
    "text": "so first of all you use the SMS to tell the car let's wake up and then uh tell the car let's unlock the door then all",
    "start": "1635600",
    "end": "1642559"
  },
  {
    "text": "the thing has worked at this time we can use the SMS to let",
    "start": "1642559",
    "end": "1649460"
  },
  {
    "text": "the car unlock and do something else but and also in the ngtv there are some key",
    "start": "1649460",
    "end": "1656779"
  },
  {
    "text": "points the first of all is about the wing code you shouldn't know the win code of the car and also you should",
    "start": "1656779",
    "end": "1662000"
  },
  {
    "text": "build a fake GSM base station and at this time use HTTP you can only unlock",
    "start": "1662000",
    "end": "1667460"
  },
  {
    "text": "door climate control and you cannot do something else and then it's about the provisioning",
    "start": "1667460",
    "end": "1674000"
  },
  {
    "text": "update it's like a configuration uh update in this part uh actually this",
    "start": "1674000",
    "end": "1680240"
  },
  {
    "text": "configuration file is uh protected by the sign and protected by a lot of",
    "start": "1680240",
    "end": "1685880"
  },
  {
    "text": "things there's enough check but finally we found one to check the",
    "start": "1685880",
    "end": "1693200"
  },
  {
    "text": "stagnation there's a buffer overflow by using this buff overflow finally we",
    "start": "1693200",
    "end": "1701720"
  },
  {
    "text": "can make the code execution in the TCP in the rtos but as I mentioned above uh the first",
    "start": "1701720",
    "end": "1709820"
  },
  {
    "text": "part of the TCB and the rack OS and then there's a cam there's a MCU and then",
    "start": "1709820",
    "end": "1715580"
  },
  {
    "text": "finally that's the can so if you can compromise the uh black OS you can",
    "start": "1715580",
    "end": "1720919"
  },
  {
    "text": "compromise the article so you cannot send any messages to the cam so you should still find uh you should find",
    "start": "1720919",
    "end": "1727760"
  },
  {
    "text": "some some way to uh bypass the MCU to let it send a message but we find",
    "start": "1727760",
    "end": "1733700"
  },
  {
    "text": "another way because there's another function called the last Decor it's it's like some kinds",
    "start": "1733700",
    "end": "1740419"
  },
  {
    "text": "of UDS diagnostic remotely uh to the car so and there's a configuration file in",
    "start": "1740419",
    "end": "1746240"
  },
  {
    "text": "the TCB in the records uh you you can see um there's some in-depth file and",
    "start": "1746240",
    "end": "1752899"
  },
  {
    "text": "you know they find the UDS messages and something else and the MCU will help the",
    "start": "1752899",
    "end": "1758539"
  },
  {
    "text": "request to send the UDS message to the cam so at this time uh now we can",
    "start": "1758539",
    "end": "1764419"
  },
  {
    "text": "conclude uh now we can let the TCB Center and a UDS message we want and how",
    "start": "1764419",
    "end": "1770480"
  },
  {
    "text": "to mix the final export I will talk about later and at this time we just use the last Decor to let the TCB send the",
    "start": "1770480",
    "end": "1777799"
  },
  {
    "text": "UDS message and then about how to attack the ecu's behind the gateway",
    "start": "1777799",
    "end": "1785740"
  },
  {
    "text": "uh you can see um we can go back to see the architecture of the car they have domain",
    "start": "1787279",
    "end": "1794120"
  },
  {
    "text": "isolation if you can compromise the head unit compromise the TCP I mentioned",
    "start": "1794120",
    "end": "1799399"
  },
  {
    "text": "about you cannot influence the whole car you can only influence the ecu's on the",
    "start": "1799399",
    "end": "1807320"
  },
  {
    "text": "maybe the click info as the information domain and just last issue on the",
    "start": "1807320",
    "end": "1812720"
  },
  {
    "text": "information domain um let's see some details because um",
    "start": "1812720",
    "end": "1818120"
  },
  {
    "text": "there's less issues on the infotainment infotainment domain and also you cannot make too many uh effects or",
    "start": "1818120",
    "end": "1826460"
  },
  {
    "text": "some influence to the car just to buy send any message on the click Cam4 so we",
    "start": "1826460",
    "end": "1831679"
  },
  {
    "text": "try to find something to break the domain isolation and we get our for our got our focus on",
    "start": "1831679",
    "end": "1839360"
  },
  {
    "text": "Q function first of all is the diagnostic function from the OBD side and another function is uh the index in",
    "start": "1839360",
    "end": "1847100"
  },
  {
    "text": "the tcbs core we call last day call uh first of all let's check something of",
    "start": "1847100",
    "end": "1853100"
  },
  {
    "text": "the diagnostic function from the OBD side uh first of all at the the first",
    "start": "1853100",
    "end": "1860200"
  },
  {
    "text": "one by one byte in the account ID that means the source ECU ID and also there's",
    "start": "1860260",
    "end": "1866779"
  },
  {
    "text": "the first byte of the can data at the Target ECI if uh we just use some",
    "start": "1866779",
    "end": "1872360"
  },
  {
    "text": "sniping and when we try to do the diagnostic to the car actually you can",
    "start": "1872360",
    "end": "1878480"
  },
  {
    "text": "if you have tried to modify your BMW car or something else you can download some diagnostic software phone online",
    "start": "1878480",
    "end": "1886880"
  },
  {
    "text": "and we you know we just try to snipe the cam messages and we find that this uh",
    "start": "1886880",
    "end": "1892100"
  },
  {
    "text": "this kind of format of the diagnostic package for example the normal diagnosis in like",
    "start": "1892100",
    "end": "1900080"
  },
  {
    "text": "uh six F5 F5 means uh the test from the OBD",
    "start": "1900080",
    "end": "1905899"
  },
  {
    "text": "side and sixth one means that that's the ID of the tcv but when we try to reverse",
    "start": "1905899",
    "end": "1913100"
  },
  {
    "text": "the how we reverse the IDS and the reverse the direction of the can we send the cam",
    "start": "1913100",
    "end": "1920899"
  },
  {
    "text": "message through the key can form and also we will reverse the ID for example",
    "start": "1920899",
    "end": "1926779"
  },
  {
    "text": "we just see say our source ID at the six",
    "start": "1926779",
    "end": "1932059"
  },
  {
    "text": "one that's the key box and also the target ID is the F5 that's the OBD side",
    "start": "1932059",
    "end": "1938600"
  },
  {
    "text": "down very interesting uh we we found that the Gateway can transfer the",
    "start": "1938600",
    "end": "1944960"
  },
  {
    "text": "messages through the OB set it can also transfer the message through another can",
    "start": "1944960",
    "end": "1950179"
  },
  {
    "text": "and include the clicking that's the infotainment domain at this moment uh you can see the",
    "start": "1950179",
    "end": "1956240"
  },
  {
    "text": "picture that's the picture of the easiest that's the diagnostic software from BMW and you can get to the care you",
    "start": "1956240",
    "end": "1964700"
  },
  {
    "text": "can get the ECU ID through that software and now everything seems to work we can",
    "start": "1964700",
    "end": "1971179"
  },
  {
    "text": "use this function to let the let the Gateway help to transfer the messages",
    "start": "1971179",
    "end": "1977360"
  },
  {
    "text": "through the infotainment domain but we can only send these messages through",
    "start": "1977360",
    "end": "1984380"
  },
  {
    "text": "the head unit as I mentioned above the data we we",
    "start": "1984380",
    "end": "1989480"
  },
  {
    "text": "should finish the remote attack the remote attack will show the started from the we should start from the TCP and TCP",
    "start": "1989480",
    "end": "1997519"
  },
  {
    "text": "you cannot send any messages so we put our folks under another kind of function in the TCP uh its name in",
    "start": "1997519",
    "end": "2005740"
  },
  {
    "text": "last day core and actually the last Decor is use a routine Control Function",
    "start": "2005740",
    "end": "2011320"
  },
  {
    "text": "in the BDC it's very similar to the OBD diagnostic format it's used that looting",
    "start": "2011320",
    "end": "2017200"
  },
  {
    "text": "Control Function to help to let the gateway to send the messages to the other cam to transfer the message",
    "start": "2017200",
    "end": "2025720"
  },
  {
    "text": "so let's talk so at this time we just modified the",
    "start": "2025720",
    "end": "2030820"
  },
  {
    "text": "UDS configuration files in the TCB and the TCP will help to send the message we",
    "start": "2030820",
    "end": "2036820"
  },
  {
    "text": "construct and also the Gateway will help to use the last three core function to",
    "start": "2036820",
    "end": "2043299"
  },
  {
    "text": "send the message to the other accounts this time we can finally get a code",
    "start": "2043299",
    "end": "2050858"
  },
  {
    "text": "execution in the TCB and also codex choosing the MBT and had the head unit",
    "start": "2050859",
    "end": "2055960"
  },
  {
    "text": "and then we can let them send the UDS messages and let the Gateway help to",
    "start": "2055960",
    "end": "2062320"
  },
  {
    "text": "transfer the UDS messages first of all is uh now we can see at",
    "start": "2062320",
    "end": "2069460"
  },
  {
    "text": "some of sum of time we can let the cyber security to the functional safety",
    "start": "2069460",
    "end": "2075520"
  },
  {
    "text": "because you can see that's a very normal UDS diagnostic messages when you try to",
    "start": "2075520",
    "end": "2080980"
  },
  {
    "text": "combine them together you can influence the car",
    "start": "2080980",
    "end": "2086578"
  },
  {
    "text": "uh actually uh there's another diagnostic for the software you can download online and there's a lot of",
    "start": "2087339",
    "end": "2094060"
  },
  {
    "text": "diagnostic function you can find in the you can find it in the software and uh",
    "start": "2094060",
    "end": "2099820"
  },
  {
    "text": "there's a lot of things you can you can just diagnostic a whole car and you just",
    "start": "2099820",
    "end": "2105520"
  },
  {
    "text": "get the message by a snipe to the cam and you can get different kinds of",
    "start": "2105520",
    "end": "2111040"
  },
  {
    "text": "UDS messages uh then for example uh I just give you",
    "start": "2111040",
    "end": "2117700"
  },
  {
    "text": "some example and you can combine together for example you can use the our reset is used also you can try to change",
    "start": "2117700",
    "end": "2124960"
  },
  {
    "text": "the driver's seat position and and something else you can just combine the",
    "start": "2124960",
    "end": "2130480"
  },
  {
    "text": "UDS uh together and delete the cyber security problem to the finally the",
    "start": "2130480",
    "end": "2135820"
  },
  {
    "text": "functional problem so in conclusion uh we can root the head",
    "start": "2135820",
    "end": "2141160"
  },
  {
    "text": "unit through the USB side and OBD side and also fake GSM base station",
    "start": "2141160",
    "end": "2147160"
  },
  {
    "text": "and then we can root the head unit and also we can trick the uh the normal",
    "start": "2147160",
    "end": "2152980"
  },
  {
    "text": "function of the BMW remote reverse service used by some problem in the GDP",
    "start": "2152980",
    "end": "2159160"
  },
  {
    "text": "of SMS then we also find above to uh to trick",
    "start": "2159160",
    "end": "2164380"
  },
  {
    "text": "to finally finish the code execution in the TCB and then we can send any messages or UDS",
    "start": "2164380",
    "end": "2172960"
  },
  {
    "text": "messages through stuff MBT the head unit or the TCB to the K Camp buses the click",
    "start": "2172960",
    "end": "2179079"
  },
  {
    "text": "and fall and then use the function which is implemented by in the uh in the",
    "start": "2179079",
    "end": "2185980"
  },
  {
    "text": "gateway to help to transfer the UDS message to the other accounts to the other issues and finally we can get we",
    "start": "2185980",
    "end": "2193900"
  },
  {
    "text": "can influence the other issues in uh to finish our final attack",
    "start": "2193900",
    "end": "2200640"
  },
  {
    "text": "and then we'll be a very interesting topic that's from BMW side and there",
    "start": "2200740",
    "end": "2206079"
  },
  {
    "text": "they will talk about how how the uh response to our report after they",
    "start": "2206079",
    "end": "2211660"
  },
  {
    "text": "receive the response report and how they are fixed some of the problem in detail",
    "start": "2211660",
    "end": "2217420"
  },
  {
    "text": "and that's very interesting thanks",
    "start": "2217420",
    "end": "2222838"
  },
  {
    "text": "so one and a half years ago I wanted to be on a skiing trip with friends",
    "start": "2232359",
    "end": "2238900"
  },
  {
    "text": "actually where I was was the hospital I was in hospital together with my wife who had just given",
    "start": "2238900",
    "end": "2244599"
  },
  {
    "text": "birth to my son that was when I received a text message from my boss",
    "start": "2244599",
    "end": "2250240"
  },
  {
    "text": "and my boss wrote Henry we received a report from Keene security lab and I",
    "start": "2250240",
    "end": "2255520"
  },
  {
    "text": "knew this was going to be interesting [Music] however I would never have imagined to",
    "start": "2255520",
    "end": "2261040"
  },
  {
    "text": "end up here on stage with you guys so as you have seen",
    "start": "2261040",
    "end": "2268440"
  },
  {
    "text": "as you have seen Keen security Labs spend a tremendous amount of research on BMW cars between 2017 and 2018. now I",
    "start": "2270040",
    "end": "2279820"
  },
  {
    "text": "want to give you a little insight on what we did at BMW so we received the report from Keen",
    "start": "2279820",
    "end": "2286660"
  },
  {
    "text": "security lab in February 2018. we have immediately dived into the",
    "start": "2286660",
    "end": "2294579"
  },
  {
    "text": "vulnerabilities to confirm the vulnerabilities on the different modules and",
    "start": "2294579",
    "end": "2300520"
  },
  {
    "text": "we have then started to develop counter measures mitigations and Bug fixes for",
    "start": "2300520",
    "end": "2307240"
  },
  {
    "text": "our cars we have confirmed them on a test Fleet",
    "start": "2307240",
    "end": "2312640"
  },
  {
    "text": "and have then rolled it out to the whole BMW Fleet in summer 2018.",
    "start": "2312640",
    "end": "2319599"
  },
  {
    "text": "so what happens there basically first of all you need Security Experts you need Security Experts to",
    "start": "2320440",
    "end": "2328599"
  },
  {
    "text": "validate and analyze the results so hackers like you and me",
    "start": "2328599",
    "end": "2335500"
  },
  {
    "text": "then you need experts for the different functions that are affected in this case connect the drive",
    "start": "2335500",
    "end": "2341680"
  },
  {
    "text": "if you need experts for the car side and you need experts for the backend side",
    "start": "2341680",
    "end": "2346720"
  },
  {
    "text": "and what you can see here at that picture is actually one of our cars inside an EMC Hall EMC is basically for",
    "start": "2346720",
    "end": "2354700"
  },
  {
    "text": "conformance testing that's a faraday cage so we set up our road base station in that cage of the colleagues that we",
    "start": "2354700",
    "end": "2362440"
  },
  {
    "text": "asked for permission there because of course you don't want to have a rogue GSM based station out in the wild",
    "start": "2362440",
    "end": "2371700"
  },
  {
    "text": "then we took our local Development Centers into the project because you",
    "start": "2372940",
    "end": "2379180"
  },
  {
    "text": "have different configurations and you have different infrastructure depending on the region and the world where the car is operated we have different",
    "start": "2379180",
    "end": "2386020"
  },
  {
    "text": "connected Drive hubs there and we do have different mobile service operators for example for the cars",
    "start": "2386020",
    "end": "2393720"
  },
  {
    "text": "and then of course we had to take our suppliers into the project the suppliers",
    "start": "2395079",
    "end": "2400180"
  },
  {
    "text": "of the head unit devices of the navigation devices suppliers of the telematics devices and also the",
    "start": "2400180",
    "end": "2406900"
  },
  {
    "text": "suppliers of the Gateway modules and that for all the generations that we had",
    "start": "2406900",
    "end": "2412000"
  },
  {
    "text": "assessed and that were affected here last but not least corporate quality so",
    "start": "2412000",
    "end": "2418960"
  },
  {
    "text": "basically our contact to the dealerships around the world so we notified them about the bug fixes and patches and how",
    "start": "2418960",
    "end": "2426640"
  },
  {
    "text": "to roll that out to the vehicles for those that needed physical contact to the people",
    "start": "2426640",
    "end": "2432359"
  },
  {
    "text": "so um let me go into a little more detail here I already mentioned the",
    "start": "2432359",
    "end": "2437859"
  },
  {
    "text": "report that we received from Keene security lab that was really outstanding work so that was very detailed we",
    "start": "2437859",
    "end": "2444760"
  },
  {
    "text": "received proof of concept so it was a was great to work with that and Keen",
    "start": "2444760",
    "end": "2450700"
  },
  {
    "text": "security lab you know they're white hat hackers so they they had four white cars here",
    "start": "2450700",
    "end": "2455859"
  },
  {
    "text": "um and they gave us real results on that so we boiled that basically down to two",
    "start": "2455859",
    "end": "2462880"
  },
  {
    "text": "different Generations that we had to look at look at in the navigation systems and the telematics units",
    "start": "2462880",
    "end": "2468880"
  },
  {
    "text": "um but then if you think of how many cars we built and how many cars we developed what do you think how many",
    "start": "2468880",
    "end": "2475980"
  },
  {
    "text": "similar built to other cars out of the two million cars we produce in a year would there be",
    "start": "2475980",
    "end": "2482980"
  },
  {
    "text": "basically not even a handful so we had many cars and many different uh",
    "start": "2482980",
    "end": "2490000"
  },
  {
    "text": "configurations that we wanted to look at different options for different configurations different Regional",
    "start": "2490000",
    "end": "2495780"
  },
  {
    "text": "configurations different generations of control units and different combinations of those control units and that's how we",
    "start": "2495780",
    "end": "2503500"
  },
  {
    "text": "dived into it so to give you one example you have seen the buffer overflow in the provisioning",
    "start": "2503500",
    "end": "2510400"
  },
  {
    "text": "of connected drive right so that was one telematics unit that was affected with",
    "start": "2510400",
    "end": "2516099"
  },
  {
    "text": "this bug and that was limited to actually one of the connected Drive hubs",
    "start": "2516099",
    "end": "2521560"
  },
  {
    "text": "um in this case in China where we had an additional misconfiguration so we had an HTTP URL instead of the https URL inside",
    "start": "2521560",
    "end": "2529720"
  },
  {
    "text": "so in that case it was exploitable how did we address that we addressed",
    "start": "2529720",
    "end": "2535720"
  },
  {
    "text": "that with an over-the-air reconfiguration so we move from HTTP to https",
    "start": "2535720",
    "end": "2542440"
  },
  {
    "text": "um by contacting the cars and giving them a new configuration so",
    "start": "2542440",
    "end": "2547540"
  },
  {
    "text": "um we reached all of the cars in uh 86 of the cars in the first attempt",
    "start": "2547540",
    "end": "2554079"
  },
  {
    "text": "um and then we tried again for a couple of times and after the first retry after",
    "start": "2554079",
    "end": "2559720"
  },
  {
    "text": "the fourth retry with a success rate of 96 percent so the rest of the four percent are",
    "start": "2559720",
    "end": "2566079"
  },
  {
    "text": "basically cars that are not connected anymore um for example they're salvaged",
    "start": "2566079",
    "end": "2572339"
  },
  {
    "text": "as having mentioned before he got the text message when he was in the hospital with his wife and his",
    "start": "2578020",
    "end": "2583960"
  },
  {
    "text": "newborn so we had to find somebody else to get onto this topic quickly as I had steal his skis in my office we",
    "start": "2583960",
    "end": "2591640"
  },
  {
    "text": "had which he had left there when he had to run to the hospital I also took over the responsibility for the incident",
    "start": "2591640",
    "end": "2598859"
  },
  {
    "text": "response project which actually became one of the most interesting ones I've done within BMW so far",
    "start": "2598859",
    "end": "2606700"
  },
  {
    "text": "but there was another reason for me to take over the responsibility for this project because I had been part of the",
    "start": "2606700",
    "end": "2612700"
  },
  {
    "text": "team that developed the connected drive and telematics functions in the control units we are actually talking about",
    "start": "2612700",
    "end": "2618760"
  },
  {
    "text": "today so I had the Deep knowledge about the house and whys to come up with the right",
    "start": "2618760",
    "end": "2624339"
  },
  {
    "text": "countermeasures so let's get into those I will show you now in detail one of the",
    "start": "2624339",
    "end": "2629920"
  },
  {
    "text": "counter measures that we developed and rolled out I'm using the attack against the remote",
    "start": "2629920",
    "end": "2635800"
  },
  {
    "text": "door unlocked as shown by Keen security lab just a couple of minutes before",
    "start": "2635800",
    "end": "2640900"
  },
  {
    "text": "to get into this um we will have a look at the flow again but for us the most important question",
    "start": "2640900",
    "end": "2647800"
  },
  {
    "text": "was how do we come up with a counter measure that we can roll out as quickly as possible best of all to roll it out",
    "start": "2647800",
    "end": "2655240"
  },
  {
    "text": "over the year so our customers gets the Improvement as quickly as possible without any activity on their site",
    "start": "2655240",
    "end": "2663280"
  },
  {
    "text": "so when we look at the remote service flow the customer has a smartphone with the BMW Connected app on it when he",
    "start": "2663280",
    "end": "2669640"
  },
  {
    "text": "executes the service it sends a command to our backend server the server then",
    "start": "2669640",
    "end": "2675579"
  },
  {
    "text": "sends the SMS to our cars to wake it up with the ngtp protocol",
    "start": "2675579",
    "end": "2681040"
  },
  {
    "text": "after that the flow is designed in a way that is doing an https request to the",
    "start": "2681040",
    "end": "2686260"
  },
  {
    "text": "back end to ask for the actual command to be executed are all of those messages are in GDP",
    "start": "2686260",
    "end": "2692380"
  },
  {
    "text": "messages and then an important part comes the car is checking then the already mentioned",
    "start": "2692380",
    "end": "2698380"
  },
  {
    "text": "provisioning file within this provisioning file there are not only technical parameters telling which URL",
    "start": "2698380",
    "end": "2704560"
  },
  {
    "text": "to contact but also it tells which Services the customer has subscribed to",
    "start": "2704560",
    "end": "2710020"
  },
  {
    "text": "so in this case the customer has subscribed to the services remote or unlock so the car checks the",
    "start": "2710020",
    "end": "2715540"
  },
  {
    "text": "provisioning says it's okay it will unlock the door",
    "start": "2715540",
    "end": "2720300"
  },
  {
    "text": "um and sends a command back to the BMW server the customer gets a notification",
    "start": "2720819",
    "end": "2727359"
  },
  {
    "text": "on the smartphone and knows everything worked fine so how then does the attack work",
    "start": "2727359",
    "end": "2733359"
  },
  {
    "text": "so they set up a road pay station traps the car into their own 2G network",
    "start": "2733359",
    "end": "2739900"
  },
  {
    "text": "since the Wake Up SMS which they're capable of doing so because they rebirth",
    "start": "2739900",
    "end": "2745000"
  },
  {
    "text": "engineered the protocol and they also extracted the pre-shared keyword with with were part of the software",
    "start": "2745000",
    "end": "2751720"
  },
  {
    "text": "and then instead of having the car pulling the command via https now they sent the same message again",
    "start": "2751720",
    "end": "2758380"
  },
  {
    "text": "unfortunately one of our configurations inside the field accepted this SMS not",
    "start": "2758380",
    "end": "2764079"
  },
  {
    "text": "all of the configurations did it checks the provisioning and executes the service so we thought how can we",
    "start": "2764079",
    "end": "2772420"
  },
  {
    "text": "come up with a counter measure to prevent this and provisioning was already mentioned",
    "start": "2772420",
    "end": "2777460"
  },
  {
    "text": "before we are also capable of providing new configurations to our car while they",
    "start": "2777460",
    "end": "2782740"
  },
  {
    "text": "are in operation so we said let's just reconfigure our cars outside the",
    "start": "2782740",
    "end": "2788319"
  },
  {
    "text": "affected ones to turn the service off via provisioning so we did that with all the fleet so what happens now when the",
    "start": "2788319",
    "end": "2795040"
  },
  {
    "text": "attacker is coming they send the SMS again but the car is",
    "start": "2795040",
    "end": "2800800"
  },
  {
    "text": "validating those against the configuration inside saying okay the service is not allowed to run and so the",
    "start": "2800800",
    "end": "2807640"
  },
  {
    "text": "attack doesn't work any longer but it has a drawback the customer still wants to use the",
    "start": "2807640",
    "end": "2813099"
  },
  {
    "text": "service so we have to find a way of enabling it for him what do we come up we change our configuration flow within",
    "start": "2813099",
    "end": "2820300"
  },
  {
    "text": "our connected Drive backend without any changes within the car so when the customer is now executing",
    "start": "2820300",
    "end": "2826180"
  },
  {
    "text": "the service instead of directly sending the SMS to wake it up we send another command to download a new configuration",
    "start": "2826180",
    "end": "2833260"
  },
  {
    "text": "temporarily this comes also to the car wire SMS and then it's fetching this configuration",
    "start": "2833260",
    "end": "2839560"
  },
  {
    "text": "via the https connection but in this case this is only possible um why https not ysms because the",
    "start": "2839560",
    "end": "2846700"
  },
  {
    "text": "payload is so much bigger so then temporarily the service is turned on inside the car",
    "start": "2846700",
    "end": "2853059"
  },
  {
    "text": "we done operate the normal remote execute by a path we did before so it's",
    "start": "2853059",
    "end": "2858940"
  },
  {
    "text": "coming down the message checking provisioning executing the server sending the command back",
    "start": "2858940",
    "end": "2864819"
  },
  {
    "text": "and then we clean up so to speak so we set the car back to the secure",
    "start": "2864819",
    "end": "2870880"
  },
  {
    "text": "configuration by reprovisioning it once again and turning all the services off again so the attack won't work any",
    "start": "2870880",
    "end": "2877359"
  },
  {
    "text": "longer",
    "start": "2877359",
    "end": "2879779"
  },
  {
    "text": "so just to give you an idea on what we do for security we don't only address this internally so we have teams of",
    "start": "2886059",
    "end": "2893260"
  },
  {
    "text": "hackers penetration testing Incident Management but also everywhere in the",
    "start": "2893260",
    "end": "2898300"
  },
  {
    "text": "development but also um we have a website that you can report security research to so if you go to our",
    "start": "2898300",
    "end": "2905680"
  },
  {
    "text": "website bmwgroup.com you go to contact and then you go to security you will",
    "start": "2905680",
    "end": "2911319"
  },
  {
    "text": "find an email address and you will find a pgp key that you can use to encrypt so you can address uh your security",
    "start": "2911319",
    "end": "2919119"
  },
  {
    "text": "research on the car but also on corporate I.T issues to this email address",
    "start": "2919119",
    "end": "2924400"
  },
  {
    "text": "and we'll also very active in other parts so for example we brought the",
    "start": "2924400",
    "end": "2929740"
  },
  {
    "text": "secure onboard communication protocol into our and we're active in Auto wisec which is basically an association with",
    "start": "2929740",
    "end": "2937599"
  },
  {
    "text": "the oems and the tier ones where we discuss vulnerabilities to learn from them",
    "start": "2937599",
    "end": "2942640"
  },
  {
    "text": "then there's ISO and SAE who just develop a standard on how to bring",
    "start": "2942640",
    "end": "2947980"
  },
  {
    "text": "security into the Engineering Process for embedded Automotive",
    "start": "2947980",
    "end": "2954400"
  },
  {
    "text": "so what are the key takeaways for you today first of all",
    "start": "2955119",
    "end": "2961119"
  },
  {
    "text": "um Automotive is a very very complex business you have seen the different configurations the different Regional",
    "start": "2961119",
    "end": "2969000"
  },
  {
    "text": "configurations even different options different Regional configurations you have seen the different life cycles the",
    "start": "2969000",
    "end": "2975819"
  },
  {
    "text": "long life cycle of the product then you've seen over-the-air updates",
    "start": "2975819",
    "end": "2980980"
  },
  {
    "text": "are essential this is vital to address Security in a very very fast manner",
    "start": "2980980",
    "end": "2989140"
  },
  {
    "text": "then the automotive industry is changing and this is not only the oems the manufacturers but also the suppliers",
    "start": "2989140",
    "end": "2995619"
  },
  {
    "text": "this has to go through the whole supply chain and security is becoming a an essential",
    "start": "2995619",
    "end": "3001559"
  },
  {
    "text": "part in development and then also in operations so when the car is on the road",
    "start": "3001559",
    "end": "3007859"
  },
  {
    "text": "and then as a last Point responsible disclosure is the key also in the automotive world to make the product",
    "start": "3007859",
    "end": "3014339"
  },
  {
    "text": "more secure and we want to thank you for being responsible and disclosing that to us so",
    "start": "3014339",
    "end": "3021480"
  },
  {
    "text": "now we could be on stage here together thank you",
    "start": "3021480",
    "end": "3026660"
  }
]