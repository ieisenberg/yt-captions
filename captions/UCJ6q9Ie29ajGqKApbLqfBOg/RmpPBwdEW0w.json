[
  {
    "text": "[Music]",
    "start": "1740",
    "end": "4810"
  },
  {
    "text": "hi everybody my name is euphal and i'm a",
    "start": "8559",
    "end": "10639"
  },
  {
    "text": "research team leader thomas i'm gal and",
    "start": "10639",
    "end": "12880"
  },
  {
    "text": "i'm a researcher at armis also with us",
    "start": "12880",
    "end": "15200"
  },
  {
    "text": "is norm",
    "start": "15200",
    "end": "16240"
  },
  {
    "text": "which we're going to meet during the",
    "start": "16240",
    "end": "17279"
  },
  {
    "text": "demo",
    "start": "17279",
    "end": "18240"
  },
  {
    "text": "okay so first a quick word about armies",
    "start": "18240",
    "end": "21760"
  },
  {
    "text": "amis is a company that does a passive",
    "start": "21760",
    "end": "23840"
  },
  {
    "text": "network monitoring asset inventory and",
    "start": "23840",
    "end": "26080"
  },
  {
    "text": "anomaly detection",
    "start": "26080",
    "end": "27920"
  },
  {
    "text": "we are part of the research team which",
    "start": "27920",
    "end": "30080"
  },
  {
    "text": "focuses on vulnerability research of",
    "start": "30080",
    "end": "32238"
  },
  {
    "text": "embedded devices",
    "start": "32239",
    "end": "34399"
  },
  {
    "text": "we discover critical vulnerabilities",
    "start": "34399",
    "end": "35920"
  },
  {
    "text": "that impact billions of devices and",
    "start": "35920",
    "end": "37920"
  },
  {
    "text": "design and innovate security solutions",
    "start": "37920",
    "end": "39760"
  },
  {
    "text": "to mitigate the risk that stems from iot",
    "start": "39760",
    "end": "42079"
  },
  {
    "text": "devices",
    "start": "42079",
    "end": "44160"
  },
  {
    "text": "and this is what we're going to cover",
    "start": "44160",
    "end": "45440"
  },
  {
    "text": "today",
    "start": "45440",
    "end": "46480"
  },
  {
    "text": "what tielstrom actually is",
    "start": "46480",
    "end": "48800"
  },
  {
    "text": "what is a software supply chain is an",
    "start": "48800",
    "end": "50719"
  },
  {
    "text": "attack vector",
    "start": "50719",
    "end": "52160"
  },
  {
    "text": "and how we found these vulnerabilities",
    "start": "52160",
    "end": "54160"
  },
  {
    "text": "and how they are connected",
    "start": "54160",
    "end": "56160"
  },
  {
    "text": "and some hardware hacking techniques we",
    "start": "56160",
    "end": "57840"
  },
  {
    "text": "needed along the way and of course a",
    "start": "57840",
    "end": "60000"
  },
  {
    "text": "live demo expect some smoke",
    "start": "60000",
    "end": "63280"
  },
  {
    "text": "so teal storm is a set of eight critical",
    "start": "63280",
    "end": "65518"
  },
  {
    "text": "vulnerabilities found across three",
    "start": "65519",
    "end": "67840"
  },
  {
    "text": "popular device lines like",
    "start": "67840",
    "end": "70479"
  },
  {
    "text": "network speeches by aruba network",
    "start": "70479",
    "end": "72479"
  },
  {
    "text": "switches by avaya and smart ups devices",
    "start": "72479",
    "end": "75119"
  },
  {
    "text": "by apc",
    "start": "75119",
    "end": "77360"
  },
  {
    "text": "we successfully exploited some of these",
    "start": "77360",
    "end": "79119"
  },
  {
    "text": "vulnerabilities to remote code execution",
    "start": "79119",
    "end": "82000"
  },
  {
    "text": "and one of these enables the attacker to",
    "start": "82000",
    "end": "84560"
  },
  {
    "text": "bypass the captive portal in the uber",
    "start": "84560",
    "end": "86400"
  },
  {
    "text": "switches while others",
    "start": "86400",
    "end": "89200"
  },
  {
    "text": "allow the attacker to cause physical",
    "start": "89200",
    "end": "91119"
  },
  {
    "text": "damage like you're going to see in the",
    "start": "91119",
    "end": "92479"
  },
  {
    "text": "demo",
    "start": "92479",
    "end": "94479"
  },
  {
    "text": "so what is software supply chain",
    "start": "94479",
    "end": "96960"
  },
  {
    "text": "for our purposes it means that most",
    "start": "96960",
    "end": "99920"
  },
  {
    "text": "services and products built today are",
    "start": "99920",
    "end": "102320"
  },
  {
    "text": "based on third-party code for example",
    "start": "102320",
    "end": "104960"
  },
  {
    "text": "the typical website contains",
    "start": "104960",
    "end": "106399"
  },
  {
    "text": "approximately 70",
    "start": "106399",
    "end": "108000"
  },
  {
    "text": "third party code",
    "start": "108000",
    "end": "110159"
  },
  {
    "text": "and this is true in essence also for",
    "start": "110159",
    "end": "112479"
  },
  {
    "text": "embedded devices where a lot of the code",
    "start": "112479",
    "end": "114720"
  },
  {
    "text": "is shared among many different products",
    "start": "114720",
    "end": "117680"
  },
  {
    "text": "and as you can probably know",
    "start": "117680",
    "end": "120079"
  },
  {
    "text": "this can be a big risk",
    "start": "120079",
    "end": "122000"
  },
  {
    "text": "and these two cases are proof",
    "start": "122000",
    "end": "124000"
  },
  {
    "text": "the first one is the log for shell case",
    "start": "124000",
    "end": "125840"
  },
  {
    "text": "from last december which got the whole",
    "start": "125840",
    "end": "127600"
  },
  {
    "text": "security world on its feet",
    "start": "127600",
    "end": "129440"
  },
  {
    "text": "one simple vulnerability in a logging",
    "start": "129440",
    "end": "131920"
  },
  {
    "text": "package affected tens of thousands of",
    "start": "131920",
    "end": "134400"
  },
  {
    "text": "other packages and dozens of",
    "start": "134400",
    "end": "136080"
  },
  {
    "text": "high-profile",
    "start": "136080",
    "end": "137920"
  },
  {
    "text": "companies and services",
    "start": "137920",
    "end": "140239"
  },
  {
    "text": "and the other is urgent 11 which is a",
    "start": "140239",
    "end": "142319"
  },
  {
    "text": "set of 11 vulnerabilities in the ip net",
    "start": "142319",
    "end": "144640"
  },
  {
    "text": "tcp ip stack",
    "start": "144640",
    "end": "147120"
  },
  {
    "text": "multi multiple um",
    "start": "147120",
    "end": "150160"
  },
  {
    "text": "embedded operating system used this",
    "start": "150160",
    "end": "151920"
  },
  {
    "text": "software component and because billions",
    "start": "151920",
    "end": "153920"
  },
  {
    "text": "of devices",
    "start": "153920",
    "end": "155599"
  },
  {
    "text": "use these operating systems billions",
    "start": "155599",
    "end": "158080"
  },
  {
    "text": "were affected",
    "start": "158080",
    "end": "160400"
  },
  {
    "text": "so let's map this out",
    "start": "160400",
    "end": "162319"
  },
  {
    "text": "shared code means shared risk because",
    "start": "162319",
    "end": "165120"
  },
  {
    "text": "one vulnerability impacts many different",
    "start": "165120",
    "end": "167440"
  },
  {
    "text": "products",
    "start": "167440",
    "end": "168720"
  },
  {
    "text": "and also short code means bigger upside",
    "start": "168720",
    "end": "171200"
  },
  {
    "text": "for hackers because if one vulnerability",
    "start": "171200",
    "end": "173599"
  },
  {
    "text": "impacts many different devices",
    "start": "173599",
    "end": "176080"
  },
  {
    "text": "it is worth more to find but on the",
    "start": "176080",
    "end": "178560"
  },
  {
    "text": "other hand shared code means more",
    "start": "178560",
    "end": "180160"
  },
  {
    "text": "security resources because if the risk",
    "start": "180160",
    "end": "183280"
  },
  {
    "text": "is shared there are many more people",
    "start": "183280",
    "end": "185040"
  },
  {
    "text": "with incentive to help secure the code",
    "start": "185040",
    "end": "188080"
  },
  {
    "text": "and this brings us to the comparison",
    "start": "188080",
    "end": "190000"
  },
  {
    "text": "between open source code and closed",
    "start": "190000",
    "end": "191440"
  },
  {
    "text": "source code",
    "start": "191440",
    "end": "193120"
  },
  {
    "text": "the main security upside for closed",
    "start": "193120",
    "end": "194800"
  },
  {
    "text": "source code is that it makes it harder",
    "start": "194800",
    "end": "196560"
  },
  {
    "text": "for hackers to acquire the code to",
    "start": "196560",
    "end": "198640"
  },
  {
    "text": "search for weaknesses",
    "start": "198640",
    "end": "200959"
  },
  {
    "text": "or in other words security by obscurity",
    "start": "200959",
    "end": "203360"
  },
  {
    "text": "instead of opening the books hiding them",
    "start": "203360",
    "end": "206879"
  },
  {
    "text": "on the other hand the main security",
    "start": "206879",
    "end": "208159"
  },
  {
    "text": "upside for open source code is that you",
    "start": "208159",
    "end": "210799"
  },
  {
    "text": "get a community alongside with the code",
    "start": "210799",
    "end": "214000"
  },
  {
    "text": "it's true that it's easier for hackers",
    "start": "214000",
    "end": "215920"
  },
  {
    "text": "to gain access to the code but also for",
    "start": "215920",
    "end": "217599"
  },
  {
    "text": "the security community which all share",
    "start": "217599",
    "end": "219280"
  },
  {
    "text": "an incentive",
    "start": "219280",
    "end": "220640"
  },
  {
    "text": "to help secure it what you also get is a",
    "start": "220640",
    "end": "222959"
  },
  {
    "text": "community of developers helping with",
    "start": "222959",
    "end": "224720"
  },
  {
    "text": "helping you to figure out",
    "start": "224720",
    "end": "226640"
  },
  {
    "text": "how to use the library and as we'll",
    "start": "226640",
    "end": "228959"
  },
  {
    "text": "shortly see this can be just as",
    "start": "228959",
    "end": "230560"
  },
  {
    "text": "important",
    "start": "230560",
    "end": "232720"
  },
  {
    "text": "so our research today is gonna",
    "start": "232720",
    "end": "235360"
  },
  {
    "text": "focus on a specific closed source",
    "start": "235360",
    "end": "237680"
  },
  {
    "text": "library called nano ssl",
    "start": "237680",
    "end": "240400"
  },
  {
    "text": "this library is developed by mokana",
    "start": "240400",
    "end": "242400"
  },
  {
    "text": "which was recently acquired by digiselt",
    "start": "242400",
    "end": "246400"
  },
  {
    "text": "and as you can see our results trade us",
    "start": "246400",
    "end": "249040"
  },
  {
    "text": "to many different companies that use",
    "start": "249040",
    "end": "251599"
  },
  {
    "text": "this",
    "start": "251599",
    "end": "253040"
  },
  {
    "text": "the code of nano ssl like aruba and",
    "start": "253040",
    "end": "255760"
  },
  {
    "text": "avaya which both",
    "start": "255760",
    "end": "259120"
  },
  {
    "text": "create i.t devices and apc which is a",
    "start": "259120",
    "end": "262160"
  },
  {
    "text": "manufacturer of ups devices",
    "start": "262160",
    "end": "265440"
  },
  {
    "text": "and here you can see that attacks",
    "start": "265440",
    "end": "267600"
  },
  {
    "text": "against these such devices is a real",
    "start": "267600",
    "end": "270080"
  },
  {
    "text": "risk and on the top you can see an",
    "start": "270080",
    "end": "272240"
  },
  {
    "text": "example of a wide scale attack against",
    "start": "272240",
    "end": "274479"
  },
  {
    "text": "network switches",
    "start": "274479",
    "end": "276000"
  },
  {
    "text": "and on the",
    "start": "276000",
    "end": "276960"
  },
  {
    "text": "bottom assist alert",
    "start": "276960",
    "end": "278720"
  },
  {
    "text": "from ups",
    "start": "278720",
    "end": "280840"
  },
  {
    "text": "attacks so let's begin with the first",
    "start": "280840",
    "end": "283120"
  },
  {
    "text": "name on the list aruba",
    "start": "283120",
    "end": "285600"
  },
  {
    "text": "we found many different device series",
    "start": "285600",
    "end": "288240"
  },
  {
    "text": "that use a nano ssl from aruba and we",
    "start": "288240",
    "end": "291680"
  },
  {
    "text": "found many interfaces in these devices",
    "start": "291680",
    "end": "293520"
  },
  {
    "text": "that use it we chose to focus on the",
    "start": "293520",
    "end": "295680"
  },
  {
    "text": "captive",
    "start": "295680",
    "end": "296560"
  },
  {
    "text": "the captive portal interface like you",
    "start": "296560",
    "end": "298240"
  },
  {
    "text": "can see on the bottom right",
    "start": "298240",
    "end": "300400"
  },
  {
    "text": "and which is a bad interface to be",
    "start": "300400",
    "end": "302240"
  },
  {
    "text": "vulnerable because",
    "start": "302240",
    "end": "303600"
  },
  {
    "text": "it is by design aimed at users before",
    "start": "303600",
    "end": "306080"
  },
  {
    "text": "authentication and without authorization",
    "start": "306080",
    "end": "310080"
  },
  {
    "text": "and let's take a closer look",
    "start": "310080",
    "end": "312639"
  },
  {
    "text": "the first thing we need to know is that",
    "start": "312639",
    "end": "314160"
  },
  {
    "text": "nano ssl defines error codes just like",
    "start": "314160",
    "end": "316880"
  },
  {
    "text": "any other library and handling these",
    "start": "316880",
    "end": "319039"
  },
  {
    "text": "level codes is the vendor's",
    "start": "319039",
    "end": "320479"
  },
  {
    "text": "responsibility like closing a session in",
    "start": "320479",
    "end": "323039"
  },
  {
    "text": "case of an error",
    "start": "323039",
    "end": "324400"
  },
  {
    "text": "and as you can probably guess this is",
    "start": "324400",
    "end": "326720"
  },
  {
    "text": "something that is really easy to miss",
    "start": "326720",
    "end": "330240"
  },
  {
    "text": "let's",
    "start": "330240",
    "end": "331120"
  },
  {
    "text": "look take a look at the code so here we",
    "start": "331120",
    "end": "333280"
  },
  {
    "text": "have a call to the receive api which is",
    "start": "333280",
    "end": "336320"
  },
  {
    "text": "properly handled",
    "start": "336320",
    "end": "338320"
  },
  {
    "text": "next there is another call which is not",
    "start": "338320",
    "end": "340639"
  },
  {
    "text": "properly handled the inner loop will",
    "start": "340639",
    "end": "342960"
  },
  {
    "text": "exit but the outer won't and there will",
    "start": "342960",
    "end": "345280"
  },
  {
    "text": "be another call to receive even if the",
    "start": "345280",
    "end": "347280"
  },
  {
    "text": "previous one failed",
    "start": "347280",
    "end": "349440"
  },
  {
    "text": "this leaves the session hanging and",
    "start": "349440",
    "end": "351199"
  },
  {
    "text": "causes state confusion which leads to",
    "start": "351199",
    "end": "353520"
  },
  {
    "text": "remote code execution vulnerability",
    "start": "353520",
    "end": "357199"
  },
  {
    "text": "and this is why",
    "start": "357199",
    "end": "358960"
  },
  {
    "text": "this is internal code by nano ssl this",
    "start": "358960",
    "end": "361840"
  },
  {
    "text": "code is responsible for the tls",
    "start": "361840",
    "end": "364160"
  },
  {
    "text": "reassembly from tcp stream and to",
    "start": "364160",
    "end": "366479"
  },
  {
    "text": "understand",
    "start": "366479",
    "end": "367520"
  },
  {
    "text": "wider this leads to remote code",
    "start": "367520",
    "end": "369280"
  },
  {
    "text": "execution we're going to first follow",
    "start": "369280",
    "end": "371199"
  },
  {
    "text": "the happy flow of reassembling to tcp",
    "start": "371199",
    "end": "373680"
  },
  {
    "text": "packets",
    "start": "373680",
    "end": "375280"
  },
  {
    "text": "this is the initial state please note",
    "start": "375280",
    "end": "377520"
  },
  {
    "text": "that there is a pre-allocated buffer of",
    "start": "377520",
    "end": "379840"
  },
  {
    "text": "1000 hexabytes internally",
    "start": "379840",
    "end": "382720"
  },
  {
    "text": "first the state is checked",
    "start": "382720",
    "end": "384639"
  },
  {
    "text": "and because this is the first packet",
    "start": "384639",
    "end": "386000"
  },
  {
    "text": "reassembly is not needed",
    "start": "386000",
    "end": "387759"
  },
  {
    "text": "next the header is red which changes the",
    "start": "387759",
    "end": "390240"
  },
  {
    "text": "state",
    "start": "390240",
    "end": "391440"
  },
  {
    "text": "which is checked here and it passes",
    "start": "391440",
    "end": "394720"
  },
  {
    "text": "to the extraction of the length from the",
    "start": "394720",
    "end": "396960"
  },
  {
    "text": "header of let's say 3 000 hexa bytes",
    "start": "396960",
    "end": "401039"
  },
  {
    "text": "this is a valid length according to a",
    "start": "401039",
    "end": "403199"
  },
  {
    "text": "nano ssl so the internal buffer is",
    "start": "403199",
    "end": "405759"
  },
  {
    "text": "reallocated to that size and the rest of",
    "start": "405759",
    "end": "408240"
  },
  {
    "text": "the chunk is red",
    "start": "408240",
    "end": "410160"
  },
  {
    "text": "now for the second packet the",
    "start": "410160",
    "end": "412639"
  },
  {
    "text": "state is checked once again",
    "start": "412639",
    "end": "415199"
  },
  {
    "text": "and because this is reassembly state",
    "start": "415199",
    "end": "417840"
  },
  {
    "text": "the rest of the chunk is red and the",
    "start": "417840",
    "end": "419520"
  },
  {
    "text": "process finishes",
    "start": "419520",
    "end": "421440"
  },
  {
    "text": "now for the vulnerable flow",
    "start": "421440",
    "end": "423599"
  },
  {
    "text": "we begin in the same matter",
    "start": "423599",
    "end": "425680"
  },
  {
    "text": "and with the same state check the same",
    "start": "425680",
    "end": "428960"
  },
  {
    "text": "reading of the header and once again the",
    "start": "428960",
    "end": "431680"
  },
  {
    "text": "same state check",
    "start": "431680",
    "end": "433759"
  },
  {
    "text": "now when we extract the length for the",
    "start": "433759",
    "end": "435520"
  },
  {
    "text": "vulnerable flow to take place we give a",
    "start": "435520",
    "end": "438400"
  },
  {
    "text": "bigger size",
    "start": "438400",
    "end": "439840"
  },
  {
    "text": "than is allowed of let's say 5000 hexa",
    "start": "439840",
    "end": "442240"
  },
  {
    "text": "bytes and because this size is too big",
    "start": "442240",
    "end": "444479"
  },
  {
    "text": "this check will fail and the function",
    "start": "444479",
    "end": "446319"
  },
  {
    "text": "will exit but remember",
    "start": "446319",
    "end": "448560"
  },
  {
    "text": "this is before the the relocation took",
    "start": "448560",
    "end": "451759"
  },
  {
    "text": "place so the internal buffer is still",
    "start": "451759",
    "end": "454639"
  },
  {
    "text": "too little",
    "start": "454639",
    "end": "455919"
  },
  {
    "text": "now we send another packet",
    "start": "455919",
    "end": "459120"
  },
  {
    "text": "the state is checked which indicates",
    "start": "459120",
    "end": "461199"
  },
  {
    "text": "reassembly",
    "start": "461199",
    "end": "462800"
  },
  {
    "text": "and the other chunk is red even if it's",
    "start": "462800",
    "end": "464880"
  },
  {
    "text": "smaller even if it's bigger than the",
    "start": "464880",
    "end": "466479"
  },
  {
    "text": "internal buffer this leads to a hip",
    "start": "466479",
    "end": "468720"
  },
  {
    "text": "overflow",
    "start": "468720",
    "end": "470080"
  },
  {
    "text": "which we successfully exploited to",
    "start": "470080",
    "end": "472080"
  },
  {
    "text": "remote core execution",
    "start": "472080",
    "end": "474879"
  },
  {
    "text": "and this remote core execution not only",
    "start": "474879",
    "end": "476479"
  },
  {
    "text": "allows to bypass the captive portal",
    "start": "476479",
    "end": "478720"
  },
  {
    "text": "interface",
    "start": "478720",
    "end": "480000"
  },
  {
    "text": "it allows a full takeover of the device",
    "start": "480000",
    "end": "482720"
  },
  {
    "text": "which can allow an attacker to hop",
    "start": "482720",
    "end": "484639"
  },
  {
    "text": "villains and move laterally within the",
    "start": "484639",
    "end": "486879"
  },
  {
    "text": "networks and access restricted parts of",
    "start": "486879",
    "end": "488639"
  },
  {
    "text": "the network",
    "start": "488639",
    "end": "490960"
  },
  {
    "text": "and while this vulnerability is not",
    "start": "490960",
    "end": "493039"
  },
  {
    "text": "actually within nano ssl it still stems",
    "start": "493039",
    "end": "496639"
  },
  {
    "text": "from it because one improper level check",
    "start": "496639",
    "end": "498800"
  },
  {
    "text": "should not lead to hip overflow",
    "start": "498800",
    "end": "501759"
  },
  {
    "text": "this leads us to the question",
    "start": "501759",
    "end": "504240"
  },
  {
    "text": "all other vendors always close the",
    "start": "504240",
    "end": "506319"
  },
  {
    "text": "session right",
    "start": "506319",
    "end": "507840"
  },
  {
    "text": "i guess you can guess the answer to that",
    "start": "507840",
    "end": "509520"
  },
  {
    "text": "one",
    "start": "509520",
    "end": "511280"
  },
  {
    "text": "so if we look at this list we can",
    "start": "511280",
    "end": "513360"
  },
  {
    "text": "successfully say that we found a misuse",
    "start": "513360",
    "end": "516000"
  },
  {
    "text": "of nano ssl that leads to remote code",
    "start": "516000",
    "end": "518320"
  },
  {
    "text": "execution in the in the uber device",
    "start": "518320",
    "end": "520800"
  },
  {
    "text": "now for the next name avaya",
    "start": "520800",
    "end": "524159"
  },
  {
    "text": "this code is responsible for passing the",
    "start": "524159",
    "end": "526399"
  },
  {
    "text": "http post header in the web portal",
    "start": "526399",
    "end": "528720"
  },
  {
    "text": "interface it is also missing error code",
    "start": "528720",
    "end": "531279"
  },
  {
    "text": "check and it stems from the",
    "start": "531279",
    "end": "533920"
  },
  {
    "text": "assumption of the code that there would",
    "start": "533920",
    "end": "535600"
  },
  {
    "text": "be a backslash n after a backslash r",
    "start": "535600",
    "end": "538640"
  },
  {
    "text": "if we take a look here there is",
    "start": "538640",
    "end": "540959"
  },
  {
    "text": "a call to the receive api which is",
    "start": "540959",
    "end": "542959"
  },
  {
    "text": "properly handled",
    "start": "542959",
    "end": "544800"
  },
  {
    "text": "another call to the receive api which is",
    "start": "544800",
    "end": "546959"
  },
  {
    "text": "not properly handled",
    "start": "546959",
    "end": "548720"
  },
  {
    "text": "the loop would go around and another",
    "start": "548720",
    "end": "550880"
  },
  {
    "text": "call to receive ap to the receive api",
    "start": "550880",
    "end": "552800"
  },
  {
    "text": "even if the previous one failed just",
    "start": "552800",
    "end": "554480"
  },
  {
    "text": "like before and the vulnerability is",
    "start": "554480",
    "end": "556000"
  },
  {
    "text": "triggered just like before",
    "start": "556000",
    "end": "559040"
  },
  {
    "text": "so we can add another name to the list",
    "start": "559040",
    "end": "562160"
  },
  {
    "text": "of devices that misused the nano ssl",
    "start": "562160",
    "end": "565120"
  },
  {
    "text": "library",
    "start": "565120",
    "end": "566560"
  },
  {
    "text": "which led to a remote core execution",
    "start": "566560",
    "end": "568000"
  },
  {
    "text": "vulnerability",
    "start": "568000",
    "end": "570560"
  },
  {
    "text": "and for the next name of the list apc",
    "start": "570560",
    "end": "572640"
  },
  {
    "text": "which is a manufacturer of ups devices",
    "start": "572640",
    "end": "575200"
  },
  {
    "text": "so a quick recap of what is a ups device",
    "start": "575200",
    "end": "578640"
  },
  {
    "text": "in the normal operation the ups device",
    "start": "578640",
    "end": "580320"
  },
  {
    "text": "realized the power from the grid to the",
    "start": "580320",
    "end": "582880"
  },
  {
    "text": "connected devices and in case of an",
    "start": "582880",
    "end": "585200"
  },
  {
    "text": "outage",
    "start": "585200",
    "end": "586160"
  },
  {
    "text": "it automatically switches to the battery",
    "start": "586160",
    "end": "587920"
  },
  {
    "text": "mode not letting the connected devices",
    "start": "587920",
    "end": "589760"
  },
  {
    "text": "suffer any downtime and by design these",
    "start": "589760",
    "end": "592399"
  },
  {
    "text": "should be devices which are mission",
    "start": "592399",
    "end": "593839"
  },
  {
    "text": "critical who cannot suffer any downtime",
    "start": "593839",
    "end": "597680"
  },
  {
    "text": "more specifically we're talking about",
    "start": "597680",
    "end": "599040"
  },
  {
    "text": "smart ups devices by apc",
    "start": "599040",
    "end": "601680"
  },
  {
    "text": "which are probably the most popular ups",
    "start": "601680",
    "end": "604800"
  },
  {
    "text": "devices in the world with over 20",
    "start": "604800",
    "end": "606560"
  },
  {
    "text": "million units sold which can be found in",
    "start": "606560",
    "end": "608959"
  },
  {
    "text": "about 8 out of 10 enterprise networks",
    "start": "608959",
    "end": "612560"
  },
  {
    "text": "these devices are considered smart",
    "start": "612560",
    "end": "615040"
  },
  {
    "text": "in two main aspects the first is that",
    "start": "615040",
    "end": "618000"
  },
  {
    "text": "software has a big part of the",
    "start": "618000",
    "end": "620640"
  },
  {
    "text": "electrical operation of the device",
    "start": "620640",
    "end": "622800"
  },
  {
    "text": "and the second is a feature called smart",
    "start": "622800",
    "end": "624880"
  },
  {
    "text": "connect which is basically a dedicated",
    "start": "624880",
    "end": "627440"
  },
  {
    "text": "ethernet port connecting the ups to the",
    "start": "627440",
    "end": "629760"
  },
  {
    "text": "cloud",
    "start": "629760",
    "end": "631440"
  },
  {
    "text": "this leads us to the question",
    "start": "631440",
    "end": "633279"
  },
  {
    "text": "combining these two smart aspects of the",
    "start": "633279",
    "end": "635920"
  },
  {
    "text": "device",
    "start": "635920",
    "end": "637040"
  },
  {
    "text": "is there a potential risk here",
    "start": "637040",
    "end": "639279"
  },
  {
    "text": "and to answer that we needed to get",
    "start": "639279",
    "end": "641200"
  },
  {
    "text": "ourselves our hands on the code which as",
    "start": "641200",
    "end": "643760"
  },
  {
    "text": "you can see here is mainly encrypted so",
    "start": "643760",
    "end": "646320"
  },
  {
    "text": "we needed a different approach",
    "start": "646320",
    "end": "648160"
  },
  {
    "text": "the board itself",
    "start": "648160",
    "end": "650240"
  },
  {
    "text": "then we found two stocks or cpus",
    "start": "650240",
    "end": "653440"
  },
  {
    "text": "one of them is closer to the phi which",
    "start": "653440",
    "end": "655440"
  },
  {
    "text": "is the chip that is responsible for",
    "start": "655440",
    "end": "657040"
  },
  {
    "text": "passing and sending of ethernet frames",
    "start": "657040",
    "end": "659760"
  },
  {
    "text": "we figured because this stock is closer",
    "start": "659760",
    "end": "661760"
  },
  {
    "text": "to the file it is the one that is",
    "start": "661760",
    "end": "663279"
  },
  {
    "text": "responsible for the network operations",
    "start": "663279",
    "end": "665680"
  },
  {
    "text": "which we which is where we expect to",
    "start": "665680",
    "end": "667760"
  },
  {
    "text": "find the nano ssl code",
    "start": "667760",
    "end": "670399"
  },
  {
    "text": "we also found this interface which is",
    "start": "670399",
    "end": "673839"
  },
  {
    "text": "connected to the debug pins of the sock",
    "start": "673839",
    "end": "676320"
  },
  {
    "text": "which should allow us to debug the sock",
    "start": "676320",
    "end": "678480"
  },
  {
    "text": "directly",
    "start": "678480",
    "end": "679760"
  },
  {
    "text": "so we connected to it and this is what",
    "start": "679760",
    "end": "681760"
  },
  {
    "text": "happened",
    "start": "681760",
    "end": "684160"
  },
  {
    "text": "okay you cannot hear the sound but",
    "start": "686000",
    "end": "688560"
  },
  {
    "text": "there should be a really annoying beep",
    "start": "688560",
    "end": "690399"
  },
  {
    "text": "sound right now",
    "start": "690399",
    "end": "691760"
  },
  {
    "text": "and this sound means that the device is",
    "start": "691760",
    "end": "694160"
  },
  {
    "text": "frozen until unplugged",
    "start": "694160",
    "end": "697279"
  },
  {
    "text": "so after some head scratching we went to",
    "start": "697279",
    "end": "699440"
  },
  {
    "text": "the widest of them all which in this",
    "start": "699440",
    "end": "701360"
  },
  {
    "text": "case is the cpu's data sheet",
    "start": "701360",
    "end": "704000"
  },
  {
    "text": "there we'll learn about a feature called",
    "start": "704000",
    "end": "705519"
  },
  {
    "text": "rdp",
    "start": "705519",
    "end": "706720"
  },
  {
    "text": "what is rdp you ask",
    "start": "706720",
    "end": "708720"
  },
  {
    "text": "this is how it's described but i only",
    "start": "708720",
    "end": "710880"
  },
  {
    "text": "want you to take a look at the important",
    "start": "710880",
    "end": "712640"
  },
  {
    "text": "code and only the important",
    "start": "712640",
    "end": "714880"
  },
  {
    "text": "so what this basically means",
    "start": "714880",
    "end": "718000"
  },
  {
    "text": "is that once the debug interface is",
    "start": "718000",
    "end": "720800"
  },
  {
    "text": "connected",
    "start": "720800",
    "end": "722640"
  },
  {
    "text": "access to the flash is shut out until a",
    "start": "722640",
    "end": "725040"
  },
  {
    "text": "reboot",
    "start": "725040",
    "end": "726639"
  },
  {
    "text": "so to summarize if we connect the jtag",
    "start": "726639",
    "end": "729360"
  },
  {
    "text": "we don't have access to the flash",
    "start": "729360",
    "end": "730880"
  },
  {
    "text": "anymore but we do get a snapshot of the",
    "start": "730880",
    "end": "733519"
  },
  {
    "text": "ram",
    "start": "733519",
    "end": "734800"
  },
  {
    "text": "so we cannot just",
    "start": "734800",
    "end": "736880"
  },
  {
    "text": "dump the firmware",
    "start": "736880",
    "end": "738800"
  },
  {
    "text": "but we didn't give up we just needed a",
    "start": "738800",
    "end": "740880"
  },
  {
    "text": "little help",
    "start": "740880",
    "end": "742160"
  },
  {
    "text": "from a little friend which in this case",
    "start": "742160",
    "end": "745200"
  },
  {
    "text": "is a smaller ups device by apc",
    "start": "745200",
    "end": "748000"
  },
  {
    "text": "we label these two devices with and",
    "start": "748000",
    "end": "750079"
  },
  {
    "text": "without because only one of them has the",
    "start": "750079",
    "end": "752800"
  },
  {
    "text": "smart connect feature but both of them",
    "start": "752800",
    "end": "754959"
  },
  {
    "text": "are considered smart so we figured there",
    "start": "754959",
    "end": "757040"
  },
  {
    "text": "would be some similarities which which",
    "start": "757040",
    "end": "758880"
  },
  {
    "text": "are going to help us",
    "start": "758880",
    "end": "760959"
  },
  {
    "text": "most of the devices uh have rdp support",
    "start": "760959",
    "end": "764639"
  },
  {
    "text": "but as we found out on the small ups it",
    "start": "764639",
    "end": "767519"
  },
  {
    "text": "is turned off",
    "start": "767519",
    "end": "769760"
  },
  {
    "text": "this was surprising because we already",
    "start": "769760",
    "end": "771680"
  },
  {
    "text": "know that apc knows about this feature",
    "start": "771680",
    "end": "773360"
  },
  {
    "text": "and how to use it",
    "start": "773360",
    "end": "774880"
  },
  {
    "text": "but nonetheless it was turned off so we",
    "start": "774880",
    "end": "776880"
  },
  {
    "text": "were able to just dump the firmware",
    "start": "776880",
    "end": "778880"
  },
  {
    "text": "reverse it focusing on the decryption",
    "start": "778880",
    "end": "780800"
  },
  {
    "text": "part",
    "start": "780800",
    "end": "782000"
  },
  {
    "text": "so we can decrypt the original firmware",
    "start": "782000",
    "end": "784560"
  },
  {
    "text": "but as we found out they used a",
    "start": "784560",
    "end": "786320"
  },
  {
    "text": "different encryption so",
    "start": "786320",
    "end": "787920"
  },
  {
    "text": "that",
    "start": "787920",
    "end": "788800"
  },
  {
    "text": "couldn't work",
    "start": "788800",
    "end": "790240"
  },
  {
    "text": "the last clue we found",
    "start": "790240",
    "end": "792079"
  },
  {
    "text": "is that they have a similar firmware",
    "start": "792079",
    "end": "793519"
  },
  {
    "text": "package structure",
    "start": "793519",
    "end": "794959"
  },
  {
    "text": "which was a big hint as you'll shortly",
    "start": "794959",
    "end": "797360"
  },
  {
    "text": "see",
    "start": "797360",
    "end": "799120"
  },
  {
    "text": "we figured a similar film structure",
    "start": "799120",
    "end": "801279"
  },
  {
    "text": "means a similar update process so we",
    "start": "801279",
    "end": "804160"
  },
  {
    "text": "took a look at the update process of the",
    "start": "804160",
    "end": "806320"
  },
  {
    "text": "small ups",
    "start": "806320",
    "end": "807920"
  },
  {
    "text": "it decrypts the femoral chunk by chunk",
    "start": "807920",
    "end": "810000"
  },
  {
    "text": "each time storing the decrypted chunk in",
    "start": "810000",
    "end": "812839"
  },
  {
    "text": "memory so and remember we can take a",
    "start": "812839",
    "end": "816079"
  },
  {
    "text": "peek at the ram of the original film",
    "start": "816079",
    "end": "818800"
  },
  {
    "text": "so we deduced the address of the",
    "start": "818800",
    "end": "821040"
  },
  {
    "text": "decrypted buffer chunk in the original",
    "start": "821040",
    "end": "822880"
  },
  {
    "text": "firmware's ram and found it",
    "start": "822880",
    "end": "825440"
  },
  {
    "text": "so we have now this",
    "start": "825440",
    "end": "826839"
  },
  {
    "text": "approach we initiate a firmware update",
    "start": "826839",
    "end": "829600"
  },
  {
    "text": "we wait for the correct chunk to be",
    "start": "829600",
    "end": "831200"
  },
  {
    "text": "stored in ram",
    "start": "831200",
    "end": "832480"
  },
  {
    "text": "we dump the ram to extract the chunk and",
    "start": "832480",
    "end": "835200"
  },
  {
    "text": "reboot to exit the rdp restricted state",
    "start": "835200",
    "end": "838079"
  },
  {
    "text": "and we can do that time and time again",
    "start": "838079",
    "end": "841120"
  },
  {
    "text": "um",
    "start": "841120",
    "end": "842079"
  },
  {
    "text": "we can do that time and time again uh",
    "start": "842079",
    "end": "844160"
  },
  {
    "text": "each time for a different chunk and",
    "start": "844160",
    "end": "845360"
  },
  {
    "text": "extract the whole film",
    "start": "845360",
    "end": "848240"
  },
  {
    "text": "but to check the viability of this",
    "start": "848240",
    "end": "849760"
  },
  {
    "text": "approach",
    "start": "849760",
    "end": "850959"
  },
  {
    "text": "each iteration requires a lot of human",
    "start": "850959",
    "end": "853120"
  },
  {
    "text": "interaction like timing for the correct",
    "start": "853120",
    "end": "855360"
  },
  {
    "text": "chunk pressing of physical buttons to",
    "start": "855360",
    "end": "858240"
  },
  {
    "text": "initiate the update and pulling out the",
    "start": "858240",
    "end": "860320"
  },
  {
    "text": "battery for the hard reboot",
    "start": "860320",
    "end": "862639"
  },
  {
    "text": "each iteration like that requires about",
    "start": "862639",
    "end": "864720"
  },
  {
    "text": "five minutes",
    "start": "864720",
    "end": "866240"
  },
  {
    "text": "and even if we do get a different chunk",
    "start": "866240",
    "end": "868560"
  },
  {
    "text": "each iteration there are about 1200",
    "start": "868560",
    "end": "870959"
  },
  {
    "text": "chunks in total so to summarize all of",
    "start": "870959",
    "end": "873519"
  },
  {
    "text": "this it's going to take us weeks of",
    "start": "873519",
    "end": "875680"
  },
  {
    "text": "grinding to extract the firmware",
    "start": "875680",
    "end": "879040"
  },
  {
    "text": "so we tried this approach we used a",
    "start": "879040",
    "end": "881600"
  },
  {
    "text": "raspberry pi to control all of the",
    "start": "881600",
    "end": "883279"
  },
  {
    "text": "elements which are",
    "start": "883279",
    "end": "885519"
  },
  {
    "text": "the power pins of the stock instead of",
    "start": "885519",
    "end": "887680"
  },
  {
    "text": "pulling out the battery",
    "start": "887680",
    "end": "889199"
  },
  {
    "text": "the electrical signal of the buttons",
    "start": "889199",
    "end": "891199"
  },
  {
    "text": "instead of pressing them",
    "start": "891199",
    "end": "893120"
  },
  {
    "text": "the debug interface to dump the ram and",
    "start": "893120",
    "end": "895680"
  },
  {
    "text": "timing with better precision that we",
    "start": "895680",
    "end": "897680"
  },
  {
    "text": "could ever get manually",
    "start": "897680",
    "end": "899680"
  },
  {
    "text": "on the right you can take a look at our",
    "start": "899680",
    "end": "901199"
  },
  {
    "text": "frankenstein setup which you can read",
    "start": "901199",
    "end": "903040"
  },
  {
    "text": "more about in the white paper",
    "start": "903040",
    "end": "905440"
  },
  {
    "text": "so",
    "start": "905440",
    "end": "906399"
  },
  {
    "text": "after a night of running this setup",
    "start": "906399",
    "end": "909440"
  },
  {
    "text": "we successfully got the decrypted",
    "start": "909440",
    "end": "911199"
  },
  {
    "text": "firmware and now gal will explain what",
    "start": "911199",
    "end": "913279"
  },
  {
    "text": "we found over there",
    "start": "913279",
    "end": "916160"
  },
  {
    "text": "okay thank you",
    "start": "917120",
    "end": "920000"
  },
  {
    "text": "okay so guess what we found there in the",
    "start": "920000",
    "end": "922240"
  },
  {
    "text": "code we found our beloved nano ssl",
    "start": "922240",
    "end": "924160"
  },
  {
    "text": "package",
    "start": "924160",
    "end": "925279"
  },
  {
    "text": "and",
    "start": "925279",
    "end": "926800"
  },
  {
    "text": "you can see here",
    "start": "926800",
    "end": "928320"
  },
  {
    "text": "a usage of this nano ssl receive",
    "start": "928320",
    "end": "930560"
  },
  {
    "text": "function and actually this is the only",
    "start": "930560",
    "end": "932079"
  },
  {
    "text": "usage in the entire code of the ups and",
    "start": "932079",
    "end": "935040"
  },
  {
    "text": "this is",
    "start": "935040",
    "end": "936720"
  },
  {
    "text": "a good approach to have a concentrated",
    "start": "936720",
    "end": "938320"
  },
  {
    "text": "usage because this way you have to",
    "start": "938320",
    "end": "940240"
  },
  {
    "text": "handle the",
    "start": "940240",
    "end": "941519"
  },
  {
    "text": "return or only once",
    "start": "941519",
    "end": "943920"
  },
  {
    "text": "but",
    "start": "943920",
    "end": "944800"
  },
  {
    "text": "surprisingly enough uh apc forgot to",
    "start": "944800",
    "end": "947199"
  },
  {
    "text": "handle",
    "start": "947199",
    "end": "948240"
  },
  {
    "text": "the",
    "start": "948240",
    "end": "948959"
  },
  {
    "text": "the return error number in their only",
    "start": "948959",
    "end": "950880"
  },
  {
    "text": "usage and we already know the",
    "start": "950880",
    "end": "952639"
  },
  {
    "text": "consequences of that",
    "start": "952639",
    "end": "955680"
  },
  {
    "text": "not handling your errors i mean in this",
    "start": "955680",
    "end": "957920"
  },
  {
    "text": "case",
    "start": "957920",
    "end": "958720"
  },
  {
    "text": "tls state confusion which means",
    "start": "958720",
    "end": "961600"
  },
  {
    "text": "a heap overflow and indeed we were able",
    "start": "961600",
    "end": "963360"
  },
  {
    "text": "to find two",
    "start": "963360",
    "end": "965120"
  },
  {
    "text": "critical pre-authentication",
    "start": "965120",
    "end": "966959"
  },
  {
    "text": "vulnerabilities",
    "start": "966959",
    "end": "969519"
  },
  {
    "text": "and",
    "start": "969519",
    "end": "970399"
  },
  {
    "text": "by that we can safely say that we have a",
    "start": "970399",
    "end": "972639"
  },
  {
    "text": "three out of three success rate of",
    "start": "972639",
    "end": "974399"
  },
  {
    "text": "founding uh",
    "start": "974399",
    "end": "976399"
  },
  {
    "text": "critical vulnerabilities stems from the",
    "start": "976399",
    "end": "980000"
  },
  {
    "text": "basically the same trick of the",
    "start": "980000",
    "end": "982480"
  },
  {
    "text": "missing error check of nano ssl",
    "start": "982480",
    "end": "985360"
  },
  {
    "text": "but as i mentioned we found two",
    "start": "985360",
    "end": "987600"
  },
  {
    "text": "vulnerabilities",
    "start": "987600",
    "end": "988880"
  },
  {
    "text": "and the first is the one that you're",
    "start": "988880",
    "end": "990880"
  },
  {
    "text": "already familiar with the one from the",
    "start": "990880",
    "end": "992560"
  },
  {
    "text": "aruba the hip overflow",
    "start": "992560",
    "end": "994320"
  },
  {
    "text": "but in some cases you want a more",
    "start": "994320",
    "end": "996800"
  },
  {
    "text": "elegant vulnerability a one that",
    "start": "996800",
    "end": "999680"
  },
  {
    "text": "does not corrupt any memory",
    "start": "999680",
    "end": "1001920"
  },
  {
    "text": "and we will show you our state confusion",
    "start": "1001920",
    "end": "1004880"
  },
  {
    "text": "in tls can go even wilder",
    "start": "1004880",
    "end": "1007839"
  },
  {
    "text": "and in this case we found way uh to",
    "start": "1007839",
    "end": "1009839"
  },
  {
    "text": "bypass the authentication of the smart",
    "start": "1009839",
    "end": "1011519"
  },
  {
    "text": "connect feature of the",
    "start": "1011519",
    "end": "1013600"
  },
  {
    "text": "of the ups that connect it to the uh",
    "start": "1013600",
    "end": "1016399"
  },
  {
    "text": "to the management cloud and from there",
    "start": "1016399",
    "end": "1018480"
  },
  {
    "text": "we",
    "start": "1018480",
    "end": "1019199"
  },
  {
    "text": "could masquerade as a verified cloud and",
    "start": "1019199",
    "end": "1021440"
  },
  {
    "text": "do whatever the cloud does and to",
    "start": "1021440",
    "end": "1024558"
  },
  {
    "text": "understand this feature uh you first",
    "start": "1024559",
    "end": "1026959"
  },
  {
    "text": "have to be familiar with kind of a niche",
    "start": "1026959",
    "end": "1028400"
  },
  {
    "text": "tls feature called tls resumption",
    "start": "1028400",
    "end": "1031438"
  },
  {
    "text": "and this feature allows parties to uh",
    "start": "1031439",
    "end": "1035120"
  },
  {
    "text": "exchange session id in the",
    "start": "1035120",
    "end": "1037038"
  },
  {
    "text": "authentication phase",
    "start": "1037039",
    "end": "1038720"
  },
  {
    "text": "and to store it alongside the generated",
    "start": "1038720",
    "end": "1041280"
  },
  {
    "text": "master secret that it is used for the",
    "start": "1041280",
    "end": "1043760"
  },
  {
    "text": "encryption and decryption of the",
    "start": "1043760",
    "end": "1045280"
  },
  {
    "text": "communication phase",
    "start": "1045280",
    "end": "1046798"
  },
  {
    "text": "and",
    "start": "1046799",
    "end": "1048000"
  },
  {
    "text": "when the two parties want to",
    "start": "1048000",
    "end": "1049600"
  },
  {
    "text": "re-establish their connection",
    "start": "1049600",
    "end": "1051520"
  },
  {
    "text": "all they need to do is to uh to present",
    "start": "1051520",
    "end": "1054480"
  },
  {
    "text": "the same session id",
    "start": "1054480",
    "end": "1056480"
  },
  {
    "text": "again and from there they can fetch the",
    "start": "1056480",
    "end": "1058799"
  },
  {
    "text": "master secret",
    "start": "1058799",
    "end": "1060960"
  },
  {
    "text": "from their cache and hop straight the",
    "start": "1060960",
    "end": "1063360"
  },
  {
    "text": "communication phase",
    "start": "1063360",
    "end": "1065280"
  },
  {
    "text": "but this feature has a hidden risk",
    "start": "1065280",
    "end": "1068000"
  },
  {
    "text": "within it because if one side somehow",
    "start": "1068000",
    "end": "1070559"
  },
  {
    "text": "able to uh is able to persuade the other",
    "start": "1070559",
    "end": "1073200"
  },
  {
    "text": "one",
    "start": "1073200",
    "end": "1074000"
  },
  {
    "text": "that the resumption flow should be taken",
    "start": "1074000",
    "end": "1077280"
  },
  {
    "text": "although the first authentication phase",
    "start": "1077280",
    "end": "1079679"
  },
  {
    "text": "didn't take place before",
    "start": "1079679",
    "end": "1081440"
  },
  {
    "text": "it means that the master seeker that it",
    "start": "1081440",
    "end": "1083679"
  },
  {
    "text": "will be used was not generated and in in",
    "start": "1083679",
    "end": "1086160"
  },
  {
    "text": "times it could be a predictable",
    "start": "1086160",
    "end": "1088640"
  },
  {
    "text": "not so secret uh",
    "start": "1088640",
    "end": "1090400"
  },
  {
    "text": "master secret and",
    "start": "1090400",
    "end": "1092720"
  },
  {
    "text": "this way the malicious side can uh",
    "start": "1092720",
    "end": "1095280"
  },
  {
    "text": "bypass the authentication phase",
    "start": "1095280",
    "end": "1098240"
  },
  {
    "text": "and in our case we know that the nano",
    "start": "1098240",
    "end": "1100080"
  },
  {
    "text": "ssl uh",
    "start": "1100080",
    "end": "1102240"
  },
  {
    "text": "missing handling bug allows uh uh that",
    "start": "1102240",
    "end": "1105520"
  },
  {
    "text": "if we store the session id which happens",
    "start": "1105520",
    "end": "1108160"
  },
  {
    "text": "during the nano ssl landshake",
    "start": "1108160",
    "end": "1110480"
  },
  {
    "text": "and fails right after",
    "start": "1110480",
    "end": "1112320"
  },
  {
    "text": "the session keeps hanging and it means",
    "start": "1112320",
    "end": "1114480"
  },
  {
    "text": "that the master secret that is generated",
    "start": "1114480",
    "end": "1116240"
  },
  {
    "text": "only after the handshake",
    "start": "1116240",
    "end": "1118080"
  },
  {
    "text": "will not be generated by that point and",
    "start": "1118080",
    "end": "1120160"
  },
  {
    "text": "the session id will be waiting in the",
    "start": "1120160",
    "end": "1121919"
  },
  {
    "text": "ssl object for the next handshake packet",
    "start": "1121919",
    "end": "1124559"
  },
  {
    "text": "and we can think of a malicious flow",
    "start": "1124559",
    "end": "1127200"
  },
  {
    "text": "like this one",
    "start": "1127200",
    "end": "1128320"
  },
  {
    "text": "we send a bad handshake with a session",
    "start": "1128320",
    "end": "1130240"
  },
  {
    "text": "id of our choice",
    "start": "1130240",
    "end": "1131840"
  },
  {
    "text": "and it fails and we send a valid",
    "start": "1131840",
    "end": "1135120"
  },
  {
    "text": "handshake packet for the resumption flow",
    "start": "1135120",
    "end": "1136960"
  },
  {
    "text": "is the same session id and the client is",
    "start": "1136960",
    "end": "1139039"
  },
  {
    "text": "fooled to think this is a resumption",
    "start": "1139039",
    "end": "1140640"
  },
  {
    "text": "flow and it fetches a master secret",
    "start": "1140640",
    "end": "1143679"
  },
  {
    "text": "which in this case is a",
    "start": "1143679",
    "end": "1146000"
  },
  {
    "text": "the initialization value of the object",
    "start": "1146000",
    "end": "1148240"
  },
  {
    "text": "of zeros",
    "start": "1148240",
    "end": "1149679"
  },
  {
    "text": "which the attacker can predict",
    "start": "1149679",
    "end": "1151679"
  },
  {
    "text": "and this is how it looks step by step",
    "start": "1151679",
    "end": "1155039"
  },
  {
    "text": "active portal we can move laterally so",
    "start": "1155039",
    "end": "1157440"
  },
  {
    "text": "for the next step i'll introduce you",
    "start": "1157440",
    "end": "1158799"
  },
  {
    "text": "with the new",
    "start": "1158799",
    "end": "1160240"
  },
  {
    "text": "actor in this demo and this is the ups",
    "start": "1160240",
    "end": "1162840"
  },
  {
    "text": "that we are gonna make some really bad",
    "start": "1162840",
    "end": "1166559"
  },
  {
    "text": "things too",
    "start": "1166559",
    "end": "1168960"
  },
  {
    "text": "and as you can see um it's connected to",
    "start": "1168960",
    "end": "1171919"
  },
  {
    "text": "a lamp it's a very important lamp it",
    "start": "1171919",
    "end": "1173679"
  },
  {
    "text": "cannot tolerate any downtime never so",
    "start": "1173679",
    "end": "1176559"
  },
  {
    "text": "it's connected to a it's connected to a",
    "start": "1176559",
    "end": "1178240"
  },
  {
    "text": "ups device and it represents the most",
    "start": "1178240",
    "end": "1180880"
  },
  {
    "text": "important data centers that you can",
    "start": "1180880",
    "end": "1182320"
  },
  {
    "text": "dream of that they cannot tolerate any",
    "start": "1182320",
    "end": "1184160"
  },
  {
    "text": "downtime or mri machines or whatever",
    "start": "1184160",
    "end": "1186880"
  },
  {
    "text": "and now norm will look for it in in with",
    "start": "1186880",
    "end": "1190000"
  },
  {
    "text": "arp command as a neighbor and he can't",
    "start": "1190000",
    "end": "1191919"
  },
  {
    "text": "find it",
    "start": "1191919",
    "end": "1193120"
  },
  {
    "text": "and",
    "start": "1193120",
    "end": "1194160"
  },
  {
    "text": "why is it possible because",
    "start": "1194160",
    "end": "1196640"
  },
  {
    "text": "of segmentation probably so let's see",
    "start": "1196640",
    "end": "1198960"
  },
  {
    "text": "what vlans are configured in this switch",
    "start": "1198960",
    "end": "1202480"
  },
  {
    "text": "and as you can see we have two",
    "start": "1202480",
    "end": "1204799"
  },
  {
    "text": "vlans one is the guest villain and one",
    "start": "1204799",
    "end": "1206799"
  },
  {
    "text": "is a secret corporate villain that",
    "start": "1206799",
    "end": "1208240"
  },
  {
    "text": "sounds really interesting",
    "start": "1208240",
    "end": "1210400"
  },
  {
    "text": "our port 15",
    "start": "1210400",
    "end": "1213120"
  },
  {
    "text": "is connected to the guest vlan as we",
    "start": "1213120",
    "end": "1215200"
  },
  {
    "text": "could predict",
    "start": "1215200",
    "end": "1216480"
  },
  {
    "text": "so now we will move laterally we'll",
    "start": "1216480",
    "end": "1218400"
  },
  {
    "text": "disable the the secret corporate vlan",
    "start": "1218400",
    "end": "1220480"
  },
  {
    "text": "and we will connect all the ports to uh",
    "start": "1220480",
    "end": "1223360"
  },
  {
    "text": "the same villain so they can be accessed",
    "start": "1223360",
    "end": "1227440"
  },
  {
    "text": "from the guest villain from our",
    "start": "1227679",
    "end": "1230320"
  },
  {
    "text": "attacking computer",
    "start": "1230320",
    "end": "1232400"
  },
  {
    "text": "and now we will attempt to run the arp",
    "start": "1232400",
    "end": "1234960"
  },
  {
    "text": "command again and we expect to find the",
    "start": "1234960",
    "end": "1237280"
  },
  {
    "text": "ups",
    "start": "1237280",
    "end": "1238559"
  },
  {
    "text": "and this might take up to okay it",
    "start": "1238559",
    "end": "1240799"
  },
  {
    "text": "happened really quick",
    "start": "1240799",
    "end": "1242559"
  },
  {
    "text": "and as you can see this new device is",
    "start": "1242559",
    "end": "1245760"
  },
  {
    "text": "the ups",
    "start": "1245760",
    "end": "1247360"
  },
  {
    "text": "and this is the ip",
    "start": "1247360",
    "end": "1249679"
  },
  {
    "text": "in swiss 28",
    "start": "1249679",
    "end": "1251280"
  },
  {
    "text": "and",
    "start": "1251280",
    "end": "1252240"
  },
  {
    "text": "we will launch now the ups attack as we",
    "start": "1252240",
    "end": "1255120"
  },
  {
    "text": "promised",
    "start": "1255120",
    "end": "1256320"
  },
  {
    "text": "and",
    "start": "1256320",
    "end": "1257200"
  },
  {
    "text": "by controlling the switch we control the",
    "start": "1257200",
    "end": "1259200"
  },
  {
    "text": "layer 2 traffic and by that we can",
    "start": "1259200",
    "end": "1261280"
  },
  {
    "text": "navigate uh all the uh the the traffic",
    "start": "1261280",
    "end": "1264400"
  },
  {
    "text": "that goes out of the ups directly to our",
    "start": "1264400",
    "end": "1267840"
  },
  {
    "text": "uh attacker computer to the cnc",
    "start": "1267840",
    "end": "1270400"
  },
  {
    "text": "and by and by that we can launch our",
    "start": "1270400",
    "end": "1273039"
  },
  {
    "text": "authentication bypass attack as as i",
    "start": "1273039",
    "end": "1274960"
  },
  {
    "text": "showed you and install our malicious",
    "start": "1274960",
    "end": "1277280"
  },
  {
    "text": "firmware but",
    "start": "1277280",
    "end": "1278640"
  },
  {
    "text": "this may take up to 10 minutes so i",
    "start": "1278640",
    "end": "1280400"
  },
  {
    "text": "won't do the do this right now um i",
    "start": "1280400",
    "end": "1283280"
  },
  {
    "text": "already done it uh earlier today and you",
    "start": "1283280",
    "end": "1287039"
  },
  {
    "text": "can see the demonstration of the full",
    "start": "1287039",
    "end": "1288880"
  },
  {
    "text": "installation in our website",
    "start": "1288880",
    "end": "1291280"
  },
  {
    "text": "um what we do now uh what we did now is",
    "start": "1291280",
    "end": "1293840"
  },
  {
    "text": "waiting for connection of the malicious",
    "start": "1293840",
    "end": "1295679"
  },
  {
    "text": "trojan that we installed on the ups",
    "start": "1295679",
    "end": "1298240"
  },
  {
    "text": "and we can launch the physical attack",
    "start": "1298240",
    "end": "1300400"
  },
  {
    "text": "now so we will start with the most",
    "start": "1300400",
    "end": "1302799"
  },
  {
    "text": "obvious attack we'll turn the lamp off",
    "start": "1302799",
    "end": "1305520"
  },
  {
    "text": "we'll turn all the connected power",
    "start": "1305520",
    "end": "1307760"
  },
  {
    "text": "supplied devices off as you can see and",
    "start": "1307760",
    "end": "1311600"
  },
  {
    "text": "this is this might not look dramatic",
    "start": "1311600",
    "end": "1313280"
  },
  {
    "text": "because we just turned off a lamp here",
    "start": "1313280",
    "end": "1315440"
  },
  {
    "text": "but imagine that this is the most",
    "start": "1315440",
    "end": "1318080"
  },
  {
    "text": "important",
    "start": "1318080",
    "end": "1319679"
  },
  {
    "text": "resources of the entire network that we",
    "start": "1319679",
    "end": "1321840"
  },
  {
    "text": "just shut down",
    "start": "1321840",
    "end": "1323600"
  },
  {
    "text": "and",
    "start": "1323600",
    "end": "1325280"
  },
  {
    "text": "to make it even cooler we will now show",
    "start": "1325280",
    "end": "1327200"
  },
  {
    "text": "you the overvoltage attack with the",
    "start": "1327200",
    "end": "1329760"
  },
  {
    "text": "square wave",
    "start": "1329760",
    "end": "1333080"
  },
  {
    "text": "okay",
    "start": "1335440",
    "end": "1336400"
  },
  {
    "text": "so as you can see it shines much much",
    "start": "1336400",
    "end": "1339200"
  },
  {
    "text": "more brighter because of the over",
    "start": "1339200",
    "end": "1340559"
  },
  {
    "text": "voltage and if you hear",
    "start": "1340559",
    "end": "1342880"
  },
  {
    "text": "there is a quite annoying sound",
    "start": "1342880",
    "end": "1346720"
  },
  {
    "text": "from the",
    "start": "1346720",
    "end": "1347760"
  },
  {
    "text": "from the ups and this is because it is",
    "start": "1347760",
    "end": "1350640"
  },
  {
    "text": "not supposed to supply such a high",
    "start": "1350640",
    "end": "1352720"
  },
  {
    "text": "voltage and",
    "start": "1352720",
    "end": "1354320"
  },
  {
    "text": "not mentioning that it is not",
    "start": "1354320",
    "end": "1356400"
  },
  {
    "text": "it is not designed to supply a square",
    "start": "1356400",
    "end": "1359520"
  },
  {
    "text": "waveform",
    "start": "1359520",
    "end": "1360799"
  },
  {
    "text": "which can damage both the ups itself and",
    "start": "1360799",
    "end": "1363360"
  },
  {
    "text": "the connected devices as i explained",
    "start": "1363360",
    "end": "1365520"
  },
  {
    "text": "but now for the joule of the crown let's",
    "start": "1365520",
    "end": "1367520"
  },
  {
    "text": "toast the ups",
    "start": "1367520",
    "end": "1369679"
  },
  {
    "text": "and",
    "start": "1369679",
    "end": "1371039"
  },
  {
    "text": "this is the last attack simply because",
    "start": "1371039",
    "end": "1373360"
  },
  {
    "text": "the ups",
    "start": "1373360",
    "end": "1374720"
  },
  {
    "text": "is not going to work after this",
    "start": "1374720",
    "end": "1377440"
  },
  {
    "text": "do you hear this",
    "start": "1377440",
    "end": "1380240"
  },
  {
    "text": "so this beep means that",
    "start": "1381280",
    "end": "1385039"
  },
  {
    "text": "the ups is suffering right now so we",
    "start": "1385039",
    "end": "1387600"
  },
  {
    "text": "will pray for him together",
    "start": "1387600",
    "end": "1390159"
  },
  {
    "text": "and",
    "start": "1390159",
    "end": "1392480"
  },
  {
    "text": "in a minute or so",
    "start": "1393200",
    "end": "1396320"
  },
  {
    "text": "it's supposed to explode and",
    "start": "1396559",
    "end": "1399919"
  },
  {
    "text": "be covered in smoke",
    "start": "1399919",
    "end": "1403720"
  },
  {
    "text": "if it will work",
    "start": "1404159",
    "end": "1406960"
  },
  {
    "text": "okay",
    "start": "1411840",
    "end": "1414158"
  },
  {
    "text": "it should happen",
    "start": "1414320",
    "end": "1415520"
  },
  {
    "text": "any any minute",
    "start": "1415520",
    "end": "1416960"
  },
  {
    "text": "any second",
    "start": "1416960",
    "end": "1419600"
  },
  {
    "text": "and right right just before it is",
    "start": "1421440",
    "end": "1424000"
  },
  {
    "text": "covered with smoke you will hear",
    "start": "1424000",
    "end": "1425840"
  },
  {
    "text": "a",
    "start": "1425840",
    "end": "1426799"
  },
  {
    "text": "sound of explosion",
    "start": "1426799",
    "end": "1428400"
  },
  {
    "text": "not a very loud one but",
    "start": "1428400",
    "end": "1431840"
  },
  {
    "text": "find cover",
    "start": "1434559",
    "end": "1436559"
  },
  {
    "text": "that's the the last opportunity for you",
    "start": "1436559",
    "end": "1438559"
  },
  {
    "text": "to find cover",
    "start": "1438559",
    "end": "1441960"
  },
  {
    "text": "yeah the air conditioning system is uh",
    "start": "1447200",
    "end": "1449679"
  },
  {
    "text": "so strong here so it takes okay okay i",
    "start": "1449679",
    "end": "1452320"
  },
  {
    "text": "can hear that",
    "start": "1452320",
    "end": "1455720"
  },
  {
    "text": "[Applause]",
    "start": "1461160",
    "end": "1467200"
  },
  {
    "text": "and you can smell this too i think",
    "start": "1467200",
    "end": "1469039"
  },
  {
    "text": "because it is not just a regular smoke",
    "start": "1469039",
    "end": "1471279"
  },
  {
    "text": "it's an electrolyte material",
    "start": "1471279",
    "end": "1473840"
  },
  {
    "text": "it's really healthy",
    "start": "1473840",
    "end": "1476720"
  },
  {
    "text": "you have masks so if you don't feel",
    "start": "1477360",
    "end": "1479679"
  },
  {
    "text": "comfortable with it",
    "start": "1479679",
    "end": "1483399"
  },
  {
    "text": "okay so basically that's it um",
    "start": "1491120",
    "end": "1494799"
  },
  {
    "text": "there's going to be more smoke until i",
    "start": "1494799",
    "end": "1496799"
  },
  {
    "text": "don't know what",
    "start": "1496799",
    "end": "1498159"
  },
  {
    "text": "we can check together i hope the battery",
    "start": "1498159",
    "end": "1501039"
  },
  {
    "text": "won't explode",
    "start": "1501039",
    "end": "1504278"
  },
  {
    "text": "[Applause]",
    "start": "1506300",
    "end": "1511280"
  },
  {
    "text": "okay that's enough smoke",
    "start": "1517279",
    "end": "1520320"
  },
  {
    "text": "that's all the effects we need",
    "start": "1522480",
    "end": "1525919"
  },
  {
    "text": "so after this exciting demo uh which",
    "start": "1525919",
    "end": "1529360"
  },
  {
    "text": "which you just seen",
    "start": "1529360",
    "end": "1531120"
  },
  {
    "text": "let's recap uh let's look up how it",
    "start": "1531120",
    "end": "1533120"
  },
  {
    "text": "looks like in the network perspective",
    "start": "1533120",
    "end": "1536240"
  },
  {
    "text": "first the attacker will try to enter the",
    "start": "1536240",
    "end": "1538559"
  },
  {
    "text": "network through the switch and will be",
    "start": "1538559",
    "end": "1540559"
  },
  {
    "text": "prompted with a captive portal interface",
    "start": "1540559",
    "end": "1544080"
  },
  {
    "text": "from there they can respond with this",
    "start": "1544080",
    "end": "1546000"
  },
  {
    "text": "beautiful logo and take over the switch",
    "start": "1546000",
    "end": "1548960"
  },
  {
    "text": "and just",
    "start": "1548960",
    "end": "1550320"
  },
  {
    "text": "enter the network without any problems",
    "start": "1550320",
    "end": "1552799"
  },
  {
    "text": "they can also hop into the internal",
    "start": "1552799",
    "end": "1556640"
  },
  {
    "text": "um very",
    "start": "1556640",
    "end": "1558480"
  },
  {
    "text": "secret network and access all sorts of",
    "start": "1558480",
    "end": "1561919"
  },
  {
    "text": "sensitive information and sensitive",
    "start": "1561919",
    "end": "1563679"
  },
  {
    "text": "devices",
    "start": "1563679",
    "end": "1564960"
  },
  {
    "text": "they can also use the same logo to take",
    "start": "1564960",
    "end": "1567440"
  },
  {
    "text": "over the ups and launch attacks against",
    "start": "1567440",
    "end": "1569840"
  },
  {
    "text": "connected devices or even the ups itself",
    "start": "1569840",
    "end": "1572799"
  },
  {
    "text": "as we've just seen live on stage",
    "start": "1572799",
    "end": "1576799"
  },
  {
    "text": "and",
    "start": "1576799",
    "end": "1578240"
  },
  {
    "text": "if we if we want to summarize after",
    "start": "1578240",
    "end": "1580559"
  },
  {
    "text": "these three devices which we've seen",
    "start": "1580559",
    "end": "1583760"
  },
  {
    "text": "all suffer from a remote core execution",
    "start": "1583760",
    "end": "1585679"
  },
  {
    "text": "vulnerability that stems from",
    "start": "1585679",
    "end": "1588080"
  },
  {
    "text": "nano ssl",
    "start": "1588080",
    "end": "1590400"
  },
  {
    "text": "there are many more users from okana",
    "start": "1590400",
    "end": "1592799"
  },
  {
    "text": "nano ssl and all of them could possibly",
    "start": "1592799",
    "end": "1595840"
  },
  {
    "text": "have made the same mistake and could",
    "start": "1595840",
    "end": "1597279"
  },
  {
    "text": "possibly suffer from the same",
    "start": "1597279",
    "end": "1600320"
  },
  {
    "text": "simple the same vulnerability and as we",
    "start": "1600320",
    "end": "1603200"
  },
  {
    "text": "said shared code means shared risk",
    "start": "1603200",
    "end": "1606960"
  },
  {
    "text": "and if you ask yourself how you can be",
    "start": "1606960",
    "end": "1609360"
  },
  {
    "text": "protected from such attacks there are",
    "start": "1609360",
    "end": "1611600"
  },
  {
    "text": "three main paths you can take",
    "start": "1611600",
    "end": "1613039"
  },
  {
    "text": "simultaneously",
    "start": "1613039",
    "end": "1614480"
  },
  {
    "text": "the first is of course apply patches",
    "start": "1614480",
    "end": "1616559"
  },
  {
    "text": "where they are applicable",
    "start": "1616559",
    "end": "1618240"
  },
  {
    "text": "the second is to minimize that attack",
    "start": "1618240",
    "end": "1620400"
  },
  {
    "text": "surface when when you can",
    "start": "1620400",
    "end": "1622720"
  },
  {
    "text": "in our case it means that if you don't",
    "start": "1622720",
    "end": "1624799"
  },
  {
    "text": "use the smart connect feature of the ups",
    "start": "1624799",
    "end": "1627440"
  },
  {
    "text": "you should disconnect it",
    "start": "1627440",
    "end": "1629440"
  },
  {
    "text": "and the last uh thing you can do is to",
    "start": "1629440",
    "end": "1631919"
  },
  {
    "text": "monitor communication so you can know",
    "start": "1631919",
    "end": "1634320"
  },
  {
    "text": "which devices you have which are",
    "start": "1634320",
    "end": "1636000"
  },
  {
    "text": "vulnerable",
    "start": "1636000",
    "end": "1637200"
  },
  {
    "text": "and if",
    "start": "1637200",
    "end": "1638400"
  },
  {
    "text": "and be alerted if such an attack",
    "start": "1638400",
    "end": "1640799"
  },
  {
    "text": "comes your way",
    "start": "1640799",
    "end": "1643279"
  },
  {
    "text": "and to summarize uh these are our three",
    "start": "1643279",
    "end": "1646080"
  },
  {
    "text": "main takeaways from this talk",
    "start": "1646080",
    "end": "1649360"
  },
  {
    "text": "external libraries could be a weak spot",
    "start": "1649360",
    "end": "1651760"
  },
  {
    "text": "as we said shield code means shared risk",
    "start": "1651760",
    "end": "1654960"
  },
  {
    "text": "and knowing how to use the library is",
    "start": "1654960",
    "end": "1657520"
  },
  {
    "text": "just as important as choosing one",
    "start": "1657520",
    "end": "1661120"
  },
  {
    "text": "security by obscurity is obsolete and",
    "start": "1661120",
    "end": "1664159"
  },
  {
    "text": "because as we've just seen",
    "start": "1664159",
    "end": "1666480"
  },
  {
    "text": "closed source and encryption",
    "start": "1666480",
    "end": "1669520"
  },
  {
    "text": "would not stop the determined the",
    "start": "1669520",
    "end": "1671520"
  },
  {
    "text": "attackers because the terminal attackers",
    "start": "1671520",
    "end": "1673679"
  },
  {
    "text": "would always find a way",
    "start": "1673679",
    "end": "1676080"
  },
  {
    "text": "and lastly",
    "start": "1676080",
    "end": "1677919"
  },
  {
    "text": "when you design a network you should",
    "start": "1677919",
    "end": "1679440"
  },
  {
    "text": "take the physical aspect of devices into",
    "start": "1679440",
    "end": "1681840"
  },
  {
    "text": "account when you consider the security",
    "start": "1681840",
    "end": "1683679"
  },
  {
    "text": "aspects",
    "start": "1683679",
    "end": "1684720"
  },
  {
    "text": "because um lateral movement and data",
    "start": "1684720",
    "end": "1687279"
  },
  {
    "text": "exfiltration are very serious issues but",
    "start": "1687279",
    "end": "1690399"
  },
  {
    "text": "some devices hold the literal power to",
    "start": "1690399",
    "end": "1692640"
  },
  {
    "text": "cause damage in ways that are all too",
    "start": "1692640",
    "end": "1694559"
  },
  {
    "text": "easy to disregard or in other words",
    "start": "1694559",
    "end": "1697919"
  },
  {
    "text": "thank you all for listening",
    "start": "1697919",
    "end": "1699600"
  },
  {
    "text": "i hope you take these points into",
    "start": "1699600",
    "end": "1701360"
  },
  {
    "text": "account",
    "start": "1701360",
    "end": "1702640"
  },
  {
    "text": "and that's it",
    "start": "1702640",
    "end": "1706520"
  },
  {
    "text": "[Music]",
    "start": "1712420",
    "end": "1713520"
  },
  {
    "text": "you",
    "start": "1713520",
    "end": "1715600"
  }
]