[
  {
    "start": "0",
    "end": "16000"
  },
  {
    "text": "I'm happy to be here and to present our research on P seen plcs and uh the fact",
    "start": "80",
    "end": "6919"
  },
  {
    "text": "that we were able to write a warm running on these plcs and um well who",
    "start": "6919",
    "end": "12519"
  },
  {
    "text": "are we uh oh sorry where are we well we're a small German based company uh we",
    "start": "12519",
    "end": "19920"
  },
  {
    "start": "16000",
    "end": "16000"
  },
  {
    "text": "are doing mostly Linux security but a lot of uh pen testing and the embedded",
    "start": "19920",
    "end": "25880"
  },
  {
    "text": "and RFID and PLC or industrial control system area as well well and um uh Mike",
    "start": "25880",
    "end": "33120"
  },
  {
    "text": "here um is doing mostly the PLC or industrial control system research uh at",
    "start": "33120",
    "end": "38920"
  },
  {
    "text": "my company and we would like to present you now as I said our current research",
    "start": "38920",
    "end": "44840"
  },
  {
    "text": "on uh plcs so um at the end that's what",
    "start": "44840",
    "end": "51120"
  },
  {
    "text": "why we brought this light show with us um actually we were quite happy that we got it twice through security and",
    "start": "51120",
    "end": "56640"
  },
  {
    "text": "Customs at two airports um and uh weren't picked out and uh uh questioned",
    "start": "56640",
    "end": "63519"
  },
  {
    "text": "on these uh these funny systems um at the end we will show you that we have a",
    "start": "63519",
    "end": "70119"
  },
  {
    "text": "worm which is capable of actually propagating through these um Sean plcs",
    "start": "70119",
    "end": "78640"
  },
  {
    "text": "without any support by a PC or any different system so it's a warm which is",
    "start": "78640",
    "end": "84079"
  },
  {
    "text": "only running on the PLC will infect the first one and then this PLC will start",
    "start": "84079",
    "end": "90280"
  },
  {
    "text": "infecting the rest of the plcs uh in this little plant we've got here and um",
    "start": "90280",
    "end": "97360"
  },
  {
    "text": "to to take the takeaway away already at the beginning uh the idea behind this is",
    "start": "97360",
    "end": "105119"
  },
  {
    "text": "that the plcs are not the target of the attack at the end but the plcs might",
    "start": "105119",
    "end": "111759"
  },
  {
    "text": "even be the source of the attack so imagine a PLC which comes",
    "start": "111759",
    "end": "117000"
  },
  {
    "text": "infected uh a machine which is controll by a PLC which was infected either by",
    "start": "117000",
    "end": "122840"
  },
  {
    "text": "the vendor or maybe on the way to your plant and you install this machine in",
    "start": "122840",
    "end": "128319"
  },
  {
    "text": "your plant uh this machine May then afterwards infect your whole",
    "start": "128319",
    "end": "134160"
  },
  {
    "text": "plant because there are probably no security controls within your industrial uh Network anymore uh and the attack",
    "start": "134160",
    "end": "141239"
  },
  {
    "text": "doesn't come from the outside but the attack actually is sourced from the PLC",
    "start": "141239",
    "end": "146280"
  },
  {
    "text": "and there's as I said no PC required no other operating system required to",
    "start": "146280",
    "end": "151480"
  },
  {
    "text": "actually do the attack so uh let's see um we're demonstrating this based on a",
    "start": "151480",
    "end": "158360"
  },
  {
    "text": "seen PLC we'll talk about other winers at the end um we chose a very small seen PLC this is the smallest seen PLC which",
    "start": "158360",
    "end": "165239"
  },
  {
    "text": "is on the market today it's the S7 uh 121 it's built for very small applications uh it has got 50k of ram 1",
    "start": "165239",
    "end": "173599"
  },
  {
    "text": "megab of persistent memory it has a built in Ethernet port and it we are",
    "start": "173599",
    "end": "179000"
  },
  {
    "text": "basing our research here on the hardware revision three um which means firmware",
    "start": "179000",
    "end": "184879"
  },
  {
    "text": "version three uh which is pretty much compatible to version two and version one um the reason I'm mentioning it this",
    "start": "184879",
    "end": "192560"
  },
  {
    "text": "clearly is that the current models you can buy today uh are the revision 4 the",
    "start": "192560",
    "end": "198360"
  },
  {
    "text": "revision 4 has a newly developed protocol and the attack we're presenting",
    "start": "198360",
    "end": "203920"
  },
  {
    "text": "will not run on the current systems they will just run on the systems if you bought them maybe a year or two years",
    "start": "203920",
    "end": "210280"
  },
  {
    "text": "ago so about a year ago seens introduced a new verion anyway um to understand the whole",
    "start": "210280",
    "end": "218239"
  },
  {
    "start": "214000",
    "end": "214000"
  },
  {
    "text": "Pro the whole talk uh we will need to talk about some plcs or the way the plcs work",
    "start": "218239",
    "end": "224400"
  },
  {
    "text": "first um the way plcs work is we have the firmware which is running the user",
    "start": "224400",
    "end": "229879"
  },
  {
    "text": "application the user application is written by the electrical engineer uh to control the machine and uh this user",
    "start": "229879",
    "end": "236879"
  },
  {
    "text": "application is executed in Cycles as you can see here uh at the beginning of each cycle the",
    "start": "236879",
    "end": "242400"
  },
  {
    "text": "firmware will copy the current state of the physical inputs and outputs which are here controlling the uh lights uh",
    "start": "242400",
    "end": "249920"
  },
  {
    "text": "into a So-Cal process image and then it will execute one cycle of the user",
    "start": "249920",
    "end": "255439"
  },
  {
    "text": "application and at the end there will be some additional work done maybe some",
    "start": "255439",
    "end": "260479"
  },
  {
    "text": "communication work and then we will reduce the cycle so the user application",
    "start": "260479",
    "end": "266880"
  },
  {
    "text": "uh is as I said executed in cycles and it may not violate the so-called maximum",
    "start": "266880",
    "end": "272120"
  },
  {
    "text": "cycle time which in case of this PLC is 150 milliseconds so whenever the warm is",
    "start": "272120",
    "end": "277479"
  },
  {
    "text": "executed it may never use more than 150 milliseconds um if you want to program",
    "start": "277479",
    "end": "284600"
  },
  {
    "start": "281000",
    "end": "281000"
  },
  {
    "text": "such a thing uh plcs are programmed a little bit different than normal user",
    "start": "284600",
    "end": "290080"
  },
  {
    "text": "applications running on desktop PCS and stuff like that um each vendor usually has its own terms uh but they are mostly",
    "start": "290080",
    "end": "297919"
  },
  {
    "text": "similar uh in seen speak uh what you do is you write you code in so-called",
    "start": "297919",
    "end": "305080"
  },
  {
    "text": "blocks uh there is an organization block the organ organization block is similar",
    "start": "305080",
    "end": "311120"
  },
  {
    "text": "maybe to the main function in C it's the main entry into the program to the user",
    "start": "311120",
    "end": "317639"
  },
  {
    "text": "application then there are function blocks and functions which are quite similar to functions in any other um",
    "start": "317639",
    "end": "325319"
  },
  {
    "text": "programming language the main difference is that a function block May store for local variables which are again",
    "start": "325319",
    "end": "332560"
  },
  {
    "text": "available within the next cycle while a function uh doesn't have such access to",
    "start": "332560",
    "end": "339000"
  },
  {
    "text": "to memory and it cannot store permanently any values um then there are",
    "start": "339000",
    "end": "345400"
  },
  {
    "text": "the system function and system function blocks those are the um functions which",
    "start": "345400",
    "end": "351080"
  },
  {
    "text": "are Avail made available by the vendor in this case seens and then there are data blocks data blocks just St store",
    "start": "351080",
    "end": "358479"
  },
  {
    "text": "data uh any kind of data buin integers strings or just data blocks binary large",
    "start": "358479",
    "end": "367680"
  },
  {
    "text": "objects um if you want to develop now software",
    "start": "367680",
    "end": "373160"
  },
  {
    "start": "369000",
    "end": "369000"
  },
  {
    "text": "for these uh plc's you can choose between different programming languages they are even standardized and they're",
    "start": "373160",
    "end": "381039"
  },
  {
    "text": "available with all vendors uh which uh built these plc's uh so you can use",
    "start": "381039",
    "end": "388039"
  },
  {
    "text": "graphical languages like these letter diagrams uh but you can even use",
    "start": "388039",
    "end": "393599"
  },
  {
    "text": "just classic language a classic programming language which is called structured text which is similar to",
    "start": "393599",
    "end": "400039"
  },
  {
    "text": "Pascal and that's what we used to implement the WM um why are there these additional um",
    "start": "400039",
    "end": "407960"
  },
  {
    "text": "Electrical uh these additional graphical languages well very often these plcs have programmed by electrical engineers",
    "start": "407960",
    "end": "415520"
  },
  {
    "text": "which don't know how to program they know how to write uh to to draw an",
    "start": "415520",
    "end": "420599"
  },
  {
    "text": "electrical diagram uh but they don't know how to program in a programming language and that's why these additional",
    "start": "420599",
    "end": "426160"
  },
  {
    "text": "languages are available now if we want to implement now a worm um let's remember what a worm",
    "start": "426160",
    "end": "435199"
  },
  {
    "text": "does well a worm um needs to find its targets then needs to propagate to the",
    "start": "435199",
    "end": "442680"
  },
  {
    "text": "Target then needs to activate itself on the Target and then might carry some",
    "start": "442680",
    "end": "450000"
  },
  {
    "text": "malicious code some payload which enables the attacker to do something bad",
    "start": "450000",
    "end": "457199"
  },
  {
    "text": "on these machines and that's what we actually did that's what we um wrote for",
    "start": "457199",
    "end": "463000"
  },
  {
    "text": "these machines and uh to gives you the technical details and how this actually",
    "start": "463000",
    "end": "468599"
  },
  {
    "text": "worked and what we did to do that I will pass over now to Mike um as I said Mike",
    "start": "468599",
    "end": "474440"
  },
  {
    "text": "did most of this um uh the the analysis of these machines the analysis the",
    "start": "474440",
    "end": "479800"
  },
  {
    "text": "protocol and uh he will give you now the details on how the protocol works okay",
    "start": "479800",
    "end": "486120"
  },
  {
    "text": "thank you R um if we want to implement PSC only warm we have to implement uh",
    "start": "486120",
    "end": "492280"
  },
  {
    "text": "these different parts um in the PSC programming language and I will show you",
    "start": "492280",
    "end": "498000"
  },
  {
    "text": "how we did this step by step I will start with a Target Discovery um if you want to find Targets",
    "start": "498000",
    "end": "505120"
  },
  {
    "start": "502000",
    "end": "502000"
  },
  {
    "text": "on your network the first thing you need is a characteristic that allows you to",
    "start": "505120",
    "end": "510280"
  },
  {
    "text": "um identify your targets all uh zman S7 plcs have an open",
    "start": "510280",
    "end": "516760"
  },
  {
    "text": "TCP Port 102 um and the user cannot close this um",
    "start": "516760",
    "end": "523399"
  },
  {
    "text": "Port so it's most likely uh that you found a zans PLC if you see an open uh",
    "start": "523399",
    "end": "529560"
  },
  {
    "text": "TCP Port 102 uh on your network so the basic idea we had uh was to implement a",
    "start": "529560",
    "end": "535880"
  },
  {
    "text": "port scanner in uh the PC programming Lang language there are two function",
    "start": "535880",
    "end": "541560"
  },
  {
    "text": "block that helped us uh with this task the first is called uh ton it's open a",
    "start": "541560",
    "end": "547839"
  },
  {
    "text": "new uh TCP connection and T discon it closes a new uh it closes a TCP",
    "start": "547839",
    "end": "554680"
  },
  {
    "text": "connection uh on this slide uh we can see uh the call of the tcon function um",
    "start": "554680",
    "end": "562120"
  },
  {
    "text": "here uh the most important parameters that are passed to this uh function are",
    "start": "562120",
    "end": "567680"
  },
  {
    "text": "the IP address of your Target and the port in our case",
    "start": "567680",
    "end": "573160"
  },
  {
    "text": "102 um if we uh call this function the fum will start to process the connection",
    "start": "573160",
    "end": "579640"
  },
  {
    "text": "set up in background and in the next cycle we come back to this part of the code and call the function again and and",
    "start": "579640",
    "end": "587360"
  },
  {
    "text": "this time we can see if the connection was successful or not if the connection was successful um we uh found a new",
    "start": "587360",
    "end": "595600"
  },
  {
    "text": "seens PLC and continue with the infection if not we have have a little problem because the function does not",
    "start": "595600",
    "end": "602240"
  },
  {
    "text": "Implement a timeout that means uh we need to do it by ourself so um we have a",
    "start": "602240",
    "end": "609200"
  },
  {
    "text": "counter which is incremented every cycle and if we hit an upper limit um we say",
    "start": "609200",
    "end": "615200"
  },
  {
    "text": "okay there is no PLC behind this IP address and we try the next one before",
    "start": "615200",
    "end": "620480"
  },
  {
    "text": "we do this um we need to call the T discount block it will stop the firmware",
    "start": "620480",
    "end": "625839"
  },
  {
    "text": "to uh try to the IP address and uh then uh we increment the last bite of our 4",
    "start": "625839",
    "end": "632839"
  },
  {
    "text": "byte IP address so uh we scan a slash 24 subnet for the open port uh 102 okay",
    "start": "632839",
    "end": "642480"
  },
  {
    "text": "that is the target Discovery the next thing is the carrier",
    "start": "642480",
    "end": "648600"
  },
  {
    "start": "646000",
    "end": "646000"
  },
  {
    "text": "um if we want to implement the carrier um our basic idea was to make the PLC",
    "start": "648600",
    "end": "655760"
  },
  {
    "text": "behave like the Tia portal which is the engineering software used by",
    "start": "655760",
    "end": "662720"
  },
  {
    "text": "zans um normally the program is transferred over TCP so um we thought we",
    "start": "662720",
    "end": "669800"
  },
  {
    "text": "can Implement uh this protocol in the PLC language uh with the help of the two functions T send and T receive uh which",
    "start": "669800",
    "end": "677839"
  },
  {
    "text": "allow you to send any TCP data okay the hard part in this step is to understand",
    "start": "677839",
    "end": "684720"
  },
  {
    "start": "681000",
    "end": "681000"
  },
  {
    "text": "how the protocol uh that is used for program transfer is working",
    "start": "684720",
    "end": "690240"
  },
  {
    "text": "um we can see it is transported over tcpip then there are two more transport",
    "start": "690240",
    "end": "696279"
  },
  {
    "text": "protocols which are not covered in this talk and on the top we can see the interesting protocol it is called a s",
    "start": "696279",
    "end": "703120"
  },
  {
    "text": "comp plus um which um allows us to transfer the user program it's a binary",
    "start": "703120",
    "end": "709519"
  },
  {
    "text": "protocol it's propietary and there are huge difference between uh the old SC S7",
    "start": "709519",
    "end": "715959"
  },
  {
    "text": "protocol uh and uh this new one uh which which was introduced uh with the new",
    "start": "715959",
    "end": "725120"
  },
  {
    "text": "plcs um okay what we can see on this slide is the first message uh that is",
    "start": "725120",
    "end": "731000"
  },
  {
    "text": "sent from the Tia portal to the PLC uh if it wants to establish a new",
    "start": "731000",
    "end": "736800"
  },
  {
    "text": "connection like every message this message follows a basic layout um we can",
    "start": "736800",
    "end": "742720"
  },
  {
    "text": "see every frame starts with the bite 72 and then there is a version field",
    "start": "742720",
    "end": "748160"
  },
  {
    "text": "following there's a length field which tells us how many data is transmitted and a type field which tells us",
    "start": "748160",
    "end": "755240"
  },
  {
    "text": "something about the intention of the message for example error or response or request there's a reserved field there's",
    "start": "755240",
    "end": "761800"
  },
  {
    "text": "a subtype which tells us uh more about intension of the message and there's a",
    "start": "761800",
    "end": "766880"
  },
  {
    "text": "sequence number in the end there's a frame end delimiter uh which tells us",
    "start": "766880",
    "end": "772600"
  },
  {
    "text": "that the um frame ends here if the LI delimiter is missing um the frame is",
    "start": "772600",
    "end": "778519"
  },
  {
    "text": "continued in the next uh Network packet okay then there are a lot of more",
    "start": "778519",
    "end": "785720"
  },
  {
    "text": "bites between the message CH and the frame and delimiter and as we started",
    "start": "785720",
    "end": "790760"
  },
  {
    "text": "our analy we had some problems uh to find any structure in the btes between",
    "start": "790760",
    "end": "796560"
  },
  {
    "text": "but then we saw that there are a lot of A3 bytes and we found out that the A3",
    "start": "796560",
    "end": "802680"
  },
  {
    "text": "bite introduces a so-called attribute block um the values that are actually",
    "start": "802680",
    "end": "808120"
  },
  {
    "text": "transferred with uh this protocol are structured in these blocks um like the",
    "start": "808120",
    "end": "813959"
  },
  {
    "text": "messages each block has a basic layout um you can see it on this slide",
    "start": "813959",
    "end": "820240"
  },
  {
    "text": "um after the A3 by there's an identification field which tells uh which information is transferred in this",
    "start": "820240",
    "end": "828000"
  },
  {
    "text": "attribute block then there is a format field which is most of the time zero there's a data type in this case it is a",
    "start": "828000",
    "end": "835720"
  },
  {
    "text": "string uh there's a length field which tells us how many any data is transferred in this attribute block and",
    "start": "835720",
    "end": "842360"
  },
  {
    "text": "in the end uh the actual value in this case the string is",
    "start": "842360",
    "end": "848440"
  },
  {
    "start": "848000",
    "end": "848000"
  },
  {
    "text": "placed okay then we tried to pass uh the attribute blocks and uh we failed a lot",
    "start": "848720",
    "end": "855199"
  },
  {
    "text": "of uh the tries um because numbers are a little bit encoded are a little bit",
    "start": "855199",
    "end": "861120"
  },
  {
    "text": "strange in the uh attribute blocks we see two numbers in this example the",
    "start": "861120",
    "end": "867000"
  },
  {
    "text": "first is a uh identification field and the second is the uh length and if a",
    "start": "867000",
    "end": "874240"
  },
  {
    "text": "length or a number field starts with a one bit there's a following bite which",
    "start": "874240",
    "end": "881000"
  },
  {
    "text": "also belongs to the number um so the numbers in this protocol have a dynamic size um the",
    "start": "881000",
    "end": "889040"
  },
  {
    "text": "length here starts with zero so it's only uh one bite after uh we understood",
    "start": "889040",
    "end": "895800"
  },
  {
    "text": "this we were able um oh there's another slide which is important so uh what you",
    "start": "895800",
    "end": "902680"
  },
  {
    "start": "898000",
    "end": "898000"
  },
  {
    "text": "can see here is the the message that is uh replied by the PLC to the ti portal",
    "start": "902680",
    "end": "909639"
  },
  {
    "text": "after the connection setup message and we are only interested in one bite the",
    "start": "909639",
    "end": "915160"
  },
  {
    "text": "anti- replay bite um it's a anti- replay Challenge and uh what you need to know",
    "start": "915160",
    "end": "922199"
  },
  {
    "text": "is that you need to record this bite and flip the first bit of this bite uh and",
    "start": "922199",
    "end": "929279"
  },
  {
    "text": "put uh the result and all your messages you are going to send uh to the PLC um",
    "start": "929279",
    "end": "935399"
  },
  {
    "text": "so it's an an replay uh protection so the real result here in this example is",
    "start": "935399",
    "end": "940519"
  },
  {
    "text": "A2 and uh to complete this connection set up we send another message and we",
    "start": "940519",
    "end": "947079"
  },
  {
    "text": "place uh this uh bite uh here okay there's another uh interesting",
    "start": "947079",
    "end": "953839"
  },
  {
    "start": "951000",
    "end": "951000"
  },
  {
    "text": "message um the program transfer message it is used for download new program to",
    "start": "953839",
    "end": "960319"
  },
  {
    "text": "the PLC um the message head uh is the same like we saw already and there are",
    "start": "960319",
    "end": "968079"
  },
  {
    "text": "two uh new fields that are intering the first is the block type uh as we already",
    "start": "968079",
    "end": "973160"
  },
  {
    "text": "mentioned there are different blocks for example OB or function block or there are some more and uh here's a block",
    "start": "973160",
    "end": "980279"
  },
  {
    "text": "number the block number is the slot where the block is stored on the PLC so",
    "start": "980279",
    "end": "986000"
  },
  {
    "text": "in this case one it is placed uh on the slot",
    "start": "986000",
    "end": "991120"
  },
  {
    "text": "one um then there are lot of attribute uh blocks in this",
    "start": "991120",
    "end": "996800"
  },
  {
    "text": "message uh for example the modification time as the source code is stored on the",
    "start": "996800",
    "end": "1002040"
  },
  {
    "text": "PLC the uh bite code that is actually um executed by the PLC stored on the uh PLC",
    "start": "1002040",
    "end": "1011720"
  },
  {
    "text": "um there are a lot of more informations and some of them are used by the Tia",
    "start": "1011720",
    "end": "1017160"
  },
  {
    "text": "portal um in case that is wants to recover the program out of the",
    "start": "1017160",
    "end": "1024398"
  },
  {
    "text": "PLC and some only used by the PLC for example the bite",
    "start": "1025000",
    "end": "1030120"
  },
  {
    "start": "1030000",
    "end": "1030000"
  },
  {
    "text": "code uh okay then uh we found some interesting security flaws which are",
    "start": "1030120",
    "end": "1035600"
  },
  {
    "text": "interesting if you want to implement malware for plc's so um the first problem is that uh",
    "start": "1035600",
    "end": "1043678"
  },
  {
    "text": "some data is used twice uh as I mentioned here uh is the block number",
    "start": "1043679",
    "end": "1050200"
  },
  {
    "text": "the block number is transferred in the message CH but it's also transferred here as attribute block and now the",
    "start": "1050200",
    "end": "1057960"
  },
  {
    "text": "question is uh which of these values is uh used by zens and the answer is both",
    "start": "1057960",
    "end": "1063840"
  },
  {
    "text": "the first is used by the PLC and the second value is used by the ti",
    "start": "1063840",
    "end": "1070480"
  },
  {
    "text": "portal now uh consider the following situation",
    "start": "1070480",
    "end": "1076480"
  },
  {
    "text": "um you uh choose the free slot not here um for example let's say 999 which",
    "start": "1076480",
    "end": "1084440"
  },
  {
    "text": "is mostly free and here at this value you choose an already uh existing number",
    "start": "1084440",
    "end": "1090679"
  },
  {
    "text": "for example one which is uh most of the time in use so uh what will happen if",
    "start": "1090679",
    "end": "1096600"
  },
  {
    "text": "you download this message the PLC will check and see okay it's a free slot I place it in my free slot and the",
    "start": "1096600",
    "end": "1104280"
  },
  {
    "text": "execution of this block will start um if later an engineer wants to check the",
    "start": "1104280",
    "end": "1109559"
  },
  {
    "text": "program he will use the ti portal and the ti portal will download all blocks",
    "start": "1109559",
    "end": "1114600"
  },
  {
    "text": "that are stored on the PLC so the T portal now has a problem because it sees",
    "start": "1114600",
    "end": "1121280"
  },
  {
    "text": "it ever uh it used this block um to check um what um block number each block",
    "start": "1121280",
    "end": "1129960"
  },
  {
    "text": "has and it sees two blocks twice and this uh problem is solved by the T",
    "start": "1129960",
    "end": "1136039"
  },
  {
    "text": "portal um in in uh just displaying one",
    "start": "1136039",
    "end": "1141679"
  },
  {
    "text": "block so uh this allows us to hide um parts of our user program uh from the ti",
    "start": "1141679",
    "end": "1148960"
  },
  {
    "text": "portal and from the engineer okay but it's not working with",
    "start": "1148960",
    "end": "1154400"
  },
  {
    "text": "data blocks um there's another problem that uh some informations are uh are",
    "start": "1154400",
    "end": "1160559"
  },
  {
    "text": "stored twice the first is uh that the source code uh is Tau on the PSC",
    "start": "1160559",
    "end": "1169600"
  },
  {
    "text": "and the bite code is also stored in the PLC and now uh we can um program a",
    "start": "1169960",
    "end": "1177799"
  },
  {
    "text": "melist program and download it to the PLC but we can change only the source",
    "start": "1177799",
    "end": "1184760"
  },
  {
    "text": "code and make the program uh look like a usual program um so this allows us again",
    "start": "1184760",
    "end": "1193000"
  },
  {
    "text": "uh to hide some of our code uh from the Tia portal and the engineer",
    "start": "1193000",
    "end": "1200240"
  },
  {
    "text": "um yes um um there's another interesting thing",
    "start": "1200400",
    "end": "1207120"
  },
  {
    "text": "um the blocks that are only used by the ti portal can be uh left out at all so",
    "start": "1207120",
    "end": "1213600"
  },
  {
    "text": "there's no need to chip the warm Source uh and it helps us to reduce the whole amount of data that needs to be",
    "start": "1213600",
    "end": "1221400"
  },
  {
    "start": "1221000",
    "end": "1221000"
  },
  {
    "text": "transferred um then uh we Implement everything uh using the ti",
    "start": "1221400",
    "end": "1226840"
  },
  {
    "text": "portal um we uh create uh we or we Implement uh the connection setup we",
    "start": "1226840",
    "end": "1234120"
  },
  {
    "text": "implement the anti- replay protection and uh create empty uh data blocks uh",
    "start": "1234120",
    "end": "1240400"
  },
  {
    "text": "for the messages that are used uh by the warm to propagate",
    "start": "1240400",
    "end": "1245679"
  },
  {
    "text": "itself uh the question is how this empty message uh blocks filled um we download",
    "start": "1245679",
    "end": "1253240"
  },
  {
    "text": "the user uh the warm application uh with the help of the ti a portal and record",
    "start": "1253240",
    "end": "1260960"
  },
  {
    "text": "record these messages then we place the recorded recorded messages in uh the data blocks",
    "start": "1260960",
    "end": "1269559"
  },
  {
    "text": "uh in the end we can upload everything uh with our own tool and infect the",
    "start": "1269559",
    "end": "1274679"
  },
  {
    "text": "first PLC okay uh the carrier is done now uh",
    "start": "1274679",
    "end": "1281440"
  },
  {
    "text": "we need uh to start the code that we transferred to the PLC and this part is",
    "start": "1281440",
    "end": "1287120"
  },
  {
    "text": "very easy like we mentioned before the OB block uh is uh similar to the main",
    "start": "1287120",
    "end": "1294120"
  },
  {
    "text": "function in C um in uh zman plcs there is a possibility that there's more than",
    "start": "1294120",
    "end": "1301640"
  },
  {
    "text": "one main function so you just need to download uh your warm as an OB and the",
    "start": "1301640",
    "end": "1308240"
  },
  {
    "text": "PLC will start the execution and uh the or original user",
    "start": "1308240",
    "end": "1315120"
  },
  {
    "text": "program is untouched so we only add a new main function and this is executed so this part is",
    "start": "1315120",
    "end": "1321720"
  },
  {
    "text": "very easy activation function is built in uh in the end uh we can Implement",
    "start": "1321720",
    "end": "1327240"
  },
  {
    "text": "some payloads um so you are part of the user program uh you can do uh a lot of things",
    "start": "1327240",
    "end": "1334640"
  },
  {
    "start": "1328000",
    "end": "1328000"
  },
  {
    "text": "for example you can stop the whole execution of the user program or you can",
    "start": "1334640",
    "end": "1340000"
  },
  {
    "text": "manipulate the outputs uh you have the TCP functions which allow you to uh",
    "start": "1340000",
    "end": "1346600"
  },
  {
    "text": "Implement a c command and control server or some Pro proxy",
    "start": "1346600",
    "end": "1353520"
  },
  {
    "text": "functions uh okay uh we have implemented all uh the different parts and uh now we",
    "start": "1353520",
    "end": "1360360"
  },
  {
    "text": "are going to show you that everything is working um I will uh infect the first",
    "start": "1360360",
    "end": "1367000"
  },
  {
    "start": "1362000",
    "end": "1362000"
  },
  {
    "text": "PLC with my laptop and after that I will plug off uh my laptop and the W will",
    "start": "1367000",
    "end": "1373960"
  },
  {
    "text": "spread in the uh industrial Network after that I will plug in uh my laptop",
    "start": "1373960",
    "end": "1380600"
  },
  {
    "text": "again and we will see that the war tries to connect to my laptop where command",
    "start": "1380600",
    "end": "1386799"
  },
  {
    "text": "and control server running",
    "start": "1386799",
    "end": "1391799"
  },
  {
    "text": "okay uh",
    "start": "1401360",
    "end": "1405360"
  },
  {
    "text": "okay just for you to see that um currently just one PLC is connected um",
    "start": "1412960",
    "end": "1418600"
  },
  {
    "text": "let's see let's see wrong way okay now um I this PLC here at the top uh top",
    "start": "1418600",
    "end": "1426679"
  },
  {
    "text": "left is connected you see the ethernet cable going into the PLC the other plcs are currently disconnected so we're",
    "start": "1426679",
    "end": "1433559"
  },
  {
    "text": "making sure uh that it's disconnected so these are the",
    "start": "1433559",
    "end": "1439200"
  },
  {
    "text": "uh ethernet ports we're just making sure that we're just talking to one PLC at",
    "start": "1439200",
    "end": "1444360"
  },
  {
    "text": "the moment um we will later on uh disconnect the laptop and uh then we'll",
    "start": "1444360",
    "end": "1450679"
  },
  {
    "text": "connect the first PLC to the to the network again and we will see the worm spread then we will disconnect the",
    "start": "1450679",
    "end": "1456919"
  },
  {
    "text": "original infected PLC um so that you can actually see that the worm then actually can propagate from the second PLC to the",
    "start": "1456919",
    "end": "1464200"
  },
  {
    "text": "third and fourth PLC so let's see um um one thing um to to to check for is you",
    "start": "1464200",
    "end": "1471440"
  },
  {
    "text": "will see that during the infection the PLC will stop for a couple of seconds uh",
    "start": "1471440",
    "end": "1476679"
  },
  {
    "text": "this is important um because we canot patch or well our warm cannot",
    "start": "1476679",
    "end": "1483720"
  },
  {
    "text": "patch the PLC while it's running so you will see the light stopping for a couple of seconds and then it will start",
    "start": "1483720",
    "end": "1489120"
  },
  {
    "text": "running again the original user program will run again uh and the warm is running as well so let's concentrate on",
    "start": "1489120",
    "end": "1496799"
  },
  {
    "text": "the first plc",
    "start": "1496799",
    "end": "1500158"
  },
  {
    "text": "mus like said",
    "start": "1504080",
    "end": "1507278"
  },
  {
    "text": "yep as you see the light stopped takes a couple of",
    "start": "1510000",
    "end": "1516039"
  },
  {
    "text": "seconds and now the PLC is running again so uh now",
    "start": "1516720",
    "end": "1523799"
  },
  {
    "text": "we plug off the laptop and I plug in the first of",
    "start": "1523799",
    "end": "1530960"
  },
  {
    "text": "PLC and this not takes a couple of seconds because the first PLC is now scanning the network and we're now",
    "start": "1530960",
    "end": "1537919"
  },
  {
    "text": "waiting for the second PLC to stop",
    "start": "1537919",
    "end": "1543080"
  },
  {
    "text": "um maybe maybe it will catch the other ones first",
    "start": "1550600",
    "end": "1559000"
  },
  {
    "text": "ah there it is takes a couple of seconds and now the",
    "start": "1559120",
    "end": "1565799"
  },
  {
    "text": "second PC is running again so I removed the first PLC so the PLC we we infected first so",
    "start": "1565799",
    "end": "1573360"
  },
  {
    "text": "now it's the warm that propagated to the second PLC and we will plug",
    "start": "1573360",
    "end": "1578720"
  },
  {
    "text": "in a third and a",
    "start": "1578720",
    "end": "1583000"
  },
  {
    "text": "fourth and the force already stopped uh so it's uh was found first the four",
    "start": "1585320",
    "end": "1592799"
  },
  {
    "text": "is running again now and now we're just waiting for the third one and the bottom",
    "start": "1592799",
    "end": "1599679"
  },
  {
    "text": "left oh come on there it",
    "start": "1604720",
    "end": "1609200"
  },
  {
    "text": "is and it's running again as well so I plug in the first one again",
    "start": "1611960",
    "end": "1619080"
  },
  {
    "text": "and now we're looking at the command and control",
    "start": "1619080",
    "end": "1623398"
  },
  {
    "text": "server okay the first PLC is already connected it's tells us its IP address",
    "start": "1627320",
    "end": "1632960"
  },
  {
    "text": "we have to wait for the for the other plcs",
    "start": "1632960",
    "end": "1636919"
  },
  {
    "text": "now oh there was okay that was uh the message we saw there is a message from",
    "start": "1641520",
    "end": "1647399"
  },
  {
    "text": "the from the So currently nothing is connected apparently so it's a problem",
    "start": "1647399",
    "end": "1654960"
  },
  {
    "text": "you yeah petus is",
    "start": "1655679",
    "end": "1659360"
  },
  {
    "text": "gone so that's always a problem with life demos they add the juice to the to the",
    "start": "1663320",
    "end": "1669960"
  },
  {
    "text": "uh talk but they always difficult to do so we see four",
    "start": "1669960",
    "end": "1675120"
  },
  {
    "text": "plcs which connected now to our uh to our Command control server and um the",
    "start": "1675120",
    "end": "1681640"
  },
  {
    "text": "first thing um Mike can do is for example modify one of the outputs from",
    "start": "1681640",
    "end": "1686919"
  },
  {
    "text": "one PLC um so we're now connected to it uh this would even work the PLC connects",
    "start": "1686919",
    "end": "1693120"
  },
  {
    "text": "to us so this would even work through netted um internet access uh stuff like",
    "start": "1693120",
    "end": "1698399"
  },
  {
    "text": "that um and uh we have implemented different commands now in the command and control server so we can modify the",
    "start": "1698399",
    "end": "1706039"
  },
  {
    "text": "uh the output so uh let's",
    "start": "1706039",
    "end": "1711320"
  },
  {
    "text": "see",
    "start": "1713559",
    "end": "1716559"
  },
  {
    "text": "[Music] um so we can do anything to any output",
    "start": "1722090",
    "end": "1729080"
  },
  {
    "text": "as you can see um okay um you stopped the PLC as",
    "start": "1729080",
    "end": "1735120"
  },
  {
    "text": "well the user program or no it's not stopped okay well can you get the light",
    "start": "1735120",
    "end": "1741600"
  },
  {
    "text": "show running again yeah",
    "start": "1741600",
    "end": "1747440"
  },
  {
    "text": "um okay there we've got the light show again um something else we implemented",
    "start": "1749600",
    "end": "1755200"
  },
  {
    "text": "um and this was an idea we got from blackhead last year um in Las Vegas they",
    "start": "1755200",
    "end": "1762159"
  },
  {
    "text": "implemented a proxy um so um we can even use the plc now as a uh Bridge head into",
    "start": "1762159",
    "end": "1772720"
  },
  {
    "text": "the industrial plant uh because it connects to ourself um we can use it as a proxy and",
    "start": "1772720",
    "end": "1780640"
  },
  {
    "text": "to uh run any additional commands across this proxy so this is a sock simple",
    "start": "1780640",
    "end": "1787000"
  },
  {
    "text": "socks proxy",
    "start": "1787000",
    "end": "1790720"
  },
  {
    "text": "um and you can use something like proxy chains for example to do an nend through",
    "start": "1792120",
    "end": "1798720"
  },
  {
    "text": "this um uh through this proxy and as you can",
    "start": "1798720",
    "end": "1805159"
  },
  {
    "text": "see these plcs have 443 open um and it's now scanning for the",
    "start": "1805159",
    "end": "1811039"
  },
  {
    "text": "airports 80 is open so there's rep server running on these plcs and um so",
    "start": "1811039",
    "end": "1817320"
  },
  {
    "text": "on um we can even Implement a little dos uh as I told you there's this um uh the",
    "start": "1817320",
    "end": "1825360"
  },
  {
    "text": "cycle time the cycle time limit of 150 Mill seconds and as soon as you violate",
    "start": "1825360",
    "end": "1831519"
  },
  {
    "text": "this cycle time uh the F on the PLC will actually uh stop the user application so",
    "start": "1831519",
    "end": "1840320"
  },
  {
    "text": "um that's what happened um and uh now the um the the user application",
    "start": "1840320",
    "end": "1848760"
  },
  {
    "text": "is stopped and the PLC internally lcks an error of course but um imagine this",
    "start": "1848760",
    "end": "1854640"
  },
  {
    "text": "happening to your plant um and machines uh stop working um so anything else can",
    "start": "1854640",
    "end": "1863720"
  },
  {
    "text": "no so this is pretty much the demo um of this",
    "start": "1863720",
    "end": "1869440"
  },
  {
    "text": "war okay uh back to the slides uh now uh we uh can uh have a look uh on how the",
    "start": "1872039",
    "end": "1880440"
  },
  {
    "start": "1875000",
    "end": "1875000"
  },
  {
    "text": "uh warm uh influence the PC uh what we have uh seen was that uh the execution",
    "start": "1880440",
    "end": "1887000"
  },
  {
    "text": "of the user program was stopped for 10 seconds uh it generates a lock entry so",
    "start": "1887000",
    "end": "1893080"
  },
  {
    "text": "you are able to uh see uh that there's something strange happening in your network if you check your locks or um",
    "start": "1893080",
    "end": "1901039"
  },
  {
    "text": "maybe you see it um directly because every machine uh which is controlled by",
    "start": "1901039",
    "end": "1906559"
  },
  {
    "text": "a PSC stops for 10 seconds um okay as we already Ren mentioned uh you can improve",
    "start": "1906559",
    "end": "1914200"
  },
  {
    "text": "uh this by patch the OB uh one uh for example uh online without stopping it but the",
    "start": "1914200",
    "end": "1921399"
  },
  {
    "text": "warm will get more complex so we just uh",
    "start": "1921399",
    "end": "1926480"
  },
  {
    "text": "did not implemented this um the warm uses memory uh about um",
    "start": "1926480",
    "end": "1934760"
  },
  {
    "text": "80 um 38 kiloby of RAM and about uh 220",
    "start": "1934760",
    "end": "1941360"
  },
  {
    "text": "kiloby of persistent memory um the war is small enough to fit in all um",
    "start": "1941360",
    "end": "1947279"
  },
  {
    "text": "different S7 ,100 models um the cycle time is important uh",
    "start": "1947279",
    "end": "1955600"
  },
  {
    "text": "we uh do uh not uh we cannot uh execute",
    "start": "1955600",
    "end": "1961000"
  },
  {
    "text": "our warm longer than 150 milliseconds because uh the PLC will go into error",
    "start": "1961000",
    "end": "1967480"
  },
  {
    "text": "mode if we do this so we meas measured the maximum uh time during uh infection",
    "start": "1967480",
    "end": "1974000"
  },
  {
    "text": "the maximum cycle time and we have seen the maximum time of 7",
    "start": "1974000",
    "end": "1979360"
  },
  {
    "text": "millisecond seconds uh which uh matches our exception because the most of the",
    "start": "1979360",
    "end": "1985440"
  },
  {
    "text": "time we execute communication functions uh which run uh in background and uh",
    "start": "1985440",
    "end": "1991360"
  },
  {
    "text": "processed by the firmware um okay uh then uh the next",
    "start": "1991360",
    "end": "1997559"
  },
  {
    "start": "1994000",
    "end": "1994000"
  },
  {
    "text": "question is how you can remove uh the warm uh you have the possibility to um",
    "start": "1997559",
    "end": "2004240"
  },
  {
    "text": "do a factory reset this will delete the whole user program including uh the PLC",
    "start": "2004240",
    "end": "2010440"
  },
  {
    "text": "warm or you just override the warm OB with uh your OB so the execution will",
    "start": "2010440",
    "end": "2019600"
  },
  {
    "text": "stop um the TR Port is the ti portal will",
    "start": "2019600",
    "end": "2025120"
  },
  {
    "text": "recognize the warm uh we can can see this on this screenshot uh here in the",
    "start": "2025120",
    "end": "2031080"
  },
  {
    "text": "left corner uh we can see the user program uh which was uh transferred by",
    "start": "2031080",
    "end": "2037039"
  },
  {
    "text": "an engineer uh to this PLC and everything here is green which means",
    "start": "2037039",
    "end": "2042120"
  },
  {
    "text": "okay that is exactly the same program uh you downloaded uh to the PLC and here in",
    "start": "2042120",
    "end": "2048800"
  },
  {
    "text": "the bottom corner uh we can see here's a different color that means that a new blocks and uh if an engineer uh looks at",
    "start": "2048800",
    "end": "2056679"
  },
  {
    "text": "the PLC we see okay there's new software uh what is uh that U and maybe he will",
    "start": "2056679",
    "end": "2063560"
  },
  {
    "text": "start to um yeah analyze the PC see uh in more",
    "start": "2063560",
    "end": "2069878"
  },
  {
    "text": "detail um but we can uh yeah manipulate some attribute blocks in a way that the",
    "start": "2069879",
    "end": "2076520"
  },
  {
    "text": "TR portal will crash before it uh actually allows you to uh um analyze the",
    "start": "2076520",
    "end": "2083320"
  },
  {
    "text": "software which is uh stored on the PLC um yes and now I will hand over to R",
    "start": "2083320",
    "end": "2090520"
  },
  {
    "text": "again okay well um so we've seen that this W is actually capable of infecting",
    "start": "2090520",
    "end": "2098240"
  },
  {
    "text": "an industrial plant uh all by itself we don't need any additional PC or any",
    "start": "2098240",
    "end": "2104200"
  },
  {
    "text": "additional support anymore uh so as I said in the beginning um the attack the",
    "start": "2104200",
    "end": "2110880"
  },
  {
    "text": "the uh well the the PLC is not the target of the attack um but it might",
    "start": "2110880",
    "end": "2116200"
  },
  {
    "text": "always also be the source of the attack so the attack is actually coming from the PLC uh it attacks other",
    "start": "2116200",
    "end": "2123359"
  },
  {
    "text": "plcs um without any additional um uh help from the",
    "start": "2123359",
    "end": "2129040"
  },
  {
    "text": "outside um uh one more thing maybe to to the to the work uh Mike just presented",
    "start": "2129040",
    "end": "2136720"
  },
  {
    "text": "uh Mike pretty much did all this analysis on uh using wire shark and TCP dump because not that much was known",
    "start": "2136720",
    "end": "2143960"
  },
  {
    "text": "about this new S7 comp plus protocol um Mike told you about um finally um",
    "start": "2143960",
    "end": "2151319"
  },
  {
    "text": "another guy another researcher from a totally different um background actually",
    "start": "2151319",
    "end": "2156520"
  },
  {
    "text": "analyzed protocol as as well and there is now a wire shark dector for that uh too so if you're interested in this",
    "start": "2156520",
    "end": "2163040"
  },
  {
    "text": "protocol if you have got such a PLC uh you can use now wire shockk you have to install an additional wire sh wire shark",
    "start": "2163040",
    "end": "2169960"
  },
  {
    "text": "dissector and it pretty much gives you all the information that um Mike found",
    "start": "2169960",
    "end": "2175560"
  },
  {
    "text": "out the hard way um if we had known about that work at that time it would have helped us a lot I guess um anyway",
    "start": "2175560",
    "end": "2183839"
  },
  {
    "text": "um now how do we protect our plcs from such attacks uh that's very interesting",
    "start": "2183839",
    "end": "2189480"
  },
  {
    "text": "as well uh and seamons has three different types of protections which are",
    "start": "2189480",
    "end": "2194920"
  },
  {
    "text": "available um for these um for these models they are called no how protection",
    "start": "2194920",
    "end": "2200599"
  },
  {
    "text": "copy protection and access protection and we looked at those as well um and uh",
    "start": "2200599",
    "end": "2207119"
  },
  {
    "text": "this is the first time that we actually talk about vulnerabilities we found there because uh Simons closed them",
    "start": "2207119",
    "end": "2212960"
  },
  {
    "text": "about a week or two ago uh at least they released an advisory on that week or two ago they closed them uh earlier um first",
    "start": "2212960",
    "end": "2221839"
  },
  {
    "start": "2220000",
    "end": "2220000"
  },
  {
    "text": "the protection uh what is the idea behind the noal protection the idea",
    "start": "2221839",
    "end": "2227599"
  },
  {
    "text": "behind the noal protection is that if you actually um develop some code for a",
    "start": "2227599",
    "end": "2233040"
  },
  {
    "text": "PLC and you build machines which are controlled by this code uh you don't",
    "start": "2233040",
    "end": "2238520"
  },
  {
    "text": "want your um the other vendors on the market to copy that code to be able to",
    "start": "2238520",
    "end": "2244760"
  },
  {
    "text": "look at that code you want to protect your um your um uh property your your um",
    "start": "2244760",
    "end": "2252920"
  },
  {
    "text": "uh IP so the idea behind it is that you choose a password and then using this",
    "start": "2252920",
    "end": "2259480"
  },
  {
    "text": "password the source code on the PLC is encrypted uh so even if you use the tort",
    "start": "2259480",
    "end": "2265520"
  },
  {
    "text": "to retrieve the source code AS might told you the source code is um stored on",
    "start": "2265520",
    "end": "2270839"
  },
  {
    "text": "the PLC as well for later retrieval um then this source code is encrypted you can only decrypt it if you know the",
    "start": "2270839",
    "end": "2277480"
  },
  {
    "text": "current password um this is actually flawed on the system",
    "start": "2277480",
    "end": "2284560"
  },
  {
    "text": "on the version three Hardware revision 3 2 and one uh for two reasons first of",
    "start": "2284560",
    "end": "2290040"
  },
  {
    "text": "all the B code is not encrypted and during his work Mike even wrote an disassembler for the bite code uh which",
    "start": "2290040",
    "end": "2297000"
  },
  {
    "text": "is not the topic of this talk today um but uh he he is able to actually reconstruct the original code just based",
    "start": "2297000",
    "end": "2303800"
  },
  {
    "text": "on the bite code um but it's FL for a second reason as well um uh the nwk",
    "start": "2303800",
    "end": "2310400"
  },
  {
    "text": "protection is stored in the attribute block uh as we saw before and there's this enable flag and Mike during his",
    "start": "2310400",
    "end": "2317880"
  },
  {
    "text": "research Mike wrote tools to talk to the plcs and to uh send and retrieve attri",
    "start": "2317880",
    "end": "2323240"
  },
  {
    "text": "attribute blocks as well and for one reason or the other I don't know why um",
    "start": "2323240",
    "end": "2328640"
  },
  {
    "text": "the attribute block on the PLC is not right protected so what Mike can do with",
    "start": "2328640",
    "end": "2334680"
  },
  {
    "text": "his tools is he can retrieve this attribute block and can just flip the enable flag and write it back and then",
    "start": "2334680",
    "end": "2341960"
  },
  {
    "text": "the Tia portal will see this attribute block but it's not enabled and will be happily down will happily download the",
    "start": "2341960",
    "end": "2348240"
  },
  {
    "text": "source code well the source code is still encrypted so you still cannot read it uh but at least you can um uh use it",
    "start": "2348240",
    "end": "2357720"
  },
  {
    "text": "um uh you can can access it um uh so we look um further um to into this um into",
    "start": "2357720",
    "end": "2365880"
  },
  {
    "text": "this uh um idea and into the the protection and um looked at how the key",
    "start": "2365880",
    "end": "2374119"
  },
  {
    "text": "is actually generated and um finally uh the key is just based on",
    "start": "2374119",
    "end": "2382880"
  },
  {
    "text": "the uh password so there's nothing else than the password which is used and um",
    "start": "2382880",
    "end": "2389119"
  },
  {
    "text": "actually not the password itself but the secure hash of the password which is",
    "start": "2389119",
    "end": "2394160"
  },
  {
    "text": "stored in clear text in the atrial block so if you can retrieve this attribute Block You've Got the hash of the",
    "start": "2394160",
    "end": "2400560"
  },
  {
    "text": "password you don't need to um decrypt this hash you just use this hash using",
    "start": "2400560",
    "end": "2407240"
  },
  {
    "text": "this formula and you have the key to decrypt the source",
    "start": "2407240",
    "end": "2412280"
  },
  {
    "text": "code um so you have everything at your fingertips to decrypt the source code to",
    "start": "2412280",
    "end": "2418280"
  },
  {
    "text": "retrieve and decrypt the source code um this is fixed in F version 4 um hardware",
    "start": "2418280",
    "end": "2424839"
  },
  {
    "text": "version 4 and this is a SE security advisory from last week or two weeks ago",
    "start": "2424839",
    "end": "2429920"
  },
  {
    "text": "uh in which they actually um admitted and um admitted the fact and uh told the",
    "start": "2429920",
    "end": "2437520"
  },
  {
    "text": "community that uh you need to use hardare revision 4 and Fir revision 4 to",
    "start": "2437520",
    "end": "2443319"
  },
  {
    "text": "actually be protected from this attack um one more thing to for you to know is",
    "start": "2443319",
    "end": "2449400"
  },
  {
    "text": "these are all Hardware revisions three on these plcs we demonstrate the attack",
    "start": "2449400",
    "end": "2454440"
  },
  {
    "text": "on um and we cannot install f before on these systems so they are not supported",
    "start": "2454440",
    "end": "2461119"
  },
  {
    "text": "anymore so they will have this back for their whole life um so now how",
    "start": "2461119",
    "end": "2468319"
  },
  {
    "text": "protection uh actually is um broken um and at least on this on these uh systems",
    "start": "2468319",
    "end": "2474920"
  },
  {
    "text": "revision three and they even if uh it would work they would only protect the",
    "start": "2474920",
    "end": "2480079"
  },
  {
    "text": "existing puus so the existing blocks so as we since we add blocks to the system",
    "start": "2480079",
    "end": "2486520"
  },
  {
    "text": "uh they wouldn't even if it would work it would not prevent the worm from propagating then we looked at Copper",
    "start": "2486520",
    "end": "2493280"
  },
  {
    "start": "2491000",
    "end": "2491000"
  },
  {
    "text": "protection and um uh we thought that copper protection wouldn't protect",
    "start": "2493280",
    "end": "2499000"
  },
  {
    "text": "against the worm anyway but still we looked at it and looked a little bit closer at it and uh the idea behind it",
    "start": "2499000",
    "end": "2505240"
  },
  {
    "text": "is that um if you um if you again write",
    "start": "2505240",
    "end": "2510319"
  },
  {
    "text": "code you want to protect your intellectual property um and you want to make sure that the end user may not copy",
    "start": "2510319",
    "end": "2519200"
  },
  {
    "text": "the user application from one PLC to another PLC uh so if you written a program and",
    "start": "2519200",
    "end": "2525359"
  },
  {
    "text": "you license it to your users they they should not be allowed to use this program on as many plcs as they want to",
    "start": "2525359",
    "end": "2532040"
  },
  {
    "text": "use them how is it done well the serial number is implemented in the code well",
    "start": "2532040",
    "end": "2538119"
  },
  {
    "text": "it's stored in the code and uh the serial number of the PLC should then",
    "start": "2538119",
    "end": "2543319"
  },
  {
    "text": "bind the user application to just this one plc again the seal number is thought an",
    "start": "2543319",
    "end": "2549599"
  },
  {
    "text": "attribute block and the attribute block is not right protected so you can not Integrity protect it uh so you can",
    "start": "2549599",
    "end": "2556960"
  },
  {
    "text": "change the cial number to any value you want and the second thing which is even",
    "start": "2556960",
    "end": "2563359"
  },
  {
    "text": "more problematic in our eyes in our U uh",
    "start": "2563359",
    "end": "2568400"
  },
  {
    "text": "our view is that the attri is not even evaluated by the PLC so even although",
    "start": "2568400",
    "end": "2574319"
  },
  {
    "text": "you store the serial number within such an attribute block this attribute block is not evaluated by the PLC but it is",
    "start": "2574319",
    "end": "2582240"
  },
  {
    "text": "just evaluated by the ti portal when it wants to program additional plcs so the Tia",
    "start": "2582240",
    "end": "2590720"
  },
  {
    "text": "portal will see whether when you retrieve the program from one PLC that it may only restore the program on the",
    "start": "2590720",
    "end": "2597920"
  },
  {
    "text": "same PLC but may not copy it a second or third PLC as I said Mike wrote software",
    "start": "2597920",
    "end": "2603400"
  },
  {
    "text": "that can download and upload arbitrary um blocks from the plcs and he was able to",
    "start": "2603400",
    "end": "2611559"
  },
  {
    "text": "well use this or implement this copy protection in a program um store it on a",
    "start": "2611559",
    "end": "2617359"
  },
  {
    "text": "PLC on a valel PLC retrieve it and stall it on a second PLC and the PLC would execute",
    "start": "2617359",
    "end": "2622960"
  },
  {
    "text": "it again this is fixed and again it's the same security advisory um so um it's",
    "start": "2622960",
    "end": "2632040"
  },
  {
    "text": "fixed in F version 4 and the appropriate tier portal which is then used with",
    "start": "2632040",
    "end": "2637359"
  },
  {
    "text": "version 4 um so that's copy protection last uh protection mechanism",
    "start": "2637359",
    "end": "2645280"
  },
  {
    "start": "2642000",
    "end": "2642000"
  },
  {
    "text": "uh which is provided by seens is the so-called access protection and that actually works unfortunately it's not",
    "start": "2645280",
    "end": "2651599"
  },
  {
    "text": "enabled by default uh so if you actually do write your user",
    "start": "2651599",
    "end": "2658160"
  },
  {
    "text": "applications um in the version we used uh in the T 11 um uh you're not even",
    "start": "2658160",
    "end": "2665720"
  },
  {
    "text": "reminded of the fact that there is such a thing that an ex as an exess protection the newer versions remind you",
    "start": "2665720",
    "end": "2671559"
  },
  {
    "text": "of the fact they ask you whether you want to set such a password um but um uh",
    "start": "2671559",
    "end": "2677839"
  },
  {
    "text": "still you can just um uh dismiss that uh so if the exess",
    "start": "2677839",
    "end": "2683880"
  },
  {
    "text": "protection is off you have access to all these features you can transfer programs to the PLC you can retrieve programs you",
    "start": "2683880",
    "end": "2690760"
  },
  {
    "text": "can start and stop the PLC um even with the lowest level of the exess protection the so-called right protection um you",
    "start": "2690760",
    "end": "2698079"
  },
  {
    "text": "cannot transfer programs to the PLC anymore um to do that you will need to",
    "start": "2698079",
    "end": "2704160"
  },
  {
    "text": "provide a password and this password actually seems to be transferred securely so",
    "start": "2704160",
    "end": "2712079"
  },
  {
    "text": "there is a challenge response mechanism in place which apparently is secure um",
    "start": "2712079",
    "end": "2718160"
  },
  {
    "text": "we looked into a little bit um some other researchers security researchers looked at it as well and most at least",
    "start": "2718160",
    "end": "2726119"
  },
  {
    "text": "nobody has found the floor yet in this algorithm so that actually seems to work",
    "start": "2726119",
    "end": "2731920"
  },
  {
    "text": "but as I said by default disabled um so what would be improvements and",
    "start": "2731920",
    "end": "2740960"
  },
  {
    "start": "2736000",
    "end": "2736000"
  },
  {
    "text": "recommendations if you actually use plcs in your plant or if you're a vendor um",
    "start": "2740960",
    "end": "2747119"
  },
  {
    "text": "well if you're a vendor um of course you should make sure that your uh",
    "start": "2747119",
    "end": "2754599"
  },
  {
    "text": "engineering software the software which is used to actually implement the user application on the PLC",
    "start": "2754599",
    "end": "2762400"
  },
  {
    "text": "um enables these security protections by default",
    "start": "2762400",
    "end": "2768960"
  },
  {
    "text": "um maybe even does not allow the disabling of these uh protection",
    "start": "2768960",
    "end": "2775520"
  },
  {
    "text": "mechanisms um then of course you should use Integrity protection wherever um uh",
    "start": "2775520",
    "end": "2782599"
  },
  {
    "text": "needed uh using hmx or stuff like that and one other idea is um maybe even disallow",
    "start": "2782599",
    "end": "2791960"
  },
  {
    "text": "connections from one PLC to a second PLC using Port 102 um there might be some",
    "start": "2791960",
    "end": "2798880"
  },
  {
    "text": "valid applications out there but uh we are not aware of such applications uh",
    "start": "2798880",
    "end": "2804880"
  },
  {
    "text": "which need to talk to other plcs using Port 102 um at least not on these very",
    "start": "2804880",
    "end": "2810520"
  },
  {
    "text": "small very simple PCS maybe you could make that a uh configurable um",
    "start": "2810520",
    "end": "2816440"
  },
  {
    "text": "information which is by default um disallow or disabled and would have to",
    "start": "2816440",
    "end": "2823640"
  },
  {
    "text": "be enabled if you if your application needs that um in case you're a user well",
    "start": "2823640",
    "end": "2828880"
  },
  {
    "text": "enable the access protection if it's not by default and maybe Implement firewall rules um these plcs actually scan the",
    "start": "2828880",
    "end": "2837119"
  },
  {
    "text": "network and these plcs connected to the outside they connected to our Command control server uh and that's something",
    "start": "2837119",
    "end": "2843200"
  },
  {
    "text": "plcs usually don't do um currently there are even a couple of um vendors on the",
    "start": "2843200",
    "end": "2848920"
  },
  {
    "text": "market which sell your intrusion detection systems for these plc's which use some kind of machine learning to",
    "start": "2848920",
    "end": "2854960"
  },
  {
    "text": "actually analyze the um Network traffic in your industrial plant and",
    "start": "2854960",
    "end": "2862119"
  },
  {
    "text": "uh actually do an anomally based intrusion detection something that I",
    "start": "2862119",
    "end": "2868000"
  },
  {
    "text": "think doesn't work in normal user lands user local a networks but which works",
    "start": "2868000",
    "end": "2874559"
  },
  {
    "text": "very well in industrial plants because uh as we saw the user applications are",
    "start": "2874559",
    "end": "2879960"
  },
  {
    "text": "uh executed in Cycles so it's very rep rep repetitive um Network traffic you",
    "start": "2879960",
    "end": "2887280"
  },
  {
    "text": "see usually and if suddenly a PLC starts scanning that's something that should be",
    "start": "2887280",
    "end": "2894319"
  },
  {
    "text": "picked up by these intrusion detection systems um so those are very valid as",
    "start": "2894319",
    "end": "2899960"
  },
  {
    "text": "well at least for industrial plants um those animally based intrusion detection systems okay um",
    "start": "2899960",
    "end": "2908759"
  },
  {
    "text": "um uh then we thought what about other vendors is this a Sean only problem um",
    "start": "2909359",
    "end": "2916400"
  },
  {
    "start": "2910000",
    "end": "2910000"
  },
  {
    "text": "and uh we didn't actually implement it but we just looked at other vendors and",
    "start": "2916400",
    "end": "2922160"
  },
  {
    "text": "looked at the fact whether other vendors might be um susceptible to this attack",
    "start": "2922160",
    "end": "2927640"
  },
  {
    "text": "as well uh what did we need actually to implement the war well we needed an ethernet connection um many vendors now",
    "start": "2927640",
    "end": "2934920"
  },
  {
    "text": "Implement ethernet buil in um we needed the fact that the program transfer to",
    "start": "2934920",
    "end": "2940400"
  },
  {
    "text": "the PLC is actually implemented in TCP so you don't use use vport or some other",
    "start": "2940400",
    "end": "2946720"
  },
  {
    "text": "proprietary protocol to transfer the program to the PLC and then within the",
    "start": "2946720",
    "end": "2951839"
  },
  {
    "text": "programming language of the PLC we needed these TCP functions to be able to uh initiate new TCP connections so we",
    "start": "2951839",
    "end": "2959440"
  },
  {
    "text": "took just a look at the current leading vendors and if you're a vendor and you're not on this list I'm sorry um so",
    "start": "2959440",
    "end": "2966119"
  },
  {
    "text": "we just took took a an avatary um uh group of leading vendors uh seamons",
    "start": "2966119",
    "end": "2973640"
  },
  {
    "text": "Mitsubishi Schneider and Rockwell Automation and um those models um they",
    "start": "2973640",
    "end": "2979680"
  },
  {
    "text": "currently sell um and first we look that um all TCP vendors which have um",
    "start": "2979680",
    "end": "2987559"
  },
  {
    "start": "2982000",
    "end": "2982000"
  },
  {
    "text": "industrial ethernet uh connections and E connectors and where the program",
    "start": "2987559",
    "end": "2994559"
  },
  {
    "text": "transfer actually is implemented using either TCP or UDP protocols um the only well all vendors",
    "start": "2994559",
    "end": "3002040"
  },
  {
    "text": "are affected actually the only model that uh doesn't have industrial ethernet",
    "start": "3002040",
    "end": "3007119"
  },
  {
    "text": "is this modicon easy by Schneider uh which is well very very very small model",
    "start": "3007119",
    "end": "3014880"
  },
  {
    "text": "um then we look at um those models which actually sport TCP IP functions and as",
    "start": "3014880",
    "end": "3021640"
  },
  {
    "start": "3015000",
    "end": "3015000"
  },
  {
    "text": "you can see seens yes but Mitsubishi as well workw automation as well the only one",
    "start": "3021640",
    "end": "3027240"
  },
  {
    "text": "that doesn't have or where we didn't find such functions is mitsubish which",
    "start": "3027240",
    "end": "3034280"
  },
  {
    "text": "uh sorry Schneider uh which doesn't mean that it's not possible actually to do that there uh but maybe we just didn't",
    "start": "3034280",
    "end": "3041440"
  },
  {
    "text": "find the correct functions other than that uh theoretically all these models",
    "start": "3041440",
    "end": "3047280"
  },
  {
    "text": "are susceptible to the same attack if you don't Implement uh the uh appropriate security",
    "start": "3047280",
    "end": "3054799"
  },
  {
    "text": "counter measures um of course some of these probably are secure or very very",
    "start": "3054799",
    "end": "3063839"
  },
  {
    "text": "much harder to to attack than the attack we showed you like the current S7 1500",
    "start": "3063839",
    "end": "3069480"
  },
  {
    "text": "for example from seens um this one uses a very new protocol which is now",
    "start": "3069480",
    "end": "3074599"
  },
  {
    "text": "implemented in the version four of the uh 1200 model as well and they use um uh",
    "start": "3074599",
    "end": "3082000"
  },
  {
    "text": "much better Integrity checking and authentication and even encryption um within the protocol uh it has been",
    "start": "3082000",
    "end": "3089559"
  },
  {
    "text": "totally revised so uh we're currently looking into that um but uh currently",
    "start": "3089559",
    "end": "3096119"
  },
  {
    "text": "we're not able to replicate this attack on these machines and we don't know whether it is possible to do",
    "start": "3096119",
    "end": "3103319"
  },
  {
    "text": "that okay um so um uh to for the takeaway message",
    "start": "3103319",
    "end": "3110920"
  },
  {
    "start": "3105000",
    "end": "3105000"
  },
  {
    "text": "essentially um be reminded of the fact that these",
    "start": "3110920",
    "end": "3117000"
  },
  {
    "text": "plc's actually are just PCS and of course they have the same",
    "start": "3117000",
    "end": "3122640"
  },
  {
    "text": "vulnerabilities normal PC has got um and um maybe",
    "start": "3122640",
    "end": "3128799"
  },
  {
    "text": "even worse than that because usually most of these plcs don't have any buil",
    "start": "3128799",
    "end": "3134839"
  },
  {
    "text": "in security counter measures so there's mostly no fire on these plc's uh they um",
    "start": "3134839",
    "end": "3142480"
  },
  {
    "text": "don't require passwords for accessing the PLC um",
    "start": "3142480",
    "end": "3148240"
  },
  {
    "text": "remember think about a talet server not requiring a password for root access",
    "start": "3148240",
    "end": "3154160"
  },
  {
    "text": "that's what many of these plc's are like especially the older ones if you if you",
    "start": "3154160",
    "end": "3159520"
  },
  {
    "text": "look at the most current uh systems they are much better but then again be",
    "start": "3159520",
    "end": "3165359"
  },
  {
    "text": "reminded of the fact that the life cycle of these machines is often 15 to 30 years so you buy them some kind of",
    "start": "3165359",
    "end": "3173319"
  },
  {
    "text": "machine today which is controlled by such a PLC um the the user will not change the PLC",
    "start": "3173319",
    "end": "3181200"
  },
  {
    "text": "within the next 15 20 or 25 years why should he it's",
    "start": "3181200",
    "end": "3186280"
  },
  {
    "text": "working and with the uh with the the common trend of connecting all these",
    "start": "3186280",
    "end": "3193240"
  },
  {
    "text": "machines in your plant to the internet or to your internal network uh to to uh interconnect and to",
    "start": "3193240",
    "end": "3202280"
  },
  {
    "text": "uh be able to uh react for example to customer request very fast and to",
    "start": "3202280",
    "end": "3207920"
  },
  {
    "text": "automate that uh very fast um we see",
    "start": "3207920",
    "end": "3213200"
  },
  {
    "text": "well uh some kind of threat going from coming from these plc's because as I",
    "start": "3213200",
    "end": "3219000"
  },
  {
    "text": "said they are not just the target of the attack but in this case they're even the",
    "start": "3219000",
    "end": "3224079"
  },
  {
    "text": "source of the attack and as Mike demonstrated it's very hard for you to verify the code on",
    "start": "3224079",
    "end": "3232040"
  },
  {
    "text": "these systems um let's imagine that the",
    "start": "3232040",
    "end": "3237319"
  },
  {
    "text": "original uh user application already has got this copy protection Ora protection turned on Mike would make sure that his",
    "start": "3237319",
    "end": "3245280"
  },
  {
    "text": "worm would turn on the no protection copy protection as well then youve got the TR portal and",
    "start": "3245280",
    "end": "3251520"
  },
  {
    "text": "you want to connect to that system and you want to retrieve the code you cannot there's not nothing like a virus",
    "start": "3251520",
    "end": "3257720"
  },
  {
    "text": "scan for PLC code uh there's no way to actually verify the Integrity of the",
    "start": "3257720",
    "end": "3264440"
  },
  {
    "text": "code running on the plc um and that's something that has to be",
    "start": "3264440",
    "end": "3269720"
  },
  {
    "text": "tackled by the uh security vendors as well uh not just the vendors of the plcs",
    "start": "3269720",
    "end": "3276680"
  },
  {
    "text": "so that's my takeaway or our takeaway for you from the talk and that's the",
    "start": "3276680",
    "end": "3284119"
  },
  {
    "text": "answer and we're open for [Applause]",
    "start": "3284119",
    "end": "3291369"
  },
  {
    "text": "questions any question no",
    "start": "3292599",
    "end": "3298319"
  },
  {
    "text": "okay well I hope you enjoyed it and uh I hope we get this board back to to Germany through customs and security um",
    "start": "3299520",
    "end": "3307839"
  },
  {
    "text": "and um uh if you have any further questions you won't want to talk about",
    "start": "3307839",
    "end": "3313880"
  },
  {
    "text": "here in public we're available to today and tomorrow and lat at the reception uh",
    "start": "3313880",
    "end": "3319359"
  },
  {
    "text": "so um well if not thank you",
    "start": "3319359",
    "end": "3325670"
  },
  {
    "text": "[Applause]",
    "start": "3325670",
    "end": "3328920"
  }
]