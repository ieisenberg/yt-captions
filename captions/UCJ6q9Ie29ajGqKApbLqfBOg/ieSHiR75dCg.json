[
  {
    "text": "well um thanks very much for coming and uh",
    "start": "359",
    "end": "6240"
  },
  {
    "text": "obviously the introduction's already taking place there's no need for me to say I'm David Lichfield and so on",
    "start": "6240",
    "end": "13200"
  },
  {
    "text": "um but I would like to make this talk um fairly informal um so if anybody has uh questions as I'm",
    "start": "13200",
    "end": "19920"
  },
  {
    "text": "going along please wave a hand wave it rather furiously just in case I don't see it by the way if you've got any",
    "start": "19920",
    "end": "25800"
  },
  {
    "text": "questions as I said please uh just interrupt me so just a quick introduction as to who",
    "start": "25800",
    "end": "32940"
  },
  {
    "text": "NGS software are we write auditing Tools in terms of software we perform consultancy doing penetration tests and",
    "start": "32940",
    "end": "39960"
  },
  {
    "text": "so on but research is pretty much where I'm at you know looking for vulnerabilities in",
    "start": "39960",
    "end": "45180"
  },
  {
    "text": "um common off-the-shelf products today we're going to talk about",
    "start": "45180",
    "end": "50640"
  },
  {
    "text": "Microsoft SQL Server initially I was going to talk about Oracle issues as well but I've decided to just condense",
    "start": "50640",
    "end": "56899"
  },
  {
    "text": "today's talk on on SQL issues Microsoft SQL issues we'll look at traditional",
    "start": "56899",
    "end": "63000"
  },
  {
    "text": "vulnerabilities things that have been around for a long while we'll go on to a new issue that was",
    "start": "63000",
    "end": "68340"
  },
  {
    "text": "released the other day talking about specifically the SQL monitor Port used for name resolution go",
    "start": "68340",
    "end": "75000"
  },
  {
    "text": "on to compromising a SQL Server um and then I'll talk about some uh window Shell Code",
    "start": "75000",
    "end": "81540"
  },
  {
    "text": "um that is doesn't use the it's not traditional window Shell Code it doesn't use name pipes but we'll get into that",
    "start": "81540",
    "end": "87840"
  },
  {
    "text": "uh later on okay Microsoft SQL Server traditionally",
    "start": "87840",
    "end": "93840"
  },
  {
    "text": "is known for having blank assay passwords or Pro uh going back to",
    "start": "93840",
    "end": "99840"
  },
  {
    "text": "earlier versions unfortunately the recent or fortunately rather the the recent spider-wom which went around",
    "start": "99840",
    "end": "106740"
  },
  {
    "text": "exploiting SQL servers with a blank essay password has put an end to that hopefully so uh we will not see this",
    "start": "106740",
    "end": "113880"
  },
  {
    "text": "happening very often anymore um Extended sort procedures they're famous",
    "start": "113880",
    "end": "119100"
  },
  {
    "text": "for their buffer overflow vulnerabilities um I think there is at least 16 or 17 extended soil procedures that have",
    "start": "119100",
    "end": "124979"
  },
  {
    "text": "buffer overflow issues in them um for those that don't know an extended store procedure is basically",
    "start": "124979",
    "end": "131120"
  },
  {
    "text": "extra functionality non-sql functionality that's exported by a dll",
    "start": "131120",
    "end": "137459"
  },
  {
    "text": "and you would call um this you know extra functionality by um executing just like a normal stored",
    "start": "137459",
    "end": "145080"
  },
  {
    "text": "procedure that contains a batch of SQL um there used to be issues with",
    "start": "145080",
    "end": "150599"
  },
  {
    "text": "temporary stored procedures where um because it was temporary no permissions checking was done uh",
    "start": "150599",
    "end": "157080"
  },
  {
    "text": "consequently uh someone could create a temporary stored procedure that called something like XP underscore CMD shell",
    "start": "157080",
    "end": "162840"
  },
  {
    "text": "and they would gain access to it when they would normally not have access to it obviously CIS admins only have access",
    "start": "162840",
    "end": "168000"
  },
  {
    "text": "to exp underscore CMD shell then of course there was another issue with open road set abuse with open row set you can",
    "start": "168000",
    "end": "174780"
  },
  {
    "text": "run ad hoc queries and cause the server to loop back upon itself using a trusted connection and consequently the SQL",
    "start": "174780",
    "end": "181620"
  },
  {
    "text": "Server would use its own credentials to to to log back into itself and again one",
    "start": "181620",
    "end": "186720"
  },
  {
    "text": "could upgrade privileges that way so these are the traditional kind of vulnerabilities",
    "start": "186720",
    "end": "192720"
  },
  {
    "text": "um indeed even today these these things are being found especially issues with",
    "start": "192720",
    "end": "198120"
  },
  {
    "text": "extended sub procedures in fact a number of database vendors choose not to employ",
    "start": "198120",
    "end": "203519"
  },
  {
    "text": "things like extended sub procedures simply because they are known to have loads of vulnerabilities in them for",
    "start": "203519",
    "end": "209580"
  },
  {
    "text": "example Rubik's from rubiks.com don't use stored procedures simply because of",
    "start": "209580",
    "end": "214980"
  },
  {
    "text": "this issue Rubix is designed specifically for trusted Solaris if you're in in a",
    "start": "214980",
    "end": "222060"
  },
  {
    "text": "military system and you're protecting secret information Rubix is worth a look at",
    "start": "222060",
    "end": "227879"
  },
  {
    "text": "um Oracle again um had problems um with a non-authink unauthenticated",
    "start": "227879",
    "end": "234420"
  },
  {
    "text": "system compromised with the stored procedure issue basically when you create a library on an oracle server you",
    "start": "234420",
    "end": "242159"
  },
  {
    "text": "essentially tell um the the listener to load this Library",
    "start": "242159",
    "end": "247200"
  },
  {
    "text": "exactly this function and pass it these parameters and unfortunately an attacker could insert themselves in between that",
    "start": "247200",
    "end": "252959"
  },
  {
    "text": "Communications process and directly to speak to the listeners you know without passing credentials and say I am an",
    "start": "252959",
    "end": "258780"
  },
  {
    "text": "oracle process please launch this uh please load this Library exec this",
    "start": "258780",
    "end": "263880"
  },
  {
    "text": "function and pass it these parameters so this kind of error in terms of database functionality definitely seems to be",
    "start": "263880",
    "end": "270060"
  },
  {
    "text": "where most of the problems lie the the external stored procedure issues um",
    "start": "270060",
    "end": "276600"
  },
  {
    "text": "so these specific traditional SQL Server attacks we've just been speaking about",
    "start": "276600",
    "end": "282180"
  },
  {
    "text": "and Microsoft SQL attacks nowadays other than the blank passwords most of these",
    "start": "282180",
    "end": "287940"
  },
  {
    "text": "in fact all of these attacks require the user to be able to log in in some form or fashion so that requires a user ID",
    "start": "287940",
    "end": "294180"
  },
  {
    "text": "and password now obviously where SQL injection comes into this you have a web application that has a user ID and",
    "start": "294180",
    "end": "300540"
  },
  {
    "text": "password defined for you these attacks are going to be you know extremely relevant for you because the the web",
    "start": "300540",
    "end": "307320"
  },
  {
    "text": "application defines the user ID and password and you're authenticated so although I I do say most of these",
    "start": "307320",
    "end": "314280"
  },
  {
    "text": "attacks require a user ID and password it's not uncommon for that to be provided for you anyway especially with",
    "start": "314280",
    "end": "319979"
  },
  {
    "text": "SQL injections so they're still worth looking at so are there ways to look at a SQL",
    "start": "319979",
    "end": "327900"
  },
  {
    "text": "server without credentials in terms of you know compromising it well at first I thought PWD encrypts someone I can't",
    "start": "327900",
    "end": "334500"
  },
  {
    "text": "remember the name jimmers I think actually um the guy who was playing with SQL and",
    "start": "334500",
    "end": "339780"
  },
  {
    "text": "encryption and decryption um founder buffer overflow in PWD encrypt the other day Microsoft released",
    "start": "339780",
    "end": "346020"
  },
  {
    "text": "a patch for that um about two weeks ago about two right two two to four weeks",
    "start": "346020",
    "end": "353400"
  },
  {
    "text": "ago now when an SQL login I.E not a Windows authenticated user someone who",
    "start": "353400",
    "end": "359039"
  },
  {
    "text": "has a Windows sorry an SQL login defined for them PWD encrypt is used at the same",
    "start": "359039",
    "end": "364199"
  },
  {
    "text": "time now I I took a quick look at it I didn't look at it enough and this is why there's loads of question marks at the",
    "start": "364199",
    "end": "370380"
  },
  {
    "text": "end of this when you log in with a SQL login account the PWD encryption functions used so I was wondering if I",
    "start": "370380",
    "end": "377820"
  },
  {
    "text": "could provide an overly long password you know in the odbc connection whether I could cause this over trigger this",
    "start": "377820",
    "end": "384300"
  },
  {
    "text": "overflow in PWD encrypt I was not successful that's not to say that it's not vulnerable though I just didn't look",
    "start": "384300",
    "end": "389759"
  },
  {
    "text": "hard enough perhaps so that said because there's a patch for it um this is is",
    "start": "389759",
    "end": "395039"
  },
  {
    "text": "going to be providing that the system is fully patched if you're attempting to break into it PWD encrypt is out the",
    "start": "395039",
    "end": "401340"
  },
  {
    "text": "window so that left me with a a new thing to I had to look for a new",
    "start": "401340",
    "end": "406500"
  },
  {
    "text": "way now SQL ping a Nifty little utility created by chip Andrews of",
    "start": "406500",
    "end": "412039"
  },
  {
    "text": "sqlsecurity.com chips a great bloke it only has a great size well sqlsecurity.com if you are responsible",
    "start": "412039",
    "end": "418919"
  },
  {
    "text": "for securing Microsoft SQL database Services bookmark this site and put it in one of",
    "start": "418919",
    "end": "424919"
  },
  {
    "text": "your favorite favorites kind of thing it's definitely worth a read um lots of good information there and a",
    "start": "424919",
    "end": "430080"
  },
  {
    "text": "discussion board as as well um so anyway chip Andrew has released this this talk called SQL ping and",
    "start": "430080",
    "end": "436800"
  },
  {
    "text": "essentially it is um a name resolution tool it will fire off a single UDP packet with a single",
    "start": "436800",
    "end": "444900"
  },
  {
    "text": "byte UDP packet to UDP Port 1434 on the the SQL Server",
    "start": "444900",
    "end": "451020"
  },
  {
    "text": "um the the single byte being a zero two and SQL Server will respond with information such as actually I've got it",
    "start": "451020",
    "end": "458819"
  },
  {
    "text": "here if you look on my right I don't know if you can see it maybe I should",
    "start": "458819",
    "end": "463979"
  },
  {
    "text": "increase the font it replies with information such as the server name the instance name",
    "start": "463979",
    "end": "469979"
  },
  {
    "text": "um whether it's clustered a diversion number and everything like that incidentally the version number being reported back is wrong",
    "start": "469979",
    "end": "475919"
  },
  {
    "text": "um version 8.00.194 is SQL server with no service",
    "start": "475919",
    "end": "482220"
  },
  {
    "text": "packs but even when you apply service packs um SQL ping or rather SQL Server still",
    "start": "482220",
    "end": "488460"
  },
  {
    "text": "reply with the version the version number of um no service packs that that so don't",
    "start": "488460",
    "end": "493919"
  },
  {
    "text": "don't trust that information because it's incorrect now in terms of named instances this is",
    "start": "493919",
    "end": "500160"
  },
  {
    "text": "something that was introduced um with SQL Server 2000 you can have essentially multiple instances of SQL",
    "start": "500160",
    "end": "507180"
  },
  {
    "text": "Server that use different named instances like Foo and bar and essentially",
    "start": "507180",
    "end": "512219"
  },
  {
    "text": "um you would use um SQL name resolution to determine which one to connect to so query",
    "start": "512219",
    "end": "517680"
  },
  {
    "text": "analyzer or the Enterprise Manager would simply send a udb packet zero two to to",
    "start": "517680",
    "end": "524039"
  },
  {
    "text": "the server and ask for this information such as you know what named instances do you have obviously if you don't have any",
    "start": "524039",
    "end": "530220"
  },
  {
    "text": "named instances other than the default it's going to be Ms SQL Server whether there are named extra named instances or",
    "start": "530220",
    "end": "537060"
  },
  {
    "text": "not SQL Server will still reply with this information so it's a bit of information information leakage anyway",
    "start": "537060",
    "end": "542660"
  },
  {
    "text": "that in itself is is not too much of a major problem however when I saw this",
    "start": "542660",
    "end": "548880"
  },
  {
    "text": "tool um and saw that it was sending only a single byte packet zero two and that's",
    "start": "548880",
    "end": "553980"
  },
  {
    "text": "hex zero two by the way the question that sprung to mind is well what does the others you know what",
    "start": "553980",
    "end": "559260"
  },
  {
    "text": "do the others do zero zero zero one zero three all the way to FF so I wrote a a",
    "start": "559260",
    "end": "564839"
  },
  {
    "text": "simple UDP scanner that you know went through from zero to FF",
    "start": "564839",
    "end": "570420"
  },
  {
    "text": "um to to find out if I could elicit a different response from the SQL server and by eight SQL Server had died now",
    "start": "570420",
    "end": "577440"
  },
  {
    "text": "that immediately grabbed my attention obviously so what was going on by looking at the",
    "start": "577440",
    "end": "584160"
  },
  {
    "text": "assembly you know when I was when I was debugging it um this is essentially what the code is doing at that point in an unpatched",
    "start": "584160",
    "end": "590220"
  },
  {
    "text": "version obviously there is now patch for these these issues by the way um I'll talk about that later essentially someone's declaring the code",
    "start": "590220",
    "end": "597300"
  },
  {
    "text": "has declared a a pointer to um like a character pointer you know",
    "start": "597300",
    "end": "602399"
  },
  {
    "text": "initialize it to null whatever and you know it created an INT variable as well X unfortunately what they do when SQL",
    "start": "602399",
    "end": "610019"
  },
  {
    "text": "Server receives a packet with um the first byte set to zero eight it does some extra processing and essentially",
    "start": "610019",
    "end": "616080"
  },
  {
    "text": "what it does is causes stratok now stratok looks for a specific token within a string so in this case it's",
    "start": "616080",
    "end": "623880"
  },
  {
    "text": "looking for for a colon now if there is no column if we just send a zero eight",
    "start": "623880",
    "end": "629820"
  },
  {
    "text": "um a single byte packet you know with zero eight when it looks at UDP input and and performs stratok because there",
    "start": "629820",
    "end": "637560"
  },
  {
    "text": "is no colon in our input the pointer the return from stratok is null that there is no pointer to a colon in the string",
    "start": "637560",
    "end": "643920"
  },
  {
    "text": "so unfortunately what happened was the pointer is then passed to a2i without having been checked whether it's a valid",
    "start": "643920",
    "end": "650459"
  },
  {
    "text": "pointer or not and hence the the process access violates and dies now obviously what what they needed to",
    "start": "650459",
    "end": "656700"
  },
  {
    "text": "do um and and have done in terms of the patch in in terms of this is check whether you know Straight Talk returns a",
    "start": "656700",
    "end": "662579"
  },
  {
    "text": "valid pointer if it does um then continue processing if not error out um but",
    "start": "662579",
    "end": "669620"
  },
  {
    "text": "sorry well it depends on on the first bite you see um zero two basically says",
    "start": "669620",
    "end": "676860"
  },
  {
    "text": "give me standard information back zero eight does a different action we'll see",
    "start": "676860",
    "end": "682500"
  },
  {
    "text": "that zero four does something else and zero a um basically if I send a zero a to a SQL",
    "start": "682500",
    "end": "687899"
  },
  {
    "text": "Server it will reply back to me with a zero a yeah so there's a simple denial of service there you know network based",
    "start": "687899",
    "end": "694140"
  },
  {
    "text": "I set my source port to 1434 spoof the IP address of another SQL server and",
    "start": "694140",
    "end": "699899"
  },
  {
    "text": "then they start going like this to each other it's um it's really only interesting in in terms",
    "start": "699899",
    "end": "707040"
  },
  {
    "text": "of the fun Factor you know seeing you know them them pinging each other to death essentially",
    "start": "707040",
    "end": "712260"
  },
  {
    "text": "um it's definitely something that should be effects though because obviously if you've got a a number of SQL servers on",
    "start": "712260",
    "end": "717779"
  },
  {
    "text": "your DMZ um you don't want them to start paying each other you know now we'll stop we'll",
    "start": "717779",
    "end": "723720"
  },
  {
    "text": "talk about firewall stuff later on but essentially if let's say you have an externally hosted DNS server if I spoof",
    "start": "723720",
    "end": "730740"
  },
  {
    "text": "the IP address of uh your external DNS server set the source port to 53 that will more than likely go through your",
    "start": "730740",
    "end": "736920"
  },
  {
    "text": "firewall yeah and if you're using a non-rfc 1918 address I.E it's a routable",
    "start": "736920",
    "end": "742019"
  },
  {
    "text": "address then and I can find um your SQL servers these attacks will",
    "start": "742019",
    "end": "747120"
  },
  {
    "text": "go through the firewall kind of thing yeah so or alternatively if you're using RFC 19 1800 well it won't go there",
    "start": "747120",
    "end": "754680"
  },
  {
    "text": "essentially um if I I could also you know spoof the",
    "start": "754680",
    "end": "760079"
  },
  {
    "text": "IP address of an internal address as well so the firewall some firewalls will you know think well this is you know got",
    "start": "760079",
    "end": "765779"
  },
  {
    "text": "a cleaning you know IP address so just pass it through the firewall um obviously we'll talk about more more",
    "start": "765779",
    "end": "771899"
  },
  {
    "text": "about firewall issues later on and and how to protect against these attacks and how you should set it up so but yeah",
    "start": "771899",
    "end": "779240"
  },
  {
    "text": "there were two SQL servers behind the firewall and where in the front I'm sorry I say you'd have",
    "start": "779240",
    "end": "785160"
  },
  {
    "text": "to sort out that there were two SQL servers and you think that's a difficult proposition and do you think that's a difficult",
    "start": "785160",
    "end": "791339"
  },
  {
    "text": "proposition it could be well I think I think it's easy personally um well",
    "start": "791339",
    "end": "799139"
  },
  {
    "text": "um when you're doing a penetration test um this this is the kind of information that you need to gather to effectively",
    "start": "799860",
    "end": "808019"
  },
  {
    "text": "um succeed in your penetration test obviously if the pen tester succeeds it's bad for the company well it's good",
    "start": "808019",
    "end": "813360"
  },
  {
    "text": "in a way because they can start resolving these holes and stuff but um information gathering is one of the first things you'll do in in a pen test",
    "start": "813360",
    "end": "820200"
  },
  {
    "text": "and that kind of information you know you should be able to get um and then there's always guesswork you",
    "start": "820200",
    "end": "826620"
  },
  {
    "text": "can always rely on as well you know if um you for example we know SQL Server is",
    "start": "826620",
    "end": "831959"
  },
  {
    "text": "traditionally found with an is setup and there are a number of ways to stick to an IIs machine to get its IP address",
    "start": "831959",
    "end": "838740"
  },
  {
    "text": "back you know um you know so if they're using an R2 1918 address and they're using",
    "start": "838740",
    "end": "844700"
  },
  {
    "text": "10.1.1.x then we can start um you know playing around with that unfortunately these SQL UDP issues work",
    "start": "844700",
    "end": "851820"
  },
  {
    "text": "over broadcast as well so I don't even need to guess the IP the specific IP address I just go for the broadcast and",
    "start": "851820",
    "end": "857700"
  },
  {
    "text": "I'll hit it you know so these are there are issues you know so",
    "start": "857700",
    "end": "865639"
  },
  {
    "text": "um sorry was that yes all right sorry okay",
    "start": "867180",
    "end": "872220"
  },
  {
    "text": "so as I've already said um the the problem with that bit of code it wasn't checking the the return value of",
    "start": "872220",
    "end": "877980"
  },
  {
    "text": "straight talk before it was passing it to a2i hence the crash so when you look at it further what",
    "start": "877980",
    "end": "884519"
  },
  {
    "text": "um that part of the code is actually looking for is you know when the first part is set to zero eight it expects a",
    "start": "884519",
    "end": "892019"
  },
  {
    "text": "string then a colon then a number now um as it turns out that's all about",
    "start": "892019",
    "end": "898680"
  },
  {
    "text": "um using the via VIA I'm not sure whether it's pronounced by or whether it's broken down into you know the Via",
    "start": "898680",
    "end": "906480"
  },
  {
    "text": "or what but essentially um that this part the the the functionality is to do with the Via",
    "start": "906480",
    "end": "913199"
  },
  {
    "text": "protocol um now unfortunately if you put an extremely",
    "start": "913199",
    "end": "918240"
  },
  {
    "text": "long string in here you know colon number you know to avoid the crash um there's a heap overflow an",
    "start": "918240",
    "end": "923399"
  },
  {
    "text": "exploitable Heap overflow um so the the only thing with this one",
    "start": "923399",
    "end": "928620"
  },
  {
    "text": "is you have to send three three packets um for the Heap overflow to work",
    "start": "928620",
    "end": "934800"
  },
  {
    "text": "um so that one's more of a headache to exploit there's an easier one to exploit so uh we'll look at that one",
    "start": "934800",
    "end": "942120"
  },
  {
    "text": "and to regimon a great tool from sysentonals.com um is one of you know the tools I",
    "start": "942120",
    "end": "947639"
  },
  {
    "text": "frequently use in my toolkit and when I found that crash and and the Heap overflow in in the the service I went",
    "start": "947639",
    "end": "953220"
  },
  {
    "text": "back to you know zero one three and four and everything to see if I'd missed something and indeed when I sent zero",
    "start": "953220",
    "end": "960420"
  },
  {
    "text": "four you know I started putting on a string at the end so I sent zero four AAA and NT regimon kicked in and showed",
    "start": "960420",
    "end": "967800"
  },
  {
    "text": "me that there was a registry key attempting to be opened hqlm software Microsoft Microsoft SQL Server AAA Ms",
    "start": "967800",
    "end": "974459"
  },
  {
    "text": "SQL Server current version so here is user input that's being plugged into you",
    "start": "974459",
    "end": "980100"
  },
  {
    "text": "know um querying the registry um now in the process of building that",
    "start": "980100",
    "end": "986279"
  },
  {
    "text": "registry key uh you know to to do a reg query",
    "start": "986279",
    "end": "991500"
  },
  {
    "text": "um there's a plain old classic stack Overflow there um so that's the one we'll specifically",
    "start": "991500",
    "end": "998100"
  },
  {
    "text": "be looking at today um so the code I'm going to be you know",
    "start": "998100",
    "end": "1003860"
  },
  {
    "text": "demonstrating shortly is um shell code is reverse Shell Code specifically um does anybody in this room not know",
    "start": "1003860",
    "end": "1010160"
  },
  {
    "text": "what shellcode is don't be embarrassed because if you don't oh well I'll just explain quickly",
    "start": "1010160",
    "end": "1017060"
  },
  {
    "text": "essentially shell code is um it effectively effectively gives me a command prompt as if I'm sat on that",
    "start": "1017060",
    "end": "1024199"
  },
  {
    "text": "server the remote server was that mine or yours yours right um",
    "start": "1024199",
    "end": "1030500"
  },
  {
    "text": "this is going to be the server in the test by the way and if this was across the other side of the internet my shell",
    "start": "1030500",
    "end": "1035660"
  },
  {
    "text": "code will give me a shout as if I'm sat at the console here a Windows NT command prompt now traditional window shell code is Big",
    "start": "1035660",
    "end": "1043280"
  },
  {
    "text": "it's about six to seven hundred bytes and the reason it is uh that big is because when you're you know creating",
    "start": "1043280",
    "end": "1049340"
  },
  {
    "text": "your show you go through the crate process and you provide um pipes",
    "start": "1049340",
    "end": "1054679"
  },
  {
    "text": "um as as handles Anonymous pipes as handles for standard and standard out and standard error so you can you know",
    "start": "1054679",
    "end": "1061100"
  },
  {
    "text": "pass your command to the uh the the the the vulnerable process over TCP it then",
    "start": "1061100",
    "end": "1068780"
  },
  {
    "text": "uses the pipes to communicate to cmd.exe and that is passed back out again through these pipes now that",
    "start": "1068780",
    "end": "1074960"
  },
  {
    "text": "unfortunately bloats the code because we have to do all sorts of things like you know creating the pipes through the window socket stuff that is not",
    "start": "1074960",
    "end": "1081740"
  },
  {
    "text": "necessary whatsoever by using wsa socket we can essentially create a socket that",
    "start": "1081740",
    "end": "1087620"
  },
  {
    "text": "is valid as a handle for standard in standard out and standard error so essentially what we can do is create the",
    "start": "1087620",
    "end": "1094640"
  },
  {
    "text": "socket past this is the handle for you know create process for standard in standard on standard error",
    "start": "1094640",
    "end": "1101260"
  },
  {
    "text": "and then ignore the rest of the process we don't you know the the vulnerable process we can just exit thread from",
    "start": "1101260",
    "end": "1107059"
  },
  {
    "text": "there and let it continue we don't need to even keep that alive we can kill it if we want but CMD is a process in and",
    "start": "1107059",
    "end": "1112700"
  },
  {
    "text": "of its own you know rights essentially um and functions perfectly well so we'll",
    "start": "1112700",
    "end": "1119000"
  },
  {
    "text": "be using wsa socket to do this um so essentially what we need to do is",
    "start": "1119000",
    "end": "1125600"
  },
  {
    "text": "call wsa startup then wsa socket bind that socket to the IP address connect",
    "start": "1125600",
    "end": "1132140"
  },
  {
    "text": "and then create the process passing out the handles now if sockets are already",
    "start": "1132140",
    "end": "1137240"
  },
  {
    "text": "loaded um into you know the address space I.E you",
    "start": "1137240",
    "end": "1142280"
  },
  {
    "text": "know WS2 underscore 32.dll and when w s sock32.dlo I loaded into the address",
    "start": "1142280",
    "end": "1147860"
  },
  {
    "text": "space we don't actually need to call wsa start because it's already you know be been started up so",
    "start": "1147860",
    "end": "1154940"
  },
  {
    "text": "um even if you call wsa startup you can get by hard coding addresses your",
    "start": "1154940",
    "end": "1160520"
  },
  {
    "text": "windows Shell Code down to 168 bytes um now often traditional window shell",
    "start": "1160520",
    "end": "1166760"
  },
  {
    "text": "code is too big to fit into a lot of exploits you know you've only got maybe 200 bytes of buffer space to play with",
    "start": "1166760",
    "end": "1173120"
  },
  {
    "text": "by bringing it down the size below 200 bytes you know pretty much every single",
    "start": "1173120",
    "end": "1178280"
  },
  {
    "text": "remote buffer overflow can be you can use this method for for that again",
    "start": "1178280",
    "end": "1183500"
  },
  {
    "text": "removing wsa startup from this you could probably get it down to maybe 150 bytes",
    "start": "1183500",
    "end": "1190299"
  },
  {
    "text": "144 bytes or thereabouts as it happens the code published in the",
    "start": "1190299",
    "end": "1195380"
  },
  {
    "text": "end of this book um I think I'm on the last couple of pages um I'm not hard coding addresses because",
    "start": "1195380",
    "end": "1203539"
  },
  {
    "text": "I want my code to be portable so essentially I'm going through the the process of like calling load Library get",
    "start": "1203539",
    "end": "1210320"
  },
  {
    "text": "proc address so it shouldn't work across all platforms and service packs and indeed it does well hopefully this is",
    "start": "1210320",
    "end": "1217059"
  },
  {
    "text": "probably the third time about to test it on XP um so it should run anyway",
    "start": "1217059",
    "end": "1222500"
  },
  {
    "text": "so this is what we're going to do so in terms of compromising the SQL",
    "start": "1222500",
    "end": "1227720"
  },
  {
    "text": "Server we we're going to set netcat listening on our system here we have netcat we've",
    "start": "1227720",
    "end": "1235640"
  },
  {
    "text": "set the port to 80. I'm not sure if the the font's too small um I've said it as",
    "start": "1235640",
    "end": "1240679"
  },
  {
    "text": "big as I can essentially we're running netcat by NC minus L minus p and the port we're listing on is 80. as most",
    "start": "1240679",
    "end": "1247460"
  },
  {
    "text": "firewalls will allow 80 out um cool excuse me as most firewalls will",
    "start": "1247460",
    "end": "1255440"
  },
  {
    "text": "allow Port 80 out um you know that we'll give this one a shot first",
    "start": "1255440",
    "end": "1261200"
  },
  {
    "text": "um the command line is the name of the",
    "start": "1261200",
    "end": "1267799"
  },
  {
    "text": "program's SQL UDP I provide the name of the host which I'm attacking I have",
    "start": "1267799",
    "end": "1272840"
  },
  {
    "text": "Priceless in this case and this is this is the server over here um I supplied the IP address of my",
    "start": "1272840",
    "end": "1279980"
  },
  {
    "text": "system where the remote shall where I want the remote shelf to come back to 10.1.1.27.",
    "start": "1279980",
    "end": "1286580"
  },
  {
    "text": "um specify the port I'm listing on and um the SQL Service Pack now",
    "start": "1286580",
    "end": "1293360"
  },
  {
    "text": "unfortunately what what the problem here is I'm using sqlsort.dll which I thought",
    "start": "1293360",
    "end": "1300559"
  },
  {
    "text": "at first was consistent across all SQL service packs but unfortunately it's not the import address entry for get proc",
    "start": "1300559",
    "end": "1306860"
  },
  {
    "text": "address is off by 12 bytes so the code in in in your blackout manual things is",
    "start": "1306860",
    "end": "1315080"
  },
  {
    "text": "actually wrong I stay in there the escrow sort dll is um consistent it's",
    "start": "1315080",
    "end": "1320179"
  },
  {
    "text": "not as I said there's a difference in the offset of get proc address so I've",
    "start": "1320179",
    "end": "1325700"
  },
  {
    "text": "updated that code to reflect whether it's Service Pack zero or above um",
    "start": "1325700",
    "end": "1331039"
  },
  {
    "text": "now let's see",
    "start": "1331039",
    "end": "1336760"
  },
  {
    "text": "right there's my shoulders dropped in um this because I'm running SQL servers",
    "start": "1338780",
    "end": "1344539"
  },
  {
    "text": "local system if I do a host name",
    "start": "1344539",
    "end": "1350000"
  },
  {
    "text": "I can see I'm feistus on this shell and if I do a hostname here",
    "start": "1350000",
    "end": "1356480"
  },
  {
    "text": "I'm computer name so we we essentially have a remote reverse shell to the SQL",
    "start": "1356480",
    "end": "1363080"
  },
  {
    "text": "server and this was on authenticated all we did was essentially send um zero four as the first byte buffer",
    "start": "1363080",
    "end": "1370400"
  },
  {
    "text": "then exploit code um so we have a um a local system",
    "start": "1370400",
    "end": "1375799"
  },
  {
    "text": "reverse shell so and as we can see we haven't had to go",
    "start": "1375799",
    "end": "1381440"
  },
  {
    "text": "through the rigmarole of you know calling create pipe or anything like that basically the handle for standard",
    "start": "1381440",
    "end": "1387020"
  },
  {
    "text": "in standard out and standard error is um this you know the socket itself",
    "start": "1387020",
    "end": "1392720"
  },
  {
    "text": "so that is that the code to do this is in the back of the uh",
    "start": "1392720",
    "end": "1398900"
  },
  {
    "text": "the book as I said so in terms of firewalls this is",
    "start": "1398900",
    "end": "1404120"
  },
  {
    "text": "obviously a serious issue well it depends on what the SQL Server",
    "start": "1404120",
    "end": "1410299"
  },
  {
    "text": "is running as if you've set your SQL Server running as local system which is not default on SQL Server 2000",
    "start": "1410299",
    "end": "1417500"
  },
  {
    "text": "um by default on SQL Server 2000 you're just supposed to specify that a domain user okay",
    "start": "1417500",
    "end": "1424220"
  },
  {
    "text": "um there is a checkbox though that says use local system yeah so if you're a",
    "start": "1424220",
    "end": "1430100"
  },
  {
    "text": "domain user um sorry SQL Server is running as a domain user then you have that domain",
    "start": "1430100",
    "end": "1435380"
  },
  {
    "text": "user's privileges now obviously because it's a domain user I can start if it's not if that domain user account hasn't",
    "start": "1435380",
    "end": "1441740"
  },
  {
    "text": "been locked down properly I can start you know using my domain privileges to start accessing other boxes on on the",
    "start": "1441740",
    "end": "1447919"
  },
  {
    "text": "network if it was running as local system always I would have access to is that host and",
    "start": "1447919",
    "end": "1453679"
  },
  {
    "text": "the data on the database server that's all um so",
    "start": "1453679",
    "end": "1458900"
  },
  {
    "text": "there are advantages to running as local system there are advantages to running is a domain user",
    "start": "1458900",
    "end": "1465799"
  },
  {
    "text": "um it depends on your point of view and you you need to analyze the threat to you you know is it",
    "start": "1465799",
    "end": "1471679"
  },
  {
    "text": "going to be too much of a major problem if all of your hosts um are compromised",
    "start": "1471679",
    "end": "1476960"
  },
  {
    "text": "remind you there's as I said you can lock down using group policies and everything like that the domain user account and all it can do is run the SQL",
    "start": "1476960",
    "end": "1484039"
  },
  {
    "text": "services so I'm not going to suggest you run as local system it's definitely a bad thing to do",
    "start": "1484039",
    "end": "1490400"
  },
  {
    "text": "um so looking at firewalls because this is going over UDP it's easy to spoof IP",
    "start": "1490400",
    "end": "1497299"
  },
  {
    "text": "addresses over UDP it's much more difficult with TCP because you have to be able to predict",
    "start": "1497299",
    "end": "1502400"
  },
  {
    "text": "um you know sequence numbers and so on and then you have the three-way handshake to go through and everything like that but with UDP it's like posting",
    "start": "1502400",
    "end": "1509059"
  },
  {
    "text": "a you know a postcard you put it in the post and away it goes as opposed to like dialing a telephone number and uh there",
    "start": "1509059",
    "end": "1515000"
  },
  {
    "text": "is no virtual connection that needs to be set up so it's like fire off your packet and you know away you go",
    "start": "1515000",
    "end": "1521900"
  },
  {
    "text": "we can set the source Port no problems um the code in the back of this sets The Source port to 53.",
    "start": "1521900",
    "end": "1529340"
  },
  {
    "text": "um obviously because most firewalls will allow that through um",
    "start": "1529340",
    "end": "1534559"
  },
  {
    "text": "spoofing the IP address of someone's external DNS server is definitely um going to hit a lot of systems so it's",
    "start": "1534559",
    "end": "1540080"
  },
  {
    "text": "highly important to disallow any incoming two one four three four from any host",
    "start": "1540080",
    "end": "1547520"
  },
  {
    "text": "you know to any of your SQL servers regardless of what the source Port is if unfortunately if someone you know sends",
    "start": "1547520",
    "end": "1555559"
  },
  {
    "text": "out a UDP query with the UDP Source port to 1434 tough you know just let the",
    "start": "1555559",
    "end": "1560720"
  },
  {
    "text": "firewall still drop it um they'll they'll try and resolve the domain name again and recover it on 1435",
    "start": "1560720",
    "end": "1566960"
  },
  {
    "text": "so it will increment anyway so um obviously there's a patch from Microsoft",
    "start": "1566960",
    "end": "1573039"
  },
  {
    "text": "if you look at the microsoft.com site security I believe this is covered",
    "start": "1573039",
    "end": "1580340"
  },
  {
    "text": "in the MS bulletin zero two zero 39 is that",
    "start": "1580340",
    "end": "1586539"
  },
  {
    "text": "38 right sorry uh thanks uh Scott copper is down here in the corner and he's",
    "start": "1586539",
    "end": "1591559"
  },
  {
    "text": "informed me it's uh 38. um and in fact 39 also references I believe another SQL",
    "start": "1591559",
    "end": "1597260"
  },
  {
    "text": "server issue sure you can it's much more difficult though",
    "start": "1597260",
    "end": "1604159"
  },
  {
    "text": "um I have elected to use um TCP here because I'm lazy basically",
    "start": "1604159",
    "end": "1613279"
  },
  {
    "text": "but yes it can do in fact you can actually use netcat to",
    "start": "1613279",
    "end": "1618320"
  },
  {
    "text": "do this as well netcat has this capability the only Quirk with it on on Windows is when you type in your command you have to go D enter I enter R enter",
    "start": "1618320",
    "end": "1625880"
  },
  {
    "text": "you know enter kind of thing to to get it to work so yes it can um well a remote shop can work over UDP",
    "start": "1625880",
    "end": "1633640"
  },
  {
    "text": "something I should definitely research a bit more you know to make it easier",
    "start": "1633640",
    "end": "1638840"
  },
  {
    "text": "um so this has been a fairly brief talk",
    "start": "1638840",
    "end": "1648278"
  },
  {
    "text": "um so I would like to open the um you know flaw to questions kind of",
    "start": "1648380",
    "end": "1655460"
  },
  {
    "text": "thing um are there any questions and it doesn't have to be about these issues any SQL",
    "start": "1655460",
    "end": "1661039"
  },
  {
    "text": "server issues at all sure go ahead have you tried that um",
    "start": "1661039",
    "end": "1668500"
  },
  {
    "text": "yes I have sorry I'll repeat the questions that the gentleman was asking have I tried this Shell Code on stored",
    "start": "1668620",
    "end": "1676340"
  },
  {
    "text": "procedures yes I have I've used against web servers all sorts of things",
    "start": "1676340",
    "end": "1682159"
  },
  {
    "text": "um obviously there's parts of the code that need to be modified to um you know setting the",
    "start": "1682159",
    "end": "1688880"
  },
  {
    "text": "um of running the save return address you know and and so on but the the basic code will work fine yeah",
    "start": "1688880",
    "end": "1696200"
  },
  {
    "text": "any other sure",
    "start": "1696200",
    "end": "1700059"
  },
  {
    "text": "okay the the question was um about the the tool I'm about to",
    "start": "1702640",
    "end": "1708500"
  },
  {
    "text": "release NGS squirrel um essentially is a an audit tool for",
    "start": "1708500",
    "end": "1714980"
  },
  {
    "text": "Microsoft SQL servers um it will look for obviously All the known vulnerabilities and include some",
    "start": "1714980",
    "end": "1721100"
  },
  {
    "text": "things that um are brand new um it also has export capabilities as",
    "start": "1721100",
    "end": "1728120"
  },
  {
    "text": "well like an exploit wizard um for example you know you can tell it to run this command for me",
    "start": "1728120",
    "end": "1735020"
  },
  {
    "text": "um get me sysadmin rights get me a reverse shell and so on so it's a tool designed for uh you know penetration",
    "start": "1735020",
    "end": "1743059"
  },
  {
    "text": "testers you know consultancies and so on to enable them to more easily assess the",
    "start": "1743059",
    "end": "1748700"
  },
  {
    "text": "security of a SQL Server um they should be ready",
    "start": "1748700",
    "end": "1754340"
  },
  {
    "text": "um well a beta version is ready um because of its exploit capabilities I'm I'm not sure what to do in terms of",
    "start": "1754340",
    "end": "1760640"
  },
  {
    "text": "you know giving out to to the public um I I might release a trial version but",
    "start": "1760640",
    "end": "1768620"
  },
  {
    "text": "um the the Xbox functionality because I don't want too many people um coming along and just using it to",
    "start": "1768620",
    "end": "1775279"
  },
  {
    "text": "compromise I'll probably talk to localhost as well but that should be ready in about one week to two weeks or",
    "start": "1775279",
    "end": "1780500"
  },
  {
    "text": "so on any other questions",
    "start": "1780500",
    "end": "1785860"
  },
  {
    "text": "sure yep we if you go to the ngsoftware.com",
    "start": "1785899",
    "end": "1793100"
  },
  {
    "text": "website we've just released auraskan which is um that's uh it's in beta at the moment",
    "start": "1793100",
    "end": "1798559"
  },
  {
    "text": "where we're hoping to get the final product uh ready in about um three weeks three weeks to a month or",
    "start": "1798559",
    "end": "1804500"
  },
  {
    "text": "a scam will assess an oracle web front end application it will have minimal Oracle auditing",
    "start": "1804500",
    "end": "1811340"
  },
  {
    "text": "um capabilities in there as well but essentially it's more assessing an oracle web front end app",
    "start": "1811340",
    "end": "1818919"
  },
  {
    "text": "um well that's a difficult question to answer um sorry I'll repeat the question which",
    "start": "1825980",
    "end": "1831799"
  },
  {
    "text": "SQL Server which SQL server has the least vulnerabilities in them at the moment",
    "start": "1831799",
    "end": "1837620"
  },
  {
    "text": "um I would say um and this is only through obscurity okay",
    "start": "1837620",
    "end": "1845360"
  },
  {
    "text": "some of the IBM database servers such as db2 or inFAMOUS okay simply because no",
    "start": "1845360",
    "end": "1851480"
  },
  {
    "text": "one's really looked at them yet db2 is next on my list if I can get a copy of Infamous that will be thereafter that",
    "start": "1851480",
    "end": "1857600"
  },
  {
    "text": "will be the next one um I believe there was a uh in the password",
    "start": "1857600",
    "end": "1864200"
  },
  {
    "text": "encryption thing with db2 there was an issue with that a buffer overflow in in",
    "start": "1864200",
    "end": "1869299"
  },
  {
    "text": "the password encryption stuff with db2 that was released a couple of months back that's the only thing I know of db2",
    "start": "1869299",
    "end": "1875179"
  },
  {
    "text": "that has been announced in in the relative past or the recent past rather",
    "start": "1875179",
    "end": "1880520"
  },
  {
    "text": "um definitely has its issues Microsoft",
    "start": "1880520",
    "end": "1886399"
  },
  {
    "text": "definitely has its issues MySQL definitely has its issues I mean doing a",
    "start": "1886399",
    "end": "1892399"
  },
  {
    "text": "um a source code review of um the windows Port there was a they",
    "start": "1892399",
    "end": "1898159"
  },
  {
    "text": "read a registry key okay now by default this registry key doesn't exist but everybody can create a sub key so all we",
    "start": "1898159",
    "end": "1904940"
  },
  {
    "text": "needed to do if we had local access to the box or remote access and using dot reg files we could create this sub key",
    "start": "1904940",
    "end": "1911360"
  },
  {
    "text": "and if it existed it would you know look it up so in in in the process of",
    "start": "1911360",
    "end": "1917360"
  },
  {
    "text": "querying that registry key they they there was a buffer overflow um and if it failed in any way",
    "start": "1917360",
    "end": "1925820"
  },
  {
    "text": "um in reading that registry key it would do f printf a vulnerable printf statement you know format string bug",
    "start": "1925820",
    "end": "1932179"
  },
  {
    "text": "within two lines of code there was the the vulnerable buffer overflow then a format string bug within two lines of",
    "start": "1932179",
    "end": "1938419"
  },
  {
    "text": "each other I was like you know I stopped there and then actually um",
    "start": "1938419",
    "end": "1943520"
  },
  {
    "text": "that said the source code is available with mySQL so you can take steps to you know fix it yourself",
    "start": "1943520",
    "end": "1950179"
  },
  {
    "text": "um I I I might be incorrect in this part I I don't think um",
    "start": "1950179",
    "end": "1955779"
  },
  {
    "text": "actually no I am incorrecting that so I won't say that um",
    "start": "1955779",
    "end": "1961159"
  },
  {
    "text": "there are a number of databases out there such as Rubik's again which hasn't really been looked at much but it",
    "start": "1961159",
    "end": "1967460"
  },
  {
    "text": "doesn't support much in terms of stored procedures or anything like that you know simple and c-sql and it's designed",
    "start": "1967460",
    "end": "1975260"
  },
  {
    "text": "to run on trusted operating systems so I I presume that's an extremely strong product so something like Rubik's if",
    "start": "1975260",
    "end": "1981620"
  },
  {
    "text": "you're interested in strong database products in terms of security something like Rubik's might suit",
    "start": "1981620",
    "end": "1987520"
  },
  {
    "text": "although as I said I haven't looked at it this is just from what I can guess okay",
    "start": "1987520",
    "end": "1993019"
  },
  {
    "text": "um database security I think in the next six months is gonna",
    "start": "1993019",
    "end": "1998480"
  },
  {
    "text": "six months is going to explode in a big way the hacking community and I don't",
    "start": "1998480",
    "end": "2005019"
  },
  {
    "text": "necessarily just mean the um the people breaking into sites and so on like that and defacing I mean you know people",
    "start": "2005019",
    "end": "2010480"
  },
  {
    "text": "doing active research in in this area have known for a long time that you can break into back-end database systems",
    "start": "2010480",
    "end": "2016179"
  },
  {
    "text": "through web servers and so on I believe this message is beginning to get across",
    "start": "2016179",
    "end": "2021580"
  },
  {
    "text": "to the people using these database servers um and consequently",
    "start": "2021580",
    "end": "2027039"
  },
  {
    "text": "um database security has gone you know going to start gaining impetus people are going to be more concerned with",
    "start": "2027039",
    "end": "2032919"
  },
  {
    "text": "database security too many dbas are worried about performance issues and so on and",
    "start": "2032919",
    "end": "2039460"
  },
  {
    "text": "security is way down at the bottom of the pile at the moment I think that needs to change not just on the dba's",
    "start": "2039460",
    "end": "2044559"
  },
  {
    "text": "part but also on the vendors part as well more money needs to be spent on",
    "start": "2044559",
    "end": "2049599"
  },
  {
    "text": "securing these issues and less on marketing um so",
    "start": "2049599",
    "end": "2056260"
  },
  {
    "text": "in answer to your your question which is the most secure I would say you know",
    "start": "2056260",
    "end": "2062080"
  },
  {
    "text": "only through obscurity something like Infamous perhaps yeah um but then I think even Infamous had a",
    "start": "2062080",
    "end": "2068020"
  },
  {
    "text": "couple of problems with its back door you know Politically Incorrect password was that information",
    "start": "2068020",
    "end": "2073839"
  },
  {
    "text": "did anybody which",
    "start": "2073839",
    "end": "2079080"
  },
  {
    "text": "interbase right interbase had that back door sorry no infamix um so",
    "start": "2079080",
    "end": "2086138"
  },
  {
    "text": "I wouldn't necessarily say I wouldn't necessarily say it's safe though that's that's all yeah",
    "start": "2086139",
    "end": "2092820"
  },
  {
    "text": "um in terms of like appliances like we've done single servers we've done web servers um",
    "start": "2110440",
    "end": "2116500"
  },
  {
    "text": "no I can't unfortunately at this stage um I mean ldap is is you know becoming",
    "start": "2116500",
    "end": "2122200"
  },
  {
    "text": "big okay um especially with you know um active directory and so on so ldap",
    "start": "2122200",
    "end": "2128500"
  },
  {
    "text": "perhaps is definitely something if you're interested in doing security research and you're looking for the next",
    "start": "2128500",
    "end": "2134020"
  },
  {
    "text": "big thing ldap definitely might worth be looking at because it seems that everything is going towards uh the",
    "start": "2134020",
    "end": "2139599"
  },
  {
    "text": "directory structure kind of way so ldap I would probably say",
    "start": "2139599",
    "end": "2144660"
  },
  {
    "text": "sure in the bank",
    "start": "2144760",
    "end": "2150960"
  },
  {
    "text": "um",
    "start": "2155920",
    "end": "2157980"
  },
  {
    "text": "I'm going to repeat the question because I think I heard it I'm not sure um in terms of",
    "start": "2166200",
    "end": "2172240"
  },
  {
    "text": "um trusted OS is it like um Solaris with pitbull or or you know",
    "start": "2172240",
    "end": "2177579"
  },
  {
    "text": "other operating systems of that level of assurance um do I see them them being used more",
    "start": "2177579",
    "end": "2183160"
  },
  {
    "text": "often in terms of you know as being set up as database servers resent the question",
    "start": "2183160",
    "end": "2188560"
  },
  {
    "text": "um yes for certain establishments no for others running",
    "start": "2188560",
    "end": "2195160"
  },
  {
    "text": "um a CMW based system something like virtual Vault or Solaris with pitbull",
    "start": "2195160",
    "end": "2201540"
  },
  {
    "text": "is a difficult task and expensive an expensive proposition",
    "start": "2201540",
    "end": "2206740"
  },
  {
    "text": "um something like the Microsoft solution it's great it's functional",
    "start": "2206740",
    "end": "2211980"
  },
  {
    "text": "it's got good performance it's fairly scalable and it's cheap and works out",
    "start": "2211980",
    "end": "2217540"
  },
  {
    "text": "the box okay security issues aside so a lot of",
    "start": "2217540",
    "end": "2222720"
  },
  {
    "text": "people in in the commercial sector will be looking for that kind of product people in the military government",
    "start": "2222720",
    "end": "2230079"
  },
  {
    "text": "organizations and so on will probably be looking at you know trusted operating systems and trusted database servers on",
    "start": "2230079",
    "end": "2236740"
  },
  {
    "text": "top of that um because obviously the the value of the data when it has National importance",
    "start": "2236740",
    "end": "2243579"
  },
  {
    "text": "National Security importance is obviously you know you need that kind of proof you know or security blanket to",
    "start": "2243579",
    "end": "2250540"
  },
  {
    "text": "say yes we think we're pretty good down secure about heading to that reverse",
    "start": "2250540",
    "end": "2256980"
  },
  {
    "text": "I'm sorry about using a reverse process so in terms of like almost like a an",
    "start": "2256980",
    "end": "2265420"
  },
  {
    "text": "application firewall in front of it um Tim Mullen and I Tim is actually speaking next to us which is unfortunate",
    "start": "2265420",
    "end": "2271000"
  },
  {
    "text": "because uh it would have been good to see us talk on nimna and attack back",
    "start": "2271000",
    "end": "2276220"
  },
  {
    "text": "um Tim and I were actually speaking about doing um a an application proxy",
    "start": "2276220",
    "end": "2282220"
  },
  {
    "text": "um for SQL Server Microsoft SQL Server it's a very very difficult proposition and the reason why is say you are looking",
    "start": "2282220",
    "end": "2290260"
  },
  {
    "text": "for XP underscore CMD shell and your firewall essentially your application firewall will look for that string there",
    "start": "2290260",
    "end": "2298000"
  },
  {
    "text": "are 65 000 million ways I can encode XP underscore CMD shell",
    "start": "2298000",
    "end": "2303220"
  },
  {
    "text": "to bypass your you know your firewall for example I could go declare at foo",
    "start": "2303220",
    "end": "2308920"
  },
  {
    "text": "and bar chart 300 select at foo equals ox and then the",
    "start": "2308920",
    "end": "2315940"
  },
  {
    "text": "the hex string for XP underscore CMD shell okay and then exec bracket",
    "start": "2315940",
    "end": "2323920"
  },
  {
    "text": "um at foo or whatever kind of thing here now I have essentially encoded my attack",
    "start": "2323920",
    "end": "2329200"
  },
  {
    "text": "in a in a different way than how you're looking for it but sure you can then you know cause your um you know add a rule",
    "start": "2329200",
    "end": "2336579"
  },
  {
    "text": "into your application proxy firewall rather to look for that specific string but then you have to do the non-unicode",
    "start": "2336579",
    "end": "2343960"
  },
  {
    "text": "version you have to do the Unicode version I could ignore it you know using transact SQL I could exhort you know my",
    "start": "2343960",
    "end": "2350380"
  },
  {
    "text": "string with five nine Ox five nine before you know",
    "start": "2350380",
    "end": "2355480"
  },
  {
    "text": "um putting through and then unexor it with five nine again before I do the exact there is just so many ways because it's",
    "start": "2355480",
    "end": "2362380"
  },
  {
    "text": "tsql is essentially a programming language in itself you know for every way you can think of a defense",
    "start": "2362380",
    "end": "2368200"
  },
  {
    "text": "um someone else will be able to think of 100 ways to to bypass that defense so it's a difficult proposition it's not",
    "start": "2368200",
    "end": "2375339"
  },
  {
    "text": "impossible and let's face it you will stop 99 of the attacks and that's a good thing",
    "start": "2375339",
    "end": "2381339"
  },
  {
    "text": "but you have to be aware that there will always be an attack that gets through and it's those kind of attacks that are",
    "start": "2381339",
    "end": "2388660"
  },
  {
    "text": "launched by the the intent cracker who is really you know he's not going to",
    "start": "2388660",
    "end": "2395320"
  },
  {
    "text": "deface your website he's going to steal your data and do something nefarious with it like sell it to your competitor or something",
    "start": "2395320",
    "end": "2401560"
  },
  {
    "text": "um and it's these kind of attackers the these kind of attackers will simply bypass you know any firewall you put in",
    "start": "2401560",
    "end": "2407859"
  },
  {
    "text": "front or any application proxy you put in front kind of so as I said if you are if your database",
    "start": "2407859",
    "end": "2415300"
  },
  {
    "text": "server though is like Rubiks which only supports like um a Sports Supports anti-sequel 92 and",
    "start": "2415300",
    "end": "2421540"
  },
  {
    "text": "a bit of 99 then sure you can start you know limiting what can be done but if",
    "start": "2421540",
    "end": "2428920"
  },
  {
    "text": "um it supports any kind of scripting language like tsql um no you're in for a rough ride",
    "start": "2428920",
    "end": "2436380"
  },
  {
    "text": "sure your experience with Oracle do you have any comment or thoughts on their",
    "start": "2436720",
    "end": "2442000"
  },
  {
    "text": "unbreakable campaign I think right",
    "start": "2442000",
    "end": "2447180"
  },
  {
    "text": "I think their campaign was clever now",
    "start": "2447180",
    "end": "2452619"
  },
  {
    "text": "by saying it's unbreakable they actually were meaning your business is unbreakable you know as close to 100",
    "start": "2452619",
    "end": "2459520"
  },
  {
    "text": "uptime as you can possibly get sorry I'll repeat the question just in case I've been asked to repeat the questions",
    "start": "2459520",
    "end": "2466480"
  },
  {
    "text": "um he's asked for my comments on the the Oracle unbreakable campaign",
    "start": "2466480",
    "end": "2472960"
  },
  {
    "text": "um and as I said it's a clever thing now they're not just talking about um the software is unbreakable because",
    "start": "2472960",
    "end": "2479320"
  },
  {
    "text": "that's obviously not true they're talking about your business will become unbreakable unfortunately there was a",
    "start": "2479320",
    "end": "2484359"
  },
  {
    "text": "sort of like small print tagline can't break it can't break in which sort of destroys that but essentially what they",
    "start": "2484359",
    "end": "2490300"
  },
  {
    "text": "got was Free Press you know when we released these holes in Oracle Oracle",
    "start": "2490300",
    "end": "2495400"
  },
  {
    "text": "was in you know the the papers now I think it was Oscar Wilde who said you know something like free press or any",
    "start": "2495400",
    "end": "2502300"
  },
  {
    "text": "press is good press you know um so they got Free Press out of it",
    "start": "2502300",
    "end": "2508300"
  },
  {
    "text": "um they have you know hours and hours of free security work done on it you know if",
    "start": "2508300",
    "end": "2514900"
  },
  {
    "text": "they had paid me to do that you know review um it would have cost them a normal leg but they got it done for free so",
    "start": "2514900",
    "end": "2521680"
  },
  {
    "text": "um there are certain advantages to that marketing campaign um",
    "start": "2521680",
    "end": "2527560"
  },
  {
    "text": "I believe the security guys at Oracle were like no you can't do this um but marketing and security are two",
    "start": "2527560",
    "end": "2534400"
  },
  {
    "text": "entirely different you know divisions um so there were benefits to to their",
    "start": "2534400",
    "end": "2540520"
  },
  {
    "text": "marketing campaign yes sure",
    "start": "2540520",
    "end": "2546900"
  },
  {
    "text": "is anybody doing security research on",
    "start": "2550980",
    "end": "2555540"
  },
  {
    "text": "um I don't know if anybody's doing security research on it it's on my list to do",
    "start": "2556900",
    "end": "2562420"
  },
  {
    "text": "unfortunately my list to do is like this big at the moment um but",
    "start": "2562420",
    "end": "2568200"
  },
  {
    "text": "if no one else has then wait a couple of months and hopefully we'll have something for you you know that's all I",
    "start": "2568200",
    "end": "2573700"
  },
  {
    "text": "can say at this stage sure sure",
    "start": "2573700",
    "end": "2578160"
  },
  {
    "text": "um yes the public role um",
    "start": "2583359",
    "end": "2588940"
  },
  {
    "text": "has too much Freedom the public role essentially is sorry I keep on forgetting to repeat the question is",
    "start": "2588940",
    "end": "2595240"
  },
  {
    "text": "there anything we can do to mitigate these attacks um and yes there is and it's limiting",
    "start": "2595240",
    "end": "2601420"
  },
  {
    "text": "what public can do now um for example there are certain extended store procedures we can call",
    "start": "2601420",
    "end": "2608500"
  },
  {
    "text": "um that allow us to gain the Privileges of the SQL Server okay now if I drop",
    "start": "2608500",
    "end": "2614260"
  },
  {
    "text": "public permissions on those um Extended store procedures then",
    "start": "2614260",
    "end": "2621640"
  },
  {
    "text": "um no one can use that as an attack and it's just a simple configuration change so",
    "start": "2621640",
    "end": "2629800"
  },
  {
    "text": "definitely at your database server and see what public can do and ask yourself questions such as",
    "start": "2631720",
    "end": "2637660"
  },
  {
    "text": "what can they do with this you know particular bit of functionality do I want them to be able to do that and if",
    "start": "2637660",
    "end": "2643660"
  },
  {
    "text": "you don't remove public you know from it also remove guest access from the msdb",
    "start": "2643660",
    "end": "2650440"
  },
  {
    "text": "database msdb has a number of stored procedures that people forget about",
    "start": "2650440",
    "end": "2655720"
  },
  {
    "text": "because they think store procedures are all in the master database msdb has a lot of store procedures that",
    "start": "2655720",
    "end": "2662140"
  },
  {
    "text": "are crucial to the way replication and the SQL agent and everything like that operates so take a look at that and you",
    "start": "2662140",
    "end": "2669819"
  },
  {
    "text": "know remove guest access and remove public from those stored procedures",
    "start": "2669819",
    "end": "2675339"
  },
  {
    "text": "um so yes you can lock down the SQL Server there are certain things certain vulnerabilities that you can't do",
    "start": "2675339",
    "end": "2681460"
  },
  {
    "text": "anything about such as the PWD encrypt buffer overflow there's nothing you can do about that everybody needs to be able",
    "start": "2681460",
    "end": "2686800"
  },
  {
    "text": "to access that essentially if you want to if you if you want them to change their passwords and it's a function it's quite difficult to you know to protect",
    "start": "2686800",
    "end": "2693640"
  },
  {
    "text": "against because it's all internal things like open row set abuse you can disallow ad",
    "start": "2693640",
    "end": "2699579"
  },
  {
    "text": "hoc queries by you know setting things in the registry um I can't remember the registry key off",
    "start": "2699579",
    "end": "2706119"
  },
  {
    "text": "the top of my head but do a search on under ad hoc access and that will supply",
    "start": "2706119",
    "end": "2711160"
  },
  {
    "text": "the registry key for you um",
    "start": "2711160",
    "end": "2715619"
  },
  {
    "text": "could you the name of the rich key allow ads",
    "start": "2720060",
    "end": "2725400"
  },
  {
    "text": "ad hoc queries right I think it's well as Scott says it's allow ad hoc queries",
    "start": "2725400",
    "end": "2731560"
  },
  {
    "text": "um set it to zero I presume uh to disallow them seven to one now the thing",
    "start": "2731560",
    "end": "2736660"
  },
  {
    "text": "is with um the they're under the provider's key essentially now the MS",
    "start": "2736660",
    "end": "2745420"
  },
  {
    "text": "um adsql one has this key in there already and it's set to zero",
    "start": "2745420",
    "end": "2751839"
  },
  {
    "text": "fortunately the SQL early DB provider does not none of the other providers do so a member of public can call these",
    "start": "2751839",
    "end": "2759940"
  },
  {
    "text": "these procedures these functions like openrocer and open data source um and run ad hoc queries using",
    "start": "2759940",
    "end": "2766300"
  },
  {
    "text": "different libraries different providers so you need to actually physically go in there and change you know add these",
    "start": "2766300",
    "end": "2772000"
  },
  {
    "text": "these values um for for these specific providers only",
    "start": "2772000",
    "end": "2777160"
  },
  {
    "text": "as I said the msad SQL one has it",
    "start": "2777160",
    "end": "2782880"
  },
  {
    "text": "it's possible to run a SQL Server as an ordinary user on the box it doesn't necessarily have to be a privileged user",
    "start": "2785200",
    "end": "2791680"
  },
  {
    "text": "in all cases correct I don't know the ins and outs of you know exactly when you can and cannot get away with it but",
    "start": "2791680",
    "end": "2798339"
  },
  {
    "text": "it's something to investigate because um yeah that way an attack may give up the",
    "start": "2798339",
    "end": "2806140"
  },
  {
    "text": "database sure but it depends on what your objective is as an attacker I mean oh",
    "start": "2806140",
    "end": "2812560"
  },
  {
    "text": "absolutely if I'm after your data and let's face it that's where the goodies are you know then I don't care about compromising your host I'm after the",
    "start": "2812560",
    "end": "2818920"
  },
  {
    "text": "data you know absolutely but if you're if you're after the service password attached to the LSA sure there's much",
    "start": "2818920",
    "end": "2824619"
  },
  {
    "text": "more Community right when I'm doing penetration tests for the um for for",
    "start": "2824619",
    "end": "2830740"
  },
  {
    "text": "organizations you know like companies I say here's your administrative password they go hmm I say well here's your",
    "start": "2830740",
    "end": "2836680"
  },
  {
    "text": "customer database I go oh my God you know like um so it's",
    "start": "2836680",
    "end": "2844660"
  },
  {
    "text": "um but you're right absolutely it can be a low privileged user chip Andrews I think has done some good research on and",
    "start": "2845800",
    "end": "2850960"
  },
  {
    "text": "again if you go to sqlsecurity.com um he's done some research on you know what privileges this user actually needs",
    "start": "2850960",
    "end": "2857859"
  },
  {
    "text": "and what it doesn't need so um definitely take a look at SQL security.com",
    "start": "2857859",
    "end": "2864400"
  },
  {
    "text": "any sorry over there",
    "start": "2864940",
    "end": "2868619"
  },
  {
    "text": "data um I did take a look at it just to see",
    "start": "2870040",
    "end": "2876160"
  },
  {
    "text": "whether you know it allowed me to enumerate the database structures um like you know version five did",
    "start": "2876160",
    "end": "2882819"
  },
  {
    "text": "um and the beta I looked at and this was going back about three months ago um did not allow me to enumerate the",
    "start": "2882819",
    "end": "2889000"
  },
  {
    "text": "database structures in in the same fashion I did with you know previous versions of domino web server",
    "start": "2889000",
    "end": "2894520"
  },
  {
    "text": "um that may you know that functionality well that feature may be back in there",
    "start": "2894520",
    "end": "2901300"
  },
  {
    "text": "um I don't know it's something I'm going to have to do again as I said it's on my to-do list",
    "start": "2901300",
    "end": "2907079"
  },
  {
    "text": "I appreciate your document Lotus has not done a very good job of",
    "start": "2907079",
    "end": "2913900"
  },
  {
    "text": "that that's been very helpful in proving that it's not a real good idea to just assume that people aren't going to",
    "start": "2913900",
    "end": "2919839"
  },
  {
    "text": "figure that out sure thank you for your apprentation",
    "start": "2919839",
    "end": "2924540"
  },
  {
    "text": "literally five minutes as soon as I saw asking um and was sniffing the traffic I saw it",
    "start": "2928619",
    "end": "2934240"
  },
  {
    "text": "was zero two point zero uh zero two byte it was was the bite I said well what does all the other ones do and literally",
    "start": "2934240",
    "end": "2941200"
  },
  {
    "text": "by as I said it was dead by eight you know that was like a nanosecond",
    "start": "2941200",
    "end": "2946240"
  },
  {
    "text": "um and then it was just like well start disassembling and put an anti-regim on",
    "start": "2946240",
    "end": "2951760"
  },
  {
    "text": "and literally within five minutes um you know I think that the males were actually sent to Microsoft at the time",
    "start": "2951760",
    "end": "2957700"
  },
  {
    "text": "you know I was like found a heap overflow um then a couple of seconds later there was like sent them another amount oh now",
    "start": "2957700",
    "end": "2963460"
  },
  {
    "text": "stack Overflow you know um it was literally like that within five minutes",
    "start": "2963460",
    "end": "2969640"
  },
  {
    "text": "how long can you estimate that the date from finding a vulnerability",
    "start": "2969640",
    "end": "2974520"
  },
  {
    "text": "um well it depends if you've got code you know you can just cut and paste in it",
    "start": "2975579",
    "end": "2981099"
  },
  {
    "text": "can be a few more minutes more um with this one um it took me about an",
    "start": "2981099",
    "end": "2987520"
  },
  {
    "text": "hour to you know do all the assembly and everything like that so um from discovering the vulnerability to",
    "start": "2987520",
    "end": "2994599"
  },
  {
    "text": "exploiting the or having working exploit code um you know one to two hours essentially",
    "start": "2994599",
    "end": "3001020"
  },
  {
    "text": "um it can be short than that I said if you've already got pre pre-code that you can just cut and paste in you know so",
    "start": "3001020",
    "end": "3008119"
  },
  {
    "text": "I'm sorry did I do research on",
    "start": "3010220",
    "end": "3016520"
  },
  {
    "text": "oh right sorry yeah the the only other interesting one after that is zero a you know like a new line character",
    "start": "3016520",
    "end": "3022859"
  },
  {
    "text": "um and that's where the you know servers start pinging each other's to death um and anything above that is pretty",
    "start": "3022859",
    "end": "3029400"
  },
  {
    "text": "much um irrelevant if you uh",
    "start": "3029400",
    "end": "3035240"
  },
  {
    "text": "okay there's a bit of uh it's on my other laptop I'm sorry there's I've broken it",
    "start": "3035760",
    "end": "3041520"
  },
  {
    "text": "down essentially that you can look at the assembly for it um there's a couple of jump instructions you know if above",
    "start": "3041520",
    "end": "3047400"
  },
  {
    "text": "six go here if you know do this if not blah blah blah blah and pretty much everything above zero a is useless so",
    "start": "3047400",
    "end": "3054240"
  },
  {
    "text": "that's um there's only a couple of ones that do anything interesting and everything after zero is nothing",
    "start": "3054240",
    "end": "3062300"
  },
  {
    "text": "any other questions sure I read an article saying that you",
    "start": "3062300",
    "end": "3067980"
  },
  {
    "text": "were going to start releasing publicly a little faster than you than you have been yep first of all is that to suggest",
    "start": "3067980",
    "end": "3074520"
  },
  {
    "text": "that Microsoft has been slow in their responses to the vulnerabilities as no",
    "start": "3074520",
    "end": "3080400"
  },
  {
    "text": "um what it suggests is um we're unhappy with certain vulnerabilities being rolled up in",
    "start": "3080400",
    "end": "3086700"
  },
  {
    "text": "service packs we believe they deserve more attention and have a hotfix be",
    "start": "3086700",
    "end": "3092400"
  },
  {
    "text": "provided for them now um what you're speaking about",
    "start": "3092400",
    "end": "3097500"
  },
  {
    "text": "specifically is the vendor notification alerts okay this wasn't just Microsoft doing this this was iplanet I found a",
    "start": "3097500",
    "end": "3104760"
  },
  {
    "text": "buffer overflow in the search capabilities in iplanet and they said we're going to service pack this and I",
    "start": "3104760",
    "end": "3111359"
  },
  {
    "text": "was like this is a remotely exploitable buffer overflow on you know Solaris and",
    "start": "3111359",
    "end": "3117000"
  },
  {
    "text": "T blah blah blah you know and you're you're going to put this in a service pack that's crazy in my opinion so in an",
    "start": "3117000",
    "end": "3124200"
  },
  {
    "text": "attempt to persuade the vendors and that's all you can never do is attempt to persuade them",
    "start": "3124200",
    "end": "3130920"
  },
  {
    "text": "to start taking things more seriously and produce hot fixes for them I thought it would be good if we",
    "start": "3130920",
    "end": "3138000"
  },
  {
    "text": "announced to the public in a limited capacity that there is an issue here and that way the the customers of that",
    "start": "3138000",
    "end": "3144780"
  },
  {
    "text": "vendor will turn around and say look I know there's a hole I don't know where the hole is I'm just told there as a whole where's the patch for it yeah so I",
    "start": "3144780",
    "end": "3153240"
  },
  {
    "text": "I'm not sure whether you know it's working um only time will tell",
    "start": "3153240",
    "end": "3158280"
  },
  {
    "text": "um but it's not about the the speed of the uh them getting a patch up is to make",
    "start": "3158280",
    "end": "3165720"
  },
  {
    "text": "sure they get a patch out yeah um it's very important and this was",
    "start": "3165720",
    "end": "3172559"
  },
  {
    "text": "um Scott cope and I had a good discussion about this and a number of things that I had neglected to think",
    "start": "3172559",
    "end": "3178680"
  },
  {
    "text": "about were pointed out to me and one of them is there are so many patches these days that a number of people",
    "start": "3178680",
    "end": "3186119"
  },
  {
    "text": "um become shy about applying patches especially if they break you know",
    "start": "3186119",
    "end": "3191339"
  },
  {
    "text": "something now if a vendor rushes a patch and you apply that patch and it breaks",
    "start": "3191339",
    "end": "3197640"
  },
  {
    "text": "some of their area of functionality you're going to go bloody hell I'm not applying any more patches yeah now it's",
    "start": "3197640",
    "end": "3204000"
  },
  {
    "text": "important for the vendor to ensure that the patchworks 100 when it goes live",
    "start": "3204000",
    "end": "3209760"
  },
  {
    "text": "and if it takes them two months to ensure that that happens so be it you",
    "start": "3209760",
    "end": "3214800"
  },
  {
    "text": "know I I as I said it's not so much to you know speed them up it's to make sure patches are provided to their customers",
    "start": "3214800",
    "end": "3221099"
  },
  {
    "text": "as opposed to leaving them vulnerable for six months you know to a year whilst um you know our service pack is waiting",
    "start": "3221099",
    "end": "3227579"
  },
  {
    "text": "to come out um I believe Service Pack 3 came out today exactly yeah Service Pack three came out",
    "start": "3227579",
    "end": "3234839"
  },
  {
    "text": "today if you if you didn't hear and there are a number of issues in there that have been outstanding",
    "start": "3234839",
    "end": "3240480"
  },
  {
    "text": "um since September last year um and personally I think",
    "start": "3240480",
    "end": "3247380"
  },
  {
    "text": "um some of these issues should have you know should have had a hotfix produced for them um but that's my opinion obviously the",
    "start": "3247380",
    "end": "3253920"
  },
  {
    "text": "vendor has their own opinion as well right okay I'm going to wrap up here and",
    "start": "3253920",
    "end": "3262020"
  },
  {
    "text": "thank you all very much for coming",
    "start": "3262020",
    "end": "3265579"
  },
  {
    "text": "and one last thing I would like to say is try not to lose two money",
    "start": "3272660",
    "end": "3278720"
  }
]