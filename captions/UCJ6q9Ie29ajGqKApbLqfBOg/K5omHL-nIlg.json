[
  {
    "text": "[Music]",
    "start": "1290",
    "end": "5890"
  },
  {
    "text": "welcome to black hat Windows 2K security held February 14th through the 15th 2001",
    "start": "16279",
    "end": "22039"
  },
  {
    "text": "in Las Vegas Nevada the following videotape was recorded live at the conference and produced by the sound of",
    "start": "22039",
    "end": "27840"
  },
  {
    "text": "knowledge Incorporated this is videotape number 11 technical track safeguarding your",
    "start": "27840",
    "end": "34399"
  },
  {
    "text": "business assets through the win32",
    "start": "34399",
    "end": "38559"
  },
  {
    "text": "API okay I'd like to welcome you to the 10:30 show we're looking at safeguarding",
    "start": "41640",
    "end": "46760"
  },
  {
    "text": "your business assets through understanding of the win32 API application programmed interface uh our",
    "start": "46760",
    "end": "54000"
  },
  {
    "text": "speakers today are Todd fan and David Goldman they're both managers at Price Waterhouse they are ALS o starting a",
    "start": "54000",
    "end": "61039"
  },
  {
    "text": "company called V secure and David is going to talk about it uh Todd is the",
    "start": "61039",
    "end": "67600"
  },
  {
    "text": "CEO David is the CTO uh they've done a variety of things for Price Waterhouse um and I was",
    "start": "67600",
    "end": "75000"
  },
  {
    "text": "talking to Todd earlier and he says he's taking an MBA program and I'm just amazed uh I'm trying to figure out where",
    "start": "75000",
    "end": "81520"
  },
  {
    "text": "his free time is I don't think he has any no I don't",
    "start": "81520",
    "end": "87079"
  },
  {
    "text": "zero uh with that uh any more here they",
    "start": "87079",
    "end": "92439"
  },
  {
    "text": "are okay that was the first couple of slides which Bas basically talked about",
    "start": "96640",
    "end": "102840"
  },
  {
    "text": "who we were but we just got an excellent introduction so we're first going to kind of give you an objective for this",
    "start": "102840",
    "end": "109240"
  },
  {
    "text": "class or this session which is to talk about some of the vulnerabilities inherent to the win32 API and how we can",
    "start": "109240",
    "end": "118200"
  },
  {
    "text": "look at those understand those those and assess those learn how to secure against those through talking about individual",
    "start": "118200",
    "end": "125799"
  },
  {
    "text": "functions within the war 32 API and how those relate back to functions of the",
    "start": "125799",
    "end": "132000"
  },
  {
    "text": "Windows operating system and functions of business so we're going to look at it from a multi-tiered approach we're going",
    "start": "132000",
    "end": "139879"
  },
  {
    "text": "to use what we call a case study analysis we're going to look at three",
    "start": "139879",
    "end": "145080"
  },
  {
    "text": "real companies we won't use their names of course but we will talk about their pri ities their use of these techniques",
    "start": "145080",
    "end": "153160"
  },
  {
    "text": "and what they can do to secure themselves and what you can do then to take those back and secure yourselves",
    "start": "153160",
    "end": "160040"
  },
  {
    "text": "and we're going to talk about some best practices about different functions what kind of information you can gather how",
    "start": "160040",
    "end": "166360"
  },
  {
    "text": "you can gather that information and uh and what you can do to bring that all",
    "start": "166360",
    "end": "171519"
  },
  {
    "text": "home I guess before we start I want to get a feel for what type of audience you guys are how technical you are and what",
    "start": "171519",
    "end": "178840"
  },
  {
    "text": "you're expecting from this so just kind of by a show of hands how many people here are security",
    "start": "178840",
    "end": "185560"
  },
  {
    "text": "administrators okay how many people here are software programmers",
    "start": "185599",
    "end": "192480"
  },
  {
    "text": "cios okay so I want to understand from you guys what exactly you're looking to take away from this presentation are you",
    "start": "192480",
    "end": "199680"
  },
  {
    "text": "guys looking for a deep technical knowledge of the win32 API are you looking for an understanding of well you",
    "start": "199680",
    "end": "206440"
  },
  {
    "text": "know this is our business how does it relate to what's going on at the operating system layer and how do we secure the operating system to protect",
    "start": "206440",
    "end": "213840"
  },
  {
    "text": "again the business what is it I mean just just shout out I mean what are your expectations for this",
    "start": "213840",
    "end": "221319"
  },
  {
    "text": "presentation everybody's looking for the Deep technical knowledge why don't you us the deepal",
    "start": "224760",
    "end": "231080"
  },
  {
    "text": "knowled and usci how our what else what else you guys looking for",
    "start": "231080",
    "end": "238599"
  },
  {
    "text": "life the meaning of life conference",
    "start": "240120",
    "end": "244920"
  },
  {
    "text": "a session about 32 API in some sense it",
    "start": "246159",
    "end": "251560"
  },
  {
    "text": "would be a good idea to talk about security 32 API as it relates to those",
    "start": "251560",
    "end": "260280"
  },
  {
    "text": "great anything else okay",
    "start": "260320",
    "end": "266680"
  },
  {
    "text": "good first thing to to get a security assertion map to understand what are we",
    "start": "267560",
    "end": "274600"
  },
  {
    "text": "going to be looking at because it's important to understand you know when we're talking about the win32 API within",
    "start": "274600",
    "end": "279880"
  },
  {
    "text": "Windows 2000 what it is you want to secure there are three objectives for you to go about securing Windows you",
    "start": "279880",
    "end": "286320"
  },
  {
    "text": "want to secure against confidentiality integrity and availability very straightforward these",
    "start": "286320",
    "end": "292360"
  },
  {
    "text": "are kind of the Auditors assertions these are your security assertions confidentiality you have extremely",
    "start": "292360",
    "end": "299759"
  },
  {
    "text": "sensitive data you don't want anyone getting access to it the most important thing is that knowing procures that",
    "start": "299759",
    "end": "305880"
  },
  {
    "text": "information Integrity you don't want the modification of that data also extremely important lastly availability we want",
    "start": "305880",
    "end": "313840"
  },
  {
    "text": "that data to always be readily accessible and I guess what we did was",
    "start": "313840",
    "end": "319520"
  },
  {
    "text": "we kind of took those three and we mapped them to five forces within",
    "start": "319520",
    "end": "324600"
  },
  {
    "text": "Windows this is you can argue you know are there five are there six you know",
    "start": "324600",
    "end": "329800"
  },
  {
    "text": "how is it that you break them down we look at it at five levels user Resource",
    "start": "329800",
    "end": "336160"
  },
  {
    "text": "Network system and audit user security obviously user",
    "start": "336160",
    "end": "343039"
  },
  {
    "text": "security is you know dealing with users and groups and your account policy resources your files your directories",
    "start": "343039",
    "end": "349800"
  },
  {
    "text": "even the permissions you would put on services that are running the system is what are the services that are running",
    "start": "349800",
    "end": "356160"
  },
  {
    "text": "how are they executed are they running as local system are they running as a user the registry extremely important",
    "start": "356160",
    "end": "362039"
  },
  {
    "text": "registry values registry permissions everything at that level I mean the registry is going to hold almost all the",
    "start": "362039",
    "end": "367479"
  },
  {
    "text": "information at the window in Windows 2000 that's going to relate to security",
    "start": "367479",
    "end": "372680"
  },
  {
    "text": "the network shares give you access to the resources you start to see how these all become related but trusts one domain",
    "start": "372680",
    "end": "380919"
  },
  {
    "text": "is trusting another domain so if you have one domain that's secured another one that's not and it's trusting that one there's your",
    "start": "380919",
    "end": "387039"
  },
  {
    "text": "in remote access is another piece Di and lastly auditing auditing is the last",
    "start": "387039",
    "end": "393080"
  },
  {
    "text": "Force we look at that as your audit policy the event log I think what we do now is a demo what we took was all of",
    "start": "393080",
    "end": "400919"
  },
  {
    "text": "these assertions we mapped them to each of the five forces and we came",
    "start": "400919",
    "end": "407319"
  },
  {
    "text": "up with well when we're securing our operating system what is the pieces that we want to look at so we said well at",
    "start": "407319",
    "end": "413599"
  },
  {
    "text": "the confidentiality level we want to look at user system Network resource auditing and at each of these levels",
    "start": "413599",
    "end": "420639"
  },
  {
    "text": "we map it down so we're going to do a demo of basically the tool that we wrote",
    "start": "420639",
    "end": "426199"
  },
  {
    "text": "to secure an operating system this is simply something that just collects information the purpose of this is to",
    "start": "426199",
    "end": "432080"
  },
  {
    "text": "show at the win32 API level what are the calls that are being made to actually procure information from a Windows 2000",
    "start": "432080",
    "end": "438560"
  },
  {
    "text": "box hackers use these same win32 API calls to get access to your information",
    "start": "438560",
    "end": "444360"
  },
  {
    "text": "any hacker can grab C compiler write certain 132 API calls to your box run it",
    "start": "444360",
    "end": "452800"
  },
  {
    "text": "sorry run it to your box and grab information they don't have to actually be authenticated as anyone there are things called the null credentials log",
    "start": "452800",
    "end": "459120"
  },
  {
    "text": "on well what we did was we took it at two levels one is if you were a full administrator and you wanted to secure",
    "start": "459120",
    "end": "465479"
  },
  {
    "text": "your business assets well if you're full administrator these are the different things that you want to actually look at",
    "start": "465479",
    "end": "471039"
  },
  {
    "text": "you grab the information talk about how to secure it later okay so as was said in our",
    "start": "471039",
    "end": "477879"
  },
  {
    "text": "introduction the name of the tool is called veloc secure and I'm going to run",
    "start": "477879",
    "end": "482919"
  },
  {
    "text": "it locally on my box here just veloc secure with a-f is full mode and as I",
    "start": "482919",
    "end": "488639"
  },
  {
    "text": "hit enter you can see all of the collection and we will go back and run",
    "start": "488639",
    "end": "495479"
  },
  {
    "text": "through this once it's finished what it's done in that couple seconds while I was speaking is take a security snapshot",
    "start": "495479",
    "end": "502960"
  },
  {
    "text": "of this box gather all of the information that we are concerned about as an administrator as Todd said and",
    "start": "502960",
    "end": "509960"
  },
  {
    "text": "we're going to discuss the calls that this program exploits so there are some",
    "start": "509960",
    "end": "515320"
  },
  {
    "text": "different colors and I'm going to have to go back into the guy here just to scroll up for you and it's broken down",
    "start": "515320",
    "end": "522800"
  },
  {
    "text": "by the five forces of user Network resource system and auditing so in the",
    "start": "522800",
    "end": "528560"
  },
  {
    "text": "beginning here in the white part is just the initialization it's reading",
    "start": "528560",
    "end": "533600"
  },
  {
    "text": "directories registry keys registry values from our internal best practices those are the specific components that",
    "start": "533600",
    "end": "540839"
  },
  {
    "text": "we're going to look at when we assess those sections so the first area we're looking at here is system security we're",
    "start": "540839",
    "end": "548680"
  },
  {
    "text": "determining what type of server this is is it a domain controller is it a terminal server is it a cluster server",
    "start": "548680",
    "end": "554320"
  },
  {
    "text": "because based on that single piece of information now we know that there are different parts of this server that we",
    "start": "554320",
    "end": "560440"
  },
  {
    "text": "can attack if it's a domain controller we know it has a copy of the account database and as we know on Windows 2000",
    "start": "560440",
    "end": "567560"
  },
  {
    "text": "every domain controller has a writable copy Cy of the active directory so now potentially there's a place for us to",
    "start": "567560",
    "end": "572880"
  },
  {
    "text": "exploit at any domain controller we are looking at network interfaces we're",
    "start": "572880",
    "end": "578600"
  },
  {
    "text": "looking at Network protocols do we have tcpip do we have NW link and um ipx",
    "start": "578600",
    "end": "585800"
  },
  {
    "text": "things like that what's running on the box processes registry values what what",
    "start": "585800",
    "end": "591200"
  },
  {
    "text": "is the debugger set to there something we might want to change to exploit known dlls um win regge run key all the common",
    "start": "591200",
    "end": "600440"
  },
  {
    "text": "things that you see Security boltons on at Microsoft all the time those are the types of information that we want to",
    "start": "600440",
    "end": "605519"
  },
  {
    "text": "gather so then we can later change values or replace programs that those values point to all those types of",
    "start": "605519",
    "end": "613040"
  },
  {
    "text": "things registry permissions again services this goes back to server type",
    "start": "613040",
    "end": "618079"
  },
  {
    "text": "if we're running a SQL Server an exchange server a web server an FTP server all of those things give us",
    "start": "618079",
    "end": "623880"
  },
  {
    "text": "information to lead us to the next point of security and and then at the end of",
    "start": "623880",
    "end": "630360"
  },
  {
    "text": "this we talk about device and system drivers which relate back to services and then jobs what what is this system",
    "start": "630360",
    "end": "638639"
  },
  {
    "text": "running that was actually all the all pieces of one of the forces and the",
    "start": "640519",
    "end": "645760"
  },
  {
    "text": "reason the program is broken down this way is because system is actually to give you information for how to check the other pieces as David was explaining",
    "start": "645760",
    "end": "653320"
  },
  {
    "text": "so while we look at user resource system Network Ting in that level it's important to always look at system first",
    "start": "653320",
    "end": "659720"
  },
  {
    "text": "when you're actually doing a scan again you want to know what the Box is doing before you actually tell it",
    "start": "659720",
    "end": "665000"
  },
  {
    "text": "what it should be doing next piece is auditing um again it's just looking at the event log it's looking at your audit",
    "start": "665000",
    "end": "671079"
  },
  {
    "text": "policy it's looking at those different pieces of Information Network Security assessment unfortunately David's box",
    "start": "671079",
    "end": "676519"
  },
  {
    "text": "doesn't isn't connected to a network so when we do this type of network security scan there's nothing to actually pull",
    "start": "676519",
    "end": "682920"
  },
  {
    "text": "off of the box so it says you're not a domain controller we're not looking at trust relationships um",
    "start": "682920",
    "end": "689959"
  },
  {
    "text": "and remote access isn't running so there's no dialing resource security now we've gathered enough information about",
    "start": "689959",
    "end": "695680"
  },
  {
    "text": "the box with 132 API calls to understand what it's doing is it a domain controller is it a cluster server when",
    "start": "695680",
    "end": "703320"
  },
  {
    "text": "you go through those pieces I mean it's not important to actually the understanding is that all the blue is resource security so when we go into the",
    "start": "703320",
    "end": "710279"
  },
  {
    "text": "registry we pull where the system directory is because sometimes it's not going to be at back/ Wint we gather",
    "start": "710279",
    "end": "717000"
  },
  {
    "text": "the information now we run our resource security piece and we gain all information about where uh where",
    "start": "717000",
    "end": "723360"
  },
  {
    "text": "sensitive files are stored one of the pieces that we're going to talk about later and one of the case studies is",
    "start": "723360",
    "end": "728800"
  },
  {
    "text": "within the registry there's a section called the allowed paths well the allowed paths allow people to gain",
    "start": "728800",
    "end": "734760"
  },
  {
    "text": "access to sections of the registry regardless of the permissions on the windr key the windr key will also talk",
    "start": "734760",
    "end": "740720"
  },
  {
    "text": "about but that's basically the key that secures the entire registry if you think of the entire registry as being an",
    "start": "740720",
    "end": "749440"
  },
  {
    "text": "object within Windows 2000 well there's actually a share that allows you to connect to the registry just like a",
    "start": "749440",
    "end": "755240"
  },
  {
    "text": "share allows you to connect to a directory that share is protected by a key within the registry called the Win",
    "start": "755240",
    "end": "761600"
  },
  {
    "text": "regge key it's actually a registry share and you know it's not actually called",
    "start": "761600",
    "end": "766720"
  },
  {
    "text": "that in any of the books but it's also difficult because it's kind of you know",
    "start": "766720",
    "end": "772360"
  },
  {
    "text": "a cyclical error in that one key within the registry secures the entire registry at a network layer so we pull this",
    "start": "772360",
    "end": "780199"
  },
  {
    "text": "information hackers could probe the Windows 2000 allow PS registry key gather all",
    "start": "780199",
    "end": "789680"
  },
  {
    "text": "the directory uh all the registry keys that are allowed to be read by a n",
    "start": "789680",
    "end": "795279"
  },
  {
    "text": "credential or anyone else and then start probing those to gain more information",
    "start": "795279",
    "end": "800519"
  },
  {
    "text": "one of these keys by default is the current version key within the registry",
    "start": "800519",
    "end": "805639"
  },
  {
    "text": "the current version key gives you a lot of information about the Box specifically it allows you to go into",
    "start": "805639",
    "end": "810680"
  },
  {
    "text": "another key called AE debug which is where the Windows 2000 debugger is spawned when an application crashes",
    "start": "810680",
    "end": "818079"
  },
  {
    "text": "there was you know a vague bulletin posted about this I think last year with nt40 still exists in 2000 as something",
    "start": "818079",
    "end": "824639"
  },
  {
    "text": "that could be done if it's not secured appropriately well when we look at things like the resource security we",
    "start": "824639",
    "end": "831240"
  },
  {
    "text": "want to make sure things like the debugger which would be Dr Watson 32 ixe can't be replaced we want to make sure",
    "start": "831240",
    "end": "837079"
  },
  {
    "text": "that the registry keys have permissions on them so that hackers can't come in and change that and then the last piece",
    "start": "837079",
    "end": "842480"
  },
  {
    "text": "the fifth force fifth force is going to be the user security and this is kind of the",
    "start": "842480",
    "end": "847800"
  },
  {
    "text": "last piece we do this on the back end because um the users really there's no effect on anything else that's going on",
    "start": "847800",
    "end": "854040"
  },
  {
    "text": "question question regarding wind",
    "start": "854040",
    "end": "858680"
  },
  {
    "text": "yes wind how do you query the registry to determine what you",
    "start": "859839",
    "end": "866959"
  },
  {
    "text": "allowed okay I want to repeat the question slightly differently let me know if this is what",
    "start": "866959",
    "end": "872639"
  },
  {
    "text": "you're asking the question was how do you query the Windows 2000 registry to",
    "start": "872639",
    "end": "878120"
  },
  {
    "text": "understand what access is uh what information is accessible through like the network as a blind audit someone",
    "start": "878120",
    "end": "886120"
  },
  {
    "text": "outside ACLS are set appropriately on the Wind you have the allow the other",
    "start": "886120",
    "end": "892519"
  },
  {
    "text": "key that allows certain areas how do I determine which areow okay the question is how do I",
    "start": "892519",
    "end": "899000"
  },
  {
    "text": "determine what areas are allowed to bypass the windr key okay so the windr",
    "start": "899000",
    "end": "904759"
  },
  {
    "text": "key secures the entire registry with the exception of all the keys listed in the",
    "start": "904759",
    "end": "910680"
  },
  {
    "text": "allowed paths key the allowed paths key is at hkey local machine system current",
    "start": "910680",
    "end": "917920"
  },
  {
    "text": "control set security pipe server secure pipe servers secure pipe server sorry",
    "start": "917920",
    "end": "925680"
  },
  {
    "text": "wind regge allowed paths write down for you later so you can write it down if you didn't want to follow that whole",
    "start": "925680",
    "end": "931720"
  },
  {
    "text": "long spiel that allow paths is a multistring registry value which means",
    "start": "931720",
    "end": "938639"
  },
  {
    "text": "you can have a lot of value separated by Carriage returns and within that key though that multi string is a listing of",
    "start": "938639",
    "end": "946199"
  },
  {
    "text": "all the other registry keys that are allowed to bypass wind R permissions is allow pads in there I mean how do I get",
    "start": "946199",
    "end": "952680"
  },
  {
    "text": "to allowed paths inherently Windows 2000 allows you to get to allow paths because",
    "start": "952680",
    "end": "958120"
  },
  {
    "text": "anytime it's it this is not really a flaw at all within Windows 2000 this is by Design",
    "start": "958120",
    "end": "965199"
  },
  {
    "text": "because if you're on one computer in the network and you want to perhaps print to another computer but you don't it's it's",
    "start": "965199",
    "end": "970480"
  },
  {
    "text": "an Open Access printer you want to be able to use that print server without having to authenticate with a user name",
    "start": "970480",
    "end": "975519"
  },
  {
    "text": "perhaps you're on the internet and there's like a public printer out there you know or your internet anyone in The Firm is allowed to print or even",
    "start": "975519",
    "end": "980560"
  },
  {
    "text": "visitors are allowed to print this computer probes the server and the allow",
    "start": "980560",
    "end": "986199"
  },
  {
    "text": "p is allowed to automatically do that so right off the bat I forgot the actual key but print",
    "start": "986199",
    "end": "993759"
  },
  {
    "text": "there's actually a printing key and we'll show that to you later throughout the cases that says oh anyone can access",
    "start": "993759",
    "end": "1000040"
  },
  {
    "text": "this key and that's what allows them to figure out the printer name and allow them to print question Say by default a",
    "start": "1000040",
    "end": "1005959"
  },
  {
    "text": "null user can connect to the registry and query the allowed Pass",
    "start": "1005959",
    "end": "1011040"
  },
  {
    "text": "key is that what you just said no what he's saying is there are a certain",
    "start": "1011040",
    "end": "1016279"
  },
  {
    "text": "amount and it differs from Windows NT to window and uh 2000 of registry pads that",
    "start": "1016279",
    "end": "1022639"
  },
  {
    "text": "are listed in the allowed pads by default in order for certain functions like printing to work so there's",
    "start": "1022639",
    "end": "1029839"
  },
  {
    "text": "probably eight or 10 that are there by default and that's one of the places",
    "start": "1029839",
    "end": "1035438"
  },
  {
    "text": "that you can start you can't query can I query that set or can I even query any",
    "start": "1035439",
    "end": "1040640"
  },
  {
    "text": "of the keys I the question was from the perspective of Security administrator doing an audit I thought session no session no",
    "start": "1040640",
    "end": "1048319"
  },
  {
    "text": "session from a n session from a n session you have",
    "start": "1048319",
    "end": "1054120"
  },
  {
    "text": "to you would not be able to query the allow P key and get actual answers from",
    "start": "1054160",
    "end": "1059200"
  },
  {
    "text": "it you would need to use the default values or a Brute Force correct and the way there are ways",
    "start": "1059200",
    "end": "1065559"
  },
  {
    "text": "to secure against that which we're going to talk about in one of the cases basically there's a key that says",
    "start": "1065559",
    "end": "1072160"
  },
  {
    "text": "um actually let's wait for the case because I don't want to go down the path too far actual all session can't connect",
    "start": "1072160",
    "end": "1078320"
  },
  {
    "text": "to the Reg after service pack two or three on nt4 and 2000 all session can",
    "start": "1078320",
    "end": "1084679"
  },
  {
    "text": "never connect to the registry unless you enable it by default soon as you say I want to talk to wind bam you're locked",
    "start": "1084679",
    "end": "1092039"
  },
  {
    "text": "out if we have time later we'll do a demo that shows I just went through that lastek be",
    "start": "1092039",
    "end": "1098720"
  },
  {
    "text": "exciting okay uh any other questions about that before we kind of go off the five forces and into some of the other",
    "start": "1098720",
    "end": "1105000"
  },
  {
    "text": "areas is that tool available or you guys keep that we keep it",
    "start": "1105000",
    "end": "1110039"
  },
  {
    "text": "internal actually price what Cooper keeps that",
    "start": "1110039",
    "end": "1114640"
  },
  {
    "text": "internal but we'll talk about how it works at any level that you",
    "start": "1116360",
    "end": "1121760"
  },
  {
    "text": "want okay good so that's basically this is kind of how we do a security",
    "start": "1121760",
    "end": "1127880"
  },
  {
    "text": "assessment again we want to probe as much information that's security relevant as possible to get it",
    "start": "1127880",
    "end": "1133159"
  },
  {
    "text": "off now this isn't in your slides this is something we put together I want to Breeze through this because what this",
    "start": "1133159",
    "end": "1139799"
  },
  {
    "text": "does is Maps different pieces of five forces security assertion flows to",
    "start": "1139799",
    "end": "1147440"
  },
  {
    "text": "objects within your business this is more for people who are concerned about well how do I justify a budget to my CIO",
    "start": "1147440",
    "end": "1155559"
  },
  {
    "text": "to get more funding for security because this Maps it to revenue and expenses so",
    "start": "1155559",
    "end": "1161400"
  },
  {
    "text": "I'm going to go through this quickly I assume based on the introduction that you guys gave to me no one wants to go",
    "start": "1161400",
    "end": "1167159"
  },
  {
    "text": "through this at any deep layers is that correct",
    "start": "1167159",
    "end": "1172840"
  },
  {
    "text": "good [Music] the the kind of letters on the left",
    "start": "1173720",
    "end": "1179240"
  },
  {
    "text": "represent user resource system Network audit the one on the right is confidentiality integrity and availability so we map them through for",
    "start": "1179240",
    "end": "1186080"
  },
  {
    "text": "example user confidentiality what is something that might be in that area of confidentiality of users well their",
    "start": "1186080",
    "end": "1191919"
  },
  {
    "text": "social security network could be printed in the active directory um another one might be you know resource integrity you know some of",
    "start": "1191919",
    "end": "1199520"
  },
  {
    "text": "my resources are my client's investment portfolios the Integrity of that is very important if they buy 30 shares of",
    "start": "1199520",
    "end": "1205120"
  },
  {
    "text": "Microsoft in the morning Microsoft plummets we want to make sure at the end of the day they didn't change that to a",
    "start": "1205120",
    "end": "1210880"
  },
  {
    "text": "sell short um as I said I'll go quickly system",
    "start": "1210880",
    "end": "1217360"
  },
  {
    "text": "Integrity is my website being spoofed I want to make sure someone didn't modify my actual website Network availability",
    "start": "1217360",
    "end": "1223159"
  },
  {
    "text": "um I mean this is how you guys make money if your network isn't up and running people can't connect to your site you know example is like erade who",
    "start": "1223159",
    "end": "1229520"
  },
  {
    "text": "gets you know over a million transactions per day at $8 per trade if",
    "start": "1229520",
    "end": "1235280"
  },
  {
    "text": "these guys go down for an hour even if it is let's say it is 8 million trades",
    "start": "1235280",
    "end": "1240480"
  },
  {
    "text": "per day in one hour say they do business on a standard 8 hour while the Market's open in one hour they're going to lose a",
    "start": "1240480",
    "end": "1247000"
  },
  {
    "text": "million trades at $8 it's $8 million simply because availability of the",
    "start": "1247000",
    "end": "1253799"
  },
  {
    "text": "network ling up to profit and loss Social Security numbers expense because of employee trust things like you know",
    "start": "1254360",
    "end": "1261760"
  },
  {
    "text": "passwords being compromised the expense of having to change the passwords or the example of just use of network availability if you can't simply have",
    "start": "1261760",
    "end": "1269760"
  },
  {
    "text": "your network up and available you know Revenue it's volume and tracing these",
    "start": "1269760",
    "end": "1274880"
  },
  {
    "text": "back to the win32 API layer things like user confidentiality links to user",
    "start": "1274880",
    "end": "1280559"
  },
  {
    "text": "rights your client's assets to the permissions resource again we're looking at",
    "start": "1280559",
    "end": "1286679"
  },
  {
    "text": "permissions any questions on this stuff since I'm skipping a lot of it to get to the",
    "start": "1287200",
    "end": "1293240"
  },
  {
    "text": "meet so what are hackers going to do okay so this kind of goes back to the",
    "start": "1293480",
    "end": "1300120"
  },
  {
    "text": "question we had just at the beginning blind audit from the outside or somewhere on the internal Network",
    "start": "1300120",
    "end": "1305840"
  },
  {
    "text": "without authentication what kind of information can I gather by default so through a null session you know a net",
    "start": "1305840",
    "end": "1312760"
  },
  {
    "text": "use or using the um you know direct uh 132 API",
    "start": "1312760",
    "end": "1318680"
  },
  {
    "text": "[Music] what kind of information can we gather and by default it's an extraordinary amount of information User listing group",
    "start": "1318680",
    "end": "1325640"
  },
  {
    "text": "listing share listing um we can start from that information to find out you",
    "start": "1325640",
    "end": "1331640"
  },
  {
    "text": "know if the administrator account has been renamed what is it rename too start going after that now I know what the",
    "start": "1331640",
    "end": "1337360"
  },
  {
    "text": "guest account is does that have a blank password and build off that in nt4 the",
    "start": "1337360",
    "end": "1343120"
  },
  {
    "text": "registry key restrict Anonymous you could set it to one in 2000 you could set it to one or two still Zero by",
    "start": "1343120",
    "end": "1349520"
  },
  {
    "text": "default and that is a best practice for kind of your first stop Gap what are we",
    "start": "1349520",
    "end": "1355640"
  },
  {
    "text": "going to do to prevent this information gathering what does two do Beyond",
    "start": "1355640",
    "end": "1361520"
  },
  {
    "text": "one like setting at the two instead of one what added security it's specific um 2,000 there's",
    "start": "1361520",
    "end": "1370679"
  },
  {
    "text": "there's some more information uh within Windows 2000 because of the whole um",
    "start": "1370679",
    "end": "1376679"
  },
  {
    "text": "pre- Windows 2000 compatible group which is part of the Everyone by default so there's information that you know you",
    "start": "1376679",
    "end": "1383559"
  },
  {
    "text": "can query out of active directory so two turns off the everyone group uh it doesn't turn off the everyone group it",
    "start": "1383559",
    "end": "1388960"
  },
  {
    "text": "just restricts more the information actually can get you an exact answer on that because it's one of the what they",
    "start": "1388960",
    "end": "1394760"
  },
  {
    "text": "did in Windows 2000 I'm sure most of you aware they put a lot of those important registry keys into a little goey for us",
    "start": "1394760",
    "end": "1400840"
  },
  {
    "text": "using Microsoft Management console so I'll just pop it up and get you the exact option uh the exact answer to that",
    "start": "1400840",
    "end": "1407240"
  },
  {
    "text": "but I mean what I believe it does is one says you can still connect with null and probe users and groups and all that you",
    "start": "1407240",
    "end": "1414320"
  },
  {
    "text": "just can't get access to certain pieces but I mean and two would say you can't get access to anything so zero means",
    "start": "1414320",
    "end": "1422640"
  },
  {
    "text": "none you rely on default permissions with the restrict access so null can get and you rely on default permissions if",
    "start": "1422640",
    "end": "1427880"
  },
  {
    "text": "you're null and it says everyone full control you have full control one says you can allow the enumeration of Sam",
    "start": "1427880",
    "end": "1434159"
  },
  {
    "text": "accounts and shares so and then the last one which",
    "start": "1434159",
    "end": "1439559"
  },
  {
    "text": "was a two would say no access without explicit perm without explicit Anonymous permissions so You' have to explicitly",
    "start": "1439559",
    "end": "1445760"
  },
  {
    "text": "say anonymous had specific access null credentials specific access which would",
    "start": "1445760",
    "end": "1452000"
  },
  {
    "text": "actually be included if it didn't have a discretion Access Control list at all for example a fat",
    "start": "1452000",
    "end": "1458799"
  },
  {
    "text": "Drive okay and Once We Gather certain information with null or once we you",
    "start": "1459720",
    "end": "1465960"
  },
  {
    "text": "know use that to discover a username or password we kind of Step Up a level and now we're at user level access that",
    "start": "1465960",
    "end": "1472080"
  },
  {
    "text": "gives us a whole new range of 132 API calls yes",
    "start": "1472080",
    "end": "1478960"
  },
  {
    "text": "how access well there are a couple different",
    "start": "1478960",
    "end": "1484120"
  },
  {
    "text": "techniques um one might be we should do it during the case okay we'll talk about it during the case it's there's we're",
    "start": "1484120",
    "end": "1490919"
  },
  {
    "text": "real short answer there are win 32 API calls that say if you are null you're allowed to do all of this assuming",
    "start": "1490919",
    "end": "1496960"
  },
  {
    "text": "restrict Anonymous isn't set to allow it",
    "start": "1496960",
    "end": "1503840"
  },
  {
    "text": "correct yes absolutely and we'll go through the case example in more detail but the answer to question is absolutely",
    "start": "1508480",
    "end": "1516640"
  },
  {
    "text": "yes there's uh just to clarify necessarily are you getting at the PRS",
    "start": "1516640",
    "end": "1521840"
  },
  {
    "text": "the pre- Windows 2000 group there's a group in Windows 2 okay we'll talk about that later too just let me just clarify",
    "start": "1521840",
    "end": "1529159"
  },
  {
    "text": "real quick you can't necessarily read a password as null but you could read a username and then lead to root Force",
    "start": "1529159",
    "end": "1535240"
  },
  {
    "text": "attack or if you have a large user listing there may be password or null things like that and you can test those",
    "start": "1535240",
    "end": "1541679"
  },
  {
    "text": "that is a separate activity two steps two steps and then once you progress to",
    "start": "1541679",
    "end": "1546919"
  },
  {
    "text": "the point where you have a valid username and password which might be blank or null now we're at the user level so we have a whole new range of",
    "start": "1546919",
    "end": "1554279"
  },
  {
    "text": "calls then from user level we use that information again we'll talk about during the case and then you might be",
    "start": "1554279",
    "end": "1560960"
  },
  {
    "text": "able to get to administrative level and from that now you've got full control and you can get everything that we just",
    "start": "1560960",
    "end": "1566279"
  },
  {
    "text": "talked about and clearly your confidentiality Integrity availability all of those are at that point could be",
    "start": "1566279",
    "end": "1572279"
  },
  {
    "text": "breached from favor sorry I I interrupt him aot as I'm",
    "start": "1572279",
    "end": "1578039"
  },
  {
    "text": "bad I was just saying from that perspective later when we talk about this if we forget to bring it up ask that question again because there's",
    "start": "1578039",
    "end": "1584080"
  },
  {
    "text": "something that called the the pre- Windows 2000 group I'll get the exact for you but that's actually a very",
    "start": "1584080",
    "end": "1590520"
  },
  {
    "text": "important factor when you talk about this in Windows 2000 so it's it's a really good",
    "start": "1590520",
    "end": "1596440"
  },
  {
    "text": "point apologies um I yes well so I guess from",
    "start": "1596440",
    "end": "1605559"
  },
  {
    "text": "from our perspective this this this notion of null is actually one of the biggest ways that we see hackers getting",
    "start": "1605559",
    "end": "1611720"
  },
  {
    "text": "in because I mean a lot of the attack and penetrations that we've done revolve around you having no information about a",
    "start": "1611720",
    "end": "1618960"
  },
  {
    "text": "box you probe it you do these win32 API calls to get as much information as you",
    "start": "1618960",
    "end": "1624000"
  },
  {
    "text": "can as all if they've turned off restricted nous or they've turned off you know the server service which means you can't even get you know a net bios",
    "start": "1624000",
    "end": "1630279"
  },
  {
    "text": "connection to the box they've done a really you know that's a a a huge step in protecting the Box typically these",
    "start": "1630279",
    "end": "1637360"
  },
  {
    "text": "things aren't done because restrict Anonymous in the past a lot of clients have said to us well it creates incompatibilities we can't do it we",
    "start": "1637360",
    "end": "1643799"
  },
  {
    "text": "can't roll it out to you know 4,000 servers in our organization um it's going to take us a couple to do that",
    "start": "1643799",
    "end": "1648840"
  },
  {
    "text": "kind of thing there are many different many different excuses and they're very legitimate but what we see typically is",
    "start": "1648840",
    "end": "1656440"
  },
  {
    "text": "null is allowed so the very first thing we do is we grab every single piece of information null allows we grab all the",
    "start": "1656440",
    "end": "1663640"
  },
  {
    "text": "user groups all the user listings group identities so now we can figure out what",
    "start": "1663640",
    "end": "1669120"
  },
  {
    "text": "we get from that information is who's in the administrators group what are their usernames and then all the other",
    "start": "1669120",
    "end": "1674720"
  },
  {
    "text": "information about them like what's their full name and all that because what we use is that information to actually try to figure out their",
    "start": "1674720",
    "end": "1681440"
  },
  {
    "text": "password we do a Brute Force attack on that hopefully that gets us more information maybe at a user level so we do we change we remove our connection as",
    "start": "1681440",
    "end": "1688039"
  },
  {
    "text": "null we make it user once we get user there are other types of calls you can make like probing the service control",
    "start": "1688039",
    "end": "1694480"
  },
  {
    "text": "manager which tells you now what services are running hopefully there's one maybe you can exploit you try to grab the share information you could do",
    "start": "1694480",
    "end": "1702000"
  },
  {
    "text": "you could grab all the shares that exist on a box if null is allowed if restrict",
    "start": "1702000",
    "end": "1707039"
  },
  {
    "text": "Anonymous isn't secured once you get all those shares you figure out does everyone have full control on all them which is the default",
    "start": "1707039",
    "end": "1713039"
  },
  {
    "text": "ACL and taking things like well maybe there's a share that connects maybe",
    "start": "1713039",
    "end": "1718080"
  },
  {
    "text": "there's a share where there's a service executable running well now maybe we could replace that service executable with one of our Trojan",
    "start": "1718080",
    "end": "1723320"
  },
  {
    "text": "horses and now you've what you've done is youve been able to put a file on the computer",
    "start": "1723320",
    "end": "1728840"
  },
  {
    "text": "that allows you to run any executable that you want to upload as local system and I mean there's lots of different",
    "start": "1728840",
    "end": "1735080"
  },
  {
    "text": "ways to approach this that's just one of many many",
    "start": "1735080",
    "end": "1740600"
  },
  {
    "text": "ones the question was is blocking the net bios ports efficient um so",
    "start": "1747679",
    "end": "1753399"
  },
  {
    "text": "sufficient oh sufficient or",
    "start": "1753399",
    "end": "1757399"
  },
  {
    "text": "you're see that's what a lot of people are doing so let's take perimeter security like a",
    "start": "1759559",
    "end": "1765640"
  },
  {
    "text": "firewall would block um 135 which is RPC 137 8 and N which are the net bios ports",
    "start": "1765640",
    "end": "1775000"
  },
  {
    "text": "one of them is for fragments datagrams the other one the last one's for net bios names so now someone can't get in",
    "start": "1775000",
    "end": "1782279"
  },
  {
    "text": "to a share you cannot connect to a share you can't run any you can't run any 132",
    "start": "1782279",
    "end": "1788640"
  },
  {
    "text": "API calls if those were blocked is",
    "start": "1788640",
    "end": "1793399"
  },
  {
    "text": "that 445",
    "start": "1793919",
    "end": "1797919"
  },
  {
    "text": "2000 okay great thank you um so what you've done is you've you've mitigated",
    "start": "1799000",
    "end": "1805080"
  },
  {
    "text": "that but I don't want to say that you've now that's not sufficient because today",
    "start": "1805080",
    "end": "1810279"
  },
  {
    "text": "you know if you have a web server in your environment people will go to that web server on Port 80 perhaps try to",
    "start": "1810279",
    "end": "1816159"
  },
  {
    "text": "attack it using I mean there was a lot of attacks talked about yesterday about attacking a web server on Port 80",
    "start": "1816159",
    "end": "1822039"
  },
  {
    "text": "um what was there Unicode buffer overflow that I think one of other companies talked about but what happens",
    "start": "1822039",
    "end": "1827440"
  },
  {
    "text": "then is you use that server as like a port redirector so if you can attack that web server on Port 80 now you",
    "start": "1827440",
    "end": "1833559"
  },
  {
    "text": "install a port redirector go to that on Port 80 and now you have Port 135 13678",
    "start": "1833559",
    "end": "1839200"
  },
  {
    "text": "uh 13789 and 445 to the other the other uh windows boxes yes just a statement it",
    "start": "1839200",
    "end": "1847360"
  },
  {
    "text": "really doesn't matter most of the losses that are occuring according to the FBI in the corporate level are from anyway",
    "start": "1847360",
    "end": "1853960"
  },
  {
    "text": "it's a great point I think what we did a survey that said 85% of attacks come from inside the firewall so put all the",
    "start": "1853960",
    "end": "1860080"
  },
  {
    "text": "attention you want on your firewall but do not forget corcy insu right clearly the you know soft mushy underbelly of",
    "start": "1860080",
    "end": "1866720"
  },
  {
    "text": "the firm is everything within the perimeter security and that's why all of this stuff is still very very important",
    "start": "1866720",
    "end": "1872000"
  },
  {
    "text": "and increasingly important so SNMP you said SNB it's 445 okay",
    "start": "1872000",
    "end": "1879799"
  },
  {
    "text": "um great so that was kind of our intro to how the attacker so now we're looking",
    "start": "1879799",
    "end": "1885279"
  },
  {
    "text": "at this as um let's say 85% of the taxs or some large number come from the inside well these people do have net",
    "start": "1885279",
    "end": "1891159"
  },
  {
    "text": "bios activity they are going to be using 132 API calls case number one see how we're",
    "start": "1891159",
    "end": "1898919"
  },
  {
    "text": "doing on time case number one this is a Pharmaceuticals Company",
    "start": "1898919",
    "end": "1905679"
  },
  {
    "text": "enterprise-wide employee directory they want everyone to be able to access this directory to gain pretty much public",
    "start": "1905679",
    "end": "1911240"
  },
  {
    "text": "information so this isn't their primary concern is not confidentiality their primary concern is the integrity and",
    "start": "1911240",
    "end": "1916360"
  },
  {
    "text": "availability of it um actually the primary concern is availability because people need to be able to get get access",
    "start": "1916360",
    "end": "1921720"
  },
  {
    "text": "to information let's say there's a doctor working on a formula he needs to figure out well who has expertise in this area so he's always probing you",
    "start": "1921720",
    "end": "1927720"
  },
  {
    "text": "know a domain controller to find out you know who's got access to this so why why is this so important to them uh again",
    "start": "1927720",
    "end": "1934600"
  },
  {
    "text": "directors and managers require access to find out well what's this person's phone number you know we got you know we got a fire alarm going on like who do we",
    "start": "1934600",
    "end": "1941600"
  },
  {
    "text": "call complex hierarchical corporate Authority so these guys very important",
    "start": "1941600",
    "end": "1947279"
  },
  {
    "text": "they want all 60,000 employees to be able to get access to this directory at any time immediately they have two dozen",
    "start": "1947279",
    "end": "1953440"
  },
  {
    "text": "domains so there's a lot of ways you can look at this one way that they were",
    "start": "1953440",
    "end": "1959200"
  },
  {
    "text": "concerned about looking at it from their perspective for an assessment was to",
    "start": "1959200",
    "end": "1964799"
  },
  {
    "text": "look at one are all the domain controllers available we want to make sure that none of them have been um you",
    "start": "1964799",
    "end": "1972159"
  },
  {
    "text": "know I guess removed none of them are brought down none of them have been Deni of serviced another thing they want to",
    "start": "1972159",
    "end": "1978880"
  },
  {
    "text": "look at is can users search the directory do they actually have authority to do that and can they only search certain areas of it again it's",
    "start": "1978880",
    "end": "1984799"
  },
  {
    "text": "not really confidentiality issue it's availability so it's not like the social security numbers of people are in this",
    "start": "1984799",
    "end": "1990880"
  },
  {
    "text": "database they want to make sure no one's trying to compromise the availability of the servers is someone trying to get access to the registry so they could",
    "start": "1990880",
    "end": "1996840"
  },
  {
    "text": "place a trojan horse in there is someone trying to do some type of denial service attack and the last piece again they",
    "start": "1996840",
    "end": "2002880"
  },
  {
    "text": "threw this out was want to make sure our printers are accessible by everybody so another thing they wants to look at or",
    "start": "2002880",
    "end": "2008159"
  },
  {
    "text": "printer accessibility all these kind of in the line of availability we could argue all day",
    "start": "2008159",
    "end": "2014080"
  },
  {
    "text": "confidentiality is equal as important and integrity we're just going to focus on this one piece for the case",
    "start": "2014080",
    "end": "2020960"
  },
  {
    "text": "study okay so this is now kind of the the nuts and bols where we get into so",
    "start": "2021760",
    "end": "2028559"
  },
  {
    "text": "the first thing we want to do is we want to get a list of users and their properties we want to find out you know",
    "start": "2028559",
    "end": "2035840"
  },
  {
    "text": "what accounts are disabled what are locked out are monitor for those things",
    "start": "2035840",
    "end": "2040919"
  },
  {
    "text": "because again availability is our highest concern so we're looking at net user enum and net user get info which",
    "start": "2040919",
    "end": "2047960"
  },
  {
    "text": "are both accessible via null connections and as we said earlier some of this is",
    "start": "2047960",
    "end": "2054079"
  },
  {
    "text": "from the perspective of hacking a lot of it is from the perspective of the administrator looking at the network to",
    "start": "2054079",
    "end": "2060599"
  },
  {
    "text": "determine what needs to be secured so just so you know my uh notation the",
    "start": "2060599",
    "end": "2066839"
  },
  {
    "text": "function calls and then whether or not they're available through null in in parentheses some have nt4 only some are",
    "start": "2066839",
    "end": "2073679"
  },
  {
    "text": "Windows 2000 only",
    "start": "2073679",
    "end": "2076919"
  },
  {
    "text": "yes I I didn't bother writing it down it was um it was mixed domain um so the",
    "start": "2085000",
    "end": "2092079"
  },
  {
    "text": "reason I guess that was important was because certain attacks could be run at the nt4 level to gain access to the",
    "start": "2092079",
    "end": "2098480"
  },
  {
    "text": "2,000",
    "start": "2098480",
    "end": "2101000"
  },
  {
    "text": "controllers oh yeah the scenario actually would have been quite different because we",
    "start": "2105240",
    "end": "2111200"
  },
  {
    "text": "particular yes to repeat this case does presume mix mode nt4 and Windows",
    "start": "2111720",
    "end": "2117280"
  },
  {
    "text": "2000 thanks for the",
    "start": "2117280",
    "end": "2120680"
  },
  {
    "text": "clarification so again these two function calls are available via null and and best practices in this instance",
    "start": "2123480",
    "end": "2130480"
  },
  {
    "text": "are because availability is the highest concern watch for locked out and disabled accounts uh find out what's",
    "start": "2130480",
    "end": "2136839"
  },
  {
    "text": "going on with those maybe there's intrusions maybe there's not intrusions but again that that's our our main",
    "start": "2136839",
    "end": "2142320"
  },
  {
    "text": "concern we don't want to force log offs and uh we don't want people to have to log on in order to change their password",
    "start": "2142320",
    "end": "2148240"
  },
  {
    "text": "because if it's coming through an internet or a browser based you'll get that that kind of hanging thing",
    "start": "2148240",
    "end": "2154160"
  },
  {
    "text": "yes you make the updated yes we actually have the whole presentation and we have a box of them",
    "start": "2154160",
    "end": "2160319"
  },
  {
    "text": "so at the you can come up and get them okay thanks so that that's kind of the",
    "start": "2160319",
    "end": "2167280"
  },
  {
    "text": "first step as we said we are trying to look at this environment and figure out",
    "start": "2167280",
    "end": "2173200"
  },
  {
    "text": "so as Todd oh no I was I was going to start to address the gentleman's point from earlier but contined on your line",
    "start": "2173200",
    "end": "2180680"
  },
  {
    "text": "you can go ahead I just wanted to I mean we're talking about the user security piece now so it's very important to raise your your issue from earlier which",
    "start": "2180680",
    "end": "2188599"
  },
  {
    "text": "was you know what well how does what happens in Windows 2000 with this you know this probing using a null",
    "start": "2188599",
    "end": "2195000"
  },
  {
    "text": "credential to gain access to all users or groups well in nt40 the way it worked",
    "start": "2195000",
    "end": "2200480"
  },
  {
    "text": "was if someone made a net user get info call which has to be preceded by a net",
    "start": "2200480",
    "end": "2207319"
  },
  {
    "text": "user enum which also required null you could just gain all the information about a user that's stored on the on the",
    "start": "2207319",
    "end": "2214280"
  },
  {
    "text": "computer except for the password you can find out what their log on hours are you could find out what workstations they're allowed to log in from you can find out",
    "start": "2214280",
    "end": "2220920"
  },
  {
    "text": "when the last time they logged in when the last time they changed their password anything full name description what groups they're member of",
    "start": "2220920",
    "end": "2227440"
  },
  {
    "text": "Etc the difference in Windows 2000 by default is nothing however very simple",
    "start": "2227440",
    "end": "2234000"
  },
  {
    "text": "step if you don't want to go through the restrict Anonymous piece which basically disallows all the enumeration of",
    "start": "2234000",
    "end": "2240480"
  },
  {
    "text": "accounts Etc there's something called the pre- Windows 2000 compatible access",
    "start": "2240480",
    "end": "2245880"
  },
  {
    "text": "group just so you guys know know this is Microsoft's developers Network platform SDK um contains all the information",
    "start": "2245880",
    "end": "2252920"
  },
  {
    "text": "about all the 132 API calls that you guys could ever want to know and what happens with this pre- Windows 2000",
    "start": "2252920",
    "end": "2258800"
  },
  {
    "text": "compatible access group is it it simply inherently is used by",
    "start": "2258800",
    "end": "2264839"
  },
  {
    "text": "Windows 2000 to say well how does this relate to Windows nt4 we're going to make it compatible backwards compatible",
    "start": "2264839",
    "end": "2271200"
  },
  {
    "text": "with nt4 for specifically this type of environment of mixed mixed mode so what happens is if you simply remove everyone",
    "start": "2271200",
    "end": "2279040"
  },
  {
    "text": "which by default is a member of this group if you remove it they can no longer use this type of call and it",
    "start": "2279040",
    "end": "2285680"
  },
  {
    "text": "probably says on there right what happens at that point is the ACLS on the active directory",
    "start": "2285680",
    "end": "2291760"
  },
  {
    "text": "objects themselves take precedence right your point",
    "start": "2291760",
    "end": "2297440"
  },
  {
    "text": "that by default allows",
    "start": "2297440",
    "end": "2303000"
  },
  {
    "text": "user absolutely so to repeat it for the rest of you guys what we're saying is by",
    "start": "2303000",
    "end": "2308160"
  },
  {
    "text": "default within Windows 2000 the it's the exact same functionality as nt4 but they",
    "start": "2308160",
    "end": "2313640"
  },
  {
    "text": "made it very easy for you to remove that to to fix this simply by saying well I'm not going to make this nt40 compatible",
    "start": "2313640",
    "end": "2320560"
  },
  {
    "text": "I'm going to remove the everyone group from this group called pre- Windows 2000",
    "start": "2320560",
    "end": "2326200"
  },
  {
    "text": "compatible access that's the name of the group everyone is a member of it the null credentials logon is a member of",
    "start": "2326200",
    "end": "2334800"
  },
  {
    "text": "everyone the next following question would be presumably this organization got this mixed environment for a reason",
    "start": "2334800",
    "end": "2340720"
  },
  {
    "text": "they care about ability they come window controllers and is good but",
    "start": "2340720",
    "end": "2347560"
  },
  {
    "text": "they're exposed this they remove they change what else they lose question was",
    "start": "2347560",
    "end": "2353440"
  },
  {
    "text": "so what are the repercussions of removing this group and it's it's funny clients sometimes",
    "start": "2353440",
    "end": "2361800"
  },
  {
    "text": "have had no problem you know they remove it this is not required you know you",
    "start": "2361800",
    "end": "2367760"
  },
  {
    "text": "don't necessarily need this to authenticate to the domain controller this was just something that was simply put in there by default because an",
    "start": "2367760",
    "end": "2374160"
  },
  {
    "text": "application like Samba might need it um things like that we've had clients remove it for the most part and have had",
    "start": "2374160",
    "end": "2380560"
  },
  {
    "text": "no problems but I can't say for I can't make the broad statement that says remove it you're going to be secured no",
    "start": "2380560",
    "end": "2387400"
  },
  {
    "text": "problems there might be some backwards compatibility problem one of the things we've done is gone through and anywhere",
    "start": "2387400",
    "end": "2393760"
  },
  {
    "text": "there's an ACL that is listed for everyone just Chang that's a it's a great step what what",
    "start": "2393760",
    "end": "2399920"
  },
  {
    "text": "what they did in their organization was went to the ACL of each object and they changed the default permissions removed",
    "start": "2399920",
    "end": "2405560"
  },
  {
    "text": "everyone and put authenticated users it's great does I mean is there does is there anyone else here who has something",
    "start": "2405560",
    "end": "2411319"
  },
  {
    "text": "else that they've done that's been successful yes we cha that auth us are",
    "start": "2411319",
    "end": "2418160"
  },
  {
    "text": "REM from okayed",
    "start": "2418160",
    "end": "2423960"
  },
  {
    "text": "AC also I mean that's that's actually an additional step because now what they did was they removed authenticated users",
    "start": "2423960",
    "end": "2429800"
  },
  {
    "text": "from the default OU from the schema not so you don't you so",
    "start": "2429800",
    "end": "2437560"
  },
  {
    "text": "authenticated users is exactly the same as the everyone group with the exception of the null credentials logon is not",
    "start": "2437560",
    "end": "2443720"
  },
  {
    "text": "included in it so they you guys actually took an extra step and said we're not even using that because that's essentially everyone except for null",
    "start": "2443720",
    "end": "2449880"
  },
  {
    "text": "we're going to use explicit permissions which is usually very timec consuming",
    "start": "2449880",
    "end": "2455280"
  },
  {
    "text": "that is a fantastic step in getting to a secure model CU what the theory behind that",
    "start": "2455280",
    "end": "2462440"
  },
  {
    "text": "which we're going to talk about later is you grant people the least privileges",
    "start": "2462440",
    "end": "2467720"
  },
  {
    "text": "required and the least privileges required would say well not everyone who's an authenticated user needs this",
    "start": "2467720",
    "end": "2473839"
  },
  {
    "text": "only only Bill only Dave Etc Okay so we've gone through user",
    "start": "2473839",
    "end": "2480960"
  },
  {
    "text": "listings we've touched on groups already but again using the net group enum group get info now we can",
    "start": "2480960",
    "end": "2487920"
  },
  {
    "text": "see so say we have 10,000 20,000 users we've got a lot of information we're",
    "start": "2487920",
    "end": "2493040"
  },
  {
    "text": "trying to figure out you know either how to secure or how to hack this environment who do we really care about",
    "start": "2493040",
    "end": "2499720"
  },
  {
    "text": "and that's where the group information comes in who's in administrators who's in high privileged accounts like server",
    "start": "2499720",
    "end": "2505720"
  },
  {
    "text": "operators account operators things along those lines and the reason we care about",
    "start": "2505720",
    "end": "2510960"
  },
  {
    "text": "this is because in a lot of organizations when we do an attack and penetration we almost have information",
    "start": "2510960",
    "end": "2517200"
  },
  {
    "text": "overload because the environments are these steps that you know of this whole",
    "start": "2517200",
    "end": "2522640"
  },
  {
    "text": "room two people mentioned uh specific actions that they've taken and I'm sure other of you have but don't want to",
    "start": "2522640",
    "end": "2529079"
  },
  {
    "text": "speak up or using the the same technique but a lot of companies do nothing and",
    "start": "2529079",
    "end": "2535079"
  },
  {
    "text": "they either don't understand don't have the resources don't have the time money Etc so you can get an astounding amount",
    "start": "2535079",
    "end": "2543599"
  },
  {
    "text": "of information huge loser listing so we'll take this to say now we've got these 35 administrators or these 20",
    "start": "2543599",
    "end": "2550880"
  },
  {
    "text": "server operators and we can Target individuals and this is kind of from our",
    "start": "2550880",
    "end": "2556040"
  },
  {
    "text": "our first slide in our demo basically the the approach here is",
    "start": "2556040",
    "end": "2561319"
  },
  {
    "text": "gather information assess that information and then move on to the next step yes given the complexity course",
    "start": "2561319",
    "end": "2568240"
  },
  {
    "text": "security configuration manager templates what experien with them you know",
    "start": "2568240",
    "end": "2573920"
  },
  {
    "text": "matching up against us say you Pi one of those security lels",
    "start": "2573920",
    "end": "2579119"
  },
  {
    "text": "app okay right the default templates included with service configur man",
    "start": "2580000",
    "end": "2587880"
  },
  {
    "text": "service configuration manager for nt4 or Windows 2000 that's that's right so that was the question security configuration",
    "start": "2587880",
    "end": "2594040"
  },
  {
    "text": "manager was released with Service Pack 4 uh on the CD people have been using that on nt4 it's part of 2000 when people",
    "start": "2594040",
    "end": "2601920"
  },
  {
    "text": "apply those templates how good are they what kind of information is this restricting and that's a very good question",
    "start": "2601920",
    "end": "2607920"
  },
  {
    "text": "to a certain extent it it helps clearly um there are portions of that that let",
    "start": "2607920",
    "end": "2614440"
  },
  {
    "text": "you restrict group membership let you set acl's on registry keys let you set",
    "start": "2614440",
    "end": "2619599"
  },
  {
    "text": "acl's on directories there are also a lot of things that it does not do it does not let you set acl's on shares it",
    "start": "2619599",
    "end": "2626440"
  },
  {
    "text": "does not let you create and delete shares it does not let you start and stop service well it does let you start",
    "start": "2626440",
    "end": "2632880"
  },
  {
    "text": "stop and start Services sorry it does not let you uh add or remove services and things like that so it gets you a",
    "start": "2632880",
    "end": "2640359"
  },
  {
    "text": "certain amount of the way and when we use security configuration manager and its templates for our clients to secure",
    "start": "2640359",
    "end": "2646640"
  },
  {
    "text": "environments we have to we build that into a scripting process that includes several other tools to kind of finish",
    "start": "2646640",
    "end": "2653599"
  },
  {
    "text": "the job so it's a great step and it gets people part of the way as are some of",
    "start": "2653599",
    "end": "2658960"
  },
  {
    "text": "these other things that we've mentioned but there's there's still a lot more to go I guess the one thing I would add is",
    "start": "2658960",
    "end": "2665160"
  },
  {
    "text": "typically anything that's out there as a default anything that's there that says like this is the general security mode",
    "start": "2665160",
    "end": "2672480"
  },
  {
    "text": "that you can use to apply to you know your environment typically won't be as secure as if you did it yourself because",
    "start": "2672480",
    "end": "2678520"
  },
  {
    "text": "they don't want to break anything and therefore they're going to use kind of the maximum amount of security that",
    "start": "2678520",
    "end": "2683599"
  },
  {
    "text": "doesn't break anything regardless of the type of environment so you know you will always be able to do one step better by",
    "start": "2683599",
    "end": "2691160"
  },
  {
    "text": "customizing it for your environment but the other thing I would like to do is throw it back at you guys and say well what's your experience by using the",
    "start": "2691160",
    "end": "2697079"
  },
  {
    "text": "default templates um does anyone have you know any information to provide on",
    "start": "2697079",
    "end": "2702720"
  },
  {
    "text": "what their experience in using the default I mean we've never you know we don't secure our clients using the",
    "start": "2702720",
    "end": "2707960"
  },
  {
    "text": "defaults I've done a lot of work in the area better than but every time I go and",
    "start": "2707960",
    "end": "2713880"
  },
  {
    "text": "say forgot about thisg this so just basically better than",
    "start": "2713880",
    "end": "2719480"
  },
  {
    "text": "okay it's like putting that up and that's it the one thing I would so adding to that also and and just kind of building off what I was saying earlier I",
    "start": "2719480",
    "end": "2726079"
  },
  {
    "text": "do like the fact that they kind of been split off now into workstation and server and I think it's workstation",
    "start": "2726079",
    "end": "2732920"
  },
  {
    "text": "application server and domain controller they don't really call it application server but so that's one step that you",
    "start": "2732920",
    "end": "2738160"
  },
  {
    "text": "guys do want to be taking you want to say to yourself is it a domain controller well if it's not what is it",
    "start": "2738160",
    "end": "2743400"
  },
  {
    "text": "doing if it's an application server or a file server security does need to be applied in different ways um it's not",
    "start": "2743400",
    "end": "2749800"
  },
  {
    "text": "drastic I'm not saying you know well every single registry key is going to be a different permission but there will be",
    "start": "2749800",
    "end": "2755760"
  },
  {
    "text": "differences we're all done with groups so groups is",
    "start": "2755760",
    "end": "2761319"
  },
  {
    "text": "another one of those calls that can be again probed with a null credential you can grab all the information listings",
    "start": "2761319",
    "end": "2767720"
  },
  {
    "text": "the other things that we've kind of stumbled along which we didn't really have in our kind of attack and penetration best practice was sometimes",
    "start": "2767720",
    "end": "2773520"
  },
  {
    "text": "we'll do this group call and we'll we'll be able to find out where some of those other trusting domains are or trusted",
    "start": "2773520",
    "end": "2780079"
  },
  {
    "text": "domains because when you do uh a group get info call on a domain controller",
    "start": "2780079",
    "end": "2787160"
  },
  {
    "text": "sometimes you're going to see members of groups from other domains and now you're like oh well maybe that's another domain I should be going",
    "start": "2787160",
    "end": "2792359"
  },
  {
    "text": "after so again more",
    "start": "2792359",
    "end": "2796119"
  },
  {
    "text": "information so that's kind of getting them at availability of users you know we've done an assessment now of you know",
    "start": "2797640",
    "end": "2804119"
  },
  {
    "text": "the pharmaceutical environment for this company 60,000 users we now know they're all there you know counts haven't been",
    "start": "2804119",
    "end": "2809760"
  },
  {
    "text": "locked out um you know we know brute for attacks aren't going on so now we're",
    "start": "2809760",
    "end": "2815880"
  },
  {
    "text": "going to look at resour security for this Pharmaceuticals company okay and again the resource that",
    "start": "2815880",
    "end": "2823200"
  },
  {
    "text": "we was important in this example was uh printers acl's on printers so the first",
    "start": "2823200",
    "end": "2829200"
  },
  {
    "text": "thing we did was in EN on printers get a list of what printers are installed what",
    "start": "2829200",
    "end": "2835720"
  },
  {
    "text": "exists on that remote machine and then used get name security info which is kind of a a multi-purpose function",
    "start": "2835720",
    "end": "2843040"
  },
  {
    "text": "because what you do is you say what type of object you're looking for security on",
    "start": "2843040",
    "end": "2848359"
  },
  {
    "text": "in this case we call that with printers but we can call that with daal with discretionary Access Control lists for",
    "start": "2848359",
    "end": "2855319"
  },
  {
    "text": "files for um registry permissions service permissions right all kinds of objects",
    "start": "2855319",
    "end": "2862680"
  },
  {
    "text": "um including mail slots UNC names file names it's it's very extensible and we can also call that for system Access",
    "start": "2862680",
    "end": "2869480"
  },
  {
    "text": "Control lists if we want sack audit settings ownership information like that so this is a pretty broad function that",
    "start": "2869480",
    "end": "2876200"
  },
  {
    "text": "uh you'll only see here in our example but it's used in many places to get many different uh pieces of information this",
    "start": "2876200",
    "end": "2883359"
  },
  {
    "text": "requ as normal user right excellent I was just thank you the question was does this require normal user level access",
    "start": "2883359",
    "end": "2889839"
  },
  {
    "text": "the answer is yes it does not run with null you cannot do an enum printers with",
    "start": "2889839",
    "end": "2895599"
  },
  {
    "text": "null again the so I guess the overall the overlooking kind of theory behind this was how do we assess our",
    "start": "2895599",
    "end": "2902000"
  },
  {
    "text": "environment not everything in here is going to be how do we attack our environment cuz again at the end day we want to Safeguard our business assets",
    "start": "2902000",
    "end": "2908079"
  },
  {
    "text": "not figure out whose business habits we could you know steal or",
    "start": "2908079",
    "end": "2914160"
  },
  {
    "text": "compromise okay so Network information again here's a couple of null calls and",
    "start": "2918800",
    "end": "2925880"
  },
  {
    "text": "just for reference in Windows nt40 I think there was around 42 when 32 API",
    "start": "2925880",
    "end": "2932960"
  },
  {
    "text": "calls that you could call over null and in Windows 2000 some of those are",
    "start": "2932960",
    "end": "2938520"
  },
  {
    "text": "changed and there are some new ones kind of added in based on the pre- Windows 2000 compatible group so you know around",
    "start": "2938520",
    "end": "2945400"
  },
  {
    "text": "40 45 different functions we're obviously not going to go through all of those today Network station get info",
    "start": "2945400",
    "end": "2951079"
  },
  {
    "text": "Network station transport enum gives us information about the transports that",
    "start": "2951079",
    "end": "2957079"
  },
  {
    "text": "are running the the um you know if it's neoy net bios NW link things along those",
    "start": "2957079",
    "end": "2963599"
  },
  {
    "text": "information um I thought 41 okay there they are but okay we'll talk",
    "start": "2963599",
    "end": "2970520"
  },
  {
    "text": "about each of those later um not every single one of them but right so clearly the best practice here is install only",
    "start": "2970520",
    "end": "2977400"
  },
  {
    "text": "the necessary transports because if we discover information that there are you",
    "start": "2977400",
    "end": "2982640"
  },
  {
    "text": "know five six different transports running then all of a sudden we can start exploiting any inherent weaknesses",
    "start": "2982640",
    "end": "2989079"
  },
  {
    "text": "to those or you know you've now opened up more access points to your server",
    "start": "2989079",
    "end": "2994480"
  },
  {
    "text": "more access methods to your server and and clearly that's a path of attack and",
    "start": "2994480",
    "end": "3000040"
  },
  {
    "text": "therefore a place to secure the other piece I guess I would",
    "start": "3000040",
    "end": "3006040"
  },
  {
    "text": "add is that um you can figure out you know if it's n",
    "start": "3006040",
    "end": "3011720"
  },
  {
    "text": "or or or 2000 and you could also figure out what its minor number is which is what the Service Pack level is which is what You' get as null there's actually",
    "start": "3011720",
    "end": "3018480"
  },
  {
    "text": "other information though um that these calls give you if you're authenticated as administrator so",
    "start": "3018480",
    "end": "3025400"
  },
  {
    "text": "you can't determine domain m",
    "start": "3025400",
    "end": "3028640"
  },
  {
    "text": "membership if you're null um you cannot determine domain membership if you're n",
    "start": "3031359",
    "end": "3037720"
  },
  {
    "text": "is that is that true now I'm getting myself confused domain membership you",
    "start": "3037720",
    "end": "3042880"
  },
  {
    "text": "can no yeah I mean there's other ways around it there's other ways around it but this",
    "start": "3042880",
    "end": "3049799"
  },
  {
    "text": "the LSA we're actually going to use LSA query information policy throughout the presentation because again that's like",
    "start": "3049799",
    "end": "3055839"
  },
  {
    "text": "the get name security info it's used in many places that call along with get Nam security info needs more authentication",
    "start": "3055839",
    "end": "3063480"
  },
  {
    "text": "than null I believe it needs administrator or account operator right one of these things and I'll get to you in just a second one of the things about",
    "start": "3063480",
    "end": "3070280"
  },
  {
    "text": "most of these 132 API calls is that they will return a variety of data structures",
    "start": "3070280",
    "end": "3076160"
  },
  {
    "text": "to you there are when you call user information there's probably 35",
    "start": "3076160",
    "end": "3082319"
  },
  {
    "text": "different data structures that it will return to you based on the type of information that you request from it so",
    "start": "3082319",
    "end": "3088040"
  },
  {
    "text": "if you are null you may only be able to return say three or four pieces of",
    "start": "3088040",
    "end": "3093079"
  },
  {
    "text": "information like this is just a madeup example but like name phone number and",
    "start": "3093079",
    "end": "3099400"
  },
  {
    "text": "uh address then if you call it with different parameters you have maybe a slightly higher level of access it'll",
    "start": "3099400",
    "end": "3106440"
  },
  {
    "text": "return you a data structure with much more information so you may use one function at many levels of an attack or",
    "start": "3106440",
    "end": "3114640"
  },
  {
    "text": "an assessment first to say I'm at this level give me whatever information I can",
    "start": "3114640",
    "end": "3119799"
  },
  {
    "text": "get and then later you know now I want it with a user info 10 structure and",
    "start": "3119799",
    "end": "3125040"
  },
  {
    "text": "everything that comes with that so there's there's that kind of difference and okay your question now I just want",
    "start": "3125040",
    "end": "3132440"
  },
  {
    "text": "to know simp we did we did to to get uh the",
    "start": "3132440",
    "end": "3140200"
  },
  {
    "text": "question is and I'm going to add a little piece on to that do we have to run a query to get a listing of all the null required with 32 API calls we did",
    "start": "3140200",
    "end": "3148760"
  },
  {
    "text": "we did a query of um it's it's just called no special group memberships required which is equivalent to null",
    "start": "3148760",
    "end": "3155599"
  },
  {
    "text": "credentials logons right in the documentation for each of the calls as you can see up here",
    "start": "3155599",
    "end": "3161280"
  },
  {
    "text": "there's a security requirement section and under Windows nt40 you can search",
    "start": "3161280",
    "end": "3166640"
  },
  {
    "text": "for that no special group membership phrase on Windows 2000 you can search for the um pre- windows by default the",
    "start": "3166640",
    "end": "3174280"
  },
  {
    "text": "pre- Windows 2000 compatible access group and those are basically the two the two things that will come up with",
    "start": "3174280",
    "end": "3180480"
  },
  {
    "text": "this list of functions so you'll see that there's actually a lot of information and again",
    "start": "3180480",
    "end": "3185520"
  },
  {
    "text": "this is all like enticement information for hackers um it's not like it's going to give you a password it's going to",
    "start": "3185520",
    "end": "3191799"
  },
  {
    "text": "give you a lot of stuff that leads towards",
    "start": "3191799",
    "end": "3195359"
  },
  {
    "text": "that okay network security this is kind of there's two parts to this the first is to figure out",
    "start": "3197680",
    "end": "3204440"
  },
  {
    "text": "what are the trusting domains well can't hack a trusting domain and necessarily get a direct entry into the",
    "start": "3204440",
    "end": "3210960"
  },
  {
    "text": "trusted domain but you can with the vice versa so trusting to get the information about trusting domains is a little bit",
    "start": "3210960",
    "end": "3217920"
  },
  {
    "text": "easier you can use a null credentials log on with net user get info and figure",
    "start": "3217920",
    "end": "3225079"
  },
  {
    "text": "out if you do a filter on filter inter domain trust account it",
    "start": "3225079",
    "end": "3231520"
  },
  {
    "text": "tells you all the machine accounts that are members of the domains that are a",
    "start": "3231520",
    "end": "3237400"
  },
  {
    "text": "member of your domain so they are trusting so hackers will typically maybe",
    "start": "3237400",
    "end": "3242799"
  },
  {
    "text": "try to get access to this because they know that you're accessing information on those servers but the ones you really want to go after are the trusted because",
    "start": "3242799",
    "end": "3248640"
  },
  {
    "text": "if they're trusted and you break into them you can get access to this one because typically by default actually all the",
    "start": "3248640",
    "end": "3255520"
  },
  {
    "text": "time when you join the membership of another domain your domain admins get ads gets added to their domain admin so",
    "start": "3255520",
    "end": "3263040"
  },
  {
    "text": "right off the bat if you get access to one domain you get access to another that could be controlled a little bit by",
    "start": "3263040",
    "end": "3268920"
  },
  {
    "text": "of course removing domain admins from one domain so to do a trusted domain query",
    "start": "3268920",
    "end": "3274720"
  },
  {
    "text": "we go back to the LSA enumerate we go back to this is actually a new one LSA enumerated trusted domains LSA enumerate",
    "start": "3274720",
    "end": "3281559"
  },
  {
    "text": "trusted domains and this gives you the information of who do I",
    "start": "3281559",
    "end": "3287440"
  },
  {
    "text": "trust and of course the best practice is to only trust domains that have at least as good of security as you do that run",
    "start": "3287440",
    "end": "3292960"
  },
  {
    "text": "user level or I think that requires administrators and account operators but I could tell",
    "start": "3292960",
    "end": "3298680"
  },
  {
    "text": "you that right now do",
    "start": "3298680",
    "end": "3302720"
  },
  {
    "text": "you this requires doesn't tell us in the SDK",
    "start": "3306359",
    "end": "3313720"
  },
  {
    "text": "which means typically it requires administrators or account",
    "start": "3313720",
    "end": "3318680"
  },
  {
    "text": "operators this is one of those areas where hackers typically go through the SDK and figure out well it doesn't",
    "start": "3319799",
    "end": "3325640"
  },
  {
    "text": "actually say what's going on it's actually a lot of calls um there's one we're going to mention later which has",
    "start": "3325640",
    "end": "3331400"
  },
  {
    "text": "kind of not been overly publicized but things like this is when the hackers go out and write the call and just keep",
    "start": "3331400",
    "end": "3338039"
  },
  {
    "text": "exceed you know keep adding one level of authority to their to their listing",
    "start": "3338039",
    "end": "3343920"
  },
  {
    "text": "so they try at the guest level they try it at the null level they try it at the user level they try administrator and and sometimes the SDK has no information",
    "start": "3343920",
    "end": "3351280"
  },
  {
    "text": "on it and then hackers figure out well here's one area we can exploit so I actually don't have a positive answer",
    "start": "3351280",
    "end": "3356880"
  },
  {
    "text": "for a but yes um the last piece is auditing",
    "start": "3356880",
    "end": "3365520"
  },
  {
    "text": "security the audit piece for pharmaceuticals company again they are",
    "start": "3365520",
    "end": "3371480"
  },
  {
    "text": "concerned about availability so they want to see our user accounts maybe being brood Force attack to be locked out or something along those lines so in",
    "start": "3371480",
    "end": "3378520"
  },
  {
    "text": "terms of auditing they're concerned about are there bad log on attempts are there accounts being locked out are",
    "start": "3378520",
    "end": "3386000"
  },
  {
    "text": "there object access failures and that's what the event logs down there are saying which are 529 53 529 is um I",
    "start": "3386000",
    "end": "3396400"
  },
  {
    "text": "don't want to go through all these but 529 is was the account did it have a bad password attempted 539 was it locked out",
    "start": "3396400",
    "end": "3403839"
  },
  {
    "text": "uh 612 is was there an object access failure and the other piece is the event log we need our event log to be large",
    "start": "3403839",
    "end": "3410599"
  },
  {
    "text": "enough to be able to retain this type of information so typically 60,000 users um",
    "start": "3410599",
    "end": "3415839"
  },
  {
    "text": "this information is going to be on each domain controller though so each domain controller has to have this level of information so it's important that the",
    "start": "3415839",
    "end": "3421720"
  },
  {
    "text": "event logs on each domain controller so there were two dozen at this Pharmaceuticals company had 15 megabytes",
    "start": "3421720",
    "end": "3427880"
  },
  {
    "text": "set to 14 days one of the best practices though we said though 14 days might not be enough you want to figure out how",
    "start": "3427880",
    "end": "3433920"
  },
  {
    "text": "quickly is that 15 megabytes being filled so you set it to 15 megabytes and then kind of forever find out what",
    "start": "3433920",
    "end": "3439960"
  },
  {
    "text": "happens and then if it's like a 23-day period you want to set it to 23 days make sure your backups do to uh a backup",
    "start": "3439960",
    "end": "3447880"
  },
  {
    "text": "of that event log so you always have that information any questions on case number",
    "start": "3447880",
    "end": "3455200"
  },
  {
    "text": "one and I guess I'll just add uh you need to be a member of the you have to",
    "start": "3455200",
    "end": "3461160"
  },
  {
    "text": "have the user right manage oh what is it manage security and event log to",
    "start": "3461160",
    "end": "3468640"
  },
  {
    "text": "perform the read event log call so by default the only people who have that",
    "start": "3468640",
    "end": "3473799"
  },
  {
    "text": "are administrators what we typically see for practices is you add a group to your domain called Auditors because really I",
    "start": "3473799",
    "end": "3481480"
  },
  {
    "text": "mean yes your administrators are the most trusted people in your organization but sometimes is nice to have that segregation of",
    "start": "3481480",
    "end": "3487760"
  },
  {
    "text": "Duties a lot of clients come back to us and say yeah that's a fantastic idea if you have you know $200,000 to implement",
    "start": "3487760",
    "end": "3493119"
  },
  {
    "text": "that type of thing for us we would you know that'd be great thanks case two is Yellow Page",
    "start": "3493119",
    "end": "3501680"
  },
  {
    "text": "Publishing Company um largest one in the world uh maybe data warehouse is",
    "start": "3501680",
    "end": "3507559"
  },
  {
    "text": "extremely important to them because they have a lot of customers coming in updating graphic files you know they're constantly coming in you know they're",
    "start": "3507559",
    "end": "3513920"
  },
  {
    "text": "content management is is is extremely important to these guys so they have 100,000 customers account information",
    "start": "3513920",
    "end": "3519520"
  },
  {
    "text": "and data again it's it's things like the text it's the it's the graphic images so",
    "start": "3519520",
    "end": "3524559"
  },
  {
    "text": "they have over 100 file servers for all these people very large file servers and what they are extremely concerned about",
    "start": "3524559",
    "end": "3530000"
  },
  {
    "text": "is confidentiality can Mr Pizza get access to Pizzeria Uno's you know",
    "start": "3530000",
    "end": "3536119"
  },
  {
    "text": "advertising information before it's released so that we can kind of one up them you know make our ad one bigger one more colorful whatever it is",
    "start": "3536119",
    "end": "3544319"
  },
  {
    "text": "um integrity and availability not the biggest concern because everything gets qced at the end so again customers",
    "start": "3544319",
    "end": "3550880"
  },
  {
    "text": "advertisements are competitive advantage in this environment and they also need access to",
    "start": "3550880",
    "end": "3556400"
  },
  {
    "text": "their data 24 by7 which is kind of like their secondary concern of availability so they're going to do a",
    "start": "3556400",
    "end": "3563000"
  },
  {
    "text": "primary assessment and say well we want to see if our asset are secured so what are we going to do we're going to look",
    "start": "3563000",
    "end": "3568520"
  },
  {
    "text": "at the file server directory access controls and see if they're appropriate you know can is is a share set so",
    "start": "3568520",
    "end": "3574720"
  },
  {
    "text": "everyone has full control can agents so the agents are the people who come in and update graphic",
    "start": "3574720",
    "end": "3580440"
  },
  {
    "text": "files can they update only their authorized companies data or can they actually go outside their boundaries is",
    "start": "3580440",
    "end": "3586000"
  },
  {
    "text": "there going to be unauthorized reading of other companies information and are raw data files accessible by anyone",
    "start": "3586000",
    "end": "3592240"
  },
  {
    "text": "because let's take um so the way they had their content management setup was was yes graphic files get uploaded but",
    "start": "3592240",
    "end": "3598119"
  },
  {
    "text": "then like there was like this major database so graphic files were then put into another database so to make it a",
    "start": "3598119",
    "end": "3604160"
  },
  {
    "text": "little bit more simple we take something like like like exchange exchange 2000 you can",
    "start": "3604160",
    "end": "3612240"
  },
  {
    "text": "get access by accessing someone's email account and then going into their folders and reading their information or",
    "start": "3612240",
    "end": "3619039"
  },
  {
    "text": "you could attempt to get access to the one big raw data file I think it's an MDB um does anyone know if anyone knows",
    "start": "3619039",
    "end": "3625640"
  },
  {
    "text": "this shouted out but what's that 2 it's oh it's all in active directory in 2000 so bad example for this but in exchange",
    "start": "3625640",
    "end": "3632480"
  },
  {
    "text": "for Windows NT so do you guys kind of understand so the raw data file is going to be that other way of getting access",
    "start": "3632480",
    "end": "3638839"
  },
  {
    "text": "to information so they want to make sure those are also tied",
    "start": "3638839",
    "end": "3644440"
  },
  {
    "text": "down okay so first thing we're going to look at is who has rights and privileges to do different things Todd mentioned at",
    "start": "3644680",
    "end": "3651520"
  },
  {
    "text": "the end of the last slide that you need the manage auditing and security logs in order to read the event log but of",
    "start": "3651520",
    "end": "3657160"
  },
  {
    "text": "course there are plenty of other user rights that are very important and here",
    "start": "3657160",
    "end": "3662640"
  },
  {
    "text": "we use LSA numerate accounts with user rights um this is kind of the one area",
    "start": "3662640",
    "end": "3668359"
  },
  {
    "text": "in Windows NT that's a little different than the rest in that you assign accounts to user rights rather than",
    "start": "3668359",
    "end": "3674960"
  },
  {
    "text": "assigning user rights to accounts so we would look at something like take ownership of files and see who has that",
    "start": "3674960",
    "end": "3682000"
  },
  {
    "text": "right clearly anybody who has that right it doesn't matter what the ACC control list on the object is they can take",
    "start": "3682000",
    "end": "3687760"
  },
  {
    "text": "ownership of it and then change the access control list and now they have access to the object in backup files and",
    "start": "3687760",
    "end": "3693760"
  },
  {
    "text": "restore files and directories the point of those is so backup programs can read every file on",
    "start": "3693760",
    "end": "3699839"
  },
  {
    "text": "the system and restore programs can overwrite any file when you're doing a restore so anyone with those rights",
    "start": "3699839",
    "end": "3706400"
  },
  {
    "text": "inherently bypasses the access control lists on any of the files so you were",
    "start": "3706400",
    "end": "3712400"
  },
  {
    "text": "there was yeah I was actually G to jump in with another 132 API call which is you know like if you want to um if if",
    "start": "3712400",
    "end": "3718480"
  },
  {
    "text": "you want to copy a file or move a file or write to a file you know like the copy. ex you know copy is a win32 API",
    "start": "3718480",
    "end": "3725920"
  },
  {
    "text": "call and there are ways to call these functions you say I'm going to call it",
    "start": "3725920",
    "end": "3731200"
  },
  {
    "text": "in regular mode well there's actually an extra Mode called backup mode so you could do anything to these files so if",
    "start": "3731200",
    "end": "3736240"
  },
  {
    "text": "you rewrote one of these copy programs which is very easy to do and to say instead of calling it with normal mode",
    "start": "3736240",
    "end": "3742119"
  },
  {
    "text": "call it with backup mode what it says is if you have this user right backup files and directories we're going to ignore",
    "start": "3742119",
    "end": "3748680"
  },
  {
    "text": "the ACL on the object and allow you to read it uh that's correct read it if you",
    "start": "3748680",
    "end": "3755319"
  },
  {
    "text": "have restore files and directories we're going to ignore the ACL on the object and let you do anything you want to it",
    "start": "3755319",
    "end": "3762400"
  },
  {
    "text": "so these these user rights are extremely um powerful to a user that might have",
    "start": "3762400",
    "end": "3768520"
  },
  {
    "text": "them that that really shouldn't so typically we only see backup operators getting them and administrators because",
    "start": "3768520",
    "end": "3774760"
  },
  {
    "text": "one of the things we learned was we we used to say you know typical Consultants going in and saying well backup",
    "start": "3774760",
    "end": "3780760"
  },
  {
    "text": "operators should be the only ones who have this again that segregation of Duties things it's actually not quite the case because administrators are the",
    "start": "3780760",
    "end": "3786559"
  },
  {
    "text": "ones who need to perform the emergency repair disc functions because an emergency repair disc gives you access",
    "start": "3786559",
    "end": "3793079"
  },
  {
    "text": "to the Sam like an nt40 would actually copy certain Sam information like users",
    "start": "3793079",
    "end": "3800079"
  },
  {
    "text": "passwords well you can't actually do an emergency repair disc unless you have those two user rights so now we see you",
    "start": "3800079",
    "end": "3808119"
  },
  {
    "text": "you know backup operators and administrators having those two user",
    "start": "3808119",
    "end": "3812799"
  },
  {
    "text": "rights and continuing on with the other ones debug programs would allow someone to modify the way an executable reacts",
    "start": "3813440",
    "end": "3820400"
  },
  {
    "text": "we saw um saw one attack and penetration where people trying to access the event",
    "start": "3820400",
    "end": "3825880"
  },
  {
    "text": "log now this is this is the great thing about you know hackers they argue back and forth back and forth they say well I",
    "start": "3825880",
    "end": "3832240"
  },
  {
    "text": "can't get caught because you know I'm going to uh Delete the audit log when I'm done well then the next hacker says yeah but when you delete the event log I",
    "start": "3832240",
    "end": "3838480"
  },
  {
    "text": "want to figure out what user you were using because it's going to say well so and so deleted the event log is entry number one turns out you know if you",
    "start": "3838480",
    "end": "3844200"
  },
  {
    "text": "have something like debug programs or act as part of the operating system you can do anything you want regardless of what the guey is saying so we've",
    "start": "3844200",
    "end": "3850680"
  },
  {
    "text": "actually seen people write executable programs that go in and modify the event log and say well delete it and don't put",
    "start": "3850680",
    "end": "3857440"
  },
  {
    "text": "this entry in it or delete just one entry of it and I mean very dangerous",
    "start": "3857440",
    "end": "3862920"
  },
  {
    "text": "especially you know in forensics jobs when someone breaks in taking it to the next level and saying well how am I going to prosecute this individual you",
    "start": "3862920",
    "end": "3869760"
  },
  {
    "text": "know flers simply state that the you know this is the state of the way things are it becomes almost inmal and you know",
    "start": "3869760",
    "end": "3876760"
  },
  {
    "text": "people kind of ignore it so it's very important to make sure that people don't have debug programs act as part of the",
    "start": "3876760",
    "end": "3881920"
  },
  {
    "text": "operating system and one of our favorite ones is replace a replace a process level token using 132 API calls you",
    "start": "3881920",
    "end": "3888400"
  },
  {
    "text": "could replace it's actually what they do is they take an object like the uh system",
    "start": "3888400",
    "end": "3895200"
  },
  {
    "text": "PID which is uh actually I forgot it now but if you open up your task manager and you take a look at what system is",
    "start": "3895200",
    "end": "3900559"
  },
  {
    "text": "running at or what lsass.exe is running at something like 14 you could say well",
    "start": "3900559",
    "end": "3905640"
  },
  {
    "text": "take that token which LS is running at PID 14 process ID spawn another copy of",
    "start": "3905640",
    "end": "3911440"
  },
  {
    "text": "that token run my executable is that now what you're doing is you're running an executable as system so one of the one",
    "start": "3911440",
    "end": "3919680"
  },
  {
    "text": "of the things we've done is you know like if you open up the registry and try to get access to the Sam key and read information in there kind of doesn't let",
    "start": "3919680",
    "end": "3925960"
  },
  {
    "text": "you do that well you can open up Red Ed regedit.exe using this 132 API call",
    "start": "3925960",
    "end": "3931760"
  },
  {
    "text": "replacing a process level token of lsass.exe and run reg it like that now",
    "start": "3931760",
    "end": "3936880"
  },
  {
    "text": "you can access anything in the registry because it's running a system so very very powerful user rights",
    "start": "3936880",
    "end": "3943920"
  },
  {
    "text": "no one should have them if you're really worried about confidentiality of information or any of the security",
    "start": "3943920",
    "end": "3949000"
  },
  {
    "text": "assertions really no one should have those except for um you know we've seen people argue administrators should have",
    "start": "3949000",
    "end": "3954279"
  },
  {
    "text": "them because they're fully trusted anyway by default they don't even have",
    "start": "3954279",
    "end": "3959920"
  },
  {
    "text": "replaceable POS level token or act as part of the operating system so we would say leave them",
    "start": "3959920",
    "end": "3965000"
  },
  {
    "text": "out okay um here we are the first thing we're saying is retrieve permissions for directories uh again this is a place",
    "start": "3965680",
    "end": "3972839"
  },
  {
    "text": "that we would use get Nam security info that we talked about earlier we'd probably be calling it twice in this",
    "start": "3972839",
    "end": "3978319"
  },
  {
    "text": "function we call it once to get the daal read the aces find out who has access to",
    "start": "3978319",
    "end": "3983720"
  },
  {
    "text": "it we call it again to get the sackle find find out the audit settings find out the owner um depending on the way the system set",
    "start": "3983720",
    "end": "3990839"
  },
  {
    "text": "up you know that that information could be very critical to us if it's a critical file and the ACL you know is",
    "start": "3990839",
    "end": "3997079"
  },
  {
    "text": "loose on it but there's auditing that might not be something we want to go after if it's got uh no auditing on that",
    "start": "3997079",
    "end": "4003640"
  },
  {
    "text": "file and it's something that's pretty sensitive maybe we feel like we could poke away at it for a while so that's",
    "start": "4003640",
    "end": "4010440"
  },
  {
    "text": "you know that's the first and then we mentioned here authenticated users should have read as kind of a best practice and that was mentioned earlier",
    "start": "4010440",
    "end": "4016760"
  },
  {
    "text": "as something that is a step people are already taking and to tie back into the",
    "start": "4016760",
    "end": "4023000"
  },
  {
    "text": "security configuration manager uh statement in question earlier how good is applying those default templates well",
    "start": "4023000",
    "end": "4030960"
  },
  {
    "text": "Microsoft doesn't know about your applications it doesn't know what you've put on your systems it knows about the",
    "start": "4030960",
    "end": "4037200"
  },
  {
    "text": "operating system so that's all it can secure so one of the places that you have to be concerned with is your data",
    "start": "4037200",
    "end": "4043440"
  },
  {
    "text": "directories your application directories anything that's homegrown where does it write to the registry we got to care",
    "start": "4043440",
    "end": "4049480"
  },
  {
    "text": "about those keys and those are objects that you may want to add to the template those are objects that you may want to",
    "start": "4049480",
    "end": "4055559"
  },
  {
    "text": "secure in other manners but this is this is how you go about collecting that",
    "start": "4055559",
    "end": "4061200"
  },
  {
    "text": "information I guess for the software developers out there or for people looking to you know to go after programs one of the things that you know like we",
    "start": "4061200",
    "end": "4067200"
  },
  {
    "text": "thought was important for for you know technologists trying to secure their boxes was this is a very timec consuming",
    "start": "4067200",
    "end": "4073680"
  },
  {
    "text": "operation typically people would run something like dump ACL or you know a program that just kind of dumps out everything look for programs or the",
    "start": "4073680",
    "end": "4080000"
  },
  {
    "text": "software developers you can probe a registry key and find out what the system directories using that you can",
    "start": "4080000",
    "end": "4085279"
  },
  {
    "text": "kind of um append on the secured system directories like SLC config Etc and then",
    "start": "4085279",
    "end": "4090920"
  },
  {
    "text": "run kind of a listing off of that or you can um if you're going to do if you have",
    "start": "4090920",
    "end": "4097359"
  },
  {
    "text": "a web server that has not you know it's using the IIs metabase go into the metabase and find out what are the",
    "start": "4097359",
    "end": "4103400"
  },
  {
    "text": "directories that exist on the computer for this website is it CC Comack Pub or",
    "start": "4103400",
    "end": "4109238"
  },
  {
    "text": "typically it's something different and then have your program run after that don't I mean it's a very manually labor int it's very labor intensive this is",
    "start": "4109239",
    "end": "4115798"
  },
  {
    "text": "not something clients typically um enjoy doing out of all",
    "start": "4115799",
    "end": "4123440"
  },
  {
    "text": "your how much of this information or how much information that we're Gathering",
    "start": "4126839",
    "end": "4132920"
  },
  {
    "text": "today right um the information so from the program that",
    "start": "4133600",
    "end": "4138679"
  },
  {
    "text": "we ran to the front and all the information that we've talked about Gathering most of that does not reside within the active directory file",
    "start": "4138679",
    "end": "4145000"
  },
  {
    "text": "permissions registry permissions and values that information still exists in the same place that it existed in nt4",
    "start": "4145000",
    "end": "4152318"
  },
  {
    "text": "information that's moving into the active directory now we have all the users live there all the groups live",
    "start": "4152319",
    "end": "4157600"
  },
  {
    "text": "there their properties organizational units other securable objects along",
    "start": "4157600",
    "end": "4162719"
  },
  {
    "text": "those lines so those are the types of information now you would want to call out of out of the active directory using",
    "start": "4162719",
    "end": "4169560"
  },
  {
    "text": "you know I ads and things along those lines and we actually don't have that covered in this presentation but",
    "start": "4169560",
    "end": "4176080"
  },
  {
    "text": "afterwards we can definitely talk about that so yes how you looking",
    "start": "4176080",
    "end": "4182679"
  },
  {
    "text": "up um the question was how do we look up a sid of a user through an N",
    "start": "4184120",
    "end": "4190199"
  },
  {
    "text": "session from Windows 2000 um",
    "start": "4190199",
    "end": "4196319"
  },
  {
    "text": "if Windows would it be uh you're talking about Native mode only or you're talking about mixed mode as",
    "start": "4202719",
    "end": "4209560"
  },
  {
    "text": "well do do well from the perspective we're looking at here again is kind of a",
    "start": "4210480",
    "end": "4215840"
  },
  {
    "text": "securing your business assets so you're already an admin and that's the methodology that we've been following",
    "start": "4215840",
    "end": "4221560"
  },
  {
    "text": "along so I really haven't tried to do what what you're asking yeah that's a stumper you got us it's good we could",
    "start": "4221560",
    "end": "4229159"
  },
  {
    "text": "brainstorm afterwards so H that's that's a good little challenge",
    "start": "4229159",
    "end": "4234640"
  },
  {
    "text": "I want to try that later I guess um so now we're like one and a half cases through this so you're going to start to",
    "start": "4234640",
    "end": "4240199"
  },
  {
    "text": "see a little things being similar so it's going to we're going to kind of pick up the speed a little bit but what we're talking about here is net schedule",
    "start": "4240199",
    "end": "4246600"
  },
  {
    "text": "jobs enum we want to find out what jobs are running on the box doing this API call you figure out well what's the",
    "start": "4246600",
    "end": "4252040"
  },
  {
    "text": "executable that's running because you want to figure out what the permissions on the executable art that no one can replace that executable you also want to",
    "start": "4252040",
    "end": "4257480"
  },
  {
    "text": "find out what it's running as you know is it going to be running as system very important best practice ensure that",
    "start": "4257480",
    "end": "4262520"
  },
  {
    "text": "files are executed as batches files executed as batches are protected with strong ACLS again very important because",
    "start": "4262520",
    "end": "4268600"
  },
  {
    "text": "if you schedule a job to run as system and it's you know it's it's a backup program well someone can replace with",
    "start": "4268600",
    "end": "4273800"
  },
  {
    "text": "their trojan horse that says well don't do the backup just uh P you know do a dump of the password hashes right this goes back to something",
    "start": "4273800",
    "end": "4280800"
  },
  {
    "text": "we were talking about earlier again you may be able to read a registry value say",
    "start": "4280800",
    "end": "4285840"
  },
  {
    "text": "you know there's a sub authentication dll like pass. dll in there you can't necessarily change the value of that",
    "start": "4285840",
    "end": "4292320"
  },
  {
    "text": "registry key but if you can somehow get access to the file system you replace pass. dll and now you know the system's",
    "start": "4292320",
    "end": "4300639"
  },
  {
    "text": "running and you've got clear text access to passwords so that information leads you to the",
    "start": "4300639",
    "end": "4307440"
  },
  {
    "text": "other which is why from a an assessment standpoint you need to look at what the registry value is what's that pointing",
    "start": "4307440",
    "end": "4312719"
  },
  {
    "text": "to and then go to that object and make sure that object is secure okay so now we got a fun one cuz we're on the network security piece so we're talking",
    "start": "4312719",
    "end": "4318800"
  },
  {
    "text": "about Network shares so again by default uh the null users will be able to access uh not access but probe and get a",
    "start": "4318800",
    "end": "4325320"
  },
  {
    "text": "listing of all the shares you also remember we talked about earlier get a listing of all the users so the first thing you want to do is try to connect",
    "start": "4325320",
    "end": "4331320"
  },
  {
    "text": "to all the shares you've gotten as null and see what access you can get if you can't get any well now you have a whole list of other users you could start",
    "start": "4331320",
    "end": "4337360"
  },
  {
    "text": "trying and there's actually it's interesting because we started seeing that you know if you try to log onto a",
    "start": "4337360",
    "end": "4343719"
  },
  {
    "text": "box as a user people were looking for the you know uh bad bad account password",
    "start": "4343719",
    "end": "4350199"
  },
  {
    "text": "in the event log so people were getting caught very easily hackers were were found to be caught because they're",
    "start": "4350199",
    "end": "4355280"
  },
  {
    "text": "trying you know the the 20 most easiest passwords like password training welcome whatever and they were getting caught so",
    "start": "4355280",
    "end": "4361280"
  },
  {
    "text": "what what hackers started doing was using an API call um which is kind of related to this with the shares but they",
    "start": "4361280",
    "end": "4366560"
  },
  {
    "text": "were actually saying well let me try to change that user's password from what I think it is to what I think it is",
    "start": "4366560",
    "end": "4372440"
  },
  {
    "text": "because what that says is I'm going to either get back uh success returned or I'm going to get an error returned and",
    "start": "4372440",
    "end": "4379000"
  },
  {
    "text": "if I get a success well I know his password is that so now I figured out a way to Brute Force attack and accounts",
    "start": "4379000",
    "end": "4384480"
  },
  {
    "text": "password extremely quickly and there's no Trace in the event log",
    "start": "4384480",
    "end": "4389639"
  },
  {
    "text": "of invalid password what it pops up in the event log is object access",
    "start": "4389639",
    "end": "4397040"
  },
  {
    "text": "failure no questions so again going after the shares now we're going to be trying to Brute Force attack these shares typically you know",
    "start": "4397040",
    "end": "4405360"
  },
  {
    "text": "there's going to be one hopefully out there you can get access to and find out what information is on the box we always see that we always see someone had some",
    "start": "4405360",
    "end": "4412040"
  },
  {
    "text": "directory out there typically maybe it's you know a Napster directory because people have MP3 files they're sharing with other people well sometimes you can",
    "start": "4412040",
    "end": "4418360"
  },
  {
    "text": "actually get other information in those directories people just have pooling of information so you get company",
    "start": "4418360",
    "end": "4423679"
  },
  {
    "text": "information you get information about the user you get something maybe that's led to their password and you try to",
    "start": "4423679",
    "end": "4428800"
  },
  {
    "text": "break in with that so best practice is to take those share permissions first of all never use the default everyone full",
    "start": "4428800",
    "end": "4435440"
  },
  {
    "text": "control rather make those permissions you know as secure as the",
    "start": "4435440",
    "end": "4440880"
  },
  {
    "text": "NTFS permissions behind them so if people don't need right access just say you know users read or you know if it's",
    "start": "4440880",
    "end": "4449520"
  },
  {
    "text": "the marketing department marketing read question um respect to as and",
    "start": "4449520",
    "end": "4456520"
  },
  {
    "text": "shares isn't it true that NTFS",
    "start": "4456520",
    "end": "4463040"
  },
  {
    "text": "permissions will do it take precedence okay because you can have it's the more",
    "start": "4463040",
    "end": "4468320"
  },
  {
    "text": "restrictive of the two right it's like the intersection I mean it's a great question so the question just to repeat",
    "start": "4468320",
    "end": "4473880"
  },
  {
    "text": "it for you guys is you know share permissions and TFS permissions it's two layers what does NT or Windows 2000",
    "start": "4473880",
    "end": "4480040"
  },
  {
    "text": "consider them as the accurate ones the more restrictive of the two right and",
    "start": "4480040",
    "end": "4485360"
  },
  {
    "text": "just before I'll call in you a second the reason a lot of clients just create the share and say well we have NTFS",
    "start": "4485360",
    "end": "4490440"
  },
  {
    "text": "permissions and again that leads to information gathering it's much better to if someone clicks on the share to get",
    "start": "4490440",
    "end": "4496600"
  },
  {
    "text": "an access denied then let them open up the share see all the files in it and then try to access those files and get",
    "start": "4496600",
    "end": "4502400"
  },
  {
    "text": "their access denied because now you know they potentially have access to any of those files or at least they have more",
    "start": "4502400",
    "end": "4508440"
  },
  {
    "text": "information to go with",
    "start": "4508440",
    "end": "4511960"
  },
  {
    "text": "[Music] yes okay yes they did um I",
    "start": "4515590",
    "end": "4522520"
  },
  {
    "text": "mean it here's the difference so in nt4 and anyone correct me if I'm wrong",
    "start": "4522520",
    "end": "4528560"
  },
  {
    "text": "it's been a while since I've looked at it but I think it was like full control read write execute delete change",
    "start": "4528560",
    "end": "4534280"
  },
  {
    "text": "permissions and take ownership those were like the six thing no I missed them right since service four with",
    "start": "4534280",
    "end": "4541840"
  },
  {
    "text": "security configuration manager once you did that add-on it changed the way acl's work on nt4 and that was kind of a",
    "start": "4541840",
    "end": "4548960"
  },
  {
    "text": "backport of the 2000 technology so in addition to more granularity there's Alo",
    "start": "4548960",
    "end": "4555199"
  },
  {
    "text": "the concept of deny which never existed in nt4 it was always just allow or don't",
    "start": "4555199",
    "end": "4560440"
  },
  {
    "text": "include the person now you can you know say where there used to be six or seven",
    "start": "4560440",
    "end": "4565679"
  },
  {
    "text": "permissions now maybe there's 14 and you have an allow and a deny and that's",
    "start": "4565679",
    "end": "4571199"
  },
  {
    "text": "that's been around for a little",
    "start": "4571199",
    "end": "4574199"
  },
  {
    "text": "while no that's right the guey yeah we right like for example if you went",
    "start": "4580520",
    "end": "4586040"
  },
  {
    "text": "through the guey to set permissions on a share you get you know full control change read and write but if you go",
    "start": "4586040",
    "end": "4593040"
  },
  {
    "text": "through the win32 API you could set whatever permissions you want on a share you could set them to be exactly the",
    "start": "4593040",
    "end": "4598239"
  },
  {
    "text": "same as the NTFS level yes didn't we see some things being returned differently",
    "start": "4598239",
    "end": "4603679"
  },
  {
    "text": "though before Service Pack 4 was installed I was doing things in yeah the problem",
    "start": "4603679",
    "end": "4610400"
  },
  {
    "text": "was and didn't they remove synchronize or no no okay right the the",
    "start": "4610920",
    "end": "4617920"
  },
  {
    "text": "point that was just made was if you use the you know if you use Windows 2000 to",
    "start": "4617920",
    "end": "4623239"
  },
  {
    "text": "set permissions on nt4 and then go look at them in nt4 it will report back that",
    "start": "4623239",
    "end": "4628360"
  },
  {
    "text": "this was created with a newer version do you want to click o click okay to delete",
    "start": "4628360",
    "end": "4634000"
  },
  {
    "text": "the ACL on this object or click cancel to leave it and you just can't do anything with it from this Os or from",
    "start": "4634000",
    "end": "4641280"
  },
  {
    "text": "this guey the other thing I want to add kind of talking a little bit earlier your point about that allowed paths",
    "start": "4641280",
    "end": "4646400"
  },
  {
    "text": "remember we talked about the registry we're saying well the allowed paths you can't query it you know you have to kind of assume things net share enums is a",
    "start": "4646400",
    "end": "4653679"
  },
  {
    "text": "that type of attack is kind of similar because net share enum will return to you a listing of all the shares but it",
    "start": "4653679",
    "end": "4660800"
  },
  {
    "text": "gives you an error for listing of the permissions on those shares so what you have to do is you have to kind of say",
    "start": "4660800",
    "end": "4667480"
  },
  {
    "text": "well it's same kind of thing with a lot of Pez we know it exists now we just have to kind of try it so what we typically see is people trying again",
    "start": "4667480",
    "end": "4673600"
  },
  {
    "text": "that uh that that Brute Force attack does everyone have full control there's no way to find out until you do it so",
    "start": "4673600",
    "end": "4679840"
  },
  {
    "text": "net share enum yes it's no um it only returns half the information it won't",
    "start": "4679840",
    "end": "4685560"
  },
  {
    "text": "give you permissions on shares lastly",
    "start": "4685560",
    "end": "4691760"
  },
  {
    "text": "auditing um what these guys were most concerned about was is someone trying to",
    "start": "4691760",
    "end": "4697080"
  },
  {
    "text": "get access to other people's files so they wanted to set up sackless or what's called system Access Control lists on",
    "start": "4697080",
    "end": "4703719"
  },
  {
    "text": "the files to see and and they were checking for people doing failures because they didn't have access so we're checking to see if people were trying um",
    "start": "4703719",
    "end": "4711000"
  },
  {
    "text": "and it's a it's it's the get name security info which we talked about and again best practice it's going to depend",
    "start": "4711000",
    "end": "4718120"
  },
  {
    "text": "on if you have a help desk and how often you can check your event logs but you know you want to set them on the",
    "start": "4718120",
    "end": "4723480"
  },
  {
    "text": "sensitive directories and uh to the best of your knowledge review that on a periodic basis I mean to the best of",
    "start": "4723480",
    "end": "4729960"
  },
  {
    "text": "your ability review that on a periodic basis",
    "start": "4729960",
    "end": "4734440"
  },
  {
    "text": "what's that yeah case three kind of like an ER trade",
    "start": "4735560",
    "end": "4743280"
  },
  {
    "text": "it's not eade um Securities trading company has a website people coming on doing transactions primary concern",
    "start": "4743280",
    "end": "4749760"
  },
  {
    "text": "Integrity of people's investment portfolios so why they doing a security assessment transaction have to be",
    "start": "4749760",
    "end": "4755120"
  },
  {
    "text": "accurate timely and complete they want to make sure all these things are being met and also of non-repudiation which is",
    "start": "4755120",
    "end": "4760320"
  },
  {
    "text": "to prevent people from denying something that they might have done so if they say that you know if if they if we think",
    "start": "4760320",
    "end": "4765520"
  },
  {
    "text": "they bought Microsoft in the morning we want to make sure that they actually can't deny the fact that they",
    "start": "4765520",
    "end": "4771719"
  },
  {
    "text": "didn't primary assessment to ensure no one can modify data on the machines Services can't be exploited um and and",
    "start": "4771719",
    "end": "4779000"
  },
  {
    "text": "and lastly some type of Brute Force attack won't go undetected okay so the the first thing",
    "start": "4779000",
    "end": "4786400"
  },
  {
    "text": "we're we're looking at here is what's the account policy so we want to find out how long can people use their",
    "start": "4786400",
    "end": "4793080"
  },
  {
    "text": "passwords for what's the minimum password word length and what's the account lockout policy um if I right",
    "start": "4793080",
    "end": "4800480"
  },
  {
    "text": "before I start a Brute Force attack if I can find out the account policy I can customize my code to try four attempts",
    "start": "4800480",
    "end": "4807760"
  },
  {
    "text": "wait 60 minutes try four attempts and that way I'm not going to create an account locked out especially if lock",
    "start": "4807760",
    "end": "4813199"
  },
  {
    "text": "out is set to forever so using net user models get which is a null you can",
    "start": "4813199",
    "end": "4819199"
  },
  {
    "text": "retrieve information about the entire account policy and the account lockout I'm just curious who here kind of knew",
    "start": "4819199",
    "end": "4826280"
  },
  {
    "text": "that you could with a null attack grab account lockout information and password",
    "start": "4826280",
    "end": "4832800"
  },
  {
    "text": "restrictions it's not very well publicized the reason for that is the SDK specifically States typically it's",
    "start": "4832800",
    "end": "4841080"
  },
  {
    "text": "the exact wording what is this net user modals get right like a tool like dump ACL used to get the account policy but",
    "start": "4841080",
    "end": "4848280"
  },
  {
    "text": "it wouldn't get the account lock out so it says typically authenticated users are required to make this call",
    "start": "4848280",
    "end": "4854840"
  },
  {
    "text": "well no you can so that's why there haven't been a lot of hacks around this",
    "start": "4854840",
    "end": "4862480"
  },
  {
    "text": "and this is great because first thing you want to do when you walk up to a box is connect with null hopefully restrict",
    "start": "4862480",
    "end": "4868120"
  },
  {
    "text": "Anonymous is going to let you get this information and probe the box and figure out what the account lockout is and now",
    "start": "4868120",
    "end": "4873400"
  },
  {
    "text": "you can figure out well how often can I try a password hopefully I could try more than before they re you know reset",
    "start": "4873400",
    "end": "4879000"
  },
  {
    "text": "it and break in hopefully I'll get lucky with one of them",
    "start": "4879000",
    "end": "4884760"
  },
  {
    "text": "okay um password hashes you're probably all familiar with PW dump PW dump 2 um",
    "start": "4885960",
    "end": "4893480"
  },
  {
    "text": "programs like that that basically read from memory from the registry or from a",
    "start": "4893480",
    "end": "4898520"
  },
  {
    "text": "text file registry on the system and give you a list of passwords which you could then dump into something like Loft",
    "start": "4898520",
    "end": "4905000"
  },
  {
    "text": "crack these are clearly not functions that you could run null um they require",
    "start": "4905000",
    "end": "4910960"
  },
  {
    "text": "a lot of them require some fancy techniques dll injection and thing like that to run as system in order to get",
    "start": "4910960",
    "end": "4917120"
  },
  {
    "text": "this information so the uh yeah and you know I kind of looked at this and I'm",
    "start": "4917120",
    "end": "4922239"
  },
  {
    "text": "like I just got myself confused but Sam dump because daveid was talking about PW dump and all them Sam dump is actually the win 32 API call so and uh it's good",
    "start": "4922239",
    "end": "4931679"
  },
  {
    "text": "to do these types of strength assessments against users because typically you will see you know if you work for Johnson and Johnson a lot of",
    "start": "4931679",
    "end": "4937040"
  },
  {
    "text": "people's passwords are going to be Johnson globin Sachs a lot of passwords might be golden Sachs I I don't know I'm just saying this is typically you know",
    "start": "4937040",
    "end": "4943960"
  },
  {
    "text": "what would happen not a this is a real light one um",
    "start": "4943960",
    "end": "4950760"
  },
  {
    "text": "getting volume information about a drive making sure NTFS is enabled sometimes with Windows 2000 you want to see if EFS",
    "start": "4950760",
    "end": "4956320"
  },
  {
    "text": "is enabled this call is going to let you do that uh won't run on",
    "start": "4956320",
    "end": "4961600"
  },
  {
    "text": "null and the registry value so this is this is the big one for uh for this company they want to make sure their",
    "start": "4961920",
    "end": "4967280"
  },
  {
    "text": "registry is extremely secured so as we were talking about earlier reg connect registry and clearly",
    "start": "4967280",
    "end": "4974520"
  },
  {
    "text": "here we are not using null because the windr key would would stop us from doing open keys and query info values but this",
    "start": "4974520",
    "end": "4981320"
  },
  {
    "text": "is kind of a a lay out of the the steps you would take in order to get yourself registry value so one of the examples",
    "start": "4981320",
    "end": "4988159"
  },
  {
    "text": "Todd used a couple times was find out the system directory C and win n maybe deol and win",
    "start": "4988159",
    "end": "4994960"
  },
  {
    "text": "on maybe it's deol and win whatever and then go from there to try to find access",
    "start": "4994960",
    "end": "5001120"
  },
  {
    "text": "points based on system information and the second bullet underneath it is to get the daal information or sackle",
    "start": "5001120",
    "end": "5009159"
  },
  {
    "text": "information on registry keys I kind of went quickly through that just because we're running out of time",
    "start": "5009159",
    "end": "5015239"
  },
  {
    "text": "and if there are further questions on that again we could talk about those after and offline yeah I",
    "start": "5015239",
    "end": "5021159"
  },
  {
    "text": "mean we have enough time to talk about it real quick but I mean it's I mean the get security descriptor daal kind of",
    "start": "5021159",
    "end": "5026600"
  },
  {
    "text": "like that get name security info thing that we talked about earlier and uh you do want to enumerate those services that",
    "start": "5026600",
    "end": "5032520"
  },
  {
    "text": "doesn't always require administrator and account operator you can do that at the user level sometimes so that's kind of like one of those intermediate 132 API",
    "start": "5032520",
    "end": "5038320"
  },
  {
    "text": "calls that you want to try to get access to so you know you are null you get information maybe you get a user now",
    "start": "5038320",
    "end": "5044440"
  },
  {
    "text": "you're a user run a new set of 132 API calls you're one level higher get some service information and just uh just an",
    "start": "5044440",
    "end": "5051320"
  },
  {
    "text": "FYI here is get security descriptor daal we could also use that on files and we could also use get name security info on",
    "start": "5051320",
    "end": "5058360"
  },
  {
    "text": "the registry just kind of uh switching it up for exposure okay here we're talking talking",
    "start": "5058360",
    "end": "5064600"
  },
  {
    "text": "about if the administrator account can be locked out remotely as some of you",
    "start": "5064600",
    "end": "5069960"
  },
  {
    "text": "may be familiar with the tool pass prop which on nt4 you could run passp admin lockout and that prevented a Brute Force",
    "start": "5069960",
    "end": "5078480"
  },
  {
    "text": "attack of the of the administrator account over the network by requiring the administrator account to adhere to",
    "start": "5078480",
    "end": "5085440"
  },
  {
    "text": "the account lockout policy who's used that or was aware that pass prop even",
    "start": "5085440",
    "end": "5091159"
  },
  {
    "text": "existed have you guys tried that on Windows 2000 turns out on Windows 2000 the guey will",
    "start": "5091159",
    "end": "5098119"
  },
  {
    "text": "report the information correctly but there's actually a bug in it um you know our development team with veloc secure",
    "start": "5098119",
    "end": "5103800"
  },
  {
    "text": "kind of found that we're working with actually the guys doing the Microsoft presentation after this and uh they're fixing that but the API calls will give",
    "start": "5103800",
    "end": "5111119"
  },
  {
    "text": "you the accurate information the guey will not right so so using basically so",
    "start": "5111119",
    "end": "5116679"
  },
  {
    "text": "so what what the problem is in Windows 2000 is if you run pass prop I just want",
    "start": "5116679",
    "end": "5121960"
  },
  {
    "text": "make sure since it's being recorded if you run pass prop and try to do an admin",
    "start": "5121960",
    "end": "5127040"
  },
  {
    "text": "lockout on Windows 2000 the current you know the current service pack one the",
    "start": "5127040",
    "end": "5132600"
  },
  {
    "text": "things that are released as of today will not actually lock out uh will actually not turn on the ability to lock",
    "start": "5132600",
    "end": "5139239"
  },
  {
    "text": "out that account when it's Brute Force attacked from the network the GUI reports it as that however the Brute",
    "start": "5139239",
    "end": "5145360"
  },
  {
    "text": "Force attack Contin can continue to go on it will not report back to you this account has been locked out which it",
    "start": "5145360",
    "end": "5150920"
  },
  {
    "text": "should after a certain number of attempts have gone through right and uh and the way you go",
    "start": "5150920",
    "end": "5157920"
  },
  {
    "text": "through it is using those functions which are exported by Sam dll and it uses the quality of service information",
    "start": "5157920",
    "end": "5164600"
  },
  {
    "text": "structure which will report the um domain account lockout which you can",
    "start": "5164600",
    "end": "5171440"
  },
  {
    "text": "search for an SDK to see that and it'll also tell you if as you may know pass prop could be used to set complex",
    "start": "5171440",
    "end": "5177320"
  },
  {
    "text": "passwords so that information is also stored in the data structure uh we didn't choose to return it here that",
    "start": "5177320",
    "end": "5182480"
  },
  {
    "text": "wasn't an issue yes do you",
    "start": "5182480",
    "end": "5187239"
  },
  {
    "text": "yourself yes we recommend always turning turning on remote admin lockout for",
    "start": "5189080",
    "end": "5195600"
  },
  {
    "text": "administrator accounts that we use the pass prop tool that's Microsoft's tool that's Microsoft's tool it was a",
    "start": "5195600",
    "end": "5202080"
  },
  {
    "text": "released and resource kit it's actually the only tool that I've ever seen that does it other than what we've written to",
    "start": "5202080",
    "end": "5209360"
  },
  {
    "text": "query the information I've never actually written anything to change those values",
    "start": "5209360",
    "end": "5215600"
  },
  {
    "text": "and lastly was the Raz Ador Raz admin Port enum which is going to do uh Raz",
    "start": "5215600",
    "end": "5221320"
  },
  {
    "text": "there's a whole other set of calls for routing and remote access services but again what you're looking for here is what modems exist because hackers might",
    "start": "5221320",
    "end": "5227639"
  },
  {
    "text": "want to get that information then try to do you know once they know modems exist they might want or or even if pbtp ex or",
    "start": "5227639",
    "end": "5233880"
  },
  {
    "text": "now it's Windows to that l2tp layer 2 tunneling protocol um another again more",
    "start": "5233880",
    "end": "5239440"
  },
  {
    "text": "enticement information another way to get in perhaps and lastly uh the auditing piece",
    "start": "5239440",
    "end": "5246639"
  },
  {
    "text": "which is going to say well we want to figure out what the audit policy is set Windows 2000 Windows nt4 have different",
    "start": "5246639",
    "end": "5253320"
  },
  {
    "text": "audit policy settings but these are the Windows 2000 ones oh nt4 ones uh there's",
    "start": "5253320",
    "end": "5258600"
  },
  {
    "text": "a couple extra in Windows 2000 and what we're looking for here is you know do we have certain things turn on and off",
    "start": "5258600",
    "end": "5265000"
  },
  {
    "text": "because you can't turn on sackless talk about earlier which was the the directory system Access Control lists if",
    "start": "5265000",
    "end": "5272040"
  },
  {
    "text": "you haven't first turned on file object access and you won't be able to see whose accounts are being Brute Force",
    "start": "5272040",
    "end": "5278600"
  },
  {
    "text": "attacked by Intruders if log on and log off isn't turned on",
    "start": "5278600",
    "end": "5283800"
  },
  {
    "text": "first right and just to tie back into what Todd said earlier because you can use the native function calls to do",
    "start": "5283800",
    "end": "5291560"
  },
  {
    "text": "things a little differently like attempt to brute force a password by trying to change the password rather than logging",
    "start": "5291560",
    "end": "5298239"
  },
  {
    "text": "on with it there are event entries like that that'll show up in different places",
    "start": "5298239",
    "end": "5303639"
  },
  {
    "text": "like an object access failure instead of an invalid username or password so you",
    "start": "5303639",
    "end": "5309320"
  },
  {
    "text": "can kind of look through find out those event IDs and then when you read the event log which we talked about earlier",
    "start": "5309320",
    "end": "5315239"
  },
  {
    "text": "you filter on those IDs and it's a lot easier to find out if that kind of malicious activity is going",
    "start": "5315239",
    "end": "5322520"
  },
  {
    "text": "on um if you couldn't hear Todd he said if we'll take take uh a few questions we have two or three minutes left otherwise",
    "start": "5330960",
    "end": "5338719"
  },
  {
    "text": "again we'd be happy to uh talk to anybody offline you have our email addresses and we'll be here for the next",
    "start": "5338719",
    "end": "5344320"
  },
  {
    "text": "couple days and we have up here printouts of this presentation uh which you can pick up which has all the",
    "start": "5344320",
    "end": "5350280"
  },
  {
    "text": "information it's over here actually and uh that shows the",
    "start": "5350280",
    "end": "5358840"
  },
  {
    "text": "those slides are not the updated ones and if we run out we can get you",
    "start": "5364159",
    "end": "5370080"
  },
  {
    "text": "more don't worry about it",
    "start": "5370080",
    "end": "5375119"
  },
  {
    "text": "thanks",
    "start": "5393040",
    "end": "5396040"
  },
  {
    "text": "e",
    "start": "5422960",
    "end": "5425960"
  },
  {
    "text": "e",
    "start": "5452920",
    "end": "5455920"
  },
  {
    "text": "e",
    "start": "5482920",
    "end": "5485920"
  },
  {
    "text": "e",
    "start": "5512840",
    "end": "5515840"
  },
  {
    "text": "e",
    "start": "5542840",
    "end": "5545840"
  },
  {
    "text": "e",
    "start": "5572840",
    "end": "5575840"
  },
  {
    "text": "e",
    "start": "5602760",
    "end": "5605760"
  },
  {
    "text": "e",
    "start": "5632719",
    "end": "5635719"
  },
  {
    "text": "e",
    "start": "5662719",
    "end": "5665719"
  },
  {
    "text": "e",
    "start": "5692639",
    "end": "5695639"
  },
  {
    "text": "e",
    "start": "5722639",
    "end": "5725639"
  },
  {
    "text": "e",
    "start": "5752639",
    "end": "5755639"
  },
  {
    "text": "e",
    "start": "5782560",
    "end": "5785560"
  },
  {
    "text": "e",
    "start": "5812520",
    "end": "5815520"
  },
  {
    "text": "e",
    "start": "5842520",
    "end": "5845520"
  },
  {
    "text": "e",
    "start": "5872440",
    "end": "5875440"
  },
  {
    "text": "e",
    "start": "5902440",
    "end": "5905440"
  },
  {
    "text": "e",
    "start": "5932440",
    "end": "5935440"
  },
  {
    "text": "e",
    "start": "5962360",
    "end": "5965360"
  },
  {
    "text": "e",
    "start": "5992320",
    "end": "5995320"
  },
  {
    "text": "e",
    "start": "6022320",
    "end": "6025320"
  },
  {
    "text": "e",
    "start": "6052239",
    "end": "6055239"
  },
  {
    "text": "e",
    "start": "6082239",
    "end": "6085239"
  },
  {
    "text": "e",
    "start": "6112239",
    "end": "6115239"
  },
  {
    "text": "e",
    "start": "6142159",
    "end": "6145159"
  },
  {
    "text": "e",
    "start": "6172119",
    "end": "6175119"
  },
  {
    "text": "e",
    "start": "6202119",
    "end": "6205119"
  },
  {
    "text": "e",
    "start": "6232040",
    "end": "6235040"
  },
  {
    "text": "e",
    "start": "6262040",
    "end": "6265040"
  },
  {
    "text": "e",
    "start": "6292040",
    "end": "6295040"
  },
  {
    "text": "e",
    "start": "6321960",
    "end": "6324960"
  },
  {
    "text": "e",
    "start": "6351920",
    "end": "6354920"
  },
  {
    "text": "e",
    "start": "6381920",
    "end": "6384920"
  },
  {
    "text": "e",
    "start": "6411840",
    "end": "6414840"
  },
  {
    "text": "e",
    "start": "6441840",
    "end": "6444840"
  },
  {
    "text": "e",
    "start": "6471840",
    "end": "6474840"
  },
  {
    "text": "e",
    "start": "6501760",
    "end": "6504760"
  },
  {
    "text": "e",
    "start": "6531719",
    "end": "6534719"
  },
  {
    "text": "e",
    "start": "6561719",
    "end": "6564719"
  },
  {
    "text": "e",
    "start": "6591639",
    "end": "6594639"
  },
  {
    "text": "e",
    "start": "6621639",
    "end": "6624639"
  },
  {
    "text": "e",
    "start": "6651639",
    "end": "6654639"
  },
  {
    "text": "e",
    "start": "6681560",
    "end": "6684560"
  },
  {
    "text": "e",
    "start": "6711520",
    "end": "6714520"
  },
  {
    "text": "e",
    "start": "6741520",
    "end": "6744520"
  },
  {
    "text": "e",
    "start": "6771440",
    "end": "6774440"
  },
  {
    "text": "e",
    "start": "6801440",
    "end": "6804440"
  },
  {
    "text": "e",
    "start": "6831440",
    "end": "6834440"
  },
  {
    "text": "e",
    "start": "6861360",
    "end": "6864360"
  },
  {
    "text": "e",
    "start": "6891320",
    "end": "6894320"
  },
  {
    "text": "e",
    "start": "6921320",
    "end": "6924320"
  },
  {
    "text": "e",
    "start": "6951239",
    "end": "6954239"
  },
  {
    "text": "e",
    "start": "6981239",
    "end": "6984239"
  },
  {
    "text": "e",
    "start": "7011239",
    "end": "7014239"
  },
  {
    "text": "e",
    "start": "7041159",
    "end": "7044159"
  },
  {
    "text": "e",
    "start": "7071119",
    "end": "7074119"
  },
  {
    "text": "e",
    "start": "7101119",
    "end": "7104119"
  },
  {
    "text": "e",
    "start": "7131040",
    "end": "7134040"
  },
  {
    "text": "e",
    "start": "7161040",
    "end": "7164040"
  },
  {
    "text": "e",
    "start": "7191040",
    "end": "7194040"
  },
  {
    "text": "e",
    "start": "7220960",
    "end": "7223960"
  },
  {
    "text": "e",
    "start": "7250920",
    "end": "7253920"
  },
  {
    "text": "e",
    "start": "7280920",
    "end": "7283920"
  },
  {
    "text": "e for",
    "start": "7310840",
    "end": "7314880"
  }
]