[
  {
    "text": "[Music] [Laughter]",
    "start": "1610",
    "end": "10260"
  },
  {
    "text": "all right so coming up now we have Chris and Skip and their talk is still passing the hash 15 years later thanks",
    "start": "10840",
    "end": "18840"
  },
  {
    "text": "guys all right first who do we have in here do we have any Executives ra raise your hand one two do",
    "start": "23480",
    "end": "30240"
  },
  {
    "text": "we have any managers just a couple managers uh admins Network system admins all right",
    "start": "30240",
    "end": "37960"
  },
  {
    "text": "pentesters security people all right so that's going to tailor how we how we do",
    "start": "37960",
    "end": "43200"
  },
  {
    "text": "this we're going to move through the basics of uh passing the hash really quickly because uh the vast majority of",
    "start": "43200",
    "end": "50039"
  },
  {
    "text": "you were uh pentesters or security people right next SL so like you said please fill out the surveys I'm Chris",
    "start": "50039",
    "end": "57680"
  },
  {
    "text": "he's skip skip is a Linux guy he uh has some experience talking I do not uh I",
    "start": "57680",
    "end": "65600"
  },
  {
    "text": "used to be an army officer so um yeah next",
    "start": "65600",
    "end": "71040"
  },
  {
    "text": "Slide the uh all the codes available should be available today on uh the",
    "start": "71040",
    "end": "76960"
  },
  {
    "text": "Google page but we'll be blogging over the next few weeks uh how to use the",
    "start": "76960",
    "end": "82000"
  },
  {
    "text": "tools uh specifically what we demo the vast majority of this talk is going to be demos we got about 25 minutes of",
    "start": "82000",
    "end": "88280"
  },
  {
    "text": "demos so we're going to fly through the these slides follow us on Twitter next slide uh this attack's been around for",
    "start": "88280",
    "end": "94960"
  },
  {
    "text": "15 years since 1997 the end result of the attack was a tool a lot of pentesters know pretty well the patched",
    "start": "94960",
    "end": "101200"
  },
  {
    "text": "uh Samba client by the fufus group we've used it a lot next slide uh to gain",
    "start": "101200",
    "end": "107640"
  },
  {
    "text": "access to data because that's what matters we want to gain access to file servers we want to gain access to to",
    "start": "107640",
    "end": "112960"
  },
  {
    "text": "emails we want to gain access to applications using this attack next slide so regular day and in a Windows",
    "start": "112960",
    "end": "121520"
  },
  {
    "text": "Enterprise you log in you log into your email you go to SharePoint you just do",
    "start": "121520",
    "end": "127600"
  },
  {
    "text": "work and you log in one time uh same pretty much for sis ad they log in hopefully with a uh less privileged",
    "start": "127600",
    "end": "135040"
  },
  {
    "text": "account and then eventually log in with a more privileged account but only once so this single sign on process for",
    "start": "135040",
    "end": "142200"
  },
  {
    "text": "that Microsoft is designed works it works really well for what it's intended to do you only have to log in once next",
    "start": "142200",
    "end": "148640"
  },
  {
    "text": "slide so there's basically two ways that passwords are hashed locally uh NT and",
    "start": "148640",
    "end": "155160"
  },
  {
    "text": "LM and that's different than ntlm which goes over the wire next slide uh",
    "start": "155160",
    "end": "161159"
  },
  {
    "text": "everyone knows the difference I'm assuming if you're mostly security and pentest people difference between LM and and",
    "start": "161159",
    "end": "167480"
  },
  {
    "text": "NT all right so a token is created when a user logs in next slide it has four uh",
    "start": "167480",
    "end": "176319"
  },
  {
    "text": "impersonation levels or four different security levels um uh Incognito is a tool we all use to move between those",
    "start": "176319",
    "end": "183599"
  },
  {
    "text": "levels to actually impersonate other tokens next slide all right Kerberos is the default",
    "start": "183599",
    "end": "191599"
  },
  {
    "text": "for modern Windows domains a lot of people AR don't realize that and it's been that way for several years uh keros",
    "start": "191599",
    "end": "198840"
  },
  {
    "text": "uses tickets and is a complete change we're not really talking about that if you like some background on Kos read the",
    "start": "198840",
    "end": "204760"
  },
  {
    "text": "white paper that's on the DVD uh there's also a lot of background on ntlm and NT",
    "start": "204760",
    "end": "210519"
  },
  {
    "text": "so if you're unfamiliar with the stuff if you are one of the managers please go ahead and pull out your laptop and check that out next",
    "start": "210519",
    "end": "217640"
  },
  {
    "text": "slide all right so smart cards actually don't change the way that Windows authentication works on the back end NT",
    "start": "217640",
    "end": "224840"
  },
  {
    "text": "is ntlm is still used uh but it was bolted on the top of Kerberos uh other organizations buy",
    "start": "224840",
    "end": "232439"
  },
  {
    "text": "thirdparty apps to implement things like key fobs and RSA tokens but again it doesn't change on the back end how",
    "start": "232439",
    "end": "238760"
  },
  {
    "text": "Windows is actually authenticating next slide all right so curos versus",
    "start": "238760",
    "end": "246599"
  },
  {
    "text": "ntlm uh the big thing is even if you have keros uh enforced and set up if you use",
    "start": "246599",
    "end": "253599"
  },
  {
    "text": "an IP address to address something Kos is based on DNS if you use an IP address you can force the use of ntlm unless",
    "start": "253599",
    "end": "261120"
  },
  {
    "text": "it's been completely disabled so we've got SharePoint and custom apps",
    "start": "261120",
    "end": "268440"
  },
  {
    "text": "that are now using ntlm so you've pushed ntlm outside of just internal Enterprise",
    "start": "268440",
    "end": "275639"
  },
  {
    "text": "applications so you've got the latest version of ow and and a lot of SharePoint instances that are sitting on",
    "start": "275639",
    "end": "282000"
  },
  {
    "text": "the internet are using ntlm authentication you also have exchange and ow that are using it and uh other",
    "start": "282000",
    "end": "290280"
  },
  {
    "text": "things like appliances and uh printer scanner copiers can have ntlm baked into",
    "start": "290280",
    "end": "296440"
  },
  {
    "text": "it for Authentication all right so has anyone in here actually eliminated ntlm from",
    "start": "296440",
    "end": "303280"
  },
  {
    "text": "their Enterprise that's what I thought it's almost impossible even in a lab to do",
    "start": "303280",
    "end": "310479"
  },
  {
    "text": "you can disable it as much as you want but you run into major issues doing very",
    "start": "310479",
    "end": "317520"
  },
  {
    "text": "simple tasks like how would you actually add a machine to The Domain using keros",
    "start": "317520",
    "end": "323400"
  },
  {
    "text": "when Kos has to occur from a machine that's on the domain you can't so they",
    "start": "323400",
    "end": "328759"
  },
  {
    "text": "have to fall back to something uh and again that's discussed in the white paper so it's going to break a lot of",
    "start": "328759",
    "end": "334639"
  },
  {
    "text": "stuff if you try to completely rid your Enterprise of ntlm next",
    "start": "334639",
    "end": "339919"
  },
  {
    "text": "slide so that gets to passing the hash so the hash itself is used in",
    "start": "339919",
    "end": "345800"
  },
  {
    "text": "authentication even in the keros process the hash the Nash is a part of that",
    "start": "345800",
    "end": "351919"
  },
  {
    "text": "process so the hash is still there and it's probably going to be there for a very long time next slide all right all right so",
    "start": "351919",
    "end": "360160"
  },
  {
    "text": "this is important from this point on since you guys are mostly pentesters you",
    "start": "360160",
    "end": "365240"
  },
  {
    "text": "understand this concept we already have the hashes so however you gotten to this point for the demos and from this point",
    "start": "365240",
    "end": "371319"
  },
  {
    "text": "on we're assuming not just local hashes you've knocked over the DC there are a",
    "start": "371319",
    "end": "376360"
  },
  {
    "text": "million ways to get to that point but once you once you've done it the point of this is to move forward and get to",
    "start": "376360",
    "end": "382120"
  },
  {
    "text": "the value get to the business data and show the CEO show who's paying for you to be there that this attack and their",
    "start": "382120",
    "end": "389840"
  },
  {
    "text": "data can be compromised once you've knocked over the domain controller Skip and I have done a lot of work on",
    "start": "389840",
    "end": "395039"
  },
  {
    "text": "cracking passwords uh it's kind of a point of competition between us we like",
    "start": "395039",
    "end": "400759"
  },
  {
    "text": "to shoot for if it's all NT we don't really count it if your Enterprise is still still has LM we don't even care",
    "start": "400759",
    "end": "408000"
  },
  {
    "text": "we'll just use rainbow tables but if you're all NT and you've got a a really good password policy we shoot to still",
    "start": "408000",
    "end": "413800"
  },
  {
    "text": "try to crack over 50% of your hashes so it's still possible to crack them but we",
    "start": "413800",
    "end": "418919"
  },
  {
    "text": "don't have to and we're going to show you all the ways that you can do things without actually cracking those uh those",
    "start": "418919",
    "end": "425160"
  },
  {
    "text": "hashes next slide all right so this is what a typical P to Hash attack kind of looks",
    "start": "425160",
    "end": "430840"
  },
  {
    "text": "like uh most people use Menlo if you search SMB and menit you'll see the",
    "start": "430840",
    "end": "437080"
  },
  {
    "text": "stuff that you can supply a hash to uh you can do the SMB login scans to see if",
    "start": "437080",
    "end": "442479"
  },
  {
    "text": "the hashes work and then you can use the PS exact module which is pretty common",
    "start": "442479",
    "end": "447520"
  },
  {
    "text": "um for pent testers so so the PS exec module works great you you hit uh it",
    "start": "447520",
    "end": "453919"
  },
  {
    "text": "works great on a box that doesn't have AV and that the hashes are valid for it's actually going to upload an",
    "start": "453919",
    "end": "460120"
  },
  {
    "text": "executable that that it's going to create when you run the module and then",
    "start": "460120",
    "end": "465479"
  },
  {
    "text": "it's going to start that executable as a service uh AV has got hip to that so there are different ways to make this",
    "start": "465479",
    "end": "472240"
  },
  {
    "text": "more successful but in the end all you have is a shell next slide so when",
    "start": "472240",
    "end": "478319"
  },
  {
    "text": "you're trying to brief this to whoever is paying for you to actually be there uh they don't really understand shells",
    "start": "478319",
    "end": "486360"
  },
  {
    "text": "no matter how you show them that you've got an authority system on a domain controller you that's game over for most",
    "start": "486360",
    "end": "492759"
  },
  {
    "text": "of the people in the room but it doesn't really matter to them so unless you show them some sort of effect they really",
    "start": "492759",
    "end": "500879"
  },
  {
    "text": "they really don't care from what we've seen so what you have to go after is the",
    "start": "500879",
    "end": "506000"
  },
  {
    "text": "data whatever is the heart of the business focus on that so you've gotten the the system shell on the domain",
    "start": "506000",
    "end": "512599"
  },
  {
    "text": "controller how do you move forward how do you go after the actual data so you",
    "start": "512599",
    "end": "517959"
  },
  {
    "text": "could start by going after file shares but we've been able to do that for a long time using the patched Samba client",
    "start": "517959",
    "end": "525040"
  },
  {
    "text": "but everyone knows on file shares you find passwords you find interesting things but real business data normally",
    "start": "525040",
    "end": "531800"
  },
  {
    "text": "doesn't reside uh on file shares you have marketing data you may have some",
    "start": "531800",
    "end": "537800"
  },
  {
    "text": "research stuff but data actually resides next",
    "start": "537800",
    "end": "543839"
  },
  {
    "text": "slide in uh in databases in email and we'll take a look at that in in a second",
    "start": "543839",
    "end": "550200"
  },
  {
    "text": "but Windows itself actually passes the hash regularly just to operate so it's",
    "start": "550200",
    "end": "556600"
  },
  {
    "text": "constantly doing that so why can't we SL all right so this is kind of",
    "start": "556600",
    "end": "562959"
  },
  {
    "text": "confusing our the our demo is actually inside of an enclave more so than inside",
    "start": "562959",
    "end": "568600"
  },
  {
    "text": "the domain it's it's actually not on the domain itself this first one we're sitting inside the firewall uh we've",
    "start": "568600",
    "end": "576600"
  },
  {
    "text": "already dumped the hashes we've already owned them and we care about three people three people have access to the",
    "start": "576600",
    "end": "582120"
  },
  {
    "text": "to the data that we're trying to go after Alice Bob and the uh CEO so our box is a Windows 7 box we're",
    "start": "582120",
    "end": "590200"
  },
  {
    "text": "going to start by doing a demo of a Windows environment how to do all this stuff with Windows uh and then we'll",
    "start": "590200",
    "end": "597959"
  },
  {
    "text": "we'll move and Skip we'll show you some new tools to use to do all this stuff in Linux we're going to use",
    "start": "597959",
    "end": "603920"
  },
  {
    "text": "WCE uh is anybody familiar with WCE uh her Cho tool is awesome it will",
    "start": "603920",
    "end": "610320"
  },
  {
    "text": "basically allow you to accomplish anything that you would want to do but the problem is it only runs on windows",
    "start": "610320",
    "end": "617480"
  },
  {
    "text": "so I'll show you how to do it all on uh on a Windows box and then skip we'll",
    "start": "617480",
    "end": "623040"
  },
  {
    "text": "show you how to do it from backtrack next slide so we'll start by uh using the TAC",
    "start": "623040",
    "end": "630760"
  },
  {
    "text": "s which will actually set the credential um and basically we'll go over go ahead and talk through what the demo is and",
    "start": "630760",
    "end": "637360"
  },
  {
    "text": "then I'll talk through it again as we go and then use TX C to run a command and and the important the",
    "start": "637360",
    "end": "643639"
  },
  {
    "text": "interesting thing is we're going to do this from a box that's not on the domain so if you're an internal pent tester and",
    "start": "643639",
    "end": "648800"
  },
  {
    "text": "you just sit on the network you should be able to do all of this from just a Windows machine next",
    "start": "648800",
    "end": "655480"
  },
  {
    "text": "slide so we can actually kill explorer.exe on our box so we showed up",
    "start": "655480",
    "end": "660639"
  },
  {
    "text": "we're pentesters we've plugged in we can sit down and use our box kill the admin",
    "start": "660639",
    "end": "666480"
  },
  {
    "text": "session cuz hopefully we're local admins on our own pent test box we can kill that kill explore and actually start",
    "start": "666480",
    "end": "672200"
  },
  {
    "text": "Explorer as a user on their domain if we can uh actually authenticate against the",
    "start": "672200",
    "end": "677760"
  },
  {
    "text": "DC with the hashes we can launch Internet Explorer and browse to SharePoint sites logged in",
    "start": "677760",
    "end": "685760"
  },
  {
    "text": "next slide and we can fire up Outlook set up a new profile and read people's emails with their",
    "start": "685760",
    "end": "694079"
  },
  {
    "text": "hashes and we can access uh file shares with net",
    "start": "694079",
    "end": "699200"
  },
  {
    "text": "commands uh skip wanted to point out that the save cred doesn't work maybe someone in this room knows why uh we",
    "start": "699200",
    "end": "707279"
  },
  {
    "text": "think we suspect that save cred and when you do uh net use is actually sticking",
    "start": "707279",
    "end": "712959"
  },
  {
    "text": "the plane text password somewhere and calling it later because it does not",
    "start": "712959",
    "end": "718000"
  },
  {
    "text": "allow you to use it when you supply a hash all right so we can actually fire",
    "start": "718000",
    "end": "724279"
  },
  {
    "text": "up uh SQL commands tsql oql and uh and interact with SQL databases and in the",
    "start": "724279",
    "end": "731040"
  },
  {
    "text": "demo we actually pull out and use the full SQL management Studio next slide and we can basically",
    "start": "731040",
    "end": "738760"
  },
  {
    "text": "do anything that an admin does so whatever an administrator typically uses",
    "start": "738760",
    "end": "744199"
  },
  {
    "text": "PS exac wmi uh interesting Powershell you can fire up a Powershell in",
    "start": "744199",
    "end": "749760"
  },
  {
    "text": "and any command L that doesn't require you to reauthenticate can be used uh",
    "start": "749760",
    "end": "755120"
  },
  {
    "text": "aduck and computer management which I'll show you in the demo all right so let's go ahead and",
    "start": "755120",
    "end": "760480"
  },
  {
    "text": "knock out this demo so this demo is about 10 minutes long and it moves uh pretty quickly so",
    "start": "760480",
    "end": "768839"
  },
  {
    "text": "we'll start by using WCE and you'll see the hashes we've already dumped it's a pretty",
    "start": "768839",
    "end": "775079"
  },
  {
    "text": "simplistic demo we've got the 500 account we've got uh m SQL account Alice",
    "start": "775079",
    "end": "780560"
  },
  {
    "text": "Bob and the CEO which we've already talked about the domain name is demo so",
    "start": "780560",
    "end": "786000"
  },
  {
    "text": "we fired up a new command prompt so now we're just uh we're going to use PS exac",
    "start": "786000",
    "end": "793279"
  },
  {
    "text": "to PS exac into the domain controller so now we have a SI we we have a admin",
    "start": "793279",
    "end": "801320"
  },
  {
    "text": "shell on the domain controller itself so now anything we're doing we're doing on",
    "start": "801320",
    "end": "807519"
  },
  {
    "text": "the actual DC so we've used that the hashes and we can do anything that we want all right so we kill the PS exac",
    "start": "807519",
    "end": "813760"
  },
  {
    "text": "we're going to go ahead and open up aduck and we get this strange error but all we have to do we have DNS",
    "start": "813760",
    "end": "820959"
  },
  {
    "text": "set up so all we have to do is pop in the domain and then aduck is running with the administrator hashes so it",
    "start": "820959",
    "end": "826880"
  },
  {
    "text": "authenticates passing the hash on the back end and we it appears we have full",
    "start": "826880",
    "end": "832320"
  },
  {
    "text": "access to actor directory but let's go ahead and add a",
    "start": "832320",
    "end": "837519"
  },
  {
    "text": "user and uh and see if that's the case uh and the reason that we left this in",
    "start": "837519",
    "end": "842560"
  },
  {
    "text": "the demo is to show you that not everything works as intended so if you're a pentester you probably already",
    "start": "842560",
    "end": "848720"
  },
  {
    "text": "know this sometimes things don't just work so we're going to go ahead and set the password and find out that we",
    "start": "848720",
    "end": "856600"
  },
  {
    "text": "actually can't do this so we don't know what the error is",
    "start": "856600",
    "end": "862759"
  },
  {
    "text": "we don't know why someone in here might know uh but using the guey",
    "start": "862759",
    "end": "869240"
  },
  {
    "text": "we can't add a user but that's okay because we don't typically use the guey uh joare tools has adod uh you can use",
    "start": "869240",
    "end": "875880"
  },
  {
    "text": "net commands as well but in this case we're going to go ahead and use adod with our Command Prompt that is running",
    "start": "875880",
    "end": "883399"
  },
  {
    "text": "with the set credentials of the",
    "start": "883399",
    "end": "887560"
  },
  {
    "text": "administrator and we will Doss them with new users so our demo domain now has 10",
    "start": "889880",
    "end": "895480"
  },
  {
    "text": "new users we can go back to to adok and there they are so we can create users",
    "start": "895480",
    "end": "900600"
  },
  {
    "text": "and set the password but we just can't do it through active directory users and computers we can add our new users to",
    "start": "900600",
    "end": "907680"
  },
  {
    "text": "The Domain admins group without issue uh and then if we go and try to",
    "start": "907680",
    "end": "915600"
  },
  {
    "text": "set the password for one of them let's see what happens create a computer okay next",
    "start": "915600",
    "end": "923000"
  },
  {
    "text": "we'll go ahead and uh create a computer account so we can pre-stage a computer",
    "start": "923000",
    "end": "928040"
  },
  {
    "text": "account and through aduck and it does not give us an",
    "start": "928040",
    "end": "933920"
  },
  {
    "text": "error we can actually reset it so that it's staged in whatever OU so",
    "start": "933920",
    "end": "942199"
  },
  {
    "text": "if you wanted to hide somewhere you can do that none of this stuff is new if",
    "start": "942199",
    "end": "948120"
  },
  {
    "text": "you've never done this on a pentest uh that's cool it's pretty pretty simple WC",
    "start": "948120",
    "end": "954839"
  },
  {
    "text": "makes this entire process uh very easy but as you can see we can't change we",
    "start": "954839",
    "end": "960839"
  },
  {
    "text": "still can't change the password for whatever",
    "start": "960839",
    "end": "965120"
  },
  {
    "text": "reason all right so let's open up computer management let's look at some other admin tasks that you would",
    "start": "968279",
    "end": "973560"
  },
  {
    "text": "typically do let's connect to another computer we'll connect to a",
    "start": "973560",
    "end": "979560"
  },
  {
    "text": "server we can start and stop Services let's find one that won't crash",
    "start": "979560",
    "end": "985600"
  },
  {
    "text": "the Box",
    "start": "985600",
    "end": "988839"
  },
  {
    "text": "so remote registry restart it we could stop it so again none of this stuff is uh",
    "start": "997240",
    "end": "1005560"
  },
  {
    "text": "particularly exciting maybe you don't go after data but typically most data that",
    "start": "1005560",
    "end": "1012560"
  },
  {
    "text": "we find that enterprises are trying to protect reside in databases so we're going to use the m",
    "start": "1012560",
    "end": "1019000"
  },
  {
    "text": "SQL service account hash here and we're going to open up another command prompt uh",
    "start": "1019000",
    "end": "1027600"
  },
  {
    "text": "as that hash uh if you're doing this on your own uh quick gotcha you might want",
    "start": "1027600",
    "end": "1033640"
  },
  {
    "text": "to you might have to set permissions to allow like limited users to access your own",
    "start": "1033640",
    "end": "1040079"
  },
  {
    "text": "box and we can fire up we start Explorer we can fire up uh",
    "start": "1040079",
    "end": "1046880"
  },
  {
    "text": "Ms SQL login failed because we're just logged in as in this case",
    "start": "1046880",
    "end": "1053160"
  },
  {
    "text": "skip so now let's see what happens when we actually uh fire up the tool through our elevated",
    "start": "1053160",
    "end": "1061320"
  },
  {
    "text": "session using the",
    "start": "1061320",
    "end": "1064960"
  },
  {
    "text": "hash of course it works um it does not know who's actually logged in it thinks",
    "start": "1067039",
    "end": "1074039"
  },
  {
    "text": "that skip is still logged in as you can see there but",
    "start": "1074039",
    "end": "1079720"
  },
  {
    "text": "who who's actually logged in is that mssql service account so we've got full access",
    "start": "1079720",
    "end": "1085159"
  },
  {
    "text": "to the entire backend database as the hopefully elevated mssql",
    "start": "1085159",
    "end": "1093440"
  },
  {
    "text": "demo msql account all through passing the hash",
    "start": "1093440",
    "end": "1099200"
  },
  {
    "text": "with WCE so WCE is an awesome tool that will help you move Beyond just shell to",
    "start": "1099200",
    "end": "1106880"
  },
  {
    "text": "actually getting data so you can get data with admin hashes now let's go after user data cuz in some environments",
    "start": "1106880",
    "end": "1114320"
  },
  {
    "text": "that have appropriately restricted privilege some users actually have more",
    "start": "1114320",
    "end": "1119400"
  },
  {
    "text": "access than administrators do to sensitive data so it may it might be several small SE several small groups",
    "start": "1119400",
    "end": "1127080"
  },
  {
    "text": "that are able to access important applications and one example we'll show",
    "start": "1127080",
    "end": "1132120"
  },
  {
    "text": "you right here uh who am I does not work with WCE",
    "start": "1132120",
    "end": "1138039"
  },
  {
    "text": "it will think you are the interactive session that you started so it still thinks we're",
    "start": "1138039",
    "end": "1145320"
  },
  {
    "text": "Skip and let's fire up uh Outlook first as the user and see if Outlook can",
    "start": "1145320",
    "end": "1152880"
  },
  {
    "text": "figure out in this case we started Outlook with our normal account so we have to create a new profile which is new in the newer versions of",
    "start": "1152880",
    "end": "1161080"
  },
  {
    "text": "office so just like a normal user without ever having to put our password in we can connect to the exchange server",
    "start": "1161840",
    "end": "1169640"
  },
  {
    "text": "using the hash and WCE and access all of their uh emails and this is pretty",
    "start": "1169640",
    "end": "1176960"
  },
  {
    "text": "logical I think everyone in the room knew that you could do this uh the important thing is to show managers to",
    "start": "1176960",
    "end": "1184200"
  },
  {
    "text": "show admins the actual effect of uh of a compromise of the the hashes the",
    "start": "1184200",
    "end": "1192400"
  },
  {
    "text": "nashes themselves all right so whatever Alice's",
    "start": "1192400",
    "end": "1197960"
  },
  {
    "text": "calendar she's got or this is Bob's calendar or the CEO's calendar dinner with",
    "start": "1197960",
    "end": "1204600"
  },
  {
    "text": "Alice that's",
    "start": "1204600",
    "end": "1207799"
  },
  {
    "text": "interesting all right so let's open iie let's check out SharePoint let's uh this is Alice",
    "start": "1209679",
    "end": "1218840"
  },
  {
    "text": "okay so we're going to SharePoint with our IE instance fired up through the",
    "start": "1222720",
    "end": "1228000"
  },
  {
    "text": "past the hash and we're automatically logged in as Alice the ntlmssp allows us",
    "start": "1228000",
    "end": "1233960"
  },
  {
    "text": "to very easily gain access to users data users data if we have the hashes",
    "start": "1233960",
    "end": "1240559"
  },
  {
    "text": "themselves all right Alice does not have access so we'll have to try someone else's account to gain access to that",
    "start": "1240559",
    "end": "1249799"
  },
  {
    "text": "data all right we can use net commands we can mount shares we can write to",
    "start": "1253080",
    "end": "1259320"
  },
  {
    "text": "shares that they have access to uh permissions work the same as they would with a normal account uh Alice does not",
    "start": "1259320",
    "end": "1266640"
  },
  {
    "text": "have access to the CEO's share so she can't write little messages",
    "start": "1266640",
    "end": "1273640"
  },
  {
    "text": "to him or her but she can write to her",
    "start": "1273640",
    "end": "1281360"
  },
  {
    "text": "own which is all logical and probably things you've demonstrated in the past",
    "start": "1281360",
    "end": "1289039"
  },
  {
    "text": "so we'll we'll set our credentials to Bob using Bob's",
    "start": "1290760",
    "end": "1297480"
  },
  {
    "text": "hash and we'll go ahead and kill Explorer just show you a little neat trick so explore dies where we have this",
    "start": "1315320",
    "end": "1322640"
  },
  {
    "text": "command. exe running as Bob so we can just start explore again and now we're logged in as Bob so we can just use IE",
    "start": "1322640",
    "end": "1332000"
  },
  {
    "text": "and browse and there we are logged in is",
    "start": "1332000",
    "end": "1336840"
  },
  {
    "text": "Bob so silly uh pentest tricks with",
    "start": "1340840",
    "end": "1346159"
  },
  {
    "text": "passing the hash and WCE overall nothing uh extremely exciting",
    "start": "1346159",
    "end": "1352520"
  },
  {
    "text": "again shared folders the the net commands work Bob has access to Bobs folder does not have access to the CEO",
    "start": "1352520",
    "end": "1358919"
  },
  {
    "text": "or Alice's he can write to his own",
    "start": "1358919",
    "end": "1364799"
  },
  {
    "text": "directory",
    "start": "1364799",
    "end": "1367799"
  },
  {
    "text": "all right so we'll change we'll set the credential one more time as the CEO and",
    "start": "1383679",
    "end": "1389679"
  },
  {
    "text": "see what access the CEO",
    "start": "1389679",
    "end": "1393158"
  },
  {
    "text": "has all right so now we have another instance of cmd.exe running as the CEO",
    "start": "1403480",
    "end": "1409640"
  },
  {
    "text": "in the demo domain so let's go to SharePoint",
    "start": "1409640",
    "end": "1417360"
  },
  {
    "text": "again and see what the CEO has going on because when you show the CEO his calendar or his",
    "start": "1417360",
    "end": "1425480"
  },
  {
    "text": "email he's going to get excited maybe in a good way maybe in a bad",
    "start": "1425480",
    "end": "1431000"
  },
  {
    "text": "way all right so there's uh a command line test with open change that you'll",
    "start": "1431000",
    "end": "1436600"
  },
  {
    "text": "see in the next demo uh there's the CEO's calendar all set up through SharePoint and this is something we",
    "start": "1436600",
    "end": "1442919"
  },
  {
    "text": "commonly see email calendar uh files everything in",
    "start": "1442919",
    "end": "1450480"
  },
  {
    "text": "SharePoint uh I guess he's looking for a new employee at black",
    "start": "1450480",
    "end": "1457120"
  },
  {
    "text": "hat uh and he's got dinner with multiple women that probably should not show up",
    "start": "1457120",
    "end": "1464440"
  },
  {
    "text": "in the report",
    "start": "1464440",
    "end": "1467840"
  },
  {
    "text": "so this demonstr we still have those other to so we you can basically have the the",
    "start": "1471480",
    "end": "1479120"
  },
  {
    "text": "sessions of multiple users open uh but just one at a time with",
    "start": "1479120",
    "end": "1485679"
  },
  {
    "text": "Explorer and that concludes uh the windows demo so the next part will be uh",
    "start": "1489320",
    "end": "1496200"
  },
  {
    "text": "skip explaining some of the gachas and and then uh and then he's going to show you ways to do all of that in Linux and",
    "start": "1496200",
    "end": "1505240"
  },
  {
    "text": "maybe have an exciting announcement after",
    "start": "1505240",
    "end": "1509039"
  },
  {
    "text": "that all right hello all",
    "start": "1512799",
    "end": "1517440"
  },
  {
    "text": "right little taller than he is anyway so uh when we were putting these demos",
    "start": "1518480",
    "end": "1524720"
  },
  {
    "text": "together we're trying to use uh software that's representative of of what we've seen on assessments so at first I tried",
    "start": "1524720",
    "end": "1532159"
  },
  {
    "text": "to use when my first demo environment I tried using Outlook 2007 worked perfectly I created the restricted demo",
    "start": "1532159",
    "end": "1540320"
  },
  {
    "text": "just with only the services I want and for whatever reason it didn't work so I",
    "start": "1540320",
    "end": "1547039"
  },
  {
    "text": "reverted back to Outlook 2003 and it worked fine uh who knows um one thing I think",
    "start": "1547039",
    "end": "1554440"
  },
  {
    "text": "that's been demonstrated is that when you start doing this stuff on a Windows environment it gets a little",
    "start": "1554440",
    "end": "1559760"
  },
  {
    "text": "freaky uh it doesn't like doing some of these things um probably because it's",
    "start": "1559760",
    "end": "1565520"
  },
  {
    "text": "not the way it's used to dealing with it so for example aduck couldn't assign passwords create accounts you could",
    "start": "1565520",
    "end": "1572120"
  },
  {
    "text": "create computer accounts you could change uh group membership disable",
    "start": "1572120",
    "end": "1577760"
  },
  {
    "text": "accounts enable accounts do almost anything except for set a password next",
    "start": "1577760",
    "end": "1584120"
  },
  {
    "text": "slide uh also multiple guey apps um you can't start uh like IE under two",
    "start": "1584120",
    "end": "1592039"
  },
  {
    "text": "separate users uh at the same time I think what it does is the first uh one",
    "start": "1592039",
    "end": "1598039"
  },
  {
    "text": "that's open it just creates a new thread under that current process even if you start it as somebody else's token kind",
    "start": "1598039",
    "end": "1605120"
  },
  {
    "text": "of weird but it's the way it is so anyway obviously if you do this kind",
    "start": "1605120",
    "end": "1610840"
  },
  {
    "text": "of thing uh expect some Oddities when dealing with Windows environment but you",
    "start": "1610840",
    "end": "1617320"
  },
  {
    "text": "know what I'm Linux guy guy that's kind of cool but let's do all that with",
    "start": "1617320",
    "end": "1622399"
  },
  {
    "text": "Linux so previously mentioned was the uh JMK at fufus uh patched the uh aamba",
    "start": "1622399",
    "end": "1631360"
  },
  {
    "text": "which is a suite of uh RPC libraries and some rudimentary command line stuff that",
    "start": "1631360",
    "end": "1637840"
  },
  {
    "text": "integrates or allows Linux to interact with a Windows environment uh his patch",
    "start": "1637840",
    "end": "1643360"
  },
  {
    "text": "basically worked by setting an environmental variable with the SMB hash",
    "start": "1643360",
    "end": "1648559"
  },
  {
    "text": "and then you put the hash in that environmental variable and you run all this all the s commands and assuming",
    "start": "1648559",
    "end": "1654880"
  },
  {
    "text": "that the environmental variable was set properly uh it would substitute the hash",
    "start": "1654880",
    "end": "1660519"
  },
  {
    "text": "next slide that's kind of cool but we want to do it all from the command line",
    "start": "1660519",
    "end": "1666000"
  },
  {
    "text": "in case we want to script events or uh be able to easily use",
    "start": "1666000",
    "end": "1672679"
  },
  {
    "text": "uh like guey apps and stuff like that so we added a capability where",
    "start": "1672679",
    "end": "1678640"
  },
  {
    "text": "uh if the password is that's provided to the command line is 65 characters it",
    "start": "1678640",
    "end": "1685720"
  },
  {
    "text": "looks and see is that it's an LM Hash a colon and then the NT hash or a 68",
    "start": "1685720",
    "end": "1693720"
  },
  {
    "text": "character LM colon NT colon colon colon which looks an awful lot like FG dump",
    "start": "1693720",
    "end": "1699240"
  },
  {
    "text": "output or hash dump output or something like that so if the password is one of those",
    "start": "1699240",
    "end": "1705399"
  },
  {
    "text": "two substitute the hash instead so we have avoid the environmental variable issue next slide easier to use in",
    "start": "1705399",
    "end": "1712679"
  },
  {
    "text": "scripts because all you have to do is just copy and paste the uh the hash change the username and once again it",
    "start": "1712679",
    "end": "1718960"
  },
  {
    "text": "allows guey access like Firefox to be able to change the hashes without having",
    "start": "1718960",
    "end": "1725559"
  },
  {
    "text": "to kill Firefox and restart Firefox after changing the environmental",
    "start": "1725559",
    "end": "1731200"
  },
  {
    "text": "variable so it's pretty easy to patch a lot of utilities uh you find something that supports ntlm Authentication you",
    "start": "1731200",
    "end": "1738399"
  },
  {
    "text": "find where the uh where the source code does the md4 which really about the only",
    "start": "1738399",
    "end": "1745640"
  },
  {
    "text": "thing anyone uses md4 for these days is nlm authentication check to see if the",
    "start": "1745640",
    "end": "1750919"
  },
  {
    "text": "password is 65 or 68 characters and you substitute in by converting the 32bit or",
    "start": "1750919",
    "end": "1757880"
  },
  {
    "text": "32 by uh hash value that's basically hex nibbles into",
    "start": "1757880",
    "end": "1764640"
  },
  {
    "text": "a 16 byte integer array",
    "start": "1764640",
    "end": "1770000"
  },
  {
    "text": "so a lot of people think that Samba is just for ACC accessing file shares uh",
    "start": "1770039",
    "end": "1775360"
  },
  {
    "text": "there's actually a lot of really cool things you can do with Samba and there's a lot of cool things that link to Samba",
    "start": "1775360",
    "end": "1781480"
  },
  {
    "text": "because it's built on top of it so really what Samba is at its core is a",
    "start": "1781480",
    "end": "1789000"
  },
  {
    "text": "library that can be linked to for dce RPC interaction with uh Microsoft",
    "start": "1789000",
    "end": "1795559"
  },
  {
    "text": "environments uh we're also going to be releasing releasing uh I called it the past to Hash Rosetta Stone it's going to",
    "start": "1795559",
    "end": "1801799"
  },
  {
    "text": "be a Google doc spreadsheet uh that talks about how to do various common Windows net commands",
    "start": "1801799",
    "end": "1809440"
  },
  {
    "text": "under SoMo using the corresponding Samba commands uh that's something that we",
    "start": "1809440",
    "end": "1815320"
  },
  {
    "text": "always try to figure out how to do stuff in uh multiple",
    "start": "1815320",
    "end": "1820480"
  },
  {
    "text": "ways so utilities that link with Samba we've got uh PS exac uh clone in Winnie",
    "start": "1820480",
    "end": "1828519"
  },
  {
    "text": "it's been out there for a while uh the latest version offers 32 and 64-bit service support so you can use in pretty",
    "start": "1828519",
    "end": "1835320"
  },
  {
    "text": "much any Windows environment uh I found a basic wmi uh query utility and in the uh",
    "start": "1835320",
    "end": "1843279"
  },
  {
    "text": "source code there was a demo program that was never really compiled or finished that allows for blind command",
    "start": "1843279",
    "end": "1850960"
  },
  {
    "text": "execution doing wmi with a little bit of tweaking uh and then open change which",
    "start": "1850960",
    "end": "1856639"
  },
  {
    "text": "is a uh open-source implementation of the exchange RPC libraries and",
    "start": "1856639",
    "end": "1861880"
  },
  {
    "text": "essentially allows people to access exchange from",
    "start": "1861880",
    "end": "1867279"
  },
  {
    "text": "Linux uh Firefox uh by default if you try if it's prompted for ntlm",
    "start": "1867279",
    "end": "1873559"
  },
  {
    "text": "authentication it uh tries to use built-in Samba it",
    "start": "1873559",
    "end": "1878880"
  },
  {
    "text": "assumes that the Linux box itself is on the domain so it tries to query through wind bind but if you go digging about",
    "start": "1878880",
    "end": "1885960"
  },
  {
    "text": "colon config there's an ntlm that uses its own baked in method so we just patch",
    "start": "1885960",
    "end": "1891240"
  },
  {
    "text": "the baked in method use that away we go uh you can go to about config search for",
    "start": "1891240",
    "end": "1896880"
  },
  {
    "text": "n ntlm and then search for Network off Force generic ntlm set it to True we'll",
    "start": "1896880",
    "end": "1903399"
  },
  {
    "text": "show that in the demo uh free TDs is a library that uh",
    "start": "1903399",
    "end": "1910559"
  },
  {
    "text": "allows access to sbase and Ms SQL databases uh once again it supports enm",
    "start": "1910559",
    "end": "1918279"
  },
  {
    "text": "authentication so uh based on Davenport which is one of",
    "start": "1918279",
    "end": "1923360"
  },
  {
    "text": "the two well documented ntlm reverse engineerings that's out there Samba did",
    "start": "1923360",
    "end": "1929519"
  },
  {
    "text": "one and then Davenport did another the Davenport website if you haven't read their ntlm write up it's extensive and",
    "start": "1929519",
    "end": "1936960"
  },
  {
    "text": "then they provide a sample implementation in Java which a lot of people just basically copy and paste",
    "start": "1936960",
    "end": "1944519"
  },
  {
    "text": "rename the stuff and make it work and see so so we know how to patch",
    "start": "1944519",
    "end": "1950000"
  },
  {
    "text": "it uh you combine uh free TDS with uh squish cuz free TDs is really just a",
    "start": "1950000",
    "end": "1956240"
  },
  {
    "text": "library squish is a an actual interactive uh utility and you get",
    "start": "1956240",
    "end": "1961960"
  },
  {
    "text": "access to uh SQL databases from Linux so",
    "start": "1961960",
    "end": "1967559"
  },
  {
    "text": "let's go ahead and get the demo going we use the exact same demo environment only our client this time is",
    "start": "1967559",
    "end": "1975120"
  },
  {
    "text": "uh lenux so here uh dump the hashes we're just",
    "start": "1975120",
    "end": "1981440"
  },
  {
    "text": "going to do a quick uh log in with W uh with winex",
    "start": "1981440",
    "end": "1987240"
  },
  {
    "text": "exe so we'll log into the DC which is 17216 1.1 as",
    "start": "1987320",
    "end": "1996120"
  },
  {
    "text": "administrator and the command line this is one of several ways you can pass the password on the command line domain SL",
    "start": "1996440",
    "end": "2003960"
  },
  {
    "text": "administrator percent sign and then the password hash and as you see we just logged into the",
    "start": "2003960",
    "end": "2009559"
  },
  {
    "text": "DC uh as administrator",
    "start": "2009559",
    "end": "2015120"
  },
  {
    "text": "um in the next win exe we'll do the same thing uh the DC is a 32-bit 2008 the uh",
    "start": "2015120",
    "end": "2022720"
  },
  {
    "text": "Exchange Server is a 64-bit so we'll change log into that one and in this",
    "start": "2022720",
    "end": "2028000"
  },
  {
    "text": "case we logged in as system so you have the uh ability to select the high",
    "start": "2028000",
    "end": "2033120"
  },
  {
    "text": "privilege account as opposed to the UAC account as well",
    "start": "2033120",
    "end": "2039559"
  },
  {
    "text": "and apparently I'm talking faster than the SL than the demo all right so we use uh freetds free",
    "start": "2042679",
    "end": "2050599"
  },
  {
    "text": "TDS requires that you set up a configuration file rather than pass stuff on the command line I'll might",
    "start": "2050599",
    "end": "2056760"
  },
  {
    "text": "look at uh fixing that later so I set it up to point at our Exchange Server which",
    "start": "2056760",
    "end": "2062919"
  },
  {
    "text": "is where the Microsoft SQL database is uh its profile name is MS SQL in the",
    "start": "2062919",
    "end": "2068440"
  },
  {
    "text": "config file there's the uh command that's where",
    "start": "2068440",
    "end": "2074919"
  },
  {
    "text": "we copy and paste the hash and just to show that I'm not faking the funk",
    "start": "2074919",
    "end": "2080878"
  },
  {
    "text": "here I actually changed the last character from an A to a b try to log in and it doesn't",
    "start": "2080879",
    "end": "2089079"
  },
  {
    "text": "work change it back to an A and now I'm into the",
    "start": "2089079",
    "end": "2094638"
  },
  {
    "text": "database running commands against Microsoft SQL from Linux using the",
    "start": "2094639",
    "end": "2100440"
  },
  {
    "text": "hash poke around a little",
    "start": "2100440",
    "end": "2104359"
  },
  {
    "text": "bit uh we loaded the uh Adventure Works database uh onto the SQL Server so that",
    "start": "2105800",
    "end": "2111440"
  },
  {
    "text": "we could play around with some dummy data which is actually a lot harder than you think to try to gen up a demo",
    "start": "2111440",
    "end": "2118920"
  },
  {
    "text": "environment so in this case what I'm doing is I am heading to the adventure",
    "start": "2118920",
    "end": "2124640"
  },
  {
    "text": "Works database uh database I find that one of the tables has credit",
    "start": "2124640",
    "end": "2130400"
  },
  {
    "text": "card information in it",
    "start": "2130400",
    "end": "2137960"
  },
  {
    "text": "and then we'll uh access the credit card information pretty good for a demo when",
    "start": "2139800",
    "end": "2145320"
  },
  {
    "text": "you're talking to a CA level okay by the way using password hashes we were able to get all your customer data all the",
    "start": "2145320",
    "end": "2151880"
  },
  {
    "text": "credit card info for all your customers we'll be going over uh on our",
    "start": "2151880",
    "end": "2157200"
  },
  {
    "text": "blog how to do all this stuff we'll do blog entries for each one of the utilities",
    "start": "2157200",
    "end": "2162319"
  },
  {
    "text": "sample uses uh caveats We've run into uh that sort of thing so a lot of",
    "start": "2162319",
    "end": "2168560"
  },
  {
    "text": "this stuff is not extremely well documented we're going to try to make it more practically",
    "start": "2168560",
    "end": "2176200"
  },
  {
    "text": "documented so anyway there's a fat finger and all just to demonstrate",
    "start": "2176640",
    "end": "2183599"
  },
  {
    "text": "that even I make mistakes",
    "start": "2183599",
    "end": "2188319"
  },
  {
    "text": "and so here I pull out all of the uh dummy credit card data where the card",
    "start": "2190640",
    "end": "2196000"
  },
  {
    "text": "type is equal to",
    "start": "2196000",
    "end": "2199480"
  },
  {
    "text": "Vista all right Firefox this is actually one of my",
    "start": "2205680",
    "end": "2213560"
  },
  {
    "text": "favorites so I created I started Firefox in the Prof profile mode I set that as a",
    "start": "2213560",
    "end": "2219119"
  },
  {
    "text": "default so that we can create a separate profile for using past the hash you go to about colon",
    "start": "2219119",
    "end": "2224560"
  },
  {
    "text": "config Click by the nasty warning you just type ntlm up there and",
    "start": "2224560",
    "end": "2231200"
  },
  {
    "text": "then the uh Network o force gener uh generic ntlm we set it to",
    "start": "2231200",
    "end": "2238920"
  },
  {
    "text": "true so keep in mind when accessing Microsoft SharePoint AA that sort of",
    "start": "2238920",
    "end": "2244800"
  },
  {
    "text": "thing that Firefox might not render it properly or you won't get the full functionality but it still works well",
    "start": "2244800",
    "end": "2254359"
  },
  {
    "text": "enough so we're going to log in as",
    "start": "2254960",
    "end": "2259119"
  },
  {
    "text": "Alice and once again I hit the uh I installed an add-on to show that the hash that I copied and pasted in there",
    "start": "2263319",
    "end": "2269800"
  },
  {
    "text": "was what was there and boom there we go",
    "start": "2269800",
    "end": "2275400"
  },
  {
    "text": "thank you I'm also going to release a version",
    "start": "2278319",
    "end": "2283359"
  },
  {
    "text": "of Firefox for Windows uh same Source same patch same everything just built on",
    "start": "2283359",
    "end": "2289280"
  },
  {
    "text": "the Windows stuff uh which may or may not be useful for",
    "start": "2289280",
    "end": "2294680"
  },
  {
    "text": "you so we do the same thing we log out log in with",
    "start": "2294680",
    "end": "2300359"
  },
  {
    "text": "Bob once again show the password just uh show that I'm not fake the funk there",
    "start": "2304280",
    "end": "2309319"
  },
  {
    "text": "hit reload a couple times for the the page to refresh and this got cut out of the",
    "start": "2309319",
    "end": "2315359"
  },
  {
    "text": "windows demo but Bob actually has access to run queries against the adventure",
    "start": "2315359",
    "end": "2320400"
  },
  {
    "text": "Works database whereas Alice did",
    "start": "2320400",
    "end": "2324599"
  },
  {
    "text": "not then I believe we sign into a with the CEO's password and password hash",
    "start": "2328680",
    "end": "2338319"
  },
  {
    "text": "this is one of those things that uh was a little weird under Firefox the CEO tab",
    "start": "2345520",
    "end": "2351119"
  },
  {
    "text": "under Windows populated properly unfortunately on uh Linux it didn't so I",
    "start": "2351119",
    "end": "2358480"
  },
  {
    "text": "just go straight to the OA instead and uh pull up his email and poker his",
    "start": "2358480",
    "end": "2363880"
  },
  {
    "text": "calendar and whatnot note that stuff like tasks uh the calendar shows up mail shows up",
    "start": "2363880",
    "end": "2370880"
  },
  {
    "text": "but several other things do not show up by default under Linux like the tasks the to-do list that sort of",
    "start": "2370880",
    "end": "2379160"
  },
  {
    "text": "thing so yes he's looking for Bob's replacement which is probably something Bob would like to know",
    "start": "2382520",
    "end": "2389838"
  },
  {
    "text": "about and uh yeah he's still having dinner with Alice and the wife",
    "start": "2391839",
    "end": "2398640"
  },
  {
    "text": "that could be a little awkward they're on different nights at",
    "start": "2398640",
    "end": "2406800"
  },
  {
    "text": "least so open change uh when you use open change you have to set up a profile",
    "start": "2406800",
    "end": "2412400"
  },
  {
    "text": "for every user ahead of time so I'm going to go ahead and create",
    "start": "2412400",
    "end": "2418119"
  },
  {
    "text": "a profile for each one of the three users which is what's going on here",
    "start": "2418119",
    "end": "2425680"
  },
  {
    "text": "um open chain allows you to access the uh The Exchange mailboxes you can send",
    "start": "2425680",
    "end": "2433240"
  },
  {
    "text": "mail from the command line I'll demonstrate that here in a minute after all this uh",
    "start": "2433240",
    "end": "2440560"
  },
  {
    "text": "typing and uh you can also dump mailboxes to Mbox",
    "start": "2440560",
    "end": "2447079"
  },
  {
    "text": "format uh you can access the calendar but when I tried doing the uh open",
    "start": "2447079",
    "end": "2452319"
  },
  {
    "text": "change to IAL it just kept seg falting on me so obviously it's a little flaky",
    "start": "2452319",
    "end": "2458040"
  },
  {
    "text": "but if you can get to it through AA you know you still have access to the",
    "start": "2458040",
    "end": "2463359"
  },
  {
    "text": "data so this getting it set up unfortunately",
    "start": "2463640",
    "end": "2470200"
  },
  {
    "text": "is a bit tedious but you could probably script it and if you wanted to for Pure",
    "start": "2470200",
    "end": "2476400"
  },
  {
    "text": "shock value you could probably script up accessing every account on The Exchange",
    "start": "2476400",
    "end": "2481760"
  },
  {
    "text": "Server dumping the mailbox then handing the client a DVD with everyone's mail in",
    "start": "2481760",
    "end": "2487520"
  },
  {
    "text": "plain text format from their Exchange Server that might raise a few",
    "start": "2487520",
    "end": "2492880"
  },
  {
    "text": "eyebrows this is all about accessing the company's data people think that because",
    "start": "2492880",
    "end": "2499200"
  },
  {
    "text": "Normal pass the hash just dumps you on a shell that you can't read the email you",
    "start": "2499200",
    "end": "2504480"
  },
  {
    "text": "can't get to the data that's in the SQL database but they all use ntlm",
    "start": "2504480",
    "end": "2509520"
  },
  {
    "text": "authentication ntlm has been fundamentally broken for years and uh it's uh I I",
    "start": "2509520",
    "end": "2520119"
  },
  {
    "text": "don't I don't think I'm smart enough to come up with this stuff on my own I'm sure someone's probably done it before",
    "start": "2520119",
    "end": "2525680"
  },
  {
    "text": "the fact that no one's talked about it probably means those are the types of people that keep really quiet on your",
    "start": "2525680",
    "end": "2531440"
  },
  {
    "text": "network so draw your own conclusions from there so anyway here I use Alice's",
    "start": "2531440",
    "end": "2538880"
  },
  {
    "text": "profile to send an email from the command line to B",
    "start": "2538880",
    "end": "2545400"
  },
  {
    "text": "uh the CEO",
    "start": "2545400",
    "end": "2548760"
  },
  {
    "text": "and then I believe I use uh do the same thing with uh one of the other uh with",
    "start": "2552559",
    "end": "2560079"
  },
  {
    "text": "the CEO and I send it to Bob you can also um modify mboxes",
    "start": "2560079",
    "end": "2570079"
  },
  {
    "text": "directly and then sync up changes so you could use a regular mail program to access the Mbox after you",
    "start": "2570079",
    "end": "2578800"
  },
  {
    "text": "download it delete messages change messages do whatever and then resync it with exchange and all the messages will",
    "start": "2578800",
    "end": "2584440"
  },
  {
    "text": "change on the back in I don't demonstrate that here because",
    "start": "2584440",
    "end": "2589640"
  },
  {
    "text": "I was concerned with time so anyway you use uh exchange",
    "start": "2589640",
    "end": "2599040"
  },
  {
    "text": "to uh inbox to dump it dump the uh the profiles mailboxes into Mbox format in",
    "start": "2599040",
    "end": "2606240"
  },
  {
    "text": "this case I'm dumping it into into mail directory and then after I dump all of them I will use my favorite mail reader",
    "start": "2606240",
    "end": "2612800"
  },
  {
    "text": "Pine to go in and read everyone's email from",
    "start": "2612800",
    "end": "2619720"
  },
  {
    "text": "Unix and the last little bit of the demo I uh run a sample wmi query against the",
    "start": "2628960",
    "end": "2635760"
  },
  {
    "text": "database if you're not familiar with wmi you can do some really interesting things with it",
    "start": "2635760",
    "end": "2642440"
  },
  {
    "text": "uh I just copied and pasted the command line there gave it a couple seconds so in this case what it's doing is it's",
    "start": "2642440",
    "end": "2647920"
  },
  {
    "text": "selecting name and process ID from win32 process which basically gives you a remote process listing what's running on",
    "start": "2647920",
    "end": "2656079"
  },
  {
    "text": "that particular machine the next command is a blind command inject uh execution",
    "start": "2656079",
    "end": "2662480"
  },
  {
    "text": "so I run command. exe waxy dur c/ and I save the file because it's a blind",
    "start": "2662480",
    "end": "2668880"
  },
  {
    "text": "execution to a text file run it you don't get any sort of real feedback but",
    "start": "2668880",
    "end": "2674200"
  },
  {
    "text": "then I use SMB get which is kind of a w get thing that Samba has to go access",
    "start": "2674200",
    "end": "2680559"
  },
  {
    "text": "that file and we have the directory entry so it's not it's asynchronous but",
    "start": "2680559",
    "end": "2686640"
  },
  {
    "text": "you could actually do some interactive stuff with it",
    "start": "2686640",
    "end": "2692599"
  },
  {
    "text": "[Applause] so thank you [Music]",
    "start": "2693080",
    "end": "2698220"
  },
  {
    "text": "[Applause] all right so Chris talked about a little bit how do you uh eliminate how how do",
    "start": "2698220",
    "end": "2705839"
  },
  {
    "text": "you defend against this you can",
    "start": "2705839",
    "end": "2712280"
  },
  {
    "text": "uh try to eliminate the use of ntlm uh as Chris mentioned it's a real",
    "start": "2712280",
    "end": "2717880"
  },
  {
    "text": "pain uh in all likelihood it will break things it will break things you don't think about like nazes appliances",
    "start": "2717880",
    "end": "2724680"
  },
  {
    "text": "printers copiers digital senders things that cannot be a member of the domain of course you could always try not losing",
    "start": "2724680",
    "end": "2730800"
  },
  {
    "text": "the DC in the first place I know it's kind of crazy um keros uses the NT has for",
    "start": "2730800",
    "end": "2737280"
  },
  {
    "text": "encrypting the tickets between the KDC and principles so keros is no safer from",
    "start": "2737280",
    "end": "2744040"
  },
  {
    "text": "losing the hashes than anything else the problem is no one really has any practical attacks for it we uh talk",
    "start": "2744040",
    "end": "2751520"
  },
  {
    "text": "about in the white paper a uh a theoretical attack where may look at",
    "start": "2751520",
    "end": "2757400"
  },
  {
    "text": "implementing it at some point uh where basically you can completely undermine the trust of keros if you have access to",
    "start": "2757400",
    "end": "2763680"
  },
  {
    "text": "all the hashes so anyway uh Windows plus WCE plus",
    "start": "2763680",
    "end": "2769160"
  },
  {
    "text": "hashes is access to all your data uh may work a little weirdly but it",
    "start": "2769160",
    "end": "2775160"
  },
  {
    "text": "does work uh Linux plus pass the hash plus tools plus hashes equals access to",
    "start": "2775160",
    "end": "2782000"
  },
  {
    "text": "all your data so uh giving some shouts out here to folks thanks to JMK at fufus for the",
    "start": "2782000",
    "end": "2789480"
  },
  {
    "text": "68 character suggestion and I'd also like to give a special thanks to Pure haate who is",
    "start": "2789480",
    "end": "2796480"
  },
  {
    "text": "working valiantly on getting this stuff directly integrated into backtrack so the website will I will",
    "start": "2796480",
    "end": "2805119"
  },
  {
    "text": "have Debian packages available the DVD has all the Debian packages I will post some instruction shortly on getting them",
    "start": "2805119",
    "end": "2811640"
  },
  {
    "text": "installed and configured and start walking through the tools and the blog but uh pretty soon that's going to be",
    "start": "2811640",
    "end": "2817680"
  },
  {
    "text": "obsolete as soon as we get a couple minor issues worked out on the backtrack package so it'll be available as a direct backtrack",
    "start": "2817680",
    "end": "2825000"
  },
  {
    "text": "repository all right uh think that yep so anybody have",
    "start": "2825000",
    "end": "2831400"
  },
  {
    "text": "any questions or anything uh Chris and I will be hanging out for a bit so uh do we have a mic or",
    "start": "2831400",
    "end": "2839160"
  },
  {
    "text": "anything or I guess there's a mic stand back",
    "start": "2839160",
    "end": "2844520"
  },
  {
    "text": "there if you want to write behind the cameraman behind the",
    "start": "2844520",
    "end": "2850240"
  },
  {
    "text": "camera you talked about attacking the DC but um can I use the hashes which are",
    "start": "2852200",
    "end": "2858599"
  },
  {
    "text": "cached on my local machine um Yes actually using WC well it",
    "start": "2858599",
    "end": "2865280"
  },
  {
    "text": "it depends uh in a domain environment on most modern versions of Windows uh you",
    "start": "2865280",
    "end": "2870359"
  },
  {
    "text": "can't use the local Sam 500 account uh unless there's a registry setting that's",
    "start": "2870359",
    "end": "2876160"
  },
  {
    "text": "been fixed we'll talk about that in the blog entry that's something that we cut from the presentation for time but if",
    "start": "2876160",
    "end": "2882240"
  },
  {
    "text": "you have domain creds that are cach that you can access or you gain access to from like WCE those will work just",
    "start": "2882240",
    "end": "2890880"
  },
  {
    "text": "fine using WCE in windows in Windows uh have you tried to to spawn multiple uh",
    "start": "2890880",
    "end": "2898839"
  },
  {
    "text": "WCE sessions in multiple desktops uh no did not try doing that",
    "start": "2898839",
    "end": "2906160"
  },
  {
    "text": "explicitly I think there can only be one Explorer process running at a time um I",
    "start": "2906160",
    "end": "2911920"
  },
  {
    "text": "don't know I haven't tried experimenting with trying to spawn multiple desktops as multiple users that would be a very",
    "start": "2911920",
    "end": "2917720"
  },
  {
    "text": "interesting thing to try yeah I was just reading uh some CIS internal stuff and I don't remember if Explorer respond on",
    "start": "2917720",
    "end": "2923280"
  },
  {
    "text": "the desktop level or the session level yeah I know the S internal tool I've played with it briefly but I haven't",
    "start": "2923280",
    "end": "2929280"
  },
  {
    "text": "considered I haven't tried doing it with that that might be something to play with did you modify the Firefox sour",
    "start": "2929280",
    "end": "2937000"
  },
  {
    "text": "code or did you add an add-on I modified the Firefox source code all of the",
    "start": "2937000",
    "end": "2942359"
  },
  {
    "text": "Firefox add-ons don't directly none of the Firefox add-ons actually add any",
    "start": "2942359",
    "end": "2948319"
  },
  {
    "text": "sort of authentication methods to the code itself and and that goes about for all the U Mappy client and open change",
    "start": "2948319",
    "end": "2955000"
  },
  {
    "text": "and everything as well you modifi yes I modified the source code so the the Google code page will have all the",
    "start": "2955000",
    "end": "2961079"
  },
  {
    "text": "patches I'm not going to host the you know their Source packages and whatnot",
    "start": "2961079",
    "end": "2966520"
  },
  {
    "text": "but and I'll also post the build scripts that I use and it's basically the same stuff that pure Hat's using to build the",
    "start": "2966520",
    "end": "2972000"
  },
  {
    "text": "backtrack packages thanks uhuh do these attacks work in",
    "start": "2972000",
    "end": "2977240"
  },
  {
    "text": "organizations who are forcing ntlm version two yes okay uh ntlm V2 is still",
    "start": "2977240",
    "end": "2985839"
  },
  {
    "text": "uh depends on the hashes obviously the tool itself has to support it it took the Davenport guys 10 years to reverse",
    "start": "2985839",
    "end": "2993799"
  },
  {
    "text": "engineer ntlmv2 uh s I think to get a working implementation it took maybe 5 years but",
    "start": "2993799",
    "end": "3001520"
  },
  {
    "text": "now that everybody has that yes it works perfectly against nlm V2 in fact all the",
    "start": "3001520",
    "end": "3007000"
  },
  {
    "text": "stuff I did in the demos I enforced nlm V2 thank",
    "start": "3007000",
    "end": "3012240"
  },
  {
    "text": "you oh yeah one other little thing uh the CEO this whole time was forced to",
    "start": "3012240",
    "end": "3018839"
  },
  {
    "text": "use a smart card to log in smart card logins are only for the",
    "start": "3018839",
    "end": "3025359"
  },
  {
    "text": "console Network access doesn't apply anybody",
    "start": "3025359",
    "end": "3033559"
  },
  {
    "text": "else any other questions otherwise Chris is goingon to start",
    "start": "3033559",
    "end": "3038440"
  },
  {
    "text": "dancing all right well thanks a lot uh hope you guys enjoyed the talk",
    "start": "3041720",
    "end": "3048170"
  },
  {
    "text": "[Applause]",
    "start": "3048170",
    "end": "3052288"
  }
]