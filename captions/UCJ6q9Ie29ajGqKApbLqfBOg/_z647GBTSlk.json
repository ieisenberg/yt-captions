[
  {
    "start": "0",
    "end": "183000"
  },
  {
    "text": "well this session is right once pone everywhere your speaker is Yang Y and",
    "start": "80",
    "end": "6240"
  },
  {
    "text": "thank you and I hope you enjoy good morning",
    "start": "6240",
    "end": "13160"
  },
  {
    "text": "everyone uh this is my first presentation in black hat to be honest",
    "start": "13160",
    "end": "19560"
  },
  {
    "text": "I'm uh a little nervous uh so I hope smile can make up for my terrible",
    "start": "19560",
    "end": "26400"
  },
  {
    "text": "English and really ugly slides thank thank",
    "start": "26400",
    "end": "32160"
  },
  {
    "text": "you my presentation will be in four parts the first two parts are about",
    "start": "34559",
    "end": "42160"
  },
  {
    "text": "bypass the uh asrr and the other two parts are about",
    "start": "42160",
    "end": "48440"
  },
  {
    "text": "bypass",
    "start": "48440",
    "end": "50960"
  },
  {
    "text": "D yeah um my name is y i work for 10",
    "start": "55320",
    "end": "61320"
  },
  {
    "text": "cent a Chinese company 10 cent is the company name not the money they paid",
    "start": "61320",
    "end": "70280"
  },
  {
    "text": "me nobody work for 10 cent that's too little I joined the security industry",
    "start": "70280",
    "end": "79079"
  },
  {
    "text": "from uh 2002 most of my research is about",
    "start": "79079",
    "end": "85840"
  },
  {
    "text": "exploiting and detection but before before",
    "start": "85840",
    "end": "92280"
  },
  {
    "text": "2002 um I was working hard for my MD degree",
    "start": "92280",
    "end": "98439"
  },
  {
    "text": "and I finally got it I almost uh became a doctor but now you",
    "start": "98439",
    "end": "106040"
  },
  {
    "text": "see um yeah I'm a computer monkey like you",
    "start": "106040",
    "end": "111399"
  },
  {
    "text": "guys uhhuh see the difference see the",
    "start": "111399",
    "end": "116960"
  },
  {
    "text": "difference no girls anymore more that's our job",
    "start": "117640",
    "end": "126560"
  },
  {
    "text": "yeah okay let's get down to business Once Upon a",
    "start": "127000",
    "end": "134959"
  },
  {
    "text": "Time just gript use BST to store string",
    "start": "134959",
    "end": "140000"
  },
  {
    "text": "object data the bstr structure has had two",
    "start": "140000",
    "end": "145640"
  },
  {
    "text": "parts",
    "start": "145640",
    "end": "148640"
  },
  {
    "text": "you see the point yeah two parts the",
    "start": "151200",
    "end": "157480"
  },
  {
    "text": "length and the date when we create a string in the",
    "start": "157480",
    "end": "165000"
  },
  {
    "text": "JavaScript it will generate a bstr in memory like",
    "start": "165000",
    "end": "173120"
  },
  {
    "text": "this the length the date yeah",
    "start": "173120",
    "end": "181200"
  },
  {
    "start": "183000",
    "end": "183000"
  },
  {
    "text": "because of the length the string object cannot access the data out of",
    "start": "184840",
    "end": "190840"
  },
  {
    "text": "bound but if we use some vulnerability to increase the length then we can",
    "start": "190840",
    "end": "197360"
  },
  {
    "text": "access any data after the bstr like",
    "start": "197360",
    "end": "204120"
  },
  {
    "text": "this the length yeah then we",
    "start": "204959",
    "end": "210879"
  },
  {
    "text": "use some vulnerability to",
    "start": "210879",
    "end": "216080"
  },
  {
    "text": "overwrite the length with a really large",
    "start": "216080",
    "end": "223120"
  },
  {
    "text": "value yeah and now we can do out of bound",
    "start": "223480",
    "end": "230560"
  },
  {
    "text": "reading that mean info leak and bypass ASR",
    "start": "231120",
    "end": "237920"
  },
  {
    "text": "and the address of the lens we can calculate it",
    "start": "248159",
    "end": "253439"
  },
  {
    "text": "out",
    "start": "253439",
    "end": "256439"
  },
  {
    "text": "yeah this length this length we can calculate this",
    "start": "258840",
    "end": "265320"
  },
  {
    "text": "length first change anying character in the spray stram by some",
    "start": "265320",
    "end": "273039"
  },
  {
    "text": "vulnerability and then check each character find out which one was",
    "start": "273039",
    "end": "281199"
  },
  {
    "text": "changed and calculate the offset to the initial of the",
    "start": "281199",
    "end": "286560"
  },
  {
    "text": "stream then we get the",
    "start": "286560",
    "end": "290680"
  },
  {
    "text": "address first uh spr the the",
    "start": "293600",
    "end": "300520"
  },
  {
    "text": "traditional hip spre this is our spr",
    "start": "300520",
    "end": "306639"
  },
  {
    "text": "address and we write right to this",
    "start": "306639",
    "end": "314919"
  },
  {
    "text": "address we spread the uh with zero and",
    "start": "314919",
    "end": "320479"
  },
  {
    "text": "we change change some character it and we find",
    "start": "320479",
    "end": "330360"
  },
  {
    "text": "the car not z r",
    "start": "330520",
    "end": "335840"
  },
  {
    "text": "yeah finally we can calculate the",
    "start": "335840",
    "end": "342400"
  },
  {
    "text": "address uh but from I9 from",
    "start": "346080",
    "end": "352840"
  },
  {
    "text": "I9 J script five was abandoned J script nine replaced it",
    "start": "352840",
    "end": "360800"
  },
  {
    "text": "and J script n did not use BST",
    "start": "360800",
    "end": "366000"
  },
  {
    "text": "now fortunately just five is still in the",
    "start": "366000",
    "end": "371400"
  },
  {
    "text": "system for the compatibility like many old things so we",
    "start": "371400",
    "end": "377680"
  },
  {
    "text": "can summon it back like suon an old ghost so we need a",
    "start": "377680",
    "end": "384440"
  },
  {
    "text": "a magic spell yeah this is our magic",
    "start": "384440",
    "end": "391160"
  },
  {
    "text": "spell J script 9 did not support script encoding so if you set encode tag",
    "start": "391160",
    "end": "400759"
  },
  {
    "text": "jscript five will be re recruited the coma the comact tag is",
    "start": "400759",
    "end": "408720"
  },
  {
    "text": "also work but some features are not supported like Eva",
    "start": "408720",
    "end": "414720"
  },
  {
    "text": "function yeah",
    "start": "414720",
    "end": "418720"
  },
  {
    "text": "that's our spell okay so uh it seems we got everything",
    "start": "420240",
    "end": "428120"
  },
  {
    "text": "now we can have bstr again we can do",
    "start": "428120",
    "end": "433199"
  },
  {
    "text": "info leak then ROP and j j gript five is",
    "start": "433199",
    "end": "441599"
  },
  {
    "text": "universal this trick can work from IE 6 to IE 11 maybe 12",
    "start": "441599",
    "end": "450520"
  },
  {
    "text": "yeah but is just script n really",
    "start": "450520",
    "end": "457440"
  },
  {
    "text": "unexploitable now now let's talk about the jpt",
    "start": "459360",
    "end": "466000"
  },
  {
    "text": "N J 9 and j five are maybe nearly",
    "start": "473560",
    "end": "479599"
  },
  {
    "text": "identical for web developers but they are very different",
    "start": "479599",
    "end": "485960"
  },
  {
    "text": "internally even the file size of the jpt 9 is much",
    "start": "485960",
    "end": "492000"
  },
  {
    "text": "bigger much bigger yeah and I always say we should thanks Google V8 and those",
    "start": "492000",
    "end": "500879"
  },
  {
    "text": "speed test yeah because of them although",
    "start": "500879",
    "end": "506000"
  },
  {
    "text": "jrip 9 is no longer use bstr",
    "start": "506000",
    "end": "511240"
  },
  {
    "text": "but there is something new and better J 9 is designed to fast",
    "start": "511240",
    "end": "519880"
  },
  {
    "text": "yeah so the security is not the highest",
    "start": "519880",
    "end": "525440"
  },
  {
    "start": "530000",
    "end": "530000"
  },
  {
    "text": "priority yeah let's see about this um this is how J script n does",
    "start": "531080",
    "end": "538920"
  },
  {
    "text": "dream object the data the length and the date are in",
    "start": "538920",
    "end": "546040"
  },
  {
    "text": "different memory",
    "start": "546040",
    "end": "549040"
  },
  {
    "text": "address the length the length and uh the",
    "start": "552480",
    "end": "559720"
  },
  {
    "text": "date yeah this is the uh the",
    "start": "559720",
    "end": "567480"
  },
  {
    "text": "length the the data address and the data you see they are in different",
    "start": "567839",
    "end": "576120"
  },
  {
    "text": "address and although bstr is gone spraying string data is meaningless but",
    "start": "577200",
    "end": "583920"
  },
  {
    "text": "we can spray string object not string not string date but",
    "start": "583920",
    "end": "592600"
  },
  {
    "text": "string object yeah we We Don't Spray some Bigg",
    "start": "592600",
    "end": "600440"
  },
  {
    "text": "dreams we spray many small strings",
    "start": "600440",
    "end": "607680"
  },
  {
    "text": "see just two character",
    "start": "609440",
    "end": "614519"
  },
  {
    "text": "yeah we spr a very short string many times then we get the string object on",
    "start": "616480",
    "end": "623000"
  },
  {
    "text": "the address we wanted yeah so do the length",
    "start": "623000",
    "end": "630399"
  },
  {
    "text": "using this technique we even do not need to locate the lens address we can",
    "start": "631399",
    "end": "637720"
  },
  {
    "text": "control it see this lens is in the sprad",
    "start": "637720",
    "end": "644079"
  },
  {
    "text": "address yeah the the",
    "start": "644079",
    "end": "649639"
  },
  {
    "text": "address yeah",
    "start": "649639",
    "end": "653759"
  },
  {
    "text": "right so I say it's much better",
    "start": "656560",
    "end": "661240"
  },
  {
    "text": "but if you really like the locating game we also have something like",
    "start": "666920",
    "end": "673839"
  },
  {
    "text": "bstr in just 9 the array data is our new",
    "start": "673839",
    "end": "680920"
  },
  {
    "text": "BST see we create many big arrays",
    "start": "681160",
    "end": "688399"
  },
  {
    "text": "yeah we create many big",
    "start": "691240",
    "end": "694680"
  },
  {
    "text": "arrays this is one of the array object we",
    "start": "696800",
    "end": "702959"
  },
  {
    "text": "create and uh this is the array",
    "start": "703920",
    "end": "709160"
  },
  {
    "text": "date and we can see there is three length there is three",
    "start": "709880",
    "end": "716680"
  },
  {
    "text": "length one",
    "start": "716800",
    "end": "720800"
  },
  {
    "text": "one 2 3 yeah there is three lens one is in the",
    "start": "722240",
    "end": "730600"
  },
  {
    "text": "object two are in the date see that the red number below that",
    "start": "730600",
    "end": "739360"
  },
  {
    "text": "is the length we will rewrite this one yeah",
    "start": "739360",
    "end": "748959"
  },
  {
    "text": "locating array data lens is very similar to locating bstr lens just write a",
    "start": "751800",
    "end": "758880"
  },
  {
    "text": "spread address then check each number value find out which one was changed and",
    "start": "758880",
    "end": "766639"
  },
  {
    "text": "calculated the offset to the initial of the array and then we got it",
    "start": "766639",
    "end": "775279"
  },
  {
    "start": "779000",
    "end": "779000"
  },
  {
    "text": "but the real challenge is here there is a little difference",
    "start": "779440",
    "end": "785760"
  },
  {
    "text": "between BST and array data if only enlarge length in the array",
    "start": "785760",
    "end": "794680"
  },
  {
    "text": "data prefix the outer bounds read will be",
    "start": "794680",
    "end": "801399"
  },
  {
    "text": "filled yeah because justt 9 will check that three lens",
    "start": "801560",
    "end": "809399"
  },
  {
    "text": "yeah we just say there are three lens J N will check that three lens while",
    "start": "809399",
    "end": "816120"
  },
  {
    "text": "reading a data you can't just overwrite one of",
    "start": "816120",
    "end": "822639"
  },
  {
    "text": "them if we just uh overwrite this and do out of bounds",
    "start": "825040",
    "end": "833320"
  },
  {
    "text": "reading the will be filled yeah",
    "start": "833320",
    "end": "839040"
  },
  {
    "start": "839000",
    "end": "839000"
  },
  {
    "text": "but but yeah although we can't to do out of",
    "start": "842160",
    "end": "847920"
  },
  {
    "text": "bound reading but the out of bound writing can be done we can't read but we",
    "start": "847920",
    "end": "856920"
  },
  {
    "text": "can write it's funny I I don't know why I don't know why",
    "start": "856920",
    "end": "864600"
  },
  {
    "text": "yeah and and if you do Auto bound right",
    "start": "865959",
    "end": "871519"
  },
  {
    "text": "writing the other two lens will be rote",
    "start": "871519",
    "end": "878639"
  },
  {
    "text": "automatically I I don't know why why they they they design like this uh but just",
    "start": "878680",
    "end": "888880"
  },
  {
    "text": "uh okay see we we do outter bound writing",
    "start": "888880",
    "end": "897800"
  },
  {
    "text": "yeah and these two lens got to be changed",
    "start": "897800",
    "end": "903480"
  },
  {
    "text": "automatically yeah then we can do outut of bound",
    "start": "903480",
    "end": "909759"
  },
  {
    "text": "reading yeah I think uh jpt 9 is more exploit friendly yeah we don't need to",
    "start": "914560",
    "end": "923480"
  },
  {
    "text": "locating string length we can control it and uh with a",
    "start": "923480",
    "end": "929360"
  },
  {
    "text": "read we can write any memory not only read bstr is read",
    "start": "929360",
    "end": "936720"
  },
  {
    "text": "only now we can read and write and uh j j g n have many other",
    "start": "936720",
    "end": "944639"
  },
  {
    "text": "exploit friendly Futures unfortunately I don't have enough time to talk all of them maybe in",
    "start": "944639",
    "end": "953319"
  },
  {
    "text": "other conference I I just show you some uh",
    "start": "953319",
    "end": "959279"
  },
  {
    "text": "interesting object",
    "start": "959279",
    "end": "963199"
  },
  {
    "text": "yeah in j n from IE 10 there are some",
    "start": "964920",
    "end": "972040"
  },
  {
    "text": "new object this object make make it more easier to read and write",
    "start": "972040",
    "end": "980000"
  },
  {
    "text": "memory since I don't have enough time to talk all about this so I uh left some",
    "start": "980000",
    "end": "986800"
  },
  {
    "text": "questions for you",
    "start": "986800",
    "end": "990560"
  },
  {
    "text": "how to turn calling uaf to rewriting",
    "start": "993240",
    "end": "998920"
  },
  {
    "text": "UF um how to how to trigger a rewrite rewriting UF mulle times without",
    "start": "999199",
    "end": "1007319"
  },
  {
    "text": "crash since bstr use system Hep how to",
    "start": "1007319",
    "end": "1013240"
  },
  {
    "text": "buypass uh the Heap gaps in Windows 8 we know uh the Windows 8 have a new",
    "start": "1013240",
    "end": "1022040"
  },
  {
    "text": "future uh they they make gaps in the system",
    "start": "1022040",
    "end": "1027199"
  },
  {
    "text": "Hep yeah but only only you uh only just",
    "start": "1027199",
    "end": "1032678"
  },
  {
    "text": "SP five face this the G 9 I just like I say",
    "start": "1032679",
    "end": "1039558"
  },
  {
    "text": "is more exploit friendly they use custom hip no no",
    "start": "1039559",
    "end": "1046520"
  },
  {
    "text": "gaps no gaps yeah and string object is read only how to",
    "start": "1046520",
    "end": "1053200"
  },
  {
    "text": "write memory in jpt 5",
    "start": "1053200",
    "end": "1058799"
  },
  {
    "text": "yeah and rewriting UF is not rare but not every rewriting is exploit",
    "start": "1064600",
    "end": "1074080"
  },
  {
    "text": "friendly the first is a lovely one write anying value to any address but the",
    "start": "1074080",
    "end": "1081679"
  },
  {
    "text": "others are not so lovely not fully controlled how to exploit all of them",
    "start": "1081679",
    "end": "1089600"
  },
  {
    "text": "that's also the question list for you",
    "start": "1089600",
    "end": "1094520"
  },
  {
    "text": "yeah so um now we can choose j five or jrip nine",
    "start": "1099840",
    "end": "1111400"
  },
  {
    "text": "to do info leak and the Roop yeah R is a great",
    "start": "1111400",
    "end": "1119840"
  },
  {
    "text": "technique but creating a r chain is a laborious",
    "start": "1119840",
    "end": "1125919"
  },
  {
    "text": "process I'm not a very I'm not a hardworking man yeah they say laziness",
    "start": "1125919",
    "end": "1134120"
  },
  {
    "text": "is the mother of invention so uh let's do some",
    "start": "1134120",
    "end": "1141080"
  },
  {
    "text": "invention vital Point",
    "start": "1145159",
    "end": "1149240"
  },
  {
    "text": "strike this is uh kungu Panda vital Point",
    "start": "1150559",
    "end": "1158799"
  },
  {
    "start": "1159000",
    "end": "1159000"
  },
  {
    "text": "strike vital vital point point is uh V",
    "start": "1159320",
    "end": "1164600"
  },
  {
    "text": "points are some special points in the human body",
    "start": "1164600",
    "end": "1169640"
  },
  {
    "text": "a pressure to vital Point can make insense pain even lead to",
    "start": "1169640",
    "end": "1177600"
  },
  {
    "text": "death uh like ailles here yeah many",
    "start": "1177600",
    "end": "1183600"
  },
  {
    "text": "people know about vital points uh Chinese people Japanese",
    "start": "1183600",
    "end": "1191080"
  },
  {
    "text": "people even vcan people see spoke really good at this",
    "start": "1191080",
    "end": "1200240"
  },
  {
    "text": "vcan nerve pinch who like spoke uh I'm a Spoke",
    "start": "1200240",
    "end": "1208760"
  },
  {
    "text": "fan that is human body but is there any",
    "start": "1211000",
    "end": "1216400"
  },
  {
    "text": "vital point in computer",
    "start": "1216400",
    "end": "1221320"
  },
  {
    "text": "memory let's think about this what's the difference between these",
    "start": "1224480",
    "end": "1230480"
  },
  {
    "text": "two programs the windows script",
    "start": "1230480",
    "end": "1236120"
  },
  {
    "text": "host and Internet Explorer in Windows script host or HTML",
    "start": "1236120",
    "end": "1244960"
  },
  {
    "text": "application J grip can invoke any object such as W script",
    "start": "1244960",
    "end": "1252720"
  },
  {
    "text": "shell yeah or fso they can do almost anything",
    "start": "1252720",
    "end": "1260120"
  },
  {
    "text": "but I can't what's the difference between two",
    "start": "1260120",
    "end": "1266080"
  },
  {
    "text": "programs these two programs yeah think about",
    "start": "1266080",
    "end": "1272559"
  },
  {
    "start": "1275000",
    "end": "1275000"
  },
  {
    "text": "that yeah there is a safe mode switch there is a safe mode switch",
    "start": "1275360",
    "end": "1284840"
  },
  {
    "text": "this is the persuade",
    "start": "1289400",
    "end": "1294639"
  },
  {
    "text": "code that's our Vital point in some special",
    "start": "1296440",
    "end": "1302760"
  },
  {
    "text": "address as long as even one bite be overwritten your Broner will enter g",
    "start": "1302760",
    "end": "1311360"
  },
  {
    "text": "mode g mode then you can do anything wrong program read write local",
    "start": "1311360",
    "end": "1319440"
  },
  {
    "text": "profile yeah you can do anything just one",
    "start": "1319440",
    "end": "1325919"
  },
  {
    "text": "bite since we can uh read and write any",
    "start": "1339320",
    "end": "1346440"
  },
  {
    "text": "memories just like a uh I say in in the",
    "start": "1346440",
    "end": "1351840"
  },
  {
    "text": "pr uh yeah just like to use the jpr 9",
    "start": "1351840",
    "end": "1361520"
  },
  {
    "text": "module yeah we can read and write any memories so we can find this vital point",
    "start": "1361520",
    "end": "1370360"
  },
  {
    "text": "and overwrite it so we got a god mode IE",
    "start": "1370360",
    "end": "1376840"
  },
  {
    "text": "yeah",
    "start": "1376840",
    "end": "1379840"
  },
  {
    "text": "but if you really want to do that there are more",
    "start": "1382880",
    "end": "1388200"
  },
  {
    "text": "puzzles uh how to locate the J script",
    "start": "1388200",
    "end": "1394158"
  },
  {
    "text": "object how to read J script object when its address is lower than the corrupt",
    "start": "1394679",
    "end": "1403559"
  },
  {
    "text": "bstr and on uh J 9 in",
    "start": "1406080",
    "end": "1411400"
  },
  {
    "text": "i1 safe mode is well protected how to byass that",
    "start": "1411400",
    "end": "1419520"
  },
  {
    "text": "protect yeah this these all the",
    "start": "1419840",
    "end": "1424400"
  },
  {
    "text": "puzzles and even if you solve all the problems and",
    "start": "1426720",
    "end": "1433200"
  },
  {
    "text": "finally run a program you still have to to deal with",
    "start": "1433200",
    "end": "1441200"
  },
  {
    "text": "this there will there will be an alert window we don't like alert",
    "start": "1442799",
    "end": "1450240"
  },
  {
    "text": "window",
    "start": "1450240",
    "end": "1453240"
  },
  {
    "text": "yeah I only have 15 minutes so I can't present all this",
    "start": "1457799",
    "end": "1463000"
  },
  {
    "text": "technique uh but I really want to talk about the last puzle yeah this this",
    "start": "1463000",
    "end": "1469880"
  },
  {
    "text": "one uh that alert window is my favorite yeah it's really",
    "start": "1469880",
    "end": "1477158"
  },
  {
    "start": "1480000",
    "end": "1480000"
  },
  {
    "text": "tricky let's see how to resolve the",
    "start": "1480080",
    "end": "1485120"
  },
  {
    "text": "puzzle first we download a a library a",
    "start": "1485440",
    "end": "1493000"
  },
  {
    "text": "library our troan library yeah we use the some some the the the",
    "start": "1493000",
    "end": "1501399"
  },
  {
    "text": "XML object or the image tag or any any",
    "start": "1501399",
    "end": "1507919"
  },
  {
    "text": "other method the file will be saved in the",
    "start": "1507919",
    "end": "1513000"
  },
  {
    "text": "catch the the the catch directory since we are already in god",
    "start": "1513000",
    "end": "1519640"
  },
  {
    "text": "mode we can invoke any object so we use",
    "start": "1519640",
    "end": "1524760"
  },
  {
    "text": "fso to search the catch directory to find that to find that",
    "start": "1524760",
    "end": "1532240"
  },
  {
    "text": "Library yeah that's the second step and then we",
    "start": "1532240",
    "end": "1540320"
  },
  {
    "text": "use fso to create a directory named",
    "start": "1540320",
    "end": "1545360"
  },
  {
    "text": "system 32 that's our fake system",
    "start": "1545360",
    "end": "1551000"
  },
  {
    "text": "32 and copy the library to that directory and named it named the libr",
    "start": "1551000",
    "end": "1559039"
  },
  {
    "text": "as Shell Shell 32",
    "start": "1559039",
    "end": "1564600"
  },
  {
    "text": "yeah now we modify modify the system root system root",
    "start": "1564600",
    "end": "1572640"
  },
  {
    "text": "environment uh V variable to the upper to the upper directory of the Fig system",
    "start": "1572640",
    "end": "1580880"
  },
  {
    "text": "32 we just created the last step is",
    "start": "1580880",
    "end": "1589320"
  },
  {
    "text": "creating shell application object yeah to trigger trigger to",
    "start": "1589320",
    "end": "1596279"
  },
  {
    "text": "loading our fake shell 32",
    "start": "1596279",
    "end": "1601760"
  },
  {
    "text": "Library that's how how we load the library with script am I clear",
    "start": "1602840",
    "end": "1611000"
  },
  {
    "text": "yeah simply uh",
    "start": "1611000",
    "end": "1616200"
  },
  {
    "text": "we we force the uh IE to think",
    "start": "1616200",
    "end": "1622600"
  },
  {
    "text": "about the system rout the system root directory is our fake",
    "start": "1622600",
    "end": "1631559"
  },
  {
    "text": "directory so when the IE want to load some uh",
    "start": "1631559",
    "end": "1637480"
  },
  {
    "text": "Library they just uh uh find from from our fake",
    "start": "1637480",
    "end": "1643640"
  },
  {
    "text": "directory yeah",
    "start": "1643640",
    "end": "1647640"
  },
  {
    "text": "and the load library is is smoothly no no alert",
    "start": "1652840",
    "end": "1659159"
  },
  {
    "text": "window",
    "start": "1659159",
    "end": "1662159"
  },
  {
    "text": "yeah what vital Point strike is very",
    "start": "1668240",
    "end": "1673360"
  },
  {
    "text": "Universal it work from old times to Modern Times",
    "start": "1673360",
    "end": "1680120"
  },
  {
    "text": "uh I think it maybe work on Windows uh 98 and ie5",
    "start": "1680720",
    "end": "1690320"
  },
  {
    "text": "yeah and it even don't need any native Shell",
    "start": "1690320",
    "end": "1696080"
  },
  {
    "text": "Code just script just script this is",
    "start": "1696080",
    "end": "1701519"
  },
  {
    "text": "cool but there is something more fantastic",
    "start": "1701519",
    "end": "1707320"
  },
  {
    "text": "interdimensional execution sorry I really enjoy naming",
    "start": "1712200",
    "end": "1718679"
  },
  {
    "text": "things",
    "start": "1718679",
    "end": "1721679"
  },
  {
    "text": "yeah since we already can uh read any",
    "start": "1729880",
    "end": "1735159"
  },
  {
    "text": "memory so we can create some really cool JavaScript functions like",
    "start": "1735159",
    "end": "1741559"
  },
  {
    "text": "this yeah like this even on the",
    "start": "1741559",
    "end": "1747080"
  },
  {
    "text": "asrr module address is aligned so we can find the base address of the module from",
    "start": "1747080",
    "end": "1756039"
  },
  {
    "text": "any pointer like this you see",
    "start": "1756039",
    "end": "1761760"
  },
  {
    "text": "that 5 a 4 d I already know what five a",
    "start": "1761760",
    "end": "1770399"
  },
  {
    "text": "4D that that that's the uh data in the P head in P head and we use another value",
    "start": "1778880",
    "end": "1787200"
  },
  {
    "text": "in P head to make it double",
    "start": "1787200",
    "end": "1791799"
  },
  {
    "text": "accurate with this function uh we can make any pointer in",
    "start": "1796120",
    "end": "1805240"
  },
  {
    "text": "memory to become a modu base based",
    "start": "1805240",
    "end": "1810440"
  },
  {
    "text": "address",
    "start": "1810440",
    "end": "1813440"
  },
  {
    "text": "yeah when we got a modules based address but this module is not we",
    "start": "1817720",
    "end": "1826640"
  },
  {
    "text": "want we can use that function to find out any module",
    "start": "1826640",
    "end": "1832640"
  },
  {
    "text": "in the import table like a kernel",
    "start": "1832640",
    "end": "1838840"
  },
  {
    "text": "32 yeah we this this function we all read read read a modules import table and",
    "start": "1840279",
    "end": "1849039"
  },
  {
    "text": "find out we we needed another another modu yeah",
    "start": "1849039",
    "end": "1857960"
  },
  {
    "text": "it's quite simple you just put uh put the first module Base address",
    "start": "1859279",
    "end": "1868639"
  },
  {
    "text": "here and put the modu name you wanted",
    "start": "1868639",
    "end": "1874039"
  },
  {
    "text": "here",
    "start": "1874039",
    "end": "1877039"
  },
  {
    "start": "1883000",
    "end": "1883000"
  },
  {
    "text": "yeah and get prod address yeah we can can create a JavaScript version get",
    "start": "1883039",
    "end": "1891440"
  },
  {
    "text": "proog address to get any API from any",
    "start": "1891440",
    "end": "1898120"
  },
  {
    "text": "module all those can be done by just",
    "start": "1898120",
    "end": "1904919"
  },
  {
    "text": "JavaScript yeah we can we can read the P data certainly we can do this",
    "start": "1905000",
    "end": "1914000"
  },
  {
    "text": "Now by working through import tables and",
    "start": "1918840",
    "end": "1924320"
  },
  {
    "text": "JavaScript version get Pro address we can get almost any",
    "start": "1924320",
    "end": "1931000"
  },
  {
    "text": "API from any",
    "start": "1931000",
    "end": "1934760"
  },
  {
    "text": "model then we can do this in JavaScript like in",
    "start": "1936279",
    "end": "1942440"
  },
  {
    "text": "C this this code seems really like c h",
    "start": "1942440",
    "end": "1948679"
  },
  {
    "text": "but it's",
    "start": "1948679",
    "end": "1951200"
  },
  {
    "text": "JavaScript uh this is some pointer it's",
    "start": "1956159",
    "end": "1961519"
  },
  {
    "text": "uh object address we just uh uh pick it",
    "start": "1961519",
    "end": "1968000"
  },
  {
    "text": "and",
    "start": "1968000",
    "end": "1970480"
  },
  {
    "text": "uh we we got the just script",
    "start": "1973080",
    "end": "1980960"
  },
  {
    "text": "n we got this uh the we got jrip n modu",
    "start": "1981039",
    "end": "1988760"
  },
  {
    "text": "based address from J script object to pointer address yeah and uh almost any",
    "start": "1988760",
    "end": "1997840"
  },
  {
    "text": "module import kernel 32 so we certainly can get modu",
    "start": "1997840",
    "end": "2005240"
  },
  {
    "text": "from import we use get modu uh get modu from import",
    "start": "2005240",
    "end": "2010760"
  },
  {
    "text": "function to get a kernel 32 Base address from JT",
    "start": "2010760",
    "end": "2018639"
  },
  {
    "text": "9 and we also get NTD from kernel",
    "start": "2018639",
    "end": "2025600"
  },
  {
    "text": "32 yeah and the vertic",
    "start": "2025720",
    "end": "2031159"
  },
  {
    "text": "protect the wing ex EC the these two this two API are are uh",
    "start": "2031159",
    "end": "2040200"
  },
  {
    "text": "familiar and reasonable but why n",
    "start": "2040200",
    "end": "2046039"
  },
  {
    "text": "continue why and",
    "start": "2046039",
    "end": "2049638"
  },
  {
    "text": "continue anti continue is a powerful native API for uh explo writer yeah uh",
    "start": "2054639",
    "end": "2065280"
  },
  {
    "text": "it can fully control all all the registers including ESP and",
    "start": "2065280",
    "end": "2074839"
  },
  {
    "text": "EIP another good news is the value of the second",
    "start": "2074839",
    "end": "2081280"
  },
  {
    "text": "parameter does not important you can you can just set any value or or you",
    "start": "2081280",
    "end": "2091118"
  },
  {
    "text": "just ignore it we just need to set the first",
    "start": "2091119",
    "end": "2096960"
  },
  {
    "text": "parameter",
    "start": "2096960",
    "end": "2099640"
  },
  {
    "text": "yeah yeah we just need to set this this is not",
    "start": "2103440",
    "end": "2109520"
  },
  {
    "text": "important",
    "start": "2109520",
    "end": "2112520"
  },
  {
    "text": "yeah the first parameter is a structure include uh every",
    "start": "2121920",
    "end": "2128599"
  },
  {
    "text": "register and a Flags we can find this in",
    "start": "2128599",
    "end": "2135079"
  },
  {
    "text": "msdn this is the flags the flags and uh these are the",
    "start": "2135079",
    "end": "2144280"
  },
  {
    "text": "registers okay let's put this together and see what could we do",
    "start": "2147480",
    "end": "2155838"
  },
  {
    "start": "2156000",
    "end": "2156000"
  },
  {
    "text": "when we do any object uh operation in",
    "start": "2160760",
    "end": "2166720"
  },
  {
    "text": "JavaScript it will trigger at least one native call and the object itself will be",
    "start": "2166720",
    "end": "2174760"
  },
  {
    "text": "pushed to the stake as the first parameter the first number of almost all",
    "start": "2174760",
    "end": "2183200"
  },
  {
    "text": "object are a function pointer table like this array",
    "start": "2183200",
    "end": "2191240"
  },
  {
    "text": "object this is this is uh our array",
    "start": "2193200",
    "end": "2198599"
  },
  {
    "text": "object this is a function table yeah this is a function",
    "start": "2198599",
    "end": "2206400"
  },
  {
    "text": "table when we do some obervation we do some",
    "start": "2208319",
    "end": "2214520"
  },
  {
    "text": "operation to the array that will trigger a function pointer",
    "start": "2214520",
    "end": "2223400"
  },
  {
    "text": "call yeah and we can",
    "start": "2223400",
    "end": "2231280"
  },
  {
    "text": "see this address is the",
    "start": "2231280",
    "end": "2236640"
  },
  {
    "text": "object yeah is in the",
    "start": "2236640",
    "end": "2241920"
  },
  {
    "text": "ESP yeah this is the first parameter",
    "start": "2241920",
    "end": "2248680"
  },
  {
    "text": "so uh we can call any",
    "start": "2257960",
    "end": "2265000"
  },
  {
    "text": "function we can call any function by rewriting the function pointer",
    "start": "2265000",
    "end": "2272480"
  },
  {
    "text": "table yeah since we can we can write any",
    "start": "2272480",
    "end": "2278359"
  },
  {
    "text": "address yeah of course we can change this we can change",
    "start": "2278359",
    "end": "2284960"
  },
  {
    "text": "this so we can call any function by rewriting the function pointer table and",
    "start": "2289520",
    "end": "2296160"
  },
  {
    "text": "uh most of the data in the first parameter almost can be",
    "start": "2296160",
    "end": "2302000"
  },
  {
    "text": "controlled yeah I mean this this the first",
    "start": "2302000",
    "end": "2311280"
  },
  {
    "text": "parameter the first parameter is the object every bite we can rewrite",
    "start": "2311280",
    "end": "2320760"
  },
  {
    "text": "it yeah and we put anti anti continue in a",
    "start": "2325200",
    "end": "2331520"
  },
  {
    "text": "fake object function pointer table this",
    "start": "2331520",
    "end": "2339400"
  },
  {
    "text": "this yeah and the overwrite the object date",
    "start": "2339400",
    "end": "2347800"
  },
  {
    "text": "to thread context",
    "start": "2347800",
    "end": "2351839"
  },
  {
    "text": "structure then we can call any function with any parameters by controlling the",
    "start": "2354040",
    "end": "2361520"
  },
  {
    "text": "EIP and ESP because we use the object it itself",
    "start": "2361520",
    "end": "2369040"
  },
  {
    "text": "as a parameter of an continue so the first member in thread",
    "start": "2369040",
    "end": "2376280"
  },
  {
    "text": "context that is uh context",
    "start": "2376280",
    "end": "2381640"
  },
  {
    "text": "Flags see this e ax X",
    "start": "2383880",
    "end": "2389160"
  },
  {
    "text": "here it is a function table and it's also our",
    "start": "2389160",
    "end": "2399520"
  },
  {
    "text": "flags yeah that's one stone two birds",
    "start": "2399520",
    "end": "2407079"
  },
  {
    "text": "yeah let's make it more clear this is the fake thread",
    "start": "2418560",
    "end": "2426119"
  },
  {
    "text": "context yeah",
    "start": "2426119",
    "end": "2429318"
  },
  {
    "text": "our fake context uh here is the",
    "start": "2431720",
    "end": "2439720"
  },
  {
    "text": "ESP in this case we set e to the vertual vertual",
    "start": "2440800",
    "end": "2446720"
  },
  {
    "text": "protect and set ESP to a faked stake in this fixed stake frame the",
    "start": "2446720",
    "end": "2455160"
  },
  {
    "text": "return address is point to our Shell Code so when anti continue is executed",
    "start": "2455160",
    "end": "2463599"
  },
  {
    "text": "vertual protect will reset the Shell Code memory uh",
    "start": "2463599",
    "end": "2469839"
  },
  {
    "text": "ATT uh attribute attribute and return to",
    "start": "2469839",
    "end": "2476599"
  },
  {
    "text": "execute and since we already know the Shell Code address and we have",
    "start": "2476599",
    "end": "2482119"
  },
  {
    "text": "JavaScript version get proc address and those functions",
    "start": "2482119",
    "end": "2487800"
  },
  {
    "text": "so the native Shell Code do not need get PC or read",
    "start": "2487800",
    "end": "2494839"
  },
  {
    "text": "PEB we can do this in",
    "start": "2494839",
    "end": "2499119"
  },
  {
    "text": "JavaScript so this kind of Shell Code may be difficult to detect and",
    "start": "2501040",
    "end": "2510200"
  },
  {
    "text": "identify yeah let's see this is the meaning of",
    "start": "2510200",
    "end": "2518440"
  },
  {
    "text": "interdimensional native Dimension and script Dimension they can communicate",
    "start": "2518440",
    "end": "2525160"
  },
  {
    "text": "with each other and work",
    "start": "2525160",
    "end": "2529000"
  },
  {
    "text": "together we use script to get our API",
    "start": "2530760",
    "end": "2537560"
  },
  {
    "text": "address and uh set them to to to Native",
    "start": "2537560",
    "end": "2542720"
  },
  {
    "text": "Shell Code yeah",
    "start": "2542720",
    "end": "2547720"
  },
  {
    "text": "and most of the Native Shell Code can written can can write by C like this put all the pointer in a",
    "start": "2556880",
    "end": "2566400"
  },
  {
    "text": "table and use JavaScript to get those pointer whatever how big is the Shell",
    "start": "2566400",
    "end": "2575400"
  },
  {
    "text": "Code just need one assembly code to set the EBP to the pointer table",
    "start": "2575400",
    "end": "2582880"
  },
  {
    "text": "created by",
    "start": "2582880",
    "end": "2585838"
  },
  {
    "text": "JavaScript this is the finally native Shell Code really",
    "start": "2592680",
    "end": "2597960"
  },
  {
    "start": "2593000",
    "end": "2593000"
  },
  {
    "text": "tiny yeah see this this is our only assembly",
    "start": "2597960",
    "end": "2606160"
  },
  {
    "text": "code",
    "start": "2606160",
    "end": "2609119"
  },
  {
    "text": "this is the the Shell",
    "start": "2612119",
    "end": "2615240"
  },
  {
    "start": "2620000",
    "end": "2620000"
  },
  {
    "text": "Code now put the native code and JavaScript code",
    "start": "2620280",
    "end": "2625839"
  },
  {
    "text": "together we got this interdimensional code the J the the script will get all",
    "start": "2625839",
    "end": "2633760"
  },
  {
    "text": "pointer we needed and give it to the native Shell Code and then use any continue to",
    "start": "2633760",
    "end": "2642400"
  },
  {
    "text": "execute",
    "start": "2642400",
    "end": "2644960"
  },
  {
    "start": "2651000",
    "end": "2651000"
  },
  {
    "text": "it interdimensional execution is uh little bit like Roop but totally",
    "start": "2652599",
    "end": "2659760"
  },
  {
    "text": "not we don't need any fixed things so it is incredible",
    "start": "2659760",
    "end": "2667800"
  },
  {
    "text": "Universal and uh it not only can be used in",
    "start": "2667800",
    "end": "2675079"
  },
  {
    "text": "IE and not only can be used in",
    "start": "2675079",
    "end": "2680119"
  },
  {
    "text": "Windows that's what I mean write Once Upon",
    "start": "2680119",
    "end": "2685760"
  },
  {
    "text": "anywhere",
    "start": "2685760",
    "end": "2688760"
  },
  {
    "text": "yeah uh I I I have uh write an exploit",
    "start": "2691599",
    "end": "2697599"
  },
  {
    "text": "in Windows 7 and without",
    "start": "2697599",
    "end": "2702720"
  },
  {
    "text": "any modify it will uh it work it work good",
    "start": "2702720",
    "end": "2709599"
  },
  {
    "text": "on Windows 8 yeah that that's right once",
    "start": "2709599",
    "end": "2715280"
  },
  {
    "text": "P",
    "start": "2715280",
    "end": "2717640"
  },
  {
    "text": "anywhere I think it is like targets travel in different dimension do really",
    "start": "2721240",
    "end": "2727960"
  },
  {
    "text": "cool things vital Point strike and Inter",
    "start": "2727960",
    "end": "2735000"
  },
  {
    "text": "dimensional execution are different from traditional exploit technique make sure",
    "start": "2735000",
    "end": "2741720"
  },
  {
    "text": "your AP detection system can handle",
    "start": "2741720",
    "end": "2746520"
  },
  {
    "text": "them and I uh always like use this slide",
    "start": "2747800",
    "end": "2753240"
  },
  {
    "text": "to end my presentation 2000 years ago Kus said",
    "start": "2753240",
    "end": "2760319"
  },
  {
    "text": "while you do not know life how can you know about death and",
    "start": "2760319",
    "end": "2766640"
  },
  {
    "text": "similarly while you do not know attack how can you know about defense agent",
    "start": "2766640",
    "end": "2774280"
  },
  {
    "text": "Smith said okay uh that is",
    "start": "2774280",
    "end": "2780079"
  },
  {
    "text": "all any question",
    "start": "2780079",
    "end": "2784520"
  },
  {
    "text": "[Applause]",
    "start": "2786460",
    "end": "2796869"
  },
  {
    "text": "no question okay",
    "start": "2798000",
    "end": "2801800"
  },
  {
    "text": "[Music]",
    "start": "2814000",
    "end": "2822459"
  },
  {
    "text": "what what Primitives are necessary in order to be able to do the interdimensional execution what the",
    "start": "2827920",
    "end": "2833800"
  },
  {
    "text": "vulnerability kind of kind of Primitives so arbitrary read and arbitrary write is",
    "start": "2833800",
    "end": "2838880"
  },
  {
    "text": "there anything else that's necessary uh just I as I say we need a rewriting",
    "start": "2838880",
    "end": "2847559"
  },
  {
    "text": "UF or other vulnerability which can rewrite some address",
    "start": "2847559",
    "end": "2855720"
  },
  {
    "text": "yeah um hi good talk thank you so I have a question so um um do you have any",
    "start": "2857319",
    "end": "2863319"
  },
  {
    "text": "ideas of Defending against vital Point strike and interdimensional execution thank you of course uh",
    "start": "2863319",
    "end": "2873599"
  },
  {
    "text": "yeah let's see about uh",
    "start": "2882520",
    "end": "2887480"
  },
  {
    "text": "this",
    "start": "2890920",
    "end": "2893920"
  },
  {
    "text": "yeah actually there some there is some key in",
    "start": "2899200",
    "end": "2905079"
  },
  {
    "text": "the interdimensional",
    "start": "2905079",
    "end": "2908359"
  },
  {
    "text": "execution like anti continue like anti",
    "start": "2911240",
    "end": "2916800"
  },
  {
    "text": "continue did you did you find the we we we we the anti continue parameters we we",
    "start": "2917440",
    "end": "2925640"
  },
  {
    "text": "we send to anue is really strange that's that's unusual we we can",
    "start": "2925640",
    "end": "2934599"
  },
  {
    "text": "check this key point yeah and",
    "start": "2934599",
    "end": "2940559"
  },
  {
    "text": "uh yeah and the vital Point",
    "start": "2940760",
    "end": "2947160"
  },
  {
    "text": "Dr see we need to use some uh",
    "start": "2951440",
    "end": "2960319"
  },
  {
    "text": "object which should not be in",
    "start": "2960400",
    "end": "2965440"
  },
  {
    "text": "IE yeah we can detect this",
    "start": "2965440",
    "end": "2971680"
  },
  {
    "text": "yeah",
    "start": "2971680",
    "end": "2974680"
  },
  {
    "text": "okay okay thank you guys [Applause]",
    "start": "2980359",
    "end": "2987499"
  }
]