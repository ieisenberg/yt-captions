[
  {
    "start": "0",
    "end": "23000"
  },
  {
    "text": "okay so it's 5 o'cl we're going to get started my name is Jake Williams I work with a CSR group this is a drop smack",
    "start": "199",
    "end": "6560"
  },
  {
    "text": "how Cloud synchronization Services render your corporate firewall worthless so black hat requires us to",
    "start": "6560",
    "end": "13839"
  },
  {
    "text": "actually tell you to please complete the speaker feedback because they care right and I'm sure they really do so please",
    "start": "13839",
    "end": "19400"
  },
  {
    "text": "complete the fe uh speaker feedback surveys so so why trust me right uh well",
    "start": "19400",
    "end": "26279"
  },
  {
    "start": "23000",
    "end": "75000"
  },
  {
    "text": "I've got more than a decade of work in systems engineering malware reverse engineering most importantly forensics",
    "start": "26279",
    "end": "31720"
  },
  {
    "text": "I'm doing a lot of PhD level research uh looking at techniques for botn net detection uh won the DC3 forensics",
    "start": "31720",
    "end": "38399"
  },
  {
    "text": "challenge twice in a row rock on love DC3 uh last summer I had the uh",
    "start": "38399",
    "end": "43719"
  },
  {
    "text": "opportunity to develop a cloud sorry develop a course on cloud forensics wow uh this is a wide open",
    "start": "43719",
    "end": "51399"
  },
  {
    "text": "field as far as the forensics and security of our of our Cloud providers and it's amazing how many people are",
    "start": "51399",
    "end": "56559"
  },
  {
    "text": "moving to the cloud for security and I think it's just the opposite uh I've had",
    "start": "56559",
    "end": "61600"
  },
  {
    "text": "a lot of time to research this I'm working with Sans right now we're redeveloping I guess a a much larger",
    "start": "61600",
    "end": "67600"
  },
  {
    "text": "much larger course that won't be internal hopefully that'll come out this summer so if you're interested in Cloud forensics stick on the Sands",
    "start": "67600",
    "end": "74960"
  },
  {
    "text": "website what's this going to be about well in case you're in the wrong room Dan Kaminsky is probably speaking somewhere else right now I was told he's",
    "start": "74960",
    "end": "81680"
  },
  {
    "start": "75000",
    "end": "134000"
  },
  {
    "text": "not at this conference but usually it seems like every black hat he's speaking somewhere and with my luck he'd be opposite me uh but really we're going to",
    "start": "81680",
    "end": "88640"
  },
  {
    "text": "look at Cloud synchronization services like Dropbox basically when I look at a synchronization service I'm talking",
    "start": "88640",
    "end": "94119"
  },
  {
    "text": "about anything where you drop a file on a machine it uploads to the cloud and that automatically synchronizes to other",
    "start": "94119",
    "end": "100720"
  },
  {
    "text": "devices uh sounds like a great user convenience thing uh but not so much I mean it it it introduces its own",
    "start": "100720",
    "end": "107079"
  },
  {
    "text": "security risks so we're going to talk about how to use Dropbox to own a protected corporate Network completely bypassing the network defenses and I'll",
    "start": "107079",
    "end": "114119"
  },
  {
    "text": "introduce some uh malware or pen testing tool depending on which side of the fence you sit on you could use it as a",
    "start": "114119",
    "end": "119560"
  },
  {
    "text": "pen testing tool certainly it can be a framework for malware although uh you know from a legal standpoint I'm not",
    "start": "119560",
    "end": "125520"
  },
  {
    "text": "suggesting that anybody us this for malware or exfiltration and then we'll look at some potential ideas of how to",
    "start": "125520",
    "end": "130920"
  },
  {
    "text": "stop somebody from doing it to you so big disclaimer because I really",
    "start": "130920",
    "end": "136920"
  },
  {
    "start": "134000",
    "end": "226000"
  },
  {
    "text": "really really don't want to get sued um really don't want to get sued I'm picking on Dropbox in this research the",
    "start": "136920",
    "end": "143200"
  },
  {
    "text": "proof of concept implant or malware code pen testing tool whatever you want to call it uh it uses Dropbox",
    "start": "143200",
    "end": "151720"
  },
  {
    "text": "we're picking on Dropbox because of the Coca-Cola of file synchronization Services right I could talk to you about spyer Oak I could talk you about box.net",
    "start": "151879",
    "end": "158879"
  },
  {
    "text": "or any number of dozens of other Cloud synchronization providers but bu a long",
    "start": "158879",
    "end": "164120"
  },
  {
    "text": "shot Dropbox is is the most common Dropbox is providing a command and control Channel by Design This isn't",
    "start": "164120",
    "end": "170480"
  },
  {
    "text": "something that Dropbox can go fix uh By Design when you install Dropbox you are creating a channel it's exactly what you",
    "start": "170480",
    "end": "176480"
  },
  {
    "text": "wanted to do it synchronizes files to the cloud and then ultimately back to any other device you have configured on",
    "start": "176480",
    "end": "182159"
  },
  {
    "text": "the account it just does it uh anything that I'm demoing here with Dropbox can",
    "start": "182159",
    "end": "187560"
  },
  {
    "text": "be done much more easily to every other product that I tested so I'll talk a little bit more about why Dropbox is a",
    "start": "187560",
    "end": "194120"
  },
  {
    "text": "little bit more secure actually than some of the others uh basically the point here being that being is that this",
    "start": "194120",
    "end": "199239"
  },
  {
    "text": "is the most secure by a long shot right so it's only easier for any other basically again any other",
    "start": "199239",
    "end": "205040"
  },
  {
    "text": "synchronization service that we tested I am not releasing a zero day attack here I cannot stress that uh strongly enough",
    "start": "205040",
    "end": "212159"
  },
  {
    "text": "uh not releasing a zero day attack here I'm sure that somebody somebody somewhere is going to blog that indeed",
    "start": "212159",
    "end": "218080"
  },
  {
    "text": "you know some guy hacked Dropbox yay right zero day in Dropbox I see the guy in the front row taking it on right now",
    "start": "218080",
    "end": "224120"
  },
  {
    "text": "I appreciate it thank you sir so Cloud synchronization right it implies more than just online backup you place a file",
    "start": "224120",
    "end": "230640"
  },
  {
    "start": "226000",
    "end": "302000"
  },
  {
    "text": "in a folder on any participating machine it gets synchronized to all machines via the cloud right we're playing buzzword",
    "start": "230640",
    "end": "236840"
  },
  {
    "text": "bingo by the way too going I get five buzzwords in here somebody yell Bingo all right so infecting files destined",
    "start": "236840",
    "end": "243560"
  },
  {
    "text": "for a backup site I think that would be really interesting too we're not getting command and control from that but you start thinking about cloud backup and",
    "start": "243560",
    "end": "249720"
  },
  {
    "text": "this is something that I've been thinking a lot about here if I'm a long-term adversary right a right that's",
    "start": "249720",
    "end": "255879"
  },
  {
    "text": "two for five right anybody's counting buzzwords there but the uh you you think about AP they want to get into that",
    "start": "255879",
    "end": "262000"
  },
  {
    "text": "backup solution uh it's a long I mean it shouldn't be a big secret right that they want to get into the backup",
    "start": "262000",
    "end": "267840"
  },
  {
    "text": "solution so that you restore the machine they already have infected files sitting on the backup solution PDFs documents",
    "start": "267840",
    "end": "273680"
  },
  {
    "text": "you name it uh again it would be great to get repeat infections from any given",
    "start": "273680",
    "end": "278720"
  },
  {
    "text": "single attack we're not going to be able to get command and control from that but as far as long-term uh thought processes",
    "start": "278720",
    "end": "284800"
  },
  {
    "text": "uh that's something that I'm looking at as far as how would we defend against it I mean I'm certainly not AP I would be standing up here going hey what I'm",
    "start": "284800",
    "end": "291000"
  },
  {
    "text": "looking at is ways to but really I think we need to think about how would we detect that short of scanning statically",
    "start": "291000",
    "end": "297759"
  },
  {
    "text": "scanning our files and I think we all know that's not going to work we use antivirus right",
    "start": "297759",
    "end": "303160"
  },
  {
    "start": "302000",
    "end": "444000"
  },
  {
    "text": "so Dropbox and their history of insecurity right again I'm picking on Dropbox uh because they've gotten the",
    "start": "303160",
    "end": "309199"
  },
  {
    "text": "most press again they're the Coca-Cola of file synchronization service I'm not saying Dropbox authentication is",
    "start": "309199",
    "end": "315240"
  },
  {
    "text": "horribly broken uh but but indeed several people did in 2011 we'll talk a little bit more about that later Dropbox",
    "start": "315240",
    "end": "321520"
  },
  {
    "text": "had an awesome no password Day in 2011 I don't know if any of you guys saw this but it was like free beer right and so",
    "start": "321520",
    "end": "327319"
  },
  {
    "text": "for somewhere in the neighborhood of 2 or 3 hours uh Dropbox didn't require a password at all",
    "start": "327319",
    "end": "333840"
  },
  {
    "text": "if you knew the unique ID of the user that uh not necessarily their email but Dropbox has a unique ID that does not",
    "start": "333840",
    "end": "340000"
  },
  {
    "text": "change per user you could access that user's account and download or upload files now of course Dropbox in their",
    "start": "340000",
    "end": "345960"
  },
  {
    "text": "wonderful uh you know PR campaign wrote a blog post and said hey we're going to be more careful about the way we commit",
    "start": "345960",
    "end": "351039"
  },
  {
    "text": "code from now on because when we roll that out that's uh that can be dangerous and so essentially they blamed it on",
    "start": "351039",
    "end": "357720"
  },
  {
    "text": "some insecure piece of code that they had pushed out out globally uh they said they fixed it within hours and anybody",
    "start": "357720",
    "end": "362880"
  },
  {
    "text": "that had any accounts with any anomalous activity was contacted immediately and so there was no actual damage from the",
    "start": "362880",
    "end": "369520"
  },
  {
    "text": "compromise right okay I have awesome beachfront property in Arizona that I'm more than willing to sell anybody here",
    "start": "369520",
    "end": "375759"
  },
  {
    "text": "if you believe that one too so how about mobile file metadata so Dropbox even",
    "start": "375759",
    "end": "381199"
  },
  {
    "text": "though they transmit your files securely just like all these file synchronization services do over",
    "start": "381199",
    "end": "386440"
  },
  {
    "text": "https uh for whatever reason on their mobile app application because you can synchronize your files to your iPhone to",
    "start": "386440",
    "end": "392400"
  },
  {
    "text": "your Android for whatever reason their mobile application was sending all the file metadata over HTTP rather than",
    "start": "392400",
    "end": "398520"
  },
  {
    "text": "https that was discovered back in 2011 so now if you picture these Wireless hotpots like a good old Starbucks or",
    "start": "398520",
    "end": "404599"
  },
  {
    "text": "airport uh now you're getting synchronization and mind you this doesn't have to start from the actual",
    "start": "404599",
    "end": "409639"
  },
  {
    "text": "mobile device right if this is the first time your mobile device is connected since you've synchronize something off of your laptop or your work PC or",
    "start": "409639",
    "end": "416639"
  },
  {
    "text": "whatever the case is it's up in the cloud but you don't have the most current version of it all of that metadata now is synchronizing back down",
    "start": "416639",
    "end": "422319"
  },
  {
    "text": "and it's in the clear to see again draw boxes obviously fix that why aren't there any other products up here uh",
    "start": "422319",
    "end": "429560"
  },
  {
    "text": "turns out nobody's looking at the lower tier providers not that I can find anyway uh we've been looking a lot of",
    "start": "429560",
    "end": "435960"
  },
  {
    "text": "these uh much more to come on uh the insecurity of file synchronization and some of the awesome things that you can",
    "start": "435960",
    "end": "441840"
  },
  {
    "text": "do with it but uh for this we had some foundational work so I have a pen",
    "start": "441840",
    "end": "447160"
  },
  {
    "text": "testing background and as I started doing this cloud fic course I thought hey you know it's really bad especially",
    "start": "447160",
    "end": "452840"
  },
  {
    "text": "in companies are employing mrtg or some type of bandwidth monitoring I really don't want to spike coming back to",
    "start": "452840",
    "end": "458360"
  },
  {
    "text": "whatever my bandwidth Spike coming back to whatever my command and control/ exfiltration server is I was thinking I",
    "start": "458360",
    "end": "464879"
  },
  {
    "text": "would like to use dropbox maybe I can surreptitiously install Dropbox you know in this case or some other",
    "start": "464879",
    "end": "470280"
  },
  {
    "text": "synchronization service something uses Amazon Amazon S3 and we can just exfiltrate stuff out to uh you know out",
    "start": "470280",
    "end": "476000"
  },
  {
    "text": "to that then it looks like it's traffic destined for S3 not spiking on my command and control server and uh",
    "start": "476000",
    "end": "482919"
  },
  {
    "text": "started looking a little bit more of that and it turns out it wasn't that original of an idea so several guys at a usix conference uh published the dark",
    "start": "482919",
    "end": "489560"
  },
  {
    "text": "clouds on the horizon paper they talked about the idea of using the uh file synchronization software for covert data",
    "start": "489560",
    "end": "496120"
  },
  {
    "text": "exfiltration they talked about a lot of other neat things too from a pen testing standpoint so I strongly recommend you",
    "start": "496120",
    "end": "501680"
  },
  {
    "text": "grab the paper it's out on the eix website couple guys named Frank McLean and Derrick Newton Then followed up and",
    "start": "501680",
    "end": "507800"
  },
  {
    "text": "these are the guys actually that said drop box authentication is horribly broken right their words not mine",
    "start": "507800",
    "end": "513640"
  },
  {
    "text": "apparently they independently researched this stuff as far as I can tell uh they talked about the database format and",
    "start": "513640",
    "end": "518680"
  },
  {
    "text": "they published all the details so on the back end Dropbox and most of these other file synchronization services use a SQL",
    "start": "518680",
    "end": "524680"
  },
  {
    "text": "like database to track which files have been synchronized which files haven't uh even even md5 sums of the files in some",
    "start": "524680",
    "end": "531760"
  },
  {
    "text": "cases for very large files they've even break up the file and give you section hashes for each say 200k of the file",
    "start": "531760",
    "end": "538000"
  },
  {
    "text": "from forensic standpoint I mean this this is a gold mine right if you're thinking about it from a pentest standpoint you can certainly uh you know",
    "start": "538000",
    "end": "544680"
  },
  {
    "text": "certainly can imagine if you've got a hold of this particular database maybe you have hashed creds I'll take the",
    "start": "544680",
    "end": "549880"
  },
  {
    "text": "maybe out of there you have hashed creds right and so now maybe you have a way to access the user's account without still",
    "start": "549880",
    "end": "555880"
  },
  {
    "text": "having access to uh to that machine so they published the details and Dropbox promptly changed them I mean like",
    "start": "555880",
    "end": "562399"
  },
  {
    "text": "immediately changed them so a couple of guys here Ru and Leo uh reverse",
    "start": "562399",
    "end": "567440"
  },
  {
    "text": "engineered in 2012 they are reverse engineer the Dropbox software to look at security so under the hood Dropbox uses",
    "start": "567440",
    "end": "572959"
  },
  {
    "text": "a python so it's essentially a compiled python but they build their own python interpreter this is pretty uh it's",
    "start": "572959",
    "end": "579720"
  },
  {
    "text": "pretty sneaky and so they're not the first people to do this but they build their own python interpreter they mash up all the python op codes and uh",
    "start": "579720",
    "end": "586959"
  },
  {
    "text": "basically it's to prevent you from decompiling the uh decompiling the python essentially and looking at the original or trying to get back to the",
    "start": "586959",
    "end": "593279"
  },
  {
    "text": "original python Source they actually go a little bit further though uh not only do they mash up all the op codes because",
    "start": "593279",
    "end": "598880"
  },
  {
    "text": "that's that's even fairly easy to get around they actually change all the marshalling format in the python Library so you",
    "start": "598880",
    "end": "604880"
  },
  {
    "text": "can't even unmarshal the code directly to review the op codes it's it's a real pain in the butt uh these guys Ruff and",
    "start": "604880",
    "end": "610240"
  },
  {
    "text": "Leo did some awesome work reverse engineered the Dropbox uh basically the Dropbox software they published some of",
    "start": "610240",
    "end": "616680"
  },
  {
    "text": "the internal details of how the database was now being built because Dropbox took the extraordinary step of encrypting and",
    "start": "616680",
    "end": "622320"
  },
  {
    "text": "they actually are encrypting with a commercial encryption Library uh encrypting the databases after the uh after the earlier work and so they",
    "start": "622320",
    "end": "628839"
  },
  {
    "text": "reverse engineered and they said hey here's how to decrypt these here's how to steal the hash credentials out so you can you know go on doing what we were",
    "start": "628839",
    "end": "634360"
  },
  {
    "text": "doing before and I mean within weeks Dropbox changed all the internal details",
    "start": "634360",
    "end": "639440"
  },
  {
    "text": "and I'm fairly confident that even if I publish details today I'm not but that if I do today they will change them",
    "start": "639440",
    "end": "645600"
  },
  {
    "text": "immediately again in fact even by me just being up here talking about you know some of the internals it won't surprise me at all if they again change",
    "start": "645600",
    "end": "651880"
  },
  {
    "text": "it again so long term I mean this is really just going to become a cat and mouse game if somebody wants to get into",
    "start": "651880",
    "end": "657399"
  },
  {
    "text": "the uh get into their database uh ultimately as we're all aware right if they're encrypting it and the user is",
    "start": "657399",
    "end": "662519"
  },
  {
    "text": "not typing a password when he logs in right it's freely available it's just not it's it's encrypted uh basically",
    "start": "662519",
    "end": "667959"
  },
  {
    "text": "when it's sitting at rest on the file system so let's talk a little bit about a little case study so we've got this",
    "start": "667959",
    "end": "674480"
  },
  {
    "start": "670000",
    "end": "701000"
  },
  {
    "text": "client massive Dynamic any of you guys Fringe fans out there no fringe yeah there we go so good old massive Dynamic",
    "start": "674480",
    "end": "681760"
  },
  {
    "text": "right and so I because I have to pick some company and uh basically they say no holds bar pin test act like a right",
    "start": "681760",
    "end": "688160"
  },
  {
    "text": "so no problem we got that covered look at a long engagement time but a completely completely black box right so",
    "start": "688160",
    "end": "693680"
  },
  {
    "text": "you can call this a pentest or you can look at this almost like the way I believe intrusions are probably",
    "start": "693680",
    "end": "699120"
  },
  {
    "text": "happening today right uh so look at standard methods right they fail web portals yeah noo right outdated patches",
    "start": "699120",
    "end": "706120"
  },
  {
    "start": "701000",
    "end": "726000"
  },
  {
    "text": "on public servers again nothing uh social engineering yeah maybe you get some basic it info but but we all know",
    "start": "706120",
    "end": "712040"
  },
  {
    "text": "the deal right I mean social engineering works a lot uh and then you know often times it gets cut short by these",
    "start": "712040",
    "end": "718480"
  },
  {
    "text": "wonderful employees who inform security and then everybody's on you know everybody's on alert right and so if you've got time to wait for that alert",
    "start": "718480",
    "end": "724600"
  },
  {
    "text": "to go down great if not find something else you know how to go to physical security this guy scares me right so if",
    "start": "724600",
    "end": "730399"
  },
  {
    "start": "726000",
    "end": "747000"
  },
  {
    "text": "you've got awesome armed security someplace don't got don't go and try to do a pen testing there right this guy",
    "start": "730399",
    "end": "735639"
  },
  {
    "text": "looks way way too jumpy as far as sort physical pen testing I love to jump the front counter steal the drive you know",
    "start": "735639",
    "end": "741880"
  },
  {
    "text": "grab the credentials and uh and get on the domain but uh but again that's not going to work in this",
    "start": "741880",
    "end": "747680"
  },
  {
    "start": "747000",
    "end": "800000"
  },
  {
    "text": "case how about spam right so again another thing we often try when we're doing pen testing you look at spam maybe",
    "start": "747680",
    "end": "754560"
  },
  {
    "text": "get some quick hits right in this scenario we'll say we got some quick hits by the way I love this little stop",
    "start": "754560",
    "end": "760120"
  },
  {
    "text": "the spam or we'll shoot the dog right but in some cases and I've had this in a",
    "start": "760120",
    "end": "765199"
  },
  {
    "text": "lot of my real world pentests I'll get some connections back but there's a decent content filtering firewall in",
    "start": "765199",
    "end": "770880"
  },
  {
    "text": "place so I'm seeing people click the link I've got stuff in the web blogs but anytime I actually try to send the",
    "start": "770880",
    "end": "776600"
  },
  {
    "text": "exploit down I'm getting stopped I never get to call back from the exploit right so there's something in the network and",
    "start": "776600",
    "end": "782120"
  },
  {
    "text": "so let's just start from that assumption there's something in the network that prevents us right from actually getting",
    "start": "782120",
    "end": "787920"
  },
  {
    "text": "a solid TCP connection command and control maybe uh you know again maybe we can get something via uh you know via",
    "start": "787920",
    "end": "794199"
  },
  {
    "text": "them clicking a link but again ultimately that's not not sustainable right so so time for Plan B right nope",
    "start": "794199",
    "end": "800720"
  },
  {
    "start": "800000",
    "end": "808000"
  },
  {
    "text": "not that plan B 25 bucks and a college campus vending machine they're not getting us out of out of any like",
    "start": "800720",
    "end": "805839"
  },
  {
    "text": "hardcore mess right so so how about this guy well it's not very uncommon you know",
    "start": "805839",
    "end": "811360"
  },
  {
    "text": "you start up and you look for uh your traveling salesman if you guys have done pentesting before you look for the",
    "start": "811360",
    "end": "816519"
  },
  {
    "text": "traveling salesmen the guys that are outside of corporate network security guys and also guys that you know are",
    "start": "816519",
    "end": "822519"
  },
  {
    "text": "going to have VPN access right because in some corporations not everybody has the VPN access so in this case we're",
    "start": "822519",
    "end": "828839"
  },
  {
    "text": "looking for this guy uh we find this guy's personal email address CU he's the CIO or whoever by the way I love hitting",
    "start": "828839",
    "end": "835000"
  },
  {
    "text": "the CIO and the CSO if you get a chance to hit anybody because they're the guys ultimately that are preaching security",
    "start": "835000",
    "end": "840120"
  },
  {
    "text": "left and right you know of all the people they just uh they're the best bu a long shot to hit because then they don't argue their pentest results so uh",
    "start": "840120",
    "end": "847800"
  },
  {
    "text": "we look at Facebook says hey he's organizing uh fundraising for his kids PTA I love exploiting somebody's kids to",
    "start": "847800",
    "end": "853800"
  },
  {
    "text": "own a Target to I mean call me call me ruthless call me bad but but again it's it's it's wonderful stuff so suppose",
    "start": "853800",
    "end": "860000"
  },
  {
    "text": "that we spam him at home right so we go after his uh go after again look at his home machine uh own the laptop start",
    "start": "860000",
    "end": "867000"
  },
  {
    "text": "looking for VPN software because that's what we do now next right we're on his laptop at home we know this guy doesn't",
    "start": "867000",
    "end": "872279"
  },
  {
    "text": "get to be a CIO right uh you know again by by not working uh you know 18 hours a",
    "start": "872279",
    "end": "877320"
  },
  {
    "text": "day whatever the case is but we find confidential corporate documents on a laptop okay clearly these aren't moving",
    "start": "877320",
    "end": "883240"
  },
  {
    "text": "by USB nobody's that dumb anymore I'm sure everybody has DLP Solutions in place on every major oh wait no um so",
    "start": "883240",
    "end": "890040"
  },
  {
    "text": "anyway we've got the confidential corporate documents on the laptop they have to be getting there",
    "start": "890040",
    "end": "896120"
  },
  {
    "text": "somehow and then we notice that all the company documents are in in the Dropbox folder and Dropbox study XE is in the",
    "start": "896120",
    "end": "902360"
  },
  {
    "text": "process list again picture we're on the laptop we're outside of the corporate Network right this I get into more",
    "start": "902360",
    "end": "907920"
  },
  {
    "text": "corporate networks this way from a pentesting standpoint than probably any other way again if they've got awesome",
    "start": "907920",
    "end": "913720"
  },
  {
    "text": "defenses you you hook them up at the hotel or where they're staying at if it's a road warrior or you catch them at",
    "start": "913720",
    "end": "919079"
  },
  {
    "text": "home again ultimately you're you're back into the corporate Network now we're getting somewhere so we pull the uh the",
    "start": "919079",
    "end": "925399"
  },
  {
    "text": "Dropbox databases see what we can see databases are encrypted we could reverse engineer the Dropbox software to read",
    "start": "925399",
    "end": "931920"
  },
  {
    "text": "the databases grab his credentials see what's even being stored out on the website because Dropbox backs everything",
    "start": "931920",
    "end": "938720"
  },
  {
    "text": "up to the web as well or maybe we could mimic his machine but ain't nobody got time for that and so I don't know if any",
    "start": "938720",
    "end": "945480"
  },
  {
    "start": "943000",
    "end": "969000"
  },
  {
    "text": "of you guys have seen this before but that's good old Sweet Brown and if you haven't seen that before and she says ain't nobody got time for that there's a",
    "start": "945480",
    "end": "951639"
  },
  {
    "text": "whole 45 second I don't have time to play it here but a whole 45 second awesome uh man for lack of any word uh",
    "start": "951639",
    "end": "960560"
  },
  {
    "text": "interview I guess it was actually a news interview and it's called sweet Browns Cold Pop Escape so again it's well worth",
    "start": "960560",
    "end": "965839"
  },
  {
    "text": "your time I'm sure from band with standpoint it'll never download here but but awesome so so where are we well what",
    "start": "965839",
    "end": "971880"
  },
  {
    "start": "969000",
    "end": "998000"
  },
  {
    "text": "do we have so far we have a way to send files over Dropbox to devices the CIO uses right or whoever the laptop owner",
    "start": "971880",
    "end": "978240"
  },
  {
    "text": "is in this case again he's our CIO we have a way to send those files over Dropbox and it's going to synchronize to",
    "start": "978240",
    "end": "984560"
  },
  {
    "text": "every device this guy uses what we would really like to have is a running implant now whatever it is that you call it with",
    "start": "984560",
    "end": "991120"
  },
  {
    "text": "command and control inside the corporate Network we want to be able to execute commands and exfiltrate data from inside",
    "start": "991120",
    "end": "997040"
  },
  {
    "text": "the corporate Network right so it's time to brainstorm and I brainstorm best with a little inebriation no lots of beer and",
    "start": "997040",
    "end": "1004120"
  },
  {
    "start": "998000",
    "end": "1008000"
  },
  {
    "text": "notice this guy smiling and I would be too if I had cases upon cases of beer behind me",
    "start": "1004120",
    "end": "1009880"
  },
  {
    "start": "1008000",
    "end": "1049000"
  },
  {
    "text": "so with a blood alcohol level it's a little bit High by the way what company was it was giving out the breathalyzers",
    "start": "1009880",
    "end": "1015519"
  },
  {
    "text": "here that was a brilliant uh you know brilliant little swag gift there but the uh ultimately figure out the Dropbox we",
    "start": "1015519",
    "end": "1022240"
  },
  {
    "text": "can use his existing Dropbox software to infect the internal Network and the rc2",
    "start": "1022240",
    "end": "1028959"
  },
  {
    "text": "channel so this is this only works if the CIO has Dropbox installed on his",
    "start": "1028959",
    "end": "1034079"
  },
  {
    "text": "corporate machine behind the firewall uh we have confidential corporate documents though we've got those in his Dropbox",
    "start": "1034079",
    "end": "1039400"
  },
  {
    "text": "synchronization folder uh that's a pretty good assumption then that he has Dropbox installed on the corporate",
    "start": "1039400",
    "end": "1045120"
  },
  {
    "text": "Network in fact that's our working theory of how these documents got on the laptop and the first place so what we",
    "start": "1045120",
    "end": "1050960"
  },
  {
    "start": "1049000",
    "end": "1089000"
  },
  {
    "text": "really need to do is write some new malware or a pen testing tool or whatever the lawyers prefer that we call",
    "start": "1050960",
    "end": "1056039"
  },
  {
    "text": "this so that I don't get sued right and so we could just deliver a standalone interpreter via Dropbox we could infect",
    "start": "1056039",
    "end": "1062760"
  },
  {
    "text": "a file send a standalone interpreter but let's not forget we tried standard approaches first and nothing else that",
    "start": "1062760",
    "end": "1068480"
  },
  {
    "text": "we delivered has been able to call out of the network and so delivering Standalone interpreter that creates a TCP connection out of the network",
    "start": "1068480",
    "end": "1075159"
  },
  {
    "text": "probably isn't going to work here either what we need is malware that can use Dropbox basically the Dropbox file sync",
    "start": "1075159",
    "end": "1081159"
  },
  {
    "text": "service instead of traditional network based C2 kind of like spies using a dead drop a drop yes I definitely intend the",
    "start": "1081159",
    "end": "1088320"
  },
  {
    "text": "pun there right so we created some little malware called drop smack and it's proof of concept Mal",
    "start": "1088320",
    "end": "1095039"
  },
  {
    "start": "1089000",
    "end": "1174000"
  },
  {
    "text": "where it's designed to use file synchronization by Dropbox for command and",
    "start": "1095039",
    "end": "1100600"
  },
  {
    "text": "control it's not really fast but Dropbox is getting better every day so when I",
    "start": "1100600",
    "end": "1106039"
  },
  {
    "text": "put this together about 4 months ago my average turnaround time so say I'm",
    "start": "1106039",
    "end": "1111600"
  },
  {
    "text": "pentesting you know out of Georgia where I live pentesting a client in Maryland which is a fairly common occurrents uh",
    "start": "1111600",
    "end": "1118559"
  },
  {
    "text": "we had synchronization time somewhere on the order of 1 to 2 minutes and uh today",
    "start": "1118559",
    "end": "1124280"
  },
  {
    "text": "tried it out and you know I'm going from Amsterdam back to the States uh VPN into a machine back there we have for test",
    "start": "1124280",
    "end": "1130200"
  },
  {
    "text": "and I had synchronization times on the order of 30 seconds or less and so this is getting faster and faster and faster",
    "start": "1130200",
    "end": "1136840"
  },
  {
    "text": "almost to the point where we might be able to Tunnel a connection somehow through uh you know through here and",
    "start": "1136840",
    "end": "1141880"
  },
  {
    "text": "we're looking at that as as future research so even without tunneling connections though we can certainly do",
    "start": "1141880",
    "end": "1147840"
  },
  {
    "text": "store and forward uh data exfiltration and command output they're sent by uh Dropbox synchronization again xfill",
    "start": "1147840",
    "end": "1154120"
  },
  {
    "text": "isn't that fast but Dropbox is making it faster and faster and faster and I love them for it right so again I want to",
    "start": "1154120",
    "end": "1160760"
  },
  {
    "text": "give mad props the Dropbox development team from a synchronization standpoint they're definitely the fastest so again",
    "start": "1160760",
    "end": "1166320"
  },
  {
    "text": "they're encrypting their databases good for them and they're making exfiltration awesomely fast again good for them I",
    "start": "1166320",
    "end": "1171840"
  },
  {
    "text": "mean service not exfiltration awesomely fast so how does this work well if you",
    "start": "1171840",
    "end": "1177000"
  },
  {
    "start": "1174000",
    "end": "1213000"
  },
  {
    "text": "prefer a picture basically we've got the guy's laptop at home and that's the local Dropbox share we've got our",
    "start": "1177000",
    "end": "1183200"
  },
  {
    "text": "Dropbox server which we don't control and we don't need to control again this is insecure or however you want to word",
    "start": "1183200",
    "end": "1188960"
  },
  {
    "text": "it by Design and then we have a remote Dropbox share again picture this inside the corporate network with all their wonderful defenses uh and again this is",
    "start": "1188960",
    "end": "1196280"
  },
  {
    "text": "uh basically anything that we synchronize or place on use your laptop at home and again realize that because",
    "start": "1196280",
    "end": "1201320"
  },
  {
    "text": "this is behind a Soho router we have a full uh TCP connection in this case so we have no problems at all controlling",
    "start": "1201320",
    "end": "1206960"
  },
  {
    "text": "this machine at will anything that we synchronize here is ultimately going to copy over onto his workstation at work",
    "start": "1206960",
    "end": "1213640"
  },
  {
    "start": "1213000",
    "end": "1280000"
  },
  {
    "text": "so what I use this for long-term use um not really right I would prefer not to use this longterm but once you have",
    "start": "1213640",
    "end": "1220799"
  },
  {
    "text": "bidirectional command and control you're no longer shooting in the dark I mean that's one of the hardest things when",
    "start": "1220799",
    "end": "1226280"
  },
  {
    "text": "you have some defenses in the pent test is figuring out what the those defenses are I mean picture the case where you",
    "start": "1226280",
    "end": "1231440"
  },
  {
    "text": "know you're able to go to the machine sit down start typing on the machine and troubleshoot why your stuff doesn't work",
    "start": "1231440",
    "end": "1237440"
  },
  {
    "text": "right it just moves that much faster and this is ultimately what that gives you it gives you a chance to infiltrate the data and exfiltrate basically query the",
    "start": "1237440",
    "end": "1244039"
  },
  {
    "text": "Box on the other side of the uh other side of the Dropbox server and ultimately get get answers back and that allows you to troubleshoot and and",
    "start": "1244039",
    "end": "1250640"
  },
  {
    "text": "hopefully then leave this entirely behind right again I would not want to use this for long-term use I couldn't be",
    "start": "1250640",
    "end": "1256000"
  },
  {
    "text": "any clearer about that uh but again anytime there able to observe results from failures that is a huge huge help",
    "start": "1256000",
    "end": "1262360"
  },
  {
    "text": "and we know that this guy gets traffic out of the network Dropbox is getting out of the network it's just a matter of",
    "start": "1262360",
    "end": "1267559"
  },
  {
    "text": "finding out what those defenses are and how traffic leaves the network right usually when I get blocked in one of",
    "start": "1267559",
    "end": "1272640"
  },
  {
    "text": "these cases I later find out that there's a proxy someplace and we're just not pointing at the proxy right so or",
    "start": "1272640",
    "end": "1278360"
  },
  {
    "text": "some type of authenticating proxy whatever the case is so put together small implant uh again it implements uh",
    "start": "1278360",
    "end": "1285559"
  },
  {
    "start": "1280000",
    "end": "1313000"
  },
  {
    "text": "some really really basic commands uh I you know put get delete execute sleep",
    "start": "1285559",
    "end": "1291480"
  },
  {
    "text": "and and move we we looked at adding more but this combination gets you everywhere that you need to go I mean there's",
    "start": "1291480",
    "end": "1297279"
  },
  {
    "text": "basically at the point that you have put get and execute you've got the full super set of commands you can build everything else with that um the other",
    "start": "1297279",
    "end": "1303919"
  },
  {
    "text": "stuff's just convenience because I got tired of of running a command to either move a file delete a file or hang on for",
    "start": "1303919",
    "end": "1309640"
  },
  {
    "text": "a minute to do tasking so well so how do you deploy this thing",
    "start": "1309640",
    "end": "1315480"
  },
  {
    "start": "1313000",
    "end": "1374000"
  },
  {
    "text": "well I can't do everything for you it turns out that there are some pretty General steps uh the first one is that I",
    "start": "1315480",
    "end": "1321840"
  },
  {
    "text": "usually embed uh drop smack we've used this in the pent test that we've done it on we'll embed drop smack in a file that",
    "start": "1321840",
    "end": "1327080"
  },
  {
    "text": "the victim has already synchronized this has a tremendous Advantage because the user thinks they wrote the",
    "start": "1327080",
    "end": "1334200"
  },
  {
    "text": "document right so again try try and let it sink in for a minute it's not like you're sending the user a document where",
    "start": "1334200",
    "end": "1340600"
  },
  {
    "text": "you know you say okay well you know hopefully they'll buy that the return address came from the CEO and they'll",
    "start": "1340600",
    "end": "1346080"
  },
  {
    "text": "click the document and certainly then they'll be owned this in this case case the user actually thinks they wrote the document or at least that they own the",
    "start": "1346080",
    "end": "1351720"
  },
  {
    "text": "document uh that there's nothing to be suspicious about uh we add some macro goodness uh like the uh like the metas",
    "start": "1351720",
    "end": "1358240"
  },
  {
    "text": "sploit or msf and code with the VB script works wonders uh we load the file back on the machine that they can access",
    "start": "1358240",
    "end": "1364600"
  },
  {
    "text": "and then the file automatically synchronizes all we have to do is wait for the victim to open the file on the",
    "start": "1364600",
    "end": "1369640"
  },
  {
    "text": "internal Network right so we could wait uh but ain't nobody got time for that",
    "start": "1369640",
    "end": "1375000"
  },
  {
    "start": "1374000",
    "end": "1404000"
  },
  {
    "text": "right and so so come back to social engineering your social engineering has to be much",
    "start": "1375000",
    "end": "1381200"
  },
  {
    "text": "more likely to succeed because you have tons of background information right you already know the file",
    "start": "1381200",
    "end": "1387440"
  },
  {
    "text": "contents the victim thinks they created the file it doesn't get any easier than that if you can't call the victim up",
    "start": "1387440",
    "end": "1394000"
  },
  {
    "text": "slend the victim an email SL whatever and get them to open the file get out of the business right there's there's no",
    "start": "1394000",
    "end": "1400279"
  },
  {
    "text": "social engineering here I me if you can't do this there's there's no hope right so let's look at some of the",
    "start": "1400279",
    "end": "1406520"
  },
  {
    "text": "commands I I've ended up using a pipe delay lier here because there are no pipes in Windows File names and that",
    "start": "1406520",
    "end": "1411679"
  },
  {
    "text": "seems to work very well so uh we look at uh basically being able to put a file in",
    "start": "1411679",
    "end": "1417919"
  },
  {
    "text": "this case uh we're going to do a local uh the local name is just the name of the file we don't put any path On It",
    "start": "1417919",
    "end": "1423400"
  },
  {
    "text": "ultimately that's going to be in the Dropbox synchronization folder in order to make this useful this is probably a",
    "start": "1423400",
    "end": "1428640"
  },
  {
    "text": "file that you uploaded right you probably don't want to move in this case uh put a file that they already had in their synchronization folder uh by the",
    "start": "1428640",
    "end": "1435640"
  },
  {
    "text": "way this automatically deletes the file inside of the Dropbox synchronization folder so so again in this case we might",
    "start": "1435640",
    "end": "1441440"
  },
  {
    "text": "uh say FG dump for instance we're very interested in grabbing the user's hashes maybe for some other follow on attack",
    "start": "1441440",
    "end": "1446919"
  },
  {
    "text": "and so you do a put FG dump and then you might write it to C Windows temp FG dump",
    "start": "1446919",
    "end": "1452000"
  },
  {
    "text": "uh so again it allows you to upload an executable but there's no actual requirement that you name it that inside",
    "start": "1452000",
    "end": "1458080"
  },
  {
    "text": "the synchronization folder in fact that would be really I don't know I I think that would be forensically bad because",
    "start": "1458080",
    "end": "1463320"
  },
  {
    "text": "the user actually gets a little pop-up bubble every time that a file gets sent with Dropbox and and I'll show you that",
    "start": "1463320",
    "end": "1468919"
  },
  {
    "text": "in a second here they get a little popup bubble and it'll say something like new file added FG dump. exe now yeah I'm not",
    "start": "1468919",
    "end": "1476880"
  },
  {
    "text": "that good at this but but I'm pretty sure that the user is going to you know at some point start to get suspicious about FG dump. exe uh but it turns out",
    "start": "1476880",
    "end": "1484279"
  },
  {
    "text": "that if you name it something uh like you know whatever reports. dooc for the trip through Dropbox Dropbox doesn't",
    "start": "1484279",
    "end": "1490520"
  },
  {
    "text": "complain at all about the file type being wrong for the file signature as far as I can tell they don't even",
    "start": "1490520",
    "end": "1495840"
  },
  {
    "text": "inspect it uh and so from a security stand point that uh that could certainly be improved upon uh but again you can",
    "start": "1495840",
    "end": "1502120"
  },
  {
    "text": "upload it as reports. dooc and then basically say to put it in C Windows temp or wherever it is that you like to",
    "start": "1502120",
    "end": "1507240"
  },
  {
    "text": "write uh write files bearing in mind of course that when we execute the put command it's executing in the context of",
    "start": "1507240",
    "end": "1513360"
  },
  {
    "text": "the user right because Dropbox is running under the user account so you can't do anything that the user can't do",
    "start": "1513360",
    "end": "1519200"
  },
  {
    "text": "right so from a writing standpoint if you're on a good old XP machine you can probably right to see Windows temp if",
    "start": "1519200",
    "end": "1524840"
  },
  {
    "text": "you're on a newer machine like a Vista or Windows 7 you're probably going to pop UAC so that's one of those things that you want to want to avoid of course",
    "start": "1524840",
    "end": "1531559"
  },
  {
    "text": "we all know that our users are going to click the UAC popup anyway uh I don't run into many users that don't but this",
    "start": "1531559",
    "end": "1537240"
  },
  {
    "text": "is ultimately again it's going to delete whatever that local file is out of the Dropbox synchronization folder because",
    "start": "1537240",
    "end": "1542360"
  },
  {
    "text": "the assumption is you don't need it anymore right you put it there it gets uploaded and then the put the put",
    "start": "1542360",
    "end": "1547559"
  },
  {
    "text": "command executes and so git is basically just the opposite of that again the remote name uh we're going to give it",
    "start": "1547559",
    "end": "1553520"
  },
  {
    "text": "the full path on dis and then we give it a local name that goes into the synchronization folder uh",
    "start": "1553520",
    "end": "1558840"
  },
  {
    "text": "again a local name doesn't specify a path so in this case it will not delete the file off of to be very clear doesn't",
    "start": "1558840",
    "end": "1565039"
  },
  {
    "text": "delete the file off of the remote system so this again is how we would do some type of exfiltration as opposed to uh",
    "start": "1565039",
    "end": "1570159"
  },
  {
    "text": "sending commands in or if we need to get the output of commands back we would use a get uh get as well so exec ultimately",
    "start": "1570159",
    "end": "1577960"
  },
  {
    "start": "1574000",
    "end": "1667000"
  },
  {
    "text": "it's going to execute a command on the remote machine and again this is executed on the user's context us as account context we don't want to pop",
    "start": "1577960",
    "end": "1585640"
  },
  {
    "text": "UAC the command output is not Auto automatically recorded this is something we played around with originally we were",
    "start": "1585640",
    "end": "1591240"
  },
  {
    "text": "recording all the output so a command would execute we would grab all the output and write it to a log file and",
    "start": "1591240",
    "end": "1596399"
  },
  {
    "text": "spit it back into the users's uh into the user's Dropbox folder and it's synchronized the problem with that is",
    "start": "1596399",
    "end": "1601720"
  },
  {
    "text": "every time you write a new file you get another pop-up balloon and we found out that most of the time we didn't really care what was coming out from a command",
    "start": "1601720",
    "end": "1608600"
  },
  {
    "text": "uh you know from a command standpoint if we wanted to redirect something we would do a get on that file we would redirect the output to a file and do a get on it",
    "start": "1608600",
    "end": "1615360"
  },
  {
    "text": "after that um you know from a standard uh you know pen testing piece you",
    "start": "1615360",
    "end": "1620399"
  },
  {
    "text": "generally try to avoid writing files to the dis in the first place but but since I can't avoid writing files at all here",
    "start": "1620399",
    "end": "1626360"
  },
  {
    "text": "it doesn't really matter right whether we write it in one location or two locations and so so ultimately that was",
    "start": "1626360",
    "end": "1631559"
  },
  {
    "text": "a design choice that we made uh we've got a move command again this is just a utility or convenience",
    "start": "1631559",
    "end": "1637080"
  },
  {
    "text": "command it could be done with exec you could pop a command prompt and certainly make a make a file move but we found out",
    "start": "1637080",
    "end": "1642440"
  },
  {
    "text": "that we were wanting to move files around uh enough that we implemented that separately uh implemented a delete",
    "start": "1642440",
    "end": "1649480"
  },
  {
    "text": "command again just another convenience piece this could certainly be done with cmd.exe and deleting a file but it just",
    "start": "1649480",
    "end": "1656720"
  },
  {
    "text": "avoids popping another command prompt and there are a couple of antiviruses out there that you're really squirly when you start running command prompts",
    "start": "1656720",
    "end": "1662760"
  },
  {
    "text": "from some processes that don't have Associated goys who knew so um then we",
    "start": "1662760",
    "end": "1668600"
  },
  {
    "start": "1667000",
    "end": "1761000"
  },
  {
    "text": "had uh sleep and so this is actually kind of counterintuitive but again because every file that's sent by",
    "start": "1668600",
    "end": "1674320"
  },
  {
    "text": "Dropbox creates noise on the Target in the form of those popups we wanted to whatever we could to minimize the number",
    "start": "1674320",
    "end": "1680159"
  },
  {
    "text": "of times that we had to send files tasking files uh to the users uh to the user account what sleep allows us to do",
    "start": "1680159",
    "end": "1687320"
  },
  {
    "text": "is basically execute a machine survey we know that the machine survey is going to take some some number or some amount of",
    "start": "1687320",
    "end": "1692440"
  },
  {
    "text": "time anytime a good adversary gets on your machine in the first place they're going to survey it and figure out is this really someplace I want to be uh",
    "start": "1692440",
    "end": "1699120"
  },
  {
    "text": "likewise again we're only using this because we can't figure out a way yet to get a standard TCP connection a solid",
    "start": "1699120",
    "end": "1704960"
  },
  {
    "text": "TCP connection out of the network in which case we're definitely to some survey to figure out networking setups",
    "start": "1704960",
    "end": "1710480"
  },
  {
    "text": "uh uh basically networking setups proxies whatever it is that might be blocking us uh what sleep allowed us to",
    "start": "1710480",
    "end": "1715960"
  },
  {
    "text": "do is to send one tasking file uh basically where we would do a put uh to send up our survey binary or survey",
    "start": "1715960",
    "end": "1721919"
  },
  {
    "text": "batch script whatever the case was and then wait for it to finish executing so we would do a sleep uh and then we would",
    "start": "1721919",
    "end": "1727480"
  },
  {
    "text": "ultimately grab that uh grab that back in one early version uh we thought about",
    "start": "1727480",
    "end": "1732960"
  },
  {
    "text": "not needing a sleep and we said well we'll just wait for commands to finish executing there's a inherent problem",
    "start": "1732960",
    "end": "1738200"
  },
  {
    "text": "here and that we can't ever troubleshoot this right until we get on the machine in which case we don't really need this",
    "start": "1738200",
    "end": "1743480"
  },
  {
    "text": "right on the machine via some other method uh and unfortunately we ran into a couple of misbehaving binaries where",
    "start": "1743480",
    "end": "1749039"
  },
  {
    "text": "there was some problem on the machine whatever the case was that that uh program didn't stop executing and then",
    "start": "1749039",
    "end": "1754880"
  },
  {
    "text": "we lost our Command and control and so it was a bad uh bad time was had by all and so we just decided to implement",
    "start": "1754880",
    "end": "1760679"
  },
  {
    "text": "sleep so so how do you detect this kind of stuff well the IDS at this point is",
    "start": "1760679",
    "end": "1766640"
  },
  {
    "start": "1761000",
    "end": "1921000"
  },
  {
    "text": "is 100% worthless right the IDS will not protect you and that kind of makes sense if you think about it one dropbox is",
    "start": "1766640",
    "end": "1772600"
  },
  {
    "text": "sending everything out via https and unless you're inspecting all of your https or your SSL encrypted uh encrypted",
    "start": "1772600",
    "end": "1779880"
  },
  {
    "text": "connections then then again what are you going to see in this case even if you're looking for executables over the wire or",
    "start": "1779880",
    "end": "1785679"
  },
  {
    "text": "whatever the case is again these are encrypted uh I don't think the IDS is going to help you uh firewalls again",
    "start": "1785679",
    "end": "1792159"
  },
  {
    "text": "mostly worthless right however this user is is set up he's already configured to allow or the ad administrators have",
    "start": "1792159",
    "end": "1798600"
  },
  {
    "text": "already configured to allow Dropbox out of the network and so since you're abusing the fact that Dropbox is already",
    "start": "1798600",
    "end": "1804799"
  },
  {
    "text": "allowed out of the network and to download files over the network uh again what's the firewall going to do at this",
    "start": "1804799",
    "end": "1810120"
  },
  {
    "text": "point it's very difficult especially again over those encrypted channels uh to differentiate your traffic right to",
    "start": "1810120",
    "end": "1816519"
  },
  {
    "text": "differentiate your traffic uh from any other legitimate Dropbox traffic is any",
    "start": "1816519",
    "end": "1822000"
  },
  {
    "text": "virus going to catch us come on right I mean what can't you do with an i yeah",
    "start": "1822000",
    "end": "1827720"
  },
  {
    "text": "anyway anyway I'll just I'll leave that one alone I don't want to get sued by any virus venders on top of Dropbox but um how about DLP software th this is",
    "start": "1827720",
    "end": "1836080"
  },
  {
    "text": "really worthless too um in this case it's worthless for a whole lot for a whole lot more reasons than than just",
    "start": "1836080",
    "end": "1841720"
  },
  {
    "text": "the fact it doesn't protect you from this attack DLP software in general is Trivial to bypass but think about what",
    "start": "1841720",
    "end": "1848519"
  },
  {
    "text": "we're doing here right the DLP software doesn't even get the chance to say is this file writing for instance to a USB",
    "start": "1848519",
    "end": "1855200"
  },
  {
    "text": "drive or are we writing this file to a network share I'm not seeing a whole lot of DLP DLP software out there that's set",
    "start": "1855200",
    "end": "1862679"
  },
  {
    "text": "up where it'll actually detect or it's checking to see are we writing to a local F to a local directory on the",
    "start": "1862679",
    "end": "1869360"
  },
  {
    "text": "system that happens to be configured by Dropbox to synchronize out to the web right and so that's a challenge that the",
    "start": "1869360",
    "end": "1875080"
  },
  {
    "text": "DLP software has if it were going to detect this if it were going to detect for instance a an Excel file that we're",
    "start": "1875080",
    "end": "1880519"
  },
  {
    "text": "exfiltrating full of social security numbers right the the or credit card numbers whatever the case is the whole",
    "start": "1880519",
    "end": "1886519"
  },
  {
    "text": "idea of what the DLP software is supposed to be designed to detect again the challenge that they're",
    "start": "1886519",
    "end": "1892240"
  },
  {
    "text": "up against is that they're looking for a file being written to a local to a local folder uh and again maybe they're",
    "start": "1892240",
    "end": "1899080"
  },
  {
    "text": "monitoring the default directories but users can configure others uh again I I don't see dlpt or sorry DLP software",
    "start": "1899080",
    "end": "1905840"
  },
  {
    "text": "winning this uh whitelisting software I'll give these guys a win uh ultimately they're not going to let the new",
    "start": "1905840",
    "end": "1911120"
  },
  {
    "text": "application uh execute but certainly we know how to get around wh listing software some of the new Powershell",
    "start": "1911120",
    "end": "1916480"
  },
  {
    "text": "hacks where they're throwing stuff right into memory uh that seems to work pretty well so how about next Generation",
    "start": "1916480",
    "end": "1922559"
  },
  {
    "start": "1921000",
    "end": "2000000"
  },
  {
    "text": "firewalls cuz a couple people questioned me on this that were reviewing some of the slides I I can hear the ciso now",
    "start": "1922559",
    "end": "1928320"
  },
  {
    "text": "their shiny nextg firewall is going to save us from this horror well only sort of right and so if your nextg firewall",
    "start": "1928320",
    "end": "1935440"
  },
  {
    "text": "is set up as a set up as a proxy and you have configured the certificates on all",
    "start": "1935440",
    "end": "1940559"
  },
  {
    "text": "the machines to trust this proxy so that you can do SSL uh decryption in the middle maybe maybe the saves you um the",
    "start": "1940559",
    "end": "1949159"
  },
  {
    "text": "reality is though that you know pulled some data uh where some people looked at NextGen firewalls and who was happy with",
    "start": "1949159",
    "end": "1955360"
  },
  {
    "text": "them who wasn't uh ultimately 75% of the respondents in one of their uh in one of the 2012 surveys said their nextg",
    "start": "1955360",
    "end": "1962679"
  },
  {
    "text": "firewalls were increasing their workloads and so this sounds to me a lot like IDs right it was a Panacea in the",
    "start": "1962679",
    "end": "1968360"
  },
  {
    "text": "90s IDs was I think nextg firewalls or the new Panacea you know basically the way to solve us from all the horrors out",
    "start": "1968360",
    "end": "1975360"
  },
  {
    "text": "there at the end of the day it become it's down to a black and white decision do you allow Dropbox on the network",
    "start": "1975360",
    "end": "1981799"
  },
  {
    "text": "replace Dropbox with any of these file synchronization services do you allow them on the uh on the network because",
    "start": "1981799",
    "end": "1988159"
  },
  {
    "text": "again it's very difficult I don't want to say can't I should have taken that out there it's very difficult with most of your next gen firewalls by the way",
    "start": "1988159",
    "end": "1995440"
  },
  {
    "text": "buzzword Bingo right and so to surgically filter that content so the",
    "start": "1995440",
    "end": "2001799"
  },
  {
    "text": "question really comes down to do you allow the synchronization software in the first place any detection methods",
    "start": "2001799",
    "end": "2007360"
  },
  {
    "text": "that I've come up with are really focusing on finding illicit synchronization software installations",
    "start": "2007360",
    "end": "2012840"
  },
  {
    "text": "again this channel exists by Design right again that's what it's there to do it's there to synchronize files to and",
    "start": "2012840",
    "end": "2018320"
  },
  {
    "text": "from many machines the Assumption here is we have one machine we want to ultimately use it as a covert channel uh",
    "start": "2018320",
    "end": "2024760"
  },
  {
    "text": "again if you allow the software you implicitly allow the covert Channel with it right so I have some detection",
    "start": "2024760",
    "end": "2030360"
  },
  {
    "start": "2028000",
    "end": "2280000"
  },
  {
    "text": "strategies Unfortunately they they mostly suck uh so Dropbox uses this protocol called land sync this is",
    "start": "2030360",
    "end": "2036440"
  },
  {
    "text": "another thing that got me looking at this every pen test that I go out and do over the last two years right I run a",
    "start": "2036440",
    "end": "2044200"
  },
  {
    "text": "packet Trace Run a packet capture and I've got this crazy Dropbox lands sync protocol kicking around on corporate",
    "start": "2044200",
    "end": "2050839"
  },
  {
    "text": "networks in places where then you go back and you're doing your pentest report you talk to the security guys and",
    "start": "2050839",
    "end": "2056079"
  },
  {
    "text": "say oh cool you guys use Dropbox for uh you know for I don't know collaboration or whatever it's designed for and",
    "start": "2056079",
    "end": "2061480"
  },
  {
    "text": "they're like no we don't use dropbox no it's not installed on our Network and it's like oh hey I hate to break it to you Dropbox is definitely",
    "start": "2061480",
    "end": "2067760"
  },
  {
    "text": "installed inter Network this Lan sync protocol is beaconing all over the place and so this is another active area",
    "start": "2067760",
    "end": "2073358"
  },
  {
    "text": "research for me the uh the broadcast on UDP Port 17500 the idea here as I",
    "start": "2073359",
    "end": "2080000"
  },
  {
    "text": "understand it this isn't phenomenally well documented but the idea is apparently that if you have two machines",
    "start": "2080000",
    "end": "2086079"
  },
  {
    "text": "on the same network so picture like uh mom and pop home network uh basically set up where they have multiple machines",
    "start": "2086079",
    "end": "2092280"
  },
  {
    "text": "on the network and they're the same land segment same broadcast domain and they want to use Dropbox to synchronize",
    "start": "2092280",
    "end": "2097720"
  },
  {
    "text": "there's no reason uh obviously it saves Dropbox money there's no reason to send the files all the way out to S3 and then",
    "start": "2097720",
    "end": "2103560"
  },
  {
    "text": "have them come back down it just doesn't make any sense and so what this Lan sync protocol does it beacons over UDP 17500",
    "start": "2103560",
    "end": "2110599"
  },
  {
    "text": "and says hey I've got new files for this particular account ID again not using the user's email uh just using their uh",
    "start": "2110599",
    "end": "2116800"
  },
  {
    "text": "basically just using that unique ID the Dropbox uh sets up and it says hey do you have a new copy of this file no okay",
    "start": "2116800",
    "end": "2123040"
  },
  {
    "text": "cool and then sends it over TCP and that is actually encrypted when it's sent uh but it won't surpris me at all to find",
    "start": "2123040",
    "end": "2128520"
  },
  {
    "text": "out that there's some protocol vulnerabilities or some play places to uh play around in there I guess so",
    "start": "2128520",
    "end": "2134839"
  },
  {
    "text": "definitely looking for those broadcasts on 17500 is a big win if you're trying to detect this and get it out of your",
    "start": "2134839",
    "end": "2140119"
  },
  {
    "text": "network you can look for DNS requests to servers related to synchronization servers uh this certainly is a I mean",
    "start": "2140119",
    "end": "2147480"
  },
  {
    "text": "it's workable uh but realistically I don't know that this is a that's going to be the biggest win either blocking",
    "start": "2147480",
    "end": "2154880"
  },
  {
    "text": "access to Amazon S3 so that's the Dropbox back end I would say about half the file synchronization Services out",
    "start": "2154880",
    "end": "2160800"
  },
  {
    "text": "there are directly backed by Amazon S3 and I think the other half probably are backed by S3 it's just not obvious that",
    "start": "2160800",
    "end": "2167200"
  },
  {
    "text": "they are so Amazon's S3 is their uh basically their scalable storage solution and so again Amazon is is very",
    "start": "2167200",
    "end": "2173920"
  },
  {
    "text": "up sorry Dropbox is very upfront about the fact that they that they're backed directly by Amazon S3 if you simply",
    "start": "2173920",
    "end": "2179960"
  },
  {
    "text": "block access to Amazon's S3 either by uh certificate or EXC me or by IP ranges uh",
    "start": "2179960",
    "end": "2187160"
  },
  {
    "text": "again you're going to break a lot because S3 is being used for Content delivery networks now that's that's not",
    "start": "2187160",
    "end": "2192480"
  },
  {
    "text": "really a solution either it's it's going to break other stuff we can look in user profiles for elicit synchronization uh",
    "start": "2192480",
    "end": "2198839"
  },
  {
    "text": "software installations so this is really interesting I I think that the uh I'm",
    "start": "2198839",
    "end": "2203920"
  },
  {
    "text": "almost positive in this case that our uh Dropbox engineers and our box.net and",
    "start": "2203920",
    "end": "2209000"
  },
  {
    "text": "whoever else out there the file synchronization guys realized UAC was killing them right they realized that",
    "start": "2209000",
    "end": "2214839"
  },
  {
    "text": "when they when a user wants to use this program and they're not a power user on the machine that all of a sudden they're",
    "start": "2214839",
    "end": "2220920"
  },
  {
    "text": "not able to install the software and so they looked around and said H maybe we should write all the binaries into the",
    "start": "2220920",
    "end": "2226359"
  },
  {
    "text": "user's profile because they have they have right permission there and so that's what they did ultimately these",
    "start": "2226359",
    "end": "2232319"
  },
  {
    "text": "programs now are installing into the user's profile now mad props to these guys for solving a problem right because",
    "start": "2232319",
    "end": "2239000"
  },
  {
    "text": "now they're retaining customers but but let's be honest here Security Professionals this is pure Insanity what",
    "start": "2239000",
    "end": "2244520"
  },
  {
    "text": "other applications do you allow your users to install on on machines into their you know into their profile",
    "start": "2244520",
    "end": "2250280"
  },
  {
    "text": "directories uh that ultimately have some type of back Channel command and control or exfiltration I I think the answer the",
    "start": "2250280",
    "end": "2256599"
  },
  {
    "text": "answer is or at least should be none uh in any case we can go through and we can scan these user profiles for these uh",
    "start": "2256599",
    "end": "2262960"
  },
  {
    "text": "software installations this is something I do regularly with uh with several of my clients and it's been reasonably",
    "start": "2262960",
    "end": "2268359"
  },
  {
    "text": "successful I rarely if ever go into a network with more than goodness more than 500 machines and we don't find two",
    "start": "2268359",
    "end": "2274760"
  },
  {
    "text": "or three users already using these services and again most of the time management is blissfully unaware of the",
    "start": "2274760",
    "end": "2279960"
  },
  {
    "text": "fact that they're doing it so do I have any better detection strategies uh you",
    "start": "2279960",
    "end": "2285760"
  },
  {
    "start": "2280000",
    "end": "2358000"
  },
  {
    "text": "know here and there I'm working on some stuff with bro IDs right now but but realistically uh not not right now",
    "start": "2285760",
    "end": "2292599"
  },
  {
    "text": "better detection strateg is not really again you're taking the vulnerability with the convenience if you want the",
    "start": "2292599",
    "end": "2297680"
  },
  {
    "text": "convenience of the software right then ultimately you have to take the uh have to take the vulnerability along with it",
    "start": "2297680",
    "end": "2303680"
  },
  {
    "text": "it's almost like Outlook right I mean I love Outlook or at least I love email back up I don't really love Outlook but",
    "start": "2303680",
    "end": "2308960"
  },
  {
    "text": "I do love email right and so again it's much like that if you want if you want email you're already creating a command",
    "start": "2308960",
    "end": "2315000"
  },
  {
    "text": "and control Channel there just so happens everybody's looking at it right this is a case where I don't think everybody's looking at yet uh hopefully",
    "start": "2315000",
    "end": "2321480"
  },
  {
    "text": "that changes but but realistically it's time to talk to management and find out what the policy on these Services really",
    "start": "2321480",
    "end": "2327319"
  },
  {
    "text": "should be does your acceptable user policy discuss whether or not this is acceptable right most often it says",
    "start": "2327319",
    "end": "2333960"
  },
  {
    "text": "don't install software on the machines okay check right we got that that's awesome right but but realistically if",
    "start": "2333960",
    "end": "2339480"
  },
  {
    "text": "the users can do it technically and and they're going to be able to in this case unless you have some type of wild wh",
    "start": "2339480",
    "end": "2345200"
  },
  {
    "text": "listing software like bit 9 uh they're going to be able to install this because it's writing into their profile directories right and executing from",
    "start": "2345200",
    "end": "2351839"
  },
  {
    "text": "their profile directories uh picture now your users with roaming directory or roaming profiles and again it's game on",
    "start": "2351839",
    "end": "2358280"
  },
  {
    "start": "2358000",
    "end": "2813000"
  },
  {
    "text": "right so so let's look at a little a little demo hopefully the internet doesn't bomb even if it does that's okay",
    "start": "2358280",
    "end": "2365040"
  },
  {
    "text": "because we have good old land sync so land s will save me so let's",
    "start": "2365040",
    "end": "2372079"
  },
  {
    "text": "see okay so I've got an XP machine running here uh basically he's got uh or",
    "start": "2372079",
    "end": "2377680"
  },
  {
    "text": "he's got Dropbox set up there so one of the neat things with the Dropbox is that it'll actually allow you to uh",
    "start": "2377680",
    "end": "2384359"
  },
  {
    "text": "basically log in directly to your account uh note to self if you're ever",
    "start": "2384359",
    "end": "2389480"
  },
  {
    "text": "registering for oh come on don't do that to me let's see will let maximize yeah",
    "start": "2389480",
    "end": "2395200"
  },
  {
    "text": "good old xss here now in any case I was going to go look at the user profile I can't even get",
    "start": "2395200",
    "end": "2401880"
  },
  {
    "text": "over there H that's cool we'll see if that",
    "start": "2401880",
    "end": "2407040"
  },
  {
    "text": "comes back so in any case uh you have your default Dropbox synchronization folder and so the synchronization folder",
    "start": "2407040",
    "end": "2413640"
  },
  {
    "text": "uh defaults to the my documents Dropbox in your XP machines or the application data or sorry documents Dropbox in the",
    "start": "2413640",
    "end": "2421119"
  },
  {
    "text": "wind7 machines or vist them later and so again all all we're really doing here is we're ultimately running uh again we're",
    "start": "2421119",
    "end": "2427359"
  },
  {
    "text": "going to ultimately execute some code I don't have office installed on here so I pre uh basically pre-infected the machine but if we open up a task manager",
    "start": "2427359",
    "end": "2434760"
  },
  {
    "text": "uh as as delivered and this should be on your conference CD as well uh as delivered it's uh it's actually running",
    "start": "2434760",
    "end": "2440359"
  },
  {
    "text": "as drops sync. exe and so it sounds sort of legitimate it runs with Dropbox installs into the user profile uh so",
    "start": "2440359",
    "end": "2447480"
  },
  {
    "text": "again it roams just like Dropbox does and and ultimately won't pop UAC when uh when it first lands on the box it'll",
    "start": "2447480",
    "end": "2453680"
  },
  {
    "text": "ultimately execute uh out of wherever you set it up uh with your macro code and then it'll copy itself into uh into",
    "start": "2453680",
    "end": "2460280"
  },
  {
    "text": "drop sync in the user's app data folder and set up a run key you can see it's a very minimal memory foot print it just",
    "start": "2460280",
    "end": "2465800"
  },
  {
    "text": "works on pulling this again is this is not rocket science uh but but it happens to be highly effective so so we can see",
    "start": "2465800",
    "end": "2473359"
  },
  {
    "text": "here that we've got I guess the first thing we'll do is delete a file and let's see so we got a file in here",
    "start": "2473359",
    "end": "2480839"
  },
  {
    "text": "called delet me. file and so what we'll do is we'll come back over to our let's see",
    "start": "2480839",
    "end": "2489040"
  },
  {
    "text": "yeah and so what I've got are several uh several test files in this case and so basically this is all it takes is",
    "start": "2489040",
    "end": "2496520"
  },
  {
    "text": "essentially to say I've got a file and I say delete uh C delete me. file and so",
    "start": "2496520",
    "end": "2501839"
  },
  {
    "text": "this ultimately as we move this in what what the key here is is this little drop smack underscore so when you build the",
    "start": "2501839",
    "end": "2507200"
  },
  {
    "text": "binary and again the source code's included so you can rebuild the binary because I'm sure tomorrow or within the",
    "start": "2507200",
    "end": "2512640"
  },
  {
    "text": "hour you won't be able to synchronize files on Dropbox that begin with the term drop smack uncore or anything I",
    "start": "2512640",
    "end": "2518040"
  },
  {
    "text": "think the Dropbox guys are really smart and they'll fix that right away I hope the Dropbox guys fix that right away all",
    "start": "2518040",
    "end": "2523960"
  },
  {
    "text": "right but uh but in any case uh for right now hopefully this still works and and so again basically all you're doing",
    "start": "2523960",
    "end": "2530520"
  },
  {
    "text": "is setting up to delete the file and so if we copy this into the Dropbox folder on picture again that this is the actual",
    "start": "2530520",
    "end": "2536480"
  },
  {
    "text": "machine you have uh control of so the the laptop at uh at home bypassing the",
    "start": "2536480",
    "end": "2541640"
  },
  {
    "text": "corporate defenses and so what's going to happen here ultimately is that's get syn or get synchronized to the cloud you",
    "start": "2541640",
    "end": "2546760"
  },
  {
    "text": "can see little green check box I don't think it really synchronized that quick I think what you're seeing is the uh uh",
    "start": "2546760",
    "end": "2552119"
  },
  {
    "text": "ultimately on there we go so now we have the popup and notice you've got pop-ups on two different machines first you have",
    "start": "2552119",
    "end": "2557680"
  },
  {
    "text": "a popup on your if you want to call it your Bastion host the machine that luckily the pop-up goes away which I",
    "start": "2557680",
    "end": "2563000"
  },
  {
    "text": "think is really cool I I appreciate that from a Dropbox developer standpoint that the popup doesn't stay up there because",
    "start": "2563000",
    "end": "2568880"
  },
  {
    "text": "that could be hazardous from a pen testing standpoint but as we' used this with pen testing I found that it's",
    "start": "2568880",
    "end": "2574119"
  },
  {
    "text": "highly effective or most effective at least to condition the user to see the same file name pop up again and again",
    "start": "2574119",
    "end": "2580520"
  },
  {
    "text": "and again and again and so when I'm sending a file over I use the same file name usually something. XLS and when",
    "start": "2580520",
    "end": "2586720"
  },
  {
    "text": "we're pulling xfill data back it's the same file name. XLS and so the user just gets conditioned to seeing that damn",
    "start": "2586720",
    "end": "2592599"
  },
  {
    "text": "file again and again and again whatever that happens to be whether it's TPS reports or or whatever the case is and",
    "start": "2592599",
    "end": "2598359"
  },
  {
    "text": "so ultimately then that that command gets picked up on the other side here uh we can see here on the XP side that for",
    "start": "2598359",
    "end": "2604720"
  },
  {
    "text": "whatever reason the uh the pop-ups are actually staying up there there that's awesome uh but in any case that delete",
    "start": "2604720",
    "end": "2609839"
  },
  {
    "text": "me. file is now gone from the C drive so we've got a good uh got a good Delete set up uh likewise we can set up to do",
    "start": "2609839",
    "end": "2617480"
  },
  {
    "text": "uh let's see what's in the exac so exac if we wanted to run Cal for instance on the",
    "start": "2617480",
    "end": "2623839"
  },
  {
    "text": "target you would never really want to run Cal but that's cool and so we set up and then Cal will start over on the uh",
    "start": "2623839",
    "end": "2629880"
  },
  {
    "text": "start over on the Target in a second yep so it notices that it was added again you want to pick",
    "start": "2629880",
    "end": "2635960"
  },
  {
    "text": "a smart name in this case right that we're pulling for some type of name in this and so then Cal starts up in the",
    "start": "2635960",
    "end": "2641720"
  },
  {
    "text": "background this could just as easily be FG dump or whatever it is that you need to do from a survey standpoint uh again",
    "start": "2641720",
    "end": "2647240"
  },
  {
    "text": "you want to pick smart names here for uh for your exfiltration files for infiltration files uh even specifically",
    "start": "2647240",
    "end": "2654400"
  },
  {
    "text": "the command files right drop smack uncore whatever just doesn't sound right so if you've got a company that you're",
    "start": "2654400",
    "end": "2659480"
  },
  {
    "text": "pentesting for instance you know massive Dynamic right certainly massive Dynamic underscore something wouldn't be a bad",
    "start": "2659480",
    "end": "2665880"
  },
  {
    "text": "place to start because again what drops sync is going to do or drop smack on the other side it's going to look for that",
    "start": "2665880",
    "end": "2671720"
  },
  {
    "text": "file name and then parse that as if it were command text so what else can we do with this",
    "start": "2671720",
    "end": "2677440"
  },
  {
    "text": "well we close out Cal and so we've got a survey that we uh",
    "start": "2677440",
    "end": "2682760"
  },
  {
    "text": "that we looked at doing and so this is kind of what uh we've done in the past uh seems to work very well get some uh",
    "start": "2682760",
    "end": "2688960"
  },
  {
    "text": "just get some configuration information uh just using a batch script and so yep thanks got that we deleted and so",
    "start": "2688960",
    "end": "2697559"
  },
  {
    "text": "uh what we're going to do here in this case is take that projections. XLS and again that's the file that just a good file name that we like to use we're send",
    "start": "2697559",
    "end": "2704640"
  },
  {
    "text": "it up to the C survey. bat we're going to execute it sleep for 10 seconds because it takes a couple of seconds to",
    "start": "2704640",
    "end": "2710880"
  },
  {
    "text": "execute then we're going to delete it on the other side yeah I could delete the batch script from inside the batch",
    "start": "2710880",
    "end": "2715960"
  },
  {
    "text": "script but whatever and then in this case then we'll do a get on on the temp. text the output file from the",
    "start": "2715960",
    "end": "2722960"
  },
  {
    "text": "survey uh we'll ultimately call it projections. XLS because now again picture this this user is seeing the",
    "start": "2722960",
    "end": "2728720"
  },
  {
    "text": "survey come over as projections. XLS and then when the pop-up comes up again he sees exactly the same file name again",
    "start": "2728720",
    "end": "2735200"
  },
  {
    "text": "people are creatures a habit I want to condition this person whoever our Target is to seeing the same thing again and again if the user is not in front of his",
    "start": "2735200",
    "end": "2741680"
  },
  {
    "text": "machine I really don't care because as you can see sometimes the bubbles go away sometimes they don't even if you",
    "start": "2741680",
    "end": "2747040"
  },
  {
    "text": "come in at the end of the day and those files are no longer there you're not really looking at a whole lot um and then ultimately don't forget with the",
    "start": "2747040",
    "end": "2754160"
  },
  {
    "text": "get right because we don't want to for exfiltration time we xill a file we don't want to automatically delete it if",
    "start": "2754160",
    "end": "2760160"
  },
  {
    "text": "you created a temp file you want to pick that back up and and and delete it you don't want to leave it there for forensic analysis later if you can avoid",
    "start": "2760160",
    "end": "2767119"
  },
  {
    "text": "it so although we'll talk a little bit about forensics in just a minute um so",
    "start": "2767119",
    "end": "2772480"
  },
  {
    "text": "I'll put that in the survey folder oh that's right so I should put projections. XLS in there first uh let's",
    "start": "2772480",
    "end": "2778480"
  },
  {
    "text": "see if we edit this with yeah and so in this case you can see this is just a",
    "start": "2778480",
    "end": "2783599"
  },
  {
    "text": "very very I mean it's not even a real survey but rock on so so we want to put",
    "start": "2783599",
    "end": "2789000"
  },
  {
    "text": "that into the uh into the target folder",
    "start": "2789000",
    "end": "2793559"
  },
  {
    "text": "first okay so again that's going to automatically synchronize uh if the user tries to open it obviously it's not",
    "start": "2795280",
    "end": "2800960"
  },
  {
    "text": "going to work that's that works in our favor actually looks kind of like a corrupted file obviously again this",
    "start": "2800960",
    "end": "2806079"
  },
  {
    "text": "isn't withstanding any forensics or any of uh any of that but but at the point somebody's doing forensics you're already screwed anyway",
    "start": "2806079",
    "end": "2813240"
  },
  {
    "start": "2813000",
    "end": "2893000"
  },
  {
    "text": "so and so we send the survey command over and you can see here that the survey",
    "start": "2813240",
    "end": "2819280"
  },
  {
    "text": "command was added here's our drawbox synchronization folder and if Joe you know whoever it is happens to be looking at right at this time uh yeah that's bad",
    "start": "2819280",
    "end": "2826720"
  },
  {
    "text": "and again we've got the popup coming in there but again that's why you want to use better uh better file names one of",
    "start": "2826720",
    "end": "2832760"
  },
  {
    "text": "the things that we that occurred to us as as time was going on was that it wasn't really bright to have to always",
    "start": "2832760",
    "end": "2838720"
  },
  {
    "text": "use text files and so uh area of future research and we thought about releasing it here and then the lawyers advised us",
    "start": "2838720",
    "end": "2845240"
  },
  {
    "text": "not to release this here but was to start parsing uh for instance maybe docs",
    "start": "2845240",
    "end": "2850440"
  },
  {
    "text": "or PDFs looking for real PDFs well formed PDFs or well formed documents",
    "start": "2850440",
    "end": "2855520"
  },
  {
    "text": "looking for the command so basically embedding these in other file types uh I can tell you today that you can place a",
    "start": "2855520",
    "end": "2861240"
  },
  {
    "text": "fake file header on the uh on a particular command file uh for instance",
    "start": "2861240",
    "end": "2866359"
  },
  {
    "text": "you know just the magic number for do and name it a dooc and then you can run the file command against it just won't",
    "start": "2866359",
    "end": "2871599"
  },
  {
    "text": "open and so uh that's doable today with the code that's here uh the some of the ration now from the lawyers was that as",
    "start": "2871599",
    "end": "2878160"
  },
  {
    "text": "you start getting more and more stealthy with this it stops looking like a pen testing tool and starts looking like",
    "start": "2878160",
    "end": "2883280"
  },
  {
    "text": "malware and you don't want to be the guy that released malware into the ecosystem for use in Dropbox because they will",
    "start": "2883280",
    "end": "2889280"
  },
  {
    "text": "probably sue you I said cool that sounds like a good plan that's why you get paid the big buck so Al we have this",
    "start": "2889280",
    "end": "2895200"
  },
  {
    "start": "2893000",
    "end": "3117000"
  },
  {
    "text": "projections. XLS this doesn't automatically do anything except synchronized to the cloud now if you",
    "start": "2895200",
    "end": "2900880"
  },
  {
    "text": "happen to get the guy uh happen to get the guy's Cloud uh basically his Cloud",
    "start": "2900880",
    "end": "2906040"
  },
  {
    "text": "password Here for whatever reason be it a key logger uh be it because you stole his database and you reverse engineered",
    "start": "2906040",
    "end": "2911800"
  },
  {
    "text": "how Dropbox uh stores those credentials uh whatever the case is you're able to",
    "start": "2911800",
    "end": "2917319"
  },
  {
    "text": "come and not have to control the laptop anymore this is kind of a key this is kind of a key uh Point here is that if",
    "start": "2917319",
    "end": "2923960"
  },
  {
    "text": "you're able to grab these credentials and you can in almost every service but Dropbox as in it's trivially easy in",
    "start": "2923960",
    "end": "2931400"
  },
  {
    "text": "almost every service but back up every service that I evaluated except for Dropbox did not encrypt their databases",
    "start": "2931400",
    "end": "2938280"
  },
  {
    "text": "they hashed a password often times uh not even hashing it it was encoded in some way so you could actually get the",
    "start": "2938280",
    "end": "2944000"
  },
  {
    "text": "plan text password back but it turns out that as long as you have the hash it didn't really matter again these are all",
    "start": "2944000",
    "end": "2949359"
  },
  {
    "text": "basically set up so that it's it's for user convenience so the user can click the little thing on the side the little",
    "start": "2949359",
    "end": "2954640"
  },
  {
    "text": "icon that for whatever reason is off the screen at this point but um he can click the icon on the side of the screen there",
    "start": "2954640",
    "end": "2960359"
  },
  {
    "text": "and say go to Dropbox on the web and it automatically opens the web browser and logs him in uh so again picture the",
    "start": "2960359",
    "end": "2967319"
  },
  {
    "text": "point that you've done this you no longer need control of that laptop because you have the web right at this",
    "start": "2967319",
    "end": "2973160"
  },
  {
    "text": "point we can download projections. XLS or any of our exfiltration traffic from their uh from their HTTP interface uh",
    "start": "2973160",
    "end": "2980359"
  },
  {
    "text": "again almost every major provider implements this as well this isn't unique to Dropbox so as well we can send",
    "start": "2980359",
    "end": "2986920"
  },
  {
    "text": "our tasking files this way uh but one of the things from a forensic standpoint that I wanted to point out is yeah show",
    "start": "2986920",
    "end": "2993799"
  },
  {
    "text": "deleted files awesome and so one of the problems that you run into here and this is one",
    "start": "2993799",
    "end": "2999799"
  },
  {
    "text": "of the reasons that I would suggest if you're going to do this as an AP guy as opposed to if you're pen testing nobody",
    "start": "2999799",
    "end": "3005040"
  },
  {
    "text": "cares right after you issue the pentest report you say and this is how we got in oh by the way you're almost certainly I",
    "start": "3005040",
    "end": "3010920"
  },
  {
    "text": "feel obligated to say this you're almost certainly violating dropboxes terms of service uh by doing this so depending on",
    "start": "3010920",
    "end": "3017160"
  },
  {
    "text": "where you sit in the you know good old Computer Fraud and Abuse Act land where violating terms of service is actually a",
    "start": "3017160",
    "end": "3023240"
  },
  {
    "text": "crime uh you know ju just be aware so yeah crazy um so in any case you can see",
    "start": "3023240",
    "end": "3030400"
  },
  {
    "text": "that your files are still here there is an option somehow off the screen here even though I have this maximized to to",
    "start": "3030400",
    "end": "3036640"
  },
  {
    "text": "delete those uh ultimately to delete those files permanently uh that's great it turns out the Dropbox still will have",
    "start": "3036640",
    "end": "3042680"
  },
  {
    "text": "kept a log which is one of the reasons that you want to keep these files named something appropriate so even after you",
    "start": "3042680",
    "end": "3048000"
  },
  {
    "text": "delete the files here even though you won't be able to pull the file back anymore for inspection from forensic",
    "start": "3048000",
    "end": "3053319"
  },
  {
    "text": "standpoint one of your high-speed forensic haters can still come in and identify the fact that there's uh",
    "start": "3053319",
    "end": "3058720"
  },
  {
    "text": "basically that these file names have been in play and so if you uploaded something as FG dump. exe it wouldn't be",
    "start": "3058720",
    "end": "3064280"
  },
  {
    "text": "very stealthy but if you happen to have done that then again that's going to be sitting in the uh in the Dropbox folder",
    "start": "3064280",
    "end": "3069319"
  },
  {
    "text": "for uh for anyone to see so if we take a look at our our X filtration uh we would",
    "start": "3069319",
    "end": "3075200"
  },
  {
    "text": "do something like I don't know rename this to uh something. text we probably",
    "start": "3075200",
    "end": "3080400"
  },
  {
    "text": "move it out of the folder before we did that too but but that's cool okay and so again you can see here",
    "start": "3080400",
    "end": "3087480"
  },
  {
    "text": "that we've outputed uh ultimately output information from whatever our survey information was I think in this case we",
    "start": "3087480",
    "end": "3093880"
  },
  {
    "text": "an IP config and tried to get out to Google and a couple of other little minor directory walks so so again just",
    "start": "3093880",
    "end": "3099559"
  },
  {
    "text": "from a concept standpoint this isn't rocket science it it it works very well uh it's it saved my button at least at",
    "start": "3099559",
    "end": "3105760"
  },
  {
    "text": "least one pen test up to this point uh and again that's that's ultimately where the idea came from is looking at and",
    "start": "3105760",
    "end": "3111160"
  },
  {
    "text": "seeing that we had a user that was using Dropbox and said okay now now what can we do and and",
    "start": "3111160",
    "end": "3117040"
  },
  {
    "start": "3117000",
    "end": "3539000"
  },
  {
    "text": "so uh again I'm positive this idea is an original I thought that it was uh then I",
    "start": "3117040",
    "end": "3122119"
  },
  {
    "text": "went and I found that usix paper as I was doing some Cloud research uh and and so my assertion is that there's already",
    "start": "3122119",
    "end": "3129079"
  },
  {
    "text": "people doing this uh so I don't think I'm releasing I mean maybe the fact that I'm bringing it up at black hat uh I",
    "start": "3129079",
    "end": "3134839"
  },
  {
    "text": "don't know I haven't seen any uh any adversaries doing this yet I don't have any evidence that there's or any forensic evidence that there's malware",
    "start": "3134839",
    "end": "3140559"
  },
  {
    "text": "out there that's synchronizing using these services but but I bet the money in my pocket that it's already happening and if it wasn't before today I can",
    "start": "3140559",
    "end": "3147720"
  },
  {
    "text": "almost guarantee you by tomorrow somebody's going to I mean yeah somebody will do it so future work we really need",
    "start": "3147720",
    "end": "3154280"
  },
  {
    "text": "to be able to read and extract the information from the Dropbox configs I have two key problems at this point one",
    "start": "3154280",
    "end": "3159559"
  },
  {
    "text": "I don't know where the user set a synchronization folders up so I guess at this point because every time I've",
    "start": "3159559",
    "end": "3165359"
  },
  {
    "text": "reverse engineered these these things obviously for security purposes because anything else would be a violation of",
    "start": "3165359",
    "end": "3170599"
  },
  {
    "text": "the dmca um then so every time I mean they're changing these consoling the",
    "start": "3170599",
    "end": "3176200"
  },
  {
    "text": "drop box team again kudos to these guys for you know the code obfuscation they're doing and for encrypting their",
    "start": "3176200",
    "end": "3181839"
  },
  {
    "text": "databases we just assume a default synchronization folder uh so far it's worked and I've never seen a user turn",
    "start": "3181839",
    "end": "3187839"
  },
  {
    "text": "that off I've seen users add extra folders but I've never seen somebody turn off the default Dropbox folder so",
    "start": "3187839",
    "end": "3194559"
  },
  {
    "text": "uh if somebody happens to do that that breaks this version of of drops smack explicitly so if you're looking for a",
    "start": "3194559",
    "end": "3201200"
  },
  {
    "text": "security fix and you feel like you need drop box go and delete this folder immediately right and have your user",
    "start": "3201200",
    "end": "3207480"
  },
  {
    "text": "synchronized with some other folder and you're set it it doesn't work these pop-up notifications are a giant pain in",
    "start": "3207480",
    "end": "3213720"
  },
  {
    "text": "the butt right I don't particularly appreciate these users probably do um if you were going to use this as a solid",
    "start": "3213720",
    "end": "3220599"
  },
  {
    "text": "you know a command and control channel for some extended period of time I would really really really want to get rid of",
    "start": "3220599",
    "end": "3225720"
  },
  {
    "text": "these so need to find some kind of strategy to get rid of these popups we're creating a lot of them right the",
    "start": "3225720",
    "end": "3231520"
  },
  {
    "text": "Sleep command uh helps us create a few a few less of these ultimately but still",
    "start": "3231520",
    "end": "3236920"
  },
  {
    "text": "we're creating a lot of them so uh ultimately other future work right",
    "start": "3236920",
    "end": "3242160"
  },
  {
    "text": "so we want to build proof of concept I meant to change that I didn't mean malware what I really meant were proof",
    "start": "3242160",
    "end": "3247599"
  },
  {
    "text": "of concept pen testing tools pen testing tools right make a note don't want to get sued again right but that you're",
    "start": "3247599",
    "end": "3254000"
  },
  {
    "text": "using other synchronization Services because Dropbox users shouldn't feel all the pain right what I don't want to",
    "start": "3254000",
    "end": "3259200"
  },
  {
    "text": "happen here is somebody says oh my God the sky is falling because Dropbox is insecure I'll move over to service X or",
    "start": "3259200",
    "end": "3265680"
  },
  {
    "text": "service y you know the reality is again their every bit is insecure actually more so because I haven't found another",
    "start": "3265680",
    "end": "3271559"
  },
  {
    "text": "vendor yet that's encrypting their databases on the on the drive right uh so they're not using these encrypted",
    "start": "3271559",
    "end": "3277640"
  },
  {
    "text": "databases the SQL light databases it takes away the challenges we have with Dropbox right so again to review those",
    "start": "3277640",
    "end": "3283559"
  },
  {
    "text": "challenges one is finding that synchronization folder I got no problem with any other service because those are",
    "start": "3283559",
    "end": "3288839"
  },
  {
    "text": "that configuration information is stored either in a plain text file which I think is laughable or like an i Oni file",
    "start": "3288839",
    "end": "3295160"
  },
  {
    "text": "back from the 80s right and so either that or it's sitting in a SQL light database which again is is easy to read",
    "start": "3295160",
    "end": "3301960"
  },
  {
    "text": "um with with any tool and so we don't have to worry about where that synchronization folder is likewise we",
    "start": "3301960",
    "end": "3307520"
  },
  {
    "text": "can pull out the hashed cred so we can immediately pull that other machine out of the loop right again that laptop",
    "start": "3307520",
    "end": "3312720"
  },
  {
    "text": "sitting at home we can just use the web UI from then on and that's that's that's awesome so note to vendors if you happen",
    "start": "3312720",
    "end": "3318040"
  },
  {
    "text": "to be a vendor for a synchronization service encrypt your databases because it makes my job phenomenally",
    "start": "3318040",
    "end": "3323720"
  },
  {
    "text": "harder uh other or other things we're looking at uh so extracting login",
    "start": "3323720",
    "end": "3328960"
  },
  {
    "text": "information from the web front ends from the client side databases uh likely",
    "start": "3328960",
    "end": "3334640"
  },
  {
    "text": "either black hat or defcom will be releasing some code that does this in the form of post exploitation modules for met exploit uh going in and that way",
    "start": "3334640",
    "end": "3341480"
  },
  {
    "text": "if you've got one of these dat databases uh that ultimately we'll have worked out how to rip the creds out of at least the",
    "start": "3341480",
    "end": "3346760"
  },
  {
    "text": "top top tier vendors uh again if we can get credentials some other way like the user logging in that would be awesome",
    "start": "3346760",
    "end": "3353480"
  },
  {
    "text": "maybe with a key logger or something but but the reality is is that you know Dropbox and the O they make it very easy",
    "start": "3353480",
    "end": "3358839"
  },
  {
    "text": "for the user the user enters the credentials once when they set the program up and then they never have to type them in again so once the user",
    "start": "3358839",
    "end": "3364760"
  },
  {
    "text": "manually opened up the browser surfed over to the site and typed in his password that would be the only time",
    "start": "3364760",
    "end": "3369839"
  },
  {
    "text": "that that that would be of of any consequence one of the things that's really really interesting though is if you log in I figured out that if you log",
    "start": "3369839",
    "end": "3376960"
  },
  {
    "text": "in and you create your account essentially so let's say that I'm using a super insecure password like",
    "start": "3376960",
    "end": "3382799"
  },
  {
    "text": "abc123 you know uh as my password or something like pass password whatever the case is and so Dropbox on my machine",
    "start": "3382799",
    "end": "3390520"
  },
  {
    "text": "now is using password or whatever that is as as the password and so down the road some security guy comes to me and",
    "start": "3390520",
    "end": "3396400"
  },
  {
    "text": "says hey that is a really stupid password you should fix that and I go and fix it it doesn't invalidate those",
    "start": "3396400",
    "end": "3401920"
  },
  {
    "text": "machines that are already set up to synchronize you would think then you would have to go re-enter your password on these other synchronization machines",
    "start": "3401920",
    "end": "3408359"
  },
  {
    "text": "or these other machines that are set to use password as a password but it turns out that's not at all the case and so uh",
    "start": "3408359",
    "end": "3415200"
  },
  {
    "text": "at least it isn't today I hope that that change gets made tomorrow because again this is a horribly insecure setup again",
    "start": "3415200",
    "end": "3421280"
  },
  {
    "text": "I'm sure you can picture some of the evil ramifications of that but ultimately extracting this login information so that we can totally cut",
    "start": "3421280",
    "end": "3427319"
  },
  {
    "text": "out whatever this uh this Bastion host is uh again it's an active area of research for us uh we expect to release",
    "start": "3427319",
    "end": "3432839"
  },
  {
    "text": "some code later this year on it so what's the conclusion well this isn't rocket science right anybody could have",
    "start": "3432839",
    "end": "3438960"
  },
  {
    "text": "written it uh if you're a pentester that that finds this useful I'm glad I could be of help the real Point here is I want",
    "start": "3438960",
    "end": "3444839"
  },
  {
    "text": "to demonstrate the vulnerability that this is that this is real I mean these file synchronization applications create",
    "start": "3444839",
    "end": "3450520"
  },
  {
    "text": "a real vulnerability in your network not because they have bad code and they're going to get exploited with some buffer",
    "start": "3450520",
    "end": "3456079"
  },
  {
    "text": "overflow although I think that's certainly possible as well uh again just because they're creating that backd door",
    "start": "3456079",
    "end": "3462599"
  },
  {
    "text": "basically a command and control Channel if you're comfortable with the vulnerability rock on forget I ever gave this talk right if you're not",
    "start": "3462599",
    "end": "3469280"
  },
  {
    "text": "comfortable with the vulnerability if you think wow this is insane that I have this channel that's not being protected",
    "start": "3469280",
    "end": "3474680"
  },
  {
    "text": "by DLP it's probably not being protected by my firewall right and Jake just showed me how to issue command and",
    "start": "3474680",
    "end": "3480440"
  },
  {
    "text": "control and release you know binaries on on DVD then this is a conversation you should be having with your security team",
    "start": "3480440",
    "end": "3486039"
  },
  {
    "text": "or you may be your security team I don't know make it you know have the conversation with the uh you know with the CFO or whoever it is that makes",
    "start": "3486039",
    "end": "3491920"
  },
  {
    "text": "those uh makes those decisions but but again this really started out as a project to uh basically help our clients",
    "start": "3491920",
    "end": "3498920"
  },
  {
    "text": "make an informed decision about risk right we looked at this when we were doing the Cloud forensics course and said holy goodness I I can't believe",
    "start": "3498920",
    "end": "3505760"
  },
  {
    "text": "this stuff actually works this way and then people just naysay they said oh no nobody would ever you bring up a",
    "start": "3505760",
    "end": "3510880"
  },
  {
    "text": "conceptual idea and everybody says no nobody would ever do that that's crazy right and so we built this ultimately",
    "start": "3510880",
    "end": "3515920"
  },
  {
    "text": "used it on pentest that was awesome too but but really the idea was that that we were trying to educate our clients about",
    "start": "3515920",
    "end": "3521559"
  },
  {
    "text": "the risk that it presents so again uh black hat would really appreciate it if you do feedback",
    "start": "3521559",
    "end": "3527000"
  },
  {
    "text": "surveys and thank you for your time and attention I'll be happy to answer any questions you guys have thanks",
    "start": "3527000",
    "end": "3535558"
  },
  {
    "text": "[Applause]",
    "start": "3538290",
    "end": "3541090"
  }
]