[
  {
    "text": "our next talk is a tale of one software bypass of Windows 8 secure boot With Yuri Andrew and Alex and I want to",
    "start": "40",
    "end": "7759"
  },
  {
    "text": "remind everybody there are uh survey Pods at the back of the room when you",
    "start": "7759",
    "end": "13080"
  },
  {
    "text": "leave if you touch your badge against that that will email you a survey that you can fill out and let us know how",
    "start": "13080",
    "end": "18240"
  },
  {
    "text": "we're doing uh what you think of the speakers and the facilities and all that we really appreciate everybody doing that also at the end of the talk if you",
    "start": "18240",
    "end": "24080"
  },
  {
    "text": "have questions there's a microphone over here uh just to make sure everybody's able to hear you thanks you ready",
    "start": "24080",
    "end": "31679"
  },
  {
    "text": "thanks Nathan yeah uh thank you everybody to uh um for showing up for our presentation",
    "start": "31679",
    "end": "40719"
  },
  {
    "text": "um so uh One Security Guru told me some time ago that um if you don't want to",
    "start": "40719",
    "end": "46600"
  },
  {
    "text": "sweat presenting to a large audience you can imagine that U uh the audience is",
    "start": "46600",
    "end": "52039"
  },
  {
    "text": "naked so I'll do that trick so dudes on the front rows um you'll going to be messing",
    "start": "52039",
    "end": "58399"
  },
  {
    "text": "with my psychology now if you could switch with the girls from the audience that would be great so anyway um on a",
    "start": "58399",
    "end": "66360"
  },
  {
    "text": "serious note so my name is Yuri um this is Andrew and Alex they're my uh co-w",
    "start": "66360",
    "end": "71640"
  },
  {
    "text": "Walkers and co-speaker they don't really speak English so I'll do the talking so whatever questions or concerns you have",
    "start": "71640",
    "end": "78240"
  },
  {
    "text": "please direct them to uh Alex and Andrew um so anyway let's get started um so",
    "start": "78240",
    "end": "86920"
  },
  {
    "text": "we're here today to talk about the Windows 8 secure Boot and the the problems in implementing uh Windows 8",
    "start": "86920",
    "end": "91960"
  },
  {
    "text": "scare boot on some of the platforms and this is a rough agenda really high level agenda we'll talk",
    "start": "91960",
    "end": "97960"
  },
  {
    "text": "about ufi um which is the new replacement for U Legacy biosis we'll talk about the booket problem then we'll",
    "start": "97960",
    "end": "104880"
  },
  {
    "text": "talk about how uh Windows 8 secure boot Sol is solving that problem or intense to solve that problem um then we'll jump",
    "start": "104880",
    "end": "111600"
  },
  {
    "text": "to um uh you know the security analysis of uh the implementations of the scare",
    "start": "111600",
    "end": "116719"
  },
  {
    "text": "boots and we'll conclude with the set of recommendations um so ufi and",
    "start": "116719",
    "end": "123079"
  },
  {
    "text": "bootkits this is a a rough picture of a u firmware software stack on Modern PC",
    "start": "123079",
    "end": "130759"
  },
  {
    "text": "systems or not just PC actually so you have a bottom layer which is a hardware",
    "start": "130760",
    "end": "136360"
  },
  {
    "text": "chipset CPU and a bunch of devices network cards um hard drives and so on",
    "start": "136360",
    "end": "141720"
  },
  {
    "text": "uh and you have a system firmer running on top of it which uh um if it confirms to the ufi then U um uh standard then U",
    "start": "141720",
    "end": "149920"
  },
  {
    "text": "it's a newer software or firmare in the past it was a Legacy BIOS um so um right",
    "start": "149920",
    "end": "155720"
  },
  {
    "text": "now in ufi terminology that's uh the fmer uh starts from SEC security phase",
    "start": "155720",
    "end": "161360"
  },
  {
    "text": "and then jumps to prei initialization phase where all the bootstrapping of the hardware is is happening um and then it",
    "start": "161360",
    "end": "167400"
  },
  {
    "text": "loads the U so-called driver execution environments core dispatcher uh so Dixie",
    "start": "167400",
    "end": "172879"
  },
  {
    "text": "so uh which is then responsible for extending the functionality of the ufi firmer by loading Dixie drivers from",
    "start": "172879",
    "end": "179959"
  },
  {
    "text": "let's say removable media um hard drive typically IFI system partition um option",
    "start": "179959",
    "end": "186680"
  },
  {
    "text": "ROMs EFI option ROMs they're they're the same Dixie drivers but they reside on add-on cards like network card or",
    "start": "186680",
    "end": "193239"
  },
  {
    "text": "graphics card or uh some EFI applications like preboot authentication or um diagnostic recovery update um or",
    "start": "193239",
    "end": "201400"
  },
  {
    "text": "um like ufi shell for example uh then uh then the um um uh in order to boot the",
    "start": "201400",
    "end": "208680"
  },
  {
    "text": "OS uh um the ufi compliance firware um loads bot loaders it could be um for a",
    "start": "208680",
    "end": "216080"
  },
  {
    "text": "Windows case that could be a boot manager firmer which is the U um um um Windows boot manager or fallback boot",
    "start": "216080",
    "end": "222920"
  },
  {
    "text": "loader which is boot x64 EFI which in in their turn load the OS loaders either",
    "start": "222920",
    "end": "229360"
  },
  {
    "text": "wind load or wind resume let's touch screen sorry so uh um",
    "start": "229360",
    "end": "235840"
  },
  {
    "text": "depending on whether you actually um um booting from called boot or um resuming",
    "start": "235840",
    "end": "241200"
  },
  {
    "text": "from S3 so then uh those loaders are responsible for loading OS kernel which is in its turn responsible for loading",
    "start": "241200",
    "end": "248280"
  },
  {
    "text": "boot time drivers and the rest of the drivers so um where is ufi in this",
    "start": "248280",
    "end": "253400"
  },
  {
    "text": "picture reality is ufi is um is only the middle of that picture it's an interface",
    "start": "253400",
    "end": "259120"
  },
  {
    "text": "between um system firmer which is platform specific code it's not legacy bias but it's still platform specific",
    "start": "259120",
    "end": "264919"
  },
  {
    "text": "it's uh a bunch of reference code for bootstrapping chipset CPU memory and so on um so and uhu and uh the layer above",
    "start": "264919",
    "end": "274080"
  },
  {
    "text": "it and uh below the OS that's the ufi actually so uh the benefits of moving to",
    "start": "274080",
    "end": "280800"
  },
  {
    "text": "the ufi from the Legacy world is that it's an industry standard interface between the firmer and Os it's agnostic",
    "start": "280800",
    "end": "288320"
  },
  {
    "text": "of the processor or chipset architecture and agnostic um um OS agnostic um it",
    "start": "288320",
    "end": "296560"
  },
  {
    "text": "there there is a c development environment edk or udate uh it offers a",
    "start": "296560",
    "end": "302000"
  },
  {
    "text": "re GUI based preboot application environment and it also includes the uh um um modular uh driver uh driver model",
    "start": "302000",
    "end": "309880"
  },
  {
    "text": "so you can you can load drivers to extend your functionality of your ufi based biosis um so um ufi boot Kates when they",
    "start": "309880",
    "end": "320520"
  },
  {
    "text": "come to the picture um at the moment we've we've we've know a a set of Legacy",
    "start": "320520",
    "end": "326800"
  },
  {
    "text": "boot Gates which infect nbrs vbrs and Associated dat but we haven't seen U fiber kits um and",
    "start": "326800",
    "end": "334120"
  },
  {
    "text": "uh that that is mostly because well we've seen PR Concepts but that is probably mostly because the os's are",
    "start": "334120",
    "end": "341240"
  },
  {
    "text": "still booting um and using Legacy boot through the MBR and so on so once the the OS has moved to the ufi boot uh",
    "start": "341240",
    "end": "348600"
  },
  {
    "text": "predominantly uh then we'll probably see a surge of uh um Legacy boot kits moving",
    "start": "348600",
    "end": "353720"
  },
  {
    "text": "to U um to the ufi bo KS oh come on this is touch screen that's interesting",
    "start": "353720",
    "end": "360000"
  },
  {
    "text": "so um yeah so um so how do the how do",
    "start": "360000",
    "end": "365240"
  },
  {
    "text": "how how UI with kits compromise the system uh assume you youve you've got you've got infected by browser exploit",
    "start": "365240",
    "end": "372199"
  },
  {
    "text": "or browser plug-in exploit or something so you have M on the system uh which then can for example replace the um um",
    "start": "372199",
    "end": "380639"
  },
  {
    "text": "one of the ufi boot loaders fullback boot loader Windows bid manager um and",
    "start": "380639",
    "end": "386199"
  },
  {
    "text": "uh that has been actually demonstrated uh as a proof of Concept in couple of Publications so for example the",
    "start": "386199",
    "end": "392160"
  },
  {
    "text": "replacing Windows Manager on the EFI system partition on the fix drive it was demonstrated by um in in the paper by",
    "start": "392160",
    "end": "398199"
  },
  {
    "text": "itac replacing fullback boot loader it's um it's it's what dream boot is using in",
    "start": "398199",
    "end": "403360"
  },
  {
    "text": "in their proof of concept um in addition the uh the exploit could actually add their own boot loader instead of",
    "start": "403360",
    "end": "409720"
  },
  {
    "text": "replacing one of the existing bootloaders uh in in order to do that the exploit would need to do some additional actions like uh uh modify",
    "start": "409720",
    "end": "416800"
  },
  {
    "text": "some of thei system variables um like but order or boot 1 2 3 4 and so on",
    "start": "416800",
    "end": "422759"
  },
  {
    "text": "variables um the other way to install ufi bootkit would be instead of",
    "start": "422759",
    "end": "427840"
  },
  {
    "text": "replacing boot loader um uh the uh the exploit could add the Dixit driver which will get dispatched before uh before the",
    "start": "427840",
    "end": "435319"
  },
  {
    "text": "boot loader um and U drop that Dixie driver on a EFI system protection or or",
    "start": "435319",
    "end": "440840"
  },
  {
    "text": "even removable media uh so that in order to do that and and typically that",
    "start": "440840",
    "end": "446160"
  },
  {
    "text": "wouldn't involve patching the bias right that would be non-embedded so Dixie driver and that would that would also",
    "start": "446160",
    "end": "452440"
  },
  {
    "text": "require changing some variables um like driver order and Driver um 0 1 2 3 and",
    "start": "452440",
    "end": "459759"
  },
  {
    "text": "so on uh the other the other option for um ufi boot kits um is to replace ufi based",
    "start": "459759",
    "end": "468319"
  },
  {
    "text": "option ROMs in one of the add-on cards not not embedded let's say for a network cart you can see that the network card",
    "start": "468319",
    "end": "473400"
  },
  {
    "text": "is in red here so it's kind of shows that um the exploit first has to compromise the option ROM on that",
    "start": "473400",
    "end": "478759"
  },
  {
    "text": "Network C and the option run will get loaded uh will get dispatched by Dixie um so that has been demonstrated by",
    "start": "478759",
    "end": "486120"
  },
  {
    "text": "snare last time last year at black hat um uh on Mac um MacBooks so those are",
    "start": "486120",
    "end": "493360"
  },
  {
    "text": "those are and there are some additional options for example the the the O the exploit could replace the OS loaders",
    "start": "493360",
    "end": "498840"
  },
  {
    "text": "wind load wind resume uh it's a little bit up on the uh um low chain so um that",
    "start": "498840",
    "end": "505919"
  },
  {
    "text": "might be not that attractive but anyway or the exploit could patch the good session table GPT um on a hard drive um",
    "start": "505919",
    "end": "513000"
  },
  {
    "text": "so there are multiple options to for bot kits to in to get installed and so once",
    "start": "513000",
    "end": "519279"
  },
  {
    "text": "once they um once they' once they've in once they exploited installed the bitkit",
    "start": "519279",
    "end": "524399"
  },
  {
    "text": "then obviously you cannot guarantee any any other uh boot of the OS uh so um any",
    "start": "524399",
    "end": "530000"
  },
  {
    "text": "any further OS component or even firmer component um is now compromised and",
    "start": "530000",
    "end": "535200"
  },
  {
    "text": "under the uh uh control of the botkit and more importantly the botkit has is is persistent so there's no need to run",
    "start": "535200",
    "end": "542000"
  },
  {
    "text": "the exploit every time uh the bootkit is there forever um you reinstall the OS and bootkit is still",
    "start": "542000",
    "end": "548480"
  },
  {
    "text": "there um and this is an example of U our you know proof of concept book kit",
    "start": "548480",
    "end": "555240"
  },
  {
    "text": "running on on the uh one of the systems that we'll be showing demo on I'll I'll",
    "start": "555240",
    "end": "561040"
  },
  {
    "text": "pause for a couple of seconds in the recent you know uh government leaks that that's an important message right so",
    "start": "561040",
    "end": "568040"
  },
  {
    "text": "[Music] all right um so like I",
    "start": "568040",
    "end": "573880"
  },
  {
    "text": "said uh we should expect UI B kits uh or Legacy boot kits move to the",
    "start": "573880",
    "end": "581200"
  },
  {
    "text": "ufi boot kits as soon as the OS has moved their legacy based NBR based boot to the ufi boot that's the natural you",
    "start": "581200",
    "end": "588760"
  },
  {
    "text": "know evolution of the boot kits we'll we'll see them soon uh so how that problem generally fixed or how how how",
    "start": "588760",
    "end": "596480"
  },
  {
    "text": "we want to fix it right and uh the Windows 8 secure B is precisely the uh",
    "start": "596480",
    "end": "601920"
  },
  {
    "text": "architecture um that is intended to solve that problem so let's uh let's see",
    "start": "601920",
    "end": "606959"
  },
  {
    "text": "how that that that that actually does um again the same picture you have a system firmare platform specific running on top",
    "start": "606959",
    "end": "613360"
  },
  {
    "text": "of hardware and this is a root of trust because this is this system fir initiates the uh U um you know the",
    "start": "613360",
    "end": "620279"
  },
  {
    "text": "secure boot um checks right so but the reality is while this is a root of trust",
    "start": "620279",
    "end": "627120"
  },
  {
    "text": "and it's supposed to be mutable uh the reality it is it's just a sof it's just a software on um on on a nonvolatile",
    "start": "627120",
    "end": "634680"
  },
  {
    "text": "memory typically is py Flash and uh it it it has to be update it has to be",
    "start": "634680",
    "end": "640040"
  },
  {
    "text": "datable you have to have you have to be able to patch it so um and that's why in",
    "start": "640040",
    "end": "645959"
  },
  {
    "text": "order for this um piece of software to be mutable it has to rely on that the",
    "start": "645959",
    "end": "651600"
  },
  {
    "text": "update mechanism is secure or let's say SED so it has to use signed ufi based",
    "start": "651600",
    "end": "657920"
  },
  {
    "text": "capsule updates for example uh so once this uh you know immutable piece of firmware is established and",
    "start": "657920",
    "end": "665040"
  },
  {
    "text": "secured through the update mechanism then uh it can do the checks on the further component for example the option",
    "start": "665040",
    "end": "672399"
  },
  {
    "text": "ROMs are all validated the signatures are validated or the hashes are validated uh before before dispatching",
    "start": "672399",
    "end": "679200"
  },
  {
    "text": "option R uh the add died drivers which are loaded from um non-embedded media",
    "start": "679200",
    "end": "684720"
  },
  {
    "text": "like removable or fixed drives um the signatures and hashes are checked um any",
    "start": "684720",
    "end": "690000"
  },
  {
    "text": "application like ufi shell um uh is um is checked for you know",
    "start": "690000",
    "end": "695399"
  },
  {
    "text": "for Signature of it is checked and more importantly the the OS and Bot loaders",
    "start": "695399",
    "end": "701760"
  },
  {
    "text": "um are also verified before before they're before they're loaded and execute it and this is what ufi secur",
    "start": "701760",
    "end": "707880"
  },
  {
    "text": "bit is right but now we have to continue that chain of verification up until the",
    "start": "707880",
    "end": "714120"
  },
  {
    "text": "OS and even and even further so so the bit loader typically verifies the uh uh",
    "start": "714120",
    "end": "719760"
  },
  {
    "text": "signature or the hash off the uh OS loaders like when when when load when resume which in its ter verifies the uh",
    "start": "719760",
    "end": "726880"
  },
  {
    "text": "the kernel uh including early lch antim malware module which you know allows U",
    "start": "726880",
    "end": "732600"
  },
  {
    "text": "antivirus companies to sign their module with Microsoft um and uh load before any",
    "start": "732600",
    "end": "738560"
  },
  {
    "text": "boot time driver is is loaded so that they could check those drivers",
    "start": "738560",
    "end": "745360"
  },
  {
    "text": "so okay",
    "start": "745720",
    "end": "749720"
  },
  {
    "text": "yeah and the the the OS Kel then is responsible for enforcing signature",
    "start": "751800",
    "end": "757160"
  },
  {
    "text": "checks on the OS drivers right so this is Windows 8 secure boot which sits on top of ufi secure Boot and U you know",
    "start": "757160",
    "end": "764720"
  },
  {
    "text": "creates the whole picture from the start to the OS so um secur relies on certain Keys uh",
    "start": "764720",
    "end": "772519"
  },
  {
    "text": "to operate correctly and securely so one of the keys is a platform key it's a root certificate provided by the",
    "start": "772519",
    "end": "779160"
  },
  {
    "text": "platform manufacturer and it's typically stored in non-volatile memory like in Sp spy flash um and it is a um it is used",
    "start": "779160",
    "end": "786680"
  },
  {
    "text": "to verify the update of the key exchange key and the key exchange key or a set of keys it's a it's a set of certificates",
    "start": "786680",
    "end": "793920"
  },
  {
    "text": "um typically belonging to uh Microsoft or platform vendor or or even um or or",
    "start": "793920",
    "end": "800320"
  },
  {
    "text": "Linux or um anyone can install actually so um they are used to uh verify the",
    "start": "800320",
    "end": "806959"
  },
  {
    "text": "updates to the next DB and DBS X um uh databases and and those databases um DB",
    "start": "806959",
    "end": "813639"
  },
  {
    "text": "is a allowed database it contains um x509",
    "start": "813639",
    "end": "819160"
  },
  {
    "text": "certificates or U shaan sha 256 sorry 256 hashes um of the allowed images of",
    "start": "819160",
    "end": "826680"
  },
  {
    "text": "the images that are uh that are allowed to boot uh in dbx this is a forbidden database it it contains the same",
    "start": "826680",
    "end": "832880"
  },
  {
    "text": "information for the images that are prohibited uh to to boot that are not allowed to boot in the earlier versions",
    "start": "832880",
    "end": "839680"
  },
  {
    "text": "uh DB dbx contained some other information like directly RSA public keys or the pkcs7 signatures but not",
    "start": "839680",
    "end": "846440"
  },
  {
    "text": "anymore in the new um versions of the ufi code so and there are in addition to",
    "start": "846440",
    "end": "853360"
  },
  {
    "text": "keys there there is some configuration nonvolatile conf uh well configuration that secur relies on and that",
    "start": "853360",
    "end": "859839"
  },
  {
    "text": "configuration has certain protection so let's talk about that well first the non-volatile EFI variables those are",
    "start": "859839",
    "end": "865240"
  },
  {
    "text": "variables that are stored in the NV Ram they're um they're persistent across all Boots the boot service type of variables",
    "start": "865240",
    "end": "872839"
  },
  {
    "text": "this is a this the attribute of the variables uh that says that this variable is accessible at the boot time",
    "start": "872839",
    "end": "878759"
  },
  {
    "text": "before the OS runtime um as opposed to runtime attribute which uh identifies",
    "start": "878759",
    "end": "883800"
  },
  {
    "text": "variables that are writeable from the OS runtime right so U and typically OS",
    "start": "883800",
    "end": "889199"
  },
  {
    "text": "provides an API to the ufi runtime API to write to those variables uh and uh",
    "start": "889199",
    "end": "894279"
  },
  {
    "text": "and the protection for uh secure boot Keys uh is actually coming from the uh authenticated attribute that that's the",
    "start": "894279",
    "end": "900800"
  },
  {
    "text": "attribute for AI variables that um says that this variable can only be updated if you have a uh proper private key so",
    "start": "900800",
    "end": "908959"
  },
  {
    "text": "if you if you can sign the update and this signature can be verified by the",
    "start": "908959",
    "end": "914240"
  },
  {
    "text": "certificate in one of the um existing V variables in nvram so for example if you",
    "start": "914240",
    "end": "919360"
  },
  {
    "text": "update platform key or key exchange key then you have to sign it with the private key and the public key um uh",
    "start": "919360",
    "end": "926279"
  },
  {
    "text": "should be in the PK variable already in nvram um and so on so uh it's not just",
    "start": "926279",
    "end": "931399"
  },
  {
    "text": "for secure but generally uh there are other variables that can be authenticated and you have to have a",
    "start": "931399",
    "end": "936560"
  },
  {
    "text": "certificate in a specific C DB EFI variable to verify the update so um this",
    "start": "936560",
    "end": "943399"
  },
  {
    "text": "is an example of platform key the master root key for scare boot on the this Asus",
    "start": "943399",
    "end": "949240"
  },
  {
    "text": "uh um laptop that we're using for demo right so um it's RSA to uh",
    "start": "949240",
    "end": "956519"
  },
  {
    "text": "2048 um okay so um um the the other configuration that",
    "start": "956519",
    "end": "963079"
  },
  {
    "text": "secure bid relies on is is the following on that foil so there's a master enable disable control which essentially",
    "start": "963079",
    "end": "969839"
  },
  {
    "text": "disables or enables secure bit it's not it's not nonvolatile it's uh it's initiated at the boot time there's a",
    "start": "969839",
    "end": "976519"
  },
  {
    "text": "setup mode setup mode is a um is a config is a setting for scare boot that says that hey uh the platform doesn't",
    "start": "976519",
    "end": "983800"
  },
  {
    "text": "have platform key installed in that case setup mode is set to setup mode otherwise it's set to user mode um and",
    "start": "983800",
    "end": "991279"
  },
  {
    "text": "um if the if if if the ufi firm is in setup mode then the update for to to K",
    "start": "991279",
    "end": "997480"
  },
  {
    "text": "exchange keys or DB dbx are allowed um so custom mode that's the uh that's the",
    "start": "997480",
    "end": "1003680"
  },
  {
    "text": "uh mode of secure boot that allows you to update uh any keys for scare boot",
    "start": "1003680",
    "end": "1008959"
  },
  {
    "text": "even if platform key is installed and it's typically should be modifiable only by physically present user uh and the",
    "start": "1008959",
    "end": "1015959"
  },
  {
    "text": "last one is secur boot enable it's the um it's the variable with it's a master Global enable disable control similarly",
    "start": "1015959",
    "end": "1022279"
  },
  {
    "text": "to the first one but the non-volatile version of that of that control so again it has to be changed it has to be modif",
    "start": "1022279",
    "end": "1029520"
  },
  {
    "text": "modifiable only when the user is physically present when it approves the change so uh there are dependencies on",
    "start": "1029520",
    "end": "1036160"
  },
  {
    "text": "those variables for example if platform key doesn't exist then the setup mode is set to setup mode otherwise it's set to",
    "start": "1036160",
    "end": "1042880"
  },
  {
    "text": "user mode uh if secure bot enabled variable um exists in nvram then um um",
    "start": "1042880",
    "end": "1049200"
  },
  {
    "text": "and if if if if the if the value is secure boot enable and the setup mode is in user mode then the global secure boot",
    "start": "1049200",
    "end": "1055960"
  },
  {
    "text": "is enabled otherwise it's disabled if secb enabled variable doesn't exist then",
    "start": "1055960",
    "end": "1061760"
  },
  {
    "text": "it it only depends on setup mode so if setup mode is in user mode then we enable skure bo uh I mean ufi firmware",
    "start": "1061760",
    "end": "1069799"
  },
  {
    "text": "uh if if it's in a setup mode then it's skure boot is disabled so it's important",
    "start": "1069799",
    "end": "1075280"
  },
  {
    "text": "to understand those dependencies uh there are policies so for example when you load IM you can load images from",
    "start": "1075280",
    "end": "1081919"
  },
  {
    "text": "different places from embedded firmer volume on the Spy flash or from removable Media or from fixed media and",
    "start": "1081919",
    "end": "1088120"
  },
  {
    "text": "you can and and the ufi firware wants to apply certain policies what to do with those images so for example if you load",
    "start": "1088120",
    "end": "1093840"
  },
  {
    "text": "it from embedded for volume then the signatures are never checked if you're loading from removable Media or fixed",
    "start": "1093840",
    "end": "1100000"
  },
  {
    "text": "media then the corresponding policy is is applied uh also there are policies",
    "start": "1100000",
    "end": "1105400"
  },
  {
    "text": "what to do on signature violation or the the security violation uh for example you can ask the user what to do with",
    "start": "1105400",
    "end": "1111640"
  },
  {
    "text": "that image it's the signature didn't pass validation or the hash so or you",
    "start": "1111640",
    "end": "1116679"
  },
  {
    "text": "can deny execution so let's have a look at the uh the actual process of uh validating the",
    "start": "1116679",
    "end": "1123000"
  },
  {
    "text": "images first the uh the code the flow that validates um um uh all the loaded",
    "start": "1123000",
    "end": "1128720"
  },
  {
    "text": "images um uh and this code is uh uh registered as a you know a call back so",
    "start": "1128720",
    "end": "1134720"
  },
  {
    "text": "every time any eii based image is loaded this uh this code is uh is invoked right um and uh so it it does those",
    "start": "1134720",
    "end": "1141799"
  },
  {
    "text": "checks first it checks policies again if the policy if the image is from embedded firm volume then it just says hey I",
    "start": "1141799",
    "end": "1148760"
  },
  {
    "text": "don't care load it I rely on the update secure update uh or if it's in fix it uh",
    "start": "1148760",
    "end": "1154400"
  },
  {
    "text": "media then it takes the policy and applies that policy if policy says",
    "start": "1154400",
    "end": "1159559"
  },
  {
    "text": "always execute it just returns without any checks if policy says did not execute it returns uh uh it prevents",
    "start": "1159559",
    "end": "1167360"
  },
  {
    "text": "image from loading again without any checks so after checking the policy checks configuration if secure Bo is",
    "start": "1167360",
    "end": "1173880"
  },
  {
    "text": "disabled no need to do any checks um if the um file is not in recognized format",
    "start": "1173880",
    "end": "1181000"
  },
  {
    "text": "then uh it's not allowed to execute uh in earlier versional versions of the ufi",
    "start": "1181000",
    "end": "1186200"
  },
  {
    "text": "code uh they've been checking um some other things some like scbo enable directly or setup mode but now they're",
    "start": "1186200",
    "end": "1193200"
  },
  {
    "text": "those checks are redundant because they feed into the the first check so it's removed",
    "start": "1193200",
    "end": "1199640"
  },
  {
    "text": "so and then once those checks passed then of course you need to check actual crypto and U um essentially hashes or",
    "start": "1199640",
    "end": "1206880"
  },
  {
    "text": "signatures are verified by secure boot if the image is not signed then the flow",
    "start": "1206880",
    "end": "1212280"
  },
  {
    "text": "checks for a shot 256 hash if it's if it's found in uhoh prohibited sorry",
    "start": "1212280",
    "end": "1218760"
  },
  {
    "text": "prohibited database then the image is not allowed to execute otherwise if it's found in the allowed database then the",
    "start": "1218760",
    "end": "1224480"
  },
  {
    "text": "image is allowed to execute uh if the image is signed then the code goes through all the signatures because uh P",
    "start": "1224480",
    "end": "1231159"
  },
  {
    "text": "image can have multiple signatures and uh if it finds any signature which is verified by the root or intermediate",
    "start": "1231159",
    "end": "1237880"
  },
  {
    "text": "certificate in the prohibited database then it blocks the image or if it sees that hey if the hash is in dbx then",
    "start": "1237880",
    "end": "1245520"
  },
  {
    "text": "again it prohibits damage uh then it checks all the signatures if if if none of the signatures in the prohibited",
    "start": "1245520",
    "end": "1251640"
  },
  {
    "text": "database then it checks all the signatures again and uh if the any signature is verified by the root",
    "start": "1251640",
    "end": "1257880"
  },
  {
    "text": "certificate in the allowed database then in that case it allows to boot that image or the hash is in the allowed",
    "start": "1257880",
    "end": "1263440"
  },
  {
    "text": "database in all other cases the uh load is uh prohibited this is the latest",
    "start": "1263440",
    "end": "1269000"
  },
  {
    "text": "version well at least couple months old um and uh the flow is changing over time",
    "start": "1269000",
    "end": "1274400"
  },
  {
    "text": "so in the past the biases could be built on a slightly different uh version of the ufi in reality so uh and this is the",
    "start": "1274400",
    "end": "1281720"
  },
  {
    "text": "secure boot in action on this on this laptop so uh when when when we try to replace the UI the bit loader for",
    "start": "1281720",
    "end": "1288120"
  },
  {
    "text": "example with our botkit without uh compromising secure boot first uh then we got that screen and we cannot load",
    "start": "1288120",
    "end": "1295159"
  },
  {
    "text": "our botkit so um as you can see the uh Windows 8 secb is a pretty important",
    "start": "1295159",
    "end": "1302360"
  },
  {
    "text": "protection against the BookIt problem so uh we need to make it um you know we",
    "start": "1302360",
    "end": "1310159"
  },
  {
    "text": "need to make sure that it's implemented correctly and with that we're jumping to attacking Windows 8 secure so as a brief",
    "start": "1310159",
    "end": "1317440"
  },
  {
    "text": "disclosure the issue are in the implementation of secure boot on specific certain platforms not in the",
    "start": "1317440",
    "end": "1323760"
  },
  {
    "text": "core you know ufi or windows8 secure boot um so this is uh you know the easy",
    "start": "1323760",
    "end": "1331200"
  },
  {
    "text": "and Universal exploited against secur boot all you need to do is go reboot your system enter bio setup screen and",
    "start": "1331200",
    "end": "1338600"
  },
  {
    "text": "there's an option disable secure boot so you can click it disable secure Boot and now you have secure disabled but of",
    "start": "1338600",
    "end": "1344720"
  },
  {
    "text": "course you need to Brute Force the key combination to enter setup screen because all all the platforms Implement differently so that's a protection right",
    "start": "1344720",
    "end": "1352200"
  },
  {
    "text": "so uh anyway I'm messing with you so this is physical access right so secure",
    "start": "1352200",
    "end": "1357480"
  },
  {
    "text": "boot does not prevent physical access attacks you should be able to go into bu",
    "start": "1357480",
    "end": "1363279"
  },
  {
    "text": "setup screen and disable it because you want to run any some some type of some type of other OS like uh Linux or",
    "start": "1363279",
    "end": "1370880"
  },
  {
    "text": "whatever so uh you need to have a capability to to disable it so it was a",
    "start": "1370880",
    "end": "1376600"
  },
  {
    "text": "joke so Let's uh let's get to actual attacks so attacks are considered in",
    "start": "1376600",
    "end": "1382799"
  },
  {
    "text": "scope are software attacks basically mware uh we think of uh um you know",
    "start": "1382799",
    "end": "1388559"
  },
  {
    "text": "secur boot as something monolithic like from Microsoft developed by Microsoft and uh you know and uh it it may have",
    "start": "1388559",
    "end": "1395120"
  },
  {
    "text": "bugs and bugs will get fixed and everything will be fine um right or at least maybe not that monolithic but",
    "start": "1395120",
    "end": "1402080"
  },
  {
    "text": "again monolithic Windows 8 SEC but relying on monolithic ufi secure you know uh so but in reality the picture is",
    "start": "1402080",
    "end": "1409279"
  },
  {
    "text": "different you have multiple bias cores uh from multiple bias vendors and they",
    "start": "1409279",
    "end": "1415080"
  },
  {
    "text": "Implement secur bit differently slightly differently maybe not that drastically like I'm showing in the foil but still",
    "start": "1415080",
    "end": "1421600"
  },
  {
    "text": "differently and even that net close because uh we have platform vendors um",
    "start": "1421600",
    "end": "1427400"
  },
  {
    "text": "who deel which develop their own biases uh slightly differently including secure Boot and configure secur slightly",
    "start": "1427400",
    "end": "1433840"
  },
  {
    "text": "differently and plus they use different bios scores so uh the picture is uh um",
    "start": "1433840",
    "end": "1439000"
  },
  {
    "text": "is uh you know much more complex and more interesting than just a monolithic implementation as we may think of it so",
    "start": "1439000",
    "end": "1446520"
  },
  {
    "text": "um based on that picture we can all we you can always conclude that Windows 8 secure Bo only secure when all all",
    "start": "1446520",
    "end": "1453159"
  },
  {
    "text": "platform vendors and bias vendors do a couple of things correctly and those are a couple of things um they allow sign UI",
    "start": "1453159",
    "end": "1460919"
  },
  {
    "text": "fir updates only science updates uh they protect the ufi firm and spy fles from",
    "start": "1460919",
    "end": "1466399"
  },
  {
    "text": "direct modification they protect the firmer update components because since you sign updates you have to protect the",
    "start": "1466399",
    "end": "1472240"
  },
  {
    "text": "code that does update so if it it's either in the smm or early in the Dixie phase right they program um spy",
    "start": "1472240",
    "end": "1480240"
  },
  {
    "text": "controller and the Flash descriptor correctly they protect the SEC bit enable and and all the keys for for for",
    "start": "1480240",
    "end": "1486880"
  },
  {
    "text": "a secure bit and EnV Ram they Implement variable authenticated in the smm and the physical presence checks required to",
    "start": "1486880",
    "end": "1493799"
  },
  {
    "text": "update some of the variables right they uh they protect the set variable API",
    "start": "1493799",
    "end": "1499320"
  },
  {
    "text": "uh the securely disabled compatibility support module which allows you to putot Legacy Os or Legacy option ROMs on top",
    "start": "1499320",
    "end": "1505640"
  },
  {
    "text": "of U IFI bias um and uh and uh you know they uh disable loading Legacy option RS",
    "start": "1505640",
    "end": "1513360"
  },
  {
    "text": "and the MBR boot so they configure secure boot image verific secure image verification policies they built their",
    "start": "1513360",
    "end": "1520240"
  },
  {
    "text": "platform firmware using latest U UI edk sources they correctly Implement",
    "start": "1520240",
    "end": "1525600"
  },
  {
    "text": "signature checks and crypto functionality and not roduce a single bug in all of this so there's couple of",
    "start": "1525600",
    "end": "1531480"
  },
  {
    "text": "things that every platform manufacturer has to do in order for a secur boo to be secure um and you know what the",
    "start": "1531480",
    "end": "1539039"
  },
  {
    "text": "Microsoft actually uh thought about most of them and uh they've created a Windows 8 Hardware certification requirements",
    "start": "1539039",
    "end": "1545159"
  },
  {
    "text": "which um which which states um most of those uh most of those requirements for",
    "start": "1545159",
    "end": "1551480"
  },
  {
    "text": "example when secur Bo is enabled CSM must not be enabled right uh secur bo",
    "start": "1551480",
    "end": "1556600"
  },
  {
    "text": "must be rooted in the in the protector Rome based platform key uh the problem is uh well this is a requirement",
    "start": "1556600",
    "end": "1562640"
  },
  {
    "text": "document reality is this is a Microsoft wish list right and the platform vendors",
    "start": "1562640",
    "end": "1568120"
  },
  {
    "text": "do not necessarily adhere to those requirements so um and uh we're getting to you know the weight chain right of",
    "start": "1568120",
    "end": "1575679"
  },
  {
    "text": "the uh the whole secure bed implementation so for example let's take the first requirement what if UI bu",
    "start": "1575679",
    "end": "1582320"
  },
  {
    "text": "updates are not signed well obviously now you're breaking that uh static core of trust",
    "start": "1582320",
    "end": "1589240"
  },
  {
    "text": "for score core Ro of trust immutability um you know protection so uh you can now",
    "start": "1589240",
    "end": "1595880"
  },
  {
    "text": "update your firmer including the add dii image verification Li driver which is actually responsible for enforcing",
    "start": "1595880",
    "end": "1602080"
  },
  {
    "text": "signature checks just directly in the Rong so um um that's that's a problem",
    "start": "1602080",
    "end": "1607960"
  },
  {
    "text": "but on those this system we have a um you know implemented ufi former capsule",
    "start": "1607960",
    "end": "1613080"
  },
  {
    "text": "updates using RSA 2248 and shot 256 so we are out of luck here um but let's",
    "start": "1613080",
    "end": "1621799"
  },
  {
    "text": "check one little thing uh let's just try it directly",
    "start": "1621799",
    "end": "1626960"
  },
  {
    "text": "right to the firmware code on the Spy Flash and uh the bottom the the the top",
    "start": "1626960",
    "end": "1632120"
  },
  {
    "text": "of that screenshot shows that hey we've dumped some of the uh some of the contents of the bias region in spy Flash",
    "start": "1632120",
    "end": "1637720"
  },
  {
    "text": "and its ol laughs then we try to write to it and you can see that we actually",
    "start": "1637720",
    "end": "1642880"
  },
  {
    "text": "succeeded writing some bogus data and the data shows that I'm mean your bias don't worry your OS bit has has been",
    "start": "1642880",
    "end": "1648440"
  },
  {
    "text": "secured black hat 2013 so we or the vendor went to all the pain",
    "start": "1648440",
    "end": "1656520"
  },
  {
    "text": "to implement science bias ufi bias updates but the firm is directly",
    "start": "1656520",
    "end": "1662039"
  },
  {
    "text": "writable what's the point um well there's definitely something can go",
    "start": "1662039",
    "end": "1668840"
  },
  {
    "text": "wrong with that um setup right so for example Mal can Pat directly the code uh",
    "start": "1668840",
    "end": "1674120"
  },
  {
    "text": "without going through the update mechanism so let's uh let's see how that exploit works so you you've got an O OS",
    "start": "1674120",
    "end": "1679640"
  },
  {
    "text": "exploit um and the firm Ray is not protected in ROM so the exploit will",
    "start": "1679640",
    "end": "1685880"
  },
  {
    "text": "will go to the uh directly to the Spy controller talk to it through um you",
    "start": "1685880",
    "end": "1691080"
  },
  {
    "text": "know uh configuration registers in mm or PCI config space whatever uh we'll",
    "start": "1691080",
    "end": "1696640"
  },
  {
    "text": "program that spy controller will'll issue a set of spy rights and modify directly the the firmware on the Spy",
    "start": "1696640",
    "end": "1701840"
  },
  {
    "text": "flash or uh the uh the EnV Ram with all the keys right so uh then after that the",
    "start": "1701840",
    "end": "1708320"
  },
  {
    "text": "uh the exploit would install the book kit and of course since the uh the firmer the root of trust is not really",
    "start": "1708320",
    "end": "1716159"
  },
  {
    "text": "uh it has been corrupted or modified then it will not enforce that the botkit bitkit signature checks so the bitkit",
    "start": "1716159",
    "end": "1723159"
  },
  {
    "text": "will load and the boot kit of course will not enforce any checks on the further components now we've got a compromise uh compromise full boot",
    "start": "1723159",
    "end": "1730080"
  },
  {
    "text": "compromise so what are the strategies that the uh Dixie or that that's that the uh the exploit could take first it",
    "start": "1730080",
    "end": "1736480"
  },
  {
    "text": "could patch directly the uh the the the code that actually verifies the signatures but it's platform specific",
    "start": "1736480",
    "end": "1742559"
  },
  {
    "text": "it's specific on the version of adk used to build the the firmware it's specific on the bias version or bias core version",
    "start": "1742559",
    "end": "1749519"
  },
  {
    "text": "so it's uh it's doable but um relatively complex so in addition instead the the",
    "start": "1749519",
    "end": "1755720"
  },
  {
    "text": "exploit could replace or add the the hash of the book kit or the certificate",
    "start": "1755720",
    "end": "1760760"
  },
  {
    "text": "uh in the DB allowed database so now your your bootkit is in the allowed database it is a generic platform",
    "start": "1760760",
    "end": "1767039"
  },
  {
    "text": "independent exploit but can be easily found by just dumping that DB database and checking for Signature so",
    "start": "1767039",
    "end": "1772600"
  },
  {
    "text": "antimalware Solutions uh can uh can easily find that similarly the uh the",
    "start": "1772600",
    "end": "1778039"
  },
  {
    "text": "the exploit could add the root certificate into the key exchange key variable or even the platform key",
    "start": "1778039",
    "end": "1783480"
  },
  {
    "text": "replace platform key with the bootkits platform key and in that case the signature of the bootkit will be correct",
    "start": "1783480",
    "end": "1789480"
  },
  {
    "text": "um uh but again same arguments It's relatively easy to spot that so the uh",
    "start": "1789480",
    "end": "1794880"
  },
  {
    "text": "the the other strategies that the exploit could take is uh it can um well",
    "start": "1794880",
    "end": "1800480"
  },
  {
    "text": "ufi defines the global secure bit enable control and it should be you know one bit somewhere stored somewhere so it",
    "start": "1800480",
    "end": "1806600"
  },
  {
    "text": "should be easy just flip them one bit from one to zero and disable secut but reality is is not that simple so the",
    "start": "1806600",
    "end": "1812640"
  },
  {
    "text": "platform vendors don't don't really uh in most cases use that variable they use a very platform and vendor specific",
    "start": "1812640",
    "end": "1819640"
  },
  {
    "text": "places to store that that that control and uh basically if they're using other",
    "start": "1819640",
    "end": "1825799"
  },
  {
    "text": "EFI variables then you have to parse the proprietor and VM format and that's uh that's some that sometimes that's pain",
    "start": "1825799",
    "end": "1832399"
  },
  {
    "text": "in the butt and and even even even in addition to that they can actually store",
    "start": "1832399",
    "end": "1837720"
  },
  {
    "text": "multiple copies of that thing in their proprietary nvram so we've implemented that we've implemented a simple strategy",
    "start": "1837720",
    "end": "1844399"
  },
  {
    "text": "we just replace the NV the whole thing to the state once SEC Bo was off yeah yeah it works so but it takes you know",
    "start": "1844399",
    "end": "1850799"
  },
  {
    "text": "10 minutes to run the exploit so it's not that uh it's not that interesting so",
    "start": "1850799",
    "end": "1856720"
  },
  {
    "text": "um and we did par the um format proprietary format for most of the biosis out there so this is the",
    "start": "1856720",
    "end": "1863960"
  },
  {
    "text": "proprietary formats of the nvram on that Asus uh system it's uh you can see that",
    "start": "1863960",
    "end": "1869200"
  },
  {
    "text": "it actually has linked list of variables it doesn't store the let's say secure boot enable as one or zero it has a link",
    "start": "1869200",
    "end": "1876399"
  },
  {
    "text": "at list of variables if secure bot is off then the pointer to the next variable is all FS or if secur boot is",
    "start": "1876399",
    "end": "1882799"
  },
  {
    "text": "on then the pointer is actually pointing to some the next variable so if it's uh",
    "start": "1882799",
    "end": "1888960"
  },
  {
    "text": "it's it's pretty complex thing um so the simple strategy the exploit could take",
    "start": "1888960",
    "end": "1894320"
  },
  {
    "text": "to bypass secure boot is remember when platform key is not installed what",
    "start": "1894320",
    "end": "1900320"
  },
  {
    "text": "happens the system goes into setup mode once the system goes into setup mode secure boot is off yeah you don't have",
    "start": "1900320",
    "end": "1906200"
  },
  {
    "text": "root key well yeah you cannot enforce any secure Bo so just make sure that the bias will not find platform key and uh",
    "start": "1906200",
    "end": "1913799"
  },
  {
    "text": "that could be done by just corrupting the name of the PK variable or the gu of the PK variable um and in that case the",
    "start": "1913799",
    "end": "1920919"
  },
  {
    "text": "the functionality responsible for Signature checks will will will you know will will not find platform key will",
    "start": "1920919",
    "end": "1926440"
  },
  {
    "text": "enter setup mode secure boot will be disabled and it will skip all the checks and uh this is a pretty generic exploit",
    "start": "1926440",
    "end": "1932760"
  },
  {
    "text": "it's independent on uh on the platform or the vendor or anything and it's one bit modification in the fles so it's",
    "start": "1932760",
    "end": "1940000"
  },
  {
    "text": "pretty simple and you can see on the left uh on the left side the the platform key for that Asis system and on",
    "start": "1940000",
    "end": "1946639"
  },
  {
    "text": "the right side is the same platform key but we just corrupted the name just with one bite oh sorry with one bit uh we uh",
    "start": "1946639",
    "end": "1954480"
  },
  {
    "text": "flipped yeah changed PK name to at Key um and Windows 8 um again",
    "start": "1954480",
    "end": "1960919"
  },
  {
    "text": "certification requirement states that hey secure boot must be rooted in a protected ROM or ROM based platform key",
    "start": "1960919",
    "end": "1968760"
  },
  {
    "text": "well obviously it's not true so the the next spils will um you know we'll we'll",
    "start": "1968760",
    "end": "1974600"
  },
  {
    "text": "show a couple of screenshots uh for the exploit we'll demonstrate live or we'll try to demonstrate live so",
    "start": "1974600",
    "end": "1981000"
  },
  {
    "text": "the first screenshot shows that hey we have fully secur Bo enabled second second screenshot",
    "start": "1981000",
    "end": "1987240"
  },
  {
    "text": "demonstrates the uh the actual exploit the exploit dumps the NV Ram searches for a platform key it finds all the inst",
    "start": "1987240",
    "end": "1994480"
  },
  {
    "text": "of of platform key and flips the bit basically corrupts the name of each of them in this spy Flash and um it's all",
    "start": "1994480",
    "end": "2001480"
  },
  {
    "text": "installs the boot kit of course and it's all down so upon reboot if you enter setup screen then you can see that the",
    "start": "2001480",
    "end": "2007840"
  },
  {
    "text": "bios couldn't find platform key it says it's not installed although it's it's there but it's not installed it couldn't",
    "start": "2007840",
    "end": "2014480"
  },
  {
    "text": "find it and of course since it couldn't find it then it doesn't enforce SEC boot checks on on our bit kit so the bit kit",
    "start": "2014480",
    "end": "2021279"
  },
  {
    "text": "is is executing and when you bid into the OS you dump the state of the SEC Boot and you can see that SEC boot is",
    "start": "2021279",
    "end": "2027399"
  },
  {
    "text": "off because setup mode is on because platform key wasn't wasn't found so",
    "start": "2027399",
    "end": "2033840"
  },
  {
    "text": "that's simple we'll go to the demo",
    "start": "2033840",
    "end": "2038080"
  },
  {
    "text": "so Andrew will switch to that laptop and uh let's hope that he will not mess with",
    "start": "2039240",
    "end": "2045200"
  },
  {
    "text": "the two click sequence of you know to run the exploit should I show the uh",
    "start": "2045200",
    "end": "2052200"
  },
  {
    "text": "Power shell no just exploit just the exploit",
    "start": "2052200",
    "end": "2059078"
  },
  {
    "text": "[Music] okay so that that that's running the",
    "start": "2059139",
    "end": "2064240"
  },
  {
    "text": "exploit basically the same actions that I described it just dump NV Ram corrupts the platform Keys um disables of course",
    "start": "2064240",
    "end": "2071919"
  },
  {
    "text": "right protection for the BIOS installs the bir kit and you can now press another button to reboot it so um now",
    "start": "2071919",
    "end": "2079320"
  },
  {
    "text": "after",
    "start": "2079320",
    "end": "2081720"
  },
  {
    "text": "reboot after reboot you can see the bit uh was executed uh without security boot",
    "start": "2092879",
    "end": "2098920"
  },
  {
    "text": "checks and",
    "start": "2098920",
    "end": "2104960"
  },
  {
    "text": "thanks and by the way uh they did all the work I I I do the talking so",
    "start": "2104960",
    "end": "2112119"
  },
  {
    "text": "um yeah so while while he's booing he'll he'll he'll",
    "start": "2112119",
    "end": "2117160"
  },
  {
    "text": "uh yeah he he he'll show barell uh but let me let me continue for",
    "start": "2117160",
    "end": "2122400"
  },
  {
    "text": "the sake of time so um so you can see that if the ufi firware is not at",
    "start": "2122400",
    "end": "2127800"
  },
  {
    "text": "quately protected either in the ROM or during the update process then",
    "start": "2127800",
    "end": "2133280"
  },
  {
    "text": "subverting ufi secure bu is uh well as as possible but it's not the only thing you should worry",
    "start": "2133280",
    "end": "2139119"
  },
  {
    "text": "about because uh the a static root of trust uh for measurement",
    "start": "2139119",
    "end": "2145640"
  },
  {
    "text": "oh okay I've been actually going through foils but haven't squished them all",
    "start": "2145640",
    "end": "2151400"
  },
  {
    "text": "right so Parell [Music]",
    "start": "2151400",
    "end": "2158469"
  },
  {
    "text": "[Music] yeah uh so you can see that we've just turned off SEC bit from from from the",
    "start": "2178910",
    "end": "2185880"
  },
  {
    "text": "offro so um anyway sorry I'm squishing so um the so by",
    "start": "2185880",
    "end": "2193560"
  },
  {
    "text": "passing secur bit when the ufi firmware is not adequate adequately protected is not the the only of the of your wear is",
    "start": "2193560",
    "end": "2200079"
  },
  {
    "text": "so the uh the static core root of trust used for TCG measured Boot and uh for",
    "start": "2200079",
    "end": "2206680"
  },
  {
    "text": "disc encryption solutions that rely on the TPM they are also bypassed right",
    "start": "2206680",
    "end": "2212000"
  },
  {
    "text": "they're also uh broken so here's a couple of papers on that on that um on",
    "start": "2212000",
    "end": "2217359"
  },
  {
    "text": "that topic that evil made that uh compromises uh full discription Solutions uh with TPM um so the other",
    "start": "2217359",
    "end": "2226839"
  },
  {
    "text": "thing is you can have a uh malware in your bias even without compromising secur or or the TPM right uh you can",
    "start": "2226839",
    "end": "2234119"
  },
  {
    "text": "have malware in your bias or as a recent one of the recent government reports uh",
    "start": "2234119",
    "end": "2239560"
  },
  {
    "text": "told extremely persistent malware that's a report where they destroyed a whole bunch of Hardware um because of the uh",
    "start": "2239560",
    "end": "2247119"
  },
  {
    "text": "you know simple maler uh so uh extremely persistent maler yeah I mean I agree",
    "start": "2247119",
    "end": "2252680"
  },
  {
    "text": "with that it's uh uh if you do whatever you want uh you you reinstall the Usos",
    "start": "2252680",
    "end": "2258200"
  },
  {
    "text": "the m still there so um so that exploit that we showed it requires kernel kernal",
    "start": "2258200",
    "end": "2263640"
  },
  {
    "text": "mode exploit um and um obviously it's it's important um you you get",
    "start": "2263640",
    "end": "2268920"
  },
  {
    "text": "persistence you got compromised uh you you compromised everything below the OS including any security Solution on below",
    "start": "2268920",
    "end": "2275920"
  },
  {
    "text": "the OS but still it's a current it's not that interesting so um why not we just",
    "start": "2275920",
    "end": "2281000"
  },
  {
    "text": "go in uh from from user mode modify one of the keys uh for used for a secur boot",
    "start": "2281000",
    "end": "2286280"
  },
  {
    "text": "and uh if you recall that the uh the the the keys are protected they are",
    "start": "2286280",
    "end": "2291319"
  },
  {
    "text": "authenticated variables so you have to assign them you cannot just go and directly modify them through the windows",
    "start": "2291319",
    "end": "2296760"
  },
  {
    "text": "API uh the access is denied right um so um yeah um you have to sign the updates",
    "start": "2296760",
    "end": "2305160"
  },
  {
    "text": "but we still want user mode exploit uh and at the moment we are in the progress of um uh coordinating um",
    "start": "2305160",
    "end": "2312400"
  },
  {
    "text": "disclosure with affected bias and platform vendors uh of the uh uh multiple findings that we've found",
    "start": "2312400",
    "end": "2319319"
  },
  {
    "text": "during uh our research so unfortunately I won't be able to provide the details but I can offer a demo and the demo is",
    "start": "2319319",
    "end": "2326280"
  },
  {
    "text": "the same exploit by passing Seeker but but without any Curel exploit just a user mode exploit so uh I'll do the demo",
    "start": "2326280",
    "end": "2334240"
  },
  {
    "text": "on this laptop as a video",
    "start": "2334240",
    "end": "2338160"
  },
  {
    "text": "it's uh it's the vendor it's called",
    "start": "2346040",
    "end": "2349920"
  },
  {
    "text": "[Music]",
    "start": "2353710",
    "end": "2356800"
  },
  {
    "text": "szer all right so we're boing Windows",
    "start": "2365480",
    "end": "2370000"
  },
  {
    "text": "8 again just showing that SEC boot is actually enabled on this",
    "start": "2383760",
    "end": "2389319"
  },
  {
    "text": "system so um all the signature Shacks have to be enforced and you cannot just install B kit",
    "start": "2389319",
    "end": "2397519"
  },
  {
    "text": "okay so it's",
    "start": "2403160",
    "end": "2405920"
  },
  {
    "text": "enabled now launching the exploit it's a purely used remote exploit uh there's",
    "start": "2410359",
    "end": "2415920"
  },
  {
    "text": "even an option no driver um so we loaded the module installed the uh compromise secure Boot",
    "start": "2415920",
    "end": "2422560"
  },
  {
    "text": "and installed the boot kit there are no details in the exploit but um um we'll",
    "start": "2422560",
    "end": "2427960"
  },
  {
    "text": "see the",
    "start": "2427960",
    "end": "2430280"
  },
  {
    "text": "result um again we've booted bootkit with uh despite secure",
    "start": "2437520",
    "end": "2442839"
  },
  {
    "text": "boot um on this sensor Vector uh vendor",
    "start": "2442839",
    "end": "2449200"
  },
  {
    "text": "the password is secret",
    "start": "2466800",
    "end": "2472520"
  },
  {
    "text": "literally so um uh now we'll show the state of the",
    "start": "2472520",
    "end": "2478319"
  },
  {
    "text": "secure Boot and there will you you will see a difference between this exploit and the previous exploit",
    "start": "2478319",
    "end": "2486599"
  },
  {
    "text": "so you can see that secure boot is now on it's actually enabled as opposed to",
    "start": "2499760",
    "end": "2505160"
  },
  {
    "text": "uh the prior exploit which showed that it was disabled so we uh we haven't",
    "start": "2505160",
    "end": "2511319"
  },
  {
    "text": "turned it off we haven't done anything we've just uh we've just compromised it this and and the state is show is",
    "start": "2511319",
    "end": "2516960"
  },
  {
    "text": "showing showing that it's all on and everything is fine so none of the antivirus mare would be able to figure",
    "start": "2516960",
    "end": "2522880"
  },
  {
    "text": "this out I guess",
    "start": "2522880",
    "end": "2526559"
  },
  {
    "text": "um okay so uh now that we've um seen that TI boot is uh possible to",
    "start": "2532720",
    "end": "2540079"
  },
  {
    "text": "compromise uh now what now what are the recommendations that we can give to the",
    "start": "2540079",
    "end": "2545319"
  },
  {
    "text": "vendors and to the to Mir moral uh well first the recommendations to the",
    "start": "2545319",
    "end": "2551240"
  },
  {
    "text": "platform vendors it's 2013 so in in in that year only signed bias updates are",
    "start": "2551240",
    "end": "2557640"
  },
  {
    "text": "allowed and acceptable um and that could be ufi capsule based updates or runtime updates",
    "start": "2557640",
    "end": "2563640"
  },
  {
    "text": "from the uh uh from the smm either of those methods uh the ufi firmware has to",
    "start": "2563640",
    "end": "2568920"
  },
  {
    "text": "be protected in Rome from direct modification uh one of the using one of the existing uh um Hardware mechanisms",
    "start": "2568920",
    "end": "2576440"
  },
  {
    "text": "that the chips software the uh and that includes not just the uh firmware but also the EFI variable NV Ram store in",
    "start": "2576440",
    "end": "2584040"
  },
  {
    "text": "the ROM uh also measuring secure bit configuration into PCR 7 May prevent or",
    "start": "2584040",
    "end": "2590359"
  },
  {
    "text": "complicate some of the exploit for example it can facilitate the detection of the exploit via remote attestation or",
    "start": "2590359",
    "end": "2595880"
  },
  {
    "text": "the windows bit Locker can seal the encryption keys to the BCR 7 and so if you have an exploit modifying",
    "start": "2595880",
    "end": "2602640"
  },
  {
    "text": "configuration then the uh bit Locker wouldn't unseal the encryption key",
    "start": "2602640",
    "end": "2608079"
  },
  {
    "text": "and that actually is recommended by the Microsoft in their Hardware certification requirements um for",
    "start": "2608079",
    "end": "2615520"
  },
  {
    "text": "General end users make sure that when you buy the system buy it with the Windows 8 logo because there is a better",
    "start": "2615520",
    "end": "2620720"
  },
  {
    "text": "chance that the system adheres to the hardware certification requirements including security requirements for for",
    "start": "2620720",
    "end": "2626359"
  },
  {
    "text": "the secure boot uh check that you can check that the update for Reign disclaimer you can break their system by",
    "start": "2626359",
    "end": "2632240"
  },
  {
    "text": "you know bad bad bias update of course but basically just uh when you get a",
    "start": "2632240",
    "end": "2638160"
  },
  {
    "text": "bias update corrupt it somehow and feed it to the update utility if it passes the update you're in trouble um ask the",
    "start": "2638160",
    "end": "2646440"
  },
  {
    "text": "if the platform vendor and how they adhere to the uh recent nist bio security guidelines because they those",
    "start": "2646440",
    "end": "2653240"
  },
  {
    "text": "guidelines specifically um you know tell you how to protect the biosis um and uh those are",
    "start": "2653240",
    "end": "2660240"
  },
  {
    "text": "acknowledgements I'd like to thank uh you guys for showing up here uh for our presentation I'd like to thank black hat",
    "start": "2660240",
    "end": "2666480"
  },
  {
    "text": "comittee and review board I'd like to thank certain people uh specifically Bruce Monro for coordinating disclosure",
    "start": "2666480",
    "end": "2672960"
  },
  {
    "text": "in msrc uh and uh Securo team from Microsoft uh and uh certain people who",
    "start": "2672960",
    "end": "2678599"
  },
  {
    "text": "actually helped and supported this work um don't miss these talks they're relevant or they're just cool or from",
    "start": "2678599",
    "end": "2685559"
  },
  {
    "text": "cool people thank",
    "start": "2685559",
    "end": "2689160"
  },
  {
    "text": "you um there's time for questions there's a mic uh if you're if you're I",
    "start": "2695200",
    "end": "2701440"
  },
  {
    "text": "was joking you can ask me questions question do you see benefit in having a",
    "start": "2701440",
    "end": "2708880"
  },
  {
    "text": "Hardware switch to disable UF UEFI firmware updates so that you flip the",
    "start": "2708880",
    "end": "2714400"
  },
  {
    "text": "switch only when you need to um well you're not protecting ufi",
    "start": "2714400",
    "end": "2721640"
  },
  {
    "text": "firmer from you know reflashing it connecting uh the Spy programmer to The Flash and ref ing the bias so you're not",
    "start": "2721640",
    "end": "2728079"
  },
  {
    "text": "protected from that so Hardware switch would be pretty much equivalent maybe an easy mechanisms to do that so um I guess",
    "start": "2728079",
    "end": "2734599"
  },
  {
    "text": "yeah that's acceptable in my opinion than are you by chance going to",
    "start": "2734599",
    "end": "2740200"
  },
  {
    "text": "be uh sharing these slides uh sorry uh so the the question is will",
    "start": "2740200",
    "end": "2746839"
  },
  {
    "text": "I share the foils are you uh the the slides specifically will we put them up on a website are they going to host them",
    "start": "2746839",
    "end": "2753480"
  },
  {
    "text": "anywhere uh yeah black hat should be posting them uh let me check with the blackout organizers I think I can I can",
    "start": "2753480",
    "end": "2760319"
  },
  {
    "text": "send I can send the version than and U yeah they will be shared",
    "start": "2760319",
    "end": "2767400"
  },
  {
    "text": "definitely you mentioned uh that all vendors should uh WR protect uh and view",
    "start": "2769760",
    "end": "2775559"
  },
  {
    "text": "Rams who can't do the uh Cel mode exploit the ud Dem mode um do you have any sense of the prevalence of such",
    "start": "2775559",
    "end": "2782720"
  },
  {
    "text": "protection at the the current state of platform vendors is it uh just a problem with the particular one that you demoed",
    "start": "2782720",
    "end": "2788800"
  },
  {
    "text": "was it the Asus um you know how how many times are people getting this wrong um",
    "start": "2788800",
    "end": "2795200"
  },
  {
    "text": "so the question is what is the prevalence of uh nvram not protected right prevalence of systems is that",
    "start": "2795200",
    "end": "2800319"
  },
  {
    "text": "correct okay um unfortunately I probably won't be able to give the number well in reality I don't know uh this is a very",
    "start": "2800319",
    "end": "2807400"
  },
  {
    "text": "specific example of Asus not doing that uh so um other vendors may be",
    "start": "2807400",
    "end": "2812760"
  },
  {
    "text": "susceptible to that as well but I I I I doubt that com did you have to search high and low to find that",
    "start": "2812760",
    "end": "2819559"
  },
  {
    "text": "particular um vulnerable platform maybe is one way of asking it in a safer way",
    "start": "2819559",
    "end": "2825880"
  },
  {
    "text": "did I did I search meaning did you have to did you have to buy many different um",
    "start": "2825880",
    "end": "2831079"
  },
  {
    "text": "you know I I just like ases okay I use for most of those home system systems at home R ases so I just have happen to add",
    "start": "2831079",
    "end": "2838440"
  },
  {
    "text": "them thank you",
    "start": "2838440",
    "end": "2843839"
  },
  {
    "text": "uh I haven't worked much in this area but uh I've heard about TPM uh using TPM",
    "start": "2843839",
    "end": "2850680"
  },
  {
    "text": "you can store the keys in the hardware registers itself and TPM while booting",
    "start": "2850680",
    "end": "2856400"
  },
  {
    "text": "up will can um check up the Integrity of ufi",
    "start": "2856400",
    "end": "2862599"
  },
  {
    "text": "firmware so is that covered or can can you can I repeat the question so",
    "start": "2862599",
    "end": "2867800"
  },
  {
    "text": "basically your question is whether TPM uh and the storing of the keys in the TPM would help here yes well as you as",
    "start": "2867800",
    "end": "2875440"
  },
  {
    "text": "you can see that the TPM M relies on a certain it's called static core root of",
    "start": "2875440",
    "end": "2881160"
  },
  {
    "text": "trust for measurements so certain immutable piece of firmer that launches first and it's uh it has to be protected",
    "start": "2881160",
    "end": "2888079"
  },
  {
    "text": "because if it's modified then you control whatever data is in the TPM and",
    "start": "2888079",
    "end": "2893160"
  },
  {
    "text": "uh um in that case if the uh ufi firmware is not protected including that",
    "start": "2893160",
    "end": "2898880"
  },
  {
    "text": "uh initial piece it's in ufi world it's called startup module in Legacy world that was called boot block if it's not",
    "start": "2898880",
    "end": "2905720"
  },
  {
    "text": "protected you can modify then T using TPM wouldn't help okay so it's a kind of NeverEnding",
    "start": "2905720",
    "end": "2911559"
  },
  {
    "text": "process because gaining the root of trust is really difficult here right I'm",
    "start": "2911559",
    "end": "2918760"
  },
  {
    "text": "really sorry could you so I mean gaining the root of trust is the problem here because can never establish that Ro ABS",
    "start": "2918760",
    "end": "2926599"
  },
  {
    "text": "yeah thank",
    "start": "2926599",
    "end": "2929359"
  },
  {
    "text": "you um okay",
    "start": "2933880",
    "end": "2939920"
  },
  {
    "text": "[Applause]",
    "start": "2944440",
    "end": "2947030"
  }
]