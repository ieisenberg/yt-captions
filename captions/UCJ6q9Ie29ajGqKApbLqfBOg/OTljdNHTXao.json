[
  {
    "start": "0",
    "end": "120000"
  },
  {
    "text": "today we're going to be talking about developing trust and getting betrayed and Trust is a very important thing whether it's between people in",
    "start": "0",
    "end": "6060"
  },
  {
    "text": "relationships companies processes or giraffes and when that wind trust is",
    "start": "6060",
    "end": "13170"
  },
  {
    "text": "betrayed the result can be devastating a little bit about us before we get too",
    "start": "13170",
    "end": "18210"
  },
  {
    "text": "deep into it my name is Clint Gibbler I'm a Midwesterner living in SF which is the land of goat yoga and kombucha on",
    "start": "18210",
    "end": "25529"
  },
  {
    "text": "tap I'm a security researcher at NCC group and I was once filmed monologuing to a live EMU with me is Noah bad omen",
    "start": "25529",
    "end": "32640"
  },
  {
    "text": "thanks Clint my name is Noah bedont I'm a lover of fine root beer a security searcher who pretends to be a director",
    "start": "32640",
    "end": "38550"
  },
  {
    "text": "of infrastructure security during the day and for marine rot alright so a",
    "start": "38550",
    "end": "44940"
  },
  {
    "text": "little bit about the agenda first we're gonna give some overview and motivation for the work then we're going to talk",
    "start": "44940",
    "end": "50070"
  },
  {
    "text": "about trust as it pertains to a company and organization then we're gonna talk in more detail about development focused",
    "start": "50070",
    "end": "56100"
  },
  {
    "text": "environments which are the target of this talk we're going to discuss the architecture of get pone which is a tool we're going to demo and release today",
    "start": "56100",
    "end": "62910"
  },
  {
    "text": "then talk about some mitigations for some of these attacks and finally take questions at the end so if you wouldn't",
    "start": "62910",
    "end": "68250"
  },
  {
    "text": "mind holding questions to the end just to make sure we can get through things we're happy to answer a few immediately and then in a room nearby after so all",
    "start": "68250",
    "end": "76080"
  },
  {
    "text": "right so the background is no and I were performing a number of network penetration tests over the past few years largely of development focused",
    "start": "76080",
    "end": "82320"
  },
  {
    "text": "organizations and a key point of failure we found was this bridging of trust zone say between the development and",
    "start": "82320",
    "end": "88290"
  },
  {
    "text": "production environment oftentimes this happened because of implicit trust and a lack of guidance around developer and",
    "start": "88290",
    "end": "94200"
  },
  {
    "text": "DevOps so the goal of this talk is twofold first we want to discuss how trust relationships being between people",
    "start": "94200",
    "end": "100470"
  },
  {
    "text": "and infrastructure can be exploited and then second present a tool a get pone that puts these ideas into a practice so",
    "start": "100470",
    "end": "106320"
  },
  {
    "text": "this tool can be used by internal security teams or consultants to help attack and assess development focused",
    "start": "106320",
    "end": "111899"
  },
  {
    "text": "organizations or be used as a concrete example to show here's the impact of these types of common issues in practice",
    "start": "111899",
    "end": "119899"
  },
  {
    "text": "so I will pass it off to know what to discuss trust",
    "start": "119899",
    "end": "124759"
  },
  {
    "start": "120000",
    "end": "238000"
  },
  {
    "text": "right I think it's Clinton so throw out the talk we're gonna talk about you know",
    "start": "126110",
    "end": "131760"
  },
  {
    "text": "several key things and the first is going to be the role that trust and Trust relationships play in the attack",
    "start": "131760",
    "end": "137940"
  },
  {
    "text": "and exploitation certain scenarios that get pwned is meant to highlight so before we get into that really want to",
    "start": "137940",
    "end": "144420"
  },
  {
    "text": "talk about what trust relationships are right so trust relationships are essentially the amount of impact two or",
    "start": "144420",
    "end": "151800"
  },
  {
    "text": "more entities can have on each other because of the amount of trust and",
    "start": "151800",
    "end": "157470"
  },
  {
    "text": "allowance for communication or connection they may have this can be between people networks systems etc",
    "start": "157470",
    "end": "163320"
  },
  {
    "text": "right so truss rod relationships are established on the actual amount of controls protections privacy and",
    "start": "163320",
    "end": "170700"
  },
  {
    "text": "security in place not necessarily the intended amount of trust right so you",
    "start": "170700",
    "end": "175830"
  },
  {
    "text": "usually see this in fact that we might say these two environments aren't allowed to talk to each other but",
    "start": "175830",
    "end": "181050"
  },
  {
    "text": "actually we punched a bunch of holes at some point and they can write so when we talk about trust relationships we're talking about the actual amount of trust",
    "start": "181050",
    "end": "187500"
  },
  {
    "text": "there and not the implied amount the next is that trust relationships usually",
    "start": "187500",
    "end": "192870"
  },
  {
    "text": "exist between trust zones so trust zone could be really any areas that might have a different level of secrecy",
    "start": "192870",
    "end": "198510"
  },
  {
    "text": "security privacy associated with them so example might be difference between",
    "start": "198510",
    "end": "204420"
  },
  {
    "text": "public living space in your private bedroom between a production environment and a staging environment etc so one",
    "start": "204420",
    "end": "212040"
  },
  {
    "text": "thing to keep in mind is that when we're talking about trust relationships and trust sounds very often security and",
    "start": "212040",
    "end": "218280"
  },
  {
    "text": "these restrictions we put between our different trust zones happen to impede some level of function and instead of",
    "start": "218280",
    "end": "224700"
  },
  {
    "text": "maybe designing better processes to utilize that we tend to invalidate these",
    "start": "224700",
    "end": "230070"
  },
  {
    "text": "trust relationships and punch holes and the barriers to get the job done which can usually result in some significant",
    "start": "230070",
    "end": "235980"
  },
  {
    "text": "problems down the road so this is the list of people and things I trust and",
    "start": "235980",
    "end": "242100"
  },
  {
    "start": "238000",
    "end": "300000"
  },
  {
    "text": "the example here is that whenever we're establishing trust zones and trust relationships we want to limit the",
    "start": "242100",
    "end": "247980"
  },
  {
    "text": "amount of trust to what's really actually required for the relationship to work properly right because when",
    "start": "247980",
    "end": "253859"
  },
  {
    "text": "we're talking about trust relationships they can exist in a variety of forms and types right can be employer to employee can be",
    "start": "253859",
    "end": "259289"
  },
  {
    "text": "organization organization they can be project to collaborator network to network system to system right so some",
    "start": "259289",
    "end": "266099"
  },
  {
    "text": "examples of this might be as an employer I trust my employees to come into work use assets have access to the building",
    "start": "266099",
    "end": "272370"
  },
  {
    "text": "etc and I trust that they are going to operate in the fashion that we've agreed",
    "start": "272370",
    "end": "277590"
  },
  {
    "text": "upon another example would be network to network so I might say that the normal corporate network cannot talk to the",
    "start": "277590",
    "end": "284910"
  },
  {
    "text": "production network on any port at all or I might say that staging can talk to the",
    "start": "284910",
    "end": "290789"
  },
  {
    "text": "production network across a couple control ports from specific source ApS",
    "start": "290789",
    "end": "295800"
  },
  {
    "text": "right these are kind of the examples of these trust relationships in practice so",
    "start": "295800",
    "end": "302210"
  },
  {
    "start": "300000",
    "end": "379000"
  },
  {
    "text": "okay well this is all well good we have trust relationships and trust zones and we know that we sometimes mess them up",
    "start": "302210",
    "end": "308099"
  },
  {
    "text": "to get the job done but what does this really mean so the thing that tends to",
    "start": "308099",
    "end": "313199"
  },
  {
    "text": "get missed that Trust is transitive inherited and implicit so essentially",
    "start": "313199",
    "end": "318300"
  },
  {
    "text": "what this means is that if I trust you and you trust something else functionally in some ways I trust that",
    "start": "318300",
    "end": "325409"
  },
  {
    "text": "third-party so you see this in the form of in a person example if I trust you",
    "start": "325409",
    "end": "331590"
  },
  {
    "text": "and I believe anything you tell me and you believe anything Jenny tells you and Jenny is a liar right I functionally",
    "start": "331590",
    "end": "338310"
  },
  {
    "text": "believe anything Jenny says right we see this in actual network implementations and production environments when we see",
    "start": "338310",
    "end": "344729"
  },
  {
    "text": "things like production trust staging and staging trusts a small group of release devs who all use a bunch of in-house",
    "start": "344729",
    "end": "351300"
  },
  {
    "text": "developed tools that are dependent on a bunch of third party like open source libraries right that are developed by a",
    "start": "351300",
    "end": "356669"
  },
  {
    "text": "bunch of in-house devs so functionally prod trusts those in-house devs and open",
    "start": "356669",
    "end": "363270"
  },
  {
    "text": "source tools to be safe and secure and that creates a clear path of potential",
    "start": "363270",
    "end": "369990"
  },
  {
    "text": "compromise between let's say and irresponsible third-party devs or in-house to have a third-party library",
    "start": "369990",
    "end": "375300"
  },
  {
    "text": "and potentially the production environment so the root of what we're",
    "start": "375300",
    "end": "381300"
  },
  {
    "start": "379000",
    "end": "405000"
  },
  {
    "text": "talking about is that because of how trust relationships can be chained they allow some significant significant",
    "start": "381300",
    "end": "387599"
  },
  {
    "text": "potential for lateral movement and exploitation and escalation of and smoothly for the most part we're",
    "start": "387599",
    "end": "392770"
  },
  {
    "text": "talking about in agile development environments very much like you see and kind of startups and popular web",
    "start": "392770",
    "end": "398830"
  },
  {
    "text": "properties and those kind of things so let's take a real quick look at what these environments look like so",
    "start": "398830",
    "end": "405550"
  },
  {
    "start": "405000",
    "end": "514000"
  },
  {
    "text": "networking is hard all right so these environments look a lot like any other",
    "start": "405550",
    "end": "411729"
  },
  {
    "text": "environment when we start out so they have workstations like anyone else they have general user access they have admin",
    "start": "411729",
    "end": "417669"
  },
  {
    "text": "backbones they have a couple unique things right so they have things like local and remote development",
    "start": "417669",
    "end": "424389"
  },
  {
    "text": "environments we have CI CD pipelines we have multi-tiered environments like staging prod remote dev and we also have",
    "start": "424389",
    "end": "434620"
  },
  {
    "text": "the entire burden that will say the dev ops tool chain to maintain and manage the development infrastructure that",
    "start": "434620",
    "end": "440680"
  },
  {
    "text": "supports these developers right so when we look at this like broke down you can see that we have say our average agile",
    "start": "440680",
    "end": "448690"
  },
  {
    "text": "development startup we have user laptop it may have a local dev environment with some VMs and five mountain file systems",
    "start": "448690",
    "end": "454870"
  },
  {
    "text": "they've got a wireless router that they connect to and can get on the internet and they connect out to some third-party",
    "start": "454870",
    "end": "460570"
  },
  {
    "text": "applications in a cloud environment so we've got some get variety probably third-party SAS applications maybe some",
    "start": "460570",
    "end": "466539"
  },
  {
    "text": "G suite some HR applications etc and then something like AWS azor Google",
    "start": "466539",
    "end": "473650"
  },
  {
    "text": "compute and then behind that an infrastructure and that's probably multi-tiered right so development and",
    "start": "473650",
    "end": "479169"
  },
  {
    "text": "staging production so develop into staging being where we integrate the code and where we work on the code and then that we're gonna have a variety of",
    "start": "479169",
    "end": "485080"
  },
  {
    "text": "things right we're gonna have Jenkins and other continuous integration like Travis we're gonna have chef or puppet",
    "start": "485080",
    "end": "491159"
  },
  {
    "text": "we have a variety of different servers of surgical purposes we're gonna have some integration and deployment pipeline",
    "start": "491159",
    "end": "497020"
  },
  {
    "text": "into production this should have the minimum number of assets required you should all be heavily protected systems",
    "start": "497020",
    "end": "502360"
  },
  {
    "text": "that are serving the primary business line systems for the organization's so things like primary web servers the",
    "start": "502360",
    "end": "509259"
  },
  {
    "text": "primary application servers the production databases etc so whose boils",
    "start": "509259",
    "end": "516820"
  },
  {
    "start": "514000",
    "end": "633000"
  },
  {
    "text": "down to is attacking these environments why is this novel why is this different right traditionally attacking a standard",
    "start": "516820",
    "end": "522849"
  },
  {
    "text": "Windows environment it's compromising an individual system replaying credentials getting a hold of the compromise of the central",
    "start": "522849",
    "end": "529509"
  },
  {
    "text": "authentication mechanism and then spreading through everything right these are a little different there is some exploitation of central authentication",
    "start": "529509",
    "end": "535120"
  },
  {
    "text": "on occasion but it doesn't necessarily always yield the windfall exploitation",
    "start": "535120",
    "end": "540459"
  },
  {
    "text": "that it would in like Windows environment so what are we looking at looking at exploitation of individual developers this tends to be massive",
    "start": "540459",
    "end": "546399"
  },
  {
    "text": "right so very often it'll vary from dev - dev one dev may have nothing no that may have access to everything and deploy",
    "start": "546399",
    "end": "552970"
  },
  {
    "text": "rights right so it's very individual user role focused compromise the CICE",
    "start": "552970",
    "end": "558370"
  },
  {
    "text": "tends to be game over in many cases because very often automated users like Jenkins etc have the ability to do",
    "start": "558370",
    "end": "564459"
  },
  {
    "text": "deploys to critical systems and you can modify code as it's being processed by",
    "start": "564459",
    "end": "569649"
  },
  {
    "text": "the CI server and so you can actually inject kind of some unexpected artifacts",
    "start": "569649",
    "end": "574689"
  },
  {
    "text": "and stuff into these code also it tends to be a hotbed of secrets and access it",
    "start": "574689",
    "end": "581230"
  },
  {
    "text": "also tends to have a bunch of extra open ports and those kind of things so pivoting and lateral movement tends to",
    "start": "581230",
    "end": "586449"
  },
  {
    "text": "be more reliant on individual user function like how we're gonna move for the environment and it tends to be a lot",
    "start": "586449",
    "end": "592750"
  },
  {
    "text": "easier when you can compromise code that is used through environment rather than an individual workstation or system and",
    "start": "592750",
    "end": "599290"
  },
  {
    "text": "then local local versus remote development right so a remote development environment tends to be the",
    "start": "599290",
    "end": "604959"
  },
  {
    "text": "Wild West it's very exploitable but doesn't always have that wealth of secrets and information you want unless they're",
    "start": "604959",
    "end": "610540"
  },
  {
    "text": "shared with other environments well a local development environment well they tend to be more lockdown and usually",
    "start": "610540",
    "end": "616029"
  },
  {
    "text": "they then remote devout dev environment they have the opportunity of being significantly worse because if the",
    "start": "616029",
    "end": "622930"
  },
  {
    "text": "configures aren't correct it can expose a bunch of unnecessary ports excludable services and then sometimes some there's",
    "start": "622930",
    "end": "628240"
  },
  {
    "text": "some ways to bridge connectivity or pivot into the host operating system all",
    "start": "628240",
    "end": "633970"
  },
  {
    "start": "633000",
    "end": "779000"
  },
  {
    "text": "right so we talked about this in theory so I'm gonna talk about some kind of realistic examples right so the first is",
    "start": "633970",
    "end": "640240"
  },
  {
    "text": "we're an attacker and we compromised a developer's laptop so we get on this",
    "start": "640240",
    "end": "645939"
  },
  {
    "text": "developers laptop and through them we're able to compromise get and Jenkins we use that we backdoor some test cases and",
    "start": "645939",
    "end": "652779"
  },
  {
    "text": "we compromise the Jenkins CI server itself it can push code to a variety places and",
    "start": "652779",
    "end": "658699"
  },
  {
    "text": "it has executors slaves so executors do builds for this for the Jenkins server",
    "start": "658699",
    "end": "664850"
  },
  {
    "text": "and they tend to be other systems that could be dedicated servers over they could just be multi-use systems that",
    "start": "664850",
    "end": "670490"
  },
  {
    "text": "tend to have additional available resources because we have control Jenkins we can push our betrayer code to",
    "start": "670490",
    "end": "676490"
  },
  {
    "text": "all these executors so now we have c2 of all the executors that are paired and anything that's pair that is pulling",
    "start": "676490",
    "end": "682069"
  },
  {
    "text": "code from the CI pipeline so from there we can inject whatever we want and we do we compromise some executors we",
    "start": "682069",
    "end": "688819"
  },
  {
    "text": "eventually get on a system that allows us to write directly to the chef repo we",
    "start": "688819",
    "end": "694339"
  },
  {
    "text": "modify the chef repo and add some data bags and cookbooks and in one of those",
    "start": "694339",
    "end": "699620"
  },
  {
    "text": "cookbooks is a reverse shell recipe it turns out this is that invalidation of trust is that that production",
    "start": "699620",
    "end": "706459"
  },
  {
    "text": "environment was actually getting its chef configuration from the chef and staging so because of that we were able to push reverse shell recipes to each of",
    "start": "706459",
    "end": "715160"
  },
  {
    "text": "the production systems when they checked in and get reverse shells out of prod to us and have bridged that relationship",
    "start": "715160",
    "end": "720829"
  },
  {
    "text": "between staging that was supposed to be relatively restricted into the production environment take control of",
    "start": "720829",
    "end": "726050"
  },
  {
    "text": "the entire production environment so another example so compromise dev laptop",
    "start": "726050",
    "end": "733730"
  },
  {
    "text": "Conroy's Jenkins and get again through being able to push some test cases and those kind of things so we find that",
    "start": "733730",
    "end": "739730"
  },
  {
    "text": "what's happening is these builds are happening they're being pushed to kind of an enclave that's supposed to be like",
    "start": "739730",
    "end": "745250"
  },
  {
    "text": "a clean source area where things are gonna be checked through them they're gonna be manual code analysis and these",
    "start": "745250",
    "end": "750380"
  },
  {
    "text": "kind of things but there are a couple that don't go through as rigorous detection and they get pushed into this",
    "start": "750380",
    "end": "756800"
  },
  {
    "text": "secure Enclave that then gets reproduced into prod and some more secure staging environments so even though we couldn't",
    "start": "756800",
    "end": "762110"
  },
  {
    "text": "route traffic directly we were able to backdoor some of these code repos and tests and then when the the builds were",
    "start": "762110",
    "end": "769670"
  },
  {
    "text": "ran actually pushed our code and deployed it into the environment and we were able to then affect those",
    "start": "769670",
    "end": "774769"
  },
  {
    "text": "production systems without ever routing a packet to them and most of this was",
    "start": "774769",
    "end": "781459"
  },
  {
    "start": "779000",
    "end": "835000"
  },
  {
    "text": "through like unit tests right but for the most part mini developers won't really have a problem with if the tests pass everything looks good and there's",
    "start": "781459",
    "end": "787459"
  },
  {
    "text": "no errors hey great let's move on right so with that the point with all",
    "start": "787459",
    "end": "793639"
  },
  {
    "text": "this is that we did this a lot manually and it's pretty frustrating and you have to tailor everything to everything",
    "start": "793639",
    "end": "799370"
  },
  {
    "text": "you're doing so Clint happens to be a very skilled developer and well you can",
    "start": "799370",
    "end": "806329"
  },
  {
    "text": "write better code than I can for sure and so we put our heads together and he wrote a tool called get pwned",
    "start": "806329",
    "end": "811819"
  },
  {
    "text": "and what pass-off him to talk about it all right Thank You Noah I told him not",
    "start": "811819",
    "end": "816920"
  },
  {
    "text": "to say that but he did all right so yes so we found ourselves in the interesting",
    "start": "816920",
    "end": "822350"
  },
  {
    "text": "places a number of times on tests where we manually back toward some things and we thought it would be nice to automate",
    "start": "822350",
    "end": "827449"
  },
  {
    "text": "this a bit both to make our pen test more effective as well as sort of to share with the community and so before I",
    "start": "827449",
    "end": "833180"
  },
  {
    "text": "get into the specific architectural decisions we made let's take a step back and just very simplistically look at",
    "start": "833180",
    "end": "838790"
  },
  {
    "start": "835000",
    "end": "922000"
  },
  {
    "text": "command and control or c2 in general so in the very simplest case you have a server which is sending commands to one",
    "start": "838790",
    "end": "845540"
  },
  {
    "text": "or more machines you've compromised which then runs those commands and then sends the results back fundamentally this is the core of what command and",
    "start": "845540",
    "end": "853160"
  },
  {
    "text": "control is so maybe if you want to be a little bit tricky maybe instead of using HTTP use IRC DNS or try to office gate",
    "start": "853160",
    "end": "859670"
  },
  {
    "text": "in some other way so traditionally defenses have focused on either things",
    "start": "859670",
    "end": "864769"
  },
  {
    "text": "on say host machines or on network so on the host machines sometimes defenses",
    "start": "864769",
    "end": "870709"
  },
  {
    "text": "will look for agent like processes so is there some process that's spinning up every 60 seconds or five minutes and",
    "start": "870709",
    "end": "876589"
  },
  {
    "text": "doing a set of actions and then stopping regardless of what user activity is happening on the system or perhaps",
    "start": "876589",
    "end": "882350"
  },
  {
    "text": "they're looking for unusual behavior so is this accountant laptop suddenly trying to SSH into a bunch of machines",
    "start": "882350",
    "end": "888410"
  },
  {
    "text": "or port scan or maybe it's accessing sensitive information that normally it shouldn't need access to or on the",
    "start": "888410",
    "end": "894740"
  },
  {
    "text": "network side is a machine talking with unknown hosts or IPS that it shouldn't be or perhaps looking at traffic",
    "start": "894740",
    "end": "900829"
  },
  {
    "text": "contents itself for malicious activity so we knew when we were designing the system we want to communicate with",
    "start": "900829",
    "end": "907339"
  },
  {
    "text": "trusted network parties some network endpoints that the machines should be",
    "start": "907339",
    "end": "912649"
  },
  {
    "text": "talking with or it's not unexpected and we also want to mimic user behavior so that we don't appear like an agent that",
    "start": "912649",
    "end": "917930"
  },
  {
    "text": "just is running unconnected to user behavior okay so just explicitly talking about",
    "start": "917930",
    "end": "924330"
  },
  {
    "start": "922000",
    "end": "957000"
  },
  {
    "text": "some of our hashtag goals just typical command control we need to be able to send commands and get the",
    "start": "924330",
    "end": "930600"
  },
  {
    "text": "results we need to communicate via trusted party we want to mimic user behavior and as some sort of sub goals",
    "start": "930600",
    "end": "937470"
  },
  {
    "text": "we want to limit forensics so if someone notices something is sort of fish we want to make it hard for them to figure",
    "start": "937470",
    "end": "942510"
  },
  {
    "text": "out exactly what we've done and how we're operating and as a practical note we also want to limit the blast radius",
    "start": "942510",
    "end": "947820"
  },
  {
    "text": "right so if we're doing a pen test for a specific company we don't want to compromise someone from another company",
    "start": "947820",
    "end": "953850"
  },
  {
    "text": "because that'd be bad news all right so simplistically let's say we have an",
    "start": "953850",
    "end": "960900"
  },
  {
    "start": "957000",
    "end": "1227000"
  },
  {
    "text": "initial foothold on a machine say Jo dev how we get this initial foothold is sort",
    "start": "960900",
    "end": "966390"
  },
  {
    "text": "of out of scope for this work maybe we did spearfishing maybe we got them to run some code we backdoored however so",
    "start": "966390",
    "end": "972390"
  },
  {
    "text": "simplistically we might say okay we have a server you know let's just send commands and get results via that but",
    "start": "972390",
    "end": "979050"
  },
  {
    "text": "again it's unlikely that these machines will have a prior relationship to",
    "start": "979050",
    "end": "984660"
  },
  {
    "text": "talking with us so if we do that it's it's like hey why why are these machines talking at this external machine that we",
    "start": "984660",
    "end": "990540"
  },
  {
    "text": "don't trust so we can't do that but if we step back and think okay so developer what developers normally do oftentimes",
    "start": "990540",
    "end": "997700"
  },
  {
    "text": "developers are using open-source libraries that's hosted on github or",
    "start": "997700",
    "end": "1002810"
  },
  {
    "text": "perhaps they their company's code is hosted on github or maybe they just have personal repos that they're working on so many developer machines it would be",
    "start": "1002810",
    "end": "1009860"
  },
  {
    "text": "not surprising to see them communicating with github right so if somehow we can use github as a command control platform",
    "start": "1009860",
    "end": "1016210"
  },
  {
    "text": "this would fulfill the goal of communicating with a trusted party okay so how are we gonna do that so again we",
    "start": "1016210",
    "end": "1023240"
  },
  {
    "text": "need to be able to send commands and get results back so what are the types of things that github will allow us to host",
    "start": "1023240",
    "end": "1030199"
  },
  {
    "text": "so okay so we can make gist or we can have get repos and there's probably a handful of others but these are the main",
    "start": "1030199",
    "end": "1035209"
  },
  {
    "text": "ones so we could have our attacker server created just with commands which then is pulled down by the compromised",
    "start": "1035209",
    "end": "1041870"
  },
  {
    "text": "machines and then they create just as sort of a result of those however in",
    "start": "1041870",
    "end": "1048079"
  },
  {
    "text": "terms of sending commands to a specific machine or being able to easily collect",
    "start": "1048079",
    "end": "1053090"
  },
  {
    "text": "all of the gist with but and that might be a little bit difficult and also it's not common to be",
    "start": "1053090",
    "end": "1060070"
  },
  {
    "text": "creating many gifs and reading from them so behavior wise this might look a little bit anomalous so look let's not",
    "start": "1060070",
    "end": "1067810"
  },
  {
    "text": "do that for the main command and control mechanism let's instead use git repos so if you think about it we could commit",
    "start": "1067810",
    "end": "1074470"
  },
  {
    "text": "commands into the repo which I then get pulled down by the compromise machines then they run the commands and then",
    "start": "1074470",
    "end": "1081070"
  },
  {
    "text": "commit them back into the code and then push them to our repo so what we end up",
    "start": "1081070",
    "end": "1086740"
  },
  {
    "text": "doing is having a malicious command and control repo hosted on github and we'll talk more about this shortly okay so",
    "start": "1086740",
    "end": "1094090"
  },
  {
    "text": "that's how we can do command control but again so the fourth goal how do we",
    "start": "1094090",
    "end": "1099460"
  },
  {
    "text": "limit forensics how do we limit blast radius we can do a reasonable job at this by just making it a private repo so",
    "start": "1099460",
    "end": "1105370"
  },
  {
    "text": "now only people who we give permission to read or write this repo only they will have access to it okay so that does",
    "start": "1105370",
    "end": "1114070"
  },
  {
    "text": "that and ok so we still need to mimic user behavior so if you're not familiar there's a number of in every git repo",
    "start": "1114070",
    "end": "1123280"
  },
  {
    "text": "there's a dot git folder and it has a bunch of files in it so for example a config file which has branch information",
    "start": "1123280",
    "end": "1129610"
  },
  {
    "text": "origin information user settings things like that there's also a directory called a hooks directory and so what a",
    "start": "1129610",
    "end": "1135790"
  },
  {
    "text": "git hook is is it's basically an arbitrary piece of code that runs whenever a user is doing a state",
    "start": "1135790",
    "end": "1141430"
  },
  {
    "text": "changing get action so for example the pre-commit hook if you run a git commit",
    "start": "1141430",
    "end": "1147550"
  },
  {
    "text": "and then right before it finishes committing it'll run this arbitrary pre-commit hook which can say oh yeah",
    "start": "1147550",
    "end": "1153430"
  },
  {
    "text": "make sure to specify a descriptive message or make sure that your code fulfills various coding standards things",
    "start": "1153430",
    "end": "1160300"
  },
  {
    "text": "like that so the important part about git hooks is it has two important properties for us one is that git hooks are not in version",
    "start": "1160300",
    "end": "1167410"
  },
  {
    "text": "control so we can arbitrarily modify them and if the user says get status or",
    "start": "1167410",
    "end": "1172510"
  },
  {
    "text": "something like that unless they're specifically looking in the github folder they won't see any change right and then the second",
    "start": "1172510",
    "end": "1179140"
  },
  {
    "text": "property is because each kid hook happens as a result of user behavior basically by modifying them inputting",
    "start": "1179140",
    "end": "1185140"
  },
  {
    "text": "malicious behavior and a get hook when a developer goes about their norm development tasks using just standard",
    "start": "1185140",
    "end": "1190220"
  },
  {
    "text": "git commands we're basically taking on additional functionality that happens after it so that to a certain monitoring",
    "start": "1190220",
    "end": "1196610"
  },
  {
    "text": "system that looks like okay so they're just do we normal get workflow and then just a couple of other things are happening as well so that fulfills our",
    "start": "1196610",
    "end": "1206240"
  },
  {
    "text": "goal of mimicking user behavior so rather than running every 60 seconds or something that's very agent like we're",
    "start": "1206240",
    "end": "1211280"
  },
  {
    "text": "instead sort of tacking on to standard user behavior so just a quick summary",
    "start": "1211280",
    "end": "1216800"
  },
  {
    "text": "we're using github to host the command and control a private git repo as the",
    "start": "1216800",
    "end": "1222230"
  },
  {
    "text": "transport layer and we're using git hooks to mimic user behavior okay so",
    "start": "1222230",
    "end": "1228050"
  },
  {
    "text": "that's a lot of text we're gonna do a bunch of diagrams that walk through it so there's four primary steps so first",
    "start": "1228050",
    "end": "1234110"
  },
  {
    "text": "some initial reconnaissance then setting everything up then we're going to establish persistence on initial machine",
    "start": "1234110",
    "end": "1239660"
  },
  {
    "text": "which has an initial bootstrapping and then running the agent and then we can spread across machines and environments",
    "start": "1239660",
    "end": "1247270"
  },
  {
    "text": "okay so let's say again we have this initial foothold on Jo dev and we're wanting to",
    "start": "1247270",
    "end": "1252320"
  },
  {
    "text": "figure out you know what does this company's development environment like what languages do they use what frameworks do they use what would make",
    "start": "1252320",
    "end": "1257720"
  },
  {
    "text": "sense to be on a machine for the specific company so maybe you look at",
    "start": "1257720",
    "end": "1262730"
  },
  {
    "text": "their github if they have a company github you're like oh what is all their code written and or in this case we can",
    "start": "1262730",
    "end": "1268340"
  },
  {
    "text": "also look at one of their developers so let's say we're looking in their code repo and we see disruptor which we just",
    "start": "1268340",
    "end": "1274310"
  },
  {
    "text": "happen to know is there a primary web app because this company is based out of San Francisco and they think that a",
    "start": "1274310",
    "end": "1279830"
  },
  {
    "text": "disrupting is too slow and they want to disrupt disruption and make it even more disruptive so that's the company we're",
    "start": "1279830",
    "end": "1286100"
  },
  {
    "text": "targeting and yeah so we were we look inside it and we see a managed up high",
    "start": "1286100",
    "end": "1291830"
  },
  {
    "text": "URL stop hi and requirements we look at the requirements and we see Gengo so we think oh great",
    "start": "1291830",
    "end": "1297380"
  },
  {
    "text": "the primary web app for this company is django so they're probably a Python shop and they probably use Django so the",
    "start": "1297380",
    "end": "1302900"
  },
  {
    "text": "second step is we want to choose a popular open source repo that fits into this framework into this environment so",
    "start": "1302900",
    "end": "1310880"
  },
  {
    "text": "when python example would be I P VB which is a popular debugging library so",
    "start": "1310880",
    "end": "1316850"
  },
  {
    "text": "now we know three important things one we know the language and framework of company two we have an open source",
    "start": "1316850",
    "end": "1324170"
  },
  {
    "text": "library that makes sense in the context of their company and three if this company is based in San Francisco their",
    "start": "1324170",
    "end": "1330950"
  },
  {
    "text": "developer probably looks like this okay so let's talk about the setup process so",
    "start": "1330950",
    "end": "1337930"
  },
  {
    "start": "1335000",
    "end": "1439000"
  },
  {
    "text": "first we're gonna create personal access tokens for two different github accounts a primary and a secondary one and we're",
    "start": "1337930",
    "end": "1344750"
  },
  {
    "text": "gonna talk in a second about why two and not just one and then we're going to run this setup script so what does the setup",
    "start": "1344750",
    "end": "1350000"
  },
  {
    "text": "script - so first it's going to clone this popular repo that you specified",
    "start": "1350000",
    "end": "1355520"
  },
  {
    "text": "onto your server and then it's going to basically copy or it's gonna clone that",
    "start": "1355520",
    "end": "1360890"
  },
  {
    "text": "and push it into a private repo that we control using the primary account so the",
    "start": "1360890",
    "end": "1366140"
  },
  {
    "text": "primary attacker user is the owner of it as well as a bootstrap gist which has commands which sort of we'll set up a",
    "start": "1366140",
    "end": "1373130"
  },
  {
    "text": "compromised machine and so we need to",
    "start": "1373130",
    "end": "1379880"
  },
  {
    "text": "give an unknown number of parties both read and write access to this repo and we don't necessarily know who they're",
    "start": "1379880",
    "end": "1384890"
  },
  {
    "text": "going to be ahead of time so how do you give access to people to a private repo without necessarily knowing who ahead of",
    "start": "1384890",
    "end": "1390200"
  },
  {
    "text": "time so that's where the secondary personal access token comes in so in the bootstrap script what we do is",
    "start": "1390200",
    "end": "1396410"
  },
  {
    "text": "essentially include that in the bootstrapping file so that anyone who is",
    "start": "1396410",
    "end": "1401560"
  },
  {
    "text": "pulling down the bootstrap file using this personal access token they can",
    "start": "1401560",
    "end": "1406970"
  },
  {
    "text": "basically show it to github and say hey I have permission as this user attacks as this repo so that's how we're able to",
    "start": "1406970",
    "end": "1413860"
  },
  {
    "text": "have a compromise machines have access to the commands we're trying to give them as well as get the payload content",
    "start": "1413860",
    "end": "1421940"
  },
  {
    "text": "back and if we just use one account then if say someone's doing forensics and",
    "start": "1421940",
    "end": "1428870"
  },
  {
    "text": "then they get this primary token then they could potentially delete our repo or do anything we can do so it's sort of",
    "start": "1428870",
    "end": "1435140"
  },
  {
    "text": "a principle of least privilege thing as why we're using two accounts okay so let's quickly check in where are we so",
    "start": "1435140",
    "end": "1442250"
  },
  {
    "start": "1439000",
    "end": "1462000"
  },
  {
    "text": "we know the targets primary language and framework so they're using Django we've chosen a popular library that fits into",
    "start": "1442250",
    "end": "1447530"
  },
  {
    "text": "there such as IP dB we've mirrored that popular library in a private github repo",
    "start": "1447530",
    "end": "1452990"
  },
  {
    "text": "and we've created a private Geist which is bootstrap the process and so let's talk about establishing persistence on a",
    "start": "1452990",
    "end": "1459679"
  },
  {
    "text": "compromised machine okay so Jo dev has this internal web app such",
    "start": "1459679",
    "end": "1466970"
  },
  {
    "start": "1462000",
    "end": "1630000"
  },
  {
    "text": "a disrupter that is belongs to the company so what we're going to do is we",
    "start": "1466970",
    "end": "1473300"
  },
  {
    "text": "want to assert sort of a one-line backdoor script such that whenever or someone runs it then we back to other",
    "start": "1473300",
    "end": "1479690"
  },
  {
    "text": "merge their machine and set up command and control on it so we'll just represent that by this little red line",
    "start": "1479690",
    "end": "1486040"
  },
  {
    "text": "so we want to put this backdoor one-liner somewhere that's run often but",
    "start": "1486040",
    "end": "1491450"
  },
  {
    "text": "it's perhaps not as well vetted as other places so maybe somewhere in a test suite or in a build or a configuration",
    "start": "1491450",
    "end": "1498230"
  },
  {
    "text": "file something like that so specifically let's say in this disruptor there's like",
    "start": "1498230",
    "end": "1504380"
  },
  {
    "text": "a test folder and we put this one-liner in there which is going to set up the bootstrapping process which is",
    "start": "1504380",
    "end": "1510200"
  },
  {
    "text": "essentially just curling the gist we set up and then piping it into Python so it's just a Python script so when the",
    "start": "1510200",
    "end": "1517790"
  },
  {
    "text": "tech suite is run either by us or by Joe dev it's then going to curl this just and then run it so this is this is the",
    "start": "1517790",
    "end": "1525170"
  },
  {
    "text": "same process or the bootstrapping process so first we're going to find where are we going to clone this",
    "start": "1525170",
    "end": "1530270"
  },
  {
    "text": "command-and-control repo down so we want to put it someplace that's normal it's",
    "start": "1530270",
    "end": "1536390"
  },
  {
    "text": "not unexpected for it to be there so we look at the default user Python library",
    "start": "1536390",
    "end": "1541970"
  },
  {
    "text": "install folder so all of their other Python libraries are there and we just add another one and again remain common",
    "start": "1541970",
    "end": "1548240"
  },
  {
    "text": "one so it's not unexpected for it to be there so after we find where we're gonna put it we then clone the repo down and",
    "start": "1548240",
    "end": "1557630"
  },
  {
    "text": "put it into site packages so our malicious IP DB and this repo also has an agent file so the agent file is",
    "start": "1557630",
    "end": "1564650"
  },
  {
    "text": "responsible for every time it runs it's pulling down the latest commands running them committing it to the repo and then",
    "start": "1564650",
    "end": "1571010"
  },
  {
    "text": "pushing it back so it's sort of doing the main agent processes so we take this agent file and copy it into a get hook",
    "start": "1571010",
    "end": "1577340"
  },
  {
    "text": "in this command-and-control repo so again if someone goes there and runs get status nothing will be different than",
    "start": "1577340",
    "end": "1585140"
  },
  {
    "text": "the default benign repo that we're mirroring so after that we so we've",
    "start": "1585140",
    "end": "1591380"
  },
  {
    "text": "installed the agent file but we need it to run periodically so how do we make it run as mentioned previously we create a",
    "start": "1591380",
    "end": "1596630"
  },
  {
    "text": "series of git hooks in this disruptor repo so as the developer is just",
    "start": "1596630",
    "end": "1602600"
  },
  {
    "text": "committing code running get pull or pushing things like that our agent will be running in addition to the standard",
    "start": "1602600",
    "end": "1608540"
  },
  {
    "text": "get functionality that they expect and",
    "start": "1608540",
    "end": "1613750"
  },
  {
    "text": "again after we're done we basically changed the remote from pointing to our malicious command control repo to the",
    "start": "1613750",
    "end": "1619820"
  },
  {
    "text": "benign one so now if someone were to look at this at a point in time where we're not actively doing something malicious it's going to look totally",
    "start": "1619820",
    "end": "1625790"
  },
  {
    "text": "benign and then finally we're gonna run the agent itself so let's just quickly",
    "start": "1625790",
    "end": "1630830"
  },
  {
    "start": "1630000",
    "end": "1824000"
  },
  {
    "text": "walk through that so this is one of the state of the world so the first step of the agent is going to switch to pointing",
    "start": "1630830",
    "end": "1638390"
  },
  {
    "text": "at our malicious remote which is then going to pull down any additional commands so commands are basically just",
    "start": "1638390",
    "end": "1645830"
  },
  {
    "text": "defined and currently in this payload file which is just arbitrary Python so maybe you're okay grab the the current",
    "start": "1645830",
    "end": "1651500"
  },
  {
    "text": "users username or MAC address or get all the environment variables basically anything you want the machine to run you",
    "start": "1651500",
    "end": "1656900"
  },
  {
    "text": "just put in this arbitrary Python file so the compromised machine is going to",
    "start": "1656900",
    "end": "1662450"
  },
  {
    "text": "run all these things and then commit them and then it's going to push the",
    "start": "1662450",
    "end": "1667730"
  },
  {
    "text": "results back to our server and it's going to generate a node unique ID and",
    "start": "1667730",
    "end": "1674090"
  },
  {
    "text": "it's going to push into that branch to basically so the reports from different",
    "start": "1674090",
    "end": "1679220"
  },
  {
    "text": "machines don't collide and then we set up a github hook so that whenever there's a push we automatically hear",
    "start": "1679220",
    "end": "1685880"
  },
  {
    "text": "about it on our attacker server and we know that we can run pull and extract the information that's been sent and",
    "start": "1685880",
    "end": "1692750"
  },
  {
    "text": "then finally after we've got them to run our malicious code and extracted it we then again make every reference to",
    "start": "1692750",
    "end": "1700610"
  },
  {
    "text": "our malicious commit and cultural repo disappear and point back to the benign one so again if you look on disk",
    "start": "1700610",
    "end": "1706970"
  },
  {
    "text": "everything looks great okay so just quickly spreading so",
    "start": "1706970",
    "end": "1713899"
  },
  {
    "text": "it depends on the company everyone has a different sdlc but often there is a developed branch that is not very well",
    "start": "1713899",
    "end": "1720169"
  },
  {
    "text": "vetted there's sort of a constant flux where people are developing future branches and then merging them in or",
    "start": "1720169",
    "end": "1726049"
  },
  {
    "text": "taking develop emerging into their future branch so that it's not a huge",
    "start": "1726049",
    "end": "1731240"
  },
  {
    "text": "merge conflict when they try to merge it into say a QA version or something like that so the first step is to find a",
    "start": "1731240",
    "end": "1738740"
  },
  {
    "text": "branch that's less well vetted and to push into internal code hosting or some",
    "start": "1738740",
    "end": "1744559"
  },
  {
    "text": "sort of continuous integration tool like Jenkins so now our malicious one-liner",
    "start": "1744559",
    "end": "1750139"
  },
  {
    "text": "backdoor is now there so let's say there's another developer Atlas dev no relation to Joe he may have access to",
    "start": "1750139",
    "end": "1757190"
  },
  {
    "text": "repos that Joe dozen or access to other internal systems so when she is developing and she runs get pull and",
    "start": "1757190",
    "end": "1762619"
  },
  {
    "text": "she's like okay I'm working on this feature let me merge and develop and then runs the test suite she gets",
    "start": "1762619",
    "end": "1767659"
  },
  {
    "text": "compromised and then we can send her commands as well and then perhaps there is a DevOps person named Bob who can SSH",
    "start": "1767659",
    "end": "1773960"
  },
  {
    "text": "to prod for troubleshooting create release builds write access to puppet chef things like that so similarly when",
    "start": "1773960",
    "end": "1780950"
  },
  {
    "text": "he pulls down that repo and runs the test suite he is also compromised so if our goal is to get into production and we compromise",
    "start": "1780950",
    "end": "1786710"
  },
  {
    "text": "someone who can get into production then we've achieved our goal so here",
    "start": "1786710",
    "end": "1791929"
  },
  {
    "text": "we're exploiting as no one was talking about before trust relationships between developers between employees but we can",
    "start": "1791929",
    "end": "1798440"
  },
  {
    "text": "also attack trust relationships between developers and say continuous integration so if the Jenkins server",
    "start": "1798440",
    "end": "1805369"
  },
  {
    "text": "automatically runs test Suites we might actually backdoor that in the process of doing this and then if Jenkins had",
    "start": "1805369",
    "end": "1812059"
  },
  {
    "text": "permission via some deployment process or get pull to send to staging or",
    "start": "1812059",
    "end": "1817460"
  },
  {
    "text": "production then we can then compromise production that way as well so there's a couple of different avenues there so there's a number of useful",
    "start": "1817460",
    "end": "1826639"
  },
  {
    "text": "features but there's a bunch that we would like to have that are not there yet and so we currently the exfiltrated",
    "start": "1826639",
    "end": "1832340"
  },
  {
    "text": "information is encrypted in transit in that it's going over get however would be nice to encrypt things client-side to",
    "start": "1832340",
    "end": "1838909"
  },
  {
    "text": "make friends it's a little bit difficult more difficult we would like to integrate with other version control systems like perforce and mercurial",
    "start": "1838909",
    "end": "1845240"
  },
  {
    "text": "currently only get a support and it would be nice to have some specific target modules for continuous",
    "start": "1845240",
    "end": "1851070"
  },
  {
    "text": "integration continuous deployment platforms like Jenkins or Travis and also just more modules for common",
    "start": "1851070",
    "end": "1856920"
  },
  {
    "text": "reconnaissance or exploitation tasks would be nice okay so in summary get",
    "start": "1856920",
    "end": "1862680"
  },
  {
    "start": "1860000",
    "end": "1909000"
  },
  {
    "text": "pone is a tool for penetration test that lets you do command control using a private repo on github it's flexible so",
    "start": "1862680",
    "end": "1870420"
  },
  {
    "text": "commands can be arbitrary Python we mimic an arbitrary public git repo that fits into the environment so it's",
    "start": "1870420",
    "end": "1876090"
  },
  {
    "text": "stealthy in that respect and it's also very easy to set up the bootstrapping process so that it's tailored to the",
    "start": "1876090",
    "end": "1882690"
  },
  {
    "text": "target environment one thing we found on real penetration tests is every environments very different how the SDLC",
    "start": "1882690",
    "end": "1889410"
  },
  {
    "text": "works is very different and having a tool that always works in a certain way to make it less useful so we tried to",
    "start": "1889410",
    "end": "1895920"
  },
  {
    "text": "make it as flexible as possible and so it can be tailored to a given project again this is targeted primarily at",
    "start": "1895920",
    "end": "1902220"
  },
  {
    "text": "agile development shops and it was written to highlight the potential risks of mismanaging trust relationships in an enterprise ok so there's many moving",
    "start": "1902220",
    "end": "1912720"
  },
  {
    "start": "1909000",
    "end": "2229000"
  },
  {
    "text": "parts so we ended up recording the demo so first let's look at the setup process",
    "start": "1912720",
    "end": "1923120"
  },
  {
    "text": "ok so we're in the get pwned repo and there's a config file which basically",
    "start": "1923120",
    "end": "1928200"
  },
  {
    "text": "says here's the repo I want to copy here's a couple of personal access tokens and and then here's the attacker",
    "start": "1928200",
    "end": "1934320"
  },
  {
    "text": "server that I want to get hook to point to and so basically once you have that information all you do is run the setup",
    "start": "1934320",
    "end": "1941370"
  },
  {
    "text": "file and you pass in the config information and then it does a bunch of things so first its cloning down the",
    "start": "1941370",
    "end": "1946800"
  },
  {
    "text": "popular repo and then pushing it into a private repo and then it's setting up a web hook it's adding the secondary user",
    "start": "1946800",
    "end": "1953580"
  },
  {
    "text": "as a collaborator to the first one don't try to read all of this there's too much",
    "start": "1953580",
    "end": "1959390"
  },
  {
    "text": "but I'll show you in a second all the things that it did but one important takeaway from at the end of it is",
    "start": "1959390",
    "end": "1966020"
  },
  {
    "text": "basically it will output this basically one-liners which then you can use to",
    "start": "1966020",
    "end": "1971940"
  },
  {
    "text": "backdoor a target repo so if we look at what exactly this gist content is it's",
    "start": "1971940",
    "end": "1978780"
  },
  {
    "text": "basically a Python script that does the bootstrapping that we explained in the architecture diagram just a minute ago",
    "start": "1978780",
    "end": "1985320"
  },
  {
    "text": "so let's see so this is on the right that was the official IP DB and this is",
    "start": "1985320",
    "end": "1992490"
  },
  {
    "text": "our private one that we just generated from the setup script as you can see so there's like a similar number of commits",
    "start": "1992490",
    "end": "1998310"
  },
  {
    "text": "a lot of the history looks the same there's a bunch of collaborators and it looks pretty much identical we can see",
    "start": "1998310",
    "end": "2003320"
  },
  {
    "text": "that the secondary user has been added as a collaborator so they can write and there's a web hook that points to our attacker server so that every time",
    "start": "2003320",
    "end": "2010430"
  },
  {
    "text": "compromised machine pushes we see it okay cool so that's the setup so how does this",
    "start": "2010430",
    "end": "2017390"
  },
  {
    "text": "work on compromising a machine ok so again we're on Joe devs machine we have",
    "start": "2017390",
    "end": "2025280"
  },
  {
    "text": "inserted the backdoor towards the bottom there so now if we run the test suite",
    "start": "2025280",
    "end": "2031670"
  },
  {
    "text": "it's basically going to pull in the private gist which is doing all the bootstrapping and just to make things clear I had it output debug info so we",
    "start": "2031670",
    "end": "2040490"
  },
  {
    "text": "can see we added up a bunch of git hooks a pre commit pre push and things like that and so each of those hooks we added",
    "start": "2040490",
    "end": "2047210"
  },
  {
    "text": "are basically calling what looks like a simple get hook in the command-and-control repo but again it's",
    "start": "2047210",
    "end": "2053360"
  },
  {
    "text": "actually our agent code so where is this",
    "start": "2053360",
    "end": "2059030"
  },
  {
    "text": "command and control repo so if we go there and then look in the directory above it this is where all the default",
    "start": "2059030",
    "end": "2064700"
  },
  {
    "text": "Python libraries are so look there's a bunch of them and we're just one of those hiding in plain sight and then so",
    "start": "2064700",
    "end": "2072710"
  },
  {
    "text": "let's look at get log this is just what the default benign repo has if we run",
    "start": "2072710",
    "end": "2078860"
  },
  {
    "text": "git status we're just our master everything's great if we look at all the remotes we're just pointing to where we",
    "start": "2078860",
    "end": "2084230"
  },
  {
    "text": "should be we look in the github directory like oh maybe something bad",
    "start": "2084230",
    "end": "2089540"
  },
  {
    "text": "happened there but it's just a bunch of sample files and however one of those again has been rewritten to have our",
    "start": "2089540",
    "end": "2098080"
  },
  {
    "text": "agent code there so that's that oh and",
    "start": "2098080",
    "end": "2104570"
  },
  {
    "text": "then if we look on tacker server we automatically got the web hook and extracted the information so now this is",
    "start": "2104570",
    "end": "2111080"
  },
  {
    "text": "the result of running our hurry payload on Joe Deb's machine so we",
    "start": "2111080",
    "end": "2117000"
  },
  {
    "text": "ran I have config we got their username we ran the processes running and things",
    "start": "2117000",
    "end": "2123240"
  },
  {
    "text": "like that so they're currently there's just like a couple of example payloads but really anything you want to write",
    "start": "2123240",
    "end": "2128820"
  },
  {
    "text": "would be fine here okay so finally um",
    "start": "2128820",
    "end": "2135530"
  },
  {
    "text": "let's see so again so we've backdoored the team",
    "start": "2135530",
    "end": "2143130"
  },
  {
    "text": "suite maybe we're using develop or some branch that is constant in the state of flux we're going to commit this to the repo",
    "start": "2143130",
    "end": "2151680"
  },
  {
    "text": "and then push it into the internal code hosting which in this example is a separate get lab instance in the AWS dev",
    "start": "2151680",
    "end": "2158850"
  },
  {
    "text": "environment for this example company so if we go to get lab we refresh we can",
    "start": "2158850",
    "end": "2164070"
  },
  {
    "text": "see the commit that we just sent and based on this company's sdlc basically",
    "start": "2164070",
    "end": "2169650"
  },
  {
    "text": "they every time there's a push to get lab they automatically run the test suite using Jenkins so if we look at the",
    "start": "2169650",
    "end": "2176070"
  },
  {
    "text": "console output for Jenkins we can see there's the test suite running that we",
    "start": "2176070",
    "end": "2181980"
  },
  {
    "text": "back doored and then we can see this additional text which is cloning down the command control repo running the",
    "start": "2181980",
    "end": "2189180"
  },
  {
    "text": "agent and things like that so again if we look at nodes now we can see that we did run arbitrary code on Jenkins the",
    "start": "2189180",
    "end": "2195270"
  },
  {
    "text": "continuous integration server and here's a bunch of the environment information and things like that so if in this",
    "start": "2195270",
    "end": "2200820"
  },
  {
    "text": "company Jenkins has permission to push to prod we can then send it arbitrary commands which then push to production",
    "start": "2200820",
    "end": "2208080"
  },
  {
    "text": "as well so again this is a sort of a",
    "start": "2208080",
    "end": "2214590"
  },
  {
    "text": "very quick minimal example because of time constraints but in both on both Jo developer as well as git lab we were",
    "start": "2214590",
    "end": "2221430"
  },
  {
    "text": "running arbitrary codes so your imagination is the limit here all right",
    "start": "2221430",
    "end": "2227280"
  },
  {
    "text": "so let's go back and to talk about mitigation for some of these attacks and",
    "start": "2227280",
    "end": "2232950"
  },
  {
    "start": "2229000",
    "end": "2567000"
  },
  {
    "text": "gonna pass it back to Noah Thanks good all right so we just talked about some",
    "start": "2232950",
    "end": "2239670"
  },
  {
    "text": "potential issues and problems and showed a tool that takes advantage of some of these potential issues and highlights",
    "start": "2239670",
    "end": "2245550"
  },
  {
    "text": "risks so let's talk about ways we can potentially fix it so anytime we're looking at potentially mitigating a problem we need to understand what the",
    "start": "2245550",
    "end": "2252180"
  },
  {
    "text": "root causes are here first right so when the mainland's is that development security just not has not kept up with",
    "start": "2252180",
    "end": "2258990"
  },
  {
    "text": "the speed at which these very skilled very rapid moving development shops have",
    "start": "2258990",
    "end": "2265410"
  },
  {
    "text": "grown we have startups that go from the first line of code they're writing to like GA releases in under a year",
    "start": "2265410",
    "end": "2272610"
  },
  {
    "text": "sometimes and that's just a massive amount of change right and at the moment development security processes",
    "start": "2272610",
    "end": "2278970"
  },
  {
    "text": "procedures and even some technical trolls just have not been given the focus to keep up with this right so something hasn't gotten any attention",
    "start": "2278970",
    "end": "2285530"
  },
  {
    "text": "security and development tend to be separate silos so that means there's an absence of collaboration very often",
    "start": "2285530",
    "end": "2291300"
  },
  {
    "text": "there's absence of a visibility into what's actually going on and very often leads to some misconceptions about what actually what levels of security",
    "start": "2291300",
    "end": "2298530"
  },
  {
    "text": "protections are actually in place okay and the last is incomplete technical controls I know this is a big one I mean",
    "start": "2298530",
    "end": "2304920"
  },
  {
    "text": "a lot of the security problems we deal with the security research on database databases are because of incomplete technical controls right but nonetheless",
    "start": "2304920",
    "end": "2313380"
  },
  {
    "text": "it persists so examples would be maybe we punched a couple extra holes in a",
    "start": "2313380",
    "end": "2318600"
  },
  {
    "text": "firewall or we scoped some secrets to a much lower level user than was necessary",
    "start": "2318600",
    "end": "2325680"
  },
  {
    "text": "to make things easier things like that so there's a couple different ways",
    "start": "2325680",
    "end": "2331020"
  },
  {
    "text": "there's processes and procedures and then there's technical controls let's talk about processes and procedures first so first is that as far as the",
    "start": "2331020",
    "end": "2341550"
  },
  {
    "text": "process goes doing code review doing you know code collaboration and reviewing commits is necessary like obviously",
    "start": "2341550",
    "end": "2348330"
  },
  {
    "text": "there's obviously there's a limit because of scale of having automated",
    "start": "2348330",
    "end": "2354570"
  },
  {
    "text": "processes in place to help with some of this we'll even though it won't solve these problems that can help all right",
    "start": "2354570",
    "end": "2360000"
  },
  {
    "text": "now there is defining a real development process and I don't just mean telling your devs how to do the development I",
    "start": "2360000",
    "end": "2365190"
  },
  {
    "text": "mean working with them find out what their constraints are the requirements the technologies and all the things that they work with on a day to day basis",
    "start": "2365190",
    "end": "2372060"
  },
  {
    "text": "because this is where they live essentially and helping them create secure reasonable constraints saying",
    "start": "2372060",
    "end": "2378599"
  },
  {
    "text": "ways of developing that meet their needs and don't impede their ability to do their work right and even though that",
    "start": "2378599",
    "end": "2385170"
  },
  {
    "text": "sounds like a magical unicorn it's totally possible so reviewing",
    "start": "2385170",
    "end": "2392160"
  },
  {
    "text": "development of staging security controls and their environments on a regular basis is also important because these are areas that are in really large",
    "start": "2392160",
    "end": "2399599"
  },
  {
    "text": "states of flux right as we add new controls as we patches we update as we change and we do change management",
    "start": "2399599",
    "end": "2404819"
  },
  {
    "text": "already so keeping a good eye on this from the get-go gives us a lot of insight into what we need to be planning",
    "start": "2404819",
    "end": "2410130"
  },
  {
    "text": "for them and the types of risks of things we need to be mitigating what we might be exposed to okay so we talked",
    "start": "2410130",
    "end": "2416009"
  },
  {
    "text": "about processes and procedures let's talk about real technical controls so first like sdlc right having your STL see clearly defined set",
    "start": "2416009",
    "end": "2423089"
  },
  {
    "text": "up and designed in a way that is strong and doesn't expose you to a bunch of",
    "start": "2423089",
    "end": "2428430"
  },
  {
    "text": "undue risk is really hard to do but it's possible so sandboxing CI processes right",
    "start": "2428430",
    "end": "2433529"
  },
  {
    "text": "creating those pre-existing kind of development environments and sandboxing CI processes helps prevent things like",
    "start": "2433529",
    "end": "2440279"
  },
  {
    "text": "shelling jenkins via test suites right I can count the number of environments",
    "start": "2440279",
    "end": "2445349"
  },
  {
    "text": "I've seen that actually sandbox all their CI builds probably on one hand in my last two years of pen testing right",
    "start": "2445349",
    "end": "2452210"
  },
  {
    "text": "so examine not just your gate hooks but all of the code is infrastructure things",
    "start": "2452210",
    "end": "2458249"
  },
  {
    "text": "that require and control and set up your development situations and then also",
    "start": "2458249",
    "end": "2463680"
  },
  {
    "text": "doing some type of configuration enforcement on that I'll make a big reinforcement were like puppet chef these kind of things really goes a long",
    "start": "2463680",
    "end": "2470160"
  },
  {
    "text": "way host based monitoring along any alerting and looking specifically for malicious development and exploitation",
    "start": "2470160",
    "end": "2476819"
  },
  {
    "text": "of developers goes a long way specifically in an environment like an agile dev shop where developers are",
    "start": "2476819",
    "end": "2482279"
  },
  {
    "text": "really your highest potential point of failure and they're the group that is technically making the most money right",
    "start": "2482279",
    "end": "2488039"
  },
  {
    "text": "because they're generating the product that your business staked on so not only should they get the most attention from the point of view of protecting",
    "start": "2488039",
    "end": "2493979"
  },
  {
    "text": "protecting that asset they should get the most attention because they're going to need help to be able to do their job securely and in a way that helps the",
    "start": "2493979",
    "end": "2501479"
  },
  {
    "text": "entire company be successful right and then network segmentation this is old-school tried-and-true right",
    "start": "2501479",
    "end": "2507289"
  },
  {
    "text": "reviewing and enforcing Network segmentation not just on a point of view of port and IP but also on system and",
    "start": "2507289",
    "end": "2515820"
  },
  {
    "text": "code tenancy so where do my systems live where are my bridge points which systems",
    "start": "2515820",
    "end": "2520980"
  },
  {
    "text": "are multihomed what code transit trust stones and am I using something like",
    "start": "2520980",
    "end": "2527000"
  },
  {
    "text": "clear clean source so clean source is a concept that any code going into an",
    "start": "2527000",
    "end": "2532050"
  },
  {
    "text": "environment is as secure and safe as the environment it's going into right really",
    "start": "2532050",
    "end": "2537330"
  },
  {
    "text": "really hard to do but these are kind of the things we need to think about when we're talking about these type of exploitation scenarios all right so at",
    "start": "2537330",
    "end": "2546090"
  },
  {
    "text": "this point we're opened up for questions I think we have a couple minutes for that while we're doing questions we leave our contact info up and if you",
    "start": "2546090",
    "end": "2552320"
  },
  {
    "text": "don't get time to ask us question and we'll go to the rap room afterwards and we'll have a little more time if you",
    "start": "2552320",
    "end": "2557760"
  },
  {
    "text": "need to thank you thank you for your time [Applause]",
    "start": "2557760",
    "end": "2569610"
  },
  {
    "start": "2567000",
    "end": "2884000"
  },
  {
    "text": "yes okay so the question was the example",
    "start": "2569610",
    "end": "2578680"
  },
  {
    "text": "was Django and what language and platforms does it support so currently the backdooring and agent code is",
    "start": "2578680",
    "end": "2587130"
  },
  {
    "text": "written in Python but that just means the machine that it's running on needs",
    "start": "2587130",
    "end": "2594460"
  },
  {
    "text": "to also have Python because just to like get the bootstrap process running but",
    "start": "2594460",
    "end": "2599620"
  },
  {
    "text": "you can also say it's a Ruby on Rails project or really any language you could just do a shell exec pipe in the",
    "start": "2599620",
    "end": "2606760"
  },
  {
    "text": "bootstrapping just into bash or something like that basically as long as pythons installed on the system you can",
    "start": "2606760",
    "end": "2613210"
  },
  {
    "text": "shell out to it in any language in framework so I would say it's agnostic in that respect Thank You Mac agnostic",
    "start": "2613210",
    "end": "2621900"
  },
  {
    "text": "yeah any other questions",
    "start": "2621900",
    "end": "2625859"
  },
  {
    "text": "huh yes",
    "start": "2631680",
    "end": "2636329"
  },
  {
    "text": "your voice is actually getting minutes but executing the commands how does that feedback",
    "start": "2645040",
    "end": "2651330"
  },
  {
    "text": "yeah so that's a great question the question the question was we've taken a lot of steps to try to avoid",
    "start": "2651970",
    "end": "2657710"
  },
  {
    "text": "detection in terms of light being recognized on disk how do we prevent being recognized the actions themselves so if say you",
    "start": "2657710",
    "end": "2666530"
  },
  {
    "text": "have some sort of host monitoring system that's looking for attempts to dump the keychain or do something that might be",
    "start": "2666530",
    "end": "2671870"
  },
  {
    "text": "bad just because we're running the commands in a stealthy way doesn't mean",
    "start": "2671870",
    "end": "2677240"
  },
  {
    "text": "that someone looking for that isn't going to see it so if a command that you would run would get detected normally",
    "start": "2677240",
    "end": "2683030"
  },
  {
    "text": "this doesn't make that part better that's sort of the fundamental",
    "start": "2683030",
    "end": "2688520"
  },
  {
    "text": "limitation of what they're looking for on the host yeah so to caveat that so",
    "start": "2688520",
    "end": "2695120"
  },
  {
    "text": "ultimately any like advanced monitoring logging learning is gonna catch plenty X commands we were talking about potentially adding some encryption to",
    "start": "2695120",
    "end": "2702850"
  },
  {
    "text": "kind of additionally protect things being passed but ultimately it's gonna be in clear text at some point this is a",
    "start": "2702850",
    "end": "2709460"
  },
  {
    "text": "cool tool for showing these expectations and doing the expectations and automate some stuff but what doesn't ultimately",
    "start": "2709460",
    "end": "2714620"
  },
  {
    "text": "do is replace the skill of an attacker right and ultimately when you're attacking a dev and something that I've",
    "start": "2714620",
    "end": "2720860"
  },
  {
    "text": "had to learn through a lot of stuff is that when you're attacking a developer you have a lot of leeway to be within",
    "start": "2720860",
    "end": "2727760"
  },
  {
    "text": "the context of user behavior and still do a lot of really powerful things very often you don't need to dump the",
    "start": "2727760",
    "end": "2734180"
  },
  {
    "text": "keychain right you can do very simple behaviors built on how their current",
    "start": "2734180",
    "end": "2739340"
  },
  {
    "text": "workflows are for instance very few devs actually password protect or passphrase protect their SSH keys that are used for",
    "start": "2739340",
    "end": "2746930"
  },
  {
    "text": "say committing to code repos and those kind of things and a commit looks relatively mundane right so we can do a",
    "start": "2746930",
    "end": "2753590"
  },
  {
    "text": "lot of things spread through environments and get to those critical points without necessarily doing things like dumping key chains or things that are going to get us caught so but",
    "start": "2753590",
    "end": "2759920"
  },
  {
    "text": "understanding the type of environment and the person you're looking at who you're compromising really important so",
    "start": "2759920",
    "end": "2766220"
  },
  {
    "text": "one of your first things you should do once you get on is take some time and log outputs and then review the",
    "start": "2766220",
    "end": "2773180"
  },
  {
    "text": "behaviors that are taking place looking at their bash histories and these kind of things looking at their get histories you can take that and then create your",
    "start": "2773180",
    "end": "2779420"
  },
  {
    "text": "exploitation method and what chain you actually need to follow and by creating kind of a tolerance of",
    "start": "2779420",
    "end": "2786119"
  },
  {
    "text": "how likely is they're gonna catch on these different things you can decide what's worth it to try to actually do right so I look long way just saying",
    "start": "2786119",
    "end": "2793619"
  },
  {
    "text": "that the tool does not replace the skillset but the skills that can really enable this tool to do really cool things answer your question Annie any",
    "start": "2793619",
    "end": "2804630"
  },
  {
    "text": "more questions yes sir",
    "start": "2804630",
    "end": "2808309"
  },
  {
    "text": "sure so the question was if a company uses a private get repo and by that do",
    "start": "2814410",
    "end": "2820170"
  },
  {
    "text": "you mean like they host their own get server alright so the case of they're hosting their own git server inevitably",
    "start": "2820170",
    "end": "2827010"
  },
  {
    "text": "you have to know that it exists somehow whether that can be via social engineering or reconnaissance or",
    "start": "2827010",
    "end": "2832320"
  },
  {
    "text": "anything like that once you find out and get an initial foothold on a system as long as they can talk about the public it you can get that initial command and",
    "start": "2832320",
    "end": "2838980"
  },
  {
    "text": "control find out the location and targets that they're using and then modify the configs and in order to then",
    "start": "2838980",
    "end": "2844170"
  },
  {
    "text": "use that git repo or that private get server as any component of the",
    "start": "2844170",
    "end": "2849300"
  },
  {
    "text": "exploitation chain that we're talking about including if you get a significant privileges you can actually turn that into your C to look into your actual CG",
    "start": "2849300",
    "end": "2856650"
  },
  {
    "text": "server yeah so github is used as the command and control mechanism but there",
    "start": "2856650",
    "end": "2861870"
  },
  {
    "text": "get internal git repos can be hosted anywhere so it could be private github in our play enterprise private get lab",
    "start": "2861870",
    "end": "2868230"
  },
  {
    "text": "and get a light it doesn't matter it's just one of the mechanism of propagating the initial backdoor which as long as",
    "start": "2868230",
    "end": "2874200"
  },
  {
    "text": "they use get it works the same yeah great question I think that with that we're out of time but if you guys have",
    "start": "2874200",
    "end": "2879690"
  },
  {
    "text": "additional questions we'll move over to the wrap room Thanks yeah thanks again [Applause]",
    "start": "2879690",
    "end": "2886760"
  }
]