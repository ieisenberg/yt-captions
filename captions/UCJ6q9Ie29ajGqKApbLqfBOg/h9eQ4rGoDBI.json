[
  {
    "text": "so that whatever functionality it is that's being attacked by vulnerability either one isn't available because we've",
    "start": "399",
    "end": "6759"
  },
  {
    "text": "turned it off okay um two isn't",
    "start": "6759",
    "end": "11840"
  },
  {
    "text": "accessible because we've taken whatever weird way whatever weird way that an attacker is going to pass input um to",
    "start": "11840",
    "end": "18000"
  },
  {
    "text": "the to the FTP demon and actually just you know shut that off and we'll talk about you know you'll see as we go",
    "start": "18000",
    "end": "24199"
  },
  {
    "text": "through how much we're going to how much we're going to strip down the FTP demon um and then the third thing is when you",
    "start": "24199",
    "end": "31599"
  },
  {
    "text": "do get hit by it okay when you do get hit by the when you do get hit by an attack successfully um we're going to",
    "start": "31599",
    "end": "37440"
  },
  {
    "text": "try to contain the damage so I'll talk about what we can do because you know if we've if we've got a remote route if",
    "start": "37440",
    "end": "42760"
  },
  {
    "text": "you've got a remote route attack it would be really really nice if at least it turned into a remote you know user",
    "start": "42760",
    "end": "48559"
  },
  {
    "text": "FTP attack um or it turned into a you know it turned into a remote route it",
    "start": "48559",
    "end": "53640"
  },
  {
    "text": "turned into a remote user FTP attack and somebody's stuck in a little jail directory and can't do anything on your",
    "start": "53640",
    "end": "58800"
  },
  {
    "text": "system they can't pill for your email or or whatever it is that's that that people are doing right now okay",
    "start": "58800",
    "end": "66640"
  },
  {
    "text": "um so the first the first vulnerability I've actually got a a live demonstration",
    "start": "66640",
    "end": "72439"
  },
  {
    "text": "on um and that's part of why we've been doing all this AV Work is so that I can",
    "start": "72439",
    "end": "77799"
  },
  {
    "text": "so that I can see the screen so I can do the demonstration um there was a uh",
    "start": "77799",
    "end": "82840"
  },
  {
    "text": "there was a vulnerability in ftpd um it was in a large number of it was in a large number of distributions",
    "start": "82840",
    "end": "89479"
  },
  {
    "text": "it was in a it was in a real real wide range of versions um and uh we have any",
    "start": "89479",
    "end": "94759"
  },
  {
    "text": "immunic guys in the room anybody in the room running immunic or work for amunix you work for them no run them okay so",
    "start": "94759",
    "end": "102320"
  },
  {
    "text": "imix is this imix is this uh um imun is a is a great Linux solution that you",
    "start": "102320",
    "end": "108600"
  },
  {
    "text": "know it's a it's a great Linux distribution that lets you have kernel level control over this they still get",
    "start": "108600",
    "end": "113880"
  },
  {
    "text": "hit now and then but um but it's it's pretty nice um they were on the they were on the vulnerable list um we left",
    "start": "113880",
    "end": "121399"
  },
  {
    "text": "to see sometime exactly where an attacker gets uh anyway the way that the",
    "start": "121399",
    "end": "126640"
  },
  {
    "text": "way that this one worked you know we've all heard about buff overflows we've heard about format string bugs and and",
    "start": "126640",
    "end": "131760"
  },
  {
    "text": "all these different things we all had to read about and figure out you know what what the heck is this um you know some",
    "start": "131760",
    "end": "137400"
  },
  {
    "text": "programmer did what wrong um this one this one was just a really odd this is just an odd example of of uh of",
    "start": "137400",
    "end": "144400"
  },
  {
    "text": "something you know of of ftps feature creep okay if anybody how many of you",
    "start": "144400",
    "end": "150239"
  },
  {
    "text": "how many of you are running you know are running Unix FTP surveys right now responsible for",
    "start": "150239",
    "end": "156239"
  },
  {
    "text": "them Okay who wants to raise your hand if you're you're here because you're an aspiring FTP admin or something okay",
    "start": "156239",
    "end": "165720"
  },
  {
    "text": "cool um well anyway the the deal with this",
    "start": "165720",
    "end": "171040"
  },
  {
    "text": "was basically ftps ftps this this horrible horrible protocol that we all use because you know partly we're stuck",
    "start": "171040",
    "end": "177319"
  },
  {
    "text": "with it and a l large part of its inertia and and the big deal is that you know and and you know when we talk about",
    "start": "177319",
    "end": "182760"
  },
  {
    "text": "how it's a horrible horrible protocol part of it was it was uh designed by committee it's clearly like a whole lot",
    "start": "182760",
    "end": "189080"
  },
  {
    "text": "of people somehow got invited to the to the uh to the meeting where they designed this thing so they added in all",
    "start": "189080",
    "end": "194840"
  },
  {
    "text": "kinds of extra features um who's familiar with an FTP with the FTP bounce attack this is an old thing uh um the",
    "start": "194840",
    "end": "202400"
  },
  {
    "text": "guy who the guy who discovered that and publicized it is at this conference I don't know if he's in the room uh I'm",
    "start": "202400",
    "end": "208519"
  },
  {
    "text": "going to say no um anyway the FTP bounce attack basically works like this you uh",
    "start": "208519",
    "end": "214599"
  },
  {
    "text": "you're talking to an FTP server and you're saying you know hey I want this file and it's like yeah sure I'll send you the file you're like no no wait wait",
    "start": "214599",
    "end": "221319"
  },
  {
    "text": "don't send it to me send it to that other guy over there um and I don't know",
    "start": "221319",
    "end": "226519"
  },
  {
    "text": "why somebody thought we'd need this feature but you know people have been using it people people were using it for a very long time and you can still use",
    "start": "226519",
    "end": "233079"
  },
  {
    "text": "it now the FTP B there are a bunch of HP LaserJet printers that are all vulnerable to this cuz they all get",
    "start": "233079",
    "end": "238360"
  },
  {
    "text": "their own little FTP server on you know so you can you can FTP up a file and other it's printed automatically for you",
    "start": "238360",
    "end": "243879"
  },
  {
    "text": "well you can also use you can Al also use a company's um laser jet ft LaserJet",
    "start": "243879",
    "end": "249280"
  },
  {
    "text": "and a number of other printers you can also use their LaserJet printer against them to uh to make your uh to make your",
    "start": "249280",
    "end": "254840"
  },
  {
    "text": "traffic look like make your attack look like it's coming from their printers instead of from you um anyway this is",
    "start": "254840",
    "end": "261400"
  },
  {
    "text": "this is FTP it's it's just a it's just been a mess and it's been a mess because there were a whole lot of people who got",
    "start": "261400",
    "end": "267120"
  },
  {
    "text": "in and were able to get all of their little features in and and this one little feature was this one little",
    "start": "267120",
    "end": "272400"
  },
  {
    "text": "feature is something that actually a lot of us have probably used um at some point or another but the the tar feature",
    "start": "272400",
    "end": "278400"
  },
  {
    "text": "you you you say you know I want this you know I'm asking for files but I want this whole freaking directory I don't",
    "start": "278400",
    "end": "283960"
  },
  {
    "text": "just want one file I want the whole directory so what I'll do is I'll just ask for the directory what you do is you",
    "start": "283960",
    "end": "289280"
  },
  {
    "text": "say get directory you know the directory name. tar and it says oh you must mean you want me to like make one little",
    "start": "289280",
    "end": "294800"
  },
  {
    "text": "compact tar bow and and send you that one tar bow instead of sending you all the files one by one yeah can do that",
    "start": "294800",
    "end": "300840"
  },
  {
    "text": "there's a lot of other Fe there's a lot of other things it does along these lines but one of the things is that if it's going to you know when it uses tar",
    "start": "300840",
    "end": "308120"
  },
  {
    "text": "to to create that tar ball for you um tar will take whatever tar happens to",
    "start": "308120",
    "end": "313280"
  },
  {
    "text": "take you know whatever weird arguments you can squeeze in there and uh as we'll",
    "start": "313280",
    "end": "318319"
  },
  {
    "text": "see one of the arguments you can squeeze in there is a is a shell script okay um",
    "start": "318319",
    "end": "324479"
  },
  {
    "text": "so what I'm going to do is I'm going to show you this on the slides and and then I'm going to do it by hand okay the way",
    "start": "324479",
    "end": "330400"
  },
  {
    "text": "this attack works the way this attack works is first we have to create a",
    "start": "330400",
    "end": "335520"
  },
  {
    "text": "program and in my case I created a shell script but we have to create a program we have to create a Trojan a simple a",
    "start": "335520",
    "end": "342319"
  },
  {
    "text": "simple you know not a Trojan simple back door okay we have to create a program that we can run that that can get run on",
    "start": "342319",
    "end": "348160"
  },
  {
    "text": "the system and you know give us interactive route and so what that little script is that's one that's",
    "start": "348160",
    "end": "353440"
  },
  {
    "text": "that's two lines long is just uh it just runs netcat it listens on a port and uh",
    "start": "353440",
    "end": "359440"
  },
  {
    "text": "and and it runs you know runs a shell as the user that it as as the user that it is um which will be root um I'm sorry",
    "start": "359440",
    "end": "367680"
  },
  {
    "text": "which will be whatever user we're authenticated as um and uh you know and and it attaches that shell to to port in",
    "start": "367680",
    "end": "374720"
  },
  {
    "text": "my in this case 6666 okay um so what we do is we also",
    "start": "374720",
    "end": "381039"
  },
  {
    "text": "we're going to we're going to put that we're going to put that program we're going to put that script script and netcat in a little tarball called b. tar",
    "start": "381039",
    "end": "388960"
  },
  {
    "text": "just trust me it's it's necessary we've got to CH we've got to we've got to get them up there the reason for the tarball",
    "start": "388960",
    "end": "394720"
  },
  {
    "text": "is so that our script is marked executable because site cha doesn't work",
    "start": "394720",
    "end": "400000"
  },
  {
    "text": "okay well we need it to be executable so we're also creating a we're also creating we're also creating",
    "start": "400000",
    "end": "406520"
  },
  {
    "text": "a script and this is where the vulnerability comes in we're creating a script called Blah that's going to get run and what blah is going to do is it's",
    "start": "406520",
    "end": "412960"
  },
  {
    "text": "going to untar that tarball and out of that tarball is going to come netcat and our and our script our our back door",
    "start": "412960",
    "end": "420360"
  },
  {
    "text": "okay and uh and it's going to then run the back door um and I'll I'll show you how that",
    "start": "420360",
    "end": "426360"
  },
  {
    "text": "works okay um the fun little feature we're using is um T's got a T's tar got",
    "start": "426360",
    "end": "436120"
  },
  {
    "text": "a uh T's got an argument called use compressed program you can tell it to use gzip or you can tell it to use bzip",
    "start": "436120",
    "end": "441520"
  },
  {
    "text": "2 or you can tell it to use whatever in our case we're going to tell it you know for the compression to use a shell um",
    "start": "441520",
    "end": "447840"
  },
  {
    "text": "and to you know just run that quick shell script for us um and the way it works you can kind of you can see the",
    "start": "447840",
    "end": "454720"
  },
  {
    "text": "attack the way it",
    "start": "454720",
    "end": "458160"
  },
  {
    "text": "works the way it works is we put up our little tarball we put up the little script and then we we're going to create",
    "start": "461319",
    "end": "468400"
  },
  {
    "text": "we created and we're going to put up a little empty file called minus minus use compressed program equals bash blah okay",
    "start": "468400",
    "end": "476720"
  },
  {
    "text": "and then we're going to go and ask for that we're going to say get that weird weirdly constructed file it should be a",
    "start": "476720",
    "end": "482720"
  },
  {
    "text": "dash dash there do tar okay so we're asking it remember",
    "start": "482720",
    "end": "487840"
  },
  {
    "text": "whenever we whenever we pen. tar we're saying hey can you just you know tar up that directory so it's going to it's",
    "start": "487840",
    "end": "493840"
  },
  {
    "text": "going to Tar it up for us it's going to Runar which is going to run our",
    "start": "493840",
    "end": "499520"
  },
  {
    "text": "scripts okay so now what I got to do how can I go how",
    "start": "503199",
    "end": "509680"
  },
  {
    "text": "well can everyone read that text really well do you want it do you want it white on black I can switch",
    "start": "509680",
    "end": "518479"
  },
  {
    "text": "it that's biggest I get yeah be available somewhere oh yes yes",
    "start": "519919",
    "end": "528360"
  },
  {
    "text": "the the presentation the presentation is the presentation in your book is clearly had a a few slides added to it um and so",
    "start": "528360",
    "end": "536240"
  },
  {
    "text": "I'll put it up on I'll put it up on my website if you can read this TT text the website is",
    "start": "536240",
    "end": "544800"
  },
  {
    "text": "www. jjb sec.com if you go on that website in the next",
    "start": "544800",
    "end": "551480"
  },
  {
    "text": "couple days I'll put up the uh I'll put up updated slides I'll put up these updated slides",
    "start": "551480",
    "end": "558760"
  },
  {
    "text": "um actually if I have wireless access when we get out of this room I'll put them up",
    "start": "558760",
    "end": "563880"
  },
  {
    "text": "immediately okay so can I take that down or",
    "start": "563880",
    "end": "570480"
  },
  {
    "text": "it's jjb secc it's it's referenced on the",
    "start": "570480",
    "end": "575720"
  },
  {
    "text": "conferences it's it's referenced on the conference's site okay",
    "start": "575720",
    "end": "581480"
  },
  {
    "text": "um so assuming we've created our assuming",
    "start": "581480",
    "end": "587120"
  },
  {
    "text": "we've created each of the scripts that I showed you um we're just going to put them up on the I've logged in as J on",
    "start": "587120",
    "end": "594760"
  },
  {
    "text": "the target system okay um you can ask me how I got a j account on the Target system and and we can think about that",
    "start": "594760",
    "end": "603040"
  },
  {
    "text": "um but let's just say that I I ripped it off cuz I was I was at a I was at some hacker conference and someone was using",
    "start": "603040",
    "end": "609360"
  },
  {
    "text": "FTP and I sniffed their password um so uh yeah that that's how I got an account on the target",
    "start": "609360",
    "end": "616279"
  },
  {
    "text": "um so if I run if I run if I type put",
    "start": "616279",
    "end": "621800"
  },
  {
    "text": "blah I put my script I put b. tar and",
    "start": "621800",
    "end": "627640"
  },
  {
    "text": "then I'm going to put minus minus use",
    "start": "627640",
    "end": "634160"
  },
  {
    "text": "compress program equals bash",
    "start": "634160",
    "end": "640120"
  },
  {
    "text": "blah okay and now I'm going to turn around and get that",
    "start": "640120",
    "end": "646000"
  },
  {
    "text": "file okay and this is where the FTP server just kind of sits and says I'm",
    "start": "646959",
    "end": "653399"
  },
  {
    "text": "still working on that and it's going to still be working on that for some time",
    "start": "653399",
    "end": "658480"
  },
  {
    "text": "because what it's working on is is it's running our it's running our back door so until uh until the back door exits",
    "start": "658480",
    "end": "664959"
  },
  {
    "text": "it's not going to be done compressing the file we asked it to send to us there",
    "start": "664959",
    "end": "670760"
  },
  {
    "text": "any questions okay so if we uh if we connect",
    "start": "670760",
    "end": "676040"
  },
  {
    "text": "to that Port 2",
    "start": "676040",
    "end": "682839"
  },
  {
    "text": "1209 3129 okay we don't see much type ID it",
    "start": "683320",
    "end": "693120"
  },
  {
    "text": "says I've got Jay's account I can do stuff um I can look",
    "start": "693120",
    "end": "701040"
  },
  {
    "text": "[Music] around I can continue looking around the system and see what's here okay so right",
    "start": "701240",
    "end": "709079"
  },
  {
    "text": "now what I've got is uh this exploit just gives you whatever user whatever user you've whatever user's account",
    "start": "709079",
    "end": "715720"
  },
  {
    "text": "you've been able to P for um but the nice thing is from here here what we uh what we do is a is privilege escalation",
    "start": "715720",
    "end": "723680"
  },
  {
    "text": "okay we say this is this is you know whenever we're talking about you know you've got a web server somebody broke into your web server web server wasn't",
    "start": "723680",
    "end": "730120"
  },
  {
    "text": "running as roots so you're not worried right well the thing is if there's any other vulnerabilities on your system they'll often go looking for those often",
    "start": "730120",
    "end": "737880"
  },
  {
    "text": "if they know what they're breaking into if they know this is a red hat 61 box they know there's a a vulnerable program",
    "start": "737880",
    "end": "744040"
  },
  {
    "text": "called user helper um and uh and maybe they'll FTP up as we already have in",
    "start": "744040",
    "end": "749519"
  },
  {
    "text": "advance um a little program called user router which takes advantage of user helper um by the way the guy who write",
    "start": "749519",
    "end": "756560"
  },
  {
    "text": "user rouer in the room okay I'm going to give that guy props whenever I see",
    "start": "756560",
    "end": "763480"
  },
  {
    "text": "him and the",
    "start": "765440",
    "end": "768800"
  },
  {
    "text": "program runs and again very nicely with these exploits they don't come with all",
    "start": "773680",
    "end": "779519"
  },
  {
    "text": "kinds of pretty Graphics but uh yeah we're root um let's uh let's take a look at",
    "start": "779519",
    "end": "787760"
  },
  {
    "text": "the shadow file on this if anybody wants uh any passwords we can just grab some",
    "start": "787760",
    "end": "794120"
  },
  {
    "text": "and go crack them or something like that um you know it's it's fun end of game",
    "start": "794120",
    "end": "799800"
  },
  {
    "text": "this was fun um this uh this exploit ex this vulnerability existed for some time",
    "start": "799800",
    "end": "806560"
  },
  {
    "text": "what I'll do is I'll if I go back to my slides",
    "start": "806560",
    "end": "811120"
  },
  {
    "text": "okay this vulnerability was in wofp from from version 24 um to 26 24 something to 26 which I",
    "start": "813720",
    "end": "822440"
  },
  {
    "text": "don't know I don't know what what date range that was but that could have been like 5 years long okay um one of the",
    "start": "822440",
    "end": "828240"
  },
  {
    "text": "problems with all these with all these uh one of the problems from the from the defender standpoint with their being",
    "start": "828240",
    "end": "833279"
  },
  {
    "text": "vulnerabilities that we haven't heard about just yet and more to the point exploits we haven't heard about just yet",
    "start": "833279",
    "end": "839160"
  },
  {
    "text": "is that um for 5 years You're vulnerable until until word finally leaks out that",
    "start": "839160",
    "end": "844959"
  },
  {
    "text": "yeah um there's a problem in woo FP um and uh and when we finally hear about it we're like oh God I wonder if I got",
    "start": "844959",
    "end": "852240"
  },
  {
    "text": "nailed anytime in the Last 5 Years so you know like for all of us who you know my my biggest argument for for trying to",
    "start": "852240",
    "end": "859320"
  },
  {
    "text": "harden things is you know you can patch and patching is all good and all but you only get a patch once your vendor knows",
    "start": "859320",
    "end": "865079"
  },
  {
    "text": "there's a problem if your vendor doesn't know there's a problem until 5 years after it first you know after the problem first is first created well um",
    "start": "865079",
    "end": "873279"
  },
  {
    "text": "that might not be any fun for us okay patching is not patching is not going to work that's what we call a window of",
    "start": "873279",
    "end": "878560"
  },
  {
    "text": "vulnerability of of five five years um the nice thing is with some as I'm going",
    "start": "878560",
    "end": "884399"
  },
  {
    "text": "to show you with these slides basically um you can take some proactive measures and not get hit by stuff like this so",
    "start": "884399",
    "end": "890360"
  },
  {
    "text": "I'm going to show you you know I'm going to show you a step that that counterterm this but I'll show you steps that counterman just about every",
    "start": "890360",
    "end": "895920"
  },
  {
    "text": "vulnerability that's been coming out okay this is not black magic I actually it's it's kind of just you know it's",
    "start": "895920",
    "end": "901720"
  },
  {
    "text": "it's kind of just basic principles a lot of this I think just about everything I'm showing you is stuff that uh people",
    "start": "901720",
    "end": "907519"
  },
  {
    "text": "have been recommending at the at the Unix hardening courses for you know for years it's probably some of it's even",
    "start": "907519",
    "end": "913399"
  },
  {
    "text": "the stuff that you know that comes in documentation that says we didn't configure it this way but you you probably want to um so what I'll do is",
    "start": "913399",
    "end": "921680"
  },
  {
    "text": "I'll talk I'll talk to you a little bit about about what we can do to avoid this stuff okay um like I said we got a",
    "start": "921680",
    "end": "928360"
  },
  {
    "text": "remote sh with the exploit the remote show was J okay and that slide is",
    "start": "928360",
    "end": "933880"
  },
  {
    "text": "unreadable but that has the demonstration that that's the same stuff we were just doing in the Shell I",
    "start": "933880",
    "end": "940399"
  },
  {
    "text": "promise okay um now the exploit actually",
    "start": "940399",
    "end": "945600"
  },
  {
    "text": "is a whole lot harder to pull off I I did this with user J because it's a whole lot harder to pull off with an",
    "start": "945600",
    "end": "951639"
  },
  {
    "text": "anonymous login um and most of them are and the biggest reason the biggest",
    "start": "951639",
    "end": "956680"
  },
  {
    "text": "reason it's hard to pull off anonomous Logan is you're choed okay when you log into when you log into an FTP server is anonymous you're Tred",
    "start": "956680",
    "end": "963440"
  },
  {
    "text": "that means you're it means you're stuck in the directory on Linux it's it's home FTP you can't get out well mostly okay",
    "start": "963440",
    "end": "971360"
  },
  {
    "text": "you can't get out it means you know only you only have access to whatever files are there if there aren't enough files",
    "start": "971360",
    "end": "976519"
  },
  {
    "text": "there to actually do you know to actually exploit the program or to do whatever damage you want it to do once",
    "start": "976519",
    "end": "981680"
  },
  {
    "text": "you have exploited the program then it's it's you know no joy right okay so you",
    "start": "981680",
    "end": "987399"
  },
  {
    "text": "can do it it's definitely it's definitely tougher to pull off because of the chero and so actually what I'm",
    "start": "987399",
    "end": "992440"
  },
  {
    "text": "going to one of the things I'm going to bring up today is how you can Cho every user if you want to with this whole FTP thing",
    "start": "992440",
    "end": "1000199"
  },
  {
    "text": "um okay so the first thing is you know how do we how do we avoid this attack",
    "start": "1000959",
    "end": "1006079"
  },
  {
    "text": "okay you can avoid the attack if you turn off if you if you turn off the taring feature that nice little taring",
    "start": "1006079",
    "end": "1012560"
  },
  {
    "text": "feature we talked about okay you can turn it you can turn it off if you turn off the compression feature okay so um",
    "start": "1012560",
    "end": "1018959"
  },
  {
    "text": "you know we're just we're kind of turning off features now the question is do you use them um I don't know has",
    "start": "1018959",
    "end": "1024000"
  },
  {
    "text": "anybody used that has anybody used the the taring feature in a while no no it is a nice little feature",
    "start": "1024000",
    "end": "1031678"
  },
  {
    "text": "I used it I used it to to pull down big portions of technotronic at a time but",
    "start": "1031679",
    "end": "1037079"
  },
  {
    "text": "uh but no it's not really one that most people even know about that's the nice thing about a lot of the stuff you can",
    "start": "1037079",
    "end": "1042199"
  },
  {
    "text": "turn off in these FTP demons is that you know most people don't even know about all the all the features they fought so hard to get in then end up giving us all",
    "start": "1042199",
    "end": "1048720"
  },
  {
    "text": "the vulnerabilities so we can just you know we can just shut them down and we don't really have too many problems with",
    "start": "1048720",
    "end": "1053760"
  },
  {
    "text": "that okay we can also do some other stuff one of them is one of them is what you know we've got a if you've got a if",
    "start": "1053760",
    "end": "1060600"
  },
  {
    "text": "you've got Anonymous users uploading files you can make sure that said Anonymous users um can't actually pull",
    "start": "1060600",
    "end": "1067200"
  },
  {
    "text": "those files back down um this is one of those things I recommend just so your site doesn't get used to trade uh you",
    "start": "1067200",
    "end": "1073039"
  },
  {
    "text": "know by by who knows who you know the trade uh Wars and and and divix movies",
    "start": "1073039",
    "end": "1078919"
  },
  {
    "text": "and and you know and porn and and uh uh whatever else is of interest um so uh",
    "start": "1078919",
    "end": "1086000"
  },
  {
    "text": "the last the last thing we'll do is we're actually going to set where you know that that the re one of the reasons this attack worked was that I got to",
    "start": "1086000",
    "end": "1092400"
  },
  {
    "text": "upload a file called minus minus use compress program equals bash blah it's",
    "start": "1092400",
    "end": "1098840"
  },
  {
    "text": "kind of a weird file you don't see that one every day um so one of things we can also do is apply a is is put on a filter",
    "start": "1098840",
    "end": "1105760"
  },
  {
    "text": "we tell the FTP server not to not to not to bother with files that have really weird names and we'll we'll quantify",
    "start": "1105760",
    "end": "1112520"
  },
  {
    "text": "weird but you know um that really is",
    "start": "1112520",
    "end": "1119000"
  },
  {
    "text": "dim it's dim in the book as well no oh okay so this this slide is in the book",
    "start": "1119000",
    "end": "1125039"
  },
  {
    "text": "but it's very dim um can we can we hit the page 70 page what 784 784 in the",
    "start": "1125039",
    "end": "1134000"
  },
  {
    "text": "book can we uh can we dim the lights in here",
    "start": "1134000",
    "end": "1139039"
  },
  {
    "text": "I can also try to I can also try to put this in black",
    "start": "1144840",
    "end": "1151679"
  },
  {
    "text": "and white",
    "start": "1151679",
    "end": "1154919"
  },
  {
    "text": "[Music]",
    "start": "1167110",
    "end": "1170230"
  },
  {
    "text": "is that better yeah mostly",
    "start": "1194200",
    "end": "1199600"
  },
  {
    "text": "okay um if you guys really can't read it I can I can try to start Bolding",
    "start": "1199600",
    "end": "1207679"
  },
  {
    "text": "slides speak okay um",
    "start": "1208480",
    "end": "1215240"
  },
  {
    "text": "basically let's let's let's go for now and if you really can't see we'll we'll start trying to bold out we'll try we'll",
    "start": "1215240",
    "end": "1221600"
  },
  {
    "text": "start trying to bold bold the slides um I'm just showing you this is a basic FTP",
    "start": "1221600",
    "end": "1227600"
  },
  {
    "text": "access file this is B this is the file we get to configure to turn stuff off this is where all the access control is",
    "start": "1227600",
    "end": "1233280"
  },
  {
    "text": "done but really it's basically the main configuration file for for woo FTP um",
    "start": "1233280",
    "end": "1238919"
  },
  {
    "text": "it's got a bunch of it's got a bunch of stuff that we'll be modifying as we go through I just want to show you the structure so you can see what it looks",
    "start": "1238919",
    "end": "1245480"
  },
  {
    "text": "like could try and highlight it with the mouse I'm sorry I just lost my",
    "start": "1245480",
    "end": "1253120"
  },
  {
    "text": "slideshow better there",
    "start": "1253880",
    "end": "1258360"
  },
  {
    "text": "well that's a thought um",
    "start": "1260360",
    "end": "1264919"
  },
  {
    "text": "I'm going to go with what we've got I'll try to highlight it with mouse see if that gets us anywhere actually",
    "start": "1300720",
    "end": "1309240"
  },
  {
    "text": "uh no it just brought us to the next slide okay let's try to let's try to go",
    "start": "1309720",
    "end": "1315960"
  },
  {
    "text": "like this let's try to just stay let's try to go with what we've got if this is truly useless somebody you know raise",
    "start": "1315960",
    "end": "1322600"
  },
  {
    "text": "your hand and tell me and uh and we'll try to and I'll I'll play around with PowerPoint and try to make this work",
    "start": "1322600",
    "end": "1329240"
  },
  {
    "text": "okay so um the first thing is there's a section of the there's a section of the",
    "start": "1329240",
    "end": "1334600"
  },
  {
    "text": "configuration file and if these lines don't exist you can just add them that basically turns off a bunch of different",
    "start": "1334600",
    "end": "1339640"
  },
  {
    "text": "things that people can do from the FTP client one is one is ask for compression",
    "start": "1339640",
    "end": "1344720"
  },
  {
    "text": "one is ask for tarballs okay another is change the Chang the file permission",
    "start": "1344720",
    "end": "1349760"
  },
  {
    "text": "bits okay one of the biggest reasons we want to leave chamat off is that people can't upload something and then set it",
    "start": "1349760",
    "end": "1355799"
  },
  {
    "text": "executable part of the reason that last exploit had a tarbo involved in it was I didn't have any other way to upload an",
    "start": "1355799",
    "end": "1362440"
  },
  {
    "text": "executable script because if I upload a script it's not going to come up executable okay so I have to upload a",
    "start": "1362440",
    "end": "1368000"
  },
  {
    "text": "tarball and get and get F and get the FTP server to untar it and and give me that execute bit so turn off we're to",
    "start": "1368000",
    "end": "1374600"
  },
  {
    "text": "make sure chamad is off we'll make sure people can't delete files over write them or rename them okay that all of",
    "start": "1374600",
    "end": "1381240"
  },
  {
    "text": "that's important because a lot of the a lot of the a lot of the different exploits that have existed over time have used the ability to make weird",
    "start": "1381240",
    "end": "1387720"
  },
  {
    "text": "files or or to delete files or replace them with your own um depending on you know depending on permissions in a",
    "start": "1387720",
    "end": "1393440"
  },
  {
    "text": "directory we'll talk about one of the exploits where that would be really",
    "start": "1393440",
    "end": "1398278"
  },
  {
    "text": "useful okay um we'll also talk about Anonymous up load okay in this case it",
    "start": "1403679",
    "end": "1410279"
  },
  {
    "text": "worked cuz I had already I'd already stolen this guy Jay's account cuz he was he was using FTP he was using a clear",
    "start": "1410279",
    "end": "1416600"
  },
  {
    "text": "text at some at a hacker conference I mean that's that's pretty dumb okay um",
    "start": "1416600",
    "end": "1421640"
  },
  {
    "text": "if we don't happen to have a if we don't happen to have a way to to steal a user's password um we'll have to use",
    "start": "1421640",
    "end": "1427240"
  },
  {
    "text": "we'd have we'd have to use anonymous to pull this off okay how many people I there aren't there weren't too many people in the room running FTP servers",
    "start": "1427240",
    "end": "1433760"
  },
  {
    "text": "but those of you who were how many are how many are letting people upload files anonymously like just con and put",
    "start": "1433760",
    "end": "1439159"
  },
  {
    "text": "whatever you want on nobody okay there are people still doing this the biggest reasons they do",
    "start": "1439159",
    "end": "1445919"
  },
  {
    "text": "it are you've got a you've got a group of scientists who all are who are all trying to who are all trying to share uh",
    "start": "1445919",
    "end": "1450960"
  },
  {
    "text": "data or whatever and they're ftping it up to a site okay um there are a good number of uses for this I wish there",
    "start": "1450960",
    "end": "1457240"
  },
  {
    "text": "weren't um but uh what we can do in terms of what we can do is try to lessen the risk from Anonymous upload cuz if we",
    "start": "1457240",
    "end": "1464200"
  },
  {
    "text": "can turn off Anonymous upload and the nice thing is that out of the box red Hat's got it turned off by default",
    "start": "1464200",
    "end": "1469559"
  },
  {
    "text": "nowadays but if we can turn it off then we don't have to deal with a lot of the attacks that all seem to require upload",
    "start": "1469559",
    "end": "1474799"
  },
  {
    "text": "capability that last attack was really fun at least I was having fun um and you",
    "start": "1474799",
    "end": "1480159"
  },
  {
    "text": "can't pull it off if you can't upload a if you can't upload a file you can't pull it off you can't upload a weird file but you can't you can't pull it off",
    "start": "1480159",
    "end": "1486960"
  },
  {
    "text": "if you can't upload a file at all um so what we do is we set up we set up an anonymous upload area and the idea if",
    "start": "1486960",
    "end": "1494279"
  },
  {
    "text": "you're if you are doing Anonymous upload we're going to set it up so you can put files up but you can't actually pull",
    "start": "1494279",
    "end": "1500039"
  },
  {
    "text": "them back down and the reason for that is just that it stops exploits and it stops you from getting used as a",
    "start": "1500039",
    "end": "1505279"
  },
  {
    "text": "distribution site by by God knows who Okay um the idea then is that if you're",
    "start": "1505279",
    "end": "1511279"
  },
  {
    "text": "ftping stuff up and you want it to get pulled down by other people it goes in this incoming directory and at some point assisted men or somebody's going",
    "start": "1511279",
    "end": "1517600"
  },
  {
    "text": "to have to come along and say ah it looks like a decent file okay and and move it into the move it into the public",
    "start": "1517600",
    "end": "1523159"
  },
  {
    "text": "downloads area okay it's it's this is for most for most sites that are doing this kind kind of stuff this isn't so",
    "start": "1523159",
    "end": "1529399"
  },
  {
    "text": "bad and what some of them do is they just write a script to replace the admin um which will you know which goes",
    "start": "1529399",
    "end": "1535000"
  },
  {
    "text": "through and says is this file name look normal does it you know is it does it does it look like anything bad if it",
    "start": "1535000",
    "end": "1540480"
  },
  {
    "text": "doesn't we'll uh we'll move it over however you do it it's it's a decent thing to do and what I do is I just give",
    "start": "1540480",
    "end": "1547039"
  },
  {
    "text": "you some basic instructions on how to do this um now I talked about how we didn't want",
    "start": "1547039",
    "end": "1554480"
  },
  {
    "text": "people to to chamad stuff um we don't want to we don't want to we don't we don't want to let them upload executable",
    "start": "1554480",
    "end": "1560279"
  },
  {
    "text": "stuff because if they can upload executable stuff or they can make stuff they uploaded executable then they can run it well possibly and if they can run",
    "start": "1560279",
    "end": "1567679"
  },
  {
    "text": "it that's you know that's where we get to run the back door you know back doors like the one I showed you so we can set",
    "start": "1567679",
    "end": "1572919"
  },
  {
    "text": "a we can set a line called def umask which you know def umask sets a umask for all the files that get uploaded and",
    "start": "1572919",
    "end": "1579880"
  },
  {
    "text": "uh 177 just means nothing's exe executable and anything I put up there isn't readable by anybody but me to a a",
    "start": "1579880",
    "end": "1587960"
  },
  {
    "text": "pretty same policy okay uh this is another here's another vulnerability um",
    "start": "1587960",
    "end": "1594440"
  },
  {
    "text": "this is also this is also in your slides um and this vulnerability was denial of",
    "start": "1594440",
    "end": "1599679"
  },
  {
    "text": "service um what you can do again is you know you give a FTP servers are really",
    "start": "1599679",
    "end": "1605520"
  },
  {
    "text": "nice instead of just taking you know you can give them a file name that you want to get but they'll also do something called globbing for you which is you say",
    "start": "1605520",
    "end": "1611840"
  },
  {
    "text": "I don't want to type the whole name the the file is you know AB it begins with AB so AB star and it'll say say okay",
    "start": "1611840",
    "end": "1618600"
  },
  {
    "text": "yeah I'll grab that for you um there have been a bunch of problems in this functionality um you can't really you",
    "start": "1618600",
    "end": "1624559"
  },
  {
    "text": "can't really turn it off um but this is the next two vulnerabilities are basically in the globbing functionality",
    "start": "1624559",
    "end": "1631000"
  },
  {
    "text": "and and uh somebody can crash your FTP server um and potentially the whole machine which is probably no fun",
    "start": "1631000",
    "end": "1637799"
  },
  {
    "text": "especially if you get called in the middle in the middle of the night because you've got a pager that goes off and they say uh uh you got to get in",
    "start": "1637799",
    "end": "1643200"
  },
  {
    "text": "there and fix it um so um the targets on this one were wofp through 260 Pro fpd",
    "start": "1643200",
    "end": "1653320"
  },
  {
    "text": "was also vulnerable through 121 that was on R hat 62 Souza",
    "start": "1653320",
    "end": "1659159"
  },
  {
    "text": "73 um OSX uh the first version out and",
    "start": "1659159",
    "end": "1664200"
  },
  {
    "text": "and also 10.0.1 was on Solaris 8 a few of us probably have Solaris 8 in here um",
    "start": "1664200",
    "end": "1670159"
  },
  {
    "text": "it was an hpu 1111 um so uh there were a bunch of patches for this one um",
    "start": "1670159",
    "end": "1678320"
  },
  {
    "text": "there two there there are two decent things you can do the first is the reason that worked the reason the attack",
    "start": "1678320",
    "end": "1685120"
  },
  {
    "text": "works the reason the attack Works to whatever extent you guys can see is this dot dotstar dot dotstar dot dotstar okay",
    "start": "1685120",
    "end": "1694720"
  },
  {
    "text": "again that's a really really weird pattern and we'd like to not we'd like to just reject that pattern outright we'd like to like not let people screw",
    "start": "1694720",
    "end": "1701519"
  },
  {
    "text": "around with our darn FTP server um so what you can do is just we're going to",
    "start": "1701519",
    "end": "1707159"
  },
  {
    "text": "we'll do two things the the first is um we're going to put a path filter or the second is we're going to put a path filter in place that stops you from",
    "start": "1707159",
    "end": "1713919"
  },
  {
    "text": "giving the FTP server weird input like that whenever you're giving it a file name you won't be able to give it a file name that's that's too weird okay and",
    "start": "1713919",
    "end": "1720960"
  },
  {
    "text": "we'll we'll look at what that what that includes the other thing is um really this is one of those areas where we're",
    "start": "1720960",
    "end": "1726679"
  },
  {
    "text": "doing containment um if the FTP server is going to crash we'd hope if it we'd",
    "start": "1726679",
    "end": "1732000"
  },
  {
    "text": "hope that maybe it doesn't crash the whole machine um because if it crash the whole machine we might end up having to come on site and if it just crashes the",
    "start": "1732000",
    "end": "1737720"
  },
  {
    "text": "FTP server we might be able to fix that remotely or something so we'd like to uh",
    "start": "1737720",
    "end": "1743120"
  },
  {
    "text": "so what we what I do is I'm giving you I give you a couple things you can do the first is in that FTP access file you can",
    "start": "1743120",
    "end": "1749679"
  },
  {
    "text": "put a nice line okay does everyone know what nice does on Unix systems who doesn't know what nice",
    "start": "1749679",
    "end": "1756360"
  },
  {
    "text": "does who does know who's asleep okay so everyone who didn't laugh",
    "start": "1756360",
    "end": "1763519"
  },
  {
    "text": "is asleep no okay so um so yeah nice is nice nice just basically tells a program",
    "start": "1763519",
    "end": "1769399"
  },
  {
    "text": "be nice if you're if you're trying to consume tons of resources if we set a nice level high nice levels go from",
    "start": "1769399",
    "end": "1775360"
  },
  {
    "text": "like9 to positive 20 so 10's kind of high if we set the nice level nice and",
    "start": "1775360",
    "end": "1782120"
  },
  {
    "text": "high the FTP server if if it ever gets really really busy won't interfere with freaking everything else running on the",
    "start": "1782120",
    "end": "1788039"
  },
  {
    "text": "system okay it'll it'll you know it'll consume some of the system resources but not so much of it that it crashes the",
    "start": "1788039",
    "end": "1794080"
  },
  {
    "text": "thing or doesn't let other vital stuff run again it's kind of a boring line but you know it it keeps us from it keeps us",
    "start": "1794080",
    "end": "1800919"
  },
  {
    "text": "from having to run in the middle of the night um you can",
    "start": "1800919",
    "end": "1806159"
  },
  {
    "text": "also you can also um set you can also and I'll basically there a bunch of",
    "start": "1806159",
    "end": "1811880"
  },
  {
    "text": "there are a bunch of variables you can set in a in a file on Linux called Etc security limits.com and what that lets",
    "start": "1811880",
    "end": "1817919"
  },
  {
    "text": "you do is actually Define for each user and thus for each program on the system",
    "start": "1817919",
    "end": "1823000"
  },
  {
    "text": "um how much memory it's allowed to eat up um how much uh you know how big the files it can create can be um how many",
    "start": "1823000",
    "end": "1829679"
  },
  {
    "text": "processors it's allowed to use so what I've done is I've I've highlighted a few a few a few uh um items you might put",
    "start": "1829679",
    "end": "1836399"
  },
  {
    "text": "and there's a the slide before that which is unfortunately very tough to read says you can use the proc info to",
    "start": "1836399",
    "end": "1843720"
  },
  {
    "text": "command to try to come up with some sane numbers here I didn't want to give you sane numbers um because I don't know",
    "start": "1843720",
    "end": "1849360"
  },
  {
    "text": "what they are for your site um it's a really tough one to do you might just stick with the nice command for now um",
    "start": "1849360",
    "end": "1856240"
  },
  {
    "text": "the big thing as far as trying anything like this whenever you put resource limits on something on your system",
    "start": "1856240",
    "end": "1862039"
  },
  {
    "text": "problem is that if it exceeds it and you're not around then you have to you know you have to come in and react to that um so you want to try this on a",
    "start": "1862039",
    "end": "1868960"
  },
  {
    "text": "development system first um and see if it works out if you've got a development mirror of your FTP server you want to",
    "start": "1868960",
    "end": "1874880"
  },
  {
    "text": "try it there and see if it works out or at least try it during the day I had a I had a boss who put a rule on me he said",
    "start": "1874880",
    "end": "1881080"
  },
  {
    "text": "uh I wasn't allowed to do anything I wasn't allowed to change anything big right before I went to lunch right",
    "start": "1881080",
    "end": "1887279"
  },
  {
    "text": "before I left at at the end of the day or on a or or on a Friday afternoon at all um because invariably somebody would",
    "start": "1887279",
    "end": "1893600"
  },
  {
    "text": "always do something on a on a Friday afternoon or whatever one of us would have to come in at 9:00 p.m. at night and and uh and fix some fix some machine",
    "start": "1893600",
    "end": "1902120"
  },
  {
    "text": "which is definitely not the best way to spend your Friday night at least I don't",
    "start": "1902120",
    "end": "1907360"
  },
  {
    "text": "think so um there was another I was talking about the I said there were two",
    "start": "1907360",
    "end": "1912720"
  },
  {
    "text": "globbing vulnerabilities the other one is in wofp 261 which is a lot more",
    "start": "1912720",
    "end": "1918200"
  },
  {
    "text": "recent Red Hat 72 Souza 73 mandri 81 um uh who knows what else um wofp is pretty",
    "start": "1918200",
    "end": "1926240"
  },
  {
    "text": "widely used there is we know that at the very least it's a Dos attack because what this slide has",
    "start": "1926240",
    "end": "1935000"
  },
  {
    "text": "it has a single line once you connect to an FTP server as Anonymous or as yourself you can type LS space Tilda",
    "start": "1935000",
    "end": "1942000"
  },
  {
    "text": "left curly bracket the server crashes okay it's thought that actually there's a remote rout exploit here",
    "start": "1942000",
    "end": "1948440"
  },
  {
    "text": "um so uh you know it's it's not as it's not as easy as just crashing an FTP server",
    "start": "1948440",
    "end": "1954480"
  },
  {
    "text": "um and uh unfortunately this one's in the globin code you can't shut it off",
    "start": "1954480",
    "end": "1960440"
  },
  {
    "text": "okay this is one of those you know it's it's just there's not much we can do for it okay um there's no real settings you",
    "start": "1960440",
    "end": "1966720"
  },
  {
    "text": "can there's no real settings you can tweak the best thing you can do is uh is not let the attacker not to let the",
    "start": "1966720",
    "end": "1972039"
  },
  {
    "text": "attacker log in first okay so how do you do that well I guess if you're not running Anonymous mode he doesn't get to",
    "start": "1972039",
    "end": "1977080"
  },
  {
    "text": "log in but maybe that's what you're all using FTP for um on the other hand if you're using FTP only for only for",
    "start": "1977080",
    "end": "1983559"
  },
  {
    "text": "normal users uh their accounts are going to get stolen I mean uh anybody here",
    "start": "1983559",
    "end": "1989080"
  },
  {
    "text": "from a big university or from a small University okay how many of you uh how",
    "start": "1989080",
    "end": "1994840"
  },
  {
    "text": "many how many how many accounts get how many accounts get stolen from your students uh from you know via telnet or",
    "start": "1994840",
    "end": "2000360"
  },
  {
    "text": "FTP somebody setting up a sniffer somewhere at another University how many per per say year or how many per month",
    "start": "2000360",
    "end": "2009480"
  },
  {
    "text": "dozens dozens dozens per month or dozens per year dozens per month dozens per month okay um yeah FP FTP stinks it's",
    "start": "2010559",
    "end": "2019159"
  },
  {
    "text": "clear text okay if you're using names and passwords that's what happens it's really hard for universities to avoid it",
    "start": "2019159",
    "end": "2025440"
  },
  {
    "text": "because you know the best thing you can do to get off FTP is is mostly educate your users as to why it's bad and get",
    "start": "2025440",
    "end": "2030840"
  },
  {
    "text": "them on to something else but universities the you know you're losing people every every every few years it's",
    "start": "2030840",
    "end": "2037360"
  },
  {
    "text": "really hard to educate your whole user base at once um yeah so there's not there's not not",
    "start": "2037360",
    "end": "2045240"
  },
  {
    "text": "much you can do to avoid it um on the other hand you can contain this attack and this is a this is a cute trick the",
    "start": "2045240",
    "end": "2052358"
  },
  {
    "text": "way FTP the way FTP works is it runs as root and the reason it runs as root is so if you log in if you log in as",
    "start": "2052359",
    "end": "2059079"
  },
  {
    "text": "Anonymous it drops down to user FTP if you log in as J then it drops down to",
    "start": "2059079",
    "end": "2064638"
  },
  {
    "text": "user J it puts its privileges down to j instead of rot and I'll show you one of",
    "start": "2064639",
    "end": "2069800"
  },
  {
    "text": "the attacks we're going to talk about today actually uh um you know it's dropped down to FTP and and yet the",
    "start": "2069800",
    "end": "2075720"
  },
  {
    "text": "people who wrote the attack got it to go back up toot um and uh and break out of",
    "start": "2075720",
    "end": "2080800"
  },
  {
    "text": "the and break out of any tro prisons it's in which is no fun um the best way we can we can actually block both of",
    "start": "2080800",
    "end": "2087200"
  },
  {
    "text": "those um the way we do it is instead of running instead of running FTP is root",
    "start": "2087200",
    "end": "2092560"
  },
  {
    "text": "if we're just doing Anonymous FTP then all the time what happens is the FTP servers the FP server is going to start",
    "start": "2092560",
    "end": "2098880"
  },
  {
    "text": "out you're going to log in it's going to drop down to use your FTP okay and then",
    "start": "2098880",
    "end": "2104440"
  },
  {
    "text": "the next person logs in it's going to be you know when when the next person logs in they're going to log in they're going",
    "start": "2104440",
    "end": "2110320"
  },
  {
    "text": "to log into to something running his route that's going to drop down to FTP it's just going to that's what it does all day accept a connection drop down to",
    "start": "2110320",
    "end": "2116560"
  },
  {
    "text": "FTP well we can actually just start it as FTP okay and the way we do",
    "start": "2116560",
    "end": "2122480"
  },
  {
    "text": "that um the way we're going to do I'm really",
    "start": "2122480",
    "end": "2129640"
  },
  {
    "text": "sorry the way we're going to do that is we're going to run it we're going to run FTP FTP is being run out of inetd or X",
    "start": "2135680",
    "end": "2143200"
  },
  {
    "text": "inetd and uh and each of those just each of those actually sets in their configuration file what user FTP runs as",
    "start": "2143200",
    "end": "2153039"
  },
  {
    "text": "um that's where we were and so what we'll do and what what we'll do after after we after we see one more attack",
    "start": "2153160",
    "end": "2159160"
  },
  {
    "text": "where this would be a really useful defense to have okay is we'll is we'll set we'll set our FTP server to run as",
    "start": "2159160",
    "end": "2165839"
  },
  {
    "text": "user FTP all the time so someone can't if if the FTP Ser server got started as",
    "start": "2165839",
    "end": "2171000"
  },
  {
    "text": "user FTP it can't get up to rout so there's there's you know I mean you can't get the you no matter what",
    "start": "2171000",
    "end": "2177079"
  },
  {
    "text": "programming trick you've got no what no matter what kind of weird vulnerability there is in wofp it's not going to go up",
    "start": "2177079",
    "end": "2182760"
  },
  {
    "text": "because it can't go up it doesn't have privilege on the system system won't let it do that",
    "start": "2182760",
    "end": "2187920"
  },
  {
    "text": "um so um I want to show you one more I want to show you one more vulnerability",
    "start": "2187920",
    "end": "2193520"
  },
  {
    "text": "so then we can talk about the defense um everyone hear about the anyone hear about the site exec vulnerability this",
    "start": "2193520",
    "end": "2199200"
  },
  {
    "text": "was kind of a biggie okay it was a format string bug back when format strings first came out this one was",
    "start": "2199200",
    "end": "2205200"
  },
  {
    "text": "released um uh right when the format string concept came out it was uh it was",
    "start": "2205200",
    "end": "2210400"
  },
  {
    "text": "there were just tons and tons of different packages that were all shown vulnerable and a bunch of cool exploits came out some of them took a while to",
    "start": "2210400",
    "end": "2216920"
  },
  {
    "text": "come out this one came out pretty fast um this let you log in as Anonymous and",
    "start": "2216920",
    "end": "2222000"
  },
  {
    "text": "go all the way up to rout really quick and this is really weird like I said the the reason this is strange is because",
    "start": "2222000",
    "end": "2227960"
  },
  {
    "text": "you're logging in you're logging into this to this FTP server and it's supposed to drop privilege to FTP as",
    "start": "2227960",
    "end": "2233760"
  },
  {
    "text": "soon as as soon as you log in and it does drop privileged FTP and what the exploit if we I could show you the",
    "start": "2233760",
    "end": "2238920"
  },
  {
    "text": "exploit code it's in C but basically the exploit code actually runs you know actually calls set u ID and goes you",
    "start": "2238920",
    "end": "2244920"
  },
  {
    "text": "know hey make me rude again okay and it it go goes up to root and then uh since uh I told you Anonymous Logans are all",
    "start": "2244920",
    "end": "2251560"
  },
  {
    "text": "blocked they all choed they're all jailed in this little directory um it breaks out of that too because root can",
    "start": "2251560",
    "end": "2256839"
  },
  {
    "text": "do that um it's a really it's a really cool exploit um and what it basically",
    "start": "2256839",
    "end": "2262839"
  },
  {
    "text": "what you what you learn from that um well there are there are a couple things one of the one of the exploits that does",
    "start": "2262839",
    "end": "2269160"
  },
  {
    "text": "this is tesos exploit it's called a 7350 W.C I've got a copy um I'll actually put",
    "start": "2269160",
    "end": "2277079"
  },
  {
    "text": "all the exploit code that we've got for this uh up on the up on my website um but the cool thing about this is that in",
    "start": "2277079",
    "end": "2284240"
  },
  {
    "text": "its default mode um it doesn't actually you know when it it has to connect as Anonymous and Anonymous you know you're",
    "start": "2284240",
    "end": "2289280"
  },
  {
    "text": "asked for an email address okay it doesn't actually give a valid email address you know it gives Mozilla at so",
    "start": "2289280",
    "end": "2295960"
  },
  {
    "text": "since there's nothing after that at you know the FTP server what your FTP server says is hey that's a weird address I'm",
    "start": "2295960",
    "end": "2302240"
  },
  {
    "text": "not going to really give you any give you any hell about it but next time come with a come with a real one you know what it what we really like it to do",
    "start": "2302240",
    "end": "2308480"
  },
  {
    "text": "what we really like the FTP server to do is is say that's not a real address go away and and I'll show you how to do",
    "start": "2308480",
    "end": "2313960"
  },
  {
    "text": "that and if you do that breaks this along with a number of other a number of the other scripts that script kitties",
    "start": "2313960",
    "end": "2319440"
  },
  {
    "text": "hit us with the nice thing is when most of us are hit okay we're hit by Script",
    "start": "2319440",
    "end": "2324599"
  },
  {
    "text": "kitties and worms and um I'm not sure which of those is smarter um they're",
    "start": "2324599",
    "end": "2330520"
  },
  {
    "text": "both pretty dumb um and if you just change little things that they weren't expecting um they uh they they generally",
    "start": "2330520",
    "end": "2336359"
  },
  {
    "text": "can't get anywhere um and so one of them is we'll we'll make them give a real a real email address and uh and since",
    "start": "2336359",
    "end": "2342839"
  },
  {
    "text": "neither of them will probably notice they uh they their their tool won't get them anywhere the worms won't notice because they're not that smart they're",
    "start": "2342839",
    "end": "2348680"
  },
  {
    "text": "just scripts the script kitties won't notice because generally they're not watching that closely um and if they are",
    "start": "2348680",
    "end": "2354720"
  },
  {
    "text": "they say what's RFC uh 822 which is what most of us say too um so the first thing",
    "start": "2354720",
    "end": "2363079"
  },
  {
    "text": "you can do is actually just to break this exploit and a few others is you can you that that line that's in bold",
    "start": "2363079",
    "end": "2368960"
  },
  {
    "text": "password minus check rfc822 enforce all that does is say um give me",
    "start": "2368960",
    "end": "2374079"
  },
  {
    "text": "a real email address so you don't get in um uh that one's that's pretty simple and it it breaks a bunch of it breaks a",
    "start": "2374079",
    "end": "2381400"
  },
  {
    "text": "bunch of exploits it's it's kind of crazy what simple stuff goes and breaks most of the stuff that we all you know",
    "start": "2381400",
    "end": "2386440"
  },
  {
    "text": "that we're all that we're all running from and if I told you you could break nimda with some weird you know with some",
    "start": "2386440",
    "end": "2391480"
  },
  {
    "text": "little line and you could break it before you'd even heard of it' be kind of cool to know that you'd be impervious to the next nimda that came out because",
    "start": "2391480",
    "end": "2398079"
  },
  {
    "text": "you know you just had a weird configuration um this isn't weird it's just you know it's just about as locked",
    "start": "2398079",
    "end": "2404119"
  },
  {
    "text": "down as we can get okay um site exec was was useful against wofp up through 260",
    "start": "2404119",
    "end": "2411359"
  },
  {
    "text": "um which means red hat 62 soua 73 HP 1111 I think uh I think Solaris 8",
    "start": "2411359",
    "end": "2419680"
  },
  {
    "text": "um um we can't turn off site exac okay we can't turn off site exac but we can",
    "start": "2419680",
    "end": "2426000"
  },
  {
    "text": "use that you know it's just like the glob code but we can use a nice little trick we can use a nice little trick to contain the damage okay so instead of",
    "start": "2426000",
    "end": "2433400"
  },
  {
    "text": "somebody getting remote rout they're going to get remote user FTP the nice thing about user FTP is it's pretty boring um and unless you unless you have",
    "start": "2433400",
    "end": "2440400"
  },
  {
    "text": "a privilege escalation unless you have some kind of privilege escalation attack you're not going anywhere and the nice thing is most of the privilege",
    "start": "2440400",
    "end": "2446000"
  },
  {
    "text": "escalation attacks don't work from when you're stuck in a little chero jail okay the way the privilege escalation attacks",
    "start": "2446000",
    "end": "2451400"
  },
  {
    "text": "work the way user router worked was it it was there was some weird program called user helper on the systems it you",
    "start": "2451400",
    "end": "2457599"
  },
  {
    "text": "know and that when we create a when we create a chero jail it's a directory that doesn't have much in it it has only",
    "start": "2457599",
    "end": "2463200"
  },
  {
    "text": "what the FTP server needs so it doesn't have these these weird vulnerable you know user helper programs or whatever um",
    "start": "2463200",
    "end": "2470880"
  },
  {
    "text": "so anyway the deal is though that we can block we can block this attack just by running the FTP server if it's just an",
    "start": "2470880",
    "end": "2477880"
  },
  {
    "text": "anonymous FTP server which which is what most of them seem to be okay we just tell it to run as tell it to run as FTP",
    "start": "2477880",
    "end": "2485040"
  },
  {
    "text": "okay both of these last two attacks which we can't we can't stop in any other way we can contain okay if you've",
    "start": "2485040",
    "end": "2491079"
  },
  {
    "text": "got x n d all all it's about is just changing it's going to that file going to the to the file that runs wo fpd at C",
    "start": "2491079",
    "end": "2499560"
  },
  {
    "text": "xet D.D wo fpd you change user from root to FTP in inet d.com it's the same way",
    "start": "2499560",
    "end": "2507720"
  },
  {
    "text": "there's a single line that launches your FTP de and you just change that user from from rout to",
    "start": "2507720",
    "end": "2513200"
  },
  {
    "text": "FTP okay um it's kind of nice okay this",
    "start": "2513200",
    "end": "2519839"
  },
  {
    "text": "is this is this is what we call containment um there's a lot of there there's a lot of things that we can't we",
    "start": "2519839",
    "end": "2524880"
  },
  {
    "text": "can't find our way around but we can stop them from doing much damage we can stop you know and this is really great",
    "start": "2524880",
    "end": "2530240"
  },
  {
    "text": "with the worms because a worm gets onto your system and generally the worm expects to come on of your system be",
    "start": "2530240",
    "end": "2535520"
  },
  {
    "text": "root and start attacking other systems well it's not going to be able to attack other systems if it's assuming it's root and it can't it can't actually run the",
    "start": "2535520",
    "end": "2542000"
  },
  {
    "text": "code that it wanted to run because that code only runs his route and it's stuck in little user FTP and maybe it's stuck",
    "start": "2542000",
    "end": "2548000"
  },
  {
    "text": "in little user FTP in a in a little chero prison with six files okay um the",
    "start": "2548000",
    "end": "2554800"
  },
  {
    "text": "lesson behind this is we we're not going to trust the application actually drop privilege properly okay because we know",
    "start": "2554800",
    "end": "2560280"
  },
  {
    "text": "that sometimes they don't we know that sometimes somebody comes up with a clever attack so we're going to do is just tell the application not to run his",
    "start": "2560280",
    "end": "2566160"
  },
  {
    "text": "route in the first place um or not really tell it force it and use inet D",
    "start": "2566160",
    "end": "2571599"
  },
  {
    "text": "or xet D to force that there any questions you all confused",
    "start": "2571599",
    "end": "2577800"
  },
  {
    "text": "okay you having a good time at all a little bit yeah yeah a little bit okay",
    "start": "2577800",
    "end": "2583920"
  },
  {
    "text": "I'm not going to ask if it was worth getting out of bed a little worried there it's 9:00 a.m. okay so here's",
    "start": "2583920",
    "end": "2590920"
  },
  {
    "text": "another exploit um wofp does this nice thing if there's it it has this nice function that's actually on by default",
    "start": "2590920",
    "end": "2597520"
  },
  {
    "text": "which is this thing called message and what it is is that if uh when you FTP in",
    "start": "2597520",
    "end": "2602559"
  },
  {
    "text": "it you know you ever FTP up to a site and it says you it pops down this thing it says hi and welcome to you know",
    "start": "2602559",
    "end": "2608400"
  },
  {
    "text": "welcome to kernel.org we have lots of Linux here you know um and then you switch directories and it's like you're",
    "start": "2608400",
    "end": "2613520"
  },
  {
    "text": "in the wrong directory the Colonel's over there dumb yeah you know you you get that stuff okay this is message",
    "start": "2613520",
    "end": "2620160"
  },
  {
    "text": "files there aren't too many sites that use it some of the hight trffic sites use it if you don't use it then we",
    "start": "2620160",
    "end": "2625200"
  },
  {
    "text": "should turn it off maybe some of the high traffic sites have changed their mind since this vulnerability came out",
    "start": "2625200",
    "end": "2630359"
  },
  {
    "text": "um either way most of us don't need all this don't don't need the the friendly messages you know we're just putting up",
    "start": "2630359",
    "end": "2636200"
  },
  {
    "text": "an FTP site trade a couple things um so the deal is with these you know the deal",
    "start": "2636200",
    "end": "2642240"
  },
  {
    "text": "is with this with this problem is that um basically if an attacker can write their own message files okay if if the",
    "start": "2642240",
    "end": "2649920"
  },
  {
    "text": "if there's any if there's any directory that basically the attacker can write to okay and doesn't have a message file um",
    "start": "2649920",
    "end": "2656359"
  },
  {
    "text": "then he can he can bust rot from there okay so if he can write a message file he can bust root it's a it's a it's a",
    "start": "2656359",
    "end": "2665680"
  },
  {
    "text": "um now um the question is the issue is the uh I",
    "start": "2665680",
    "end": "2671720"
  },
  {
    "text": "know this slide is is really hard to see um but basically the configuration file",
    "start": "2671720",
    "end": "2678160"
  },
  {
    "text": "is just two little lines that talk about these message things and if we're not using them we can just remove them okay",
    "start": "2678160",
    "end": "2683520"
  },
  {
    "text": "so it's really easy it's really easy to to dodge this one um and a lot of this is this is meant to be a you know this",
    "start": "2683520",
    "end": "2689200"
  },
  {
    "text": "sounds very reactive because that's the way we're doing it because it's more interesting reactive but the idea is to do some of these steps in a proactive",
    "start": "2689200",
    "end": "2695680"
  },
  {
    "text": "fashion you're going to do it now so even though your FTP server doesn't have any trouble with this message stuff right now if they come up with another",
    "start": "2695680",
    "end": "2701400"
  },
  {
    "text": "problem in 2 years you know if they come up with another problem if another problem has been discovered now and we don't find out about it for two years",
    "start": "2701400",
    "end": "2707960"
  },
  {
    "text": "you didn't get hit by it because you know you had that configured off okay so if we can remove those",
    "start": "2707960",
    "end": "2713839"
  },
  {
    "text": "lines um if we can remove those lines we get we we definitely do well the other thing we can do is if we are using that",
    "start": "2713839",
    "end": "2719680"
  },
  {
    "text": "functionality just make sure the permissions on the directories are really good okay we make sure that the",
    "start": "2719680",
    "end": "2724920"
  },
  {
    "text": "we make sure that the attacker can't write can't right message files the last thing is that path filter thing I talked",
    "start": "2724920",
    "end": "2731280"
  },
  {
    "text": "about earlier we're not going to let we're not going to let certain weird file names come up we're not going to let him transfer in anything that begins",
    "start": "2731280",
    "end": "2736480"
  },
  {
    "text": "with a dash or with a period if he can't transfer in anything that begins with a period Then he can't transfer in a",
    "start": "2736480",
    "end": "2741640"
  },
  {
    "text": "message file okay this is again useful the big reason that everyone was doing this for a while is to stop aocs from",
    "start": "2741640",
    "end": "2747280"
  },
  {
    "text": "putting up hidden files and hidden directories on your FTP server so their buddies could come along and and pick",
    "start": "2747280",
    "end": "2752359"
  },
  {
    "text": "them up okay again this this non you know I don't want to be a distribution site for for Wares um becomes a you know",
    "start": "2752359",
    "end": "2760200"
  },
  {
    "text": "becomes a rather not get hacked either by the way um so it's this one's a this",
    "start": "2760200",
    "end": "2766119"
  },
  {
    "text": "one's a pretty easy to avoid the line that's really hard to read up here but should be on your slides is a is a path",
    "start": "2766119",
    "end": "2772760"
  },
  {
    "text": "filter line and it basically says I'm going to point it out on this screen",
    "start": "2772760",
    "end": "2778920"
  },
  {
    "text": "okay or try Okay path filter it talks about different classes of user a little",
    "start": "2778920",
    "end": "2785839"
  },
  {
    "text": "error message there's a file name that's an error message for what you want to say when somebody tries to put up a file they shouldn't like you know what the",
    "start": "2785839",
    "end": "2792920"
  },
  {
    "text": "hell are you trying to do go away from here or or you know you can't put that file here or whatever and the next thing",
    "start": "2792920",
    "end": "2799079"
  },
  {
    "text": "is the first thing is a a pattern I mean the first thing is a list of all the characters it's a pattern it's a list of",
    "start": "2799079",
    "end": "2804680"
  },
  {
    "text": "all the characters that are allowed we'll allow files that have a through z 0 through 9 dots underscores and dashes",
    "start": "2804680",
    "end": "2812880"
  },
  {
    "text": "okay and then the last thing is the last two things are list of patterns that we won't allow anything that begins with a",
    "start": "2812880",
    "end": "2818079"
  },
  {
    "text": "period anything that begins with a with a with a uh with a dash we should probably add underscore to that anything",
    "start": "2818079",
    "end": "2824520"
  },
  {
    "text": "begins with an underscore but we'll leave that alone for now okay if we use this path filter we Dodge a bunch of",
    "start": "2824520",
    "end": "2829839"
  },
  {
    "text": "attacks um we Dodge you know I think we've whatever we dodged two so far out of the ones we've gone through okay um",
    "start": "2829839",
    "end": "2839000"
  },
  {
    "text": "there's also the other thing we can do which is what we've already talked about is we can remove those message lines so if",
    "start": "2839000",
    "end": "2845160"
  },
  {
    "text": "there are message files if somebody can write message files uh they don't get anywhere with the attack cuz we've already turned that functionality off",
    "start": "2845160",
    "end": "2851680"
  },
  {
    "text": "okay so first we're not going to let them upload the message files even if they find a trick around our around our Mighty path filter um they're they're",
    "start": "2851680",
    "end": "2858520"
  },
  {
    "text": "still uh they're still not going to be able to exploit it because the FTP server will say yeah whatever that's just a file it's not special to me I'm",
    "start": "2858520",
    "end": "2864040"
  },
  {
    "text": "not going to try to do anything with it okay um so there's a I've given you a command",
    "start": "2864040",
    "end": "2871839"
  },
  {
    "text": "line you know a command line option that'll just pull those message lines right out um I'm going to show you when",
    "start": "2871839",
    "end": "2877319"
  },
  {
    "text": "we end here um a sample fdp access file that you get after you apply all these all these suggestions okay um really",
    "start": "2877319",
    "end": "2886040"
  },
  {
    "text": "what we want to do is is try to do I mean we're always going to we're always going to hope for avoidance but do",
    "start": "2886040",
    "end": "2891119"
  },
  {
    "text": "everything we can for containment um and that's that's kind of a lesson to be to be learned as we go through here there",
    "start": "2891119",
    "end": "2896680"
  },
  {
    "text": "are a few more best practices one is um logging logging I like to think is the second most boring thing in computer",
    "start": "2896680",
    "end": "2903160"
  },
  {
    "text": "security the first being patching um unfortunately being the most boring they're also some of the most important",
    "start": "2903160",
    "end": "2909160"
  },
  {
    "text": "um darn it so what we do is we just tell the FTP server to log a lot more to log anything it looks like a security",
    "start": "2909160",
    "end": "2915240"
  },
  {
    "text": "violation to log and to log every command that somebody puts in and you know if we read through the logs we'll notice something weird or maybe we maybe",
    "start": "2915240",
    "end": "2921599"
  },
  {
    "text": "we can download something that'll read through our logs for us actually if I saw correctly somebody out there it'll sell you something that'll read through",
    "start": "2921599",
    "end": "2927200"
  },
  {
    "text": "your logs for you um um so we want to we",
    "start": "2927200",
    "end": "2932440"
  },
  {
    "text": "want to log a lot this slide which is which is darn hard to read also says y y all used FTP access FTP access is",
    "start": "2932440",
    "end": "2940400"
  },
  {
    "text": "this file you put all the users in you don't want to be allowed to use FTP one of them is root and the biggest reason",
    "start": "2940400",
    "end": "2945839"
  },
  {
    "text": "for that is you don't want root giving their password away over FTP it's just bad um the uh you know but any system",
    "start": "2945839",
    "end": "2953520"
  },
  {
    "text": "account counts and there's a we've got a we've got a new line called deny uid deny G which says don't let anybody that",
    "start": "2953520",
    "end": "2960839"
  },
  {
    "text": "doesn't look like a human user use this on Linux it's the the the numbers are through 499 you're on on Solaris it's",
    "start": "2960839",
    "end": "2967480"
  },
  {
    "text": "through 99 um you know it's what that is is that's a range okay 0 through 499 all",
    "start": "2967480",
    "end": "2974079"
  },
  {
    "text": "the users that aren't normally human Okay um I've talked about worms",
    "start": "2974079",
    "end": "2980319"
  },
  {
    "text": "and auto rooters a little bit um I'm a member of the honey net project uh but even if I wasn't this statistic would",
    "start": "2980319",
    "end": "2985720"
  },
  {
    "text": "definitely be extremely interesting to me we put up systems we just put up unpatched systems for the most part on",
    "start": "2985720",
    "end": "2991400"
  },
  {
    "text": "the uh on the net and see what happens um and that seeing what happens turns out to be pretty interesting but one of",
    "start": "2991400",
    "end": "2996920"
  },
  {
    "text": "the things that happened was that uh we found that when we put a red hat 62 box on the on the on the internet fastest",
    "start": "2996920",
    "end": "3003520"
  },
  {
    "text": "time a human found it you know scanned it found it scanned it and exploited it",
    "start": "3003520",
    "end": "3008760"
  },
  {
    "text": "was was 15 minutes from when we from when we plugged it in um the scary thing though is that a worm um did it in 92",
    "start": "3008760",
    "end": "3017400"
  },
  {
    "text": "seconds collection of shell scripts you plug in the cable somebody you know you",
    "start": "3017400",
    "end": "3022480"
  },
  {
    "text": "um um you know somebody comes by and starts a conversation you look over you're like actually I'm in the middle something right what the hell you know",
    "start": "3022480",
    "end": "3029839"
  },
  {
    "text": "it's it's uh this kind of stuff happens at colleges all the time in the dorms too",
    "start": "3029839",
    "end": "3035680"
  },
  {
    "text": "um uh whenever I give a whenever I give talks at colleges I always hear about somebody who uh you know plugged in the red hat system they they went off to",
    "start": "3035680",
    "end": "3042760"
  },
  {
    "text": "they went off to dinner they came back and and uh they had email from the campus from the campus ethics office",
    "start": "3042760",
    "end": "3048400"
  },
  {
    "text": "asking why they were hacking other people and they're like I didn't hack anybody it turned out somebody had somebody had taken over their box that",
    "start": "3048400",
    "end": "3054520"
  },
  {
    "text": "quickly and started using it to attack others okay the nice things about a lot of these worms is like I said before with",
    "start": "3054520",
    "end": "3061040"
  },
  {
    "text": "the script Kitty comment they're really dumb okay it's really great how how extremely dumb the worms are okay the",
    "start": "3061040",
    "end": "3068160"
  },
  {
    "text": "ramen worm was a worm that had a that had an FTP exploit as far as I can tell actually its FTP exploit didn't work um",
    "start": "3068160",
    "end": "3075119"
  },
  {
    "text": "because it was using one of the ones that was intentionally broken by the author so script kitties and other things as dumb as script kitties",
    "start": "3075119",
    "end": "3081160"
  },
  {
    "text": "couldn't use them um uh one of the nice things is that the way the ramen worm",
    "start": "3081160",
    "end": "3086280"
  },
  {
    "text": "works is it goes and looks at your FTP header it opens up opens up a connection looks at your FTP header if you have the",
    "start": "3086280",
    "end": "3091839"
  },
  {
    "text": "right date um it says Ah that build date sounds like one I I can I can take care of and it attacks you and if you",
    "start": "3091839",
    "end": "3098839"
  },
  {
    "text": "advertise anything else on that line it doesn't attack You Even If You're vulnerable okay a lot of script kitties",
    "start": "3098839",
    "end": "3104319"
  },
  {
    "text": "operate in exactly the same way there's also an auto rer out there called Auto woo okay this came out in April of this",
    "start": "3104319",
    "end": "3110720"
  },
  {
    "text": "year um it will basically the way you do it is you start it up you feed it a uh",
    "start": "3110720",
    "end": "3116000"
  },
  {
    "text": "you feed it a Class B address space okay you feed it a Class B address space how many address is that like 65,000 you",
    "start": "3116000",
    "end": "3123000"
  },
  {
    "text": "feed it you feed it a you you just give it a number it goes and scans 65,000 addresses across the internet looking",
    "start": "3123000",
    "end": "3129440"
  },
  {
    "text": "for vulnerable FTP systems FTP Service whenever it finds them it Roots them and gives you a you know and let you know",
    "start": "3129440",
    "end": "3135680"
  },
  {
    "text": "hey this is yours have fun um so you know we we found uh we found whenever we",
    "start": "3135680",
    "end": "3141079"
  },
  {
    "text": "we we've gotten systems compromised and someone sets up you know sets up one of these Auto routs after they compromise us and then you know they're going to",
    "start": "3141079",
    "end": "3147319"
  },
  {
    "text": "you know they're hoping to go after if they weren't if we didn't have strict controls in place they'd probably nail you know 100 or you know 100 or 200 more",
    "start": "3147319",
    "end": "3154119"
  },
  {
    "text": "people in the next few hours um the auto rer is a is a really nice powerful tool but the nice thing is this thing again",
    "start": "3154119",
    "end": "3161359"
  },
  {
    "text": "like the ramen worm actually goes and you know looks at headers and says Ah you say you're running a pro ftpd um",
    "start": "3161359",
    "end": "3168280"
  },
  {
    "text": "you're not vulnerable to me I'm going to go and look at somebody else and you're actually running woo but you're just kind of like hiding that um and so this",
    "start": "3168280",
    "end": "3175680"
  },
  {
    "text": "is a there's a nice little trick um either you can change um you can change",
    "start": "3175680",
    "end": "3180880"
  },
  {
    "text": "you can write greeting tur you can add one line says greeting tur and what it'll just say I know it's hard to read",
    "start": "3180880",
    "end": "3186200"
  },
  {
    "text": "what it says is FTP server ready doesn't say what it is doesn't say what date it was built doesn't say what version it",
    "start": "3186200",
    "end": "3192160"
  },
  {
    "text": "was and best of all it doesn't get uh doesn't get caught by it doesn't get caught by worms um however a script",
    "start": "3192160",
    "end": "3199280"
  },
  {
    "text": "Kitty might see that and say okay well I'll try my attack anyway so what's nice",
    "start": "3199280",
    "end": "3204480"
  },
  {
    "text": "is actually we can use instead of greting T you can say greeting text and you can put anything you want you can",
    "start": "3204480",
    "end": "3210400"
  },
  {
    "text": "put go away but my favorite is to put on a wofp server uh pro fpd version 1.3.0",
    "start": "3210400",
    "end": "3218240"
  },
  {
    "text": "you know pre-end which says um you know uh these aren't the droids you're looking for you know or whatever it's",
    "start": "3218240",
    "end": "3224280"
  },
  {
    "text": "it's a you know um um it's basically just saying you know I'm I'm a pro FP server you don't want me you don't want",
    "start": "3224280",
    "end": "3230599"
  },
  {
    "text": "me go go for somebody else you know and uh and again it blocks worms and and it",
    "start": "3230599",
    "end": "3235799"
  },
  {
    "text": "you know deters a good number of script kites too um which is which is really nice I've also put a slide you have to",
    "start": "3235799",
    "end": "3241880"
  },
  {
    "text": "use the stat thing you have to also if you change that if you change the header once somebody logs in they can also ask",
    "start": "3241880",
    "end": "3247319"
  },
  {
    "text": "what kind of FTP server it is so you have to do the same thing with a stat line because they can type stat okay so",
    "start": "3247319",
    "end": "3253640"
  },
  {
    "text": "this is where I show you what kind of file we've been building with all these suggestions okay um we've got all those",
    "start": "3253640",
    "end": "3260119"
  },
  {
    "text": "you know we've got compress no tar no chamad no all these things that say all",
    "start": "3260119",
    "end": "3265520"
  },
  {
    "text": "the things you're not allowed to do okay um we've got an upload area that we",
    "start": "3265520",
    "end": "3271520"
  },
  {
    "text": "created that you can't pull files back down from detering detering a good number of exploits that password",
    "start": "3271520",
    "end": "3277920"
  },
  {
    "text": "checkline says you've got to give a real a real email address nice thing about giving a real email address is the worms",
    "start": "3277920",
    "end": "3283559"
  },
  {
    "text": "the scripts don't tend to do it so uh they fail because they couldn't even finish connecting to the FTP server okay",
    "start": "3283559",
    "end": "3290200"
  },
  {
    "text": "we've got a path filter doesn't let you doesn't let you put in any weird file names okay and that blocks a whole bunch",
    "start": "3290200",
    "end": "3295480"
  },
  {
    "text": "of stuff um we're logging everything out the ying-yang um and hopefully we're going to catch stuff when it happens",
    "start": "3295480",
    "end": "3301520"
  },
  {
    "text": "near you know fairly close to when it happens um we've set in some some of",
    "start": "3301520",
    "end": "3306920"
  },
  {
    "text": "this deny you know we're not going to we're not going to let any any non-human user use this thing we've set up the",
    "start": "3306920",
    "end": "3312359"
  },
  {
    "text": "greeting text to uh to give a fake Banner to fake people out which is a little fun one that umask thing means",
    "start": "3312359",
    "end": "3318520"
  },
  {
    "text": "that if people upload files they can't upload anything executable they can't upload anything that other people could pull down um and that nice line stops uh",
    "start": "3318520",
    "end": "3325920"
  },
  {
    "text": "anybody is able to successfully Doss the FTP server from also dossing the whole Freon box so this is all pretty darn",
    "start": "3325920",
    "end": "3333920"
  },
  {
    "text": "useful um I added in uh a section on chero just for the it's just for the",
    "start": "3333920",
    "end": "3340400"
  },
  {
    "text": "slides that you guys will might want to take a look at this is a there's basically you can shoot all the users",
    "start": "3340400",
    "end": "3346200"
  },
  {
    "text": "with something called guest with something called guest mode um it's really pain in the butt cuz what you do",
    "start": "3346200",
    "end": "3351559"
  },
  {
    "text": "is you put all their you put all their home directories in somewhere like home FTP and uh and now what happens is",
    "start": "3351559",
    "end": "3357839"
  },
  {
    "text": "they're is they're choed into home FTP and they're able whenever they FTP up and this is really useful because again",
    "start": "3357839",
    "end": "3364440"
  },
  {
    "text": "remember how at the beginning of this I used an exploit it gave me uh it gave me shell access as user J and then I I used",
    "start": "3364440",
    "end": "3370720"
  },
  {
    "text": "user rer which found another program Elsewhere on the box that was vulnerable and exploited that to get root well if",
    "start": "3370720",
    "end": "3377119"
  },
  {
    "text": "Jay got choed then he couldn't find anything else on the box um and if he can't find anything else in the box",
    "start": "3377119",
    "end": "3383319"
  },
  {
    "text": "that's vulnerable he can escalate privilege up to rout and you know the poor saps just got user J which is not a",
    "start": "3383319",
    "end": "3388920"
  },
  {
    "text": "very interesting user um so this I've basically given you instructions on how",
    "start": "3388920",
    "end": "3394000"
  },
  {
    "text": "to do guest access um and it's just you know you just create pardon me you just",
    "start": "3394000",
    "end": "3400880"
  },
  {
    "text": "create you just set up the directives and there's some there's some choding involved um and there's a how-to for",
    "start": "3400880",
    "end": "3407039"
  },
  {
    "text": "exactly how to do this on wofp site um there's also a couple ways to cheat um",
    "start": "3407039",
    "end": "3412640"
  },
  {
    "text": "and the uh um and one of them is just copy all the if you if you already have an anonymous upload area you can take",
    "start": "3412640",
    "end": "3418760"
  },
  {
    "text": "the the the shed environment from there and copy it over um this is this is covered in the in the how too okay I",
    "start": "3418760",
    "end": "3426640"
  },
  {
    "text": "have one more thing that I added in that I added in last night um I was uh I was uh one of the one of the many black hat",
    "start": "3426640",
    "end": "3432920"
  },
  {
    "text": "parties and somebody said actually one of the things that I do is I I make all my FTP servers run as virtual servers",
    "start": "3432920",
    "end": "3439240"
  },
  {
    "text": "and what he means by virtual servers is that instead of instead of his his FTP servers aren't accessible um not",
    "start": "3439240",
    "end": "3446440"
  },
  {
    "text": "accessible by IP address because if you just try to connect to the to an ft to the FTP port on that IP address but",
    "start": "3446440",
    "end": "3452319"
  },
  {
    "text": "you're not using the right name um then you don't get anywhere okay you don't get the real FTP Ser you get the real",
    "start": "3452319",
    "end": "3458160"
  },
  {
    "text": "FTP server not the virtual one that's you know actually what's doing everything so for the most part you",
    "start": "3458160",
    "end": "3463640"
  },
  {
    "text": "don't actually get to you don't actually you know the all the things that go and scan large portions of the internet um looking for vulnerable systems um find",
    "start": "3463640",
    "end": "3471160"
  },
  {
    "text": "they can't really interact with much of the system because they don't know the name of the they don't know the name of the virtual area",
    "start": "3471160",
    "end": "3476960"
  },
  {
    "text": "does this make sense it's kind of an odd concept I hadn't thought of it this was a really good idea and I said you know",
    "start": "3476960",
    "end": "3482839"
  },
  {
    "text": "I'll I'll put that in my I'll put that in the class the next time I do it I'll put that in talk the next time I did it I do it and I you know I was thinking",
    "start": "3482839",
    "end": "3489079"
  },
  {
    "text": "last night God that's a really good idea you could you could Dodge you could Dodge a lot of the worms a lot of the",
    "start": "3489079",
    "end": "3494400"
  },
  {
    "text": "automated you know a lot of the automated attack tools just by doing this and so what I've done is I've I've",
    "start": "3494400",
    "end": "3499920"
  },
  {
    "text": "given you instructions the other cool thing is I was busting on FTP because it's always giving away people's",
    "start": "3499920",
    "end": "3505119"
  },
  {
    "text": "passwords the nice thing is when you go virtual when you do a virtual server you can have normal users that with their",
    "start": "3505119",
    "end": "3511240"
  },
  {
    "text": "own passwords but you could they can have a second password that just works for the FTP server they have a second password that works for the FTP server",
    "start": "3511240",
    "end": "3518119"
  },
  {
    "text": "yeah they're going to lose their you know someone's going to pill for their password but that someone will only be able to use the FTP server they won't be",
    "start": "3518119",
    "end": "3523440"
  },
  {
    "text": "able to use the the the person's normal account for tnet or SS or whatever because they have a different password",
    "start": "3523440",
    "end": "3529039"
  },
  {
    "text": "over there yes this requires educating your users and telling them not to use the same password that this was the",
    "start": "3529039",
    "end": "3534319"
  },
  {
    "text": "whole point but it it it definitely can be done um okay and uh I've got I've got slides",
    "start": "3534319",
    "end": "3542160"
  },
  {
    "text": "on that um the last thing I generally get asked is and we've got five more slides I promise I know we're running on",
    "start": "3542160",
    "end": "3548599"
  },
  {
    "text": "time the last thing we I get asked is well if W fdp so bad why don't you just go and use something else I mean you",
    "start": "3548599",
    "end": "3554280"
  },
  {
    "text": "talk about Pro FP well well Pro FPS had a bunch of vulnerabilities and people say well well open BSD yeah Theo rocks",
    "start": "3554280",
    "end": "3562039"
  },
  {
    "text": "and yes Theo does rock and open BSD does rock and if you have a firewall use a open BSD for your firewall go w r um but",
    "start": "3562039",
    "end": "3570160"
  },
  {
    "text": "uh open bsd's FTP demon has also had a remote root grab um it wasn't well publici it wasn't too publicized because",
    "start": "3570160",
    "end": "3577280"
  },
  {
    "text": "it wasn't in the default install the default install of FTP of of openbsd turns that off um but if you turn it",
    "start": "3577280",
    "end": "3584200"
  },
  {
    "text": "back on you you got hit um there is one good there is there is one good um",
    "start": "3584200",
    "end": "3590799"
  },
  {
    "text": "alternative and that's vsftpd okay and this thing has not had a security issue yet um it's really it's",
    "start": "3590799",
    "end": "3597799"
  },
  {
    "text": "really welld designed um and it's just you know it's just it was written for security it was written with security",
    "start": "3597799",
    "end": "3603200"
  },
  {
    "text": "mind it's got fewer features you want to try it out on the development system for like a month before you move your FTP",
    "start": "3603200",
    "end": "3609480"
  },
  {
    "text": "server over to it to make sure that you're not losing any functionality that you need but it's it's pretty sweet um",
    "start": "3609480",
    "end": "3616520"
  },
  {
    "text": "by the way that tar attack wouldn't have worked because it doesn't let you use tar it doesn't even let it doesn't even",
    "start": "3616520",
    "end": "3621640"
  },
  {
    "text": "have to use LS or anything like that um so it's pretty nice it also as it's",
    "start": "3621640",
    "end": "3627240"
  },
  {
    "text": "becoming a common thing with programs like postfix it actually uses multiple programs and some of those have lots of",
    "start": "3627240",
    "end": "3633200"
  },
  {
    "text": "privilege and some of those interact with users and they're not the same ones so it's just a lot lot safer okay and uh",
    "start": "3633200",
    "end": "3641359"
  },
  {
    "text": "you can pull it down from beasts. org from vstb d. beasts. org and if anyone",
    "start": "3641359",
    "end": "3646599"
  },
  {
    "text": "knows the story behind that domain name I really do want to know okay um lastly",
    "start": "3646599",
    "end": "3653039"
  },
  {
    "text": "I busted on FTP as I always do um maybe we could use HTTP to to give away files",
    "start": "3653039",
    "end": "3659079"
  },
  {
    "text": "to everybody and if we could get everyone on SSH and SFTP um that would really be nice because they're full",
    "start": "3659079",
    "end": "3665039"
  },
  {
    "text": "replacements for FTP and and uh and at this point I think they're even they're even mostly",
    "start": "3665039",
    "end": "3670680"
  },
  {
    "text": "free um so uh um at this point um go in",
    "start": "3670680",
    "end": "3676039"
  },
  {
    "text": "peace um you're done you're done um if you can please uh please do go and",
    "start": "3676039",
    "end": "3682280"
  },
  {
    "text": "change your FTP servers um if you uh if you call me up in month and tell me you just got rooted through your FTP server",
    "start": "3682280",
    "end": "3688200"
  },
  {
    "text": "because you're going get get around to doing this stuff I promise I won't laugh at you um but uh but uh somebody else",
    "start": "3688200",
    "end": "3695760"
  },
  {
    "text": "might [Applause]",
    "start": "3695760",
    "end": "3704869"
  },
  {
    "text": "okay",
    "start": "3714839",
    "end": "3717839"
  },
  {
    "text": "e",
    "start": "3744839",
    "end": "3747839"
  },
  {
    "text": "e",
    "start": "3774839",
    "end": "3777839"
  },
  {
    "text": "e",
    "start": "3804760",
    "end": "3807760"
  },
  {
    "text": "e",
    "start": "3834720",
    "end": "3837720"
  },
  {
    "text": "e",
    "start": "3864720",
    "end": "3867720"
  },
  {
    "text": "e",
    "start": "3894640",
    "end": "3897640"
  },
  {
    "text": "e",
    "start": "3924640",
    "end": "3927640"
  },
  {
    "text": "e",
    "start": "3954640",
    "end": "3957640"
  },
  {
    "text": "e",
    "start": "3984559",
    "end": "3987559"
  },
  {
    "text": "e",
    "start": "4014520",
    "end": "4017520"
  },
  {
    "text": "e",
    "start": "4044520",
    "end": "4047520"
  },
  {
    "text": "e",
    "start": "4074440",
    "end": "4077440"
  },
  {
    "text": "e",
    "start": "4104440",
    "end": "4107440"
  },
  {
    "text": "e",
    "start": "4134440",
    "end": "4137440"
  },
  {
    "text": "e",
    "start": "4164359",
    "end": "4167359"
  },
  {
    "text": "e",
    "start": "4194320",
    "end": "4197320"
  },
  {
    "text": "e",
    "start": "4224320",
    "end": "4227320"
  },
  {
    "text": "e",
    "start": "4254239",
    "end": "4257239"
  },
  {
    "text": "e",
    "start": "4284239",
    "end": "4287239"
  },
  {
    "text": "e",
    "start": "4314239",
    "end": "4317239"
  },
  {
    "text": "e",
    "start": "4344159",
    "end": "4347159"
  },
  {
    "text": "e",
    "start": "4374120",
    "end": "4377120"
  },
  {
    "text": "e",
    "start": "4404120",
    "end": "4407120"
  },
  {
    "text": "e",
    "start": "4434040",
    "end": "4437040"
  },
  {
    "text": "e",
    "start": "4464040",
    "end": "4467040"
  },
  {
    "text": "e",
    "start": "4494000",
    "end": "4497000"
  },
  {
    "text": "e",
    "start": "4523960",
    "end": "4526960"
  },
  {
    "text": "e",
    "start": "4553920",
    "end": "4556920"
  },
  {
    "text": "e",
    "start": "4583920",
    "end": "4586920"
  },
  {
    "text": "e",
    "start": "4613840",
    "end": "4616840"
  },
  {
    "text": "e",
    "start": "4643840",
    "end": "4646840"
  },
  {
    "text": "e",
    "start": "4673840",
    "end": "4676840"
  },
  {
    "text": "e",
    "start": "4703760",
    "end": "4706760"
  },
  {
    "text": "e",
    "start": "4733719",
    "end": "4736719"
  },
  {
    "text": "e",
    "start": "4763719",
    "end": "4766719"
  },
  {
    "text": "e",
    "start": "4793639",
    "end": "4796639"
  },
  {
    "text": "e",
    "start": "4823639",
    "end": "4826639"
  },
  {
    "text": "e",
    "start": "4853639",
    "end": "4856639"
  },
  {
    "text": "e",
    "start": "4883560",
    "end": "4886560"
  },
  {
    "text": "e",
    "start": "4913520",
    "end": "4916520"
  },
  {
    "text": "e",
    "start": "4943520",
    "end": "4946520"
  },
  {
    "text": "e",
    "start": "4973440",
    "end": "4976440"
  },
  {
    "text": "e",
    "start": "5003440",
    "end": "5006440"
  },
  {
    "text": "e",
    "start": "5033440",
    "end": "5036440"
  },
  {
    "text": "e",
    "start": "5063320",
    "end": "5066320"
  },
  {
    "text": "e",
    "start": "5093320",
    "end": "5096320"
  },
  {
    "text": "e",
    "start": "5123320",
    "end": "5126320"
  },
  {
    "text": "e",
    "start": "5153239",
    "end": "5156239"
  },
  {
    "text": "e",
    "start": "5183239",
    "end": "5186239"
  },
  {
    "text": "e",
    "start": "5213239",
    "end": "5216239"
  },
  {
    "text": "e",
    "start": "5243119",
    "end": "5246119"
  },
  {
    "text": "e",
    "start": "5273119",
    "end": "5276119"
  },
  {
    "text": "e",
    "start": "5303119",
    "end": "5306119"
  },
  {
    "text": "e",
    "start": "5333040",
    "end": "5336040"
  },
  {
    "text": "e",
    "start": "5363040",
    "end": "5366040"
  },
  {
    "text": "e",
    "start": "5393040",
    "end": "5396040"
  },
  {
    "text": "e",
    "start": "5422960",
    "end": "5425960"
  },
  {
    "text": "e",
    "start": "5452920",
    "end": "5455920"
  },
  {
    "text": "e",
    "start": "5482920",
    "end": "5485920"
  },
  {
    "text": "e",
    "start": "5512840",
    "end": "5515840"
  },
  {
    "text": "e",
    "start": "5542840",
    "end": "5545840"
  },
  {
    "text": "e",
    "start": "5572840",
    "end": "5575840"
  },
  {
    "text": "e",
    "start": "5602760",
    "end": "5605760"
  },
  {
    "text": "e",
    "start": "5632719",
    "end": "5635719"
  },
  {
    "text": "e",
    "start": "5662719",
    "end": "5665719"
  },
  {
    "text": "e",
    "start": "5692639",
    "end": "5695639"
  },
  {
    "text": "e",
    "start": "5722639",
    "end": "5725639"
  },
  {
    "text": "e",
    "start": "5752639",
    "end": "5755639"
  },
  {
    "text": "e",
    "start": "5782560",
    "end": "5785560"
  },
  {
    "text": "e",
    "start": "5812520",
    "end": "5815520"
  },
  {
    "text": "e",
    "start": "5842520",
    "end": "5845520"
  },
  {
    "text": "e",
    "start": "5872440",
    "end": "5875440"
  },
  {
    "text": "e",
    "start": "5902440",
    "end": "5905440"
  },
  {
    "text": "e",
    "start": "5932440",
    "end": "5935440"
  },
  {
    "text": "e",
    "start": "5962360",
    "end": "5965360"
  },
  {
    "text": "e",
    "start": "5992320",
    "end": "5995320"
  },
  {
    "text": "e e",
    "start": "6022320",
    "end": "6026320"
  }
]