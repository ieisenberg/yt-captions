[
  {
    "start": "0",
    "end": "104000"
  },
  {
    "text": "welcome to what I'm calling beyond the box powering intrusion investigation so",
    "start": "20",
    "end": "5850"
  },
  {
    "text": "the Genesis for this talk has been my experience as a instant responder as an",
    "start": "5850",
    "end": "11160"
  },
  {
    "text": "investigator out in the corporate world working on investigations and as part of",
    "start": "11160",
    "end": "17220"
  },
  {
    "text": "my job and facilitating those investigations and that in performing analysis we need a lot of data from our",
    "start": "17220",
    "end": "22859"
  },
  {
    "text": "clients and I find that a lot of organizations have implemented a lot of",
    "start": "22859",
    "end": "28349"
  },
  {
    "text": "different tools and so they've got the dashboards and they've got pie charts and graphs of interesting things about",
    "start": "28349",
    "end": "34290"
  },
  {
    "text": "the network they may have a security event management system but ultimately",
    "start": "34290",
    "end": "39329"
  },
  {
    "text": "there they haven't implemented the procedures and really tested use cases",
    "start": "39329",
    "end": "44879"
  },
  {
    "text": "that enable them to derive useful information from those tools that they have in an investigative context so on",
    "start": "44879",
    "end": "53550"
  },
  {
    "text": "the agenda for today I want to spend a few minutes at the beginning of this talking about what is an investigation",
    "start": "53550",
    "end": "59359"
  },
  {
    "text": "how do you get into an investigation what are some of the key things key goals of an investigation and what types",
    "start": "59359",
    "end": "65338"
  },
  {
    "text": "of data do you need and then review five capabilities that I've found very",
    "start": "65339",
    "end": "70830"
  },
  {
    "text": "important to providing data that is needed to to do an investigation I",
    "start": "70830",
    "end": "76590"
  },
  {
    "text": "wanted to state up front that I'm not going to be talking about specific tools to answer these five capabilities it as",
    "start": "76590",
    "end": "82860"
  },
  {
    "text": "appropriate as I'm going through all mentioned where there are techniques that you can use and where there are open source or commercial tools but",
    "start": "82860",
    "end": "90000"
  },
  {
    "text": "ultimately this is really not about the tools this is about understanding the capabilities and and then applying the",
    "start": "90000",
    "end": "95610"
  },
  {
    "text": "multitude of tools that are out there some of which your organization's may and probably already possess to get to",
    "start": "95610",
    "end": "102240"
  },
  {
    "text": "the heart of that problem so the five capabilities are number one if you have",
    "start": "102240",
    "end": "108479"
  },
  {
    "start": "104000",
    "end": "198000"
  },
  {
    "text": "an IP address so an internal IP address and a time stamp you need to have the",
    "start": "108479",
    "end": "114720"
  },
  {
    "text": "capability to take that information and determine what host that corresponds to so the computer system the host name if",
    "start": "114720",
    "end": "121649"
  },
  {
    "text": "you have an account name that it's of interest in your investigation you need to be able to take that account name and",
    "start": "121649",
    "end": "127680"
  },
  {
    "text": "for some period of time figure out where that account has been used to authenticate",
    "start": "127680",
    "end": "133310"
  },
  {
    "text": "you need to be able to have an internet IP address so you think attacker command",
    "start": "133310",
    "end": "138349"
  },
  {
    "text": "and control and figure out what other systems in the environment besides the",
    "start": "138349",
    "end": "143390"
  },
  {
    "text": "one or two that you may know about have communicated with that address and I mean currently and then also going back",
    "start": "143390",
    "end": "148760"
  },
  {
    "text": "some time into the past the same goes for domain name resolution attempts so if you have a fully qualified domain",
    "start": "148760",
    "end": "154910"
  },
  {
    "text": "name is associated with an attacker tool usually a back door you need to be able",
    "start": "154910",
    "end": "160790"
  },
  {
    "text": "to track what systems have resolved that domain name similar but but also a",
    "start": "160790",
    "end": "165950"
  },
  {
    "text": "different than looking at the network activity and I'll explain why later and then fifth and this is very important",
    "start": "165950",
    "end": "172549"
  },
  {
    "text": "you need the capability to query your environment searching for indicators of compromise and this is really important",
    "start": "172549",
    "end": "179540"
  },
  {
    "text": "to take the results of your investigation is progressing and convert that into useful information that's",
    "start": "179540",
    "end": "184580"
  },
  {
    "text": "going to allow you to run your investigation across the entire enterprise and then all but the very",
    "start": "184580",
    "end": "190700"
  },
  {
    "text": "smallest organizations this is a really critical component so as we go through",
    "start": "190700",
    "end": "200150"
  },
  {
    "start": "198000",
    "end": "330000"
  },
  {
    "text": "I'd like you to put yourself in an investigator shoe so picture that as we go through these case studies that",
    "start": "200150",
    "end": "205489"
  },
  {
    "text": "you're the person that's responsible within your organization whether or we've been within one of your clients if you're a consultant for figuring out",
    "start": "205489",
    "end": "212180"
  },
  {
    "text": "what's going on what does this attack are doing in the environment what data did they steal how do we get them out of",
    "start": "212180",
    "end": "217640"
  },
  {
    "text": "here and consider as we go through these today if this were to happen in your organization so if somebody gave you the",
    "start": "217640",
    "end": "223850"
  },
  {
    "text": "piece of information that I'm about to show you as a prompt for the use case what would you be able to do with that",
    "start": "223850",
    "end": "230090"
  },
  {
    "text": "information would you you know if you can if you would say immediately yes we definitely have this capability we could get you that information here's how we",
    "start": "230090",
    "end": "236060"
  },
  {
    "text": "would do it that's great if the answer is that al we this would be difficult then I would suggest that it's something",
    "start": "236060",
    "end": "242389"
  },
  {
    "text": "that you may want to think about doing to take that take that thought back and and kind of integrate that into your",
    "start": "242389",
    "end": "248420"
  },
  {
    "text": "ongoing security projects to try and get that data the last time the worst time",
    "start": "248420",
    "end": "253459"
  },
  {
    "text": "to be first thinking about these issues is when you're in the middle of an investigation beginning of investigation",
    "start": "253459",
    "end": "260349"
  },
  {
    "text": "and that's where I am all the time with my clients where things have it hit",
    "start": "260349",
    "end": "266180"
  },
  {
    "text": "proverbial ends you're working late nights you know you're working 20-plus hours a day until",
    "start": "266180",
    "end": "271940"
  },
  {
    "text": "you're exhausted you know sleeping at the office and executives are hammering your boss with questions you're trying",
    "start": "271940",
    "end": "277610"
  },
  {
    "text": "to get answers that's not the time to be thinking about do I have this capability i would suggest building your own use",
    "start": "277610",
    "end": "284900"
  },
  {
    "text": "cases so take what i what i'm saying here which is my experience take your own experience from the types of",
    "start": "284900",
    "end": "290169"
  },
  {
    "text": "investigations that you've done either other jobs or your current organization and come up with a set of capabilities",
    "start": "290169",
    "end": "295490"
  },
  {
    "text": "that you think are useful in the context of your organization it really is individualized it depends on what",
    "start": "295490",
    "end": "301610"
  },
  {
    "text": "service providers you may have that may provide capabilities that you don't need to duplicate etc but basically come up",
    "start": "301610",
    "end": "306770"
  },
  {
    "text": "with these use cases and figure out what are we going to do from here how can we build these capabilities it's going to",
    "start": "306770",
    "end": "312530"
  },
  {
    "text": "be hard work it I know I would be a billionaire and be retired if this you know if I'd come up with a way to solve",
    "start": "312530",
    "end": "319280"
  },
  {
    "text": "this problem in an easy way but there really is no shortcut this is definitely going to be a lot of hard work but it",
    "start": "319280",
    "end": "325520"
  },
  {
    "text": "will pay off on the unfortunate day when you're in an incident so to give you a",
    "start": "325520",
    "end": "331520"
  },
  {
    "start": "330000",
    "end": "399000"
  },
  {
    "text": "little bit of context of who I am and what I do I'm a senior manager with a",
    "start": "331520",
    "end": "336830"
  },
  {
    "text": "company called mandiant which is a subsidiary of fire I and my world is is",
    "start": "336830",
    "end": "342409"
  },
  {
    "text": "primarily running incident investigations mostly for fortune 500",
    "start": "342409",
    "end": "347750"
  },
  {
    "text": "type companies I last year I did ten investigations personally and our",
    "start": "347750",
    "end": "354469"
  },
  {
    "text": "organization we had somewhere around 200 so we do what we do this a lot is what I do every day and a lot of what I do",
    "start": "354469",
    "end": "362990"
  },
  {
    "text": "during the during a a response is so I'm a team lead no I'm interfacing with",
    "start": "362990",
    "end": "368690"
  },
  {
    "text": "different specialists on my team making sure they're looking at the right things making sure that their works accurate etc and then also interfacing with a",
    "start": "368690",
    "end": "375169"
  },
  {
    "text": "client so I'm kind of the the the person who has to have these same discussions and the things I'm gonna relate to you",
    "start": "375169",
    "end": "381259"
  },
  {
    "text": "today with client explain look we really need you to tell us what this hostname is because if we know if you can't tell",
    "start": "381259",
    "end": "387530"
  },
  {
    "text": "us what that host name is there if you're going to give me a list of ten systems that may have had this IP address maybe then we're going to have",
    "start": "387530",
    "end": "393169"
  },
  {
    "text": "to spend you know this level of effort to look at those ten systems etc so working with clients to get answers to",
    "start": "393169",
    "end": "398960"
  },
  {
    "text": "all these questions so to give you a little context on investigations and it's been my",
    "start": "398960",
    "end": "404030"
  },
  {
    "start": "399000",
    "end": "488000"
  },
  {
    "text": "experience and this really depends on the type of work you do is investigator but the majority of the incidents that",
    "start": "404030",
    "end": "409910"
  },
  {
    "text": "that I've been involved in started with a notification from a law enforcement agency in and I'll caveat this with my",
    "start": "409910",
    "end": "417440"
  },
  {
    "text": "experiences both mostly United States or European based companies I really have not done that much work in Asia but i",
    "start": "417440",
    "end": "424370"
  },
  {
    "text": "would expect it's probably somewhere so what happens in these situations is",
    "start": "424370",
    "end": "429770"
  },
  {
    "text": "government knocks on your door in the u.s. it's often the Federal Bureau of Investigation or maybe other agencies",
    "start": "429770",
    "end": "435890"
  },
  {
    "text": "depending on what type of attacker and is involved and they say you know you guys have a problem let me give you a",
    "start": "435890",
    "end": "442550"
  },
  {
    "text": "list of IP addresses here's three accounts that are compromised thank you have a good day and it's not that",
    "start": "442550",
    "end": "449060"
  },
  {
    "text": "they're they're being you know the being mean on purpose they they have other objectives and the investigative work that they do they're providing you some",
    "start": "449060",
    "end": "455090"
  },
  {
    "text": "information is it courtesy and it's very limited keep in mind if you're on the receiving end of a notification from an",
    "start": "455090",
    "end": "461570"
  },
  {
    "text": "external party whether it's law enforcement or another another peer organization or someone else that the",
    "start": "461570",
    "end": "468290"
  },
  {
    "text": "information that they provide you is probably not complete so it's really important to take this as hmm this is interesting this is the tip of a",
    "start": "468290",
    "end": "474440"
  },
  {
    "text": "potential iceberg let me make sure that I got this but this is all the systems because in my experience the say they",
    "start": "474440",
    "end": "481190"
  },
  {
    "text": "tell you that you have three systems that are infected very often that the number is actually much higher than that and if all you do is remove those three",
    "start": "481190",
    "end": "486980"
  },
  {
    "text": "that's a problem the other way that Mike that my clients identify these is this is they'll self-identified which in the",
    "start": "486980",
    "end": "494510"
  },
  {
    "start": "488000",
    "end": "541000"
  },
  {
    "text": "cases I did last calendar year there was three out of ten that actually found it themselves without having to get",
    "start": "494510",
    "end": "500030"
  },
  {
    "text": "notified by law enforcement so usually how they identify it is a sysadmin or",
    "start": "500030",
    "end": "505040"
  },
  {
    "text": "security security person identifies something unusual that usually antivirus catches so in this Gavin Apple of a",
    "start": "505040",
    "end": "513289"
  },
  {
    "text": "sanitized screenshots from reports basically this was a password hash dumper that was running on a workstation",
    "start": "513290",
    "end": "518890"
  },
  {
    "text": "in one case I had last year they actually caught hash dumper running on the domain controller which what was",
    "start": "518890",
    "end": "525110"
  },
  {
    "text": "helpful about it is rather than look at it and say great great win for antivirus let's move on with the day they asked",
    "start": "525110",
    "end": "531170"
  },
  {
    "text": "the the golden question which is how did the password hash don't forget on my domain controller and then that turned",
    "start": "531170",
    "end": "536870"
  },
  {
    "text": "in the attacker had been in their environment for a bit over two years so",
    "start": "536870",
    "end": "541940"
  },
  {
    "start": "541000",
    "end": "607000"
  },
  {
    "text": "these are the questions and by the way if you have the black hat CD the",
    "start": "541940",
    "end": "547519"
  },
  {
    "text": "conference ed most of the slides of the slides that have bullet points in more words those are on on the CD the ones of",
    "start": "547519",
    "end": "555170"
  },
  {
    "text": "the screenshots are sanitized reports and things are not and also the white paper this is also on the CD has a lot",
    "start": "555170",
    "end": "562279"
  },
  {
    "text": "of this information even more depth and also has references and other suggested reading so these are some questions that",
    "start": "562279",
    "end": "569829"
  },
  {
    "text": "executives in the company and your boss is going to ask if you picture you're the investigative leads so what is",
    "start": "569829",
    "end": "575990"
  },
  {
    "text": "exposed you know did we do we lose the the secret formula and then the next question that brings to mind is what am",
    "start": "575990",
    "end": "582019"
  },
  {
    "text": "I going to have to do about this because their world is are you great I'm going to be on the news do I have to notify a regulator so I have to notify my",
    "start": "582019",
    "end": "588230"
  },
  {
    "text": "customers how bad is this is this one system can I can I go to bed at night or in sleep or is this you know a thousand",
    "start": "588230",
    "end": "594500"
  },
  {
    "text": "systems how much money did we lose which is also of course very important how did the attacker get in so we can close",
    "start": "594500",
    "end": "600199"
  },
  {
    "text": "those doors and then the bottom line is how do we effectively stop this attack and recover from it move on close the",
    "start": "600199",
    "end": "606230"
  },
  {
    "text": "doors so I want to illustrate one of the reasons that it's very important to to",
    "start": "606230",
    "end": "613160"
  },
  {
    "start": "607000",
    "end": "746000"
  },
  {
    "text": "do the investigation correctly and this is because this is how the if you do the better investigation you perform that",
    "start": "613160",
    "end": "619339"
  },
  {
    "text": "more thorough the better your remediation effort is going to be so in this example and this is this is this is",
    "start": "619339",
    "end": "626329"
  },
  {
    "text": "from a presentation I did a black hat two years ago on targeted threat remediation and I have the reference in to that white paper if you're interested",
    "start": "626329",
    "end": "633019"
  },
  {
    "text": "in the topic but basically picture this somebody came to you and said you're infected you have an attack on your",
    "start": "633019",
    "end": "639380"
  },
  {
    "text": "network there's three systems that are infected I'm sorry one system that's in fact they tell you about this pc-1 pc2",
    "start": "639380",
    "end": "645290"
  },
  {
    "text": "and web server is also infected you clean pc1 you thank them and you clean",
    "start": "645290",
    "end": "650779"
  },
  {
    "text": "it but if you don't do any investigation you don't realize that you have no way to tell that pc to still infected",
    "start": "650779",
    "end": "656240"
  },
  {
    "text": "cylinder the attackers control the web shell but on the web server is still infected and cylinder their attackers control so you really haven't done",
    "start": "656240",
    "end": "662269"
  },
  {
    "text": "anything except for you know maybe if the attacker cares to notice you've told him that you know about out whatever he did to that pc1 and",
    "start": "662269",
    "end": "668870"
  },
  {
    "text": "about this command and control so the better you can answer these questions that were posed the better you can",
    "start": "668870",
    "end": "675740"
  },
  {
    "text": "remediate another example I wanted to point this out this will be a theme of it laters some of these questions that",
    "start": "675740",
    "end": "682070"
  },
  {
    "text": "we asked that i'm going to ask relate to you want to understand the totality of",
    "start": "682070",
    "end": "687199"
  },
  {
    "text": "what the attacker did so you don't want to just chase malware which is what i see a lot of less experienced",
    "start": "687199",
    "end": "692480"
  },
  {
    "text": "investigators doing so in this situation you've got two laptops that have been fished and they're communicating with",
    "start": "692480",
    "end": "698899"
  },
  {
    "text": "some command and control oh by the way all the IP addresses and domain names everything you see in here are totally chosen random so if this is anybody's",
    "start": "698899",
    "end": "705230"
  },
  {
    "text": "company I apologize you're not actually owned so these two pieces of just ensure",
    "start": "705230",
    "end": "711529"
  },
  {
    "text": "compromise but if all you do is find the malware you're only going to find these two systems you're not you're going to miss the fact that there was some",
    "start": "711529",
    "end": "717649"
  },
  {
    "text": "interesting activity on this application server know there's a net use that used wonder wonder what the attacker was",
    "start": "717649",
    "end": "723170"
  },
  {
    "text": "doing on those file servers maybe use grabbing files or they also ftp doubt now what was he doing on this database",
    "start": "723170",
    "end": "728660"
  },
  {
    "text": "server you're going to miss all those contact contextual details which could be very important to understanding what",
    "start": "728660",
    "end": "734360"
  },
  {
    "text": "really happened so it's important to investigate the intrusion and the activities that usually are being",
    "start": "734360",
    "end": "740540"
  },
  {
    "text": "performed by in case of any target threat by human being it's not just a",
    "start": "740540",
    "end": "745610"
  },
  {
    "text": "piece of malware so so it's high level questions that I that I laid out earlier",
    "start": "745610",
    "end": "751430"
  },
  {
    "start": "746000",
    "end": "942000"
  },
  {
    "text": "that's what that's what the executives are going to be asking that's what you know your boss is going to be getting hammered with you know multiple times a",
    "start": "751430",
    "end": "757490"
  },
  {
    "text": "day and meetings all day so only over so what are the questions you need to answer now as investigation leads is a",
    "start": "757490",
    "end": "764149"
  },
  {
    "text": "technical person so how far back Cisco when is early 7th of compromise in",
    "start": "764149",
    "end": "770149"
  },
  {
    "text": "certain types of investigations this is really important and has a bottom line impact like for example if you process",
    "start": "770149",
    "end": "776089"
  },
  {
    "text": "payment data or if you've lost credit card information especially credit card information but also other types of",
    "start": "776089",
    "end": "781250"
  },
  {
    "text": "regulated personal information this is you live and die by this because if say your systems were only compromised last",
    "start": "781250",
    "end": "786920"
  },
  {
    "text": "week well if you can shut it down tonight then your window of compromised that the credit card brands are going to hold you you know accountable for is",
    "start": "786920",
    "end": "793490"
  },
  {
    "text": "pretty limited if you can shake the attacker definitely showed up on this day if you can't determine that or if it",
    "start": "793490",
    "end": "798560"
  },
  {
    "text": "turns out the attackers been in the environment for year then your exposure just went up greatly from from a legal legal",
    "start": "798560",
    "end": "804700"
  },
  {
    "text": "perspective how did the attacker get in you want to know this obviously so that you can perform the right remediation",
    "start": "804700",
    "end": "810160"
  },
  {
    "text": "task to make it so that it's harder hopefully for the attacker to get in next time what's the latest evidence of",
    "start": "810160",
    "end": "815529"
  },
  {
    "text": "activity so we want to know the when the attacker got in we also want to know is the attacker currently in the",
    "start": "815529",
    "end": "820660"
  },
  {
    "text": "environment right now and if so what is he doing sometimes it the attacker will",
    "start": "820660",
    "end": "826060"
  },
  {
    "text": "be actively coming back daily stealing information or doing what whatever they've come to do in some cases the",
    "start": "826060",
    "end": "832930"
  },
  {
    "text": "attacker will have systems compromised and infected in the environment so that he can come back when he wants but he's",
    "start": "832930",
    "end": "838270"
  },
  {
    "text": "not actually doing anything so you want to know that too what's what's the attacker doing what systems are under",
    "start": "838270",
    "end": "843430"
  },
  {
    "text": "the attackers control so you want to know what the attacker touched which is what i would call compromised and you also want to know if his system is",
    "start": "843430",
    "end": "850000"
  },
  {
    "text": "infected with malware because that's something that if the attacker has a back door on a system or has configured",
    "start": "850000",
    "end": "855279"
  },
  {
    "text": "some sort of condition that is a backdoor like the sticky keys back door",
    "start": "855279",
    "end": "860400"
  },
  {
    "text": "configuration you want to know that so that you can clean all that up and make sure that the attacker cannot get back",
    "start": "860400",
    "end": "865690"
  },
  {
    "text": "into your environment that's containment you want no assistance the attacker accessed you know might not be as",
    "start": "865690",
    "end": "871270"
  },
  {
    "text": "exciting if you really love malware and finding malware but if you want to find data theft and you want to know what the attacker stole you need to look for what",
    "start": "871270",
    "end": "877960"
  },
  {
    "text": "systems that the attacker access and what did he do so what did the attacker do on these systems that that he that he",
    "start": "877960",
    "end": "883480"
  },
  {
    "text": "targeted so did the attacker simply connect to a system and do a directory listing did the attacker browse through",
    "start": "883480",
    "end": "890290"
  },
  {
    "text": "certain directories if so which ones maybe you can tell what type of data they were after how did the attacker",
    "start": "890290",
    "end": "896500"
  },
  {
    "text": "maintain access to the environment so persistence do they have back doors that are running do they have access to your",
    "start": "896500",
    "end": "902530"
  },
  {
    "text": "VPN by the way if you don't have two factor authentication for your VPN you should write that down as a note and go",
    "start": "902530",
    "end": "907690"
  },
  {
    "text": "do that this week because that's uh that's a way that attackers will also maintain access how's the attacker",
    "start": "907690",
    "end": "913660"
  },
  {
    "text": "operating inside the environment so the lateral movement this is really this is going to help you investigate and",
    "start": "913660",
    "end": "920050"
  },
  {
    "text": "determine systems that he's access that might not be obvious because they might not contain mental what tools is the",
    "start": "920050",
    "end": "926380"
  },
  {
    "text": "attacker deployed you want to be able to identify those tools and what they do and then also what accounts to the",
    "start": "926380",
    "end": "931600"
  },
  {
    "text": "attacker compromise does the attacker is going to be generally anybody but the least",
    "start": "931600",
    "end": "937060"
  },
  {
    "text": "sophisticated target attacker is going to grab some accounts and then use those inside your network and it's going to look normal so this is not magic in",
    "start": "937060",
    "end": "946090"
  },
  {
    "start": "942000",
    "end": "962000"
  },
  {
    "text": "order to answer all these questions that I've outlined you need data points and so for the rest of this talk I'm going",
    "start": "946090",
    "end": "952630"
  },
  {
    "text": "to go through some specific examples of the types of data points you need and and why you need them so mapping an IP",
    "start": "952630",
    "end": "963970"
  },
  {
    "text": "address to a hostname this is a an",
    "start": "963970",
    "end": "969040"
  },
  {
    "text": "excerpt that's been sanitized from a report from a third party to one of my clients and investigate the beginning of",
    "start": "969040",
    "end": "974890"
  },
  {
    "text": "an investigation and so they said that on this particular date the attacker",
    "start": "974890",
    "end": "980310"
  },
  {
    "text": "command and control right here was used to control this system here which is in your network 17 to 19 to 43 23 and they",
    "start": "980310",
    "end": "989380"
  },
  {
    "text": "said that ok he accessed the back door so there was a back door on this system and there's a list of data here's what",
    "start": "989380",
    "end": "996280"
  },
  {
    "text": "he did and by the way while he on this day he accessed these three other systems from this pivot point so system",
    "start": "996280",
    "end": "1002700"
  },
  {
    "text": "1 IP addresses and to IP address and then unknown you don't know what the I what the system name is so you",
    "start": "1002700",
    "end": "1008520"
  },
  {
    "text": "definitely want to take a look at what he may have done on these systems because he can stole data he could have",
    "start": "1008520",
    "end": "1013820"
  },
  {
    "text": "maybe stolen credentials to come back later he might have stolen a certificate",
    "start": "1013820",
    "end": "1020100"
  },
  {
    "text": "he might have actually put another back door on a system that you might not know about so essentially this is what what",
    "start": "1020100",
    "end": "1026790"
  },
  {
    "text": "you're really worried about here so this random so the host thing that you know about this is the one that was listed in",
    "start": "1026790",
    "end": "1032010"
  },
  {
    "text": "there and the report this guy over here who you don't know yet because you haven't been able to find that host name",
    "start": "1032010",
    "end": "1037680"
  },
  {
    "text": "it's a backdoor data theft what did he do so dhcp logs in the majority of",
    "start": "1037680",
    "end": "1043770"
  },
  {
    "start": "1040000",
    "end": "1263000"
  },
  {
    "text": "environments vast majority dhcp services are provided by domain controllers that are that are local and in the",
    "start": "1043770",
    "end": "1050670"
  },
  {
    "text": "environment where the where your endpoints are in data centers mainly",
    "start": "1050670",
    "end": "1055860"
  },
  {
    "text": "we're talking about workstations in laptops here because servers generally have IPS adult don't change too much",
    "start": "1055860",
    "end": "1060870"
  },
  {
    "text": "although you still want the DHCP logs for anywhere that really see dhcp this",
    "start": "1060870",
    "end": "1066120"
  },
  {
    "text": "is showing in the in the control panels in the dhcp control panel",
    "start": "1066120",
    "end": "1071190"
  },
  {
    "text": "where you can enable logging so it really is literally hear something where you can just check the box windows will start recording the log and storing it",
    "start": "1071190",
    "end": "1077610"
  },
  {
    "text": "locally and this is basically what you get so what you can get here is that on",
    "start": "1077610",
    "end": "1083070"
  },
  {
    "text": "to 2114 this IP address 7820 was assigned to the system with host name",
    "start": "1083070",
    "end": "1089820"
  },
  {
    "text": "win2k eight number one and then it's got the mac address which can sometimes be useful so this is the type of",
    "start": "1089820",
    "end": "1096600"
  },
  {
    "text": "information that you're going to get it is a a challenged it's in order to do",
    "start": "1096600",
    "end": "1102750"
  },
  {
    "text": "something with it you want to make sure that even if you don't have a sim so ideally you would have sim collectors",
    "start": "1102750",
    "end": "1108450"
  },
  {
    "text": "everywhere you have dhcp security an event management tool and you would be pulling those logs somewhere where you",
    "start": "1108450",
    "end": "1114630"
  },
  {
    "text": "can execute a quick query and just type in the IP address filter by the date and it'll just show you those events but you",
    "start": "1114630",
    "end": "1121080"
  },
  {
    "text": "want to make sure that your but you're logging it even if you don't have a sim because even if you don't have a sim you",
    "start": "1121080",
    "end": "1126330"
  },
  {
    "text": "can still go to that dhcp server when you're doing an investigation and query",
    "start": "1126330",
    "end": "1131519"
  },
  {
    "text": "those logs but only if you've been generating them so it's really important to start generating those in capturing them another way that you can do this so",
    "start": "1131519",
    "end": "1139409"
  },
  {
    "text": "say you don't have a sim you could even create something simple like a scheduled task to push the log files to a central",
    "start": "1139409",
    "end": "1145830"
  },
  {
    "text": "repository so it's not very pretty to do this especially in a big organization but I have seen it done investigation",
    "start": "1145830",
    "end": "1152100"
  },
  {
    "text": "that I did last year they didn't have this capability which we tried to put it in place and the best they could do is",
    "start": "1152100",
    "end": "1157620"
  },
  {
    "text": "to basically ship these logs to a file share and so I got a workstation on",
    "start": "1157620",
    "end": "1162990"
  },
  {
    "text": "their network that I had access to and I ran power grab against those logs whenever I needed to look up something",
    "start": "1162990",
    "end": "1168809"
  },
  {
    "text": "with DHCP another large global organization I work with a couple years ago actually they had one of the",
    "start": "1168809",
    "end": "1175620"
  },
  {
    "text": "contractors that work for the security team come in and did basically built something based on an map that was",
    "start": "1175620",
    "end": "1180779"
  },
  {
    "text": "Victor would scan the network with nmap looking for retrieving the binding between the host names and I peed and",
    "start": "1180779",
    "end": "1186720"
  },
  {
    "text": "pushing it into a my sequel database he whipped this up and you know less than a day it was crude but it did get the job",
    "start": "1186720",
    "end": "1192299"
  },
  {
    "text": "done another thing that a lot of organizations rely on here is control",
    "start": "1192299",
    "end": "1197340"
  },
  {
    "text": "panels for things like your antivirus or your your system management agents will typically provide you some kind of",
    "start": "1197340",
    "end": "1203430"
  },
  {
    "text": "mapping historically of which system checked in at a given time and through that you can determine what hostname had",
    "start": "1203430",
    "end": "1209580"
  },
  {
    "text": "which IP that's not as good as having the dhcp logs because that's only going to cover systems that are that have",
    "start": "1209580",
    "end": "1217320"
  },
  {
    "text": "those agents on them so if there was a system you know non basically non window",
    "start": "1217320",
    "end": "1222600"
  },
  {
    "text": "non-windows are non domain number system or contractor laptop or something it didn't have your agent then you won't be",
    "start": "1222600",
    "end": "1227610"
  },
  {
    "text": "able to query it so very important I put this as the nut is number one and these",
    "start": "1227610",
    "end": "1232980"
  },
  {
    "text": "aren't generally in order but I find that if you if you're not able to map of the system name to an IP address a lot",
    "start": "1232980",
    "end": "1241230"
  },
  {
    "text": "of the other things I'm going to talk about can't you can end up with with dead ends where say you you you're",
    "start": "1241230",
    "end": "1247440"
  },
  {
    "text": "logging packets destinations and a firewall at the firewall so your login",
    "start": "1247440",
    "end": "1253530"
  },
  {
    "text": "connections to c 2 and you get a hit and you got an IP address from this say three months ago but if you don't know",
    "start": "1253530",
    "end": "1259740"
  },
  {
    "text": "what host name it is then that's information is not the way that useful so this this is going to foundational okay so moving on the second capability",
    "start": "1259740",
    "end": "1268260"
  },
  {
    "start": "1263000",
    "end": "1308000"
  },
  {
    "text": "that I wanted to highlight is systems you want to find out which system is a",
    "start": "1268260",
    "end": "1273540"
  },
  {
    "text": "particular account authenticated to so this is an excerpt that i sanitized from on the top of a tree house report so",
    "start": "1273540",
    "end": "1279270"
  },
  {
    "text": "call this hostname pivot system and the part i wanted to highlight is first",
    "start": "1279270",
    "end": "1287280"
  },
  {
    "text": "thing that happened was so this domain / service account logged on from system",
    "start": "1287280",
    "end": "1293090"
  },
  {
    "text": "from system a and then logged in to",
    "start": "1293090",
    "end": "1300900"
  },
  {
    "text": "other systems so bottom line is you know that the the attackers demonstrated that he's been using this account in this in",
    "start": "1300900",
    "end": "1306330"
  },
  {
    "text": "this time in this time period so from the from the pivot system you know that",
    "start": "1306330",
    "end": "1312150"
  },
  {
    "start": "1308000",
    "end": "1317000"
  },
  {
    "text": "the attackers logged into some other systems through the system analysis that you that you've done and the reason this",
    "start": "1312150",
    "end": "1318840"
  },
  {
    "start": "1317000",
    "end": "1401000"
  },
  {
    "text": "is important is also i said earlier all but the most simplistic targeted attackers are going to use legitimate",
    "start": "1318840",
    "end": "1326610"
  },
  {
    "text": "credentials as part of an intrusion so this on the screen here is a model that I used to explain the life cycle of a",
    "start": "1326610",
    "end": "1334170"
  },
  {
    "text": "targeted intrusion the idea is that not every intrusions going to have all these these phases but",
    "start": "1334170",
    "end": "1339690"
  },
  {
    "text": "essentially there is an initial compromise that's preceded by some reconnaissance the attacker gains a",
    "start": "1339690",
    "end": "1346679"
  },
  {
    "text": "foothold so that's the first system if you picture a phishing attack that starts with fishing that's that very first system that he manages to",
    "start": "1346679",
    "end": "1352440"
  },
  {
    "text": "compromise from there the attacker will escalate their privileges obtain",
    "start": "1352440",
    "end": "1358610"
  },
  {
    "text": "credentials for that first system that they popped and then use those two poor",
    "start": "1358610",
    "end": "1364740"
  },
  {
    "text": "form reconnaissance and move around the network ultimately looking for usually some sort of data that they're looking to steal so this is important to know",
    "start": "1364740",
    "end": "1371460"
  },
  {
    "text": "the reason that I put this in here is that because if tackers are moving around with legitimate credentials",
    "start": "1371460",
    "end": "1377580"
  },
  {
    "text": "having the capability to query your event logs are very important to be able to track this kind of activity this is",
    "start": "1377580",
    "end": "1384149"
  },
  {
    "text": "an area where I see a lot of weakness out there even companies that have security and event management tools most",
    "start": "1384149",
    "end": "1389820"
  },
  {
    "text": "of them are don't really have them what i would call fully deployed even in the server population so it may have domain",
    "start": "1389820",
    "end": "1395429"
  },
  {
    "text": "controller logs but they don't have a lot of other logs to especially from from servers that can help this so given",
    "start": "1395429",
    "end": "1404309"
  },
  {
    "text": "this information so um and you know that the attackers been using the service account so that's the key piece of",
    "start": "1404309",
    "end": "1409649"
  },
  {
    "start": "1409000",
    "end": "1636000"
  },
  {
    "text": "information here's what could be happening here's one possible explanation that you need you need these logs in order to kind of fair it out",
    "start": "1409649",
    "end": "1416629"
  },
  {
    "text": "what's going on so it could be that there's a laptop that's been compromised and so this user had fished with",
    "start": "1416629",
    "end": "1424169"
  },
  {
    "text": "whatever the latest maybe this latest uh word doc whole durability and there his",
    "start": "1424169",
    "end": "1431009"
  },
  {
    "text": "system is communicating with this particular sheet to sheet over and I'm going to make a leap here and say so",
    "start": "1431009",
    "end": "1436559"
  },
  {
    "text": "this is something that we see sometimes in the various investigations that we do",
    "start": "1436559",
    "end": "1442019"
  },
  {
    "text": "so the attacker is operating through this system so if you can picture the back door on the system has proxy",
    "start": "1442019",
    "end": "1449159"
  },
  {
    "text": "functionality that's like a socks proxy so rather than rather than doing a lot",
    "start": "1449159",
    "end": "1454529"
  },
  {
    "text": "of dirty work on this laptop because this is the one that's infected so you're kind of like you know you may find that one or somebody may find it",
    "start": "1454529",
    "end": "1460590"
  },
  {
    "text": "and tell you about it the attacker is going to be sneaky and not use that so he's going to just proxy through he's",
    "start": "1460590",
    "end": "1465840"
  },
  {
    "text": "going to rdp to some other random system so call it call it a pivot system some",
    "start": "1465840",
    "end": "1472720"
  },
  {
    "text": "of the things that the attacker may be doing with that account that a domain service account is they may be maybe",
    "start": "1472720",
    "end": "1478030"
  },
  {
    "text": "he's connected to an application server and installed some kind of unknown back door so you know net use copy some files",
    "start": "1478030",
    "end": "1486130"
  },
  {
    "text": "up schedule a task of the at command because he's got credentials maybe they're not even a domain happen maybe",
    "start": "1486130",
    "end": "1491380"
  },
  {
    "text": "just has a server some server admin credentials maybe he compromised somebody in IT and has some kind of low level admin but he's able to access the",
    "start": "1491380",
    "end": "1497710"
  },
  {
    "text": "server so maybe he's going to run a put a backdoor on there and maybe it's a backdoor that you don't currently know",
    "start": "1497710",
    "end": "1502870"
  },
  {
    "text": "about but if you follow the trail you know that the attacker is using this account the service account and so what",
    "start": "1502870",
    "end": "1508570"
  },
  {
    "text": "you should do is look for all of the places within that time window so you know the attacker was active on those",
    "start": "1508570",
    "end": "1514090"
  },
  {
    "text": "dates that I mentioned you would want to start looking in at the logs to try and find out what else did was that account",
    "start": "1514090",
    "end": "1520960"
  },
  {
    "text": "used for so some of those things are probably going to be legitimate and it's going to take some work working with whoever uses that account to try and",
    "start": "1520960",
    "end": "1528100"
  },
  {
    "text": "figure out what's legitimate and what's not but some of its going to set off alarms you know and you probably won't know this is the investigator because",
    "start": "1528100",
    "end": "1534880"
  },
  {
    "text": "it's not what you do but when you sit down with the application admin and show them a list of accounts and say or the",
    "start": "1534880",
    "end": "1540460"
  },
  {
    "text": "list of systems it authenticated to they're going to say wait a minute wait a minute this this system is in you know",
    "start": "1540460",
    "end": "1545500"
  },
  {
    "text": "the other division there's no reason that this account would ever authenticate there that's a red flag",
    "start": "1545500",
    "end": "1550600"
  },
  {
    "text": "then you want to go look at that system the other thing that you could that you're looking for is maybe the attacker",
    "start": "1550600",
    "end": "1556480"
  },
  {
    "text": "logged into this file server from the pivot system and maybe he copied some files and maybe that was actually what",
    "start": "1556480",
    "end": "1562210"
  },
  {
    "text": "he ftp doubt of the environment so maybe he stole data and if you don't do this exercise then you'll miss that the other",
    "start": "1562210",
    "end": "1569320"
  },
  {
    "text": "thing he may be he already peed into this database and then dumped some data out of database tables and then shipped",
    "start": "1569320",
    "end": "1575770"
  },
  {
    "text": "that off so you know about this stuff down here that's in the lower right corner so you know that he was PS exec",
    "start": "1575770",
    "end": "1581170"
  },
  {
    "text": "to system a system p and system C but this all this up here you don't know",
    "start": "1581170",
    "end": "1587410"
  },
  {
    "text": "about so you want to be able to to search for a couple of different things so you want to be able to take the",
    "start": "1587410",
    "end": "1593910"
  },
  {
    "text": "domain / service account and you want to be able to look for where did that",
    "start": "1593910",
    "end": "1600370"
  },
  {
    "text": "account login on the source of this pivot system the",
    "start": "1600370",
    "end": "1605440"
  },
  {
    "text": "other thing that would be useful is if you could look for all right you know that the attacker was on the pivot system so you know he was on the pivot",
    "start": "1605440",
    "end": "1612430"
  },
  {
    "text": "system on a particular day because you've got these artifacts that show you he was active on the system say he was acting on the system on Sunday so you",
    "start": "1612430",
    "end": "1619420"
  },
  {
    "text": "want to look for on Sunday around the time the attacker was on the system savings on the system from eight you know eight o'clock to ten o'clock you",
    "start": "1619420",
    "end": "1626800"
  },
  {
    "text": "want to look and see where did that where who what authentic what etiquette what network connections originated from",
    "start": "1626800",
    "end": "1633400"
  },
  {
    "text": "that system at all with any account so maybe another counties using so one of",
    "start": "1633400",
    "end": "1639310"
  },
  {
    "start": "1636000",
    "end": "1778000"
  },
  {
    "text": "the ways that you can do this is to look for logs on the domain controllers for",
    "start": "1639310",
    "end": "1644350"
  },
  {
    "text": "kerberos service tickets I don't have time to go into all the specifics of Kerberos which is one of the",
    "start": "1644350",
    "end": "1649720"
  },
  {
    "text": "underpinnings of Active Directory authentication if you don't so ideally you would have logs set into a sim from",
    "start": "1649720",
    "end": "1656800"
  },
  {
    "text": "all these servers so you'll be able to just run the query and it would run all the data but in most environments where I investigate they usually have log some",
    "start": "1656800",
    "end": "1665620"
  },
  {
    "text": "logs from domain controllers but they don't have all the server's log yet it's always on the plan we're going to do it sometime they still haven't done that",
    "start": "1665620",
    "end": "1671050"
  },
  {
    "text": "but with these Kerberos serves tickets when a user or really an account request",
    "start": "1671050",
    "end": "1679330"
  },
  {
    "text": "access to a resource there's this exchange with the domain controller where they're issued a service ticket",
    "start": "1679330",
    "end": "1685120"
  },
  {
    "text": "that says okay yes you're you know I'm going to you're allowed to access this resource so here's what you can do with",
    "start": "1685120",
    "end": "1691150"
  },
  {
    "text": "it so this is from my test environment so I have this this scenario down here which is I have win2k3 member one which",
    "start": "1691150",
    "end": "1698320"
  },
  {
    "text": "is not 20 and I wouldn't to kmm when to get three member to which is not 21 so i",
    "start": "1698320",
    "end": "1704380"
  },
  {
    "text": "did a net net used command it is mapped a file share from one to the other this is what you get and this is a windows",
    "start": "1704380",
    "end": "1711700"
  },
  {
    "text": "2003 so what you get is you get two important things have pieces in for one",
    "start": "1711700",
    "end": "1716860"
  },
  {
    "text": "of three important pieces username users ears are one you get service name which",
    "start": "1716860",
    "end": "1722380"
  },
  {
    "text": "is basically where they logged in to so that the target of the that's an occasion when you get three member two",
    "start": "1722380",
    "end": "1727810"
  },
  {
    "text": "and then you get the client address which is where they were and so where the was the user when they authenticated",
    "start": "1727810",
    "end": "1734230"
  },
  {
    "text": "when this ticket was and the user was sitting right here so I've used this on investigations before",
    "start": "1734230",
    "end": "1739950"
  },
  {
    "text": "to to identify additional systems we should look at so what would happen if",
    "start": "1739950",
    "end": "1745320"
  },
  {
    "text": "your back on this diagram is you'd probably get maybe you get 20 or 30 systems that where this account was used",
    "start": "1745320",
    "end": "1751409"
  },
  {
    "text": "and you're gonna have to just talk to somebody and figure out okay these are the five systems that it always logs",
    "start": "1751409",
    "end": "1756629"
  },
  {
    "text": "into and it logs in you know every five minutes automatically so those are what those ones are okay but then the other ones you you may need to do some manual",
    "start": "1756629",
    "end": "1763440"
  },
  {
    "text": "triage and look from a timeline perspective say okay I know that the",
    "start": "1763440",
    "end": "1768509"
  },
  {
    "text": "this account logged at this time did anything else we are happening oh yes there was a scheduled task that was created right you know five seconds",
    "start": "1768509",
    "end": "1774240"
  },
  {
    "text": "after that that's weird and so you want to go to that process to identify these things this is an example from a",
    "start": "1774240",
    "end": "1782210"
  },
  {
    "start": "1778000",
    "end": "1810000"
  },
  {
    "text": "commercial sim product that i did recently where i am sorry i had to",
    "start": "1782210",
    "end": "1787409"
  },
  {
    "text": "redact so much here but basically the I did payload contains host name so i had",
    "start": "1787409",
    "end": "1792690"
  },
  {
    "text": "a pivot system that i was looking for I've been tidy 673 which is Kerber service ticket issued and then a date",
    "start": "1792690",
    "end": "1799799"
  },
  {
    "text": "range and then payload contains account name I was looking for events in a",
    "start": "1799799",
    "end": "1804809"
  },
  {
    "text": "certain time and a certain rain a timeframe from a certain system using a certain account I do need to point out",
    "start": "1804809",
    "end": "1812100"
  },
  {
    "start": "1810000",
    "end": "1853000"
  },
  {
    "text": "that in windows 2003 rdp authentications work a bit differently in 2008 you'll",
    "start": "1812100",
    "end": "1818490"
  },
  {
    "text": "get the correct source address in windows 2003 you'll not because the",
    "start": "1818490",
    "end": "1823980"
  },
  {
    "text": "service tickets actually issued at with dot 21 as the client which is I'm already peeing from member 12 number two",
    "start": "1823980",
    "end": "1830580"
  },
  {
    "text": "and then the event that's recorded is basically showing that the IP address",
    "start": "1830580",
    "end": "1836929"
  },
  {
    "text": "source was number two which is not really that helpful so to keep that in mind if you're if you're looking at the",
    "start": "1836929",
    "end": "1842519"
  },
  {
    "text": "Career Service tickets with Windows 2008 with an LA enabled I've got a link that talks about what that is it's correct",
    "start": "1842519",
    "end": "1849840"
  },
  {
    "text": "because the authentication mechanism is a bit different in that version so key",
    "start": "1849840",
    "end": "1855929"
  },
  {
    "start": "1853000",
    "end": "1920000"
  },
  {
    "text": "things you want to let make sure you're logging all authentication events and you want to log successful ones I talked",
    "start": "1855929",
    "end": "1861450"
  },
  {
    "text": "to an organization a couple weeks ago that was a lot of different logging that",
    "start": "1861450",
    "end": "1866879"
  },
  {
    "text": "they were doing but they're only logging failed authentication events which really are the less interesting ones in my view for",
    "start": "1866879",
    "end": "1873149"
  },
  {
    "text": "most of my purposes you want to make sure that even if you don't have a sim that you're still logging them and you",
    "start": "1873149",
    "end": "1878940"
  },
  {
    "text": "still have a sufficient amount of events on the system the reason is even if you don't have a sim you can take other",
    "start": "1878940",
    "end": "1886049"
  },
  {
    "text": "measures at the time that you need that info to go out and grab it I'll talk about some of those later so ideally",
    "start": "1886049",
    "end": "1892200"
  },
  {
    "text": "push these into a sim or if you don't",
    "start": "1892200",
    "end": "1897960"
  },
  {
    "text": "have that that capability you can push these logs to a central location for searching that gets very that doesn't",
    "start": "1897960",
    "end": "1905669"
  },
  {
    "text": "scale very well you can do it in an emergency and I've done it before with what i would say smaller environments",
    "start": "1905669",
    "end": "1911850"
  },
  {
    "text": "like maybe under 5,000 systems otherwise the amount of data it just gets too big",
    "start": "1911850",
    "end": "1916980"
  },
  {
    "text": "and that's when you should just buy bison this is this is a diagram from a",
    "start": "1916980",
    "end": "1923159"
  },
  {
    "text": "status updates that I but I do as part of my my weekly updates to my clients know what I wanted to do is illustrate",
    "start": "1923159",
    "end": "1928980"
  },
  {
    "text": "so there's a couple of lines here the two that I want to hop to highlight our so this compromised system line which is",
    "start": "1928980",
    "end": "1935610"
  },
  {
    "text": "a purple it's going up slowly so this this blue line that goes up and then down is basically the to be determined",
    "start": "1935610",
    "end": "1942419"
  },
  {
    "text": "systems which are the ones that are on our cue to look at so as the investigation starts up we're finding",
    "start": "1942419",
    "end": "1947730"
  },
  {
    "text": "more and more more and more things more more potentially compromised systems etc of doing more of you so that Peaks",
    "start": "1947730",
    "end": "1953639"
  },
  {
    "text": "putting a lot of things on the queue doing it we're getting it down but then right here with this compromised system",
    "start": "1953639",
    "end": "1960210"
  },
  {
    "text": "speaks I basically was that query there was a pivot system we knew the attacker is active and I use kerberos service",
    "start": "1960210",
    "end": "1966600"
  },
  {
    "text": "tickets to identify you know a couple hundred systems that the attacker accessed and basically we determined",
    "start": "1966600",
    "end": "1974129"
  },
  {
    "text": "they were dumping hashes from those systems but it was good to know although ultimately it was helpful helpful",
    "start": "1974129",
    "end": "1979559"
  },
  {
    "text": "information but not you know not critical we put we could have I'd also identified a backdoor that we didn't",
    "start": "1979559",
    "end": "1985440"
  },
  {
    "text": "know about previously I don't spend too much time on this said this is in the in",
    "start": "1985440",
    "end": "1990720"
  },
  {
    "start": "1986000",
    "end": "2150000"
  },
  {
    "text": "the slides on the CD as well as in the white paper some suggestions of things that you might want to log if you",
    "start": "1990720",
    "end": "1996929"
  },
  {
    "text": "compare this to some of the other guy lines are out there your notice that there are some differences of some of the some of the events that are",
    "start": "1996929",
    "end": "2002570"
  },
  {
    "text": "only recommend that I don't find much use of investigative Lee and they tend to be occur really frequently so I don't",
    "start": "2002570",
    "end": "2009289"
  },
  {
    "text": "recommend those but these ones are important so anything related to account",
    "start": "2009289",
    "end": "2014659"
  },
  {
    "text": "logons or log on so you want to capture that success and failed and then there's some additional events that relate to",
    "start": "2014659",
    "end": "2020440"
  },
  {
    "text": "like reconnections to rdp sessions that are interesting as well as log onto the",
    "start": "2020440",
    "end": "2026179"
  },
  {
    "text": "log-off's oh and explicit credentials can be really interesting as well so",
    "start": "2026179",
    "end": "2032720"
  },
  {
    "text": "next determining the systems that communicated to a specific IP address",
    "start": "2032720",
    "end": "2039889"
  },
  {
    "text": "whoops so three pieces of information on here that are important our attacker see",
    "start": "2039889",
    "end": "2045649"
  },
  {
    "text": "to node was one two three four five six seven eight and then blah blah blah on",
    "start": "2045649",
    "end": "2051740"
  },
  {
    "text": "this day the attacker reconfigured this other back door so this back door was",
    "start": "2051740",
    "end": "2057618"
  },
  {
    "text": "originally communicating with this address and he configured to communicate with this new address so three pieces of",
    "start": "2057619",
    "end": "2063888"
  },
  {
    "text": "information so with this information what you want to do is so you have some",
    "start": "2063889",
    "end": "2068898"
  },
  {
    "text": "set one system that's it's infected you already know it's infected because you knew that already but there's another",
    "start": "2068899",
    "end": "2074960"
  },
  {
    "text": "one that is also connecting that same command control that you didn't know about so this is helpful if you can",
    "start": "2074960",
    "end": "2080179"
  },
  {
    "text": "query netflow if you can query if you can log firewall logs packet accepts",
    "start": "2080179",
    "end": "2086118"
  },
  {
    "text": "going out if if you have it basically anything that will let you query crews",
    "start": "2086119",
    "end": "2092329"
  },
  {
    "text": "gone to this IP address web proxies as well but this will also help you find another system so this system is known",
    "start": "2092329",
    "end": "2100579"
  },
  {
    "text": "to be infected it this is that system that had it the backdoor change to another IP so it's going to see tuned to",
    "start": "2100579",
    "end": "2108079"
  },
  {
    "text": "see to number two which you know about but what if i told you next that that information was two months old so the",
    "start": "2108079",
    "end": "2115339"
  },
  {
    "text": "attacker two months ago this backdoor was pointing to the sea to hear number 3",
    "start": "2115339",
    "end": "2121750"
  },
  {
    "text": "but it so two months ago is configured",
    "start": "2121750",
    "end": "2126950"
  },
  {
    "text": "here today it's pointy it's it's it's pointing to a different one but maybe",
    "start": "2126950",
    "end": "2132290"
  },
  {
    "text": "there's an additional system here that you don't know about that was communicated with is currently communicating with",
    "start": "2132290",
    "end": "2139220"
  },
  {
    "text": "this command and control and you just got that IP from historical information so my point is you want to be able to",
    "start": "2139220",
    "end": "2144920"
  },
  {
    "text": "also leverage information back in time to look for systems that you may have otherwise missed so for this so I",
    "start": "2144920",
    "end": "2153530"
  },
  {
    "start": "2150000",
    "end": "2287000"
  },
  {
    "text": "mentioned net float most organizations that I work with at least have log logging for firewall the border",
    "start": "2153530",
    "end": "2161870"
  },
  {
    "text": "firewalls logging successful packets going out of the network that's very helpful I would keep as much of that as",
    "start": "2161870",
    "end": "2166910"
  },
  {
    "text": "you can if you if you get to where traffic is a storage becomes an issue",
    "start": "2166910",
    "end": "2175700"
  },
  {
    "text": "you can start applying some filters like you don't necessarily need to know every time somebody goes to your corporate",
    "start": "2175700",
    "end": "2181940"
  },
  {
    "text": "website or one of your top business partners websites or Yahoo or Google or whatever you can filter some of that out",
    "start": "2181940",
    "end": "2188390"
  },
  {
    "text": "if you do that I would avoid don't filter out ranges that are associated with hosting services like you wouldn't",
    "start": "2188390",
    "end": "2193730"
  },
  {
    "text": "to filter out all of Amazon space because there's any of though any of those hosting providers where you can",
    "start": "2193730",
    "end": "2199790"
  },
  {
    "text": "you can easily set up shop and then attacker may use for see to make sure",
    "start": "2199790",
    "end": "2205910"
  },
  {
    "text": "that you test that you can actually use this data before you have to communicate before you get in a situation where you",
    "start": "2205910",
    "end": "2211820"
  },
  {
    "text": "have to use it and then also further ensure that you have dhcp so that you",
    "start": "2211820",
    "end": "2217490"
  },
  {
    "text": "have dhcp logs so that if you get a hit say from two months ago you go back in time and you say wow i didn't know this",
    "start": "2217490",
    "end": "2224030"
  },
  {
    "text": "was a command and control address but I'm querying my logs and I noticed that two months ago I had a system that was",
    "start": "2224030",
    "end": "2229310"
  },
  {
    "text": "going to that address but it stopped you still need to look at that system because it may have been infected and maybe now it's the attacker uninstalled",
    "start": "2229310",
    "end": "2236540"
  },
  {
    "text": "the back door but it may still you made still need to rebuild that system because the back door may be on there",
    "start": "2236540",
    "end": "2241600"
  },
  {
    "text": "and finally you can use this to implement an alerting capability so if",
    "start": "2241600",
    "end": "2246710"
  },
  {
    "text": "you have an attacker that's active in the environment even if you don't have a lot of other sophisticated tools one of the things that all my clients that",
    "start": "2246710",
    "end": "2252530"
  },
  {
    "text": "recently was they implemented an alerting capability where the attacker was not active they knew what the sea to",
    "start": "2252530",
    "end": "2258380"
  },
  {
    "text": "the sea to IP addresses were and they knew that the data size was always between you know 80 and 105 bites",
    "start": "2258380",
    "end": "2265600"
  },
  {
    "text": "without fail so they basically implemented alert that said anytime this packet size is above one five send me a text message and I it",
    "start": "2265600",
    "end": "2273260"
  },
  {
    "text": "worked there there was a time where there was some activity where the attacker came back if I came back I basically mean use the command and",
    "start": "2273260",
    "end": "2279800"
  },
  {
    "text": "control infrastructure to actually take control of that system that the back door was on and it was an effective",
    "start": "2279800",
    "end": "2285890"
  },
  {
    "text": "capability next tracking domain name resolution attempts so this is an",
    "start": "2285890",
    "end": "2293089"
  },
  {
    "start": "2287000",
    "end": "2329000"
  },
  {
    "text": "excerpt screenshot that I i sanitized out of one of the tools that we use internally and investigations in our",
    "start": "2293089",
    "end": "2299480"
  },
  {
    "text": "managed service clients attract network network traffic so it's basically showing a successful dns resolution",
    "start": "2299480",
    "end": "2306160"
  },
  {
    "text": "response so we actually don't track the queries retract what when the when the response comes back we're looking for",
    "start": "2306160",
    "end": "2311630"
  },
  {
    "text": "that response and so bottom line is a particular system so this requesting dns",
    "start": "2311630",
    "end": "2318320"
  },
  {
    "text": "server eight seven six five four three two one requested and successfully resolved really bad netcom and this was",
    "start": "2318320",
    "end": "2326630"
  },
  {
    "text": "the authoritative dns server that's not really that important so here's one case",
    "start": "2326630",
    "end": "2332030"
  },
  {
    "start": "2329000",
    "end": "2404000"
  },
  {
    "text": "if this is the way your dns works in your organization then you're lucky because this is the simple case so",
    "start": "2332030",
    "end": "2337400"
  },
  {
    "text": "infected system queried their dns server which relayed the query out to the",
    "start": "2337400",
    "end": "2342740"
  },
  {
    "text": "internet went through its recursion if necessary and then came back so what you",
    "start": "2342740",
    "end": "2347810"
  },
  {
    "text": "have when you get that alert or you get an alert from maybe maybe the government",
    "start": "2347810",
    "end": "2353510"
  },
  {
    "text": "in the case of a notification they take hey this is really bad calm is bad you",
    "start": "2353510",
    "end": "2358609"
  },
  {
    "text": "need to look for all systems going to that and so i'll continue hopefully",
    "start": "2358609",
    "end": "2366470"
  },
  {
    "text": "while we fix that don't know what's going on excuse me oh there you go could",
    "start": "2366470",
    "end": "2372500"
  },
  {
    "text": "i get some help here the screen seems to have gone off the screens yeah i'll just",
    "start": "2372500",
    "end": "2380060"
  },
  {
    "text": "keep talking so they're basically the system is infected it's going out through one dns server so you want to",
    "start": "2380060",
    "end": "2386359"
  },
  {
    "text": "have logs on that one dns server in order to I low-tech oops my bad",
    "start": "2386359",
    "end": "2399430"
  },
  {
    "start": "2404000",
    "end": "2545000"
  },
  {
    "text": "backing away so basically you wanna have logs on this system because if you want",
    "start": "2405729",
    "end": "2412670"
  },
  {
    "text": "to have you want to be logging DNS because you need to know who queried that so my network monitor that I pointed out was sitting right here so we",
    "start": "2412670",
    "end": "2419450"
  },
  {
    "text": "know that someone in the organization resolve this bad domain name but we don't know who in order to figure out who you need to have a log that",
    "start": "2419450",
    "end": "2425989"
  },
  {
    "text": "associates the client that made the query it one commonly looks like this which means that any in a big global",
    "start": "2425989",
    "end": "2432799"
  },
  {
    "text": "company you're probably pointing to your local domain controller for DNS which makes sense and then they're probably",
    "start": "2432799",
    "end": "2438170"
  },
  {
    "text": "pointed to some regional which is pointed to something which is some fun you get to the edge what you want to",
    "start": "2438170",
    "end": "2443299"
  },
  {
    "text": "make sure is that on the systems where your endpoints are resolving dns those are where you want your logs to be and",
    "start": "2443299",
    "end": "2448609"
  },
  {
    "text": "pull those into a sim because if somebody's clearing a domain name and",
    "start": "2448609",
    "end": "2453680"
  },
  {
    "text": "you may be looking for that it's your perimeter you want to be able to follow up quickly and determine who because that system is if it's something like",
    "start": "2453680",
    "end": "2459890"
  },
  {
    "text": "this where it's a domain name that's definitively associated with malware that it's not a common domain it's",
    "start": "2459890",
    "end": "2465559"
  },
  {
    "text": "probably bad this is probably infected",
    "start": "2465559",
    "end": "2469269"
  },
  {
    "text": "zombies get that so you can log this at a web proxy that can be helpful as well",
    "start": "2471069",
    "end": "2476749"
  },
  {
    "text": "it's a bit easier to do than domain then we'll do DNS logging on your DNS servers Microsoft really makes it a pain because",
    "start": "2476749",
    "end": "2484430"
  },
  {
    "text": "of the way they you basically have to generate this flat file and then pick it up into the sim that's really the only only way that I know to do it if your",
    "start": "2484430",
    "end": "2490579"
  },
  {
    "text": "log you're doing dns resolution on your domain controllers if you have a purpose-built appliance and there's some",
    "start": "2490579",
    "end": "2496910"
  },
  {
    "text": "companies that work with that have these purpose-built dns and dhcp appliances those would make it a lot more",
    "start": "2496910",
    "end": "2503079"
  },
  {
    "text": "streamlined in order to implement the logging if the volume of data becomes prohibitive and when you start talking",
    "start": "2503079",
    "end": "2509150"
  },
  {
    "text": "in big global companies about logging this the network guys usually laugh at you and or throw stuff at you because",
    "start": "2509150",
    "end": "2514640"
  },
  {
    "text": "they you know we have 400 DNS servers and each of them generates you know a gigabyte of information gigabyte of",
    "start": "2514640",
    "end": "2521119"
  },
  {
    "text": "queries every 15 seconds and it's just not going to work what you can do is filter out events that are associated",
    "start": "2521119",
    "end": "2526489"
  },
  {
    "text": "with your internal data lookups and then any common ones like you know your Microsoft Google Yahoo your business",
    "start": "2526489",
    "end": "2532489"
  },
  {
    "text": "partners you don't need to know which those in my experience that if you filter out the internal name lookups",
    "start": "2532489",
    "end": "2538340"
  },
  {
    "text": "that'll get that'll get rid of about fifty percent and if you should be able to filter this with the collector before it even goes into the sim so you don't",
    "start": "2538340",
    "end": "2544550"
  },
  {
    "text": "even have the network I want to make sure I had a little bit of time to spend on this so the fifth capability is",
    "start": "2544550",
    "end": "2551270"
  },
  {
    "start": "2545000",
    "end": "2777000"
  },
  {
    "text": "identifying indicators of compromise across the environment and so this is",
    "start": "2551270",
    "end": "2558890"
  },
  {
    "text": "really a a game changer when you have this capability because without this capability you even really smart",
    "start": "2558890",
    "end": "2566630"
  },
  {
    "text": "investigators that I've worked with that don't have a capability to extend their reach across their company are very",
    "start": "2566630",
    "end": "2572420"
  },
  {
    "text": "limited in what they can do so as you're investigating you're finding indicators of compromise which I'll explain in a",
    "start": "2572420",
    "end": "2579350"
  },
  {
    "text": "minute you want to be able to query your entire environment for that data and and",
    "start": "2579350",
    "end": "2584720"
  },
  {
    "text": "this is not something that's easy to do and there are some some tools out there that are purpose-built that have been",
    "start": "2584720",
    "end": "2590810"
  },
  {
    "text": "designed for this purpose that you can use you can also repurpose a lot of other tools that you may already have to do a lot of this and then there's also",
    "start": "2590810",
    "end": "2598250"
  },
  {
    "text": "options that include scripting PowerShell wmi being some examples",
    "start": "2598250",
    "end": "2603550"
  },
  {
    "text": "vulnerability scanners but the idea is you want to be able to query the environment and say I have this thing",
    "start": "2603550",
    "end": "2609290"
  },
  {
    "text": "that indicates that assistance compromised it's a registry key or a memory artifact or file I want to find",
    "start": "2609290",
    "end": "2615020"
  },
  {
    "text": "out where is that anywhere because if if you have this registry key I want to",
    "start": "2615020",
    "end": "2620060"
  },
  {
    "text": "look at your system because you're you know you may be compromised so there's a couple of different ways you can think",
    "start": "2620060",
    "end": "2626480"
  },
  {
    "text": "about an indicator so an indicator could be something that's very specific to a tool to a particular intrusion or it may",
    "start": "2626480",
    "end": "2633590"
  },
  {
    "text": "be something that's general so maybe general badness like if you if you've ever messed around with the the autoruns",
    "start": "2633590",
    "end": "2639140"
  },
  {
    "text": "tool from sysinternals all of those kind of those 1k run keys and the other the",
    "start": "2639140",
    "end": "2644480"
  },
  {
    "text": "other places were and the registry where programs can auto start that's one",
    "start": "2644480",
    "end": "2649490"
  },
  {
    "text": "example of a generic indicator would be let me look through those four things that look anomalous like do I have you",
    "start": "2649490",
    "end": "2654530"
  },
  {
    "text": "know a very basic one that will catch some low-hanging commodity malware's do I have anything running or anything",
    "start": "2654530",
    "end": "2661670"
  },
  {
    "text": "that's persistent in those keys that references a temp directory that's weird you know do I have any processes running that",
    "start": "2661670",
    "end": "2667420"
  },
  {
    "text": "math is internet you know temporary files that's that's weird it's probably bad so you can you can use you can look",
    "start": "2667420",
    "end": "2676390"
  },
  {
    "text": "for specific malware one of the things that we also do as we're doing an investigation is we use your create",
    "start": "2676390",
    "end": "2682059"
  },
  {
    "text": "what's called we call the known bad indicator set so it's basically as we're learning more about what's going on in",
    "start": "2682059",
    "end": "2687549"
  },
  {
    "text": "the environment we're adding to that then we can look across the environment and continuously be checking for missing",
    "start": "2687549",
    "end": "2692829"
  },
  {
    "text": "anything so if we know that didn't there's east 20 things that are related to this particular intrusion if we keep",
    "start": "2692829",
    "end": "2698589"
  },
  {
    "text": "looking what we want to see is we know everything so every time we look we want to say okay yep 10 systems have that",
    "start": "2698589",
    "end": "2704940"
  },
  {
    "text": "artifact we know about Alton okay everything's good we know about those 10 we're going to fix them not we're",
    "start": "2704940",
    "end": "2710380"
  },
  {
    "text": "running it and then we identify five things five new ones that may mean the attacker is still active or it means that we're missing something so this is",
    "start": "2710380",
    "end": "2718240"
  },
  {
    "text": "the example that I want to use to kind of explain this this process so if you picture servers comma is infected so",
    "start": "2718240",
    "end": "2725640"
  },
  {
    "text": "it's got back door underscore a and it's communicating with bad domain com which",
    "start": "2725640",
    "end": "2730900"
  },
  {
    "text": "currently resolves to two three four five two two three three four five six seven eight it's particular backdoors",
    "start": "2730900",
    "end": "2738369"
  },
  {
    "text": "running as a malicious dll that's associated with a legitimate windows service so very commonly adult there",
    "start": "2738369",
    "end": "2746260"
  },
  {
    "text": "will it will be a list of services that a particular piece of malware may hijack this one happens to be using this remote",
    "start": "2746260",
    "end": "2753010"
  },
  {
    "text": "routing remote access service and you also know through your investigation that the attacker used this service",
    "start": "2753010",
    "end": "2760480"
  },
  {
    "text": "account to communicate to a file server so what you want to get out of this are you want to look for host-based",
    "start": "2760480",
    "end": "2767799"
  },
  {
    "text": "indicators what can we look for a network-based indicator so what you want to think about is what out of here can",
    "start": "2767799",
    "end": "2774369"
  },
  {
    "text": "help me identify other systems that have been compromised so some of the things that can indicate that from a network",
    "start": "2774369",
    "end": "2780160"
  },
  {
    "start": "2777000",
    "end": "2892000"
  },
  {
    "text": "perspective so if you see any successful packets destined for this IP address that's something you would look into",
    "start": "2780160",
    "end": "2786520"
  },
  {
    "text": "because that systems probably compromised it may not be though it may be a false positive it may be a hosting",
    "start": "2786520",
    "end": "2793930"
  },
  {
    "text": "environment and the attacker just happens to be running space on a server that's got a lot of other legitimate",
    "start": "2793930",
    "end": "2799059"
  },
  {
    "text": "sites any DNS queries or anything you see in your web proxy for that bad domain that's probably",
    "start": "2799059",
    "end": "2805119"
  },
  {
    "text": "something something you should look into the other thing that you could look into is if you understand how this backdoor a",
    "start": "2805119",
    "end": "2810720"
  },
  {
    "text": "communicates over the network you can look for patterns specific to that",
    "start": "2810720",
    "end": "2816430"
  },
  {
    "text": "protocol so that requires some some more advanced capabilities in terms of being able to understand how the Malheur is",
    "start": "2816430",
    "end": "2822310"
  },
  {
    "text": "actually working but that's something that can be really powerful as well because that way if he comes out with backdoor underscore be that looks",
    "start": "2822310",
    "end": "2829900"
  },
  {
    "text": "different enough different on the disk that you're not finding it and enough different that you're not finding it based on other host artifacts you may",
    "start": "2829900",
    "end": "2836650"
  },
  {
    "text": "see that protocol pop up I got an investigation last year where there was an attacker we've seen year after year",
    "start": "2836650",
    "end": "2842260"
  },
  {
    "text": "and we at we detected so he was using all new tools but one of the tools he",
    "start": "2842260",
    "end": "2847480"
  },
  {
    "text": "was using happen to be basically written this the same network protocol like probably just get copied and pasted that",
    "start": "2847480",
    "end": "2853090"
  },
  {
    "text": "module so even though it was brand-new we were able to immediately pick up that the system was infected and it was this",
    "start": "2853090",
    "end": "2860530"
  },
  {
    "text": "particular actor okay host-based indicators so some of these are very",
    "start": "2860530",
    "end": "2866320"
  },
  {
    "text": "temporal so these I wouldn't hang my hat on but i'm starting with kind of the easy ones so if the system has an",
    "start": "2866320",
    "end": "2872109"
  },
  {
    "text": "established tcp connection it's kind of a host-based side of that network",
    "start": "2872109",
    "end": "2877150"
  },
  {
    "text": "indicator of talking to see two or if the DNS cache contains this bad domain",
    "start": "2877150",
    "end": "2882300"
  },
  {
    "text": "you could query that you know from with a was with a script you could probably",
    "start": "2882300",
    "end": "2888550"
  },
  {
    "text": "do it using using wmi host-based indicators continued so another things",
    "start": "2888550",
    "end": "2895359"
  },
  {
    "text": "you want to look for other things we talked about if the security event log contains a successful authentication from this privileged account or if it",
    "start": "2895359",
    "end": "2902200"
  },
  {
    "text": "contains a log on from server a so this is we're having the sim being able to do the log queries is going to really help",
    "start": "2902200",
    "end": "2908230"
  },
  {
    "text": "you identify other systems another thing is that you know from your analysis of this server a that this particular it's",
    "start": "2908230",
    "end": "2917650"
  },
  {
    "text": "a service persistence mechanism and so there's a registry key that references there's a particular dll name it's not a",
    "start": "2917650",
    "end": "2923980"
  },
  {
    "text": "you know the name if the name is different you might not find it but you can look for this sneaky dll in the may",
    "start": "2923980",
    "end": "2930850"
  },
  {
    "text": "find that same malware some other things that you can look for in some of these are a bit more it's and this is really one of the ways",
    "start": "2930850",
    "end": "2936670"
  },
  {
    "text": "that if you're the more customized you're able to do this and the more you're able to extend your reach through",
    "start": "2936670",
    "end": "2943000"
  },
  {
    "text": "different tools this will make your investigation even more complete because you'll you'll be able to get a better",
    "start": "2943000",
    "end": "2949090"
  },
  {
    "text": "grasp on what's going on so some other things you can look for final has md5 hash matches the exact dll well so anti",
    "start": "2949090",
    "end": "2956710"
  },
  {
    "text": "virus can do this there's other other ways you can do it but if you know most",
    "start": "2956710",
    "end": "2961780"
  },
  {
    "text": "companies have anti-virus mostly across their windows environment so you can look for that but the problem of course",
    "start": "2961780",
    "end": "2968170"
  },
  {
    "text": "is that if there's anything different about it you're not going to find that an ideal oh another thing that you can think about is okay this particular file",
    "start": "2968170",
    "end": "2974920"
  },
  {
    "text": "add is a compiled compiles timestamp that's that's that's this and has this",
    "start": "2974920",
    "end": "2979930"
  },
  {
    "text": "size so there may be variants of this dll that are different and 75 is not",
    "start": "2979930",
    "end": "2987430"
  },
  {
    "text": "going to match but they're pretty much the same thing functionally wow that's",
    "start": "2987430",
    "end": "2993880"
  },
  {
    "text": "loud so that may catch variants another thing that you could do and this is",
    "start": "2993880",
    "end": "2999490"
  },
  {
    "text": "getting more you're going to have to have some capabilities to really understand the malware there may be a unique combination of function imports",
    "start": "2999490",
    "end": "3005850"
  },
  {
    "text": "that you can use to say that it's likely you're going to have some false positives and this this may require some",
    "start": "3005850",
    "end": "3013770"
  },
  {
    "text": "more advanced tools or scripting to do but basically looking for the fingerprint that for example you know",
    "start": "3013770",
    "end": "3020070"
  },
  {
    "text": "that a password hash dumper is going to have to import these 10 windows functions to do its work you could",
    "start": "3020070",
    "end": "3027240"
  },
  {
    "text": "combine that with some other information to try and catch other tools that are",
    "start": "3027240",
    "end": "3033750"
  },
  {
    "text": "probably doing the same thing granted you're going to get more false positives but it can work the other thing you",
    "start": "3033750",
    "end": "3039570"
  },
  {
    "text": "could do is looking for okay you know that the when the when the malware is running that it has a certain new text",
    "start": "3039570",
    "end": "3044610"
  },
  {
    "text": "that it uses to make sure that make sure doesn't start of a bunch of times if the attacker likes to reuse code you know",
    "start": "3044610",
    "end": "3051870"
  },
  {
    "text": "just cut the pace from another library then you may find that this is helpful so to really to really do this you first",
    "start": "3051870",
    "end": "3060420"
  },
  {
    "text": "identify indicators through forensic analysis and network analysis and then",
    "start": "3060420",
    "end": "3065700"
  },
  {
    "text": "you need to have this capability to go across the environment so I mentioned",
    "start": "3065700",
    "end": "3071590"
  },
  {
    "text": "antivirus antivirus is definitely one way that you can look for em to md5 hashes sometimes you can look for other",
    "start": "3071590",
    "end": "3077680"
  },
  {
    "text": "attributes but from a network perspective you may be able to do something with host-based firewalls it depends on what modules you have",
    "start": "3077680",
    "end": "3083500"
  },
  {
    "text": "uploaded system in configuration management software so if you have third-party tools well third-party I",
    "start": "3083500",
    "end": "3090610"
  },
  {
    "text": "mean non-microsoft as I'll mention SCCM software inventory is one way if you're looking for a specific registry key you",
    "start": "3090610",
    "end": "3097930"
  },
  {
    "text": "can use modules that were designed for licensing and compliance to basically go out and tell you what's that key if you",
    "start": "3097930",
    "end": "3103360"
  },
  {
    "text": "do that keep in mind that the data that you're querying might not be current it might represent the state you know a",
    "start": "3103360",
    "end": "3109300"
  },
  {
    "text": "week ago when the data was collected you can also use if you have third-party tools that that you use to manage",
    "start": "3109300",
    "end": "3115660"
  },
  {
    "text": "software you can go out and and oftentimes define a query that you can",
    "start": "3115660",
    "end": "3120760"
  },
  {
    "text": "look for a file or registry key or something like that network intrusion detection systems very helpful if you",
    "start": "3120760",
    "end": "3128800"
  },
  {
    "text": "have IP addresses that you're looking for domain names if you can write custom",
    "start": "3128800",
    "end": "3134190"
  },
  {
    "text": "signatures for any protocols in you're in it's going to take some more some more advanced capabilities to do that",
    "start": "3134190",
    "end": "3139450"
  },
  {
    "text": "those can be very helpful the sim we've talked about some some vulnerability",
    "start": "3139450",
    "end": "3144730"
  },
  {
    "text": "scanners have modules that you can repurpose to look for some of these artifacts so like a light like I've seen",
    "start": "3144730",
    "end": "3152260"
  },
  {
    "text": "one that it's a module where you can look for like I'm like for software licensing tell me if XYZ is installed",
    "start": "3152260",
    "end": "3159250"
  },
  {
    "text": "and the module works by checking for a registry key you can use that to look for malware some of them also have the",
    "start": "3159250",
    "end": "3164740"
  },
  {
    "text": "ability to look for a specific process or look for a specific file on disk so if you have it so think outside the box",
    "start": "3164740",
    "end": "3172120"
  },
  {
    "text": "about the tools that you already have and that'll be helpful before you run",
    "start": "3172120",
    "end": "3177760"
  },
  {
    "text": "out and go buy something buy something else powershell wmi is going to require a lot of legwork there's there's there",
    "start": "3177760",
    "end": "3185080"
  },
  {
    "text": "are some some publicly available scripts I had the some links in the end notes",
    "start": "3185080",
    "end": "3190720"
  },
  {
    "text": "and the white paper that's on the CD that I found in my research for this that can be that can be helpful of",
    "start": "3190720",
    "end": "3198250"
  },
  {
    "text": "course you have to powershell assault on systems if you're going to do that and then of course there's purpose-built purpose-built tools so to wrap up and I",
    "start": "3198250",
    "end": "3206900"
  },
  {
    "start": "3204000",
    "end": "3334000"
  },
  {
    "text": "want to make sure minutes for questions so now I'm standing in the way of everyone and the drinks develop some use",
    "start": "3206900",
    "end": "3214040"
  },
  {
    "text": "cases don't let the tool dictate your process you need to make sure that your the processes and your needs as",
    "start": "3214040",
    "end": "3220640"
  },
  {
    "text": "investigators dictate the tools so determine what capabilities you need for your environment and then define the use",
    "start": "3220640",
    "end": "3227660"
  },
  {
    "text": "cases figure out what you can do with your existing tools and then figure out if there's anything else that you need",
    "start": "3227660",
    "end": "3232850"
  },
  {
    "text": "to add rather than doing it the other way around there's no there's no no one",
    "start": "3232850",
    "end": "3237920"
  },
  {
    "text": "tool is going to solve your problem this is not a tools problem it's a you need processes and you need an understanding",
    "start": "3237920",
    "end": "3244700"
  },
  {
    "text": "of what's going on and what you're looking for there's not a single tool also and just kind of as a final thought",
    "start": "3244700",
    "end": "3252560"
  },
  {
    "text": "that I had as I was writing the white paper in the really big picture of this I would make sure that from an IR",
    "start": "3252560",
    "end": "3258680"
  },
  {
    "text": "perspective that you're you're monitoring in capturing metrics that are useful and that useful to measure how",
    "start": "3258680",
    "end": "3265460"
  },
  {
    "text": "your program is improving as well as help you get support for getting some of these additional capabilities like if",
    "start": "3265460",
    "end": "3270830"
  },
  {
    "text": "you're measuring how long does it take us from the time that we detect something is fishy to win is actually",
    "start": "3270830",
    "end": "3277480"
  },
  {
    "text": "contained on the network that's helpful and that can you can use that type of metric to show how you're improving or",
    "start": "3277480",
    "end": "3284480"
  },
  {
    "text": "also show the benefit of if we had had XYZ capability we could have maybe done this faster than the attacker would have",
    "start": "3284480",
    "end": "3290930"
  },
  {
    "text": "only compromised five systems instead of 10 and maybe wouldn't have stolen this data and then also mean time to detect",
    "start": "3290930",
    "end": "3296300"
  },
  {
    "text": "so how long was the attacker in your environment every every organization is vulnerable to getting compromised if the",
    "start": "3296300",
    "end": "3303350"
  },
  {
    "text": "attacker is determined enough I don't believe that it's something that on a enterprise-scale that you can prevent the initial compromise what you want to",
    "start": "3303350",
    "end": "3310160"
  },
  {
    "text": "think about is how fast can you stop it so even the companies that are very that are very mature capabilities still",
    "start": "3310160",
    "end": "3316730"
  },
  {
    "text": "there's going to be some zero-day or some thing they haven't patched they're going to get initial initial compromise will will happen but from that point if",
    "start": "3316730",
    "end": "3323990"
  },
  {
    "text": "they're able to detect that in a matter of hours it's usually not as bad then if you know in case of some organizations",
    "start": "3323990",
    "end": "3330650"
  },
  {
    "text": "whether they're compromise for years and they don't know it until someone knocks on the door so with that I'll open up to two",
    "start": "3330650",
    "end": "3337220"
  },
  {
    "start": "3334000",
    "end": "3600000"
  },
  {
    "text": "questions and thank you very much for your attention all right well there's no",
    "start": "3337220",
    "end": "3355490"
  },
  {
    "text": "questions thanks again I'll be around during the you know the next hour and a half if anybody wants to talk thanks",
    "start": "3355490",
    "end": "3363400"
  },
  {
    "text": "yeah sorry guys I'm just one question",
    "start": "3368799",
    "end": "3378619"
  },
  {
    "text": "kien Singapore requirement to have antivirus on at each station especially servers do the service if you seen any",
    "start": "3378619",
    "end": "3384980"
  },
  {
    "text": "cases when the antivirus will do more harm than good meaning antivirus is one step behind and my thought antivirus",
    "start": "3384980",
    "end": "3392599"
  },
  {
    "text": "mile cleanup system basically you know removing all traces certainly very",
    "start": "3392599",
    "end": "3398030"
  },
  {
    "text": "difficult for intensive investigation yeah so I've seen that be an issue generally I don't I wouldn't find it to",
    "start": "3398030",
    "end": "3404270"
  },
  {
    "text": "be a problem to have antivirus installed everywhere I my caveat would be if I",
    "start": "3404270",
    "end": "3410210"
  },
  {
    "text": "would make sure that whatever files it quarantines it did quarantines them rather than just a leading him cuz i",
    "start": "3410210",
    "end": "3416779"
  },
  {
    "text": "have run into that problem where it deletes deletes the evidence but a lot",
    "start": "3416779",
    "end": "3422299"
  },
  {
    "text": "of times i find that antivirus doesn't detect a lot of this actually reviewing your antivirus logs for anomalies can be",
    "start": "3422299",
    "end": "3428960"
  },
  {
    "text": "one way to really proactively well it's our early proactive but really effectively detect the middle of some of",
    "start": "3428960",
    "end": "3435020"
  },
  {
    "text": "these compromises where antivirus is pretty good at detecting some types of masks market credential dumpers so if",
    "start": "3435020",
    "end": "3442700"
  },
  {
    "text": "they use a generic pw dumper after you dump or something you can detect it so I would recommend you know kind of on the",
    "start": "3442700",
    "end": "3448130"
  },
  {
    "text": "antivirus note make sure that your triage process has something in it a note where the analysts should consider",
    "start": "3448130",
    "end": "3455720"
  },
  {
    "text": "whether this may be part of something bigger rather than just saying okay yep it got caught let's let's let's rebuild",
    "start": "3455720",
    "end": "3463160"
  },
  {
    "text": "it because that's the default answer and most big companies Scott malware rebuild it whereas you may be missing that that was the sign that the guys in",
    "start": "3463160",
    "end": "3470010"
  },
  {
    "text": "your environment that the attackers environment the other questions so all",
    "start": "3470010",
    "end": "3481110"
  },
  {
    "text": "these all these kind of analysis based on the you news at Sierra is a control",
    "start": "3481110",
    "end": "3488580"
  },
  {
    "text": "server connected to your inside right how do you determine this is a control",
    "start": "3488580",
    "end": "3494100"
  },
  {
    "text": "server or not that's a much bigger much",
    "start": "3494100",
    "end": "3502500"
  },
  {
    "text": "bigger topic but it's definitely a good topic what I would say is that it's it's",
    "start": "3502500",
    "end": "3508230"
  },
  {
    "text": "really hard let me actually go back and let me use this as a way so if you look at the attack life cycle of the way and",
    "start": "3508230",
    "end": "3514110"
  },
  {
    "text": "this is targeted targeted attacks the initial compromise you're probably not",
    "start": "3514110",
    "end": "3519960"
  },
  {
    "text": "going to be able to detect that I mean if you could if somebody had some tool that you could reliably detect that then",
    "start": "3519960",
    "end": "3524970"
  },
  {
    "text": "none of this other stuff would happen there's always going to be something that gets exploited that you know some patch that's not applied this is going",
    "start": "3524970",
    "end": "3531090"
  },
  {
    "text": "to be difficult to detect establishing foothold from this this is something",
    "start": "3531090",
    "end": "3536460"
  },
  {
    "text": "where and it's not easy but if you look for common ways that malware persists on",
    "start": "3536460",
    "end": "3541650"
  },
  {
    "text": "systems that's one good way that you can detect these these footholds so a backdoor that's installed by looking for",
    "start": "3541650",
    "end": "3548250"
  },
  {
    "text": "anomalies you know an anomalous running service if a anomalous a process that",
    "start": "3548250",
    "end": "3557280"
  },
  {
    "text": "has anomalous connections based on intelligence that you have which again you know that's it's difficult difficult",
    "start": "3557280",
    "end": "3563040"
  },
  {
    "text": "to know so in your industry there may be particular bulletins that come out like I know in the United States and certain",
    "start": "3563040",
    "end": "3569580"
  },
  {
    "text": "industries they have working groups where they share information on a tax and you can look for something that's",
    "start": "3569580",
    "end": "3575490"
  },
  {
    "text": "you're seeing the same thing that they're seeing at another company escalating escalating privilege is also",
    "start": "3575490",
    "end": "3583980"
  },
  {
    "text": "difficult to detect except for if your antivirus happens to catch a credential dumper I think a lot of a lot of it can",
    "start": "3583980",
    "end": "3591390"
  },
  {
    "text": "be caught in and move lat where the attackers moving laterally within the environment if you if you know what",
    "start": "3591390",
    "end": "3598230"
  },
  {
    "text": "account should be going to wear but almost no no nobody knows that there you wouldn't know if it's an anomalous use of an",
    "start": "3598230",
    "end": "3603690"
  },
  {
    "text": "account because nobody except for the person who runs that application knows that that what that accounts supposed to be doing but it you really just have to",
    "start": "3603690",
    "end": "3613680"
  },
  {
    "text": "have to have a combination of proactively going through your environment looking for signs of",
    "start": "3613680",
    "end": "3619670"
  },
  {
    "text": "anomalous activity at from a network perspective a host perspective and then also apply as much outside intelligences",
    "start": "3619670",
    "end": "3626400"
  },
  {
    "text": "you can get about what's bad because it can change so often with certain certain",
    "start": "3626400",
    "end": "3632130"
  },
  {
    "text": "types of threats any other questions",
    "start": "3632130",
    "end": "3639440"
  },
  {
    "text": "okay thank you very much",
    "start": "3646940",
    "end": "3650869"
  }
]