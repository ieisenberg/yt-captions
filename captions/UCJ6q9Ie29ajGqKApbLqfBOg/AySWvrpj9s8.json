[
  {
    "start": "0",
    "end": "148000"
  },
  {
    "text": "good morning everybody welcome to our talk on attacking next gen roaming",
    "start": "60",
    "end": "7470"
  },
  {
    "text": "technologies the pieces you see on the on the slide what exactly next-gen by I",
    "start": "7470",
    "end": "12990"
  },
  {
    "text": "encourage you to find out what these pieces are in any case my name is I know",
    "start": "12990",
    "end": "19619"
  },
  {
    "text": "this is Dania yeah both security researchers for a German security",
    "start": "19619",
    "end": "24869"
  },
  {
    "text": "assessment and research company called Yan W I'm acting as a replacement speaker for Hendrik who's the telco team",
    "start": "24869",
    "end": "33770"
  },
  {
    "text": "lead at Iran W he had a nasty car accident on Monday he's mostly better",
    "start": "33770",
    "end": "40590"
  },
  {
    "text": "than Bruce so nothing really serious happened but it was a kind of they",
    "start": "40590",
    "end": "46920"
  },
  {
    "text": "helped his girlfriend in him at another accident at the side of the road and",
    "start": "46920",
    "end": "52440"
  },
  {
    "text": "another car crashed into the group so it was quite nasty and the reason why I can't be here today I have a background",
    "start": "52440",
    "end": "60379"
  },
  {
    "text": "also like Hendrick in large-scale Network environments and telco security",
    "start": "60379",
    "end": "67290"
  },
  {
    "text": "so I hope I will be able to fulfill or to fill the Hendricks role here Daniel",
    "start": "67290",
    "end": "76080"
  },
  {
    "text": "and I have given a number of talks at blackhat in the last 10 years on stuff like MPLS security system wide security",
    "start": "76080",
    "end": "83729"
  },
  {
    "text": "stuff like this so this gives you an indication of the type of stuff we usually do and today we are going to",
    "start": "83729",
    "end": "89490"
  },
  {
    "text": "cover briefly as a seven and diameter actually the the agenda of the talk is",
    "start": "89490",
    "end": "95369"
  },
  {
    "text": "quite simple we want to give a brief technology overview namely of this thing",
    "start": "95369",
    "end": "101880"
  },
  {
    "text": "called diameter and the role it has in telco networks namely the context of",
    "start": "101880",
    "end": "107970"
  },
  {
    "text": "roaming when people from who have a subscription in one providers network",
    "start": "107970",
    "end": "113009"
  },
  {
    "text": "are physically located in another providers network and establish calls or establish data connections as well then",
    "start": "113009",
    "end": "121020"
  },
  {
    "text": "we'll discuss what types of attacks exists in these environments especially",
    "start": "121020",
    "end": "126780"
  },
  {
    "text": "the related to the to the protocols we cover there will be a tool release its",
    "start": "126780",
    "end": "132390"
  },
  {
    "text": "blackhat so there will be a new tool that Daniel wrote and he's going to to show and",
    "start": "132390",
    "end": "138600"
  },
  {
    "text": "obviously will try to derive some conclusions what this means as for security Integra networks in general and",
    "start": "138600",
    "end": "146370"
  },
  {
    "text": "in particular when it comes to diameter let's start with a quick view what has",
    "start": "146370",
    "end": "152730"
  },
  {
    "start": "148000",
    "end": "259000"
  },
  {
    "text": "been available in telco networks for the signalling between providers so far that",
    "start": "152730",
    "end": "158160"
  },
  {
    "text": "is there is one main se protocol or protocol suite called as a 7 signaling",
    "start": "158160",
    "end": "164960"
  },
  {
    "text": "system 7 that one is used for say",
    "start": "164960",
    "end": "172040"
  },
  {
    "text": "signalling between providers when it comes to authentication of subscribers and roaming scenarios when it comes to",
    "start": "172040",
    "end": "178380"
  },
  {
    "text": "exchange of information about these subscribers and the most simple situation when your tackle subscriber is",
    "start": "178380",
    "end": "187650"
  },
  {
    "text": "say we have Alice and Bob Alice's subscriber and provider is network and",
    "start": "187650",
    "end": "193530"
  },
  {
    "text": "Pappas employed a DS network this is not what we are going to cover in detail the",
    "start": "193530",
    "end": "199290"
  },
  {
    "text": "thing we are going to look at its aroma situation when Alice actually is in another providers network and then what",
    "start": "199290",
    "end": "207360"
  },
  {
    "text": "happens is a specific type of interaction between the provider various facilities located and attaches to the",
    "start": "207360",
    "end": "214530"
  },
  {
    "text": "network and Tara as it's called home provider which holds the authentication",
    "start": "214530",
    "end": "221520"
  },
  {
    "text": "information when it comes to Alice which holds all the information as for the contract and the subscription and as for",
    "start": "221520",
    "end": "228090"
  },
  {
    "text": "the charging and this type of interaction and the until for G this",
    "start": "228090",
    "end": "237180"
  },
  {
    "text": "type of interaction which is about which we for education information get encryption material get all types of",
    "start": "237180",
    "end": "243600"
  },
  {
    "text": "information about the subscription and updating the the location of the of the",
    "start": "243600",
    "end": "249570"
  },
  {
    "text": "subscriber like ok now Alice is located in some some remote country in another",
    "start": "249570",
    "end": "255720"
  },
  {
    "text": "providers network all these interactions the past have happened for as a 7 as a 7",
    "start": "255720",
    "end": "262860"
  },
  {
    "start": "259000",
    "end": "372000"
  },
  {
    "text": "there has been quite some security research on it number of talks were given namely at the",
    "start": "262860",
    "end": "268790"
  },
  {
    "text": "DCCC event where some papers and blog",
    "start": "268790",
    "end": "274620"
  },
  {
    "text": "posts from some guys so we can consider it to some degree well researched and",
    "start": "274620",
    "end": "284150"
  },
  {
    "text": "there is even funny enough from from sense which from my perspective don't",
    "start": "284150",
    "end": "289770"
  },
  {
    "text": "exactly have a reputation of being experts in health security but there is a very good paper from one guy in the in",
    "start": "289770",
    "end": "299130"
  },
  {
    "text": "the sense context which did a kind of vulnerability classification and the",
    "start": "299130",
    "end": "304890"
  },
  {
    "text": "classification of the types of exchanges used within as a seven like okay there",
    "start": "304890",
    "end": "312540"
  },
  {
    "text": "are some some exchanges some messages which are only meant to be transported",
    "start": "312540",
    "end": "317820"
  },
  {
    "text": "between providers there are some which are meant to be used between one provider but do not necessarily have to",
    "start": "317820",
    "end": "324780"
  },
  {
    "text": "be exposed to the outside world in a roaming exchange to other providers so",
    "start": "324780",
    "end": "331620"
  },
  {
    "text": "there is this classification and in that paper there is a classification of say",
    "start": "331620",
    "end": "337830"
  },
  {
    "text": "these categories and types of exchanges within sa-7 and the attacks related",
    "start": "337830",
    "end": "345960"
  },
  {
    "text": "which can occur in the context of specific messages I'm mostly telling",
    "start": "345960",
    "end": "353220"
  },
  {
    "text": "this to make you aware there has been some research and there is already some",
    "start": "353220",
    "end": "358530"
  },
  {
    "text": "understanding what types of issues can arise from sa-7 and how these can be",
    "start": "358530",
    "end": "367140"
  },
  {
    "text": "mapped to exchanges and what actually happens between different providers",
    "start": "367140",
    "end": "374090"
  },
  {
    "start": "372000",
    "end": "471000"
  },
  {
    "text": "there was a tool yeah as for ss7 i did implement most of the attacks last year",
    "start": "374090",
    "end": "380880"
  },
  {
    "text": "and released the tool as put to test you or a network for those well-known",
    "start": "380880",
    "end": "386490"
  },
  {
    "text": "attacks on ss7 networks and it's already released our road and",
    "start": "386490",
    "end": "391580"
  },
  {
    "text": "some article on insinuated about the tool it's very useful to check if you as",
    "start": "391580",
    "end": "398210"
  },
  {
    "text": "a tackle yourself are vulnerable to those attacks but anyways you will need a legitimate as a 7-up link to use that",
    "start": "398210",
    "end": "404840"
  },
  {
    "text": "tool properly which actually is a quite heavy restriction when it comes to doing security research needing this type of",
    "start": "404840",
    "end": "411860"
  },
  {
    "text": "uplink as you can't like do this even if you have the tool and you get it to running or other tools but I would say",
    "start": "411860",
    "end": "419150"
  },
  {
    "text": "this is the most important one you can't do this from home you need just say type",
    "start": "419150",
    "end": "426140"
  },
  {
    "text": "of access to that mostly closed or SAS",
    "start": "426140",
    "end": "431900"
  },
  {
    "text": "it's called in telco space walled garden where he telcos interacts we will see this this might be slightly different",
    "start": "431900",
    "end": "438740"
  },
  {
    "text": "with diameter as far as for the tool itself yeah this is what this looks like",
    "start": "438740",
    "end": "445190"
  },
  {
    "text": "so I said before it implements barriers well known attacks and just test for",
    "start": "445190",
    "end": "451790"
  },
  {
    "text": "those attacks with like descent routing information for short messages or if you",
    "start": "451790",
    "end": "458270"
  },
  {
    "text": "could resolve MSISDN into an MC wire the send MC message and so forth and so on",
    "start": "458270",
    "end": "464330"
  },
  {
    "text": "so this is what the typical test output would look like but we're not here to talk about ss7 we are here to talk about",
    "start": "464330",
    "end": "472960"
  },
  {
    "start": "471000",
    "end": "535000"
  },
  {
    "text": "the newer stuff which is used in 4G networks",
    "start": "472960",
    "end": "478060"
  },
  {
    "text": "some say important properties of 4G networks here is everything is based on",
    "start": "478060",
    "end": "485000"
  },
  {
    "text": "IP there is not this strict separation between an ip-based say data transport",
    "start": "485000",
    "end": "491570"
  },
  {
    "text": "and circuit-switched voice thing as we had in 2g and 3g and 4g it's all IP it's",
    "start": "491570",
    "end": "500330"
  },
  {
    "text": "somewhat logically separated there was still a data a channel and an avoid",
    "start": "500330",
    "end": "505610"
  },
  {
    "text": "channel implemented by so called the bearers on the only only smartphones or",
    "start": "505610",
    "end": "510980"
  },
  {
    "text": "the phone side the phone and in some of the slides will be called the Ueda say",
    "start": "510980",
    "end": "518539"
  },
  {
    "text": "the user entity a user equipment and the role that so far as a seven",
    "start": "518540",
    "end": "525330"
  },
  {
    "text": "for the signaling between providers namely in the roaming contacts this is",
    "start": "525330",
    "end": "532200"
  },
  {
    "text": "nowadays done by diameter diameter has",
    "start": "532200",
    "end": "538529"
  },
  {
    "start": "535000",
    "end": "673000"
  },
  {
    "text": "saved us different entities and parties involved in the specification of diameter there is a thing called a base",
    "start": "538529",
    "end": "544260"
  },
  {
    "text": "protocol which Daniel is going to be discussed in a second that one is specified from the IETF space in an RFC",
    "start": "544260",
    "end": "551870"
  },
  {
    "text": "but given that diameter originally comes from the telco world the 3gpp which is",
    "start": "551870",
    "end": "558540"
  },
  {
    "text": "the main specification body for for telco technologies has a number of their",
    "start": "558540",
    "end": "566070"
  },
  {
    "text": "own specifications which mainly describe so-called applications initially a",
    "start": "566070",
    "end": "572640"
  },
  {
    "text": "diameter as the name might indicate was meant as we play as a successor of",
    "start": "572640",
    "end": "579240"
  },
  {
    "text": "radios so mostly used for a a authentication authorization purposes",
    "start": "579240",
    "end": "585510"
  },
  {
    "text": "and accounting and there is just this wordplay they try to come up with something which gives the abbreviation",
    "start": "585510",
    "end": "592050"
  },
  {
    "text": "diameter as opposed to two radios but nowadays diameter is used as a",
    "start": "592050",
    "end": "599180"
  },
  {
    "text": "multi-purpose signaling protocol for all types of interactions between providers",
    "start": "599180",
    "end": "605760"
  },
  {
    "text": "and the thing is it's not just like a protocol for the exchange and for certain messages again those will be",
    "start": "605760",
    "end": "612959"
  },
  {
    "text": "discussed in a second but it has a kind of own routing logic so entity is",
    "start": "612959",
    "end": "618329"
  },
  {
    "text": "participating or speaking diameter have say a no layer of how to forward",
    "start": "618329",
    "end": "625740"
  },
  {
    "text": "messages to other nodes and how to how to find each other and how to talk to",
    "start": "625740",
    "end": "630990"
  },
  {
    "text": "each other this will become important at some later point and another thing that",
    "start": "630990",
    "end": "637110"
  },
  {
    "text": "to keep in mind is that diameter can be say transported above over TCP but most",
    "start": "637110",
    "end": "648110"
  },
  {
    "text": "cases that we know I I don't think we have ever seen diameter what TCP",
    "start": "648110",
    "end": "654140"
  },
  {
    "text": "production area integral world it's very common to use SCTP the swim transmission",
    "start": "654140",
    "end": "661070"
  },
  {
    "text": "control protocol as the layer for protocol so usually you see a diameter",
    "start": "661070",
    "end": "669260"
  },
  {
    "text": "been spoken implemented over HTTP and",
    "start": "669260",
    "end": "674590"
  },
  {
    "text": "now looking at the roaming scenario in the 4G in the so called next-gen world",
    "start": "674590",
    "end": "681730"
  },
  {
    "text": "there is some several things to keep in mind as I mentioned there was a",
    "start": "681730",
    "end": "688280"
  },
  {
    "text": "separation between data and voice and there is the signaling the out-of-band",
    "start": "688280",
    "end": "695330"
  },
  {
    "text": "thing for setting up the call and for getting subscriber information all these",
    "start": "695330",
    "end": "700520"
  },
  {
    "text": "channels wide logically separate from the transport level",
    "start": "700520",
    "end": "705980"
  },
  {
    "text": "implemented across points where the providers meet at those points in the old world the those were called the gr",
    "start": "705980",
    "end": "712490"
  },
  {
    "text": "access and now they are quality IP access and most large telcos offer this type of service you can like say just an",
    "start": "712490",
    "end": "724100"
  },
  {
    "text": "exchange network for specific things between providers when it comes to voice",
    "start": "724100",
    "end": "732770"
  },
  {
    "text": "transport in 4G networks that is usually done by means of voice over LTE LTE and",
    "start": "732770",
    "end": "743320"
  },
  {
    "text": "technically speaking terrorists next to the data channel which exists",
    "start": "743320",
    "end": "748910"
  },
  {
    "text": "anyway and which is IP base there is a second channel a second bearer for the",
    "start": "748910",
    "end": "754250"
  },
  {
    "text": "voice transport which has realized over IP and the main component involved on the on the in the telco infrastructure",
    "start": "754250",
    "end": "762260"
  },
  {
    "text": "is the so called IMS the IP Multimedia Subsystem and when you look at this there was three main things from the the",
    "start": "762260",
    "end": "770720"
  },
  {
    "text": "topo world has all types of components with specific names of specific abbreviations there's three that are of",
    "start": "770720",
    "end": "777470"
  },
  {
    "text": "importance for what we are going to discuss there is one entity called g8 HSS the home subscriber server this is",
    "start": "777470",
    "end": "785420"
  },
  {
    "text": "the central database for authentication and for all types of data related to an",
    "start": "785420",
    "end": "790550"
  },
  {
    "text": "individual subscriber then there is the mm which is the mobility management entity that is the kind of say component",
    "start": "790550",
    "end": "800080"
  },
  {
    "text": "doing all the control pain for actual user subscriber connections so that",
    "start": "800080",
    "end": "807730"
  },
  {
    "text": "component that terminates or hassey as data okay in this cell there is that subscriber attached to the network and",
    "start": "807730",
    "end": "816790"
  },
  {
    "text": "handling the the connection the call data including handling the keys which",
    "start": "816790",
    "end": "822740"
  },
  {
    "text": "are used for the / iya encryption and then there is the IMS the IP multimedia",
    "start": "822740",
    "end": "828620"
  },
  {
    "text": "subsystem which kind of terminates and handles the voice over LTE so the user",
    "start": "828620",
    "end": "836750"
  },
  {
    "text": "plane the MM is the so-called contrived control plane and the ims implements a",
    "start": "836750",
    "end": "843380"
  },
  {
    "text": "user plane and there is two scenarios which are relevant for our discussion",
    "start": "843380",
    "end": "849580"
  },
  {
    "text": "say imagine LS is roaming analysis and provider sees network and now LS",
    "start": "849580",
    "end": "857630"
  },
  {
    "text": "establishes a voice over LTE call which is a protocol was handled by RTP and zip",
    "start": "857630",
    "end": "867070"
  },
  {
    "text": "the thing as this connection actually can be can be encrypted between the",
    "start": "867070",
    "end": "873760"
  },
  {
    "text": "between Alice and the IMS and one case is the IMS sits in the in Alice home",
    "start": "873760",
    "end": "881540"
  },
  {
    "text": "network then this is called home routed IMS and the other case is that the",
    "start": "881540",
    "end": "888650"
  },
  {
    "text": "foreign provider were actually Alice is physically located has an own IMS",
    "start": "888650",
    "end": "894790"
  },
  {
    "text": "terminating the SIP connections with",
    "start": "894790",
    "end": "900020"
  },
  {
    "text": "wave LS and then somewhat handed over depending on where Alice actually wants",
    "start": "900020",
    "end": "906260"
  },
  {
    "text": "to want to talk to to the to the home IMS why are so-called an entire network",
    "start": "906260",
    "end": "912260"
  },
  {
    "text": "to network interface this scenario means that in case the connection is encrypted",
    "start": "912260",
    "end": "919850"
  },
  {
    "text": "which obviously from a security and privacy perspective makes sense but",
    "start": "919850",
    "end": "924950"
  },
  {
    "text": "which isn't I would say it's that all providers actually encrypt what survived",
    "start": "924950",
    "end": "931100"
  },
  {
    "text": "LTE connections we did some security testing in my providers Network sometime",
    "start": "931100",
    "end": "936650"
  },
  {
    "text": "ago and it was not it was the whole thing was unencrypted and they told us well for the purpose of your testing we",
    "start": "936650",
    "end": "943640"
  },
  {
    "text": "disabled it but trust us it's usually 10 a root but it's just has been turned off",
    "start": "943640",
    "end": "950900"
  },
  {
    "text": "for the testing derive your conclusions in any case in this scenario the foreign",
    "start": "950900",
    "end": "957620"
  },
  {
    "text": "provider entity might be involved in the encrypted channel of LS which say",
    "start": "957620",
    "end": "966200"
  },
  {
    "text": "depending on lawful interception requests our staff might be in the very interests of the foreign provider but",
    "start": "966200",
    "end": "974050"
  },
  {
    "text": "from those to say architectures this one is much more prevalent all this is still",
    "start": "974050",
    "end": "980960"
  },
  {
    "text": "a bit des in a bit in the beginning and",
    "start": "980960",
    "end": "986030"
  },
  {
    "text": "in mobile networks so this is more prevalent but from say certain entities",
    "start": "986030",
    "end": "995510"
  },
  {
    "text": "perspective this might be much more interesting for say lawful interception",
    "start": "995510",
    "end": "1001570"
  },
  {
    "text": "and stuff so we will see this at some point probably this is what we expect in",
    "start": "1001570",
    "end": "1007980"
  },
  {
    "start": "1006000",
    "end": "1069000"
  },
  {
    "text": "between those components in a Terkel world with all which all have their",
    "start": "1007980",
    "end": "1014110"
  },
  {
    "text": "specific names there are types of interactions and these interactions are bound to so-called interfaces those",
    "start": "1014110",
    "end": "1019570"
  },
  {
    "text": "interfaces don't have to be but in some cases are actually separate physical",
    "start": "1019570",
    "end": "1025449"
  },
  {
    "text": "interfaces it's more or less about logical structuring once this component",
    "start": "1025449",
    "end": "1031209"
  },
  {
    "text": "talks to this one let's call this the interface used let's give this a",
    "start": "1031209",
    "end": "1036790"
  },
  {
    "text": "specific name as opposed to another interchange between components and the one that is of most interest for us is",
    "start": "1036790",
    "end": "1043990"
  },
  {
    "text": "called s 6a that's the one that is used between the mm II and the HSS the mm II",
    "start": "1043990",
    "end": "1050770"
  },
  {
    "text": "and a roaming scenario is located in a providers network that's the one taking extra care of the the setup of the call",
    "start": "1050770",
    "end": "1057830"
  },
  {
    "text": "but this Mme has to talk to a home providers HSS to find out is this a",
    "start": "1057830",
    "end": "1064750"
  },
  {
    "text": "available user what about the charging and so on yeah so um as for the base",
    "start": "1064750",
    "end": "1074300"
  },
  {
    "start": "1069000",
    "end": "1232000"
  },
  {
    "text": "diameter protocol used and specified in the RFC the diameter header looks much",
    "start": "1074300",
    "end": "1080870"
  },
  {
    "text": "like this so we've got a version length and some flags but very interesting",
    "start": "1080870",
    "end": "1087590"
  },
  {
    "text": "important ear is the so called application ID the application ID determines we on which interface for",
    "start": "1087590",
    "end": "1095090"
  },
  {
    "text": "once this diameter message is used on and also it targets a specific",
    "start": "1095090",
    "end": "1100690"
  },
  {
    "text": "application on the receiving side so you might have an application for s 6 a the",
    "start": "1100690",
    "end": "1107410"
  },
  {
    "text": "roaming interface which then again supports specific commands so you also",
    "start": "1107410",
    "end": "1114590"
  },
  {
    "text": "got the field command code here so that on on the target of the application you",
    "start": "1114590",
    "end": "1121730"
  },
  {
    "text": "can execute different commands like please have me over this phone script or keys or please register this phone now",
    "start": "1121730",
    "end": "1129530"
  },
  {
    "text": "as available in my network then you will find in the base protocol the two fields",
    "start": "1129530",
    "end": "1136790"
  },
  {
    "text": "the two identifiers the so-called hop-by-hop and end-to-end identifiers which will play an important role in the",
    "start": "1136790",
    "end": "1144530"
  },
  {
    "text": "hole diameter routing scenario so the end-to-end identifier is used to",
    "start": "1144530",
    "end": "1152150"
  },
  {
    "text": "determine both end points of a diameter routed message so that a message that is",
    "start": "1152150",
    "end": "1159470"
  },
  {
    "text": "received on one side can find it its path back to the to the other side so",
    "start": "1159470",
    "end": "1164720"
  },
  {
    "text": "the answer to that message and the hop-by-hop identifier then is used also",
    "start": "1164720",
    "end": "1170720"
  },
  {
    "text": "in diameter routing but between different time it routers so they each",
    "start": "1170720",
    "end": "1176540"
  },
  {
    "text": "time it a router on the way of a message sets up like a small routing entry for",
    "start": "1176540",
    "end": "1181880"
  },
  {
    "text": "that specific path the message takes and registers the",
    "start": "1181880",
    "end": "1187160"
  },
  {
    "text": "I hop and enter and identifiers and with this table it can look up the path back for the answer message this will play an",
    "start": "1187160",
    "end": "1193820"
  },
  {
    "text": "important role because what this implies is that we don't need any more",
    "start": "1193820",
    "end": "1198890"
  },
  {
    "text": "information we do not need any IP addresses we do not need any host names all so far to receive an answer to any",
    "start": "1198890",
    "end": "1206510"
  },
  {
    "text": "diameter message we will send out so after this common diameter header and",
    "start": "1206510",
    "end": "1213020"
  },
  {
    "text": "there are some a VPS which are just fields that can be used that can be",
    "start": "1213020",
    "end": "1219980"
  },
  {
    "text": "attached to your message and they will be used in in regards to the application",
    "start": "1219980",
    "end": "1226580"
  },
  {
    "text": "your target and the command you will execute okay so just to show you what",
    "start": "1226580",
    "end": "1235490"
  },
  {
    "start": "1232000",
    "end": "1357000"
  },
  {
    "text": "one of these diameter messages looks in Wireshark this is one of the most basic ones it's just an device watchdog",
    "start": "1235490",
    "end": "1243110"
  },
  {
    "text": "request which uses the application ID 0 this is all this application also",
    "start": "1243110",
    "end": "1248930"
  },
  {
    "text": "specified by the RFC and it's just - this message will be sent out frequently",
    "start": "1248930",
    "end": "1256370"
  },
  {
    "text": "just to check if the other peer is still available or not you see the both",
    "start": "1256370",
    "end": "1263510"
  },
  {
    "text": "identifiers in here as this is a handcrafted example message they are",
    "start": "1263510",
    "end": "1269420"
  },
  {
    "text": "just very nice to remember numbers and",
    "start": "1269420",
    "end": "1275020"
  },
  {
    "text": "also you see - a VPS included here those",
    "start": "1275020",
    "end": "1280460"
  },
  {
    "text": "- a B piece you will find in every diameter message it's the origin host and the origin realm so this more or",
    "start": "1280460",
    "end": "1288320"
  },
  {
    "text": "less says identifies the sender of this message you see both of these fields",
    "start": "1288320",
    "end": "1295100"
  },
  {
    "text": "have an have an host name like content",
    "start": "1295100",
    "end": "1300610"
  },
  {
    "text": "the format of this host name is very well defined so it always ends with EPC",
    "start": "1300610",
    "end": "1309320"
  },
  {
    "text": "Evolved Packet co dot mobile network code dot mobile country code 3gpp",
    "start": "1309320",
    "end": "1314390"
  },
  {
    "text": "networks comm talk I'm sorry the hostname in the beginning the",
    "start": "1314390",
    "end": "1320540"
  },
  {
    "text": "provider can choose for its own but yeah most of the time they're not very",
    "start": "1320540",
    "end": "1325850"
  },
  {
    "text": "complex it it will be like HSS or Mme one enemy two and so forth okay also you",
    "start": "1325850",
    "end": "1334760"
  },
  {
    "text": "got the origin realm which is more or less just the the last part of the",
    "start": "1334760",
    "end": "1341920"
  },
  {
    "text": "origin host so this just says this message origins from this network okay",
    "start": "1341920",
    "end": "1352160"
  },
  {
    "text": "so so far for the basic diameter message",
    "start": "1352160",
    "end": "1357820"
  },
  {
    "start": "1357000",
    "end": "1545000"
  },
  {
    "text": "as we mainly focused on the s6 a roaming interface we read the specification and",
    "start": "1357820",
    "end": "1366320"
  },
  {
    "text": "it turns out there is a limited number of messages specific for this",
    "start": "1366320",
    "end": "1372830"
  },
  {
    "text": "application they're all used in the roaming context and some of them expose",
    "start": "1372830",
    "end": "1379430"
  },
  {
    "text": "some quite sensitive data like for example the authentication information request will give you all the crypto",
    "start": "1379430",
    "end": "1386960"
  },
  {
    "text": "keys and authentication information for a SIM card so we focus on a mainly on",
    "start": "1386960",
    "end": "1395750"
  },
  {
    "text": "this set of messages and just to show you one example of those the I just",
    "start": "1395750",
    "end": "1402920"
  },
  {
    "text": "talked about the authentication information request this is what you see",
    "start": "1402920",
    "end": "1408080"
  },
  {
    "text": "here so it also has the the common diameter header in front you see the",
    "start": "1408080",
    "end": "1415070"
  },
  {
    "text": "targeted application is s6 a and it has",
    "start": "1415070",
    "end": "1420290"
  },
  {
    "text": "quite a lot of a BPS attached to it so you see this one has different every",
    "start": "1420290",
    "end": "1427640"
  },
  {
    "text": "piece that the message before for once it has a session ID very important so",
    "start": "1427640",
    "end": "1434690"
  },
  {
    "text": "the receiving host can determine different sessions originating from your diameter host then it has some user data",
    "start": "1434690",
    "end": "1443690"
  },
  {
    "text": "like the username it wants to receive authentication information for this is just an MC",
    "start": "1443690",
    "end": "1450530"
  },
  {
    "text": "and also there are some other values",
    "start": "1450530",
    "end": "1455720"
  },
  {
    "text": "like the visited PLM NID which in fact signals from which network the or to",
    "start": "1455720",
    "end": "1464750"
  },
  {
    "text": "which network the ue wants to attach to and then you will find again the origin",
    "start": "1464750",
    "end": "1472430"
  },
  {
    "text": "host origin realm and destination rail notice that the in there is no",
    "start": "1472430",
    "end": "1478460"
  },
  {
    "text": "destination host entry because yeah maybe me as a foreign target at work I",
    "start": "1478460",
    "end": "1485000"
  },
  {
    "text": "do not know the host name off of the HSS I want to contact I just want to know I",
    "start": "1485000",
    "end": "1490730"
  },
  {
    "text": "need to attach to this network the phone wants to attach to MCC 262 MNC is 0-1 so",
    "start": "1490730",
    "end": "1500660"
  },
  {
    "text": "how do I know which HSS to contact I do not know so I will just throw out a",
    "start": "1500660",
    "end": "1506330"
  },
  {
    "text": "diameter message targeting a destination realm so I'm just want to reach the Evolved Packet core of MNC 0 1 MCC",
    "start": "1506330",
    "end": "1516110"
  },
  {
    "text": "2 6 2 in this case yeah okay so I do not",
    "start": "1516110",
    "end": "1527960"
  },
  {
    "text": "need a host name I just throw out a diameter message and through diameter routing this message will magically find",
    "start": "1527960",
    "end": "1534620"
  },
  {
    "text": "its way to the right destination host amazing isn't it ok we will come back to",
    "start": "1534620",
    "end": "1542090"
  },
  {
    "text": "this nice routing feature later but for",
    "start": "1542090",
    "end": "1547940"
  },
  {
    "start": "1545000",
    "end": "1684000"
  },
  {
    "text": "now we should just take a moment and think about the text we can derive from",
    "start": "1547940",
    "end": "1553550"
  },
  {
    "text": "maybe SS 7 so when looking at diameter especially when comparing comparing it",
    "start": "1553550",
    "end": "1559790"
  },
  {
    "text": "to SS 7 given diameter as the successor of so7 when it comes to the main",
    "start": "1559790",
    "end": "1568070"
  },
  {
    "text": "signaling functions most of the say",
    "start": "1568070",
    "end": "1573590"
  },
  {
    "text": "attacks which have been possible in SS 7 provided you had the right position the network have an equivalent in the",
    "start": "1573590",
    "end": "1582530"
  },
  {
    "text": "diameter world you might have noticed when Danielle showed the the Wireshark screams there",
    "start": "1582530",
    "end": "1591440"
  },
  {
    "text": "wasn't really something on authentication actually diameter can be",
    "start": "1591440",
    "end": "1596720"
  },
  {
    "text": "authenticated by means of certificates but those of you who are familiar with",
    "start": "1596720",
    "end": "1602000"
  },
  {
    "text": "certificates and their operational implications might have an idea how much",
    "start": "1602000",
    "end": "1607190"
  },
  {
    "text": "this is used actually it's not used that much to put it politely so there is no",
    "start": "1607190",
    "end": "1615740"
  },
  {
    "text": "built-in authentication there is some reliance on the two things as well turn",
    "start": "1615740",
    "end": "1624590"
  },
  {
    "text": "out some checking of the so-called host origin and maybe as Daniel mentioned a",
    "start": "1624590",
    "end": "1631520"
  },
  {
    "text": "certain sense of say hiding functions not exposing host names or things like",
    "start": "1631520",
    "end": "1638900"
  },
  {
    "text": "that in any case from an abstract perspective most of the problems which have existed",
    "start": "1638900",
    "end": "1645680"
  },
  {
    "text": "in as a seven before still exist - mostly the same degree in diameter and",
    "start": "1645680",
    "end": "1654020"
  },
  {
    "text": "there might be even new problems during security testing in different particular",
    "start": "1654020",
    "end": "1660410"
  },
  {
    "text": "environments we identified it's a relatively newer technology so you can",
    "start": "1660410",
    "end": "1665660"
  },
  {
    "text": "identify implementation flaws you can identify errors in the way how say",
    "start": "1665660",
    "end": "1672680"
  },
  {
    "text": "specifications were transmitted into specific implementations so there is",
    "start": "1672680",
    "end": "1680660"
  },
  {
    "text": "even even newer stuff but let's focus on the on the old stuff first and as a",
    "start": "1680660",
    "end": "1687530"
  },
  {
    "start": "1684000",
    "end": "1735000"
  },
  {
    "text": "seven depending on the security objectives one has in mind from a",
    "start": "1687530",
    "end": "1693080"
  },
  {
    "text": "subscribers perspective the privacy of whether of the subscribers location is a",
    "start": "1693080",
    "end": "1700310"
  },
  {
    "text": "quite quite important no objective that one saying as a seven it was possible to",
    "start": "1700310",
    "end": "1707300"
  },
  {
    "text": "track subscribers at the same as possible in both diameter as well by means of a specific message the idea the",
    "start": "1707300",
    "end": "1716900"
  },
  {
    "text": "the hours our request is beta and my",
    "start": "1716900",
    "end": "1722900"
  },
  {
    "text": "potato realist okay using this message one can still pull or try to get hold of",
    "start": "1722900",
    "end": "1730790"
  },
  {
    "text": "the the axle cell ID where a specific subscriber is located interception then",
    "start": "1730790",
    "end": "1738170"
  },
  {
    "start": "1735000",
    "end": "1796000"
  },
  {
    "text": "that might be actually a bit more difficult as one has to keep in mind diameter is just used for a control",
    "start": "1738170",
    "end": "1744530"
  },
  {
    "text": "plane for the signaling there is no actual data transport across diameter so even if one manages to say to interfere",
    "start": "1744530",
    "end": "1752330"
  },
  {
    "text": "above diameter this doesn't mean one is able to interfere with the actual voice and message traffic of a specific user",
    "start": "1752330",
    "end": "1759710"
  },
  {
    "text": "to do so one would still need say a local effect base station attack type to",
    "start": "1759710",
    "end": "1768320"
  },
  {
    "text": "get hold of the traffic and then as the the worst traffic is there was",
    "start": "1768320",
    "end": "1775730"
  },
  {
    "text": "encryption already over the our interface one has to get hold of the key",
    "start": "1775730",
    "end": "1781400"
  },
  {
    "text": "material of the specific SIM card identified by the MC and the HC HSS",
    "start": "1781400",
    "end": "1789380"
  },
  {
    "text": "holding this which then can be accessed for food diameter potentially so two",
    "start": "1789380",
    "end": "1795770"
  },
  {
    "text": "things have to be combined this might be particularly interesting in when you",
    "start": "1795770",
    "end": "1802429"
  },
  {
    "text": "recall this home ims was as the local breakout i am a scenario one some key",
    "start": "1802429",
    "end": "1810980"
  },
  {
    "text": "material is used for or is reused so for the encryption of the actual RTP traffic",
    "start": "1810980",
    "end": "1820100"
  },
  {
    "text": "for the for a voice over IP over LTE connection from it might be very",
    "start": "1820100",
    "end": "1827480"
  },
  {
    "text": "interesting for somebody who wants to get the actual content of a communication to get hold of this key",
    "start": "1827480",
    "end": "1834620"
  },
  {
    "text": "material which is where the difference comes into play does it terminate in the",
    "start": "1834620",
    "end": "1839990"
  },
  {
    "text": "home network does say the RTP and and thing happened in there in",
    "start": "1839990",
    "end": "1846740"
  },
  {
    "text": "the remote network from from again lawful interception perspective ii might",
    "start": "1846740",
    "end": "1852290"
  },
  {
    "text": "be much more interesting for specific for certain countries also if you do the",
    "start": "1852290",
    "end": "1857450"
  },
  {
    "start": "1855000",
    "end": "1898000"
  },
  {
    "text": "the local break out scenario for voice of IP roaming you would need to expose",
    "start": "1857450",
    "end": "1862730"
  },
  {
    "text": "more diameter applications to the IPX interface so from that perspective you",
    "start": "1862730",
    "end": "1868190"
  },
  {
    "text": "with just widen your attack surface from from an opera or ideas perspective one",
    "start": "1868190",
    "end": "1874070"
  },
  {
    "text": "of the main risks is billing fraud a diameter might come into play here we",
    "start": "1874070",
    "end": "1881330"
  },
  {
    "text": "played around with this but we weren't actually able to to come up with with",
    "start": "1881330",
    "end": "1887630"
  },
  {
    "text": "walking attacks but let's say it's it's there were some similarities so ii as a",
    "start": "1887630",
    "end": "1894170"
  },
  {
    "text": "seven namely when it comes to the so-called charging profiles of subscribers a denial of service of",
    "start": "1894170",
    "end": "1900790"
  },
  {
    "start": "1898000",
    "end": "1949000"
  },
  {
    "text": "various kinds might be possible once one is able to interfere with diameter first",
    "start": "1900790",
    "end": "1906650"
  },
  {
    "text": "one can easily say modify the information where a ue a specific phone",
    "start": "1906650",
    "end": "1913280"
  },
  {
    "text": "is located so that phone wouldn't get any any data or calls any longer this is focused on the phone and once one can",
    "start": "1913280",
    "end": "1920420"
  },
  {
    "text": "talk diameter to two components one can come up with sending malformed messages",
    "start": "1920420",
    "end": "1927530"
  },
  {
    "text": "in all this we did some testing here but the specific turbo environments where we",
    "start": "1927530",
    "end": "1933860"
  },
  {
    "text": "were walking on this we're very cautious when it came to well you guys sending",
    "start": "1933860",
    "end": "1939740"
  },
  {
    "text": "multiple packages even in in test environments and this wasn't very",
    "start": "1939740",
    "end": "1945080"
  },
  {
    "text": "welcomed but there will be some functionality in the tool which you will see in a second",
    "start": "1945080",
    "end": "1950270"
  },
  {
    "start": "1949000",
    "end": "2054000"
  },
  {
    "text": "the main limitation from say attackers perspective is that we've in diameter",
    "start": "1950270",
    "end": "1957140"
  },
  {
    "text": "there's the concept of this host origin like who is the actual originator of of",
    "start": "1957140",
    "end": "1962420"
  },
  {
    "text": "a specific type of message which was within the the header of the diameter",
    "start": "1962420",
    "end": "1968630"
  },
  {
    "text": "messages and components involved in these exchanges can actually check does",
    "start": "1968630",
    "end": "1974960"
  },
  {
    "text": "the specific message come from from a legitimate kind of counterpart in",
    "start": "1974960",
    "end": "1983210"
  },
  {
    "text": "the sense of like an HSS this central user authentication database receiving a",
    "start": "1983210",
    "end": "1990020"
  },
  {
    "text": "diameter message my check Oh dusters really come from an mme as is usually over the so-called interface essex a",
    "start": "1990020",
    "end": "1996950"
  },
  {
    "text": "it's supposed to talk to enemies in either the local or foreign networks but",
    "start": "1996950",
    "end": "2004600"
  },
  {
    "text": "so there is this kind of checking i wouldn't really call it authentication",
    "start": "2004600",
    "end": "2010750"
  },
  {
    "text": "but say identification a point is some just as well you can easily be set on",
    "start": "2010750",
    "end": "2018390"
  },
  {
    "text": "overridden by the SE by an attacker so just us depending on a way how it's",
    "start": "2018390",
    "end": "2024490"
  },
  {
    "text": "implemented that might not really health and there is not much checking on this",
    "start": "2024490",
    "end": "2029560"
  },
  {
    "text": "from our experience anyway as the hole diameter thing especially happening",
    "start": "2029560",
    "end": "2036610"
  },
  {
    "text": "between different providers and happening through an IP x is complex in itself and the most number of people we",
    "start": "2036610",
    "end": "2044050"
  },
  {
    "text": "know don't really like to touch it like well this might break something let's leave it as is so there is not much",
    "start": "2044050",
    "end": "2052480"
  },
  {
    "text": "checking on the only host origin from our experience in summary before going",
    "start": "2052480",
    "end": "2057520"
  },
  {
    "text": "to the more like practical part doing the same exercise as was done for as a",
    "start": "2057520",
    "end": "2062770"
  },
  {
    "text": "seven we can kind of map say specific message types to specific attack types",
    "start": "2062770",
    "end": "2069970"
  },
  {
    "text": "and this table gives an indication which messages might be particularly interesting when being sent to a",
    "start": "2069970",
    "end": "2076600"
  },
  {
    "text": "specific entity there was some there was",
    "start": "2076600",
    "end": "2081730"
  },
  {
    "text": "one for example for in the indiana does some space down at the the table there",
    "start": "2081730",
    "end": "2088690"
  },
  {
    "text": "said the ideas are message which is the kind of reset or which HSS can send to",
    "start": "2088690",
    "end": "2094389"
  },
  {
    "text": "the mme like oh I'm undergoing a say a reward please dear Mme Mme cancel all active",
    "start": "2094390",
    "end": "2102300"
  },
  {
    "text": "connections so if one would be able to say spoof and inject that one obviously",
    "start": "2102300",
    "end": "2107740"
  },
  {
    "text": "it could cause significant harm to say the least and so now on the",
    "start": "2107740",
    "end": "2115539"
  },
  {
    "start": "2113000",
    "end": "2278000"
  },
  {
    "text": "more practical part yeah so what we've seen is that the originating host",
    "start": "2115539",
    "end": "2122190"
  },
  {
    "text": "especially the Mme host names are kind of kept the only secret within the",
    "start": "2122190",
    "end": "2129069"
  },
  {
    "text": "diameter communication so if I know the mm is hostname and UE is attached to I",
    "start": "2129069",
    "end": "2137319"
  },
  {
    "text": "can just use that host name and inject messages like like I can drop that UE I",
    "start": "2137319",
    "end": "2147099"
  },
  {
    "text": "can modify some forwarding data of that UE and so forth so the the hostname is a",
    "start": "2147099",
    "end": "2154359"
  },
  {
    "text": "very important part in this role and that's why a lot of people in the",
    "start": "2154359",
    "end": "2160750"
  },
  {
    "text": "diameter will talk about topology and topology hiding what's mean by this is",
    "start": "2160750",
    "end": "2166030"
  },
  {
    "text": "that as I showed before you do not expose host names at all so you don't",
    "start": "2166030",
    "end": "2173049"
  },
  {
    "text": "have to file like like you have an sa-7",
    "start": "2173049",
    "end": "2179710"
  },
  {
    "text": "yet to file a page which specifies all your components with my global title you do not have such a thing in diameter",
    "start": "2179710",
    "end": "2187150"
  },
  {
    "text": "if you want to reach a certain application you just target the",
    "start": "2187150",
    "end": "2193079"
  },
  {
    "text": "destination origin you do not target hosts in particular the rest is taken care of by diameter routing diameter",
    "start": "2193079",
    "end": "2200020"
  },
  {
    "text": "routing notes okay you want it to target as six a with function X I need to route that message over there so that's why I",
    "start": "2200020",
    "end": "2209529"
  },
  {
    "text": "do not need to expose your host names and why a lot of people try to keep their host names especially the Mme host",
    "start": "2209529",
    "end": "2216460"
  },
  {
    "text": "names secret and there is also technical feature called topology hiding which is",
    "start": "2216460",
    "end": "2221619"
  },
  {
    "text": "a component right at your diameter border to the IPX which randomizes host",
    "start": "2221619",
    "end": "2228460"
  },
  {
    "text": "names incoming and outgoing which by the way I do not think is a is a good thing",
    "start": "2228460",
    "end": "2234760"
  },
  {
    "text": "to do because you know you need to keep state tables and with long host name entries and state tables used to",
    "start": "2234760",
    "end": "2241420"
  },
  {
    "text": "overflow and it's just saying so like a lot of people",
    "start": "2241420",
    "end": "2250280"
  },
  {
    "text": "wanted to keep their host name secret but there are ways to leak certain host",
    "start": "2250280",
    "end": "2256730"
  },
  {
    "text": "names I did not find one for an attached Mme right now but you can like leak host",
    "start": "2256730",
    "end": "2263420"
  },
  {
    "text": "names of HSS really easily yeah also",
    "start": "2263420",
    "end": "2268580"
  },
  {
    "text": "most of the time those host names follow a certain naming scheme so if you can",
    "start": "2268580",
    "end": "2274970"
  },
  {
    "text": "guess them you're also good yeah of",
    "start": "2274970",
    "end": "2280280"
  },
  {
    "start": "2278000",
    "end": "2327000"
  },
  {
    "text": "course host name spoofing pretty easy you can just put into the origin host",
    "start": "2280280",
    "end": "2285710"
  },
  {
    "text": "whatever you like there is no checking of this value ever I can also when I'm talking to you why",
    "start": "2285710",
    "end": "2294230"
  },
  {
    "text": "are my ex I can spoof your internal hosts so if you do not have any fencing",
    "start": "2294230",
    "end": "2300530"
  },
  {
    "text": "fancy diameter routing rules the message will just reach a target the target has no chance to determine me from the",
    "start": "2300530",
    "end": "2307510"
  },
  {
    "text": "originating host and will just accept the message and also I will get the",
    "start": "2307510",
    "end": "2312860"
  },
  {
    "text": "answer back not the real host because we have those fancy hop-by-hop an",
    "start": "2312860",
    "end": "2318140"
  },
  {
    "text": "end-to-end identify us so that's that's really comfortable spoofing in diameter",
    "start": "2318140",
    "end": "2324230"
  },
  {
    "text": "is very nice okay what you could do to",
    "start": "2324230",
    "end": "2330680"
  },
  {
    "start": "2327000",
    "end": "2386000"
  },
  {
    "text": "prevent the bad attacks here is just cross-checking values within the",
    "start": "2330680",
    "end": "2337640"
  },
  {
    "text": "diameter messages like there is this PLM an idea showed you before maybe also",
    "start": "2337640",
    "end": "2343310"
  },
  {
    "text": "struggled while I was reading out the destination host because the PLM NIT and",
    "start": "2343310",
    "end": "2349340"
  },
  {
    "text": "the destination host name did not match they were targeting different mobile",
    "start": "2349340",
    "end": "2354890"
  },
  {
    "text": "country codes so you could cross-check those values to make sure a message is",
    "start": "2354890",
    "end": "2360350"
  },
  {
    "text": "silly trim it and also if you keep state of your phones so if you know a phone is",
    "start": "2360350",
    "end": "2367880"
  },
  {
    "text": "attached to a certain network and suddenly and a different network asks",
    "start": "2367880",
    "end": "2373910"
  },
  {
    "text": "for information about that phone already to you network you can just drop the message but that's quite complicated",
    "start": "2373910",
    "end": "2380369"
  },
  {
    "text": "because you need to keep track of the state of you ease okay so I did write",
    "start": "2380369",
    "end": "2389070"
  },
  {
    "start": "2386000",
    "end": "2605000"
  },
  {
    "text": "the tool for all of this we were talking about it's called diameter enum it's",
    "start": "2389070",
    "end": "2395700"
  },
  {
    "text": "written in Python this time which is way more easy than dealing with with the ss7 stuff",
    "start": "2395700",
    "end": "2401609"
  },
  {
    "text": "it's build around lip diameter which I took from PI proto sim kudos it will be",
    "start": "2401609",
    "end": "2409380"
  },
  {
    "text": "released under the bsd license and yeah it's used to send out the amita messages",
    "start": "2409380",
    "end": "2416760"
  },
  {
    "text": "to an DRA to a diameter route so what you will need is a diameter router to",
    "start": "2416760",
    "end": "2422070"
  },
  {
    "text": "send your messages to and the best way this diameter rod also is has some path",
    "start": "2422070",
    "end": "2428400"
  },
  {
    "text": "to IP x and if it has you will be able to reach any diameter node out there so",
    "start": "2428400",
    "end": "2438420"
  },
  {
    "text": "yes this tool as the so7 mapper implements probe packages for the at",
    "start": "2438420",
    "end": "2445950"
  },
  {
    "text": "least the text we have discovered also i try to implement probe messages for",
    "start": "2445950",
    "end": "2452070"
  },
  {
    "text": "every defined diameter message out there I'm not quite finished but I'm I'm going",
    "start": "2452070",
    "end": "2458430"
  },
  {
    "text": "there and the tool is mainly used to check your own diameter set up to check",
    "start": "2458430",
    "end": "2465510"
  },
  {
    "text": "your diameter routing setup and your if you have one diameter firewall if there",
    "start": "2465510",
    "end": "2470609"
  },
  {
    "text": "is any configuration issue or which functionality is exposed to IP x the",
    "start": "2470609",
    "end": "2479250"
  },
  {
    "text": "tool also also features and diameter application scanner which I will show in a second",
    "start": "2479250",
    "end": "2484440"
  },
  {
    "text": "so you can for once determine which",
    "start": "2484440",
    "end": "2491100"
  },
  {
    "text": "application is exposed on a given host name and secondly you can figure out if",
    "start": "2491100",
    "end": "2499560"
  },
  {
    "text": "you're leaving the destination host out you can just enumerate applications let",
    "start": "2499560",
    "end": "2506160"
  },
  {
    "text": "diameter routing do its magic get answering hostname spec so you can",
    "start": "2506160",
    "end": "2511960"
  },
  {
    "text": "map the internal topology okay the tool",
    "start": "2511960",
    "end": "2518680"
  },
  {
    "text": "can be downloaded here in about 30 minutes and it will also be released on",
    "start": "2518680",
    "end": "2524529"
  },
  {
    "text": "github soon take your photos",
    "start": "2524529",
    "end": "2534269"
  },
  {
    "text": "okay it it needs a configuration file so",
    "start": "2538729",
    "end": "2543749"
  },
  {
    "text": "I do not overflow the command line with with arguments because you need to",
    "start": "2543749",
    "end": "2548969"
  },
  {
    "text": "specify quite a few values like the origin host and origin realm you want to use the destination host and destination",
    "start": "2548969",
    "end": "2555809"
  },
  {
    "text": "realm you wanted to target also for the ease of use you will specify your",
    "start": "2555809",
    "end": "2561539"
  },
  {
    "text": "outgoing IP address in here you have",
    "start": "2561539",
    "end": "2566940"
  },
  {
    "text": "some like values like the product name to include in the diameter messages this",
    "start": "2566940",
    "end": "2572339"
  },
  {
    "text": "could be very helpful if you want to to sort out the messages like out of your",
    "start": "2572339",
    "end": "2578940"
  },
  {
    "text": "log files afterwards to see yes that was the testing that was not in real attack and for the 3gpp world you need to",
    "start": "2578940",
    "end": "2586650"
  },
  {
    "text": "specify a whole bunch of messages in here like your fake mobile network code",
    "start": "2586650",
    "end": "2593039"
  },
  {
    "text": "your fake mobile country code the MC you're targeting with some messages the",
    "start": "2593039",
    "end": "2598079"
  },
  {
    "text": "PLM and I do you want to use in there and so forth and so on",
    "start": "2598079",
    "end": "2603049"
  },
  {
    "text": "okay so let's go on to it unfortunately I cannot show you to read stuff as I do",
    "start": "2604969",
    "end": "2611759"
  },
  {
    "start": "2605000",
    "end": "2844000"
  },
  {
    "text": "not have a link to IP X here so that's why I need to do my demo locally and it",
    "start": "2611759",
    "end": "2618029"
  },
  {
    "text": "will not be that astonishing so my local",
    "start": "2618029",
    "end": "2625200"
  },
  {
    "text": "setup is I have a free diameter running on my notebook this free diameter",
    "start": "2625200",
    "end": "2630509"
  },
  {
    "text": "exposes some applications and also exposes some functionality on these",
    "start": "2630509",
    "end": "2636420"
  },
  {
    "text": "applications so now I just want to check",
    "start": "2636420",
    "end": "2641519"
  },
  {
    "text": "oh I can show you the configuration file",
    "start": "2641519",
    "end": "2649170"
  },
  {
    "text": "which is just this so I have there my",
    "start": "2649170",
    "end": "2656400"
  },
  {
    "text": "origin host and realm destination host and realm I have the IP address I'm using and so forth also you can specify",
    "start": "2656400",
    "end": "2664769"
  },
  {
    "text": "different values for different interfaces your testing but I mean I'll not use that in the demo",
    "start": "2664769",
    "end": "2671250"
  },
  {
    "text": "okay so now I want to know which applications are exposed by my local",
    "start": "2671250",
    "end": "2676710"
  },
  {
    "text": "diameter host and I'm just doing an initial capability exchange that one is",
    "start": "2676710",
    "end": "2684840"
  },
  {
    "text": "printed so you will see all the IP addresses the host is exposing in this",
    "start": "2684840",
    "end": "2691740"
  },
  {
    "text": "case as free diameter is very very torquey it also gives you the",
    "start": "2691740",
    "end": "2697320"
  },
  {
    "text": "application it exposes but this values does not need to to match the real",
    "start": "2697320",
    "end": "2702830"
  },
  {
    "text": "applications exposed and afterwards I just enumerate over all the application",
    "start": "2702830",
    "end": "2708720"
  },
  {
    "text": "IDs and look if there now I'm using an invalid command ID so if the application",
    "start": "2708720",
    "end": "2716280"
  },
  {
    "text": "is reachable it will answer with an error code command unsupported but that",
    "start": "2716280",
    "end": "2721950"
  },
  {
    "text": "tells me okay the application is available otherwise I would get back an application under unavailable or and",
    "start": "2721950",
    "end": "2729920"
  },
  {
    "text": "routing a lookup mismatch so I'm doing",
    "start": "2729920",
    "end": "2735000"
  },
  {
    "text": "the scanning once with an explicit destination host so targeting one host seeing what applications are exposed",
    "start": "2735000",
    "end": "2741450"
  },
  {
    "text": "there and the second time I do it without the destination host so I'm just",
    "start": "2741450",
    "end": "2746880"
  },
  {
    "text": "giving a destination realm which means magic diameter routing is taking place",
    "start": "2746880",
    "end": "2752820"
  },
  {
    "text": "and you will you might get back answers from different hosts and also see",
    "start": "2752820",
    "end": "2759630"
  },
  {
    "text": "different applications okay so once I",
    "start": "2759630",
    "end": "2767640"
  },
  {
    "text": "know which applications are exposed I can then just start the command in",
    "start": "2767640",
    "end": "2774869"
  },
  {
    "text": "numeration which will go through every implemented command and try to deliver",
    "start": "2774869",
    "end": "2781740"
  },
  {
    "text": "them and we will see like okay I have an accounting application running so the",
    "start": "2781740",
    "end": "2788099"
  },
  {
    "text": "accounting requests will succeed I now know this is functionality exposed by",
    "start": "2788099",
    "end": "2794160"
  },
  {
    "text": "the diameter host also the offer made an",
    "start": "2794160",
    "end": "2800160"
  },
  {
    "text": "authentication information request we have seen in the example before is not exposed so that's a good thing",
    "start": "2800160",
    "end": "2806490"
  },
  {
    "text": "and going through all these messages you could check if your diameter routing is",
    "start": "2806490",
    "end": "2813390"
  },
  {
    "text": "correct if your exposure to IP X is the has the least footprint it need to have",
    "start": "2813390",
    "end": "2819059"
  },
  {
    "text": "and yeah you could play some other nasty tricks like spoofing your origin host or",
    "start": "2819059",
    "end": "2827700"
  },
  {
    "text": "a region realm and yeah let's say it like this with a with a bit of config",
    "start": "2827700",
    "end": "2834510"
  },
  {
    "text": "tuning you can use the tool to to perform most of the attacks we talked",
    "start": "2834510",
    "end": "2840109"
  },
  {
    "text": "okay before we go on to that slide time is a quick comment at this point you",
    "start": "2843770",
    "end": "2849900"
  },
  {
    "start": "2844000",
    "end": "3038000"
  },
  {
    "text": "might ask well some of you might actually recall very early talks from Daniel and and I when we had had at this",
    "start": "2849900",
    "end": "2857250"
  },
  {
    "text": "point like a slide okay there are so many exposed hosts in the Internet here's some numbers here are some",
    "start": "2857250",
    "end": "2863640"
  },
  {
    "text": "geographical distribution of those this part is missing here for a reason",
    "start": "2863640",
    "end": "2869849"
  },
  {
    "text": "nowadays we consider it within W at least debatable if not unethical to do a",
    "start": "2869849",
    "end": "2876440"
  },
  {
    "text": "large-scale internet scanning for the simple reason that you touch other systems other people's systems without",
    "start": "2876440",
    "end": "2884220"
  },
  {
    "text": "usually being authorized to do so so research projects within W which include",
    "start": "2884220",
    "end": "2890910"
  },
  {
    "text": "this part of scanning have to go for the internal ethics committee and this",
    "start": "2890910",
    "end": "2896069"
  },
  {
    "text": "effort wasn't undertaken here so I don't have numbers for you but I like to let",
    "start": "2896069",
    "end": "2902069"
  },
  {
    "text": "you know I mean diameter is it's all IP its part thirty ip68",
    "start": "2902069",
    "end": "2910890"
  },
  {
    "text": "it might be implemented over HTTP so your favorite scanning tool might not walk it's just we don't do the scanning",
    "start": "2910890",
    "end": "2917880"
  },
  {
    "text": "for you and you might come up with like oh why not just ask showdown well then",
    "start": "2917880",
    "end": "2924960"
  },
  {
    "text": "it's delegating the Delhi the dirty here from our perspective unethical work to somebody else which doesn't make it",
    "start": "2924960",
    "end": "2931290"
  },
  {
    "text": "better so no numbers at this point feel free to drive your",
    "start": "2931290",
    "end": "2936450"
  },
  {
    "text": "derive your own conclusions again its IP it has a 1 on part so you might be able",
    "start": "2936450",
    "end": "2944310"
  },
  {
    "text": "to identify systems and of course you would only do so once you're authorized",
    "start": "2944310",
    "end": "2949830"
  },
  {
    "text": "to do to do it in your own say environment and your own engagement",
    "start": "2949830",
    "end": "2955130"
  },
  {
    "text": "context that's at interesting enough four weeks ago the GSMA the GSM",
    "start": "2955130",
    "end": "2962490"
  },
  {
    "text": "Association which is the kind of Association of mobile network operators",
    "start": "2962490",
    "end": "2967860"
  },
  {
    "text": "then released a document called guidelines for independent independent",
    "start": "2967860",
    "end": "2973650"
  },
  {
    "text": "remote security testing that I think I was somewhat referring to two minutes",
    "start": "2973650",
    "end": "2980130"
  },
  {
    "text": "ago remote security testing it has a section on responsibilities of testers",
    "start": "2980130",
    "end": "2986820"
  },
  {
    "text": "which i think is very important some especially given there were small",
    "start": "2986820",
    "end": "2992490"
  },
  {
    "text": "research nowadays on stuff like this and the operators are a bit concerned that this research might lead to negative",
    "start": "2992490",
    "end": "3000610"
  },
  {
    "text": "impact on the availability of course systems the thing is this document",
    "start": "3000610",
    "end": "3007250"
  },
  {
    "text": "mostly focuses on as a 7 but has some diameter content in this as well and the",
    "start": "3007250",
    "end": "3015650"
  },
  {
    "text": "tool the diameter enum pretty much does a number of things that the GSMA",
    "start": "3015650",
    "end": "3024020"
  },
  {
    "text": "guideline actually recommends operators doing so if there are people from",
    "start": "3024020",
    "end": "3029870"
  },
  {
    "text": "operators in the room you can use diameter enum to do specifically what is",
    "start": "3029870",
    "end": "3035690"
  },
  {
    "text": "recommended and this document this document has a lot of content on different topics I will skip this in the",
    "start": "3035690",
    "end": "3043610"
  },
  {
    "start": "3038000",
    "end": "3044000"
  },
  {
    "text": "interest of time and let's discuss very briefly say what this means as which",
    "start": "3043610",
    "end": "3052340"
  },
  {
    "start": "3044000",
    "end": "3207000"
  },
  {
    "text": "which type of recommendations are advised we have four operators given",
    "start": "3052340",
    "end": "3058250"
  },
  {
    "text": "well diameter is not exactly new but it's somewhat there is not like 20 years",
    "start": "3058250",
    "end": "3064250"
  },
  {
    "text": "operational experience and with diameter there was a number of say dynamic",
    "start": "3064250",
    "end": "3070380"
  },
  {
    "text": "to us in it there was his own routing there was all the say requirements which",
    "start": "3070380",
    "end": "3077970"
  },
  {
    "text": "derive from doing from offering ip-based",
    "start": "3077970",
    "end": "3083130"
  },
  {
    "text": "packet based services in a global say in a global setting so the first and",
    "start": "3083130",
    "end": "3089730"
  },
  {
    "text": "foremost advice from our perspective would be try to understand this world of",
    "start": "3089730",
    "end": "3096000"
  },
  {
    "text": "diameter applications which components actually offer which type of applications which messages they need",
    "start": "3096000",
    "end": "3103950"
  },
  {
    "text": "what does might mean from a security perspective understandably the security objectives of a subscriber of a",
    "start": "3103950",
    "end": "3110370"
  },
  {
    "text": "subscriber might be different from the one from an operator but try to understand the the picture and what this",
    "start": "3110370",
    "end": "3117030"
  },
  {
    "text": "means establish visibility in the sense of one sustained dimensions once a ue is",
    "start": "3117030",
    "end": "3123780"
  },
  {
    "text": "attached to a specific network and there is diameter messages turning up",
    "start": "3123780",
    "end": "3129060"
  },
  {
    "text": "concerning this we from a different network obviously this should raise",
    "start": "3129060",
    "end": "3134940"
  },
  {
    "text": "suspicion and there was a number of other things message types which are not intended to be processed by specific",
    "start": "3134940",
    "end": "3142760"
  },
  {
    "text": "applications and actually you see this stuff not much of it but once you look closely you can see stuff like this",
    "start": "3142760",
    "end": "3149670"
  },
  {
    "text": "happening and in some of the operator networks we have been we've been working",
    "start": "3149670",
    "end": "3155370"
  },
  {
    "text": "on so first and foremost establish visibility monitor for for known attacks",
    "start": "3155370",
    "end": "3162000"
  },
  {
    "text": "monitor for specific message types and once you have a clear understanding we suggest thinking about is there anything",
    "start": "3162000",
    "end": "3169230"
  },
  {
    "text": "you can do on the relationship between the origin host where does the message come from and what does the message",
    "start": "3169230",
    "end": "3175830"
  },
  {
    "text": "actually intend to to achieve or to perform like the terrorist stuff coming",
    "start": "3175830",
    "end": "3182010"
  },
  {
    "text": "in on the from an IP X from one of these exchange networks when it enters your",
    "start": "3182010",
    "end": "3187530"
  },
  {
    "text": "own network your own own rhythm and has an Origin host in it which doesn't",
    "start": "3187530",
    "end": "3193740"
  },
  {
    "text": "belong to a network obviously something is wrong so this on a very basic and high-level perspective what would be",
    "start": "3193740",
    "end": "3201300"
  },
  {
    "text": "what we want to give us as advice for the of you involved in operator networks",
    "start": "3201300",
    "end": "3207330"
  },
  {
    "start": "3207000",
    "end": "3306000"
  },
  {
    "text": "which brings us to the conclusions um as a self owner abilities or well yeah",
    "start": "3207330",
    "end": "3215200"
  },
  {
    "text": "let's get let's call them abilities aspects of signaling which can lead to unintended outcome but this type of",
    "start": "3215200",
    "end": "3223480"
  },
  {
    "text": "things continue to exist with diameter as the diameter as the successor",
    "start": "3223480",
    "end": "3229210"
  },
  {
    "text": "implements the same functions diameter the moral te deployments one sees the",
    "start": "3229210",
    "end": "3237700"
  },
  {
    "text": "morphology has used the more important diameter becomes so it's growing and",
    "start": "3237700",
    "end": "3243010"
  },
  {
    "text": "it's important and that's why we think it's helpful to be able to perform",
    "start": "3243010",
    "end": "3249370"
  },
  {
    "text": "security research on it which is the reason why diameter enum was written and it's released today",
    "start": "3249370",
    "end": "3258780"
  },
  {
    "text": "before you ask some of you might know us and we have a reputation Danielle and I",
    "start": "3258780",
    "end": "3265870"
  },
  {
    "text": "are doing a passing of network protocols actually there's a number of all thoughts on from us on passing all types",
    "start": "3265870",
    "end": "3274960"
  },
  {
    "text": "of protocols edenia has developed a known phasing safe framework called",
    "start": "3274960",
    "end": "3280060"
  },
  {
    "text": "dizzy so you might ask the story following fuzzing functionality in",
    "start": "3280060",
    "end": "3287200"
  },
  {
    "text": "diameter enum not yet but I think there will be at some point you might say",
    "start": "3287200",
    "end": "3296860"
  },
  {
    "text": "follow what's happening on insinuate on the block or when it comes to diameter",
    "start": "3296860",
    "end": "3302410"
  },
  {
    "text": "and diameter you know that's it from our side thank you for your time",
    "start": "3302410",
    "end": "3308910"
  },
  {
    "start": "3306000",
    "end": "3580000"
  },
  {
    "text": "and I think we have like 10 minutes for Q&A 5 okay there was a question over",
    "start": "3313800",
    "end": "3319570"
  },
  {
    "text": "there yeah there was actually somebody's coming hi",
    "start": "3319570",
    "end": "3330880"
  },
  {
    "text": "very cool interesting topics question first of all that local environment you",
    "start": "3330880",
    "end": "3336460"
  },
  {
    "text": "were showing before in the demo is kind of available somehow will be available yeah it's free diameter instance cool",
    "start": "3336460",
    "end": "3344200"
  },
  {
    "text": "Google free diameter and you will find it you will struggle a bit with the set up but it's a kind of use with down good",
    "start": "3344200",
    "end": "3350320"
  },
  {
    "text": "stuff but yeah for us a certain Napa at some point we release but not with the",
    "start": "3350320",
    "end": "3362140"
  },
  {
    "text": "testing environment yeah but at some point there might be like a full-blown cool given with the other tool as a",
    "start": "3362140",
    "end": "3370030"
  },
  {
    "text": "seven map huh I would say 80% of the comments on the block like oh I've just problem setting",
    "start": "3370030",
    "end": "3376089"
  },
  {
    "text": "it up can you help me or not yeah something anyway but all available",
    "start": "3376089",
    "end": "3382680"
  },
  {
    "text": "implemented on your own cool thanks second question is a bit sort of compliant as I noticed now in",
    "start": "3382680",
    "end": "3391380"
  },
  {
    "text": "2017 as a seven and all the other new technologies like before glt technology",
    "start": "3391380",
    "end": "3397390"
  },
  {
    "text": "are still vulnerable now comes to comes to me a question GSM if we go back home",
    "start": "3397390",
    "end": "3403869"
  },
  {
    "text": "to G to G is like 30 years old 1987 was the developed the first version of the",
    "start": "3403869",
    "end": "3410020"
  },
  {
    "text": "spec so is 30 years old right now and from 2g until LTE we faced many",
    "start": "3410020",
    "end": "3416500"
  },
  {
    "text": "vulnerabilities one thing that came up to my mind was a 5-2 that the stream",
    "start": "3416500",
    "end": "3423460"
  },
  {
    "text": "cipher that was weakened on purpose to be delivered and install on networks",
    "start": "3423460",
    "end": "3429520"
  },
  {
    "text": "that were non-nato countries so that was sort of like pushed by governments this",
    "start": "3429520",
    "end": "3436950"
  },
  {
    "text": "weekend weekend algorithm so now my idea is after 30 years of non poner ability",
    "start": "3436950",
    "end": "3445359"
  },
  {
    "text": "how is possible that 3gpp organization or GSMA organization was unable to",
    "start": "3445359",
    "end": "3451749"
  },
  {
    "text": "design proper safe protocols or if they",
    "start": "3451749",
    "end": "3458109"
  },
  {
    "text": "try to design because you know failing is possible is possible so who is default mainly 3gpp organizations yes",
    "start": "3458109",
    "end": "3464859"
  },
  {
    "text": "any organization your organization or telco engineers please talk to engineers",
    "start": "3464859",
    "end": "3469869"
  },
  {
    "text": "here don't be angry at me or technical engineers failing on you know applying",
    "start": "3469869",
    "end": "3476079"
  },
  {
    "text": "proper you know the deploying proper networks like for example you mentioned certificates I'm pretty sure that not",
    "start": "3476079",
    "end": "3483489"
  },
  {
    "text": "many net mobile network operators are using you know the the highest define",
    "start": "3483489",
    "end": "3491219"
  },
  {
    "text": "solutions security solutions for one type of protocol or interface so if is",
    "start": "3491219",
    "end": "3496539"
  },
  {
    "text": "not 3gpp or techo engineers are government states that are doing the",
    "start": "3496539",
    "end": "3502029"
  },
  {
    "text": "same thing of a52 so pushing for keeping weak go ahead and think it's it's a lot",
    "start": "3502029",
    "end": "3507819"
  },
  {
    "text": "of governments because they have lawful interception anyways yeah so they already have have the possibility to get",
    "start": "3507819",
    "end": "3514509"
  },
  {
    "text": "in there to get all the data they need I think if you want to blame anyone or anything you should blame the complexity",
    "start": "3514509",
    "end": "3521319"
  },
  {
    "text": "of the technology okay again the thing is in theory most of the standards and I",
    "start": "3521319",
    "end": "3526930"
  },
  {
    "text": "mean for a five to there's a 5-3 in theory most of the standards from",
    "start": "3526930",
    "end": "3531940"
  },
  {
    "text": "security perspective reasonable reasonable specifications and it could",
    "start": "3531940",
    "end": "3539349"
  },
  {
    "text": "be done but there was also there's always like operational reality yeah and",
    "start": "3539349",
    "end": "3544440"
  },
  {
    "text": "operational reality that kicks kicks in",
    "start": "3544440",
    "end": "3549759"
  },
  {
    "text": "and given the complexity there's all types of trade-offs and there has been so far for many decades that the",
    "start": "3549759",
    "end": "3557859"
  },
  {
    "text": "thinking of a walled garden like it's only telcos interacting across specific interfaces and as history has shown this",
    "start": "3557859",
    "end": "3565029"
  },
  {
    "text": "assumption might not always be valid cool thank you",
    "start": "3565029",
    "end": "3570989"
  },
  {
    "text": "any other questions and thank you again",
    "start": "3571280",
    "end": "3576900"
  },
  {
    "text": "and have a great Leggett [Applause]",
    "start": "3576900",
    "end": "3582340"
  }
]