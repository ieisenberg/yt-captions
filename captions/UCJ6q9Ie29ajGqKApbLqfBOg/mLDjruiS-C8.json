[
  {
    "text": "so this is our this is the title of our talk that we are going to do today dude what",
    "start": "160",
    "end": "5520"
  },
  {
    "text": "the in my can we did uh do a similar talk in defcon last year",
    "start": "5520",
    "end": "11599"
  },
  {
    "text": "but uh in that in that talk in the delphi defcon we were more focused in the kalin",
    "start": "11599",
    "end": "18480"
  },
  {
    "text": "protocol okay in that case we're going to be completely focused in the canvas protocol that is used within the",
    "start": "18480",
    "end": "26320"
  },
  {
    "text": "the cars nowadays so",
    "start": "26320",
    "end": "31679"
  },
  {
    "text": "first of all typical slides about introducing ourselves who are we okay so here's javier",
    "start": "31679",
    "end": "39840"
  },
  {
    "text": "we are from spain that's the strange thing that you can notice in my accent",
    "start": "39840",
    "end": "46000"
  },
  {
    "text": "so uh yeah he's a hardware security specialist and uh he loves breaking toys he's",
    "start": "46000",
    "end": "53760"
  },
  {
    "text": "all the day with the dirty hands with all toys around him and yeah there is no day",
    "start": "53760",
    "end": "61120"
  },
  {
    "text": "that i don't speak with him and he said oh alberto i found a new thing in this new device and blah blah blah blah blah so yeah",
    "start": "61120",
    "end": "68400"
  },
  {
    "text": "he's  crazy of her and he's from cadiz have you ever been in spain",
    "start": "68400",
    "end": "75360"
  },
  {
    "text": "someone of you yeah okay why are you here instead of being in spain right now",
    "start": "75360",
    "end": "80960"
  },
  {
    "text": "so caddis is in the south of spain really really south of spain and yeah they have great parties",
    "start": "80960",
    "end": "89040"
  },
  {
    "text": "actually and i'm alberto",
    "start": "89040",
    "end": "95759"
  },
  {
    "text": "and i'm a pen tester i work for a huge for a big company cloud company",
    "start": "95759",
    "end": "104479"
  },
  {
    "text": "so yeah most of my time i work in a red team so my day-to-day is very offensive and i",
    "start": "104479",
    "end": "111680"
  },
  {
    "text": "love breaking everything hardware software i like reversing i like this either you",
    "start": "111680",
    "end": "119040"
  },
  {
    "text": "guys my girlfriend so yeah i like this kind of things",
    "start": "119040",
    "end": "124640"
  },
  {
    "text": "so have you seen where we are right now where have you have you stayed in the",
    "start": "124640",
    "end": "131200"
  },
  {
    "text": "swimming pool have you been in the swimming pool who have been in the swimming pool already",
    "start": "131200",
    "end": "137520"
  },
  {
    "text": "only so okay so that's my question for you today if you know that this is the swimming",
    "start": "137840",
    "end": "144720"
  },
  {
    "text": "pool that we have just going through the elevator why are you here",
    "start": "144720",
    "end": "151760"
  },
  {
    "text": "i mean really so why are you here today right now instead",
    "start": "151760",
    "end": "157680"
  },
  {
    "text": "of being in the swimming pool and with this brilliant",
    "start": "157680",
    "end": "162720"
  },
  {
    "text": "girls okay so that's the okay cool",
    "start": "162720",
    "end": "169120"
  },
  {
    "text": "that's the um the index those are the topics that we're going to speak about today",
    "start": "169120",
    "end": "174400"
  },
  {
    "text": "we're going to just do a small remind about kalyn and we're going to speak about what is",
    "start": "174400",
    "end": "181200"
  },
  {
    "text": "the common things that we can buy today very i mean not not cheap not cheap at all but we",
    "start": "181200",
    "end": "188480"
  },
  {
    "text": "can buy some hardware to interact to it with our car so we can do some stuff but",
    "start": "188480",
    "end": "195760"
  },
  {
    "text": "for us that was not enough right so we just wanted to do something cheaper very cheaper very cheap sorry",
    "start": "195760",
    "end": "203680"
  },
  {
    "text": "and um being able to exploit as much as possible i mean",
    "start": "203680",
    "end": "210239"
  },
  {
    "text": "speaking against the network itself not like just some parts of the car so",
    "start": "210239",
    "end": "217519"
  },
  {
    "text": "we we developed and we made a piece of hardware that we have right here it is called",
    "start": "217519",
    "end": "224840"
  },
  {
    "text": "chd car hacking tool yeah it's not very original i know but",
    "start": "224840",
    "end": "231599"
  },
  {
    "text": "yeah we will speak about it what are the features that we have how can we speak directly with the with",
    "start": "231599",
    "end": "237680"
  },
  {
    "text": "the cambus network and everything one of the most important things",
    "start": "237680",
    "end": "242720"
  },
  {
    "text": "in my opinion at least is the statistical analysis because we will see later but each car",
    "start": "242720",
    "end": "248640"
  },
  {
    "text": "is a different world it's a completely different world even being the same brand even using the same",
    "start": "248640",
    "end": "254159"
  },
  {
    "text": "brand of cars it's going to be diff it's going to be completely different the packets that the car sent",
    "start": "254159",
    "end": "259440"
  },
  {
    "text": "the ecu sent between within the campus network are completely different even",
    "start": "259440",
    "end": "266080"
  },
  {
    "text": "being the same model but different year the packets are different so that's something we have to deal",
    "start": "266080",
    "end": "272800"
  },
  {
    "text": "about and we did we figured out some kind of statistical",
    "start": "272800",
    "end": "278000"
  },
  {
    "text": "analysis to just go through it yeah we did um kind of attack take over we",
    "start": "278000",
    "end": "284720"
  },
  {
    "text": "called takeover to you we'll see you later and we are going to speak some car forensics",
    "start": "284720",
    "end": "290960"
  },
  {
    "text": "ah yeah i have this windows here but i'm used to yeah so okay yeah um",
    "start": "290960",
    "end": "298240"
  },
  {
    "text": "this is the typical picture that everybody used when it's gonna speak about ecu's so basically uh all the cars are like a",
    "start": "298240",
    "end": "307600"
  },
  {
    "text": "subnet of use it's like our car our house our office that we have different",
    "start": "307600",
    "end": "313280"
  },
  {
    "text": "devices connected to a gateway or something in that case the devices are connected",
    "start": "313280",
    "end": "318800"
  },
  {
    "text": "it's a broadcast network okay so yeah there are tons of different",
    "start": "318800",
    "end": "324160"
  },
  {
    "text": "ecu's within a car a lot of different ecu's all the easy user sending packets most of the time like",
    "start": "324160",
    "end": "332080"
  },
  {
    "text": "even all the milliseconds every millisecond we're gonna have some ecu sending a bunch of packets that we",
    "start": "332080",
    "end": "339440"
  },
  {
    "text": "want to interpret we want to know what these packets do and just try to do",
    "start": "339440",
    "end": "344800"
  },
  {
    "text": "something with them that we will see okay so",
    "start": "344800",
    "end": "352960"
  },
  {
    "text": "now about the issues themselves uh it is common that they have a set of unique ids uds are usually",
    "start": "352960",
    "end": "360880"
  },
  {
    "text": "attached on the can bus not on k line not to a specific issue but",
    "start": "360880",
    "end": "367440"
  },
  {
    "text": "to a function that we could say an id is broadcasting the current engine rpms another is",
    "start": "367440",
    "end": "374639"
  },
  {
    "text": "broadcasting the speed so maybe some data there are requests so",
    "start": "374639",
    "end": "380479"
  },
  {
    "text": "there is a unique id for each uh we'll call it like a type of data service request",
    "start": "380479",
    "end": "388080"
  },
  {
    "text": "sometimes it's shared between ecus but this is just for the canvas since we can have a same request from",
    "start": "388080",
    "end": "395520"
  },
  {
    "text": "different ecu's um then when we talk about security uh to modify the firmware on them",
    "start": "395520",
    "end": "402560"
  },
  {
    "text": "usually if you want to do it the legit way they have some authentication method a",
    "start": "402560",
    "end": "407759"
  },
  {
    "text": "seed key to prevent the unauthorized manipulation",
    "start": "407759",
    "end": "412800"
  },
  {
    "text": "of the firmware and most of the times they have some diagnostics data stored",
    "start": "412800",
    "end": "419440"
  },
  {
    "text": "in them sometimes in their prone sometimes in the flash either for diagnosis or",
    "start": "419440",
    "end": "427919"
  },
  {
    "text": "just for determining how the behavior of that ecu depending on which",
    "start": "429199",
    "end": "434479"
  },
  {
    "text": "one is should be like then just a quick thing we talked about",
    "start": "434479",
    "end": "442880"
  },
  {
    "text": "the differences between compass and k-line k-lang is mainly diagnostics oriented so not much or any data at all is being",
    "start": "442880",
    "end": "450400"
  },
  {
    "text": "broadcasted on it it's cheap it works on 12 volts it's basically a new word but level shifted",
    "start": "450400",
    "end": "455919"
  },
  {
    "text": "to 12 bus due to the length of the wires the speed is usually 250 can reach that",
    "start": "455919",
    "end": "462400"
  },
  {
    "text": "but it's lower most of the times 250 would be like some bench so i mean like taking the ecu out of the",
    "start": "462400",
    "end": "468800"
  },
  {
    "text": "car itself but the canvas well actually it was",
    "start": "468800",
    "end": "474479"
  },
  {
    "text": "discontinued somewhere around 2010 i stopped seeing it on the cars just the",
    "start": "474479",
    "end": "480800"
  },
  {
    "text": "canvas was there so compass is really old it's nothing new i think it's from the 80s indeed",
    "start": "480800",
    "end": "486319"
  },
  {
    "text": "but they call it like the future technology that's okay",
    "start": "486319",
    "end": "490960"
  },
  {
    "text": "speed should be higher like one megabit per second actually it's slower because there are lots of uh",
    "start": "491520",
    "end": "497599"
  },
  {
    "text": "ecu's broadcast in there so it gets quite slower when you want to do some heavy communicating",
    "start": "497599",
    "end": "503680"
  },
  {
    "text": "the frame length the payload is just eight bits where k length was up to two for",
    "start": "503680",
    "end": "508800"
  },
  {
    "text": "54 bits uh byte sorry so still you need to send more frames to",
    "start": "508800",
    "end": "515120"
  },
  {
    "text": "get the thing so it's it's better for the noise immunity stuff but it's not good for the speed and well we",
    "start": "515120",
    "end": "522240"
  },
  {
    "text": "said on defcon that it requires pensive handware not anymore",
    "start": "522240",
    "end": "529760"
  },
  {
    "text": "so maybe you have seen this somewhere this was the subject of our talk uh",
    "start": "530720",
    "end": "537200"
  },
  {
    "text": "defcon and at black hat arsenal as well in vegas this is the ecu too",
    "start": "537200",
    "end": "542480"
  },
  {
    "text": "we've been further developing some features for it it started as a static firmware and we",
    "start": "542480",
    "end": "548640"
  },
  {
    "text": "developed a library for the klan we added some functions basically what could be done with the",
    "start": "548640",
    "end": "556000"
  },
  {
    "text": "main firmware but now you can just make your own custom firmware using the calls",
    "start": "556000",
    "end": "561839"
  },
  {
    "text": "in that library and we are updating it since we are using it for developing the main firmware for it",
    "start": "561839",
    "end": "569360"
  },
  {
    "text": "for free we will give you the link for that",
    "start": "569440",
    "end": "576480"
  },
  {
    "text": "so okay so back to canned data uh as alberto was saying earlier uh",
    "start": "576480",
    "end": "584480"
  },
  {
    "text": "you know people say like yeah can data is like yeah so if you just attached to it it's like uart well actually each car even the same",
    "start": "584480",
    "end": "592000"
  },
  {
    "text": "model from different years have uh different ways of parsing the",
    "start": "592000",
    "end": "597120"
  },
  {
    "text": "data i mean it is not a structure the same way so you cannot like say yeah i can read",
    "start": "597120",
    "end": "602880"
  },
  {
    "text": "canvas data yeah you can read the up to level two but you cannot really parse the data in all the cars",
    "start": "602880",
    "end": "608880"
  },
  {
    "text": "so it's not that universal then uh well it is as well wrongly stated",
    "start": "608880",
    "end": "615040"
  },
  {
    "text": "that can data is plain it's not like you can attach to it and you can read like a speed and two",
    "start": "615040",
    "end": "620560"
  },
  {
    "text": "points and then the speed that's that's what i consider playing so it's not really playing it needs to be",
    "start": "620560",
    "end": "626560"
  },
  {
    "text": "passed still i'm parsing it it's different even from same models different years so",
    "start": "626560",
    "end": "632720"
  },
  {
    "text": "it's might not be encrypted but it's still not playing and as well khan is so secure or",
    "start": "632720",
    "end": "640079"
  },
  {
    "text": "whatever and it's just an oc level one and two how can it be secure it's just you know there's no security",
    "start": "640079",
    "end": "645760"
  },
  {
    "text": "there security should be implemented by the manufacturer itself so it's like saying tcpip is safe",
    "start": "645760",
    "end": "652320"
  },
  {
    "text": "it's nonsense and now this is according to our",
    "start": "652320",
    "end": "659279"
  },
  {
    "text": "experience uh we'll call like there are three kinds of frames inside uh",
    "start": "659279",
    "end": "665760"
  },
  {
    "text": "that goes inside the networks and we'll call them diagnosis frames that are usually generated by",
    "start": "665760",
    "end": "672240"
  },
  {
    "text": "some diagnosis equipment and they can trigger some functions",
    "start": "672240",
    "end": "677839"
  },
  {
    "text": "that usually would not happen in a normal environment inside the car like if you're gonna test for example",
    "start": "677839",
    "end": "684000"
  },
  {
    "text": "the brakes individually you would be pos it would be possible to uh turn on an individual brake on",
    "start": "684000",
    "end": "691839"
  },
  {
    "text": "one wheel or if you want to test the steering wheel it should be possible to move the steering wheel that's diagnostics but usually",
    "start": "691839",
    "end": "699360"
  },
  {
    "text": "well usually you know if it's diagnosis it does not exist within the car itself i mean if you don't have the tool",
    "start": "699360",
    "end": "705040"
  },
  {
    "text": "there's no way you're going to get those packets those commands then uh system commands basically",
    "start": "705040",
    "end": "712399"
  },
  {
    "text": "they're the ones that are uh generated by another ecu i mean like you want to",
    "start": "712399",
    "end": "718480"
  },
  {
    "text": "open your card you push the remote then whatever module we say like okay",
    "start": "718480",
    "end": "724720"
  },
  {
    "text": "i got the request so the lights should turn on that module is sending that frame that",
    "start": "724720",
    "end": "730399"
  },
  {
    "text": "frame would be a system frame because it was not triggered by the user itself but it was triggered by another module",
    "start": "730399",
    "end": "736320"
  },
  {
    "text": "as a consequence for another action so sometimes uh these system commands are the same as",
    "start": "736320",
    "end": "742880"
  },
  {
    "text": "the user once i will talk now or even diagnosis but not every time",
    "start": "742880",
    "end": "748800"
  },
  {
    "text": "then user commands that's pretty straight like you push a button then someone you get that request it",
    "start": "748800",
    "end": "754959"
  },
  {
    "text": "will broadcast the command for that request",
    "start": "754959",
    "end": "760319"
  },
  {
    "text": "now uh elm327 that's the most commonly used ic for",
    "start": "760399",
    "end": "767440"
  },
  {
    "text": "diagnosis it's like you can find it on ebay for 10 euros stuff like that",
    "start": "767440",
    "end": "772560"
  },
  {
    "text": "it supports a lot of uh protocols like yeah the can kwp even the peel switch",
    "start": "772560",
    "end": "778720"
  },
  {
    "text": "modulation which is used on zonal cars so and it's handled by 80 commands i mean",
    "start": "778720",
    "end": "785120"
  },
  {
    "text": "serial that it's easy to implement so",
    "start": "785120",
    "end": "790480"
  },
  {
    "text": "it allows use of an enhanced diagnosis which gives you access to some security",
    "start": "790480",
    "end": "795680"
  },
  {
    "text": "features that's good as well yeah it works on 80 easy to use",
    "start": "795680",
    "end": "801680"
  },
  {
    "text": "but actually i will show it again check the speeds for the canvas just a",
    "start": "801680",
    "end": "808639"
  },
  {
    "text": "standard standard id but 500 kilowatt or 250 kilobyte",
    "start": "808639",
    "end": "813760"
  },
  {
    "text": "so what happens if you want 125 like for example i've seen on some",
    "start": "813760",
    "end": "819600"
  },
  {
    "text": "internal can buses for framework for body what happens with that you cannot use that",
    "start": "819600",
    "end": "825360"
  },
  {
    "text": "or what happens if you have some 800 kilobyte you cannot use it if you need to do something else you",
    "start": "825360",
    "end": "832000"
  },
  {
    "text": "can't so the chd what is it it says somehow we're based",
    "start": "832000",
    "end": "838720"
  },
  {
    "text": "on the arduino mini pro that gets attached to any can bus any speed",
    "start": "838720",
    "end": "844639"
  },
  {
    "text": "the hardware we have brought here is alpha which means it's like uh so-so looking pcb",
    "start": "844639",
    "end": "851760"
  },
  {
    "text": "it's sleep we are always adding new stuff taking other stuff out so we need it to",
    "start": "851760",
    "end": "857440"
  },
  {
    "text": "be a field thing this is actually how it looks i guess",
    "start": "857440",
    "end": "863760"
  },
  {
    "text": "some of you might have seen that photo already but we will see the pcb leave in a few",
    "start": "863760",
    "end": "868839"
  },
  {
    "text": "minutes this is actually a board that is being",
    "start": "868839",
    "end": "874160"
  },
  {
    "text": "developed it supports gsm so you can see the difference in the size when you put everything together in a",
    "start": "874160",
    "end": "880000"
  },
  {
    "text": "two layer pcb it gets way smaller",
    "start": "880000",
    "end": "885839"
  },
  {
    "text": "and we will talk it in a few minutes about it in a few minutes as well we are even developing another board",
    "start": "885920",
    "end": "891519"
  },
  {
    "text": "that has in system firmware update capabilities so you can just attach the device",
    "start": "891519",
    "end": "898160"
  },
  {
    "text": "to whatever forget about it then you develop the framework you want for it and you can upload it remotely",
    "start": "898160",
    "end": "906000"
  },
  {
    "text": "i mean we're using a one euro microcontroller with a remote update for finger so",
    "start": "906000",
    "end": "913839"
  },
  {
    "text": "what does it do well it has some menus we will see as well briefly",
    "start": "914480",
    "end": "919760"
  },
  {
    "text": "in a while so you can set up completely all the features of the canvas interface",
    "start": "919760",
    "end": "926320"
  },
  {
    "text": "it has memory for the options so you don't have to set it up on every startup",
    "start": "926320",
    "end": "932720"
  },
  {
    "text": "well that was obvious it can capture and get canvas data",
    "start": "934240",
    "end": "939360"
  },
  {
    "text": "and when the bus is full at 500 kilowatt bits per second i mean like inter frame",
    "start": "939360",
    "end": "945920"
  },
  {
    "text": "space is the minimum which is like 32 milliseconds if i recall it right",
    "start": "945920",
    "end": "951920"
  },
  {
    "text": "it gets 92 percent of the data that is in the bus which is still good",
    "start": "951920",
    "end": "959440"
  },
  {
    "text": "it can inject errors and manipulate the frames on real time",
    "start": "961360",
    "end": "968560"
  },
  {
    "text": "it can generate an active ids report which means basically that we can see some uh what",
    "start": "968560",
    "end": "974000"
  },
  {
    "text": "ideas are broadcasting not one-time ids for that we use another method",
    "start": "974000",
    "end": "980800"
  },
  {
    "text": "it can perform a really basic analysis of the data that is being transmitted on the bus",
    "start": "980880",
    "end": "985920"
  },
  {
    "text": "like uh if the what's the length of the payload if",
    "start": "985920",
    "end": "991040"
  },
  {
    "text": "it's dynamic static it can store locks that then can be sent",
    "start": "991040",
    "end": "996560"
  },
  {
    "text": "to a backend for some more advanced uh analysis that alberto will talk about in a few minutes",
    "start": "996560",
    "end": "1004240"
  },
  {
    "text": "yeah and uh with additional hardware which is like nothing we will talk about it later you can just update the",
    "start": "1004240",
    "end": "1010160"
  },
  {
    "text": "firmware in fields so you can add new stuff like have different frameworks if you run out of",
    "start": "1010160",
    "end": "1015440"
  },
  {
    "text": "space it's really flexible so the hardware itself",
    "start": "1015440",
    "end": "1024319"
  },
  {
    "text": "but as i said it was just some arduino mini pro some wireless interface it's up to you you can use from",
    "start": "1024319",
    "end": "1030160"
  },
  {
    "text": "bluetooth to gsm this is actually a gsm shield",
    "start": "1030160",
    "end": "1036640"
  },
  {
    "text": "so it costs uh like around 15 euros this is used for development uh in the",
    "start": "1036640",
    "end": "1043199"
  },
  {
    "text": "end product it would be only the white chip we can see here and that costs around seven euros and then",
    "start": "1043199",
    "end": "1050000"
  },
  {
    "text": "you have gsm on the device so it's still not that cheap not expensive it's good",
    "start": "1050000",
    "end": "1056640"
  },
  {
    "text": "and the canvas stuff basically so it's free i mean it's free it's cheap",
    "start": "1056640",
    "end": "1062000"
  },
  {
    "text": "it's very cheap i guess but then as we were talking about uh",
    "start": "1062000",
    "end": "1068000"
  },
  {
    "text": "compass data is not universal so if i want to know how my car works then how could i do",
    "start": "1068000",
    "end": "1077120"
  },
  {
    "text": "that yeah so that's the problem that we were speaking previously it's like okay i have my car my specific model",
    "start": "1078840",
    "end": "1086559"
  },
  {
    "text": "specific gear and i want to know for example what is the payload that i have to send to open the door no",
    "start": "1086559",
    "end": "1094240"
  },
  {
    "text": "some juicy juicy thing open the door or activate i don't know doing some cool stuff",
    "start": "1094240",
    "end": "1102799"
  },
  {
    "text": "so what happened in my specific model how can i know what is the id for my model",
    "start": "1102799",
    "end": "1109600"
  },
  {
    "text": "my brand my gf car that open the doors how can i do it so we thought about a",
    "start": "1109600",
    "end": "1116559"
  },
  {
    "text": "statistical analysis because right now when you do a capture in the cam in the campus uh",
    "start": "1116559",
    "end": "1122080"
  },
  {
    "text": "in the campus bus we just receive tons of packets with",
    "start": "1122080",
    "end": "1128640"
  },
  {
    "text": "different id with different payloads but we don't know what these ideas are doing we don't know what is the",
    "start": "1128640",
    "end": "1134720"
  },
  {
    "text": "the action that is being performed with this id so yeah we we thought about okay let's",
    "start": "1134720",
    "end": "1140720"
  },
  {
    "text": "gonna do some statistical analysis it's gonna think like a car the logical of a car what a car does i",
    "start": "1140720",
    "end": "1147039"
  },
  {
    "text": "mean in what moment do you think that a car is gonna send the packet to open the door",
    "start": "1147039",
    "end": "1152720"
  },
  {
    "text": "at the beginning at the end of the use i think that if you're gonna opening the door you're",
    "start": "1152799",
    "end": "1158000"
  },
  {
    "text": "gonna use it at the beginning of the of the trace of the capture of course",
    "start": "1158000",
    "end": "1163280"
  },
  {
    "text": "it's not going to be at the end because you are supposed to be inside the car it's just if you're riding the car okay so we",
    "start": "1163280",
    "end": "1170480"
  },
  {
    "text": "thought about this kind of things and then we thought about okay so right now what is interesting for us to",
    "start": "1170480",
    "end": "1176559"
  },
  {
    "text": "know exactly what id is performing this specific action so yeah we thought we checked about type",
    "start": "1176559",
    "end": "1183919"
  },
  {
    "text": "of data okay so we wanted to difference between the typical commands like",
    "start": "1183919",
    "end": "1189039"
  },
  {
    "text": "okay the lights are on the lights are on the lights are on the lights are on i don't care about that it's like just status data i don't care",
    "start": "1189039",
    "end": "1196480"
  },
  {
    "text": "at all i want to find commands really actions that we can inject in the in the bus",
    "start": "1196480",
    "end": "1201919"
  },
  {
    "text": "in the network okay so yeah the thing is that uh they're like i told you some random data",
    "start": "1201919",
    "end": "1208559"
  },
  {
    "text": "there are some text zooms and this a lot of so yeah one very important thing is",
    "start": "1208559",
    "end": "1214960"
  },
  {
    "text": "determine the frequency because if i'm sending like a packet saying okay the lights are on the lights",
    "start": "1214960",
    "end": "1220000"
  },
  {
    "text": "are on it's going to be more or less in the same frequency it's not going to be like open the door",
    "start": "1220000",
    "end": "1226240"
  },
  {
    "text": "that id that i did with the payload because i want to remember that",
    "start": "1226240",
    "end": "1231520"
  },
  {
    "text": "a canvas packet a canvas frame has the id and the the payload",
    "start": "1231520",
    "end": "1237600"
  },
  {
    "text": "later okay so some id can be okay the lights are on and the payload can say the light that",
    "start": "1237600",
    "end": "1243760"
  },
  {
    "text": "is on is the light who is in the front of the car or in the front right the front left wherever okay so in that case we want to",
    "start": "1243760",
    "end": "1251200"
  },
  {
    "text": "know the frequency so we can just forget about all the packets that are being sent",
    "start": "1251200",
    "end": "1256559"
  },
  {
    "text": "with the same frequency because that packets are not useful for the things that we want to do",
    "start": "1256559",
    "end": "1263120"
  },
  {
    "text": "so yeah that's the thing determine if it's a command it's only send once so yeah we want this kind of things so",
    "start": "1263120",
    "end": "1270320"
  },
  {
    "text": "yeah the thing about doing the statistical analysis is the improving the comprehensive of the",
    "start": "1270320",
    "end": "1277520"
  },
  {
    "text": "of the of the ideas that are sent in the in the in the network okay that's more or less that's what is",
    "start": "1277520",
    "end": "1283760"
  },
  {
    "text": "the statistical analysis so yeah why we do that obviously it's like",
    "start": "1283760",
    "end": "1288880"
  },
  {
    "text": "the things that i told you like if we can if we want to open the doors we will send that command only once",
    "start": "1288880",
    "end": "1296159"
  },
  {
    "text": "okay we're gonna open the windows for example we're gonna be uh sending some specific id for that",
    "start": "1296159",
    "end": "1303039"
  },
  {
    "text": "just for a specific frame of time okay just a specific",
    "start": "1303039",
    "end": "1308159"
  },
  {
    "text": "time but then it's going to stop so we can think how the car is how is the logical of the",
    "start": "1308159",
    "end": "1314559"
  },
  {
    "text": "car the logic of the car so we can know more or less what packets are for each uh each action",
    "start": "1314559",
    "end": "1322799"
  },
  {
    "text": "so and yeah that's another thing that we saw a lot there are tons of packets that are just the same all the time but with a",
    "start": "1322799",
    "end": "1330080"
  },
  {
    "text": "payload zero for example and in some moment that packet starts being exactly the same same id",
    "start": "1330080",
    "end": "1336720"
  },
  {
    "text": "but the payload is one in some bite so it's like the typical thing like okay",
    "start": "1336720",
    "end": "1342799"
  },
  {
    "text": "my lights i'm going i'm i'm riding the car and my lights are off but it's",
    "start": "1342799",
    "end": "1347919"
  },
  {
    "text": "getting dark so i'm gonna turn on the lights and we said this minimal difference is",
    "start": "1347919",
    "end": "1353840"
  },
  {
    "text": "like the zero to one but the id is the same okay i want to be clear in that like we have the id of the packet",
    "start": "1353840",
    "end": "1359679"
  },
  {
    "text": "and then we have the payload so it doesn't mean that the ids turn on and turn off the lights it's different",
    "start": "1359679",
    "end": "1366640"
  },
  {
    "text": "it can be the same id but with different payload okay and yeah that's another option that is",
    "start": "1366640",
    "end": "1373200"
  },
  {
    "text": "very useful imagine that the car is turned off so the cambus is not sending any any data so that we can",
    "start": "1373200",
    "end": "1380720"
  },
  {
    "text": "do is just just connect our device to the to the cambus network and just",
    "start": "1380720",
    "end": "1388559"
  },
  {
    "text": "send sending send some stupid packet to the to the network the ecu's are",
    "start": "1388559",
    "end": "1394320"
  },
  {
    "text": "gonna receive the packet and i'm gonna i'm gonna start sending some stupid commands like",
    "start": "1394320",
    "end": "1400000"
  },
  {
    "text": "oh what's happening here what is happening here so we can just get a log of all these ideas and say",
    "start": "1400000",
    "end": "1405679"
  },
  {
    "text": "okay i don't care about these ideas in the real capture we're going to say okay we're not going to take in care",
    "start": "1405679",
    "end": "1412240"
  },
  {
    "text": "about those ideas because our ideas of status ids from from the ecu's so",
    "start": "1412240",
    "end": "1420000"
  },
  {
    "text": "we did uh okay you know the arduino that we are using have uh two kilobytes of ram",
    "start": "1420000",
    "end": "1426559"
  },
  {
    "text": "that's like this thing okay it's very cheap that's why we use",
    "start": "1426559",
    "end": "1433760"
  },
  {
    "text": "it and actually we use it too for the challenge of being developing c code even assembly codes eventually",
    "start": "1433760",
    "end": "1440080"
  },
  {
    "text": "because we wouldn't have enough ram memory to recollect all the frames that we were receiving so",
    "start": "1440080",
    "end": "1445840"
  },
  {
    "text": "it's kind of cool just to having to deal with these limitations these limits",
    "start": "1445840",
    "end": "1451760"
  },
  {
    "text": "so yeah we created a website for doing the analysis itself it was impossible to",
    "start": "1451760",
    "end": "1457120"
  },
  {
    "text": "do it in this thing so yeah i it's just",
    "start": "1457120",
    "end": "1462640"
  },
  {
    "text": "easy website use a login you can you can use it i mean we're gonna we're gonna pull this the",
    "start": "1462640",
    "end": "1468240"
  },
  {
    "text": "the website with the code and the code basically that it does is like analysis",
    "start": "1468240",
    "end": "1474000"
  },
  {
    "text": "analysis to the to the data this is our the current analysis",
    "start": "1474000",
    "end": "1479440"
  },
  {
    "text": "that we have already we have four different analysis one of them is just to list the most used id if an id is used",
    "start": "1479440",
    "end": "1487840"
  },
  {
    "text": "so many times it must be probably a stupid idea i mean stupid that i i i",
    "start": "1487840",
    "end": "1494799"
  },
  {
    "text": "did that i don't care an idea of state to status or something like that okay so the other the other the other",
    "start": "1494799",
    "end": "1501279"
  },
  {
    "text": "analysis that we we did is just the periodicity of the active id",
    "start": "1501279",
    "end": "1506640"
  },
  {
    "text": "if an id is being sent all the time the same frequency i don't care about that we're gonna look",
    "start": "1506640",
    "end": "1513039"
  },
  {
    "text": "for commands actual commands of the car like open the door turn off the lights or whatever things",
    "start": "1513039",
    "end": "1518880"
  },
  {
    "text": "that can be interesting and yeah the same thing packet center of our timeline",
    "start": "1518880",
    "end": "1525200"
  },
  {
    "text": "and that is very important a possible match with some commands",
    "start": "1525200",
    "end": "1530559"
  },
  {
    "text": "and not only that there are some packets i mean some frames that the id is the",
    "start": "1530559",
    "end": "1536000"
  },
  {
    "text": "same but the payload it's an incremental byte it have an incremental byte so it's like",
    "start": "1536000",
    "end": "1542640"
  },
  {
    "text": "a b c d e whatever okay it's it's like that all the time i don't",
    "start": "1542640",
    "end": "1549279"
  },
  {
    "text": "care about those packets i'm not gonna be wasting my time taking",
    "start": "1549279",
    "end": "1555760"
  },
  {
    "text": "i mean trying to understand what that packet is going to do because most of the times that packet is not the",
    "start": "1555760",
    "end": "1561679"
  },
  {
    "text": "lovely command that we are looking for so yeah let's gonna do the demo i don't",
    "start": "1561679",
    "end": "1568720"
  },
  {
    "text": "have i hope to have internet here yeah we have",
    "start": "1568720",
    "end": "1574960"
  },
  {
    "text": "actually we that's awful we're connected to a to a net a network wi-fi who was",
    "start": "1574960",
    "end": "1580480"
  },
  {
    "text": "unprotected and it's called black hat asia so please be nice",
    "start": "1580480",
    "end": "1586640"
  },
  {
    "text": "no yeah it's okay i know this is not defcon but i don't",
    "start": "1586640",
    "end": "1593039"
  },
  {
    "text": "believe in you guys don't trust you oh okay so oof that's horrible",
    "start": "1593039",
    "end": "1602559"
  },
  {
    "text": "okay so as alberto was saying uh usually when you see an id that is",
    "start": "1609919",
    "end": "1616000"
  },
  {
    "text": "being sent like overall many times uh it's not interesting",
    "start": "1616000",
    "end": "1621760"
  },
  {
    "text": "but still you should look at the payload because it might be the case that an id is being",
    "start": "1621760",
    "end": "1628880"
  },
  {
    "text": "used for commands and for status reports which would mean if you do a statistical analysis of the whole data",
    "start": "1628880",
    "end": "1635840"
  },
  {
    "text": "and let's say let's keep it like simple there's just one comment uh payload and",
    "start": "1635840",
    "end": "1642720"
  },
  {
    "text": "then there's some fixed payload that will send some",
    "start": "1642720",
    "end": "1648240"
  },
  {
    "text": "status data i don't know let's call it like a so if you're doing a statistical",
    "start": "1648240",
    "end": "1653279"
  },
  {
    "text": "analysis to the whole payloads that are being broadcasted then you will see that 99.999",
    "start": "1653279",
    "end": "1660640"
  },
  {
    "text": "is this static data but there's one payload that will be different that will probably be a command",
    "start": "1660640",
    "end": "1669840"
  },
  {
    "text": "hold on we're having trouble with the",
    "start": "1673360",
    "end": "1676640"
  },
  {
    "text": "wifi",
    "start": "1680840",
    "end": "1683840"
  },
  {
    "text": "yeah yeah we better do that",
    "start": "1688960",
    "end": "1697840"
  },
  {
    "text": "let's see if it works",
    "start": "1707760",
    "end": "1711840"
  },
  {
    "text": "why you do this yeah what about hackers we are",
    "start": "1713919",
    "end": "1719679"
  },
  {
    "text": "the thing sorry yeah there's like it's very a very simple website you can just upload the cam traffic that you can capture with",
    "start": "1721360",
    "end": "1728159"
  },
  {
    "text": "this software i mean with this hardware and they i have i developed some python",
    "start": "1728159",
    "end": "1734240"
  },
  {
    "text": "code that is going to do the um the analysis itself i already have this is awful",
    "start": "1734240",
    "end": "1743600"
  },
  {
    "text": "anyway",
    "start": "1750840",
    "end": "1753840"
  },
  {
    "text": "okay yeah i have already uploaded this okay i",
    "start": "1756320",
    "end": "1763120"
  },
  {
    "text": "can try to upload the the scan i mean the the log that i have but i don't care it's the same so like we",
    "start": "1763120",
    "end": "1770559"
  },
  {
    "text": "can see here we have the this id have been sent like three thousand times the id two three",
    "start": "1770559",
    "end": "1777919"
  },
  {
    "text": "seven we have all the ids okay yeah okay and here we have the interm",
    "start": "1777919",
    "end": "1785440"
  },
  {
    "text": "the interval average okay so this id has been sent is 72 milliseconds",
    "start": "1785440",
    "end": "1790799"
  },
  {
    "text": "so i don't care about this id maybe i care about the ids that are at the bottom",
    "start": "1790799",
    "end": "1798480"
  },
  {
    "text": "here okay maybe those ideas are more interesting maybe those ideas are commands",
    "start": "1799520",
    "end": "1806720"
  },
  {
    "text": "yeah i know that you can maybe not see very well i love colors on these things and then here you have the percentage of",
    "start": "1808320",
    "end": "1815039"
  },
  {
    "text": "the total with the same the ids here you can see actually",
    "start": "1815039",
    "end": "1820480"
  },
  {
    "text": "very easily this id 4 1 b has been sent a lot of time and",
    "start": "1820480",
    "end": "1827440"
  },
  {
    "text": "actually according to our test it has it has a counter an incremental byte so",
    "start": "1827440",
    "end": "1835039"
  },
  {
    "text": "you can see you can see it here in the byte 3 there is an incremental counter so",
    "start": "1835039",
    "end": "1842399"
  },
  {
    "text": "probably this is not important for us actually doing this test we finally got the the packet who was",
    "start": "1842399",
    "end": "1850640"
  },
  {
    "text": "in charge of opening the the door so the door of the car so that's that's nice so yeah go for it",
    "start": "1850640",
    "end": "1858559"
  },
  {
    "text": "no yeah i hate this virtual machines",
    "start": "1858559",
    "end": "1864559"
  },
  {
    "text": "oh yeah okay so basically we know that injection",
    "start": "1864559",
    "end": "1872880"
  },
  {
    "text": "is possible that is nothing new we can log the data that is nothing new so let's talk about",
    "start": "1872880",
    "end": "1880000"
  },
  {
    "text": "attacks actually on canvas so why using attacks like alberto was",
    "start": "1880000",
    "end": "1887360"
  },
  {
    "text": "saying some frames are being sent periodically let's let's see let's start let's get uh stick to the",
    "start": "1887360",
    "end": "1894480"
  },
  {
    "text": "lights we're saying we want to turn off the lights but it comes out that lights are being uh the light the status what",
    "start": "1894480",
    "end": "1901760"
  },
  {
    "text": "they should be is being broadcasted like every 10 milliseconds so if i keep on",
    "start": "1901760",
    "end": "1906960"
  },
  {
    "text": "injecting the lights off then i'm going to have some crazy stuff like lights are going to be like turning",
    "start": "1906960",
    "end": "1913200"
  },
  {
    "text": "on off on off because i'm saying like turn off and the system is saying turn on",
    "start": "1913200",
    "end": "1918720"
  },
  {
    "text": "so after all it's either not gonna work at all or something's gonna smell like fried like",
    "start": "1918720",
    "end": "1923919"
  },
  {
    "text": "magic smoke you know if you make things go like crazy so injection is not like uh yeah it's so easy",
    "start": "1923919",
    "end": "1931039"
  },
  {
    "text": "compassion so you see you just inject data and everything works so wonderful it's not like that exactly and then",
    "start": "1931039",
    "end": "1939519"
  },
  {
    "text": "some modules require some conditions as well like let's say if you want to use the parking",
    "start": "1939919",
    "end": "1946399"
  },
  {
    "text": "brake then the speed should never be higher than zero because you know you cannot use a parking rate at 100 kilometers per",
    "start": "1946399",
    "end": "1952880"
  },
  {
    "text": "hour so then what happens if i want to use it it doesn't work okay yeah sure i can inject the turn on",
    "start": "1952880",
    "end": "1959600"
  },
  {
    "text": "the parking brake but it's not going to happen so still injection is not just like that easy yeah inject",
    "start": "1959600",
    "end": "1965760"
  },
  {
    "text": "stuff so what's the idea take over",
    "start": "1965760",
    "end": "1971840"
  },
  {
    "text": "as we were talking earlier we want to do something about that about not being",
    "start": "1972240",
    "end": "1979200"
  },
  {
    "text": "able to do the stuff so uh we developed an attack that is basically just taking down frames",
    "start": "1979200",
    "end": "1987039"
  },
  {
    "text": "we just take down the frames we want and then we inject our own so and we do it in a way that uh",
    "start": "1987039",
    "end": "1993600"
  },
  {
    "text": "it's not considered like a real error it's just like something weird we will see it in a",
    "start": "1993600",
    "end": "1999279"
  },
  {
    "text": "while so basically what how does it work we select a target id we want to replace",
    "start": "1999279",
    "end": "2004720"
  },
  {
    "text": "we use the chd we attach it it's four wires yes two for the canvas",
    "start": "2004720",
    "end": "2010720"
  },
  {
    "text": "and two four feet if we use a battery then it's just two wires but since it should be possible to have",
    "start": "2010720",
    "end": "2018000"
  },
  {
    "text": "it for long term in the car we are using four wires so",
    "start": "2018000",
    "end": "2024320"
  },
  {
    "text": "then once the id is transmitting we will basically real time read the",
    "start": "2024320",
    "end": "2031440"
  },
  {
    "text": "bits of the id once we see there's a match then we will get",
    "start": "2031440",
    "end": "2037120"
  },
  {
    "text": "we will inject an error so we will put down the frame and then we will inject our own frame and it you know",
    "start": "2037120",
    "end": "2045440"
  },
  {
    "text": "there's some error checking possibilities according to the can uh specifications they are not using it",
    "start": "2045440",
    "end": "2053599"
  },
  {
    "text": "you will see it that just keeps forever trying to transmit",
    "start": "2053599",
    "end": "2058839"
  },
  {
    "text": "uh so well that's basically it why does it work uh due to the",
    "start": "2058839",
    "end": "2065358"
  },
  {
    "text": "arbitration that is used on canvas it is always possible uh to put the bus",
    "start": "2065359",
    "end": "2073679"
  },
  {
    "text": "in a low state which is dominant since that's how arbitration works like many",
    "start": "2073679",
    "end": "2079040"
  },
  {
    "text": "modules are trying to fight to get the id his id then if",
    "start": "2079040",
    "end": "2084638"
  },
  {
    "text": "another module has a lower id which means",
    "start": "2084639",
    "end": "2089679"
  },
  {
    "text": "it's dominant and bitwise then the other one if it's trying to set",
    "start": "2089679",
    "end": "2096240"
  },
  {
    "text": "level high but it reads out level is low it will stop so basically at",
    "start": "2096240",
    "end": "2101280"
  },
  {
    "text": "the point about this is you can set the bus low anytime and",
    "start": "2101280",
    "end": "2106720"
  },
  {
    "text": "as well yeah just for this is as well by specification first thing that is being broadcasted uh",
    "start": "2107680",
    "end": "2114880"
  },
  {
    "text": "well not broadcaster since first thing in the frame in a compass frame is the start bit so when the bus is like silent and i see",
    "start": "2114880",
    "end": "2121920"
  },
  {
    "text": "it's going low i know something's going to happen and then what's the second thing the id so i can",
    "start": "2121920",
    "end": "2129040"
  },
  {
    "text": "just before anything happens i know the id before even i know what's the length of the payload i already know the id",
    "start": "2129040",
    "end": "2135839"
  },
  {
    "text": "so i don't need to wait much more okay i get the id i check it",
    "start": "2135839",
    "end": "2141520"
  },
  {
    "text": "then what's an error we said that we can put the bus in a low state dominant any time",
    "start": "2141520",
    "end": "2148560"
  },
  {
    "text": "and how do you signal an error by putting out the bus for uh 12 bit times",
    "start": "2148560",
    "end": "2155760"
  },
  {
    "text": "so i can inject error anytime it doesn't matter i can always put it down",
    "start": "2155760",
    "end": "2162720"
  },
  {
    "text": "and as well errors actually does they can be reported by",
    "start": "2164160",
    "end": "2170480"
  },
  {
    "text": "their own module on real time since the modules are echoed echoing themselves to check if",
    "start": "2170480",
    "end": "2178240"
  },
  {
    "text": "the data they are trying to pull out is actually making it out to the bus so if they see the data they are trying",
    "start": "2178240",
    "end": "2184400"
  },
  {
    "text": "to pull out it's not making it to the bus they will just signal this error stuff like we can see",
    "start": "2184400",
    "end": "2189920"
  },
  {
    "text": "in this image the on the current rx this is like let's say one model it's reading from the bus on package when it's transmitting",
    "start": "2189920",
    "end": "2196160"
  },
  {
    "text": "it will see its own echo so it is uh it is the one that should inject the",
    "start": "2196160",
    "end": "2201599"
  },
  {
    "text": "error now uh we're using the",
    "start": "2201599",
    "end": "2206880"
  },
  {
    "text": "microchip and ncb2515 yep which has a possibility to signal a",
    "start": "2206880",
    "end": "2214720"
  },
  {
    "text": "start of frame uh so it makes it quite easy",
    "start": "2214720",
    "end": "2219760"
  },
  {
    "text": "to know when a frame is starting but actually due to the fact that its signal is just",
    "start": "2219760",
    "end": "2225839"
  },
  {
    "text": "a 62.5 nanoseconds",
    "start": "2225839",
    "end": "2231520"
  },
  {
    "text": "we had to develop something that was even better we no longer require that",
    "start": "2232000",
    "end": "2237119"
  },
  {
    "text": "so now we're gonna see a demo okay so okay",
    "start": "2237119",
    "end": "2245440"
  },
  {
    "text": "zoom out so basically this is a car ecu this is the subject",
    "start": "2245440",
    "end": "2252480"
  },
  {
    "text": "that we are going to use with the demo logic analyzer we're going to be using to see all the stuff",
    "start": "2252480",
    "end": "2258880"
  },
  {
    "text": "that's one thing we couldn't we tried to bring here a car but it was not possible okay we're sorry",
    "start": "2258880",
    "end": "2264320"
  },
  {
    "text": "about that that's what's the only thing that we can do is like bring in an ecu but we can of",
    "start": "2264320",
    "end": "2269599"
  },
  {
    "text": "course attach to the cambus with this device it's the same as this two two wires that's all",
    "start": "2269599",
    "end": "2277359"
  },
  {
    "text": "well without one ecu well you know it has a few more so and actually this small device",
    "start": "2279920",
    "end": "2288400"
  },
  {
    "text": "is uh something we made uh for as a serial link and for updating",
    "start": "2288400",
    "end": "2295040"
  },
  {
    "text": "the firmware remotely that's it what we were talking about earlier this is a bluetooth module this is an sd",
    "start": "2295040",
    "end": "2301119"
  },
  {
    "text": "card usage buffer and the fancy red light is the arduino yeah",
    "start": "2301119",
    "end": "2306960"
  },
  {
    "text": "we can see your hand yeah so and then this here i'm not going to move it i will take",
    "start": "2306960",
    "end": "2312480"
  },
  {
    "text": "everything apart and we will see it when the demo is done this is the cht that is actually just attached by canvas with these two wires",
    "start": "2312480",
    "end": "2320240"
  },
  {
    "text": "to the ecu and the power supply which has the other two wires so let's get back to the computer",
    "start": "2320240",
    "end": "2329599"
  },
  {
    "text": "hey computer please",
    "start": "2330960",
    "end": "2340320"
  },
  {
    "text": "okay so as i said this is cereal so we're gonna use a serial terminal",
    "start": "2340320",
    "end": "2347520"
  },
  {
    "text": "it's here already okay so we're going to connect to it this is",
    "start": "2348320",
    "end": "2354960"
  },
  {
    "text": "bluetooth actually and then okay let's reset this",
    "start": "2354960",
    "end": "2362078"
  },
  {
    "text": "and now okay we are going to use uh",
    "start": "2362160",
    "end": "2368960"
  },
  {
    "text": "the serial shell so we are gonna reset this",
    "start": "2368960",
    "end": "2374640"
  },
  {
    "text": "okay so basically that is the interface for the chd let's check how",
    "start": "2375119",
    "end": "2381760"
  },
  {
    "text": "the bus looks like before doing anything",
    "start": "2381760",
    "end": "2386240"
  },
  {
    "text": "so one second",
    "start": "2388560",
    "end": "2396320"
  },
  {
    "text": "so yeah we can actually see that frames are being sent",
    "start": "2396320",
    "end": "2401760"
  },
  {
    "text": "like yeah let's zoom it out some frames have been sent there with some ids so i mean like test",
    "start": "2403040",
    "end": "2409599"
  },
  {
    "text": "traffic right yeah so let's say okay we like id 288 for example",
    "start": "2409599",
    "end": "2416640"
  },
  {
    "text": "okay so yeah so you see it's actually just there yeah you can",
    "start": "2416640",
    "end": "2422960"
  },
  {
    "text": "see it quickly i guess the 288 yeah so yeah and you can see how the",
    "start": "2422960",
    "end": "2428319"
  },
  {
    "text": "data looks like yeah we can see some frames it looks so nice so symmetric yeah let's go for it",
    "start": "2428319",
    "end": "2436640"
  },
  {
    "text": "so let's configure this",
    "start": "2436640",
    "end": "2440400"
  },
  {
    "text": "okay so we said two eight eight and let's inject for example one one two",
    "start": "2450160",
    "end": "2456640"
  },
  {
    "text": "two three three okay so let's see what's going on",
    "start": "2456640",
    "end": "2467839"
  },
  {
    "text": "oops now it doesn't look so symmetric like what what's this okay",
    "start": "2469839",
    "end": "2477839"
  },
  {
    "text": "so actually if you see yeah this is stuff down here okay the",
    "start": "2477839",
    "end": "2484880"
  },
  {
    "text": "white one this one indicates that we have detected that start of frame",
    "start": "2484880",
    "end": "2490240"
  },
  {
    "text": "which would be this and then each small one is the bit counting so actually if this doesn't move anymore",
    "start": "2490240",
    "end": "2498079"
  },
  {
    "text": "we can see we're counting the bits in the middle so if we get a match we inject an error",
    "start": "2498079",
    "end": "2505520"
  },
  {
    "text": "so it doesn't make it we're just getting arrows",
    "start": "2505520",
    "end": "2510720"
  },
  {
    "text": "yeah so yeah and uh when we're going to inject our own",
    "start": "2512480",
    "end": "2518160"
  },
  {
    "text": "stuff you know since this is buffered the combat stuff",
    "start": "2518160",
    "end": "2523280"
  },
  {
    "text": "if we were like sending out the frame and it got buffered then we found out that we would put down our",
    "start": "2523280",
    "end": "2529359"
  },
  {
    "text": "own packets so we had to listen as well on our own tx line for the for the canvas and when we",
    "start": "2529359",
    "end": "2536560"
  },
  {
    "text": "detected that the level was low both on txr and rx it would be us trying to send the",
    "start": "2536560",
    "end": "2542400"
  },
  {
    "text": "packet so that's why here we can only see one spike we have detected",
    "start": "2542400",
    "end": "2547440"
  },
  {
    "text": "it's us trying to send the packet so we stopped but actually the ecu was trying to send",
    "start": "2547440",
    "end": "2552720"
  },
  {
    "text": "us well at the same time so we got an error and then we need a little bit more",
    "start": "2552720",
    "end": "2560079"
  },
  {
    "text": "debugging but that one made it through and this was us here with our own payload",
    "start": "2560079",
    "end": "2569280"
  },
  {
    "text": "yeah and you can see that when it's another id it's just skipped",
    "start": "2569280",
    "end": "2576000"
  },
  {
    "text": "like we check it's different we don't put it down so basically every time we detect the",
    "start": "2576640",
    "end": "2581680"
  },
  {
    "text": "other one we just put it down yeah like lots of errors",
    "start": "2581680",
    "end": "2593838"
  },
  {
    "text": "yeah there are a lot of other options you can see in the interface like inject a specific command",
    "start": "2595680",
    "end": "2600880"
  },
  {
    "text": "okay we can just take out a specific id and then we can inject our own id",
    "start": "2600880",
    "end": "2606160"
  },
  {
    "text": "so we can just generate the flights i mean the lights get crazy or something like that",
    "start": "2606160",
    "end": "2611280"
  },
  {
    "text": "imagine that you are what these are the configuration options we were talking about earlier",
    "start": "2611280",
    "end": "2617520"
  },
  {
    "text": "like you know there's some stuff but it's just the basic stuff for the canvas interface",
    "start": "2617520",
    "end": "2623760"
  },
  {
    "text": "yeah the thing that you can do as much as you want your imagination is your limit here and of course it's very very important",
    "start": "2623760",
    "end": "2630480"
  },
  {
    "text": "the uh the statistic analysis very important because we need to know what id is doing a specific task if we don't",
    "start": "2630480",
    "end": "2637040"
  },
  {
    "text": "know that we're going to just do a denial of service to a specific id that we don't know what it's doing",
    "start": "2637040",
    "end": "2643359"
  },
  {
    "text": "can be wrong okay so just change to the",
    "start": "2643359",
    "end": "2648480"
  },
  {
    "text": "and uh well actually uh you know we just saw a small part but uh we did the logic after a while",
    "start": "2648480",
    "end": "2655280"
  },
  {
    "text": "this was working and if you noticed it was still broadcasting",
    "start": "2655280",
    "end": "2660319"
  },
  {
    "text": "on the network i mean when it detects uh up to two five four hours",
    "start": "2660319",
    "end": "2665440"
  },
  {
    "text": "it should stop but it does not stop it just keeps on retrying forever so you can just keep on",
    "start": "2665440",
    "end": "2670880"
  },
  {
    "text": "injecting and putting down frames forever which should not be possible and now",
    "start": "2670880",
    "end": "2676480"
  },
  {
    "text": "about flex rate well that's the filter that's a real filter not canvas that is a recent protocol it supports up to 10",
    "start": "2676480",
    "end": "2683119"
  },
  {
    "text": "megabits per second and the working principle is basically the same as combust",
    "start": "2683119",
    "end": "2688839"
  },
  {
    "text": "arbitration and yeah the idea is at the beginning as well so",
    "start": "2688839",
    "end": "2695039"
  },
  {
    "text": "okay so just uh let's speak a little bit about forensics",
    "start": "2696960",
    "end": "2702400"
  },
  {
    "text": "how can i retrieve the information of a car of a crash in a car of our accident okay so",
    "start": "2702400",
    "end": "2709760"
  },
  {
    "text": "every car have a black box right now nowadays all the cars have a mini black box with information all this",
    "start": "2709760",
    "end": "2716000"
  },
  {
    "text": "information that we are speaking about we can store part of this information in the in this black box",
    "start": "2716000",
    "end": "2722720"
  },
  {
    "text": "this information is usually stored in the airbag ecu okay so we can just try to",
    "start": "2722720",
    "end": "2729200"
  },
  {
    "text": "retrieve this information and we can use that information in court or we can use this information",
    "start": "2729200",
    "end": "2734240"
  },
  {
    "text": "just i don't know just to check we can buy random airbag ecu's and know what happened in the",
    "start": "2734240",
    "end": "2740240"
  },
  {
    "text": "crash of that guy okay so yeah like i told you it's uh it's in",
    "start": "2740240",
    "end": "2746240"
  },
  {
    "text": "the airbag ecu and usually it is a store in the eeprom okay so yeah there's uh there are",
    "start": "2746240",
    "end": "2752640"
  },
  {
    "text": "some software and some hardware that can retrieve this information but usually it's a it's not free actually it's never free",
    "start": "2752640",
    "end": "2762160"
  },
  {
    "text": "so for in this uh in this specific ecu it's the brand is bosch",
    "start": "2762160",
    "end": "2767920"
  },
  {
    "text": "okay the brand of the ecu is bosch and both have a tool who is called",
    "start": "2767920",
    "end": "2774079"
  },
  {
    "text": "yeah have a tool that retrieves the information from uh from my ecu we can retrieve this",
    "start": "2774079",
    "end": "2780160"
  },
  {
    "text": "information in three different ways okay just connecting to the odb port",
    "start": "2780160",
    "end": "2786240"
  },
  {
    "text": "okay and we need authentication we can connect with the airbag module directly so just having the ecu and connect",
    "start": "2786240",
    "end": "2792560"
  },
  {
    "text": "directly to the ecu like we are connecting right now and the other more difficult way",
    "start": "2792560",
    "end": "2800160"
  },
  {
    "text": "is reading directly using the apron reading the apron directly dump the information of the airplane try to parse",
    "start": "2800160",
    "end": "2806560"
  },
  {
    "text": "that information the problem about that is that i mean the good thing about that is that we don't need",
    "start": "2806560",
    "end": "2811760"
  },
  {
    "text": "authentication so that's cool we don't need to just do the seed key that it usually needs to",
    "start": "2811760",
    "end": "2818079"
  },
  {
    "text": "be performed if you want to connect through the odb port or using directly the airbag module",
    "start": "2818079",
    "end": "2824240"
  },
  {
    "text": "so yeah the odb4 is one of the options connecting directly to the ecu is the other option to access to the",
    "start": "2824240",
    "end": "2830480"
  },
  {
    "text": "data who is in the eeprom and the other option is okay i have the apron so that's gonna dump everything so this is the software",
    "start": "2830480",
    "end": "2838240"
  },
  {
    "text": "i told you about software and hardware so it cost like 9 000",
    "start": "2838240",
    "end": "2844160"
  },
  {
    "text": "so yeah we are like students we don't have uh this kind of money so actually",
    "start": "2844160",
    "end": "2850800"
  },
  {
    "text": "we don't load the the the software do you remember yeah we don't load the software yeah go to",
    "start": "2850800",
    "end": "2856559"
  },
  {
    "text": "the other machine that's gonna show everybody the software so they can buy both products",
    "start": "2856559",
    "end": "2863680"
  },
  {
    "text": "yeah that's the software okay yeah let me yeah the boss grass",
    "start": "2864640",
    "end": "2872559"
  },
  {
    "text": "data retrieval tool so the things uh it requires an activation so",
    "start": "2872559",
    "end": "2878559"
  },
  {
    "text": "i just took a look okay and i saw that this waiting for a file with extension",
    "start": "2878559",
    "end": "2883680"
  },
  {
    "text": "extension ctf that was so funny ctf captured the flag yeah i was trying",
    "start": "2883680",
    "end": "2889440"
  },
  {
    "text": "i just generated a random random file in that case this is a random file and",
    "start": "2889440",
    "end": "2895359"
  },
  {
    "text": "open it and i don't know why the calc was executed",
    "start": "2895359",
    "end": "2900640"
  },
  {
    "text": "i don't have any idea about why this happened i'm so confused so we were not able to",
    "start": "2900640",
    "end": "2906800"
  },
  {
    "text": "use the uh this this software this is the last version of that of the server okay so we were not able to use that software",
    "start": "2906800",
    "end": "2913359"
  },
  {
    "text": "we so we tried other things what no i just want to go back",
    "start": "2913359",
    "end": "2921040"
  },
  {
    "text": "yes okay so yeah what about poor guys so guys that doesn't know how to activate",
    "start": "2926839",
    "end": "2932000"
  },
  {
    "text": "this software like we don't know so yeah",
    "start": "2932000",
    "end": "2937359"
  },
  {
    "text": "okay next so yeah there's a list of supported vehicles",
    "start": "2937359",
    "end": "2942559"
  },
  {
    "text": "so in our case a client contacted with us a customer and mercedes mercedes was not",
    "start": "2942559",
    "end": "2951119"
  },
  {
    "text": "in the supported vehicle so we were not able to use this tool to extract information to parse the",
    "start": "2951119",
    "end": "2956480"
  },
  {
    "text": "information and to give the client or the customer um a report okay so what yeah that was like",
    "start": "2956480",
    "end": "2965200"
  },
  {
    "text": "our face what are we going to do in that case so what we did is uh redirectly",
    "start": "2965200",
    "end": "2971359"
  },
  {
    "text": "the apron okay you can see that you from down here this this small",
    "start": "2971359",
    "end": "2978400"
  },
  {
    "text": "chip okay so we dumped the the eprom and we had information but it's just a",
    "start": "2978400",
    "end": "2986480"
  },
  {
    "text": "binary we didn't know how to parse this information we didn't know okay the first three bytes are going to be",
    "start": "2986480",
    "end": "2991680"
  },
  {
    "text": "the speed of the car one second before the crash and the next three bytes are going to be the speed",
    "start": "2991680",
    "end": "2997520"
  },
  {
    "text": "two seconds before the crash and this other part of the file is the rpm at the moment of the crash we didn't",
    "start": "2997520",
    "end": "3003440"
  },
  {
    "text": "know that so that we did is to reset this this um",
    "start": "3003440",
    "end": "3008640"
  },
  {
    "text": "this file this dump we reset it to the default uh moment and we did a diff",
    "start": "3008640",
    "end": "3015440"
  },
  {
    "text": "so in that case we could know what are the exact parts of the file that have",
    "start": "3015440",
    "end": "3020640"
  },
  {
    "text": "that were being modified okay so we know that that specific parts contains",
    "start": "3020640",
    "end": "3025839"
  },
  {
    "text": "information relevant information for us okay so yeah we knew that some parts",
    "start": "3025839",
    "end": "3031920"
  },
  {
    "text": "were changed so the next step that we did is just to use this program we know ls",
    "start": "3031920",
    "end": "3038480"
  },
  {
    "text": "it's like a problem that you can just try to print some graphics of the of data",
    "start": "3038480",
    "end": "3046000"
  },
  {
    "text": "so we retrieve some um functions okay so we if there is a a crush there's",
    "start": "3046000",
    "end": "3053440"
  },
  {
    "text": "going to be a really huge break the car is going to it's going to stop eventually so if we",
    "start": "3053440",
    "end": "3060800"
  },
  {
    "text": "have we had some graphics who were ascendant and other one who were descendant so in",
    "start": "3060800",
    "end": "3067520"
  },
  {
    "text": "that case if it is a crash we only cares about the descendant uh graphics for for the speed i mean the",
    "start": "3067520",
    "end": "3074319"
  },
  {
    "text": "speed is going to be it's going to go to zero we sort it",
    "start": "3074319",
    "end": "3079520"
  },
  {
    "text": "and we got here it totally looks this was the only uh",
    "start": "3079520",
    "end": "3086800"
  },
  {
    "text": "descending graphic that we had so after the div of course so yeah we",
    "start": "3086800",
    "end": "3093040"
  },
  {
    "text": "realized that that was the specific speed during the accident so yeah",
    "start": "3093040",
    "end": "3098480"
  },
  {
    "text": "it was kind of cool how to be able to even not have in the way",
    "start": "3098480",
    "end": "3105920"
  },
  {
    "text": "in which the the information is parsed we could do something to figure it out",
    "start": "3105920",
    "end": "3112800"
  },
  {
    "text": "so okay so uh about the acute tool",
    "start": "3112800",
    "end": "3120960"
  },
  {
    "text": "okay we will be soon releasing a new revision of the hardware and a new revision of the software this",
    "start": "3120960",
    "end": "3128880"
  },
  {
    "text": "one already has it it has canvas so it's going to be working with canvas",
    "start": "3128880",
    "end": "3134160"
  },
  {
    "text": "with k-line and should be working with lean as well",
    "start": "3134160",
    "end": "3139520"
  },
  {
    "text": "we had already done the implementation for canvas for",
    "start": "3139520",
    "end": "3144960"
  },
  {
    "text": "edc 16 on this one we will release that as well yeah as alberto",
    "start": "3144960",
    "end": "3152400"
  },
  {
    "text": "said we are working on the crash data retrieval so that's still in the works",
    "start": "3152400",
    "end": "3159680"
  },
  {
    "text": "we should be able in a near future to get the crash data from our cars using the",
    "start": "3159680",
    "end": "3165520"
  },
  {
    "text": "ecu tool and then parse it yeah i didn't say that but we are",
    "start": "3165520",
    "end": "3171040"
  },
  {
    "text": "working about doing these parts of information in an automatic way",
    "start": "3171040",
    "end": "3176960"
  },
  {
    "text": "but the things that we don't have all the different airbag ecu's to be able to",
    "start": "3176960",
    "end": "3183280"
  },
  {
    "text": "know how that information is stored how to parse this information we need it's a very manual job to know okay i",
    "start": "3183280",
    "end": "3190800"
  },
  {
    "text": "have this dump of this specific ecu this specific model okay let's see how the information",
    "start": "3190800",
    "end": "3196079"
  },
  {
    "text": "is stored in the eprom so if you have some airbag ecu's and you don't want it or",
    "start": "3196079",
    "end": "3201760"
  },
  {
    "text": "even if you have a car right now you want to just take out the ecu and give it to me it's okay",
    "start": "3201760",
    "end": "3207599"
  },
  {
    "text": "so okay i'll finish the we're gonna have the chd emulation with basic functionality not the glitch",
    "start": "3213040",
    "end": "3219839"
  },
  {
    "text": "itself but should anyone want to see to get the code for it",
    "start": "3219839",
    "end": "3226319"
  },
  {
    "text": "we would send it and the optional over the air finger",
    "start": "3226319",
    "end": "3232000"
  },
  {
    "text": "so everything all the updates the hardware of course uh should be around ten dollars and",
    "start": "3232000",
    "end": "3239440"
  },
  {
    "text": "everything can be downloaded from our github repository so yeah",
    "start": "3239440",
    "end": "3247119"
  },
  {
    "text": "we're gonna get back to the camera we're gonna show a little bit the hardware now unconnected",
    "start": "3247119",
    "end": "3253760"
  },
  {
    "text": "so let's see",
    "start": "3258079",
    "end": "3265839"
  },
  {
    "text": "this is the cht so basically how the injection was done for the aeros of",
    "start": "3274559",
    "end": "3280000"
  },
  {
    "text": "course we needed to drive the stuff manually this is the mcp2515 which is the canvas",
    "start": "3280000",
    "end": "3286000"
  },
  {
    "text": "controller it's called is handled by spi by the arduino here",
    "start": "3286000",
    "end": "3291119"
  },
  {
    "text": "then we have the the driver for canvas for the legit way i mean for normal",
    "start": "3291119",
    "end": "3296880"
  },
  {
    "text": "frames which is this one that is being used for the by the combus driver and then we have this another can bus",
    "start": "3296880",
    "end": "3303839"
  },
  {
    "text": "driver that is directly connected to digital pins on the arduino so",
    "start": "3303839",
    "end": "3309599"
  },
  {
    "text": "and uh what we are basically doing is we are using uh normal canvas for injecting our own",
    "start": "3309599",
    "end": "3315920"
  },
  {
    "text": "frame and this extension for injecting the errors",
    "start": "3315920",
    "end": "3321200"
  },
  {
    "text": "and you know basically that's the sd and little more like some leds here some power supply",
    "start": "3321200",
    "end": "3329359"
  },
  {
    "text": "here and the remote finger update is pretty simple",
    "start": "3329359",
    "end": "3334720"
  },
  {
    "text": "it's just as i was saying uh one microcontroller arduino mini pro here is an sd that access buffer we",
    "start": "3334720",
    "end": "3340880"
  },
  {
    "text": "could add further like several fingers inside the sd so you can quickly change between them",
    "start": "3340880",
    "end": "3346640"
  },
  {
    "text": "and just a bluetooth module it could be anything like esm yeah and actually this is the gsm",
    "start": "3346640",
    "end": "3353200"
  },
  {
    "text": "development shield as uh i was saying earlier this is the chipset itself",
    "start": "3353200",
    "end": "3358319"
  },
  {
    "text": "this costs around seven euros it's a sim 900 it's quad band so it works worldwide and",
    "start": "3358319",
    "end": "3365119"
  },
  {
    "text": "it's really small like you can see my finger so yeah second",
    "start": "3365119",
    "end": "3372960"
  },
  {
    "text": "okay so yeah that's it uh oh can you yeah thank you yeah",
    "start": "3372960",
    "end": "3379680"
  },
  {
    "text": "that's thank you everybody for being here today thank you for joining us go to the pool",
    "start": "3379680",
    "end": "3385440"
  },
  {
    "text": "please stop just going to this conference go to the pool it's awesome and thank you to all those who want to",
    "start": "3385440",
    "end": "3392240"
  },
  {
    "text": "understand how and why things works thank you very much",
    "start": "3392240",
    "end": "3397759"
  }
]