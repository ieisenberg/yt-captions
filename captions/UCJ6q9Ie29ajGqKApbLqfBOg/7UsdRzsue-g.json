[
  {
    "start": "0",
    "end": "152000"
  },
  {
    "text": "good afternoon everyone we are in Palace one and the name of this talk is pressed",
    "start": "0",
    "end": "5310"
  },
  {
    "text": "route to continue detecting OSX and windows botnets what are due see me RDF",
    "start": "5310",
    "end": "11130"
  },
  {
    "text": "view I'm gonna hand you over to your presenters thank you hello my name is",
    "start": "11130",
    "end": "17910"
  },
  {
    "text": "Mario Vukasin and we're here to talk about actually a boot kits for you fi",
    "start": "17910",
    "end": "25820"
  },
  {
    "text": "and really you know again you know I'll thank people from lean forward",
    "start": "25820",
    "end": "31080"
  },
  {
    "text": "unfortunately the UF I is not you know tabloid size and also it's not in",
    "start": "31080",
    "end": "37620"
  },
  {
    "text": "Technicolor so you know letters will be smaller and they'll be definitely lack of color but whenever the last thing I",
    "start": "37620",
    "end": "44969"
  },
  {
    "text": "find it's very exciting and interesting and I would like to first begin by first telling you more in terms of how we're",
    "start": "44969",
    "end": "51239"
  },
  {
    "text": "going to structure this talk we are obviously interested in telling you more about our motivation and EFI is not everybody's cup of tea it's not really",
    "start": "51239",
    "end": "59300"
  },
  {
    "text": "written about all that much although in last few years you know we are seeing more and more research we also like to",
    "start": "59300",
    "end": "65040"
  },
  {
    "text": "talk to you more about who we are as we have been regularly speaking in a black hat you know releasing various open",
    "start": "65040",
    "end": "71010"
  },
  {
    "text": "source project and we find you know this research being relevant extension of",
    "start": "71010",
    "end": "76830"
  },
  {
    "text": "what we've been doing also we like to then follow up with the sort of you know brief introduction to efi i'm sure in a",
    "start": "76830",
    "end": "84659"
  },
  {
    "text": "lot of you are very familiar with it but nevertheless it's reviewing a good sort of you know to to set the stage and then",
    "start": "84659",
    "end": "91020"
  },
  {
    "text": "also to mention some of the previous UF i would get research some of its",
    "start": "91020",
    "end": "96329"
  },
  {
    "text": "presented at black hat very good material that was certainly influential",
    "start": "96329",
    "end": "103619"
  },
  {
    "text": "in our own work and then we want to get into the actually presenting the rootkit",
    "start": "103619",
    "end": "109590"
  },
  {
    "text": "detection framework or what we called rdf you by looking in the frame of design they are thinking of you know",
    "start": "109590",
    "end": "116630"
  },
  {
    "text": "discussing reasons that were behind its",
    "start": "116630",
    "end": "124619"
  },
  {
    "text": "structure and then also going through the vmware implementation then and then obviously the every good",
    "start": "124619",
    "end": "132000"
  },
  {
    "text": "defense measure comes with the proof of a proof of concept material to validate",
    "start": "132000",
    "end": "142500"
  },
  {
    "text": "it so we will at the end of the talk demonstrate a Mac os10 boot kit now to",
    "start": "142500",
    "end": "152760"
  },
  {
    "start": "152000",
    "end": "152000"
  },
  {
    "text": "start with it's really our motivation and so we as a company have always been",
    "start": "152760",
    "end": "159840"
  },
  {
    "text": "very much interested in the foul born threats deep file analysis and after",
    "start": "159840",
    "end": "166139"
  },
  {
    "text": "having spent a lot of time with windows with with elf documents firmware mobile",
    "start": "166139",
    "end": "171780"
  },
  {
    "text": "packages we really said like you know hey you know it would really really interesting to do a deeper dive in on",
    "start": "171780",
    "end": "179760"
  },
  {
    "text": "the firmer level so we obviously notice that you know you know you f ice",
    "start": "179760",
    "end": "185030"
  },
  {
    "text": "popularity these days it's really paramount as it runs on Windows platform in a runs under android runs under mac",
    "start": "185030",
    "end": "192780"
  },
  {
    "text": "OS and it's actually everywhere and not just only that it's everywhere it's extremely powerful efi today is in a",
    "start": "192780",
    "end": "201090"
  },
  {
    "text": "full stack OS you know it has all the cool things you would want out of an OS to allow you to write really really cool",
    "start": "201090",
    "end": "208139"
  },
  {
    "text": "applications sitting atop of it and obviously it's extreme extremely interesting for exploitation that point",
    "start": "208139",
    "end": "214620"
  },
  {
    "text": "so it has a special set of powerful you",
    "start": "214620",
    "end": "220290"
  },
  {
    "text": "know memory and farm and manipulation features it has a full network stack which is definitely in a very very",
    "start": "220290",
    "end": "225989"
  },
  {
    "text": "important you know for the the exploitation but then also has lots of",
    "start": "225989",
    "end": "231599"
  },
  {
    "text": "really other cool things such as graphic api so you can imagine you know the vulnerability research in that area",
    "start": "231599",
    "end": "236879"
  },
  {
    "text": "could be extremely extremely useful has a great you know device management",
    "start": "236879",
    "end": "242030"
  },
  {
    "text": "capability and that also has ability to do a remote boot so you pretty much have all the elements to be able to do really",
    "start": "242030",
    "end": "250079"
  },
  {
    "text": "really interesting and wonderful attack your components now beyond these",
    "start": "250079",
    "end": "257570"
  },
  {
    "text": "set of features ufi is really attackers paradise because the defenders",
    "start": "257570",
    "end": "262840"
  },
  {
    "text": "definitely have a lot of disadvantages in the area you know it has definitely",
    "start": "262840",
    "end": "268370"
  },
  {
    "text": "low visibility because there's very few tools that actually do anything about and detect any presence or malformation",
    "start": "268370",
    "end": "274940"
  },
  {
    "text": "or invalid traffic originating specifically from the UEFI stack then",
    "start": "274940",
    "end": "280850"
  },
  {
    "text": "also if you were actually trying to investigate malicious former image you",
    "start": "280850",
    "end": "289760"
  },
  {
    "text": "know here in malicious efi image it'd be very difficult for you to set up a you know a nice off-the-shelf tool stack",
    "start": "289760",
    "end": "296180"
  },
  {
    "text": "largely we have to build your own things it will be extremely painful a lot of stuff would be the hardware connected it",
    "start": "296180",
    "end": "303050"
  },
  {
    "text": "you know odds would we get stacked against you in actually trying to easily",
    "start": "303050",
    "end": "308060"
  },
  {
    "text": "and quickly analyze what's happening of course you know they're you know they're I in this story lots of you know you",
    "start": "308060",
    "end": "315530"
  },
  {
    "text": "know also good positive elements I mean if I has been around has been developed",
    "start": "315530",
    "end": "320870"
  },
  {
    "text": "here you know almost in vacuum from actually you know in depth in a security",
    "start": "320870",
    "end": "326080"
  },
  {
    "text": "analysis but you know what we've seen with the FI secure boot especially on some Android the devices and surface RT",
    "start": "326080",
    "end": "333890"
  },
  {
    "text": "is definitely very promising it's a much higher security strength that we have",
    "start": "333890",
    "end": "339560"
  },
  {
    "text": "ever seen when UEFI and we are really hoping that that most of the new devices will be shipping with the secure boot",
    "start": "339560",
    "end": "347300"
  },
  {
    "text": "enabled now a few words about who we are so the company was founded dinner by two",
    "start": "347300",
    "end": "353810"
  },
  {
    "text": "of us in a me Mario Brooklyn and Thomas LeBaron over here we've started the company in 09 and our focus has always",
    "start": "353810",
    "end": "362150"
  },
  {
    "text": "been the binary analysis sort of a wide range of executive formats and while",
    "start": "362150",
    "end": "369680"
  },
  {
    "text": "doing the analysis we really try to pull out as much material out of those",
    "start": "369680",
    "end": "375260"
  },
  {
    "text": "formats specifically trying to understand the reputation of various components malformations and",
    "start": "375260",
    "end": "382439"
  },
  {
    "text": "different anomaly detection now in our process of developing some commercial",
    "start": "382439",
    "end": "389379"
  },
  {
    "text": "products we have been very very interested in developing a wider range",
    "start": "389379",
    "end": "395319"
  },
  {
    "text": "of open source and free were tools we started no.9 with something that's called a Titan engine which is a really",
    "start": "395319",
    "end": "401710"
  },
  {
    "text": "a library for portable executable format reconstruction and has been successfully",
    "start": "401710",
    "end": "407500"
  },
  {
    "text": "used by various organization in building you know from custom and Packers to",
    "start": "407500",
    "end": "414819"
  },
  {
    "text": "vulnerability scanners and even some in a pen testing project then we really",
    "start": "414819",
    "end": "421270"
  },
  {
    "text": "took a deeper dive into archive formats we released in 2010 something called 9x",
    "start": "421270",
    "end": "428650"
  },
  {
    "text": "engine which was the archive formats tago detection tool something that only",
    "start": "428650",
    "end": "433779"
  },
  {
    "text": "recently with blue box android announcements has actually come a full",
    "start": "433779",
    "end": "440080"
  },
  {
    "text": "circle we have realized that we have had the tool to detect these really more",
    "start": "440080",
    "end": "446169"
  },
  {
    "text": "like Lena stego hiding you know artifacts inside of you know android apk",
    "start": "446169",
    "end": "451990"
  },
  {
    "text": "and we believe that there is this is a review in a really interesting area to go back to and try to see how the",
    "start": "451990",
    "end": "457539"
  },
  {
    "text": "archive formats actually can be misused",
    "start": "457539",
    "end": "463449"
  },
  {
    "text": "you know in an executive Oh environment following our next engine we try to put",
    "start": "463449",
    "end": "470889"
  },
  {
    "text": "together an open-source platform for actually unpacker writing analysis of",
    "start": "470889",
    "end": "477509"
  },
  {
    "text": "windows binaries which we then followed with an unofficial guide to pee",
    "start": "477509",
    "end": "484050"
  },
  {
    "text": "malformation probably some of the some of you came to that talk couple years ago we really really surprised how many",
    "start": "484050",
    "end": "490569"
  },
  {
    "text": "people were excited you know about you know always new things that you can",
    "start": "490569",
    "end": "498180"
  },
  {
    "text": "learn from p you know so for us it's that format never cease to surprise us and then last year we we started a",
    "start": "498180",
    "end": "508650"
  },
  {
    "text": "project that was our first cooperation with a DARPA cft program and we have",
    "start": "508650",
    "end": "514020"
  },
  {
    "text": "released something called the file this infection framework which is an open-source platform that allows people",
    "start": "514020",
    "end": "520860"
  },
  {
    "text": "to actually write these in factors finder disaffection this in factors for vairocina file infection attacks under",
    "start": "520860",
    "end": "529140"
  },
  {
    "text": "windows and this obviously brings us to know to this year's work that the on you",
    "start": "529140",
    "end": "534690"
  },
  {
    "text": "fi that has also been funded by DARPA cft so having said that obviously we",
    "start": "534690",
    "end": "542550"
  },
  {
    "text": "would love to thank their passivity for being such a great program that has allowed us to work on things that were",
    "start": "542550",
    "end": "549450"
  },
  {
    "text": "you know things that we are really interested in that he wanted we wanted to do but were slightly outside of our",
    "start": "549450",
    "end": "555149"
  },
  {
    "text": "in a commercial offering but nevertheless relevant topics for the",
    "start": "555149",
    "end": "562050"
  },
  {
    "text": "community in general also we would like to you know explicitly thank to you know",
    "start": "562050",
    "end": "569730"
  },
  {
    "text": "several researchers that have influenced this presentation and whose work will be citing as we set the stage for talking",
    "start": "569730",
    "end": "579839"
  },
  {
    "text": "deeper about the RDF you so you want to thank to John heasman who spoke at black hat in 2007 we want to thank to snare",
    "start": "579839",
    "end": "587730"
  },
  {
    "text": "from assurance who spoke last year really great talk here at black hat we",
    "start": "587730",
    "end": "592920"
  },
  {
    "text": "also like to thank too dang Griffin who spoke the only couple days later at Def Con and Sebastiano kaczmarek who had an",
    "start": "592920",
    "end": "600870"
  },
  {
    "text": "interesting would kids talk at the hack in the Box in Amsterdam just you know a",
    "start": "600870",
    "end": "606839"
  },
  {
    "text": "few months ago so without further though further ado I wanna introduce you Tommy",
    "start": "606839",
    "end": "613589"
  },
  {
    "text": "sloth and he'll continue with UEFI hello",
    "start": "613589",
    "end": "619709"
  },
  {
    "text": "my name is Thomas la Parisienne I'm the chief software Tekkit reversing labs on the guy behind well the one of the guys",
    "start": "619709",
    "end": "628050"
  },
  {
    "text": "behind all of the projects mario has mentioned so far today we are focusing on the UF I and our latest project which",
    "start": "628050",
    "end": "634890"
  },
  {
    "text": "is sponsored by DARPA so how does the booting process look today on machines",
    "start": "634890",
    "end": "641010"
  },
  {
    "start": "639000",
    "end": "639000"
  },
  {
    "text": "that do not have you you fi so this is the old version of loading the operating system so you start with the bios which",
    "start": "641010",
    "end": "648510"
  },
  {
    "text": "is the basic input/output system you load the operating system to iterating",
    "start": "648510",
    "end": "653699"
  },
  {
    "text": "through the MBR that is all executed in real mode the control is then passed to",
    "start": "653699",
    "end": "660600"
  },
  {
    "text": "the windows components which then you initialize the colonel run the other",
    "start": "660600",
    "end": "666150"
  },
  {
    "text": "hardware abstraction layers create sessions and so on this is the old",
    "start": "666150",
    "end": "672150"
  },
  {
    "text": "module which still is in use today on the older machines but if you have bought a laptop or a PC recently within",
    "start": "672150",
    "end": "680279"
  },
  {
    "text": "the last couple of years you most commonly have a thing called unified extensible firmware interface so what it",
    "start": "680279",
    "end": "687959"
  },
  {
    "text": "is it's it it's a set of tools that enable people who create devices to",
    "start": "687959",
    "end": "695810"
  },
  {
    "text": "really easily create new protocols and support new devices it was originally",
    "start": "695810",
    "end": "702240"
  },
  {
    "text": "developed by inpho with something which is called int'l boot initiative it is being worked on ever since and it's now",
    "start": "702240",
    "end": "709709"
  },
  {
    "text": "grown into a community effort to modernize the pc booting process it currently ships as a boot option",
    "start": "709709",
    "end": "717029"
  },
  {
    "text": "alongside the standard legacy BIOS so you have to turn it on on most on most",
    "start": "717029",
    "end": "722520"
  },
  {
    "text": "devices when you choose to install an operating system you have to have that turned on to be able to actually install",
    "start": "722520",
    "end": "728699"
  },
  {
    "text": "a ufi other operating systems like Windows also support secure boot so that",
    "start": "728699",
    "end": "734220"
  },
  {
    "text": "enables you to have much more security when you're installing an operating system to make sure that all of the",
    "start": "734220",
    "end": "740610"
  },
  {
    "text": "components have not been tampered with while you are booting into your operating system so the UF I aims to be the future",
    "start": "740610",
    "end": "749350"
  },
  {
    "text": "the only booting interface in the future it is used today in all Intel Intel",
    "start": "749350",
    "end": "755450"
  },
  {
    "text": "Power Mac Mac books and PC as well it is",
    "start": "755450",
    "end": "760970"
  },
  {
    "text": "managed by the unified extensible firmware interface consortium and you",
    "start": "760970",
    "end": "766190"
  },
  {
    "text": "can find and download the specs from their website it's a pretty good read even though it's like 2,000 pages",
    "start": "766190",
    "end": "771760"
  },
  {
    "text": "there's quite a bit of elements there which you can find which are really interesting most of those were used for",
    "start": "771760",
    "end": "777950"
  },
  {
    "text": "this particular talk with that enabled us to create RDF you so how does the",
    "start": "777950",
    "end": "783740"
  },
  {
    "text": "booting system change when there's unified extensible firmware interface so the only thing which actually changes is",
    "start": "783740",
    "end": "789950"
  },
  {
    "text": "there's no more buy us all the firmware gets initialized by the UF I then then",
    "start": "789950",
    "end": "797090"
  },
  {
    "text": "the UF I goes through the list of available devices loads the boot manager in this case we've highlighted the",
    "start": "797090",
    "end": "803690"
  },
  {
    "text": "Microsoft boot manager which then selects which operating system once it",
    "start": "803690",
    "end": "808910"
  },
  {
    "text": "wants to load then all the remaining things happen as they were before in windows so the UF I is something which",
    "start": "808910",
    "end": "816980"
  },
  {
    "text": "boots up the machine but it also leaves the remnants running as long as the pc",
    "start": "816980",
    "end": "822920"
  },
  {
    "text": "is powered on so in a nutshell this is a conceptual overview of how this entire",
    "start": "822920",
    "end": "829250"
  },
  {
    "start": "826000",
    "end": "826000"
  },
  {
    "text": "stack looks like so on the top you would have the operating system and at the bottom you would have the EFI operating",
    "start": "829250",
    "end": "834860"
  },
  {
    "text": "system loader which initialize the entire process so the efi consists of the boot services which are really",
    "start": "834860",
    "end": "841520"
  },
  {
    "text": "important runtime services as well so those are going to be the things we talk about next in addition to that you have",
    "start": "841520",
    "end": "848930"
  },
  {
    "text": "the underlying layers of the platform hardware which is abstracted by the unified extensible interface firmware",
    "start": "848930",
    "end": "856220"
  },
  {
    "text": "which enables you to communicate with the devices to create new protocols and so on all that is contained on an EFI",
    "start": "856220",
    "end": "864470"
  },
  {
    "text": "partition and that is actually installed by the operating system so when you create a new install of windows for",
    "start": "864470",
    "end": "871310"
  },
  {
    "text": "example you would basically get two new partitions 14 d e f",
    "start": "871310",
    "end": "876320"
  },
  {
    "text": "later and additional windows partition which actually is used for storing",
    "start": "876320",
    "end": "882050"
  },
  {
    "text": "additional windows data following that you have other other parts of the disk which are used by the user so the boot",
    "start": "882050",
    "end": "890060"
  },
  {
    "text": "sequence has changed a bit so here is how it looks like today all the green items are the things that happen with",
    "start": "890060",
    "end": "896990"
  },
  {
    "text": "with the boot managers assistance so you the platform by loading the firmware and",
    "start": "896990",
    "end": "902390"
  },
  {
    "text": "then the firmware takes off by loading other interesting things which need to be loaded like efi drivers all those",
    "start": "902390",
    "end": "909590"
  },
  {
    "text": "drivers have that have an option of running additional applications and all of that is to assure that all of the",
    "start": "909590",
    "end": "915530"
  },
  {
    "text": "devices you have on the machine are actually communicating properly once the",
    "start": "915530",
    "end": "921320"
  },
  {
    "text": "booting process has completed the the efi search for the searches for the OS",
    "start": "921320",
    "end": "926780"
  },
  {
    "text": "loader code and it boots up that specific application which then calls a",
    "start": "926780",
    "end": "932870"
  },
  {
    "text": "function which terminates the booting services which actually shuts down part",
    "start": "932870",
    "end": "938240"
  },
  {
    "text": "of the efi drivers which are just meant to be running as the device is booting",
    "start": "938240",
    "end": "944390"
  },
  {
    "text": "once that happens the control is passed to the operating system which then continues on normally so with that in",
    "start": "944390",
    "end": "952340"
  },
  {
    "text": "mind there are a couple of different things we should really know about you fi images and that is that they are",
    "start": "952340",
    "end": "959300"
  },
  {
    "start": "953000",
    "end": "953000"
  },
  {
    "text": "typically portable executable which are which is the most important thing for us because portable executable format is",
    "start": "959300",
    "end": "965300"
  },
  {
    "text": "something we have been talking about in the past and it is just one subset out of that format that's why this was of",
    "start": "965300",
    "end": "971480"
  },
  {
    "text": "interest to us but in addition to that the standard actually predicts there are other formats as well so basically any",
    "start": "971480",
    "end": "977810"
  },
  {
    "text": "wender can create any kind of executive or format they want so int'l designed",
    "start": "977810",
    "end": "983000"
  },
  {
    "text": "this format called T and is being used by Apple as well in their implementation",
    "start": "983000",
    "end": "989420"
  },
  {
    "text": "of the UF I so even though you fi is a standard and anybody can basically use",
    "start": "989420",
    "end": "995150"
  },
  {
    "text": "any part of it and create a standard of their own basically that includes the UEFI images as well that was the case",
    "start": "995150",
    "end": "1002980"
  },
  {
    "text": "with the first version of the UF find specification which was one point ten the later",
    "start": "1002980",
    "end": "1009100"
  },
  {
    "text": "specification so 2 point 0 which is the more most more current is much more strict in that regard so you have two",
    "start": "1009100",
    "end": "1016390"
  },
  {
    "text": "types of you fi images you have drivers which yet again there are two types of",
    "start": "1016390",
    "end": "1021550"
  },
  {
    "text": "drivers we have the boot service drivers which are actually terminated as soon as the operating system loader calls the",
    "start": "1021550",
    "end": "1028660"
  },
  {
    "text": "exit booth services so at that point all the drivers are which are just boot",
    "start": "1028660",
    "end": "1033699"
  },
  {
    "text": "service drivers are unloaded from the system and the system is continuous with",
    "start": "1033700",
    "end": "1038890"
  },
  {
    "text": "the lonely you also have the runtime service drivers which are present all the time so as long as the application",
    "start": "1038890",
    "end": "1045760"
  },
  {
    "text": "or the system is running all those drivers are also running as well so that",
    "start": "1045760",
    "end": "1050950"
  },
  {
    "text": "that becomes a really nice way for you to inject any kind of code which",
    "start": "1050950",
    "end": "1056290"
  },
  {
    "text": "actually runs as long as the machine is running and that is what I project is focused on finding these images and",
    "start": "1056290",
    "end": "1062530"
  },
  {
    "text": "letting you know that they are present in the system so those were the drivers there are also applications there's two",
    "start": "1062530",
    "end": "1069250"
  },
  {
    "text": "types of applications like the normal applications that actually exist and execute only in the preview environment",
    "start": "1069250",
    "end": "1075460"
  },
  {
    "text": "I'm going to show you how that looks like in a later on during the demo and there's a specific ufi application which",
    "start": "1075460",
    "end": "1082420"
  },
  {
    "text": "just loads the operating system and that's the only kind of application which can actually take control of the",
    "start": "1082420",
    "end": "1088090"
  },
  {
    "text": "system by calling the exit boot services which then later on unloads all the",
    "start": "1088090",
    "end": "1093700"
  },
  {
    "text": "drivers which are the boot service drivers so how do these programs",
    "start": "1093700",
    "end": "1099970"
  },
  {
    "text": "communicate with the firmware there's this thing called boot services and and runtime services as well so boot",
    "start": "1099970",
    "end": "1107170"
  },
  {
    "text": "services are you can think of it like a set of api's which are available to developers which are actually creating",
    "start": "1107170",
    "end": "1113290"
  },
  {
    "text": "programs that run in the you fi environment and they consist of functions which are only available",
    "start": "1113290",
    "end": "1118870"
  },
  {
    "text": "before the exit boot services is called so these would be deployed service",
    "start": "1118870",
    "end": "1124330"
  },
  {
    "text": "drivers so they have functions which can be categorized as global so they are",
    "start": "1124330",
    "end": "1130420"
  },
  {
    "text": "available everywhere and they're also handle based which means that you can dynamically create protocols by applying",
    "start": "1130420",
    "end": "1137170"
  },
  {
    "text": "many of these handle care teristics two handles that are already open by opening other handles you",
    "start": "1137170",
    "end": "1142990"
  },
  {
    "text": "basically create protocols so we have global functions which are available on",
    "start": "1142990",
    "end": "1148480"
  },
  {
    "text": "all platforms that is by ufi specification so you have event you can",
    "start": "1148480",
    "end": "1153940"
  },
  {
    "text": "do basic task with these kinds of AP is like create events timers allocate some",
    "start": "1153940",
    "end": "1159970"
  },
  {
    "text": "memory handle other protocols which can be available if a specific device and",
    "start": "1159970",
    "end": "1165580"
  },
  {
    "text": "driver is installed have image services which enable you to communicate with other loaded drivers and you have other",
    "start": "1165580",
    "end": "1172090"
  },
  {
    "text": "miscellaneous services as well so handle based are not our specific functionality they're not available everywhere and",
    "start": "1172090",
    "end": "1178750"
  },
  {
    "text": "they're only there if you create a handle or there's out other devices which other device drivers we have which",
    "start": "1178750",
    "end": "1185230"
  },
  {
    "text": "have created that analyst well so does with the boot services you also have the",
    "start": "1185230",
    "end": "1190299"
  },
  {
    "start": "1188000",
    "end": "1188000"
  },
  {
    "text": "runtime services which are available throughout the actual loading process so",
    "start": "1190299",
    "end": "1196840"
  },
  {
    "text": "as long as the machine is running those runtime services are available yet again",
    "start": "1196840",
    "end": "1204070"
  },
  {
    "text": "these functions are also global and handle based and you can dynamically create them as well unlike the boot",
    "start": "1204070",
    "end": "1210730"
  },
  {
    "text": "services these ones can offer different kinds of things like runtime rules you",
    "start": "1210730",
    "end": "1218650"
  },
  {
    "text": "can create those as well you can access the variable services so you can also",
    "start": "1218650",
    "end": "1225669"
  },
  {
    "text": "create you can access time and other things like keyboard and so on and so",
    "start": "1225669",
    "end": "1231040"
  },
  {
    "text": "forth there also handle based as well so you can create more on the fly so how to",
    "start": "1231040",
    "end": "1237580"
  },
  {
    "text": "developers actually use these kinds of available tools so there's a there's a",
    "start": "1237580",
    "end": "1244150"
  },
  {
    "text": "specific package available online it's a free download and it's called an efi",
    "start": "1244150",
    "end": "1250030"
  },
  {
    "text": "development kit or ed k2 it's based on the Intel's reference implementation and",
    "start": "1250030",
    "end": "1255760"
  },
  {
    "text": "it enables you to write efi applications in see it does have its own",
    "start": "1255760",
    "end": "1263020"
  },
  {
    "text": "the love implementation but it's not really the sea you know already it only",
    "start": "1263020",
    "end": "1269740"
  },
  {
    "text": "offers a small portion of the sea library and that is because it's been basically wrapped around these available",
    "start": "1269740",
    "end": "1275650"
  },
  {
    "text": "services which basically enable you to allocate memory communicate with devices and so on so only a small subset of C",
    "start": "1275650",
    "end": "1283420"
  },
  {
    "text": "programming language is available however it's good enough for you to actually work with memory allocated",
    "start": "1283420",
    "end": "1289570"
  },
  {
    "text": "pointers and so on that enables you to easily write efi drivers and i'll show",
    "start": "1289570",
    "end": "1295180"
  },
  {
    "text": "you an example in in a sec so it has a lot of packages which are available",
    "start": "1295180",
    "end": "1300430"
  },
  {
    "text": "there as well it has a shell so you can actually type stuff in command line has",
    "start": "1300430",
    "end": "1305920"
  },
  {
    "text": "crypto functions it offers some emulation capabilities there's even a python reference implementation so you",
    "start": "1305920",
    "end": "1313030"
  },
  {
    "text": "can even use python from the efi layer to script around your drivers and and do whatever you want with that when you",
    "start": "1313030",
    "end": "1320650"
  },
  {
    "text": "write your applications the edk actually supports to use many different compilers",
    "start": "1320650",
    "end": "1325690"
  },
  {
    "text": "at all you can use visual studios compiler you can use the GCC one you can",
    "start": "1325690",
    "end": "1330880"
  },
  {
    "text": "use the Xcode it's all fine it all compiles almost to the binary exact images regardless of the platform you",
    "start": "1330880",
    "end": "1338950"
  },
  {
    "text": "used so it supports many different CPUs so EA 64 which includes both 32-bit and",
    "start": "1338950",
    "end": "1345880"
  },
  {
    "text": "64-bit architectures and arm architecture as well here you would have a sample of how this application would",
    "start": "1345880",
    "end": "1353380"
  },
  {
    "text": "actually look like if you were to write it with the help of the edk so it's a",
    "start": "1353380",
    "end": "1359650"
  },
  {
    "text": "standard C application which has the number of arguments passed to the program and all those parameters as as",
    "start": "1359650",
    "end": "1369280"
  },
  {
    "text": "strings as well so so this is something you can use from the ed case but this is",
    "start": "1369280",
    "end": "1374410"
  },
  {
    "text": "not the way you actually write ufi applications this entry point which you",
    "start": "1374410",
    "end": "1381970"
  },
  {
    "text": "created here so she'll at main is basically wrapped around the net actual way the UF I applications are",
    "start": "1381970",
    "end": "1389320"
  },
  {
    "text": "written so the next slide actually shows that so this main function still takes two parameters so the first one will be",
    "start": "1389320",
    "end": "1396279"
  },
  {
    "text": "the handle of the image you are at so you handle up your image and then you have a pointer to the system table which",
    "start": "1396279",
    "end": "1402909"
  },
  {
    "text": "actually consists of pointers to Boonton runtime services so these are the",
    "start": "1402909",
    "end": "1408250"
  },
  {
    "text": "functions you can actually use and the previous example was just a wrapper around this to make it more like C code",
    "start": "1408250",
    "end": "1416919"
  },
  {
    "text": "so C programmers feel at home but we will be using these pointers natively is",
    "start": "1416919",
    "end": "1423159"
  },
  {
    "text": "because they enable us to access functions which enable us to create events to basically inspect memory to",
    "start": "1423159",
    "end": "1431260"
  },
  {
    "text": "see other images to access firmware and so on that the functions are located in this kind of structure so naturally uh",
    "start": "1431260",
    "end": "1439919"
  },
  {
    "text": "there there is a way to actually abuse all this all this unified interface as",
    "start": "1439919",
    "end": "1447370"
  },
  {
    "text": "well because all that is pretty much open to whoever's writing the driver so",
    "start": "1447370",
    "end": "1453159"
  },
  {
    "text": "if you write a driver we have access to the entire machine there's almost no restrictions about you accessing a part",
    "start": "1453159",
    "end": "1459789"
  },
  {
    "text": "of the memory so you can imagine like writing a user mode application but having all other drivers loaded in the",
    "start": "1459789",
    "end": "1466809"
  },
  {
    "text": "same address space it's basically like that because you can access all the memory regardless of memory permissions",
    "start": "1466809",
    "end": "1473559"
  },
  {
    "text": "at all so you can install hooks you can overwrite drivers you can unload images basically the EFI layer is trusting you",
    "start": "1473559",
    "end": "1481419"
  },
  {
    "text": "to do the right thing and you might choose to abuse that as well that is why",
    "start": "1481419",
    "end": "1486700"
  },
  {
    "text": "the concepts like secure boot have been introduced as well so this there has",
    "start": "1486700",
    "end": "1492220"
  },
  {
    "text": "been some previous work and research about boot kids and how you can create those as well so the previous work which",
    "start": "1492220",
    "end": "1500320"
  },
  {
    "text": "happened in the 07 was presented here at black hat and what they did is they",
    "start": "1500320",
    "end": "1507070"
  },
  {
    "text": "modified the nvram variables they injected some code",
    "start": "1507070",
    "end": "1512470"
  },
  {
    "text": "they showed how you can abuse system management mode basically that was",
    "start": "1512470",
    "end": "1518110"
  },
  {
    "text": "followed by last year stock which which snare did and he showed how can patch",
    "start": "1518110",
    "end": "1524620"
  },
  {
    "text": "the mac OS kernel if you had a maliciously loaded efi driver and he",
    "start": "1524620",
    "end": "1530100"
  },
  {
    "text": "introduced the concept of evil made attacks for the efi layer and just this",
    "start": "1530100",
    "end": "1536919"
  },
  {
    "text": "year at hacking the box and amsterdam one of the first boot kids for the",
    "start": "1536919",
    "end": "1543039"
  },
  {
    "text": "windows 8 or was presented his approach",
    "start": "1543039",
    "end": "1548530"
  },
  {
    "text": "was quite similar to ours if you compare the way that dream boot works and",
    "start": "1548530",
    "end": "1554409"
  },
  {
    "text": "compared the way our mac OS boot kit works they are quite similar in the case",
    "start": "1554409",
    "end": "1560860"
  },
  {
    "text": "that you have to hook certain things and you have to inject code as well to be",
    "start": "1560860",
    "end": "1566770"
  },
  {
    "text": "able to execute commands that at a much higher level will go in a bit more",
    "start": "1566770",
    "end": "1573130"
  },
  {
    "text": "detail later on of how did we create our own boot kit but here is a simple",
    "start": "1573130",
    "end": "1578530"
  },
  {
    "text": "diagram which shows how dream boot actually operates at certain layers hooks are installed which read direct",
    "start": "1578530",
    "end": "1585610"
  },
  {
    "text": "code to maliciously load the drivers which then install callbacks which are",
    "start": "1585610",
    "end": "1591190"
  },
  {
    "text": "executed when certain events in Windows happen so that enables privilege escalation attacks and so on so that",
    "start": "1591190",
    "end": "1600010"
  },
  {
    "text": "that brought us to our dfu which is a rootkit detection framework for the UF i",
    "start": "1600010",
    "end": "1605740"
  },
  {
    "text": "layer it's as we mentioned before it's a DARPA sponsored project and like your tank DARPA yet again so what actually is",
    "start": "1605740",
    "end": "1612549"
  },
  {
    "text": "RDF you so RT view is a set of applications and drivers that enable you",
    "start": "1612549",
    "end": "1617679"
  },
  {
    "text": "to list all loaded drivers in the EFI environment improved entire memory range",
    "start": "1617679",
    "end": "1624010"
  },
  {
    "text": "you can scan for executive all's that might be hidden you can monitor all drivers which are loaded before the",
    "start": "1624010",
    "end": "1630549"
  },
  {
    "text": "operating system starts you can start listing and scanning the boots and",
    "start": "1630549",
    "end": "1636400"
  },
  {
    "text": "runtime services for modified function pointers that will be shown as well so",
    "start": "1636400",
    "end": "1641799"
  },
  {
    "text": "if checksums are not matching on specific images that is displayed in the log all those files are",
    "start": "1641799",
    "end": "1647929"
  },
  {
    "text": "automatically dumped as well as you can analyze them later on as well we are",
    "start": "1647929",
    "end": "1653539"
  },
  {
    "text": "also continuously monitoring both the boots and the runtime services while the operating system is being loaded making",
    "start": "1653539",
    "end": "1659299"
  },
  {
    "text": "sure that none of those modifications occur while our rd of you is loaded we",
    "start": "1659299",
    "end": "1665629"
  },
  {
    "text": "can also list all events which are happening and it also works as a",
    "start": "1665629",
    "end": "1671210"
  },
  {
    "text": "standalone because the efi specification says that she'll is absolutely optional",
    "start": "1671210",
    "end": "1678349"
  },
  {
    "text": "so you might choose not to implement shell if you don't want you RDF you would work even though if there's no",
    "start": "1678349",
    "end": "1684259"
  },
  {
    "text": "shell so it comes with all with its own graphical user interface which you can use to access all of its functionality",
    "start": "1684259",
    "end": "1691179"
  },
  {
    "text": "so what does it support it supports the boat the older specifications of one",
    "start": "1691179",
    "end": "1696799"
  },
  {
    "text": "point X and the latest one for both 32-bit and 64-bit environments as well it supports a specific mac OS",
    "start": "1696799",
    "end": "1703609"
  },
  {
    "text": "implementation of the UF I it works on the Virtual Box even though VirtualBox",
    "start": "1703609",
    "end": "1708679"
  },
  {
    "text": "currently the latest version I check though does have an EFI shell but it's",
    "start": "1708679",
    "end": "1716269"
  },
  {
    "text": "uncapable of actually installing an operating system on the efi they are still working on that VMware has much",
    "start": "1716269",
    "end": "1722719"
  },
  {
    "text": "better support and you can actually use a DF I layer it has a shell you can actually install the operating system",
    "start": "1722719",
    "end": "1728960"
  },
  {
    "text": "and it works just fine currently we do not support efi forearm because there's",
    "start": "1728960",
    "end": "1735649"
  },
  {
    "text": "only one implementation and that surface RT and that implementation already has",
    "start": "1735649",
    "end": "1740719"
  },
  {
    "text": "the Q boat enabled by default and that's why we opted not to support that one because you should be pretty safe and",
    "start": "1740719",
    "end": "1747710"
  },
  {
    "text": "there's no need for you to actually scan those devices so how does rdf you work",
    "start": "1747710",
    "end": "1753969"
  },
  {
    "start": "1752000",
    "end": "1752000"
  },
  {
    "text": "there's a couple of options you can actually load the driver if there's an ufi shell enabled you can create a",
    "start": "1753969",
    "end": "1761269"
  },
  {
    "text": "bootable thumb drive which you can just plug into the machine then the then the audio if you would be",
    "start": "1761269",
    "end": "1768240"
  },
  {
    "text": "executed automatically then you can actually scan your entire machine for",
    "start": "1768240",
    "end": "1774290"
  },
  {
    "text": "drivers we should not be there or modified firmware as well then it has a",
    "start": "1774290",
    "end": "1781440"
  },
  {
    "text": "scanner application which works under you fi shell you can you have to actually have you fi shell to execute",
    "start": "1781440",
    "end": "1787830"
  },
  {
    "text": "that while it's executing it's logging and dumping all the information which it",
    "start": "1787830",
    "end": "1793080"
  },
  {
    "text": "finds on the onto the mountain hard drive or to the thumb drive from which",
    "start": "1793080",
    "end": "1798090"
  },
  {
    "text": "it was loaded so here is an example of how that would look like so this is a",
    "start": "1798090",
    "end": "1803840"
  },
  {
    "text": "you actually using the RDF you framework under vmware while you are booting the",
    "start": "1803840",
    "end": "1810450"
  },
  {
    "text": "system you would actually just press a button to select the boot manager that",
    "start": "1810450",
    "end": "1815970"
  },
  {
    "text": "brings you to the option of actually selecting which kind of boot device would you like to load there's an option",
    "start": "1815970",
    "end": "1821760"
  },
  {
    "text": "called internal shell even though it says it's an unsupported option it actually works just fine so you are",
    "start": "1821760",
    "end": "1828780"
  },
  {
    "text": "prompted to the to the shell of the efi interface where we can actually start",
    "start": "1828780",
    "end": "1834180"
  },
  {
    "text": "and low the rdf you which comes with its loading screen and then comes with a set",
    "start": "1834180",
    "end": "1840960"
  },
  {
    "text": "of options which enable you to do all sorts of cool things so it has a lot of options the first would be to list all",
    "start": "1840960",
    "end": "1847890"
  },
  {
    "text": "the handles which are present in the machine that would be equivalent to protocols as well you can list all",
    "start": "1847890",
    "end": "1853020"
  },
  {
    "text": "images dump all images to disks you can later on inspect them you can check the pointers you can list all the events you",
    "start": "1853020",
    "end": "1860700"
  },
  {
    "text": "can basically brute force can the the memory to try to find any images which",
    "start": "1860700",
    "end": "1866220"
  },
  {
    "text": "should not be there so if somebody has dynamically allocated memory and put in put an image there to basically execute",
    "start": "1866220",
    "end": "1872820"
  },
  {
    "text": "it that would be detected as well you can display the memory map you can dump",
    "start": "1872820",
    "end": "1878400"
  },
  {
    "text": "the firmware show the IDT nget as well and you can install resident scanners",
    "start": "1878400",
    "end": "1884520"
  },
  {
    "text": "that's an option which enables you to actually install RDF you so it monitors",
    "start": "1884520",
    "end": "1889890"
  },
  {
    "text": "the entire loading process until the operating system starts now this is this",
    "start": "1889890",
    "end": "1895410"
  },
  {
    "text": "was us actually running efi from shell other things have been loaded before this but the efi",
    "start": "1895410",
    "end": "1903190"
  },
  {
    "text": "shell comes with a startup script which enables you to install this as a resident scanner so it's automatically",
    "start": "1903190",
    "end": "1909490"
  },
  {
    "text": "executed every time you boot the machine that there's that option or you can actually manually install it if you have",
    "start": "1909490",
    "end": "1915429"
  },
  {
    "text": "root privileges or you are actually simulating the process of installing an",
    "start": "1915429",
    "end": "1920470"
  },
  {
    "text": "operating system so we're going to show a demo of how this RTF you actually",
    "start": "1920470",
    "end": "1926380"
  },
  {
    "text": "works I'm going to be using the VMware implementation so to show that that",
    "start": "1926380",
    "end": "1932320"
  },
  {
    "text": "works correctly so we've started the up",
    "start": "1932320",
    "end": "1939970"
  },
  {
    "text": "sorry actually have to do this so as I",
    "start": "1939970",
    "end": "1948160"
  },
  {
    "text": "mentioned before you'd have to select the boot manager option and there you have the internal shell when you go back",
    "start": "1948160",
    "end": "1955179"
  },
  {
    "text": "to that it actually loads and it enables you to do shell commands so things like",
    "start": "1955179",
    "end": "1962530"
  },
  {
    "text": "a listing files and so on can be supported depending on what the actual",
    "start": "1962530",
    "end": "1967650"
  },
  {
    "text": "implementation of unified extensible interface you are working with so this",
    "start": "1967650",
    "end": "1973540"
  },
  {
    "text": "one actually has our RDF you installed",
    "start": "1973540",
    "end": "1978880"
  },
  {
    "text": "on on a separate hard drive so here are mountain that drive and I've shown you",
    "start": "1978880",
    "end": "1985090"
  },
  {
    "text": "that all of those things are there so all I need to do now is load our scanner so load efi scanner application this is",
    "start": "1985090",
    "end": "1992590"
  },
  {
    "text": "a 64-bit application so we are loading a driver which will show the logo of our",
    "start": "1992590",
    "end": "1997720"
  },
  {
    "text": "tool and then following that you have all of the options which are available",
    "start": "1997720",
    "end": "2003150"
  },
  {
    "text": "so for example which is going to list all the handles which are available and we can dump the firmware as well so we",
    "start": "2003150",
    "end": "2010770"
  },
  {
    "text": "can dump the firmware Rome that's G and that's a now dumped on the same hard",
    "start": "2010770",
    "end": "2016020"
  },
  {
    "text": "drive you can actually do your analysis there you can do brute force scanning",
    "start": "2016020",
    "end": "2021270"
  },
  {
    "text": "for other efi drivers that will be listed here as",
    "start": "2021270",
    "end": "2026500"
  },
  {
    "text": "well in in the log so which is going to quit now and i'm going to show you that",
    "start": "2026500",
    "end": "2033120"
  },
  {
    "text": "dfi actually comes with the with some",
    "start": "2033120",
    "end": "2039250"
  },
  {
    "text": "tools which enable you to actually inspect this without actually going to windows or any other operating system to",
    "start": "2039250",
    "end": "2045670"
  },
  {
    "text": "actually view those things so this will be just you inspecting that log with a",
    "start": "2045670",
    "end": "2052148"
  },
  {
    "text": "text editor which is basically available with this implementation of the efi shell so at the end as you can see we've",
    "start": "2052149",
    "end": "2058388"
  },
  {
    "text": "done the firmware it's on our USB thumb drive you can inspect it later on load",
    "start": "2058389",
    "end": "2064929"
  },
  {
    "text": "it in either pro or anything like that so that is how how the how the rdf you",
    "start": "2064929",
    "end": "2072970"
  },
  {
    "text": "works so next we will be so one side",
    "start": "2072970",
    "end": "2083730"
  },
  {
    "text": "so next we will be talking about the specific boot kit which we ourselves wrote for the mac OS and we will go into",
    "start": "2084389",
    "end": "2093628"
  },
  {
    "text": "details of how this book it was created and what what was our intention bullets",
    "start": "2093629",
    "end": "2099480"
  },
  {
    "text": "tool as well so we had a goal and that was to do certain things of which normal",
    "start": "2099480",
    "end": "2106829"
  },
  {
    "text": "boot kids and rookies will be doing that that is creating hidden content so creating hidden folders even restoring",
    "start": "2106829",
    "end": "2114210"
  },
  {
    "text": "that restoring those folders as well so we wanted to be able to hide running",
    "start": "2114210",
    "end": "2121049"
  },
  {
    "text": "processes and show them back again as well we wanted to have a an ability to",
    "start": "2121049",
    "end": "2127140"
  },
  {
    "text": "elevate privilege and have a shell which gives us Ruth privilege so we can do anything we want and the bonus points",
    "start": "2127140",
    "end": "2133769"
  },
  {
    "text": "would be asked receiving default file Walt password if it was available so how",
    "start": "2133769",
    "end": "2139950"
  },
  {
    "text": "does this boot kit work so we tested this on the live Mac OS machine we don't",
    "start": "2139950",
    "end": "2147240"
  },
  {
    "text": "have one present today however the vmware implementation will suffice so",
    "start": "2147240",
    "end": "2153779"
  },
  {
    "text": "for that if you were using this on a lie machine the option would be just using",
    "start": "2153779",
    "end": "2161190"
  },
  {
    "text": "the rdf you to create a bootable USB thumb drive which can n-able you to",
    "start": "2161190",
    "end": "2168089"
  },
  {
    "text": "basically boot NOS to that thumb drive you just copy our boot kit code which",
    "start": "2168089",
    "end": "2173369"
  },
  {
    "text": "automatically scans all the partitions and then the selects mac OS loads it and",
    "start": "2173369",
    "end": "2178589"
  },
  {
    "text": "does all of the things we've mentioned in a sec automatically so since we don't",
    "start": "2178589",
    "end": "2184019"
  },
  {
    "text": "have a macbook present here is what we opted to do we wanted to do this in",
    "start": "2184019",
    "end": "2189480"
  },
  {
    "text": "vmware so the vmware is perfectly fine because the mac OS can run in it it runs",
    "start": "2189480",
    "end": "2198000"
  },
  {
    "text": "in it only if you have an unofficial patch sadly so you have to patch your",
    "start": "2198000",
    "end": "2204280"
  },
  {
    "text": "VMware to be able to actually execute Mac OS Android and the only thing you",
    "start": "2204280",
    "end": "2210070"
  },
  {
    "text": "have to add after that is make sure that vmx file has the firmware option efi",
    "start": "2210070",
    "end": "2215800"
  },
  {
    "text": "enabled that enables the vmware to actually run with ef ef I interface",
    "start": "2215800",
    "end": "2221880"
  },
  {
    "text": "after that Mac OS is installed and it has a support for the version 1.9 of the",
    "start": "2221880",
    "end": "2228160"
  },
  {
    "text": "FI stand standard so how does the boot kit work here's the typical workflow the",
    "start": "2228160",
    "end": "2235210"
  },
  {
    "start": "2233000",
    "end": "2233000"
  },
  {
    "text": "EF the you fi is loaded it loads are malicious driver which then registers",
    "start": "2235210",
    "end": "2243310"
  },
  {
    "text": "for an event and this event is called a virtual address change and that means",
    "start": "2243310",
    "end": "2248620"
  },
  {
    "text": "that when this event is fired basically the operating system is being loaded so",
    "start": "2248620",
    "end": "2254530"
  },
  {
    "text": "all the drivers which are still running all the runtime drivers which are still",
    "start": "2254530",
    "end": "2259810"
  },
  {
    "text": "running I have to adjust for transitioning from the physical addressing mode to the virtual virtual",
    "start": "2259810",
    "end": "2266170"
  },
  {
    "text": "addressing mode and this is what this event will do we also hook a specific",
    "start": "2266170",
    "end": "2272710"
  },
  {
    "text": "system table function which is read keystroke that enables us to actually",
    "start": "2272710",
    "end": "2278370"
  },
  {
    "text": "sniff all the keys the user has typed in while booting the machine the idea here",
    "start": "2278370",
    "end": "2285400"
  },
  {
    "text": "is that if file walt is installed then the user has to enter the password and",
    "start": "2285400",
    "end": "2291730"
  },
  {
    "text": "that ha comes through the keyboard so since we are logging all the keys we would get this password once the system",
    "start": "2291730",
    "end": "2297580"
  },
  {
    "text": "is loaded so there's a fail-safe unless if something goes wrong we've registered",
    "start": "2297580",
    "end": "2304120"
  },
  {
    "text": "ourselves for the unload protocol which means that our loading has failed and we",
    "start": "2304120",
    "end": "2309250"
  },
  {
    "text": "just have to click basically clean up after that we have to load mac OS",
    "start": "2309250",
    "end": "2314860"
  },
  {
    "text": "because our budget has been installed so Lulu loading Mac OS is basically enumerated all drives which has to have",
    "start": "2314860",
    "end": "2322360"
  },
  {
    "text": "a specific efi image present user has a choice of selecting which efi boot efi",
    "start": "2322360",
    "end": "2330040"
  },
  {
    "text": "gets loaded if there are multiple ones but if there's just one found we automatically boot to it as well so we",
    "start": "2330040",
    "end": "2336040"
  },
  {
    "text": "just low damage too low that efi image and then we started so that at that point",
    "start": "2336040",
    "end": "2342070"
  },
  {
    "text": "mac OS starts the rooting process and we get signaled by the event when the mac",
    "start": "2342070",
    "end": "2349300"
  },
  {
    "text": "OS bootloader calls SAT virtual address map so that triggers that event which I",
    "start": "2349300",
    "end": "2355450"
  },
  {
    "text": "mentioned which is the virtual which is the virtual address change that tells us the mac OS is ready to be booted and",
    "start": "2355450",
    "end": "2361930"
  },
  {
    "text": "that the next command it will it will call is the one which actually unloads all the all the drivers which are",
    "start": "2361930",
    "end": "2368800"
  },
  {
    "text": "running only during the boot that triggers the part of the code which",
    "start": "2368800",
    "end": "2374200"
  },
  {
    "text": "actually locates the siskel table and from that cisco table we are just hooking a few functions which enable us",
    "start": "2374200",
    "end": "2380860"
  },
  {
    "text": "to do all those things we set to do so we are cooking the set uid get directory",
    "start": "2380860",
    "end": "2387190"
  },
  {
    "text": "entries get their attributes and an sis call as well so how do we actually get",
    "start": "2387190",
    "end": "2392620"
  },
  {
    "text": "root this is a small c application which actually enables you to get root so we",
    "start": "2392620",
    "end": "2398800"
  },
  {
    "text": "try to set our user ID to a specific number the specific number has been hard coded inside the the boot kit so as soon",
    "start": "2398800",
    "end": "2406540"
  },
  {
    "text": "as our boot kit in in the kernel level sees this user ID it knows to elevate",
    "start": "2406540",
    "end": "2411970"
  },
  {
    "text": "the privilege of that process to root so how do we hide processes this is yet",
    "start": "2411970",
    "end": "2417970"
  },
  {
    "start": "2416000",
    "end": "2416000"
  },
  {
    "text": "another short snippet which is basically us running a cisco event with with the",
    "start": "2417970",
    "end": "2424870"
  },
  {
    "text": "motor set of parameters which are analyzed by the boot kit itself which then knows what to do and in this case",
    "start": "2424870",
    "end": "2432160"
  },
  {
    "text": "which is just adding a new process to be hidden so with that we have a demo of",
    "start": "2432160",
    "end": "2439210"
  },
  {
    "text": "how that actually works and let me just put up micro s once again",
    "start": "2439210",
    "end": "2446309"
  },
  {
    "text": "so yet again since I'm using the VMware implementation this actually has this",
    "start": "2449020",
    "end": "2458170"
  },
  {
    "text": "actually has to be done manually if I was using a physical machine I could",
    "start": "2458170",
    "end": "2463240"
  },
  {
    "text": "just plug in a thumb drive and all this would be happening automatically the only thing I had to do is select that I",
    "start": "2463240",
    "end": "2469150"
  },
  {
    "text": "want to boot from a thumb drive so this I go to the internal shallow option and",
    "start": "2469150",
    "end": "2475290"
  },
  {
    "text": "then I basically just go to the mountain",
    "start": "2475290",
    "end": "2481090"
  },
  {
    "text": "hard drive and load the boot kit code that automatically finds the mac OS",
    "start": "2481090",
    "end": "2489400"
  },
  {
    "text": "partition it loads it's a booty fi code and it's patched all the things behind",
    "start": "2489400",
    "end": "2496510"
  },
  {
    "text": "it so what's not happening now is the OS is loading that to take a while since we are on the Virtual Machine",
    "start": "2496510",
    "end": "2503440"
  },
  {
    "text": "implementation once we we have booted out log in and I'll show you that all",
    "start": "2503440",
    "end": "2508930"
  },
  {
    "text": "the functionality which we mentioned which is hiding processes hiding folders",
    "start": "2508930",
    "end": "2514540"
  },
  {
    "text": "and so on actually does work so we're loading and that's going to give us into",
    "start": "2514540",
    "end": "2523390"
  },
  {
    "text": "the shop so here as you can see we can do all sorts of things here I have all",
    "start": "2523390",
    "end": "2530230"
  },
  {
    "text": "those applications written in C and they have all been compiled so we don't have to do that again so let's do the first",
    "start": "2530230",
    "end": "2537340"
  },
  {
    "text": "thing first let's hide this process so the process ID for bash currently is 140",
    "start": "2537340",
    "end": "2542890"
  },
  {
    "text": "so I can just add FB ID 140 and that's going to be hidden now as you can see",
    "start": "2542890",
    "end": "2550120"
  },
  {
    "text": "process list is is basically empty we can unhide that as well by remove pit so",
    "start": "2550120",
    "end": "2557110"
  },
  {
    "text": "the same PID and then we can show that this process is now visible yet again in",
    "start": "2557110",
    "end": "2563350"
  },
  {
    "text": "addition to that we can create a hidden folder so mkay there so it's actually",
    "start": "2563350",
    "end": "2569740"
  },
  {
    "text": "hard coded to to this first string but the other part of the string you can type in anything you like so a listing",
    "start": "2569740",
    "end": "2577480"
  },
  {
    "text": "of directories actually doesn't show this one but it's access anyway so we are in this folder there",
    "start": "2577480",
    "end": "2585700"
  },
  {
    "text": "are no files there but we can just create one and as you can see there's a",
    "start": "2585700",
    "end": "2592840"
  },
  {
    "text": "file there now so we can just remove that since we don't need it and go back",
    "start": "2592840",
    "end": "2601720"
  },
  {
    "text": "one level to remove that folder",
    "start": "2601720",
    "end": "2605340"
  },
  {
    "text": "so again folders gone but it wasn't shown there as well the last thing we need to do is to elevate privilege so",
    "start": "2609560",
    "end": "2618650"
  },
  {
    "text": "currently i'm a user but if i wanted to get root all I had to do is execute shell did that C code as you remember",
    "start": "2618650",
    "end": "2625490"
  },
  {
    "text": "has only two lines so executing shell and then we got rude from this point we",
    "start": "2625490",
    "end": "2633530"
  },
  {
    "text": "can do anything we like we can even install our boot kit permanently by accessing the efi partition and",
    "start": "2633530",
    "end": "2639560"
  },
  {
    "text": "installing it so it loads every time so the boot kit right now it is loaded but",
    "start": "2639560",
    "end": "2645290"
  },
  {
    "text": "if i were to reboot it would not be loaded at all so all the changes have done i would not matter so all those",
    "start": "2645290",
    "end": "2652010"
  },
  {
    "text": "hidden folders will be visible so the boot kit is on only in memory so that",
    "start": "2652010",
    "end": "2657470"
  },
  {
    "text": "concludes the Bukit presentation and that brings us to",
    "start": "2657470",
    "end": "2664750"
  },
  {
    "text": "to the reminder of our talk",
    "start": "2668180",
    "end": "2672700"
  },
  {
    "text": "so we've done all this and hear that was the demo so what can you do with already",
    "start": "2674810",
    "end": "2681740"
  },
  {
    "text": "a few you can use the EFI shell some of its functionality even though even if",
    "start": "2681740",
    "end": "2688220"
  },
  {
    "text": "there is no efi shell available as i said the documentation and specification",
    "start": "2688220",
    "end": "2695090"
  },
  {
    "text": "does not require shell to be present you can check which are the installed and loaded efi components you can scan the",
    "start": "2695090",
    "end": "2702080"
  },
  {
    "text": "environment for hidden ones and you can actually modify it source code to make it a act like secure boot so we can",
    "start": "2702080",
    "end": "2709100"
  },
  {
    "text": "actually check all the installed and running drivers and you can unload things you don't like or you can just",
    "start": "2709100",
    "end": "2716240"
  },
  {
    "text": "report them as well for that you will have to modify the source code which brings us to where you can where you can",
    "start": "2716240",
    "end": "2721760"
  },
  {
    "text": "get it so it's available on our website now you can go and download the source code you can get almost everything the",
    "start": "2721760",
    "end": "2728990"
  },
  {
    "text": "only thing we have not felt publicly we have not published is the boot kit source code because this was a DARPA",
    "start": "2728990",
    "end": "2735890"
  },
  {
    "text": "sponsored project we wouldn't be feeling comfortable to release a code that actually does malicious things so the",
    "start": "2735890",
    "end": "2742160"
  },
  {
    "text": "scanner and its source code are actually available on our website right now that concludes our talk but we are we will be",
    "start": "2742160",
    "end": "2749780"
  },
  {
    "text": "taking questions and answers so you are",
    "start": "2749780",
    "end": "2758170"
  },
  {
    "text": "yep yep",
    "start": "2758760",
    "end": "2763619"
  },
  {
    "text": "so the book is so how can you install a book it permanently and while you do",
    "start": "2770390",
    "end": "2776420"
  },
  {
    "text": "that manually by basically writing it over the original loader code so for the",
    "start": "2776420",
    "end": "2782720"
  },
  {
    "text": "mac OS and then you can just rename that to any any other application and load it normally so you can do that how would",
    "start": "2782720",
    "end": "2794390"
  },
  {
    "text": "they remove it the well the efi partition from from the efi layer is",
    "start": "2794390",
    "end": "2800029"
  },
  {
    "text": "read-only so the only way to actually remove it is from the operating system so the same way we install that you can",
    "start": "2800029",
    "end": "2806150"
  },
  {
    "text": "uninstall it as well just by overwriting with it with the original binary with",
    "start": "2806150",
    "end": "2814250"
  },
  {
    "text": "the RT of you know our fu is just the scanner it doesn't prevent anything it just reports things yeah we can you have",
    "start": "2814250",
    "end": "2822260"
  },
  {
    "text": "a potential to do that if you modify the source code then you have a pro you can",
    "start": "2822260",
    "end": "2827869"
  },
  {
    "text": "basically go through the entire file system make sure that all the images are still correct and you are basically",
    "start": "2827869",
    "end": "2833950"
  },
  {
    "text": "implementing your own secure boot any other questions",
    "start": "2833950",
    "end": "2840519"
  },
  {
    "text": "one it's actually loaded by the it's",
    "start": "2844440",
    "end": "2850460"
  },
  {
    "text": "available through the firmware so the firmware is the thing which enables you to use these dysfunctionality it's",
    "start": "2850460",
    "end": "2856430"
  },
  {
    "text": "actually in the room and you can actually dump it with our tool and you",
    "start": "2856430",
    "end": "2865970"
  },
  {
    "text": "know now we have to be at the EFI level but you can create a bootable thumb drive which just enables you to boot",
    "start": "2865970",
    "end": "2872660"
  },
  {
    "text": "already a few normally and then just run the run the operating system after that",
    "start": "2872660",
    "end": "2878950"
  },
  {
    "text": "no there's no eyes level you strove it it has to be loaded before the operating system anybody else",
    "start": "2878950",
    "end": "2888338"
  },
  {
    "text": "so I'm not missing anybody to be it well thank you very much for your time",
    "start": "2890800",
    "end": "2898320"
  }
]