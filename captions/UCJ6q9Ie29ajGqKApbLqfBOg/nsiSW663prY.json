[
  {
    "text": "bye",
    "start": "28240",
    "end": "31240"
  },
  {
    "text": "oh",
    "start": "41120",
    "end": "44120"
  },
  {
    "text": "i hope you guys are enjoying it this is my fourth time around this place always a blast out here in caesars",
    "start": "50000",
    "end": "56719"
  },
  {
    "text": "so um what am i here to do i'm here to give you guys a talk about some new ways to manipulate",
    "start": "56719",
    "end": "63359"
  },
  {
    "text": "networks new ways to manipulate client servers and whatnot um",
    "start": "63359",
    "end": "68880"
  },
  {
    "text": "something going on funny we should uh bring this up this is",
    "start": "68880",
    "end": "74640"
  },
  {
    "text": "not gonna be a normal talk where i just go on and blather and whatnot and you either absorb it or you don't um",
    "start": "74640",
    "end": "82080"
  },
  {
    "text": "i'm all into that whole audience participation thing so listen",
    "start": "82080",
    "end": "87200"
  },
  {
    "text": "let yourself get annoyed at what i say get pissed off figure out the holes and if i like them you'll get stuff that's",
    "start": "87200",
    "end": "93200"
  },
  {
    "text": "how i work there are absolutely attacks against some of the things i'm going to mention",
    "start": "93200",
    "end": "99439"
  },
  {
    "text": "hopefully some of you will figure them out before i even bring them up so let's go ahead and start out",
    "start": "99439",
    "end": "107280"
  },
  {
    "text": "my philosophy of security peace through superior firepower",
    "start": "109119",
    "end": "114560"
  },
  {
    "text": "um i kind of have a problem with the concept that attackers are the only people who get to play with fun toys um",
    "start": "114560",
    "end": "122399"
  },
  {
    "text": "i actually have a problem with attacking not in the sense that you know how dare you go break into a machine but like",
    "start": "122399",
    "end": "127520"
  },
  {
    "text": "buffer overflows are 30 years old they're older than i am time to move on",
    "start": "127520",
    "end": "133120"
  },
  {
    "text": "so um i came up with this talk last year called black ops at tcpip which",
    "start": "133120",
    "end": "138720"
  },
  {
    "text": "apparently people liked um it was the precursor to a set of tools known as the paquetto kiwetsu and i'm",
    "start": "138720",
    "end": "146000"
  },
  {
    "text": "hoping i pronounced that right i'm sure there's a japanese individual in the audience who will loudly correct me if i'm wrong",
    "start": "146000",
    "end": "152000"
  },
  {
    "text": "had a bunch of tools for various strange modal modalities of network manipulation scan random vast",
    "start": "152000",
    "end": "158239"
  },
  {
    "text": "support scanner minute a implementation of nat and so on so the goal was to bring new tools to the table",
    "start": "158239",
    "end": "165680"
  },
  {
    "text": "keeping with the primary advantage of the defender which is basically there's no need for stealth when you're",
    "start": "165680",
    "end": "172400"
  },
  {
    "text": "on defense um scanrand is a very loud port scanner",
    "start": "172400",
    "end": "178000"
  },
  {
    "text": "stealthy it ain't when you're dropping i don't know 60 000 packets a second it's not that hard to",
    "start": "178000",
    "end": "184800"
  },
  {
    "text": "get noticed people i mentioned this because i saw one review of scanner and they're like wow this is really stealthy",
    "start": "184800",
    "end": "190640"
  },
  {
    "text": "i'm like who are you",
    "start": "190640",
    "end": "195280"
  },
  {
    "text": "all right so if this thing will actually advance the slide that was the past this is the present as",
    "start": "196560",
    "end": "203680"
  },
  {
    "text": "promised code actual code and a link to the slightly updated slides no i didn't",
    "start": "203680",
    "end": "210080"
  },
  {
    "text": "go ahead and make all your books useless but i did go ahead and add a little bit of extra context based off what some",
    "start": "210080",
    "end": "215200"
  },
  {
    "text": "people had mentioned so that's where to get the code described in this talk well most of it i forgot",
    "start": "215200",
    "end": "221040"
  },
  {
    "text": "the ssl dump patch but you'll hear about that later that's where to get the code",
    "start": "221040",
    "end": "227200"
  },
  {
    "text": "and that's where to get the slides and i'll leave that up for a minute for those who wish to write it down or",
    "start": "227200",
    "end": "232560"
  },
  {
    "text": "whatnot everyone got that who cares",
    "start": "232560",
    "end": "239200"
  },
  {
    "text": "okay",
    "start": "239599",
    "end": "241840"
  },
  {
    "text": "now i do have to mention this is not this is not paquetto 2 this is not 2.0",
    "start": "245680",
    "end": "251519"
  },
  {
    "text": "this is 1.99 there are missing tools there are chunks that did not make it the distribution as is is linux specific",
    "start": "251519",
    "end": "259440"
  },
  {
    "text": "um for those who don't know by the way about nopex std nopix as a whole is a",
    "start": "259440",
    "end": "266000"
  },
  {
    "text": "linux distribution that runs from cd std the security tools distribution",
    "start": "266000",
    "end": "271280"
  },
  {
    "text": "horribly named my god i've got stds",
    "start": "271280",
    "end": "278400"
  },
  {
    "text": "no um no but it's actually really really well done in useful distribution so i've been using this for a lot of my development",
    "start": "278400",
    "end": "284960"
  },
  {
    "text": "and just thought i'd mention that because that may be one of the few distress built under",
    "start": "284960",
    "end": "290320"
  },
  {
    "text": "i'm hoping not i've tested it around a bit but anyway so",
    "start": "290320",
    "end": "295440"
  },
  {
    "text": "we are going to go a little bit out order this is the only outer order in the entire",
    "start": "295440",
    "end": "300880"
  },
  {
    "text": "uh slides and why did i start with layer 7 the generic activex encapsulation hack",
    "start": "300880",
    "end": "307120"
  },
  {
    "text": "really simple it's the simplest thing i brought up and it has nothing to do with tcpip",
    "start": "307120",
    "end": "312800"
  },
  {
    "text": "this is completely different than the rest of the talk but it's a really cool hack i've been using this for like two years and i finally decided okay i might",
    "start": "312800",
    "end": "320400"
  },
  {
    "text": "as well go ahead and share it so what am i talking about is it possible to use activex to deploy something besides",
    "start": "320400",
    "end": "326160"
  },
  {
    "text": "spyware well i know or else you know you'd see other things by spyware and i don't know the occasional macromedia",
    "start": "326160",
    "end": "332080"
  },
  {
    "text": "flash install um check this out guys oh yeah you see all those windows down",
    "start": "332080",
    "end": "338800"
  },
  {
    "text": "there yeah that's what i was furiously typing i'm actually doing live demos here today",
    "start": "338800",
    "end": "344560"
  },
  {
    "text": "so that means i have like eight ssh sessions open for all these things",
    "start": "344560",
    "end": "350560"
  },
  {
    "text": "actually navigating this not going to be fun but hopefully you guys will enjoy the result now if i can get a web server up",
    "start": "350560",
    "end": "358000"
  },
  {
    "text": "and people aren't hijacking links please don't hijack my link i need that",
    "start": "358000",
    "end": "363600"
  },
  {
    "text": "that means you so we go over to docsparrow.com actually i think it's just apps now",
    "start": "363600",
    "end": "371360"
  },
  {
    "text": "so these are various applications now i wonder what they what happens if i click on them",
    "start": "371360",
    "end": "376720"
  },
  {
    "text": "let's go ahead and click on putty",
    "start": "376720",
    "end": "380680"
  },
  {
    "text": "we get this little window do you want to run the putty ssh client i say yes",
    "start": "384800",
    "end": "390720"
  },
  {
    "text": "hey look it's a ssh client out of a web page it turns out",
    "start": "390720",
    "end": "396160"
  },
  {
    "text": "activex which you know theoretically you're supposed to take like an ocx file and uh",
    "start": "396160",
    "end": "402000"
  },
  {
    "text": "pack it up and you know specifically program it to be run off a web page",
    "start": "402000",
    "end": "407120"
  },
  {
    "text": "yeah that's not entirely mandatory you can pretty much take any windows program",
    "start": "407120",
    "end": "414080"
  },
  {
    "text": "put it into an object in an html page sign it correctly and it'll load in fact",
    "start": "414080",
    "end": "420240"
  },
  {
    "text": "if you go we go ahead and we look at the source for this page which i have no idea is even going to be readable",
    "start": "420240",
    "end": "426080"
  },
  {
    "text": "now you see how there's this class id down here windows doesn't care",
    "start": "426080",
    "end": "432160"
  },
  {
    "text": "whatever it's got an exe file doesn't care either it just works and i so i've actually put together a",
    "start": "432160",
    "end": "438479"
  },
  {
    "text": "decent little collection of toys you know we've got our uh pimon a packet monitor made a pad a",
    "start": "438479",
    "end": "444240"
  },
  {
    "text": "little text editor plural where you push some guy down a flight of stairs no i'm",
    "start": "444240",
    "end": "449360"
  },
  {
    "text": "actually serious that's actually the point of the game this is basically my way of saying you",
    "start": "449360",
    "end": "454720"
  },
  {
    "text": "know if activex is going to be insecure can't it at least be useful",
    "start": "454720",
    "end": "461280"
  },
  {
    "text": "this may be the happiest security advisory you will ever receive okay we got a question already go ahead",
    "start": "463280",
    "end": "469199"
  },
  {
    "text": "shout it out ah",
    "start": "469199",
    "end": "475360"
  },
  {
    "text": "perfect question makes me so happy with these slides that i wrote here's what you do",
    "start": "475360",
    "end": "482240"
  },
  {
    "text": "well hello so so i actually uh after this talk i'll go ahead and i'll put up a link to all",
    "start": "484560",
    "end": "490879"
  },
  {
    "text": "the tiny little executables that you need first you make a cert you've got like i don't know 15 characters to type then",
    "start": "490879",
    "end": "497520"
  },
  {
    "text": "you have to convert it to an spc file and it was like what 10 characters and then you read this really big and",
    "start": "497520",
    "end": "503919"
  },
  {
    "text": "scary sign code and it doesn't really matter what the app is you know the just you",
    "start": "503919",
    "end": "509680"
  },
  {
    "text": "know the dash n is the name when it said putty ssh client i say random file",
    "start": "509680",
    "end": "515599"
  },
  {
    "text": "the time stamp is interesting verisign will actually stamp arbitrary data say",
    "start": "515599",
    "end": "521039"
  },
  {
    "text": "whatever it is you just sent me i saw it at this time this happens to be a really",
    "start": "521039",
    "end": "526080"
  },
  {
    "text": "cool public service people should use it more like you know you have a message you want to prove that you",
    "start": "526080",
    "end": "532399"
  },
  {
    "text": "had it signed at a certain time verizon will sign it for you this is very nice good job guys i'm going at the",
    "start": "532399",
    "end": "538880"
  },
  {
    "text": "end you name like your executable and then your html and it'll be big and complicated but you see that class id",
    "start": "538880",
    "end": "544880"
  },
  {
    "text": "remember not checked now that's all you have to do but this isn't",
    "start": "544880",
    "end": "550480"
  },
  {
    "text": "interesting why is this not interesting because if i just go ahead and i put a link and i say the a the href is an",
    "start": "550480",
    "end": "556480"
  },
  {
    "text": "executable file outlook express will say that's a really nice executable do you want me to run this executable at the",
    "start": "556480",
    "end": "562880"
  },
  {
    "text": "end of the day it's an equal number of clicks now let's say i had a valid certificate signing you know i was a by",
    "start": "562880",
    "end": "570240"
  },
  {
    "text": "the way you can't actually get a valid certificate for software publishing you have to be publishing spyware to get one",
    "start": "570240",
    "end": "576399"
  },
  {
    "text": "of those certificates i wish i was kidding",
    "start": "576399",
    "end": "582320"
  },
  {
    "text": "now that's not interest this is not interesting it's still just one click whether it's a valid cert an invalid",
    "start": "582320",
    "end": "587760"
  },
  {
    "text": "server if you just throw the exe onto a uh onto an href that's this isn't cool",
    "start": "587760",
    "end": "593920"
  },
  {
    "text": "ah but this is a lot of windows applications require support files",
    "start": "593920",
    "end": "600320"
  },
  {
    "text": "like um oh this is gonna take a minute but why not",
    "start": "600320",
    "end": "606800"
  },
  {
    "text": "so a lot of windows applications require support files they're not just a single executable this is often a pain you know you",
    "start": "608720",
    "end": "616000"
  },
  {
    "text": "you have to you know get the file unzip it put it somewhere temporary or even worse",
    "start": "616000",
    "end": "622800"
  },
  {
    "text": "have to run an installer throws crap in your start menu like all this stuff you got to do just because you wanted you",
    "start": "622800",
    "end": "629839"
  },
  {
    "text": "know a stupid little windows app for a minute so check this out",
    "start": "629839",
    "end": "635680"
  },
  {
    "text": "you know before i showed you putty yeah this is a full-on signal distribution that i put together it's like two and a",
    "start": "635680",
    "end": "641360"
  },
  {
    "text": "half megs and as you can see it has lots of files you know",
    "start": "641360",
    "end": "646399"
  },
  {
    "text": "here's what you do windows has a built-in archive format it's called cab you should be familiar",
    "start": "646399",
    "end": "652880"
  },
  {
    "text": "with this because all your windows apps are in cabs or all your windows installs and cabs well what you do is you take",
    "start": "652880",
    "end": "658399"
  },
  {
    "text": "your cab cabs can be signed you sign the cap but before you sign the cab you put in an inf file and the inf",
    "start": "658399",
    "end": "666800"
  },
  {
    "text": "file says here's how you should set up this application now the syntax is obscure but all you",
    "start": "666800",
    "end": "672959"
  },
  {
    "text": "really got to pay attention to is right here the hook and the run extractor",
    "start": "672959",
    "end": "678480"
  },
  {
    "text": "startup that's it you just say you know here's what you got to do to start up my",
    "start": "678480",
    "end": "683600"
  },
  {
    "text": "application while the app's running all the files will be locked so they won't go away",
    "start": "683600",
    "end": "689519"
  },
  {
    "text": "the user closes the app the temporary setup directory which happens to be running your nice useful executable like",
    "start": "689519",
    "end": "695600"
  },
  {
    "text": "the sigmund we just saw sticks around or gets deleted and to generate a cab i",
    "start": "695600",
    "end": "701200"
  },
  {
    "text": "know it's another 10 characters but i think we can all survive so that's it this is cool because this",
    "start": "701200",
    "end": "707360"
  },
  {
    "text": "lets you go ahead and take really complicated apps and just sort of shove them on a web page it's fun",
    "start": "707360",
    "end": "713200"
  },
  {
    "text": "so that's nice let's go screw with the net um",
    "start": "713200",
    "end": "719279"
  },
  {
    "text": "so is it possible to acquire a usable ip address on a network that lacks a dhc",
    "start": "719279",
    "end": "724720"
  },
  {
    "text": "dhcp server yeah it's possible it's not as easy as i thought it would be when i shoved that description into the black",
    "start": "724720",
    "end": "731120"
  },
  {
    "text": "cat thing oh well they bought it so the classic",
    "start": "731120",
    "end": "736560"
  },
  {
    "text": "don't worry i have something really cool for you guys you'll like it so the classic approach",
    "start": "736560",
    "end": "741680"
  },
  {
    "text": "you smith the network you look for broadcasted art addresses or you look for arcs look for basically people",
    "start": "741680",
    "end": "747680"
  },
  {
    "text": "saying hello you know what mac address has this ip and you basically you know you see a",
    "start": "747680",
    "end": "752800"
  },
  {
    "text": "couple of these and you find a gap and you go ahead and you send out your own request hello does anyone have this ip",
    "start": "752800",
    "end": "758079"
  },
  {
    "text": "address and if nobody has it you go ahead and you take it this has been done a thousand times it's done that by",
    "start": "758079",
    "end": "763519"
  },
  {
    "text": "everybody for those who are familiar with how arp works arp is basically the way you go from some globally valid ip",
    "start": "763519",
    "end": "770560"
  },
  {
    "text": "address or at least some ip address since not all of them are globally valid and you get to something that actually",
    "start": "770560",
    "end": "776079"
  },
  {
    "text": "makes sense on ethernet because on ethernet you don't get from one place to another with an ip address you get there",
    "start": "776079",
    "end": "782160"
  },
  {
    "text": "with a mac address so what you basically do is you say you know hey i'm going to go",
    "start": "782160",
    "end": "787440"
  },
  {
    "text": "to somewhere local so how do i get there locally think of it kind of like",
    "start": "787440",
    "end": "792639"
  },
  {
    "text": "you know i should i'm going to explain this for a second for those in the audience who don't entirely know because",
    "start": "792639",
    "end": "798000"
  },
  {
    "text": "some of the later stuff really gets messy i'll explain this okay",
    "start": "798000",
    "end": "804560"
  },
  {
    "text": "you can kind of think of local routing versus remote routing as taking a cab to",
    "start": "804560",
    "end": "809680"
  },
  {
    "text": "somewhere in the town to taking cab to the airport if you're going in town you're just going to take a cab if",
    "start": "809680",
    "end": "815760"
  },
  {
    "text": "you're going to the airport you're still going to take a cab but you're going to take a cab to the airport which has much",
    "start": "815760",
    "end": "821839"
  },
  {
    "text": "better capacity for getting you from point a to point you know zimbabwe",
    "start": "821839",
    "end": "827200"
  },
  {
    "text": "so ethernet's pretty much the same way for local traffic you're going to use the",
    "start": "827200",
    "end": "832800"
  },
  {
    "text": "cat you're going to use the cab no matter what but if you're going to somewhere local you're going to tell the cab driver where locally to take you if",
    "start": "832800",
    "end": "839279"
  },
  {
    "text": "you're going somewhere remote you're always going to tell them to go to the airport so that's the analogy for you to work with now here's some sort of new",
    "start": "839279",
    "end": "845920"
  },
  {
    "text": "techniques that may be a little bit known but not too much first of all um routers will route",
    "start": "845920",
    "end": "853360"
  },
  {
    "text": "the airport has more taxis is kind of the initial it's kind of the analogy here you can send a packet",
    "start": "853360",
    "end": "859760"
  },
  {
    "text": "you know you you could have just sent it directly to the right mac address no no but instead you're going to send",
    "start": "859760",
    "end": "866880"
  },
  {
    "text": "this package to the router the equivalent of the airport and it's going to bounce off the router and go where it",
    "start": "866880",
    "end": "873680"
  },
  {
    "text": "should have gone originally now why is this useful because one of the things we have to do when we're on a random",
    "start": "873680",
    "end": "879680"
  },
  {
    "text": "network is we need to see is this a router is this going to go ahead and send packets places so what we do is we",
    "start": "879680",
    "end": "887120"
  },
  {
    "text": "basically you know we found a free ip but there's a bunch of different ips out there we don't know which one is",
    "start": "887120",
    "end": "894480"
  },
  {
    "text": "we don't know which one's a router or not basically what we do is we spoof a packet from uh",
    "start": "894480",
    "end": "900720"
  },
  {
    "text": "how do i explain this we basically send a packet to ourselves spoofed from someone else but we send it",
    "start": "900720",
    "end": "907279"
  },
  {
    "text": "to each of the mac addresses that we've seen on the network and whichever packet bounces off what we now detect as the",
    "start": "907279",
    "end": "913839"
  },
  {
    "text": "router and hits us we now know if we send it packets these packets will go onwards and upwards to some you know",
    "start": "913839",
    "end": "921199"
  },
  {
    "text": "site that we wish to go to hallelujah um and you can do subnet",
    "start": "921199",
    "end": "928000"
  },
  {
    "text": "detection in somewhat of a similar way basically the router is only going to arp and only going to send you back the",
    "start": "928000",
    "end": "933519"
  },
  {
    "text": "packet if you're in it subnet or else it's going to go to its default gateway so",
    "start": "933519",
    "end": "938800"
  },
  {
    "text": "the end result being you um basically try you know you keep doubling your range of ips that you're trying you",
    "start": "938800",
    "end": "945760"
  },
  {
    "text": "eventually see oh okay so this router is willing to send me packets if i'm between here and here but if i get over",
    "start": "945760",
    "end": "951519"
  },
  {
    "text": "here it's not going to send it to me anymore so this is nice for figuring out where you're able to go ahead and stick",
    "start": "951519",
    "end": "957519"
  },
  {
    "text": "your ip now there's a problem what if a couple people should like this",
    "start": "957519",
    "end": "964320"
  },
  {
    "text": "what if you can't go ahead and uh find any new ips what if they're all",
    "start": "964320",
    "end": "970639"
  },
  {
    "text": "taken this is not a theoretical problem i wanted an ip address the other day from this network and ping comes to me",
    "start": "970639",
    "end": "976160"
  },
  {
    "text": "and says no no no no all the exhibitors have all the ips it's all done i'm like oh",
    "start": "976160",
    "end": "981440"
  },
  {
    "text": "that's not that much of a problem actually so let me talk a little bit about how",
    "start": "981440",
    "end": "986959"
  },
  {
    "text": "nat works we've talked about how arp works we need to talk about how well there's one piece of art i should mention the man in the middle attack in",
    "start": "986959",
    "end": "993600"
  },
  {
    "text": "arp very simple you have a client and a router you tell the router that you're the",
    "start": "993600",
    "end": "999440"
  },
  {
    "text": "client you tell the client that you're the router you sit in the middle and you pass the packets",
    "start": "999440",
    "end": "1004560"
  },
  {
    "text": "this is i mean it's straight classic technique nothing new that",
    "start": "1004560",
    "end": "1010160"
  },
  {
    "text": "also nothing new the idea with nat is is that there's only one ip that the outside world wants to be seeing traffic",
    "start": "1010160",
    "end": "1016720"
  },
  {
    "text": "from but you've got a bunch of hosts so what do you do you you receive traffic from the hosts",
    "start": "1016720",
    "end": "1022800"
  },
  {
    "text": "when you send it out you keep track of what you sent out and if you get a reply",
    "start": "1022800",
    "end": "1027918"
  },
  {
    "text": "back to anything you sent out you translate it back to who made the request so it's like you know someone",
    "start": "1027919",
    "end": "1034240"
  },
  {
    "text": "makes an outgoing request to yahoo when you get a reply back from yahoo you send it to the guy you requested a packet",
    "start": "1034240",
    "end": "1039760"
  },
  {
    "text": "from yahoo and there are port numbers to make sure that two or three or eight or everyone on the network can go ahead and",
    "start": "1039760",
    "end": "1044798"
  },
  {
    "text": "request the same website now what would that in the middle be now you",
    "start": "1044799",
    "end": "1051120"
  },
  {
    "text": "know how i said that uh that nat has an extra one says there's only one externally trusted ip there's",
    "start": "1051120",
    "end": "1058000"
  },
  {
    "text": "only one address that the outside world wants to see well you know how i said there's a the i there's only a few ip's available",
    "start": "1058000",
    "end": "1064400"
  },
  {
    "text": "on the network well what i'm basically saying is um there's only a couple ips that the outside world wants to see and they're",
    "start": "1064400",
    "end": "1071360"
  },
  {
    "text": "in use so we'll just sort of borrow one interject ourselves inside so now we're",
    "start": "1071360",
    "end": "1077760"
  },
  {
    "text": "going ahead we're in between a client with a valid ip address which is what nat wants we have a client we have a",
    "start": "1077760",
    "end": "1084320"
  },
  {
    "text": "router we stick ourselves in the middle now we have",
    "start": "1084320",
    "end": "1089440"
  },
  {
    "text": "our hosts that want to go ahead and communicate through this guy over here is ip",
    "start": "1089440",
    "end": "1094480"
  },
  {
    "text": "so they you know they they have their own ip range they send packets to my man in the middle",
    "start": "1094480",
    "end": "1099520"
  },
  {
    "text": "and he goes oh okay match them to the client's ip address sends them out",
    "start": "1099520",
    "end": "1105360"
  },
  {
    "text": "now they're all all right a bunch of packets come back some of them they're no resemblance at",
    "start": "1105360",
    "end": "1111679"
  },
  {
    "text": "all to whatever any of these clients requested oh it says that that must be the clients maybe it's a request maybe",
    "start": "1111679",
    "end": "1118640"
  },
  {
    "text": "it for service maybe it's its own sessions whatever i didn't add it i'm just passing it through ah",
    "start": "1118640",
    "end": "1125039"
  },
  {
    "text": "but if the reply is to something that was matted it gets dropped back to the second",
    "start": "1125039",
    "end": "1130559"
  },
  {
    "text": "client pool so you actually get to combine nat and art man in the middle attacks for nat in the middle you get to steal",
    "start": "1130559",
    "end": "1136960"
  },
  {
    "text": "someone's ip not even steal it just sort of assume it now you might say now now now you said",
    "start": "1136960",
    "end": "1143760"
  },
  {
    "text": "you weren't in the hardcore attacks what are you doing i mean come on this has no legitimate purposes right",
    "start": "1143760",
    "end": "1150160"
  },
  {
    "text": "if it didn't have legitimate purposes i just wouldn't be a very creative guy now would i",
    "start": "1150160",
    "end": "1156559"
  },
  {
    "text": "so check it out things you can do with this well one nice thing you can do and i you know",
    "start": "1156559",
    "end": "1163120"
  },
  {
    "text": "this is one by the way the new the code that does this is one of the few things that isn't in the tarball it'll be in there next week it got really fresh",
    "start": "1163120",
    "end": "1170240"
  },
  {
    "text": "don't ask um basically you can do server migrations",
    "start": "1170240",
    "end": "1175360"
  },
  {
    "text": "really nicely i was going to say the code actually lets you um have an individual host",
    "start": "1175360",
    "end": "1180720"
  },
  {
    "text": "interject into someone else's stream so you are you don't have a separate client other client and that box you just have",
    "start": "1180720",
    "end": "1187280"
  },
  {
    "text": "one box so what you could do with them you could have a server so you have your existing server and it's bugging out",
    "start": "1187280",
    "end": "1193280"
  },
  {
    "text": "it's getting slow or whatnot you go ahead and you interject a new fresh server into there",
    "start": "1193280",
    "end": "1200799"
  },
  {
    "text": "but what you do is you let the existing sessions finish in other words you let all existing",
    "start": "1200799",
    "end": "1206960"
  },
  {
    "text": "traffic go ahead and pass pass through unimpeded but all new sessions your new server takes so this",
    "start": "1206960",
    "end": "1214320"
  },
  {
    "text": "lets you do a graceful migration you have two hosts with the same ip address only one of which is accepting new",
    "start": "1214320",
    "end": "1221039"
  },
  {
    "text": "sessions and every time it accepts a new session it goes ahead and you know it takes it to its own process but every",
    "start": "1221039",
    "end": "1227280"
  },
  {
    "text": "time it sees a packet to a session that did not that predated its own initialization it says ah that must be",
    "start": "1227280",
    "end": "1234000"
  },
  {
    "text": "from the old guy i'll pass that over until eventually you keep track of how many sessions you're keeping for the",
    "start": "1234000",
    "end": "1240080"
  },
  {
    "text": "other guy eventually that number hits zero and you get a message in your email that says that everyone's moved off the",
    "start": "1240080",
    "end": "1246960"
  },
  {
    "text": "server we can you know shut it off and fix the thing that got rooted the other day",
    "start": "1246960",
    "end": "1252880"
  },
  {
    "text": "works for me more architects is it possible to detect a single port",
    "start": "1252880",
    "end": "1258720"
  },
  {
    "text": "multi-host port scan across the switched lan um yeah this is a word of warning for you",
    "start": "1258720",
    "end": "1264960"
  },
  {
    "text": "guys this thing right here has is discovered like every four months for the last five",
    "start": "1264960",
    "end": "1271679"
  },
  {
    "text": "years basically here's what happens so you know you do a big old port scan how i",
    "start": "1271679",
    "end": "1278240"
  },
  {
    "text": "don't scan random you do a big old port scan it hits the end to point routers on far away networks but sooner or later",
    "start": "1278240",
    "end": "1287480"
  },
  {
    "text": "the end point is on your network well",
    "start": "1290159",
    "end": "1296080"
  },
  {
    "text": "sort of because you know in a given network there's usually lots and lots of free ips to make room for growth right well",
    "start": "1296080",
    "end": "1303280"
  },
  {
    "text": "what happens is you know if there's a free ip the arp cache on the router the list of translations between ip",
    "start": "1303280",
    "end": "1309840"
  },
  {
    "text": "addresses and mac addresses is not going to have anything in there because there's nothing to see",
    "start": "1309840",
    "end": "1315919"
  },
  {
    "text": "so the end result being you do a scan against 256 hosts only 40 or up you have",
    "start": "1315919",
    "end": "1323120"
  },
  {
    "text": "at least 216 arps that flood a network and the arps are broadcast",
    "start": "1323120",
    "end": "1328720"
  },
  {
    "text": "you know hey who has this ip address now anyone anyone julian",
    "start": "1328720",
    "end": "1334480"
  },
  {
    "text": "um so the end result being scan rand to into",
    "start": "1334480",
    "end": "1339520"
  },
  {
    "text": "sparsely populated networks creates an art flood and even though as an individual client you",
    "start": "1339520",
    "end": "1345840"
  },
  {
    "text": "can't see your neighbors scanned you can see the upstream router go ahead and look for other hosts um i repeat this is",
    "start": "1345840",
    "end": "1353440"
  },
  {
    "text": "discovered like every three or four months i was the latest to discover it so you",
    "start": "1353440",
    "end": "1358880"
  },
  {
    "text": "know we'll be raw network access link cat blue cat's a",
    "start": "1358880",
    "end": "1365760"
  },
  {
    "text": "really really simple tool it came about because i'm like wow you know this packet coding i mean i can do",
    "start": "1365760",
    "end": "1372159"
  },
  {
    "text": "it now but i probably would have struggled with it like i don't know a little while ago but i've always been able to play with text so let's go ahead",
    "start": "1372159",
    "end": "1378720"
  },
  {
    "text": "and make an interface between like text i just you know type out keys or copy and paste and the wire you know so i can",
    "start": "1378720",
    "end": "1385679"
  },
  {
    "text": "like you know read packets and just rewrite them out i mean you know works over ssh and",
    "start": "1385679",
    "end": "1391360"
  },
  {
    "text": "whatnot so what kind of things can we do with link cat one thing is we can just run strings on the network",
    "start": "1391360",
    "end": "1398000"
  },
  {
    "text": "let me familiarize you guys with strings strings is basically a tiny little tool that looks at it looks at an arbitrary",
    "start": "1398000",
    "end": "1405760"
  },
  {
    "text": "string of bytes just data and says could a human possibly read this okay then i'll dump",
    "start": "1405760",
    "end": "1412640"
  },
  {
    "text": "it and if it's just random noise system goes uh yeah i'm not printing that out",
    "start": "1412640",
    "end": "1420240"
  },
  {
    "text": "so basically you can just run strings on a network just straight up we're the first to do this kismet has this",
    "start": "1420240",
    "end": "1425840"
  },
  {
    "text": "functionality a couple others do but it's a nice way to say look sometimes you really do care who's talking to who",
    "start": "1425840",
    "end": "1434320"
  },
  {
    "text": "sometimes you care what the heck they're saying regardless of who they are you don't need lincat to do strengths if",
    "start": "1434320",
    "end": "1440799"
  },
  {
    "text": "you just take tcp dump dash w dash and you expand the snap line so it picks up",
    "start": "1440799",
    "end": "1446080"
  },
  {
    "text": "the entire packet and you run that through strings you get the same result little uh word though um",
    "start": "1446080",
    "end": "1453200"
  },
  {
    "text": "human readable yeah so that says bsd",
    "start": "1453200",
    "end": "1459120"
  },
  {
    "text": "you can think uh you can thank ibm for that in like 1984.",
    "start": "1459120",
    "end": "1465039"
  },
  {
    "text": "somehow they decided that be a reasonable encapsulation method i don't",
    "start": "1465039",
    "end": "1470320"
  },
  {
    "text": "know packet zen to do ping over copy and paste",
    "start": "1470320",
    "end": "1478320"
  },
  {
    "text": "so let me show you what's kind of happening here i'm kind of afraid to get near the speaker going there slowly if it gets",
    "start": "1478320",
    "end": "1485520"
  },
  {
    "text": "loud i'll run so if you look at this blue text up here",
    "start": "1485520",
    "end": "1493200"
  },
  {
    "text": "i go ahead and i run this ping command to news.com the blue text is the actual packet that",
    "start": "1493440",
    "end": "1500880"
  },
  {
    "text": "gets sent by my machine as you see it's just a string of bytes indeed here at",
    "start": "1500880",
    "end": "1506320"
  },
  {
    "text": "the end thirty thirty one three two three three thirty four ping payloads are very often just sequential numbers",
    "start": "1506320",
    "end": "1512400"
  },
  {
    "text": "it depends on the operating system the implementation and you know whether you particularly put something nasty in",
    "start": "1512400",
    "end": "1517919"
  },
  {
    "text": "there but basically whatever is in here gets reflected down here in green i have the reply",
    "start": "1517919",
    "end": "1525919"
  },
  {
    "text": "now that's i see i needed to shut up",
    "start": "1525919",
    "end": "1531679"
  },
  {
    "text": "so that's the basic you know i i did a ping that's what came on screen now i go ahead",
    "start": "1532000",
    "end": "1539840"
  },
  {
    "text": "and i copied into my you know just my clipboard i copied what was up here in",
    "start": "1539840",
    "end": "1545120"
  },
  {
    "text": "blue the request so i go ahead and i paste what's in blue that's you",
    "start": "1545120",
    "end": "1552480"
  },
  {
    "text": "see what you now it's in black i just pasted these things you know just edit copy paste",
    "start": "1552480",
    "end": "1559200"
  },
  {
    "text": "in blue you see what's on the network in green you see the reply to a ping that came from a cut and paste",
    "start": "1559200",
    "end": "1565440"
  },
  {
    "text": "so this is a really nice trivial method to go ahead and manipulate packets on that works",
    "start": "1565440",
    "end": "1572000"
  },
  {
    "text": "ah let's move up a little scan rate observations scanner has a high speed port scanner",
    "start": "1572000",
    "end": "1578159"
  },
  {
    "text": "and route tracer it's got this stateless design the sender and the receiver don't need to be the same host i'm not going",
    "start": "1578159",
    "end": "1583679"
  },
  {
    "text": "to repeat last year's talk on this but basically scan ram is pretty cool big deal is a really fast b it doesn't",
    "start": "1583679",
    "end": "1591039"
  },
  {
    "text": "just do port scans it also does trace routes and c it just pours games and trace routes at the exact same time oh",
    "start": "1591039",
    "end": "1596880"
  },
  {
    "text": "and indeed okay this is cool the ttl issues scanland is actually able to estimate",
    "start": "1596880",
    "end": "1603200"
  },
  {
    "text": "how far away a host is using his ttl now the ttl is actually a field that",
    "start": "1603200",
    "end": "1608480"
  },
  {
    "text": "everybody's writing papers about recently the ttl is basically it starts from some",
    "start": "1608480",
    "end": "1613679"
  },
  {
    "text": "fixed value usually 32 64 128 or 255. we're talking about about 95 chance",
    "start": "1613679",
    "end": "1621120"
  },
  {
    "text": "and it's because programmers really love powers of two um",
    "start": "1621120",
    "end": "1626799"
  },
  {
    "text": "if you receive a packet with a ttl of 52 can anyone guess how far away that",
    "start": "1626799",
    "end": "1632080"
  },
  {
    "text": "packet was 64 minus 52",
    "start": "1632080",
    "end": "1637600"
  },
  {
    "text": "12. 12 hops away now if you notice that with with the at with an average maximum hop count that",
    "start": "1637600",
    "end": "1644799"
  },
  {
    "text": "you'll see being around 30 there's no overlap if you get a packet with 33 a ttl of 33 it probably started",
    "start": "1644799",
    "end": "1652960"
  },
  {
    "text": "out with a ttl of 64. if you get a packet with a ttl of 16 it probably started out with a ttl of 32. so you're",
    "start": "1652960",
    "end": "1659840"
  },
  {
    "text": "actually able just by receiving a packet to passively estimate how far away it came from again i'm not the first person",
    "start": "1659840",
    "end": "1666159"
  },
  {
    "text": "to discover this pop has this gfi land guard has this and so on who doesn't",
    "start": "1666159",
    "end": "1671360"
  },
  {
    "text": "have this and really needs to is nutella here you have these networks where lots",
    "start": "1671360",
    "end": "1677520"
  },
  {
    "text": "and lots of hosts are making mass networks of connections to each other gee maybe it'd be nice if in their graph",
    "start": "1677520",
    "end": "1683840"
  },
  {
    "text": "optimization phase they looked at how far each individual node was and tried to go ahead and minimize distances thus",
    "start": "1683840",
    "end": "1691440"
  },
  {
    "text": "minimizing the maximum amount of traffic on the network thus far this hasn't been done it hasn't been done because i've",
    "start": "1691440",
    "end": "1697679"
  },
  {
    "text": "been too lazy to finish the api so you can just run a stupid little command and it says oh on this session it's eight",
    "start": "1697679",
    "end": "1703440"
  },
  {
    "text": "hops away it's coming you know the the api is a struggle but it's actually you know",
    "start": "1703440",
    "end": "1709440"
  },
  {
    "text": "we've got a library now it's actually usable like you still have",
    "start": "1709440",
    "end": "1714799"
  },
  {
    "text": "the last time i talked about an api it was like hi we're an api for scanner and now we actually have a nice general",
    "start": "1714799",
    "end": "1721440"
  },
  {
    "text": "purpose api for unified packet manipulation you receive your packets you send them at layer two and you send",
    "start": "1721440",
    "end": "1727600"
  },
  {
    "text": "them at layer three and it's just seeing you know ten characters of c code",
    "start": "1727600",
    "end": "1732960"
  },
  {
    "text": "nice very simple i i'm not bragging okay i'm bragging but i'm just saying this i'm really happy to",
    "start": "1732960",
    "end": "1739120"
  },
  {
    "text": "finally have a decent way to program network code oh the other thing that ttl's do and",
    "start": "1739120",
    "end": "1745120"
  },
  {
    "text": "this is you're about to see examples of this is details that you um see when people are playing some",
    "start": "1745120",
    "end": "1750960"
  },
  {
    "text": "interesting games with the network now i of course note this because i play interesting games from the network and",
    "start": "1750960",
    "end": "1756240"
  },
  {
    "text": "the ttl exposes me left and right but it also exposes some other people like uh",
    "start": "1756240",
    "end": "1761360"
  },
  {
    "text": "the previous black hat conference i owned testing scanner and making sure my stuff worked before i you know ran",
    "start": "1761360",
    "end": "1768000"
  },
  {
    "text": "off i'm like oh okay so my host is 19 hops away except port 25 somehow my mail server",
    "start": "1768000",
    "end": "1775440"
  },
  {
    "text": "has teleported 15 hops closer",
    "start": "1775440",
    "end": "1780039"
  },
  {
    "text": "microsoft has switched to argos off mail server when they fire the exchange group",
    "start": "1784960",
    "end": "1790960"
  },
  {
    "text": "you wish no um basically the hotel we were at were they",
    "start": "1792240",
    "end": "1798480"
  },
  {
    "text": "were hijacking all outgoing mail and running it through their own mail server now you can say this was legitimate yeah",
    "start": "1798480",
    "end": "1804880"
  },
  {
    "text": "yeah yeah trying to block spam yeah yeah but there's no warning no information",
    "start": "1804880",
    "end": "1810320"
  },
  {
    "text": "about this and um i don't know some minutes later there was no server left",
    "start": "1810320",
    "end": "1816080"
  },
  {
    "text": "man i really shouldn't have told anyway take the bit",
    "start": "1818000",
    "end": "1823840"
  },
  {
    "text": "so you know point being if you run if you're running some no no here's a question",
    "start": "1824159",
    "end": "1830320"
  },
  {
    "text": "why is it that when they hijacked my mail server how come they couldn't know what ttl to",
    "start": "1830320",
    "end": "1836080"
  },
  {
    "text": "put in so that i'd think there was nothing wrong can anyone make a guess",
    "start": "1836080",
    "end": "1842080"
  },
  {
    "text": "because every host is different every host is a different distance away if i had just connected to 25 here then what",
    "start": "1842080",
    "end": "1850480"
  },
  {
    "text": "would happen well they would have been like well uh how do we know how far away this host really is",
    "start": "1850480",
    "end": "1856559"
  },
  {
    "text": "they have no way of finding out so this ends up being a nice thing about ttls every time someone hijacks your",
    "start": "1856559",
    "end": "1863600"
  },
  {
    "text": "connection they have a real difficult time figuring out what the ttl should be so if you have a circumstance where you",
    "start": "1863600",
    "end": "1869120"
  },
  {
    "text": "have a simultaneous side-by-side hijack and non-hijack it really sticks out",
    "start": "1869120",
    "end": "1875520"
  },
  {
    "text": "so hop count desync this is another a business sort of obscure situation i'm",
    "start": "1875520",
    "end": "1881919"
  },
  {
    "text": "scanning my home network and i'm like wait why is my host three different hop counts away",
    "start": "1881919",
    "end": "1888799"
  },
  {
    "text": "well so we've got a pix firewall at home incidentally i live behind like two picks firewalls so",
    "start": "1888799",
    "end": "1894640"
  },
  {
    "text": "the the end result is that i thought the internet didn't support ip options",
    "start": "1894640",
    "end": "1899840"
  },
  {
    "text": "this um yeah",
    "start": "1899840",
    "end": "1904960"
  },
  {
    "text": "i was getting moved out",
    "start": "1904960",
    "end": "1907840"
  },
  {
    "text": "now that's a good point you can go ahead and actively generate generate connections the problem is now",
    "start": "1917760",
    "end": "1924880"
  },
  {
    "text": "you have showing up in logs all over the place hey you know we got a session that started and immediately stopped",
    "start": "1924880",
    "end": "1931679"
  },
  {
    "text": "you know you that's the problem you have yes you can go ahead start up the session and then you know hijack all",
    "start": "1931679",
    "end": "1938799"
  },
  {
    "text": "traffic but you can't have it both ways you can't both hijack it and allow the payloads to pass through",
    "start": "1938799",
    "end": "1945760"
  },
  {
    "text": "does that make sense",
    "start": "1945760",
    "end": "1949320"
  },
  {
    "text": "okay so what he's saying so you know i have this great sign here says please repeat the question he's pointing out",
    "start": "1955840",
    "end": "1962000"
  },
  {
    "text": "that what an attacker can do you know what the hijacker can do is they go ahead they see you with this packet they",
    "start": "1962000",
    "end": "1967919"
  },
  {
    "text": "go ahead they initiate a connection to the legitimate host not even necessarily on the same port not even necessarily",
    "start": "1967919",
    "end": "1975120"
  },
  {
    "text": "the same protocol they go ahead they find out the distance comes back",
    "start": "1975120",
    "end": "1981200"
  },
  {
    "text": "and you know shows you you know the exact distance that you expected this is actually a very good",
    "start": "1981200",
    "end": "1988559"
  },
  {
    "text": "way around it this is the attack it is actually mildly difficult to do for reasons of latency and sheer complexity",
    "start": "1988559",
    "end": "1995120"
  },
  {
    "text": "you have to go ahead and add raw packet handling code to your arbitrary hijacker but it's an excellent solution to the",
    "start": "1995120",
    "end": "2000559"
  },
  {
    "text": "problem oprah is that you yeah",
    "start": "2000559",
    "end": "2005840"
  },
  {
    "text": "oh okay let me let me hit that second one first first of all even if your mail server and web server are hosted by different machines they also have",
    "start": "2016880",
    "end": "2022960"
  },
  {
    "text": "different ip addresses and dns names usually they are not going to go ahead take all their mail traffic receive it",
    "start": "2022960",
    "end": "2030159"
  },
  {
    "text": "at their network and then proxy it somewhere else this is not a common arrangement usually you have you know",
    "start": "2030159",
    "end": "2037080"
  },
  {
    "text": "www.site.com posting going to one ip address and www and then",
    "start": "2037080",
    "end": "2042600"
  },
  {
    "text": "mail.host.com going to somewhere else now the other thing what was the other what was your first point",
    "start": "2042600",
    "end": "2049960"
  },
  {
    "text": "well i'm just pointing out when you connect to a single ip and you get multiple",
    "start": "2060480",
    "end": "2065520"
  },
  {
    "text": "vastly different hop counts you aren't going to get dynamic routing situations where you have",
    "start": "2065520",
    "end": "2071440"
  },
  {
    "text": "say you know a differences of you know five ten fifteen hops you'll get one two",
    "start": "2071440",
    "end": "2077040"
  },
  {
    "text": "or three hops or else the dynamic routing situation is completely completely off base",
    "start": "2077040",
    "end": "2084000"
  },
  {
    "text": "anyway we'll just we'll talk about this later actually bring it up uh after the entire session by the way and we'll",
    "start": "2084000",
    "end": "2089839"
  },
  {
    "text": "actually have a microphone on it um hop count d sync this is basically saying pixel go ahead when pix blocks a",
    "start": "2089839",
    "end": "2096800"
  },
  {
    "text": "packet it basically does a reflection swaps the ports around swaps the ip around and it doesn't do anything to the",
    "start": "2096800",
    "end": "2104000"
  },
  {
    "text": "ttl result packet decrements all the way there",
    "start": "2104000",
    "end": "2109040"
  },
  {
    "text": "packet decrements all the way back that's why you have 22 as the hop count",
    "start": "2109040",
    "end": "2114320"
  },
  {
    "text": "on all those down ports when the actual distance is 11 hops away what are these top 12 ones those are an",
    "start": "2114320",
    "end": "2121280"
  },
  {
    "text": "actual the actual host is not listening as opposed to the picks as blocking any",
    "start": "2121280",
    "end": "2126800"
  },
  {
    "text": "traffic serverless mat identification this doesn't work so often anymore",
    "start": "2126800",
    "end": "2133520"
  },
  {
    "text": "sorry guys um basically icmp errors contain a full",
    "start": "2133520",
    "end": "2138720"
  },
  {
    "text": "copy of the ip packet that elicited them uh old nats used to go ahead and only",
    "start": "2138720",
    "end": "2146160"
  },
  {
    "text": "translate the ip address not the ip packet contained within the icmp error",
    "start": "2146160",
    "end": "2151839"
  },
  {
    "text": "so you go ahead and you do a trace route and as you see on the second packet here go go ahead we have our actual external",
    "start": "2151839",
    "end": "2157760"
  },
  {
    "text": "ip address this was a nice remote serverless way of figuring out where your nat was actually showing you on the",
    "start": "2157760",
    "end": "2164480"
  },
  {
    "text": "outside world but really like we just ran a huge number of tests it doesn't work that much",
    "start": "2164480",
    "end": "2170839"
  },
  {
    "text": "anymore multi-home node detection this is cool this is this was actually a challenge put to me and i don't know i",
    "start": "2170839",
    "end": "2177040"
  },
  {
    "text": "sat and hurt my head for a while and next thing you know got it working is it possible to detect clients that",
    "start": "2177040",
    "end": "2182480"
  },
  {
    "text": "are directly connected both to the internet in both the internal firewall of land",
    "start": "2182480",
    "end": "2187599"
  },
  {
    "text": "and the outside world bad people bad bad network design you gotta open hole past all the firewalls",
    "start": "2187599",
    "end": "2194640"
  },
  {
    "text": "is it possible to detect it yeah yeah check out how you do it so you have a corporate land",
    "start": "2194640",
    "end": "2201839"
  },
  {
    "text": "so you know i'm actually talking about security stuff here not just britain not just playing with blankets",
    "start": "2201839",
    "end": "2207440"
  },
  {
    "text": "um scan rant has the neat little thing of it can actually run with separate senders and receiver processes it's",
    "start": "2207440",
    "end": "2214400"
  },
  {
    "text": "stateless in the sense that yeah there's there's really no connection between the part that spews traffic on the network",
    "start": "2214400",
    "end": "2220320"
  },
  {
    "text": "and the part that sees whatever that just came back so let's talk about your firewall network",
    "start": "2220320",
    "end": "2227040"
  },
  {
    "text": "your firewall network should never on the inside receive a scan from the outside world that just shouldn't happen",
    "start": "2227040",
    "end": "2233520"
  },
  {
    "text": "because it should get stopped on the outside firewall right that should let's talk about what",
    "start": "2233520",
    "end": "2239760"
  },
  {
    "text": "actually happens if the packets magically appear on your internal network with source ips outside",
    "start": "2239760",
    "end": "2248000"
  },
  {
    "text": "well you know think about it for a second so your entire network is scanned with a",
    "start": "2248000",
    "end": "2254000"
  },
  {
    "text": "source ip outside your network well the replies have to go somewhere",
    "start": "2254000",
    "end": "2259520"
  },
  {
    "text": "there start going outside your network but they get stopped at the firewalls because if you have any kind of decent",
    "start": "2259520",
    "end": "2265200"
  },
  {
    "text": "firewall the firewall is going to say wait a second all of these synapse all of these connection accepted or",
    "start": "2265200",
    "end": "2271200"
  },
  {
    "text": "connection rejected messages i'm not supposed to send these i this is to the outside world what's going on",
    "start": "2271200",
    "end": "2276880"
  },
  {
    "text": "here so it drops them ah let's say you've got a host that's dual",
    "start": "2276880",
    "end": "2281920"
  },
  {
    "text": "connected that's only routing to the internal lanyard you know one interface takes uh",
    "start": "2281920",
    "end": "2287760"
  },
  {
    "text": "takes all the ips that the corporate lan has and one interface has the nice access to the outside world well it goes",
    "start": "2287760",
    "end": "2293760"
  },
  {
    "text": "ahead and it receives this packet happens to be on the router interface on the internal interface but for the most",
    "start": "2293760",
    "end": "2299839"
  },
  {
    "text": "part they don't care and then they need to send this reply they go okay let me look at my routing",
    "start": "2299839",
    "end": "2305119"
  },
  {
    "text": "table my routing table says when i reply to the outside world i don't go in the direction the firewall i go in the",
    "start": "2305119",
    "end": "2312240"
  },
  {
    "text": "direction of my dsl line that's really a bad idea for me to have so that's how you go ahead",
    "start": "2312240",
    "end": "2318960"
  },
  {
    "text": "and you very simply detect whether someone's got a multi-home network that's completely evading your firewalls",
    "start": "2318960",
    "end": "2325040"
  },
  {
    "text": "and this may not even be malicious this may simply be a misconfiguration keep in mind a router is just another multi-home",
    "start": "2325040",
    "end": "2331920"
  },
  {
    "text": "network or a multi-home node no this is my idea did jesuit come up",
    "start": "2331920",
    "end": "2338000"
  },
  {
    "text": "with this as well",
    "start": "2338000",
    "end": "2341320"
  },
  {
    "text": "yeah avaya used to be loosened that's why he said that",
    "start": "2353599",
    "end": "2358640"
  },
  {
    "text": "whatever it's a port scan",
    "start": "2362720",
    "end": "2366078"
  },
  {
    "text": "i i don't know what to say like you know hey there's a porch how do you detect if a firewall is you know whatever it's a",
    "start": "2367760",
    "end": "2373359"
  },
  {
    "text": "porsche",
    "start": "2373359",
    "end": "2375838"
  },
  {
    "text": "oh wow spoofing a source address that's you know we",
    "start": "2380079",
    "end": "2385680"
  },
  {
    "text": "we're talking about patent stuff let's not get into that i'm here i'm an engineer i'm here to show off cool tricks",
    "start": "2385680",
    "end": "2391200"
  },
  {
    "text": "what about if there's an app there's a nat involved what do you do well if there's an ad involved",
    "start": "2391200",
    "end": "2397760"
  },
  {
    "text": "tcp traffic might have a problem because the nat itself is not going to want to",
    "start": "2397760",
    "end": "2402960"
  },
  {
    "text": "be passing out these synax because that's not really what gnats do so you've got a couple possibilities",
    "start": "2402960",
    "end": "2408880"
  },
  {
    "text": "none of them really good one of them is you go ahead and instead of sending out a whole bunch of tcp",
    "start": "2408880",
    "end": "2414640"
  },
  {
    "text": "packets with spoofed ip addresses you send out a bunch of pings with spoof ip addresses and you see if the nat will go",
    "start": "2414640",
    "end": "2421440"
  },
  {
    "text": "ahead and pass out a pin you apply without caring about anything odds are low but",
    "start": "2421440",
    "end": "2428079"
  },
  {
    "text": "non-zero whereas they are pretty much zero for passing out a syn ack um where do you go ahead and you put the",
    "start": "2428079",
    "end": "2434800"
  },
  {
    "text": "now there's a problem your source ip gets mapped to whatever the nat had so where do you put your internal ip that",
    "start": "2434800",
    "end": "2440800"
  },
  {
    "text": "you scanned you go ahead and you shove it into the ping header udp is a better solution because udp is",
    "start": "2440800",
    "end": "2447520"
  },
  {
    "text": "symmetric and a node can't detect whether or not a packet is a request or a reply the problem is the availability",
    "start": "2447520",
    "end": "2453839"
  },
  {
    "text": "of something like a udp ping is relatively weak snmp kind of works but isn't massively",
    "start": "2453839",
    "end": "2461119"
  },
  {
    "text": "deployed smb is massively deployed but is blocked on a lot of dsl providers so just a",
    "start": "2461119",
    "end": "2467599"
  },
  {
    "text": "specific udp paying over spoofed on 137 might not actually traverse the net the",
    "start": "2467599",
    "end": "2473359"
  },
  {
    "text": "external network link that is not a good thing you shouldn't",
    "start": "2473359",
    "end": "2478800"
  },
  {
    "text": "have this matted box but it's less bad because you know ultimately the nats rarely go ahead and allow incoming",
    "start": "2478800",
    "end": "2485760"
  },
  {
    "text": "access so it's a firewall it's a weaker firewall it's a violation of policy but",
    "start": "2485760",
    "end": "2490800"
  },
  {
    "text": "it's a less onerous situation than if there's just an open pipe to the outside world through a routed machine",
    "start": "2490800",
    "end": "2498800"
  },
  {
    "text": "so the state of state let's talk about the design of scan ram for a moment",
    "start": "2498800",
    "end": "2504240"
  },
  {
    "text": "first of all scan ran was just an experiment like seriously you know i've didn't intend it to become this really",
    "start": "2504240",
    "end": "2509839"
  },
  {
    "text": "popular tool scanner is able to acquire a massive amount of data and really it doesn't",
    "start": "2509839",
    "end": "2516480"
  },
  {
    "text": "care about anything besides what it picks up on a per packet basis",
    "start": "2516480",
    "end": "2521680"
  },
  {
    "text": "it doesn't care but us as users as humans we do",
    "start": "2521680",
    "end": "2526880"
  },
  {
    "text": "the state's maintained by the fact that text gets printed out and it doesn't go away and it doesn't",
    "start": "2526880",
    "end": "2532640"
  },
  {
    "text": "erase itself when we saw that slide that showed you know hey 19 19 19 19 4.",
    "start": "2532640",
    "end": "2539920"
  },
  {
    "text": "skin wind had no idea that there was any difference between the 19 and the four it was just spinning things out but you",
    "start": "2539920",
    "end": "2545599"
  },
  {
    "text": "know it's like it's like a tv a tv spits electrons onto a single phosphor at a",
    "start": "2545599",
    "end": "2552319"
  },
  {
    "text": "time it goes across it goes across it goes across we as humans integrate it will we in the",
    "start": "2552319",
    "end": "2558720"
  },
  {
    "text": "fact that the phosphorus have a delay but let's not go into that so the point being is that a single",
    "start": "2558720",
    "end": "2564480"
  },
  {
    "text": "stream that the system sees is just one dot or one unit",
    "start": "2564480",
    "end": "2569839"
  },
  {
    "text": "we as humans can integrate so this is cool",
    "start": "2569839",
    "end": "2576160"
  },
  {
    "text": "but i've wanted to actually be able to do more integration than i can easily do check out this",
    "start": "2576160",
    "end": "2582960"
  },
  {
    "text": "now i didn't come up with this technique but it's interesting tcp as a protocol has a bunch of",
    "start": "2582960",
    "end": "2589680"
  },
  {
    "text": "different traits to it one of them being is that broken connections will be repaired if there's a packet with a bad",
    "start": "2589680",
    "end": "2596800"
  },
  {
    "text": "checksum it'll be handled if there's a packet that's out of order it will be moved back into order if a packet is",
    "start": "2596800",
    "end": "2603760"
  },
  {
    "text": "dropped the tcp system will detect that and it'll retry it's very similar to being on the phone you know someone",
    "start": "2603760",
    "end": "2610480"
  },
  {
    "text": "drops down you're like hello hello hello",
    "start": "2610480",
    "end": "2616800"
  },
  {
    "text": "but how many hellos do you say how long do you wait in between the hellos the",
    "start": "2616800",
    "end": "2622240"
  },
  {
    "text": "specifications say you have to go ahead and have this delay you know this delay and try over and over but they don't say",
    "start": "2622240",
    "end": "2630079"
  },
  {
    "text": "what precisely the delay must be and as frank visa determined with ring",
    "start": "2630079",
    "end": "2635359"
  },
  {
    "text": "this varies from platform to platform so can we do this with scan rand",
    "start": "2635359",
    "end": "2641359"
  },
  {
    "text": "yeah we can do this with scanner in one one this is where actually i'm demoing here um so scan write when you receive a",
    "start": "2641359",
    "end": "2647680"
  },
  {
    "text": "syn ack a synaptic is connection accepted you're the other side's expecting to get",
    "start": "2647680",
    "end": "2654000"
  },
  {
    "text": "an acknowledgement okay let's start our session if it doesn't hear anything it's just going to keep on sending synax now",
    "start": "2654000",
    "end": "2659440"
  },
  {
    "text": "luckily your colonel is going to go ahead and you know see this syntax and be like um i didn't send you a sin lisa",
    "start": "2659440",
    "end": "2665359"
  },
  {
    "text": "go away so usually this is good because it cuts off a flood but for this analysis this",
    "start": "2665359",
    "end": "2672400"
  },
  {
    "text": "temporal fingerprinting as frank called it um it might be mispronouncing his name but sorry about that",
    "start": "2672400",
    "end": "2679200"
  },
  {
    "text": "for the temporal fingerprinting we want that flood of synax we want every sin accurate can send us because that tells",
    "start": "2679200",
    "end": "2685119"
  },
  {
    "text": "us without looking at anything individual to a packet what operating system is sending it to us",
    "start": "2685119",
    "end": "2691920"
  },
  {
    "text": "so the solution i came up with simply just use a different ip that the kernel is not listening on however because i was too lazy to go",
    "start": "2691920",
    "end": "2698319"
  },
  {
    "text": "ahead and actually have scan ran handle mac addresses this is one one and it was very hard back then um",
    "start": "2698319",
    "end": "2705440"
  },
  {
    "text": "just have the kernel serve the mac and you can do that there's a command in our you make a static mapping i map 1001 190",
    "start": "2705440",
    "end": "2712319"
  },
  {
    "text": "to this mac address and then i had a little thing that says pub says if anyone else is looking for this i got",
    "start": "2712319",
    "end": "2717920"
  },
  {
    "text": "the answer i'll go ahead and answer it for you does this kind of feature why uh my men",
    "start": "2717920",
    "end": "2723119"
  },
  {
    "text": "in the middle attacks kind of work um so what happens you go ahead you tell 10190 is actually coming to this machine",
    "start": "2723119",
    "end": "2730079"
  },
  {
    "text": "you fake a scan from 1001 190 and what do we see here",
    "start": "2730079",
    "end": "2735119"
  },
  {
    "text": "l100112 gets packets that gets to next to me in zero or 0.2 seconds and then point then",
    "start": "2735119",
    "end": "2742160"
  },
  {
    "text": "three seconds later and then six seconds later from experience i know this is windows same with 1001.36",
    "start": "2742160",
    "end": "2749680"
  },
  {
    "text": "you know at 0.7 and then almost exactly three seconds later 3.6 almost six",
    "start": "2749680",
    "end": "2754800"
  },
  {
    "text": "seconds later 9.6 that's also a windows machine ah but now at the end we go",
    "start": "2754800",
    "end": "2759839"
  },
  {
    "text": "ahead and we look and we see what's this a plus four a plus six a plus twelve plus twenty four this machine spent",
    "start": "2759839",
    "end": "2765839"
  },
  {
    "text": "forty six seconds trying to send me a thin act yeah that's on an xbox it's",
    "start": "2765839",
    "end": "2771280"
  },
  {
    "text": "pretty uh pretty hardcore so how can i start being able to",
    "start": "2771280",
    "end": "2777760"
  },
  {
    "text": "move this network move towards a model where i can go ahead and",
    "start": "2777760",
    "end": "2783359"
  },
  {
    "text": "um do this kind of stuff well",
    "start": "2783359",
    "end": "2789440"
  },
  {
    "text": "basically introduce a database but not the normal way i'm not dealing with the apis i'm not going ahead and",
    "start": "2789440",
    "end": "2795520"
  },
  {
    "text": "tying myself hardcore to one engine i've been using standard out for a while",
    "start": "2795520",
    "end": "2802640"
  },
  {
    "text": "databases almost all of them like sql well it's dumb sql um standard out is the ultimate database",
    "start": "2802640",
    "end": "2809200"
  },
  {
    "text": "abstraction layer for entering data into a database getting it out not so much but getting",
    "start": "2809200",
    "end": "2815280"
  },
  {
    "text": "it in you use sql it's like csv pro i mean really it's just you know insert",
    "start": "2815280",
    "end": "2821520"
  },
  {
    "text": "into full value insert ninja table name values big old csv comma separated values",
    "start": "2821520",
    "end": "2828400"
  },
  {
    "text": "and parentheses and that's it so you can run it over ssh you run scan",
    "start": "2828400",
    "end": "2834240"
  },
  {
    "text": "rand tell it to output to sql pipe into a remote process you know ssh use that host mysqlfu",
    "start": "2834240",
    "end": "2841440"
  },
  {
    "text": "just dumps into a remote database of an encrypted link very nice there is a risk if you go ahead and you",
    "start": "2841440",
    "end": "2847520"
  },
  {
    "text": "do that and the risk is if someone actually breaks the remote scanner in process they're able to do certain types of sql",
    "start": "2847520",
    "end": "2853440"
  },
  {
    "text": "injection attacks in other words they you're trying to inject sql and they're like yeah that's nice um",
    "start": "2853440",
    "end": "2858800"
  },
  {
    "text": "i'll take root so um yeah then the eventual mode will be i'll dump",
    "start": "2858800",
    "end": "2864319"
  },
  {
    "text": "raw binary values with a fixed length and you'll locally parse them back into sql but the build you have now will go ahead",
    "start": "2864319",
    "end": "2870960"
  },
  {
    "text": "and do scanner and i think it's mode one that'll go ahead you do a scan it dumps it into a sql schema which you can",
    "start": "2870960",
    "end": "2877119"
  },
  {
    "text": "actually have it output it'll put the my sql version of it so how would you do something like os",
    "start": "2877119",
    "end": "2883520"
  },
  {
    "text": "fingerprinting first of all the right way to do all this fingerprinting is to use offers new stuff no i'm serious like",
    "start": "2883520",
    "end": "2888880"
  },
  {
    "text": "oprah's gone ahead and like done the real work like myself was just an experiment ober's gone ahead and like really busted it out",
    "start": "2888880",
    "end": "2895680"
  },
  {
    "text": "for x probe i've been pretty impressed with everything i've heard about it but you know if you actually want to see",
    "start": "2895680",
    "end": "2900800"
  },
  {
    "text": "what kind of my focus is how can we do this stuff in like a minute whereas every other approach is",
    "start": "2900800",
    "end": "2907440"
  },
  {
    "text": "going to be more reliable but it's going to take longer and actually",
    "start": "2907440",
    "end": "2913040"
  },
  {
    "text": "the other advantage is you know his stuff can be done now my stuff later",
    "start": "2913040",
    "end": "2919040"
  },
  {
    "text": "um so basically what you do is you identify a set of packets that enlisted a",
    "start": "2919040",
    "end": "2924800"
  },
  {
    "text": "uniquely identifiable hope and they listed an identifiable host for example",
    "start": "2924800",
    "end": "2930000"
  },
  {
    "text": "nmap has i don't know eight or ten packets that sends a host that have various quirks for them you",
    "start": "2930000",
    "end": "2935920"
  },
  {
    "text": "send them all and you see what you get back x probes the same way or maybe use the temporal fingerprinting algorithm",
    "start": "2935920",
    "end": "2942800"
  },
  {
    "text": "then you go ahead you do a blast on everyone and then you have three part three",
    "start": "2942800",
    "end": "2947920"
  },
  {
    "text": "possible results from your blast you have hosts that have no replies in which case after 10 packets the host is",
    "start": "2947920",
    "end": "2954319"
  },
  {
    "text": "probably down especially if you were mixing it up in terms of where which host you were attacking at one time",
    "start": "2954319",
    "end": "2959680"
  },
  {
    "text": "excuse me scanning at one time there's all replies you got everything",
    "start": "2959680",
    "end": "2964880"
  },
  {
    "text": "you needed now you can go ahead and run your analysis based off the results of the database or there's some you got",
    "start": "2964880",
    "end": "2970559"
  },
  {
    "text": "some replies but not others that means packets were probably dropped so now you",
    "start": "2970559",
    "end": "2975599"
  },
  {
    "text": "go ahead and you create a list where you have some where the count is wrong and you big surprise you go ahead and you scan",
    "start": "2975599",
    "end": "2981839"
  },
  {
    "text": "those hosts again so you basically get a situation where you run the first pass you get 98 you run a second pass you're",
    "start": "2981839",
    "end": "2988400"
  },
  {
    "text": "at 99.9 you run a third pass you're eventually at 100. eventually it collapses on that",
    "start": "2988400",
    "end": "2994319"
  },
  {
    "text": "of available hosts and that is this really works for systems where you actually have a large number of inputs",
    "start": "2994319",
    "end": "3000880"
  },
  {
    "text": "the temporal fingerprinting involves a single sin a single sin getting dropped you know you use binary either you got",
    "start": "3000880",
    "end": "3006559"
  },
  {
    "text": "all of them or you got none of them so i mean this is the direction that i'm personally moving in towards the voice",
    "start": "3006559",
    "end": "3012400"
  },
  {
    "text": "fingerprinting but absolutely offers work is where to go for this in the long run",
    "start": "3012400",
    "end": "3019599"
  },
  {
    "text": "ah finally i get to talk about the real good stuff how much time do i got here",
    "start": "3019599",
    "end": "3027319"
  },
  {
    "text": "except so remember all those windows down there you're about to see why they're open",
    "start": "3028000",
    "end": "3035359"
  },
  {
    "text": "tcp spoofing normally you cannot spoof tcp traffic in",
    "start": "3035359",
    "end": "3040640"
  },
  {
    "text": "other words you connect to a web server some random host can't just start sending traffic to",
    "start": "3040640",
    "end": "3045920"
  },
  {
    "text": "you saying yeah yeah this is yahoo's web page here you go i've never seen anything",
    "start": "3045920",
    "end": "3051280"
  },
  {
    "text": "from you but here's yahoo's web page now why can't you do that i mean yeah you've got your source ports that have to align",
    "start": "3051280",
    "end": "3057359"
  },
  {
    "text": "you have your ips out the line that the attacker that's blindly spoofing has to actually know you made the request",
    "start": "3057359",
    "end": "3063440"
  },
  {
    "text": "you also have these values called sequence numbers that you know back in the day i was",
    "start": "3063440",
    "end": "3068880"
  },
  {
    "text": "using them for scan ran but they're actually one of their actual legitimate uses is you go ahead and if someone",
    "start": "3068880",
    "end": "3074400"
  },
  {
    "text": "sends you traffic it needs to match ip it needs to match port it needs to match this 32-bit sequence number that was",
    "start": "3074400",
    "end": "3081520"
  },
  {
    "text": "randomly placed the port number was not randomly placed port numbers generally increment",
    "start": "3081520",
    "end": "3086720"
  },
  {
    "text": "sequentially the sequence number used to not be randomly placed then nichols and lucicci went ahead and",
    "start": "3086720",
    "end": "3093680"
  },
  {
    "text": "showed what happens um i went ahead and you know one of the tools in paketto not going to show it here but it's really",
    "start": "3093680",
    "end": "3099440"
  },
  {
    "text": "cool it's called fentropy does an implementation of zalewski's face pace algorithm and if you've ever seen the",
    "start": "3099440",
    "end": "3105040"
  },
  {
    "text": "really pretty pictures of like i don't know grids and floaty shapes yeah that was fentropy and",
    "start": "3105040",
    "end": "3111200"
  },
  {
    "text": "that was showing off here's how you can visually see this ain't random",
    "start": "3111200",
    "end": "3117440"
  },
  {
    "text": "so i mean ever since zalewski's paper came out people have actually been using pretty decent algorithms for determining",
    "start": "3117440",
    "end": "3123359"
  },
  {
    "text": "the randomness of their sequence number um so you can't just guess it",
    "start": "3123359",
    "end": "3129599"
  },
  {
    "text": "so if i you know if someone wants to just move traffic at me they can't figure they can't just guess what to",
    "start": "3129599",
    "end": "3135359"
  },
  {
    "text": "send me but what if the server i was talking to",
    "start": "3135359",
    "end": "3141280"
  },
  {
    "text": "actually told this other machine hey you know what uh he's using this sequence number in this",
    "start": "3141280",
    "end": "3146960"
  },
  {
    "text": "sport go go get him you could do something really cool i",
    "start": "3146960",
    "end": "3152319"
  },
  {
    "text": "called bay with brokering is it possible for a single host to do load balancing across nearly arbitrary",
    "start": "3152319",
    "end": "3158160"
  },
  {
    "text": "network boundaries without any special code on the client there is code on the server and on what",
    "start": "3158160",
    "end": "3164559"
  },
  {
    "text": "becomes now the redirector but not the client and the answer is yeah",
    "start": "3164559",
    "end": "3170880"
  },
  {
    "text": "what you do is you have the server be a mere redirector of client provided packets",
    "start": "3170880",
    "end": "3176240"
  },
  {
    "text": "you have actual traffic being served by one of any number of anonymous servers",
    "start": "3176240",
    "end": "3182240"
  },
  {
    "text": "that are out there that happen to be running code that translates their outgoing packets now to go ahead in some",
    "start": "3182240",
    "end": "3188640"
  },
  {
    "text": "detail about what happens i'm a client i think i'm talking to some server i'm actually talking to a redirector",
    "start": "3188640",
    "end": "3195119"
  },
  {
    "text": "i send my packets to the redirector what's the first thing it does it says i don't want any of this",
    "start": "3195119",
    "end": "3200640"
  },
  {
    "text": "i'll go ahead and i'll pass it off to some server out there based off some rule that's consistent within the",
    "start": "3200640",
    "end": "3206559"
  },
  {
    "text": "session a stateless rule the tcp source board consistent throughout the entire session same with the ip address that's",
    "start": "3206559",
    "end": "3213200"
  },
  {
    "text": "implemented today stateful rules who's serving the most number of people that's not",
    "start": "3213200",
    "end": "3218480"
  },
  {
    "text": "um first thing i do is i go you know what let me explain this in something that",
    "start": "3218480",
    "end": "3223760"
  },
  {
    "text": "might make more sense you're the president of the united states and you still receive email at",
    "start": "3223760",
    "end": "3229119"
  },
  {
    "text": "president whitehouse.gov you receive email you who don't want to",
    "start": "3229119",
    "end": "3234400"
  },
  {
    "text": "go ahead and write all any replies and you know you don't also you also don't want to do form letters but you want to",
    "start": "3234400",
    "end": "3239520"
  },
  {
    "text": "go ahead and actually have somebody look at this intern",
    "start": "3239520",
    "end": "3244720"
  },
  {
    "text": "and you know they'll write the reply and they'll forge your name so you as the citizen send mail to the",
    "start": "3244720",
    "end": "3251760"
  },
  {
    "text": "president the president passes it off to one of a thousand anonymous interns that you'll never see on cnn the intern goes",
    "start": "3251760",
    "end": "3259040"
  },
  {
    "text": "ahead and sends you back a letter signed the president that's exactly what i'm doing",
    "start": "3259040",
    "end": "3265760"
  },
  {
    "text": "here i have a redirector that receives the traffic that is actually trusted by the client by its name or ip address",
    "start": "3265760",
    "end": "3272800"
  },
  {
    "text": "there's a whole hoard of ip addresses out there of servers that when they serve this traffic they",
    "start": "3272800",
    "end": "3279200"
  },
  {
    "text": "will reply as if they were the redirector and the last phase",
    "start": "3279200",
    "end": "3285200"
  },
  {
    "text": "is that the acknowledgements the thank you for this traffic actually comes to",
    "start": "3285200",
    "end": "3291680"
  },
  {
    "text": "not the anonymous servers but to the redirectors why is this nice because now the redirector can go ahead and monitor",
    "start": "3291680",
    "end": "3298319"
  },
  {
    "text": "the quality of service without actually sending any data he can see how much data is sent maybe because of a quirk in",
    "start": "3298319",
    "end": "3305040"
  },
  {
    "text": "tcp where after the initial sequence number is set and after the initial the acknowledgement numbers are set",
    "start": "3305040",
    "end": "3312079"
  },
  {
    "text": "they advance in order of the amount of traffic being sent so what happens is without actually",
    "start": "3312079",
    "end": "3319839"
  },
  {
    "text": "you know somebody's the anonymous server sends the client twenty thousand bytes the next packet",
    "start": "3319839",
    "end": "3326480"
  },
  {
    "text": "that goes to the redirector has an acknowledgement of plus twenty thousand",
    "start": "3326480",
    "end": "3331599"
  },
  {
    "text": "so advantages we can do global load distribution yada yada central traffic monitoring yada yada session migration",
    "start": "3331599",
    "end": "3338720"
  },
  {
    "text": "not implemented yet but the redirector can see oh this this mirror sucks you ever gone to sites and they show you",
    "start": "3338720",
    "end": "3344559"
  },
  {
    "text": "this you know list of mirrors you have to pick one this annoys me my model is you know you have",
    "start": "3344559",
    "end": "3351680"
  },
  {
    "text": "somewhere out there is somebody who had to afford more bandwidth than this administrator",
    "start": "3351680",
    "end": "3358240"
  },
  {
    "text": "okay so what should happen is they should be able to register and say hey guess what i'm going to go ahead and i'll serve your data for you",
    "start": "3358240",
    "end": "3365680"
  },
  {
    "text": "send me the request you don't have to serve them i'll pretend i'm you because i've got spare bandwidth and i'm",
    "start": "3365680",
    "end": "3371119"
  },
  {
    "text": "willing to sell it maybe i'll do it on a ratio system i don't know but the end result being individual",
    "start": "3371119",
    "end": "3377359"
  },
  {
    "text": "servers go ahead and spoof each other because for arbitration purposes",
    "start": "3377359",
    "end": "3383280"
  },
  {
    "text": "and it's all completely decentralized now",
    "start": "3383280",
    "end": "3388480"
  },
  {
    "text": "there are systems that do some stuff like this you know akamai and alteon have similar stuff but it's very odd for",
    "start": "3388480",
    "end": "3395760"
  },
  {
    "text": "the most decentralized technology that you can really imagine they're completely centralized every time you",
    "start": "3395760",
    "end": "3401359"
  },
  {
    "text": "want to do anything like that you go you have something in their property and their network do it whereas a much more",
    "start": "3401359",
    "end": "3408640"
  },
  {
    "text": "efficient way would be we can have anyone you want spoof your traffic here's a small little module that",
    "start": "3408640",
    "end": "3414480"
  },
  {
    "text": "modifies your outgoing packets so they look correct now this works for everything it works",
    "start": "3414480",
    "end": "3420160"
  },
  {
    "text": "for every kind of tcp stuff you know mp3 radio stations web servers etc the redirector does have a traffic load",
    "start": "3420160",
    "end": "3426720"
  },
  {
    "text": "but it's relatively small now now comes the scary part because now i'm actually going to demo this stuff",
    "start": "3426720",
    "end": "3433520"
  },
  {
    "text": "so i have no idea if this is going to work",
    "start": "3433520",
    "end": "3438960"
  },
  {
    "text": "so i have like eight of those things open you know what so we happen to have squid running on",
    "start": "3439760",
    "end": "3445200"
  },
  {
    "text": "our redirect go ahead",
    "start": "3445200",
    "end": "3448160"
  },
  {
    "text": "this only makes sense for situations where the server to client traffic is a",
    "start": "3455680",
    "end": "3460720"
  },
  {
    "text": "lot heavier than the client to server traffic which act okay so what he said is you know this redirector has to",
    "start": "3460720",
    "end": "3466799"
  },
  {
    "text": "receive all the traffic from the client and not only does it have to receive it all it has to send it now how many",
    "start": "3466799",
    "end": "3472640"
  },
  {
    "text": "people here in this room have adsl connections at home you notice how your connection can send",
    "start": "3472640",
    "end": "3479760"
  },
  {
    "text": "it can receive data a lot faster than it can send it it's because",
    "start": "3479760",
    "end": "3485359"
  },
  {
    "text": "most of the systems on the net actually require much faster download rates than they require upload it's very much the",
    "start": "3485359",
    "end": "3491680"
  },
  {
    "text": "same with the redirector the redirector does indeed have a bandwidth hit but it's something like twenty to one thirty",
    "start": "3491680",
    "end": "3498559"
  },
  {
    "text": "to one forty to one savings so it does have a hit in order to you know tell someone else to go ahead and do it like",
    "start": "3498559",
    "end": "3505280"
  },
  {
    "text": "the simpsons line can't someone else do it it does take a hit but it's you know",
    "start": "3505280",
    "end": "3511280"
  },
  {
    "text": "it's meaningless it's standing around versus actually lifting something so as opposed to just talking about this",
    "start": "3511280",
    "end": "3517440"
  },
  {
    "text": "stuff i'm actually going to try to give a demonstration and i'm going to show off how",
    "start": "3517440",
    "end": "3523200"
  },
  {
    "text": "stuff actually works this is going to require me to find the right rxvt window of many so you'll have",
    "start": "3523200",
    "end": "3529760"
  },
  {
    "text": "to wait one second wait do you see that",
    "start": "3529760",
    "end": "3535119"
  },
  {
    "text": "it's not that this is absolutely not the there we are",
    "start": "3535359",
    "end": "3541520"
  },
  {
    "text": "so this redirector the home redirector i call it homer homer goes ahead",
    "start": "3541520",
    "end": "3548240"
  },
  {
    "text": "i'll even just run the help thing for you to see homer go ahead and it is going to forward 1080 and 20",
    "start": "3548240",
    "end": "3555839"
  },
  {
    "text": "080. this is linux only for now because i'm using part of the lib ipq library",
    "start": "3555839",
    "end": "3561200"
  },
  {
    "text": "the iptables which actually is pretty cool i'm going to forward 1080 and 20 080 to",
    "start": "3561200",
    "end": "3567359"
  },
  {
    "text": "a non-serve one an answer 2 and a non-server 3. this machine",
    "start": "3567359",
    "end": "3572400"
  },
  {
    "text": "has like a third of a dsl one third of a t1 this thing has no bandwidth available to it",
    "start": "3572400",
    "end": "3578640"
  },
  {
    "text": "the other machines are a bit better off so let's see if i can go ahead and get winamp",
    "start": "3578640",
    "end": "3585680"
  },
  {
    "text": "to this happens to also be known as music.spare.com10080.",
    "start": "3585680",
    "end": "3590920"
  },
  {
    "text": "now this is digitally important why are that digitally reported because",
    "start": "3593839",
    "end": "3599280"
  },
  {
    "text": "it's very actually nice to code to something that um",
    "start": "3599280",
    "end": "3604559"
  },
  {
    "text": "when you break your code your music stops so you're really motivated to fix your code quickly",
    "start": "3604559",
    "end": "3610640"
  },
  {
    "text": "now if you go ahead and you look that redirector right there",
    "start": "3610640",
    "end": "3616079"
  },
  {
    "text": "i mean this machine is not participating in the data transmission but it is seeing ah okay 581 kilobytes have been",
    "start": "3616079",
    "end": "3622799"
  },
  {
    "text": "sent at 17k a second now let's go ahead and switch servers the algorithm used right here is",
    "start": "3622799",
    "end": "3629520"
  },
  {
    "text": "quite simply it's just basic straightforward if you what's your source port if it's you know",
    "start": "3629520",
    "end": "3635839"
  },
  {
    "text": "divided by even your mod 3 so just each one just it just cycles up so every time",
    "start": "3635839",
    "end": "3641839"
  },
  {
    "text": "i hit plus it's going to go to a different server so now you see the second session has popped up and it's now being served off",
    "start": "3641839",
    "end": "3648880"
  },
  {
    "text": "at 6460 246 202 which is actually should be speaking down here so you see",
    "start": "3648880",
    "end": "3655680"
  },
  {
    "text": "this window right here now this toast is actually serving the data meanwhile my machine thinks it's getting",
    "start": "3655680",
    "end": "3660960"
  },
  {
    "text": "all this data from this redirect or the redirector don't have the traffic the ability to support any of this",
    "start": "3660960",
    "end": "3667040"
  },
  {
    "text": "we run it a third time",
    "start": "3667040",
    "end": "3670920"
  },
  {
    "text": "and actually that should have been a third server oh well one of the servers is on the",
    "start": "3672640",
    "end": "3677839"
  },
  {
    "text": "blank oh well happens so the end result of all this is that we",
    "start": "3677839",
    "end": "3684079"
  },
  {
    "text": "can go ahead and we can actually hang on i have one last thing i want to show before i move on to",
    "start": "3684079",
    "end": "3689119"
  },
  {
    "text": "the demo i have no idea if it's actually going to work",
    "start": "3689119",
    "end": "3694359"
  },
  {
    "text": "uh yeah so that's how you go ahead the the idea is that you don't go ahead and",
    "start": "3698559",
    "end": "3704000"
  },
  {
    "text": "change anything in the packet that says hey you know i wanted you to actually i want you to change your source port when",
    "start": "3704000",
    "end": "3710400"
  },
  {
    "text": "you send this packet to xyz now the reason i don't want to do that is because i don't want to expand the",
    "start": "3710400",
    "end": "3716480"
  },
  {
    "text": "packet in any way because if i expand the packet i might receive a packet to forward that's already at its maximum",
    "start": "3716480",
    "end": "3723680"
  },
  {
    "text": "size now i'm in fragmentation hell this is not good",
    "start": "3723680",
    "end": "3728799"
  },
  {
    "text": "so to avoid fragmentation helm you basically preset your mappings between an incoming port and an outgoing source",
    "start": "3728799",
    "end": "3736559"
  },
  {
    "text": "ip to translate into so just to show off",
    "start": "3736559",
    "end": "3741839"
  },
  {
    "text": "really there's no other reason i'm doing this this is total bragging this might work",
    "start": "3741839",
    "end": "3749200"
  },
  {
    "text": "packet mod off a web page see there's a reason i brought that up",
    "start": "3752880",
    "end": "3758400"
  },
  {
    "text": "oh hang on this not working because it actually wants to know the interface",
    "start": "3759200",
    "end": "3764318"
  },
  {
    "text": "uh that would be here now as you see",
    "start": "3766000",
    "end": "3773119"
  },
  {
    "text": "oh wow am i getting like everyone's traffic here okay i'll have to set up some rules",
    "start": "3773119",
    "end": "3778720"
  },
  {
    "text": "oh yeah it's wireless back to the hub design",
    "start": "3780240",
    "end": "3787119"
  },
  {
    "text": "all right now this one's actually really cool capture only packets that match",
    "start": "3788000",
    "end": "3795280"
  },
  {
    "text": "never actually use this functionality so you'll have to bear with me here we are ip header contents numeric",
    "start": "3797440",
    "end": "3804720"
  },
  {
    "text": "test actually it's a tcp header content",
    "start": "3804720",
    "end": "3811119"
  },
  {
    "text": "do we have tcp support here oh well we don't here i'll find something that's from 1080. maybe it'll",
    "start": "3811119",
    "end": "3817280"
  },
  {
    "text": "sort yeah well this thing's like 100 kilobytes and it works on a stock machine that's pretty",
    "start": "3817280",
    "end": "3823200"
  },
  {
    "text": "cool all right so you see this ip address 216 64 1741",
    "start": "3823200",
    "end": "3829760"
  },
  {
    "text": "this is sending nothing this is no link to this session but",
    "start": "3829760",
    "end": "3836240"
  },
  {
    "text": "the data is actually coming from what is it six five one nine seven one four six six nine",
    "start": "3836880",
    "end": "3842960"
  },
  {
    "text": "this machine's happy it's um",
    "start": "3842960",
    "end": "3846960"
  },
  {
    "text": "that would sound better see playing music just fine sounds like crap shouldn't sound better but oh well",
    "start": "3848319",
    "end": "3856000"
  },
  {
    "text": "so yeah this is one of those things i have no idea what people are going to do with it everything from doing distribution of",
    "start": "3857200",
    "end": "3863920"
  },
  {
    "text": "your databases to doing migrations to serving music there's a squid server",
    "start": "3863920",
    "end": "3871039"
  },
  {
    "text": "running on 20 080 it just goes ahead and every single connection comes from a different ip address a little note to",
    "start": "3871039",
    "end": "3877440"
  },
  {
    "text": "your web to the web developers out there do not presume one ip address to one client because with this squid hack",
    "start": "3877440",
    "end": "3884400"
  },
  {
    "text": "you'll have three ip addresses four ip addresses 20 ip addresses but it's the same client",
    "start": "3884400",
    "end": "3889760"
  },
  {
    "text": "now go ahead and ask your question",
    "start": "3889760",
    "end": "3893799"
  },
  {
    "text": "so the question is can the path between the redirector and the",
    "start": "3907039",
    "end": "3913440"
  },
  {
    "text": "anonymous server be encrypted it can but i'd almost wonder why because the",
    "start": "3913440",
    "end": "3918720"
  },
  {
    "text": "traffic coming into the redirector itself is unencrypted so if you have one segment of the network that's secure and",
    "start": "3918720",
    "end": "3925520"
  },
  {
    "text": "another segment of the network that's insecure you still have this big insecure segment if you want security",
    "start": "3925520",
    "end": "3932079"
  },
  {
    "text": "this works just fine with encryption being run end to end it'll still",
    "start": "3932079",
    "end": "3937119"
  },
  {
    "text": "redirect end-to-end traffic and the next thing i'm showing off is going",
    "start": "3937119",
    "end": "3942319"
  },
  {
    "text": "to work with this this is going to be the demo i have no idea if it's going to work",
    "start": "3942319",
    "end": "3949359"
  },
  {
    "text": "all right so that was david brokering",
    "start": "3949359",
    "end": "3955520"
  },
  {
    "text": "this this i finally got working i'm so excited got this working like four days ago it's",
    "start": "3955520",
    "end": "3961680"
  },
  {
    "text": "like ruined my sleep since that whole need to polish things anyway",
    "start": "3961680",
    "end": "3967200"
  },
  {
    "text": "ssl versus ids this is like the eternal conflict of security right now",
    "start": "3967200",
    "end": "3973280"
  },
  {
    "text": "okay that's not true there's no shortage of eternal conflicts this is just one of many all right so let's sell annoys me",
    "start": "3973280",
    "end": "3980799"
  },
  {
    "text": "why does ssl annoy me well sso uses certificates and unlike pretty",
    "start": "3980799",
    "end": "3986000"
  },
  {
    "text": "much any other certificate based protocol if i get your certificate today",
    "start": "3986000",
    "end": "3992480"
  },
  {
    "text": "it's game over not game over like your present session is hacked into not game over like your",
    "start": "3992480",
    "end": "3999760"
  },
  {
    "text": "future sessions are hacked into it's game over like all the traffic you've been sending for the last year exposed all the traffic",
    "start": "3999760",
    "end": "4007280"
  },
  {
    "text": "you send a year from now exposed this is really bad and is relatively",
    "start": "4007280",
    "end": "4012319"
  },
  {
    "text": "unprecedented for any kind of link layer for link-based encryption protocol now i",
    "start": "4012319",
    "end": "4017440"
  },
  {
    "text": "went ahead and i harassed one of the authors of ssl and uh to be blunt he put me right in my",
    "start": "4017440",
    "end": "4023920"
  },
  {
    "text": "place he said look it was 1996 we had 1.5",
    "start": "4023920",
    "end": "4029520"
  },
  {
    "text": "of the available cpu power at the time and yeah we've got more power now but",
    "start": "4029520",
    "end": "4034559"
  },
  {
    "text": "the internet's a little bit bigger than it was in 1996. and that being said here's this screwed",
    "start": "4034559",
    "end": "4040400"
  },
  {
    "text": "up mode to ssl that fixes it but no one's ever going to use it i'm like wow that's what you get when you go to the",
    "start": "4040400",
    "end": "4046240"
  },
  {
    "text": "author yeah so um there's a slash on our interview with one of the authors of ssl",
    "start": "4046240",
    "end": "4052640"
  },
  {
    "text": "he basically describes a mode where you renegotiate your certificate after you basically do the short the long term and",
    "start": "4052640",
    "end": "4059280"
  },
  {
    "text": "then either a diffie helmet inside or you can use another certificate but it's not enabled by default and no to anyone",
    "start": "4059280",
    "end": "4066559"
  },
  {
    "text": "who wonders ephemeral rsa isn't going to cut it so 512 bits and you can't increase it the browsers complain yes i",
    "start": "4066559",
    "end": "4071760"
  },
  {
    "text": "tried just doing that so that's the cell annoys me because it's as a",
    "start": "4071760",
    "end": "4079760"
  },
  {
    "text": "as a crypto protocol it fails really really catastrophically when it fails in this mode",
    "start": "4079760",
    "end": "4086480"
  },
  {
    "text": "ids also annoys me ids annoys me because you know hey look",
    "start": "4086480",
    "end": "4092799"
  },
  {
    "text": "we're going to attack cool",
    "start": "4092799",
    "end": "4097359"
  },
  {
    "text": "that just bothers me like if you're not going to do anything about it why are you wasting all this time finding out",
    "start": "4100319",
    "end": "4107920"
  },
  {
    "text": "it's just like you're wasting sleep like oh my god we're wondering you do anything about it",
    "start": "4107920",
    "end": "4115758"
  },
  {
    "text": "but the conflict between the two is what really annoys me i i respect people who like both i respect people who use both",
    "start": "4117120",
    "end": "4124719"
  },
  {
    "text": "but the conflict is annoying so i yes how does it work it sits in between your the clients and the servers",
    "start": "4124719",
    "end": "4132318"
  },
  {
    "text": "it sits on the network and it watches the traffic what is the basic presumption of ids's your servers are",
    "start": "4132319",
    "end": "4139359"
  },
  {
    "text": "too stupid to manage their own security that's what it is it says this if these",
    "start": "4139359",
    "end": "4145679"
  },
  {
    "text": "servers could handle it all by themselves you wouldn't need something on the network that was looking into everything seeing if it would cause the",
    "start": "4145679",
    "end": "4151838"
  },
  {
    "text": "server to fall over because the servers wouldn't fall over the basic presumption of ids then is that servers are broken",
    "start": "4151839",
    "end": "4159600"
  },
  {
    "text": "now what does ssl go ahead and do ssl go ahead and says oh my god the network is",
    "start": "4159600",
    "end": "4164719"
  },
  {
    "text": "broken there's all these hosts that are sniffing and watching and are going to break in and what does ssl do ssl encrypts it so",
    "start": "4164719",
    "end": "4172318"
  },
  {
    "text": "that only the client and the server can see what's actually going on so here you have ids saying servers are dumb and ssl",
    "start": "4172319",
    "end": "4180000"
  },
  {
    "text": "saying networks are dumb you can't have both you're left with",
    "start": "4180000",
    "end": "4185278"
  },
  {
    "text": "this choice you either have to suppress passive attacks by using um",
    "start": "4185279",
    "end": "4191679"
  },
  {
    "text": "by using uh idss but then you suffer active attacks in other words all the web kitties who",
    "start": "4191679",
    "end": "4198640"
  },
  {
    "text": "go ahead and the first thing they do is they look on a server and say oh i can come in through uh through the ssl port",
    "start": "4198640",
    "end": "4206000"
  },
  {
    "text": "get out of ids free card score um that's one opportunity or you've got",
    "start": "4206000",
    "end": "4211840"
  },
  {
    "text": "to suppress the active attacks you know forget it you know we're going to go ahead we're going to watch you on the ids",
    "start": "4211840",
    "end": "4217679"
  },
  {
    "text": "but now you have to suffer the passive attacks all these other people on the network who are watching this choice isn't very good i don't like",
    "start": "4217679",
    "end": "4224480"
  },
  {
    "text": "that so how is this normally solved because there's a long history of people trying to solve this badly",
    "start": "4224480",
    "end": "4231120"
  },
  {
    "text": "one way is he just transferred the certificate to the ids yeah you have like 20 ssl servers in",
    "start": "4231120",
    "end": "4237760"
  },
  {
    "text": "your network you have one box with 20 certs by the way which by every rule of crypto the private search should never",
    "start": "4237760",
    "end": "4244640"
  },
  {
    "text": "ever move this is the biggest target you could possibly have and as i explained earlier",
    "start": "4244640",
    "end": "4250640"
  },
  {
    "text": "when ssl dies because its certificate got lost it really really dies",
    "start": "4250640",
    "end": "4256320"
  },
  {
    "text": "plus it had you have to do rsa decryption on the ids ids aren't bulging at the seams with",
    "start": "4256320",
    "end": "4263440"
  },
  {
    "text": "extra cpu cycles okay you don't want to be tr tacking on rsa to that as well",
    "start": "4263440",
    "end": "4270000"
  },
  {
    "text": "now you can do this today there's a tool called ssl dump written by eric riscorla",
    "start": "4270000",
    "end": "4275360"
  },
  {
    "text": "who if he didn't partially write the spec sure as hell knows a massive amount about it he's the author of the",
    "start": "4275360",
    "end": "4281360"
  },
  {
    "text": "definitive book on ssl called ssl and tls i had nothing to do with it but the book's great",
    "start": "4281360",
    "end": "4287760"
  },
  {
    "text": "oh yeah uh plug book signing yay uh yeah stealing the network and i don't",
    "start": "4287760",
    "end": "4294080"
  },
  {
    "text": "know all you have a copy of one of my books the hack proofing thing there plugs out of the way",
    "start": "4294080",
    "end": "4300560"
  },
  {
    "text": "ssl dump can be pressed into service today to do this and a couple ids's have gone ahead and implemented that you give",
    "start": "4301520",
    "end": "4306960"
  },
  {
    "text": "it your cert if you're an idiot and you go ahead and the ids can read your traffic",
    "start": "4306960",
    "end": "4312239"
  },
  {
    "text": "another approach is to go ahead and you mix ids with inline ssl accelerators turns out if you go ahead and you scan",
    "start": "4312239",
    "end": "4319600"
  },
  {
    "text": "ran google on port 80 and 443 there's an extra hop that it takes on",
    "start": "4319600",
    "end": "4326560"
  },
  {
    "text": "443 why is that because that's their ssl accelerator they have a box and all it does is it decrypts traffic",
    "start": "4326560",
    "end": "4334239"
  },
  {
    "text": "what you basically do is you go ahead and you connect to you have users connect to the",
    "start": "4334239",
    "end": "4339840"
  },
  {
    "text": "decrypter which then either directly forwards traffic to the ids or the ids just sits in the middle and then the",
    "start": "4339840",
    "end": "4346239"
  },
  {
    "text": "server just receives nice clean plain text there are issues to say the least first",
    "start": "4346239",
    "end": "4352719"
  },
  {
    "text": "of all the servers never see cryptography so they can't make decisions based on client certificates somebody told me about this yesterday",
    "start": "4352719",
    "end": "4359120"
  },
  {
    "text": "and i should have realized this myself it's absolutely true there's issues with http rewriting",
    "start": "4359120",
    "end": "4366080"
  },
  {
    "text": "there's massively issues of other kinds of protocols um and it puts plain text on a wire you've",
    "start": "4366080",
    "end": "4372800"
  },
  {
    "text": "done all this work to go and get end to end cryptography and right before the end you cut out",
    "start": "4372800",
    "end": "4378880"
  },
  {
    "text": "that's not good so wow i really should have broken this slide down",
    "start": "4378880",
    "end": "4385760"
  },
  {
    "text": "all right let's talk about how ssl works you don't go ahead you know you have your private keys and it's all",
    "start": "4385760",
    "end": "4390960"
  },
  {
    "text": "asymmetric and junk right yeah you don't use that crypto to go ahead and encrypt your entire session why because it'd be",
    "start": "4390960",
    "end": "4397120"
  },
  {
    "text": "really really slow what you do is use this asymmetric crypto the piece where you know everyone can encrypt but only",
    "start": "4397120",
    "end": "4403280"
  },
  {
    "text": "one person can decrypt you use that to go ahead and negotiate a per session",
    "start": "4403280",
    "end": "4408880"
  },
  {
    "text": "what's called a master secret this per session master secret is unique every single time and it's this that",
    "start": "4408880",
    "end": "4415360"
  },
  {
    "text": "they were most paranoid about getting lost if you look at all the documentation it's like if the master",
    "start": "4415360",
    "end": "4420560"
  },
  {
    "text": "secret is lost all is lost the master secret is lost one session is exposed certificate is lost everything dies",
    "start": "4420560",
    "end": "4427280"
  },
  {
    "text": "okay now this master secret that's exchanged on a per session basis",
    "start": "4427280",
    "end": "4432400"
  },
  {
    "text": "the obvious thing to do i did this but i mean it's obvious and hasn't been done before but anyway",
    "start": "4432400",
    "end": "4438800"
  },
  {
    "text": "you just send the master secret over an encrypted channel to the ids that's interesting it's good it's what you",
    "start": "4438800",
    "end": "4444400"
  },
  {
    "text": "should do but it's not cool what's cool is there's multiple keys in there there's independent keys from the",
    "start": "4444400",
    "end": "4450800"
  },
  {
    "text": "direction from the client to the server and from the server to the client and it turns out what you can do and what has",
    "start": "4450800",
    "end": "4457040"
  },
  {
    "text": "been implemented and what should actually be a patch that is not in your tower ball but is ready right now",
    "start": "4457040",
    "end": "4462560"
  },
  {
    "text": "is you can just leak an individual key from the client to the server so in other words you're a bank",
    "start": "4462560",
    "end": "4469840"
  },
  {
    "text": "you do not trust traffic from the outside world you are under regulations though you can't allow any other machine",
    "start": "4469840",
    "end": "4476640"
  },
  {
    "text": "to see the traffic from the server to the client the sensitive personally identifying information you've got gram",
    "start": "4476640",
    "end": "4482080"
  },
  {
    "text": "leads fly you've got regulations everywhere ah so what do you do you leak the key to",
    "start": "4482080",
    "end": "4488000"
  },
  {
    "text": "the ids just in a single direction just for a single session anything goes wrong on the ids it's only getting traffic",
    "start": "4488000",
    "end": "4494080"
  },
  {
    "text": "from the outside world it's only getting a limited amount of it ah there's one last piece",
    "start": "4494080",
    "end": "4500560"
  },
  {
    "text": "it's really difficult and it isn't working yet but it works with bandwidth brokering",
    "start": "4500560",
    "end": "4506159"
  },
  {
    "text": "you've got a machine that's receiving all the client traffic it can't decrypt this server to client",
    "start": "4506159",
    "end": "4511199"
  },
  {
    "text": "traffic it also can't see the server decline in traffic but it's able to decrypt the client to server traffic why",
    "start": "4511199",
    "end": "4518640"
  },
  {
    "text": "is this not working immediately because there's some really nasty stuff going on with bandwidth brokering on the tcp level none of the ips align anymore the",
    "start": "4518640",
    "end": "4526560"
  },
  {
    "text": "ssl dump code had a heart attack when i started trying to make it do it so let's see",
    "start": "4526560",
    "end": "4532400"
  },
  {
    "text": "and i don't know if i'm going to get this to work i really don't let's see if i can make this happen",
    "start": "4532400",
    "end": "4538719"
  },
  {
    "text": "oh actually that's that's the alternative but we'll do that later",
    "start": "4538719",
    "end": "4543119"
  },
  {
    "text": "so here's that machine now we need to find the other machine that has ssl dump on it which should be",
    "start": "4544640",
    "end": "4550400"
  },
  {
    "text": "up here",
    "start": "4550400",
    "end": "4553560"
  },
  {
    "text": "hello never ever do this this whole live demo thing is like",
    "start": "4557120",
    "end": "4562480"
  },
  {
    "text": "really stressful because i really have no idea if this is going to work or not all right so",
    "start": "4562480",
    "end": "4569840"
  },
  {
    "text": "dk",
    "start": "4570239",
    "end": "4572800"
  },
  {
    "text": "oh it's this one i'm totally gonna have to change all my",
    "start": "4575840",
    "end": "4582400"
  },
  {
    "text": "certificates after this talk i don't even want to imagine if one of you hijacked this thing",
    "start": "4582400",
    "end": "4587520"
  },
  {
    "text": "all right so s tunnel",
    "start": "4587520",
    "end": "4592800"
  },
  {
    "text": "c our uh",
    "start": "4592800",
    "end": "4596640"
  },
  {
    "text": "actually there's no user just taxpayer.com25",
    "start": "4597840",
    "end": "4602920"
  },
  {
    "text": "ah that was really cool up to and including the moment where i got nothing there",
    "start": "4604000",
    "end": "4611840"
  },
  {
    "text": "there's something wrong here",
    "start": "4613199",
    "end": "4616080"
  },
  {
    "text": "yeah i really shouldn't be running this all right so anyway i'm not going to go ahead and do this live demo you'll get",
    "start": "4619440",
    "end": "4625360"
  },
  {
    "text": "the patch but the bottom line is this and the reason i'm not doing the live demo as a server i was about to do it on",
    "start": "4625360",
    "end": "4631120"
  },
  {
    "text": "is actually moving mail traffic so we actually um see where it says buy there that that was from an actual mail",
    "start": "4631120",
    "end": "4637120"
  },
  {
    "text": "session hey what can i say i don't do live demos",
    "start": "4637120",
    "end": "4642719"
  },
  {
    "text": "okay so check this out ssl dump has been modified in this patch that i've created what ssl dump does",
    "start": "4642719",
    "end": "4649280"
  },
  {
    "text": "normally it requires the key to be the certificate to be available instead you have two ssl dump sessions",
    "start": "4649280",
    "end": "4656880"
  },
  {
    "text": "one of them goes ahead and actually has a copy of the cert this lives on your end point eventually a sell dump isn't",
    "start": "4656880",
    "end": "4662000"
  },
  {
    "text": "there as a patch to open ssl itself what it does when that's when s sell dump is launched",
    "start": "4662000",
    "end": "4668719"
  },
  {
    "text": "is instead of just decrypting the traffic normally it forwards the it opens up an ssh",
    "start": "4668719",
    "end": "4674960"
  },
  {
    "text": "session like it actually prompts you for a password opens up an ssh session to",
    "start": "4674960",
    "end": "4680000"
  },
  {
    "text": "this other machine to our ids equivalent and it sub basically opens up a socket an",
    "start": "4680000",
    "end": "4686719"
  },
  {
    "text": "ssl top machine on that machine an sll an ssl dump process on that other",
    "start": "4686719",
    "end": "4692960"
  },
  {
    "text": "machine on the ids starts up listens for the socket receives the",
    "start": "4692960",
    "end": "4698719"
  },
  {
    "text": "socket every time a new session is initiated it receives the key for that",
    "start": "4698719",
    "end": "4703840"
  },
  {
    "text": "session now if all i i can go ahead and i can zero out",
    "start": "4703840",
    "end": "4709040"
  },
  {
    "text": "the key from an individual direction client server server to client it still works",
    "start": "4709040",
    "end": "4714480"
  },
  {
    "text": "and what happens is just as you saw down here within where it says buy like basically you just get to read the",
    "start": "4714480",
    "end": "4721440"
  },
  {
    "text": "traffic and if you're an ids developer you go ahead and you patch that into your engine",
    "start": "4721440",
    "end": "4727040"
  },
  {
    "text": "so i really wish that could have been a live demo i was working earlier today but uh yeah i'm not gonna mess with my",
    "start": "4727040",
    "end": "4732640"
  },
  {
    "text": "roommates now you know um all this stuff is nice and cool it's",
    "start": "4732640",
    "end": "4738640"
  },
  {
    "text": "really elegant but for http i don't want to say it's unnecessary but there's another approach",
    "start": "4738640",
    "end": "4745280"
  },
  {
    "text": "you can do and basically what you do is http is inferior to sockets",
    "start": "4745280",
    "end": "4752159"
  },
  {
    "text": "i'm you know this is coming from someone who likes going and running you know ip over http but still http run basically",
    "start": "4752159",
    "end": "4759520"
  },
  {
    "text": "takes everything you want to say batches in a big bunch and shoves it off somewhere and then if you want to see if",
    "start": "4759520",
    "end": "4766080"
  },
  {
    "text": "there's a reply you have to continue to go hey hey did i reply there apply there anything for me hey hello",
    "start": "4766080",
    "end": "4771280"
  },
  {
    "text": "um this is inferior sockets where you just you know toss bites back and forth",
    "start": "4771280",
    "end": "4777199"
  },
  {
    "text": "when you have a web application sooner or later it gets this big glob of data",
    "start": "4777199",
    "end": "4783520"
  },
  {
    "text": "it doesn't matter if it came in over an ssl link there's a blob of data you're supposed to do something with",
    "start": "4783520",
    "end": "4789440"
  },
  {
    "text": "before you go ahead and deal with it in your web application how about you toss it off to the ids maybe even see if the",
    "start": "4789440",
    "end": "4795840"
  },
  {
    "text": "ids is happy with it works it actually works really well you don't have to interface with the crypto",
    "start": "4795840",
    "end": "4801360"
  },
  {
    "text": "you don't have to worry about tcp ip cannery you're really selective about what you want to",
    "start": "4801360",
    "end": "4807120"
  },
  {
    "text": "expose or not anything you don't want to expose you just like replace it with x's",
    "start": "4807120",
    "end": "4812719"
  },
  {
    "text": "looks great what's the disadvantage nowhere near as cool but it does work and at the end of the",
    "start": "4812719",
    "end": "4819199"
  },
  {
    "text": "day you know i'm a consultant now i'm supposed to make things work so okay",
    "start": "4819199",
    "end": "4825440"
  },
  {
    "text": "so that's about all i've got to do with got five minutes left for questions um before i start and i'd like to thank",
    "start": "4825440",
    "end": "4831199"
  },
  {
    "text": "avaya they sent me out here been supporting all this work and that being said",
    "start": "4831199",
    "end": "4836400"
  },
  {
    "text": "hit me oh and i have books and shirts and stuff to give away too so",
    "start": "4836400",
    "end": "4843360"
  },
  {
    "text": "who thinks they can hurt my head oh for i know you can well he's gone so",
    "start": "4843360",
    "end": "4848640"
  },
  {
    "text": "who go ahead anyone go ahead",
    "start": "4848640",
    "end": "4856360"
  },
  {
    "text": "the question is what is the reliability of my type support scans and it ends up helping around i don't know",
    "start": "4863360",
    "end": "4870080"
  },
  {
    "text": "it really depends on the network it'll hover if i do three scans i'll get i",
    "start": "4870080",
    "end": "4875440"
  },
  {
    "text": "don't know eight thousand replies in four seconds out of sixty five thousand and it'll vary by a hundred or two",
    "start": "4875440",
    "end": "4882080"
  },
  {
    "text": "hundred either way so it looks like each time you're on a scan on a very nice network you'll get about 90 coverage",
    "start": "4882080",
    "end": "4890158"
  },
  {
    "text": "oh accuracy in the fingerprinting um you mean the temporal fingerprinting",
    "start": "4891360",
    "end": "4896560"
  },
  {
    "text": "okay so os fingerprinting by the end map model is actually pretty accurate like they're really able to go and say oh",
    "start": "4896560",
    "end": "4903199"
  },
  {
    "text": "that's a speedstream 2300 um os fingerprinting has worked pretty well",
    "start": "4903199",
    "end": "4909280"
  },
  {
    "text": "in that model and the temporal fingerprinting model you're just working with so little",
    "start": "4909280",
    "end": "4914800"
  },
  {
    "text": "and then there's various different tools of various different methods the basic idea there is go ahead do a",
    "start": "4914800",
    "end": "4922320"
  },
  {
    "text": "mass scan and then see what you got back and based off what you got back do your second pass and your third pass and so",
    "start": "4922320",
    "end": "4927760"
  },
  {
    "text": "on that's really how the design has to go there any other questions if not",
    "start": "4927760",
    "end": "4933040"
  },
  {
    "text": "thank you much",
    "start": "4933040",
    "end": "4936360"
  }
]