[
  {
    "text": "[Music]",
    "start": "2320",
    "end": "9749"
  },
  {
    "text": "[Music]",
    "start": "26990",
    "end": "42049"
  },
  {
    "text": "good morning welcome to uh the Die Hard",
    "start": "43039",
    "end": "49239"
  },
  {
    "text": "session there's few of us but we're loyal right power to",
    "start": "49239",
    "end": "55840"
  },
  {
    "text": "Apple uh our speaker this morning is J Beal who probably doesn't need an introduction but it's appropriate to say",
    "start": "55840",
    "end": "62280"
  },
  {
    "text": "a few words about him uh you may know him from his work with bastel uh",
    "start": "62280",
    "end": "67880"
  },
  {
    "text": "Linx and uh also as the author of the uh",
    "start": "67880",
    "end": "73159"
  },
  {
    "text": "internet uh Center for security unix's audit tool and you can hold up your book",
    "start": "73159",
    "end": "80119"
  },
  {
    "text": "I will hold up the book co-author of the uh sing snort uh book in which he wrote",
    "start": "80119",
    "end": "86159"
  },
  {
    "text": "a seminal pre-processor section document a lot of the things that are here to for",
    "start": "86159",
    "end": "92000"
  },
  {
    "text": "undocumented that's a reason to pick up that book so without further Ado here's",
    "start": "92000",
    "end": "98520"
  },
  {
    "text": "[Applause] jay make sure we don't get picked up on",
    "start": "99720",
    "end": "105759"
  },
  {
    "text": "both hello okay so uh so basically I uh",
    "start": "105759",
    "end": "111640"
  },
  {
    "text": "I like to do lockdown I like to do a lot of things but I like to do lockdown a lot and uh they got this new OSX thing",
    "start": "111640",
    "end": "118280"
  },
  {
    "text": "out and I know it's not that new but it's new enough for me right um and I said Gee it it would be plenty fun to",
    "start": "118280",
    "end": "124600"
  },
  {
    "text": "see how you'd lock that down and to see quite how bad it is before you lock it down and um and so I got myself a shiny",
    "start": "124600",
    "end": "132800"
  },
  {
    "text": "apple and uh and checked it out so I'll basically be showing you today what I found and how you can lock down your own",
    "start": "132800",
    "end": "140360"
  },
  {
    "text": "Apple if you've got one or somebody else's Apple if you uh hack into one or I mean I didn't wait I didn't say that",
    "start": "140360",
    "end": "145920"
  },
  {
    "text": "word black hat this isn't Defcon no um so what do we do first we'll talk about",
    "start": "145920",
    "end": "154400"
  },
  {
    "text": "auditing the core operating system um choosing tighter settings for than than",
    "start": "154400",
    "end": "159920"
  },
  {
    "text": "Apple has chosen for us and then I'll talk a little bit about automating the process with best steel um I actually",
    "start": "159920",
    "end": "166239"
  },
  {
    "text": "got bastial Linux ported to OSX I think about three months ago um and uh it's in",
    "start": "166239",
    "end": "172120"
  },
  {
    "text": "its it's in its early stages on the platform but but it does work and it does do a lot of what we're going to do",
    "start": "172120",
    "end": "178840"
  },
  {
    "text": "today okay so how much lockdown can you talk about in an hour and and you say",
    "start": "178840",
    "end": "184560"
  },
  {
    "text": "wait can't you can't you talk about all of it well honestly if you if you look at the if you look at the program guide",
    "start": "184560",
    "end": "190440"
  },
  {
    "text": "I do a a two-day 14-hour course on lockdown so um and that's that's Linux",
    "start": "190440",
    "end": "196239"
  },
  {
    "text": "and Solaris um locking down any operating system takes a whole bunch of time there's tons of stuff we can do",
    "start": "196239",
    "end": "201680"
  },
  {
    "text": "what I want to do is show you how to make your laptop if you brought one safe enough I would say to bring it into",
    "start": "201680",
    "end": "208120"
  },
  {
    "text": "Defcon this weekend okay okay well there are people there with screwdrivers there",
    "start": "208120",
    "end": "213319"
  },
  {
    "text": "are people there well okay nearly safe enough for Defcon okay so we'll talk",
    "start": "213319",
    "end": "219599"
  },
  {
    "text": "about doing we'll do a boot security audit okay what's boot security that means we'll try to make it to somebody",
    "start": "219599",
    "end": "225439"
  },
  {
    "text": "with uh somebody who knows uh who knows key commands who knows a few key commands and has a boot CD ROM doesn't",
    "start": "225439",
    "end": "231319"
  },
  {
    "text": "happen to root your laptop while you're running off to the bathroom or whatever we'll um we'll do a demon on it we'll",
    "start": "231319",
    "end": "237519"
  },
  {
    "text": "look at the demons that are on the system we'll look at the network demons that are on the system will shut some down I'll show you how to shut things",
    "start": "237519",
    "end": "243040"
  },
  {
    "text": "down that Apple didn't really intend for you to shut down just a little bit um",
    "start": "243040",
    "end": "248280"
  },
  {
    "text": "after that what you would do and we'll get into a little bit is ass set u ID audit you look at the programs on the",
    "start": "248280",
    "end": "254159"
  },
  {
    "text": "system to allow normal users to be root okay we'll look at KRON jobs we'll look",
    "start": "254159",
    "end": "259320"
  },
  {
    "text": "at the um you'll look at the you look at the programs that are running on the system and just you just want to know what runs on this system in order to",
    "start": "259320",
    "end": "265960"
  },
  {
    "text": "tighten it down and then where you would go next would be config configuring demons for better security okay um OSX",
    "start": "265960",
    "end": "274960"
  },
  {
    "text": "is a crazy little operating system or at least that's what it feels like to me because I've seen apples before right",
    "start": "274960",
    "end": "280240"
  },
  {
    "text": "you look at apples and they got this nice little nice nice little gooey interface and everyone's always said you can't hack an apple right you're not",
    "start": "280240",
    "end": "286120"
  },
  {
    "text": "going to hack an apple remotely you know because there's they they don't they don't really they don't really have any you know they don't really have a remote",
    "start": "286120",
    "end": "292479"
  },
  {
    "text": "Administration interface so so what are you going to get it to do you know and and yes you could find ways to hack to",
    "start": "292479",
    "end": "298639"
  },
  {
    "text": "hack os9 remotely but but yeah there wasn't a whole lot you could get the thing to do so now what are they doing",
    "start": "298639",
    "end": "304000"
  },
  {
    "text": "now they're running now you got an operating system that runs office okay it's got this it's got still",
    "start": "304000",
    "end": "310880"
  },
  {
    "text": "got this wonderful easy to you easy to use goey that means I'll give an apple to my grandmother okay um actually my",
    "start": "310880",
    "end": "317560"
  },
  {
    "text": "grandmother's a kernel programmer um so you know but at the same time you've got",
    "start": "317560",
    "end": "324080"
  },
  {
    "text": "Unix under underneath and more than you having Unix you have kind of have what feels like a bunch of things that have",
    "start": "324080",
    "end": "329400"
  },
  {
    "text": "been stuff together right you've got uh you've got kind of a FreeBSD you've got a FreeBSD architecture all over there",
    "start": "329400",
    "end": "336360"
  },
  {
    "text": "you've got a mock kernel okay and then you've got some weird next stuff thrown in just because well Steve Jobs was",
    "start": "336360",
    "end": "343039"
  },
  {
    "text": "coming from next and thought that maybe he'd bring some guys with them and they' need something to do so um",
    "start": "343039",
    "end": "351039"
  },
  {
    "text": "right okay so what I you know the first place we we'll work on well first thing",
    "start": "351039",
    "end": "356120"
  },
  {
    "text": "we'll look at is boot security okay the the the whole whole boot process it's not entirely simple because mock isn't",
    "start": "356120",
    "end": "363520"
  },
  {
    "text": "mock is this weird kind of Kernel and there's a whole bunch of stuff that happens before where we normally start",
    "start": "363520",
    "end": "369319"
  },
  {
    "text": "where where we normally think of you know where of of you know we normally think on on a Unix system ah you'll have",
    "start": "369319",
    "end": "375599"
  },
  {
    "text": "the kernel start you know a boot loader will load the kernel the kernel will load a knit and that'll be it you know it just be that and Mock's a little bit",
    "start": "375599",
    "end": "381319"
  },
  {
    "text": "more complicated than that for our purposes today let's assume that there's a boot loader okay let's assume that",
    "start": "381319",
    "end": "388479"
  },
  {
    "text": "there's a bootloader open boot that loads a kernel okay let's assume the kernel loads that that the Kernel's",
    "start": "388479",
    "end": "394840"
  },
  {
    "text": "first process is called mockin it and not really worried too much about what mockin it does except that it starts in",
    "start": "394840",
    "end": "400520"
  },
  {
    "text": "it which is really what we thought the first thing that would start would be okay and in it still ends up being process one and then it's going to run",
    "start": "400520",
    "end": "407400"
  },
  {
    "text": "two scripts ety rc. boot okay and it's going to run etcc and RC dooot one of",
    "start": "407400",
    "end": "414319"
  },
  {
    "text": "the primary things that that's there for is single user mode so we're going to look at that okay and then what's at CC",
    "start": "414319",
    "end": "420199"
  },
  {
    "text": "do well we're used to RC to etcc you know loading lots of things by itself",
    "start": "420199",
    "end": "426000"
  },
  {
    "text": "okay or loading another RC script on most BSD operating systems or if you used to CIS 5 like Linux and Solaris",
    "start": "426000",
    "end": "432120"
  },
  {
    "text": "then you used to RC going and going and running um a whole bunch of stuff out of say at cc3d it's it goes through and",
    "start": "432120",
    "end": "439759"
  },
  {
    "text": "runs every single start script it finds in a given directory and the way it does that it runs it it runs them all in",
    "start": "439759",
    "end": "445639"
  },
  {
    "text": "order okay what this does on the Mac is it's running a program called system starter and system starter is kind of",
    "start": "445639",
    "end": "453000"
  },
  {
    "text": "we're going to come back to that and I'll show you system starter is kind of strange okay so first let's get into",
    "start": "453000",
    "end": "459599"
  },
  {
    "text": "let's get into you know what could somebody do at Defcon to our laptop right very first thing they're going to",
    "start": "459599",
    "end": "467319"
  },
  {
    "text": "do has my laptop turned itself on yes it has now it's just going to sleep okay",
    "start": "468199",
    "end": "475199"
  },
  {
    "text": "the very first thing they're going to do is they're going to shut down our system and that box there as you'll see in your",
    "start": "475199",
    "end": "481479"
  },
  {
    "text": "if you look in your book that box is a little open Apple character it just didn't render properly in PowerPoint um",
    "start": "481479",
    "end": "488840"
  },
  {
    "text": "uh yeah okay so what you do is you just hold down open Apple s during the boot",
    "start": "488840",
    "end": "495120"
  },
  {
    "text": "and what we can see is let me shut this system down you can",
    "start": "495120",
    "end": "500479"
  },
  {
    "text": "see",
    "start": "508440",
    "end": "511440"
  },
  {
    "text": "okay so I'm holding down open Apple s behind the",
    "start": "513760",
    "end": "518919"
  },
  {
    "text": "podium over",
    "start": "520839",
    "end": "524159"
  },
  {
    "text": "there",
    "start": "538440",
    "end": "541440"
  },
  {
    "text": "do you guys see an apple in the middle of the screen or is it just white it's just white but it's not blue",
    "start": "547440",
    "end": "553560"
  },
  {
    "text": "blue was nothing okay still",
    "start": "553560",
    "end": "560560"
  },
  {
    "text": "waiting",
    "start": "568360",
    "end": "571360"
  },
  {
    "text": "maybe it's not happy with our",
    "start": "576519",
    "end": "579720"
  },
  {
    "text": "projector my screen this is the strange thing my screen shows an open Apple and",
    "start": "582240",
    "end": "588880"
  },
  {
    "text": "a little guy wiggling and wiggling around like it does during a normal Booth which is what's",
    "start": "588880",
    "end": "595839"
  },
  {
    "text": "strange yeah I'm going through a normal Booth this is not what I should be doing yes it's more secure uh see they didn't",
    "start": "595839",
    "end": "603600"
  },
  {
    "text": "get single user mode um or",
    "start": "603600",
    "end": "608800"
  },
  {
    "text": "something I tell you what we'll do I will show you us trying to get",
    "start": "616240",
    "end": "623519"
  },
  {
    "text": "single user mode do you want me to try the attack again do you want me to try and boot into single user mode directly again yes you'll believe me okay so why",
    "start": "623519",
    "end": "631000"
  },
  {
    "text": "don't I show you what happens if you um if you do this what we can",
    "start": "631000",
    "end": "636959"
  },
  {
    "text": "do okay what you can do to stop this this open Apple s thing if you look in",
    "start": "636959",
    "end": "642360"
  },
  {
    "text": "if you look in if you look in Apple's documentation um if you look in the etct",
    "start": "642360",
    "end": "648120"
  },
  {
    "text": "file what it says is you can change the etct file you can put insecure console",
    "start": "648120",
    "end": "653399"
  },
  {
    "text": "and it will not do this so I've tested that and that's wrong if if you put",
    "start": "653399",
    "end": "659800"
  },
  {
    "text": "insecure on the console line instead of secure it still boots to single user mode it it doesn't do this it boots to",
    "start": "659800",
    "end": "666600"
  },
  {
    "text": "single user mode no password required or anything like that so what happened was some guy wrote a program it's up on OSX",
    "start": "666600",
    "end": "674880"
  },
  {
    "text": "scripts.com secured he wrote a little program it's a little Pearl program it's a shell script that installs a pearl",
    "start": "674880",
    "end": "680360"
  },
  {
    "text": "program and what this program does is basically you set a boot password you",
    "start": "680360",
    "end": "685760"
  },
  {
    "text": "set it's not it's not a boot Lo it's it's not a bootloader password you're",
    "start": "685760",
    "end": "692000"
  },
  {
    "text": "setting a separate password it's not the bootloader password not it's not the root password you're welcome to use either one if you want and that password",
    "start": "692000",
    "end": "699120"
  },
  {
    "text": "is the system makes you give it that password um every time you try to boot in single user mode and the way it works",
    "start": "699120",
    "end": "705760"
  },
  {
    "text": "is his script just inserts that little language right there into rc. Boot and it says if the boot type is single user",
    "start": "705760",
    "end": "712639"
  },
  {
    "text": "mode then run password. okay and if you try to break out of password. it reboots the system",
    "start": "712639",
    "end": "719079"
  },
  {
    "text": "um so let's do that on this system",
    "start": "719079",
    "end": "725279"
  },
  {
    "text": "here okay so I've unpacked that secur tarball",
    "start": "740199",
    "end": "747839"
  },
  {
    "text": "already and it's really pretty simple you just run install and it says give me",
    "start": "747839",
    "end": "752959"
  },
  {
    "text": "the password you want to use to protect single user mode okay this as you can see is kind of a clug okay what we'd",
    "start": "752959",
    "end": "760199"
  },
  {
    "text": "like is for Apple's is for Apple's recommended method to just work properly um it it doesn't um we'll complain to",
    "start": "760199",
    "end": "767040"
  },
  {
    "text": "Apple later on for now we'll set a password and it says",
    "start": "767040",
    "end": "773600"
  },
  {
    "text": "that it's gone and adjusted rc. boot we can look at rc. boot and we can see",
    "start": "773600",
    "end": "781120"
  },
  {
    "text": "where is it okay right toward the end of r c.",
    "start": "781120",
    "end": "788639"
  },
  {
    "text": "boot what we get is you want me to try to increase this",
    "start": "788639",
    "end": "794360"
  },
  {
    "text": "font yeah can you read it in the back no no",
    "start": "794360",
    "end": "800800"
  },
  {
    "text": "way how's that yes or no yes okay so",
    "start": "803440",
    "end": "809839"
  },
  {
    "text": "what that is is we've just that that's that little language it just added a little to rc. boot and rc. boot is the",
    "start": "809839",
    "end": "814920"
  },
  {
    "text": "script that gives you root if you're going to single single user mode this script gets run and if you're going into",
    "start": "814920",
    "end": "820560"
  },
  {
    "text": "single user mode this is the one that gives you root so what they've done what he's done is just changed it so that if",
    "start": "820560",
    "end": "827519"
  },
  {
    "text": "we reboot the system and this time I'll use",
    "start": "827519",
    "end": "834519"
  },
  {
    "text": "shutdown uh here show",
    "start": "838040",
    "end": "843759"
  },
  {
    "text": "you okay it's been password. it's actually basically really",
    "start": "843759",
    "end": "851360"
  },
  {
    "text": "really simple okay it's got a data file in user local secur data and that data",
    "start": "851360",
    "end": "857160"
  },
  {
    "text": "file is just your password it's been crypted it's using standard Pearl Crypt",
    "start": "857160",
    "end": "864399"
  },
  {
    "text": "command which is just the normal normal Li Crypt Library okay so it's B basically the same encryption you used",
    "start": "864399",
    "end": "870440"
  },
  {
    "text": "to on Old School Unix passwords he could probably md5 it if you wanted to you could probably change the script to md5",
    "start": "870440",
    "end": "877519"
  },
  {
    "text": "if enough if if more than three people from this room email me and ask me to I'll re-release it with an md5 as long",
    "start": "877519",
    "end": "883920"
  },
  {
    "text": "as the license on security doesn't prevent me from doing so I don't think it does I think it's just something he was given away for free okay but all",
    "start": "883920",
    "end": "889920"
  },
  {
    "text": "it's doing it's extremely simple all it's doing is going and and chat and",
    "start": "889920",
    "end": "895000"
  },
  {
    "text": "having you enter a password crypting that password seeing if the crypted one is the same same as the other one um and",
    "start": "895000",
    "end": "901160"
  },
  {
    "text": "not letting you out yes in the",
    "start": "901160",
    "end": "904319"
  },
  {
    "text": "back does the RC does the RC boot script prevent you from getting out of the script before you get to this point if I",
    "start": "907160",
    "end": "913560"
  },
  {
    "text": "remember correctly yes um we're going to",
    "start": "913560",
    "end": "918600"
  },
  {
    "text": "look at the rc. boot script",
    "start": "918600",
    "end": "924120"
  },
  {
    "text": "okay so it's setting signals is undefined",
    "start": "924120",
    "end": "929519"
  },
  {
    "text": "if you can find a way kill quit start stop um where's it let's",
    "start": "929519",
    "end": "938079"
  },
  {
    "text": "see what's that yeah there's not a trap I haven't",
    "start": "955279",
    "end": "960959"
  },
  {
    "text": "seen this before but I'm assuming that that's handling each of these",
    "start": "960959",
    "end": "966560"
  },
  {
    "text": "signals right okay so if you could find another",
    "start": "970519",
    "end": "975759"
  },
  {
    "text": "way in okay um let's reboot",
    "start": "975759",
    "end": "983639"
  },
  {
    "text": "now",
    "start": "987920",
    "end": "990920"
  },
  {
    "text": "I'm also going to show you how you can how you can um I'm also going to show you how you can stop somebody from booting from a CD do you want me to do",
    "start": "997600",
    "end": "1004040"
  },
  {
    "text": "you guys want me to demo that I mean you see that there's a delay in here do you want me to demo that or do you want me to just tell you how it works",
    "start": "1004040",
    "end": "1010839"
  },
  {
    "text": "um tell us anybody for demo okay we'll stick with the tell us",
    "start": "1010839",
    "end": "1017199"
  },
  {
    "text": "then",
    "start": "1017839",
    "end": "1020839"
  },
  {
    "text": "I've unplugged the laptop from the projector just in case it's the reason we weren't getting single user mode was because uh he was getting upset about",
    "start": "1038039",
    "end": "1044558"
  },
  {
    "text": "the projector being its display",
    "start": "1044559",
    "end": "1050840"
  },
  {
    "text": "does do does all of this I haven't tried on an open Darwin and I'll tell you I've only got one machine um but I would be",
    "start": "1076360",
    "end": "1083760"
  },
  {
    "text": "happy to if somebody's got an open Darwin machine that um I mean in terms of the booting I can't test that",
    "start": "1083760",
    "end": "1089039"
  },
  {
    "text": "remotely but if anyone's got an open Darwin machine they want to give me some access to look around on I'd be happy to",
    "start": "1089039",
    "end": "1094440"
  },
  {
    "text": "look around on it okay I don't know why but I'm not",
    "start": "1094440",
    "end": "1100520"
  },
  {
    "text": "actually getting single user mode no matter what I do with the projector so I'm going to skip I'm going to stick",
    "start": "1100520",
    "end": "1107880"
  },
  {
    "text": "to the to the tell you rather than show you on this example as well okay when we're",
    "start": "1107880",
    "end": "1114520"
  },
  {
    "text": "done when we're done with that when we're done with that previous step single user Mode's password protected",
    "start": "1114520",
    "end": "1120200"
  },
  {
    "text": "it's password protected through auge but it's password protected okay that would make me happy enough to to not worry",
    "start": "1120200",
    "end": "1126000"
  },
  {
    "text": "about that to not worry about that attack at Dacon okay so what else can you do somebody actually came up with",
    "start": "1126000",
    "end": "1132760"
  },
  {
    "text": "other with another method right you could actually go and replace your kernel you could actually go and replace",
    "start": "1132760",
    "end": "1138280"
  },
  {
    "text": "your kernel with one that did just didn't run rc. boot okay one that didn't really believe in single user mode um I",
    "start": "1138280",
    "end": "1145520"
  },
  {
    "text": "don't like this idea but I've added a slide on it um and the probably the reason I don't like it is I think during",
    "start": "1145520",
    "end": "1151080"
  },
  {
    "text": "your first Hardware failure when you really wanted single user mode you don't have it around that would that would",
    "start": "1151080",
    "end": "1156600"
  },
  {
    "text": "make me pretty unhappy okay as a Cadman I really wouldn't want that as somebody with a laptop I still you know I still",
    "start": "1156600",
    "end": "1163480"
  },
  {
    "text": "wouldn't want it that I I still wouldn't want it that much okay so what's the other thing that's going to Happ",
    "start": "1163480",
    "end": "1168760"
  },
  {
    "text": "happened to me at Defcon when I put this laptop down um you know but chain it up so that someone's not going to just",
    "start": "1168760",
    "end": "1174080"
  },
  {
    "text": "outright steal it but you know um well let's assume that the script kitties aren't going to screwdriver it open they",
    "start": "1174080",
    "end": "1180000"
  },
  {
    "text": "they need a hex wrench I think um but you know what's the other thing they're going to do well you know probably one",
    "start": "1180000",
    "end": "1185360"
  },
  {
    "text": "of them is going to going to walk up with a uh with an apple boot CD okay and I I've got one with me and the nice",
    "start": "1185360",
    "end": "1192039"
  },
  {
    "text": "thing about that Apple boot CD is you don't have to just use it you don't even have to know that much to use it okay normally what if you've got a if you've",
    "start": "1192039",
    "end": "1198080"
  },
  {
    "text": "got a system forget the root password on it or you know it's somebody else's you take a boot CD you put it in it boots up",
    "start": "1198080",
    "end": "1205039"
  },
  {
    "text": "you get boot off that CD you have to go and remount the drive read right go and edit the file from the drive sync the",
    "start": "1205039",
    "end": "1211080"
  },
  {
    "text": "drive shut the machine down bring it back up okay Apple actually thought you know people are going to forget their",
    "start": "1211080",
    "end": "1216200"
  },
  {
    "text": "passwords often enough if you boot off the Apple install CD okay it's got one",
    "start": "1216200",
    "end": "1221240"
  },
  {
    "text": "of the options across the top I don't remember exactly which of the three menus but one of the options across the top is the password utility which is",
    "start": "1221240",
    "end": "1228400"
  },
  {
    "text": "really nice it says hi which drive that's attached you want to change the password on and you can click on any drive that's attached including the main",
    "start": "1228400",
    "end": "1234440"
  },
  {
    "text": "hard drive and so then it says which account would you like to change the password for and you can change it for",
    "start": "1234440",
    "end": "1239720"
  },
  {
    "text": "any of the accounts for the administrator account for your account for root account Etc okay so this is a",
    "start": "1239720",
    "end": "1245840"
  },
  {
    "text": "very useful utility in the hand of in the in the hands of Defcon script kitties um and the rest of us too okay",
    "start": "1245840",
    "end": "1252960"
  },
  {
    "text": "so to boot from CD and I I promis this would work okay all you do is you you",
    "start": "1252960",
    "end": "1258840"
  },
  {
    "text": "put the CD in you hold down the option keyy while you're booting and what happens is it presents a list of devices",
    "start": "1258840",
    "end": "1264320"
  },
  {
    "text": "you can boot from you can boot from an iPod actually um you can boot from a from a from the Apple iPod I've been",
    "start": "1264320",
    "end": "1270640"
  },
  {
    "text": "told I don't have one um but if anybody wants to give me one for testing purposes I'd be happy to be happy to",
    "start": "1270640",
    "end": "1277000"
  },
  {
    "text": "accept um but you know you can also so you can use that to boot from CD and you can boot from CD and once you boot from",
    "start": "1277000",
    "end": "1283080"
  },
  {
    "text": "CD you can use the password utility or you can you know Mount that if you've got a nice bootable if you got a nice",
    "start": "1283080",
    "end": "1289760"
  },
  {
    "text": "bootable CD for OSX you can launch whatever little operating system you want off that CD and do whatever you",
    "start": "1289760",
    "end": "1295200"
  },
  {
    "text": "want to the drives okay so if you don't want that to work your counter measure",
    "start": "1295200",
    "end": "1301600"
  },
  {
    "text": "is and people who admin Solaris systems especially should kind of recognize this they've got Apple's using the open",
    "start": "1301600",
    "end": "1307320"
  },
  {
    "text": "firmware so what you do is you boot into open firmware command option o and once",
    "start": "1307320",
    "end": "1313640"
  },
  {
    "text": "it boots up you'll get a little you're going to be in text mode you get a little text prompt that says um that",
    "start": "1313640",
    "end": "1319039"
  },
  {
    "text": "just lets you type whatever and you can type password and it'll ask you to enter a password okay and then you can type",
    "start": "1319039",
    "end": "1325240"
  },
  {
    "text": "set End security mode command don't put security mode equals command um if you",
    "start": "1325240",
    "end": "1330520"
  },
  {
    "text": "do it won't work um it won't hose the won't hose this you just be setting a you'll just be setting a variable that's",
    "start": "1330520",
    "end": "1335840"
  },
  {
    "text": "not really defined okay so security mode command and then type reset all what",
    "start": "1335840",
    "end": "1341640"
  },
  {
    "text": "that does is makes it so that people can boot normally but if they want to boot from another device if they want to change the boot process in any way",
    "start": "1341640",
    "end": "1348080"
  },
  {
    "text": "they've got to type in a password okay you can actually set it to full and then they have to type then then they have to",
    "start": "1348080",
    "end": "1353880"
  },
  {
    "text": "type your open firmware password for any boot um I actually do that to a number of my laptops um but that may not be",
    "start": "1353880",
    "end": "1361799"
  },
  {
    "text": "what you want for you know machine that's supposed to just work okay that you just don't want you just don't want somebody you just don't want somebody",
    "start": "1361799",
    "end": "1367960"
  },
  {
    "text": "countermanding the boot process okay so I generally recommend command you can set it to full um and then it won't boot",
    "start": "1367960",
    "end": "1375480"
  },
  {
    "text": "otherwise okay is there anybody in this room who's got a son box they've gone and forgotten the root password and",
    "start": "1375480",
    "end": "1380799"
  },
  {
    "text": "forgotten the eprom password and they they've had this set to full anyone okay well then I'll",
    "start": "1380799",
    "end": "1387559"
  },
  {
    "text": "embarrass myself and say that I've done it okay if you do this you go on go on",
    "start": "1387559",
    "end": "1393159"
  },
  {
    "text": "Google and you say you know forgot password to eom or whatever what you'll come back with is that the the primary",
    "start": "1393159",
    "end": "1399880"
  },
  {
    "text": "solution for this the primary solution for this there there are better ones but the primary solution people keep",
    "start": "1399880",
    "end": "1405320"
  },
  {
    "text": "recommending is well if you've forgotten the password on your eom and you had it set to full um your machine's not going",
    "start": "1405320",
    "end": "1411159"
  },
  {
    "text": "to boot unless you can basically go on eBay and buy a new eom and replace it",
    "start": "1411159",
    "end": "1416799"
  },
  {
    "text": "it's not something that's just simply battery backed um you can't just yank the battery like on good old Intel",
    "start": "1416799",
    "end": "1422120"
  },
  {
    "text": "Hardware um you're just kind of stuck with an unbootable system okay that's another reason to go for to just go for",
    "start": "1422120",
    "end": "1428640"
  },
  {
    "text": "command and just stick to I just need to you know I'm just trying to make sure someone doesn't counterman the boot",
    "start": "1428640",
    "end": "1435000"
  },
  {
    "text": "process Okay so what else",
    "start": "1435000",
    "end": "1440760"
  },
  {
    "text": "um if I bring up if I boot my system the way it ships from Apple when you first",
    "start": "1440760",
    "end": "1445960"
  },
  {
    "text": "buy an apple an apple an apple machine okay it says you know you start it up and it asks you for a user it asks you",
    "start": "1445960",
    "end": "1452320"
  },
  {
    "text": "for a first username asks you for a name and password and it's saying I'll go and set this as the first user on the box",
    "start": "1452320",
    "end": "1458840"
  },
  {
    "text": "and so great you set that as the first user on the box from now on Apple's default is that the machine always comes",
    "start": "1458840",
    "end": "1464400"
  },
  {
    "text": "up as that user okay it always comes up as that user whenever you're you know whenever you",
    "start": "1464400",
    "end": "1470440"
  },
  {
    "text": "turn the machine on so you turn the machine on no authentication required this is again a very very friendly",
    "start": "1470440",
    "end": "1475960"
  },
  {
    "text": "little thing but not what I want not what I really want the machine doing you know if I if I leave it alone at Defcon",
    "start": "1475960",
    "end": "1482039"
  },
  {
    "text": "because you know I might have the screen Locker on right now but somebody can turn the you know somebody just turn the",
    "start": "1482039",
    "end": "1487200"
  },
  {
    "text": "machine off and bring it back on and it logs directly in as me and they're like ha um and you know copying all my files",
    "start": "1487200",
    "end": "1494360"
  },
  {
    "text": "off to their firewire Drive I I don't like that so so you can change that that",
    "start": "1494360",
    "end": "1499399"
  },
  {
    "text": "in two different ways the way that's nice and easy and fits on the goey just involves bringing up system",
    "start": "1499399",
    "end": "1508840"
  },
  {
    "text": "preferences oh it's still blue screen let's try this",
    "start": "1510120",
    "end": "1516840"
  },
  {
    "text": "again I'm sorry he hates to use the phrase Mac and",
    "start": "1519200",
    "end": "1525279"
  },
  {
    "text": "blue screen at the same time",
    "start": "1525279",
    "end": "1530320"
  },
  {
    "text": "okay so we go under system preferences we go under",
    "start": "1530960",
    "end": "1536440"
  },
  {
    "text": "accounts okay um login options oh wait",
    "start": "1536440",
    "end": "1542919"
  },
  {
    "text": "where' I put that here log in automatically it's under users log in automatically you just unclick that box",
    "start": "1542919",
    "end": "1550240"
  },
  {
    "text": "and that's gone there's also a way to do that in text mode by editing a file but",
    "start": "1550240",
    "end": "1555440"
  },
  {
    "text": "I I won't show you that unless you ask me to um this should be um you can edit that",
    "start": "1555440",
    "end": "1563240"
  },
  {
    "text": "file by hand and what that file looks like",
    "start": "1563240",
    "end": "1569000"
  },
  {
    "text": "is XML let's pump up that",
    "start": "1569000",
    "end": "1576279"
  },
  {
    "text": "font",
    "start": "1576279",
    "end": "1579279"
  },
  {
    "text": "here",
    "start": "1587240",
    "end": "1590240"
  },
  {
    "text": "a lot of the file files that I'm expecting to be in Etsy or in places like library or system",
    "start": "1602559",
    "end": "1608840"
  },
  {
    "text": "Library okay come Apple login window pist pist stands for property list it's",
    "start": "1608840",
    "end": "1615840"
  },
  {
    "text": "an XML file there are a lot of a lot of Apple configuration files are XML files and you can change you can edit these",
    "start": "1615840",
    "end": "1622440"
  },
  {
    "text": "files with the um you can edit these files usually um you can edit these",
    "start": "1622440",
    "end": "1628240"
  },
  {
    "text": "files usually with the defaults command am I oh I already turned it off okay if",
    "start": "1628240",
    "end": "1634279"
  },
  {
    "text": "we hadn't turned it off what you'd see is see that we have all these key value pairs you've got key",
    "start": "1634279",
    "end": "1643320"
  },
  {
    "text": "retries retries until hint integer three that's the value key value key value so",
    "start": "1643320",
    "end": "1649200"
  },
  {
    "text": "there'd be a keyy for auto login user and it would say Auto login user J so",
    "start": "1649200",
    "end": "1655159"
  },
  {
    "text": "you could just delete that entirely okay you should be able to use the defaults command to change these files and that's",
    "start": "1655159",
    "end": "1661640"
  },
  {
    "text": "really what what was supposed to be your interface to these files where you're allowed to adjust them um but it's not",
    "start": "1661640",
    "end": "1668440"
  },
  {
    "text": "actually you know but it doesn't actually work here okay so I've just been editing this by hand what else as",
    "start": "1668440",
    "end": "1675159"
  },
  {
    "text": "far as boot security um the login screen gives you the ability ility to um gives you the ability before you've",
    "start": "1675159",
    "end": "1680480"
  },
  {
    "text": "authenticated before you've logged in to reboot the machine or shut it down cleanly um that again is a really nice",
    "start": "1680480",
    "end": "1687080"
  },
  {
    "text": "little feature um it's you know not quite as useful at Defcon um but it's still something that I'd prefer not to",
    "start": "1687080",
    "end": "1693720"
  },
  {
    "text": "have people be able to do okay so we can change that in that system",
    "start": "1693720",
    "end": "1702440"
  },
  {
    "text": "preferences window that I had up okay an account",
    "start": "1703480",
    "end": "1710120"
  },
  {
    "text": "login options and then we've got hide the restart and shutdown",
    "start": "1711519",
    "end": "1718480"
  },
  {
    "text": "buttons okay and that'll that'll make sure that's turned off the other place you can change it um is in the etct file",
    "start": "1718480",
    "end": "1726360"
  },
  {
    "text": "on that console line and",
    "start": "1726360",
    "end": "1730240"
  },
  {
    "text": "that",
    "start": "1737039",
    "end": "1740039"
  },
  {
    "text": "thank you okay so etct TTY y okay I told you",
    "start": "1745440",
    "end": "1752480"
  },
  {
    "text": "about the etct TTY y file it has that console line and we go to the console line and",
    "start": "1752480",
    "end": "1758880"
  },
  {
    "text": "what you can do is just on that line as an option you can",
    "start": "1758880",
    "end": "1765278"
  },
  {
    "text": "add okay right there",
    "start": "1766640",
    "end": "1773080"
  },
  {
    "text": "power off oh okay you can add the",
    "start": "1773080",
    "end": "1781200"
  },
  {
    "text": "line minus power off",
    "start": "1786919",
    "end": "1792120"
  },
  {
    "text": "disabled capital y s and that prevents that now you'll",
    "start": "1792120",
    "end": "1798399"
  },
  {
    "text": "notice on that console line it says secure okay it said insecure is Apple's default what that should be doing for us",
    "start": "1798399",
    "end": "1805519"
  },
  {
    "text": "is stopping us from logging in directly stopping us from using single user mode um that's not to my knowledge what's",
    "start": "1805519",
    "end": "1811799"
  },
  {
    "text": "causing this problem right here where we weren't where where open apps wasn't working um because I tried that got very",
    "start": "1811799",
    "end": "1818279"
  },
  {
    "text": "frustrated said okay I'll look for another method um okay so either of those two methods",
    "start": "1818279",
    "end": "1824720"
  },
  {
    "text": "do the same have the same effect in the ACT okay okay you can't you can't restart or power off the machine without",
    "start": "1824720",
    "end": "1831840"
  },
  {
    "text": "authenticating first and that's kind of nice okay so at this point what I at",
    "start": "1831840",
    "end": "1837440"
  },
  {
    "text": "this point those are my boot security issues okay those are the those are the issues I have in terms of boot security",
    "start": "1837440",
    "end": "1842760"
  },
  {
    "text": "that's how I'd fix them you can potentially think of more ways to counterman the boot process I like the",
    "start": "1842760",
    "end": "1848480"
  },
  {
    "text": "idea of checking scripts and seeing if and seeing if I can control C anywhere in the boot process whatsoever um that's",
    "start": "1848480",
    "end": "1854720"
  },
  {
    "text": "a a good idea um stop doing that okay so",
    "start": "1854720",
    "end": "1861399"
  },
  {
    "text": "um from here what I'd like to do is basically show you what Demons What demons are running on the system and how",
    "start": "1861399",
    "end": "1867279"
  },
  {
    "text": "we can shut them off if we want to um it's not as easy as you'd expect because",
    "start": "1867279",
    "end": "1872760"
  },
  {
    "text": "Apple didn't quite intend for you to do as much um in terms of turning things off um one of the interesting things has",
    "start": "1872760",
    "end": "1879559"
  },
  {
    "text": "anybody heard of Rondevu you heard of revu okay about a quarter of the room rendevu is this nice little system you",
    "start": "1879559",
    "end": "1886240"
  },
  {
    "text": "know you can use it um rendevu will yeah there's somebody in the in the third row just went like this okay rendevu is this",
    "start": "1886240",
    "end": "1892720"
  },
  {
    "text": "nice little system that um hey would you like me to find would you like me to find other people on your local area network that are that are using instant",
    "start": "1892720",
    "end": "1898519"
  },
  {
    "text": "messenger too and then you can you can add them to your buddy list do you want me to find people on the network who want to share files and so on and so on",
    "start": "1898519",
    "end": "1905360"
  },
  {
    "text": "so you know you know that you're just you know that you're just riding the subway with your laptop on and uh you",
    "start": "1905360",
    "end": "1911000"
  },
  {
    "text": "forgot to turn off the wireless card and all of a sudden it's saying you know it's going and advertising to everybody hey uh Jay's got some files to share",
    "start": "1911000",
    "end": "1917919"
  },
  {
    "text": "here you go and and he's on in messenger maybe you should talk to him and all of a sudden you're being spammed by this by",
    "start": "1917919",
    "end": "1923159"
  },
  {
    "text": "the sales gu sitting across from you hey you maybe you want to buy some security software I got firewalls you know and",
    "start": "1923159",
    "end": "1929519"
  },
  {
    "text": "somebody else is going and copying all of your MP3s um you know it's it's okay",
    "start": "1929519",
    "end": "1934559"
  },
  {
    "text": "I don't really like the idea of rendevu too much I mean it's I'm sure it's extremely convenient but I'm at a",
    "start": "1934559",
    "end": "1940279"
  },
  {
    "text": "security conference man um I'm not going to run that stuff on my laptop while I'm here I'm not going to run it anytime but",
    "start": "1940279",
    "end": "1946440"
  },
  {
    "text": "I'm sure as heck not going to run it here so Apple didn't actually give you an easy way to shut it off and that's",
    "start": "1946440",
    "end": "1952360"
  },
  {
    "text": "what we're going to see we're going to see there are a few things that they decided that you wouldn't really want to shut off so um they didn't really give",
    "start": "1952360",
    "end": "1959200"
  },
  {
    "text": "you any easy interface for doing it okay so to show you how to audit the boot process basically we talked about these",
    "start": "1959200",
    "end": "1966360"
  },
  {
    "text": "earlier SL etcc is what's actually you know is kind of our init was starting up",
    "start": "1966360",
    "end": "1972760"
  },
  {
    "text": "at CRC at CRC and RC is kind of doing the bulk of our work for getting all the programs running that we're used to okay",
    "start": "1972760",
    "end": "1979600"
  },
  {
    "text": "what you need to know about atcc is that it runs rc. common to do some common startup functions and and importantly to",
    "start": "1979600",
    "end": "1988080"
  },
  {
    "text": "us it sources a file called Etsy host config okay and ety host",
    "start": "1988080",
    "end": "1993240"
  },
  {
    "text": "config looks like",
    "start": "1993240",
    "end": "1996840"
  },
  {
    "text": "this okay Etsy host config looks like this and it has a bunch of things you",
    "start": "1998799",
    "end": "2003919"
  },
  {
    "text": "might want turned on or off or configured in some way and so that kind of that end that that's supposed to be",
    "start": "2003919",
    "end": "2009639"
  },
  {
    "text": "our Master file to shut everything on and to shut everything off and turn it back on if we want to okay Apple",
    "start": "2009639",
    "end": "2016480"
  },
  {
    "text": "actually comes out actually comes with some decent defaults compared to a lot of other operating systems I didn't",
    "start": "2016480",
    "end": "2021840"
  },
  {
    "text": "expect OSX to come out to be quite so good actually you know in terms of not",
    "start": "2021840",
    "end": "2027519"
  },
  {
    "text": "starting up with a running web server you know it it doesn't the web server is off by default okay we can see that if",
    "start": "2027519",
    "end": "2034200"
  },
  {
    "text": "we look for a is it web right if we look for web",
    "start": "2034200",
    "end": "2041080"
  },
  {
    "text": "server and it's right yeah it was on the it was on the first screen I just wanted to highlight it okay so web server set",
    "start": "2041080",
    "end": "2047519"
  },
  {
    "text": "to know by default there's a bunch of programs in here we'll we'll take a look at this",
    "start": "2047519",
    "end": "2052520"
  },
  {
    "text": "file because we'll be shutting things down okay now etcc is going to source that file okay and then what it's going",
    "start": "2052520",
    "end": "2059480"
  },
  {
    "text": "to run as the last thing that runs in etcc it runs system starter okay system",
    "start": "2059480",
    "end": "2064800"
  },
  {
    "text": "starter is kind of Apple's answer to you know to um both the BSD and cis5 boot",
    "start": "2064800",
    "end": "2070878"
  },
  {
    "text": "systems we're kind of used to okay so system starter what it does is it runs",
    "start": "2070879",
    "end": "2076358"
  },
  {
    "text": "through feels kind of cis5 here okay it felt kind of BSD over there you know that that these things turn on and off",
    "start": "2076359",
    "end": "2082480"
  },
  {
    "text": "based on that um on the other hand it's kind of cis5 what you've got is you've got these directories all of Apple's",
    "start": "2082480",
    "end": "2089158"
  },
  {
    "text": "stuff is in SL system SL Library startup items startup items is a really special",
    "start": "2089159",
    "end": "2095040"
  },
  {
    "text": "directory and there'll be a bunch of subdirectories we'll see called Fu and those subdirectories will have scripts",
    "start": "2095040",
    "end": "2100359"
  },
  {
    "text": "in them also called Fu whatever they're whatever the director is called the subdirector going be called and what",
    "start": "2100359",
    "end": "2106000"
  },
  {
    "text": "system stter does it looks in all of those directories at all the different at all those different directories looks",
    "start": "2106000",
    "end": "2111760"
  },
  {
    "text": "for their script looks in all the fo looks for all the looks for all the scripts called Foo so it looks in",
    "start": "2111760",
    "end": "2117280"
  },
  {
    "text": "directory Foo finds a script called Foo looks in directory bar finds a script called bar and so on and so on and it",
    "start": "2117280",
    "end": "2123520"
  },
  {
    "text": "looks at all those and it's going to run them all okay it's going to run them all with start with a you know it's going to run you know Foo start and what's weird",
    "start": "2123520",
    "end": "2131560"
  },
  {
    "text": "is the order in which it runs them is actually Dynamic okay the order at which",
    "start": "2131560",
    "end": "2137240"
  },
  {
    "text": "it runs them is actually Dynamic let me show you what you've got is we look at",
    "start": "2137240",
    "end": "2144200"
  },
  {
    "text": "system Library startup items oh I also mentioned another directory SL Library",
    "start": "2144200",
    "end": "2150960"
  },
  {
    "text": "startup items that's where you're supposed to put the scripts that you want to have started okay so if we look",
    "start": "2150960",
    "end": "2156119"
  },
  {
    "text": "at SL at system Library startup items here let's put that near the top",
    "start": "2156119",
    "end": "2162960"
  },
  {
    "text": "of the screen okay if you look there you have a bunch of you have a bunch of scripts and we see the one called let's",
    "start": "2162960",
    "end": "2168680"
  },
  {
    "text": "let's look at Apache it's a bunch of directories okay so if we look at Apache",
    "start": "2168680",
    "end": "2175640"
  },
  {
    "text": "that's a directory and we can look at inside that directory and there are",
    "start": "2175640",
    "end": "2181079"
  },
  {
    "text": "three files okay the three files are a script also called Apache that's the start script it's also the stop script",
    "start": "2181079",
    "end": "2188119"
  },
  {
    "text": "script resources that's a directory it's got a bunch of internationalization information and all that we're not",
    "start": "2188119",
    "end": "2193960"
  },
  {
    "text": "interested in that right now and then startup parameters and what startup parameters",
    "start": "2193960",
    "end": "2199400"
  },
  {
    "text": "it has in it oh I should be in the Apache director to show you that let's look at",
    "start": "2199400",
    "end": "2206800"
  },
  {
    "text": "that startup parameters. pist okay property list so we've",
    "start": "2206800",
    "end": "2212200"
  },
  {
    "text": "got can you all see that or should I you want me to put it at the top top top it",
    "start": "2212200",
    "end": "2220160"
  },
  {
    "text": "is okay so we have a description it says Apache web server we've got provides web",
    "start": "2223040",
    "end": "2228440"
  },
  {
    "text": "server that provides us that anything that depends on it knows that this provides that provides web server",
    "start": "2228440",
    "end": "2233480"
  },
  {
    "text": "requires directory services to already be in place okay uses diss NFS Network",
    "start": "2233480",
    "end": "2239720"
  },
  {
    "text": "time but doesn't require them it's just kind of you know if you're already what these are telling and then it says order",
    "start": "2239720",
    "end": "2245920"
  },
  {
    "text": "preference none okay what these are telling um what these are telling system",
    "start": "2245920",
    "end": "2251000"
  },
  {
    "text": "starter is you need to make sure you need to make sure that you run me before",
    "start": "2251000",
    "end": "2256720"
  },
  {
    "text": "anything that requires web server you need to run me after directory services and if you happen to know that",
    "start": "2256720",
    "end": "2264160"
  },
  {
    "text": "you're going to be running discs NFS or network time um you might run me after them okay and then that order preference",
    "start": "2264160",
    "end": "2271680"
  },
  {
    "text": "order preference can be first it can be last it can be none it can be early it",
    "start": "2271680",
    "end": "2278040"
  },
  {
    "text": "can be late and what you're saying what what it's saying is I need to be the first thing run on the system system starter will just take this as a",
    "start": "2278040",
    "end": "2283640"
  },
  {
    "text": "recommendation something says I need to be the last thing that runs on the system or so on so system starts kind of",
    "start": "2283640",
    "end": "2288760"
  },
  {
    "text": "dynamically choosing the order in which it runs things that's a a weird little",
    "start": "2288760",
    "end": "2294720"
  },
  {
    "text": "you know it's a it's a weird little thing but but okay it's",
    "start": "2294720",
    "end": "2300400"
  },
  {
    "text": "yes so the question is at what point do I see that what at what point in my in the",
    "start": "2306440",
    "end": "2312119"
  },
  {
    "text": "Apple boot is system starter actually kicking off is that the is that you know we saw there was an apple and",
    "start": "2312119",
    "end": "2318760"
  },
  {
    "text": "this and then we saw you know then we got a new logo and it says starting this you know starting this starting this Etc",
    "start": "2318760",
    "end": "2326520"
  },
  {
    "text": "um it would be at that point the point where you're seeing the startings or before I don't know whether it's before",
    "start": "2326520",
    "end": "2333000"
  },
  {
    "text": "I don't know whether the logo is something that system starter actually starts I suspect that it is okay",
    "start": "2333000",
    "end": "2340000"
  },
  {
    "text": "um okay so we just took a look at we took a look at our script systems system",
    "start": "2340000",
    "end": "2346000"
  },
  {
    "text": "Library startup items Apache Apache was our script and we've got meta information inside Apache startup",
    "start": "2346000",
    "end": "2352920"
  },
  {
    "text": "parameters. pist okay um so our script",
    "start": "2352920",
    "end": "2359160"
  },
  {
    "text": "you can think of Fu as Apache Apache Pache takes the argument start stop and restart okay and this is actually how",
    "start": "2359160",
    "end": "2365800"
  },
  {
    "text": "we're supposed to start stop these things okay so you can you can also use",
    "start": "2365800",
    "end": "2371040"
  },
  {
    "text": "system starter itself on the command line to start and stop these you can run system starter stop start or restart and",
    "start": "2371040",
    "end": "2377200"
  },
  {
    "text": "then the name of that directory okay you can give it you know you can give it Apache you don't have to give it web",
    "start": "2377200",
    "end": "2382400"
  },
  {
    "text": "server you give it Apache okay we talked about the ordering",
    "start": "2382400",
    "end": "2387760"
  },
  {
    "text": "in terms of order preference okay um now those yes in the",
    "start": "2387760",
    "end": "2396319"
  },
  {
    "text": "front",
    "start": "2396319",
    "end": "2399319"
  },
  {
    "text": "is there a a system starter the system starter have a preference for um for the",
    "start": "2404440",
    "end": "2410359"
  },
  {
    "text": "a if I have say two Apache scripts does it does it care about the one that came with the system in system libraries",
    "start": "2410359",
    "end": "2417160"
  },
  {
    "text": "versus the one that apple versus the one that I've added in library startup items",
    "start": "2417160",
    "end": "2423079"
  },
  {
    "text": "um I don't know I suspect not nothing that I was able to find in apples documentation of system starter de",
    "start": "2423079",
    "end": "2429440"
  },
  {
    "text": "demonstrated that I would suspect that if it has one Behavior now it might have a completely different Behavior later on",
    "start": "2429440",
    "end": "2436400"
  },
  {
    "text": "OSX is still kind of changing shape right now so I wouldn't depend on that behavior because Apple hasn't documented",
    "start": "2436400",
    "end": "2442680"
  },
  {
    "text": "which they're going to do and their operating system is definitely still in flux okay so we know that we know that",
    "start": "2442680",
    "end": "2452079"
  },
  {
    "text": "atcc start system starter system starter runs these scripts okay each of the system started scripts is also is also",
    "start": "2452079",
    "end": "2460280"
  },
  {
    "text": "sourcing Etsy host config and so Etsy host config becomes the way that we turn",
    "start": "2460280",
    "end": "2465319"
  },
  {
    "text": "off most of these items okay so if we take a look at any of",
    "start": "2465319",
    "end": "2471400"
  },
  {
    "text": "them if we take a look this is this is one I wanted to see I keep expecting everything to be in",
    "start": "2471400",
    "end": "2477079"
  },
  {
    "text": "Etsy system Library startup items NFS and Fs and we look at that if we",
    "start": "2477079",
    "end": "2485079"
  },
  {
    "text": "look at this script we see the we see kind of like you expect there's a start service there start service we'll have a",
    "start": "2485079",
    "end": "2491839"
  },
  {
    "text": "stop service okay um the script starts out by sourcing rc.com which will do a",
    "start": "2491839",
    "end": "2498359"
  },
  {
    "text": "few things and then sort Source host config which is the reason they're all sourcing rc.com is so they get host",
    "start": "2498359",
    "end": "2503440"
  },
  {
    "text": "config in there okay and then what's it do it goes and makes sure the network is",
    "start": "2503440",
    "end": "2508960"
  },
  {
    "text": "up that's kind of what you'd expect out of out of an NFS script it prints a message to console and then the first",
    "start": "2508960",
    "end": "2514400"
  },
  {
    "text": "thing it does is it runs NFS IOD NFS IOD we'll talk about NFS IOD is a um",
    "start": "2514400",
    "end": "2522240"
  },
  {
    "text": "is an NFS client demon on OSX for doing asynchronous NFS requests it started",
    "start": "2522240",
    "end": "2528119"
  },
  {
    "text": "whether we liked it or not whether we want an NFS started or not okay so as we look down this",
    "start": "2528119",
    "end": "2534720"
  },
  {
    "text": "file what else happens it's going and reading exports okay it's going and",
    "start": "2534720",
    "end": "2539960"
  },
  {
    "text": "reading exports and seeing if this actually is an NFS server that's kind of smart and if it is an NFS server it",
    "start": "2539960",
    "end": "2545559"
  },
  {
    "text": "actually starts up NFS demons NFS an NFS server demon and then finally",
    "start": "2545559",
    "end": "2551079"
  },
  {
    "text": "the first time it actually asks us for something it's asking us if autom Mount",
    "start": "2551079",
    "end": "2556480"
  },
  {
    "text": "is on this is that automount variable is is what was set in in in Etsy host config so if Etsy host config has",
    "start": "2556480",
    "end": "2563079"
  },
  {
    "text": "automount set to yes then it'll run the automount demon it's NFS automount demon",
    "start": "2563079",
    "end": "2568359"
  },
  {
    "text": "okay that you know mounts NFS volumes dynamically and unmounts them when they've been",
    "start": "2568359",
    "end": "2574440"
  },
  {
    "text": "idle okay so the nice thing about the script is it's only starting up nfsd it's only",
    "start": "2576119",
    "end": "2582760"
  },
  {
    "text": "starting up nfsd and mountd if you actually got shares you're exporting if",
    "start": "2582760",
    "end": "2587800"
  },
  {
    "text": "you're actually exporting okay and the way it's doing that is it's checking both Etsy exports and then it's also",
    "start": "2587800",
    "end": "2593599"
  },
  {
    "text": "checking net info okay net info to my knowledge is this little is this little next thing net info smells to me kind of",
    "start": "2593599",
    "end": "2601680"
  },
  {
    "text": "like NIS okay who's famili who's familiar with NIS okay anybody unfamiliar with",
    "start": "2601680",
    "end": "2609119"
  },
  {
    "text": "NIS okay well so net info kind of smells like NIS and what it is is that on these",
    "start": "2609119",
    "end": "2616200"
  },
  {
    "text": "systems when you go and change users you don't actually change you know you're not well when you're going and",
    "start": "2616200",
    "end": "2622359"
  },
  {
    "text": "administering the system you administer the system very much the way Apple wants us to do it is to do it through net info",
    "start": "2622359",
    "end": "2628960"
  },
  {
    "text": "through different net info commands so there's ni dump is one of them ni dump",
    "start": "2628960",
    "end": "2634200"
  },
  {
    "text": "goes and queries the net info database for all the users we can Run net info password it would give us a list of all",
    "start": "2634200",
    "end": "2639839"
  },
  {
    "text": "the users um it would give us our normal p in in normal password file format complete with passwords so um so much",
    "start": "2639839",
    "end": "2647400"
  },
  {
    "text": "for shadowing um you can run net you can run ni dump exports and that'll give you",
    "start": "2647400",
    "end": "2653559"
  },
  {
    "text": "a list of exported file systems now if you want to change that you change these things with all also with net info",
    "start": "2653559",
    "end": "2660119"
  },
  {
    "text": "commands Okay this is kind of strange um okay this is kind of strange but um",
    "start": "2660119",
    "end": "2667960"
  },
  {
    "text": "so you kind of have to if you want to make sure the machine doesn't actually have nfx NFS exports you've actually",
    "start": "2667960",
    "end": "2673000"
  },
  {
    "text": "kind of got to check both the ET the ETC file you were looking at and net info in the early editions of",
    "start": "2673000",
    "end": "2679359"
  },
  {
    "text": "OSX okay um it was everything was controlled through net info and the Etsy files were just kind of placeholders in",
    "start": "2679359",
    "end": "2685839"
  },
  {
    "text": "new versions of NFS net info is going and populating the information as you adjust it with net info it will go and",
    "start": "2685839",
    "end": "2691960"
  },
  {
    "text": "populated into Etsy files and if you change an Etsy file it'll get sucked up by net info this is in recent releases",
    "start": "2691960",
    "end": "2699000"
  },
  {
    "text": "okay um the same you know this is it's a strange thing anyway if you want to turn off NFS we know that all you got to do",
    "start": "2699000",
    "end": "2705960"
  },
  {
    "text": "to turn off NFS Ser the NFS server is actually to go and you know to go and",
    "start": "2705960",
    "end": "2711079"
  },
  {
    "text": "and and make sure you don't have exports on the system okay the other thing is",
    "start": "2711079",
    "end": "2716440"
  },
  {
    "text": "though that we started up as we as I pointed out it starts up the NFS IOD an NFS client demon whether you like it or",
    "start": "2716440",
    "end": "2723040"
  },
  {
    "text": "not and the tough thing is if you end up having a vulnerability of that demon later on you're going really kind of wish that it wasn't running by default",
    "start": "2723040",
    "end": "2729400"
  },
  {
    "text": "especially if you weren't using your system as an NFS client the only thing you can do the only thing you can do for",
    "start": "2729400",
    "end": "2735280"
  },
  {
    "text": "that is actually to edit the edit the NFS script okay to really go through and",
    "start": "2735280",
    "end": "2741319"
  },
  {
    "text": "do a complete audit what you basically should do is go and stop and read all the scripts that are on the system and",
    "start": "2741319",
    "end": "2747880"
  },
  {
    "text": "you know take a look and say okay what's that starting what's that starting what's that starting and read through all the scripts and understand what they",
    "start": "2747880",
    "end": "2753880"
  },
  {
    "text": "do okay for the time challenged we can kind of go in reverse and what we do is",
    "start": "2753880",
    "end": "2759319"
  },
  {
    "text": "we can go and take look at the system look at the programs that are running on the system and go and find out how they started and deactivate them and that's",
    "start": "2759319",
    "end": "2766440"
  },
  {
    "text": "you know what I do from an audit perspective I just try to figure out okay so the first thing that you want to",
    "start": "2766440",
    "end": "2773599"
  },
  {
    "text": "do before just to make that easier is to go through host",
    "start": "2773599",
    "end": "2779040"
  },
  {
    "text": "config that was that file we were looking at earlier and actually go and just shut off anything you know you",
    "start": "2779040",
    "end": "2785800"
  },
  {
    "text": "don't want ahead of time okay so you can go through here and look at what says no or yes on it so if we",
    "start": "2785800",
    "end": "2792520"
  },
  {
    "text": "look at this the very first thing that says yes on it is autom Mount okay so we",
    "start": "2792520",
    "end": "2798319"
  },
  {
    "text": "can turn off autom Mount um this is especially important if we know we're not going to be an NFS client because what autom mount's doing on this system",
    "start": "2798319",
    "end": "2805000"
  },
  {
    "text": "is just going and mounting NFS NFS volumes that we may be you know that we",
    "start": "2805000",
    "end": "2810119"
  },
  {
    "text": "may have use of you know if we go and try to the way automount works is if you go if you're autom mounting if you if",
    "start": "2810119",
    "end": "2816480"
  },
  {
    "text": "you get your home directories by NFS then when a user first comes on and they need their home directory mounted they",
    "start": "2816480",
    "end": "2822559"
  },
  {
    "text": "type Mount you know that they they try to access their home directory they're not typing Mount I'm sorry they try to access their home directory and autom",
    "start": "2822559",
    "end": "2828319"
  },
  {
    "text": "mount will go and mount it for them and then that so there's a fewc delay and then it tries to you know and then they",
    "start": "2828319",
    "end": "2834240"
  },
  {
    "text": "do whatever they're going to do if they log out if they stop you know if they log out if they stop accessing whatever",
    "start": "2834240",
    "end": "2840359"
  },
  {
    "text": "director was being autom mounted then the autom mounter will put it away um",
    "start": "2840359",
    "end": "2845880"
  },
  {
    "text": "I'm sorry uh um so um we can also so you can change Auto mounts on we can turn",
    "start": "2845880",
    "end": "2852920"
  },
  {
    "text": "that to off just as a matter of editing the file okay in terms of once you've",
    "start": "2852920",
    "end": "2859359"
  },
  {
    "text": "changed something from off to on I mean from from on to",
    "start": "2859359",
    "end": "2865078"
  },
  {
    "text": "off you can either do one of two things you can just reboot or you can track down what script was actually what",
    "start": "2865640",
    "end": "2871400"
  },
  {
    "text": "script was actually running that and you can restart the script and so if we're going to do that",
    "start": "2871400",
    "end": "2877920"
  },
  {
    "text": "what we'd run would be here I'll clear this so that it's at the top of the screen",
    "start": "2877920",
    "end": "2885359"
  },
  {
    "text": "okay okay we knew that it was in the system Library startup items okay and",
    "start": "2885440",
    "end": "2891160"
  },
  {
    "text": "I'll run NFS",
    "start": "2891160",
    "end": "2897319"
  },
  {
    "text": "NFS",
    "start": "2897319",
    "end": "2900319"
  },
  {
    "text": "restart and I should find that that autom mount demon is now missing okay it",
    "start": "2905760",
    "end": "2911480"
  },
  {
    "text": "was there before I guess we didn't really check for it what else is what else what else might we do okay you saw",
    "start": "2911480",
    "end": "2916880"
  },
  {
    "text": "in the host config file that I've got up on the slide we've got cups on okay so let's see if we can find our cups",
    "start": "2916880",
    "end": "2925400"
  },
  {
    "text": "D okay so the question was is that required for printing is cups required for printing to a USB printer on the",
    "start": "2930920",
    "end": "2937079"
  },
  {
    "text": "machine okay right I I'm getting ahead of myself I'm going and turning something off just automatically so as",
    "start": "2937079",
    "end": "2942839"
  },
  {
    "text": "we're looking through this file we kind of want to take a look at what the variables are referencing and decide whether we need those things or not okay",
    "start": "2942839",
    "end": "2949119"
  },
  {
    "text": "so autom Mount was the autom mounter we kind of made I made a quick decision on this knowing that my laptop doesn't",
    "start": "2949119",
    "end": "2954400"
  },
  {
    "text": "Mount NFS volumes and I want it off okay um I also look at cups and I say cups is",
    "start": "2954400",
    "end": "2960200"
  },
  {
    "text": "the printing demon that's on OSX by default I've also had it on mandre systems I think I've had it on redhead",
    "start": "2960200",
    "end": "2966240"
  },
  {
    "text": "systems um and so I want to turn off if I want to you know if I've got a USB printer",
    "start": "2966240",
    "end": "2971880"
  },
  {
    "text": "attached I'll need to keep cuups right if I need a print demon on this system for any reason I'll need to keep cups",
    "start": "2971880",
    "end": "2978640"
  },
  {
    "text": "okay if I don't and again this is this laptop is nicely my my little traveling",
    "start": "2978640",
    "end": "2983880"
  },
  {
    "text": "laptop so it's very easy for me to just turn things off I'll go and change cups to no and I'll go and look at the start",
    "start": "2983880",
    "end": "2992720"
  },
  {
    "text": "script that started it and the start script for cups is printing",
    "start": "2993799",
    "end": "2999000"
  },
  {
    "text": "services and I'll run printing services printing services",
    "start": "2999000",
    "end": "3004400"
  },
  {
    "text": "stop and find that it wasn't there if I were to run start let's just make sure",
    "start": "3007559",
    "end": "3013359"
  },
  {
    "text": "that we turn something off we saw in our previous process list there was user Espin cups Cups D and we can stop it",
    "start": "3013359",
    "end": "3023240"
  },
  {
    "text": "again like this if we want to make sure um so if we change host config we should",
    "start": "3023240",
    "end": "3030559"
  },
  {
    "text": "just be able to stop the script and then restart it and see that nothing happens see that we don't actually end up with cbsd okay",
    "start": "3030559",
    "end": "3038520"
  },
  {
    "text": "um what else did I have another okay the only other thing that's",
    "start": "3038520",
    "end": "3045359"
  },
  {
    "text": "that's yes or no here is net info server automatic okay we've got a slide on that",
    "start": "3045359",
    "end": "3052520"
  },
  {
    "text": "just take a look at the rest RP RPC server that's Port map or RPC bind",
    "start": "3052520",
    "end": "3057799"
  },
  {
    "text": "that's automatic time sync set to yes okay so we turned off autom Mount and just",
    "start": "3057799",
    "end": "3065960"
  },
  {
    "text": "now I'm sorry I've been getting ahead of my slid slightly okay um just now we",
    "start": "3065960",
    "end": "3072400"
  },
  {
    "text": "looked at cups we looked at the printing services script we decided if we wanted to turn that off or not we could change",
    "start": "3072400",
    "end": "3078000"
  },
  {
    "text": "it at Host config and make sure that it doesn't run okay um the next variable",
    "start": "3078000",
    "end": "3084359"
  },
  {
    "text": "that we had was net info server let me bring up that host config on this",
    "start": "3084359",
    "end": "3090520"
  },
  {
    "text": "machine bring it to the top okay you see net info server set to",
    "start": "3097920",
    "end": "3104839"
  },
  {
    "text": "automatic okay and what net info server is there for is that's our net info okay",
    "start": "3104839",
    "end": "3110200"
  },
  {
    "text": "it's either when it's set to automatic the deal is that it can either go and try to query net info servers on the network or it can in query the one",
    "start": "3110200",
    "end": "3117160"
  },
  {
    "text": "that's on the box if you turn the one that's on the Box off you can't log in anymore okay so you don't want to set",
    "start": "3117160",
    "end": "3124280"
  },
  {
    "text": "this to know you can just leave it as automatic or you could set it to whatever gives gives you local okay what",
    "start": "3124280",
    "end": "3129960"
  },
  {
    "text": "net info server is doing if we read the script is that net info server is running ni bind and it's running net",
    "start": "3129960",
    "end": "3136559"
  },
  {
    "text": "info D and what ni bind D does is it actually goes and starts net info DS as",
    "start": "3136559",
    "end": "3141799"
  },
  {
    "text": "needed okay it goes and you'll see multiple ones of them on the system so we want to leave it to automatic",
    "start": "3141799",
    "end": "3149880"
  },
  {
    "text": "um we want to leave it set to automatic to make sure that we get we want to leave it to automatic to make sure that",
    "start": "3151960",
    "end": "3158160"
  },
  {
    "text": "we get net info information because we don't have it we can't log in and and that's really kind of you know makes our",
    "start": "3158160",
    "end": "3164319"
  },
  {
    "text": "system a little less useful okay what were the other variables that we had set to yes or no or automatic we had time",
    "start": "3164319",
    "end": "3173079"
  },
  {
    "text": "sync this here seems to be set to no on my on my original default install I rebuilt the system um so that I rebuilt",
    "start": "3173079",
    "end": "3180720"
  },
  {
    "text": "the system last night so that we'd have a default install my original default install time sync was on and what time",
    "start": "3180720",
    "end": "3186599"
  },
  {
    "text": "sync does is controls whether the system is synced with ntpd okay it's a useful thing to keep",
    "start": "3186599",
    "end": "3193839"
  },
  {
    "text": "around um this is one of those things um this is one of those things that lots of us have tons of use for you'd like your",
    "start": "3193839",
    "end": "3200319"
  },
  {
    "text": "system one example is if your system gets hacked um or if it gets attacked",
    "start": "3200319",
    "end": "3205359"
  },
  {
    "text": "even but if it's getting hacked what you really like to have is this nice little audit trail of times you'd like to know",
    "start": "3205359",
    "end": "3211000"
  },
  {
    "text": "that at this given time you to packet go through the firewall but get flaggs as something that got logged at at the same",
    "start": "3211000",
    "end": "3216440"
  },
  {
    "text": "time you know just you know so many so many so many fractions of a second later you had the packet go get seen by your",
    "start": "3216440",
    "end": "3223119"
  },
  {
    "text": "IDs and then hit the box where it caused an event and if you've got that audit Trail it's a whole lot it's a whole lot",
    "start": "3223119",
    "end": "3229079"
  },
  {
    "text": "easier to track what's to track what's going on and convince someone else that you know you've been hacked by this",
    "start": "3229079",
    "end": "3235319"
  },
  {
    "text": "coming from there Etc okay so time sync is one of those things that you might",
    "start": "3235319",
    "end": "3240680"
  },
  {
    "text": "turn off and I would I would you know I would choose to when I'm at uh when I'm",
    "start": "3240680",
    "end": "3245960"
  },
  {
    "text": "at uh Defcon because that way I don't have to worry about whether somebody in the local on the local network has an",
    "start": "3245960",
    "end": "3251880"
  },
  {
    "text": "exploit against ntpd might turn it back on when I when I leave Defcon or I might leave it",
    "start": "3251880",
    "end": "3257599"
  },
  {
    "text": "off okay once you've gone through and turn",
    "start": "3257599",
    "end": "3262720"
  },
  {
    "text": "those things off we can do that",
    "start": "3262720",
    "end": "3268359"
  },
  {
    "text": "okay we turned off",
    "start": "3270559",
    "end": "3274319"
  },
  {
    "text": "cups we ran printing services stop and printing services start",
    "start": "3279760",
    "end": "3286119"
  },
  {
    "text": "um and time sync is already off so I won't have that demon IP onose oh am I",
    "start": "3286119",
    "end": "3294000"
  },
  {
    "text": "leaving IPv6 on on purpose that's a good question okay if I'm not",
    "start": "3294000",
    "end": "3300680"
  },
  {
    "text": "using IPv6 and I sure as heck don't expect to be anytime soon um we should",
    "start": "3300680",
    "end": "3305920"
  },
  {
    "text": "be turning that off as well okay",
    "start": "3305920",
    "end": "3312280"
  },
  {
    "text": "um so at that point what are we going to do at the point where we've gone through",
    "start": "3314079",
    "end": "3319280"
  },
  {
    "text": "host config and we've run the stop scripts or we've rebooted what we'll do at that point is we're going to run PS",
    "start": "3319280",
    "end": "3325440"
  },
  {
    "text": "and get a list of the remaining processes on the system and to make this list more readable um I might run PS and",
    "start": "3325440",
    "end": "3334680"
  },
  {
    "text": "grip for grip for um and grip J out so that I'm left only with the processes",
    "start": "3334680",
    "end": "3340480"
  },
  {
    "text": "that are running left only with the processes that aren't really me okay and I can",
    "start": "3340480",
    "end": "3347119"
  },
  {
    "text": "look at these okay and I see a bunch",
    "start": "3347119",
    "end": "3352400"
  },
  {
    "text": "um I I I see a bunch in here one of the interesting things to me let me see if this is on this page or the next right",
    "start": "3352400",
    "end": "3359599"
  },
  {
    "text": "on this page is this process 303 inet D middle of the",
    "start": "3359599",
    "end": "3364640"
  },
  {
    "text": "page inetd is running on this system why is inet D running on this system okay",
    "start": "3364640",
    "end": "3370079"
  },
  {
    "text": "what so so you know one of the first things I'll do is I'll say okay well inetd is running I better go and turn whatever is running off so I look at",
    "start": "3370079",
    "end": "3377480"
  },
  {
    "text": "Apple's at Apple's inet d.com and it turns out that every single line in inet",
    "start": "3377480",
    "end": "3385599"
  },
  {
    "text": "deduct comp is commented out okay they're all commented out so in is not actually running anything it's",
    "start": "3385599",
    "end": "3391880"
  },
  {
    "text": "just running on the system listening to No ports just kind of taking up runtime okay so if I look for where inetd is",
    "start": "3391880",
    "end": "3399200"
  },
  {
    "text": "running out of by the way you may say Jay you said you're not reading through all the scripts how you finding out where inetd is running out of I'm just",
    "start": "3399200",
    "end": "3405520"
  },
  {
    "text": "kind of grapping inet D star star and I get a list and I get the and",
    "start": "3405520",
    "end": "3411599"
  },
  {
    "text": "I get that the directory this is running out of the the script this is running out of is the IP Services I Services",
    "start": "3411599",
    "end": "3419200"
  },
  {
    "text": "file so if I look at that if I look at that file IP Services IP Services what do I",
    "start": "3419200",
    "end": "3426680"
  },
  {
    "text": "see um I see right here that the system runs",
    "start": "3426680",
    "end": "3431720"
  },
  {
    "text": "inet d and inet d and x inet d okay so there's inet D I've got this on the",
    "start": "3431720",
    "end": "3437440"
  },
  {
    "text": "slide as well okay so it's actually running both and you can run both",
    "start": "3437440",
    "end": "3444119"
  },
  {
    "text": "together you can run in D and x d on the same system and I remember when I first read that a few years ago and thought that's really strange as long as they're",
    "start": "3444119",
    "end": "3450319"
  },
  {
    "text": "not binding to the same ports you can do that you could have inet D listening to the telet port X ond listening to the",
    "start": "3450319",
    "end": "3456480"
  },
  {
    "text": "FTP port and as long as they don't have any crossover in ports it's fine Apple ships both of them on the system they",
    "start": "3456480",
    "end": "3462240"
  },
  {
    "text": "used to use inetd they moveed to X inetd okay um the weird thing is that while X inetd exits gracefully um when it",
    "start": "3462240",
    "end": "3469520"
  },
  {
    "text": "doesn't have any ports to listen to in just kind of sticks around okay so if we want to we could modify this script okay",
    "start": "3469520",
    "end": "3477760"
  },
  {
    "text": "if we want to we can modify this script so that inet D doesn't actually run if there's",
    "start": "3477760",
    "end": "3486039"
  },
  {
    "text": "nothing for it to do okay and I've just got a little egrep",
    "start": "3486039",
    "end": "3491520"
  },
  {
    "text": "command that's useful for",
    "start": "3491520",
    "end": "3495880"
  },
  {
    "text": "that what that does is graps the inet file for any lines that aren't commented this is kind of you know simple enough",
    "start": "3504079",
    "end": "3510680"
  },
  {
    "text": "it doesn't do a whole lot and if there's any lines that are not commented",
    "start": "3510680",
    "end": "3517318"
  },
  {
    "text": "out then we run inet",
    "start": "3517599",
    "end": "3522680"
  },
  {
    "text": "D and that's assuming that I don't have any blank lines so if I want to I can make that EGP a little bit more",
    "start": "3525200",
    "end": "3531440"
  },
  {
    "text": "comprehensive um I could even do some things I could even do some things with SAR rock and try to really chop up and",
    "start": "3531440",
    "end": "3537200"
  },
  {
    "text": "make sure that I've actually got something with enough columns too okay but let me just give you something simple okay you also might just comment",
    "start": "3537200",
    "end": "3544160"
  },
  {
    "text": "out in inetd out of this file I mean that's really what I would do you know for my own for my own machines just",
    "start": "3544160",
    "end": "3549799"
  },
  {
    "text": "comment it out and if somebody goes and changes inet d.com and expects it to to to figure out what to do well they",
    "start": "3549799",
    "end": "3556359"
  },
  {
    "text": "should know to go and find inetd and start it themselves and find the script that it runs out of okay I can do that",
    "start": "3556359",
    "end": "3563000"
  },
  {
    "text": "by the way um inet d andx D the way you audit inet d.com is you just go and look",
    "start": "3563000",
    "end": "3568640"
  },
  {
    "text": "for any lines that aren't commented out in xinetd you just look for any what You' got with xet d is it's a it's a",
    "start": "3568640",
    "end": "3574799"
  },
  {
    "text": "directory ET CX inet D.D and each service that would normally be listed in",
    "start": "3574799",
    "end": "3580640"
  },
  {
    "text": "netd.com find its own line in X gets its own file so you look in the file and you see if everyone has first line up there",
    "start": "3580640",
    "end": "3588319"
  },
  {
    "text": "disable equals yes if it doesn't have disable equals yes then it's going to then that port's going to be open okay",
    "start": "3588319",
    "end": "3595039"
  },
  {
    "text": "if it does have if it has disable equals no or it doesn't have a disable line at all that's a port that's not going to be",
    "start": "3595039",
    "end": "3600599"
  },
  {
    "text": "open okay it turns out that if we look at this box which keeps trying to save",
    "start": "3600599",
    "end": "3606520"
  },
  {
    "text": "us some battery power um if we look at the system we're going to find that it's",
    "start": "3606520",
    "end": "3611640"
  },
  {
    "text": "we're going to find that everything in X in at D and in at D is disabled already that's really coming a long way okay um",
    "start": "3611640",
    "end": "3619920"
  },
  {
    "text": "um the fact that they're this early in their this early in their operating systems development they're kind of doing things quite so right where the",
    "start": "3619920",
    "end": "3626039"
  },
  {
    "text": "box starts up with nothing in in nothing in XD it took Red Hat how many years to figure that out um so you know the fact",
    "start": "3626039",
    "end": "3633960"
  },
  {
    "text": "that they're getting this right and red hat still has one thing listen it listens on Local Host but they run SGI F by default this little thing that",
    "start": "3633960",
    "end": "3640400"
  },
  {
    "text": "listens on the local network and watches for file changes and reports them to whatever wants to hear about them okay",
    "start": "3640400",
    "end": "3646559"
  },
  {
    "text": "so this is this is kind of cool they've done a good job here",
    "start": "3646559",
    "end": "3653200"
  },
  {
    "text": "okay how often does does uh Apple up their",
    "start": "3653200",
    "end": "3658359"
  },
  {
    "text": "scripts they've got an auto update process I don't know if their auto update if their patches are going to",
    "start": "3660520",
    "end": "3665960"
  },
  {
    "text": "stomp on our changes what you'd really do if you wanted to make these changes over and over is what you do probably on any system I mean what I think you do on",
    "start": "3665960",
    "end": "3672599"
  },
  {
    "text": "any system which is either find the vendor supported way to do it and as I've shown you there are some things that aren't vendor supported yet and the",
    "start": "3672599",
    "end": "3679720"
  },
  {
    "text": "other one would be to automate the process you can either use somebody else's automation you can write your own",
    "start": "3679720",
    "end": "3684799"
  },
  {
    "text": "yes in the back",
    "start": "3684799",
    "end": "3687920"
  },
  {
    "text": "yeah so in ATD is now out they probably I don't know so Apple's definitely I",
    "start": "3691839",
    "end": "3698760"
  },
  {
    "text": "mean they're they're I told you when we started Apple's operating system is in flux that's good it means they're",
    "start": "3698760",
    "end": "3703799"
  },
  {
    "text": "improving things still so so I'm not busting on Apple here I know I may sound like it I just bust on every vendor",
    "start": "3703799",
    "end": "3710319"
  },
  {
    "text": "because I'm a lock down person and the systems don't come massively locked down out of the box I get to bust I mean it's",
    "start": "3710319",
    "end": "3716279"
  },
  {
    "text": "that's that's basically what I do that's fine okay um what programs do you have left if we do that PS listing and you",
    "start": "3716279",
    "end": "3722599"
  },
  {
    "text": "look at the root programs on the box you've got something called core services that has to be left in place you've got autois Mount okay what does",
    "start": "3722599",
    "end": "3730319"
  },
  {
    "text": "autois Mount do well if you take your laptop and you plug in a FireWire drive or if you take your laptop and you put a",
    "start": "3730319",
    "end": "3736680"
  },
  {
    "text": "CD ROM in the a CD ROM or a DVD in the drive or whatever um you can either Mount those in one of two ways you can",
    "start": "3736680",
    "end": "3742799"
  },
  {
    "text": "go and type your own Mount command the way you know I'm kind of used to um on the Linux world or you can use autois",
    "start": "3742799",
    "end": "3750200"
  },
  {
    "text": "Mount which is running by default and autois mount will go and mount whatever devices you connect to it automatically",
    "start": "3750200",
    "end": "3755240"
  },
  {
    "text": "and say here you go um in my opinion um whether or not you use this depends on",
    "start": "3755240",
    "end": "3761200"
  },
  {
    "text": "how the systems used if this is you know if this is a system that's sitting in a data center I understand my laptop's not",
    "start": "3761200",
    "end": "3767520"
  },
  {
    "text": "sitting in a data center but they do have OSX servers um if this is a system that's sitting at a Data Center and",
    "start": "3767520",
    "end": "3772839"
  },
  {
    "text": "nobody besides the CIS admins you know the admin should be able ble to mount drives then we turn this off okay if",
    "start": "3772839",
    "end": "3780279"
  },
  {
    "text": "we're at Defcon we might turn it off you know if you're if you're if you're security paranoid um you might turn off",
    "start": "3780279",
    "end": "3786920"
  },
  {
    "text": "dis Mount Auto dis Mount and go and mount all the devices yourself as you plug them in um that that's what I'll be",
    "start": "3786920",
    "end": "3792440"
  },
  {
    "text": "doing um whether you whether you choose to or not kind of depends again on this on this risk issue you know how much how",
    "start": "3792440",
    "end": "3799319"
  },
  {
    "text": "risky is your environment Etc and and are you worried okay um what other programs are running Espin and it and it",
    "start": "3799319",
    "end": "3806160"
  },
  {
    "text": "is good we're used to an it and it starts everything Mock and it is also good because Mock and it started an it",
    "start": "3806160",
    "end": "3811960"
  },
  {
    "text": "it's it's a and it not really supposed to have a granddaddy Pro supposed to have a parent process okay because it's",
    "start": "3811960",
    "end": "3817799"
  },
  {
    "text": "supposed to be the granddaddy of all the other processes on the system but I told you Mock's a little strange so mocking",
    "start": "3817799",
    "end": "3823200"
  },
  {
    "text": "it starts in it we'll leave that there crash reporter d crash reporter D",
    "start": "3823200",
    "end": "3828319"
  },
  {
    "text": "basically handles you know handles crashing programs it it's basically providing core dumps okay I'm leaving it",
    "start": "3828319",
    "end": "3834680"
  },
  {
    "text": "on because I don't know what the effect is of turning it off just yet okay blue D blue D that's very it's an interesting",
    "start": "3834680",
    "end": "3841920"
  },
  {
    "text": "demon because blue D provides boot Bluetooth now this the system I ran this",
    "start": "3841920",
    "end": "3847039"
  },
  {
    "text": "PS command on doesn't have Bluetooth turned on it's got Bluetooth but it doesn't have it turned on I turned it off the demon still sticks around okay",
    "start": "3847039",
    "end": "3854559"
  },
  {
    "text": "you can either track down where the demon started from and comment it out so it doesn't run or you can just trust",
    "start": "3854559",
    "end": "3860319"
  },
  {
    "text": "that it's going to stay off when it's supposed to stay off um um your call",
    "start": "3860319",
    "end": "3865920"
  },
  {
    "text": "okay um lookup D config D these are both these are both necessary parts for net",
    "start": "3865920",
    "end": "3871440"
  },
  {
    "text": "info but lookup D's part of net info config D is used config D is part of is",
    "start": "3871440",
    "end": "3877720"
  },
  {
    "text": "part of having this system um config D among other things does DHCP okay um we want that to stick",
    "start": "3877720",
    "end": "3883720"
  },
  {
    "text": "around KRON KRON runs automated processes from time you know at specific",
    "start": "3883720",
    "end": "3889000"
  },
  {
    "text": "times generally periodic okay we'll generally leave that running I turn it off on some systems sometimes on laptops",
    "start": "3889000",
    "end": "3896359"
  },
  {
    "text": "but there may be important things in there so what you do before you turned it off is look at the cron jobs and",
    "start": "3896359",
    "end": "3901839"
  },
  {
    "text": "decide whether you want to turn it off or not whether you're prepare to to go without those or to run them manually or or what have you I don't normally think",
    "start": "3901839",
    "end": "3908079"
  },
  {
    "text": "of KRON did have weaknesses back you know a while back but we don't really worry about them now they don't see",
    "start": "3908079",
    "end": "3913880"
  },
  {
    "text": "doesn't seem to have weaknesses now if this is a personal system you're not really used worried about other users if you've got other users on the box you",
    "start": "3913880",
    "end": "3920440"
  },
  {
    "text": "might disallow them from using KRON okay but um in terms of turning off Cron",
    "start": "3920440",
    "end": "3925799"
  },
  {
    "text": "that's that's generally a bad idea for your system okay Dynamic pager Dynamic",
    "start": "3925799",
    "end": "3930920"
  },
  {
    "text": "pager is important you got to keep that around you got to keep that around for swapping for paging out processes",
    "start": "3930920",
    "end": "3936039"
  },
  {
    "text": "there's another process that also works with that update update a few items down",
    "start": "3936039",
    "end": "3941279"
  },
  {
    "text": "okay update is used for flushing the file systems every 30 seconds so that the so the discs so the discs never get",
    "start": "3941279",
    "end": "3947599"
  },
  {
    "text": "too far out of date with the state of the system okay we need those kxd kxd is",
    "start": "3947599",
    "end": "3953520"
  },
  {
    "text": "used for learning for loading external kernel modules on demand we need to keep",
    "start": "3953520",
    "end": "3958680"
  },
  {
    "text": "that okay net info D I talked about that we've got to keep net info D around if",
    "start": "3958680",
    "end": "3963920"
  },
  {
    "text": "we don't we can't log in if you're really paranoid I guess you could log",
    "start": "3963920",
    "end": "3969160"
  },
  {
    "text": "into the box kill net info D and then put it back",
    "start": "3969160",
    "end": "3974279"
  },
  {
    "text": "before you logged out um but uh I think that'd be over over the top CIS log D we",
    "start": "3974279",
    "end": "3979640"
  },
  {
    "text": "need CIS log D it's it's providing our logging okay um the big one for me is",
    "start": "3979640",
    "end": "3985599"
  },
  {
    "text": "mdns responder what's mdns responder sound like okay it's multicast DNS responder",
    "start": "3985599",
    "end": "3993960"
  },
  {
    "text": "okay that that that sounded really useful to me I was going to keep that um until I until I went and found out what",
    "start": "3993960",
    "end": "3999760"
  },
  {
    "text": "it was so couple more slides and we'll get to that we talked about autod dis Mount that was the first thing that was",
    "start": "3999760",
    "end": "4005760"
  },
  {
    "text": "in our list talked about when you want to turn when you want to turn those off when you want to keep it the other thing that autois mount is used for is if you",
    "start": "4005760",
    "end": "4012559"
  },
  {
    "text": "download a dis image file you ever downloaded this skimage file on OSX machine and all of a sudden it shows up",
    "start": "4012559",
    "end": "4017760"
  },
  {
    "text": "as another Drive well that is what mounts them automatically whether you want to mount them automatically again",
    "start": "4017760",
    "end": "4023640"
  },
  {
    "text": "it's one of those issues where it's it's it's you know your risk you choose your risk um so we can turn that off if we",
    "start": "4023640",
    "end": "4032480"
  },
  {
    "text": "look at mdns responder mdns responder is the registration demon for rendevu it's what's sitting there and responding to",
    "start": "4032480",
    "end": "4038799"
  },
  {
    "text": "requests and answer and and you know and telling the entire network hey I've got files to share I've also got somebody",
    "start": "4038799",
    "end": "4044920"
  },
  {
    "text": "I've got somebody in inst the messenger and he's friendly he wants to talk with you okay so if you want to turn off",
    "start": "4044920",
    "end": "4050599"
  },
  {
    "text": "rendevu that was one of the weird ones I was telling you about that's not in host config okay if you want to turn off mdns",
    "start": "4050599",
    "end": "4061359"
  },
  {
    "text": "responder okay what you have to do is go and find the script okay the script is mdns responder",
    "start": "4063079",
    "end": "4071319"
  },
  {
    "text": "oh sorry remember those are those are directories mdns responder M DNS",
    "start": "4071319",
    "end": "4078359"
  },
  {
    "text": "responder and find it and basically if you want to what you could do is you could just write Exit Zero",
    "start": "4078359",
    "end": "4085960"
  },
  {
    "text": "there okay if you didn't want to do that you could go down and comment out",
    "start": "4085960",
    "end": "4093839"
  },
  {
    "text": "the line that starts it okay um I'm more a fan of the first",
    "start": "4093839",
    "end": "4099040"
  },
  {
    "text": "approach but the second approach is also kind of more readable so um you know the",
    "start": "4099040",
    "end": "4104719"
  },
  {
    "text": "sum so your call um Rendevous is gone now okay we'll have to stop the script",
    "start": "4104719",
    "end": "4111400"
  },
  {
    "text": "and if we want to be safe we should restart it too so mdns responder M DNS",
    "start": "4111400",
    "end": "4118000"
  },
  {
    "text": "responder stop and if I run start I better not find it",
    "start": "4118000",
    "end": "4124678"
  },
  {
    "text": "here okay I don't find it in my process list anymore here I'll give you the process",
    "start": "4128080",
    "end": "4134199"
  },
  {
    "text": "list with with jreed out all fits on a page right now it's kind of getting",
    "start": "4134199",
    "end": "4139440"
  },
  {
    "text": "smaller okay so mdns responder I wanted gone I'm putting up a website that kind",
    "start": "4139440",
    "end": "4146080"
  },
  {
    "text": "of goes through all the rest of these that you might possibly want to turn off",
    "start": "4146080",
    "end": "4152758"
  },
  {
    "text": "um at that point when you're done going through when you're done going through and looking at running scripts oh wait",
    "start": "4152759",
    "end": "4159400"
  },
  {
    "text": "there's Auto dis Mount and I wanted that gone so I remember I changed it I guess I didn't run the stop",
    "start": "4159400",
    "end": "4167359"
  },
  {
    "text": "script okay when you're done going through and killing off killing off scripts um by looking at PS what I would",
    "start": "4168120",
    "end": "4176199"
  },
  {
    "text": "do then is run netstat minus NP",
    "start": "4176199",
    "end": "4181560"
  },
  {
    "text": "TCP and net stat UDP okay and what I want to do is look",
    "start": "4181560",
    "end": "4189640"
  },
  {
    "text": "at what's still listening on the box okay if I if I run my net stat and I",
    "start": "4189640",
    "end": "4195400"
  },
  {
    "text": "grap for listens just so I can just get listening ports okay this is the wonderful power of doing um PowerPoint",
    "start": "4195400",
    "end": "4203640"
  },
  {
    "text": "slides you can either choose fonts that are big enough or you can choose um to",
    "start": "4203640",
    "end": "4208960"
  },
  {
    "text": "get everything on one line so we've got net info is the first thing I see okay",
    "start": "4208960",
    "end": "4214080"
  },
  {
    "text": "I've see on my on my list I had when I was done when I was done auditing the reference system I had 1033 as the only",
    "start": "4214080",
    "end": "4221840"
  },
  {
    "text": "Port that was listing on TCP and if I looked at that okay um if I looked at that what I can",
    "start": "4221840",
    "end": "4228760"
  },
  {
    "text": "do is I can run I gave you on the previous slide an lsof command lsof is list open files on Unix everything's a",
    "start": "4228760",
    "end": "4236120"
  },
  {
    "text": "file including ports you're listening on so if you want to know what's listening on a port you can run lsof space minus I",
    "start": "4236120",
    "end": "4243520"
  },
  {
    "text": "for Internet space TCP or UDP colon the port number and you get hey that's what this is It's net info D okay net info is",
    "start": "4243520",
    "end": "4252600"
  },
  {
    "text": "okay we saw it was only listening on Loop back it was just list on 1271 so it's and we from what I can tell",
    "start": "4252600",
    "end": "4261640"
  },
  {
    "text": "you can't run without without net info so it's not that dangerous because it's not listening it's not listening on the",
    "start": "4261640",
    "end": "4268040"
  },
  {
    "text": "on the global network interface okay if we do our UDP audit we find a bunch more",
    "start": "4268040",
    "end": "4274199"
  },
  {
    "text": "ports that are still listening okay 1033 in the middle we're going to guess that's net info we can check it what we",
    "start": "4274199",
    "end": "4280880"
  },
  {
    "text": "should do with each of these ports is check and see what they are so if we run lsof on the first one what do we get",
    "start": "4280880",
    "end": "4288040"
  },
  {
    "text": "okay we get lookup D and what lookup D does is it's a demon that that's providing access um that's providing",
    "start": "4288040",
    "end": "4295080"
  },
  {
    "text": "caching for net info information for NIS information for DNS information and",
    "start": "4295080",
    "end": "4300440"
  },
  {
    "text": "actually really oddly even the files in Etsy okay it kind of caches their information if they weren't done by if",
    "start": "4300440",
    "end": "4306400"
  },
  {
    "text": "they weren't being brokered by net info itself it's going and caching that information as far as I can tell you",
    "start": "4306400",
    "end": "4312400"
  },
  {
    "text": "seem to need it on the system okay um 49227 we check the next port in our",
    "start": "4312400",
    "end": "4319080"
  },
  {
    "text": "list it turns out to be the same thing look up D so we leave it alone okay if we look at",
    "start": "4319080",
    "end": "4325199"
  },
  {
    "text": "1033 okay that's net info that's only listening on Loop back we're not so worried about it we'll leave that",
    "start": "4325199",
    "end": "4331480"
  },
  {
    "text": "alone okay Port 514 was kind of that was something that really worried me i r I",
    "start": "4331480",
    "end": "4337719"
  },
  {
    "text": "ran lsof and I got CIS log D is sitting there listening on the CIS log Port I",
    "start": "4337719",
    "end": "4343920"
  },
  {
    "text": "said that's not good okay um however I actually can't get this thing when I was",
    "start": "4343920",
    "end": "4351320"
  },
  {
    "text": "testing and trying to get rid of",
    "start": "4351320",
    "end": "4354800"
  },
  {
    "text": "this okay if I look at the man page what the man page says is under minus U let",
    "start": "4356400",
    "end": "4362840"
  },
  {
    "text": "me see if the minus U will stay up no if I look at the minus U it says minus U says select the historical insecure mode",
    "start": "4362840",
    "end": "4371159"
  },
  {
    "text": "in which CIS log D will accept input from the UDP Port some software wants this but you can be subjected to a",
    "start": "4371159",
    "end": "4377040"
  },
  {
    "text": "variety of texts over the network including attack is remotely failing logs so what did I do as somebody who's",
    "start": "4377040",
    "end": "4382719"
  },
  {
    "text": "responsible I fired up my little logging client and I started shooting remote logs at it I couldn't get this thing to",
    "start": "4382719",
    "end": "4388800"
  },
  {
    "text": "actually take any remote logs and why can't it well if I look at that if I look at",
    "start": "4388800",
    "end": "4395960"
  },
  {
    "text": "that CIS log D that's running it's not running with minus U but what did the",
    "start": "4396800",
    "end": "4402520"
  },
  {
    "text": "man page say okay what the man page says somewhere on here it says minus U is non",
    "start": "4402520",
    "end": "4409760"
  },
  {
    "text": "default you have to specify minus U to get this to listen on the network so what I find is the man page tells me I",
    "start": "4409760",
    "end": "4415800"
  },
  {
    "text": "have to run minus you to listen on the network so it's not running minus you it is does seem to be listening on the",
    "start": "4415800",
    "end": "4421880"
  },
  {
    "text": "network but I can't get it to take any logs I don't know this is where yes in",
    "start": "4421880",
    "end": "4427040"
  },
  {
    "text": "the",
    "start": "4427040",
    "end": "4429199"
  },
  {
    "text": "back Port 514",
    "start": "4434040",
    "end": "4438800"
  },
  {
    "text": "yeah so it's part of the design it's it's you know they're Pro they're just probably using yeah they're probably",
    "start": "4439320",
    "end": "4445159"
  },
  {
    "text": "using the exact same CIS log demon I can't actually turn it off even though the program is not going to accept any",
    "start": "4445159",
    "end": "4450840"
  },
  {
    "text": "network that I got over that accept an input it's getting over the network it's still listening to the network and still",
    "start": "4450840",
    "end": "4456040"
  },
  {
    "text": "showing up in net stat it's very odd but I'm decided not to worry about it okay",
    "start": "4456040",
    "end": "4461920"
  },
  {
    "text": "what am I going to do though in terms of in terms of um so the first thing I'm",
    "start": "4461920",
    "end": "4467520"
  },
  {
    "text": "going to do is I'm going to check it and try to fire off remote logging messages at it okay um sorry I skipped ahead um",
    "start": "4467520",
    "end": "4474800"
  },
  {
    "text": "first thing I'm going to do is I'm going to check it I'm going to read my man page I'm going to check it I'm G to say okay I can't get anything to it what's the next thing I'm going to do okay",
    "start": "4474800",
    "end": "4482080"
  },
  {
    "text": "actually I was told I can give away a copy of the book they gave me one copy to give away and I I said okay I'll",
    "start": "4482080",
    "end": "4488280"
  },
  {
    "text": "think of a trivia question okay what's the next thing I'm going to do I've got the CIS log demon I I it's listening on",
    "start": "4488280",
    "end": "4493760"
  },
  {
    "text": "the it says that it's listening on the Network netstat says that it is its man page says that it isn't my tests show",
    "start": "4493760",
    "end": "4498840"
  },
  {
    "text": "that it isn't I'm not really that worried what will I do somebody give me a nice you know one more defensive",
    "start": "4498840",
    "end": "4504600"
  },
  {
    "text": "measure oh do shouted out I've only got one book somebody raised their hand okay",
    "start": "4504600",
    "end": "4511719"
  },
  {
    "text": "um in the blue I'll fir wallet right I'll run I've got this thing takes this this thing",
    "start": "4511719",
    "end": "4518000"
  },
  {
    "text": "runs OSX runs IP filter I'll set up an IP filter based firewall uh this one's",
    "start": "4518000",
    "end": "4523280"
  },
  {
    "text": "yours man um um I'll run IP filter and I'll firewall",
    "start": "4523280",
    "end": "4529480"
  },
  {
    "text": "off that Port am I going to firewall off just that one port well if I don't have time to construct a proper firewall I'll",
    "start": "4529480",
    "end": "4535159"
  },
  {
    "text": "just firewall off that one port oh well we just got it for free man",
    "start": "4535159",
    "end": "4540920"
  },
  {
    "text": "okay so so I could just firewall off that one port if I've got more time on my hands",
    "start": "4540920",
    "end": "4547840"
  },
  {
    "text": "I'll make a complete firewall for the system now you say Well then why don't you just you know leave it alone for now",
    "start": "4547840",
    "end": "4553239"
  },
  {
    "text": "and firewall it later well my first answer to that is I don't want to leave anything alone for now and take my",
    "start": "4553239",
    "end": "4558760"
  },
  {
    "text": "chances what I'll do is I'll firewall off that one port immediately and then I will at some",
    "start": "4558760",
    "end": "4564320"
  },
  {
    "text": "point soon maybe it'll be a week but knowing me it might be a month it might be three months I'll get around to",
    "start": "4564320",
    "end": "4569719"
  },
  {
    "text": "riding a firewall for this one box okay or for my other OSX systems okay so",
    "start": "4569719",
    "end": "4575560"
  },
  {
    "text": "let's keep looking at our ports um Port 68 I think this is our last one UDP 68 that's our DHCP client",
    "start": "4575560",
    "end": "4584400"
  },
  {
    "text": "okay if we set this up for static IP no worries if it's going to go DHCP we'll",
    "start": "4584400",
    "end": "4589760"
  },
  {
    "text": "need this to continue listening to the network and so that's okay okay at this",
    "start": "4589760",
    "end": "4595239"
  },
  {
    "text": "point I'm finished um our next steps would be to do a set u ID audit and a",
    "start": "4595239",
    "end": "4600560"
  },
  {
    "text": "set GID audit thank you our um I got 10 minutes um I do a set uid audit set GID",
    "start": "4600560",
    "end": "4608239"
  },
  {
    "text": "audit okay and what I'm doing is I'm looking for programs specifically I look for set uid rout programs set g r",
    "start": "4608239",
    "end": "4614080"
  },
  {
    "text": "programs I'm looking for programs that every user on the system can run that gives them root privilege for any reason",
    "start": "4614080",
    "end": "4621120"
  },
  {
    "text": "okay and I'm going to want to shut off some of those I'm going to want to control the control access to some of those and the reason for that is that",
    "start": "4621120",
    "end": "4627639"
  },
  {
    "text": "one of them could end up being vulnerable at some point could end up having a vulnerability vulnerabilities and set u ID programs tend to give any",
    "start": "4627639",
    "end": "4634760"
  },
  {
    "text": "user on the system the ability to go from the normal user to executing commands and usually a shell has root so",
    "start": "4634760",
    "end": "4642239"
  },
  {
    "text": "I'm going to look at the set uid programs that are on the box and I'm going to take some of them and make them not set you ID and say this program",
    "start": "4642239",
    "end": "4648400"
  },
  {
    "text": "doesn't need to run as root okay for the remaining for for the ones that do need to run as root I I might say is there a",
    "start": "4648400",
    "end": "4654480"
  },
  {
    "text": "set of users on this system that only needs you know that that doesn't need to run this and the biggest thing that I'll",
    "start": "4654480",
    "end": "4660360"
  },
  {
    "text": "do with OSX is what I'll say is okay I've got users on the system that run",
    "start": "4660360",
    "end": "4665480"
  },
  {
    "text": "say the web server I've got a user called you know a user called Apache",
    "start": "4665480",
    "end": "4670600"
  },
  {
    "text": "that the web server runs as and then I've got a user J that that the user runs as say so what I'll do is I'll take",
    "start": "4670600",
    "end": "4676840"
  },
  {
    "text": "say the mount command which is set u ID the Ping command that's set u ID the Tracer command that's set u ID these are",
    "start": "4676840",
    "end": "4682880"
  },
  {
    "text": "all commands that my web server doesn't need to run okay it doesn't need to run those and so I'll set the program I'll",
    "start": "4682880",
    "end": "4689400"
  },
  {
    "text": "take that program and I'll create a group for just my human users I might call it humans and I'll populate that",
    "start": "4689400",
    "end": "4695159"
  },
  {
    "text": "group with just the human users not the web server not the DNS server not the servers on the box and I'll make those",
    "start": "4695159",
    "end": "4701719"
  },
  {
    "text": "I'll make those set8 programs I'll make Mount and ping and Trace routes I'll make those owned group owned by",
    "start": "4701719",
    "end": "4707840"
  },
  {
    "text": "group humans okay and group executable but not World executable so that if",
    "start": "4707840",
    "end": "4713679"
  },
  {
    "text": "somebody if somebody takes over my Apache server and they've got Apache they've got user user Apache on the box",
    "start": "4713679",
    "end": "4719280"
  },
  {
    "text": "but they don't have root they won't be able to run Mount they won't be able to run ping they won't be able to run trace",
    "start": "4719280",
    "end": "4724679"
  },
  {
    "text": "route because they won't have execute access on them and that's a nice little that's a nice little utility that's I",
    "start": "4724679",
    "end": "4730639"
  },
  {
    "text": "mean that's a nice little process by doing that if it turns out as has happened on Linux before has this",
    "start": "4730639",
    "end": "4735679"
  },
  {
    "text": "happened on lots of operating systems before that there's a set u ID Mount command on there and and the mount command turns out to be vulnerable turns",
    "start": "4735679",
    "end": "4742360"
  },
  {
    "text": "out to have a vulnerability and later on if I've removed World execute then someone who takes over the web server isn't able to escalate privilege to rout",
    "start": "4742360",
    "end": "4749199"
  },
  {
    "text": "through the mount command so that's one of the first things I'll do on this system okay and I've got if we end up",
    "start": "4749199",
    "end": "4756480"
  },
  {
    "text": "with time I'll show you a to list of the set uid programs on the system what else will I do I will audit the cron jobs on",
    "start": "4756480",
    "end": "4763000"
  },
  {
    "text": "the system okay what Mac OSX does is it runs a program called",
    "start": "4763000",
    "end": "4768120"
  },
  {
    "text": "periodic runs a script I believe it's a script it's running periodic and tells periodic and and basically KRON runs",
    "start": "4768120",
    "end": "4775520"
  },
  {
    "text": "periodic and periodic runs a bunch of other scripts and those scripts are scripts that you want to run",
    "start": "4775520",
    "end": "4781920"
  },
  {
    "text": "periodically daily weekly monthly okay they the ones that come on the the ones that are on the system by default do",
    "start": "4781920",
    "end": "4788320"
  },
  {
    "text": "things like compress the old logs delete old files in temp etc etc okay um but",
    "start": "4788320",
    "end": "4794760"
  },
  {
    "text": "I'm going to go and take a look at those cron jobs and make sure that none of them look dangerous I'm going to make sure that they all the things I want to",
    "start": "4794760",
    "end": "4799960"
  },
  {
    "text": "have want to have run and so on um I want to make sure that they're all useful if none of them are useful I'll",
    "start": "4799960",
    "end": "4805239"
  },
  {
    "text": "turn off Kon I can't think of too many situations where I've turned off cron but I I I could be persuaded at that",
    "start": "4805239",
    "end": "4811520"
  },
  {
    "text": "point the other two things I do is i' go and audit the demon configurations and by that we mean if I do have a running",
    "start": "4811520",
    "end": "4817280"
  },
  {
    "text": "web server on the system if I did need the web server to be on I would go and take some standard hardening steps and",
    "start": "4817280",
    "end": "4823080"
  },
  {
    "text": "go and lock down the web server okay um I've got some articles on my website that's on a future slide I'll",
    "start": "4823080",
    "end": "4829040"
  },
  {
    "text": "show you one of the slides and I've got some articles on how you might do that to different demons that are on the system the last thing I do is I do a",
    "start": "4829040",
    "end": "4835120"
  },
  {
    "text": "general permissions audit I would go and run around the system and I'd look for World executable I mean for World writable files World writable",
    "start": "4835120",
    "end": "4842000"
  },
  {
    "text": "directories and try to see if there are any if those if those files and directories need to be World writable and if there are any security",
    "start": "4842000",
    "end": "4847280"
  },
  {
    "text": "implications of them being World writable okay um um I'll show you what",
    "start": "4847280",
    "end": "4853080"
  },
  {
    "text": "the effects are for my set uid audit okay I I didn't want to I didn't want to",
    "start": "4853080",
    "end": "4858159"
  },
  {
    "text": "run through this just want to give you a process for my set uid audit this is just how I construct my lists of set uid",
    "start": "4858159",
    "end": "4864480"
  },
  {
    "text": "files and set uid root files and I'll go on a look at those for my KRON jobs I'll look at aty",
    "start": "4864480",
    "end": "4871760"
  },
  {
    "text": "Chron Tab and what I find is that all the KRON jobs all the Chron jobs run as",
    "start": "4871760",
    "end": "4877520"
  },
  {
    "text": "root and they run periodic daily periodic weekly periodic monthly okay",
    "start": "4877520",
    "end": "4883760"
  },
  {
    "text": "and that program runs what periodic daily does is it runs Etsy periodic daily I'll show you",
    "start": "4883760",
    "end": "4893320"
  },
  {
    "text": "here okay if I look at we're just looking at at at KRON tab at at C cron",
    "start": "4897360",
    "end": "4905600"
  },
  {
    "text": "Tab and all it does is basically run periodic daily weekly and monthly what periodic does is it goes",
    "start": "4905600",
    "end": "4913120"
  },
  {
    "text": "through all the scripts that are in Etsy periodic say",
    "start": "4913120",
    "end": "4919320"
  },
  {
    "text": "daily and runs them and what you see there is here I'll I'll put this near the top of the screen what you see there",
    "start": "4922440",
    "end": "4929840"
  },
  {
    "text": "is that inside ety periodic daily there are scripts that actually have a number in the beginning that's defining an",
    "start": "4929840",
    "end": "4935400"
  },
  {
    "text": "order 100 dot what was that the log cleaning 100. clean logs and 500. daily",
    "start": "4935400",
    "end": "4942000"
  },
  {
    "text": "where 500. daily um where 500. daily",
    "start": "4942000",
    "end": "4951159"
  },
  {
    "text": "is okay 500. daily is the main daily script it's for everything else it's for all the miscellaneous stuff okay",
    "start": "4955000",
    "end": "4964520"
  },
  {
    "text": "and the other thing it will do is run a script if it exists called Etsy",
    "start": "4965440",
    "end": "4971800"
  },
  {
    "text": "daily. loc and that's where you're supposed to put your your stuff for periodic to run okay so I would go",
    "start": "4971800",
    "end": "4978000"
  },
  {
    "text": "through especially on a system that's already running and check that file and look at everything in Etsy periodic and then check any files that references and",
    "start": "4978000",
    "end": "4984239"
  },
  {
    "text": "the only ones that references by default are those Etsy Etsy um Peri Etsy daily.",
    "start": "4984239",
    "end": "4989960"
  },
  {
    "text": "local Etsy weekly. looc Andy monthly. loal and take a look at those okay so I had a a slide",
    "start": "4989960",
    "end": "4997760"
  },
  {
    "text": "referencing that okay on demon configurations um on like I said when",
    "start": "4997760",
    "end": "5003159"
  },
  {
    "text": "you're in terms of in terms of locking down demon configurations you'd go and look at the demons you're still running on the system and decide whether you you",
    "start": "5003159",
    "end": "5010080"
  },
  {
    "text": "know and once you've decided to keep them you want to decide what their purpose is and then lock them down accordingly okay on the permissions",
    "start": "5010080",
    "end": "5017040"
  },
  {
    "text": "audit side that last step um it's interesting what weak permissions can do if you look at old Unix systems you know",
    "start": "5017040",
    "end": "5024239"
  },
  {
    "text": "if you get an old Solaris 2 Solaris 251 Solaris 24 system Etc look at old Unix",
    "start": "5024239",
    "end": "5029719"
  },
  {
    "text": "systems they actually have all kinds of they have all kinds of little weaknesses where where you could look at a",
    "start": "5029719",
    "end": "5035760"
  },
  {
    "text": "directory that was World writable or a directory that was writable by some user other than root some user that maybe things on the system were running as and",
    "start": "5035760",
    "end": "5043719"
  },
  {
    "text": "um and if you look at either directories that are that are World writable or writable by any user that you can get um",
    "start": "5043719",
    "end": "5050080"
  },
  {
    "text": "that you can get control of um they were often an easy way to to jump up to rout because what you're able to do is to",
    "start": "5050080",
    "end": "5056639"
  },
  {
    "text": "replace data files or programs that were in those directories and if you could replace them if an attacker could",
    "start": "5056639",
    "end": "5061800"
  },
  {
    "text": "replace them um then they can often you know just start escalating privilege up okay so in terms of in terms of a",
    "start": "5061800",
    "end": "5069840"
  },
  {
    "text": "permission audit you might want to go through on any systems you have including any especially any new",
    "start": "5069840",
    "end": "5075120"
  },
  {
    "text": "operating systems and look at what the permissions are the very least that I tend to do is go and look for World",
    "start": "5075120",
    "end": "5080440"
  },
  {
    "text": "writeable files and World rable directories okay it could be very dangerous if you had a system that had a",
    "start": "5080440",
    "end": "5087080"
  },
  {
    "text": "that had common applications that were run by root or run by ordinary users or run by administrators who are going to",
    "start": "5087080",
    "end": "5093119"
  },
  {
    "text": "be able who who have more privilege on the system than than than you do okay than than other users do than the",
    "start": "5093119",
    "end": "5099480"
  },
  {
    "text": "attacker would okay that are World writable because then what do you do if you've got a world writable directory",
    "start": "5099480",
    "end": "5105480"
  },
  {
    "text": "what do what does a attacker do if I don't know if user bin is World writable does anybody want to this was",
    "start": "5105480",
    "end": "5112280"
  },
  {
    "text": "this was this is a you know such an oldie what's that",
    "start": "5112280",
    "end": "5117600"
  },
  {
    "text": "anybody yeah replace login replace copy replace touch okay you don't want to you",
    "start": "5117600",
    "end": "5123760"
  },
  {
    "text": "don't want to necessar neily replace it you know you might replace it with what you might replace it with a wrapper script you might move login aside to",
    "start": "5123760",
    "end": "5130639"
  },
  {
    "text": "login. whatever um you might replace CP with you know you you might replace CP",
    "start": "5130639",
    "end": "5136960"
  },
  {
    "text": "with your own CP call the original CP cp. arid and have your rapper do",
    "start": "5136960",
    "end": "5142520"
  },
  {
    "text": "something and then call cp. Ridge um so",
    "start": "5142520",
    "end": "5147760"
  },
  {
    "text": "really permissions audit is definitely an order um it's definitely something you'd want to do on the system okay",
    "start": "5147760",
    "end": "5153560"
  },
  {
    "text": "lastly the last thing I the last thing I'll tell you about is I told you Basel has been ported we ported Bas steel um",
    "start": "5153560",
    "end": "5159199"
  },
  {
    "text": "we started porting Basel it works now we need to add more content to it but I could definitely use help okay if you",
    "start": "5159199",
    "end": "5165400"
  },
  {
    "text": "are you know if you if you play around with pearl some and even if you are just marginally aware of pearl best de's got",
    "start": "5165400",
    "end": "5171239"
  },
  {
    "text": "a nice API that makes it very easy to add in new content new tests um new fixes um without having to know much",
    "start": "5171239",
    "end": "5178440"
  },
  {
    "text": "Pearl at all if any and so we can definitely use some help on OSX okay um in terms of hardening I've",
    "start": "5178440",
    "end": "5186119"
  },
  {
    "text": "got articles on hardening up on my website um and this will you know when I said you could lock down demons you'd",
    "start": "5186119",
    "end": "5191679"
  },
  {
    "text": "have to go and read some stuff and learn how to lock down a given demon um I do talks on that sometimes and I have",
    "start": "5191679",
    "end": "5196800"
  },
  {
    "text": "articles on my website telling you how to lock down specific demons so that's it um um any questions I know we're out",
    "start": "5196800",
    "end": "5205639"
  },
  {
    "text": "of time yes do",
    "start": "5205639",
    "end": "5210719"
  },
  {
    "text": "thinka Apple's default IPFW rules um I took a little bit of a look they were",
    "start": "5211119",
    "end": "5216159"
  },
  {
    "text": "they were okay but honestly I replaced them straight out with my own um but the",
    "start": "5216159",
    "end": "5221400"
  },
  {
    "text": "fact that Apple shipping with um I'll put it up on my website it's a good idea by the way I'm going to",
    "start": "5221400",
    "end": "5228320"
  },
  {
    "text": "do a book signing um they they thought that'd be fun right during the right right at the beginning of lunch lunch is",
    "start": "5228320",
    "end": "5233560"
  },
  {
    "text": "an hour and a half long so if you've got a copy of the book I'll be happy to sign it for you if you want to copy the book",
    "start": "5233560",
    "end": "5239040"
  },
  {
    "text": "they'll probably sell you one um you know um I'll be right out there as soon as we leave",
    "start": "5239040",
    "end": "5245000"
  },
  {
    "text": "here um so yeah I'll I'm will to post my IP filter rues set to my website sure",
    "start": "5245000",
    "end": "5251760"
  },
  {
    "text": "any other",
    "start": "5251760",
    "end": "5254239"
  },
  {
    "text": "questions if I change my IP filter rules I might have to disable the guey interface for building them well yeah",
    "start": "5260920",
    "end": "5267000"
  },
  {
    "text": "basically if I don't want them clobbered if I ever decide to use the guey interface this is the thing with a lot of the guey interfaces what you do is",
    "start": "5267000",
    "end": "5272800"
  },
  {
    "text": "you can either use the guey interface to create them or you can write your own guey interfaces you know but yeah I",
    "start": "5272800",
    "end": "5277880"
  },
  {
    "text": "haven't even touched the GU interface for IP for for for creating rules just wrote My Own by hand and placed it in",
    "start": "5277880",
    "end": "5285199"
  },
  {
    "text": "there um over there server based OSX I have not looked",
    "start": "5285199",
    "end": "5292679"
  },
  {
    "text": "at the server based Ox yet the question was have I looked at the server based OSX um I don't have one um anybody got",
    "start": "5292679",
    "end": "5299840"
  },
  {
    "text": "one I'll be happy to audit it for you for free to uh in exchange for getting to see it",
    "start": "5299840",
    "end": "5305840"
  },
  {
    "text": "um uh",
    "start": "5305840",
    "end": "5309080"
  },
  {
    "text": "yes yeah so the the the statement was it you",
    "start": "5316119",
    "end": "5321440"
  },
  {
    "text": "said the update process might clobber things on any operating system the update process has some good chance of",
    "start": "5321440",
    "end": "5327080"
  },
  {
    "text": "clobbering your hardening steps so either you've got two options there either one you make sure that your",
    "start": "5327080",
    "end": "5332639"
  },
  {
    "text": "hardening steps follow the vendor's particular interface for doing it that their patches are never supposed to",
    "start": "5332639",
    "end": "5338600"
  },
  {
    "text": "clobber recognize that if they have a bug they'll still clobber it um or item",
    "start": "5338600",
    "end": "5343880"
  },
  {
    "text": "two was do what he said which is just automate your once you once you've decided on your hardening steps automate",
    "start": "5343880",
    "end": "5349280"
  },
  {
    "text": "them create a script that's nice both for consistency for not having patches blow them away and for scalability you",
    "start": "5349280",
    "end": "5355920"
  },
  {
    "text": "know you get another OSX box in you just take your take your hardening script um honestly it's what I've done at every",
    "start": "5355920",
    "end": "5361320"
  },
  {
    "text": "site every site that I've worked at you know we've had sometimes what we do is we'll have a hardening script that runs on every boot",
    "start": "5361320",
    "end": "5367920"
  },
  {
    "text": "so the system Boots the hardening script reruns and makes sure that everything that we hardened is still hardened um",
    "start": "5367920",
    "end": "5373840"
  },
  {
    "text": "and changes anything it isn't you know lets us know whe the new patches that are supposed to be installed and then",
    "start": "5373840",
    "end": "5379040"
  },
  {
    "text": "you know brings up the rest of the system there were another there's another question over here somewhere did I already answer it uh",
    "start": "5379040",
    "end": "5387119"
  },
  {
    "text": "just stretching over there",
    "start": "5387119",
    "end": "5390560"
  },
  {
    "text": "yes",
    "start": "5393040",
    "end": "5396040"
  },
  {
    "text": "he's got a local script he does he does exactly that and that way doesn't have to worry because every so often he has",
    "start": "5406520",
    "end": "5411800"
  },
  {
    "text": "had a patch clobber hardening step so we've all had it happen any other",
    "start": "5411800",
    "end": "5418159"
  },
  {
    "text": "questions okay I hope you had fun I know it was a little the laptop was a little awkward but",
    "start": "5418159",
    "end": "5425960"
  },
  {
    "text": "thanks",
    "start": "5452920",
    "end": "5455920"
  },
  {
    "text": "e",
    "start": "5482920",
    "end": "5485920"
  },
  {
    "text": "e",
    "start": "5512840",
    "end": "5515840"
  },
  {
    "text": "e",
    "start": "5542840",
    "end": "5545840"
  },
  {
    "text": "e",
    "start": "5572840",
    "end": "5575840"
  },
  {
    "text": "e",
    "start": "5602760",
    "end": "5605760"
  },
  {
    "text": "e",
    "start": "5632719",
    "end": "5635719"
  },
  {
    "text": "e",
    "start": "5662719",
    "end": "5665719"
  },
  {
    "text": "e",
    "start": "5692639",
    "end": "5695639"
  },
  {
    "text": "e",
    "start": "5722639",
    "end": "5725639"
  },
  {
    "text": "e",
    "start": "5752639",
    "end": "5755639"
  },
  {
    "text": "e",
    "start": "5782560",
    "end": "5785560"
  },
  {
    "text": "e",
    "start": "5812520",
    "end": "5815520"
  },
  {
    "text": "e",
    "start": "5835800",
    "end": "5838800"
  }
]