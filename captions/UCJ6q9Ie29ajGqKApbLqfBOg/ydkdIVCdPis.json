[
  {
    "text": "[Music] foreign",
    "start": "1730",
    "end": "6720"
  },
  {
    "text": "welcome to my presentation um today my topic is related to Apple's",
    "start": "9780",
    "end": "15299"
  },
  {
    "text": "Wi-Fi subsystem buzzing and kernel vulnerability research the title is dive",
    "start": "15299",
    "end": "22080"
  },
  {
    "text": "into Apple IO 80 to 11 family volume 2.",
    "start": "22080",
    "end": "27560"
  },
  {
    "text": "my name is from somal Tech and Enterprise data security company I can",
    "start": "27560",
    "end": "34860"
  },
  {
    "text": "be reached through this email address today's penetration can be regarded as",
    "start": "34860",
    "end": "40200"
  },
  {
    "text": "the second part of my black hat USA Topic in 2020 which can be found here",
    "start": "40200",
    "end": "48059"
  },
  {
    "text": "um if you haven't heard of this topic before don't worry uh I will first",
    "start": "48059",
    "end": "53280"
  },
  {
    "text": "introduce the subsystem and quickly go through the previous work",
    "start": "53280",
    "end": "58320"
  },
  {
    "text": "so um the Wi-Fi subsystem first let's go back to two years ago one",
    "start": "58320",
    "end": "65400"
  },
  {
    "text": "day in January I found an interesting thing a driver called airport broken Nic",
    "start": "65400",
    "end": "71400"
  },
  {
    "text": "disappeared from the system but with the deepening of research I",
    "start": "71400",
    "end": "76619"
  },
  {
    "text": "found that starting from IOS 13 and Mac OS 10.15 Catalina Apple refactored the",
    "start": "76619",
    "end": "83220"
  },
  {
    "text": "the architecture of the 80211 Wi-Fi clients extensions and the renamed the",
    "start": "83220",
    "end": "89640"
  },
  {
    "text": "new generation to family version 2. um behind the network architecture",
    "start": "89640",
    "end": "95460"
  },
  {
    "text": "reflecting I think it is a change of concept one of the goals is to upgrade",
    "start": "95460",
    "end": "101820"
  },
  {
    "text": "from basic network communication capabilities to support trusted privacy",
    "start": "101820",
    "end": "107460"
  },
  {
    "text": "sharing among all types of Apple devices here is a brief architecture diagram",
    "start": "107460",
    "end": "114560"
  },
  {
    "text": "from email user mode framework to family extensions plugging and low-level",
    "start": "114560",
    "end": "121920"
  },
  {
    "text": "extensions we can see the changes between version 1 and version 2 for example here",
    "start": "121920",
    "end": "127160"
  },
  {
    "text": "there's no more airports broadcom serious extensions",
    "start": "127160",
    "end": "134360"
  },
  {
    "text": "and we are security researchers so two years ago my work also included in early",
    "start": "134640",
    "end": "141239"
  },
  {
    "text": "Asian of fighting framework um a single code coverage analysis tour",
    "start": "141239",
    "end": "146640"
  },
  {
    "text": "and came up with the kernel address and advisor solution as a result of the work kernel",
    "start": "146640",
    "end": "153300"
  },
  {
    "text": "vulnerabilities I I I found can be classified into several types like",
    "start": "153300",
    "end": "159959"
  },
  {
    "text": "vulnerability affecting all in way one and holding weights you and both way one",
    "start": "159959",
    "end": "165660"
  },
  {
    "text": "and with you in specific cases there are some vulnerabilities I have announced this in",
    "start": "165660",
    "end": "172560"
  },
  {
    "text": "detail but others that I cannot disclose because they are haven't been fixed",
    "start": "172560",
    "end": "177840"
  },
  {
    "text": "before blackhead USA 2030 um this vulnerabilities are found in various components among a mentioned",
    "start": "177840",
    "end": "185400"
  },
  {
    "text": "above for example uh 2020 98 32 is in",
    "start": "185400",
    "end": "191580"
  },
  {
    "text": "the family extension while 9833 is in the underlying driver",
    "start": "191580",
    "end": "199459"
  },
  {
    "text": "and two years have passed let's return to 2022",
    "start": "199739",
    "end": "205159"
  },
  {
    "text": "all the previous vulnerability have been fixed and the or security of the",
    "start": "205159",
    "end": "211860"
  },
  {
    "text": "operating system has been grouped Mac OS speaker Monterey Ventura has been",
    "start": "211860",
    "end": "217800"
  },
  {
    "text": "released and the era of Apple silicon has arrived but I still have a lot of questions such as family version 2 has",
    "start": "217800",
    "end": "226440"
  },
  {
    "text": "been reflected again and the name has been changed back to io8 0 to 11 family",
    "start": "226440",
    "end": "233760"
  },
  {
    "text": "so what happened behind this and how to identify the new attack surfaces what",
    "start": "233760",
    "end": "239220"
  },
  {
    "text": "else can be improved in security engineering and most importantly can we",
    "start": "239220",
    "end": "244440"
  },
  {
    "text": "still find a new high quality kernel vulnerabilities",
    "start": "244440",
    "end": "249900"
  },
  {
    "text": "um yeah please allow me throughout quick answers to these questions",
    "start": "249900",
    "end": "255360"
  },
  {
    "text": "change is the only consistent and domain knowledge is very important for security",
    "start": "255360",
    "end": "261540"
  },
  {
    "text": "engineering to be honest too many areas can be improved and for vulnerability",
    "start": "261540",
    "end": "267419"
  },
  {
    "text": "hunting I have to say uh yes definitely so here we go",
    "start": "267419",
    "end": "274100"
  },
  {
    "text": "the improvements of the new generation fighting framework begins with attack",
    "start": "275820",
    "end": "281639"
  },
  {
    "text": "surfaces identification my first demand is actually very simple I'd like to",
    "start": "281639",
    "end": "288660"
  },
  {
    "text": "change various settings of the network while sending and receiving data uh then",
    "start": "288660",
    "end": "295860"
  },
  {
    "text": "uh such interface should at least include to me at least include traditional bsdio",
    "start": "295860",
    "end": "303900"
  },
  {
    "text": "control iocates connect the core methods serious and the sales control interface",
    "start": "303900",
    "end": "310699"
  },
  {
    "text": "package sending and receiving and and network settings faces as for network",
    "start": "310699",
    "end": "317699"
  },
  {
    "text": "interfaces itself we will refer to them in the following slides but by the way an interesting topic is",
    "start": "317699",
    "end": "325500"
  },
  {
    "text": "that we should try to fast uh the high level and the low level interface at the",
    "start": "325500",
    "end": "331020"
  },
  {
    "text": "same time I have a good case two years ago for for this Mac OS Bluetooth HCI I",
    "start": "331020",
    "end": "337979"
  },
  {
    "text": "can call the the interface provided by the Bluetooth framework but talking",
    "start": "337979",
    "end": "343740"
  },
  {
    "text": "directly with the kernel means that I can bypass the checks and the restrictions from user mode",
    "start": "343740",
    "end": "350539"
  },
  {
    "text": "I mean sending raw data to Firmware directory",
    "start": "350539",
    "end": "356900"
  },
  {
    "text": "um here I listed some latest cases the xnu 80 20 branch is not on Apple's",
    "start": "358979",
    "end": "366000"
  },
  {
    "text": "official GitHub but it is important in the branch we can see the new for",
    "start": "366000",
    "end": "372600"
  },
  {
    "text": "example Nexus i o control interface Apple also has a a module called Nexus",
    "start": "372600",
    "end": "379259"
  },
  {
    "text": "in addition the the 2080 Branch contains a lot of Skywalk subsystem source code",
    "start": "379259",
    "end": "386039"
  },
  {
    "text": "such as here um Pest Control registration",
    "start": "386039",
    "end": "393539"
  },
  {
    "text": "um so we can extend our fighting framework based on this domain knowledge",
    "start": "393539",
    "end": "400259"
  },
  {
    "text": "the demand too is about interface integration I'd like to switch the",
    "start": "400259",
    "end": "406139"
  },
  {
    "text": "status or working mode of the kernel State machine randomly for different",
    "start": "406139",
    "end": "411240"
  },
  {
    "text": "network interfaces reverse engineering shows that a larger of number a large",
    "start": "411240",
    "end": "419100"
  },
  {
    "text": "number of interface support different subsystem or States at the same time",
    "start": "419100",
    "end": "424860"
  },
  {
    "text": "this also leads to the next demand I need to figure out and track which",
    "start": "424860",
    "end": "431280"
  },
  {
    "text": "interfaces are triggered and not announces the code coverage rate uh but I I actually don't want to slow",
    "start": "431280",
    "end": "439440"
  },
  {
    "text": "down the kernel so kernel in life book based the solution is acceptable acceptable to me at this stage",
    "start": "439440",
    "end": "447800"
  },
  {
    "text": "and um there are some default interfaces in the system",
    "start": "448080",
    "end": "454020"
  },
  {
    "text": "um have you uh starting program talked to them before if the answer is no I",
    "start": "454020",
    "end": "460500"
  },
  {
    "text": "think it is a time to operate the fuzzle um for example it ethernet zero is the most",
    "start": "460500",
    "end": "467639"
  },
  {
    "text": "common one AP one AP shot for access point and awdr is short for ad for",
    "start": "467639",
    "end": "475020"
  },
  {
    "text": "wireless direct link so there are all our targets",
    "start": "475020",
    "end": "482599"
  },
  {
    "text": "the next part is about xnu tested cases which can be shown here",
    "start": "482819",
    "end": "490580"
  },
  {
    "text": "I listed some of them like net agents netbridge if you haven't read these test",
    "start": "491160",
    "end": "497819"
  },
  {
    "text": "cases before I highly uh recommend you to do so as they contain potential",
    "start": "497819",
    "end": "504660"
  },
  {
    "text": "attack service so far the the new generation of Apple",
    "start": "504660",
    "end": "511820"
  },
  {
    "text": "80211 fighting framework integrates more than 40 network interfaces and attack",
    "start": "511820",
    "end": "518880"
  },
  {
    "text": "surfaces one thing I want to mention is that is the more attack surfaces covered",
    "start": "518880",
    "end": "525959"
  },
  {
    "text": "during each each test is better um I found that this is not the case",
    "start": "525959",
    "end": "531920"
  },
  {
    "text": "when they are mending random parameters the result is not as good as expected",
    "start": "531920",
    "end": "540060"
  },
  {
    "text": "so so summary number one uh for for a tap surface and domain knowledge uh we",
    "start": "540060",
    "end": "546899"
  },
  {
    "text": "need to uh accumulate as much domain knowledge as possible by learning external source code documents and test",
    "start": "546899",
    "end": "553620"
  },
  {
    "text": "cases but after we we build the further uh for each round I think we should",
    "start": "553620",
    "end": "559380"
  },
  {
    "text": "randomly select a two or three interface units and test them as fully as possible",
    "start": "559380",
    "end": "568140"
  },
  {
    "text": "the next part is related to Kernel debugging sometimes we have to rely on",
    "start": "568140",
    "end": "573480"
  },
  {
    "text": "the the power of remote kernel debugger because the information provided in the",
    "start": "573480",
    "end": "580200"
  },
  {
    "text": "Panic log is often not helpful in finding the root cause variable values",
    "start": "580200",
    "end": "586200"
  },
  {
    "text": "sometimes require Dynamic analysis um yeah this is a a vulnerability I",
    "start": "586200",
    "end": "592680"
  },
  {
    "text": "discovered last week on Apple silicon M2 Mac OS Ventura uh build number is uh 22",
    "start": "592680",
    "end": "602180"
  },
  {
    "text": "A5 311 F it's a Memory corruption uh",
    "start": "602180",
    "end": "607500"
  },
  {
    "text": "issue um I have a more detailed picture but the the armor instruction but never mind",
    "start": "607500",
    "end": "613860"
  },
  {
    "text": "uh the the arm instruction and the core stack here are actually have no valuable",
    "start": "613860",
    "end": "621660"
  },
  {
    "text": "information without the help of lldb debugger there's",
    "start": "621660",
    "end": "627240"
  },
  {
    "text": "probably no answer on Apple silicon platform we lack",
    "start": "627240",
    "end": "633899"
  },
  {
    "text": "official support the KDK document says Apple silicon does not support active",
    "start": "633899",
    "end": "640080"
  },
  {
    "text": "kernel debugging we cannot set breakpoints continue code execution",
    "start": "640080",
    "end": "645600"
  },
  {
    "text": "stabbing step over code this means that we need the help of third-party",
    "start": "645600",
    "end": "651420"
  },
  {
    "text": "debugging Solutions like Asahi Linux so here's the summary of part two",
    "start": "651420",
    "end": "659880"
  },
  {
    "text": "um yeah we need the help of of third-party solutions for Apple second",
    "start": "659880",
    "end": "665160"
  },
  {
    "text": "platform and the the previous Panic picture is a",
    "start": "665160",
    "end": "670740"
  },
  {
    "text": "there's a typical case of corruption so we need we also need kernel aggression",
    "start": "670740",
    "end": "676079"
  },
  {
    "text": "titles help uh we even need to implement uh carson-like solution to dynamically",
    "start": "676079",
    "end": "683040"
  },
  {
    "text": "monitor uh special features of third-party closed-source kernel",
    "start": "683040",
    "end": "688380"
  },
  {
    "text": "extensions um another thing I would like to discuss is that uh we have to make some fixes",
    "start": "688380",
    "end": "695760"
  },
  {
    "text": "because sometimes the building tours are or kernel kdks don't work very well",
    "start": "695760",
    "end": "702240"
  },
  {
    "text": "this is a uh one of the problem I have encountered things xnu",
    "start": "702240",
    "end": "709820"
  },
  {
    "text": "71.95 a function called console IO alert has been introduced into the kernel",
    "start": "709820",
    "end": "717920"
  },
  {
    "text": "this is uh this hardcore function will",
    "start": "717920",
    "end": "722940"
  },
  {
    "text": "check whether the system issue console i o in case of uh interrupt disabled context",
    "start": "722940",
    "end": "728519"
  },
  {
    "text": "on Windows platform such blue screen of death can be classified as IO ioqir",
    "start": "728519",
    "end": "734220"
  },
  {
    "text": "errors because we cannot access the pageable data at dispatch level",
    "start": "734220",
    "end": "740399"
  },
  {
    "text": "however the building cars and kernel will always issue such i o requests so",
    "start": "740399",
    "end": "747120"
  },
  {
    "text": "that we cannot use the kernel debugger and uh yeah and and no one complines",
    "start": "747120",
    "end": "754440"
  },
  {
    "text": "about such problems on the internet uh me either so so it seems that we all fixed this",
    "start": "754440",
    "end": "762000"
  },
  {
    "text": "kind of boxes silently and uh four years ago I open sourced a",
    "start": "762000",
    "end": "769740"
  },
  {
    "text": "Mac OS Project named the chemo I used the kerneling light hook engine to",
    "start": "769740",
    "end": "774899"
  },
  {
    "text": "implement a single uh Carson and code coverage analysis solution this time I",
    "start": "774899",
    "end": "782279"
  },
  {
    "text": "have already came on and the kernel and Colonial engine to Apple cell phone",
    "start": "782279",
    "end": "788700"
  },
  {
    "text": "platforms with schema's help I I believe we can do more",
    "start": "788700",
    "end": "794540"
  },
  {
    "text": "so here's the summary of the part number three um yeah sometimes we have to do fix this",
    "start": "794639",
    "end": "802500"
  },
  {
    "text": "because the building uh kernels or tours don't work very well",
    "start": "802500",
    "end": "807620"
  },
  {
    "text": "the last part I want to mention is uh",
    "start": "807620",
    "end": "813300"
  },
  {
    "text": "uh in this section is about the Apple SDK",
    "start": "813300",
    "end": "818639"
  },
  {
    "text": "building and the third party tours Apple SDK contain many useful information such",
    "start": "818639",
    "end": "825899"
  },
  {
    "text": "as Wi-Fi related head files and and data structures",
    "start": "825899",
    "end": "831740"
  },
  {
    "text": "which will save a lot of time for reverse engineering in addition",
    "start": "831740",
    "end": "837180"
  },
  {
    "text": "uh many interesting command line Force are are built in the Mac OS operating",
    "start": "837180",
    "end": "842700"
  },
  {
    "text": "system such as airport and the Skywalk control you know there are potential",
    "start": "842700",
    "end": "850440"
  },
  {
    "text": "targets by the way uh the the Wi-Fi developer",
    "start": "850440",
    "end": "856560"
  },
  {
    "text": "Community has been maintaining the interface and the feature list and I",
    "start": "856560",
    "end": "862620"
  },
  {
    "text": "think we should contribute to the latest kind of change to the community when we",
    "start": "862620",
    "end": "867839"
  },
  {
    "text": "have time last time I I reversed the interface like uh this one sky Skywalker",
    "start": "867839",
    "end": "876240"
  },
  {
    "text": "link State and this time for example the the",
    "start": "876240",
    "end": "882320"
  },
  {
    "text": "Au 1a4 remote camera set is the latest",
    "start": "882320",
    "end": "887639"
  },
  {
    "text": "change yeah so far we have discussed four",
    "start": "887639",
    "end": "894240"
  },
  {
    "text": "accepts about network interface and attack surfaces about static analysis uh",
    "start": "894240",
    "end": "901920"
  },
  {
    "text": "static and dynamic analysis methods creaking tours and and the rest if we",
    "start": "901920",
    "end": "907620"
  },
  {
    "text": "put everything together uh we will get a roadmap for building a new generation of",
    "start": "907620",
    "end": "915000"
  },
  {
    "text": "Wi-Fi password so this is a overall architecture of the",
    "start": "915000",
    "end": "923100"
  },
  {
    "text": "system from user mode to Kernel mode from high level interface to to low",
    "start": "923100",
    "end": "930779"
  },
  {
    "text": "level interface and attack surfaces from Target to host the machine",
    "start": "930779",
    "end": "937139"
  },
  {
    "text": "it's a it's a it's a big picture yeah and I have a short video I will",
    "start": "937139",
    "end": "947100"
  },
  {
    "text": "show you how it works [Music] um yeah this is what we do",
    "start": "947100",
    "end": "954120"
  },
  {
    "text": "um on the left is the is a target machine and the on the right side is the",
    "start": "954120",
    "end": "959880"
  },
  {
    "text": "host machine they are connected by uh some part 3 to ethernet adapter the",
    "start": "959880",
    "end": "968459"
  },
  {
    "text": "under uh the the operating systems version is a",
    "start": "972839",
    "end": "978480"
  },
  {
    "text": "Mac OS Ventura build number is uh 22A 5",
    "start": "978480",
    "end": "985199"
  },
  {
    "text": "3 11 F the latest one when I made in this video",
    "start": "985199",
    "end": "991139"
  },
  {
    "text": "um and then let me run the from my father",
    "start": "991139",
    "end": "997079"
  },
  {
    "text": "here and",
    "start": "997079",
    "end": "1002899"
  },
  {
    "text": "the kernel crash and the immediately and the interrupts to the debugger",
    "start": "1002899",
    "end": "1009860"
  },
  {
    "text": "yeah and the CPU was created um yeah this is a one of my their day",
    "start": "1009860",
    "end": "1015440"
  },
  {
    "text": "vulnerability but the information here is useless don't be worried",
    "start": "1015440",
    "end": "1022060"
  },
  {
    "text": "okay let's back to the slides",
    "start": "1024140",
    "end": "1028600"
  },
  {
    "text": "um in the next reception now let's say um what's the price we have this time",
    "start": "1029540",
    "end": "1036459"
  },
  {
    "text": "we apologize for the interruption uh please bear with us",
    "start": "1036459",
    "end": "1043058"
  },
  {
    "text": "uh can you see my screen",
    "start": "1048079",
    "end": "1051280"
  },
  {
    "text": "uh okay uh so let me continue",
    "start": "1054679",
    "end": "1063799"
  },
  {
    "text": "okay um this is some of the kernel vulnerable here I have reported and the some of",
    "start": "1063799",
    "end": "1071120"
  },
  {
    "text": "which have been uh assigned CV IDs like uh this one uh 32 837 we will say it",
    "start": "1071120",
    "end": "1078980"
  },
  {
    "text": "later uh vulnerabilities uh cve 2020 98 99 and",
    "start": "1078980",
    "end": "1087320"
  },
  {
    "text": "the 2020 113. haven't we fixed before blackhead USA",
    "start": "1087320",
    "end": "1092480"
  },
  {
    "text": "2020s so so I cannot share their details two years ago since these two kernel",
    "start": "1092480",
    "end": "1098960"
  },
  {
    "text": "vulnerabilities are very interesting so uh the the case study part will start",
    "start": "1098960",
    "end": "1104660"
  },
  {
    "text": "with them and similarly there are uh also some vulnerabilities that haven't been fixed",
    "start": "1104660",
    "end": "1111620"
  },
  {
    "text": "in time this year so I hope we can continue the topic uh maybe next year or",
    "start": "1111620",
    "end": "1117260"
  },
  {
    "text": "next time the first category we are going to",
    "start": "1117260",
    "end": "1122539"
  },
  {
    "text": "discuss is the kernel stack based debuff or floor one rability",
    "start": "1122539",
    "end": "1128240"
  },
  {
    "text": "um 2020 98 99 set Rome profile the patch",
    "start": "1128240",
    "end": "1133580"
  },
  {
    "text": "information is here [Music] um and the reverse engineering shows that",
    "start": "1133580",
    "end": "1140960"
  },
  {
    "text": "uh the vulnerability is related to broadcom's OS independent layer OSL here",
    "start": "1140960",
    "end": "1148640"
  },
  {
    "text": "we can see a function named the OSL arrow and the input parameter is the",
    "start": "1148640",
    "end": "1155020"
  },
  {
    "text": "broadcom arrow and as we can see here",
    "start": "1155020",
    "end": "1161500"
  },
  {
    "text": "this Legacy code uses by to byte assignment assignment",
    "start": "1161500",
    "end": "1168200"
  },
  {
    "text": "instead of string save string copy functions I I think because it's a",
    "start": "1168200",
    "end": "1175100"
  },
  {
    "text": "Legacy code I think a compilation of this Legacy code with",
    "start": "1175100",
    "end": "1181100"
  },
  {
    "text": "iocates must be a challenge and and the root cause may be related to the the the",
    "start": "1181100",
    "end": "1188299"
  },
  {
    "text": "the compiler or something um and then the the most important thing",
    "start": "1188299",
    "end": "1195440"
  },
  {
    "text": "is uh the wonderful function mistakenly trusted the input parameter and treat it",
    "start": "1195440",
    "end": "1201260"
  },
  {
    "text": "as the active condition of the assignment Loop here",
    "start": "1201260",
    "end": "1207320"
  },
  {
    "text": "so here's the information where the kernel crash uh the current instruction",
    "start": "1207320",
    "end": "1214580"
  },
  {
    "text": "is returned and the RBP uh at this point",
    "start": "1214580",
    "end": "1221419"
  },
  {
    "text": "is uh is pointed to 8p8 yeah here 8p8 and this one should be",
    "start": "1221419",
    "end": "1229520"
  },
  {
    "text": "written address and this one should be uh RS the RBP so we can that means we",
    "start": "1229520",
    "end": "1237260"
  },
  {
    "text": "can control our AP and and the uh our RBP so yeah you can see here uh I",
    "start": "1237260",
    "end": "1245240"
  },
  {
    "text": "already overwrite the RBP register um and here there's no uh kernel uh",
    "start": "1245240",
    "end": "1253880"
  },
  {
    "text": "connect uh Canary protection in the stack so I think it's a related to the",
    "start": "1253880",
    "end": "1261919"
  },
  {
    "text": "Legacy code um a frequency ask the question is does",
    "start": "1261919",
    "end": "1268220"
  },
  {
    "text": "stack based debuffle for vulnerabilities do make sense today a good example comes",
    "start": "1268220",
    "end": "1273260"
  },
  {
    "text": "from the penguin team uh CV turning 20 19",
    "start": "1273260",
    "end": "1279220"
  },
  {
    "text": "8648 in that case air LVN insert Canary",
    "start": "1279220",
    "end": "1284360"
  },
  {
    "text": "in a wrong position another case worth measuring is uh this one",
    "start": "1284360",
    "end": "1291460"
  },
  {
    "text": "uh exportation of Kernel step-based buffer floor in the real world is not as",
    "start": "1291460",
    "end": "1297500"
  },
  {
    "text": "straightforward as in the books especially when you don't have a kind of debugger",
    "start": "1297500",
    "end": "1302960"
  },
  {
    "text": "so um set-based debuffle for wonderability can still be seen today especially in",
    "start": "1302960",
    "end": "1309080"
  },
  {
    "text": "the physical and for 1999 the warnable function has no step cookie production",
    "start": "1309080",
    "end": "1315159"
  },
  {
    "text": "we can control local variable RBP and even iip register",
    "start": "1315159",
    "end": "1322299"
  },
  {
    "text": "two years have passed uh you might ask are there still such high quality kernel",
    "start": "1322460",
    "end": "1330500"
  },
  {
    "text": "stack based overall right vulnerabilities definitely this time we have the CV 2032",
    "start": "1330500",
    "end": "1340659"
  },
  {
    "text": "uh 32847 the vulnerability affects iOS 15.6",
    "start": "1340659",
    "end": "1348320"
  },
  {
    "text": "Mac OS modeling and other platforms",
    "start": "1348320",
    "end": "1354158"
  },
  {
    "text": "uh 32847 is related to a Bluetooth",
    "start": "1355340",
    "end": "1360799"
  },
  {
    "text": "profile and configure features in short a stack based variable are parsed",
    "start": "1360799",
    "end": "1368240"
  },
  {
    "text": "between functions but the warnable function mistakenly treats them as normal and The Trusted inputs",
    "start": "1368240",
    "end": "1376640"
  },
  {
    "text": "Computing based on this trust can lead to serious problem",
    "start": "1376640",
    "end": "1382820"
  },
  {
    "text": "um yeah I have a panic information here's the information about the",
    "start": "1382820",
    "end": "1390220"
  },
  {
    "text": "chronographs you can say RBX here is",
    "start": "1390220",
    "end": "1395720"
  },
  {
    "text": "um actually a stack based variable and the processing of",
    "start": "1395720",
    "end": "1402280"
  },
  {
    "text": "parsing can be controlled for example the rcx we can control that value so",
    "start": "1402280",
    "end": "1410559"
  },
  {
    "text": "it's a it's a stack based calculation and",
    "start": "1410559",
    "end": "1416620"
  },
  {
    "text": "finally to uh kernel stack over rate and overwrite",
    "start": "1416620",
    "end": "1424720"
  },
  {
    "text": "so for for this case I would say um kernel stack or kernel stack override",
    "start": "1424940",
    "end": "1431900"
  },
  {
    "text": "vulnerability represented by uh 32 847 can often be found the root cause is",
    "start": "1431900",
    "end": "1438799"
  },
  {
    "text": "related to stack-based variables being passed and used for for calculation or",
    "start": "1438799",
    "end": "1445280"
  },
  {
    "text": "policy but the data in the uh in the local variable as controlled by",
    "start": "1445280",
    "end": "1454039"
  },
  {
    "text": "user mode or malicious input so um yeah this this is a root cause and",
    "start": "1454039",
    "end": "1461000"
  },
  {
    "text": "the uh the stack canneries solution Canary solution",
    "start": "1461000",
    "end": "1467059"
  },
  {
    "text": "cannot solve all the problems the next category is arbitrary memory",
    "start": "1467059",
    "end": "1474500"
  },
  {
    "text": "rights vulnerability and the first case is uh cve 2020 113.",
    "start": "1474500",
    "end": "1483799"
  },
  {
    "text": "um yeah here's the patch information uh for example iOS 14 and the Mac oscarina",
    "start": "1485120",
    "end": "1494260"
  },
  {
    "text": "ink shots um the the wheels kernel space boundary",
    "start": "1495080",
    "end": "1500240"
  },
  {
    "text": "condition caused this vulnerability reverse engineering shows that there are",
    "start": "1500240",
    "end": "1507799"
  },
  {
    "text": "two branches uh one is one is uh here if",
    "start": "1507799",
    "end": "1513919"
  },
  {
    "text": "the input parameter is from user mode uh it needs to enter enter here the copy",
    "start": "1513919",
    "end": "1522140"
  },
  {
    "text": "out branch and if the input parameter is from kernel mode is I need to enter the",
    "start": "1522140",
    "end": "1528020"
  },
  {
    "text": "memory move Branch so here search boundary condition is",
    "start": "1528020",
    "end": "1534500"
  },
  {
    "text": "critical in my opinion this is not time not the time to do a freestyle",
    "start": "1534500",
    "end": "1543559"
  },
  {
    "text": "um as you can see here the RDI register the",
    "start": "1543559",
    "end": "1549260"
  },
  {
    "text": "value in the RDI register can bypass that weld check a check so",
    "start": "1549260",
    "end": "1556700"
  },
  {
    "text": "um so so don't let the defensive ends Showtime uh turning to a show stopper",
    "start": "1556700",
    "end": "1564799"
  },
  {
    "text": "and and the cost deck is like this um we yeah that makes very very uh go to",
    "start": "1564799",
    "end": "1572659"
  },
  {
    "text": "the memory move range and uh but this parameter can be",
    "start": "1572659",
    "end": "1579020"
  },
  {
    "text": "controlled from user mode next",
    "start": "1579020",
    "end": "1585260"
  },
  {
    "text": "um combined with kernel information disclosure vulnerability a complete local EOP chain can be formed a good",
    "start": "1585260",
    "end": "1592700"
  },
  {
    "text": "information disclosure example I I can share is the 2020",
    "start": "1592700",
    "end": "1598539"
  },
  {
    "text": "98-33 uh here is a link if you are interested",
    "start": "1598539",
    "end": "1604539"
  },
  {
    "text": "so for uh CBE 2020 uh 130 I would say",
    "start": "1606260",
    "end": "1612559"
  },
  {
    "text": "um this is a arbitrary memory right wonder if it is caused by a boundary checking",
    "start": "1612559",
    "end": "1618919"
  },
  {
    "text": "error and the the value to be writing is controllable or predictable uh combined",
    "start": "1618919",
    "end": "1626240"
  },
  {
    "text": "with kernel information disclosure vulnerability a complete local EOP chain export chain can be firmed and the right",
    "start": "1626240",
    "end": "1634279"
  },
  {
    "text": "primitive is stable and does not require heat potential manipulation the the and the the last one is the",
    "start": "1634279",
    "end": "1643520"
  },
  {
    "text": "interesting part this vulnerability of facts hand resolve",
    "start": "1643520",
    "end": "1648640"
  },
  {
    "text": "Apple bcmwmw wln Core debugger handlers",
    "start": "1648640",
    "end": "1656840"
  },
  {
    "text": "actually it's about 200 handlers and uh yeah two years have passed are",
    "start": "1656840",
    "end": "1666320"
  },
  {
    "text": "they still such high quality arbitrary kernel memory rights vulnerabilities",
    "start": "1666320",
    "end": "1671620"
  },
  {
    "text": "definitely this time we have the cve 2022 to",
    "start": "1671620",
    "end": "1678580"
  },
  {
    "text": "6762 get RX rate also uh effective affecting iOS",
    "start": "1678580",
    "end": "1687880"
  },
  {
    "text": "15.5 and the Mac OS monetary",
    "start": "1687880",
    "end": "1693039"
  },
  {
    "text": "um yeah for this case uh one sentence is enough to explain the root cause",
    "start": "1693260",
    "end": "1699799"
  },
  {
    "text": "the vulnerable function for goes to sanitize user mode pointer or address",
    "start": "1699799",
    "end": "1706059"
  },
  {
    "text": "and I also listed several uh function should be should be called",
    "start": "1706059",
    "end": "1713500"
  },
  {
    "text": "on when on Mac osrs and FreeBSD platform which we use copying and copy out Linux",
    "start": "1713500",
    "end": "1721279"
  },
  {
    "text": "kernel if you use a copy from user and copy to user and on Windows kernel",
    "start": "1721279",
    "end": "1727640"
  },
  {
    "text": "um may we should uh use the proper read and proper right",
    "start": "1727640",
    "end": "1734559"
  },
  {
    "text": "yeah here is the the cost act um in other words the kernel will write",
    "start": "1734559",
    "end": "1741919"
  },
  {
    "text": "data to Banning address you provide the the RBX is a target address and the",
    "start": "1741919",
    "end": "1749779"
  },
  {
    "text": "Rex is a it's a fixed value [Music]",
    "start": "1749779",
    "end": "1755380"
  },
  {
    "text": "but it just happened",
    "start": "1755380",
    "end": "1759460"
  },
  {
    "text": "so summary of case number two um compared with 113 the root cause of",
    "start": "1760820",
    "end": "1767980"
  },
  {
    "text": "26762 is simpler but the wonderful functions progress to sanitize usable",
    "start": "1767980",
    "end": "1773840"
  },
  {
    "text": "pointer um the but this simple simple and the stable",
    "start": "1773840",
    "end": "1779720"
  },
  {
    "text": "kernel vulnerability are powerful they are perfect for part one um and for this case the the value to be",
    "start": "1779720",
    "end": "1786860"
  },
  {
    "text": "writing is fixed um so because I am also a kind of",
    "start": "1786860",
    "end": "1792140"
  },
  {
    "text": "developer so uh kernel vulnerability caused by copying copy out to copy from",
    "start": "1792140",
    "end": "1797539"
  },
  {
    "text": "user to user corporate copyright are very common um kernel developers should",
    "start": "1797539",
    "end": "1804100"
  },
  {
    "text": "carefully check all the input parameters yeah all all the input are potentially",
    "start": "1804100",
    "end": "1812360"
  },
  {
    "text": "harmful the next category is the most common",
    "start": "1812360",
    "end": "1820220"
  },
  {
    "text": "um kernel Heap Auto bonds read and write vulnerability and I can share with you",
    "start": "1820220",
    "end": "1825860"
  },
  {
    "text": "two cases um 2022 30 to 837 and and it's 60. uh",
    "start": "1825860",
    "end": "1836000"
  },
  {
    "text": "yeah iOS and Mac OS Monterey foreign",
    "start": "1836000",
    "end": "1842740"
  },
  {
    "text": "I can set the lens to any data for example if you CDF",
    "start": "1847000",
    "end": "1853100"
  },
  {
    "text": "um and this is a the test on the Intel based platform and the cost app is uh is",
    "start": "1853100",
    "end": "1859100"
  },
  {
    "text": "related to memory copy and yeah this this is a stack on Apple silicon",
    "start": "1859100",
    "end": "1867080"
  },
  {
    "text": "um yeah setting the lens to for example that beef uh means the paranoid is",
    "start": "1867080",
    "end": "1873679"
  },
  {
    "text": "definitely going to die um yeah but this kind of uh",
    "start": "1873679",
    "end": "1880299"
  },
  {
    "text": "vulnerability is very easy to be to be captured by a kernel debugger but for",
    "start": "1880299",
    "end": "1886159"
  },
  {
    "text": "this one for the for the second one um 2020 32 860.",
    "start": "1886159",
    "end": "1895279"
  },
  {
    "text": "um for this case the total number of autobahns is not enough to to cause a kernel panic uh it's just a read uh",
    "start": "1895279",
    "end": "1903100"
  },
  {
    "text": "several bytes over the uh keep objects uh or write to that HIPAA",
    "start": "1903100",
    "end": "1910580"
  },
  {
    "text": "object so in this case we need the help of Kernel address standard python but",
    "start": "1910580",
    "end": "1915860"
  },
  {
    "text": "before that we need to fix the the Panic problems in kernel cars and kernel as",
    "start": "1915860",
    "end": "1924080"
  },
  {
    "text": "mentioned in the second section okay Samurai um I would say this type of",
    "start": "1924080",
    "end": "1931700"
  },
  {
    "text": "vulnerability can be easily captured by uh kernel address sanitizer and the the",
    "start": "1931700",
    "end": "1938480"
  },
  {
    "text": "the exploitation of the vulnerabilities usually requires skills uh such as hip",
    "start": "1938480",
    "end": "1944840"
  },
  {
    "text": "friendship and I have a good kernel hip friendship example uh ID is cve 2015",
    "start": "1944840",
    "end": "1953659"
  },
  {
    "text": "0057 here is the link and the root cause of this vulnerability are related to a",
    "start": "1953659",
    "end": "1960620"
  },
  {
    "text": "lot of reasons for example the lack of effective input verification logical",
    "start": "1960620",
    "end": "1967520"
  },
  {
    "text": "errors uh integral workflow yeah and so on",
    "start": "1967520",
    "end": "1973059"
  },
  {
    "text": "the last case is a type confusion vulnerability yeah",
    "start": "1973059",
    "end": "1978550"
  },
  {
    "text": "[Music] monetary and pixel",
    "start": "1978550",
    "end": "1983860"
  },
  {
    "text": "packet and the function is related to update broadcaster MI",
    "start": "1983860",
    "end": "1991899"
  },
  {
    "text": "so um yeah eshops the first parameter of the function",
    "start": "1991940",
    "end": "1997960"
  },
  {
    "text": "update broadcaster Mi is defined defined as the",
    "start": "1997960",
    "end": "2004480"
  },
  {
    "text": "um a Skywalker interface and this object the size of this object is very big is",
    "start": "2004480",
    "end": "2012399"
  },
  {
    "text": "greater than uh 6800 bytes in HEX",
    "start": "2012399",
    "end": "2019000"
  },
  {
    "text": "um and I I dumped that object uh however things get completed uh when",
    "start": "2019000",
    "end": "2026500"
  },
  {
    "text": "a function tries to support different subsystems or interface",
    "start": "2026500",
    "end": "2031679"
  },
  {
    "text": "please note that the following object is much",
    "start": "2031679",
    "end": "2036960"
  },
  {
    "text": "smaller than 6 30. so we can say um yeah here there are two different",
    "start": "2036960",
    "end": "2043659"
  },
  {
    "text": "objects and the the value here is different indicated it's a different",
    "start": "2043659",
    "end": "2050440"
  },
  {
    "text": "type so five minutes Mr Wang five minutes",
    "start": "2050440",
    "end": "2057339"
  },
  {
    "text": "okay um and therefore High confusion means this kind of computer means Autobarn",
    "start": "2057339",
    "end": "2063158"
  },
  {
    "text": "access so um yeah because this one is a smaller object and uh it doesn't have uh",
    "start": "2063159",
    "end": "2069700"
  },
  {
    "text": "six thousand bytes so it's a uh Auto bomb access and a Autobahn read and",
    "start": "2069700",
    "end": "2075460"
  },
  {
    "text": "write issue um after reviewing the patch of this one",
    "start": "2075460",
    "end": "2083500"
  },
  {
    "text": "two six seven six one I found there is still a non-point reference bug in the",
    "start": "2083500",
    "end": "2089800"
  },
  {
    "text": "one book function um by the way I found a lot of non-plying the reference box uh",
    "start": "2089800",
    "end": "2095378"
  },
  {
    "text": "sometimes I have to report them because they significantly slow down my fighting",
    "start": "2095379",
    "end": "2100540"
  },
  {
    "text": "effort um yeah here's a it's a summary for this case uh callback functions especially",
    "start": "2100540",
    "end": "2107380"
  },
  {
    "text": "those that's four different architectures interface or working modes",
    "start": "2107380",
    "end": "2113099"
  },
  {
    "text": "and state machine and the exception handling need to be carefully designed",
    "start": "2113099",
    "end": "2120160"
  },
  {
    "text": "um and the corner case matter Spirit Patrick is worth auditing",
    "start": "2120160",
    "end": "2126880"
  },
  {
    "text": "one more things um uh follow-up ID uh 0706 is related to",
    "start": "2126880",
    "end": "2134200"
  },
  {
    "text": "Kernel Heap autobahn's right and the follow-up ID 30 17 is related to arbitrary memory",
    "start": "2134200",
    "end": "2141160"
  },
  {
    "text": "access I reported them recently um and four uh 3017 as far as I know",
    "start": "2141160",
    "end": "2150040"
  },
  {
    "text": "this is the second time in two years or maybe three years that's the same",
    "start": "2150040",
    "end": "2155920"
  },
  {
    "text": "function has been found to be vulnerable um and here are other good examples",
    "start": "2155920",
    "end": "2162440"
  },
  {
    "text": "[Music] this one 98-34 uh yeah it's also Wi-Fi",
    "start": "2162440",
    "end": "2168880"
  },
  {
    "text": "subsystem uh as far as I know second time to be found vulnerable and this",
    "start": "2168880",
    "end": "2174220"
  },
  {
    "text": "one's 39 12 um it's about uh a Bluetooth HCI",
    "start": "2174220",
    "end": "2181660"
  },
  {
    "text": "interface it's a third time in history the same function has been found to be",
    "start": "2181660",
    "end": "2186700"
  },
  {
    "text": "vulnerable so yeah so I think um",
    "start": "2186700",
    "end": "2193320"
  },
  {
    "text": "some handlers with complex logical will be introduced with new vulnerability",
    "start": "2195839",
    "end": "2203020"
  },
  {
    "text": "every once in a while uh even if the old ones have just been fixed so yeah",
    "start": "2203020",
    "end": "2211180"
  },
  {
    "text": "yeah last part takeaways and the end um from the perspective of Kernel",
    "start": "2211180",
    "end": "2218380"
  },
  {
    "text": "development um I would say apple has made a lot of efforts",
    "start": "2218380",
    "end": "2223480"
  },
  {
    "text": "um and the security of Mac OS and iOS has been significantly improved and all",
    "start": "2223480",
    "end": "2230920"
  },
  {
    "text": "includes are potentially harmful as kernel developers we should carefully",
    "start": "2230920",
    "end": "2238420"
  },
  {
    "text": "check all the input parameters and the newer features always means new attack",
    "start": "2238420",
    "end": "2244180"
  },
  {
    "text": "service um yeah callback exception handle instant machine need to be carefully",
    "start": "2244180",
    "end": "2249760"
  },
  {
    "text": "designed and form a perspective of vulnerability",
    "start": "2249760",
    "end": "2255579"
  },
  {
    "text": "research I have listed six points",
    "start": "2255579",
    "end": "2261780"
  },
  {
    "text": "um and they have basically been mentioned earlier uh the last one is uh",
    "start": "2261820",
    "end": "2268780"
  },
  {
    "text": "yeah From perspective of security engineering and vulnerability accounting uh yeah I would say if you have done a",
    "start": "2268780",
    "end": "2278200"
  },
  {
    "text": "point from point one to point four for example uh integrate interface and",
    "start": "2278200",
    "end": "2283359"
  },
  {
    "text": "attack surfaces include kernel address Enticer called coverage analysis for and",
    "start": "2283359",
    "end": "2289900"
  },
  {
    "text": "the part useful tools to to Apple silicon platform",
    "start": "2289900",
    "end": "2295000"
  },
  {
    "text": "um yeah combined all all available means such as reverse engineering kernel debugging",
    "start": "2295000",
    "end": "2301859"
  },
  {
    "text": "access new resources SDK KDK third party tours um if you have done this or just studied",
    "start": "2301859",
    "end": "2309099"
  },
  {
    "text": "you will find um Apple did a lot of work but the results seem to be similar to 2030.",
    "start": "2309099",
    "end": "2317920"
  },
  {
    "text": "um but you know we have seen we all have seen apples and apple silicon's progress",
    "start": "2317920",
    "end": "2324280"
  },
  {
    "text": "so yeah let's keep going yeah thank you that's my presentation",
    "start": "2324280",
    "end": "2329920"
  },
  {
    "text": "thank you for your time [Music]",
    "start": "2329920",
    "end": "2336040"
  },
  {
    "text": "[Music]",
    "start": "2339890",
    "end": "2342980"
  }
]