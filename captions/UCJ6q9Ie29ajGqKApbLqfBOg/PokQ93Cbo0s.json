[
  {
    "start": "0",
    "end": "89000"
  },
  {
    "text": "my name is kong this is the talk on the virtual appliance detection",
    "start": "80",
    "end": "6960"
  },
  {
    "text": "what i'm going to try to tell tell you during the talk is some of our preliminary efforts of detecting",
    "start": "6960",
    "end": "14559"
  },
  {
    "text": "virtual appliances using webscript i'm also going to briefly mention some other technique",
    "start": "14559",
    "end": "20320"
  },
  {
    "text": "in general to detect virtual virtual machines this is a joint work with xiaoning who",
    "start": "20320",
    "end": "26560"
  },
  {
    "text": "unfortunately cannot come to singapore for both work and visa issues",
    "start": "26560",
    "end": "33439"
  },
  {
    "text": "now i'm going to start with a quick introduction about us first again my name is cong lee i'm a",
    "start": "33760",
    "end": "40160"
  },
  {
    "text": "college educator i work for university georgia i'm a faculty there",
    "start": "40160",
    "end": "45680"
  },
  {
    "text": "and i teach regularly uh the computer security courses",
    "start": "45680",
    "end": "50879"
  },
  {
    "text": "i'm also a member of the team dissect i don't know how many of you here play ctf",
    "start": "50879",
    "end": "57280"
  },
  {
    "text": "and if you play ctf you might run into our team you know uh occasionally i would play",
    "start": "57280",
    "end": "62879"
  },
  {
    "text": "colgate and defcon and so on that's about me",
    "start": "62879",
    "end": "68000"
  },
  {
    "text": "so xiaoning is uh he's from industry he is a senior security researcher",
    "start": "68000",
    "end": "75360"
  },
  {
    "text": "he has been doing malware analysis for more than a decade my collaborative collaboration with",
    "start": "75360",
    "end": "81520"
  },
  {
    "text": "johnny is great in the sense that he did all the hard work and i come here to give the talk",
    "start": "81520",
    "end": "88479"
  },
  {
    "text": "okay anyway let's start so first i'm going to give a quick introduction about virtualization i'm",
    "start": "88479",
    "end": "94400"
  },
  {
    "start": "89000",
    "end": "89000"
  },
  {
    "text": "pretty sure all of you know about this just this is just for clever clarification on",
    "start": "94400",
    "end": "99600"
  },
  {
    "text": "the terminologies so i have a picture here which is a",
    "start": "99600",
    "end": "104640"
  },
  {
    "text": "over simplified version of virtualization i have what i have here at the very bottom",
    "start": "104640",
    "end": "110079"
  },
  {
    "text": "is the physical machine which is the you know the silicon all the devices okay and on top of that",
    "start": "110079",
    "end": "116399"
  },
  {
    "text": "we have this hypervisor and sometimes we call vmm and then you have the virtual machine",
    "start": "116399",
    "end": "122000"
  },
  {
    "text": "run uh on top of it you have the gas operating system and then the applications",
    "start": "122000",
    "end": "127439"
  },
  {
    "text": "now one thing i want to clarify about the hypervisor part is that the hypervisor actually comes in",
    "start": "127439",
    "end": "134239"
  },
  {
    "text": "multiple mode actually i start here echo like can you guys hear me clearly",
    "start": "134239",
    "end": "139920"
  },
  {
    "text": "okay so uh in terms of hypervisor there are really",
    "start": "139920",
    "end": "145520"
  },
  {
    "text": "at least two different modes one is sometimes you can have a piece of software running directly on top of this",
    "start": "145520",
    "end": "151920"
  },
  {
    "text": "uh physical machine and all this hypervirus does is just to",
    "start": "151920",
    "end": "157040"
  },
  {
    "text": "manage vm so this is what we call a type one hypervisor you can also have a basically",
    "start": "157040",
    "end": "163920"
  },
  {
    "text": "a regular operating system running there then on top of it you run a piece of software i guess for",
    "start": "163920",
    "end": "169519"
  },
  {
    "text": "most end users like for example i run vmware fusion on my macbook",
    "start": "169519",
    "end": "174800"
  },
  {
    "text": "that's what we call the type 2 uh hypervisor now to make it more concrete you",
    "start": "174800",
    "end": "181360"
  },
  {
    "text": "probably are you know as a user you probably use one of these and i just have a list of uh virtual",
    "start": "181360",
    "end": "189120"
  },
  {
    "text": "virtual machine provider or virtual machine platform provider i have a list here and",
    "start": "189120",
    "end": "195440"
  },
  {
    "text": "including vmware virtualbox okay you can't have you know use some of those",
    "start": "195440",
    "end": "201680"
  },
  {
    "text": "one thing i want to clarify that some of these vendors they actually produce multiple type of",
    "start": "202080",
    "end": "208159"
  },
  {
    "text": "hypervisors for example vmware you have vmware esx",
    "start": "208159",
    "end": "213360"
  },
  {
    "text": "which is a type 1 hypervisor it runs on top of physical hardware and then",
    "start": "213360",
    "end": "218480"
  },
  {
    "text": "manage virtual machines and for regular users",
    "start": "218480",
    "end": "223840"
  },
  {
    "text": "at their desktop likely you're using the other type of product from vmware",
    "start": "223840",
    "end": "228879"
  },
  {
    "text": "like vmware fusion vmware player and you know silver those are a piece of",
    "start": "228879",
    "end": "234799"
  },
  {
    "text": "software run on top of your windows linux then you can run a guest os within it okay now",
    "start": "234799",
    "end": "242239"
  },
  {
    "text": "so far all the description is about virtual machines and in fact you know before i came here",
    "start": "242239",
    "end": "248239"
  },
  {
    "text": "gave the talk there actually already people emailed me to say are you going to talk about virtual machine or are you going to talk about virtual appliance",
    "start": "248239",
    "end": "254879"
  },
  {
    "text": "so i need to make some clarification about what is virtual appliance",
    "start": "254879",
    "end": "260400"
  },
  {
    "start": "255000",
    "end": "255000"
  },
  {
    "text": "so i use this picture to show what is virtual appliance our understanding is that virtual",
    "start": "260400",
    "end": "267040"
  },
  {
    "text": "appliance is actually one special type of virtual machines let me talk about virtual machines",
    "start": "267040",
    "end": "273120"
  },
  {
    "text": "we usually just consider we're gonna run some gas operating system and likely you're actually gonna run",
    "start": "273120",
    "end": "278720"
  },
  {
    "text": "multiple applications within that gas os okay you don't really care too much you know what's running there",
    "start": "278720",
    "end": "286080"
  },
  {
    "text": "virtual appliance are some special type of virtual machines likely you really want",
    "start": "286080",
    "end": "293919"
  },
  {
    "text": "to run something in isolation for example if if you are doing more analysis let's",
    "start": "293919",
    "end": "299520"
  },
  {
    "text": "say you have multiple samples if you want to run them you want to test them you don't want to load all of them",
    "start": "299520",
    "end": "305680"
  },
  {
    "text": "in one vm you want to load one in each in individual one right so that when you analyze them",
    "start": "305680",
    "end": "312160"
  },
  {
    "text": "there's you know complete isolation okay so that's one place you want you know uh virtual appliance",
    "start": "312160",
    "end": "318639"
  },
  {
    "text": "another possibility is that maybe you have an old piece of software it's only maybe running only on windows 95 you don't",
    "start": "318639",
    "end": "325360"
  },
  {
    "text": "want to run any other thing on on top of it so virtual appliance are a bunch of virtual machines that",
    "start": "325360",
    "end": "331440"
  },
  {
    "text": "been tailored to run specific applications",
    "start": "331440",
    "end": "336560"
  },
  {
    "text": "and uh this tailoring require maybe some modification in the vm sometime also including the operating",
    "start": "336560",
    "end": "343199"
  },
  {
    "text": "system modification and even application stack for example if you are doing mirror analysis and you might want",
    "start": "343199",
    "end": "351120"
  },
  {
    "text": "to you know someone that actually does this i could mention the the name of vendor but what they do is they actually lower",
    "start": "351120",
    "end": "357440"
  },
  {
    "text": "the protection level in the vm so that they actually can see what's the",
    "start": "357440",
    "end": "362800"
  },
  {
    "text": "behavior there some some other virtual appliances also add the auto auto it kind of function if there are",
    "start": "362800",
    "end": "369520"
  },
  {
    "text": "any pop-up they cannot click it immediately automatically so those are the case",
    "start": "369520",
    "end": "376720"
  },
  {
    "text": "about virtual appliance those are the specially built virtual machines now hopefully with this",
    "start": "376720",
    "end": "383039"
  },
  {
    "text": "part clear now let's go to the real question uh go to the",
    "start": "383039",
    "end": "388080"
  },
  {
    "text": "detection about virtual appliance and about you know why i want to do this and then you know how we're going to do",
    "start": "388080",
    "end": "393759"
  },
  {
    "text": "this so why do we want to detect virtual appliance",
    "start": "393759",
    "end": "398960"
  },
  {
    "text": "i want to actually bring up first uh talk about you know a brief overview about why i want to detect vm",
    "start": "399120",
    "end": "404720"
  },
  {
    "text": "okay because virtual appliance is really just a special case of you know virtual machine so there are",
    "start": "404720",
    "end": "411440"
  },
  {
    "text": "actually tons of work uh on the detection of virtual machines and when seanan and i work on this we",
    "start": "411440",
    "end": "417919"
  },
  {
    "text": "initially we try to actually come up uh with a list of you know how the prior work we actually put into group",
    "start": "417919",
    "end": "424800"
  },
  {
    "text": "there are just so many of the work in the past okay and uh so i'm going to simply pick",
    "start": "424800",
    "end": "430960"
  },
  {
    "text": "one or two a few motivation and tell you why people want to detect vm in the past",
    "start": "430960",
    "end": "436880"
  },
  {
    "text": "so this is uh one of the luxuries and people say why a regular user might want to tell",
    "start": "436880",
    "end": "443599"
  },
  {
    "text": "am i running on a vm or i'm running on a physical machine so in nowadays like this is the virtual",
    "start": "443599",
    "end": "451120"
  },
  {
    "text": "private hosting or virtual private silver is so popular in early days like you know when people rent a machine they",
    "start": "451120",
    "end": "458160"
  },
  {
    "text": "actually have consideration about whether they want to have a physical box dedicated silver or they won't have a",
    "start": "458160",
    "end": "464960"
  },
  {
    "text": "virtual one okay and the price are different uh but from and the user point of view when you you",
    "start": "464960",
    "end": "471759"
  },
  {
    "text": "know get into a machine remotely it can it's it's not obvious at least",
    "start": "471759",
    "end": "478080"
  },
  {
    "text": "that whether you're running on a virtual machine or maybe on a physical one or maybe you were starting with the",
    "start": "478080",
    "end": "484160"
  },
  {
    "text": "physical one later they migrated you to a virtual one okay so that's one of the reason people at least",
    "start": "484160",
    "end": "490560"
  },
  {
    "text": "the legit reason you know the end user wants to detect vm and uh i believe one of the uh deep in",
    "start": "490560",
    "end": "497440"
  },
  {
    "text": "flavor you know i think is ubuntu they even have a vm detection software built in okay so that's still",
    "start": "497440",
    "end": "504479"
  },
  {
    "text": "all day but nowadays like the virtual machine is actually getting very powerful",
    "start": "504479",
    "end": "509840"
  },
  {
    "text": "so really you know whether you choose a vm versus a dedicated hosting there's pros",
    "start": "509840",
    "end": "516560"
  },
  {
    "text": "cons on both sides and uh the demand of that type of detection is not",
    "start": "516560",
    "end": "522479"
  },
  {
    "text": "that high but there are emerging needs on this",
    "start": "522479",
    "end": "528800"
  },
  {
    "start": "525000",
    "end": "525000"
  },
  {
    "text": "for example uh in the security area i assume lots of people heard about the term",
    "start": "528800",
    "end": "534320"
  },
  {
    "text": "blue pill okay so blue pill is a concept this is different from the red pill ratio is a way to detect vm blue pill is",
    "start": "534320",
    "end": "541200"
  },
  {
    "text": "a concept that about a certain type of malware infection",
    "start": "541200",
    "end": "546880"
  },
  {
    "text": "and what this smell malware infection does is it's going to turn a machine that you know operating system running",
    "start": "546880",
    "end": "552959"
  },
  {
    "text": "on a physical machine and just you know run a very thin layer of a vm",
    "start": "552959",
    "end": "558320"
  },
  {
    "text": "and so that whatever detection of prevention technique you had installed",
    "start": "558320",
    "end": "563600"
  },
  {
    "text": "in the os before now it's running in the gas os and if the malicious",
    "start": "563600",
    "end": "568640"
  },
  {
    "text": "of the attacker actually control the underneath vm it's very thin layer that is not",
    "start": "568640",
    "end": "574800"
  },
  {
    "text": "really noticeable by the end user then this mirror is pretty hard to detect because",
    "start": "574800",
    "end": "581120"
  },
  {
    "text": "your gas os activities can be monitored but on the other hand if you scan",
    "start": "581120",
    "end": "586160"
  },
  {
    "text": "the gas os you will not find the clue about it so that's one of the legit demand of detecting",
    "start": "586160",
    "end": "593040"
  },
  {
    "text": "virtual machines in general and or maybe special type of virtual appliance which is on the malicious side but if",
    "start": "593040",
    "end": "600160"
  },
  {
    "text": "you also look from the attacker point of view there's also a huge demand for them to",
    "start": "600160",
    "end": "605279"
  },
  {
    "text": "try to evade the detection because devices like fire eye for example you know every time they see a",
    "start": "605279",
    "end": "610880"
  },
  {
    "text": "pe file or windows executable on the wire they might want to run in a vm they have a specialized built",
    "start": "610880",
    "end": "617200"
  },
  {
    "text": "virtual machine and they want to run and analyze it so for from the attacker point of view",
    "start": "617200",
    "end": "623519"
  },
  {
    "text": "attacker one to detect whether the code is running in the vm or special virtual appliance",
    "start": "623519",
    "end": "629120"
  },
  {
    "text": "if they can find that they can choose to not do the you know exploitation or",
    "start": "629120",
    "end": "635440"
  },
  {
    "text": "at least maybe delay it okay so from the reading point of view there's also the motivation of detecting which",
    "start": "635440",
    "end": "642399"
  },
  {
    "text": "applies now hopefully you trust that there's demand of doing this",
    "start": "642399",
    "end": "647839"
  },
  {
    "text": "now let's go to the real question is how to detect which appliance",
    "start": "647839",
    "end": "652880"
  },
  {
    "text": "the short answer is it really depends which type of virtual appliance okay and",
    "start": "652880",
    "end": "659200"
  },
  {
    "text": "because what you're applying is a vm and uh for those vm that allow people to",
    "start": "659200",
    "end": "665920"
  },
  {
    "start": "665000",
    "end": "665000"
  },
  {
    "text": "run arbitrary program or maybe even access the gas os kernel level",
    "start": "665920",
    "end": "671519"
  },
  {
    "text": "life actually is not too hard okay if that's the case for all the virtual appliances i think i",
    "start": "671519",
    "end": "677200"
  },
  {
    "text": "don't need to come here give the talk and let me just i'll go to the pool so because there's",
    "start": "677200",
    "end": "682240"
  },
  {
    "text": "really a rich set of prior work and you can really run some special program",
    "start": "682240",
    "end": "690800"
  },
  {
    "text": "using instruction like you know uh like knob instruction look at the behavior uh sort of lots of work okay",
    "start": "690800",
    "end": "698240"
  },
  {
    "text": "but for other type of vm for example the the appliance that really tried to detect",
    "start": "698240",
    "end": "705519"
  },
  {
    "text": "the uh really only run certain type of application for example i have a",
    "start": "705519",
    "end": "711040"
  },
  {
    "text": "a few picture here illustrate let's say three kind of virtual appliance each of them only run",
    "start": "711040",
    "end": "717600"
  },
  {
    "text": "one type of application okay like for example the first one only run ie in it",
    "start": "717600",
    "end": "722639"
  },
  {
    "text": "it doesn't run any other application in order to run any detection you would have to",
    "start": "722639",
    "end": "729279"
  },
  {
    "text": "you know gave it gave some apps script to let it run okay or uh you might also",
    "start": "729279",
    "end": "736160"
  },
  {
    "text": "have a virtual appliance that only run a jvm so you can only you know give it a random java program or maybe applet",
    "start": "736160",
    "end": "742320"
  },
  {
    "text": "and so on pdf this is actually a certainly a simplified you know case in",
    "start": "742320",
    "end": "748560"
  },
  {
    "text": "practice most of the virtual appliance probably going to run a set of applications like if you want to do a mail wire analysis",
    "start": "748560",
    "end": "756240"
  },
  {
    "text": "maybe you know you have a virtual appliance actually tailored to run both ie and look at pdf maybe some some of the",
    "start": "756240",
    "end": "763040"
  },
  {
    "text": "office document but for the uh simplicity of discussion i just assume you only run one",
    "start": "763040",
    "end": "769120"
  },
  {
    "text": "application okay and in all this case nevertheless the trouble is you lose the",
    "start": "769120",
    "end": "775600"
  },
  {
    "text": "ability to run arbitrary program like you know for example you want to run right pay well it doesn't work you know",
    "start": "775600",
    "end": "780800"
  },
  {
    "text": "you need they don't allow you to run your program okay there's a program also called",
    "start": "780800",
    "end": "786240"
  },
  {
    "text": "vmtech well you cannot run it so you would have a seek other way to",
    "start": "786240",
    "end": "791839"
  },
  {
    "text": "to you know deal with this and it you know we initially saw this you know we can do",
    "start": "791839",
    "end": "797120"
  },
  {
    "text": "it this turns out pretty hard okay so we only have some preliminary results here and",
    "start": "797120",
    "end": "805040"
  },
  {
    "text": "xiaomi also have some new tricks and unfortunately we couldn't have time to put in his talk so he's",
    "start": "805040",
    "end": "810560"
  },
  {
    "text": "also going to talk about this with additional detail in hacking miami in may",
    "start": "810560",
    "end": "815920"
  },
  {
    "text": "okay so overall the what we find out is uh for some of the vm",
    "start": "815920",
    "end": "823760"
  },
  {
    "text": "it seems like we could still do some detection from the application script level by",
    "start": "823760",
    "end": "829600"
  },
  {
    "text": "using the display property okay by display property i mean the display and graphic",
    "start": "829600",
    "end": "834959"
  },
  {
    "text": "features and why we're doing this why we want to focusing on using this display",
    "start": "834959",
    "end": "841440"
  },
  {
    "text": "property to do the virtual appliance detection it's based on these observations",
    "start": "841440",
    "end": "846560"
  },
  {
    "text": "so first even for the virtual appliance that only runs a",
    "start": "846560",
    "end": "852480"
  },
  {
    "text": "browser or maybe only run a pdf radar they still have to",
    "start": "852480",
    "end": "857680"
  },
  {
    "text": "expose some of the display property to the vm okay so they always have some display",
    "start": "857680",
    "end": "863600"
  },
  {
    "text": "property you can potentially touch and second part in terms of",
    "start": "863600",
    "end": "868839"
  },
  {
    "text": "virtualization the support for virtualizing the display",
    "start": "868839",
    "end": "874240"
  },
  {
    "text": "part is actually not that advanced so for example you can",
    "start": "874240",
    "end": "879519"
  },
  {
    "text": "do pci passthrough for lots of device like you know using that card but do it",
    "start": "879519",
    "end": "885440"
  },
  {
    "text": "to do pci password for video which i'm going to also mention later to do it in for video you can do it but",
    "start": "885440",
    "end": "890880"
  },
  {
    "text": "you pretty much need multiple graphic cards and then you do one for uh one for each vm",
    "start": "890880",
    "end": "896959"
  },
  {
    "text": "okay so that's why we actually try to take this approach and overall now i",
    "start": "896959",
    "end": "903279"
  },
  {
    "start": "901000",
    "end": "901000"
  },
  {
    "text": "basically changed the goal to say i'm going to try to detect whether you know i'm running a program whether",
    "start": "903279",
    "end": "909279"
  },
  {
    "text": "that's running in virtual appliance or whether it's running on a physical host i'm going to use a display property now",
    "start": "909279",
    "end": "916240"
  },
  {
    "text": "what are the display property you can use so there's a few simple ones here and",
    "start": "916240",
    "end": "921600"
  },
  {
    "text": "for example the very dummy one are some of the you know display screen resolution",
    "start": "921600",
    "end": "927199"
  },
  {
    "text": "information and including you know the size of the the window and also the refresh rate and so",
    "start": "927199",
    "end": "934320"
  },
  {
    "text": "on there's also the feature we look at whether the vm or whether the application",
    "start": "934320",
    "end": "942000"
  },
  {
    "text": "support advanced display in a function like you know on html5 or webgl okay we're also going to",
    "start": "942000",
    "end": "949440"
  },
  {
    "text": "look at the 3d rendering performance through the application now",
    "start": "949440",
    "end": "955519"
  },
  {
    "text": "starting with a very simple one okay we start first assuming this is a appliance running you",
    "start": "955519",
    "end": "962000"
  },
  {
    "start": "958000",
    "end": "958000"
  },
  {
    "text": "know java java virtual machine so we wrote a simple dummy java program what this program does is",
    "start": "962000",
    "end": "969120"
  },
  {
    "text": "try to enumerate the all the possible resolutions supported by the",
    "start": "969120",
    "end": "974800"
  },
  {
    "text": "adapter it turns out jvm act exposed this to the you know the virtual environment",
    "start": "974800",
    "end": "982079"
  },
  {
    "text": "java is supposed to do this protection isolate the physical information from the",
    "start": "982079",
    "end": "987360"
  },
  {
    "text": "you know applet of the java program but it does actually fetch this information from ax silver so",
    "start": "987360",
    "end": "993279"
  },
  {
    "text": "it means like you have to have a display a server running at the back end then you run java then we were able to grab all the possible",
    "start": "993279",
    "end": "1000000"
  },
  {
    "text": "displays supported by the the lower level host now obviously if you don't run any x",
    "start": "1000000",
    "end": "1006399"
  },
  {
    "text": "then our program will get an exception saying that there's no x behind so we run this in a few",
    "start": "1006399",
    "end": "1013680"
  },
  {
    "text": "physical machines and we also run it on vm so here this table shows one simple you know sample of the output",
    "start": "1013680",
    "end": "1020800"
  },
  {
    "text": "a couple things i want to mention first it turns out that for the modern day display of graphic card",
    "start": "1020800",
    "end": "1028319"
  },
  {
    "text": "now we actually have muscle system support tons of resolutions okay so in in this particular case we",
    "start": "1028319",
    "end": "1034400"
  },
  {
    "text": "have like 38 and when i say 38 is like a combination about the you know the resolution",
    "start": "1034400",
    "end": "1040798"
  },
  {
    "text": "plus the refresh rate so you might have like 10 24 680 and then refresh rate you know 56.",
    "start": "1040799",
    "end": "1047918"
  },
  {
    "text": "so it turns out most nvidia amd chip you know intel chip nowadays really",
    "start": "1047919",
    "end": "1053280"
  },
  {
    "text": "support allows all those but if you look at vmware uh or you know virtualbox for example we just take this",
    "start": "1053280",
    "end": "1059760"
  },
  {
    "text": "two type two hypervisor and and look at their number of",
    "start": "1059760",
    "end": "1064799"
  },
  {
    "text": "displays supported vmware supports still a reasonable large number and virtualbox actually only supports",
    "start": "1064799",
    "end": "1071679"
  },
  {
    "text": "four resolution now certainly all these numbers depend on the version of the software we're",
    "start": "1071679",
    "end": "1080080"
  },
  {
    "text": "running like you know for a different version of virtualbox maybe you have a slightly different number",
    "start": "1080080",
    "end": "1085360"
  },
  {
    "text": "it is not that these hypervisor cannot support more okay you just need more work okay and",
    "start": "1085360",
    "end": "1093120"
  },
  {
    "text": "for virtual appliance you tend to tailor it down and you often want to run multiple you know instance",
    "start": "1093120",
    "end": "1099600"
  },
  {
    "text": "in one so they tend to not implement that money and plus if you look at the displayed refresh",
    "start": "1099600",
    "end": "1106000"
  },
  {
    "text": "rate vmware is always running in 64 hertz and virtualbox in 60 hertz but actually i",
    "start": "1106000",
    "end": "1113360"
  },
  {
    "text": "also tracked uh we also checked other uh hypervisor like for example zane and uh",
    "start": "1113360",
    "end": "1119919"
  },
  {
    "text": "like there's even other rear number like sometimes you even have just like a refresh rate that's one hertz",
    "start": "1119919",
    "end": "1125360"
  },
  {
    "text": "okay so the reason again you have all this is because the developer of all this hypervisor",
    "start": "1125360",
    "end": "1132320"
  },
  {
    "text": "needs to implement this virtual display car and they really lack of the",
    "start": "1132320",
    "end": "1137919"
  },
  {
    "text": "motivation and also the effort you know try to test all the combination of the display but on the other hand the",
    "start": "1137919",
    "end": "1144799"
  },
  {
    "text": "physical box you know when you have a display card the vendor actually tries to make sure you know you support all kinds of",
    "start": "1144799",
    "end": "1150960"
  },
  {
    "text": "resolution for example today it's actually take us like you know a few minutes to actually get this thing",
    "start": "1150960",
    "end": "1156240"
  },
  {
    "text": "ready because really there's lots of combination of support okay and then sometimes you also see a",
    "start": "1156240",
    "end": "1161760"
  },
  {
    "text": "really weird you know display the screen resolution like for example we saw",
    "start": "1161760",
    "end": "1167039"
  },
  {
    "text": "vmware the actual support is 1041 by 1041. this is at least at least to our",
    "start": "1167039",
    "end": "1172720"
  },
  {
    "text": "knowledge this is pretty rare because in the regular physical display we usually have at least the",
    "start": "1172720",
    "end": "1179440"
  },
  {
    "text": "the screen resolution is a it's usually uh even number not even an all number but",
    "start": "1179440",
    "end": "1185520"
  },
  {
    "text": "if someone know why this happened let us know so this is",
    "start": "1185520",
    "end": "1191200"
  },
  {
    "text": "tell me examples certainly use in java you might say hey you know what if i you i'm i'm having virtual",
    "start": "1191200",
    "end": "1196880"
  },
  {
    "text": "clients not even run java well again there are other interface for example this uh here what i show is that",
    "start": "1196880",
    "end": "1203840"
  },
  {
    "text": "you can actually use javascript of the actually this is the adobe javascript",
    "start": "1203840",
    "end": "1209840"
  },
  {
    "text": "api and they ask for a lot of information about display you might saw that you know for adobe",
    "start": "1209840",
    "end": "1217120"
  },
  {
    "text": "you only need to know the current window and that's the you know the application size but it turns out",
    "start": "1217120",
    "end": "1223200"
  },
  {
    "text": "this api allows you to get all the possible display you know the resolution behind",
    "start": "1223200",
    "end": "1230000"
  },
  {
    "text": "so there's a this monitor master for example you can get the primary display which is actually is the supposedly the",
    "start": "1230000",
    "end": "1237039"
  },
  {
    "text": "whole the host desktop resolution okay and then you can get the size",
    "start": "1237039",
    "end": "1242480"
  },
  {
    "text": "and there are actually lots more information uh you know you can grab from this and",
    "start": "1242480",
    "end": "1249280"
  },
  {
    "text": "obviously you know you can you can try to use those information to figure out so those are just some very simple you",
    "start": "1249280",
    "end": "1256080"
  },
  {
    "text": "know preliminary effort we try with the screen resolution okay another thing we",
    "start": "1256080",
    "end": "1261280"
  },
  {
    "start": "1261000",
    "end": "1261000"
  },
  {
    "text": "tried is simply try to see if the application might run let's say a",
    "start": "1261280",
    "end": "1266880"
  },
  {
    "text": "browser whether support certain function now this is came as a surprise to us we",
    "start": "1266880",
    "end": "1273120"
  },
  {
    "text": "didn't expect this but turns out lots of the browser in order to support",
    "start": "1273120",
    "end": "1279520"
  },
  {
    "text": "the advanced display feature like html file especially webgl they need to talk to",
    "start": "1279520",
    "end": "1285760"
  },
  {
    "text": "the driver and the again the physical display chip vendors",
    "start": "1285760",
    "end": "1292400"
  },
  {
    "text": "like you know a media intel they actually make sure their driver interacts without the browser well",
    "start": "1292400",
    "end": "1299039"
  },
  {
    "text": "but uh if you try for example in this case uh like firefox 27.0.1 when we run on windows",
    "start": "1299039",
    "end": "1307360"
  },
  {
    "text": "okay it works it support you know web webgl but if you take the same offering",
    "start": "1307360",
    "end": "1313200"
  },
  {
    "text": "system same portion of the firefox browser you put in the vmware put into",
    "start": "1313200",
    "end": "1320640"
  },
  {
    "text": "virtualbox they just you know complain say hey you know they don't support upgrade or something wrong okay and",
    "start": "1320640",
    "end": "1326640"
  },
  {
    "text": "here's actually a screenshot like so if you run on the host it actually",
    "start": "1326640",
    "end": "1332159"
  },
  {
    "text": "sets it you know support but the same version if you run on the vm it doesn't work so in that way",
    "start": "1332159",
    "end": "1339440"
  },
  {
    "text": "like this is like again a dummy heuristic you can use you know in case these things do happen and you",
    "start": "1339440",
    "end": "1345039"
  },
  {
    "text": "can write a script and try to grab exception and if you got exception something wrong right so",
    "start": "1345039",
    "end": "1353200"
  },
  {
    "text": "it turns out that when we try ie on the other hand when you put in the vm ie actually works",
    "start": "1353200",
    "end": "1360000"
  },
  {
    "text": "okay i actually have it work so my uh hypothesis is that when the vmware",
    "start": "1360000",
    "end": "1366799"
  },
  {
    "text": "virtualbox when they develop their driver to support the html5 and webgl they work on ie they",
    "start": "1366799",
    "end": "1374000"
  },
  {
    "text": "make it work but they didn't test on firefox so so those are just again additional",
    "start": "1374000",
    "end": "1379520"
  },
  {
    "text": "information you can use now obviously when you use this type of",
    "start": "1379520",
    "end": "1384640"
  },
  {
    "text": "behavior it doesn't really guarantee to tell you",
    "start": "1384640",
    "end": "1389760"
  },
  {
    "text": "you know when you send a program to the other side and run in the machine and come back",
    "start": "1389760",
    "end": "1395919"
  },
  {
    "text": "if let's say you got exception say no webgl supported",
    "start": "1395919",
    "end": "1402880"
  },
  {
    "text": "if you use that you know just use that to say i'm going to use that to detect whether",
    "start": "1402880",
    "end": "1408000"
  },
  {
    "text": "it's a vm virtual appliance or not you're going to have some false positive okay so there's lots",
    "start": "1408000",
    "end": "1415120"
  },
  {
    "text": "of reason uh that actually uh the uh a machine a physical machine",
    "start": "1415120",
    "end": "1420400"
  },
  {
    "text": "might actually not even support webgl so one possibility is you know you might have a you know a weird display card literally",
    "start": "1420400",
    "end": "1427679"
  },
  {
    "text": "not you know supported or you might have an old device that doesn't support and uh uh you could also have someone",
    "start": "1427679",
    "end": "1434640"
  },
  {
    "text": "just you know unload the driver about to use their own display driver okay so you could have false positive so",
    "start": "1434640",
    "end": "1440799"
  },
  {
    "text": "in that case if you want to use the early on the cure stick i mentioned to do a you know a wide scale",
    "start": "1440799",
    "end": "1448000"
  },
  {
    "text": "measurement of say how many people are using applying this virtual appliance detection that",
    "start": "1448000",
    "end": "1454559"
  },
  {
    "text": "not going to have a very accurate result however this thing is too useful in the sense that if you have a",
    "start": "1454559",
    "end": "1460000"
  },
  {
    "text": "relatively targeted attack you know someone you know it's using probably like you",
    "start": "1460000",
    "end": "1466080"
  },
  {
    "text": "know a state-of-art machine okay then when you send some script",
    "start": "1466080",
    "end": "1471120"
  },
  {
    "text": "there and you will worry about in the middle there may be a device that analyze your program then that",
    "start": "1471120",
    "end": "1477840"
  },
  {
    "text": "scenario might work okay so anyway so that's just second scenario let's move on",
    "start": "1477840",
    "end": "1483760"
  },
  {
    "start": "1483000",
    "end": "1483000"
  },
  {
    "text": "the third effort we you know we played with is looking at the performance aspect of the",
    "start": "1483760",
    "end": "1490240"
  },
  {
    "text": "uh graphic display you know through the you know the web script the reason we do this is",
    "start": "1490240",
    "end": "1497279"
  },
  {
    "text": "based on these observations so first smooth three 3d graphic displays still often require",
    "start": "1497279",
    "end": "1505200"
  },
  {
    "text": "you know lots of hardware support okay the virtual appliance our virtual",
    "start": "1505200",
    "end": "1511039"
  },
  {
    "text": "machine platform we have right now they all have this thing called 3d add-on so that's supposed to help you",
    "start": "1511039",
    "end": "1518159"
  },
  {
    "text": "to make you know rendering the 3d object faster but it's actually still you know based",
    "start": "1518159",
    "end": "1524640"
  },
  {
    "text": "on our result i wish i will show you you know some sample there are still falling behind versus the physical one",
    "start": "1524640",
    "end": "1531360"
  },
  {
    "text": "third case for the equipment that use or use virtual appliance to detect",
    "start": "1531360",
    "end": "1538880"
  },
  {
    "text": "malicious activities often they run multiple instances of virtual appliance so rarely they are",
    "start": "1538880",
    "end": "1546640"
  },
  {
    "text": "you know going to seek hardware support to you know increase the accelerate the graphic",
    "start": "1546640",
    "end": "1553039"
  },
  {
    "text": "display performance so those are the observations now for people like you know old people like me",
    "start": "1553039",
    "end": "1559679"
  },
  {
    "text": "you know i know this i i realize this audience is so young all people like me will maybe ask to say",
    "start": "1559679",
    "end": "1565919"
  },
  {
    "text": "why you know do you even want to run 3d in the on the web script right that",
    "start": "1565919",
    "end": "1571200"
  },
  {
    "text": "itself raise a red flag well it turns out the trend is that people are you know",
    "start": "1571200",
    "end": "1578640"
  },
  {
    "text": "really building lots of game and activities in html5 are you know really",
    "start": "1578640",
    "end": "1584880"
  },
  {
    "text": "in the web so here for example there's quick three in webgl i only know this once i",
    "start": "1584880",
    "end": "1593360"
  },
  {
    "text": "start looking at this work and i even play with it's actually runs very smoothly when",
    "start": "1593360",
    "end": "1599520"
  },
  {
    "text": "you you know running on running the browser on a physical machine so there's lots of game",
    "start": "1599520",
    "end": "1606880"
  },
  {
    "text": "and other activity you know are using advanced graphic rendering in the in in",
    "start": "1606880",
    "end": "1612960"
  },
  {
    "text": "the browser setup now what we did is like again you know i",
    "start": "1612960",
    "end": "1618799"
  },
  {
    "text": "do some simple tests just run the same quick three you know game we look at the you know",
    "start": "1618799",
    "end": "1625440"
  },
  {
    "text": "you know how fast you can render the the 3d display it turns out like on the this is i",
    "start": "1625440",
    "end": "1632400"
  },
  {
    "text": "believe if i remember this correctly this is on the nvidia chip but if you are running on intel",
    "start": "1632400",
    "end": "1638960"
  },
  {
    "text": "one is also pretty you know similar the host can render like 75 frames per",
    "start": "1638960",
    "end": "1644480"
  },
  {
    "text": "second for the quick it's ready but if you run in a vm even with add-on it's you know not too bad it's like it's",
    "start": "1644480",
    "end": "1650880"
  },
  {
    "text": "still playable like it's like 25 okay and uh i mean if you run multiple",
    "start": "1650880",
    "end": "1657279"
  },
  {
    "text": "instances that's absolutely you know things going to slow down okay and uh the other way to test this",
    "start": "1657279",
    "end": "1663520"
  },
  {
    "text": "when you really try to stress the 3d display is that you can try to let it render",
    "start": "1663520",
    "end": "1669600"
  },
  {
    "text": "multiple objects because sometimes the hardware when they support fast support advanced graphics rendering",
    "start": "1669600",
    "end": "1677840"
  },
  {
    "text": "all they do is they can really parallel lots of things which is harder you know for you to do",
    "start": "1677840",
    "end": "1683440"
  },
  {
    "text": "purely in software okay so we also try to test like how many you know 3d objects",
    "start": "1683440",
    "end": "1688559"
  },
  {
    "text": "you can add on like in in a particular script and we can basically in our script we can throw like 5 000",
    "start": "1688559",
    "end": "1694720"
  },
  {
    "text": "uh 3d object rendering and we can still keep like you know 15 frames per second if you want to keep the same frame per",
    "start": "1694720",
    "end": "1701279"
  },
  {
    "text": "second like the vm really been stressed yeah now how to use this information",
    "start": "1701279",
    "end": "1706640"
  },
  {
    "text": "again like we have all this number but how to use it so we came with this you know strategy like basically what i'm going to do is",
    "start": "1706640",
    "end": "1713200"
  },
  {
    "start": "1710000",
    "end": "1710000"
  },
  {
    "text": "i'm going to write a script okay that dynamically probably exponentially increase the",
    "start": "1713200",
    "end": "1719360"
  },
  {
    "text": "number of 3d objects we want to render okay and we want to check how does the",
    "start": "1719360",
    "end": "1724399"
  },
  {
    "text": "host you know how does the other side respond in terms of frame rate okay now if you",
    "start": "1724399",
    "end": "1731360"
  },
  {
    "text": "have uh the other side report back to say they can support you know a few thousand 3d object and",
    "start": "1731360",
    "end": "1738559"
  },
  {
    "text": "still keep like 30 frames per second we can pretty sure that you know that is",
    "start": "1738559",
    "end": "1745520"
  },
  {
    "text": "a host machine a physical host running all this okay again let me repeat what i'm saying",
    "start": "1745520",
    "end": "1751919"
  },
  {
    "text": "is if they gave me if the script report back a high frame rate with lost object i feel i'm",
    "start": "1751919",
    "end": "1759440"
  },
  {
    "text": "positive the other side is physical box okay and plus you can disguise all this",
    "start": "1759440",
    "end": "1764840"
  },
  {
    "text": "detection using a game okay because the other side cannot simply say you are actually running a lot of objects then",
    "start": "1764840",
    "end": "1771360"
  },
  {
    "text": "this must be malicious you can disguise that in the game now however make sure you understand",
    "start": "1771360",
    "end": "1778000"
  },
  {
    "text": "that i'm not saying that if i get a small number either a number object or a low frame rate i would say that's a virtual",
    "start": "1778000",
    "end": "1784240"
  },
  {
    "text": "appliance i cannot say that because obviously there's also false positive possible and because",
    "start": "1784240",
    "end": "1791919"
  },
  {
    "text": "first you can have a really slow machine like you know my parents probably still use a very old",
    "start": "1791919",
    "end": "1797760"
  },
  {
    "text": "pc you know and uh and i actually tried this to run the same scripts you know on the",
    "start": "1797760",
    "end": "1804000"
  },
  {
    "text": "anthem box which is known as slow and with less graphic support and so",
    "start": "1804000",
    "end": "1810960"
  },
  {
    "text": "i get like you know 500 objects 3d object with 15 frames per second i also tried like a qualcomm like a",
    "start": "1810960",
    "end": "1818720"
  },
  {
    "text": "samsung tablet you can get 500 object that's 30 frames per second",
    "start": "1818720",
    "end": "1824720"
  },
  {
    "text": "so again the implication for the detection you can use this technique to try to",
    "start": "1824720",
    "end": "1831520"
  },
  {
    "text": "convince you that the other side is more like likely a physical box but",
    "start": "1831520",
    "end": "1837279"
  },
  {
    "text": "the reverse of the statement is not true like if it didn't mean that you would have to",
    "start": "1837279",
    "end": "1842960"
  },
  {
    "text": "make decisions again how would this be useful depending on the situation if you are if",
    "start": "1842960",
    "end": "1849679"
  },
  {
    "text": "the attack is targeting some you know business some ceo and likely he's",
    "start": "1849679",
    "end": "1854960"
  },
  {
    "text": "going to use a powerful machine you know regardless of what his you know whether his work needed or not then this might be useful but if you",
    "start": "1854960",
    "end": "1862240"
  },
  {
    "text": "again try to do your broad study you will have to you know do more uh",
    "start": "1862240",
    "end": "1867760"
  },
  {
    "text": "use other tricks so we're still trying to do more effort on this as i mentioned that",
    "start": "1867760",
    "end": "1872880"
  },
  {
    "text": "xiaomi going to do another talk with extending more technique and so far all i can say is we're still",
    "start": "1872880",
    "end": "1879039"
  },
  {
    "text": "working on this but it's not like we're completely hopeless so i actually move on to",
    "start": "1879039",
    "end": "1884559"
  },
  {
    "text": "make more assumption about what potentially could happen like so really is",
    "start": "1884559",
    "end": "1890960"
  },
  {
    "text": "how can we get more information about that remote machine so that we can make better judgment so",
    "start": "1890960",
    "end": "1897519"
  },
  {
    "text": "here i would have to make some assumptions to say okay what if they can get some script to run",
    "start": "1897519",
    "end": "1904000"
  },
  {
    "text": "close to native code okay and the example i'm going to use is activex okay now i know like lastly you",
    "start": "1904000",
    "end": "1911440"
  },
  {
    "text": "say hey you know now they still want to run activex and you know stupidly enable that",
    "start": "1911440",
    "end": "1919519"
  },
  {
    "text": "and you're actually absolutely right you know there's i mean at least i don't see there's a good reason to do so",
    "start": "1919519",
    "end": "1924880"
  },
  {
    "text": "however again think about if we are talking about evading the detection of some box",
    "start": "1924880",
    "end": "1931760"
  },
  {
    "text": "in the middle doing using virtual appliance to analyze the program and as far as we know like you know they",
    "start": "1931760",
    "end": "1939120"
  },
  {
    "text": "actually did lots of work to you know first lower the level protection so they actually run lots of untrusted",
    "start": "1939120",
    "end": "1945519"
  },
  {
    "text": "code second they also enabled this auto click okay you know sometimes regular user and",
    "start": "1945519",
    "end": "1951919"
  },
  {
    "text": "nowadays the the the warning is so good you you really shouldn't say run this but",
    "start": "1951919",
    "end": "1959360"
  },
  {
    "text": "in the virtual appliance they might run it okay so those are the assumptions made so try to say okay",
    "start": "1959360",
    "end": "1965279"
  },
  {
    "text": "if you actually have a virtual appliance.that then things get much easier and for",
    "start": "1965279",
    "end": "1971760"
  },
  {
    "text": "people that know activex it's actually running native code you can have a compiled object",
    "start": "1971760",
    "end": "1977200"
  },
  {
    "text": "like x86 code and run okay now you can do a lot of",
    "start": "1977200",
    "end": "1983679"
  },
  {
    "text": "saying once you have the other side run this activex on a different call we actually choose",
    "start": "1983679",
    "end": "1989679"
  },
  {
    "text": "to you know do something very simple so we look around and find out that it",
    "start": "1989679",
    "end": "1995120"
  },
  {
    "text": "turns out microsoft supporters wmi is called windows management instruments",
    "start": "1995120",
    "end": "2002320"
  },
  {
    "text": "and in particular there's one object called wbem it's called web-based enterprise",
    "start": "2002320",
    "end": "2008159"
  },
  {
    "text": "management and allow you you know if you get the permission it will allow you to grab lots of detailed",
    "start": "2008159",
    "end": "2014480"
  },
  {
    "text": "information about the host now obviously you know if you know more about activex there are lots of other",
    "start": "2014480",
    "end": "2020720"
  },
  {
    "text": "exploitation you can do but you know i'm still at the simple side so here's uh",
    "start": "2020720",
    "end": "2025919"
  },
  {
    "text": "one script we note to deal with this and uh this is basically just you know a new wbm",
    "start": "2025919",
    "end": "2034240"
  },
  {
    "text": "object and then from there you can actually do a query to say give",
    "start": "2034240",
    "end": "2039760"
  },
  {
    "text": "me information about this device about the you know underneath you know os and how it",
    "start": "2039760",
    "end": "2045519"
  },
  {
    "text": "view about the the system okay so now i want to show you par part of",
    "start": "2045519",
    "end": "2051679"
  },
  {
    "text": "the script but that's probably the most important part to initiate then you can basically enumerate out the item",
    "start": "2051679",
    "end": "2057440"
  },
  {
    "text": "now here's one thing uh one sample output from our server side this is basically we",
    "start": "2057440",
    "end": "2062638"
  },
  {
    "start": "2058000",
    "end": "2058000"
  },
  {
    "text": "have the xbox embedded in a web page and we sent to the remote site and if",
    "start": "2062639",
    "end": "2069599"
  },
  {
    "text": "they run it we were able to grab lots of information for example here you can see that",
    "start": "2069599",
    "end": "2074960"
  },
  {
    "text": "i have the cpu id we uh we can know what the type of board they are you know and then you know all the video",
    "start": "2074960",
    "end": "2082000"
  },
  {
    "text": "information the graphic display information now if i ever for anyone that actually look at",
    "start": "2082000",
    "end": "2089280"
  },
  {
    "text": "the other virtual machine platform if you look at all the the device the",
    "start": "2089280",
    "end": "2095200"
  },
  {
    "text": "support you know things are obvious you know it's really like the claw everywhere this is like if you can run a program uh",
    "start": "2095200",
    "end": "2102640"
  },
  {
    "text": "on the command line okay so you just like there's tons of information like you know the processor is actually you know has a",
    "start": "2102640",
    "end": "2109359"
  },
  {
    "text": "virtual virtual virtualbox screen there the board is made by argo so all these information",
    "start": "2109359",
    "end": "2116720"
  },
  {
    "text": "are obvious you can grab and there's more information for example you can also look at",
    "start": "2116720",
    "end": "2122240"
  },
  {
    "text": "the device how they map how their memory mapped to the the os and likely the virtual",
    "start": "2122240",
    "end": "2130800"
  },
  {
    "text": "uh the virtual machine they will do the you know the same type of mapping regardless you know",
    "start": "2130800",
    "end": "2136320"
  },
  {
    "text": "which where you run this but if you look at the physical box mutual filter box can have a really",
    "start": "2136320",
    "end": "2142640"
  },
  {
    "text": "dramatic difference of all this device mapping the address so so basically even the virtual appliance",
    "start": "2142640",
    "end": "2149920"
  },
  {
    "text": "you know can hide all the strings say i'm not going to say virtualbox in anywhere",
    "start": "2149920",
    "end": "2155760"
  },
  {
    "text": "but the behavior of the memory mapping they can still modify but takes lots of",
    "start": "2155760",
    "end": "2161520"
  },
  {
    "text": "effort for them to customize okay now contrary to that",
    "start": "2161520",
    "end": "2166640"
  },
  {
    "text": "here's the output you know if you run this on you know one of the hosts you'll see i only show you part of the the output this is",
    "start": "2166640",
    "end": "2174880"
  },
  {
    "text": "one of the machine may have is the intel one and i only show you partially the output about the",
    "start": "2174880",
    "end": "2181280"
  },
  {
    "text": "the device the memory mapping it's really a much longer list much richer set of device and",
    "start": "2181280",
    "end": "2189440"
  },
  {
    "text": "it will take a lot of effort for the virtual appliance our virtual machine vendor",
    "start": "2189440",
    "end": "2194560"
  },
  {
    "text": "to really mimic this as a real device now as i mentioned earlier like what if",
    "start": "2194560",
    "end": "2201520"
  },
  {
    "text": "the on the virtual machine or virtual appliance site they try to just try to",
    "start": "2201520",
    "end": "2206560"
  },
  {
    "text": "hide all this information they can choose to say instead of load the virtual",
    "start": "2206560",
    "end": "2213359"
  },
  {
    "text": "virtualbox display driver how about let's load the immediate one well that that naiva pro",
    "start": "2213359",
    "end": "2219680"
  },
  {
    "text": "doesn't work because if you load the nvidia driver and the video driver we're going to say you know",
    "start": "2219680",
    "end": "2226079"
  },
  {
    "text": "going to need to access the device and the device actually is built by let's say virtualbox",
    "start": "2226079",
    "end": "2231680"
  },
  {
    "text": "then the driver going to fail to load so it's not easy for them to lie about it",
    "start": "2231680",
    "end": "2237599"
  },
  {
    "text": "there is an alternative the virtual machine or virtual appliance",
    "start": "2237599",
    "end": "2242800"
  },
  {
    "text": "vendor they can actually try to mimic like build a virtual device that is completely",
    "start": "2242800",
    "end": "2248800"
  },
  {
    "text": "you know behave the same as let's say a popular graphic card okay so that's a",
    "start": "2248800",
    "end": "2256640"
  },
  {
    "text": "possible approach and in that case they can use the immediate driver then",
    "start": "2256640",
    "end": "2262640"
  },
  {
    "text": "you list all the device at least from the display part it's you know we don't have at least you know",
    "start": "2262640",
    "end": "2268320"
  },
  {
    "text": "virtualbox information there it's you know not easy to grab that however",
    "start": "2268320",
    "end": "2274240"
  },
  {
    "text": "this is pretty hard work okay first you know as far as we know there are really now",
    "start": "2274240",
    "end": "2281040"
  },
  {
    "text": "we don't see any implementation of virtual display card that mapped to the",
    "start": "2281040",
    "end": "2287520"
  },
  {
    "text": "latest or the modern or we don't have any virtual device implementation for",
    "start": "2287520",
    "end": "2293760"
  },
  {
    "text": "display card for modern display device if you look for let's say for example qmu",
    "start": "2293760",
    "end": "2300160"
  },
  {
    "text": "or maybe vmware virtualbox you can find some old vga device i think uh service logic",
    "start": "2300160",
    "end": "2307040"
  },
  {
    "text": "is one of them this is really really old display device okay but all",
    "start": "2307040",
    "end": "2314079"
  },
  {
    "text": "you know what i'm saying with all this doesn't mean that they cannot build it they can still build it because if you look at what are the other device",
    "start": "2314079",
    "end": "2321440"
  },
  {
    "text": "they built they actually if you open up you know virtual macbox all vmware they actually",
    "start": "2321440",
    "end": "2327040"
  },
  {
    "text": "already mimic other device right so for example on the nic very popular one is uh",
    "start": "2327040",
    "end": "2332160"
  },
  {
    "text": "the intel e1000 okay there are you know when you run virtualbox your",
    "start": "2332160",
    "end": "2339520"
  },
  {
    "text": "machine doesn't have to have an intel e1000 uh like to run watchbox but",
    "start": "2339520",
    "end": "2345280"
  },
  {
    "text": "you know virtualbox may make that okay so there's console device they can do okay",
    "start": "2345280",
    "end": "2350720"
  },
  {
    "text": "so i'm not saying they can now implement that one really mimics the intel display on a media display or",
    "start": "2350720",
    "end": "2357599"
  },
  {
    "text": "whatever however it's really difficult i i can you know claim that it's really",
    "start": "2357599",
    "end": "2364640"
  },
  {
    "text": "really difficult for them to make sure that device behave the same as the physical one and",
    "start": "2364640",
    "end": "2371760"
  },
  {
    "text": "since there's no one implement the virtual you know a good virtual display",
    "start": "2371760",
    "end": "2377040"
  },
  {
    "text": "device i gave you example from our prior work looking at the network of the",
    "start": "2377040",
    "end": "2382640"
  },
  {
    "text": "virtual device versus physical device so here's the example when we look at",
    "start": "2382640",
    "end": "2387760"
  },
  {
    "text": "the virtual implementation of intel e1000 and we compare the real device",
    "start": "2387760",
    "end": "2393440"
  },
  {
    "text": "there are lots of behavior differences since this is a one sample we we look at this",
    "start": "2393440",
    "end": "2399200"
  },
  {
    "text": "is based on the qemu implementation and for example if you do a right to this ics this which is an",
    "start": "2399200",
    "end": "2404960"
  },
  {
    "text": "interrupt call set register there's two the physical one and which",
    "start": "2404960",
    "end": "2410640"
  },
  {
    "text": "one actually behave differently okay there's another one this is about the mdi control you know when you gave a",
    "start": "2410640",
    "end": "2416000"
  },
  {
    "text": "value it's again have different behavior the point is that",
    "start": "2416000",
    "end": "2421599"
  },
  {
    "text": "when you implement this virtual device especially the complex device it is so hard to make them",
    "start": "2421599",
    "end": "2428800"
  },
  {
    "text": "really behave the same on all the corner cases and we have a like last year we have a black eye talk",
    "start": "2428800",
    "end": "2434720"
  },
  {
    "text": "on exactly the topic on how to find the difference between those so i'm going to refer you to that",
    "start": "2434720",
    "end": "2440400"
  },
  {
    "text": "now you might still say okay what if we just use a real device let's how about we do",
    "start": "2440400",
    "end": "2445839"
  },
  {
    "text": "pci password okay pcr passthrough as i mentioned before it's popular for some of the device but",
    "start": "2445839",
    "end": "2453359"
  },
  {
    "text": "so far not yet ready you know for the display but the general concept is that instead",
    "start": "2453359",
    "end": "2460160"
  },
  {
    "text": "of emulated device like i show on the right hand side you know you have the physical device",
    "start": "2460160",
    "end": "2466240"
  },
  {
    "text": "and later emulate device pci password basically you know through the hypervisor expose the device directly to the",
    "start": "2466240",
    "end": "2473200"
  },
  {
    "text": "virtual appliance so if you want to test to say is this the real device or not it's supposed to",
    "start": "2473200",
    "end": "2479119"
  },
  {
    "text": "behave all the same like the physical one because it is the real one however uh based on our current",
    "start": "2479119",
    "end": "2486800"
  },
  {
    "text": "knowledge so first there's no practical product that we can access there's a media has a product",
    "start": "2486800",
    "end": "2495040"
  },
  {
    "text": "announcement called um there's a device called grade k2 supposedly this is a one graphic card",
    "start": "2495040",
    "end": "2502400"
  },
  {
    "text": "you physically plug in then they can expose multiple you know",
    "start": "2502400",
    "end": "2507839"
  },
  {
    "text": "pci passthrough and graphic cards in multiple vm okay and so far we haven't accessed that",
    "start": "2507839",
    "end": "2513440"
  },
  {
    "text": "but even they made that let's say it works perfectly and based on our past experience with",
    "start": "2513440",
    "end": "2519839"
  },
  {
    "text": "the intel network card okay so intel uh 10 gigabit and",
    "start": "2519839",
    "end": "2525040"
  },
  {
    "text": "40 gigabit which is coming they actually have different drivers for the one",
    "start": "2525040",
    "end": "2530240"
  },
  {
    "text": "that's running on the house one and the one running on the vm one the host one is called pf driver the",
    "start": "2530240",
    "end": "2536240"
  },
  {
    "text": "the virtual the guest os actually ran the vf driver even they are talking to",
    "start": "2536240",
    "end": "2542720"
  },
  {
    "text": "the physical device directly so we still feel like even with the media k2 likely we might",
    "start": "2542720",
    "end": "2548160"
  },
  {
    "text": "be able to find some difference okay now those are the like a quick overview about what",
    "start": "2548160",
    "end": "2554240"
  },
  {
    "text": "you know things we poked you know to try to tell the difference between physical and virtual now how to really resist",
    "start": "2554240",
    "end": "2562160"
  },
  {
    "text": "this you know obviously we have to look at this thing from two side",
    "start": "2562160",
    "end": "2567520"
  },
  {
    "text": "now the what i want to say that if the you know the user on the remote",
    "start": "2567520",
    "end": "2574720"
  },
  {
    "text": "side have access to application level you know or have access to the kernel level or able",
    "start": "2574720",
    "end": "2582079"
  },
  {
    "text": "to run native code our view is that it's pretty hard to prevent the other side to figure it out",
    "start": "2582079",
    "end": "2589119"
  },
  {
    "text": "okay because it's so hard to make the physical and virtual looks the",
    "start": "2589119",
    "end": "2594800"
  },
  {
    "text": "same even you have lots of hardware virtualization to support us now if you",
    "start": "2594800",
    "end": "2600640"
  },
  {
    "text": "want to limit scope to say okay wi-fi you know we focus on the ultraviolet appliance only",
    "start": "2600640",
    "end": "2607200"
  },
  {
    "text": "support web script or application level script it's possible you know you can hide lots",
    "start": "2607200",
    "end": "2612640"
  },
  {
    "text": "of the vm specific information but",
    "start": "2612640",
    "end": "2617839"
  },
  {
    "text": "timing and performance wise that type of detection is relatively harder to you",
    "start": "2617839",
    "end": "2623920"
  },
  {
    "text": "know to do so and also it's pretty challenging to you know prevent",
    "start": "2623920",
    "end": "2629920"
  },
  {
    "text": "the targeted attack like if someone know that the target is using certain type of machine at least high end",
    "start": "2629920",
    "end": "2636400"
  },
  {
    "text": "it's pretty hard to again resist that type of detection now to summarize the talk uh while i",
    "start": "2636400",
    "end": "2643200"
  },
  {
    "text": "told you that we did some preliminary effort try to detect virtual appliance and we focus on the",
    "start": "2643200",
    "end": "2649760"
  },
  {
    "text": "detection through the web script you know using the web screen you can get lots of display related",
    "start": "2649760",
    "end": "2655680"
  },
  {
    "text": "information and those are some simple cues that you can use we also look at the case that if you",
    "start": "2655680",
    "end": "2662720"
  },
  {
    "text": "actually have a virtual appliance that runs potentially native code like",
    "start": "2662720",
    "end": "2667920"
  },
  {
    "text": "activex then potentially you have more information you can collect or if you have lower level access to the",
    "start": "2667920",
    "end": "2674000"
  },
  {
    "text": "device then it's much easier to tell the difference",
    "start": "2674000",
    "end": "2679280"
  },
  {
    "text": "the reason we use display information i want to re-emphasize this",
    "start": "2679280",
    "end": "2684720"
  },
  {
    "text": "is because the display information often has to expose to the application even this is",
    "start": "2684720",
    "end": "2690960"
  },
  {
    "text": "really for specialized case like adobe uh you know uh browser so there are many properties",
    "start": "2690960",
    "end": "2697680"
  },
  {
    "text": "potentially can be used and especially the performance side okay it's all this i'm ready for",
    "start": "2697680",
    "end": "2704240"
  },
  {
    "text": "questions",
    "start": "2704240",
    "end": "2706640"
  },
  {
    "text": "just go ahead",
    "start": "2711200",
    "end": "2719838"
  },
  {
    "text": "right so the when you try to run java codes you know through jvm so they're usually you know two type",
    "start": "2731920",
    "end": "2739200"
  },
  {
    "text": "two level protection one is they will actually try to say you know like say absolutely the case they will",
    "start": "2739200",
    "end": "2744800"
  },
  {
    "text": "say has this applet been signed right so it's up to you from the attacker point of view it's",
    "start": "2744800",
    "end": "2751040"
  },
  {
    "text": "up to them to figure out how to sign it okay the second case is certainly the third level of access to say simply say",
    "start": "2751040",
    "end": "2758400"
  },
  {
    "text": "don't run any of the you know java applet so if that's the case then uh you know you're not able to grab",
    "start": "2758400",
    "end": "2765359"
  },
  {
    "text": "any information but again if you believe you can have a site that",
    "start": "2765359",
    "end": "2770480"
  },
  {
    "text": "and the user actually likes to you know run and they will see the applets you know and if you know they're gonna run it",
    "start": "2770480",
    "end": "2776960"
  },
  {
    "text": "likely the you can have the setup you know like let the virtual clients also run it so",
    "start": "2776960",
    "end": "2782800"
  },
  {
    "text": "and then also if they don't run you actually get the exception now what that exception mean i don't know okay",
    "start": "2782800",
    "end": "2788400"
  },
  {
    "text": "basically you have to maybe change to a different technique",
    "start": "2788400",
    "end": "2792880"
  },
  {
    "text": "so so that you cannot because the the way we detect virtual machine versus",
    "start": "2800400",
    "end": "2807599"
  },
  {
    "text": "real machine is actually try to say the real machine actually run faster so unless you can make the clock faster",
    "start": "2807599",
    "end": "2815200"
  },
  {
    "text": "right it really makes things run faster then you can defeat this detection right",
    "start": "2815200",
    "end": "2823920"
  },
  {
    "text": "slower already indicate you're likely not a real one so make it more slower doesn't help",
    "start": "2823920",
    "end": "2830319"
  },
  {
    "text": "maybe i misunderstand your questions",
    "start": "2830319",
    "end": "2844400"
  },
  {
    "text": "right but you see when you look at the timing and performance we actually know the physical one",
    "start": "2848000",
    "end": "2854400"
  },
  {
    "text": "physical machine actually can run can render the box much faster right uh",
    "start": "2854400",
    "end": "2860559"
  },
  {
    "text": "when you try to use a virtual appliance you all you can do is slow down you can now go",
    "start": "2860559",
    "end": "2867040"
  },
  {
    "text": "faster",
    "start": "2870839",
    "end": "2873839"
  },
  {
    "text": "right okay i got it so so if you actually already you know intentionally",
    "start": "2885520",
    "end": "2891280"
  },
  {
    "text": "to you know you know know there are the script potentially are using time information",
    "start": "2891280",
    "end": "2897280"
  },
  {
    "text": "and you can try to you know lie about this because you can play with the timing yes then you might create the illusion",
    "start": "2897280",
    "end": "2904160"
  },
  {
    "text": "that you know you're rendering much faster i don't have a direct response about",
    "start": "2904160",
    "end": "2910720"
  },
  {
    "text": "that i now i understand the the technique so i guess",
    "start": "2910720",
    "end": "2916240"
  },
  {
    "text": "i will have to think more about this and to see you know whether this complete break the approach or not",
    "start": "2916240",
    "end": "2929839"
  },
  {
    "text": "sorry now can you repeat the question",
    "start": "2930640",
    "end": "2934318"
  },
  {
    "text": "for the non-exit environment do you have any other detection method",
    "start": "2936480",
    "end": "2942319"
  },
  {
    "text": "that you can suggest for the non-ex non-graphical requirements let's say",
    "start": "2942319",
    "end": "2948400"
  },
  {
    "text": "you're talking let me make sure i understand the question so the question is if there's no display can you still detect right now",
    "start": "2948400",
    "end": "2954960"
  },
  {
    "text": "if let's say you are not activating x so you are in just uh the text mode is there a way you can",
    "start": "2954960",
    "end": "2961520"
  },
  {
    "text": "detect right so again if you have any way to uh run like in terms of in general for",
    "start": "2961520",
    "end": "2969040"
  },
  {
    "text": "vm detection if you can run the application level program there",
    "start": "2969040",
    "end": "2974240"
  },
  {
    "text": "really lots of way for example i believe that xiaomi going to talk in a different",
    "start": "2974240",
    "end": "2979520"
  },
  {
    "text": "presentation for example if you look at how the knob instruction gets executed okay",
    "start": "2979520",
    "end": "2986240"
  },
  {
    "text": "so in the physical machine the knob instruction it's really a special instruction",
    "start": "2986240",
    "end": "2991280"
  },
  {
    "text": "but for hypervisor the knob instruction is going to be treated maybe differently so",
    "start": "2991280",
    "end": "2996480"
  },
  {
    "text": "there's all you need to do is find all those subtle difference so i have to understand",
    "start": "2996480",
    "end": "3003520"
  },
  {
    "text": "the particular you know virtual appliance what what what can they run then we can say okay are there any clue",
    "start": "3003520",
    "end": "3009520"
  },
  {
    "text": "we can use have you tried to alter default before from the configuration",
    "start": "3009520",
    "end": "3015040"
  },
  {
    "text": "setting of the vm vmware vm box whatever it is right so we if so we are right now limited",
    "start": "3015040",
    "end": "3023280"
  },
  {
    "text": "the the study right now we have certainly tried like vmware zen virtualbox",
    "start": "3023280",
    "end": "3029680"
  },
  {
    "text": "okay we want to actually extend to more of the hypervisor and we also want to",
    "start": "3029680",
    "end": "3036720"
  },
  {
    "text": "access more of the virtual appliance so if you have you know",
    "start": "3036720",
    "end": "3041760"
  },
  {
    "text": "if you want to you know give us some access i'll be more than happy to look at that",
    "start": "3041760",
    "end": "3047200"
  },
  {
    "text": "thank you",
    "start": "3047200",
    "end": "3055838"
  },
  {
    "text": "using your current approach what is a kind of false positive you have in detecting that part",
    "start": "3056400",
    "end": "3064240"
  },
  {
    "text": "i don't have the number now okay so again this is a quite preliminary effort and uh",
    "start": "3064240",
    "end": "3071839"
  },
  {
    "text": "i guess in terms of false positive i always say you know we have to look at specific",
    "start": "3071839",
    "end": "3078000"
  },
  {
    "text": "target let's say you know maybe you want to say what is they force positive to detect a",
    "start": "3078000",
    "end": "3083280"
  },
  {
    "text": "virtual box based appliance or maybe even more specific to say what is the false positive to detect if",
    "start": "3083280",
    "end": "3090880"
  },
  {
    "text": "a fire eye in the middle so that you know if you want to get any meaningful number that has to be you know i would",
    "start": "3090880",
    "end": "3097680"
  },
  {
    "text": "say pick a particular target so am i right to say that this is not kind of a",
    "start": "3097680",
    "end": "3103359"
  },
  {
    "text": "90 reliable or things like that i will say right now while we",
    "start": "3103359",
    "end": "3110880"
  },
  {
    "text": "propose i will have to be honest that you know i would say if you want to do a generic type of detection",
    "start": "3110880",
    "end": "3118319"
  },
  {
    "text": "if you can grab the screen resolution assuming let's say virtualbox vmware didn't do anything special that part you",
    "start": "3118400",
    "end": "3125119"
  },
  {
    "text": "can detect very you know precisely but if you talk about you know using like timing",
    "start": "3125119",
    "end": "3131040"
  },
  {
    "text": "and you know like the support of the you know webgl i'm not going to be say a confident",
    "start": "3131040",
    "end": "3137599"
  },
  {
    "text": "number that high okay i will go much lower but then again i keep mentioning that if you have",
    "start": "3137599",
    "end": "3144960"
  },
  {
    "text": "a targeted attack if you already know this you know this is a guy running an i7 box",
    "start": "3144960",
    "end": "3152079"
  },
  {
    "text": "and i just want to know whether in the middle there's some other machine protect this target then i think",
    "start": "3152079",
    "end": "3158800"
  },
  {
    "text": "you can get very high accuracy actually that's my next question so this",
    "start": "3158800",
    "end": "3164319"
  },
  {
    "text": "how useful that that method can be if you use it for you know not for a targeted attack because there's a",
    "start": "3164319",
    "end": "3170079"
  },
  {
    "text": "lot of different appliances and you know a variety of stuff so you need to check so many things",
    "start": "3170079",
    "end": "3175119"
  },
  {
    "text": "yeah that would be a explosion of the code right how useful the current one i would",
    "start": "3175119",
    "end": "3181520"
  },
  {
    "text": "say if you want to use you want if you want to build a tour immediately using this",
    "start": "3181520",
    "end": "3186880"
  },
  {
    "text": "i won't recommend that because i don't think it's mature than that level however i do feel like hopefully this is",
    "start": "3186880",
    "end": "3193040"
  },
  {
    "text": "something encouraging people look at especially people know more about the display part",
    "start": "3193040",
    "end": "3198079"
  },
  {
    "text": "okay so that will be my response thank you",
    "start": "3198079",
    "end": "3202799"
  },
  {
    "text": "any more questions why i know i'm standing between you know you",
    "start": "3205119",
    "end": "3210720"
  },
  {
    "text": "and the lunch so enjoy",
    "start": "3210720",
    "end": "3220319"
  }
]