[
  {
    "start": "0",
    "end": "0"
  },
  {
    "text": "okay good afternoon everyone thank you for attending my talk it's an honor to again be speaking at blackhat so today",
    "start": "0",
    "end": "6810"
  },
  {
    "text": "I'm going to talk about my research on wpa2 and in particular how we managed to break the protocol now there's a small",
    "start": "6810",
    "end": "13980"
  },
  {
    "text": "chance you already heard about this work under the name crack but the research behind the Wi-Fi security that I've",
    "start": "13980",
    "end": "22080"
  },
  {
    "text": "already been doing for a while has a bit of a history already I actually because I've already studied the security of",
    "start": "22080",
    "end": "29640"
  },
  {
    "text": "wireless networks during my PhD and interestingly a year ago when I defended",
    "start": "29640",
    "end": "34680"
  },
  {
    "text": "my PhD I got a question from a jury member and he asked hey in your thesis",
    "start": "34680",
    "end": "40950"
  },
  {
    "text": "you're suggesting the use of wpa2 with AES but are you sure that's actually",
    "start": "40950",
    "end": "47399"
  },
  {
    "text": "secure and a year ago the answer I gave was yeah seems to be secure after all it",
    "start": "47399",
    "end": "53879"
  },
  {
    "text": "has been around for more than a decade until have been no real attacks against it and on top of that there are",
    "start": "53879",
    "end": "59309"
  },
  {
    "text": "mathematical proofs that state that wpa2 is supposed to be secure however one",
    "start": "59309",
    "end": "66390"
  },
  {
    "text": "year later I was staring at some open BSD code and I was specifically focusing",
    "start": "66390",
    "end": "72840"
  },
  {
    "text": "on this function called IC set key and this function basically instructs the",
    "start": "72840",
    "end": "78420"
  },
  {
    "text": "driver into installing the negotiated encryption key and without going into too much detail yet I was thinking that",
    "start": "78420",
    "end": "85740"
  },
  {
    "text": "hey what would happen if this function is called twice with the key be reinstalled on what happens if this key",
    "start": "85740",
    "end": "93119"
  },
  {
    "text": "is being reinstalled and it turns out that answering this question let me to",
    "start": "93119",
    "end": "98880"
  },
  {
    "text": "find this flaw in the wpa2 protocol or to put it differently this talk is about",
    "start": "98880",
    "end": "104640"
  },
  {
    "text": "how I gave the wrong answer during my PhD defense so to explain what happens",
    "start": "104640",
    "end": "111750"
  },
  {
    "text": "wrong in the WPA 2 protocol I'm going to illustrate the attack when applied",
    "start": "111750",
    "end": "117600"
  },
  {
    "start": "116000",
    "end": "116000"
  },
  {
    "text": "against the four-way handshake specifically the attack also applies against other Wi-Fi handshakes but I'm",
    "start": "117600",
    "end": "123750"
  },
  {
    "text": "not going to discuss those because the idea behind the tack is essentially the same and after that I'm going to discuss",
    "start": "123750",
    "end": "130770"
  },
  {
    "text": "the practical impact of the attack and practice and I'm also",
    "start": "130770",
    "end": "136220"
  },
  {
    "text": "going to discuss a few misconceptions that have been floating around the internet and finally I will conclude the",
    "start": "136220",
    "end": "142550"
  },
  {
    "text": "talk with a few lessons that we can learn from the research so let's get",
    "start": "142550",
    "end": "147709"
  },
  {
    "text": "started let's explain the attack against the four-way handshake now the first thing I have to answer",
    "start": "147709",
    "end": "153380"
  },
  {
    "text": "what is the four-way handshake and the four-way handshake is executed whenever",
    "start": "153380",
    "end": "160100"
  },
  {
    "start": "157000",
    "end": "157000"
  },
  {
    "text": "a client wants to join a Wi-Fi network and the purpose of the handshake is on one hand to verify that the client",
    "start": "160100",
    "end": "167150"
  },
  {
    "text": "possesses the proper credentials for example for your home network that the client knows the pre-shared key and at",
    "start": "167150",
    "end": "174200"
  },
  {
    "text": "the same time this four-way handshake also negotiates a fresh session key a fresh encryption key on this encryption",
    "start": "174200",
    "end": "180800"
  },
  {
    "text": "key is called the PDK now as I mentioned one year ago I would have said that this",
    "start": "180800",
    "end": "188330"
  },
  {
    "text": "looks secure because there have been no attacks in more than a decade at least if you ignore dictionary attacks because",
    "start": "188330",
    "end": "195500"
  },
  {
    "text": "of course it's possible to guess the pre shared key that's induced and then verify if your guest is correct however",
    "start": "195500",
    "end": "202549"
  },
  {
    "text": "if you have a strong password there isn't there are no known weaknesses in this handshake and on top of that the 4",
    "start": "202549",
    "end": "209750"
  },
  {
    "text": "Way handshake itself has been proven mathematically as secure on the encryption protocol that is executed",
    "start": "209750",
    "end": "215989"
  },
  {
    "text": "after the 4-way handshake that has also been proven as secure so you would say that ok there is no possible attack",
    "start": "215989",
    "end": "222440"
  },
  {
    "text": "against this to explain the attack that I found I'm now going to explain the",
    "start": "222440",
    "end": "228200"
  },
  {
    "start": "228000",
    "end": "228000"
  },
  {
    "text": "four-way handshake in more detail and to explain the attack let's assume we have",
    "start": "228200",
    "end": "233600"
  },
  {
    "text": "a client here on the left that wants to connect to the access points on the right in order to start the four-way",
    "start": "233600",
    "end": "240799"
  },
  {
    "text": "handshake there needs to be some kind of shared secret between the clients on the access point now for your home router",
    "start": "240799",
    "end": "247220"
  },
  {
    "text": "that's very simple this ppreciate this shared secret is essentially the pre shared key but if",
    "start": "247220",
    "end": "253040"
  },
  {
    "text": "you have an enterprise network where you have to for example authenticate using a username and password to obtain this",
    "start": "253040",
    "end": "259100"
  },
  {
    "text": "shared secret between the client on the access point first and 802 dot wanax authentication phase takes place",
    "start": "259100",
    "end": "266300"
  },
  {
    "text": "now thankfully we don't need to know the details about how this works basically you can have this kind of authentication",
    "start": "266300",
    "end": "272270"
  },
  {
    "text": "which typically is some form of radius authentication and the result of that is that there is now a shared secret",
    "start": "272270",
    "end": "278210"
  },
  {
    "text": "between the client on the access point and once we have the shared secret the four-way handshake can be executed so as",
    "start": "278210",
    "end": "286580"
  },
  {
    "text": "the name of this handshake implies the 4 Way handshake consists of four messages and the first two they are used to",
    "start": "286580",
    "end": "294680"
  },
  {
    "text": "transport random numbers between both devices so in particular first the",
    "start": "294680",
    "end": "300229"
  },
  {
    "text": "access point generates a random number called the access point months or the anals on that is transported to the",
    "start": "300229",
    "end": "306110"
  },
  {
    "text": "clients in reaction to that the client generates a random number which is called the submitted supplicants nones",
    "start": "306110",
    "end": "312319"
  },
  {
    "text": "so the essence on that is transported to the access point and once both these",
    "start": "312319",
    "end": "318800"
  },
  {
    "text": "devices know the random number known the nonsense of each other they can derive",
    "start": "318800",
    "end": "324440"
  },
  {
    "text": "this fresh encryption key called the ptk on the way that is done is basically you",
    "start": "324440",
    "end": "330650"
  },
  {
    "text": "take the shared secrets that these devices have and you mix them together with these random numbers and the result",
    "start": "330650",
    "end": "336380"
  },
  {
    "text": "is a unique session key now one thing I",
    "start": "336380",
    "end": "342199"
  },
  {
    "text": "want to clear up here before we continue the talk is that you might have heard about this work under a different",
    "start": "342199",
    "end": "347990"
  },
  {
    "text": "different title namely key reinstallation attacks forcing nonce reuse and wpa2 I want to clarify that",
    "start": "347990",
    "end": "356330"
  },
  {
    "text": "the nonce of reuse does not refer to these two nonsense right here they do not refer to the a nonce or s nonce so",
    "start": "356330",
    "end": "365449"
  },
  {
    "text": "and I will be talking about nonce reuse it's not about nonce reuse here during the 4 Way handshake but during the",
    "start": "365449",
    "end": "370819"
  },
  {
    "text": "encryption algorithm that we will see later ok so let's assume we executed this",
    "start": "370819",
    "end": "376580"
  },
  {
    "text": "first stage of the four way handshake then a bit simplified the second stage",
    "start": "376580",
    "end": "382490"
  },
  {
    "text": "basically confirms that both devices generated the same session key so the",
    "start": "382490",
    "end": "388430"
  },
  {
    "text": "access point sends message 3 to the client and the client replies using message for and if that goes well then",
    "start": "388430",
    "end": "395899"
  },
  {
    "text": "both parties know that the handshake was successful and they can install the encryption key to then encrypt data",
    "start": "395899",
    "end": "403550"
  },
  {
    "text": "frames so once we installed the key here we can now start transmitting encrypted",
    "start": "403550",
    "end": "410090"
  },
  {
    "text": "data frames so the last thing that we now need to understand is how this",
    "start": "410090",
    "end": "416600"
  },
  {
    "text": "encryption work in a wpa2 Network once we have this session key and let's take",
    "start": "416600",
    "end": "424070"
  },
  {
    "start": "424000",
    "end": "424000"
  },
  {
    "text": "the following example we want to send this plaintext data to the other client what steps are now taken to encrypt it",
    "start": "424070",
    "end": "431600"
  },
  {
    "text": "well it's quite straightforward we take the session key that we just negotiated and we combine that with a",
    "start": "431600",
    "end": "439580"
  },
  {
    "text": "packet number and that packet number is incremented by one for every packet that",
    "start": "439580",
    "end": "444650"
  },
  {
    "text": "is transmitted and this packet number is also called the nonce and the idea is",
    "start": "444650",
    "end": "450980"
  },
  {
    "text": "that by combining the session key with this packet number that always increments by one is that you get a",
    "start": "450980",
    "end": "457280"
  },
  {
    "text": "unique per packet key that should only be used once and then this unique per",
    "start": "457280",
    "end": "463370"
  },
  {
    "text": "packet key can be used to decrypt the plaintext we are trying to transmit and here the",
    "start": "463370",
    "end": "468830"
  },
  {
    "text": "encryption process is quite simple what we do is we take the packet number we feed it to a stream cipher we get a key",
    "start": "468830",
    "end": "475700"
  },
  {
    "text": "stream as output and then as is usually the case in a stream cipher you simply",
    "start": "475700",
    "end": "481070"
  },
  {
    "text": "ignore the plain text on the key stream ant you end up with the encrypted data the ciphertext now of course we repent a",
    "start": "481070",
    "end": "488600"
  },
  {
    "text": "header to this encrypted data - so the receiver knows the packet number the nonce that was used during encryption",
    "start": "488600",
    "end": "496510"
  },
  {
    "text": "but basically this is the process and you don't need to know more to understand how the attack works now the",
    "start": "496510",
    "end": "505070"
  },
  {
    "text": "thing that is essential in this construction is that the packet number the nonce is never repeated because if",
    "start": "505070",
    "end": "513200"
  },
  {
    "text": "this nonce is repeated it means that the same per packet key is generated and in",
    "start": "513200",
    "end": "518270"
  },
  {
    "text": "turn if the same per packet key is generated this means the same key stream is used again and this means you have",
    "start": "518270",
    "end": "523700"
  },
  {
    "text": "key stream reuse and whenever an an encryption protocol key stream is being",
    "start": "523700",
    "end": "529280"
  },
  {
    "text": "reused you are able to exploit that to decrease certain packets on depending on the",
    "start": "529280",
    "end": "535680"
  },
  {
    "text": "specific encryption algorithm being used that can in turn be abused to forge",
    "start": "535680",
    "end": "542220"
  },
  {
    "text": "packets but that depends on encryption algorithm in general if there is nonce reuse if there is key stream you reuse",
    "start": "542220",
    "end": "547529"
  },
  {
    "text": "you can start decrypting packets so we",
    "start": "547529",
    "end": "553560"
  },
  {
    "text": "want to be sure that that this packet number is never reused and I already mentioned for every packet that you",
    "start": "553560",
    "end": "558689"
  },
  {
    "text": "transmit it's incremented by one so now the only question is still that how is this packet number initialized and the",
    "start": "558689",
    "end": "565949"
  },
  {
    "text": "answer is here very simple when you install the key the packet number is initialized to zero the nonce is",
    "start": "565949",
    "end": "571410"
  },
  {
    "text": "initialized to zero and this makes complete sense you want a number that is only used once so you initialize it to",
    "start": "571410",
    "end": "578430"
  },
  {
    "text": "zero for every packet you sent you incremented by one so you think okay this number will probably never be",
    "start": "578430",
    "end": "585029"
  },
  {
    "text": "reused because yeah if the number would overflow you would start a completely new handshake and generate new keys",
    "start": "585029",
    "end": "590870"
  },
  {
    "text": "however we did find a way to force reuse of this nonce and the way we did that is that we can",
    "start": "590870",
    "end": "598079"
  },
  {
    "text": "force a reinstallation of the key which will again initialize this nonce to zero",
    "start": "598079",
    "end": "605000"
  },
  {
    "text": "so how does that work well let me explain the tag again with the following",
    "start": "605000",
    "end": "611130"
  },
  {
    "text": "scenario you have your client on the left that wants to connect to the access point on the right and of course we're",
    "start": "611130",
    "end": "620130"
  },
  {
    "text": "going to assume that now there is an attacker between them and the first step that attacker needs to accomplish is",
    "start": "620130",
    "end": "627180"
  },
  {
    "text": "that it needs to obtain a so-called channel based man-in-the-middle attack now what do I mean with that what I mean",
    "start": "627180",
    "end": "634529"
  },
  {
    "text": "with that is that basically the attacker clones the original access point on a",
    "start": "634529",
    "end": "639569"
  },
  {
    "text": "different channel for example let's say that the original access point is on channel 6 and the access point now",
    "start": "639569",
    "end": "646589"
  },
  {
    "text": "clones it on channel 1 now just to be clear this man on the middle position won't yet allow the attacker to decrypt",
    "start": "646589",
    "end": "653129"
  },
  {
    "text": "any packets it's simply going to forward packets because what it does will clone the access point on a different channel",
    "start": "653129",
    "end": "658920"
  },
  {
    "text": "and then the clients will try to connect to this access point on this rogue Channel in this example the client we",
    "start": "658920",
    "end": "664920"
  },
  {
    "text": "try to connect to the Terk on channel 1 on the adversary the man in the middle was simply forward the",
    "start": "664920",
    "end": "670790"
  },
  {
    "text": "frames that are sent on channel 1 to the channel 6 which is the real channel of",
    "start": "670790",
    "end": "676070"
  },
  {
    "text": "the access point ok so we can assume that the attacker has this man in the",
    "start": "676070",
    "end": "682400"
  },
  {
    "text": "middle position and this man in the middle position will allow the attacker",
    "start": "682400",
    "end": "687830"
  },
  {
    "text": "to reliably block packets because if the attacker doesn't forward a packet between these 2 different channels",
    "start": "687830",
    "end": "694520"
  },
  {
    "text": "well that's equivalent to blocking a packet from arriving at the destination",
    "start": "694520",
    "end": "700060"
  },
  {
    "text": "so what happens during the initial stage of the Wi-Fi handshake is that attacker",
    "start": "700210",
    "end": "705710"
  },
  {
    "text": "will simply forward any frames that are transmitted in particular the first",
    "start": "705710",
    "end": "710780"
  },
  {
    "text": "three messages of the four-way handshake they are simply forwarded between both devices however once the clients sends",
    "start": "710780",
    "end": "721130"
  },
  {
    "text": "message for of the four-way handshake then the adversary will not forward that",
    "start": "721130",
    "end": "726830"
  },
  {
    "text": "packet to the real access point on it will block it from arriving now it's interesting here is that if you look at",
    "start": "726830",
    "end": "733790"
  },
  {
    "text": "this perspective from the client then the 4 Way handshake completed successfully after all its received",
    "start": "733790",
    "end": "739700"
  },
  {
    "text": "message 3 of the handshake on the reply using message 4 so it thinks that the",
    "start": "739700",
    "end": "744800"
  },
  {
    "text": "handshake is complete and it will now it will now install the session key here at",
    "start": "744800",
    "end": "751160"
  },
  {
    "text": "the bottom however if we continue with the handshake then we observe that the",
    "start": "751160",
    "end": "757460"
  },
  {
    "text": "access point did not receive message for yet so according to the access point the",
    "start": "757460",
    "end": "762800"
  },
  {
    "text": "handshake hasn't completed yet and that it tries to recover from that by trying",
    "start": "762800",
    "end": "769280"
  },
  {
    "text": "to retransmit message 3 of the handshake because it assumes that this match that probably did not arrive at the client",
    "start": "769280",
    "end": "775850"
  },
  {
    "text": "and that's why it didn't get a response so the access point retransmits message 3 and in turn the client accepts",
    "start": "775850",
    "end": "784190"
  },
  {
    "text": "this message and it's replies using a new message for and interestingly this",
    "start": "784190",
    "end": "790760"
  },
  {
    "text": "message for here is encrypted at a link layer and we will abuse this observation",
    "start": "790760",
    "end": "796250"
  },
  {
    "text": "later on in the attack now why is this handshake methods suddenly encrypted at the link",
    "start": "796250",
    "end": "801920"
  },
  {
    "text": "layer well these handshake messages there are essentially normal data frames on well we installed the encryption key",
    "start": "801920",
    "end": "809240"
  },
  {
    "text": "and this is a data frame so for of course we're going to encrypt this data frame okay so the clients received this",
    "start": "809240",
    "end": "818840"
  },
  {
    "text": "retransmitted message 3-ounce it's replied using message for and the standard clearly states that whenever",
    "start": "818840",
    "end": "826190"
  },
  {
    "text": "you receive a message three you answer apply it using a message for you have to reinstall the session key and this is",
    "start": "826190",
    "end": "834170"
  },
  {
    "text": "where it goes wrong because now it will again install the encryption key and as",
    "start": "834170",
    "end": "839540"
  },
  {
    "text": "a result of that it will reset this packet number this nonce to zero on what",
    "start": "839540",
    "end": "846320"
  },
  {
    "text": "happens now if the client sends a data frame this data frame will again use a",
    "start": "846320",
    "end": "852050"
  },
  {
    "text": "packet number of one in other words if you look at these two encrypted data packets the same nonce is used which",
    "start": "852050",
    "end": "859640"
  },
  {
    "text": "also means that the same key stream is being reused so how can we now use this",
    "start": "859640",
    "end": "865160"
  },
  {
    "text": "nonce reuse to decrypt contents of this data frame well we're going to look back",
    "start": "865160",
    "end": "873800"
  },
  {
    "text": "at these two message force that have been transmitted and if we look at the",
    "start": "873800",
    "end": "879440"
  },
  {
    "text": "first message for that was sending plaintext and then the second message for which was a retransmission that was",
    "start": "879440",
    "end": "886370"
  },
  {
    "text": "sent in an encrypted way and there's a small difference between these two frames but most of the fields are the",
    "start": "886370",
    "end": "892760"
  },
  {
    "text": "same so essentially what we have is we have one version of the packet is sent as plain text on one version of the",
    "start": "892760",
    "end": "899600"
  },
  {
    "text": "packets is sent encrypted so we simply XOR these two and we get this key stream",
    "start": "899600",
    "end": "904790"
  },
  {
    "text": "that corresponds to the nonce value of one now that we have this key stream",
    "start": "904790",
    "end": "909920"
  },
  {
    "text": "well we can simply ignore it Witek with the packets that was just transmitted and we get decrypted",
    "start": "909920",
    "end": "916610"
  },
  {
    "text": "plaintext and there we go we have broken wpa2 so this explains the attack against",
    "start": "916610",
    "end": "924710"
  },
  {
    "text": "the four-way handshake now other Wi-Fi handshakes are vulnerable to similar",
    "start": "924710",
    "end": "930230"
  },
  {
    "text": "attacks for example you also have grupe handshake where we can apply a similar attack we also have the FD",
    "start": "930230",
    "end": "937639"
  },
  {
    "start": "933000",
    "end": "933000"
  },
  {
    "text": "handshake the FD handshake is used when you roam from one access point to another access point of the same network",
    "start": "937639",
    "end": "943430"
  },
  {
    "text": "ant you also have the perky handshake which is used when two client devices",
    "start": "943430",
    "end": "948740"
  },
  {
    "text": "are directly communicating with each other now I'm not going to explain this",
    "start": "948740",
    "end": "953959"
  },
  {
    "text": "in detail if you want to know all the details I'm going to refer you to our academic paper where it's explains very",
    "start": "953959",
    "end": "963440"
  },
  {
    "text": "clearly ok so we now know how to execute the attack against a four-way handshake",
    "start": "963440",
    "end": "970250"
  },
  {
    "text": "and we know that we can decrypt packets but what exactly is the impact and",
    "start": "970250",
    "end": "976100"
  },
  {
    "text": "practice ants the first thing I want to mention is the general impact of a key",
    "start": "976100",
    "end": "981800"
  },
  {
    "start": "979000",
    "end": "979000"
  },
  {
    "text": "reinstallation attack so let's say that we have a device that is vulnerable to a",
    "start": "981800",
    "end": "987320"
  },
  {
    "text": "key reinstallation attack for example this can be an access point or it can also be a client on a client means a",
    "start": "987320",
    "end": "993560"
  },
  {
    "text": "smartphone a laptop or maybe a toaster if it supports Wi-Fi that's also possible these days and if your device",
    "start": "993560",
    "end": "1001839"
  },
  {
    "text": "is vulnerable as I just explained the first thing that is possible if when it",
    "start": "1001839",
    "end": "1008199"
  },
  {
    "text": "sends encrypted data frames then we can force nonce reuse which in turn can be used to decrypt packets sent by the",
    "start": "1008199",
    "end": "1015310"
  },
  {
    "text": "device under attack but there is also a second attack that you can perform the",
    "start": "1015310",
    "end": "1022570"
  },
  {
    "text": "other thing you can do is that you can replay packets towards the device under attack now why is that possible that's",
    "start": "1022570",
    "end": "1029410"
  },
  {
    "text": "possible because if the victim reinstalls the encryption key it will also reset the receive replay counter on",
    "start": "1029410",
    "end": "1036250"
  },
  {
    "text": "the receive replay counter as the name implies it's used to detect replays and if this number is reset you can replay",
    "start": "1036250",
    "end": "1043058"
  },
  {
    "text": "old frames to the device under attack so these are the two general consequences",
    "start": "1043059",
    "end": "1049929"
  },
  {
    "text": "of a key reinstallation attack now the impact of the TAC is quite tricky to",
    "start": "1049929",
    "end": "1056799"
  },
  {
    "text": "describe because it depends on a lot of factors so I'm now going to discuss all these factors and the first factor",
    "start": "1056799",
    "end": "1064970"
  },
  {
    "text": "is that the impact depends on the specific encryption algorithm that you are using and the most widely used",
    "start": "1064970",
    "end": "1071690"
  },
  {
    "start": "1066000",
    "end": "1066000"
  },
  {
    "text": "encryption algorithm in a Wi-Fi network is ASC cmp and if this encryption",
    "start": "1071690",
    "end": "1078350"
  },
  {
    "text": "algorithm is used then the impact is in a sense limited to decrypting on replaying frames on you cannot Forge",
    "start": "1078350",
    "end": "1086000"
  },
  {
    "text": "frames so in a sense we're lucky that this is the most widely used one because here the impact is at least a bit",
    "start": "1086000",
    "end": "1092390"
  },
  {
    "text": "limited because if you are still using the older WPA TCAP encryption protocol",
    "start": "1092390",
    "end": "1098409"
  },
  {
    "text": "then the ability to decrypt frames and turn enables an attacker to recover the",
    "start": "1098409",
    "end": "1103880"
  },
  {
    "text": "authentication key which here is called a message integrity check key what this",
    "start": "1103880",
    "end": "1109909"
  },
  {
    "text": "key allows you to do is it would allow you to forge packets packets that appear",
    "start": "1109909",
    "end": "1115130"
  },
  {
    "text": "to be transmitted by the device under attack so if you would attack a client you can forge packets that are sent from",
    "start": "1115130",
    "end": "1124820"
  },
  {
    "text": "the clients to the access point now there is also a third encryption",
    "start": "1124820",
    "end": "1130940"
  },
  {
    "text": "algorithm which is called G cmp and currently people are trying to market it",
    "start": "1130940",
    "end": "1136760"
  },
  {
    "text": "under the name hwagok on some expect this algorithm to be adopted at a very",
    "start": "1136760",
    "end": "1142309"
  },
  {
    "text": "high rates of course we'll see what will happen but the impact of our attack is quite",
    "start": "1142309",
    "end": "1148970"
  },
  {
    "text": "high if G CMP would be used and the reason the impact is high because not",
    "start": "1148970",
    "end": "1155210"
  },
  {
    "text": "only can recover can we recover the authentication key if G CMP is used we",
    "start": "1155210",
    "end": "1161419"
  },
  {
    "text": "can use this authentication key in both communication directions so once we recover this key we can forged frames",
    "start": "1161419",
    "end": "1167929"
  },
  {
    "text": "sense sent from the client to the access point but also from the access point to the client so in a sense we got lucky",
    "start": "1167929",
    "end": "1175010"
  },
  {
    "text": "that G CMP isn't widely used yet because otherwise the impact would have been higher than it is today",
    "start": "1175010",
    "end": "1181570"
  },
  {
    "text": "now another thing that influences the",
    "start": "1181570",
    "end": "1186710"
  },
  {
    "start": "1184000",
    "end": "1184000"
  },
  {
    "text": "practical impacts of the attack is the specific handshake you are attacking for",
    "start": "1186710",
    "end": "1193100"
  },
  {
    "text": "example if we are targeting the group key handshake in that case we would be attacking the",
    "start": "1193100",
    "end": "1200210"
  },
  {
    "text": "clients however we would only be able to replay broadcast on multicast data to",
    "start": "1200210",
    "end": "1205970"
  },
  {
    "text": "the client so just to be clear here the group key handshake it is used to distribute the key that is used to",
    "start": "1205970",
    "end": "1212630"
  },
  {
    "text": "encrypt broadcast on multicast frames to clients now the reason the impact is",
    "start": "1212630",
    "end": "1217640"
  },
  {
    "text": "quite low for this handshake is because the client is never sending real",
    "start": "1217640",
    "end": "1223450"
  },
  {
    "text": "encrypted broadcast frames why is that the case well let's say we have the",
    "start": "1223450",
    "end": "1230360"
  },
  {
    "text": "network shown here on the client on the left wants to send a broadcast frame the",
    "start": "1230360",
    "end": "1235460"
  },
  {
    "text": "way this is done on a Wi-Fi network is the client first sends this broadcast data frame as a unicast Wi-Fi frame to",
    "start": "1235460",
    "end": "1243680"
  },
  {
    "text": "the access point and then the access point broadcasts it as a real Wi-Fi",
    "start": "1243680",
    "end": "1248990"
  },
  {
    "text": "broadcast frame and the ideas that 10 all clients connected to the access point will receive this frame but this",
    "start": "1248990",
    "end": "1255260"
  },
  {
    "text": "implies that the client is never sending actual encrypted broadcast Wi-Fi frames",
    "start": "1255260",
    "end": "1260480"
  },
  {
    "text": "meaning code it will never reuse the nonce when sending broadcast data because well it just never sends",
    "start": "1260480",
    "end": "1266990"
  },
  {
    "text": "broadcast frames however we can attack the client on to reset its replay counter meaning we are able to replay a",
    "start": "1266990",
    "end": "1273590"
  },
  {
    "text": "broadcast data towards the client however the ability to replay broadcast",
    "start": "1273590",
    "end": "1279020"
  },
  {
    "text": "data and practice the impact of that is usually quite low however if you would",
    "start": "1279020",
    "end": "1286010"
  },
  {
    "text": "be attacking the four-way handshake like I just explained then we are again attacking the clients on in this case we",
    "start": "1286010",
    "end": "1292160"
  },
  {
    "text": "can generally replay on the Crypt frames and depending on an encryption algorithm",
    "start": "1292160",
    "end": "1297230"
  },
  {
    "text": "we might also be able to forge frames our third handshake we can attack is the",
    "start": "1297230",
    "end": "1303290"
  },
  {
    "text": "FT handshake as mentioned this handshake is used when you roam from one access",
    "start": "1303290",
    "end": "1308450"
  },
  {
    "text": "point of a network to the same network but a different access points on this handshake is to switch you very quickly",
    "start": "1308450",
    "end": "1315680"
  },
  {
    "text": "between these two access points and against this handshake we are attacking",
    "start": "1315680",
    "end": "1321260"
  },
  {
    "text": "the access point of not a client and again the impact is the same as the",
    "start": "1321260",
    "end": "1326450"
  },
  {
    "text": "four-way handshake we can replay on the curved frames and possibly we can for frames however unimportant remark when",
    "start": "1326450",
    "end": "1334580"
  },
  {
    "text": "you attack the FD handshake is that it's easier to attack because we no longer",
    "start": "1334580",
    "end": "1341060"
  },
  {
    "text": "need this channel based man in the middle position to block certain packets from arriving at the destination as an",
    "start": "1341060",
    "end": "1347570"
  },
  {
    "text": "attacker we simply need to be near the victim we need to be able to sniff the packets that the client is transmitting",
    "start": "1347570",
    "end": "1355520"
  },
  {
    "text": "and then we can simply replay that packets continuously to cause these nonce resets in the access point so to",
    "start": "1355520",
    "end": "1362240"
  },
  {
    "text": "summarize when you take the four way handshake you need this channel based man in the middle attack but when you attack the FD handshake you don't need a",
    "start": "1362240",
    "end": "1369500"
  },
  {
    "text": "man in the middle attack you simply need to be close to the device so it's much easier to attack now another elements",
    "start": "1369500",
    "end": "1377690"
  },
  {
    "text": "that influence the impact of the attack is the specific implementation you are",
    "start": "1377690",
    "end": "1382700"
  },
  {
    "start": "1380000",
    "end": "1380000"
  },
  {
    "text": "attacking for example if we consider iOS 10 or Windows then the four-way",
    "start": "1382700",
    "end": "1389150"
  },
  {
    "text": "handshake is not vulnerable because these two optimum operating systems don't really follow the standard in",
    "start": "1389150",
    "end": "1397030"
  },
  {
    "text": "particular they do not accept on process retransmissions of MAGIX three of the",
    "start": "1397030",
    "end": "1403700"
  },
  {
    "text": "handshake and as a result you can't apply the key reinstallation attack however I do want to remark here that",
    "start": "1403700",
    "end": "1410810"
  },
  {
    "text": "these two operating systems are vulnerable to the group key handshake attack which allows you to replay",
    "start": "1410810",
    "end": "1416630"
  },
  {
    "text": "broadcast frames for some applications that can be a security issue but again",
    "start": "1416630",
    "end": "1421640"
  },
  {
    "text": "the impact is lower than being able to decrypt unicast traffic of course one",
    "start": "1421640",
    "end": "1429380"
  },
  {
    "text": "remark here I also want to give is that if you use iOS 11 it does accept retransmissions of message 3 meaning the",
    "start": "1429380",
    "end": "1436910"
  },
  {
    "text": "four-way handshake is vulnerable at least if you use an unpatched iOS 10 device now against linux we also found a",
    "start": "1436910",
    "end": "1445250"
  },
  {
    "text": "very interesting flaw namely if you use the Wi-Fi client on linux which is",
    "start": "1445250",
    "end": "1450860"
  },
  {
    "text": "called wks applicants and in particular if you use version 2.4 or higher then",
    "start": "1450860",
    "end": "1457720"
  },
  {
    "text": "instead of reinstalling the key it will install an all-zero encryption key and",
    "start": "1457720",
    "end": "1462940"
  },
  {
    "text": "then of course all the other security is gone now how is it possible that this",
    "start": "1462940",
    "end": "1469940"
  },
  {
    "text": "client is installing an all-zero encryption key I mean you're probably thinking why on earth are they doing",
    "start": "1469940",
    "end": "1475010"
  },
  {
    "text": "that well to explain this let's again use a scenario where the client in this",
    "start": "1475010",
    "end": "1481940"
  },
  {
    "text": "case the Android is connecting to the access points on the right and in this case we're going to zoom in a bit on the",
    "start": "1481940",
    "end": "1488750"
  },
  {
    "text": "Android device and we're going to look at two components that implement Wi-Fi we have first here on the Left WPA",
    "start": "1488750",
    "end": "1496909"
  },
  {
    "text": "supplicant which implements the four-way handshake and we also have the kernel in this case Linux which will take the",
    "start": "1496909",
    "end": "1503929"
  },
  {
    "text": "negotiated encryption key and we'll use it to encrypt data frames and the way",
    "start": "1503929",
    "end": "1511549"
  },
  {
    "text": "the tech now works to cause Android or Linux into using this all zero",
    "start": "1511549",
    "end": "1517279"
  },
  {
    "text": "encryption key is that we again assume that we have a man on the middle",
    "start": "1517279",
    "end": "1522799"
  },
  {
    "text": "position so again as an attacker you are able to block packets on similar to a normal key reinstallation attack we",
    "start": "1522799",
    "end": "1530529"
  },
  {
    "text": "execute the first part of the 4 Way handshake without any modification we simply forward the frames",
    "start": "1530529",
    "end": "1536450"
  },
  {
    "text": "however the attacker does not forward message for to the access point which is",
    "start": "1536450",
    "end": "1542899"
  },
  {
    "text": "completely the same idea as when attacking the four-way handshake sorry in a normal situation now the",
    "start": "1542899",
    "end": "1550730"
  },
  {
    "text": "particular thing that WPA supplicants on linux does is that after receiving",
    "start": "1550730",
    "end": "1557929"
  },
  {
    "text": "message 3 on sending message for it will command the Linux kernel into installing",
    "start": "1557929",
    "end": "1563419"
  },
  {
    "text": "the negotiated encryption key on the Linux kernel in turn will instruct a driver to save this encryption key so",
    "start": "1563419",
    "end": "1570799"
  },
  {
    "text": "the driver can then start encrypting data frames now this means that encryption key is stored in the driver",
    "start": "1570799",
    "end": "1576230"
  },
  {
    "text": "and WPA supplicants no longer needs to keep track of this encryption key so it",
    "start": "1576230",
    "end": "1581929"
  },
  {
    "text": "will clear it from memory and it will set this buffer where the encryption key is saved to all zeros so if we now",
    "start": "1581929",
    "end": "1589039"
  },
  {
    "text": "continue with the handshake and while with the attack on if the access point now retransmits",
    "start": "1589039",
    "end": "1594799"
  },
  {
    "text": "matches message 3 then WPS applicant will accept this mess - a reply using message four and then it",
    "start": "1594799",
    "end": "1602150"
  },
  {
    "text": "will try to reinstall the key on it will instruct a Linux kernel into saying hey please install this encryption key on",
    "start": "1602150",
    "end": "1608900"
  },
  {
    "text": "this encryption key is saved at this bug buffer in my memory but of course that buffer has been cleared it's all zeros",
    "start": "1608900",
    "end": "1615220"
  },
  {
    "text": "so now it's instructing the Linux kernel kernel to install an all zero key and of",
    "start": "1615220",
    "end": "1620630"
  },
  {
    "text": "course once you're using an all zero key you can intercept all data that the client is transmitting on you can also",
    "start": "1620630",
    "end": "1626630"
  },
  {
    "text": "send any data to the client that you want so at this point you may be",
    "start": "1626630",
    "end": "1632630"
  },
  {
    "text": "wondering like is my device affected and you can use the scripts at the following",
    "start": "1632630",
    "end": "1639380"
  },
  {
    "text": "URL to test if your device is affected by an attack you can use these scripts",
    "start": "1639380",
    "end": "1645620"
  },
  {
    "text": "to test both client devices and also access points and I personally tested",
    "start": "1645620",
    "end": "1651620"
  },
  {
    "text": "this on Kali Linux so it works on for example a virtual machine now I do",
    "start": "1651620",
    "end": "1658370"
  },
  {
    "text": "advise you to use a Wi-Fi tunnel that we tested or someone else has successfully used because sometimes the hardware",
    "start": "1658370",
    "end": "1665720"
  },
  {
    "text": "encryption of the Wi-Fi dongle might interfere with our test script so if you use these scripts try to disable",
    "start": "1665720",
    "end": "1672080"
  },
  {
    "text": "hardware encryption and use a Wi-Fi dongle that we tested because otherwise these scripts might not be reliable and",
    "start": "1672080",
    "end": "1681640"
  },
  {
    "text": "one thing you're likely going to notice is when you are going to test if devices",
    "start": "1681640",
    "end": "1687410"
  },
  {
    "text": "are affected affect it is that some clients will still be affected anteye",
    "start": "1687410",
    "end": "1693020"
  },
  {
    "start": "1691000",
    "end": "1691000"
  },
  {
    "text": "will also be affected and half-a-year underneath on the new year because they don't get updates luckily we can try to",
    "start": "1693020",
    "end": "1701990"
  },
  {
    "text": "mitigate this problem somewhat in particular we can modify the access",
    "start": "1701990",
    "end": "1707240"
  },
  {
    "text": "point so that clients that are connected to such modified access points are not",
    "start": "1707240",
    "end": "1713120"
  },
  {
    "text": "vulnerable to the most serious attacks that we discovered in particular if we modify an access point such that it no",
    "start": "1713120",
    "end": "1719570"
  },
  {
    "text": "longer retransmits message 3 on the and that it doesn't retransmit the first",
    "start": "1719570",
    "end": "1724640"
  },
  {
    "text": "message of the group key handshake then any client that is connected to such a modified access points",
    "start": "1724640",
    "end": "1731429"
  },
  {
    "text": "it's no longer can no longer be attacked against a four-way and group K handshake",
    "start": "1731429",
    "end": "1736789"
  },
  {
    "text": "now it's even though this works it's a bit unclear what the impact on practice",
    "start": "1736789",
    "end": "1743009"
  },
  {
    "text": "is about his modification because it might make the handshake a bit more and clearer for example when there's a lot",
    "start": "1743009",
    "end": "1749580"
  },
  {
    "text": "of noise on frames are lost on of course it's still the case that if you're vulnerable device is connected to an",
    "start": "1749580",
    "end": "1755969"
  },
  {
    "text": "access point that doesn't implement these extra modifications then of course can still be attacked but for example if",
    "start": "1755969",
    "end": "1762809"
  },
  {
    "text": "you're a hospital ants you can't update your client devices then modifying your access point in this way is one option",
    "start": "1762809",
    "end": "1769200"
  },
  {
    "text": "to greatly reduce the impacts of our findings okay so when I was reading the",
    "start": "1769200",
    "end": "1779309"
  },
  {
    "text": "internet about my research I discovered a lot of misconceptions on discussions about the attack so I'm going to discuss",
    "start": "1779309",
    "end": "1787169"
  },
  {
    "text": "a few that I encountered and one of the first misconceptions that I saw is that",
    "start": "1787169",
    "end": "1793289"
  },
  {
    "text": "it was claimed that you only have to update the clients or the access point",
    "start": "1793289",
    "end": "1799190"
  },
  {
    "start": "1794000",
    "end": "1794000"
  },
  {
    "text": "now of course if your access point implements these extra modifications that I just mentioned then you can get",
    "start": "1799190",
    "end": "1807089"
  },
  {
    "text": "away with only updating the access points however most updates of Wi-Fi access points simply fix the flaws in",
    "start": "1807089",
    "end": "1813450"
  },
  {
    "text": "the access point and they don't include these extra countermeasures so in general you need to update both your",
    "start": "1813450",
    "end": "1819809"
  },
  {
    "text": "access point and your clients if they are vulnerable another remark that is",
    "start": "1819809",
    "end": "1826289"
  },
  {
    "text": "often made is yeah it's a nice attack but you need to be physically close to the victim on the network in order to",
    "start": "1826289",
    "end": "1833580"
  },
  {
    "text": "pull off this attack but that's not really the case because we can use special antenna to be able to manipulate",
    "start": "1833580",
    "end": "1841889"
  },
  {
    "text": "a Wi-Fi network that is quite far away for example researchers have shown that",
    "start": "1841889",
    "end": "1847259"
  },
  {
    "text": "a connect can connect to a network that is up to two miles away and if we looked at leaks and as a documents of Snowden",
    "start": "1847259",
    "end": "1854879"
  },
  {
    "text": "then the NSA also made their own custom antenna on in their slides they",
    "start": "1854879",
    "end": "1860190"
  },
  {
    "text": "mentioned that they were able to attack a Wi-Fi network up to eight miles away of course they had a clear line of",
    "start": "1860190",
    "end": "1866720"
  },
  {
    "text": "sight but you know if the NSA can do eight miles we can surely do two miles",
    "start": "1866720",
    "end": "1872860"
  },
  {
    "text": "another misconception that I heard is that as the attacker you need to be able",
    "start": "1872860",
    "end": "1879020"
  },
  {
    "text": "to connect to the network yourself you need to be somehow associated to the network you're trying to attack which in",
    "start": "1879020",
    "end": "1885350"
  },
  {
    "text": "practice would mean you have the password of the network but this is not the case you don't need to know anything",
    "start": "1885350",
    "end": "1890600"
  },
  {
    "text": "about a network you simply need to be close enough to the victim onto the access point and then you can carry out",
    "start": "1890600",
    "end": "1896600"
  },
  {
    "text": "the attack so another important remark",
    "start": "1896600",
    "end": "1902900"
  },
  {
    "text": "is that you might say that okay you can decrypt data frames that are sent right",
    "start": "1902900",
    "end": "1910220"
  },
  {
    "text": "after the four-way handshake but in general when you just connect it to a network your device isn't really sending",
    "start": "1910220",
    "end": "1917960"
  },
  {
    "text": "interesting traffic I mean it's sending ARP requests it's ending DHCP packets but there is no",
    "start": "1917960",
    "end": "1923240"
  },
  {
    "text": "useful data at that point of the connection however what we can do is we",
    "start": "1923240",
    "end": "1929780"
  },
  {
    "text": "can first let the victim connect to the access points the victim will start surfing the internet on at that point",
    "start": "1929780",
    "end": "1935510"
  },
  {
    "text": "when it's already actively connected to the internet when it has open TCP connections what we can do then is we",
    "start": "1935510",
    "end": "1941990"
  },
  {
    "text": "can do tentacle the Wi-Fi clients from the network and then all operating",
    "start": "1941990",
    "end": "1948380"
  },
  {
    "text": "systems will immediately try to perform a new four-way handshake on this four-way handshake is performed while",
    "start": "1948380",
    "end": "1954860"
  },
  {
    "text": "the TCP connections are still open and running on in this case the four Way",
    "start": "1954860",
    "end": "1960080"
  },
  {
    "text": "handshake then completes and immediately after that the client will send any cute data of these TCP connections and we can",
    "start": "1960080",
    "end": "1967610"
  },
  {
    "text": "use that to then decrypt interesting data frames so to summarize we can",
    "start": "1967610",
    "end": "1973669"
  },
  {
    "text": "trigger these four-way handshakes whenever we expect a client to send interesting data another misconception",
    "start": "1973669",
    "end": "1982400"
  },
  {
    "text": "is that if you attack the four-way handshake you need to obtain this special channel based man-in-the-middle",
    "start": "1982400",
    "end": "1989419"
  },
  {
    "text": "position and you might say yeah but that might be hard to do because in order to",
    "start": "1989419",
    "end": "1994669"
  },
  {
    "text": "trick the clients and to attack in your rope access points you need to have a high signal strength",
    "start": "1994669",
    "end": "2001410"
  },
  {
    "text": "however there is a way to work around this because as an attacker we can send special channel switch announcements",
    "start": "2001410",
    "end": "2008350"
  },
  {
    "text": "which force the clients into connecting to the access point on a different",
    "start": "2008350",
    "end": "2013480"
  },
  {
    "text": "channel so we can basically instruct your device hey and the access point and now I'm now",
    "start": "2013480",
    "end": "2019480"
  },
  {
    "text": "on this different channel and you need to use this different channel so we can send the special frames to command the",
    "start": "2019480",
    "end": "2025150"
  },
  {
    "text": "clients into connecting to a rogue access point and this does not rely on the signal strength that we as an",
    "start": "2025150",
    "end": "2031300"
  },
  {
    "text": "attacker have now another remark is that okay implementing these attacks is hard",
    "start": "2031300",
    "end": "2038050"
  },
  {
    "text": "and I can agree with that you do need to have some backgrounds in order to",
    "start": "2038050",
    "end": "2043390"
  },
  {
    "text": "implement these attacks but once you have written the script well then you can just execute the script on everyone",
    "start": "2043390",
    "end": "2049929"
  },
  {
    "text": "everyone can perform the attack it's the same with a tricky zero J or a zero or",
    "start": "2049930",
    "end": "2054970"
  },
  {
    "text": "tricky buffer overflow yeah it can be time-consuming to write but once you it's written you know you can just",
    "start": "2054970",
    "end": "2061659"
  },
  {
    "text": "execute the script and start carrying out attacks then some final",
    "start": "2061660",
    "end": "2067240"
  },
  {
    "text": "misconceptions and I personally found these the most strange ones is that I",
    "start": "2067240",
    "end": "2072870"
  },
  {
    "text": "sometimes read that yeah if you use a CSC CMP and then you don't need really need to worry but as I explained if you",
    "start": "2072870",
    "end": "2080320"
  },
  {
    "text": "use a SCC MP it's still possible to decrypt frames on to replay frames the",
    "start": "2080320",
    "end": "2085570"
  },
  {
    "text": "only thing that is not possible if you use a CSC CMP is to forge packets",
    "start": "2085570",
    "end": "2092129"
  },
  {
    "text": "another remark is that enterprise networks so those that use either on the",
    "start": "2092130",
    "end": "2097480"
  },
  {
    "text": "802 dot 1x authentication for example with a username on a password that they aren't affected but that's not the case",
    "start": "2097480",
    "end": "2104380"
  },
  {
    "text": "because in practice every protected Wi-Fi network is affected because all of",
    "start": "2104380",
    "end": "2110080"
  },
  {
    "text": "them at once at one point when connecting to the network they will use the four way",
    "start": "2110080",
    "end": "2115900"
  },
  {
    "text": "handshake meaning they can be attacked now then there are also other people who say wow this is very serious this is the",
    "start": "2115900",
    "end": "2123310"
  },
  {
    "text": "end of the world but let's not get carried away yes this is a serious vulnerability it",
    "start": "2123310",
    "end": "2130410"
  },
  {
    "text": "is also very surprising because we had these formal proofs yet now it's still vulnerable I think that's the most",
    "start": "2130410",
    "end": "2136529"
  },
  {
    "text": "interesting part really about this work these protocols were mathematically proven to be secure yet we still found",
    "start": "2136529",
    "end": "2142799"
  },
  {
    "text": "an attack so yeah we have to patch this but let's also not get carried away with saying that this is the end of the world",
    "start": "2142799",
    "end": "2149219"
  },
  {
    "text": "it's not so as the final part of the presentation I'm going to discuss a few",
    "start": "2149219",
    "end": "2155449"
  },
  {
    "text": "lessons that we can learn from this research and well I already mentioned",
    "start": "2155449",
    "end": "2161759"
  },
  {
    "text": "the first one is that the four-way handshake was proven to be secure on to the encryption protocol after it in",
    "start": "2161759",
    "end": "2168029"
  },
  {
    "start": "2162000",
    "end": "2162000"
  },
  {
    "text": "particular a sec MP that has also been proven to be secure but interestingly",
    "start": "2168029",
    "end": "2174029"
  },
  {
    "text": "when we combine both of these technologies then things go wrong on",
    "start": "2174029",
    "end": "2181859"
  },
  {
    "text": "what goes wrong is that this encryption protocol it's precondition is that a",
    "start": "2181859",
    "end": "2188160"
  },
  {
    "text": "particular nonce value should only be used once however when you combine the encryption protocol with the four-way",
    "start": "2188160",
    "end": "2194519"
  },
  {
    "text": "handshake then we can avoid this assumption and cause this non-spell you this packet",
    "start": "2194519",
    "end": "2199979"
  },
  {
    "text": "number to be reused meaning the proof of the encryption protocol and no longer applies another remark regarding these",
    "start": "2199979",
    "end": "2208739"
  },
  {
    "text": "formal proofs is that a different way to look at it is that the proof of the 4",
    "start": "2208739",
    "end": "2214619"
  },
  {
    "text": "Way handshake did not model these retransmissions of message 3 of the",
    "start": "2214619",
    "end": "2220140"
  },
  {
    "text": "handshake so you can also say that the abstract model that was used in these proofs didn't really reflect reality and",
    "start": "2220140",
    "end": "2228679"
  },
  {
    "text": "there's a nice quote describing this by Einstein where he said you know in theory theory and practice all are the",
    "start": "2228679",
    "end": "2235229"
  },
  {
    "text": "same which in this case you interpret us yeah it's been proven correct so surely",
    "start": "2235229",
    "end": "2240539"
  },
  {
    "text": "and practice we're secure as well but of course we as hackers know that and practice things can always still go",
    "start": "2240539",
    "end": "2246959"
  },
  {
    "text": "wrong as we have shown here now a second",
    "start": "2246959",
    "end": "2252269"
  },
  {
    "text": "lesson that we can learn from this research is that we should keep protocols on implementations simple",
    "start": "2252269",
    "end": "2258779"
  },
  {
    "start": "2256000",
    "end": "2256000"
  },
  {
    "text": "because they are easy to mess up and one example is that during",
    "start": "2258779",
    "end": "2264990"
  },
  {
    "text": "the research we stopped studied version 2.6 of WPS applicants on we thought that",
    "start": "2264990",
    "end": "2272600"
  },
  {
    "text": "it wasn't vulnerable to an attack against a four-way handshake but it",
    "start": "2272600",
    "end": "2279390"
  },
  {
    "text": "turned out that once we were not a fine companies someone did find a method to",
    "start": "2279390",
    "end": "2285390"
  },
  {
    "text": "exploit w place applicants two point six so the lesson here is even we didn't",
    "start": "2285390",
    "end": "2292440"
  },
  {
    "text": "immediately find this attack so really it's it's just very hard to sometimes manually audit programs and",
    "start": "2292440",
    "end": "2299310"
  },
  {
    "text": "the way to address this ideally would be to firmly formally verify implementations or at least important",
    "start": "2299310",
    "end": "2306420"
  },
  {
    "text": "parts such as a crypto implementation another example here is that another",
    "start": "2306420",
    "end": "2314210"
  },
  {
    "text": "vulnerability that was discovered is that when the four-way handshake is used",
    "start": "2314210",
    "end": "2319560"
  },
  {
    "text": "to rekey the session key then we found that host apd which is the access point",
    "start": "2319560",
    "end": "2326190"
  },
  {
    "text": "used an open source access point then it reused the previous a nonce value and we",
    "start": "2326190",
    "end": "2333330"
  },
  {
    "text": "also discovered a popular popular clients I'm not going to name them yet because I think they still have to patch",
    "start": "2333330",
    "end": "2339210"
  },
  {
    "text": "it they also reuse the ethanol's so the supplicant random number and we call",
    "start": "2339210",
    "end": "2344730"
  },
  {
    "text": "these the anals on the s nons they are the random numbers that are combined with this pre-shared key to derive",
    "start": "2344730",
    "end": "2350070"
  },
  {
    "text": "unique session key now of course if during your wiki you are both using",
    "start": "2350070",
    "end": "2355170"
  },
  {
    "text": "exactly the same random number as before then you will renegotiate exactly the same key meaning you will again have key",
    "start": "2355170",
    "end": "2362580"
  },
  {
    "text": "reuse so this is actually quite a strange situation because normally",
    "start": "2362580",
    "end": "2367770"
  },
  {
    "text": "people recommend to regularly regularly rekey your session key because this is",
    "start": "2367770",
    "end": "2373230"
  },
  {
    "text": "supposed to make attacks harder however if you have a vulnerable implementation then it might actually reduce your",
    "start": "2373230",
    "end": "2380310"
  },
  {
    "text": "security for example if you use this client with hostapd then you should not be rekeying your session key and",
    "start": "2380310",
    "end": "2388430"
  },
  {
    "text": "interestingly in documents that are leaked by Wikipedia by WikiLeaks",
    "start": "2388430",
    "end": "2395010"
  },
  {
    "text": "in particular certain CIA CIA documents there they also warned that rekeying",
    "start": "2395010",
    "end": "2402450"
  },
  {
    "text": "functionality introduces unnecessary complexity and therefore this might introduce bugs and this magic matches",
    "start": "2402450",
    "end": "2410070"
  },
  {
    "text": "very well with what we just found we found that if you try to add features to a protocol for example efficient",
    "start": "2410070",
    "end": "2416970"
  },
  {
    "text": "rekeying functionality well that increases the implied complexity of the protocol and increases",
    "start": "2416970",
    "end": "2422940"
  },
  {
    "text": "the complexity of the codes and that can lead to vulnerability so the lesson here is keep your protocols simple and keep",
    "start": "2422940",
    "end": "2429720"
  },
  {
    "text": "your implementation simple as well and finally the last lesson that we can",
    "start": "2429720",
    "end": "2435540"
  },
  {
    "start": "2435000",
    "end": "2435000"
  },
  {
    "text": "learn is that the specifications on the standards that we use they need to be",
    "start": "2435540",
    "end": "2441320"
  },
  {
    "text": "sufficiently rigorous in particular if",
    "start": "2441320",
    "end": "2447060"
  },
  {
    "text": "you look at the early version of the wpa2 standard then the state machine",
    "start": "2447060",
    "end": "2452820"
  },
  {
    "text": "which which describes how the Wi-Fi client is supposed to be implemented it doesn't really define when messages are",
    "start": "2452820",
    "end": "2459240"
  },
  {
    "text": "accepted you simply have this kind of pseudo code now you don't need to be able to read this but basically this",
    "start": "2459240",
    "end": "2465150"
  },
  {
    "text": "code says that what should happen if you receive a particular message but it does",
    "start": "2465150",
    "end": "2470580"
  },
  {
    "text": "not say when a particular message is supposed to be accepted or not and in practice we see that iOS 10 on Windows",
    "start": "2470580",
    "end": "2478830"
  },
  {
    "text": "indeed don't accept retransmissions of message 3 now I can forgive them a bit",
    "start": "2478830",
    "end": "2484109"
  },
  {
    "text": "because the standard was unclear if you look at an amendment to the Wi-Fi",
    "start": "2484109",
    "end": "2489510"
  },
  {
    "text": "standard we can see that it now better defines the state machine we now have this block diagram here on the right",
    "start": "2489510",
    "end": "2495990"
  },
  {
    "text": "which better shows the steps that have to be worked through so it's more clear when certain messages have to be",
    "start": "2495990",
    "end": "2502560"
  },
  {
    "text": "accepted but still if you look at it some terms on cases are still a bit",
    "start": "2502560",
    "end": "2507840"
  },
  {
    "text": "unclear ok so before I finish the talk I",
    "start": "2507840",
    "end": "2514230"
  },
  {
    "text": "want to make one last remark if there are people of if there are university",
    "start": "2514230",
    "end": "2521369"
  },
  {
    "text": "people researcher in this audience and if you are working",
    "start": "2521369",
    "end": "2526400"
  },
  {
    "text": "security protocols then consider submitting your work to this conference it is specifically aimed to testing the",
    "start": "2526400",
    "end": "2532910"
  },
  {
    "text": "security of security protocols implementation so if you work in academia look up this workshop with that",
    "start": "2532910",
    "end": "2539720"
  },
  {
    "text": "I conclude the talk thank you all for attending and if you have questions feel free to ask",
    "start": "2539720",
    "end": "2545970"
  },
  {
    "text": "[Applause]",
    "start": "2545970",
    "end": "2554020"
  },
  {
    "text": "hi there from the back I have a good question we found out yesterday that Apple just in the past week in iOS 11 to",
    "start": "2558950",
    "end": "2567020"
  },
  {
    "text": "patch this this vulnerability for devices other than the iPhone 10 or the",
    "start": "2567020",
    "end": "2573930"
  },
  {
    "text": "iPad pro any thoughts on why it might have taken so long like you said iOS iOS 11 had some vulnerabilities I don't know",
    "start": "2573930",
    "end": "2582660"
  },
  {
    "text": "why it has taken so long maybe they use a different implementation because I do know the difference between iOS 10 on 11",
    "start": "2582660",
    "end": "2589319"
  },
  {
    "text": "is that iOS 10 doesn't accept retransmissions of message 3 while iOS 11 does so maybe there are some",
    "start": "2589319",
    "end": "2596490"
  },
  {
    "text": "implementation issues that the code is different but of course I don't know the details about the code that Apple is",
    "start": "2596490",
    "end": "2602130"
  },
  {
    "text": "using so hi I just wanted to clear up so",
    "start": "2602130",
    "end": "2611730"
  },
  {
    "text": "in the normal situation of the 4 Way handshake message for sent by the client to the access point is unencrypted",
    "start": "2611730",
    "end": "2619049"
  },
  {
    "text": "that's before the installation of the key right yes so normally message for",
    "start": "2619049",
    "end": "2624180"
  },
  {
    "text": "should be sent an encrypted yeah and then when the attacker who's in the middle blocks a message for and then the",
    "start": "2624180",
    "end": "2631589"
  },
  {
    "text": "second time message for a sent that's encrypted isn't that unexpected from the",
    "start": "2631589",
    "end": "2637200"
  },
  {
    "text": "point of view of the AP how does the AP handle this yes that is indeed unexpected because the Wi-Fi standard if",
    "start": "2637200",
    "end": "2644520"
  },
  {
    "text": "you read it very carefully says that message for should always be sent unencrypted however we found that nearly",
    "start": "2644520",
    "end": "2650579"
  },
  {
    "text": "all implementations will send it in an encrypted way and when the access point receives this encrypted message it will",
    "start": "2650579",
    "end": "2657480"
  },
  {
    "text": "just drop it because the access point hasn't yet installed the key meaning eventually the handshake will timeout",
    "start": "2657480",
    "end": "2662970"
  },
  {
    "text": "so that's actually a reliability problem in implementations and to prevent the",
    "start": "2662970",
    "end": "2668430"
  },
  {
    "text": "access point from dropping it could the attacker maybe block this message as well and then after can it replay the",
    "start": "2668430",
    "end": "2676740"
  },
  {
    "text": "previous unencrypted frame that it had blocked so you're asking whether we can",
    "start": "2676740",
    "end": "2684000"
  },
  {
    "text": "replay the the first first message for ya that was initially yes so that depends on the",
    "start": "2684000",
    "end": "2691350"
  },
  {
    "text": "specific access point implementation for example the open source host APD access",
    "start": "2691350",
    "end": "2697170"
  },
  {
    "text": "point if you then reap if you then forward this old message for then it",
    "start": "2697170",
    "end": "2703200"
  },
  {
    "text": "will accept it however other access points will no longer accept this older message for",
    "start": "2703200",
    "end": "2708210"
  },
  {
    "text": "because they only accept the most recent one so it depends on implementation thank you any other questions",
    "start": "2708210",
    "end": "2723380"
  },
  {
    "text": "hey thank you for the great talk have a quick question if we pass all access",
    "start": "2730910",
    "end": "2736530"
  },
  {
    "text": "points which no longer will transmit the message three why should I also touch my",
    "start": "2736530",
    "end": "2742260"
  },
  {
    "text": "client so of course if you are somehow",
    "start": "2742260",
    "end": "2747840"
  },
  {
    "text": "able to test to patch every access point that exists then you reduce the impact",
    "start": "2747840",
    "end": "2755520"
  },
  {
    "text": "of the attack but it's still possible to under certain special cases detected",
    "start": "2755520",
    "end": "2762570"
  },
  {
    "text": "group key handshake so you would still be able to sometimes replay broadcast or multicast frames so of course if you",
    "start": "2762570",
    "end": "2770010"
  },
  {
    "text": "live in and I am a deal world and you can fetch every access point then yeah you can great really reduce the impact",
    "start": "2770010",
    "end": "2776370"
  },
  {
    "text": "of the attack but in practice that's not an option but for when Jake is no longer",
    "start": "2776370",
    "end": "2781650"
  },
  {
    "text": "concerned if you then if you patch the",
    "start": "2781650",
    "end": "2786750"
  },
  {
    "text": "access points on your client is connected to the patched access points you can no longer attack the four way handshaking and you can't attack the",
    "start": "2786750",
    "end": "2793050"
  },
  {
    "text": "group key handshake however there are other ways to still mess with the group key but the four-way handshake is safe",
    "start": "2793050",
    "end": "2799560"
  },
  {
    "text": "then okay thank you",
    "start": "2799560",
    "end": "2802550"
  },
  {
    "text": "no more questions",
    "start": "2809959",
    "end": "2813469"
  },
  {
    "text": "okay again thank you for attending the talk [Applause]",
    "start": "2818970",
    "end": "2830609"
  }
]