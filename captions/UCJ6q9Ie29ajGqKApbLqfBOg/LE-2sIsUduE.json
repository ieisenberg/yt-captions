[
  {
    "text": "at the conference and produced by the sound of knowledge [Music]",
    "start": "240",
    "end": "12480"
  },
  {
    "text": "Incorporated uh sorry for the long wait uh we've had some uh technical problems um damn IBM think pads uh I don't know I",
    "start": "12480",
    "end": "21359"
  },
  {
    "text": "guess rainforce Hy had some problems with his at the last uh KAC West Conference and it looks like we're",
    "start": "21359",
    "end": "26760"
  },
  {
    "text": "having the exact same problems um anyhow I think we've got a workr",
    "start": "26760",
    "end": "32320"
  },
  {
    "text": "um yeah um does this work yeah now it works excellent so yeah we will be talking",
    "start": "32320",
    "end": "38879"
  },
  {
    "text": "about firewall 1 and I have the pleasure well my name is Thomas letic I have the pleasure to be here with duck song and",
    "start": "38879",
    "end": "45360"
  },
  {
    "text": "John McDonald two really smart guys and um we will be showing you some things that we used during the past few months",
    "start": "45360",
    "end": "52640"
  },
  {
    "text": "to go through 51 installations real world installations that is um we have",
    "start": "52640",
    "end": "59760"
  },
  {
    "text": "been put a lot of research into that because um John and I are at a consulting company and we have found",
    "start": "59760",
    "end": "65439"
  },
  {
    "text": "that and our customers they they just have 51 installation and that's why we",
    "start": "65439",
    "end": "70680"
  },
  {
    "text": "had a closer look at it and um well we found some interesting stuff that we're going to share with you today um we have",
    "start": "70680",
    "end": "76759"
  },
  {
    "text": "changed the whole concept of the presentation a bit because we thought we it might make more sense to make certain",
    "start": "76759",
    "end": "83000"
  },
  {
    "text": "things first and delay certain other things so um you will have to do a bit of um jumping between different pages",
    "start": "83000",
    "end": "90799"
  },
  {
    "text": "because we have reordered our PowerPoint presentations whereas your um folders have not been reordered it's more fun",
    "start": "90799",
    "end": "97759"
  },
  {
    "text": "this way but um I think I think it it will still work so um what we have been",
    "start": "97759",
    "end": "103520"
  },
  {
    "text": "looking at um in the beginning was uh checkpoint F1 version 4.0 service PC 5",
    "start": "103520",
    "end": "109159"
  },
  {
    "text": "because um well we were using the Nokia IP 440 that you can see here and um it always took a while in the past until",
    "start": "109159",
    "end": "116520"
  },
  {
    "text": "Nokia made those latest versions available um so so that um the",
    "start": "116520",
    "end": "122039"
  },
  {
    "text": "interesting thing is that about four weeks before the conference where we intended to give checkpoint notice of",
    "start": "122039",
    "end": "128479"
  },
  {
    "text": "what we are going to present um four weeks before the conference we wanted to give them four weeks to fix everything",
    "start": "128479",
    "end": "133760"
  },
  {
    "text": "and then come up with fixes on this day today they contact actually us so we didn't have to contact them but they",
    "start": "133760",
    "end": "139959"
  },
  {
    "text": "contacted us and they were very very cooperative and they provided us with a latest version also for the noia",
    "start": "139959",
    "end": "145720"
  },
  {
    "text": "firewall and we were able to um verify our findings with version 4 One so um it",
    "start": "145720",
    "end": "150800"
  },
  {
    "text": "turned out that many of the things still applied um whereas some other things",
    "start": "150800",
    "end": "155879"
  },
  {
    "text": "apply in a slightly different way um but we will tell you all that um when we are giving the",
    "start": "155879",
    "end": "161519"
  },
  {
    "text": "presentation so um I'll be giving a quick overview well the overview is",
    "start": "161519",
    "end": "167000"
  },
  {
    "text": "still um according to how it should have been in the beginning um first of all I will give a quick",
    "start": "167000",
    "end": "175480"
  },
  {
    "text": "overview of the architecture of fir1 and of our setup that we have here and then we would like to",
    "start": "175480",
    "end": "182519"
  },
  {
    "text": "um to um to first go to the fifth point which is attacking the authentication",
    "start": "182519",
    "end": "188319"
  },
  {
    "text": "mechanism between firewall one modules we'll do that first and then start at",
    "start": "188319",
    "end": "193920"
  },
  {
    "text": "the beginning again attacking the firewall State one fwz encapsulation and then attacking the firewall State part",
    "start": "193920",
    "end": "200080"
  },
  {
    "text": "two and at the end hardening firewall one and um well the big picture is actually something that we will do in",
    "start": "200080",
    "end": "206920"
  },
  {
    "text": "the beginning as well which because um the big picture is something we have found that the attacks that we have found in firew war one perhaps also",
    "start": "206920",
    "end": "214480"
  },
  {
    "text": "apply to other firewalls because it's the the results that we optained can be transferred to other firewall products",
    "start": "214480",
    "end": "220560"
  },
  {
    "text": "probably and um this is why we want to give this first so that you get get the big picture first and after that we are",
    "start": "220560",
    "end": "226040"
  },
  {
    "text": "going to show you how the whole thing will work with firewall",
    "start": "226040",
    "end": "230519"
  },
  {
    "text": "one okay this is the topology of our test setup in the middle one the brick wall",
    "start": "231239",
    "end": "237200"
  },
  {
    "text": "is um the symbol for our firewall it might be well the case you're looking for it it might be well the case that",
    "start": "237200",
    "end": "243319"
  },
  {
    "text": "it's not in the folder because um if you haven't if you haven't been given additional sheets of paper because we",
    "start": "243319",
    "end": "248599"
  },
  {
    "text": "have we have actually added two slides that you will not find in there so I don't know whether they have been they",
    "start": "248599",
    "end": "253879"
  },
  {
    "text": "have been distributed among you um if not then you have to well you just try to learn it by heart and remember it so",
    "start": "253879",
    "end": "261400"
  },
  {
    "text": "in the middle this is the 511 module what's the interesting part is the IP addresses of the Solaris box back there",
    "start": "261400",
    "end": "266919"
  },
  {
    "text": "and of the Linux box back here so this is basically the two IP addresses that you need to memorize um we have the IP",
    "start": "266919",
    "end": "272560"
  },
  {
    "text": "440 in the middle which is running 501 service version 4.1 service t one um on",
    "start": "272560",
    "end": "279440"
  },
  {
    "text": "the left hand side we have the Solaris box which is a Solaris 2.6 box um which",
    "start": "279440",
    "end": "284919"
  },
  {
    "text": "we are going to exploited this is the Solaris box that is protected by the firewall and we will go through the firewall and and attack this box in",
    "start": "284919",
    "end": "291560"
  },
  {
    "text": "order to gain access to it um on the right hand side and the 1 17216 network",
    "start": "291560",
    "end": "297680"
  },
  {
    "text": "is um the victim Network then we the attackers Network it's the 192.168 network consisting of a Linux box which",
    "start": "297680",
    "end": "304880"
  },
  {
    "text": "is the attacking machine of an open BSD box which runs Frack router something probably known um written by du song",
    "start": "304880",
    "end": "312800"
  },
  {
    "text": "it's on the open BSD box and in order to show the authentication problems that exist between firewall modules we have",
    "start": "312800",
    "end": "319479"
  },
  {
    "text": "installed on the windows and T box up there it's not only running the presentation it's also um a packet",
    "start": "319479",
    "end": "325240"
  },
  {
    "text": "filtering module a 51 packet filtering module so we have on the Nokia IP 440 a packet filtering module um we have a",
    "start": "325240",
    "end": "331680"
  },
  {
    "text": "management module and on the windows and tbox we just have a packet filtering module and we will show you how we will",
    "start": "331680",
    "end": "338120"
  },
  {
    "text": "be able to unload for example the security policy from um the filtering module by bypassing the authentication",
    "start": "338120",
    "end": "346000"
  },
  {
    "text": "mechanism that normally exists between those two",
    "start": "346000",
    "end": "350400"
  },
  {
    "text": "modules okay this is the place where dong will take [Music] over um okay uh in general what we're",
    "start": "351759",
    "end": "359960"
  },
  {
    "text": "looking at are um problems in inspection when uh looking at how to attack these firewalls um we've identified four basic",
    "start": "359960",
    "end": "367479"
  },
  {
    "text": "Avenues of attack um and these are all basic constraints and inspection that can be exploited uh to to get through",
    "start": "367479",
    "end": "374000"
  },
  {
    "text": "firewall sometimes um specifically uh the first being unreliable or unauthenticated input um maybe maybe it",
    "start": "374000",
    "end": "382240"
  },
  {
    "text": "maps to what's called input validation error in um in like the bug track b or",
    "start": "382240",
    "end": "387720"
  },
  {
    "text": "taxonomy but um we just consider this to be uh Reliance on um input that",
    "start": "387720",
    "end": "393759"
  },
  {
    "text": "potentially could be spoofed forged uh what have you the second is layering restrictions on inspection um because of",
    "start": "393759",
    "end": "401080"
  },
  {
    "text": "the way that the network protocol stack is architected uh you have certain abstraction layers which uh you really",
    "start": "401080",
    "end": "407000"
  },
  {
    "text": "uh shouldn't um shouldn't uh violate if you want to stay within the spec um and",
    "start": "407000",
    "end": "414759"
  },
  {
    "text": "uh and sometimes that limits actually what you can uh filter on layering violations an inspection sort of the",
    "start": "414759",
    "end": "420400"
  },
  {
    "text": "inverse problem where when you do actually violate these these abstraction layers uh you cause problems for",
    "start": "420400",
    "end": "425560"
  },
  {
    "text": "yourself um because you look at things out of context and uh we'll examine that",
    "start": "425560",
    "end": "430639"
  },
  {
    "text": "also and the last being ambiguous and then semantics uh sort of a problem that also affects Network IDs systems um",
    "start": "430639",
    "end": "438240"
  },
  {
    "text": "where the box in the middle isn't interpret the firewall in this case isn't interpreting correctly what's",
    "start": "438240",
    "end": "444360"
  },
  {
    "text": "being sent from the attacker to the end host as interpreted by the end host so sort of as a hokey example um we",
    "start": "444360",
    "end": "451639"
  },
  {
    "text": "have the airport security every airport has a security checkpoint where they try to make sure that you're not sending",
    "start": "451639",
    "end": "457720"
  },
  {
    "text": "bombs to uh somewhere else or blah blah blah um and just like a firewall",
    "start": "457720",
    "end": "463120"
  },
  {
    "text": "checkpoint or checkpoint firewall uh it has problems um the first might be going by our sort",
    "start": "463120",
    "end": "471159"
  },
  {
    "text": "of loose taxonomy here uh examining baggage tags um if you were to just",
    "start": "471159",
    "end": "476520"
  },
  {
    "text": "determine the uh the security of um uh the a parcel that someone's trying",
    "start": "476520",
    "end": "483639"
  },
  {
    "text": "to send uh via an airplane by looking at who's sending it uh it's probably not really a good idea someone could just",
    "start": "483639",
    "end": "489360"
  },
  {
    "text": "switch to tags um layering restrictions on inspection sometimes you you're not allowed to look inside the bag for",
    "start": "489360",
    "end": "496360"
  },
  {
    "text": "what's actually in there so you can only examine the external characteristics um shape size weight what have you um and",
    "start": "496360",
    "end": "503360"
  },
  {
    "text": "this sort of corresponds to the um the limitations you have in looking at the network uh packet header",
    "start": "503360",
    "end": "510000"
  },
  {
    "text": "um for instance not looking at TCP headers within IP packets uh Ling violations in inspection",
    "start": "510000",
    "end": "516320"
  },
  {
    "text": "um if for instance you came with five bags you happen to have a bomb but it was spread out across those five bags",
    "start": "516320",
    "end": "522159"
  },
  {
    "text": "each checked by five separate guards you didn't find a whole bomb in there it might get through um this is U uh sort",
    "start": "522159",
    "end": "530160"
  },
  {
    "text": "of a serialization issue and this is also this this also Maps pretty cleanly to uh to attacks we found uh and again",
    "start": "530160",
    "end": "537200"
  },
  {
    "text": "Bigos end and semantics um checking only for no know Contraband uh someone could be sending a completely other kind of um",
    "start": "537200",
    "end": "544200"
  },
  {
    "text": "I don't know dangerous device or something that you don't know about uh and if they don't recognize it they just let it",
    "start": "544200",
    "end": "549640"
  },
  {
    "text": "through so in general this is the classification of the Tex that we're presenting uh We've have um found attack",
    "start": "549640",
    "end": "556760"
  },
  {
    "text": "uh against um TP TCP fast mode which isn't used much anymore I think by most people um but um allows you to do",
    "start": "556760",
    "end": "564880"
  },
  {
    "text": "certain things um mostly just Port scanning uh layering restrictions on inspe this is the class of attacks dealing",
    "start": "564880",
    "end": "571519"
  },
  {
    "text": "with uh fwz encapsulation uh laying violations in",
    "start": "571519",
    "end": "576640"
  },
  {
    "text": "inspection FTP data connection handling un indal TCP data flow and rs connection handling uh are three examples that we",
    "start": "576640",
    "end": "583399"
  },
  {
    "text": "found uh there probably many others because of the way um checkpoint does its uh I guess application proxying um",
    "start": "583399",
    "end": "591480"
  },
  {
    "text": "by looking at uh data within discret IP packets and the last uh parsing of FTP",
    "start": "591480",
    "end": "597720"
  },
  {
    "text": "Port commands um as it turns out the checkpoint firewall does it a bit differently than uh than",
    "start": "597720",
    "end": "603880"
  },
  {
    "text": "some uh FTP demons do and we can exploit that as [Music] well um okay Thomas that's work I will",
    "start": "603880",
    "end": "612399"
  },
  {
    "text": "take over again so like I said we start with the inter module authentication fir1 installations can be",
    "start": "612399",
    "end": "619760"
  },
  {
    "text": "distributed that means um you have a management module a centralized management module which is controlled by the graphical user interface all the",
    "start": "619760",
    "end": "626440"
  },
  {
    "text": "communication between the graphical user interface and the management module is done via Port",
    "start": "626440",
    "end": "631640"
  },
  {
    "text": "258 um 258 TCP connections and um the management module talks to the filtering",
    "start": "631640",
    "end": "638519"
  },
  {
    "text": "modules via connections that um are um to Port 256 TCP so um what is being done",
    "start": "638519",
    "end": "648079"
  },
  {
    "text": "between the management module and the filtering modules um policies are uploaded policies are unloaded and this",
    "start": "648079",
    "end": "654279"
  },
  {
    "text": "is exactly what we are going to do um status poing is done done and logging is",
    "start": "654279",
    "end": "661000"
  },
  {
    "text": "done by the filtering modules to the management module for example so all this takes place um via the service at",
    "start": "661000",
    "end": "667519"
  },
  {
    "text": "Port 256 and of course in order not to be able or in order to prevent attackers",
    "start": "667519",
    "end": "673680"
  },
  {
    "text": "from uploading security policies or unloading security policies authentication is performed basically",
    "start": "673680",
    "end": "680440"
  },
  {
    "text": "there are three authentication forums It's s key which is a variant of the SK",
    "start": "680440",
    "end": "686160"
  },
  {
    "text": "key um mechanism that we all know from Ling onto machines then they have",
    "start": "686160",
    "end": "691959"
  },
  {
    "text": "something proprietary which is called fwn N1 and something proprietary that is called fw1 however in the future everything",
    "start": "691959",
    "end": "698839"
  },
  {
    "text": "will be replaced by SSL and um yeah that this is a good idea replacing this by",
    "start": "698839",
    "end": "704320"
  },
  {
    "text": "SSL um the reason for that um uh is something that we will see right now",
    "start": "704320",
    "end": "710519"
  },
  {
    "text": "because we will be able to circumvent all three different kinds of authentication they are broken in a way",
    "start": "710519",
    "end": "717079"
  },
  {
    "text": "that enables an attacker to impersonate a management module in order to set up",
    "start": "717079",
    "end": "723839"
  },
  {
    "text": "uh send commands to the filtering modules commands like unload security policy for example okay let's start with a general",
    "start": "723839",
    "end": "732560"
  },
  {
    "text": "overview of the protocol between the management module and the um filtering modules in the beginning so we have the",
    "start": "732560",
    "end": "738440"
  },
  {
    "text": "management module on the on the left hand side and the filter module on the right hand side and we will be going to",
    "start": "738440",
    "end": "744000"
  },
  {
    "text": "um impersonate a management module in order to access the filtering module and unload the security policy um first of",
    "start": "744000",
    "end": "750680"
  },
  {
    "text": "all we send a version protocol version we get a protocol version back from the",
    "start": "750680",
    "end": "756040"
  },
  {
    "text": "filtering module then we sent to the filtering module the command in our case it's the unload command um we sent to",
    "start": "756040",
    "end": "763600"
  },
  {
    "text": "the filtering module our IP addresses the IP addresses of all our interfaces and we get back a list of IP addresses",
    "start": "763600",
    "end": "770320"
  },
  {
    "text": "of all the filtering modules IP addresses so after that the filtering module tells us in which way it wants to",
    "start": "770320",
    "end": "776920"
  },
  {
    "text": "authenticate that is SK fwn N1 fwa A1 and um we authenticate and then yeah we",
    "start": "776920",
    "end": "783639"
  },
  {
    "text": "pass the arguments to the command and get the result and we are done so this is basically how it works for all",
    "start": "783639",
    "end": "789839"
  },
  {
    "text": "commands this is basically the framework and we will and we will now concentrate on how the authentication mechanism",
    "start": "789839",
    "end": "796880"
  },
  {
    "text": "works because this is where we're going to attack oh and and that's that's another",
    "start": "796880",
    "end": "803240"
  },
  {
    "text": "interesting thing that I almost forgot um when the filtering module identifies us it doesn't look at the the IP address",
    "start": "803240",
    "end": "809959"
  },
  {
    "text": "where the connection comes from it just looks at the IP addresses that we pass to it so we can do this from anywhere in",
    "start": "809959",
    "end": "816839"
  },
  {
    "text": "the world the idea is well well it's it's it's it's actually probably it has",
    "start": "816839",
    "end": "821959"
  },
  {
    "text": "it has the background that if the management module has more than one interface people were configuring on the filtering module um an auth an",
    "start": "821959",
    "end": "829839"
  },
  {
    "text": "authentication key for the wrong interface and the management module connected to the filtering module with another interface and the filtering",
    "start": "829839",
    "end": "836279"
  },
  {
    "text": "module said no I don't have any authentication key for that Source IP address so this is probably the reason",
    "start": "836279",
    "end": "841759"
  },
  {
    "text": "why the management module transmits all of its IP addresses so that the filtering module can check all of the IP addresses and look at its authentication",
    "start": "841759",
    "end": "849360"
  },
  {
    "text": "keys in order to find one that corresponds with any of these IP addresses so this is probably the reason for",
    "start": "849360",
    "end": "855880"
  },
  {
    "text": "that so the first thing is SQ authentication many among you are probably familiar with the way how sqy",
    "start": "855880",
    "end": "862320"
  },
  {
    "text": "Works um I'll nevertheless shortly outline it again um",
    "start": "862320",
    "end": "868079"
  },
  {
    "text": "SK is based on iterated hash and iterated hash is if you have a secret so",
    "start": "868079",
    "end": "874240"
  },
  {
    "text": "it's based on a shared secret um the point of authentication that is the my peer that I want to authen authenticate",
    "start": "874240",
    "end": "880680"
  },
  {
    "text": "with knows the secret I know the secret um I hash the secret once this is the",
    "start": "880680",
    "end": "886000"
  },
  {
    "text": "first iteration then I take the result hash that again this is the second iteration the result of that can be",
    "start": "886000",
    "end": "891519"
  },
  {
    "text": "hashed again hashed again hashed again hashed again this is the iterated hash this is what I dep what I what I um what",
    "start": "891519",
    "end": "898639"
  },
  {
    "text": "I write down as hash and then the index n so it's hash N means the hash has been",
    "start": "898639",
    "end": "905480"
  },
  {
    "text": "iterated n times is exactly what you see in the uppermost line so a nice property",
    "start": "905480",
    "end": "910920"
  },
  {
    "text": "of that is Trivial if you have hash 10 for example you can just iterate it once",
    "start": "910920",
    "end": "916320"
  },
  {
    "text": "and get hash 11 but if you have hash 11 then you can't go back you can't get from that you can't get hash 10 always",
    "start": "916320",
    "end": "924040"
  },
  {
    "text": "um under the condition that hash is a cryptographically strong function like",
    "start": "924040",
    "end": "929600"
  },
  {
    "text": "md5 for example so if I have md5 iterate that 11 times I can't I I can't go back",
    "start": "929600",
    "end": "936040"
  },
  {
    "text": "from the result to md5 iterated only 10 times but I can go forward if I have md5",
    "start": "936040",
    "end": "943639"
  },
  {
    "text": "iterated 10 times I can iterate the result once and get md5 11 times iterated so the basic principle is",
    "start": "943639",
    "end": "950759"
  },
  {
    "text": "pretty simple by S key of SK key um I have a secret here the seed seed X",
    "start": "950759",
    "end": "957959"
  },
  {
    "text": "on the left hand side and my peer that I want to authenticate with knows hash 100 of X so it knows the",
    "start": "957959",
    "end": "966600"
  },
  {
    "text": "value of x it's directed in the hash 100 times um what it is going to ask me on",
    "start": "966600",
    "end": "973720"
  },
  {
    "text": "authentication it's going to ask me for Hash iterated 99 times so anyone who",
    "start": "973720",
    "end": "980120"
  },
  {
    "text": "knows hash 100 can verify my reply to that because I know the seed I iterated",
    "start": "980120",
    "end": "985279"
  },
  {
    "text": "99 times send the result to my peer my peer knows the the result after 100 iteration that is it gets what it it",
    "start": "985279",
    "end": "992440"
  },
  {
    "text": "takes what it got from me iterates the hash 1es gets hash 100 and can thus",
    "start": "992440",
    "end": "997480"
  },
  {
    "text": "verify that I am in possession of the correct seed X so with hash 100 knowing",
    "start": "997480",
    "end": "1003440"
  },
  {
    "text": "hash 100 you can verify um iterations with a lower iteration count between 1 and 99 but you",
    "start": "1003440",
    "end": "1010720"
  },
  {
    "text": "cannot generate them knowing hash 100 you can't generate Hash 99 but getting",
    "start": "1010720",
    "end": "1016000"
  },
  {
    "text": "Hash 99 you can verify with hash 100 that it's really been calculated using the seed X",
    "start": "1016000",
    "end": "1022560"
  },
  {
    "text": "so this is done it asks for h99 it asks for HH 98 h97 whenever I connect to it",
    "start": "1022560",
    "end": "1029038"
  },
  {
    "text": "and whenever authentication is performed So eventually it will reach index an",
    "start": "1029039",
    "end": "1035520"
  },
  {
    "text": "index of one so I will it sends me asks me for um hash one the pier sends hash",
    "start": "1035520",
    "end": "1042918"
  },
  {
    "text": "one to the authentication pier and now this s key chain as we call it the 100",
    "start": "1042919",
    "end": "1049679"
  },
  {
    "text": "the 100 um different onetime passwords that we have generated using the iterations have been used up so what do",
    "start": "1049679",
    "end": "1055960"
  },
  {
    "text": "we have to do now we have to calculate a new seed and the new seed has to be um",
    "start": "1055960",
    "end": "1062200"
  },
  {
    "text": "yeah created with enough entropy so that nobody's able to guess it because I generate the the authentication Pier on",
    "start": "1062200",
    "end": "1068440"
  },
  {
    "text": "the left hand side generates calculates a Ed y calculates HH 100 of Y and",
    "start": "1068440",
    "end": "1074880"
  },
  {
    "text": "transmit this to the firewall to the filtering module so the fil module now knows HH 100 of a new seat and is able",
    "start": "1074880",
    "end": "1082880"
  },
  {
    "text": "to verify HH 99 of the new seat h98 from the new seat so what we end up is a new SK key chain so the problem with that is",
    "start": "1082880",
    "end": "1090159"
  },
  {
    "text": "the principle is nice but the problem with that is that um the new seed doesn't contain very much entropy it's",
    "start": "1090159",
    "end": "1096720"
  },
  {
    "text": "basically a function of time and time in a resolution of seconds that is if you can predict with a Precision of seconds",
    "start": "1096720",
    "end": "1104120"
  },
  {
    "text": "when the new hash when the new seed y was generated then you're able to predict the key and you're able to",
    "start": "1104120",
    "end": "1109840"
  },
  {
    "text": "impersonate somebody who is actually in possession of possession of the seat y",
    "start": "1109840",
    "end": "1115200"
  },
  {
    "text": "so what we are able to do is we can just root Force this authentication because the search space is pretty small you",
    "start": "1115200",
    "end": "1121679"
  },
  {
    "text": "must imagine for example you have a firewall module that authenticates using S key that means um if you start a",
    "start": "1121679",
    "end": "1127840"
  },
  {
    "text": "logging process that PS um or or um the status if if you start the status program then the status of the of the",
    "start": "1127840",
    "end": "1135440"
  },
  {
    "text": "firewall module will be ped every SEC every 10 seconds that is is um One S key chain is used up within 1,000 seconds",
    "start": "1135440",
    "end": "1144000"
  },
  {
    "text": "100 different passwords is what we have plus the 10 times in the 10 seconds interval um which leads to 1,000 seconds",
    "start": "1144000",
    "end": "1151480"
  },
  {
    "text": "that is three times an hour the key is being changed so if I want to guess the key I only have to go back from current",
    "start": "1151480",
    "end": "1157640"
  },
  {
    "text": "time at maximum uh a third of an hour and I will be able to guess that and this is exactly what we are going to do",
    "start": "1157640",
    "end": "1163600"
  },
  {
    "text": "now um we will be guessing a key so the first thing that I would like to show to",
    "start": "1163600",
    "end": "1169799"
  },
  {
    "text": "you is um the security policy it's pretty straightforward we",
    "start": "1169799",
    "end": "1175320"
  },
  {
    "text": "have um like I said two um filtering modules one is the Mt box at on the top of it so this here corresponds very",
    "start": "1175320",
    "end": "1181919"
  },
  {
    "text": "nicely to the picture that I've shown before um this is the spark and we have the NT computer up here the IP 440 down",
    "start": "1181919",
    "end": "1189600"
  },
  {
    "text": "there and um I have configured SK key uh SK key authentication between the",
    "start": "1189600",
    "end": "1196159"
  },
  {
    "text": "management module on the IP 440 and the filtering module on the notebook computer and all we have is um we have",
    "start": "1196159",
    "end": "1202640"
  },
  {
    "text": "firewall one control connections enabled to both of them so this is 5111 control",
    "start": "1202640",
    "end": "1208039"
  },
  {
    "text": "connections that is a standard um a standard um configuration for version",
    "start": "1208039",
    "end": "1213120"
  },
  {
    "text": "4.0 it has been changed at 41 I will be saying something about that later um but for now um we have um control",
    "start": "1213120",
    "end": "1221039"
  },
  {
    "text": "connections enabled to both of them um we drop everything from and to tl2 tl2",
    "start": "1221039",
    "end": "1226200"
  },
  {
    "text": "is the upper computer it's the win and T machine and we accept everything from",
    "start": "1226200",
    "end": "1231679"
  },
  {
    "text": "and to the IP 440 so the IP 440 will not play any role in this uh demonstration now um we will just demonstrate that we",
    "start": "1231679",
    "end": "1239159"
  },
  {
    "text": "can download or unload sorry the the security policy from tl2 for that I will",
    "start": "1239159",
    "end": "1246120"
  },
  {
    "text": "be using um oh wait I will I will first show you how how it looks in the legitimate case so um I have another",
    "start": "1246120",
    "end": "1253400"
  },
  {
    "text": "window here that directly goes to the IP 440 and I can hear on the IP 440 per",
    "start": "1253400",
    "end": "1258600"
  },
  {
    "text": "perhaps I should make it a bit larger but the font a bit ah well will not M up",
    "start": "1258600",
    "end": "1263679"
  },
  {
    "text": "anything um I will unload the security policy just to show what it looks like",
    "start": "1263679",
    "end": "1270440"
  },
  {
    "text": "from the 149 address which is um the windows and te machine that's how it looks if it is unloaded legitimately by",
    "start": "1270440",
    "end": "1278360"
  },
  {
    "text": "the firewall one uh command line tool so I have configured um s key",
    "start": "1278360",
    "end": "1283400"
  },
  {
    "text": "authentication using um a seed with a put key command as you do it on 51 so",
    "start": "1283400",
    "end": "1289520"
  },
  {
    "text": "what we can see here is um move down there",
    "start": "1289520",
    "end": "1295960"
  },
  {
    "text": "um in the fourth line you see that it authenticates with a key test um it has",
    "start": "1295960",
    "end": "1302720"
  },
  {
    "text": "the my address it's the one 94221 6159 this is the address of the IP",
    "start": "1302720",
    "end": "1310440"
  },
  {
    "text": "440 it's um it says hey I'm the IP 440 and um the challenge is six that is it",
    "start": "1310440",
    "end": "1316440"
  },
  {
    "text": "wants to know the seed uh the challenge for um with for the six",
    "start": "1316440",
    "end": "1322200"
  },
  {
    "text": "iterations um so it calculates a reply and then it is authenticated and goes",
    "start": "1322200",
    "end": "1329679"
  },
  {
    "text": "through it and completely UNS the policy so the interesting part comes when I now do it again because then um a count of",
    "start": "1329679",
    "end": "1338400"
  },
  {
    "text": "four um sorry of five passwords will be left unload",
    "start": "1338400",
    "end": "1345080"
  },
  {
    "text": "Ste so we see the same thing again we will now see that it's not asking for um",
    "start": "1345080",
    "end": "1350559"
  },
  {
    "text": "Challenge number six but for challenge five and at the same time it will generate a new seed it doesn't wait",
    "start": "1350559",
    "end": "1357159"
  },
  {
    "text": "until the challenge uh until the iterations count has has reached one but it does so no it doesn't do that it",
    "start": "1357159",
    "end": "1364159"
  },
  {
    "text": "doesn't when it's four so let's unload the policy",
    "start": "1364159",
    "end": "1369440"
  },
  {
    "text": "again this time it should generate a new key and this is exactly what we are going to",
    "start": "1369440",
    "end": "1375400"
  },
  {
    "text": "attack okay so because the the idea is that um",
    "start": "1375880",
    "end": "1382120"
  },
  {
    "text": "whenever you configure a shared secret on both stations um it will be not used 100 times because um they are probably",
    "start": "1382120",
    "end": "1389000"
  },
  {
    "text": "afraid of users choosing bad passwords but it will be used only two times and then a new um password will be generated",
    "start": "1389000",
    "end": "1398120"
  },
  {
    "text": "so okay this is where we see it very nice um up there again okay it wants Sky",
    "start": "1398679",
    "end": "1405960"
  },
  {
    "text": "authentication um then we see that um it asks for a challenge four",
    "start": "1405960",
    "end": "1413080"
  },
  {
    "text": "this is what's what you see here in almost the middle of the screen um",
    "start": "1413080",
    "end": "1418400"
  },
  {
    "text": "challenge four it identifies itself calculates a response and FW key put it",
    "start": "1418400",
    "end": "1424240"
  },
  {
    "text": "generates a new key you see that this is exactly where it generates a new key and this is the new key that we would need",
    "start": "1424240",
    "end": "1429880"
  },
  {
    "text": "in order to impersonate the module and we have a small program that will um be able to do that we just need here the",
    "start": "1429880",
    "end": "1436520"
  },
  {
    "text": "current time on that computer um it's in another time zone so it's um uh 10: in",
    "start": "1436520",
    "end": "1442240"
  },
  {
    "text": "the evening so to make it quick I'll just um adapt the test to the demonstration to this date and this time",
    "start": "1442240",
    "end": "1449320"
  },
  {
    "text": "so what we are going to do now is um we simply use a tool to try all the",
    "start": "1449320",
    "end": "1456000"
  },
  {
    "text": "values from 5 minutes ago to now so the tool is called fw1 boot Force fw1",
    "start": "1456000",
    "end": "1465320"
  },
  {
    "text": "BF you see the usage here so the firewall address that we want to attack",
    "start": "1465320",
    "end": "1471720"
  },
  {
    "text": "is 14949 this is the um the firewall module here um on the windows and te machine so",
    "start": "1471720",
    "end": "1480640"
  },
  {
    "text": "we will reinstall the policy so that you see the effect reinstall the policy here",
    "start": "1480640",
    "end": "1486120"
  },
  {
    "text": "in the meantime 149 we want to impersonate 194 2216 159 which is the",
    "start": "1486120",
    "end": "1492360"
  },
  {
    "text": "management module and we want to try values from year 2000",
    "start": "1492360",
    "end": "1499120"
  },
  {
    "text": "July 26th we said it's we said here it's um",
    "start": "1499120",
    "end": "1505279"
  },
  {
    "text": "20 10 in the evening um at quarter 10 approximately so we have only one thing",
    "start": "1505279",
    "end": "1510760"
  },
  {
    "text": "to look at because um this computer here is another time zone so we have to subtract 5 hours from the time so we say",
    "start": "1510760",
    "end": "1519399"
  },
  {
    "text": "we want to try all values from 17 from 5 in the evening so 1,700 we say like um 4",
    "start": "1519399",
    "end": "1528840"
  },
  {
    "text": "1714 or let's go from 1710 0 to year",
    "start": "1528840",
    "end": "1535480"
  },
  {
    "text": "2000 July 26th 17 and 20 minutes so we go from 10",
    "start": "1535480",
    "end": "1542720"
  },
  {
    "text": "5 to 20 5 and try all the combinations and we do that with three processes in",
    "start": "1542720",
    "end": "1547880"
  },
  {
    "text": "parallel we can specify this and that's where it goes you see down here it tries all the passwords and um it does so by",
    "start": "1547880",
    "end": "1555240"
  },
  {
    "text": "connecting to the windows and te machine trying the password and if being rejected tries the next pathw so this is",
    "start": "1555240",
    "end": "1560520"
  },
  {
    "text": "a bit slow although we could increase the number of processes um version 4.1",
    "start": "1560520",
    "end": "1565840"
  },
  {
    "text": "which we using now doesn't handle very many processes in parallel so um with version 4 Z though you could um run",
    "start": "1565840",
    "end": "1574840"
  },
  {
    "text": "about 30 to 40 processes in parallel which um enables you to go through quite",
    "start": "1574840",
    "end": "1579919"
  },
  {
    "text": "a lot of keys in quite a short period of time that is even if the key generation the key regeneration de automated um",
    "start": "1579919",
    "end": "1586480"
  },
  {
    "text": "took place one week ago you would will be able to guess the key just by um",
    "start": "1586480",
    "end": "1592480"
  },
  {
    "text": "quickly going through all the possible values so well we know the key because",
    "start": "1592480",
    "end": "1597520"
  },
  {
    "text": "it's up here but this will of course um show the same result I just have to wait",
    "start": "1597520",
    "end": "1603240"
  },
  {
    "text": "for it let's see whether I did everything right because yesterday I did the 5 Hour",
    "start": "1603240",
    "end": "1610279"
  },
  {
    "text": "subtraction [Music] wrong okay it's going and it should come up with the",
    "start": "1610279",
    "end": "1617240"
  },
  {
    "text": "right key so um yeah the password are generated I",
    "start": "1617240",
    "end": "1623520"
  },
  {
    "text": "I told you that they are generated on the time function so we just take the 32-bit value okay there it is you see it",
    "start": "1623520",
    "end": "1630840"
  },
  {
    "text": "gu secret pg0 neore o which is exactly the same that we had here so we now have",
    "start": "1630840",
    "end": "1637360"
  },
  {
    "text": "root Force the secret and now we use a second tool that we have written written we just go f the oh wait let's first see",
    "start": "1637360",
    "end": "1643600"
  },
  {
    "text": "the show you the difference we just ping the firewall 194 221 149 okay we don't",
    "start": "1643600",
    "end": "1650279"
  },
  {
    "text": "see any results because everything is filtered like we saw in the policy before show it",
    "start": "1650279",
    "end": "1655880"
  },
  {
    "text": "again that's here okay the second rule from the top is exactly the rule that prevents pinging from working because",
    "start": "1655880",
    "end": "1662600"
  },
  {
    "text": "all packets are blocked what we're going to do now is like we use the fw1 S key tool which just an which is basically an",
    "start": "1662600",
    "end": "1669120"
  },
  {
    "text": "implementation of the protocol that I showed you before uh and does SQ authentication so we say okay we are 194",
    "start": "1669120",
    "end": "1675440"
  },
  {
    "text": "221 we want to Attack 2 the 149 address which is the firewall on the",
    "start": "1675440",
    "end": "1680840"
  },
  {
    "text": "NT machine we want to impersonate as 2216 159 159 and the secret is",
    "start": "1680840",
    "end": "1690519"
  },
  {
    "text": "p g0 n",
    "start": "1690519",
    "end": "1696320"
  },
  {
    "text": "e oh I'm sorry thanks pg0 that's the American keybords you",
    "start": "1696320",
    "end": "1703000"
  },
  {
    "text": "know it's different from the German keybords n ecore",
    "start": "1703000",
    "end": "1708360"
  },
  {
    "text": "then underscore in the right place o okay that should do it now we will just",
    "start": "1708360",
    "end": "1713760"
  },
  {
    "text": "start the whole protocol that we showed you before like sending IP addresses receiving IP addresses and everything and unload doing an unload command",
    "start": "1713760",
    "end": "1720840"
  },
  {
    "text": "here's what you see we sent version 3 uh version 31 we send the command 0000 C",
    "start": "1720840",
    "end": "1726799"
  },
  {
    "text": "which is an unload command we send our IP address well not our IP address because we want to impersonate somebody we send the IP address of the module",
    "start": "1726799",
    "end": "1733559"
  },
  {
    "text": "that we want to impersonate we get a version back for one so um it will agree",
    "start": "1733559",
    "end": "1738679"
  },
  {
    "text": "on the the whole mechanism will agree on the lowest protocol version we will see the address of the firewall 149 which is",
    "start": "1738679",
    "end": "1745320"
  },
  {
    "text": "also very interesting because up to now we don't have we haven't done any authentication and we already know the",
    "start": "1745320",
    "end": "1750600"
  },
  {
    "text": "interface of the firewall um it tells us that once um authentification s key it sends us a challenge of 96 like I said",
    "start": "1750600",
    "end": "1757000"
  },
  {
    "text": "before um challenges start with 99 we unloaded it some sometimes and now it asks for 96 but we know the shared",
    "start": "1757000",
    "end": "1763600"
  },
  {
    "text": "secret and we can respond to the challenge it sends us okay and then we",
    "start": "1763600",
    "end": "1768880"
  },
  {
    "text": "can start the unload command we send scope information scope information tells the firewall what we want to unload on which machine which is",
    "start": "1768880",
    "end": "1774720"
  },
  {
    "text": "basically the IP address of the uh windows and team machine we send send interface information that is um that",
    "start": "1774720",
    "end": "1780600"
  },
  {
    "text": "tells the firewall which interface we want to unload the information from um this is this is simply all do all do all",
    "start": "1780600",
    "end": "1788240"
  },
  {
    "text": "all directions on all interfaces and we rece receive a return Code Zero which means success we send a command of zero",
    "start": "1788240",
    "end": "1795080"
  },
  {
    "text": "to end the connection and everything is done and we will now see that we are able to Ping the",
    "start": "1795080",
    "end": "1800200"
  },
  {
    "text": "firewall because the security policy has been [Music]",
    "start": "1800200",
    "end": "1806139"
  },
  {
    "text": "unloaded okay this was SK key so the problem with SK key is that",
    "start": "1809399",
    "end": "1815039"
  },
  {
    "text": "um if you used something more secure like fwa one um you were until version",
    "start": "1815039",
    "end": "1822080"
  },
  {
    "text": "40er you were only able to do that if you had an encryption license if you didn't have an encryption license it would automatically fall back to SK so",
    "start": "1822080",
    "end": "1829039"
  },
  {
    "text": "you would would get the warnings and the log file saying falling back to SK no encryption license so what people did is",
    "start": "1829039",
    "end": "1835320"
  },
  {
    "text": "they recommended you can see that on a lot of websites to use fwn N1 fwn N1 is an algorithm that um was apparently",
    "start": "1835320",
    "end": "1842279"
  },
  {
    "text": "exportable I don't know why um what what the exact difference in in exporting restrictions was um for fwn N1 but it",
    "start": "1842279",
    "end": "1850240"
  },
  {
    "text": "was always recommended that you use fwn N1 which is the second authentication method because it was um more safe safer",
    "start": "1850240",
    "end": "1857600"
  },
  {
    "text": "than FSK ke because you have seen SK key is not very safe so um people",
    "start": "1857600",
    "end": "1863600"
  },
  {
    "text": "recommended to use fwn N1 okay we during our Consulting we came across some fw1",
    "start": "1863600",
    "end": "1869039"
  },
  {
    "text": "things Jesus um we have to do something against that and that's what we came up",
    "start": "1869039",
    "end": "1874399"
  },
  {
    "text": "with that's how FW N1 Works fn1 authentication so it's again a shared",
    "start": "1874399",
    "end": "1879840"
  },
  {
    "text": "secret between left and right you do that with FW put key um and as soon as",
    "start": "1879840",
    "end": "1886240"
  },
  {
    "text": "you connect to the firewall and to the fing module and it it has shown to you that it wants fwnn authentication it",
    "start": "1886240",
    "end": "1892880"
  },
  {
    "text": "sends you a random number a random number of um 16 bytes um to make sure to",
    "start": "1892880",
    "end": "1900399"
  },
  {
    "text": "or to enable us to ident to to authenticate the file the filtering module it does the following it creates",
    "start": "1900399",
    "end": "1906880"
  },
  {
    "text": "some sort of signature it's a symmetric signature it's not a public key thing it's just a symmetric signature it's",
    "start": "1906880",
    "end": "1912240"
  },
  {
    "text": "basically a key Hash a key hash means you hash the the data that you want to",
    "start": "1912240",
    "end": "1917399"
  },
  {
    "text": "authenticate which is concatenated by a secret key this is what I've um what I've written",
    "start": "1917399",
    "end": "1923519"
  },
  {
    "text": "down here in the second line it generates a signature one S1 by concatenating the random number and the",
    "start": "1923519",
    "end": "1930880"
  },
  {
    "text": "secret key K so it just puts those things together and creates a cryptographically strong hash that is",
    "start": "1930880",
    "end": "1937240"
  },
  {
    "text": "md5 of that so what we get is we get assigned R1 and we are able to verify",
    "start": "1937240",
    "end": "1944039"
  },
  {
    "text": "the signature because we know K as well so we just do the following we receive the random number concatenate K",
    "start": "1944039",
    "end": "1951440"
  },
  {
    "text": "build create calculate the hash over those two and compare it with the signature that the package filter sent",
    "start": "1951440",
    "end": "1957360"
  },
  {
    "text": "us so now it expects us to do the same thing it expects us to generate a random number R2 and sign it as well so if we",
    "start": "1957360",
    "end": "1965360"
  },
  {
    "text": "are a legitimate management station this is not a problem because we know K but we don't know K because we're not",
    "start": "1965360",
    "end": "1971039"
  },
  {
    "text": "legitimate we not a legitimate um management module um what we do is um we",
    "start": "1971039",
    "end": "1977000"
  },
  {
    "text": "have to find a way to do that to to calculate that reply without actually knowing K and what we",
    "start": "1977000",
    "end": "1983440"
  },
  {
    "text": "do is pretty trivial we just use the same R2 as we we just replay everything",
    "start": "1983440",
    "end": "1989360"
  },
  {
    "text": "we just receive R1 and don't generate a random number of our own but we reuse R1",
    "start": "1989360",
    "end": "1994480"
  },
  {
    "text": "we we just instead of generating our our own R2 we reuse R1 and of course if we reuse R1 we can reuse the signature so",
    "start": "1994480",
    "end": "2001799"
  },
  {
    "text": "we just take the signature S1 and instead of General calculating S2 we just replay S1 and this is what I'm",
    "start": "2001799",
    "end": "2007000"
  },
  {
    "text": "going to show you now",
    "start": "2007000",
    "end": "2009760"
  },
  {
    "text": "[Music] okay it needs some it needs some setting up because I didn't manage to get this",
    "start": "2013430",
    "end": "2020519"
  },
  {
    "text": "running in the because we had some some technical problems before I didn't manage to get this running with um the",
    "start": "2020519",
    "end": "2026919"
  },
  {
    "text": "IP 440 so will have to show with with Windows NT I'll have to show it to you um with the IP 440 so let's just add a",
    "start": "2026919",
    "end": "2034799"
  },
  {
    "text": "rule that denies traffic to the IP 440 as well we have that here we disable that room",
    "start": "2034799",
    "end": "2041120"
  },
  {
    "text": "we don't need that anymore we install that policy here oh wait just let me",
    "start": "2041120",
    "end": "2046440"
  },
  {
    "text": "switch on um switch on fwn N1 authentication we have to go to lip not",
    "start": "2046440",
    "end": "2052599"
  },
  {
    "text": "edit control. map some of you know this probably and say that okay anybody",
    "start": "2052599",
    "end": "2059560"
  },
  {
    "text": "coming here so this is now a bit of um of doing this with smoke and mirrors",
    "start": "2059560",
    "end": "2067440"
  },
  {
    "text": "because like I said we have a technical problem but the principle will be will be shown so we make that FW",
    "start": "2067440",
    "end": "2073720"
  },
  {
    "text": "N1 okay just for safety purposes stop and start the",
    "start": "2073720",
    "end": "2080240"
  },
  {
    "text": "firewall FW stop oh it's in don't get irritated by the German error",
    "start": "2080240",
    "end": "2086599"
  },
  {
    "text": "messages FW [Music]",
    "start": "2086599",
    "end": "2092839"
  },
  {
    "text": "stop F start",
    "start": "2092839",
    "end": "2097480"
  },
  {
    "text": "so now we have um for the unload command we have now configured fwn N1 authentication on the IP 440 so we will",
    "start": "2098640",
    "end": "2104839"
  },
  {
    "text": "this time attack the FW uh the the IP 440 okay so let's see whether this",
    "start": "2104839",
    "end": "2110960"
  },
  {
    "text": "actually works okay it's fine here okay",
    "start": "2110960",
    "end": "2118520"
  },
  {
    "text": "so let's first naively try to Ping the firewall 159 oh it works because we have not",
    "start": "2118520",
    "end": "2125160"
  },
  {
    "text": "uploaded the policy yet so we have to restart the graphical user interface and upload the policy polic",
    "start": "2125160",
    "end": "2134640"
  },
  {
    "text": "editor log in here policy install the new policy okay",
    "start": "2135680",
    "end": "2144000"
  },
  {
    "text": "everywhere this takes a while I don't know why didn't have any time to investigate",
    "start": "2144839",
    "end": "2151119"
  },
  {
    "text": "this okay policy was installed here so now we naively go there and try to do",
    "start": "2151119",
    "end": "2157400"
  },
  {
    "text": "the same f fw1 s key thing but the other way around this time we want to",
    "start": "2157400",
    "end": "2162960"
  },
  {
    "text": "authenticate with the IP 440 so it's oh it's dely oops so I",
    "start": "2162960",
    "end": "2170359"
  },
  {
    "text": "didn't change the control map accordingly like I said we had to go through",
    "start": "2170359",
    "end": "2177359"
  },
  {
    "text": "some trouble let me look again at the",
    "start": "2177359",
    "end": "2182560"
  },
  {
    "text": "control. map file oops ah",
    "start": "2182560",
    "end": "2189559"
  },
  {
    "text": "it's not there oh it's in lib yeah the notepad command is still",
    "start": "2190800",
    "end": "2197400"
  },
  {
    "text": "called Notepad command on the German version so there it's none fwn",
    "start": "2197400",
    "end": "2204880"
  },
  {
    "text": "N1 where did we go we went to the",
    "start": "2210560",
    "end": "2215680"
  },
  {
    "text": "159 just for oh yeah I've been changing it on the NT",
    "start": "2215680",
    "end": "2221680"
  },
  {
    "text": "machine of course I have to change it on the IP 440 sorry that's where we",
    "start": "2221680",
    "end": "2227359"
  },
  {
    "text": "go that's where we have to change it okay let's go",
    "start": "2228599",
    "end": "2234359"
  },
  {
    "text": "to so like I said we have to fake this a bit because the thing didn't work from",
    "start": "2234359",
    "end": "2240400"
  },
  {
    "text": "the beginning FW stop FW started so it accepts the new Authentication",
    "start": "2240400",
    "end": "2249520"
  },
  {
    "text": "model okay it's coming up there so we have to reboot",
    "start": "2250640",
    "end": "2256319"
  },
  {
    "text": "the we have to reload the rules management clients policy are on here",
    "start": "2256480",
    "end": "2262200"
  },
  {
    "text": "okay everything has run connecting to the server okay",
    "start": "2262200",
    "end": "2267359"
  },
  {
    "text": "install the policy better safe than",
    "start": "2267359",
    "end": "2271759"
  },
  {
    "text": "sorry to his credit Thomas is not actually checkpoint ccsa or ccse he just",
    "start": "2275040",
    "end": "2281839"
  },
  {
    "text": "knows how to break them okay like I said before we try",
    "start": "2281839",
    "end": "2287240"
  },
  {
    "text": "naively to play the S key trick and now it demands now it's FW N1 and now we say great because it's even simpler um we go",
    "start": "2287240",
    "end": "2294920"
  },
  {
    "text": "here and say use our different tool fw1 fn1 FN so what we have to do is just",
    "start": "2294920",
    "end": "2301680"
  },
  {
    "text": "specify the firewall that we want to unload oh wait let's first ping the firewall to show you that the security",
    "start": "2301680",
    "end": "2307599"
  },
  {
    "text": "policy really loaded. 6159 okay nothing comes back and now we",
    "start": "2307599",
    "end": "2314839"
  },
  {
    "text": "are going to unload the policy 159 194 221 149 so we are contacting 159 which",
    "start": "2314839",
    "end": "2321480"
  },
  {
    "text": "is the IP 440 we are acting as if we were the 149 and you're authenticating",
    "start": "2321480",
    "end": "2326640"
  },
  {
    "text": "here and as you can see the random number we receive is just the random number that we sent back the signature",
    "start": "2326640",
    "end": "2332160"
  },
  {
    "text": "that we receive is just a signature that we send back it says okay authentication done scope information the rest is same",
    "start": "2332160",
    "end": "2337960"
  },
  {
    "text": "and we are able to Ping it and you see it's [Music]",
    "start": "2337960",
    "end": "2344760"
  },
  {
    "text": "pinging okay so now we upgrade the whole thing to",
    "start": "2344760",
    "end": "2350200"
  },
  {
    "text": "fw1 okay I stop the",
    "start": "2351640",
    "end": "2355760"
  },
  {
    "text": "firewall okay",
    "start": "2363240",
    "end": "2367240"
  },
  {
    "text": "[Music]",
    "start": "2374950",
    "end": "2378050"
  },
  {
    "text": "okay we have to restart the guey as well",
    "start": "2381119",
    "end": "2385720"
  },
  {
    "text": "okay okay everything",
    "start": "2416040",
    "end": "2419920"
  },
  {
    "text": "done okay fwa A1 looks like that it's very similar to",
    "start": "2421079",
    "end": "2427319"
  },
  {
    "text": "to FW N1 we get sent a random number R1 and um we get sent the same signature",
    "start": "2427319",
    "end": "2433520"
  },
  {
    "text": "again so but this time the firewalling module does not expect us to only send",
    "start": "2433520",
    "end": "2439280"
  },
  {
    "text": "back a signed random number but to send back a random number and not sign our random number but their random number",
    "start": "2439280",
    "end": "2446400"
  },
  {
    "text": "xor so that is what um that character is um is is used to express X or the random",
    "start": "2446400",
    "end": "2453440"
  },
  {
    "text": "number that the server has sent us so what are what what what happens normally the server sends us a random number",
    "start": "2453440",
    "end": "2459800"
  },
  {
    "text": "regenerate a random number exort those two random numbers send back to the server uh to the firewall module our",
    "start": "2459800",
    "end": "2466520"
  },
  {
    "text": "random number and the signature of the set X or between of the x or of its",
    "start": "2466520",
    "end": "2473480"
  },
  {
    "text": "random number and our random number okay what do we do of course we choose our",
    "start": "2473480",
    "end": "2478839"
  },
  {
    "text": "one our own random number to be zero because the server's random number X or zero is again the server's random number",
    "start": "2478839",
    "end": "2485560"
  },
  {
    "text": "and we can reuse the signature so we again have the shared key we just choose R2 equals z so in this way R1 X or R2",
    "start": "2485560",
    "end": "2495280"
  },
  {
    "text": "equals R1 because anything X or zero is anything and in that way we have sign",
    "start": "2495280",
    "end": "2501760"
  },
  {
    "text": "the the signature 2 is a hash of R1 X or R2 um a signature of R1 X or R2 which is",
    "start": "2501760",
    "end": "2508960"
  },
  {
    "text": "by replacing um R1 X or R2 by R R1 it's it's just a signature of R1 and that's",
    "start": "2508960",
    "end": "2514560"
  },
  {
    "text": "what we got from the firewall module and this is what we can use to circumvent",
    "start": "2514560",
    "end": "2520200"
  },
  {
    "text": "authentication but this time we have an additional problem I've been lying to",
    "start": "2520200",
    "end": "2525280"
  },
  {
    "text": "you it's not only being used for authentication the hash but only the lower half of the hash the lower 64 bit",
    "start": "2525280",
    "end": "2531240"
  },
  {
    "text": "are being used for authentication the upper 64 bit are used to negotiate an",
    "start": "2531240",
    "end": "2536560"
  },
  {
    "text": "encryption key so if the authentication is successful from there on the um the",
    "start": "2536560",
    "end": "2543720"
  },
  {
    "text": "the whole thing will be encrypted so that's why you see down there to be solved encryption we don't know how to",
    "start": "2543720",
    "end": "2551040"
  },
  {
    "text": "do that at the moment we are able to circumvent the authentication but we are",
    "start": "2551040",
    "end": "2556160"
  },
  {
    "text": "not able to break the encryption so um we can't unload everything I can anything I can just",
    "start": "2556160",
    "end": "2562760"
  },
  {
    "text": "show you that we can get past the authentication and well the encryption thing probably needs some work um I can",
    "start": "2562760",
    "end": "2569599"
  },
  {
    "text": "just show you that we can C past the authentication we will not be able to unload anything but um I can show you",
    "start": "2569599",
    "end": "2576760"
  },
  {
    "text": "what it looks looks like we just say use our next tool fwa we go through it and um yeah we see",
    "start": "2576760",
    "end": "2584440"
  },
  {
    "text": "authentication method fwa A1 the authentication method that we get is this is actually a he hex of what we",
    "start": "2584440",
    "end": "2590319"
  },
  {
    "text": "receive so we receive um a random number which is the long number the second long HEX number and we get the signature up",
    "start": "2590319",
    "end": "2596960"
  },
  {
    "text": "there and what we send back is we set the random number to zero and just copy the sign uh just copy the signature um",
    "start": "2596960",
    "end": "2603359"
  },
  {
    "text": "we get an okay back but as you see the state is not one anymore more but it's already encrypted so um one of our first",
    "start": "2603359",
    "end": "2610480"
  },
  {
    "text": "thoughts was um it encrypted using FW Z1 which is a stream Cipher so if they use",
    "start": "2610480",
    "end": "2616040"
  },
  {
    "text": "the same key in both directions then we could just X or that value with the",
    "start": "2616040",
    "end": "2621319"
  },
  {
    "text": "value that we know it has with a plain Tex with one and would get the first four bytes of the keyst stream which",
    "start": "2621319",
    "end": "2627119"
  },
  {
    "text": "would would which would Us in turn enable to just use these four bytes of keystream to encrypt information that we",
    "start": "2627119",
    "end": "2633480"
  },
  {
    "text": "want to get to the firewall but unfortunately two different keys are used in both directions so this doesn't",
    "start": "2633480",
    "end": "2638760"
  },
  {
    "text": "work and we currently don't have any method um to successfully attack",
    "start": "2638760",
    "end": "2643839"
  },
  {
    "text": "fw1 um apart from the authentication part so fw1 for the time being is safe against",
    "start": "2643839",
    "end": "2651240"
  },
  {
    "text": "attacks by us but still we could get past the",
    "start": "2651240",
    "end": "2656720"
  },
  {
    "text": "authentication yeah the encryption thing is quite interesting because um the algorithm uh it's FW Z1 the algorithm um",
    "start": "2656720",
    "end": "2664000"
  },
  {
    "text": "is proprietary it was developed in in in in in the beginning of the '90s because",
    "start": "2664000",
    "end": "2669240"
  },
  {
    "text": "back then there weren't any standards for IP U inaps for ipvpn computing and",
    "start": "2669240",
    "end": "2674960"
  },
  {
    "text": "um the algorithm was not made public but it has been made public um during last",
    "start": "2674960",
    "end": "2680440"
  },
  {
    "text": "week it was posted to scrypt to the news Group C Crypt and since then I expect",
    "start": "2680440",
    "end": "2686440"
  },
  {
    "text": "people will be be picking it apart and time will show whether it's still state-ofthe-art the FW Z1 encryption",
    "start": "2686440",
    "end": "2692960"
  },
  {
    "text": "algorithm but up to now no weaknesses are known and um it seems that f W1 is currently um immune against those",
    "start": "2692960",
    "end": "2699880"
  },
  {
    "text": "attacks well um another attack might be possible we are investigating this",
    "start": "2699880",
    "end": "2705640"
  },
  {
    "text": "because um what we are getting is a random number and a signature of that random number so um what we might be",
    "start": "2705640",
    "end": "2713839"
  },
  {
    "text": "able is if the key that is used to do make the signature um doesn't contain",
    "start": "2713839",
    "end": "2720119"
  },
  {
    "text": "enough entropy we will be able to just having the data and the signature for",
    "start": "2720119",
    "end": "2725160"
  },
  {
    "text": "the data we will be able to root for the key because we can do that offline we don't have to do this online we can try",
    "start": "2725160",
    "end": "2730680"
  },
  {
    "text": "to bruteforce the key and um just by see looking at um the the the data that is",
    "start": "2730680",
    "end": "2735839"
  },
  {
    "text": "the random number and the signature of it so um the future will show whether",
    "start": "2735839",
    "end": "2741280"
  },
  {
    "text": "this is um anything promising but this is fwa one authentication so these were",
    "start": "2741280",
    "end": "2747800"
  },
  {
    "text": "the attacks on the inter module authentication um we will now um switch",
    "start": "2747800",
    "end": "2754480"
  },
  {
    "text": "over to um attacks against the filtering mechanism itself fir one a stateful",
    "start": "2754480",
    "end": "2759520"
  },
  {
    "text": "inspection and there's quite some ways to um circumvent the filtering rules",
    "start": "2759520",
    "end": "2764960"
  },
  {
    "text": "that you have configured um on the one hand this is quite common misconfigurations for firewall 1 and on",
    "start": "2764960",
    "end": "2771720"
  },
  {
    "text": "the other hand this is implementation errors you always have to make um to make a difference between those two and",
    "start": "2771720",
    "end": "2777559"
  },
  {
    "text": "um yeah we're going to show you from now on um what um we have in um in our hands",
    "start": "2777559",
    "end": "2785319"
  },
  {
    "text": "against the fir1 filtering method itself so what time is it do we",
    "start": "2785319",
    "end": "2790880"
  },
  {
    "text": "do we already have to move or okay so we only have time till um",
    "start": "2790880",
    "end": "2797400"
  },
  {
    "text": "2:40 so I think we will have to move now to another room that's why we have brought our own table we will just",
    "start": "2797400",
    "end": "2803280"
  },
  {
    "text": "disconnect everything from um from the stage here and then carry it over to the",
    "start": "2803280",
    "end": "2808599"
  },
  {
    "text": "um deep knowledge track [Applause]",
    "start": "2808599",
    "end": "2820260"
  },
  {
    "text": "St",
    "start": "2845839",
    "end": "2848839"
  },
  {
    "text": "e for",
    "start": "2875839",
    "end": "2879839"
  }
]