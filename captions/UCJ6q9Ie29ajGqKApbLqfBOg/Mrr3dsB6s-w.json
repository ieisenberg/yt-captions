[
  {
    "start": "0",
    "end": "115000"
  },
  {
    "text": "[Music]",
    "start": "4940",
    "end": "7980"
  },
  {
    "text": "welcome to black hat Windows 2K security held February 14th through the 15th 2001",
    "start": "19080",
    "end": "24840"
  },
  {
    "text": "in Las Vegas Nevada the following videotape was recorded live at the conference and produced by by the sound",
    "start": "24840",
    "end": "30400"
  },
  {
    "text": "of knowledge Incorporated this is videotape number 6C a continuation deep knowledge track IPC",
    "start": "30400",
    "end": "38600"
  },
  {
    "text": "in a Windows 2000",
    "start": "38600",
    "end": "41960"
  },
  {
    "text": "World I so we got two folks three four five six seven okay that's great I'm",
    "start": "44160",
    "end": "51280"
  },
  {
    "text": "glad you're here all right so where we are in the agenda we're we're at the uh went K",
    "start": "51280",
    "end": "57359"
  },
  {
    "text": "second deployment William doing 3 230 to 345 I I will finish by",
    "start": "57359",
    "end": "63559"
  },
  {
    "text": "3:45 uh after that is the demo and Dan and Raymond are working",
    "start": "63559",
    "end": "70240"
  },
  {
    "text": "on",
    "start": "80280",
    "end": "83280"
  },
  {
    "text": "I'm I coming through on the mic it's",
    "start": "86240",
    "end": "92758"
  },
  {
    "text": "on how about now ah okay geez I can hear myself and I'm echoing and I think I'm",
    "start": "94200",
    "end": "100840"
  },
  {
    "text": "on all right so I want to talk about l2tp IP sex so you understand how it works and we can talk about deployment",
    "start": "100840",
    "end": "107040"
  },
  {
    "text": "issues um if we have time I'll go into the IPC end to end deployment um so",
    "start": "107040",
    "end": "115640"
  },
  {
    "start": "115000",
    "end": "115000"
  },
  {
    "text": "okay uh as I mentioned earlier Cisco and Microsoft and a bunch of other people wanted a standard for remote",
    "start": "115640",
    "end": "122840"
  },
  {
    "text": "access uh for basically PPP based remote access there's an enormous number of of",
    "start": "122840",
    "end": "128599"
  },
  {
    "text": "people who still dial into the internet and they wanted to enable a business for",
    "start": "128599",
    "end": "134400"
  },
  {
    "text": "VPN um and pptp is what as I said Microsoft shipped um for all Platforms in",
    "start": "134400",
    "end": "143120"
  },
  {
    "text": "1996 uh in 1998 RNE published some Security review of it that found it was",
    "start": "143120",
    "end": "148440"
  },
  {
    "text": "pretty weak uh originally in terms of how it treated the user password hash so we updated pptp in 1998 the same year",
    "start": "148440",
    "end": "156599"
  },
  {
    "text": "and released done 1.3 which had all the fixes in it um and to my knowledge and I",
    "start": "156599",
    "end": "162280"
  },
  {
    "text": "believe Schneider's paper that's still published on his website says uh while",
    "start": "162280",
    "end": "167519"
  },
  {
    "text": "the the improvements I can't remember the exact wording but basically while the improvements um are necessary to",
    "start": "167519",
    "end": "174239"
  },
  {
    "text": "overcome the prior weaknesses pptp is still as secure as the user's password",
    "start": "174239",
    "end": "179640"
  },
  {
    "text": "okay okay so the bottom line is there's an MS at at the most secure configuration of",
    "start": "179640",
    "end": "185080"
  },
  {
    "text": "pptp um except in Windows 2000 we'll talk about that the most secure version of",
    "start": "185080",
    "end": "190720"
  },
  {
    "text": "pptp that involves a user's password uses the MS chap V2 hash and there are",
    "start": "190720",
    "end": "196159"
  },
  {
    "text": "tools like anger 1.33 uh which is published uh out there security Focus",
    "start": "196159",
    "end": "202400"
  },
  {
    "text": "insecure has it everybody um basically that will be able to take a pptp hash out of a Sniff and uh party on it for",
    "start": "202400",
    "end": "209799"
  },
  {
    "text": "password guessing so pptp for your remote access clients is still as secure",
    "start": "209799",
    "end": "215159"
  },
  {
    "text": "as their password and uh we want to make sure everyone's aware of that so strong user passwords um are required and my",
    "start": "215159",
    "end": "223920"
  },
  {
    "text": "strong I mean random 14 character strings um in some cases I guess I'd rather have it on my wallet or something",
    "start": "223920",
    "end": "230480"
  },
  {
    "text": "written down so that I can actually type it in versus connecting across a public network somebody's sniffing it and now",
    "start": "230480",
    "end": "236640"
  },
  {
    "text": "my my corporation's compromised because I used a week password so if you look at the support",
    "start": "236640",
    "end": "242920"
  },
  {
    "text": "in the industry um the options today that that Microsoft ships this is not",
    "start": "242920",
    "end": "248720"
  },
  {
    "text": "necessarily everyone shipping but the client the VPN client that Microsoft ships for Windows 95 is done 1.3 I",
    "start": "248720",
    "end": "255840"
  },
  {
    "text": "believe there will be a done 1.4 uh coming out in a couple of months it's been in the works for a long time and",
    "start": "255840",
    "end": "261759"
  },
  {
    "text": "I'm not sure where it's what its release status is um but basically it has the strongest uh pptp version um it's been",
    "start": "261759",
    "end": "269400"
  },
  {
    "text": "out for many years but all your users should be using D 1.3 same thing for Windows 98 uh Windows 98 second edition",
    "start": "269400",
    "end": "277560"
  },
  {
    "text": "um Millennium and then nt4 all of those have pptp essentially as the VPN",
    "start": "277560",
    "end": "283960"
  },
  {
    "text": "protocol Windows 2000 is a whole different animal and we spent",
    "start": "283960",
    "end": "289160"
  },
  {
    "text": "approximately five years developing Windows 2000 uh three years developing just the VPN and IP set capabilities of",
    "start": "289160",
    "end": "295400"
  },
  {
    "text": "Windows 2000 and so basically because PPT had some",
    "start": "295400",
    "end": "300759"
  },
  {
    "text": "limitations uh we wanted to go with a and wasn't an ITF standard per se",
    "start": "300759",
    "end": "306440"
  },
  {
    "text": "through a working group process wanted to go through ANF standard VPN remote access protocol so primarily because of",
    "start": "306440",
    "end": "313680"
  },
  {
    "text": "the features in pptp using PPP based tunneling and Cisco's layer 2 forwarding we got together and formed the",
    "start": "313680",
    "end": "319840"
  },
  {
    "text": "l2tp remote access protocol uh we'll talk a lot more about l2tp in the next slide but the bottom line is that",
    "start": "319840",
    "end": "326479"
  },
  {
    "text": "Windows 2000 so in the in the ietf when they when they created l2tp they",
    "start": "326479",
    "end": "331560"
  },
  {
    "text": "specifically said uh when l2tp runs across the internet it will be carried by an IP packet and typically in the way",
    "start": "331560",
    "end": "339560"
  },
  {
    "text": "ITF working groups work they they don't Define a new security protocol if another group is already using a is",
    "start": "339560",
    "end": "345280"
  },
  {
    "text": "already defining security and in fact the IP security working group was defining security for any kind of Ip",
    "start": "345280",
    "end": "351960"
  },
  {
    "text": "packet so clearly the l2tp guy said well if l2tp looks like an IP packet then use",
    "start": "351960",
    "end": "357880"
  },
  {
    "text": "IPC to secure it and we thought it was pretty straightforward on how to do that",
    "start": "357880",
    "end": "364720"
  },
  {
    "text": "um it turns out that the way l2tp is designed it's not at all straightforward given the way that IPC is designed so",
    "start": "364720",
    "end": "372039"
  },
  {
    "text": "I'm the co-author along with skip booth and another guy from Intel beu Patel and",
    "start": "372039",
    "end": "377880"
  },
  {
    "text": "another guy um who I forget right now Glen Zorn I think also with Cisco on the l2tp ipx security draft that's a draft",
    "start": "377880",
    "end": "386120"
  },
  {
    "text": "and we've been working on that for the last two years so um we do not support that draft in Windows 2000 we do",
    "start": "386120",
    "end": "392319"
  },
  {
    "text": "something as as close as we could and as interoperative as we could uh at the time we shipped so the top level",
    "start": "392319",
    "end": "401639"
  },
  {
    "text": "um picture that this slide shows you have a number of EP and gateways which will accept pptp or",
    "start": "401639",
    "end": "409440"
  },
  {
    "text": "l2tp um ciscon Cisco's iOS product uh Cisco now bought since this slide was",
    "start": "409440",
    "end": "415919"
  },
  {
    "text": "created alga um they bought compatible systems they have pix firewalls that also do VPN",
    "start": "415919",
    "end": "423800"
  },
  {
    "text": "have a bunch of VPN products so basically Cisco has a bunch of products almost all of which I think support pptp",
    "start": "423800",
    "end": "429680"
  },
  {
    "text": "they do not all support Ms chap V2 they may support only Ms chap V1 in",
    "start": "429680",
    "end": "435479"
  },
  {
    "text": "which case you are so against the password um guessing attacks so in the",
    "start": "435479",
    "end": "441879"
  },
  {
    "text": "sense that if your users have weak passwords which um I guess we'll assume that they do so be careful even though",
    "start": "441879",
    "end": "449160"
  },
  {
    "text": "you for using a particular product in your remote access Solutions today you need to make sure that it supports Ms",
    "start": "449160",
    "end": "455160"
  },
  {
    "text": "chap V2 um to get the strongest password based security all right um so if you",
    "start": "455160",
    "end": "462160"
  },
  {
    "text": "don't have pki I mean the the the whole you know ITF solution to user authentication in the internet was pki",
    "start": "462160",
    "end": "468759"
  },
  {
    "text": "and uh as some of you know it's been fairly difficult to deploy pki um if you have a pki then you have",
    "start": "468759",
    "end": "475919"
  },
  {
    "text": "two options in Windows 2000 if you don't have a p pki then basically what",
    "start": "475919",
    "end": "481159"
  },
  {
    "text": "Microsoft provides is pptp and your back to strong passwords and Ms chap V2",
    "start": "481159",
    "end": "486800"
  },
  {
    "text": "requirements okay so if you have a pki in Windows 2000 pptp was enhanced uh in",
    "start": "486800",
    "end": "493039"
  },
  {
    "text": "fact PPP in general so dial access as well as VPN access that uses PPP",
    "start": "493039",
    "end": "500280"
  },
  {
    "text": "pptp um was enhanced to support something called the extensible Authentication Protocol EAP EAP uh also",
    "start": "500280",
    "end": "509599"
  },
  {
    "text": "has a form that it does TLS right which is basically SSL inside a user authentication uh request um that's RFC",
    "start": "509599",
    "end": "518680"
  },
  {
    "text": "27 17 257 I think anyway both both EAP",
    "start": "518680",
    "end": "524080"
  },
  {
    "text": "methods that we support are rfcs the um the benefit of using EAP inside pptp is",
    "start": "524080",
    "end": "532240"
  },
  {
    "text": "that you can relieve yourself of the burden of password hashes on The Wire so if your user has a certificate either",
    "start": "532240",
    "end": "539079"
  },
  {
    "text": "it's on a smart card or the certificate lives on the computer disc right as part of the user's laptop um then they can",
    "start": "539079",
    "end": "546760"
  },
  {
    "text": "use pptp with EAP authentication what'll happen in there is that when you launch",
    "start": "546760",
    "end": "552160"
  },
  {
    "text": "the pptp uh pptp connecto it'll prompt for the user certificate the user",
    "start": "552160",
    "end": "557279"
  },
  {
    "text": "selects the certificate and away they go okay this support is also an l2tp for",
    "start": "557279",
    "end": "562800"
  },
  {
    "text": "user authentication this is certificate based user authentication all right it's also in",
    "start": "562800",
    "end": "568560"
  },
  {
    "text": "normal PPP dial if you're remote if if cis's 5300s and and others or any any of",
    "start": "568560",
    "end": "574800"
  },
  {
    "text": "the dial uh um access points that the isps have deployed if they have upgraded",
    "start": "574800",
    "end": "580240"
  },
  {
    "text": "the software and have an EAP compliant um PPP stack then you could also user",
    "start": "580240",
    "end": "585880"
  },
  {
    "text": "authenticate with certificates um everywhere through all uses of PPP so that we consider is a",
    "start": "585880",
    "end": "593720"
  },
  {
    "text": "substantial Improvement to pptp so it's not fair to say now that pptp is just",
    "start": "593720",
    "end": "599000"
  },
  {
    "text": "fun Ally insecure because of the password issue um it's fair to say that",
    "start": "599000",
    "end": "604279"
  },
  {
    "text": "in Windows 2000 pptp can be used with user certificate authentication in an RFC compatible way and um be I'll say",
    "start": "604279",
    "end": "613399"
  },
  {
    "text": "reasonably secure or at least secure against the password guessing attacks that are the greatest",
    "start": "613399",
    "end": "619360"
  },
  {
    "text": "vulnerability um l2tp can use as I said user search for authentication but",
    "start": "619360",
    "end": "625920"
  },
  {
    "text": "because it's ANF standard and because the standard way to secure IP traffic in the internet is to use IPC IPC will be",
    "start": "625920",
    "end": "632480"
  },
  {
    "text": "done first before l2tp ever authenticates the user so IPC has got to authenticate itself which is the machine",
    "start": "632480",
    "end": "640360"
  },
  {
    "text": "uh before lttp gets a chance to authenticate the user",
    "start": "640360",
    "end": "645440"
  },
  {
    "text": "okay yeah",
    "start": "645440",
    "end": "652360"
  },
  {
    "text": "yeah EAP the question was is there a connection between EAP and the user certificates EAP is what enables you to",
    "start": "657079",
    "end": "665399"
  },
  {
    "text": "use something other than a password for user authentication I'm sorry I I probably am throwing lingo faster than",
    "start": "665399",
    "end": "672680"
  },
  {
    "text": "uh people can absorb but EAP enables you to use some other user authentication mechanism other than passwords and so",
    "start": "672680",
    "end": "680000"
  },
  {
    "text": "that other method in this case is a user certificate um also I'm sorry it also",
    "start": "680000",
    "end": "686680"
  },
  {
    "text": "will enable secure ID right you can do uh secure ID through EAP as",
    "start": "686680",
    "end": "693160"
  },
  {
    "text": "well this is for any use of PPP in Windows 2000 so it's VPN certainly for",
    "start": "693160",
    "end": "700040"
  },
  {
    "text": "pptp and l2tp it's also for dial it's just when you know when you're building",
    "start": "700040",
    "end": "705399"
  },
  {
    "text": "the operating system people know the operating system is not going to be out there in the market for a while so the vendors typically delay their adoption",
    "start": "705399",
    "end": "710760"
  },
  {
    "text": "of new features until the operating system's out there and people can turn it on you know they also know that in",
    "start": "710760",
    "end": "716399"
  },
  {
    "text": "terms of their development priorities how many people have existing user Sears deployed very few so of course you know",
    "start": "716399",
    "end": "724040"
  },
  {
    "text": "they'll they'll support it over time and we wanted to get it in the operating system we made a huge effort uh and also",
    "start": "724040",
    "end": "729639"
  },
  {
    "text": "interoperative tested it um to get it out there so it's just there in wink and",
    "start": "729639",
    "end": "735000"
  },
  {
    "text": "as long as when 2K lives people don't have to do password-based authentication anymore okay so l2tp actually is",
    "start": "735000",
    "end": "743040"
  },
  {
    "text": "designed to do many things and this is the the the benefit partly of going through the standards process is that it",
    "start": "743040",
    "end": "748760"
  },
  {
    "text": "doesn't do just do um client remote access it was actually designed to",
    "start": "748760",
    "end": "755320"
  },
  {
    "text": "concentrate um normal PPP Dial Systems right so the value to somebody like",
    "start": "755320",
    "end": "761360"
  },
  {
    "text": "Cisco is that they can build what's called an lttp access concentrator and the access concentrator",
    "start": "761360",
    "end": "767639"
  },
  {
    "text": "can live at the dial point at the ISP dial Point it'll take existing PPP connections and by basically smartly",
    "start": "767639",
    "end": "775959"
  },
  {
    "text": "working with the PPP negotiation it can f the PPP negotiation actually end to end",
    "start": "775959",
    "end": "783920"
  },
  {
    "text": "all the way the PPP negotiation ends up happening partly to the lack but then also to the What's called the LNS the",
    "start": "783920",
    "end": "790120"
  },
  {
    "text": "lttp network server right this is the VPN Gateway the corporate VPN Gateway so",
    "start": "790120",
    "end": "796240"
  },
  {
    "text": "as far as the client is concerned he's doing a PPP dial session with his",
    "start": "796240",
    "end": "802399"
  },
  {
    "text": "ISP but what's actually happening behind the scenes is that this is securely",
    "start": "802399",
    "end": "807680"
  },
  {
    "text": "tunneled across the internet and it results in a VPN tunnel into the",
    "start": "807680",
    "end": "812760"
  },
  {
    "text": "corporation okay or into the you wherever you're tunneling to all",
    "start": "812760",
    "end": "818880"
  },
  {
    "text": "right it has yes yes in this sense in in",
    "start": "819399",
    "end": "825120"
  },
  {
    "text": "and from the standpoint that it's providing a tunnel across the quote Internet it's similar to l2f right uh",
    "start": "825120",
    "end": "831759"
  },
  {
    "text": "it's just a different protocol and it does UDP 1701 in capsulation okay so this is a way way",
    "start": "831759",
    "end": "839320"
  },
  {
    "text": "that down LEL clients can be secure from the point of presence from the pop dial server across the internet back to the",
    "start": "839320",
    "end": "845680"
  },
  {
    "text": "corporation and how do they know where to tunnel to because the Lac does get the user authentic uh does get a a",
    "start": "845680",
    "end": "851800"
  },
  {
    "text": "request for user authentication and can actually authenticate the user so it knows who the user is and the user is",
    "start": "851800",
    "end": "857079"
  },
  {
    "text": "going to say I'm you know W Dixon microsoft.com so it knows the microsoft.com it goes and looks up the",
    "start": "857079",
    "end": "863480"
  },
  {
    "text": "VPN server or has some configuration for what VPN server to go to at microsoft.com so it can basically reset",
    "start": "863480",
    "end": "869959"
  },
  {
    "text": "the PPP negotiation on the client and forward all that PPP traffic directly through l2tp um into microsoft.com VPN",
    "start": "869959",
    "end": "879040"
  },
  {
    "text": "server very useful notice no client changes right so this allowed them to to",
    "start": "879040",
    "end": "885320"
  },
  {
    "text": "basically sell services in the network secure tunneling VPN Services virtual private networks to companies that have",
    "start": "885320",
    "end": "892000"
  },
  {
    "text": "all the existing Dow clients okay the the key point to realize is the PPP negotiation is actually happening all",
    "start": "892000",
    "end": "898839"
  },
  {
    "text": "the way between the LNS and the N system it's just forwarded through an lttp",
    "start": "898839",
    "end": "904440"
  },
  {
    "text": "tunnel okay and the security in this case is between the Gateway and the lack",
    "start": "904440",
    "end": "910160"
  },
  {
    "text": "right that is the ipx security here so the lacks the Gateway has to know how to trust all the lacks the the axis",
    "start": "910160",
    "end": "917639"
  },
  {
    "text": "concentrators okay the other scenario is what we support uh the way",
    "start": "917639",
    "end": "923120"
  },
  {
    "text": "we saw value in l2tp and that is to replace pptp from a from a client here",
    "start": "923120",
    "end": "929079"
  },
  {
    "text": "the client is going to do IP SEC from the client you well first of all you're probably going to establish a PPP dial",
    "start": "929079",
    "end": "934959"
  },
  {
    "text": "session with your your your um access provider or you might be on broadband you could be just on the network right",
    "start": "934959",
    "end": "941279"
  },
  {
    "text": "or just plugged into the internet somehow right at a conference or airport over Wireless somehow you have access to",
    "start": "941279",
    "end": "947160"
  },
  {
    "text": "the internet and through PPP you got assigned an internet IP address right so using your internet IP address you're",
    "start": "947160",
    "end": "953480"
  },
  {
    "text": "going to negotiate IPC and authenticate from your client credential all the way back to the company VPN server so this",
    "start": "953480",
    "end": "961160"
  },
  {
    "text": "is the way I do remote access you know I I I authenticate my client authenticates with a certificate to the Gateway the",
    "start": "961160",
    "end": "967839"
  },
  {
    "text": "Gateway authenticates back to the client with a certificate that the client knows how to trust so now we have an ipx",
    "start": "967839",
    "end": "973079"
  },
  {
    "text": "secure Channel using the internet IPS of each side now that's I still have to authenticate the user right all I've",
    "start": "973079",
    "end": "980199"
  },
  {
    "text": "done is established a trusted encrypted Channel I'm still going to use l2tp to",
    "start": "980199",
    "end": "986360"
  },
  {
    "text": "talk over here and basically a PPP negotiation so that this guy knows who the user is and can allow him into the",
    "start": "986360",
    "end": "991920"
  },
  {
    "text": "network he can also assign an address back to the client an internal address right the classic thing we know about",
    "start": "991920",
    "end": "999600"
  },
  {
    "text": "VPN okay and then it lttp is also useful for just gateway to Gateway tunneling",
    "start": "1002440",
    "end": "1009079"
  },
  {
    "text": "right it's a it's a it appears as a ratable interface on both of these systems or all of these systems and as",
    "start": "1009079",
    "end": "1016079"
  },
  {
    "text": "it as a routable PPP dial on demand kind of interface uh it's very well understood very easy to support for",
    "start": "1016079",
    "end": "1022560"
  },
  {
    "text": "gateways and traffic comes in it gets routed to that do that uh routable interface gets pushed across the tunnel",
    "start": "1022560",
    "end": "1028678"
  },
  {
    "text": "and into the destination excuse me destination Network so the SEC Security in this case is between two VPN gateways",
    "start": "1028679",
    "end": "1035918"
  },
  {
    "text": "or two firewalls or whatever supporting l2tp in this case but all you know via the routing all traffic that's supposed",
    "start": "1035919",
    "end": "1042640"
  },
  {
    "text": "to go through the tunnel goes through the tunnel and the security is underneath and transparent to um the end",
    "start": "1042640",
    "end": "1048640"
  },
  {
    "text": "syst systems on either",
    "start": "1048640",
    "end": "1052039"
  },
  {
    "text": "Network yes you're using you're using a a machine CT to authenticate IPC",
    "start": "1057919",
    "end": "1064240"
  },
  {
    "text": "wherever IPC is shown up there the red basically to do IPC and then you're using a user credential be it password",
    "start": "1064240",
    "end": "1070720"
  },
  {
    "text": "or or via certificates or secure ID or whatever to authenticate the user in",
    "start": "1070720",
    "end": "1075760"
  },
  {
    "text": "this case you're not authenticating the user in the gateway to Gateway case you're just connecting networks right but it would be machine certificates",
    "start": "1075760",
    "end": "1082159"
  },
  {
    "text": "between the LNS or the firewalls or the routers okay so that this just says that Windows 2000 can perform these roles",
    "start": "1082159",
    "end": "1089960"
  },
  {
    "text": "which is basically all of the it can be a dial server for the nas um it can be Gateway it can do gateway to Gateway",
    "start": "1089960",
    "end": "1096280"
  },
  {
    "text": "lttp IPC it can be a a VPN Gateway for remote access clients as an LNS it can",
    "start": "1096280",
    "end": "1102400"
  },
  {
    "text": "be the client if you will uh for remote access what it does not do is this um",
    "start": "1102400",
    "end": "1108799"
  },
  {
    "text": "funky PVP proxy essentially uh as an access concentrator um but again redback and",
    "start": "1108799",
    "end": "1115520"
  },
  {
    "text": "Cisco and other people have already built those okay this talks and gives you all",
    "start": "1115520",
    "end": "1122200"
  },
  {
    "text": "the RFC information about PPP and our ability to to do",
    "start": "1122200",
    "end": "1127320"
  },
  {
    "text": "EAP um so in PPP right several authentication mechanisms PR chap Ms",
    "start": "1127320",
    "end": "1133360"
  },
  {
    "text": "chap they're all Pap is clear text passwords um Ms Chap and and chap we all",
    "start": "1133360",
    "end": "1139320"
  },
  {
    "text": "subject to password guessing Ms chap V2 also subject to password guessing but it takes a lot longer uh to do because the",
    "start": "1139320",
    "end": "1145960"
  },
  {
    "text": "length of the hashes are much longer it's more difficult to verify there's more things involved um it's an",
    "start": "1145960",
    "end": "1152240"
  },
  {
    "text": "informational RFC 2759 um published January 00 um okay the Windows 2000 adds EAP",
    "start": "1152240",
    "end": "1161919"
  },
  {
    "text": "right so there's the EAP rfc's and those are standard track",
    "start": "1161919",
    "end": "1167000"
  },
  {
    "text": "rfc's um so what you get out of PPP of course are the ability to Tunnel any",
    "start": "1167000",
    "end": "1173440"
  },
  {
    "text": "kind of traffic we still have a lot of folks doing ipx in small business right",
    "start": "1173440",
    "end": "1178520"
  },
  {
    "text": "you can do ipx across an lttp tunnel again our our goal was to replace pbtp what could PPP what could pbtp carry",
    "start": "1178520",
    "end": "1185000"
  },
  {
    "text": "everything PPP can carry which is all protocols so whether it's Apple talk or it's ipx or IP um or some other custom",
    "start": "1185000",
    "end": "1192240"
  },
  {
    "text": "protocol that wasn't IP it'll all work across PPP and LC people carry it so with one basically one choice of a VPN",
    "start": "1192240",
    "end": "1200039"
  },
  {
    "text": "protocol um I can get all of the traffic and net buoy let's not forget um I can",
    "start": "1200039",
    "end": "1206760"
  },
  {
    "text": "get all of the traffic that I needed to get uh through a VPN tunnel so uh this",
    "start": "1206760",
    "end": "1213120"
  },
  {
    "text": "really enables small businesses in particular if you set up a Windows 2000 server as a VPN server as a small business um it really doesn't matter",
    "start": "1213120",
    "end": "1220080"
  },
  {
    "text": "whether they're you using net buoy only or net bias for resource Discovery and communication and sharing and all that",
    "start": "1220080",
    "end": "1225559"
  },
  {
    "text": "stuff in the on their little internal land uh they can have a VPN and get access to their internal land they don't",
    "start": "1225559",
    "end": "1231520"
  },
  {
    "text": "have to do anything special whereas other remote access solutions that are IP only you know they only work with IP",
    "start": "1231520",
    "end": "1237640"
  },
  {
    "text": "so if you've got uh a small business using ipx for um internal uh network",
    "start": "1237640",
    "end": "1243200"
  },
  {
    "text": "sharing they can't use that okay most Enterprises just do IP so you know",
    "start": "1243200",
    "end": "1248640"
  },
  {
    "text": "that's their Market data compression um mppc the Microsoft pointto point compression is pretty much the industry",
    "start": "1248640",
    "end": "1255200"
  },
  {
    "text": "standard um and uh it's informational r there data protection uh the Microsoft",
    "start": "1255200",
    "end": "1262000"
  },
  {
    "text": "point topoint encryption is done in PPP called mppe and the way that it's done",
    "start": "1262000",
    "end": "1267559"
  },
  {
    "text": "and the revision to mppe based on Bruce scher's comments um are all published in",
    "start": "1267559",
    "end": "1273760"
  },
  {
    "text": "drafts okay so that's basically how PPP protects now in when uh IPC is being",
    "start": "1273760",
    "end": "1280039"
  },
  {
    "text": "done in uh to protect l2tp and the client knows about it it doesn't have to",
    "start": "1280039",
    "end": "1285240"
  },
  {
    "text": "do PPP encryption it still does PPP compression because that's still useful because ip6 is not doing the compression",
    "start": "1285240",
    "end": "1291880"
  },
  {
    "text": "right so if you wanted to compress your packets to get them through the quote dial of the VPN link PPP will do the compression you could turn it off and in",
    "start": "1291880",
    "end": "1299000"
  },
  {
    "text": "Gateway to Gateway vpns it may be um because compression is being done in software you probably want to turn off",
    "start": "1299000",
    "end": "1304400"
  },
  {
    "text": "software compression and there are options to do that in the UI even for VPN clients okay uh questions about PPP just",
    "start": "1304400",
    "end": "1313159"
  },
  {
    "text": "an incredibly well-known protocol it was just a great thing to leverage because everybody's got the infrastructure for it",
    "start": "1313159",
    "end": "1320520"
  },
  {
    "text": "okay when the VPN tunnel interface finally comes up it plums a default route down the VPN tunnel and that cuts",
    "start": "1330039",
    "end": "1336200"
  },
  {
    "text": "you off from the rest of your internet connections so right right and uh that was you know",
    "start": "1336200",
    "end": "1345159"
  },
  {
    "text": "without uh the ability to push routes to the client from the VPN Gateway way or have some policy control um that was our",
    "start": "1345159",
    "end": "1351600"
  },
  {
    "text": "best default behavior and I realize a lot of people want split tunneling and I have an equal number of customers that U",
    "start": "1351600",
    "end": "1358840"
  },
  {
    "text": "have very strong security requirements that say no right no access to the internet they want to even plump filters",
    "start": "1358840",
    "end": "1365000"
  },
  {
    "text": "right to just absolutely cut everything off else off when that VPN tunnel is connected because they're afraid of a proxy like an application layer proxy",
    "start": "1365000",
    "end": "1371960"
  },
  {
    "text": "doing something so they want to uh guarantee the No No Other access except traffic through the tunnel um we we",
    "start": "1371960",
    "end": "1378559"
  },
  {
    "text": "partially get there and you can programmatically get there with Connection Manager so here's what um we",
    "start": "1378559",
    "end": "1383960"
  },
  {
    "start": "1382000",
    "end": "1382000"
  },
  {
    "text": "were trying to describe earlier with that flow diagram um how lttp packets um",
    "start": "1383960",
    "end": "1389520"
  },
  {
    "text": "look on the wire let's first go through the the top points so it's designed the",
    "start": "1389520",
    "end": "1395000"
  },
  {
    "text": "l2tp tunneling protocol was designed as part of What's called the PPP extensions working group in the",
    "start": "1395000",
    "end": "1401120"
  },
  {
    "text": "ITF um combined both pptp and l2f came out as an RFC 2661 in August of 99",
    "start": "1401120",
    "end": "1408919"
  },
  {
    "text": "um now because l2tp is its own RFC and people are so excited about it they're",
    "start": "1408919",
    "end": "1414039"
  },
  {
    "text": "doing a lot of work to improve it to optimize it um there's a whole another working group called the lttp extensions",
    "start": "1414039",
    "end": "1419679"
  },
  {
    "text": "working group that's going on and so you see everybody uh who's in the dial access business um in that working",
    "start": "1419679",
    "end": "1427039"
  },
  {
    "text": "group one of the key uh distinguishing features about l2tp is it does inband control and data so it does control",
    "start": "1427039",
    "end": "1435480"
  },
  {
    "text": "messages and it and it has a way of overlapping control messages with data messages so it really can do inband uh",
    "start": "1435480",
    "end": "1443520"
  },
  {
    "text": "while the data is being transmitted um optimizations on the tunnel so it uses",
    "start": "1443520",
    "end": "1448679"
  },
  {
    "text": "all of this happens over UDP 1701 when you're running lttp across an IP network",
    "start": "1448679",
    "end": "1454400"
  },
  {
    "text": "you can run lttp across frame relay you can run lttp directly across um ATM and",
    "start": "1454400",
    "end": "1460200"
  },
  {
    "text": "many people have done that um but you know when you're going across an otherwise IP network you use IP and UDP",
    "start": "1460200",
    "end": "1467559"
  },
  {
    "text": "for encapsulation right so we get down to okay what does this mean uh it means",
    "start": "1467559",
    "end": "1472799"
  },
  {
    "text": "basically that your application data is here well your original right you get assign the the address that you're going",
    "start": "1472799",
    "end": "1479320"
  },
  {
    "text": "to use right as your internal IP packet or you're routing traffic through the tunnel so this is your original Ip",
    "start": "1479320",
    "end": "1485159"
  },
  {
    "text": "packet with your internal IP in the case of remote access client PPP um I believe",
    "start": "1485159",
    "end": "1491919"
  },
  {
    "text": "it's a one byte PPP header so it's it's actually very small l2tp is eight bytes",
    "start": "1491919",
    "end": "1498799"
  },
  {
    "text": "uh as a it has session identifiers and a and variety of information that it requires 8 bytes UDP by definition has",
    "start": "1498799",
    "end": "1506039"
  },
  {
    "text": "eight byes um so you've got 8 8 16 17 bytes to basically do all of these",
    "start": "1506039",
    "end": "1513559"
  },
  {
    "text": "scenarios um for tunneling that's why it's an extremely capable protocol there",
    "start": "1513559",
    "end": "1519240"
  },
  {
    "text": "is something to invest in that solved all these different scenarios and and and certainly for us enable us to get",
    "start": "1519240",
    "end": "1524679"
  },
  {
    "text": "off a pptp l2tp was it um so this doesn't provide encryption",
    "start": "1524679",
    "end": "1530760"
  },
  {
    "text": "unless we were going to do PPP based encryption right inside here so the VPN server because of that first scenario",
    "start": "1530760",
    "end": "1537799"
  },
  {
    "text": "that I showed where clients they're actual real PPP clients that are coming into a VPN server the VPN server will",
    "start": "1537799",
    "end": "1544840"
  },
  {
    "text": "accept PPP encryption if it's negotiated by the client um for for packets because",
    "start": "1544840",
    "end": "1551279"
  },
  {
    "text": "the ppps the IPC protection may not actually be going all the way to the client the client May request mppe",
    "start": "1551279",
    "end": "1557399"
  },
  {
    "text": "anyway but uh by default we won't use MPP encryption if the client knows that",
    "start": "1557399",
    "end": "1563279"
  },
  {
    "text": "it's going to be IPC protected and so in lttp and Windows 2000 we don't have a way of doing l2tp without IPC because",
    "start": "1563279",
    "end": "1571720"
  },
  {
    "text": "l2tp without IPC has no security model right so or at least has only a user",
    "start": "1571720",
    "end": "1578520"
  },
  {
    "text": "authentication so in Windows 2000 we always use IPC to protect l2tp and in the case of of a VPN tunnel all of the",
    "start": "1578520",
    "end": "1587760"
  },
  {
    "text": "tunnel all of the tunnel control messages all the tunnel establishment um the fact that it is a tunnel it is an",
    "start": "1587760",
    "end": "1593960"
  },
  {
    "text": "l2tp packet is completely hidden because everything is encrypted for this entire",
    "start": "1593960",
    "end": "1600080"
  },
  {
    "text": "blob um and that's using IPC ESP we we have a bunch of options which will",
    "start": "1601000",
    "end": "1606159"
  },
  {
    "text": "support us up to the Gateway to uh choose there's some client options that you can require encryption and things",
    "start": "1606159",
    "end": "1611480"
  },
  {
    "text": "like that that are um synonymous with the pptp settings but this is what's happening now the impact of this right",
    "start": "1611480",
    "end": "1620799"
  },
  {
    "text": "is that instead of um pptp being an IP and GRE packet and GRE has session",
    "start": "1620799",
    "end": "1627760"
  },
  {
    "text": "identifiers right if you're going through natat right natat now doesn't see the UDP headers it doesn't see",
    "start": "1627760",
    "end": "1633840"
  },
  {
    "text": "anything in here so a network address translator that's trying to translate this in fact cannot translate even the",
    "start": "1633840",
    "end": "1640640"
  },
  {
    "text": "IP header because of the way it's integrated in with IPC by Design in the RFC so the IPC working group just punted",
    "start": "1640640",
    "end": "1647799"
  },
  {
    "text": "on the whole question ofn traversal uh so far um they are now trying to",
    "start": "1647799",
    "end": "1653600"
  },
  {
    "text": "entertain a standard for Nat traversal um and I'm one of the co-authors on a on a proposal that hasn't been published",
    "start": "1653600",
    "end": "1658760"
  },
  {
    "text": "yet but um we'll basically be having that discussion in Minneapolis um in",
    "start": "1658760",
    "end": "1665158"
  },
  {
    "text": "March Nat is not an option it's not an option because the packet on The Wire",
    "start": "1666840",
    "end": "1672640"
  },
  {
    "text": "looks like a regular ipv4 packet but it's got an ESP um header on it so can't",
    "start": "1672640",
    "end": "1678480"
  },
  {
    "text": "translate this and remember first there was an Ike negotiation okay that took place first",
    "start": "1678480",
    "end": "1683880"
  },
  {
    "text": "Ike negotiation was on UDP Port 500 it turns out that because of the embedded IP addresses inside the ike encrypted",
    "start": "1683880",
    "end": "1690399"
  },
  {
    "text": "negotiation Nats can't even translate that",
    "start": "1690399",
    "end": "1695559"
  },
  {
    "text": "okay right right",
    "start": "1702039",
    "end": "1709039"
  },
  {
    "text": "yes the answer is yes the the problem is that in order to get Nat traversal I mean a lot of VPN vendors just had to",
    "start": "1710840",
    "end": "1717760"
  },
  {
    "text": "cook up something and they wanted to go to market very quickly I mean they didn't want to wait for a standards process so they've kind of bastardize",
    "start": "1717760",
    "end": "1724679"
  },
  {
    "text": "the way that they process IP SEC on receive so they can allow the IP header to change and they do something funky in",
    "start": "1724679",
    "end": "1730720"
  },
  {
    "text": "the ike negotiation which allows them first of all to do address assignment because it doesn't make any sense if",
    "start": "1730720",
    "end": "1736720"
  },
  {
    "text": "this is your internet IP it doesn't make sense right your quote private IP it's got you have to have address assignment",
    "start": "1736720",
    "end": "1742279"
  },
  {
    "text": "so the only time IPC tunneling works with Nat is when you're doing xof and I config to do address assignment back to",
    "start": "1742279",
    "end": "1749000"
  },
  {
    "text": "the client internal address assignment back to the client then um then they format the IPC",
    "start": "1749000",
    "end": "1755600"
  },
  {
    "text": "packet if it is if they there's two ways to do it one is that it's an IPC packet",
    "start": "1755600",
    "end": "1760720"
  },
  {
    "text": "and you do something funky on receive to allow the natat to and on the on on receive on both sides on the client and",
    "start": "1760720",
    "end": "1766480"
  },
  {
    "text": "on the Gateway so that you don't mind the IP addresses changing in here um and you don't require the addresses in in",
    "start": "1766480",
    "end": "1772919"
  },
  {
    "text": "the ike negotiation um if you do that then you'll still go through what's called",
    "start": "1772919",
    "end": "1778559"
  },
  {
    "text": "IPC awars there's a Linux masquerade uh U basically documentation program",
    "start": "1778559",
    "end": "1785440"
  },
  {
    "text": "implementation that that shows you how to track IPC sessions with Ike sessions",
    "start": "1785440",
    "end": "1790840"
  },
  {
    "text": "in the same way that natat might Traverse might might handle um pbtp the other and better op option in",
    "start": "1790840",
    "end": "1798320"
  },
  {
    "text": "the way the alga originally shipped was that they put a TCP Port 80 header between IP and IP SEC and they figured",
    "start": "1798320",
    "end": "1805360"
  },
  {
    "start": "1803000",
    "end": "1803000"
  },
  {
    "text": "hey everybody allows you know TCP Port 80 through we'll just use TCP Port 80",
    "start": "1805360",
    "end": "1810799"
  },
  {
    "text": "we'll make it all look like web traffic so that's what they did it's not actually TCP it's a faked out TCP uh but",
    "start": "1810799",
    "end": "1817640"
  },
  {
    "text": "they had to do enough of TCP to do the um sin act and act back in order for",
    "start": "1817640",
    "end": "1823880"
  },
  {
    "text": "some firewalls and proxies to kind of recognize it as TCP so yes or now and so they will allow a a TCP header Port 80",
    "start": "1823880",
    "end": "1832559"
  },
  {
    "text": "here other people have used a UDP header here and it looks like and when we all got together and talked about this that",
    "start": "1832559",
    "end": "1839279"
  },
  {
    "text": "the way that we're going to do it is a UDP header stuck right in the middle right here to allow nap to process it",
    "start": "1839279",
    "end": "1847880"
  },
  {
    "text": "now I'll be honest that sucks because you got another eight bytes of overhead um but you also have additional session",
    "start": "1847880",
    "end": "1854480"
  },
  {
    "text": "management that you have to map the IPC essay to the ud ports that are being used and that's not",
    "start": "1854480",
    "end": "1860960"
  },
  {
    "text": "trivial so we're working out how to do that right now um and hopefully the",
    "start": "1860960",
    "end": "1867200"
  },
  {
    "text": "standard will come together if you want to see an active uh discussion uh come",
    "start": "1867200",
    "end": "1872600"
  },
  {
    "text": "visit Minneapolis with",
    "start": "1872600",
    "end": "1875638"
  },
  {
    "text": "me right so basically Nat traversal um you can use pptp maybe if theat on the",
    "start": "1880919",
    "end": "1887919"
  },
  {
    "text": "firewall allows you to uh do pptp or you can use and again you could use pptp",
    "start": "1887919",
    "end": "1894559"
  },
  {
    "text": "with the certificate user certificate authentication right so there is a more or less a secure way to do pbtp but",
    "start": "1894559",
    "end": "1902639"
  },
  {
    "text": "that's only Windows 2000 that doesn't help your down LEL client and in the end the VPN gateways that uh rushed to",
    "start": "1902639",
    "end": "1908960"
  },
  {
    "text": "Market it was very interesting Cisco and Cisco and Microsoft jointly developed this part of IPC not lttp exactly but",
    "start": "1908960",
    "end": "1916440"
  },
  {
    "text": "IPC capabilities overall in Windows 2000 and we also collaborated on the lttp draft and we thought we were together",
    "start": "1916440",
    "end": "1924080"
  },
  {
    "text": "right and then as the IP set community matured you had a lot of uh very small companies selling VPN gateways and they",
    "start": "1924080",
    "end": "1930039"
  },
  {
    "text": "were they had customized this Ike and hacked it and um and were saying yeah look what we can do right and they were",
    "start": "1930039",
    "end": "1937000"
  },
  {
    "text": "basically selling and Cisco looked at this and said these guys are beating me in the market you know and I don't have",
    "start": "1937000",
    "end": "1942960"
  },
  {
    "text": "an lttp ipx solution and when I do it's not going to go through nap because that's how the ITF working group said uh",
    "start": "1942960",
    "end": "1949159"
  },
  {
    "text": "that that's the standard so basically you saw a lot of acquisitions by Cisco",
    "start": "1949159",
    "end": "1954200"
  },
  {
    "text": "and others um Network Alchemy was bought by Nokia and you know a bunch of people basically the whole VPN Market just",
    "start": "1954200",
    "end": "1960080"
  },
  {
    "text": "Consolidated and what happened was because they bought those products and those products had these these altea",
    "start": "1960080",
    "end": "1965559"
  },
  {
    "text": "ways of doing things um they ended up doing it that way so everybody basically",
    "start": "1965559",
    "end": "1970840"
  },
  {
    "text": "threw out the standards approach uh when it went time to go to market",
    "start": "1970840",
    "end": "1976919"
  },
  {
    "text": "um I think that your best bet will be deploy user Sears and use that with pptp",
    "start": "1981919",
    "end": "1987799"
  },
  {
    "text": "because it'll at least go through pptp aware gats and pptp aware firewalls if",
    "start": "1987799",
    "end": "1993320"
  },
  {
    "text": "you have user Sears right um so",
    "start": "1993320",
    "end": "2000398"
  },
  {
    "text": "yeah oh uh well I submitted these slides so I thought I thought you guys had them",
    "start": "2001519",
    "end": "2006760"
  },
  {
    "text": "all printed out there's a lot of slides that that I have and that I submitted maybe 200 okay I'm sorry well this is",
    "start": "2006760",
    "end": "2013080"
  },
  {
    "text": "good so they better be on the CD",
    "start": "2013080",
    "end": "2019039"
  },
  {
    "start": "2015000",
    "end": "2015000"
  },
  {
    "text": "okay all right um so the lttp ipch VPN client as I said it you can migrate off",
    "start": "2019039",
    "end": "2025399"
  },
  {
    "text": "a pptp with it um as to the extent that you can install Windows 2000 um IP SEC",
    "start": "2025399",
    "end": "2031799"
  },
  {
    "text": "is integrated with l2tp we'll see how that works uh we do require machine certificates because this idea of a",
    "start": "2031799",
    "end": "2038240"
  },
  {
    "text": "group pre-shared key was not secure and it was you know had known cryptographic attacks um at least they basically they",
    "start": "2038240",
    "end": "2046240"
  },
  {
    "text": "it's the same thing right you have you have a password and they just guess the password so if you have a weak pre-shared key you know this is my",
    "start": "2046240",
    "end": "2053118"
  },
  {
    "text": "pre-shared key or pre-share key or password or whatever it is they just guess that it's a little harder but they",
    "start": "2053119",
    "end": "2058560"
  },
  {
    "text": "can still guess it um and then uh a fellow came up and asked me would we",
    "start": "2058560",
    "end": "2063839"
  },
  {
    "text": "support keros for IPC authentication between a remote access client and a and a VPN Gateway and the answer is no we",
    "start": "2063839",
    "end": "2071118"
  },
  {
    "text": "don't because the cerbos that you know how to get a credential from is inside",
    "start": "2071119",
    "end": "2077079"
  },
  {
    "text": "the company Network and you didn't I mean I would never recommend that somebody open to the internet their KDC",
    "start": "2077079",
    "end": "2083358"
  },
  {
    "text": "on the inside of the network so that things could work so Sears were the right way to do it um you securely",
    "start": "2083359",
    "end": "2088960"
  },
  {
    "text": "deployed them to your client you used auto enroll or you used manual enrollment in some ways and Now from anywhere in the internet your client",
    "start": "2088960",
    "end": "2095040"
  },
  {
    "text": "says hey I'm a member of the company um is the effective um U security agreement",
    "start": "2095040",
    "end": "2101839"
  },
  {
    "text": "and there are ways to get a machine certificate okay so here's the automatic policy right this is what most people",
    "start": "2101839",
    "end": "2108440"
  },
  {
    "start": "2105000",
    "end": "2105000"
  },
  {
    "text": "don't get and you guys will be so smart when you go back you'll say oh I know how this works it's piece of cake okay",
    "start": "2108440",
    "end": "2114599"
  },
  {
    "text": "um IPC is based on filtering it's looking for packets right it's looking for packets to secure all the packets",
    "start": "2114599",
    "end": "2120760"
  },
  {
    "text": "are whizzing by it and it's saying do I need to secure it do I need to secure it do I need to secure it and the filter",
    "start": "2120760",
    "end": "2126480"
  },
  {
    "text": "that gets created by the V PN client is source of my IP address okay which is",
    "start": "2126480",
    "end": "2131520"
  },
  {
    "text": "the internet IP address destination is the Gateway IP address because it already did a DNS resolution or the IP",
    "start": "2131520",
    "end": "2137160"
  },
  {
    "text": "address was statically configured in the VPN client protocol is UDP because that's lttp right and Source Port 1701",
    "start": "2137160",
    "end": "2145160"
  },
  {
    "text": "desk Port any is the way the filter is uh",
    "start": "2145160",
    "end": "2150800"
  },
  {
    "text": "created and I'll talk about why that is in a minute the inbound filter is okay",
    "start": "2150800",
    "end": "2157160"
  },
  {
    "text": "so we have an outbound filter for when we send l2tp traffic and we have an inbound filter to make sure that we only",
    "start": "2157160",
    "end": "2162680"
  },
  {
    "text": "receive secured l2tp traffic so Source Gateway IP address destination my IP",
    "start": "2162680",
    "end": "2167960"
  },
  {
    "text": "address protocol UDP Source Port any desport 1701 um our l2tp client uses always",
    "start": "2167960",
    "end": "2175960"
  },
  {
    "text": "Source 1701 death 1701 when we and that's just our",
    "start": "2175960",
    "end": "2181800"
  },
  {
    "text": "implementation choice because it's a kernel mode client and you don't want to have to get into the business of mapping",
    "start": "2181800",
    "end": "2187400"
  },
  {
    "text": "um you basically deconflict um user mode UDP Port usage so we just always use UDP",
    "start": "2187400",
    "end": "2193520"
  },
  {
    "text": "1701 as our source Port um what happens is that in the l2tp spec the even though",
    "start": "2193520",
    "end": "2200359"
  },
  {
    "text": "the desk Port is 1701 that we're sending traffic to what we negotiate that is the",
    "start": "2200359",
    "end": "2205880"
  },
  {
    "text": "ipx security that's negotiated is negotiated for Source 1701 death any",
    "start": "2205880",
    "end": "2211280"
  },
  {
    "text": "because the reverse of that is the gateways Source any port down back to",
    "start": "2211280",
    "end": "2216720"
  },
  {
    "text": "the client now this seems a little strange to you like well why wouldn't I negotiate",
    "start": "2216720",
    "end": "2222480"
  },
  {
    "text": "security from my client IP um my my client port to the gateways 1701 so",
    "start": "2222480",
    "end": "2229160"
  },
  {
    "text": "reverse this from any to 1701 that seems to be the right way to go and the reason is because the Gateway if it re if it if",
    "start": "2229160",
    "end": "2237680"
  },
  {
    "text": "the Gateway accepted that then the reverse of that is from 1701 D any back",
    "start": "2237680",
    "end": "2245240"
  },
  {
    "text": "to the client well what happens is that many gateways",
    "start": "2245240",
    "end": "2250359"
  },
  {
    "text": "in order to sort of um depends on how they implement but in the l2tp RFC they can float their response",
    "start": "2250359",
    "end": "2256119"
  },
  {
    "text": "Port so they don't have to reply back from 1701 they can reply back from you",
    "start": "2256119",
    "end": "2262359"
  },
  {
    "text": "know 1033 and send back to the client's Source Port so what is a client Source port in",
    "start": "2262359",
    "end": "2270560"
  },
  {
    "text": "our implementation we always fix it to be 1701 um if you read the lttp IPC",
    "start": "2270560",
    "end": "2276319"
  },
  {
    "text": "security draft you'll realize suddenly we have uh the potential for a completely Dynamic negotiation if I",
    "start": "2276319",
    "end": "2282599"
  },
  {
    "text": "choose a port and go to 1701 he choose a port and comes back to me now we have communication across an arbitrary Port",
    "start": "2282599",
    "end": "2289720"
  },
  {
    "text": "basically um very hard to do and that's why the security draft is hard and that's why it wasn't obvious how to do",
    "start": "2289720",
    "end": "2295240"
  },
  {
    "text": "it when we talked to vendors as we were building Windows 2000 we said how do how should we",
    "start": "2295240",
    "end": "2300400"
  },
  {
    "text": "behave um and we will we we decided with",
    "start": "2300400",
    "end": "2305839"
  },
  {
    "text": "the vendors um nor in Cisco primarily that this was okay and I mean you have",
    "start": "2305839",
    "end": "2311440"
  },
  {
    "text": "to make an interoperability decision so we decided that was okay and we shipped it and then uh upon further review and",
    "start": "2311440",
    "end": "2319079"
  },
  {
    "text": "upon a whole bunch of other people being involved in the discussion they decided Well that's not the way to do it you",
    "start": "2319079",
    "end": "2324280"
  },
  {
    "text": "should you should change it back and there's this Dynamic filter reinjection model where if the Gateway the Gateway",
    "start": "2324280",
    "end": "2329440"
  },
  {
    "text": "decides to reply back from a port that's not 1701 then it's got to negotiate back to the client and set up two ipcas and",
    "start": "2329440",
    "end": "2336240"
  },
  {
    "text": "we said oh my God okay okay fine so that's the way the draft is written um and that's almost the way nobody",
    "start": "2336240",
    "end": "2342200"
  },
  {
    "text": "implements way the way people Implement is is this way okay so I basically explained that",
    "start": "2342200",
    "end": "2348920"
  },
  {
    "text": "win 2k's l2tp implementation uses Source 1701 death death 1701 all the time",
    "start": "2348920",
    "end": "2356079"
  },
  {
    "text": "um and the the reason for this uh weirdness is because the Gateway could",
    "start": "2356079",
    "end": "2362800"
  },
  {
    "text": "float its Port according to the RFC fine we want they have one client that could work",
    "start": "2362800",
    "end": "2368560"
  },
  {
    "text": "against both gateways in the end we found out nobody was was floating their port on the Gateway so we didn't support that ability in the client so we have a",
    "start": "2368560",
    "end": "2375839"
  },
  {
    "text": "little and now it's there so we have to support it okay lttp IPC client automatically generates the IPC security",
    "start": "2375839",
    "end": "2382200"
  },
  {
    "text": "rule as I mentioned there's there's really no security settings there's some data encryption settings that you set but there's no nothing specific about",
    "start": "2382200",
    "end": "2388280"
  },
  {
    "text": "IPC that you set and um the way this works is that in the VPN UI I don't know",
    "start": "2388280",
    "end": "2395200"
  },
  {
    "text": "if I still have it up [Music]",
    "start": "2395200",
    "end": "2401440"
  },
  {
    "text": "no well um if we get time here at the end we probably running out of time in",
    "start": "2401440",
    "end": "2406880"
  },
  {
    "text": "the VPN UI you have a data encryption setting and this setting applies to pptp if you're using pptp or it applies to",
    "start": "2406880",
    "end": "2412680"
  },
  {
    "text": "lttp if you're using lttp if you're using lttp and your data encryption is require encryption disconnect of server",
    "start": "2412680",
    "end": "2418480"
  },
  {
    "text": "declines or uh you know request encryption um and it's okay if the",
    "start": "2418480",
    "end": "2426319"
  },
  {
    "text": "server declines and then then there's uh no no secur no encryption and then",
    "start": "2426319",
    "end": "2431800"
  },
  {
    "text": "there's maximum encryption so there's four possible settings four possible settings for the",
    "start": "2431800",
    "end": "2437560"
  },
  {
    "text": "for the encryption type on the client these translate to uh the encryption settings that are",
    "start": "2437560",
    "end": "2445440"
  },
  {
    "text": "negotiated in the quick mode of the I negotiation so that's there um",
    "start": "2445440",
    "end": "2453800"
  },
  {
    "text": "and realize also well come back also the so that's that's the encryption",
    "start": "2453800",
    "end": "2459920"
  },
  {
    "text": "setting on the tunnel so that it's it's set but it's set indirectly by your data encryption settings in the UI as far as",
    "start": "2459920",
    "end": "2467520"
  },
  {
    "text": "the machine pki configuration goes it could let's say that it has two machine CTS a machine CT from ca1 and a machine",
    "start": "2467520",
    "end": "2474400"
  },
  {
    "text": "CT from ca2 okay maybe it just has one machine CT it doesn't matter um but it could",
    "start": "2474400",
    "end": "2480640"
  },
  {
    "text": "have many machine",
    "start": "2480640",
    "end": "2484119"
  },
  {
    "text": "Sears all right so if we were doing the encryption the Gateway uh the client",
    "start": "2486240",
    "end": "2491839"
  },
  {
    "text": "proposes a list of of security methods in in quick mode and the Gateway is it's up to the Gateway to choose which one",
    "start": "2491839",
    "end": "2498640"
  },
  {
    "text": "but for authentication method what happens is that the lttp client looks at",
    "start": "2498640",
    "end": "2504440"
  },
  {
    "text": "the machine store right at the time it connects and you you bring up the UI and you hit connect when you hit connect it",
    "start": "2504440",
    "end": "2510800"
  },
  {
    "text": "looks at the the search that you have private keys for right this is the machine search and the in the personal",
    "start": "2510800",
    "end": "2517240"
  },
  {
    "text": "store and it generates the list of roots that these Sears chain to because in IPC",
    "start": "2517240",
    "end": "2524760"
  },
  {
    "text": "policy you can only specify and negotiate Roots right so we looked at at the",
    "start": "2524760",
    "end": "2529960"
  },
  {
    "text": "credentials that you could possibly authenticate with built the authentication method which is in this",
    "start": "2529960",
    "end": "2535359"
  },
  {
    "text": "case let's say two separate Roots ca1 root and ca2 roote so that's automatically",
    "start": "2535359",
    "end": "2540680"
  },
  {
    "text": "generated uh when LCP goes to create the IPC policy okay after after that it's",
    "start": "2540680",
    "end": "2547559"
  },
  {
    "text": "straightforward right now we know we know the filter all right let me back up before",
    "start": "2547559",
    "end": "2554000"
  },
  {
    "text": "we show the stack we have a full specification of the policy now right we know the source",
    "start": "2554000",
    "end": "2559960"
  },
  {
    "text": "IP we know the dust IP we know it's UDP 1701 we got the filter thing worked out",
    "start": "2559960",
    "end": "2565400"
  },
  {
    "text": "um we needed to specify the encryption level which we did via the data encryption setting on the client and and",
    "start": "2565400",
    "end": "2571280"
  },
  {
    "text": "agreement on the Gateway and the only real trick was how do you authenticate right and the way that we",
    "start": "2571280",
    "end": "2576880"
  },
  {
    "text": "did it was to look at the machine store the the search that you could possibly send to the other guy the search for",
    "start": "2576880",
    "end": "2583960"
  },
  {
    "text": "which you have private Keys generated the the off me off method for IPC policy",
    "start": "2583960",
    "end": "2589880"
  },
  {
    "text": "um in there okay so what's going to happen the Gateway is going to connect U sorry the ike negotiation is going to",
    "start": "2589880",
    "end": "2596119"
  },
  {
    "text": "happen you're going to propose certificate authentication uh The Roots will be negotiated and then you'll",
    "start": "2596119",
    "end": "2601480"
  },
  {
    "text": "provide one of the ca1 or ca2 machine Sears and use that private key to sign the exchange in Ike",
    "start": "2601480",
    "end": "2609119"
  },
  {
    "text": "okay so this is the um this is the picture of the stack which was sort of",
    "start": "2610160",
    "end": "2615960"
  },
  {
    "text": "the other part was an extraction out of bunch of things going on in here um let me just walk you around it",
    "start": "2615960",
    "end": "2623280"
  },
  {
    "text": "up top um there's windsock above that there are other apis",
    "start": "2623280",
    "end": "2629640"
  },
  {
    "text": "the multi-protocol router MP apis which are published in the SDK ipel API is",
    "start": "2629640",
    "end": "2634880"
  },
  {
    "text": "published in the SDK both those apis in the SDK support what's called PF filter",
    "start": "2634880",
    "end": "2641079"
  },
  {
    "text": "apis the PF filter apis actually take effect right here in What's called the",
    "start": "2641079",
    "end": "2647040"
  },
  {
    "text": "packet filter driver and the reason that I show you all of this is because uh it's there and",
    "start": "2647040",
    "end": "2654440"
  },
  {
    "text": "I don't want you to be surprised when you're looking at behavior and you're trying to understand the way filtering is done in the system there are several",
    "start": "2654440",
    "end": "2661400"
  },
  {
    "text": "places where filtering is done and I want I want to make it plain so you so you know okay so that's the public apis for",
    "start": "2661400",
    "end": "2669280"
  },
  {
    "text": "just interface specific filtering which which are defined and I think we supported both those and nt4 and we",
    "start": "2669280",
    "end": "2675800"
  },
  {
    "text": "support those in Windows 2000 new in Windows 2000 is the IP hook call out so in kernel mode you can write",
    "start": "2675800",
    "end": "2683400"
  },
  {
    "text": "a simple uh kernel mode driver. CIS file that will bind into this interface and",
    "start": "2683400",
    "end": "2689040"
  },
  {
    "text": "be able to intercept packets that go in and intercept packet it come out that's called the IP",
    "start": "2689040",
    "end": "2696040"
  },
  {
    "text": "hook there is an unpublished way that ip. CYS interacts with the stack it also",
    "start": "2696040",
    "end": "2702200"
  },
  {
    "text": "sees traffic coming in and going out and the reason that this little green thing here corresponds to Whistler this is",
    "start": "2702200",
    "end": "2708920"
  },
  {
    "text": "approximately where the personal firewall is acting so there is in Whistler there's a personal firewall",
    "start": "2708920",
    "end": "2715319"
  },
  {
    "text": "it's a stateful firewall that allows outbound connections and and and replies to outbound connections kind of like",
    "start": "2715319",
    "end": "2721240"
  },
  {
    "text": "natat but it'll reject any inbound packet that doesn't already have an established connection it's a simple one",
    "start": "2721240",
    "end": "2727800"
  },
  {
    "text": "but it's fairly effective so personal firewall is enabled uh right here above IPC this",
    "start": "2727800",
    "end": "2737160"
  },
  {
    "text": "this interface point is above IPC you don't see IPC yet let me put that in there so IPC um slides in right",
    "start": "2737160",
    "end": "2745040"
  },
  {
    "text": "here so all of the IPC decisions about uh encapsulation of traffic filtering of",
    "start": "2745040",
    "end": "2751760"
  },
  {
    "text": "traffic happen right here right above IP fragmentation and reassembly",
    "start": "2751760",
    "end": "2757480"
  },
  {
    "text": "you should think that IPC is just completely embedded inside tcpip and it's it's a internet standard",
    "start": "2757480",
    "end": "2764680"
  },
  {
    "text": "for for security of Ip packets it's a native part of Windows 2000 we built the fil we built the feature in win 2K in wi",
    "start": "2764680",
    "end": "2772119"
  },
  {
    "text": "2K we actually allow you to um to just completely rip this out in um in",
    "start": "2772119",
    "end": "2778800"
  },
  {
    "text": "Whistler you can disable it but it can't be ripped out it's it's a it's a part of the tcpip stack it loads with tcpip and",
    "start": "2778800",
    "end": "2786599"
  },
  {
    "text": "it unloads with tcpip in Whistler uh in when 2K it can be unloaded and loaded",
    "start": "2786599",
    "end": "2792119"
  },
  {
    "text": "separately so we're again we're trying to introduce something but we have to do it over time uh so that people can",
    "start": "2792119",
    "end": "2799200"
  },
  {
    "text": "adapt uh by the time we get to blackc I suspect it'll look exactly like this and",
    "start": "2799200",
    "end": "2804280"
  },
  {
    "text": "it'll just be part of the the stack so IP fragmentation reassembly is below IPC",
    "start": "2804280",
    "end": "2809480"
  },
  {
    "text": "because IPC is defined to work on the full IP packet so whether it's a UDP packet TCP packet or or icmp or some",
    "start": "2809480",
    "end": "2816280"
  },
  {
    "text": "large IP packet uh IP SEC works just above it so all the filtering permit",
    "start": "2816280",
    "end": "2822640"
  },
  {
    "text": "block require security happen right here all inbound traffic see goes through IPC",
    "start": "2822640",
    "end": "2828079"
  },
  {
    "text": "all outbound traffic goes through IP um okay so fragmented traffic don't",
    "start": "2828079",
    "end": "2833920"
  },
  {
    "text": "go through IPC filtering until it's reassembled now the point down here is that netmon is sniffing at this",
    "start": "2833920",
    "end": "2840559"
  },
  {
    "text": "layer okay netmon is sniffing below IPC so if IPC is encrypting traffic netmon",
    "start": "2840559",
    "end": "2847319"
  },
  {
    "text": "on that box will sniff encrypted traffic yes",
    "start": "2847319",
    "end": "2852558"
  },
  {
    "text": "sir netmon sniffs at Layer Two um they know well uh the answer",
    "start": "2852839",
    "end": "2861599"
  },
  {
    "text": "quickly is no um they know about these other interfaces the problem is",
    "start": "2861599",
    "end": "2866760"
  },
  {
    "text": "correlating packets so if they sniff down here which they will see the packet then it'll",
    "start": "2866760",
    "end": "2874200"
  },
  {
    "text": "it'll come up it'll be decrypted and look completely different up here um on the outbound they don't",
    "start": "2874200",
    "end": "2881599"
  },
  {
    "text": "have the interface they don't have the Mac information that they would normally have down here so on outbound traffic",
    "start": "2881599",
    "end": "2887040"
  },
  {
    "text": "they've got to cook up a MAC address to to index it in the netmon whole architecture of recording sniffs and",
    "start": "2887040",
    "end": "2893440"
  },
  {
    "text": "they they can't and then they they're going to see that packet again and they can't correlate it so it's not it's not",
    "start": "2893440",
    "end": "2899520"
  },
  {
    "text": "a simple thing it's just allowing netmon to sniff above uh the best they could do is have a completely new mode where they",
    "start": "2899520",
    "end": "2906440"
  },
  {
    "text": "only sniff at the top end of the stack out of one of these apis but um they couldn't get that done for Whistler",
    "start": "2906440",
    "end": "2912160"
  },
  {
    "text": "because we had such a short time they had to re architect their their whole sniff point and solve the pseudo random",
    "start": "2912160",
    "end": "2918400"
  },
  {
    "text": "or sorry the pseudo Mac problems so uh netmon is sniffing down",
    "start": "2918400",
    "end": "2923800"
  },
  {
    "text": "here what you get in netmon if you're doing ah the clear text mode the Integrity only mode you netmon can parse",
    "start": "2923800",
    "end": "2931680"
  },
  {
    "text": "that so the parser in netmon and win UK will parse ah traffic so you'll in in",
    "start": "2931680",
    "end": "2936839"
  },
  {
    "text": "fact you when you look at it in netmon you don't even know it's ah it just says TCP UDP SMB RPC whatever it is right you",
    "start": "2936839",
    "end": "2943599"
  },
  {
    "text": "just see it if you drill into the packet detail you'll see the IPC header sitting up there just after the IP header so if",
    "start": "2943599",
    "end": "2949680"
  },
  {
    "text": "it's ah you can see it if it's ESP no encryption only Integrity then you'll",
    "start": "2949680",
    "end": "2956240"
  },
  {
    "text": "see the hex data right because it's not encrypted if it's ESP encrypted data and",
    "start": "2956240",
    "end": "2963559"
  },
  {
    "text": "we're encrypting in software then by the time netmon sees it it's",
    "start": "2963559",
    "end": "2968960"
  },
  {
    "text": "encrypted now the common deployment of IPC is in Hardware offload so we did it",
    "start": "2968960",
    "end": "2974319"
  },
  {
    "text": "there's a whole um ddk conversation that's documented between the Nick",
    "start": "2974319",
    "end": "2979520"
  },
  {
    "text": "driver and the IPC driver and they talk back and forth the ni and the Nick tells",
    "start": "2979520",
    "end": "2984880"
  },
  {
    "text": "the ipx stack this is what I can do in Hardware this is the kind of packets and the algorithms and so forth that I can",
    "start": "2984880",
    "end": "2991040"
  },
  {
    "text": "do in hardware and this is how many okay so when an IPC essay is established by",
    "start": "2991040",
    "end": "2996319"
  },
  {
    "text": "Ike as we've seen before an IPC driver is told about the sa the IPC driver is",
    "start": "2996319",
    "end": "3001520"
  },
  {
    "text": "sort of the master database of all the sa information but for the essay that are offloaded or are done in",
    "start": "3001520",
    "end": "3008280"
  },
  {
    "text": "Hardware um the the mini port or the the Nick driver has the IP set keying",
    "start": "3008280",
    "end": "3015400"
  },
  {
    "text": "information so netmon if it were sniffing here would sniff packets which",
    "start": "3015400",
    "end": "3020760"
  },
  {
    "text": "are framed in the IPC format but are not actually encrypted because the encryption is done at the Nick now that",
    "start": "3020760",
    "end": "3027160"
  },
  {
    "text": "doesn't help you too much because the parser doesn't parse into ESP it assumes ESP is encrypted but that is an",
    "start": "3027160",
    "end": "3033720"
  },
  {
    "text": "improvement we could make in the parser is to try to parse ESP packets the only problem is we wouldn't know whether it's",
    "start": "3033720",
    "end": "3040960"
  },
  {
    "text": "encrypted or whether it's not encrypted so you could get gobbly G um out of it so that's that's the architecture",
    "start": "3040960",
    "end": "3048359"
  },
  {
    "text": "l2tp and PPP right they both appear as PPP dial interfaces so basically it",
    "start": "3048359",
    "end": "3054520"
  },
  {
    "text": "looks like a PPP interface from the UI and other tools but underneath it could be l2tp or it could be",
    "start": "3054520",
    "end": "3062000"
  },
  {
    "text": "pptp all right um we see that TCP uh remember in the TCP IP Advanced",
    "start": "3062200",
    "end": "3069200"
  },
  {
    "text": "properties UI there's some um if you go into advanced and advanced there's a connection filters uh or TCP and UDP",
    "start": "3069200",
    "end": "3077040"
  },
  {
    "text": "protocol type filters and those are implemented like way up here at the top actually in in collaboration with UDP",
    "start": "3077040",
    "end": "3084480"
  },
  {
    "text": "and the protocol stacks um there I don't you can read various",
    "start": "3084480",
    "end": "3089839"
  },
  {
    "text": "articles IPC filtering is um is a lot better so what happens when data comes",
    "start": "3089839",
    "end": "3096400"
  },
  {
    "text": "down for an l2tp tunnel it it does a route lookup right routing is done basically right here the route look up",
    "start": "3096400",
    "end": "3103119"
  },
  {
    "text": "says this is the interface that the packet's going to go out on so the packet comes down to that interface um",
    "start": "3103119",
    "end": "3110680"
  },
  {
    "text": "if it's an ltp or VPN tunnel it's already been set up if it's a demand dial tunnel on a VPN server then and um",
    "start": "3110680",
    "end": "3117640"
  },
  {
    "text": "it'll hit the PPP interface and cause demand all to function okay so we're coming down to we've got an internal",
    "start": "3117640",
    "end": "3124359"
  },
  {
    "text": "packet that's being sent essentially by the application through windsock like like the you know my male client sending",
    "start": "3124359",
    "end": "3130640"
  },
  {
    "text": "data down through the stack it hits PPP PPP uh in the lttp case encapsulated",
    "start": "3130640",
    "end": "3137799"
  },
  {
    "text": "with l2tp fors it back up essentially as a UDP packet and re-inject back down",
    "start": "3137799",
    "end": "3144040"
  },
  {
    "text": "through those other layers and other call outs to uh hit IPC now the reason it's important to",
    "start": "3144040",
    "end": "3151400"
  },
  {
    "text": "understand this point right here is because on a VPN server when you look at the input and output filters on the VPN",
    "start": "3151400",
    "end": "3158440"
  },
  {
    "text": "server uh interface so you can go into the RZ UI go into uh uh routing",
    "start": "3158440",
    "end": "3164240"
  },
  {
    "text": "interfaces do properties on the routing interface and see input and output filters on the interfaces that you have",
    "start": "3164240",
    "end": "3169839"
  },
  {
    "text": "in the system those input and output filters are implemented right here in the IP packet filter driver right NPR is",
    "start": "3169839",
    "end": "3177839"
  },
  {
    "text": "the RZ apis essentially and that filtering is done right here so on a VPN",
    "start": "3177839",
    "end": "3183680"
  },
  {
    "text": "server you will see permit UDP 1701 instead of IPC because because this",
    "start": "3183680",
    "end": "3191200"
  },
  {
    "text": "guy never knows that traffic is IPC protected he sees traffic coming in it looks like UDP 1701 he sees traffic",
    "start": "3191200",
    "end": "3197880"
  },
  {
    "text": "coming out it looks like UDP 1701 okay so his his policy if he's only",
    "start": "3197880",
    "end": "3204720"
  },
  {
    "text": "doing l2tp can be deny all permit UDP",
    "start": "3204720",
    "end": "3209880"
  },
  {
    "text": "1701 all right so ipx sees UDP 1701 it encrypts it and the rest uh we",
    "start": "3209880",
    "end": "3217400"
  },
  {
    "text": "know right it goes out and it'll be offloaded if the network card that",
    "start": "3217400",
    "end": "3222720"
  },
  {
    "text": "you're running on uh supports it which incidentally I found out that both um Intel and 3com have uh have W they're",
    "start": "3222720",
    "end": "3229520"
  },
  {
    "text": "not wireless cards but they are just um 10100 U pcmc card bus cards so you don't",
    "start": "3229520",
    "end": "3236559"
  },
  {
    "text": "have to have a desktop PCI card Nick in order to get Hardware acceleration for VPN um clients as long as you they don't",
    "start": "3236559",
    "end": "3244200"
  },
  {
    "text": "have them on on wireless cards yet but they could it's just a matter of them implementing",
    "start": "3244200",
    "end": "3251200"
  },
  {
    "text": "okay so notice the the the personal firewall when you see that in Whistler when you get beta 2 the personal",
    "start": "3251200",
    "end": "3258079"
  },
  {
    "text": "firewall will see the outbound packet right here has a UDP packet and allow",
    "start": "3258079",
    "end": "3263760"
  },
  {
    "text": "that connection out right the personal firewall not see the IPC traffic because the IPC is done below it and in fact",
    "start": "3263760",
    "end": "3271160"
  },
  {
    "text": "this is this is kind of um you know you can you can combine these filterings in",
    "start": "3271160",
    "end": "3276280"
  },
  {
    "text": "a in a rich way to get exactly the behavior that you want you may not want to combine them um but it's certainly",
    "start": "3276280",
    "end": "3284559"
  },
  {
    "text": "possible okay so here's a kind of a diagram of what was going on the application so we wanted to deploy IPC",
    "start": "3284559",
    "end": "3291960"
  },
  {
    "start": "3285000",
    "end": "3285000"
  },
  {
    "text": "uh fast we wanted to we wanted you to be able to secure your network immediately",
    "start": "3291960",
    "end": "3297040"
  },
  {
    "text": "right as long as you had a Windows 2000 environment and and we realized that it would take time but over time a Windows 2000 environment will be there uh what",
    "start": "3297040",
    "end": "3304200"
  },
  {
    "text": "we didn't want to do is force you or or any other application to be IPC aware that didn't make much sense right you as",
    "start": "3304200",
    "end": "3309920"
  },
  {
    "text": "an administrator can set the security policy to say this communication will be trusted this communication will be uh",
    "start": "3309920",
    "end": "3316920"
  },
  {
    "text": "encrypted so we implemented uh the architecture sort of bump in the stack",
    "start": "3316920",
    "end": "3322079"
  },
  {
    "text": "uh that um Raymond mentioned earlier uh right there in tcpi so the tra all the traffic from TCP IP",
    "start": "3322079",
    "end": "3329079"
  },
  {
    "text": "gets passed to the IPC driver and then the IPC driver if it's going to secure traffic if it permits and blocks it does",
    "start": "3329079",
    "end": "3335720"
  },
  {
    "text": "it a local decision right but if it's got a negotiate security it'll call up to Ike and then it will negotiate these",
    "start": "3335720",
    "end": "3342280"
  },
  {
    "text": "main mode and quick modes that we've gone into detail okay the guy that starts the",
    "start": "3342280",
    "end": "3347520"
  },
  {
    "text": "negotiation is called the IE initiator the guy that responds is called the ike responder this role will reverse",
    "start": "3347520",
    "end": "3354119"
  },
  {
    "text": "throughout the the time throughout time because at any the the RFC says that at",
    "start": "3354119",
    "end": "3359839"
  },
  {
    "text": "any time either side is allowed to Rey so the responder could decide oh in",
    "start": "3359839",
    "end": "3365799"
  },
  {
    "text": "an hour I don't care what lifetime you sent me in an hour I want a Rey so it'll just Rey which is one of the reasons why",
    "start": "3365799",
    "end": "3372480"
  },
  {
    "text": "stateful filtering in firewalls is not easy to manage for for Ike traffic right",
    "start": "3372480",
    "end": "3377559"
  },
  {
    "text": "you can initiate you can you can control who will initiate the very first initiation but then you can't depend",
    "start": "3377559",
    "end": "3384520"
  },
  {
    "text": "upon anything in the ike pack to look at it and say oh this is a connection going",
    "start": "3384520",
    "end": "3389839"
  },
  {
    "text": "from outside in versus inside out okay because I by definition essentially can",
    "start": "3389839",
    "end": "3396119"
  },
  {
    "text": "go both ways at any time except for the very first time somebody's got to send the first",
    "start": "3396119",
    "end": "3401559"
  },
  {
    "text": "packet all right and then we we set up the two IPC essays uh in quick mode once",
    "start": "3401559",
    "end": "3408200"
  },
  {
    "text": "we have synchronized the two and it's not a perfect synchronization because these messages of course can get lost",
    "start": "3408200",
    "end": "3414520"
  },
  {
    "text": "and somebody doesn't the very last message of course can't be act and you don't want to deny service just because",
    "start": "3414520",
    "end": "3420359"
  },
  {
    "text": "you dropped that one last packet right there's no act for it so how does the sender ever know that you got it so it's",
    "start": "3420359",
    "end": "3427039"
  },
  {
    "text": "not a perfect synchronization but it's a best effort synchronization um which even on 100 megabit and uh yeah well 100",
    "start": "3427039",
    "end": "3434839"
  },
  {
    "text": "I'll say 100 megabit networks uh we don't see any problems in terms of the timing of how",
    "start": "3434839",
    "end": "3440319"
  },
  {
    "text": "this happens certainly of the internet that shouldn't be a problem so um the IPC driver then sends out the prote",
    "start": "3440319",
    "end": "3446480"
  },
  {
    "text": "traffic and so we started out with TCP UDP icmp whatever it was we end up with",
    "start": "3446480",
    "end": "3452079"
  },
  {
    "text": "traffic on the wire that is either protocol 50 or 51 plus UDP 500 traffic",
    "start": "3452079",
    "end": "3458039"
  },
  {
    "text": "right to set up the essay and text to explain that okay how",
    "start": "3458039",
    "end": "3464640"
  },
  {
    "start": "3462000",
    "end": "3462000"
  },
  {
    "text": "um Raymond how you guys on demo you guys have demo yet not yet",
    "start": "3464640",
    "end": "3473119"
  },
  {
    "text": "okay yeah yeah so I'll just go ahead and try to finish up here all right so this",
    "start": "3473119",
    "end": "3478680"
  },
  {
    "text": "is a picture of the VPN client when you first create a new VPN client Windows 2000 I've entered in a username and",
    "start": "3478680",
    "end": "3485920"
  },
  {
    "text": "there's some noticeably long password uh with a log on domain",
    "start": "3485920",
    "end": "3491119"
  },
  {
    "text": "possibly um and we've kind of seen this already where on the tab that has the",
    "start": "3491119",
    "end": "3496440"
  },
  {
    "text": "networking tab you can choose pptp or l2tp by default it comes up in automatic",
    "start": "3496440",
    "end": "3503079"
  },
  {
    "text": "mode uh we felt that choosing one or the other was kind of too geeky for most",
    "start": "3503079",
    "end": "3508640"
  },
  {
    "text": "regular users what we do is default to l2tp if you have a certificate so if your machine is able",
    "start": "3508640",
    "end": "3516359"
  },
  {
    "text": "to authenticate itself then we'll try lttp if it's not able to authenticate itself it clearly is no point in trying",
    "start": "3516359",
    "end": "3522720"
  },
  {
    "text": "IPC so we'll just do l2t do pbtp unless we're explicitly configured for l2tp in",
    "start": "3522720",
    "end": "3528799"
  },
  {
    "text": "which case you'll fail I mean you'll get a message back immediately saying you don't have aert okay so the way this works just to",
    "start": "3528799",
    "end": "3536440"
  },
  {
    "start": "3534000",
    "end": "3534000"
  },
  {
    "text": "remind you is the very first thing out of the box for a VPN connection you never see UDP 1701 it's all IPC on The",
    "start": "3536440",
    "end": "3543480"
  },
  {
    "text": "Wire the IPC I negotiation with certificate off and then the IPC sa establishment",
    "start": "3543480",
    "end": "3550039"
  },
  {
    "text": "right for UDP 1701 between the client and the server on their internet addresses okay now notice the VPN server",
    "start": "3550039",
    "end": "3556079"
  },
  {
    "text": "didn't have to go anywhere if it was doing crl checking it could have gone and checked the client crl or the client",
    "start": "3556079",
    "end": "3561119"
  },
  {
    "text": "could have checked the the crl the revocation list for the Gateway Ct in our implement we don't check crls",
    "start": "3561119",
    "end": "3567440"
  },
  {
    "text": "because crls are not widely or easily deployed so they're off by default although you can turn them on with a red",
    "start": "3567440",
    "end": "3574280"
  },
  {
    "text": "key okay so then we start sending the l2tp session establishment and if you",
    "start": "3574280",
    "end": "3580240"
  },
  {
    "text": "know much about the l2tp protocol it's the um session request essentially would be the very first lttp packet that's the",
    "start": "3580240",
    "end": "3587000"
  },
  {
    "text": "very first lttp control packet it goes across the IPC encrypted saay okay this is a big difference from",
    "start": "3587000",
    "end": "3593920"
  },
  {
    "text": "pptp it's a big difference because the the control of pptp tunnels is all in",
    "start": "3593920",
    "end": "3598960"
  },
  {
    "text": "the clear you can see it and in some cases you can modify it you can potentially manipulate it as the",
    "start": "3598960",
    "end": "3604280"
  },
  {
    "text": "gentleman suggested in terms of proposals and encryption methods um I'm not an expert in that particular aspect",
    "start": "3604280",
    "end": "3611039"
  },
  {
    "text": "of the pbtp protocol but I know that in lttp all of the control channel is completely set up and that's what the",
    "start": "3611039",
    "end": "3617039"
  },
  {
    "text": "lttp security draft specifies the whole reason to set up IPC first is everything about LP's operation is protected by IPC",
    "start": "3617039",
    "end": "3626720"
  },
  {
    "text": "okay remember lttp is doing user authentication typical gateways will do a radius client um over to a radius",
    "start": "3626720",
    "end": "3632760"
  },
  {
    "text": "server and authenticate in this case back uh show an active directory running um the radius server we ship internet",
    "start": "3632760",
    "end": "3639240"
  },
  {
    "text": "authentication Service uh which is our radius server um it'll work against other",
    "start": "3639240",
    "end": "3644640"
  },
  {
    "text": "radius servers too of course and other gateways can plug into our radius Server doesn't matter",
    "start": "3644640",
    "end": "3651240"
  },
  {
    "text": "yeah it it's it's actually it's a radius server I I'll say it's sorry it's if the if the",
    "start": "3652400",
    "end": "3659720"
  },
  {
    "text": "VPN server is a member of that domain then it doesn't have to do radius it can just do uh",
    "start": "3659720",
    "end": "3665839"
  },
  {
    "text": "user-based um log on by virtue that it's a member of the domain it could do LSA log on",
    "start": "3665839",
    "end": "3674240"
  },
  {
    "text": "user well what I'm showing is that the communication to the radius server is communication to the radius server our",
    "start": "3677640",
    "end": "3683200"
  },
  {
    "text": "radius server backends to the active directory I I don't remember whether our radius server can back into some other",
    "start": "3683200",
    "end": "3688960"
  },
  {
    "text": "directory I I believe that that's possible because the radius server has a lot of extensibility has a tremendous",
    "start": "3688960",
    "end": "3695000"
  },
  {
    "text": "number of apis and you can hook into every aspect of the radius communication by writing custom code on the radius",
    "start": "3695000",
    "end": "3700960"
  },
  {
    "text": "server um so we actually have the radius server scales extremely well it's one of as I understand you know I don't have",
    "start": "3700960",
    "end": "3707720"
  },
  {
    "text": "any data to back this up but I understand it's one of the best in the industry from the big isps that are using this and certainly we use it um a",
    "start": "3707720",
    "end": "3716160"
  },
  {
    "text": "lot of attributes a lot more attributes than some okay so the point here is that no traffic gets into your network okay",
    "start": "3716160",
    "end": "3722960"
  },
  {
    "text": "until a bunch of things have happened all right your ipcas have have been established that required strong pki",
    "start": "3722960",
    "end": "3729559"
  },
  {
    "text": "trust Mutual trust between the client and the Gateway right the l2tp user was",
    "start": "3729559",
    "end": "3734880"
  },
  {
    "text": "authenticated which again the whole control channel was protected by IPC um",
    "start": "3734880",
    "end": "3740119"
  },
  {
    "text": "you know PPP in this case could use chap or Ms chap in the case that you know the gateways don't support msap V2 because",
    "start": "3740119",
    "end": "3746799"
  },
  {
    "text": "it's all encrypted by IPC so you're not really worried about password guessing um on the IPC packets right l2tp can use",
    "start": "3746799",
    "end": "3754559"
  },
  {
    "text": "EAP to authenticate the user with smart cards or or a token card uh for two Factor off of the user itself and then",
    "start": "3754559",
    "end": "3762240"
  },
  {
    "text": "of course the radius client permits um on the Gateway uh permits you to do just",
    "start": "3762240",
    "end": "3768119"
  },
  {
    "text": "about any uh backend user authentication scheme you want um our radius server has and and",
    "start": "3768119",
    "end": "3774680"
  },
  {
    "text": "our active directory on the user account has the ability to enable or disable remote access on the user account",
    "start": "3774680",
    "end": "3780599"
  },
  {
    "text": "principle in the directory so you can deny a whole class of users from doing uh remote access in fact it's off by",
    "start": "3780599",
    "end": "3786599"
  },
  {
    "text": "default uh for the user account you've got to enable it um the radius server has a whole bunch of policy that can be",
    "start": "3786599",
    "end": "3793520"
  },
  {
    "text": "implemented in the radius server so if in fact this has been done with a Netscape or sorry an NDS directory they",
    "start": "3793520",
    "end": "3799799"
  },
  {
    "text": "back ended it to an NDS directory because what they did is map um a bunch of NDS user accounts into remote access",
    "start": "3799799",
    "end": "3806160"
  },
  {
    "text": "groups the remote access access groups are represented in the radius server and the user is basically identified as a",
    "start": "3806160",
    "end": "3812680"
  },
  {
    "text": "member of that group they have a bunch of static filters they have a bunch of static routes that our radius server supports attributes back to our VPN",
    "start": "3812680",
    "end": "3819680"
  },
  {
    "text": "server or any other VPN server that would support those radius attributes so you so through radius you can deliver uh",
    "start": "3819680",
    "end": "3825760"
  },
  {
    "text": "static routes and static filters back to the VPN gateway to restrict exactly where that user comes can is allowed to",
    "start": "3825760",
    "end": "3832240"
  },
  {
    "text": "uh connect and that enforcement would be on the radio server sorry on the on the VPN server okay so there's there",
    "start": "3832240",
    "end": "3839599"
  },
  {
    "text": "basically what I say user access control policy which can be implemented on the radius server and at a at a crude level",
    "start": "3839599",
    "end": "3845760"
  },
  {
    "text": "deny or permit on the domain controller all right so probably and as",
    "start": "3845760",
    "end": "3851960"
  },
  {
    "text": "far as I can tell you know the strongest if not the the most equivalently strong",
    "start": "3851960",
    "end": "3858440"
  },
  {
    "text": "uh remote access client in the industry the fact that we support EAP for certificate or smart card user",
    "start": "3858440",
    "end": "3864119"
  },
  {
    "text": "authentication on top of all the rest of this makes it as far as I know the strongest right doesn't mean that you'll",
    "start": "3864119",
    "end": "3870279"
  },
  {
    "text": "always use it in the strongest mechanism the downside is this won't go through NP okay which is the deployment issue",
    "start": "3870279",
    "end": "3877240"
  },
  {
    "text": "that we're currently working on with this UDP encapsulation of IPC okay no",
    "start": "3877240",
    "end": "3883359"
  },
  {
    "text": "NP all right if you want to scale this um all kinds of VN servers all over the",
    "start": "3883359",
    "end": "3888559"
  },
  {
    "text": "world like uh Microsoft has and all your client vpnn they go back against a central radio server that gives you all",
    "start": "3888559",
    "end": "3896000"
  },
  {
    "text": "kinds of auditing and um access policy that you want to do for for your",
    "start": "3896000",
    "end": "3902599"
  },
  {
    "text": "users okay that's a dial all right um uh Raymond I think mentioned earlier that",
    "start": "3902599",
    "end": "3909400"
  },
  {
    "text": "uh we don't recommend IPC tunneling IPC tunneling by the RFC doesn't do remote access right doesn't have user authentication doesn't do address",
    "start": "3909400",
    "end": "3915480"
  },
  {
    "text": "assignment so ltp is the way that we recommend to do remote access",
    "start": "3915480",
    "end": "3920839"
  },
  {
    "text": "um however gateway to Gateway tunneling we would still recommend to use l2tp at",
    "start": "3920839",
    "end": "3927039"
  },
  {
    "text": "least with our product uh because you can more easily manage l2tp in the UI",
    "start": "3927039",
    "end": "3932279"
  },
  {
    "text": "the routing remote access snap in uh was built to handle basically demand dial interfaces and in the PPP based VPN",
    "start": "3932279",
    "end": "3938720"
  },
  {
    "text": "interfaces when we added IPC tunnel mode IP tunnel mode doesn't appear as an interface right it's a filter what goes",
    "start": "3938720",
    "end": "3945599"
  },
  {
    "text": "in the tunnel is a filter decision I think you had asked that or one one of you over here so remember the remember",
    "start": "3945599",
    "end": "3951319"
  },
  {
    "text": "the stack picture where traffic came down and hit the IP SEC layer if it needs to go in a t the tunnel happens",
    "start": "3951319",
    "end": "3956640"
  },
  {
    "text": "right there no interface just a filter decision about what goes in the tunnel right there's a route look up which says",
    "start": "3956640",
    "end": "3963039"
  },
  {
    "text": "what interface physical interface to send it out of but there's a filter decision that says where am I going to",
    "start": "3963039",
    "end": "3968359"
  },
  {
    "text": "encapsulate this traffic to so you can have a two interface um uh box essentially and yet you can be",
    "start": "3968359",
    "end": "3976440"
  },
  {
    "text": "tunneling traffic you know to for different subnets all over the internet",
    "start": "3976440",
    "end": "3981599"
  },
  {
    "text": "right we recommend with well fine does that make sense so l2tp is a PPP dial",
    "start": "3981599",
    "end": "3987880"
  },
  {
    "text": "interface it's a routing decision as far as what goes in the tunnel for Gateway to Gateway type of tunnel so you have to",
    "start": "3987880",
    "end": "3993559"
  },
  {
    "text": "manage the routes for IPC tunnel mode it's a filter decision as far as what goes in the tunnel so you have to manage",
    "start": "3993559",
    "end": "3998839"
  },
  {
    "text": "the filters routing is the same it's the external",
    "start": "3998839",
    "end": "4003480"
  },
  {
    "text": "interface okay you can ask me questions all right that's",
    "start": "4004480",
    "end": "4011319"
  },
  {
    "text": "it yeah",
    "start": "4011319",
    "end": "4015319"
  },
  {
    "text": "uhhuh yeah here's uh let me I'll just walk you through this particular picture which is the intro to my next slide so",
    "start": "4023039",
    "end": "4030559"
  },
  {
    "text": "with Windows 2000 and the and the VPN capabilities and the IP set capabilities this is everything we can do we can do",
    "start": "4030559",
    "end": "4036799"
  },
  {
    "text": "remote access right through pbtp or l2tp we can do sight to site Branch to Branch",
    "start": "4036799",
    "end": "4041839"
  },
  {
    "text": "tunnels using a win 2k server um as a gateway and of course it interoperates with everybody else um for internal",
    "start": "4041839",
    "end": "4049720"
  },
  {
    "text": "clients that are members of The Domain you have kerro trust right when you're inside the domain um you have group",
    "start": "4049720",
    "end": "4057000"
  },
  {
    "text": "policy configuration from the Directory Group Policy configuration would tell the client to go get aert for example",
    "start": "4057000",
    "end": "4063760"
  },
  {
    "text": "from a particular CA so that's the way that we that's the easiest way if you have an msca like like it says up there",
    "start": "4063760",
    "end": "4070839"
  },
  {
    "text": "if an msca inside your inside your network you can assign group policy to",
    "start": "4070839",
    "end": "4076680"
  },
  {
    "text": "say go get aert from that CA and as I said for 90 days after",
    "start": "4076680",
    "end": "4082279"
  },
  {
    "text": "Whistler we'll be able to have third parties do this Auto enrollment but we we don't have it",
    "start": "4082279",
    "end": "4087680"
  },
  {
    "text": "yet all of that can be delivered via Group Policy the only thing that's not delivered via Group Policy are the l2tp",
    "start": "4088520",
    "end": "4094680"
  },
  {
    "text": "settings which are basically hard-coded in the lttp",
    "start": "4094680",
    "end": "4099718"
  },
  {
    "text": "client the policy okay okay",
    "start": "4101040",
    "end": "4107318"
  },
  {
    "text": "yep let me okay all right well let me just",
    "start": "4107319",
    "end": "4112719"
  },
  {
    "text": "finish this slide I'll be done all right all right so with auto enroll you",
    "start": "4112719",
    "end": "4117960"
  },
  {
    "text": "can go get machine certificates if you didn't have Auto if you had some other thirdparty pki then um you could do",
    "start": "4117960",
    "end": "4123758"
  },
  {
    "text": "manual enrollment of machine certificates via a browser login or via",
    "start": "4123759",
    "end": "4129520"
  },
  {
    "text": "manual pkcs1 requests okay typically in the Enterprise your web proxy traffic uh",
    "start": "4129520",
    "end": "4135480"
  },
  {
    "text": "would not necessarily be IPC secure but you can finally with Windows 2000 and",
    "start": "4135480",
    "end": "4141040"
  },
  {
    "text": "and IPC as a standard secure every bit of other traffic okay at least unicast",
    "start": "4141040",
    "end": "4146640"
  },
  {
    "text": "traffic not broadcast or multicast um but all unicast traffic in your Enterprise you can secure those servers",
    "start": "4146640",
    "end": "4153920"
  },
  {
    "text": "um all you want right and that other server is intended to be any other uh Unix or other ipet capable",
    "start": "4153920",
    "end": "4160719"
  },
  {
    "text": "system okay for active directory replication a lot of times these sites",
    "start": "4160719",
    "end": "4166920"
  },
  {
    "text": "they may have sight to sight VPN tunnels or they may just have firewalls and be routing this traffic across the internet",
    "start": "4166920",
    "end": "4173480"
  },
  {
    "text": "and the big question is how many ports do I open up for active directory replication the answer is three or two",
    "start": "4173480",
    "end": "4179120"
  },
  {
    "text": "ports plus a protocol that's Ike and IPC okay so I would recommend I mean if",
    "start": "4179120",
    "end": "4185719"
  },
  {
    "text": "you're running if you're running directly replication across the the internet just put IP SEC between the",
    "start": "4185719",
    "end": "4190880"
  },
  {
    "text": "DCS right I mean that's a that's a secure way to do it and the firewall will then have a very Le rule which is",
    "start": "4190880",
    "end": "4196600"
  },
  {
    "text": "to allow only IPC through all right and then finally we",
    "start": "4196600",
    "end": "4203640"
  },
  {
    "text": "couldn't we couldn't just solve the internal security uh problem right inside the",
    "start": "4203640",
    "end": "4208920"
  },
  {
    "text": "network without also being uh having a mechanism for remote access clients to be able to do end to end through their",
    "start": "4208920",
    "end": "4215480"
  },
  {
    "text": "VPN tunnel into the corporate Network because this guy's locked down right he's he's IPC secure he's not going to",
    "start": "4215480",
    "end": "4222280"
  },
  {
    "text": "speak to anybody that doesn't know how to speak IPC so what's the the answer for VPN clients the answer for VPN",
    "start": "4222280",
    "end": "4227400"
  },
  {
    "text": "clients is they have to have a way of you know they first of all they can send IPC end to end through the tunnel um and",
    "start": "4227400",
    "end": "4234360"
  },
  {
    "text": "because this guy had aert most likely or he's a member of the domain right he can",
    "start": "4234360",
    "end": "4239480"
  },
  {
    "text": "do IPC through the tunnel the same way once he's connected to the network via VPN the same way he do IPC to the server",
    "start": "4239480",
    "end": "4246480"
  },
  {
    "text": "if as if he were virtually on the inside of the network so we we we basically have tried",
    "start": "4246480",
    "end": "4252120"
  },
  {
    "text": "to take the full picture of connectivity secure connectivity and solve that solve all these scenarios",
    "start": "4252120",
    "end": "4258480"
  },
  {
    "text": "in in One release which is why it took us three years and we use this internally all the time um I can't say",
    "start": "4258480",
    "end": "4264920"
  },
  {
    "text": "that that it's widely deployed internally because it takes it takes time to understand the policy and to",
    "start": "4264920",
    "end": "4270320"
  },
  {
    "text": "secure these servers and migrate the applications to Windows 2000 and stuff like that but it's",
    "start": "4270320",
    "end": "4276120"
  },
  {
    "text": "possible yeah okay let's break",
    "start": "4276120",
    "end": "4281400"
  },
  {
    "text": "yeah",
    "start": "4314239",
    "end": "4317239"
  },
  {
    "text": "e",
    "start": "4344159",
    "end": "4347159"
  },
  {
    "text": "e",
    "start": "4374120",
    "end": "4377120"
  },
  {
    "text": "e",
    "start": "4404120",
    "end": "4407120"
  },
  {
    "text": "e",
    "start": "4434040",
    "end": "4437040"
  },
  {
    "text": "e",
    "start": "4464040",
    "end": "4467040"
  },
  {
    "text": "e",
    "start": "4494000",
    "end": "4497000"
  },
  {
    "text": "e",
    "start": "4523960",
    "end": "4526960"
  },
  {
    "text": "e",
    "start": "4553920",
    "end": "4556920"
  },
  {
    "text": "e e",
    "start": "4583920",
    "end": "4587920"
  }
]