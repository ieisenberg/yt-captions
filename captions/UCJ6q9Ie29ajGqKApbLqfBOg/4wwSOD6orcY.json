[
  {
    "start": "0",
    "end": "64000"
  },
  {
    "text": "first off thank you guys for sticking around to one of the last sessions here at blackhat I was half way concerned",
    "start": "0",
    "end": "5430"
  },
  {
    "text": "there'd be like three of us here and maybe we would just kind of sit around a table and chat so thank you for not",
    "start": "5430",
    "end": "10889"
  },
  {
    "text": "booking those flights early as he said and that's the title success SiC",
    "start": "10889",
    "end": "16490"
  },
  {
    "text": "suggests we are gonna be popping some shells today particularly in CNC tool",
    "start": "16490",
    "end": "23910"
  },
  {
    "text": "kits that are very very popular before we get there though I do want to kind of",
    "start": "23910",
    "end": "29640"
  },
  {
    "text": "talk about a little bit of background a little bit of issues surrounding this so hang with me we'll get through the boring stuff and then we'll get to the",
    "start": "29640",
    "end": "35489"
  },
  {
    "text": "fun stuff at the end quick background on myself I go by the handle alias",
    "start": "35489",
    "end": "41309"
  },
  {
    "text": "professor plum I've been in this security community for over 10 years now I currently work with Symantec as a",
    "start": "41309",
    "end": "47640"
  },
  {
    "text": "threat researcher before that I worked for the Department of fence during CNO and before that I've had my time in the",
    "start": "47640",
    "end": "54090"
  },
  {
    "text": "trenches as an IT manager so I know what it's like to fight those fights I feel like I have a good roundabout",
    "start": "54090",
    "end": "60300"
  },
  {
    "text": "understanding of this from multiple perspectives and with my background being discussed that shouldn't come as a",
    "start": "60300",
    "end": "67890"
  },
  {
    "start": "64000",
    "end": "64000"
  },
  {
    "text": "surprise that I need to make some clear disclaimers first off I do not represent adhere do not necessarily represent",
    "start": "67890",
    "end": "74909"
  },
  {
    "text": "those of my current or former employers I had to make sure I state that second",
    "start": "74909",
    "end": "80850"
  },
  {
    "text": "is that what I'm gonna discuss here is probably illegal from where almost",
    "start": "80850",
    "end": "85939"
  },
  {
    "text": "worldwide some places maybe not I couldn't speak for everywhere but don't hold me accountable if you decide to use",
    "start": "85939",
    "end": "92430"
  },
  {
    "text": "some of this knowledge to do something that you probably shouldn't I might want to hear about it but don't hold me",
    "start": "92430",
    "end": "97650"
  },
  {
    "text": "accountable for anything that's done with this data okay that out of the way",
    "start": "97650",
    "end": "102899"
  },
  {
    "text": "kind of wanted to talk about what really drove me into this field and what would",
    "start": "102899",
    "end": "108000"
  },
  {
    "start": "103000",
    "end": "103000"
  },
  {
    "text": "started this talk and that is I really really despise the defeatist attitude in",
    "start": "108000",
    "end": "113549"
  },
  {
    "text": "the security community the attitude that there's nothing we could do to block ourselves against the sky right I hear",
    "start": "113549",
    "end": "120990"
  },
  {
    "text": "that the sophisticated actor term thrown out there a little bit and I it's used as like an excuse oh they were",
    "start": "120990",
    "end": "128340"
  },
  {
    "text": "sophisticated we couldn't block him oh it was sophisticated they they got past us and it just makes me wonder a little bit",
    "start": "128340",
    "end": "135350"
  },
  {
    "text": "like how does that conversation go with the sea levels when you have to explain you've been hacked it's like sir we've",
    "start": "135350",
    "end": "141860"
  },
  {
    "text": "we've been compromised what how how how'd that happen oh the actor was sophisticated there was nothing we could",
    "start": "141860",
    "end": "148040"
  },
  {
    "text": "do what do you mean sophisticated well we believe he was wearing a monocle so he's",
    "start": "148040",
    "end": "153560"
  },
  {
    "text": "clearly clearly sophisticated it doesn't to me the sophisticated miss is not an",
    "start": "153560",
    "end": "160430"
  },
  {
    "text": "excuse in any sort of way and so that's really what drove this talk I decided to look at the tools used by these",
    "start": "160430",
    "end": "166430"
  },
  {
    "text": "sophisticated actors and show that these attackers are not impenetrable that",
    "start": "166430",
    "end": "172970"
  },
  {
    "text": "they're not above the law and really that they play in the same playing field we do and they make mistakes so",
    "start": "172970",
    "end": "180370"
  },
  {
    "start": "179000",
    "end": "179000"
  },
  {
    "text": "basically we're going to talk about hacking back and this has been a very hot topic for a number of years five",
    "start": "180370",
    "end": "186350"
  },
  {
    "text": "years ago at this conference there was a anonymous survey done where they asked",
    "start": "186350",
    "end": "191810"
  },
  {
    "text": "attendees if they hadn't participated in hacking back and over one third of the attendee servants the little surveyed",
    "start": "191810",
    "end": "199100"
  },
  {
    "text": "excuse me said they had so what happens it goes on right a lot of the people",
    "start": "199100",
    "end": "205489"
  },
  {
    "text": "feel they need to strike back in some sort of form but first option would be",
    "start": "205489",
    "end": "211040"
  },
  {
    "text": "to sue somebody but there's nobody to sue so Leo law enforcement is often left weaponless or can't do anything or or",
    "start": "211040",
    "end": "218239"
  },
  {
    "text": "spread too thin and a lot of times these corporations take matters into their own hands add to this a recent bill proposed",
    "start": "218239",
    "end": "226519"
  },
  {
    "text": "or not proposed yet but drafted by Senator Tom graves that is called the",
    "start": "226519",
    "end": "232370"
  },
  {
    "text": "app active cyber defense certainty actor or ac/dc act this bill would leave",
    "start": "232370",
    "end": "238640"
  },
  {
    "text": "victims exempt from the law to hack back against their assailants if this was to",
    "start": "238640",
    "end": "243950"
  },
  {
    "text": "be passed now at first thought that that bill that generally this is considered a",
    "start": "243950",
    "end": "249980"
  },
  {
    "text": "bad idea it's a lose-lose situation right you can't hack back and get your",
    "start": "249980",
    "end": "255590"
  },
  {
    "text": "documents back any media star or any Hollywood star who's have their photos",
    "start": "255590",
    "end": "262010"
  },
  {
    "text": "leaked online knows you just can't get files back once they've left your parameter and we should know that too furthermore",
    "start": "262010",
    "end": "269850"
  },
  {
    "text": "if you do hack back there's very little for the corporation to gain right you're",
    "start": "269850",
    "end": "275070"
  },
  {
    "text": "spending your precious resources that you could be using to rebuild or to block your things to instead go attack",
    "start": "275070",
    "end": "281310"
  },
  {
    "text": "somebody to just prove a point to get your revenge to make yourself feel better in some sort of way maybe none of",
    "start": "281310",
    "end": "288360"
  },
  {
    "text": "that really provides much in the terms of the corporation not to mention the",
    "start": "288360",
    "end": "293700"
  },
  {
    "text": "risk you're taking on attacking a server that you're not exactly sure where is or who controls and what's to say that they",
    "start": "293700",
    "end": "299910"
  },
  {
    "text": "don't decide to attack back since you're attacking them back and where does it end what if a third party gets involved",
    "start": "299910",
    "end": "305820"
  },
  {
    "text": "and they decide to hack back it can lead to a very very messy situation and generally I would recommend it's",
    "start": "305820",
    "end": "311310"
  },
  {
    "text": "probably not the best use of this but there are some areas where I think think",
    "start": "311310",
    "end": "316530"
  },
  {
    "text": "that this kind of technology or this technique may be useful and that's more around attribution and tracking if one",
    "start": "316530",
    "end": "324330"
  },
  {
    "text": "is to hack back into another group and then does just sit quietly and listen they can observe many things about their",
    "start": "324330",
    "end": "329730"
  },
  {
    "text": "assailant they can observe maybe who else they're targeting maybe what files they're interested in what did they pull",
    "start": "329730",
    "end": "335070"
  },
  {
    "text": "from you or how they work and all of that kind of information I as a security",
    "start": "335070",
    "end": "340320"
  },
  {
    "text": "researcher would love to have because it helps do attribution a whole lot better than just looking at the artifacts that",
    "start": "340320",
    "end": "346080"
  },
  {
    "text": "they leave on discs by obsidian I'm deserving the attacker that's that's a one information when it comes to",
    "start": "346080",
    "end": "352050"
  },
  {
    "text": "attribution and to be honest and to be fair the ac/dc act that's actually what",
    "start": "352050",
    "end": "357330"
  },
  {
    "text": "it tries to do in fact the ac/dc Act does not allow hacking back for the",
    "start": "357330",
    "end": "362490"
  },
  {
    "text": "purpose of causing destruction damage or physical industry or physical injury but",
    "start": "362490",
    "end": "368640"
  },
  {
    "text": "instead it allows hacking back for the establishment of attribution of the",
    "start": "368640",
    "end": "374550"
  },
  {
    "text": "criminal activity and to monitor the behavior of the attacker so to be fair that the Act does sound like they're",
    "start": "374550",
    "end": "381210"
  },
  {
    "text": "trying to do the right thing right it's still opening the can of worms but I think it gets more than a bad rap than",
    "start": "381210",
    "end": "387690"
  },
  {
    "text": "it should probably now I know you didn't hear me come here to hear me ramble on",
    "start": "387690",
    "end": "392820"
  },
  {
    "text": "about my emotions or feelings about the issue so I'm gonna cut the rant short here I'd love to have",
    "start": "392820",
    "end": "398670"
  },
  {
    "text": "this conversation over a drink with somebody after the fact but let's get on move on with things",
    "start": "398670",
    "end": "405690"
  },
  {
    "text": "gotta kind of do some of the groundwork terminology here unfortunately even c2",
    "start": "405690",
    "end": "412260"
  },
  {
    "start": "407000",
    "end": "407000"
  },
  {
    "text": "communication terminology is kind of confusing I've heard that royal server and client used interchangeably for the",
    "start": "412260",
    "end": "418470"
  },
  {
    "text": "different pieces so I'm gonna outline here the terminology I'm gonna use for this the client piece is the malware",
    "start": "418470",
    "end": "425880"
  },
  {
    "text": "piece that runs on the machine and the server is the c2 server all right that's how I'm gonna use those terms I'm gonna",
    "start": "425880",
    "end": "431520"
  },
  {
    "text": "try to avoid using attacker and victim because in our scenarios the attacker becomes the victim and that will cause",
    "start": "431520",
    "end": "437310"
  },
  {
    "text": "confusion as well so the original victim I will try to call the target the",
    "start": "437310",
    "end": "442850"
  },
  {
    "text": "original c2 owner I will call the adversary and then the one who was hacking back I would call the retaliate",
    "start": "442850",
    "end": "448860"
  },
  {
    "text": "er I like that term the dictionary definition if definition of it is one who returns assaulting kind so I felt",
    "start": "448860",
    "end": "456150"
  },
  {
    "text": "that was very appropriate for this role this set up here and how I went about my",
    "start": "456150",
    "end": "461550"
  },
  {
    "text": "procedure for doing this a colleague of mine had taken all of the apt reports",
    "start": "461550",
    "end": "467100"
  },
  {
    "start": "463000",
    "end": "463000"
  },
  {
    "text": "that have been released over the last few years and kind of summarized in a popularity hit of what malware trolls",
    "start": "467100",
    "end": "473250"
  },
  {
    "text": "were most commonly cited in these reports and I thought this would make a great shopping list I'll just start at",
    "start": "473250",
    "end": "479820"
  },
  {
    "text": "the top of the list get a hold of the tool and see what vulnerabilities I can find in it and so as you see at the top",
    "start": "479820",
    "end": "486420"
  },
  {
    "text": "of this list is poison ivy and some of you may be aware that poison ivy has",
    "start": "486420",
    "end": "493230"
  },
  {
    "text": "already been exploited it's not something I was going to hit it actually was exploited by these individuals at",
    "start": "493230",
    "end": "498450"
  },
  {
    "text": "the bottom I will not try to say their names because I would horribly do I wouldn't do it justice and I just sound like a fool but these guys found a",
    "start": "498450",
    "end": "505280"
  },
  {
    "text": "buffer overflow which allowed remote code execution in the poison ivy c2",
    "start": "505280",
    "end": "510480"
  },
  {
    "text": "server even more interesting is that after now after whoops yes",
    "start": "510480",
    "end": "520890"
  },
  {
    "start": "520000",
    "end": "520000"
  },
  {
    "text": "after mandiant released their apt one report the the group the guys at malware",
    "start": "520890",
    "end": "526410"
  },
  {
    "text": "L you notice that in that report it mentioned that the ABT one group you",
    "start": "526410",
    "end": "531430"
  },
  {
    "text": "poison ivy so the apt so the malware Lu guys exploited the poison ivy servers",
    "start": "531430",
    "end": "537160"
  },
  {
    "text": "landed on them and then just listened and observed and enumerated the attackers Network",
    "start": "537160",
    "end": "543100"
  },
  {
    "text": "they then documented all this and provided it publicly it's one of the rare cases where we have this kind of information from a hack back attempt and",
    "start": "543100",
    "end": "549970"
  },
  {
    "text": "the information is golden they outline they were able to outline their",
    "start": "549970",
    "end": "555040"
  },
  {
    "text": "infrastructure that's an image stolen from their document describing how they have their attacker infrastructure built they outlined they found additional",
    "start": "555040",
    "end": "562390"
  },
  {
    "text": "tools used by this group and exposed them and they were able to give TTP's of how this group acts so defenders could",
    "start": "562390",
    "end": "568029"
  },
  {
    "text": "know better what to watch for and what to look for it was very insightful and I think it shows just the potential behind",
    "start": "568029",
    "end": "573520"
  },
  {
    "text": "this kind of attacking back also on that list that already was exploited was dark",
    "start": "573520",
    "end": "579610"
  },
  {
    "text": "comment it was down there are ways but I still felt it's worth mentioning dark comment was exploited by these guys and",
    "start": "579610",
    "end": "585490"
  },
  {
    "text": "their exploit was remote file retrieval so you could blindly copy a file off that server but I have no evidence or I",
    "start": "585490",
    "end": "593350"
  },
  {
    "text": "have no documentation of where it's been used shoot I'm rolling but that's okay I",
    "start": "593350",
    "end": "599830"
  },
  {
    "text": "can just spend more time on the exploits let's play with the new stuff now I'm gonna work my way from least interesting",
    "start": "599830",
    "end": "606940"
  },
  {
    "text": "up bottom up on that list I just took the top three euro blow poison ivy and so the third one I looked at the least",
    "start": "606940",
    "end": "613839"
  },
  {
    "text": "interesting in my opinion was extreme rat extreme rat has been around for a",
    "start": "613839",
    "end": "619150"
  },
  {
    "text": "little while it was originally developed as a commercial tool this is a screenshot of the tool itself I have one",
    "start": "619150",
    "end": "625240"
  },
  {
    "text": "victim and I right clicked on the victim and you can see there that drop down the capabilities the tool offers the",
    "start": "625240",
    "end": "630880"
  },
  {
    "text": "attacker to do against their victim they can spawn shells drop grab files you know pings you just drop a keylogger",
    "start": "630880",
    "end": "637930"
  },
  {
    "text": "there's a lot of a lot of capabilities built in this tool the tool also has additional capabilities that they kind",
    "start": "637930",
    "end": "644410"
  },
  {
    "text": "of make me laugh it's got a game built in it that you can kind of play I guess while you're waiting for your malware to",
    "start": "644410",
    "end": "650470"
  },
  {
    "text": "land or your guys to click on the email it was it looks to me to be a targeting",
    "start": "650470",
    "end": "656620"
  },
  {
    "text": "to the script kitty there's a lot of very easy point-and-click type features here that being said",
    "start": "656620",
    "end": "663130"
  },
  {
    "text": "it has also still been used by a lot of suppose admission state actor groups these are a number of news articles",
    "start": "663130",
    "end": "669260"
  },
  {
    "text": "where extreme rat was cited as the tool of choice for the particular actor it's",
    "start": "669260",
    "end": "674360"
  },
  {
    "text": "been seen in target and attacks against the Israeli government against the conflicts in Syria and the Gaza Strip",
    "start": "674360",
    "end": "682480"
  },
  {
    "text": "extreme rat is most easily identifiable in my mind based on its a c2",
    "start": "682480",
    "end": "687890"
  },
  {
    "start": "685000",
    "end": "685000"
  },
  {
    "text": "communication protocol typically there's a number of ways that can talk home and communicate home but typically we see it",
    "start": "687890",
    "end": "694640"
  },
  {
    "text": "used either TCP raw TCP or a pseudo a fake HTTP request the TCP connection the",
    "start": "694640",
    "end": "702530"
  },
  {
    "text": "Vic target component always responds home with a packet that says my version pipe and then a number which is the",
    "start": "702530",
    "end": "709130"
  },
  {
    "text": "number of the extreme rat usually 3.6 or 3.7 or so then the server responds with",
    "start": "709130",
    "end": "715070"
  },
  {
    "text": "the X character followed by a line feed carriage return that's very easy to signature there's already snort",
    "start": "715070",
    "end": "721940"
  },
  {
    "text": "signatures and such out there for it but it's easy to identify this if you see this traffic pattern it's extreme rat I'll turn the deadly it can try to mask",
    "start": "721940",
    "end": "729350"
  },
  {
    "text": "its initial call home by making a HTTP request but that HTTP request is also",
    "start": "729350",
    "end": "734630"
  },
  {
    "text": "easy to signature it always takes the form of a get request for some number dot functions and that some number is a",
    "start": "734630",
    "end": "742280"
  },
  {
    "text": "password put in by the attacker and that password is limited to all numbers and",
    "start": "742280",
    "end": "747710"
  },
  {
    "text": "it can only be 10 characters long so it's easy enough to make a regex pattern to look for a series of numbers",
    "start": "747710",
    "end": "752930"
  },
  {
    "text": "dot functions if you see that URL request that's a extreme rat trying to beacon home and once it makes that HTTP",
    "start": "752930",
    "end": "760850"
  },
  {
    "text": "request it just turns into a raw socket doesn't actually make an official HTTP it doesn't follow the protocol at all so",
    "start": "760850",
    "end": "767360"
  },
  {
    "text": "I started with look looking into this guy for exploits looking for vulnerabilities and I just kind of",
    "start": "767360",
    "end": "772430"
  },
  {
    "text": "observed how it did its communications and one of the things that quickly stood out to me was well I'll show you so when",
    "start": "772430",
    "end": "782360"
  },
  {
    "start": "776000",
    "end": "776000"
  },
  {
    "text": "the c2 server wants to deliver a piece of an additional tool to its victim then",
    "start": "782360",
    "end": "788660"
  },
  {
    "text": "it'll send a message to the target component and it says hey get ready to receive this file that I have is called",
    "start": "788660",
    "end": "794720"
  },
  {
    "text": "tooled up bad and I want you to save it to C Drive you know tamp whatever wherever he wants to try",
    "start": "794720",
    "end": "800190"
  },
  {
    "text": "to hide the file then the victim in this case the the target will respond and say",
    "start": "800190",
    "end": "805950"
  },
  {
    "text": "okay I'm ready to receive your file named tool slash VAD exe and then the",
    "start": "805950",
    "end": "812400"
  },
  {
    "text": "extreme rat situ server will respond with the actual data for that now when I find interesting in this exchange here",
    "start": "812400",
    "end": "819270"
  },
  {
    "text": "is that the c2 server tells the target computer the local path to the file that",
    "start": "819270",
    "end": "825210"
  },
  {
    "text": "it has it doesn't need to tell the victim where it's storing the file locally but it does for some reason and",
    "start": "825210",
    "end": "830550"
  },
  {
    "text": "it made me think why would it do that well maybe it does that because it doesn't want to have to keep any state",
    "start": "830550",
    "end": "835680"
  },
  {
    "text": "it doesn't have to remember the fact that I sent a request to that guy and when he responds ready that I have to go",
    "start": "835680",
    "end": "841200"
  },
  {
    "text": "look up what the file name is he already tells me the file name he reminds me of the file name and so because of that I",
    "start": "841200",
    "end": "846690"
  },
  {
    "text": "thought well if he's not keeping any state then he won't notice if the top packet never happens right if I just",
    "start": "846690",
    "end": "853640"
  },
  {
    "text": "solicit the fact that I'm ready to receive your file tool that bad sure enough the extreme rat server will",
    "start": "853640",
    "end": "860550"
  },
  {
    "text": "respond by giving me the contents of file tool not bad so I can blindly retrieve any file from that c2 server if",
    "start": "860550",
    "end": "868350"
  },
  {
    "text": "I know what if I know it exists you know I can kind of brute force this I could try every file but that's that sounds extreme so just maybe a few ideas",
    "start": "868350",
    "end": "875820"
  },
  {
    "start": "875000",
    "end": "875000"
  },
  {
    "text": "of things you would want to pull and these are all taken from the URL at the bottom here maybe you'd want to pull",
    "start": "875820",
    "end": "881970"
  },
  {
    "text": "wind ini it's just kind of a sanity check that file should exist on all Windows versions if you pull that back",
    "start": "881970",
    "end": "887130"
  },
  {
    "text": "then we have a good ok we're working as we expect you might be able to glean the type of Windows that the target is",
    "start": "887130",
    "end": "893520"
  },
  {
    "text": "running beyond that fight via that file and if you know that then you know where the event logs are stored so we can",
    "start": "893520",
    "end": "899370"
  },
  {
    "text": "maybe pull back the event logs from the host:it event logs can sometimes have some great information you might be able",
    "start": "899370",
    "end": "905250"
  },
  {
    "text": "to determine the user user ID of the computer or the user running on the",
    "start": "905250",
    "end": "910410"
  },
  {
    "text": "computer and if you know the user ID then you can look in their home directory for the desktop dot ini file",
    "start": "910410",
    "end": "915660"
  },
  {
    "text": "because the desktop that I and I file may reveal the names of folders on that user's desktop and if we know the name",
    "start": "915660",
    "end": "921960"
  },
  {
    "text": "of folders none that users desktop we may have an idea of what kind of things we want to grab or alternatively if",
    "start": "921960",
    "end": "926970"
  },
  {
    "text": "they're running this admin we can always grab the the Sam database and then it's cracked their passwords we find out the users",
    "start": "926970",
    "end": "933160"
  },
  {
    "text": "and maybe we can try to log into the Mocs directly or just grab a backup at the registry there's plenty of great",
    "start": "933160",
    "end": "939550"
  },
  {
    "text": "information in there including file paths to particular items that we may want to then download ourselves so",
    "start": "939550",
    "end": "946570"
  },
  {
    "text": "that's that was it for extreme rap really wasn't the most exciting exploit I found but it was something and really I just looked at it just to see if I",
    "start": "946570",
    "end": "952540"
  },
  {
    "text": "could find something it didn't take me more than a day to discover this it wasn't like it's difficult and that was",
    "start": "952540",
    "end": "957670"
  },
  {
    "text": "this I forgot to mention this other but that's really kind of the point of this talk is that I don't I don't mean to",
    "start": "957670",
    "end": "963460"
  },
  {
    "text": "think that these the exploits I'm gonna show here are amazing or anything I think I mean I think they're kind of fun but the point is that these tools have",
    "start": "963460",
    "end": "969700"
  },
  {
    "text": "these underlying problems all like all of them is very rich in this fact if you're a vulnerability researcher this",
    "start": "969700",
    "end": "976300"
  },
  {
    "text": "field is ripe for the picking simply just need to get a hold of the c2 servers anyways let's give them more some fun",
    "start": "976300",
    "end": "982780"
  },
  {
    "text": "ones plug X core plug or des store is more common rather than as Linux that",
    "start": "982780",
    "end": "990430"
  },
  {
    "text": "has been described in numerous nation-state or sophisticated actor attacks here is a screenshot of the tool",
    "start": "990430",
    "end": "998170"
  },
  {
    "text": "and the the second pocket pop-up window shows you the options you can do to your target some of them around there that",
    "start": "998170",
    "end": "1005700"
  },
  {
    "text": "are notably interesting to me are one you can edit the registry on the target you can start capturing packets you can",
    "start": "1005700",
    "end": "1012660"
  },
  {
    "text": "connect to a different telnet server through your target and it also contains functions for even talking to SQL",
    "start": "1012660",
    "end": "1019860"
  },
  {
    "text": "servers like I said like I mentioned it has been indicated and the numerous",
    "start": "1019860",
    "end": "1026730"
  },
  {
    "text": "attacks Office of Personnel Management was one of the attacks in which they found the plug X variant of the malware",
    "start": "1026730",
    "end": "1033300"
  },
  {
    "text": "in use and it's been around for quite some time at least 2008 so that's almost",
    "start": "1033300",
    "end": "1040199"
  },
  {
    "text": "10 year run a ten year reign and it's been used even even up to this day I",
    "start": "1040199",
    "end": "1045540"
  },
  {
    "text": "think there's an article there oops they did it again from February of this year or again plug X was found the black had",
    "start": "1045540",
    "end": "1053460"
  },
  {
    "text": "aged to talk I know you want to unplug me was very useful for my talk but they did a lot of research into the tool and the different variants and provided some",
    "start": "1053460",
    "end": "1060030"
  },
  {
    "text": "great info for me so I didn't have to do a lot additional re and so I was able to I'll",
    "start": "1060030",
    "end": "1065590"
  },
  {
    "text": "get there in a second I am I didn't have source code for this one I didn't and so",
    "start": "1065590",
    "end": "1071170"
  },
  {
    "text": "I just started to do a little bit of fuzz run to to see what exploits I could find her vulnerability so I can find excuse me but my fuzz Brun was kind of",
    "start": "1071170",
    "end": "1079090"
  },
  {
    "text": "overwhelming to tell the truth the the coding in this is so horrible in my mind",
    "start": "1079090",
    "end": "1085360"
  },
  {
    "text": "and deplorable in my mind it would cause so many exceptions to be flagged when I",
    "start": "1085360",
    "end": "1091030"
  },
  {
    "text": "run my husband that I really didn't get an edge up as where to start I had so many exceptions being thrown and they",
    "start": "1091030",
    "end": "1097210"
  },
  {
    "text": "were all the exceptions that could show potential to be exploitable that I'll say okay well which one do I start with",
    "start": "1097210",
    "end": "1103200"
  },
  {
    "text": "and in the end I just kind of started with one something that looked interesting to me when I when I just",
    "start": "1103200",
    "end": "1108250"
  },
  {
    "text": "started when I started I was trying to make my fuzzer very unique to the protocol and I noticed something interesting in the protocol and I made a",
    "start": "1108250",
    "end": "1114430"
  },
  {
    "text": "note on the side saying yeah I might want to come back to this and in the end that's where I started because the fuzz run results were overwhelming and where",
    "start": "1114430",
    "end": "1121690"
  },
  {
    "text": "that was was in the set of code that has to deal with decoding a packet as",
    "start": "1121690",
    "end": "1127950"
  },
  {
    "text": "plugins calls it or a message more as we should think of it this is my obligate",
    "start": "1127950",
    "end": "1134530"
  },
  {
    "text": "Ida Pro screenshot and this this function here is the handling of a",
    "start": "1134530",
    "end": "1140710"
  },
  {
    "text": "message as received from a victim or a target and what it does every message has a header that's XOR encoded with",
    "start": "1140710",
    "end": "1147850"
  },
  {
    "text": "some made-up x or rolling X or key that's I don't know they must have made",
    "start": "1147850",
    "end": "1153640"
  },
  {
    "text": "up their I've never seen it used anywhere else they just kind of made their own thing up but anyways once that xor key is decoded",
    "start": "1153640",
    "end": "1159070"
  },
  {
    "text": "then it validates that the message size is small enough to fit it on the stack and that 61k it must fit on the stack",
    "start": "1159070",
    "end": "1168070"
  },
  {
    "text": "and if it's not large enough if it's not smaller to fit on the stack then it shows this error message that's very",
    "start": "1168070",
    "end": "1173290"
  },
  {
    "text": "descriptive about what the problem is however this code to decode the header",
    "start": "1173290",
    "end": "1179920"
  },
  {
    "text": "and make sure it fits on the stack comes down here in this decode packet function which is after the packet is kept copied",
    "start": "1179920",
    "end": "1187750"
  },
  {
    "text": "onto the stack so it does you very little good to check if your message fits on the stack after you've copied",
    "start": "1187750",
    "end": "1194260"
  },
  {
    "text": "your mess onto the static in this case it does provide a little of a hindrance to me",
    "start": "1194260",
    "end": "1200790"
  },
  {
    "text": "but I thought it was thought it was really a fun bug so I decided to use it",
    "start": "1200790",
    "end": "1206040"
  },
  {
    "text": "in this presentation so here we can throw it a message that's bigger than the the stack buffer and then we think",
    "start": "1206040",
    "end": "1213090"
  },
  {
    "text": "we would gain execution as soon as this function returns but the function is not going to return until it checks the",
    "start": "1213090",
    "end": "1218670"
  },
  {
    "text": "stack size so thus the attacker when we exploit this is going to see this pop up",
    "start": "1218670",
    "end": "1223860"
  },
  {
    "text": "message on their machine that very clearly to them describes the problem that they're about to face right this",
    "start": "1223860",
    "end": "1230160"
  },
  {
    "text": "error message PE decode packet clearly lets them know you've just been exploited and",
    "start": "1230160",
    "end": "1236460"
  },
  {
    "text": "somebody's going to greenshell on your box furthermore this error message isn't just unique to this code path if you",
    "start": "1236460",
    "end": "1243090"
  },
  {
    "text": "just end map scanned some of the plug X variants they show this exact message it's kind of like I assume it's kind of",
    "start": "1243090",
    "end": "1249240"
  },
  {
    "text": "like the default I don't know what went wrong here message and so this guy pops up on the attackers machine and it",
    "start": "1249240",
    "end": "1256020"
  },
  {
    "text": "doesn't matter how they acknowledge it if they click the X or they click ok as soon as this message box is acknowledged",
    "start": "1256020",
    "end": "1261750"
  },
  {
    "text": "then code flow falls into our hands so I have here a demo video of this on",
    "start": "1261750",
    "end": "1273200"
  },
  {
    "text": "the right spot on the right hand side of the screen I'm",
    "start": "1273200",
    "end": "1279870"
  },
  {
    "text": "representing the adversaries machine and on the left hand side of the scene I screen I am representing the retaliate",
    "start": "1279870",
    "end": "1287550"
  },
  {
    "text": "err so I'm gonna start up the plug X rat variant here and it's running and on the",
    "start": "1287550",
    "end": "1295230"
  },
  {
    "text": "other side I have a Metasploit module for this I'm starting up that Metasploit module to exploit this plug X bug I",
    "start": "1295230",
    "end": "1302810"
  },
  {
    "text": "think all right I'm gonna set the target address which I've already I know right",
    "start": "1302810",
    "end": "1310020"
  },
  {
    "text": "it's just my VM in this case and then I'm going to show some info here I want",
    "start": "1310020",
    "end": "1315420"
  },
  {
    "text": "to pause this right there so here in my module that",
    "start": "1315420",
    "end": "1320950"
  },
  {
    "text": "you see here at the top it says type from that Asia from a talk I know you",
    "start": "1320950",
    "end": "1327220"
  },
  {
    "text": "want to unplug me from blackhat Asia they describe plug experience there's like three main types as they put it and",
    "start": "1327220",
    "end": "1332440"
  },
  {
    "text": "they kind of broke them up based on their XOR decoding function we have to",
    "start": "1332440",
    "end": "1337870"
  },
  {
    "text": "be able to make a packet that decodes right so there's basically I need you need to know what variant your target is the good site is is you can just try it",
    "start": "1337870",
    "end": "1345340"
  },
  {
    "text": "with a message and if it doesn't work then you can try another one and just so basically you can just try all three and",
    "start": "1345340",
    "end": "1350560"
  },
  {
    "text": "until you find the one that works and that's what I'll do in this do next is I'll run a check command and sure enough",
    "start": "1350560",
    "end": "1357970"
  },
  {
    "text": "that one says yeah you the type you've selected is right the message that looks wonderful and so we'll throw our exploit you see",
    "start": "1357970",
    "end": "1364600"
  },
  {
    "text": "here the pop up message as soon as the attacker acknowledges that some way we are spawning the meterpreter session",
    "start": "1364600",
    "end": "1370570"
  },
  {
    "text": "there on the left comes up and i'm gonna run a sin foe you get a little info on my target spawn a shell and will pop up",
    "start": "1370570",
    "end": "1378400"
  },
  {
    "text": "a notepad just as proof and boom execution on the c2 server all right",
    "start": "1378400",
    "end": "1387370"
  },
  {
    "start": "1386000",
    "end": "1386000"
  },
  {
    "text": "next up last one on my list let's go strat I saved this one for last because this one I've seen everywhere",
    "start": "1387370",
    "end": "1395080"
  },
  {
    "text": "I think Mini incident responders know this guy by heart ghost rats been around for ten years it was originally written",
    "start": "1395080",
    "end": "1400630"
  },
  {
    "text": "by a team that called themselves C Rufus aka red wolf security team been",
    "start": "1400630",
    "end": "1408550"
  },
  {
    "text": "attributed to a lot of nation-state attacks based out of the asia-pacific region and very well known the source",
    "start": "1408550",
    "end": "1417280"
  },
  {
    "text": "code has been leaked online to this tool which means it's also now being used by script kiddies and sophisticated actors",
    "start": "1417280",
    "end": "1423910"
  },
  {
    "text": "alike here's just a handful of news media reports where this guy's been served in the wild we've seen it against",
    "start": "1423910",
    "end": "1433210"
  },
  {
    "text": "NATO Associated Press office of the Dalai Lama the US government private businesses I mean I could go on an old",
    "start": "1433210",
    "end": "1440980"
  },
  {
    "text": "notably operation night dragon pity Tiger apt 18 dynamite Panda they've all",
    "start": "1440980",
    "end": "1446740"
  },
  {
    "text": "been cited to use this guy very very Tom and cool toolkit and again easily signature Bowl",
    "start": "1446740",
    "end": "1453440"
  },
  {
    "text": "based on its situ traffic the path the traffic always starts out with a five",
    "start": "1453440",
    "end": "1458600"
  },
  {
    "text": "byte marker which is usually ghost spelled with a zero followed by two int",
    "start": "1458600",
    "end": "1463940"
  },
  {
    "text": "variables and then a gzip or not gzip and lzma compressed buffer since the",
    "start": "1463940",
    "end": "1472760"
  },
  {
    "text": "source code has been leaked online we've seen variants come up where they try to change that marker to hide who they are",
    "start": "1472760",
    "end": "1477770"
  },
  {
    "text": "but they usually just change it to a different 5 by variable so it's still very signature able the the list here of",
    "start": "1477770",
    "end": "1484610"
  },
  {
    "text": "different 5-bike markers that we have observed or have been observed are from a colleague paper Norah observed all",
    "start": "1484610",
    "end": "1492530"
  },
  {
    "text": "these and I just stole that from him but this guy was also very vulnerable it had",
    "start": "1492530",
    "end": "1498919"
  },
  {
    "text": "a vulnerability very similar to the extreme rat but this time the other way this when the attacker wants to pull a",
    "start": "1498919",
    "end": "1504500"
  },
  {
    "text": "file from his target the attacker sends a message that looks something like this it'll say give me your file C Drive",
    "start": "1504500",
    "end": "1510799"
  },
  {
    "text": "documents user you know file that doc so I can save it to folder X file dot",
    "start": "1510799",
    "end": "1517190"
  },
  {
    "text": "something another target response ok here's the data so you can save it to",
    "start": "1517190",
    "end": "1522410"
  },
  {
    "text": "this location and like the other case the first packets not necessary so we",
    "start": "1522410",
    "end": "1527780"
  },
  {
    "text": "can arbitrarily start telling the ghost server hey here's the file you requested please save this to your startup folder",
    "start": "1527780",
    "end": "1534650"
  },
  {
    "text": "for me if we know we're at startup folder is granted the start folder moves around a lot in Windows so this might",
    "start": "1534650",
    "end": "1541160"
  },
  {
    "text": "not be the best way to do this so I was thinking what what's the best use of this arbitrary file upload but it turns",
    "start": "1541160",
    "end": "1548090"
  },
  {
    "start": "1548000",
    "end": "1548000"
  },
  {
    "text": "out deal go strap provided a great use for this and that is ghost rat has a side load vulnerability if we drop a dll",
    "start": "1548090",
    "end": "1556610"
  },
  {
    "text": "file in the relative directory called oily dlg then the next time ghost starts",
    "start": "1556610",
    "end": "1563120"
  },
  {
    "text": "up it'll load that library looking for just one function that one function is Ola UI I busy and all that does is ask",
    "start": "1563120",
    "end": "1570350"
  },
  {
    "text": "if the UI is busy so we can quick we can make a dll on malicious DLL that does whatever we want and as long as it",
    "start": "1570350",
    "end": "1576830"
  },
  {
    "text": "exports this one function and always returns yes I'm busy then ghost it will be none the wiser and",
    "start": "1576830",
    "end": "1583430"
  },
  {
    "text": "we have our backdoor into the ghost trap unfortunately this requires ghosts to be",
    "start": "1583430",
    "end": "1588530"
  },
  {
    "text": "restarted and requires dropping the file to disk and I wanted something better than that so I continued looking and didn't take",
    "start": "1588530",
    "end": "1596570"
  },
  {
    "text": "long looking at the source code made it a whole lot easier but I have this one here this is in the parsing code of the",
    "start": "1596570",
    "end": "1604010"
  },
  {
    "text": "drive list given from a victim back to the adversary and here you can see that",
    "start": "1604010",
    "end": "1610820"
  },
  {
    "text": "it copies the list of drives buff the buffer of the list of drives and it uses",
    "start": "1610820",
    "end": "1616100"
  },
  {
    "text": "the size of the list of drive get as given from the target rather than the size of the buffer on the server",
    "start": "1616100",
    "end": "1621340"
  },
  {
    "text": "trusting that the list of drives on a victim will never be longer than a thousand characters because obviously",
    "start": "1621340",
    "end": "1627110"
  },
  {
    "text": "there's only gonna be 26 character 26 drives on a machine right that buffer",
    "start": "1627110",
    "end": "1633500"
  },
  {
    "text": "exists within this particular C class and so we can overwrite anything that",
    "start": "1633500",
    "end": "1639170"
  },
  {
    "text": "falls below below the you see the remote drive list that 1k buffer there that's",
    "start": "1639170",
    "end": "1644210"
  },
  {
    "text": "the one who overflow so we can overflow any we can overwrite anything below that there's a number of class pointers below",
    "start": "1644210",
    "end": "1650660"
  },
  {
    "text": "there which means anytime any function inside one of those classes below that gets called we control the pointer to",
    "start": "1650660",
    "end": "1657590"
  },
  {
    "text": "that function pointer so if to get execution we just have to have a pointer",
    "start": "1657590",
    "end": "1662660"
  },
  {
    "text": "to a pointer to our shellcode now to get that it would be great if I had an",
    "start": "1662660",
    "end": "1667970"
  },
  {
    "text": "information to schools your vulnerability unfortunately I'm lazy and I didn't go find one I don't I suspect",
    "start": "1667970",
    "end": "1674390"
  },
  {
    "text": "somebody could find one rather easily if they wanted to but I'm lazy so I just did the heap spray approach where I",
    "start": "1674390",
    "end": "1680000"
  },
  {
    "text": "spray the heap and then assume that I I know where I'm gonna land I also worried about depth but it turned",
    "start": "1680000",
    "end": "1687200"
  },
  {
    "text": "out that on any machine that forced depth to be enabled ghosts rats the co2 server component would not run at all",
    "start": "1687200",
    "end": "1693560"
  },
  {
    "text": "depth seemed to break the server so in all cases where I've seen ghost rat running I don't assume depth is working",
    "start": "1693560",
    "end": "1700580"
  },
  {
    "text": "I also have a demo for this one before I get there I wanted to talk about something else cool and that is some",
    "start": "1700580",
    "end": "1707330"
  },
  {
    "start": "1704000",
    "end": "1704000"
  },
  {
    "text": "work by Kevin the hermit he has written a series of decoders for these malware components so if you have the malware",
    "start": "1707330",
    "end": "1714020"
  },
  {
    "text": "piece from any one of these that go two extreme rat or poison ivy then he",
    "start": "1714020",
    "end": "1719030"
  },
  {
    "text": "can extract you run this code against it and it'll extract the configuration file giving you the address of the c2 server",
    "start": "1719030",
    "end": "1725210"
  },
  {
    "text": "so if you've been attacked and you have a sample we can extract the c2 server and then you can go attack the CG server",
    "start": "1725210",
    "end": "1731030"
  },
  {
    "text": "or if you don't want to wait until you're attacked you can go hunt virustotal pull the information there or we can",
    "start": "1731030",
    "end": "1738170"
  },
  {
    "text": "just ask shodhan right shodhan just recently announced a malware hunter capability where one of those types of",
    "start": "1738170",
    "end": "1745100"
  },
  {
    "text": "servers that they hunt for our ghost c2 servers so you can quickly do a search on go c2 and may are shown in looking",
    "start": "1745100",
    "end": "1751910"
  },
  {
    "text": "for a ghost c2 servers and find yourself a lovely list of targets there all right",
    "start": "1751910",
    "end": "1757310"
  },
  {
    "text": "I have the demo now with that out of the way this time I'm going to do it a little differently I'm going to actually",
    "start": "1757310",
    "end": "1764360"
  },
  {
    "text": "make a malware capice out with the ghost c2 server and I will deliver that to my",
    "start": "1764360",
    "end": "1771010"
  },
  {
    "text": "victim or whatnot usually that's delivered via phishing email or whatever",
    "start": "1771010",
    "end": "1776690"
  },
  {
    "text": "trick you want but since this is a VM I just kind of drag it over outside the",
    "start": "1776690",
    "end": "1782600"
  },
  {
    "text": "space I made a mistake there I closed my",
    "start": "1782600",
    "end": "1787670"
  },
  {
    "text": "c2 server so I realized mistake in a second here and I'll start it back up but might retaliate err we're gonna run",
    "start": "1787670",
    "end": "1795020"
  },
  {
    "text": "that decoder command against my piece of malware and there you see the C to address which we already knew but proof",
    "start": "1795020",
    "end": "1800960"
  },
  {
    "text": "of concept there I realized my mistake started the c2 server back up on the retaliate err side I'm now starting",
    "start": "1800960",
    "end": "1807290"
  },
  {
    "text": "meterpreter we're gonna ready this module all we need to do to ready it is",
    "start": "1807290",
    "end": "1812500"
  },
  {
    "text": "to first decide to use it we're gonna",
    "start": "1812500",
    "end": "1818150"
  },
  {
    "text": "set our remote host to the one we extracted from the malware itself just",
    "start": "1818150",
    "end": "1823880"
  },
  {
    "text": "show some info on it make sure everything looks good if they're using the magic of oven ghost we can change it to match their magic if you do a check",
    "start": "1823880",
    "end": "1831170"
  },
  {
    "text": "and it's not ghost it will tell you hey I think this is the magic you should change it and then we run the exploit",
    "start": "1831170",
    "end": "1837110"
  },
  {
    "text": "now because I decided to do a heap spray it's gonna take a little while to completely fill out the heat before we",
    "start": "1837110",
    "end": "1843200"
  },
  {
    "text": "get execution but there it is we start sending our meterpreter",
    "start": "1843200",
    "end": "1849240"
  },
  {
    "text": "a stager back and once I get my console",
    "start": "1849240",
    "end": "1855720"
  },
  {
    "text": "I believe I do assists info and we're gonna pop calc just as more visual proof",
    "start": "1855720",
    "end": "1862560"
  },
  {
    "text": "that we have execution on the target so the question now is what what to do now",
    "start": "1862560",
    "end": "1870860"
  },
  {
    "start": "1869000",
    "end": "1869000"
  },
  {
    "text": "and to be honest I'm not quite sure this is not really an area that's been documented at least publicly what to do",
    "start": "1870860",
    "end": "1877350"
  },
  {
    "text": "when you're on an attackers machine but these are some things I would think or suggest that would probably be",
    "start": "1877350",
    "end": "1882360"
  },
  {
    "text": "interesting one of the first I would suggest is to run net stat because that would show you any outbound connections",
    "start": "1882360",
    "end": "1888120"
  },
  {
    "text": "from that host so if there is any other victims that they are remote-controlling via their ghost implant or their plug X",
    "start": "1888120",
    "end": "1894270"
  },
  {
    "text": "implant or whatever you would see who else is a victim there at least their IP address every one of these tools has a",
    "start": "1894270",
    "end": "1900360"
  },
  {
    "text": "folder where they store files downloaded from their victims and I would suggest maybe searching that to see what type of",
    "start": "1900360",
    "end": "1906810"
  },
  {
    "text": "event files are they interested to what have they been gathering if you know what they have been gathering and who they're targeting that's very useful",
    "start": "1906810",
    "end": "1913260"
  },
  {
    "text": "information maybe you want to stall persistence maybe you want to hang around for quite some time and watch these guys and maybe install a key",
    "start": "1913260",
    "end": "1919890"
  },
  {
    "text": "logger you might find out what else they're interested in or maybe their Facebook profile if they decide to log in while they wait maybe still their",
    "start": "1919890",
    "end": "1926580"
  },
  {
    "text": "credentials to start a numerator Network I'm not really sure which of these are good ideas and maybe they're all bad ideas like I said is a discussion that",
    "start": "1926580",
    "end": "1933810"
  },
  {
    "text": "probably still needs to be had because it's very heavily undocumented at least publicly undocumented area but whatever",
    "start": "1933810",
    "end": "1940350"
  },
  {
    "text": "you do I definitely suggest you lie low and watch not try to draw us damage not",
    "start": "1940350",
    "end": "1947220"
  },
  {
    "text": "try to get revenge but observe that's really hard to see but if you squint and",
    "start": "1947220",
    "end": "1953370"
  },
  {
    "text": "pretend that's supposed to be ASCII art of Sun zu up there with that I just kind",
    "start": "1953370",
    "end": "1959340"
  },
  {
    "text": "of close up I want to give thanks to Bryce Coons who he presented last yesterday but he's been doing this kind",
    "start": "1959340",
    "end": "1966450"
  },
  {
    "text": "of development stuff he likes to try to find exploits against these and he's been doing it for much longer than I have but with that thank you very much I",
    "start": "1966450",
    "end": "1976170"
  },
  {
    "text": "have time for questions if you enjoyed this please fill out the survey and while you're filling that out",
    "start": "1976170",
    "end": "1982410"
  },
  {
    "text": "take some questions if anybody wants thank you",
    "start": "1982410",
    "end": "1986600"
  },
  {
    "text": "[Applause]",
    "start": "1989690",
    "end": "1992738"
  }
]