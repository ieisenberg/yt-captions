[
  {
    "text": "[Music]",
    "start": "1700",
    "end": "4810"
  },
  {
    "text": "so thank you for the kind introduction",
    "start": "7460",
    "end": "9720"
  },
  {
    "text": "and today we're going to present to you",
    "start": "9720",
    "end": "11400"
  },
  {
    "text": "I had actually leaking data from the",
    "start": "11400",
    "end": "13200"
  },
  {
    "text": "micro architecture actually we lied to",
    "start": "13200",
    "end": "16080"
  },
  {
    "text": "you since that's not the title today we",
    "start": "16080",
    "end": "19380"
  },
  {
    "text": "are going to present a",
    "start": "19380",
    "end": "20760"
  },
  {
    "text": "big leak architectural leaking",
    "start": "20760",
    "end": "22980"
  },
  {
    "text": "uninitialized data from the macro",
    "start": "22980",
    "end": "25140"
  },
  {
    "text": "architecture",
    "start": "25140",
    "end": "26279"
  },
  {
    "text": "you will witness the first architectural",
    "start": "26279",
    "end": "28920"
  },
  {
    "text": "bug that is able to leak stale data",
    "start": "28920",
    "end": "31260"
  },
  {
    "text": "without any side Channel and furthermore",
    "start": "31260",
    "end": "34140"
  },
  {
    "text": "it's not a transient execution attack",
    "start": "34140",
    "end": "37200"
  },
  {
    "text": "it's able to deterministically leaks",
    "start": "37200",
    "end": "39960"
  },
  {
    "text": "stale data from sjx enclaves",
    "start": "39960",
    "end": "43379"
  },
  {
    "text": "and also we do not even require hyper",
    "start": "43379",
    "end": "45840"
  },
  {
    "text": "threading for the basic leakage to",
    "start": "45840",
    "end": "47640"
  },
  {
    "text": "happen yeah and it affects like most",
    "start": "47640",
    "end": "49980"
  },
  {
    "text": "recent Intel CPUs so the name is epic",
    "start": "49980",
    "end": "53520"
  },
  {
    "text": "league so what is epic league so in the",
    "start": "53520",
    "end": "56340"
  },
  {
    "text": "name we have epic like and the component",
    "start": "56340",
    "end": "59160"
  },
  {
    "text": "so what is actually the Epic component",
    "start": "59160",
    "end": "61440"
  },
  {
    "text": "in a modern CPU yeah so the Epic is this",
    "start": "61440",
    "end": "64860"
  },
  {
    "text": "component in the CPU that is like",
    "start": "64860",
    "end": "66360"
  },
  {
    "text": "responsible to like generate receiving",
    "start": "66360",
    "end": "68820"
  },
  {
    "text": "generic might manage all the interrupts",
    "start": "68820",
    "end": "71820"
  },
  {
    "text": "for like smaller CPUs we have a local",
    "start": "71820",
    "end": "74100"
  },
  {
    "text": "epic for every core and like an IO epic",
    "start": "74100",
    "end": "77220"
  },
  {
    "text": "for like external devices like you",
    "start": "77220",
    "end": "79920"
  },
  {
    "text": "interact with the Epic with like the",
    "start": "79920",
    "end": "82920"
  },
  {
    "text": "Epic registers that by default are",
    "start": "82920",
    "end": "85680"
  },
  {
    "text": "memory mapped they are mapped on a like",
    "start": "85680",
    "end": "88259"
  },
  {
    "text": "region that is a physical memory that is",
    "start": "88259",
    "end": "90659"
  },
  {
    "text": "okay controlled by an MSR and they are",
    "start": "90659",
    "end": "93060"
  },
  {
    "text": "all 32 bits and always aligned to 16",
    "start": "93060",
    "end": "96479"
  },
  {
    "text": "bytes so wait if it only have 32 bits",
    "start": "96479",
    "end": "100020"
  },
  {
    "text": "and there was a line to 16 bytes with a",
    "start": "100020",
    "end": "102180"
  },
  {
    "text": "lot of free spaces and actually the Epic",
    "start": "102180",
    "end": "103979"
  },
  {
    "text": "range yes and the really important thing",
    "start": "103979",
    "end": "105900"
  },
  {
    "text": "is that you should never ever access",
    "start": "105900",
    "end": "108600"
  },
  {
    "text": "bytes 4 through 15 of this epic mmao",
    "start": "108600",
    "end": "112140"
  },
  {
    "text": "region okay but why oh yeah actually",
    "start": "112140",
    "end": "115380"
  },
  {
    "text": "Intel tells it oh if you read the Epic",
    "start": "115380",
    "end": "118320"
  },
  {
    "text": "the inter manual you can see that any",
    "start": "118320",
    "end": "121259"
  },
  {
    "text": "access to byte for 4 through 15 may",
    "start": "121259",
    "end": "124560"
  },
  {
    "text": "cause undefined Behavior",
    "start": "124560",
    "end": "126659"
  },
  {
    "text": "so wait the Intel manual says that if",
    "start": "126659",
    "end": "129060"
  },
  {
    "text": "you access those bytes you get undefined",
    "start": "129060",
    "end": "131400"
  },
  {
    "text": "Behavior yes or incorrect results",
    "start": "131400",
    "end": "133459"
  },
  {
    "text": "exactly so let's try this yes so we can",
    "start": "133459",
    "end": "137459"
  },
  {
    "text": "simply like you saw like a simple POC",
    "start": "137459",
    "end": "139560"
  },
  {
    "text": "where we Mark the we map the AP and dump",
    "start": "139560",
    "end": "142200"
  },
  {
    "text": "it not not so fast so we let me explain",
    "start": "142200",
    "end": "145379"
  },
  {
    "text": "those lines let's go over the lines a",
    "start": "145379",
    "end": "146940"
  },
  {
    "text": "little bit more slowly yeah so in the",
    "start": "146940",
    "end": "148620"
  },
  {
    "text": "first line we can see that we map the",
    "start": "148620",
    "end": "150840"
  },
  {
    "text": "physical address where the Epic is",
    "start": "150840",
    "end": "152280"
  },
  {
    "text": "located into the virtual address space",
    "start": "152280",
    "end": "154260"
  },
  {
    "text": "so we can actually read from it and then",
    "start": "154260",
    "end": "156540"
  },
  {
    "text": "I assume this first dump Epic Base from",
    "start": "156540",
    "end": "159540"
  },
  {
    "text": "zero that's just reading the the normal",
    "start": "159540",
    "end": "161819"
  },
  {
    "text": "that's a valid register so you're like",
    "start": "161819",
    "end": "163500"
  },
  {
    "text": "what you were expecting so we get zeros",
    "start": "163500",
    "end": "165660"
  },
  {
    "text": "back",
    "start": "165660",
    "end": "166440"
  },
  {
    "text": "but then let's continue let's continue",
    "start": "166440",
    "end": "168420"
  },
  {
    "text": "might be like dumping the Epic so we see",
    "start": "168420",
    "end": "171120"
  },
  {
    "text": "something so what's happening there so",
    "start": "171120",
    "end": "173220"
  },
  {
    "text": "if we access those bytes these four to",
    "start": "173220",
    "end": "175019"
  },
  {
    "text": "15 bytes we get back one interrupt yeah",
    "start": "175019",
    "end": "178379"
  },
  {
    "text": "like what is this is it in the Epic if",
    "start": "178379",
    "end": "180360"
  },
  {
    "text": "we continue to dump it like we have data",
    "start": "180360",
    "end": "183060"
  },
  {
    "text": "isn't it strange so if you look at this",
    "start": "183060",
    "end": "185940"
  },
  {
    "text": "memory jump we basically generated by",
    "start": "185940",
    "end": "187739"
  },
  {
    "text": "just reading from the Epic we can see",
    "start": "187739",
    "end": "189780"
  },
  {
    "text": "that in the first four bytes we always",
    "start": "189780",
    "end": "191400"
  },
  {
    "text": "get like Valley epic data but on the",
    "start": "191400",
    "end": "193800"
  },
  {
    "text": "byte from 4 to 15 we get strings yeah",
    "start": "193800",
    "end": "196680"
  },
  {
    "text": "that's strings and what's Happening Here",
    "start": "196680",
    "end": "198959"
  },
  {
    "text": "we are architecturally leaking State",
    "start": "198959",
    "end": "202019"
  },
  {
    "text": "values just by dumping the Epic mmio",
    "start": "202019",
    "end": "205019"
  },
  {
    "text": "region so I can see that this is data",
    "start": "205019",
    "end": "207300"
  },
  {
    "text": "because that's obviously strings one",
    "start": "207300",
    "end": "209280"
  },
  {
    "text": "interrupt Source bending or something",
    "start": "209280",
    "end": "210900"
  },
  {
    "text": "like that but if you take a look at this",
    "start": "210900",
    "end": "212819"
  },
  {
    "text": "dump here uuh that's not a string so",
    "start": "212819",
    "end": "215940"
  },
  {
    "text": "yeah okay there's no data that's",
    "start": "215940",
    "end": "218159"
  },
  {
    "text": "instructions",
    "start": "218159",
    "end": "219659"
  },
  {
    "text": "wait these are instructions yeah let's",
    "start": "219659",
    "end": "221700"
  },
  {
    "text": "disassemble it like you just see it",
    "start": "221700",
    "end": "223440"
  },
  {
    "text": "value destruction there like",
    "start": "223440",
    "end": "225180"
  },
  {
    "text": "obviously not in the Epic but we read",
    "start": "225180",
    "end": "227280"
  },
  {
    "text": "that so we just recovered instructions",
    "start": "227280",
    "end": "230340"
  },
  {
    "text": "which are able to disassemble from",
    "start": "230340",
    "end": "233159"
  },
  {
    "text": "Reading undefined epic registers exactly",
    "start": "233159",
    "end": "235920"
  },
  {
    "text": "okay actually not on every CPUs so on",
    "start": "235920",
    "end": "239099"
  },
  {
    "text": "most CPUs you read either zeros or refs",
    "start": "239099",
    "end": "241620"
  },
  {
    "text": "or like sometimes even the whole CPU",
    "start": "241620",
    "end": "243840"
  },
  {
    "text": "hangs or triple filter reboots but on",
    "start": "243840",
    "end": "246780"
  },
  {
    "text": "Modern CPUs from Intel like 10 11th and",
    "start": "246780",
    "end": "249480"
  },
  {
    "text": "12th generation CPUs that's not the case",
    "start": "249480",
    "end": "252780"
  },
  {
    "text": "okay okay okay I I see that we leaked",
    "start": "252780",
    "end": "255959"
  },
  {
    "text": "some data I see that leaks some",
    "start": "255959",
    "end": "257280"
  },
  {
    "text": "instructions but where the hell do we",
    "start": "257280",
    "end": "259260"
  },
  {
    "text": "leak instructions from where does the",
    "start": "259260",
    "end": "261060"
  },
  {
    "text": "leakage actually come from yeah so we",
    "start": "261060",
    "end": "263759"
  },
  {
    "text": "can devise simple experiments to try to",
    "start": "263759",
    "end": "266220"
  },
  {
    "text": "understand okay where this data came",
    "start": "266220",
    "end": "267900"
  },
  {
    "text": "from we can like we have here a model of",
    "start": "267900",
    "end": "270060"
  },
  {
    "text": "the CPU with like all the stages from",
    "start": "270060",
    "end": "272699"
  },
  {
    "text": "the CPU to memory and we can start to",
    "start": "272699",
    "end": "275160"
  },
  {
    "text": "understand and start to try to",
    "start": "275160",
    "end": "276240"
  },
  {
    "text": "understand like where does it come from",
    "start": "276240",
    "end": "277680"
  },
  {
    "text": "okay let's let's just systematically go",
    "start": "277680",
    "end": "279780"
  },
  {
    "text": "over this so can we leak is the data",
    "start": "279780",
    "end": "281940"
  },
  {
    "text": "leaking from the registers or the",
    "start": "281940",
    "end": "283380"
  },
  {
    "text": "execution engine yeah so let's do an",
    "start": "283380",
    "end": "285419"
  },
  {
    "text": "experiment where we only keep data in",
    "start": "285419",
    "end": "287940"
  },
  {
    "text": "the registers all right we make simple",
    "start": "287940",
    "end": "289380"
  },
  {
    "text": "operation with that and we don't see",
    "start": "289380",
    "end": "291300"
  },
  {
    "text": "that data so it's not coming from",
    "start": "291300",
    "end": "293400"
  },
  {
    "text": "register or the execution engine what",
    "start": "293400",
    "end": "295440"
  },
  {
    "text": "about the private caches of the core so",
    "start": "295440",
    "end": "297180"
  },
  {
    "text": "L1 or L2 yeah so like now we're talking",
    "start": "297180",
    "end": "300000"
  },
  {
    "text": "about the memory and okay if we access a",
    "start": "300000",
    "end": "302820"
  },
  {
    "text": "lot of memory we see leaks but if we",
    "start": "302820",
    "end": "304979"
  },
  {
    "text": "only access a small amount of memory",
    "start": "304979",
    "end": "306479"
  },
  {
    "text": "like that fits in the L1 or L2 cache we",
    "start": "306479",
    "end": "309360"
  },
  {
    "text": "don't see anything",
    "start": "309360",
    "end": "310680"
  },
  {
    "text": "okay I also see that what about the",
    "start": "310680",
    "end": "313320"
  },
  {
    "text": "shared hash so the LSC or even the Ram",
    "start": "313320",
    "end": "315780"
  },
  {
    "text": "or the memory subsystem in general yeah",
    "start": "315780",
    "end": "317759"
  },
  {
    "text": "that's interesting too if we access like",
    "start": "317759",
    "end": "319919"
  },
  {
    "text": "a lot of memory from a color then we see",
    "start": "319919",
    "end": "321600"
  },
  {
    "text": "leaks but with the only access that",
    "start": "321600",
    "end": "323820"
  },
  {
    "text": "memory from another code different than",
    "start": "323820",
    "end": "326460"
  },
  {
    "text": "the work that we are looking from we",
    "start": "326460",
    "end": "328500"
  },
  {
    "text": "don't see anything there",
    "start": "328500",
    "end": "330900"
  },
  {
    "text": "okay so we systematically go over all",
    "start": "330900",
    "end": "333120"
  },
  {
    "text": "these components what is what is missing",
    "start": "333120",
    "end": "335160"
  },
  {
    "text": "what do we miss yeah it must be",
    "start": "335160",
    "end": "336600"
  },
  {
    "text": "something in the middle it does the",
    "start": "336600",
    "end": "337919"
  },
  {
    "text": "super queue so what's the super queue so",
    "start": "337919",
    "end": "341400"
  },
  {
    "text": "it's really simple the super queue is",
    "start": "341400",
    "end": "343139"
  },
  {
    "text": "this the coupling buffer between the L2",
    "start": "343139",
    "end": "345419"
  },
  {
    "text": "cache and the LLC it just contains like",
    "start": "345419",
    "end": "348240"
  },
  {
    "text": "all the data that passes between the two",
    "start": "348240",
    "end": "350160"
  },
  {
    "text": "caches like from the L2 to the LLC and",
    "start": "350160",
    "end": "352620"
  },
  {
    "text": "back and forth so if you were like if",
    "start": "352620",
    "end": "355680"
  },
  {
    "text": "you know like MDS attacks and all this",
    "start": "355680",
    "end": "357360"
  },
  {
    "text": "stuff they were targeting like line",
    "start": "357360",
    "end": "358680"
  },
  {
    "text": "field buffers is the same but line field",
    "start": "358680",
    "end": "360960"
  },
  {
    "text": "buffers were between L1 and little cache",
    "start": "360960",
    "end": "363419"
  },
  {
    "text": "and here we're talking about L2 cache",
    "start": "363419",
    "end": "365580"
  },
  {
    "text": "and LLC cache",
    "start": "365580",
    "end": "367259"
  },
  {
    "text": "okay so what we're now talking about an",
    "start": "367259",
    "end": "369600"
  },
  {
    "text": "interconnection between the L2 and the",
    "start": "369600",
    "end": "371580"
  },
  {
    "text": "LSC and we can leak data that's passing",
    "start": "371580",
    "end": "374280"
  },
  {
    "text": "over this interconnection but can we",
    "start": "374280",
    "end": "376259"
  },
  {
    "text": "actually leak all the data that's",
    "start": "376259",
    "end": "377880"
  },
  {
    "text": "passing over those using the connections",
    "start": "377880",
    "end": "379500"
  },
  {
    "text": "no okay first of all we are talking",
    "start": "379500",
    "end": "381120"
  },
  {
    "text": "about undefined offsets of the Epic mmio",
    "start": "381120",
    "end": "384000"
  },
  {
    "text": "so every time we read like the initial",
    "start": "384000",
    "end": "386819"
  },
  {
    "text": "values of the APK mmao registers we",
    "start": "386819",
    "end": "389220"
  },
  {
    "text": "don't see anything so we only leak three",
    "start": "389220",
    "end": "390900"
  },
  {
    "text": "quarters of a cache line oh I can see",
    "start": "390900",
    "end": "393419"
  },
  {
    "text": "that because one quarter of each of the",
    "start": "393419",
    "end": "395340"
  },
  {
    "text": "16 byte regions is actually a valid epic",
    "start": "395340",
    "end": "397620"
  },
  {
    "text": "register so you will never leak from",
    "start": "397620",
    "end": "399240"
  },
  {
    "text": "that because you're giving just back the",
    "start": "399240",
    "end": "400919"
  },
  {
    "text": "defined epic value for the register yeah",
    "start": "400919",
    "end": "403440"
  },
  {
    "text": "and then there is something more we",
    "start": "403440",
    "end": "405419"
  },
  {
    "text": "cannot explain this but in all our",
    "start": "405419",
    "end": "407220"
  },
  {
    "text": "experiments we always ever observed even",
    "start": "407220",
    "end": "410400"
  },
  {
    "text": "cache lines so if we map the like the if",
    "start": "410400",
    "end": "413280"
  },
  {
    "text": "you number the cache lines in a page",
    "start": "413280",
    "end": "415199"
  },
  {
    "text": "from like the zeros the the first the",
    "start": "415199",
    "end": "417360"
  },
  {
    "text": "second Etc you only leak values from the",
    "start": "417360",
    "end": "420300"
  },
  {
    "text": "zeroth the second the first and that's",
    "start": "420300",
    "end": "422340"
  },
  {
    "text": "it so we can leak like three quarters of",
    "start": "422340",
    "end": "425400"
  },
  {
    "text": "even cash lines",
    "start": "425400",
    "end": "427440"
  },
  {
    "text": "now we see we like we have this really",
    "start": "427440",
    "end": "430380"
  },
  {
    "text": "cool attacks where we leak data from the",
    "start": "430380",
    "end": "433139"
  },
  {
    "text": "super queue and so we can think about it",
    "start": "433139",
    "end": "436380"
  },
  {
    "text": "as if it was like an initialized memory",
    "start": "436380",
    "end": "439860"
  },
  {
    "text": "reads but in the CPU itself so it's not",
    "start": "439860",
    "end": "442620"
  },
  {
    "text": "like at the software level but that's at",
    "start": "442620",
    "end": "445080"
  },
  {
    "text": "the hardware level",
    "start": "445080",
    "end": "446759"
  },
  {
    "text": "but we have kind of like I would say a",
    "start": "446759",
    "end": "449460"
  },
  {
    "text": "problem here to exploit this we have to",
    "start": "449460",
    "end": "451860"
  },
  {
    "text": "access the Epic mmio registers",
    "start": "451860",
    "end": "454500"
  },
  {
    "text": "and the problem is that's only like",
    "start": "454500",
    "end": "456300"
  },
  {
    "text": "something like an operating system can",
    "start": "456300",
    "end": "458520"
  },
  {
    "text": "access that so I mean what can we attack",
    "start": "458520",
    "end": "460740"
  },
  {
    "text": "with this so actually their Intel sgx",
    "start": "460740",
    "end": "463680"
  },
  {
    "text": "comes to the rescue",
    "start": "463680",
    "end": "465360"
  },
  {
    "text": "and the other thing what's interest GX",
    "start": "465360",
    "end": "467639"
  },
  {
    "text": "so intellects is this uh environment as",
    "start": "467639",
    "end": "470280"
  },
  {
    "text": "it is the software software guard",
    "start": "470280",
    "end": "471660"
  },
  {
    "text": "extension that",
    "start": "471660",
    "end": "473639"
  },
  {
    "text": "aims to give you an environment where",
    "start": "473639",
    "end": "476039"
  },
  {
    "text": "your code on data is all protected",
    "start": "476039",
    "end": "477900"
  },
  {
    "text": "against a privileged attacker and this",
    "start": "477900",
    "end": "479940"
  },
  {
    "text": "also includes a malicious operating s",
    "start": "479940",
    "end": "482280"
  },
  {
    "text": "operating system for example so with a",
    "start": "482280",
    "end": "484740"
  },
  {
    "text": "malicious operating system we could like",
    "start": "484740",
    "end": "486300"
  },
  {
    "text": "map the Epic mmao region and access it",
    "start": "486300",
    "end": "488940"
  },
  {
    "text": "to leaked data that's interesting but",
    "start": "488940",
    "end": "491039"
  },
  {
    "text": "how do they protect memory with sgx so",
    "start": "491039",
    "end": "493560"
  },
  {
    "text": "one of the key concepts of sjx is that",
    "start": "493560",
    "end": "495599"
  },
  {
    "text": "it transparently encrypts data that is",
    "start": "495599",
    "end": "498240"
  },
  {
    "text": "stored in The Enclave this is done by",
    "start": "498240",
    "end": "500280"
  },
  {
    "text": "The Enclave pagecars this is a small",
    "start": "500280",
    "end": "502919"
  },
  {
    "text": "region in Ram where basically the data",
    "start": "502919",
    "end": "505139"
  },
  {
    "text": "gets transparently encrypted if you",
    "start": "505139",
    "end": "506819"
  },
  {
    "text": "write data to it",
    "start": "506819",
    "end": "508379"
  },
  {
    "text": "okay that's interesting so we are",
    "start": "508379",
    "end": "510240"
  },
  {
    "text": "talking about pages but isn't the like",
    "start": "510240",
    "end": "512339"
  },
  {
    "text": "operating system that manages Pages here",
    "start": "512339",
    "end": "514560"
  },
  {
    "text": "yes that's a really good point also in",
    "start": "514560",
    "end": "517080"
  },
  {
    "text": "sgx the operating system is still",
    "start": "517080",
    "end": "519240"
  },
  {
    "text": "responsible for the page management of",
    "start": "519240",
    "end": "521339"
  },
  {
    "text": "an enclave and furthermore in each of",
    "start": "521339",
    "end": "523740"
  },
  {
    "text": "the enclaves and sjx you have one",
    "start": "523740",
    "end": "525540"
  },
  {
    "text": "specific page special page the store",
    "start": "525540",
    "end": "527880"
  },
  {
    "text": "called State safe area and the idea of",
    "start": "527880",
    "end": "530040"
  },
  {
    "text": "this page is to store register values",
    "start": "530040",
    "end": "532680"
  },
  {
    "text": "you have to safely store them for",
    "start": "532680",
    "end": "534420"
  },
  {
    "text": "example if an asynchronous event occurs",
    "start": "534420",
    "end": "536279"
  },
  {
    "text": "think of life you can interrupt",
    "start": "536279",
    "end": "537660"
  },
  {
    "text": "interrupt the idea is that you store the",
    "start": "537660",
    "end": "540000"
  },
  {
    "text": "registers there before giving back the",
    "start": "540000",
    "end": "542100"
  },
  {
    "text": "control flow to the operating system",
    "start": "542100",
    "end": "543959"
  },
  {
    "text": "which is potentially malicious oh that's",
    "start": "543959",
    "end": "547140"
  },
  {
    "text": "cool so if we target sgx enclaves we can",
    "start": "547140",
    "end": "550080"
  },
  {
    "text": "like sample data from this Enclave like",
    "start": "550080",
    "end": "552720"
  },
  {
    "text": "we can run the enclave and use an upper",
    "start": "552720",
    "end": "555000"
  },
  {
    "text": "thread to like dump the Epic and then",
    "start": "555000",
    "end": "557760"
  },
  {
    "text": "like there we can leak the values that",
    "start": "557760",
    "end": "559920"
  },
  {
    "text": "they're using but",
    "start": "559920",
    "end": "561720"
  },
  {
    "text": "that's that's not enough like how can we",
    "start": "561720",
    "end": "563940"
  },
  {
    "text": "lick interesting data is there any way",
    "start": "563940",
    "end": "566700"
  },
  {
    "text": "that we can like force the data that we",
    "start": "566700",
    "end": "568500"
  },
  {
    "text": "want to leak to be in the Super queue",
    "start": "568500",
    "end": "570180"
  },
  {
    "text": "and like to keep this data long enough",
    "start": "570180",
    "end": "572940"
  },
  {
    "text": "to be able to leak those data that's a",
    "start": "572940",
    "end": "575580"
  },
  {
    "text": "really good point and that brings us to",
    "start": "575580",
    "end": "577320"
  },
  {
    "text": "Enclave shaking so Enclave shaking uses",
    "start": "577320",
    "end": "581040"
  },
  {
    "text": "those two instructions which are",
    "start": "581040",
    "end": "583140"
  },
  {
    "text": "basically responsible for taking a page",
    "start": "583140",
    "end": "585300"
  },
  {
    "text": "out of the EPC page cache and bringing",
    "start": "585300",
    "end": "587760"
  },
  {
    "text": "them back to main memory this is done so",
    "start": "587760",
    "end": "590279"
  },
  {
    "text": "by using the evb instruction and just",
    "start": "590279",
    "end": "593700"
  },
  {
    "text": "brings the data to from the encrypted",
    "start": "593700",
    "end": "595980"
  },
  {
    "text": "page to the core re-encrypts it and then",
    "start": "595980",
    "end": "598500"
  },
  {
    "text": "stores it into the main memory and if",
    "start": "598500",
    "end": "600360"
  },
  {
    "text": "you can guess what the counterpart is",
    "start": "600360",
    "end": "601920"
  },
  {
    "text": "yeah I would say that they'll do",
    "start": "601920",
    "end": "603420"
  },
  {
    "text": "instructions then like brings the page",
    "start": "603420",
    "end": "605640"
  },
  {
    "text": "from the like main memory and the grips",
    "start": "605640",
    "end": "608519"
  },
  {
    "text": "it and like put it back to into the APC",
    "start": "608519",
    "end": "611040"
  },
  {
    "text": "exactly and this gets a bit more",
    "start": "611040",
    "end": "612839"
  },
  {
    "text": "visualized here if you see on the right",
    "start": "612839",
    "end": "615000"
  },
  {
    "text": "side we have one page inside the sjx",
    "start": "615000",
    "end": "617880"
  },
  {
    "text": "page cache and we can now use ewb to",
    "start": "617880",
    "end": "620580"
  },
  {
    "text": "bring that page to the core re-encrypted",
    "start": "620580",
    "end": "623459"
  },
  {
    "text": "and then booted out into the main memory",
    "start": "623459",
    "end": "625380"
  },
  {
    "text": "okay this is very interesting since",
    "start": "625380",
    "end": "627120"
  },
  {
    "text": "while we bring this page like back and",
    "start": "627120",
    "end": "629580"
  },
  {
    "text": "forth to the CPU to the memory then we",
    "start": "629580",
    "end": "631920"
  },
  {
    "text": "are literally making the page pass",
    "start": "631920",
    "end": "633480"
  },
  {
    "text": "through the super queue so that we left",
    "start": "633480",
    "end": "635760"
  },
  {
    "text": "the data that is in the page passing",
    "start": "635760",
    "end": "638220"
  },
  {
    "text": "through our super queue that we can lick",
    "start": "638220",
    "end": "639660"
  },
  {
    "text": "that exactly and the same happens if you",
    "start": "639660",
    "end": "641880"
  },
  {
    "text": "take the words around the the inverse",
    "start": "641880",
    "end": "644459"
  },
  {
    "text": "route from an encrypted page in main",
    "start": "644459",
    "end": "647399"
  },
  {
    "text": "memory in this case is P2 we bring it to",
    "start": "647399",
    "end": "649560"
  },
  {
    "text": "the core we decrypt it and can put it",
    "start": "649560",
    "end": "651720"
  },
  {
    "text": "back into the EPC page cache with the",
    "start": "651720",
    "end": "653940"
  },
  {
    "text": "ldu instruction and this passes as well",
    "start": "653940",
    "end": "656160"
  },
  {
    "text": "through the super queue so that we can",
    "start": "656160",
    "end": "657839"
  },
  {
    "text": "Target it and leave it but okay that's",
    "start": "657839",
    "end": "660779"
  },
  {
    "text": "not enough we I want a cool attack we",
    "start": "660779",
    "end": "663060"
  },
  {
    "text": "can like only control like the whole",
    "start": "663060",
    "end": "665100"
  },
  {
    "text": "pages here I want to process precisely",
    "start": "665100",
    "end": "667740"
  },
  {
    "text": "Target like cache lines so that we can",
    "start": "667740",
    "end": "669600"
  },
  {
    "text": "like for example select what we want to",
    "start": "669600",
    "end": "672180"
  },
  {
    "text": "leak with this attack yeah that's a cool",
    "start": "672180",
    "end": "674820"
  },
  {
    "text": "idea and we also have a solution for",
    "start": "674820",
    "end": "676320"
  },
  {
    "text": "that it's called cache line freezing and",
    "start": "676320",
    "end": "678600"
  },
  {
    "text": "as we mentioned in the beginning This",
    "start": "678600",
    "end": "680220"
  },
  {
    "text": "Thread model is already strong enough to",
    "start": "680220",
    "end": "681600"
  },
  {
    "text": "we can simply sample data from the super",
    "start": "681600",
    "end": "683579"
  },
  {
    "text": "queue but we can also use the hyper",
    "start": "683579",
    "end": "686279"
  },
  {
    "text": "thread we don't need it but if we use",
    "start": "686279",
    "end": "688079"
  },
  {
    "text": "the hyper thread we can enhance the",
    "start": "688079",
    "end": "690000"
  },
  {
    "text": "leakage even further why is that think",
    "start": "690000",
    "end": "692279"
  },
  {
    "text": "about it the hyper thread and its",
    "start": "692279",
    "end": "694079"
  },
  {
    "text": "sibling share the super queue oh that's",
    "start": "694079",
    "end": "696480"
  },
  {
    "text": "cool so this means that like another",
    "start": "696480",
    "end": "698339"
  },
  {
    "text": "thread can affect what is kept in the",
    "start": "698339",
    "end": "700920"
  },
  {
    "text": "super queue with like just like using",
    "start": "700920",
    "end": "703019"
  },
  {
    "text": "memory yes and we also use add Fury",
    "start": "703019",
    "end": "705680"
  },
  {
    "text": "basically that 32 bytes of zeros are",
    "start": "705680",
    "end": "709500"
  },
  {
    "text": "never actually transmitted over the",
    "start": "709500",
    "end": "711540"
  },
  {
    "text": "serial queue okay this is cool how does",
    "start": "711540",
    "end": "714060"
  },
  {
    "text": "it work yeah so let's take a look at",
    "start": "714060",
    "end": "716160"
  },
  {
    "text": "that so in this animation we have on the",
    "start": "716160",
    "end": "719279"
  },
  {
    "text": "top left we have two Frets fret one has",
    "start": "719279",
    "end": "721680"
  },
  {
    "text": "an address where where it tries to",
    "start": "721680",
    "end": "724320"
  },
  {
    "text": "access a secret value from the memory",
    "start": "724320",
    "end": "726300"
  },
  {
    "text": "thread 2 also has an address as a",
    "start": "726300",
    "end": "728640"
  },
  {
    "text": "different address but the page offset",
    "start": "728640",
    "end": "730440"
  },
  {
    "text": "offset address is the same and if fret",
    "start": "730440",
    "end": "732959"
  },
  {
    "text": "one now tries to read from that address",
    "start": "732959",
    "end": "734459"
  },
  {
    "text": "the secret is loaded into the Super",
    "start": "734459",
    "end": "736260"
  },
  {
    "text": "queue then forward it to the private",
    "start": "736260",
    "end": "738600"
  },
  {
    "text": "caches and finally it ends up in the",
    "start": "738600",
    "end": "740700"
  },
  {
    "text": "read that's cool so we have the secret",
    "start": "740700",
    "end": "742500"
  },
  {
    "text": "in the super queue now so that we can",
    "start": "742500",
    "end": "743880"
  },
  {
    "text": "lick it yes that's basically without",
    "start": "743880",
    "end": "745500"
  },
  {
    "text": "using hyper threading okay but what",
    "start": "745500",
    "end": "747000"
  },
  {
    "text": "happens now is fret 2 at the same time",
    "start": "747000",
    "end": "749040"
  },
  {
    "text": "or after the first secret access was",
    "start": "749040",
    "end": "751620"
  },
  {
    "text": "performed accesses the different address",
    "start": "751620",
    "end": "753540"
  },
  {
    "text": "where the access are located so the X's",
    "start": "753540",
    "end": "756420"
  },
  {
    "text": "are then replacing that super queue",
    "start": "756420",
    "end": "758640"
  },
  {
    "text": "entry again drawing brought back to the",
    "start": "758640",
    "end": "761279"
  },
  {
    "text": "L1 L2 caches and forward it to the",
    "start": "761279",
    "end": "763200"
  },
  {
    "text": "different route wait don't now we don't",
    "start": "763200",
    "end": "765240"
  },
  {
    "text": "have any more this Security in the super",
    "start": "765240",
    "end": "766800"
  },
  {
    "text": "we just destroyed what we wanted to",
    "start": "766800",
    "end": "768180"
  },
  {
    "text": "leave yes we overwrote our secret so if",
    "start": "768180",
    "end": "770220"
  },
  {
    "text": "we now use epic we get back to access so",
    "start": "770220",
    "end": "772320"
  },
  {
    "text": "we didn't gain much there however if we",
    "start": "772320",
    "end": "774360"
  },
  {
    "text": "now take a look at the zero case and we",
    "start": "774360",
    "end": "776579"
  },
  {
    "text": "perform the secret axis again in fret",
    "start": "776579",
    "end": "778620"
  },
  {
    "text": "one",
    "start": "778620",
    "end": "779399"
  },
  {
    "text": "the data travels over the simple queue",
    "start": "779399",
    "end": "781320"
  },
  {
    "text": "into the private caches to the read and",
    "start": "781320",
    "end": "783300"
  },
  {
    "text": "now thread 2 accesses that address where",
    "start": "783300",
    "end": "785579"
  },
  {
    "text": "the series are located something",
    "start": "785579",
    "end": "786899"
  },
  {
    "text": "different happens",
    "start": "786899",
    "end": "788279"
  },
  {
    "text": "zeros are a few reasons that the zeros",
    "start": "788279",
    "end": "790500"
  },
  {
    "text": "are marked differently in the super",
    "start": "790500",
    "end": "791820"
  },
  {
    "text": "queue and are actually never transmitted",
    "start": "791820",
    "end": "793620"
  },
  {
    "text": "so we just marked the super queue entry",
    "start": "793620",
    "end": "795660"
  },
  {
    "text": "that it contains not all zeros this is",
    "start": "795660",
    "end": "798000"
  },
  {
    "text": "then resolved and forwarded to the",
    "start": "798000",
    "end": "799560"
  },
  {
    "text": "private caches and ends up in the final",
    "start": "799560",
    "end": "801779"
  },
  {
    "text": "read so this is like an optimization to",
    "start": "801779",
    "end": "804300"
  },
  {
    "text": "avoid passing zeros through this through",
    "start": "804300",
    "end": "806459"
  },
  {
    "text": "a cashier we actually don't know but",
    "start": "806459",
    "end": "808200"
  },
  {
    "text": "yeah that's interesting so if you take a",
    "start": "808200",
    "end": "810839"
  },
  {
    "text": "look now we can see that we have Frozen",
    "start": "810839",
    "end": "812880"
  },
  {
    "text": "The Secret inside the super queue entry",
    "start": "812880",
    "end": "815339"
  },
  {
    "text": "and what we can now do is we can use",
    "start": "815339",
    "end": "817320"
  },
  {
    "text": "epic the undefined bytes the undefined",
    "start": "817320",
    "end": "819959"
  },
  {
    "text": "line bytes to read that secret out of",
    "start": "819959",
    "end": "822180"
  },
  {
    "text": "the super queue entry okay this is cool",
    "start": "822180",
    "end": "824160"
  },
  {
    "text": "and I guess this is epically yes so",
    "start": "824160",
    "end": "827399"
  },
  {
    "text": "every click just combines all these",
    "start": "827399",
    "end": "829680"
  },
  {
    "text": "techniques we can use Enclave checking",
    "start": "829680",
    "end": "831899"
  },
  {
    "text": "to make pages of targets as Jacks",
    "start": "831899",
    "end": "834480"
  },
  {
    "text": "enclaves pass through the super queue",
    "start": "834480",
    "end": "836279"
  },
  {
    "text": "and then freezing those cache lines that",
    "start": "836279",
    "end": "838680"
  },
  {
    "text": "we want to leak using cache line",
    "start": "838680",
    "end": "840360"
  },
  {
    "text": "freezing so that we can precisely Target",
    "start": "840360",
    "end": "842160"
  },
  {
    "text": "what we want to leak basically with epic",
    "start": "842160",
    "end": "845519"
  },
  {
    "text": "click we can like leak three quarters of",
    "start": "845519",
    "end": "848279"
  },
  {
    "text": "every single cache line that is in an",
    "start": "848279",
    "end": "851160"
  },
  {
    "text": "even offset and we can like do this from",
    "start": "851160",
    "end": "854459"
  },
  {
    "text": "any sjx Enclave page that we want to",
    "start": "854459",
    "end": "856920"
  },
  {
    "text": "Target and one of the biggest and",
    "start": "856920",
    "end": "858660"
  },
  {
    "text": "strongest Parts is that we can do that",
    "start": "858660",
    "end": "860639"
  },
  {
    "text": "even without the Enclave running because",
    "start": "860639",
    "end": "862800"
  },
  {
    "text": "the encrypted Pages exist still after an",
    "start": "862800",
    "end": "865680"
  },
  {
    "text": "enclave is idling so we can attack an",
    "start": "865680",
    "end": "867600"
  },
  {
    "text": "enclave even though the Enclave is not",
    "start": "867600",
    "end": "869519"
  },
  {
    "text": "running",
    "start": "869519",
    "end": "870240"
  },
  {
    "text": "okay this is cool but what can we do",
    "start": "870240",
    "end": "872100"
  },
  {
    "text": "with this so This brings us to our two",
    "start": "872100",
    "end": "874019"
  },
  {
    "text": "attack setups we have in the publication",
    "start": "874019",
    "end": "876600"
  },
  {
    "text": "there and the first one is just",
    "start": "876600",
    "end": "878459"
  },
  {
    "text": "targeting data and code so we've seen",
    "start": "878459",
    "end": "880620"
  },
  {
    "text": "that we can leak data and code where",
    "start": "880620",
    "end": "882180"
  },
  {
    "text": "you're reading the Epic registers and",
    "start": "882180",
    "end": "883500"
  },
  {
    "text": "the idea is now quite simple we start an",
    "start": "883500",
    "end": "885540"
  },
  {
    "text": "enclave and wait until the Enclave is",
    "start": "885540",
    "end": "887639"
  },
  {
    "text": "filled with some secret data oh okay so",
    "start": "887639",
    "end": "890040"
  },
  {
    "text": "then we just move the page that we want",
    "start": "890040",
    "end": "892079"
  },
  {
    "text": "to Target out of the APC okay this is",
    "start": "892079",
    "end": "894420"
  },
  {
    "text": "good and if you remember in the",
    "start": "894420",
    "end": "895680"
  },
  {
    "text": "beginning where we talked about sjx",
    "start": "895680",
    "end": "897540"
  },
  {
    "text": "there was this one special page and this",
    "start": "897540",
    "end": "900240"
  },
  {
    "text": "page is the solution how we can leak",
    "start": "900240",
    "end": "902220"
  },
  {
    "text": "register contents so the idea there is a",
    "start": "902220",
    "end": "904860"
  },
  {
    "text": "little bit different so we started The",
    "start": "904860",
    "end": "906000"
  },
  {
    "text": "Enclave again but then we wait to have",
    "start": "906000",
    "end": "908339"
  },
  {
    "text": "specific instruction and force The",
    "start": "908339",
    "end": "910320"
  },
  {
    "text": "Enclave to store the content of its",
    "start": "910320",
    "end": "912660"
  },
  {
    "text": "registers onto that special page oh so",
    "start": "912660",
    "end": "915060"
  },
  {
    "text": "it's the same then we move the SSA page",
    "start": "915060",
    "end": "917399"
  },
  {
    "text": "out freeze the cache line that we want",
    "start": "917399",
    "end": "919620"
  },
  {
    "text": "to leak and by selecting the cache line",
    "start": "919620",
    "end": "921660"
  },
  {
    "text": "we can then select the register that we",
    "start": "921660",
    "end": "923220"
  },
  {
    "text": "want to leak and then like dump the",
    "start": "923220",
    "end": "925019"
  },
  {
    "text": "Epica dump this stuff that we want to",
    "start": "925019",
    "end": "927420"
  },
  {
    "text": "leak and then move it back exactly and",
    "start": "927420",
    "end": "930180"
  },
  {
    "text": "as you remember they are blind spots so",
    "start": "930180",
    "end": "932699"
  },
  {
    "text": "there's actually a few spots where we",
    "start": "932699",
    "end": "935279"
  },
  {
    "text": "can't leak data from and this also maps",
    "start": "935279",
    "end": "937500"
  },
  {
    "text": "to registers where we can't leak from so",
    "start": "937500",
    "end": "939839"
  },
  {
    "text": "we have some general purpose registers",
    "start": "939839",
    "end": "941579"
  },
  {
    "text": "where we only leak partially content but",
    "start": "941579",
    "end": "944279"
  },
  {
    "text": "also some registers we can't leak",
    "start": "944279",
    "end": "946440"
  },
  {
    "text": "completely okay that's interesting",
    "start": "946440",
    "end": "949199"
  },
  {
    "text": "what is happening",
    "start": "949199",
    "end": "951899"
  },
  {
    "text": "you know what it is it's demo time oh",
    "start": "951899",
    "end": "954120"
  },
  {
    "text": "that's cool when you're leaking these",
    "start": "954120",
    "end": "955800"
  },
  {
    "text": "lights from an enclave yes",
    "start": "955800",
    "end": "958260"
  },
  {
    "text": "so let's try this",
    "start": "958260",
    "end": "961880"
  },
  {
    "text": "so I'm trying something risky here I'm",
    "start": "966720",
    "end": "969959"
  },
  {
    "text": "connecting I'm SSH connected to a system",
    "start": "969959",
    "end": "972360"
  },
  {
    "text": "in our home country and I have here a",
    "start": "972360",
    "end": "975360"
  },
  {
    "text": "few things in that folder so we can see",
    "start": "975360",
    "end": "977519"
  },
  {
    "text": "here that there's an AES Enclave so this",
    "start": "977519",
    "end": "980399"
  },
  {
    "text": "a is an enclave uses the as9 instruction",
    "start": "980399",
    "end": "982980"
  },
  {
    "text": "set to perform as encryptions",
    "start": "982980",
    "end": "985980"
  },
  {
    "text": "that's interesting so asni is a special",
    "start": "985980",
    "end": "988079"
  },
  {
    "text": "instruction set for like x86 CPUs where",
    "start": "988079",
    "end": "991320"
  },
  {
    "text": "the as encryption and encryption steps",
    "start": "991320",
    "end": "993420"
  },
  {
    "text": "are implemented in arduer and this is",
    "start": "993420",
    "end": "995519"
  },
  {
    "text": "really like resistant to like all",
    "start": "995519",
    "end": "998339"
  },
  {
    "text": "different attacks like side channels or",
    "start": "998339",
    "end": "1000079"
  },
  {
    "text": "like also like different yes and one and",
    "start": "1000079",
    "end": "1003920"
  },
  {
    "text": "one specific instruction in the ASI",
    "start": "1003920",
    "end": "1005779"
  },
  {
    "text": "instruction set is the ASN key Gan",
    "start": "1005779",
    "end": "1008180"
  },
  {
    "text": "assist so this instruction is used in",
    "start": "1008180",
    "end": "1010279"
  },
  {
    "text": "order to generate the round keys from",
    "start": "1010279",
    "end": "1012199"
  },
  {
    "text": "the root key so if you now take a look",
    "start": "1012199",
    "end": "1013940"
  },
  {
    "text": "at that enclave and simply disassemble",
    "start": "1013940",
    "end": "1015920"
  },
  {
    "text": "it and search for the instruction which",
    "start": "1015920",
    "end": "1017660"
  },
  {
    "text": "is called vas Tegan assist we will find",
    "start": "1017660",
    "end": "1020420"
  },
  {
    "text": "it at some point insert the enclave and",
    "start": "1020420",
    "end": "1022880"
  },
  {
    "text": "for our attack to work we now know that",
    "start": "1022880",
    "end": "1025520"
  },
  {
    "text": "at this point inside the code execution",
    "start": "1025520",
    "end": "1027620"
  },
  {
    "text": "of The Enclave in the richest xmm0 will",
    "start": "1027620",
    "end": "1030860"
  },
  {
    "text": "be the key for that encryption so if we",
    "start": "1030860",
    "end": "1033740"
  },
  {
    "text": "stop The Enclave at that moment then the",
    "start": "1033740",
    "end": "1036860"
  },
  {
    "text": "SSA page at the offset where XS X xmm0",
    "start": "1036860",
    "end": "1041178"
  },
  {
    "text": "register is stored it will contain the",
    "start": "1041179",
    "end": "1043579"
  },
  {
    "text": "private key that we want to leak yes so",
    "start": "1043579",
    "end": "1046459"
  },
  {
    "text": "in order to perform our Tech we need two",
    "start": "1046459",
    "end": "1048558"
  },
  {
    "text": "components first we need to locate the",
    "start": "1048559",
    "end": "1050720"
  },
  {
    "text": "page offset at which this instruction is",
    "start": "1050720",
    "end": "1052580"
  },
  {
    "text": "located so in our case it's the page 20",
    "start": "1052580",
    "end": "1054740"
  },
  {
    "text": "inside the enclave and we also need to",
    "start": "1054740",
    "end": "1057679"
  },
  {
    "text": "know the at which instruction we have to",
    "start": "1057679",
    "end": "1060200"
  },
  {
    "text": "stop so basically the how the end of",
    "start": "1060200",
    "end": "1062600"
  },
  {
    "text": "instruction on the page I don't show you",
    "start": "1062600",
    "end": "1064460"
  },
  {
    "text": "this it's the third infrastructure on",
    "start": "1064460",
    "end": "1066020"
  },
  {
    "text": "the page because there's stuff in the",
    "start": "1066020",
    "end": "1067760"
  },
  {
    "text": "beginning and now we simply",
    "start": "1067760",
    "end": "1070100"
  },
  {
    "text": "simply edit a config so we should create",
    "start": "1070100",
    "end": "1072440"
  },
  {
    "text": "a config file and we add there that we",
    "start": "1072440",
    "end": "1074960"
  },
  {
    "text": "want to Target this 20th page in The sjx",
    "start": "1074960",
    "end": "1078020"
  },
  {
    "text": "Enclave we want to Target the first unit",
    "start": "1078020",
    "end": "1079940"
  },
  {
    "text": "of instruction inside the page and we",
    "start": "1079940",
    "end": "1082280"
  },
  {
    "text": "want to leak xlm m0 so now we can like",
    "start": "1082280",
    "end": "1085160"
  },
  {
    "text": "wrap the enclave and stop it precisely",
    "start": "1085160",
    "end": "1087799"
  },
  {
    "text": "at the point where we want to leak the",
    "start": "1087799",
    "end": "1089480"
  },
  {
    "text": "data",
    "start": "1089480",
    "end": "1091700"
  },
  {
    "text": "so and if we now execute our attack",
    "start": "1091700",
    "end": "1093799"
  },
  {
    "text": "program",
    "start": "1093799",
    "end": "1094880"
  },
  {
    "text": "yes I want to pasteurope",
    "start": "1094880",
    "end": "1097520"
  },
  {
    "text": "we can see that we directly recovered",
    "start": "1097520",
    "end": "1100280"
  },
  {
    "text": "the as an I key of that encryption and",
    "start": "1100280",
    "end": "1102620"
  },
  {
    "text": "you'll see how fast was that this is",
    "start": "1102620",
    "end": "1105380"
  },
  {
    "text": "like showing that this is not like a",
    "start": "1105380",
    "end": "1106940"
  },
  {
    "text": "Transit execution attack where you have",
    "start": "1106940",
    "end": "1108440"
  },
  {
    "text": "to employ site Channel and lick the",
    "start": "1108440",
    "end": "1110419"
  },
  {
    "text": "stuff that is like noisy and slow this",
    "start": "1110419",
    "end": "1112820"
  },
  {
    "text": "is architectural leak so you dump it and",
    "start": "1112820",
    "end": "1115100"
  },
  {
    "text": "that's it and if you know take a look at",
    "start": "1115100",
    "end": "1117440"
  },
  {
    "text": "if you dump the key out of the actual",
    "start": "1117440",
    "end": "1119539"
  },
  {
    "text": "source code of The Enclave we can see",
    "start": "1119539",
    "end": "1121460"
  },
  {
    "text": "that the key parts from the byte 4 to 15",
    "start": "1121460",
    "end": "1124280"
  },
  {
    "text": "actually match the as Nike used in this",
    "start": "1124280",
    "end": "1126679"
  },
  {
    "text": "example and you might be wondering now",
    "start": "1126679",
    "end": "1128539"
  },
  {
    "text": "so we can see that the xmm0 register has",
    "start": "1128539",
    "end": "1131419"
  },
  {
    "text": "this blind spot however if you think",
    "start": "1131419",
    "end": "1133640"
  },
  {
    "text": "about it this is just one position in",
    "start": "1133640",
    "end": "1136400"
  },
  {
    "text": "the code where we leaked already three",
    "start": "1136400",
    "end": "1138080"
  },
  {
    "text": "quarters of the secret key the key",
    "start": "1138080",
    "end": "1140360"
  },
  {
    "text": "travels through a lot more code in order",
    "start": "1140360",
    "end": "1142880"
  },
  {
    "text": "to be at that position so we can combine",
    "start": "1142880",
    "end": "1145100"
  },
  {
    "text": "multiple leakage sources in order to",
    "start": "1145100",
    "end": "1146840"
  },
  {
    "text": "recover the remaining four parts as we",
    "start": "1146840",
    "end": "1148760"
  },
  {
    "text": "did in the publication of someone",
    "start": "1148760",
    "end": "1151960"
  },
  {
    "text": "so that brings us back to the",
    "start": "1155660",
    "end": "1157880"
  },
  {
    "text": "presentation and I can skip the backup",
    "start": "1157880",
    "end": "1159919"
  },
  {
    "text": "videos so I'm amazed it worked for the",
    "start": "1159919",
    "end": "1162080"
  },
  {
    "text": "first time yes I'm also missed so let's",
    "start": "1162080",
    "end": "1165260"
  },
  {
    "text": "talk about mitigations so we have seen",
    "start": "1165260",
    "end": "1167059"
  },
  {
    "text": "that we can precisely Target and leak",
    "start": "1167059",
    "end": "1169640"
  },
  {
    "text": "um secret information stored in",
    "start": "1169640",
    "end": "1171020"
  },
  {
    "text": "registers we can dump Enclave pages but",
    "start": "1171020",
    "end": "1173360"
  },
  {
    "text": "how can we protect against it yes this",
    "start": "1173360",
    "end": "1175460"
  },
  {
    "text": "is a really powerful attack that needs",
    "start": "1175460",
    "end": "1177799"
  },
  {
    "text": "to be mitigated and Intel release",
    "start": "1177799",
    "end": "1179660"
  },
  {
    "text": "mitigations for that obviously and okay",
    "start": "1179660",
    "end": "1182000"
  },
  {
    "text": "the first thing is to recommend to",
    "start": "1182000",
    "end": "1184460"
  },
  {
    "text": "disable the Epic mmio region",
    "start": "1184460",
    "end": "1187280"
  },
  {
    "text": "this is like closing literally the",
    "start": "1187280",
    "end": "1189320"
  },
  {
    "text": "attack surface for that if we like look",
    "start": "1189320",
    "end": "1191600"
  },
  {
    "text": "at it in like with respect to like",
    "start": "1191600",
    "end": "1193700"
  },
  {
    "text": "another advisor that may map the Epic",
    "start": "1193700",
    "end": "1195500"
  },
  {
    "text": "mmao region but obviously this is not",
    "start": "1195500",
    "end": "1197960"
  },
  {
    "text": "enough so in in practice this mitigation",
    "start": "1197960",
    "end": "1200360"
  },
  {
    "text": "will enable X2 apic that's like a newer",
    "start": "1200360",
    "end": "1203360"
  },
  {
    "text": "version for epic and this is also faster",
    "start": "1203360",
    "end": "1205400"
  },
  {
    "text": "so it's like highly recommended but this",
    "start": "1205400",
    "end": "1208340"
  },
  {
    "text": "is not enough for like sgx enclaves",
    "start": "1208340",
    "end": "1210440"
  },
  {
    "text": "where like a malicious operating system",
    "start": "1210440",
    "end": "1212179"
  },
  {
    "text": "can just like not disable epic Mio and",
    "start": "1212179",
    "end": "1215360"
  },
  {
    "text": "just like bypass this mitigation so",
    "start": "1215360",
    "end": "1217340"
  },
  {
    "text": "Intel also released micro code patches",
    "start": "1217340",
    "end": "1219559"
  },
  {
    "text": "and this patches Flash the super Q on",
    "start": "1219559",
    "end": "1222380"
  },
  {
    "text": "like all the sgx transitions so that you",
    "start": "1222380",
    "end": "1225200"
  },
  {
    "text": "can if you like try to move the page in",
    "start": "1225200",
    "end": "1227539"
  },
  {
    "text": "and out then you will not have the data",
    "start": "1227539",
    "end": "1229520"
  },
  {
    "text": "in the super queue that you want to leak",
    "start": "1229520",
    "end": "1231260"
  },
  {
    "text": "yeah and as always one one suggested",
    "start": "1231260",
    "end": "1233720"
  },
  {
    "text": "mitigation of the general rule of thumb",
    "start": "1233720",
    "end": "1236059"
  },
  {
    "text": "basically is if you use HX you should",
    "start": "1236059",
    "end": "1238100"
  },
  {
    "text": "also disable hyper threading why because",
    "start": "1238100",
    "end": "1240380"
  },
  {
    "text": "if you know consider these super Q",
    "start": "1240380",
    "end": "1242299"
  },
  {
    "text": "flashes and they only flush during",
    "start": "1242299",
    "end": "1244100"
  },
  {
    "text": "entering exit of this HDX Enclave the",
    "start": "1244100",
    "end": "1246559"
  },
  {
    "text": "hyper thread can still be running in",
    "start": "1246559",
    "end": "1248780"
  },
  {
    "text": "between those Transitions and leaked",
    "start": "1248780",
    "end": "1250520"
  },
  {
    "text": "data over the super queue yes exactly so",
    "start": "1250520",
    "end": "1253160"
  },
  {
    "text": "for who is interested this is the",
    "start": "1253160",
    "end": "1254780"
  },
  {
    "text": "timeline we discovered this attack in",
    "start": "1254780",
    "end": "1256160"
  },
  {
    "text": "December and like it was embargoed until",
    "start": "1256160",
    "end": "1258380"
  },
  {
    "text": "yesterday when it went public",
    "start": "1258380",
    "end": "1261620"
  },
  {
    "text": "so that brings us to the conclusion so",
    "start": "1261620",
    "end": "1264260"
  },
  {
    "text": "we have seen that by reading unaligned",
    "start": "1264260",
    "end": "1266480"
  },
  {
    "text": "memory from the Epic we can actually",
    "start": "1266480",
    "end": "1268880"
  },
  {
    "text": "leak data and code we have seen some",
    "start": "1268880",
    "end": "1271100"
  },
  {
    "text": "techniques so we can extend those",
    "start": "1271100",
    "end": "1272480"
  },
  {
    "text": "leakage to precisely Target cache lines",
    "start": "1272480",
    "end": "1275000"
  },
  {
    "text": "inside an enclave to jump registers and",
    "start": "1275000",
    "end": "1277340"
  },
  {
    "text": "even data pages so overall we say that",
    "start": "1277340",
    "end": "1279500"
  },
  {
    "text": "epic league is the first architecture",
    "start": "1279500",
    "end": "1281000"
  },
  {
    "text": "leak that is capable of leaking stale",
    "start": "1281000",
    "end": "1283039"
  },
  {
    "text": "data from the super queue it does not",
    "start": "1283039",
    "end": "1284960"
  },
  {
    "text": "require rapid trading even if we can",
    "start": "1284960",
    "end": "1286880"
  },
  {
    "text": "exploit other trading to improve our",
    "start": "1286880",
    "end": "1288559"
  },
  {
    "text": "attack and it affects like most recent",
    "start": "1288559",
    "end": "1291140"
  },
  {
    "text": "Intel CPUs if you want to learn more",
    "start": "1291140",
    "end": "1293059"
  },
  {
    "text": "about the attack you can go to",
    "start": "1293059",
    "end": "1294320"
  },
  {
    "text": "epicly.com or even read our paper that",
    "start": "1294320",
    "end": "1296900"
  },
  {
    "text": "will be published using in two days",
    "start": "1296900",
    "end": "1299299"
  },
  {
    "text": "yes so thank you for your attention",
    "start": "1299299",
    "end": "1302700"
  },
  {
    "text": "[Music]",
    "start": "1302700",
    "end": "1305809"
  },
  {
    "text": "[Music]",
    "start": "1309660",
    "end": "1312759"
  }
]