[
  {
    "text": "good afternoon welcome to internet scale analysis of AWS cognitive security in",
    "start": "30",
    "end": "5069"
  },
  {
    "text": "Mandalay Bay Rome Lagoon JKL with undress Rancho before we begin I have a",
    "start": "5069",
    "end": "11849"
  },
  {
    "text": "few brief notes stop by the business co-located in Mandalay Bay Oceanside and shoreline ballrooms on level 2 during",
    "start": "11849",
    "end": "19619"
  },
  {
    "text": "the day in the Welcome Reception at 5:30 p.m. tonight the blackhead Arsenal is in a business hall on level 2",
    "start": "19619",
    "end": "25619"
  },
  {
    "text": "join us for the pony Awards in lagoon JKL at 6:30 p.m. is in this room and",
    "start": "25619",
    "end": "31170"
  },
  {
    "text": "thank you for putting your phones on vibrate thank you so much hi everybody",
    "start": "31170",
    "end": "36780"
  },
  {
    "text": "good afternoon today I'm going to be talking about an internet scale analysis",
    "start": "36780",
    "end": "42540"
  },
  {
    "text": "of AWS comido first we are going to start with patient zero",
    "start": "42540",
    "end": "49980"
  },
  {
    "text": "the first vulnerability that I found and then we are going to extend it to",
    "start": "49980",
    "end": "55039"
  },
  {
    "text": "internet scale so I was performing a cloud security assessment on one of my",
    "start": "55039",
    "end": "61890"
  },
  {
    "text": "customers and as part of that assessment I got read-only credentials for their",
    "start": "61890",
    "end": "69080"
  },
  {
    "text": "AWS account using those credentials I",
    "start": "69080",
    "end": "74090"
  },
  {
    "text": "enumerated all of the permissions all of the services that were in use by that",
    "start": "74090",
    "end": "81600"
  },
  {
    "text": "account in that list and as you know Elias has a lot of services in the list",
    "start": "81600",
    "end": "89369"
  },
  {
    "text": "something caught my eye comedian I never seen that before and",
    "start": "89369",
    "end": "95250"
  },
  {
    "text": "it's not a very common service so that's the logo for comedo I had no idea what",
    "start": "95250",
    "end": "103530"
  },
  {
    "text": "it was so I went to the documentation like any good hacker and the",
    "start": "103530",
    "end": "111450"
  },
  {
    "text": "documentation showed me something beautiful one line that made my day that",
    "start": "111450",
    "end": "118829"
  },
  {
    "text": "line said identity pools which are a component of kognito enable you the",
    "start": "118829",
    "end": "127439"
  },
  {
    "text": "developer to grant you your users access to a degree",
    "start": "127439",
    "end": "133370"
  },
  {
    "text": "services so the developer grants and users access to s3 buckets DynamoDB",
    "start": "133370",
    "end": "143420"
  },
  {
    "text": "tables and almost any other resource in the AWS account what could go wrong so",
    "start": "143420",
    "end": "155120"
  },
  {
    "text": "during this assessment I was able to gain full access to the AWS account",
    "start": "155120",
    "end": "163510"
  },
  {
    "text": "exploiting Cognito misconfigurations and I'm going to first explain how I did",
    "start": "163510",
    "end": "170959"
  },
  {
    "text": "it and then we're going to try to automate that process the first thing",
    "start": "170959",
    "end": "177079"
  },
  {
    "text": "that I did was to use my read-only credentials to extract the identity pool",
    "start": "177079",
    "end": "186709"
  },
  {
    "text": "ID which is what you see there in red from the AWS console I extracted the ID",
    "start": "186709",
    "end": "194180"
  },
  {
    "text": "and I used it in this function this function is going to take an identity",
    "start": "194180",
    "end": "202459"
  },
  {
    "text": "poetry and return AWS credentials because that's how commit the works it's",
    "start": "202459",
    "end": "210590"
  },
  {
    "text": "going to give end-users AWS credentials with some associated permissions from",
    "start": "210590",
    "end": "219230"
  },
  {
    "text": "now on for you guys this is just a black box you enter identity polity and you",
    "start": "219230",
    "end": "225260"
  },
  {
    "text": "get credentials the next step that I took in order to own that AWS account",
    "start": "225260",
    "end": "232599"
  },
  {
    "text": "were to enumerate permissions because I have treated I have credentials but I",
    "start": "232599",
    "end": "240290"
  },
  {
    "text": "had no idea which actions I could take with those functions so I enumerated",
    "start": "240290",
    "end": "247639"
  },
  {
    "text": "permissions and then use different privilege escalation techniques to gain",
    "start": "247639",
    "end": "253910"
  },
  {
    "text": "access to elevate privileges and gain access to the AWS account that was great",
    "start": "253910",
    "end": "261169"
  },
  {
    "text": "my customer was happy I was happy and I learn and a lot in the process and I finished",
    "start": "261169",
    "end": "270890"
  },
  {
    "text": "my report and I was asking myself all right I got one I was able to exploit",
    "start": "270890",
    "end": "277730"
  },
  {
    "text": "one miss configuration in a dahlias commit Oh are there any other so this is",
    "start": "277730",
    "end": "287690"
  },
  {
    "text": "what kick-started my research how many customers were at risk how common is",
    "start": "287690",
    "end": "294740"
  },
  {
    "text": "this how many developers are Miss configuring AWS Cognito and is it",
    "start": "294740",
    "end": "303590"
  },
  {
    "text": "possible to actually measure this and answer the questions that I'm making myself of course I'm here so yeah it's",
    "start": "303590",
    "end": "312620"
  },
  {
    "text": "possible this is what's next I'm going to try to explain enough five minutes",
    "start": "312620",
    "end": "322630"
  },
  {
    "text": "camellia and how it can be misconfigured then I'm going to show you how to grab",
    "start": "322630",
    "end": "329420"
  },
  {
    "text": "the internet which is great then I'm going to show you results for this",
    "start": "329420",
    "end": "335270"
  },
  {
    "text": "analysis and perform root cause analysis try to understand why this happens",
    "start": "335270",
    "end": "342880"
  },
  {
    "text": "introduction to a SS Camino basically there are two main components user pools",
    "start": "342880",
    "end": "350870"
  },
  {
    "text": "and identity poles user pools store all",
    "start": "350870",
    "end": "356750"
  },
  {
    "text": "the users it's a directory identity pools provide",
    "start": "356750",
    "end": "362590"
  },
  {
    "text": "AWS credentials for authenticating users in the de Graaff you can see how the",
    "start": "362590",
    "end": "370160"
  },
  {
    "text": "mobile application talks first to the user pole and authenticates in some way",
    "start": "370160",
    "end": "376600"
  },
  {
    "text": "then talks to that identity pool in order to get AWS credentials and finally",
    "start": "376600",
    "end": "384710"
  },
  {
    "text": "the mobile application consumes AWS services as three dynamodb lambda",
    "start": "384710",
    "end": "392150"
  },
  {
    "text": "functions water in order to understand",
    "start": "392150",
    "end": "398210"
  },
  {
    "text": "this it's easier if we get a new skates let's",
    "start": "398210",
    "end": "403939"
  },
  {
    "text": "imagine a sample application this application is just cool topics it",
    "start": "403939",
    "end": "410330"
  },
  {
    "text": "allows users to upload pictures of their cats because cats are cool and this",
    "start": "410330",
    "end": "417650"
  },
  {
    "text": "sample application allows users to directly upload to s3 all of the images",
    "start": "417650",
    "end": "426099"
  },
  {
    "text": "and also the metadata like the name of your cat goes to DynamoDB tables so",
    "start": "426099",
    "end": "434810"
  },
  {
    "text": "there is no server in between the mobile application is directly consuming AWS",
    "start": "434810",
    "end": "442009"
  },
  {
    "text": "services writing to s3 writing to DynamoDB tables and all of this is",
    "start": "442009",
    "end": "447919"
  },
  {
    "text": "possible because of cabeza also this application uses cognitive for",
    "start": "447919",
    "end": "454810"
  },
  {
    "text": "authentication there's something special about this application that two",
    "start": "454810",
    "end": "460639"
  },
  {
    "text": "different user roles authenticated users can upload new pictures and",
    "start": "460639",
    "end": "468639"
  },
  {
    "text": "authenticated users can only read pictures that were previously uploaded",
    "start": "468639",
    "end": "474310"
  },
  {
    "text": "so remember that i authenticated and unauthenticated and they have different",
    "start": "474310",
    "end": "480409"
  },
  {
    "text": "permissions all of this is done using the AWS SDK which is available for",
    "start": "480409",
    "end": "490810"
  },
  {
    "text": "Android and for iOS those SDKs are used",
    "start": "490810",
    "end": "495919"
  },
  {
    "text": "to consume the ATIS and to make the life of the with developers easier if you",
    "start": "495919",
    "end": "504529"
  },
  {
    "text": "want to have the same application in your browser that's totally possible and",
    "start": "504529",
    "end": "509800"
  },
  {
    "text": "in order to do that you need to use the JavaScript SDK in that case instead of a",
    "start": "509800",
    "end": "518149"
  },
  {
    "text": "mobile application consuming API from Amazon you have your browser running",
    "start": "518149",
    "end": "524600"
  },
  {
    "text": "JavaScript consuming those aps in a direct way",
    "start": "524600",
    "end": "531310"
  },
  {
    "text": "when a developer is creating a new identity pool this is what he sees he's",
    "start": "531850",
    "end": "539290"
  },
  {
    "text": "going to see a form with three inputs the identity pool name that's easy an",
    "start": "539290",
    "end": "547260"
  },
  {
    "text": "authentication provider he needs to choose how he is going to authenticate",
    "start": "547260",
    "end": "552730"
  },
  {
    "text": "users Facebook Google whatever and then something that's going to be interesting",
    "start": "552730",
    "end": "560110"
  },
  {
    "text": "for us and authenticated identities is this identity pool going to have or",
    "start": "560110",
    "end": "569100"
  },
  {
    "text": "going to add support for and authenticated identities so users that",
    "start": "569100",
    "end": "575740"
  },
  {
    "text": "never go through the authentication provider can still get AWS credentials",
    "start": "575740",
    "end": "584850"
  },
  {
    "text": "once the developer finishes that form the next step is here and he needs to",
    "start": "585240",
    "end": "593050"
  },
  {
    "text": "assign I am roles to kognito identities",
    "start": "593050",
    "end": "598090"
  },
  {
    "text": "I am roles are like users to summarize",
    "start": "598090",
    "end": "603310"
  },
  {
    "text": "are like users in AWS so a role has",
    "start": "603310",
    "end": "609760"
  },
  {
    "text": "permissions and the developer needs to assign different permissions for the",
    "start": "609760",
    "end": "616470"
  },
  {
    "text": "authenticated identity and for the unauthenticated identity permissions in",
    "start": "616470",
    "end": "625950"
  },
  {
    "text": "AWS are defined like this with policies in this policy we see how we are",
    "start": "625950",
    "end": "634510"
  },
  {
    "text": "allowing a stirry list bucket on a specific bucket name and a 3-star object",
    "start": "634510",
    "end": "642700"
  },
  {
    "text": "on that same bucket so the developer needs to create a policy to restrict the",
    "start": "642700",
    "end": "649300"
  },
  {
    "text": "permissions for each of those identities the authenticated one and the",
    "start": "649300",
    "end": "655210"
  },
  {
    "text": "unauthenticated one once he does that we",
    "start": "655210",
    "end": "661720"
  },
  {
    "text": "get the final screen we see as developers the identity",
    "start": "661720",
    "end": "667810"
  },
  {
    "text": "polarity ID it's ready to use it's 100% configured all good so",
    "start": "667810",
    "end": "678210"
  },
  {
    "text": "something to know this before I go to internet scale is that these IDs are",
    "start": "678210",
    "end": "685470"
  },
  {
    "text": "randomly generated I'm talking about these that are in red in that screenshot",
    "start": "685470",
    "end": "691800"
  },
  {
    "text": "those are these are unique IDs randomly generated it's impossible for me as an",
    "start": "691800",
    "end": "698440"
  },
  {
    "text": "attacker to guess one of those IDs I need to extract them from somewhere all",
    "start": "698440",
    "end": "706870"
  },
  {
    "text": "right now internet scale how I took all of this knowledge to analyze the",
    "start": "706870",
    "end": "714940"
  },
  {
    "text": "internet so this code snippet shows what",
    "start": "714940",
    "end": "720490"
  },
  {
    "text": "I did and of course I have function there that says get identity polls from",
    "start": "720490",
    "end": "727870"
  },
  {
    "text": "the internet that doesn't sound very doable but bear with me for a minute",
    "start": "727870",
    "end": "734580"
  },
  {
    "text": "so for each of the identity pools that we get from the internet I'm going to",
    "start": "734580",
    "end": "741940"
  },
  {
    "text": "get the credentials using the function that we saw before in one of the first",
    "start": "741940",
    "end": "747610"
  },
  {
    "text": "slides then enumerate the permissions for those credentials and in some way we",
    "start": "747610",
    "end": "756340"
  },
  {
    "text": "want to score those permissions we want to know if they are good bad insecure or",
    "start": "756340",
    "end": "763180"
  },
  {
    "text": "secure and with all of that information we want to do pretty graphs and go to a",
    "start": "763180",
    "end": "770110"
  },
  {
    "text": "conference so first challenge identity",
    "start": "770110",
    "end": "775240"
  },
  {
    "text": "pool IDs are randomly generated I can't simply guess them they are too",
    "start": "775240",
    "end": "784570"
  },
  {
    "text": "long to run randomly generated so I need to extract them from somewhere and that",
    "start": "784570",
    "end": "791110"
  },
  {
    "text": "somewhere was maybe the Google Play Store but also some other",
    "start": "791110",
    "end": "798370"
  },
  {
    "text": "resources like the common crow github and so on my first approach was to",
    "start": "798370",
    "end": "807660"
  },
  {
    "text": "download all of the applications from Google Play decompile them and extract",
    "start": "807660",
    "end": "816639"
  },
  {
    "text": "identity pool IDs from those files using crap that doesn't work Google Play has",
    "start": "816639",
    "end": "827499"
  },
  {
    "text": "2.6 million applications and that's a lot and they have protections against",
    "start": "827499",
    "end": "837959"
  },
  {
    "text": "automating downloading of all of the applications so it's not easy at least I",
    "start": "837959",
    "end": "845290"
  },
  {
    "text": "had a week for this research so it's not easy to automate the whole process in",
    "start": "845290",
    "end": "852240"
  },
  {
    "text": "industry or download 2.6 million applications so I had to use something",
    "start": "852240",
    "end": "858220"
  },
  {
    "text": "different what I was really interested in was the mobile applications that use",
    "start": "858220",
    "end": "866319"
  },
  {
    "text": "the AWS SDK so I found a service",
    "start": "866319",
    "end": "872499"
  },
  {
    "text": "provider that allowed me to filter by those applications that service provider",
    "start": "872499",
    "end": "878559"
  },
  {
    "text": "allows you to search through all of the applications in the Google Play Store",
    "start": "878559",
    "end": "884589"
  },
  {
    "text": "and gives you a result of the ones that use the libraries that you want with",
    "start": "884589",
    "end": "890589"
  },
  {
    "text": "that I got 13,000 applications and downloaded the applications from",
    "start": "890589",
    "end": "897600"
  },
  {
    "text": "alternative sources apk pure and apk mirror those don't have as many",
    "start": "897600",
    "end": "903779"
  },
  {
    "text": "limitations and controls as the Google Play Store so I got all of those",
    "start": "903779",
    "end": "910839"
  },
  {
    "text": "applications I was able to extract a lot of identity pools and I was ready to",
    "start": "910839",
    "end": "917399"
  },
  {
    "text": "based on that information get credentials then I moved into the",
    "start": "917399",
    "end": "925059"
  },
  {
    "text": "internet because if you remember from my use case the",
    "start": "925059",
    "end": "931750"
  },
  {
    "text": "meter service can be consumed by mobile applications and by JavaScript",
    "start": "931750",
    "end": "936970"
  },
  {
    "text": "applications running in browsers so I was wondering how many web applications",
    "start": "936970",
    "end": "942310"
  },
  {
    "text": "were using kameido and in order to do that I started to Google and I try to",
    "start": "942310",
    "end": "950650"
  },
  {
    "text": "Google for Cognito identity credentials the thing is that Google does an index",
    "start": "950650",
    "end": "956980"
  },
  {
    "text": "the contents of script tags and it will not own index attributes like the ones",
    "start": "956980",
    "end": "965800"
  },
  {
    "text": "that we see in the first part here that says Amazon commit identity domain dot",
    "start": "965800",
    "end": "970810"
  },
  {
    "text": "J's so if you search for that you're not going to find sites that use it you're",
    "start": "970810",
    "end": "979540"
  },
  {
    "text": "going to find blog posts that mention how to create sites with true needle so",
    "start": "979540",
    "end": "986740"
  },
  {
    "text": "I really needed a way to grab the Internet",
    "start": "986740",
    "end": "992350"
  },
  {
    "text": "I needed a way to do exactly that",
    "start": "992350",
    "end": "997540"
  },
  {
    "text": "like grab some territory were the whole internet was and we all know that that",
    "start": "997540",
    "end": "1005850"
  },
  {
    "text": "was practiced but yeah actually it exists so common crow is an open",
    "start": "1005850",
    "end": "1018330"
  },
  {
    "text": "repository of web crawl data comic roll",
    "start": "1018330",
    "end": "1023449"
  },
  {
    "text": "stores 2.5 billion web pages they curl",
    "start": "1023449",
    "end": "1029910"
  },
  {
    "text": "the internet and they store it for you to analyze it's free you can access this",
    "start": "1029910",
    "end": "1037079"
  },
  {
    "text": "information this data set for free and that's what I used I instead of grabbing",
    "start": "1037079",
    "end": "1045360"
  },
  {
    "text": "the internet I grabbed common crop common core has 2.5 billion web pages",
    "start": "1045360",
    "end": "1052520"
  },
  {
    "text": "that's more than enough for my research I tried first with existing tools",
    "start": "1052520",
    "end": "1059420"
  },
  {
    "text": "there's one called CC Empire job",
    "start": "1059420",
    "end": "1064890"
  },
  {
    "text": "which uses elastic MapReduce in order to",
    "start": "1064890",
    "end": "1070200"
  },
  {
    "text": "process the contents of common crawl but that had some stability issues there or",
    "start": "1070200",
    "end": "1078210"
  },
  {
    "text": "handling was really bad so I had to create my own I created something called",
    "start": "1078210",
    "end": "1083820"
  },
  {
    "text": "CC lambda Common Core lambda that uses a WS lambda to apply regular expressions",
    "start": "1083820",
    "end": "1092490"
  },
  {
    "text": "to the common crop CC lamda implements",
    "start": "1092490",
    "end": "1098220"
  },
  {
    "text": "that grip that we are seeing there it uses 1000 concurrent a degrees lambda",
    "start": "1098220",
    "end": "1105690"
  },
  {
    "text": "functions running at the same time which are like a lot of processing power to",
    "start": "1105690",
    "end": "1114560"
  },
  {
    "text": "download a piece of the common crow extract like unzip it and then apply",
    "start": "1114560",
    "end": "1122310"
  },
  {
    "text": "regular expressions to all of the 2.5 billion pages all of the results are",
    "start": "1122310",
    "end": "1130380"
  },
  {
    "text": "stored on s3 for you to investigate them this is how CC lambda looks like it's",
    "start": "1130380",
    "end": "1138030"
  },
  {
    "text": "simply you need to code your own function in order to apply your regular",
    "start": "1138030",
    "end": "1144060"
  },
  {
    "text": "expressions and it will extract the info and store it on s3 for each of the",
    "start": "1144060",
    "end": "1152180"
  },
  {
    "text": "chunks of information from comic roll it will take around 3 minutes it's",
    "start": "1152180",
    "end": "1160710"
  },
  {
    "text": "expensive I invested around 300 USD to",
    "start": "1160710",
    "end": "1166920"
  },
  {
    "text": "run common to run cc lambda on common crawl",
    "start": "1166920",
    "end": "1173870"
  },
  {
    "text": "maybe if I use a little bit of performance enhancements I would be able",
    "start": "1173900",
    "end": "1180960"
  },
  {
    "text": "to cut that in half but it would still be expensive so if",
    "start": "1180960",
    "end": "1188070"
  },
  {
    "text": "you use it don't blame me I told you it's expensive other boring sources for",
    "start": "1188070",
    "end": "1196110"
  },
  {
    "text": "identity pools kidnapped some others I just consumed the API and",
    "start": "1196110",
    "end": "1202710"
  },
  {
    "text": "extracted the information so there's nothing new there so at this point I",
    "start": "1202710",
    "end": "1209599"
  },
  {
    "text": "extracted an entity pool IDs from the Google Play Store from the internet and",
    "start": "1209599",
    "end": "1216479"
  },
  {
    "text": "I have all of those identity pulls ready to be used once I got the permission",
    "start": "1216479",
    "end": "1224039"
  },
  {
    "text": "once I got the credentials from those identity pools I had to enumerate the permissions I had",
    "start": "1224039",
    "end": "1232470"
  },
  {
    "text": "simply like API keys and no idea what they were capable of and I wanted to",
    "start": "1232470",
    "end": "1240389"
  },
  {
    "text": "enumerate permissions with some restrictions 32 voice alert and numeric",
    "start": "1240389",
    "end": "1247679"
  },
  {
    "text": "permissions in I am in hello this one is using the I am service the other one is",
    "start": "1247679",
    "end": "1254970"
  },
  {
    "text": "using brute force when you have a set of credentials in an alias you can call the",
    "start": "1254970",
    "end": "1262440"
  },
  {
    "text": "I am a PRI I didn't will tell you which permissions you have but in order to do",
    "start": "1262440",
    "end": "1270899"
  },
  {
    "text": "that you need permissions for I am and in this research none of the credentials",
    "start": "1270899",
    "end": "1278009"
  },
  {
    "text": "that I got had permissions for i/o so I had to do brute force I had to call each",
    "start": "1278009",
    "end": "1285659"
  },
  {
    "text": "and every Adria's API and if the",
    "start": "1285659",
    "end": "1290879"
  },
  {
    "text": "response was forbidden I had no permission if the response was ok this",
    "start": "1290879",
    "end": "1297539"
  },
  {
    "text": "is a list of resources then I have a permission simple brute force the",
    "start": "1297539",
    "end": "1304919"
  },
  {
    "text": "problem here is that you just want to",
    "start": "1304919",
    "end": "1310729"
  },
  {
    "text": "test for read-only api's if I would try",
    "start": "1310729",
    "end": "1318169"
  },
  {
    "text": "to call an API that's going to terminate an ec2 instance just see if it's",
    "start": "1318169",
    "end": "1325590"
  },
  {
    "text": "possible to do it if it works I'm breaking somebody's cloud",
    "start": "1325590",
    "end": "1331980"
  },
  {
    "text": "and that's no good so I had to just enumerate they read only permissions and",
    "start": "1331980",
    "end": "1339620"
  },
  {
    "text": "from that said I had to choose a subset for only the API calls that returned",
    "start": "1339620",
    "end": "1349970"
  },
  {
    "text": "infrastructure metadata not the ones that we turned customer information let",
    "start": "1349970",
    "end": "1357059"
  },
  {
    "text": "me give you an example their infrastructure metadata is lists the",
    "start": "1357059",
    "end": "1363179"
  },
  {
    "text": "names of all the buckets in this account customer information is give me one file",
    "start": "1363179",
    "end": "1371010"
  },
  {
    "text": "that is stored on s3 I didn't want to read customer information I wanted to",
    "start": "1371010",
    "end": "1378390"
  },
  {
    "text": "read just the names of the buckets and all of this is of course to avoid going",
    "start": "1378390",
    "end": "1385140"
  },
  {
    "text": "to jail right nobody wants that so",
    "start": "1385140",
    "end": "1391169"
  },
  {
    "text": "performance I had to do a lot of API calls and the existing tools were pretty",
    "start": "1391169",
    "end": "1399179"
  },
  {
    "text": "bad at performance and they use a single thread they were testing just a subset",
    "start": "1399179",
    "end": "1406980"
  },
  {
    "text": "of the API calls that I wanted to test and actually wanted to test all of the",
    "start": "1406980",
    "end": "1413760"
  },
  {
    "text": "read-only ones try different tools didn't like any of those",
    "start": "1413760",
    "end": "1419700"
  },
  {
    "text": "so I created in my own you see a pattern here I try something I don't like it",
    "start": "1419700",
    "end": "1426090"
  },
  {
    "text": "I create my own like every time I wrote the - it's open-source CC lambda it's",
    "start": "1426090",
    "end": "1433559"
  },
  {
    "text": "also open source enumerate a.m. it uses threads it written Python it allows you",
    "start": "1433559",
    "end": "1441000"
  },
  {
    "text": "to animate permissions for a set of AWS credentials it looks like this you",
    "start": "1441000",
    "end": "1448980"
  },
  {
    "text": "provide the credentials and it will output the different API calls that you",
    "start": "1448980",
    "end": "1455160"
  },
  {
    "text": "can actually perform all right",
    "start": "1455160",
    "end": "1461270"
  },
  {
    "text": "statistics at this point I have a lot of identity",
    "start": "1461270",
    "end": "1471240"
  },
  {
    "text": "Pilates credentials for each of those identity Pilates and a list of",
    "start": "1471240",
    "end": "1479789"
  },
  {
    "text": "permissions associated with each of those connections and I wanted to know",
    "start": "1479789",
    "end": "1485960"
  },
  {
    "text": "if there was a pattern somewhere before",
    "start": "1485960",
    "end": "1492600"
  },
  {
    "text": "we go deep into the result analysis let",
    "start": "1492600",
    "end": "1498360"
  },
  {
    "text": "me explain something here the privileges that I enumerated are only for the",
    "start": "1498360",
    "end": "1507950"
  },
  {
    "text": "unauthenticated role in comedo I did not",
    "start": "1507950",
    "end": "1513570"
  },
  {
    "text": "perform any type of analysis on the authenticate that brought something else",
    "start": "1513570",
    "end": "1521669"
  },
  {
    "text": "to know this and this is kind of common sense the privileges for the",
    "start": "1521669",
    "end": "1528470"
  },
  {
    "text": "unauthenticated role are going to be smaller than the ones associated with",
    "start": "1528470",
    "end": "1534600"
  },
  {
    "text": "the authenticated role so all of the results that we are going to see now",
    "start": "1534600",
    "end": "1539990"
  },
  {
    "text": "would be much worse if I would have done",
    "start": "1539990",
    "end": "1545610"
  },
  {
    "text": "it with the authenticated role most applications that I inspected allow",
    "start": "1545610",
    "end": "1553860"
  },
  {
    "text": "users to sign in create a user in the application and gain access to the",
    "start": "1553860",
    "end": "1561690"
  },
  {
    "text": "authenticated role so it's just one more step I'm lazy I didn't do it so identity",
    "start": "1561690",
    "end": "1573269"
  },
  {
    "text": "pool sources I was able to with the different methods get access to a list",
    "start": "1573269",
    "end": "1580110"
  },
  {
    "text": "of 3100 identity politics those IDs are",
    "start": "1580110",
    "end": "1586980"
  },
  {
    "text": "distributed like that the great majority came from the Play Store then a few came",
    "start": "1586980",
    "end": "1593970"
  },
  {
    "text": "from github common crawl Yandex and so on but those identity pools are not all",
    "start": "1593970",
    "end": "1601190"
  },
  {
    "text": "usable some of them didn't exist at some",
    "start": "1601190",
    "end": "1607110"
  },
  {
    "text": "point they existed someone created a mobile application they used it then the moral application",
    "start": "1607110",
    "end": "1615110"
  },
  {
    "text": "failed they turn down the AWS account associated with the moil application",
    "start": "1615110",
    "end": "1621720"
  },
  {
    "text": "they simply don't exist anymore others 300 around 300 only allow our",
    "start": "1621720",
    "end": "1630920"
  },
  {
    "text": "authenticated robes they don't allow and authenticate the codes and I checked for",
    "start": "1630920",
    "end": "1638070"
  },
  {
    "text": "that and some others around 100 had an invalid configuration at one point they",
    "start": "1638070",
    "end": "1645750"
  },
  {
    "text": "for example remove the I am role associated with they authenticated or",
    "start": "1645750",
    "end": "1653430"
  },
  {
    "text": "the unauthenticated identity incognito so they broke the cognitive",
    "start": "1653430",
    "end": "1659370"
  },
  {
    "text": "configuration so at the end this research is based on 2500 identity pools",
    "start": "1659370",
    "end": "1667950"
  },
  {
    "text": "which is quite a good number to country conclusions something that I really",
    "start": "1667950",
    "end": "1678150"
  },
  {
    "text": "struggled with was how do I turn a permission set as secure or insecure",
    "start": "1678150",
    "end": "1690140"
  },
  {
    "text": "each application has its own set of requirements each application needs a",
    "start": "1690290",
    "end": "1696480"
  },
  {
    "text": "different set of permissions so just one",
    "start": "1696480",
    "end": "1702510"
  },
  {
    "text": "permission here being enabled doesn't really really need to be insecure and",
    "start": "1702510",
    "end": "1709020"
  },
  {
    "text": "the other application and the other way around but I was able to identify some",
    "start": "1709020",
    "end": "1715530"
  },
  {
    "text": "API calls that in my opinion are always an indicator of insecure configurations",
    "start": "1715530",
    "end": "1724610"
  },
  {
    "text": "so let me show you which API calls those are first",
    "start": "1724610",
    "end": "1731879"
  },
  {
    "text": "three list buckets in 1 out of 5",
    "start": "1731879",
    "end": "1738079"
  },
  {
    "text": "identity pools I was able to run s3 in these buckets and let's analyze why",
    "start": "1738079",
    "end": "1746669"
  },
  {
    "text": "that's bad when we are in a mobile application in the sample application",
    "start": "1746669",
    "end": "1752699"
  },
  {
    "text": "that we were analyzing before the mobile",
    "start": "1752699",
    "end": "1758219"
  },
  {
    "text": "application knows were to upload the picture the modern application knows the",
    "start": "1758219",
    "end": "1764009"
  },
  {
    "text": "name of the bucket where it will upload the picture it doesn't need to list",
    "start": "1764009",
    "end": "1771599"
  },
  {
    "text": "buckets it can just upload it the same",
    "start": "1771599",
    "end": "1776609"
  },
  {
    "text": "happens with for example lambda List functions the mobile application knows",
    "start": "1776609",
    "end": "1783779"
  },
  {
    "text": "the function name to call and it just calls it it doesn't need to list the",
    "start": "1783779",
    "end": "1791009"
  },
  {
    "text": "existing functions and maybe it's a little bit clearer with dynamo dot list",
    "start": "1791009",
    "end": "1799049"
  },
  {
    "text": "buckets why does a mobile application need to list backups for up database engine so",
    "start": "1799049",
    "end": "1808309"
  },
  {
    "text": "this is a good and strong indicator of miss configuration of a developer",
    "start": "1808309",
    "end": "1815449"
  },
  {
    "text": "granting more permissions than the ones needed by the web application or the",
    "start": "1815449",
    "end": "1821369"
  },
  {
    "text": "mobile application so what are the five developers are miss configuring their",
    "start": "1821369",
    "end": "1829069"
  },
  {
    "text": "cognitive identity post something else",
    "start": "1829069",
    "end": "1835409"
  },
  {
    "text": "that I tried to do was to identify if an attacker exploiting this vulnerability",
    "start": "1835409",
    "end": "1842599"
  },
  {
    "text": "would have access to sensitive information and just as a reminder I did",
    "start": "1842599",
    "end": "1850829"
  },
  {
    "text": "not read the contents of s3 buckets and I did not read the contents of dynamodb",
    "start": "1850829",
    "end": "1858749"
  },
  {
    "text": "tables but when you perform s3 lift",
    "start": "1858749",
    "end": "1863819"
  },
  {
    "text": "buckets you get the bag names and the if the bucket name contains the word secret password credit",
    "start": "1863819",
    "end": "1873030"
  },
  {
    "text": "card backup then all right you're screwed and that goes into the red part",
    "start": "1873030",
    "end": "1880980"
  },
  {
    "text": "there of my graph it's sensitive information and I was able to gain",
    "start": "1880980",
    "end": "1886950"
  },
  {
    "text": "access to 900 s 3 buckets with sensitive",
    "start": "1886950",
    "end": "1893970"
  },
  {
    "text": "information using all of these techniques in total I was able to get",
    "start": "1893970",
    "end": "1900840"
  },
  {
    "text": "access to around 13,000 s3 buckets which",
    "start": "1900840",
    "end": "1907200"
  },
  {
    "text": "are not public they are just accessible if you have AWS credentials for that account they are",
    "start": "1907200",
    "end": "1915090"
  },
  {
    "text": "not public they are just owned through AWS commit",
    "start": "1915090",
    "end": "1921530"
  },
  {
    "text": "something very similar happens with DynamoDB if the table name contains",
    "start": "1921530",
    "end": "1929480"
  },
  {
    "text": "password or credit card then it has sensitive it contains sensitive",
    "start": "1929480",
    "end": "1935730"
  },
  {
    "text": "information and I was able to gain access to 37 databases with sensitive",
    "start": "1935730",
    "end": "1942600"
  },
  {
    "text": "information and the total was 1100 so I was through these techniques I was able",
    "start": "1942600",
    "end": "1950310"
  },
  {
    "text": "to gain access to a lot of information this information stores customer this",
    "start": "1950310",
    "end": "1957390"
  },
  {
    "text": "these database store customer information something interesting is",
    "start": "1957390",
    "end": "1964500"
  },
  {
    "text": "that when you list lambda functions you",
    "start": "1964500",
    "end": "1969690"
  },
  {
    "text": "don't only get the function name you only you also get the metadata",
    "start": "1969690",
    "end": "1975750"
  },
  {
    "text": "associated with that function included",
    "start": "1975750",
    "end": "1981240"
  },
  {
    "text": "in that metadata you find the environment variables which are used to run that function and usually developer",
    "start": "1981240",
    "end": "1991530"
  },
  {
    "text": "store secrets in those environment variables so by running lambda the",
    "start": "1991530",
    "end": "1999429"
  },
  {
    "text": "list functions I got access to around 80 secrets like API keys that awaits",
    "start": "1999429",
    "end": "2007169"
  },
  {
    "text": "connection strings other obvious credentials and summer stuff all right",
    "start": "2007169",
    "end": "2018160"
  },
  {
    "text": "[Music] root cause analysis when I started with",
    "start": "2018160",
    "end": "2023309"
  },
  {
    "text": "this research and before going internet scale I contacted AWS security just to let",
    "start": "2023309",
    "end": "2031559"
  },
  {
    "text": "them know that I was going to do it and through the whole research they were",
    "start": "2031559",
    "end": "2038580"
  },
  {
    "text": "very supportive of the whole process and they helped me understand a few things",
    "start": "2038580",
    "end": "2043919"
  },
  {
    "text": "about Camellia and also help me understand what they were going to do to",
    "start": "2043919",
    "end": "2050128"
  },
  {
    "text": "fix it my understanding of this is that the",
    "start": "2050129",
    "end": "2056669"
  },
  {
    "text": "root cause for this issue is twofold we have insecure by default",
    "start": "2056669",
    "end": "2063690"
  },
  {
    "text": "documentation and we have some issues in the UI let's start with the unsecure by",
    "start": "2063690",
    "end": "2071490"
  },
  {
    "text": "default documentation at least before I",
    "start": "2071490",
    "end": "2076710"
  },
  {
    "text": "reported it there was an example in the official AWS documentation which is the",
    "start": "2076710",
    "end": "2083368"
  },
  {
    "text": "source for every developer to used for writing a new application that uses",
    "start": "2083369",
    "end": "2089339"
  },
  {
    "text": "either Ria's middle there was an example there which granted overly permissive",
    "start": "2089339",
    "end": "2099230"
  },
  {
    "text": "policies to unauthenticated roles so developers that were just starting with",
    "start": "2099230",
    "end": "2106020"
  },
  {
    "text": "this copy pasted from there and created vulnera",
    "start": "2106020",
    "end": "2111029"
  },
  {
    "text": "kognito applications when I reported this they added a note and ok they",
    "start": "2111029",
    "end": "2118890"
  },
  {
    "text": "notice now I believe will see something",
    "start": "2118890",
    "end": "2125730"
  },
  {
    "text": "else is that and this is kind of ok there are some restrictions",
    "start": "2125730",
    "end": "2132850"
  },
  {
    "text": "to the permissions that a developer can assign to an unauthenticated role so a",
    "start": "2132850",
    "end": "2140830"
  },
  {
    "text": "developer can assign permissions for that unauthenticated role in kameido with only 26 services that's why I am",
    "start": "2140830",
    "end": "2150130"
  },
  {
    "text": "doesn't work that's why I didn't find any credentials that had the i''m",
    "start": "2150130",
    "end": "2157390"
  },
  {
    "text": "service enable so this is good there's at least some restriction for the",
    "start": "2157390",
    "end": "2164140"
  },
  {
    "text": "unauthenticated role but still I was able to gain access to a lot of s3",
    "start": "2164140",
    "end": "2169930"
  },
  {
    "text": "buckets so a lot of DynamoDB tables I was able to gain access to lambda",
    "start": "2169930",
    "end": "2177220"
  },
  {
    "text": "functions the source code of lambda functions and a lot of information stored there there's no restriction for",
    "start": "2177220",
    "end": "2187890"
  },
  {
    "text": "authenticated commit roles so if you're a developer you can assign any",
    "start": "2187890",
    "end": "2193560"
  },
  {
    "text": "permission to that authenticated role so",
    "start": "2193560",
    "end": "2201510"
  },
  {
    "text": "AWS is allowing the developer to shoot himself in the foot by not performing",
    "start": "2201510",
    "end": "2209380"
  },
  {
    "text": "enough checks it's allowing developers to",
    "start": "2209380",
    "end": "2215280"
  },
  {
    "text": "misconfigure ada responded oh I get it it's the developer's responsibility it's",
    "start": "2215280",
    "end": "2222460"
  },
  {
    "text": "on the developer side of the shared responsibility model it's not 100% AWS",
    "start": "2222460",
    "end": "2230650"
  },
  {
    "text": "issue but they are not helping enough that's my understand for developers you",
    "start": "2230650",
    "end": "2241180"
  },
  {
    "text": "guys watching on YouTube and any other developer here use least privilege",
    "start": "2241180",
    "end": "2247960"
  },
  {
    "text": "principle always for anything you do and specifically for committing this",
    "start": "2247960",
    "end": "2255250"
  },
  {
    "text": "privilege principle means only give the required permissions for the",
    "start": "2255250",
    "end": "2261310"
  },
  {
    "text": "applications work only assign those permissions",
    "start": "2261310",
    "end": "2266560"
  },
  {
    "text": "nothing else if your I am policy has a",
    "start": "2266560",
    "end": "2272230"
  },
  {
    "text": "star somewhere you are doing it wrong and something that we didn't talk about",
    "start": "2272230",
    "end": "2281460"
  },
  {
    "text": "during this session is object level permissions if we have a dynamodb table",
    "start": "2281460",
    "end": "2289570"
  },
  {
    "text": "that holds information for different users maybe user a should only be able",
    "start": "2289570",
    "end": "2298330"
  },
  {
    "text": "to read his rows in that table and not the rows from user B that's something",
    "start": "2298330",
    "end": "2305620"
  },
  {
    "text": "that I did not explore during this research and it's also really important for developers when they create their",
    "start": "2305620",
    "end": "2313570"
  },
  {
    "text": "applications all right bonus when I was doing CC lambda on the",
    "start": "2313570",
    "end": "2321730"
  },
  {
    "text": "internet I said why not search for",
    "start": "2321730",
    "end": "2326850"
  },
  {
    "text": "hard-coded credentials people tend to do that so I did and I found two hundred",
    "start": "2326850",
    "end": "2336100"
  },
  {
    "text": "eighty hundred credentials and I know sure why but almost 10% of those were",
    "start": "2336100",
    "end": "2344710"
  },
  {
    "text": "route accounts with rural accounts you can destroy the account you can close",
    "start": "2344710",
    "end": "2352540"
  },
  {
    "text": "the account you can do whatever you want and from those two hundred eighty",
    "start": "2352540",
    "end": "2360040"
  },
  {
    "text": "thirty-eight had elevated privileges I could do almost everything they were not",
    "start": "2360040",
    "end": "2366790"
  },
  {
    "text": "really hard but I could do almost everything those connections were hard-coded somewhere on the internet and",
    "start": "2366790",
    "end": "2374760"
  },
  {
    "text": "I found from the twenty six that were real accounts twenty-five came from",
    "start": "2374760",
    "end": "2381700"
  },
  {
    "text": "common crawl so if you want to do some evil go to common crow grab there find",
    "start": "2381700",
    "end": "2391210"
  },
  {
    "text": "real accounts do some big money and of",
    "start": "2391210",
    "end": "2396850"
  },
  {
    "text": "course I reported everything to the ED earlier security team I'm pretty sure some of you guys are",
    "start": "2396850",
    "end": "2402880"
  },
  {
    "text": "here closing thoughts so there are three",
    "start": "2402880",
    "end": "2411030"
  },
  {
    "text": "important things that I want you to take away from this code from this session",
    "start": "2411030",
    "end": "2417510"
  },
  {
    "text": "first AWS kameido is commonly misconfigured developers are assigning",
    "start": "2417510",
    "end": "2427470"
  },
  {
    "text": "excessive privileges for those roles if you are ever doing an assessment and you",
    "start": "2427470",
    "end": "2435430"
  },
  {
    "text": "find AWS Candido check it out learn exploit and gain",
    "start": "2435430",
    "end": "2442119"
  },
  {
    "text": "access to sensitive information if you don't do it during your assessment an",
    "start": "2442119",
    "end": "2447940"
  },
  {
    "text": "attacker is going to do it use CC lambda",
    "start": "2447940",
    "end": "2453369"
  },
  {
    "text": "to grab the Internet there's a lot of research which can be triggered by this",
    "start": "2453369",
    "end": "2460920"
  },
  {
    "text": "just searching the internet in different ways can give you a lot of information",
    "start": "2460920",
    "end": "2467339"
  },
  {
    "text": "for evil or for good and use enumerate I",
    "start": "2467339",
    "end": "2473770"
  },
  {
    "text": "am in order to enumerate permissions when you get access to a set of AWS",
    "start": "2473770",
    "end": "2481270"
  },
  {
    "text": "credentials and of course follow me on Twitter I'm doing a lot of cloud",
    "start": "2481270",
    "end": "2488410"
  },
  {
    "text": "security research and I post everything there if you want to continue with this",
    "start": "2488410",
    "end": "2496450"
  },
  {
    "text": "research you can extract identity polls from iOS applications",
    "start": "2496450",
    "end": "2503800"
  },
  {
    "text": "I didn't explore anything related with iOS maybe there are similar services in",
    "start": "2503800",
    "end": "2512579"
  },
  {
    "text": "other cloud providers I only focused on AWS from Needham they might be are they",
    "start": "2512579",
    "end": "2521460"
  },
  {
    "text": "the easiest thing for you guys to do if you want to continue this research is",
    "start": "2521460",
    "end": "2527849"
  },
  {
    "text": "authenticated role analysis I already focused on any authenticated",
    "start": "2527849",
    "end": "2534010"
  },
  {
    "text": "Rodan you could extend this research and see where it goes with leads and finally and",
    "start": "2534010",
    "end": "2543640"
  },
  {
    "text": "I don't recommend this but maybe you guys want to do it",
    "start": "2543640",
    "end": "2549420"
  },
  {
    "text": "privilege escalation analysis is it possible for those credentials to be",
    "start": "2549420",
    "end": "2556510"
  },
  {
    "text": "used to escalate privileges in the AWS account that's what I did during my",
    "start": "2556510",
    "end": "2564240"
  },
  {
    "text": "child's activity assessment because my customer was okay with it I would",
    "start": "2564240",
    "end": "2572109"
  },
  {
    "text": "recommend you not to do it on random AWS accounts on the internet it could be",
    "start": "2572109",
    "end": "2577780"
  },
  {
    "text": "seen as an attack because it is and I'm",
    "start": "2577780",
    "end": "2584740"
  },
  {
    "text": "not going to do anything related with this so it's all yours I'm here if you",
    "start": "2584740",
    "end": "2591070"
  },
  {
    "text": "want to ask me any questions about the continuing with this research so that's",
    "start": "2591070",
    "end": "2598000"
  },
  {
    "text": "it any questions and there are a few microphones there if you want to ask",
    "start": "2598000",
    "end": "2604390"
  },
  {
    "text": "questions if not and you want to ask questions in private I will go to the",
    "start": "2604390",
    "end": "2611940"
  },
  {
    "text": "room in reef a I believe there's a question there yeah thanks for the nice",
    "start": "2611940",
    "end": "2618849"
  },
  {
    "text": "talk so so a question about this over-provisioning of privileges so",
    "start": "2618849",
    "end": "2624640"
  },
  {
    "text": "what's your experience with Amazon's reaction to that so I did some work for",
    "start": "2624640",
    "end": "2630839"
  },
  {
    "text": "iOS and Android in 2013 or so we saw that the fact three four years later it",
    "start": "2630839",
    "end": "2638530"
  },
  {
    "text": "was still published privileges are over lenient so how's Amazon reacting to what",
    "start": "2638530",
    "end": "2646720"
  },
  {
    "text": "you found at least in my case they were",
    "start": "2646720",
    "end": "2652770"
  },
  {
    "text": "very good during the whole process of communicating and explaining that it was",
    "start": "2652770",
    "end": "2659290"
  },
  {
    "text": "not their fault it's on the other side of the shared responsibility model and I",
    "start": "2659290",
    "end": "2667089"
  },
  {
    "text": "get it but that shared responsibility model in my opinion it's not a straight line it's",
    "start": "2667089",
    "end": "2674270"
  },
  {
    "text": "a gray line it falls in between so but",
    "start": "2674270",
    "end": "2679580"
  },
  {
    "text": "to that end I'm not too familiar so for example if you would go and publish an",
    "start": "2679580",
    "end": "2684740"
  },
  {
    "text": "app in either iOS or Android Market they they have some background security yes",
    "start": "2684740",
    "end": "2691490"
  },
  {
    "text": "verification which is not too strong but that's for Howard public relations that's for hard-coded credentials",
    "start": "2691490",
    "end": "2699650"
  },
  {
    "text": "in mobile applications that does not apply to kognito identity pools",
    "start": "2699650",
    "end": "2706040"
  },
  {
    "text": "I know but is Amazon trying anything like that at least the best effort or no",
    "start": "2706040",
    "end": "2711260"
  },
  {
    "text": "I don't think so No okay thank you any other questions",
    "start": "2711260",
    "end": "2717220"
  },
  {
    "text": "No all right thank you [Applause]",
    "start": "2717220",
    "end": "2722880"
  }
]