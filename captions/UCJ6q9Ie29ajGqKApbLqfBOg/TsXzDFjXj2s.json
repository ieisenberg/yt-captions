[
  {
    "start": "0",
    "end": "72000"
  },
  {
    "text": "alright let's get started it's Wednesday afternoon a black hat hope all of you",
    "start": "30",
    "end": "5040"
  },
  {
    "text": "are having a good time so far you are currently in the Islander room III and I",
    "start": "5040",
    "end": "12960"
  },
  {
    "text": "would like to introduce you to shy and",
    "start": "12960",
    "end": "18750"
  },
  {
    "text": "you and I who will be talking to you today about behind the scenes of Intel",
    "start": "18750",
    "end": "24960"
  },
  {
    "text": "security and manageability engine before we get started just a couple few brief",
    "start": "24960",
    "end": "31980"
  },
  {
    "text": "notes that I need to tell you please stop by the business hall located in",
    "start": "31980",
    "end": "37590"
  },
  {
    "text": "Mandalay Bay Oceanside and shoreline ballrooms on level 2 during the day and",
    "start": "37590",
    "end": "43379"
  },
  {
    "text": "for a welcome reception at 5:30 tonight the blackhat Arsenal is in the business hall on level 2 and please join us for",
    "start": "43379",
    "end": "51149"
  },
  {
    "text": "the pony Awards in lagoon JK and owl at 6:30 this evening and don't forget the",
    "start": "51149",
    "end": "56910"
  },
  {
    "text": "merchandise store on level 2 and session recordings from s ok they have a desk on every level of course thank you for",
    "start": "56910",
    "end": "64588"
  },
  {
    "text": "putting your cell phone on vibrate or silent and if you have a watch as well",
    "start": "64589",
    "end": "70320"
  },
  {
    "text": "that makes noise please put it on silent too and our speakers at the end of the",
    "start": "70320",
    "end": "76560"
  },
  {
    "text": "talk today we'll be taking anyone who's interested to a rap room versus taking",
    "start": "76560",
    "end": "81600"
  },
  {
    "text": "questions in the room here so please feel free to follow them to the rap room",
    "start": "81600",
    "end": "86909"
  },
  {
    "text": "and they will be happy to answer any questions that you have at the end of the talk so without further delay I give",
    "start": "86909",
    "end": "92970"
  },
  {
    "text": "you shy and yen hi",
    "start": "92970",
    "end": "98150"
  },
  {
    "start": "97000",
    "end": "283000"
  },
  {
    "text": "[Applause] hi I'm Jen I wish I we are from the sea",
    "start": "101510",
    "end": "108480"
  },
  {
    "text": "SME security team and today we're going to mystify the sea SME how it works what",
    "start": "108480",
    "end": "114480"
  },
  {
    "text": "it does on the platform and provide some detailed on the AdWords of the few more",
    "start": "114480",
    "end": "119790"
  },
  {
    "text": "internals and we all we do that to be more transparent with the security and",
    "start": "119790",
    "end": "125130"
  },
  {
    "text": "let you understand what it does and how it works so the talk will focus on the",
    "start": "125130",
    "end": "132450"
  },
  {
    "text": "latest sea SME version available on the coffee like and whiskey Lake Intel based",
    "start": "132450",
    "end": "137580"
  },
  {
    "text": "platforms that's the generation 12 that we currently offer to the customer I",
    "start": "137580",
    "end": "145040"
  },
  {
    "text": "will start with the architecture of the sea SME what it does and how it is",
    "start": "145040",
    "end": "151020"
  },
  {
    "text": "involved in the platform boots law so the sea SME is a embedded subsystem that",
    "start": "151020",
    "end": "158130"
  },
  {
    "text": "we have in the PCs the platform control app so in Intel platform we have two main chip one is the CPU that most",
    "start": "158130",
    "end": "165120"
  },
  {
    "text": "people known and the PCH itself so the sea SME is in the PCH and it's a",
    "start": "165120",
    "end": "171660"
  },
  {
    "text": "standalone low-power processor with dedicated hardware and we're gonna see later what is all the ways the bath is",
    "start": "171660",
    "end": "178709"
  },
  {
    "text": "about sea SME is basically the root of trust on the platform for loading Intel",
    "start": "178709",
    "end": "184770"
  },
  {
    "text": "component and optionally also if manufacturer decide to use that they can",
    "start": "184770",
    "end": "191250"
  },
  {
    "text": "also be the root of trust for manufacture of FEMA also it provides an",
    "start": "191250",
    "end": "196530"
  },
  {
    "text": "isolated environment which is a physically isolated from the main CPU like like tea and it executes only Intel",
    "start": "196530",
    "end": "205950"
  },
  {
    "text": "science ESM a few more the CSM itself so",
    "start": "205950",
    "end": "211110"
  },
  {
    "text": "a three main wall on the platform first is what we call at Intel chasis so it's",
    "start": "211110",
    "end": "217230"
  },
  {
    "text": "basically in charge to secure the platform to ender some of the CPU overclocking and we have also multiple",
    "start": "217230",
    "end": "224820"
  },
  {
    "text": "microcontroller in the PCH and in the CPU itself so we also do the secure loading of the streamer and access the",
    "start": "224820",
    "end": "232710"
  },
  {
    "text": "route of trust for them we also use this isolated and trusted environment to run some security feature",
    "start": "232710",
    "end": "239689"
  },
  {
    "text": "like the integrity TPM so if the manufacturer decided to use intel TPM so",
    "start": "239689",
    "end": "247939"
  },
  {
    "text": "basically the this is running inside the CSM we also provide the dynamic dynamic",
    "start": "247939",
    "end": "253430"
  },
  {
    "text": "application order there have been some talk of that and content protection is",
    "start": "253430",
    "end": "258829"
  },
  {
    "text": "also running in in this isolated environment the last feature that we have is more feature for big cooperate",
    "start": "258829",
    "end": "265430"
  },
  {
    "text": "which is known as the Intel AMT or which is mainly available on viproy platform",
    "start": "265430",
    "end": "270500"
  },
  {
    "text": "so this allow the IT shop to securely manage the platform by using this heart",
    "start": "270500",
    "end": "277639"
  },
  {
    "text": "of main network capabilities that we have in the industry sm itself so now",
    "start": "277639",
    "end": "284840"
  },
  {
    "start": "283000",
    "end": "467000"
  },
  {
    "text": "let's deep dive in the hardware itself what are the basic outward block that we",
    "start": "284840",
    "end": "289880"
  },
  {
    "text": "have in this SE SME so first like I said we have a dedicated intense a little bit",
    "start": "289880",
    "end": "295190"
  },
  {
    "text": "CPU that supports standard security mechanism like multiple wins",
    "start": "295190",
    "end": "300919"
  },
  {
    "text": "segmentation paging and we gonna see later how the few more is making use of that to do some process isolation we",
    "start": "300919",
    "end": "310310"
  },
  {
    "text": "have dedicated the RAM it's about 1.5 megabyte and it's physically isolated",
    "start": "310310",
    "end": "316070"
  },
  {
    "text": "from the host and in the same block we also have the ROM which is basically the",
    "start": "316070",
    "end": "321110"
  },
  {
    "text": "hallway would of trust of the framework and we're going to see also later what what the room is doing then we have the",
    "start": "321110",
    "end": "329660"
  },
  {
    "text": "system agent block so basically this block is allowing the CSE CPU to circularly access the SRAM from where",
    "start": "329660",
    "end": "337849"
  },
  {
    "text": "the code is executing and we also have there so some iommu where we can also",
    "start": "337849",
    "end": "342889"
  },
  {
    "text": "control which device including CSM internal device an external device of",
    "start": "342889",
    "end": "348289"
  },
  {
    "text": "CSM ikan can access the SRAM then we",
    "start": "348289",
    "end": "354229"
  },
  {
    "text": "have the crypto accelerator so there we have some hardware block where we we",
    "start": "354229",
    "end": "359449"
  },
  {
    "text": "have some implementation of crypto primitive like aes hash our say so this",
    "start": "359449",
    "end": "365490"
  },
  {
    "text": "used to improve the performance when doing some crypt operation we also have",
    "start": "365490",
    "end": "370889"
  },
  {
    "text": "some DMA capabilities down there that the framework can use to improve the performance of some of the flow and the",
    "start": "370889",
    "end": "378479"
  },
  {
    "text": "secure key storage that we're going to discuss further in in more details the",
    "start": "378479",
    "end": "385050"
  },
  {
    "text": "next block that we have is a gasket there basically we have the main interface to the to the other PCH",
    "start": "385050",
    "end": "392009"
  },
  {
    "text": "devices and also we we have there the main a CSM in IO devices so the the main",
    "start": "392009",
    "end": "399930"
  },
  {
    "text": "one at the a key interface that's the main interface used by local software to interact with the CSM E and if the TPM",
    "start": "399930",
    "end": "408449"
  },
  {
    "text": "the Intel TPM is is enabled by the manufacturer we also have a dedicated",
    "start": "408449",
    "end": "413520"
  },
  {
    "text": "dedicated outward TPM there like I",
    "start": "413520",
    "end": "419250"
  },
  {
    "text": "mentioned before we also have a manageability capability like the Intel AMT and we have dedicated outward to",
    "start": "419250",
    "end": "426810"
  },
  {
    "text": "support the main feature of the manageability like keyboard and video mouse so this is an outward block that a",
    "start": "426810",
    "end": "433409"
  },
  {
    "text": "lot of film work to do the capture of the screen and the key and the video and Mouse and support remote out-of-band the",
    "start": "433409",
    "end": "440099"
  },
  {
    "text": "manageability of the femur we also have a dedicated protected real-time clock",
    "start": "440099",
    "end": "446849"
  },
  {
    "text": "this is used basically to stop what we call the monotony counters so this this",
    "start": "446849",
    "end": "452940"
  },
  {
    "text": "is used to have someone team we play protection and the data that the CSM is fumer is keeping on the flash it also",
    "start": "452940",
    "end": "459330"
  },
  {
    "text": "provide protected time to the fumer this can be used by the DRM application if",
    "start": "459330",
    "end": "465479"
  },
  {
    "text": "needed in addition to the software blocks we also have some devices in the",
    "start": "465479",
    "end": "472409"
  },
  {
    "start": "467000",
    "end": "641000"
  },
  {
    "text": "PCH itself that the CSM is also using so the first one is the Dr Ng which is",
    "start": "472409",
    "end": "477840"
  },
  {
    "text": "critical to the sea SME operation so it is used to by the CSM if you were to generate all the random number that it",
    "start": "477840",
    "end": "484289"
  },
  {
    "text": "needs we also have the fuse controller where basically we have two type of",
    "start": "484289",
    "end": "489599"
  },
  {
    "text": "fuses the one set by Intel before selling the chip to the manufacturer typically there they will have the",
    "start": "489599",
    "end": "496469"
  },
  {
    "text": "settings about the CSMA the figuration which signing Keys is enabled",
    "start": "496469",
    "end": "501900"
  },
  {
    "text": "on the on the adware if it's a production silicon or nollie version of the silicon and so on we also have there",
    "start": "501900",
    "end": "509250"
  },
  {
    "text": "the security keys of the CSM II that is used during the runtime of the few more and it encrypted by the buyer see",
    "start": "509250",
    "end": "517440"
  },
  {
    "text": "semi-auto a key and we're gonna see later other this is used by the few more we offer to manufacturer what we call",
    "start": "517440",
    "end": "524370"
  },
  {
    "text": "the programmable fuses so the manufacturer before it sells the platform to the end-user can keep their",
    "start": "524370",
    "end": "531180"
  },
  {
    "text": "the the own security settings like the on public key if they want to use the CSM er the root of trust for the for the",
    "start": "531180",
    "end": "538560"
  },
  {
    "text": "femur and the buyers so they can keep their the the on public key ash and if",
    "start": "538560",
    "end": "543630"
  },
  {
    "text": "they decide also to use Intel food biotechnology secure would be a secure boot technology of Intel so they can",
    "start": "543630",
    "end": "550800"
  },
  {
    "text": "also keep the policy of the boot board in the in the FPS starting CSM e12 we",
    "start": "550800",
    "end": "558120"
  },
  {
    "text": "have also added a new capability which is against physical world back of the",
    "start": "558120",
    "end": "563130"
  },
  {
    "text": "femur so if we add a vulnerability and release the patch so if the manufacturer",
    "start": "563130",
    "end": "570149"
  },
  {
    "text": "decided to enable its capability so even if someone tried to physically put all",
    "start": "570149",
    "end": "576720"
  },
  {
    "text": "version so we keep in the FPS the actual the latest security version of the femur",
    "start": "576720",
    "end": "582360"
  },
  {
    "text": "I can check that against the femur currently running and if there is a mismatch then basically the framework",
    "start": "582360",
    "end": "589470"
  },
  {
    "text": "will not boot and the platform also will not good the last the last block that we have in",
    "start": "589470",
    "end": "595380"
  },
  {
    "text": "the PCH is about debug what we call the effects so this block is basically controlling the debug interface of the",
    "start": "595380",
    "end": "601980"
  },
  {
    "text": "CSM II and other microcontroller that we have in the PCH and important things to",
    "start": "601980",
    "end": "607050"
  },
  {
    "text": "note is about that when JTAG is opened so the outward and the",
    "start": "607050",
    "end": "612209"
  },
  {
    "text": "femur together ensure that the security keys are not available all the secret in",
    "start": "612209",
    "end": "617670"
  },
  {
    "text": "the flesh that the femur may stall in the flesh also not available they are",
    "start": "617670",
    "end": "623070"
  },
  {
    "text": "protected and we also ensure that before burning JTAG all the ESP armies",
    "start": "623070",
    "end": "628279"
  },
  {
    "text": "zerode so if you add from previous execution some secret on the atrium so before opening the JTAG interface the",
    "start": "628279",
    "end": "634879"
  },
  {
    "text": "debug interface we also make sure that the atrium is zero in the next slide",
    "start": "634879",
    "end": "643189"
  },
  {
    "text": "we're going to we're going to see the CSM eboot itself how it all the component of the securely booted and how",
    "start": "643189",
    "end": "650839"
  },
  {
    "text": "they play a key role in the platform boot also so let's stop with the CSM e",
    "start": "650839",
    "end": "658100"
  },
  {
    "start": "655000",
    "end": "787000"
  },
  {
    "text": "ROM so the ROM is integrally it's part of the ad we're like like I said before the CSM is it in the PCH there is no",
    "start": "658100",
    "end": "665540"
  },
  {
    "text": "page mechanism once the production silicon has been has been created so",
    "start": "665540",
    "end": "670759"
  },
  {
    "text": "there is no if we have a bug in the ROM on the production silicon there's no way to fix it the only capability that we have and use",
    "start": "670759",
    "end": "678620"
  },
  {
    "text": "during early development of the chip is the ROM bypass so we may use this capability if for the first first",
    "start": "678620",
    "end": "686089"
  },
  {
    "text": "version of the chip we encounter some functional issues so we can never ready to cut this capability and bypass the",
    "start": "686089",
    "end": "692300"
  },
  {
    "text": "bug until the new silicon with the auto fix is arriving in the lab but this",
    "start": "692300",
    "end": "697879"
  },
  {
    "text": "capability is disabled on production by the same Intel manufacturing fuses that",
    "start": "697879",
    "end": "703370"
  },
  {
    "text": "we discussed before so the ROM is the first component executed by the CSM a",
    "start": "703370",
    "end": "710059"
  },
  {
    "text": "CPU so when the system is CPU is getting out of reset the first intro the first code that will be run would be in the",
    "start": "710059",
    "end": "716779"
  },
  {
    "text": "ROM the wall of the room would be basically to put the CPU in protected mode enabled segmentation and paging and",
    "start": "716779",
    "end": "726100"
  },
  {
    "text": "generate a bunch of keys we're going to see that in in a minute and that before",
    "start": "726100",
    "end": "731959"
  },
  {
    "text": "it will have to load the first few more module from the flash authenticated so",
    "start": "731959",
    "end": "737660"
  },
  {
    "text": "load it in loaded from the flash into the SRAM make the arrest rate authentication of these models they're",
    "start": "737660",
    "end": "744110"
  },
  {
    "text": "in the secure memory and if all the check paths then it will start executing the TLB",
    "start": "744110",
    "end": "749990"
  },
  {
    "text": "the words authentication work is basically we have in the ROM a list of the public key hashes",
    "start": "749990",
    "end": "757059"
  },
  {
    "text": "of the CSM assigning keys so we can easily verify that the key",
    "start": "757059",
    "end": "762649"
  },
  {
    "text": "the RB is one of the authorized Intel CSM assigning keys we have some debug",
    "start": "762649",
    "end": "769100"
  },
  {
    "text": "keys that we use during early early verification of the chip and this debug",
    "start": "769100",
    "end": "775819"
  },
  {
    "text": "signing key is also disabled by the same configuration fuses that we have in the",
    "start": "775819",
    "end": "781100"
  },
  {
    "text": "in the PCH so only the production Keys is available on the production silicon",
    "start": "781100",
    "end": "787509"
  },
  {
    "start": "787000",
    "end": "864000"
  },
  {
    "text": "now let's see how the ROM is going to derive the the keys so first of all we",
    "start": "787509",
    "end": "794360"
  },
  {
    "text": "need the room to trigger some other key generation why we do that is like I said",
    "start": "794360",
    "end": "799639"
  },
  {
    "text": "the security keys are kept in the fuses and they are encrypted so we need for us",
    "start": "799639",
    "end": "807110"
  },
  {
    "text": "to generate the key to decrypt the fuse so the ROM doesn't see the key it can only generate stop the gents",
    "start": "807110",
    "end": "813920"
  },
  {
    "text": "ask the other way to generate the key and not the key in the executi storage once the key is there basically now we",
    "start": "813920",
    "end": "821300"
  },
  {
    "text": "can read the security fuses from the fuse and the security keys from the",
    "start": "821300",
    "end": "826610"
  },
  {
    "text": "fuses and decrypt them using the same other keys the decryption of the keys is",
    "start": "826610",
    "end": "832970"
  },
  {
    "text": "directly loaded in the SKS so now we have with the chipset key which is the parent keys of all the film work is that",
    "start": "832970",
    "end": "840529"
  },
  {
    "text": "the ROM is going to to derive and then basically using this chipset key which",
    "start": "840529",
    "end": "847279"
  },
  {
    "text": "is in the SKS now we can start deriving a bunch of kids the way it works with",
    "start": "847279",
    "end": "852740"
  },
  {
    "text": "each mark as the key derivation function over some static string and statistic",
    "start": "852740",
    "end": "857920"
  },
  {
    "text": "who is also the elbe security version number",
    "start": "857920",
    "end": "864069"
  },
  {
    "start": "864000",
    "end": "990000"
  },
  {
    "text": "now let's the deep dive on the secure key storage itself so the main idea here",
    "start": "864069",
    "end": "869480"
  },
  {
    "text": "is to protect the CSM II would kiss during runtime and to make sure the few more doesn't see the actual key but can",
    "start": "869480",
    "end": "875990"
  },
  {
    "text": "can't make use of the key we have additional properties in the SKS a one-kilo the key in the SKS so you can",
    "start": "875990",
    "end": "884629"
  },
  {
    "text": "also decide some of the properties of the slot where the key is loaded and for",
    "start": "884629",
    "end": "890929"
  },
  {
    "text": "for example one is the secure mode so basically once a key is loaded in such slot so the film",
    "start": "890929",
    "end": "897990"
  },
  {
    "text": "work can only make use of the key to derive new key by doing some atomic operation like we saw previously or",
    "start": "897990",
    "end": "905070"
  },
  {
    "text": "decrypt some keys that have been previously encrypted using using the",
    "start": "905070",
    "end": "910650"
  },
  {
    "text": "keys of the decryption when you do the decryption of the key if you want to use the key you need to load the key into",
    "start": "910650",
    "end": "916650"
  },
  {
    "text": "the SKS and again we do that to seal some of the key to the other words they can't be used outside the hardware and",
    "start": "916650",
    "end": "923040"
  },
  {
    "text": "also the femur can see the key itself we",
    "start": "923040",
    "end": "928260"
  },
  {
    "text": "have also some access control that the adword can do so we have we have a",
    "start": "928260",
    "end": "933900"
  },
  {
    "text": "privilege level in the secure key storage and basically it's quite similar",
    "start": "933900",
    "end": "939150"
  },
  {
    "text": "to the CPU ring so on the privilege level is set to zero so all the key in",
    "start": "939150",
    "end": "944880"
  },
  {
    "text": "the SKS are available so the femur can make use of all the kids in this case",
    "start": "944880",
    "end": "950730"
  },
  {
    "text": "when the privilege level is moved to suite and only the key in the slot with",
    "start": "950730",
    "end": "957510"
  },
  {
    "text": "privilege of l3 are available for the femur and we will use this upward",
    "start": "957510",
    "end": "962550"
  },
  {
    "text": "capability to ensure that the process running at Winx 3 inside the CSM it",
    "start": "962550",
    "end": "968010"
  },
  {
    "text": "can't access some of the key used by the kernel which is running at ring zero so we use the software capability to even",
    "start": "968010",
    "end": "974460"
  },
  {
    "text": "inside the CSM if you were to isolate the key between the wings the CPU rings",
    "start": "974460",
    "end": "979670"
  },
  {
    "text": "we can also lock some some of the key in the other and the only way to invalidate the key is to to reset the CSM er work",
    "start": "979670",
    "end": "990620"
  },
  {
    "text": "so like like we saw before so the room is a out--we component we have no way to",
    "start": "990980",
    "end": "998280"
  },
  {
    "text": "fix it once the production silicone is created so we try to put the minimum in",
    "start": "998280",
    "end": "1003620"
  },
  {
    "text": "the ROM and everything else which is not critical to be in the ROM is basically put in the first few more modules that",
    "start": "1003620",
    "end": "1009770"
  },
  {
    "text": "we call the ROM boot extension and the main advantage is if we have if we have the bubble we need to add new capability",
    "start": "1009770",
    "end": "1016190"
  },
  {
    "text": "we can basically put that in the wrong boot extension the wrong boot extension",
    "start": "1016190",
    "end": "1021500"
  },
  {
    "text": "itself is a bootloader of the CSM EOS its main responsibility or security",
    "start": "1021500",
    "end": "1027770"
  },
  {
    "text": "responsibilities around the other way than to rollback that I described before so Diaby we'll check the few more security",
    "start": "1027770",
    "end": "1036110"
  },
  {
    "text": "version number that is in the field against the actual framer version running and if we detect that there was",
    "start": "1036110",
    "end": "1043040"
  },
  {
    "text": "a rollback so there'll be we'll stop executing the femur and platform will not boot",
    "start": "1043040",
    "end": "1048730"
  },
  {
    "text": "it also provided some early chasis job so like I said we have some micro",
    "start": "1048730",
    "end": "1055880"
  },
  {
    "text": "controller in the PCH so one of them is a power management controller and so it",
    "start": "1055880",
    "end": "1061670"
  },
  {
    "text": "can't directly access the flash so the CSM is acting as a secure loader of the",
    "start": "1061670",
    "end": "1067820"
  },
  {
    "text": "of the rom patch of the pmc so it will read it from the flash put it in the",
    "start": "1067820",
    "end": "1074120"
  },
  {
    "text": "SRAM authenticated this piece of code with the pmc signing key that it knows",
    "start": "1074120",
    "end": "1080420"
  },
  {
    "text": "and if all the revocation passed then it will take the data and pass it to the",
    "start": "1080420",
    "end": "1085880"
  },
  {
    "text": "room to the PMC ROM itself then the RB",
    "start": "1085880",
    "end": "1091100"
  },
  {
    "text": "will have to load at auntie Kate and execute the rest of the CSM EOS so let's see how it works so like we",
    "start": "1091100",
    "end": "1098630"
  },
  {
    "text": "said the ROM is logic but antiquated and executing the ami so we will have to do",
    "start": "1098630",
    "end": "1104900"
  },
  {
    "text": "the same for the for the fumer also so the wait does that is also by loading",
    "start": "1104900",
    "end": "1110330"
  },
  {
    "text": "all the relevant models in the SRAM compute a hash of them and compare it",
    "start": "1110330",
    "end": "1116630"
  },
  {
    "text": "against an expected hash that he tells in the code so basically during the build of the fumer we already know all",
    "start": "1116630",
    "end": "1122600"
  },
  {
    "text": "the fumer component and we embed in the lb code the hash of all these components so it's quite easy for the LB to",
    "start": "1122600",
    "end": "1129380"
  },
  {
    "text": "authenticate them as part of the authentication we can also create some integrity check value using some random",
    "start": "1129380",
    "end": "1137000"
  },
  {
    "text": "keys that the ABI will create so when loading all of the code for every pages",
    "start": "1137000",
    "end": "1142790"
  },
  {
    "text": "we can also calculate some integrity check values using the symmetry keys and keep this ICV securely in the SRAM once",
    "start": "1142790",
    "end": "1150590"
  },
  {
    "text": "we have the size TVs we can also start using them the continued security authentication",
    "start": "1150590",
    "end": "1158250"
  },
  {
    "text": "and loading of the rest of the film were so the OB will use that to load and",
    "start": "1158250",
    "end": "1163500"
  },
  {
    "text": "execute the relevant channel pages that we actually need to boot the rest of the",
    "start": "1163500",
    "end": "1168570"
  },
  {
    "text": "few more and the colonel will do the same keep using the same ITV that",
    "start": "1168570",
    "end": "1173880"
  },
  {
    "text": "they'll be created over over some of the few more module and execute the process manager and we're going to repeat the",
    "start": "1173880",
    "end": "1181860"
  },
  {
    "text": "same so the process manager will interact with the colonel and start creating some process in the CSM EOS and",
    "start": "1181860",
    "end": "1189059"
  },
  {
    "text": "the colonel will already know the ICV of the process because this has been not this has been created by his lb and",
    "start": "1189059",
    "end": "1195630"
  },
  {
    "text": "first securely to the camera so we can directly use the ice TVs again and start executing the rest of the femur so like",
    "start": "1195630",
    "end": "1205320"
  },
  {
    "text": "I said the SRAM is small we can't load all the fewer code and data in the SRAM so what we typically do is waiting for",
    "start": "1205320",
    "end": "1213299"
  },
  {
    "text": "the bios to allocate some memory in the Austin memory and once we have that we",
    "start": "1213299",
    "end": "1219450"
  },
  {
    "text": "use this awesome memory to to evict some pages that we have in the SRAM and not",
    "start": "1219450",
    "end": "1226530"
  },
  {
    "text": "actually needed for current execution so it's a so the kernel will detect that",
    "start": "1226530",
    "end": "1232590"
  },
  {
    "text": "some of the code currently code and data is not actually needed in the SRAM and will page out this data to the to the to",
    "start": "1232590",
    "end": "1242100"
  },
  {
    "text": "the auth memory allocated by the BIOS so once this soft memory is available now",
    "start": "1242100",
    "end": "1248400"
  },
  {
    "text": "we can start loading it authenticating the rest of the semi driver and services and also the application similarly it",
    "start": "1248400",
    "end": "1256200"
  },
  {
    "text": "will be the process manager during build time we also put all the ashes of this",
    "start": "1256200",
    "end": "1261900"
  },
  {
    "text": "module in the process manager so the authentication is also simple you load all the modules from flash into the SRAM",
    "start": "1261900",
    "end": "1268230"
  },
  {
    "text": "you check the hash if there is a match then you can start executing advance",
    "start": "1268230",
    "end": "1274010"
  },
  {
    "text": "once all the module have been authenticated what we typically do is keeping all the",
    "start": "1274010",
    "end": "1281370"
  },
  {
    "text": "ICV that have been created and receiving itself in the flash securely by securely",
    "start": "1281370",
    "end": "1286890"
  },
  {
    "text": "I mean it would be encrypt integrity protected and also they would have some replay protection on that and",
    "start": "1286890",
    "end": "1293370"
  },
  {
    "text": "why we do that it is basically at next boot now the OB can use the ICV blob",
    "start": "1293370",
    "end": "1299550"
  },
  {
    "text": "itself containing all the ice TVs and I see Vicki and start executing the relevant",
    "start": "1299550",
    "end": "1305780"
  },
  {
    "text": "component in the same model but directly by using the ICV so this speed up the",
    "start": "1305780",
    "end": "1311340"
  },
  {
    "text": "boot of the GSMA while still being secured so now let's talk about the",
    "start": "1311340",
    "end": "1320160"
  },
  {
    "text": "secret the main security principle that we used to build the architecture of the",
    "start": "1320160",
    "end": "1325740"
  },
  {
    "text": "gsm eos so this is a microkernel OS based on Linux OS architecture by",
    "start": "1325740",
    "end": "1332160"
  },
  {
    "text": "Professor Tannenbaum what it means is the only component training at ring zero inside the CSM II is the kernel itself",
    "start": "1332160",
    "end": "1338340"
  },
  {
    "text": "all the driver services are running at wink 3 and the camera is doing the bare",
    "start": "1338340",
    "end": "1343920"
  },
  {
    "text": "minimum to implement a noise the second principle that we have it",
    "start": "1343920",
    "end": "1349110"
  },
  {
    "text": "about the TCB the TCB model so we have we have a small TCP and by TCB I mean",
    "start": "1349110",
    "end": "1356790"
  },
  {
    "text": "that this component would be in charge to verify that the key are properly protected the access to the hardware is",
    "start": "1356790",
    "end": "1364590"
  },
  {
    "text": "also properly protected and so on and and the code running inside the CSM itself is is is a good one so the we can",
    "start": "1364590",
    "end": "1375210"
  },
  {
    "start": "1373000",
    "end": "1462000"
  },
  {
    "text": "look at the kernel as the driver of the CPU and I um mu so it will ring the CPU",
    "start": "1375210",
    "end": "1380400"
  },
  {
    "text": "capability segmentation and paging to ensure the process isolation within the",
    "start": "1380400",
    "end": "1386190"
  },
  {
    "text": "CSM e OS so we use the the CPU capability to do that and also we we",
    "start": "1386190",
    "end": "1392970"
  },
  {
    "text": "also ensure that all the auto access done by by the ring 3 driver and process",
    "start": "1392970",
    "end": "1399990"
  },
  {
    "text": "there won't be a direct access it would be through memory mapped i/o that the colonel knows also at Build time for all",
    "start": "1399990",
    "end": "1407340"
  },
  {
    "text": "the process and like this we can also control which other is available to",
    "start": "1407340",
    "end": "1412350"
  },
  {
    "text": "which process like I said before we have also an iommu this is about the CalNet we also ensure that only relevant device",
    "start": "1412350",
    "end": "1419670"
  },
  {
    "text": "can DMA into zerah and we also support some standard candle",
    "start": "1419670",
    "end": "1424830"
  },
  {
    "text": "services like inter process communication the process creation itself exception in interrupt handling",
    "start": "1424830",
    "end": "1431720"
  },
  {
    "text": "like I mentioned before the SRAM is small so all the code can cheat code and",
    "start": "1431720",
    "end": "1437399"
  },
  {
    "text": "that I can fit it to the SRAM so we use the auth memory to paged out some of the",
    "start": "1437399",
    "end": "1442529"
  },
  {
    "text": "code and data not needed currently for the execution so this is done securely for all the code and data a 52 SRAM is",
    "start": "1442529",
    "end": "1449789"
  },
  {
    "text": "encrypted and it acquittee protection integrity with integrity protection when the data will come back inside the SRAM",
    "start": "1449789",
    "end": "1456600"
  },
  {
    "text": "so we verify the integrity and in servicing past we will defeat the code and data and stops using it on top of",
    "start": "1456600",
    "end": "1465179"
  },
  {
    "start": "1462000",
    "end": "1546000"
  },
  {
    "text": "the kernel we have additional TCB component namely the process manager is like we signed the secure boot of the",
    "start": "1465179",
    "end": "1471570"
  },
  {
    "text": "few more easing shafts to authenticate the code running creating the process and terminating it when it wants to",
    "start": "1471570",
    "end": "1477659"
  },
  {
    "text": "terminate the crypto driver is the one providing the crypto services inside the CSM EOS and managing all the fewer keys",
    "start": "1477659",
    "end": "1484980"
  },
  {
    "text": "at the ROM derived we have also the virtual file system which provides",
    "start": "1484980",
    "end": "1490230"
  },
  {
    "text": "secure storage for the application like the TPM the doll and the DRM so they can",
    "start": "1490230",
    "end": "1495539"
  },
  {
    "text": "securely store the data in the flash and also the VFS would ensure that data belonging to the TPM can be accessed by",
    "start": "1495539",
    "end": "1502169"
  },
  {
    "text": "the by doll or the manageability application and so on it also and for some access control on which service and",
    "start": "1502169",
    "end": "1508919"
  },
  {
    "text": "Driver can be used within the CSM EOS and SH I will discuss later how this is done we also have the bus driver which allows",
    "start": "1508919",
    "end": "1515970"
  },
  {
    "text": "some of the driver to get access to the config space of the device and get some",
    "start": "1515970",
    "end": "1521519"
  },
  {
    "text": "configuration there and also the bus driver and foster access control so the driver can only access the other word",
    "start": "1521519",
    "end": "1528269"
  },
  {
    "text": "that is mean to access and like you can see also in the table so even though tcv",
    "start": "1528269",
    "end": "1533460"
  },
  {
    "text": "they only get the minimum privilege and so they only get the minimum privileges so for example the process manager who",
    "start": "1533460",
    "end": "1539850"
  },
  {
    "text": "don't have it doesn't have direct access to the keys only the crypto driver can do that then we have the bring up which",
    "start": "1539850",
    "end": "1549179"
  },
  {
    "start": "1546000",
    "end": "1624000"
  },
  {
    "text": "is a mix of driver services it's its main goal is to support the early",
    "start": "1549179",
    "end": "1554669"
  },
  {
    "text": "platform boots and configuration of the platform so it needs to start training quite fast",
    "start": "1554669",
    "end": "1559910"
  },
  {
    "text": "because we don't want to delay the platform would so we can't wait for all the driver and services and applications",
    "start": "1559910",
    "end": "1565890"
  },
  {
    "text": "to start training so we have their bring up to provide some support for the BIOS",
    "start": "1565890",
    "end": "1572010"
  },
  {
    "text": "to start executing and doing some configuration so in case boot bodies good god and the Intel TPM is used so we",
    "start": "1572010",
    "end": "1579210"
  },
  {
    "text": "would have some of this functionality in there being you have to support this early capability during the platform but",
    "start": "1579210",
    "end": "1585110"
  },
  {
    "text": "starting CSM e12 we also started to reduce privileges of",
    "start": "1585110",
    "end": "1590190"
  },
  {
    "text": "the bring up itself so they have been previous research done by the security community under bring up and some",
    "start": "1590190",
    "end": "1596370"
  },
  {
    "text": "vulnerability were was found and it was a high privilege component so this kind",
    "start": "1596370",
    "end": "1602550"
  },
  {
    "text": "of vulnerability gave quite a lot of privileges into the chef theory itself so what we did is basically removing all",
    "start": "1602550",
    "end": "1611430"
  },
  {
    "text": "these privileges from the most of the privileges from the bring up so it can create process anymore it doesn't has",
    "start": "1611430",
    "end": "1617880"
  },
  {
    "text": "access to the keys it doesn't it can't access the debug Edward and the crypto accelerator itself then we have going up",
    "start": "1617880",
    "end": "1627870"
  },
  {
    "start": "1624000",
    "end": "1661000"
  },
  {
    "text": "in the stack we have some services and Driver like I said it's a microkernel architecture so they are running at",
    "start": "1627870",
    "end": "1634350"
  },
  {
    "text": "wingstreet for driver like I mentioned so they only get access through memory",
    "start": "1634350",
    "end": "1640470"
  },
  {
    "text": "mapped i/o to the device they need to manage and I will discuss exactly how our process can make use of driver so",
    "start": "1640470",
    "end": "1647910"
  },
  {
    "text": "this is some joint work between the channel and the VFS to ensure that even a process running inside the SME is",
    "start": "1647910",
    "end": "1653810"
  },
  {
    "text": "authorized or not to access capability exposed by the driver or service and",
    "start": "1653810",
    "end": "1662300"
  },
  {
    "start": "1661000",
    "end": "1707000"
  },
  {
    "text": "then on top of that we have the application that's the main feature that I discussed at the beginning so the",
    "start": "1662300",
    "end": "1669480"
  },
  {
    "text": "security feature like the TPM the dull the Intel AMT is a manageability",
    "start": "1669480",
    "end": "1674970"
  },
  {
    "text": "so they all run as a ring through process within the CSM iOS they get the",
    "start": "1674970",
    "end": "1680190"
  },
  {
    "text": "minimum privileges and we live the microkernel and the TCB services to",
    "start": "1680190",
    "end": "1685960"
  },
  {
    "text": "ensure they are properly isolated from each other so we don't want we want to ensure that the TPM which is the",
    "start": "1685960",
    "end": "1692230"
  },
  {
    "text": "critical security feature is not able to be for the keys of the TPM cannot be",
    "start": "1692230",
    "end": "1698290"
  },
  {
    "text": "accessed by the manageability and this is the job of the of the tcbos and the nickel can act to ensure there is a",
    "start": "1698290",
    "end": "1704530"
  },
  {
    "text": "proper isolation between the two now I will let I talk about the auditing and",
    "start": "1704530",
    "end": "1710740"
  },
  {
    "start": "1707000",
    "end": "1731000"
  },
  {
    "text": "mitigation that we have in the u.s. so",
    "start": "1710740",
    "end": "1716580"
  },
  {
    "text": "after hearing you and I talk about all the architecture and how it's built",
    "start": "1716580",
    "end": "1721630"
  },
  {
    "text": "we're going to move on to see what the type of hard anaemic a stop we put in",
    "start": "1721630",
    "end": "1726700"
  },
  {
    "text": "place in some of the sea SME and anti exploitation mitigation we have in place",
    "start": "1726700",
    "end": "1731760"
  },
  {
    "start": "1731000",
    "end": "1838000"
  },
  {
    "text": "so as in I mentioned we have a microkernel architecture meaning it's a",
    "start": "1731760",
    "end": "1737290"
  },
  {
    "text": "very reduced a small set of API it's only about 46 calls but even though it's",
    "start": "1737290",
    "end": "1742930"
  },
  {
    "text": "only a small set of api's we are actually implementing also the Karen Sisco filtering meaning even though that",
    "start": "1742930",
    "end": "1749620"
  },
  {
    "text": "you are a process and you can call the colonel it doesn't mean you can call all their sis calls itself so each process",
    "start": "1749620",
    "end": "1755350"
  },
  {
    "text": "in built time we know exactly what is the API they needs in run time so they're only giving those API access and",
    "start": "1755350",
    "end": "1761140"
  },
  {
    "text": "that's it other than that the kernel itself have stackin air protection out",
    "start": "1761140",
    "end": "1766300"
  },
  {
    "text": "of box from the compiler nothing go over there is new and because we using the",
    "start": "1766300",
    "end": "1771490"
  },
  {
    "text": "segmentation of the CPU itself and we're enforcing with the code segmentation the",
    "start": "1771490",
    "end": "1777010"
  },
  {
    "text": "data execution prevention on the cold side itself also even though what we have only a 486 CPU we actually took a",
    "start": "1777010",
    "end": "1785290"
  },
  {
    "text": "main CPU feature cause map that you can prevent actually execution of with high",
    "start": "1785290",
    "end": "1790480"
  },
  {
    "text": "privileges ring free addresses so this can prevent that as well more than that",
    "start": "1790480",
    "end": "1795730"
  },
  {
    "text": "we want to make sure that the kernel itself cannot do any corruption to read only pages so for that we're going to",
    "start": "1795730",
    "end": "1801370"
  },
  {
    "text": "use the CR write protect and all the write their own web pages are protected and you have to change the register",
    "start": "1801370",
    "end": "1807520"
  },
  {
    "text": "itself so you won't be able to access those read-only pages in runtime",
    "start": "1807520",
    "end": "1812970"
  },
  {
    "text": "also like analysis for mentioned all ring free inter-process",
    "start": "1812970",
    "end": "1818380"
  },
  {
    "text": "communication have to go through the colonel this is the implementation we decided to do meaning",
    "start": "1818380",
    "end": "1823929"
  },
  {
    "text": "ring free processes cannot directly talk with about the file system ring free processes cannot directly ask from the",
    "start": "1823929",
    "end": "1831040"
  },
  {
    "text": "actual crypto operations they have to go through the kernel itself and be validated that it is allowed so let's",
    "start": "1831040",
    "end": "1838840"
  },
  {
    "start": "1838000",
    "end": "1999000"
  },
  {
    "text": "see an example that it's kind of abstracted example by today is going to show you exactly it's being done so I'm",
    "start": "1838840",
    "end": "1844570"
  },
  {
    "text": "going to take an example so have a model called the dear emerald PvP and usually",
    "start": "1844570",
    "end": "1851350"
  },
  {
    "text": "it would like to do crypto operations so in order to do that I would like to talk to the driver and like every driver you",
    "start": "1851350",
    "end": "1856630"
  },
  {
    "text": "need to open up a file but instead of talking with the VFS of accessing the file itself but it does is accessing the",
    "start": "1856630",
    "end": "1863919"
  },
  {
    "text": "kernel itself is sending an IPC send receive I would like to open up a file the current self is going to ask and",
    "start": "1863919",
    "end": "1870429"
  },
  {
    "text": "verify for the filesystem does he have this type of access and according to the",
    "start": "1870429",
    "end": "1876190"
  },
  {
    "text": "actual verification of the VFS is going to do a reply yes that has access this",
    "start": "1876190",
    "end": "1881410"
  },
  {
    "text": "is a file just here for the handle for that and you can continue the flow now that the current knows that you can talk",
    "start": "1881410",
    "end": "1887200"
  },
  {
    "text": "with the actual driver you're going to say ok I'm going to tell the crypto driver you're going to talk also with",
    "start": "1887200",
    "end": "1893380"
  },
  {
    "text": "PvP model it is allowed and because of that the PvP Maru now can say I would",
    "start": "1893380",
    "end": "1899980"
  },
  {
    "text": "like to do a IOT a call so you're going to do I octo call with the file",
    "start": "1899980",
    "end": "1905110"
  },
  {
    "text": "descriptor and I would like na s operation on this buffer for example so",
    "start": "1905110",
    "end": "1910179"
  },
  {
    "text": "this again go through the kernel itself it cannot actually talk directly with the crypto driver the crypto driver",
    "start": "1910179",
    "end": "1916360"
  },
  {
    "text": "again verify is it allowed if it is allowed and the file descriptor was registered is a given known primitive",
    "start": "1916360",
    "end": "1924309"
  },
  {
    "text": "mutation then it's going to send the actual command of the help to drive the",
    "start": "1924309",
    "end": "1929530"
  },
  {
    "text": "device driver and then today it's operation on that buffer the crypto driver itself is going to do this some",
    "start": "1929530",
    "end": "1935890"
  },
  {
    "text": "operation with the kernel to do to make sure that it's writing correctly the buffer and the write limitation instead",
    "start": "1935890",
    "end": "1940929"
  },
  {
    "text": "of the process memory and after that everything is done so even though that",
    "start": "1940929",
    "end": "1946690"
  },
  {
    "text": "you have a process inside of the favor it doesn't even talk at any driver every process its own unique access for",
    "start": "1946690",
    "end": "1953760"
  },
  {
    "text": "drivers and only this driver is permitted and everything is known in built time so it's nothing dynamically",
    "start": "1953760",
    "end": "1959460"
  },
  {
    "text": "at all that everything is hard-coded so even though it's very because it's hardcore it is going to be harder to",
    "start": "1959460",
    "end": "1964800"
  },
  {
    "text": "create corruption that will give you better if it's collation of privileges do to modify this flow so let's say an",
    "start": "1964800",
    "end": "1973140"
  },
  {
    "text": "example that the PvP tried to do so let's say X question of privileges and talked with the Buster configure the",
    "start": "1973140",
    "end": "1979290"
  },
  {
    "text": "spaces again because it doesn't have file access permission and it's going through the kernel itself it cannot talk",
    "start": "1979290",
    "end": "1986460"
  },
  {
    "text": "with it and because of that it cannot send an octal to the device driver because it doesn't have connection to that they have to go to the driver it",
    "start": "1986460",
    "end": "1993240"
  },
  {
    "text": "for the kernel and because of that this entire communication will not be successful so because the main attack",
    "start": "1993240",
    "end": "2002660"
  },
  {
    "start": "1999000",
    "end": "2015000"
  },
  {
    "text": "vectors we have in this microkernel architecture is the ring free processes we actually have putted",
    "start": "2002660",
    "end": "2008780"
  },
  {
    "text": "a lot more effort to make sure that the expose ability is gonna be harder in case of a vulnerability first of all for",
    "start": "2008780",
    "end": "2017360"
  },
  {
    "start": "2015000",
    "end": "2041000"
  },
  {
    "text": "most we actually put a reaction to the previous issue that we had in the past",
    "start": "2017360",
    "end": "2022970"
  },
  {
    "text": "of a corruption of the context pointer that was on the stack and we changed it to being a read-only page so if you have",
    "start": "2022970",
    "end": "2029210"
  },
  {
    "text": "a corruption of the stack on the TLS section we don't have this pointer anymore so you cannot be used to do any",
    "start": "2029210",
    "end": "2034760"
  },
  {
    "text": "a bit rewrite and read when it's been corrupted because it's right now it's a read-only page and only the kernel itself can change it way very valid in",
    "start": "2034760",
    "end": "2044390"
  },
  {
    "start": "2041000",
    "end": "2065000"
  },
  {
    "text": "the secondary protection because we had the stack under protection we thought the buffer overflow we're going to be caught we saw that actually secondary",
    "start": "2044390",
    "end": "2051560"
  },
  {
    "text": "protection is useless in some cases so we decided to change modify the actual implementation of the stack canary to do",
    "start": "2051560",
    "end": "2058550"
  },
  {
    "text": "XOR with the return addresses before each function and not only on specific functions actually when you're going to",
    "start": "2058550",
    "end": "2066230"
  },
  {
    "text": "see in the social media and we're going to see juror security they actually say that yeah it was actually a feature in",
    "start": "2066230",
    "end": "2071389"
  },
  {
    "text": "the past was in wonder to the GCC version and no one know exactly why",
    "start": "2071390",
    "end": "2076909"
  },
  {
    "text": "didn't remove and and this actually been confirmed as well that the detailed self is not known why",
    "start": "2076910",
    "end": "2083129"
  },
  {
    "text": "has it been removed this feature but it is was confirmed that it was wrong analysis and this feature putting a",
    "start": "2083130",
    "end": "2090000"
  },
  {
    "text": "stack sore with the return address is more effective than the actual current implementation that we have today so",
    "start": "2090000",
    "end": "2096990"
  },
  {
    "text": "let's see why because the actual local variables doing the buffer overflow and the linear overflow the canary it's very",
    "start": "2096990",
    "end": "2104070"
  },
  {
    "text": "effectiveness is good because you have to go through all the local variables and then you actually have to run over",
    "start": "2104070",
    "end": "2110610"
  },
  {
    "text": "the canary protection so in the epilogue itself we're going to check is the same value of the does in the prologue if",
    "start": "2110610",
    "end": "2116880"
  },
  {
    "text": "it's match then it's okay if it's not you can determine the process but the",
    "start": "2116880",
    "end": "2122040"
  },
  {
    "text": "actual question is what will happen if you have a nonlinear buffer overflow if",
    "start": "2122040",
    "end": "2127500"
  },
  {
    "text": "you have a nonlinear buffer overflow then you can directly override the return address and one you're going to",
    "start": "2127500",
    "end": "2134040"
  },
  {
    "text": "reach the epilogue and you say hey is the random value change no it's the same random value let's continue the",
    "start": "2134040",
    "end": "2140130"
  },
  {
    "text": "execution and now we have a rope situation so what we've done is in the",
    "start": "2140130",
    "end": "2146250"
  },
  {
    "text": "epilogue in the prologue itself of the function before every function begins we take in the return address of this",
    "start": "2146250",
    "end": "2151590"
  },
  {
    "text": "function and we search that with the very new and random value and serve that on the stack once the epilogue itself is",
    "start": "2151590",
    "end": "2158370"
  },
  {
    "text": "heating up is we actually verify is it right to return address and the return -",
    "start": "2158370",
    "end": "2163950"
  },
  {
    "start": "2159000",
    "end": "2182000"
  },
  {
    "text": "random value by doing this type of operation we can actually eliminate not only the linear buffer overflow but also",
    "start": "2163950",
    "end": "2170610"
  },
  {
    "text": "nonlinear buffer overflow this actually will force an attacker to find different",
    "start": "2170610",
    "end": "2175650"
  },
  {
    "text": "vulnerabilities and have an additional four ability is not only single vulnerability another protection was put",
    "start": "2175650",
    "end": "2185100"
  },
  {
    "start": "2182000",
    "end": "2205000"
  },
  {
    "text": "in place is the fourth GFI the control for integrity to protect against corruption of function ports so usually",
    "start": "2185100",
    "end": "2193110"
  },
  {
    "text": "when you have a function pointer and have an indirect hole or jump so what you're doing is just D referencing a",
    "start": "2193110",
    "end": "2198390"
  },
  {
    "text": "memory appointment and referencing a memory pointers and after that you just come to that place so if you have a",
    "start": "2198390",
    "end": "2205470"
  },
  {
    "start": "2205000",
    "end": "2225000"
  },
  {
    "text": "memory corruption in that area you can actually shift the code itself to call",
    "start": "2205470",
    "end": "2211299"
  },
  {
    "text": "areas of code because of that you can create different code path so to prevent",
    "start": "2211299",
    "end": "2216909"
  },
  {
    "text": "that we actually took what we saw in the future architecture of Intel CD and over",
    "start": "2216909",
    "end": "2223119"
  },
  {
    "text": "there we have a technique called end branch so instead of directly calling a",
    "start": "2223119",
    "end": "2228880"
  },
  {
    "start": "2225000",
    "end": "2236000"
  },
  {
    "text": "or the indirect call itself and referencing the pointer first of all we read the actual place itself you're",
    "start": "2228880",
    "end": "2235239"
  },
  {
    "text": "going to call and then what you're going to do we're going to verify before the function itself",
    "start": "2235239",
    "end": "2240640"
  },
  {
    "start": "2236000",
    "end": "2260000"
  },
  {
    "text": "do you have an end branch opcode the Enbridge up code is a very unique output",
    "start": "2240640",
    "end": "2245890"
  },
  {
    "text": "for bite that doesn't exist in a regular code and we actually when we're building the entire framework with scanning the",
    "start": "2245890",
    "end": "2251469"
  },
  {
    "text": "entire code itself making sure that all the places that have this Enbridge opcode are only before function pointers",
    "start": "2251469",
    "end": "2257979"
  },
  {
    "text": "that are pre known as a function pointers and because of that we can compare it directly now",
    "start": "2257979",
    "end": "2264759"
  },
  {
    "start": "2260000",
    "end": "2292000"
  },
  {
    "text": "we're not comparing it with the immediate value of the end branch we comparing it with the value of minus 1",
    "start": "2264759",
    "end": "2270640"
  },
  {
    "text": "of the n branch this is done in order to make sure that the OP code itself of the",
    "start": "2270640",
    "end": "2276399"
  },
  {
    "text": "compare will not have the embedded immediate value inside of the OP code because if you were to do it with the",
    "start": "2276399",
    "end": "2283329"
  },
  {
    "text": "immediate value itself you actually have 1/2 more n branches so I'm going to in order to bypass that we actually",
    "start": "2283329",
    "end": "2288419"
  },
  {
    "text": "decremented by 1 and compare with minus 1 for Le if everything goes well the",
    "start": "2288419",
    "end": "2294339"
  },
  {
    "text": "process continues call this functions and if not the process is terminating we",
    "start": "2294339",
    "end": "2301899"
  },
  {
    "text": "have also hit protection against corruptions as or logical bugs issues so",
    "start": "2301899",
    "end": "2307779"
  },
  {
    "text": "first of all we have 3 for a double 3 protections so double 3 is going to be caught and going to have an exception",
    "start": "2307779",
    "end": "2314679"
  },
  {
    "text": "term in the process we have occasional it's not standard be the standard way to do milk is just getting an address if",
    "start": "2314679",
    "end": "2321219"
  },
  {
    "text": "you have it 0 size so we decided to return a null instead of a 0 and what we do is before if every hippo okay that",
    "start": "2321219",
    "end": "2328569"
  },
  {
    "text": "we're going to wrap it with with markers that say studying what is the actual",
    "start": "2328569",
    "end": "2334869"
  },
  {
    "text": "status of the the heap itself so once it's going to be freed we're going to say if the markers are still valid or",
    "start": "2334869",
    "end": "2341619"
  },
  {
    "text": "not we only detect the corruption and during the free in order to make sure we don't have any performance",
    "start": "2341619",
    "end": "2347230"
  },
  {
    "text": "impact so the detection can only be yeah the corruption detection can all be done",
    "start": "2347230",
    "end": "2353500"
  },
  {
    "text": "during the free operations and of course locking the kernel itself we are",
    "start": "2353500",
    "end": "2359500"
  },
  {
    "start": "2356000",
    "end": "2372000"
  },
  {
    "text": "actually using again the segmentation option of the CPU in order to enforce",
    "start": "2359500",
    "end": "2364510"
  },
  {
    "text": "that execution prevention in place so only code segments are the only one that permitted to run as a part of the",
    "start": "2364510",
    "end": "2374799"
  },
  {
    "start": "2372000",
    "end": "2392000"
  },
  {
    "text": "hardening is not about only making the bugs harder to be exploited we actually need to make sure that all the hardening",
    "start": "2374799",
    "end": "2381609"
  },
  {
    "text": "is done also to make find the bugs harder in order to do that we need to have in place a good teacher to develop",
    "start": "2381609",
    "end": "2387910"
  },
  {
    "text": "a black cycle to find all the issues before we actually ship in the product itself so there's security available",
    "start": "2387910",
    "end": "2394450"
  },
  {
    "start": "2392000",
    "end": "2544000"
  },
  {
    "text": "life cycles just putting in every step of the way cycle of security personnel",
    "start": "2394450",
    "end": "2399579"
  },
  {
    "text": "that actually review the entire thing so it's good to have a new architecture or a new suggestion of a change they have",
    "start": "2399579",
    "end": "2405640"
  },
  {
    "text": "to modify it by a security person you have to be audited if you're going to do code review it if you're going to have a",
    "start": "2405640",
    "end": "2411190"
  },
  {
    "text": "new code written in place so if we have special skilled people that only doing the security code view and not the",
    "start": "2411190",
    "end": "2417579"
  },
  {
    "text": "functionality code review and of course we have a dedicated team also to do the penetration testing stuff and do the",
    "start": "2417579",
    "end": "2424059"
  },
  {
    "text": "actually testing for security objective a matching although the security",
    "start": "2424059",
    "end": "2431140"
  },
  {
    "text": "analysis of the threat modeling and the code review is very interesting I think for this type of talk we want to focus",
    "start": "2431140",
    "end": "2438579"
  },
  {
    "text": "were the actual way of how we detect bugs in the penetration testing phases so we're going to move that up to that",
    "start": "2438579",
    "end": "2445710"
  },
  {
    "text": "so in order to make a good detection of bugs during the protection testing",
    "start": "2445710",
    "end": "2451540"
  },
  {
    "text": "phases we need to use the same industrial techniques that exist in the manor-house on the software side also in",
    "start": "2451540",
    "end": "2457990"
  },
  {
    "text": "the silicon side and not only on simulation because we want to make sure that the silicon itself is validated and",
    "start": "2457990",
    "end": "2463510"
  },
  {
    "text": "not the simulator of it so until you have all these capabilities in actual silicon and run up and running so the",
    "start": "2463510",
    "end": "2471369"
  },
  {
    "text": "first thing we wanted to make sure that we can use is address into zation so as",
    "start": "2471369",
    "end": "2476470"
  },
  {
    "text": "a civilization for those No is it technically can instrument the fury the actual code itself any code",
    "start": "2476470",
    "end": "2483450"
  },
  {
    "text": "with our silent Clank or GCC with more instrumentation that can detect off by",
    "start": "2483450",
    "end": "2490630"
  },
  {
    "text": "ones event that doesn't create crashes so we want to catch all those crashing bugs and root cursing very easily and",
    "start": "2490630",
    "end": "2497589"
  },
  {
    "text": "also those that doesn't create a crash and this is a available doing the address into zation the problem with a",
    "start": "2497589",
    "end": "2504970"
  },
  {
    "text": "descent ization is it doesn't work for us it cannot work for us because it we",
    "start": "2504970",
    "end": "2510670"
  },
  {
    "text": "are not gypsy and also we are different CPU that was developed for so we are a",
    "start": "2510670",
    "end": "2516160"
  },
  {
    "text": "four-pound online and the actual development is for a byline and also there is some mapping that the being",
    "start": "2516160",
    "end": "2524530"
  },
  {
    "text": "done that all the shadowing or all the addresses to keep all the metadata we store in the fixed address high-hat rest",
    "start": "2524530",
    "end": "2531010"
  },
  {
    "text": "location that we don't have and you cannot modify it and of course once you're going to do all this step of",
    "start": "2531010",
    "end": "2536920"
  },
  {
    "text": "instrumentation the code itself what's going to inflate and we don't have enough estarn size order to treat it so",
    "start": "2536920",
    "end": "2542500"
  },
  {
    "text": "we have to solve it as well so for the G op C is quite easy because all we have",
    "start": "2542500",
    "end": "2547599"
  },
  {
    "start": "2544000",
    "end": "2558000"
  },
  {
    "text": "to do is just activate the flag of F sanitizer and see where it crash and you",
    "start": "2547599",
    "end": "2553000"
  },
  {
    "text": "can see all the function that's actually missing and you can implement them on your own so we done that and the hard",
    "start": "2553000",
    "end": "2559450"
  },
  {
    "start": "2558000",
    "end": "2596000"
  },
  {
    "text": "part were we didn't want to change the actions mutation that was done by a sonnet has it's our work so whenever",
    "start": "2559450",
    "end": "2566529"
  },
  {
    "text": "we're hitting your error flow it's going to go to those API that we implemented and because of that we can check do we",
    "start": "2566529",
    "end": "2574869"
  },
  {
    "text": "fail because it was a real issue or is it because it's at for buy online value",
    "start": "2574869",
    "end": "2579940"
  },
  {
    "text": "if it's a for byline value you can continue the flow no need to actually crash the system in order to make sure",
    "start": "2579940",
    "end": "2585760"
  },
  {
    "text": "that the system flow itself we can continue after entering your airflow you have to use the absolute Iser recover",
    "start": "2585760",
    "end": "2590980"
  },
  {
    "text": "address so we can tell them to create the right flow itself and not crash the system another feature that we want to",
    "start": "2590980",
    "end": "2599319"
  },
  {
    "start": "2596000",
    "end": "2640000"
  },
  {
    "text": "add is to change the address itself and this is not you know actually every embedded devices they want to do this",
    "start": "2599319",
    "end": "2605589"
  },
  {
    "text": "type of featuring as can I modify this address and actually there is an option",
    "start": "2605589",
    "end": "2611109"
  },
  {
    "text": "called F sanitizer at carriages that you can specify where you would like to remove the address to the problem is those two",
    "start": "2611109",
    "end": "2617730"
  },
  {
    "text": "feature doesn't work together in the option common line so it was discussed",
    "start": "2617730",
    "end": "2623250"
  },
  {
    "text": "and the Google Forms a lot of times can you fix it can you fix it and no one fix that and we just patch the GCC because",
    "start": "2623250",
    "end": "2631140"
  },
  {
    "text": "it's only for testing and modify the code itself so we can have both living together and we can modify the actual",
    "start": "2631140",
    "end": "2637860"
  },
  {
    "text": "addresses of the shadowing the last one is going to it to inflate the code",
    "start": "2637860",
    "end": "2645000"
  },
  {
    "start": "2640000",
    "end": "2679000"
  },
  {
    "text": "itself there is no escape from that and in order to make sure that we can work with that",
    "start": "2645000",
    "end": "2650190"
  },
  {
    "text": "instead of instrumenting the entire framework we're instrumenting each process at a time meaning we have to",
    "start": "2650190",
    "end": "2655980"
  },
  {
    "text": "create a lot of images but only a specific process is instrumented at a",
    "start": "2655980",
    "end": "2661350"
  },
  {
    "text": "time that way we can ship it only to a specific component owner to do the validation testing and only his",
    "start": "2661350",
    "end": "2667740"
  },
  {
    "text": "component is instrumented and this still works in silicon so we have right now",
    "start": "2667740",
    "end": "2675810"
  },
  {
    "text": "achieve address sanitization also in silicon now we have to do the fuzzing",
    "start": "2675810",
    "end": "2681900"
  },
  {
    "start": "2679000",
    "end": "2698000"
  },
  {
    "text": "part what I'm going to do the fuzzing part we want to use the latest greatest technique we had already fuzzing",
    "start": "2681900",
    "end": "2687510"
  },
  {
    "text": "capability inside of the security team but we want to have the coverage guided",
    "start": "2687510",
    "end": "2692610"
  },
  {
    "text": "fuzzing as well again it's required instrumentation that doesn't exist for the silicon air environments so what",
    "start": "2692610",
    "end": "2698850"
  },
  {
    "start": "2698000",
    "end": "2720000"
  },
  {
    "text": "we've done is actually read up the code of afl-nfl is created a very unique way of how to do instrumentation so we just",
    "start": "2698850",
    "end": "2705900"
  },
  {
    "text": "modified the entire sanitation code itself to fit our needs so once we look",
    "start": "2705900",
    "end": "2711360"
  },
  {
    "text": "up and read up how FL is looking we saw there is an issue the issue itself is never discussed before but the bitmap",
    "start": "2711360",
    "end": "2719280"
  },
  {
    "text": "size of FL is fixed only to 2 by 16 meaning if you have more branches than 2",
    "start": "2719280",
    "end": "2726600"
  },
  {
    "start": "2720000",
    "end": "2758000"
  },
  {
    "text": "by 16 you have collisions because it doesn't have fit into the array of the",
    "start": "2726600",
    "end": "2732690"
  },
  {
    "text": "map so for those of doing fuzzing right now and you're doing a larger",
    "start": "2732690",
    "end": "2739050"
  },
  {
    "text": "application you have more than 2 by 16 you're doing it wrong you have to change",
    "start": "2739050",
    "end": "2744750"
  },
  {
    "text": "code of FL so just keep you in mind it so we change that make sure that every",
    "start": "2744750",
    "end": "2750660"
  },
  {
    "text": "process has the right bit of sizes so right now every bit size is the address accordingly to the process serve and we",
    "start": "2750660",
    "end": "2757230"
  },
  {
    "text": "have it correct sized another issue that we sign implies that we don't have pipe memory UFO is using memory pipes and",
    "start": "2757230",
    "end": "2764490"
  },
  {
    "start": "2758000",
    "end": "2773000"
  },
  {
    "text": "forts in order to get the bitmap addresses so in order to fetch all the array of what actually what was the path",
    "start": "2764490",
    "end": "2771000"
  },
  {
    "text": "we actually need to implement our own instrumentation so what we've done over there and we actually implemented in the",
    "start": "2771000",
    "end": "2777390"
  },
  {
    "text": "test model api's that we can actually get the array to be internally of that",
    "start": "2777390",
    "end": "2782730"
  },
  {
    "text": "we put over there that actually reports all the flow itself so let's see how the",
    "start": "2782730",
    "end": "2788310"
  },
  {
    "text": "actual fuzzer is looking like so we have a faster test harness that using all the",
    "start": "2788310",
    "end": "2793380"
  },
  {
    "text": "test collection now the test code here is very unique it's not just a test collection we actually take all the",
    "start": "2793380",
    "end": "2798960"
  },
  {
    "text": "tests of the validations that we have we run it a minimum set and with the minimum set we actually verify that we",
    "start": "2798960",
    "end": "2805860"
  },
  {
    "text": "get only the unique path that's been a generation so only the unique path turns",
    "start": "2805860",
    "end": "2810870"
  },
  {
    "text": "tests that exist in the validation are being fast so this reduced the amount of fuzzing that we need to do on the actual",
    "start": "2810870",
    "end": "2817920"
  },
  {
    "text": "cycling of the tests so once the test itself is executed and mutated it's",
    "start": "2817920",
    "end": "2823200"
  },
  {
    "start": "2819000",
    "end": "2824000"
  },
  {
    "text": "running on the field itself the FIR itself is instrumented meaning each branch has its own unique ID and because",
    "start": "2823200",
    "end": "2830010"
  },
  {
    "text": "of that is going to be reported directly only the right memory once the test",
    "start": "2830010",
    "end": "2835710"
  },
  {
    "start": "2835000",
    "end": "2864000"
  },
  {
    "text": "itself is over we calling our special test API to say give me all the feedback of all the test execution that was done",
    "start": "2835710",
    "end": "2841980"
  },
  {
    "text": "and the Fuhrer itself is going to return back of the beret that holds all the memory now the path manager can take and",
    "start": "2841980",
    "end": "2850020"
  },
  {
    "text": "analyze previous execution and the current execution have I find out a new path and decided to add it to the test",
    "start": "2850020",
    "end": "2856470"
  },
  {
    "text": "collection for further execution mutation so we have that in place as",
    "start": "2856470",
    "end": "2863100"
  },
  {
    "text": "well up until now what we discuss is",
    "start": "2863100",
    "end": "2868320"
  },
  {
    "start": "2864000",
    "end": "2984000"
  },
  {
    "text": "more about how in towards building the system and how implement is designing the system and what we're doing in order",
    "start": "2868320",
    "end": "2875160"
  },
  {
    "text": "to assure security on the system but after the system is completely developed is being shipped to the actual",
    "start": "2875160",
    "end": "2881830"
  },
  {
    "text": "manufactured lines and the manufacturing itself is not the chip that we are doing is the actual integration part in the",
    "start": "2881830",
    "end": "2888369"
  },
  {
    "text": "actual partners that we have so we're going to talk now about the vote about the pre manufacturing and the post",
    "start": "2888369",
    "end": "2894640"
  },
  {
    "text": "manufacturing ability in the actual CH semi and the TCH itself so lay your",
    "start": "2894640",
    "end": "2902260"
  },
  {
    "text": "night has already mentioned that but I'm going to repeat that so some feature are still modifiable or configurable to work",
    "start": "2902260",
    "end": "2909640"
  },
  {
    "text": "or not during the manufacturing phases so usually manufacturer decide to sell",
    "start": "2909640",
    "end": "2915280"
  },
  {
    "text": "it for consumer SKUs or to corporate SKUs and according to that what features they would like to have on that and you",
    "start": "2915280",
    "end": "2921340"
  },
  {
    "text": "can actually do create and say I would like to support manageability I don't want to support manageability do I want",
    "start": "2921340",
    "end": "2928060"
  },
  {
    "text": "to support anti roll back to have this physical attack or not and also do I",
    "start": "2928060",
    "end": "2933550"
  },
  {
    "text": "want to save in the fuses itself the manufacturer public-key learn to use it for later on other features for example",
    "start": "2933550",
    "end": "2941500"
  },
  {
    "text": "one of this feature that the manufacturer line can do is it can actually decide that PTT the integrated",
    "start": "2941500",
    "end": "2948010"
  },
  {
    "text": "TPM of CSM II is not working I would like to use a descriptive here is an option also for the actual manufacturers",
    "start": "2948010",
    "end": "2953890"
  },
  {
    "text": "so Intel is giving all the guidance to the action manufacturers and making sure",
    "start": "2953890",
    "end": "2958960"
  },
  {
    "text": "that all the process being done itself because it was working with the partner itself and assuring that all the thing",
    "start": "2958960",
    "end": "2964359"
  },
  {
    "text": "itself has been properly stored and in place so the manufacturer only need to",
    "start": "2964359",
    "end": "2970210"
  },
  {
    "text": "do the end of manufacturing flow meaning to commit all the changes that they want to make sure that it's happening and once it's committing all the flash",
    "start": "2970210",
    "end": "2976930"
  },
  {
    "text": "spice descriptors being locked and all the access the fuses are being locked as well so after that the perk itself can",
    "start": "2976930",
    "end": "2987369"
  },
  {
    "start": "2984000",
    "end": "3139000"
  },
  {
    "text": "be shipped and get to the end user but again even though that it's getting to",
    "start": "2987369",
    "end": "2992380"
  },
  {
    "text": "the end user the end user itself has more capability to do the actual configuration of the CSM II but mainly",
    "start": "2992380",
    "end": "2998440"
  },
  {
    "text": "in the manageability side so for the rest of the site we don't have anything exposed but for the manageability side",
    "start": "2998440",
    "end": "3003960"
  },
  {
    "text": "there is some expose API with the BIOS vendors so we can actually decide which",
    "start": "3003960",
    "end": "3009030"
  },
  {
    "text": "feature is enabled or not during the actually manageability phases so you can opt in or out if you want to",
    "start": "3009030",
    "end": "3015890"
  },
  {
    "text": "support some feature in how to provision the system so if you don't want to provision the system engine does opt out",
    "start": "3015890",
    "end": "3021920"
  },
  {
    "text": "of it and that's it once the",
    "start": "3021920",
    "end": "3027410"
  },
  {
    "text": "manufacturing is done and the configuration by user Braden done we'll still need to have a key critical",
    "start": "3027410",
    "end": "3032620"
  },
  {
    "text": "feature and that of course to be able to be updated on the field and also we need",
    "start": "3032620",
    "end": "3038960"
  },
  {
    "text": "to make sure that we can be recovered on the fields well if something was highly compromised in the TCB area so for that",
    "start": "3038960",
    "end": "3046700"
  },
  {
    "text": "we have a secure film update so the very update itself is difficult to design by in tow and whenever you have a new",
    "start": "3046700",
    "end": "3054380"
  },
  {
    "text": "version it's going to first of all make sure that the signature is intact and can be used but before it's flashing the",
    "start": "3054380",
    "end": "3060590"
  },
  {
    "text": "system itself is first of all making sure that the version control number is correctly inserted because we have a",
    "start": "3060590",
    "end": "3067100"
  },
  {
    "text": "policy of saying that you can do it down great operation if you want but only for",
    "start": "3067100",
    "end": "3072350"
  },
  {
    "text": "a specific version because more major version of the versions may have security vulnerability so we don't want",
    "start": "3072350",
    "end": "3078950"
  },
  {
    "text": "you to go through a downward phases to those images so we can decide what what",
    "start": "3078950",
    "end": "3087560"
  },
  {
    "text": "can be done or not another thing that we have in place is a physical address a",
    "start": "3087560",
    "end": "3093320"
  },
  {
    "text": "physical anti-roll back check and because of that we can actually decide that was the new security version",
    "start": "3093320",
    "end": "3098750"
  },
  {
    "text": "interviewer we're not going to update you to a new a lower security version and that's it so the last one is the fer",
    "start": "3098750",
    "end": "3107270"
  },
  {
    "text": "update itself all it's being done we actually going to do the update to a",
    "start": "3107270",
    "end": "3114740"
  },
  {
    "text": "higher TCB and if there is a higher TCB update we're actually going to create a",
    "start": "3114740",
    "end": "3119960"
  },
  {
    "text": "new keys to the manufacturing flows and also we're going to recreate all that",
    "start": "3119960",
    "end": "3125840"
  },
  {
    "text": "the station values itself to wrap up the talk itself this is the first time that",
    "start": "3125840",
    "end": "3132350"
  },
  {
    "text": "Intel is actually exposing all the flow itself and all the details about how we do the manufacturing how do it",
    "start": "3132350",
    "end": "3137510"
  },
  {
    "text": "validation and everything is operated so we want to keep you in mind that it's a",
    "start": "3137510",
    "end": "3144720"
  },
  {
    "start": "3139000",
    "end": "3178000"
  },
  {
    "text": "well-designed system and security minded to make sure that everything is with lease privileges everything is a secure",
    "start": "3144720",
    "end": "3151559"
  },
  {
    "text": "boot and we have security recovering place and we are not stopping there we're also always evolving and creating",
    "start": "3151559",
    "end": "3158519"
  },
  {
    "text": "more feature if it's for less privileges for our processes or whatever doing the platform itself or maybe to add future",
    "start": "3158519",
    "end": "3166079"
  },
  {
    "text": "and exploitation mechanism or maybe to take future technique that exists the hosts appear for example and also to the",
    "start": "3166079",
    "end": "3173640"
  },
  {
    "text": "CSN itself thank you very much [Applause]",
    "start": "3173640",
    "end": "3180629"
  }
]