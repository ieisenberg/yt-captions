[
  {
    "start": "0",
    "end": "225000"
  },
  {
    "text": "good afternoon everyone hi hi how's everybody doing good that's perfect",
    "start": "60",
    "end": "7290"
  },
  {
    "text": "I like this kind of responses very good okay good so no time to loose let's get",
    "start": "7290",
    "end": "13259"
  },
  {
    "text": "started welcome with my presentation this is C key tools that new ultimate",
    "start": "13259",
    "end": "18480"
  },
  {
    "text": "hacking toolkit just a few words about the team myself and the presentation so",
    "start": "18480",
    "end": "24210"
  },
  {
    "text": "that we got it all clear and the timing because we've got a one-hour slot but it's a 25 minute",
    "start": "24210",
    "end": "30300"
  },
  {
    "text": "presentation so I'm gonna do it us in the schedule but we're gonna make it",
    "start": "30300",
    "end": "35940"
  },
  {
    "text": "actually additionally for the next 35 minutes if you want to stay you're most",
    "start": "35940",
    "end": "41579"
  },
  {
    "text": "welcome because we've got over 200 tools so we've been in 25 minutes it's kind of hard even though I'll do my best but",
    "start": "41579",
    "end": "48989"
  },
  {
    "text": "eventually for the first part we're gonna do some interesting ones so a few words as you see Paulo Jay I am",
    "start": "48989",
    "end": "58079"
  },
  {
    "text": "the CEO of secure company that is right now a little bit over 10 years old we",
    "start": "58079",
    "end": "63090"
  },
  {
    "text": "are doing different types of custom penetration tests for our customer cyber security strategies and also educational",
    "start": "63090",
    "end": "70619"
  },
  {
    "text": "services and eventually my team has grown a little bit right now it's 40",
    "start": "70619",
    "end": "76619"
  },
  {
    "text": "people we do have our R&D department and we are spreaded across four locations in",
    "start": "76619",
    "end": "82200"
  },
  {
    "text": "the world which is New York device Switzerland and Poland so this is us and",
    "start": "82200",
    "end": "88200"
  },
  {
    "text": "eventually our toolkit it's something that I'm super happy to present because",
    "start": "88200",
    "end": "94070"
  },
  {
    "text": "eventually this is a toolkit that we just use in practice so every single",
    "start": "94070",
    "end": "99240"
  },
  {
    "text": "time we've got a project and we need something and there's no tool for that and it's for example a forensics project",
    "start": "99240",
    "end": "104939"
  },
  {
    "text": "or something to be researched about then we simply speaking start writing our",
    "start": "104939",
    "end": "110970"
  },
  {
    "text": "tools and that is pretty much the whole the whole background out there so this",
    "start": "110970",
    "end": "116280"
  },
  {
    "text": "is this is the whole concept now whenever we are thinking of course about the tools and everything sharing and",
    "start": "116280",
    "end": "123750"
  },
  {
    "text": "blog posts and the white papers about it you're gonna find that on our secure academy.com slash blog just five minutes",
    "start": "123750",
    "end": "131009"
  },
  {
    "text": "before my presentation is / this is kind of how we always do it with my team so right now even if you",
    "start": "131009",
    "end": "137510"
  },
  {
    "text": "enter the block you will not find the tools but just five minutes before you will be able to find us so technically I",
    "start": "137510",
    "end": "143420"
  },
  {
    "text": "also tend to speak at the various conferences black hat is definitely one of those I also do you are pretty much",
    "start": "143420",
    "end": "150590"
  },
  {
    "text": "the presentation about the era say Microsoft ignite and there is only one reason for that because our team loves",
    "start": "150590",
    "end": "157430"
  },
  {
    "text": "to share so whatever we do we share and this is technically one of the",
    "start": "157430",
    "end": "162440"
  },
  {
    "text": "opportunities so hopefully you guys going to like it so more information of",
    "start": "162440",
    "end": "168200"
  },
  {
    "text": "course about us you'll be able to find in any other information about the blog",
    "start": "168200",
    "end": "174230"
  },
  {
    "text": "but let's get into the content this is the presentation about the toolkit so no",
    "start": "174230",
    "end": "179840"
  },
  {
    "text": "time to lose as we mentioned so let's do it so for at the very beginning it's gonna",
    "start": "179840",
    "end": "185510"
  },
  {
    "text": "be in general the flow that we're gonna did like one by one of course I will give you explanation or what this tool does we're gonna start with like small",
    "start": "185510",
    "end": "192410"
  },
  {
    "text": "chunks of tools so this tool allows you to extract this this one allows you to extract that and then we're gonna get",
    "start": "192410",
    "end": "198320"
  },
  {
    "text": "into the scenario of the data decryption by leveraging data protection API this",
    "start": "198320",
    "end": "204590"
  },
  {
    "text": "is kind of our a two years research so eventually you will see how it is possible to violate completely a privacy",
    "start": "204590",
    "end": "212000"
  },
  {
    "text": "on the whole domain level and our team reverse engineers data protection API to",
    "start": "212000",
    "end": "218420"
  },
  {
    "text": "the bone so anything that moves and it's encrypted will be able to decrypt so",
    "start": "218420",
    "end": "223640"
  },
  {
    "text": "this is pretty much the flavor here okay guys so let me just switch it off and let's start with that first type of tool",
    "start": "223640",
    "end": "230570"
  },
  {
    "start": "225000",
    "end": "360000"
  },
  {
    "text": "which is technically a very straightforward tool which is related with extracting hashes from the",
    "start": "230570",
    "end": "237380"
  },
  {
    "text": "operating system and that's this one over here this is a CQ hashed on version - and on the live system the only way",
    "start": "237380",
    "end": "244280"
  },
  {
    "text": "how you need to run it is just some dump and that's it so very simple nothing's nothing",
    "start": "244280",
    "end": "251450"
  },
  {
    "text": "property in particular over here of course we are getting access to the some database by leveraging all this",
    "start": "251450",
    "end": "258850"
  },
  {
    "text": "decryption mechanisms that are on the phone in the operating system but ending up with the harshest to be to be",
    "start": "258850",
    "end": "266160"
  },
  {
    "text": "extracted this particular tool works very nicely because not everybody wants to run it on the server in life so",
    "start": "266160",
    "end": "272820"
  },
  {
    "text": "eventually you can run it by leveraging its offline switches so we run it in the",
    "start": "272820",
    "end": "278700"
  },
  {
    "text": "same way but just to show you in general we need to specify here some and some",
    "start": "278700",
    "end": "284070"
  },
  {
    "text": "database sis and system hive if you got a copy of the registry and this is",
    "start": "284070",
    "end": "289350"
  },
  {
    "text": "something that also allows you let me just do it for the moment some I'm just gonna use that in this way",
    "start": "289350",
    "end": "297050"
  },
  {
    "text": "here we go and then we've got some and are we gonna do are some dump let me just verify if God is yeah we got it",
    "start": "297050",
    "end": "303810"
  },
  {
    "text": "correctly now as you see it's case sensitive yes so we've got a different output so we've got administrator and",
    "start": "303810",
    "end": "309690"
  },
  {
    "text": "guess just to show you basically that this is working on the offline data so just a quick quick intro now of course",
    "start": "309690",
    "end": "316740"
  },
  {
    "text": "in order to be able to extract hashes from the live operating system you have",
    "start": "316740",
    "end": "321750"
  },
  {
    "text": "to be a privileged to do that and for that particular purpose you need to be a",
    "start": "321750",
    "end": "327780"
  },
  {
    "text": "local system because some database has by default permissions set up to be accessed by the local system so the",
    "start": "327780",
    "end": "334200"
  },
  {
    "text": "question of the universe would be okay that's fine but how eventually we are able to get access to this particular",
    "start": "334200",
    "end": "343250"
  },
  {
    "text": "local system privileges if of course well I'm in a position of the",
    "start": "343250",
    "end": "349980"
  },
  {
    "text": "administrator in such case you could use PS exact for that and this privilege",
    "start": "349980",
    "end": "355080"
  },
  {
    "text": "that you are actually leveraging over here this is an impersonal client after authentication provident",
    "start": "355080",
    "end": "360660"
  },
  {
    "start": "360000",
    "end": "420000"
  },
  {
    "text": "or you can use our tool which is pretty nice and if you want to impersonate into",
    "start": "360660",
    "end": "366090"
  },
  {
    "text": "the privilege account we've got over here CQ impersonate secure administrator CMD dot exe and if you're going around",
    "start": "366090",
    "end": "372780"
  },
  {
    "text": "that particular command what it does it opens a command where you are actually a particular user we're leveraging over",
    "start": "372780",
    "end": "379620"
  },
  {
    "text": "here the impersonate a client after indication case so technically speaking",
    "start": "379620",
    "end": "384840"
  },
  {
    "text": "if you've got already a user that established a session in the particular operating system without knowing that",
    "start": "384840",
    "end": "391620"
  },
  {
    "text": "user's password you are able to take over that user's session we another tool that is allowing you to",
    "start": "391620",
    "end": "397790"
  },
  {
    "text": "create a token of the user that never logged on to that system though eventually this token is good more from",
    "start": "397790",
    "end": "405140"
  },
  {
    "text": "the forensics perspective versus of doing actual hacking activity so a bit",
    "start": "405140",
    "end": "411590"
  },
  {
    "text": "of an introduction so whenever we are thinking of course about making a little",
    "start": "411590",
    "end": "416750"
  },
  {
    "text": "bit further step over here question would be are we able to extract for",
    "start": "416750",
    "end": "421790"
  },
  {
    "start": "420000",
    "end": "760000"
  },
  {
    "text": "example within the operating system some data from the entities that did entities",
    "start": "421790",
    "end": "427820"
  },
  {
    "text": "that it of course is a file that contains hashes of the users on the domain controller so the structure of",
    "start": "427820",
    "end": "434990"
  },
  {
    "text": "the database is a little bit different and we also do Active Directory forensics and eventually for that",
    "start": "434990",
    "end": "440780"
  },
  {
    "text": "purpose we wrote a bunch of tools for that by one of our most popular tools it's called CQ NT dsdt Decrypter and",
    "start": "440780",
    "end": "448340"
  },
  {
    "text": "this is a tool that allows you on the fly this is this is just an offline",
    "start": "448340",
    "end": "453500"
  },
  {
    "text": "extraction extract hashes of course from ant ideas or did so let's have a look what we can do so if we do have a look",
    "start": "453500",
    "end": "460700"
  },
  {
    "text": "at the option that particular key actually the particular tool leverage is something that is called a boot key and",
    "start": "460700",
    "end": "467560"
  },
  {
    "text": "here I think we need to stop a little bit because we need to pass a little bit of a theory here what's the boot key and",
    "start": "467560",
    "end": "474230"
  },
  {
    "text": "boot key it's a key that you're going to find in the system registry hive that is",
    "start": "474230",
    "end": "479540"
  },
  {
    "text": "in a days of protection API field decrypting system secret so if you want to steal someone's hashes either it's a",
    "start": "479540",
    "end": "486980"
  },
  {
    "text": "some database or NTDs or did you have to have a boot key available that's why in",
    "start": "486980",
    "end": "492380"
  },
  {
    "text": "a previous tool I was using - says system so that you were able to see that we are actually reading the boot key",
    "start": "492380",
    "end": "499700"
  },
  {
    "text": "from there so we're gonna do it here as well but from a little bit different perspective so I do have a live system",
    "start": "499700",
    "end": "507100"
  },
  {
    "text": "where I'm gonna be technically this is a domain controller when I'm gonna be extracting the hashes from so a question",
    "start": "507100",
    "end": "514430"
  },
  {
    "text": "would be at that certain point how are we able to get that particular boot key",
    "start": "514430",
    "end": "519469"
  },
  {
    "text": "and answer to that is very simple this is the live domain controller eventually",
    "start": "519470",
    "end": "524570"
  },
  {
    "text": "I'm gonna be using another tool which is called CQ secrets dumper we're going to be coming back to the",
    "start": "524570",
    "end": "530160"
  },
  {
    "text": "stool because it's a very nice tool it has a lot of functionalities including extracting passwords in a clear text",
    "start": "530160",
    "end": "536550"
  },
  {
    "text": "from the service accounts so we're going to just specify over here boot key like",
    "start": "536550",
    "end": "542190"
  },
  {
    "text": "this boot key here we go and then we've got a value yeah so this is this particular thing that I will need to",
    "start": "542190",
    "end": "549030"
  },
  {
    "text": "copy in order to move forward with the further steps of a hashes extraction",
    "start": "549030",
    "end": "554730"
  },
  {
    "text": "from NTDs don't it of course you need to make a copy of entities that did the easiest way most probably to do it is by",
    "start": "554730",
    "end": "561270"
  },
  {
    "text": "using the building windows tool which is called VSS admin create shadow for C",
    "start": "561270",
    "end": "566400"
  },
  {
    "text": "Drive Bank and you've got a copy of that ant IDs don't it okay guys let's keep it",
    "start": "566400",
    "end": "572010"
  },
  {
    "text": "rolling so we're gonna do it like this CQ anti-dsdna krypter and over here",
    "start": "572010",
    "end": "579060"
  },
  {
    "text": "we're gonna specify our boot key so let's just paste it here we go and then we're gonna specify the file and that's",
    "start": "579060",
    "end": "586260"
  },
  {
    "text": "gonna be nice because here we're gonna move forward into D Drive tools NTDs and",
    "start": "586260",
    "end": "592440"
  },
  {
    "text": "NTDs dodged it and one of the parameters that we will need to use as well it's",
    "start": "592440",
    "end": "597870"
  },
  {
    "text": "out file and within the out file we will specify hashes dot txt for example and a",
    "start": "597870",
    "end": "605640"
  },
  {
    "text": "couple of other things we could specify over here like the pfx KD s root key and so on but this is something again that",
    "start": "605640",
    "end": "611790"
  },
  {
    "text": "I'm gonna be explaining later because right now it's gonna be a little bit too much about one thing this is also a multifunctional tool about security and",
    "start": "611790",
    "end": "619430"
  },
  {
    "text": "identity in general protection in Active Directory so let's do that so right now",
    "start": "619430",
    "end": "624750"
  },
  {
    "text": "we are extracting our hashes let's have a look Asha's dot txt and let's see what",
    "start": "624750",
    "end": "632370"
  },
  {
    "text": "we cut a half over here and this is the file it is fully importable in any type",
    "start": "632370",
    "end": "638010"
  },
  {
    "text": "of a cracking tools that you're gonna guys find even for free not for free or whatever it's a very very nice format",
    "start": "638010",
    "end": "644790"
  },
  {
    "text": "here you can even import it in Excel and find in your domain different types of hashes duplicates to see if there is",
    "start": "644790",
    "end": "651390"
  },
  {
    "text": "someone actually reusing the password so what we got over here let's find something nice over here so just kind of",
    "start": "651390",
    "end": "658770"
  },
  {
    "text": "like learnt knowing this by heart but nineteen it's a hush or MD for hush as",
    "start": "658770",
    "end": "664709"
  },
  {
    "text": "we should say all very popular password which is a peek at ESS w0 early and we",
    "start": "664709",
    "end": "671490"
  },
  {
    "text": "are able to see that Freddy in this particular case user has this particular MD for of a password which we",
    "start": "671490",
    "end": "678480"
  },
  {
    "text": "could technically either crack or guess maybe not that will be quite hard but if",
    "start": "678480",
    "end": "683850"
  },
  {
    "text": "you're familiar with this popular password hashes then maybe guess - so this is a little bit of an intro for",
    "start": "683850",
    "end": "690509"
  },
  {
    "text": "what we can do with our tools and so you can see that we are able to extract some type of information that we've got in",
    "start": "690509",
    "end": "698339"
  },
  {
    "text": "the either hashes or some database or entities so did now question is what else so I was mentioning that we cannot",
    "start": "698339",
    "end": "705269"
  },
  {
    "text": "be back to the CQ secrets dumper this is by the way historically our first tool that was written by our team",
    "start": "705269",
    "end": "711809"
  },
  {
    "text": "in 2008 and we totally loved it this tool has been going through different types of transformations but",
    "start": "711809",
    "end": "718679"
  },
  {
    "text": "eventually the major functionality of this tool it's related with decrypting",
    "start": "718679",
    "end": "723990"
  },
  {
    "text": "local system secrets and by local system secrets we mean for example our service",
    "start": "723990",
    "end": "729839"
  },
  {
    "text": "accounts so let's have a look at this demonstration where we're gonna be technically the crib think the service",
    "start": "729839",
    "end": "737550"
  },
  {
    "text": "accounts passwords and you will see how totally simple that that operation is so",
    "start": "737550",
    "end": "744300"
  },
  {
    "text": "in general when we are thinking of course about the the case where we've",
    "start": "744300",
    "end": "749490"
  },
  {
    "text": "got services and particular password what we are referring to is the",
    "start": "749490",
    "end": "754800"
  },
  {
    "text": "following situation so let me of course show you the concept over here yeah so",
    "start": "754800",
    "end": "760160"
  },
  {
    "text": "let me bring this machine we got it so we've got technically here services and",
    "start": "760160",
    "end": "766410"
  },
  {
    "text": "I got a pool of service pull a service that could be the one that we could work",
    "start": "766410",
    "end": "771449"
  },
  {
    "text": "on and we could specify that we should run it on the specific account now what I will type right now it doesn't really",
    "start": "771449",
    "end": "778049"
  },
  {
    "text": "matter what matters is where that data is stored and the rule is always the same first is whatever you put in over",
    "start": "778049",
    "end": "785549"
  },
  {
    "text": "here it must be stored somewhere and there's only one case where password is",
    "start": "785549",
    "end": "790679"
  },
  {
    "text": "stored in a non-reversible form in the Opera and that's obviously a harsh and the other way of doing it is reversible any",
    "start": "790679",
    "end": "798520"
  },
  {
    "text": "operating system we've got over 20 places where you can revert the password that was stored in some kind of a way",
    "start": "798520",
    "end": "804790"
  },
  {
    "text": "yeah sometimes we don't even need a tool for that you can use for example app CMD to extract the clear text password of",
    "start": "804790",
    "end": "811210"
  },
  {
    "text": "the application PO identity because this is actually something that is told symmetrically encrypted in the",
    "start": "811210",
    "end": "816970"
  },
  {
    "text": "application host config file so we've got a secure let's just do administrator's whatever as I said what",
    "start": "816970",
    "end": "823450"
  },
  {
    "text": "doesn't really matter I'm just going to type something yeah so let's just do that enter perfect the new log of name will",
    "start": "823450",
    "end": "830560"
  },
  {
    "start": "830000",
    "end": "900000"
  },
  {
    "text": "take place whatever so our pool of service is over here running like this",
    "start": "830560",
    "end": "836440"
  },
  {
    "text": "so what we're going to do so we're going to get into tools right now and then we're gonna get into seek your secret",
    "start": "836440",
    "end": "842620"
  },
  {
    "text": "Stamper and then we're going to specify over here a service and the short name of that service it's a pj service enter",
    "start": "842620",
    "end": "849339"
  },
  {
    "text": "and as you see this is the password that I've been typing yes so this particular password is technically extracted in the",
    "start": "849339",
    "end": "857320"
  },
  {
    "text": "clear text because it's actually stored in the operating system in a reversible form yes so during the pen test and what",
    "start": "857320",
    "end": "864220"
  },
  {
    "text": "and where do we use this tool for well when you manage to get access somewhere this kind of data could allow you for",
    "start": "864220",
    "end": "871029"
  },
  {
    "text": "the lateral movement so eventually this applies to sequel services SharePoint services any specific database service",
    "start": "871029",
    "end": "877930"
  },
  {
    "text": "application services and I can tell you that for the past 14 years when I'm doing independence I've never seen the organization that did not have actually",
    "start": "877930",
    "end": "885070"
  },
  {
    "text": "a service with some kind of an account configured so very useful Bank sometimes it might be useful because you just",
    "start": "885070",
    "end": "891100"
  },
  {
    "text": "forgotten a password yeah right on so why not see I'm ok anyway this is one",
    "start": "891100",
    "end": "897640"
  },
  {
    "text": "of the one of the tools cool interesting so far yeah great so let's do a little",
    "start": "897640",
    "end": "905230"
  },
  {
    "start": "900000",
    "end": "960000"
  },
  {
    "text": "bit of a hardcore stuff if you don't mind because before we move forward to",
    "start": "905230",
    "end": "911260"
  },
  {
    "text": "the attack situations just one more little flavor that we've got when you",
    "start": "911260",
    "end": "917740"
  },
  {
    "text": "are performing for example men in the middle attacks we found out in our team we're very convenient yes if we don't",
    "start": "917740",
    "end": "924010"
  },
  {
    "text": "see something we just write it yes and we keep it for ourselves sometimes we share it because apparently looks like someone else also likes it so when you",
    "start": "924010",
    "end": "931540"
  },
  {
    "text": "are performing man-in-the-middle attacks there are different types of techniques to start it as a first step yes one of",
    "start": "931540",
    "end": "936939"
  },
  {
    "text": "the first techniques it's the easy one which is in general the RP poisoning error piece proofing yes so these are",
    "start": "936939",
    "end": "942999"
  },
  {
    "text": "the techniques that that it's nice to start so the question is do we have a tool like that for example running in",
    "start": "942999",
    "end": "949689"
  },
  {
    "text": "Windows an answer is yes we do we wrote it and eventually this is the probably",
    "start": "949689",
    "end": "955240"
  },
  {
    "text": "the easiest tool that you will use for in general the spoofing or sniffing activity in the operating system so this",
    "start": "955240",
    "end": "963519"
  },
  {
    "start": "960000",
    "end": "1130000"
  },
  {
    "text": "is in general how this tool works it's called CQ RP spoof it's a spoofer for Windows works pretty much on every",
    "start": "963519",
    "end": "970779"
  },
  {
    "text": "version of the operating system you never know when when you're gonna need it this is straightforward so you are",
    "start": "970779",
    "end": "976749"
  },
  {
    "text": "specifying the communication between the client and eventually the Gateway and justice yes and this is the moment where",
    "start": "976749",
    "end": "983649"
  },
  {
    "text": "we are performing the RP poisoning in the back and if you do run like for",
    "start": "983649",
    "end": "989829"
  },
  {
    "text": "example underneath things like Wireshark and so on you are pretty much gathering",
    "start": "989829",
    "end": "995470"
  },
  {
    "text": "everything you can move in the same subnet yes so we know the functionality but we just needed a tool that you do so",
    "start": "995470",
    "end": "1001139"
  },
  {
    "text": "just like this and it works and you can do pretty much sniffing and anything",
    "start": "1001139",
    "end": "1006180"
  },
  {
    "text": "that you can sniff anything that is out there in a move in the subnet just to prove it to you because it would be",
    "start": "1006180",
    "end": "1011279"
  },
  {
    "text": "great to see so what I'm gonna do on my site because this would be this would be",
    "start": "1011279",
    "end": "1016889"
  },
  {
    "text": "nice also to to follow if this is actually working I'm just gonna use the simplest possible thing which is an FTP",
    "start": "1016889",
    "end": "1023730"
  },
  {
    "text": "I know it's in a clear text but it doesn't matter what matters is that we actually our tool is tuned to that kind",
    "start": "1023730",
    "end": "1030839"
  },
  {
    "text": "of traffic as well so not only it gives you that tool to perform the poisoning",
    "start": "1030839",
    "end": "1036510"
  },
  {
    "text": "but it also grabs anything that is out there in the network so it has two functionalities at the same time so I'm",
    "start": "1036510",
    "end": "1042750"
  },
  {
    "text": "just gonna do FTP open on my site and the only thing that you will see is of",
    "start": "1042750",
    "end": "1048899"
  },
  {
    "text": "course that we are putting at that certain mama I'm just going to type in",
    "start": "1048899",
    "end": "1054299"
  },
  {
    "text": "the password so you can see the concept yes so we are pretty much grabbing",
    "start": "1054299",
    "end": "1059370"
  },
  {
    "text": "kind of communication yes so very straightforward but eventually very very handy for example for the SMB relay",
    "start": "1059370",
    "end": "1065610"
  },
  {
    "text": "attacks which are one of the most popular attacks in the infrastructure bring it on so what's coming next",
    "start": "1065610",
    "end": "1071490"
  },
  {
    "text": "next is actually my totally favorite because we're going to be playing with the data protection API and this is one",
    "start": "1071490",
    "end": "1078330"
  },
  {
    "text": "of the most hardcore subjects in in general in my opinion in IT when it's about the cryptography because there's",
    "start": "1078330",
    "end": "1085410"
  },
  {
    "text": "lots of complexity within the whole idea but let's try to put it in pieces so",
    "start": "1085410",
    "end": "1091200"
  },
  {
    "text": "that we at the end leave this room of knowing what not only data protection API is but how are we able to violate",
    "start": "1091200",
    "end": "1098040"
  },
  {
    "text": "different things that are related around it in general it's a good mechanism so let's have a look of what we can do",
    "start": "1098040",
    "end": "1103530"
  },
  {
    "text": "first of all what I would like to show you is first background for the data",
    "start": "1103530",
    "end": "1109470"
  },
  {
    "text": "protection API when we're going to be actually logging on as a regular user and we will leverage this situation",
    "start": "1109470",
    "end": "1117750"
  },
  {
    "text": "where a user is actually storing data like credentials for example in the",
    "start": "1117750",
    "end": "1123750"
  },
  {
    "text": "browser so for that purpose I'm gonna use the tool that isn't our tool and the",
    "start": "1123750",
    "end": "1129510"
  },
  {
    "text": "reason why it's not our tool because it was already there so it makes no point to write it that is the chrome pass so I",
    "start": "1129510",
    "end": "1135660"
  },
  {
    "start": "1130000",
    "end": "1180000"
  },
  {
    "text": "am logged on over here just have a look as Freddy so just to look the user because I this is",
    "start": "1135660",
    "end": "1141450"
  },
  {
    "text": "important what we gonna do right now I'm gonna log on as this particular user with the password password yeah so we've",
    "start": "1141450",
    "end": "1148650"
  },
  {
    "text": "got a P at SS W 0 D we got it right perfect so just because user has a",
    "start": "1148650",
    "end": "1154890"
  },
  {
    "text": "password like this we've got over here Krampus this is from near soft and we've",
    "start": "1154890",
    "end": "1159929"
  },
  {
    "text": "got over here that credentials that are stored for LinkedIn in the Chrome browser yeah so user just save",
    "start": "1159929",
    "end": "1166590"
  },
  {
    "text": "credentials in a browser okay now question of the universe is is it safe or not and I would like to prove to",
    "start": "1166590",
    "end": "1172950"
  },
  {
    "text": "you two things that under certain conditions it is and then the other conditions it's completely not so let's",
    "start": "1172950",
    "end": "1178980"
  },
  {
    "text": "have a look at the flavor so this particular theory that is related with",
    "start": "1178980",
    "end": "1184350"
  },
  {
    "text": "of course the whole concept of the data protection API the cryptographic platform in Windows looks like this",
    "start": "1184350",
    "end": "1192800"
  },
  {
    "text": "gonna get into users profile so I'm getting into the updated roaming Microsoft and are we gonna go to protect",
    "start": "1192800",
    "end": "1200510"
  },
  {
    "text": "and the set of the user and this big list of things it's nothing but a list",
    "start": "1200510",
    "end": "1206270"
  },
  {
    "text": "of master key containers and this is basically what I was mentioning that our team we are as far as I know the first",
    "start": "1206270",
    "end": "1214370"
  },
  {
    "text": "team in the world that fully reverse-engineered a full data protection API literally like to",
    "start": "1214370",
    "end": "1219890"
  },
  {
    "text": "everything that moves so anything that is encrypted in Windows we are decrypting and we are providing tools",
    "start": "1219890",
    "end": "1224900"
  },
  {
    "text": "for that so these master key containers each of these guys contains two master",
    "start": "1224900",
    "end": "1230780"
  },
  {
    "text": "keys one master and they're the same one master key is encrypted with their users passwords hash okay so it depends on my",
    "start": "1230780",
    "end": "1238940"
  },
  {
    "text": "password simple second a master key is encrypted with that and that's the best",
    "start": "1238940",
    "end": "1245150"
  },
  {
    "text": "public key of the domain so public key of the domain sounds really weird and",
    "start": "1245150",
    "end": "1250670"
  },
  {
    "text": "this is this guy over here BK domain name now the set part of that is that",
    "start": "1250670",
    "end": "1256880"
  },
  {
    "text": "each of you each of you you all have it so if you are a member of the domain",
    "start": "1256880",
    "end": "1262100"
  },
  {
    "text": "within your organization you check out and within your profile you're gonna have it now what is this key about this",
    "start": "1262100",
    "end": "1268610"
  },
  {
    "text": "key it's the public key of the domain that is responsible for encrypting everybody's secrets and the problem is",
    "start": "1268610",
    "end": "1275180"
  },
  {
    "text": "that this key is only one so if you're working in a company that has hundred thousand people everybody's secrets are",
    "start": "1275180",
    "end": "1281420"
  },
  {
    "text": "encrypted with the same public key what's the question that we should ask",
    "start": "1281420",
    "end": "1287590"
  },
  {
    "text": "where is the private key total yes okay so what we wrote it's a tool to extract",
    "start": "1287680",
    "end": "1294290"
  },
  {
    "text": "the private key that whenever you got it you totally own the domain like totally on it let me share with you a little bit",
    "start": "1294290",
    "end": "1300650"
  },
  {
    "text": "of a story in a moment I don't have access to the Internet in this machine that's why you're seeing this message okay good so let's begin",
    "start": "1300650",
    "end": "1307550"
  },
  {
    "text": "yeah let's do it so we're gonna move over here so what we're gonna do right",
    "start": "1307550",
    "end": "1312860"
  },
  {
    "text": "now is we're gonna run over here C Q so let's just let me just get into the folder and we're gonna get into the C Q",
    "start": "1312860",
    "end": "1320990"
  },
  {
    "text": "else's secrets dumper and C Q else's secret number that's my toe my favorite tool this guy consists of",
    "start": "1320990",
    "end": "1328160"
  },
  {
    "text": "the 41 mini tools underneath you kind of don't see it because the only thing we",
    "start": "1328160",
    "end": "1333320"
  },
  {
    "text": "just do over here is just file exported pfx and that's it so we have just",
    "start": "1333320",
    "end": "1339710"
  },
  {
    "text": "exported the private key from the domain what are the preconditions for exporting it just to be absolutely fair there are",
    "start": "1339710",
    "end": "1346100"
  },
  {
    "text": "four preconditions that are or so you do this or that or that so either you are domain admin which is",
    "start": "1346100",
    "end": "1352490"
  },
  {
    "text": "kind of like man okay well whatever but yes you've got an access to the domain controllers backup okay but two",
    "start": "1352490",
    "end": "1359270"
  },
  {
    "text": "remaining ones are kind of cool you've got a permission within the domain over that replicate the directory changes all",
    "start": "1359270",
    "end": "1365690"
  },
  {
    "text": "you know who has this service accounts usually for SharePoint for the profile",
    "start": "1365690",
    "end": "1371150"
  },
  {
    "text": "replication so if we connect the dots with our toluca you're able to extract a password for the service account that",
    "start": "1371150",
    "end": "1378020"
  },
  {
    "text": "runs for example SharePoint service for the profile application and then you are fetching that particular key from the",
    "start": "1378020",
    "end": "1383900"
  },
  {
    "text": "domain remotely we also provide the remote tools for that and another fourth",
    "start": "1383900",
    "end": "1390110"
  },
  {
    "text": "one it's a read-only DC if the domain admin logs on on the Rideau in DC yes so",
    "start": "1390110",
    "end": "1395360"
  },
  {
    "text": "these are the preconditions for having it good so how are we able to use this exported pfx so let's use this within",
    "start": "1395360",
    "end": "1401750"
  },
  {
    "start": "1400000",
    "end": "1600000"
  },
  {
    "text": "this scenario so we're right back on the user's machine and what I would like to",
    "start": "1401750",
    "end": "1407059"
  },
  {
    "text": "do and we're gonna simplify the whole operation right now because I would like to we could do it online but it's a",
    "start": "1407059",
    "end": "1413570"
  },
  {
    "text": "little bit of a complex person protests so I'm gonna do it offline and the reason why I'm gonna do it this way it's",
    "start": "1413570",
    "end": "1419990"
  },
  {
    "text": "because this demo thinks that approach will be more linear so hopefully you guys gonna enjoy that of course we could",
    "start": "1419990",
    "end": "1426890"
  },
  {
    "text": "be saying well BitLocker could help it well as we mentioned this can be done online and offline so there are two ways",
    "start": "1426890",
    "end": "1433100"
  },
  {
    "text": "of running this particular approach okay so what we're gonna do right now is and",
    "start": "1433100",
    "end": "1438679"
  },
  {
    "text": "that's kind of cool we're gonna leverage a couple of things at the same time so stay with me because right now we're",
    "start": "1438679",
    "end": "1444740"
  },
  {
    "text": "gonna do this first of all I'm gonna overwrite cache logon data sometimes",
    "start": "1444740",
    "end": "1450890"
  },
  {
    "text": "people call it cash credentials these credentials have nothing to do with credentials this is the pbkdf2 functions",
    "start": "1450890",
    "end": "1458150"
  },
  {
    "text": "so it's not Cybil plus you cannot log on with a value of that so we cannot really call them credentials but I'm just very picky",
    "start": "1458150",
    "end": "1464850"
  },
  {
    "text": "right now so what we're gonna do we're gonna override them and the reason why we're gonna do it is because I would",
    "start": "1464850",
    "end": "1470910"
  },
  {
    "text": "like to show you that if we log on move the illegally changed password and our master key depends on our hash",
    "start": "1470910",
    "end": "1477330"
  },
  {
    "text": "you're not getting access to someone's secrets but you wouldn't be here I wouldn't be here if this was end of this",
    "start": "1477330",
    "end": "1483390"
  },
  {
    "text": "scenario so eventually we're gonna take this exported pfx and we're gonna say okay we are not able to get access to",
    "start": "1483390",
    "end": "1489630"
  },
  {
    "text": "secrets so bring on the exported P effects and then we are decrypting all the secrets of the user this is the",
    "start": "1489630",
    "end": "1494940"
  },
  {
    "text": "flavor let's do it so we're gonna get into the D Drive where I've got my tools",
    "start": "1494940",
    "end": "1500940"
  },
  {
    "text": "over here so let's get into C Q naught C Q malware it is another one here we go",
    "start": "1500940",
    "end": "1506520"
  },
  {
    "text": "this is the Malheur for education if you were ever need this leveraging vast majority of the nice smaller",
    "start": "1506520",
    "end": "1512340"
  },
  {
    "text": "functionalities quite an advanced malware actually anyway let's do it so",
    "start": "1512340",
    "end": "1517350"
  },
  {
    "text": "probably you know the to me me cuts yeah it's over extracting credentials this is our module that we wrote so eventually",
    "start": "1517350",
    "end": "1524720"
  },
  {
    "text": "we are able to play a little bit of the cache logon data and we're gonna do a let's say dump cache and now we're gonna",
    "start": "1524720",
    "end": "1532500"
  },
  {
    "text": "do D once again windows system32 unfortunately I have to type it yes",
    "start": "1532500",
    "end": "1538470"
  },
  {
    "text": "config and then we're gonna do system where the boot key is because boot key is also decrypting to the value of his",
    "start": "1538470",
    "end": "1546960"
  },
  {
    "text": "MSD C to cache logon data so it's not really the decryption because you're getting into the value that gives you",
    "start": "1546960",
    "end": "1553230"
  },
  {
    "text": "nothing but still windows system32 config and we're gonna do",
    "start": "1553230",
    "end": "1561210"
  },
  {
    "text": "sakura-san in this case security yes so we've got cash logon data save over",
    "start": "1561210",
    "end": "1566970"
  },
  {
    "text": "there Kiwi to approve the operation and then we are ready to go that will be the",
    "start": "1566970",
    "end": "1572850"
  },
  {
    "text": "moment where we are overriding cache logon data bank so every single user that logged on in this box has right now",
    "start": "1572850",
    "end": "1579240"
  },
  {
    "text": "overwritten cache logon data now in order to be able to log on of the cache log on data guys I have to make it",
    "start": "1579240",
    "end": "1586530"
  },
  {
    "text": "disconnected so that we are not actually fetching that organ",
    "start": "1586530",
    "end": "1591929"
  },
  {
    "text": "into the domain controller perfect yes and then we are ready to rock with the",
    "start": "1591929",
    "end": "1598019"
  },
  {
    "text": "access to our secrets so continue so what we just did we have overeaten cache local data",
    "start": "1598019",
    "end": "1604559"
  },
  {
    "start": "1600000",
    "end": "1660000"
  },
  {
    "text": "within the registry of the operating system by also reverse engineering the algorithm how you are able to do it",
    "start": "1604559",
    "end": "1610499"
  },
  {
    "text": "that by the way violates accountability within the operating system because right now I can log on as every user",
    "start": "1610499",
    "end": "1616950"
  },
  {
    "text": "that ever logged on in this machine will its use this guy if you remember the",
    "start": "1616950",
    "end": "1622139"
  },
  {
    "text": "password of this guy was password password so P at SS wzid I'm just showing you this right now",
    "start": "1622139",
    "end": "1628039"
  },
  {
    "text": "enter that doesn't work because we have overwritten it right so this is a domain",
    "start": "1628039",
    "end": "1633269"
  },
  {
    "text": "user I'm gonna log on with the password in this particular case mimikatz why not we've used this tool so we could we",
    "start": "1633269",
    "end": "1639960"
  },
  {
    "text": "could use it over here and I'm logging on into this box now question would be am I actually able to get access to",
    "start": "1639960",
    "end": "1648090"
  },
  {
    "text": "these particular credentials and let's have a look so for that purpose we're going to be leveraging a chrome pass the",
    "start": "1648090",
    "end": "1655139"
  },
  {
    "text": "again I don't have access to the Internet so yeah we're gonna get one more message and then we got a chrome",
    "start": "1655139",
    "end": "1661049"
  },
  {
    "start": "1660000",
    "end": "1745000"
  },
  {
    "text": "pass so here we are trying to decrypt master keys one by one with our current",
    "start": "1661049",
    "end": "1667710"
  },
  {
    "text": "password hash but we can't yes because we changed it so what what's gonna",
    "start": "1667710",
    "end": "1672840"
  },
  {
    "text": "happen now so you're gonna in a moment see the line where we are not actually able to see the password now the coolest",
    "start": "1672840",
    "end": "1681749"
  },
  {
    "text": "part comes into place what what's next so what's next is I'm",
    "start": "1681749",
    "end": "1687480"
  },
  {
    "text": "gonna open up the console here we go and we don't need to be any privileged user for that and we're gonna do the",
    "start": "1687480",
    "end": "1694950"
  },
  {
    "text": "following thing I'm wondering where in the users profile we actually store",
    "start": "1694950",
    "end": "1701240"
  },
  {
    "text": "secrets so it depends who is writing them it could be chrome could be at",
    "start": "1701240",
    "end": "1706440"
  },
  {
    "text": "could be Firefox whatever data protection API blobs it's the in general",
    "start": "1706440",
    "end": "1711860"
  },
  {
    "text": "the blob that contains encrypted most probably password of the user that is",
    "start": "1711860",
    "end": "1718950"
  },
  {
    "text": "encrypted by DP API mechanism it has the same header over and over again in the operating",
    "start": "1718950",
    "end": "1725029"
  },
  {
    "text": "system and I would like to show you this how to extract secrets of the user and then the next thing I would like to show",
    "start": "1725029",
    "end": "1731600"
  },
  {
    "text": "you how to get access to the users keep us because this is what where the value",
    "start": "1731600",
    "end": "1736669"
  },
  {
    "text": "is yeah so let's move forward so let's get into the first step of our demonstration",
    "start": "1736669",
    "end": "1743539"
  },
  {
    "text": "which is the PAPR tools first step our",
    "start": "1743539",
    "end": "1749360"
  },
  {
    "start": "1745000",
    "end": "1835000"
  },
  {
    "text": "tool simple 1cq harsh calc to generate hashes why do we need to generate hush",
    "start": "1749360",
    "end": "1755330"
  },
  {
    "text": "because this operation looks like this I take the P effects that we have extracted from the domain I decrypt a",
    "start": "1755330",
    "end": "1761659"
  },
  {
    "text": "secret and I rien crypt it with the users current password hash because DP",
    "start": "1761659",
    "end": "1766789"
  },
  {
    "text": "API works in a way that things always have to be in this case in the encrypted",
    "start": "1766789",
    "end": "1772429"
  },
  {
    "text": "state so let's do it Mimi cuts one here we go this is pretty much our hash that we can use so this is",
    "start": "1772429",
    "end": "1779419"
  },
  {
    "text": "MD for of the users password and now the party starts because we're gonna do CQ",
    "start": "1779419",
    "end": "1785090"
  },
  {
    "text": "master key ID this is one of our core tools where you are able to decrypt",
    "start": "1785090",
    "end": "1791299"
  },
  {
    "text": "every single secret of every single user within the domain so let's do it",
    "start": "1791299",
    "end": "1797510"
  },
  {
    "text": "and we specify over here pfx exported pfx the one that we have from the domain",
    "start": "1797510",
    "end": "1803390"
  },
  {
    "text": "then we are do specific that then we do specify new hash and we technically put",
    "start": "1803390",
    "end": "1809809"
  },
  {
    "text": "the hash of the current users password so the cryptic of the pfx encrypting",
    "start": "1809809",
    "end": "1815299"
  },
  {
    "text": "with this one any question is what and file which which master key container",
    "start": "1815299",
    "end": "1821600"
  },
  {
    "text": "that will be and have no idea we had so many right so what do we do next",
    "start": "1821600",
    "end": "1827419"
  },
  {
    "text": "we have to find it we do it like this technically we get into this",
    "start": "1827419",
    "end": "1832960"
  },
  {
    "text": "presentation in the secret tools DP API once again and we go into CQ dpi API",
    "start": "1832960",
    "end": "1842270"
  },
  {
    "start": "1835000",
    "end": "1960000"
  },
  {
    "text": "once again seek UDP API block searcher and this guy is in general good to run",
    "start": "1842270",
    "end": "1848240"
  },
  {
    "text": "on the machine that you are wondering if where are my secrets to how do I have any secrets in general in this machine",
    "start": "1848240",
    "end": "1854179"
  },
  {
    "text": "you're trying to clean something up and did you actually ever store something out there so if you run it it goes",
    "start": "1854179",
    "end": "1861110"
  },
  {
    "text": "through every single user profile and it points you that hey secrets are over here maybe you want to delete them yeah",
    "start": "1861110",
    "end": "1866870"
  },
  {
    "text": "so cqd PAPR blob searcher has the following parameters d for the directory",
    "start": "1866870",
    "end": "1873590"
  },
  {
    "text": "to be searched then we're gonna do it also goes to the registry which is nice we're gonna do this recursively and",
    "start": "1873590",
    "end": "1880160"
  },
  {
    "text": "we're gonna of course specify the out dere so have a look we're gonna do it like this we know it's Freddie so let's",
    "start": "1880160",
    "end": "1887120"
  },
  {
    "text": "get there Freddie and then we're gonna do in up data and chrome stores its",
    "start": "1887120",
    "end": "1892640"
  },
  {
    "text": "information in local so let's keep it this way we're gonna do it recursively though and we're gonna do the output",
    "start": "1892640",
    "end": "1899360"
  },
  {
    "text": "into c CQ tools here we go and the whole thing gonna go into blob dot txt I would",
    "start": "1899360",
    "end": "1908150"
  },
  {
    "text": "just need to run it for just a bunch of seconds because this tool is actually pretty quick and it searches for the",
    "start": "1908150",
    "end": "1915740"
  },
  {
    "text": "headers so it gets into every single file and it searches for the headers that are characteristic for the DP API",
    "start": "1915740",
    "end": "1922760"
  },
  {
    "text": "so let's have a look blob dot txt here we go this is how the output looks like",
    "start": "1922760",
    "end": "1928760"
  },
  {
    "text": "and if I go page down that's awesome we already can see it let me just enlarge it these are the secrets and the secrets",
    "start": "1928760",
    "end": "1936350"
  },
  {
    "text": "are in chrome user data default cookies by the way it's using Schwaben and",
    "start": "1936350",
    "end": "1941840"
  },
  {
    "text": "Triple DES so this is how chrome saves information secrets of the user to the",
    "start": "1941840",
    "end": "1948410"
  },
  {
    "text": "disk you like it or not it's your thing I don't personally but eventually there",
    "start": "1948410",
    "end": "1953720"
  },
  {
    "text": "is this b55 that we are looking for yeah so let's have a look this is the master key guiit",
    "start": "1953720",
    "end": "1959510"
  },
  {
    "text": "if we do have a master key like this yeah so we are like almost home percent",
    "start": "1959510",
    "end": "1964640"
  },
  {
    "start": "1960000",
    "end": "2045000"
  },
  {
    "text": "up data % here we go and then eventually we go over here into Microsoft pro tect",
    "start": "1964640",
    "end": "1973370"
  },
  {
    "text": "and sit of the user and we search for the b55 and as you see we've got over",
    "start": "1973370",
    "end": "1980180"
  },
  {
    "text": "here the 55 this is this guy existing I already have that marked just in case of",
    "start": "1980180",
    "end": "1987110"
  },
  {
    "text": "course I'm kind of lost so visually I see it so right-click shift and then we've got",
    "start": "1987110",
    "end": "1993080"
  },
  {
    "text": "copious puffs and then we are completing our command so bring it on we've got pfx",
    "start": "1993080",
    "end": "1998990"
  },
  {
    "text": "exported new harsh file that's it so we do enter now guys what happens is we've",
    "start": "1998990",
    "end": "2006399"
  },
  {
    "text": "got let's get back to the folder this ad modified created so what I'm gonna do I'm gonna replace these two guys so",
    "start": "2006399",
    "end": "2014500"
  },
  {
    "text": "we're gonna name this guy good fine and this ad modified will be also renamed by",
    "start": "2014500",
    "end": "2020710"
  },
  {
    "text": "us to the original state so let's just get there eventually and we got it",
    "start": "2020710",
    "end": "2026860"
  },
  {
    "text": "one more thing because it has kind of like a blank icon which means that we have to give it an attribute of a system",
    "start": "2026860",
    "end": "2034149"
  },
  {
    "text": "and hidden so by the tool we already generate a command where you are able to",
    "start": "2034149",
    "end": "2040000"
  },
  {
    "text": "just simply speaking paste it enter great now let's have a look if it worked",
    "start": "2040000",
    "end": "2046360"
  },
  {
    "text": "so password f5 we are getting the password yeah okay what happened what",
    "start": "2046360",
    "end": "2053830"
  },
  {
    "text": "happened is and this is kind of bad because if you got access to these four",
    "start": "2053830",
    "end": "2059710"
  },
  {
    "text": "methods that I was mentioning for grabbing the private key from the domain you totally own it because this",
    "start": "2059710",
    "end": "2067118"
  },
  {
    "text": "particular private key I will sue to decrypt data the crypt different types",
    "start": "2067119",
    "end": "2072128"
  },
  {
    "text": "of secrets of every single user within the domain that leverages data protection API restoring data so if you",
    "start": "2072129",
    "end": "2079240"
  },
  {
    "text": "got as I mentioned a hundred thousand users and they say for example password in Firefox you totally got it if you got",
    "start": "2079240",
    "end": "2087128"
  },
  {
    "text": "that private key so I'm always wondering bad way and that's gonna be a little drama story but if for example someone's",
    "start": "2087129",
    "end": "2094510"
  },
  {
    "text": "domain is getting hacked why that isn't a next step and I'm not suggesting anything but think about it if you",
    "start": "2094510",
    "end": "2101470"
  },
  {
    "text": "extract a particular private key what you could do even domain admin can do it you could decrypt the secret of users in",
    "start": "2101470",
    "end": "2108700"
  },
  {
    "text": "your organization be them on Facebook LinkedIn Twitter name it because this",
    "start": "2108700",
    "end": "2114280"
  },
  {
    "text": "car these are the kind of credentials that are usually storing and then do the public and for example in the name of the user",
    "start": "2114280",
    "end": "2120690"
  },
  {
    "text": "accused some or the company name in general of harassment as bad yeah so",
    "start": "2120690",
    "end": "2127950"
  },
  {
    "text": "imagine now 50 of your employees are doing this so this is in general my flavor here that that particular key and",
    "start": "2127950",
    "end": "2134729"
  },
  {
    "text": "in general access to the domain it's totally massive okay good we got it",
    "start": "2134729",
    "end": "2141289"
  },
  {
    "text": "perfect so just for the reference because in the schedule this was like 25",
    "start": "2141289",
    "end": "2146969"
  },
  {
    "text": "minutes we ran a little bit longer but that's that's not the end of the presentation but if you want to stay I'm",
    "start": "2146969",
    "end": "2152969"
  },
  {
    "text": "super happy to continue because this was originally the concept so let's are you ready for the next part awesome okay",
    "start": "2152969",
    "end": "2159900"
  },
  {
    "text": "let's do it perfect so this is one of the one of the things so let's move forward yes",
    "start": "2159900",
    "end": "2167609"
  },
  {
    "text": "let's move forward to the next part which is related with the users secrets",
    "start": "2167609",
    "end": "2173130"
  },
  {
    "text": "that are derived by different types from different types of applications so things for example like keep us is keep",
    "start": "2173130",
    "end": "2179759"
  },
  {
    "text": "us safe that's a question that we are asking over here and let me answer it but eventually first we're gonna run",
    "start": "2179759",
    "end": "2187160"
  },
  {
    "text": "with a little bit of example so what we got and what's the situation here and",
    "start": "2187160",
    "end": "2192719"
  },
  {
    "text": "especially for you guys that had a data protection API introduction already that",
    "start": "2192719",
    "end": "2198599"
  },
  {
    "text": "will be relatively straightforward to em so the situation is like this",
    "start": "2198599",
    "end": "2204029"
  },
  {
    "start": "2203000",
    "end": "2336000"
  },
  {
    "text": "we've got users keep us we see that this",
    "start": "2204029",
    "end": "2209249"
  },
  {
    "text": "is somewhere within the users profile if you try to open it yeah so we can just double click on it or whatever it just",
    "start": "2209249",
    "end": "2215849"
  },
  {
    "text": "gets in to keep us yeah and what I'm gonna do I'm gonna type the password then I'm gonna use later so that you can",
    "start": "2215849",
    "end": "2221519"
  },
  {
    "text": "see that right now it doesn't work so have a look I'm just typing secure over here okay and then it says the password",
    "start": "2221519",
    "end": "2229170"
  },
  {
    "text": "is incorrect yeah so just to be completely fair now we can just cancel it okay we're like okay we're not",
    "start": "2229170",
    "end": "2235349"
  },
  {
    "text": "getting access to users keep us but if user realize it's keep us access on the",
    "start": "2235349",
    "end": "2242609"
  },
  {
    "text": "windows logon which is our biology you would do something else but users might do something else then you totally get",
    "start": "2242609",
    "end": "2250170"
  },
  {
    "text": "it because if you do have private key from the domain that we were mentioning then you are able to decrypt",
    "start": "2250170",
    "end": "2257759"
  },
  {
    "text": "the master key of the user we already presented that and use that master key",
    "start": "2257759",
    "end": "2263249"
  },
  {
    "text": "to decrypt the secret like kiba's now keep us in a structure is actually",
    "start": "2263249",
    "end": "2269189"
  },
  {
    "text": "looking like this kiba's has protected a user key and this particular protected",
    "start": "2269189",
    "end": "2275339"
  },
  {
    "text": "user key is actually the key that is encrypting keep us and that key is right",
    "start": "2275339",
    "end": "2280439"
  },
  {
    "text": "now encrypted how do I know because of this I said that we going to be looking as well at the different different data",
    "start": "2280439",
    "end": "2287579"
  },
  {
    "text": "here this is the DP API header so any blue book in operating system that is",
    "start": "2287579",
    "end": "2294059"
  },
  {
    "text": "encrypted with the DP API no yeah then it has this kind of a beginning looking",
    "start": "2294059",
    "end": "2299609"
  },
  {
    "text": "like kind of a eggsy thing yeah so this is a characteristic thing for the DPA",
    "start": "2299609",
    "end": "2304769"
  },
  {
    "text": "API so once you're gonna see it you're like okay DP API want why don't we just use some toolkit here so we are it",
    "start": "2304769",
    "end": "2312239"
  },
  {
    "text": "question is how do we decrypt this and of course with the master key so what I",
    "start": "2312239",
    "end": "2317670"
  },
  {
    "text": "do have over here it's already decrypted master key by leveraging one of our tools CQ master key decrypt and this is",
    "start": "2317670",
    "end": "2325469"
  },
  {
    "text": "how master key of the user looks like so you can see that this is just like a string so what I'm gonna do over here",
    "start": "2325469",
    "end": "2331559"
  },
  {
    "text": "I'm gonna copy this guy so let's do that ctrl a ctrl C and we could be here just",
    "start": "2331559",
    "end": "2338189"
  },
  {
    "start": "2336000",
    "end": "2485000"
  },
  {
    "text": "a regular user or whatever really doesn't matter matter because it could be technically this is just an offline",
    "start": "2338189",
    "end": "2344369"
  },
  {
    "text": "operation and we're gonna get into our tools over here where we're gonna be",
    "start": "2344369",
    "end": "2349380"
  },
  {
    "text": "leveraging of course DP API so how do we do that first of all we will need to and",
    "start": "2349380",
    "end": "2355829"
  },
  {
    "text": "this is kind of logical to decrypt this blob this protected user kibun how do we",
    "start": "2355829",
    "end": "2362009"
  },
  {
    "text": "do that well we have to do it by leveraging the PAPR mechanisms so that unfortunately with KeePass we are using",
    "start": "2362009",
    "end": "2369420"
  },
  {
    "text": "something that is called entropy so just additional data that is characteristic per every single system to be leveraged",
    "start": "2369420",
    "end": "2377400"
  },
  {
    "text": "within the whole protists the simplicity about that is that that particular entropy you will find",
    "start": "2377400",
    "end": "2384420"
  },
  {
    "text": "technically in a registry so you can just extract it so let's extract the entropy first because we know we're gonna need it for",
    "start": "2384420",
    "end": "2390569"
  },
  {
    "text": "keep us and then we're gonna of course get into encryption or decryption so",
    "start": "2390569",
    "end": "2396000"
  },
  {
    "text": "we've got a c q DP api key pass DB descriptor enter and this is the entropy",
    "start": "2396000",
    "end": "2402180"
  },
  {
    "text": "that we have over here yeah so this particular entropy let me",
    "start": "2402180",
    "end": "2407190"
  },
  {
    "text": "maybe just copy it even right now so we're gonna get back to the previous value is something that we're gonna need",
    "start": "2407190",
    "end": "2412589"
  },
  {
    "text": "and then we move forward and we do seek UDP API blob the krypter and that",
    "start": "2412589",
    "end": "2419640"
  },
  {
    "text": "particular tool takes a couple of parameters master key we cut this",
    "start": "2419640",
    "end": "2424819"
  },
  {
    "text": "entropy we just copy that blob this is our protected user kibun so let's let's",
    "start": "2424819",
    "end": "2431250"
  },
  {
    "text": "do it so that whole thing is gonna look like this let me just make it a full",
    "start": "2431250",
    "end": "2437069"
  },
  {
    "text": "screen perfect and we've got the tool so we could do CQG PAPR blob Decrypter and",
    "start": "2437069",
    "end": "2443369"
  },
  {
    "text": "then we do entropy here we go and then we specify our entropy over here",
    "start": "2443369",
    "end": "2449970"
  },
  {
    "text": "something you did not copied so let's just do it again luckily we can still see it on the screen and that particular",
    "start": "2449970",
    "end": "2457140"
  },
  {
    "text": "entropy is of course participating it doesn't have to be always like that but in a case of a key pass it is it's",
    "start": "2457140",
    "end": "2464039"
  },
  {
    "text": "participating in a whole decryption process perfect we do master and our",
    "start": "2464039",
    "end": "2469559"
  },
  {
    "text": "master is this particular value that we got over here so once again we're gonna",
    "start": "2469559",
    "end": "2474930"
  },
  {
    "text": "just paste it over here okay and then we've got blob and blob is our C",
    "start": "2474930",
    "end": "2480299"
  },
  {
    "text": "analysis in this case protected user Cuban enter and right now what this is",
    "start": "2480299",
    "end": "2487680"
  },
  {
    "start": "2485000",
    "end": "2669000"
  },
  {
    "text": "this is actually a key that is directly decrypting the key past database this is",
    "start": "2487680",
    "end": "2494730"
  },
  {
    "text": "how keep us works so eventually we do use another tool which is CQ keep us",
    "start": "2494730",
    "end": "2500970"
  },
  {
    "text": "levy Decrypter the PAPR key possibly Decrypter you must admit by the way that our names of the tools are awful yeah",
    "start": "2500970",
    "end": "2506640"
  },
  {
    "text": "it's hard it's hard to start to say it in from there but there isn't like why we do it this way is because we've got",
    "start": "2506640",
    "end": "2512130"
  },
  {
    "text": "so many and is it you're just impossible to remember so you just need you look at the tool you're like ah that's what it does yeah",
    "start": "2512130",
    "end": "2518970"
  },
  {
    "text": "so this is the story and within this particular tool we are using two parameters K and F so K is that",
    "start": "2518970",
    "end": "2527610"
  },
  {
    "text": "particular decrypted key from the blob running on we got this and in this case",
    "start": "2527610",
    "end": "2533250"
  },
  {
    "text": "file so what is the file nothing about directly CQ base that we were trying to",
    "start": "2533250",
    "end": "2539310"
  },
  {
    "text": "get access to but we couldn't so let's find out if we will be able to do it right now and the CQ base let's just get open it",
    "start": "2539310",
    "end": "2548040"
  },
  {
    "text": "like this maybe CQ base once we are in a comment line and that's this new file that is being created here enter awesome",
    "start": "2548040",
    "end": "2555540"
  },
  {
    "text": "now remember that password secure didn't work so let's just have a look at this one and we've got secure",
    "start": "2555540",
    "end": "2563210"
  },
  {
    "text": "okay.thank and this is how we are getting into the keepers of the user yeah so if you ever were going to be in",
    "start": "2563210",
    "end": "2570000"
  },
  {
    "text": "that kind of situation that could be one of the methods where you can try to get access of course to keep us now how",
    "start": "2570000",
    "end": "2577080"
  },
  {
    "text": "could we remain safe well of course don't rely keepers on the windows logon that's that's a simple case we are in",
    "start": "2577080",
    "end": "2584040"
  },
  {
    "text": "the industry so we might even know that yes but eventually users for them it's more convenient and they've got",
    "start": "2584040",
    "end": "2590340"
  },
  {
    "text": "passwords in one place but for you as a security person over here that might be",
    "start": "2590340",
    "end": "2595710"
  },
  {
    "text": "also very convenient in order to get it get access to the users data now could",
    "start": "2595710",
    "end": "2600720"
  },
  {
    "text": "we follow on that oh yeah so let's have a look there is another tool that we've got so this one basically it's the CQ",
    "start": "2600720",
    "end": "2609240"
  },
  {
    "text": "early seamen decrypter and this is for the Remote Desktop connections manager",
    "start": "2609240",
    "end": "2614280"
  },
  {
    "text": "so any type of admins that are storing passwords credentials whatever sessions",
    "start": "2614280",
    "end": "2619380"
  },
  {
    "text": "within the early seamen this is pretty much one of the ways to decrypt it and this tool takes two parameters it's",
    "start": "2619380",
    "end": "2625950"
  },
  {
    "text": "probably the easiest tool that we got file and master key on the DP API so file is going to be the C analysis and",
    "start": "2625950",
    "end": "2633960"
  },
  {
    "text": "then we're going to just do the connections over here so we've got to seek your connections whatever and then",
    "start": "2633960",
    "end": "2639870"
  },
  {
    "text": "we're gonna do here master bring it on and that's gonna be the same master key that we've been using over here that",
    "start": "2639870",
    "end": "2646770"
  },
  {
    "text": "be decrypted by for example the VFX from the domain and we got it perfect and",
    "start": "2646770",
    "end": "2651810"
  },
  {
    "text": "this is pretty much giving you the credentials of any type of a session",
    "start": "2651810",
    "end": "2657060"
  },
  {
    "text": "that has been stored within the remote desktop okay so anything that moves in general can be",
    "start": "2657060",
    "end": "2662610"
  },
  {
    "text": "decrypted in Windows with the toolkit that we got totally addressing the DP",
    "start": "2662610",
    "end": "2668040"
  },
  {
    "text": "API now that's not over because there is another type of a DPI in operating",
    "start": "2668040",
    "end": "2674369"
  },
  {
    "start": "2669000",
    "end": "2728000"
  },
  {
    "text": "system and this one is called DP api mg and this is a completely different thing",
    "start": "2674369",
    "end": "2679830"
  },
  {
    "text": "new generation as we call it and that's kind of funky because this has been",
    "start": "2679830",
    "end": "2685320"
  },
  {
    "text": "introduced in practice in Windows Server 2012 r2 with the functionality of having",
    "start": "2685320",
    "end": "2692220"
  },
  {
    "text": "pfx files to be seat protected so normally if you have pfx files it's such",
    "start": "2692220",
    "end": "2698369"
  },
  {
    "text": "an old-school format I just cannot live with this so it's just password and how",
    "start": "2698369",
    "end": "2703530"
  },
  {
    "text": "can you manage these passwords well maybe in keep us yeah so you have to do something about it so these PF X's they",
    "start": "2703530",
    "end": "2710100"
  },
  {
    "text": "have been redesigned a little bit by allowing user to export a certificate",
    "start": "2710100",
    "end": "2716010"
  },
  {
    "text": "and say who do you want to make it available to so let me show you basically how it works so that we get a",
    "start": "2716010",
    "end": "2722100"
  },
  {
    "text": "clear idea what to do with that and obviously because it's blackhat I will show you how to violate that mechanism",
    "start": "2722100",
    "end": "2727619"
  },
  {
    "text": "um sorry about this I'm just bringing bad news all the time okay let's have a",
    "start": "2727619",
    "end": "2734400"
  },
  {
    "text": "look so we're gonna do this on pretty much we've got a choice of a different",
    "start": "2734400",
    "end": "2740369"
  },
  {
    "text": "operating systems out there but we could do it maybe on a Windows 8.1 or Windows 10 doesn't matter really because because",
    "start": "2740369",
    "end": "2746730"
  },
  {
    "text": "yeah any type of operating system here would would definitely would definitely do it and eventually what's the flavor",
    "start": "2746730",
    "end": "2754950"
  },
  {
    "text": "the flavor is that I'm gonna be logged on us the regular user and one of the",
    "start": "2754950",
    "end": "2761250"
  },
  {
    "text": "things that we're gonna do over here so that's that that's the case is that we're gonna get into cert MGR",
    "start": "2761250",
    "end": "2768090"
  },
  {
    "text": "so this is Freddy again logging on and whatever there is some kind of a certificate out there yes so we could do",
    "start": "2768090",
    "end": "2774930"
  },
  {
    "text": "all tasks and eventually we could do export and next and this by the way this is a",
    "start": "2774930",
    "end": "2782140"
  },
  {
    "start": "2780000",
    "end": "2835000"
  },
  {
    "text": "little bit of a cheating we also have a tool because right now you can see that we do we can export the private key yet",
    "start": "2782140",
    "end": "2788980"
  },
  {
    "text": "why private key is not exportable because if the certificate is generated from the template there is a checkbox in",
    "start": "2788980",
    "end": "2795190"
  },
  {
    "text": "a template to allow or disallow two key to be exportable but that's not true",
    "start": "2795190",
    "end": "2800260"
  },
  {
    "text": "because every single time you get the private key and you log on everything is that it's in a personal container it's",
    "start": "2800260",
    "end": "2806950"
  },
  {
    "text": "actually loaded to the memory so if you do the memory dump we've got a two as well to extract that private key from",
    "start": "2806950",
    "end": "2812140"
  },
  {
    "text": "the memory dam so if you ever have a PF X and the private key and that's your only one P effects out there and you",
    "start": "2812140",
    "end": "2818500"
  },
  {
    "text": "cannot export it because the private key is not exportable just check out our block and we've got a video how to",
    "start": "2818500",
    "end": "2823920"
  },
  {
    "text": "actually recover your private key yeah yeah okay bring it on is export the",
    "start": "2823920",
    "end": "2831190"
  },
  {
    "text": "private key yes next we can know this is what I'm talking about yeah so you can specify",
    "start": "2831190",
    "end": "2837640"
  },
  {
    "start": "2835000",
    "end": "2874000"
  },
  {
    "text": "what would you like to who's supposed to get access to this particular private key see I'm not specifying the password",
    "start": "2837640",
    "end": "2843970"
  },
  {
    "text": "for the pfx I'm not so I can technically specify here some user I've got like Glee and then I can just",
    "start": "2843970",
    "end": "2851050"
  },
  {
    "text": "do next and basically I can specify some some name over here so we could just to see",
    "start": "2851050",
    "end": "2858060"
  },
  {
    "text": "let's just get into some kind of a folder and we could just do it into",
    "start": "2858060",
    "end": "2863650"
  },
  {
    "text": "analysis folder why not and we could put our certificate over here for ibly or",
    "start": "2863650",
    "end": "2868690"
  },
  {
    "text": "something yes so this is this is the whole concept next next finish and yes",
    "start": "2868690",
    "end": "2873850"
  },
  {
    "text": "okay great so what I did before the presentation I took that kind of a certificate and I copied it to my box",
    "start": "2873850",
    "end": "2880930"
  },
  {
    "text": "because on my laptop I got the old analysis tools and I would like to show you what to do next so now we are kind",
    "start": "2880930",
    "end": "2887800"
  },
  {
    "text": "of closing the circle because here in general what's going to happen so we've",
    "start": "2887800",
    "end": "2894070"
  },
  {
    "text": "got our entity stdt decrypter now one of",
    "start": "2894070",
    "end": "2899320"
  },
  {
    "text": "the other things that we can export within that particular tool it's the pfx that we were talking about",
    "start": "2899320",
    "end": "2905410"
  },
  {
    "text": "so we can just export it even offline so you can even do it like this and another",
    "start": "2905410",
    "end": "2910570"
  },
  {
    "text": "part that you can do it's the KD s root key and you can specify the KD s dot bin and what's the",
    "start": "2910570",
    "end": "2917950"
  },
  {
    "text": "KD s root key in Korean in general in Active Directory obviously we've got a",
    "start": "2917950",
    "end": "2923470"
  },
  {
    "text": "Kerberos that has its own root keys what are the risk is used for well first of",
    "start": "2923470",
    "end": "2929890"
  },
  {
    "text": "all this is the value from which if you are using the PAP ing you are pre",
    "start": "2929890",
    "end": "2935920"
  },
  {
    "text": "calculating someone's secret and here here we are not talking about the Kerby TGT password hash it's a different thing",
    "start": "2935920",
    "end": "2941850"
  },
  {
    "text": "for the golden ticket for example here we are talking more about the DP API part yes so this is that this is the",
    "start": "2941850",
    "end": "2948130"
  },
  {
    "text": "story so let's just do it and that's gonna be that's gonna be quite nice so",
    "start": "2948130",
    "end": "2953220"
  },
  {
    "text": "we got it and the question is of course a quote can we do in order to get access",
    "start": "2953220",
    "end": "2960460"
  },
  {
    "text": "to this particular certificate yeah so what we're gonna do right now is and",
    "start": "2960460",
    "end": "2966030"
  },
  {
    "text": "this is kind of kind of nice too we're gonna use another tool that is",
    "start": "2966030",
    "end": "2971050"
  },
  {
    "text": "leveraging ICQ CQ tools for the DP api so let me just type that in a moment",
    "start": "2971050",
    "end": "2978250"
  },
  {
    "text": "here we go this is this one c q DP api p FX Decrypter and if you've got a p",
    "start": "2978250",
    "end": "2984010"
  },
  {
    "text": "effects like this you could always leverage our house our tools so how does",
    "start": "2984010",
    "end": "2989860"
  },
  {
    "text": "it work so we've got our p FX Decrypter and this takes two values p FX and master key now",
    "start": "2989860",
    "end": "2997330"
  },
  {
    "text": "what kind of master key this time Kerberos master key and this Kerberos master key has been decrypted and",
    "start": "2997330",
    "end": "3004640"
  },
  {
    "text": "extracted in the previous tool over here so this is just like we've got kts root",
    "start": "3004640",
    "end": "3010050"
  },
  {
    "text": "master root key and then we've got this bunch of values have a look how many we've got 1 2 3 of them is this typical",
    "start": "3010050",
    "end": "3018090"
  },
  {
    "text": "for the normal production environment actually very much yes you were approximately two three four master keys",
    "start": "3018090",
    "end": "3024720"
  },
  {
    "text": "like this so this is a very cool file or very cool data to have because it allows",
    "start": "3024720",
    "end": "3030270"
  },
  {
    "text": "you to decrypt everything that has been ever protected with the DP API ng so",
    "start": "3030270",
    "end": "3035850"
  },
  {
    "text": "let's do it we've got this guy we're going to specify the P FX and in this case we're",
    "start": "3035850",
    "end": "3040890"
  },
  {
    "text": "going to do I've got it in the backup backup folder so here we go and then we've got four",
    "start": "3040890",
    "end": "3048210"
  },
  {
    "text": "bleep EFX and that particular master key let's try because essentially right now",
    "start": "3048210",
    "end": "3053700"
  },
  {
    "text": "I have no idea which ones that's gonna work over here so we could try this one and I think it might be this one",
    "start": "3053700",
    "end": "3060090"
  },
  {
    "text": "actually but let's see master and then we are pasting it and then we are trying",
    "start": "3060090",
    "end": "3065640"
  },
  {
    "text": "let me just try to work on it a little bit we are trying to get that particular",
    "start": "3065640",
    "end": "3071730"
  },
  {
    "text": "certificate so let's just see another one something is wrong off the certificate",
    "start": "3071730",
    "end": "3077970"
  },
  {
    "text": "or yeah let's see pfx back up and then let's try that for maybe Bruce in this",
    "start": "3077970",
    "end": "3084870"
  },
  {
    "text": "case master here we go okay that's better so basically we've got over here",
    "start": "3084870",
    "end": "3092610"
  },
  {
    "text": "that particular value that's particular certificate out there and eventually",
    "start": "3092610",
    "end": "3098520"
  },
  {
    "text": "we'll get a password yeah now let me show you something because just to connect the dots of the whole demonstration yeah so basically whenever",
    "start": "3098520",
    "end": "3106860"
  },
  {
    "text": "we are in this client box yeah so I should have this this certificate over",
    "start": "3106860",
    "end": "3113220"
  },
  {
    "text": "here so we've got we've got different different certificates we've got the",
    "start": "3113220",
    "end": "3118830"
  },
  {
    "text": "blue search for example so we could try to run it on the blizzard once again so once you open it and you go next next",
    "start": "3118830",
    "end": "3128360"
  },
  {
    "text": "this is the DP API ng you we've never over here specified the password and",
    "start": "3128360",
    "end": "3134970"
  },
  {
    "text": "that's the case but eventually we could just try to do this let me just do the live live case we're gonna just try if",
    "start": "3134970",
    "end": "3143180"
  },
  {
    "text": "for the blizzard it works but it should",
    "start": "3143180",
    "end": "3148460"
  },
  {
    "text": "okay good so we've got AI X F something something so this is the password and",
    "start": "3148460",
    "end": "3154770"
  },
  {
    "text": "the question is of course will we be able to see it over here yes so this is",
    "start": "3154770",
    "end": "3159840"
  },
  {
    "text": "in general one of them one of the approaches that we've got to the DP API",
    "start": "3159840",
    "end": "3165360"
  },
  {
    "text": "on G and there is this cursor right we've got a X something F G so this is",
    "start": "3165360",
    "end": "3170520"
  },
  {
    "text": "exactly that password so PC to protect pfx files it's a great mechanism but it",
    "start": "3170520",
    "end": "3177650"
  },
  {
    "text": "is as safe as two things your user is which is kind of obvious but the second",
    "start": "3177650",
    "end": "3184970"
  },
  {
    "text": "is as safe as this four aspect of the domain are so as your domain",
    "start": "3184970",
    "end": "3190630"
  },
  {
    "text": "administered by couple free domain controllers is as your permission of replica directory changes all is and as",
    "start": "3190630",
    "end": "3198290"
  },
  {
    "text": "you read only con domain controller is so this is basically what affects directly security of that kind of that",
    "start": "3198290",
    "end": "3205640"
  },
  {
    "text": "kind of mechanism so hopefully of course we've got we've got the point over here okay guys two more tools to go yeah well",
    "start": "3205640",
    "end": "3214820"
  },
  {
    "start": "3213000",
    "end": "3284000"
  },
  {
    "text": "we're all right so let's move forward in our team we also derived forensics tools",
    "start": "3214820",
    "end": "3220600"
  },
  {
    "text": "we do that projects very often of in forensic world we find out that you want",
    "start": "3220600",
    "end": "3227060"
  },
  {
    "text": "to do something and then there's no tool like this in community so we're like oh no okay again we're gonna write it so we",
    "start": "3227060",
    "end": "3234470"
  },
  {
    "text": "produce different types of tools for memory analysis extracting information from memory dumps you just like run it",
    "start": "3234470",
    "end": "3241070"
  },
  {
    "text": "over memory dumps Bank you've got an information out like for example extracting EVT X logs which was held if",
    "start": "3241070",
    "end": "3247820"
  },
  {
    "text": "ax 'cold we took us actually over six months to write it but eventually you are able to extract a VTX files from the",
    "start": "3247820",
    "end": "3254660"
  },
  {
    "text": "memory dumps EVT x files are quite complex because there's lots of different types of checksums inside so",
    "start": "3254660",
    "end": "3260870"
  },
  {
    "text": "you just edit little piece of this and then the whole lock is totally corrupted and I'm sure you might have seen it",
    "start": "3260870",
    "end": "3266780"
  },
  {
    "text": "before but eventually one of the things that we we run as well are the different",
    "start": "3266780",
    "end": "3272150"
  },
  {
    "text": "data analyzer so if you in this your first step to forensics we've got a bunch of tools to help you out of this",
    "start": "3272150",
    "end": "3278060"
  },
  {
    "text": "let me show you not everything is actually that obvious so what we're gonna do I'm gonna use this machine",
    "start": "3278060",
    "end": "3284210"
  },
  {
    "start": "3284000",
    "end": "3600000"
  },
  {
    "text": "maybe for that for one analysis and I'm gonna sign out this guy and let me log",
    "start": "3284210",
    "end": "3290330"
  },
  {
    "text": "on as this guy because it would be easier for me to access the tools from",
    "start": "3290330",
    "end": "3295460"
  },
  {
    "text": "this particular account let's do it this way very good and what we're going to do",
    "start": "3295460",
    "end": "3301160"
  },
  {
    "text": "with in particularly this this or a certain user session and let's get",
    "start": "3301160",
    "end": "3308280"
  },
  {
    "text": "into the the tools that we got we've got a tool that is actually allowing you to",
    "start": "3308280",
    "end": "3316650"
  },
  {
    "text": "get the cache of the remote desktop connections and this is a pretty nice",
    "start": "3316650",
    "end": "3323460"
  },
  {
    "text": "tool it is actually having a couple of years right now but we were participating in a forensics project",
    "start": "3323460",
    "end": "3330089"
  },
  {
    "text": "where every single bit as always in a forensics project was important and we found out that someone was actually",
    "start": "3330089",
    "end": "3336619"
  },
  {
    "text": "connecting remotely from this machine so we were wondering is there any like cache like pictures or something and",
    "start": "3336619",
    "end": "3342750"
  },
  {
    "text": "early P protocol it's a protocol that is relying on a grid and every single time",
    "start": "3342750",
    "end": "3347819"
  },
  {
    "text": "you connect somewhere then you download these pieces you download that that",
    "start": "3347819",
    "end": "3352950"
  },
  {
    "text": "blocks of the grid and this is just added to the file so it's a little messy but not that messy so more you move",
    "start": "3352950",
    "end": "3360510"
  },
  {
    "text": "around within the RDP session the more messy this file will become because then you will be downloading me only the new",
    "start": "3360510",
    "end": "3366210"
  },
  {
    "text": "grids but in general the quality of that grid depends on your network connection",
    "start": "3366210",
    "end": "3371220"
  },
  {
    "text": "speed that's why you can adjust within the EDP how fast is your network which is really weird but that affects the",
    "start": "3371220",
    "end": "3377520"
  },
  {
    "text": "quality of the bitmap that's it so what we're gonna do over here we're gonna load cache this is the remote desktop",
    "start": "3377520",
    "end": "3384030"
  },
  {
    "text": "cache and eventually if we do open it up then what you can do is to decode it now",
    "start": "3384030",
    "end": "3390930"
  },
  {
    "text": "that looks awful but every single every DP client has its own unique way of",
    "start": "3390930",
    "end": "3397050"
  },
  {
    "text": "caching so in our tip in our tool we have adjusted to that and you can specify how big it should be the grid",
    "start": "3397050",
    "end": "3404579"
  },
  {
    "text": "and whether it's 32 pixels or 64 yeah and if we do change it to 64 that is",
    "start": "3404579",
    "end": "3412650"
  },
  {
    "text": "basically a little better so you can see things that someone else has seen and",
    "start": "3412650",
    "end": "3417890"
  },
  {
    "text": "eventually a here question to you guys what's this what did someone see web",
    "start": "3417890",
    "end": "3428940"
  },
  {
    "text": "server thank you yeah totally this is the web server so this is the is yeah so this is console and you can move forward",
    "start": "3428940",
    "end": "3435030"
  },
  {
    "text": "in the file because our tool is like reading portions of the file so you can just",
    "start": "3435030",
    "end": "3440369"
  },
  {
    "text": "specify agents you want to have a next chunk and the next chunk and the next chunk yeah so this is one of the forensic tools now another part that is",
    "start": "3440369",
    "end": "3448170"
  },
  {
    "text": "quite interesting over here and this is for today the last tool that I have to",
    "start": "3448170",
    "end": "3453660"
  },
  {
    "text": "show you it's actually related with extracting prefetch from the operating",
    "start": "3453660",
    "end": "3459420"
  },
  {
    "text": "system now if you do have of course prefetch most of us do but just for the reference prefetch is something that was",
    "start": "3459420",
    "end": "3466439"
  },
  {
    "text": "originally introduced in Windows in order to monitor the history of",
    "start": "3466439",
    "end": "3471509"
  },
  {
    "text": "everything you open just for example if you've got a gramophone Drive so not the",
    "start": "3471509",
    "end": "3477390"
  },
  {
    "text": "SSD drive so this is a regular drive which is like slow so you are in the morning you want to whatever open your",
    "start": "3477390",
    "end": "3482999"
  },
  {
    "text": "photoshop that just takes time so eventually what is happening is because",
    "start": "3482999",
    "end": "3488640"
  },
  {
    "text": "of your history that she always run into 8:00 a.m. what Windows does on the prefetcher service or the super fetch it",
    "start": "3488640",
    "end": "3495089"
  },
  {
    "text": "takes that software and it loads it to the memory before you think about it so that when you click on the shortcut it's",
    "start": "3495089",
    "end": "3500279"
  },
  {
    "text": "there but that is also amazing feature for forensics so eventually what we're",
    "start": "3500279",
    "end": "3505709"
  },
  {
    "text": "gonna do have a look prefetch is in a C Windows prefetch and eventually you've got of course these files over here so",
    "start": "3505709",
    "end": "3512219"
  },
  {
    "text": "if you are interested like what was this file about yeah so I got here an example of the CMD for example then you run it",
    "start": "3512219",
    "end": "3520769"
  },
  {
    "text": "with that CQ prefetch parser and our tool it's compatible both with Windows",
    "start": "3520769",
    "end": "3526140"
  },
  {
    "text": "10 where Microsoft implemented compression on prefetch and also backward compatibility with other",
    "start": "3526140",
    "end": "3531479"
  },
  {
    "text": "prevent - a stands for analysis yeah so we can technically run it and what we",
    "start": "3531479",
    "end": "3536789"
  },
  {
    "text": "can learn from that particular tool is how many times this software has ever",
    "start": "3536789",
    "end": "3542099"
  },
  {
    "text": "been running in Windows ever and what was the last time you were running it",
    "start": "3542099",
    "end": "3547289"
  },
  {
    "text": "yeah and also what kind of utter DLL files etc were opened within that file",
    "start": "3547289",
    "end": "3554130"
  },
  {
    "text": "why would this is referring to let me tell you if you've got malware that is",
    "start": "3554130",
    "end": "3560039"
  },
  {
    "text": "for example named notepad how many times user open notepad in that OS possibly a",
    "start": "3560039",
    "end": "3566880"
  },
  {
    "text": "couple of times so if you got one notepad prefetch history and another note file which note but is real so you",
    "start": "3566880",
    "end": "3574200"
  },
  {
    "text": "compare and then you see that dead nova has been running for the ten times and this one has been only running once",
    "start": "3574200",
    "end": "3579600"
  },
  {
    "text": "quite recently let's have fun and let's have a look so prefetch actually in practice helped",
    "start": "3579600",
    "end": "3586080"
  },
  {
    "text": "us in a forensics project to mitigate and also to find out where eventually",
    "start": "3586080",
    "end": "3591810"
  },
  {
    "text": "run somewhere was coming from within the whole enterprise because this allows you",
    "start": "3591810",
    "end": "3597090"
  },
  {
    "text": "to historically monitor the execution of the files even though we don't have for example process tracking turn on by",
    "start": "3597090",
    "end": "3603180"
  },
  {
    "text": "default so this is technically one of that one of the concepts okay guys so we",
    "start": "3603180",
    "end": "3609630"
  },
  {
    "text": "got it yeah we can be talking about it for hours literally but let's get into",
    "start": "3609630",
    "end": "3615140"
  },
  {
    "text": "the summary at the end yeah so we've",
    "start": "3615140",
    "end": "3620700"
  },
  {
    "text": "been talking about of course about different types of tools yeah we've got as I mentioned over 200 of those our",
    "start": "3620700",
    "end": "3626700"
  },
  {
    "text": "team is crazy about those today we have covered this is like the major part of our tool kit we've got also minor tools",
    "start": "3626700",
    "end": "3633840"
  },
  {
    "text": "so you're able to find these guys and we've got also the tools that are directly related with the data",
    "start": "3633840",
    "end": "3640350"
  },
  {
    "text": "protection API today you've seen couple of those there's much much more and you",
    "start": "3640350",
    "end": "3645480"
  },
  {
    "text": "are able to download pretty much all of them from our blog and just for the",
    "start": "3645480",
    "end": "3650580"
  },
  {
    "text": "reference we have prepared for you a special link which you can use in order",
    "start": "3650580",
    "end": "3656580"
  },
  {
    "text": "to get more information about our tool kit about this presentation and of course about white paper that we",
    "start": "3656580",
    "end": "3664050"
  },
  {
    "text": "together with with my team with the seeker team wrote in order for you to",
    "start": "3664050",
    "end": "3669350"
  },
  {
    "text": "not only become familiar of the tools if you wish but also know a little bit by",
    "start": "3669350",
    "end": "3675150"
  },
  {
    "text": "the example how you were able to use them in your practical life",
    "start": "3675150",
    "end": "3680400"
  },
  {
    "text": "I hope yeah so this is the concept what can I say thank you so much for",
    "start": "3680400",
    "end": "3685740"
  },
  {
    "text": "attending yeah hopefully you enjoyed the presentation let us know what you think about it on Twitter or either by email",
    "start": "3685740",
    "end": "3693510"
  },
  {
    "text": "the shorter email for me it's Paula at secure us or Paul at secure academy.com I'm available under both of those and",
    "start": "3693510",
    "end": "3699930"
  },
  {
    "text": "I'm going to be also today at Arsenal booth presenting different types of tools as well after 3 p.m. thank you",
    "start": "3699930",
    "end": "3708090"
  },
  {
    "text": "so much for attending have a great rest of the conference thank you",
    "start": "3708090",
    "end": "3713120"
  }
]