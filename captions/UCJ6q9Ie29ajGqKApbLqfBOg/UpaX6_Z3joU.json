[
  {
    "text": "good morning uh welcome to the tow of Hardware the Tay of implants in South",
    "start": "440",
    "end": "6120"
  },
  {
    "text": "Seas GH with Joe Fitzpatrick um before we start a few brief notes uh be sure to",
    "start": "6120",
    "end": "12320"
  },
  {
    "text": "stop by the business Hall located in Bayside AB um the blackhead Arsenal is",
    "start": "12320",
    "end": "18320"
  },
  {
    "text": "on in the Palm for you're on level three and of course the Arsenal reception at700 uh if you haven't picked up your",
    "start": "18320",
    "end": "23760"
  },
  {
    "text": "Merion dice today is your last chance to visit the black hat swag and bookstore um and also be sure to visit the C Linux",
    "start": "23760",
    "end": "30240"
  },
  {
    "text": "lab and manderlay Bay I heard it's pretty cool um also thanks for putting your phone on vibrate without further",
    "start": "30240",
    "end": "38640"
  },
  {
    "text": "Ado hey how's it going I'm actually going to double check and make sure no one modified the sign",
    "start": "38640",
    "end": "45559"
  },
  {
    "text": "because I I've seen a lot of of interesting signs going around don't know how that could happen good morning",
    "start": "45559",
    "end": "50719"
  },
  {
    "text": "this is T Hardware T of implants who here likes Hardware who here likes all the hardware",
    "start": "50719",
    "end": "56600"
  },
  {
    "text": "talks at def at black hat who here would rather at the SC talk the secure enclaves talk actually",
    "start": "56600",
    "end": "63480"
  },
  {
    "text": "no I'd rather be here but there's a pretty cool secure enclaves talk going on right now that I really wanted to see but oh well you're stuck with me instead",
    "start": "63480",
    "end": "70439"
  },
  {
    "text": "you probably actually get a seat in here you might not get a seat in there so welcome I'm Joe Fitzpatrick uh my",
    "start": "70439",
    "end": "76159"
  },
  {
    "text": "background is electrical engineering with some Cs and infosec mixed in there I've been over 10 years doing",
    "start": "76159",
    "end": "81320"
  },
  {
    "text": "professional Hardware stuff I did silicon debug on CPUs um I did security research uh Hardware pen testing of",
    "start": "81320",
    "end": "88000"
  },
  {
    "text": "desktop and server P CPUs both pre and post silicon so you know you think of a code review you think of like mowing",
    "start": "88000",
    "end": "94119"
  },
  {
    "text": "through lines of C or JavaScript or whatever language the kids are using these days do the same thing but with",
    "start": "94119",
    "end": "99280"
  },
  {
    "text": "verilog it's a lot uglier because verilog is ugly um the past five years I've been doing Hardware security",
    "start": "99280",
    "end": "105320"
  },
  {
    "text": "training the past four with my own business uh right now I am teaching applied physical attacks on x86 systems",
    "start": "105320",
    "end": "111000"
  },
  {
    "text": "just finished a 4-day class um ask anybody who may have been in that class how it was cuz I think it went really",
    "start": "111000",
    "end": "116799"
  },
  {
    "text": "well um I also have a similar class applied physical attacks on Ed systems which focuses more on myips and arm",
    "start": "116799",
    "end": "122719"
  },
  {
    "text": "targets as well um I'm also one of the organizers of bsides PDX if any of you need an excuse to come to Portland it's",
    "start": "122719",
    "end": "129000"
  },
  {
    "text": "a really awesome Place bsides PDX is there come bug me I'll tell you when it is and it'll be great it'll be fun",
    "start": "129000",
    "end": "134599"
  },
  {
    "text": "you'll have Voodoo Donuts and you'll get to see all the places in Portlandia but you're not here to hear about that",
    "start": "134599",
    "end": "139680"
  },
  {
    "text": "you're here to hear about Hardware or something so there might be some confusion with the title of this talk you know that it's not this tow it's",
    "start": "139680",
    "end": "147360"
  },
  {
    "text": "that tow it's the philosophy it doesn't have anything to do with tail access operations Department of the NSA don't",
    "start": "147360",
    "end": "152440"
  },
  {
    "text": "worry about that any any confusion is entirely coincidental so what is too um",
    "start": "152440",
    "end": "158879"
  },
  {
    "text": "taao is this Chinese philosophy it's the absolute principle of the underlying Universe combining um the principles of",
    "start": "158879",
    "end": "164720"
  },
  {
    "text": "Yin and Yang it's the way the coat the it's it's just the natural order right so the to of Hardware is that Hardware",
    "start": "164720",
    "end": "171519"
  },
  {
    "text": "really is the absolute that underlies everything in the world of computing no matter how much time you spend making",
    "start": "171519",
    "end": "176560"
  },
  {
    "text": "your cool software security stuff it's still got to run on someone's hardware and you got to hope that that Hardware",
    "start": "176560",
    "end": "182200"
  },
  {
    "text": "is uh in good shape for you on the other hand Tay is the Chinese philosop uh of",
    "start": "182200",
    "end": "187640"
  },
  {
    "text": "uh of inner character and inner power and integrity and so um the Tay of implants in this case is harnessing",
    "start": "187640",
    "end": "194000"
  },
  {
    "text": "understanding the inner strength of these tiny little minor additions that we can make to a",
    "start": "194000",
    "end": "199680"
  },
  {
    "text": "system cheers um it's just water I swear um so la is the author of tat Ching or",
    "start": "201720",
    "end": "208599"
  },
  {
    "text": "the purported author and he saidd do the things while they are simple and do the great things while they are small right",
    "start": "208599",
    "end": "214760"
  },
  {
    "text": "we talk about all the things we can do in hardware and we have these systems where people chain like 15",
    "start": "214760",
    "end": "219799"
  },
  {
    "text": "vulnerabilities to go and like pop Cal right wouldn't it be cool if we could just get down to the lowest layers and",
    "start": "219799",
    "end": "225319"
  },
  {
    "text": "like do it where we only have to flip one bit or twiddle one bite or pull one wire and bypass all that difficult",
    "start": "225319",
    "end": "231640"
  },
  {
    "text": "software stuff I don't know if you've noticed I don't really like software nearly as much as I like Hardware mostly",
    "start": "231640",
    "end": "236760"
  },
  {
    "text": "because it's hard and I'm not very good at the software side of things the hardware stuff I love it's fun you know it's wires I can see it and touch it",
    "start": "236760",
    "end": "243680"
  },
  {
    "text": "software whatever um so Hardware implants pre 2013 um there's some prior",
    "start": "243680",
    "end": "249439"
  },
  {
    "text": "art um but not much when people thought about Hardware implants you know the term probably didn't have a uh uh as",
    "start": "249439",
    "end": "255680"
  },
  {
    "text": "much of a a use back then but what people thought of that was basically these like mod chips for game consoles",
    "start": "255680",
    "end": "262240"
  },
  {
    "text": "right this is really the only thing we had where you would go and buy a piece of hardware and stick it in another piece of hardware and do something cool",
    "start": "262240",
    "end": "269199"
  },
  {
    "text": "um and you could use use these and you could play backup games and you could like play Homebrew games and there are no illegal uses of these things at all",
    "start": "269199",
    "end": "276800"
  },
  {
    "text": "the point is um this is this is a hardware implant right we got this tiny little circuit board we solder it and in",
    "start": "276800",
    "end": "282680"
  },
  {
    "text": "these nice L little well marked places um you know it's all lined up it's very easy to use you know this is a this is a",
    "start": "282680",
    "end": "288960"
  },
  {
    "text": "very consumer friendly Hardware implant isn't it right but what happened uh there speel uh had this uh um article",
    "start": "288960",
    "end": "296360"
  },
  {
    "text": "where they have the catalog that advertises the NSA toolbox the ant catalog um who knows if this is legit or",
    "start": "296360",
    "end": "303120"
  },
  {
    "text": "not don't worry I'm not going to be showing any possibly confidential or uh uh top secret documents on the screen so",
    "start": "303120",
    "end": "308720"
  },
  {
    "text": "you don't have to Shield your eyes if you happen to have regulations or rules about that um anyway the media saw this",
    "start": "308720",
    "end": "315440"
  },
  {
    "text": "they loved it I was like whoa look this is Magic they can do magic with hardware and it's really not magic and we were like hey we could do that so we did the",
    "start": "315440",
    "end": "321919"
  },
  {
    "text": "NSA playet who has been to like an NSA playset talk or played with an NSA playet toy at some point in time it's",
    "start": "321919",
    "end": "328280"
  },
  {
    "text": "fun stuff isn't it so the point is like hey we can do this let's let's start building this stuff so we did we started",
    "start": "328280",
    "end": "334160"
  },
  {
    "text": "building these things what we learned is that malicious Hardware implants are real someone is doing a lot of work",
    "start": "334160",
    "end": "339960"
  },
  {
    "text": "making them or at least making pretty convincing uh Power uh PDF files advertising them Hardware implants don't",
    "start": "339960",
    "end": "346319"
  },
  {
    "text": "live in a vacuum this is the big key one for me like I think I got Hardware access I can do everything I want to I",
    "start": "346319",
    "end": "351479"
  },
  {
    "text": "don't stop to think that like if I can extend that to software access than someone who knows what they're doing can do a whole lot more than me a lot more",
    "start": "351479",
    "end": "357319"
  },
  {
    "text": "easily so a lot of these Hardware implants they get stuck in a system they give software access they Grant software",
    "start": "357319",
    "end": "363319"
  },
  {
    "text": "assets they escalate privilege and then the rest of the thing all the the real Mau the the the fun stuff uh the the you",
    "start": "363319",
    "end": "369759"
  },
  {
    "text": "know pop shells and you know stuff that happens in software so the hardware is in there it does its job it backs off",
    "start": "369759",
    "end": "375520"
  },
  {
    "text": "and lets the software take control it makes a lot of sense to do it this way right because I mean I mean software",
    "start": "375520",
    "end": "380919"
  },
  {
    "text": "developers there are dime a dozen right no Hardware guys we're we're in high demand",
    "start": "380919",
    "end": "386880"
  },
  {
    "text": "anyway at least I pretend to think that I I just I just play a hardware guy on on stage so we have five implants we're",
    "start": "386880",
    "end": "392800"
  },
  {
    "text": "going to talk about today blinding blindly escalating privilege using JTAG patching kernels via dma on an embedded",
    "start": "392800",
    "end": "398280"
  },
  {
    "text": "device enabling wireless control of an off-the-shelf PLC hot pluging a malicious PLC expansion and a bad USB",
    "start": "398280",
    "end": "404680"
  },
  {
    "text": "style display adapter so I don't know if any of you look at these lists but uh there's been some rants about junk",
    "start": "404680",
    "end": "410840"
  },
  {
    "text": "hacking and junk hacking must stop you know anybody can go and buy a $10 device at a consumer electronic store open it",
    "start": "410840",
    "end": "417080"
  },
  {
    "text": "up and do bad things to it right so what's the why are we talking about this at black hat and Defcon at all these",
    "start": "417080",
    "end": "422240"
  },
  {
    "text": "like worldclass conferences well the reason is the skills and tools and everything that we use on junk hacking",
    "start": "422240",
    "end": "429360"
  },
  {
    "text": "is the exact same skills and tools and everything we use on critical infrastructure you open up a home",
    "start": "429360",
    "end": "434440"
  },
  {
    "text": "wireless router and you open up a PLC controlling a centrifuge and you're going to find similar chips and the same",
    "start": "434440",
    "end": "440000"
  },
  {
    "text": "kind of board layout so there's probably a lot of people who go and do interesting things to critical infrastructure and they're probably",
    "start": "440000",
    "end": "446400"
  },
  {
    "text": "under NDA but they're probably not under NDA over like webcams and uh tv tuners",
    "start": "446400",
    "end": "452080"
  },
  {
    "text": "and um wireless routers so when you see someone talking about this stuff it's like this is how I can present you these",
    "start": "452080",
    "end": "457479"
  },
  {
    "text": "skills this is how I can show you the State ofth art without causing it to be too bad anyway let's go on so first",
    "start": "457479",
    "end": "465319"
  },
  {
    "text": "actually I'll Drink To That cheers it's all vodka I mean water um so",
    "start": "465319",
    "end": "473400"
  },
  {
    "text": "a blondie Escape privilege using J tag who's used J tag before okay anybody",
    "start": "473400",
    "end": "478879"
  },
  {
    "text": "know what it stands for joint test access group that really helps you understand what it is right so if you",
    "start": "478879",
    "end": "485240"
  },
  {
    "text": "kind of put it into uh this this OSI model um you've got a physical layer where you have a bunch of pins ones and",
    "start": "485240",
    "end": "490639"
  },
  {
    "text": "zeros that twiddle on top of that you have a state machine and on top of that you have a a pro interface to give you",
    "start": "490639",
    "end": "496479"
  },
  {
    "text": "instruction registers and data registers and we can keep extracting all this we get up to the next level we have",
    "start": "496479",
    "end": "501919"
  },
  {
    "text": "processor or Target specific information myips does it different from arm does it different from x86 but really we have",
    "start": "501919",
    "end": "507759"
  },
  {
    "text": "software that abstracts all that the very top top level we have boundary scan we can control the iOS of the device we",
    "start": "507759",
    "end": "513800"
  },
  {
    "text": "have halt resume control and we have um memory access so we can execute what we want and we can execute it when we want",
    "start": "513800",
    "end": "520518"
  },
  {
    "text": "it and we're in charge of the CPU so if you're curious for more of this there's a presentation from uh 44",
    "start": "520519",
    "end": "527240"
  },
  {
    "text": "con last year and besides uh Portland last year JTAG to root five ways um there's five different ways we went",
    "start": "527240",
    "end": "532519"
  },
  {
    "text": "through and used JTAG to get a root shell um it's a pretty neat thing to walk through if you're because I I",
    "start": "532519",
    "end": "538160"
  },
  {
    "text": "looked around and I realized like there's a lot of people who who are Hardware people who say oh we've got JTAG we win and then there's these",
    "start": "538160",
    "end": "543720"
  },
  {
    "text": "software people who are like well I only speak root shell like that doesn't help me like I understand I win but how do I",
    "start": "543720",
    "end": "549360"
  },
  {
    "text": "actually play the winning move so came up with a couple examples of how to do this how to take that last",
    "start": "549360",
    "end": "555640"
  },
  {
    "text": "step um one of the interesting ones is patching uh Getty Getty is a binary",
    "start": "555640",
    "end": "560880"
  },
  {
    "text": "process um it runs in memory and what it does is it sits there and it waits for you to connect and when you connect",
    "start": "560880",
    "end": "566920"
  },
  {
    "text": "right it passes your username on to login and login normally asks you for your password in order to prevent like",
    "start": "566920",
    "end": "572839"
  },
  {
    "text": "command injection so if your username is like- f space something you know what it does it has this dash dash at the end of",
    "start": "572839",
    "end": "578720"
  },
  {
    "text": "the command line operators uh operations so that dash dash says do not accept any more uh Flags after this if we can go",
    "start": "578720",
    "end": "586200"
  },
  {
    "text": "into memory and we can patch this one bite in memory from a Das Dash to a-f we're passing a-f to login and login",
    "start": "586200",
    "end": "593560"
  },
  {
    "text": "will force authentication it won't ask us for a password so how we going to do this so this is solder Peak uh I",
    "start": "593560",
    "end": "599760"
  },
  {
    "text": "presented this last year at black hat it's a toy from the NSA playet it's basically uh an Arduino board and it has",
    "start": "599760",
    "end": "606079"
  },
  {
    "text": "a bunch of pins that are JTAG pins it's got a i2c flash chip that Stores um an",
    "start": "606079",
    "end": "611279"
  },
  {
    "text": "svf file a Serial vector format file which plays back a series of JTAG commands um so we'll go and use that",
    "start": "611279",
    "end": "617920"
  },
  {
    "text": "device we'll pop it into a system this is a look at what the board is it's very simple it's only a handful of components",
    "start": "617920",
    "end": "623120"
  },
  {
    "text": "it's much larger than it needs to be you could totally customize this to fit the JTAG pin out of whatever your target system might be um in order to generate",
    "start": "623120",
    "end": "630920"
  },
  {
    "text": "that svf you could go and manually go through look at the JTAG instructions and figure them out or you could just",
    "start": "630920",
    "end": "636040"
  },
  {
    "text": "patch uh open OCD take the debug output of open OCD which tells you all the IRS and DRS it sends and write a script and",
    "start": "636040",
    "end": "642519"
  },
  {
    "text": "convert that into um excuse me convert that into uh an svf file the svf file",
    "start": "642519",
    "end": "650160"
  },
  {
    "text": "then you can play back without having to run open OCD so you don't need a full a full stack a full software platform for",
    "start": "650160",
    "end": "655760"
  },
  {
    "text": "that anybody bored yet no one's fallen asleep",
    "start": "655760",
    "end": "662399"
  },
  {
    "text": "yet but this isn't the talk right after lunch that's the worst one that's what I normally get so I'm going to flip over",
    "start": "662399",
    "end": "668120"
  },
  {
    "text": "to a demo video so pardon my command line um let's full screen that oh that's",
    "start": "668120",
    "end": "676079"
  },
  {
    "text": "not full screen well it'll have to do so this is the Galileo it's uh an x86 like",
    "start": "676079",
    "end": "682240"
  },
  {
    "text": "uh Dev platform um I try and log into it as root it asks me my password that's",
    "start": "682240",
    "end": "688200"
  },
  {
    "text": "kind of what you would expect spe right it's really slow too it's a 400 MHz like 486 class processor so log on",
    "start": "688200",
    "end": "697680"
  },
  {
    "text": "is Galileo it asks us for password we can log in but you know we're just a user that's no fun we want to we want a",
    "start": "697680",
    "end": "703079"
  },
  {
    "text": "privilege escalation exit get out of here now let's go back and look at our",
    "start": "703079",
    "end": "708639"
  },
  {
    "text": "Galileo um I've got this slot uh SL solder Peak all set up and programmed",
    "start": "708639",
    "end": "714560"
  },
  {
    "text": "and it's going to plug into the J tag port on the back of this board luck this",
    "start": "714560",
    "end": "719600"
  },
  {
    "text": "is a development board it's kind of a contrived Target it already has the JTAG header there but I mean it's running a full Linux install we just go over we",
    "start": "719600",
    "end": "727600"
  },
  {
    "text": "plug our JTAG adapter in around the 3D printed stand that I made I'm proud of",
    "start": "727600",
    "end": "733639"
  },
  {
    "text": "myself it's the first 3D print I actually made from scratch um yay Hardware so we plug it in it gets power",
    "start": "733639",
    "end": "741680"
  },
  {
    "text": "once it gets power it starts playing back an svf that svf is going to go through to actually four different spots",
    "start": "741680",
    "end": "747360"
  },
  {
    "text": "in memory and Patch them um because what I found is getty always lives in certain spots on this platform so I just patch",
    "start": "747360",
    "end": "753440"
  },
  {
    "text": "them all um do it the do it the rough way so it's running there it's it's plugged in it's patched so we don't see",
    "start": "753440",
    "end": "759760"
  },
  {
    "text": "no flashing lights we don't want our implant to announce to the world we go back to our console we try to log in as rout and we win yay root",
    "start": "759760",
    "end": "768199"
  },
  {
    "text": "shells okay so and yeah we are actually rout we",
    "start": "768199",
    "end": "774399"
  },
  {
    "text": "can look at the shadow file yada yada yada thank you for clapping I gave a very similar presentation recently with",
    "start": "774399",
    "end": "779839"
  },
  {
    "text": "the exact same demo video and no one clapped but I think I think it was a software audience so I had to say I I",
    "start": "779839",
    "end": "786040"
  },
  {
    "text": "should like say look it's a root shell you know it's got the thing you do so",
    "start": "786040",
    "end": "792040"
  },
  {
    "text": "whatever so I know I know you guys are a sharp crowd then so there's the Galileo",
    "start": "792120",
    "end": "797240"
  },
  {
    "text": "oh so I didn't have a I thought I oh yeah little misordering of slides so what it's cheap it's simple it's readily",
    "start": "797240",
    "end": "804800"
  },
  {
    "text": "available I used a custom board you could have just as easily used an Arduino Pro micro which is like less",
    "start": "804800",
    "end": "810079"
  },
  {
    "text": "than 2 square in the payload can be prototyped with standard tools you can use open OCD prototype your payload and",
    "start": "810079",
    "end": "815880"
  },
  {
    "text": "then program it into this device if the header already is there all you have to do is plug it in there um if it's not",
    "start": "815880",
    "end": "821959"
  },
  {
    "text": "you might have to figure out a pin out figure out pogos something to do like that um it's small enough you can stick it pretty much anywhere um and here's",
    "start": "821959",
    "end": "829279"
  },
  {
    "text": "the cool thing JTAG is JTAG is JTAG right I've used this exact same device on arm on myips on x86 granted like we",
    "start": "829279",
    "end": "838040"
  },
  {
    "text": "said before we've got that back up the upper layers are different the meaning of those IRS and DRS are different but the physical layer the hardware which is",
    "start": "838040",
    "end": "844320"
  },
  {
    "text": "what matters to me is all the same so the next one patch kernels uh",
    "start": "844320",
    "end": "851279"
  },
  {
    "text": "via dma to an embedded device so what is dma we normally see this this diagram from the PCI",
    "start": "851279",
    "end": "856800"
  },
  {
    "text": "specification uh dma is a situation where we have a device like this PCI Express endpoint over here maybe it's a",
    "start": "856800",
    "end": "863759"
  },
  {
    "text": "network adapter and it's receiving packets it wants to hand those off to the system instead of going and handing",
    "start": "863759",
    "end": "869120"
  },
  {
    "text": "bite by bite to the CPU it's able to go and walk straight over the root complex",
    "start": "869120",
    "end": "874399"
  },
  {
    "text": "straight to memory so end point can go and right to memory um this is how a graphics card is going to pass Graphics",
    "start": "874399",
    "end": "880399"
  },
  {
    "text": "stuff frame buffer maybe textures whatever between main memory and Graphics memory um the point is dma is",
    "start": "880399",
    "end": "887040"
  },
  {
    "text": "direct memory access we have devices that aren't the CPU we have other people in the system who can read and write",
    "start": "887040",
    "end": "892160"
  },
  {
    "text": "memory so there's a brief history there's actually a long history of dma attacks but I'm going to give you the brief version um on the left which I",
    "start": "892160",
    "end": "899480"
  },
  {
    "text": "guess is your left because the slides are flipped anyway on your on on the left is um trible which is a board",
    "start": "899480",
    "end": "906399"
  },
  {
    "text": "designed by Joe Grand and some friends of his it's a PCI board you plug it in and there's a little hard drive right",
    "start": "906399",
    "end": "911680"
  },
  {
    "text": "there this power PC processor goes through and periodically reads all of memory and dumps it to a disc for later",
    "start": "911680",
    "end": "917759"
  },
  {
    "text": "fun stuff on the right is a fun uh a PCI Express 2 fire wire adapter um so",
    "start": "917759",
    "end": "924360"
  },
  {
    "text": "there's a whole you know basically a decade of people talking about the fact that when you have fire wire you have a",
    "start": "924360",
    "end": "930160"
  },
  {
    "text": "peer-to-peer connection and one of the profiles allows dma access so there's a bunch of tools you can use you can plug",
    "start": "930160",
    "end": "935720"
  },
  {
    "text": "firewire uh devices into Thunderbolt you can plug them into a Express card slot you can put them in a PCI Express slot",
    "start": "935720",
    "end": "941519"
  },
  {
    "text": "and suddenly the system is now vulnerable as soon as it loads those firewire drivers you plug a cable between the two of them and you can win",
    "start": "941519",
    "end": "948160"
  },
  {
    "text": "um meaning get memory and get privilege escalation and maybe even root shells um",
    "start": "948160",
    "end": "953959"
  },
  {
    "text": "so uh a couple years ago I presented this actually was part of the NSA place that I called it slot screen I found",
    "start": "953959",
    "end": "959800"
  },
  {
    "text": "this this reference board for this chip which is a a USB to PCI Express uh bridge if you want to find more details",
    "start": "959800",
    "end": "966399"
  },
  {
    "text": "of that just search for slot screamer I think I put a link in there somewhere and uh what I can do is I can",
    "start": "966399",
    "end": "972480"
  },
  {
    "text": "plug this into a PCI Express slot and then from an attack computer I can go and sit there and craft PCI Express",
    "start": "972480",
    "end": "978959"
  },
  {
    "text": "packets from USB over USB so I write python into PCI Express it gets thrown over the P Express hierarchy and it goes",
    "start": "978959",
    "end": "986519"
  },
  {
    "text": "and reads memory and it brings it back to me what what's cool about this is you know everybody thinks PCI Express they think graphics card and motherboards and",
    "start": "986519",
    "end": "992759"
  },
  {
    "text": "x86 PCS and home desktops um and maybe you think about the fact that laptops",
    "start": "992759",
    "end": "997839"
  },
  {
    "text": "have like a mini PCI slot this little blue card inside fits in a mini pcie slot um but there's a lot of arms and",
    "start": "997839",
    "end": "1003680"
  },
  {
    "text": "MIP systems now that actually have PCI Express slots as well so this is an Nvidia Jetson board um I actually played",
    "start": "1003680",
    "end": "1009880"
  },
  {
    "text": "with this slot screamer they they actually use some Hardware uh dma protection that I didn't spend the time",
    "start": "1009880",
    "end": "1015040"
  },
  {
    "text": "to get around but um there's other devices like this this is a 10 pogo plug",
    "start": "1015040",
    "end": "1020160"
  },
  {
    "text": "$10 you get and get a system that actually supports PCI Express it doesn't really support it because as you see",
    "start": "1020160",
    "end": "1026000"
  },
  {
    "text": "I've soldered some wires on there um very tiny wires I soldered them to the right pins I put the right resistors and",
    "start": "1026000",
    "end": "1032120"
  },
  {
    "text": "capacitors in there so I could wire those out to an external PCI Express slot and then I could do dma fun stuff",
    "start": "1032120",
    "end": "1037918"
  },
  {
    "text": "but really $10 $10 in a device has a PCI Express slot that's cheaper than any device you",
    "start": "1037919",
    "end": "1043360"
  },
  {
    "text": "can get to put into the slot it's p cheaper than the PCB of the board you would put into the slot",
    "start": "1043360",
    "end": "1050000"
  },
  {
    "text": "onward I have found this guy it's a myips router um and you can see I stuck",
    "start": "1050160",
    "end": "1055400"
  },
  {
    "text": "the board in there and used some high quality electrical tape to plug it in um",
    "start": "1055400",
    "end": "1060840"
  },
  {
    "text": "this is a mediatech processor Media Tech mix processor if you look at the functional",
    "start": "1060840",
    "end": "1066520"
  },
  {
    "text": "block diagram you see it's actually got three separate PCI Express ports um as I mentioned before I wrote some p uh some",
    "start": "1066520",
    "end": "1073200"
  },
  {
    "text": "python that crafted PCI Express packets that I send over USB to this device um",
    "start": "1073200",
    "end": "1078840"
  },
  {
    "text": "what we're going to Target this time is uh ACL uh system ACL enforcement so normally when you go and um look at a",
    "start": "1078840",
    "end": "1086080"
  },
  {
    "text": "file it checks the permissions on the file it calls this function generic permission finds out if you have permission and if you do it returns zero",
    "start": "1086080",
    "end": "1092720"
  },
  {
    "text": "if you don't it returns negative e AIS which is -3 I believe so what we want to do is we want to go find the spot in the",
    "start": "1092720",
    "end": "1099240"
  },
  {
    "text": "kernel in memory where this is and luckily on a simple system the kernel always lives in the same spot and we're",
    "start": "1099240",
    "end": "1105200"
  },
  {
    "text": "going to go and find it and we're going to patch it and change this uh -3 to a zero so we always win um so let's flip",
    "start": "1105200",
    "end": "1111880"
  },
  {
    "text": "over to the video",
    "start": "1111880",
    "end": "1115880"
  },
  {
    "text": "and pardon the blue blue bars so here's that mediatech platform just kind of",
    "start": "1117039",
    "end": "1123280"
  },
  {
    "text": "walking through that's the CPU they've got two separate FES for uh lots of radio stuff um this one's kind of cool",
    "start": "1123280",
    "end": "1130600"
  },
  {
    "text": "it's got a uh flash chip that holds the whole firmware this chip over somewhere",
    "start": "1130600",
    "end": "1136480"
  },
  {
    "text": "over here I'm going to point to it eventually there we go that's a SATA controller which is connected via PCI",
    "start": "1136480",
    "end": "1141799"
  },
  {
    "text": "Express and here's my malicious board plugged into the PCI Express uh mini PCI Express slot right now it's connected",
    "start": "1141799",
    "end": "1147520"
  },
  {
    "text": "over USB to my laptop um and I have a Serial console to connect to it so let's",
    "start": "1147520",
    "end": "1152840"
  },
  {
    "text": "see we go here we go we want a cat ety Shadow",
    "start": "1152840",
    "end": "1159400"
  },
  {
    "text": "we're just a user uh we look at it and we see that is owned by root and I don't have",
    "start": "1159400",
    "end": "1165880"
  },
  {
    "text": "permission to it I C it permission denied well let's let's work around that uh we'll go over to the other window",
    "start": "1165880",
    "end": "1173679"
  },
  {
    "text": "eventually I really need to get like a stand for my my phone so you don't get sick watching these videos I wrote a",
    "start": "1173679",
    "end": "1178760"
  },
  {
    "text": "little script patch generic permission it locates the USB device it's going to go through and find the address in memory patch that specific address and",
    "start": "1178760",
    "end": "1185039"
  },
  {
    "text": "memory and it's done so that's the card basically USB cable to that card went",
    "start": "1185039",
    "end": "1191000"
  },
  {
    "text": "through generated PC Express packets which wrote memory now I go back and I can cat my cat Etsy Shadow and",
    "start": "1191000",
    "end": "1199960"
  },
  {
    "text": "yay",
    "start": "1199960",
    "end": "1202960"
  },
  {
    "text": "so you know last time I delivered this it was after lunch so maybe everybody was just asleep instead of clapping if",
    "start": "1205400",
    "end": "1211240"
  },
  {
    "text": "we want to go back we can always unpatch it we put it back to the the state it was in before",
    "start": "1211240",
    "end": "1217240"
  },
  {
    "text": "and yeah come on I don't know what I'm doing oh yeah",
    "start": "1217240",
    "end": "1223120"
  },
  {
    "text": "got to move the Mase select the right window permission denied so yay we secured the system woohoo uh um there",
    "start": "1223120",
    "end": "1229760"
  },
  {
    "text": "you go so this is not truly an implant yet",
    "start": "1229760",
    "end": "1234919"
  },
  {
    "text": "because I'm lazy um this little board has an 851 CPU whenever I get around to",
    "start": "1234919",
    "end": "1239960"
  },
  {
    "text": "it I'm going to write some code for that 851 CPU to automate all this but as of right now I just use a USB cable to do",
    "start": "1239960",
    "end": "1245600"
  },
  {
    "text": "it in Python cuz I can handle python 851 requires like lowlevel languages and compilers which are fun and all but that",
    "start": "1245600",
    "end": "1252840"
  },
  {
    "text": "sounds like work tool chains are the hardest part um which is no different than Hardware",
    "start": "1252840",
    "end": "1258440"
  },
  {
    "text": "either there but you know so onward um oh I don't have what so what so what",
    "start": "1258440",
    "end": "1264840"
  },
  {
    "text": "basically these invented devices um they are fully featured computers now and we keep saying that over and over again all",
    "start": "1264840",
    "end": "1270799"
  },
  {
    "text": "these iot devices they're susceptible to all the same things that desktop computers were and laptop computers were",
    "start": "1270799",
    "end": "1276120"
  },
  {
    "text": "even down to the hardware level now where we're adding all of these highspeed interfaces that are very highly privileged so next we're going to",
    "start": "1276120",
    "end": "1283080"
  },
  {
    "text": "move out of the junk hacking realm and into the like um spoil all of your water",
    "start": "1283080",
    "end": "1288919"
  },
  {
    "text": "and destroy the power grid typee world so we're going to enable a wireless control of an off-the-shelf PLC this is",
    "start": "1288919",
    "end": "1294840"
  },
  {
    "text": "a seaman s7200 I borrowed this from a friend it's a kind of an old PLC hey hey",
    "start": "1294840",
    "end": "1300279"
  },
  {
    "text": "I haven't looked at plcs before let me open this up so I open it up pop it off oh okay right there we see a chip it's",
    "start": "1300279",
    "end": "1306200"
  },
  {
    "text": "got a product number I can look up that thing and get the data sheet I WR know right away this is a a ram chip because",
    "start": "1306200",
    "end": "1311400"
  },
  {
    "text": "of the the pin out I recognize that the the shape and form factor and I know this is a flash chip I can look up the",
    "start": "1311400",
    "end": "1316919"
  },
  {
    "text": "part numbers I can figure them out I can read them that's all well and good that's that's the software approach yeah",
    "start": "1316919",
    "end": "1322600"
  },
  {
    "text": "tampering with firmware that's kind of eh whatever let's look at the hardware we got on to the next layer and this whole board is dedicated to input and",
    "start": "1322600",
    "end": "1329559"
  },
  {
    "text": "output so if you notice uh there's a bunch of output buffers that uh control",
    "start": "1329559",
    "end": "1334720"
  },
  {
    "text": "what gets output uh to the outer system it takes the the lowlevel voltage that comes from the CPU that the GPI output",
    "start": "1334720",
    "end": "1340840"
  },
  {
    "text": "and turns it into a relay or turns it into like a 24volt output likewise there's a bunch of input buffers that",
    "start": "1340840",
    "end": "1346520"
  },
  {
    "text": "take you know high voltage or something in and or analog voltages in and uh",
    "start": "1346520",
    "end": "1351919"
  },
  {
    "text": "condition them so they're just right for the uh CPU uh we look down to the next layer and that's just capacitors and",
    "start": "1351919",
    "end": "1357440"
  },
  {
    "text": "power stuff which is really fun but there's not a lot we can do um so back up a level to this layer um we noticed",
    "start": "1357440",
    "end": "1364080"
  },
  {
    "text": "that there's this uh can you can you make out that header in the middle I hope so yeah it looks better on your screen than mine probably because",
    "start": "1364080",
    "end": "1370640"
  },
  {
    "text": "there's not giant lights flashing in your eyes um we look at this header we have a bunch of pins and if we use a",
    "start": "1370640",
    "end": "1376400"
  },
  {
    "text": "Multimeter we can find out that these buffers connect to these pins which brings them up to the next layer to the CPU these buffers connect to these pins",
    "start": "1376400",
    "end": "1382679"
  },
  {
    "text": "that bring them up to the CPU so let's take a look at that it's kind of a double layered uh 0.1 inch header um if",
    "start": "1382679",
    "end": "1388760"
  },
  {
    "text": "we could intercept any one of those signals we could control what happens on any output Downstream from the CPU so I",
    "start": "1388760",
    "end": "1395600"
  },
  {
    "text": "thought okay this is great I'm going to go and I'm going to make an implant right this little guy is an Arduino board that cost $2 and an NRF radio that",
    "start": "1395600",
    "end": "1402320"
  },
  {
    "text": "cost a dollar and about like a dollar worth of wies so like the wire cost is",
    "start": "1402320",
    "end": "1407400"
  },
  {
    "text": "is a significant portion of the amount of cost of this implant um I stick it in there and I want to just I want to snip",
    "start": "1407400",
    "end": "1413360"
  },
  {
    "text": "one of those leads and put it in place but again this is someone else's hardware and they didn't want me to Tamper with it and besides uh when you",
    "start": "1413360",
    "end": "1419919"
  },
  {
    "text": "when you do put it back together right you can't see it right the the r is in there you've taken the top off the",
    "start": "1419919",
    "end": "1425960"
  },
  {
    "text": "device you still can't see the implant onward you know put it back together there's no tber evident anything you can",
    "start": "1425960",
    "end": "1431240"
  },
  {
    "text": "pop the tabs off the side open it close it many times you'll never notice it but",
    "start": "1431240",
    "end": "1436440"
  },
  {
    "text": "um I couldn't get software for this device so so we made no software changes right all the original Hardware is in",
    "start": "1436440",
    "end": "1442400"
  },
  {
    "text": "there um the modification that I might have made is not apparent and one signal could be wirely set unset um that",
    "start": "1442400",
    "end": "1448799"
  },
  {
    "text": "connector that we looked at also connects to this DB9 programming Port which would be great if we wanted to intercept the programming that was going",
    "start": "1448799",
    "end": "1454960"
  },
  {
    "text": "on the device as well um so I wanted to get this working I wanted to demonstrate it and I went and I looked and it was",
    "start": "1454960",
    "end": "1460640"
  },
  {
    "text": "nearly impossible to get the software to configure this guy I've later found out there's actually an open source software package that does it as well I haven't",
    "start": "1460640",
    "end": "1466440"
  },
  {
    "text": "puted with that yet so it's actually cheap for me to go and buy a newer system and do the same thing and I",
    "start": "1466440",
    "end": "1472440"
  },
  {
    "text": "thought okay it's a newer system they're going to they're going to like have updated somewhere it's going to be all integrated into a single chip like you",
    "start": "1472440",
    "end": "1478000"
  },
  {
    "text": "know progress and stuff uh nope uh similar to how it was before actually this goes straight down",
    "start": "1478000",
    "end": "1483679"
  },
  {
    "text": "to the the the iio board um the I board is a little different it has one giant header instead of two small headers um",
    "start": "1483679",
    "end": "1490360"
  },
  {
    "text": "you can see those white things at the bottom of the relays and the power board at the very bottom and there was a CPU board just above which I uh failed to",
    "start": "1490360",
    "end": "1496679"
  },
  {
    "text": "show you what I did notice is that thing has uh LEDs on the front that show you which inputs and outputs are on and off",
    "start": "1496679",
    "end": "1502679"
  },
  {
    "text": "so what I did is I looked at those LEDs and you see there's like little gold holes underneath so on the left are the LEDs these white things right underneath",
    "start": "1502679",
    "end": "1509159"
  },
  {
    "text": "them is this little hole that is a via to the other side those Vias connect uh",
    "start": "1509159",
    "end": "1514600"
  },
  {
    "text": "over here down here so I trace these signals out they go through this buffer chip up to this these legs over here",
    "start": "1514600",
    "end": "1521200"
  },
  {
    "text": "that's the bottom of the connector that goes to the next board um when I go to the next board I look at the connector and I trace it right these four signals",
    "start": "1521200",
    "end": "1528080"
  },
  {
    "text": "right here are outputs and they all go through this little package right here this is a um a a a bank resistor so it's",
    "start": "1528080",
    "end": "1535840"
  },
  {
    "text": "it's a whole bunch of resistors in one chip because it's easier to place one chip than it is to place four small resistors this resistor actually",
    "start": "1535840",
    "end": "1542399"
  },
  {
    "text": "protects the input and outputs of the CPU and the other circuit so all I need to do is solder one wire onto this one",
    "start": "1542399",
    "end": "1548320"
  },
  {
    "text": "spot right here and I can control the output of the relay without the uh with",
    "start": "1548320",
    "end": "1553520"
  },
  {
    "text": "the operating system without the software having any means of actually knowing what's going on it's going to spit out one on this wire on the other",
    "start": "1553520",
    "end": "1560320"
  },
  {
    "text": "side of this resistor it's going to be a zero if I say so so let's walk at the video of installing and uh using this",
    "start": "1560320",
    "end": "1568240"
  },
  {
    "text": "implant uh other screen",
    "start": "1568240",
    "end": "1573799"
  },
  {
    "text": "three so here's the little implant Z put in a Ziploc bag because you know then it's not going to short things",
    "start": "1574200",
    "end": "1581120"
  },
  {
    "text": "out um I soldered one leg to a ground on a capacitor another to a power pin on a chip that I recognized and was able to",
    "start": "1581120",
    "end": "1587159"
  },
  {
    "text": "get the da sheet and that one data pin is the one that actually does the the flipping of the bits I have to get all",
    "start": "1587159",
    "end": "1592919"
  },
  {
    "text": "those little itty bitty wires so they don't interfere with things I put it in I'll get the top board and mount it",
    "start": "1592919",
    "end": "1599039"
  },
  {
    "text": "right on top once I get things out of the way there we go top board plugs",
    "start": "1599039",
    "end": "1605799"
  },
  {
    "text": "on and that's where that big chip in the middle is the CPU it's got Flash and RAM as well tuck those wires in so it",
    "start": "1605799",
    "end": "1611840"
  },
  {
    "text": "doesn't get doesn't get found put the case back on top snap",
    "start": "1611840",
    "end": "1620240"
  },
  {
    "text": "and then we are going to go turn it on and I'm going to walk through and I I don't believe you have audio but um",
    "start": "1620600",
    "end": "1626720"
  },
  {
    "text": "let's see does this mic work",
    "start": "1626720",
    "end": "1633000"
  },
  {
    "text": "maybe I'll just what a is it playing okay so it's going to vape as",
    "start": "1633000",
    "end": "1640440"
  },
  {
    "text": "soon as I go start playing with the switches I'm G to this is the demo mode I'm going to turn it clear it and turn it on and set it and then there's like a",
    "start": "1640440",
    "end": "1647600"
  },
  {
    "text": "reset latch let go I need to put the second input and that resets it simple demo that's just how they work put them",
    "start": "1647600",
    "end": "1653960"
  },
  {
    "text": "both on and they go on until one goes off there you go I'm going to go over here and I have",
    "start": "1653960",
    "end": "1659399"
  },
  {
    "text": "another wireless adapter hooked up to my laptop exact same Hardware just with a longer wire and I have a little shell",
    "start": "1659399",
    "end": "1665760"
  },
  {
    "text": "script I'm basically going to send a Serial command and output to one output to",
    "start": "1665760",
    "end": "1670799"
  },
  {
    "text": "zero and disable so disable as high impedance it lets the system regain control of the output so let's look over",
    "start": "1670799",
    "end": "1677000"
  },
  {
    "text": "here when it beeps that's the muler telling us that this output is on and shorted out I'm remotely turning it on and off and you'll notice there's no",
    "start": "1677000",
    "end": "1683240"
  },
  {
    "text": "light lit up on the LED to sh tell us the output is on right we go I've turned",
    "start": "1683240",
    "end": "1690039"
  },
  {
    "text": "it off it thinks it it's on but no beep so it's off right I use my software control or",
    "start": "1690039",
    "end": "1696600"
  },
  {
    "text": "radio control I can turn it on off and disable it another fun trick I can do is I can go over and this this device has",
    "start": "1696600",
    "end": "1703760"
  },
  {
    "text": "all sorts of stuff built in to make sure it doesn't do things it shouldn't do I can go through and send a bunch of commands and turn it on and off really",
    "start": "1703760",
    "end": "1709600"
  },
  {
    "text": "fast which for some things might be really bad um think about anything electronic that shouldn't be turned on",
    "start": "1709600",
    "end": "1714760"
  },
  {
    "text": "and off fast onward let's see half an hour so so",
    "start": "1714760",
    "end": "1721440"
  },
  {
    "text": "what it's a cheap implant it's mostly off the-shelf open source code um literally I took the demo file and like",
    "start": "1721440",
    "end": "1727799"
  },
  {
    "text": "changed three lines to make this work um and this could be retrofitted to pretty much any IO type if you know where to",
    "start": "1727799",
    "end": "1733399"
  },
  {
    "text": "put this wire where to toggle that bit uh you can use this on any kind of system",
    "start": "1733399",
    "end": "1738519"
  },
  {
    "text": "so onward let's do a malici a hot plug a malicious PLC expansion module this is another PLC I got I bought it because",
    "start": "1738519",
    "end": "1744519"
  },
  {
    "text": "it's the cheapest one you can buy on Digi key um it's made by Phoenix contact which is actually a pretty good company",
    "start": "1744519",
    "end": "1750039"
  },
  {
    "text": "um and it's a nicely well-designed pie thing with some decent software but the first thing I do when I open this up is",
    "start": "1750039",
    "end": "1756600"
  },
  {
    "text": "I look at it and like there's one thing that just jumps out at me and says Joe look at me look at me look at me and it's over here in the bottom left corner",
    "start": "1756600",
    "end": "1763240"
  },
  {
    "text": "anybody know what that is jte yay and once we have JTAG we have",
    "start": "1763240",
    "end": "1769240"
  },
  {
    "text": "fun and win um and we can look at the chip it's an XP LPC 1765 which I can go",
    "start": "1769240",
    "end": "1774799"
  },
  {
    "text": "and get a data sheet for and no exactly how to use um luckily I look at the data sheet and oh there's code security",
    "start": "1774799",
    "end": "1780799"
  },
  {
    "text": "protection there's security we're going to be foiled you can disable JTAG on",
    "start": "1780799",
    "end": "1786399"
  },
  {
    "text": "this chip you can disable to disable flash updates you can disable it to disable access to any JTAG commands but",
    "start": "1786399",
    "end": "1794000"
  },
  {
    "text": "this is the real world anybody going to guess what it was set to yeah wide open um so looking at it like",
    "start": "1794000",
    "end": "1802200"
  },
  {
    "text": "this is this is a spot where our little expansion module plugs in and you may not be able to see it but in the middle is a little black header I can't believe",
    "start": "1802200",
    "end": "1808919"
  },
  {
    "text": "it it's either eight or 10 pins in the middle that's where it connects right next to it are these pins like H that's",
    "start": "1808919",
    "end": "1814600"
  },
  {
    "text": "nice and close um so this is the USB connector that normally goes in there that lets you program it this is the",
    "start": "1814600",
    "end": "1820440"
  },
  {
    "text": "blank that's in there when it's not in use um and that's the connector it normally connects with that's the USB",
    "start": "1820440",
    "end": "1825960"
  },
  {
    "text": "one so if I have J tag what can I do I look at the memory map of this chip and I see that there's a range dedicated to",
    "start": "1825960",
    "end": "1832279"
  },
  {
    "text": "gpio um and there's a bunch of bits that I can use to set and unset the gpio values um specifically the the port P",
    "start": "1832279",
    "end": "1839480"
  },
  {
    "text": "pin value and it tells me the address in memory that I go to excuse me to set or unset that I look",
    "start": "1839480",
    "end": "1847200"
  },
  {
    "text": "at the relays up top I know that that's what makes things happen I use my multimeter and trace it down to figure out which GPI openin of that nxp chip is",
    "start": "1847200",
    "end": "1854320"
  },
  {
    "text": "the one I want to talk to I look at the data sheet and find out what address it's at and I'm going to make a JTAG script",
    "start": "1854320",
    "end": "1860880"
  },
  {
    "text": "that's going to go in right to that address and turn on or off that gpio so back to a",
    "start": "1860880",
    "end": "1866799"
  },
  {
    "text": "video rifle for the sharp ones will notice I only",
    "start": "1866799",
    "end": "1872360"
  },
  {
    "text": "have four videos yet I said five implants so you're like oh he's going to cheat US I'm going to cheat you um",
    "start": "1872360",
    "end": "1879279"
  },
  {
    "text": "anyway hooking up the same way as before we've got our little display we can go through and we can enable and disable uh",
    "start": "1879279",
    "end": "1885440"
  },
  {
    "text": "an output um using the the front and you know it outputs it beeps makes a l loud",
    "start": "1885440",
    "end": "1891240"
  },
  {
    "text": "annoying noise uh we can Reet the output or clear the override um I've got my",
    "start": "1891240",
    "end": "1898159"
  },
  {
    "text": "implant that I'll pick up and show you it's got a bunch of pogo pins right those Pogo pins are lined up to match",
    "start": "1898159",
    "end": "1904440"
  },
  {
    "text": "with those JTAG pins so all I need to do is plug it in and it'll play my script",
    "start": "1904440",
    "end": "1910440"
  },
  {
    "text": "because it's going to get power and go it's set up to go and actually here this is what a pogo pin is if you're not familiar it's a little uh like cones",
    "start": "1910440",
    "end": "1918399"
  },
  {
    "text": "that uh uh tube pins that have a spring inside so they they're they're springy so I pop this in it's going to wait 5",
    "start": "1918399",
    "end": "1925399"
  },
  {
    "text": "seconds it's going to write to that IO port and um thank",
    "start": "1925399",
    "end": "1934158"
  },
  {
    "text": "you and the thing is like we just halted the processor rote a bit and then stopped and we can go the software",
    "start": "1935440",
    "end": "1942000"
  },
  {
    "text": "doesn't know that happened it doesn't check the value of that register all we do is hit the buttons and we can go and disable it there's no no persistent",
    "start": "1942000",
    "end": "1948279"
  },
  {
    "text": "control there we didn't oh there we go again we didn't go and change the code in memory we didn't modify the M we just",
    "start": "1948279",
    "end": "1953639"
  },
  {
    "text": "went straight to the gpio if you wanted to you could tamper with memory you could you know write your malware whatever the fun things you like to do",
    "start": "1953639",
    "end": "1959639"
  },
  {
    "text": "with software are you have the power to do at that point there we go so what",
    "start": "1959639",
    "end": "1965080"
  },
  {
    "text": "JTAG could be disabled but it's usually not um sometimes you get situations where it actually is disabled but the",
    "start": "1965080",
    "end": "1971679"
  },
  {
    "text": "way it's disabled is a way that you can work around with more intensive Hardware hacking um at some point in time you",
    "start": "1971679",
    "end": "1976720"
  },
  {
    "text": "just have to figure out how much money you want to spend do you want to spend $100,000 $10,000 and use a fib to enable",
    "start": "1976720",
    "end": "1981919"
  },
  {
    "text": "jte might be worth it might be uh worth it for you um again that would be more",
    "start": "1981919",
    "end": "1987000"
  },
  {
    "text": "invasive it wouldn't just be an implant tangent um test ERS are quick and easy to access Um this can be used on a unit",
    "start": "1987000",
    "end": "1993840"
  },
  {
    "text": "in operation and you can just be like walking by on a factory tour and just be like you know and have it timed to I",
    "start": "1993840",
    "end": "2000880"
  },
  {
    "text": "mean you could you could combine this with the other one and make it remotely controllable you could you could do whatever you want when when it's Hardware all the doors are open for you",
    "start": "2000880",
    "end": "2007320"
  },
  {
    "text": "right um and when you get JTAG working you win right when you have JTAG you own the CPU",
    "start": "2007320",
    "end": "2012919"
  },
  {
    "text": "you own memory you're in charge again there's all these caveats there's when it JTAG is disabled there's when you",
    "start": "2012919",
    "end": "2018360"
  },
  {
    "text": "have Hardware protections but that's kind of what you get so the last one we've got is a bad USB style display",
    "start": "2018360",
    "end": "2024679"
  },
  {
    "text": "adapters and this is one that I have high hopes for and I'm just going to show you where I am with it because it's",
    "start": "2024679",
    "end": "2029760"
  },
  {
    "text": "not actually I haven't turned it into an implant yet because I'm busy and lazy um",
    "start": "2029760",
    "end": "2035440"
  },
  {
    "text": "so you know there's been some previous presentations actually from the NSA playet there's um this one on the left",
    "start": "2035440",
    "end": "2041600"
  },
  {
    "text": "is uh blinker cough it was a basically a modified um VGA cable that you'd like",
    "start": "2041600",
    "end": "2047200"
  },
  {
    "text": "let's say install a bunch of these and they would use infrared Communications to make like a little mesh Network and",
    "start": "2047200",
    "end": "2053158"
  },
  {
    "text": "exfiltrate data over i2c fun stuff you know you think about a faraday cage right it's supposed to keep everything",
    "start": "2053159",
    "end": "2058919"
  },
  {
    "text": "in and out but it's it's just a mesh of copper like lights that flash around might actually not get through unless",
    "start": "2058919",
    "end": "2064200"
  },
  {
    "text": "you're in a fancy place that has infrared uh infrared commun communication blockers um on the right we have alloy",
    "start": "2064200",
    "end": "2071599"
  },
  {
    "text": "Viper this cable over here it looks like a V Thunderbolt to VGA adapter with a",
    "start": "2071599",
    "end": "2077240"
  },
  {
    "text": "sketchy old VGA cable but this is actually a fire a thunderbolt cable that goes all the way through and connects to",
    "start": "2077240",
    "end": "2083480"
  },
  {
    "text": "this box with which contains a slot screamer and a daisy chains an actual VJ adapter so that you can go and plug in",
    "start": "2083480",
    "end": "2091079"
  },
  {
    "text": "so like I could have plugged in right here to a sketchy VGA cable uh with oh they already have my the adapter for my MacBook everything shows up on the",
    "start": "2091079",
    "end": "2097960"
  },
  {
    "text": "screen just as normal but mean in the meantime there's a box under the table that's copying the contents of my",
    "start": "2097960",
    "end": "2103240"
  },
  {
    "text": "memory well so USBC is this new thing it's like this magic thing the the new Macbook has so they have this pretty",
    "start": "2103240",
    "end": "2110040"
  },
  {
    "text": "like the ability to connect everything you need the idea with USBC is they wanted to make this the universal Port",
    "start": "2110040",
    "end": "2115800"
  },
  {
    "text": "like Universal serial bus so they combined a whole bunch of different protocols into it just like where",
    "start": "2115800",
    "end": "2120839"
  },
  {
    "text": "Thunderbolt um was this interconnect that you display port or PCI Express um",
    "start": "2120839",
    "end": "2126160"
  },
  {
    "text": "USBC allows you to to do display port if it's Thunderbolt enabled it allows you",
    "start": "2126160",
    "end": "2131240"
  },
  {
    "text": "to do PCI Express it allows you to do all this stuff over a single port what's interesting is what's in these adapters",
    "start": "2131240",
    "end": "2138480"
  },
  {
    "text": "so if you have the new Macbook or I think the the Chromebook Pixel the only Port you have is a USBC Port it's even",
    "start": "2138480",
    "end": "2143920"
  },
  {
    "text": "used for charging so you have to pay 80 bucks for this fancy cable that gives you power display and USB to do anything",
    "start": "2143920",
    "end": "2152160"
  },
  {
    "text": "right so you plug that in and you plug a hub in and you plug your remote in and then you plug everything else in um that's why it cost cost 80 bucks there's",
    "start": "2152160",
    "end": "2158359"
  },
  {
    "text": "also probably like $70 worth of shielding wrapped around that that I already peeled off the $20 version is",
    "start": "2158359",
    "end": "2163720"
  },
  {
    "text": "like the cheap one you can get on Amazon which um is the one I normally use but instead I'm using this this one which is",
    "start": "2163720",
    "end": "2169440"
  },
  {
    "text": "also ripped open um it's uh this is neat it's a firmware upd we'll show you that in just a second if we look at the Apple",
    "start": "2169440",
    "end": "2175640"
  },
  {
    "text": "ones though what do we see jte so again I I've noticed this",
    "start": "2175640",
    "end": "2181359"
  },
  {
    "text": "I've hooked it up it is in fact J tag I haven't poked it it or modified or flashed anything but think about it",
    "start": "2181359",
    "end": "2186520"
  },
  {
    "text": "we've got this device it's the trusted device we carry around with us it's the one we plug in when we present and this",
    "start": "2186520",
    "end": "2192319"
  },
  {
    "text": "is not a passive device anymore we're not dealing with a display adapter we're",
    "start": "2192319",
    "end": "2197440"
  },
  {
    "text": "just dealing with a expansion to our system that is potentially got very low-level access to the hardware that",
    "start": "2197440",
    "end": "2204200"
  },
  {
    "text": "also does display so let's look at the cheap one right we rip it open you've got one ship right there again USBC can",
    "start": "2204200",
    "end": "2210560"
  },
  {
    "text": "do Native display port um in this inside here there's a little chip and that does",
    "start": "2210560",
    "end": "2215760"
  },
  {
    "text": "the display port to VJ uh adapter protocol changing um and then uh the",
    "start": "2215760",
    "end": "2222680"
  },
  {
    "text": "next thing we look at this chip is an nxp chip that is a USB power delivery chip and this is what negotiates with",
    "start": "2222680",
    "end": "2228440"
  },
  {
    "text": "the host to say hey I'm a VJ adapter which means I need 5 volts at you know",
    "start": "2228440",
    "end": "2234040"
  },
  {
    "text": "500 milliamps please send me that power which seems reasonable right except it might also say hey I'm a laptop send me",
    "start": "2234040",
    "end": "2240839"
  },
  {
    "text": "20 volts at 4 amps and that can make bad things happen to devices that weren't expecting 20 volts to suddenly be",
    "start": "2240839",
    "end": "2246880"
  },
  {
    "text": "rushing down the US USB wires but what's really interesting on this one is this chip and this is another nxp chip it's a",
    "start": "2246880",
    "end": "2252800"
  },
  {
    "text": "USB device this is what tells the system that it's a US display adapter we plug it in it says oh oh your display adapter",
    "start": "2252800",
    "end": "2259280"
  },
  {
    "text": "let me turn on display stuff and ignore the rest um what I noticed though you ever heard of dfu direct firmware update",
    "start": "2259280",
    "end": "2266119"
  },
  {
    "text": "this chip is firmware updatable over USB yay we just plugged it in over USB so I",
    "start": "2266119",
    "end": "2271760"
  },
  {
    "text": "can dump the firmware off of that go through tamper it modify it send it back and my objective of what I'm going to do",
    "start": "2271760",
    "end": "2277359"
  },
  {
    "text": "is this one not the one I use when I present but the one I'm want to share with other people who know that present and I want to play a nasty trick on is",
    "start": "2277359",
    "end": "2283440"
  },
  {
    "text": "I'm going to have it set up to um do the the forward and back buttons right as a USB device so you plug this in you think",
    "start": "2283440",
    "end": "2290119"
  },
  {
    "text": "it's your display adapter it also shows up as a humanit interface device and lets you advance slides and it's just going to randomly Advance their slides",
    "start": "2290119",
    "end": "2295319"
  },
  {
    "text": "for them I think that's I think that's a fun prank I don't have a video demo I haven't done that yet it's just my plan",
    "start": "2295319",
    "end": "2301319"
  },
  {
    "text": "so pardon the the I I guess I always worry that I'm going to over overpromise",
    "start": "2301319",
    "end": "2306560"
  },
  {
    "text": "and underd deliver talk I hope I haven't done that cuz I said five and I'm only giving you four and a half so please forgive me um that means you you know on",
    "start": "2306560",
    "end": "2314000"
  },
  {
    "text": "the ratings you just give me a four and a half instead of a five right um so dfu util it's free software you go and you",
    "start": "2314000",
    "end": "2320480"
  },
  {
    "text": "open and you can dump the contents of that firmware and you can modify them and write them back it's an arm m0 core so as long as you know how to write arm",
    "start": "2320480",
    "end": "2326720"
  },
  {
    "text": "code you can do fun stuff with that so what when we have only one port that",
    "start": "2326720",
    "end": "2331839"
  },
  {
    "text": "Port can do anything it's an implant designer's dream um Hardware isn't just Hardware anymore there AR aren't passive",
    "start": "2331839",
    "end": "2338040"
  },
  {
    "text": "devices right I mean uh even in in the class I teach we we play with HDMI you know everybody knows that that somehow",
    "start": "2338040",
    "end": "2344640"
  },
  {
    "text": "the the cable tells the system what the resolution of the display is in order to do that it has to communicate it's a",
    "start": "2344640",
    "end": "2350040"
  },
  {
    "text": "two-way communication over HDMI all these things that we think are passive devices are not anymore um the other sad",
    "start": "2350040",
    "end": "2356599"
  },
  {
    "text": "thing is there's no reasonable way for a user to know what a device does right if I go to the Apple Store and I tell them",
    "start": "2356599",
    "end": "2362520"
  },
  {
    "text": "I want to display something and they give me this like okay it's it's a plastic box I got it from Apple it's sealed except for this one isn't sealed",
    "start": "2362520",
    "end": "2369440"
  },
  {
    "text": "we need to have a better way of actually telling people what is inside and what is actually working so um today's",
    "start": "2369440",
    "end": "2377440"
  },
  {
    "text": "implants we did a blindly escalating privilege using JTAG right we patch kernels via dma on an embedded device we",
    "start": "2377440",
    "end": "2384960"
  },
  {
    "text": "enabled wireless control off the offshelf PC uh PLC we hot plugged this expansion device which actually used the",
    "start": "2384960",
    "end": "2390960"
  },
  {
    "text": "same JTAG you know code and Hardware as the first example but on a very different setting and then we talked",
    "start": "2390960",
    "end": "2397599"
  },
  {
    "text": "about how we could just take take a device that everyone trusts and someone you could buy off a store online and and plug it in and it's just not going to do",
    "start": "2397599",
    "end": "2403760"
  },
  {
    "text": "what you think it does even though you think it's such a simple adapter so look at this this is um all",
    "start": "2403760",
    "end": "2410839"
  },
  {
    "text": "about the display port stuff stacked up on a $20 bill and um so this solder Peak",
    "start": "2410839",
    "end": "2416560"
  },
  {
    "text": "um couple bucks you know you could do it with an Arduino board and some Pogo pins like I did here um less than five bucks",
    "start": "2416560",
    "end": "2423440"
  },
  {
    "text": "the uh Arduino plus the NRF you know three bucks worth of Hardware some wires",
    "start": "2423440",
    "end": "2429200"
  },
  {
    "text": "um and over here we've got the the slot screen which is kind of pricey it's like 60 to 70 bucks but if you're if you're",
    "start": "2429200",
    "end": "2436119"
  },
  {
    "text": "dead set on making an implant um I think that's well within your price range um",
    "start": "2436119",
    "end": "2442680"
  },
  {
    "text": "uh the point is between $5 and $75 a hobbyist could build these many of",
    "start": "2442680",
    "end": "2448160"
  },
  {
    "text": "them are actually published on the NSA playet website and GitHub if you're interested in building your own um they",
    "start": "2448160",
    "end": "2453400"
  },
  {
    "text": "weigh less than an ounce they can be customized they're all pretty Universal once you get down to the lowest level of the hardware you know ones and zeros are",
    "start": "2453400",
    "end": "2460839"
  },
  {
    "text": "voltages and it doesn't matter whether your myips arm or x86 it's all the same it doesn't matter if you're an embedded",
    "start": "2460839",
    "end": "2466000"
  },
  {
    "text": "system it's all the same um so you can customize these pretty easily to many different targets and this I really",
    "start": "2466000",
    "end": "2471760"
  },
  {
    "text": "think barely scratches the surface of what's possible these are a bunch of things I built um in my spare time um I",
    "start": "2471760",
    "end": "2478240"
  },
  {
    "text": "don't actually sell these I don't like have any government contracts where I Supply uh Hardware implants to anyone",
    "start": "2478240",
    "end": "2483960"
  },
  {
    "text": "that would be pretty cool um actually wouldn't be pretty cool I would kind of not be interested in doing that if you're thinking of asking me um but you",
    "start": "2483960",
    "end": "2491560"
  },
  {
    "text": "know this is what I do for fun um so if you're funded if you're a a state actor um this is well well well within what",
    "start": "2491560",
    "end": "2498760"
  },
  {
    "text": "you should be aware of and you should be able to do um uh with very little uh time and effort and money Hardware is",
    "start": "2498760",
    "end": "2505920"
  },
  {
    "text": "cheap standard interfaces really are standard automating these little devices is Trivial if you can't trust the",
    "start": "2505920",
    "end": "2513040"
  },
  {
    "text": "hardware you can't trust the software right if you can't control if you can",
    "start": "2513040",
    "end": "2518160"
  },
  {
    "text": "control the hardware then in some way shape or form you can control the software okay um those are my takeaways",
    "start": "2518160",
    "end": "2525680"
  },
  {
    "text": "and I'm going to leave you with another philosophical thought so there's a story about the",
    "start": "2525680",
    "end": "2532160"
  },
  {
    "text": "three vinegar tasters and there's lots of old images you know pictures of these guys so on the left we've got conf",
    "start": "2532160",
    "end": "2538319"
  },
  {
    "text": "actually I don't know which is which I think the left is confucious right he tastes this bowl of this jar of vinegar",
    "start": "2538319",
    "end": "2543559"
  },
  {
    "text": "and it says oh it tastes sour because vinegar is wine that has been polluted that's passed its prime it's",
    "start": "2543559",
    "end": "2549800"
  },
  {
    "text": "spoiled clearly this represents the conference goer who missed the open bar right now the next one is Buddha right",
    "start": "2549800",
    "end": "2557160"
  },
  {
    "text": "he tastes the vinegar and he says oh this tastes bitter but you know life is pain and suffering that's what we should",
    "start": "2557160",
    "end": "2563440"
  },
  {
    "text": "expect and we should just deal with it he's probably an in incident responder okay lastly we have L and he's smiling",
    "start": "2563440",
    "end": "2570760"
  },
  {
    "text": "he tastes the vinegar and he's like oh vinegar I know what I'm doing and he goes and gets some peroxide and some",
    "start": "2570760",
    "end": "2576000"
  },
  {
    "text": "salt and he mixes it up and he uses that to etch his pcbs to make his Hardware implants so",
    "start": "2576000",
    "end": "2583599"
  }
]