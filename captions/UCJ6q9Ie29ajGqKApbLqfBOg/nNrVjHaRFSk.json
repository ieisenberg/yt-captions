[
  {
    "text": "you're here to listen to next gen talk about TLS secrets and so I will get out",
    "start": "0",
    "end": "5339"
  },
  {
    "text": "of your way hi everyone and my name is",
    "start": "5339",
    "end": "14219"
  },
  {
    "text": "floor I'm here to talk about TLS I'm let me tell you how much of a surprise it is",
    "start": "14219",
    "end": "20279"
  },
  {
    "text": "to me 25 full room here I mean I was expected in literally three people cryptography is usually not what is",
    "start": "20279",
    "end": "26820"
  },
  {
    "text": "attracting the crowds you know like but I'm pleasingly surprised so let's get",
    "start": "26820",
    "end": "32940"
  },
  {
    "text": "into it today we're going to talk a lot about this it wasn't actually intended",
    "start": "32940",
    "end": "40920"
  },
  {
    "text": "when I did submit my talk this wasn't on the news and this wasn't actually plan",
    "start": "40920",
    "end": "48000"
  },
  {
    "text": "but you'll see how it fits into it and I hope that this will help you will help",
    "start": "48000",
    "end": "53640"
  },
  {
    "text": "me convince you that there is reasons to",
    "start": "53640",
    "end": "58829"
  },
  {
    "text": "actually fix the few bugs I'm going to drop today so without any more delays",
    "start": "58829",
    "end": "64710"
  },
  {
    "text": "let me introduce you to the plan well nothing very exceptional here it's",
    "start": "64710",
    "end": "71070"
  },
  {
    "text": "really a standard black a talk for parts introduction lolcat demos the tool",
    "start": "71070",
    "end": "78570"
  },
  {
    "text": "conclusion that's what you were expecting now so let's start by Who am I",
    "start": "78570",
    "end": "87380"
  },
  {
    "text": "why I'm here then we'll talk a bit about SSL and TLS and what you need to know",
    "start": "87380",
    "end": "95490"
  },
  {
    "text": "about it this is unfortunately required to that we share the same vocabulary and and we understand each other then I'll",
    "start": "95490",
    "end": "102930"
  },
  {
    "text": "introduce forward secrecy I hope most of you are familiar with the notion well if",
    "start": "102930",
    "end": "108329"
  },
  {
    "text": "you're not I'll try to introduce to you why this matters then we'll start all I",
    "start": "108329",
    "end": "114750"
  },
  {
    "text": "usually don't do that but this time I'll make an exception I'll review part of an RFC I don't know if many of you have",
    "start": "114750",
    "end": "121350"
  },
  {
    "text": "actually read an RFC so far but really you should because sometimes some of it",
    "start": "121350",
    "end": "127020"
  },
  {
    "text": "is really funny so we'll start by that and then",
    "start": "127020",
    "end": "133370"
  },
  {
    "text": "once we've established that the standard is incomplete broken or otherwise known",
    "start": "133370",
    "end": "141959"
  },
  {
    "text": "perfect we look at the implementation of it because you know in cryptography it's",
    "start": "141959",
    "end": "147810"
  },
  {
    "text": "not only about how things are supposed to be what really matters is how its implemented and how it's used well so",
    "start": "147810",
    "end": "154590"
  },
  {
    "text": "we'll look at openssl I should have arguably looked at other implementations",
    "start": "154590",
    "end": "160170"
  },
  {
    "text": "but openssl tends to be what everyone is using nowadays so I think I'll pin it by",
    "start": "160170",
    "end": "167940"
  },
  {
    "text": "nailing that one down we'll have a good overview of what people actually use it in the wall and then when we establish",
    "start": "167940",
    "end": "175109"
  },
  {
    "text": "the openssl is arguably non-perfect too and has also known problems we'll start",
    "start": "175109",
    "end": "182250"
  },
  {
    "text": "looking at the applications because after all in our open SSL is just a library it's up to the applications to",
    "start": "182250",
    "end": "187859"
  },
  {
    "text": "do the right thing that's what you would expect right once some done talking",
    "start": "187859",
    "end": "195810"
  },
  {
    "text": "about the applications I'll put my we look through the prison and we'll try to",
    "start": "195810",
    "end": "203340"
  },
  {
    "text": "find what the applications of what I'm talking about today can be applied to",
    "start": "203340",
    "end": "208709"
  },
  {
    "text": "something like prism then I'll introduce you a tool which allows to cool things",
    "start": "208709",
    "end": "214889"
  },
  {
    "text": "and then i'll conclude so everyone seems",
    "start": "214889",
    "end": "223560"
  },
  {
    "text": "to be settled in there is still a few room seats here if you want to come without any further delay let me move on",
    "start": "223560",
    "end": "231799"
  },
  {
    "text": "so Who am I and why am I here well my job is all about raising security",
    "start": "231799",
    "end": "239760"
  },
  {
    "text": "awareness that's what I do I I lead a",
    "start": "239760",
    "end": "244949"
  },
  {
    "text": "small team for a boutique shop across the pound in London I we do lots of",
    "start": "244949",
    "end": "252989"
  },
  {
    "text": "interesting things that instead of response forensic red team exercise",
    "start": "252989",
    "end": "258320"
  },
  {
    "text": "really bespoke services I'm also training people I'm one of the few Tyga",
    "start": "258320",
    "end": "265409"
  },
  {
    "text": "scheme trainers you've probably never heard about Tyga scheme here I'm on this side of the Atlantic but I'm also one of the guys",
    "start": "265409",
    "end": "274050"
  },
  {
    "text": "who is behind free net for those of you who know what Farina is free net is of who don't know what Farina is free net",
    "start": "274050",
    "end": "281070"
  },
  {
    "text": "is a decentralized anonymous network whose goal is to provide provide a way",
    "start": "281070",
    "end": "287340"
  },
  {
    "text": "for people to publish and retrieve information anonymously without having",
    "start": "287340",
    "end": "293250"
  },
  {
    "text": "to fear censorship and I'm also the guy who lost your go upon your would you",
    "start": "293250",
    "end": "301350"
  },
  {
    "text": "remember the f5 bug well that was me so",
    "start": "301350",
    "end": "309200"
  },
  {
    "text": "let's move on to ssl well to talk about",
    "start": "309200",
    "end": "314790"
  },
  {
    "text": "ssl i really need to give you a bit of history and background about the protocol itself so what do you need to",
    "start": "314790",
    "end": "322500"
  },
  {
    "text": "know that is a cell you need to know that SSL is actually a very old protocol it became de facto standard today she",
    "start": "322500",
    "end": "330630"
  },
  {
    "text": "want to secure sessions on the Internet everyone is using SSL and those who are",
    "start": "330630",
    "end": "336870"
  },
  {
    "text": "not arguably should now there is many versions of SSL you'll see that the",
    "start": "336870",
    "end": "342450"
  },
  {
    "text": "versions people use nowadays are ssl versions free and Tiaras version one the",
    "start": "342450",
    "end": "348060"
  },
  {
    "text": "adoption of the more recent versions of the standards and subversion of the standards are not yet widespread",
    "start": "348060",
    "end": "353690"
  },
  {
    "text": "browsers are starting to support these the first two versions of SSL are",
    "start": "353690",
    "end": "361200"
  },
  {
    "text": "willfully broken in so many ways it's not even funny the bottom line is at",
    "start": "361200",
    "end": "369830"
  },
  {
    "text": "today you should be using TLS everyone refers to ssl but really what people",
    "start": "369830",
    "end": "376650"
  },
  {
    "text": "mean is TLS transport layer security this is what you're using today one",
    "start": "376650",
    "end": "382620"
  },
  {
    "text": "version of it so why is this slide well because I'm trying to do you know what",
    "start": "382620",
    "end": "389910"
  },
  {
    "text": "the main differences in between SSL and TLS what was the main evolution there",
    "start": "389910",
    "end": "395520"
  },
  {
    "text": "any ID no no one no it's not forward secrecy",
    "start": "395520",
    "end": "404729"
  },
  {
    "text": "actually you were supposed to our forward secrecy and argue during my talk that you had better forward secrecy",
    "start": "404729",
    "end": "410300"
  },
  {
    "text": "using SSL than using TRS well the main main evolution in between both is that",
    "start": "410300",
    "end": "416430"
  },
  {
    "text": "TLS is extensible there is extensions to it ssl was a fixed format that you",
    "start": "416430",
    "end": "421530"
  },
  {
    "text": "couldn't really extend and improve well TLS has a format folder where you can have optional extensions which allow you",
    "start": "421530",
    "end": "430379"
  },
  {
    "text": "to enrich the protocol one way or not so today I'm going to talk about one",
    "start": "430379",
    "end": "436409"
  },
  {
    "text": "extension in particular which is specified in RFC 5077 so before we go in",
    "start": "436409",
    "end": "447539"
  },
  {
    "text": "more details about that I want to do a bit of myth-busting here because i think",
    "start": "447539",
    "end": "453060"
  },
  {
    "text": "it's required you know i do security consultancy for a living and i still see",
    "start": "453060",
    "end": "458610"
  },
  {
    "text": "people who don't use TLS and the best I mean the reason I hear the most often is",
    "start": "458610",
    "end": "465300"
  },
  {
    "text": "that TLS as a cost the performance cost well let me tell you that this doesn't",
    "start": "465300",
    "end": "473039"
  },
  {
    "text": "exist there is just no good it's not a good reason not to be using tears are",
    "start": "473039",
    "end": "478860"
  },
  {
    "text": "going more details about that the rational reasons why you would want to",
    "start": "478860",
    "end": "486229"
  },
  {
    "text": "consider TLS being expensive can be summarized into two different points one",
    "start": "486229",
    "end": "492449"
  },
  {
    "text": "of them is at and shaking per the unchecking part of the protocol is expensive because you have to do a",
    "start": "492449",
    "end": "497789"
  },
  {
    "text": "symmetric cryptography pasti and shaking part it's symmetric cryptography and in",
    "start": "497789",
    "end": "504750"
  },
  {
    "text": "case you have users who are spread across the world if you are on a high",
    "start": "504750",
    "end": "510689"
  },
  {
    "text": "loss a lossy network you will have scenarios where the cost of doing SSL is",
    "start": "510689",
    "end": "519300"
  },
  {
    "text": "actually huge because if you start having packet loss you will introduce an",
    "start": "519300",
    "end": "525560"
  },
  {
    "text": "incredible amount of latency French I mean packets basically need to happen in",
    "start": "525560",
    "end": "532050"
  },
  {
    "text": "all when you're using a security protocol and then you're using encryption if they don't arrive in order this is a problem",
    "start": "532050",
    "end": "537840"
  },
  {
    "text": "and this means you'll have to retransmit and this will make you waste time volume",
    "start": "537840",
    "end": "545490"
  },
  {
    "text": "doesn't matter and this is the point I'm trying to raise here my next slide is all about that so why volume doesn't",
    "start": "545490",
    "end": "555240"
  },
  {
    "text": "matter well because after handshaking part it's all symmetric encryption and",
    "start": "555240",
    "end": "561030"
  },
  {
    "text": "the symmetric encryption is basically",
    "start": "561030",
    "end": "566840"
  },
  {
    "text": "done using a cipher usually a block cipher here on this graph I'm actually",
    "start": "566840",
    "end": "573030"
  },
  {
    "text": "presenting you this is a bit old by the way the performance on a single core of",
    "start": "573030",
    "end": "578910"
  },
  {
    "text": "the different ciphers you would most commonly use with SSL or TLS as you can",
    "start": "578910",
    "end": "585090"
  },
  {
    "text": "see you can do with our hardware acceleration using air sea for three",
    "start": "585090",
    "end": "590400"
  },
  {
    "text": "hundred and fifty megabytes yet megabytes per second on a single core",
    "start": "590400",
    "end": "596670"
  },
  {
    "text": "and this graph is all if you start having hardware support and that's all",
    "start": "596670",
    "end": "601680"
  },
  {
    "text": "the modern recent Intel processors from I thought I five something this does six",
    "start": "601680",
    "end": "608430"
  },
  {
    "text": "hundred and forty megabytes per second their core you will hardly ever handle",
    "start": "608430",
    "end": "614760"
  },
  {
    "text": "that kind of traffic so no don't argue that crypto is expensive because that's",
    "start": "614760",
    "end": "620760"
  },
  {
    "text": "just not true anymore you can afford it so I did say that part of the cost is",
    "start": "620760",
    "end": "628320"
  },
  {
    "text": "the performance of the handshake and they're there is unfortunately not much you can do about it there is no silver",
    "start": "628320",
    "end": "634680"
  },
  {
    "text": "bullet asymmetric cryptography whichever where you stretch it it's going to be expensive to some extent it's also",
    "start": "634680",
    "end": "642270"
  },
  {
    "text": "something you can't really optimize there is different technologies that you can use you know there is a DSA cdsa but",
    "start": "642270",
    "end": "649800"
  },
  {
    "text": "at the end of the day won't make much of a difference this is always going to be the expensive part one of the things you",
    "start": "649800",
    "end": "655740"
  },
  {
    "text": "can optimize is a key size but nowadays it's already pretty much optimized if",
    "start": "655740",
    "end": "661110"
  },
  {
    "text": "you use an RSA 2048 bits this is really the minimum you should be",
    "start": "661110",
    "end": "667050"
  },
  {
    "text": "comfortable using nowadays if you use anything smaller than that you will have",
    "start": "667050",
    "end": "672180"
  },
  {
    "text": "nasty surprises very soon the solution",
    "start": "672180",
    "end": "678540"
  },
  {
    "text": "is to handshake only once why well if",
    "start": "678540",
    "end": "683790"
  },
  {
    "text": "you look at most use case I mean the standard use case is a browser right you're handling a website a high-traffic",
    "start": "683790",
    "end": "690990"
  },
  {
    "text": "website well most browsers will have many parallel connections and those",
    "start": "690990",
    "end": "697019"
  },
  {
    "text": "parallel connections I can be reusing the same key material if you teach your",
    "start": "697019",
    "end": "704779"
  },
  {
    "text": "implementation and you tell the server that yes I want to reuse key material well there is actually a mechanism in",
    "start": "704779",
    "end": "712110"
  },
  {
    "text": "SSL to do that it's called session resumption so other session resumption",
    "start": "712110",
    "end": "718949"
  },
  {
    "text": "work the classical SSL handshake when",
    "start": "718949",
    "end": "723959"
  },
  {
    "text": "you start without such an assumption is a 4 Way handshake as displayed here so",
    "start": "723959",
    "end": "729600"
  },
  {
    "text": "the flow starts by the clients who sends a placket a client hello saying hey I'm",
    "start": "729600",
    "end": "736470"
  },
  {
    "text": "a client I'd like to handshake here is a list of ciphers I can support here is the options I know about why don't you",
    "start": "736470",
    "end": "743250"
  },
  {
    "text": "tell me what is acceptable to you the server replies bundling certificates picking a cipher the key is negotiated",
    "start": "743250",
    "end": "750990"
  },
  {
    "text": "and the cell finalized the exchange small question here do you know why it's",
    "start": "750990",
    "end": "756600"
  },
  {
    "text": "actually a 4 Way handshake instead of a 3-way handshake but I mean what would be",
    "start": "756600",
    "end": "763500"
  },
  {
    "text": "the reason why you would not do it in three now it's actually daniela of",
    "start": "763500",
    "end": "770220"
  },
  {
    "text": "Service protection you want the client to be computing and committing some a",
    "start": "770220",
    "end": "776339"
  },
  {
    "text": "round-trip before you do any expensive computation on the south side this is",
    "start": "776339",
    "end": "781889"
  },
  {
    "text": "usually why you go I mean most and shaking further goals most critical and shaking protocols are actually full way",
    "start": "781889",
    "end": "787939"
  },
  {
    "text": "so how does it work well without resumption I'll give you an example so",
    "start": "787939",
    "end": "794069"
  },
  {
    "text": "let me introduce you the testbed here i've got vm running and these vm runs standard apache server",
    "start": "794069",
    "end": "802890"
  },
  {
    "text": "right standard apache server which is",
    "start": "804360",
    "end": "816130"
  },
  {
    "text": "configured to use ssl if i connect to it this is what I do here so guinea pig is",
    "start": "816130",
    "end": "823810"
  },
  {
    "text": "my is in the search connection to this virtual machine that you've seen here I'll use up from now on because it's",
    "start": "823810",
    "end": "830529"
  },
  {
    "text": "easier so if i connect locally this is what i usually get using ssl if i do a",
    "start": "830529",
    "end": "838540"
  },
  {
    "text": "get request i get HTML back which tells me that yes this is working this is an",
    "start": "838540",
    "end": "845080"
  },
  {
    "text": "HTTP server now if i do a standard ssl",
    "start": "845080",
    "end": "850180"
  },
  {
    "text": "connection and i specify a few options",
    "start": "850180",
    "end": "856960"
  },
  {
    "text": "here you can see different sin are",
    "start": "856960",
    "end": "862060"
  },
  {
    "text": "different things here so one thing you can see is the version of the protocol i've negotiated turns out that he",
    "start": "862060",
    "end": "867670"
  },
  {
    "text": "refused TLS version 1 this is a cipher which has been picked and this is a",
    "start": "867670",
    "end": "873040"
  },
  {
    "text": "session ID what is the session ID useful for well it's useful for the session",
    "start": "873040",
    "end": "878170"
  },
  {
    "text": "resumption and i'll show you just now how that works the master key is the key",
    "start": "878170",
    "end": "884500"
  },
  {
    "text": "which is used to derive all the session Keys so other session resumption work",
    "start": "884500",
    "end": "892900"
  },
  {
    "text": "well after the first connection when you have done the fool for Way handshake you",
    "start": "892900",
    "end": "899410"
  },
  {
    "text": "can actually tell the server the server issues you a session ID that we've just seen and you can actually tell the",
    "start": "899410",
    "end": "904990"
  },
  {
    "text": "server well here is my session ID why don't we reuse the same key material and that allows you to basically transform",
    "start": "904990",
    "end": "913990"
  },
  {
    "text": "the four-way and shake into a three-way handshake because the server already knows that you have committed to a round",
    "start": "913990",
    "end": "920470"
  },
  {
    "text": "trip you have Kim at you have access to a session or two material that the",
    "start": "920470",
    "end": "926410"
  },
  {
    "text": "server knows it has negotiated in the past let me illustrate that so here I'm going",
    "start": "926410",
    "end": "938310"
  },
  {
    "text": "to save I'm going to save the key",
    "start": "938310",
    "end": "950220"
  },
  {
    "text": "material so you can see that this time my session ID starts by FD and finish by",
    "start": "950220",
    "end": "955920"
  },
  {
    "text": "6p and my key material starts by 07 and finish by e2 now I kill the session or I",
    "start": "955920",
    "end": "964170"
  },
  {
    "text": "do a standard request I've got a second request coming I reuse the key material",
    "start": "964170",
    "end": "969600"
  },
  {
    "text": "and the key material of my new session is exactly the same make sense I can",
    "start": "969600",
    "end": "979139"
  },
  {
    "text": "reconnect several times using the same key material and you will see that every",
    "start": "979139",
    "end": "984449"
  },
  {
    "text": "single time I'll negotiate the same session by presenting the same session ID the server the clock by presenting",
    "start": "984449",
    "end": "991980"
  },
  {
    "text": "the same session ID the client will encourage the server to reuse the key material so all that is very nice and",
    "start": "991980",
    "end": "1002930"
  },
  {
    "text": "worked very well but people you know they always want to optimize can you can",
    "start": "1002930",
    "end": "1011180"
  },
  {
    "text": "you think about anything here which on the service side would potentially cause problems",
    "start": "1011180",
    "end": "1018610"
  },
  {
    "text": "ma'am well memory I've heard it their memory because each time you negotiate a",
    "start": "1021680",
    "end": "1028470"
  },
  {
    "text": "new session you need to have a cache where you stole the key material and what I implies is that each time a new",
    "start": "1028470",
    "end": "1034770"
  },
  {
    "text": "client makes a new connection a fool for way and shake you're going to use some memory up to store the key material",
    "start": "1034770",
    "end": "1041308"
  },
  {
    "text": "associated with that session so people decided to make it stateless stateless",
    "start": "1041309",
    "end": "1048659"
  },
  {
    "text": "is what everyone does right so today most of my talk is about an extension of",
    "start": "1048659",
    "end": "1054780"
  },
  {
    "text": "the protocol of TLS which is called session tickets session tickets are a",
    "start": "1054780",
    "end": "1062070"
  },
  {
    "text": "blob of encrypted data with a secret which has been picked and chosen by the",
    "start": "1062070",
    "end": "1068760"
  },
  {
    "text": "server which is handed over to the client and each time the client connects",
    "start": "1068760",
    "end": "1075929"
  },
  {
    "text": "the client will present the same blob that the server will be able to decrypt because it has a key for that and that",
    "start": "1075929",
    "end": "1082590"
  },
  {
    "text": "will contain the key material used in that specific session next sense so",
    "start": "1082590",
    "end": "1091730"
  },
  {
    "text": "obviously you know people are not always",
    "start": "1091730",
    "end": "1096860"
  },
  {
    "text": "this sounds very nice in theory now in practice there is lots of room lots of",
    "start": "1097429",
    "end": "1104190"
  },
  {
    "text": "things which could go wrong if there is one thing that I've seen people's grew up in cryptography its key management",
    "start": "1104190",
    "end": "1110789"
  },
  {
    "text": "and sending your key material to the client every single time you make an",
    "start": "1110789",
    "end": "1117059"
  },
  {
    "text": "exchange and sending it in clear because that's what you do TLS is a declarative protocol where most of the signalization",
    "start": "1117059",
    "end": "1123240"
  },
  {
    "text": "is actually done in clear text i'll show you afterwards i've got a few slides with water truck and we're going to go",
    "start": "1123240",
    "end": "1128760"
  },
  {
    "text": "through an exchange but most of us each time you change key material each time you renegotiate each time you terminate",
    "start": "1128760",
    "end": "1135690"
  },
  {
    "text": "a session this is all information which is public each time you try to handshake to server the certificate goes in clear",
    "start": "1135690",
    "end": "1141750"
  },
  {
    "text": "text so the earth see does a good job at giving an example of how you could be",
    "start": "1141750",
    "end": "1148770"
  },
  {
    "text": "implementing it I I won't read that in details but it",
    "start": "1148770",
    "end": "1155460"
  },
  {
    "text": "basically specifies what cipher you should be using how you should be for making the tickets so there is a key",
    "start": "1155460",
    "end": "1161549"
  },
  {
    "text": "name there is an IV there is the encrypted state that's a blob of data and there is a Mac this is all the RFC",
    "start": "1161549",
    "end": "1170040"
  },
  {
    "text": "suggest you do it what does it look like well let me show you what it looks like",
    "start": "1170040",
    "end": "1175320"
  },
  {
    "text": "I connect to the very same server but this time I'm removing the no ticket",
    "start": "1175320",
    "end": "1182280"
  },
  {
    "text": "option and I'm getting from the server a",
    "start": "1182280",
    "end": "1188870"
  },
  {
    "text": "session ticket which is our blob of encrypted data now before I go any",
    "start": "1188870",
    "end": "1195570"
  },
  {
    "text": "further you might be curious about this part let me introduce you our slightly",
    "start": "1195570",
    "end": "1203370"
  },
  {
    "text": "modified openssl for the demo and to make it easier for you to understand and",
    "start": "1203370",
    "end": "1210809"
  },
  {
    "text": "see what is actually happening I didn't feel like showing you hex domes without any meaningful value so here's how I've",
    "start": "1210809",
    "end": "1218160"
  },
  {
    "text": "patch my openssl my open SSL is actually very flowed where instead of doing this",
    "start": "1218160",
    "end": "1223380"
  },
  {
    "text": "which is generating three different random key of 128 bits I'm actually hard",
    "start": "1223380",
    "end": "1231000"
  },
  {
    "text": "coding all the values so what that does is that my ticket name will always be a",
    "start": "1231000",
    "end": "1237120"
  },
  {
    "text": "my H makke ki will always be B and my es ki will always be C and this is why when",
    "start": "1237120",
    "end": "1243630"
  },
  {
    "text": "i connect here I'll always get a if you",
    "start": "1243630",
    "end": "1251070"
  },
  {
    "text": "connect it to a normal server and the real server it will also be always in name but the name would be random ok so",
    "start": "1251070",
    "end": "1264230"
  },
  {
    "text": "what could possibly go wrong well lots of things and this is what my",
    "start": "1265000",
    "end": "1270710"
  },
  {
    "text": "presentation is about but before I introduce you to you what is actually wrong with it I do need to talk about",
    "start": "1270710",
    "end": "1276920"
  },
  {
    "text": "forward secrecy or forward security so what is forward secrecy forward secrecy",
    "start": "1276920",
    "end": "1284000"
  },
  {
    "text": "is the property which ensures an attacker cannot decrypt a conversation",
    "start": "1284000",
    "end": "1289010"
  },
  {
    "text": "even if you record the entire session and subsequently steals the Associated",
    "start": "1289010",
    "end": "1294980"
  },
  {
    "text": "long-term secrets in other words it",
    "start": "1294980",
    "end": "1300470"
  },
  {
    "text": "ensures that the session case are not derivable from the information stored after the session concludes it's a very",
    "start": "1300470",
    "end": "1308660"
  },
  {
    "text": "important property most cryptosystems should feature that property most don't",
    "start": "1308660",
    "end": "1315980"
  },
  {
    "text": "of course lied about that so in practice what does that mean are you familiar with you know pin in cryptography we",
    "start": "1315980",
    "end": "1322280"
  },
  {
    "text": "usually use a schema where at least wants to talk to Bob and Mallory is a bad guy wants to do something and here",
    "start": "1322280",
    "end": "1331100"
  },
  {
    "text": "what does that mean well what can Mallory do if an exchange is done with a",
    "start": "1331100",
    "end": "1336680"
  },
  {
    "text": "crypto system which aims at doing for secrecy well with an active attack it",
    "start": "1336680",
    "end": "1342890"
  },
  {
    "text": "can do anything in any case but with a perceive attack if PFS easynews you",
    "start": "1342890",
    "end": "1349310"
  },
  {
    "text": "shouldn't be able to recover the plaintext even if the keys and the certificates and whatnot I've been",
    "start": "1349310",
    "end": "1355160"
  },
  {
    "text": "compromised so what would you want forward secrecy I've tried to put it in",
    "start": "1355160",
    "end": "1361910"
  },
  {
    "text": "words and I failed so here is my best get you know XKCD well this explains the",
    "start": "1361910",
    "end": "1370370"
  },
  {
    "text": "very reason why you want forward secrecy and this illustrates when i'll introduce",
    "start": "1370370",
    "end": "1380270"
  },
  {
    "text": "prism and make some conjectures about that why you would want forward secrecy everywhere you can't be asked to produce",
    "start": "1380270",
    "end": "1387260"
  },
  {
    "text": "something you don't have so where do you have no forward secrecy",
    "start": "1387260",
    "end": "1394340"
  },
  {
    "text": "and you should really have forward secrecy browsing the internet and this is what my talk is about and this is",
    "start": "1394340",
    "end": "1400879"
  },
  {
    "text": "what I'm trying to fix here by raising awareness and hopefully getting you involved in the solution in Wallace",
    "start": "1400879",
    "end": "1407840"
  },
  {
    "text": "today you're connected to a wireless network or if you're wiser you probably haven't but one of the things that you",
    "start": "1407840",
    "end": "1418190"
  },
  {
    "text": "might not know about it is everyone shared the same password and that means that anyone who is passively listening",
    "start": "1418190",
    "end": "1423590"
  },
  {
    "text": "to what has been exchanged as he knows the passwords if he captured your 4-way and Jake he can recover the plaintext so",
    "start": "1423590",
    "end": "1431360"
  },
  {
    "text": "it could have been an open network today that you would have been exactly the same thing now cell phones cell phones",
    "start": "1431360",
    "end": "1440299"
  },
  {
    "text": "also don't feature your forward secrecy everywhere I mean each time I look at",
    "start": "1440299",
    "end": "1445970"
  },
  {
    "text": "the security protocol it's very rare to see forward secrecy being used and this",
    "start": "1445970",
    "end": "1452029"
  },
  {
    "text": "is a shame and this really needs to change why isn't not used well I'm going",
    "start": "1452029",
    "end": "1457970"
  },
  {
    "text": "into that into this slide how do you get for secrecy I tried very hard to make my",
    "start": "1457970",
    "end": "1465619"
  },
  {
    "text": "slides simple enough so that everyone can understand so I stripped all the math all you need to know is that it's",
    "start": "1465619",
    "end": "1471200"
  },
  {
    "text": "based on modular exponentiation that construct and that means it's expensive",
    "start": "1471200",
    "end": "1477820"
  },
  {
    "text": "so it increases the cost of the handshaking phase and this diagram here",
    "start": "1477820",
    "end": "1484730"
  },
  {
    "text": "shows you what the cost is for the client and the server depending on different configurations the first one",
    "start": "1484730",
    "end": "1490850"
  },
  {
    "text": "is a standard exchange without for secrecy the second one is what you used to be where you were doing",
    "start": "1490850",
    "end": "1496730"
  },
  {
    "text": "diffie-hellman and the third and the fourth one are when you use elliptic",
    "start": "1496730",
    "end": "1502220"
  },
  {
    "text": "curve to the eur exchange as you can see the costs used to be three fold you",
    "start": "1502220",
    "end": "1509450"
  },
  {
    "text": "increase the cost by three and nowadays if you do it on a 64-bit system with the right cypher and true choice it's",
    "start": "1509450",
    "end": "1517460"
  },
  {
    "text": "basically only a 15-percent cost and that's peanuts or at least affordable this is",
    "start": "1517460",
    "end": "1524130"
  },
  {
    "text": "why nowadays every single new system being designed should feature for secrecy cost is not so much of a problem",
    "start": "1524130",
    "end": "1531659"
  },
  {
    "text": "anymore so now we reach the interesting",
    "start": "1531659",
    "end": "1536940"
  },
  {
    "text": "part now we all share the same vocabulary and we hopefully understand each other so I can introduce you to the",
    "start": "1536940",
    "end": "1544080"
  },
  {
    "text": "lolcatz that's what you guys were all waiting for now so let's start by",
    "start": "1544080",
    "end": "1550919"
  },
  {
    "text": "reading together a bit d RFC well hold on actually reading an RFC is really",
    "start": "1550919",
    "end": "1556140"
  },
  {
    "text": "boring so I'm not going to read on IRC I'm security consultant so the first section if you've never seen an RFC and",
    "start": "1556140",
    "end": "1562950"
  },
  {
    "text": "RC has different sections at the beginning of it so this is gr see this",
    "start": "1562950",
    "end": "1569280"
  },
  {
    "text": "is a table of content and as you can see this is actually standardized and it's the same in every single error see",
    "start": "1569280",
    "end": "1575700"
  },
  {
    "text": "there's introduction there's terminology there's protocol there's recommendations and eventually there is a paragraph",
    "start": "1575700",
    "end": "1581850"
  },
  {
    "text": "called security considerations well that's usually the one I read you know I do security after all so and that's the",
    "start": "1581850",
    "end": "1588570"
  },
  {
    "text": "one I want to give you a short read off so it starts by saying you know I told",
    "start": "1588570",
    "end": "1595890"
  },
  {
    "text": "you start off the start that what people screw up usually in cryptography is key",
    "start": "1595890",
    "end": "1601049"
  },
  {
    "text": "management and it turns out that there is a session a section about key management so let's read it together",
    "start": "1601049",
    "end": "1606360"
  },
  {
    "text": "because it's worth reading a full description of the management of the keys used to protect the ticket is",
    "start": "1606360",
    "end": "1613110"
  },
  {
    "text": "beyond the scope of this document",
    "start": "1613110",
    "end": "1617059"
  },
  {
    "text": "so there is a full internet standard which is suggesting something a bit",
    "start": "1618159",
    "end": "1626840"
  },
  {
    "text": "crazy let's face it you know you you're gonna spend CPU cycles negotiating securely a key and then you're gonna",
    "start": "1626840",
    "end": "1633860"
  },
  {
    "text": "take that key material encrypted in some unknown unspecified format and send her",
    "start": "1633860",
    "end": "1640159"
  },
  {
    "text": "over include tax to the client and tell them why don't you show me that every single time you connect and the security",
    "start": "1640159",
    "end": "1648679"
  },
  {
    "text": "consideration part of the standards say that the key management part is beyond",
    "start": "1648679",
    "end": "1654470"
  },
  {
    "text": "the scope of the document and merely amid some recommendations on how H would",
    "start": "1654470",
    "end": "1659720"
  },
  {
    "text": "be done what could possibly go wrong all",
    "start": "1659720",
    "end": "1666799"
  },
  {
    "text": "the recommendations made here are very sensible they're just nine off let's go",
    "start": "1666799",
    "end": "1672379"
  },
  {
    "text": "into more details but it's not like it's stopped there the next section is",
    "start": "1672379",
    "end": "1678529"
  },
  {
    "text": "actually about the lifetime there is a concept in cryptography where you know",
    "start": "1678529",
    "end": "1684110"
  },
  {
    "text": "you shouldn't be the reason why you usually Ricky is because you don't want to be using over and over at the same key material at some point you should",
    "start": "1684110",
    "end": "1690679"
  },
  {
    "text": "move on it doesn't make sense otherwise well guess what the error see specifies",
    "start": "1690679",
    "end": "1697549"
  },
  {
    "text": "that it would be good if you were changing the key but you really don't",
    "start": "1697549",
    "end": "1704690"
  },
  {
    "text": "have to let me read the part which specify that the ticket lifetime maybe",
    "start": "1704690",
    "end": "1710419"
  },
  {
    "text": "longer than the 24-hour lifetime recommended maybe longer I'll let the",
    "start": "1710419",
    "end": "1718419"
  },
  {
    "text": "implementation details up to your imagination so at this stage I was just",
    "start": "1718419",
    "end": "1726679"
  },
  {
    "text": "reading the RFC the reason I started reading the RFC is because I've seen a",
    "start": "1726679",
    "end": "1732409"
  },
  {
    "text": "talk done by native root labs here at blackhat in 2010 where you was talking",
    "start": "1732409",
    "end": "1738259"
  },
  {
    "text": "about a remote timing attack on open SSL and the practicality of them and he did",
    "start": "1738259",
    "end": "1744230"
  },
  {
    "text": "mention session tickets because one of the things he was concerned about is that there might be timing attack vector",
    "start": "1744230",
    "end": "1749880"
  },
  {
    "text": "on the H mag verification of those sessions it gets so this is the reason",
    "start": "1749880",
    "end": "1755400"
  },
  {
    "text": "why I'll started reading the earth thing and then II mention specifically openssl",
    "start": "1755400",
    "end": "1760440"
  },
  {
    "text": "saying that they are the problem well for your information they fix the problem they don't they're not obviously",
    "start": "1760440",
    "end": "1766860"
  },
  {
    "text": "vulnerable to a remote timing attack on the HVAC verification of the tls tickets",
    "start": "1766860",
    "end": "1772410"
  },
  {
    "text": "first you looked into openssl to find that out and this is where I found those",
    "start": "1772410",
    "end": "1777960"
  },
  {
    "text": "box so openssl what do they do tickets",
    "start": "1777960",
    "end": "1784230"
  },
  {
    "text": "are enabled by default as in if you use the default ssl option set you will have",
    "start": "1784230",
    "end": "1791550"
  },
  {
    "text": "the option and a bit the flag so that tickets are actually set in every single",
    "start": "1791550",
    "end": "1797250"
  },
  {
    "text": "session you make its encrypted using AES 128-bit its integrity protected using H",
    "start": "1797250",
    "end": "1805380"
  },
  {
    "text": "Mac Shea to with a 128-bit key which is a bit wet because you would expect the",
    "start": "1805380",
    "end": "1812190"
  },
  {
    "text": "key to be twice I lens at least and the keys are actually sold in session",
    "start": "1812190",
    "end": "1817980"
  },
  {
    "text": "context and there is no rekeying what",
    "start": "1817980",
    "end": "1823740"
  },
  {
    "text": "does that mean well what that means is that there is no point in using any",
    "start": "1823740",
    "end": "1832110"
  },
  {
    "text": "fancier cipher than aes 128 bits all",
    "start": "1832110",
    "end": "1837330"
  },
  {
    "text": "you're going to do is West CPU cycles",
    "start": "1837330",
    "end": "1841909"
  },
  {
    "text": "let me rephrase that because I don't think that the message got through here",
    "start": "1842900",
    "end": "1848660"
  },
  {
    "text": "you are going to spend a huge amount of CPU cycles doing a fancy protocol",
    "start": "1848660",
    "end": "1853830"
  },
  {
    "text": "negotiation with a very nice brand new shiny cypher and then you're going to",
    "start": "1853830",
    "end": "1860100"
  },
  {
    "text": "take that key material anchor to tweeze AES 128 bit and send that back to the",
    "start": "1860100",
    "end": "1866010"
  },
  {
    "text": "same medium in clear text the bad guy is",
    "start": "1866010",
    "end": "1874080"
  },
  {
    "text": "just going to decrypt your ticket if you can break aes-128 bit and that's what you're worried about and this is why",
    "start": "1874080",
    "end": "1880140"
  },
  {
    "text": "you're using a better safer than that well then you don't want to be using tickets and obviously the side effect of",
    "start": "1880140",
    "end": "1888899"
  },
  {
    "text": "all that is if you expecting forward secrecy on your exchange and you've",
    "start": "1888899",
    "end": "1895009"
  },
  {
    "text": "spent the CPU cycles required to do a DVM an exchange or Divya ma'am you will",
    "start": "1895009",
    "end": "1902460"
  },
  {
    "text": "expect a perfect forward secrecy interval which is better than the program / time you know about you",
    "start": "1902460",
    "end": "1910080"
  },
  {
    "text": "servers they stay some time on the internet for years they stay up for years and the key material is actually",
    "start": "1910080",
    "end": "1919080"
  },
  {
    "text": "present in memory for years so yeah I'll",
    "start": "1919080",
    "end": "1928860"
  },
  {
    "text": "just show you quickly what how to read",
    "start": "1928860",
    "end": "1935100"
  },
  {
    "text": "the cipher which is being negotiated so here I'm connecting to the same server again locally and the cipher which has",
    "start": "1935100",
    "end": "1942960"
  },
  {
    "text": "been negotiated in here so i'll introduce you how to read that the first",
    "start": "1942960",
    "end": "1948450"
  },
  {
    "text": "bit here is the type of key exchange which has been done in this case it's",
    "start": "1948450",
    "end": "1953879"
  },
  {
    "text": "any fear man it's an epic security film an exchange air say has been used to",
    "start": "1953879",
    "end": "1960629"
  },
  {
    "text": "authenticate the DC I'm an exchange and",
    "start": "1960629",
    "end": "1965419"
  },
  {
    "text": "I've negotiated aes 256 bits as my stream as my block cipher as my cypher",
    "start": "1966320",
    "end": "1974340"
  },
  {
    "text": "to to attempt to to do the symmetric encryption and encrypt the data I use",
    "start": "1974340",
    "end": "1982200"
  },
  {
    "text": "GCM mode and this is the integrity protection hash function which is in use",
    "start": "1982200",
    "end": "1990409"
  },
  {
    "text": "so what I'm arguing is that despite my session being created with all those",
    "start": "1990409",
    "end": "1996990"
  },
  {
    "text": "fancy modern ciphers and a modern protocol and everything else in this",
    "start": "1996990",
    "end": "2003230"
  },
  {
    "text": "case this blob here which has an OPEC format is encrypted using AES 128 bit",
    "start": "2003230",
    "end": "2009679"
  },
  {
    "text": "and this the bad guy gets on the wire all the time",
    "start": "2009679",
    "end": "2016330"
  },
  {
    "text": "so so far I've been talking about the standard I've been talking about",
    "start": "2020600",
    "end": "2026870"
  },
  {
    "text": "implementations of the standard in the form of libraries but libraries as you know we are not everything libraries are",
    "start": "2026870",
    "end": "2033840"
  },
  {
    "text": "just part of it where it's up to the",
    "start": "2033840",
    "end": "2039240"
  },
  {
    "text": "applications really to be fixing that so let's look at the applications I've",
    "start": "2039240",
    "end": "2048210"
  },
  {
    "text": "heard that all the cool kids nowadays use in jenks so I started looking at the",
    "start": "2048210",
    "end": "2053669"
  },
  {
    "text": "end jinx and guess what well they don't do anything special they use the default",
    "start": "2053669",
    "end": "2062270"
  },
  {
    "text": "openssl behavior which is the broken Behavior I've just talked about so some",
    "start": "2062270",
    "end": "2068849"
  },
  {
    "text": "people here are probably gonna say well I'm not the new kid on the block and are you are still use apache so i'll also",
    "start": "2068849",
    "end": "2076050"
  },
  {
    "text": "looked into Apache Apache it's actually more interesting they managed to make it",
    "start": "2076050",
    "end": "2083970"
  },
  {
    "text": "worse",
    "start": "2083970",
    "end": "2086300"
  },
  {
    "text": "so before of a before valeu that went very fast before this specific version",
    "start": "2089850",
    "end": "2098580"
  },
  {
    "text": "the PFS was a program's lifetime because I thought she was using the openssl default behavior after is a specific",
    "start": "2098580",
    "end": "2105790"
  },
  {
    "text": "version the user is in charge of key management because you know that in",
    "start": "2105790",
    "end": "2110920"
  },
  {
    "text": "standard they couldn't be bothered not specifying how it should be handled the library decided not to handle it sure",
    "start": "2110920",
    "end": "2118510"
  },
  {
    "text": "the application passes the responsibility on to the user what could possibly go wrong you know when you",
    "start": "2118510",
    "end": "2127120"
  },
  {
    "text": "report that to the vendors the vendors don't care partially because if you take",
    "start": "2127120",
    "end": "2133660"
  },
  {
    "text": "independently all the vulnerabilities I've talked to that here whether it's",
    "start": "2133660",
    "end": "2139650"
  },
  {
    "text": "decipher which is always the same whether it's the integrity protection mechanism which is inadequate whether",
    "start": "2139650",
    "end": "2146620"
  },
  {
    "text": "it's the CBS s Corvette is 0 because it's still crypto secure it's not",
    "start": "2146620",
    "end": "2153040"
  },
  {
    "text": "something you can break and what is wonderful here is I'll show you that there is practical implications to a set",
    "start": "2153040",
    "end": "2160660"
  },
  {
    "text": "of CBS s 0 bugs and if you put all the all the thing together you'll end up",
    "start": "2160660",
    "end": "2166180"
  },
  {
    "text": "with unexpected security properties so",
    "start": "2166180",
    "end": "2172780"
  },
  {
    "text": "what did when i said the apache actually made it worse i I feel like I can't",
    "start": "2172780",
    "end": "2178510"
  },
  {
    "text": "leave you like I actually need to elaborate a bit on what I meant so here",
    "start": "2178510",
    "end": "2183940"
  },
  {
    "text": "is they've introduced a directive called",
    "start": "2183940",
    "end": "2189610"
  },
  {
    "text": "SSL session ticket key file before you",
    "start": "2189610",
    "end": "2194770"
  },
  {
    "text": "had no choice you had to use tickets whatever regardless of what you do now you actually have a choice you can",
    "start": "2194770",
    "end": "2200920"
  },
  {
    "text": "specify this parameter and these parameters lets you specify a key file",
    "start": "2200920",
    "end": "2206410"
  },
  {
    "text": "and they tell you how to generate the key file using DD dev random and store it on disk so even go further and",
    "start": "2206410",
    "end": "2213820"
  },
  {
    "text": "specify the key file contains sensitive keying material and should be protected with the permission",
    "start": "2213820",
    "end": "2219700"
  },
  {
    "text": "similar to those used for two certificates a long term storage key",
    "start": "2219700",
    "end": "2225660"
  },
  {
    "text": "well that just proves that they don't understand what session tickets are",
    "start": "2225660",
    "end": "2231610"
  },
  {
    "text": "about session keep tickets and their key material is not to be retained long term",
    "start": "2231610",
    "end": "2239530"
  },
  {
    "text": "the last thing you want to do is to store it on a file which is stored on",
    "start": "2239530",
    "end": "2246750"
  },
  {
    "text": "presumably your forensically car verbal medium if I can dig out the key the",
    "start": "2246750",
    "end": "2254680"
  },
  {
    "text": "session key you've been negotiating out of the file system then why are we using",
    "start": "2254680",
    "end": "2259810"
  },
  {
    "text": "a different key at all it doesn't make",
    "start": "2259810",
    "end": "2265690"
  },
  {
    "text": "sense here it's just a documentation bug they could just fix it by saying to the",
    "start": "2265690",
    "end": "2271840"
  },
  {
    "text": "user you don't want that to be on the forensic league horrible medium all they",
    "start": "2271840",
    "end": "2277480"
  },
  {
    "text": "could change it behavior of the app which arguably think is a better ID because my next slides are talking a bit",
    "start": "2277480",
    "end": "2285370"
  },
  {
    "text": "about it who should be using session tickets and what were they intended for and you will see that the use case for",
    "start": "2285370",
    "end": "2291940"
  },
  {
    "text": "it is really really small so so far",
    "start": "2291940",
    "end": "2297730"
  },
  {
    "text": "we've been talking about browsers because browsers is everything you know everyone is using that nowadays and and",
    "start": "2297730",
    "end": "2303090"
  },
  {
    "text": "really there isn't much to say about it so let's talk about cases where it",
    "start": "2303090",
    "end": "2310810"
  },
  {
    "text": "actually matters are you all guys familiar with tall you know they are non-limiting network the idea is that",
    "start": "2310810",
    "end": "2317920"
  },
  {
    "text": "you can establish connection to a specific server by proxying your",
    "start": "2317920",
    "end": "2325300"
  },
  {
    "text": "requests across different relays usually three of them and those relays will have",
    "start": "2325300",
    "end": "2331270"
  },
  {
    "text": "their own layer of encryption part of the encryption they do is using SSL and",
    "start": "2331270",
    "end": "2337830"
  },
  {
    "text": "you should see it as an onion and each time you have different layer of encryption and you need to go to the",
    "start": "2337830",
    "end": "2344530"
  },
  {
    "text": "core the onion to be able to see the data well towards affected too",
    "start": "2344530",
    "end": "2350630"
  },
  {
    "text": "what are the practical implications of that well the PFS interval used to be",
    "start": "2350630",
    "end": "2359049"
  },
  {
    "text": "our fan tour is very paranoid it uses defensive coding they are not actually",
    "start": "2359049",
    "end": "2366019"
  },
  {
    "text": "using long-term certificates like a standard HTTP server they're rotating",
    "start": "2366019",
    "end": "2371170"
  },
  {
    "text": "certificates every two hours every two hours at all relay will change its",
    "start": "2371170",
    "end": "2376789"
  },
  {
    "text": "long-term keying material this is more paranoia than anything else but this is",
    "start": "2376789",
    "end": "2381829"
  },
  {
    "text": "what they do and that means that your bffs interval is two hours unless there",
    "start": "2381829",
    "end": "2390200"
  },
  {
    "text": "is an active attack is there isn't an active attack you can actually keep the circuit open you can connect the relay",
    "start": "2390200",
    "end": "2397819"
  },
  {
    "text": "open circuit and that will hold that will force a relay to retain the key",
    "start": "2397819",
    "end": "2403490"
  },
  {
    "text": "material in memory what does it do here they to ref counting they don't want",
    "start": "2403490",
    "end": "2409460"
  },
  {
    "text": "every two hour to kill every single session which is active on the server so",
    "start": "2409460",
    "end": "2414730"
  },
  {
    "text": "in order not to keep it if there is still a session which is connected and associated to it they don't teach the",
    "start": "2414730",
    "end": "2420980"
  },
  {
    "text": "key material make sense but that leads",
    "start": "2420980",
    "end": "2426319"
  },
  {
    "text": "to a practical attack where the relays and the list of relays is actually",
    "start": "2426319",
    "end": "2432170"
  },
  {
    "text": "public so if you plan on staging an attack against or what you used to be",
    "start": "2432170",
    "end": "2438109"
  },
  {
    "text": "able to do is connect to all the relays you plan on busting establish a session",
    "start": "2438109",
    "end": "2444170"
  },
  {
    "text": "to them and a new session every two hours and eventually bust a relay",
    "start": "2444170",
    "end": "2450859"
  },
  {
    "text": "operator and do some foreign chicks and what that allows you to do is to recover",
    "start": "2450859",
    "end": "2455869"
  },
  {
    "text": "the plaintext out of every single transaction which has ever been made to",
    "start": "2455869",
    "end": "2461779"
  },
  {
    "text": "it so let me rewind a bit here because i'm not sure everyone understood what",
    "start": "2461779",
    "end": "2467000"
  },
  {
    "text": "I'm talking about so you've got those relays which handle many connections from different clients and the attack",
    "start": "2467000",
    "end": "2474289"
  },
  {
    "text": "involves you're establishing a new session which is completely unrelated to the others but the fact that you've",
    "start": "2474289",
    "end": "2479569"
  },
  {
    "text": "established that session will force the relay to retain key material memory and if you are to bust your",
    "start": "2479569",
    "end": "2486220"
  },
  {
    "text": "parrot or afterwards you can decrypt every single session including the ones you haven't initiated because the server",
    "start": "2486220",
    "end": "2494320"
  },
  {
    "text": "has retained the key material you've just busted forward secrecy one layer of",
    "start": "2494320",
    "end": "2502120"
  },
  {
    "text": "the onion is gone two to go if you do that on enough relays and you bust a significant portion of the network well",
    "start": "2502120",
    "end": "2508530"
  },
  {
    "text": "you will actually recover and do very advanced traffic analysis this has been",
    "start": "2508530",
    "end": "2517450"
  },
  {
    "text": "fixed by the way around the year-ago think so this is I suspect the part",
    "start": "2517450",
    "end": "2527530"
  },
  {
    "text": "everyone was waiting for really when i submitted to talk this no one was talking about it and i really failed at",
    "start": "2527530",
    "end": "2534010"
  },
  {
    "text": "finding a use case or something i could use to convince you people that these matters well I've been given the perfect",
    "start": "2534010",
    "end": "2542220"
  },
  {
    "text": "perfect example so this is a very bad",
    "start": "2542220",
    "end": "2549880"
  },
  {
    "text": "slide where I'm trying to explain who is actually using session tickets so you",
    "start": "2549880",
    "end": "2556060"
  },
  {
    "text": "can see the name of a few websites and then you can see me attempting at resuming the sessions from different IP",
    "start": "2556060",
    "end": "2563890"
  },
  {
    "text": "addresses on those services I'm not",
    "start": "2563890",
    "end": "2569020"
  },
  {
    "text": "completely snowed today it has changed another Twitter or fix their stuff but what I'm trying to show here is that",
    "start": "2569020",
    "end": "2575500"
  },
  {
    "text": "there is very few people who actually use TLS session tickets properly there",
    "start": "2575500",
    "end": "2581860"
  },
  {
    "text": "is two mechanisms for resuming session there is a legacy session IDs and there is a session tickets well in most cases",
    "start": "2581860",
    "end": "2588190"
  },
  {
    "text": "people screwed up people consider a shared session cache but they don't configure our shared session key for the",
    "start": "2588190",
    "end": "2594880"
  },
  {
    "text": "tickets or they do the opposite the bottom line is it hardly ever works and",
    "start": "2594880",
    "end": "2600960"
  },
  {
    "text": "the few cases where it does work it's more luck than anything else is because the load balancer to use is doing sticky",
    "start": "2600960",
    "end": "2607630"
  },
  {
    "text": "session Association something like that and that just magically makes a work so",
    "start": "2607630",
    "end": "2615270"
  },
  {
    "text": "what I'm trying to introduce here is that unless you're Facebook of Google",
    "start": "2615270",
    "end": "2620339"
  },
  {
    "text": "you probably don't have a use case for TLS session tickets the other session",
    "start": "2620339",
    "end": "2626140"
  },
  {
    "text": "tickets were intended for low memory embedded type of devices ending a very",
    "start": "2626140",
    "end": "2631960"
  },
  {
    "text": "large amount of clients and connections well I've got news to break I mean if",
    "start": "2631960",
    "end": "2638859"
  },
  {
    "text": "you were handling a large amount of connections you usually don't use a device which is M bday then limited in",
    "start": "2638859",
    "end": "2647619"
  },
  {
    "text": "memory memory is cheap so the rest of",
    "start": "2647619",
    "end": "2656800"
  },
  {
    "text": "the talk and the tool I'm going to release all about how can you get the",
    "start": "2656800",
    "end": "2662440"
  },
  {
    "text": "key material to decrypt those tickets because having it would be very",
    "start": "2662440",
    "end": "2667500"
  },
  {
    "text": "comfortable in a case of prison can you think about it I mean doing ssl",
    "start": "2667500",
    "end": "2673540"
  },
  {
    "text": "interception active SSL termination that's actually expensive because each time you want to introduce and and see a",
    "start": "2673540",
    "end": "2682359"
  },
  {
    "text": "sessions rib you will have to do SSL termination that means to and shakes one on each side you really don't want to be",
    "start": "2682359",
    "end": "2689770"
  },
  {
    "text": "doing that well here that means you can almost decrypt our water speed what is",
    "start": "2689770",
    "end": "2695200"
  },
  {
    "text": "coming through so I'm doing a bit more conjectures about prism and how in my",
    "start": "2695200",
    "end": "2701980"
  },
  {
    "text": "work and the home might be improved I've seen the keynote from the general saying that we were welcomed and even invited",
    "start": "2701980",
    "end": "2713369"
  },
  {
    "text": "contributing ideas on how to improve it well if you're not using that you might want to consider using that you should",
    "start": "2713369",
    "end": "2722250"
  },
  {
    "text": "to improve performance you can be using this stuff so how do you get your hands",
    "start": "2722250",
    "end": "2728560"
  },
  {
    "text": "on the ticket and the key of the tickets I've made different scenarios I'll I'm running low on time so off to rush it",
    "start": "2728560",
    "end": "2734740"
  },
  {
    "text": "through a bit how would someone go about",
    "start": "2734740",
    "end": "2740579"
  },
  {
    "text": "stealing the secret used to encrypt the tickets it really depends on who you are",
    "start": "2740579",
    "end": "2745960"
  },
  {
    "text": "and what your capabilities if you're a government agency you ask",
    "start": "2745960",
    "end": "2751630"
  },
  {
    "text": "politely the way of doing that nowadays are other these call national security letters and should your request be",
    "start": "2751630",
    "end": "2759400"
  },
  {
    "text": "politely decline you you've got also tools you know you've got prisms and magic googles and whatnot men and I'm",
    "start": "2759400",
    "end": "2766900"
  },
  {
    "text": "sure that will give you the key magically now if you're not a government agency because I understand that not",
    "start": "2766900",
    "end": "2772780"
  },
  {
    "text": "everyone in the room here today is a government agency what you can do is ask",
    "start": "2772780",
    "end": "2778930"
  },
  {
    "text": "one of your maid for these useless remote memory disclosure bugs odds are",
    "start": "2778930",
    "end": "2784930"
  },
  {
    "text": "he's got plenty and the reason it's got plenty is because these bugs are usually",
    "start": "2784930",
    "end": "2789940"
  },
  {
    "text": "categorized as non exportable by security teams and it's pretty much a must-have if you want to do an export",
    "start": "2789940",
    "end": "2796750"
  },
  {
    "text": "where you do code execution because all the memory anti-corruption mitigation",
    "start": "2796750",
    "end": "2803740"
  },
  {
    "text": "anti exploitation mitigation technologies nowaday reply on introducing alia and unpredictability so",
    "start": "2803740",
    "end": "2813099"
  },
  {
    "text": "you really usually need to bug nowaday to exploit and something properly in one",
    "start": "2813099",
    "end": "2818619"
  },
  {
    "text": "bug which tries to help you line up the planets properly and you need one bug",
    "start": "2818619",
    "end": "2823839"
  },
  {
    "text": "which helps you get your root shell here",
    "start": "2823839",
    "end": "2830049"
  },
  {
    "text": "is a small cool example from cv details showing how hard it can possibly be to",
    "start": "2830049",
    "end": "2836920"
  },
  {
    "text": "have one of those bucks well we can't see very well here but what it says is that resume in there is different",
    "start": "2836920",
    "end": "2846760"
  },
  {
    "text": "columns and this is just for openssl the average program nowadays is linked against much more libraries and just",
    "start": "2846760",
    "end": "2853180"
  },
  {
    "text": "open SSL but let's look at openssl itself all the columns which say code",
    "start": "2853180",
    "end": "2858309"
  },
  {
    "text": "execution that means remote memory disclosure in any case overflow that",
    "start": "2858309",
    "end": "2863890"
  },
  {
    "text": "usually is type of bug that you can also abuse to remotely disclose memory same",
    "start": "2863890",
    "end": "2872230"
  },
  {
    "text": "thing about this column the bottom line is that there is plenty of bugs and there is no shortage of bugs which allow",
    "start": "2872230",
    "end": "2877630"
  },
  {
    "text": "you to do that and if you don't have made doing expert a you must be law enforcement law",
    "start": "2877630",
    "end": "2884290"
  },
  {
    "text": "enforcement doesn't have any friends doing that kind of things right so for",
    "start": "2884290",
    "end": "2889630"
  },
  {
    "text": "them this is what my tool does they are usually the guys doing forensic work and",
    "start": "2889630",
    "end": "2895589"
  },
  {
    "text": "my tool is about assisting you to recover the key from a forensic image so",
    "start": "2895589",
    "end": "2903010"
  },
  {
    "text": "without any further delay I'll go through the demo I don't actually have much time so i hope it will work the",
    "start": "2903010",
    "end": "2911260"
  },
  {
    "text": "demo is not the important part of the talk i'm here to raise awareness today so here's what the demo is supposed to",
    "start": "2911260",
    "end": "2916569"
  },
  {
    "text": "be doing in case i don't have time to finish it i'm using an abusing ptrace but really you don't have to use ptrace",
    "start": "2916569",
    "end": "2922869"
  },
  {
    "text": "to extract the master encryption key from memory and then decrypting the",
    "start": "2922869",
    "end": "2930130"
  },
  {
    "text": "session tickets sent over the wire using the key I've just recovered from memory and then using that I'm feeling that to",
    "start": "2930130",
    "end": "2937810"
  },
  {
    "text": "war shock and unrecovered the plain text",
    "start": "2937810",
    "end": "2942329"
  },
  {
    "text": "so let's make a small demo or I'll actually an art on so I'll replay",
    "start": "2943290",
    "end": "2948700"
  },
  {
    "text": "whatever I've already done so to capture",
    "start": "2948700",
    "end": "2955030"
  },
  {
    "text": "a dump and an image usually you just look at the PID of the process and I use",
    "start": "2955030",
    "end": "2962230"
  },
  {
    "text": "an existing tool which is called a stack and you give it a PID and you give it a",
    "start": "2962230",
    "end": "2968050"
  },
  {
    "text": "file name and it dumps the memory of the process right and it dumps the memory of",
    "start": "2968050",
    "end": "2980710"
  },
  {
    "text": "the process into a directory if you look",
    "start": "2980710",
    "end": "2986589"
  },
  {
    "text": "at the directory creates these memory addresses and there is a mappings file so if you enter it in the mapping file",
    "start": "2986589",
    "end": "2995380"
  },
  {
    "text": "it will tell you which page is map where in this case what you're interested is a heap because it turns out that the keys",
    "start": "2995380",
    "end": "3001980"
  },
  {
    "text": "are actually stored on the heap so if you go through it you just do something like that and if you look for the key",
    "start": "3001980",
    "end": "3015680"
  },
  {
    "text": "right that never works on the first try",
    "start": "3015680",
    "end": "3020780"
  },
  {
    "text": "okay well this is why I've got a tool so",
    "start": "3035990",
    "end": "3044579"
  },
  {
    "text": "I've written a small python script that",
    "start": "3044579",
    "end": "3050670"
  },
  {
    "text": "I'll release which allows you to do exactly that so you take a dump a memory dump you give it a ticket which in this",
    "start": "3050670",
    "end": "3058920"
  },
  {
    "text": "case I would have captured using wireshark and and you extract the key out of it and what the tool does is it",
    "start": "3058920",
    "end": "3068400"
  },
  {
    "text": "scans that memory dump it goes over all the files and when you find something which looks like NH mackay it tries to",
    "start": "3068400",
    "end": "3075060"
  },
  {
    "text": "validate it and whenever it validates it it peaks and extracts the keys make",
    "start": "3075060",
    "end": "3082410"
  },
  {
    "text": "sense",
    "start": "3082410",
    "end": "3084559"
  },
  {
    "text": "and I've got on all the tool which this time the Crips the tickets so you give",
    "start": "3090400",
    "end": "3099410"
  },
  {
    "text": "it the keys that you have just recovered these are the two keys and then you give it the ticket and you give it a memory",
    "start": "3099410",
    "end": "3106099"
  },
  {
    "text": "image sorry Adam actually and what you",
    "start": "3106099",
    "end": "3112369"
  },
  {
    "text": "creates for you is a while shop door decrypt file and that was shocked that the crib file contains the random",
    "start": "3112369",
    "end": "3120680"
  },
  {
    "text": "session ID which has been used by the client to establish a session and then the master key and that allows you to",
    "start": "3120680",
    "end": "3128180"
  },
  {
    "text": "recover the plaintext I don't have I unfortunately running low on time here I",
    "start": "3128180",
    "end": "3133190"
  },
  {
    "text": "don't have much time to go through it but I'll release a tool anyway so you",
    "start": "3133190",
    "end": "3139880"
  },
  {
    "text": "can play with it now even still it does so the conclusions on take away before you guys all live because this is the",
    "start": "3139880",
    "end": "3145940"
  },
  {
    "text": "important part of the talk is there is one thing you should remember is this is it if you're an auditor you should",
    "start": "3145940",
    "end": "3151700"
  },
  {
    "text": "really not focus on 128 bits of security because that's I mean anything above",
    "start": "3151700",
    "end": "3158359"
  },
  {
    "text": "that is just completely not served by what I've just talked about if you're a pen tester you should learn SSL and you",
    "start": "3158359",
    "end": "3164900"
  },
  {
    "text": "should learn how to abuse ssl morphin than not when I do an assessment I find",
    "start": "3164900",
    "end": "3170329"
  },
  {
    "text": "random devices somewhere in the middle in between what I'm trying to assess and my target well by abusing perfect",
    "start": "3170329",
    "end": "3177950"
  },
  {
    "text": "forward secrecy and depending on Wizards device does termination or not you might be able to bypass completely a wife or",
    "start": "3177950",
    "end": "3184190"
  },
  {
    "text": "whatever is preventing you from working and if you are your end user you might want to disable session tickets so in",
    "start": "3184190",
    "end": "3192349"
  },
  {
    "text": "verb there is now settings for that and the reason there is setting to that is because I filled in a feature request to",
    "start": "3192349",
    "end": "3198559"
  },
  {
    "text": "do exactly that we're now you can negotiate perfect forward secrecy unable ciphers only and these there is a device",
    "start": "3198559",
    "end": "3204890"
  },
  {
    "text": "in the middle and it doesn't do as a cell termination then you will bypass it",
    "start": "3204890",
    "end": "3210349"
  },
  {
    "text": "all together if you're a user and use firefox there is an about settings",
    "start": "3210349",
    "end": "3216710"
  },
  {
    "text": "ticket option which allows you to set and to tell Firefox no I don't thank",
    "start": "3216710",
    "end": "3222830"
  },
  {
    "text": "I don't want session tickets please don't send me and shakes with session tickets these are my references and",
    "start": "3222830",
    "end": "3230660"
  },
  {
    "text": "where I borrowed a few nice pictures and benchmarks for from if you have any",
    "start": "3230660",
    "end": "3237890"
  },
  {
    "text": "questions",
    "start": "3237890",
    "end": "3240309"
  }
]