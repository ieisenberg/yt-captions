[
  {
    "start": "0",
    "end": "49000"
  },
  {
    "text": "my name is Mike Ryan I'm a security consultant with ISC partners and I'm",
    "start": "40",
    "end": "5279"
  },
  {
    "text": "here to talk to you about bluetooth smart the good the bad the ugly and the",
    "start": "5279",
    "end": "12519"
  },
  {
    "text": "fix so before we get into the technical aspects of the talk why even bother talking about bluetooth smart why",
    "start": "12519",
    "end": "18880"
  },
  {
    "text": "research this well in case you haven't been paying attention it's showing up",
    "start": "18880",
    "end": "24960"
  },
  {
    "text": "everywhere here's a small sampling of devices I found on the internet that use bluetooth smart",
    "start": "24960",
    "end": "30720"
  },
  {
    "text": "SM as you can see lots of devices use bluetooth smart some of them you",
    "start": "30720",
    "end": "36440"
  },
  {
    "text": "probably use every day some of them might even surprise you a little bit and",
    "start": "36440",
    "end": "42399"
  },
  {
    "text": "in case you've been living under a rock the last couple of weeks it's appearing",
    "start": "42399",
    "end": "47840"
  },
  {
    "text": "everywhere but don't let my anecdote convince you let's go by the",
    "start": "47840",
    "end": "53640"
  },
  {
    "start": "49000",
    "end": "49000"
  },
  {
    "text": "numbers from a press release by the Bluetooth special interest group first",
    "start": "53640",
    "end": "59239"
  },
  {
    "text": "half of 2013 there was 186% year-over-year growth in shipping",
    "start": "59239",
    "end": "64720"
  },
  {
    "text": "consumer devices 7 million devices in the first half of the Year this",
    "start": "64720",
    "end": "70720"
  },
  {
    "text": "technology has huge Market penetration another press release note",
    "start": "70720",
    "end": "75759"
  },
  {
    "text": "forcasts that bluetooth smart will lead market share in Wireless medical devices",
    "start": "75759",
    "end": "82280"
  },
  {
    "text": "Wireless medical devices what could possibly go wrong actually I got I was a little",
    "start": "82280",
    "end": "88640"
  },
  {
    "text": "curious so I looked up the the officially supported device list from the Bluetooth Sig and I found a blood",
    "start": "88640",
    "end": "94720"
  },
  {
    "text": "glucose monitor that makes me a little nervous so Bluetooth smarts here now is",
    "start": "94720",
    "end": "103040"
  },
  {
    "text": "probably in your pocket it's big it's the next big thing in low power consumer Wireless so it's definitely worth taking",
    "start": "103040",
    "end": "109880"
  },
  {
    "text": "a look at so without further Ado now that we're properly motivated let's get right into",
    "start": "109880",
    "end": "115200"
  },
  {
    "text": "it the good bluetooth smart and I start with this because it's",
    "start": "115200",
    "end": "120640"
  },
  {
    "text": "actually a pretty good protocol for what it is for low power consumer wireless",
    "start": "120640",
    "end": "125719"
  },
  {
    "text": "devices it does the job it it could be a lot worse so what exactly is bluetooth",
    "start": "125719",
    "end": "132400"
  },
  {
    "start": "130000",
    "end": "130000"
  },
  {
    "text": "smart anyway this is where it starts to get technical so buckle up bluetooth smart",
    "start": "132400",
    "end": "138519"
  },
  {
    "text": "is a new modulation and Link layer mode for low power devices as compared the",
    "start": "138519",
    "end": "144080"
  },
  {
    "text": "classic Bluetooth it's incompatible classic Bluetooth devices cannot communicate with bluetooth smart devices",
    "start": "144080",
    "end": "150440"
  },
  {
    "text": "and vice versa this is because at the F layer the physical layer and the link layer they're almost completely",
    "start": "150440",
    "end": "156560"
  },
  {
    "text": "different however higher level protocols were reused this is both really good from a design perspective and really",
    "start": "156560",
    "end": "162879"
  },
  {
    "text": "good from an analysis perspective because we can take advantage of existing tools for studying the",
    "start": "162879",
    "end": "169519"
  },
  {
    "text": "protocol it was introduced in 2010 as a part of the Bluetooth 4 4.0 spec that's",
    "start": "169519",
    "end": "175560"
  },
  {
    "text": "why sometimes you'll hear bluetooth smart incorrectly referred to as Bluetooth 4 that's not technically",
    "start": "175560",
    "end": "180840"
  },
  {
    "text": "accurate Bluetooth 4 is just the latest version of the spec it encompasses all",
    "start": "180840",
    "end": "186519"
  },
  {
    "text": "existing Bluetooth technology classic Bluetooth Bluetooth Al Bluetooth alternate Mac 5 and of course bluetooth",
    "start": "186519",
    "end": "193360"
  },
  {
    "text": "smart uh so bluetooth smart is actually a subset of Bluetooth 4 I'll also note that it used to be",
    "start": "193360",
    "end": "201159"
  },
  {
    "text": "referred to as Bluetooth low energy or btle that's still how I usually refer to it but for the sake of the talk I'm",
    "start": "201159",
    "end": "206879"
  },
  {
    "text": "going to try to stick to bluetooth smart if you hear me say Bluetooth low energy or btle uh it's all the same thing so I",
    "start": "206879",
    "end": "214159"
  },
  {
    "text": "apologize in advance this is what the protocol stack looks like starting at the bottom you've",
    "start": "214159",
    "end": "219760"
  },
  {
    "start": "216000",
    "end": "216000"
  },
  {
    "text": "got the F layer the link layer L2 cap the attribute protocol and Gat and I",
    "start": "219760",
    "end": "225239"
  },
  {
    "text": "will go into these one by one to just give you a complete breakdown of the protocol so at the bottom the file air",
    "start": "225239",
    "end": "232560"
  },
  {
    "text": "when a bluetooth smart device transmits what does it look like I what what does that even mean so when a device",
    "start": "232560",
    "end": "239280"
  },
  {
    "text": "transmits a radio chip on the device generates a small amount of modulated RF the",
    "start": "239280",
    "end": "244920"
  },
  {
    "text": "modulation used is gfsk gaussian frequency shift keying this is the same modulation used in classic Bluetooth but",
    "start": "244920",
    "end": "251400"
  },
  {
    "text": "it's used a little bit differently here they use a 250 khz offset and the data rate is 1 megabit per second so that's",
    "start": "251400",
    "end": "258320"
  },
  {
    "text": "part of why it's incompatible with classic Bluetooth uh but the main reason that it's incompatible with classic",
    "start": "258320",
    "end": "264680"
  },
  {
    "text": "Bluetooth is how it breaks up the Spectrum into individual channels bluetooth smart takes the 80 MHz wide",
    "start": "264680",
    "end": "271600"
  },
  {
    "text": "2.4 GHz Wireless Spectrum the same Spectrum used for 802.11 Wi-Fi and",
    "start": "271600",
    "end": "278000"
  },
  {
    "text": "classic Bluetooth and it breaks it up into 40 channels each channel is 1 MHz",
    "start": "278000",
    "end": "283280"
  },
  {
    "text": "wide but the center carriers of each channel are Space 2 MHz apart so you'll get a channel one MHz wide 1 MHz of",
    "start": "283280",
    "end": "290800"
  },
  {
    "text": "nothing another channel so on and so forth classic Bluetooth actually breaks up into 80 channels without any",
    "start": "290800",
    "end": "298000"
  },
  {
    "text": "gaps during connection the master and slave hop along these channels according to a predefined",
    "start": "298000",
    "end": "304880"
  },
  {
    "text": "Hopping pattern so this hopping pattern is way simpler than classic Bluetooth so",
    "start": "304880",
    "end": "310720"
  },
  {
    "text": "this these aspects alone make it physically incompatible with classic",
    "start": "310720",
    "end": "316280"
  },
  {
    "text": "Bluetooth the hopping sequence is pretty simple of the 40 data channels 37 sorry",
    "start": "316280",
    "end": "323120"
  },
  {
    "start": "317000",
    "end": "317000"
  },
  {
    "text": "of the 40 bluetooth smart channels 37 are devoted to data and the master and",
    "start": "323120",
    "end": "329000"
  },
  {
    "text": "the slave each hop along the all the data channels when they reach a channel they each transmit one packet first the",
    "start": "329000",
    "end": "336120"
  },
  {
    "text": "master transmits then the slave transmits then they hop to another channel the master transmits and the",
    "start": "336120",
    "end": "341919"
  },
  {
    "text": "slave transmits so on and so forth the way you determine the next channel is",
    "start": "341919",
    "end": "347160"
  },
  {
    "text": "you take your current Channel and you add a value to it called The Hop increment this is a value shared between the master and slave when the connection",
    "start": "347160",
    "end": "353800"
  },
  {
    "text": "is set up the so you take the current Channel add the Hop increment and modulo",
    "start": "353800",
    "end": "359039"
  },
  {
    "text": "37 so you'll see the hop The Hop sequence at the bottom of the slide you start on channel three Master transmits slave",
    "start": "359039",
    "end": "365759"
  },
  {
    "text": "transmits they wait a second hop to the next channel channel 10 Master transmits",
    "start": "365759",
    "end": "370800"
  },
  {
    "text": "slave transmits so on and so forth you reach Channel 31 you hop down to channel",
    "start": "370800",
    "end": "376160"
  },
  {
    "text": "one because 31 + 7 is the sorry I didn't mention the Hop increment is seven in",
    "start": "376160",
    "end": "381599"
  },
  {
    "text": "this so 31 + 7 is 38 mod 37 is 1 because",
    "start": "381599",
    "end": "387199"
  },
  {
    "text": "37 is prime every connection will visit all 37 data",
    "start": "387199",
    "end": "392400"
  },
  {
    "text": "channels so it sounds kind of complicated but it's a lot simpler than some other Wireless hopping",
    "start": "392400",
    "end": "400280"
  },
  {
    "text": "protocols that's pretty much the F layer in a nutshell moving up to the link layer this is what packets actually look",
    "start": "400280",
    "end": "407120"
  },
  {
    "text": "like over the air there's a an 8 bit Preamble which is just an alternating sequence of zeros and ones this allows",
    "start": "407120",
    "end": "414280"
  },
  {
    "text": "the receiving radio to synchronize to the transmission following that is a 3 2",
    "start": "414280",
    "end": "419759"
  },
  {
    "text": "bit value four octets four bytes long that's called the access address this",
    "start": "419759",
    "end": "425000"
  },
  {
    "text": "value is shared between the master and the slave when they start a connection the 32-bit access address allows the",
    "start": "425000",
    "end": "431919"
  },
  {
    "text": "receiver to identify packets that are a part of the current connection that it's interested in it helps filter out a lot",
    "start": "431919",
    "end": "437280"
  },
  {
    "text": "of false positives and lets the receiver say okay there's probably a packet coming right now after the access",
    "start": "437280",
    "end": "442759"
  },
  {
    "text": "address is the pdu the protocol data unit that's the actual data that's being",
    "start": "442759",
    "end": "448160"
  },
  {
    "text": "transmitted wirelessly by bluetooth smart it has a minimum length of two octets because there's always a 2 byte",
    "start": "448160",
    "end": "455160"
  },
  {
    "text": "header at the beginning the header includes a logical link ID which helps differentiate between control and data",
    "start": "455160",
    "end": "461280"
  },
  {
    "text": "packets and a length field because the pdu is variable length at the end of the",
    "start": "461280",
    "end": "468280"
  },
  {
    "text": "packet is a CRC it's a little bit different from a typical CRC but in principle it's the same it allows you to",
    "start": "468280",
    "end": "473639"
  },
  {
    "text": "verify whether any bits have been flipped in the data right above the link layer is L2",
    "start": "473639",
    "end": "480080"
  },
  {
    "text": "cap L2 cap is borrowed from older Bluetooth standards in this case it's pretty much just bloat because uh you",
    "start": "480080",
    "end": "487759"
  },
  {
    "text": "see there's a 16-bit channel ID there that's used in classic Bluetooth to differentiate which service is actually",
    "start": "487759",
    "end": "494479"
  },
  {
    "text": "being used you've got rfom and sdp for audio headsets and things like that the",
    "start": "494479",
    "end": "500599"
  },
  {
    "text": "channel ID is how you identify which one is being transmitted in bluetooth smart",
    "start": "500599",
    "end": "505680"
  },
  {
    "text": "there's only one value that's legal for the channel ID that's the attribute protocol and there's a redundant length field so",
    "start": "505680",
    "end": "512800"
  },
  {
    "text": "in this case it's bloat but for the sake of building a a Bluetooth chip and for",
    "start": "512800",
    "end": "519279"
  },
  {
    "text": "the sake of analyzing stuff it's not that big a deal it's only four bytes and then following that's the",
    "start": "519279",
    "end": "524920"
  },
  {
    "text": "actual information payload so right on top of L2 cap is the",
    "start": "524920",
    "end": "530560"
  },
  {
    "text": "attribute protocol and on top of that is Gap so I've spent a lot of time with my nose in the spec I can't really tell you",
    "start": "530560",
    "end": "536880"
  },
  {
    "text": "where at ends and Gat begins so I'm going to talk about them at the same time give me a second",
    "start": "536880",
    "end": "544680"
  },
  {
    "text": "here so Gat is the protocol that is basically the application layer this is",
    "start": "546160",
    "end": "552360"
  },
  {
    "text": "where we finally get to the point where we exchange meaningful data values that an end user cares about everything is",
    "start": "552360",
    "end": "558920"
  },
  {
    "text": "defined in terms of services and characteristics a device has one or more services that run on it and each service",
    "start": "558920",
    "end": "565600"
  },
  {
    "text": "is made up by a group of characteristic uh characteristics and each characteristic has simple operations on",
    "start": "565600",
    "end": "571399"
  },
  {
    "text": "it such as perhaps it's able to be read or written to or there are other",
    "start": "571399",
    "end": "576519"
  },
  {
    "text": "operations that I'll describe it a little bit everything here is defi identified by a uu ID a 128bit value",
    "start": "576519",
    "end": "583560"
  },
  {
    "text": "that's unique to each service in characteristic in some circumstances you can shorten it to 16 bits but they're",
    "start": "583560",
    "end": "590360"
  },
  {
    "text": "always expandable to 128 bits so here's an example of a gat",
    "start": "590360",
    "end": "596240"
  },
  {
    "start": "594000",
    "end": "594000"
  },
  {
    "text": "service that's implemented in production devices right now the heart rate service implemented by heart rate monitors and",
    "start": "596240",
    "end": "602000"
  },
  {
    "text": "certain wristbands that have heart rate monitors built in the service uu ID 16 bit uh yeah 16 bits 18 OD and there are",
    "start": "602000",
    "end": "610600"
  },
  {
    "text": "two characteristics of Interest the first characteristic 2 a37 is the heart",
    "start": "610600",
    "end": "616279"
  },
  {
    "text": "rate you can't read or write this you would think you might be able to read it but uh actually they just don't they",
    "start": "616279",
    "end": "621920"
  },
  {
    "text": "don't support that instead they support notify where you subscribe to updates when you connect to the device you tell",
    "start": "621920",
    "end": "628000"
  },
  {
    "text": "it hey let me know any time there are updates to the heart rate and the the",
    "start": "628000",
    "end": "633959"
  },
  {
    "text": "slave device your heart rate sensor will get back to you periodically with oh the heart rate is 60 beats per minute the",
    "start": "633959",
    "end": "639160"
  },
  {
    "text": "heart rate is 62 beats per minute pretty decent from a design perspective the second characteristic is",
    "start": "639160",
    "end": "646160"
  },
  {
    "text": "a sensor location 2838 and this is a readable value it's just an 8bit integer then there a",
    "start": "646160",
    "end": "652399"
  },
  {
    "text": "standardized list of sensor locations on the body you've got chest uh wrist",
    "start": "652399",
    "end": "657519"
  },
  {
    "text": "earlobe whoo and there are a couple other characteristics that are used for",
    "start": "657519",
    "end": "662639"
  },
  {
    "text": "bookkeeping uh it's uh Gad is a self-describing protocol so it's uh",
    "start": "662639",
    "end": "667839"
  },
  {
    "text": "actually pretty pretty handy so if you connect to a device and it's a friendly device it can actually give you a description of every characteristic so",
    "start": "667839",
    "end": "675480"
  },
  {
    "text": "you might connect to an unknown device and see a characteristic you can't identify by uu ID well if you read",
    "start": "675480",
    "end": "681200"
  },
  {
    "text": "another characteristic it'll tell you this is a temperature or this is humidity so it's Gat is a pretty cool",
    "start": "681200",
    "end": "688240"
  },
  {
    "text": "protocol so to recap that's the whole bluetooth smart staff starting at the file layer",
    "start": "688240",
    "end": "695120"
  },
  {
    "text": "where you've got uh simple channels and hopping moving up to the link layer where you've got a CRC and a pdu and",
    "start": "695120",
    "end": "701560"
  },
  {
    "text": "some access address basically radio stuff for remote devices to be able to pick out signals and the noise above",
    "start": "701560",
    "end": "707680"
  },
  {
    "text": "that you've got L2 cap which is kind of a waste and then finally the attribute protocol and Gat which are user",
    "start": "707680",
    "end": "716680"
  },
  {
    "text": "data but I don't know about you guys it's pretty boring just to hear a rote description of a protocol I'd much",
    "start": "716680",
    "end": "723200"
  },
  {
    "text": "rather look at it as it's flying over the air I want to sniff",
    "start": "723200",
    "end": "728560"
  },
  {
    "text": "it but sniffing Bluetooth is hard Mike Osman has been telling us this for many",
    "start": "728560",
    "end": "734000"
  },
  {
    "text": "years part of the reason is conventional Bluetooth dongles don't have a monitor",
    "start": "734000",
    "end": "739399"
  },
  {
    "text": "mode like 802.11 Wi-Fi dongles do you can't just say give me every packet",
    "start": "739399",
    "end": "746360"
  },
  {
    "text": "that's flying through the air so I can analyze it instead have to build custom",
    "start": "746360",
    "end": "751760"
  },
  {
    "text": "Hardware uh so stiffing Bluetooth is hard but Mike was talking about classic Bluetooth when he made this slide",
    "start": "751760",
    "end": "759279"
  },
  {
    "text": "luckily sniffing Bluetooth LE or bluetooth smart is a lot simpler so I'll tell you how I did",
    "start": "759279",
    "end": "766120"
  },
  {
    "text": "that pretty simple you start at the bottom and you work your way up you start at the file layer and the",
    "start": "766120",
    "end": "772680"
  },
  {
    "text": "link layer these are unique to bluetooth smart and uh these this is what you",
    "start": "772680",
    "end": "777959"
  },
  {
    "text": "actually need custom Hardware to sniff so I used an ubertooth to get at these",
    "start": "777959",
    "end": "784240"
  },
  {
    "text": "layers and finally after I got the the link layer packet I can hand it up to",
    "start": "784240",
    "end": "789480"
  },
  {
    "text": "the PC where we've already got tools for dealing with L2 cap attribute protocol and",
    "start": "789480",
    "end": "795600"
  },
  {
    "text": "Gat so if you haven't seen it before this is an ubertooth I'm sure it's hard to see from the back I've got a simple",
    "start": "795600",
    "end": "802440"
  },
  {
    "start": "796000",
    "end": "796000"
  },
  {
    "text": "block diagram on the side uh on the left you've got an RF amplifier connected to",
    "start": "802440",
    "end": "807519"
  },
  {
    "text": "an antenna and and that's connected to a cc 2400 reconfigurable radio chip the",
    "start": "807519",
    "end": "814160"
  },
  {
    "text": "they the amplifier and the radio chip just uh communicate via RF we configure the radio chip to use",
    "start": "814160",
    "end": "821639"
  },
  {
    "text": "modulation parameters same as uh the same modulation parameters as bluetooth smart that handles the F A for us that",
    "start": "821639",
    "end": "828880"
  },
  {
    "text": "converts the RF which is just analog signals into bits bits we can deal with",
    "start": "828880",
    "end": "835839"
  },
  {
    "text": "then connected to the 2400 is an LPC 1750 series arm microcontroller that's where we handle",
    "start": "835839",
    "end": "842440"
  },
  {
    "text": "the link layer that converts the bits into packets finally that's connected to",
    "start": "842440",
    "end": "847519"
  },
  {
    "text": "the USB on the PC and that just ships the packets up to the PC for later",
    "start": "847519",
    "end": "853480"
  },
  {
    "text": "analysis so at the file air the way we capture packets is we configure the CC",
    "start": "853480",
    "end": "858600"
  },
  {
    "text": "2400 to be in gfsk mode 250 khz offset uh 1 megabit per second and we tune it",
    "start": "858600",
    "end": "865440"
  },
  {
    "text": "to the proper Channel we know the proper Channel because um I already told you about the link layer and hopping the LPC",
    "start": "865440",
    "end": "871000"
  },
  {
    "text": "tells us that we just follow the connections according to the hop pattern this",
    "start": "871000",
    "end": "876560"
  },
  {
    "text": "depends on two values The Hop increment and the Hop interval uh we get these either by witnessing the connect packet",
    "start": "876560",
    "end": "882320"
  },
  {
    "text": "or we've got a promiscuous mode that can recover them after the fact and that's it that just gives that",
    "start": "882320",
    "end": "889000"
  },
  {
    "text": "gives us bits and the our microcontroller deals with the bits that brings us up to the link layer",
    "start": "889000",
    "end": "897440"
  },
  {
    "text": "but we've got a small problem everything in the link layer is defined in terms of octets but we don't have octets we have",
    "start": "897440",
    "end": "904040"
  },
  {
    "text": "bits we don't know where one octet one bite begins and the next ends so we have a c of bits we want the",
    "start": "904040",
    "end": "912040"
  },
  {
    "text": "start of the pdu we want to know where the octet boundary is more abstractly however we do know the access",
    "start": "912040",
    "end": "918000"
  },
  {
    "text": "address suppose we got it from the connect packet so what we do is we've",
    "start": "918000",
    "end": "923199"
  },
  {
    "text": "got this sea of bits flowing in and we start searching for the 32-bit access address and when we see it it hey",
    "start": "923199",
    "end": "930199"
  },
  {
    "text": "there's the end of our access address and immediately following that is our pdu and it's that simple that's how we",
    "start": "930199",
    "end": "936959"
  },
  {
    "text": "go from bits to the pdu boundary and we can deal with the octet data according",
    "start": "936959",
    "end": "944240"
  },
  {
    "text": "to the spec this is actually the old way of doing it the new way of doing it is",
    "start": "944240",
    "end": "950560"
  },
  {
    "text": "we configure the CC 2400 to look for that 32-bit access address and just give us data when it sees that that's a real",
    "start": "950560",
    "end": "957360"
  },
  {
    "text": "that's a big win for us because we don't have to constantly watch a bitstream as it's flowing in and the CC 2400 does a",
    "start": "957360",
    "end": "965480"
  },
  {
    "text": "lot of fancy stuff to detect that 32-bit value way smarter stuff than we can do in the arm microcontroller so this",
    "start": "965480",
    "end": "971920"
  },
  {
    "text": "brings our packet reception rate up from 60% or so up to like 99% so that's that's a major Improvement",
    "start": "971920",
    "end": "979519"
  },
  {
    "text": "that we've seen in recent weeks so we've got the F layer we've got",
    "start": "979519",
    "end": "985040"
  },
  {
    "start": "983000",
    "end": "983000"
  },
  {
    "text": "the link layer these are the parts that are unique to bluetooth smart now we can pass up the packets to the PC",
    "start": "985040",
    "end": "992240"
  },
  {
    "text": "where we've already got tools for dealing with L2 cap the attribute protocol and Gat in fact wi shark has",
    "start": "992240",
    "end": "1000600"
  },
  {
    "text": "dissectors for these protocols at the top of the list you see BT at the Bluetooth attribute protocol and at the",
    "start": "1000600",
    "end": "1006480"
  },
  {
    "text": "bottom we've got L2 cap I don't want to write parsers for these I want to let somebody else handle that so I'll pass",
    "start": "1006480",
    "end": "1012759"
  },
  {
    "text": "them up to wire shark so wi shark speaks peap ubertooth BTL the command line",
    "start": "1012759",
    "end": "1019959"
  },
  {
    "text": "utility that we use to communicate with the ubertooth speaks packets so all we do is we take lib peap and we dump the",
    "start": "1019959",
    "end": "1027319"
  },
  {
    "text": "raw packet data into packets we slap a PPI header on it the way aerody dump NG and Kismet do for non- ethernet packets",
    "start": "1027319",
    "end": "1035360"
  },
  {
    "text": "and that's it we dump them out we actually recently just got a DLT for bluetooth smart that's a unique",
    "start": "1035360",
    "end": "1041438"
  },
  {
    "text": "identifier for the protocol every protocol that lib pcap supports has a DLT so this means that we can finally",
    "start": "1041439",
    "end": "1047839"
  },
  {
    "text": "make a public release of our wire shark plugins very soon we also have one for classic Bluetooth so pretty soon wire",
    "start": "1047839",
    "end": "1054600"
  },
  {
    "text": "shark's going to have great support for Bluetooth native bluetooth smart and classic Bluetooth sniffed with",
    "start": "1054600",
    "end": "1060160"
  },
  {
    "text": "ubertooth here's a couple of screenshots of it in action on the left I'm making a",
    "start": "1060160",
    "end": "1065400"
  },
  {
    "start": "1061000",
    "end": "1061000"
  },
  {
    "text": "request to a device asking for its device name it's probably pretty hard to see but it's that highlighted field at",
    "start": "1065400",
    "end": "1071160"
  },
  {
    "text": "the bottom of the wire shark breakdown and on the right there's the response",
    "start": "1071160",
    "end": "1076200"
  },
  {
    "text": "coming from the device telling us its name and these packets were sniffed over the air using ubertooth using the the",
    "start": "1076200",
    "end": "1083320"
  },
  {
    "text": "firmware I designed and the wire shark plugins that I've built and of course",
    "start": "1083320",
    "end": "1088480"
  },
  {
    "text": "this is all open source but I'll get to that at the end and a last note before we move on",
    "start": "1088480",
    "end": "1094960"
  },
  {
    "text": "there is encryption provided by the link layer and it only covers the protocol",
    "start": "1094960",
    "end": "1100799"
  },
  {
    "text": "data unit you have to have the access address in clear text so the radio can identify the start of the packet and it",
    "start": "1100799",
    "end": "1107799"
  },
  {
    "text": "encrypts it and also authenticates it using ascm there's really not a whole lot to",
    "start": "1107799",
    "end": "1113400"
  },
  {
    "text": "say about this encryption because it's pretty good ascm doesn't have any known",
    "start": "1113400",
    "end": "1119440"
  },
  {
    "text": "weaknesses unfortunately that brings us to the bad the key",
    "start": "1119440",
    "end": "1127080"
  },
  {
    "text": "exchange bluetooth smart uses a custom key exchange protocol seems like a poor",
    "start": "1133520",
    "end": "1139600"
  },
  {
    "start": "1135000",
    "end": "1135000"
  },
  {
    "text": "choice given that there are some thoroughly well vetted key exchange protocols that don't have any weaknesses",
    "start": "1139600",
    "end": "1146360"
  },
  {
    "text": "so it's a three-stage process the first stage you exchange you um there's a",
    "start": "1146360",
    "end": "1152919"
  },
  {
    "text": "temporary key that's used to encrypt a the few first few messages that go over the wire in the first stage you",
    "start": "1152919",
    "end": "1159799"
  },
  {
    "text": "calculate a confirm value to make sure that you're using the same temporary key and you've established the same random",
    "start": "1159799",
    "end": "1165159"
  },
  {
    "text": "numbers that are used later in the process the second and third stages are just just exchanging a short-term and a long-term key the first stage is where",
    "start": "1165159",
    "end": "1173880"
  },
  {
    "text": "the problem is the first stage is the temporary key is determined by the pairing method there are three pairing",
    "start": "1173880",
    "end": "1179640"
  },
  {
    "text": "methods just works that just sounds like a bad idea six-digit pin and outof band",
    "start": "1179640",
    "end": "1188480"
  },
  {
    "text": "pairing here's a quote from the spec none of the pairing methods provide protection against a passive e",
    "start": "1188480",
    "end": "1195600"
  },
  {
    "text": "dropper say what that's right none of the pairing methods",
    "start": "1195600",
    "end": "1201640"
  },
  {
    "text": "provide protection against a passive eavesdropper the spec does go on to say a future version of this specification",
    "start": "1201640",
    "end": "1208400"
  },
  {
    "text": "will include elliptic curve cryptography but the current version",
    "start": "1208400",
    "end": "1214280"
  },
  {
    "text": "doesn't so they knew it was broken when they released it uh I'm going to go ahead and",
    "start": "1214400",
    "end": "1221840"
  },
  {
    "text": "demonstrate how broken it is so the when the devices begin pairing",
    "start": "1221840",
    "end": "1227640"
  },
  {
    "text": "they exchange a few value over the air in plain text these values are highlighted in",
    "start": "1227640",
    "end": "1232760"
  },
  {
    "text": "green here that confirm a random value that has Randomness from both devices P1 and P2 which are pretty unimportant we",
    "start": "1232760",
    "end": "1239559"
  },
  {
    "text": "have these if we sit by passively intercepting packets we can collect all",
    "start": "1239559",
    "end": "1245159"
  },
  {
    "text": "of this information the only thing we don't have is the TK the temporary",
    "start": "1245159",
    "end": "1251360"
  },
  {
    "text": "key we know something about the temporary key if you're using just works or a six-digit pin is an integer between",
    "start": "1251360",
    "end": "1259360"
  },
  {
    "text": "0 and 999 999 and if you're using just works it's",
    "start": "1259360",
    "end": "1264640"
  },
  {
    "text": "always zero yeah so it it's vulnerable to a simple",
    "start": "1264640",
    "end": "1272440"
  },
  {
    "text": "Brute Force you just try all all 1 million values and eventually you will crack the key anyone want to Hazard to",
    "start": "1272440",
    "end": "1279679"
  },
  {
    "text": "guess how long it takes to crack less than a second there's your Bluetooth SM key",
    "start": "1279679",
    "end": "1286559"
  },
  {
    "text": "exchange that's it when you have the temporary key you can recover the short-term key using the short-term key",
    "start": "1286559",
    "end": "1293320"
  },
  {
    "text": "you can decrypt the communications used to exchange the long-term key and finally the long-term key is used during",
    "start": "1293320",
    "end": "1300000"
  },
  {
    "text": "every connection to encrypt session Keys your key exchanges broken right from the",
    "start": "1300000",
    "end": "1306400"
  },
  {
    "text": "start and this is 100% passive attack you have you cannot know that this is",
    "start": "1306400",
    "end": "1313120"
  },
  {
    "text": "occurring the only way you can tell you're getting hacked is if you sit around at the coffee shop you look around and you see this guy",
    "start": "1313120",
    "end": "1320519"
  },
  {
    "text": "die and that rolls us right into the ugly the long-term key",
    "start": "1321840",
    "end": "1328640"
  },
  {
    "start": "1331000",
    "end": "1331000"
  },
  {
    "text": "reuse now face value this sounds like a good idea if you pair in a faraday cage",
    "start": "1331600",
    "end": "1337760"
  },
  {
    "text": "nobody can possibly observe your uh observe your key exchange and before you",
    "start": "1337760",
    "end": "1343480"
  },
  {
    "text": "laugh I have paired in a fair day cage however there's a mitigation for",
    "start": "1343480",
    "end": "1349559"
  },
  {
    "text": "this oh sorry I forgot to mention so every time the you after you've paired",
    "start": "1349559",
    "end": "1355039"
  },
  {
    "text": "every time you want to establish an encrypted session all you do is use a pre-established long-term key the master",
    "start": "1355039",
    "end": "1361679"
  },
  {
    "text": "tells the slave hey let's encrypt this using that long-term key we already exchanged so if an attacker doesn't",
    "start": "1361679",
    "end": "1367240"
  },
  {
    "text": "witness the long-term key exchange he can't decrypt the connection that's part of what makes AES CCM pretty",
    "start": "1367240",
    "end": "1374039"
  },
  {
    "text": "good but we do have a mitigation for that there's a simple active attack that",
    "start": "1374039",
    "end": "1379799"
  },
  {
    "text": "we can do to force the master ens slave to repair it really is simple you just need to know the MAC address of the",
    "start": "1379799",
    "end": "1386640"
  },
  {
    "text": "slave device uh a funny feature of bluetooth smart chips is that every chip",
    "start": "1386640",
    "end": "1391960"
  },
  {
    "text": "can be used as a master or a slave So Random device here can act as a master",
    "start": "1391960",
    "end": "1398400"
  },
  {
    "text": "my laptop can act as a slave so what you do is you change the MAC address of your",
    "start": "1398400",
    "end": "1403919"
  },
  {
    "text": "Bluetooth adapter on your laptop to match that of your slave you start a g server on your laptop Blues on Linux",
    "start": "1403919",
    "end": "1410919"
  },
  {
    "text": "handily has one and when the master goes to pair you just make sure your laptop",
    "start": "1410919",
    "end": "1416520"
  },
  {
    "text": "is louder than the device you wish to uh deair from the master the master says",
    "start": "1416520",
    "end": "1422679"
  },
  {
    "text": "hey let's use that long-term key you already established the your laptop says",
    "start": "1422679",
    "end": "1427960"
  },
  {
    "text": "yo I don't know anything about that key totally according to protocol and the master says okay let's reestablish a key",
    "start": "1427960",
    "end": "1434240"
  },
  {
    "text": "at that point you just turn off Bluetooth on your laptop Master gets a little bit confused used reconnects to",
    "start": "1434240",
    "end": "1439799"
  },
  {
    "text": "the slave and says hey let's reestablish a connection the slave goes sure whatever and then you passively can",
    "start": "1439799",
    "end": "1446480"
  },
  {
    "text": "intercept the communications again",
    "start": "1446480",
    "end": "1453200"
  },
  {
    "text": "so uh in either situation either you already know the long-term key or you",
    "start": "1453320",
    "end": "1460120"
  },
  {
    "text": "can force the master and slave to repair you will have the long-term key every",
    "start": "1460120",
    "end": "1465559"
  },
  {
    "text": "single connection used after that the master and decrypt it's a very simple procedure the attacker just passively",
    "start": "1465559",
    "end": "1472640"
  },
  {
    "text": "listens to the packets that you exchange he waits for you to establish a connection the first thing you're going",
    "start": "1472640",
    "end": "1478159"
  },
  {
    "text": "to do is start encryption and then the attacker passively listening to your connection collects this information and",
    "start": "1478159",
    "end": "1485720"
  },
  {
    "text": "has every piece of information he needs to decrypt your connection every subsequent connection you",
    "start": "1485720",
    "end": "1492880"
  },
  {
    "text": "make not only is it theoretically possible it's practically possible my tool crackled will do that as well if",
    "start": "1492880",
    "end": "1500720"
  },
  {
    "text": "you give it a pcap file that has the entire pairing setup it will crack the TK output the long-term key and decrypt",
    "start": "1500720",
    "end": "1508559"
  },
  {
    "text": "the rest of the pcap file if you give it a pcap file and you provide it with a long-term key so one that you've already",
    "start": "1508559",
    "end": "1515840"
  },
  {
    "text": "observed in the past it will decrypt that as well so to recap the key exchange is",
    "start": "1515840",
    "end": "1523279"
  },
  {
    "start": "1521000",
    "end": "1521000"
  },
  {
    "text": "broken and because they reuse the long-term key all future communication is effectively",
    "start": "1523279",
    "end": "1530240"
  },
  {
    "text": "compromised and this is 99% passive in the worst case scenario you do one",
    "start": "1530240",
    "end": "1535760"
  },
  {
    "text": "active attack with completely off the-shelf Hardware that most of you probably already",
    "start": "1535760",
    "end": "1541120"
  },
  {
    "text": "have all is not lost there is a simple fix to this problem secure simple",
    "start": "1541120",
    "end": "1548799"
  },
  {
    "text": "pairing before I get into that secure simple pairing is the pairing mechanism used in classic",
    "start": "1549320",
    "end": "1556000"
  },
  {
    "text": "Bluetooth I'm really not sure why they did just Define it for bluetooth smart",
    "start": "1556000",
    "end": "1561679"
  },
  {
    "text": "possibly because it's computationally intensive but it doesn't matter you only have to pair once and you can securely",
    "start": "1561679",
    "end": "1566720"
  },
  {
    "text": "establish a key that's reused many many times a word about my",
    "start": "1566720",
    "end": "1573640"
  },
  {
    "start": "1571000",
    "end": "1571000"
  },
  {
    "text": "qualifications I'm an infosec researcher I'm an infosec consultant with ISC Partners ISC",
    "start": "1573640",
    "end": "1581120"
  },
  {
    "text": "Partners is an information security consulting firm that specializes in web and mobile application test pen",
    "start": "1581120",
    "end": "1587240"
  },
  {
    "text": "testing I'm an occasional programmer a husband and I can grill a mean steak I'm",
    "start": "1587240",
    "end": "1593720"
  },
  {
    "text": "not a cryptographer that's why I suggested",
    "start": "1593720",
    "end": "1598799"
  },
  {
    "start": "1597000",
    "end": "1597000"
  },
  {
    "text": "using secure simple pairing if you're not a cryptographer don't build a crypto",
    "start": "1598799",
    "end": "1605320"
  },
  {
    "text": "system I'm going to repeat that if you get nothing from this talk remember this if you're not a cryptographer don't",
    "start": "1605320",
    "end": "1611799"
  },
  {
    "text": "build a crypto system you will get it wrong and people will laugh at you at",
    "start": "1611799",
    "end": "1617360"
  },
  {
    "text": "black hat next year here when they break your device so that's part of the reason I",
    "start": "1617360",
    "end": "1622880"
  },
  {
    "text": "chose secure simple pairing it's already a thoroughly well vetted crypto system",
    "start": "1622880",
    "end": "1628360"
  },
  {
    "text": "it's been in production since Bluetooth 2.1 that's 2007 and there's only one",
    "start": "1628360",
    "end": "1633600"
  },
  {
    "text": "known weakness and that weakness we can just work",
    "start": "1633600",
    "end": "1638759"
  },
  {
    "text": "around my mom likes to call it the worst times so there is passive e stopping",
    "start": "1639200",
    "end": "1644559"
  },
  {
    "text": "protection through the use of elliptic curv Diffy helmet the downside of that is that ecdh is pretty expensive uh",
    "start": "1644559",
    "end": "1653000"
  },
  {
    "text": "secure simple pairing is defined around the nist curve secp 192 R1 that means",
    "start": "1653000",
    "end": "1658679"
  },
  {
    "text": "you've got to do 192-bit multiplies a couple of them is pretty slow takes about 5 seconds on an 8bit CPU and up",
    "start": "1658679",
    "end": "1666559"
  },
  {
    "text": "until recently there was no open source implementation for 8bit CPUs that",
    "start": "1666559",
    "end": "1672919"
  },
  {
    "text": "is so there's five stages to SSP the first stage public key exchange the",
    "start": "1672919",
    "end": "1678200"
  },
  {
    "text": "master and slave just exchanged their public key points the second stage authentication the master and slave",
    "start": "1678200",
    "end": "1685080"
  },
  {
    "text": "actually do the ecdh calculation to verify that they are both using the same",
    "start": "1685080",
    "end": "1690799"
  },
  {
    "text": "ma there there's has not been a man in the- Middle attacker the third stage authentication is used to calculate a",
    "start": "1690799",
    "end": "1696480"
  },
  {
    "text": "confirm that allows them to verify that they're using the same random numbers link key calculation for determining a",
    "start": "1696480",
    "end": "1702720"
  },
  {
    "text": "link key and finally authentication and encryption so the last stage is not",
    "start": "1702720",
    "end": "1708200"
  },
  {
    "start": "1707000",
    "end": "1707000"
  },
  {
    "text": "relevant to us because we've already got our own encryption built into bluetooth smart and in the second phase that's",
    "start": "1708200",
    "end": "1714919"
  },
  {
    "text": "where they Define pairing the one vulnerability in Bluetooth uh in SSP is",
    "start": "1714919",
    "end": "1720120"
  },
  {
    "text": "that if you use pin entry it's vulnerable to having your PIN being",
    "start": "1720120",
    "end": "1725240"
  },
  {
    "text": "completely leaked so modern Bluetooth devices don't support it we don't support it either we only want to use",
    "start": "1725240",
    "end": "1730519"
  },
  {
    "text": "the numeric comparison mode and it's Backward Compatible this the spec actually",
    "start": "1730519",
    "end": "1737200"
  },
  {
    "start": "1734000",
    "end": "1734000"
  },
  {
    "text": "incorrectly notes that none of the pairing mechanisms in bluetooth smart provide uh passive eavesdropping",
    "start": "1737200",
    "end": "1743760"
  },
  {
    "text": "protection that's not actually to True out of band pairing is not",
    "start": "1743760",
    "end": "1749279"
  },
  {
    "text": "broken one I'll actually note that if you if you can actually exchange a 128bit value out of band you should do",
    "start": "1749279",
    "end": "1756720"
  },
  {
    "text": "that because it's a lot simpler than implementing SSP however if you can't do that you will use the calculated link",
    "start": "1756720",
    "end": "1763600"
  },
  {
    "text": "key from step four as 128 bits of outof band data and most chips actually have",
    "start": "1763600",
    "end": "1769360"
  },
  {
    "text": "support for this it's part of the spec you tell the chip hey use this 128bit value for out of band pairing the master",
    "start": "1769360",
    "end": "1775559"
  },
  {
    "text": "and the slave both have the same 128bit value because they both went through SSP together and then you go through pairing",
    "start": "1775559",
    "end": "1781679"
  },
  {
    "text": "as usual you get the full benefits of bluetooth smart encryption including having Gat support for characteristics",
    "start": "1781679",
    "end": "1788880"
  },
  {
    "text": "that can be read are only read when they're encrypted and you get the benefits of SSP with e dropping",
    "start": "1788880",
    "end": "1796399"
  },
  {
    "text": "protection so uh I'll do a couple demos right now let's see what we got here so I'm",
    "start": "1796399",
    "end": "1804399"
  },
  {
    "text": "using a development version of wire shark that has X cap support uh this is something that dragorn M Kershaw and I",
    "start": "1804399",
    "end": "1811120"
  },
  {
    "text": "were working on so you can actually see the Bluetooth ubertooth devices in wire shark here and I can configure it to be",
    "start": "1811120",
    "end": "1817360"
  },
  {
    "text": "on this particular channel so I'm going to fire up wi shark listening on my two Uber teeth hm somebody's out",
    "start": "1817360",
    "end": "1826919"
  },
  {
    "text": "there bluetooth smart capable smartphone I'm currently wearing a heart rate",
    "start": "1826960",
    "end": "1833080"
  },
  {
    "text": "monitor let me filter these I'll filter those in a second and I'm going to go ahead and",
    "start": "1833080",
    "end": "1839600"
  },
  {
    "text": "fire up the heart rate monitor application on my phone we've got a",
    "start": "1839600",
    "end": "1847799"
  },
  {
    "text": "connection and this data is being written from my phone captured over the",
    "start": "1848360",
    "end": "1855440"
  },
  {
    "text": "air using ubertooth and being displayed on the PC here this is a handle value notification",
    "start": "1855440",
    "end": "1863000"
  },
  {
    "text": "from the heart rate Service uh let me fire up xmag so you can actually see it",
    "start": "1863000",
    "end": "1869039"
  },
  {
    "text": "that 70 right there that's my heart rate from my smartphone to a heart rate",
    "start": "1869039",
    "end": "1877720"
  },
  {
    "text": "monitor via ubertooth so as you can see we have a very rich very capable sniffing",
    "start": "1877720",
    "end": "1885720"
  },
  {
    "text": "platform I will try one other thing now uh I'll show you the",
    "start": "1885720",
    "end": "1891840"
  },
  {
    "text": "encryption restart wire shark",
    "start": "1891840",
    "end": "1895880"
  },
  {
    "text": "here so uh before we transition that was my first demo you we can sniff passively",
    "start": "1897760",
    "end": "1904279"
  },
  {
    "text": "uh connections between bluetooth smart devices and uh as you'll note my smartphone does not use encryption when",
    "start": "1904279",
    "end": "1910480"
  },
  {
    "text": "it talks to my heart rate monitor anyone close enough can recover that",
    "start": "1910480",
    "end": "1915919"
  },
  {
    "text": "data moving on to the second demo start capturing again uh this time I'm going",
    "start": "1916840",
    "end": "1922840"
  },
  {
    "text": "to connect to the heart rate monitor from my laptop so I can actually show you the encryption setup so uh these",
    "start": "1922840",
    "end": "1929360"
  },
  {
    "text": "packets over here are the actual packets going by in the bottom right I'm connecting to it using a a blues tool so",
    "start": "1929360",
    "end": "1936519"
  },
  {
    "text": "I'll connect this this is the part where it doesn't work because I'm on stage I'll",
    "start": "1936519",
    "end": "1942080"
  },
  {
    "text": "give it a couple tries",
    "start": "1942080",
    "end": "1949080"
  },
  {
    "text": "I thought this might happen so I brought a rubber",
    "start": "1949080",
    "end": "1954360"
  },
  {
    "start": "1951000",
    "end": "1951000"
  },
  {
    "text": "chicken oh demo Gods be good to me",
    "start": "1956039",
    "end": "1962000"
  },
  {
    "text": "nope all right I'll give it a couple more tries",
    "start": "1962000",
    "end": "1969519"
  },
  {
    "text": "no okay well that doesn't appear to be working that's okay I actually did collect a sample uh a little bit earlier",
    "start": "1974519",
    "end": "1983720"
  },
  {
    "text": "when I wasn't standing on stage with a whole bunch of Wireless noise here is",
    "start": "1983720",
    "end": "1990960"
  },
  {
    "text": "some",
    "start": "1990960",
    "end": "1993960"
  },
  {
    "text": "oops here is a come on where is it here it is",
    "start": "2006760",
    "end": "2017279"
  },
  {
    "text": "so okay well it's not displaying properly in wire shark but I have a",
    "start": "2017880",
    "end": "2023399"
  },
  {
    "text": "complete pairing setup in this pcap file uh it's just the bluetooth smart pairing",
    "start": "2023399",
    "end": "2030480"
  },
  {
    "text": "where the master and the slave exchange the temporary key the long-term key the short-term key and the longterm key and",
    "start": "2030480",
    "end": "2036720"
  },
  {
    "text": "um I'm going to go ahead and uh decrypt this for you guys I've included a Time",
    "start": "2036720",
    "end": "2046440"
  },
  {
    "text": "output temporary key found 000000 0 and here is the long-term key that's",
    "start": "2046519",
    "end": "2054000"
  },
  {
    "text": "used to encrypt this communication and all future communication between the master my laptop and the slave the heart",
    "start": "2054000",
    "end": "2061200"
  },
  {
    "text": "monitor that I'm wearing right now and actually if we fire this one up this should actually potentially",
    "start": "2061200",
    "end": "2069720"
  },
  {
    "text": "work oh that's the wrong version of wi shark don't have too many versions of wire shark install",
    "start": "2070720",
    "end": "2077679"
  },
  {
    "text": "kids why is it not showing up there we go so you can see the data",
    "start": "2077919",
    "end": "2084200"
  },
  {
    "text": "in here and oh yeah there's nothing actually in",
    "start": "2084200",
    "end": "2090000"
  },
  {
    "text": "that well anyway the temporary key cracked and that was actually a worst",
    "start": "2090000",
    "end": "2095079"
  },
  {
    "text": "case scenario I ran the Brute Force algorithm in Reverse it took 1.5 seconds because I'm on battery and my laptop's",
    "start": "2095079",
    "end": "2101440"
  },
  {
    "text": "not running at full speed that concludes the demo portion of the",
    "start": "2101440",
    "end": "2107240"
  },
  {
    "text": "talk the question that you all should be asking right now am I affected by this vulnerability the short answer is",
    "start": "2107240",
    "end": "2114520"
  },
  {
    "text": "probably this is a protocol error I didn't mention any vendor names because they're all vulnerable any bluetooth",
    "start": "2114520",
    "end": "2122040"
  },
  {
    "text": "smart device that implements encryption and key exchange according to the spec is vulnerable to this",
    "start": "2122040",
    "end": "2129440"
  },
  {
    "text": "issue there is one exception I found that some vendors implemented their own",
    "start": "2129440",
    "end": "2134480"
  },
  {
    "text": "security layer on top of Gat remember what I said earlier if you're not a cryptographer",
    "start": "2134480",
    "end": "2141440"
  },
  {
    "text": "don't build a crypto system I know there was a major weakness in one of these that I've identified but I don't have",
    "start": "2141440",
    "end": "2147480"
  },
  {
    "text": "permission to talk about right now so really if you want to improve",
    "start": "2147480",
    "end": "2153000"
  },
  {
    "text": "your security use out of band pairing if you can if you can't use",
    "start": "2153000",
    "end": "2159280"
  },
  {
    "text": "SSP so to summarize bluetooth smart is pretty good its key exchange is broken and the ReUse",
    "start": "2159280",
    "end": "2167040"
  },
  {
    "start": "2160000",
    "end": "2160000"
  },
  {
    "text": "of the long-term key fundamentally dams the security of the protocol however if",
    "start": "2167040",
    "end": "2172319"
  },
  {
    "text": "you implement a simple fix using SSP you will be invulnerable to this type of",
    "start": "2172319",
    "end": "2179040"
  },
  {
    "start": "2179000",
    "end": "2179000"
  },
  {
    "text": "problem and I'll wrap up with uh discussion of some of the capabilities that I've developed as a part of this",
    "start": "2179040",
    "end": "2184400"
  },
  {
    "text": "project on the ubertooth we can passively intercept Bluetooth smart as I demonstrated up here on stage we also",
    "start": "2184400",
    "end": "2191280"
  },
  {
    "text": "support promiscuous mode and injection I didn't discuss those but I can go into them if anyone's interested offline",
    "start": "2191280",
    "end": "2197280"
  },
  {
    "text": "probably I developed some wire shark plugins for dealing with the bluetooth smart link layer and I developed a tool called",
    "start": "2197280",
    "end": "2204280"
  },
  {
    "text": "crackle crackle will crack the temporary key that you sniffed with ubertooth and it'll decrypt any pcap file if you",
    "start": "2204280",
    "end": "2210720"
  },
  {
    "text": "submit it if if you provide it with a long-term key finally I released a piece of software called Nano ECC this is an",
    "start": "2210720",
    "end": "2217760"
  },
  {
    "text": "8- bit implementation of elliptic curve Diffy Helman it'll run on 8-bit processors it's pretty it's not super",
    "start": "2217760",
    "end": "2223800"
  },
  {
    "text": "well optimized but it's pretty Speedy it'll take about 5 Seconds to do a ecdh",
    "start": "2223800",
    "end": "2229040"
  },
  {
    "text": "calculation I plan to have a demo version of the whole SSP running on this",
    "start": "2229040",
    "end": "2235599"
  },
  {
    "text": "little bluetooth smart Dev board but uh it died a cautionary tale of the dangers",
    "start": "2235599",
    "end": "2241440"
  },
  {
    "text": "of doing 192-bit multiplies on an 8bit microprocessor so here's some links to",
    "start": "2241440",
    "end": "2247599"
  },
  {
    "start": "2246000",
    "end": "2246000"
  },
  {
    "text": "some of the software if you're interested come talk to me later but ubertooth and live btbb Nano ecc's up on",
    "start": "2247599",
    "end": "2254440"
  },
  {
    "text": "is6 GitHub and crackles up on my personal website I'd like to wish a very special",
    "start": "2254440",
    "end": "2260359"
  },
  {
    "start": "2259000",
    "end": "2259000"
  },
  {
    "text": "happy birthday to my wife who's sitting here in the audience and that's it I want to provide",
    "start": "2260359",
    "end": "2266240"
  },
  {
    "text": "special thanks to Mike Osman and Dominic spill who are here not in this room but they're super awesome because they built",
    "start": "2266240",
    "end": "2272440"
  },
  {
    "text": "and support the ubertooth project also like to give thanks to Mike Kershaw the",
    "start": "2272440",
    "end": "2277720"
  },
  {
    "text": "rest of the ubertooth team Blues on Linux which is some of the finest bluetooth smart support available right",
    "start": "2277720",
    "end": "2282839"
  },
  {
    "text": "now and the Bluetooth special interest group for publishing a really readable spec last but not least I'd like to",
    "start": "2282839",
    "end": "2289280"
  },
  {
    "text": "thank black hat for allowing me to speak here and ISC Partners my employer for funding a portion of This",
    "start": "2289280",
    "end": "2295640"
  },
  {
    "text": "research and that's me thank you very",
    "start": "2295640",
    "end": "2300599"
  },
  {
    "text": "much also please scan your badge when you leave the room so uh with that are there any",
    "start": "2303079",
    "end": "2309560"
  },
  {
    "text": "questions up",
    "start": "2309560",
    "end": "2312800"
  },
  {
    "text": "hereid the question is can you do SSP on Android or iOS uh the answer is you this",
    "start": "2315960",
    "end": "2321880"
  },
  {
    "text": "is implemented at the application layer on top of Gat so you would have to implement it in your application for",
    "start": "2321880",
    "end": "2328280"
  },
  {
    "text": "support there's no actual Bluetooth device picker for bluetooth smart the way there is with classic Bluetooth",
    "start": "2328280",
    "end": "2333920"
  },
  {
    "text": "because communicating with the device is so device specific so it would be a feature you build into your app I plan",
    "start": "2333920",
    "end": "2340000"
  },
  {
    "text": "to do I do plan to release a Java and iOS version so people can build that into their",
    "start": "2340000",
    "end": "2345440"
  },
  {
    "text": "apps question up",
    "start": "2345440",
    "end": "2348880"
  },
  {
    "text": "here so the question was uh was the flaw due to laziness or due to compliance or",
    "start": "2357920",
    "end": "2364760"
  },
  {
    "text": "really why why did they uh why did they have this flaw in the protocol I think the real reason is because ecdh is",
    "start": "2364760",
    "end": "2372040"
  },
  {
    "text": "expensive to implement a lot of people probably wouldn't want to implement it and there are some questionable patents",
    "start": "2372040",
    "end": "2379160"
  },
  {
    "text": "involved there um I've heard some inside scoop that it was mainly due to Resource",
    "start": "2379160",
    "end": "2386640"
  },
  {
    "text": "constraints sorry which slides oh links sure",
    "start": "2388800",
    "end": "2396119"
  },
  {
    "text": "yeah how does this work with audio",
    "start": "2396319",
    "end": "2402079"
  },
  {
    "text": "AIO so the question was how does this work with audio can you intercept or inject audio if you're uh transmitting",
    "start": "2402079",
    "end": "2409040"
  },
  {
    "text": "audio over Bluetooth Bluetooth smart does not have any audio capabilities if you're using audio you're using classic",
    "start": "2409040",
    "end": "2416480"
  },
  {
    "text": "Bluetooth are there other questions anyone",
    "start": "2416480",
    "end": "2423520"
  },
  {
    "text": "buer okay thank you very much for sticking it out with me I'm Mike Ryan from ISC",
    "start": "2423520",
    "end": "2431440"
  },
  {
    "text": "partners",
    "start": "2431920",
    "end": "2434920"
  }
]