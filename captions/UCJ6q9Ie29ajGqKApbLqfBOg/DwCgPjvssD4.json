[
  {
    "text": "okay hello buddy um and Welcome to our talk uh the very",
    "start": "2340",
    "end": "7799"
  },
  {
    "text": "stages of shades of supply chain and spawn and days and zero trust",
    "start": "7799",
    "end": "13200"
  },
  {
    "text": "my name is kaim Haines I'm a CTO at immune we're doing Pharma security but",
    "start": "13200",
    "end": "18539"
  },
  {
    "text": "this is a combined talk um with Alex Microsoft and Richard use most of the offensive research here",
    "start": "18539",
    "end": "24240"
  },
  {
    "text": "comes from Alex and his team at finally and most of the statistics you're going",
    "start": "24240",
    "end": "29820"
  },
  {
    "text": "to see is coming from Richard he is working for red hat and is the maintainer of the Lions vendor firmware",
    "start": "29820",
    "end": "36059"
  },
  {
    "text": "service and the firmware update demon so um our talk we're going to be an uh",
    "start": "36059",
    "end": "43680"
  },
  {
    "text": "Whirlwind tour through all the Pharma security mechanisms we have in real normal ufis",
    "start": "43680",
    "end": "50219"
  },
  {
    "text": "um what the vendors were up to in last year and what the attackers did",
    "start": "50219",
    "end": "55500"
  },
  {
    "text": "um but first thing first we're going to talk about the Defenders um so a few as a first and a short",
    "start": "55500",
    "end": "62760"
  },
  {
    "text": "reduction um what's the point here right why why is firmware so uh a special topic",
    "start": "62760",
    "end": "69180"
  },
  {
    "text": "um the former supply chain is different from what you have with normal software right unlike your windows um all the codes that comes from that is",
    "start": "69180",
    "end": "76260"
  },
  {
    "text": "in your laptop is not all coming from Lenovo or Dell something actually most of the code is coming from reference",
    "start": "76260",
    "end": "81420"
  },
  {
    "text": "implementations that these SEC Runners do they hand it off to the um independent virus vendors they add some",
    "start": "81420",
    "end": "87360"
  },
  {
    "text": "proprietary stuff hand it off to the odms they collect all the different other firmware components that are in",
    "start": "87360",
    "end": "93060"
  },
  {
    "text": "the supply chain sign that thing and then trip it off to you and they know it just puts their label on it and sent it",
    "start": "93060",
    "end": "98820"
  },
  {
    "text": "to you so um when you for example build build one of these laptops you have lots",
    "start": "98820",
    "end": "104640"
  },
  {
    "text": "of different levels from the components that have to go in there you get them from suppliers or Sub sub contractors",
    "start": "104640",
    "end": "111540"
  },
  {
    "text": "and he the way these binaries are transformed like distributed is based",
    "start": "111540",
    "end": "119040"
  },
  {
    "text": "completely on trust right so if you add some kind of little chip in there in your system and you need some kind of",
    "start": "119040",
    "end": "124259"
  },
  {
    "text": "firmware you're just going to get this from one of the substance suppliers um the adjusted binaries and there's no",
    "start": "124259",
    "end": "130679"
  },
  {
    "text": "verification done any in any way anywhere where your shape will form right so the oems collect all these",
    "start": "130679",
    "end": "135720"
  },
  {
    "text": "binaries sign them and send them to you um which is kind of a problem right so",
    "start": "135720",
    "end": "141540"
  },
  {
    "text": "there's this everything's based on trust and we actually want to go to the point where we do not have to trust everybody",
    "start": "141540",
    "end": "147239"
  },
  {
    "text": "um so there's this concept of seal trust and uh when you Google it you you find a lot of marketing fluff and you find like",
    "start": "147239",
    "end": "153660"
  },
  {
    "text": "the five pillars of of zero trust and you find the six pillars of zero trust and you find the Seven Pillars of zero",
    "start": "153660",
    "end": "160080"
  },
  {
    "text": "trust and you find the eight pillars of zero trust and I asked jet GPT to come up with nine pillars of seal trust and",
    "start": "160080",
    "end": "165420"
  },
  {
    "text": "it's pretty much the same thing you read in all of these specifications um but under all of under of these Pages",
    "start": "165420",
    "end": "172379"
  },
  {
    "text": "or specifications there's a pretty good idea about it here which is the idea to fast we want to minimize our trust",
    "start": "172379",
    "end": "177780"
  },
  {
    "text": "assumptions and we do we want to take away all the implicit trust we have in our system so the idea comes from",
    "start": "177780",
    "end": "184379"
  },
  {
    "text": "networking where you say okay I have an internal Network um and I do not want to implicitly trust everybody who's in this network right I",
    "start": "184379",
    "end": "190440"
  },
  {
    "text": "want to act like all my internal services are reachable from the outside and do authentication the same way I",
    "start": "190440",
    "end": "196140"
  },
  {
    "text": "would do it for for like internet facing service um and this idea can be extended to",
    "start": "196140",
    "end": "201540"
  },
  {
    "text": "Firmware um in a way that we say okay there are many cooks in the former kitchen all of these people are kind of necessary",
    "start": "201540",
    "end": "207959"
  },
  {
    "text": "um but we don't want to trust all of these people right if you want to verify the binders we get at least at the point",
    "start": "207959",
    "end": "214379"
  },
  {
    "text": "where we ship them to the customer um why would you want this so this is an Excel from our last year's talk where we",
    "start": "214379",
    "end": "220680"
  },
  {
    "text": "talked about the usbrt vulnerability first is covered in 2016. it was fixed it came up again",
    "start": "220680",
    "end": "228299"
  },
  {
    "text": "later in 2017 rediscovered the same vulnerability why well somebody in this",
    "start": "228299",
    "end": "234540"
  },
  {
    "text": "supply chain didn't get the message use the old one vulnerable reference code shipped it again and the vulnerability",
    "start": "234540",
    "end": "240720"
  },
  {
    "text": "appeared again same thing happened in 2020 same thing happened in 2021 in 2022",
    "start": "240720",
    "end": "246120"
  },
  {
    "text": "it happens three times three different vendors shipped vulnerable reference code because they didn't know that this",
    "start": "246120",
    "end": "251819"
  },
  {
    "text": "code was vulnerable and there should be like a new version that the should be used um this guy's a problem right you have",
    "start": "251819",
    "end": "258359"
  },
  {
    "text": "this this complex supply chain not only code has to travel down there but other information and if somebody messes up",
    "start": "258359",
    "end": "264540"
  },
  {
    "text": "um you get vulnerable codes that ends up in customers hands and in new data center right",
    "start": "264540",
    "end": "270000"
  },
  {
    "text": "um so what we want to do is we want to verify these blobs and we won't want to verify not only once when we get the",
    "start": "270000",
    "end": "275400"
  },
  {
    "text": "system but we want to do it continuously right because you have firmware updates um and maybe the guide that does the",
    "start": "275400",
    "end": "280560"
  },
  {
    "text": "initial firmware built got the message about the vulnerable blob but maybe the guy that does the update didn't get the",
    "start": "280560",
    "end": "287400"
  },
  {
    "text": "message and then now we can reintroduce the same vulnerability again while the update path",
    "start": "287400",
    "end": "294000"
  },
  {
    "text": "um so to make this a bit more more clear let's come up with it let's come up with a transparency hierarchy where we say",
    "start": "294000",
    "end": "299759"
  },
  {
    "text": "okay the most transparent thing we can have the best case is you have open source software that can be built",
    "start": "299759",
    "end": "305220"
  },
  {
    "text": "reproducibly in that case we can inspect the source code decide it's fine then we have a reproducible process we know what",
    "start": "305220",
    "end": "311520"
  },
  {
    "text": "binary comes out of that and we can trust that binary um open source in this case only means",
    "start": "311520",
    "end": "316680"
  },
  {
    "text": "that we can actually read the code right we don't really care about changing it it doesn't have to be like MRT licensed uh that's the ability to be inspected",
    "start": "316680",
    "end": "324479"
  },
  {
    "text": "um the Lesser version of that is to say okay we have open source code that cannot be built reproducibly we can inspect a code we have to trust the",
    "start": "324479",
    "end": "331500"
  },
  {
    "text": "build process or the person that builds it but that's it aside from that we can we can trust the source code uh The Blob",
    "start": "331500",
    "end": "337440"
  },
  {
    "text": "um this is not really what the common case is firmware and firmware you have most of the time closed Source Bobs coming",
    "start": "337440",
    "end": "342840"
  },
  {
    "text": "from some vendor for example Intel says okay this is the blob you need to meet that to boot my system period right",
    "start": "342840",
    "end": "350160"
  },
  {
    "text": "um the worst case you could think of our closed Source block coming from completely unknown sources and this is",
    "start": "350160",
    "end": "355620"
  },
  {
    "text": "not so uncommon in firmware um you often have blobs that on the outside say yeah they are part of the",
    "start": "355620",
    "end": "361680"
  },
  {
    "text": "Lenovo like firmware package or data firmware package um but they're not really coming from",
    "start": "361680",
    "end": "366780"
  },
  {
    "text": "these these oems right they're coming from some subcontractor they're not going to talk about so you have blobs from unknown sources",
    "start": "366780",
    "end": "373139"
  },
  {
    "text": "um and you cannot do much there right you cannot ask the vendor about like a list of good blobs and list of",
    "start": "373139",
    "end": "379199"
  },
  {
    "text": "vulnerable ones because they don't know themselves um the only thing you can do across checks to see okay are the drops that I",
    "start": "379199",
    "end": "385860"
  },
  {
    "text": "have here um the same that somebody has in another organization maybe another country has or do I have a very special block",
    "start": "385860",
    "end": "391560"
  },
  {
    "text": "there's some bits that changed it's kind of suspect already but aside from that you don't have really insight into that",
    "start": "391560",
    "end": "396960"
  },
  {
    "text": "so let's look at a standard Intel server boot right we start off with the ACM and the pay phase these are the acms of",
    "start": "396960",
    "end": "404639"
  },
  {
    "text": "science platform Intel and the pay phase is where the fsp lives um that does all the memory training and so on the ACM",
    "start": "404639",
    "end": "411120"
  },
  {
    "text": "does the boot guard you need these two they come from enter you have to use them period you're not going to get access to the source code if you're not",
    "start": "411120",
    "end": "416699"
  },
  {
    "text": "an oem after that things get a bit better uh you have to Dixie phase which is like the first part of ufi where all the",
    "start": "416699",
    "end": "424080"
  },
  {
    "text": "drivers are um part of this open source because the reference implementation of your fi Channel car is open it's on GitHub you",
    "start": "424080",
    "end": "430860"
  },
  {
    "text": "can just check it out but this is where the vendors put all their proprietary from in so it's like half open half",
    "start": "430860",
    "end": "437639"
  },
  {
    "text": "closed after that you have the option ROMs that's code that's injected during the boot process from peripherals this",
    "start": "437639",
    "end": "443699"
  },
  {
    "text": "again could reach lost then you have the PDS layer which is again ufi it's particulars part open and",
    "start": "443699",
    "end": "449699"
  },
  {
    "text": "then you have like your virtual machine in your container process and depending on what vendor you choose that can be",
    "start": "449699",
    "end": "454919"
  },
  {
    "text": "completely open um sadly this is a kind of naive way at looking at the boot process because you",
    "start": "454919",
    "end": "461639"
  },
  {
    "text": "don't have just your host CPU right you have for example gpus you have network cards and we have the csme or C CSE or",
    "start": "461639",
    "end": "468900"
  },
  {
    "text": "PSP uh txt and so on um different names for the same thing DME which is a separate process separate",
    "start": "468900",
    "end": "476280"
  },
  {
    "text": "strip that runs in parallel um gpus they have boot loss they have operating systems it's all closed uh for",
    "start": "476280",
    "end": "482400"
  },
  {
    "text": "the CSE at least they are white papers that talk about okay um how's the security working here there",
    "start": "482400",
    "end": "488280"
  },
  {
    "text": "is a list of firmware versions from Intel but for example for the white",
    "start": "488280",
    "end": "493319"
  },
  {
    "text": "paper there's I'm not aware of any like outside verification of that so you have to take the word for it and if you have",
    "start": "493319",
    "end": "500280"
  },
  {
    "text": "a modern uh for Rapid City server for example you have something called The pfr Flash from firmware Resurgence which",
    "start": "500280",
    "end": "507180"
  },
  {
    "text": "is an fpga on the system that also does verification and this is completely open so you can get both the bitstream for",
    "start": "507180",
    "end": "513719"
  },
  {
    "text": "the fpga AMD firmware that's running on the SOC um for free and open on GitHub um it's a",
    "start": "513719",
    "end": "519539"
  },
  {
    "text": "departure for internet actually I hope this is not an exception and this is the new intro we heard about",
    "start": "519539",
    "end": "525720"
  },
  {
    "text": "um and then people tell me okay well okay uh it's all in transparent but if you've got the keyboard right it's all signed that's fine",
    "start": "525720",
    "end": "532260"
  },
  {
    "text": "um CQ would only only secures a very small part of the of the boot process it's only the UF file",
    "start": "532260",
    "end": "538200"
  },
  {
    "text": "um part that's actually signed everything else doesn't isn't covered by security anyway",
    "start": "538200",
    "end": "543480"
  },
  {
    "text": "um and even worse if you look at the specification of ufi the human can be",
    "start": "543480",
    "end": "548519"
  },
  {
    "text": "skipped for code that comes from a secure source with 15 codes here um which is for example The Flash uh",
    "start": "548519",
    "end": "555420"
  },
  {
    "text": "image so which means that for the Dixie phase that we saw we already called their order code is in most of the time",
    "start": "555420",
    "end": "560940"
  },
  {
    "text": "they are not signed and this is real right if you look at real ufis most of these things are not signed because they",
    "start": "560940",
    "end": "566279"
  },
  {
    "text": "come from a secure Source they are trusted in some way um and they only have to verify like the boot loader that's for me on disk",
    "start": "566279",
    "end": "573959"
  },
  {
    "text": "um and of course you can just disable the keyword or you just have to go go into the BMC or on the BIOS menu and",
    "start": "573959",
    "end": "579300"
  },
  {
    "text": "then turn it off so here comes the first statistics and they all come from the Leos vendor",
    "start": "579300",
    "end": "585600"
  },
  {
    "text": "firmware service which publishes and ships or firmware updates for linear systems mostly um they also",
    "start": "585600",
    "end": "592019"
  },
  {
    "text": "do security analysis and if you opt into it this is sent anonymously to to the",
    "start": "592019",
    "end": "597360"
  },
  {
    "text": "lvfs um which turns out that uh more than half of the systems out there do not",
    "start": "597360",
    "end": "603540"
  },
  {
    "text": "have even the keyboard enabled um so it doesn't really matter whether it's a keyword is secure or not people don't really use it",
    "start": "603540",
    "end": "610080"
  },
  {
    "text": "um the good news and there's actually only good news on in the whole slide deck is at least the platform key so",
    "start": "610080",
    "end": "616140"
  },
  {
    "text": "that is the core signing key on the system is correct on the most systems right about even systems out there that",
    "start": "616140",
    "end": "622080"
  },
  {
    "text": "have broken platform keys so even if you enable secure it won't work crazy and yeah if you look at the",
    "start": "622080",
    "end": "627779"
  },
  {
    "text": "Timeline it does it's creeping up slightly um but it's not really improving that",
    "start": "627779",
    "end": "632820"
  },
  {
    "text": "much and at the top here is 60 right so we're creeping towards like 50 not like 100.",
    "start": "632820",
    "end": "638600"
  },
  {
    "text": "uh and then okay let's see what sucks okay I got it uh what about boot card",
    "start": "638600",
    "end": "644700"
  },
  {
    "text": "um so this is the keyword plus boot cards bootcut only this is the first one here uh booger only secures the initial",
    "start": "644700",
    "end": "651420"
  },
  {
    "text": "part sorry the initial part of the secure right because secret is a software only you have to have some kind",
    "start": "651420",
    "end": "657420"
  },
  {
    "text": "of Hardware anchor here and this is what Google does nothing else",
    "start": "657420",
    "end": "663420"
  },
  {
    "text": "um again statistics bootcard is configured on pretty much all systems out there that's good news",
    "start": "663420",
    "end": "669120"
  },
  {
    "text": "um but on 30 of these systems who got the Buddha conversion is not locked so",
    "start": "669120",
    "end": "674700"
  },
  {
    "text": "everybody who has root on the system and knows the product called how to talk to the csme uh can change the keys",
    "start": "674700",
    "end": "681720"
  },
  {
    "text": "whenever he wants which is crazy um but it's not really important because of these systems 44 dual enforce boot",
    "start": "681720",
    "end": "690120"
  },
  {
    "text": "guards is implemented via an ACM that has to be started when the system boots",
    "start": "690120",
    "end": "695700"
  },
  {
    "text": "up you can remove this ACM from the flash image um and this is the will just boot there's no enforcement here",
    "start": "695700",
    "end": "702300"
  },
  {
    "text": "um okay so secure boot like all the signature verification that sucks okay I got it but you got this other thing",
    "start": "702300",
    "end": "707880"
  },
  {
    "text": "right you get measurable you're just Computing um which is kind of having a Revival like after these next Generation secure",
    "start": "707880",
    "end": "714360"
  },
  {
    "text": "Computing based disaster like 15 years ago uh things coming back uh you cannot",
    "start": "714360",
    "end": "720000"
  },
  {
    "text": "run your windows 11 without TPM um and even the arch nemesis of trust Computing Linux Community is kind of",
    "start": "720000",
    "end": "726000"
  },
  {
    "text": "warming up to the idea of like using it for uh credential protection and stuff like that um and they are some cool ideas here",
    "start": "726000",
    "end": "733380"
  },
  {
    "text": "right especially um that when you say okay we have this blobs right they are maybe transparent",
    "start": "733380",
    "end": "739019"
  },
  {
    "text": "maybe not but we trusted them regressively um we have this block on the flesh it",
    "start": "739019",
    "end": "744360"
  },
  {
    "text": "doesn't we have we have no link without measurements to the actual state of system right",
    "start": "744360",
    "end": "750540"
  },
  {
    "text": "um and measure boot allows you to do that right you get a list of measurements what has been actually executed during boot plus the data that",
    "start": "750540",
    "end": "756720"
  },
  {
    "text": "has been consumed um and this gives you at least a link to your trusted blobs um which is a very cool feature of of",
    "start": "756720",
    "end": "763019"
  },
  {
    "text": "just Computing um reality is that the implementation is kind of not really secure",
    "start": "763019",
    "end": "769200"
  },
  {
    "text": "um you have problems with sap artels for example they contain code they are measured but the sapi tables that I used",
    "start": "769200",
    "end": "775019"
  },
  {
    "text": "are not the ones that are measured because there's a lot of patching infrastructure in Linux to fix certain problems with sapi tables so you only",
    "start": "775019",
    "end": "782100"
  },
  {
    "text": "measure the input to this process you're not getting really what what is executed at runtime these measurements these",
    "start": "782100",
    "end": "788700"
  },
  {
    "text": "piecing areas that cannot really be pre-computed so if I give you a fun image and say hey give me the the measurements after after you've run this",
    "start": "788700",
    "end": "796220"
  },
  {
    "text": "it's pretty much impossible because there are runtime information that go into these pcrs and the way that go into",
    "start": "796220",
    "end": "802980"
  },
  {
    "text": "we don't really know exactly right so we know roughly what goes into it but the execution mechanism is under NDA",
    "start": "802980",
    "end": "809519"
  },
  {
    "text": "um then there are other event logs that tell you a bit more information but these are not really Integrity protected",
    "start": "809519",
    "end": "814800"
  },
  {
    "text": "so you have to pass them exactly as they are you have to understand every entry in the event log otherwise an attacker",
    "start": "814800",
    "end": "820560"
  },
  {
    "text": "can hide information in there which may still makes it really hard to use they're very really designed for for",
    "start": "820560",
    "end": "825839"
  },
  {
    "text": "this kind of thing and yeah if you look around reality um there's a good chunk of systems out",
    "start": "825839",
    "end": "832079"
  },
  {
    "text": "there where the events in the event don't really match shots in the PC in the in these are values",
    "start": "832079",
    "end": "837600"
  },
  {
    "text": "um so for this systems measure boot is not going to work anyways they also the problem that changes because there are",
    "start": "837600",
    "end": "845100"
  },
  {
    "text": "automated updates and they kind of pre-compute values um any change from your measurements",
    "start": "845100",
    "end": "850740"
  },
  {
    "text": "um you have to decide whether this was an update on on a tech and this is really hard if you have things like automated updates",
    "start": "850740",
    "end": "856800"
  },
  {
    "text": "um which makes the thing a really challenging to use same thing is with configuration right if you if you change",
    "start": "856800",
    "end": "862139"
  },
  {
    "text": "the configuration file yes the measurements will change but you do not know in which way they are going to be",
    "start": "862139",
    "end": "867839"
  },
  {
    "text": "changed because they measure pretty much internal structures of the ufi and of course depends on a bug free the",
    "start": "867839",
    "end": "874920"
  },
  {
    "text": "cryptographers implementations of buggy the reference implementations are buggy there was an out-of-bound Street and",
    "start": "874920",
    "end": "880199"
  },
  {
    "text": "right vulnerability in the reference code and this reference code is used by all the different TPM vendors to to as a",
    "start": "880199",
    "end": "886019"
  },
  {
    "text": "basis for their implementation so we're going to see lots of these vulnerabilities in the future",
    "start": "886019",
    "end": "891120"
  },
  {
    "text": "um there was some tests to fix it it'll add something called TSC or they have something called TC",
    "start": "891120",
    "end": "896699"
  },
  {
    "text": "um where they give you a set of measurements during manufacturing then you get the server booted and then you can verify okay how does the",
    "start": "896699",
    "end": "902760"
  },
  {
    "text": "measurements the same that we are uh they are doing the manufacturing the moment you install an operating system",
    "start": "902760",
    "end": "907980"
  },
  {
    "text": "these measurement chains are useless right um Ram certificates something similar",
    "start": "907980",
    "end": "913440"
  },
  {
    "text": "um where they are more concentrated on the event logs bit more finer granularity same problem",
    "start": "913440",
    "end": "918720"
  },
  {
    "text": "um they are really they don't tell you everything um and even if they would our room",
    "start": "918720",
    "end": "925019"
  },
  {
    "text": "certificates are pretty much specification only I've never seen anything such thing in reality yet",
    "start": "925019",
    "end": "930600"
  },
  {
    "text": "um so it's not going to help us but at least there were Diagnostics so they can be useful other things than Intel",
    "start": "930600",
    "end": "938100"
  },
  {
    "text": "um maybe good news measure boot covers a bit more than just the keyboard um especially with the CSE that got",
    "start": "938100",
    "end": "943500"
  },
  {
    "text": "measurements built in um but again it's not everything okay so after I told you about about the",
    "start": "943500",
    "end": "951360"
  },
  {
    "text": "imperfect Solutions we have in security mechanisms um let's see what the attackers were up",
    "start": "951360",
    "end": "956639"
  },
  {
    "text": "to in the last year um as you may have noticed there has been",
    "start": "956639",
    "end": "961920"
  },
  {
    "text": "explosion of uh more there in firmware in the last few years the first ones uh",
    "start": "961920",
    "end": "968459"
  },
  {
    "text": "like like New Balance in Crosby Street um they were like Dixie uh based a text right there were a Dixie",
    "start": "968459",
    "end": "975540"
  },
  {
    "text": "in the Dixie phase um and especially for Moon balls it has been active since 2014 published in 2020",
    "start": "975540",
    "end": "982740"
  },
  {
    "text": "um they are rather old mechanisms right they don't use those older mechanisms um with black load tools it's super",
    "start": "982740",
    "end": "988199"
  },
  {
    "text": "interesting the first one is it's not a Salesman State sponsor ticket but it's other crime and the second one it's a bootloader",
    "start": "988199",
    "end": "994139"
  },
  {
    "text": "um so we don't attack the Dixie phase uh we actually attacked the BDS phase the bootloader phase which is kind of funny",
    "start": "994139",
    "end": "999600"
  },
  {
    "text": "uh because Alex in his in his book uh book is the rootkits said that now it",
    "start": "999600",
    "end": "1005600"
  },
  {
    "text": "was a few years ago now with CQ boot um the Golden Age of of boot kids is over right because everything is signed",
    "start": "1005600",
    "end": "1011779"
  },
  {
    "text": "and you cannot just change something um Well turns out this was a bit too optimistic um mostly because the complexity",
    "start": "1011779",
    "end": "1019459"
  },
  {
    "text": "um and the facts that the only way to prevent these kinds of attacks and and Patch them is to use the irrigation",
    "start": "1019459",
    "end": "1025100"
  },
  {
    "text": "mechanisms which got dbx it's a list of hashes pretty much that are no longer allowed to be booted even if they are",
    "start": "1025100",
    "end": "1030918"
  },
  {
    "text": "correctly signed and updating this dbx is a very slow and intransparent process",
    "start": "1030919",
    "end": "1036678"
  },
  {
    "text": "um so it took for example Microsoft was the main Shepherd of this of this list until May they don't tell you which may",
    "start": "1036679",
    "end": "1045020"
  },
  {
    "text": "um but it cannot be much because uh North 13th right um not first",
    "start": "1045020",
    "end": "1050960"
  },
  {
    "text": "uh so I looked at it last month and there was nothing on Black Lotus berated",
    "start": "1050960",
    "end": "1056059"
  },
  {
    "text": "in any way um so it's very slow and even now that we have this dbx in order to fix the dbx",
    "start": "1056059",
    "end": "1063320"
  },
  {
    "text": "on your system you have to do a firmware update right because it's data in the firmware so everybody has to roll out these firmware updates",
    "start": "1063320",
    "end": "1069679"
  },
  {
    "text": "um and uh this is something that people are not going to going to do I have talked about this later",
    "start": "1069679",
    "end": "1075679"
  },
  {
    "text": "um so um if I'm a techer how do I how do I get for example signing key to to sign",
    "start": "1075679",
    "end": "1080840"
  },
  {
    "text": "my boot kit pretty easy I just make a random attack ON Semiconductor companies",
    "start": "1080840",
    "end": "1087200"
  },
  {
    "text": "um they all have these sign keys right because they do firmware and we have seen an explosion of these of these",
    "start": "1087200",
    "end": "1093380"
  },
  {
    "text": "attacks ON Semiconductor companies um it's not only ransomware right it's most of the time it's just data breaches for",
    "start": "1093380",
    "end": "1099799"
  },
  {
    "text": "example in Lenovo odm called LCFC um got a data breach where their whole code base for their Lenovo Yoga laptops was",
    "start": "1099799",
    "end": "1107179"
  },
  {
    "text": "published um which is bad enough already but in that scope there was also the private",
    "start": "1107179",
    "end": "1112460"
  },
  {
    "text": "signing keys for the key manifest in the boot policy manifest these two data structures are part of boot guard is a",
    "start": "1112460",
    "end": "1118760"
  },
  {
    "text": "core part of bootcard you have the key manifest which is a list of keys that are allowed to sign the boot policy",
    "start": "1118760",
    "end": "1124400"
  },
  {
    "text": "manifest and the boot policy manifest complains the hash in the range of the initial boot block and this initial boot",
    "start": "1124400",
    "end": "1129860"
  },
  {
    "text": "block is the pay phase that bootstraps the keyboard so now that I have this and the the key that is allowed to sign the",
    "start": "1129860",
    "end": "1136820"
  },
  {
    "text": "key manifest the key manufacturing keys that is fused into the uh csme so this presumably cannot be changed",
    "start": "1136820",
    "end": "1144020"
  },
  {
    "text": "um so now with these two keys I can create my own boot policy manifest I can",
    "start": "1144020",
    "end": "1149539"
  },
  {
    "text": "create my own pay phase sign that and this allows me to inject code before the security facing window started right so",
    "start": "1149539",
    "end": "1155240"
  },
  {
    "text": "this is not going to be covered by dbx anyways you have to update um well in this case you have to somehow",
    "start": "1155240",
    "end": "1161539"
  },
  {
    "text": "unfuse the key and put a new one in I don't know if this even possible um but here's the good news in order to",
    "start": "1161539",
    "end": "1168679"
  },
  {
    "text": "do that you have to write it to the flash right so you either have to do an SML exploit which is rather easy sadly",
    "start": "1168679",
    "end": "1175640"
  },
  {
    "text": "um or you have to have physical access to the machine to flash from the outside um that is good news uh if you wonder if",
    "start": "1175640",
    "end": "1182539"
  },
  {
    "text": "your system your yoga laptop is vulnerable there's an uh the binary",
    "start": "1182539",
    "end": "1188000"
  },
  {
    "text": "supplied you can upload your firm image and they will check where your key is fused uh where the key that's fused at",
    "start": "1188000",
    "end": "1194960"
  },
  {
    "text": "your laptop is one of these like Elite ones okay now comes the slide everybody's",
    "start": "1194960",
    "end": "1201020"
  },
  {
    "text": "waiting for right um the MSA dwm is ID at the breach um so binding was uh notified of that",
    "start": "1201020",
    "end": "1207860"
  },
  {
    "text": "um and they saw later that MSI made a statement that was roughly",
    "start": "1207860",
    "end": "1213380"
  },
  {
    "text": "um yes we got we got a data breach um in our internal infrastructure uh please make sure that if you download",
    "start": "1213380",
    "end": "1219320"
  },
  {
    "text": "any updates that you only get them from us as a result some bonds to that bindly",
    "start": "1219320",
    "end": "1224840"
  },
  {
    "text": "didn't code and binary analysis of all possible updates that came from MSI over",
    "start": "1224840",
    "end": "1231020"
  },
  {
    "text": "the the last months to figure out okay is there any more in there and there are",
    "start": "1231020",
    "end": "1236240"
  },
  {
    "text": "a lot of bad things in there vulnerable codes outdated reference code misconfigurations",
    "start": "1236240",
    "end": "1243500"
  },
  {
    "text": "um but they were no malware but it's good news um it's just the regular garbage that's",
    "start": "1243500",
    "end": "1249140"
  },
  {
    "text": "in these updates um what's a bit bad about these MSI data which again they got their key",
    "start": "1249140",
    "end": "1254900"
  },
  {
    "text": "manifestable policy manifest Keys linked but also they got their firmware signing Keys leaked",
    "start": "1254900",
    "end": "1260120"
  },
  {
    "text": "um so now I can do the same thing with the with the LCFC vulnerability uh key",
    "start": "1260120",
    "end": "1266179"
  },
  {
    "text": "but I don't have to have access physics to the system because I can package my more there in my new pay phase into a",
    "start": "1266179",
    "end": "1272120"
  },
  {
    "text": "normal ufi capsule update and push it as an update um into the into the system the same way that Windows update would",
    "start": "1272120",
    "end": "1278780"
  },
  {
    "text": "put an update a further update to the system so the only route to issue this firmware update and then you go",
    "start": "1278780",
    "end": "1285440"
  },
  {
    "text": "um uh this is actually not a worst part about this whole league uh because the the next key that got leaked was the",
    "start": "1285440",
    "end": "1291140"
  },
  {
    "text": "Intel OEM key um it Intel supplies their oems with a special key that allows them to enable",
    "start": "1291140",
    "end": "1297200"
  },
  {
    "text": "debugging mechanisms and disable certain security um features on production systems",
    "start": "1297200",
    "end": "1305179"
  },
  {
    "text": "um so using that key you can pretty much attach a debugger to the boot process and circumvent pretty much all security",
    "start": "1305179",
    "end": "1311860"
  },
  {
    "text": "we do not know whether this key was exclusively to MSI it is certainly",
    "start": "1311860",
    "end": "1318500"
  },
  {
    "text": "possible that this he was shared with other audience um so maybe it's not even not only MSI",
    "start": "1318500",
    "end": "1324080"
  },
  {
    "text": "systems that are available to this problem again if you wonder if your laptop is is",
    "start": "1324080",
    "end": "1329179"
  },
  {
    "text": "vulnerable there's a format rule you can upload your firmware um and rescan for that keys",
    "start": "1329179",
    "end": "1335679"
  },
  {
    "text": "um obviously you may have more than one laptop um and this is like most of the problems",
    "start": "1335900",
    "end": "1341059"
  },
  {
    "text": "you have to do this things at scale figuring out a case my feed vulnerable is my my server Fleet for example vulnerable",
    "start": "1341059",
    "end": "1346700"
  },
  {
    "text": "um there's a mechanism in from the update demon which is in the package you can install in all normal layers",
    "start": "1346700",
    "end": "1351860"
  },
  {
    "text": "distributions um to do a security rundown of the system right super basic stuff it's equipment enabled I'm a fresh",
    "start": "1351860",
    "end": "1358700"
  },
  {
    "text": "protections enabled things like that so if you wonder about security of a system you can run that you do not want to have",
    "start": "1358700",
    "end": "1365419"
  },
  {
    "text": "anything red here right this is the absolute basic stuff that should work um not like super and advanced things",
    "start": "1365419",
    "end": "1373640"
  },
  {
    "text": "okay um this is what the attackers did in the last year so uh let's let's see what the what the",
    "start": "1373640",
    "end": "1380360"
  },
  {
    "text": "uh Defenders and the um manufacturers did",
    "start": "1380360",
    "end": "1384940"
  },
  {
    "text": "as you may have noticed um the farm is getting pretty complex",
    "start": "1386740",
    "end": "1391760"
  },
  {
    "text": "um and the security like mechanisms and and and and uh ideas that we have and",
    "start": "1391760",
    "end": "1398000"
  },
  {
    "text": "tools that we have there are mostly focused on on firmware as okay I have a few kilobytes of code they run from top",
    "start": "1398000",
    "end": "1404600"
  },
  {
    "text": "to bottom to set up the system Done Right the handoff execution to the operating system done in real life you",
    "start": "1404600",
    "end": "1410480"
  },
  {
    "text": "actually have an operating system in there you have multiple operations this is ufi which is complete operating system uh with with the driver system",
    "start": "1410480",
    "end": "1417020"
  },
  {
    "text": "stack and a bunch of applications and you have to see some either of their own operations operating system that",
    "start": "1417020",
    "end": "1422059"
  },
  {
    "text": "runs in parallel ufi also leaves code in the system right you have something called runtime services that are active after system has been booted",
    "start": "1422059",
    "end": "1428720"
  },
  {
    "text": "um and the amount of code is only increasing right so a normal lab Intel",
    "start": "1428720",
    "end": "1434419"
  },
  {
    "text": "server has often 100 megabytes of firmware on there and the tools we have",
    "start": "1434419",
    "end": "1440000"
  },
  {
    "text": "are not really made to to work with that um as though we have this complex is",
    "start": "1440000",
    "end": "1446240"
  },
  {
    "text": "complicated supply chain which means which means uh and but because um ufi doesn't really separate code from",
    "start": "1446240",
    "end": "1453140"
  },
  {
    "text": "different vendors it's all like running In One Security domain pretty much which means that if you have vulnerability somewhere uh in the in the system and a",
    "start": "1453140",
    "end": "1461179"
  },
  {
    "text": "new one uh is coming up you cannot just look at a single vulnerability in isolation because if you have for",
    "start": "1461179",
    "end": "1467840"
  },
  {
    "text": "example a one of the two vulnerabilities that by themselves they're pretty benign or maybe they can cannot be exploited or",
    "start": "1467840",
    "end": "1473840"
  },
  {
    "text": "maybe that can be exported but it's not really helping you much um it can be that later when these when",
    "start": "1473840",
    "end": "1479780"
  },
  {
    "text": "all of these memorabilities are combined at the odm they are able to be exploited and gain allow you to gain access to to",
    "start": "1479780",
    "end": "1486919"
  },
  {
    "text": "way better things than than just the volunteers by themselves right we have we have an example of this later",
    "start": "1486919",
    "end": "1492799"
  },
  {
    "text": "um which exactly means that instead of and when you look at one vulnerability you cannot say okay this is like the vulnerability what can I do with it but",
    "start": "1492799",
    "end": "1499100"
  },
  {
    "text": "you also have to take into account all the other vulnerabilities that are currently out in the ecosystem right all the all this developable the reference",
    "start": "1499100",
    "end": "1505340"
  },
  {
    "text": "code that nobody really patched it is still out there you have to always take this into account in the whole context",
    "start": "1505340",
    "end": "1510380"
  },
  {
    "text": "of the ecosystem and this is something that that CVS has and we doesn't really",
    "start": "1510380",
    "end": "1515780"
  },
  {
    "text": "um think about um so yeah is actually pretty good news",
    "start": "1515780",
    "end": "1520820"
  },
  {
    "text": "for for the for the ecosystem um so some of these firmware vendors now have s-bombs",
    "start": "1520820",
    "end": "1526100"
  },
  {
    "text": "um the problem is so if you look at one of these s-spons you will find for example knows like 20 different openers",
    "start": "1526100",
    "end": "1531380"
  },
  {
    "text": "algorithms in there um why is that well because of this complicated supply chain right every one",
    "start": "1531380",
    "end": "1537559"
  },
  {
    "text": "of these little vendors maybe they have to do some cryptographic operation they have a hash function or something um so what do they do they take open SSL",
    "start": "1537559",
    "end": "1543500"
  },
  {
    "text": "compile it in uh and in the end you have like a firmware image with uh a hundreds of different open Sr versions it's hard",
    "start": "1543500",
    "end": "1550039"
  },
  {
    "text": "to tell of course most of them some of them are 10 years old right there many of them are vulnerable but you know know",
    "start": "1550039",
    "end": "1556279"
  },
  {
    "text": "whether the vulnerable code is in there right because openness is as big um and maybe that didn't link everything but just the hash function for example",
    "start": "1556279",
    "end": "1563179"
  },
  {
    "text": "um it's hard to analyze but at least there's some step forward here um right the vendors",
    "start": "1563179",
    "end": "1569900"
  },
  {
    "text": "um not only do they care really much about security um they don't really care about patching",
    "start": "1569900",
    "end": "1575059"
  },
  {
    "text": "either um so one month after our last uh blacker talk at decade Asia we realized",
    "start": "1575059",
    "end": "1581120"
  },
  {
    "text": "that hpe after the public disclosure did one month after the public disorder that still didn't have their patch patches",
    "start": "1581120",
    "end": "1587059"
  },
  {
    "text": "out for all the systems so even if you wanted to install a patch you weren't able to after the Public's disclosure",
    "start": "1587059",
    "end": "1592340"
  },
  {
    "text": "right there was there was already an embargo disclosure before that um and they had plenty of time but they",
    "start": "1592340",
    "end": "1597380"
  },
  {
    "text": "were still not able to do to do it in time um but that's not really important because",
    "start": "1597380",
    "end": "1602480"
  },
  {
    "text": "even if there was a patch outside out people are not really installing these patches um so we know for example from the",
    "start": "1602480",
    "end": "1608240"
  },
  {
    "text": "little firmware service um which shipped and debugs update right again it's very important to have this",
    "start": "1608240",
    "end": "1613520"
  },
  {
    "text": "location list um after some time now seven million people have installed the dbx update",
    "start": "1613520",
    "end": "1619880"
  },
  {
    "text": "which sounds like a lot but if you take this as a fraction of all Linux systems",
    "start": "1619880",
    "end": "1625340"
  },
  {
    "text": "out there this is like tiny it's probably less than a percent um why is that of course nobody does",
    "start": "1625340",
    "end": "1631760"
  },
  {
    "text": "something firmware updates it's scary it's going to be unsafe you don't know if the system actually boots again um there's no automated way around you",
    "start": "1631760",
    "end": "1638779"
  },
  {
    "text": "have to actually do it yourself you have to be notified by the vendor hey do you do a firmware update if you don't really",
    "start": "1638779",
    "end": "1643820"
  },
  {
    "text": "do that right um the situation is a bit better on the Windows where we have Windows update it kind of pushes you to do that when it's",
    "start": "1643820",
    "end": "1649820"
  },
  {
    "text": "automatically um it's really hard to get people to do",
    "start": "1649820",
    "end": "1655340"
  },
  {
    "text": "these updates and even right even vegetables out there",
    "start": "1655340",
    "end": "1661100"
  },
  {
    "text": "maybe we don't even figure it out that there's an update um so for example here's an AMD",
    "start": "1661100",
    "end": "1666260"
  },
  {
    "text": "vulnerability again AMD reference code um that bunny found this year their",
    "start": "1666260",
    "end": "1672140"
  },
  {
    "text": "chance art was actually reintroduction of a previous bucket that was already found a year ago and was published and",
    "start": "1672140",
    "end": "1677900"
  },
  {
    "text": "there was a CV out there and everything was fine but again somebody didn't get the message um and reused that one of The Blob it",
    "start": "1677900",
    "end": "1684679"
  },
  {
    "text": "got reiscovered and instead of notifying AMD notifying the customers again hey guys you have to stop using that stuff",
    "start": "1684679",
    "end": "1690559"
  },
  {
    "text": "um they just slapped an update onto the old blog article that nobody is going to read again anymore um unless it says pretty much so oh yeah",
    "start": "1690559",
    "end": "1696919"
  },
  {
    "text": "by the way from this 22 2022 vulnerability List It reappeared upon you later well that's it right no",
    "start": "1696919",
    "end": "1704900"
  },
  {
    "text": "notification or anything um as a result roughly 20 lenovo's one",
    "start": "1704900",
    "end": "1710539"
  },
  {
    "text": "year after the disclosure after back in 2020 we are still vulnerable to to this reference code um vulnerability",
    "start": "1710539",
    "end": "1717620"
  },
  {
    "text": "um so yeah um this slide has been outdated we are now at large roughly about more than 300",
    "start": "1717620",
    "end": "1724039"
  },
  {
    "text": "vulnerabilities in firmware um found we're only scratching the surface here uh even if this looks",
    "start": "1724039",
    "end": "1729620"
  },
  {
    "text": "doesn't look like it um especially if you look at the complexity and the amount of code and like the the kind of vulnerability I've",
    "start": "1729620",
    "end": "1737000"
  },
  {
    "text": "found here right this is not some crazy tight confusion data only vulnerabilities here right there's a",
    "start": "1737000",
    "end": "1742880"
  },
  {
    "text": "super basic stack Overflow Heap overflow in uh insufficient input validation stuff and this is part of this stuff",
    "start": "1742880",
    "end": "1749059"
  },
  {
    "text": "this is in the SMF right the highest privilege level on the system um so we are we are still finding like",
    "start": "1749059",
    "end": "1754700"
  },
  {
    "text": "the low-hanging fruits here and there's still a lot out there",
    "start": "1754700",
    "end": "1759820"
  },
  {
    "text": "um yes and maybe as a closure um we talked a lot about like AMD and",
    "start": "1760039",
    "end": "1765919"
  },
  {
    "text": "Intel um this the problem is not exclusively x86 related right because",
    "start": "1765919",
    "end": "1771440"
  },
  {
    "text": "arm also uses ufi now which means that vulnerabilities in for example ufi",
    "start": "1771440",
    "end": "1776659"
  },
  {
    "text": "reference code can cross different SSC vendor ecosystems and this happened for",
    "start": "1776659",
    "end": "1782840"
  },
  {
    "text": "example with one um this is this one here where there wasn't vulnerability in in the year five",
    "start": "1782840",
    "end": "1788480"
  },
  {
    "text": "arrival handling um and this what would allow this was vulnerability in x86 right but this also",
    "start": "1788480",
    "end": "1794539"
  },
  {
    "text": "happened in arm and it would allow me in arm systems to get into the like smm equivalent the the trust Zone and arm",
    "start": "1794539",
    "end": "1800179"
  },
  {
    "text": "and Export is via the same UF exploit um which is super interesting so now you not only have to look at all",
    "start": "1800179",
    "end": "1806120"
  },
  {
    "text": "vulnerabilities across the ecosystem and see okay what again what an attempt doesn't take a game with this new",
    "start": "1806120",
    "end": "1811640"
  },
  {
    "text": "vulnerability you also have to look at across different SOC vendors right what what new uh ability doesn't attack again",
    "start": "1811640",
    "end": "1818720"
  },
  {
    "text": "in the arm because they're still using this new reference the code in the uh new bug in the reference application of",
    "start": "1818720",
    "end": "1824299"
  },
  {
    "text": "UFO on debt for Photon Engine Systems right um makes it even worse",
    "start": "1824299",
    "end": "1829760"
  },
  {
    "text": "okay so maybe to close the talk um maybe a few other numbers um the vast majority of firmware that is",
    "start": "1829760",
    "end": "1836960"
  },
  {
    "text": "when the firmware service doesn't even have a nest bomb so even s-bombs are imperfect",
    "start": "1836960",
    "end": "1843260"
  },
  {
    "text": "um they're not even used more than half of them do not have in Security contact so even if you find a",
    "start": "1843260",
    "end": "1848659"
  },
  {
    "text": "problem you cannot tell them If You Against All Odds managed to tell them it will take them a year roughly to",
    "start": "1848659",
    "end": "1856760"
  },
  {
    "text": "patch that um best case right as you see with HP uh it takes a little bit more than a year",
    "start": "1856760",
    "end": "1863600"
  },
  {
    "text": "um it will maybe need another month or so um I talked about this a bit earlier uh previously boot guard",
    "start": "1863600",
    "end": "1870799"
  },
  {
    "text": "um other book half the machines don't have to correct error policy and bootcard setup which means that even if",
    "start": "1870799",
    "end": "1875899"
  },
  {
    "text": "boot gut is run and has everything set up correctly and it finds that there is a signature violation they will just",
    "start": "1875899",
    "end": "1881720"
  },
  {
    "text": "continue booting because there's no other policy configured um again half the machines that have an",
    "start": "1881720",
    "end": "1887299"
  },
  {
    "text": "IMU do not enable it every graphics card can just write over the counter text section if it wants to",
    "start": "1887299",
    "end": "1894080"
  },
  {
    "text": "um 10 of the machines out they have csme in manufacturing mode which means I can change any values in there right if I",
    "start": "1894080",
    "end": "1901820"
  },
  {
    "text": "know the protocols it's absolutely crazy to me um 60 do not have write protections on",
    "start": "1901820",
    "end": "1907100"
  },
  {
    "text": "the flash enabled which means because this Dixie phase is not really signed because it's from the secure Source I",
    "start": "1907100",
    "end": "1913399"
  },
  {
    "text": "can write it to the flash over the Dixies and get my code execution this way um and yeah one third of the csmes out",
    "start": "1913399",
    "end": "1920720"
  },
  {
    "text": "there have open critical vulnerabilities that are now patched because again people don't do firmware patches",
    "start": "1920720",
    "end": "1928820"
  },
  {
    "text": "and with this I say thank you and I'm happy to answer any questions",
    "start": "1928820",
    "end": "1934539"
  },
  {
    "text": "[Applause]",
    "start": "1934790",
    "end": "1941059"
  },
  {
    "text": "last talk on the last day anybody wants to go home",
    "start": "1944120",
    "end": "1949960"
  },
  {
    "text": "[Music]",
    "start": "1957360",
    "end": "1960530"
  },
  {
    "text": "which we should update um yes so it explores the debus",
    "start": "1966220",
    "end": "1973580"
  },
  {
    "text": "interface and there are gnome uis and I think here yet because I also got something where I say is oh hey there's",
    "start": "1973580",
    "end": "1980000"
  },
  {
    "text": "an update for you it's not going to just update your firmware as Windows update",
    "start": "1980000",
    "end": "1985220"
  },
  {
    "text": "for example they'll ask you but you can get notifications and say okay please update okay cool",
    "start": "1985220",
    "end": "1992500"
  },
  {
    "text": "thank you",
    "start": "1992659",
    "end": "1994720"
  },
  {
    "text": "okay thank you again thank you",
    "start": "1999380",
    "end": "2006419"
  }
]