[
  {
    "text": "what are we going to talk about today before we introduce ourselves talk about you know dlp in general talk about what",
    "start": "0",
    "end": "6870"
  },
  {
    "text": "we looked at just so you know that this is not a witch vendor is better talk like we're not endorsing any particular",
    "start": "6870",
    "end": "14009"
  },
  {
    "text": "vendor it's really more about bugs in security products kind of thing so that",
    "start": "14009",
    "end": "19170"
  },
  {
    "text": "you can make informed decisions about the things that you buy we'll talk a",
    "start": "19170",
    "end": "24660"
  },
  {
    "text": "little bit about what we did to these various products will talk about our",
    "start": "24660",
    "end": "31109"
  },
  {
    "text": "findings in each of them and then we will conclude with a question and answer I like the last 10 minutes of the talk",
    "start": "31109",
    "end": "37760"
  },
  {
    "text": "so who are we and why should you listen or not listen to us so I'm Zach linear",
    "start": "37760",
    "end": "45329"
  },
  {
    "text": "I'm a I am a director of research at a company called silence or like anti-malware in point security company",
    "start": "45329",
    "end": "55670"
  },
  {
    "text": "I'm old hats I've been around for a bit but most people don't know me which is",
    "start": "55670",
    "end": "61410"
  },
  {
    "text": "that's cool so I've done a lot of mobile mobile security research embedded security research open testing guy and a",
    "start": "61410",
    "end": "69930"
  },
  {
    "text": "co-author of the Android hacker's handbook it's a shameless plug and my co-presenter hi I'm Kelly Lum I am a",
    "start": "69930",
    "end": "77640"
  },
  {
    "text": "security engineer at tumblr I my background is not just all start up I",
    "start": "77640",
    "end": "83400"
  },
  {
    "text": "started out in government went into finance and then finally made my way into the tumblr world where you can if",
    "start": "83400",
    "end": "89759"
  },
  {
    "text": "you're not familiar or tumblr it's where you can get some of those really awesome animated gifts that you find their presentation there's a bird I don't know",
    "start": "89759",
    "end": "98189"
  },
  {
    "text": "yeah this morning when trying to edit a few slides I said Kelly what's your second bullet point that you want to",
    "start": "98189",
    "end": "104520"
  },
  {
    "text": "describe you and she just went there's a bird bird a bird so that's we just left",
    "start": "104520",
    "end": "110369"
  },
  {
    "text": "that in there i'm also a adjunct professor of application security at nyu-poly which is in Brooklyn for any of",
    "start": "110369",
    "end": "117840"
  },
  {
    "text": "you not familiar we have online courses so you know just a shameless plug there",
    "start": "117840",
    "end": "124399"
  },
  {
    "text": "so why did we choose to look at data loss perfect well why why is data loss prevention a thing to begin with right",
    "start": "124399",
    "end": "130830"
  },
  {
    "text": "so let's see let me try I'm trying to think around how long ago but it at least 10",
    "start": "130830",
    "end": "136180"
  },
  {
    "text": "years ago people started realizing that there was there was such a thing as security breaches that were a big deal",
    "start": "136180",
    "end": "143820"
  },
  {
    "text": "you know we in the security industry have known this for a long time but large organizations we're just starting",
    "start": "143820",
    "end": "150310"
  },
  {
    "text": "to realize that maybe having my information get farted out of my company",
    "start": "150310",
    "end": "156310"
  },
  {
    "text": "is not a good thing and I'd like to prevent that from happening and so how do you prevent doing that well you could",
    "start": "156310",
    "end": "162730"
  },
  {
    "text": "have do one thing which is have a good secure infrastructure just holistically across your entire organization or you",
    "start": "162730",
    "end": "169120"
  },
  {
    "text": "could find it find the ubiquitous or the mythical silver bullet that you can plop",
    "start": "169120",
    "end": "174580"
  },
  {
    "text": "into your network that just that will solve all of your theatre data loss or data leakage problems um DLP is usually",
    "start": "174580",
    "end": "183250"
  },
  {
    "text": "you know we will get a little bit into the kind of concept of bypasses and why we didn't really focus on them so much",
    "start": "183250",
    "end": "189010"
  },
  {
    "text": "but really DLP has kind of been touted as something that will keep honest people honest it'll keep somebody who's",
    "start": "189010",
    "end": "196090"
  },
  {
    "text": "doing data entry from accidentally copying and pasting sensitive information like social security numbers or credit card numbers into an email /",
    "start": "196090",
    "end": "203590"
  },
  {
    "text": "you know maybe prevent one of your developers from sharing source code with people outside the organization like",
    "start": "203590",
    "end": "208630"
  },
  {
    "text": "look at this cool function i wrote i put it on you know github or something so",
    "start": "208630",
    "end": "213700"
  },
  {
    "text": "that other people can use it if you don't want them to do that and you know",
    "start": "213700",
    "end": "218920"
  },
  {
    "text": "also maybe prevent or maybe help people to kind of know when data breaches occur so your database gets dumped and and",
    "start": "218920",
    "end": "228489"
  },
  {
    "text": "it's being a snuck out of your organization the whole files falling on the back of the truck kind of situation",
    "start": "228489",
    "end": "234970"
  },
  {
    "text": "there so why did we choose to look at dlp well one of the one of the points",
    "start": "234970",
    "end": "241120"
  },
  {
    "text": "that's not on here is this was actually initially Kelly's idea some time ago and",
    "start": "241120",
    "end": "246130"
  },
  {
    "text": "a couple years ago we started kind of digging into into this a little bit more because she was like hey we should look",
    "start": "246130",
    "end": "252970"
  },
  {
    "text": "at DLP um we were really curious about the attack surface uh that's introduced by DLP products much like if you've ever",
    "start": "252970",
    "end": "259630"
  },
  {
    "text": "seen you know we've seen stories about antivirus software and it you know and management",
    "start": "259630",
    "end": "267289"
  },
  {
    "text": "interfaces around that being actually it you know increasing attack surface uh",
    "start": "267289",
    "end": "272300"
  },
  {
    "text": "having privilege escalation vulnerabilities inside of them you know antivirus agent and in point security",
    "start": "272300",
    "end": "278900"
  },
  {
    "text": "agents and things like that as well as the reliability of dlp like like we kind",
    "start": "278900",
    "end": "284060"
  },
  {
    "text": "of alluded to by passes or that's cool but anyone can bypass DOP that's that's",
    "start": "284060",
    "end": "289789"
  },
  {
    "text": "that's pretty easy easy but how how robust are these are these security",
    "start": "289789",
    "end": "295880"
  },
  {
    "text": "products like I kind of mentioned just a second ago uh these these in these DLP",
    "start": "295880",
    "end": "303229"
  },
  {
    "text": "agents that reside on the endpoint or the crawl a database or that are an appliance that often times highly",
    "start": "303229",
    "end": "310610"
  },
  {
    "text": "privileged or have a very very advantageous position to monitor the network monitor traffic to interact with",
    "start": "310610",
    "end": "317599"
  },
  {
    "text": "databases interact with email servers things of that nature so if they do get compromised suffice to say that's really",
    "start": "317599",
    "end": "325000"
  },
  {
    "text": "good for me is the attacker right I mean now I have if I can compromise your IDs",
    "start": "325000",
    "end": "330740"
  },
  {
    "text": "or your DLP appliance then I can watch all the things that that can watch",
    "start": "330740",
    "end": "336310"
  },
  {
    "text": "testing the security of security products is a hue very very very",
    "start": "336310",
    "end": "341659"
  },
  {
    "text": "interesting thing for the both of us I'm sure some of you probably feel the same way we both have spent time in Brooklyn",
    "start": "341659",
    "end": "350000"
  },
  {
    "text": "and we love our tea I guess right right right and oftentimes big vendors will",
    "start": "350000",
    "end": "356240"
  },
  {
    "text": "buy smaller vendors integrate them into their into their portfolio their product offerings and then they just kind of",
    "start": "356240",
    "end": "362659"
  },
  {
    "text": "shelf then they put them out to pasture and they just sort of rot there so updates and security fixes and things",
    "start": "362659",
    "end": "369680"
  },
  {
    "text": "things like that don't really they don't really happen so so we would be remiss",
    "start": "369680",
    "end": "378289"
  },
  {
    "text": "not to mention some other people who've done this type of research before secure OSIS analyst firm that has done a lot of",
    "start": "378289",
    "end": "386659"
  },
  {
    "text": "research into DLP from the deployment side really more of the the other kind",
    "start": "386659",
    "end": "391820"
  },
  {
    "text": "of baked off like how to how to properly do this how to properly select",
    "start": "391820",
    "end": "397230"
  },
  {
    "text": "dlp vendor and how to correctly use them in your enterprise defeating DLP by a",
    "start": "397230",
    "end": "405300"
  },
  {
    "text": "modest ah no of excellent excellent presentation black hat us a many years",
    "start": "405300",
    "end": "410700"
  },
  {
    "text": "ago if you haven't seen that near kind of in the DLP market for some reason I",
    "start": "410700",
    "end": "416250"
  },
  {
    "text": "would strongly recommend it there's another presentation at Def Con a while",
    "start": "416250",
    "end": "421320"
  },
  {
    "text": "back about using using open DLP an open-source GOP product for more of an offensive attack scenario like using the",
    "start": "421320",
    "end": "429870"
  },
  {
    "text": "using open do p to actually steal data and there have been many others so I'm too many to list obvi and of course",
    "start": "429870",
    "end": "436080"
  },
  {
    "text": "we've done this a couple times now so uh just to kind of summarize what like the",
    "start": "436080",
    "end": "443790"
  },
  {
    "text": "general architecture of most DLP products and this is probably not an unfamiliar diagram to anyone who's ever",
    "start": "443790",
    "end": "449760"
  },
  {
    "text": "used a computer on a network before but typically there's some sort of",
    "start": "449760",
    "end": "454800"
  },
  {
    "text": "management server you know there might be a network monitoring appliance like white we mentioned you know an endpoint",
    "start": "454800",
    "end": "460800"
  },
  {
    "text": "agent there might be an agent that sits on the mail server itself you know something that integrates with exchange",
    "start": "460800",
    "end": "466890"
  },
  {
    "text": "or with Domino or what have you there might be an agent that sits on a",
    "start": "466890",
    "end": "471990"
  },
  {
    "text": "database server or crawls interacts with the database to look for sensitive data that you know if data is not encrypted",
    "start": "471990",
    "end": "478230"
  },
  {
    "text": "or what have you some of them might also actually reside on your web filter so you know if you have a proxy at the",
    "start": "478230",
    "end": "485700"
  },
  {
    "text": "perimeter that you know proxies all web traffic and filters that DLP some DLP products will integrate with that and of",
    "start": "485700",
    "end": "492420"
  },
  {
    "text": "course they send push policies and configurations down to these various",
    "start": "492420",
    "end": "497870"
  },
  {
    "text": "these various devices and alerts are typically sent back up to the management server where you get your cool little",
    "start": "497870",
    "end": "503850"
  },
  {
    "text": "crystal reports so kind of dig down a little bit further into how most EOP",
    "start": "503850",
    "end": "512310"
  },
  {
    "text": "products are actually structured on the device itself so some sort of policy database you know there for an endpoint",
    "start": "512310",
    "end": "520620"
  },
  {
    "text": "such as like a Windows machine or you know linux machine or iOS 10 machine where the agent is there's typically",
    "start": "520620",
    "end": "526620"
  },
  {
    "text": "most of them have some sort of clipboard monitor a way to hook into the clipboard to make sure you're not being and pasting you know a credit card",
    "start": "526620",
    "end": "533279"
  },
  {
    "text": "number or some sort of personally identifiable information oftentimes",
    "start": "533279",
    "end": "539010"
  },
  {
    "text": "they'll have a removable device monitor so a thing that make sure you're not putting that sensitive file onto a USB",
    "start": "539010",
    "end": "545279"
  },
  {
    "text": "thumb drive and and then most of them have go into a you know document and",
    "start": "545279",
    "end": "551279"
  },
  {
    "text": "file specific sort of parsing right so you know that could be a real time that",
    "start": "551279",
    "end": "556380"
  },
  {
    "text": "could be from something that crawls the file system and then those typically have some sort of format specific parser",
    "start": "556380",
    "end": "561720"
  },
  {
    "text": "you know some markup language office document just plain text what have you",
    "start": "561720",
    "end": "567200"
  },
  {
    "text": "the ones that also do actually look at network traffic obviously that will",
    "start": "567200",
    "end": "573360"
  },
  {
    "text": "typically install some sort of network driver have some sort of way to monitor the interface and then maybe where",
    "start": "573360",
    "end": "580260"
  },
  {
    "text": "possible actually analyze and parse specific protocols so HTTP making sure that you're not downloading or uploading",
    "start": "580260",
    "end": "586730"
  },
  {
    "text": "something that has VII or some sort of sensitive data they might have a local",
    "start": "586730",
    "end": "593399"
  },
  {
    "text": "to the endpoint some sort of like an SMTP or mail monitoring some of them will parse skype skype messages things",
    "start": "593399",
    "end": "600149"
  },
  {
    "text": "like that and whatever the result of that that sort of a process is typically goes down into some sort of you know",
    "start": "600149",
    "end": "607140"
  },
  {
    "text": "abstract inspection engine something that actually applies all the rules based on some policy that the",
    "start": "607140",
    "end": "612779"
  },
  {
    "text": "administrator set and then you know enforcement decisions might be made don't allow me to copy that thing you",
    "start": "612779",
    "end": "621120"
  },
  {
    "text": "know don't don't allow me to upload that file and the results of that will",
    "start": "621120",
    "end": "626250"
  },
  {
    "text": "typically go into some reporting engine somewhere either locally or on that on the the management server so an example",
    "start": "626250",
    "end": "632790"
  },
  {
    "text": "of a workflow right so the previous slide was kind of how it works under the hood and this is sort of showing how the",
    "start": "632790",
    "end": "640410"
  },
  {
    "text": "user or the administrator would interface with this product apologize",
    "start": "640410",
    "end": "645600"
  },
  {
    "text": "it's a little hard to see but we'll go through it so at the top you're going to define your data identifier basically",
    "start": "645600",
    "end": "652769"
  },
  {
    "text": "tell the system how you want what you want to look for some organizations you may be worried about credit card numbers",
    "start": "652769",
    "end": "659130"
  },
  {
    "text": "Social Security numbers some organizations you may be worried about source code you may be worried about maybe certain",
    "start": "659130",
    "end": "668240"
  },
  {
    "text": "metadata words like classified top secret and you're going to also select",
    "start": "668240",
    "end": "676380"
  },
  {
    "text": "file attributes so are you looking at word documents are you looking at dot PHP files are you looking into sort of",
    "start": "676380",
    "end": "683850"
  },
  {
    "text": "the metadata of images like the exif data or what that once you create your data identifier then you can create a",
    "start": "683850",
    "end": "691050"
  },
  {
    "text": "template where you take those identifiers maybe you want to kind of put put them into different categories",
    "start": "691050",
    "end": "696120"
  },
  {
    "text": "and so you can apply a subset of those data identifier to a particular policy when you create the policy you're going",
    "start": "696120",
    "end": "703230"
  },
  {
    "text": "to identify your target are you going to be looking at this on your you know let's if you go to the previous example",
    "start": "703230",
    "end": "708839"
  },
  {
    "text": "where we said you can look at mail servers you can look at web servers you can look at people's laptops desktops so",
    "start": "708839",
    "end": "716430"
  },
  {
    "text": "say where do you want this policy to be enforced what particular devices and",
    "start": "716430",
    "end": "722160"
  },
  {
    "text": "what channels do you want to monitor a certain network traffic maybe you're concerned more about HTTP FTP maybe",
    "start": "722160",
    "end": "728790"
  },
  {
    "text": "you're concerned more about imap p 0 p and then select the template that you've",
    "start": "728790",
    "end": "733980"
  },
  {
    "text": "designated before the what you want to apply to those targets to that to those",
    "start": "733980",
    "end": "741360"
  },
  {
    "text": "channels and then what's the action you want to do you know you can either log it let it go through maybe you want to",
    "start": "741360",
    "end": "747600"
  },
  {
    "text": "block it and how would you want to walk it you want to block it silently so the user doesn't know or the person",
    "start": "747600",
    "end": "752880"
  },
  {
    "text": "committing the action doesn't know that it's been blocked and just thinks something failed do you want to pop up a message say tis pics don't do that you",
    "start": "752880",
    "end": "759390"
  },
  {
    "text": "know it really depends on what your sort of endgame is then you're going to you",
    "start": "759390",
    "end": "764970"
  },
  {
    "text": "know click the magic button that deploys the policy to the end points where you want it to live and then monitoring that",
    "start": "764970",
    "end": "770910"
  },
  {
    "text": "that policy will start to run and monitoring will take place either in some sort of logging of system syslog",
    "start": "770910",
    "end": "778200"
  },
  {
    "text": "splunk whatever and then also a method for reporting so this is a pretty",
    "start": "778200",
    "end": "784230"
  },
  {
    "text": "standard workflow despite the fact that it specifically says Trend Micro so if you work for Trend Micro we're not",
    "start": "784230",
    "end": "789240"
  },
  {
    "text": "calling you like lame or anything is not an endorsement or an indictment of turn right right um and and one other note",
    "start": "789240",
    "end": "796500"
  },
  {
    "text": "here reason that we kind of go through this as dry as it seems this part is these are all the areas each step in the",
    "start": "796500",
    "end": "802920"
  },
  {
    "text": "workflow from more of an offensive standpoint are exactly the things that we're thinking of okay well how are they",
    "start": "802920",
    "end": "808140"
  },
  {
    "text": "parsing configuration how are they doing deployments how is their regular expression matching for 4 profiles that",
    "start": "808140",
    "end": "816120"
  },
  {
    "text": "they're looking at things like that how are they logging right so you can actually look at each point on this",
    "start": "816120",
    "end": "821310"
  },
  {
    "text": "little flow chart as a particular place where security could have a breakdown so",
    "start": "821310",
    "end": "827130"
  },
  {
    "text": "what did we look at and this is a I didn't have time to remove this no one going to get the joke it's a Saturday",
    "start": "827130",
    "end": "832680"
  },
  {
    "text": "Night Live thing in the US but it's you know it's target lady it's a store in the US and other places probably so our",
    "start": "832680",
    "end": "840600"
  },
  {
    "text": "first our first round this was like when we first started doing this research so some of these and the results that are",
    "start": "840600",
    "end": "846090"
  },
  {
    "text": "here in for these products is a little older but you'll kind of get get the idea so we looked at trend micro there",
    "start": "846090",
    "end": "853980"
  },
  {
    "text": "dlp management appliance their end point agent we looked at sophos from a few",
    "start": "853980",
    "end": "860070"
  },
  {
    "text": "different angles of a you know unified threat management appliance we looked at their console and their end point agent",
    "start": "860070",
    "end": "866820"
  },
  {
    "text": "which is actually really just their their antivirus software for web since they also have a centralized management",
    "start": "866820",
    "end": "872070"
  },
  {
    "text": "server referred to as Triton they're now called force point so in this is you can",
    "start": "872070",
    "end": "877380"
  },
  {
    "text": "tell how this is a you know year or so they're in point agent there they're",
    "start": "877380",
    "end": "883530"
  },
  {
    "text": "appliance their protector appliance which actually is a virtual appliance that runs linux as most of them do and",
    "start": "883530",
    "end": "889440"
  },
  {
    "text": "then for good measure opens good ole open source project called open dlp so",
    "start": "889440",
    "end": "898230"
  },
  {
    "text": "to kind of break these down into into their constituent parts okay so first we",
    "start": "898230",
    "end": "904740"
  },
  {
    "text": "will go through trend micro which we have already seen a little bit of a taste of so trend micro with primarily",
    "start": "904740",
    "end": "910160"
  },
  {
    "text": "windows we have our windows endpoint agent which is going to do your monitoring in your policy enforcement",
    "start": "910160",
    "end": "917030"
  },
  {
    "text": "the interesting thing about trend micro the agent is it actually acts its",
    "start": "917030",
    "end": "922680"
  },
  {
    "text": "behavior is similar to rootkits in that you install it and it kind of hides itself I guess the justification they're",
    "start": "922680",
    "end": "928620"
  },
  {
    "text": "not that I can read the minds of people at trend micro is that you know if somebody is actively",
    "start": "928620",
    "end": "933660"
  },
  {
    "text": "trying to hobble the dlp it would make",
    "start": "933660",
    "end": "939540"
  },
  {
    "text": "it different more difficult for them to do but it's also a little bit concerning because if there is an issue with the",
    "start": "939540",
    "end": "944730"
  },
  {
    "text": "agent that's going to make it a lot a lot harder to observe there's also",
    "start": "944730",
    "end": "950910"
  },
  {
    "text": "network agent it's a virtual appliance and you use that obviously to monitor network traffic and there's also a a",
    "start": "950910",
    "end": "958589"
  },
  {
    "text": "crawler it's a remote crawler and that's for digital assets for machines that are",
    "start": "958589",
    "end": "963690"
  },
  {
    "text": "not on the corporate network the management server is another virtual",
    "start": "963690",
    "end": "969690"
  },
  {
    "text": "appliance it's linux based and so the management server is always going to talk to all of these components that are",
    "start": "969690",
    "end": "975209"
  },
  {
    "text": "listed before deploy policies set up configurations actions and logging so",
    "start": "975209",
    "end": "984990"
  },
  {
    "text": "web since their management service called Triton like mentioned it's it",
    "start": "984990",
    "end": "991680"
  },
  {
    "text": "actually uses Microsoft sequel server so it's that's its database back in but you need a dedicated Windows machine to run",
    "start": "991680",
    "end": "997890"
  },
  {
    "text": "it and it actually runs coyote so Apache coyote so they're using all sorts of",
    "start": "997890",
    "end": "1003560"
  },
  {
    "text": "like fun Java things which never goes wrong um like kind of mention in the",
    "start": "1003560",
    "end": "1010220"
  },
  {
    "text": "chart earlier you know pretty typical they all have Windows OS 10 and Linux",
    "start": "1010220",
    "end": "1015529"
  },
  {
    "text": "endpoint agents additionally they are so pretty much for every one of these and",
    "start": "1015529",
    "end": "1021620"
  },
  {
    "text": "I'm going to we're going to mention this multiple times all of the endpoint agents especially for windows will install some sort of file some sort of",
    "start": "1021620",
    "end": "1028640"
  },
  {
    "text": "like file file and network drivers the hook clip board etc their protector",
    "start": "1028640",
    "end": "1035209"
  },
  {
    "text": "appliance their network monitoring appliance is virtual appliance based on linux it has a restricted admin shell no",
    "start": "1035209",
    "end": "1043250"
  },
  {
    "text": "we did not break out of it we ran out of time um much like Trend Micro they also",
    "start": "1043250",
    "end": "1049429"
  },
  {
    "text": "have a crawler agent which can talk to you databases can talk to remote file systems etc to kind of in the background",
    "start": "1049429",
    "end": "1056419"
  },
  {
    "text": "look for documents with sensitive data in them so posts there",
    "start": "1056419",
    "end": "1064390"
  },
  {
    "text": "a prize console it's kelly did more on",
    "start": "1064390",
    "end": "1069910"
  },
  {
    "text": "there right so one of the things that we kind of seen as a common trend and this is one of the things that kind of set",
    "start": "1069910",
    "end": "1075970"
  },
  {
    "text": "sofas apart is the management console is basically a windows and old windows",
    "start": "1075970",
    "end": "1081370"
  },
  {
    "text": "operating system with the management software living inside of it so you're actually getting a copy of windows that",
    "start": "1081370",
    "end": "1089440"
  },
  {
    "text": "you're that's that's the other one is the bad one we don't talk oh the the",
    "start": "1089440",
    "end": "1094750"
  },
  {
    "text": "enterprise management console primarily dotnet and we'll get into a little bit of what problems arose from their usage",
    "start": "1094750",
    "end": "1102430"
  },
  {
    "text": "of dotnet the endpoint security is a sort of a bundled solution where you get",
    "start": "1102430",
    "end": "1108220"
  },
  {
    "text": "kind of get all of your little security top hits antivirus and dlp and",
    "start": "1108220",
    "end": "1113970"
  },
  {
    "text": "firewalling kind of functionality those are available for Windows OS X and Linux",
    "start": "1113970",
    "end": "1119170"
  },
  {
    "text": "so pretty standard Oh buddy Oh p you can download it as a virtual appliance or",
    "start": "1119170",
    "end": "1125620"
  },
  {
    "text": "you can install it I wouldn't do that at all ever like don't even run the virtual",
    "start": "1125620",
    "end": "1131620"
  },
  {
    "text": "appliance spoiler alert it's Apache with a lot of pearl I don't care for pearl I",
    "start": "1131620",
    "end": "1139210"
  },
  {
    "text": "know someone give a pearl talk that was probably really good but I don't like pearl and then they have their own they have a windows agent and they also have",
    "start": "1139210",
    "end": "1146920"
  },
  {
    "text": "a perl-compatible regular expressions or pcre based a document parser and they",
    "start": "1146920",
    "end": "1153370"
  },
  {
    "text": "also have a filesystem crawler it can actually use on as I said sshfs to connect to non Windows machines to crawl",
    "start": "1153370",
    "end": "1162430"
  },
  {
    "text": "all all your all your documents and for some reason there are metasploit modules",
    "start": "1162430",
    "end": "1168970"
  },
  {
    "text": "that are not like actual exploitation modules they're like to use open dlp in some way I don't know why but that",
    "start": "1168970",
    "end": "1176620"
  },
  {
    "text": "exists so one thing and then the first for a couple of them that we noticed",
    "start": "1176620",
    "end": "1183420"
  },
  {
    "text": "there's this thing called key view is anyone familiar with key view raise your hand if you're familiar with key of you",
    "start": "1183420",
    "end": "1188890"
  },
  {
    "text": "you don't have to admit it okay well there's this key view is um it's by HP",
    "start": "1188890",
    "end": "1196210"
  },
  {
    "text": "autonomy their autonomy division they purchased it some time ago and it showed up a lot so this key view or que vous binary uh",
    "start": "1196210",
    "end": "1204310"
  },
  {
    "text": "it's it kept showing up and it's used from what we what we gathered based on our analysis um it's used to basically",
    "start": "1204310",
    "end": "1212960"
  },
  {
    "text": "take a bunch of different document formats disparate formats like word markup languages binary formats etc and",
    "start": "1212960",
    "end": "1219890"
  },
  {
    "text": "sort of normalize them and filter them down into and to sort of a standard abstract representation so that other",
    "start": "1219890",
    "end": "1227180"
  },
  {
    "text": "filter rules can be applied and this this is not just unique to dlp it's used in big data analytics platforms it's",
    "start": "1227180",
    "end": "1234080"
  },
  {
    "text": "used in messaging servers so like domino lotus domino uses it so what was",
    "start": "1234080",
    "end": "1242540"
  },
  {
    "text": "interesting about this was just here's like an example this EP classifier and web since spawned like a ton of these",
    "start": "1242540",
    "end": "1248720"
  },
  {
    "text": "que vous processes so this was like on the the windows endpoint for web since kept spawning those and then on their",
    "start": "1248720",
    "end": "1255470"
  },
  {
    "text": "appliance I know it's very hard to read I'm sorry but a like policy engine a process would then spawn a bunch of",
    "start": "1255470",
    "end": "1262010"
  },
  {
    "text": "these cable processes so if you were",
    "start": "1262010",
    "end": "1267530"
  },
  {
    "text": "interested in finding bugs that would be the place to look like if you if you",
    "start": "1267530",
    "end": "1273920"
  },
  {
    "text": "were like super duper interested in finding a bug that affected a variety of platforms I'm that's your homework go do",
    "start": "1273920",
    "end": "1279500"
  },
  {
    "text": "it just just saying we don't have any sorry so now on to the second round of",
    "start": "1279500",
    "end": "1287450"
  },
  {
    "text": "targets for for legal reasons and PR",
    "start": "1287450",
    "end": "1292580"
  },
  {
    "text": "reasons and if my PR people are watching this and very sorry we had to change the",
    "start": "1292580",
    "end": "1300050"
  },
  {
    "text": "names of the second round of vendors so",
    "start": "1300050",
    "end": "1305140"
  },
  {
    "text": "that's that's really all I'll say so the second round of hinders this is before",
    "start": "1305140",
    "end": "1311570"
  },
  {
    "text": "we ate in finding so we called them alpha Bravo Charlie and dingus so just",
    "start": "1311570",
    "end": "1318860"
  },
  {
    "text": "just so you know that's we're going to refer to them as such alpha for instance",
    "start": "1318860",
    "end": "1325520"
  },
  {
    "text": "also had a linux-based virtual appliance windows-based endpoint agent Bravo very similar there's was a windows",
    "start": "1325520",
    "end": "1333299"
  },
  {
    "text": "management server that you had to install on your your windows your Windows host OS Sinan windows in point",
    "start": "1333299",
    "end": "1341730"
  },
  {
    "text": "agents Charlie again very similar Linux management appliance Windows Linux knows",
    "start": "1341730",
    "end": "1348539"
  },
  {
    "text": "10 in point agents and then finally our favorite hypothetical company",
    "start": "1348539",
    "end": "1354230"
  },
  {
    "text": "hypothetical company called dingus they had asus you know console virtual",
    "start": "1354230",
    "end": "1360150"
  },
  {
    "text": "appliance they had their network virtual appliance and a windows-based in point",
    "start": "1360150",
    "end": "1365669"
  },
  {
    "text": "agent so to kind of break those down start with alpha okay alpha dlp alpha",
    "start": "1365669",
    "end": "1372510"
  },
  {
    "text": "dlp was extremely interesting to me it was if anyone's familiar most people are",
    "start": "1372510",
    "end": "1378690"
  },
  {
    "text": "probably familiar with the Mary Shelley Shelley a book Frankenstein it was sort",
    "start": "1378690",
    "end": "1383789"
  },
  {
    "text": "of a Frankenstein's monster of a lot of technologies that you know not to sound",
    "start": "1383789",
    "end": "1389309"
  },
  {
    "text": "overly negative but things that in general the trends i see that information security people tend to hate",
    "start": "1389309",
    "end": "1395909"
  },
  {
    "text": "on so what are some things that I don't like I hate it when somebody takes or a",
    "start": "1395909",
    "end": "1401490"
  },
  {
    "text": "company takes in open source product and then acquires it and then closes off the source just I like to open source I like",
    "start": "1401490",
    "end": "1409140"
  },
  {
    "text": "the I like the transparency of it so this is this kind of sticks in my craw their admin panel entirely written in",
    "start": "1409140",
    "end": "1416820"
  },
  {
    "text": "flash we've never had security problems with flash but I'm kind of I'm you know",
    "start": "1416820",
    "end": "1422520"
  },
  {
    "text": "I'm looking at my crystal ball and I'm sure there's that that we're going to find some in the future the windows",
    "start": "1422520",
    "end": "1427770"
  },
  {
    "text": "agent a smaller but also equally kind of disturbing Frankenstein of I guess they",
    "start": "1427770",
    "end": "1435270"
  },
  {
    "text": "just kind of picked up every or picked a handful languages and threw them against",
    "start": "1435270",
    "end": "1440490"
  },
  {
    "text": "the wall to see what fit because there's a lot of different components which is you know good modular code is good but",
    "start": "1440490",
    "end": "1446460"
  },
  {
    "text": "it's a combination of John net Java and airline I Java and.net are sort of like",
    "start": "1446460",
    "end": "1455100"
  },
  {
    "text": "I don't know that people have seen like the Batman vs Superman movie I heard it",
    "start": "1455100",
    "end": "1461130"
  },
  {
    "text": "wasn't very good but dotnet and Java kind of mine me Batman vs Superman they also use the",
    "start": "1461130",
    "end": "1466800"
  },
  {
    "text": "adobe technology action message format so going back to our little their little",
    "start": "1466800",
    "end": "1471900"
  },
  {
    "text": "flash fandom they're using that for their communications also just a very interesting choice and we'll we'll get",
    "start": "1471900",
    "end": "1480870"
  },
  {
    "text": "into you know what would some of this what's what problems turned up because of this so Bravo dlp this is this is",
    "start": "1480870",
    "end": "1491370"
  },
  {
    "text": "kind of different uh than than most of the others so they this actually gonna",
    "start": "1491370",
    "end": "1496890"
  },
  {
    "text": "set Bravo apart they actually use the MMC so windows management micro Microsoft management console snap in so",
    "start": "1496890",
    "end": "1504330"
  },
  {
    "text": "explain why that's significant when we get into some of the findings but the uses Microsoft sequel server for the",
    "start": "1504330",
    "end": "1511530"
  },
  {
    "text": "back end so again you have to install it on a existing Windows machine dedicated",
    "start": "1511530",
    "end": "1517350"
  },
  {
    "text": "database if you want whatever they also had a separate service that was there like content monitoring service so that",
    "start": "1517350",
    "end": "1523440"
  },
  {
    "text": "was like their crawler it would go out and kind of look for um look for",
    "start": "1523440",
    "end": "1529290"
  },
  {
    "text": "documents is that what it's their crawler basically a Windows endpoint agent installed a ton of ton of drivers",
    "start": "1529290",
    "end": "1535200"
  },
  {
    "text": "so all sorts of network drivers in dis and TDI file system drivers so a lot of",
    "start": "1535200",
    "end": "1540210"
  },
  {
    "text": "that if you haven't picked up on this a lot of the operations related to monitoring files very similar like antivirus right and sort of you know",
    "start": "1540210",
    "end": "1548960"
  },
  {
    "text": "clipboard hooks things like that they're endpoint agent it was similar to the",
    "start": "1548960",
    "end": "1555360"
  },
  {
    "text": "windows agent but not on a not feature not feature parity they they didn't they",
    "start": "1555360",
    "end": "1563340"
  },
  {
    "text": "didn't really do all of the network network monitoring stuff and the clipboard operations were sort of",
    "start": "1563340",
    "end": "1569280"
  },
  {
    "text": "slipshod it uses a lot of a open source and free libraries especially on the OS",
    "start": "1569280",
    "end": "1577380"
  },
  {
    "text": "10 agent which is funny for example boost if you're familiar at all with",
    "start": "1577380",
    "end": "1582870"
  },
  {
    "text": "like C++ development I'm sorry but uh also free DC each DC RPC library so that",
    "start": "1582870",
    "end": "1591390"
  },
  {
    "text": "the OS 10 endpoint agent can do windows communication thingies our PC communications Charlie DLP yet",
    "start": "1591390",
    "end": "1601130"
  },
  {
    "text": "another virtual appliance linux windows in point agent same exact thing as all the others clipboard monitor file",
    "start": "1601130",
    "end": "1608120"
  },
  {
    "text": "monitor had a particular affinity for monitoring URLs that were being open in",
    "start": "1608120",
    "end": "1616430"
  },
  {
    "text": "various browsers the endpoint they also about Linux agent the 40 boon to slash Debian so you know had to be 41 of those",
    "start": "1616430",
    "end": "1623980"
  },
  {
    "text": "distributions they had this like really Jenky a like notification tray for the",
    "start": "1623980",
    "end": "1632150"
  },
  {
    "text": "weather the agent was working but it didn't really do anything so I don't know it's kind of like a second-class",
    "start": "1632150",
    "end": "1637190"
  },
  {
    "text": "citizen for them we don't really look at their OS n in point agent but they also",
    "start": "1637190",
    "end": "1642860"
  },
  {
    "text": "did a bunch of MDM like mobile device management and you iod type stuff we did really look at that but you know that's",
    "start": "1642860",
    "end": "1649610"
  },
  {
    "text": "um that's a feature and then finally dingus which is something that came to",
    "start": "1649610",
    "end": "1656750"
  },
  {
    "text": "us in a fever dream one night yeah this is totally a hypothetical company that doesn't actually exist for legal reasons",
    "start": "1656750",
    "end": "1662330"
  },
  {
    "text": "um another virtual appliance there's is actually sent off space so that you'll",
    "start": "1662330",
    "end": "1667940"
  },
  {
    "text": "understand the significance of that later you know network appliance as well also cintas based has options to do in",
    "start": "1667940",
    "end": "1675110"
  },
  {
    "text": "line can sit off of a span port or can proxy using squid good ol squid there in",
    "start": "1675110",
    "end": "1683750"
  },
  {
    "text": "point agent Saint you know the usual exact same thing as everyone else so so",
    "start": "1683750",
    "end": "1689810"
  },
  {
    "text": "what did what did we do before to find I know everyone's looking for the juicy",
    "start": "1689810",
    "end": "1694880"
  },
  {
    "text": "bits but we have to talk about science first so our methodology pretty you know",
    "start": "1694880",
    "end": "1702800"
  },
  {
    "text": "we applied a lot of the same rules to two different to the appliances and",
    "start": "1702800",
    "end": "1708080"
  },
  {
    "text": "stuff look at how they parse documents that are traversing the network look at",
    "start": "1708080",
    "end": "1713870"
  },
  {
    "text": "how the parsing can or you know their local how do they parse configuration",
    "start": "1713870",
    "end": "1719870"
  },
  {
    "text": "files you know before matter that using how our configs and updates being",
    "start": "1719870",
    "end": "1725240"
  },
  {
    "text": "deployed are they you know are they signing configuration updates are they signing",
    "start": "1725240",
    "end": "1733980"
  },
  {
    "text": "packages that are being applied to the appliance etc from the operating system level how do they harden the appliance",
    "start": "1733980",
    "end": "1741250"
  },
  {
    "text": "does it come out of the gate sort of locked down our exploit you know exploit",
    "start": "1741250",
    "end": "1746860"
  },
  {
    "text": "mitigation baseline exploit mitigations turn on did they go above and beyond that um the endpoints kind of same thing",
    "start": "1746860",
    "end": "1754690"
  },
  {
    "text": "for parsing uh you know trying to but you know file fuzzing is obviously a big",
    "start": "1754690",
    "end": "1761290"
  },
  {
    "text": "thing there but it's very uh very taxing it takes a lot of a lot of time if you",
    "start": "1761290",
    "end": "1766900"
  },
  {
    "text": "want to do it right which I don't again update and deployment mechanisms how are",
    "start": "1766900",
    "end": "1772240"
  },
  {
    "text": "they are they are they getting their updates configuration updates for their",
    "start": "1772240",
    "end": "1777520"
  },
  {
    "text": "drivers especially on the windows side I'm actually doing things like I octyl fuzzing because if we can you know",
    "start": "1777520",
    "end": "1784900"
  },
  {
    "text": "drivers exist in a very interesting place in the kernel that would be good to have have a foothold on a working you",
    "start": "1784900",
    "end": "1793180"
  },
  {
    "text": "know exploit how did they also do a network network protocol parsing are",
    "start": "1793180",
    "end": "1800290"
  },
  {
    "text": "they can we can we do Justin to basic protocol fuzzing and get get things to",
    "start": "1800290",
    "end": "1806440"
  },
  {
    "text": "crash we can I the management server and also also for the network clients as well for the ones that have this option",
    "start": "1806440",
    "end": "1812310"
  },
  {
    "text": "looking at how the web's the web server the web application is configured like a",
    "start": "1812310",
    "end": "1817450"
  },
  {
    "text": "wasp opt-in type stuff you yeah you'll be surprised soon or not I don't know",
    "start": "1817450",
    "end": "1824010"
  },
  {
    "text": "database if the management server had a database package with it if it was a virtual appliance did they lock that",
    "start": "1824010",
    "end": "1829720"
  },
  {
    "text": "down correctly are they actually allowing remote connections how are they",
    "start": "1829720",
    "end": "1835420"
  },
  {
    "text": "storing sensitive data and then of course again the operating system of if it's a virtual appliance kind of",
    "start": "1835420",
    "end": "1841360"
  },
  {
    "text": "applying the same sort of routine there excuse me",
    "start": "1841360",
    "end": "1848730"
  },
  {
    "text": "okay this is what you are this is what you wanted okay just just before we get into it these have been reported the",
    "start": "1849490",
    "end": "1855610"
  },
  {
    "text": "vendor and as far as we know there are no odea in this in this presentation so apologies not in it but still stuff",
    "start": "1855610",
    "end": "1863620"
  },
  {
    "text": "correct alright so in terms of general observations we noticed that on the",
    "start": "1863620",
    "end": "1869740"
  },
  {
    "text": "Linux appliances it really kind of was baseline install they didn't most of the",
    "start": "1869740",
    "end": "1875230"
  },
  {
    "text": "examples we seen didn't really go out of their way to kind of hardened things you know in terms of making not using",
    "start": "1875230",
    "end": "1881679"
  },
  {
    "text": "default you know passwords on things or blank password it's not segmenting",
    "start": "1881679",
    "end": "1888280"
  },
  {
    "text": "things into users and groups with lockdown privileges so many of the",
    "start": "1888280",
    "end": "1893350"
  },
  {
    "text": "services were running as routes we didn't see any sort of extra exploit",
    "start": "1893350",
    "end": "1899650"
  },
  {
    "text": "mitigation but beyond what the operating system did by default so you know turning on things like Ansel are there",
    "start": "1899650",
    "end": "1907840"
  },
  {
    "text": "was also a the endpoint agents offer remember we said before is that these",
    "start": "1907840",
    "end": "1913000"
  },
  {
    "text": "things are very advantageous and they have to be just so that they can give you the functionality that you expect out of the product but one of the things",
    "start": "1913000",
    "end": "1919809"
  },
  {
    "text": "that we notice is that the endpoint agent software was also running with very very high privileges either as root",
    "start": "1919809",
    "end": "1926170"
  },
  {
    "text": "or local system rather than running maybe as the privilege of the logged in user or running as its own user that has",
    "start": "1926170",
    "end": "1931929"
  },
  {
    "text": "privileged to do whatever it needs to do monitor network traffic okay look at",
    "start": "1931929",
    "end": "1938410"
  },
  {
    "text": "files on the file system you'll probably if you want an endpoint agent that's on let's say a you know a user's box like a",
    "start": "1938410",
    "end": "1945880"
  },
  {
    "text": "laptop or a desktop probably don't do your network monitoring there and just general abusive security best practices",
    "start": "1945880",
    "end": "1952990"
  },
  {
    "text": "the things that we learned you know when we went to school or when we bought a book encrypt your communications people",
    "start": "1952990",
    "end": "1959260"
  },
  {
    "text": "go through through the OWASP top 10 understand what it is in trainer developers to code defensively against",
    "start": "1959260",
    "end": "1964510"
  },
  {
    "text": "it we also start the occasional bug inheritance we did talk about about how a lot of these products you know use",
    "start": "1964510",
    "end": "1971320"
  },
  {
    "text": "open source libraries or use commonly available libraries the ubiquity of kevo so we did occasionally see bug",
    "start": "1971320",
    "end": "1976780"
  },
  {
    "text": "inheritance from the dependencies that they had so using outdated java runtime",
    "start": "1976780",
    "end": "1981820"
  },
  {
    "text": "environments free dc-dc free dce so etc it again",
    "start": "1981820",
    "end": "1989919"
  },
  {
    "text": "we've never had any problems in Java we've never had any problems in flash but looking at my crystal ball i'm pretty sure we're going to have some in",
    "start": "1989919",
    "end": "1995619"
  },
  {
    "text": "the future ok so just we'll start out with trend micro since that's the first",
    "start": "1995619",
    "end": "2001859"
  },
  {
    "text": "one that i looked at um and again i said web security 101 you can see these are",
    "start": "2001859",
    "end": "2009149"
  },
  {
    "text": "all independent instances of both reflected and stored cross-site",
    "start": "2009149",
    "end": "2015119"
  },
  {
    "text": "scripting that we found in the site some of these were so easy to find that burp found them automatically that's not good",
    "start": "2015119",
    "end": "2020839"
  },
  {
    "text": "especially when you're spending money on a product i would expect better than this the same goes for cross-site",
    "start": "2020839",
    "end": "2027659"
  },
  {
    "text": "request forgery again your security company you should know what cross-site request forgery is and how to code",
    "start": "2027659",
    "end": "2033749"
  },
  {
    "text": "offensively against it why is this a big you know these seems like silly bugs but why is this a big deal well because",
    "start": "2033749",
    "end": "2040139"
  },
  {
    "text": "manage the management's software and the agents have access to a lot of data and if you can force the force the person",
    "start": "2040139",
    "end": "2048868"
  },
  {
    "text": "logged in as the admin soon performin actions let such such as hey if you see a spy with sensitive information so",
    "start": "2048869",
    "end": "2055079"
  },
  {
    "text": "logging it why don't you just delete it that's not good we also noticed with the",
    "start": "2055079",
    "end": "2062368"
  },
  {
    "text": "crawler that they had so you basically kind of go around and look for things that were bad the communication was in",
    "start": "2062369",
    "end": "2067740"
  },
  {
    "text": "plain text so you would have some sensitive information leakage there so again I don't know why this happened",
    "start": "2067740",
    "end": "2074940"
  },
  {
    "text": "these things were fixed but it could just be a side effect of maybe the company buying a smaller company not",
    "start": "2074940",
    "end": "2080700"
  },
  {
    "text": "really knowing what they bought and not really kind of going through with a fine-tooth comb we don't know but just",
    "start": "2080700",
    "end": "2085858"
  },
  {
    "text": "general take away you spend money on a security product that does not mean that that product in ovid self is secure so",
    "start": "2085859",
    "end": "2093690"
  },
  {
    "text": "for sophos it's gonna be really disappointing and I'm going to talk just long enough for that gift to play it's",
    "start": "2093690",
    "end": "2099420"
  },
  {
    "text": "really funny uh nothing there's we really find anything that's not to say",
    "start": "2099420",
    "end": "2104819"
  },
  {
    "text": "sophos doesn't have other attacks so other areas of interest there have been",
    "start": "2104819",
    "end": "2109890"
  },
  {
    "text": "a lot of bugs published for you know and some of their software a lot of us in net",
    "start": "2109890",
    "end": "2116150"
  },
  {
    "text": "I guess Kelly if you want to talk about the Nets like what they did right okay so one of the advantages of using the",
    "start": "2116170",
    "end": "2121869"
  },
  {
    "text": "core libraries is that they had the built-in security that was implemented in those core privacy so it best",
    "start": "2121869",
    "end": "2127180"
  },
  {
    "text": "practices like using parameterize queries rather than string concatenation for SQL contextualizing your input and",
    "start": "2127180",
    "end": "2135250"
  },
  {
    "text": "output as a preventive measure against cross-site scripting and also using the standardized encrypting library is",
    "start": "2135250",
    "end": "2140349"
  },
  {
    "text": "rather than rolling their own so kind of blazing through this one a little bit so",
    "start": "2140349",
    "end": "2145960"
  },
  {
    "text": "on their their appliance their star o appliance they actually did some pretty decent things in terms of to routing not",
    "start": "2145960",
    "end": "2153460"
  },
  {
    "text": "the troops aren't you know defeatable but dropping privileges for for services that that uh that we're running on there",
    "start": "2153460",
    "end": "2160240"
  },
  {
    "text": "the web app was pretty pretty clean weren't really any major issues there and by default they really locked down",
    "start": "2160240",
    "end": "2166829"
  },
  {
    "text": "login and access restrictions so you couldn't just like throw the appliance onto the network and have someone",
    "start": "2166829",
    "end": "2172630"
  },
  {
    "text": "immediately logging into it and owning it for open dlp again open source open",
    "start": "2172630",
    "end": "2179410"
  },
  {
    "text": "source product well look the one major takeaway from from this was like it's",
    "start": "2179410",
    "end": "2184839"
  },
  {
    "text": "Roy your own security basically for open dlp there were no anti CSRF tokens or",
    "start": "2184839",
    "end": "2190270"
  },
  {
    "text": "anything of that nature uh you know the sshfs stuff the remote crawler that was",
    "start": "2190270",
    "end": "2196900"
  },
  {
    "text": "really just as good as you know about having a bat like a really poor password on the log and that's being used so",
    "start": "2196900",
    "end": "2202329"
  },
  {
    "text": "that's its really kind of like BYO s bring your own security right so in this example just using CSRF i know it's hard",
    "start": "2202329",
    "end": "2208869"
  },
  {
    "text": "to see things are pixelated but using CSRF to basically delete a policy or pro",
    "start": "2208869",
    "end": "2216160"
  },
  {
    "text": "you know a policy profile so effectively makes it not work finally from the first",
    "start": "2216160",
    "end": "2222220"
  },
  {
    "text": "round a web since so their policies um",
    "start": "2222220",
    "end": "2227760"
  },
  {
    "text": "at the time presumably this is a they are no longer doing this but uh so we",
    "start": "2227760",
    "end": "2234099"
  },
  {
    "text": "kind of talked about how policies work for most dlp products and they have like regular expressions keywords file attributes the things that you want to",
    "start": "2234099",
    "end": "2240250"
  },
  {
    "text": "look for what you want to look in in their case for anything that was a regular expression on the Triton",
    "start": "2240250",
    "end": "2245799"
  },
  {
    "text": "management server side they used python pickled objects written out to disk now",
    "start": "2245799",
    "end": "2251000"
  },
  {
    "text": "if you're familiar with at all who's who's most you probably know about Python pickles serialization marshalling",
    "start": "2251000",
    "end": "2257109"
  },
  {
    "text": "library now the problem with that is that Python pickle untrusted Python",
    "start": "2257109",
    "end": "2263809"
  },
  {
    "text": "pickle objects wouldn't being deserialized can lead to Kodak just code execution so what they did was they",
    "start": "2263809",
    "end": "2270260"
  },
  {
    "text": "would have all these things like English words file types first names in France Italy and you know each of those is a",
    "start": "2270260",
    "end": "2277789"
  },
  {
    "text": "bunch of regular expressions on disk they get encrypted bundled and then pushed to the agents and appliances",
    "start": "2277789",
    "end": "2284059"
  },
  {
    "text": "here's an example of just deserialising one of them you see some you know some key words and stuff so what this led to",
    "start": "2284059",
    "end": "2293480"
  },
  {
    "text": "was you know a scenario where say an admin already on the Tritons server and",
    "start": "2293480",
    "end": "2299089"
  },
  {
    "text": "some organizations probably have different people doing different things someone who manages the local server",
    "start": "2299089",
    "end": "2304760"
  },
  {
    "text": "versus someone who actually manages all the DOP they overwrite one of those pickled object files with their",
    "start": "2304760",
    "end": "2309769"
  },
  {
    "text": "arbitrary code their arbitrary pickled a code and this is our really bad",
    "start": "2309769",
    "end": "2315440"
  },
  {
    "text": "proof-of-concept on the left which I know it looks kind of dumb but basically",
    "start": "2315440",
    "end": "2321200"
  },
  {
    "text": "what it does is it opens up a reverse shell when it got pushed down to for",
    "start": "2321200",
    "end": "2326569"
  },
  {
    "text": "example the protector appliance as you can see now I'm like I am root because",
    "start": "2326569",
    "end": "2331609"
  },
  {
    "text": "the end point that the clutter the classifier policy engine classifier",
    "start": "2331609",
    "end": "2337369"
  },
  {
    "text": "thing on the appliance runs as root so it's the thing that's loading that pickled object so over right pickle",
    "start": "2337369",
    "end": "2345890"
  },
  {
    "text": "object on management server gets pushed get show same goes for like opening calc",
    "start": "2345890",
    "end": "2350930"
  },
  {
    "text": "DX e on windows so alpha dlp that was",
    "start": "2350930",
    "end": "2357319"
  },
  {
    "text": "like actually my favorite my favorite bug was the web since one except for dingus to you alpha dop I it's hard to",
    "start": "2357319",
    "end": "2367160"
  },
  {
    "text": "remember when we when they have code names so the good things about about alpha there was no cross-site request",
    "start": "2367160",
    "end": "2372470"
  },
  {
    "text": "forgery good job there was no obvious cross-site flashing remember we talked",
    "start": "2372470",
    "end": "2377900"
  },
  {
    "text": "about how the admin panel was in flash well at least they didn't have any cross site flashing which would be the flash",
    "start": "2377900",
    "end": "2383460"
  },
  {
    "text": "world equivalent of cross-site scripting they also use hibernate properly to",
    "start": "2383460",
    "end": "2388890"
  },
  {
    "text": "communicate with the database so no sequel injection the bad they did not",
    "start": "2388890",
    "end": "2394800"
  },
  {
    "text": "have any authentication on the my SQL database so meaning a blank password",
    "start": "2394800",
    "end": "2399950"
  },
  {
    "text": "they did not hatch any of their they're like my margaritas their hashes do not",
    "start": "2399950",
    "end": "2405390"
  },
  {
    "text": "have salt which is bad for if somebody",
    "start": "2405390",
    "end": "2412080"
  },
  {
    "text": "does get ahold of those hashes it would be a be a lot easier to reverse them it was also just extremely unstable and",
    "start": "2412080",
    "end": "2419520"
  },
  {
    "text": "we're using fairly robust hardware so you see a combination of two problems",
    "start": "2419520",
    "end": "2424770"
  },
  {
    "text": "here one shouldn't be crashing in general and two it is giving you a lot of information about the internals of",
    "start": "2424770",
    "end": "2433410"
  },
  {
    "text": "here with their verbose error message so this is a problem with actually logging",
    "start": "2433410",
    "end": "2439050"
  },
  {
    "text": "in where you would log in and for some reason it was just 500 just crashing very infrequently not of a very stable",
    "start": "2439050",
    "end": "2446099"
  },
  {
    "text": "and you know stability is what you want in the DLP product okay in terms of the",
    "start": "2446099",
    "end": "2455220"
  },
  {
    "text": "agent we noticed that heavy use of marshaling between Java and air lang maybe the potential for heat production",
    "start": "2455220",
    "end": "2462030"
  },
  {
    "text": "I didn't really have enough time to look and look into it but there was some indications of that the really bad",
    "start": "2462030",
    "end": "2468480"
  },
  {
    "text": "takeaway just the Java Runtime environment that was packaged with it was really really super old and as you",
    "start": "2468480",
    "end": "2476369"
  },
  {
    "text": "can see here it was java version 1 dot 7 0 of 0 2 which is how many years old is",
    "start": "2476369",
    "end": "2484170"
  },
  {
    "text": "that gene very old too old especially when we talk about Java which never has",
    "start": "2484170",
    "end": "2489359"
  },
  {
    "text": "any security problems so again there was past manipulation well in how the agent",
    "start": "2489359",
    "end": "2495570"
  },
  {
    "text": "accessed the airline rules so maybe a potential to point that agent to something malicious and there was a",
    "start": "2495570",
    "end": "2502710"
  },
  {
    "text": "there's no assembly signing on.net assemblies this is something that is pretty common and not really the end of",
    "start": "2502710",
    "end": "2508530"
  },
  {
    "text": "the world but it does make it quite easy to modify an agent to make it do something else which",
    "start": "2508530",
    "end": "2513930"
  },
  {
    "text": "is what I did here so you can see that on the on this side over here the left-hand side we have the original",
    "start": "2513930",
    "end": "2520619"
  },
  {
    "text": "agent we have blacked out the logo for anonymity reasons and here we have",
    "start": "2520619",
    "end": "2527040"
  },
  {
    "text": "modified it to be something way better which is our new global apt configurator",
    "start": "2527040",
    "end": "2532380"
  },
  {
    "text": "so well why would you want to sign your code or why would you want to sign your",
    "start": "2532380",
    "end": "2537599"
  },
  {
    "text": "assemblies your dotnet to prevent things like this from happening to prevent somebody from creating a rogue agent",
    "start": "2537599",
    "end": "2544319"
  },
  {
    "text": "that does bad things but looks like the real thing um so Bravo DLP this is",
    "start": "2544319",
    "end": "2550290"
  },
  {
    "text": "johnny bravo if you're not familiar with Johnny Bravo it's good cartoon you should watch it the best so this was",
    "start": "2550290",
    "end": "2556800"
  },
  {
    "text": "probably the most complex one most sophisticated and fairly well thought",
    "start": "2556800",
    "end": "2562829"
  },
  {
    "text": "out actually this is the one that used the MMC snappin it's also the one that we spent a lot of time reversing we kind",
    "start": "2562829",
    "end": "2571230"
  },
  {
    "text": "of did that thing where you run out of time when you're doing research that happens all the time so basically spent",
    "start": "2571230",
    "end": "2578069"
  },
  {
    "text": "too much time on it and got lazy and just moved moved on so they used ECE RPC for communications between the agent and",
    "start": "2578069",
    "end": "2585359"
  },
  {
    "text": "the on the management server which is like that's pretty good there are a lot of benefits that the could come with",
    "start": "2585359",
    "end": "2591720"
  },
  {
    "text": "that you get to build on like all of Microsoft's a you know whole communication stack and you reap the",
    "start": "2591720",
    "end": "2597329"
  },
  {
    "text": "benefits of of that so things like packet privacy and actually doing a you",
    "start": "2597329",
    "end": "2605069"
  },
  {
    "text": "know decent authentication uh so packed privacy ads in you know sets of bitten",
    "start": "2605069",
    "end": "2610890"
  },
  {
    "text": "and that's encryption to to DC or sea calms the only thing though free DCE did",
    "start": "2610890",
    "end": "2617579"
  },
  {
    "text": "not support that for some reason so all of the OS 10 again this is pixelated",
    "start": "2617579",
    "end": "2622829"
  },
  {
    "text": "sorry the OS 10 agent did not support a packet privacy so why is this bad well",
    "start": "2622829",
    "end": "2631140"
  },
  {
    "text": "there's an option in a lot of these like called file shadowing so if you for instance this is kind of that trend",
    "start": "2631140",
    "end": "2637589"
  },
  {
    "text": "micro crawler example as well when you are you could have a policy that says oh I found a thing that violates you know",
    "start": "2637589",
    "end": "2644640"
  },
  {
    "text": "the DLP policy send a copy up to the management so over well when it's being been sent in",
    "start": "2644640",
    "end": "2650640"
  },
  {
    "text": "plain text to the management server from the OS 10 agent that kind of defeats the purpose of the DLP to begin with so the",
    "start": "2650640",
    "end": "2659040"
  },
  {
    "text": "copy of the file in question if that option is enabled from OS 10 would be sent in plain text cool so Charlie",
    "start": "2659040",
    "end": "2667380"
  },
  {
    "text": "Charlie DLP no ante csrf tokens at all",
    "start": "2667380",
    "end": "2672660"
  },
  {
    "text": "anywhere ever so and most of their options are operational face are done restfully so yeah so here's an example",
    "start": "2672660",
    "end": "2681780"
  },
  {
    "text": "across that request forgery against an admin if you hopefully can't see this you'll see like just to get to index.php",
    "start": "2681780",
    "end": "2689369"
  },
  {
    "text": "/ whatever / delete / ID / 2 distinct",
    "start": "2689369",
    "end": "2694440"
  },
  {
    "text": "lack of any kind of token that would prevent me from doing that and Bob's",
    "start": "2694440",
    "end": "2700290"
  },
  {
    "text": "your uncle you delete a policy so that's that's kind of unfortunate they their",
    "start": "2700290",
    "end": "2706350"
  },
  {
    "text": "management server also had a the ability to arbitrarily so when our new agent",
    "start": "2706350",
    "end": "2711480"
  },
  {
    "text": "comes online it will register / / soap / xmlrpc there's no authentication on that",
    "start": "2711480",
    "end": "2718619"
  },
  {
    "text": "so like I could just arbitrarily register new agents and run you out of all your licenses but also they don't",
    "start": "2718619",
    "end": "2724859"
  },
  {
    "text": "sanitize any of the information being displayed that's hard to see again I'm",
    "start": "2724859",
    "end": "2730710"
  },
  {
    "text": "sorry they don't actually sanitize any of the information being displayed to the admin when viewing new agents so you",
    "start": "2730710",
    "end": "2737130"
  },
  {
    "text": "could just add like see data in the soap envelope with like arbitrary JavaScript so it's like pretty sweet sword XSS you",
    "start": "2737130",
    "end": "2746220"
  },
  {
    "text": "can see I have my alert here the requisite alert 1 and then it shows up when the admin goes to look at the",
    "start": "2746220",
    "end": "2752640"
  },
  {
    "text": "agents I think obviously do more but now you know that was easy so finally",
    "start": "2752640",
    "end": "2760700"
  },
  {
    "text": "everyone's favorite and well not everyone's favorite because it doesn't",
    "start": "2760700",
    "end": "2765869"
  },
  {
    "text": "really exist it doesn't exist it doesn't again this is this is despite being",
    "start": "2765869",
    "end": "2772380"
  },
  {
    "text": "reactive this should be considered a completely hypothetical vendor that does not actually exist in the world also we",
    "start": "2772380",
    "end": "2779550"
  },
  {
    "text": "had to hand draw some screenshots because so we couldn't leave your sweet shots in there that we for this hypothetical yeah because it doesn't",
    "start": "2779550",
    "end": "2785880"
  },
  {
    "text": "exist so there exists a real screenshots so dingus their network appliance it has",
    "start": "2785880",
    "end": "2792180"
  },
  {
    "text": "a support account hypothetically that actually reverse SSH is to an Eastern",
    "start": "2792180",
    "end": "2797520"
  },
  {
    "text": "European based SSH like prox like a jump host basically as you can see here in",
    "start": "2797520",
    "end": "2802560"
  },
  {
    "text": "the hand-drawn screenshot this is this would have been an excerpt from from that hypothetical script where it goes",
    "start": "2802560",
    "end": "2808890"
  },
  {
    "text": "to support at whatever this you know hypothetical host name would be and",
    "start": "2808890",
    "end": "2814860"
  },
  {
    "text": "there are some scripts that it uses to for various reasons uh hypothetically",
    "start": "2814860",
    "end": "2821060"
  },
  {
    "text": "pair of the same DSA key you heard me DSA key on all their virtual appliances",
    "start": "2821060",
    "end": "2827160"
  },
  {
    "text": "out of the box which means you have download another copy of their hypothetical virtual appliance you have",
    "start": "2827160",
    "end": "2832380"
  },
  {
    "text": "the same DSA key that they have the next person has basically a lot of allows",
    "start": "2832380",
    "end": "2838350"
  },
  {
    "text": "support to login as root on the appliance from that jump host its",
    "start": "2838350",
    "end": "2843480"
  },
  {
    "text": "invoked from the web interface there's another snippet where it lit then",
    "start": "2843480",
    "end": "2848610"
  },
  {
    "text": "listens on you know port twenty thousand TCP so they also don't have CSRF tokens",
    "start": "2848610",
    "end": "2854070"
  },
  {
    "text": "so um you could hypothetically a CSRF an",
    "start": "2854070",
    "end": "2859830"
  },
  {
    "text": "admin to invoke the ssh connection to an",
    "start": "2859830",
    "end": "2864990"
  },
  {
    "text": "arbitrary host that you control with that same DSA key that you probably also have a copy of and it's not password",
    "start": "2864990",
    "end": "2872490"
  },
  {
    "text": "protected guess a key so that's bad um",
    "start": "2872490",
    "end": "2877640"
  },
  {
    "text": "hypothetically uh here's an example of command injection because it's like 1999",
    "start": "2877640",
    "end": "2884120"
  },
  {
    "text": "I on this appliance there's not there's file called injected does not exist",
    "start": "2884120",
    "end": "2891410"
  },
  {
    "text": "using this a burp example here you'll note the note the semicolon that's here",
    "start": "2891410",
    "end": "2897690"
  },
  {
    "text": "in the when setting the time zone so if you see our sort of an admin and add",
    "start": "2897690",
    "end": "2903150"
  },
  {
    "text": "that semicolon you can do whatever you want after that so then of course now we have that file called injected is there",
    "start": "2903150",
    "end": "2910050"
  },
  {
    "text": "and it's owned by Apache uh that's so I was won by Apache that's",
    "start": "2910050",
    "end": "2916100"
  },
  {
    "text": "dumb except that dingus hypothetically also has a bunch of white listed no",
    "start": "2916100",
    "end": "2923450"
  },
  {
    "text": "password suit overs entries for Apache not just anything but like specific things like shut down if config move",
    "start": "2923450",
    "end": "2931160"
  },
  {
    "text": "tone things that can be run as root by Apache without any password so csrf 20 I",
    "start": "2931160",
    "end": "2937700"
  },
  {
    "text": "don't know arbitrary package installation using rpm and there's like no verify options so you can just add",
    "start": "2937700",
    "end": "2943760"
  },
  {
    "text": "your own kernel that's fun uh their hypothetical central console also had a",
    "start": "2943760",
    "end": "2951230"
  },
  {
    "text": "these were prefer a right unauthenticated DB management scripts where you could just hit this one URL",
    "start": "2951230",
    "end": "2958400"
  },
  {
    "text": "and actually like delete the entire database on the management server",
    "start": "2958400",
    "end": "2964550"
  },
  {
    "text": "without authentication or updated whatever you want to do uh there a comms",
    "start": "2964550",
    "end": "2971720"
  },
  {
    "text": "Channel between the network appliance and the central management server was actually just hypothetically postgres",
    "start": "2971720",
    "end": "2978470"
  },
  {
    "text": "plain text post res with authentication using just a username and a database",
    "start": "2978470",
    "end": "2985220"
  },
  {
    "text": "name so you could also hit the central management server and you know do",
    "start": "2985220",
    "end": "2992030"
  },
  {
    "text": "whatever you wanted to do yeah to give them credit they did provide a lot of ways you know lots of lots of different",
    "start": "2992030",
    "end": "2998210"
  },
  {
    "text": "flexibility for doing bad things they're not bugs or features um yeah that's a",
    "start": "2998210",
    "end": "3003460"
  },
  {
    "text": "hand-drawn Wireshark screenshot that's really good screenshot so yeah it's just that's their sink channel 44",
    "start": "3003460",
    "end": "3009960"
  },
  {
    "text": "communications so let's just breeze through this since we're kind of going over so just look a little bit talk",
    "start": "3009960",
    "end": "3015640"
  },
  {
    "text": "about dlp of bypasses evasion really is okay you're going to take away how bad",
    "start": "3015640",
    "end": "3022210"
  },
  {
    "text": "do you want this you're going to take whale your all your people's cell phones what are some other ways to sneak around",
    "start": "3022210",
    "end": "3027910"
  },
  {
    "text": "dlp evade detection use a figure out what file formats they don't use which ones aren't supported maybe protocols or",
    "start": "3027910",
    "end": "3035320"
  },
  {
    "text": "doing weird things on the network sort of like heavily fragment you're heavily",
    "start": "3035320",
    "end": "3042070"
  },
  {
    "text": "fragment and reorder your network traffic obvious gated encrypt files you know steganography sounds",
    "start": "3042070",
    "end": "3049360"
  },
  {
    "text": "silly but I've been able to get data not only you know in a in a lab environment",
    "start": "3049360",
    "end": "3055620"
  },
  {
    "text": "sneak sensitive data out of out of my lab network using us by putting it in",
    "start": "3055620",
    "end": "3060820"
  },
  {
    "text": "pictures of cats using steganography and then also just think about how what privileged to your users have how many",
    "start": "3060820",
    "end": "3067270"
  },
  {
    "text": "of them could just go into disable their end point agent how badly you know if",
    "start": "3067270",
    "end": "3072910"
  },
  {
    "text": "somebody is really determined to get the stuff out of your network again DLP should really be thought of keeping",
    "start": "3072910",
    "end": "3078160"
  },
  {
    "text": "honest people honest so finally the takeaway here over all other than the",
    "start": "3078160",
    "end": "3085600"
  },
  {
    "text": "fun that we've had with bragging about hand-drawn screenshots defenses add",
    "start": "3085600",
    "end": "3091090"
  },
  {
    "text": "weakness they every thought every time you add something even if it's a security product you're running software",
    "start": "3091090",
    "end": "3097120"
  },
  {
    "text": "you're running a new piece of hardware right with this oh its own its own problems and and its own attack surface",
    "start": "3097120",
    "end": "3106740"
  },
  {
    "text": "it's up to us and this goes for you know those of us who also work at security",
    "start": "3107910",
    "end": "3113110"
  },
  {
    "text": "companies we should we should we should be better at this but it's up to us to kind of keep vendors honest right right",
    "start": "3113110",
    "end": "3120040"
  },
  {
    "text": "if burp scanner can find and I'm not saying software's not complex is hard",
    "start": "3120040",
    "end": "3125740"
  },
  {
    "text": "right software development sucks it's very--it's it takes a lot of time and planning but little simple things like",
    "start": "3125740",
    "end": "3132850"
  },
  {
    "text": "just security QA yeah a burp burp is cheap if you're not running it when you're if you're not using it or",
    "start": "3132850",
    "end": "3139540"
  },
  {
    "text": "something like it when you are testing your stuff maybe you know shell out a couple hundred dollars and catch the",
    "start": "3139540",
    "end": "3147460"
  },
  {
    "text": "low-hanging fruits and then finally this is sort of like one of those big picture",
    "start": "3147460",
    "end": "3153150"
  },
  {
    "text": "security things just being aware of what you're actually defending against who",
    "start": "3153150",
    "end": "3160120"
  },
  {
    "text": "you're actually defending against what what what what actually are the threats against you you like threat model your",
    "start": "3160120",
    "end": "3165340"
  },
  {
    "text": "organization whoa because anyone who's inside or advanced and sophisticated",
    "start": "3165340",
    "end": "3170710"
  },
  {
    "text": "enough is probably going to get the get those things out of the network and probably also own your DLP server in the",
    "start": "3170710",
    "end": "3177430"
  },
  {
    "text": "process so yeah that's like the big big big picture take away so thank you um with",
    "start": "3177430",
    "end": "3185590"
  },
  {
    "text": "time for questions I think we have about seven minutes or so okay anyone know so",
    "start": "3185590",
    "end": "3194350"
  },
  {
    "text": "they eat that means the talk was either really really good or really really bad all right well then you get for free six",
    "start": "3194350",
    "end": "3201550"
  },
  {
    "text": "minutes thank you yeah thank you if you have any questions afterwards um just come find us he wants to find us on the",
    "start": "3201550",
    "end": "3209260"
  },
  {
    "text": "internet on the on the twitter i'm at quine she's a Deloria and those are our",
    "start": "3209260",
    "end": "3214420"
  },
  {
    "text": "email addresses if you would like to follow up thank you very much for coming and enjoy the rest of the show thank you",
    "start": "3214420",
    "end": "3222960"
  }
]