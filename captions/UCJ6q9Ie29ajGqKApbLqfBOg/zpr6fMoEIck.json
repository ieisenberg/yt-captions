[
  {
    "start": "0",
    "end": "27000"
  },
  {
    "text": "uh so thanks everyone for attending this talk and thanks black hat for inviting",
    "start": "0",
    "end": "6299"
  },
  {
    "text": "us as well um the first thing I I want to tell you",
    "start": "6299",
    "end": "11400"
  },
  {
    "text": "is that this was supposed to be a two-man stock so um will was not able to come here",
    "start": "11400",
    "end": "17400"
  },
  {
    "text": "because he had other things to do so um unfortunately he's not gonna be here",
    "start": "17400",
    "end": "22800"
  },
  {
    "text": "but I'm gonna do the presentation so let's start",
    "start": "22800",
    "end": "28199"
  },
  {
    "start": "27000",
    "end": "114000"
  },
  {
    "text": "first of all disclaimer which is in every presentation I'm gonna do a very",
    "start": "28199",
    "end": "33960"
  },
  {
    "text": "quick introduction on me and the company for those of you who don't know",
    "start": "33960",
    "end": "39420"
  },
  {
    "text": "anaphysis and what we do this is a company focused on business critical",
    "start": "39420",
    "end": "45239"
  },
  {
    "text": "application security so we focused on applications such as sap Oracle",
    "start": "45239",
    "end": "51300"
  },
  {
    "text": "PeopleSoft JD Edwards so we understand that these applications are very critical and are holding the the",
    "start": "51300",
    "end": "58079"
  },
  {
    "text": "business crown jewels so we do a lot of things around its security develop",
    "start": "58079",
    "end": "63480"
  },
  {
    "text": "software provide services such as pen tests um",
    "start": "63480",
    "end": "68840"
  },
  {
    "text": "whole trainings research report advisories well a lot of activities that",
    "start": "68840",
    "end": "75900"
  },
  {
    "text": "then allows us to do this kind of presentations technical presentations in this kind of conferences",
    "start": "75900",
    "end": "83159"
  },
  {
    "text": "so who am I my name is kind of a long name is Juan Paolo per situation so for",
    "start": "83159",
    "end": "89520"
  },
  {
    "text": "you it's just JP because I had all sorts of different combinations of my name so just uh for for for easy to make it easy",
    "start": "89520",
    "end": "99060"
  },
  {
    "text": "it's JP I work at onapsis pretty much since the beginning doing research my background is coming from doing pen test",
    "start": "99060",
    "end": "105659"
  },
  {
    "text": "and doing research on different products sap Oracle and other products as well so",
    "start": "105659",
    "end": "112680"
  },
  {
    "text": "it's a technical background well having said that let's jump into the presentation",
    "start": "112680",
    "end": "118799"
  },
  {
    "start": "114000",
    "end": "156000"
  },
  {
    "text": "this is the agenda for today we are gonna do a brief introduction into the",
    "start": "118799",
    "end": "124439"
  },
  {
    "text": "in-memory platforms or in memory databases then we are going to talk about sap Hana",
    "start": "124439",
    "end": "130679"
  },
  {
    "text": "and then some thread or attack vectors to sap Hana and well all you you have",
    "start": "130679",
    "end": "137760"
  },
  {
    "text": "all the all those there and we're gonna go through each one of them and then we are gonna draw some conclusions for you",
    "start": "137760",
    "end": "144480"
  },
  {
    "text": "to take out of this talk if you are running sap or if you're running SAP with Hana or have Hana applications then",
    "start": "144480",
    "end": "152819"
  },
  {
    "text": "I think you will find this very interesting so the first slide that I wanted to",
    "start": "152819",
    "end": "159480"
  },
  {
    "start": "156000",
    "end": "251000"
  },
  {
    "text": "present is an introduction to in-memory databases right so but then I started",
    "start": "159480",
    "end": "165660"
  },
  {
    "text": "thinking and I realized that it's a very simple concept if you think about it it's a database that is running in",
    "start": "165660",
    "end": "174060"
  },
  {
    "text": "memory right it's doing all the processing of the tables all the queries",
    "start": "174060",
    "end": "179220"
  },
  {
    "text": "modifications changes everything to the tables that are stored in the main",
    "start": "179220",
    "end": "184560"
  },
  {
    "text": "memory right not in disk even though there is disk storage Holding the the the data and the tables all the tables",
    "start": "184560",
    "end": "192360"
  },
  {
    "text": "are sent to the main memory and needs to be able to behold on in the main memory",
    "start": "192360",
    "end": "197940"
  },
  {
    "text": "in order to be processed so that's basically the concept it's not such a New Concept it's something that has been",
    "start": "197940",
    "end": "205140"
  },
  {
    "text": "going on out there like since long time ago um if you even if you go to Wikipedia",
    "start": "205140",
    "end": "212040"
  },
  {
    "text": "you will see that there are many products around in memory databases",
    "start": "212040",
    "end": "218239"
  },
  {
    "text": "um then we started seeing a couple of years ago we focused heavily on sap",
    "start": "218700",
    "end": "225480"
  },
  {
    "text": "um started seeing Hana and started talking about Hana and we realized that",
    "start": "225480",
    "end": "230940"
  },
  {
    "text": "this is something that's getting a lot of attention and it's really growing but it's not just us who who is saying that",
    "start": "230940",
    "end": "238019"
  },
  {
    "text": "right so Gardner is also a saying that as well and we actually see this we see",
    "start": "238019",
    "end": "245040"
  },
  {
    "text": "this every day with the new implementations with new customers so what didn't happen before",
    "start": "245040",
    "end": "252480"
  },
  {
    "start": "251000",
    "end": "368000"
  },
  {
    "text": "well there are some things that helped this happening",
    "start": "252480",
    "end": "257699"
  },
  {
    "text": "it's it's in the last part but I think it's very important The Innovation part",
    "start": "257699",
    "end": "263280"
  },
  {
    "text": "right so this kind of things are coming not so related to main product lines but",
    "start": "263280",
    "end": "270240"
  },
  {
    "text": "usually from the research Labs of the companies right so and this is what happened with sap Hana as well so it's",
    "start": "270240",
    "end": "276479"
  },
  {
    "text": "something that is driven by Innovation itself then we have also a cost of",
    "start": "276479",
    "end": "282540"
  },
  {
    "text": "physical memory going down right so we know this we see this every year we know",
    "start": "282540",
    "end": "287880"
  },
  {
    "text": "that it's not the same have 16 gigabytes in our laptop right now that it was four",
    "start": "287880",
    "end": "293940"
  },
  {
    "text": "years ago or even earlier so it's it's going down this is making things",
    "start": "293940",
    "end": "299300"
  },
  {
    "text": "possible to have like servers with 256 gigabytes one terabyte of memory of RAM",
    "start": "299300",
    "end": "306900"
  },
  {
    "text": "memory right so this is what we need actually to run this kind of databases",
    "start": "306900",
    "end": "312360"
  },
  {
    "text": "and then also there is a an important push from the business itself so we are",
    "start": "312360",
    "end": "319500"
  },
  {
    "text": "usually familiarized with business applications um Erp CRM business intelligence SCM all",
    "start": "319500",
    "end": "327180"
  },
  {
    "text": "these kind of um business applications that I will talk about later but these applications are growing not",
    "start": "327180",
    "end": "334259"
  },
  {
    "text": "only in terms of the business processes that are being processed through those applications but",
    "start": "334259",
    "end": "340380"
  },
  {
    "text": "also in terms of the data that is being managed so a report that usually took 60 Minutes",
    "start": "340380",
    "end": "349199"
  },
  {
    "text": "or six hours to be generated because it was using a lot of tables acquiring a",
    "start": "349199",
    "end": "355979"
  },
  {
    "text": "lot of information now with this kind of Technology can be generated in a matter of minutes or even seconds so there is a",
    "start": "355979",
    "end": "363419"
  },
  {
    "text": "big push out of the business in order to achieve this right",
    "start": "363419",
    "end": "368720"
  },
  {
    "start": "368000",
    "end": "585000"
  },
  {
    "text": "um well we have some vendors involved into this in memory databases",
    "start": "370320",
    "end": "375900"
  },
  {
    "text": "we have Oracle these are The Usual Suspects right so we have Oracle we have",
    "start": "375900",
    "end": "381060"
  },
  {
    "text": "Microsoft we have sap these are kind of the the most uh well-known vendor of",
    "start": "381060",
    "end": "387419"
  },
  {
    "text": "business applications Oracle is a very dedicated to databases and also has a",
    "start": "387419",
    "end": "393840"
  },
  {
    "text": "lot of products in terms of business applications such as Financial PeopleSoft jda Edward sibo so all those",
    "start": "393840",
    "end": "401400"
  },
  {
    "text": "Fusion framework all those applications are running around the Oracle database",
    "start": "401400",
    "end": "406800"
  },
  {
    "text": "but Oracle 12C is the first one in on providing in-memory features and then",
    "start": "406800",
    "end": "414000"
  },
  {
    "text": "Microsoft also as you can see Microsoft SQL Server 2014 so it's kind of new",
    "start": "414000",
    "end": "419160"
  },
  {
    "text": "right and also Oracle 12C is new to I don't know if it was released already or",
    "start": "419160",
    "end": "424740"
  },
  {
    "text": "not but this is something very new but then we have sap Hana sap Hana has",
    "start": "424740",
    "end": "430800"
  },
  {
    "text": "been around here around 2011 something like that when it was",
    "start": "430800",
    "end": "437520"
  },
  {
    "text": "started to being implemented on customers on pilot implementations on different deployments",
    "start": "437520",
    "end": "442979"
  },
  {
    "text": "so we are going to focus on sap Hana and I'm going to tell you why",
    "start": "442979",
    "end": "450180"
  },
  {
    "text": "so just to illustrate this um this what I'm saying is",
    "start": "450180",
    "end": "456060"
  },
  {
    "text": "something for example from Oracle and this is exactly what what you will get from the internet and what you what you",
    "start": "456060",
    "end": "462539"
  },
  {
    "text": "feel right it's orders of magnitude faster it's like the difference between walking and flying in a plane and if you",
    "start": "462539",
    "end": "468660"
  },
  {
    "text": "see comparisons you will see that it's true you will have reports you will have",
    "start": "468660",
    "end": "474539"
  },
  {
    "text": "results way faster than with any other architecture like typical database right",
    "start": "474539",
    "end": "479940"
  },
  {
    "text": "in memory databases are way faster also around Innovation from sap another",
    "start": "479940",
    "end": "487020"
  },
  {
    "text": "quote I I really like this one because I think it's very illustrative in in the sense",
    "start": "487020",
    "end": "493199"
  },
  {
    "text": "of what this actually means in memory computer in memory Computing for sap",
    "start": "493199",
    "end": "498300"
  },
  {
    "text": "like you had the traditional approach that we will see also where the user or the application layer is on top and then",
    "start": "498300",
    "end": "505879"
  },
  {
    "text": "you need to go and grab the data from below right but in the in-memory",
    "start": "505879",
    "end": "511800"
  },
  {
    "text": "Computing you have this Blended architecture that's what we're gonna talk about this in the same layer you",
    "start": "511800",
    "end": "519000"
  },
  {
    "text": "have the application layer you have the the web applications you have the users the authorizations and the data itself",
    "start": "519000",
    "end": "525060"
  },
  {
    "text": "everything in a single product and finally um this is just to to show you some real",
    "start": "525060",
    "end": "532200"
  },
  {
    "text": "world examples right sap is pushing towards sap Hana providing a lot of",
    "start": "532200",
    "end": "537600"
  },
  {
    "text": "products such as Erp CRM all the business Suite",
    "start": "537600",
    "end": "542640"
  },
  {
    "text": "um a lot of products around Hana in terms of analytics for example this is after Germany has won the World Cup",
    "start": "542640",
    "end": "550980"
  },
  {
    "text": "um this is actually sap saying that they were using sap Hana to do the analytics",
    "start": "550980",
    "end": "557339"
  },
  {
    "text": "I'm not so happy about this because I'm from Argentina originally so if you remember the the final well you know",
    "start": "557339",
    "end": "564000"
  },
  {
    "text": "it's not so good but I think it's a great example to show that this is",
    "start": "564000",
    "end": "569160"
  },
  {
    "text": "something that is being used by customers there are a lot of companies actually implementing and in the process",
    "start": "569160",
    "end": "575399"
  },
  {
    "text": "of migration to sap Hana and so that's um this is what I wanted to show you",
    "start": "575399",
    "end": "581399"
  },
  {
    "text": "with these quotes and and examples so let's talk about sap",
    "start": "581399",
    "end": "588060"
  },
  {
    "text": "anyone running sap doing piston pen test to sap auditing sap familiar with sap",
    "start": "588060",
    "end": "596240"
  },
  {
    "text": "okay yeah you're a little bit shy but no worries",
    "start": "597000",
    "end": "602580"
  },
  {
    "text": "um saps everywhere is a piece in in the biggest companies in the world is the",
    "start": "602580",
    "end": "608040"
  },
  {
    "text": "the biggest provider of Business Management Solutions if you go to and it's it's not for smbs right even though",
    "start": "608040",
    "end": "614940"
  },
  {
    "text": "it has uh solutions for SMB for a small medium businesses it's in the biggest",
    "start": "614940",
    "end": "621420"
  },
  {
    "text": "companies in the world and if you go to one Fortune 100",
    "start": "621420",
    "end": "627080"
  },
  {
    "text": "500 1410 all those companies most of those companies are running sap software",
    "start": "627080",
    "end": "632640"
  },
  {
    "text": "and are running the most critical business processes on top of this",
    "start": "632640",
    "end": "638279"
  },
  {
    "text": "and just some numbers for you to get an idea of the not only the size of the",
    "start": "638279",
    "end": "643380"
  },
  {
    "text": "company itself but the size of the implementation from a from an attacker",
    "start": "643380",
    "end": "648540"
  },
  {
    "text": "standpoint it's the size of the attack surface right if you see like Microsoft",
    "start": "648540",
    "end": "653940"
  },
  {
    "text": "is being researched all over the world you you will see advisories and and",
    "start": "653940",
    "end": "660800"
  },
  {
    "text": "exploits everywhere because the attack surface is huge well sap also is there are many",
    "start": "660800",
    "end": "668220"
  },
  {
    "text": "implementations out there so even what an attacker would think is that that's a",
    "start": "668220",
    "end": "674700"
  },
  {
    "text": "big attack surface and the criticality of this is even bigger so it's not in small in smbs it's in the",
    "start": "674700",
    "end": "683220"
  },
  {
    "text": "biggest companies in the world and those companies are running that kind of process right treasury invoicing sales",
    "start": "683220",
    "end": "689640"
  },
  {
    "text": "production procurement that's critical business information that is being stored and processed by these systems",
    "start": "689640",
    "end": "696000"
  },
  {
    "text": "and Hana is being used for that so what why is it so important and why",
    "start": "696000",
    "end": "701640"
  },
  {
    "text": "did we focus on this because we started focusing on on sap and Oracle applications but then we also did",
    "start": "701640",
    "end": "708899"
  },
  {
    "text": "research and started to analyze Hana and the reason for this is because Sap's a",
    "start": "708899",
    "end": "715380"
  },
  {
    "text": "Hana sap Star product right so whenever there is a new implementation sap is",
    "start": "715380",
    "end": "720839"
  },
  {
    "text": "going to push for this implementation to be implemented through Hana right by by",
    "start": "720839",
    "end": "728100"
  },
  {
    "text": "implementing a Hana database and not for example an Oracle database so that's one example then you have a",
    "start": "728100",
    "end": "734579"
  },
  {
    "text": "lot of new products a new product line supported by Hana as well so there is a",
    "start": "734579",
    "end": "740579"
  },
  {
    "text": "lot of movement within sap in order to push Hana and it's really really important for sap to do this migrations",
    "start": "740579",
    "end": "747360"
  },
  {
    "text": "also are planned to go from the typical databases such as Oracle SQL Server db2",
    "start": "747360",
    "end": "753720"
  },
  {
    "text": "into a Hana environment so and I'm going to quickly finish with",
    "start": "753720",
    "end": "760380"
  },
  {
    "start": "756000",
    "end": "864000"
  },
  {
    "text": "the introduction what I want to show you here is that we are talking about SAP systems we are",
    "start": "760380",
    "end": "767040"
  },
  {
    "text": "talking about in-memory databases that are processing business critical information right so",
    "start": "767040",
    "end": "773880"
  },
  {
    "text": "um in this sense we are not talking about someone just exploiting a vulnerability and having a root shell",
    "start": "773880",
    "end": "781200"
  },
  {
    "text": "account but we are talking about someone exploiting a vulnerability and",
    "start": "781200",
    "end": "786360"
  },
  {
    "text": "connecting to a database and retrieving business information such as customers vendors human resources engaging into an",
    "start": "786360",
    "end": "794399"
  },
  {
    "text": "Espionage attack also we are not talking about um I don't know a denial of service",
    "start": "794399",
    "end": "799740"
  },
  {
    "text": "someone fasting a protocol and breaking up a service right we are talking about",
    "start": "799740",
    "end": "804899"
  },
  {
    "text": "someone fasting a protocol and breaking up a business a service that is",
    "start": "804899",
    "end": "810720"
  },
  {
    "text": "supporting business critical uh process right so someone would paralyze",
    "start": "810720",
    "end": "816779"
  },
  {
    "text": "operation like by breaking up an interface by breaking up a connection between two SAP systems or just jutting",
    "start": "816779",
    "end": "824459"
  },
  {
    "text": "down the whole sap system so that's a sabotage attack and finally fraud attack also if a user is if an attacker creates",
    "start": "824459",
    "end": "833100"
  },
  {
    "text": "a user with hyperlishes and access bank account numbers credit cards information",
    "start": "833100",
    "end": "838680"
  },
  {
    "text": "modify some address some some vendor information creates a new employee all",
    "start": "838680",
    "end": "843899"
  },
  {
    "text": "those attacks can be possible can be made because of the the nature of the",
    "start": "843899",
    "end": "849779"
  },
  {
    "text": "information that is on those systems right so in this slide what I want to emphasize is the fact that we are not",
    "start": "849779",
    "end": "855540"
  },
  {
    "text": "talking about just exploits opening abilities we are talking about business processes that are supported by this",
    "start": "855540",
    "end": "861779"
  },
  {
    "text": "technology so let's jump into sap Hana",
    "start": "861779",
    "end": "867480"
  },
  {
    "start": "864000",
    "end": "934000"
  },
  {
    "text": "database but what's really important or really",
    "start": "867480",
    "end": "873720"
  },
  {
    "text": "interesting of this part is that it's shipped with an HTTP server and you have",
    "start": "873720",
    "end": "879600"
  },
  {
    "text": "this integrated into the database so whenever you develop as a developer you",
    "start": "879600",
    "end": "885839"
  },
  {
    "text": "create a new application for sap Hana we are creating an application that's running on top of the database but",
    "start": "885839",
    "end": "893639"
  },
  {
    "text": "integrated with the same users so that's that's very important to understand from an architectural point",
    "start": "893639",
    "end": "900000"
  },
  {
    "text": "of view then there are Integrations with external applications such as calc engines we're gonna show some I'm gonna",
    "start": "900000",
    "end": "907800"
  },
  {
    "text": "show some examples about an integration to our server and how that can be",
    "start": "907800",
    "end": "913740"
  },
  {
    "text": "actually tricked into achieve something um and what's important again is that it",
    "start": "913740",
    "end": "922019"
  },
  {
    "text": "is supporting business applications right it's not just a standalone database it's not just a standalone web",
    "start": "922019",
    "end": "928560"
  },
  {
    "text": "server it's something that supports and holds real business information",
    "start": "928560",
    "end": "934440"
  },
  {
    "start": "934000",
    "end": "1095000"
  },
  {
    "text": "so why do we say that this is a blended architecture so all of you that usually",
    "start": "934440",
    "end": "941579"
  },
  {
    "text": "analyze web applications or do pen tests I used to do also web application pen",
    "start": "941579",
    "end": "947040"
  },
  {
    "text": "test a long time ago as well we know how this works right typical web",
    "start": "947040",
    "end": "953040"
  },
  {
    "text": "applications and also sap netweaver runs in a very similar way typical applications are configured in",
    "start": "953040",
    "end": "960839"
  },
  {
    "text": "in a layered approach so you have the users and the the application layer",
    "start": "960839",
    "end": "967560"
  },
  {
    "text": "then there is a connection from the application to a database which is usually a single user",
    "start": "967560",
    "end": "974959"
  },
  {
    "text": "that user is usually configured to access all tables and everything within within the application anything that",
    "start": "974959",
    "end": "981600"
  },
  {
    "text": "should be reached by the application should be reached by that user and then",
    "start": "981600",
    "end": "986820"
  },
  {
    "text": "we have an operating system user that is actually the user running the database",
    "start": "986820",
    "end": "992220"
  },
  {
    "text": "itself so it's a layered approach and if if someone wants to break into that",
    "start": "992220",
    "end": "998040"
  },
  {
    "text": "application he will be able to jump between the layers like exploiting a vulnerability",
    "start": "998040",
    "end": "1004399"
  },
  {
    "text": "for example an SQL injection jumping to a database and then jump into a",
    "start": "1004399",
    "end": "1009560"
  },
  {
    "text": "operating system depending on the vulnerabilities that are affecting that application",
    "start": "1009560",
    "end": "1014600"
  },
  {
    "text": "so in this scheme we have a single user on the database and a single user on the",
    "start": "1014600",
    "end": "1022399"
  },
  {
    "text": "operating system so but we have several users connecting to the web application right",
    "start": "1022399",
    "end": "1028938"
  },
  {
    "text": "however in this Blended architecture we have a different approach",
    "start": "1028939",
    "end": "1034880"
  },
  {
    "text": "we have database users or application users it it really depends on how you",
    "start": "1034880",
    "end": "1041000"
  },
  {
    "text": "see it which are authenticated into a database and as this is integrated we have the",
    "start": "1041000",
    "end": "1047240"
  },
  {
    "text": "same source of users connecting through HTTP or maybe through",
    "start": "1047240",
    "end": "1053059"
  },
  {
    "text": "SQL right so all the users are the same within the database and within the application server and the web",
    "start": "1053059",
    "end": "1059419"
  },
  {
    "text": "application then there is like another layer which is the operating system that is",
    "start": "1059419",
    "end": "1065960"
  },
  {
    "text": "supporting or executing all the Hana services and providing like an interface",
    "start": "1065960",
    "end": "1072320"
  },
  {
    "text": "for function calls and all that so it's a different approach that's why we",
    "start": "1072320",
    "end": "1078080"
  },
  {
    "text": "call it's a blended architecture that's because instead of having different layers we have now two layers that are",
    "start": "1078080",
    "end": "1085940"
  },
  {
    "text": "integrated into a single layer so now this is going to make some vulnerabilities the impact of some",
    "start": "1085940",
    "end": "1092600"
  },
  {
    "text": "vulnerabilities a little bit different for example",
    "start": "1092600",
    "end": "1098360"
  },
  {
    "start": "1095000",
    "end": "1291000"
  },
  {
    "text": "and and what's really interesting here is there is kind of a reversion right",
    "start": "1098360",
    "end": "1103640"
  },
  {
    "text": "and and I'm going to explain you why in typical web apps an SQL injection",
    "start": "1103640",
    "end": "1109660"
  },
  {
    "text": "uh depending well it really depends on the vulnerability itself and other factors right but usually the user that",
    "start": "1109660",
    "end": "1117860"
  },
  {
    "text": "was used in order to execute those queries and inject the the SQL commands",
    "start": "1117860",
    "end": "1124039"
  },
  {
    "text": "is the the single user right so that user has full access to all the tables",
    "start": "1124039",
    "end": "1129200"
  },
  {
    "text": "therefore an escalation usually ends up meaning a full system compromise",
    "start": "1129200",
    "end": "1136700"
  },
  {
    "text": "or full application compromise it really depends on the vulnerability and some other factors but this is the typical",
    "start": "1136700",
    "end": "1143600"
  },
  {
    "text": "approach however in Hana we have a different scenario because we have a",
    "start": "1143600",
    "end": "1148700"
  },
  {
    "text": "blue application that is integrated into a database so the same",
    "start": "1148700",
    "end": "1153799"
  },
  {
    "text": "user that is that logged into the application is the same user that is executing any query if there is an SQL",
    "start": "1153799",
    "end": "1160760"
  },
  {
    "text": "instruction for example so it's really up to the authorizations of that User",
    "start": "1160760",
    "end": "1166100"
  },
  {
    "text": "it's not it's no longer a single user with full authorizations to all tables",
    "start": "1166100",
    "end": "1173000"
  },
  {
    "text": "so the criti the criticity of these vulnerabilities tends to be lower",
    "start": "1173000",
    "end": "1178039"
  },
  {
    "text": "because you need to mix it with some social engineer to get",
    "start": "1178039",
    "end": "1183320"
  },
  {
    "text": "a full privilege reducer right to trick some user to do that",
    "start": "1183320",
    "end": "1188780"
  },
  {
    "text": "however cross-site scripting in in typical web applications is something",
    "start": "1188780",
    "end": "1194600"
  },
  {
    "text": "that needs to be mixed with social engineer you need to Target the user you",
    "start": "1194600",
    "end": "1200780"
  },
  {
    "text": "can steal the session you can do different things depending on the on the programming language on different",
    "start": "1200780",
    "end": "1207700"
  },
  {
    "text": "factors right however now with this Blended architecture and the integrated",
    "start": "1207700",
    "end": "1215140"
  },
  {
    "text": "there is a feature that is by default on every Hana system that I'm gonna",
    "start": "1215140",
    "end": "1220820"
  },
  {
    "text": "describe later but with the default features this tends to be more critical",
    "start": "1220820",
    "end": "1227120"
  },
  {
    "text": "because having a hype released user would lead to an attacker being able to",
    "start": "1227120",
    "end": "1232520"
  },
  {
    "text": "modify any page within the Hana system right it's a matter of targeting the right user and having just the the",
    "start": "1232520",
    "end": "1240679"
  },
  {
    "text": "feature is there because of the IDE that is provided by default but it's a matter of targeting the right user and a full",
    "start": "1240679",
    "end": "1248059"
  },
  {
    "text": "system compromise could be achieved then some some other facts for example",
    "start": "1248059",
    "end": "1253940"
  },
  {
    "text": "the code is stored in the file system typically it really depends but usually it's stored in the file system however",
    "start": "1253940",
    "end": "1260059"
  },
  {
    "text": "in Hana we have the code within the database and we will see how which are the queries that we need to execute in",
    "start": "1260059",
    "end": "1266120"
  },
  {
    "text": "order to get the the code itself and actually it's a code that can be changed",
    "start": "1266120",
    "end": "1271480"
  },
  {
    "text": "within the application right if if the right SQL query can be executed the",
    "start": "1271480",
    "end": "1277640"
  },
  {
    "text": "whole code could be modified another fact in terms of os commands is that sap",
    "start": "1277640",
    "end": "1285559"
  },
  {
    "text": "really restricted the command execution within Hana so these three these two",
    "start": "1285559",
    "end": "1292520"
  },
  {
    "text": "layers that we see here the jumping between the DB layer and the",
    "start": "1292520",
    "end": "1298820"
  },
  {
    "text": "OS layer is very very difficult it's there is no feature to do that like no a",
    "start": "1298820",
    "end": "1304640"
  },
  {
    "text": "valid feature so if there is a way to actually execute OS commands that's a",
    "start": "1304640",
    "end": "1310940"
  },
  {
    "text": "vulnerability but by default you don't have any any feature that allows you to",
    "start": "1310940",
    "end": "1316159"
  },
  {
    "text": "jump into operating system like you have with store procedures in in our databases for example",
    "start": "1316159",
    "end": "1323179"
  },
  {
    "text": "so it's restricted some some more Concepts around Hana and",
    "start": "1323179",
    "end": "1329360"
  },
  {
    "start": "1325000",
    "end": "1413000"
  },
  {
    "text": "then we will jump into the different attacks there are different programming",
    "start": "1329360",
    "end": "1334520"
  },
  {
    "text": "languages provided by Hana by default we have a very complex stack um different languages for example",
    "start": "1334520",
    "end": "1342580"
  },
  {
    "text": "xsjs is a is Javascript but server side",
    "start": "1342580",
    "end": "1347600"
  },
  {
    "text": "it's based on spider monkey JavaScript so it's a something well known out there",
    "start": "1347600",
    "end": "1354559"
  },
  {
    "text": "we have SQL SQL script our code and L code for internal procedures so we can",
    "start": "1354559",
    "end": "1362960"
  },
  {
    "text": "actually write a procedure in R and that will be executed externally in a",
    "start": "1362960",
    "end": "1368299"
  },
  {
    "text": "different system so that's possible above also we can code specific EVAP",
    "start": "1368299",
    "end": "1373940"
  },
  {
    "text": "code that that is tuned for Hana to work faster",
    "start": "1373940",
    "end": "1379159"
  },
  {
    "text": "and then HTML5 we have all these mobile",
    "start": "1379159",
    "end": "1384679"
  },
  {
    "text": "um stack that is available in order to develop mobile applications as well so",
    "start": "1384679",
    "end": "1390320"
  },
  {
    "text": "this is just an example right we have more uh more programming languages as",
    "start": "1390320",
    "end": "1396799"
  },
  {
    "text": "well sap is providing a lot of tools and trainings and courses and a lot of",
    "start": "1396799",
    "end": "1403220"
  },
  {
    "text": "information in order to um make people start coding on top of",
    "start": "1403220",
    "end": "1410000"
  },
  {
    "text": "this right and and to make new applications and this is important",
    "start": "1410000",
    "end": "1416780"
  },
  {
    "start": "1413000",
    "end": "1497000"
  },
  {
    "text": "um to understand some some of the further attacks we have two ways into how to create new",
    "start": "1416780",
    "end": "1423980"
  },
  {
    "text": "code within sap Hana for web applications right the one is the Hana",
    "start": "1423980",
    "end": "1429320"
  },
  {
    "text": "Studio that's the kind of the database client we get the package install it and",
    "start": "1429320",
    "end": "1435799"
  },
  {
    "text": "connect to a database and we can modify any artifact we can create new",
    "start": "1435799",
    "end": "1441020"
  },
  {
    "text": "applications create users do whatever we want Studio",
    "start": "1441020",
    "end": "1446720"
  },
  {
    "text": "but on the other hand we also have the XX access IDE this is an embedded IDE",
    "start": "1446720",
    "end": "1455000"
  },
  {
    "text": "which is by default on every hand implementation so if you have enough privileges you can actually create a web",
    "start": "1455000",
    "end": "1461960"
  },
  {
    "text": "application through the web browser right connecting to the port 8000 this",
    "start": "1461960",
    "end": "1467179"
  },
  {
    "text": "is a the default URL in the 8000",
    "start": "1467179",
    "end": "1473260"
  },
  {
    "text": "and that's a URL but if you have enough privileges you can modify code create",
    "start": "1473260",
    "end": "1479000"
  },
  {
    "text": "new code create new users do whatever whatever you need to in order to",
    "start": "1479000",
    "end": "1484400"
  },
  {
    "text": "administrate the system however in on the other side an attacker being able to connect to this if he got",
    "start": "1484400",
    "end": "1491000"
  },
  {
    "text": "some credentials he will be able to also modify things as well",
    "start": "1491000",
    "end": "1497260"
  },
  {
    "text": "so let's talk a little bit about the thread or attack vectors to sap Hana",
    "start": "1497960",
    "end": "1504200"
  },
  {
    "text": "what's the difference between a typical SQL instruction and an SQL injection that is",
    "start": "1504200",
    "end": "1510080"
  },
  {
    "text": "being triggered within Hana on on one hand we have the Hana code and",
    "start": "1510080",
    "end": "1516140"
  },
  {
    "text": "on the other side we have a PHP example and you will see that the first",
    "start": "1516140",
    "end": "1521960"
  },
  {
    "text": "difference is this a single authentication or single user this that",
    "start": "1521960",
    "end": "1527120"
  },
  {
    "text": "is being used when you code an application for example in PHP right so",
    "start": "1527120",
    "end": "1532940"
  },
  {
    "text": "the user is connecting to the database this could be stored in a in another file whatever",
    "start": "1532940",
    "end": "1538880"
  },
  {
    "text": "but the queries are being executed with this single user however in Hana",
    "start": "1538880",
    "end": "1544820"
  },
  {
    "text": "we have this statement DB gate connection there is no username known",
    "start": "1544820",
    "end": "1549860"
  },
  {
    "text": "password that's basically a sec saying Hey I want to use I want to get a",
    "start": "1549860",
    "end": "1556279"
  },
  {
    "text": "connection to the database using my user right so that's that's what's going to",
    "start": "1556279",
    "end": "1561380"
  },
  {
    "text": "happen there is no exchange of credentials it's only the user that was already authenticated to A system that",
    "start": "1561380",
    "end": "1568220"
  },
  {
    "text": "will be executing that sentence and you can see that both applications are",
    "start": "1568220",
    "end": "1574220"
  },
  {
    "text": "vulnerable to sq an injection um so this is just an example for you to",
    "start": "1574220",
    "end": "1579380"
  },
  {
    "text": "see the differences of both approaches so when it comes to SQL injection",
    "start": "1579380",
    "end": "1587000"
  },
  {
    "text": "it's not only about what's being executed or what can be",
    "start": "1587000",
    "end": "1592539"
  },
  {
    "text": "appended to the to a string how we can exploit this how we can trigger the",
    "start": "1592539",
    "end": "1597620"
  },
  {
    "text": "screen injection it's not only about that but it's also about who is actually triggering that",
    "start": "1597620",
    "end": "1603740"
  },
  {
    "text": "right because it's not the same if I have a user a valid user And I detect an",
    "start": "1603740",
    "end": "1609440"
  },
  {
    "text": "excluding section and I trigger that within the application I can have completely different results if there is",
    "start": "1609440",
    "end": "1616460"
  },
  {
    "text": "another user triggering that same vulnerability so it's not about what's",
    "start": "1616460",
    "end": "1621799"
  },
  {
    "text": "being executed but also it's about who so social engineering attacks are very",
    "start": "1621799",
    "end": "1628220"
  },
  {
    "text": "very important when it comes to for example doing a pen test on this kind of",
    "start": "1628220",
    "end": "1633500"
  },
  {
    "text": "implementations right so I'm gonna do a quick demo on",
    "start": "1633500",
    "end": "1640400"
  },
  {
    "start": "1637000",
    "end": "1700000"
  },
  {
    "text": "Instagram section on Hana I hope okay so this is very",
    "start": "1640400",
    "end": "1646039"
  },
  {
    "text": "quick this is an application on Hana vulnerable to SQL injection",
    "start": "1646039",
    "end": "1651140"
  },
  {
    "text": "What's Happening Here is that there's a parameter it's been injected with a true sentence that's okay there is a single",
    "start": "1651140",
    "end": "1657860"
  },
  {
    "text": "record in the in the table however we can append something to get the data expression for example and that's what",
    "start": "1657860",
    "end": "1665600"
  },
  {
    "text": "we're gonna do in order to have additional information",
    "start": "1665600",
    "end": "1670640"
  },
  {
    "text": "all this information is also in a pen test cheat sheet that is provided by the end of the presentation so you will be",
    "start": "1670640",
    "end": "1676880"
  },
  {
    "text": "able to see which are the commands that are useful in order to get additional information",
    "start": "1676880",
    "end": "1683380"
  },
  {
    "text": "so there's not nothing strange on any screening section it's a matter of",
    "start": "1683480",
    "end": "1689240"
  },
  {
    "text": "knowing which is the instruction point which is the information that we're going to get the version of database",
    "start": "1689240",
    "end": "1695740"
  },
  {
    "text": "making a union with another table that there's nothing strange with that however there is something that",
    "start": "1695740",
    "end": "1703940"
  },
  {
    "start": "1700000",
    "end": "1719000"
  },
  {
    "text": "um we saw in terms of the tables that are configured within Hana that is called time travel and",
    "start": "1703940",
    "end": "1711320"
  },
  {
    "text": "that's not something that we we created right the term is already being used for",
    "start": "1711320",
    "end": "1716659"
  },
  {
    "text": "that functionality so I don't know if you remember this screen",
    "start": "1716659",
    "end": "1722120"
  },
  {
    "start": "1719000",
    "end": "1958000"
  },
  {
    "text": "or or even this movie so what we're gonna do is",
    "start": "1722120",
    "end": "1727520"
  },
  {
    "text": "I'm gonna show you that there are ways into getting information from tables that shouldn't be there or apparently is",
    "start": "1727520",
    "end": "1734779"
  },
  {
    "text": "not there so there is something that is called history tables and history tables is a",
    "start": "1734779",
    "end": "1743000"
  },
  {
    "text": "concept very simple um is basically inform our tables whose",
    "start": "1743000",
    "end": "1748700"
  },
  {
    "text": "information is never being deleted but it's being kept track of all the changes",
    "start": "1748700",
    "end": "1754520"
  },
  {
    "text": "right so for example with an initial table like the one we we",
    "start": "1754520",
    "end": "1759860"
  },
  {
    "text": "have in the upper section we have three rows however if we update one of the",
    "start": "1759860",
    "end": "1766820"
  },
  {
    "text": "rows we will have an additional row with the change and the the original modified",
    "start": "1766820",
    "end": "1773000"
  },
  {
    "text": "so we have a a new row in the table but we will have different body from",
    "start": "1773000",
    "end": "1780080"
  },
  {
    "text": "ambali 2 that's shown as as dates in the",
    "start": "1780080",
    "end": "1785659"
  },
  {
    "text": "real table it's it's actually not a date but a commit ID so but just for you to",
    "start": "1785659",
    "end": "1792380"
  },
  {
    "text": "to have an idea it's a date is is good to to understand so if we delete",
    "start": "1792380",
    "end": "1798080"
  },
  {
    "text": "something now we see a different record whose validity also changed right so it",
    "start": "1798080",
    "end": "1805399"
  },
  {
    "text": "changed now we don't have a question mark that means that if we want to query the table",
    "start": "1805399",
    "end": "1812899"
  },
  {
    "text": "the current state of the table is going to have only the records whose valid two",
    "start": "1812899",
    "end": "1820460"
  },
  {
    "text": "date is not being shown but all the rest of the records are still there",
    "start": "1820460",
    "end": "1825500"
  },
  {
    "text": "so let's say that we want to keep confidential information or or very sensitive information in a table and we",
    "start": "1825500",
    "end": "1832340"
  },
  {
    "text": "want to keep track of that because it's important information well through an SQL injection someone with",
    "start": "1832340",
    "end": "1839840"
  },
  {
    "text": "access to a table would be able to gather all the table all the contents",
    "start": "1839840",
    "end": "1845720"
  },
  {
    "text": "and something to to keep in mind is the fact that we need to specifically delete",
    "start": "1845720",
    "end": "1851240"
  },
  {
    "text": "the information right so it's it's not something that gets automatically deleted or or it's nothing is deleted",
    "start": "1851240",
    "end": "1859399"
  },
  {
    "text": "until we specifically say so so there is a command that I'm gonna show you also",
    "start": "1859399",
    "end": "1866059"
  },
  {
    "text": "conceptually time travel tables or history tables are tables whose States",
    "start": "1866059",
    "end": "1871820"
  },
  {
    "text": "status is being changing over time and all the changes are being recorded",
    "start": "1871820",
    "end": "1878140"
  },
  {
    "text": "some commands for you to keep as a reference how to create a history table",
    "start": "1878140",
    "end": "1885500"
  },
  {
    "text": "how to list history tables this important because if we want to know if we have such a table we we need to",
    "start": "1885500",
    "end": "1892820"
  },
  {
    "text": "execute that command and then if if a user wants to access",
    "start": "1892820",
    "end": "1899480"
  },
  {
    "text": "all the table like the current status of a table that would be select start from",
    "start": "1899480",
    "end": "1905299"
  },
  {
    "text": "table right but if we want to get a specific status or a specific commit ID that's",
    "start": "1905299",
    "end": "1912020"
  },
  {
    "text": "the the technical term if we want to get a specific commit ID we can specify that",
    "start": "1912020",
    "end": "1917779"
  },
  {
    "text": "and we will get the table as it was in that specific date",
    "start": "1917779",
    "end": "1923720"
  },
  {
    "text": "so that's something we can we can get and also there is another way specifying request",
    "start": "1923720",
    "end": "1930200"
  },
  {
    "text": "Flags like request flags all rows that's another way so we are not getting a",
    "start": "1930200",
    "end": "1935960"
  },
  {
    "text": "specific commit ID but we are getting the whole table so we will have way more results",
    "start": "1935960",
    "end": "1941539"
  },
  {
    "text": "and finally to delete the history information that should be the command I",
    "start": "1941539",
    "end": "1947720"
  },
  {
    "text": "haven't tested it but that according to the documentation that should be the command to delete all the the the",
    "start": "1947720",
    "end": "1955100"
  },
  {
    "text": "commits that are not the current one right so let's see",
    "start": "1955100",
    "end": "1962419"
  },
  {
    "start": "1958000",
    "end": "2189000"
  },
  {
    "text": "a more interesting SQL injection so",
    "start": "1962419",
    "end": "1968059"
  },
  {
    "text": "what what we have here is um a user connecting to the IDE the web",
    "start": "1968059",
    "end": "1974059"
  },
  {
    "text": "interface so his authenticated into a system he will actually access all the catalog",
    "start": "1974059",
    "end": "1982700"
  },
  {
    "text": "and will be able to see all the applications and we'll see the the vulnerable application and the tables so",
    "start": "1982700",
    "end": "1989299"
  },
  {
    "text": "that's what he's doing right now it takes some time something to to say that unfortunately I cannot run a",
    "start": "1989299",
    "end": "1997340"
  },
  {
    "text": "Hana system on a laptop because it will require a lot of memory so I had to record the demos",
    "start": "1997340",
    "end": "2004480"
  },
  {
    "text": "so the user is connecting to the IDE to the email he's accessing the catalog he",
    "start": "2004480",
    "end": "2011260"
  },
  {
    "text": "will show all the information",
    "start": "2011260",
    "end": "2014820"
  },
  {
    "text": "let's move repeat",
    "start": "2016480",
    "end": "2020580"
  },
  {
    "text": "so he can get a SQL browser for example and list all the tables which are type",
    "start": "2023200",
    "end": "2030880"
  },
  {
    "text": "history so this is on the valid user side right to check all the history",
    "start": "2030880",
    "end": "2037179"
  },
  {
    "text": "tables so we see accounts that's a history table so that there might be something",
    "start": "2037179",
    "end": "2043179"
  },
  {
    "text": "interesting there but on the other hand we have an application that is actually connecting to that table and showing all",
    "start": "2043179",
    "end": "2049960"
  },
  {
    "text": "the information so the in the IDE we have the onapsis package which holds",
    "start": "2049960",
    "end": "2056980"
  },
  {
    "text": "some some applications some booleanable applications some some applications that we developed for for testing and this",
    "start": "2056980",
    "end": "2064720"
  },
  {
    "text": "application specifically is very similar to the other one to the one vulnerable to a screen injection it's something",
    "start": "2064720",
    "end": "2071378"
  },
  {
    "text": "that gets a parameter it's being put together with the query and it's being executed so conceptual is",
    "start": "2071379",
    "end": "2079358"
  },
  {
    "text": "very similar but what I want to show you is the difference that we get when we",
    "start": "2079359",
    "end": "2085240"
  },
  {
    "text": "execute an SQL instruction traditional SK injection or when we apply some of",
    "start": "2085240",
    "end": "2090940"
  },
  {
    "text": "these modifiers so now it's um we we are not providing",
    "start": "2090940",
    "end": "2097480"
  },
  {
    "text": "any ID parameter so once we provide the parameter we have the id1 we can have",
    "start": "2097480",
    "end": "2104500"
  },
  {
    "text": "the id2 as well those are the only two records and we will we will be able to",
    "start": "2104500",
    "end": "2110380"
  },
  {
    "text": "validate that because if we add a true sentence we will see that those two records are",
    "start": "2110380",
    "end": "2118060"
  },
  {
    "text": "the only ones in the table right so if we don't if we don't know that that's a history table that's it right",
    "start": "2118060",
    "end": "2124980"
  },
  {
    "text": "we can stick to that however if we append that modifier",
    "start": "2124980",
    "end": "2132900"
  },
  {
    "text": "we will have additional contents that maybe we're not supposed to be shown or",
    "start": "2133119",
    "end": "2141040"
  },
  {
    "text": "it's information that we don't want to to be accessible right so that's that's possible if we append some of these",
    "start": "2141040",
    "end": "2148300"
  },
  {
    "text": "modifiers to list specific commit IDs or even get the whole contents of the table",
    "start": "2148300",
    "end": "2154119"
  },
  {
    "text": "and then finally as a user what we are doing is showing this at the status of the",
    "start": "2154119",
    "end": "2161380"
  },
  {
    "text": "accounts table value 2 is not configured for the first two those are the first",
    "start": "2161380",
    "end": "2166839"
  },
  {
    "text": "two records and suppose we were we thought that these were the only ones",
    "start": "2166839",
    "end": "2172060"
  },
  {
    "text": "but then we have some others which were valid in at some point in some commit",
    "start": "2172060",
    "end": "2179160"
  },
  {
    "text": "so that's that's a basically how you trigger a Time Travelers connection",
    "start": "2179500",
    "end": "2185260"
  },
  {
    "text": "with these historical tables in sap Hana",
    "start": "2185260",
    "end": "2190599"
  },
  {
    "start": "2189000",
    "end": "2243000"
  },
  {
    "text": "so for each one of the attacks um I'm gonna show you some countermeasures well this is for the",
    "start": "2190599",
    "end": "2197560"
  },
  {
    "text": "developers if if they are aware of this kind of vulnerabilities it's probably",
    "start": "2197560",
    "end": "2202660"
  },
  {
    "text": "something they know but it's never a it's never too much to know all this",
    "start": "2202660",
    "end": "2208240"
  },
  {
    "text": "this kind of countermeasures use prepare statement do not concatenate parameters",
    "start": "2208240",
    "end": "2213579"
  },
  {
    "text": "that are not validated and in the end it's all about the user's permissions right so",
    "start": "2213579",
    "end": "2219780"
  },
  {
    "text": "there is a new requirement which should be very very strong on every sap",
    "start": "2219780",
    "end": "2225579"
  },
  {
    "text": "implementation and that's permissions permissions now",
    "start": "2225579",
    "end": "2230760"
  },
  {
    "text": "before the permissions were always very important right but now it's even more",
    "start": "2230760",
    "end": "2236140"
  },
  {
    "text": "critical because this is going to define the impact of many of these vulnerabilities at the web layer",
    "start": "2236140",
    "end": "2244020"
  },
  {
    "start": "2243000",
    "end": "2309000"
  },
  {
    "text": "so cross-site scripting very quickly crosshatch scripting",
    "start": "2244260",
    "end": "2249940"
  },
  {
    "text": "attacks using these um embedded or this default built-in",
    "start": "2249940",
    "end": "2255940"
  },
  {
    "text": "functionality could be even more critical right because having this kind of cross-site scripting",
    "start": "2255940",
    "end": "2263920"
  },
  {
    "text": "like this kind of script um sent to the user or being able to",
    "start": "2263920",
    "end": "2269680"
  },
  {
    "text": "execute in the user side targeting the URL that we see in Orange",
    "start": "2269680",
    "end": "2275260"
  },
  {
    "text": "that's a URL in the IDE right so that's that's a URL of the application that can",
    "start": "2275260",
    "end": "2281380"
  },
  {
    "text": "modify anything within within sap Hana so if the user has sufficient privileges",
    "start": "2281380",
    "end": "2287260"
  },
  {
    "text": "to that then it's a matter of targeting the right user and sending something",
    "start": "2287260",
    "end": "2292480"
  },
  {
    "text": "like this modifying or inserting or changing executing any query within the database",
    "start": "2292480",
    "end": "2300339"
  },
  {
    "text": "so this is just an example for you to keep of what could be potentially a",
    "start": "2300339",
    "end": "2306700"
  },
  {
    "text": "cross-site descriptive attack within sap Hana some some other recommendations in terms",
    "start": "2306700",
    "end": "2313960"
  },
  {
    "start": "2309000",
    "end": "2440000"
  },
  {
    "text": "some other recommendations in terms of cross-site sorry um access JS code",
    "start": "2313960",
    "end": "2320920"
  },
  {
    "text": "um this there are different vulnerabilities that could be affecting xsjs code for example the eval",
    "start": "2320920",
    "end": "2327880"
  },
  {
    "text": "assignment that's a vulnerability that on a there is a bonabity that an apps is reported to sap",
    "start": "2327880",
    "end": "2335040"
  },
  {
    "text": "around evil as well so sap already published an advice and sorry a sub",
    "start": "2335040",
    "end": "2341920"
  },
  {
    "text": "security node so um sap or sap Hana customers could update their systems and get the patch",
    "start": "2341920",
    "end": "2349839"
  },
  {
    "text": "for this kind of vulnerabilities however it's all about the code right so this this was a vulnerability in the standard",
    "start": "2349839",
    "end": "2356079"
  },
  {
    "text": "code however if you have developers creating new applications and they use the eval in an insecure way then you",
    "start": "2356079",
    "end": "2364300"
  },
  {
    "text": "have vulnerabilities again affecting the sap Hana system so all these examples",
    "start": "2364300",
    "end": "2370800"
  },
  {
    "text": "are just to show you that even though you're a coding an application in excess",
    "start": "2370800",
    "end": "2376780"
  },
  {
    "text": "JS code which is a server-side JavaScript called the application the whole application",
    "start": "2376780",
    "end": "2383920"
  },
  {
    "text": "and the whole Hana system could be endangered if it's not properly coded",
    "start": "2383920",
    "end": "2389980"
  },
  {
    "text": "again some countermeasures for this restrict packages exposed via http",
    "start": "2389980",
    "end": "2396720"
  },
  {
    "text": "it's a user is authorized to connect through SQL and to connect through HTTP",
    "start": "2396720",
    "end": "2403300"
  },
  {
    "text": "right so we have authorizations to limit which users and which packages we want",
    "start": "2403300",
    "end": "2408400"
  },
  {
    "text": "to restrict for end users through SQL through HTTP and through different mechanisms so",
    "start": "2408400",
    "end": "2415599"
  },
  {
    "text": "there are different privileges such as system application object analytic",
    "start": "2415599",
    "end": "2420880"
  },
  {
    "text": "package users it's complex but it's something we need to tackle and we need to take care of",
    "start": "2420880",
    "end": "2426940"
  },
  {
    "text": "because otherwise we can expose the whole application",
    "start": "2426940",
    "end": "2433000"
  },
  {
    "text": "enable cross-site request forcery protection um yeah definitely validate all the",
    "start": "2433000",
    "end": "2438640"
  },
  {
    "text": "parameters so let's talk about the integration with",
    "start": "2438640",
    "end": "2444640"
  },
  {
    "start": "2440000",
    "end": "2989000"
  },
  {
    "text": "our server anyone familiar with our language good we have one well I wasn't familiar",
    "start": "2444640",
    "end": "2452500"
  },
  {
    "text": "with this language before before researching on this Hana platform",
    "start": "2452500",
    "end": "2458020"
  },
  {
    "text": "it's uh it's used for um like",
    "start": "2458020",
    "end": "2463859"
  },
  {
    "text": "doing things very fast right analytics processing things that needs a lot of",
    "start": "2463859",
    "end": "2469480"
  },
  {
    "text": "processing power um it's very well known in the academic",
    "start": "2469480",
    "end": "2474700"
  },
  {
    "text": "field so you will see a lot of papers a lot of work in terms around our language",
    "start": "2474700",
    "end": "2482140"
  },
  {
    "text": "but as sap Hana is heavily focused on analytics and processing and performance",
    "start": "2482140",
    "end": "2489160"
  },
  {
    "text": "it's provided an interface to our server for users to code",
    "start": "2489160",
    "end": "2495780"
  },
  {
    "text": "procedures in that language so this is SQL sentence that is creating a",
    "start": "2495780",
    "end": "2503079"
  },
  {
    "text": "procedure written in our language in the red part just we need to remove that and",
    "start": "2503079",
    "end": "2509260"
  },
  {
    "text": "put the error language there and that's it so our server is going to be running in",
    "start": "2509260",
    "end": "2516640"
  },
  {
    "text": "a separated host right it's not going to be it shouldn't be running on the Hana",
    "start": "2516640",
    "end": "2521740"
  },
  {
    "text": "system according to Sap's recommendation it should be running outside of the Hana",
    "start": "2521740",
    "end": "2526839"
  },
  {
    "text": "system however I don't know it's it's up to the user how to implement this right",
    "start": "2526839",
    "end": "2533500"
  },
  {
    "text": "so there are some attacks to this R server integration and because of the",
    "start": "2533500",
    "end": "2540460"
  },
  {
    "text": "criticality of the information that is being processed we want to emphasize on",
    "start": "2540460",
    "end": "2545619"
  },
  {
    "text": "all these different attacks so initially this must be installed on a separated",
    "start": "2545619",
    "end": "2551440"
  },
  {
    "text": "host therefore from the sap Hana itself and probably from many other systems",
    "start": "2551440",
    "end": "2557560"
  },
  {
    "text": "there should be a remote connection to the r server so the port needs to be",
    "start": "2557560",
    "end": "2563020"
  },
  {
    "text": "listening to the network and our server is also exposing High",
    "start": "2563020",
    "end": "2569020"
  },
  {
    "text": "predictive functions like remote shutdown and Os common execution",
    "start": "2569020",
    "end": "2574800"
  },
  {
    "text": "within the r server so that's that's something you will find within the the r",
    "start": "2574800",
    "end": "2580000"
  },
  {
    "text": "server package and then if we talk about authentication",
    "start": "2580000",
    "end": "2586560"
  },
  {
    "text": "and also encryption of the traffic well must be configured with user",
    "start": "2586560",
    "end": "2592720"
  },
  {
    "text": "authentication however there is not enforcement of that it could be configured without any kind of",
    "start": "2592720",
    "end": "2597940"
  },
  {
    "text": "authentication at all and even if we configure user authentication there are there is no",
    "start": "2597940",
    "end": "2604000"
  },
  {
    "text": "protection in terms of password strength in terms of Brute Force protection or",
    "start": "2604000",
    "end": "2609819"
  },
  {
    "text": "any other thing like that because that's on the air server side",
    "start": "2609819",
    "end": "2615160"
  },
  {
    "text": "so depending on the type of information we are sending and receiving this could",
    "start": "2615160",
    "end": "2620980"
  },
  {
    "text": "be critical information this could be business information right we might be sending something some numbers to be",
    "start": "2620980",
    "end": "2627640"
  },
  {
    "text": "calculated but we can be calculating some forecast or some payroll total",
    "start": "2627640",
    "end": "2633339"
  },
  {
    "text": "payroll or or anything like it really depends on on how we design that and how",
    "start": "2633339",
    "end": "2639460"
  },
  {
    "text": "we code that so there could be sensory information flowing through that by default there is",
    "start": "2639460",
    "end": "2645280"
  },
  {
    "text": "no encryption so SSL is supported by our server however I'm not sure if it's",
    "start": "2645280",
    "end": "2650740"
  },
  {
    "text": "supported by Hana sap saw this presentation so we didn't have any any information about SSL my",
    "start": "2650740",
    "end": "2658420"
  },
  {
    "text": "guess is that it's still not supported but it could be eventually at some point",
    "start": "2658420",
    "end": "2663520"
  },
  {
    "text": "so that that information could be sniffed if an attacker gets access to a",
    "start": "2663520",
    "end": "2668560"
  },
  {
    "text": "traffic right so let's see some some more",
    "start": "2668560",
    "end": "2673720"
  },
  {
    "text": "um some more examples specifically for attacks to our server integration",
    "start": "2673720",
    "end": "2679000"
  },
  {
    "text": "so this is the Hana Studio this is the Hana client",
    "start": "2679000",
    "end": "2685720"
  },
  {
    "text": "um if we go to browse the catalog and the objects and the packages we will see",
    "start": "2685720",
    "end": "2691240"
  },
  {
    "text": "that there is a procedure it takes time um so we can browse the system schema we",
    "start": "2691240",
    "end": "2698800"
  },
  {
    "text": "can see the procedures and we will see that there is a special procedure",
    "start": "2698800",
    "end": "2704680"
  },
  {
    "text": "that could be coded in our language we have this is my f and my F2 those are",
    "start": "2704680",
    "end": "2712599"
  },
  {
    "text": "two different procedures if we access the details of the procedure we will see the the parameters being sent and",
    "start": "2712599",
    "end": "2719079"
  },
  {
    "text": "received and also the the code of the procedure itself what's the the",
    "start": "2719079",
    "end": "2725140"
  },
  {
    "text": "definition so once we we have this information we can see the parameters and also the",
    "start": "2725140",
    "end": "2732460"
  },
  {
    "text": "definition right so we see language our language so this is a procedure developed around",
    "start": "2732460",
    "end": "2742000"
  },
  {
    "text": "our language so if we execute that we will have the results we will this is a very basic",
    "start": "2742000",
    "end": "2749380"
  },
  {
    "text": "approach this is where the the r server is configured it's just IP address Port",
    "start": "2749380",
    "end": "2756640"
  },
  {
    "text": "if we have authentication information it's there too",
    "start": "2756640",
    "end": "2761980"
  },
  {
    "text": "so we we can call the function and we",
    "start": "2761980",
    "end": "2767260"
  },
  {
    "text": "will get the results so we see that this is something that is actually running right it could be calculating anything",
    "start": "2767260",
    "end": "2773560"
  },
  {
    "text": "around sap Hana so that's from our side but what an",
    "start": "2773560",
    "end": "2779859"
  },
  {
    "text": "attacker would try to do is he would try to connect directly to our server for",
    "start": "2779859",
    "end": "2785859"
  },
  {
    "text": "example he's bringing that IP address that we saw before in the configuration doing an nmap this could be a broader",
    "start": "2785859",
    "end": "2793260"
  },
  {
    "text": "scanning this just for that Port it's open and there is a python package that is",
    "start": "2793260",
    "end": "2799839"
  },
  {
    "text": "called pi r server that python package can be used in order to connect to our",
    "start": "2799839",
    "end": "2805480"
  },
  {
    "text": "server so instead of going through the Hana the attacker will try to go through",
    "start": "2805480",
    "end": "2810940"
  },
  {
    "text": "the r server and connect to the r server for example now he's importing this",
    "start": "2810940",
    "end": "2817240"
  },
  {
    "text": "package and doing a connection to the system",
    "start": "2817240",
    "end": "2822880"
  },
  {
    "text": "and after that what the attacker is going to try to do is just to jot down",
    "start": "2822880",
    "end": "2828099"
  },
  {
    "text": "and that's it the system the the r server was shut",
    "start": "2828099",
    "end": "2833260"
  },
  {
    "text": "down so whenever there's a valid request to execute this function this is going",
    "start": "2833260",
    "end": "2838780"
  },
  {
    "text": "to fail so this could be breaking a valid a business interface or something that is established or depending on this",
    "start": "2838780",
    "end": "2845859"
  },
  {
    "text": "function this is going through that side right however",
    "start": "2845859",
    "end": "2851740"
  },
  {
    "text": "let's say that the attacker compromised the sap Hana right so externally the",
    "start": "2851740",
    "end": "2858099"
  },
  {
    "text": "attacker can shut down the system but let's say that the air server is restricted the IP address is protected",
    "start": "2858099",
    "end": "2864099"
  },
  {
    "text": "by a firewall there is user authentication everything is running is properly configured",
    "start": "2864099",
    "end": "2870760"
  },
  {
    "text": "so an attacker who has previously compromised the sap Hana what he could do is just",
    "start": "2870760",
    "end": "2878079"
  },
  {
    "text": "drop the procedure that is already created and create his own procedure right modify the the existing procedure",
    "start": "2878079",
    "end": "2886119"
  },
  {
    "text": "to do well they apologize for the for the resolution but what it says there it's system net user JP the password",
    "start": "2886119",
    "end": "2894940"
  },
  {
    "text": "slash add and then net user local group administrators to",
    "start": "2894940",
    "end": "2902500"
  },
  {
    "text": "add the user to a local group so depending on the authorizations of that our server",
    "start": "2902500",
    "end": "2907900"
  },
  {
    "text": "the the attacker could compromise the external system as well right going",
    "start": "2907900",
    "end": "2912940"
  },
  {
    "text": "through their server protocol and creating a new user in the system so",
    "start": "2912940",
    "end": "2918819"
  },
  {
    "text": "after this what happens is that once the procedure is executed it will be",
    "start": "2918819",
    "end": "2924700"
  },
  {
    "text": "executed running not only the code it was developed to actually run but also the",
    "start": "2924700",
    "end": "2931540"
  },
  {
    "text": "code that was added by the attacker so this is uh this just",
    "start": "2931540",
    "end": "2938200"
  },
  {
    "text": "a validation of this they are service running we will see that a call to this a",
    "start": "2938200",
    "end": "2945339"
  },
  {
    "text": "function now is not only generating the prime or calculating the prime numbers",
    "start": "2945339",
    "end": "2951040"
  },
  {
    "text": "but also something different happened on the screen right the users work the user",
    "start": "2951040",
    "end": "2956380"
  },
  {
    "text": "work was created and also the the user was added to the local administrators",
    "start": "2956380",
    "end": "2961660"
  },
  {
    "text": "group so this this is limited by the by the authorizations of the user but it really",
    "start": "2961660",
    "end": "2968680"
  },
  {
    "text": "depends on the on how this was implemented if it's running as a service a system account this would be possible",
    "start": "2968680",
    "end": "2975819"
  },
  {
    "text": "so the last step is the attacker that connects to the system",
    "start": "2975819",
    "end": "2982180"
  },
  {
    "text": "so that's let's let's skip that he's connecting through terminal server just to validate that the user was created",
    "start": "2982180",
    "end": "2990040"
  },
  {
    "start": "2989000",
    "end": "3187000"
  },
  {
    "text": "so countermeasures secure the r integration using SSL configure",
    "start": "2990040",
    "end": "2995800"
  },
  {
    "text": "authentication using strong credentials restrict access to our server using a local firewall use low prediction",
    "start": "2995800",
    "end": "3002700"
  },
  {
    "text": "account so all these recommendations needs to be taken care of because otherwise either through our server or",
    "start": "3002700",
    "end": "3009180"
  },
  {
    "text": "through Hana this could be abused breaking up a valid interface or even compromising an additional system",
    "start": "3009180",
    "end": "3016319"
  },
  {
    "text": "restrict shutdown and system I know that it's possible to restrict shutdown I don't know about system maybe some",
    "start": "3016319",
    "end": "3022319"
  },
  {
    "text": "expert on our server could comment on that but if it's possible we should do",
    "start": "3022319",
    "end": "3028200"
  },
  {
    "text": "it um last of the threat vectors is that as",
    "start": "3028200",
    "end": "3034260"
  },
  {
    "text": "I said before sap Hana is restricted from an OS comma and execution standpoint there is no way for a valid",
    "start": "3034260",
    "end": "3040980"
  },
  {
    "text": "user even though the users administrator to execute OS commands at the at the",
    "start": "3040980",
    "end": "3046319"
  },
  {
    "text": "operating system level however there are some ways to interact with C code right for example CS xsc",
    "start": "3046319",
    "end": "3055440"
  },
  {
    "text": "func is a way to actually Define a web application that calls a library in the",
    "start": "3055440",
    "end": "3061980"
  },
  {
    "text": "operating system and then we have the AFL that are also libraries that are",
    "start": "3061980",
    "end": "3067319"
  },
  {
    "text": "shipped by sap in order to extend the functionality of the sap Hana system",
    "start": "3067319",
    "end": "3073200"
  },
  {
    "text": "so these are two ways that we have to interact with the c code",
    "start": "3073200",
    "end": "3078540"
  },
  {
    "text": "what we have found is that it's if the user is able to just put a library or a",
    "start": "3078540",
    "end": "3086819"
  },
  {
    "text": "controller file that is put in the Hana system so there is a this is a post",
    "start": "3086819",
    "end": "3092460"
  },
  {
    "text": "exploitation attack right so he needs to be able to put the file or the library",
    "start": "3092460",
    "end": "3097500"
  },
  {
    "text": "in the sap Hana operating system but if that happens then it could be possible",
    "start": "3097500",
    "end": "3103140"
  },
  {
    "text": "to actually execute commands because the attacker",
    "start": "3103140",
    "end": "3108180"
  },
  {
    "text": "will be able to Define a web application calling that library right so in this quick example what we see is",
    "start": "3108180",
    "end": "3115380"
  },
  {
    "text": "there is a netcat that was opened in the laptop of the of the attacker right then",
    "start": "3115380",
    "end": "3122520"
  },
  {
    "text": "the attacker creates this XX excessive fund",
    "start": "3122520",
    "end": "3127680"
  },
  {
    "text": "pointing to the library the library that he uploaded previously so he controlled",
    "start": "3127680",
    "end": "3133020"
  },
  {
    "text": "the library and placed it into the the file system",
    "start": "3133020",
    "end": "3138119"
  },
  {
    "text": "so once now once they would URL is executed there is going to be an",
    "start": "3138119",
    "end": "3144300"
  },
  {
    "text": "execution of that library and then what happens is that",
    "start": "3144300",
    "end": "3149579"
  },
  {
    "text": "a remote shell will be called to the the attacker's laptop right so you can see",
    "start": "3149579",
    "end": "3156240"
  },
  {
    "text": "here user ID is hco1adm that's a Hana system the system administrator and",
    "start": "3156240",
    "end": "3163380"
  },
  {
    "text": "that's an interactive shell that could be retrieved just because there was a",
    "start": "3163380",
    "end": "3168480"
  },
  {
    "text": "previous exploitation or a control of a file that was placed into application server so as I said before it is very",
    "start": "3168480",
    "end": "3175260"
  },
  {
    "text": "restricted in sap Hana but if there is a previous compromise there could be a way to bypass this but that's that's how it",
    "start": "3175260",
    "end": "3183420"
  },
  {
    "text": "works right we need to have a previous exploitation so just to keep as a reference pen",
    "start": "3183420",
    "end": "3190800"
  },
  {
    "start": "3187000",
    "end": "3218000"
  },
  {
    "text": "tester cheat sheet all the commands that we have been talking about plus some additional for",
    "start": "3190800",
    "end": "3196680"
  },
  {
    "text": "you to have how to get information from Hana systems um one that I would like to point out is",
    "start": "3196680",
    "end": "3203700"
  },
  {
    "text": "to list the password hashes so those are the the user the password hashes of of",
    "start": "3203700",
    "end": "3209880"
  },
  {
    "text": "the users that are configured within the sap Hana database and that can access both the web server and also database if",
    "start": "3209880",
    "end": "3217079"
  },
  {
    "text": "they have the Privileges draw some conclusions business critical applications which are",
    "start": "3217079",
    "end": "3224040"
  },
  {
    "start": "3218000",
    "end": "3309000"
  },
  {
    "text": "the crown shoes we know that these critical applications are running the most critical business processes within",
    "start": "3224040",
    "end": "3231000"
  },
  {
    "text": "our company are supported by the latest Technologies so we need to catch up with this and we need to understand how these",
    "start": "3231000",
    "end": "3238140"
  },
  {
    "text": "Technologies are better in many ways but we need to secure them properly",
    "start": "3238140",
    "end": "3243599"
  },
  {
    "text": "otherwise we can be exposing the whole infrastructure within this new paradigm it is critical",
    "start": "3243599",
    "end": "3250020"
  },
  {
    "text": "to restrict the permissions of the users within Hana so",
    "start": "3250020",
    "end": "3255119"
  },
  {
    "text": "before this it was very important now it's even more important because we are driving the impact of the different",
    "start": "3255119",
    "end": "3261540"
  },
  {
    "text": "vulnerabilities and finally subhana was built with a",
    "start": "3261540",
    "end": "3268920"
  },
  {
    "text": "security focus in mind so we see that because we have been learning about Hana we have been",
    "start": "3268920",
    "end": "3274980"
  },
  {
    "text": "researching about Hana we know that this was built with a security Focus right however there are many",
    "start": "3274980",
    "end": "3282660"
  },
  {
    "text": "responsibilities that relies on the administrators on the users on the developers so we need to catch up with",
    "start": "3282660",
    "end": "3288839"
  },
  {
    "text": "that too and finally this was included by the sap",
    "start": "3288839",
    "end": "3294359"
  },
  {
    "text": "product security Response Team some references for you to keep a security",
    "start": "3294359",
    "end": "3300540"
  },
  {
    "text": "guide and some white papers some guides that I think you will find useful if you",
    "start": "3300540",
    "end": "3305819"
  },
  {
    "text": "want to keep further learning about sap Hana security so thanks to napsis research Labs team",
    "start": "3305819",
    "end": "3313319"
  },
  {
    "start": "3309000",
    "end": "3350000"
  },
  {
    "text": "they they helped me a lot with the demos and the research as well",
    "start": "3313319",
    "end": "3318740"
  },
  {
    "text": "unfortunately we'll didn't make it for today but he also helped a lot for this",
    "start": "3318740",
    "end": "3324960"
  },
  {
    "text": "for the research and for the presentation so if you have any questions feel free to ask I will be around here so",
    "start": "3324960",
    "end": "3332700"
  },
  {
    "text": "whenever you you have a question is there any question",
    "start": "3332700",
    "end": "3338838"
  },
  {
    "text": "okay so you can go to Amsterdam and enjoy enjoy the city",
    "start": "3339780",
    "end": "3345300"
  },
  {
    "text": "thank you all",
    "start": "3345300",
    "end": "3348440"
  }
]