[
  {
    "start": "0",
    "end": "50000"
  },
  {
    "text": "good morning my name is Paul Sabinal I work for IBM x-force advance research team and today I'm going to talk about",
    "start": "30",
    "end": "8130"
  },
  {
    "text": "possible ways to create code that hides other malware also known as route kids by taking advantage of the mechanisms of",
    "start": "8130",
    "end": "16108"
  },
  {
    "text": "Andres new runtime called art so here's the agenda for my topic today first I'm",
    "start": "16109",
    "end": "23130"
  },
  {
    "text": "going to give some background information then I will talk about I",
    "start": "23130",
    "end": "29580"
  },
  {
    "text": "will give a high-level view of arts architecture and mechanisms as well as",
    "start": "29580",
    "end": "36510"
  },
  {
    "text": "the file formats that it uses then I will follow with the main part of the",
    "start": "36510",
    "end": "42960"
  },
  {
    "text": "stuff which is user mode rootkits and and we demo so the main motivation for",
    "start": "42960",
    "end": "50780"
  },
  {
    "start": "50000",
    "end": "50000"
  },
  {
    "text": "this research or for this talk is that there has been some recent advancements",
    "start": "50780",
    "end": "55980"
  },
  {
    "text": "in android security and one of the notable ones is the emeriti and i won't",
    "start": "55980",
    "end": "62070"
  },
  {
    "text": "go into detail about this but it basically it allows Android to verify the integrity of a partition at boot",
    "start": "62070",
    "end": "68220"
  },
  {
    "text": "time and so you can use this to detect modifications into the system to the",
    "start": "68220",
    "end": "75509"
  },
  {
    "text": "system partition based allows Android to protect devices from rootkits that adds",
    "start": "75509",
    "end": "80759"
  },
  {
    "text": "or modifies binaries in the system partition which is how rootkits in",
    "start": "80759",
    "end": "87270"
  },
  {
    "text": "android additionally works they add some binary or modified binders in the or some files in the system partition",
    "start": "87270",
    "end": "93119"
  },
  {
    "text": "however this is not yet enabled by default but a security researcher want",
    "start": "93119",
    "end": "99119"
  },
  {
    "text": "to know what can an attacker do despite of this even if it's not yet in active",
    "start": "99119",
    "end": "105360"
  },
  {
    "text": "use also we want to ask the question can we conduct rootkit operations without",
    "start": "105360",
    "end": "110970"
  },
  {
    "text": "touching the system partition and to",
    "start": "110970",
    "end": "116009"
  },
  {
    "text": "answer these questions return to art which is another new technology that's added recently to Android this is the",
    "start": "116009",
    "end": "123659"
  },
  {
    "text": "new Android runtime that has replaced the older one called dalvik basically we",
    "start": "123659",
    "end": "130560"
  },
  {
    "text": "are going to take advantage of ours mechanisms to modify framework and app code without touching",
    "start": "130560",
    "end": "137120"
  },
  {
    "text": "system partition okay before we go into the details of how to do that we I'll",
    "start": "137120",
    "end": "144900"
  },
  {
    "text": "talk about some overview of how art works okay so art was first introduced",
    "start": "144900",
    "end": "154230"
  },
  {
    "start": "150000",
    "end": "150000"
  },
  {
    "text": "in Android KitKat 4.4 back in October 2013 it was and still at the time it was an",
    "start": "154230",
    "end": "161970"
  },
  {
    "text": "experimental version and you can select which runtime you would use but in",
    "start": "161970",
    "end": "171030"
  },
  {
    "text": "November last year it has by with a release of Android lollipop 5.0 it",
    "start": "171030",
    "end": "176160"
  },
  {
    "text": "became the default one time so if you're going to buy new phone now with a lollipop that's the one that is in use",
    "start": "176160",
    "end": "183890"
  },
  {
    "text": "the main difference between art and dalvik is that there's a much much",
    "start": "183890",
    "end": "189060"
  },
  {
    "text": "better performance it it does it because of the feature called ahead of time",
    "start": "189060",
    "end": "195870"
  },
  {
    "text": "compilation in dalvik your application code runs on top of a virtual machine in",
    "start": "195870",
    "end": "203370"
  },
  {
    "text": "the bytecode or the code for your application you will be interpreted on the other hand in art your code will be",
    "start": "203370",
    "end": "210510"
  },
  {
    "text": "compiled ahead of time in other words your dalvik bytecode will be converted",
    "start": "210510",
    "end": "215640"
  },
  {
    "text": "into native code which is the the code that runs on the architecture of your",
    "start": "215640",
    "end": "221160"
  },
  {
    "text": "device so for example if your device wants on arm the dalvik bytecode will be",
    "start": "221160",
    "end": "227820"
  },
  {
    "text": "converted into arm code if your device runs on x86 your bytecode will be",
    "start": "227820",
    "end": "235020"
  },
  {
    "text": "converted into x86 code the advantage of",
    "start": "235020",
    "end": "240060"
  },
  {
    "text": "art like I said over dalvik is that it has better performance since your applications code will be running on",
    "start": "240060",
    "end": "246360"
  },
  {
    "text": "bare metal so to speak and also because your CPU wouldn't have to do as much",
    "start": "246360",
    "end": "252780"
  },
  {
    "text": "like interpretation and other stuff it will result a better battery life and",
    "start": "252780",
    "end": "260010"
  },
  {
    "text": "there's also some very very minor drawbacks all mostly visible but it will require more storage space space the",
    "start": "260010",
    "end": "267120"
  },
  {
    "text": "normal because your application will be compiled into into another file which is",
    "start": "267120",
    "end": "272580"
  },
  {
    "text": "sourced separately and that contains the your generated native code and also",
    "start": "272580",
    "end": "277650"
  },
  {
    "text": "every time you install an application it will be compiled so it will take a",
    "start": "277650",
    "end": "284130"
  },
  {
    "text": "little bit of time this ahead of time",
    "start": "284130",
    "end": "289830"
  },
  {
    "text": "compilation is done at first boot or or the first time you boot a device you",
    "start": "289830",
    "end": "296250"
  },
  {
    "text": "bought and upon system upgrade or ok updates in this scenario it will create",
    "start": "296250",
    "end": "305280"
  },
  {
    "text": "a boot that out and boot image which I'm going to talk about later and all the",
    "start": "305280",
    "end": "310410"
  },
  {
    "text": "installed apps on your phone will be compiled so this will take like a few",
    "start": "310410",
    "end": "315660"
  },
  {
    "text": "minutes if you have a lot of applications installed at the time",
    "start": "315660",
    "end": "320750"
  },
  {
    "text": "compilation will also be done upon app installation like I said and it will",
    "start": "320750",
    "end": "326160"
  },
  {
    "text": "also be recompiled again every time you update an application so art does all",
    "start": "326160",
    "end": "335460"
  },
  {
    "text": "this using program called Dex tool which you can find in the system bin directory",
    "start": "335460",
    "end": "343850"
  },
  {
    "text": "this tool will compile the back the bytecode in classicists that Dex which",
    "start": "343850",
    "end": "350610"
  },
  {
    "text": "can be found inside your application package or in one of the frame or jar files it will compile this class that",
    "start": "350610",
    "end": "357900"
  },
  {
    "text": "Dex into your native code the next code to receive several parameters including",
    "start": "357900",
    "end": "365430"
  },
  {
    "text": "the location of where you have placed the file you want to compile for the",
    "start": "365430",
    "end": "372270"
  },
  {
    "text": "application you want to compile and the end output location which is normally replace in the data da the cache slash",
    "start": "372270",
    "end": "380790"
  },
  {
    "text": "target architecture nor the folder name is the target architecture for arm its",
    "start": "380790",
    "end": "387570"
  },
  {
    "text": "arm and for x86 the folder name will be x86 when your so after after the health",
    "start": "387570",
    "end": "395490"
  },
  {
    "text": "plan compilation is done whenever your app is run the code generated in the work an old file is executed instead of the",
    "start": "395490",
    "end": "403189"
  },
  {
    "text": "bytecode in your text file I won't go",
    "start": "403189",
    "end": "408679"
  },
  {
    "start": "408000",
    "end": "408000"
  },
  {
    "text": "into the nitty-gritty details of computation but I have I have to mention that there's currently two types of",
    "start": "408679",
    "end": "416289"
  },
  {
    "text": "compilation that can be done through the two compiler backends which is quick and",
    "start": "416289",
    "end": "423409"
  },
  {
    "text": "portable you can choose this by through the command line parameter compiled back",
    "start": "423409",
    "end": "430309"
  },
  {
    "text": "and forward Xcode and the current default for art is quick so quick",
    "start": "430309",
    "end": "437079"
  },
  {
    "start": "437000",
    "end": "437000"
  },
  {
    "text": "basically turns your decks bytecode or in this case it's dumb it's called a",
    "start": "437079",
    "end": "443929"
  },
  {
    "text": "medium level intermediate representation it turns it into a low-level",
    "start": "443929",
    "end": "449199"
  },
  {
    "text": "intermediate representation and then turns converts it into the native code",
    "start": "449199",
    "end": "454879"
  },
  {
    "text": "of your device and there are some optimizations done at each stage the",
    "start": "454879",
    "end": "463249"
  },
  {
    "start": "463000",
    "end": "463000"
  },
  {
    "text": "portable back-end on the other hand uses LLVM and it converts your decks byte",
    "start": "463249",
    "end": "470089"
  },
  {
    "text": "code into LLVM bit code then does some",
    "start": "470089",
    "end": "475159"
  },
  {
    "text": "optimizations on it and then use one of the LM vm LLVM packets to generate code",
    "start": "475159",
    "end": "481429"
  },
  {
    "text": "for your device now I mentioned earlier a boot that out file this is a sort of a",
    "start": "481429",
    "end": "487639"
  },
  {
    "text": "master file where all the most commonly used frameworks and libraries in android",
    "start": "487639",
    "end": "493789"
  },
  {
    "text": "will be compiled in so it's a single out file where that contains all the code",
    "start": "493789",
    "end": "499639"
  },
  {
    "text": "from a different framework charged in the boot last path so these are all",
    "start": "499639",
    "end": "506179"
  },
  {
    "text": "preloaded into of the applications that you installed so here you can see an",
    "start": "506179",
    "end": "511879"
  },
  {
    "text": "example command line where the the parameter for Dex - oh there's a - - Dex",
    "start": "511879",
    "end": "519620"
  },
  {
    "text": "file there's a lot of - Dex file options and each option will help a single",
    "start": "519620",
    "end": "528339"
  },
  {
    "text": "framework jar and she can be found in the system framework folder",
    "start": "528339",
    "end": "533540"
  },
  {
    "text": "so these are all compiled into a single out file called put that out and here's",
    "start": "533540",
    "end": "539990"
  },
  {
    "text": "a list speaker list of all the the framerate jars that is included at least",
    "start": "539990",
    "end": "546170"
  },
  {
    "text": "in the Nexus device that I have tested so they include some double core",
    "start": "546170",
    "end": "553180"
  },
  {
    "text": "framework jar cocoa ap ice and some",
    "start": "553180",
    "end": "558620"
  },
  {
    "text": "stuff for HTTP and some messenger messaging API so I mention also mention",
    "start": "558620",
    "end": "566780"
  },
  {
    "start": "566000",
    "end": "566000"
  },
  {
    "text": "earlier about the boot image it's a file name system at framework at boot that",
    "start": "566780",
    "end": "574370"
  },
  {
    "text": "art this is also found in the dalvik cache folder and it contains",
    "start": "574370",
    "end": "579640"
  },
  {
    "text": "reinitialize classes and objects from the framework it contains pointers to",
    "start": "579640",
    "end": "586250"
  },
  {
    "text": "methods in boot that both and essentially your application will refer to this image every time it calls",
    "start": "586250",
    "end": "595100"
  },
  {
    "text": "something from the framework so so as an analogy it could it could you can think",
    "start": "595100",
    "end": "601520"
  },
  {
    "text": "of it as like a import table in portable executable wherein you can you can you",
    "start": "601520",
    "end": "608480"
  },
  {
    "text": "can access the addresses of of the methods in the framework through here",
    "start": "608480",
    "end": "614390"
  },
  {
    "text": "and not not using the edges in the boot that owed directly so this is loaded by",
    "start": "614390",
    "end": "621620"
  },
  {
    "text": "these I got along with booted out and here's a typical layout of it once it's",
    "start": "621620",
    "end": "630500"
  },
  {
    "start": "625000",
    "end": "625000"
  },
  {
    "text": "map into memory so your applications will have a similar one map into its",
    "start": "630500",
    "end": "636230"
  },
  {
    "text": "memory space it starts with a good dot art file and the rest of sections of the",
    "start": "636230",
    "end": "643640"
  },
  {
    "text": "boot that ode file will follow use the",
    "start": "643640",
    "end": "649220"
  },
  {
    "start": "649000",
    "end": "649000"
  },
  {
    "text": "file format for the art image it starts",
    "start": "649220",
    "end": "654530"
  },
  {
    "text": "with a magic with an art string to mark",
    "start": "654530",
    "end": "659750"
  },
  {
    "text": "it as an art file followed by line feed then a version which is currently set to I think twelve",
    "start": "659750",
    "end": "666720"
  },
  {
    "text": "and the rest of the fields are just feels that describes the linked boot",
    "start": "666720",
    "end": "674070"
  },
  {
    "text": "that older girls appear so and also has",
    "start": "674070",
    "end": "679320"
  },
  {
    "text": "the information about the base address of the image and size etc but we this",
    "start": "679320",
    "end": "686280"
  },
  {
    "text": "this art image is less significant in",
    "start": "686280",
    "end": "692490"
  },
  {
    "text": "stock than the following don't file for me the old file format is essentially",
    "start": "692490",
    "end": "699090"
  },
  {
    "start": "693000",
    "end": "693000"
  },
  {
    "text": "just an earth dynamic object it's which is in the elf file format the extension",
    "start": "699090",
    "end": "706500"
  },
  {
    "text": "extension use is not owed for booted out and got decks for regular applications",
    "start": "706500",
    "end": "716060"
  },
  {
    "text": "you can locate in which part of the elf",
    "start": "716660",
    "end": "722190"
  },
  {
    "text": "file you can find out related data by looking up the dynamic symbol tables with the following names oh they are",
    "start": "722190",
    "end": "729450"
  },
  {
    "text": "both exact and old last word the you can",
    "start": "729450",
    "end": "735930"
  },
  {
    "text": "see here the same value field the symbol table indicates where you can find it in",
    "start": "735930",
    "end": "743490"
  },
  {
    "text": "the elf file the old data section contains headers and metadata and also",
    "start": "743490",
    "end": "749970"
  },
  {
    "text": "it contains the original Dex file that the the author the old files have been",
    "start": "749970",
    "end": "756360"
  },
  {
    "text": "compiled from Oh exact contains the compiled code and outlast which is an",
    "start": "756360",
    "end": "761700"
  },
  {
    "text": "end marker so you can treat so when you say an old file you can just treat the",
    "start": "761700",
    "end": "767010"
  },
  {
    "text": "start of out data until the the four bytes included in old last word as a",
    "start": "767010",
    "end": "773910"
  },
  {
    "text": "single blob and in in afterwards when I",
    "start": "773910",
    "end": "779130"
  },
  {
    "text": "mentioned something about offsets it means that it is relative to the start of both data alternatively you can also",
    "start": "779130",
    "end": "789830"
  },
  {
    "text": "locate the auth data and out exact through elfs sections but the section in",
    "start": "789830",
    "end": "797820"
  },
  {
    "text": "RO data which is read on the data contain will contain the auth data and",
    "start": "797820",
    "end": "803930"
  },
  {
    "text": "the section name dot tax which contains executable code will contain or accept",
    "start": "803930",
    "end": "810030"
  },
  {
    "text": "so this is a basic layout a note file it",
    "start": "810030",
    "end": "816030"
  },
  {
    "text": "starts with an odd header followed by several hex file headers each code text",
    "start": "816030",
    "end": "823740"
  },
  {
    "text": "file header represents class that Dex that has been compiled so for normal",
    "start": "823740",
    "end": "829710"
  },
  {
    "text": "applications there's going to be only one or Dex file header but in the case of the one that I showed you earlier the",
    "start": "829710",
    "end": "837300"
  },
  {
    "text": "in the case of boot that there can be several or Dex file headers Oh Dex file",
    "start": "837300",
    "end": "842580"
  },
  {
    "text": "headers points also points to the embedded Dex file inside the old so your",
    "start": "842580",
    "end": "849420"
  },
  {
    "text": "so when you compile an application the classes that Dex that contains the",
    "start": "849420",
    "end": "854520"
  },
  {
    "text": "original bytecode will also embed it inside the old file so it really helps",
    "start": "854520",
    "end": "860010"
  },
  {
    "text": "when you're parsing because you don't have to refer to an outside file whenever you want to parse because we",
    "start": "860010",
    "end": "865950"
  },
  {
    "text": "are also going to use some some other information inside the Dex files",
    "start": "865950",
    "end": "871200"
  },
  {
    "text": "itself so the Dex file header also contains the offsets to all classes hers",
    "start": "871200",
    "end": "879990"
  },
  {
    "text": "which describes all the classes inside that Dex are all the classes that your",
    "start": "879990",
    "end": "885780"
  },
  {
    "text": "application uses or that framework uses the old plus errors on ER and contains",
    "start": "885780",
    "end": "891900"
  },
  {
    "text": "the pointers to to the old codes the generated native code for each method",
    "start": "891900",
    "end": "896940"
  },
  {
    "text": "that you test so here's the structure for the ODE",
    "start": "896940",
    "end": "903720"
  },
  {
    "start": "901000",
    "end": "901000"
  },
  {
    "text": "header is you know it starts with a magic value and it's set currently it's",
    "start": "903720",
    "end": "910170"
  },
  {
    "text": "at the Oh a t string called the beltline field and the version is currently 45",
    "start": "910170",
    "end": "917510"
  },
  {
    "text": "and the fault is followed by some check",
    "start": "917510",
    "end": "922920"
  },
  {
    "text": "sums to to verify that for integrity checking and then there's also on an",
    "start": "922920",
    "end": "929310"
  },
  {
    "text": "instruction set field which indicates what what the target architecture was when",
    "start": "929310",
    "end": "935620"
  },
  {
    "text": "upon compilation and currently there are six architecture supported arm arms 54",
    "start": "935620",
    "end": "948220"
  },
  {
    "text": "thumb two and x86 x64 MIPS and 64-bit",
    "start": "948220",
    "end": "953950"
  },
  {
    "text": "MIPS another relevant field here is the",
    "start": "953950",
    "end": "961300"
  },
  {
    "text": "dex file count which is the number of Dex files in the out file so for normal",
    "start": "961300",
    "end": "966730"
  },
  {
    "text": "applications it's one for for boot that odd can be a lot more than ten or",
    "start": "966730",
    "end": "974740"
  },
  {
    "text": "sixteen and the executable offset is offset to the executable code in the in",
    "start": "974740",
    "end": "981310"
  },
  {
    "text": "the code file it is so relative to the start of the old header it's it's the",
    "start": "981310",
    "end": "988930"
  },
  {
    "text": "same section pointed to by the old xx section that I mentioned earlier okay",
    "start": "988930",
    "end": "995310"
  },
  {
    "text": "another relevant field for purposes is the last one which is the key value store it's a dictionary containing",
    "start": "995310",
    "end": "1002970"
  },
  {
    "text": "information such as the command line use to generate this out file so we're going",
    "start": "1002970",
    "end": "1008790"
  },
  {
    "text": "to use that later on ok right after the",
    "start": "1008790",
    "end": "1015450"
  },
  {
    "text": "oat error is an array of odd next file headers one for each text file that was",
    "start": "1015450",
    "end": "1022200"
  },
  {
    "text": "compiled so there's an important field",
    "start": "1022200",
    "end": "1027420"
  },
  {
    "text": "here that we're going to use later called dex file location data it is the original path of the our input dex file",
    "start": "1027420",
    "end": "1035069"
  },
  {
    "text": "so it's the path to the apk or to the jar that was compiled to generate this and there's also the text file occasions",
    "start": "1035070",
    "end": "1042689"
  },
  {
    "text": "checksum which is the crc32 of the classes that Dex that was compiled",
    "start": "1042690",
    "end": "1048540"
  },
  {
    "text": "inside that apk a text file pointer is the offset relative to use a sort of the",
    "start": "1048540",
    "end": "1055410"
  },
  {
    "text": "header into to your to the embedded Dex file inside all table now I mentioned",
    "start": "1055410",
    "end": "1063570"
  },
  {
    "text": "earlier that it's nice to have nice to have an embedded the original",
    "start": "1063570",
    "end": "1069250"
  },
  {
    "text": "embedded text file inside the old the reason for this is the following this field the class's offsets field it is",
    "start": "1069250",
    "end": "1076240"
  },
  {
    "text": "the the not is on a list of offsets to",
    "start": "1076240",
    "end": "1081400"
  },
  {
    "text": "to the old class headers and length of this list is the size this is the class",
    "start": "1081400",
    "end": "1088600"
  },
  {
    "text": "that side field of the text file header so you can use the embedded text file header to parse the class's offsets",
    "start": "1088600",
    "end": "1095530"
  },
  {
    "text": "field so each classes class offset points to an old class header and don't",
    "start": "1095530",
    "end": "1107760"
  },
  {
    "start": "1099000",
    "end": "1099000"
  },
  {
    "text": "use an interesting field here is the type which indicates how much how much",
    "start": "1107760",
    "end": "1113170"
  },
  {
    "text": "of the methods were compiled you can configure your device or get figure art",
    "start": "1113170",
    "end": "1120220"
  },
  {
    "text": "to use different kinds of criteria on which methods will compile you can",
    "start": "1120220",
    "end": "1125410"
  },
  {
    "text": "choose whether to compile everything and you can choose only to compile all the",
    "start": "1125410",
    "end": "1131560"
  },
  {
    "text": "performance intensive ones or you can also choose to compile the only the",
    "start": "1131560",
    "end": "1137890"
  },
  {
    "text": "smaller or the or or or you can all choose to compile only the ones there",
    "start": "1137890",
    "end": "1144520"
  },
  {
    "text": "meets the criteria on the size of the methods and you can look it up on happen",
    "start": "1144520",
    "end": "1152290"
  },
  {
    "text": "if you look up how to set the settings in the link shown here",
    "start": "1152290",
    "end": "1158190"
  },
  {
    "text": "so the the type indicates how much of the methods were compiled so if type is",
    "start": "1158190",
    "end": "1165000"
  },
  {
    "text": "so it can have 3 different values 0 1 or 2 so 0 is out class all compiled to one is",
    "start": "1165000",
    "end": "1173920"
  },
  {
    "text": "authorized some compiled and 2 is co k out let's non compile",
    "start": "1173920",
    "end": "1179590"
  },
  {
    "text": "so if type is k out some compile there will be a bitmap size and bitmap field",
    "start": "1179590",
    "end": "1186850"
  },
  {
    "text": "following the type field if if type is",
    "start": "1186850",
    "end": "1192250"
  },
  {
    "text": "one of the all compiled or non compiled this that these two",
    "start": "1192250",
    "end": "1199270"
  },
  {
    "text": "will not exist and right after the type field will be the method offsets the ko",
    "start": "1199270",
    "end": "1205380"
  },
  {
    "text": "non compiled means that the that none of",
    "start": "1205380",
    "end": "1210580"
  },
  {
    "text": "the methods of this class were compiled and those methods will be interpreted instead if type is ko class I'll compile",
    "start": "1210580",
    "end": "1219850"
  },
  {
    "text": "all the methods of this particular class were compiled",
    "start": "1219850",
    "end": "1225190"
  },
  {
    "text": "now if type is Kayode some compiled there's going to be a bitmap with each",
    "start": "1225190",
    "end": "1232810"
  },
  {
    "text": "bit in the bitmap representing a method of this class and if that said is if",
    "start": "1232810",
    "end": "1237850"
  },
  {
    "text": "that bit is set this mess it means this",
    "start": "1237850",
    "end": "1243760"
  },
  {
    "text": "method was compiled and for each compiled method there's going to be an",
    "start": "1243760",
    "end": "1248770"
  },
  {
    "text": "entry in the method offsets field so the method offset fields points to the",
    "start": "1248770",
    "end": "1256000"
  },
  {
    "text": "generate native native code so now we know how to locate where the generated",
    "start": "1256000",
    "end": "1262450"
  },
  {
    "text": "code for that methods are but take note that for a case on in architecture if",
    "start": "1262450",
    "end": "1267870"
  },
  {
    "text": "the instruction set field in the auditor is equal to km to the code set we'll",
    "start": "1267870",
    "end": "1276190"
  },
  {
    "text": "have called offset we have the least significant bit set so for example for",
    "start": "1276190",
    "end": "1282340"
  },
  {
    "text": "method offset 0 0 1 4 3 3 6 1 the actual start of the native code is at offset",
    "start": "1282340",
    "end": "1287590"
  },
  {
    "text": "this 1 4 3 0 6 0 so now we know how to",
    "start": "1287590",
    "end": "1293350"
  },
  {
    "text": "locate the methods but there's also some other additional information if the",
    "start": "1293350",
    "end": "1299320"
  },
  {
    "start": "1295000",
    "end": "1295000"
  },
  {
    "text": "backend that you use is the quick backend there's a old quick method",
    "start": "1299320",
    "end": "1304990"
  },
  {
    "text": "header right before the start of your",
    "start": "1304990",
    "end": "1310240"
  },
  {
    "text": "native code it contains a mapping between registers and IP native code and",
    "start": "1310240",
    "end": "1317110"
  },
  {
    "text": "the other code and most importantly it contains the code side code code size of your generated native code so if you",
    "start": "1317110",
    "end": "1324490"
  },
  {
    "text": "want to take the size of the code that you generated that has been generated",
    "start": "1324490",
    "end": "1329650"
  },
  {
    "text": "for that method you take the four bytes priority start of the generated method code so I",
    "start": "1329650",
    "end": "1338960"
  },
  {
    "text": "skim a lot of information here but if you're more interested in this there's more details in the companion paper that",
    "start": "1338960",
    "end": "1346970"
  },
  {
    "text": "you can download from the blackhat website after this okay so let's go into",
    "start": "1346970",
    "end": "1354650"
  },
  {
    "text": "the core of the stop which is the user mode rootkits",
    "start": "1354650",
    "end": "1362080"
  },
  {
    "text": "so our approach is basically we use Dex tool to generate odd files from modified",
    "start": "1364330",
    "end": "1372710"
  },
  {
    "start": "1365000",
    "end": "1365000"
  },
  {
    "text": "framework or app and replace the original one there's we have two options",
    "start": "1372710",
    "end": "1379250"
  },
  {
    "text": "we can replace framer code and generate a new boot art and put that out and",
    "start": "1379250",
    "end": "1385220"
  },
  {
    "text": "replace the system-generated one or it can replace a specific applications code",
    "start": "1385220",
    "end": "1390470"
  },
  {
    "text": "and generate new old for that and replace things that that installed applications old file and obviously we",
    "start": "1390470",
    "end": "1399550"
  },
  {
    "text": "require a result to do all this so the",
    "start": "1399550",
    "end": "1407720"
  },
  {
    "start": "1406000",
    "end": "1406000"
  },
  {
    "text": "advantages of this approach is that there's no low-level code required our",
    "start": "1407720",
    "end": "1413840"
  },
  {
    "text": "code modifications are all done in Java so there will be less problems",
    "start": "1413840",
    "end": "1419660"
  },
  {
    "text": "encountered compared to doing all of this in a low-level code or doing all",
    "start": "1419660",
    "end": "1426500"
  },
  {
    "text": "this in the kernel another advantage that our techniques is less affected by",
    "start": "1426500",
    "end": "1433820"
  },
  {
    "text": "variations in architecture and OS version the same approach works regardless of the arc and iOS and OS the",
    "start": "1433820",
    "end": "1442220"
  },
  {
    "text": "reason for this is that we are simply using the Dex code itself or art itself",
    "start": "1442220",
    "end": "1447230"
  },
  {
    "text": "to generate our code so there's less space for errors another advantage that",
    "start": "1447230",
    "end": "1454820"
  },
  {
    "text": "we don't have to deal with code signing at all since your apps are already installed it's already verified all we",
    "start": "1454820",
    "end": "1462740"
  },
  {
    "text": "we have to do we all you're doing is change the code that has been taken out",
    "start": "1462740",
    "end": "1468790"
  },
  {
    "text": "and compiled outside of the application package so we don't have to deal at all with code signing also and these",
    "start": "1468790",
    "end": "1478900"
  },
  {
    "text": "techniques our code runs under the context of the app running it so it will",
    "start": "1478900",
    "end": "1485170"
  },
  {
    "text": "have the same UID and a permissions automatically for example if our code is",
    "start": "1485170",
    "end": "1492700"
  },
  {
    "text": "running under the Settings app your code will have a system UID and you can have",
    "start": "1492700",
    "end": "1500850"
  },
  {
    "text": "you can obtain permissions that you will normally be able to obtain if you're running as a regular app such as the",
    "start": "1500850",
    "end": "1507460"
  },
  {
    "text": "ability to reboot ability to write secure settings and mount and mount file",
    "start": "1507460",
    "end": "1512890"
  },
  {
    "text": "systems and or to or to clear an applications user data",
    "start": "1512890",
    "end": "1518070"
  },
  {
    "text": "how about persistence our code persists for as long as the old file is not",
    "start": "1518070",
    "end": "1524890"
  },
  {
    "start": "1519000",
    "end": "1519000"
  },
  {
    "text": "replace that the old file is only a place like I said whenever you you you",
    "start": "1524890",
    "end": "1534850"
  },
  {
    "text": "do an OTA update or whenever that doubt for that application or that application",
    "start": "1534850",
    "end": "1541210"
  },
  {
    "text": "is updated but our goal is not to maintain with access because we are",
    "start": "1541210",
    "end": "1548110"
  },
  {
    "text": "avoiding because our goal here is not to write the system or not to have anything to do with system partition at all and",
    "start": "1548110",
    "end": "1554890"
  },
  {
    "text": "the normal route kids will will maintain or it access by modifying some files in",
    "start": "1554890",
    "end": "1560050"
  },
  {
    "text": "it or writing some files on it but we do have the option to reacquire root access using a system through it exploit if you",
    "start": "1560050",
    "end": "1568630"
  },
  {
    "text": "are your code is running under system privileges but this is left as an",
    "start": "1568630",
    "end": "1574570"
  },
  {
    "text": "exercise to the reader now our first option is to replace",
    "start": "1574570",
    "end": "1580570"
  },
  {
    "start": "1578000",
    "end": "1578000"
  },
  {
    "text": "framework code here we replace a frame jars code with our own then used X tool",
    "start": "1580570",
    "end": "1588100"
  },
  {
    "text": "to generate a new boot art and put that all that includes our modified jar if",
    "start": "1588100",
    "end": "1594760"
  },
  {
    "text": "you remember earlier I showed the command line for four decks too old when generating",
    "start": "1594760",
    "end": "1600970"
  },
  {
    "text": "booted out and there's a lot of decks - - text file parameters and you could",
    "start": "1600970",
    "end": "1608020"
  },
  {
    "text": "replace one of those jars with your own with a version that contains your",
    "start": "1608020",
    "end": "1614140"
  },
  {
    "text": "modified code then we after you have generated your own copy of boot that",
    "start": "1614140",
    "end": "1622180"
  },
  {
    "text": "thought you can replace the old one with it so for our purposes because you want",
    "start": "1622180",
    "end": "1628600"
  },
  {
    "text": "to need to create you lose rootkit you want to hide running processes hide",
    "start": "1628600",
    "end": "1634300"
  },
  {
    "text": "files and the hide installed apps but anymore so here's some of the methods",
    "start": "1634300",
    "end": "1642970"
  },
  {
    "text": "that we could target there's if we want to hide a running process we could we",
    "start": "1642970",
    "end": "1652510"
  },
  {
    "text": "could replace or modify the method get running app processes which it can be",
    "start": "1652510",
    "end": "1658930"
  },
  {
    "text": "found in the activity manager class and the source code for this can be found in the ASP under the frameworks base core",
    "start": "1658930",
    "end": "1666520"
  },
  {
    "text": "folder in the Java source file activity measure the when compiled this will be",
    "start": "1666520",
    "end": "1675100"
  },
  {
    "text": "inside the framework dot jar file which can be found on your device in system",
    "start": "1675100",
    "end": "1682620"
  },
  {
    "text": "slash framework if you want to hide installed app you you get you you modify",
    "start": "1682620",
    "end": "1691120"
  },
  {
    "text": "the get installed applications method in application package manager this is can",
    "start": "1691120",
    "end": "1696220"
  },
  {
    "text": "also be found under the same folder in ASP in the application package manager",
    "start": "1696220",
    "end": "1702880"
  },
  {
    "text": "in Java source file and the result is also inside for America char if you want",
    "start": "1702880",
    "end": "1709840"
  },
  {
    "text": "to hide files from for example and a file explorer application you can",
    "start": "1709840",
    "end": "1718120"
  },
  {
    "text": "replace the method file names of files in the file class in in the source file",
    "start": "1718120",
    "end": "1724720"
  },
  {
    "text": "found in ASP in Lib core loonie in the file file dot java",
    "start": "1724720",
    "end": "1731860"
  },
  {
    "text": "is on the other hand will be placed in the core Leibert char file so as as an",
    "start": "1731860",
    "end": "1741580"
  },
  {
    "text": "example let's look at how to hide a running process as I've said we replace",
    "start": "1741580",
    "end": "1747220"
  },
  {
    "text": "the get running app processes with whose source code can be found in activity manager that Java and the build results",
    "start": "1747220",
    "end": "1755559"
  },
  {
    "text": "are in framework that char now here's the original source code for that method",
    "start": "1755559",
    "end": "1762760"
  },
  {
    "text": "so as you can see it simply returns a list running app running app process",
    "start": "1762760",
    "end": "1770470"
  },
  {
    "text": "info class this class contains information about the running app",
    "start": "1770470",
    "end": "1777600"
  },
  {
    "text": "process including the process name for that running up the application so we",
    "start": "1777600",
    "end": "1784090"
  },
  {
    "text": "need to modify the list that it returns",
    "start": "1784090",
    "end": "1788820"
  },
  {
    "text": "so here's a modification that we did we simply iterate through the list before",
    "start": "1789360",
    "end": "1797890"
  },
  {
    "text": "it is returned and remove the entry for for our for the application that we want",
    "start": "1797890",
    "end": "1806140"
  },
  {
    "text": "to hide in this case come that possible that better",
    "start": "1806140",
    "end": "1810990"
  },
  {
    "text": "okay after we have done the modification we have to build a modified code and not",
    "start": "1818200",
    "end": "1824379"
  },
  {
    "text": "because we are going to use this modified framework that jar as a source for text too old but we need to get the",
    "start": "1824379",
    "end": "1831450"
  },
  {
    "text": "the we need to get the smelly code or the the bytecode for this we can't use",
    "start": "1831450",
    "end": "1840129"
  },
  {
    "text": "this as a source for the X tool because it might have your version that you can",
    "start": "1840129",
    "end": "1846190"
  },
  {
    "text": "file may have some in comparative problems with the ones in the other jar",
    "start": "1846190",
    "end": "1851769"
  },
  {
    "text": "files installed on your device so what we're going to do is is take out the frame of that jar file on your device",
    "start": "1851769",
    "end": "1858700"
  },
  {
    "text": "and modify that instead so we used a pi/2 to decode the resulting jar and",
    "start": "1858700",
    "end": "1865269"
  },
  {
    "text": "locate the generate smelly for the method that we modified and we're going",
    "start": "1865269",
    "end": "1871450"
  },
  {
    "text": "to use the generated smelly later to replace the original one so you can you",
    "start": "1871450",
    "end": "1876609"
  },
  {
    "text": "can automate all this but here's how to do it manually and you can do this on your device using ADB or but make sure",
    "start": "1876609",
    "end": "1885279"
  },
  {
    "text": "it's a really device though so step one is you've modified the target method you",
    "start": "1885279",
    "end": "1891700"
  },
  {
    "text": "take the small generated here earlier and replace the one in the the jar file",
    "start": "1891700",
    "end": "1899559"
  },
  {
    "text": "install from on your device so you pull the original jar from the system partition use apktool to decode that jar",
    "start": "1899559",
    "end": "1908320"
  },
  {
    "text": "and generates Mallicoat then look for your target method inside the generated",
    "start": "1908320",
    "end": "1914230"
  },
  {
    "text": "ones inside the various Mally then replace that with the smelly code orbital method for the dismally code for",
    "start": "1914230",
    "end": "1921340"
  },
  {
    "text": "the method that you generated earlier and after you replace it you rebuild the",
    "start": "1921340",
    "end": "1926649"
  },
  {
    "text": "jar using apktool it doesn't matter if the jar that you rebuilt is not 100% the",
    "start": "1926649",
    "end": "1935470"
  },
  {
    "text": "same with the one digit pool aside from the code though we aren't the only",
    "start": "1935470",
    "end": "1941230"
  },
  {
    "text": "important part of this is the classes that dex the resources are not important",
    "start": "1941230",
    "end": "1946299"
  },
  {
    "text": "so after you've done that you have rename the jar such that the resulting",
    "start": "1946299",
    "end": "1953740"
  },
  {
    "text": "path after you have pushed the device is the same length with the path of the original jar in the system partition now",
    "start": "1953740",
    "end": "1960370"
  },
  {
    "text": "why you have to do this we need to our-our-our that the old file that we",
    "start": "1960370",
    "end": "1968140"
  },
  {
    "text": "generate only requires two parts that",
    "start": "1968140",
    "end": "1973570"
  },
  {
    "text": "has to match with the old one I'll that is the the path of the of the source of",
    "start": "1973570",
    "end": "1982120"
  },
  {
    "text": "the source apk or jar which can be fun which I mentioned earlier the Dex",
    "start": "1982120",
    "end": "1987820"
  },
  {
    "text": "location path data field in the old class header it has to match with the",
    "start": "1987820",
    "end": "1993670"
  },
  {
    "text": "original one and also the checksum for the classic text which is the old",
    "start": "1993670",
    "end": "1999160"
  },
  {
    "text": "location file data checksum field in the ultra set it also has to match with the original ones match or else we will fail",
    "start": "1999160",
    "end": "2007230"
  },
  {
    "text": "Dex what will will not compile your modifications so since we need to",
    "start": "2007230",
    "end": "2017630"
  },
  {
    "text": "replace our the path in a january old file with the original one we need to",
    "start": "2017630",
    "end": "2025370"
  },
  {
    "text": "make it the same length so we don't have to to reallocate some offsets or move",
    "start": "2025370",
    "end": "2030870"
  },
  {
    "text": "because and we don't have to move around stuff and we calculate the offsets in",
    "start": "2030870",
    "end": "2036060"
  },
  {
    "text": "the the subsequent fields of the headers so we need to make it the same length so",
    "start": "2036060",
    "end": "2042690"
  },
  {
    "text": "we can just patch it later on as is not",
    "start": "2042690",
    "end": "2049080"
  },
  {
    "text": "and then we should also get the checksum of the original classes the text which",
    "start": "2049080",
    "end": "2055260"
  },
  {
    "text": "is also we will patch to the old file later now after we've done that and",
    "start": "2055260",
    "end": "2065040"
  },
  {
    "text": "we've pushed the modified jar into the device we delete the original boot that out then we retrieve the command line",
    "start": "2065040",
    "end": "2073560"
  },
  {
    "text": "used to generate the original boot that out we can get this from the key value store filled in the hotel if you",
    "start": "2073560",
    "end": "2082050"
  },
  {
    "text": "remember there is a key value store field that's a dictionary that contains the",
    "start": "2082050",
    "end": "2088240"
  },
  {
    "text": "command-line used to generate the blood at all now after we have retrieved the",
    "start": "2088240",
    "end": "2094809"
  },
  {
    "text": "command-line we replace all references to our target jar with the path of a modified jar so in this case you see",
    "start": "2094809",
    "end": "2101769"
  },
  {
    "text": "here the red ones used to be used to point to slash system framework slash",
    "start": "2101769",
    "end": "2108130"
  },
  {
    "text": "framework that jar like the other Dex",
    "start": "2108130",
    "end": "2113500"
  },
  {
    "text": "file parameters and you have to replace all reference to that into the location",
    "start": "2113500",
    "end": "2119170"
  },
  {
    "text": "of where we pushed our own modified jar file after we've done that you run Dex",
    "start": "2119170",
    "end": "2125319"
  },
  {
    "text": "to old now if all that was successful we",
    "start": "2125319",
    "end": "2131589"
  },
  {
    "text": "need to take that boot out again because we have to patch the path and the",
    "start": "2131589",
    "end": "2137019"
  },
  {
    "text": "checksum in the dex file location data and in the dex file location checksum",
    "start": "2137019",
    "end": "2144630"
  },
  {
    "text": "after we Apache we return it if we push it again into the device in the its",
    "start": "2145380",
    "end": "2152259"
  },
  {
    "text": "original location then for the changes to take effect we have to restart by God",
    "start": "2152259",
    "end": "2158680"
  },
  {
    "text": "or restart the device you can do this by using the following command stops I got",
    "start": "2158680",
    "end": "2163720"
  },
  {
    "text": "then Sarge's I got after you've done that your installed all your installed",
    "start": "2163720",
    "end": "2170140"
  },
  {
    "text": "apps will be compiled it will be recompiled but one downside of this",
    "start": "2170140",
    "end": "2175240"
  },
  {
    "text": "approach is that if you have a lot of apps installed the user will normally notice what you've done because there's",
    "start": "2175240",
    "end": "2182019"
  },
  {
    "text": "going to be a sort of message that says planning apps or something similar or",
    "start": "2182019",
    "end": "2188529"
  },
  {
    "text": "something like that but our next option",
    "start": "2188529",
    "end": "2194339"
  },
  {
    "start": "2194000",
    "end": "2194000"
  },
  {
    "text": "we won't have that downside because we here we are replacing um specific app",
    "start": "2194789",
    "end": "2202990"
  },
  {
    "text": "instead of a system framework char it affects only a single app so less it's less intrusive than replacing put that",
    "start": "2202990",
    "end": "2210039"
  },
  {
    "text": "all the downside is it only affects the apps you specifically target so",
    "start": "2210039",
    "end": "2217350"
  },
  {
    "text": "if we only target a single app to hide your malicious applications when they",
    "start": "2217350",
    "end": "2223200"
  },
  {
    "text": "usually use another app your changes will not take effect also apps are",
    "start": "2223200",
    "end": "2230040"
  },
  {
    "text": "updated more frequently especially user apps for system apps not so much on the",
    "start": "2230040",
    "end": "2236880"
  },
  {
    "text": "other hand on the previous approach which is replacing boot that owed you only apps are updated only upon device",
    "start": "2236880",
    "end": "2247460"
  },
  {
    "text": "upgrade or OTA updates so your your",
    "start": "2247460",
    "end": "2253460"
  },
  {
    "text": "changes will be will persist longer okay",
    "start": "2253460",
    "end": "2259380"
  },
  {
    "text": "so let's look at an example replacing app code so in this example we are going to replace the code in the settings apk",
    "start": "2259380",
    "end": "2267110"
  },
  {
    "text": "this is a the Cenex apk is the well you",
    "start": "2267110",
    "end": "2272280"
  },
  {
    "text": "can find it usually on your you're a droid device its installs default it",
    "start": "2272280",
    "end": "2278910"
  },
  {
    "text": "shows the running process and installed apps among other information and you can find the original apk in the system",
    "start": "2278910",
    "end": "2287190"
  },
  {
    "text": "partition improve app settings setting stop apk the source code for this can",
    "start": "2287190",
    "end": "2292650"
  },
  {
    "text": "they also be found in a CSP in the packaged apps settings folder so for",
    "start": "2292650",
    "end": "2300690"
  },
  {
    "text": "example if you want to hide our app from the running process list we look for",
    "start": "2300690",
    "end": "2306060"
  },
  {
    "text": "calls to the get running app processes then we modified the returned running a",
    "start": "2306060",
    "end": "2312930"
  },
  {
    "text": "process info list so for example you can this is the code that's responsible for",
    "start": "2312930",
    "end": "2320550"
  },
  {
    "text": "that in settings in the Settings app so",
    "start": "2320550",
    "end": "2326430"
  },
  {
    "text": "here you see is calling the get run running app processes and place it in and the list running a process info in",
    "start": "2326430",
    "end": "2334380"
  },
  {
    "text": "the processes variable and so once you once it is called that we modify the",
    "start": "2334380",
    "end": "2342390"
  },
  {
    "text": "processes variable and we remove our application we iterate",
    "start": "2342390",
    "end": "2350770"
  },
  {
    "text": "through it and if one of the application running a process info matches our",
    "start": "2350770",
    "end": "2357430"
  },
  {
    "text": "applications name we remove it now to install to hide our app from the installed apps list we look for calls to",
    "start": "2357430",
    "end": "2364630"
  },
  {
    "text": "get installed applications and modify also the returned application info list and here's an example that we the code",
    "start": "2364630",
    "end": "2372240"
  },
  {
    "text": "responsible for this it can be found in the application state dot Java in the",
    "start": "2372240",
    "end": "2377740"
  },
  {
    "text": "settings source code so here we also iterate the returned list of get",
    "start": "2377740",
    "end": "2384130"
  },
  {
    "text": "installed applications and remove the application info for the app that for",
    "start": "2384130",
    "end": "2392920"
  },
  {
    "text": "the malicious app between salt because to do this manually is the steps involve",
    "start": "2392920",
    "end": "2400570"
  },
  {
    "text": "is almost similar to the ones in boot that out when we generate the boot that old with a few differences so we pulled",
    "start": "2400570",
    "end": "2408790"
  },
  {
    "text": "the original APK from its allocation and use apk to to decode the APK and generates Mallicoat then we use the",
    "start": "2408790",
    "end": "2416260"
  },
  {
    "text": "modification modified APK here earlier and rebuild that it became then as we",
    "start": "2416260",
    "end": "2423970"
  },
  {
    "text": "did with the boot that out we rename the APK such that the resulting resulting path after you have pushed the device",
    "start": "2423970",
    "end": "2430060"
  },
  {
    "text": "the same length with the path of the original APK so we simply added some",
    "start": "2430060",
    "end": "2435069"
  },
  {
    "text": "characters before this the name of the settings that apk name so that it matches the length of the original path",
    "start": "2435069",
    "end": "2441849"
  },
  {
    "text": "of the settings APK and also we get the",
    "start": "2441849",
    "end": "2447130"
  },
  {
    "text": "checksum of the original test that dex and then we prepare to our next tool we",
    "start": "2447130",
    "end": "2455770"
  },
  {
    "text": "delete the original old file and push our modified APK to the device and now",
    "start": "2455770",
    "end": "2463150"
  },
  {
    "text": "it's time to generate our own the command-line involved here is much",
    "start": "2463150",
    "end": "2468609"
  },
  {
    "text": "simpler you can also parse the all the",
    "start": "2468609",
    "end": "2474579"
  },
  {
    "text": "original code file and part is key store value",
    "start": "2474579",
    "end": "2479680"
  },
  {
    "text": "field to get the the command line you use to generate it but you can also do a",
    "start": "2479680",
    "end": "2486099"
  },
  {
    "text": "simple wave here which is you assign our",
    "start": "2486099",
    "end": "2491520"
  },
  {
    "text": "modified apks path into the - - Dex file primer and then put the the original old",
    "start": "2491520",
    "end": "2501160"
  },
  {
    "text": "files path which is in the dalvik cache folder into the old file parameter so that's it here's an example of that next",
    "start": "2501160",
    "end": "2510520"
  },
  {
    "text": "world command so if that was successful",
    "start": "2510520",
    "end": "2515680"
  },
  {
    "text": "we could then pass the generated old files index path and checksum like we",
    "start": "2515680",
    "end": "2521440"
  },
  {
    "text": "did before then we start the app we do",
    "start": "2521440",
    "end": "2528609"
  },
  {
    "text": "that by stopping the app process or if it's running we do that by using the",
    "start": "2528609",
    "end": "2534400"
  },
  {
    "text": "following command I am for stop then the package name of the application so the",
    "start": "2534400",
    "end": "2541150"
  },
  {
    "text": "changes will take effect at the next time the app is run so these techniques",
    "start": "2541150",
    "end": "2550690"
  },
  {
    "start": "2549000",
    "end": "2549000"
  },
  {
    "text": "have several limitations which one of those is we can't hide from lower level",
    "start": "2550690",
    "end": "2557049"
  },
  {
    "text": "or non framework code so if you our changes are made into the framework we",
    "start": "2557049",
    "end": "2562390"
  },
  {
    "text": "can't hide it if the application that lays is run list",
    "start": "2562390",
    "end": "2567730"
  },
  {
    "text": "running process or installed apps does not use or have an alternative way of",
    "start": "2567730",
    "end": "2572980"
  },
  {
    "text": "listing it also some SSL enix pauses may",
    "start": "2572980",
    "end": "2583450"
  },
  {
    "text": "able service but it's not a problem if she can if you can set enforce or you",
    "start": "2583450",
    "end": "2588460"
  },
  {
    "text": "can set actually next to permissive mode even momentarily because if you do that",
    "start": "2588460",
    "end": "2594819"
  },
  {
    "text": "the next time you you reboot it will return into enforcing mode but that's",
    "start": "2594819",
    "end": "2602049"
  },
  {
    "text": "not that we didn't put your problem because at that point your changes have already take effect also I mentioned",
    "start": "2602049",
    "end": "2608650"
  },
  {
    "text": "this as an advantage earlier but this can also be an advantage your code is bound by the affected apps",
    "start": "2608650",
    "end": "2615140"
  },
  {
    "text": "permissions so you can't do anything that's not allowed under the context of",
    "start": "2615140",
    "end": "2622790"
  },
  {
    "text": "the apps the app that you have affected however since we were just you can use",
    "start": "2622790",
    "end": "2629900"
  },
  {
    "text": "this rootkit in conjunction with another malware that you wrote that has the",
    "start": "2629900",
    "end": "2636080"
  },
  {
    "text": "permissions that you want to do and you only use this rootkit to hide it and",
    "start": "2636080",
    "end": "2641840"
  },
  {
    "text": "that's the workaround you can do all right okay it's a time for a demo so here I",
    "start": "2641840",
    "end": "2656900"
  },
  {
    "text": "have I'm using an in genymotion agent",
    "start": "2656900",
    "end": "2666920"
  },
  {
    "text": "genymotion image with google nexus 6 and android 5.1 so this is a bad app which",
    "start": "2666920",
    "end": "2678440"
  },
  {
    "text": "contains a picture of a handsome guy and we are going to hide this if you open",
    "start": "2678440",
    "end": "2690830"
  },
  {
    "text": "settings here like you can see that you can see you can see that bad app is",
    "start": "2690830",
    "end": "2697280"
  },
  {
    "text": "shown in the downloaded list and in the running process this you won't see it",
    "start": "2697280",
    "end": "2703550"
  },
  {
    "text": "here because it's in the background that if you show cache processes you can see",
    "start": "2703550",
    "end": "2708710"
  },
  {
    "text": "that it is running in the background then if you look at all the installed files this you can also see that it is",
    "start": "2708710",
    "end": "2715400"
  },
  {
    "text": "installed ok so we're going to",
    "start": "2715400",
    "end": "2724660"
  },
  {
    "text": "to this we have to run this tool every",
    "start": "2727380",
    "end": "2733170"
  },
  {
    "text": "we are assuming scenario variants a attacker has access to your device and",
    "start": "2733170",
    "end": "2738690"
  },
  {
    "text": "plug it in to his laptop and he's going",
    "start": "2738690",
    "end": "2744359"
  },
  {
    "text": "to he has installed a malicious application and now going to hide it from view okay so do it so here I'm",
    "start": "2744359",
    "end": "2754829"
  },
  {
    "text": "pulling the settings apk from the device",
    "start": "2754829",
    "end": "2759349"
  },
  {
    "text": "and I'm decoding it using apktool and",
    "start": "2762920",
    "end": "2771470"
  },
  {
    "text": "modifying all the files the the hiding processes thing and hiding installed",
    "start": "2771470",
    "end": "2776970"
  },
  {
    "text": "application thing and I rebuilt it and now pushing it to the device okay so not",
    "start": "2776970",
    "end": "2789329"
  },
  {
    "text": "here I'm using Dex tool to generate a new settings that old patch it then push",
    "start": "2789329",
    "end": "2796710"
  },
  {
    "text": "it back and restart the application I'm using by the way I'm using an emulator",
    "start": "2796710",
    "end": "2803099"
  },
  {
    "text": "here so it can be easier to show as a demo but I also have an actual device",
    "start": "2803099",
    "end": "2808589"
  },
  {
    "text": "Nexus 7 device here so if you want to see it in action in an actual device you",
    "start": "2808589",
    "end": "2814140"
  },
  {
    "text": "can just approach me later on okay so let's see if it was successful hopefully",
    "start": "2814140",
    "end": "2823710"
  },
  {
    "text": "the demo gods okay so it softens it helps so you can see here the bad app is",
    "start": "2823710",
    "end": "2830430"
  },
  {
    "text": "not shown anymore and if you look at the",
    "start": "2830430",
    "end": "2837329"
  },
  {
    "text": "running running tab at the show cache processes you'll see that you you can",
    "start": "2837329",
    "end": "2843359"
  },
  {
    "text": "see it's not visible anymore in this tab either and then if you look here",
    "start": "2843359",
    "end": "2850369"
  },
  {
    "text": "you won't see it at all so to make sure that it's running I didn't hide it from",
    "start": "2852960",
    "end": "2860130"
  },
  {
    "text": "the recent apps they saw here you see that is still running but if you look at",
    "start": "2860130",
    "end": "2867630"
  },
  {
    "text": "the settings apps list it's not running",
    "start": "2867630",
    "end": "2873450"
  },
  {
    "text": "at all so that's it for the demo okay",
    "start": "2873450",
    "end": "2886770"
  },
  {
    "text": "now we have come to the end of the stop to conclude I have shown you that user",
    "start": "2886770",
    "end": "2896070"
  },
  {
    "start": "2892000",
    "end": "2892000"
  },
  {
    "text": "mode root kits are possible through art and not only for offensive purposes but",
    "start": "2896070",
    "end": "2902099"
  },
  {
    "text": "you can also use these techniques for re as well you can use these techniques to do instrumentation on whatever you're",
    "start": "2902099",
    "end": "2909960"
  },
  {
    "text": "analyzing and we also seen that we can still achieve persistence on the device",
    "start": "2909960",
    "end": "2916109"
  },
  {
    "text": "just as long as your own file is not replaced and also I would like to",
    "start": "2916109",
    "end": "2923760"
  },
  {
    "text": "mention that ARP is still very ripe for more security research and I know of",
    "start": "2923760",
    "end": "2930450"
  },
  {
    "text": "only one more research that involves fuzzing the compiler in an upcoming conference so i am i hope that and also",
    "start": "2930450",
    "end": "2942839"
  },
  {
    "text": "art is still in active development in fact just a couple of weeks ago the google released the 5.1 and i had to",
    "start": "2942839",
    "end": "2949859"
  },
  {
    "text": "change change some details in this presentation and in the paper so there",
    "start": "2949859",
    "end": "2957060"
  },
  {
    "text": "are still a changes being made and some of those could be security implications and I hope that this top made something",
    "start": "2957060",
    "end": "2966510"
  },
  {
    "text": "to you more interested in in doing this so any questions yes",
    "start": "2966510",
    "end": "2977119"
  },
  {
    "text": "yep there's I think there's a research",
    "start": "2977660",
    "end": "2988339"
  },
  {
    "text": "we're in I don't remember when but they use the binder to do that yeah it is",
    "start": "2988339",
    "end": "2996059"
  },
  {
    "text": "possible yeah as long as it's not",
    "start": "2996059",
    "end": "3001490"
  },
  {
    "text": "replace not it's not the apps not yeah you can also use this for for the stuff",
    "start": "3001490",
    "end": "3010460"
  },
  {
    "text": "that that exposed and see the substrate but those stuff are mostly used for for",
    "start": "3010460",
    "end": "3018200"
  },
  {
    "text": "changing the UI and stuff but if you're change that if the changes that you want",
    "start": "3018200",
    "end": "3023390"
  },
  {
    "text": "to made is on just code only you can use these techniques as well any more",
    "start": "3023390",
    "end": "3034250"
  },
  {
    "text": "questions excuse me uh no your the application is",
    "start": "3034250",
    "end": "3047530"
  },
  {
    "text": "already installed signature checking is done upon installation so the your it's all installed in this",
    "start": "3047530",
    "end": "3053800"
  },
  {
    "text": "won't go through that at all I'm not",
    "start": "3053800",
    "end": "3074440"
  },
  {
    "text": "sure I haven't looked into the security",
    "start": "3074440",
    "end": "3078720"
  },
  {
    "text": "well probably but I haven't look into how secure Travis could detect this but",
    "start": "3082740",
    "end": "3090010"
  },
  {
    "text": "I think they run at a lower level I'm not sure yeah",
    "start": "3090010",
    "end": "3097049"
  },
  {
    "text": "excuse me okay I have a Mac microphone",
    "start": "3102460",
    "end": "3109430"
  },
  {
    "text": "again oh yeah yes okay thanks",
    "start": "3109430",
    "end": "3119329"
  },
  {
    "text": "I will just say that to execute this on the device you will need to route it",
    "start": "3119329",
    "end": "3125869"
  },
  {
    "text": "right yeah you have to initially unless you route it this is not going to get",
    "start": "3125869",
    "end": "3132349"
  },
  {
    "text": "executed on the device now you have to have root first yeah but you don't have",
    "start": "3132349",
    "end": "3137990"
  },
  {
    "text": "need with the process yeah Cinci you don't write to the system partition you don't have we are at least in this top",
    "start": "3137990",
    "end": "3145220"
  },
  {
    "text": "we have no option to persist as root but",
    "start": "3145220",
    "end": "3150500"
  },
  {
    "text": "our changes will still take effect and if our code for example if I replace settings that the statics application",
    "start": "3150500",
    "end": "3157309"
  },
  {
    "text": "are followed will be running a system and if you have a system through the exploit which is much much easier to",
    "start": "3157309",
    "end": "3162859"
  },
  {
    "text": "achieve route than just a regular user you can we exploit your device and",
    "start": "3162859",
    "end": "3168650"
  },
  {
    "text": "actually brute again but those on that persistent thank you",
    "start": "3168650",
    "end": "3175299"
  },
  {
    "text": "question good oh thanks for listening and if you have more questions and if",
    "start": "3182180",
    "end": "3189059"
  },
  {
    "text": "you notice some mistakes that I made you can contact me through the following chance thank you",
    "start": "3189059",
    "end": "3196160"
  }
]