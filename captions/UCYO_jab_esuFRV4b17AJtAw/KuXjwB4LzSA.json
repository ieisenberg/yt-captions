[
  {
    "start": "0",
    "end": "127000"
  },
  {
    "text": "Suppose I give you two different lists of numbers, or maybe two different functions, ",
    "start": "0",
    "end": "4025"
  },
  {
    "text": "and I ask you to think of all the ways you might combine those two lists to get ",
    "start": "4025",
    "end": "7815"
  },
  {
    "text": "a new list of numbers, or combine the two functions to get a new function.",
    "start": "7815",
    "end": "11320"
  },
  {
    "text": "Maybe one simple way that comes to mind is to simply add them together term by term.",
    "start": "12120",
    "end": "16760"
  },
  {
    "text": "Likewise with the functions, you can add all the corresponding outputs.",
    "start": "17160",
    "end": "19920"
  },
  {
    "text": "In a similar vein, you could also multiply the two lists ",
    "start": "20540",
    "end": "23179"
  },
  {
    "text": "term by term and do the same thing with the functions.",
    "start": "23179",
    "end": "25680"
  },
  {
    "text": "But there's another kind of combination just as fundamental as both of those, ",
    "start": "26360",
    "end": "30455"
  },
  {
    "text": "but a lot less commonly discussed, known as a convolution.",
    "start": "30455",
    "end": "33500"
  },
  {
    "text": "But unlike the previous two cases, it's not something that's ",
    "start": "34080",
    "end": "37047"
  },
  {
    "text": "merely inherited from an operation you can do to numbers.",
    "start": "37047",
    "end": "39820"
  },
  {
    "text": "It's something genuinely new for the context of lists of numbers or combining functions.",
    "start": "39980",
    "end": "44700"
  },
  {
    "text": "They show up all over the place, they are ubiquitous in image processing, ",
    "start": "45320",
    "end": "49050"
  },
  {
    "text": "it's a core construct in the theory of probability, ",
    "start": "49050",
    "end": "51670"
  },
  {
    "text": "they're used a lot in solving differential equations, ",
    "start": "51671",
    "end": "54392"
  },
  {
    "text": "and one context where you've almost certainly seen it, if not by this name, ",
    "start": "54392",
    "end": "58223"
  },
  {
    "text": "is multiplying two polynomials together.",
    "start": "58223",
    "end": "60239"
  },
  {
    "text": "As someone in the business of visual explanations, this is an especially great topic, ",
    "start": "60740",
    "end": "64998"
  },
  {
    "text": "because the formulaic definition in isolation and without context can look kind of ",
    "start": "64998",
    "end": "69109"
  },
  {
    "text": "intimidating, but if we take the time to really unpack what it's saying, ",
    "start": "69109",
    "end": "72724"
  },
  {
    "text": "and before that actually motivate why you would want something like this, ",
    "start": "72724",
    "end": "76388"
  },
  {
    "text": "it's an incredibly beautiful operation.",
    "start": "76388",
    "end": "78320"
  },
  {
    "text": "And I have to admit, I actually learned a little something ",
    "start": "78960",
    "end": "81394"
  },
  {
    "text": "while putting together the visuals for this project.",
    "start": "81394",
    "end": "83539"
  },
  {
    "text": "In the case of convolving two different functions, ",
    "start": "83540",
    "end": "85957"
  },
  {
    "text": "I was trying to think of different ways you might picture what that could mean, ",
    "start": "85957",
    "end": "89750"
  },
  {
    "text": "and with one of them I had a little bit of an aha moment for why it is that ",
    "start": "89750",
    "end": "93352"
  },
  {
    "text": "normal distributions play the role that they do in probability, ",
    "start": "93352",
    "end": "96385"
  },
  {
    "text": "why it's such a natural shape for a function.",
    "start": "96386",
    "end": "98520"
  },
  {
    "text": "But I'm getting ahead of myself, there's a lot of setup for that one.",
    "start": "99020",
    "end": "101520"
  },
  {
    "text": "In this video, our primary focus is just going to be on the discrete case, ",
    "start": "101840",
    "end": "105510"
  },
  {
    "text": "and in particular building up to a very unexpected but very clever algorithm for ",
    "start": "105511",
    "end": "109476"
  },
  {
    "text": "computing these.",
    "start": "109476",
    "end": "110259"
  },
  {
    "text": "And I'll pull out the discussion for the continuous case into a second part.",
    "start": "110260",
    "end": "114480"
  },
  {
    "text": "It's very tempting to open up with the image processing examples, ",
    "start": "118580",
    "end": "121599"
  },
  {
    "text": "since they're visually the most intriguing, but there are a couple bits of finickiness ",
    "start": "121599",
    "end": "125579"
  },
  {
    "text": "that make the image processing case less representative of convolutions overall, ",
    "start": "125579",
    "end": "129285"
  },
  {
    "start": "127000",
    "end": "388000"
  },
  {
    "text": "so instead let's kick things off with probability, ",
    "start": "129285",
    "end": "131618"
  },
  {
    "text": "and in particular one of the simplest examples that I'm sure everyone here has ",
    "start": "131618",
    "end": "135232"
  },
  {
    "text": "thought about at some point in their life, which is rolling a pair of dice and ",
    "start": "135232",
    "end": "138846"
  },
  {
    "text": "figuring out the chances of seeing various different sums.",
    "start": "138846",
    "end": "141500"
  },
  {
    "text": "And you might say, not a problem, not a problem.",
    "start": "142460",
    "end": "144460"
  },
  {
    "text": "Each of your two dice has six different possible outcomes, ",
    "start": "144680",
    "end": "147821"
  },
  {
    "text": "which gives us a total of 36 distinct possible pairs of outcomes, ",
    "start": "147821",
    "end": "151334"
  },
  {
    "text": "and if we just look through them all we can count up how many pairs have a given sum.",
    "start": "151334",
    "end": "155860"
  },
  {
    "text": "And arranging all the pairs in a grid like this, ",
    "start": "156600",
    "end": "159118"
  },
  {
    "text": "one pretty nice thing is that all of the pairs that have a constant sum are visible ",
    "start": "159118",
    "end": "163435"
  },
  {
    "text": "along one of these different diagonals.",
    "start": "163435",
    "end": "165440"
  },
  {
    "text": "So simply counting how many exist on each of those diagonals ",
    "start": "165440",
    "end": "168893"
  },
  {
    "text": "will tell you how likely you are to see a particular sum.",
    "start": "168893",
    "end": "172120"
  },
  {
    "text": "And I'd say, very good, very good, but can you think of ",
    "start": "173220",
    "end": "175892"
  },
  {
    "text": "any other ways that you might visualize the same question?",
    "start": "175892",
    "end": "178660"
  },
  {
    "text": "Other images that can come to mind to think of ",
    "start": "179300",
    "end": "181731"
  },
  {
    "text": "all the distinct pairs that have a given sum?",
    "start": "181731",
    "end": "184060"
  },
  {
    "text": "And maybe one of you raises your hand and says, yeah, I've got one.",
    "start": "184860",
    "end": "187980"
  },
  {
    "text": "Let's say you picture these two different sets of possibilities each in a row, ",
    "start": "188280",
    "end": "192044"
  },
  {
    "text": "but you flip around that second row.",
    "start": "192044",
    "end": "193760"
  },
  {
    "text": "That way all of the different pairs which add up to seven line up vertically like this.",
    "start": "193760",
    "end": "198760"
  },
  {
    "text": "And if we slide that bottom row all the way to the right, ",
    "start": "199360",
    "end": "202123"
  },
  {
    "text": "then the unique pair that adds up to two, the snake eyes, are the only ones that align, ",
    "start": "202123",
    "end": "206315"
  },
  {
    "text": "and if I schlunk that over one unit to the right, ",
    "start": "206315",
    "end": "208697"
  },
  {
    "text": "the pairs which align are the two different pairs that add up to three.",
    "start": "208697",
    "end": "212080"
  },
  {
    "text": "And in general, different offset values of this lower array, ",
    "start": "212880",
    "end": "216235"
  },
  {
    "text": "which remember I had to flip around first, reveal all the distinct pairs that ",
    "start": "216235",
    "end": "220525"
  },
  {
    "text": "have a given sum.",
    "start": "220525",
    "end": "221459"
  },
  {
    "text": "As far as probability questions go, this still isn't especially interesting because ",
    "start": "224820",
    "end": "228730"
  },
  {
    "text": "all we're doing is counting how many outcomes there are in each of these categories.",
    "start": "228730",
    "end": "232640"
  },
  {
    "text": "But that is with the implicit assumption that there's ",
    "start": "232980",
    "end": "235623"
  },
  {
    "text": "an equal chance for each of these faces to come up.",
    "start": "235623",
    "end": "238120"
  },
  {
    "text": "But what if I told you I have a special set of dice that's not uniform?",
    "start": "238360",
    "end": "241620"
  },
  {
    "text": "Maybe the blue die has its own set of numbers describing the probabilities for ",
    "start": "242060",
    "end": "245885"
  },
  {
    "text": "each face coming up, and the red die has its own unique distinct set of numbers.",
    "start": "245885",
    "end": "249760"
  },
  {
    "text": "In that case, if you wanted to figure out, say, ",
    "start": "250300",
    "end": "252780"
  },
  {
    "text": "the probability of seeing a 2, you would multiply the probability ",
    "start": "252780",
    "end": "256191"
  },
  {
    "text": "that the blue die is a 1 times the probability that the red die is a 1.",
    "start": "256191",
    "end": "259860"
  },
  {
    "text": "And for the chances of seeing a 3, you look at the two distinct ",
    "start": "260279",
    "end": "263531"
  },
  {
    "text": "pairs where that's possible, and again multiply the corresponding ",
    "start": "263531",
    "end": "266885"
  },
  {
    "text": "probabilities and then add those two products together.",
    "start": "266885",
    "end": "269680"
  },
  {
    "text": "Similarly, the chances of seeing a 4 involves multiplying together ",
    "start": "270100",
    "end": "273435"
  },
  {
    "text": "three different pairs of possibilities and adding them all together.",
    "start": "273435",
    "end": "276820"
  },
  {
    "text": "And in the spirit of setting up some formulas, let's name these top probabilities a 1, ",
    "start": "276820",
    "end": "281852"
  },
  {
    "text": "a 2, a 3, and so on, and name the bottom ones b 1, b 2, b 3, and so on.",
    "start": "281852",
    "end": "285960"
  },
  {
    "text": "And in general, this process where we're taking two different arrays of numbers, ",
    "start": "286400",
    "end": "290495"
  },
  {
    "text": "flipping the second one around, and then lining them up at various different ",
    "start": "290495",
    "end": "294389"
  },
  {
    "text": "offset values, taking a bunch of pairwise products and adding them up, ",
    "start": "294389",
    "end": "297979"
  },
  {
    "text": "that's one of the fundamental ways to think about what a convolution is.",
    "start": "297979",
    "end": "301620"
  },
  {
    "text": "So just to spell it out a little more exactly, through this process, ",
    "start": "304860",
    "end": "308511"
  },
  {
    "text": "we just generated probabilities for seeing 2, 3, 4, on and on up to 12, ",
    "start": "308511",
    "end": "312322"
  },
  {
    "text": "and we got them by mixing together one list of values, a, and another list of values, b.",
    "start": "312322",
    "end": "316979"
  },
  {
    "text": "In the lingo, we'd say the convolution of those two sequences gives us this new sequence, ",
    "start": "317440",
    "end": "322502"
  },
  {
    "text": "the new sequence of 11 values, each of which looks like some sum of pairwise products.",
    "start": "322502",
    "end": "327340"
  },
  {
    "text": "If you prefer, another way you could think about the same operation is to first ",
    "start": "327340",
    "end": "331957"
  },
  {
    "text": "create a table of all the pairwise products, and then add up along all these diagonals.",
    "start": "331957",
    "end": "336980"
  },
  {
    "text": "Again, that's a way of mixing together these two ",
    "start": "337460",
    "end": "339841"
  },
  {
    "text": "sequences of numbers to get us a new sequence of 11 numbers.",
    "start": "339842",
    "end": "342760"
  },
  {
    "text": "It's the same operation as the sliding windows thought, just another perspective.",
    "start": "343240",
    "end": "346460"
  },
  {
    "text": "Putting a little notation to it, here's how you might see it written down.",
    "start": "347140",
    "end": "349800"
  },
  {
    "text": "The convolution of a and b, denoted with this little asterisk, is a new list, ",
    "start": "350220",
    "end": "354978"
  },
  {
    "text": "and the nth element of that list looks like a sum, ",
    "start": "354978",
    "end": "358089"
  },
  {
    "text": "and that sum goes over all different pairs of indices, i and j, ",
    "start": "358089",
    "end": "361992"
  },
  {
    "text": "so that the sum of those indices is equal to n.",
    "start": "361993",
    "end": "364860"
  },
  {
    "text": "It's kind of a mouthful, but for example, if n was 6, ",
    "start": "365280",
    "end": "368602"
  },
  {
    "text": "the pairs we're going over are 1 and 5, 2 and 4, 3 and 3, 4 and 2, 5 and 1, ",
    "start": "368602",
    "end": "373276"
  },
  {
    "text": "all the different pairs that add up to 6.",
    "start": "373277",
    "end": "375800"
  },
  {
    "text": "But honestly, however you write it down, the notation is secondary in ",
    "start": "376620",
    "end": "379500"
  },
  {
    "text": "importance to the visual you might hold in your head for the process.",
    "start": "379500",
    "end": "382340"
  },
  {
    "text": "Here, maybe it helps to do a super simple example, ",
    "start": "383280",
    "end": "386051"
  },
  {
    "text": "where I might ask you what's the convolution of the list 1, 2, 3 with the list 4, 5, 6.",
    "start": "386051",
    "end": "390780"
  },
  {
    "start": "388000",
    "end": "445000"
  },
  {
    "text": "You might picture taking both of these lists, flipping around that second one, ",
    "start": "391480",
    "end": "395003"
  },
  {
    "text": "and then starting with its lid all the way over to the left.",
    "start": "395003",
    "end": "397680"
  },
  {
    "text": "Then the pair of values which align are 1 and 4, ",
    "start": "398180",
    "end": "400367"
  },
  {
    "text": "multiply them together, and that gives us our first term of our output.",
    "start": "400368",
    "end": "403540"
  },
  {
    "text": "Slide that bottom array one unit to the right, ",
    "start": "403960",
    "end": "406656"
  },
  {
    "text": "the pairs which align are 1, 5 and 2 and 4, multiply those pairs, ",
    "start": "406656",
    "end": "410443"
  },
  {
    "text": "add them together, and that gives us 13, the next entry in our output.",
    "start": "410443",
    "end": "414460"
  },
  {
    "text": "Slide things over once more, and we'll take 1 times 6 plus 2 times 5 plus 3 times 4, ",
    "start": "414960",
    "end": "420154"
  },
  {
    "text": "which happens to be 28.",
    "start": "420154",
    "end": "421560"
  },
  {
    "text": "One more slide and we get 2 times 6 plus 3 times 5, and that gives us 27.",
    "start": "422020",
    "end": "427020"
  },
  {
    "text": "And finally the last term will look like 3 times 6.",
    "start": "427500",
    "end": "430120"
  },
  {
    "text": "If you'd like, you can pull up whatever your favorite programming ",
    "start": "430660",
    "end": "433565"
  },
  {
    "text": "language is and your favorite library that includes various numerical operations, ",
    "start": "433565",
    "end": "437175"
  },
  {
    "text": "and you can confirm I'm not lying to you.",
    "start": "437175",
    "end": "438979"
  },
  {
    "text": "If you take the convolution of 1, 2, 3 against 4, ",
    "start": "438980",
    "end": "441786"
  },
  {
    "text": "5, 6, this is indeed the result that you'll get.",
    "start": "441786",
    "end": "444480"
  },
  {
    "start": "445000",
    "end": "512000"
  },
  {
    "text": "We've seen one case where this is a natural and desirable operation, ",
    "start": "445920",
    "end": "449216"
  },
  {
    "text": "adding up to probability distributions, and another common example would be a ",
    "start": "449216",
    "end": "452943"
  },
  {
    "text": "moving average.",
    "start": "452943",
    "end": "453660"
  },
  {
    "text": "Imagine you have some long list of numbers, and you take ",
    "start": "454080",
    "end": "457022"
  },
  {
    "text": "another smaller list of numbers that all add up to 1.",
    "start": "457023",
    "end": "459760"
  },
  {
    "text": "In this case, I just have a little list of 5 values and they're all equal to 1 5th.",
    "start": "460100",
    "end": "464060"
  },
  {
    "text": "Then if we do this sliding window convolution process, ",
    "start": "464060",
    "end": "466945"
  },
  {
    "text": "and kind of close our eyes and sweep under the rug what happens at ",
    "start": "466946",
    "end": "470461"
  },
  {
    "text": "the very beginning of it, once our smaller list of values entirely ",
    "start": "470461",
    "end": "473977"
  },
  {
    "text": "overlaps with the bigger one, think about what each term in this convolution really means.",
    "start": "473977",
    "end": "478699"
  },
  {
    "text": "At each iteration, what you're doing is multiplying each of the values ",
    "start": "479400",
    "end": "483251"
  },
  {
    "text": "from your data by 1 5th and adding them all together, ",
    "start": "483251",
    "end": "486180"
  },
  {
    "text": "which is to say you're taking an average of your data inside this little window.",
    "start": "486180",
    "end": "490520"
  },
  {
    "text": "Overall, the process gives you a smoothed out version of the original data, ",
    "start": "491100",
    "end": "494646"
  },
  {
    "text": "and you could modify this starting with a different little list of numbers, ",
    "start": "494646",
    "end": "498193"
  },
  {
    "text": "and as long as that little list all adds up to 1, ",
    "start": "498193",
    "end": "500526"
  },
  {
    "text": "you can still interpret it as a moving average.",
    "start": "500526",
    "end": "502720"
  },
  {
    "text": "In the example shown here, that moving average ",
    "start": "503400",
    "end": "505428"
  },
  {
    "text": "would be giving more weight towards the central value.",
    "start": "505428",
    "end": "507760"
  },
  {
    "text": "This also results in a smoothed out version of the data.",
    "start": "508420",
    "end": "510800"
  },
  {
    "start": "512000",
    "end": "822000"
  },
  {
    "text": "If you do kind of a two-dimensional analog of this, ",
    "start": "513140",
    "end": "515826"
  },
  {
    "text": "it gives you a fun algorithm for blurring a given image.",
    "start": "515826",
    "end": "518719"
  },
  {
    "text": "And I should say the animations I'm about to show are modified from something ",
    "start": "518720",
    "end": "522857"
  },
  {
    "text": "I originally made for part of a set of lectures I did with the Julia lab at ",
    "start": "522857",
    "end": "526889"
  },
  {
    "text": "MIT for a certain open courseware class that included an image processing unit.",
    "start": "526889",
    "end": "531079"
  },
  {
    "text": "There we did a little bit more to dive into the code behind all of this, ",
    "start": "531560",
    "end": "534407"
  },
  {
    "text": "so if you're curious, I'll leave you some links.",
    "start": "534407",
    "end": "536279"
  },
  {
    "text": "But focusing back on this blurring example, what's going on is I've got this ",
    "start": "536620",
    "end": "540685"
  },
  {
    "text": "little 3x3 grid of values that's marching along our original image, and if we zoom in, ",
    "start": "540685",
    "end": "545278"
  },
  {
    "text": "each one of those values is 1 9th, and what I'm doing at each iteration is ",
    "start": "545278",
    "end": "549238"
  },
  {
    "text": "multiplying each of those values by the corresponding pixel that it sits on top of.",
    "start": "549238",
    "end": "553620"
  },
  {
    "text": "And of course in computer science, we think of colors as little vectors of three values, ",
    "start": "553900",
    "end": "557963"
  },
  {
    "text": "representing the red, green, and blue components.",
    "start": "557963",
    "end": "560200"
  },
  {
    "text": "When I multiply all these little values by 1 9th and I add them together, ",
    "start": "560560",
    "end": "564419"
  },
  {
    "text": "it gives us an average along each color channel, ",
    "start": "564419",
    "end": "566975"
  },
  {
    "text": "and the corresponding pixel for the image on the right is defined to be that sum.",
    "start": "566975",
    "end": "571199"
  },
  {
    "text": "The overall effect, as we do this for every single pixel on the image, ",
    "start": "571940",
    "end": "575419"
  },
  {
    "text": "is that each one kind of bleeds into all of its neighbors, ",
    "start": "575419",
    "end": "578311"
  },
  {
    "text": "which gives us a blurrier version than the original.",
    "start": "578311",
    "end": "580860"
  },
  {
    "text": "In the lingo, we'd say that the image on the right is a ",
    "start": "581720",
    "end": "584551"
  },
  {
    "text": "convolution of our original image with a little grid of values.",
    "start": "584552",
    "end": "587740"
  },
  {
    "text": "Or more technically, maybe I should say that it's the convolution ",
    "start": "588140",
    "end": "591318"
  },
  {
    "text": "with a 180 degree rotated version of that little grid of values.",
    "start": "591318",
    "end": "594399"
  },
  {
    "text": "Not that it matters when the grid is symmetric, ",
    "start": "594620",
    "end": "596770"
  },
  {
    "text": "but it's just worth keeping in mind that the definition of a convolution, ",
    "start": "596770",
    "end": "600086"
  },
  {
    "text": "as inherited from the pure math context, should always invite you to think about ",
    "start": "600086",
    "end": "603716"
  },
  {
    "text": "flipping around that second array.",
    "start": "603716",
    "end": "605240"
  },
  {
    "text": "If we modify this slightly, we can get a much more elegant ",
    "start": "605960",
    "end": "608620"
  },
  {
    "text": "blurring effect by choosing a different grid of values.",
    "start": "608620",
    "end": "611100"
  },
  {
    "text": "In this case, I have a little 5x5 grid, but the distinction is not so much its size.",
    "start": "611440",
    "end": "615780"
  },
  {
    "text": "If we zoom in, we notice that the value in the middle ",
    "start": "615980",
    "end": "618370"
  },
  {
    "text": "is a lot bigger than the value towards the edges.",
    "start": "618370",
    "end": "620540"
  },
  {
    "text": "And where this is coming from is they're all sampled from a bell curve, ",
    "start": "621180",
    "end": "624444"
  },
  {
    "text": "known as a Gaussian distribution.",
    "start": "624444",
    "end": "625939"
  },
  {
    "text": "That way, when we multiply all of these values by the corresponding ",
    "start": "626800",
    "end": "629946"
  },
  {
    "text": "pixel that they're sitting on top of, we're giving a lot more weight ",
    "start": "629947",
    "end": "633140"
  },
  {
    "text": "to that central pixel, and much less towards the ones out at the edge.",
    "start": "633140",
    "end": "636380"
  },
  {
    "text": "And just as before, the corresponding pixel on the right is defined to be this sum.",
    "start": "636800",
    "end": "640560"
  },
  {
    "text": "As we do this process for every single pixel, it gives a blurring effect, ",
    "start": "641320",
    "end": "644716"
  },
  {
    "text": "which much more authentically simulates the notion of putting your lens out of focus, ",
    "start": "644716",
    "end": "648664"
  },
  {
    "text": "or something like that.",
    "start": "648664",
    "end": "649720"
  },
  {
    "text": "But blurring is far from the only thing that you can do with this idea.",
    "start": "649900",
    "end": "653360"
  },
  {
    "text": "For instance, take a look at this little grid of values, ",
    "start": "653800",
    "end": "656459"
  },
  {
    "text": "which involves some positive numbers on the left, ",
    "start": "656459",
    "end": "658793"
  },
  {
    "text": "and some negative numbers on the right, which I'll color with blue and red respectively.",
    "start": "658793",
    "end": "662900"
  },
  {
    "text": "Take a moment to see if you can predict and understand ",
    "start": "663640",
    "end": "666275"
  },
  {
    "text": "what effect this will have on the final image.",
    "start": "666275",
    "end": "668480"
  },
  {
    "text": "So in this case, I'll just be thinking of the image as grayscale instead of colored, ",
    "start": "670720",
    "end": "674701"
  },
  {
    "text": "so each of the pixels is just represented by one number instead of three.",
    "start": "674701",
    "end": "678120"
  },
  {
    "text": "And one thing worth noticing is that as we do this convolution, ",
    "start": "678440",
    "end": "681367"
  },
  {
    "text": "it's possible to get negative values.",
    "start": "681367",
    "end": "683060"
  },
  {
    "text": "For example, at this point here, if we zoom in, ",
    "start": "683060",
    "end": "685394"
  },
  {
    "text": "the left half of our little grid sits entirely on top of black pixels, ",
    "start": "685394",
    "end": "688846"
  },
  {
    "text": "which would have a value of zero, but the right half of negative values all sit on ",
    "start": "688846",
    "end": "692882"
  },
  {
    "text": "top of white pixels, which would have a value of one.",
    "start": "692882",
    "end": "695460"
  },
  {
    "text": "So when we multiply corresponding terms and add them together, ",
    "start": "696180",
    "end": "699193"
  },
  {
    "text": "the results will be very negative.",
    "start": "699193",
    "end": "700820"
  },
  {
    "text": "And the way I'm displaying this with the image on the right ",
    "start": "701160",
    "end": "703826"
  },
  {
    "text": "is to color negative values red and positive values blue.",
    "start": "703826",
    "end": "706360"
  },
  {
    "text": "Another thing to notice is that when you're on a patch that's all the same color, ",
    "start": "706880",
    "end": "710524"
  },
  {
    "text": "everything goes to zero, since the sum of the values in our little grid is zero.",
    "start": "710524",
    "end": "714080"
  },
  {
    "text": "This is very different from the previous two examples where the sum of our little ",
    "start": "715180",
    "end": "718790"
  },
  {
    "text": "grid was one, which let us interpret it as a moving average and hence a blur.",
    "start": "718790",
    "end": "722180"
  },
  {
    "text": "All in all, this little process basically detects wherever there's ",
    "start": "723640",
    "end": "726843"
  },
  {
    "text": "variation in the pixel value as you move from left to right, ",
    "start": "726843",
    "end": "729760"
  },
  {
    "text": "and so it gives you a kind of way to pick up on all the vertical edges from your image.",
    "start": "729760",
    "end": "733920"
  },
  {
    "text": "And similarly, if we rotated that grid around so that it varies as you move from ",
    "start": "736500",
    "end": "740693"
  },
  {
    "text": "the top to the bottom, this will be picking up on all the horizontal edges, ",
    "start": "740693",
    "end": "744628"
  },
  {
    "text": "which in the case of our little pie creature image does result in some pretty ",
    "start": "744628",
    "end": "748666"
  },
  {
    "text": "demonic eyes.",
    "start": "748666",
    "end": "749340"
  },
  {
    "text": "This smaller grid, by the way, is often called a kernel, ",
    "start": "750400",
    "end": "752879"
  },
  {
    "text": "and the beauty here is how just by choosing a different kernel, ",
    "start": "752879",
    "end": "755663"
  },
  {
    "text": "you can get different image processing effects, not just blurring your edge detection, ",
    "start": "755663",
    "end": "759448"
  },
  {
    "text": "but also things like sharpening.",
    "start": "759448",
    "end": "760840"
  },
  {
    "text": "For those of you who have heard of a convolutional neural network, ",
    "start": "760840",
    "end": "764095"
  },
  {
    "text": "the idea there is to use data to figure out what the kernels should be in ",
    "start": "764095",
    "end": "767689"
  },
  {
    "text": "the first place, as determined by whatever the neural network wants to detect.",
    "start": "767690",
    "end": "771480"
  },
  {
    "text": "Another thing I should maybe bring up is the length of the output.",
    "start": "772760",
    "end": "775520"
  },
  {
    "text": "For something like the moving average example, ",
    "start": "775820",
    "end": "777790"
  },
  {
    "text": "you might only want to think about the terms when both of the windows ",
    "start": "777790",
    "end": "780725"
  },
  {
    "text": "fully align with each other.",
    "start": "780725",
    "end": "781899"
  },
  {
    "text": "Or in the image processing example, maybe you want ",
    "start": "782120",
    "end": "784602"
  },
  {
    "text": "the final output to have the same size as the original.",
    "start": "784602",
    "end": "787279"
  },
  {
    "text": "Now, convolutions as a pure math operation always produce an ",
    "start": "787280",
    "end": "790246"
  },
  {
    "text": "array that's bigger than the two arrays that you started with, ",
    "start": "790246",
    "end": "793310"
  },
  {
    "text": "at least assuming one of them doesn't have a length of one.",
    "start": "793310",
    "end": "796180"
  },
  {
    "text": "Just know that in certain computer science contexts, ",
    "start": "796720",
    "end": "799141"
  },
  {
    "text": "you often want to deliberately truncate that output.",
    "start": "799142",
    "end": "801520"
  },
  {
    "text": "Another thing worth highlighting is that in the computer science context, ",
    "start": "804720",
    "end": "808332"
  },
  {
    "text": "this notion of flipping around that kernel before you let it march across ",
    "start": "808332",
    "end": "811944"
  },
  {
    "text": "the original often feels really weird and just uncalled for, but again, ",
    "start": "811944",
    "end": "815459"
  },
  {
    "text": "note that that's what's inherited from the pure math context, ",
    "start": "815459",
    "end": "818485"
  },
  {
    "text": "where like we saw with the probabilities, it's an incredibly natural thing to do.",
    "start": "818485",
    "end": "822440"
  },
  {
    "start": "822000",
    "end": "880000"
  },
  {
    "text": "And actually, I can show you one more pure math example where ",
    "start": "823020",
    "end": "825956"
  },
  {
    "text": "even the programmers should care about this one, ",
    "start": "825956",
    "end": "828277"
  },
  {
    "text": "because it opens the doors for a much faster algorithm to compute all of these.",
    "start": "828277",
    "end": "832019"
  },
  {
    "text": "To set up what I mean by faster here, let me go back and pull up some Python again, ",
    "start": "832620",
    "end": "836796"
  },
  {
    "text": "and I'm going to create two different relatively big arrays.",
    "start": "836796",
    "end": "839780"
  },
  {
    "text": "Each one will have a hundred thousand random elements in it, ",
    "start": "839940",
    "end": "843115"
  },
  {
    "text": "and I'm going to assess the runtime, of the convolve function from the NumPy library.",
    "start": "843115",
    "end": "847540"
  },
  {
    "text": "And in this case, it runs it for multiple different iterations, tries to find an average, ",
    "start": "848180",
    "end": "852756"
  },
  {
    "text": "and it looks like, on this computer at least, it averages at 4.87 seconds.",
    "start": "852756",
    "end": "856519"
  },
  {
    "text": "By contrast, if I use a different function from the SciPy library called fftConvolve, ",
    "start": "856960",
    "end": "861983"
  },
  {
    "text": "which is the same thing just implemented differently, ",
    "start": "861983",
    "end": "865136"
  },
  {
    "text": "that only takes 4.3 milliseconds on average, so three orders of magnitude improvement.",
    "start": "865136",
    "end": "870160"
  },
  {
    "text": "And again, even though it flies under a different name, ",
    "start": "870160",
    "end": "872915"
  },
  {
    "text": "it's giving the same output that the other convolve function does, ",
    "start": "872916",
    "end": "876215"
  },
  {
    "text": "it's just doing something to go about it in a cleverer way.",
    "start": "876215",
    "end": "879120"
  },
  {
    "start": "880000",
    "end": "1090000"
  },
  {
    "text": "Remember how with the probability example, I said another way you could ",
    "start": "882200",
    "end": "885709"
  },
  {
    "text": "think about the convolution was to create this table of all the pairwise products, ",
    "start": "885709",
    "end": "889755"
  },
  {
    "text": "and then add up those pairwise products along the diagonals.",
    "start": "889755",
    "end": "892680"
  },
  {
    "text": "There's of course nothing specific to probability.",
    "start": "893660",
    "end": "895500"
  },
  {
    "text": "Any time you're convolving two different lists of numbers, ",
    "start": "895660",
    "end": "897850"
  },
  {
    "text": "you can think about it this way.",
    "start": "897851",
    "end": "899040"
  },
  {
    "text": "Create this kind of multiplication table with all pairwise products, ",
    "start": "899040",
    "end": "902522"
  },
  {
    "text": "and then each sum along the diagonal corresponds to one of your final outputs.",
    "start": "902522",
    "end": "906459"
  },
  {
    "text": "One context where this view is especially natural ",
    "start": "907600",
    "end": "910308"
  },
  {
    "text": "is when you multiply together two polynomials.",
    "start": "910308",
    "end": "912800"
  },
  {
    "text": "For example, let me take the little grid we already have and replace the top terms ",
    "start": "913300",
    "end": "918450"
  },
  {
    "text": "with 1, 2x, and 3x squared, and replace the other terms with 4, 5x, and 6x squared.",
    "start": "918450",
    "end": "923600"
  },
  {
    "text": "Now, think about what it means when we're creating all of ",
    "start": "924000",
    "end": "926462"
  },
  {
    "text": "these different pairwise products between the two lists.",
    "start": "926462",
    "end": "928839"
  },
  {
    "text": "What you're doing is essentially expanding out the full product of ",
    "start": "929040",
    "end": "932696"
  },
  {
    "text": "the two polynomials I have written down, and then when you add up along the diagonal, ",
    "start": "932696",
    "end": "937389"
  },
  {
    "text": "that corresponds to collecting all like terms.",
    "start": "937389",
    "end": "939899"
  },
  {
    "text": "Which is pretty neat.",
    "start": "940600",
    "end": "941500"
  },
  {
    "text": "Expanding a polynomial and collecting like terms ",
    "start": "941740",
    "end": "944190"
  },
  {
    "text": "is exactly the same process as a convolution.",
    "start": "944190",
    "end": "946440"
  },
  {
    "text": "But this allows us to do something that's pretty cool, ",
    "start": "947740",
    "end": "950321"
  },
  {
    "text": "because think about what we're saying here.",
    "start": "950321",
    "end": "952339"
  },
  {
    "text": "We're saying if you take two different functions and you multiply them together, ",
    "start": "952340",
    "end": "956693"
  },
  {
    "text": "which is a simple pointwise operation, that's the same thing as if you had ",
    "start": "956693",
    "end": "960724"
  },
  {
    "text": "first extracted the coefficients from each one of those, assuming they're polynomials, ",
    "start": "960724",
    "end": "965400"
  },
  {
    "text": "and then taken a convolution of those two lists of coefficients.",
    "start": "965400",
    "end": "968840"
  },
  {
    "text": "What makes that so interesting is that convolutions feel, ",
    "start": "969620",
    "end": "972348"
  },
  {
    "text": "in principle, a lot more complicated than simple multiplication.",
    "start": "972348",
    "end": "975360"
  },
  {
    "text": "And I don't just mean conceptually they're harder to think about.",
    "start": "975820",
    "end": "978460"
  },
  {
    "text": "I mean, computationally, it requires more steps to perform a convolution ",
    "start": "978840",
    "end": "982448"
  },
  {
    "text": "than it does to perform a pointwise product of two different lists.",
    "start": "982448",
    "end": "985760"
  },
  {
    "text": "For example, let's say I gave you two really big polynomials, ",
    "start": "986320",
    "end": "989381"
  },
  {
    "text": "say each one with a hundred different coefficients.",
    "start": "989381",
    "end": "991899"
  },
  {
    "text": "Then if the way you multiply them was to expand out this product, ",
    "start": "992740",
    "end": "996257"
  },
  {
    "text": "you know, filling in this entire 100 by 100 grid of pairwise products, ",
    "start": "996257",
    "end": "1000042"
  },
  {
    "text": "that would require you to perform 10,000 different products.",
    "start": "1000042",
    "end": "1003240"
  },
  {
    "text": "And then, when you're collecting all the like terms along the diagonals, ",
    "start": "1003740",
    "end": "1007463"
  },
  {
    "text": "that's another set of around 10,000 operations.",
    "start": "1007463",
    "end": "1009860"
  },
  {
    "text": "More generally, in the lingo, we'd say the algorithm is O of n squared, ",
    "start": "1010700",
    "end": "1014741"
  },
  {
    "text": "meaning for two lists of size n, the way that the number of ",
    "start": "1014741",
    "end": "1018109"
  },
  {
    "text": "operations scales is in proportion to the square of n.",
    "start": "1018109",
    "end": "1021140"
  },
  {
    "text": "On the other hand, if I think of two polynomials in terms of their outputs, for example, ",
    "start": "1021820",
    "end": "1026562"
  },
  {
    "text": "sampling their values at some handful of inputs, ",
    "start": "1026562",
    "end": "1029172"
  },
  {
    "text": "then multiplying them only requires as many operations as the number of samples, ",
    "start": "1029172",
    "end": "1033488"
  },
  {
    "text": "since again, it's a pointwise operation.",
    "start": "1033488",
    "end": "1035619"
  },
  {
    "text": "And with polynomials, you only need finitely many ",
    "start": "1036180",
    "end": "1038427"
  },
  {
    "text": "samples to be able to recover the coefficients.",
    "start": "1038427",
    "end": "1040540"
  },
  {
    "text": "For example, two outputs are enough to uniquely specify a linear polynomial, ",
    "start": "1040540",
    "end": "1044994"
  },
  {
    "text": "three outputs would be enough to uniquely specify a quadratic polynomial, ",
    "start": "1044994",
    "end": "1049276"
  },
  {
    "text": "and in general, if you know n distinct outputs, ",
    "start": "1049276",
    "end": "1052053"
  },
  {
    "text": "that's enough to uniquely specify a polynomial that has n different coefficients.",
    "start": "1052053",
    "end": "1056740"
  },
  {
    "text": "Or, if you prefer, we could phrase this in the language of systems of equations.",
    "start": "1057440",
    "end": "1060720"
  },
  {
    "text": "Imagine I tell you I have some polynomial, but I don't tell you what the coefficients are.",
    "start": "1061200",
    "end": "1065200"
  },
  {
    "text": "Those are a mystery to you.",
    "start": "1065260",
    "end": "1066520"
  },
  {
    "text": "In our example, you might think of this as the product that we're trying to figure out.",
    "start": "1066700",
    "end": "1070179"
  },
  {
    "text": "And then, suppose I say, I'll just tell you what the outputs of this polynomial ",
    "start": "1070180",
    "end": "1074662"
  },
  {
    "text": "would be if you inputted various different inputs, like 0, 1, 2, 3, on and on, ",
    "start": "1074662",
    "end": "1079089"
  },
  {
    "text": "and I give you enough so that you have as many equations as you have unknowns.",
    "start": "1079089",
    "end": "1083460"
  },
  {
    "text": "It even happens to be a linear system of equations, so that's nice, ",
    "start": "1084140",
    "end": "1087288"
  },
  {
    "text": "and in principle, at least, this should be enough to recover the coefficients.",
    "start": "1087288",
    "end": "1090900"
  },
  {
    "start": "1090000",
    "end": "1282000"
  },
  {
    "text": "So the rough algorithm outline then would be, whenever you want to convolve two lists ",
    "start": "1091740",
    "end": "1096417"
  },
  {
    "text": "of numbers, you treat them like they're coefficients of two polynomials, ",
    "start": "1096417",
    "end": "1100388"
  },
  {
    "text": "you sample those polynomials at enough outputs, multiply those samples point-wise, ",
    "start": "1100388",
    "end": "1104903"
  },
  {
    "text": "and then solve this system to recover the coefficients as a sneaky backdoor way to find ",
    "start": "1104903",
    "end": "1109689"
  },
  {
    "text": "the convolution.",
    "start": "1109689",
    "end": "1110559"
  },
  {
    "text": "And, as I've stated it so far, at least, some of you could rightfully complain, grant, ",
    "start": "1111420",
    "end": "1116057"
  },
  {
    "text": "that is an idiotic plan, because, for one thing, ",
    "start": "1116057",
    "end": "1118669"
  },
  {
    "text": "just calculating all these samples for one of the polynomials we know already takes ",
    "start": "1118669",
    "end": "1123147"
  },
  {
    "text": "on the order of n-squared operations.",
    "start": "1123147",
    "end": "1125120"
  },
  {
    "text": "Not to mention, solving that system is certainly going to be ",
    "start": "1125600",
    "end": "1128452"
  },
  {
    "text": "computationally as difficult as just doing the convolution in the first place.",
    "start": "1128452",
    "end": "1132100"
  },
  {
    "text": "So, like, sure, we have this connection between multiplication and convolutions, ",
    "start": "1132600",
    "end": "1136539"
  },
  {
    "text": "but all of the complexity happens in translating from one viewpoint to the other.",
    "start": "1136540",
    "end": "1140480"
  },
  {
    "text": "But there is a trick, and those of you who know about Fourier ",
    "start": "1141600",
    "end": "1144645"
  },
  {
    "text": "transforms and the FFT algorithm might see where this is going.",
    "start": "1144645",
    "end": "1147740"
  },
  {
    "text": "If you're unfamiliar with those topics, what I'm ",
    "start": "1147740",
    "end": "1149915"
  },
  {
    "text": "about to say might seem completely out of the blue.",
    "start": "1149915",
    "end": "1152180"
  },
  {
    "text": "Just know that there are certain paths you could have ",
    "start": "1152260",
    "end": "1154538"
  },
  {
    "text": "walked in math that make this more of an expected step.",
    "start": "1154538",
    "end": "1156860"
  },
  {
    "text": "Basically, the idea is that we have a freedom of choice here.",
    "start": "1157720",
    "end": "1160360"
  },
  {
    "text": "If instead of evaluating at some arbitrary set of inputs, like 0, 1, 2, 3, ",
    "start": "1160540",
    "end": "1164638"
  },
  {
    "text": "on and on, you choose to evaluate on a very specially selected set of complex numbers, ",
    "start": "1164638",
    "end": "1169393"
  },
  {
    "text": "specifically the ones that sit evenly spaced on the unit circle, ",
    "start": "1169393",
    "end": "1172945"
  },
  {
    "text": "what are known as the roots of unity, this gives us a friendlier system.",
    "start": "1172945",
    "end": "1176880"
  },
  {
    "text": "The basic idea is that by finding a number where taking its powers falls into ",
    "start": "1178360",
    "end": "1182309"
  },
  {
    "text": "this cycling pattern, it means that the system we generate is going to have a ",
    "start": "1182309",
    "end": "1186257"
  },
  {
    "text": "lot of redundancy in the different terms that you're calculating, ",
    "start": "1186258",
    "end": "1189599"
  },
  {
    "text": "and by being clever about how you leverage that redundancy, ",
    "start": "1189599",
    "end": "1192637"
  },
  {
    "text": "you can save yourself a lot of work.",
    "start": "1192637",
    "end": "1194460"
  },
  {
    "text": "This set of outputs that I've written has a special name.",
    "start": "1196020",
    "end": "1198560"
  },
  {
    "text": "It's called the discrete Fourier transform of the coefficients, ",
    "start": "1198900",
    "end": "1202148"
  },
  {
    "text": "and if you want to learn more, I actually did another lecture for that same Julia MIT ",
    "start": "1202148",
    "end": "1206512"
  },
  {
    "text": "class all about discrete Fourier transforms, and there's also a really excellent video on ",
    "start": "1206512",
    "end": "1211080"
  },
  {
    "text": "the channel Reducible talking about the fast Fourier transform, ",
    "start": "1211080",
    "end": "1214328"
  },
  {
    "text": "which is an algorithm for computing these more quickly.",
    "start": "1214328",
    "end": "1217120"
  },
  {
    "text": "Also Veritasium recently did a really good video on FFTs, so you've got lots of options.",
    "start": "1217480",
    "end": "1221760"
  },
  {
    "text": "And that fast algorithm really is the point for us.",
    "start": "1222260",
    "end": "1224660"
  },
  {
    "text": "Again, because of all this redundancy, there exists a method to go from ",
    "start": "1225120",
    "end": "1228702"
  },
  {
    "text": "the coefficients to all of these outputs, where instead of doing on ",
    "start": "1228702",
    "end": "1232085"
  },
  {
    "text": "the order of n squared operations, you do on the order of n times the ",
    "start": "1232085",
    "end": "1235568"
  },
  {
    "text": "log of n operations, which is much much better as you scale to big lists.",
    "start": "1235568",
    "end": "1239200"
  },
  {
    "text": "And, importantly, this FFT algorithm goes both ways.",
    "start": "1239660",
    "end": "1242540"
  },
  {
    "text": "It also lets you go from the outputs to the coefficients.",
    "start": "1242700",
    "end": "1245480"
  },
  {
    "text": "So, bringing it all together, let's look back at our algorithm outline.",
    "start": "1246220",
    "end": "1249059"
  },
  {
    "text": "Now we can say, whenever you're given two long lists of numbers, ",
    "start": "1249420",
    "end": "1252596"
  },
  {
    "text": "and you want to take their convolution, first compute the fast Fourier transform of ",
    "start": "1252596",
    "end": "1256701"
  },
  {
    "text": "each one of them, which, in the back of your mind, ",
    "start": "1256702",
    "end": "1259195"
  },
  {
    "text": "you can just think of as treating them like they're the coefficients of a polynomial, ",
    "start": "1259195",
    "end": "1263398"
  },
  {
    "text": "and evaluating it at a very specially selected set of points.",
    "start": "1263398",
    "end": "1266380"
  },
  {
    "text": "Then, multiply together the two results that you just got, point-wise, ",
    "start": "1266900",
    "end": "1270377"
  },
  {
    "text": "which is nice and fast, and then do an inverse fast Fourier transform, ",
    "start": "1270377",
    "end": "1273855"
  },
  {
    "text": "and what that gives you is the sneaky backdoor way to compute the convolution that ",
    "start": "1273855",
    "end": "1277919"
  },
  {
    "text": "we were looking for.",
    "start": "1277920",
    "end": "1278900"
  },
  {
    "text": "But this time, it only involves O of n log n operations.",
    "start": "1279040",
    "end": "1282240"
  },
  {
    "start": "1282000",
    "end": "1381000"
  },
  {
    "text": "That's really cool to me.",
    "start": "1283140",
    "end": "1284740"
  },
  {
    "text": "This very specific context where convolutions show up, ",
    "start": "1285120",
    "end": "1287833"
  },
  {
    "text": "multiplying two polynomials, opens the doors for an algorithm ",
    "start": "1287833",
    "end": "1290892"
  },
  {
    "text": "that's relevant everywhere else where convolutions might come up.",
    "start": "1290892",
    "end": "1294100"
  },
  {
    "text": "If you want to add probability distributions, do some large image processing, ",
    "start": "1294180",
    "end": "1298080"
  },
  {
    "text": "whatever it might be, and I just think that's such a good example of why you should be ",
    "start": "1298080",
    "end": "1302429"
  },
  {
    "text": "excited when you see some operation or concept in math show up in a lot of seemingly ",
    "start": "1302430",
    "end": "1306680"
  },
  {
    "text": "unrelated areas.",
    "start": "1306680",
    "end": "1307480"
  },
  {
    "text": "If you want a little homework, here's something that's fun to think about.",
    "start": "1308480",
    "end": "1311500"
  },
  {
    "text": "Explain why when you multiply two different numbers, ",
    "start": "1311720",
    "end": "1314359"
  },
  {
    "text": "just ordinary multiplication the way we all learn in elementary school, ",
    "start": "1314359",
    "end": "1317945"
  },
  {
    "text": "what you're doing is basically a convolution between the digits of those numbers.",
    "start": "1317945",
    "end": "1321980"
  },
  {
    "text": "There's some added steps with carries and the like, but the core step is a convolution.",
    "start": "1322500",
    "end": "1326460"
  },
  {
    "text": "In light of the existence of a fast algorithm, ",
    "start": "1327280",
    "end": "1329704"
  },
  {
    "text": "what that means is if you have two very large integers, ",
    "start": "1329704",
    "end": "1332591"
  },
  {
    "text": "then there exists a way to find their product that's faster than the method we learn ",
    "start": "1332592",
    "end": "1336976"
  },
  {
    "text": "in elementary school, that instead of requiring O of n squared operations, ",
    "start": "1336976",
    "end": "1340845"
  },
  {
    "text": "only requires O of n log n, which doesn't even feel like it should be possible.",
    "start": "1340845",
    "end": "1344919"
  },
  {
    "text": "The catch is that before this is actually useful in practice, ",
    "start": "1345380",
    "end": "1348375"
  },
  {
    "text": "your numbers would have to be absolutely monstrous.",
    "start": "1348375",
    "end": "1350840"
  },
  {
    "text": "But still, it's cool that such an algorithm exists.",
    "start": "1351220",
    "end": "1353860"
  },
  {
    "text": "And next up, we'll turn our attention to the continuous ",
    "start": "1355160",
    "end": "1357420"
  },
  {
    "text": "case with a special focus on probability distributions.",
    "start": "1357420",
    "end": "1359640"
  }
]