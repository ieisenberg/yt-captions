[
  {
    "text": "one of the main things I keep in mind on this is I've read so many articles and",
    "start": "240",
    "end": "5839"
  },
  {
    "text": "blog posts and opinions everywhere in the internet over the years that say don't do rewrites that's like the main",
    "start": "5839",
    "end": "12679"
  },
  {
    "text": "takeaway to to remember for all of those articles and I want to be the person who does the opposite and says rewrites are",
    "start": "12679",
    "end": "19400"
  },
  {
    "text": "possible you can do rewrites if you do them right and how do you do them right there's many key things involved in",
    "start": "19400",
    "end": "26320"
  },
  {
    "text": "there but it's not a thing where you have to kind of push the rer option aside if it's something that you don't",
    "start": "26320",
    "end": "32238"
  },
  {
    "text": "think is possible B with for change log is provided by fastly learn more at",
    "start": "32239",
    "end": "39559"
  },
  {
    "text": "fastly.com we move fast and fix things here at change law because of rbar check them out at rar.com and we're hosted on",
    "start": "39559",
    "end": "46680"
  },
  {
    "text": "Leno Cloud servers head to lin.com changelog what up friends you might not",
    "start": "46680",
    "end": "52480"
  },
  {
    "text": "be aware but we've been partner with Leno since 2016 that's a long time ago way back when we first launched our open",
    "start": "52480",
    "end": "59600"
  },
  {
    "text": "source platform that you now see at changel law.com lenoe was there to help us and we are so grateful fast forward",
    "start": "59600",
    "end": "67640"
  },
  {
    "text": "several years now and linode is still in our corner behind the scenes helping us",
    "start": "67640",
    "end": "72880"
  },
  {
    "text": "to ensure we're running on the very best cloud infrastructure out there we trust linode they keep it fast and they keep",
    "start": "72880",
    "end": "79479"
  },
  {
    "text": "it simple get $100 in free credit at l.com changelog again $100 in free",
    "start": "79479",
    "end": "85880"
  },
  {
    "text": "credit at len. changelog [Music]",
    "start": "85880",
    "end": "93830"
  },
  {
    "text": "[Music] what's up welcome back everyone this is",
    "start": "97900",
    "end": "104479"
  },
  {
    "text": "the change loo podcast featuring the hackers the leaders and the innovators in the world of software I'm Adis kovak",
    "start": "104479",
    "end": "111600"
  },
  {
    "text": "editor and chief here at changelog on today's show we're joined by Maxim vanu to talk about shopify's massive",
    "start": "111600",
    "end": "117719"
  },
  {
    "text": "storefront rewrite from your Ruby on Rails monolith to a completely new implementation written in Ruby as you",
    "start": "117719",
    "end": "124159"
  },
  {
    "text": "may know it's a well-known opinion that rewrites are the single worst strategic mistake that any software company can",
    "start": "124159",
    "end": "130239"
  },
  {
    "text": "make and generally it's something you should never do but Maxi and the team at Shopify have proved successful in their",
    "start": "130239",
    "end": "137560"
  },
  {
    "text": "efforts to rewrite Shopify storefront and today's conversation covers all the",
    "start": "137560",
    "end": "143530"
  },
  {
    "text": "[Music] details so Maxim we teased this convers",
    "start": "143530",
    "end": "150319"
  },
  {
    "text": "when we had your colleague Simon Escalon on the show a few weeks back episode",
    "start": "150319",
    "end": "155760"
  },
  {
    "text": "412 but he was here to talk about napkin math and he was part of this Shopify",
    "start": "155760",
    "end": "160840"
  },
  {
    "text": "storefront rewrite but we didn't want to talk about it with him cuz we knew you were coming up and we want to talk about",
    "start": "160840",
    "end": "166159"
  },
  {
    "text": "it with you so first of all thanks for joining us on the change log to talk about this project of yours my pleasure",
    "start": "166159",
    "end": "173159"
  },
  {
    "text": "thanks for the invite so it's a big thing to rewrite anything but especially something that's big and powerful and",
    "start": "173159",
    "end": "179959"
  },
  {
    "text": "successful as Shopify I think the main piece of the news that people latched on",
    "start": "179959",
    "end": "186840"
  },
  {
    "text": "to was the monolith versus microservices implications here as",
    "start": "186840",
    "end": "193560"
  },
  {
    "text": "Shopify has been a poster child of rails monoliths at scale right yep and it's",
    "start": "193560",
    "end": "203080"
  },
  {
    "text": "something that we're learning about every day I think the more we kind of",
    "start": "203080",
    "end": "208599"
  },
  {
    "text": "figure out what should go the monolith and what shouldn't and that kind of led",
    "start": "208599",
    "end": "213720"
  },
  {
    "text": "to the decision to split that specific domain into a separate U application",
    "start": "213720",
    "end": "219360"
  },
  {
    "text": "yeah so maybe As We Lay the foundation for this conversation we're going to go through the decision-making process for",
    "start": "219360",
    "end": "224480"
  },
  {
    "text": "the rewrite we're going to go through the process of actually getting it done",
    "start": "224480",
    "end": "229720"
  },
  {
    "text": "because it was a couple year Endeavor and at scale you had to move slowly and",
    "start": "229720",
    "end": "235120"
  },
  {
    "text": "carefully and you guys built some really cool stuff with some engine X Lua re writing things to like make sure you're",
    "start": "235120",
    "end": "241439"
  },
  {
    "text": "doing it right along the way we're going to dive into those details but first of all the groundwork of like what the monolith looks like maybe before you",
    "start": "241439",
    "end": "248400"
  },
  {
    "text": "started what all is involved people know Shopify as an e-commerce platform where",
    "start": "248400",
    "end": "254680"
  },
  {
    "text": "people can run their own online shops and so it's multi-tenant in that way I",
    "start": "254680",
    "end": "259799"
  },
  {
    "text": "assume a lot of our listeners know what Shopify is but like what does the monolith look like and what all is it doing right so Shopify was started",
    "start": "259799",
    "end": "267440"
  },
  {
    "text": "almost 15 years ago now and this all started as a simple rails application",
    "start": "267440",
    "end": "273000"
  },
  {
    "text": "The Majestic monolith approach where everything would be into that one application which we're still using",
    "start": "273000",
    "end": "279120"
  },
  {
    "text": "today 15 years later and we're that's the main place where most Shopify developers tend to ship code into of",
    "start": "279120",
    "end": "286320"
  },
  {
    "text": "course with scaling you run into challenges with how you get to you know handle multiple hundreds of developers",
    "start": "286320",
    "end": "293199"
  },
  {
    "text": "working on the same platform uh shipping that that code base into you know at",
    "start": "293199",
    "end": "298560"
  },
  {
    "text": "scale but also dealing with what should go in the monolith and as we eventually",
    "start": "298560",
    "end": "304479"
  },
  {
    "text": "ran into a a point where it wasn't possible to use rails as as it is into its base form we hit the the limits of",
    "start": "304479",
    "end": "313120"
  },
  {
    "text": "what we could do with basic rails um so as you mentioned Shopify is a multi-tenant application so just dealing",
    "start": "313120",
    "end": "319759"
  },
  {
    "text": "with the implications of that and making sure that there's no um cross tenant access for data that sort of thing",
    "start": "319759",
    "end": "325600"
  },
  {
    "text": "required some patches to the monolith so the monolith is a an application where most of the code is",
    "start": "325600",
    "end": "332000"
  },
  {
    "text": "present in there we're now splitting it into separate components so that we have business domain specific components in",
    "start": "332000",
    "end": "338360"
  },
  {
    "text": "the monolith and that makes it so that for example storefront and online store specifically was this own component",
    "start": "338360",
    "end": "344840"
  },
  {
    "text": "where everything would be into that directory so it kind of gives us a nice",
    "start": "344840",
    "end": "350039"
  },
  {
    "text": "way to create these boundaries between the different components and so that there's no cross uh component access and",
    "start": "350039",
    "end": "357440"
  },
  {
    "text": "hopefully eventually everything has this sort of inter interace between each component and there's no um violation",
    "start": "357440",
    "end": "364199"
  },
  {
    "text": "there was one um article on the Shopify engineering blog that we've just posted about this um that explains how we're",
    "start": "364199",
    "end": "371400"
  },
  {
    "text": "kind of starting to enforce more the boundaries between those components to",
    "start": "371400",
    "end": "376639"
  },
  {
    "text": "make sure that we don't run into issues with different class names that don't make sense or that sort of stuff so",
    "start": "376639",
    "end": "384039"
  },
  {
    "text": "these are code boundaries though you're still inside of a process or inside of a code base these are not services that",
    "start": "384039",
    "end": "391120"
  },
  {
    "text": "talk over a network correct right same process correct so it's really more of a",
    "start": "391120",
    "end": "396680"
  },
  {
    "text": "kind of a developer experience thing more than it is a topology thing for networking for example okay and so if we",
    "start": "396680",
    "end": "403560"
  },
  {
    "text": "talk about the monoliths parts we mentioned storefront you can explain exactly what storefront is then there's",
    "start": "403560",
    "end": "409360"
  },
  {
    "text": "the admin if anybody's run a Shopify shop they know what the admin is at least to a certain degree surely there's",
    "start": "409360",
    "end": "415440"
  },
  {
    "text": "more to it there's the payment processing and the checkout part so there are some logical sections am I",
    "start": "415440",
    "end": "422360"
  },
  {
    "text": "missing any I'm sure I'm missing some I'm sure there's tons on the back end there's yeah yes what else is there so",
    "start": "422360",
    "end": "428199"
  },
  {
    "text": "there's a ton of them yeah I mean the big ones so there's of course the billing stuff is in there there's uh",
    "start": "428199",
    "end": "434919"
  },
  {
    "text": "Payment Processing as you mentioned there's of course storefront everything that's about you know pricing returns",
    "start": "434919",
    "end": "442199"
  },
  {
    "text": "that kind of stuff is all separated into its own components and it typically lines up with a specific team owning",
    "start": "442199",
    "end": "448759"
  },
  {
    "text": "that component to to build it so the way those components work is essentially a tiny rails app within each component with its",
    "start": "448759",
    "end": "455800"
  },
  {
    "text": "own app directory tests and everything that's kind of wrapped up into this one uh component and um online store is one",
    "start": "455800",
    "end": "464159"
  },
  {
    "text": "of them for storefront specific stuff okay so it's worth noting that the storefront which is the topic of",
    "start": "464159",
    "end": "470599"
  },
  {
    "text": "conversation here has been Rewritten during with this strenuous process that we're going to go through here it's",
    "start": "470599",
    "end": "477080"
  },
  {
    "text": "still a ruby app yes is it still a rails is it its own rails app or is it somehow",
    "start": "477080",
    "end": "483240"
  },
  {
    "text": "different than that so we started with a base Ruby application uh we are using",
    "start": "483240",
    "end": "489440"
  },
  {
    "text": "some parts of rails but not rails itself directly and the reason for that is the way that Shopify stor fonts are",
    "start": "489440",
    "end": "495639"
  },
  {
    "text": "implemented aren't really don't really line up with the crud um pattern that typically a rails",
    "start": "495639",
    "end": "504000"
  },
  {
    "text": "app would use so if you go on a Shopify storefront you go on the index page for",
    "start": "504000",
    "end": "509080"
  },
  {
    "text": "example simple you're going to have uh the index Pages the product pages The Collection pages and all of those",
    "start": "509080",
    "end": "514959"
  },
  {
    "text": "different endpoints that you would see on a storefront now all of those things",
    "start": "514959",
    "end": "520599"
  },
  {
    "text": "could be implemented as rails actions to be rendered but starting out from scratch we kind of realize that we don't",
    "start": "520599",
    "end": "526560"
  },
  {
    "text": "need everything that rails provides and we could simplify this with a ruby application to get started with at first",
    "start": "526560",
    "end": "533680"
  },
  {
    "text": "so the storefront is kind of a simplified part of a full stack in so far as it's I'm assuming now so correct",
    "start": "533680",
    "end": "541040"
  },
  {
    "text": "me here you it's taken in a request and then it's like basically once it determines which storefront it is then",
    "start": "541040",
    "end": "547880"
  },
  {
    "text": "it says okay get all my templates which are writable by the storefront owner",
    "start": "547880",
    "end": "553079"
  },
  {
    "text": "right like they're liquid templates by whoever owns that theme or whatever it happens to be grab that those templates",
    "start": "553079",
    "end": "559079"
  },
  {
    "text": "grab all the data merge them together and spit out some HTML and like in the most simplified form is what it's trying",
    "start": "559079",
    "end": "565160"
  },
  {
    "text": "to accomplish right that's exactly what it is and because of that the goal of",
    "start": "565160",
    "end": "570480"
  },
  {
    "text": "that specific application is to do that really well really quickly and at scale so because we don't necessarily want the",
    "start": "570480",
    "end": "578399"
  },
  {
    "text": "same performance criterias that we would for the admin for example separating that application gives us a do one thing",
    "start": "578399",
    "end": "585920"
  },
  {
    "text": "and do it well kind of Unix philosophy thing for that specific service to do so what what were the goals with the",
    "start": "585920",
    "end": "591760"
  },
  {
    "text": "rewrite you mentioned there was like three aspects that you wanted to accomplish by going through this process",
    "start": "591760",
    "end": "598600"
  },
  {
    "text": "right so so um of course uh success criteria uh the first one was to make sure that we had the same features and",
    "start": "598600",
    "end": "606240"
  },
  {
    "text": "the same behavior in the new one than we did with the older application so by",
    "start": "606240",
    "end": "611399"
  },
  {
    "text": "that we say that for a given request for the same input if both are treated as black boxes you get the same output and",
    "start": "611399",
    "end": "619000"
  },
  {
    "text": "they're just behaving the same way for whatever input you give them that's where we use the verifier mechanism to",
    "start": "619000",
    "end": "624760"
  },
  {
    "text": "make sure that we for a given input we get the same output and make sure that we never serve something to buyers that",
    "start": "624760",
    "end": "631320"
  },
  {
    "text": "is not equivalent and that's incorrect or invalid the second one would be to um",
    "start": "631320",
    "end": "637120"
  },
  {
    "text": "improve performance of course so improving performance uh with the um new",
    "start": "637120",
    "end": "642720"
  },
  {
    "text": "application we're able to really focus and drill down into the performance criteria that we've set for this",
    "start": "642720",
    "end": "648839"
  },
  {
    "text": "application but not only the application itself in terms of infrastructure we've kind of thought about what we want out",
    "start": "648839",
    "end": "655680"
  },
  {
    "text": "of this in the next 10 20 30 years in in terms of how we want to set up Shopify",
    "start": "655680",
    "end": "660880"
  },
  {
    "text": "store funds to scale with time so for example running on a active active replication setup allows us to read data",
    "start": "660880",
    "end": "668600"
  },
  {
    "text": "from different uh locations without needing to go all around the world if uh we don't have to and thinking about how",
    "start": "668600",
    "end": "675639"
  },
  {
    "text": "we write the code within the Ruby application is something that we're using different Ruby patterns that you",
    "start": "675639",
    "end": "682360"
  },
  {
    "text": "usually wouldn't uh so it's not really idiomatic Ruby it's not really something that you kind of just write you're",
    "start": "682360",
    "end": "689200"
  },
  {
    "text": "pretty Ruby as you usually would we are thinking about certain things that do have an impact on performance in the end",
    "start": "689200",
    "end": "695240"
  },
  {
    "text": "so something like thinking about the memory allocations underneath uh is something that I don't I know I",
    "start": "695240",
    "end": "700519"
  },
  {
    "text": "certainly didn't do before uh that project in Ruby but now we think about those things to um to make sure that",
    "start": "700519",
    "end": "706480"
  },
  {
    "text": "there isn't um anything that we're basically make sure that we're",
    "start": "706480",
    "end": "711880"
  },
  {
    "text": "doing the right thing for performance and uh finally the last one was to improve resilience and capacity so",
    "start": "711880",
    "end": "718480"
  },
  {
    "text": "Shopify has this major kind of like Super Bowl part of the year which is uh Black Friday and Cyber Monday coming up",
    "start": "718480",
    "end": "726639"
  },
  {
    "text": "yes coming up so in a month uh roughly now or even two months I think so end of",
    "start": "726639",
    "end": "731760"
  },
  {
    "text": "November so that's typically the place at time when we kind of figure out or",
    "start": "731760",
    "end": "737880"
  },
  {
    "text": "find out if everything we did during the year was good enough and so far it's",
    "start": "737880",
    "end": "743839"
  },
  {
    "text": "been uh going well this year is going to be the first year that we're powering most the sorf fronts on the platform",
    "start": "743839",
    "end": "750160"
  },
  {
    "text": "with that new implementation so it's our first real kind of game day for us for",
    "start": "750160",
    "end": "756360"
  },
  {
    "text": "actual big time events um in the wild and hopefully everything goes well this",
    "start": "756360",
    "end": "761440"
  },
  {
    "text": "may be famous last words but hopefully everything goes very well and we're doing great but that's the third goal of",
    "start": "761440",
    "end": "767079"
  },
  {
    "text": "the application to basically take what we had with the monolith and make it even better because we're optimizing",
    "start": "767079",
    "end": "772639"
  },
  {
    "text": "this exactly just for that one use case so a big question that I would have at",
    "start": "772639",
    "end": "778480"
  },
  {
    "text": "that point point when you decide here are our goals and they're around performance they're around scalability uh",
    "start": "778480",
    "end": "784440"
  },
  {
    "text": "resiliency and you're extracting this section which has well it's called a limited scope I'm sure it's very",
    "start": "784440",
    "end": "791160"
  },
  {
    "text": "complicated but a limited scope logically is did you consider other languages other runtimes altogether yes",
    "start": "791160",
    "end": "799079"
  },
  {
    "text": "we did the one thing that made us decide to keep using Ruby is one like all of",
    "start": "799079",
    "end": "804600"
  },
  {
    "text": "Shopify is on Ruby so in terms of developer knowledge transfer that's the",
    "start": "804600",
    "end": "809720"
  },
  {
    "text": "most accessible thing to do as a an organization another thing is that the",
    "start": "809720",
    "end": "815320"
  },
  {
    "text": "liquid library that we're using to um render storefronts is Ruby based so",
    "start": "815320",
    "end": "820360"
  },
  {
    "text": "keeping that runtime is something that at the very beginning of the project kind of made sense to get started with",
    "start": "820360",
    "end": "825839"
  },
  {
    "text": "and the other thing that we're now starting to see is we're just starting to explore alternative run times for",
    "start": "825839",
    "end": "832079"
  },
  {
    "text": "Ruby so truffle Ruby is something we're trying to explore to see if that could help with performance in terms of uh",
    "start": "832079",
    "end": "837800"
  },
  {
    "text": "storefront rendering so it's not something that we've really wanted to move away from We're committed to Ruby",
    "start": "837800",
    "end": "844199"
  },
  {
    "text": "committed to rails and that decision still make sense today maybe eventually we'll start to think about a different",
    "start": "844199",
    "end": "851279"
  },
  {
    "text": "uh runtime for this but so far it's been working working well for us well the amount of stuff that you'd have to rewrite like your your rewrite is",
    "start": "851279",
    "end": "858120"
  },
  {
    "text": "already hazardous enough and we all know the the treachery that is a big rewrite this is a pretty substantial",
    "start": "858120",
    "end": "864880"
  },
  {
    "text": "rewrite and it took you two years Soup To Nuts you're you're not 100 % on it but you're getting close right yep",
    "start": "864880",
    "end": "871399"
  },
  {
    "text": "correct Y imagine how much longer that would have been if you had to rewrite liquid in a new language and rewrite I'm",
    "start": "871399",
    "end": "877160"
  },
  {
    "text": "sure you're pulling in lots of shared code throughout Shopify into the new",
    "start": "877160",
    "end": "882199"
  },
  {
    "text": "storefront that you can just build on top of it's like starting with a bunch of Lego blocks if you had to switch",
    "start": "882199",
    "end": "889040"
  },
  {
    "text": "languages all together you'd have to build each Lego block and you may never finish exactly and so I think in this",
    "start": "889040",
    "end": "897360"
  },
  {
    "text": "sort of paradigm extracting everything into this different application I think is the first step and once that's done",
    "start": "897360",
    "end": "904360"
  },
  {
    "text": "we're able to work with it and do something different eventually but the first step of course is to take",
    "start": "904360",
    "end": "909839"
  },
  {
    "text": "everything out and have this isolated thing that we can then play around with",
    "start": "909839",
    "end": "915560"
  },
  {
    "text": "and experiment with and it's so much easier to do that once you have that out of the as a separate service that you",
    "start": "915560",
    "end": "921720"
  },
  {
    "text": "can really have the the smaller scope of um rather than trying to work with different languages into the monolith",
    "start": "921720",
    "end": "927560"
  },
  {
    "text": "which is we would would definitely be a bit harder to do curious why the storefront was chosen or maybe it was",
    "start": "927560",
    "end": "933399"
  },
  {
    "text": "just your team's project are each part of this monolith going to get the similar treatment or they parallelizing",
    "start": "933399",
    "end": "939079"
  },
  {
    "text": "that effort or was it just storefront first and see what happens so so far it's only storefront",
    "start": "939079",
    "end": "945199"
  },
  {
    "text": "and I don't think there's any other plans to extract any other major blocks from there so something to keep in mind",
    "start": "945199",
    "end": "950240"
  },
  {
    "text": "is shopify's platform receives a lot of traffic and the majority of that traffic is for storefront requests admin of",
    "start": "950240",
    "end": "957279"
  },
  {
    "text": "course takes a good chunk of that but but mainly is sront traffic so it made",
    "start": "957279",
    "end": "963079"
  },
  {
    "text": "sense for us to optimize that specific place of the code simply because that's where most of traffic goes and that's",
    "start": "963079",
    "end": "969800"
  },
  {
    "text": "something that we could uh leverage in terms of impact the other thing is that",
    "start": "969800",
    "end": "974880"
  },
  {
    "text": "storefronts don't necessarily have the same requirements as you would need from",
    "start": "974880",
    "end": "980240"
  },
  {
    "text": "the admin for example so the admin is something where you want to have valid",
    "start": "980240",
    "end": "985880"
  },
  {
    "text": "information at all times and for example payment per processing and billing is something where you want the right",
    "start": "985880",
    "end": "992079"
  },
  {
    "text": "amount of dollars being taken in and out of your accounts right so performance is less of a criteria there because you",
    "start": "992079",
    "end": "997959"
  },
  {
    "text": "want to ensure that you have proper calculations and logic going on there on the storefront there is a less of that",
    "start": "997959",
    "end": "1006360"
  },
  {
    "text": "strong requirement yeah I think it it's spot on I mean a storefront is rendering",
    "start": "1006360",
    "end": "1012600"
  },
  {
    "text": "you know correct information obviously it's not about you know not correct or incorrect it's more like an admin is is",
    "start": "1012600",
    "end": "1019839"
  },
  {
    "text": "for a limited scope of type of person whereas a storefront is literally anybody on the internet exactly yeah and",
    "start": "1019839",
    "end": "1026480"
  },
  {
    "text": "if you look at Shopify as a up or down scenario the majority of that up or down",
    "start": "1026480",
    "end": "1031520"
  },
  {
    "text": "scenario is likely looking at storefront not so much admin or others like you might get a limited and a small portion",
    "start": "1031520",
    "end": "1037600"
  },
  {
    "text": "of the world is going to care but the majority is going to care about storefront being open and and fast",
    "start": "1037600",
    "end": "1044240"
  },
  {
    "text": "exactly so storefront the main criteria there is performance um especially as people run onto mobile devices from all",
    "start": "1044240",
    "end": "1050960"
  },
  {
    "text": "around the world you want to get people to have their store fun to be loading as fast as possible from any sort of",
    "start": "1050960",
    "end": "1057280"
  },
  {
    "text": "circumstances so in this case there's a bit less requirement to get the right data at all times to be precise at any",
    "start": "1057280",
    "end": "1064080"
  },
  {
    "text": "given second it's really more to get the response in their in their devices to",
    "start": "1064080",
    "end": "1069280"
  },
  {
    "text": "start doing something you think about this from an A standpoint you mentioned that rails crud scenarios didn't really",
    "start": "1069280",
    "end": "1076159"
  },
  {
    "text": "fit in with the criteria of this this which is we're kind of defining what was it that sort of pinpointed this as Jared",
    "start": "1076159",
    "end": "1083440"
  },
  {
    "text": "mentioned why storefront why would you rewrite this and would you parallel other opportunities inside of Shopify",
    "start": "1083440",
    "end": "1091039"
  },
  {
    "text": "and I think you think about the right tool for the right job and while we're not dismissing the fact that rails isn't",
    "start": "1091039",
    "end": "1096880"
  },
  {
    "text": "amazing as you had said you're committed to both Ruby and rails so this isn't a matter of like done with rails C you bu",
    "start": "1096880",
    "end": "1102720"
  },
  {
    "text": "it's more like well maybe in this scenario performance and uh speed and optimization all these different things",
    "start": "1102720",
    "end": "1109640"
  },
  {
    "text": "outweigh then I think the bigger play here might be to help us understand why rails didn't fit anymore and why a",
    "start": "1109640",
    "end": "1115799"
  },
  {
    "text": "rewrite made more sense and in particular to Jared's question why Ruby",
    "start": "1115799",
    "end": "1121000"
  },
  {
    "text": "still yet which makes sense because hey you got a lot of Ruby knowledge inside of Shopify it would make very little",
    "start": "1121000",
    "end": "1126200"
  },
  {
    "text": "sense to move away from unless you had a really good long-term plan for that but but more so why the rewrite for Ruby But",
    "start": "1126200",
    "end": "1132799"
  },
  {
    "text": "but so much the the right tool for the right job Ruby is still the right tool for the right job but rails didn't fit",
    "start": "1132799",
    "end": "1138080"
  },
  {
    "text": "any more in that realm what like what did you gain by going pure Ruby and non-idiomatic Ruby and all those things",
    "start": "1138080",
    "end": "1145799"
  },
  {
    "text": "one thing that's interesting is we're still using a fair amount of rails components in that new implementation",
    "start": "1145799",
    "end": "1150960"
  },
  {
    "text": "that aren't necessarily the whole rails app itself but we are using some bits of active support to you know compatibility",
    "start": "1150960",
    "end": "1158559"
  },
  {
    "text": "purposes to make sure that what we have in the monolith still works in the new application there's various gems that",
    "start": "1158559",
    "end": "1165360"
  },
  {
    "text": "are still used in rails that we do use in the new implementation so the way I see it it's more of a hybrid in between",
    "start": "1165360",
    "end": "1170960"
  },
  {
    "text": "a barebones ruby app and what rails would provide what we're kind of putting behind is everything that's the rails",
    "start": "1170960",
    "end": "1178640"
  },
  {
    "text": "routing for example was something that we didn't necessarily need for that implementation because of how",
    "start": "1178640",
    "end": "1184600"
  },
  {
    "text": "storefronts are routed um can be implemented fairly simply without going with everything that rails provides with",
    "start": "1184600",
    "end": "1190600"
  },
  {
    "text": "routing but there's a fair amount of uh behavior and features that rails does provide that we are using still in the",
    "start": "1190600",
    "end": "1197559"
  },
  {
    "text": "application through gems and modules that we've um imported there it sounds like to me when you talk",
    "start": "1197559",
    "end": "1203480"
  },
  {
    "text": "about the non-idiomatic Ruby when I read the blog post a lot of the the things you're doing is like using the",
    "start": "1203480",
    "end": "1209960"
  },
  {
    "text": "self-destructive style method calls like map bang where it's not going to return",
    "start": "1209960",
    "end": "1215280"
  },
  {
    "text": "you a new array or whatever happens to be of objects it's going to actually modify itself in place and the reason",
    "start": "1215280",
    "end": "1222240"
  },
  {
    "text": "why you do that inside a storefront is because you are optimizing the heck out",
    "start": "1222240",
    "end": "1227720"
  },
  {
    "text": "of memory consumption right like you're trying to get memory consumption to as small as it could possibly be and so",
    "start": "1227720",
    "end": "1233559"
  },
  {
    "text": "there's your why not rails right there it's like if we can load as little I mean one reason of course there's plenty",
    "start": "1233559",
    "end": "1238760"
  },
  {
    "text": "of reasons but if you could load as little bit of that uh code into memory as possible of what you need of rails",
    "start": "1238760",
    "end": "1245080"
  },
  {
    "text": "and not the entire stack you are undoubtedly going to save in memory allocation all those objects you're not",
    "start": "1245080",
    "end": "1251640"
  },
  {
    "text": "using exactly there was a I think it was Sam saffron from discourse who posted",
    "start": "1251640",
    "end": "1258120"
  },
  {
    "text": "posted a memory article or it was an article about how active record takes so",
    "start": "1258120",
    "end": "1263200"
  },
  {
    "text": "much memory and I think he compared it to simple squel or I don't remember the name it's a library he wrote himself I'm",
    "start": "1263200",
    "end": "1269360"
  },
  {
    "text": "assuming it's a library where you're basically writing raw sequel with some help I guess kind of yeah where how I",
    "start": "1269360",
    "end": "1275720"
  },
  {
    "text": "learned to stop worrying and write my own om there's this one but there's also",
    "start": "1275720",
    "end": "1280960"
  },
  {
    "text": "an analysis of memory bloat in active record 5.2 which is a different one which is interesting um and so that's",
    "start": "1280960",
    "end": "1288360"
  },
  {
    "text": "that's a good example of memory usage that we've kind of skipped with the new implementation and for example because",
    "start": "1288360",
    "end": "1294880"
  },
  {
    "text": "storefront is almost all of it is read traffic there's no rights involved there's no deletes involved there's no",
    "start": "1294880",
    "end": "1300320"
  },
  {
    "text": "updates involved it's really I have a request generate a read response and you know you just have to get data from the",
    "start": "1300320",
    "end": "1306640"
  },
  {
    "text": "database and send it back um that sort of thing does not necessarily warant using active record or anything that's",
    "start": "1306640",
    "end": "1313360"
  },
  {
    "text": "heavier in terms of orm to read data straight SQL kind of works to get the",
    "start": "1313360",
    "end": "1318679"
  },
  {
    "text": "data out of there and uh you know having access to that data directly through",
    "start": "1318679",
    "end": "1324559"
  },
  {
    "text": "weeds is enough so in this case it's a matter of reducing memory allocations to getting the uh garbage collector to run",
    "start": "1324559",
    "end": "1331400"
  },
  {
    "text": "for either less time or less often and that has a major impact on the response times that we're we're seeing what was",
    "start": "1331400",
    "end": "1337720"
  },
  {
    "text": "it that really Drew you to this rewrite like when did the wars begin the show so to speak you know obviously rails has",
    "start": "1337720",
    "end": "1344200"
  },
  {
    "text": "worked quite well for many years you've ipoed you're worth lots of money in terms of a company you're doing amazing",
    "start": "1344200",
    "end": "1350520"
  },
  {
    "text": "what were the main things that sorted to prop up that said you know what we really need to get this down was it simply speed and uptime was it memory",
    "start": "1350520",
    "end": "1359799"
  },
  {
    "text": "was it servers falling over was it like servers on fire what was it that really like struck this cord and said we need",
    "start": "1359799",
    "end": "1365919"
  },
  {
    "text": "to really fix this two years ago I think it was a",
    "start": "1365919",
    "end": "1371080"
  },
  {
    "text": "progressive paino that kind of it never was a big thing that kind of appeared in",
    "start": "1371080",
    "end": "1376720"
  },
  {
    "text": "one night it just just something that with time we started to see performance slowly degrading with uh in terms of",
    "start": "1376720",
    "end": "1384320"
  },
  {
    "text": "response times on the server and eventually we kind of had to do something about it to improve things um",
    "start": "1384320",
    "end": "1391360"
  },
  {
    "text": "and interesting story is the initial commits for that applications were Toby himself who took it upon himself to",
    "start": "1391360",
    "end": "1399080"
  },
  {
    "text": "start something and as a prototype uh get something up and running and make it",
    "start": "1399080",
    "end": "1404360"
  },
  {
    "text": "as lean as possible to get started and then eventually that became a team and we picked it up and that became the",
    "start": "1404360",
    "end": "1410039"
  },
  {
    "text": "project that we're working on but there never was really one thing that kind of said okay that's it we're doing this",
    "start": "1410039",
    "end": "1416279"
  },
  {
    "text": "thing now it's a it was a slow process that eventually kind of arrived at the conclusion that we have to do something",
    "start": "1416279",
    "end": "1423120"
  },
  {
    "text": "why not try something that's a bit different than what we we would usually do and let's see where this goes where",
    "start": "1423120",
    "end": "1429360"
  },
  {
    "text": "this leads and that's where we are now and we kind of realize that the approach made sense and we kind of went along with it and we we still there now that",
    "start": "1429360",
    "end": "1436679"
  },
  {
    "text": "makes sense too why you mentioned the blackbox approach in terms of one of the success criteria meaning that uh feature",
    "start": "1436679",
    "end": "1442039"
  },
  {
    "text": "parody you know obviously if you're going to replace something you want to be replacing it as equally as possible so that a as you begin to switch over",
    "start": "1442039",
    "end": "1449799"
  },
  {
    "text": "they act very similar so not only similar but also ideally bite equal so",
    "start": "1449799",
    "end": "1455159"
  },
  {
    "text": "we want the exact same responses to be return to then identical it is but it",
    "start": "1455159",
    "end": "1461080"
  },
  {
    "text": "depends it depends so that's a good question um in some cases we had to ignore certain uh things to go closer to",
    "start": "1461080",
    "end": "1468960"
  },
  {
    "text": "what you're saying closer to equivalent rather than b equal so one example of that is and that's something that's in",
    "start": "1468960",
    "end": "1474840"
  },
  {
    "text": "Block poost when we do the verification requests to send the initial request to both backends to see if the output is",
    "start": "1474840",
    "end": "1481919"
  },
  {
    "text": "equivalent or itle the same what would sometimes happen is on some storefronts",
    "start": "1481919",
    "end": "1487399"
  },
  {
    "text": "you're you can try to render some random values and those values may change on a",
    "start": "1487399",
    "end": "1493480"
  },
  {
    "text": "render by render basis so if I try to do a request to one of the applications and",
    "start": "1493480",
    "end": "1498960"
  },
  {
    "text": "then I do the same to the other application but both use different random values that's not going to be bite equal and because of that then to",
    "start": "1498960",
    "end": "1506120"
  },
  {
    "text": "us that would be a verification failure and would be hey those two applications are not doing the same thing there's an",
    "start": "1506120",
    "end": "1511840"
  },
  {
    "text": "issue what's wrong but then looking into those we realize that it wasn't really an issue it's more of the the output was",
    "start": "1511840",
    "end": "1519799"
  },
  {
    "text": "using something that relied on either time or Randomness based uh values and because of that that's something we have",
    "start": "1519799",
    "end": "1526120"
  },
  {
    "text": "to ignore and say that's a false negative we have to just accept it and it's fine and move on to to real",
    "start": "1526120",
    "end": "1533090"
  },
  {
    "text": "[Music]",
    "start": "1533090",
    "end": "1541960"
  },
  {
    "text": "issues our friends at pixie are solving some big problems for applications running on kubernetes instantly",
    "start": "1541960",
    "end": "1548919"
  },
  {
    "text": "troubleshoot your applications on kubernetes with no instrumentation debug with scripts and everything lives inside",
    "start": "1548919",
    "end": "1555720"
  },
  {
    "text": "kubernetes but don't take it from me Kelsey high tower is pretty bullish on what pixie brings to the table Kelsey do",
    "start": "1555720",
    "end": "1562080"
  },
  {
    "text": "me a favor and let our listeners know what problems pixie solves for you yeah I did this keynote at cucon where we",
    "start": "1562080",
    "end": "1567520"
  },
  {
    "text": "talked about this path to serus and the whole serus movement is really about making our application simpler removing",
    "start": "1567520",
    "end": "1574080"
  },
  {
    "text": "the boiler plate and pushing it down into the platform now one of the most kind of prevalent platforms today is",
    "start": "1574080",
    "end": "1580679"
  },
  {
    "text": "kubernetes works on Prem works on your laptop works in the cloud but it has this missing piece around data and",
    "start": "1580679",
    "end": "1587200"
  },
  {
    "text": "observ ability and this is where pixie comes in to make that platform even better so the more features we can get",
    "start": "1587200",
    "end": "1593679"
  },
  {
    "text": "from our platform things like instrumentation ad hoc debugging Auto Telemetry I can keep all of that logic",
    "start": "1593679",
    "end": "1600960"
  },
  {
    "text": "out of my codebase and keep my app super simple the simpler the app is the easier it is to maintain well said thanks",
    "start": "1600960",
    "end": "1607760"
  },
  {
    "text": "Kelsey well pixie is in private beta right now but I'm here to tell you that you're invited to their launch event on",
    "start": "1607760",
    "end": "1613440"
  },
  {
    "text": "October 8th along with Kelsey where they'll announce and demo what they're doing with Pixie check this show notes",
    "start": "1613440",
    "end": "1618600"
  },
  {
    "text": "for a link to the event and the repo on GitHub or head to pixil laabs a to learn more once again pixil laabs",
    "start": "1618600",
    "end": "1627640"
  },
  {
    "text": "[Music]",
    "start": "1628290",
    "end": "1635109"
  },
  {
    "text": "[Music] aai [Music]",
    "start": "1643070",
    "end": "1651520"
  },
  {
    "text": "all right maxam so you and the team defined your success criteria feature parody improving",
    "start": "1651520",
    "end": "1657360"
  },
  {
    "text": "performance and improving resilience and capacity and then you set out to rewrite the thing you had to somehow have some",
    "start": "1657360",
    "end": "1665159"
  },
  {
    "text": "guide rails to know whether or not you were totally screwing up or not we've talked about it a little bit but guide",
    "start": "1665159",
    "end": "1671039"
  },
  {
    "text": "us through the whole process this has taken a while and you had to invent a few tricks in Tech just to help you get",
    "start": "1671039",
    "end": "1679559"
  },
  {
    "text": "this rewrite written and deployed out into the greater Shopify ecosystem so",
    "start": "1679559",
    "end": "1686240"
  },
  {
    "text": "tell us how you tackled this problem so the initial Vision around this was to of",
    "start": "1686240",
    "end": "1694279"
  },
  {
    "text": "course when you're starting from scratch um there's there's always like a",
    "start": "1694279",
    "end": "1699320"
  },
  {
    "text": "transitional period where you don't have anything and up to a certain point you don't have anything working well enough",
    "start": "1699320",
    "end": "1705720"
  },
  {
    "text": "to say we have something that's equivalent to the previous implementation so that",
    "start": "1705720",
    "end": "1711519"
  },
  {
    "text": "whole starting phase of the project is very much exploratory and you don't",
    "start": "1711519",
    "end": "1716919"
  },
  {
    "text": "really know if what you're doing Works to reduce the risk of that uh We've implemented a what we call a verifier",
    "start": "1716919",
    "end": "1724360"
  },
  {
    "text": "mechanism so what that allows us to do is to compare real world production data",
    "start": "1724360",
    "end": "1730600"
  },
  {
    "text": "and see if what we're doing is close to our reference Baseline which is a",
    "start": "1730600",
    "end": "1735799"
  },
  {
    "text": "monolith in this case so the previous implementation lived in the monolith we wanted to make sure that what we're doing in the new service is doing the",
    "start": "1735799",
    "end": "1743799"
  },
  {
    "text": "equivalent Behavior or the equivalent output in terms of what it does and that",
    "start": "1743799",
    "end": "1749200"
  },
  {
    "text": "mechanism allows us to say okay we're looking at the responses from both applications and we see discrepancy",
    "start": "1749200",
    "end": "1755519"
  },
  {
    "text": "online I don't know 117 there's a missing module that's not included or",
    "start": "1755519",
    "end": "1760720"
  },
  {
    "text": "something and so that gives us an idea okay we have to fix this either most of the time it's something that we haven't",
    "start": "1760720",
    "end": "1767559"
  },
  {
    "text": "implemented in the new application or it's something that's a bug that we've noticed that we didn't know was there",
    "start": "1767559",
    "end": "1773840"
  },
  {
    "text": "but because we have this verification mechanism that now we realized oh maybe there's been a bug in that application",
    "start": "1773840",
    "end": "1779039"
  },
  {
    "text": "in the monolith that we didn't really know about and that's something that we've ran into of like it's a bug that's",
    "start": "1779039",
    "end": "1784919"
  },
  {
    "text": "been there for six years it we never really knew it was there but upon doing that verification process we realized",
    "start": "1784919",
    "end": "1790919"
  },
  {
    "text": "that we had implemented something that was the right thing in the new application and upon comparison realized",
    "start": "1790919",
    "end": "1797760"
  },
  {
    "text": "it's never been the right thing in the previous one so it helped us figure out",
    "start": "1797760",
    "end": "1802919"
  },
  {
    "text": "how to go and Implement what's most impactful to get towards completion and parity in terms of features as quickly",
    "start": "1802919",
    "end": "1809240"
  },
  {
    "text": "as possible so that's why at first when we first started the project we started to um look at a single shop to say okay",
    "start": "1809240",
    "end": "1816840"
  },
  {
    "text": "that's the one shop we want to try to support and uh Target for the release of that new thing running the verifier",
    "start": "1816840",
    "end": "1823279"
  },
  {
    "text": "mechanism gets us to a point where we're able to say we're that close to getting that response to be exactly the same for",
    "start": "1823279",
    "end": "1830640"
  },
  {
    "text": "the new application and from there move on to other endpoints other shops and then figure out how to scale to the the",
    "start": "1830640",
    "end": "1836519"
  },
  {
    "text": "rest of the platform so I've done this at tiny scale where I take one endpoint I curl the endpoint take the response",
    "start": "1836519",
    "end": "1844760"
  },
  {
    "text": "take the other endpoint the one that's in development or my the one I'm building curl the same thing take the",
    "start": "1844760",
    "end": "1850600"
  },
  {
    "text": "response pip at the diff and then I look at the diff and I hope diff says these two files are identical or whatever it",
    "start": "1850600",
    "end": "1856840"
  },
  {
    "text": "says right yep you never quite got there because of all this Randomness and stuff but is was your verifier essentially a",
    "start": "1856840",
    "end": "1863039"
  },
  {
    "text": "differ that you just like lodged into your request pipeline tell us how that worked exactly so that's exactly what",
    "start": "1863039",
    "end": "1869960"
  },
  {
    "text": "the the mental model around this is and it's just instead of us doing the curls",
    "start": "1869960",
    "end": "1875399"
  },
  {
    "text": "and the diffs manually by hand in the command line it's something that's happening your customers did it exactly",
    "start": "1875399",
    "end": "1882000"
  },
  {
    "text": "and automatically for us um we're getting some data coming back from everyone just request store funds from",
    "start": "1882000",
    "end": "1887840"
  },
  {
    "text": "all around the world right so of course there's that part of the process but there's also the one that we're doing locally on our own machines so this",
    "start": "1887840",
    "end": "1894760"
  },
  {
    "text": "thing runs in production where the verifier gives us data about okay there's that many failures in terms of",
    "start": "1894760",
    "end": "1900519"
  },
  {
    "text": "verification that you have to fix for shop XYZ and then over these different",
    "start": "1900519",
    "end": "1906000"
  },
  {
    "text": "endpoints but also once we know that there's an issue on a given storefront or a given endpoint we then have to go",
    "start": "1906000",
    "end": "1912480"
  },
  {
    "text": "in our machines and try to figure out okay what's the issue how can I fix it and how can I give like bring it back to",
    "start": "1912480",
    "end": "1917960"
  },
  {
    "text": "parody with the the Baseline implementation so that specific mechanism is into a engine X writing",
    "start": "1917960",
    "end": "1925559"
  },
  {
    "text": "module where it's written in Lua we're using open resty and what it essentially does is at the very beginning of the",
    "start": "1925559",
    "end": "1933159"
  },
  {
    "text": "project all traffic was going all storefront traffic was going to the monolith for storefront traffic nothing",
    "start": "1933159",
    "end": "1939480"
  },
  {
    "text": "was really going to the new implementation as we were just getting started the nice thing about that is for",
    "start": "1939480",
    "end": "1945399"
  },
  {
    "text": "every I don't I don't remember exactly what sampling rate we had but for example something like for one in every",
    "start": "1945399",
    "end": "1952039"
  },
  {
    "text": "thousand requests that are coming into Shopify for storefronts take it but also do the request to the new implementation",
    "start": "1952039",
    "end": "1959039"
  },
  {
    "text": "and compare the output of those two uh requests do a diff on them and then",
    "start": "1959039",
    "end": "1964639"
  },
  {
    "text": "upload whatever diff results happen to an external store so we can look at them",
    "start": "1964639",
    "end": "1970159"
  },
  {
    "text": "later and see what uh was the issue so that helped us figure out",
    "start": "1970159",
    "end": "1975440"
  },
  {
    "text": "that certain shop shops have more diffs than others certain endpoints have more diffs than others but also seeing the",
    "start": "1975440",
    "end": "1981440"
  },
  {
    "text": "traffic patterns of where we should try to tackle uh at first was a super nice",
    "start": "1981440",
    "end": "1987559"
  },
  {
    "text": "signal for us to say okay there's that many failures there let's try to do this one first to get as much impact as we",
    "start": "1987559",
    "end": "1993480"
  },
  {
    "text": "can uh there and then move on to the other ones eventually what kind of diffs are we talking about here like what kind",
    "start": "1993480",
    "end": "1999679"
  },
  {
    "text": "of non-p parody what's what's an extreme example and maybe a non-extreme example of a diff gone wrong let's just this I",
    "start": "1999679",
    "end": "2008120"
  },
  {
    "text": "should I could talk about this for hours um so one of the most extreme examples",
    "start": "2008120",
    "end": "2013760"
  },
  {
    "text": "is you try to open the page so I'm talking about a buyer perspective you",
    "start": "2013760",
    "end": "2018840"
  },
  {
    "text": "open up a storefront and assuming that the new implementation was going to render that page all you would see is a",
    "start": "2018840",
    "end": "2025360"
  },
  {
    "text": "blank page nothing else and that's one of the most extreme examples where you're like okay this is this cannot go",
    "start": "2025360",
    "end": "2030559"
  },
  {
    "text": "out in production right and one of the reasons behind that could be a missing head tag for whatever reason there's a",
    "start": "2030559",
    "end": "2036360"
  },
  {
    "text": "missing thing thing that just the page does not work at all some of the more extreme examples in terms of not in",
    "start": "2036360",
    "end": "2043360"
  },
  {
    "text": "terms of how a buyer would perceive it but in terms of how we would perceive it is there's a missing new line but that's",
    "start": "2043360",
    "end": "2051398"
  },
  {
    "text": "it there's just one missing new line somewhere for some reason we're not returning the same string for whatever",
    "start": "2051399",
    "end": "2056878"
  },
  {
    "text": "method and the verifier screams hey that's not the same thing there's a missing new line there which is not in",
    "start": "2056879",
    "end": "2062440"
  },
  {
    "text": "the old one and that's something that we have to deal with so of course all of those non problematic issues we were",
    "start": "2062440",
    "end": "2069240"
  },
  {
    "text": "seeing we started to say oh that's not actually an issue we can just ignore that away and say that new line is not",
    "start": "2069240",
    "end": "2075240"
  },
  {
    "text": "really a problem or fix it of course but there's some cases where there's issues that we realize just like the time based",
    "start": "2075240",
    "end": "2081040"
  },
  {
    "text": "and the randomness based uh issues that we didn't really want to block us as we",
    "start": "2081040",
    "end": "2087079"
  },
  {
    "text": "started to get more and more support for certain requests and we were able to say",
    "start": "2087079",
    "end": "2093040"
  },
  {
    "text": "okay well these patterns that look like this for example if there's a time stamp",
    "start": "2093040",
    "end": "2098079"
  },
  {
    "text": "in the the responses we can just ignore that away if there's a script ID that's being generated by the script or",
    "start": "2098079",
    "end": "2105320"
  },
  {
    "text": "something ignore that away and then as more patterns starting to come up we came up with a pool of patterns that we",
    "start": "2105320",
    "end": "2111760"
  },
  {
    "text": "knew weren't problematic and knowing those we were able to focus on the actual issues let's all about that thing",
    "start": "2111760",
    "end": "2117520"
  },
  {
    "text": "because I mean this isn't like a typical error tracker that you're doing like this is parody and I I'm curious how you",
    "start": "2117520",
    "end": "2126200"
  },
  {
    "text": "log these things how do you keep track of and organize this so not only you but others can you know triage this and say",
    "start": "2126200",
    "end": "2133079"
  },
  {
    "text": "okay these are the ones we should pay attention to these are the ones we shouldn't so like it's probably not your typical bug tracker that's doing this",
    "start": "2133079",
    "end": "2138599"
  },
  {
    "text": "for you or maybe it is I don't know how did you log these things and then organize them great question and it",
    "start": "2138599",
    "end": "2144680"
  },
  {
    "text": "actually ties into how would you do this so assuming I'm asking you the question you have to do this project where you",
    "start": "2144680",
    "end": "2150720"
  },
  {
    "text": "implement this new thing and you have a million merchants on your platform that are using the like so many store funds",
    "start": "2150720",
    "end": "2157920"
  },
  {
    "text": "on the platform you have to get parody for all of them do you go with a breath",
    "start": "2157920",
    "end": "2163680"
  },
  {
    "text": "uh first approach where you try to support as many shops as you can for say a single endpoint like all index pages",
    "start": "2163680",
    "end": "2170880"
  },
  {
    "text": "and you support all index Pages across all of the uh merchants or you try to go",
    "start": "2170880",
    "end": "2176160"
  },
  {
    "text": "for a single Merchant and cover everything for that single Merchant but maybe that Merchant has some features",
    "start": "2176160",
    "end": "2182200"
  },
  {
    "text": "that the other Merchant does not use and you have to think about well maybe I",
    "start": "2182200",
    "end": "2187280"
  },
  {
    "text": "should consider other Merchants first should I consider the bigger Merchants the smaller Merchants because there's more people do I want to look at it as a",
    "start": "2187280",
    "end": "2194760"
  },
  {
    "text": "theme based approach because usually there's going to be a mass amount of shops that use the same theme different",
    "start": "2194760",
    "end": "2201640"
  },
  {
    "text": "ways of looking at this and in this case uh it kind of ended up being a thing where we started with a handful of shops",
    "start": "2201640",
    "end": "2208160"
  },
  {
    "text": "at first that were the most I guess I could say problematic shops in terms of performance where they would cause a",
    "start": "2208160",
    "end": "2214280"
  },
  {
    "text": "high amount of load on the platform because of their storefront traffic iic and from there getting the diffs from",
    "start": "2214280",
    "end": "2219880"
  },
  {
    "text": "them to fix them eventually but there are two ways of of seeing this so it's",
    "start": "2219880",
    "end": "2225560"
  },
  {
    "text": "either breath first or depth first so to analyze the actual diffs that we see in terms of parity we upload that to cloud",
    "start": "2225560",
    "end": "2232440"
  },
  {
    "text": "storage where all the diffs are kind of aggregated and later on we can figure out how those are um and then the other",
    "start": "2232440",
    "end": "2239119"
  },
  {
    "text": "side of this is that we keep track of where the diffs happen in terms of is it shop x y z uh is it endpoint ABC and",
    "start": "2239119",
    "end": "2247680"
  },
  {
    "text": "based on that we can run through our logging uh pipeline to see where do most of the issues happen is it on that shop",
    "start": "2247680",
    "end": "2254800"
  },
  {
    "text": "isn't on that endpoint and that gives us an idea of what we should try to tackle uh at first so on Splunk we have so many",
    "start": "2254800",
    "end": "2261240"
  },
  {
    "text": "dashboards that are just trying to figure out uh you should look at this first because this is where most of the",
    "start": "2261240",
    "end": "2267480"
  },
  {
    "text": "issues are happening data dog is also giving us a bunch of information in terms of where we should focus on First",
    "start": "2267480",
    "end": "2273640"
  },
  {
    "text": "and later on what's happening is that on the developer side of things we have tooling locally to be able to kind of",
    "start": "2273640",
    "end": "2280319"
  },
  {
    "text": "Cal through the diffs that we have stored on the cloud storage part of it and read through what are the most",
    "start": "2280319",
    "end": "2286240"
  },
  {
    "text": "frequent ones I don't know what I would have done here honestly it's it seems as you describe it quite overwhelming as",
    "start": "2286240",
    "end": "2292800"
  },
  {
    "text": "you mentioned I might have gone down both roads and tested both sides of the water and sort of drawn some consensus",
    "start": "2292800",
    "end": "2299440"
  },
  {
    "text": "from the team to see okay which direction do we feel is better bread or depth and I think I might have done a",
    "start": "2299440",
    "end": "2305119"
  },
  {
    "text": "little bit of both to get a sampling of each Direction but it seems like just",
    "start": "2305119",
    "end": "2310280"
  },
  {
    "text": "daunting millions of merchants you know unlimited amounts of traffic tons to dig through and anomalies everywhere so I",
    "start": "2310280",
    "end": "2318520"
  },
  {
    "text": "have extreme empathy for you it seems like a daunting task I would send there's a team right so yeah it's not",
    "start": "2318520",
    "end": "2324200"
  },
  {
    "text": "just me of course we're a team of uh of course yeah I mean the proverbial you meaning like you many so then you like",
    "start": "2324200",
    "end": "2330079"
  },
  {
    "text": "divide and conquer right so like you said one team depth and one team breadth and then you meet in the middle that's",
    "start": "2330079",
    "end": "2335880"
  },
  {
    "text": "like when you're interesting yeah that's something we did try uh to do so some people were focusing on a single shop",
    "start": "2335880",
    "end": "2341720"
  },
  {
    "text": "While others were trying to cover as many shops as possible and I think what eventually happened is you know when you",
    "start": "2341720",
    "end": "2348000"
  },
  {
    "text": "look at things you have to do everything at some point anyway so right you're going to have to go through both paths",
    "start": "2348000",
    "end": "2354520"
  },
  {
    "text": "kind of as a balance try to do both at the same at the same time and eventually you'll reach a critical mass of",
    "start": "2354520",
    "end": "2360680"
  },
  {
    "text": "supported requests from where you can kind of move on to go into the more specialized things for for death so this",
    "start": "2360680",
    "end": "2366760"
  },
  {
    "text": "is my kind of Problem by the way I'm a completionist I love this kind of problem here's a big goal right we we",
    "start": "2366760",
    "end": "2372640"
  },
  {
    "text": "know what the end looks like it's called 100% we're not there yet we know we're at 32% or whatever your numbers",
    "start": "2372640",
    "end": "2379000"
  },
  {
    "text": "indicate and we have a clear path to getting there what do you do well you check the next diff and then you fix",
    "start": "2379000",
    "end": "2384280"
  },
  {
    "text": "that problem and then you oh now we're at 30 okay and you try to find the ones where you can like in Implement a module",
    "start": "2384280",
    "end": "2390720"
  },
  {
    "text": "and like chop off a whole leg you know you're like oh look at that that module just solved these 15 problems and you're",
    "start": "2390720",
    "end": "2398160"
  },
  {
    "text": "just on your way to the end this is like a good video game where you're like I'm trying to find like I got my main quest",
    "start": "2398160",
    "end": "2403440"
  },
  {
    "text": "and my side quests I've got to get them all so let's just start hacking away and",
    "start": "2403440",
    "end": "2408800"
  },
  {
    "text": "making some progress I would I would enjoy this I I'm sure it gets you get down in the Mucky muck and you're like oh these new lines are killing me you",
    "start": "2408800",
    "end": "2415880"
  },
  {
    "text": "know yeah Prett much yeah but still I'm sure there are those huge wins where you just slice off one big chunk and you see",
    "start": "2415880",
    "end": "2422240"
  },
  {
    "text": "all these different stores go to parody it has to be pretty cool that's super interesting you say that so the the",
    "start": "2422240",
    "end": "2427800"
  },
  {
    "text": "percentage based thing uh we do have that we have a dashboard that says this is the current support we have uh we're",
    "start": "2427800",
    "end": "2433440"
  },
  {
    "text": "going towards 100% And one of the funnier moments during this project",
    "start": "2433440",
    "end": "2438480"
  },
  {
    "text": "where at the very beginning it was easier I think than it is now because we're running into this uh we're seeing",
    "start": "2438480",
    "end": "2445480"
  },
  {
    "text": "diminishing returns now because it's more etge cases and we're trying to fix all the tiny small things that are left to be fixed um but in the very beginning",
    "start": "2445480",
    "end": "2452520"
  },
  {
    "text": "of the project every single PR could potentially unlock so many more shops and so many more endpoints so on every",
    "start": "2452520",
    "end": "2459599"
  },
  {
    "text": "deploy we kind of look at that percentage U metric and say how much is my PR going to do there is it going to",
    "start": "2459599",
    "end": "2466240"
  },
  {
    "text": "bump by .5% is it going to be 1% like 2% that would be amazing so that kind of",
    "start": "2466240",
    "end": "2471960"
  },
  {
    "text": "game uh gamification of the thing also made it fun yeah and uh helped us run",
    "start": "2471960",
    "end": "2477160"
  },
  {
    "text": "towards 100% so two questions about monolith in the meantime the first one",
    "start": "2477160",
    "end": "2482440"
  },
  {
    "text": "is maybe I guess they are related so was monolith a moving Target or is it pretty static in its output",
    "start": "2482440",
    "end": "2489119"
  },
  {
    "text": "like as you build it cuz this takes a couple years were there changes going into the monolith storefront so you had",
    "start": "2489119",
    "end": "2494440"
  },
  {
    "text": "a play catch up we did and so play catch up for different things right so you",
    "start": "2494440",
    "end": "2499960"
  },
  {
    "text": "have to play catch up with internal changes in terms of other developers working on the monolith and us trying to",
    "start": "2499960",
    "end": "2505160"
  },
  {
    "text": "catch up with that there's also catching up in terms of what merchants do so if Merchants start using a given feature",
    "start": "2505160",
    "end": "2511680"
  },
  {
    "text": "that we just we just do not support in the new application yet then that's another source of potential catching up",
    "start": "2511680",
    "end": "2518400"
  },
  {
    "text": "we have to do so you could go backward you can wake up in the morning you were at 33% now you're at 28% because",
    "start": "2518400",
    "end": "2524000"
  },
  {
    "text": "somebody used a new feature exactly that's happened multiple times where you",
    "start": "2524000",
    "end": "2529720"
  },
  {
    "text": "exactly that you go out in the evening you're like oh get nice we're at like 37% and then the next morning was something like 177% we didn't do",
    "start": "2529720",
    "end": "2536680"
  },
  {
    "text": "anything what happened right or you got a lunch and you're like we we left for lunch at 32% we came back at 20 what",
    "start": "2536680",
    "end": "2542920"
  },
  {
    "text": "what happened here that's demoralized exactly exactly so that's ort of thing was uh one of the harder parts of course",
    "start": "2542920",
    "end": "2548680"
  },
  {
    "text": "you have to deal with how do you get people to on board your new project to get them to help and support that new",
    "start": "2548680",
    "end": "2556000"
  },
  {
    "text": "project as well as you trying to get them to work on it so eventually we I",
    "start": "2556000",
    "end": "2561520"
  },
  {
    "text": "decided to make it kind of my quest to make it as easy as possible for others to start contributing to that project by",
    "start": "2561520",
    "end": "2568520"
  },
  {
    "text": "making the documentation amazing as welcoming as possible to reduce the friction and to basically get people to",
    "start": "2568520",
    "end": "2574359"
  },
  {
    "text": "say hey look it looks more exciting to work on that new thing than it is to work on what I'm currently doing so in",
    "start": "2574359",
    "end": "2581200"
  },
  {
    "text": "that approach uh people started eventually to come on to the project and on their own kind of contribute to the",
    "start": "2581200",
    "end": "2587760"
  },
  {
    "text": "new thing rather than only keep working on the uh the previous implementation so that's something that really helped I",
    "start": "2587760",
    "end": "2594599"
  },
  {
    "text": "think in terms of how we drew the line was if it's something that was already",
    "start": "2594599",
    "end": "2599680"
  },
  {
    "text": "in the monolith by the time we started the project that's something that we would have to take on ourselves the team",
    "start": "2599680",
    "end": "2604720"
  },
  {
    "text": "working on the the r if however it's something that's not in the month yet it's not anywhere it's a",
    "start": "2604720",
    "end": "2611200"
  },
  {
    "text": "new project then that team should be able to consider both projects because they know it exists they know they have",
    "start": "2611200",
    "end": "2616920"
  },
  {
    "text": "to build for the future and make it into the new application as well and that's how we kind of got that line drawn to",
    "start": "2616920",
    "end": "2623359"
  },
  {
    "text": "say who's handling what and eventually we kind of reached a a point in the",
    "start": "2623359",
    "end": "2629839"
  },
  {
    "text": "project where most people were also writing that code in the new application so like they knew they had to do do it",
    "start": "2629839",
    "end": "2636280"
  },
  {
    "text": "to be future proof mhm so my second question about the monolith is because you were going for parody did you ever",
    "start": "2636280",
    "end": "2641680"
  },
  {
    "text": "have to reimplement bugs or suboptimal aspects of the monolith because you had to have the exact same output yes that",
    "start": "2641680",
    "end": "2649119"
  },
  {
    "text": "also sucks it's like this is my brand new thing I had to put the bad stuff in the new thing yeah well so it's a it's a",
    "start": "2649119",
    "end": "2655440"
  },
  {
    "text": "bad thing I guess for us as developers in terms of uh doesn't feel good yeah demoralizing but in terms of how a buyer",
    "start": "2655440",
    "end": "2661920"
  },
  {
    "text": "or a merchant would see it people using Shopify to them that's good so one of the goals we have is to basically make",
    "start": "2661920",
    "end": "2668520"
  },
  {
    "text": "it so that for stor fund uh specifically for online store if you have a theme archive that you have from 8 years ago",
    "start": "2668520",
    "end": "2675440"
  },
  {
    "text": "for example and you try to upload that today it should work the same way it did 8 years ago we try to be as backwards",
    "start": "2675440",
    "end": "2682200"
  },
  {
    "text": "compatible as possible so of course if there's something that was introduced 8 years ago we have to make sure that's",
    "start": "2682200",
    "end": "2688319"
  },
  {
    "text": "still there and the other thing is liquid the gem that we use for and that we built and we use for storefront",
    "start": "2688319",
    "end": "2694960"
  },
  {
    "text": "templates is almost incomplete so the possibilities of what liquid can do is",
    "start": "2694960",
    "end": "2701720"
  },
  {
    "text": "almost infinite so there's features that we shipped at some point that kind of",
    "start": "2701720",
    "end": "2708200"
  },
  {
    "text": "became used in ways that we did not expect and that we did not really think",
    "start": "2708200",
    "end": "2713319"
  },
  {
    "text": "about that we still have to support today even though that's not what we want it to be used for uh we have to",
    "start": "2713319",
    "end": "2719359"
  },
  {
    "text": "keep it this way so of course we had to Port some bugs uh that unfortunately are",
    "start": "2719359",
    "end": "2724800"
  },
  {
    "text": "kind of it doesn't feel good but for the people using that it's a I think a service to them to say look your thing",
    "start": "2724800",
    "end": "2731880"
  },
  {
    "text": "you had from a few years ago still works today and there's no breaking change in",
    "start": "2731880",
    "end": "2737200"
  },
  {
    "text": "there what's up friends when was the last time you considered how much time your team is spending building and me",
    "start": "2749680",
    "end": "2755880"
  },
  {
    "text": "maintaining internal tooling and I bet if you looked at the way your team spends its time you're probably building and maintaining those tools way more",
    "start": "2755880",
    "end": "2762599"
  },
  {
    "text": "often than you thought and you probably shouldn't have to do that I mean there is such a thing as retool have you heard",
    "start": "2762599",
    "end": "2768480"
  },
  {
    "text": "about retool yet well companies like door Dash BRX plaid and even Amazon they",
    "start": "2768480",
    "end": "2774000"
  },
  {
    "text": "use retool to build internal tools super fast and the idea is that almost all",
    "start": "2774000",
    "end": "2780200"
  },
  {
    "text": "internal tools look the same they're made up of tables drop downs buttons text inputs SE sech and all this is very",
    "start": "2780200",
    "end": "2787440"
  },
  {
    "text": "similar and retool gives you a point click drag and drop interface that makes",
    "start": "2787440",
    "end": "2792880"
  },
  {
    "text": "it super simple to build internal uis like that in hours not days so stop",
    "start": "2792880",
    "end": "2798960"
  },
  {
    "text": "wasting your time and use retool check them out at ret.com changelog again ret.com",
    "start": "2798960",
    "end": "2807680"
  },
  {
    "text": "[Music]",
    "start": "2808370",
    "end": "2814800"
  },
  {
    "text": "changelog [Music]",
    "start": "2814800",
    "end": "2829240"
  },
  {
    "text": "so max over the process of the rewrite you have this verifier in place it's getting some traffic to it via the",
    "start": "2829240",
    "end": "2836520"
  },
  {
    "text": "engine X routing module but this is for your learning right so it's still going to the main monolith it's also going to",
    "start": "2836520",
    "end": "2842760"
  },
  {
    "text": "the verifier running your code doing the diffs at a certain point I assume since",
    "start": "2842760",
    "end": "2848359"
  },
  {
    "text": "the blog post is out there and you know we got Black Friday coming up you are confident enough you have a high enough",
    "start": "2848359",
    "end": "2854079"
  },
  {
    "text": "percentage on a high enough number of stores or themes that you say we're going to start rolling this thing out",
    "start": "2854079",
    "end": "2861240"
  },
  {
    "text": "tell us how I think the routing module played a a role here you kind of automated this process tell us about",
    "start": "2861240",
    "end": "2866400"
  },
  {
    "text": "that because I think it's pretty neat yeah so along with the process of verifying traffic we wanted to start",
    "start": "2866400",
    "end": "2872960"
  },
  {
    "text": "rendering that traffic in for real real people out there buying stuff uh to",
    "start": "2872960",
    "end": "2878559"
  },
  {
    "text": "serve that traffic using the new implementation and we simply leveraged the existing verifier mechanism to say",
    "start": "2878559",
    "end": "2886240"
  },
  {
    "text": "if you have a certain amount of requests that have been equivalent and that's",
    "start": "2886240",
    "end": "2892079"
  },
  {
    "text": "happened in a given time frame then consider that endpoint for that specific shop to be uh eligible to be rendered by",
    "start": "2892079",
    "end": "2900760"
  },
  {
    "text": "the new implementation so that was all kept tracked as a very it's very much a",
    "start": "2900760",
    "end": "2906000"
  },
  {
    "text": "stateful thing a stateful system to keep track of what those requests are should they be considered and if they are start",
    "start": "2906000",
    "end": "2913319"
  },
  {
    "text": "rendering so all of that was being kept track in the verifier mechanism again in enginex um storing that on a key value",
    "start": "2913319",
    "end": "2921440"
  },
  {
    "text": "store to just keep track of how many requests we're getting whether they're the same or they're not and we have this",
    "start": "2921440",
    "end": "2928000"
  },
  {
    "text": "whole routing mechanism that we control to say okay assuming that we have that",
    "start": "2928000",
    "end": "2933599"
  },
  {
    "text": "amount of traffic and that amount of time that is equivalent to the Baseline reference implementation then the uh the",
    "start": "2933599",
    "end": "2940599"
  },
  {
    "text": "routing module would start to send traffic to the new implementation instead from there came the need to do",
    "start": "2940599",
    "end": "2946559"
  },
  {
    "text": "some uh verifications as well against the monolith this time so because we now start the route traffic to the new",
    "start": "2946559",
    "end": "2952760"
  },
  {
    "text": "implementation you also want to make sure that what you're doing is still valid so you're just not you're not just",
    "start": "2952760",
    "end": "2958480"
  },
  {
    "text": "sending traffic to the other place and saying okay we're done we're just moving on to the other thing you want to keep making sure that what you're doing is",
    "start": "2958480",
    "end": "2965240"
  },
  {
    "text": "still valid so we keep verifying traffic kind of reverse verification where",
    "start": "2965240",
    "end": "2970880"
  },
  {
    "text": "you're doing the verification usually from uh the monolith to the other one now you're doing the the opposite",
    "start": "2970880",
    "end": "2976440"
  },
  {
    "text": "because you're serving traffic from the other application and that kind of",
    "start": "2976440",
    "end": "2981559"
  },
  {
    "text": "started out as a few shops that we wanted to take care of because those were the main winners from what the new",
    "start": "2981559",
    "end": "2988160"
  },
  {
    "text": "application was doing in terms of impact on performance and resilience and everything and once we started to gain",
    "start": "2988160",
    "end": "2995160"
  },
  {
    "text": "confidence I think that's when we kind of opened up the like we pressed on the throttle and just moved it up to a lot",
    "start": "2995160",
    "end": "3001079"
  },
  {
    "text": "more shops to say okay that mechanism Works we're seeing that it scales we're comfortable with opening it up to more",
    "start": "3001079",
    "end": "3007640"
  },
  {
    "text": "merchants and that's where we kind of reached the critical mass of serving the",
    "start": "3007640",
    "end": "3012760"
  },
  {
    "text": "the traffic for more merchants on that new implementation so it's shop by shop it is shop by shop also split up by",
    "start": "3012760",
    "end": "3020559"
  },
  {
    "text": "endpoint itself so for a single shop we're not necessarily rendering the entire shop with the new implementation we maybe rendering half of that",
    "start": "3020559",
    "end": "3027400"
  },
  {
    "text": "storefronts uh end points with the new one and still the other half with the old one that should not change anything",
    "start": "3027400",
    "end": "3033240"
  },
  {
    "text": "for the people browsing that storefront to them it's really the same thing or just maybe a bit faster depending on",
    "start": "3033240",
    "end": "3039200"
  },
  {
    "text": "what endpoint they're on how long do you keep that up in terms of this reverse parody because kind of",
    "start": "3039200",
    "end": "3046160"
  },
  {
    "text": "going back to the last segment when you mentioned you're enticing people to write new features in you know monolith",
    "start": "3046160",
    "end": "3053680"
  },
  {
    "text": "and new application and I suppose to kind of keep this reverse parody at some point you got to keep the the same I",
    "start": "3053680",
    "end": "3061000"
  },
  {
    "text": "guess features in both codebases so do you sort of like reverse the idea of like okay we're going to build a new but",
    "start": "3061000",
    "end": "3067040"
  },
  {
    "text": "also going to build an old too for a certain period to kind of keep that is that what you've done or that is did that force you to do that to kind of",
    "start": "3067040",
    "end": "3072760"
  },
  {
    "text": "keep that overlap in terms of parody over time pretty much and that's I think",
    "start": "3072760",
    "end": "3078880"
  },
  {
    "text": "one of the main challenges in terms of if I'm a developer at Shopify that has to ship something for a specific period",
    "start": "3078880",
    "end": "3084200"
  },
  {
    "text": "of time you had to write thing in both applications which is not ideal there's additional work pressure added onto this",
    "start": "3084200",
    "end": "3090839"
  },
  {
    "text": "and the goal was to make that period as short as possible so now our focus is really on removing the old code from the",
    "start": "3090839",
    "end": "3098200"
  },
  {
    "text": "monolith to say okay well there's only one canonical source of Truth now that's a new implementation this is where the",
    "start": "3098200",
    "end": "3103400"
  },
  {
    "text": "code should be going and uh reducing that period of time where there's two implementations going on how long will",
    "start": "3103400",
    "end": "3109960"
  },
  {
    "text": "that be then do you think what's your anticipation for that overlap it's been interesting because of the way we kind",
    "start": "3109960",
    "end": "3116720"
  },
  {
    "text": "of advertised the project internally there was a bit of time where it was more considered as a an experiment and",
    "start": "3116720",
    "end": "3123520"
  },
  {
    "text": "we didn't really want to go and Shout off roof offs to say hey there's this new thing it was more of a thing where we're kind of internally experimenting",
    "start": "3123520",
    "end": "3130319"
  },
  {
    "text": "with something seeing if it works and there was a point eventually we realized okay this is going to be the future of",
    "start": "3130319",
    "end": "3136200"
  },
  {
    "text": "storefront at Shopify internally and this is how we should be doing things from that moment on is when we kind of",
    "start": "3136200",
    "end": "3141839"
  },
  {
    "text": "wanted to get people to be aware that they should be writing their uh their features with that new",
    "start": "3141839",
    "end": "3147960"
  },
  {
    "text": "implementation in mind to think of how they would build it based on the fact that we now have this new thing it's not",
    "start": "3147960",
    "end": "3153920"
  },
  {
    "text": "the old one anymore you may still write the thing in the older one if you need it to be available for the previous implementation but in terms of making",
    "start": "3153920",
    "end": "3161400"
  },
  {
    "text": "sure that people don't have to write that code twice of course they have to for a certain period of time it's not",
    "start": "3161400",
    "end": "3167680"
  },
  {
    "text": "great and uh we wanted to make that as short as possible but that's something that uh did happen for for a while and",
    "start": "3167680",
    "end": "3174880"
  },
  {
    "text": "still happens for certain parts of the the store fund based on what we do support and what we don't at the moment",
    "start": "3174880",
    "end": "3181040"
  },
  {
    "text": "this is a trade-off really I mean anytime you do a rewrite you have to ask yourself what am I willing to sacrifice",
    "start": "3181040",
    "end": "3187280"
  },
  {
    "text": "to do this rewrite should I do it at all which is kind of the bigger picture we haven't really asked you that I mean to some degree it's in the it's in between",
    "start": "3187280",
    "end": "3193559"
  },
  {
    "text": "all the lines we're drawing here but this is a trade-off like having to do that is a trade-off of you know",
    "start": "3193559",
    "end": "3199880"
  },
  {
    "text": "something that's worth pouring into in the future so to me it's like well it's",
    "start": "3199880",
    "end": "3205480"
  },
  {
    "text": "it's not ideal but in order to rewrite in a smart way all the steps you've",
    "start": "3205480",
    "end": "3210960"
  },
  {
    "text": "talked about the verification service the diffing all the work the double implementation for a time period the",
    "start": "3210960",
    "end": "3216280"
  },
  {
    "text": "overlap and the continue reverse verification like to me that's like necessary maybe in particular with your",
    "start": "3216280",
    "end": "3223839"
  },
  {
    "text": "style of application you know in terms of your customer base your all the you",
    "start": "3223839",
    "end": "3229079"
  },
  {
    "text": "know routing you have to do just generally but like that's a necessary trade-off that you have to do when you",
    "start": "3229079",
    "end": "3234319"
  },
  {
    "text": "say okay we have to solve this problem for the future and unfortunately this",
    "start": "3234319",
    "end": "3239599"
  },
  {
    "text": "you know lab experiment gone right is the future so we have to do it this way in order to rewrite this thing like to",
    "start": "3239599",
    "end": "3246119"
  },
  {
    "text": "me that's just a a necessary trade-off it's like a tiny bit of pain now that is going to be so much better later on so",
    "start": "3246119",
    "end": "3253079"
  },
  {
    "text": "why not do it now you know ripping off the Band-Aid and just dealing with it now of course it's a bit painful but there's going to be so many benefits",
    "start": "3253079",
    "end": "3258920"
  },
  {
    "text": "from this so let's not think about it too much for now so are you beyond the pain or are you still in the pain in terms of the double implementation",
    "start": "3258920",
    "end": "3265720"
  },
  {
    "text": "your your fellow devs we're Way Beyond the pain so monolith doesn't get any new features it does in rare cases in very",
    "start": "3265720",
    "end": "3273680"
  },
  {
    "text": "very rare cases and again I said earlier about how the storefront implementation",
    "start": "3273680",
    "end": "3279200"
  },
  {
    "text": "we're doing now is mostly a read read application um the rest of the features",
    "start": "3279200",
    "end": "3284640"
  },
  {
    "text": "would be mostly for everything that updates or writes that may still be going in the monolith for now and with",
    "start": "3284640",
    "end": "3290960"
  },
  {
    "text": "time we may be thinking about doing something where rights would also go to the new impementation not clear yet if",
    "start": "3290960",
    "end": "3296839"
  },
  {
    "text": "that's something we want to do but uh at the moment we're really focusing on getting those reads served by the new",
    "start": "3296839",
    "end": "3303839"
  },
  {
    "text": "implementation so here you are youve ripped out the Band-Aid you're at the end of this process you've made the",
    "start": "3303839",
    "end": "3310280"
  },
  {
    "text": "necessary tradeoffs was it all worth it would you do it again what are the wins what uh",
    "start": "3310280",
    "end": "3316680"
  },
  {
    "text": "what are the takeaways from Shopify and your team right so I think one of the",
    "start": "3316680",
    "end": "3322440"
  },
  {
    "text": "main things I keep in mind in this is I've read so many articles and blog",
    "start": "3322440",
    "end": "3327599"
  },
  {
    "text": "posts and opinions everywhere on the internet over the years that say don't do rewrites that's like the main",
    "start": "3327599",
    "end": "3334079"
  },
  {
    "text": "takeaway to to remember for all of those articles and I want to be the person who does the opposite and says rewrites are",
    "start": "3334079",
    "end": "3340760"
  },
  {
    "text": "possible you can do rewrites if you do them right and how do you do them right there's many key things involved in",
    "start": "3340760",
    "end": "3347760"
  },
  {
    "text": "there but it's not a thing where you have to kind of push the Rite option aside if it's something that you don't",
    "start": "3347760",
    "end": "3353680"
  },
  {
    "text": "think is possible the main main thing of course I think is communicating early and often with the people that are involved into that process so getting",
    "start": "3353680",
    "end": "3361480"
  },
  {
    "text": "the the right so of course in in the example of Shopify developers um it's",
    "start": "3361480",
    "end": "3366799"
  },
  {
    "text": "getting them aware that there's going to be this new application that's coming out that you have to think about in",
    "start": "3366799",
    "end": "3372039"
  },
  {
    "text": "terms of when your features and your road maps and everything have to be aware of that new application and one",
    "start": "3372039",
    "end": "3378480"
  },
  {
    "text": "mistake I did myself was trying to send an email at some point to say hey this is the new implementation of House St",
    "start": "3378480",
    "end": "3384680"
  },
  {
    "text": "front work one email is not going to cut it like you have to be frequently getting into in touch with people and",
    "start": "3384680",
    "end": "3391400"
  },
  {
    "text": "making sure that they're aware and eventually the word kind of gets on people get excited about the thing and that's when you kind of get this",
    "start": "3391400",
    "end": "3398440"
  },
  {
    "text": "excitement going on for that new implementation and along with making sure that you have the most frictionless",
    "start": "3398440",
    "end": "3404640"
  },
  {
    "text": "process to work on that new thing when you get those two things combined that's where magic happens and people want to",
    "start": "3404640",
    "end": "3410480"
  },
  {
    "text": "work on the thing that people also realize that it's it's easier it's more fun to work on the new thing so it's it",
    "start": "3410480",
    "end": "3417000"
  },
  {
    "text": "becomes a self-realizing kind of Prophecy where you want it to happen but people kind of make it happen for you um",
    "start": "3417000",
    "end": "3423520"
  },
  {
    "text": "and that happens through communication I think so that's one thing of course in terms of how people using Shopify",
    "start": "3423520",
    "end": "3430920"
  },
  {
    "text": "benefit from this um we're seeing some great results in terms of performance on",
    "start": "3430920",
    "end": "3436000"
  },
  {
    "text": "average over all traffic coming up on the platform we're seeing around 3 to 5x",
    "start": "3436000",
    "end": "3442839"
  },
  {
    "text": "performance improvements for storefront respon times on cash misses so of course",
    "start": "3442839",
    "end": "3447960"
  },
  {
    "text": "we're focusing on cash misses because cash hits are almost always fast but whenever there is a cash Miss that's",
    "start": "3447960",
    "end": "3454280"
  },
  {
    "text": "what we want to optimize and make sure it's always fast so that was kind of the",
    "start": "3454280",
    "end": "3459799"
  },
  {
    "text": "first rule I guess of the project to say don't really think about caching because we want to First have very very fast",
    "start": "3459799",
    "end": "3466319"
  },
  {
    "text": "cash misses and only when we know that we have some very fast cash misses do we",
    "start": "3466319",
    "end": "3471599"
  },
  {
    "text": "want to start thinking about cashing on top of that so we kind of we don't want to cheat away the cash misses by saying",
    "start": "3471599",
    "end": "3477599"
  },
  {
    "text": "ah it's not a problem because we just add cashing onto there sure but what happens when you don't have a cash hit",
    "start": "3477599",
    "end": "3482960"
  },
  {
    "text": "that's when we want to be extra fast and in this case we're seeing some uh some good performance there in some cases",
    "start": "3482960",
    "end": "3488480"
  },
  {
    "text": "we're seeing some some store funds kind of surprised Us in terms of how they performed where we were seeing up to 10 times faster cash misses so that's",
    "start": "3488480",
    "end": "3496240"
  },
  {
    "text": "something we were very surprised to see in the early process um and we kind of knew that this was the right way to go",
    "start": "3496240",
    "end": "3502599"
  },
  {
    "text": "because we were seeing those good results if you got somebody listening to the show right now and they're thinking you know what Maxine's right I think we",
    "start": "3502599",
    "end": "3509760"
  },
  {
    "text": "could probably do a rewrite you've obviously made them believe in the potential if done right what are some of the steps you would take to do it right",
    "start": "3509760",
    "end": "3516400"
  },
  {
    "text": "we've talked about a lot of them but like if you can kind of distill it down to like three or five kind of core pieces of advice what might those be for",
    "start": "3516400",
    "end": "3524359"
  },
  {
    "text": "our listeners so I think one of them is to make sure you have the shortest",
    "start": "3524359",
    "end": "3531240"
  },
  {
    "text": "feedback loop possible when you kind of get off track so for example our verifier uh mechanism gets us there in a",
    "start": "3531240",
    "end": "3538240"
  },
  {
    "text": "way that if we Implement something that's not equivalent to the previous implementation we're aware of it really",
    "start": "3538240",
    "end": "3544160"
  },
  {
    "text": "quickly in terms of minutes when we deploy we know okay we shipped something that's different let's look into it",
    "start": "3544160",
    "end": "3549520"
  },
  {
    "text": "figure out what's going on and then move on to the next thing so that's number one the second one would be to start",
    "start": "3549520",
    "end": "3556760"
  },
  {
    "text": "with a tiny scope just scope it down to a small thing that kind of validates the",
    "start": "3556760",
    "end": "3562200"
  },
  {
    "text": "approach to say is this something we even want to go down uh is is this a road we even want to go down uh towards",
    "start": "3562200",
    "end": "3568880"
  },
  {
    "text": "or is it not something that's realistic so if it is something that's realistic having that smaller scope will get you",
    "start": "3568880",
    "end": "3575400"
  },
  {
    "text": "to a point where you know okay this seems to make sense so far I don't see why it wouldn't be uh okay as well for",
    "start": "3575400",
    "end": "3581200"
  },
  {
    "text": "the rest of the project let's make it happen so that that is the second one I",
    "start": "3581200",
    "end": "3586760"
  },
  {
    "text": "think the third thing as it like I said communicating early and often but also making it easy and enjoyable to work on",
    "start": "3586760",
    "end": "3594880"
  },
  {
    "text": "the new thing like reducing friction the the bar to entry to work on the new thing is a critical thing to get",
    "start": "3594880",
    "end": "3601359"
  },
  {
    "text": "adoption internally for people that need to ship their features and their road",
    "start": "3601359",
    "end": "3607480"
  },
  {
    "text": "maps on the different applications if it's enjoyable for them to do it on the",
    "start": "3607480",
    "end": "3613160"
  },
  {
    "text": "new one they're going to do it you don't have to force them to do anything it's just going to happen by itself yeah if you're going to cause",
    "start": "3613160",
    "end": "3619039"
  },
  {
    "text": "them pain cause them the least amount of pain right exactly and kind trying to balance this out right so you",
    "start": "3619039",
    "end": "3625400"
  },
  {
    "text": "if you have to get people to write code in both applications at least make it enjoyable in the new one right or more",
    "start": "3625400",
    "end": "3631000"
  },
  {
    "text": "enjoyable than it would be in the previous one what is maybe distill that one a bit more is that you mentioned",
    "start": "3631000",
    "end": "3636280"
  },
  {
    "text": "documentation being a critical piece for you what Beyond documentation helps that",
    "start": "3636280",
    "end": "3642240"
  },
  {
    "text": "I think the one thing I'd say is if you have a slack Channel a public slack Channel be the best customer service",
    "start": "3642240",
    "end": "3648079"
  },
  {
    "text": "person you can be if people arrive with questions be available help them they are the people that are eventually going",
    "start": "3648079",
    "end": "3654599"
  },
  {
    "text": "to make that a success or not you are kind of the the messenger to say hey we have the new this new thing we're trying",
    "start": "3654599",
    "end": "3660880"
  },
  {
    "text": "to build can you help us and if they are there and they receive the help that's",
    "start": "3660880",
    "end": "3666200"
  },
  {
    "text": "going to help tremendously to get everyone on board and because that person that receives the help is going",
    "start": "3666200",
    "end": "3671559"
  },
  {
    "text": "to talk to the project to their own team and the team will eventually get to that point where because someone under their",
    "start": "3671559",
    "end": "3678359"
  },
  {
    "text": "team is familiar with it they kind of become that expert on the team and the word spreads so helping people creating",
    "start": "3678359",
    "end": "3684280"
  },
  {
    "text": "these sign this kind of expert Network within the company that are aware of your app and are they're excited about",
    "start": "3684280",
    "end": "3690520"
  },
  {
    "text": "it kind of share the word for you so helping people I think would be the the best thing and being a good customer",
    "start": "3690520",
    "end": "3696520"
  },
  {
    "text": "service person to just get them closer to what they need to achieve one reason that a big rewrite is scary is because",
    "start": "3696520",
    "end": "3705119"
  },
  {
    "text": "it's difficult or even impossible to bound or bind your risk right it's",
    "start": "3705119",
    "end": "3710200"
  },
  {
    "text": "Unbound risk and there are steps you can take to",
    "start": "3710200",
    "end": "3715240"
  },
  {
    "text": "fix that you guys had very clear goals I think that was one of the reasons you succeeded and you had a way of measuring",
    "start": "3715240",
    "end": "3721200"
  },
  {
    "text": "that as you went so like that's clear and awesome were there any failure",
    "start": "3721200",
    "end": "3726640"
  },
  {
    "text": "mechanisms like kill switch we're not going to make it this is not because you",
    "start": "3726640",
    "end": "3732160"
  },
  {
    "text": "you said it was an experiment but the other thing is you can say is like well what would failure look like obviously you succeeded but did you have failure",
    "start": "3732160",
    "end": "3739119"
  },
  {
    "text": "thresholds where it's like you know what we're going to abandon this and go back to the monolith because or try something totally else new or were those things",
    "start": "3739119",
    "end": "3746559"
  },
  {
    "text": "not thought about no definitely were they definitely were um internally we call those trip wires So eventually you",
    "start": "3746559",
    "end": "3753720"
  },
  {
    "text": "get to a point where you have to figure those out if you don't you'll just keep going and you're going to get yourself",
    "start": "3753720",
    "end": "3759799"
  },
  {
    "text": "deeper and deeper into the problem so figuring out what those trip wires are at what point do you you're comfortable",
    "start": "3759799",
    "end": "3767440"
  },
  {
    "text": "with those trip wires and saying okay we're we're just getting too deep now and now we have to cut back and and go to something else that's something we",
    "start": "3767440",
    "end": "3772960"
  },
  {
    "text": "did so for example some of them we talked a bit about um you know how we get some catching up to do with internal",
    "start": "3772960",
    "end": "3780000"
  },
  {
    "text": "uh changes that's what it requires if we're not able to catch up in time with whatever is being happening in the",
    "start": "3780000",
    "end": "3786240"
  },
  {
    "text": "whatever is being changed in the internal uh monolith that's something we have to be what to be careful with if",
    "start": "3786240",
    "end": "3792760"
  },
  {
    "text": "it's something about we're by rolling out the application for example in production if we're causing some uh",
    "start": "3792760",
    "end": "3800559"
  },
  {
    "text": "incidents in production that's a trip wire because if the monolith is not doing that and we are then potentially",
    "start": "3800559",
    "end": "3805799"
  },
  {
    "text": "we're not ready to go in production and we have to be careful over that so there's multiple trip wires we set to",
    "start": "3805799",
    "end": "3811000"
  },
  {
    "text": "make sure that this did not happen and thankfully we didn't hit those we didn't hit them too often to to say okay it's a",
    "start": "3811000",
    "end": "3817920"
  },
  {
    "text": "problem we we should look into and maybe reconsider the entire approach so uh in this case figuring out those trip wires",
    "start": "3817920",
    "end": "3824760"
  },
  {
    "text": "way before you get into a point where you want to roll out is critical to make sure you're doing the right thing yeah I",
    "start": "3824760",
    "end": "3831720"
  },
  {
    "text": "like the word trip wire mhm that's a very very good concise word for exactly what it means in this case is there",
    "start": "3831720",
    "end": "3839400"
  },
  {
    "text": "anything else we haven't asked you that you're like man I really I want to talk about this before we tail out we're at",
    "start": "3839400",
    "end": "3844880"
  },
  {
    "text": "that point so what else you got one experience that was uh quite interesting uh to me personally was when we started",
    "start": "3844880",
    "end": "3852400"
  },
  {
    "text": "the project we were around five people four or five people and that's in the",
    "start": "3852400",
    "end": "3858079"
  },
  {
    "text": "first few months we start to get progress we eventually realized that we're getting closer to rendering certain pages for certain merchants and",
    "start": "3858079",
    "end": "3864480"
  },
  {
    "text": "that's only internally we're not not in production yet and at some point we get a request to Showcase it to everyone all",
    "start": "3864480",
    "end": "3871839"
  },
  {
    "text": "developers and everyone at Shopify internally during our uh Friday Town Hall uh meeting so everyone's kind of",
    "start": "3871839",
    "end": "3878039"
  },
  {
    "text": "watching this we're kind of sharing context and everything and this is streamed to all employees at Shopify so",
    "start": "3878039",
    "end": "3885240"
  },
  {
    "text": "the one thing we did was to have a simple web page that shows you the same",
    "start": "3885240",
    "end": "3890839"
  },
  {
    "text": "page being rendered by the monolith and then by the new implementation we're doing so side by side two ey frames just",
    "start": "3890839",
    "end": "3898200"
  },
  {
    "text": "requesting the same uh page and seeing which one's faster and when that thing",
    "start": "3898200",
    "end": "3904200"
  },
  {
    "text": "ran and uh during the live stream when we showed it up the new implementation was way faster than the new one and I",
    "start": "3904200",
    "end": "3909680"
  },
  {
    "text": "think that's when I kind of it clicked into my head in in many people's heads okay this is the right path forward",
    "start": "3909680",
    "end": "3915760"
  },
  {
    "text": "they're doing the right work and we have to continue doing this thing so from that moment on I think there was kind of",
    "start": "3915760",
    "end": "3921559"
  },
  {
    "text": "a it was kind of a turning point in the head of of developers working on this to say this is the thing we're now focusing",
    "start": "3921559",
    "end": "3928119"
  },
  {
    "text": "on in terms of of the future to make sure this happens that's awesome I can imagine that feeling because you weren't",
    "start": "3928119",
    "end": "3934599"
  },
  {
    "text": "expecting that uh that call like hey can you demo this to everybody yeah it we",
    "start": "3934599",
    "end": "3940279"
  },
  {
    "text": "weren't you're like about to throw up were you antsy we're like so like of course we had tried it before a few",
    "start": "3940279",
    "end": "3946279"
  },
  {
    "text": "times to make sure it was okay but seeing the real thing in like the live demo of clicking the button and both",
    "start": "3946279",
    "end": "3952880"
  },
  {
    "text": "Pages come up seeing the new implementation coming up way faster it was like okay good we're we're in a good",
    "start": "3952880",
    "end": "3960799"
  },
  {
    "text": "place we're going to be fine and we can keep working on the next uh yeah end points to make sure that we're doing",
    "start": "3960799",
    "end": "3966599"
  },
  {
    "text": "this for for everyone on Shopify that's a cool story I'm glad you share that and uh congratulations to you and the rest",
    "start": "3966599",
    "end": "3973720"
  },
  {
    "text": "of the team making this happen I mean I know this has been a multi-year road uh with many facets opportunities for trip",
    "start": "3973720",
    "end": "3981559"
  },
  {
    "text": "wires obviously we hit success which is great you're at plus 90% parody right now you",
    "start": "3981559",
    "end": "3987559"
  },
  {
    "text": "know on your way to still to 100 right is that is that still the case based on your blog post or is that are you closer to 100 now we're getting towards a 100",
    "start": "3987559",
    "end": "3995520"
  },
  {
    "text": "um exact numbers vary by the day again because we're catching up with certain things and there's external",
    "start": "3995520",
    "end": "4000760"
  },
  {
    "text": "circumstances but we're getting very very close to 100% uh the majority of traffic is being served by that uh new",
    "start": "4000760",
    "end": "4006520"
  },
  {
    "text": "implementation now so um it's really a matter of fixing the last few diffs and",
    "start": "4006520",
    "end": "4011960"
  },
  {
    "text": "figuring out you know how can we get to that place uh faster of course you have",
    "start": "4011960",
    "end": "4017279"
  },
  {
    "text": "like you said um earlier Jared it's really it's a game where you have to pick up the issues one by one and just",
    "start": "4017279",
    "end": "4023440"
  },
  {
    "text": "fix them until you get to a point where everything is fine but uh but yeah massive team effort to to get there a",
    "start": "4023440",
    "end": "4030200"
  },
  {
    "text": "lot of infrastructure work a lot of parody diff fixing issues a lot of",
    "start": "4030200",
    "end": "4035279"
  },
  {
    "text": "external Communications as well with the merchants like it's a it's a Shopify wide uh initiative and seeing the thing",
    "start": "4035279",
    "end": "4043119"
  },
  {
    "text": "take off and work is super uh rewarding in the end well we've appreciated this",
    "start": "4043119",
    "end": "4048200"
  },
  {
    "text": "conversation and thank you so much for sharing this story with our with Jared and I and and the rest of the audience here on change thanks so much for uh for",
    "start": "4048200",
    "end": "4055200"
  },
  {
    "text": "everything it was very fun thank [Music] you that's it for this episode of the change law thank you for tuning in if",
    "start": "4055200",
    "end": "4061799"
  },
  {
    "text": "you haven't heard yet we have launched change law Plus+ it is our membership program that lets you get closer to the",
    "start": "4061799",
    "end": "4068359"
  },
  {
    "text": "metal remove the ads make them disappear as we say and enjoy supporting us it's",
    "start": "4068359",
    "end": "4073920"
  },
  {
    "text": "is the best way to directly support this show and our other podcasts here on Chang law.com and if you've never been",
    "start": "4073920",
    "end": "4079839"
  },
  {
    "text": "to changel law.com you should go there now again join Chang law Plus+ to directly support our work and make the",
    "start": "4079839",
    "end": "4086640"
  },
  {
    "text": "ads disappear check it out at changel law.com plusus plus of course huge thanks to our partners who get it fastly",
    "start": "4086640",
    "end": "4093640"
  },
  {
    "text": "Leno and rollbar also thanks to break master cylinder for making all of our beats and thank you to you for listening",
    "start": "4093640",
    "end": "4099960"
  },
  {
    "text": "we appreciate you that's it for this week we'll see you next week [Music]",
    "start": "4099960",
    "end": "4122709"
  },
  {
    "text": "[Music] [Applause]",
    "start": "4126729",
    "end": "4132798"
  },
  {
    "text": "he",
    "start": "4132799",
    "end": "4135798"
  },
  {
    "text": "sh",
    "start": "4142000",
    "end": "4145000"
  }
]