[
  {
    "text": "tor or the onion router is an incredible system that always fascinated me",
    "start": "80",
    "end": "8240"
  },
  {
    "text": "the architecture behind it and how the it is built",
    "start": "8240",
    "end": "13360"
  },
  {
    "text": "has always been fascinating and a little bit confusing to be honest",
    "start": "13360",
    "end": "18720"
  },
  {
    "text": "because it's a black box we hear a lot of people talk about tor",
    "start": "18720",
    "end": "24720"
  },
  {
    "text": "but i don't see material of people discussing the internals of",
    "start": "24720",
    "end": "32078"
  },
  {
    "text": "tor and how exactly it works the closest that i've seen",
    "start": "32079",
    "end": "37840"
  },
  {
    "text": "was dr mike pound from computer file and even that wasn't satisfactory enough for",
    "start": "37840",
    "end": "43600"
  },
  {
    "text": "me so i i've been for the past week i've been doing some research on tor",
    "start": "43600",
    "end": "49440"
  },
  {
    "text": "specifically the connection management the initial circuit creation and and i'd like to",
    "start": "49440",
    "end": "58559"
  },
  {
    "text": "spend a few moments to discuss that with you and just have a general discussion around that",
    "start": "58559",
    "end": "65280"
  },
  {
    "text": "portion just the connection establishment what really happens in details as as much",
    "start": "65280",
    "end": "72720"
  },
  {
    "text": "details as i actually essentially understand how about we jump into it guys welcome to the back in",
    "start": "72720",
    "end": "77920"
  },
  {
    "text": "engineering show with your host hussein nasser and today i have a bad hair day that's",
    "start": "77920",
    "end": "84799"
  },
  {
    "text": "why you'll see the hat if you're on a podcast you don't really care because you don't see me",
    "start": "84799",
    "end": "89840"
  },
  {
    "text": "but and and says freedom because tor",
    "start": "89840",
    "end": "95520"
  },
  {
    "text": "and uh so guys i made a video about tor and just like any other videos i make a",
    "start": "96240",
    "end": "103680"
  },
  {
    "text": "video in an year and a year later or a few months later i i see",
    "start": "103680",
    "end": "108720"
  },
  {
    "text": "who made this video what an idiot like you missed a lot of details you",
    "start": "108720",
    "end": "113920"
  },
  {
    "text": "said a lot of things that are just wrong or just miss you missed a lot of things right",
    "start": "113920",
    "end": "122240"
  },
  {
    "text": "and i'm pretty sure a lot of people have feel the same thing but i think it's a good video it gives",
    "start": "122240",
    "end": "127520"
  },
  {
    "text": "you the overview it's not detailed enough uh to my satisfaction but i think uh",
    "start": "127520",
    "end": "133120"
  },
  {
    "text": "people like it so i'm gonna reference it uh below in the description and in the podcast details",
    "start": "133120",
    "end": "138160"
  },
  {
    "text": "show notes so you can check it out but i want to dive into details of",
    "start": "138160",
    "end": "146640"
  },
  {
    "text": "the connection establishment of tor what really happens when you want",
    "start": "146640",
    "end": "153519"
  },
  {
    "text": "to go and we want to make it simple so that we can actually",
    "start": "153519",
    "end": "160640"
  },
  {
    "text": "just just follow the threads of what happens let's say",
    "start": "160640",
    "end": "167280"
  },
  {
    "text": "i want to go to an insecure site because having a secure side will just",
    "start": "167280",
    "end": "173599"
  },
  {
    "text": "complicating it's not really that hard but it just will complicate things and we just really want to explain",
    "start": "173599",
    "end": "179840"
  },
  {
    "text": "things in a simple manner let's go yesterday i want to go to a site that is http",
    "start": "179840",
    "end": "186480"
  },
  {
    "text": "colon slash example.com that's my goal and i want to use",
    "start": "186480",
    "end": "194720"
  },
  {
    "text": "the tor network and i have a tor client let's say that our browser",
    "start": "194720",
    "end": "202239"
  },
  {
    "text": "or using brave for example if browser have a built-in feature where you can use the",
    "start": "202239",
    "end": "207760"
  },
  {
    "text": "tor browsing fascinating the way it works is it it",
    "start": "207760",
    "end": "216879"
  },
  {
    "text": "it abstracts away the complexity of building a torque line",
    "start": "217280",
    "end": "223840"
  },
  {
    "text": "because it's hard encryption and layers and onions and stuff like that so it tries to abstract and make the",
    "start": "223840",
    "end": "229680"
  },
  {
    "text": "client as unaware of of what's happening as possible",
    "start": "229680",
    "end": "235120"
  },
  {
    "text": "the way it's doing that by the beauty of proxying and we if you have been",
    "start": "235120",
    "end": "242239"
  },
  {
    "text": "a subscriber or an listener to this show for a long time you know how much i love proxies because",
    "start": "242239",
    "end": "250480"
  },
  {
    "text": "they have changed the world recently yeah we've gone a little bit crazy with micro",
    "start": "250480",
    "end": "256239"
  },
  {
    "text": "services and side car containers and side car proxies but they're great they're changing the world",
    "start": "256239",
    "end": "262880"
  },
  {
    "text": "proxies are the future so if you have if there's someone who want to pursue their",
    "start": "262880",
    "end": "269600"
  },
  {
    "text": "phd i suggest you dive deep into proxies and and then",
    "start": "269600",
    "end": "274800"
  },
  {
    "text": "protocol of proxies search about mask right learn about mask not",
    "start": "274800",
    "end": "282880"
  },
  {
    "text": "right i forgot it's called multiplexing the quick protocol the multiplexing quick protocol that's that's another",
    "start": "284720",
    "end": "290320"
  },
  {
    "text": "proxy protocol it it's fascinating and and the tor client",
    "start": "290320",
    "end": "298479"
  },
  {
    "text": "uses a socks proxy sock proxy to that that essentially just",
    "start": "298479",
    "end": "307759"
  },
  {
    "text": "takes any ip packet and shove it into the proxy and the",
    "start": "307759",
    "end": "314479"
  },
  {
    "text": "proxy then adds that complexity and talks the tor language right",
    "start": "314479",
    "end": "319840"
  },
  {
    "text": "that's how side car proxy works as well right you have a client that talks pure http 1",
    "start": "319840",
    "end": "327440"
  },
  {
    "text": "and the sidecar proxy in the microservices architecture",
    "start": "327440",
    "end": "332560"
  },
  {
    "text": "will upgrade that connection will authenticate that connection will secure",
    "start": "332560",
    "end": "337680"
  },
  {
    "text": "the connection we'll talk to the control plane and we'll do all that complex logic behind the scene and you",
    "start": "337680",
    "end": "345199"
  },
  {
    "text": "can remain a dumb client while the smart proxy does the work essentially",
    "start": "345199",
    "end": "354000"
  },
  {
    "text": "so the sox proxy the tor proxy does this piece so what does the",
    "start": "354000",
    "end": "360479"
  },
  {
    "text": "onion proxy let's call it op onion proxy if you read the design",
    "start": "360479",
    "end": "365759"
  },
  {
    "text": "dock of door and i'm going to reference it in the show note below you're going to see this war this",
    "start": "365759",
    "end": "372160"
  },
  {
    "text": "abbreviation op right onion proxy so now the onion proxy receives a",
    "start": "372160",
    "end": "379840"
  },
  {
    "text": "request to connect to example.com on port",
    "start": "379840",
    "end": "384960"
  },
  {
    "text": "80. that's a get request i want to make a get request but before we do a get request we want to",
    "start": "384960",
    "end": "391120"
  },
  {
    "text": "establish a tcp connection to example.com on port 80. that's the",
    "start": "391120",
    "end": "396880"
  },
  {
    "text": "first thing that the sox proxy receives and for the simplicity of this you might say",
    "start": "396880",
    "end": "404240"
  },
  {
    "text": "hussein what happens really before that do does",
    "start": "404240",
    "end": "409840"
  },
  {
    "text": "the client that is you whether this is brave or tor browser",
    "start": "409840",
    "end": "416240"
  },
  {
    "text": "does it actually send the string example.com to the sox proxy",
    "start": "416240",
    "end": "422800"
  },
  {
    "text": "to the onion proxy or alongside with the port 80 or does it",
    "start": "422800",
    "end": "429440"
  },
  {
    "text": "actually reserve let me talk resolve",
    "start": "429440",
    "end": "435599"
  },
  {
    "text": "dns of example.com find out what the ip address of example.com",
    "start": "435599",
    "end": "441759"
  },
  {
    "text": "and then pass in the ip address to the onion router see we didn't even",
    "start": "441759",
    "end": "448960"
  },
  {
    "text": "start right that ladder approach is problematic",
    "start": "448960",
    "end": "456240"
  },
  {
    "text": "and and firefox has been guilty of doing that and it's a sh as well",
    "start": "456240",
    "end": "463720"
  },
  {
    "text": "ash ssh yeah secure secure shell has been guilty of that why",
    "start": "463720",
    "end": "469840"
  },
  {
    "text": "why is it bad because now you're doing a dns and dns is going through the natively",
    "start": "469840",
    "end": "478720"
  },
  {
    "text": "raw through your isp because it's the udp request and you just revealed where you're going",
    "start": "478720",
    "end": "486960"
  },
  {
    "text": "so your tor you revealed where you're going to your isp",
    "start": "486960",
    "end": "492000"
  },
  {
    "text": "or to the dns resolver whoever that is right so your tor",
    "start": "492000",
    "end": "499360"
  },
  {
    "text": "network usage is useless because someone already know where",
    "start": "499360",
    "end": "505120"
  },
  {
    "text": "you're going so be careful with that make sure your client the torque lines",
    "start": "505120",
    "end": "511680"
  },
  {
    "text": "actually shoves the string example.com or the domain in the tor network so that",
    "start": "511680",
    "end": "519360"
  },
  {
    "text": "the resolvation i don't know if that's a word the resolving of the domain of",
    "start": "519360",
    "end": "524640"
  },
  {
    "text": "example.com happens at the exit norm node right not at the",
    "start": "524640",
    "end": "533120"
  },
  {
    "text": "client side which is bad okay now that we have received a request to",
    "start": "533120",
    "end": "540000"
  },
  {
    "text": "connect right to to this tcp uh to establish this application with example.com",
    "start": "540000",
    "end": "546000"
  },
  {
    "text": "the onion proxy does the following it connects to something called the",
    "start": "546000",
    "end": "553760"
  },
  {
    "text": "tor directory and asks for three tor node",
    "start": "553760",
    "end": "560959"
  },
  {
    "text": "addresses usually these are host names publicly available and they",
    "start": "560959",
    "end": "567600"
  },
  {
    "text": "that onion proxy will will give these three nodes let's call them t1",
    "start": "567600",
    "end": "574839"
  },
  {
    "text": "t2 t3 the default is three and that's what",
    "start": "574839",
    "end": "580640"
  },
  {
    "text": "will essentially simulate our circuit all right so now i have a three the",
    "start": "580640",
    "end": "586880"
  },
  {
    "text": "ionian proxy have these three nodes it picks the entry node",
    "start": "586880",
    "end": "592880"
  },
  {
    "text": "and it picks the exit node and it picks the intermediate nodes let's call them for simplicity t1 is the entry node",
    "start": "592880",
    "end": "600320"
  },
  {
    "text": "t2 is the intermediate and t3 is the exit node and if you watched my other video you know what are these threes",
    "start": "600320",
    "end": "606800"
  },
  {
    "text": "t3 is the final destination that will be making the request to example.com the plain",
    "start": "606800",
    "end": "616720"
  },
  {
    "text": "text query to example to come to the website that i want to visit",
    "start": "616839",
    "end": "622399"
  },
  {
    "text": "right on our behalf and t3 doesn't know me as the client does not",
    "start": "622399",
    "end": "629839"
  },
  {
    "text": "it knows that node that is behind it which is t2",
    "start": "629839",
    "end": "635040"
  },
  {
    "text": "and t2 knows the node after it which is 2 t3",
    "start": "635040",
    "end": "640320"
  },
  {
    "text": "and t2 knows the node behind it which is t1 and so on okay",
    "start": "640320",
    "end": "646720"
  },
  {
    "text": "so the node only knows the node in front of it and then on behind but we're saying how did that happen that's",
    "start": "646720",
    "end": "653680"
  },
  {
    "text": "what i'm gonna talk about here right how does this circuit creation really happen",
    "start": "653680",
    "end": "659600"
  },
  {
    "text": "so now we picked the entry node we picked the exit and we know what are these just these are just labels to us",
    "start": "659600",
    "end": "665519"
  },
  {
    "text": "we still didn't do the work at the onion proxy the onion proxy is a very complicated thing that does the",
    "start": "665519",
    "end": "670560"
  },
  {
    "text": "work right so now from what i read",
    "start": "670560",
    "end": "676240"
  },
  {
    "text": "the onion proxy is gonna do something called",
    "start": "676240",
    "end": "684000"
  },
  {
    "text": "uh a circuit creation request so this is just a normal",
    "start": "684000",
    "end": "691440"
  },
  {
    "text": "tcp connection that is established between the onion proxy and the onion",
    "start": "691440",
    "end": "699360"
  },
  {
    "text": "the onion router the first onion router which is t1 okay so now we just establish a normal",
    "start": "699360",
    "end": "704640"
  },
  {
    "text": "tcp connection nothing fancy here we're going to send the first request",
    "start": "704640",
    "end": "710000"
  },
  {
    "text": "to the onion request the onion router the t1 we're asking t1 to create a circuit and",
    "start": "710000",
    "end": "716720"
  },
  {
    "text": "let's call this circuit c1 right because it's it's the first circuit right and now",
    "start": "716720",
    "end": "724720"
  },
  {
    "text": "when you create that circuit you essentially in that same content when you send you",
    "start": "724720",
    "end": "732639"
  },
  {
    "text": "establish the tls the transport layer security encryption",
    "start": "732639",
    "end": "739839"
  },
  {
    "text": "and when you establish that you exchange the diffie-hellman parameters and all that jazz right",
    "start": "739839",
    "end": "745680"
  },
  {
    "text": "and you you do that by sending a a circuit creation request with the",
    "start": "745680",
    "end": "751680"
  },
  {
    "text": "difficult information and then the onion router t1 will reply",
    "start": "751680",
    "end": "756880"
  },
  {
    "text": "back with the tls parameter back to and then now you have the onion proxy",
    "start": "756880",
    "end": "765519"
  },
  {
    "text": "have a shared key that is tls between itself the op",
    "start": "765519",
    "end": "773360"
  },
  {
    "text": "and t1 the first onion router",
    "start": "773360",
    "end": "779680"
  },
  {
    "text": "so now we we are secured at the first ring and the first just the first one we have a circuit called c1",
    "start": "779920",
    "end": "786079"
  },
  {
    "text": "we still need two more keys two more symmetrical keys we need a key",
    "start": "786079",
    "end": "792959"
  },
  {
    "text": "that will allow us to encrypt the second layer and the third layer for",
    "start": "792959",
    "end": "799920"
  },
  {
    "text": "the exit node right because the idea here is to obtain three symmetrical keys",
    "start": "799920",
    "end": "805920"
  },
  {
    "text": "one the first key will encrypt the first layer the entry node the the it's actually the opposite the",
    "start": "805920",
    "end": "812639"
  },
  {
    "text": "first key will encrypt the last layer right and then the second key will encrypt the middle layer",
    "start": "812639",
    "end": "818560"
  },
  {
    "text": "and then the last layer that were the first layer becomes the first the entry node",
    "start": "818560",
    "end": "824959"
  },
  {
    "text": "symmetra key so we need three keys so we establish one of them how do then we",
    "start": "824959",
    "end": "832480"
  },
  {
    "text": "stop we get the key for the t2 between us and t2 because we want end to",
    "start": "832480",
    "end": "838720"
  },
  {
    "text": "end encryption right how do we do that",
    "start": "838720",
    "end": "844000"
  },
  {
    "text": "in my previous tour video i made the mistake here",
    "start": "844000",
    "end": "850320"
  },
  {
    "text": "and i said that the client is actually talking to t1 t2 t3 independently which",
    "start": "850320",
    "end": "858240"
  },
  {
    "text": "is wrong that was wrong and i i clarified it in a comment there we don't do that",
    "start": "858240",
    "end": "866320"
  },
  {
    "text": "we don't establish the tls between the three nodes because that's just dumb if you do that",
    "start": "866320",
    "end": "872079"
  },
  {
    "text": "then t1t t1 knows you of course has to because it's the entry node the entry node always knows that line",
    "start": "872079",
    "end": "878480"
  },
  {
    "text": "that's just something we have to deal with but t2 and t3 should not know you",
    "start": "878480",
    "end": "885120"
  },
  {
    "text": "otherwise the whole tor system is useless so the way we do this now",
    "start": "885120",
    "end": "893279"
  },
  {
    "text": "using the key that we have established between us the client and t1 the first entry",
    "start": "893279",
    "end": "899920"
  },
  {
    "text": "node we then create",
    "start": "899920",
    "end": "905040"
  },
  {
    "text": "another circuit request called a relay extend request right and all of this is",
    "start": "905040",
    "end": "912000"
  },
  {
    "text": "happening through the underlining structure of the tor cells well they",
    "start": "912000",
    "end": "919920"
  },
  {
    "text": "call it the cell headers they have special headers they have a circuit id field in every",
    "start": "919920",
    "end": "927519"
  },
  {
    "text": "single packet that you send that has i did identify packets right the second thing i want to do is to",
    "start": "927519",
    "end": "933839"
  },
  {
    "text": "establish to extend my circuit right so now i just still",
    "start": "933839",
    "end": "940240"
  },
  {
    "text": "i just talk to t1 i say hey t1 please extend",
    "start": "940240",
    "end": "946880"
  },
  {
    "text": "circuit c1 to t2 that's what you do that is a command",
    "start": "946880",
    "end": "952720"
  },
  {
    "text": "that says extend the circuit and now when t1 and that the request that says extend",
    "start": "952720",
    "end": "960480"
  },
  {
    "text": "circuit to t2 is encrypted between us",
    "start": "960480",
    "end": "965759"
  },
  {
    "text": "and the first tor node which is t1 so now it receives this it decrypts it",
    "start": "965759",
    "end": "971360"
  },
  {
    "text": "and says oh you want to extend circuit c1 where do you want to extend it i want to extend it to t2",
    "start": "971360",
    "end": "977199"
  },
  {
    "text": "why because the onion proxy which is us we actually know t2 right so now",
    "start": "977199",
    "end": "983440"
  },
  {
    "text": "t1 extends the circuit it creates its own circuit between itself",
    "start": "983440",
    "end": "990320"
  },
  {
    "text": "and t2 here's where things are not really",
    "start": "990320",
    "end": "995680"
  },
  {
    "text": "new it's we're using the same command we're creating a brand new circuit",
    "start": "995680",
    "end": "1001680"
  },
  {
    "text": "between t1 and t2 that's what i did not know that's a new that's a new thing that i learned so now",
    "start": "1001680",
    "end": "1009120"
  },
  {
    "text": "there's another circuit called c2 between t1 and t2",
    "start": "1009120",
    "end": "1014880"
  },
  {
    "text": "but who's saying i thought the circuit is actually do not have three three nodes well we're gonna get to that",
    "start": "1014880",
    "end": "1021600"
  },
  {
    "text": "t1 has the knowledge to join circuits circuit c1 is joined to circuit c2",
    "start": "1021600",
    "end": "1030160"
  },
  {
    "text": "and that gives it enough state information to deliver content across",
    "start": "1030160",
    "end": "1036959"
  },
  {
    "text": "that okay so now when we create",
    "start": "1036959",
    "end": "1043839"
  },
  {
    "text": "the extend request between t1 and t2 we establish a tls",
    "start": "1044640",
    "end": "1051840"
  },
  {
    "text": "session between t1 and t2 this is not end to end we have a tls",
    "start": "1051840",
    "end": "1057440"
  },
  {
    "text": "between the client and t1 we have another tls between t1 and t2",
    "start": "1057440",
    "end": "1062799"
  },
  {
    "text": "right but the extend request that we made between the onion proxy",
    "start": "1062799",
    "end": "1071120"
  },
  {
    "text": "and t1 we said hey extend to t2 also has the diffie-hellman information",
    "start": "1071120",
    "end": "1079200"
  },
  {
    "text": "to establish another end to end tls session all the way to t2",
    "start": "1079200",
    "end": "1086960"
  },
  {
    "text": "from the onion proxy so now when we when when t1 starts extending",
    "start": "1086960",
    "end": "1094480"
  },
  {
    "text": "the circuit to t2 it also delivers that extended end to end tls hello all the way",
    "start": "1094480",
    "end": "1102559"
  },
  {
    "text": "to t2 right however t2 does not know our neoproxy because to",
    "start": "1102559",
    "end": "1109200"
  },
  {
    "text": "it it thinks that t1 requested that extra tls handshake t1 will",
    "start": "1109200",
    "end": "1117600"
  },
  {
    "text": "give back that response that oh i created a circuit and here's my tls parameters t1 knows that oh this",
    "start": "1117600",
    "end": "1125440"
  },
  {
    "text": "is circuit two i joined circuit two to circuit one this is supposed to go to this client so",
    "start": "1125440",
    "end": "1132000"
  },
  {
    "text": "let me join back and get back this content back to circuit one which is the client which",
    "start": "1132000",
    "end": "1138080"
  },
  {
    "text": "is the onion proxy so now the client receives the diffie-hellman",
    "start": "1138080",
    "end": "1143280"
  },
  {
    "text": "portion of the tls server hello from t2 that",
    "start": "1143280",
    "end": "1150000"
  },
  {
    "text": "allows us to get the second symmetric key this is complex stuff i know guys",
    "start": "1150000",
    "end": "1156559"
  },
  {
    "text": "so now i have t1",
    "start": "1156559",
    "end": "1161120"
  },
  {
    "text": "symmetric key i have t2 symmetric key as an onion router and now i",
    "start": "1161840",
    "end": "1169280"
  },
  {
    "text": "need to do i have i need to get the final one which is d3",
    "start": "1169280",
    "end": "1175840"
  },
  {
    "text": "uh symmetric key all right so now we need to ask t2",
    "start": "1175840",
    "end": "1183360"
  },
  {
    "text": "to extend its circuit",
    "start": "1183360",
    "end": "1187760"
  },
  {
    "text": "to t3 right so what we do is say hey we build a new i'm the onion proxy again",
    "start": "1188400",
    "end": "1194960"
  },
  {
    "text": "i build i say hey hey t2 i don't know what circuit you are but",
    "start": "1194960",
    "end": "1201360"
  },
  {
    "text": "here's my circuit id right it's one it doesn't know that there's a circuit id equal to",
    "start": "1201360",
    "end": "1206559"
  },
  {
    "text": "just say ex i want you to extend the your circuit",
    "start": "1206559",
    "end": "1213520"
  },
  {
    "text": "with two t3 which is supposed to be the exit node",
    "start": "1213520",
    "end": "1220480"
  },
  {
    "text": "and uh here is my diffie-hellman portion of",
    "start": "1220480",
    "end": "1226880"
  },
  {
    "text": "of the tls that i'm supposed to create with d3 because we need another",
    "start": "1226880",
    "end": "1232400"
  },
  {
    "text": "symmetric key with d3 right now i take that information and i encrypt it with t2",
    "start": "1232400",
    "end": "1238159"
  },
  {
    "text": "because t2 is the only one who should see this information so i encrypt it with the t2",
    "start": "1238159",
    "end": "1245120"
  },
  {
    "text": "symmetric key because i have that key now and now there's just a bunch of",
    "start": "1245120",
    "end": "1250559"
  },
  {
    "text": "garbage content now now i take that and i say hey t1",
    "start": "1250559",
    "end": "1257679"
  },
  {
    "text": "blindly relay this data to circuit one i i am asking you circuit",
    "start": "1257679",
    "end": "1264799"
  },
  {
    "text": "one relay to the next hop i don't even i don't even need to know what's the next hop",
    "start": "1264799",
    "end": "1270080"
  },
  {
    "text": "you should know it's a stateful protocol tor is a stateful protocol as far as i know right because yeah we",
    "start": "1270080",
    "end": "1277039"
  },
  {
    "text": "persist this information the circuit number but then the tor node should look up",
    "start": "1277039",
    "end": "1282240"
  },
  {
    "text": "okay circuit one where is exactly where does the next destination is you should know",
    "start": "1282240",
    "end": "1287760"
  },
  {
    "text": "persist somewhere right again i need to read more about that and discuss that",
    "start": "1287760",
    "end": "1293520"
  },
  {
    "text": "stuff so now we take that garbage encrypted content and then we",
    "start": "1293520",
    "end": "1299200"
  },
  {
    "text": "say hey relate to t2 and to this to the next circuit circuit one",
    "start": "1299200",
    "end": "1304799"
  },
  {
    "text": "and then also encrypt that with the t1 symmetric key so now we have",
    "start": "1304799",
    "end": "1310400"
  },
  {
    "text": "an encrypted content and when we ship it so nobody in the middle sniffing between us the onion proxy and t1 the",
    "start": "1310400",
    "end": "1318000"
  },
  {
    "text": "entry node can actually see what's going on so that's a good thing right we don't want anybody reads and what we're",
    "start": "1318000",
    "end": "1325120"
  },
  {
    "text": "talking about right so now t1 receives it",
    "start": "1325120",
    "end": "1330159"
  },
  {
    "text": "peels the onion unencrypt the first one and says oh this guy wants me to realize some",
    "start": "1330159",
    "end": "1335760"
  },
  {
    "text": "garbage content that it's encrypted with something that i don't understand to the next circle circuit one well",
    "start": "1335760",
    "end": "1342320"
  },
  {
    "text": "circuit one is actually linked to circuit two which is t2 so i know he's talking to c2 but i don't know what",
    "start": "1342320",
    "end": "1347440"
  },
  {
    "text": "they're saying so i'm going to relay this unencrypted payload all the way",
    "start": "1347440",
    "end": "1352880"
  },
  {
    "text": "to the next circuit which is c2 right which is t2 in this case and then relayed",
    "start": "1352880",
    "end": "1359520"
  },
  {
    "text": "t2 received it it's an incr encrypted right it uses is its key first it looks okay",
    "start": "1359520",
    "end": "1365760"
  },
  {
    "text": "oh this is circuit two i know that i need to use this particular symmetric key to decrypt it and it",
    "start": "1365760",
    "end": "1372640"
  },
  {
    "text": "decrypts that portion finds out that this is essentially uh",
    "start": "1372640",
    "end": "1378400"
  },
  {
    "text": "hey this is a request to actually create a circuit to t3 i want to extend my circuit to t3 so now",
    "start": "1378400",
    "end": "1385600"
  },
  {
    "text": "t2 creates a new circuit called circuit 3",
    "start": "1385600",
    "end": "1392480"
  },
  {
    "text": "all the way to d3 and says hey i want to create a new",
    "start": "1392480",
    "end": "1398000"
  },
  {
    "text": "circuit and the same thing we encrypt first there is an an additional tls encryption",
    "start": "1398000",
    "end": "1404720"
  },
  {
    "text": "between t2 t3 can't do anything about it and then we send the request to actually",
    "start": "1404720",
    "end": "1410559"
  },
  {
    "text": "create a circuit that's just part of the connection establishment first and then we send the tls request",
    "start": "1410559",
    "end": "1417679"
  },
  {
    "text": "that we received with the defilment parameter from all the way from the client and that's",
    "start": "1417679",
    "end": "1424480"
  },
  {
    "text": "the beauty t2 doesn't know the client even t3 doesn't know that line",
    "start": "1424480",
    "end": "1430159"
  },
  {
    "text": "it just says hey just extend so now t3 will reply back to t2 with the",
    "start": "1430159",
    "end": "1436400"
  },
  {
    "text": "diffie-hellman parameter essentially where we want to establish that third key",
    "start": "1436400",
    "end": "1441919"
  },
  {
    "text": "the symmetric key we're going to reply back says okay circuit has been created now this t2 should join circuit c3",
    "start": "1441919",
    "end": "1450799"
  },
  {
    "text": "with circuit c2 now c3 is joined to c2 now says okay oh i need to shove this",
    "start": "1450799",
    "end": "1457200"
  },
  {
    "text": "back to this response so i know i need to shove it back to circuit two well let me actually encrypt",
    "start": "1457200",
    "end": "1464880"
  },
  {
    "text": "it with my key right and then you start encrypting things back",
    "start": "1464880",
    "end": "1469919"
  },
  {
    "text": "with the same keys that you have used it then t2 received it",
    "start": "1469919",
    "end": "1477200"
  },
  {
    "text": "then go back to t1 encrypt said the same thing and then all the way or reach to the",
    "start": "1477200",
    "end": "1483840"
  },
  {
    "text": "onion proxy the onion proxy start peeling the the layer in the reverse manner",
    "start": "1483840",
    "end": "1490400"
  },
  {
    "text": "it says okay oh you you you have a first thing is okay let me decrypt what the entry node sent me",
    "start": "1490400",
    "end": "1498080"
  },
  {
    "text": "oh i got it and click the second layer now the third layer is essentially it's",
    "start": "1498080",
    "end": "1505360"
  },
  {
    "text": "a plain text right which has the",
    "start": "1505360",
    "end": "1510799"
  },
  {
    "text": "tls parameter of the server hello i say it's plain text but",
    "start": "1510799",
    "end": "1518320"
  },
  {
    "text": "it's not entirely true because it really depends whether you're using tls 1.3",
    "start": "1518320",
    "end": "1523360"
  },
  {
    "text": "versus dls 1.2 [Music] and that's really depends",
    "start": "1523360",
    "end": "1530400"
  },
  {
    "text": "so some portions are actually encrypted but regardless let's simplify the story",
    "start": "1530400",
    "end": "1535440"
  },
  {
    "text": "now i have a third beautiful key now just like that we have three keys i",
    "start": "1535440",
    "end": "1543279"
  },
  {
    "text": "should have picked two circuits on this and this complicated the story and became a",
    "start": "1543279",
    "end": "1548640"
  },
  {
    "text": "long and unnecessarily long video once i have these three symmetric keys",
    "start": "1548640",
    "end": "1554000"
  },
  {
    "text": "now i just established the connections right i have the keys and now i can",
    "start": "1554000",
    "end": "1561520"
  },
  {
    "text": "essentially stop beginning the actual request",
    "start": "1561520",
    "end": "1568559"
  },
  {
    "text": "remember what we we wanted to do we didn't want to do all this garbage we wanted to actually go to example.com80",
    "start": "1568559",
    "end": "1575919"
  },
  {
    "text": "so now that what i have i want to establish a connection it's called the relay",
    "start": "1575919",
    "end": "1581840"
  },
  {
    "text": "begin we're going to do a relay begin example.com that's string i want to",
    "start": "1581840",
    "end": "1589200"
  },
  {
    "text": "connect to port 80. that is becomes a request a sell request right",
    "start": "1589200",
    "end": "1597440"
  },
  {
    "text": "that is becomes data very valuable data nobody should see it",
    "start": "1597440",
    "end": "1603360"
  },
  {
    "text": "what do we do we encrypt it with the exit node t3 symmetric key",
    "start": "1603360",
    "end": "1611120"
  },
  {
    "text": "all right nice what's next we encrypted again with t2",
    "start": "1611120",
    "end": "1618480"
  },
  {
    "text": "symmetric key and then we encrypted the third time with t1 symmetric key",
    "start": "1618480",
    "end": "1625360"
  },
  {
    "text": "and then we add hey by the way this is circuit one because that's what we know and they say",
    "start": "1625360",
    "end": "1631360"
  },
  {
    "text": "hey relay that's what we do so now the t1 receives the uh the the thing decrypts it right",
    "start": "1631360",
    "end": "1639440"
  },
  {
    "text": "and then uh once we decrypt that thing we so okay we see that oh we're going to",
    "start": "1639440",
    "end": "1646320"
  },
  {
    "text": "c1 you want to relay this data to c1 okay let me do that it starts relaying to c1 t2 receives it",
    "start": "1646320",
    "end": "1653919"
  },
  {
    "text": "right it links for c1 to c2 which is circuit 1 to circuit 2 which has which is basically t2 the next top",
    "start": "1653919",
    "end": "1661600"
  },
  {
    "text": "then the next hop t2 receives it decrypts it with its own symmetric key and then finds oh you want",
    "start": "1661600",
    "end": "1668880"
  },
  {
    "text": "to relate to t3 which is circuit circuit 2 says circuit 2 but relate to circuit 3 because that's",
    "start": "1668880",
    "end": "1675200"
  },
  {
    "text": "where the link is all the way goes to t3 t3 decrypts and finds a beautiful plain",
    "start": "1675200",
    "end": "1682240"
  },
  {
    "text": "text request to go to example.com so t3 the exit node knows that",
    "start": "1682240",
    "end": "1690480"
  },
  {
    "text": "someone is going to example.com on port 80. who's that nasty person that's going to",
    "start": "1690480",
    "end": "1697399"
  },
  {
    "text": "example.com who's that well",
    "start": "1697399",
    "end": "1704080"
  },
  {
    "text": "we can't know as far as they know that t2 has made that request we don't know",
    "start": "1704080",
    "end": "1709279"
  },
  {
    "text": "right so t3 doesn't know so now t3 starts the tcp handshake",
    "start": "1709279",
    "end": "1716720"
  },
  {
    "text": "starts the dns resolution to find the iap address and then establish the tcp connection on",
    "start": "1716720",
    "end": "1723520"
  },
  {
    "text": "the back end have a beautiful beautiful connection and then so now once with the the",
    "start": "1723520",
    "end": "1729840"
  },
  {
    "text": "handshake is established the server is going to respond back",
    "start": "1729840",
    "end": "1735520"
  },
  {
    "text": "says okay t3 i have as t3 i have created the connection",
    "start": "1735520",
    "end": "1742320"
  },
  {
    "text": "to the actual site that you want to begin the connection with and then we're going to respond back say",
    "start": "1742320",
    "end": "1747760"
  },
  {
    "text": "okay you're connected sir so it's going to respond to t2",
    "start": "1747760",
    "end": "1754000"
  },
  {
    "text": "it's going to respond back to t1 t1 will respond to the onion proxy and then processor oh",
    "start": "1754000",
    "end": "1760080"
  },
  {
    "text": "i'm connected let me send that get request so you send the http get request and it goes",
    "start": "1760080",
    "end": "1765440"
  },
  {
    "text": "through the same exact cycle we encrypt with the last layer the second layer the first",
    "start": "1765440",
    "end": "1771279"
  },
  {
    "text": "layer and then decrypt the clip declaration encrypting correct encrypt decrypt declarative decrypt and then encrypt economic crime then",
    "start": "1771279",
    "end": "1777200"
  },
  {
    "text": "decrypt the cryptograph that's what you do that's how we get an end-to-end",
    "start": "1777200",
    "end": "1782640"
  },
  {
    "text": "beautiful connection but still the communication between these is",
    "start": "1782640",
    "end": "1787919"
  },
  {
    "text": "extremely complex right yet it's elegant i don't know how it is",
    "start": "1787919",
    "end": "1793279"
  },
  {
    "text": "to describe it's beautiful so now let's talk about a little bit before we end the video about",
    "start": "1793279",
    "end": "1799520"
  },
  {
    "text": "how do we really know that we're really think about it we're",
    "start": "1799520",
    "end": "1805120"
  },
  {
    "text": "relying on t1 to deliver t2's",
    "start": "1805120",
    "end": "1812240"
  },
  {
    "text": "symmetric keys not symmetrically the different helmet parameters isn't that like a perfect man in the",
    "start": "1812240",
    "end": "1819440"
  },
  {
    "text": "middle position if i'm a shady t1 if i'm right if i'm in the cia running t1",
    "start": "1819440",
    "end": "1826000"
  },
  {
    "text": "can't i just do a man in the middle and hand you my own different helmet parameters",
    "start": "1826000",
    "end": "1833039"
  },
  {
    "text": "establishing essentially a man in the middle position you can definitely",
    "start": "1833039",
    "end": "1838720"
  },
  {
    "text": "but you guys forgot something there is an authentication here going on",
    "start": "1838720",
    "end": "1845360"
  },
  {
    "text": "certificates every single node has certificates in it just like",
    "start": "1845360",
    "end": "1852559"
  },
  {
    "text": "any certificate that you deal with certificates exist in tor and they are very crucial",
    "start": "1852559",
    "end": "1858399"
  },
  {
    "text": "for this portion so the tor each tor node has a domain name",
    "start": "1858399",
    "end": "1865200"
  },
  {
    "text": "and each domain name is associated with a beautiful certificate now i didn't do",
    "start": "1865200",
    "end": "1872480"
  },
  {
    "text": "much research right but just that fact alone can definitely tell you that nobody can",
    "start": "1872480",
    "end": "1878720"
  },
  {
    "text": "mess with your content in the middle nobody can carry on a man in the middle",
    "start": "1878720",
    "end": "1884320"
  },
  {
    "text": "attack right because the certificate proves that you're actually going to the",
    "start": "1884320",
    "end": "1891039"
  },
  {
    "text": "site or going to the proxy or going to the onion router that you want to go to",
    "start": "1891039",
    "end": "1897360"
  },
  {
    "text": "right when you receive those parameters they again are also you're going to get also the certificate as",
    "start": "1897360",
    "end": "1903519"
  },
  {
    "text": "part of every single diffie-hellman request",
    "start": "1903519",
    "end": "1908799"
  },
  {
    "text": "so now we have a way to find out that hey nobody actually",
    "start": "1908799",
    "end": "1914960"
  },
  {
    "text": "cheated and nobody fake dos certificate now can attacks",
    "start": "1914960",
    "end": "1922080"
  },
  {
    "text": "happen of course obviously if you have an onion proxy that is shady or it's dumb it's not verifying",
    "start": "1922080",
    "end": "1929200"
  },
  {
    "text": "certificates properly all right you can run into all sorts of problems right",
    "start": "1929200",
    "end": "1935600"
  },
  {
    "text": "if you're using an attor client that is shady",
    "start": "1935600",
    "end": "1941360"
  },
  {
    "text": "well you just reveal yourself you really need to understand what what tor browsers are you actually using",
    "start": "1941519",
    "end": "1947440"
  },
  {
    "text": "or tor client they're actually doing all this work that the connection establishment",
    "start": "1947440",
    "end": "1952799"
  },
  {
    "text": "is the most complex thing and but before we end the video the reason i discussed this part is",
    "start": "1952799",
    "end": "1960320"
  },
  {
    "text": "because i wanted to have a base episode to go back to",
    "start": "1960320",
    "end": "1967518"
  },
  {
    "text": "in order to understand the the top the next topic that i want to",
    "start": "1967600",
    "end": "1973519"
  },
  {
    "text": "discuss which is the onion routing services the onion services or",
    "start": "1973519",
    "end": "1981919"
  },
  {
    "text": "hidden services or the clickbaity names",
    "start": "1981919",
    "end": "1986960"
  },
  {
    "text": "dark web uh in order to understand how to",
    "start": "1986960",
    "end": "1993279"
  },
  {
    "text": "host a website which has a public ipad is yet",
    "start": "1993279",
    "end": "1998399"
  },
  {
    "text": "it is set behind this onion routing it is it is fascinating how they did",
    "start": "1998399",
    "end": "2004720"
  },
  {
    "text": "that this it's essentially based on the same concept of the circuits but it's essentially double the",
    "start": "2004720",
    "end": "2012159"
  },
  {
    "text": "amounts and it's changes ephemerally every time so i'm going to talk about that in the next",
    "start": "2012159",
    "end": "2018000"
  },
  {
    "text": "video i'm just still continuing the research still very early right and then guys",
    "start": "2018000",
    "end": "2024480"
  },
  {
    "text": "if you're expert in tor and you saw you saw something that i said that is stupid or wrong",
    "start": "2024480",
    "end": "2030399"
  },
  {
    "text": "it just doesn't make sense let me know in the comment section below i'm gonna see you in the next one you guys stay awesome good bye yo they scott",
    "start": "2030399",
    "end": "2039840"
  }
]