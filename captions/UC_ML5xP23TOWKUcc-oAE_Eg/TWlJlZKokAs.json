[
  {
    "start": "0",
    "end": "208000"
  },
  {
    "text": "in this episode of the back engineering show I'd like to discuss the concept of keep alive uh why was it introduced to",
    "start": "40",
    "end": "7040"
  },
  {
    "text": "the TCP stack and later to the HTTP stack uh",
    "start": "7040",
    "end": "12120"
  },
  {
    "text": "why uh what were the benefits of introducing it what obstacles were",
    "start": "12120",
    "end": "21480"
  },
  {
    "text": "introduced as a result of introducing it right as a result the application",
    "start": "21480",
    "end": "27920"
  },
  {
    "text": "started not trusting keep because of some certain obstacles that were introduced as a side effect really and",
    "start": "27920",
    "end": "35000"
  },
  {
    "text": "then finally the disadvantages of doing too much of keep alive and",
    "start": "35000",
    "end": "42200"
  },
  {
    "text": "then and then what are the ramifications on the back end when it comes to scaling",
    "start": "42200",
    "end": "48440"
  },
  {
    "text": "large backends with with large keep alive clients let's jump into it welcome to",
    "start": "48440",
    "end": "55440"
  },
  {
    "text": "the back engineering show with your host Hussein nasur and the reason I'm talking",
    "start": "55440",
    "end": "61039"
  },
  {
    "text": "about keep alive and you might say a lot of a lot of you might say was why are you talking about keep alive right can",
    "start": "61039",
    "end": "67360"
  },
  {
    "text": "you talk about more something more interesting like something more shiny uh this is not what I do in this",
    "start": "67360",
    "end": "73799"
  },
  {
    "text": "channel I mean you're if you're here you already know that I like to talk about the basic stuff the fundamentals like",
    "start": "73799",
    "end": "80640"
  },
  {
    "text": "things that are the building blocks of everything that we consume today and uh",
    "start": "80640",
    "end": "86040"
  },
  {
    "text": "you find these pieces of nuggets of gold when you dig into the these thing and and that's what I did uh I was um I was",
    "start": "86040",
    "end": "93119"
  },
  {
    "text": "building a new course on inine X stay tuned for that it's it's going to come up soon on udem me hopefully and then",
    "start": "93119",
    "end": "102640"
  },
  {
    "text": "just I took my existing INX course and then then re introduced new content to",
    "start": "102640",
    "end": "108399"
  },
  {
    "text": "it and uh new uh I recorded the whole thing really and just I think a lot of",
    "start": "108399",
    "end": "116360"
  },
  {
    "text": "the now that I know more I think that course deser ered a revamp kind of a",
    "start": "116360",
    "end": "122159"
  },
  {
    "text": "thing ISO is being approved Now by skillshare and UD me so stay tuned for that but",
    "start": "122159",
    "end": "129759"
  },
  {
    "text": "um when I was making that course uh the keep Al life",
    "start": "129759",
    "end": "135760"
  },
  {
    "text": "timeouts uh started appearing a lot in in Genex and I was really curious why do",
    "start": "135760",
    "end": "142680"
  },
  {
    "text": "we have this many keep alive timeouts and uh when I dig down to the dock which",
    "start": "142680",
    "end": "148239"
  },
  {
    "text": "are terrible by the way in genx are the wars everybody knows that uh you can't",
    "start": "148239",
    "end": "153319"
  },
  {
    "text": "really understand anything from them you have to look at the code and I don't I",
    "start": "153319",
    "end": "159120"
  },
  {
    "text": "can't read C code much but uh a lot of people write articles about certain time",
    "start": "159120",
    "end": "166200"
  },
  {
    "text": "so that's why I started put one one and one and one together two and two together and trying to understand why",
    "start": "166200",
    "end": "171920"
  },
  {
    "text": "these things exist and just make up my own assumptions of things and that's the whole thing right about so I discovered",
    "start": "171920",
    "end": "180760"
  },
  {
    "text": "a lot of things that are really fascinating right then dive deep into",
    "start": "180760",
    "end": "186040"
  },
  {
    "text": "what when it was introduced and why was it introduced and then I talked about",
    "start": "186040",
    "end": "191159"
  },
  {
    "text": "this many times in this channel as well and why it wasn't introduced in httv protocal but that was the reason why I'm",
    "start": "191159",
    "end": "198080"
  },
  {
    "text": "talking about this now because there are there is history here and I and I think it's good to shed light on the history",
    "start": "198080",
    "end": "205840"
  },
  {
    "text": "uh I believe we can learn a thing on to from that so the keep alive concept was",
    "start": "205840",
    "end": "210920"
  },
  {
    "start": "208000",
    "end": "510000"
  },
  {
    "text": "first introduced in the TCP protocol itself right and if you",
    "start": "210920",
    "end": "216920"
  },
  {
    "text": "don't know guys TCP is the transmission control protocol and it's designed to be",
    "start": "216920",
    "end": "222480"
  },
  {
    "text": "a connection oriented that means we have to store some surface State on both the",
    "start": "222480",
    "end": "228480"
  },
  {
    "text": "client and the server uh mark down certain sequences uh to Mark our packets",
    "start": "228480",
    "end": "234519"
  },
  {
    "text": "on both the client and the server uh have certain so size of a window for the",
    "start": "234519",
    "end": "240319"
  },
  {
    "text": "congestion control to know oh this connection is now very congested let's",
    "start": "240319",
    "end": "246040"
  },
  {
    "text": "slow down the rate of transmission oh this is now open up the banner is really good let's just send more data and and",
    "start": "246040",
    "end": "254040"
  },
  {
    "text": "and it deals with packets arriving sorry segments arriving out of order segments",
    "start": "254040",
    "end": "260880"
  },
  {
    "text": "are the TCP stack IP packets are the layer three right and uh it will just",
    "start": "260880",
    "end": "266840"
  },
  {
    "text": "order these things things that layer three doesn't do right so this is the connection and and you can see the cost",
    "start": "266840",
    "end": "274000"
  },
  {
    "text": "of establishing the connection with this three-way handshake which I talked about on this channel so there is incentive to",
    "start": "274000",
    "end": "280800"
  },
  {
    "text": "keep this connection running as much as possible right",
    "start": "280800",
    "end": "287440"
  },
  {
    "text": "because you want to send data you can't send establish a connection send one",
    "start": "287440",
    "end": "293360"
  },
  {
    "text": "bite and then close it and then restablish a connection and send another bite that doesn't make any sense right",
    "start": "293360",
    "end": "299360"
  },
  {
    "text": "connection is designed for long running stream of content I want to send",
    "start": "299360",
    "end": "306199"
  },
  {
    "text": "a lot of things so I want to open it once send a lot of data and then close it an emphasis on the closing of the",
    "start": "306199",
    "end": "312000"
  },
  {
    "text": "connection here the TCP protocol specifically says",
    "start": "312000",
    "end": "317759"
  },
  {
    "text": "that if the parties are done with the connection one of the parties should",
    "start": "317759",
    "end": "324880"
  },
  {
    "text": "initiate the closing of the connection because you're done that's one way",
    "start": "324880",
    "end": "330120"
  },
  {
    "text": "obviously right if you're done you don't you know based on certain context that",
    "start": "330120",
    "end": "335240"
  },
  {
    "text": "the other party will not send anything so just close it the other condition is",
    "start": "335240",
    "end": "341199"
  },
  {
    "text": "if the connection is not used for certain amount of time it's idle the parties should also close the",
    "start": "341199",
    "end": "348319"
  },
  {
    "text": "connection you might say why this why why are we closing",
    "start": "348319",
    "end": "355039"
  },
  {
    "text": "something that is Idle has been always the best practice for the longest time since the ' 880s and the '90s and the",
    "start": "355039",
    "end": "362319"
  },
  {
    "text": "two early 2000s when memory and CPU were scarse scarce scarce",
    "start": "362319",
    "end": "371840"
  },
  {
    "text": "right so these Idol connections are taking precious memory for",
    "start": "371840",
    "end": "379199"
  },
  {
    "text": "things that are uh not being used really so other",
    "start": "379199",
    "end": "386919"
  },
  {
    "text": "connections might starve right other serious connections serious processes",
    "start": "386919",
    "end": "394199"
  },
  {
    "text": "that want to do some work might start because of your idol connections other important stuff and processes and",
    "start": "394199",
    "end": "400960"
  },
  {
    "text": "connections can use this freed up space but if you don't know the TCP",
    "start": "400960",
    "end": "409759"
  },
  {
    "text": "descriptors is really small in size that that's what the connection really holds",
    "start": "409759",
    "end": "415080"
  },
  {
    "text": "right especially these days but the compared to",
    "start": "415080",
    "end": "421039"
  },
  {
    "text": "older computer that was significant not not anymore right but even though the",
    "start": "421039",
    "end": "428319"
  },
  {
    "text": "size is is significantly small the management of idle connections is also",
    "start": "428319",
    "end": "433520"
  },
  {
    "text": "costly because usually when you have uh file descriptors you need to point to it right to to know that oh there is an",
    "start": "433520",
    "end": "439680"
  },
  {
    "text": "idle connection here if you don't use it that's fine but it takes memory but the",
    "start": "439680",
    "end": "445560"
  },
  {
    "text": "processes that manages let's say 100,000 connections and 100,000 connections and",
    "start": "445560",
    "end": "452199"
  },
  {
    "text": "990,000 of them are idle going to Loop through 990,000 connections to find the",
    "start": "452199",
    "end": "458440"
  },
  {
    "text": "connections that it wants right so there is management the there",
    "start": "458440",
    "end": "464080"
  },
  {
    "text": "is the management overhead of managing ID connections is costly that's why you also need to free up these connections",
    "start": "464080",
    "end": "471039"
  },
  {
    "text": "if you don't know it now the problem with this is some",
    "start": "471039",
    "end": "478039"
  },
  {
    "text": "clients kind of need idle connections to stay",
    "start": "478039",
    "end": "483919"
  },
  {
    "text": "idle hey I I I don't have data to send now but I'm going to send something soon",
    "start": "484720",
    "end": "492319"
  },
  {
    "text": "you can't close the connection on me because I don't want to take the",
    "start": "492319",
    "end": "497639"
  },
  {
    "text": "overhead of reestablishing the connection that's one because that's expensive that we know right these are",
    "start": "497639",
    "end": "504360"
  },
  {
    "text": "certain requirements that the clients",
    "start": "504360",
    "end": "509960"
  },
  {
    "text": "need to introduce I need the connection to stay",
    "start": "509960",
    "end": "515479"
  },
  {
    "start": "510000",
    "end": "630000"
  },
  {
    "text": "alive and that's why the the TCP spec the RFC which is funny by the way I'm",
    "start": "515479",
    "end": "521399"
  },
  {
    "text": "going to I'm going to show it in the screen here in a minute uh the TCB stack introduced the",
    "start": "521399",
    "end": "527560"
  },
  {
    "text": "keep alive concept it is in the RFC in 1981 whatever this pick was written if you want to keep the connection alive",
    "start": "527560",
    "end": "533959"
  },
  {
    "text": "for any reason right you have to send a packet that is empty right",
    "start": "533959",
    "end": "540000"
  },
  {
    "text": "and that packet that is empty essentially says a keep alive flag it has a keep alive flag so you send it and",
    "start": "540000",
    "end": "547399"
  },
  {
    "text": "that tells the connection is oh I'm going to keep it alive sure and we acknowledge that keep alive like so we",
    "start": "547399",
    "end": "554079"
  },
  {
    "text": "don't move the sequence number cu the sequence stay the same right so we don't burn",
    "start": "554079",
    "end": "560560"
  },
  {
    "text": "sequences but we get the connection to be alive so",
    "start": "560560",
    "end": "566440"
  },
  {
    "text": "now it introduces the concept of keep flock let's get this the option to send these keep alive",
    "start": "566440",
    "end": "573959"
  },
  {
    "text": "empty packets or segments must be the application must",
    "start": "573959",
    "end": "579920"
  },
  {
    "text": "turn it off by default that's the that's what the RFC says says hey we don't like",
    "start": "579920",
    "end": "585720"
  },
  {
    "text": "these empty packets so we we prefer that you don't keep the connection alive and",
    "start": "585720",
    "end": "590959"
  },
  {
    "text": "close it that was 81 obviously right again so we PR and if you want to",
    "start": "590959",
    "end": "597000"
  },
  {
    "text": "introduce the option to have con keep alive it has to be configurable and it has to be turned off by default and if",
    "start": "597000",
    "end": "605200"
  },
  {
    "text": "you want to set it the user cannot send",
    "start": "605200",
    "end": "610959"
  },
  {
    "text": "these keep alive messages for a period less than two hours two hours like the connection will",
    "start": "610959",
    "end": "618839"
  },
  {
    "text": "ever reach have you ever seen a HTP connection that lives for two hours in",
    "start": "618839",
    "end": "624079"
  },
  {
    "text": "the internet I'm going to talk about in the internet now in a minute why but but",
    "start": "624079",
    "end": "629800"
  },
  {
    "text": "yeah the minimum that you can send this keep has to be like at least two hours",
    "start": "629800",
    "end": "635279"
  },
  {
    "start": "630000",
    "end": "990000"
  },
  {
    "text": "right so let's talk about keep alive TCP and middle boxes specifically",
    "start": "635279",
    "end": "643360"
  },
  {
    "text": "routers in the internet right and what they do",
    "start": "643360",
    "end": "649279"
  },
  {
    "text": "so routers route IP packets right they take if they see",
    "start": "649279",
    "end": "655959"
  },
  {
    "text": "in layer three IP packets and they only supposed to look at the destination IP",
    "start": "655959",
    "end": "663360"
  },
  {
    "text": "address and the source IP address and figure out where to send this next and",
    "start": "663360",
    "end": "668720"
  },
  {
    "text": "where to send this next depends on the routing table that the router has and",
    "start": "668720",
    "end": "676240"
  },
  {
    "text": "depends on the cost of the route because it says okay you can go to this IP address through this this this this",
    "start": "676240",
    "end": "682600"
  },
  {
    "text": "interface this interface interface because the routers and have multiple interfaces to send data through like",
    "start": "682600",
    "end": "689519"
  },
  {
    "text": "ours right the one I have is just one to my ISP right but",
    "start": "689519",
    "end": "697360"
  },
  {
    "text": "um so it picks the shortest most efficient path which means",
    "start": "697360",
    "end": "703079"
  },
  {
    "text": "that every IP packet can go to a different path even though the",
    "start": "703079",
    "end": "708560"
  },
  {
    "text": "destination is the same right and that yields to obviously",
    "start": "708560",
    "end": "715399"
  },
  {
    "text": "the packets arriving out of order in case of an stateful Pro such as TCP",
    "start": "715399",
    "end": "720480"
  },
  {
    "text": "that's bad because the TCP stack on the endpoint",
    "start": "720480",
    "end": "726839"
  },
  {
    "text": "has to reorder and apparently the vendors of these metal",
    "start": "726839",
    "end": "732120"
  },
  {
    "text": "boxes broke this Rule and said we know better than you computer",
    "start": "732120",
    "end": "739800"
  },
  {
    "text": "scientist who designed the TCP protocol and the IP stuff we going to hardcode the path",
    "start": "739800",
    "end": "750040"
  },
  {
    "text": "when it's at TCP connection because it's more effective why do we send packets",
    "start": "750040",
    "end": "756120"
  },
  {
    "text": "all over the place I'm going to look at the IP packet not just the destination",
    "start": "756120",
    "end": "761480"
  },
  {
    "text": "and the source I'm going to actually deep inspect it I'm going to open up the IP beautiful packet I'm going to De",
    "start": "761480",
    "end": "769160"
  },
  {
    "text": "perspect it I'm going to look at the content I'm going to jump to layer four when I jump to layer four I can see the",
    "start": "769160",
    "end": "776440"
  },
  {
    "text": "port I can see the source Port destination import I can see what are",
    "start": "776440",
    "end": "781600"
  },
  {
    "text": "you sending to a certain extent I can see that oh this is a sin this is an act",
    "start": "781600",
    "end": "787560"
  },
  {
    "text": "this is a fin right a close connection or this is a keep",
    "start": "787560",
    "end": "793800"
  },
  {
    "text": "alive it no they know this thing and based on that if it's a sin",
    "start": "793800",
    "end": "799560"
  },
  {
    "text": "they store the fact that this there is a new connection request from this Source",
    "start": "799560",
    "end": "805079"
  },
  {
    "text": "IP to this destination IP and then they will pick one route and",
    "start": "805079",
    "end": "810680"
  },
  {
    "text": "then State F sticky do a sticky route to always",
    "start": "810680",
    "end": "816639"
  },
  {
    "text": "this thing as long as the source IP and destination IP Remains the Same and also",
    "start": "816639",
    "end": "822399"
  },
  {
    "text": "the port and the source Port they do a hash of these four parameters and the okay oh is this part of the same",
    "start": "822399",
    "end": "830199"
  },
  {
    "text": "connection this rout I'm not going to do a load balancing I'm not going to even if there is a CO rout that is shorter no",
    "start": "830199",
    "end": "838360"
  },
  {
    "text": "we're not going to go there it's better to go to the same route and send all the connection to the",
    "start": "838360",
    "end": "844800"
  },
  {
    "text": "same route all packets to the same route because they will arrive in order and as a result the P the backends right the",
    "start": "844800",
    "end": "852079"
  },
  {
    "text": "peers will not have to reorder segments so we think this is faster and this is",
    "start": "852079",
    "end": "858120"
  },
  {
    "text": "what made the TCP actually single path",
    "start": "858120",
    "end": "864680"
  },
  {
    "text": "right now the TCP protocol is a is a single path per",
    "start": "864680",
    "end": "872120"
  },
  {
    "text": "connection so when you send this connection on a cont connection it always go through a certain path in the",
    "start": "872120",
    "end": "879000"
  },
  {
    "text": "internet unless something breaks obviously that's when things change but for the most part it is a sticky path so",
    "start": "879000",
    "end": "886600"
  },
  {
    "text": "what's the problem with that that means if you try to change the rules if you try to do anything else so if you try to",
    "start": "886600",
    "end": "893079"
  },
  {
    "text": "do something uh odd the middle box is these routers",
    "start": "893079",
    "end": "899320"
  },
  {
    "text": "will detect it let's say you try to send a TCP content without establishing a TCP",
    "start": "899320",
    "end": "904880"
  },
  {
    "text": "connection right so if you try to send this content right the middle boxes will",
    "start": "904880",
    "end": "910839"
  },
  {
    "text": "say okay you're trying to do send some keep alive data or anything really to a",
    "start": "910839",
    "end": "917440"
  },
  {
    "text": "destination that you never establish a connection before because they became",
    "start": "917440",
    "end": "922519"
  },
  {
    "text": "stateful they know this thing and they will drop your packets so they know that this is always",
    "start": "922519",
    "end": "930079"
  },
  {
    "text": "has to be you know stateful now they they made it stateful all the way right",
    "start": "930079",
    "end": "937680"
  },
  {
    "text": "all the way from the pier to from the origin to the source that even the middle boxes are aware of these",
    "start": "937680",
    "end": "943440"
  },
  {
    "text": "connections they they drop pack as that doesn't make they don't make sense for them and and that's why yourp can detect",
    "start": "943440",
    "end": "951800"
  },
  {
    "text": "attempts to you trying to spoof your IP address",
    "start": "951800",
    "end": "957399"
  },
  {
    "text": "if you try to send packets from your um",
    "start": "957399",
    "end": "963720"
  },
  {
    "text": "machine and change your IP address which you can easily do right to something else yourp says wait a second that's not",
    "start": "963720",
    "end": "972120"
  },
  {
    "text": "your IP address where where are you sending this backet to well you're you're claiming to be coming from South",
    "start": "972120",
    "end": "979440"
  },
  {
    "text": "America but you're actually in uh Vietnam",
    "start": "979440",
    "end": "985279"
  },
  {
    "text": "Nah Block so they drop these packet so this is something very similar right so",
    "start": "985279",
    "end": "992040"
  },
  {
    "start": "990000",
    "end": "1170000"
  },
  {
    "text": "why am I saying this I'm saying this because know Loop it back to keep",
    "start": "992040",
    "end": "997519"
  },
  {
    "text": "alive the introduction of keep alive by sending those content of empty packets",
    "start": "997519",
    "end": "1004120"
  },
  {
    "text": "of keep alive some midal boxes decided is a good",
    "start": "1004120",
    "end": "1009399"
  },
  {
    "text": "idea to ignore keep alive Al",
    "start": "1009399",
    "end": "1014959"
  },
  {
    "text": "together so if you have a connection and you establish it legitimately with a sense and act so the",
    "start": "1014959",
    "end": "1021680"
  },
  {
    "text": "middle boxes are aware that you made a connection but if you send a few data and then for a very long time you only",
    "start": "1021680",
    "end": "1028918"
  },
  {
    "text": "started sending keep alive messages for the longest time you started just sending keep alive messages that are",
    "start": "1028919",
    "end": "1035678"
  },
  {
    "text": "empty effectively the middle boxes will say wait a second this guy did not send",
    "start": "1035679",
    "end": "1040880"
  },
  {
    "text": "anything for the past hour I am going to drop my knowledge about this connection",
    "start": "1040880",
    "end": "1049120"
  },
  {
    "text": "yiki I learned that by the way from um Daniel stumberg blog I'm going to reference it below this is just",
    "start": "1051080",
    "end": "1058280"
  },
  {
    "text": "fascinating so they would just drop the keep uh they would drop the knowledge of the connection so me saying who who",
    "start": "1058280",
    "end": "1064840"
  },
  {
    "text": "cares well right if you start sending data now assuming you have a connection",
    "start": "1064840",
    "end": "1070679"
  },
  {
    "text": "nobody will know you anymore these these packets will be dropped because we say",
    "start": "1070679",
    "end": "1077000"
  },
  {
    "text": "oh you want to go to this IP address well sorry you don't you have not connected to this IP address before why",
    "start": "1077000",
    "end": "1083480"
  },
  {
    "text": "are you sending it data why are you sending a TCP data you never established",
    "start": "1083480",
    "end": "1089600"
  },
  {
    "text": "a connection before you did but it was dropped because you didn't send data for",
    "start": "1089600",
    "end": "1096840"
  },
  {
    "text": "a long time so why do they do that beats me to be honest this vendors of the",
    "start": "1096840",
    "end": "1103480"
  },
  {
    "text": "internet routers beats me right I don't I don't know why would they do that there must be a reason",
    "start": "1103480",
    "end": "1109360"
  },
  {
    "text": "obviously uh maybe the cost of keeping a connection alive for a long time that",
    "start": "1109360",
    "end": "1115440"
  },
  {
    "text": "are idle and I'm serving the entire internet I rather keep my routing table small cuz",
    "start": "1115440",
    "end": "1124159"
  },
  {
    "text": "I imagine how many TCP connections there are these connection these routers store",
    "start": "1124159",
    "end": "1129360"
  },
  {
    "text": "billions I wouldn't I wouldn't be surprised if it's in a billions right from all over the world right so if I",
    "start": "1129360",
    "end": "1136400"
  },
  {
    "text": "can drop these number by killing those connections if I can drop them to 500 million I'll do it I'll do it if I'm a",
    "start": "1136400",
    "end": "1145440"
  },
  {
    "text": "vendor I'll do it screw you in points that are sending only keep alive messages I'm not going to I don't care",
    "start": "1145440",
    "end": "1154480"
  },
  {
    "text": "so what what you might say just just reestablish the connection again who cares well here's an another example",
    "start": "1154480",
    "end": "1161600"
  },
  {
    "text": "from um uh what's his name Daniel blog uh the FTP stuff right",
    "start": "1161600",
    "end": "1169400"
  },
  {
    "text": "when you do an FTP connection and I I didn't know that for the longest I just recently learned that FTP does two",
    "start": "1169400",
    "end": "1176240"
  },
  {
    "start": "1170000",
    "end": "1500000"
  },
  {
    "text": "connections actually one for transferring the actual data and one for the control messages says okay oh uh I'm",
    "start": "1176240",
    "end": "1184400"
  },
  {
    "text": "about to upload I'm about to do this oh okay your uploaders arrived okay I'm",
    "start": "1184400",
    "end": "1190039"
  },
  {
    "text": "about to download this uh di uh give me the list of content there's a there's a",
    "start": "1190039",
    "end": "1196400"
  },
  {
    "text": "connection TCP connection for this controll messages there is a TCP connection for the actual",
    "start": "1196400",
    "end": "1203120"
  },
  {
    "text": "content most likely they're doing this way because the control messages take",
    "start": "1203120",
    "end": "1209440"
  },
  {
    "text": "trumps the data right if I send you a control message to aboard the upload you",
    "start": "1209440",
    "end": "1214960"
  },
  {
    "text": "better listen to it but imagine sending it through the pipe with millions of",
    "start": "1214960",
    "end": "1220480"
  },
  {
    "text": "content to upload I don't know movie right so that sounded British I don't know how it's like move right so you you",
    "start": "1220480",
    "end": "1228880"
  },
  {
    "text": "would you want the abort to take precedence on the the uh actual content",
    "start": "1228880",
    "end": "1236960"
  },
  {
    "text": "so if you're flooded with bites of uh of the actual movie",
    "start": "1236960",
    "end": "1242480"
  },
  {
    "text": "content this this might not even reached the control message might not even reach that's why they I think that's why I",
    "start": "1242480",
    "end": "1248159"
  },
  {
    "text": "think at least they did in the t2 tt2 TCB connection but here here's where it",
    "start": "1248159",
    "end": "1254600"
  },
  {
    "text": "breaks down let's say your uh you're upload cing a 50 gab file so you're going to",
    "start": "1254600",
    "end": "1264159"
  },
  {
    "text": "use the data channel right the data connection so there this connection will be busy and Alive nobody will ever dare",
    "start": "1264159",
    "end": "1271039"
  },
  {
    "text": "to close it because you're sending content nobody in the in the middle will dare to close it you are legitimately",
    "start": "1271039",
    "end": "1279480"
  },
  {
    "text": "active now the control channel is there sitting",
    "start": "1279480",
    "end": "1285840"
  },
  {
    "text": "twiddling its thump why because it doesn't do any I'm just uploading file I'm just sitting here",
    "start": "1285840",
    "end": "1294240"
  },
  {
    "text": "chilling I need to keep the connection alive so I'm sending these beautiful empty keep alive",
    "start": "1294240",
    "end": "1301880"
  },
  {
    "text": "messages but the middle router gives me",
    "start": "1301880",
    "end": "1308039"
  },
  {
    "text": "the middle finger and drops my control FTP",
    "start": "1308039",
    "end": "1316919"
  },
  {
    "text": "connection and get this so you uploaded the content 40 gigs I",
    "start": "1317520",
    "end": "1324200"
  },
  {
    "text": "took let's be honest it took only 10 minutes because you have fast",
    "start": "1324200",
    "end": "1329520"
  },
  {
    "text": "internet and then uh",
    "start": "1329520",
    "end": "1333840"
  },
  {
    "text": "you you want to send the control message to save to store this file on on on on",
    "start": "1335080",
    "end": "1341679"
  },
  {
    "text": "the server say hey s and give it this name whatever right when you do that that will fail",
    "start": "1341679",
    "end": "1348559"
  },
  {
    "text": "because you're trying to send a connection and get this the peers don't know that the connection is closed",
    "start": "1348559",
    "end": "1355039"
  },
  {
    "text": "that's the scary part the middle boxes drop the knowledge the drop the",
    "start": "1355039",
    "end": "1361039"
  },
  {
    "text": "knowledge about the existence of this TCP connection but the peers are not aware it's not it's not like the the",
    "start": "1361039",
    "end": "1368120"
  },
  {
    "text": "middle boxes will will will send the fin or something like that no they will",
    "start": "1368120",
    "end": "1373960"
  },
  {
    "text": "discover later right they will send this store message",
    "start": "1373960",
    "end": "1379240"
  },
  {
    "text": "only to find out that it will never reach and as a result the connection will break as a result the file will be",
    "start": "1379240",
    "end": "1385960"
  },
  {
    "text": "lost and all and you just losted 10 minutes uploading a",
    "start": "1385960",
    "end": "1391600"
  },
  {
    "text": "40gb file 10 minutes I know it could be could be more than that but yeah I'm",
    "start": "1391600",
    "end": "1397559"
  },
  {
    "text": "just thring guys but yeah that's bad that is",
    "start": "1397559",
    "end": "1405000"
  },
  {
    "text": "why uh keep alive is is really you you have to take it with a grand Sal if you",
    "start": "1405000",
    "end": "1410360"
  },
  {
    "text": "want to use the keep alive uh option on the TCP stack and we still didn't talk",
    "start": "1410360",
    "end": "1415679"
  },
  {
    "text": "about HTTP was going to talk about a little bit yeah yeah the whole internet thing",
    "start": "1415679",
    "end": "1421520"
  },
  {
    "text": "Man it you can see the chaos it's like nobody's following any rules everybody's",
    "start": "1421520",
    "end": "1427039"
  },
  {
    "text": "just doing their own thing really that's this is the thing that I that I am",
    "start": "1427039",
    "end": "1432559"
  },
  {
    "text": "recently trying to uh come to understand that nobody's a really following any",
    "start": "1432559",
    "end": "1439120"
  },
  {
    "text": "rules just everybody's doing whatever they want right and and and groups don't",
    "start": "1439120",
    "end": "1444760"
  },
  {
    "text": "talk to each other these RFC groups nobody talks to each other right perfect example is the is the delayed",
    "start": "1444760",
    "end": "1451400"
  },
  {
    "text": "acknowledgement versus Nigel's algorithm both groups worked in isolation and came",
    "start": "1451400",
    "end": "1456640"
  },
  {
    "text": "up with two beautiful algorithms that are works perfectly in isolation but when",
    "start": "1456640",
    "end": "1462919"
  },
  {
    "text": "they when you turn them back on together they are terrible they break the whole the whole",
    "start": "1462919",
    "end": "1470039"
  },
  {
    "text": "internet effectively but that was that is a tale for another",
    "start": "1470039",
    "end": "1475679"
  },
  {
    "text": "podcast but this tells me this this how how the vendors have their mind of their",
    "start": "1475679",
    "end": "1481720"
  },
  {
    "text": "own they don't follow the rfc's and even if they do the RFC is not are not perfect obviously",
    "start": "1481720",
    "end": "1489240"
  },
  {
    "text": "right you can always find holes and updates or no yeah so at the end of the",
    "start": "1489240",
    "end": "1494799"
  },
  {
    "text": "day I just I guess trust yourself right that's that's the that's what I'm trying",
    "start": "1494799",
    "end": "1500799"
  },
  {
    "start": "1500000",
    "end": "1800000"
  },
  {
    "text": "to understand now so let's jump to http so we talked about keep alive and the",
    "start": "1500799",
    "end": "1506520"
  },
  {
    "text": "TCP the middle boxes and stuff like that and uh the HTTP specifically and that is",
    "start": "1506520",
    "end": "1516679"
  },
  {
    "text": "by Design it's a request response model that's how HTTP was built it was built as a stateless unlike the TCP TCP was",
    "start": "1516679",
    "end": "1524799"
  },
  {
    "text": "picked as a transport layer to transort the content I would send a request the",
    "start": "1524799",
    "end": "1531440"
  },
  {
    "text": "server will receive the request TR interpret the request the HTTP request",
    "start": "1531440",
    "end": "1537559"
  },
  {
    "text": "which is get post whatever understand process the request on the back end and",
    "start": "1537559",
    "end": "1543200"
  },
  {
    "text": "then send back a response and once you're done you close the TCP connection",
    "start": "1543200",
    "end": "1549120"
  },
  {
    "text": "that was the design the initial HTTP design it's a request response you send a request you process and then you're",
    "start": "1549120",
    "end": "1556880"
  },
  {
    "text": "done and then you have to close the connection because we want to keep things stateless right because it's a",
    "start": "1556880",
    "end": "1562679"
  },
  {
    "text": "stat hey close the connection we don't we don't really keep any R res you on the back end about a knowledge that",
    "start": "1562679",
    "end": "1570440"
  },
  {
    "text": "needs that things need to exist for me the the next time I make a request right so we close",
    "start": "1570440",
    "end": "1577600"
  },
  {
    "text": "everything that turned out to be the worst decision we ever made when",
    "start": "1577600",
    "end": "1582960"
  },
  {
    "text": "HTTP right because imagine a website that has like uh I don't know 100 CSV C",
    "start": "1582960",
    "end": "1591799"
  },
  {
    "text": "what do you call these things CS CSS files javascripts and and then in recent",
    "start": "1591799",
    "end": "1597640"
  },
  {
    "text": "days like there's tailwind and balewind and and I don't know react does its own",
    "start": "1597640",
    "end": "1603120"
  },
  {
    "text": "packages and stuff like that there's so much stuff to download right so much stuff and if you're if you're sending",
    "start": "1603120",
    "end": "1610039"
  },
  {
    "text": "all this FL of request and you're opening and closing TCP connection with",
    "start": "1610039",
    "end": "1615360"
  },
  {
    "text": "every one of the the the internet will just collab right and and probably not",
    "start": "1615360",
    "end": "1621279"
  },
  {
    "text": "but you your your your performance will suffer right that's why keep alive was",
    "start": "1621279",
    "end": "1629159"
  },
  {
    "text": "was invented was brought up in the HTTP stack as a hitter so say",
    "start": "1629159",
    "end": "1638039"
  },
  {
    "text": "okay I'm sending you a request and here's a hter called connection and I want you to keep the",
    "start": "1638039",
    "end": "1645279"
  },
  {
    "text": "connection that are we just created alive because this is not the first",
    "start": "1645279",
    "end": "1652000"
  },
  {
    "text": "request or the last one I'm going to send I'm going to send you a bunch of them so the the server receives that and",
    "start": "1652000",
    "end": "1661240"
  },
  {
    "text": "okay you want to keep a connection alive I'm going to I'm not going to close it okay when I respond I'm going to keep it",
    "start": "1661240",
    "end": "1667279"
  },
  {
    "text": "alive now as long as you send the on on the data on the same",
    "start": "1667279",
    "end": "1673159"
  },
  {
    "text": "socket the the the the server will receive it on the same socket as well",
    "start": "1673159",
    "end": "1679200"
  },
  {
    "text": "right so there is no additional overhead of me reestablishing the connection",
    "start": "1679200",
    "end": "1684399"
  },
  {
    "text": "which is the three-way handshake as a result we're happy now this keep alive",
    "start": "1684399",
    "end": "1689440"
  },
  {
    "text": "is different than the TCP keep alive if you think about it right because the TCP keep alive was there is",
    "start": "1689440",
    "end": "1696960"
  },
  {
    "text": "an active thing that we have to kind of send to keep it alive right the the TTP",
    "start": "1696960",
    "end": "1702640"
  },
  {
    "text": "belov it was our fault in the spec we said close the connection on the server",
    "start": "1702640",
    "end": "1708480"
  },
  {
    "text": "we said after a request is fulfilled what was this word",
    "start": "1708480",
    "end": "1713760"
  },
  {
    "text": "fulfilled respond close the connection we want a free memory because memory is precious",
    "start": "1713760",
    "end": "1720640"
  },
  {
    "text": "in the '90s was still is so we have plenty of R now",
    "start": "1720640",
    "end": "1726240"
  },
  {
    "text": "keep this alive because I'm sending a lot of stuff so it it really boosted our",
    "start": "1726240",
    "end": "1732000"
  },
  {
    "text": "our performance and uh as a result now this is the default even if you don't tell me",
    "start": "1732000",
    "end": "1738120"
  },
  {
    "text": "to keep it alive I'm going to keep it alive babes I'm going to keep this Alive",
    "start": "1738120",
    "end": "1743799"
  },
  {
    "text": "Now some questions and this is when I started making my engine X course it's like yeah engine X is so they're",
    "start": "1743799",
    "end": "1752880"
  },
  {
    "text": "right they have uh they ask this question in J says",
    "start": "1752880",
    "end": "1760039"
  },
  {
    "text": "okay you asked me to keep the connection alive for how long you got to tell me I can't keep it",
    "start": "1760039",
    "end": "1767840"
  },
  {
    "text": "for whatever do I keep it alive until you're what you have to tell",
    "start": "1767840",
    "end": "1773799"
  },
  {
    "text": "me so there is no HTTP",
    "start": "1773799",
    "end": "1779200"
  },
  {
    "text": "header that is sent from the client to the",
    "start": "1779200",
    "end": "1785000"
  },
  {
    "text": "server right from the client to the server that tells the server to keep the connection Al for x amount of time there",
    "start": "1785000",
    "end": "1790799"
  },
  {
    "text": "it doesn't exist right so the must be a server backend configuration that says",
    "start": "1790799",
    "end": "1797159"
  },
  {
    "text": "okay if I receive a keep alive request I'm going to keep alive connection for 60 seconds for example that's that's the",
    "start": "1797159",
    "end": "1803640"
  },
  {
    "start": "1800000",
    "end": "2083000"
  },
  {
    "text": "default you can pick right and you can change that right we're going to come to why now we want this to be configurable",
    "start": "1803640",
    "end": "1810720"
  },
  {
    "text": "you can make it 120 300 a year right but there's another timeout that you can",
    "start": "1810720",
    "end": "1817480"
  },
  {
    "text": "also configure on the response you can the server can tell the",
    "start": "1817480",
    "end": "1823519"
  },
  {
    "text": "client hey I want you to keep the connection for x amount of seconds so",
    "start": "1823519",
    "end": "1830720"
  },
  {
    "text": "the server actually tells the client how long you can keep the connection and this timeout could be different for some",
    "start": "1830720",
    "end": "1838039"
  },
  {
    "text": "reason right according to enginex the server keep alive timeout can be different than the client",
    "start": "1838039",
    "end": "1846799"
  },
  {
    "text": "keep a life Dem so the question now remains why would I change the default",
    "start": "1846799",
    "end": "1852840"
  },
  {
    "text": "keep lifetime what would be a nice configuration here if you keep that",
    "start": "1852840",
    "end": "1860519"
  },
  {
    "text": "timeout high again it's a server side configuration if you keep it",
    "start": "1860519",
    "end": "1867159"
  },
  {
    "text": "high then there chances that request",
    "start": "1867159",
    "end": "1873200"
  },
  {
    "text": "that needs to be established on the same connection will Thrive even in case of a",
    "start": "1873200",
    "end": "1878440"
  },
  {
    "text": "delay of or idleness right if there is an idleness of both a client or the server side the connection will be",
    "start": "1878440",
    "end": "1884399"
  },
  {
    "text": "client and then the last second oh the the user did another thing I I can reuse the existing connection and I can send",
    "start": "1884399",
    "end": "1892000"
  },
  {
    "text": "some content to it right and when you do that they just used it so I'm going to keep it alive for another 60 second all",
    "start": "1892000",
    "end": "1899279"
  },
  {
    "text": "right so the there is no additional cost of free establishing a TCP",
    "start": "1899279",
    "end": "1905880"
  },
  {
    "text": "connection right on the other hand keeping the connection alive for too",
    "start": "1905880",
    "end": "1912639"
  },
  {
    "text": "long will stack up a bunch of connections on your back end",
    "start": "1912639",
    "end": "1918880"
  },
  {
    "text": "that may or may not be used and as a result again we talked about that a little bit the file descriptor size is",
    "start": "1918880",
    "end": "1924679"
  },
  {
    "text": "not that big but if your enginex is in API Gateway for example and it just",
    "start": "1924679",
    "end": "1931200"
  },
  {
    "text": "receives a flux of request millions of TCP connection it matters few kilobytes",
    "start": "1931200",
    "end": "1937960"
  },
  {
    "text": "it adds up plus the management the process that manages these millions of",
    "start": "1937960",
    "end": "1944039"
  },
  {
    "text": "connection also need to do more work managing a million connection is",
    "start": "1944039",
    "end": "1949840"
  },
  {
    "text": "definitely cost less than managing 500 million connection that's",
    "start": "1949840",
    "end": "1956159"
  },
  {
    "text": "just by Logic right you need to more work to manage these connections management means I have to have pointers",
    "start": "1956159",
    "end": "1962840"
  },
  {
    "text": "and these pointers have sizes to these connections right all all of these small",
    "start": "1962840",
    "end": "1968399"
  },
  {
    "text": "nitty-gritty things that we never thought think about in the back end matter and as a",
    "start": "1968399",
    "end": "1974279"
  },
  {
    "text": "result you have to TW tweak this keep alive and there there is no single timeout that",
    "start": "1974279",
    "end": "1980720"
  },
  {
    "text": "works there is no single timeout that say oh this is the best one no it",
    "start": "1980720",
    "end": "1986159"
  },
  {
    "text": "depends on your use case I know people hate that word but it does it does",
    "start": "1986159",
    "end": "1991880"
  },
  {
    "text": "depend on where use case is what are you doing keeping the connection alive you",
    "start": "1991880",
    "end": "1997240"
  },
  {
    "text": "can keep it for one second and go to the old model where every connection is closed and reopen it's your fault right",
    "start": "1997240",
    "end": "2005519"
  },
  {
    "text": "or you can you can uh uh you can go to the model where every uh you can keep it",
    "start": "2005519",
    "end": "2014000"
  },
  {
    "text": "alive as long as you want right but then in case of idleness then you're going to suffer of these the cost of managing",
    "start": "2014000",
    "end": "2021440"
  },
  {
    "text": "these idle connections this is obviously an addition to the same thing middle boxes keeping the connection alive even",
    "start": "2021440",
    "end": "2028240"
  },
  {
    "text": "for 60c in the middle boxes is challenging because how do you do that if you're",
    "start": "2028240",
    "end": "2034200"
  },
  {
    "text": "Idol what are you going to do are you going to send empty keep alive messages and we just discover the middle boxes I",
    "start": "2034200",
    "end": "2040200"
  },
  {
    "text": "ignore them so there must be a lot of fallback and I bet you the complexity of",
    "start": "2040200",
    "end": "2046000"
  },
  {
    "text": "the code of the client and the server site will show this complexity because this connection can die at any time you",
    "start": "2046000",
    "end": "2052079"
  },
  {
    "text": "canot trust anything that's why be stateless hey can one connection died I don't care I'm going to use another one",
    "start": "2052079",
    "end": "2059200"
  },
  {
    "text": "because I'm not married to one TCP connection right and with multipath TCP",
    "start": "2059200",
    "end": "2065878"
  },
  {
    "text": "that's going to also change right the whole thing is abstracted away the beauty of all things so that was a very",
    "start": "2065879",
    "end": "2072200"
  },
  {
    "text": "long episode talking about keep alive huh guys hope you enjoyed this episode",
    "start": "2072200",
    "end": "2078358"
  },
  {
    "text": "I'm going to see you in the next one you guys stay awesome goodbye this",
    "start": "2078359",
    "end": "2083878"
  }
]