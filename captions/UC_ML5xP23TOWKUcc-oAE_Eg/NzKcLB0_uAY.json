[
  {
    "text": "welcome to another episode of div tooled them all this is the series where we go through popular websites and apps uh and",
    "start": "0",
    "end": "8960"
  },
  {
    "text": "look through devtools and see how the web app of the version of this website",
    "start": "8960",
    "end": "14799"
  },
  {
    "text": "is actually working like what kind of requests are being made uh what kind of protocol the backing uses uh what kind",
    "start": "14799",
    "end": "21520"
  },
  {
    "text": "of security mechanisms that are applied by this back end and very very",
    "start": "21520",
    "end": "27439"
  },
  {
    "text": "interesting things show up when we do this we did this for tick tock we did this for instagram we did this for apple",
    "start": "27439",
    "end": "34239"
  },
  {
    "text": "website reddit and many many others and today we're going to have tool spotify",
    "start": "34239",
    "end": "40800"
  },
  {
    "text": "especially that they recently started supporting the video version",
    "start": "40800",
    "end": "45840"
  },
  {
    "text": "i think it will be very interesting to go through that how about we jump into it so as usual we",
    "start": "45840",
    "end": "51120"
  },
  {
    "text": "start with spotify.com and we hit enter and then we just",
    "start": "51120",
    "end": "57120"
  },
  {
    "text": "watch the graph here let's start with that look at that look",
    "start": "57120",
    "end": "62160"
  },
  {
    "text": "at the waterfall here exactly every time you guys see this purple and orange and",
    "start": "62160",
    "end": "69439"
  },
  {
    "text": "this kind of greenish color bluish that indicates",
    "start": "69439",
    "end": "74560"
  },
  {
    "text": "there is a tcp connection that has been opened not necessarily could be quick case of hdb3 but most of the time when",
    "start": "74560",
    "end": "81439"
  },
  {
    "text": "you see this that means there is a new connection that being open and when you see this many that's an indication that",
    "start": "81439",
    "end": "88720"
  },
  {
    "text": "this website visits a lot of other domains and also",
    "start": "88720",
    "end": "94400"
  },
  {
    "text": "either that or this website uses http one one which requires obviously multiple connections",
    "start": "94400",
    "end": "100960"
  },
  {
    "text": "in order to support uh parallel requests effectively instead of rescinding your quest then wait for",
    "start": "100960",
    "end": "107600"
  },
  {
    "text": "it uh we know this is http 2 http3 solve this problem and but this is it basically what if you",
    "start": "107600",
    "end": "114880"
  },
  {
    "text": "if we just take a look at this this is expensive you know opening these connections uh effectively obviously",
    "start": "114880",
    "end": "121600"
  },
  {
    "text": "drain your battery it's not a problem in my case here because i have a laptop but",
    "start": "121600",
    "end": "126640"
  },
  {
    "text": "effectively there's a lot of resource consumption a lot of power you know that need requires to do that and also",
    "start": "126640",
    "end": "134640"
  },
  {
    "text": "network bandwidth wise you're consuming a lot of stuff and obviously performance",
    "start": "134640",
    "end": "139760"
  },
  {
    "text": "establishing this tcp connection takes time so if i go to security right and then just do this again i'm",
    "start": "139760",
    "end": "147120"
  },
  {
    "text": "going to do this again while the security tab is active and just watch all these domains look at all this stuff",
    "start": "147120",
    "end": "156959"
  },
  {
    "text": "right do you know what this means this means that spotify want to as much",
    "start": "156959",
    "end": "162239"
  },
  {
    "text": "as possible try to find any hint to track you effectively right so it",
    "start": "162239",
    "end": "169200"
  },
  {
    "text": "sends requests to google google optimize static pages you know",
    "start": "169200",
    "end": "174480"
  },
  {
    "text": "it talks to twitter right uh it talks to send requests to facebook instagram even",
    "start": "174480",
    "end": "183040"
  },
  {
    "text": "snapchat so in case that you uh pinterest quarterly i don't even know",
    "start": "183040",
    "end": "188640"
  },
  {
    "text": "what that is facebook that means any chance do you have if you have",
    "start": "188640",
    "end": "195519"
  },
  {
    "text": "logged in into any of these websites because this request is called a third",
    "start": "195519",
    "end": "201440"
  },
  {
    "text": "party request that means it's not the domain that you're currently visiting",
    "start": "201440",
    "end": "206640"
  },
  {
    "text": "uh chrome in this particular case will send those third-party cookies",
    "start": "206640",
    "end": "214640"
  },
  {
    "text": "right because now you're visiting another website but the cookies that you have used to log in which identifies you",
    "start": "214640",
    "end": "221200"
  },
  {
    "text": "obviously will be send will this requires with this request if uh that",
    "start": "221200",
    "end": "226560"
  },
  {
    "text": "means spotify will be notified that hey by the way this guy logged into snapchat and this is some information about him",
    "start": "226560",
    "end": "232480"
  },
  {
    "text": "uh this guy not linked to facebook this is some information about them and and as much as possible any time in the",
    "start": "232480",
    "end": "238319"
  },
  {
    "text": "future that you are attacked with a spotify this will feed into the recommendation engine and will be shared",
    "start": "238319",
    "end": "245519"
  },
  {
    "text": "to snapchat will be shared to google it will be shared to everybody else effectively right this is the state of",
    "start": "245519",
    "end": "251519"
  },
  {
    "text": "the art if you wouldn't call it that right that's why a lot of people don't like",
    "start": "251519",
    "end": "256959"
  },
  {
    "text": "their party cookies you can basically disable that if you want but with that said i'm gonna do it one more time now",
    "start": "256959",
    "end": "264000"
  },
  {
    "text": "but now i'm gonna clear everything i'm gonna hit spotify.com and",
    "start": "264000",
    "end": "269520"
  },
  {
    "text": "let's just watch and this time obviously we don't get the connection because it was cached so how about we actually open",
    "start": "269520",
    "end": "275919"
  },
  {
    "text": "another browser tab and do it again closing everything else so we",
    "start": "275919",
    "end": "282560"
  },
  {
    "text": "get this beautiful connections again right let's do it again boom",
    "start": "282560",
    "end": "290720"
  },
  {
    "text": "all right look at all this stuff hey all right so look at that",
    "start": "290720",
    "end": "296400"
  },
  {
    "text": "despite me closing the tab and reopening a brand new one chrome reused an existing connection it",
    "start": "296400",
    "end": "302800"
  },
  {
    "text": "didn't open a new connection that tells me that when you close a tab chrome holds on",
    "start": "302800",
    "end": "309680"
  },
  {
    "text": "these connections for a little longer before destroying them it might be an",
    "start": "309680",
    "end": "314880"
  },
  {
    "text": "optimization that this the team have made effectively so hey let's not close this connection maybe maybe this user",
    "start": "314880",
    "end": "320720"
  },
  {
    "text": "will visit the site again keep them around effectively that that explained that hey we took us",
    "start": "320720",
    "end": "327199"
  },
  {
    "text": "literally it took us 0.25 to start the connection basically the connection once started effectively right",
    "start": "327199",
    "end": "334479"
  },
  {
    "text": "but what i've done many many times going through the waterfall so i'm not going to go there but but i want you",
    "start": "334479",
    "end": "340479"
  },
  {
    "text": "just to see this interesting thing here if i click on spotify",
    "start": "340479",
    "end": "346080"
  },
  {
    "text": "right if you notice i didn't specify the protocol that means hsts right http strict transport security",
    "start": "346320",
    "end": "353360"
  },
  {
    "text": "kicks in and says hey spotify.com is actually a site that supports",
    "start": "353360",
    "end": "359360"
  },
  {
    "text": "uh https by default so i'm gonna assume that first which is which is something very good right you want the first",
    "start": "359360",
    "end": "365759"
  },
  {
    "text": "request to be encrypted but but look at that we've seen this pattern many times",
    "start": "365759",
    "end": "371280"
  },
  {
    "text": "in almost any website it says hey by the way wrong place go",
    "start": "371280",
    "end": "376880"
  },
  {
    "text": "to www.spotify.com instead right and envoy is",
    "start": "376880",
    "end": "383840"
  },
  {
    "text": "the proxy being used here right apparently obviously this could be faked right you",
    "start": "383840",
    "end": "389680"
  },
  {
    "text": "cannot rely on it but give you an idea why would they lie that it's envoy they might what they want you to think it's",
    "start": "389680",
    "end": "395360"
  },
  {
    "text": "involved well it's not and uh obviously it says veya that means hey",
    "start": "395360",
    "end": "400560"
  },
  {
    "text": "it went to envoy as the final destination which which is you cannot trust that because invoice actually a",
    "start": "400560",
    "end": "406400"
  },
  {
    "text": "proxy is not a http server that means it turned around and did some some more stuff right but it went",
    "start": "406400",
    "end": "413520"
  },
  {
    "text": "through another thing called http 2 edge proxy google proxy again",
    "start": "413520",
    "end": "418720"
  },
  {
    "text": "but yeah go and go to ww so this is exactly what our browser did it went to",
    "start": "418720",
    "end": "424479"
  },
  {
    "text": "ww which then says hey 302 anything 3x is basically a redirect right again",
    "start": "424479",
    "end": "431039"
  },
  {
    "text": "redirect to where so this is not the place we we established a connection we",
    "start": "431039",
    "end": "438080"
  },
  {
    "text": "established the tls and we sent a request only to get a redirect where are",
    "start": "438080",
    "end": "443280"
  },
  {
    "text": "we redirected to again this is the second redirect go oh",
    "start": "443280",
    "end": "448400"
  },
  {
    "text": "by the way never mind this guy or gal is from the us so",
    "start": "448400",
    "end": "453520"
  },
  {
    "text": "redirect to this u.s location do you think that they had this",
    "start": "453520",
    "end": "458880"
  },
  {
    "text": "knowledge at this point i believe they do because they have my iprs again i'm using a vpn just to hide if my ip i just",
    "start": "458880",
    "end": "465919"
  },
  {
    "text": "showed up here while i show stuff but i i set my vpn to to effectively los",
    "start": "465919",
    "end": "471680"
  },
  {
    "text": "angeles right so it did detect that this is effectively uh in the us so it",
    "start": "471680",
    "end": "477039"
  },
  {
    "text": "will go and redirect to the u.s version of that but it could have done it in the previous",
    "start": "477039",
    "end": "482960"
  },
  {
    "text": "uh link right again i know i'm nitpicking but that's the job right this is our job we",
    "start": "482960",
    "end": "488800"
  },
  {
    "text": "have to nitpick over this we're just a bunch of armchair engineers here we just we just pointed saying nah that is bad",
    "start": "488800",
    "end": "495680"
  },
  {
    "text": "this is good right here's the thing 307 another redirect it's called temporary direct where where",
    "start": "495680",
    "end": "502800"
  },
  {
    "text": "am i getting redirected from or to again redirect to this location",
    "start": "502800",
    "end": "509520"
  },
  {
    "text": "spotify.open.specifier.com which will be the final thing effectively right again we're being",
    "start": "509520",
    "end": "514880"
  },
  {
    "text": "served from envoy and some session id some some more metadata about me and i",
    "start": "514880",
    "end": "521440"
  },
  {
    "text": "wanted to know that the cookies worsened because i have logged in yeah despite this is incognito but i have already",
    "start": "521440",
    "end": "528560"
  },
  {
    "text": "previously logged in because the spotify requires you to log into browse stuff so i have locked in here",
    "start": "528560",
    "end": "535680"
  },
  {
    "text": "that request again another redirect look at this guys how many",
    "start": "535680",
    "end": "542399"
  },
  {
    "text": "redirects have we done but this the most interesting thing here is actually this is bad",
    "start": "542399",
    "end": "549360"
  },
  {
    "text": "this is bad this asked us to redirect to http",
    "start": "549360",
    "end": "554880"
  },
  {
    "text": "a plane so it can be intercepted and changed because if it's unencrypted then the",
    "start": "554880",
    "end": "562080"
  },
  {
    "text": "browser will respect the protocol right says hey you want me to go to http i will go to http and it did it go to it",
    "start": "562080",
    "end": "568560"
  },
  {
    "text": "went to http openstartify.com only to get redirected",
    "start": "568560",
    "end": "573920"
  },
  {
    "text": "again to what another unencrypted",
    "start": "573920",
    "end": "579040"
  },
  {
    "text": "link so you notice this redirect hell that you're going just because you went to spotify.com",
    "start": "579040",
    "end": "584959"
  },
  {
    "text": "you know this tells me that either people don't care anymore says hey yeah it's a bunch of the redirect we have",
    "start": "584959",
    "end": "591200"
  },
  {
    "text": "fast stuff so who cares but as an engineer i really care about these",
    "start": "591200",
    "end": "596560"
  },
  {
    "text": "small things you know it makes you think that you you understand what the site is doing and",
    "start": "596560",
    "end": "602079"
  },
  {
    "text": "this many redirects that means either spotify don't have control over this many system where they can effectively",
    "start": "602079",
    "end": "609680"
  },
  {
    "text": "do it in an efficient manner or basically it's not important enough to fix and which i believe it's the",
    "start": "609680",
    "end": "615600"
  },
  {
    "text": "latter it's not important to fix but this is really bad redirecting to an unencrypted thing that",
    "start": "615600",
    "end": "621920"
  },
  {
    "text": "means someone can effectively uh effectively know that right but this is",
    "start": "621920",
    "end": "628800"
  },
  {
    "text": "it so now go ahead and redirect so we want that redirect to this",
    "start": "628800",
    "end": "634560"
  },
  {
    "text": "which we sent the request this is a plain text that explained that we actually got the description here",
    "start": "634560",
    "end": "640959"
  },
  {
    "text": "because this is http one one let's let's actually see http11 htm1 doesn't always",
    "start": "640959",
    "end": "648079"
  },
  {
    "text": "mean that it's unencrypted but unencrypted http request must be on http1 right",
    "start": "648079",
    "end": "656880"
  },
  {
    "text": "that's just the fact these days and i talked about this why as why i talked about it many times and mentioned if",
    "start": "656880",
    "end": "662480"
  },
  {
    "text": "you're interested i can i can talk more about that it's basically something called protocol ossification",
    "start": "662480",
    "end": "668720"
  },
  {
    "text": "so now we want again but hey this time actually that final redirect the browser",
    "start": "668720",
    "end": "674800"
  },
  {
    "text": "said wait a minute no i'm going to go to https this time i'm going to establish a new connection to spotify.com and then",
    "start": "674800",
    "end": "680720"
  },
  {
    "text": "i'm going to send it over https right so now we sent it over securely now",
    "start": "680720",
    "end": "687360"
  },
  {
    "text": "this is really bad because now my cookies did my cook did they send my cookies over http",
    "start": "687360",
    "end": "693519"
  },
  {
    "text": "they did not okay that's good that would be a disaster if they sent my cookie across an uh unencrypted",
    "start": "693519",
    "end": "699680"
  },
  {
    "text": "connection and that's good right that's by default because now most",
    "start": "699680",
    "end": "705120"
  },
  {
    "text": "cookies have an attribute called secure which means hey don't send the cookie",
    "start": "705120",
    "end": "711279"
  },
  {
    "text": "unless the connection is secure right and this is part of the same site our re-architecture of the whole thing",
    "start": "711279",
    "end": "718000"
  },
  {
    "text": "cookies right all right so now that's that's the request right now followed by",
    "start": "718000",
    "end": "725279"
  },
  {
    "text": "a css for our web player and a bunch of phones",
    "start": "725279",
    "end": "731519"
  },
  {
    "text": "let's look at the fonts the fonts are served from the service worker which is i think a bit like a",
    "start": "731519",
    "end": "737920"
  },
  {
    "text": "fancy proxy that is local to you right and i really wish there is a way to",
    "start": "737920",
    "end": "743279"
  },
  {
    "text": "disable the service worker i don't know guys if you know but it just hides a lot of stuff from me right i want to see",
    "start": "743279",
    "end": "750160"
  },
  {
    "text": "what is what's the service workers doing but i don't know how but yeah effectively effectively this is",
    "start": "750160",
    "end": "755440"
  },
  {
    "text": "this is going to the service worker right that's why when you go to spotify.com chrome's asking you do you want to install the app version",
    "start": "755440",
    "end": "761920"
  },
  {
    "text": "the progressive web app right but yeah it's doing hdb11 because i",
    "start": "761920",
    "end": "767760"
  },
  {
    "text": "believe the connection locally between the client browser and the service",
    "start": "767760",
    "end": "773360"
  },
  {
    "text": "workers always http 101 there's no point right so we're downloading three fonts",
    "start": "773360",
    "end": "778959"
  },
  {
    "text": "all right see serve from the service worker who cares all right a bunch of javascript again the web player",
    "start": "778959",
    "end": "786800"
  },
  {
    "text": "which we're going to use to play this beautiful stuff that we're going to see soon",
    "start": "786800",
    "end": "792480"
  },
  {
    "text": "as some other javascript that i don't care about a failure says too many requests",
    "start": "792480",
    "end": "798639"
  },
  {
    "text": "what did i do why is that why does it say too many requests again another quest request going on here and uh let's",
    "start": "798639",
    "end": "806959"
  },
  {
    "text": "take a look at the page so we noticed that i got served some podcasts that i'm",
    "start": "806959",
    "end": "812079"
  },
  {
    "text": "not subscribed this is again this is a temporary account that i created so i'm not subscribed to any podcast but i got",
    "start": "812079",
    "end": "817760"
  },
  {
    "text": "some recommendation how they probably tried as much as possible to identify me how",
    "start": "817760",
    "end": "824639"
  },
  {
    "text": "you might think there is a request called me here so when you go a request says slash",
    "start": "824639",
    "end": "830639"
  },
  {
    "text": "me right the preview look at this and it's fine to show this that's",
    "start": "830639",
    "end": "837680"
  },
  {
    "text": "absolutely fine this is my email which is already public most of you send me emails right it's my email it's my",
    "start": "837680",
    "end": "843040"
  },
  {
    "text": "birthday right i'll turn 23 this uh this march i'm so excited uh to",
    "start": "843040",
    "end": "851680"
  },
  {
    "text": "i'll finish college soon so i'm really excited there there's my email spotify some blah blah",
    "start": "851680",
    "end": "857600"
  },
  {
    "text": "blah some more information right so that's that's that's this request is used basically to uh to",
    "start": "857600",
    "end": "864160"
  },
  {
    "text": "uh uh to identify who are you and the flow followers i don't have any external",
    "start": "864160",
    "end": "869279"
  },
  {
    "text": "any information about you will be there effectively right",
    "start": "869279",
    "end": "874639"
  },
  {
    "text": "and then webworker the more events events basically is is the request that",
    "start": "874639",
    "end": "880880"
  },
  {
    "text": "i noticed to track you another query to me this is another",
    "start": "880880",
    "end": "886480"
  },
  {
    "text": "thing that isn't really inefficient you ask the question once why on the hill are you asking him many times right one",
    "start": "886480",
    "end": "893360"
  },
  {
    "text": "is enough right and usually this is an artifact of",
    "start": "893360",
    "end": "898480"
  },
  {
    "text": "a code that has been a function that you call in javascript",
    "start": "898480",
    "end": "904079"
  },
  {
    "text": "and you don't know what is it doing yeah you call a function to get you something and you call it in a loop for example",
    "start": "904079",
    "end": "910240"
  },
  {
    "text": "and you don't know that this function actually calls in some rest endpoint right to get you some information so if",
    "start": "910240",
    "end": "916560"
  },
  {
    "text": "you call it you notice that you were making these requests without actually looking at this you will notice that",
    "start": "916560",
    "end": "922240"
  },
  {
    "text": "this mirror cost is being executed over and over again which we know notice here all right so this is what is most",
    "start": "922240",
    "end": "929600"
  },
  {
    "text": "interesting the personalized recommendation call and personal recommendation we notice that",
    "start": "929600",
    "end": "937759"
  },
  {
    "text": "the options and there is the actual call notice that the actual",
    "start": "937759",
    "end": "944320"
  },
  {
    "text": "call to get request is before the option but if you look at the waterfall do you",
    "start": "944320",
    "end": "950880"
  },
  {
    "text": "see this this white line this means that this request has been stalled",
    "start": "950880",
    "end": "957680"
  },
  {
    "text": "for x amount of seconds until the actual option",
    "start": "957680",
    "end": "962800"
  },
  {
    "text": "request finish this is part of course so i'm gonna try to send them all in",
    "start": "962800",
    "end": "968560"
  },
  {
    "text": "parallel but this request is actually the get request this is the uh all right let's do it again so this is the get",
    "start": "968560",
    "end": "973759"
  },
  {
    "text": "request but this is the options the preflight option you notice that the git was sent before but it was actually",
    "start": "973759",
    "end": "980800"
  },
  {
    "text": "queued you see this white dot this means stalled and i really man i don't know if",
    "start": "980800",
    "end": "987040"
  },
  {
    "text": "anyone from the chrome team saying why guys why did you remove the legend in",
    "start": "987040",
    "end": "992160"
  },
  {
    "text": "this dialogue you guys had the legend with the colors and they removed it for",
    "start": "992160",
    "end": "997360"
  },
  {
    "text": "some reason how the heck i would know what this color means now right it's just man i don't know who designs these",
    "start": "997360",
    "end": "1004000"
  },
  {
    "text": "things but you guys had a good idea and then you you you made it worse what is this table this table is now ugly i",
    "start": "1004000",
    "end": "1011040"
  },
  {
    "text": "don't know if you go back to my old videos where you actually see the colors hey uh this is the connection star this",
    "start": "1011040",
    "end": "1016639"
  },
  {
    "text": "is purple and this is stalling is white i don't know man sometimes i don't know",
    "start": "1016639",
    "end": "1022639"
  },
  {
    "text": "so personal recommendation regardless so we know that we got the results and let's take a look at the content",
    "start": "1022639",
    "end": "1030880"
  },
  {
    "text": "items what did we get what's the first item what's the first",
    "start": "1030880",
    "end": "1037360"
  },
  {
    "text": "item give me the first item what is this happy hits what is this all right so this is the joe rogan experience right",
    "start": "1037360",
    "end": "1046558"
  },
  {
    "text": "name the joe rogan experience right it was the second item destructive i don't even know is that",
    "start": "1046559",
    "end": "1053200"
  },
  {
    "text": "podcast all right i wish back in engineering sure shows up here that will be awesome man the misfit podcast",
    "start": "1053200",
    "end": "1061520"
  },
  {
    "text": "a bunch of them last podcast network so yeah this is this is this is",
    "start": "1061520",
    "end": "1067520"
  },
  {
    "text": "basically all the recommended stuff and then there's a bunch of other stuff that i don't care about right so this is it",
    "start": "1067520",
    "end": "1074240"
  },
  {
    "text": "you notice that this is extremely inefficient you know there is first reservoir just",
    "start": "1074240",
    "end": "1079520"
  },
  {
    "text": "the idea of tracking which i don't think they have everybody uses spotify at least in the us here right so",
    "start": "1079520",
    "end": "1086960"
  },
  {
    "text": "you want really you're gonna pay anything right",
    "start": "1086960",
    "end": "1092080"
  },
  {
    "text": "to know what are you interested in songwriters or shows wise right and you",
    "start": "1092080",
    "end": "1097520"
  },
  {
    "text": "want to sell this information to pretty much anyone right so if you see us you if you see snapchat here",
    "start": "1097520",
    "end": "1104400"
  },
  {
    "text": "probably snapchat have paid spotify for a little bit of money say hey",
    "start": "1104400",
    "end": "1109760"
  },
  {
    "text": "i want to know what this guy is actually interested in right what this gal what kind of music so that recommendation in",
    "start": "1109760",
    "end": "1115919"
  },
  {
    "text": "snapchat or instagram facebook will be effectively shared based on that if the third party",
    "start": "1115919",
    "end": "1122720"
  },
  {
    "text": "cookies are gone then snapchat the request to go to",
    "start": "1122720",
    "end": "1127840"
  },
  {
    "text": "snapchat here whatever this is right and we can actually filter right snap",
    "start": "1127840",
    "end": "1133840"
  },
  {
    "text": "chat the this is the request to snapchat effectively right this request with this particular id",
    "start": "1133840",
    "end": "1140400"
  },
  {
    "text": "which apparently identifies me that will never send the cookies right",
    "start": "1140400",
    "end": "1146160"
  },
  {
    "text": "now it's not going to send any cookies anyway because i don't i am not logged into snapchat but if i was",
    "start": "1146160",
    "end": "1153360"
  },
  {
    "text": "right in my phone then that will be sent effectively right",
    "start": "1153360",
    "end": "1159360"
  },
  {
    "text": "look at that snapchat uses uh engine x 1.17.3",
    "start": "1159360",
    "end": "1165760"
  },
  {
    "text": "interesting some people always say that this is actually leaking information i would",
    "start": "1165760",
    "end": "1171760"
  },
  {
    "text": "agree that leaking the actual version especially with lock 4g with the disaster that was knowing the exact",
    "start": "1171760",
    "end": "1178720"
  },
  {
    "text": "version is actually a leak effectively all right where else",
    "start": "1178720",
    "end": "1184640"
  },
  {
    "text": "how about we play something let's go to the joe rogan experience and play something for the joe rogan experience you notice that i previously clicked on",
    "start": "1184640",
    "end": "1191760"
  },
  {
    "text": "this episode before that's why it's green and it tells you hey you actually watched it and watched 30 seconds of it",
    "start": "1191760",
    "end": "1199039"
  },
  {
    "text": "and the information is not actually in the browser it's on the server so when i retrieved that",
    "start": "1199039",
    "end": "1204320"
  },
  {
    "text": "it pulled back this information back let's let's let's go through this that's effective let's refresh that and you can",
    "start": "1204320",
    "end": "1210960"
  },
  {
    "text": "see that uh let's remove snapchat you can see we submit the request got",
    "start": "1210960",
    "end": "1218400"
  },
  {
    "text": "the html and then immediately we got all that again we're downloading",
    "start": "1218400",
    "end": "1223520"
  },
  {
    "text": "the web player again and then we're making these requests and the most interesting request that i'm",
    "start": "1223520",
    "end": "1229760"
  },
  {
    "text": "gonna show you here guys is is basically to list the episodes here you notice that this is the this is",
    "start": "1229760",
    "end": "1236320"
  },
  {
    "text": "their mechanism effectively this is something called the query rest endpoint right",
    "start": "1236320",
    "end": "1241520"
  },
  {
    "text": "the query list endpoint effectively takes an operation name so they made it into a like a generic graphql",
    "start": "1241520",
    "end": "1249360"
  },
  {
    "text": "kind of a thing uh by sending everything into the parameters right so the url doesn't",
    "start": "1249360",
    "end": "1254640"
  },
  {
    "text": "change but the operation is what changes so this query says hey query show",
    "start": "1254640",
    "end": "1259840"
  },
  {
    "text": "metadata give me the show's metadata and it will tell you this is the joe rogan experience right",
    "start": "1259840",
    "end": "1267360"
  },
  {
    "text": "this is some metadata about it playability i don't know what's that playable interesting i believe this is",
    "start": "1267360",
    "end": "1272799"
  },
  {
    "text": "whether you can play it or not maybe if it's a premium show you cannot play it uh can can this user play this or not",
    "start": "1272799",
    "end": "1281360"
  },
  {
    "text": "i wonder if you can intercept that and literally change this uh playable to uh to if it was false go",
    "start": "1281360",
    "end": "1288960"
  },
  {
    "text": "change it to true all right i believe you can edit stuff in devtools right can you",
    "start": "1288960",
    "end": "1294080"
  },
  {
    "text": "that would be fantastic just change that into true and then hey you can just unlock stuff",
    "start": "1294080",
    "end": "1301440"
  },
  {
    "text": "right so it gives you some metadata about all that stuff right um",
    "start": "1301440",
    "end": "1306880"
  },
  {
    "text": "but let's go to another query here here's another query operation this time this",
    "start": "1306880",
    "end": "1313360"
  },
  {
    "text": "i want oh my god i want to show you this guys so this is another query that says operation name fitch extracted colors",
    "start": "1313360",
    "end": "1320400"
  },
  {
    "text": "and i was like what the heck what what are we doing with the extracted",
    "start": "1320400",
    "end": "1326320"
  },
  {
    "text": "colors extracted colors what kind of extracted colors it's like and then what is this is this the options oh",
    "start": "1326320",
    "end": "1334159"
  },
  {
    "text": "god ah this was the options never mind let's go to the actual get request where is it there you go i need to find that there",
    "start": "1334159",
    "end": "1340960"
  },
  {
    "text": "you go this is the matching get get request for it and boy yeah it's asking to extract the colors and some of",
    "start": "1340960",
    "end": "1348400"
  },
  {
    "text": "the fronts and engineers probably know this but boy i was i was fascinated by this",
    "start": "1348400",
    "end": "1354320"
  },
  {
    "text": "look at this it gives you the exact colors for that matches this broadcast i",
    "start": "1354320",
    "end": "1361200"
  },
  {
    "text": "believe so they can paint this background so they can take from this",
    "start": "1361200",
    "end": "1367280"
  },
  {
    "text": "image for example and then paint this background i just found this fascinating can you",
    "start": "1367280",
    "end": "1372720"
  },
  {
    "text": "do this in the html page find it just just resolve this on the server side right and then",
    "start": "1372720",
    "end": "1379520"
  },
  {
    "text": "return this as part of the html and make this static",
    "start": "1379520",
    "end": "1385280"
  },
  {
    "text": "right i'm guessing that if if the image changes perhaps then they",
    "start": "1385280",
    "end": "1391440"
  },
  {
    "text": "oh no if the image changes then calculate that again in the server side okay because",
    "start": "1391440",
    "end": "1397360"
  },
  {
    "text": "the image will be cached with that color right okay was it's just another thing",
    "start": "1397360",
    "end": "1402799"
  },
  {
    "text": "that i noticed that is i don't think it's necessary to be honest right query",
    "start": "1402799",
    "end": "1407840"
  },
  {
    "text": "podcast episodes so this is this is it it's basically the list of all the",
    "start": "1407840",
    "end": "1413520"
  },
  {
    "text": "episodes not all of them again we see the offsets right this is basically how the query is working",
    "start": "1413520",
    "end": "1420799"
  },
  {
    "text": "the next offset now here's the thing",
    "start": "1420799",
    "end": "1425440"
  },
  {
    "text": "they are using a number to fetch that tells me they are actually using the",
    "start": "1426559",
    "end": "1432799"
  },
  {
    "text": "offset operator i don't know if they're using sql or not but this is not enough information to give you the next offset",
    "start": "1432799",
    "end": "1440799"
  },
  {
    "text": "right i don't know how they are data modeling this but this will tank",
    "start": "1440799",
    "end": "1446320"
  },
  {
    "text": "the more episodes joe rogan will have a thousand is nothing 10 000 is nothing",
    "start": "1446320",
    "end": "1452480"
  },
  {
    "text": "million yeah then you're gonna start stealing the performance because offset",
    "start": "1452480",
    "end": "1457520"
  },
  {
    "text": "is just effectively bad right you need you need some sort of a unique identifier that says hey i was here last time instagram",
    "start": "1457520",
    "end": "1465760"
  },
  {
    "text": "and tech talk was doing it the optimal way where they effectively tell you exactly hey here's where i was last time",
    "start": "1465760",
    "end": "1473840"
  },
  {
    "text": "right so they sent that but if you send the number hey uh give me the next 50 i watched 50. 50 is relative you don't",
    "start": "1473840",
    "end": "1481440"
  },
  {
    "text": "know how much you will have to basically do offset 50",
    "start": "1481440",
    "end": "1486880"
  },
  {
    "text": "or f600 and offset a thousand and that that's basically causes the queries in",
    "start": "1486880",
    "end": "1492640"
  },
  {
    "text": "the back end to retrieve everything and then go and actually skip 50 or skip a",
    "start": "1492640",
    "end": "1500080"
  },
  {
    "text": "thousand or skip 2 000 and that is obviously very wasteful right i talked about opposite uh many times",
    "start": "1500080",
    "end": "1507440"
  },
  {
    "text": "and this is the episode i don't i don't think we need to do anything more about this but i just",
    "start": "1507440",
    "end": "1513279"
  },
  {
    "text": "found it fascinating they are doing this so let's go ahead and clear this and then and as i scroll you can see that",
    "start": "1513279",
    "end": "1518559"
  },
  {
    "text": "the images are being retrieved these are the images directly from the cdn s cdn",
    "start": "1518559",
    "end": "1525440"
  },
  {
    "text": "i'm pretty tested for spotify and then as we scroll scroll score we must see",
    "start": "1525440",
    "end": "1532000"
  },
  {
    "text": "the next query there you go",
    "start": "1532000",
    "end": "1537679"
  },
  {
    "text": "there's the next query again we're sending this next query",
    "start": "1537679",
    "end": "1544880"
  },
  {
    "text": "uh options followed by this for the life of me i think this is a bug",
    "start": "1544880",
    "end": "1550720"
  },
  {
    "text": "guys but look at this when i send this options why are we",
    "start": "1550720",
    "end": "1556159"
  },
  {
    "text": "always sending options i believe this is a bug in chrome to be honest but look at this we're sending this",
    "start": "1556159",
    "end": "1562480"
  },
  {
    "text": "request and we're telling the client hey client never",
    "start": "1562480",
    "end": "1567919"
  },
  {
    "text": "ask me again for the next 60 000 seconds which is plenty of time if you ask me",
    "start": "1567919",
    "end": "1573919"
  },
  {
    "text": "right so don't ask this qu you can cash that fact but apparently",
    "start": "1573919",
    "end": "1580799"
  },
  {
    "text": "chrome is ignoring that number and is always sending the options regardless hey can i query you can i query you of",
    "start": "1580799",
    "end": "1588480"
  },
  {
    "text": "course you can it's api partner it's the same thing but you notice that we always",
    "start": "1588480",
    "end": "1594640"
  },
  {
    "text": "send the get request it was simply a preflight before they get and i for the life of me i couldn't",
    "start": "1594640",
    "end": "1600559"
  },
  {
    "text": "figure it out why are we doing that to me it just sounds like a bug in",
    "start": "1600559",
    "end": "1605600"
  },
  {
    "text": "chrome right because otherwise this thing this thing the max age that's useless then because",
    "start": "1605600",
    "end": "1612559"
  },
  {
    "text": "it's not being respected hey cash the fact that hey i told you that you're good you can cash that fact",
    "start": "1612559",
    "end": "1619919"
  },
  {
    "text": "so don't ask it again but yeah this is the next query to get the rest of the stuff",
    "start": "1619919",
    "end": "1627200"
  },
  {
    "text": "now we see that the next offset is a hundred and finally guys who which is the most",
    "start": "1627200",
    "end": "1632559"
  },
  {
    "text": "important thing we didn't do is actually play something let's play something scott eastwood sure",
    "start": "1632559",
    "end": "1637919"
  },
  {
    "text": "let's play scott eastwood and we're gonna play and uh yeah",
    "start": "1637919",
    "end": "1644880"
  },
  {
    "text": "we're getting when you play something immediately we we give you a recommendation we try to call a method",
    "start": "1644880",
    "end": "1651600"
  },
  {
    "text": "called gets recommended episodes and we'll say hey because you watch this",
    "start": "1651600",
    "end": "1657440"
  },
  {
    "text": "now these are recommended episodes you can watch this and this i bet i'd be a recommendation from the same show or",
    "start": "1657440",
    "end": "1663919"
  },
  {
    "text": "maybe it's a different show but yeah but uh are we",
    "start": "1663919",
    "end": "1669840"
  },
  {
    "text": "downloading did we start downloading yeah there you go is here's here's a fascinating part",
    "start": "1669840",
    "end": "1675440"
  },
  {
    "text": "this is very very similar playing this video is very very similar to how twitch does it",
    "start": "1675440",
    "end": "1682720"
  },
  {
    "text": "they chop off the episode into webm which is which is a new standard",
    "start": "1682720",
    "end": "1688559"
  },
  {
    "text": "right it's different than the html5 standard and then they just chop it by parts and then download these parts part",
    "start": "1688559",
    "end": "1695039"
  },
  {
    "text": "by part exactly like how twitch does it so you see this request to this akamai",
    "start": "1695039",
    "end": "1702559"
  },
  {
    "text": "so here's one thing we know that spotify uses akamai to save their videos effectively",
    "start": "1702559",
    "end": "1709600"
  },
  {
    "text": "it's fascinating how much you can learn just by looking at the urls dude right so you can see that okay 24 see",
    "start": "1709600",
    "end": "1717360"
  },
  {
    "text": "this see a profile 23 this strategy doesn't change this is always the same for joe rogan right but 24.",
    "start": "1717360",
    "end": "1725440"
  },
  {
    "text": "webm this changes right so if i look at 32 right this is another portion and you",
    "start": "1725440",
    "end": "1732320"
  },
  {
    "text": "can as you as you scroll clear you can see that another request we reach 140.",
    "start": "1732320",
    "end": "1739120"
  },
  {
    "text": "how big are each of these segments there's the size what is the size content length 37",
    "start": "1739120",
    "end": "1746320"
  },
  {
    "text": "kilobyte right well a little compressed video webm that's the type",
    "start": "1746320",
    "end": "1752480"
  },
  {
    "text": "and everyone is e tagged so that is if",
    "start": "1752480",
    "end": "1757840"
  },
  {
    "text": "somehow you reversed and you want to watch certain part again that particular",
    "start": "1757840",
    "end": "1764640"
  },
  {
    "text": "part will be downloaded but it will be cached in your browser effectively so will not it will say hey it didn't",
    "start": "1764640",
    "end": "1771360"
  },
  {
    "text": "change you can just uh use the one you had and amazon request id i'm baffled",
    "start": "1771360",
    "end": "1778080"
  },
  {
    "text": "anymore oh it says what look at that it's on s3",
    "start": "1778080",
    "end": "1784000"
  },
  {
    "text": "okay why does it say akamais.net so okay so i think",
    "start": "1784000",
    "end": "1791039"
  },
  {
    "text": "all right so i think the back end is actually s3 but cdn they're using akamai cdn",
    "start": "1791039",
    "end": "1798640"
  },
  {
    "text": "or maybe akamai is using s s3 that could be it",
    "start": "1798640",
    "end": "1804720"
  },
  {
    "text": "fascinating huh guys how much you learn from this all right guys so this is it basically i wanted to go through a",
    "start": "1804960",
    "end": "1810320"
  },
  {
    "text": "spotify i know there's a little bit longer episode but i think we talked about so much stuff and let me know what",
    "start": "1810320",
    "end": "1815840"
  },
  {
    "text": "you think about in in the comments below i'm gonna see you on the next one you guys stay",
    "start": "1815840",
    "end": "1821600"
  },
  {
    "text": "awesome goodbye",
    "start": "1821600",
    "end": "1825440"
  }
]