[
  {
    "start": "0",
    "end": "48000"
  },
  {
    "text": "envoy is an open source layer 7 proxy and communication bus originally built at lyft to move their",
    "start": "80",
    "end": "6960"
  },
  {
    "text": "architecture away from a monolith into a micro services architecture",
    "start": "6960",
    "end": "12080"
  },
  {
    "text": "in this video i want to discuss invoice proxy i wanna uh talk about the components i wanna talk",
    "start": "12080",
    "end": "18160"
  },
  {
    "text": "about the desire uh architecture that i wanna reach on this course on this video",
    "start": "18160",
    "end": "23840"
  },
  {
    "text": "i wanna talk about the the individual components of envoy and then finally i'm gonna show you a demo",
    "start": "23840",
    "end": "29279"
  },
  {
    "text": "of how envoy actually functioned i'm going to show all sorts of cool stuff guys so stay",
    "start": "29279",
    "end": "36480"
  },
  {
    "text": "tuned and obviously guys you're going to start seeing some youtube chapters where you can jump into the interesting",
    "start": "36480",
    "end": "44239"
  },
  {
    "text": "part of the video you don't have to watch the whole thing but how about we jump into it guys so",
    "start": "44239",
    "end": "49520"
  },
  {
    "start": "48000",
    "end": "180000"
  },
  {
    "text": "guys this is the current architecture that i have today for example i have multiple clients and i have",
    "start": "49520",
    "end": "55440"
  },
  {
    "text": "a single application that is usually it's a monolith right it's running on certain reports",
    "start": "55440",
    "end": "60719"
  },
  {
    "text": "it's running node.js and it's called node right there's a database on the backend what do we use to do",
    "start": "60719",
    "end": "66720"
  },
  {
    "text": "without a proxy without reverse proxy without a load balancer what we used to do is to expose this to the public right so",
    "start": "66720",
    "end": "73200"
  },
  {
    "text": "users will make a good request and get back like a json right and another user will do the same thing",
    "start": "73200",
    "end": "79040"
  },
  {
    "text": "so that's what we have today right but what if i want to spin up multiple versions of this",
    "start": "79040",
    "end": "84159"
  },
  {
    "text": "right the problem with this is how do you expose this back-end application to the client",
    "start": "84159",
    "end": "89520"
  },
  {
    "text": "without uh exposing your internal architecture right so what do you do",
    "start": "89520",
    "end": "94560"
  },
  {
    "text": "like you expect you spin it up on port two two two two and three three three and then you give your client these you can this is called",
    "start": "94560",
    "end": "101600"
  },
  {
    "text": "client side load balancer but today we're going to discuss how envoy can actually fix this",
    "start": "101600",
    "end": "107600"
  },
  {
    "text": "right so one application of invoice is to act as a reverse proxy",
    "start": "107600",
    "end": "112720"
  },
  {
    "text": "it can act as a proxy as well it can act as a service mesh which is basically a",
    "start": "112720",
    "end": "118079"
  },
  {
    "text": "proxy and a reverse proxy at the same time and uh yeah so this is what we're gonna",
    "start": "118079",
    "end": "123680"
  },
  {
    "text": "do we want to spin up multiple backend application put on voluntop we have done so many",
    "start": "123680",
    "end": "129920"
  },
  {
    "text": "similar things in in this channel we talked about we we did with nginx we did it with hf proxy we",
    "start": "129920",
    "end": "135520"
  },
  {
    "text": "did it with traffic right and now we're gonna go to invoice and we're gonna do it with with link rd",
    "start": "135520",
    "end": "140560"
  },
  {
    "text": "pretty much any proxy that exists that's okay we're gonna we're gonna catch them all that's that's the plan of this catch that's the",
    "start": "140560",
    "end": "147280"
  },
  {
    "text": "plan of this channel i'm ash ketchum apparently so the client in this case will make a good request to the invoice",
    "start": "147280",
    "end": "153680"
  },
  {
    "text": "proxy running on https 443 hopefully with h2 http 2 i noticed that envoy doesn't run",
    "start": "153680",
    "end": "159760"
  },
  {
    "text": "http 2 by default so uh i'm going to show you how to configure that right",
    "start": "159760",
    "end": "164800"
  },
  {
    "text": "and we're going to return back adjacent i'm going to get another request there so this might hit the in this node and",
    "start": "164800",
    "end": "171440"
  },
  {
    "text": "get back the result so this will hit the envoy and then hit a completely different node so",
    "start": "171440",
    "end": "177200"
  },
  {
    "text": "does round opening or load balancing between the different backend all right",
    "start": "177200",
    "end": "182480"
  },
  {
    "start": "180000",
    "end": "450000"
  },
  {
    "text": "so let's talk about envoy architecture and and uh compared to traffic and others it's",
    "start": "182480",
    "end": "188000"
  },
  {
    "text": "it's really in the between to me he proxy to me is the simplest to understand",
    "start": "188000",
    "end": "193519"
  },
  {
    "text": "uh nginx is there traffic is the worst when it comes to",
    "start": "193519",
    "end": "198720"
  },
  {
    "text": "concept and abstraction and envoy is lovely i love these",
    "start": "198720",
    "end": "204239"
  },
  {
    "text": "clear there is a reason behind every abstraction there is right and to explain this first of all they",
    "start": "204239",
    "end": "212480"
  },
  {
    "text": "they talk about the downstream and upstream they they try to define what upstream means and what",
    "start": "212480",
    "end": "218239"
  },
  {
    "text": "downstream which if i tell you that you might have different opinions but upstream is basically anything",
    "start": "218239",
    "end": "224840"
  },
  {
    "text": "behind at the back end of envoy downstream is actually anything below",
    "start": "224840",
    "end": "231120"
  },
  {
    "text": "or in front of envoy so think of it this way right and i'm gonna show some examples there clusters is the",
    "start": "231120",
    "end": "238159"
  },
  {
    "text": "back end basically so it's not just one host or one service running on server",
    "start": "238159",
    "end": "244400"
  },
  {
    "text": "certain port it's actually a collection of hosts right and they group it into a cluster so they call it a cluster",
    "start": "244400",
    "end": "251519"
  },
  {
    "text": "you give it a name and it has a bunch of stuff and you set a load balancing policy",
    "start": "251519",
    "end": "256560"
  },
  {
    "text": "on a cluster level listeners is i love this by the way we usually invent a new term for front",
    "start": "256560",
    "end": "263919"
  },
  {
    "text": "end but why just use the word listener yeah listener is where you listen to a port",
    "start": "263919",
    "end": "269280"
  },
  {
    "text": "and guess what it is the front end so instead of just like hi proxy we have",
    "start": "269280",
    "end": "274720"
  },
  {
    "text": "a front end and a back end right we basically just use the word listener",
    "start": "274720",
    "end": "280639"
  },
  {
    "text": "as your front end so listener is there and network filters this is the",
    "start": "280639",
    "end": "286160"
  },
  {
    "text": "abstraction that i actually i actually don't like too much abstraction but they just use the",
    "start": "286160",
    "end": "291199"
  },
  {
    "text": "minimum number of abstraction which is beautiful so what maps listeners to",
    "start": "291199",
    "end": "296400"
  },
  {
    "text": "clusters which is what we want as engineers right look like how can i connect this listener to this back-end network filters",
    "start": "296400",
    "end": "303280"
  },
  {
    "text": "that's it and and they give you out-of-the-box network filter called a tcp proxy for layer four processing",
    "start": "303280",
    "end": "310240"
  },
  {
    "text": "they give you out of the box proxying a filter called http for http",
    "start": "310240",
    "end": "315680"
  },
  {
    "text": "proxying obviously uh tls termination all that stuff so all these network filters so there's a filter that you",
    "start": "315680",
    "end": "322400"
  },
  {
    "text": "install not really installed it's just you can build your own filter i guess but you can just configure your new ammo",
    "start": "322400",
    "end": "329520"
  },
  {
    "text": "we're going to talk about threading model because this is a very interesting thing that there's a special choice in invoice that",
    "start": "329520",
    "end": "334880"
  },
  {
    "text": "i made i have a little bit of reservation i'll leave the comment up to you guys to decide",
    "start": "334880",
    "end": "340800"
  },
  {
    "text": "what's best or not right for everything that i get discussing this you you can have your own opinion formed",
    "start": "340800",
    "end": "348720"
  },
  {
    "text": "and and basically that's how we discuss engineers there's no right or wrong to be honest right we just",
    "start": "348720",
    "end": "355360"
  },
  {
    "text": "yeah this is what i think right and i think this is the pros and cons of everything so threading model",
    "start": "355360",
    "end": "360720"
  },
  {
    "text": "so they are a single process multi-threaded application right it's not multi-processors so",
    "start": "360720",
    "end": "366639"
  },
  {
    "text": "we talked about this many times right just check out the threading uh video right here and processes",
    "start": "366639",
    "end": "373520"
  },
  {
    "text": "connection pools that's another interesting thing that i actually expose and tell you about i haven't found uh other proxies",
    "start": "373520",
    "end": "381759"
  },
  {
    "text": "actually talking about their internal connection point that by the way guys i didn't mention",
    "start": "381759",
    "end": "387440"
  },
  {
    "text": "documentation in envoy is awesome it is so beautifully done it is so",
    "start": "387440",
    "end": "394880"
  },
  {
    "text": "clear and and they walk you through one step by step if you start everywhere and if you start somewhere in",
    "start": "394880",
    "end": "401680"
  },
  {
    "text": "the pro in the documentation you can actually understand the whole software by just reading through and",
    "start": "401680",
    "end": "406720"
  },
  {
    "text": "clicking next i love this i couldn't find this with traffic uh traffic dock is is atrocious to be",
    "start": "406720",
    "end": "413199"
  },
  {
    "text": "honest right so that's that's the problem with the traffic so you guys there is also one limitation in the in",
    "start": "413199",
    "end": "419840"
  },
  {
    "text": "the envoy documentation that i'm going to talk about which is the lack of implementation detail",
    "start": "419840",
    "end": "425199"
  },
  {
    "text": "and that is very frustration right so if i want to talk about envoy i'm ready to go and talk about envoy",
    "start": "425199",
    "end": "431599"
  },
  {
    "text": "it's i understand how it works i think right i might have missed a concept or",
    "start": "431599",
    "end": "436639"
  },
  {
    "text": "two but if i want to implement it boy i'm going to hit my head in the in the wall",
    "start": "436639",
    "end": "441919"
  },
  {
    "text": "all the time so it is very frustrating because you don't find examples you don't find samples like hip proxy they",
    "start": "441919",
    "end": "447360"
  },
  {
    "text": "give you or nginx like this is one file that have every possible configuration in it",
    "start": "447360",
    "end": "452720"
  },
  {
    "start": "450000",
    "end": "559000"
  },
  {
    "text": "they don't have that downstream and upstream guys anything in front of envoy is",
    "start": "452720",
    "end": "458720"
  },
  {
    "text": "downstream anything behind invoice upstream right so that's basically the concept of downstream upstream so if they use this",
    "start": "458720",
    "end": "465280"
  },
  {
    "text": "configuration right i don't see it in the config much to be honest but if you ever read",
    "start": "465280",
    "end": "472639"
  },
  {
    "text": "somewhere about this that's what it means right so let's spice things up you can actually put invoice as a",
    "start": "472639",
    "end": "478720"
  },
  {
    "text": "sidecar and we talked about sidecar here check out the video right here so you can actually put multiple invoices that",
    "start": "478720",
    "end": "484160"
  },
  {
    "text": "talk to each other let's say this is a downstream client that is understanding only http 2",
    "start": "484160",
    "end": "489840"
  },
  {
    "text": "right and uh http1 i'm sorry and then the envoy will will have a listener on",
    "start": "489840",
    "end": "496879"
  },
  {
    "text": "http one right and then we'll communicate to another info instance that",
    "start": "496879",
    "end": "502400"
  },
  {
    "text": "understand hdb2 right on the what was called the cluster level so there's",
    "start": "502400",
    "end": "508000"
  },
  {
    "text": "another cluster that connects to that right and then that invoice cluster will",
    "start": "508000",
    "end": "513360"
  },
  {
    "text": "talk to nh1 right so you can do a protocol upgrade essentially so these are side cars",
    "start": "513360",
    "end": "518959"
  },
  {
    "text": "you don't have to be side cars to be honest they can just be their own thing but that's one one implementation so in",
    "start": "518959",
    "end": "526399"
  },
  {
    "text": "this case this envoy instance is both downstream to this and upstream to that right downstream to",
    "start": "526399",
    "end": "533279"
  },
  {
    "text": "this absolutely to this so think of it request coming from a downstream right responses comes from",
    "start": "533279",
    "end": "538480"
  },
  {
    "text": "upstream that's how i think about it and i like this terminology to be honest i love it",
    "start": "538480",
    "end": "543519"
  },
  {
    "text": "i love it some people get confused i say okay downstream maybe or this is coming downstream from the uh",
    "start": "543519",
    "end": "549519"
  },
  {
    "text": "from the back end yeah i i i see where you're going with it but let me know in the",
    "start": "549519",
    "end": "554720"
  },
  {
    "text": "comment section below if you if you actually confused about these terminologies clusters",
    "start": "554720",
    "end": "559920"
  },
  {
    "start": "559000",
    "end": "650000"
  },
  {
    "text": "so we talked about this node applications and back end and python apps right so if you spin it up",
    "start": "559920",
    "end": "565519"
  },
  {
    "text": "you so you have to give me the address you have to give me the port that is listening to and that's how i",
    "start": "565519",
    "end": "570560"
  },
  {
    "text": "identify you as a host right running the application however you can group different hosts",
    "start": "570560",
    "end": "577360"
  },
  {
    "text": "or they call it also endpoints into one cluster and give it a name so for",
    "start": "577360",
    "end": "582800"
  },
  {
    "text": "example i'm going to show this in an example in demo where you can group these puppies into a",
    "start": "582800",
    "end": "588720"
  },
  {
    "text": "cluster called app1 and these puppies into a cluster called app too right pretty neat-ish isn't it so group of",
    "start": "588720",
    "end": "596399"
  },
  {
    "text": "hosts grab endpoint are called acosta cluster has a load balancing policy so this is um i guess it's the same right",
    "start": "596399",
    "end": "603839"
  },
  {
    "text": "it's the same as other proxies like hypoxia and genetics so the load balancing policy is set as the cluster",
    "start": "603839",
    "end": "610160"
  },
  {
    "text": "level so you can set like least connected load balancing mode right here so that it balances",
    "start": "610160",
    "end": "617360"
  },
  {
    "text": "between the two puppies in a round robin fashion and we're gonna see that this is actually",
    "start": "617360",
    "end": "622640"
  },
  {
    "text": "not true in case of envoy you're not gonna see true load balancing because of the threatening model",
    "start": "622640",
    "end": "628160"
  },
  {
    "text": "which we're gonna come up up i actually created an issue in the envoy report and and the author of envoy reply back matt",
    "start": "628160",
    "end": "636079"
  },
  {
    "text": "klein you reply back it's okay this is by design check this documentation",
    "start": "636079",
    "end": "641120"
  },
  {
    "text": "which i agree with but some people might not like that so yeah cluster app one and so this is",
    "start": "641120",
    "end": "648079"
  },
  {
    "text": "basically a customers listeners is the idea of listening for downstream clients right listen to a",
    "start": "648079",
    "end": "655120"
  },
  {
    "start": "650000",
    "end": "710000"
  },
  {
    "text": "port on envoy and then you pretty much everything is in the listener i find out",
    "start": "655120",
    "end": "660880"
  },
  {
    "text": "everything pretty much everything right similar to front-end nha proxy right we",
    "start": "660880",
    "end": "667279"
  },
  {
    "text": "talked about that and then you apply network filters to listeners",
    "start": "667279",
    "end": "672399"
  },
  {
    "text": "so that you map them to clusters right and there's a tcp http filters there's a",
    "start": "672399",
    "end": "678800"
  },
  {
    "text": "transport socket it's called tls if you want to enable trs you apply it to the listener which makes sense right",
    "start": "678800",
    "end": "684000"
  },
  {
    "text": "you listen to a port you listen to an address and you apply tls configuration",
    "start": "684000",
    "end": "690800"
  },
  {
    "text": "to that listener so and i found i have a trouble with the ammo in general but this",
    "start": "690800",
    "end": "697040"
  },
  {
    "text": "this hierarchy of things is just weird and when it comes to yaml but maybe if you like yeah mo you don't have",
    "start": "697040",
    "end": "703200"
  },
  {
    "text": "a problem with that i have problem with the ammo in general with these tabs and spaces i hate it i hope there's something that",
    "start": "703200",
    "end": "710880"
  },
  {
    "start": "710000",
    "end": "825000"
  },
  {
    "text": "that i don't know why people are adopting this thing to be honest it's just so confusing all right so network filters",
    "start": "710880",
    "end": "716480"
  },
  {
    "text": "we talked about that a little bit um it maps listeners to cluster so if i'm listening",
    "start": "716480",
    "end": "722560"
  },
  {
    "text": "on invoice on port 8080 i want any request or any tcp connection",
    "start": "722560",
    "end": "728480"
  },
  {
    "text": "if you're talking about tcp level proxying to map to this particular cluster or",
    "start": "728480",
    "end": "734639"
  },
  {
    "text": "this particular even host if you want to and there are not many type of",
    "start": "734639",
    "end": "739760"
  },
  {
    "text": "tcp proxy filters i mean there's a tcp proxy filter this is this",
    "start": "739760",
    "end": "745600"
  },
  {
    "text": "is the strings and this is another thing i didn't really like you have to memorize all",
    "start": "745600",
    "end": "750880"
  },
  {
    "text": "that stuff the strings but i i understand why it exists",
    "start": "750880",
    "end": "755920"
  },
  {
    "text": "right uh this is to basically create some sort of a mapping in case if",
    "start": "755920",
    "end": "761839"
  },
  {
    "text": "you want you create your own filter and just put it in the configuration right so it's built to be extensible",
    "start": "761839",
    "end": "769040"
  },
  {
    "text": "right so we know if something is built to be extensible it's it's a developer friendly not much",
    "start": "769040",
    "end": "776480"
  },
  {
    "text": "user friendly and when i say user i'm talking about engineer who is about to deploy he doesn't he or she doesn't really code",
    "start": "776480",
    "end": "783920"
  },
  {
    "text": "and build filters and most users actually don't build filters for the yeah they're basically",
    "start": "783920",
    "end": "789360"
  },
  {
    "text": "going to use your existing filters so these are ugly but we're stuck with them",
    "start": "789360",
    "end": "796480"
  },
  {
    "text": "and you people have built their own network filters they built a mongodb filter for envoy you can build mysql filter",
    "start": "796480",
    "end": "803760"
  },
  {
    "text": "there is a grpc network filter and that city this is the idea of abstraction of a network filter",
    "start": "803760",
    "end": "809200"
  },
  {
    "text": "is a beautiful i love it a lot i love it because you can just you can just add any filter and then",
    "start": "809200",
    "end": "816079"
  },
  {
    "text": "just map listeners to clusters in a specific way",
    "start": "816079",
    "end": "821360"
  },
  {
    "text": "assuming you know what you're doing connection pools my favorite part so",
    "start": "821360",
    "end": "827199"
  },
  {
    "start": "825000",
    "end": "1114000"
  },
  {
    "text": "each host in a cluster gets one or more connection",
    "start": "827199",
    "end": "832399"
  },
  {
    "text": "pools and a connection pool i talk about connection pooling with within the database concept but",
    "start": "832399",
    "end": "838560"
  },
  {
    "text": "it's actually can be applied everywhere right a connection pool is a pre-heated usually",
    "start": "838560",
    "end": "845839"
  },
  {
    "text": "tcp connection or udp quick connection that is available for",
    "start": "845839",
    "end": "853519"
  },
  {
    "text": "users or or or clients to consume right so you would essentially a",
    "start": "853519",
    "end": "859360"
  },
  {
    "text": "connection pool must have like one connection at least in it and more right and",
    "start": "859360",
    "end": "865760"
  },
  {
    "text": "and this is the idea of connection pool is to abstract what is inside it right is it so",
    "start": "865760",
    "end": "871920"
  },
  {
    "text": "so you can give it a thread and say okay here's a connection pool send your request to that connection",
    "start": "871920",
    "end": "877040"
  },
  {
    "text": "pool however each connection pool actually it is paired protocol so you cannot for example have a",
    "start": "877040",
    "end": "883519"
  },
  {
    "text": "connection pool that has one tcp connection that is serving http",
    "start": "883519",
    "end": "889440"
  },
  {
    "text": "1 1 right another tcp connection serving http 2 or 3 right it would be very confusing for the",
    "start": "889440",
    "end": "895600"
  },
  {
    "text": "thread because the thread will assume that this connection pool is http one pool right",
    "start": "895600",
    "end": "901040"
  },
  {
    "text": "so it will send a request in a specific headers and we'll have there it has",
    "start": "901040",
    "end": "908399"
  },
  {
    "text": "different uh format compared to http 2 where it has streams and stuff right",
    "start": "908399",
    "end": "913920"
  },
  {
    "text": "multiplexing so it's a completely different protocol right you can have a connection pool that serves whoop sockets right that's",
    "start": "913920",
    "end": "920959"
  },
  {
    "text": "that's a different uh that's a different thing i guess the websockets are upgraded from",
    "start": "920959",
    "end": "927519"
  },
  {
    "text": "http1 so maybe they can be reused but i'm not sure about that i didn't go that far in research",
    "start": "927519",
    "end": "933440"
  },
  {
    "text": "more pools allocated are pair priority or socket options so there's a default and a high priority",
    "start": "933440",
    "end": "942079"
  },
  {
    "text": "pool so if you have like a default pool you get a connection pool but if you specify a high",
    "start": "942079",
    "end": "947839"
  },
  {
    "text": "connection pool then you get two essentially default and high so it's pair priority right so if you want a high priority",
    "start": "947839",
    "end": "954720"
  },
  {
    "text": "like a specific dedicated connection pool you're going to get a completely different connection pool these are not",
    "start": "954720",
    "end": "960079"
  },
  {
    "text": "shared and connection pools are work per worker thread and we're going to show that an example of that right each",
    "start": "960079",
    "end": "966720"
  },
  {
    "text": "worker thread because invoice is multi-threaded each worker thread is dedicated for a",
    "start": "966720",
    "end": "972560"
  },
  {
    "text": "given connection pool and that's it right so if you have one thread on your envoy",
    "start": "972560",
    "end": "980000"
  },
  {
    "text": "then you get one connection pool pair everything right so if you have like two",
    "start": "980000",
    "end": "985360"
  },
  {
    "text": "protocols you get two two connection pools right and then for each connection pool",
    "start": "985360",
    "end": "991199"
  },
  {
    "text": "you assign it to a thread right we're gonna show an example how that works here's an example of how",
    "start": "991199",
    "end": "997040"
  },
  {
    "text": "it works this is a one worker thread envoy okay and we have a cluster",
    "start": "997040",
    "end": "1004639"
  },
  {
    "text": "with two hosts one host that supports http 2 and running on port 443 for simplicity",
    "start": "1004639",
    "end": "1010720"
  },
  {
    "text": "just for four three because that will just complicate things and another host that is running on port",
    "start": "1010720",
    "end": "1016959"
  },
  {
    "text": "80 so it's unsecure insecure or unsecure how do you say it insecure http 1 1",
    "start": "1016959",
    "end": "1025438"
  },
  {
    "text": "protocol right so this is just that so what you get is you're going to get",
    "start": "1025439",
    "end": "1031038"
  },
  {
    "text": "two connection pools per particle right so one connection pool for this host",
    "start": "1031039",
    "end": "1037199"
  },
  {
    "text": "for this protocol and one connection pool for this host for the h2 protocol so you",
    "start": "1037199",
    "end": "1043120"
  },
  {
    "text": "get http 2 pool http 1 1 pool and for http 1 1 you'll get one or more",
    "start": "1043120",
    "end": "1050640"
  },
  {
    "text": "tcp connection because we know how this is just a configuration thing right uh we know how http 2 or http1 work",
    "start": "1050640",
    "end": "1058640"
  },
  {
    "text": "right and i talk about http if you want to know if you're if you're lost and all that stuff guys check out",
    "start": "1058640",
    "end": "1063760"
  },
  {
    "text": "the http video and should check out the http 2 video as well where i talk about in details what are all",
    "start": "1063760",
    "end": "1070160"
  },
  {
    "text": "that stuff right so in in a nutshell a single tcp connection http 1",
    "start": "1070160",
    "end": "1075280"
  },
  {
    "text": "1 can only serve one request concurrently yes you might say oh pipelining hussein",
    "start": "1075280",
    "end": "1081520"
  },
  {
    "text": "envoy doesn't use bumper lining and i think nobody likes to use pipeline because it's just confusing so",
    "start": "1081520",
    "end": "1087280"
  },
  {
    "text": "let's assume one request concurrently in a given tcp connection which is",
    "start": "1087280",
    "end": "1093120"
  },
  {
    "text": "wasteful right http 2 solve this with multiplexing that's why we need multiple tcp",
    "start": "1093120",
    "end": "1099440"
  },
  {
    "text": "connections for hdb11 to send to request in parallel right so that's it so this is assigned to this thread",
    "start": "1099440",
    "end": "1105919"
  },
  {
    "text": "and this is also assigned to this thread so each thread gets one pool pair host right and uh",
    "start": "1105919",
    "end": "1112559"
  },
  {
    "text": "this is essentially the other host so envoy have a threaded multi-threaded model so it's a single",
    "start": "1112559",
    "end": "1118880"
  },
  {
    "start": "1114000",
    "end": "1285000"
  },
  {
    "text": "process when you run process envoy you get one process only and it says multi-threaded and each",
    "start": "1118880",
    "end": "1126160"
  },
  {
    "text": "thread is bound to a single connection right as we as we explain and there are no",
    "start": "1126160",
    "end": "1134480"
  },
  {
    "text": "coordination between threads at all right so each thread is bound to a",
    "start": "1134480",
    "end": "1139760"
  },
  {
    "text": "single collection in execution right once that is",
    "start": "1139760",
    "end": "1144880"
  },
  {
    "text": "execution is done we basically release that connection back to the pool right it's just one thing their thing",
    "start": "1144880",
    "end": "1150080"
  },
  {
    "text": "right that's the idea and there are no correlation between threads and and that means that threads do not know",
    "start": "1150080",
    "end": "1157280"
  },
  {
    "text": "what other threads are doing so there is no master or leader worker that coordinates",
    "start": "1157280",
    "end": "1163200"
  },
  {
    "text": "the stuff right that's why when we do load balancing",
    "start": "1163200",
    "end": "1168240"
  },
  {
    "text": "round robin we cannot do true round robin load balancing between hosts",
    "start": "1168240",
    "end": "1173520"
  },
  {
    "text": "because guess what if i'm going to send a request thread thread a might pick it up right which",
    "start": "1173520",
    "end": "1179840"
  },
  {
    "text": "assigned to host a right host one and then another request can be packed up also by the same thread but also to get",
    "start": "1179840",
    "end": "1187120"
  },
  {
    "text": "to to uh or also another another thread but also going to the same host so we we",
    "start": "1187120",
    "end": "1193840"
  },
  {
    "text": "are kind of load balancing the threads but not loading balancing the host and the reason is because there",
    "start": "1193840",
    "end": "1200480"
  },
  {
    "text": "is no coordination between something we don't have no idea how to spread this stuff and here's an example",
    "start": "1200480",
    "end": "1205679"
  },
  {
    "text": "if i have two worker thread for example in this case uh each thread will get a pool right so",
    "start": "1205679",
    "end": "1211520"
  },
  {
    "text": "in this case this thread uh will get the dedicated pool for http one one and also the other",
    "start": "1211520",
    "end": "1218880"
  },
  {
    "text": "thread will get another pool for http one one for host a",
    "start": "1218880",
    "end": "1223919"
  },
  {
    "text": "and the second thread will get for each host will get the the http 2 um pool and then",
    "start": "1223919",
    "end": "1230720"
  },
  {
    "text": "the second thread will get the hdb2 pool for that all right so we get four connection",
    "start": "1230720",
    "end": "1236400"
  },
  {
    "text": "pools right and yeah and you can notice that hdb2 technically there's it's enough to have",
    "start": "1236400",
    "end": "1243039"
  },
  {
    "text": "one tcp connection uh pear pool because it's a theoretical",
    "start": "1243039",
    "end": "1248640"
  },
  {
    "text": "thing because unless you you don't hit the maximum streams in a single http 2 connection",
    "start": "1248640",
    "end": "1256080"
  },
  {
    "text": "right so you're good so you can send as many requests as you want in parallel all right so that's the idea of so",
    "start": "1256080",
    "end": "1261760"
  },
  {
    "text": "that's why tcp connection single tcp is is more than enough for http 2 right",
    "start": "1261760",
    "end": "1267120"
  },
  {
    "text": "and then and envoy recommends using http 2 on the back end all the time i think it it by default it uses it if it supports",
    "start": "1267120",
    "end": "1274159"
  },
  {
    "text": "if the back end supports it that's why putting another invoice sidecar guarantees that you're gonna use always",
    "start": "1274159",
    "end": "1281679"
  },
  {
    "text": "http 2 between the kind of the these two endpoints",
    "start": "1281679",
    "end": "1286799"
  },
  {
    "start": "1285000",
    "end": "1470000"
  },
  {
    "text": "let's jump to the fave red part where we're gonna showcase this",
    "start": "1286799",
    "end": "1292799"
  },
  {
    "text": "beautiful beautiful beautiful dick we're gonna show a beautiful thick we're gonna be awesome it's gonna be",
    "start": "1292799",
    "end": "1299840"
  },
  {
    "text": "beautiful all right so the first thing we're gonna do here is we're gonna test the four services that",
    "start": "1299840",
    "end": "1306320"
  },
  {
    "text": "i'm gonna talk about right so there's there are four services running on my mac right now",
    "start": "1306320",
    "end": "1311840"
  },
  {
    "text": "uh one one one one two two two two three three three four four four four that's it right and i'm gonna then install",
    "start": "1311840",
    "end": "1318080"
  },
  {
    "text": "envoy and then we're gonna layer seven proxy and do some layer seven processing that means we",
    "start": "1318080",
    "end": "1324159"
  },
  {
    "text": "want to first proxy to the four back end in a round drop in fashion and we're gonna",
    "start": "1324159",
    "end": "1329440"
  },
  {
    "text": "show how how that doesn't clearly work until we set the threading to one so i can actually",
    "start": "1329440",
    "end": "1336960"
  },
  {
    "text": "show that concept that we just talked about the threading problem right with this right and then we're going to do conditional uh",
    "start": "1336960",
    "end": "1344320"
  },
  {
    "text": "uh proxying by doing going to slash app one will go to certain cluster if i go",
    "start": "1344320",
    "end": "1351200"
  },
  {
    "text": "to slash app2 we'll go to another cluster right then we're going to prevent admin access this is stuff we have done for",
    "start": "1351200",
    "end": "1356799"
  },
  {
    "text": "every single proxy right and i just measure how easy it is to do on any board so we're going to show how",
    "start": "1356799",
    "end": "1363280"
  },
  {
    "text": "to do direct response here it was painful to find oh my god example",
    "start": "1363280",
    "end": "1369039"
  },
  {
    "text": "to do an admin block oh my god oh my god that was so difficult to find",
    "start": "1369039",
    "end": "1374080"
  },
  {
    "text": "an example that does that the doc clearly said here's a direct response but it gives you a stupid protofile that",
    "start": "1374080",
    "end": "1381120"
  },
  {
    "text": "how do i do a yamo configuration so that was i was a little bit frustrating but i found an example someone",
    "start": "1381120",
    "end": "1387440"
  },
  {
    "text": "actually posted something in a github layer 4 praxion layer for proxying we're going",
    "start": "1387440",
    "end": "1393360"
  },
  {
    "text": "to do that we showed this over a long time right just pure layer 4 proxies so if you want to do it like web sockets or something like",
    "start": "1393360",
    "end": "1399760"
  },
  {
    "text": "that you can do that without terminating without looking at the content enable https we're going to enable hdbis",
    "start": "1399760",
    "end": "1406480"
  },
  {
    "text": "we're going to do let's encrypt for that i'm going to issue do so uh search bot install the search bot",
    "start": "1406480",
    "end": "1412880"
  },
  {
    "text": "i have this button so i'm not going to show you that we're going to generate a private key public key uh certificate um full chain and then",
    "start": "1412880",
    "end": "1421360"
  },
  {
    "text": "install it add it to invoice configuration show you how to do that and then we're going to enable hdb2",
    "start": "1421360",
    "end": "1428000"
  },
  {
    "text": "because envoy does not actually support http by default which is weird i don't know why",
    "start": "1428000",
    "end": "1435520"
  },
  {
    "text": "they just not support that by default all right but yeah we can do that and then we're",
    "start": "1435520",
    "end": "1441279"
  },
  {
    "text": "going to do a little bit of ssl labs and show the grade our application gets right which is i think b or something or",
    "start": "1441279",
    "end": "1448080"
  },
  {
    "text": "maybe less than that and then we're going to disable tls 1.0 on point one because those things are dead right and then we can show you",
    "start": "1448080",
    "end": "1454720"
  },
  {
    "text": "how to do that i'm gonna do the unnecessary is another ssl labs test show you that this is a great grid right because this",
    "start": "1454720",
    "end": "1461039"
  },
  {
    "text": "is a 101 or bad you should not use them at all browsers",
    "start": "1461039",
    "end": "1466320"
  },
  {
    "text": "are stopping the support for that let's just jump into the",
    "start": "1466320",
    "end": "1471360"
  },
  {
    "start": "1470000",
    "end": "1560000"
  },
  {
    "text": "beautiful work all right guys i have visual studio code here i'm gonna open a brand new project",
    "start": "1471360",
    "end": "1478960"
  },
  {
    "text": "where all the configuration all the work that i do will be available here so i'm gonna call",
    "start": "1478960",
    "end": "1484320"
  },
  {
    "text": "it invoice and i'm gonna push this to github so you can see all this configuration right but before we do",
    "start": "1484320",
    "end": "1489440"
  },
  {
    "text": "that how about we go to chrome and show you the four services i talked about right so the same mac one one one one",
    "start": "1489440",
    "end": "1497279"
  },
  {
    "text": "this is the app this is very simple it's rich literally it's listening to up.111 and also tells me when i hit it which",
    "start": "1497279",
    "end": "1505600"
  },
  {
    "text": "app idea is it and it's it's basically the back to the port itself this way i know which app i hit this way",
    "start": "1505600",
    "end": "1512480"
  },
  {
    "text": "if i hit the invoice i know which app is is getting hit which backend is getting hit and you can see there's two two two two",
    "start": "1512480",
    "end": "1518080"
  },
  {
    "text": "exactly the same thing 33 33 exactly the same thing four four four four so four services are running on my service and there is a slash app",
    "start": "1518080",
    "end": "1524640"
  },
  {
    "text": "one which says app one says hello and there's a slash app too which which is exactly the same just",
    "start": "1524640",
    "end": "1530320"
  },
  {
    "text": "says app to say hello and there's a page called admin which says admin page very few people should see this",
    "start": "1530320",
    "end": "1536640"
  },
  {
    "text": "that's my application in a nutshell right so what i want to do is let's go install an envoy and let's",
    "start": "1536640",
    "end": "1541760"
  },
  {
    "text": "load balance those stuff right go back to this i have envoy let's go ahead",
    "start": "1541760",
    "end": "1548559"
  },
  {
    "text": "and install invoice so open the new thermal and here's what you do to",
    "start": "1548559",
    "end": "1553840"
  },
  {
    "text": "install invite i'm going to install and void on my mac follow the instructions to install envoy",
    "start": "1553840",
    "end": "1558960"
  },
  {
    "text": "or your windows if you want to do it in docker i don't like to use docker specifically because",
    "start": "1558960",
    "end": "1564320"
  },
  {
    "start": "1560000",
    "end": "1650000"
  },
  {
    "text": "the example out there just give you a compose file that just hides all the beautiful beauty",
    "start": "1564320",
    "end": "1570240"
  },
  {
    "text": "things from you right but i like i like to get my hands dirty and then install the software myself i",
    "start": "1570240",
    "end": "1577279"
  },
  {
    "text": "configure the crossover myself feed it configuration so i can switch easily right with with docker",
    "start": "1577279",
    "end": "1584640"
  },
  {
    "text": "yeah you can obviously use docker in production there's no problem with that but to understand it better i like to",
    "start": "1584640",
    "end": "1590880"
  },
  {
    "text": "install it on bare metal okay plus if you change configuration with docker it's so",
    "start": "1590880",
    "end": "1596080"
  },
  {
    "text": "hard right how do you do that you ssh into the container yuck right so the first thing we're going to",
    "start": "1596080",
    "end": "1602880"
  },
  {
    "text": "do is do brew i'm going to use home brew obviously brew tap titrate labs slash get invoice so this",
    "start": "1602880",
    "end": "1611600"
  },
  {
    "text": "is how we essentially tap into envoy and once we do that we're gonna update",
    "start": "1611600",
    "end": "1617360"
  },
  {
    "text": "the homebrew this will actually add the envoy uh formula right so the next thing we're",
    "start": "1617360",
    "end": "1625279"
  },
  {
    "text": "going to do is brew install envoy very very simple this is actually installs",
    "start": "1625279",
    "end": "1631120"
  },
  {
    "text": "the latest and greatest envoy right and if i want to install the",
    "start": "1631120",
    "end": "1638559"
  },
  {
    "text": "the nightly version i would just add dash dash nightly but i don't really care about that so i have envoy running guys that's it",
    "start": "1638559",
    "end": "1645919"
  },
  {
    "text": "just like that i haven't boi running next thing we're gonna do i am going to do uh a configuration here",
    "start": "1645919",
    "end": "1653360"
  },
  {
    "start": "1650000",
    "end": "1680000"
  },
  {
    "text": "right so that's what we're going to do so we want to do a layer 7 proxy and that's the first thing we're going to do right",
    "start": "1653360",
    "end": "1658399"
  },
  {
    "text": "layer 7 proxying so let's go call it http.ammo right and to do layer 7 proxying",
    "start": "1658399",
    "end": "1665840"
  },
  {
    "text": "the simplest thing to to just flip between all these puppies one after the other i am going",
    "start": "1665840",
    "end": "1673440"
  },
  {
    "text": "to basically listen to a port and then once i listen to a port",
    "start": "1673440",
    "end": "1678480"
  },
  {
    "text": "i will create a filter and then start basically mapping to the back end which",
    "start": "1678480",
    "end": "1684559"
  },
  {
    "start": "1680000",
    "end": "2400000"
  },
  {
    "text": "are these four backends that i talked about hopefully i nail the yaml because i am so bad at",
    "start": "1684559",
    "end": "1689760"
  },
  {
    "text": "this right so the first thing we're going to do is do a static resources right and then space",
    "start": "1689760",
    "end": "1697200"
  },
  {
    "text": "listeners that we talked about listeners right and then what address are we listening on dash",
    "start": "1697200",
    "end": "1703840"
  },
  {
    "text": "address then we're gonna do a socket address",
    "start": "1703840",
    "end": "1711120"
  },
  {
    "text": "the address is i'm going to listen to all ports basically or or this is the wildcard ip address",
    "start": "1711120",
    "end": "1717120"
  },
  {
    "text": "basically so listen to all interfaces right and the port value",
    "start": "1717120",
    "end": "1722480"
  },
  {
    "text": "is 8080 because it's famous right the next thing we're going to do is assign some filter",
    "start": "1722480",
    "end": "1729360"
  },
  {
    "text": "chains at the address level so we need to really need nail this right guys especially this",
    "start": "1729360",
    "end": "1736640"
  },
  {
    "text": "i hate this man so just how to nail this whether",
    "start": "1736640",
    "end": "1742640"
  },
  {
    "text": "something is is this by eyesight which is weird that's why i like jason jason it's just structured this",
    "start": "1742640",
    "end": "1748799"
  },
  {
    "text": "way is just using your eye which i have bad eyesight so we'll add a bunch of filters",
    "start": "1748799",
    "end": "1755760"
  },
  {
    "text": "and we're gonna give it a beautiful name what name is gonna this is gonna be it's gonna be invoy dot filters",
    "start": "1755760",
    "end": "1764159"
  },
  {
    "text": "dot network dot http connection manager right because that's that's the",
    "start": "1764159",
    "end": "1771200"
  },
  {
    "text": "http filter that we talked about right and then the next thing we're gonna do is uh we need",
    "start": "1771200",
    "end": "1777840"
  },
  {
    "text": "typed underscore config right this is just to essentially specify which exact",
    "start": "1777840",
    "end": "1785120"
  },
  {
    "text": "type we're pulling from right i don't know why we can't derive this from here to be honest",
    "start": "1785120",
    "end": "1790320"
  },
  {
    "text": "right so type your google apis dot com slash invoice.config.filter.network.http",
    "start": "1790320",
    "end": "1799919"
  },
  {
    "text": "connection then score manager the v2 version 2 http",
    "start": "1799919",
    "end": "1806640"
  },
  {
    "text": "connection manager so this is think of it like as the class that we want to and then we",
    "start": "1806640",
    "end": "1812559"
  },
  {
    "text": "do stat underscore prefix this is just to give it a name right so i'm going to call it http proxy",
    "start": "1812559",
    "end": "1819840"
  },
  {
    "text": "right you see that is a lot of configurations that we need to do right to get this right right route config one",
    "start": "1819840",
    "end": "1826480"
  },
  {
    "text": "of the most important thing obviously what is the route config i'm going to name my route",
    "start": "1826480",
    "end": "1832880"
  },
  {
    "text": "right because you're routing the listener to the back end and they don't",
    "start": "1832880",
    "end": "1839279"
  },
  {
    "text": "mention this route config much right and then documentation but it's it's",
    "start": "1839279",
    "end": "1844559"
  },
  {
    "text": "just just part of the config i guess right so i gotta call it abc anything you want right or let's call it",
    "start": "1844559",
    "end": "1850880"
  },
  {
    "text": "old nice the virtual hosts the id of their",
    "start": "1850880",
    "end": "1857200"
  },
  {
    "text": "clusters right which which is your backend clusters here they give it a name backend cluster",
    "start": "1857200",
    "end": "1865519"
  },
  {
    "text": "i'm going to call it let's call it all backend right cluster and then",
    "start": "1865519",
    "end": "1872640"
  },
  {
    "text": "boop domains here is where we basically",
    "start": "1872640",
    "end": "1879120"
  },
  {
    "text": "filter what domains you want to match on and i basically i don't have any domains",
    "start": "1879120",
    "end": "1884399"
  },
  {
    "text": "here right now so just like do start right then do routes we're going to write this",
    "start": "1884399",
    "end": "1890159"
  },
  {
    "text": "once and then once we write it will be set guys essentially routes right so now this is matching what are",
    "start": "1890159",
    "end": "1896559"
  },
  {
    "text": "we matching exactly basically i want to match",
    "start": "1896559",
    "end": "1903279"
  },
  {
    "text": "pretty much anything right i want to match anything that comes here",
    "start": "1903279",
    "end": "1911600"
  },
  {
    "text": "with a prefix of slash right anything that comes to to me",
    "start": "1911600",
    "end": "1919279"
  },
  {
    "text": "immediately go and and uh route it to this cluster",
    "start": "1919279",
    "end": "1925679"
  },
  {
    "text": "cluster work cluster i want to route it to the cluster called all back",
    "start": "1925679",
    "end": "1930960"
  },
  {
    "text": "end some spaces i i told him man that the spaces are just terrible the final thing we need to do is some",
    "start": "1930960",
    "end": "1937600"
  },
  {
    "text": "http filters this is to tell the uh to the app that's hey i'm using http",
    "start": "1937600",
    "end": "1945279"
  },
  {
    "text": "and here's the filters that to use for in void of filters.http.router",
    "start": "1945279",
    "end": "1950640"
  },
  {
    "text": "okay and let's build the clusters this was just",
    "start": "1950640",
    "end": "1956640"
  },
  {
    "text": "me mapping to all backend cluster but this all backend cluster doesn't exist right so how about we actually build the all",
    "start": "1956640",
    "end": "1963360"
  },
  {
    "text": "back-end clusters no back-end cluster is a property of not the listener it's property of the",
    "start": "1963360",
    "end": "1972159"
  },
  {
    "text": "before the static resources so clusters what clusters do we have what classes do we have dash name i'm",
    "start": "1972159",
    "end": "1978399"
  },
  {
    "text": "gonna hold all back in cluster and then you start putting some configuration connect",
    "start": "1978399",
    "end": "1984640"
  },
  {
    "text": "timeout what kind what kind of timeout do we have well i want if you could not connect to this cluster in one second",
    "start": "1984640",
    "end": "1990960"
  },
  {
    "text": "you did basically right and here's the type strict dns i'm gonna explain this later",
    "start": "1990960",
    "end": "1998559"
  },
  {
    "text": "and then here's my favorite part the load balancing policy right so thought by symbols i'm",
    "start": "1998559",
    "end": "2005600"
  },
  {
    "text": "going to use round robin between the host clusters which i didn't define yet",
    "start": "2005600",
    "end": "2010640"
  },
  {
    "text": "i want to use uh the round robin to to balance them okay so next thing again aside the load",
    "start": "2010640",
    "end": "2017440"
  },
  {
    "text": "assignment what kind of road assignment you go guys do you think i'm gonna nail it from the",
    "start": "2017440",
    "end": "2022960"
  },
  {
    "text": "first time i really doubt it but we'll see all right cluster name",
    "start": "2022960",
    "end": "2028399"
  },
  {
    "text": "back end uh we're going to call the cluster name is actually a cluster name all back in cluster",
    "start": "2028399",
    "end": "2036240"
  },
  {
    "text": "and then we define the endpoints which is the what we're listening to lb endpoints",
    "start": "2036240",
    "end": "2043919"
  },
  {
    "text": "right leg balancer starting point the endpoint is on this address",
    "start": "2044159",
    "end": "2050240"
  },
  {
    "text": "socket address and then address is hussein mac finally we're",
    "start": "2050240",
    "end": "2057280"
  },
  {
    "text": "going to define this stuff and then the port value is what the first",
    "start": "2057280",
    "end": "2062320"
  },
  {
    "text": "port which is one one one one because this is we start defining all the endpoints one by one so now copy and paste game",
    "start": "2062320",
    "end": "2070079"
  },
  {
    "text": "one end point one one one one what's the what's the rest of the stuff",
    "start": "2070079",
    "end": "2075679"
  },
  {
    "text": "another endpoint jeez man i hate there's no extension that i",
    "start": "2075679",
    "end": "2081679"
  },
  {
    "text": "installed in in in the ammo that actually helped with this look look at all this",
    "start": "2081679",
    "end": "2087440"
  },
  {
    "text": "jesus i hate this so much right so look at this look at this mess",
    "start": "2087440",
    "end": "2094480"
  },
  {
    "text": "how do you guys deal with the ammo people who deal with the ammo on a daily basis i feel sorry for you",
    "start": "2094480",
    "end": "2099920"
  },
  {
    "text": "thank god i don't have to worry about the ammo on a daily basis but yeah all right just look at this",
    "start": "2099920",
    "end": "2107200"
  },
  {
    "text": "look at this a kubernetes using ammo i mean if if you do some bad conflict like i add a bad space",
    "start": "2107200",
    "end": "2115599"
  },
  {
    "text": "what how and and do it on a friday 5 p.m all right so this will be",
    "start": "2115599",
    "end": "2123280"
  },
  {
    "text": "four end points right this is my old back-end cluster to be honest i don't know why do we have",
    "start": "2123280",
    "end": "2129200"
  },
  {
    "text": "uh multiple ones right because um why do we have like a name here a name here",
    "start": "2129200",
    "end": "2135680"
  },
  {
    "text": "i have no idea to be honest right maybe this is the assignment name i just named the same or to be not",
    "start": "2135680",
    "end": "2142880"
  },
  {
    "text": "confusing but it's just like the cluster name is all back in class so that's what we care about here right",
    "start": "2142880",
    "end": "2148880"
  },
  {
    "text": "and i think we are ready guys hopefully we didn't do some problems but",
    "start": "2148880",
    "end": "2156160"
  },
  {
    "text": "let's let's go through this again status results we gotta have a listener right one listener and clusters right and the",
    "start": "2156160",
    "end": "2161839"
  },
  {
    "text": "listener we're listening on port 8080. so let's remember to visit 8080. don't let's forget that we",
    "start": "2161839",
    "end": "2167920"
  },
  {
    "text": "have a filter chain filters name hopefully i nail those names otherwise we're going to get there's the",
    "start": "2167920",
    "end": "2173760"
  },
  {
    "text": "thing as i was testing involved it actually gives me good error messages it tells me i'd hate this is wrong this",
    "start": "2173760",
    "end": "2180160"
  },
  {
    "text": "doesn't start and then fail later lazy approach it just it was eagerly",
    "start": "2180160",
    "end": "2185359"
  },
  {
    "text": "telling me something is wrong which is something i liked all right so how about we actually start",
    "start": "2185359",
    "end": "2191040"
  },
  {
    "text": "this thing i am here in avoid there is an http.yaml all right guys let's start out and",
    "start": "2191040",
    "end": "2196800"
  },
  {
    "text": "point envoy and then you specify which file you want to load dash config",
    "start": "2196800",
    "end": "2203280"
  },
  {
    "text": "dash path space http or ammo and then later we're going to add some concurrency but now",
    "start": "2203280",
    "end": "2208720"
  },
  {
    "text": "it's going to do the default threading i think multi-threaded by default right and we're getting some errors let's see",
    "start": "2208720",
    "end": "2216800"
  },
  {
    "text": "okay so we're getting some errors the errors is everything is info until here critical error initialization",
    "start": "2216800",
    "end": "2223280"
  },
  {
    "text": "http protocol has unknown fields what part is unknown field clusters all right guys",
    "start": "2223280",
    "end": "2230720"
  },
  {
    "text": "i think i found it see this is what i freaking hate",
    "start": "2230720",
    "end": "2236160"
  },
  {
    "text": "this is another space here because address is an it's a property of input but you have to",
    "start": "2236160",
    "end": "2241200"
  },
  {
    "text": "remember to add a stupid tab or space all right let's fix all of them",
    "start": "2241200",
    "end": "2246640"
  },
  {
    "text": "all right guys have you noticed this this is okay this is the problem this is under end point so you have to",
    "start": "2246640",
    "end": "2252960"
  },
  {
    "text": "push it a little bit so it's straighted up to this what a yucky file type",
    "start": "2252960",
    "end": "2261520"
  },
  {
    "text": "i don't know why people love this stuff i have no clue you tell me man i'm unless i'm doing",
    "start": "2261520",
    "end": "2266640"
  },
  {
    "text": "something wrong guys i don't know man maybe i'm a dummy all right i don't know let's let's try this again",
    "start": "2266640",
    "end": "2273119"
  },
  {
    "text": "all right let's run in boy again boom boom pray oh another error i'm gonna leave",
    "start": "2273119",
    "end": "2280480"
  },
  {
    "text": "this stuff by the way guys so you can see the pain of the ammo see the pain",
    "start": "2280480",
    "end": "2286720"
  },
  {
    "text": "see the pain of yaml so every engineer out there if you think ammo is easy tell me how",
    "start": "2286720",
    "end": "2294160"
  },
  {
    "text": "to do this or better because i have no idea critical what is this initialize it says configuration",
    "start": "2294160",
    "end": "2302000"
  },
  {
    "text": "listeners cannot find feel so it's complaining that the listener has a field that",
    "start": "2302000",
    "end": "2307119"
  },
  {
    "text": "lists jesus i misspelled listeners less",
    "start": "2307119",
    "end": "2313839"
  },
  {
    "text": "10 or less 10 less 10 10 or less",
    "start": "2313839",
    "end": "2321440"
  },
  {
    "text": "is that right okay i misspell listeners okay i think this video is done",
    "start": "2322160",
    "end": "2328880"
  },
  {
    "text": "all right what else now okay i misspelled the notes but now you're saying what filter chained all right",
    "start": "2329520",
    "end": "2336880"
  },
  {
    "text": "pick some more stuff some more spaces just stupid spaces nothing fancy all right guys after",
    "start": "2336880",
    "end": "2342160"
  },
  {
    "text": "fixing some few spaces and making sure everything is right we finally",
    "start": "2342160",
    "end": "2347280"
  },
  {
    "text": "did it we are running invoice running on port 8080 how about",
    "start": "2347280",
    "end": "2353200"
  },
  {
    "text": "we test this thing open chrome open this hussein mac",
    "start": "2353200",
    "end": "2358960"
  },
  {
    "text": "now we have 8080 slash ooh nice we went to two two two two refresh",
    "start": "2358960",
    "end": "2365440"
  },
  {
    "text": "four four four four one one one two three four one two three four one two three four we we're just getting",
    "start": "2365440",
    "end": "2372960"
  },
  {
    "text": "lucky a little bit here with the configuration because it's a layer seven proxy",
    "start": "2372960",
    "end": "2378079"
  },
  {
    "text": "right with uh tcp proxy you you'll see that this is not always the case with the layer force",
    "start": "2378079",
    "end": "2384960"
  },
  {
    "text": "with the layer seven proxy we know so we did it guys we did it",
    "start": "2384960",
    "end": "2390320"
  },
  {
    "text": "so man you saw how come how painful the animal is at least for me i mean you're gonna copy and paste",
    "start": "2390320",
    "end": "2396960"
  },
  {
    "text": "configuration that might not be as bad as an idea guys but i don't know man i think it's a little",
    "start": "2396960",
    "end": "2404240"
  },
  {
    "start": "2400000",
    "end": "2730000"
  },
  {
    "text": "bit uh complicated to me so if i go slash app one i still go i load balance all this",
    "start": "2404240",
    "end": "2412160"
  },
  {
    "text": "stuff app two load balance all this beautiful stuff that's nice",
    "start": "2412160",
    "end": "2417200"
  },
  {
    "text": "admin all right so what are we doing next all right guys so now here's what i'm",
    "start": "2417200",
    "end": "2422560"
  },
  {
    "text": "gonna do i am going to if i go to app one i want prox uh i want invoice to proxy",
    "start": "2422560",
    "end": "2430000"
  },
  {
    "text": "to uh the app one and app two right which is a one one one one two two two",
    "start": "2430000",
    "end": "2436160"
  },
  {
    "text": "two and if i go to app2 i want it to proxy between three and four so how do i do that",
    "start": "2436160",
    "end": "2444560"
  },
  {
    "text": "let's go to this http let's kill this and i'm gonna copy this for you guys so",
    "start": "2444560",
    "end": "2449680"
  },
  {
    "text": "again i'm gonna call this uh all back end right then i'm going to copy and paste i'm going to call this",
    "start": "2449680",
    "end": "2456400"
  },
  {
    "text": "uh app1ap2split all right so we can just keep track of",
    "start": "2456400",
    "end": "2462400"
  },
  {
    "text": "every work that we did basically and then we're going to push everything to to github so you can get this done",
    "start": "2462400",
    "end": "2467680"
  },
  {
    "text": "so what do i need to do i still need uh or the old backend cluster",
    "start": "2467680",
    "end": "2474000"
  },
  {
    "text": "right but what i need to do is create a different route essentially",
    "start": "2474000",
    "end": "2479040"
  },
  {
    "text": "right so i'm going to copy this thing let's keep this all right guys so what we need to do is",
    "start": "2479040",
    "end": "2484400"
  },
  {
    "text": "these are the routes right so we're going to create a new route this route when you go to slash always",
    "start": "2484400",
    "end": "2489920"
  },
  {
    "text": "go to all backend so let's proxy to all backend one two three four one one one two two two three three",
    "start": "2489920",
    "end": "2495760"
  },
  {
    "text": "four four four however if i copy and and paste this puppy and i say if you're going to app one if",
    "start": "2495760",
    "end": "2503440"
  },
  {
    "text": "the preference going to app one let's go to app one cluster",
    "start": "2503440",
    "end": "2508640"
  },
  {
    "text": "all right and if you're going to app 2 then go to app2 cluster",
    "start": "2508640",
    "end": "2515440"
  },
  {
    "text": "so now the question is what is app 1 and app 2 clusters right let's build them right so this is",
    "start": "2515440",
    "end": "2522240"
  },
  {
    "text": "one cluster called all back end guess what i'm going to copy the whole puppy up",
    "start": "2522240",
    "end": "2528640"
  },
  {
    "text": "hopefully i nailed the stupid ammo this time all right so this is",
    "start": "2528640",
    "end": "2535280"
  },
  {
    "text": "my god this is so painful i'd rather do this in vim probably not all right so this guy",
    "start": "2535280",
    "end": "2543920"
  },
  {
    "text": "you are almost there yes okay so we're gonna call this app one cluster",
    "start": "2543920",
    "end": "2551280"
  },
  {
    "text": "right why are you yelling at me now what what is what is the error again oh it's",
    "start": "2551280",
    "end": "2557280"
  },
  {
    "text": "not really is it is it straight to this yeah okay you",
    "start": "2557280",
    "end": "2564960"
  },
  {
    "text": "sir be here and you should be here right it doesn't matter yeah",
    "start": "2564960",
    "end": "2572240"
  },
  {
    "text": "of course yeah the name and all that stuff should become like that all right so just almost there",
    "start": "2572240",
    "end": "2579760"
  },
  {
    "text": "almost all right up one cluster so up one cluster guys is just one one and two two so we kill",
    "start": "2579760",
    "end": "2586480"
  },
  {
    "text": "those parties kill them and then we copy",
    "start": "2586480",
    "end": "2592319"
  },
  {
    "text": "my god we're just praying now nothing breaks",
    "start": "2592319",
    "end": "2597759"
  },
  {
    "text": "oh what all right all right we nailed it guys app 2 cluster",
    "start": "2598560",
    "end": "2603839"
  },
  {
    "text": "round robin three two three four four four four what is going on i actually nailed it",
    "start": "2603839",
    "end": "2610800"
  },
  {
    "text": "from the first time wowzie guys if i don't have to work on the ammo on",
    "start": "2610800",
    "end": "2617119"
  },
  {
    "text": "my life i'll be a happy man all right so now what do we do what do we do my friends",
    "start": "2617119",
    "end": "2622560"
  },
  {
    "text": "we do invoice dash dash config path not http it's called app one",
    "start": "2622560",
    "end": "2629599"
  },
  {
    "text": "app two split dot ammo are you guys ready do we get yelled at",
    "start": "2629599",
    "end": "2635839"
  },
  {
    "text": "no we did not get yelled at it's just a warning because of the limit of the number of connections no problem",
    "start": "2635839",
    "end": "2641040"
  },
  {
    "text": "you know go back and let's test this thing now if i go to app one two two three four",
    "start": "2641040",
    "end": "2648640"
  },
  {
    "text": "oh what this is not working man this is not working all right",
    "start": "2648640",
    "end": "2656880"
  },
  {
    "text": "i might know why why because i think the first route is winning",
    "start": "2656880",
    "end": "2662480"
  },
  {
    "text": "my god the first route is winning this is a route that basically",
    "start": "2662480",
    "end": "2669200"
  },
  {
    "text": "basically evaluated to everything what if i do this i flip this rule i add it at the end",
    "start": "2669200",
    "end": "2677838"
  },
  {
    "text": "let's do this and then kill run again",
    "start": "2678960",
    "end": "2685920"
  },
  {
    "text": "then then okay so now this this seems to be working one one and two two",
    "start": "2685920",
    "end": "2691200"
  },
  {
    "text": "app two three three and four four awesome awesome awesome we're load balancing",
    "start": "2691200",
    "end": "2696560"
  },
  {
    "text": "very nice slash one two three four oh nice okay okay so",
    "start": "2696560",
    "end": "2701839"
  },
  {
    "text": "it was a priority thing this is uh it beats me i didn't do this before i guess so yeah so this",
    "start": "2701839",
    "end": "2707839"
  },
  {
    "text": "is winning this is winning if nobody matches then this wins all right so if i do slash admin i",
    "start": "2707839",
    "end": "2714240"
  },
  {
    "text": "believe the last one wins good awesome which is all back ends right you can see it guys",
    "start": "2714240",
    "end": "2720480"
  },
  {
    "text": "all right we have done the old back end this is the app one app two split what a fantastic",
    "start": "2720480",
    "end": "2728240"
  },
  {
    "text": "what a fantastic thing to do so far all right what do we have next my",
    "start": "2728240",
    "end": "2733440"
  },
  {
    "start": "2730000",
    "end": "2870000"
  },
  {
    "text": "friends what do we have next we have the blocking of certain requests",
    "start": "2733440",
    "end": "2738880"
  },
  {
    "text": "right so let's let's do this copy this and then i'm going to call this slash block admin all right and then",
    "start": "2738880",
    "end": "2748240"
  },
  {
    "text": "how do we block admin we're going to use the response object here guys to do this thing to do",
    "start": "2748240",
    "end": "2755280"
  },
  {
    "text": "the blocking of the admin now you can see that things are getting easier once we figure out the",
    "start": "2755280",
    "end": "2761680"
  },
  {
    "text": "the actual configuration right i didn't want to copy and paste just like because i want to show you the pain right and i am here",
    "start": "2761680",
    "end": "2769119"
  },
  {
    "text": "just to take your pain guys feel your pain that's what i'm here for all right so",
    "start": "2769119",
    "end": "2775119"
  },
  {
    "text": "the first thing we're going to do is i'm going to add it at the first and this is easy because we didn't don't really need a back-end to block admin so",
    "start": "2775119",
    "end": "2781599"
  },
  {
    "text": "all we do is like anything slash admin we don't map it to our cluster",
    "start": "2781599",
    "end": "2786960"
  },
  {
    "text": "we do a direct response and then the response will be literally",
    "start": "2786960",
    "end": "2794000"
  },
  {
    "text": "status 403 which is forbidden all right and we can also add some body",
    "start": "2794000",
    "end": "2799520"
  },
  {
    "text": "if you want to right like do an inline string say forbidden for",
    "start": "2799520",
    "end": "2808359"
  },
  {
    "text": "forbidden yo something like that you get the idea",
    "start": "2808359",
    "end": "2813680"
  },
  {
    "text": "right i don't think we need that this is a config and yeah will this work",
    "start": "2813680",
    "end": "2821920"
  },
  {
    "text": "it's me now we're gonna call it block admin we're gonna load the config",
    "start": "2821920",
    "end": "2827119"
  },
  {
    "text": "guys all right let's clear this we're going to load the config that's called",
    "start": "2827119",
    "end": "2832400"
  },
  {
    "text": "block admin going to zoom in so you can see you guys complain about this a lot all right ooh worked now",
    "start": "2832400",
    "end": "2840000"
  },
  {
    "text": "refresh [Laughter] forbidden yo and what did we get did we",
    "start": "2840000",
    "end": "2845760"
  },
  {
    "text": "get the correct uh code whatever it's called 403 yes queen",
    "start": "2845760",
    "end": "2850800"
  },
  {
    "text": "look at this headers forbidden babes right forbidden app one still works",
    "start": "2850800",
    "end": "2859200"
  },
  {
    "text": "i love it i love it i love it i love it all right so that's admin",
    "start": "2859200",
    "end": "2864960"
  },
  {
    "text": "that's blocking admin we move to",
    "start": "2864960",
    "end": "2870880"
  },
  {
    "start": "2870000",
    "end": "3240000"
  },
  {
    "text": "tcp proxy dun dun dun [Music] tcp dirty ammo all right guys",
    "start": "2870880",
    "end": "2879359"
  },
  {
    "text": "all right so i'm gonna cheat obviously i'm gonna copy and paste",
    "start": "2879359",
    "end": "2884839"
  },
  {
    "text": "boop but it's so easy guys it's it's way easier tcp proxy is way easier",
    "start": "2884839",
    "end": "2891839"
  },
  {
    "text": "at least uh from what i remember so it's all good uh we're not gonna",
    "start": "2891839",
    "end": "2898800"
  },
  {
    "text": "call it the listener we're not going to call it by the way you can give that listener a name i forgot about that but we don't",
    "start": "2898800",
    "end": "2904880"
  },
  {
    "text": "have to the filter will be network dot tcp proxy",
    "start": "2904880",
    "end": "2912640"
  },
  {
    "text": "awesome and then the type config all this garbage what you do envoy",
    "start": "2912640",
    "end": "2919520"
  },
  {
    "text": "the config the filter the network dot tcp",
    "start": "2919520",
    "end": "2926160"
  },
  {
    "text": "proxy the v2 because v1 sucked tcp proxy all right",
    "start": "2926160",
    "end": "2933839"
  },
  {
    "text": "and then no we're going to call it http products we're going to call it tcp proxy and then yeah let's call it all backend",
    "start": "2933839",
    "end": "2940880"
  },
  {
    "text": "we're gonna because we're gonna filter all back in but let's see if this all this stuff",
    "start": "2940880",
    "end": "2947119"
  },
  {
    "text": "by the way is not applicable anymore right we don't we don't do matching because you don't have access to the content",
    "start": "2947119",
    "end": "2954160"
  },
  {
    "text": "well you do like sni and stuff like that so stuff that is unencrypted but you can't",
    "start": "2954160",
    "end": "2959280"
  },
  {
    "text": "possibly do slashes and all that stuff so all you do is is so simple",
    "start": "2959280",
    "end": "2965920"
  },
  {
    "text": "oh no no of this virtual host nothing all you do is basically on a stat prefix",
    "start": "2965920",
    "end": "2972400"
  },
  {
    "text": "you do no routing nothing just just go there",
    "start": "2972400",
    "end": "2977440"
  },
  {
    "text": "we don't even need hdb filters because why filtering right and the old back end and the back",
    "start": "2977440",
    "end": "2984319"
  },
  {
    "text": "end should be the same right because we just need still need load balance so we don't need still needs strike dns we do",
    "start": "2984319",
    "end": "2990000"
  },
  {
    "text": "still need all that stuff right and this will basically any request",
    "start": "2990000",
    "end": "2996160"
  },
  {
    "text": "will go to always this backing right and uh let's try this thing tcp",
    "start": "2996160",
    "end": "3003440"
  },
  {
    "text": "i have a feeling that i was gonna fail oh works works my friends all right so now going to 88.88 you're going to",
    "start": "3003440",
    "end": "3009839"
  },
  {
    "text": "start seeing the the uncoordination between the the the threads let's let's show that so",
    "start": "3009839",
    "end": "3017440"
  },
  {
    "text": "now fight refresh look at this this is now the browser is out of touch",
    "start": "3017440",
    "end": "3025280"
  },
  {
    "text": "when it comes to tcp proxy why because the browser especially with http 1 1 spins up multiple tcp connection and",
    "start": "3025280",
    "end": "3032640"
  },
  {
    "text": "when i do refresh i send a get request to one of those but i have no control over which ones",
    "start": "3032640",
    "end": "3038640"
  },
  {
    "text": "so the browser can use the same tcp connection and send the same request to",
    "start": "3038640",
    "end": "3044000"
  },
  {
    "text": "it like in this case right so it's two two two two so we're hitting the same tcp connection which always funnels to the same",
    "start": "3044000",
    "end": "3051520"
  },
  {
    "text": "back end host that's tcp proxy it's sticky by nature right we can't it's a",
    "start": "3051520",
    "end": "3057040"
  },
  {
    "text": "stateful thing we have to always forward it to the same back end right so and if you were like if you're",
    "start": "3057040",
    "end": "3062559"
  },
  {
    "text": "refreshed and you might hit the browser decides to okay let's hit another tcp connections here",
    "start": "3062559",
    "end": "3068319"
  },
  {
    "text": "but to to demonstrate this accurately we're going to use",
    "start": "3068319",
    "end": "3073520"
  },
  {
    "text": "cal we're going to use cal curl http hussein mac",
    "start": "3073520",
    "end": "3081119"
  },
  {
    "text": "8080 boom four four four four boom four four four four boom one one",
    "start": "3081119",
    "end": "3088240"
  },
  {
    "text": "one one you can see that it's not load balancing but this creates a new",
    "start": "3088240",
    "end": "3093760"
  },
  {
    "text": "tcp connection with every request so we know we're assigning a new tcp",
    "start": "3093760",
    "end": "3099119"
  },
  {
    "text": "connection but envoy is not properly load balancing those poppies why and i",
    "start": "3099119",
    "end": "3106400"
  },
  {
    "text": "this is the issue i created for uh for the envoy repo and the author just told me hey by",
    "start": "3106400",
    "end": "3111599"
  },
  {
    "text": "the way this is a known issue we know about this this this is because we have no idea which",
    "start": "3111599",
    "end": "3117359"
  },
  {
    "text": "thread actually executed what request there is no knowledge right that is stored somewhere that's for",
    "start": "3117359",
    "end": "3123680"
  },
  {
    "text": "performance reasons and the reason is all threads act by themselves right they they are",
    "start": "3123680",
    "end": "3130640"
  },
  {
    "text": "independent so they don't know saying hey by the way i just touched this host let me go",
    "start": "3130640",
    "end": "3135760"
  },
  {
    "text": "to another host they don't have this knowledge it's just they are balancing the threads correctly",
    "start": "3135760",
    "end": "3141200"
  },
  {
    "text": "but you might hit in this case for example we hit thread one and this gets mine hit thread two",
    "start": "3141200",
    "end": "3146559"
  },
  {
    "text": "but thread two also hits the same host which is four four four four right so in this case we hit maybe three",
    "start": "3146559",
    "end": "3153200"
  },
  {
    "text": "threads all of them are our best just basically the same host we just got unlucky so how do we solve",
    "start": "3153200",
    "end": "3160880"
  },
  {
    "text": "this or i guess not solve it how do you actually mitigate that so so so we know we're hitting it",
    "start": "3160880",
    "end": "3167920"
  },
  {
    "text": "accurately right we run invoi as a single threaded app",
    "start": "3167920",
    "end": "3173119"
  },
  {
    "text": "which is obviously not a good idea but just to show you the idea so we do",
    "start": "3173119",
    "end": "3178200"
  },
  {
    "text": "concurrency equal one i think equal one oh it's another one just concurrency one",
    "start": "3178200",
    "end": "3184079"
  },
  {
    "text": "that means it will start invoice with one thread and we have one thread we're always going to send it to the same",
    "start": "3184079",
    "end": "3189920"
  },
  {
    "text": "thread and that thread is properly load balancing so let's go back to kerl and then do",
    "start": "3189920",
    "end": "3197359"
  },
  {
    "text": "two two two three three three four four four now let's see that's now it's properly load balanced because",
    "start": "3197359",
    "end": "3204720"
  },
  {
    "text": "every tcp connection that curl creates will end up in a new host right so now",
    "start": "3204720",
    "end": "3210800"
  },
  {
    "text": "it's beautifully beautifully beautifully load balanced which i absolutely",
    "start": "3210800",
    "end": "3217680"
  },
  {
    "text": "adore tcp proxy all righty",
    "start": "3217680",
    "end": "3224800"
  },
  {
    "text": "guys all righty so let's jump and do some more",
    "start": "3224800",
    "end": "3231520"
  },
  {
    "text": "fancy stuff we're gonna secure this stuff we're gonna create a dns record right we're going to create a dns record",
    "start": "3231520",
    "end": "3238480"
  },
  {
    "text": "first of all this is the the app the final version is this i'm going to call it http",
    "start": "3238480",
    "end": "3244079"
  },
  {
    "start": "3240000",
    "end": "3330000"
  },
  {
    "text": "dot the ammo right this has the old http i'm going to use http for now right",
    "start": "3244079",
    "end": "3249520"
  },
  {
    "text": "all right guys so now i'm gonna listen on port 80 for envoy okay the reason is because i",
    "start": "3249520",
    "end": "3256000"
  },
  {
    "text": "want to do a port forwarding on my router so that all requests goes",
    "start": "3256000",
    "end": "3262000"
  },
  {
    "text": "to the to the dns entry that i'm going to create goes to invoice right so let's just start this up with uh http",
    "start": "3262000",
    "end": "3271359"
  },
  {
    "text": "i don't know if i'm going to run as i don't need to run as admin okay so this is port 80. let's",
    "start": "3271359",
    "end": "3277119"
  },
  {
    "text": "test this out guys i'm going to go to no ip.com",
    "start": "3277119",
    "end": "3282720"
  },
  {
    "text": "we have an active one i'm going to destroy this puppy why do i have to destroy why can't i use",
    "start": "3282720",
    "end": "3288640"
  },
  {
    "text": "it the same one so i'm going to use invoicetesting.dns.net let's let's create another one let's create another one better i'm going to",
    "start": "3288640",
    "end": "3295040"
  },
  {
    "text": "call it invoicedemo.dns.net so i'm going to this entry in a record points to this",
    "start": "3295040",
    "end": "3301520"
  },
  {
    "text": "ipl which is my app so now if i go to dns oh what was actually pretty fast",
    "start": "3301520",
    "end": "3306799"
  },
  {
    "text": "so now i have it but this is unsecured guys so this is",
    "start": "3306799",
    "end": "3313520"
  },
  {
    "text": "right so how do i i should essentially secure this thing so what we're going to",
    "start": "3314000",
    "end": "3320559"
  },
  {
    "text": "do is enable let's encrypt right by doing that how do we do that",
    "start": "3320559",
    "end": "3326000"
  },
  {
    "text": "we're going to create a private and a public key and let's kill invite first",
    "start": "3326000",
    "end": "3332559"
  },
  {
    "start": "3330000",
    "end": "3780000"
  },
  {
    "text": "i'm going to use searchbot to create a private and public certificate",
    "start": "3332559",
    "end": "3338960"
  },
  {
    "text": "assign uh envoy those certificate and then start up again as a on port 443",
    "start": "3338960",
    "end": "3347200"
  },
  {
    "text": "so that we can essentially test this software all right so and then",
    "start": "3347200",
    "end": "3352640"
  },
  {
    "text": "enable uh the https on the proxy let does do this all right so",
    "start": "3352640",
    "end": "3358799"
  },
  {
    "text": "to do this we do sudo searchbot dash dash stand alone so it's a",
    "start": "3358799",
    "end": "3365280"
  },
  {
    "text": "certbot cert only stand alone and by doing that",
    "start": "3365280",
    "end": "3371760"
  },
  {
    "text": "we're going to start basically search ball which is the incre let's encrypt uh daemon",
    "start": "3371760",
    "end": "3378400"
  },
  {
    "text": "right which will uh communicate with let's encrypt to to generate those uh for us but let's just run it as",
    "start": "3378400",
    "end": "3384000"
  },
  {
    "text": "wrote we have to render as root because we are essentially writing stuff to the disk and we are",
    "start": "3384000",
    "end": "3390400"
  },
  {
    "text": "also listening on port 80 the search bar listening port 80 and communicating with let's encrypt to prove that i own",
    "start": "3390400",
    "end": "3397760"
  },
  {
    "text": "this domain so if i do this the first thing okay give me the domain paste and void",
    "start": "3397760",
    "end": "3404000"
  },
  {
    "text": "domain dns.net so now what they will do is they will listen they will send they will basically prove",
    "start": "3404000",
    "end": "3410160"
  },
  {
    "text": "that i own this domain which i do right and then that's it i have the private",
    "start": "3410160",
    "end": "3415680"
  },
  {
    "text": "key and i have the full chain all i have to do is basically",
    "start": "3415680",
    "end": "3420960"
  },
  {
    "text": "copy this thing to my current uh cert dot let's call cert.pm right",
    "start": "3420960",
    "end": "3428160"
  },
  {
    "text": "ah pseudo because it's uh",
    "start": "3428160",
    "end": "3433440"
  },
  {
    "text": "because it's in an end in a protected directory so do sudo sure",
    "start": "3433440",
    "end": "3438480"
  },
  {
    "text": "and then i'm gonna also copy the private the pm to private",
    "start": "3438480",
    "end": "3446160"
  },
  {
    "text": "is it called private i forgot no prive let's let's do the same",
    "start": "3446160",
    "end": "3452240"
  },
  {
    "text": "it's called privkie.pim as private.p.m i like to call it private just for some",
    "start": "3454240",
    "end": "3460559"
  },
  {
    "text": "pleasure there all right copy this puppy now we have it both now we have to do a uh",
    "start": "3460559",
    "end": "3468640"
  },
  {
    "text": "the search mode to identify what can we do with this private key we're gonna do seven five",
    "start": "3468640",
    "end": "3474960"
  },
  {
    "text": "five that means the user can execute right me as the owner i can",
    "start": "3474960",
    "end": "3480000"
  },
  {
    "text": "execute and write and and uh where's the the third thing read right and the groups and then can only read",
    "start": "3480000",
    "end": "3486240"
  },
  {
    "text": "and execute right and then private.p you have to do this otherwise it won't work",
    "start": "3486240",
    "end": "3491440"
  },
  {
    "text": "was it oh obviously cannot do because we have to do sudo",
    "start": "3491440",
    "end": "3496559"
  },
  {
    "text": "sudo all right done now we have the files let's copy this",
    "start": "3496559",
    "end": "3503520"
  },
  {
    "text": "puppy i'm going to call it uh tls.yaml all right and this time i'm",
    "start": "3503520",
    "end": "3510160"
  },
  {
    "text": "going to listen on port 443 or tls all right guys so under filters",
    "start": "3510160",
    "end": "3516240"
  },
  {
    "text": "chain right here we're gonna add filter chain let's make",
    "start": "3516240",
    "end": "3522880"
  },
  {
    "text": "it yours under filters chain because that's the trick here filters chain under here",
    "start": "3522880",
    "end": "3528000"
  },
  {
    "text": "filters right by filters we're going to add a new one called a transport socket which is for tls all",
    "start": "3528000",
    "end": "3533839"
  },
  {
    "text": "right give it a name name invoice.transport",
    "start": "3533839",
    "end": "3539559"
  },
  {
    "text": "sockets.tls that's just another filter right and then we're gonna call typed",
    "start": "3539559",
    "end": "3544799"
  },
  {
    "text": "config hopefully i nailed this right this time and then we're gonna call it uh",
    "start": "3544799",
    "end": "3550480"
  },
  {
    "text": "type this is the the type actual type behind the type dot google apis dot",
    "start": "3550480",
    "end": "3558000"
  },
  {
    "text": "com slash invoice extensions dot transport underscore sockets",
    "start": "3558000",
    "end": "3564640"
  },
  {
    "text": "dot tls.v3 dot down stream we have spelled that right tls contacts",
    "start": "3564640",
    "end": "3573040"
  },
  {
    "text": "and now the most important thing the most important thing common tls context",
    "start": "3573040",
    "end": "3581200"
  },
  {
    "text": "awesome under that the common tls context which is the configuration",
    "start": "3581200",
    "end": "3586559"
  },
  {
    "text": "tls oh whoa whoa come on tls underscore certificates that's one more",
    "start": "3586559",
    "end": "3592640"
  },
  {
    "text": "important thing and then what we're going to do is do the certificate certificate",
    "start": "3592640",
    "end": "3599480"
  },
  {
    "text": "certificate underscore chain which is the chain i wish i just called the chain file name",
    "start": "3599480",
    "end": "3606880"
  },
  {
    "text": "is what the the cert.pm right that's why we called it cert.pm by the way this will not be",
    "start": "3606880",
    "end": "3613680"
  },
  {
    "text": "pushed to you guys because i i add them to my ignore file and then we do private underscore key",
    "start": "3613680",
    "end": "3621359"
  },
  {
    "text": "da file name underscore file name is what private dot",
    "start": "3621359",
    "end": "3628480"
  },
  {
    "text": "pm and if we don't do the search mode and changing the uh own in the mode on the file",
    "start": "3628480",
    "end": "3634799"
  },
  {
    "text": "uh what's his name this this guy won't be able to read [Music] the thingy the file envoy won't be able",
    "start": "3634799",
    "end": "3642640"
  },
  {
    "text": "to read it and i think that's it guys the rest of the stuff we're going to add later",
    "start": "3642640",
    "end": "3648240"
  },
  {
    "text": "right but let's see if we have https now let's call it t tls that that's what we call it right",
    "start": "3648240",
    "end": "3655200"
  },
  {
    "text": "tls.ammo boom we have an error what is that",
    "start": "3655200",
    "end": "3661760"
  },
  {
    "text": "let's just fix it oh we have an error on the file why why are we complaining filters oh my god it's under filters",
    "start": "3661760",
    "end": "3667839"
  },
  {
    "text": "okay oh guys i'm i'm i don't know guys how people do it kudos to everyone who knows",
    "start": "3667839",
    "end": "3674960"
  },
  {
    "text": "the ammo and and know how to deal with this stuff because i don't know guys how to deal with this stuff anymore all",
    "start": "3674960",
    "end": "3681920"
  },
  {
    "text": "right this is just in decision apparently transparent socket is under filters not a filter chain so this just taps",
    "start": "3681920",
    "end": "3690400"
  },
  {
    "text": "even in python i despise this stuff taps and spaces nobody should use tabs",
    "start": "3690400",
    "end": "3697599"
  },
  {
    "text": "and spaces for coding right to to to determine the correction of the coding all right",
    "start": "3697599",
    "end": "3706798"
  },
  {
    "text": "let's say okay http is not working but https right because i don't have an http endpoint right oh",
    "start": "3706880",
    "end": "3715119"
  },
  {
    "text": "secure babe secure secure and it's beautiful",
    "start": "3715119",
    "end": "3722799"
  },
  {
    "text": "now if i go invoicedemo it's just like doing its own thing right so now if i go ssl labs ssl",
    "start": "3722799",
    "end": "3729599"
  },
  {
    "text": "labs all right oh i want to do this do this for me please analyze me analyze",
    "start": "3729599",
    "end": "3735839"
  },
  {
    "text": "my invoice demo.dns so guy i might have not explained it ssl lab actually",
    "start": "3735839",
    "end": "3740880"
  },
  {
    "text": "just tries every possible way to communicate with your server and tests every single thing",
    "start": "3740880",
    "end": "3748160"
  },
  {
    "text": "securely on your server to see how and give it a great essentially based on the kind of cipher supports based on",
    "start": "3748160",
    "end": "3754799"
  },
  {
    "text": "test attacks and we get a stinking b we get a stinking by",
    "start": "3754799",
    "end": "3760559"
  },
  {
    "text": "because yeah our server does support ts 1.3 but it also supports 1.0 and 1.1",
    "start": "3760559",
    "end": "3767119"
  },
  {
    "text": "and before we get to that and get it and get it right look at this guys if i go to developer",
    "start": "3767119",
    "end": "3773200"
  },
  {
    "text": "tools and i refresh http one one what year is this",
    "start": "3773200",
    "end": "3779359"
  },
  {
    "text": "http one one seriously why is not that's the default htv too",
    "start": "3779359",
    "end": "3784640"
  },
  {
    "start": "3780000",
    "end": "3870000"
  },
  {
    "text": "i get guys obviously i'm joking hdb2 it's it's a good protocol but it could",
    "start": "3784640",
    "end": "3789839"
  },
  {
    "text": "be it can actually increase your cpu usage and then people are still figuring it out so",
    "start": "3789839",
    "end": "3795760"
  },
  {
    "text": "should be there's nothing wrong with hdb11 if you know what you're doing i mean cloudflare the other day just found a",
    "start": "3795760",
    "end": "3801920"
  },
  {
    "text": "big bug in http 2 and fixed it with the upload speeds and i made a video about it check it out check that out",
    "start": "3801920",
    "end": "3808480"
  },
  {
    "text": "but i want to first enable hdb2 because it's awesome what do we do how do we do that it's",
    "start": "3808480",
    "end": "3814480"
  },
  {
    "text": "very very very simple we're going to add in the alpn which is the application",
    "start": "3814480",
    "end": "3821200"
  },
  {
    "text": "layer protocol nagociacions protocols and we're going to add an",
    "start": "3821200",
    "end": "3826480"
  },
  {
    "text": "array right we're going to support ash2 and we're going to have http11 not just h211",
    "start": "3826480",
    "end": "3834240"
  },
  {
    "text": "and this should be under common tls hopefully i nailed this thing because i have no idea",
    "start": "3834240",
    "end": "3839680"
  },
  {
    "text": "what things are under which with with just looking at the spaces guys right so yeah kill it run it again",
    "start": "3839680",
    "end": "3848000"
  },
  {
    "text": "refresh and then if i look refresh again oh come on come on come on",
    "start": "3848000",
    "end": "3856240"
  },
  {
    "text": "come on come on come on ooh ash too babes ash too",
    "start": "3856240",
    "end": "3862880"
  },
  {
    "text": "ash too that's what that's what we're talking about man ash2 hdb2 all right so now we enable",
    "start": "3862880",
    "end": "3869280"
  },
  {
    "text": "gtb2 the final thing we're gonna do before we end this video is",
    "start": "3869280",
    "end": "3874799"
  },
  {
    "start": "3870000",
    "end": "4000000"
  },
  {
    "text": "we're gonna disable tls one point uh one and one point oh and guys",
    "start": "3874799",
    "end": "3882799"
  },
  {
    "text": "this stinking parameters took me one hour of search to find it",
    "start": "3882799",
    "end": "3890000"
  },
  {
    "text": "there's no way there's it doesn't exist in documentation they tell you that the minimum this thing minimum",
    "start": "3890000",
    "end": "3897839"
  },
  {
    "text": "protocol version right tls",
    "start": "3897839",
    "end": "3904000"
  },
  {
    "text": "v 1.2 they tell you oh just set it this way they get they do this but they don't give you the stinking",
    "start": "3904000",
    "end": "3910079"
  },
  {
    "text": "parameter so you have no idea where you where the heck you put this thing you put it here",
    "start": "3910079",
    "end": "3916400"
  },
  {
    "text": "and and the name of the protofile is actually parameters so i tried this and it says no there is nothing that's called",
    "start": "3916400",
    "end": "3922319"
  },
  {
    "text": "parameters what do you mean right so i i found someone actually",
    "start": "3922319",
    "end": "3927520"
  },
  {
    "text": "using tias params i might be missing something guys i might be missing something but",
    "start": "3927520",
    "end": "3933200"
  },
  {
    "text": "i think and boy guys you should just put it a one config that has pretty much",
    "start": "3933200",
    "end": "3938319"
  },
  {
    "text": "everything in it and saves the day just put it in there it doesn't exist don't tell me it exists in the in the",
    "start": "3938319",
    "end": "3943760"
  },
  {
    "text": "repo it does not you don't have a tls exam example in your repo so sorry about that you don't have",
    "start": "3943760",
    "end": "3950880"
  },
  {
    "text": "that i i searched maybe you're gonna add it after this video but please do because man that was painful",
    "start": "3950880",
    "end": "3957520"
  },
  {
    "text": "to search i don't know how people are working with the with the product if you can't find examples",
    "start": "3957520",
    "end": "3962640"
  },
  {
    "text": "and i guess probably big companies who move to like dropbox move to envoy they",
    "start": "3962640",
    "end": "3968559"
  },
  {
    "text": "have like side by side working with envoy team directly so they don't have this problem but measly",
    "start": "3968559",
    "end": "3975280"
  },
  {
    "text": "people like us like me all right how do i know right",
    "start": "3975280",
    "end": "3980640"
  },
  {
    "text": "i need the dock i need the dock to be good all right so i disabled uh tls 1.1 i made the minimum version",
    "start": "3980640",
    "end": "3987280"
  },
  {
    "text": "technically 1.2 so now if i refereesh obviously there's no difference here",
    "start": "3987280",
    "end": "3993039"
  },
  {
    "text": "but uh ah this guy is gonna tell us clear cash do it again how much do we get",
    "start": "3993039",
    "end": "4000160"
  },
  {
    "start": "4000000",
    "end": "4044000"
  },
  {
    "text": "guys yeah hey babes that's right we get an a i think there's",
    "start": "4000160",
    "end": "4006880"
  },
  {
    "text": "a way to get a plus but i don't know how i think you have to enable what is the the stapling thing the certificate",
    "start": "4006880",
    "end": "4012160"
  },
  {
    "text": "stapling to to to to see whether the certificate has been",
    "start": "4012160",
    "end": "4017359"
  },
  {
    "text": "stapled with that with the validity so that's still valid or not so once you have that stapling",
    "start": "4017359",
    "end": "4023520"
  },
  {
    "text": "certificate stapling for god's uh status protocol forgot was called but",
    "start": "4023520",
    "end": "4028640"
  },
  {
    "text": "yeah guys we're a babes we have an invoice running server",
    "start": "4028640",
    "end": "4034640"
  },
  {
    "text": "with an a rating ts 1.3 all that good stuff how about we go back to the",
    "start": "4034640",
    "end": "4041599"
  },
  {
    "text": "slides and finish up this video summary",
    "start": "4041599",
    "end": "4048640"
  },
  {
    "start": "4044000",
    "end": "4328000"
  },
  {
    "text": "so guys i enjoyed making this video i gotta say but the only frustrating thing guys was uh just the ammo configuration",
    "start": "4048640",
    "end": "4055119"
  },
  {
    "text": "to be honest i'm just i'm just i'm just very bad at yammel so i blame myself but even though like",
    "start": "4055119",
    "end": "4061039"
  },
  {
    "text": "how do how do people do this stuff how do you know that this config is under this so you add a tab",
    "start": "4061039",
    "end": "4066559"
  },
  {
    "text": "and then you have to scroll all the way and find oh this is under this this is under this it's it's unusable it's very hard i",
    "start": "4066559",
    "end": "4073760"
  },
  {
    "text": "guess that's why people had like vertical screens or stuff like that right and you just do it as jason jason",
    "start": "4073760",
    "end": "4079599"
  },
  {
    "text": "it's a structure right yeah i know jason you can't do comments in but",
    "start": "4079599",
    "end": "4084960"
  },
  {
    "text": "whatever i know i think we need something better than yaml i don't like it one bit i don't like it one bit and then look",
    "start": "4084960",
    "end": "4092240"
  },
  {
    "text": "it's very easy to get errors do you sell what i've done how many times did i post the video i mean i cut a lot of",
    "start": "4092240",
    "end": "4099600"
  },
  {
    "text": "stuff but i show you all the places where i have made mistakes right so yeah current and desired",
    "start": "4099600",
    "end": "4105758"
  },
  {
    "text": "architecture guys we talked about that and we're gonna talk about the invoice architecture it's a very interesting",
    "start": "4105759",
    "end": "4110960"
  },
  {
    "text": "threading model very interesting connection pooling model very interesting proxy i love it right i love it i might actually",
    "start": "4110960",
    "end": "4119120"
  },
  {
    "text": "start using it more and more the configuration needs a little bit more more work to be honest to make it a",
    "start": "4119120",
    "end": "4124238"
  },
  {
    "text": "little bit simpler to write because i don't like to copy and paste config i mean yeah maybe if i",
    "start": "4124239",
    "end": "4129920"
  },
  {
    "text": "if i understand everything i'll start copying and pasting but i like to remember things like okay if it's simple",
    "start": "4129920",
    "end": "4135040"
  },
  {
    "text": "then i easy to remember then i just sit down and i write it very quickly and",
    "start": "4135040",
    "end": "4140159"
  },
  {
    "text": "yeah it's just easier but yeah that's just me but yeah i think we talked about the",
    "start": "4140159",
    "end": "4145520"
  },
  {
    "text": "envoy architecture it's a good good it's a good proxy i love it compared to the others",
    "start": "4145520",
    "end": "4150640"
  },
  {
    "text": "right i still didn't test it performance compared to the others but sounds",
    "start": "4150640",
    "end": "4156159"
  },
  {
    "text": "promising as a the most important thing in a proxy in my opinion is to me to understand how it works",
    "start": "4156159",
    "end": "4163040"
  },
  {
    "text": "right so if you end up wanting to debug it or you want to test or you want to to kind of tune it",
    "start": "4163040",
    "end": "4169758"
  },
  {
    "text": "then you understand how to tune it right otherwise you'll be copying and pasting config which is i",
    "start": "4169759",
    "end": "4175199"
  },
  {
    "text": "something i'm completely against you have to understand every single piece of config you copy i've been saying this",
    "start": "4175199",
    "end": "4181920"
  },
  {
    "text": "for the past three years of my channel always never copy and paste use clatter",
    "start": "4181920",
    "end": "4186960"
  },
  {
    "text": "knowledge to your advantage right to to kind of grow as an engineer otherwise whatever what are we doing right so we",
    "start": "4186960",
    "end": "4194560"
  },
  {
    "text": "need to actually understand what it's doing so we can tune make it better that applies to any",
    "start": "4194560",
    "end": "4200159"
  },
  {
    "text": "proxy not just envoy demo we do the demo you saw everything we made tls 1.3 1.2",
    "start": "4200159",
    "end": "4207040"
  },
  {
    "text": "we we tested we disabled ts 1.1 we we essentially did layer 7 proxy and we",
    "start": "4207040",
    "end": "4213199"
  },
  {
    "text": "did layer 4 proxy and we did concurrently we we made envoy a single threaded proxy",
    "start": "4213199",
    "end": "4218560"
  },
  {
    "text": "which is probably not a good idea but i want to see it how it performs as a single threaded app right uh it's going to be interesting",
    "start": "4218560",
    "end": "4226400"
  },
  {
    "text": "but yeah that i i liked it i like i gotta say i like him boy i like it i",
    "start": "4226400",
    "end": "4232080"
  },
  {
    "text": "feel i feel there is a connection between me and void i love it right still i think my favorite's still",
    "start": "4232080",
    "end": "4237199"
  },
  {
    "text": "in h a proxy to be honest i just have a different connection with the chip roxy i don't know why right the jet proxy issue proxy and",
    "start": "4237199",
    "end": "4244880"
  },
  {
    "text": "invoice have something in common which is the fact that they want stick to be a proxy which is something i",
    "start": "4244880",
    "end": "4251280"
  },
  {
    "text": "love i think traffic falls into the same category as well they give you a low level direct response just hi proxy in",
    "start": "4251280",
    "end": "4258159"
  },
  {
    "text": "version 2 2 i guess just gave you this feature to give you a response but it's not a full fledged web server",
    "start": "4258159",
    "end": "4264800"
  },
  {
    "text": "because people know that this is difficult to build they are rather fair fix focus on building",
    "start": "4264800",
    "end": "4273280"
  },
  {
    "text": "a proxy not a web server right that's why nginx right and nginx is gonna do fine i mean",
    "start": "4273280",
    "end": "4281120"
  },
  {
    "text": "it's doing fun for the longest time it's been a it's a long project but it struggles being a web server and",
    "start": "4281120",
    "end": "4286880"
  },
  {
    "text": "a proxy because you have every every day there are security bugs",
    "start": "4286880",
    "end": "4292080"
  },
  {
    "text": "specific to being a web server there are security stuff specific to proxy and",
    "start": "4292080",
    "end": "4298080"
  },
  {
    "text": "imagine you are supporting both you have to fix those security you have to enable features on both you have to",
    "start": "4298080",
    "end": "4303760"
  },
  {
    "text": "you have to do all that stuff on both these features so focus on one thing your next strategy",
    "start": "4303760",
    "end": "4309440"
  },
  {
    "text": "one thing and one thing only and that's just that's just me obviously guys i left the question back to you what do you think",
    "start": "4309440",
    "end": "4315120"
  },
  {
    "text": "about envoy do you like this course do you like invoice in general uh or what do you use as a proxy again",
    "start": "4315120",
    "end": "4321679"
  },
  {
    "text": "let me know in the comment section below i'm gonna see you in the next one you guys stay awesome goodbye",
    "start": "4321679",
    "end": "4329198"
  }
]