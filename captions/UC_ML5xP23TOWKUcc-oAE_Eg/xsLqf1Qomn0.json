[
  {
    "start": "0",
    "end": "180000"
  },
  {
    "text": "cloudfare has just fixed a vulnerability in their Mutual TLS offering they have",
    "start": "140",
    "end": "6240"
  },
  {
    "text": "been sitting there for close to two years it was released in a feature",
    "start": "6240",
    "end": "12480"
  },
  {
    "text": "called the firewall rules where customers of cloudfare can create",
    "start": "12480",
    "end": "19100"
  },
  {
    "text": "client-side certificates that's how Mutual TLS Works basically and configure",
    "start": "19100",
    "end": "25680"
  },
  {
    "text": "them for certain clients such that only those clients can even",
    "start": "25680",
    "end": "31199"
  },
  {
    "text": "connect or send particular requests to this back-end you know you see no",
    "start": "31199",
    "end": "36420"
  },
  {
    "text": "irregular TLS the authentication only happens on one way you know all clients",
    "start": "36420",
    "end": "43140"
  },
  {
    "text": "are usually allowed but servers must be authenticated by clients so that we know",
    "start": "43140",
    "end": "49980"
  },
  {
    "text": "that we're connected to the to the correct server and this is usually done through certificates in client and in",
    "start": "49980",
    "end": "58079"
  },
  {
    "text": "mutual TLS the client also supplies certificates",
    "start": "58079",
    "end": "63539"
  },
  {
    "text": "and in that feature that they introduced the clever introduced",
    "start": "63539",
    "end": "69860"
  },
  {
    "text": "users can revoke client certificates if they found out that this particular",
    "start": "69860",
    "end": "76740"
  },
  {
    "text": "clients actually let's say it's an iot device that is producing logs and you",
    "start": "76740",
    "end": "82439"
  },
  {
    "text": "only want these particular iot devices to produce logs you don't want logs from a shady place right let's say they found",
    "start": "82439",
    "end": "89520"
  },
  {
    "text": "out that one of the iot device has been compromised and so they you can as a customer go and revoke the client",
    "start": "89520",
    "end": "96000"
  },
  {
    "text": "certificate that iot device can no longer",
    "start": "96000",
    "end": "101600"
  },
  {
    "text": "can no longer they can't connect it's weird with cloudflare they did it a little bit different usually with mtls",
    "start": "103079",
    "end": "110399"
  },
  {
    "text": "if the certification is revoked you can even connect you know the connection the TCP of course works but the TLs fails",
    "start": "110399",
    "end": "118560"
  },
  {
    "text": "because the authentication for the server side you know coming for the for",
    "start": "118560",
    "end": "124680"
  },
  {
    "text": "the client certificate has failed right because of the because the client has failed but we're going to learn after",
    "start": "124680",
    "end": "131480"
  },
  {
    "text": "reading this article that cloudford does it actually differently they they want to cut more customized role so they",
    "start": "131480",
    "end": "138180"
  },
  {
    "text": "allow the connection with revoked but they uh rejected at the layer 7 by",
    "start": "138180",
    "end": "145980"
  },
  {
    "text": "uh having the HTTP request actually carries information about the",
    "start": "145980",
    "end": "153180"
  },
  {
    "text": "certificate and they let the users effectively choose pick and choose which request to",
    "start": "153180",
    "end": "160140"
  },
  {
    "text": "allow even if it's the certificate of the revoked and which were requests are rejected it's very interesting",
    "start": "160140",
    "end": "166739"
  },
  {
    "text": "so the vulnerability is was something called the session resumption uh are often called the pre-shared key",
    "start": "166739",
    "end": "174800"
  },
  {
    "text": "extension you know how about we jump into it and and discuss this this is a",
    "start": "174800",
    "end": "179879"
  },
  {
    "text": "very interesting a ride up from cloudflare alright so this comes from cloudflare blog mtls client certificate",
    "start": "179879",
    "end": "188400"
  },
  {
    "start": "180000",
    "end": "420000"
  },
  {
    "text": "revocation vulnerability with TLS session resumptions so this",
    "start": "188400",
    "end": "193980"
  },
  {
    "text": "vulnerability is a very specific you know first of all you have to be a",
    "start": "193980",
    "end": "199140"
  },
  {
    "text": "customer of cloudflare to have this foreign second you have must have",
    "start": "199140",
    "end": "204239"
  },
  {
    "text": "enabled Mutual TLS right to begin with second you must have revoked or clients",
    "start": "204239",
    "end": "211700"
  },
  {
    "text": "client certificate at some point right how often do you do that right",
    "start": "211700",
    "end": "219120"
  },
  {
    "text": "and and finally even if you revoke that vulnerability",
    "start": "219120",
    "end": "225000"
  },
  {
    "text": "is level Mobility is only happening when",
    "start": "225000",
    "end": "230519"
  },
  {
    "text": "the client performs a session resumption which is a basically skipping the",
    "start": "230519",
    "end": "237420"
  },
  {
    "text": "authentication part that's what the session of assumption is right so there's a lot of factors that needs to",
    "start": "237420",
    "end": "242879"
  },
  {
    "text": "happen for this bug to take all this vulnerability to take place but if it did it's a it's a it's a disaster right",
    "start": "242879",
    "end": "250200"
  },
  {
    "text": "because uh a user right might have not used any",
    "start": "250200",
    "end": "255480"
  },
  {
    "text": "authentication like tokens or username or passwords or anything like that they primarily rely on the client",
    "start": "255480",
    "end": "263660"
  },
  {
    "text": "certificate for authentication right if you do that right so that if once if I",
    "start": "263660",
    "end": "270419"
  },
  {
    "text": "if I know that you have this client certificate technically speaking I don't need username password I don't need",
    "start": "270419",
    "end": "277259"
  },
  {
    "text": "other form of authentication now it's a good idea to have which is like",
    "start": "277259",
    "end": "284220"
  },
  {
    "text": "in this case right uh but you don't have to because that is a way to uniquely identify this client",
    "start": "284220",
    "end": "292680"
  },
  {
    "text": "and because you generated that certificate at some point for them their private key is there baked into the IIT",
    "start": "292680",
    "end": "300180"
  },
  {
    "text": "device whatever things they share the certificate has",
    "start": "300180",
    "end": "305460"
  },
  {
    "text": "been vetted it's known it's trusted right that's why you allow it to connect",
    "start": "305460",
    "end": "310740"
  },
  {
    "text": "but you usually add other form of authentication on top of that and if you do that you're even safer than you're",
    "start": "310740",
    "end": "317639"
  },
  {
    "text": "safe so even if if this vulnerability you know",
    "start": "317639",
    "end": "322979"
  },
  {
    "text": "did happen to you which as according to cloudflare none of their customers",
    "start": "322979",
    "end": "328020"
  },
  {
    "text": "actually were affected by it they looked at their logs and they didn't see anything from March 2021 when they",
    "start": "328020",
    "end": "335880"
  },
  {
    "text": "shipped this feature that enabled this vulnerability up until when they discovered that December 2022",
    "start": "335880",
    "end": "343860"
  },
  {
    "text": "you know so almost close to two years right all right let's read through this and discuss all of this beautiful juicy",
    "start": "343860",
    "end": "353120"
  },
  {
    "text": "juicy details on December 16 2022 that's December 16th is the national day of uh",
    "start": "353120",
    "end": "359880"
  },
  {
    "text": "Bahrain cloudflare discovered a bug where in limited circumstances some",
    "start": "359880",
    "end": "365280"
  },
  {
    "text": "users with revoked certificates may not have been blocked by cloudflare firewall",
    "start": "365280",
    "end": "371820"
  },
  {
    "text": "settings specifically cloudflare firewall rules solution did not block some users with",
    "start": "371820",
    "end": "380280"
  },
  {
    "text": "revoked certificates from resuming a session via Mutual TLS and I'm gonna I'm",
    "start": "380280",
    "end": "387180"
  },
  {
    "text": "gonna talk about session resumption in a minute now even if the customer had",
    "start": "387180",
    "end": "392280"
  },
  {
    "text": "configured firewall's rules to do so this bug has been mitigated and we have no evidence of this being exploited we",
    "start": "392280",
    "end": "400259"
  },
  {
    "text": "notified any customer that they may have been impacted in abundance of caution so they can check their or their own logs",
    "start": "400259",
    "end": "407280"
  },
  {
    "text": "to determine if an mltls protected resource was accessed by entities holding a revoked certificate",
    "start": "407280",
    "end": "414780"
  },
  {
    "text": "and they didn't update this box or I guess not nobody was affected by this so",
    "start": "414780",
    "end": "420840"
  },
  {
    "start": "420000",
    "end": "530000"
  },
  {
    "text": "what happened on Cloud on one of the cloudflare rules features introduced in March 2021 let's",
    "start": "420840",
    "end": "427259"
  },
  {
    "text": "customers revoke and block client certificate preventing it from being used to authenticate and establish a",
    "start": "427259",
    "end": "434280"
  },
  {
    "text": "session for example a customer may use firewall rules to protect a service by requiring clients to provide a client",
    "start": "434280",
    "end": "441960"
  },
  {
    "text": "certificate through the mutual TLS Authentication Protocol customers May revoke or disable a client certificate",
    "start": "441960",
    "end": "449699"
  },
  {
    "text": "after which it will no longer be used to authenticate a party initiating an encrypted session via mtls",
    "start": "449699",
    "end": "458280"
  },
  {
    "text": "we talked about that in the intro right so if you if if a client want to establish a person does a tcpn no no",
    "start": "458280",
    "end": "466199"
  },
  {
    "text": "nothing stopping you from establishing a TCP connection and assume this is ltcp right quick is a little different but",
    "start": "466199",
    "end": "473280"
  },
  {
    "text": "it's all there's always a connection establishment the connection establishes never stopped unless the firewall has a",
    "start": "473280",
    "end": "480180"
  },
  {
    "text": "rule hey this IP address is not allowed all this port is not don't touch that Port right",
    "start": "480180",
    "end": "485520"
  },
  {
    "text": "but the so that is always established followed by a client hello and in mtls",
    "start": "485520",
    "end": "492720"
  },
  {
    "text": "the client must provide a client certificate and the server will use that",
    "start": "492720",
    "end": "499800"
  },
  {
    "text": "certificate and do the same thing that like Lion does for authentication it checks the leaf cert checks who signed",
    "start": "499800",
    "end": "508139"
  },
  {
    "text": "this certificate the certificate Authority and it checks its route to make sure that oh this client certificate is",
    "start": "508139",
    "end": "515219"
  },
  {
    "text": "actually trusted we trust you you may continue if the client certificate has",
    "start": "515219",
    "end": "522300"
  },
  {
    "text": "been revoked uh what happens is well usually or or",
    "start": "522300",
    "end": "527339"
  },
  {
    "text": "even the server for that matter by the way there's like so much stuff here you know and I and I think I talked about it",
    "start": "527339",
    "end": "534540"
  },
  {
    "start": "530000",
    "end": "750000"
  },
  {
    "text": "in some of my videos revocation is one of the most interesting",
    "start": "534540",
    "end": "540500"
  },
  {
    "text": "problems to solve like if I revoke a certificate how do you tell either the",
    "start": "540500",
    "end": "546720"
  },
  {
    "text": "server or the client that this certificate is actually revoked you know so there are many solutions to that the",
    "start": "546720",
    "end": "554459"
  },
  {
    "text": "original was a an actual list yeah here's a bunch of lists right of all the",
    "start": "554459",
    "end": "560640"
  },
  {
    "text": "revoked certificate ever existed in in entirety that list grew",
    "start": "560640",
    "end": "566760"
  },
  {
    "text": "very large very quick then there was a another solution called the yeah",
    "start": "566760",
    "end": "572880"
  },
  {
    "text": "the online certificate status protocol server you know so",
    "start": "572880",
    "end": "578880"
  },
  {
    "text": "there's like okay let's not make a list that this list start being saved on the server and this client let's just do uh",
    "start": "578880",
    "end": "587339"
  },
  {
    "text": "let's just have this list in some server and let the client or the server ping",
    "start": "587339",
    "end": "592560"
  },
  {
    "text": "This ocsp Server to check hey auditor is this rejected is this rejected is this",
    "start": "592560",
    "end": "598860"
  },
  {
    "text": "rejected is this rejected uh this works but what did you notice like",
    "start": "598860",
    "end": "604620"
  },
  {
    "text": "This ocsp Server pretty much knows every website you visit right because you're",
    "start": "604620",
    "end": "610380"
  },
  {
    "text": "actually ping a gig pinging it like hey is a gramlastygrammas.com revoked you know oh",
    "start": "610380",
    "end": "618300"
  },
  {
    "text": "it's not revoked good I I'm totally not visiting their website I'm just asking",
    "start": "618300",
    "end": "624180"
  },
  {
    "text": "so that's that's that's the ocsp server idea again",
    "start": "624180",
    "end": "629459"
  },
  {
    "text": "uh is being kind of killed so the the other solution",
    "start": "629459",
    "end": "636300"
  },
  {
    "text": "is ocsp stapling which is let the server uh prove that this certificate has not",
    "start": "636300",
    "end": "643440"
  },
  {
    "text": "been rejected and so",
    "start": "643440",
    "end": "648600"
  },
  {
    "text": "but by by checking asynchronously with an ocsp server right and that's fine",
    "start": "648600",
    "end": "655019"
  },
  {
    "text": "because the server is not gonna docs itself I suppose right it's gonna",
    "start": "655019",
    "end": "660420"
  },
  {
    "text": "check hey I I just proved that hey this is actually my certificate as of this time this date is not revoked you can",
    "start": "660420",
    "end": "667200"
  },
  {
    "text": "trust it don't check just trust me bro you know and that's it's gonna continue",
    "start": "667200",
    "end": "672839"
  },
  {
    "text": "then so that's certificate rejection check is also as a very challenging problem right a cloud fair is easier for",
    "start": "672839",
    "end": "680040"
  },
  {
    "text": "them because they they're doing it cloudflare they're doing it within their list for a specific customer so they're",
    "start": "680040",
    "end": "686519"
  },
  {
    "text": "less is smaller and I guess you're on top of Cloud fair so uh sure I suppose clawfred knows the",
    "start": "686519",
    "end": "695459"
  },
  {
    "text": "website you're visiting because you're technically connecting to car fly anyway so clafra knows everything and that's",
    "start": "695459",
    "end": "701220"
  },
  {
    "text": "another thing people don't realize that CDN sees everything by the way you're sending if you have a CDN on front of",
    "start": "701220",
    "end": "708360"
  },
  {
    "text": "your back end they need to decrypt they are a reverse a proxy they need to",
    "start": "708360",
    "end": "713579"
  },
  {
    "text": "terminate TLS they need to decrypt every single request you're sending so they're seeing everything you might be okay with",
    "start": "713579",
    "end": "720660"
  },
  {
    "text": "this and that's fine but just understand that they are doing all right I'm going another place let's go back here when",
    "start": "720660",
    "end": "726360"
  },
  {
    "text": "cloudflare receives traffic from an end user a service at the edge is responsible for terminating uh the",
    "start": "726360",
    "end": "733260"
  },
  {
    "text": "incoming TLS connection from there the service is a reverse proxy right talked",
    "start": "733260",
    "end": "738660"
  },
  {
    "text": "about that a beautiful simple reverse proxy and it's responsible for acting as a bridge between the user and the",
    "start": "738660",
    "end": "745200"
  },
  {
    "text": "various upstreams upstreams being the back ends here upstreams might include other services",
    "start": "745200",
    "end": "751920"
  },
  {
    "start": "750000",
    "end": "1020000"
  },
  {
    "text": "within cloudflare such as worker and caching ah so it's interesting so they are breaking their reverse proxy into",
    "start": "751920",
    "end": "757740"
  },
  {
    "text": "mini reverse proxies as well such that uh there are layers that are you know",
    "start": "757740",
    "end": "764519"
  },
  {
    "text": "controlled so this caching layer this is uh the whatever the workers layer right",
    "start": "764519",
    "end": "770639"
  },
  {
    "text": "the service workers or may travel through cloudflare to an",
    "start": "770639",
    "end": "775740"
  },
  {
    "text": "external server such as An Origin hosting a content sometimes you may want to restrict",
    "start": "775740",
    "end": "782040"
  },
  {
    "text": "access to an end point ensuring that only authorized actors can",
    "start": "782040",
    "end": "788579"
  },
  {
    "text": "access it endpoint here from what I understood is like an actual slash",
    "start": "788579",
    "end": "794339"
  },
  {
    "text": "post message then or post log right versus Slash read something right",
    "start": "794339",
    "end": "802160"
  },
  {
    "text": "gridlock is a bad idea because you don't want anyone to read logbook let's say viewing the main page of something",
    "start": "802160",
    "end": "808440"
  },
  {
    "text": "that's fine you don't need client certificates for that but it's the same domain so if you use pure Mutual TLS by",
    "start": "808440",
    "end": "816660"
  },
  {
    "text": "the miniature DLS rules that connection will fail if you're rejected no if if",
    "start": "816660",
    "end": "822240"
  },
  {
    "text": "you don't have a client certificate to begin with that will be rejected because you can't even connect to it but how do",
    "start": "822240",
    "end": "829200"
  },
  {
    "text": "you differentiate that visit to a home page should not require",
    "start": "829200",
    "end": "834420"
  },
  {
    "text": "uh client certificate but visit to this slash post",
    "start": "834420",
    "end": "840240"
  },
  {
    "text": "should require client certificate to authenticate it's like you're authenticating one site over the other",
    "start": "840240",
    "end": "846120"
  },
  {
    "text": "right one endpoint over the other so you can of course provide the cookies or sessions or things like that but with",
    "start": "846120",
    "end": "853320"
  },
  {
    "text": "current certificates it's all or nothing and that's what cloudflare did here they did it's a smart solution I would say",
    "start": "853320",
    "end": "861360"
  },
  {
    "text": "it's interesting I understand it I understand why they did it",
    "start": "861360",
    "end": "866459"
  },
  {
    "text": "it's just created this vulnerability as a result so let's continue using client certificate is a common way to",
    "start": "866459",
    "end": "872459"
  },
  {
    "text": "authenticate users this is referred to as Mutual TLS because both the server and client provide a certificate when",
    "start": "872459",
    "end": "877860"
  },
  {
    "text": "Mutual TS is enabled for a specific host name mind you this service at the edge",
    "start": "877860",
    "end": "883800"
  },
  {
    "text": "is responsible for passing the incoming client certificate and converting that",
    "start": "883800",
    "end": "889079"
  },
  {
    "text": "into metadata that is attached to http request that are forwarded to upstairs",
    "start": "889079",
    "end": "895019"
  },
  {
    "text": "do you see what what they did there so that the establ the establishment of the",
    "start": "895019",
    "end": "900360"
  },
  {
    "text": "TLs session is always succeeding to cloudflare Edge if you will",
    "start": "900360",
    "end": "907079"
  },
  {
    "text": "but then the authentication happens and then Upstream says hey I'm gonna attach",
    "start": "907079",
    "end": "912420"
  },
  {
    "text": "the same request that comes to me and now I'm going to attach it to probably the headers I think they're going to",
    "start": "912420",
    "end": "917820"
  },
  {
    "text": "create their own headers and they attach those headers I've had these headers with the revocation status We're Not",
    "start": "917820",
    "end": "924120"
  },
  {
    "text": "Gonna reject the connection we're gonna allow that rejected client to connect to",
    "start": "924120",
    "end": "930060"
  },
  {
    "text": "cloudflare that is the I suppose the track and what causes the",
    "start": "930060",
    "end": "937320"
  },
  {
    "text": "vulnerability because you allowed it so the RFC says don't allow it you can't connect if your certificate is rejected",
    "start": "937320",
    "end": "943920"
  },
  {
    "text": "but clarify relaxed that because they wanna reject the certificate ad at the granule",
    "start": "943920",
    "end": "953300"
  },
  {
    "text": "request level so they would attach the HTTP request to the uh to the",
    "start": "953300",
    "end": "959880"
  },
  {
    "text": "certificate to that each request right and it's up to Upstream level says oh you're going to slash post all right",
    "start": "959880",
    "end": "967079"
  },
  {
    "text": "reject you're going to slash home fine I don't really care it's just viewing the",
    "start": "967079",
    "end": "974100"
  },
  {
    "text": "home page okay it's a get request anyway right it's not like changing something on the server or anything",
    "start": "974100",
    "end": "980220"
  },
  {
    "text": "the apps you can process the metadata and make the decision whether the client is authorized or not right and that's",
    "start": "980220",
    "end": "985800"
  },
  {
    "text": "how they do it now customers can use cloudflare dashboard to revoke existing client",
    "start": "985800",
    "end": "991800"
  },
  {
    "text": "certificate instead of immediately a failing handshake involved revoke coins revocation is optionally enforced via",
    "start": "991800",
    "end": "1001160"
  },
  {
    "text": "Fire War rules here's where the bug is and we'll continue how which take effect at the",
    "start": "1001160",
    "end": "1008360"
  },
  {
    "text": "HTTP request level this leaves the decision to enforce revocation with the customer so it's up to you guys hey as a",
    "start": "1008360",
    "end": "1015019"
  },
  {
    "text": "customer of cloudflare this a request to slash post is is is is",
    "start": "1015019",
    "end": "1022240"
  },
  {
    "start": "1020000",
    "end": "1230000"
  },
  {
    "text": "enforcing client revocation certificates while",
    "start": "1022579",
    "end": "1029360"
  },
  {
    "text": "other requests are not it's a nice flexibility is a very nice things",
    "start": "1029360",
    "end": "1034459"
  },
  {
    "text": "right it's up to you right so of course you have to deal with really you have to",
    "start": "1034459",
    "end": "1039798"
  },
  {
    "text": "know what you're doing to enable this stuff right so how does the the service determine",
    "start": "1039799",
    "end": "1045079"
  },
  {
    "text": "whether a client certificate is revoked it's a good question right uh when we see a client certificate",
    "start": "1045079",
    "end": "1052160"
  },
  {
    "text": "pretended presented as a part of the TLs handshake we store the entire",
    "start": "1052160",
    "end": "1057559"
  },
  {
    "text": "certificate chain on the TLs connection so a certificate is always the certificate leave itself which is",
    "start": "1057559",
    "end": "1064220"
  },
  {
    "text": "technically a public key right and then that public key is signed with depends",
    "start": "1064220",
    "end": "1071660"
  },
  {
    "text": "on the format usually it's a x509 and then there's like a bunch of headers and the signatures to create that signature",
    "start": "1071660",
    "end": "1078860"
  },
  {
    "text": "you have to use the private the matching private key to create that right and the public key is used to validate that the",
    "start": "1078860",
    "end": "1085820"
  },
  {
    "text": "signature has created indeed with this private key that's you know that or whoever give me the certificate must own",
    "start": "1085820",
    "end": "1092720"
  },
  {
    "text": "the private key right and that's the goal of the public key but that's not enough because I can create a",
    "start": "1092720",
    "end": "1097760"
  },
  {
    "text": "self-assigned certificate and uh go always be authenticated right because",
    "start": "1097760",
    "end": "1103400"
  },
  {
    "text": "instead of some certificates are always valid right no that's why you must also have a",
    "start": "1103400",
    "end": "1110600"
  },
  {
    "text": "parent public key that uh use their private key to sign and",
    "start": "1110600",
    "end": "1117620"
  },
  {
    "text": "trust your leave certificate and that's called the certificate Authority and that certificate Authority even right",
    "start": "1117620",
    "end": "1124220"
  },
  {
    "text": "you could do that yourself right just self-sign it right so even that must be signed by someone upper than that could",
    "start": "1124220",
    "end": "1131419"
  },
  {
    "text": "be another certificate Authority or it could be something called the root certificate Authority that's root",
    "start": "1131419",
    "end": "1137120"
  },
  {
    "text": "certificate and that root certificate is self-signed because who God is going to assign certificates",
    "start": "1137120",
    "end": "1144679"
  },
  {
    "text": "now no like at the end of the day someone need to self-sign something right and so you might say herself so",
    "start": "1144679",
    "end": "1150980"
  },
  {
    "text": "how do I trust Roots well well uh your OS trust root certificate okay",
    "start": "1150980",
    "end": "1158660"
  },
  {
    "text": "it comes ship with your OS you're at the mercy of whoever installed those Road certificate you trust them you trust",
    "start": "1158660",
    "end": "1165140"
  },
  {
    "text": "them you don't trust them tough luck because that's what we have here A bunch of root certificate has",
    "start": "1165140",
    "end": "1170900"
  },
  {
    "text": "been trusted by someone right that's why beware of like",
    "start": "1170900",
    "end": "1176980"
  },
  {
    "text": "uh machines like Chromebooks or whatever shipped out of China or you know",
    "start": "1176980",
    "end": "1184360"
  },
  {
    "text": "Kazakhstan for example or they with a pre-installed operating system because they can install pretty much in the in",
    "start": "1184360",
    "end": "1191360"
  },
  {
    "text": "the store in the search store the certificate store any any root certificate they they deem valid right",
    "start": "1191360",
    "end": "1197299"
  },
  {
    "text": "so that's a that's something to understand but that's basically the certificate chain this chain is a",
    "start": "1197299",
    "end": "1203059"
  },
  {
    "text": "certificate the certificate authority to the root and that chain is included and stored in that the route sometimes is",
    "start": "1203059",
    "end": "1209660"
  },
  {
    "text": "optionally included because it's let's be honest some roots are just",
    "start": "1209660",
    "end": "1214760"
  },
  {
    "text": "trusted like the roots for I don't know trust chain whatever is called right and here they talk about what do they store",
    "start": "1214760",
    "end": "1221600"
  },
  {
    "text": "they store just the subject key identifier the serial number of the lease certificate the issuer certificate",
    "start": "1221600",
    "end": "1228500"
  },
  {
    "text": "like that's the certificate Authority I suppose and the Syrian number and this is like the basic primary key if you",
    "start": "1228500",
    "end": "1236240"
  },
  {
    "start": "1230000",
    "end": "1440000"
  },
  {
    "text": "will to identify them some of these value are used for Upstream processes but the assure is Ki and leave",
    "start": "1236240",
    "end": "1242960"
  },
  {
    "text": "certificate subject number serial number are used to query our internal data",
    "start": "1242960",
    "end": "1248179"
  },
  {
    "text": "store for a vacation style so they're acting like the ocsp server effectively right the online certificate status",
    "start": "1248179",
    "end": "1254840"
  },
  {
    "text": "protocol server and they basically they query the service okay is this revoked",
    "start": "1254840",
    "end": "1261200"
  },
  {
    "text": "or not and who checks this revoked status probably the customer will say",
    "start": "1261200",
    "end": "1266480"
  },
  {
    "text": "hey this customers that this is no this public key is revoked right that's interesting they know using the",
    "start": "1266480",
    "end": "1272900"
  },
  {
    "text": "public they're using the subject key identifier and the Syria number what's the difference between serial number and",
    "start": "1272900",
    "end": "1278000"
  },
  {
    "text": "the public key huh it's interesting let's ask our friend and and certificate what is the",
    "start": "1278000",
    "end": "1286820"
  },
  {
    "text": "difference between uh the serial number and the public key",
    "start": "1286820",
    "end": "1296679"
  },
  {
    "text": "the serial number and the public key serve different purposes have the same serial number the city is a unique",
    "start": "1298179",
    "end": "1304039"
  },
  {
    "text": "identifier assigned to each certificate by the certificate Authority that issues it ah so the certificate authority issue",
    "start": "1304039",
    "end": "1310340"
  },
  {
    "text": "said this number helps in managing and tracking certificates throughout their",
    "start": "1310340",
    "end": "1315559"
  },
  {
    "text": "life started serial numbers are usually represented as a string of characters so it's Gotta Be unique right thank you",
    "start": "1315559",
    "end": "1322520"
  },
  {
    "text": "chat GPT I'm gonna trust it for now so I suppose the serial number is issued by the certificate Authority in this case",
    "start": "1322520",
    "end": "1328340"
  },
  {
    "text": "right and that is unique the reason they use this probably because it's smaller",
    "start": "1328340",
    "end": "1334039"
  },
  {
    "text": "not not like the public key is a secret or anything like that right why do they use public key internet yeah I think",
    "start": "1334039",
    "end": "1340640"
  },
  {
    "text": "let's ask it uh how large uh what is the size of the of the serial number and the",
    "start": "1340640",
    "end": "1349580"
  },
  {
    "text": "certificate Authority",
    "start": "1349580",
    "end": "1356240"
  },
  {
    "text": "they follow according to the x509 certificate standard which is widely used the serial number should be",
    "start": "1356960",
    "end": "1363080"
  },
  {
    "text": "positive integer up to 20 octets bytes in size 20 bytes right many CS use",
    "start": "1363080",
    "end": "1370039"
  },
  {
    "text": "serial numbers that are smaller than the maximum size typically between 64 and",
    "start": "1370039",
    "end": "1375919"
  },
  {
    "text": "160 bit so 8 to 20 bytes that's a tiny thing right well the public key really",
    "start": "1375919",
    "end": "1381919"
  },
  {
    "text": "depends on the I suppose the the public key cryptography like with RSA or",
    "start": "1381919",
    "end": "1388419"
  },
  {
    "text": "elliptic curve a digital signature right so that's like 380",
    "start": "1388419",
    "end": "1394220"
  },
  {
    "text": "wide 384 I think that's the electrovers digital signature",
    "start": "1394220",
    "end": "1400700"
  },
  {
    "text": "while the uh while the RSA is like minimum you have to do 2048 which is massive right",
    "start": "1400700",
    "end": "1408860"
  },
  {
    "text": "so I understand why they use the serial number it's like a tiny one like 20 bytes like what to 20 bytes like 160 bit",
    "start": "1408860",
    "end": "1416059"
  },
  {
    "text": "still way smaller than the minimum requirement for the electric elliptic",
    "start": "1416059",
    "end": "1421460"
  },
  {
    "text": "curve digital signature public all right we're going all over the place but it's all related I think",
    "start": "1421460",
    "end": "1428179"
  },
  {
    "text": "so they're using this for performance reasons right we understand this stuff all right so they're sending it and and",
    "start": "1428179",
    "end": "1435200"
  },
  {
    "text": "the upstreams checks this serial number and that's 30 numbers are effectively uh",
    "start": "1435200",
    "end": "1440480"
  },
  {
    "start": "1440000",
    "end": "2100000"
  },
  {
    "text": "results in that right but what does this have to do with TLS session resumption so let's let's talk about sessional",
    "start": "1440480",
    "end": "1445580"
  },
  {
    "text": "resumption here I'm trying to summarize all that and then I'll add my own thoughts a little bit let's talk about session resumption",
    "start": "1445580",
    "end": "1451840"
  },
  {
    "text": "very quick session resumption how does it work so for TLS sessions what is what is the main",
    "start": "1451840",
    "end": "1459559"
  },
  {
    "text": "components in a TLS session there is first of all the key exchange so we're doing a key exchange to agree",
    "start": "1459559",
    "end": "1467000"
  },
  {
    "text": "on a secret a main secret and that secret is used to feed whatever",
    "start": "1467000",
    "end": "1472760"
  },
  {
    "text": "algorithm we picked symmetric key algorithm and that becomes our encryption key and both of us know this",
    "start": "1472760",
    "end": "1479360"
  },
  {
    "text": "encryption key without anyone in the middle beautiful design and during the TLs also we do",
    "start": "1479360",
    "end": "1484760"
  },
  {
    "text": "authentication which is the server sends a certificate optionally the client can send also a certificate which is called",
    "start": "1484760",
    "end": "1490640"
  },
  {
    "text": "mtls Mutual TLS but that's the costly Port there is so",
    "start": "1490640",
    "end": "1495740"
  },
  {
    "text": "much stuff we do here and and if you do it with every connection there is the cost of the cryptography",
    "start": "1495740",
    "end": "1504620"
  },
  {
    "text": "to do the key exchange at different element right and do the agree on the",
    "start": "1504620",
    "end": "1510320"
  },
  {
    "text": "algorithms and there's the more expensive part in my opinion which is the authentication",
    "start": "1510320",
    "end": "1515840"
  },
  {
    "text": "which is sending that certificate chain we talked about which is massive right can go up to 10 or 12 kilobytes right go",
    "start": "1515840",
    "end": "1524299"
  },
  {
    "text": "and and by the way that's not compressed there's an R of C just to compress that and it's not really I don't think it's",
    "start": "1524299",
    "end": "1530900"
  },
  {
    "text": "approved yet right so certificates are not compressed so they are massive so sending it across the",
    "start": "1530900",
    "end": "1536659"
  },
  {
    "text": "wire both ways can take a long time right and and it slows down the",
    "start": "1536659",
    "end": "1542900"
  },
  {
    "text": "handshake as a result so what people thought about it is okay since we",
    "start": "1542900",
    "end": "1547940"
  },
  {
    "text": "actually communicated how about we store the knowledge that we actually talked once and agree that in the next",
    "start": "1547940",
    "end": "1555320"
  },
  {
    "text": "connection if I establish if I establish a new connection somehow to the same domain to the same server",
    "start": "1555320",
    "end": "1561559"
  },
  {
    "text": "then I can provide you with a hint a ticket if you will that hey",
    "start": "1561559",
    "end": "1568159"
  },
  {
    "text": "I I've been here right and uh I'm good to go right I",
    "start": "1568159",
    "end": "1573679"
  },
  {
    "text": "don't like to give these examples but I'm going to give these examples for the sake of you know just illustration I'm",
    "start": "1573679",
    "end": "1579320"
  },
  {
    "text": "gonna go and do these guys later for my son's birthday we went to Legoland in San Diego",
    "start": "1579320",
    "end": "1585260"
  },
  {
    "text": "actually it's cars bad word sure well uh there's a big line to go through to",
    "start": "1585260",
    "end": "1593539"
  },
  {
    "text": "go through security and you know show them their tickets uh show them your ID",
    "start": "1593539",
    "end": "1598880"
  },
  {
    "text": "sometimes and then they will associate your tickets right and then we'll verify",
    "start": "1598880",
    "end": "1604400"
  },
  {
    "text": "that okay we're trusted but then they says okay if you want to exit and come back again they give you a stamp on your",
    "start": "1604400",
    "end": "1610400"
  },
  {
    "text": "head just like I don't know just this dumb stamp like they stamp your hand so then next time if you want to enter the",
    "start": "1610400",
    "end": "1616700"
  },
  {
    "text": "park you don't have to go through that line and security and just show your stuff you just show the stem and then",
    "start": "1616700",
    "end": "1622640"
  },
  {
    "text": "you're in right so you skipped so much cost to you and your family and just",
    "start": "1622640",
    "end": "1628039"
  },
  {
    "text": "enter that part I don't like to give this example because they they make things sound so simple to try or not",
    "start": "1628039",
    "end": "1634940"
  },
  {
    "text": "right but I'd like to get when I was there I was like the first thing I thought about like oh my God this is",
    "start": "1634940",
    "end": "1640940"
  },
  {
    "text": "such a resumption this is DLS session the resumption I just did TLS sessions resumption and Legoland so what",
    "start": "1640940",
    "end": "1648980"
  },
  {
    "text": "what but what really happens here let's now go to the technical details which we love and adore",
    "start": "1648980",
    "end": "1655400"
  },
  {
    "text": "so what really happens is actually when",
    "start": "1655400",
    "end": "1660440"
  },
  {
    "text": "when we want with the client and the server supports the session resumption the account will propose something in",
    "start": "1660440",
    "end": "1667820"
  },
  {
    "text": "their TLS extension in the client hello will say hey here is a pre-shared key",
    "start": "1667820",
    "end": "1673220"
  },
  {
    "text": "extension let's not only agree on a main secret to encrypt this session but also let's",
    "start": "1673220",
    "end": "1680000"
  },
  {
    "text": "agree on a resumption secret in the future so they agree on actually two secrets",
    "start": "1680000",
    "end": "1685940"
  },
  {
    "text": "there are different secrets so the main session resumption and the main secret",
    "start": "1685940",
    "end": "1691520"
  },
  {
    "text": "and then resumption Simian secret as it's called right so you would go if you",
    "start": "1691520",
    "end": "1697039"
  },
  {
    "text": "connect normally they would do the that value as Additionally the cost is we're going to also calculate this main secret",
    "start": "1697039",
    "end": "1703220"
  },
  {
    "text": "and the resumption main secret that is the main resumption music is not used at all right what happens",
    "start": "1703220",
    "end": "1710779"
  },
  {
    "text": "the client now knows the Canon secret and they can use it to encrypt the Canon current communication",
    "start": "1710779",
    "end": "1718179"
  },
  {
    "text": "but the server also knows it right and the server and the client also knows",
    "start": "1718179",
    "end": "1724340"
  },
  {
    "text": "this new resumption future secret right what the server does and there are many",
    "start": "1724340",
    "end": "1730580"
  },
  {
    "text": "ways to do this one way is they store and I'm gonna I'm",
    "start": "1730580",
    "end": "1737659"
  },
  {
    "text": "gonna use the the better the stateless way I'm gonna talk about the stateless way here right",
    "start": "1737659",
    "end": "1744919"
  },
  {
    "text": "the the club the server would use that mean the the resumption key put it in",
    "start": "1744919",
    "end": "1750799"
  },
  {
    "text": "something called a ticket and it's literally just a data structure and then encrypt that data structure with another",
    "start": "1750799",
    "end": "1758480"
  },
  {
    "text": "key and that key must be known to the server and rotate it so that key is stored",
    "start": "1758480",
    "end": "1766039"
  },
  {
    "text": "somewhere securely on the server and then you encrypt that right you equip that ticket and then you",
    "start": "1766039",
    "end": "1772399"
  },
  {
    "text": "return this encrypted ticket which the client cannot really declare because they don't have that key",
    "start": "1772399",
    "end": "1778880"
  },
  {
    "text": "that special key that we talked about then they send it so there is a key and it's all inside encrypted by another key",
    "start": "1778880",
    "end": "1784700"
  },
  {
    "text": "that the client doesn't know so now the client gets this ticket the new session ticket is called and the client will",
    "start": "1784700",
    "end": "1791360"
  },
  {
    "text": "have the technically the main resumption the the main resumption secret so they",
    "start": "1791360",
    "end": "1797659"
  },
  {
    "text": "would associate that with this ticket and store it together they store it somewhere so only the",
    "start": "1797659",
    "end": "1804140"
  },
  {
    "text": "client actually stores the knowledge of this thing the the server can technically discard the knowledge of",
    "start": "1804140",
    "end": "1810919"
  },
  {
    "text": "this ticket at all right you can you can you can also technically connect to another server and I'll be",
    "start": "1810919",
    "end": "1818480"
  },
  {
    "text": "fine how let's do this now a new session is established I want to resume a session",
    "start": "1818480",
    "end": "1825440"
  },
  {
    "text": "what do we do what do we do is we don't provide client certificate we",
    "start": "1825440",
    "end": "1831500"
  },
  {
    "text": "don't do any certificate with anything all what the client does is",
    "start": "1831500",
    "end": "1836960"
  },
  {
    "text": "they do a client hello and they send everything in the clientele I take it",
    "start": "1836960",
    "end": "1842120"
  },
  {
    "text": "back because you you have to assume that the server might not accept your pre-shared resumption right but they",
    "start": "1842120",
    "end": "1849679"
  },
  {
    "text": "send the new ticket session the second recession ticket inside the client title says hey hey server last time you",
    "start": "1849679",
    "end": "1855620"
  },
  {
    "text": "remember you should give me that I want to resume a session and now you might say like there is a main secret",
    "start": "1855620",
    "end": "1860960"
  },
  {
    "text": "associated with that the client knows but the client never sends that secret on Plain text that's a bad idea right",
    "start": "1860960",
    "end": "1866960"
  },
  {
    "text": "but since this encrypted session ticket which is also pointless even the client cannot declare that but the server cap",
    "start": "1866960",
    "end": "1873860"
  },
  {
    "text": "so the client the server gets that session ticket decrypts it right with",
    "start": "1873860",
    "end": "1880039"
  },
  {
    "text": "the key the key must exist in the server so if you if you manage to rotate it and you use",
    "start": "1880039",
    "end": "1888140"
  },
  {
    "text": "the new key that is not lined up with this you're going to get an error and the full handshake will be done instead",
    "start": "1888140",
    "end": "1894080"
  },
  {
    "text": "of a resumption but that's fine let's assume the server actually has that key right and it's rotated in like an hourly",
    "start": "1894080",
    "end": "1900919"
  },
  {
    "text": "basis I think that's what cloudflare does every hour they rotate this key so the server will decrypt the session",
    "start": "1900919",
    "end": "1906080"
  },
  {
    "text": "tickets ah look at that there's all this information I know this guy",
    "start": "1906080",
    "end": "1911840"
  },
  {
    "text": "the fact that I use this key and I decrypted it and I see the information",
    "start": "1911840",
    "end": "1917299"
  },
  {
    "text": "belonging to the same client technically or other clients as well because I don't",
    "start": "1917299",
    "end": "1922940"
  },
  {
    "text": "think a certificate is attached to this decision ticket is attached to a client per se so what happens is this the",
    "start": "1922940",
    "end": "1929899"
  },
  {
    "text": "client the the server will look at this session they can say okay I see this I trust you all is good let's",
    "start": "1929899",
    "end": "1937700"
  },
  {
    "text": "skip the whole thing and now skipping the whole thing really depends on the implementation what does",
    "start": "1937700",
    "end": "1943399"
  },
  {
    "text": "it mean to skip the whole thing you can technically skip the",
    "start": "1943399",
    "end": "1949159"
  },
  {
    "text": "the authentication part without any problem you're safe you can skip that if you",
    "start": "1949159",
    "end": "1954440"
  },
  {
    "text": "want because I know this guy I don't need to send these certificates all over again",
    "start": "1954440",
    "end": "1960080"
  },
  {
    "text": "fortunately we took the head to the client sent its certificate which is something you have to do I suppose right",
    "start": "1960080",
    "end": "1967220"
  },
  {
    "text": "but the server doesn't have to right the server technically can just resume the session yeah",
    "start": "1967220",
    "end": "1974960"
  },
  {
    "text": "and the server can also make another decision to also avoid the key exchange",
    "start": "1974960",
    "end": "1980179"
  },
  {
    "text": "altogether why the server can just use the main secret that is stored in that ticket right and he said okay let's",
    "start": "1980179",
    "end": "1986960"
  },
  {
    "text": "let's just use this and let's start encrypting with this future main secret and the client will just use uh that to",
    "start": "1986960",
    "end": "1993440"
  },
  {
    "text": "encrypt with them future main Secret and then they continue encrypting",
    "start": "1993440",
    "end": "1999200"
  },
  {
    "text": "immediately with that key which the client has must",
    "start": "1999200",
    "end": "2004840"
  },
  {
    "text": "have because they actually established it in previously and they stored it if the client didn't doesn't have it it's",
    "start": "2004840",
    "end": "2010539"
  },
  {
    "text": "all done right and then you can resume the session that's skipping that that part the key",
    "start": "2010539",
    "end": "2017919"
  },
  {
    "text": "part sometimes the servers don't do that they just say you know what uh I know but I don't trust you client",
    "start": "2017919",
    "end": "2025059"
  },
  {
    "text": "maybe you share this key somewhere or you maybe you have been leaked maybe someone broke into your stuff and",
    "start": "2025059",
    "end": "2032559"
  },
  {
    "text": "decrypt that but yeah so so you can play with that session resumption so and so",
    "start": "2032559",
    "end": "2037899"
  },
  {
    "text": "this this is a scalable way such that the server doesn't have to remember every single",
    "start": "2037899",
    "end": "2044860"
  },
  {
    "text": "client and ever resumed connection with right because otherwise if you do it",
    "start": "2044860",
    "end": "2051220"
  },
  {
    "text": "statefully the server must store this session ticket somewhere that's the called the session IDs right the idea of",
    "start": "2051220",
    "end": "2057339"
  },
  {
    "text": "the session ID so this sorta session ID instead and then query some sort of a database to check that this session",
    "start": "2057339",
    "end": "2063520"
  },
  {
    "text": "exists or not right that's another way to do it so this way is actually stateless where where technically",
    "start": "2063520",
    "end": "2071200"
  },
  {
    "text": "everything is in this new ticket you might you might argue that oh the key is there technically is not really fully",
    "start": "2071200",
    "end": "2077679"
  },
  {
    "text": "stateless because there is a key stored somewhere that without it you're you it's not it's not enough right but",
    "start": "2077679",
    "end": "2085118"
  },
  {
    "text": "recall that when a client presents a certificate we store the certificate chain on the TLs connection remember",
    "start": "2085119",
    "end": "2091618"
  },
  {
    "text": "well that's what they did when you connect to cloudflare with a client",
    "start": "2091619",
    "end": "2097599"
  },
  {
    "text": "certificate the chain of the client certificate is stored in the TLs connection rejected or not",
    "start": "2097599",
    "end": "2104920"
  },
  {
    "start": "2100000",
    "end": "2220000"
  },
  {
    "text": "it doesn't matter they accept all client certificate whether it's rejected or not",
    "start": "2104920",
    "end": "2110140"
  },
  {
    "text": "right that's that's what they that's the change they made right",
    "start": "2110140",
    "end": "2116500"
  },
  {
    "text": "it was discovered that when sessions were resumed if you actually resume a",
    "start": "2116500",
    "end": "2123160"
  },
  {
    "text": "session which is the clients still provide their client certificates have",
    "start": "2123160",
    "end": "2128380"
  },
  {
    "text": "to right and that certificate is ejected another code path is getting executed",
    "start": "2128380",
    "end": "2134380"
  },
  {
    "text": "and I and I totally get it I totally see it as code you would definitely have two",
    "start": "2134380",
    "end": "2140380"
  },
  {
    "text": "code path for this like oh if I am a new connection do this and start take the",
    "start": "2140380",
    "end": "2146200"
  },
  {
    "text": "certificate and do this if you are resuming a a session then there will be",
    "start": "2146200",
    "end": "2151300"
  },
  {
    "text": "another code path where you you have the and that corepat they missed to store",
    "start": "2151300",
    "end": "2156460"
  },
  {
    "text": "the certificate chain in the TLs connection so if you run into that code path where it",
    "start": "2156460",
    "end": "2163119"
  },
  {
    "text": "says Okay resuming a session and this the new session ticket is is good then go through this code path and",
    "start": "2163119",
    "end": "2169660"
  },
  {
    "text": "do something else right almost the same thing but is it we're skipping a bunch of code but that code path they did not add this",
    "start": "2169660",
    "end": "2179500"
  },
  {
    "text": "code to actually store the client certificate in the TLs connection",
    "start": "2179500",
    "end": "2184599"
  },
  {
    "text": "what does that mean now we have a TLS connection with an Mt client certificate",
    "start": "2184599",
    "end": "2190480"
  },
  {
    "text": "and if you have an empty client certificate nothing is getting sent to the server to the back in Upstream",
    "start": "2190480",
    "end": "2196599"
  },
  {
    "text": "server right the request will only have empty",
    "start": "2196599",
    "end": "2202119"
  },
  {
    "text": "client sort of is there actually this guy never actually sent us any client certificate right so we're good so what",
    "start": "2202119",
    "end": "2209200"
  },
  {
    "text": "does the client do the client uh this app stream server will check so oh I guess this is allowed",
    "start": "2209200",
    "end": "2215980"
  },
  {
    "text": "good stuff and that's the problem right we meaning we were unable to check",
    "start": "2215980",
    "end": "2221260"
  },
  {
    "start": "2220000",
    "end": "2545000"
  },
  {
    "text": "their vocation status and pass this information to Final War rules for further processing",
    "start": "2221260",
    "end": "2226420"
  },
  {
    "text": "and they they're going through the actual details here they're showing you examples and stuff like that how did we",
    "start": "2226420",
    "end": "2232000"
  },
  {
    "text": "address the problem upon realizing that session resumption led to the inability to properly check",
    "start": "2232000",
    "end": "2238180"
  },
  {
    "text": "revocation status our first reaction was to disable session resumption for all",
    "start": "2238180",
    "end": "2244359"
  },
  {
    "text": "Mutual TLS connection this blocked the vulnerability immediately that's a good choice who cares about the resumptions",
    "start": "2244359",
    "end": "2252040"
  },
  {
    "text": "right it's like yeah take a hit would you take an extra milliseconds",
    "start": "2252040",
    "end": "2257500"
  },
  {
    "text": "of performance penalty on your resume sessions",
    "start": "2257500",
    "end": "2263820"
  },
  {
    "text": "or or would you rather have a vulnerability of course I'll take that extra milliseconds right so that's a",
    "start": "2263820",
    "end": "2271660"
  },
  {
    "text": "smart choice The Next Step was to figure out how to safely re-enable resumption for mtls to",
    "start": "2271660",
    "end": "2279160"
  },
  {
    "text": "do so we need to remove the requirement of depending on data stored within the TLs connection state right so they",
    "start": "2279160",
    "end": "2286000"
  },
  {
    "text": "removed that how do they remove it and instead we can use an API call that will grant us access to the leave certificate",
    "start": "2286000",
    "end": "2293520"
  },
  {
    "text": "in both session resumption and non-session resumption cases ah how I",
    "start": "2293520",
    "end": "2300040"
  },
  {
    "text": "see what they did there so instead of rolling on their own",
    "start": "2300040",
    "end": "2305320"
  },
  {
    "text": "data structure to store the certificate themselves and rely on manually updating",
    "start": "2305320",
    "end": "2311200"
  },
  {
    "text": "that they're just relying on the underlining",
    "start": "2311200",
    "end": "2318180"
  },
  {
    "text": "x509 certificate to always get us this if you're asking the API for the",
    "start": "2318180",
    "end": "2323980"
  },
  {
    "text": "certificate API we're always gonna get it right you're not really populating a data structure and manually",
    "start": "2323980",
    "end": "2332020"
  },
  {
    "text": "querying that data structure to get the certificate no they're just like hey I",
    "start": "2332020",
    "end": "2337720"
  },
  {
    "text": "know the session will always have a certificate of a certificate the TLs session let's call in into an",
    "start": "2337720",
    "end": "2344320"
  },
  {
    "text": "underlining uh apis to get that that's what I understood at least okay that's",
    "start": "2344320",
    "end": "2350260"
  },
  {
    "text": "interesting so let's remove any additional code that we have to do manually and let's just actually rely on",
    "start": "2350260",
    "end": "2356500"
  },
  {
    "text": "on the built-in apis so this is the detailed timelines in March 2021 we",
    "start": "2356500",
    "end": "2362320"
  },
  {
    "text": "introduced the new feature right uh ability to revoke mtls certificate in",
    "start": "2362320",
    "end": "2369000"
  },
  {
    "text": "December 16. right and they tell you the exactly the terms at 2153 at nine",
    "start": "2369000",
    "end": "2375400"
  },
  {
    "text": "o'clock 53 Clover discovers that the vulnerability resulted from a bug whereby certificate verifications that",
    "start": "2375400",
    "end": "2381880"
  },
  {
    "text": "were is not checked for example for session resumption cloudflip begins working on a fix to disable resumption",
    "start": "2381880",
    "end": "2388900"
  },
  {
    "text": "for all mtls connections to the edge to the edge right only to the Earth and",
    "start": "2388900",
    "end": "2395020"
  },
  {
    "text": "then a day later chlorophyll revalidates the fix and starts to roll out the fix globally that",
    "start": "2395020",
    "end": "2401320"
  },
  {
    "text": "fix to disable mtls altogether I mean session resumptions for mtls right just",
    "start": "2401320",
    "end": "2407619"
  },
  {
    "text": "the ability to send this new session tickets basically any anything you if you send a new session ticket we're just",
    "start": "2407619",
    "end": "2413560"
  },
  {
    "text": "gonna ignore it and do a full handshake all the time that's what they did right rollouts is complete migrate mitigating",
    "start": "2413560",
    "end": "2419920"
  },
  {
    "text": "the payments no no more vulnerabilities right the entire Globe cloudfest starts to roll out the fix in",
    "start": "2419920",
    "end": "2427240"
  },
  {
    "text": "a month later almost January 12.",
    "start": "2427240",
    "end": "2433839"
  },
  {
    "text": "cloudflare starts to roll out the fix that supports both session resumption and revocation",
    "start": "2433839",
    "end": "2439839"
  },
  {
    "text": "roles is complete and January 18 of this year 2023. in conclusion once Cloud fair",
    "start": "2439839",
    "end": "2447579"
  },
  {
    "text": "oh my God I just realized that I'm not I'm not sharing my screen I'm sorry you didn't",
    "start": "2447579",
    "end": "2454119"
  },
  {
    "text": "really miss much guys in conclusion once cloudflare identified the vulnerability a remediation was put",
    "start": "2454119",
    "end": "2461079"
  },
  {
    "text": "into a place quickly a fixed that correctly supports session resumption",
    "start": "2461079",
    "end": "2466300"
  },
  {
    "text": "and revocation has been fully rolled out after reviewing the logs Clothier has",
    "start": "2466300",
    "end": "2472000"
  },
  {
    "text": "not seen any evidence that this vulnerability has been exploited in the",
    "start": "2472000",
    "end": "2478900"
  },
  {
    "text": "wild alright guys uh that is for me I know a little long video but I like to kind of unpack these layers just for me",
    "start": "2478900",
    "end": "2486640"
  },
  {
    "text": "to have a better understanding of everything that I said yet and I think I have maybe a 95 percent understanding of",
    "start": "2486640",
    "end": "2494920"
  },
  {
    "text": "what's going on here there are parts that I'm not comfortable with I'm not really well versed especially these",
    "start": "2494920",
    "end": "2500740"
  },
  {
    "text": "function calls the good Authority Key ID and get subject key ID I think these are",
    "start": "2500740",
    "end": "2506079"
  },
  {
    "text": "like internal things related to specifically to x509 and you can call these functions to",
    "start": "2506079",
    "end": "2512560"
  },
  {
    "text": "always get access to the certificate so that's better than actually rolling oh",
    "start": "2512560",
    "end": "2519760"
  },
  {
    "text": "your own apis your own data structure and store them every time you store",
    "start": "2519760",
    "end": "2525160"
  },
  {
    "text": "something and making sure it's there it's it's always gonna bite you eventually all right guys that's it for",
    "start": "2525160",
    "end": "2531339"
  },
  {
    "text": "me today I'll see you in the next one good stuff uh thanks for clavia for sharing the details on this thanks uh",
    "start": "2531339",
    "end": "2537220"
  },
  {
    "text": "let's shout out the author of this Rochelle Mera good job guys thank you so much goodbye",
    "start": "2537220",
    "end": "2546599"
  }
]