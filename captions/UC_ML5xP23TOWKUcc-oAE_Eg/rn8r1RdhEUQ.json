[
  {
    "start": "0",
    "end": "98000"
  },
  {
    "text": "what's going on guys my name is Hussein",
    "start": "160",
    "end": "2159"
  },
  {
    "text": "and this is an overview of how the",
    "start": "2159",
    "end": "5279"
  },
  {
    "text": "operating system kernel does socket",
    "start": "5279",
    "end": "8160"
  },
  {
    "text": "management using the different data",
    "start": "8160",
    "end": "11040"
  },
  {
    "text": "structure the socket management data",
    "start": "11040",
    "end": "13120"
  },
  {
    "text": "structures that is built in at that",
    "start": "13120",
    "end": "16160"
  },
  {
    "text": "layer 4 or the network layer essentially",
    "start": "16160",
    "end": "18960"
  },
  {
    "text": "so I'll talk about what a socket is what",
    "start": "18960",
    "end": "21039"
  },
  {
    "text": "a connection is and the different kind",
    "start": "21039",
    "end": "23320"
  },
  {
    "text": "of cues that are used in order to manage",
    "start": "23320",
    "end": "28640"
  },
  {
    "text": "connections and listeners and uh data",
    "start": "28640",
    "end": "32880"
  },
  {
    "text": "that are received for each of these",
    "start": "32880",
    "end": "35440"
  },
  {
    "text": "connections this is a snippet of my",
    "start": "35440",
    "end": "37120"
  },
  {
    "text": "fundamentals of operating systems course",
    "start": "37120",
    "end": "39920"
  },
  {
    "text": "if you're interested check out the",
    "start": "39920",
    "end": "41520"
  },
  {
    "text": "pinned comment below and now let's go to",
    "start": "41520",
    "end": "45120"
  },
  {
    "text": "the video all right welcome to the",
    "start": "45120",
    "end": "48200"
  },
  {
    "text": "nitty-gritty we'll talk about",
    "start": "48200",
    "end": "50280"
  },
  {
    "text": "connections sockets and cues i'll split",
    "start": "50280",
    "end": "54079"
  },
  {
    "text": "this into two lectures the first part",
    "start": "54079",
    "end": "58079"
  },
  {
    "text": "we'll talk about the in both cases we'll",
    "start": "58079",
    "end": "60160"
  },
  {
    "text": "talk about the core kernel network data",
    "start": "60160",
    "end": "62719"
  },
  {
    "text": "structures but in this particular thing",
    "start": "62719",
    "end": "65119"
  },
  {
    "text": "I'm going to talk about the sockets and",
    "start": "65119",
    "end": "67280"
  },
  {
    "text": "connections and then in the next one",
    "start": "67280",
    "end": "69439"
  },
  {
    "text": "we'll talk about specifically how to",
    "start": "69439",
    "end": "72400"
  },
  {
    "text": "read from connections and what kernel",
    "start": "72400",
    "end": "75200"
  },
  {
    "text": "data structures does the kernel use to",
    "start": "75200",
    "end": "78320"
  },
  {
    "text": "actually implement that let's jump into",
    "start": "78320",
    "end": "80240"
  },
  {
    "text": "it this is going to be a beautiful let's",
    "start": "80240",
    "end": "82720"
  },
  {
    "text": "just uh swim you guys here let's swim",
    "start": "82720",
    "end": "85439"
  },
  {
    "text": "don't memorize anything let's just swim",
    "start": "85439",
    "end": "87920"
  },
  {
    "text": "first concept the concept of a socket",
    "start": "87920",
    "end": "90159"
  },
  {
    "text": "and a socket really when it comes to",
    "start": "90159",
    "end": "93200"
  },
  {
    "text": "actual data structure is nothing but a",
    "start": "93200",
    "end": "96000"
  },
  {
    "text": "structure a strct really in C it's also",
    "start": "96000",
    "end": "100000"
  },
  {
    "start": "98000",
    "end": "470000"
  },
  {
    "text": "a file descriptor at least in Linux in",
    "start": "100000",
    "end": "102400"
  },
  {
    "text": "Windows becomes an object because in in",
    "start": "102400",
    "end": "104400"
  },
  {
    "text": "in Linux everything is a is a file when",
    "start": "104400",
    "end": "107880"
  },
  {
    "text": "I listen and we talked about what is the",
    "start": "107880",
    "end": "110720"
  },
  {
    "text": "concept of listening right and the",
    "start": "110720",
    "end": "112399"
  },
  {
    "text": "fundamentals so like hey I want to",
    "start": "112399",
    "end": "115759"
  },
  {
    "text": "accept",
    "start": "115759",
    "end": "117159"
  },
  {
    "text": "connections on a specific IP IP address",
    "start": "117159",
    "end": "120960"
  },
  {
    "text": "and a specific port who's saying you use",
    "start": "120960",
    "end": "123600"
  },
  {
    "text": "the word specific can I have more than",
    "start": "123600",
    "end": "125840"
  },
  {
    "text": "IP address in one machine of",
    "start": "125840",
    "end": "128360"
  },
  {
    "text": "course in every computer you have",
    "start": "128360",
    "end": "132000"
  },
  {
    "text": "multiple necks or network interface",
    "start": "132000",
    "end": "136280"
  },
  {
    "text": "cards and not only that you can",
    "start": "136280",
    "end": "139440"
  },
  {
    "text": "technically create unlimited virtual",
    "start": "139440",
    "end": "141920"
  },
  {
    "text": "network interface card each with its own",
    "start": "141920",
    "end": "145120"
  },
  {
    "text": "IP address ideally you have a physical",
    "start": "145120",
    "end": "148319"
  },
  {
    "text": "network and you have a mapped mount",
    "start": "148319",
    "end": "151599"
  },
  {
    "text": "which have essentially that network uh",
    "start": "151599",
    "end": "155440"
  },
  {
    "text": "virtual IP not virtual IP sorry uh it",
    "start": "155440",
    "end": "159040"
  },
  {
    "text": "will have a neck exposed to you that you",
    "start": "159040",
    "end": "161519"
  },
  {
    "text": "say hey this is my IP address this is my",
    "start": "161519",
    "end": "163680"
  },
  {
    "text": "subnet mask this is my uh default",
    "start": "163680",
    "end": "167640"
  },
  {
    "text": "gateway this is my DNS resolver IP",
    "start": "167640",
    "end": "172239"
  },
  {
    "text": "address all of that is my proxy stuff",
    "start": "172239",
    "end": "174959"
  },
  {
    "text": "like",
    "start": "174959",
    "end": "175720"
  },
  {
    "text": "that so you can listen on an IP and a",
    "start": "175720",
    "end": "181440"
  },
  {
    "text": "port it has to be those two",
    "start": "181440",
    "end": "184280"
  },
  {
    "text": "things so that means I have four network",
    "start": "184280",
    "end": "188080"
  },
  {
    "text": "cards i'm listening on the IP address of",
    "start": "188080",
    "end": "190400"
  },
  {
    "text": "this network card you have to specify it",
    "start": "190400",
    "end": "193200"
  },
  {
    "text": "no and then you specify the port and if",
    "start": "193200",
    "end": "197200"
  },
  {
    "text": "you if you've ever built a backend",
    "start": "197200",
    "end": "199200"
  },
  {
    "text": "you'll always see that the default is I",
    "start": "199200",
    "end": "202159"
  },
  {
    "text": "don't know 8888 or 8080 the port and the",
    "start": "202159",
    "end": "205840"
  },
  {
    "text": "and the IP is the loop back default neck",
    "start": "205840",
    "end": "210720"
  },
  {
    "text": "which points to myself for development",
    "start": "210720",
    "end": "214040"
  },
  {
    "text": "purposes so that's the TCP IP",
    "start": "214040",
    "end": "219519"
  },
  {
    "text": "127.0.0.1 that's the IP version 4 for",
    "start": "219640",
    "end": "223400"
  },
  {
    "text": "IPv6 loop back",
    "start": "223400",
    "end": "226120"
  },
  {
    "text": "it's bracket colon col one that's the",
    "start": "226120",
    "end": "230080"
  },
  {
    "text": "loop back for IPv6 but that's basically",
    "start": "230080",
    "end": "233280"
  },
  {
    "text": "the games we're playing here you might",
    "start": "233280",
    "end": "235040"
  },
  {
    "text": "say I say I don't do anything when I",
    "start": "235040",
    "end": "236720"
  },
  {
    "text": "listen I just call in NodeJS I could",
    "start": "236720",
    "end": "238879"
  },
  {
    "text": "call listen and then I close the bracket",
    "start": "238879",
    "end": "240720"
  },
  {
    "text": "I don't do any of this stuff well this",
    "start": "240720",
    "end": "243760"
  },
  {
    "text": "is where we need to talk you guys when",
    "start": "243760",
    "end": "246239"
  },
  {
    "text": "you",
    "start": "246239",
    "end": "247159"
  },
  {
    "text": "listen you can give the option to listen",
    "start": "247159",
    "end": "249760"
  },
  {
    "text": "on on owner interfaces which is",
    "start": "249760",
    "end": "251920"
  },
  {
    "text": "absolutely Horrible",
    "start": "251920",
    "end": "254280"
  },
  {
    "text": "idea horrible and I'm really mad that",
    "start": "254280",
    "end": "258239"
  },
  {
    "text": "this is a",
    "start": "258239",
    "end": "259239"
  },
  {
    "text": "default apparently we have to make it a",
    "start": "259239",
    "end": "262320"
  },
  {
    "text": "default because it's too much to look up",
    "start": "262320",
    "end": "265759"
  },
  {
    "text": "an IP and IP can change this and and and",
    "start": "265759",
    "end": "268639"
  },
  {
    "text": "to make it easy let's listen on all",
    "start": "268639",
    "end": "270680"
  },
  {
    "text": "interfaces and you do that by doing",
    "start": "270680",
    "end": "273040"
  },
  {
    "text": "0.0.0.04",
    "start": "273040",
    "end": "275440"
  },
  {
    "text": "04 zeros or I think in",
    "start": "275440",
    "end": "279479"
  },
  {
    "text": "IPv6 bracket colon colon bracket that",
    "start": "279479",
    "end": "283919"
  },
  {
    "text": "listens on I all IPv6 versus all IPv4s",
    "start": "283919",
    "end": "287919"
  },
  {
    "text": "interfaces because you can have both",
    "start": "287919",
    "end": "289600"
  },
  {
    "text": "right watch out for this",
    "start": "289600",
    "end": "291240"
  },
  {
    "text": "because you're building a small app that",
    "start": "291240",
    "end": "294160"
  },
  {
    "text": "does I don't know opens a port and you",
    "start": "294160",
    "end": "297600"
  },
  {
    "text": "accidentally deployed it in production",
    "start": "297600",
    "end": "299440"
  },
  {
    "text": "and you wanted like literally to run it",
    "start": "299440",
    "end": "301360"
  },
  {
    "text": "locally you just and all of a sudden you",
    "start": "301360",
    "end": "304000"
  },
  {
    "text": "you run it and was listen on all",
    "start": "304000",
    "end": "307240"
  },
  {
    "text": "production nets which happens to one of",
    "start": "307240",
    "end": "310240"
  },
  {
    "text": "them happens to be a public IP address",
    "start": "310240",
    "end": "312720"
  },
  {
    "text": "or a public or an IP address that is",
    "start": "312720",
    "end": "315600"
  },
  {
    "text": "essentially mapped to some load balancer",
    "start": "315600",
    "end": "319199"
  },
  {
    "text": "it's public eventually right so now you",
    "start": "319199",
    "end": "321919"
  },
  {
    "text": "exposed your app to the public that's",
    "start": "321919",
    "end": "325039"
  },
  {
    "text": "how every single MongoDB instance and",
    "start": "325039",
    "end": "329199"
  },
  {
    "text": "elastic search data got breached because",
    "start": "329199",
    "end": "332720"
  },
  {
    "text": "people just listen to all interfaces and",
    "start": "332720",
    "end": "335120"
  },
  {
    "text": "deploy it on the",
    "start": "335120",
    "end": "337080"
  },
  {
    "text": "cloud and and literally attackers will",
    "start": "337080",
    "end": "340960"
  },
  {
    "text": "scan the whole web scan all the IPv4 uh",
    "start": "340960",
    "end": "344800"
  },
  {
    "text": "you know ranges looking for the elastic",
    "start": "344800",
    "end": "347600"
  },
  {
    "text": "search DB ports and then connect",
    "start": "347600",
    "end": "351280"
  },
  {
    "text": "and then brute force their way so that's",
    "start": "351280",
    "end": "354400"
  },
  {
    "text": "really dangerous you really want to",
    "start": "354400",
    "end": "356800"
  },
  {
    "text": "listen on a specific port that you",
    "start": "356800",
    "end": "359360"
  },
  {
    "text": "actually know right it's hard it's",
    "start": "359360",
    "end": "363240"
  },
  {
    "text": "difficult it it's clum uh not clum it's",
    "start": "363240",
    "end": "366400"
  },
  {
    "text": "it's a it",
    "start": "366400",
    "end": "369560"
  },
  {
    "text": "it's requires some more work but it's",
    "start": "369560",
    "end": "372479"
  },
  {
    "text": "secure now then we have listened on a",
    "start": "372479",
    "end": "375360"
  },
  {
    "text": "port and IP Hussein when you do that you",
    "start": "375360",
    "end": "379919"
  },
  {
    "text": "call a system called code called listen",
    "start": "379919",
    "end": "383120"
  },
  {
    "text": "and you get back a beautiful file",
    "start": "383120",
    "end": "385680"
  },
  {
    "text": "descriptor called socket and this is I'm",
    "start": "385680",
    "end": "388800"
  },
  {
    "text": "going to coin a name for it call it",
    "start": "388800",
    "end": "391120"
  },
  {
    "text": "listening",
    "start": "391120",
    "end": "392680"
  },
  {
    "text": "socket file",
    "start": "392680",
    "end": "394440"
  },
  {
    "text": "descriptor because a connection is also",
    "start": "394440",
    "end": "396800"
  },
  {
    "text": "a socket but that's kind of a different",
    "start": "396800",
    "end": "399120"
  },
  {
    "text": "kind of a socket it's the same data",
    "start": "399120",
    "end": "401479"
  },
  {
    "text": "structure right and the kernel kind of",
    "start": "401479",
    "end": "404319"
  },
  {
    "text": "stores them in the same file the same",
    "start": "404319",
    "end": "406680"
  },
  {
    "text": "table data structure but you can see",
    "start": "406680",
    "end": "409919"
  },
  {
    "text": "that the socket has only listening",
    "start": "409919",
    "end": "413280"
  },
  {
    "text": "socket it doesn't have like a source IP",
    "start": "413280",
    "end": "415759"
  },
  {
    "text": "or destination IP it doesn't have any of",
    "start": "415759",
    "end": "417440"
  },
  {
    "text": "that but a connection actually is is a",
    "start": "417440",
    "end": "421759"
  },
  {
    "text": "is an is an entity that has two sides it",
    "start": "421759",
    "end": "425599"
  },
  {
    "text": "has source a client and a server so a",
    "start": "425599",
    "end": "429919"
  },
  {
    "text": "connection is different than a socket",
    "start": "429919",
    "end": "431919"
  },
  {
    "text": "but I'm going to call it a connection",
    "start": "431919",
    "end": "433280"
  },
  {
    "text": "socket for now we have a socket",
    "start": "433280",
    "end": "434880"
  },
  {
    "text": "beautiful what do we get we get a file",
    "start": "434880",
    "end": "436880"
  },
  {
    "text": "descriptor where does it live it lives",
    "start": "436880",
    "end": "438560"
  },
  {
    "text": "in the process ID where PCB we know all",
    "start": "438560",
    "end": "441919"
  },
  {
    "text": "these terms now guys we can talk safely",
    "start": "441919",
    "end": "444240"
  },
  {
    "text": "with them so second is a file what",
    "start": "444240",
    "end": "446800"
  },
  {
    "text": "happen if I fork guess what if you fork",
    "start": "446800",
    "end": "450960"
  },
  {
    "text": "uh the the the files are shared right",
    "start": "450960",
    "end": "455120"
  },
  {
    "text": "because you get a copy of everything",
    "start": "455120",
    "end": "457840"
  },
  {
    "text": "that the process had at that point",
    "start": "457840",
    "end": "460560"
  },
  {
    "text": "including files descriptors so watch out",
    "start": "460560",
    "end": "463280"
  },
  {
    "text": "maybe this is this is by design and this",
    "start": "463280",
    "end": "465919"
  },
  {
    "text": "is good so when you fork careful where",
    "start": "465919",
    "end": "468880"
  },
  {
    "text": "you forked you fork you get everything",
    "start": "468880",
    "end": "471120"
  },
  {
    "start": "470000",
    "end": "1136000"
  },
  {
    "text": "so we talked about let's let's go back",
    "start": "471120",
    "end": "473360"
  },
  {
    "text": "to our single process we have a single",
    "start": "473360",
    "end": "475599"
  },
  {
    "text": "socket in my process for every listening",
    "start": "475599",
    "end": "478400"
  },
  {
    "text": "socket that we create you guys we get uh",
    "start": "478400",
    "end": "482160"
  },
  {
    "text": "something called two things you get two",
    "start": "482160",
    "end": "484879"
  },
  {
    "text": "cues don't get hung up on the word Q",
    "start": "484879",
    "end": "486879"
  },
  {
    "text": "because they are not actually",
    "start": "486879",
    "end": "488080"
  },
  {
    "text": "implemented as a Q because a Q is a very",
    "start": "488080",
    "end": "490560"
  },
  {
    "text": "it's not very efficient in this",
    "start": "490560",
    "end": "492479"
  },
  {
    "text": "particular case actually one of my",
    "start": "492479",
    "end": "494960"
  },
  {
    "text": "student called that i was like saying",
    "start": "494960",
    "end": "496800"
  },
  {
    "text": "like the Q seems to be very inefficient",
    "start": "496800",
    "end": "498960"
  },
  {
    "text": "but I and I looked the source code it's",
    "start": "498960",
    "end": "500639"
  },
  {
    "text": "not a Q at all it's has a hash table",
    "start": "500639",
    "end": "502960"
  },
  {
    "text": "turns out but we talk about it as a Q",
    "start": "502960",
    "end": "506240"
  },
  {
    "text": "because it's easier to talk through it",
    "start": "506240",
    "end": "508720"
  },
  {
    "text": "this way so we get something called a",
    "start": "508720",
    "end": "510879"
  },
  {
    "text": "sin Q and this belongs to the socket S",
    "start": "510879",
    "end": "514240"
  },
  {
    "text": "and we get another Q called the accept",
    "start": "514240",
    "end": "518200"
  },
  {
    "text": "Q what are those for well if you're if",
    "start": "518200",
    "end": "523360"
  },
  {
    "text": "you're here you probably know how to",
    "start": "523360",
    "end": "525279"
  },
  {
    "text": "establish a TCP connection right we do a",
    "start": "525279",
    "end": "528120"
  },
  {
    "text": "send and then the server sends back a",
    "start": "528120",
    "end": "531519"
  },
  {
    "text": "sin act and then the client sends back",
    "start": "531519",
    "end": "534640"
  },
  {
    "text": "an act and that's called a three-way",
    "start": "534640",
    "end": "536560"
  },
  {
    "text": "handshake and using that we get a",
    "start": "536560",
    "end": "539680"
  },
  {
    "text": "beautiful uh",
    "start": "539680",
    "end": "542440"
  },
  {
    "text": "connection but that's the handshake to",
    "start": "542440",
    "end": "544959"
  },
  {
    "text": "handle the handshake we we need this",
    "start": "544959",
    "end": "548399"
  },
  {
    "text": "sends which is the synchronization we",
    "start": "548399",
    "end": "550640"
  },
  {
    "text": "use them to to synchronize the sequence",
    "start": "550640",
    "end": "554080"
  },
  {
    "text": "numbers that we use to label every",
    "start": "554080",
    "end": "556320"
  },
  {
    "text": "segment So that's the first thing send Q",
    "start": "556320",
    "end": "559200"
  },
  {
    "text": "so if you have a lot of listening you",
    "start": "559200",
    "end": "561040"
  },
  {
    "text": "get a lot of sync cues essentially you",
    "start": "561040",
    "end": "563360"
  },
  {
    "text": "also get an accept Q this stores",
    "start": "563360",
    "end": "566800"
  },
  {
    "text": "completed connections because if I did",
    "start": "566800",
    "end": "569279"
  },
  {
    "text": "if I am a client I want to connect to",
    "start": "569279",
    "end": "571200"
  },
  {
    "text": "you i first send you a sin by just send",
    "start": "571200",
    "end": "573519"
  },
  {
    "text": "you a SI I don't have a connection",
    "start": "573519",
    "end": "575399"
  },
  {
    "text": "yet we take your SIN and put it in the",
    "start": "575399",
    "end": "578240"
  },
  {
    "text": "SIN queue we don't have a full-fledged",
    "start": "578240",
    "end": "580399"
  },
  {
    "text": "connection we only have full flash",
    "start": "580399",
    "end": "581920"
  },
  {
    "text": "connection if we successfully completed",
    "start": "581920",
    "end": "584959"
  },
  {
    "text": "the three-way handshake",
    "start": "584959",
    "end": "588279"
  },
  {
    "text": "right so then you can see that as I'm",
    "start": "588279",
    "end": "592800"
  },
  {
    "text": "putting sends here from multiple",
    "start": "592800",
    "end": "595640"
  },
  {
    "text": "clients right from one client in India",
    "start": "595640",
    "end": "599279"
  },
  {
    "text": "one client in Germany one client coming",
    "start": "599279",
    "end": "601760"
  },
  {
    "text": "from an IP address from Lebanon one from",
    "start": "601760",
    "end": "605120"
  },
  {
    "text": "Bahrain one you see you can see that",
    "start": "605120",
    "end": "607760"
  },
  {
    "text": "this can fill up and then we complete",
    "start": "607760",
    "end": "609920"
  },
  {
    "text": "the connection so we move this stuff to",
    "start": "609920",
    "end": "611760"
  },
  {
    "text": "the accept queue and we have",
    "start": "611760",
    "end": "613040"
  },
  {
    "text": "full-fledged connection from Germany",
    "start": "613040",
    "end": "615600"
  },
  {
    "text": "from Russia we have these connections",
    "start": "615600",
    "end": "617519"
  },
  {
    "text": "ready but how many can I keep in my",
    "start": "617519",
    "end": "622680"
  },
  {
    "text": "cues before it fills up there's a size",
    "start": "622680",
    "end": "626480"
  },
  {
    "text": "to those and this size is called the",
    "start": "626480",
    "end": "628480"
  },
  {
    "text": "backlog and you can essentially when you",
    "start": "628480",
    "end": "630320"
  },
  {
    "text": "call listen you can specify the backlog",
    "start": "630320",
    "end": "632560"
  },
  {
    "text": "and this is actually exposed all the way",
    "start": "632560",
    "end": "635279"
  },
  {
    "text": "to the clients even in NodeJS you can",
    "start": "635279",
    "end": "637680"
  },
  {
    "text": "node and you can specify how how much is",
    "start": "637680",
    "end": "639440"
  },
  {
    "text": "your backlog really pretty cool if you",
    "start": "639440",
    "end": "641440"
  },
  {
    "text": "think about it you might need a large",
    "start": "641440",
    "end": "642800"
  },
  {
    "text": "backlog if you have so many connections",
    "start": "642800",
    "end": "645519"
  },
  {
    "text": "coming your way and you want to",
    "start": "645519",
    "end": "649800"
  },
  {
    "text": "essentially you're not accepting",
    "start": "649800",
    "end": "652000"
  },
  {
    "text": "connections fast enough we'll talk about",
    "start": "652000",
    "end": "654560"
  },
  {
    "text": "accepting in a minute now cuz",
    "start": "654560",
    "end": "656800"
  },
  {
    "text": "connections that lives here still is not",
    "start": "656800",
    "end": "659200"
  },
  {
    "text": "with us the back end this is still all",
    "start": "659200",
    "end": "662880"
  },
  {
    "text": "kernel so now let's talk about actually",
    "start": "662880",
    "end": "666480"
  },
  {
    "text": "creating connection we don't we up to",
    "start": "666480",
    "end": "668399"
  },
  {
    "text": "here we don't have a connection yet we",
    "start": "668399",
    "end": "670240"
  },
  {
    "text": "only have a listening socket that is one",
    "start": "670240",
    "end": "672560"
  },
  {
    "text": "file descriptor now let's talk about",
    "start": "672560",
    "end": "676440"
  },
  {
    "text": "connections what happened in here is",
    "start": "676440",
    "end": "678320"
  },
  {
    "text": "like completed connections are placed in",
    "start": "678320",
    "end": "680880"
  },
  {
    "text": "the accept queue we talked about that",
    "start": "680880",
    "end": "682959"
  },
  {
    "text": "after you finish when you put a send put",
    "start": "682959",
    "end": "686000"
  },
  {
    "text": "here and then the sin entry comes here",
    "start": "686000",
    "end": "689600"
  },
  {
    "text": "until we we send back the sin act and",
    "start": "689600",
    "end": "692399"
  },
  {
    "text": "then the client will send back an act",
    "start": "692399",
    "end": "694240"
  },
  {
    "text": "and then we match the act with the sin",
    "start": "694240",
    "end": "696480"
  },
  {
    "text": "here and then we remove it from the sin",
    "start": "696480",
    "end": "698640"
  },
  {
    "text": "q and we add it to the accept queue and",
    "start": "698640",
    "end": "700720"
  },
  {
    "text": "now we have a full-fledged connection",
    "start": "700720",
    "end": "702240"
  },
  {
    "text": "but it still is not",
    "start": "702240",
    "end": "704360"
  },
  {
    "text": "ready you have to accept it",
    "start": "704360",
    "end": "708480"
  },
  {
    "text": "who who is you it's a backend",
    "start": "708480",
    "end": "712519"
  },
  {
    "text": "application you must say I never called",
    "start": "712519",
    "end": "714880"
  },
  {
    "text": "this function in my life well you don't",
    "start": "714880",
    "end": "719360"
  },
  {
    "text": "but NodeJS does bun",
    "start": "719360",
    "end": "723360"
  },
  {
    "text": "does Django does all your framework does",
    "start": "723640",
    "end": "729399"
  },
  {
    "text": "do behind the scenes you must call",
    "start": "729399",
    "end": "733000"
  },
  {
    "text": "accept which which creates the file",
    "start": "733000",
    "end": "737079"
  },
  {
    "text": "descriptor for that connection yes there",
    "start": "737079",
    "end": "740320"
  },
  {
    "text": "is a dedicated files connect descriptor",
    "start": "740320",
    "end": "743839"
  },
  {
    "text": "f identifier for each",
    "start": "743839",
    "end": "746600"
  },
  {
    "text": "connection and when you do that then we",
    "start": "746600",
    "end": "749760"
  },
  {
    "text": "create additional two cues for the",
    "start": "749760",
    "end": "752639"
  },
  {
    "text": "actual data that going to be sent right",
    "start": "752639",
    "end": "756000"
  },
  {
    "text": "so when you do that you accept you're",
    "start": "756000",
    "end": "757760"
  },
  {
    "text": "going to create a connection that",
    "start": "757760",
    "end": "759839"
  },
  {
    "text": "connection is going to be a file",
    "start": "759839",
    "end": "761120"
  },
  {
    "text": "descriptor which lives on whomver or",
    "start": "761120",
    "end": "764000"
  },
  {
    "text": "whoever whom or who whomever the process",
    "start": "764000",
    "end": "767600"
  },
  {
    "text": "that called except if I I'm process A I",
    "start": "767600",
    "end": "770560"
  },
  {
    "text": "called accept then the file descriptor",
    "start": "770560",
    "end": "772639"
  },
  {
    "text": "that comes back will live in process A",
    "start": "772639",
    "end": "774800"
  },
  {
    "text": "if I'm process B and happen to have",
    "start": "774800",
    "end": "776800"
  },
  {
    "text": "access to the socket somehow and I",
    "start": "776800",
    "end": "779200"
  },
  {
    "text": "called accept then the file descriptor",
    "start": "779200",
    "end": "781760"
  },
  {
    "text": "that gets created will live in my",
    "start": "781760",
    "end": "784399"
  },
  {
    "text": "process B's PCB process control block",
    "start": "784399",
    "end": "788160"
  },
  {
    "text": "and it's going to be a chain of file",
    "start": "788160",
    "end": "790399"
  },
  {
    "text": "descriptors maybe I'll accept 100",
    "start": "790399",
    "end": "794200"
  },
  {
    "text": "connections with everyone you get two",
    "start": "794200",
    "end": "796800"
  },
  {
    "text": "cues send a Q or receive Q we'll go",
    "start": "796800",
    "end": "799360"
  },
  {
    "text": "we'll come to that in the next lecture",
    "start": "799360",
    "end": "801200"
  },
  {
    "text": "but each of them the send Q will go for",
    "start": "801200",
    "end": "803519"
  },
  {
    "text": "your outgoing data so as a server as a",
    "start": "803519",
    "end": "807120"
  },
  {
    "text": "backend if I send a response to my REST",
    "start": "807120",
    "end": "811200"
  },
  {
    "text": "API call that goes to the send Q if my",
    "start": "811200",
    "end": "815040"
  },
  {
    "text": "client sends a request it goes to the",
    "start": "815040",
    "end": "818000"
  },
  {
    "text": "receive queue does that make sense and",
    "start": "818000",
    "end": "820959"
  },
  {
    "text": "vice versa the client also has a",
    "start": "820959",
    "end": "823839"
  },
  {
    "text": "connection on its end as a client and it",
    "start": "823839",
    "end": "827040"
  },
  {
    "text": "will have a send queue and it has a",
    "start": "827040",
    "end": "828720"
  },
  {
    "text": "receive queue the client does not have a",
    "start": "828720",
    "end": "831040"
  },
  {
    "text": "socket it does not have a listening",
    "start": "831040",
    "end": "832959"
  },
  {
    "text": "socket it has a just a",
    "start": "832959",
    "end": "836519"
  },
  {
    "text": "connection so it have a send queue and a",
    "start": "836519",
    "end": "838959"
  },
  {
    "text": "receive queue so if a client sends a",
    "start": "838959",
    "end": "841040"
  },
  {
    "text": "request it goes to the send queue and",
    "start": "841040",
    "end": "842959"
  },
  {
    "text": "then eventually the kernel pushes it out",
    "start": "842959",
    "end": "845040"
  },
  {
    "text": "to the neck and then uh it holds a",
    "start": "845040",
    "end": "847760"
  },
  {
    "text": "receive queue where the response from",
    "start": "847760",
    "end": "849680"
  },
  {
    "text": "the server will go into before we",
    "start": "849680",
    "end": "852800"
  },
  {
    "text": "actually take the data and push it into",
    "start": "852800",
    "end": "855279"
  },
  {
    "text": "the user space and do some stuff with it",
    "start": "855279",
    "end": "858000"
  },
  {
    "text": "let's go through some",
    "start": "858000",
    "end": "859399"
  },
  {
    "text": "animations so here's my client here's my",
    "start": "859399",
    "end": "862480"
  },
  {
    "text": "process ID on the back end that is",
    "start": "862480",
    "end": "864440"
  },
  {
    "text": "running and of course these two lives in",
    "start": "864440",
    "end": "866800"
  },
  {
    "text": "the kernel which nothing but a mapped",
    "start": "866800",
    "end": "869360"
  },
  {
    "text": "area in the process to the kernel state",
    "start": "869360",
    "end": "872120"
  },
  {
    "text": "uh uh to the kernel state right so",
    "start": "872120",
    "end": "875440"
  },
  {
    "text": "accessing those cues right of course",
    "start": "875440",
    "end": "878079"
  },
  {
    "text": "require kernel mode right to be accessed",
    "start": "878079",
    "end": "880720"
  },
  {
    "text": "you cannot access them directly from the",
    "start": "880720",
    "end": "882639"
  },
  {
    "text": "process these are forbidden right uh",
    "start": "882639",
    "end": "885920"
  },
  {
    "text": "again IO uring kind of bring breaks this",
    "start": "885920",
    "end": "889680"
  },
  {
    "text": "rule but for normal operation you cannot",
    "start": "889680",
    "end": "892800"
  },
  {
    "text": "access them they are protected so the",
    "start": "892800",
    "end": "895519"
  },
  {
    "text": "sin comes in here and sits in the sin q",
    "start": "895519",
    "end": "899519"
  },
  {
    "text": "right so the sin will have a from IP",
    "start": "899519",
    "end": "902480"
  },
  {
    "text": "address a from port a destination IP",
    "start": "902480",
    "end": "905040"
  },
  {
    "text": "address and a destination port and",
    "start": "905040",
    "end": "906480"
  },
  {
    "text": "that's the four pupils that uniquely",
    "start": "906480",
    "end": "909279"
  },
  {
    "text": "identify this guy and you put it right",
    "start": "909279",
    "end": "911560"
  },
  {
    "text": "here beautiful now we have a sin entry",
    "start": "911560",
    "end": "915040"
  },
  {
    "text": "You immediately as a kernel reply back",
    "start": "915040",
    "end": "917199"
  },
  {
    "text": "by SN act where the from and to from IP",
    "start": "917199",
    "end": "920320"
  },
  {
    "text": "and from port is the whatever listening",
    "start": "920320",
    "end": "923839"
  },
  {
    "text": "socket IP we listen to right and",
    "start": "923839",
    "end": "927760"
  },
  {
    "text": "actually whatever the client decided to",
    "start": "927760",
    "end": "930399"
  },
  {
    "text": "connect to let's say I'm listening on",
    "start": "930399",
    "end": "932000"
  },
  {
    "text": "all IPs right so the the send the client",
    "start": "932000",
    "end": "936240"
  },
  {
    "text": "cannot connect to all IPs it has to",
    "start": "936240",
    "end": "938160"
  },
  {
    "text": "specify one and by knowing that one that",
    "start": "938160",
    "end": "941839"
  },
  {
    "text": "becomes the source IP in this particular",
    "start": "941839",
    "end": "943839"
  },
  {
    "text": "case if and only if there is a matching",
    "start": "943839",
    "end": "949040"
  },
  {
    "text": "corresponding socket because I I I drew",
    "start": "949040",
    "end": "952880"
  },
  {
    "text": "this as a line but there's so much stuff",
    "start": "952880",
    "end": "955040"
  },
  {
    "text": "doing going going on here what is what",
    "start": "955040",
    "end": "956880"
  },
  {
    "text": "is going on if I am doing a sin and my",
    "start": "956880",
    "end": "960160"
  },
  {
    "text": "destination IP is",
    "start": "960160",
    "end": "963279"
  },
  {
    "text": "1.1.1 right that's cloud flares and the",
    "start": "963320",
    "end": "967600"
  },
  {
    "text": "port is",
    "start": "967600",
    "end": "969000"
  },
  {
    "text": "80 then the kernel first looks up the",
    "start": "969000",
    "end": "972480"
  },
  {
    "text": "destination IP in certain table that",
    "start": "972480",
    "end": "975600"
  },
  {
    "text": "we're going to talk about and that table",
    "start": "975600",
    "end": "977759"
  },
  {
    "text": "says all right do I have a matching",
    "start": "977759",
    "end": "982800"
  },
  {
    "text": "uh kernel entry that says I'm listening",
    "start": "982800",
    "end": "987519"
  },
  {
    "text": "on this particular socket on this IP yes",
    "start": "987519",
    "end": "992000"
  },
  {
    "text": "or no if yes let's do it I accept you if",
    "start": "992000",
    "end": "996480"
  },
  {
    "text": "no we get an error that no listening",
    "start": "996480",
    "end": "998480"
  },
  {
    "text": "socket or we get an",
    "start": "998480",
    "end": "1000480"
  },
  {
    "text": "All right so you see there's a matching",
    "start": "1000480",
    "end": "1002959"
  },
  {
    "text": "that needs to happen we need to look",
    "start": "1002959",
    "end": "1006519"
  },
  {
    "text": "up imagine yourself actually",
    "start": "1006519",
    "end": "1008399"
  },
  {
    "text": "implementing this how we do do it",
    "start": "1008399",
    "end": "1010160"
  },
  {
    "text": "there's like billions of way to do it a",
    "start": "1010160",
    "end": "1012800"
  },
  {
    "text": "little exaggerating but the colonel does",
    "start": "1012800",
    "end": "1014959"
  },
  {
    "text": "it certain way this lookup should",
    "start": "1014959",
    "end": "1018360"
  },
  {
    "text": "be massively",
    "start": "1018360",
    "end": "1021240"
  },
  {
    "text": "fast pro possibly hopefully in the in",
    "start": "1021240",
    "end": "1024160"
  },
  {
    "text": "the in the cache and the CPU all of",
    "start": "1024160",
    "end": "1026000"
  },
  {
    "text": "these structures really need to be",
    "start": "1026000",
    "end": "1028160"
  },
  {
    "text": "cached cuz you don't want to go look up",
    "start": "1028160",
    "end": "1030959"
  },
  {
    "text": "that massive table with all the",
    "start": "1030959",
    "end": "1033120"
  },
  {
    "text": "listeners you know you want to quickly",
    "start": "1033120",
    "end": "1035839"
  },
  {
    "text": "look it up and from this you would know",
    "start": "1035839",
    "end": "1039360"
  },
  {
    "text": "based on that entry you would know which",
    "start": "1039360",
    "end": "1041720"
  },
  {
    "text": "process it belongs",
    "start": "1041720",
    "end": "1043798"
  },
  {
    "text": "to absolutely",
    "start": "1043799",
    "end": "1046678"
  },
  {
    "text": "beautiful so now we send this act let's",
    "start": "1046679",
    "end": "1049600"
  },
  {
    "text": "say we have a behaving client that",
    "start": "1049600",
    "end": "1051120"
  },
  {
    "text": "replies back with an act now we have a",
    "start": "1051120",
    "end": "1052960"
  },
  {
    "text": "full-fledged connection the kernel",
    "start": "1052960",
    "end": "1054960"
  },
  {
    "text": "removes it and adds it to the accept",
    "start": "1054960",
    "end": "1057280"
  },
  {
    "text": "queue now we have a free connection here",
    "start": "1057280",
    "end": "1059919"
  },
  {
    "text": "now",
    "start": "1059919",
    "end": "1061400"
  },
  {
    "text": "then the process calls",
    "start": "1061400",
    "end": "1065000"
  },
  {
    "text": "accept which will copy that connection",
    "start": "1065000",
    "end": "1069440"
  },
  {
    "text": "creates the content creates a file",
    "start": "1069440",
    "end": "1071520"
  },
  {
    "text": "descriptor and copy it the to the user's",
    "start": "1071520",
    "end": "1074080"
  },
  {
    "text": "file space and it will create an entry",
    "start": "1074080",
    "end": "1076799"
  },
  {
    "text": "yeah that says all right now we have an",
    "start": "1076799",
    "end": "1079799"
  },
  {
    "text": "actual",
    "start": "1079799",
    "end": "1081799"
  },
  {
    "text": "connection and it will create the two",
    "start": "1081799",
    "end": "1085039"
  },
  {
    "text": "receive Q the the receive Q and the send",
    "start": "1085039",
    "end": "1087760"
  },
  {
    "text": "Q for that particular",
    "start": "1087760",
    "end": "1089640"
  },
  {
    "text": "connection right now we have a file",
    "start": "1089640",
    "end": "1092480"
  },
  {
    "text": "descriptor right",
    "start": "1092480",
    "end": "1095360"
  },
  {
    "text": "here so problems with accepting",
    "start": "1095480",
    "end": "1098000"
  },
  {
    "text": "connections let's talk about some",
    "start": "1098000",
    "end": "1099120"
  },
  {
    "text": "problems backend doesn't accept fast",
    "start": "1099120",
    "end": "1101200"
  },
  {
    "text": "enough clients who don't act and we have",
    "start": "1101200",
    "end": "1104160"
  },
  {
    "text": "a small backlog if you have a small",
    "start": "1104160",
    "end": "1106559"
  },
  {
    "text": "backlog you might you might have a",
    "start": "1106559",
    "end": "1109280"
  },
  {
    "text": "problem with um you",
    "start": "1109280",
    "end": "1111160"
  },
  {
    "text": "know you call accept by the way if you",
    "start": "1111160",
    "end": "1113840"
  },
  {
    "text": "call accept and this is empty you're",
    "start": "1113840",
    "end": "1116559"
  },
  {
    "text": "block and that's why except is also a",
    "start": "1116559",
    "end": "1120240"
  },
  {
    "text": "candidate for asynchronous IO which",
    "start": "1120240",
    "end": "1122799"
  },
  {
    "text": "we're going to talk about in another",
    "start": "1122799",
    "end": "1124000"
  },
  {
    "text": "lecture beautiful stuff you guys let's",
    "start": "1124000",
    "end": "1126480"
  },
  {
    "text": "talk about socket sharding there",
    "start": "1126480",
    "end": "1129240"
  },
  {
    "text": "are two different approaches to this you",
    "start": "1129240",
    "end": "1132679"
  },
  {
    "text": "know I'll talk about this is the second",
    "start": "1132679",
    "end": "1135679"
  },
  {
    "text": "one which is literally getting a",
    "start": "1135679",
    "end": "1140760"
  },
  {
    "start": "1136000",
    "end": "1394000"
  },
  {
    "text": "different distinct socket on the same",
    "start": "1140760",
    "end": "1145200"
  },
  {
    "text": "port so we have two processes that are",
    "start": "1145200",
    "end": "1148880"
  },
  {
    "text": "not talking to each other yet listening",
    "start": "1148880",
    "end": "1152240"
  },
  {
    "text": "on the same socket so you have two",
    "start": "1152240",
    "end": "1155720"
  },
  {
    "text": "sockets pointing to the same",
    "start": "1155720",
    "end": "1160520"
  },
  {
    "text": "um IP port",
    "start": "1160520",
    "end": "1163640"
  },
  {
    "text": "pair",
    "start": "1163640",
    "end": "1165400"
  },
  {
    "text": "listener versus the other approach where",
    "start": "1165400",
    "end": "1168640"
  },
  {
    "text": "you have a listening socket and you fork",
    "start": "1168640",
    "end": "1170720"
  },
  {
    "text": "the process to get a copy of the file",
    "start": "1170720",
    "end": "1173280"
  },
  {
    "text": "descriptor which happened to point to",
    "start": "1173280",
    "end": "1175200"
  },
  {
    "text": "the same logical physical sorry",
    "start": "1175200",
    "end": "1178919"
  },
  {
    "text": "socket so if those two",
    "start": "1178919",
    "end": "1181880"
  },
  {
    "text": "guys we're sharing one pair of sin and",
    "start": "1181880",
    "end": "1186960"
  },
  {
    "text": "accept Q",
    "start": "1186960",
    "end": "1188760"
  },
  {
    "text": "here this is an approach where we're",
    "start": "1188760",
    "end": "1192000"
  },
  {
    "text": "getting two distinct socket pointing to",
    "start": "1192000",
    "end": "1195280"
  },
  {
    "text": "the same",
    "start": "1195280",
    "end": "1196520"
  },
  {
    "text": "entry and you do this using this soit",
    "start": "1196520",
    "end": "1200080"
  },
  {
    "text": "option reuse",
    "start": "1200080",
    "end": "1202360"
  },
  {
    "text": "port",
    "start": "1202360",
    "end": "1204679"
  },
  {
    "text": "because normally if you listen on the",
    "start": "1204679",
    "end": "1207679"
  },
  {
    "text": "same port and IP you get an error error",
    "start": "1207679",
    "end": "1210160"
  },
  {
    "text": "remember like socket already listening",
    "start": "1210160",
    "end": "1212160"
  },
  {
    "text": "that's a common error but with this you",
    "start": "1212160",
    "end": "1215840"
  },
  {
    "text": "can",
    "start": "1215840",
    "end": "1216919"
  },
  {
    "text": "actually get to another socket and you",
    "start": "1216919",
    "end": "1221039"
  },
  {
    "text": "can do it any number of time now this",
    "start": "1221039",
    "end": "1224640"
  },
  {
    "text": "poses it and and we'll we'll talk about",
    "start": "1224640",
    "end": "1226720"
  },
  {
    "text": "this now in a",
    "start": "1226720",
    "end": "1228679"
  },
  {
    "text": "minute does it envoy does it haroxy does",
    "start": "1228679",
    "end": "1231919"
  },
  {
    "text": "it and essentially what you do is you",
    "start": "1231919",
    "end": "1234880"
  },
  {
    "text": "have the listener and the acptors and",
    "start": "1234880",
    "end": "1237200"
  },
  {
    "text": "the readers right the accept receptors",
    "start": "1237200",
    "end": "1239840"
  },
  {
    "text": "all of these are just different threads",
    "start": "1239840",
    "end": "1241919"
  },
  {
    "text": "or different processes and this is what",
    "start": "1241919",
    "end": "1244480"
  },
  {
    "text": "is called the socket shorting where this",
    "start": "1244480",
    "end": "1247720"
  },
  {
    "text": "process will have a socket and this",
    "start": "1247720",
    "end": "1251440"
  },
  {
    "text": "process will also have a socket and both",
    "start": "1251440",
    "end": "1254760"
  },
  {
    "text": "represent the same IP port now this",
    "start": "1254760",
    "end": "1259360"
  },
  {
    "text": "poses a problem because if a client came",
    "start": "1259360",
    "end": "1263520"
  },
  {
    "text": "in with a sin what do we do in this",
    "start": "1263520",
    "end": "1266000"
  },
  {
    "text": "particular case which socket gets this",
    "start": "1266000",
    "end": "1269360"
  },
  {
    "text": "send and now I I'm imagining and I don't",
    "start": "1269360",
    "end": "1272400"
  },
  {
    "text": "know the detail about this and I",
    "start": "1272400",
    "end": "1274400"
  },
  {
    "text": "imagining either you can have two sins",
    "start": "1274400",
    "end": "1277840"
  },
  {
    "text": "or one sin q for both sockets but",
    "start": "1277840",
    "end": "1282240"
  },
  {
    "text": "different accept cues for",
    "start": "1282240",
    "end": "1284520"
  },
  {
    "text": "sure right so in this particular case",
    "start": "1284520",
    "end": "1287120"
  },
  {
    "text": "process one will have an accept process",
    "start": "1287120",
    "end": "1289200"
  },
  {
    "text": "two will have another accept Q for the",
    "start": "1289200",
    "end": "1291200"
  },
  {
    "text": "same port if I get a sin on this port",
    "start": "1291200",
    "end": "1294880"
  },
  {
    "text": "complete the connection Ready the kernel",
    "start": "1294880",
    "end": "1298480"
  },
  {
    "text": "will do a load balancing it will throw",
    "start": "1298480",
    "end": "1301520"
  },
  {
    "text": "the accept Q right it will throw the",
    "start": "1301520",
    "end": "1304960"
  },
  {
    "text": "first connection on the first except Q",
    "start": "1304960",
    "end": "1306799"
  },
  {
    "text": "the second one on the second the third",
    "start": "1306799",
    "end": "1308720"
  },
  {
    "text": "one on the third and so on right and",
    "start": "1308720",
    "end": "1311039"
  },
  {
    "text": "that's how it that's how they do it so",
    "start": "1311039",
    "end": "1314400"
  },
  {
    "text": "it will",
    "start": "1314400",
    "end": "1315960"
  },
  {
    "text": "distribute the connections on different",
    "start": "1315960",
    "end": "1320240"
  },
  {
    "text": "accept Q's and if it happens to have on",
    "start": "1320240",
    "end": "1324080"
  },
  {
    "text": "this accept QES this process calls",
    "start": "1324080",
    "end": "1326080"
  },
  {
    "text": "accept on its own socket which will",
    "start": "1326080",
    "end": "1328880"
  },
  {
    "text": "point to their own accept Q and in this",
    "start": "1328880",
    "end": "1331440"
  },
  {
    "text": "particular case we call accept on my",
    "start": "1331440",
    "end": "1333840"
  },
  {
    "text": "socket which happens",
    "start": "1333840",
    "end": "1336600"
  },
  {
    "text": "to but both are on the same neck on the",
    "start": "1336600",
    "end": "1342080"
  },
  {
    "text": "same IP and port this is a common",
    "start": "1342080",
    "end": "1344400"
  },
  {
    "text": "configuration that people do in order to",
    "start": "1344400",
    "end": "1347679"
  },
  {
    "text": "scale acceptance right and this is",
    "start": "1347679",
    "end": "1351120"
  },
  {
    "text": "referred to as socket sharding we're",
    "start": "1351120",
    "end": "1353120"
  },
  {
    "text": "sharding the socket but the Linux kernel",
    "start": "1353120",
    "end": "1355919"
  },
  {
    "text": "in this particular case does the load",
    "start": "1355919",
    "end": "1357679"
  },
  {
    "text": "balancing so there is uh when they first",
    "start": "1357679",
    "end": "1361679"
  },
  {
    "text": "introduced this there was a lot of bugs",
    "start": "1361679",
    "end": "1363679"
  },
  {
    "text": "with",
    "start": "1363679",
    "end": "1364520"
  },
  {
    "text": "this because uh as connections close and",
    "start": "1364520",
    "end": "1370360"
  },
  {
    "text": "open we lost the balance of uh when when",
    "start": "1370360",
    "end": "1375039"
  },
  {
    "text": "you have a connection you're done the",
    "start": "1375039",
    "end": "1377039"
  },
  {
    "text": "connection is like you have a nice file",
    "start": "1377039",
    "end": "1379280"
  },
  {
    "text": "descriptor to go to the problem with",
    "start": "1379280",
    "end": "1382000"
  },
  {
    "text": "this is only when you accept connections",
    "start": "1382000",
    "end": "1384320"
  },
  {
    "text": "the load balancing becomes really",
    "start": "1384320",
    "end": "1386080"
  },
  {
    "text": "interesting as as sockets get destroyed",
    "start": "1386080",
    "end": "1388799"
  },
  {
    "text": "and recreated again all right second",
    "start": "1388799",
    "end": "1391919"
  },
  {
    "text": "example receive buffer so receive buffer",
    "start": "1391919",
    "end": "1396000"
  },
  {
    "start": "1394000",
    "end": "1620000"
  },
  {
    "text": "so the data comes in and we know the",
    "start": "1396000",
    "end": "1398640"
  },
  {
    "text": "connection we know the destination IP",
    "start": "1398640",
    "end": "1401360"
  },
  {
    "text": "and we know the destination port the",
    "start": "1401360",
    "end": "1403919"
  },
  {
    "text": "kernel identifies it right and",
    "start": "1403919",
    "end": "1407240"
  },
  {
    "text": "uh we might say what if I have multiple",
    "start": "1407240",
    "end": "1409919"
  },
  {
    "text": "connections well we use four pairs and",
    "start": "1409919",
    "end": "1412960"
  },
  {
    "text": "this must be unique the source port and",
    "start": "1412960",
    "end": "1415520"
  },
  {
    "text": "the source IP will give us beautiful",
    "start": "1415520",
    "end": "1418600"
  },
  {
    "text": "uniqueness so even if the same client",
    "start": "1418600",
    "end": "1420960"
  },
  {
    "text": "establish a,000 connection you're going",
    "start": "1420960",
    "end": "1422720"
  },
  {
    "text": "to get a thousand different source ports",
    "start": "1422720",
    "end": "1425440"
  },
  {
    "text": "even if the IP the source IP is the same",
    "start": "1425440",
    "end": "1428400"
  },
  {
    "text": "you're going to get a thousand different",
    "start": "1428400",
    "end": "1429760"
  },
  {
    "text": "source ports so you're safe right so the",
    "start": "1429760",
    "end": "1432960"
  },
  {
    "text": "source port changes the source IP",
    "start": "1432960",
    "end": "1434720"
  },
  {
    "text": "doesn't change the destination IP",
    "start": "1434720",
    "end": "1436159"
  },
  {
    "text": "doesn't change the destination port",
    "start": "1436159",
    "end": "1437360"
  },
  {
    "text": "doesn't change the only thing that",
    "start": "1437360",
    "end": "1438720"
  },
  {
    "text": "changes is the port if if the same",
    "start": "1438720",
    "end": "1441840"
  },
  {
    "text": "client sends a creates a thousand",
    "start": "1441840",
    "end": "1444000"
  },
  {
    "text": "connection you put the data here nice",
    "start": "1444000",
    "end": "1446720"
  },
  {
    "text": "and then you",
    "start": "1446720",
    "end": "1449159"
  },
  {
    "text": "acknowledge right and you can choose",
    "start": "1449159",
    "end": "1451840"
  },
  {
    "text": "like as a kernel you know what i'm going",
    "start": "1451840",
    "end": "1453360"
  },
  {
    "text": "to wait a little bit more for more",
    "start": "1453360",
    "end": "1454720"
  },
  {
    "text": "packets to arrive and then the process",
    "start": "1454720",
    "end": "1456960"
  },
  {
    "text": "calls read which copies and that's what",
    "start": "1456960",
    "end": "1459279"
  },
  {
    "text": "I talked about there's a copy from this",
    "start": "1459279",
    "end": "1461760"
  },
  {
    "text": "kernel to the process so copy involves",
    "start": "1461760",
    "end": "1465200"
  },
  {
    "text": "going to the processor the proc because",
    "start": "1465200",
    "end": "1468000"
  },
  {
    "text": "the processor does a read from this",
    "start": "1468000",
    "end": "1470159"
  },
  {
    "text": "memory address copies to the cache lines",
    "start": "1470159",
    "end": "1473120"
  },
  {
    "text": "and then from cache line does a write to",
    "start": "1473120",
    "end": "1475360"
  },
  {
    "text": "the new memory location that's how a",
    "start": "1475360",
    "end": "1477760"
  },
  {
    "text": "copy is memory copy is is not cheap it",
    "start": "1477760",
    "end": "1480799"
  },
  {
    "text": "involves going to buses to different",
    "start": "1480799",
    "end": "1484640"
  },
  {
    "text": "memory",
    "start": "1484640",
    "end": "1485559"
  },
  {
    "text": "addresses so so many copies so imagine",
    "start": "1485559",
    "end": "1489360"
  },
  {
    "text": "copying arrays right large arrays all of",
    "start": "1489360",
    "end": "1492240"
  },
  {
    "text": "this stuff goes through the CPU right",
    "start": "1492240",
    "end": "1494320"
  },
  {
    "text": "again unless you have like direct memory",
    "start": "1494320",
    "end": "1496159"
  },
  {
    "text": "access from me one memory to memory just",
    "start": "1496159",
    "end": "1499039"
  },
  {
    "text": "copy this stuff which is also expensive",
    "start": "1499039",
    "end": "1501600"
  },
  {
    "text": "just to set up as we talked about right",
    "start": "1501600",
    "end": "1503679"
  },
  {
    "text": "all right once you read it it goes back",
    "start": "1503679",
    "end": "1505600"
  },
  {
    "text": "to the process ID that's a copy and we",
    "start": "1505600",
    "end": "1508320"
  },
  {
    "text": "talked about zero copy in general like",
    "start": "1508320",
    "end": "1510720"
  },
  {
    "text": "how do you do take this uh it depends",
    "start": "1510720",
    "end": "1514159"
  },
  {
    "text": "like what do you do right if you want to",
    "start": "1514159",
    "end": "1515679"
  },
  {
    "text": "send data from one kernel structure to",
    "start": "1515679",
    "end": "1518080"
  },
  {
    "text": "another kernel structure you can use",
    "start": "1518080",
    "end": "1519360"
  },
  {
    "text": "zero copy right by actually telling the",
    "start": "1519360",
    "end": "1522159"
  },
  {
    "text": "kernel hey just you have these two",
    "start": "1522159",
    "end": "1524000"
  },
  {
    "text": "things do them right but it's very hard",
    "start": "1524000",
    "end": "1527760"
  },
  {
    "text": "to do send buffers the client want to",
    "start": "1527760",
    "end": "1530159"
  },
  {
    "text": "send something to the to the server to",
    "start": "1530159",
    "end": "1532640"
  },
  {
    "text": "the client that sorry the server wants",
    "start": "1532640",
    "end": "1534640"
  },
  {
    "text": "to send back or even the client want to",
    "start": "1534640",
    "end": "1536559"
  },
  {
    "text": "send and the send buffers exist on both",
    "start": "1536559",
    "end": "1538559"
  },
  {
    "text": "right so you send something it goes to",
    "start": "1538559",
    "end": "1540480"
  },
  {
    "text": "the buffer and it sits here and that's",
    "start": "1540480",
    "end": "1544240"
  },
  {
    "text": "what the critical part here when you",
    "start": "1544240",
    "end": "1546000"
  },
  {
    "text": "send something it doesn't go to the",
    "start": "1546000",
    "end": "1549720"
  },
  {
    "text": "network exactly like the page cache",
    "start": "1549720",
    "end": "1552720"
  },
  {
    "text": "receive buffer",
    "start": "1552720",
    "end": "1553919"
  },
  {
    "text": "send buffer and the send buffer will",
    "start": "1553919",
    "end": "1556000"
  },
  {
    "text": "just not immediately flush it to the",
    "start": "1556000",
    "end": "1558080"
  },
  {
    "text": "network no no no no no no no that's a",
    "start": "1558080",
    "end": "1560000"
  },
  {
    "text": "bad idea we will wait we will write",
    "start": "1560000",
    "end": "1563520"
  },
  {
    "text": "right right accumulate something from",
    "start": "1563520",
    "end": "1565520"
  },
  {
    "text": "the user more then we're going to flush",
    "start": "1565520",
    "end": "1568320"
  },
  {
    "text": "it and this is where something called",
    "start": "1568320",
    "end": "1569679"
  },
  {
    "text": "Nigel algorithm kicks in and like hey",
    "start": "1569679",
    "end": "1575120"
  },
  {
    "text": "Nigel algorithm actually extend that",
    "start": "1575120",
    "end": "1576799"
  },
  {
    "text": "period how how long to do we wait before",
    "start": "1576799",
    "end": "1579120"
  },
  {
    "text": "we flush to the network so yeah",
    "start": "1579120",
    "end": "1580880"
  },
  {
    "text": "eventually we send that data and we get",
    "start": "1580880",
    "end": "1584080"
  },
  {
    "text": "back an act",
    "start": "1584080",
    "end": "1586039"
  },
  {
    "text": "and that's it problems with reading and",
    "start": "1586039",
    "end": "1588880"
  },
  {
    "text": "sending you have clients that does not",
    "start": "1588880",
    "end": "1591760"
  },
  {
    "text": "read fast enough if the back end doesn't",
    "start": "1591760",
    "end": "1593440"
  },
  {
    "text": "read fast enough you fill up your your",
    "start": "1593440",
    "end": "1595360"
  },
  {
    "text": "receiver queue if your receiver queue",
    "start": "1595360",
    "end": "1596960"
  },
  {
    "text": "gets",
    "start": "1596960",
    "end": "1598919"
  },
  {
    "text": "filled the clients slow down how does",
    "start": "1598919",
    "end": "1603279"
  },
  {
    "text": "this this is all determined by the",
    "start": "1603279",
    "end": "1604799"
  },
  {
    "text": "something called a flow control flow",
    "start": "1604799",
    "end": "1607720"
  },
  {
    "text": "control will tell the client hey my",
    "start": "1607720",
    "end": "1611039"
  },
  {
    "text": "receive buffer is actually full slow",
    "start": "1611039",
    "end": "1613039"
  },
  {
    "text": "down your rights it's a beautiful you",
    "start": "1613039",
    "end": "1616520"
  },
  {
    "text": "know symony this whole thing summary so",
    "start": "1616520",
    "end": "1620240"
  },
  {
    "start": "1620000",
    "end": "1794000"
  },
  {
    "text": "the kernel manages the TCP IP part of",
    "start": "1620240",
    "end": "1623279"
  },
  {
    "text": "networking at least every socket",
    "start": "1623279",
    "end": "1625360"
  },
  {
    "text": "represent a port and IP right you can",
    "start": "1625360",
    "end": "1629120"
  },
  {
    "text": "with a specific socket options when you",
    "start": "1629120",
    "end": "1632000"
  },
  {
    "text": "listen you can say hey I want to listen",
    "start": "1632000",
    "end": "1637600"
  },
  {
    "text": "on the same port and the same IP despite",
    "start": "1637600",
    "end": "1639919"
  },
  {
    "text": "someone else is using it but it's not",
    "start": "1639919",
    "end": "1643760"
  },
  {
    "text": "straightforward you those two processes",
    "start": "1643760",
    "end": "1646799"
  },
  {
    "text": "have to agree on certain you know on",
    "start": "1646799",
    "end": "1650360"
  },
  {
    "text": "certain cookie or certain key to allow",
    "start": "1650360",
    "end": "1653919"
  },
  {
    "text": "them to listen on the same port and this",
    "start": "1653919",
    "end": "1657200"
  },
  {
    "text": "is basically determined by the first",
    "start": "1657200",
    "end": "1659000"
  },
  {
    "text": "process if you don't know that key then",
    "start": "1659000",
    "end": "1662480"
  },
  {
    "text": "you can't listen because guess what what",
    "start": "1662480",
    "end": "1665120"
  },
  {
    "text": "stops me from running a",
    "start": "1665120",
    "end": "1668679"
  },
  {
    "text": "process in a server that happen to be",
    "start": "1668679",
    "end": "1672000"
  },
  {
    "text": "listening on port 80 and I do hey socket",
    "start": "1672000",
    "end": "1675200"
  },
  {
    "text": "reuse",
    "start": "1675200",
    "end": "1676440"
  },
  {
    "text": "80 I can hijack packets as a malicious",
    "start": "1676440",
    "end": "1680720"
  },
  {
    "text": "process that is a bad idea that was one",
    "start": "1680720",
    "end": "1683120"
  },
  {
    "text": "of the bugs early early so to to fix",
    "start": "1683120",
    "end": "1686720"
  },
  {
    "text": "that you need to know what was the key",
    "start": "1686720",
    "end": "1689520"
  },
  {
    "text": "that was used in the listening and was",
    "start": "1689520",
    "end": "1693279"
  },
  {
    "text": "socket option reuse port actually",
    "start": "1693279",
    "end": "1696159"
  },
  {
    "text": "allowed or not can you listen on the",
    "start": "1696159",
    "end": "1698640"
  },
  {
    "text": "same port I'm not so it's very very",
    "start": "1698640",
    "end": "1701279"
  },
  {
    "text": "interesting to learn about all of this",
    "start": "1701279",
    "end": "1702799"
  },
  {
    "text": "stuff so each connected client gets a",
    "start": "1702799",
    "end": "1704559"
  },
  {
    "text": "connection we talked about that and",
    "start": "1704559",
    "end": "1706240"
  },
  {
    "text": "kernel manages the all those beautiful",
    "start": "1706240",
    "end": "1709840"
  },
  {
    "text": "data structures you know and there is an",
    "start": "1709840",
    "end": "1713559"
  },
  {
    "text": "associated cost all this you guys you",
    "start": "1713559",
    "end": "1716919"
  },
  {
    "text": "know and it's not very clear from just",
    "start": "1716919",
    "end": "1719679"
  },
  {
    "text": "the listening part cuz you don't really",
    "start": "1719679",
    "end": "1722000"
  },
  {
    "text": "shove a lot of data but for the",
    "start": "1722000",
    "end": "1723679"
  },
  {
    "text": "connection",
    "start": "1723679",
    "end": "1724919"
  },
  {
    "text": "acceptance I mean not acceptance per se",
    "start": "1724919",
    "end": "1727600"
  },
  {
    "text": "but but let just just receiving and",
    "start": "1727600",
    "end": "1730960"
  },
  {
    "text": "actually dealing with packets and",
    "start": "1730960",
    "end": "1732640"
  },
  {
    "text": "parsing those packets there's so much",
    "start": "1732640",
    "end": "1734799"
  },
  {
    "text": "stuff here that I'm not going to go",
    "start": "1734799",
    "end": "1736159"
  },
  {
    "text": "through right that's a course by itself",
    "start": "1736159",
    "end": "1738960"
  },
  {
    "text": "that's a book you know because you're",
    "start": "1738960",
    "end": "1742720"
  },
  {
    "text": "talking about the actual packets how do",
    "start": "1742720",
    "end": "1746080"
  },
  {
    "text": "And there's like when you receive a",
    "start": "1746080",
    "end": "1748960"
  },
  {
    "text": "packet from the from receive data from",
    "start": "1748960",
    "end": "1752240"
  },
  {
    "text": "the neck the kernel creates a data",
    "start": "1752240",
    "end": "1754720"
  },
  {
    "text": "structure for it it's called skip uh",
    "start": "1754720",
    "end": "1757760"
  },
  {
    "text": "socket buffers right and then adds data",
    "start": "1757760",
    "end": "1761520"
  },
  {
    "text": "to it and then that there is metadata",
    "start": "1761520",
    "end": "1765039"
  },
  {
    "text": "associated with it adds overhead so the",
    "start": "1765039",
    "end": "1767600"
  },
  {
    "text": "kernel does all sorts of trick to merge",
    "start": "1767600",
    "end": "1769520"
  },
  {
    "text": "and to merge packets together and ha",
    "start": "1769520",
    "end": "1773039"
  },
  {
    "text": "have less headers do so much stuff so",
    "start": "1773039",
    "end": "1776320"
  },
  {
    "text": "you need if you are like a beefy machine",
    "start": "1776320",
    "end": "1780399"
  },
  {
    "text": "you need to assign a core or two just",
    "start": "1780399",
    "end": "1782720"
  },
  {
    "text": "for the networking stack you know says",
    "start": "1782720",
    "end": "1785600"
  },
  {
    "text": "all right I'm going to leave one core or",
    "start": "1785600",
    "end": "1787279"
  },
  {
    "text": "two just for the kernel to do this all",
    "start": "1787279",
    "end": "1789440"
  },
  {
    "text": "this complex networking stuff you know",
    "start": "1789440",
    "end": "1792159"
  },
  {
    "text": "especially if you have like a beefy CPU",
    "start": "1792159",
    "end": "1795760"
  }
]