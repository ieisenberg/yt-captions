[
  {
    "start": "0",
    "end": "60000"
  },
  {
    "text": "in this episode of the backend engineering show i'd like to talk about the log 4j vulnerability the remote code",
    "start": "80",
    "end": "6799"
  },
  {
    "text": "execution so we'll we'll discuss what is lock4j we'll discuss how exactly this",
    "start": "6799",
    "end": "14080"
  },
  {
    "text": "vulnerability actually works and how dangerous it is yeah we throw words like remote code execution for every",
    "start": "14080",
    "end": "20560"
  },
  {
    "text": "vulnerability but but how the question is the how here and finally i'll talk about how",
    "start": "20560",
    "end": "27920"
  },
  {
    "text": "really just adding features on your software or your back and",
    "start": "27920",
    "end": "34880"
  },
  {
    "text": "really you need to think twice about every feature you add and what is the ramification",
    "start": "34880",
    "end": "41200"
  },
  {
    "text": "of such feature how about we jump into it welcome to the back engineering show with your host",
    "start": "41200",
    "end": "47520"
  },
  {
    "text": "jose nasser and yes we are back baby we are back i'm back in town here and uh i know",
    "start": "47520",
    "end": "55199"
  },
  {
    "text": "i'm a little late to the game talking about look 4j because there are like thousands and thousands of articles and",
    "start": "55199",
    "end": "60239"
  },
  {
    "start": "60000",
    "end": "330000"
  },
  {
    "text": "videos already about the topic but uh doesn't hurt because i'm really fascinated about this",
    "start": "60239",
    "end": "68880"
  },
  {
    "text": "bug slash vulnerability and it's so funny because look 4j was literally",
    "start": "69200",
    "end": "75759"
  },
  {
    "text": "been there for 20 20 years i first heard about look for jail was maybe 12 000 six",
    "start": "75759",
    "end": "82880"
  },
  {
    "text": "two thousand i don't know why that sounds japanese or 2 000.6 so this thing",
    "start": "82880",
    "end": "88159"
  },
  {
    "text": "2006 that's the first time i heard about that and there was a consultant that came to our",
    "start": "88159",
    "end": "93759"
  },
  {
    "text": "work and uh i was i was writing a software and i wrote my own logging",
    "start": "93759",
    "end": "99360"
  },
  {
    "text": "facility yeah playing some some sort of a plugin that logs everything that have",
    "start": "99360",
    "end": "105200"
  },
  {
    "text": "that happens on my application and he said no don't do that don't don't roll on your own stuff use this thing that's",
    "start": "105200",
    "end": "111360"
  },
  {
    "text": "called log4j and it's it has a lot of features it i was like thinking really we need a",
    "start": "111360",
    "end": "117119"
  },
  {
    "text": "software to log how hard is it to log right just write it to a disk right well",
    "start": "117119",
    "end": "122159"
  },
  {
    "text": "the more you think about it is just you need to search the logs you need to you know organize the logs like you need to",
    "start": "122159",
    "end": "128560"
  },
  {
    "text": "you need you need to specify what are you logging where",
    "start": "128560",
    "end": "134000"
  },
  {
    "text": "are you logging it right like do you want it to write log in a database do you want to log in on",
    "start": "134000",
    "end": "141680"
  },
  {
    "text": "system and then if this is a file system what if you have multiple logs multiple applications running multiple servers",
    "start": "141680",
    "end": "148319"
  },
  {
    "text": "how do you aggregate those logs and if it becomes complicated the more you think about it right",
    "start": "148319",
    "end": "155519"
  },
  {
    "text": "most users if you're like your own thing if you're doing your own thing you don't really need it but",
    "start": "155519",
    "end": "160879"
  },
  {
    "text": "if you're building an enterprise system or big software you need some sort of a",
    "start": "160879",
    "end": "167599"
  },
  {
    "text": "advanced logging solution and log4j was the you know the de facto one for",
    "start": "167599",
    "end": "174239"
  },
  {
    "text": "anything logging really so so yeah log4j",
    "start": "174239",
    "end": "180800"
  },
  {
    "text": "very popular yet this wasn't as mainstream as it happened like two weeks ago whatever",
    "start": "180800",
    "end": "187280"
  },
  {
    "text": "when we heard about it literally everybody's talking about look for jada so what happened",
    "start": "187280",
    "end": "194159"
  },
  {
    "text": "so i look forward when you",
    "start": "194159",
    "end": "199200"
  },
  {
    "text": "when you build a back end like let's take a web",
    "start": "199200",
    "end": "204319"
  },
  {
    "text": "server and web app that is running on the back end and you want to log like failed attempts",
    "start": "204319",
    "end": "213200"
  },
  {
    "text": "right or uh users who want to log in and like failed",
    "start": "213200",
    "end": "219120"
  },
  {
    "text": "or someone tried to ddos you and you want to log these incidents or some sort of errors and you want to log them you",
    "start": "219120",
    "end": "226080"
  },
  {
    "text": "basically use log4j to log these facilities are you on the back end",
    "start": "226080",
    "end": "231200"
  },
  {
    "text": "let's say i want to log every failed attempt right to login",
    "start": "231200",
    "end": "236480"
  },
  {
    "text": "and i don't want to look the password that is used but i'm going to unlock the username so hey this username tried to",
    "start": "236480",
    "end": "241840"
  },
  {
    "text": "log in from this ip address right so how how does how how would you do that",
    "start": "241840",
    "end": "247840"
  },
  {
    "text": "you the listener or if you're watching this on youtube or listening to the podcast how would you actually do it",
    "start": "247840",
    "end": "253599"
  },
  {
    "text": "right well i need to know the email that tries to",
    "start": "253599",
    "end": "259440"
  },
  {
    "text": "log in or the account id that's easy because that's just another parameter in the post request right",
    "start": "259440",
    "end": "265919"
  },
  {
    "text": "how would you know for example where this guy is coming from or which browser",
    "start": "265919",
    "end": "272639"
  },
  {
    "text": "they used well there is a nice header called user agent right you can read that user agent",
    "start": "272639",
    "end": "278240"
  },
  {
    "text": "and then read the body which has the account id and then say hey this account id",
    "start": "278240",
    "end": "285600"
  },
  {
    "text": "blah the variable name try to log in from blah use that agent",
    "start": "285600",
    "end": "292479"
  },
  {
    "text": "you know just normal programming stuff and you write it so you blindly take what the user sent",
    "start": "292479",
    "end": "301919"
  },
  {
    "text": "and then you send it to log4j and says hey log this so log4j",
    "start": "301919",
    "end": "306960"
  },
  {
    "text": "sees this as just another string but this string has been sent by the user",
    "start": "306960",
    "end": "312720"
  },
  {
    "text": "and here is where the attack surface happens this is a very common thing that's very",
    "start": "312720",
    "end": "319680"
  },
  {
    "text": "similar to sql injection really you really need to sanitize the input before sending it",
    "start": "319680",
    "end": "328400"
  },
  {
    "text": "all right so this is what we'll look for jso this is what it's doing and then this is how",
    "start": "328400",
    "end": "333919"
  },
  {
    "start": "330000",
    "end": "660000"
  },
  {
    "text": "basically the attack can start so in specific version of log4j",
    "start": "333919",
    "end": "340560"
  },
  {
    "text": "they introduced i believe a log for j 2.0 and the beta version",
    "start": "340560",
    "end": "345680"
  },
  {
    "text": "right they introduced the ability to kind of enrich the logging experience",
    "start": "345680",
    "end": "351840"
  },
  {
    "text": "you know yeah these guys have started to log in right but they have the account id but",
    "start": "351840",
    "end": "358560"
  },
  {
    "text": "you want to log more information right in the log and you won't log for j to do it for you here's the id",
    "start": "358560",
    "end": "365600"
  },
  {
    "text": "but go and look up what the name of the account is for example and also print it so yeah",
    "start": "365600",
    "end": "372160"
  },
  {
    "text": "i would say hey account id blog take the same thing that the user submit and then you say okay",
    "start": "372160",
    "end": "378880"
  },
  {
    "text": "between pattern faces this is the account name and how do you get the account name because the user didn't send it to you well you can lock it up",
    "start": "378880",
    "end": "385759"
  },
  {
    "text": "right look 4j can look up the account id and there are so many look up",
    "start": "385759",
    "end": "392000"
  },
  {
    "text": "mechanisms and extensions in look 4g this was introduced with an interface in java called jndi the java naming and",
    "start": "392000",
    "end": "400479"
  },
  {
    "text": "directory interface so it's an interface that you can use to look up multiple",
    "start": "400479",
    "end": "407360"
  },
  {
    "text": "things so there was a jndi plugin or a component to look up ldap",
    "start": "407360",
    "end": "413840"
  },
  {
    "text": "information you know the x the lightweight directory protocol access protocol right",
    "start": "413840",
    "end": "421680"
  },
  {
    "text": "which is the implementation in windows called active directory right off the ldap where you can look up certain",
    "start": "421680",
    "end": "427919"
  },
  {
    "text": "information profile about the user itself like the full name stuff like",
    "start": "427919",
    "end": "433199"
  },
  {
    "text": "that right and you can print it or or just print it in the log right",
    "start": "433199",
    "end": "438240"
  },
  {
    "text": "so there's a specific uri that you can craft",
    "start": "438240",
    "end": "443520"
  },
  {
    "text": "and this is a legit thing you can do it in in look 4j right so you the programmer can add that on",
    "start": "443520",
    "end": "451840"
  },
  {
    "text": "the back end and then say okay so at the end of the day say okay account id 17 tries to log in",
    "start": "451840",
    "end": "459280"
  },
  {
    "text": "parentheses who's saying nozzle that's the account name right so you know and instead so if you're new when you query",
    "start": "459280",
    "end": "465199"
  },
  {
    "text": "the logs you can see actually more information in written information so that was that was a feature that was",
    "start": "465199",
    "end": "471440"
  },
  {
    "text": "added seems nice right but here's what happened",
    "start": "471440",
    "end": "477680"
  },
  {
    "text": "what if that crafted url was actually",
    "start": "477680",
    "end": "483120"
  },
  {
    "text": "right sent by the user right",
    "start": "483120",
    "end": "488639"
  },
  {
    "text": "so instead of me writing the actual account id as a failed attempt i'll write this specially crafted url right",
    "start": "488639",
    "end": "496879"
  },
  {
    "text": "i'll put in the screen right now it's jdi whatever slash ldap blah blah blah",
    "start": "496879",
    "end": "503759"
  },
  {
    "text": "then you put obviously the the server name where the ldap directory exists right",
    "start": "503759",
    "end": "509360"
  },
  {
    "text": "right and then you specify some sort of an object to retrieve there so yeah so",
    "start": "509360",
    "end": "516080"
  },
  {
    "text": "that's how you do a lookup so the specially crafted url will have jndi and then we'll have",
    "start": "516080",
    "end": "521839"
  },
  {
    "text": "the actual protocol which is ldap and then we'll have a url right the actual",
    "start": "521839",
    "end": "527200"
  },
  {
    "text": "domain name right where the ldap lives the server and then",
    "start": "527200",
    "end": "532880"
  },
  {
    "text": "slash some sort of an object like what what do you want to retrieve there okay",
    "start": "532880",
    "end": "538720"
  },
  {
    "text": "and look 4j will query that uh",
    "start": "538720",
    "end": "544080"
  },
  {
    "text": "first of all it will resolve dns if that has a dns and then so the back end is a result",
    "start": "544080",
    "end": "549600"
  },
  {
    "text": "looking at a dns so keep that in mind the backend look for j is resolving the",
    "start": "549600",
    "end": "555920"
  },
  {
    "text": "dns to an iep address so it's sending a dns request to get that the ip address",
    "start": "555920",
    "end": "562800"
  },
  {
    "text": "and then establish a tcp connection on a specific port whatever that part is and then we'll then send the specific",
    "start": "562800",
    "end": "570320"
  },
  {
    "text": "command of the protocol the ldap protocol and then start communicating with the server",
    "start": "570320",
    "end": "575680"
  },
  {
    "text": "sounds okay until the",
    "start": "575680",
    "end": "580880"
  },
  {
    "text": "user actually start sending this specially crafted uri from",
    "start": "580880",
    "end": "588800"
  },
  {
    "text": "the interface itself well how the user can just type in instead of the",
    "start": "588800",
    "end": "594399"
  },
  {
    "text": "account id or the email they just type in the special craft say okay jndi blah",
    "start": "594399",
    "end": "599519"
  },
  {
    "text": "blah blah and then the attacker website right the under the attacker domain",
    "start": "599519",
    "end": "604800"
  },
  {
    "text": "which has the ldap directory and then slash the object right and then",
    "start": "604800",
    "end": "610880"
  },
  {
    "text": "you send it if you as a developer took that account id",
    "start": "610880",
    "end": "616480"
  },
  {
    "text": "as is and you say hey just log that forget about anything right",
    "start": "616480",
    "end": "622000"
  },
  {
    "text": "log4j will look at this oh that's a lookup let me do a lookup it will blindly take a lookup right",
    "start": "622000",
    "end": "630399"
  },
  {
    "text": "it will blindly take that string resolve the dns because it's that now it's the attacker upside right result",
    "start": "630399",
    "end": "637760"
  },
  {
    "text": "that yes get the ipad establish a tcp connection to the attacker server",
    "start": "637760",
    "end": "643839"
  },
  {
    "text": "so far so far it's it's dangerous right but there is no remote code execution",
    "start": "643839",
    "end": "649920"
  },
  {
    "text": "yet let's think about it let's just be very clear about this so log4j you're",
    "start": "649920",
    "end": "655519"
  },
  {
    "text": "back in just connected to a malicious server that is dangerous because the",
    "start": "655519",
    "end": "661760"
  },
  {
    "start": "660000",
    "end": "1020000"
  },
  {
    "text": "attack if the attacker has control of the dns the resolution of the dns right",
    "start": "661760",
    "end": "669120"
  },
  {
    "text": "itself is dangerous why just just take that alone",
    "start": "669120",
    "end": "675920"
  },
  {
    "text": "so if we've seen such attacks like this before where using domain name resolution as a",
    "start": "675920",
    "end": "683279"
  },
  {
    "text": "vehicle to transmit information from the victim's machine we've seen",
    "start": "683279",
    "end": "689519"
  },
  {
    "text": "this with apple i think someone i'll link up the video i don't remember but someone",
    "start": "689519",
    "end": "695600"
  },
  {
    "text": "managed to craft some sort of a",
    "start": "695600",
    "end": "702399"
  },
  {
    "text": "code that eventually run on one of apple's machines internal machines like the engineering i",
    "start": "702399",
    "end": "709600"
  },
  {
    "text": "think department and then from there",
    "start": "709600",
    "end": "714639"
  },
  {
    "text": "yeah it was an npm package i think i think it was an npm package right and then",
    "start": "714639",
    "end": "720880"
  },
  {
    "text": "usually you know every apple have all sorts of firewalls but nobody really",
    "start": "721360",
    "end": "726560"
  },
  {
    "text": "controlled dns so far gns are usually you know benign but what he did is like",
    "start": "726560",
    "end": "732240"
  },
  {
    "text": "he took the machine name of the actual user that is running uh",
    "start": "732240",
    "end": "737839"
  },
  {
    "text": "the victim the machine name and then hashed it in a way",
    "start": "737839",
    "end": "744880"
  },
  {
    "text": "he created a base64 not a hash this secret to base64 and added it as a as a",
    "start": "745040",
    "end": "750160"
  },
  {
    "text": "sub domain to his domain right so it will take blah blah blah engineering machine one apple",
    "start": "750160",
    "end": "757440"
  },
  {
    "text": "dot so and then when the npm or the machine tries to",
    "start": "757440",
    "end": "764880"
  },
  {
    "text": "resolve the dns it will basically hey ask the dns servers like ask",
    "start": "764880",
    "end": "771200"
  },
  {
    "text": "the the main director hey resolve this dns for me blah blah blah blah dot",
    "start": "771200",
    "end": "776880"
  },
  {
    "text": "attacker.com so to it it's just another domain that we need dns that we need to basically resolve so we'll just",
    "start": "776880",
    "end": "783440"
  },
  {
    "text": "basically go through the dns protocol you know says okay who owns uh blah blah",
    "start": "783440",
    "end": "788480"
  },
  {
    "text": "blah.attacker.com oh this is the top level domain it's dot com then attacker.com who owns",
    "start": "788480",
    "end": "794800"
  },
  {
    "text": "attacker.com it's the attacker's dns server so the attacker just got a",
    "start": "794800",
    "end": "801040"
  },
  {
    "text": "beautiful string that has the subdomain which has the string",
    "start": "801040",
    "end": "806720"
  },
  {
    "text": "which is basically the uh useful information about the victim dot attacker.com so they will throw the",
    "start": "806720",
    "end": "813360"
  },
  {
    "text": "docker.com but they take this precious subdomain of course they're not going to resolve the ip because there is",
    "start": "813360",
    "end": "819680"
  },
  {
    "text": "no ip as well maybe they'll just resolve it to some random ip address right or just they will resolve always resolve it",
    "start": "819680",
    "end": "826959"
  },
  {
    "text": "to the same ipos of the attacker because they have full control over the dns it's software guys",
    "start": "826959",
    "end": "833040"
  },
  {
    "text": "it's just software so now back to the four lock 4g just forget about ldap and all the lockup you",
    "start": "833040",
    "end": "839839"
  },
  {
    "text": "just right allowed your back end",
    "start": "839839",
    "end": "845600"
  },
  {
    "text": "to resolve dns that the user specified which can be an attacker so what's",
    "start": "845600",
    "end": "851760"
  },
  {
    "text": "what's wrong with that here's what you can do environment variables have you guys",
    "start": "851760",
    "end": "856800"
  },
  {
    "text": "heard about it if i as an attacker right back to the failed login attempt",
    "start": "856800",
    "end": "864000"
  },
  {
    "text": "right go to the account id and then name yourself for example",
    "start": "864000",
    "end": "870560"
  },
  {
    "text": "dollar sign path dot attacker dot com and then put it in",
    "start": "870560",
    "end": "875600"
  },
  {
    "text": "this ldap thing right crafted a string and then send it so the login will fail obviously and as a result you want to",
    "start": "875600",
    "end": "882079"
  },
  {
    "text": "log that activity so you'll take the account id which happens to be jndi slash latch",
    "start": "882079",
    "end": "887760"
  },
  {
    "text": "ldap blah blah and then dollar sign path.attacker.com",
    "start": "887760",
    "end": "893360"
  },
  {
    "text": "and then send it over and you just take that string and then log it look 4j will says",
    "start": "893360",
    "end": "900560"
  },
  {
    "text": "wait a minute that's actually a lookup let me actually try to retrieve the ldap version",
    "start": "900560",
    "end": "907680"
  },
  {
    "text": "of the the lookup value of this string that we just sent right because we're",
    "start": "907680",
    "end": "912959"
  },
  {
    "text": "pulling some information here well oh what's this uh dollar signpath.attacker.com oh i don't know",
    "start": "912959",
    "end": "919279"
  },
  {
    "text": "this is a dns i need to resolve it but before that the assignment path is actually an environment variable on the back end",
    "start": "919279",
    "end": "926639"
  },
  {
    "text": "so it says look for joe say oh you want to oh you want me to just paste the path directory the environment variable and",
    "start": "926639",
    "end": "933040"
  },
  {
    "text": "this oh let me do that job for you so the backend log 4g will take the path",
    "start": "933040",
    "end": "939279"
  },
  {
    "text": "all the beautiful paths that you have one environment variable at least right and then",
    "start": "939279",
    "end": "945839"
  },
  {
    "text": "write it right to this entry right dot attacker.com so this",
    "start": "945839",
    "end": "953199"
  },
  {
    "text": "beautiful sub domain right you might get some errors because of like some and invalid characters or",
    "start": "953199",
    "end": "959440"
  },
  {
    "text": "so like so attackers can do all sorts of things to you know base64 to what now",
    "start": "959440",
    "end": "964480"
  },
  {
    "text": "right and then resolve that and when you resolve it that beautiful string will end up in the",
    "start": "964480",
    "end": "971680"
  },
  {
    "text": "dns uh controlled attacker domain",
    "start": "971680",
    "end": "977440"
  },
  {
    "text": "scary stuff just again this is a way to leak information from the back into the attacker now just",
    "start": "977600",
    "end": "983759"
  },
  {
    "text": "do that dollar sign jwt token dollar signed jwt secret",
    "start": "983759",
    "end": "990720"
  },
  {
    "text": "any possible enviro variable you can just send it along right",
    "start": "990720",
    "end": "996959"
  },
  {
    "text": "so we still don't have a remote code execution this is just leaking information out",
    "start": "996959",
    "end": "1003440"
  },
  {
    "text": "right with just dns resolution right if that is even before we",
    "start": "1003440",
    "end": "1009279"
  },
  {
    "text": "establish a tcp connection to the attacker's website after the fact that",
    "start": "1009279",
    "end": "1014639"
  },
  {
    "text": "you got the ipads scary stuff man scary stuff let's take a",
    "start": "1014639",
    "end": "1020240"
  },
  {
    "start": "1020000",
    "end": "1380000"
  },
  {
    "text": "sip of coffee so how does this remote could execute because what we read online is that oh remote code",
    "start": "1020240",
    "end": "1026720"
  },
  {
    "text": "execution remote code execution so it's like someone's like installing stuff on the back and someone's i i read that",
    "start": "1026720",
    "end": "1033839"
  },
  {
    "text": "someone has actually installed will manage to install a bitcoin miner i think it was a coin mine i don't know if",
    "start": "1033839",
    "end": "1039760"
  },
  {
    "text": "it's bitcoin miner it's just one of those miners right and they managed to install it on the back end",
    "start": "1039760",
    "end": "1045678"
  },
  {
    "text": "and that mines the stuff or the attacker nice at ease but how",
    "start": "1045679",
    "end": "1053039"
  },
  {
    "text": "from what we read here is just okay that let's read through this all right even",
    "start": "1053039",
    "end": "1058559"
  },
  {
    "text": "if the lookup that happens here in the string managed to",
    "start": "1058559",
    "end": "1063760"
  },
  {
    "text": "uh [Music] go to the attackers website and retrieve some sort of a payload that is malicious",
    "start": "1063760",
    "end": "1071280"
  },
  {
    "text": "even let's say it's code right you retrieve code and you then one log4j will just print the code",
    "start": "1071280",
    "end": "1079679"
  },
  {
    "text": "right will log it that doesn't execute code right",
    "start": "1079679",
    "end": "1084960"
  },
  {
    "text": "if you if you if you just i don't know if it's java code even if it's java code just down download that java code and it will",
    "start": "1084960",
    "end": "1092000"
  },
  {
    "text": "be just printed so the log will have the code but it will not be executed so i was like how does it actually execute",
    "start": "1092000",
    "end": "1099440"
  },
  {
    "text": "look for just shouldn't execute just code because it's code needs to be compiled and stuff like that",
    "start": "1099440",
    "end": "1105200"
  },
  {
    "text": "so i did a lot of research and i finally found a video by sans institute they did a good job at explaining how exactly",
    "start": "1105200",
    "end": "1112240"
  },
  {
    "text": "this works and it's another thing that is fascinating",
    "start": "1112240",
    "end": "1119760"
  },
  {
    "text": "it comes back to something i also used back in the day the the days of soap",
    "start": "1120320",
    "end": "1126080"
  },
  {
    "text": "right which is called a serializing an object and desegregating objects so if you have a vb.net or c-sharp",
    "start": "1126080",
    "end": "1133919"
  },
  {
    "text": "actual object that is you're running on your code right a class that you institute an object out of it that",
    "start": "1133919",
    "end": "1141200"
  },
  {
    "text": "object is just in memory right right java this works the same way you have an object that is instantiated this",
    "start": "1141200",
    "end": "1147520"
  },
  {
    "text": "object has properties methods functions you know has code in it right",
    "start": "1147520",
    "end": "1154080"
  },
  {
    "text": "constructor all that stuff you can convert that object and store all its",
    "start": "1154080",
    "end": "1160480"
  },
  {
    "text": "state right with all its state the properties and the values you can",
    "start": "1160480",
    "end": "1166320"
  },
  {
    "text": "convert that into a string you can serialize that right just like we do in",
    "start": "1166320",
    "end": "1172080"
  },
  {
    "text": "serializing json for example you serialize that into just a string a beautiful string right and when you take",
    "start": "1172080",
    "end": "1179039"
  },
  {
    "text": "that string right you can send that string across the network and on the",
    "start": "1179039",
    "end": "1184080"
  },
  {
    "text": "other end you can deserialize that string back to an object on another end",
    "start": "1184080",
    "end": "1190720"
  },
  {
    "text": "that's very similar to how soap works right when you start to send objects you",
    "start": "1190720",
    "end": "1196640"
  },
  {
    "text": "serialize the object and then you de-series on the other end and you just now",
    "start": "1196640",
    "end": "1202400"
  },
  {
    "text": "transferred the object to another server",
    "start": "1202400",
    "end": "1207440"
  },
  {
    "text": "that is the key here to the ldap jndi",
    "start": "1207440",
    "end": "1213360"
  },
  {
    "text": "uh remote code execution so the attacker here what he does",
    "start": "1213360",
    "end": "1220480"
  },
  {
    "text": "right they craft the",
    "start": "1220480",
    "end": "1225840"
  },
  {
    "text": "ldap object you know the ldap url such that it retrieves",
    "start": "1225840",
    "end": "1232720"
  },
  {
    "text": "some sort of a string but this string is a special string right when you",
    "start": "1232720",
    "end": "1239280"
  },
  {
    "text": "retrieve when when the log 4g retrieves that special string it will detect that is actually",
    "start": "1239280",
    "end": "1245760"
  },
  {
    "text": "not just a string it's a serialized object and here's the problem",
    "start": "1245760",
    "end": "1250960"
  },
  {
    "text": "look for jay will try to be smart and says wait a second this is a serialized object let me deserialize that object",
    "start": "1250960",
    "end": "1259120"
  },
  {
    "text": "back to a beautiful object so it will take that benign string",
    "start": "1259120",
    "end": "1266960"
  },
  {
    "text": "that's the problem that was that was the question that i had how is this just a normal code or just a string",
    "start": "1266960",
    "end": "1272799"
  },
  {
    "text": "end up in memory executing that's luck 4g what's doing was it there",
    "start": "1272799",
    "end": "1279600"
  },
  {
    "text": "some people wanted to dehydrate this object some people who wanted to deserialize these things so",
    "start": "1279600",
    "end": "1285600"
  },
  {
    "text": "they they will deserialize that and they put it in memory",
    "start": "1285600",
    "end": "1291360"
  },
  {
    "text": "and when you deserialize it i'm pretty sure the constructor is being called again i'm pretty sure",
    "start": "1291360",
    "end": "1297760"
  },
  {
    "text": "or a method will be called and you as an attacker could have control of all this method and when when",
    "start": "1297760",
    "end": "1304720"
  },
  {
    "text": "the d serializer calls this method put your code there",
    "start": "1304720",
    "end": "1310320"
  },
  {
    "text": "and it's the end of the word you can just now you now you just",
    "start": "1310320",
    "end": "1316240"
  },
  {
    "text": "force look 4j to execute code that you have put right so what happens",
    "start": "1316240",
    "end": "1321919"
  },
  {
    "text": "here they will become a deserialized object that has methods it will have uh",
    "start": "1321919",
    "end": "1327760"
  },
  {
    "text": "properties and it will have functions that functions have code and this code can do anything you want",
    "start": "1327760",
    "end": "1334720"
  },
  {
    "text": "literally anything mine delete stuff if you have permission level log forward you have permission it",
    "start": "1335120",
    "end": "1341360"
  },
  {
    "text": "will have basically full rain you can do anything scary stuff guys very very scary stuff",
    "start": "1341360",
    "end": "1350480"
  },
  {
    "text": "but the moment i read about this",
    "start": "1350480",
    "end": "1355520"
  },
  {
    "text": "uh vulnerabilities the first thing that came to mind was like why",
    "start": "1355520",
    "end": "1360960"
  },
  {
    "text": "is the back end even connected to the internet",
    "start": "1360960",
    "end": "1366320"
  },
  {
    "text": "right because remember back ends shouldn't have no business connected to the internet it should be",
    "start": "1366320",
    "end": "1371360"
  },
  {
    "text": "isolated right deep down you know your infrastructure and just just",
    "start": "1371360",
    "end": "1377679"
  },
  {
    "text": "isolate it the only thing that is connected to it is basically the api gateway reverse proxy or load balancer",
    "start": "1377679",
    "end": "1384720"
  },
  {
    "start": "1380000",
    "end": "1860000"
  },
  {
    "text": "and that is basically even that shouldn't be connected to the internet to be honest there will be there will be",
    "start": "1384720",
    "end": "1390960"
  },
  {
    "text": "another interface network interface which then connects to that other clients which can connect to that",
    "start": "1390960",
    "end": "1396799"
  },
  {
    "text": "right right eve but but that but that's not always",
    "start": "1396799",
    "end": "1403280"
  },
  {
    "text": "you know possible you know back ends need unfortunately to connect to the",
    "start": "1403280",
    "end": "1408320"
  },
  {
    "text": "internet you might say i'm saying why well we've made a lot of videos about this stuff right",
    "start": "1408320",
    "end": "1414720"
  },
  {
    "text": "you know back-ends or need to be secured with tls certificates",
    "start": "1414720",
    "end": "1420559"
  },
  {
    "text": "right and those tls certificates you know with the problem with tls",
    "start": "1420559",
    "end": "1426000"
  },
  {
    "text": "certificates or this is not this is not unfortunately this is not written in stone you know nothing is perfect in the world of",
    "start": "1426000",
    "end": "1432400"
  },
  {
    "text": "engineering that's what i found i started to find as the more i dive deep the more i",
    "start": "1432400",
    "end": "1437840"
  },
  {
    "text": "i realized that whatever we're doing is is not it's not perfect you know",
    "start": "1437840",
    "end": "1443520"
  },
  {
    "text": "when you start learning things now this is just another advice i i know i'm going all over the place all right",
    "start": "1443520",
    "end": "1451200"
  },
  {
    "text": "you when you start learning back in general or engineering in general you it's like",
    "start": "1451279",
    "end": "1456320"
  },
  {
    "text": "a mountain that you have oh how do i learn all this stuff and becomes overwhelming and you become",
    "start": "1456320",
    "end": "1463039"
  },
  {
    "text": "like an obligation to learn how things is done",
    "start": "1463039",
    "end": "1468080"
  },
  {
    "text": "but the moment you get deep into things you know that all this stuff is built by human and human make mistakes and",
    "start": "1468080",
    "end": "1474400"
  },
  {
    "text": "everything here have flaws and we've seen this here we",
    "start": "1474400",
    "end": "1479440"
  },
  {
    "text": "take this like an in a pedestrian in a way that these things these guys don't make mistakes like everybody makes",
    "start": "1479440",
    "end": "1485840"
  },
  {
    "text": "mistakes whatever you when you come to a domain right you don't know anything about",
    "start": "1485840",
    "end": "1491279"
  },
  {
    "text": "always doubt everything why is things doing why is this done this way oh the moment",
    "start": "1491279",
    "end": "1499039"
  },
  {
    "text": "someone says oh it's always been done this way because that's the best practice or that's the only best way",
    "start": "1499039",
    "end": "1506320"
  },
  {
    "text": "something fishy is going on that you're questioning your doubts are always in the right place when you doubt",
    "start": "1506320",
    "end": "1512480"
  },
  {
    "text": "something that means something is it's probably something uh",
    "start": "1512480",
    "end": "1518320"
  },
  {
    "text": "legit you know and just a keep doubting that's what um so i say all right",
    "start": "1518320",
    "end": "1524240"
  },
  {
    "text": "so back the certificate thing so the certificates you know the way of authenticating servers",
    "start": "1524240",
    "end": "1530320"
  },
  {
    "text": "right unfortunately we didn't find a solution to this yet right it's like if i have a certificate how do",
    "start": "1530320",
    "end": "1537520"
  },
  {
    "text": "i know that this certificate is valid well you might say you're saying it has an expiration date right",
    "start": "1537520",
    "end": "1544799"
  },
  {
    "text": "right but it has an expiration date right",
    "start": "1544799",
    "end": "1550000"
  },
  {
    "text": "which which is baked into the certificate but there's another problem certificates ha are",
    "start": "1550080",
    "end": "1557919"
  },
  {
    "text": "you know or hashed or what's the right word for this are encrypted with the private key of",
    "start": "1557919",
    "end": "1564720"
  },
  {
    "text": "the server right it's assigned that's the right one signed by the private key",
    "start": "1564720",
    "end": "1570080"
  },
  {
    "text": "and if that private key is leaked we've seen many incidents where the private key was",
    "start": "1570080",
    "end": "1575440"
  },
  {
    "text": "leaked right then this certificate is useless",
    "start": "1575440",
    "end": "1582159"
  },
  {
    "text": "because whoever had this private key can recreate that certificate and prove to be",
    "start": "1582159",
    "end": "1588000"
  },
  {
    "text": "themselves basically you know impersonate impersonate the server bad so they",
    "start": "1588000",
    "end": "1594480"
  },
  {
    "text": "invented this thing that's called the long story short online",
    "start": "1594480",
    "end": "1599520"
  },
  {
    "text": "certificate status protocol i want to know if this certificate yeah i know it's not expired but i want to know if",
    "start": "1599520",
    "end": "1604880"
  },
  {
    "text": "it's revoked is this still valid is this thing legit can i use it can i trust it so",
    "start": "1604880",
    "end": "1612880"
  },
  {
    "text": "long story short i made a whole video about certificates check this video out but",
    "start": "1612880",
    "end": "1619360"
  },
  {
    "text": "the fact to tell the client that this certificate is not",
    "start": "1619360",
    "end": "1624720"
  },
  {
    "text": "revoked require a call to a revocation",
    "start": "1624720",
    "end": "1630799"
  },
  {
    "text": "server right an online certificate status protocol an online certificate",
    "start": "1630799",
    "end": "1636240"
  },
  {
    "text": "status protocol server that lives on the internet so the back end",
    "start": "1636240",
    "end": "1641360"
  },
  {
    "text": "end up calling the internet to",
    "start": "1641360",
    "end": "1647600"
  },
  {
    "text": "staple this certificate with a certificate another certificate that says hey",
    "start": "1647600",
    "end": "1652720"
  },
  {
    "text": "yeah i know it's not expired but also it's not revoked yet it's good you can you can fully trust it so that if you have ocsp",
    "start": "1652720",
    "end": "1660080"
  },
  {
    "text": "stapling then your inter your back and should connect to the internet right now even with that",
    "start": "1660080",
    "end": "1667039"
  },
  {
    "text": "you should really just uh allow certain domains right you",
    "start": "1667039",
    "end": "1672559"
  },
  {
    "text": "should never have full rent on the back end to connect to any domain just specific domains like okay i'm gonna",
    "start": "1672559",
    "end": "1679279"
  },
  {
    "text": "allow the ocsp stapling uh server i'm gonna allow",
    "start": "1679279",
    "end": "1685279"
  },
  {
    "text": "whatever uh this back-end and this back-end i might need to connect to this particular api gateway for amazon i mean",
    "start": "1685279",
    "end": "1692960"
  },
  {
    "text": "with the internet unfortunately everything on the cloud if you have a lot of you know",
    "start": "1692960",
    "end": "1698559"
  },
  {
    "text": "uh you're connected to a lot of services you find yourself needing to enable",
    "start": "1698559",
    "end": "1704159"
  },
  {
    "text": "internet on the back end try to minimize that as much as possible to have secure because",
    "start": "1704159",
    "end": "1711840"
  },
  {
    "text": "99 of the time if you don't have like internet on the back end then yeah",
    "start": "1711840",
    "end": "1717520"
  },
  {
    "text": "the the back end look 4j will never phone the attack at home and you will never have this problem through dns",
    "start": "1717520",
    "end": "1724480"
  },
  {
    "text": "you really need to also stop dns and i'm not sure how you do that like right how do you stop dns resolutions",
    "start": "1724480",
    "end": "1732320"
  },
  {
    "text": "it's just i guess you can you can have your own dns resolution name server and",
    "start": "1732320",
    "end": "1737679"
  },
  {
    "text": "then only allow certain name resolutions but that would be difficult",
    "start": "1737679",
    "end": "1743600"
  },
  {
    "text": "so i suggest that you um i'm going to link the video in the description the sans institute they go into more way",
    "start": "1743600",
    "end": "1749360"
  },
  {
    "text": "more details on about this right but effectively they also have another",
    "start": "1749360",
    "end": "1755120"
  },
  {
    "text": "attack they go up also about the remediation like wow what do you do to protect this i update to this particular",
    "start": "1755120",
    "end": "1760559"
  },
  {
    "text": "version of log4j if you are using it right and then all sorts of things right",
    "start": "1760559",
    "end": "1766240"
  },
  {
    "text": "so yeah they also explain an attack surface where you can",
    "start": "1766240",
    "end": "1771679"
  },
  {
    "text": "even even if you don't have an internet action even if you don't have an internet access on your back end",
    "start": "1771679",
    "end": "1779120"
  },
  {
    "text": "uh they also find a way to you know exploit that right",
    "start": "1779120",
    "end": "1786080"
  },
  {
    "text": "which i'm not i'm not sure how to be honest maybe the client sends a actual serialized object that just gets",
    "start": "1786080",
    "end": "1792640"
  },
  {
    "text": "executed immediately maybe i don't know but yeah that's basically the look for j",
    "start": "1792640",
    "end": "1798880"
  },
  {
    "text": "attack very dangerous stuff teaches you that they're adding features",
    "start": "1798880",
    "end": "1804559"
  },
  {
    "text": "especially in a very popular software that is maintained by an open source volunteers you know",
    "start": "1804559",
    "end": "1810640"
  },
  {
    "text": "it's just uh just fascinating how how the entire world is depending on an open",
    "start": "1810640",
    "end": "1816559"
  },
  {
    "text": "source project and you see it because now there is a problem with the software",
    "start": "1816559",
    "end": "1821760"
  },
  {
    "text": "now everybody's screaming apple relies on it minecraft relies on it amazon relies on",
    "start": "1821760",
    "end": "1827840"
  },
  {
    "text": "it most the software relies on on logging facility because that nobody's going to write their own logging right",
    "start": "1827840",
    "end": "1833120"
  },
  {
    "text": "if you want they're going to use an open source one and this one has been there for 20 years 21 years maybe more",
    "start": "1833120",
    "end": "1839279"
  },
  {
    "text": "so it's legit but when things go wrong",
    "start": "1839279",
    "end": "1844480"
  },
  {
    "text": "boy you know the war just sets on flame",
    "start": "1844480",
    "end": "1850880"
  },
  {
    "text": "yeah there's a lot of a lot there are a lot of incidents where people actually using this um",
    "start": "1850880",
    "end": "1857519"
  },
  {
    "text": "this attack right specifically in scanning and you might",
    "start": "1857519",
    "end": "1862559"
  },
  {
    "start": "1860000",
    "end": "2094000"
  },
  {
    "text": "say how do you scan how do you scan something like that right",
    "start": "1862559",
    "end": "1868880"
  },
  {
    "text": "when you scan you basically scanning is is not hard because think",
    "start": "1868880",
    "end": "1874399"
  },
  {
    "text": "about it like what do you what you try to guess what would the back end",
    "start": "1874399",
    "end": "1879600"
  },
  {
    "text": "log right the back end is always interested in logging where things are coming from",
    "start": "1879600",
    "end": "1885679"
  },
  {
    "text": "right so you would send that special crafted string which has the gndi and the ldap",
    "start": "1885679",
    "end": "1891760"
  },
  {
    "text": "and the domain name of the attacker right send it in the headers send it in",
    "start": "1891760",
    "end": "1899519"
  },
  {
    "text": "you know the origin right send in any information that might",
    "start": "1899519",
    "end": "1906000"
  },
  {
    "text": "you know benefit the back end of logging you it's again it becomes a guess game at the end of the day right so i'm gonna",
    "start": "1906000",
    "end": "1911600"
  },
  {
    "text": "guess and then just wait on your server to receive a dns query or",
    "start": "1911600",
    "end": "1918399"
  },
  {
    "text": "if you don't control the dns doesn't matter receive wait for a tcp connection right",
    "start": "1918399",
    "end": "1924799"
  },
  {
    "text": "because at the end of the day the back end will establish a tcp connection to your server and just for that i mean you",
    "start": "1924799",
    "end": "1931120"
  },
  {
    "text": "can you can do so much of that as well like if someone is connecting to you right yeah it has a special protocol but",
    "start": "1931120",
    "end": "1937760"
  },
  {
    "text": "you can you can control that protocol you can you can play with that right",
    "start": "1937760",
    "end": "1943840"
  },
  {
    "text": "but yeah fascinating stuff you can you can find out where the connection are coming from so the",
    "start": "1943840",
    "end": "1950320"
  },
  {
    "text": "server name you can find the ipls of the backend scary stuff indeed the scary stuff and",
    "start": "1950320",
    "end": "1956399"
  },
  {
    "text": "this stuff in this so this is how scanning is being happening so now the",
    "start": "1956399",
    "end": "1961840"
  },
  {
    "text": "attackers who are scanning the internet are just logging the ip addresses of the infected back ends not infected",
    "start": "1961840",
    "end": "1969200"
  },
  {
    "text": "effectively but the the possible vulnerable back end that have log 4g the moment you get a tcpa connection and",
    "start": "1969200",
    "end": "1976240"
  },
  {
    "text": "we've seen many videos and twitter polls that people are actually doing that for tests minecraft just",
    "start": "1976240",
    "end": "1982080"
  },
  {
    "text": "send that to the chat and if the chat is you know minecraft will log certain chats if it's",
    "start": "1982080",
    "end": "1989039"
  },
  {
    "text": "like malicious or something like that and the moment they start to log in look 4g will kick in and do the lookup",
    "start": "1989039",
    "end": "1996000"
  },
  {
    "text": "so remediation what do you do disable internet on the back end if you",
    "start": "1996000",
    "end": "2001200"
  },
  {
    "text": "can right try to kill that thing right you might worry about ocsp stabling don't do that",
    "start": "2001200",
    "end": "2008799"
  },
  {
    "text": "instead get a 14 a week certificate from cloudflare right get a",
    "start": "2008799",
    "end": "2016000"
  },
  {
    "text": "short as the shortest the certificate the better because if you have a short",
    "start": "2016000",
    "end": "2021039"
  },
  {
    "text": "certificate then that your private key is recycled right on on a on a bi-weekly",
    "start": "2021039",
    "end": "2026159"
  },
  {
    "text": "basis that's the shortest thing i've seen like 14 weeks which is amazing right and then the next one is uh three",
    "start": "2026159",
    "end": "2032320"
  },
  {
    "text": "months which is let's encrypt um and then yeah you can you can get a year but",
    "start": "2032320",
    "end": "2037519"
  },
  {
    "text": "i think that now the browser consulting forces uh all the certificate to be at least",
    "start": "2037519",
    "end": "2043440"
  },
  {
    "text": "one year i believe anything that beloved is just not secure anymore uh attackers",
    "start": "2043440",
    "end": "2048480"
  },
  {
    "text": "are finding ways around cryptographic uh you know cracking curtail stuff or not",
    "start": "2048480",
    "end": "2053919"
  },
  {
    "text": "uh guys uh i'm gonna end this video i know i've",
    "start": "2053919",
    "end": "2060320"
  },
  {
    "text": "been all over the place but it's been a while since i recorded a video so uh i know i talked a lot but it's just",
    "start": "2060320",
    "end": "2066638"
  },
  {
    "text": "uh i had a lot to talk about i guess so so excuse me for this if this uh episode",
    "start": "2066639",
    "end": "2073118"
  },
  {
    "text": "was a little bit unstructured but i guess some people like that some people don't like that but it is what it is",
    "start": "2073119",
    "end": "2079200"
  },
  {
    "text": "and i'll try to be more organized and structured in the in the next episode i'm going to talk about the amazon outage next hopefully",
    "start": "2079200",
    "end": "2086398"
  },
  {
    "text": "if i have time but uh i'm going to see you in the next one you guys stay awesome this thank you so much goodbye",
    "start": "2086399",
    "end": "2094878"
  }
]