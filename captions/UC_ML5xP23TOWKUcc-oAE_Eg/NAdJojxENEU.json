[
  {
    "start": "0",
    "end": "264000"
  },
  {
    "text": "the linux kernels network packet processing subsystem is called net filter and iptables is the command used to",
    "start": "80",
    "end": "5839"
  },
  {
    "text": "configure it and boy this tool is a swiss army knife it's more like a",
    "start": "5839",
    "end": "10880"
  },
  {
    "text": "katana with a hilt of a mace that is dipped in poison",
    "start": "10880",
    "end": "16240"
  },
  {
    "text": "because you can shoot yourself in the footwear that is really really powerful how about we jump into it guys in this",
    "start": "16240",
    "end": "22000"
  },
  {
    "text": "video i'll demonstrate ip tables and show you practical example how to do port forwarding ip forwarding",
    "start": "22000",
    "end": "28160"
  },
  {
    "text": "and even load balancing hopefully in upcoming videos this is just part one let's just jump into it",
    "start": "28160",
    "end": "34480"
  },
  {
    "text": "these are the four key components of ip tables that you really need to",
    "start": "34480",
    "end": "39840"
  },
  {
    "text": "understand the first thing is tables and there are really bad ju just three tables",
    "start": "39840",
    "end": "45039"
  },
  {
    "text": "right there are the chains that you can add rules to and their third there's matches how do",
    "start": "45039",
    "end": "51520"
  },
  {
    "text": "you match as packets coming into your server how do you match it hey this is oh if the protocol is tcp and",
    "start": "51520",
    "end": "58480"
  },
  {
    "text": "the ip is this and the port is this and the icmp",
    "start": "58480",
    "end": "63680"
  },
  {
    "text": "header is this then do that right and then finally the target which is the extension",
    "start": "63680",
    "end": "68880"
  },
  {
    "text": "to do the actual work whether hey i want to drop the packet hey i want to forward the packet to this",
    "start": "68880",
    "end": "74320"
  },
  {
    "text": "different station hey i want to redirect it to somewhere else this is where the action is so the table",
    "start": "74320",
    "end": "79600"
  },
  {
    "text": "the chain where where things happen right whether it's before routing after routing as the ra as the packet",
    "start": "79600",
    "end": "86400"
  },
  {
    "text": "leaves the process as the packet comes into the process and matches like how do you match the",
    "start": "86400",
    "end": "92560"
  },
  {
    "text": "packets and then finally the target what do you want to do with it let's take an example in this video i'm",
    "start": "92560",
    "end": "99119"
  },
  {
    "text": "gonna only explain the nat table right because that's where i have use cases for there are",
    "start": "99119",
    "end": "105520"
  },
  {
    "text": "stuff i'm gonna leave it for other uh as i develop more use cases and actual",
    "start": "105520",
    "end": "110720"
  },
  {
    "text": "real life scenarios i'll add them but it i always find confusing to explain",
    "start": "110720",
    "end": "115920"
  },
  {
    "text": "something without a use cases like okay why does it exist right you always get confused so then",
    "start": "115920",
    "end": "121600"
  },
  {
    "text": "that table is the first table that i'm going to explore ip tables not table and here's the chain",
    "start": "121600",
    "end": "127520"
  },
  {
    "text": "map for i uh for the nat table so as a packet uh enters from a network",
    "start": "127520",
    "end": "135040"
  },
  {
    "text": "interface whether this is a wi-fi this is ethernet comes in it goes to chain number one",
    "start": "135040",
    "end": "141040"
  },
  {
    "text": "always goes to a chain called pre-routing chain right and you can add as many rules as",
    "start": "141040",
    "end": "146879"
  },
  {
    "text": "you want and the next possible path it could be after a pre-routing it could",
    "start": "146879",
    "end": "152560"
  },
  {
    "text": "immediately go to the process if there is a process matching the port",
    "start": "152560",
    "end": "158959"
  },
  {
    "text": "that is the destination port now if there is no port listening on port i don't know whatever 777 then",
    "start": "158959",
    "end": "165840"
  },
  {
    "text": "there the the kernel will not map anything to the process right it will just",
    "start": "165840",
    "end": "171040"
  },
  {
    "text": "uh you will get in a reset essentially a tcp reset the other path is hey what if you",
    "start": "171040",
    "end": "176560"
  },
  {
    "text": "actually change the path oh uh here please change the target",
    "start": "176560",
    "end": "181920"
  },
  {
    "text": "the the destination from this ip which is moi to someone completely else somewhere else",
    "start": "181920",
    "end": "187040"
  },
  {
    "text": "if you do that then it will go to the post routing because oh you're you're essentially changing the route",
    "start": "187040",
    "end": "192080"
  },
  {
    "text": "right you're essentially kicking it out of your kernel out of the",
    "start": "192080",
    "end": "197760"
  },
  {
    "text": "either the same network interface or some other network interface so that's one path another path is goes to the processes",
    "start": "197760",
    "end": "204239"
  },
  {
    "text": "and another path here is when a packet leaves the process like you're sending a get request an http or",
    "start": "204239",
    "end": "209920"
  },
  {
    "text": "post request it goes through the output chain so you can do stuff of it and before after it goes to output chain",
    "start": "209920",
    "end": "217599"
  },
  {
    "text": "it can go to the post routing right if you're leaving like you're sending a packet to some",
    "start": "217599",
    "end": "224879"
  },
  {
    "text": "some ips that is not you right obviously it needs to leave your network to go to the network right",
    "start": "224879",
    "end": "230560"
  },
  {
    "text": "so it goes to the post routing and go there right another path is uh what if you send yourself",
    "start": "230560",
    "end": "237040"
  },
  {
    "text": "a send a packet to a localhost which is a loopback right so in this case literally to see it is",
    "start": "237040",
    "end": "243840"
  },
  {
    "text": "actually a loopback right you go to the output and then just loops back to go to the actual process that is",
    "start": "243840",
    "end": "249439"
  },
  {
    "text": "listening that's called a loopback so if you send that a message a packet to one two seven zero zero one another",
    "start": "249439",
    "end": "255120"
  },
  {
    "text": "port that is listening on your machine it goes this way right so that will explain that table how about we",
    "start": "255120",
    "end": "260799"
  },
  {
    "text": "essentially give an example the first popular example that i always run into right is i",
    "start": "260799",
    "end": "268479"
  },
  {
    "start": "264000",
    "end": "654000"
  },
  {
    "text": "am running node.js or python or any or any process that is listening on some port however",
    "start": "268479",
    "end": "275680"
  },
  {
    "text": "i don't want to give that stinking application the shady application root privilege so it listens",
    "start": "275680",
    "end": "282240"
  },
  {
    "text": "on port 80. yet i want to connect to the application through port 80.",
    "start": "282240",
    "end": "287680"
  },
  {
    "text": "but i don't want it to i want i don't want it to listen to port 80 because it port 80 requires beautiful",
    "start": "287680",
    "end": "295040"
  },
  {
    "text": "root permissions to listen anything below 24 require roots and you don't want to give",
    "start": "295040",
    "end": "300639"
  },
  {
    "text": "shady node.js root privilege because this is this is not just a swiss army knife this is more like a gatling gun",
    "start": "300639",
    "end": "308639"
  },
  {
    "text": "essentially not js so do not give it roof permission please okay so now i have a messaging",
    "start": "308639",
    "end": "314560"
  },
  {
    "text": "machine here 1002 and uh it's listening there is no js running there's a web server running",
    "start": "314560",
    "end": "320400"
  },
  {
    "text": "8080 right and what i want to do is i want to communicate through port 80 i want to send a get",
    "start": "320400",
    "end": "326639"
  },
  {
    "text": "request i want to do a curl i want to go through the browser and visit port 80 on this machine guess what there is nothing listening on",
    "start": "326639",
    "end": "332720"
  },
  {
    "text": "port 80 here right but no iptables magic everything goes",
    "start": "332720",
    "end": "338479"
  },
  {
    "text": "the kernel remember every single packet that you send to your machine goes to the kernel",
    "start": "338479",
    "end": "344800"
  },
  {
    "text": "before you go to user space before it goes to you essentially as the application so now",
    "start": "344800",
    "end": "350880"
  },
  {
    "text": "we will get a packet that is destined to me well that's me 1002 all right but i",
    "start": "350880",
    "end": "356720"
  },
  {
    "text": "don't have anything in port 80. what we're going to do is we're going to map we're going to do use",
    "start": "356720",
    "end": "361759"
  },
  {
    "text": "we're going to do a redirect it's in the same machine i just want you to change the port leave",
    "start": "361759",
    "end": "367759"
  },
  {
    "text": "the ip address as it is just change the port please just change the port from 80 to 8080.",
    "start": "367759",
    "end": "373759"
  },
  {
    "text": "so that's a rule that you applied on the pre-routing right to change the rule so you can go to",
    "start": "373759",
    "end": "379680"
  },
  {
    "text": "8080. in this case that will immediately go and then the",
    "start": "379680",
    "end": "384960"
  },
  {
    "text": "uh node.js will get the packet and then the rest is history we talked about it many times in this channel",
    "start": "384960",
    "end": "390960"
  },
  {
    "text": "so here's how you do it in the ip table so you do a command ip tables forget about the",
    "start": "390960",
    "end": "396400"
  },
  {
    "text": "backslash here this is just to add a new line but dash dash table or dash t i like to",
    "start": "396400",
    "end": "402319"
  },
  {
    "text": "use the full word because it's just more readable to me at least you can use the short word which is dash",
    "start": "402319",
    "end": "407680"
  },
  {
    "text": "t but i always like forget is it small letter t or capital letter t is just confusing me so i like to use",
    "start": "407680",
    "end": "414319"
  },
  {
    "text": "everything lowercase and forward i'm working i'm manipulating the nat table the network address",
    "start": "414319",
    "end": "421120"
  },
  {
    "text": "translation and i talked about that guys i i forgot to mention that you probably need to understand that before jumping into this video this is a",
    "start": "421120",
    "end": "427280"
  },
  {
    "text": "little bit in the intermediate thing right here so check out the video right here so we're going to work on the net table",
    "start": "427280",
    "end": "432880"
  },
  {
    "text": "we're going to manipulate that thing i'm going to append a rule to the pre-routing chain",
    "start": "432880",
    "end": "439280"
  },
  {
    "text": "that's what i'm going to do what does it do well i'm going to match anything on the tcp anything tcp",
    "start": "439280",
    "end": "446240"
  },
  {
    "text": "stack anything packet tcp match it okay got it yeah http is tcp",
    "start": "446240",
    "end": "452319"
  },
  {
    "text": "well unless it's uh quick that's a different scenario so be careful if you're routing quick uh request that's a",
    "start": "452319",
    "end": "458960"
  },
  {
    "text": "different thing right then dash dash deport if the destination port is 80",
    "start": "458960",
    "end": "464400"
  },
  {
    "text": "match it got it yeah i'm going to port 80. dash dash jump that's the most important",
    "start": "464400",
    "end": "470720"
  },
  {
    "text": "command here i want to jump to this target that's the target we explained right and the target name here is called",
    "start": "470720",
    "end": "477039"
  },
  {
    "text": "redirect and it's a built-in target you can by the way build extensions your",
    "start": "477039",
    "end": "482319"
  },
  {
    "text": "own custom targets to do all this magic right i i think docker already have its own chains if",
    "start": "482319",
    "end": "489599"
  },
  {
    "text": "you install docker you'll see all this garbage chains and and targets all left and right so as",
    "start": "489599",
    "end": "495759"
  },
  {
    "text": "you jump into this target the rest is the rest of the parameters depend on the target so dash",
    "start": "495759",
    "end": "502720"
  },
  {
    "text": "dash 2 for example only is applicable to redirect if you use it with another target",
    "start": "502720",
    "end": "508319"
  },
  {
    "text": "like dnat you're going to get an error obviously so i want you to map to 8080. very",
    "start": "508319",
    "end": "514800"
  },
  {
    "text": "simple right and here's what happened when you actually do it right and then once we do",
    "start": "514800",
    "end": "520320"
  },
  {
    "text": "this i'm going to jump into an example and show you how this thing works redirect port 80 to 8080.",
    "start": "520320",
    "end": "525839"
  },
  {
    "text": "what happens here is that we received the beautiful packet from this iprs 192.168.1.2",
    "start": "525839",
    "end": "531600"
  },
  {
    "text": "on one two three four uh destination from the source port 1234 to destination",
    "start": "531600",
    "end": "537600"
  },
  {
    "text": "port 80 to destination ips 1002 obviously the moment the packet arrives",
    "start": "537600",
    "end": "543200"
  },
  {
    "text": "the first thing it goes through is the pre-routing so the pre-routing chain is applied what does the",
    "start": "543200",
    "end": "549200"
  },
  {
    "text": "pre-routing said we said hey redirect this 80 to 8080. so we just changed it we",
    "start": "549200",
    "end": "554640"
  },
  {
    "text": "changed that port which is beautiful we changed it to 8080. all right as we go here it leaves",
    "start": "554640",
    "end": "562959"
  },
  {
    "text": "so okay 1002 and 8080 do i have a process running that has",
    "start": "562959",
    "end": "570240"
  },
  {
    "text": "is listening on port 8080 yes this is the node.js process pid1 okay i should have added the logo here",
    "start": "570240",
    "end": "576560"
  },
  {
    "text": "node.js okay this is much better all right so we're going to directly to the node.js app",
    "start": "576560",
    "end": "581760"
  },
  {
    "text": "beautiful and now when the process finished it will reply with an acknowledgement obviously it's going to reply back to",
    "start": "581760",
    "end": "588320"
  },
  {
    "text": "this right and as it leaves it's going to reply back and the packet source will be 8080. but iptables is",
    "start": "588320",
    "end": "596480"
  },
  {
    "text": "smart knows oh i actually changed 8080 to 80. it keeps track of this stuff this stuff",
    "start": "596480",
    "end": "601839"
  },
  {
    "text": "is not easy guys building networking and linux kernel is not easy there's so much stuff going on there",
    "start": "601839",
    "end": "609279"
  },
  {
    "text": "right so if you if you if we actually send back the packet from node.js all the way to",
    "start": "609279",
    "end": "615200"
  },
  {
    "text": "the network as source 8080 that thing on the other end the client whoever sent",
    "start": "615200",
    "end": "621440"
  },
  {
    "text": "this is gonna say what the hell is this i didn't send something from it to 8080. i send something to port 80 it's gonna",
    "start": "621440",
    "end": "627839"
  },
  {
    "text": "drop the packet so that the routing in this case i didn't show it but it's going to go through essentially the",
    "start": "627839",
    "end": "633360"
  },
  {
    "text": "output essentially it's going to go through the output and then post routing but there are no chains",
    "start": "633360",
    "end": "638560"
  },
  {
    "text": "essentially there in this case so it's going to just goop immediately there are no rules but it will keep track of this and",
    "start": "638560",
    "end": "644959"
  },
  {
    "text": "change it right change it back to 80 so that the public know what what to expect",
    "start": "644959",
    "end": "651040"
  },
  {
    "text": "got it all right how about we do an example guys all right guys here i am on my pie okay and for simplicity i'm",
    "start": "651040",
    "end": "659279"
  },
  {
    "start": "654000",
    "end": "817000"
  },
  {
    "text": "going to just show you that if i do curl on http rpi.local which is",
    "start": "659279",
    "end": "664320"
  },
  {
    "text": "my machine name here uh on port 8080 you can see that i have",
    "start": "664320",
    "end": "670160"
  },
  {
    "text": "a web server running on port 8080 but if i do on 80",
    "start": "670160",
    "end": "678320"
  },
  {
    "text": "i get an error because there is nothing there is no process running on port 80 that's why this error makes sense",
    "start": "679680",
    "end": "684959"
  },
  {
    "text": "what i want to do is i want when someone made a request to port 80 on this spy i want to",
    "start": "684959",
    "end": "691440"
  },
  {
    "text": "immediately for redirected to 8080. so how do we do this we're going to do sudo iptables",
    "start": "691440",
    "end": "697360"
  },
  {
    "text": "dash dash table i'm going to work on the nat table let's just do new line so we can it's",
    "start": "697360",
    "end": "703200"
  },
  {
    "text": "going to be more readable for you guys all right so the next thing we're going to do is we're going to append",
    "start": "703200",
    "end": "708959"
  },
  {
    "text": "to the pre routing chain right i'm filtering i'm matching on the",
    "start": "708959",
    "end": "715440"
  },
  {
    "text": "protocol that is called tcp this is optional by the way guys if you don't add this then",
    "start": "715440",
    "end": "720720"
  },
  {
    "text": "any iep packet will be filtered right regardless of this content whether",
    "start": "720720",
    "end": "727120"
  },
  {
    "text": "it's cp tcp or udp or quick maybe that's better for you you don't have to add it if you want to",
    "start": "727120",
    "end": "732320"
  },
  {
    "text": "then i'm i want to anything that matches the destination port is called 80 if you if anything is",
    "start": "732320",
    "end": "737519"
  },
  {
    "text": "coming to you my friend on port 80 right that's another thing go ahead",
    "start": "737519",
    "end": "743600"
  },
  {
    "text": "go ahead and jump to the target that's called redirect what are we gonna do with the redirect i",
    "start": "743600",
    "end": "750000"
  },
  {
    "text": "want you to change the port dash dash two right that's why it's just called two because it has to be a port",
    "start": "750000",
    "end": "755440"
  },
  {
    "text": "you cannot change anything else the redirect only to read our export that's why the parameter is called two okay and then what do we want to do",
    "start": "755440",
    "end": "763440"
  },
  {
    "text": "please move it to 8080 just like that done so now all right so let's go ahead and",
    "start": "763440",
    "end": "768720"
  },
  {
    "text": "open a new tab and then we're gonna do curl http rpi from another machine now i'm i'm",
    "start": "768720",
    "end": "776000"
  },
  {
    "text": "going to another machine just to test this stuff if i do local",
    "start": "776000",
    "end": "781360"
  },
  {
    "text": "you can see our pi dot local and now i'm getting that right if i do 8080 that also",
    "start": "781360",
    "end": "788160"
  },
  {
    "text": "works because that's the original thing right but we see that this works you don't believe me",
    "start": "788160",
    "end": "794000"
  },
  {
    "text": "open a browser.local enter and you can see that hello world",
    "start": "794000",
    "end": "799920"
  },
  {
    "text": "i'm running on 8080 but you're accessing me through port 80 magic magic",
    "start": "799920",
    "end": "806480"
  },
  {
    "text": "all right so now this is the redirect guys all right let's go back to slide let's explain the second part which is",
    "start": "806480",
    "end": "813600"
  },
  {
    "text": "ip forwarding to a completely different machine how about we do that all right guys so now we explained",
    "start": "813600",
    "end": "819680"
  },
  {
    "start": "817000",
    "end": "1320000"
  },
  {
    "text": "how to redirect ports into the same machine but some if you want to build a firewall",
    "start": "819680",
    "end": "825839"
  },
  {
    "text": "or a reverse proxy or a load balancer you gotta forward those packets to another machine",
    "start": "825839",
    "end": "831199"
  },
  {
    "text": "right this is where it gets really complicated and you really understand you need to need to understand what's going on",
    "start": "831199",
    "end": "837120"
  },
  {
    "text": "so this diagram that i wrote here is gonna explain this right sorry i didn't do slides because i'm i'm",
    "start": "837120",
    "end": "843519"
  },
  {
    "text": "on camera but i'm going to explain this to you don't worry about it so here's the original client running on 192.168.1.2",
    "start": "843519",
    "end": "851360"
  },
  {
    "text": "and it's sending a packet to port 80 to this destination 1002 okay and guess what there is nothing",
    "start": "851360",
    "end": "858480"
  },
  {
    "text": "running here on this machine nothing there is no process there is nothing okay the actual process that is running is",
    "start": "858480",
    "end": "865199"
  },
  {
    "text": "right here and it's listening on port 80 and what i want to do is i want to forward the",
    "start": "865199",
    "end": "870240"
  },
  {
    "text": "packets all the way there so that they can come back eventually to me",
    "start": "870240",
    "end": "875440"
  },
  {
    "text": "so what i'm going to do is i'm going to send the packet hey git request whatever 1002 to port 80",
    "start": "875440",
    "end": "881920"
  },
  {
    "text": "from one two three four random port from moi so now what this machine will",
    "start": "881920",
    "end": "887279"
  },
  {
    "text": "do is gonna forward that packet to another machine how does it do that it does something called the destination",
    "start": "887279",
    "end": "892880"
  },
  {
    "text": "net and net if you don't know guys it's the network address translation i want to translate",
    "start": "892880",
    "end": "898160"
  },
  {
    "text": "the address and here's how you read it i want to translate the address from this ip to this ip or from this",
    "start": "898160",
    "end": "906079"
  },
  {
    "text": "port to this port it can changes ports it can changes it can change ip so this is a more general case than the",
    "start": "906079",
    "end": "912959"
  },
  {
    "text": "redirect the redirect only changes the port internally to the same",
    "start": "912959",
    "end": "918800"
  },
  {
    "text": "machine this can change the port and the ip errors so you can use this to redirect as well so",
    "start": "918800",
    "end": "924959"
  },
  {
    "text": "now what i want to change is technically i'm not going to change the port you can if",
    "start": "924959",
    "end": "930079"
  },
  {
    "text": "you want to but the port is the same so port 80 here i want to only change the destination",
    "start": "930079",
    "end": "935199"
  },
  {
    "text": "ip address so what i'm going to do here is anything that is coming to me ten zero zero two which is me translate",
    "start": "935199",
    "end": "942480"
  },
  {
    "text": "it to nine one nine two one six eight dot one two three obviously there are more rules and matches right only if no don't just",
    "start": "942480",
    "end": "950240"
  },
  {
    "text": "translate any packet because i i might associate into that machine i don't want you to go there right",
    "start": "950240",
    "end": "955600"
  },
  {
    "text": "only if it matches port 80 if you're going to port 80 and you're going to mua 1002",
    "start": "955600",
    "end": "962000"
  },
  {
    "text": "then translate from two so you as the administrator who are",
    "start": "962000",
    "end": "968399"
  },
  {
    "text": "playing with iptables you only have access to those puppies you can change what to translate to that's why i added",
    "start": "968399",
    "end": "975199"
  },
  {
    "text": "this read as translate from two from two so you can change the destination ip",
    "start": "975199",
    "end": "982000"
  },
  {
    "text": "and you can change the destination port okay as you go through so that's called the destination net",
    "start": "982000",
    "end": "987680"
  },
  {
    "text": "however now we changed it right all good however we changed that packet",
    "start": "987680",
    "end": "993279"
  },
  {
    "text": "it comes here to this machine one nine two one six eight one one two that's the source it's coming from all the way here",
    "start": "993279",
    "end": "1000320"
  },
  {
    "text": "the the source port right one two three four we just didn't change it the source ports the source ip we didn't change it we just",
    "start": "1000320",
    "end": "1006079"
  },
  {
    "text": "changed the destination the destination port didn't change it the distinction ipad is 192.168.13 which is the machine",
    "start": "1006079",
    "end": "1013279"
  },
  {
    "text": "send it over got it i'm processing it now i want to reply to you whether with",
    "start": "1013279",
    "end": "1018480"
  },
  {
    "text": "an economy or the actual reply guess what whom should i reply to",
    "start": "1018480",
    "end": "1025038"
  },
  {
    "text": "i only have this ip okay one nine two one six eight one two okay sure thing i'm gonna reply to this guy",
    "start": "1025039",
    "end": "1033120"
  },
  {
    "text": "notice it didn't reply back to this machine because you didn't tell me to reply to that machine you just changed the destination so it's gonna",
    "start": "1033120",
    "end": "1040160"
  },
  {
    "text": "apply hope to this guy and guess what the guy says i don't know you right so it's like hey",
    "start": "1040160",
    "end": "1047839"
  },
  {
    "text": "where is this packet coming from there is gonna drop it and when that packet drops",
    "start": "1047839",
    "end": "1054039"
  },
  {
    "text": "immediately you're going to get an error he says they're already going to get a retry and then you're going to not",
    "start": "1054039",
    "end": "1059760"
  },
  {
    "text": "going to see anything that's why source netting is very very critical for this so we need",
    "start": "1059760",
    "end": "1066400"
  },
  {
    "text": "another table another one did you hold it so the other table is called the source",
    "start": "1066400",
    "end": "1073679"
  },
  {
    "text": "nat we're gonna play with the source net as well so there are two tables technically it's one with a white column",
    "start": "1073679",
    "end": "1080480"
  },
  {
    "text": "but i just make it two tables so it's easy right so i i want to change the",
    "start": "1080480",
    "end": "1085919"
  },
  {
    "text": "port for the station but i also want to charge the source this uh the source ip so u",
    "start": "1085919",
    "end": "1094799"
  },
  {
    "text": "1 3 reply to moi instead of that so i can i can go and and do the magic",
    "start": "1094799",
    "end": "1102080"
  },
  {
    "text": "remapping and everything right so what we're going to do here is translate from source ip",
    "start": "1102080",
    "end": "1110559"
  },
  {
    "text": "from source ip19216812 which is this guy uh the port i'm not",
    "start": "1110559",
    "end": "1116960"
  },
  {
    "text": "going to attach it to source ip",
    "start": "1116960",
    "end": "1122559"
  },
  {
    "text": "so translate to source ip2002 that's why it's get very confusing when i first realized like okay how is this",
    "start": "1122559",
    "end": "1129360"
  },
  {
    "text": "source and two it's it's it's either source it's it's it's a contradictory things like",
    "start": "1129360",
    "end": "1134799"
  },
  {
    "text": "the two side is the two side right and then you're saying the source that's why you have to read it this way to understand it again",
    "start": "1134799",
    "end": "1141520"
  },
  {
    "text": "always do this translate from source ip192 to source iep this it's a the",
    "start": "1141520",
    "end": "1148400"
  },
  {
    "text": "translation that is attached to the semantics of roman 2 the source ipn source",
    "start": "1148400",
    "end": "1154080"
  },
  {
    "text": "port has nothing to do with it okay now what happens let's go through the chain",
    "start": "1154080",
    "end": "1160799"
  },
  {
    "text": "let's go to the chain and i'm going to do two chains here because you saw that right first of all there is a chain which is",
    "start": "1160799",
    "end": "1168480"
  },
  {
    "text": "called pre-routing as the packet arrived to me change and then as the packet is leaving",
    "start": "1168480",
    "end": "1175760"
  },
  {
    "text": "change so this will be the source nat inc this will be the destination nating so",
    "start": "1175760",
    "end": "1181840"
  },
  {
    "text": "as the packets arrive to this machine this machine is 1002",
    "start": "1181840",
    "end": "1187679"
  },
  {
    "text": "got it and we're arriving on port 80. from one two three four this is the",
    "start": "1187679",
    "end": "1193679"
  },
  {
    "text": "source port this is our source ipads the first thing pre-routing what do we do change the destination net ip address",
    "start": "1193679",
    "end": "1201280"
  },
  {
    "text": "to one nine two one six eight one three we explain that change what do we do next",
    "start": "1201280",
    "end": "1206400"
  },
  {
    "text": "we'll say okay where's one night that kernel says where the hell is 192168.103",
    "start": "1206400",
    "end": "1211760"
  },
  {
    "text": "well it's definitely not this machine so i need to send it out to the network so okay so it definitely is not going",
    "start": "1211760",
    "end": "1218480"
  },
  {
    "text": "anywhere next to my stuff right so it's going all the way to post routing and then as it leaves post routines like",
    "start": "1218480",
    "end": "1225200"
  },
  {
    "text": "why by the way while while you're leaving change your source",
    "start": "1225200",
    "end": "1230720"
  },
  {
    "text": "translate your source ip from 192.168.1.2",
    "start": "1230720",
    "end": "1237840"
  },
  {
    "text": "to the source ip1002 which is moi which is i this is my machine this is the blue",
    "start": "1237840",
    "end": "1243760"
  },
  {
    "text": "machine that we talked about and then go your merry way now",
    "start": "1243760",
    "end": "1248960"
  },
  {
    "text": "i'm i'm gonna explain also the other way when you eventually when you",
    "start": "1248960",
    "end": "1255440"
  },
  {
    "text": "send that message to one three this is now machine one one one nine two one six eight one three",
    "start": "1255440",
    "end": "1261039"
  },
  {
    "text": "it just got this beautiful packet that we just forwarded right and what does it do in this case this is a",
    "start": "1261039",
    "end": "1267360"
  },
  {
    "text": "simpler chain and there's no technically didn't we didn't do any rules here so it will say hey 192168",
    "start": "1267360",
    "end": "1273919"
  },
  {
    "text": "that's me all right okay pre-routing do you have any change nope i don't have any chains you're going to port 80 yeah i do have a",
    "start": "1273919",
    "end": "1280720"
  },
  {
    "text": "listening port in here port 80 listening go ahead and we'll just shoot it right there the final port here",
    "start": "1280720",
    "end": "1288159"
  },
  {
    "text": "that i want to make that as i spend hours trying to figure it out",
    "start": "1288159",
    "end": "1293200"
  },
  {
    "text": "if you do not enable ip forwarding on your linux box this will not work you have to enable",
    "start": "1293200",
    "end": "1298880"
  },
  {
    "text": "that bit find what uh depend whether it's a raspberry pi whether it's ubuntu",
    "start": "1298880",
    "end": "1304159"
  },
  {
    "text": "everything is different okay find out how to enable ip forwarding i'm going to show you how on my raspberry pi but i'm going to link",
    "start": "1304159",
    "end": "1310960"
  },
  {
    "text": "out how to do that you have to do this do not make my mistake otherwise you're you're gonna spend",
    "start": "1310960",
    "end": "1317919"
  },
  {
    "text": "hours debugging is like why is the other machine not getting the packets let's go jump to the example so here's",
    "start": "1317919",
    "end": "1324960"
  },
  {
    "start": "1320000",
    "end": "1920000"
  },
  {
    "text": "what i have here on this machine 192.168.254.",
    "start": "1324960",
    "end": "1330640"
  },
  {
    "text": "the 10 on port 8080 i have some content right here okay",
    "start": "1330640",
    "end": "1337520"
  },
  {
    "text": "this is it right and actually let's go to the browser so it's more it's better let's go to our",
    "start": "1337520",
    "end": "1342880"
  },
  {
    "text": "browser i have a cycle mark tire pros where",
    "start": "1342880",
    "end": "1347919"
  },
  {
    "text": "they are the pros for tires they like tires they make in tires they fix tires they repair anything",
    "start": "1347919",
    "end": "1353600"
  },
  {
    "text": "regular to tires but it's running on port 8080 and it's on a different machine what i",
    "start": "1353600",
    "end": "1359200"
  },
  {
    "text": "want to do when you go to http rpi dot local on port",
    "start": "1359200",
    "end": "1365360"
  },
  {
    "text": "80 which we i need to clear that by i need to clear that rule before we",
    "start": "1365360",
    "end": "1370720"
  },
  {
    "text": "continue remind me to do that right i want you to go to mark tire pros running there now it's",
    "start": "1370720",
    "end": "1378159"
  },
  {
    "text": "obviously it's doing this thing right it's doing our thing i wanted to redirect to a completely different",
    "start": "1378159",
    "end": "1383440"
  },
  {
    "text": "machine completely different port so we're doing two things how do we do that so we know this this is the machine that",
    "start": "1383440",
    "end": "1390080"
  },
  {
    "text": "is running well this is what we're going to do let's go back to my raspberry pi and let's clear the nat table how do you",
    "start": "1390080",
    "end": "1395440"
  },
  {
    "text": "clear the net table very simple sudo ip tables dash dash table and then",
    "start": "1395440",
    "end": "1400480"
  },
  {
    "text": "you have to specify what table you work with again i'm only barely touching the iceberg here",
    "start": "1400480",
    "end": "1407679"
  },
  {
    "text": "we didn't touch anything this is the nat table and we barely scratched the surface my friends",
    "start": "1407679",
    "end": "1413360"
  },
  {
    "text": "that's that stable net and then we're going to do dash dash flash flush that damn thing nothing's there",
    "start": "1413360",
    "end": "1419120"
  },
  {
    "text": "and by the way i forgot to show you how to list stuff you do dash dash table net dash dash list",
    "start": "1419120",
    "end": "1424720"
  },
  {
    "text": "um list everything in the net table currently there is nothing i wish i did i showed you how to show",
    "start": "1424720",
    "end": "1431440"
  },
  {
    "text": "that but but it's okay it's okay guys now you know now you know i'm going to list all this command in the description below let's jump jump",
    "start": "1431440",
    "end": "1438880"
  },
  {
    "text": "into it i definitely are not going to do that load bouncing in this episode i'm going to do it in another video because it's going to be it's going to be like a",
    "start": "1438880",
    "end": "1445520"
  },
  {
    "text": "40 hour video in this case let's continue sudo iptables my friends this cup so",
    "start": "1445520",
    "end": "1452320"
  },
  {
    "text": "we're going to do sudo ip tables what we're going to do we wanna work",
    "start": "1452320",
    "end": "1458480"
  },
  {
    "text": "with the nat table now guys we need to add two iptable rules",
    "start": "1458480",
    "end": "1465760"
  },
  {
    "text": "the first rule is in the pre-routing the second rule is on the post routing right is it called poster on alpha that",
    "start": "1465760",
    "end": "1472400"
  },
  {
    "text": "was called post routing so i want you to append on the pre-routing chain",
    "start": "1472400",
    "end": "1479279"
  },
  {
    "text": "when the protocol is tcp when the destination",
    "start": "1479279",
    "end": "1487279"
  },
  {
    "text": "now i'm really interested in the destination why because remember if you're a firewall or a",
    "start": "1487279",
    "end": "1494960"
  },
  {
    "text": "gateway you're not necessarily always the destination but you're transparently getting",
    "start": "1494960",
    "end": "1502799"
  },
  {
    "text": "packets sent to does that make sense right like your router your router every",
    "start": "1502799",
    "end": "1509279"
  },
  {
    "text": "single packet that you send every single site you visit goes through your router is it your final destination",
    "start": "1509279",
    "end": "1515039"
  },
  {
    "text": "it's almost never but it goes through it so it needs rules it's like if it is if it's really",
    "start": "1515039",
    "end": "1521039"
  },
  {
    "text": "to you or not so um 192168.254.47",
    "start": "1521039",
    "end": "1527039"
  },
  {
    "text": "if you are destined to wall which is this raspberry pi this is the ips of the",
    "start": "1527039",
    "end": "1532799"
  },
  {
    "text": "raspberry pi right which which is this is r pi dot local by the way guys just if you don't know and",
    "start": "1532799",
    "end": "1541440"
  },
  {
    "text": "d port if the port is 80 if you're going to port 80",
    "start": "1541440",
    "end": "1547200"
  },
  {
    "text": "let's join and jump what do we what target do we jump to dna the destination net we're",
    "start": "1547200",
    "end": "1553200"
  },
  {
    "text": "changing the destination net guess what not only the ip just like the example that we showed",
    "start": "1553200",
    "end": "1559120"
  },
  {
    "text": "i'm going to change the port because i live on the edge babes i live on the edge so we're going to",
    "start": "1559120",
    "end": "1564320"
  },
  {
    "text": "change it to 2 destination 192",
    "start": "1564320",
    "end": "1569520"
  },
  {
    "text": "the 254 the 10 and then boom i t 80. that's the",
    "start": "1569520",
    "end": "1576159"
  },
  {
    "text": "that's the port that's the machine the other machine that is running my beautiful mic tire",
    "start": "1576159",
    "end": "1582320"
  },
  {
    "text": "pros right we're gonna we're gonna make mike tyre site public today okay and by the way",
    "start": "1582320",
    "end": "1589440"
  },
  {
    "text": "two destination again as we explain this is a parameter that is only applicable to the dna",
    "start": "1589440",
    "end": "1595279"
  },
  {
    "text": "target it's not applicable to anything else enter is this enough absolutely",
    "start": "1595279",
    "end": "1603279"
  },
  {
    "text": "not because yeah you can send a packet now to 192",
    "start": "1603279",
    "end": "1609840"
  },
  {
    "text": "to to to the raspberry pi on port 80 it's gonna get forward to that but this",
    "start": "1609840",
    "end": "1615360"
  },
  {
    "text": "poor guy is not going to be able to reply because guess what it's trying to reply back to",
    "start": "1615360",
    "end": "1620720"
  },
  {
    "text": "itself in this case because whatever it's going to get confused right so we need another one",
    "start": "1620720",
    "end": "1626880"
  },
  {
    "text": "deja charlotte another one we're gonna do nat i'm cheating now i'm",
    "start": "1626880",
    "end": "1634080"
  },
  {
    "text": "just looking up post routing i'm gonna add a post routing as the packet now that now that we know",
    "start": "1634080",
    "end": "1641360"
  },
  {
    "text": "the packet's gonna leave me to out the network interface which is my my wi-fi in this case",
    "start": "1641360",
    "end": "1647760"
  },
  {
    "text": "by the way guys you can you can do so much stuff here you can do the dash dash in interface if you have like seven",
    "start": "1647760",
    "end": "1653360"
  },
  {
    "text": "interfaces you can control which interfaces you want but usually if you have the ipads that's enough",
    "start": "1653360",
    "end": "1658799"
  },
  {
    "text": "but if you do the interface that check will can be faster right because this is",
    "start": "1658799",
    "end": "1663919"
  },
  {
    "text": "at the end of this all checks right it's like it's searching and you want to make the search as fast",
    "start": "1663919",
    "end": "1669039"
  },
  {
    "text": "as possible for the kernel the more parameter you give the faster the search gets",
    "start": "1669039",
    "end": "1674080"
  },
  {
    "text": "right because you eliminate it's like if you have seven i have only one interface which is the wi-fi one right but if you have like lan",
    "start": "1674080",
    "end": "1681200"
  },
  {
    "text": "and switches and wi-fi and three wi-fi i don't know why would you do that but if you have that then do specify the",
    "start": "1681200",
    "end": "1687760"
  },
  {
    "text": "interface by doing dash dash in interface or if you're feeling kinky just do dash i just iwlan0",
    "start": "1687760",
    "end": "1696559"
  },
  {
    "text": "only if you're feeling kinky right in interface i don't want to do that though",
    "start": "1696559",
    "end": "1703600"
  },
  {
    "text": "all right that's happened only if it's protocol tcp again might be working with quick so be",
    "start": "1703600",
    "end": "1709840"
  },
  {
    "text": "careful there now if your destination as a packet is",
    "start": "1709840",
    "end": "1716000"
  },
  {
    "text": "192.168.254. can you guess take three seconds to guess what is my destination in this",
    "start": "1716679",
    "end": "1721760"
  },
  {
    "text": "case yes 10. if you're going if you're leaving and going to 10",
    "start": "1721760",
    "end": "1727200"
  },
  {
    "text": "not enough not enough and and and your destination",
    "start": "1727200",
    "end": "1734480"
  },
  {
    "text": "pokht is 8080 then you're eligible to assess source netting here",
    "start": "1734480",
    "end": "1741600"
  },
  {
    "text": "what are we going to do we're going to jump into the s net babes what are we going to do with this net",
    "start": "1741600",
    "end": "1747039"
  },
  {
    "text": "we're going to che we're going to remember this now this is where it gets confusing guys my",
    "start": "1747039",
    "end": "1752480"
  },
  {
    "text": "two source right translate source right",
    "start": "1752480",
    "end": "1757520"
  },
  {
    "text": "translate from this source to this source that's how you read it okay what is",
    "start": "1757520",
    "end": "1763679"
  },
  {
    "text": "my what is the what what do you translate it to translate this source ips to 192",
    "start": "1763679",
    "end": "1769760"
  },
  {
    "text": "168 to 254 to their pi pi i pairs which is 47. and guys it's all recommended that all these",
    "start": "1769760",
    "end": "1776080"
  },
  {
    "text": "ipads are static right if they are dynamic then you're screwed man right you have to use masquerade and all that stuff",
    "start": "1776080",
    "end": "1782480"
  },
  {
    "text": "which i'm going to talk about in another video enter now that we have this beautiful two",
    "start": "1782480",
    "end": "1788240"
  },
  {
    "text": "rules clear sudo iptables dash dash table",
    "start": "1788240",
    "end": "1793279"
  },
  {
    "text": "net dash dash uh not flush don't flush me list so we can see that's beautiful look",
    "start": "1793279",
    "end": "1800559"
  },
  {
    "text": "at this it actually recognized oh you're going to http is the http protocol",
    "start": "1800559",
    "end": "1806159"
  },
  {
    "text": "it knows that port 80 is http so it shows you like an aliases and that's cute and you can see that it's",
    "start": "1806159",
    "end": "1811919"
  },
  {
    "text": "going anything that is going to this destination rp our uh raspberry pi dot home",
    "start": "1811919",
    "end": "1818960"
  },
  {
    "text": "local that's my domain my local domain and going to http portuguese 80 to go",
    "start": "1818960",
    "end": "1825360"
  },
  {
    "text": "to this destination and the post routing as you leave me my friend go and change",
    "start": "1825360",
    "end": "1833679"
  },
  {
    "text": "that to the destination port hdb alternative which is 8080. that's just come on ip tables come on",
    "start": "1833679",
    "end": "1840320"
  },
  {
    "text": "man insert the joe biden meme here come on man come on man don't you",
    "start": "1840320",
    "end": "1848000"
  },
  {
    "text": "don't do this don't do this okay don't try to be smart i hate when when like yeah we just just show the",
    "start": "1848000",
    "end": "1854159"
  },
  {
    "text": "port okay oh this is the alternative port what the hell is that 8080 is it really in the",
    "start": "1854159",
    "end": "1859679"
  },
  {
    "text": "http alternative i don't know i don't know anything guys by the way two one nine two one six eight two two",
    "start": "1859679",
    "end": "1866720"
  },
  {
    "text": "five four that 47 change more to the the the translate",
    "start": "1866720",
    "end": "1874000"
  },
  {
    "text": "the that the translate from this source which is whatever the original 10 to",
    "start": "1874000",
    "end": "1880640"
  },
  {
    "text": "this source to the 47th so so so so i become your source so you",
    "start": "1880640",
    "end": "1886320"
  },
  {
    "text": "send me the packet now we explain this stuff let's see if this stuff works is is mike uh tire pros",
    "start": "1886320",
    "end": "1894080"
  },
  {
    "text": "site up and running we go to http rpi are you guys ready for this",
    "start": "1894080",
    "end": "1901360"
  },
  {
    "text": "and it shows this why because chrome is dumb because it's caching and extra",
    "start": "1901360",
    "end": "1908240"
  },
  {
    "text": "fresh let's do caching caching sucks all right now no longer",
    "start": "1908240",
    "end": "1914960"
  },
  {
    "text": "caching because in oncognito what the hell why does it enable dictation",
    "start": "1914960",
    "end": "1920559"
  },
  {
    "start": "1920000",
    "end": "2045000"
  },
  {
    "text": "i know not now my site is up and running",
    "start": "1920559",
    "end": "1927279"
  },
  {
    "text": "babes that's it that's it for me today guys and what",
    "start": "1927279",
    "end": "1932960"
  },
  {
    "text": "wait a second we didn't show you how to enable the uh ip the ip forwarding all right guys",
    "start": "1932960",
    "end": "1938399"
  },
  {
    "text": "so finally it works for me because i had the ip forward enabled so make sure to",
    "start": "1938399",
    "end": "1944240"
  },
  {
    "text": "do that so for for the debian raspberry pi in my case it's as you do pseudo etsy i think says",
    "start": "1944240",
    "end": "1952880"
  },
  {
    "text": "ctl something",
    "start": "1952880",
    "end": "1956559"
  },
  {
    "text": "pseudo them i believe says ctl.conf and then you go all the way and find net",
    "start": "1958240",
    "end": "1965440"
  },
  {
    "text": "ip4 ip forward and uncomment this line just make it one right and if your it depends find out how your",
    "start": "1965440",
    "end": "1972799"
  },
  {
    "text": "linux distribution do because it's everywhere is different but enable ip forwarding otherwise this",
    "start": "1972799",
    "end": "1978000"
  },
  {
    "text": "stuff doesn't work okay guys that's it for me today i really recommend you uh get the book linux iptables i'm going to show it",
    "start": "1978000",
    "end": "1984640"
  },
  {
    "text": "in the screen here ip linux ip tables it's a pocket reference it's really good i really enjoyed reading it",
    "start": "1984640",
    "end": "1990240"
  },
  {
    "text": "and the only uh i guess criticism for that book is just it doesn't show you examples just show",
    "start": "1990240",
    "end": "1995760"
  },
  {
    "text": "you hey you can do this you can do this here's here's a bunch of stuff",
    "start": "1995760",
    "end": "2003360"
  },
  {
    "text": "but it doesn't explain use cases for it right it's just like hey there's a bunch of stuff and this it",
    "start": "2003360",
    "end": "2008880"
  },
  {
    "text": "doesn't it doesn't didn't show you had that ip forward which is it kept me very confused for a long time",
    "start": "2008880",
    "end": "2015039"
  },
  {
    "text": "right i tried to come up with use cases this is real uses that i ran into i'm gonna make up another set of videos",
    "start": "2015039",
    "end": "2022159"
  },
  {
    "text": "to to kind of follow up and show you some some examples guys different part let me know",
    "start": "2022159",
    "end": "2028159"
  },
  {
    "text": "if you enjoyed this episode hit that like button subscribe share with your friends",
    "start": "2028159",
    "end": "2033919"
  },
  {
    "text": "and then i'm going to see you in the next one um let me know what do you want to see in the next episode you guys see in the next",
    "start": "2033919",
    "end": "2040240"
  },
  {
    "text": "one you guys awesome go bye you",
    "start": "2040240",
    "end": "2045919"
  }
]