[
  {
    "text": "cool all right thanks rob all right and as ron said uh this is multi-cluster service smash",
    "start": "80",
    "end": "7440"
  },
  {
    "text": "and hopefully you got to come to lynn and rom's earlier workshops",
    "start": "7440",
    "end": "13040"
  },
  {
    "text": "and learn about issue and deploying issue for production uh it's not necessarily a prerequisite",
    "start": "13040",
    "end": "19600"
  },
  {
    "text": "for what we're going to learn here so if you miss those don't don't fret about that if you have some",
    "start": "19600",
    "end": "25119"
  },
  {
    "text": "experience with istio this will still be useful for you uh who am i",
    "start": "25119",
    "end": "30480"
  },
  {
    "text": "as rob said i am a field engineer here at solo dot io i have a pretty long and very background",
    "start": "30480",
    "end": "37680"
  },
  {
    "text": "uh started in telecom moved to mostly developer work i've done",
    "start": "37680",
    "end": "42719"
  },
  {
    "text": "a little agile coaching [Music] and most recently helping our customers",
    "start": "42719",
    "end": "48239"
  },
  {
    "text": "here at solo with service mesh and our glue products",
    "start": "48239",
    "end": "54000"
  },
  {
    "text": "you probably already heard about solo and who we are so i'm going to be brief here uh but",
    "start": "54000",
    "end": "60160"
  },
  {
    "text": "just uh know that you know we've got a virtual booth we've got a an in-person booth that's starting",
    "start": "60160",
    "end": "66400"
  },
  {
    "text": "tomorrow so we'd love to see you either virtually or in person we've got some nice giveaways there",
    "start": "66400",
    "end": "73680"
  },
  {
    "text": "so let's talk a little bit about istio architecture istio as you know is going to help you",
    "start": "73680",
    "end": "80000"
  },
  {
    "text": "with your distributed architecture as you're moving to microservices or you want to deploy your",
    "start": "80000",
    "end": "86400"
  },
  {
    "text": "services into kubernetes uh istio is the glue that kind of binds",
    "start": "86400",
    "end": "92240"
  },
  {
    "text": "together all your traffic that gives you things like service discovery mtls",
    "start": "92240",
    "end": "100079"
  },
  {
    "text": "being able to do fault injection circuit breaking retries all this kind of cool stuff right",
    "start": "100079",
    "end": "106240"
  },
  {
    "text": "um but in reality you know what we're seeing is when you go to production you're not",
    "start": "106240",
    "end": "112159"
  },
  {
    "text": "going to just deploy to a single cluster and that's a typically just a proven concept kind of",
    "start": "112159",
    "end": "118799"
  },
  {
    "text": "thing and most customers that we have today are",
    "start": "118799",
    "end": "124159"
  },
  {
    "text": "hedging their bets against you know multiple vendors and so they don't want to be",
    "start": "124159",
    "end": "129200"
  },
  {
    "text": "stuck in just one cloud let me make this a little bit bigger",
    "start": "129200",
    "end": "134480"
  },
  {
    "text": "all right and so you know we want to enable our customers",
    "start": "134480",
    "end": "140080"
  },
  {
    "text": "across multiple clouds and hybrid environments right",
    "start": "140080",
    "end": "145360"
  },
  {
    "text": "things that you'll get with glue mesh enterprise are one you're going to get a long term",
    "start": "145360",
    "end": "151040"
  },
  {
    "text": "support with istio you're also obviously going to get those muscle multi-cluster operations so",
    "start": "151040",
    "end": "158160"
  },
  {
    "text": "when you want to deploy istio and have a consistent configuration across those",
    "start": "158160",
    "end": "163519"
  },
  {
    "text": "clusters glue mesh is is the platform that that will",
    "start": "163519",
    "end": "169040"
  },
  {
    "text": "enable that for you along with you know services such as global failover routing or traffic shifting",
    "start": "169040",
    "end": "176480"
  },
  {
    "text": "across clusters for multi-mesh you'll also get role-based apis that",
    "start": "176480",
    "end": "183120"
  },
  {
    "text": "will help you control how your teams interact with",
    "start": "183120",
    "end": "188239"
  },
  {
    "text": "sdo across these clusters and you'll get extensibility through web assembly",
    "start": "188239",
    "end": "194000"
  },
  {
    "text": "as well as our advanced filtering and be able to see what's going on across meshes through a single pane of",
    "start": "194000",
    "end": "200720"
  },
  {
    "text": "glass with our observability and of course zero trust security is is kind of top of mind here",
    "start": "200720",
    "end": "208159"
  },
  {
    "text": "um our our version of enterprise istio uh we we",
    "start": "208159",
    "end": "214560"
  },
  {
    "text": "uh always do upstream first right so if there's some kind of fix we will always",
    "start": "214560",
    "end": "220080"
  },
  {
    "text": "put it in the community but we'll have specialty uh builds available as well so",
    "start": "220080",
    "end": "225120"
  },
  {
    "text": "if you have some kind of special requirements there",
    "start": "225120",
    "end": "230159"
  },
  {
    "text": "we can comply with those and we will also support critical security patches",
    "start": "230159",
    "end": "236799"
  },
  {
    "text": "and our sla is is quite fast there",
    "start": "236799",
    "end": "241920"
  },
  {
    "text": "so what are some of the common problems that you'll see when you go into a multi-cluster mesh",
    "start": "241920",
    "end": "247760"
  },
  {
    "text": "and i'll try to be brief through this so we can get to the workshop as ron says you know we're short on time here",
    "start": "247760",
    "end": "254400"
  },
  {
    "text": "so one of those is going to have to deal with you know dealing with your roles",
    "start": "254400",
    "end": "261280"
  },
  {
    "text": "you know typically in a production environment you've got several teams that have different roles that need to interact with your applications and your",
    "start": "261280",
    "end": "268720"
  },
  {
    "text": "platform and so you'll have you know ones that are providing the",
    "start": "268720",
    "end": "274080"
  },
  {
    "text": "actual services so maybe a an account team and a user team and then a couple of other teams maybe",
    "start": "274080",
    "end": "279919"
  },
  {
    "text": "an sre team and a platform team that also need to interact with these",
    "start": "279919",
    "end": "285360"
  },
  {
    "text": "same resources on your environment",
    "start": "285360",
    "end": "289198"
  },
  {
    "text": "you know some typical things that your consumer teams are going to care about we're going to deal with things like",
    "start": "291199",
    "end": "297199"
  },
  {
    "text": "timeouts retries locality aware load balancing and circuit breaking",
    "start": "297199",
    "end": "302639"
  },
  {
    "text": "uh whereas in some of your other teams and apologies the slides are going a little bit slow here",
    "start": "302639",
    "end": "308960"
  },
  {
    "text": "for me um like your platform owners are going to be worried about",
    "start": "308960",
    "end": "314160"
  },
  {
    "text": "operational concerns or uh restricting communication across",
    "start": "314160",
    "end": "319280"
  },
  {
    "text": "boundaries uh being able to you know do things like ensure that",
    "start": "319280",
    "end": "324320"
  },
  {
    "text": "traffic is encrypted um making sure that you know you have the the right resiliency settings and high",
    "start": "324320",
    "end": "331440"
  },
  {
    "text": "availability set there the the problem comes in that uh istio",
    "start": "331440",
    "end": "336960"
  },
  {
    "text": "doesn't really mirror these abstractions um istio's api closely resembles envoy",
    "start": "336960",
    "end": "344560"
  },
  {
    "text": "instead and so there's a there's a contention here what glue mesh offers is is abstractions",
    "start": "344560",
    "end": "351440"
  },
  {
    "text": "here that make sense to these teams right so by",
    "start": "351440",
    "end": "357199"
  },
  {
    "text": "directly dealing with resources like traffic policy or access policy",
    "start": "357199",
    "end": "363520"
  },
  {
    "text": "now we can we can administer all those lower level apis through translations that the glue",
    "start": "363520",
    "end": "370000"
  },
  {
    "text": "mesh management plane provides the other problem that we see is",
    "start": "370000",
    "end": "375680"
  },
  {
    "text": "obviously just multi-cluster traffic right um multi-cluster traffic you you",
    "start": "375680",
    "end": "382080"
  },
  {
    "text": "know you you can't just configure every single cluster exactly the same um there has to be",
    "start": "382080",
    "end": "389280"
  },
  {
    "text": "intention in and how these resources are defined so that you know if you want to deploy for",
    "start": "389280",
    "end": "395680"
  },
  {
    "text": "instance canary deployment of the review service here v3 into cluster two and not",
    "start": "395680",
    "end": "401600"
  },
  {
    "text": "cluster one your traffic policies need to be aware of that intention",
    "start": "401600",
    "end": "407600"
  },
  {
    "text": "uh likewise if there's some kind of you know resiliency settings for",
    "start": "407600",
    "end": "413440"
  },
  {
    "text": "outlier detection that causes a failover there also needs to be intentionality of",
    "start": "413440",
    "end": "419680"
  },
  {
    "text": "understanding what is the nearest locality to send that traffic",
    "start": "419680",
    "end": "427680"
  },
  {
    "text": "um you know so so these are some of the common problems and we need to make sure",
    "start": "427680",
    "end": "432960"
  },
  {
    "text": "that you know as we're administering a multi-cluster istio system",
    "start": "432960",
    "end": "439520"
  },
  {
    "text": "that we have the correct semantics in place and we're ensuring that our our fault domains are correct",
    "start": "439520",
    "end": "445599"
  },
  {
    "text": "and we're unifying identity across all of these right um istio",
    "start": "445599",
    "end": "452240"
  },
  {
    "text": "upstream does have a way of dealing with this uh unfortunately",
    "start": "452240",
    "end": "458319"
  },
  {
    "text": "it's uh kind of an n plus one problem or an n minus one problem of needing uh access to",
    "start": "458319",
    "end": "465840"
  },
  {
    "text": "the kubernetes api of every remote cluster that needs to be managed",
    "start": "465840",
    "end": "471199"
  },
  {
    "text": "and so this is a kind of an untenable situation like and if you look at",
    "start": "471199",
    "end": "478720"
  },
  {
    "text": "the way that glue mesh handles it and it's taking a little while to refresh my screen here",
    "start": "478720",
    "end": "486479"
  },
  {
    "text": "there we go okay looks like i went past",
    "start": "489039",
    "end": "495520"
  },
  {
    "text": "one and you actually escape out and get to the right here we go okay",
    "start": "495520",
    "end": "503440"
  },
  {
    "text": "we have we have a pull system so we have a glue mash management plane and each of the remote clusters is running an agent",
    "start": "505440",
    "end": "513440"
  },
  {
    "text": "which pulls the configuration for the local istio okay",
    "start": "513440",
    "end": "520880"
  },
  {
    "text": "so we can avoid that problem i'm going to jump ahead a little bit just to save time",
    "start": "520880",
    "end": "527040"
  },
  {
    "text": "what i'd like to do now is to",
    "start": "527040",
    "end": "532399"
  },
  {
    "text": "start into the workshop and if eric or adam or rom has that url that",
    "start": "532720",
    "end": "539279"
  },
  {
    "text": "they can share folks in attendance",
    "start": "539279",
    "end": "544959"
  },
  {
    "text": "and this should be the workshop that we're taking a look at and i'll try to make this bigger so i know that",
    "start": "546720",
    "end": "552160"
  },
  {
    "text": "there's been an issue with being able to see all the text",
    "start": "552160",
    "end": "557680"
  },
  {
    "text": "and i'll hang on here and wait for you to get here um you'll notice that this does say 300",
    "start": "560320",
    "end": "566720"
  },
  {
    "text": "minutes i don't think we'll be able to get through every single challenge here but this should at least give you",
    "start": "566720",
    "end": "573600"
  },
  {
    "text": "a good flavor of what glue mesh can do for you in a",
    "start": "573600",
    "end": "578880"
  },
  {
    "text": "multi-cluster environment",
    "start": "578880",
    "end": "582320"
  },
  {
    "text": "and rob you can just let me know when it's good to move forward",
    "start": "586720",
    "end": "592160"
  },
  {
    "text": "give us two minutes yep",
    "start": "592160",
    "end": "596839"
  },
  {
    "text": "thank you",
    "start": "614560",
    "end": "617800"
  },
  {
    "text": "yes",
    "start": "638560",
    "end": "641560"
  },
  {
    "text": "okay well you're good to go all right great all right so go ahead and hit start track",
    "start": "666480",
    "end": "672320"
  },
  {
    "text": "we're just going to start with the very first uh lab in this and you'll see that there's five here we'll try to go fairly",
    "start": "672320",
    "end": "679760"
  },
  {
    "text": "swiftly but please slow me down if the pace is too fast",
    "start": "679760",
    "end": "686600"
  },
  {
    "text": "it just take a couple of minutes for this to load um you know this this picture here of",
    "start": "690160",
    "end": "697040"
  },
  {
    "text": "course we saw the slide deck to a little bit different looking",
    "start": "697040",
    "end": "703839"
  },
  {
    "text": "but you can see you know all the features that we have here",
    "start": "703839",
    "end": "709200"
  },
  {
    "text": "um if we end up getting to the last lab we also have",
    "start": "709200",
    "end": "714560"
  },
  {
    "text": "a feature that's not listed here which is our glue mesh gateway",
    "start": "714560",
    "end": "721079"
  },
  {
    "text": "uh it's loading for the users that are in the room as well all right great",
    "start": "798880",
    "end": "806399"
  },
  {
    "text": "now i feel like this is the part of where i should have prepared some jokes but uh you never know how long it's going to",
    "start": "807600",
    "end": "813760"
  },
  {
    "text": "take to actually start this environment",
    "start": "813760",
    "end": "818079"
  },
  {
    "text": "so let me just prep you with a little bit of what about what we're going to do here in this environment so",
    "start": "825680",
    "end": "831199"
  },
  {
    "text": "uh glue mash being a management plane is going to be installed um in its own cluster actually i have the start button",
    "start": "831199",
    "end": "838240"
  },
  {
    "text": "now so i'll just click in there and start talking a little bit while we uh while we wait",
    "start": "838240",
    "end": "844320"
  },
  {
    "text": "uh so the topology is going to be that we'll have um",
    "start": "844320",
    "end": "849760"
  },
  {
    "text": "bluemix management playing its own cluster and then we're going to deal with two remote clusters where we're going to deploy the glue mesh enterprise",
    "start": "849760",
    "end": "858240"
  },
  {
    "text": "agents as well as istio okay",
    "start": "858240",
    "end": "864480"
  },
  {
    "text": "all right so first thing we're going to do is uh",
    "start": "864480",
    "end": "871040"
  },
  {
    "text": "this there should be a glue mesh license key in here and we can just uh go to",
    "start": "871040",
    "end": "876240"
  },
  {
    "text": "make sure that that's all provisioned correctly hey will can you zoom in a couple of",
    "start": "876240",
    "end": "881360"
  },
  {
    "text": "times yeah i will do that",
    "start": "881360",
    "end": "885839"
  },
  {
    "text": "is that better or more",
    "start": "891040",
    "end": "894800"
  },
  {
    "text": "okay that good cool all right thanks all right so just make sure",
    "start": "896240",
    "end": "902160"
  },
  {
    "text": "you've got a glue mesh license key um this this stuff won't work without it this is enterprise features",
    "start": "902160",
    "end": "909360"
  },
  {
    "text": "all right so as long as that is set then the next thing we're going to do is",
    "start": "909360",
    "end": "914639"
  },
  {
    "text": "we're going to install the command line mesh cuddle",
    "start": "914639",
    "end": "921880"
  },
  {
    "text": "and this will provide us so some convenience factor with with dealing with glue mesh",
    "start": "926160",
    "end": "932880"
  },
  {
    "text": "um we could also install it with helm and just keep ctl",
    "start": "932880",
    "end": "938160"
  },
  {
    "text": "but there's also uh some some nice features of mesh cuddle where we can do things like um",
    "start": "938160",
    "end": "945040"
  },
  {
    "text": "check on the health of our distributed mesh",
    "start": "945040",
    "end": "950720"
  },
  {
    "text": "all right and then i'll export the path so we can get to that mesh cuddle and now we're we're going to get down",
    "start": "951680",
    "end": "958240"
  },
  {
    "text": "pull down the helm chart for glue mesh enterprise and do the installation",
    "start": "958240",
    "end": "965279"
  },
  {
    "text": "in the management plane all right",
    "start": "965279",
    "end": "970800"
  },
  {
    "text": "and so just a couple of things about this here",
    "start": "970800",
    "end": "976079"
  },
  {
    "text": "we are installing version 115 we're also",
    "start": "977199",
    "end": "983600"
  },
  {
    "text": "rolling out our enterprise networking pods here so uh once we've once we've accomplished",
    "start": "983600",
    "end": "991120"
  },
  {
    "text": "that installation we're gonna we're going to get the",
    "start": "991120",
    "end": "996160"
  },
  {
    "text": "endpoint uh for that enterprise networking pod because we'll need that",
    "start": "996160",
    "end": "1002079"
  },
  {
    "text": "when we register our agents on the remote clusters okay",
    "start": "1002079",
    "end": "1008519"
  },
  {
    "text": "all right so we'll use mesh cuddle to register our agents and here's",
    "start": "1012639",
    "end": "1020560"
  },
  {
    "text": "where the convenience of mesh cuddle comes into play you could also do this",
    "start": "1020560",
    "end": "1026880"
  },
  {
    "text": "with helm it's just a little more work on your side because mesh cuddle is doing some work behind the scenes",
    "start": "1026880",
    "end": "1033038"
  },
  {
    "text": "to create those objects that that are needed on the",
    "start": "1033039",
    "end": "1038079"
  },
  {
    "text": "management plane and we'll take a look at that those objects in just a minute as soon as",
    "start": "1038079",
    "end": "1044880"
  },
  {
    "text": "these get uh installed the other nice thing about using mesh cuttle here is that you can get some",
    "start": "1044880",
    "end": "1052400"
  },
  {
    "text": "feedback about the progression of the registration of the remote clusters so",
    "start": "1052400",
    "end": "1057919"
  },
  {
    "text": "as you saw with cluster one after it was registered it gave us some green check marks",
    "start": "1057919",
    "end": "1064559"
  },
  {
    "text": "to tell us everything was good and they were registered with the management plan",
    "start": "1064559",
    "end": "1070559"
  },
  {
    "text": "all right so that succeeded so let's take a look at",
    "start": "1071760",
    "end": "1077360"
  },
  {
    "text": "what objects got created within the management plane we have two kubernetes",
    "start": "1077360",
    "end": "1082960"
  },
  {
    "text": "cluster objects here cluster one and cluster two",
    "start": "1082960",
    "end": "1088640"
  },
  {
    "text": "and these represent our two remote clusters",
    "start": "1088640",
    "end": "1094760"
  },
  {
    "text": "we also want to install some add-ons",
    "start": "1095760",
    "end": "1102400"
  },
  {
    "text": "and this will install some extra feature sets into our remote clusters and one of those is going to be",
    "start": "1102400",
    "end": "1110160"
  },
  {
    "text": "the glue mesh gateway that we'll we'll use later on",
    "start": "1110160",
    "end": "1115279"
  },
  {
    "text": "all right so we just all we've done so far is created the name spaces for those glue mesh add-ons",
    "start": "1116160",
    "end": "1122880"
  },
  {
    "text": "and then labeled them so that istio will",
    "start": "1122880",
    "end": "1128080"
  },
  {
    "text": "inject side cars into those pods right next we'll pull down",
    "start": "1128080",
    "end": "1134960"
  },
  {
    "text": "the helm repo for the enterprise agent that's going to install onto our remote clusters",
    "start": "1134960",
    "end": "1142720"
  },
  {
    "text": "and before i hit enter here you'll see a few things that are being set as booleans um",
    "start": "1143919",
    "end": "1151919"
  },
  {
    "text": "one is the enterprise agent enabled um and we're going to turn that on just a",
    "start": "1151919",
    "end": "1158080"
  },
  {
    "text": "bit uh the rate limiter enabled so we have a rate limiter feature as well and then",
    "start": "1158080",
    "end": "1164480"
  },
  {
    "text": "external auth service and that's another feature that we have in our glue mesh gateway",
    "start": "1164480",
    "end": "1171120"
  },
  {
    "text": "okay so that was installed in both of the remote clusters",
    "start": "1171840",
    "end": "1176880"
  },
  {
    "text": "lastly we're going to use one of those glue mesh resources that we pointed out",
    "start": "1176880",
    "end": "1183679"
  },
  {
    "text": "on the slides so that [Music] the istio ingress gateway can reach the",
    "start": "1183679",
    "end": "1192320"
  },
  {
    "text": "glue mesh add-ons pods so before i",
    "start": "1192320",
    "end": "1198080"
  },
  {
    "text": "hit enter on this we can take a look at this in the bigger window you'll see this is our our access policy",
    "start": "1198080",
    "end": "1205600"
  },
  {
    "text": "here uh we are using a source selector of the istio ingress gateway on both cluster",
    "start": "1205600",
    "end": "1211840"
  },
  {
    "text": "one and cluster two and then we're matching that against the",
    "start": "1211840",
    "end": "1216880"
  },
  {
    "text": "blue mesh add-ons name space as our destination and so this opens up",
    "start": "1216880",
    "end": "1225039"
  },
  {
    "text": "the authorization within istio",
    "start": "1225039",
    "end": "1229919"
  },
  {
    "text": "all right so now we're going to deploy istio and is there anybody that needs me",
    "start": "1230159",
    "end": "1235840"
  },
  {
    "text": "to slow down or space okay at this point",
    "start": "1235840",
    "end": "1239840"
  },
  {
    "text": "silence is golden all right we're good so we'll pull down istio cuddle",
    "start": "1245280",
    "end": "1251840"
  },
  {
    "text": "so that we can install this too",
    "start": "1251840",
    "end": "1256440"
  },
  {
    "text": "all right and now let's deploy istio on our first cluster",
    "start": "1278159",
    "end": "1285480"
  },
  {
    "text": "uh the istio operator for cluster one can be found",
    "start": "1295280",
    "end": "1301280"
  },
  {
    "text": "in our files here so if we want to take a look at exactly how we're configuring that",
    "start": "1301280",
    "end": "1306559"
  },
  {
    "text": "uh this is probably a good way to take a look at that um some of the some of the key aspects of this issue operator",
    "start": "1306559",
    "end": "1313679"
  },
  {
    "text": "install for these clusters are one we're establishing",
    "start": "1313679",
    "end": "1319600"
  },
  {
    "text": "um the the trust domain within the specific cluster right so cluster one",
    "start": "1319600",
    "end": "1324720"
  },
  {
    "text": "has the trust domain cluster one the other that we're going to take a look at is",
    "start": "1324720",
    "end": "1331200"
  },
  {
    "text": "this envoy metric service and what we're doing here is we're using the",
    "start": "1331200",
    "end": "1337200"
  },
  {
    "text": "enterprise agent so that we can send metrics back to the management plane through that",
    "start": "1337200",
    "end": "1344000"
  },
  {
    "text": "through that configuration okay",
    "start": "1344000",
    "end": "1349679"
  },
  {
    "text": "and if you want to take a look at the istio ingress gateway that's also there",
    "start": "1350320",
    "end": "1357919"
  },
  {
    "text": "all right so we've done cluster one let's go ahead and do cluster two",
    "start": "1357919",
    "end": "1362960"
  },
  {
    "text": "and while that's processing let me just take a look at the cluster two yaml it looks very similar",
    "start": "1367520",
    "end": "1373280"
  },
  {
    "text": "to cluster one yaml but you'll notice that it has its own trust domain here",
    "start": "1373280",
    "end": "1378799"
  },
  {
    "text": "but it's part of mesh id mesh one so if we go back and look here",
    "start": "1379440",
    "end": "1386559"
  },
  {
    "text": "istio operator for cluster one is also part of mesh one",
    "start": "1386840",
    "end": "1392880"
  },
  {
    "text": "all right so those are done so let's just check and make sure that our pods are ready in istio system",
    "start": "1394559",
    "end": "1401600"
  },
  {
    "text": "first of all check cluster one yeah looks good",
    "start": "1401600",
    "end": "1407360"
  },
  {
    "text": "now let's check cluster two",
    "start": "1407360",
    "end": "1410880"
  },
  {
    "text": "all right everything looks good there now what we'd like to do for",
    "start": "1413679",
    "end": "1420080"
  },
  {
    "text": "when we deploy some of our applications is",
    "start": "1420080",
    "end": "1425279"
  },
  {
    "text": "point to the the ingress on",
    "start": "1425279",
    "end": "1431360"
  },
  {
    "text": "on cluster one so let's grab that and put it in an environment",
    "start": "1431360",
    "end": "1437200"
  },
  {
    "text": "variable that's going to be our endpoint http gateway cluster one",
    "start": "1437200",
    "end": "1442880"
  },
  {
    "text": "here and then we'll also at the same time grab the https endpoint",
    "start": "1442880",
    "end": "1450559"
  },
  {
    "text": "right now it's time to deploy an application we'll use the ever popular istio example of book info",
    "start": "1452559",
    "end": "1460640"
  },
  {
    "text": "should be familiar to users of istio",
    "start": "1463840",
    "end": "1468640"
  },
  {
    "text": "and we'll talk a little bit about how we're deploying this to uh each cluster",
    "start": "1471200",
    "end": "1476240"
  },
  {
    "text": "in just a second but let's just check and make sure",
    "start": "1476240",
    "end": "1482159"
  },
  {
    "text": "running it takes a little bit to initialize this",
    "start": "1482320",
    "end": "1487399"
  },
  {
    "text": "yeah so while we're waiting for those to initialize we can just take a look at what we did up here with applying our",
    "start": "1500320",
    "end": "1505760"
  },
  {
    "text": "book info yaml so you'll see the version not in v3 uh label here",
    "start": "1505760",
    "end": "1512559"
  },
  {
    "text": "and that is corresponding to our reviews service",
    "start": "1512559",
    "end": "1518559"
  },
  {
    "text": "so you'll see on cluster one we deployed only version v1 and v2 of",
    "start": "1518559",
    "end": "1524880"
  },
  {
    "text": "reviews all right everything's up and running",
    "start": "1524880",
    "end": "1529919"
  },
  {
    "text": "so we can move to our cluster two on cluster two we're not going to use",
    "start": "1529919",
    "end": "1535840"
  },
  {
    "text": "that same nomenclature for labeling and so you'll see",
    "start": "1535840",
    "end": "1543679"
  },
  {
    "text": "version three gets deployed as well",
    "start": "1543679",
    "end": "1548000"
  },
  {
    "text": "all right on on each cluster we're also creating the book info gateway",
    "start": "1551279",
    "end": "1556799"
  },
  {
    "text": "and virtual service so that it's connected to our ingress gateway on each cluster",
    "start": "1556799",
    "end": "1564480"
  },
  {
    "text": "let's just make sure things are running",
    "start": "1565120",
    "end": "1569400"
  },
  {
    "text": "all right cool that one came up a lot quicker and and if you want a kind of a",
    "start": "1570400",
    "end": "1577440"
  },
  {
    "text": "picture diagram of what we did there this is a very nice display so",
    "start": "1577440",
    "end": "1584000"
  },
  {
    "text": "uh here we've got both ingresses exposed externally",
    "start": "1584000",
    "end": "1589200"
  },
  {
    "text": "you can see we've got book info product page reviews ratings and details deployed to both clusters",
    "start": "1589200",
    "end": "1597760"
  },
  {
    "text": "but the cluster on the left hand side here only has versions one and two",
    "start": "1597760",
    "end": "1604159"
  },
  {
    "text": "everything else is wired up all right",
    "start": "1604159",
    "end": "1611400"
  },
  {
    "text": "so let's take a look at our new application that we just deployed if we",
    "start": "1612640",
    "end": "1618559"
  },
  {
    "text": "paste this in here we should be able to port forward to that connection and then as you go up to the top in your book",
    "start": "1618559",
    "end": "1625120"
  },
  {
    "text": "info tab you should see the book info application so if you don't see that there try to",
    "start": "1625120",
    "end": "1631760"
  },
  {
    "text": "hit refresh or just check to make sure that you port",
    "start": "1631760",
    "end": "1637200"
  },
  {
    "text": "forwarded or didn't miss any steps",
    "start": "1637200",
    "end": "1641559"
  },
  {
    "text": "all right so let me cancel that out i'm actually gonna have",
    "start": "1643360",
    "end": "1649279"
  },
  {
    "text": "that run well we'll come back to that if we need you know we'll come back to it",
    "start": "1649279",
    "end": "1655840"
  },
  {
    "text": "so at this point we've just done standard application deployment",
    "start": "1656799",
    "end": "1662320"
  },
  {
    "text": "onto our remote istio clusters but what we'd like to do is take advantage of the fact that you know we have this",
    "start": "1662320",
    "end": "1668159"
  },
  {
    "text": "management plan there um it could make some decisions for us that",
    "start": "1668159",
    "end": "1673360"
  },
  {
    "text": "would you know that would alleviate some of the pains that we would have of managing each cluster",
    "start": "1673360",
    "end": "1680399"
  },
  {
    "text": "individually so we're going to talk about the virtual mesh next",
    "start": "1680399",
    "end": "1686000"
  },
  {
    "text": "all right okay so uh one other thing to see",
    "start": "1686000",
    "end": "1692480"
  },
  {
    "text": "is that right now we're not running with mtls at all and if we inspect",
    "start": "1692480",
    "end": "1698960"
  },
  {
    "text": "reviews v1 on cluster 1 we can see that basically it's running without any certificates",
    "start": "1698960",
    "end": "1705679"
  },
  {
    "text": "defined so no mtls and we would like to fix that",
    "start": "1705679",
    "end": "1714080"
  },
  {
    "text": "um pure authentication in the seo system namespace will enable",
    "start": "1714080",
    "end": "1720320"
  },
  {
    "text": "uh strict if you put it in mtls strict mode and so we can ensure that our mesh is",
    "start": "1720320",
    "end": "1727919"
  },
  {
    "text": "running with mtls we do that to both clusters",
    "start": "1727919",
    "end": "1734399"
  },
  {
    "text": "now if we take another look at that same reviews pod we should see",
    "start": "1734399",
    "end": "1740640"
  },
  {
    "text": "a certificate that's been deployed and you can see this is basically just",
    "start": "1740640",
    "end": "1746159"
  },
  {
    "text": "the um [Music] you know self-signed generated one that comes from istioca",
    "start": "1746159",
    "end": "1752799"
  },
  {
    "text": "so it has our cluster one that we had specified for our trust domain",
    "start": "1752799",
    "end": "1758799"
  },
  {
    "text": "coming directly from istio",
    "start": "1758799",
    "end": "1762679"
  },
  {
    "text": "all right just to make sure that it happened on both systems we can take a look at",
    "start": "1767200",
    "end": "1772960"
  },
  {
    "text": "you know reviews on cluster two and we see our trust domain there for cluster two so we",
    "start": "1772960",
    "end": "1779200"
  },
  {
    "text": "verify the istio is doing what it's supposed to do",
    "start": "1779200",
    "end": "1783278"
  },
  {
    "text": "all right now what if we wanted the management plane",
    "start": "1786240",
    "end": "1792399"
  },
  {
    "text": "to take care of this for us so let's take a look at how to do that",
    "start": "1792399",
    "end": "1798480"
  },
  {
    "text": "so this virtual mesh resource what that does is allows us to",
    "start": "1798480",
    "end": "1805039"
  },
  {
    "text": "bind together meshes across clusters so you can see here",
    "start": "1805039",
    "end": "1810480"
  },
  {
    "text": "we've got a virtual mesh resource we are",
    "start": "1810480",
    "end": "1815679"
  },
  {
    "text": "naming our remote meshes here this geodestio system cluster one and cluster",
    "start": "1815679",
    "end": "1820880"
  },
  {
    "text": "two in the blue mesh namespace and we for our mtls config we want them",
    "start": "1820880",
    "end": "1827919"
  },
  {
    "text": "to have a shared room trust right so for this example we're going to have",
    "start": "1827919",
    "end": "1836320"
  },
  {
    "text": "the management plan create that root of trust and allow it to",
    "start": "1836399",
    "end": "1842640"
  },
  {
    "text": "generate the certificates for the remote clusters",
    "start": "1842640",
    "end": "1847559"
  },
  {
    "text": "so let's just take a look at this picture of how that works here",
    "start": "1853440",
    "end": "1858640"
  },
  {
    "text": "so what's happening on the glue mesh management cluster is we've created a shared route here and",
    "start": "1858640",
    "end": "1865519"
  },
  {
    "text": "we have a ca along with a",
    "start": "1865519",
    "end": "1870559"
  },
  {
    "text": "csr that gets [Music] configured and pushed down to these cert",
    "start": "1870559",
    "end": "1876880"
  },
  {
    "text": "agents that are on our remote clusters through our enterprise agent",
    "start": "1876880",
    "end": "1882960"
  },
  {
    "text": "so now sdod can utilize that to sign certificates for the mesh",
    "start": "1882960",
    "end": "1892039"
  },
  {
    "text": "all right so we should be able to see this actually take effect",
    "start": "1893360",
    "end": "1898880"
  },
  {
    "text": "let's take another look at let's take a look at one of the secrets that we've got in istio system here",
    "start": "1898880",
    "end": "1906640"
  },
  {
    "text": "okay uh so one of the things you can see is that labels here is labeled by",
    "start": "1906640",
    "end": "1912880"
  },
  {
    "text": "glue mesh for cluster one all right and there is",
    "start": "1912880",
    "end": "1919519"
  },
  {
    "text": "ca cert along with key and the search chain",
    "start": "1919519",
    "end": "1925200"
  },
  {
    "text": "and if we take a look at cluster two we should see something very similar there",
    "start": "1925200",
    "end": "1933559"
  },
  {
    "text": "all right",
    "start": "1935919",
    "end": "1938320"
  },
  {
    "text": "now um what we'd like to do is see did this take effect into our",
    "start": "1942880",
    "end": "1948799"
  },
  {
    "text": "our actual pause of running within istio so we take a look at that we've used v1",
    "start": "1948799",
    "end": "1954720"
  },
  {
    "text": "um you know you don't you don't see that our issuer here",
    "start": "1954720",
    "end": "1960880"
  },
  {
    "text": "is that same cluster one that used to be right um it looks a little bit different now",
    "start": "1960880",
    "end": "1966559"
  },
  {
    "text": "we've got glue mesh as as the owner",
    "start": "1966559",
    "end": "1972640"
  },
  {
    "text": "and we've got the corresponding certificate change that came from our secret",
    "start": "1972640",
    "end": "1979679"
  },
  {
    "text": "now this next part all right so we're also going to compare with what we got on the second cluster",
    "start": "1984480",
    "end": "1991200"
  },
  {
    "text": "here you can see you know the same thing has",
    "start": "1991200",
    "end": "1997200"
  },
  {
    "text": "happened on cluster 2 as well",
    "start": "1997200",
    "end": "2001120"
  },
  {
    "text": "now what we'd like to do is do a little validation on the the root cert right so",
    "start": "2002559",
    "end": "2010080"
  },
  {
    "text": "uh this one's a little tricky because the copy and paste buffer is a little bit small",
    "start": "2010080",
    "end": "2016720"
  },
  {
    "text": "uh for this one so i think what we can do is",
    "start": "2016720",
    "end": "2022640"
  },
  {
    "text": "uh just capture what we just got and send it into",
    "start": "2022640",
    "end": "2028159"
  },
  {
    "text": "temp cert okay and then",
    "start": "2028159",
    "end": "2033519"
  },
  {
    "text": "we're just going to edit that",
    "start": "2033519",
    "end": "2038279"
  },
  {
    "text": "and if you don't want to do this and just want to follow along with what i'm doing that's totally fine",
    "start": "2048399",
    "end": "2055520"
  },
  {
    "text": "and you can just see for yourself you know what this is going to do so",
    "start": "2057359",
    "end": "2063040"
  },
  {
    "text": "using openssl we can take a look at that insert and inspect it and",
    "start": "2063040",
    "end": "2070398"
  },
  {
    "text": "see exactly what it's got going on in there uh so one of the things you'll",
    "start": "2070399",
    "end": "2075599"
  },
  {
    "text": "you'll notice here is this sam or this subject alternative name",
    "start": "2075599",
    "end": "2081440"
  },
  {
    "text": "is our spiffy id for the service account for book info",
    "start": "2081440",
    "end": "2089280"
  },
  {
    "text": "ratings and that is specific to cluster two there so we know we have identity within",
    "start": "2089280",
    "end": "2097200"
  },
  {
    "text": "this within the certificate",
    "start": "2097200",
    "end": "2102520"
  },
  {
    "text": "all right cool so that is the end of lab one um and how how is everybody are they caught",
    "start": "2102960",
    "end": "2110320"
  },
  {
    "text": "up",
    "start": "2110320",
    "end": "2113320"
  },
  {
    "text": "and keep moving right along so hit the check button at the bottom and",
    "start": "2117280",
    "end": "2122640"
  },
  {
    "text": "that'll take you back to the timeline where we'll move to the next",
    "start": "2122640",
    "end": "2128160"
  },
  {
    "text": "yeah step able to keep up here all good good cool awesome",
    "start": "2129440",
    "end": "2136440"
  },
  {
    "text": "all right shouldn't take too long to do that the next lab is focused on access control",
    "start": "2150640",
    "end": "2158880"
  },
  {
    "text": "all right so you know in the previous lab we basically federated a little",
    "start": "2158880",
    "end": "2164320"
  },
  {
    "text": "configuration to create our virtual mesh and ensure that certificates were",
    "start": "2164320",
    "end": "2171440"
  },
  {
    "text": "managed by the management plane so in this one we're going to focus on",
    "start": "2171440",
    "end": "2177599"
  },
  {
    "text": "is the istio access control but from from our higher",
    "start": "2177599",
    "end": "2183359"
  },
  {
    "text": "level resources um",
    "start": "2183359",
    "end": "2189200"
  },
  {
    "text": "so one thing we need to do is is to modify our virtual mesh quickly to enable this",
    "start": "2189200",
    "end": "2196800"
  },
  {
    "text": "and this is kind of i think very nice if you're familiar with the way that",
    "start": "2196800",
    "end": "2203359"
  },
  {
    "text": "istio works natively in order to set up the policy where",
    "start": "2203359",
    "end": "2209680"
  },
  {
    "text": "you're operating out of zero trust you need to ensure that each application name space has an",
    "start": "2209680",
    "end": "2216320"
  },
  {
    "text": "authorization policy that will deny uh traffic",
    "start": "2216320",
    "end": "2221839"
  },
  {
    "text": "um here we've got you know as part of the virtual mesh we've got the easy button here",
    "start": "2221839",
    "end": "2227760"
  },
  {
    "text": "which is our global access policy enabled this will handle all that trivial task",
    "start": "2227760",
    "end": "2234720"
  },
  {
    "text": "for you so now we have that enabled",
    "start": "2234720",
    "end": "2240079"
  },
  {
    "text": "and what we're going to do next is we're going to verify that this is enabled",
    "start": "2240640",
    "end": "2247119"
  },
  {
    "text": "so take this next one and actually go to terminal 2 and let's paste that command in",
    "start": "2247119",
    "end": "2254480"
  },
  {
    "text": "okay so we can forward uh to our book info and now if you go visit book info you should see",
    "start": "2254480",
    "end": "2262320"
  },
  {
    "text": "that your access is divided so we know our access policy is working here",
    "start": "2262320",
    "end": "2270000"
  },
  {
    "text": "uh so now what we need to do is create access policies that will open up",
    "start": "2270000",
    "end": "2276240"
  },
  {
    "text": "the path from our ingress gateway back to our application and also all the",
    "start": "2276240",
    "end": "2284560"
  },
  {
    "text": "the the traffic that needs to go from service to service all right so let's start with the",
    "start": "2284560",
    "end": "2290240"
  },
  {
    "text": "ingress gateway and the ingress gateway will need to reach to the product page",
    "start": "2290240",
    "end": "2297680"
  },
  {
    "text": "so for both cluster one and cluster two we're going to enable this for product",
    "start": "2297680",
    "end": "2303920"
  },
  {
    "text": "page and note that in our our destination selector we're not specifying",
    "start": "2303920",
    "end": "2310880"
  },
  {
    "text": "a cluster so it means it will it'll apply to both clusters all right",
    "start": "2310880",
    "end": "2317200"
  },
  {
    "text": "just with that simple fix if we go back and refresh our book info page",
    "start": "2317200",
    "end": "2322480"
  },
  {
    "text": "you should see now and it might take just a second for that configuration to be put pushed out",
    "start": "2322480",
    "end": "2330079"
  },
  {
    "text": "you should see that we can now get back to our book info page uh but some parts aren't working right",
    "start": "2330079",
    "end": "2336800"
  },
  {
    "text": "we can't get to the product details we can't get to the ratings we can't get to the reviews",
    "start": "2336800",
    "end": "2342400"
  },
  {
    "text": "because we haven't enabled that access yet all right so our next",
    "start": "2342400",
    "end": "2348640"
  },
  {
    "text": "task is going to be to turn that on as well",
    "start": "2348640",
    "end": "2354240"
  },
  {
    "text": "so here what we're doing is going for the product page on cluster one",
    "start": "2354240",
    "end": "2360160"
  },
  {
    "text": "and we're going to enable access to details and reviews",
    "start": "2360160",
    "end": "2366000"
  },
  {
    "text": "all right and just should take a couple of seconds but if we refresh again",
    "start": "2367280",
    "end": "2374400"
  },
  {
    "text": "now we get to see book details and we also see book reviews",
    "start": "2375520",
    "end": "2380880"
  },
  {
    "text": "um folks that know book info pretty well know that",
    "start": "2380880",
    "end": "2386320"
  },
  {
    "text": "this looks the same as when you're going to",
    "start": "2386320",
    "end": "2391760"
  },
  {
    "text": "reviews v1 right just so so just to make sure you know you can",
    "start": "2391760",
    "end": "2396800"
  },
  {
    "text": "refresh a few times you can see you know rating services currently",
    "start": "2396800",
    "end": "2402000"
  },
  {
    "text": "unavailable all right",
    "start": "2402000",
    "end": "2407599"
  },
  {
    "text": "so if we want to be able to also see reviews",
    "start": "2407599",
    "end": "2414400"
  },
  {
    "text": "let's add that as well so now from reviews we're able to get reviews",
    "start": "2415680",
    "end": "2421760"
  },
  {
    "text": "but we can't get to ratings so we'll also enable that",
    "start": "2421760",
    "end": "2427520"
  },
  {
    "text": "and refresh one more time and",
    "start": "2428640",
    "end": "2435280"
  },
  {
    "text": "we now see black stars so we we should be alternating if you refresh a few times",
    "start": "2435280",
    "end": "2440960"
  },
  {
    "text": "between no stars and black stars because we're going to the ingress on cluster one",
    "start": "2440960",
    "end": "2447200"
  },
  {
    "text": "right which has both versions one and two there",
    "start": "2447200",
    "end": "2453318"
  },
  {
    "text": "we flew through that but we're actually through with that step as",
    "start": "2457440",
    "end": "2463680"
  },
  {
    "text": "well so we want to move on we can move on",
    "start": "2463680",
    "end": "2470920"
  },
  {
    "text": "and while this uh next challenge is is uh setting up",
    "start": "2482160",
    "end": "2488079"
  },
  {
    "text": "you can see that uh looks like we're going to talk about failover right",
    "start": "2488079",
    "end": "2494400"
  },
  {
    "text": "what happens when reviews is unavailable on cluster we'll call it cluster west",
    "start": "2494400",
    "end": "2501838"
  },
  {
    "text": "all right here's where we start looking at traffic policy all right the first thing we're going to",
    "start": "2505599",
    "end": "2511680"
  },
  {
    "text": "do actually is just just look at traffic policy from the standpoint of",
    "start": "2511680",
    "end": "2517920"
  },
  {
    "text": "putting it in place some of istio's false injection",
    "start": "2517920",
    "end": "2523920"
  },
  {
    "text": "what we'd like to do is anytime that we go to version two of reviews",
    "start": "2523920",
    "end": "2530400"
  },
  {
    "text": "let's add a little delay there so we're gonna have a fixed delay of two seconds",
    "start": "2530400",
    "end": "2536400"
  },
  {
    "text": "any time we visit version two reviews",
    "start": "2536400",
    "end": "2541839"
  },
  {
    "text": "and so you'll see that percentage there is is a hundred percent right and now this will take a a few",
    "start": "2541839",
    "end": "2549200"
  },
  {
    "text": "um first we have to set our port forward but this will this will take a few",
    "start": "2549200",
    "end": "2554560"
  },
  {
    "text": "refreshes potentially of our book info so that we can see",
    "start": "2554560",
    "end": "2559760"
  },
  {
    "text": "you know when we hit the black stars that it's gonna take a little bit for us to access that",
    "start": "2559760",
    "end": "2567599"
  },
  {
    "text": "all right so there's v1 this is probably v2 yeah that's v2 and",
    "start": "2568240",
    "end": "2574880"
  },
  {
    "text": "you can see it took just a little bit longer for that page to refresh so we're",
    "start": "2574880",
    "end": "2580400"
  },
  {
    "text": "hitting our our false injection there so",
    "start": "2580400",
    "end": "2586079"
  },
  {
    "text": "and now that we've got false injection in place what we can do is take advantage of that",
    "start": "2586079",
    "end": "2593200"
  },
  {
    "text": "to check for you know some kind of timeout right",
    "start": "2593200",
    "end": "2600000"
  },
  {
    "text": "so we can set up a policy and say that all right anytime we go to",
    "start": "2601119",
    "end": "2607920"
  },
  {
    "text": "the the reviews and um it's taking longer than half a second",
    "start": "2607920",
    "end": "2615440"
  },
  {
    "text": "then where our traffic policy here is going to to kick into effect",
    "start": "2615440",
    "end": "2622240"
  },
  {
    "text": "all right and now if we go back",
    "start": "2622240",
    "end": "2627680"
  },
  {
    "text": "and refresh here",
    "start": "2627680",
    "end": "2633799"
  },
  {
    "text": "this might take just a little bit to start to see",
    "start": "2636480",
    "end": "2642720"
  },
  {
    "text": "an error on the page okay and there we got it so sorry product reviews are currently",
    "start": "2645440",
    "end": "2652640"
  },
  {
    "text": "unavailable for this book i think in an earlier um",
    "start": "2652640",
    "end": "2657920"
  },
  {
    "text": "an early workshop that we did when we were checking the uh envoy config we got to see that",
    "start": "2657920",
    "end": "2665119"
  },
  {
    "text": "there was like default retry of two right and so that could delay the you know",
    "start": "2665119",
    "end": "2672480"
  },
  {
    "text": "being able to perceive this kind of error here well let's let's go back",
    "start": "2672480",
    "end": "2679200"
  },
  {
    "text": "actually to where we started this lab before we move on to",
    "start": "2679200",
    "end": "2684319"
  },
  {
    "text": "handling multi-cluster traffic okay so we'll remove both those policies that we just created",
    "start": "2684319",
    "end": "2693040"
  },
  {
    "text": "and now let me take a look at this",
    "start": "2693040",
    "end": "2699040"
  },
  {
    "text": "diagram again this is just kind of a reminder of our initial setup that we've got we've used e3 over here",
    "start": "2699040",
    "end": "2705839"
  },
  {
    "text": "we'd like to be able to route some traffic over here and so now we're going to set up a traffic policy that allows us to do that",
    "start": "2705839",
    "end": "2714800"
  },
  {
    "text": "all right let me copy this over here and then we can talk through this before we apply it um",
    "start": "2717520",
    "end": "2723200"
  },
  {
    "text": "so here we've got our traffic policy and and our destination that we're going to",
    "start": "2723200",
    "end": "2728240"
  },
  {
    "text": "is the reviews application on cluster one in this case we're going to apply a",
    "start": "2728240",
    "end": "2733280"
  },
  {
    "text": "traffic shift and most of that traffic in fact 75 percent",
    "start": "2733280",
    "end": "2738319"
  },
  {
    "text": "of that we're going to divert over to cluster 2 reviews okay",
    "start": "2738319",
    "end": "2743599"
  },
  {
    "text": "and then we'll keep 15 or 25 percent",
    "start": "2743599",
    "end": "2748880"
  },
  {
    "text": "here on cluster 1 between both v1 and v2",
    "start": "2748880",
    "end": "2755520"
  },
  {
    "text": "all right so let's apply that and you'll see just how easy and fast it",
    "start": "2755520",
    "end": "2761920"
  },
  {
    "text": "is to actually divert this traffic now when we go back to book info and we start to refresh",
    "start": "2761920",
    "end": "2770400"
  },
  {
    "text": "you'll start to see and there's some of our old traffic",
    "start": "2771119",
    "end": "2776560"
  },
  {
    "text": "policies probably taking an effect there still",
    "start": "2776560",
    "end": "2781119"
  },
  {
    "text": "all right so actually what we're seeing is kind of curious we're seeing rating services",
    "start": "2782640",
    "end": "2787680"
  },
  {
    "text": "currently unavailable quite a bit right so uh maybe that 75 isn't working so what's",
    "start": "2787680",
    "end": "2794480"
  },
  {
    "text": "happening well what's happening is we didn't actually open up access",
    "start": "2794480",
    "end": "2801440"
  },
  {
    "text": "across the cluster so when we've got our",
    "start": "2801440",
    "end": "2806480"
  },
  {
    "text": "product page that's trying to reach reviews we didn't allow product page to actually go",
    "start": "2806480",
    "end": "2812319"
  },
  {
    "text": "and talk or sorry reviews talking to ratings we didn't we didn't allow it to talk",
    "start": "2812319",
    "end": "2817520"
  },
  {
    "text": "across clusters so we need to turn that on so we go back here and take a look at",
    "start": "2817520",
    "end": "2824640"
  },
  {
    "text": "our new access policy now what we're going to allow is book info",
    "start": "2824640",
    "end": "2830000"
  },
  {
    "text": "reviews from either cluster is going to be allowed to talk to ratings on on both clusters",
    "start": "2830000",
    "end": "2837040"
  },
  {
    "text": "all right let's apply that and now let's refresh again and",
    "start": "2837040",
    "end": "2843760"
  },
  {
    "text": "hopefully we should see better behavior ah and we do all right we got a red stars",
    "start": "2843760",
    "end": "2850480"
  },
  {
    "text": "so we know now we are",
    "start": "2850480",
    "end": "2855359"
  },
  {
    "text": "diverting traffic according to the shift that we wanted",
    "start": "2856000",
    "end": "2861119"
  },
  {
    "text": "okay next we're going to talk about traffic failover um and so this is kind of a",
    "start": "2864720",
    "end": "2870880"
  },
  {
    "text": "variation on this multi-cluster traffic so let's get back to our starting state",
    "start": "2870880",
    "end": "2876640"
  },
  {
    "text": "by removing the traffic policy that we just created",
    "start": "2876640",
    "end": "2881599"
  },
  {
    "text": "okay and you know now that we've done that let's just verify uh that we're not",
    "start": "2884400",
    "end": "2889760"
  },
  {
    "text": "seeing red stars anymore we should just be on cluster one there's version one there's version two",
    "start": "2889760",
    "end": "2897280"
  },
  {
    "text": "and i don't see any more red stars so it looks like we're good back in this steady state",
    "start": "2897280",
    "end": "2904640"
  },
  {
    "text": "all right um and so in this instance if you see our diagram",
    "start": "2905119",
    "end": "2910800"
  },
  {
    "text": "here on the right hand side you'll see we're going to do is is create a condition where",
    "start": "2910800",
    "end": "2916880"
  },
  {
    "text": "reviews appears to be unavailable right",
    "start": "2916880",
    "end": "2921920"
  },
  {
    "text": "before we do that we're going to create a virtual destination that's going to be",
    "start": "2922240",
    "end": "2927440"
  },
  {
    "text": "applied as a global policy across the clusters",
    "start": "2927440",
    "end": "2935040"
  },
  {
    "text": "and uh you'll see here with this virtual destination that we have a host name that we've called",
    "start": "2935040",
    "end": "2941480"
  },
  {
    "text": "reviews.global that we'll use to route to and this will be routed to",
    "start": "2941480",
    "end": "2948640"
  },
  {
    "text": "if we see some outlier detection here you know",
    "start": "2948640",
    "end": "2955520"
  },
  {
    "text": "five seconds consecutive errors here on the reviews application",
    "start": "2955520",
    "end": "2963680"
  },
  {
    "text": "now that we've created that virtual destination we can",
    "start": "2968800",
    "end": "2974400"
  },
  {
    "text": "use that virtual destination in our traffic policy",
    "start": "2974400",
    "end": "2979680"
  },
  {
    "text": "and you'll see here that we have our normal you know destination",
    "start": "2980880",
    "end": "2988000"
  },
  {
    "text": "selector views but now we've got a policy added where",
    "start": "2988000",
    "end": "2993760"
  },
  {
    "text": "we're going to use that virtual destination so we can use the outlier detection to go to reviews global",
    "start": "2993760",
    "end": "3002000"
  },
  {
    "text": "okay to test this",
    "start": "3003680",
    "end": "3009040"
  },
  {
    "text": "what we'll do is amend our deployment on cluster 1",
    "start": "3009040",
    "end": "3014720"
  },
  {
    "text": "for both reviews v1 and reviews v2 and we're going to patch it",
    "start": "3014720",
    "end": "3020720"
  },
  {
    "text": "so that it just sleeps for 20 hours",
    "start": "3020720",
    "end": "3025480"
  },
  {
    "text": "all right each of those is patched now um we'll probably need to refresh a few",
    "start": "3027680",
    "end": "3032960"
  },
  {
    "text": "times here on our book info and take a look at what's going on but",
    "start": "3032960",
    "end": "3039040"
  },
  {
    "text": "what i'd also like to do is on cluster two",
    "start": "3039040",
    "end": "3044079"
  },
  {
    "text": "let's take a look at what's happening with our logs and just make sure that",
    "start": "3044079",
    "end": "3050319"
  },
  {
    "text": "we're actually hitting cluster two okay so let me",
    "start": "3050319",
    "end": "3057599"
  },
  {
    "text": "create some space there and we'll go back to our book info",
    "start": "3058160",
    "end": "3064559"
  },
  {
    "text": "all right let me just hit it a few times",
    "start": "3066400",
    "end": "3071359"
  },
  {
    "text": "all right and you see uh that cluster two reviews",
    "start": "3075119",
    "end": "3081839"
  },
  {
    "text": "proxy logs are actually printing out the um the hits that we got",
    "start": "3081839",
    "end": "3088880"
  },
  {
    "text": "so we know we're we're failing over traffic",
    "start": "3088880",
    "end": "3094200"
  },
  {
    "text": "all right so now that we've done that let's go ahead and make it available again on cluster",
    "start": "3099359",
    "end": "3105920"
  },
  {
    "text": "one",
    "start": "3105920",
    "end": "3108920"
  },
  {
    "text": "and this time it's going to take 30 seconds so let me just set my timer here",
    "start": "3113520",
    "end": "3120400"
  },
  {
    "text": "and you know when once this timer is is over we'll inspect",
    "start": "3120400",
    "end": "3126960"
  },
  {
    "text": "the istio proxy logs on the review app within cluster one",
    "start": "3126960",
    "end": "3133599"
  },
  {
    "text": "refresh book info and make sure that our traffic is shifted back to cluster one",
    "start": "3133599",
    "end": "3141480"
  },
  {
    "text": "all right cool so let's take a look at our logs",
    "start": "3157040",
    "end": "3163200"
  },
  {
    "text": "right boy here is ready let's hit this a few times",
    "start": "3165040",
    "end": "3171440"
  },
  {
    "text": "all right and we can see that traffic has shifted back",
    "start": "3179440",
    "end": "3184480"
  },
  {
    "text": "to our reviews app here on cluster one",
    "start": "3184480",
    "end": "3189599"
  },
  {
    "text": "okay before we move on to the next lab let's clean everything up by",
    "start": "3193599",
    "end": "3198720"
  },
  {
    "text": "deleting our virtual destination and traffic policy",
    "start": "3198720",
    "end": "3203280"
  },
  {
    "text": "all right we should be square and if you're ready go ahead and click that check button at the bottom",
    "start": "3206319",
    "end": "3212480"
  },
  {
    "text": "and we'll move to the next lap actually doing very well on time here",
    "start": "3212480",
    "end": "3219720"
  },
  {
    "text": "all right this lab is going to be focused on observability",
    "start": "3226400",
    "end": "3231760"
  },
  {
    "text": "and what we can do to observe our mesh cross cluster",
    "start": "3231760",
    "end": "3238640"
  },
  {
    "text": "all right so you know one of the common things that you'll need to do",
    "start": "3238640",
    "end": "3245280"
  },
  {
    "text": "when you're looking for errors in the system or just want to observe",
    "start": "3245280",
    "end": "3251119"
  },
  {
    "text": "requests that are coming into your system is to make sure that you have accessible access logs right",
    "start": "3251119",
    "end": "3259279"
  },
  {
    "text": "and we have a higher level abstraction called access log record that we can",
    "start": "3259839",
    "end": "3265119"
  },
  {
    "text": "apply in the management plane that will allow us to capture this so",
    "start": "3265119",
    "end": "3270880"
  },
  {
    "text": "let's take a look at how that works we'll create first our access log record here",
    "start": "3270880",
    "end": "3276319"
  },
  {
    "text": "this is going to be specifically for our reviews app",
    "start": "3276319",
    "end": "3282559"
  },
  {
    "text": "and note that there's not a cluster designation here so this should apply to both clusters",
    "start": "3284799",
    "end": "3291640"
  },
  {
    "text": "and we're going to use mesh ctl so that we can observe these logs",
    "start": "3294640",
    "end": "3301520"
  },
  {
    "text": "so mesh ctl is is also extensible",
    "start": "3301520",
    "end": "3307280"
  },
  {
    "text": "we have a plug-in system for it so we're going to first initialize the",
    "start": "3307280",
    "end": "3312799"
  },
  {
    "text": "plug-in manager from sctl you'll see an error that comes up that doesn't know the command plug-in",
    "start": "3312799",
    "end": "3319040"
  },
  {
    "text": "but once we've gone through the installation then that problem goes away so that's all right",
    "start": "3319040",
    "end": "3327760"
  },
  {
    "text": "and then what we'd like to do is is actually install the access log plug-in into",
    "start": "3327920",
    "end": "3333760"
  },
  {
    "text": "meshctl so let's also do that and this access log",
    "start": "3333760",
    "end": "3341040"
  },
  {
    "text": "does need to be tied to the specific version here you'll see that version 115 is the one",
    "start": "3341040",
    "end": "3346400"
  },
  {
    "text": "you want because that's the version of the glue",
    "start": "3346400",
    "end": "3351440"
  },
  {
    "text": "mesh management plant that we are running all right we're going to just send some",
    "start": "3351440",
    "end": "3356640"
  },
  {
    "text": "traffic through our ingress gateway on cluster one so we can see this in action",
    "start": "3356640",
    "end": "3365760"
  },
  {
    "text": "and then take a look at the access logs that were",
    "start": "3366799",
    "end": "3372240"
  },
  {
    "text": "created through mesh ctl",
    "start": "3372240",
    "end": "3377839"
  },
  {
    "text": "all right and you'll see that each of these requests that came through created",
    "start": "3378799",
    "end": "3385440"
  },
  {
    "text": "this json payload of access log you can see that um you know",
    "start": "3385440",
    "end": "3392640"
  },
  {
    "text": "it has a workload ref here what what cluster it came from you can see that as well",
    "start": "3392640",
    "end": "3398880"
  },
  {
    "text": "um you know any kind of tls properties that you had in there",
    "start": "3398880",
    "end": "3404559"
  },
  {
    "text": "um subject names that your yours san is also recorded",
    "start": "3404559",
    "end": "3411760"
  },
  {
    "text": "uh things you know that that would be critical for you if you were trying to debug a problem with",
    "start": "3411760",
    "end": "3417440"
  },
  {
    "text": "maybe a slow running app or maybe some back-end access wasn't behaving quite quite well",
    "start": "3417440",
    "end": "3424319"
  },
  {
    "text": "then these metrics would be very helpful there as well",
    "start": "3424319",
    "end": "3428960"
  },
  {
    "text": "okay",
    "start": "3431599",
    "end": "3433839"
  },
  {
    "text": "all right let's get everything back to square one then the next thing what we're going to do so let's just",
    "start": "3445040",
    "end": "3452000"
  },
  {
    "text": "delete that access log we're going to take a look at the glue mesh enterprise ui",
    "start": "3452000",
    "end": "3459960"
  },
  {
    "text": "okay so run our pork forward so that we can get to the management plane",
    "start": "3461760",
    "end": "3466799"
  },
  {
    "text": "dashboard and then you can click on the tab here to take a look at what the clue mesh",
    "start": "3466799",
    "end": "3474000"
  },
  {
    "text": "management plane can show you so you know first off",
    "start": "3474000",
    "end": "3479680"
  },
  {
    "text": "on the overview of the management plane you're going to see your your health of your remote clusters",
    "start": "3479680",
    "end": "3487359"
  },
  {
    "text": "you're also going to see that you know you have one or more meshes that are deployed",
    "start": "3487359",
    "end": "3495119"
  },
  {
    "text": "and if you click on the mesh tab here you can see a little more detailed information about those meshes",
    "start": "3495119",
    "end": "3501520"
  },
  {
    "text": "so you have a virtual mesh config and it's across clusters 1 and clusters",
    "start": "3501520",
    "end": "3506880"
  },
  {
    "text": "2 here we can also you know inspect things like the workloads that are",
    "start": "3506880",
    "end": "3513599"
  },
  {
    "text": "configured against that or policy rules that we have applied",
    "start": "3513599",
    "end": "3518880"
  },
  {
    "text": "and if we had any kind of extensibility here with uh wasn't filters those those",
    "start": "3518880",
    "end": "3524000"
  },
  {
    "text": "you could also see here if we click on things like a virtual mesh details and this is actually a",
    "start": "3524000",
    "end": "3530720"
  },
  {
    "text": "filterable field here so if we just want to look at reviews for instance",
    "start": "3530720",
    "end": "3535920"
  },
  {
    "text": "we can take a look at that and then click in to see you know the exact",
    "start": "3535920",
    "end": "3541040"
  },
  {
    "text": "policies that have been deployed so so we've got a product page policy here",
    "start": "3541040",
    "end": "3547359"
  },
  {
    "text": "and you know it's allowed to hit anything basically on reviews",
    "start": "3547359",
    "end": "3553520"
  },
  {
    "text": "so feel free to play around in there a little bit i will i will hang out here while you",
    "start": "3554000",
    "end": "3560400"
  },
  {
    "text": "explore the glue mesh dashboard before we move on to our last lab",
    "start": "3560400",
    "end": "3567359"
  },
  {
    "text": "and if you have any questions obviously you've got you've got rob and eric there in the room adam is online",
    "start": "3569520",
    "end": "3576640"
  },
  {
    "text": "to help with any questions that you have",
    "start": "3576640",
    "end": "3580920"
  },
  {
    "text": "ugh",
    "start": "3599040",
    "end": "3602040"
  },
  {
    "text": "foreign",
    "start": "3638400",
    "end": "3641400"
  },
  {
    "text": "so",
    "start": "3647760",
    "end": "3650760"
  },
  {
    "text": "all right cool and it's just in interest time i'm just gonna move on here the",
    "start": "3658400",
    "end": "3663440"
  },
  {
    "text": "last lab and you can either",
    "start": "3663440",
    "end": "3668960"
  },
  {
    "text": "follow along with me or keep exploring that dashboard",
    "start": "3668960",
    "end": "3676400"
  },
  {
    "text": "okay so for our last lab what we're going to do is explore",
    "start": "3683200",
    "end": "3688640"
  },
  {
    "text": "some of the capabilities that we provide through our glue mesh gateway",
    "start": "3688640",
    "end": "3693680"
  },
  {
    "text": "our glue mesh gateway is basically an enhanced version of istio's gateway",
    "start": "3693680",
    "end": "3700079"
  },
  {
    "text": "where we add a lot of the feature functionality of an api gateway",
    "start": "3700079",
    "end": "3705680"
  },
  {
    "text": "and so you can do things like rate limiting or oidc off uh integration",
    "start": "3705680",
    "end": "3713200"
  },
  {
    "text": "uh very very handy all right so um first thing we want to",
    "start": "3713200",
    "end": "3718559"
  },
  {
    "text": "do to take advantage of this thing is is is for",
    "start": "3718559",
    "end": "3724720"
  },
  {
    "text": "for now what we've been doing is just using uh istio's gateway to expose our product page or our book info app",
    "start": "3724720",
    "end": "3732240"
  },
  {
    "text": "but uh what we'd like to do is take advantage of the mesh gateway so",
    "start": "3732240",
    "end": "3737280"
  },
  {
    "text": "let's take a look at um first deleting the gateway and the",
    "start": "3737280",
    "end": "3744640"
  },
  {
    "text": "virtual service that we had created for the book info",
    "start": "3744640",
    "end": "3750799"
  },
  {
    "text": "and now we're going to create a virtual gateway so let's take a look at that what it looks like",
    "start": "3750799",
    "end": "3757039"
  },
  {
    "text": "before we apply it so our book info virtual gateway",
    "start": "3757039",
    "end": "3763359"
  },
  {
    "text": "is going to have a virtual host that's attached to it",
    "start": "3763359",
    "end": "3769440"
  },
  {
    "text": "and it's using ingress gateway selectors",
    "start": "3769440",
    "end": "3774480"
  },
  {
    "text": "here on cluster 1 and cluster 2 from the istio ingress gateway that we had defined earlier",
    "start": "3774480",
    "end": "3780799"
  },
  {
    "text": "in our istio operators okay so pretty straightforward there",
    "start": "3780799",
    "end": "3786960"
  },
  {
    "text": "now we haven't defined the virtual host yet so that's the next thing that we need to",
    "start": "3788319",
    "end": "3794000"
  },
  {
    "text": "do and what the virtual host is going to do for us is it's going to match up",
    "start": "3794000",
    "end": "3800720"
  },
  {
    "text": "you know domain matching uh and any kind of path matching as well",
    "start": "3800720",
    "end": "3807760"
  },
  {
    "text": "since this is our only application we have a very simple or simple example here of just a catch-all",
    "start": "3807760",
    "end": "3813599"
  },
  {
    "text": "domain and path matching but you could have something you know",
    "start": "3813599",
    "end": "3820000"
  },
  {
    "text": "more sophisticated in your case obviously lastly we're going to use a route table",
    "start": "3820000",
    "end": "3825520"
  },
  {
    "text": "and that route table is going to",
    "start": "3825520",
    "end": "3830798"
  },
  {
    "text": "be used by our virtual host in virtual gateway and you'll see that we've",
    "start": "3831920",
    "end": "3839440"
  },
  {
    "text": "defined a few specific paths here for for our route table so we've got product",
    "start": "3839440",
    "end": "3845839"
  },
  {
    "text": "page and a few other urls as well as the api that we expose on the back end",
    "start": "3845839",
    "end": "3853480"
  },
  {
    "text": "all right so let's go ahead and do that",
    "start": "3853520",
    "end": "3857680"
  },
  {
    "text": "now we should be able to see that this worked if we go into",
    "start": "3863119",
    "end": "3869280"
  },
  {
    "text": "terminal 2 and port forward to our ingress",
    "start": "3869280",
    "end": "3876318"
  },
  {
    "text": "and you can see that book info is exposed and we can refresh this to make sure",
    "start": "3876559",
    "end": "3884319"
  },
  {
    "text": "yeah it looks good so our virtual gateway remember we deleted both the gateway and the virtual",
    "start": "3884319",
    "end": "3890640"
  },
  {
    "text": "servers that were existing there for istio system created this virtual gateway virtual",
    "start": "3890640",
    "end": "3895680"
  },
  {
    "text": "host and route table combination and that took the place of what was",
    "start": "3895680",
    "end": "3900799"
  },
  {
    "text": "there before of course you wouldn't run this way in",
    "start": "3900799",
    "end": "3906839"
  },
  {
    "text": "production you would have a secure website right",
    "start": "3906839",
    "end": "3912319"
  },
  {
    "text": "so let's create a certificate for our gateway",
    "start": "3912319",
    "end": "3917838"
  },
  {
    "text": "we'll just do a self-signed certificate for now and then",
    "start": "3918799",
    "end": "3925119"
  },
  {
    "text": "we'll populate a secret in both the clusters with that",
    "start": "3925119",
    "end": "3930480"
  },
  {
    "text": "with that certificate and now we'll modify our gateway to take advantage of that and the next thing you",
    "start": "3930480",
    "end": "3936400"
  },
  {
    "text": "see here is that we just have to go to one location now to take advantage",
    "start": "3936400",
    "end": "3943119"
  },
  {
    "text": "of that configuration so in the management plane we're creating a",
    "start": "3943119",
    "end": "3949680"
  },
  {
    "text": "virtual gateway we're configuring our tls secret that we just created in the remote clusters",
    "start": "3949680",
    "end": "3957119"
  },
  {
    "text": "and we're also specifying now because we're using that that we're going to use the https port",
    "start": "3957119",
    "end": "3964640"
  },
  {
    "text": "and with this simple change you'll see that it affects the remote",
    "start": "3964640",
    "end": "3970000"
  },
  {
    "text": "clusters right so now um",
    "start": "3970000",
    "end": "3975520"
  },
  {
    "text": "let's let's go back to our terminal 2 here and we'll cancel our earlier port",
    "start": "3975520",
    "end": "3982079"
  },
  {
    "text": "forward and now we're going to port forward to port 443 for our secure port",
    "start": "3982079",
    "end": "3991280"
  },
  {
    "text": "if you go back and refresh here on book info you'll you'll notice that it doesn't work right",
    "start": "3991280",
    "end": "3998079"
  },
  {
    "text": "uh but here book info https it does work so now we know we have a secure route",
    "start": "3998079",
    "end": "4007480"
  },
  {
    "text": "uh we won't do this here but you could also you know use the gateway of the second",
    "start": "4010319",
    "end": "4016559"
  },
  {
    "text": "cluster it's it's configured as well if you want to feel free to try that i'm going to skip that part for now",
    "start": "4016559",
    "end": "4023760"
  },
  {
    "text": "what i'd really like to see though is being able to do multi-cluster traffic",
    "start": "4023760",
    "end": "4028880"
  },
  {
    "text": "all right so remember in one of our previous labs we had a traffic policy",
    "start": "4028880",
    "end": "4036319"
  },
  {
    "text": "that allowed us to shift our traffic across the cluster so we're going to put that back in place",
    "start": "4036319",
    "end": "4043760"
  },
  {
    "text": "as you know very very similar to the earlier traffic policy that we had",
    "start": "4043760",
    "end": "4049440"
  },
  {
    "text": "this time it has a route selector so it's taking advantage of our route table",
    "start": "4049440",
    "end": "4056319"
  },
  {
    "text": "and now we're actually going to apply that to our route table",
    "start": "4061039",
    "end": "4069280"
  },
  {
    "text": "okay so you'll see down here in",
    "start": "4069599",
    "end": "4074640"
  },
  {
    "text": "the bottom are matchers for reviews uh we've added it to our route table so",
    "start": "4074640",
    "end": "4080000"
  },
  {
    "text": "the ingress gateway can also route to it and it's going to use this destination",
    "start": "4080000",
    "end": "4086079"
  },
  {
    "text": "of these",
    "start": "4086079",
    "end": "4089319"
  },
  {
    "text": "now because we've we've done this way we need to make sure our access policies are opened up so",
    "start": "4093520",
    "end": "4099359"
  },
  {
    "text": "that the ingress gateway can get to that so let's also create that access policy",
    "start": "4099359",
    "end": "4105920"
  },
  {
    "text": "and you can see here we're applying to both clusters um",
    "start": "4105920",
    "end": "4111838"
  },
  {
    "text": "and our destination selectors now are product page and reviews",
    "start": "4111839",
    "end": "4118279"
  },
  {
    "text": "let's generate a little traffic against this",
    "start": "4123920",
    "end": "4128318"
  },
  {
    "text": "okay uh so what we want to see here is did our",
    "start": "4130159",
    "end": "4135278"
  },
  {
    "text": "traffic shift work so if our traffic shift worked what we should see is that we get",
    "start": "4135279",
    "end": "4141679"
  },
  {
    "text": "uh ratings back with our red stars 75 of the time and you can see that that",
    "start": "4141679",
    "end": "4147600"
  },
  {
    "text": "is the case uh most of the time we're getting red so occasionally we get black",
    "start": "4147600",
    "end": "4152798"
  },
  {
    "text": "um small percentage we get nothing back from this rating so",
    "start": "4152799",
    "end": "4159520"
  },
  {
    "text": "that seems to be working which is good okay let's now go back",
    "start": "4159520",
    "end": "4167838"
  },
  {
    "text": "from whence we came by removing that traffic policy and we'll apply the original route table",
    "start": "4167839",
    "end": "4174960"
  },
  {
    "text": "and i'm aware that we've got like three minutes left so",
    "start": "4174960",
    "end": "4180159"
  },
  {
    "text": "i don't know how if we need to wrap up at this point",
    "start": "4180159",
    "end": "4186318"
  },
  {
    "text": "yeah take questions",
    "start": "4186319",
    "end": "4189838"
  },
  {
    "text": "did you say wrap up rom yep okay all right fantastic yeah we'll wrap up here um",
    "start": "4192080",
    "end": "4198800"
  },
  {
    "text": "you know like both of the other workshops we run our workshops pretty regularly so please go to our",
    "start": "4198800",
    "end": "4205920"
  },
  {
    "text": "solo site events and take a look at you know when",
    "start": "4205920",
    "end": "4211199"
  },
  {
    "text": "another one might be offered if you want to review what you saw today i want",
    "start": "4211199",
    "end": "4216239"
  },
  {
    "text": "to get more out of it and yeah we look forward to seeing you there",
    "start": "4216239",
    "end": "4222560"
  },
  {
    "text": "so thank you to the helpers in the room rom and eric",
    "start": "4222560",
    "end": "4228080"
  },
  {
    "text": "thank you adam as well for helping out online appreciate everything and thanks",
    "start": "4228080",
    "end": "4235120"
  },
  {
    "text": "everybody for staying on and listening thanks",
    "start": "4235120",
    "end": "4241400"
  }
]