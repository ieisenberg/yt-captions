[
  {
    "start": "0",
    "end": "26000"
  },
  {
    "text": "all right cool let's get started well thanks everybody for coming to the one of the last conferences on the last day",
    "start": "170",
    "end": "6750"
  },
  {
    "text": "across the street top building I have fantastic cash prizes for all of you all you have to do is fix three issues on",
    "start": "6750",
    "end": "14910"
  },
  {
    "text": "the Falco repo and then that prize is yours so keep that in mind guys so I'm mark stem and I'm gonna talk about how",
    "start": "14910",
    "end": "21180"
  },
  {
    "text": "we added support for kubernetes audit events to Falco just a little bit about",
    "start": "21180",
    "end": "27750"
  },
  {
    "start": "26000",
    "end": "51000"
  },
  {
    "text": "me I'm a senior software engineer at Cystic I've been there about three years and the first week I was at Cystic Laura",
    "start": "27750",
    "end": "35910"
  },
  {
    "text": "said hey let's go release this thing called Falco and I said okay what's that and then look where we are now so we got",
    "start": "35910",
    "end": "41399"
  },
  {
    "text": "this awesome stuff so I mean I'm kind of one of the maintainer Zahn it's oh it's",
    "start": "41399",
    "end": "46800"
  },
  {
    "text": "all my fault or it's all I I made it all awesome either one is fine with me so if",
    "start": "46800",
    "end": "52590"
  },
  {
    "start": "51000",
    "end": "148000"
  },
  {
    "text": "you don't know much about Falco hope you're hopefully you are familiar with it but if not let's just do a quick",
    "start": "52590",
    "end": "57930"
  },
  {
    "text": "introduction so Falco is a behavioral Activity Monitor and what it does is",
    "start": "57930",
    "end": "63359"
  },
  {
    "text": "look for suspicious or other notable activity as defined by a set of rules",
    "start": "63359",
    "end": "68640"
  },
  {
    "text": "that it has on prior to kubernetes audit all of the activity that it was",
    "start": "68640",
    "end": "74700"
  },
  {
    "text": "monitoring was based on system calls that came from the underlying code and",
    "start": "74700",
    "end": "79920"
  },
  {
    "text": "Cystic so a lot of the things that you see in Falco are actually powered by Cystic support for interpreting system",
    "start": "79920",
    "end": "87659"
  },
  {
    "text": "calls adding context to them and having filtering and output abilities on it and",
    "start": "87659",
    "end": "93030"
  },
  {
    "text": "Falco just takes that and builds a rules engine on top of it when Falco",
    "start": "93030",
    "end": "99750"
  },
  {
    "text": "identifies some suspicious activity it basically can send messages to a number",
    "start": "99750",
    "end": "105060"
  },
  {
    "text": "of output channels and so we have some basic stuff in there you know you can write to files you can write to standard out if you're running it directly we can",
    "start": "105060",
    "end": "112110"
  },
  {
    "text": "go to syslog we can invoke little programs so you can use that for all kinds of purposes like sending emails or",
    "start": "112110",
    "end": "118770"
  },
  {
    "text": "posting to web hooks or anything like that so it's a pretty flexible way to get your stuff from Falco to wherever",
    "start": "118770",
    "end": "124350"
  },
  {
    "text": "else you want to get it and obviously it's open source so um I'll talk more about it in a second but",
    "start": "124350",
    "end": "130110"
  },
  {
    "text": "we moved it to the Apache License it's been open source since it began now it's Apache so you know please make",
    "start": "130110",
    "end": "136590"
  },
  {
    "text": "your contributions feel free to use it incorporate it in your own stuff but if you use it please let us know because",
    "start": "136590",
    "end": "141599"
  },
  {
    "text": "you know one thing we really want to do is build a strong community around this so we can get this thing to really take",
    "start": "141599",
    "end": "146610"
  },
  {
    "text": "off one thing we're really excited about in the last few months is that falco has",
    "start": "146610",
    "end": "152459"
  },
  {
    "start": "148000",
    "end": "180000"
  },
  {
    "text": "moved over to be a part of the cnc f it's at the sandbox level which is the entry beginner level but we'll kind of",
    "start": "152459",
    "end": "158220"
  },
  {
    "text": "move up hopefully and you know we think this is really exciting because we",
    "start": "158220",
    "end": "163290"
  },
  {
    "text": "really want falco to be kind of an essential piece of runtime security for",
    "start": "163290",
    "end": "168330"
  },
  {
    "text": "containerized environments and we really hope that we can get everybody excited about it get some fantastic integrations",
    "start": "168330",
    "end": "174329"
  },
  {
    "text": "going with kubernetes and get it really built in there and usable by lots of people so just a quick example if you've",
    "start": "174329",
    "end": "182430"
  },
  {
    "start": "180000",
    "end": "225000"
  },
  {
    "text": "never seen Falco kind of what the kind of stuff you can do with it and the top pane we've got Falco running in the",
    "start": "182430",
    "end": "187920"
  },
  {
    "text": "bottom pane we're doing all kinds of bad stuff so we're doing stuff like exacting into a container you might use that for",
    "start": "187920",
    "end": "194099"
  },
  {
    "text": "privilege escalation we're reading sensitive files below like Etsy shadow we're modifying system files like things",
    "start": "194099",
    "end": "202109"
  },
  {
    "text": "below /bin and so forth and for all of that bad activity we're doing on the bottom we're detecting it in the top",
    "start": "202109",
    "end": "208980"
  },
  {
    "text": "because we're seeing all the activity done as expressed by system calls and",
    "start": "208980",
    "end": "216799"
  },
  {
    "text": "basically running that against with two rules looking for shady stuff and then sending you messages when the shady",
    "start": "216799",
    "end": "222450"
  },
  {
    "text": "stuff happens okay so let's talk a little bit about how how",
    "start": "222450",
    "end": "228060"
  },
  {
    "start": "225000",
    "end": "350000"
  },
  {
    "text": "Falco is kind of architected and that'll kind of set up the second half of the talk pretty well so in the lower left",
    "start": "228060",
    "end": "234150"
  },
  {
    "text": "right here we've got a curl module and the kernel module taps into the stream",
    "start": "234150",
    "end": "239190"
  },
  {
    "text": "of system calls on the machine and we see every system call that's running you know what doesn't matter if it's in the",
    "start": "239190",
    "end": "245069"
  },
  {
    "text": "container or not or directly on the host we get all the system calls we take the system calls and we turn them a little",
    "start": "245069",
    "end": "251040"
  },
  {
    "text": "into a little system call event object we bring that up to user space and the",
    "start": "251040",
    "end": "256979"
  },
  {
    "text": "job of user space is basically to add context to it so the thing we get from the kernel module is pretty basic it's",
    "start": "256979",
    "end": "262860"
  },
  {
    "text": "like a thread ID assist call number and the arguments but from that we start",
    "start": "262860",
    "end": "268440"
  },
  {
    "text": "adding context so we know that thread ID 10 is actually a thread in a process",
    "start": "268440",
    "end": "274050"
  },
  {
    "text": "called Apache and so we'll add context saying hey this for this event the process name is Apache if this is",
    "start": "274050",
    "end": "280800"
  },
  {
    "text": "running in a container will add container level information we'll say oh this is running as a part of a container",
    "start": "280800",
    "end": "285930"
  },
  {
    "text": "with a given ID here's the image that was used for that container here's the mounts that container has and we add all",
    "start": "285930",
    "end": "292950"
  },
  {
    "text": "of that as context to that system call event if it's running in a containerized or orchestration environment we add more",
    "start": "292950",
    "end": "300510"
  },
  {
    "text": "context we say hey it's a part of this pod a part of this deployment part of this namespace we had all of",
    "start": "300510",
    "end": "306690"
  },
  {
    "text": "that context to the object so now we have this really rich view of the activity done as a part of that system",
    "start": "306690",
    "end": "313409"
  },
  {
    "text": "call so you know who did it what they're doing it on and you know where in your environment that you're doing it so it's",
    "start": "313409",
    "end": "318780"
  },
  {
    "text": "pretty rich once we have these system call events we basically run it through a rules engine and that's all provided",
    "start": "318780",
    "end": "324690"
  },
  {
    "text": "by Falco the rules like I said they kind of look for suspicious or other notable stuff we take every event kind of match",
    "start": "324690",
    "end": "331380"
  },
  {
    "text": "it matching matching match I match it against the rules and when an event matches one of the rules we send it to",
    "start": "331380",
    "end": "337770"
  },
  {
    "text": "one of the outputs and then you can construct a special output string that's got a mix of stuff that you type in and",
    "start": "337770",
    "end": "345000"
  },
  {
    "text": "stuff that comes from the event and that's what goes to the different output channels so let's look at you know very",
    "start": "345000",
    "end": "352800"
  },
  {
    "start": "350000",
    "end": "419000"
  },
  {
    "text": "quickly what a rule looks like and then use that to kind of talk about how we extract this information out of the",
    "start": "352800",
    "end": "358229"
  },
  {
    "text": "event objects okay so this is what a Falco rule looks like it's got a name a",
    "start": "358229",
    "end": "363630"
  },
  {
    "text": "description this condition piece of the gamal is basically a filter that gets",
    "start": "363630",
    "end": "368909"
  },
  {
    "text": "matched against all of the system calls so in this case the rule is looking for rights below a binary directory and what",
    "start": "368909",
    "end": "375750"
  },
  {
    "text": "the condition does is says is the event type open so is that an open call and is",
    "start": "375750",
    "end": "381240"
  },
  {
    "text": "the directory component that is the thing being opened just take the directory part of that does it match",
    "start": "381240",
    "end": "387450"
  },
  {
    "text": "either bin or user bin so get some matching stuff when it matches we generate this output string which again",
    "start": "387450",
    "end": "394200"
  },
  {
    "text": "is a mix of plain text and stuff that comes from the event that's the little percentage percent dies",
    "start": "394200",
    "end": "399810"
  },
  {
    "text": "then you can tell receipt programmers because I'll print up for us it was gonna be like the brackets and stuff and",
    "start": "399810",
    "end": "406310"
  },
  {
    "text": "that's kind of it so let's talk about how we kind of can",
    "start": "406310",
    "end": "411690"
  },
  {
    "text": "take this and adapt it to use a different kind of event than the system",
    "start": "411690",
    "end": "416790"
  },
  {
    "text": "call events that we previous used without go so the heart of it is that we have these fields that basically are",
    "start": "416790",
    "end": "423120"
  },
  {
    "text": "reside in the condition expression or in the output expression and for each field we basically go over and interrogate the",
    "start": "423120",
    "end": "431280"
  },
  {
    "text": "system call object and say what's the value of this field so in this case event dot type you go over to the object",
    "start": "431280",
    "end": "436770"
  },
  {
    "text": "and say what's the value for the field event dot type in this case it was open so we find out it's open we go look at",
    "start": "436770",
    "end": "443070"
  },
  {
    "text": "the logical expression of the condition and we keep going because it matches",
    "start": "443070",
    "end": "448250"
  },
  {
    "text": "similarly if we wanted to look at the directory it's another reaching out to the object to say hey what's the FD",
    "start": "448250",
    "end": "454500"
  },
  {
    "text": "Direct what's the value of the field called FD directory we get that out see",
    "start": "454500",
    "end": "459540"
  },
  {
    "text": "its /bin matches these values and then we match the condition now it's time to look at the output to generate the",
    "start": "459540",
    "end": "466710"
  },
  {
    "text": "output string same deal we just got these fields grabbed it out of the object and then that gets put in the",
    "start": "466710",
    "end": "472590"
  },
  {
    "text": "stuffed into the output template to figure out what message we want to send",
    "start": "472590",
    "end": "477660"
  },
  {
    "text": "off same thing command-line FD name so",
    "start": "477660",
    "end": "483210"
  },
  {
    "start": "482000",
    "end": "513000"
  },
  {
    "text": "the nice thing is is that we realized that you know there's a lot here that we can reuse if we want to use other event",
    "start": "483210",
    "end": "489660"
  },
  {
    "text": "streams you know all this stuff for the yam all and the logical operators and naming the fields extracting the values",
    "start": "489660",
    "end": "495630"
  },
  {
    "text": "we can make that pretty general purpose and all we have to do is make up a new kind of event object and new kinds of",
    "start": "495630",
    "end": "503070"
  },
  {
    "text": "fields that know how to extract stuff out of the event job object if we have that we can reuse all the framework that",
    "start": "503070",
    "end": "509160"
  },
  {
    "text": "we already have in Falco and that's what we did for kubernetes audit events if",
    "start": "509160",
    "end": "514680"
  },
  {
    "start": "513000",
    "end": "629000"
  },
  {
    "text": "you don't know what kubernetes audit events are let's talk about it a little bit it's a new thing in kubernetes 111",
    "start": "514680",
    "end": "520800"
  },
  {
    "text": "and what it does it's basically an audit log that gives you a chronological set",
    "start": "520800",
    "end": "526680"
  },
  {
    "text": "of records that document all the changes have that happen to your cluster the nice thing about Kerber naty's is almost",
    "start": "526680",
    "end": "532320"
  },
  {
    "text": "all the activity go through the API server so that's a nice point where if you can just create an audit log of what happens there it's",
    "start": "532320",
    "end": "539490"
  },
  {
    "text": "going to reflect almost all the changes that are being made to your cluster so when you set up audit logging for",
    "start": "539490",
    "end": "546030"
  },
  {
    "text": "kubernetes one thing you provide is basically an audit policy so this isn't a Falco thing it's just a kubernetes",
    "start": "546030",
    "end": "552300"
  },
  {
    "text": "thing you basically tell the cluster here are the kinds of events that I want you to put in the audit log so you might",
    "start": "552300",
    "end": "559170"
  },
  {
    "text": "say things like only tell me about deletes only to only tell me about things that happen to deployments and",
    "start": "559170",
    "end": "566370"
  },
  {
    "text": "there's a rich documented framework for you know that's really flexible and giving you the kinds of stuff that you",
    "start": "566370",
    "end": "572850"
  },
  {
    "text": "want out of it in the Falco repo we have an example audit policy which is the one we've used that we think would be a good",
    "start": "572850",
    "end": "579060"
  },
  {
    "text": "reference if you want to kind of use it in conjunction without go of course you can add whatever you want to it so once",
    "start": "579060",
    "end": "586620"
  },
  {
    "text": "you have this audit policy that controls what events are going to come out you",
    "start": "586620",
    "end": "592380"
  },
  {
    "text": "have to decide where they go so you have a couple options there you can write them to a log file you know simple log file rotates every once in a while you",
    "start": "592380",
    "end": "598710"
  },
  {
    "text": "know like you would expect out of any like web server log or you know anything with those audit type longer logs and you can also post it off to a web hook",
    "start": "598710",
    "end": "605340"
  },
  {
    "text": "so you can give it a network endpoint and said hey go over to this IP or",
    "start": "605340",
    "end": "610470"
  },
  {
    "text": "service or hostname and you know on this port and here's the path you should use and it just batches it up it's got a",
    "start": "610470",
    "end": "617520"
  },
  {
    "text": "little like Nagle algorithm type thing where like matches a little bit but if it's been too long sends them off and it just posts it to",
    "start": "617520",
    "end": "624030"
  },
  {
    "text": "HTTP so pretty simple and that's the mechanism we actually used in Falco so",
    "start": "624030",
    "end": "630660"
  },
  {
    "start": "629000",
    "end": "708000"
  },
  {
    "text": "just to give you an example of what what one of these audit events looks like um I simplified it a little bit because",
    "start": "630660",
    "end": "635670"
  },
  {
    "text": "there's actually a lot of stuff in there but this has all the main pieces so a naught event has a you know timestamp",
    "start": "635670",
    "end": "641630"
  },
  {
    "text": "there's a stage because for the audit logging you can actually check it at different points you can check it like",
    "start": "641630",
    "end": "647190"
  },
  {
    "text": "as they're making the request after they're making the request and as the response goes out so that's that what",
    "start": "647190",
    "end": "653040"
  },
  {
    "text": "that stage means so there's a always a verb so it's like what action you want to take on the target object or named",
    "start": "653040",
    "end": "660300"
  },
  {
    "text": "object or something like that in this case this audit event represents deleting a namespace so in this case the",
    "start": "660300",
    "end": "666060"
  },
  {
    "text": "verb is delete we have a URI we can say who they are so they have a username it might get all it could also be like",
    "start": "666060",
    "end": "672350"
  },
  {
    "text": "service account information we have the response status so you know it's HTTP",
    "start": "672350",
    "end": "678379"
  },
  {
    "text": "level responses but they mapped a you know the expected yes/no kind of thing",
    "start": "678379",
    "end": "683410"
  },
  {
    "text": "in this case or it's referring to a namespace so that's what object rect is for they all have unique IDs so you can",
    "start": "683410",
    "end": "690559"
  },
  {
    "text": "just unambiguously identify them and they have information about like what",
    "start": "690559",
    "end": "695720"
  },
  {
    "text": "authorization decisions it had to make and whether it was allowed to do that and that stuff's included there too so",
    "start": "695720",
    "end": "700970"
  },
  {
    "text": "it's it's a pretty rich set of information about like what they tried what the result was and what happened as",
    "start": "700970",
    "end": "706699"
  },
  {
    "text": "a result of it going back to our architectural diagram let's talk about",
    "start": "706699",
    "end": "711709"
  },
  {
    "start": "708000",
    "end": "778000"
  },
  {
    "text": "how we added support in so step one we added an embedded web server to Falco so",
    "start": "711709",
    "end": "717199"
  },
  {
    "text": "just nice little civic web thing that can basically it sits there and listens for posts on one in exactly one endpoint",
    "start": "717199",
    "end": "724009"
  },
  {
    "text": "and it's configurable in the ports configure what that's all it does no gets nothing else for now once we had",
    "start": "724009",
    "end": "730879"
  },
  {
    "text": "that you set up your kubernetes api server you set up the audit policy to get the events out you set up the web",
    "start": "730879",
    "end": "736639"
  },
  {
    "text": "hook based audit communication and then that goes to Falco Falco gets all of the",
    "start": "736639",
    "end": "744290"
  },
  {
    "text": "JSON objects we do some simple transformation a small amount of like",
    "start": "744290",
    "end": "750649"
  },
  {
    "text": "repackaging to turn it into the objects we need internally within Falco and then then we're set once we had that we can",
    "start": "750649",
    "end": "757309"
  },
  {
    "text": "use the same rules engine that we already had all the Yambol all the logical expressions all the in operators",
    "start": "757309",
    "end": "762889"
  },
  {
    "text": "and equal not equal all that stuff all works just the same but it's a different stream of events and it's a actually a",
    "start": "762889",
    "end": "769790"
  },
  {
    "text": "different set of rules they're just running in parallel on parallel event streams both system calls and kubernetes",
    "start": "769790",
    "end": "776089"
  },
  {
    "text": "audit activity a little more detail on how we actually implemented this in",
    "start": "776089",
    "end": "782449"
  },
  {
    "start": "778000",
    "end": "870000"
  },
  {
    "text": "Falco itself so it Falco is pretty much all C++ with a smattering of Lua for",
    "start": "782449",
    "end": "788029"
  },
  {
    "text": "kind of set up so we already had this object that was a sis call object C++",
    "start": "788029",
    "end": "793790"
  },
  {
    "text": "object we just you know put another object on top of it and made a bunch of virtual void methods so we just defined",
    "start": "793790",
    "end": "799459"
  },
  {
    "text": "some interfaces that say hey if you want to be a generic event here are the things you have to do you have to give me a time back and you",
    "start": "799459",
    "end": "808190"
  },
  {
    "text": "have to have this ability to extract a value of a field you know you give me",
    "start": "808190",
    "end": "814700"
  },
  {
    "text": "the field name and I'll tell you what the value of that field is out of the object we ended up using JSON pointers",
    "start": "814700",
    "end": "820940"
  },
  {
    "text": "to do the extraction just because it's a convenient way to do it and I'll talk about that in a second and now once we",
    "start": "820940",
    "end": "826610"
  },
  {
    "text": "have that we're pretty much set and then we wrote a bunch of new rules so there's a new role in 0 13 0 Kate's audit rules",
    "start": "826610",
    "end": "833839"
  },
  {
    "text": "yamo runs parallel to the main rules file that we already had and all rules",
    "start": "833839",
    "end": "839420"
  },
  {
    "text": "now have a source so by default the source for a role is syscall which means the system calls to the ones already had",
    "start": "839420",
    "end": "845420"
  },
  {
    "text": "but you can have another source Kate's audit and if you have a source of",
    "start": "845420",
    "end": "850490"
  },
  {
    "text": "Kate's audit you get the events that come from the API server otherwise you get all the events that come from the",
    "start": "850490",
    "end": "856190"
  },
  {
    "text": "system calls it didn't really make sense to mix them because like all the fields don't really have like cross meaning so",
    "start": "856190",
    "end": "861649"
  },
  {
    "text": "they're just two parallel streams of events going through one rules engine where they pick off you know there are",
    "start": "861649",
    "end": "867440"
  },
  {
    "text": "subsets of rules and do all the matching ok so let's just do a quick summary of",
    "start": "867440",
    "end": "873290"
  },
  {
    "text": "what JSON pointers are because it's a convenient way to access this stuff in it we kind of build on that to define",
    "start": "873290",
    "end": "878690"
  },
  {
    "text": "our field names so JSON pointers are just a way to extract the value of a",
    "start": "878690",
    "end": "884600"
  },
  {
    "text": "given property path in a in a JSON object if you know XPath like you're old",
    "start": "884600",
    "end": "890779"
  },
  {
    "text": "like me it's that kind of stuff but it's for JSON objects do see some laughing up",
    "start": "890779",
    "end": "896959"
  },
  {
    "text": "here I'll drop some motif references next okay so you've got a JSON object on",
    "start": "896959",
    "end": "902839"
  },
  {
    "text": "the left and then we'll just kind of say like okay let's go through examples right so if I want to get the value of the property called foo in the object",
    "start": "902839",
    "end": "909740"
  },
  {
    "text": "you just put a string that says /foo pretty easy right if you have a nested object you just keep going down in the",
    "start": "909740",
    "end": "916250"
  },
  {
    "text": "nested expression with Pat with path separators so if you want to get the value of the Baz property within the",
    "start": "916250",
    "end": "922670"
  },
  {
    "text": "object that is the borrower property you say slash bar slash Baz and you get tea",
    "start": "922670",
    "end": "928300"
  },
  {
    "text": "you can do array indexing that's just you just do that by doing a slash and",
    "start": "928300",
    "end": "933380"
  },
  {
    "text": "then a number and then they'll say hey assume this thing's an array give me the zeroth value out of it and you'll get one in",
    "start": "933380",
    "end": "938600"
  },
  {
    "text": "this case okay so pretty simple looking back at our kubernetes on an event the",
    "start": "938600",
    "end": "945589"
  },
  {
    "start": "941000",
    "end": "987000"
  },
  {
    "text": "way we can extract this stuff is kind of the same way with these JSON pointers so if we want to figure out what the verb",
    "start": "945589",
    "end": "950690"
  },
  {
    "text": "is we just make a JSON pointer that's slash verb if we want to figure out what the status code is we look at response",
    "start": "950690",
    "end": "957319"
  },
  {
    "text": "status slash code so it's a pretty nice flexible way to get pretty much anything",
    "start": "957319",
    "end": "962899"
  },
  {
    "text": "we want out of these JSON objects there's a little bit more stuff within falco we actually have little micro",
    "start": "962899",
    "end": "969889"
  },
  {
    "text": "functions that can do some simple aggregation and filtering like you can say like look at a whole array at once",
    "start": "969889",
    "end": "975889"
  },
  {
    "text": "and only give me certain values or check to see if it has a value but JSON pointers are the real heart of it that",
    "start": "975889",
    "end": "981949"
  },
  {
    "text": "really extract the stuff that we want out of it to define these fields so",
    "start": "981949",
    "end": "988910"
  },
  {
    "start": "987000",
    "end": "1091000"
  },
  {
    "text": "there's a few fields that you we created in order to add support the first one is",
    "start": "988910",
    "end": "994250"
  },
  {
    "text": "J event value this is kind of your general-purpose one it's always there and you know you can always use that to",
    "start": "994250",
    "end": "1000370"
  },
  {
    "text": "get something out of the object if nothing else works so J event dot value bracket and then you just put one of",
    "start": "1000370",
    "end": "1006490"
  },
  {
    "text": "those JSON pointer strings in there and then you start it at the top work your way down get that whatever value comes",
    "start": "1006490",
    "end": "1011560"
  },
  {
    "text": "out that gets matched in the filter or gets put in the output string everything",
    "start": "1011560",
    "end": "1016810"
  },
  {
    "text": "has a time so J event time is it extracts a specific accurate time out of",
    "start": "1016810",
    "end": "1023709"
  },
  {
    "text": "the JSON object but we just have it as a direct thing and then the next thing is we have we have all these basically",
    "start": "1023709",
    "end": "1029459"
  },
  {
    "text": "aliases or macros because it would be kind of awkward to write J event value blah blah blah or J event about you to",
    "start": "1029459",
    "end": "1035438"
  },
  {
    "text": "get really awkward and clutter up your rules file so we made it a little bit more concise and gave you some shortcuts",
    "start": "1035439",
    "end": "1040900"
  },
  {
    "text": "to basically have short strings that represent long pre-canned JSON pointer",
    "start": "1040900",
    "end": "1046000"
  },
  {
    "text": "expressions so some examples of them are K dot verb okay your I K dot user name",
    "start": "1046000",
    "end": "1052090"
  },
  {
    "text": "okay doc target resource and so forth and they're basically just macros that",
    "start": "1052090",
    "end": "1058750"
  },
  {
    "text": "map one-to-one to a given J event value so k dot verb is equivalent to writing J",
    "start": "1058750",
    "end": "1065140"
  },
  {
    "text": "event value bracket verb okay target resource same thing okay if you want to know what all the rules are",
    "start": "1065140",
    "end": "1071420"
  },
  {
    "text": "or all the fields are you can look at the wiki or you can just run it live so falco - - list equals skates audit will",
    "start": "1071420",
    "end": "1079970"
  },
  {
    "text": "just dump out all the fields if you know cystic it's very similar to cystic - shell you know print out all the fields you can kind of get an idea of what your",
    "start": "1079970",
    "end": "1086570"
  },
  {
    "text": "what you can get out of these objects okay so let's look at a rule right so um",
    "start": "1086570",
    "end": "1094040"
  },
  {
    "start": "1091000",
    "end": "1228000"
  },
  {
    "text": "now we didn't know time we're doing it this is kind of like one sample rule and",
    "start": "1094040",
    "end": "1100910"
  },
  {
    "text": "it's supporting macros if you don't know if Alko you know falco has rules but it also has macros for code reuse and lists",
    "start": "1100910",
    "end": "1107270"
  },
  {
    "text": "and stuff so we just got all pieces here so going top down so the first thing we do is we define a macro that's called",
    "start": "1107270",
    "end": "1113180"
  },
  {
    "text": "contains oh the the goal of this rule is to look for like somebody created a config map and they and you put your AWS",
    "start": "1113180",
    "end": "1120140"
  },
  {
    "text": "key in there like don't do that but if you do then we got a we got a Falco roll to slap you on the wrist you",
    "start": "1120140",
    "end": "1125630"
  },
  {
    "text": "know so we have a macro that says contains private credentials and what",
    "start": "1125630",
    "end": "1130760"
  },
  {
    "text": "we're doing here is we're just specifying a little condition snippet that says KDOT request config Mac dot",
    "start": "1130760",
    "end": "1137270"
  },
  {
    "text": "object which is basically the operation when it referred to a config map look at",
    "start": "1137270",
    "end": "1142850"
  },
  {
    "text": "the object which is just a string when we grab it out it says does it contain a B AWS access key ID so I guess if you're",
    "start": "1142850",
    "end": "1149590"
  },
  {
    "text": "just evil enough you'll put your password in but you'll spell it wrong and then we won't get this but if you're",
    "start": "1149590",
    "end": "1155120"
  },
  {
    "text": "dumb enough you'll probably still call it password so we'll get you the next macro is config map and we're saying K",
    "start": "1155120",
    "end": "1161060"
  },
  {
    "text": "dot target resource is saying the thing is that you're acting on is a config map we have a macro called modify which",
    "start": "1161060",
    "end": "1168500"
  },
  {
    "text": "looks at the verb and says is it create or update or patch so is it some modification type thing to the config",
    "start": "1168500",
    "end": "1174530"
  },
  {
    "text": "map bringing it all together this is where we tie it together in the rule so we have a rule that says create config",
    "start": "1174530",
    "end": "1180350"
  },
  {
    "text": "map with private credentials and the condition is just the combination of these macros so can big map",
    "start": "1180350",
    "end": "1186530"
  },
  {
    "text": "you're acting on a config map modify you're doing a modification or creation of one contains private credentials when",
    "start": "1186530",
    "end": "1193880"
  },
  {
    "text": "we look at the convening us when you look in there and we see something that looks like it might have private",
    "start": "1193880",
    "end": "1199040"
  },
  {
    "text": "stuff in it take all those three put it together if it matches that then here's your output string",
    "start": "1199040",
    "end": "1204680"
  },
  {
    "text": "Kate's config map with private credential and again we're giving you a mix of information that comes from the",
    "start": "1204680",
    "end": "1209900"
  },
  {
    "text": "text and also the audit event so we'll be able to say who did it the K dot",
    "start": "1209900",
    "end": "1215360"
  },
  {
    "text": "username what action they're doing K dot verb the name of the config map and the contents in the config map so very",
    "start": "1215360",
    "end": "1221960"
  },
  {
    "text": "similar to what we have with system calls but working on these like cluster wide Kate's operations instead alright",
    "start": "1221960",
    "end": "1229370"
  },
  {
    "start": "1228000",
    "end": "1728000"
  },
  {
    "text": "so let's do a demo you know that's the most fun right okay so I got my cheating",
    "start": "1229370",
    "end": "1235220"
  },
  {
    "text": "speaker notes sir I'm gonna flip back and forth okay so we'll get Falco running in the bottom I think you guys",
    "start": "1235220",
    "end": "1243560"
  },
  {
    "text": "can see this and then the top will just start doing stuff and see what happens so the first thing we'll do let's just",
    "start": "1243560",
    "end": "1252440"
  },
  {
    "text": "create a simple deployment you know based on nginx or something so in the",
    "start": "1252440",
    "end": "1258050"
  },
  {
    "text": "rule spa we actually have a few different classes of rules so we have like one class of rules that looks for",
    "start": "1258050",
    "end": "1264320"
  },
  {
    "text": "suspicious stuff stuff that you probably shouldn't be seeing anywhere we really take care to use the severity field of",
    "start": "1264320",
    "end": "1271730"
  },
  {
    "text": "these rules in Falco rules they have severe DS that go from like debug up to error and so we try to make sure like",
    "start": "1271730",
    "end": "1277160"
  },
  {
    "text": "the warning really reflects like how bad we think the thing is so the first class is generally like warnings or errors we",
    "start": "1277160",
    "end": "1284420"
  },
  {
    "text": "have another class of rules that are like hey these are just things that are happening to your clusters so basically objects get created or deleted we have",
    "start": "1284420",
    "end": "1290600"
  },
  {
    "text": "stuff for that that stuff's more like notice or info level and then we have a third class",
    "start": "1290600",
    "end": "1295640"
  },
  {
    "text": "which is basically whatever object comes in we just print it out that's actually that rule is actually off by default but",
    "start": "1295640",
    "end": "1301220"
  },
  {
    "text": "it's debug severity so you can turn it back on if you want alright so we'll create a deployment here and then Falco",
    "start": "1301220",
    "end": "1310400"
  },
  {
    "text": "what detect it so in this case it was info saying hey somebody created a deployment we can see what the user is",
    "start": "1310400",
    "end": "1315890"
  },
  {
    "text": "what the name of the deployment is the namespace that we're in what the response was and you know the auth",
    "start": "1315890",
    "end": "1321320"
  },
  {
    "text": "reason and that kind of stuff so let's delete that deployment",
    "start": "1321320",
    "end": "1329500"
  },
  {
    "text": "so up for us everything's in my demo",
    "start": "1334370",
    "end": "1340490"
  },
  {
    "text": "namespace so we're gonna delete the deployment same thing happens down here we can see that hey somebody deleted the",
    "start": "1340490",
    "end": "1348380"
  },
  {
    "text": "deployment that we just created you can do the same thing for a service so we",
    "start": "1348380",
    "end": "1354020"
  },
  {
    "text": "have you know support for all the major classes of objects in there so if we create a nginx service it works if we",
    "start": "1354020",
    "end": "1361160"
  },
  {
    "text": "delete a and the next service it works",
    "start": "1361160",
    "end": "1365020"
  },
  {
    "text": "and so there you go so we get all that basic stuff what was I going to do next",
    "start": "1374260",
    "end": "1381179"
  },
  {
    "text": "okay so let's show that config map example again so here's a sample config",
    "start": "1381240",
    "end": "1390610"
  },
  {
    "text": "the config map that Justin yeah mole and you can see here this yeah yes I did I really did put my AWS access key in it",
    "start": "1390610",
    "end": "1398169"
  },
  {
    "text": "just called my access key so I don't know if a double yes will like it but we'll just do it anyway so we'll create this so we created the",
    "start": "1398169",
    "end": "1412000"
  },
  {
    "text": "config map and then Falco detected it because we saw the audit event that reflected the config Mac being created",
    "start": "1412000",
    "end": "1418360"
  },
  {
    "text": "all the fields that we had looked in the config back contents for something called AWS access key when it did we",
    "start": "1418360",
    "end": "1425260"
  },
  {
    "text": "sent you an information about it you can see here the severity is warning because it's probably shadier than just somebody",
    "start": "1425260",
    "end": "1430510"
  },
  {
    "text": "creating one right next oh yeah let's",
    "start": "1430510",
    "end": "1438309"
  },
  {
    "text": "try our you know one of the one of the things we always show with Falco is exacting into a container so we'll do the same thing over in Kate's audit",
    "start": "1438309",
    "end": "1444730"
  },
  {
    "text": "lands so let's create our nginx deployment again",
    "start": "1444730",
    "end": "1450960"
  },
  {
    "text": "wait for a pod and so you see it created the deployment right okay and then we'll",
    "start": "1454020",
    "end": "1459180"
  },
  {
    "text": "exactly into it so here we did cue",
    "start": "1459180",
    "end": "1471420"
  },
  {
    "text": "cuddle exact into the pod and we detected that too you know the reason we really focus on this you like cube exact",
    "start": "1471420",
    "end": "1477690"
  },
  {
    "text": "stuff is it's like a pretty powerful mechanism for privilege escalation which is you know a great way when somebody",
    "start": "1477690",
    "end": "1483900"
  },
  {
    "text": "gets in to start getting more power right so if you can exact into a pod you're gonna be a slowly inherit all of",
    "start": "1483900",
    "end": "1489840"
  },
  {
    "text": "the permissions that you've granted to that pod so if somebody can get in they can do and that pot is really powerful",
    "start": "1489840",
    "end": "1495810"
  },
  {
    "text": "and has lots of privileges they're gonna be able to do most of those things as well so it's a great way to get in so",
    "start": "1495810",
    "end": "1502050"
  },
  {
    "text": "you know again we saw that the exec happened we checked to see well yeah but",
    "start": "1502050",
    "end": "1507480"
  },
  {
    "text": "that's all we did for this one it was that notice level and say hey somebody exacted into a pot you might want to check it out all right let's do some",
    "start": "1507480",
    "end": "1515250"
  },
  {
    "text": "like service account stuff so what did I",
    "start": "1515250",
    "end": "1523200"
  },
  {
    "text": "call it so what let's try something where we create a service account and in",
    "start": "1523200",
    "end": "1529970"
  },
  {
    "text": "accidentally or negligently give it too many permissions so a create a service account called bad account and then",
    "start": "1529970",
    "end": "1538560"
  },
  {
    "text": "we'll take that service account and create a cluster role binding that binds it to cluster admin so cluster admin has",
    "start": "1538560",
    "end": "1545310"
  },
  {
    "text": "lots of powers you probably don't want to do that following the principles of least privilege so if you did do that",
    "start": "1545310",
    "end": "1550640"
  },
  {
    "text": "falco would notice that and send you and send you information about it saying hey somebody created a cluster of ol binding",
    "start": "1550640",
    "end": "1557250"
  },
  {
    "text": "to the cluster admin role maybe that's something you didn't want to allow and you should check it out",
    "start": "1557250",
    "end": "1563179"
  },
  {
    "text": "another thing we can do is let's look at this one so here we have a cluster role",
    "start": "1564320",
    "end": "1572400"
  },
  {
    "text": "in cluster role binding where we're gonna grant too many permissions to a given cluster role or two we're going to",
    "start": "1572400",
    "end": "1579270"
  },
  {
    "text": "define a cluster role with too many pressures then grant it to a user so let's say you you use wild carding like",
    "start": "1579270",
    "end": "1585660"
  },
  {
    "text": "oh I'm too lazy to name the Reese courses that this guy can read so I'll just do star well don't do that either",
    "start": "1585660",
    "end": "1590980"
  },
  {
    "text": "and we have some rules in Falco that say hey if you try to do that we're gonna you know let you know that somebody's",
    "start": "1590980",
    "end": "1596890"
  },
  {
    "text": "doing that",
    "start": "1596890",
    "end": "1599280"
  },
  {
    "text": "so here you can see the cluster roll binding was created but when you look at the cluster roll it has something with a",
    "start": "1604510",
    "end": "1610720"
  },
  {
    "text": "wild-card so we're basically looking at the rules that are defined by the cluster roll seeing if there's a wild-card in there",
    "start": "1610720",
    "end": "1616030"
  },
  {
    "text": "and if there is well you know let you know about it similarly if getting back to that pod",
    "start": "1616030",
    "end": "1623260"
  },
  {
    "text": "exact thing if here let's just take a look at it if you didn't grant anybody",
    "start": "1623260",
    "end": "1629049"
  },
  {
    "text": "pot exact permissions but you did grant them the ability to grant more permissions well the first thing we'll do is give them so the ability to",
    "start": "1629049",
    "end": "1635140"
  },
  {
    "text": "executive pods so this is a cluster role that allows pod exact the way that works",
    "start": "1635140",
    "end": "1640390"
  },
  {
    "text": "is you just have a resources called pods exec and I get on it and then that allows you to do exec so if you try to",
    "start": "1640390",
    "end": "1647320"
  },
  {
    "text": "create one of those again we notice so",
    "start": "1647320",
    "end": "1656919"
  },
  {
    "text": "we see that you created the cluster role that had the ability to do pod execs and",
    "start": "1656919",
    "end": "1662049"
  },
  {
    "text": "we let you know hey somebody did that maybe you should check it out and keep an eye on it and I think I got one more",
    "start": "1662049",
    "end": "1668290"
  },
  {
    "text": "yeah okay so on you know maybe you're running platform as a service and you're",
    "start": "1668290",
    "end": "1673600"
  },
  {
    "text": "trying to you know keep people off in their own namespaces but you don't want to allow arbitrary namespaces because",
    "start": "1673600",
    "end": "1678730"
  },
  {
    "text": "you know maybe you don't want to let I know the crypto miners in there smart and they'll kind of they'll put stuff",
    "start": "1678730",
    "end": "1684850"
  },
  {
    "text": "over and maybe they'll put it in a namespace secret namespace one of the",
    "start": "1684850",
    "end": "1692559"
  },
  {
    "text": "things that we have in Falco is that we you can define a list of the namespaces that are allowed for you and you can",
    "start": "1692559",
    "end": "1698230"
  },
  {
    "text": "turn the rule off you can also say everything is allowed but by default you know we only have a few namespaces that you allowed if you did oh create",
    "start": "1698230",
    "end": "1705160"
  },
  {
    "text": "namespace so if you created that namespace in order to like hide your",
    "start": "1705160",
    "end": "1710830"
  },
  {
    "text": "activities from everybody else we noticed that because we have a list of allowed namespaces you create",
    "start": "1710830",
    "end": "1716470"
  },
  {
    "text": "something outside the list and we let you know about it okay so obviously",
    "start": "1716470",
    "end": "1721720"
  },
  {
    "text": "there's tons of other rules that we have and then they're in there and one of the things we really want because you know we've only released this in the last",
    "start": "1721720",
    "end": "1727540"
  },
  {
    "text": "like month or two and we really want feedback on like what kind of rules can we add are the rules that are in there going to",
    "start": "1727540",
    "end": "1733490"
  },
  {
    "start": "1728000",
    "end": "1823000"
  },
  {
    "text": "work for you you know that's something where we took a stab at it but we'd love to get feedback from you guys on like rules you'd like to see or use cases so",
    "start": "1733490",
    "end": "1740840"
  },
  {
    "text": "please let us know about that so wrap it up real quick here's all the links to",
    "start": "1740840",
    "end": "1747140"
  },
  {
    "text": "all the things you know falcata falco org is our new website under the cnc f",
    "start": "1747140",
    "end": "1752300"
  },
  {
    "text": "so it's divorced from cystic so you can go to there to get all these other things the public slack i guess is so",
    "start": "1752300",
    "end": "1759080"
  },
  {
    "text": "under cystic but it's a there's a channel they're called falco we all hang out there try to answer questions if you",
    "start": "1759080",
    "end": "1764390"
  },
  {
    "text": "know I know some people answer each other's questions which is even better because then I don't have to answer them so you know go there if you want to",
    "start": "1764390",
    "end": "1770690"
  },
  {
    "text": "learn more about it or it's not working for you will try to answer we got a bunch of blog posts on the Cystic comp",
    "start": "1770690",
    "end": "1776540"
  },
  {
    "text": "website that talked about use cases with falco sample integrations that kind of stuff it's a great way to figure out",
    "start": "1776540",
    "end": "1782150"
  },
  {
    "text": "like oh how can they do falco to detect this and that kind of stuff as a part of the CN CF migration we've moved over",
    "start": "1782150",
    "end": "1788380"
  },
  {
    "text": "falco to its own organization falco security so it's not under drea said anymore so if alko's security slash palco we got",
    "start": "1788380",
    "end": "1796310"
  },
  {
    "text": "a wiki there that describes how to use falco there's a page there now talking about kubernetes audit support so how to",
    "start": "1796310",
    "end": "1802040"
  },
  {
    "text": "get all this stuff up and running and also we you know you can always run Falco's a container you know in a daemon",
    "start": "1802040",
    "end": "1809480"
  },
  {
    "text": "said of course for kubernetes and we just moved it over to falco security so again it's his own organization not",
    "start": "1809480",
    "end": "1816170"
  },
  {
    "text": "ordered reyes anymore alright thanks a lot",
    "start": "1816170",
    "end": "1821680"
  }
]