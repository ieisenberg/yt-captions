[
  {
    "text": "hello uh welcome to the next tutorial which is about building secure and",
    "start": "80",
    "end": "6319"
  },
  {
    "text": "decentralized global applications running on kubernetes using nets my name is valden archebedo",
    "start": "6319",
    "end": "13120"
  },
  {
    "text": "one of the core maintainers from nets",
    "start": "13120",
    "end": "17920"
  },
  {
    "text": "you can find me twitter as a wall qs i'm a software engineer inside nadia where many of the",
    "start": "18240",
    "end": "23600"
  },
  {
    "text": "maintainers of nets are working i've been a long time snaps user i wrote",
    "start": "23600",
    "end": "29039"
  },
  {
    "text": "a book about nets a couple of years ago covering many of the basic concepts some",
    "start": "29039",
    "end": "34960"
  },
  {
    "text": "some of the messaging patterns that you can do with nets and in this talk this tutorial we're",
    "start": "34960",
    "end": "42000"
  },
  {
    "text": "gonna cover how to set up a decentralized authorization scheme for a next cluster then we'll",
    "start": "42000",
    "end": "49280"
  },
  {
    "text": "deploy a net super cluster of three regions using helm now let's show the internals",
    "start": "49280",
    "end": "55840"
  },
  {
    "text": "of a chat demo application that is using those credentials and dynamic provisioning",
    "start": "55840",
    "end": "61920"
  },
  {
    "text": "credentials and a global net super cluster",
    "start": "61920",
    "end": "67280"
  },
  {
    "text": "this is how the net application chat application looks like",
    "start": "67280",
    "end": "72560"
  },
  {
    "text": "you can have a number of channels and then users can send messages to",
    "start": "72560",
    "end": "79360"
  },
  {
    "text": "any anyone that is member of that channel and you also have they also have support for direct",
    "start": "79360",
    "end": "85119"
  },
  {
    "text": "messages and in case uh one of those messages uh whenever you receive a message you'll",
    "start": "85119",
    "end": "92079"
  },
  {
    "text": "get a dot basically telling you they have a new message um in terms of a nuts strings",
    "start": "92079",
    "end": "100240"
  },
  {
    "text": "or subscriptions this how they look like in terms of the subjects that are going",
    "start": "100240",
    "end": "106320"
  },
  {
    "text": "to be used we'll have a subject named chat.kubecon.posts",
    "start": "106320",
    "end": "112000"
  },
  {
    "text": "and um is the wild card uh the asterisk is wild card so that",
    "start": "112000",
    "end": "117759"
  },
  {
    "text": "whenever you post to kubecon that's gonna be represented by a message that is on the subject",
    "start": "117759",
    "end": "123439"
  },
  {
    "text": "that post.kucon or for the nuts channel and dot snats on general the same",
    "start": "123439",
    "end": "131360"
  },
  {
    "text": "then the dms uh how will they will be implemented are quite interesting",
    "start": "131360",
    "end": "136959"
  },
  {
    "text": "but as a user as a client user will be able to receive message messages from anyone that is",
    "start": "136959",
    "end": "143040"
  },
  {
    "text": "part of the cluster a part of their that is connected to the cluster",
    "start": "143040",
    "end": "149120"
  },
  {
    "text": "and also you eventually be sending regular events status events so to show",
    "start": "149120",
    "end": "157200"
  },
  {
    "text": "announce to everyone that is connected to the chat service that you're online",
    "start": "157200",
    "end": "165680"
  },
  {
    "text": "and also in terms of the services because nuts have support for on not only a sequence of events and",
    "start": "166000",
    "end": "171680"
  },
  {
    "text": "streams uh you can also use services so basically have uh make rpc",
    "start": "171680",
    "end": "176800"
  },
  {
    "text": "requests on to get a single response so in this case",
    "start": "176800",
    "end": "184879"
  },
  {
    "text": "a service that will be part of this is the request for access service so this",
    "start": "184879",
    "end": "191280"
  },
  {
    "text": "there's going to be a single subscriber part of this and that's a cluster that whenever you make a request",
    "start": "191280",
    "end": "198560"
  },
  {
    "text": "with some payload in this case the payload is going to be the username but you can make a request to",
    "start": "198560",
    "end": "205480"
  },
  {
    "text": "chat.rec.access to get some uh ephemeral uh well ephemeral",
    "start": "205480",
    "end": "211360"
  },
  {
    "text": "unique credentials for that user and those are going to be generated on demand for each one of the",
    "start": "211360",
    "end": "217920"
  },
  {
    "text": "users in terms of the global topology this is how it's going to look",
    "start": "217920",
    "end": "223920"
  },
  {
    "text": "i will set up a cluster and that's cluster in san francisco amsterdam attending virtually and",
    "start": "223920",
    "end": "231120"
  },
  {
    "text": "also another one in singapore there's going to be a credential service that could be connected anywhere",
    "start": "231120",
    "end": "237439"
  },
  {
    "text": "uh it's going to be a q subscription so that it can you can have multiple of them and they will become a load balance and",
    "start": "237439",
    "end": "243760"
  },
  {
    "text": "then the chat uh client application can be connected to uh anywhere uh from this part of the",
    "start": "243760",
    "end": "250959"
  },
  {
    "text": "cluster so there is there's again decentralized there is no center all of this could be running everywhere",
    "start": "250959",
    "end": "257840"
  },
  {
    "text": "so i'm going to get started and so the first thing we need to",
    "start": "257840",
    "end": "265600"
  },
  {
    "text": "do is set up the",
    "start": "266800",
    "end": "270560"
  },
  {
    "text": "uh off for the cluster so we are going to",
    "start": "271919",
    "end": "283840"
  },
  {
    "text": "first uh install nsc in case it's not available nsc is the",
    "start": "285919",
    "end": "292400"
  },
  {
    "text": "tool that you can use to manage users nets users and accounts in nets",
    "start": "292400",
    "end": "300800"
  },
  {
    "text": "there is a one liner that will install it for you you can peek at the contents in case",
    "start": "300800",
    "end": "308160"
  },
  {
    "text": "you're concerned of the uh what well the uh whether schemes",
    "start": "308160",
    "end": "314960"
  },
  {
    "text": "uh you want to pick up the contents basically or you can just use hom hombre to install it so we'll",
    "start": "314960",
    "end": "321280"
  },
  {
    "text": "need nsc and there is a we'll use this uh",
    "start": "321280",
    "end": "328320"
  },
  {
    "text": "script in a setup that is part of the kubernetes repo and also all of this is going to be",
    "start": "328320",
    "end": "334160"
  },
  {
    "text": "available on another uh for the kubecon 2020",
    "start": "334160",
    "end": "339919"
  },
  {
    "text": "so you can see all of the code and examples here as well so let's first let's get started and",
    "start": "339919",
    "end": "348400"
  },
  {
    "text": "bootstrap the authorization",
    "start": "348400",
    "end": "353840"
  },
  {
    "text": "okay so let's go into the kubecon 2020",
    "start": "353840",
    "end": "361520"
  },
  {
    "text": "folder and make uh uh run this",
    "start": "361520",
    "end": "369360"
  },
  {
    "text": "script that is going to create some accounts for us",
    "start": "369360",
    "end": "373440"
  },
  {
    "text": "uh one of them is that it's going to create the operator jwt that is going to be used like the root",
    "start": "374720",
    "end": "380639"
  },
  {
    "text": "of trust from the whole cluster and we also create a system account and a couple of accounts for testing",
    "start": "380639",
    "end": "387600"
  },
  {
    "text": "and one for stand for example in case it could be used uh we're not going to",
    "start": "387600",
    "end": "394080"
  },
  {
    "text": "use it particularly in this tutorial but it's just like a generic",
    "start": "394080",
    "end": "399680"
  },
  {
    "text": "account and the operator generality is quite",
    "start": "399680",
    "end": "406840"
  },
  {
    "text": "important as i mentioned is the uh root of trust from the from the whole",
    "start": "406840",
    "end": "412800"
  },
  {
    "text": "cluster you can see that it is set to it was issued",
    "start": "412800",
    "end": "418560"
  },
  {
    "text": "uh this doesn't expire but you can",
    "start": "418560",
    "end": "423840"
  },
  {
    "text": "you take a look at the script you can also check out how when you want to make it expire and solo that can be",
    "start": "424000",
    "end": "431680"
  },
  {
    "text": "configured so for the purposes of this demo we're going to need at least",
    "start": "431680",
    "end": "438639"
  },
  {
    "text": "three different users one is going to be the user for requesting credentials",
    "start": "438639",
    "end": "445520"
  },
  {
    "text": "and there is going to be a user that has very constrained permissions then we will need a",
    "start": "445520",
    "end": "451280"
  },
  {
    "text": "credentials provisioner that is able to respond to those requests so those are the service",
    "start": "451280",
    "end": "456560"
  },
  {
    "text": "interactions and also we need user credentials for each one of the",
    "start": "456560",
    "end": "462160"
  },
  {
    "text": "users these are going to be dynamically uh generated and i'm going to show how this is done so but first let's",
    "start": "462160",
    "end": "469360"
  },
  {
    "text": "create a kubecon account let's create a cubicle account",
    "start": "469360",
    "end": "476960"
  },
  {
    "text": "so all of these uh users are going to be part of this",
    "start": "477280",
    "end": "483280"
  },
  {
    "text": "kubecon account and we'll do something special with this",
    "start": "483280",
    "end": "489360"
  },
  {
    "text": "account is and that is we're gonna create a signing key this signing key",
    "start": "489360",
    "end": "497199"
  },
  {
    "text": "is um it is an extra key that is gonna belong to this uh",
    "start": "497199",
    "end": "503440"
  },
  {
    "text": "cubecon account and it is essentially what we'll be using to create the new",
    "start": "503440",
    "end": "511039"
  },
  {
    "text": "uh users that are part of this cluster by using the dynamic credentials",
    "start": "511039",
    "end": "518839"
  },
  {
    "text": "provisioner so let's edit the account using this uh",
    "start": "518839",
    "end": "527760"
  },
  {
    "text": "signing key the signing key is the one that got that is in the output the second one",
    "start": "528160",
    "end": "534240"
  },
  {
    "text": "here in the output a a means that is a public key s means that it's a private",
    "start": "534240",
    "end": "539839"
  },
  {
    "text": "uh key so this is the one that we want to use so now let's edit the account",
    "start": "539839",
    "end": "548240"
  },
  {
    "text": "for kubecon and add another jdo uh signing key so let's inspect",
    "start": "548240",
    "end": "555920"
  },
  {
    "text": "you can see that have a signing key now next we want to use we're going to",
    "start": "555920",
    "end": "562399"
  },
  {
    "text": "create the credentials for the provisioner",
    "start": "562399",
    "end": "570080"
  },
  {
    "text": "we still need to continue to use the",
    "start": "570080",
    "end": "576880"
  },
  {
    "text": "signing key so i'm going to replace this here with the one that got generated",
    "start": "576880",
    "end": "585040"
  },
  {
    "text": "and it is limited in terms of the messages that it can respond so you can",
    "start": "586399",
    "end": "593360"
  },
  {
    "text": "only subscribe to requests for credentials in this case it's going to be a chat",
    "start": "593360",
    "end": "598800"
  },
  {
    "text": "dot direct dot access and it is going to be able to respond to",
    "start": "598800",
    "end": "605920"
  },
  {
    "text": "requests so that's why we need this uh inbox uh so at the core level everything",
    "start": "605920",
    "end": "611120"
  },
  {
    "text": "else is still publish uh subscribe and so in order to be able to",
    "start": "611120",
    "end": "618880"
  },
  {
    "text": "reply to requests we need to make requests we also need to make a subscription to inbox",
    "start": "618880",
    "end": "626079"
  },
  {
    "text": "and because there is going to be a super cluster that is going to be multi-region we also need an extra level",
    "start": "626079",
    "end": "631600"
  },
  {
    "text": "of permissions which is at the underscore are or routed globally requests that are routed globally",
    "start": "631600",
    "end": "638240"
  },
  {
    "text": "so we'll need these permissions and let's go ahead and create the user",
    "start": "638240",
    "end": "644560"
  },
  {
    "text": "so you have a new user now let's create the user for",
    "start": "645360",
    "end": "651680"
  },
  {
    "text": "uh asking for credentials this similar to the request uh the",
    "start": "652800",
    "end": "660079"
  },
  {
    "text": "subscribe the provision there also have very",
    "start": "660079",
    "end": "665120"
  },
  {
    "text": "limited permissions you can only request for credentials and you cannot do anything else",
    "start": "665120",
    "end": "670720"
  },
  {
    "text": "so the type of message you can send is for getting more credentials so it's going to be a harmless",
    "start": "670720",
    "end": "676959"
  },
  {
    "text": "user so now we have this couple of users",
    "start": "676959",
    "end": "682399"
  },
  {
    "text": "created and",
    "start": "682640",
    "end": "688000"
  },
  {
    "text": "let's just confirm",
    "start": "688000",
    "end": "691120"
  },
  {
    "text": "yeah so you can only publish to chat.rec access and send messages to",
    "start": "696320",
    "end": "703600"
  },
  {
    "text": "inbox receive messages from receive responses",
    "start": "703600",
    "end": "709040"
  },
  {
    "text": "uh with this we're ready to start confirming the setup locally and show",
    "start": "709200",
    "end": "716399"
  },
  {
    "text": "some of the code as well i'm gonna make this a little bit bigger",
    "start": "716399",
    "end": "731839"
  },
  {
    "text": "so now we are going to start the nat server",
    "start": "732800",
    "end": "737680"
  },
  {
    "text": "but for this before we to do so we need to create a",
    "start": "738880",
    "end": "744000"
  },
  {
    "text": "the configuration formats that includes all this information about the accounts so",
    "start": "744000",
    "end": "750800"
  },
  {
    "text": "nsc can help generating this uh in this case we're gonna use a static",
    "start": "750800",
    "end": "757279"
  },
  {
    "text": "memory resolver that gives contains the jwts from each one of the",
    "start": "757279",
    "end": "762480"
  },
  {
    "text": "accounts so the these the nat servers do not have any notion of the users that are part of the system",
    "start": "762480",
    "end": "769040"
  },
  {
    "text": "but those need um something that uh at least notion of",
    "start": "769040",
    "end": "775760"
  },
  {
    "text": "which are the accounts that are in this part of the cluster so that under the word sign and all their signing keys and stuff so in",
    "start": "775760",
    "end": "782880"
  },
  {
    "text": "this case we generate the config we include the operator jw key here i",
    "start": "782880",
    "end": "788320"
  },
  {
    "text": "named it ko and we also have this a system account that i can show that is for able to inspect",
    "start": "788320",
    "end": "796720"
  },
  {
    "text": "system events that are flying by in the cluster so we use this configuration",
    "start": "796720",
    "end": "806079"
  },
  {
    "text": "and let's start in that server conf resolver",
    "start": "809279",
    "end": "815440"
  },
  {
    "text": "so we see that we have a new uh a ko operator with the latest nets",
    "start": "815440",
    "end": "823120"
  },
  {
    "text": "that is uh available for requests on the port 422",
    "start": "823120",
    "end": "828399"
  },
  {
    "text": "which is the portfolio client connections we'll make a simple mock request using",
    "start": "828399",
    "end": "834880"
  },
  {
    "text": "the credentials that we created",
    "start": "834880",
    "end": "840320"
  },
  {
    "text": "i'm going to start at your screen session",
    "start": "840560",
    "end": "844160"
  },
  {
    "text": "so we're going to try to make a request to nets and there's no",
    "start": "848560",
    "end": "857839"
  },
  {
    "text": "access okay try to make a request for nets but there",
    "start": "859279",
    "end": "864560"
  },
  {
    "text": "are no responders uh to able to provision these requests provision",
    "start": "864560",
    "end": "870240"
  },
  {
    "text": "credentials or response basically because right now there's no logic still we're just creating a mock",
    "start": "870240",
    "end": "876560"
  },
  {
    "text": "service that is going to be able to respond to this request so now we have a mock responder",
    "start": "876560",
    "end": "883120"
  },
  {
    "text": "make another request and we can see that uh there's a request response uh",
    "start": "883120",
    "end": "889120"
  },
  {
    "text": "interaction with these two if i try to make another request here i'm gonna get uh deny",
    "start": "889120",
    "end": "897760"
  },
  {
    "text": "the same if i try to subscribe to another subject is not possible",
    "start": "897760",
    "end": "905040"
  },
  {
    "text": "so those are the only things you can do with these credentials the",
    "start": "905040",
    "end": "910480"
  },
  {
    "text": "ones for the making requests and the one for provisioning or basically just responding",
    "start": "910480",
    "end": "916000"
  },
  {
    "text": "to anything that is any message that is sent to this subject",
    "start": "916000",
    "end": "921760"
  },
  {
    "text": "okay so using those credentials and let's try to create a",
    "start": "922720",
    "end": "932240"
  },
  {
    "text": "provisioner it's just crashed",
    "start": "936399",
    "end": "941839"
  },
  {
    "text": "so imax just crashed and but anyway",
    "start": "952160",
    "end": "958639"
  },
  {
    "text": "uh repose next step",
    "start": "959279",
    "end": "963519"
  },
  {
    "text": "wally keep okay so we have the tutorial",
    "start": "966240",
    "end": "973120"
  },
  {
    "text": "so this is where we were and",
    "start": "977680",
    "end": "983839"
  },
  {
    "text": "we want to start the provisioner and we need to pass it the",
    "start": "986639",
    "end": "997040"
  },
  {
    "text": "signing key as it was mentioned before",
    "start": "997040",
    "end": "1001440"
  },
  {
    "text": "the code is inside of this let's chat access within the repo so let's go ahead and",
    "start": "1005279",
    "end": "1012320"
  },
  {
    "text": "start it",
    "start": "1012320",
    "end": "1014800"
  },
  {
    "text": "we have now uh something that can prohibition requests and let's try to make a request to get some credentials",
    "start": "1017759",
    "end": "1025678"
  },
  {
    "text": "i'm going to make request fetch credentials for wall eqs we can see that",
    "start": "1025679",
    "end": "1033839"
  },
  {
    "text": "whenever we make a request and i pass in the payload in this case this which",
    "start": "1033839",
    "end": "1039280"
  },
  {
    "text": "is going to be the username i'm going to get this dynamically generated uh requests uh credentials",
    "start": "1039280",
    "end": "1047918"
  },
  {
    "text": "yeah they're always going to be the same if i type this into let's say my",
    "start": "1047919",
    "end": "1054880"
  },
  {
    "text": "credentials",
    "start": "1054880",
    "end": "1057520"
  },
  {
    "text": "then i'm going to inspect them with",
    "start": "1061360",
    "end": "1067440"
  },
  {
    "text": "let's see you can see that this the provisioner created a",
    "start": "1067440",
    "end": "1074080"
  },
  {
    "text": "very also a limited permissions for this",
    "start": "1074080",
    "end": "1079200"
  },
  {
    "text": "user so the name is a user but it's better and identified by the public",
    "start": "1079280",
    "end": "1084960"
  },
  {
    "text": "uh key that and that's why we needed the signing key to be able to generate these",
    "start": "1084960",
    "end": "1090160"
  },
  {
    "text": "uh users using that key pair so we have at this wall us user that is part of the",
    "start": "1090160",
    "end": "1099120"
  },
  {
    "text": "cubicon account that is only able to send messages to publish that is online",
    "start": "1099120",
    "end": "1104320"
  },
  {
    "text": "on a chat to any other messages and this is a very interesting that it's",
    "start": "1104320",
    "end": "1110799"
  },
  {
    "text": "you're constrained to only be able to uh read your own uh dm's messages so you",
    "start": "1110799",
    "end": "1117440"
  },
  {
    "text": "can publish to any dm but you can only subscribe to messages that will as represented by the",
    "start": "1117440",
    "end": "1125760"
  },
  {
    "text": "public end key from this user so we can use these credentials to",
    "start": "1125760",
    "end": "1134480"
  },
  {
    "text": "start a session in the chat in the chat folder",
    "start": "1134480",
    "end": "1140720"
  },
  {
    "text": "let's create a session",
    "start": "1142000",
    "end": "1151200"
  },
  {
    "text": "regrets so you can now send messages",
    "start": "1151200",
    "end": "1156559"
  },
  {
    "text": "and let's create another user",
    "start": "1162720",
    "end": "1169919"
  },
  {
    "text": "and let's say attendee",
    "start": "1171360",
    "end": "1177039"
  },
  {
    "text": "credentials and chat",
    "start": "1182960",
    "end": "1188559"
  },
  {
    "text": "regrets",
    "start": "1190840",
    "end": "1193840"
  },
  {
    "text": "okay",
    "start": "1204840",
    "end": "1207840"
  },
  {
    "text": "type",
    "start": "1212320",
    "end": "1214639"
  },
  {
    "text": "chat you have a couple of users",
    "start": "1218840",
    "end": "1225120"
  },
  {
    "text": "welcome to kubecon 2020.",
    "start": "1225600",
    "end": "1231039"
  },
  {
    "text": "[Music] let's start this server and move it to trace to show some of the messages",
    "start": "1232490",
    "end": "1239840"
  },
  {
    "text": "so everything should just reconnect to the server you can see that most of the",
    "start": "1240960",
    "end": "1248000"
  },
  {
    "text": "traffic that is flying by is just uh jwts being exchanged",
    "start": "1248000",
    "end": "1253279"
  },
  {
    "text": "and it is just in the jbl jwt library front you can find in that's io",
    "start": "1254000",
    "end": "1262640"
  },
  {
    "text": "so yeah we can send messages to the",
    "start": "1262640",
    "end": "1270000"
  },
  {
    "text": "general channel uh not so for example you can send",
    "start": "1270000",
    "end": "1277840"
  },
  {
    "text": "private messages you can see that there's a dot now let",
    "start": "1280080",
    "end": "1287679"
  },
  {
    "text": "me receive the message you can read it okay so how does this work let's go",
    "start": "1287679",
    "end": "1295840"
  },
  {
    "text": "take a look at the code",
    "start": "1295840",
    "end": "1298880"
  },
  {
    "text": "uh first let's check the provisioner how it's approaching the requests",
    "start": "1303360",
    "end": "1309679"
  },
  {
    "text": "this is again a service and this means that",
    "start": "1309679",
    "end": "1316320"
  },
  {
    "text": "service it is something that you usually expect to be for it to be load balanced so we're going to be using a q",
    "start": "1316840",
    "end": "1323919"
  },
  {
    "text": "subscription and in this case is receiving a request on the",
    "start": "1323919",
    "end": "1330720"
  },
  {
    "text": "uh chat.rec access as we have said previously so it is receiving",
    "start": "1331039",
    "end": "1338000"
  },
  {
    "text": "request on chat rep wreck access",
    "start": "1338000",
    "end": "1343200"
  },
  {
    "text": "and it's going to regenerate uh requests on the fly for the user on",
    "start": "1343200",
    "end": "1351440"
  },
  {
    "text": "a number of subjects they went for heartbeats for the general channels and",
    "start": "1351440",
    "end": "1356559"
  },
  {
    "text": "dms and it's going to use the signing key that we passed to the provision article to",
    "start": "1356559",
    "end": "1363440"
  },
  {
    "text": "create uh the users and also uh take advantage of that identity to",
    "start": "1363440",
    "end": "1370559"
  },
  {
    "text": "control to create a unique channels for the dms",
    "start": "1370559",
    "end": "1375600"
  },
  {
    "text": "and this is uh in terms of the code how it's created there",
    "start": "1375600",
    "end": "1382158"
  },
  {
    "text": "the jwt the credentials so",
    "start": "1382880",
    "end": "1390559"
  },
  {
    "text": "it is creating the",
    "start": "1390559",
    "end": "1393440"
  },
  {
    "text": "correct theme create the generating encoding into a",
    "start": "1395840",
    "end": "1402080"
  },
  {
    "text": "byte payload into bytes and then just generating these",
    "start": "1402080",
    "end": "1409120"
  },
  {
    "text": "credentials that are very similar to the credentials that we have used uh created with nse before",
    "start": "1409760",
    "end": "1416559"
  },
  {
    "text": "so this is a very simple provider use a q subscription that represents the service and then",
    "start": "1416559",
    "end": "1422640"
  },
  {
    "text": "respond with the credentials uh the next request was just a simple",
    "start": "1422640",
    "end": "1428559"
  },
  {
    "text": "nuts request and so it's just calling a request in the api level",
    "start": "1428559",
    "end": "1433919"
  },
  {
    "text": "and for the chat application it works by using those credentials and",
    "start": "1433919",
    "end": "1444480"
  },
  {
    "text": "it subscribes to a number of streams",
    "start": "1444480",
    "end": "1449919"
  },
  {
    "text": "you can have we can see that there is a stream for the channels kind of posts up",
    "start": "1449919",
    "end": "1457200"
  },
  {
    "text": "for the dms and for sending the events that they're online and whenever we want to",
    "start": "1457200",
    "end": "1464320"
  },
  {
    "text": "publish something we will uh",
    "start": "1464320",
    "end": "1470880"
  },
  {
    "text": "of course send periodic events for that we are still online and also",
    "start": "1470880",
    "end": "1477600"
  },
  {
    "text": "in case we want to post to one of the channels we will send uh",
    "start": "1477600",
    "end": "1487840"
  },
  {
    "text": "a request okay it's fine",
    "start": "1490080",
    "end": "1496559"
  },
  {
    "text": "so we're to publish into this a certain subject and in for dms we need the",
    "start": "1498559",
    "end": "1503919"
  },
  {
    "text": "to have received a previous heartbeat so that we can talk to it so we need the because we",
    "start": "1503919",
    "end": "1509200"
  },
  {
    "text": "need to use the public end key we need to receive at least an availability status from one of the",
    "start": "1509200",
    "end": "1515360"
  },
  {
    "text": "car bidding that happens periodically",
    "start": "1515360",
    "end": "1520559"
  },
  {
    "text": "so it's pretty simple and there's a very nice ui wrapper using one of the libraries from",
    "start": "1520559",
    "end": "1526559"
  },
  {
    "text": "go but in terms of nets uh it's pretty straightforward what it's doing most of the heavy lifting is done",
    "start": "1526559",
    "end": "1532799"
  },
  {
    "text": "by the uh authorization okay so this is uh how it looks like",
    "start": "1532799",
    "end": "1540880"
  },
  {
    "text": "running locally let's leave this like that",
    "start": "1540880",
    "end": "1548640"
  },
  {
    "text": "so you can just leave it there and we can reconnect to another super cluster later so we'll",
    "start": "1550880",
    "end": "1558640"
  },
  {
    "text": "just go ahead and get started creating the super cluster on kubernetes",
    "start": "1558640",
    "end": "1566799"
  },
  {
    "text": "and we're gonna this is gonna be composed of uh three regions as i mentioned at",
    "start": "1568799",
    "end": "1574720"
  },
  {
    "text": "the beginning uh it's gonna be one in uh singapore",
    "start": "1574720",
    "end": "1581039"
  },
  {
    "text": "and in singapore amsterdam and san francisco we're going to connect the chat the clients similar to how we did",
    "start": "1581760",
    "end": "1587760"
  },
  {
    "text": "locally but they're going to be now uh connected to these other nodes",
    "start": "1587760",
    "end": "1593919"
  },
  {
    "text": "um we're going to keep it simple in terms of the um tutorial we're going",
    "start": "1593919",
    "end": "1599279"
  },
  {
    "text": "to it's going to be using the public eyepiece from the notes uh we're going to create",
    "start": "1599279",
    "end": "1604480"
  },
  {
    "text": "uh two different clusters and using the digital lotion we need the firewall to be open because",
    "start": "1604480",
    "end": "1611039"
  },
  {
    "text": "we're going to be using uh host parts for the port the four to the two and",
    "start": "1611039",
    "end": "1616240"
  },
  {
    "text": "seven especially 75 22 which is the one for the gateway connections",
    "start": "1616240",
    "end": "1622080"
  },
  {
    "text": "as represented here by these are blue arrows arrows and we also leave open the",
    "start": "1622080",
    "end": "1630559"
  },
  {
    "text": "the port for leaf nodes which is another type of connection that's uh very interesting",
    "start": "1630559",
    "end": "1635840"
  },
  {
    "text": "that allows you to create at least hop and stock uh topologies so essentially you can use this super",
    "start": "1635840",
    "end": "1642240"
  },
  {
    "text": "super cluster later as a way to be able to communicate",
    "start": "1642240",
    "end": "1647679"
  },
  {
    "text": "with uh multiple nuts clusters without them be them being",
    "start": "1647679",
    "end": "1653760"
  },
  {
    "text": "themselves becoming uh a cluster um",
    "start": "1653760",
    "end": "1659039"
  },
  {
    "text": "but that can be another tutorial but so we leave those uh open",
    "start": "1659039",
    "end": "1666720"
  },
  {
    "text": "and we'll be using helm for uh for the setup so you can um",
    "start": "1666799",
    "end": "1672240"
  },
  {
    "text": "officially support uh nuts charts nuts helm charts",
    "start": "1672240",
    "end": "1677840"
  },
  {
    "text": "and i'm gonna move this to right now",
    "start": "1677840",
    "end": "1683840"
  },
  {
    "text": "so it's officially support uh help chart so you can repo add this into your",
    "start": "1688559",
    "end": "1697679"
  },
  {
    "text": "list of repos from helm we're gonna create",
    "start": "1697679",
    "end": "1703919"
  },
  {
    "text": "we're gonna upload first to each one of the gateways the resolver configuration",
    "start": "1704640",
    "end": "1713360"
  },
  {
    "text": "just to confirm that we are already have provisioned the clusters",
    "start": "1714960",
    "end": "1722240"
  },
  {
    "text": "so we right now i'm using the cluster from",
    "start": "1722320",
    "end": "1727919"
  },
  {
    "text": "singapore so i'm going to change to",
    "start": "1728159",
    "end": "1733520"
  },
  {
    "text": "let's say amsterdam",
    "start": "1734559",
    "end": "1739840"
  },
  {
    "text": "okay",
    "start": "1743919",
    "end": "1746240"
  },
  {
    "text": "and we're using the external ips to able to create the super cluster so",
    "start": "1751520",
    "end": "1757200"
  },
  {
    "text": "let's go ahead and create first the nuts accounts it's going to be a",
    "start": "1757200",
    "end": "1762720"
  },
  {
    "text": "configuration map in each one of the clusters and",
    "start": "1762720",
    "end": "1768799"
  },
  {
    "text": "we need to generate the list of uh gateway connections so uh just",
    "start": "1768799",
    "end": "1775279"
  },
  {
    "text": "create a script to create generating them",
    "start": "1775279",
    "end": "1781200"
  },
  {
    "text": "from the api server metadata",
    "start": "1781200",
    "end": "1785519"
  },
  {
    "text": "okay this is wrong",
    "start": "1791679",
    "end": "1795840"
  },
  {
    "text": "yeah so i have uh generated now the list of public ips and we're gonna",
    "start": "1819039",
    "end": "1826240"
  },
  {
    "text": "use this as part of the helm yamo so",
    "start": "1826240",
    "end": "1836159"
  },
  {
    "text": "let's use this explicit list of uh gateways",
    "start": "1836159",
    "end": "1843360"
  },
  {
    "text": "uh going over the configuration a little bit we're using alpine just for simple simple debugging",
    "start": "1843360",
    "end": "1850720"
  },
  {
    "text": "and we'll open a host port for each one of them so that that is done by using this external",
    "start": "1850720",
    "end": "1856799"
  },
  {
    "text": "access flag no logging and that affects performance actually we enable off for the auth we're going",
    "start": "1856799",
    "end": "1863840"
  },
  {
    "text": "to use the nuts accounts configuration map that includes the static configuration from the accounts",
    "start": "1863840",
    "end": "1872640"
  },
  {
    "text": "we're enabling the gateway ports and also for with the explicit ips from",
    "start": "1872640",
    "end": "1878799"
  },
  {
    "text": "amsterdam singapore and san francisco these are exclusive ips but you can use uh for example dns",
    "start": "1878799",
    "end": "1886399"
  },
  {
    "text": "instead on a single endpoint and then you can resolve the a records into a number of",
    "start": "1886399",
    "end": "1892320"
  },
  {
    "text": "nets servers so that is totally fine let's use this configuration now",
    "start": "1892320",
    "end": "1901679"
  },
  {
    "text": "and deployed two coordinates so now we have",
    "start": "1902880",
    "end": "1909840"
  },
  {
    "text": "we should have nine nodes",
    "start": "1912640",
    "end": "1916080"
  },
  {
    "text": "so we see that we got deployed to amsterdam next san francisco next we're",
    "start": "1919279",
    "end": "1926000"
  },
  {
    "text": "gonna be and singapore let's show this",
    "start": "1926000",
    "end": "1935840"
  },
  {
    "text": "okay let's now confirm the setup",
    "start": "1946840",
    "end": "1954320"
  },
  {
    "text": "and get parts",
    "start": "1954320",
    "end": "1962000"
  },
  {
    "text": "that's zero",
    "start": "1962000",
    "end": "1967279"
  },
  {
    "text": "you can see that we have a connectivity between the clusters you can you have a local",
    "start": "1967440",
    "end": "1974880"
  },
  {
    "text": "clustering working and also it has created outbound gateway",
    "start": "1974880",
    "end": "1980720"
  },
  {
    "text": "connections in this case from amsterdam to towards san francisco and let's confirm",
    "start": "1980720",
    "end": "1989600"
  },
  {
    "text": "for example here we are at amsterdam so let's make a quick",
    "start": "1989600",
    "end": "1997200"
  },
  {
    "text": "connection here you can see that we can get on the",
    "start": "1997200",
    "end": "2003840"
  },
  {
    "text": "cluster and we got disconnected because we didn't put any credentials now",
    "start": "2003840",
    "end": "2009840"
  },
  {
    "text": "let's use this to make a request from amsterdam",
    "start": "2009840",
    "end": "2015279"
  },
  {
    "text": "i'm gonna create a service here",
    "start": "2015840",
    "end": "2019840"
  },
  {
    "text": "similar to how we tested locally that the request response was working",
    "start": "2021039",
    "end": "2027518"
  },
  {
    "text": "we have something here working now",
    "start": "2027840",
    "end": "2033039"
  },
  {
    "text": "let's connect this first",
    "start": "2033039",
    "end": "2036240"
  },
  {
    "text": "let's create this service now let's use the one of the ips from",
    "start": "2038399",
    "end": "2044559"
  },
  {
    "text": "san francisco",
    "start": "2044559",
    "end": "2047840"
  },
  {
    "text": "to make a request",
    "start": "2053280",
    "end": "2061839"
  },
  {
    "text": "okay so all of this is being routed uh globally",
    "start": "2064720",
    "end": "2072320"
  },
  {
    "text": "now we can uh [Music]",
    "start": "2076240",
    "end": "2083049"
  },
  {
    "text": "think i'm going to use this to",
    "start": "2085280",
    "end": "2089839"
  },
  {
    "text": "expose the application",
    "start": "2091119",
    "end": "2094480"
  },
  {
    "text": "just a quick example i'm going to show the system credentials",
    "start": "2096159",
    "end": "2103040"
  },
  {
    "text": "just to show how the traffic looks like these are the events that are flowing",
    "start": "2103040",
    "end": "2109440"
  },
  {
    "text": "through the system uh for operations that can be quite useful you can see how many gateways",
    "start": "2109440",
    "end": "2116640"
  },
  {
    "text": "and the stats from each one of the server the servers they're pretty readable and we also have",
    "start": "2116640",
    "end": "2125040"
  },
  {
    "text": "uh extensions to able to ingest this data into prometheus there's the surveyor",
    "start": "2125040",
    "end": "2130960"
  },
  {
    "text": "project so yeah but it's a nice way to inspect",
    "start": "2130960",
    "end": "2137200"
  },
  {
    "text": "how many connections and total connections have",
    "start": "2137200",
    "end": "2142320"
  },
  {
    "text": "and the status from each one of the nodes and whether gateways are happening okay",
    "start": "2143200",
    "end": "2150960"
  },
  {
    "text": "so there's connectivity and we can't",
    "start": "2150960",
    "end": "2157280"
  },
  {
    "text": "um instead of basically doing the same that we were doing before with the",
    "start": "2157280",
    "end": "2165760"
  },
  {
    "text": "credentials let's run the credential instead of a",
    "start": "2165760",
    "end": "2173839"
  },
  {
    "text": "to the local server",
    "start": "2175200",
    "end": "2178640"
  },
  {
    "text": "we can run it here in this case this is a 138 is san francisco so i'm",
    "start": "2180320",
    "end": "2187040"
  },
  {
    "text": "going to say that this comes from sfo i'm going to create a",
    "start": "2187040",
    "end": "2193520"
  },
  {
    "text": "provision here um this is okay",
    "start": "2194000",
    "end": "2201839"
  },
  {
    "text": "okay chat access should be okay now",
    "start": "2214400",
    "end": "2228400"
  },
  {
    "text": "have an extra s so you can see that we connected from",
    "start": "2228400",
    "end": "2234640"
  },
  {
    "text": "sfo let's add another credentials probationer",
    "start": "2234640",
    "end": "2241040"
  },
  {
    "text": "but that is connected from singapore",
    "start": "2241040",
    "end": "2257839"
  },
  {
    "text": "so we're connected from singapore",
    "start": "2259280",
    "end": "2263040"
  },
  {
    "text": "so i have two connections make a third one",
    "start": "2266880",
    "end": "2273759"
  },
  {
    "text": "that's gonna request",
    "start": "2275119",
    "end": "2285838"
  },
  {
    "text": "for credentials let's say it's an attendee so if you make a request to",
    "start": "2289200",
    "end": "2296880"
  },
  {
    "text": "singapore here that is the node that is going to read uh in this case okay",
    "start": "2296880",
    "end": "2305520"
  },
  {
    "text": "it's 38 so x actually they're connected to the same ap",
    "start": "2305520",
    "end": "2312720"
  },
  {
    "text": "okay so i use the same ip this was this one was singapore the",
    "start": "2312720",
    "end": "2319520"
  },
  {
    "text": "other one is san francisco let's connect this one to singapore",
    "start": "2319520",
    "end": "2326320"
  },
  {
    "text": "actually then if i make a request from",
    "start": "2326320",
    "end": "2333680"
  },
  {
    "text": "singapore",
    "start": "2338839",
    "end": "2341839"
  },
  {
    "text": "that is the one that is going to handle so you can see that there's a label now sgp but if i send something from",
    "start": "2348240",
    "end": "2355400"
  },
  {
    "text": "[Music]",
    "start": "2355400",
    "end": "2358518"
  },
  {
    "text": "san francisco",
    "start": "2361440",
    "end": "2369280"
  },
  {
    "text": "sfo attendee that's from sfo ps4 sf",
    "start": "2369280",
    "end": "2379839"
  },
  {
    "text": "and but here's some so we're making requests to",
    "start": "2379839",
    "end": "2386079"
  },
  {
    "text": "sf but if it fails then or start receiving requests",
    "start": "2386079",
    "end": "2394480"
  },
  {
    "text": "from singapore so that's uh thanks to the q subscription and the routing and the",
    "start": "2394480",
    "end": "2401200"
  },
  {
    "text": "disaster recovery and features from the xv2 there was automatic failover from the",
    "start": "2402640",
    "end": "2407839"
  },
  {
    "text": "consumers transparently so yeah we basically another kubernetes",
    "start": "2407839",
    "end": "2413680"
  },
  {
    "text": "cluster is handling the request for us now",
    "start": "2413680",
    "end": "2418720"
  },
  {
    "text": "okay so let's uh make the credentials from sf attendee",
    "start": "2419119",
    "end": "2427280"
  },
  {
    "text": "save",
    "start": "2430000",
    "end": "2432319"
  },
  {
    "text": "threats",
    "start": "2436839",
    "end": "2439839"
  },
  {
    "text": "there's another one for",
    "start": "2442000",
    "end": "2445200"
  },
  {
    "text": "and",
    "start": "2450839",
    "end": "2453839"
  },
  {
    "text": "now let's make another request for",
    "start": "2464000",
    "end": "2468800"
  },
  {
    "text": "amsterdam let's start the chat",
    "start": "2478839",
    "end": "2483520"
  },
  {
    "text": "using so this one's going to connect to answer them",
    "start": "2484960",
    "end": "2495839"
  },
  {
    "text": "using the credentials from amsterdam i connected",
    "start": "2499280",
    "end": "2507520"
  },
  {
    "text": "and this other one is going to connect from ceph",
    "start": "2507520",
    "end": "2523839"
  },
  {
    "text": "so now you have a globally available uh chat uh server service",
    "start": "2534960",
    "end": "2541920"
  },
  {
    "text": "with unique identities it's secure you cannot read the messages from other attendees but they can still",
    "start": "2541920",
    "end": "2548400"
  },
  {
    "text": "communicate amongst them between them we cannot",
    "start": "2548400",
    "end": "2556800"
  },
  {
    "text": "take a look at some of the",
    "start": "2556800",
    "end": "2559760"
  },
  {
    "text": "you cannot even from the system account you cannot receive the messages and there's no user that has enough",
    "start": "2561920",
    "end": "2568720"
  },
  {
    "text": "permissions actually in this system to be able to read the dms from",
    "start": "2568720",
    "end": "2573839"
  },
  {
    "text": "from anyone there's no credentials that allow you for a load allow that allow",
    "start": "2573839",
    "end": "2580160"
  },
  {
    "text": "for that to happen and",
    "start": "2580160",
    "end": "2585760"
  },
  {
    "text": "so that's uh pretty much it for the tutorial um",
    "start": "2586400",
    "end": "2594240"
  },
  {
    "text": "separately we can uh cover how to enable all of this to use a tls and also uh",
    "start": "2594240",
    "end": "2601280"
  },
  {
    "text": "looking at how lyft node connections can actually make this gateway connections are",
    "start": "2601280",
    "end": "2606400"
  },
  {
    "text": "more straightforward to set up that could also be uh interesting but okay i'll connect",
    "start": "2606400",
    "end": "2613119"
  },
  {
    "text": "then at the for questions uh later okay so thank you",
    "start": "2613119",
    "end": "2623119"
  }
]