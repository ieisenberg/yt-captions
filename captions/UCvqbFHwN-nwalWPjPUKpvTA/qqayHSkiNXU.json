[
  {
    "text": "uh first off I'm Ben dronin I am a kubernetes platform engineer at Ford Motor Company I'm Angel dang I'm the",
    "start": "399",
    "end": "8320"
  },
  {
    "text": "principal product manager for open shift authentication and identity and uh we're",
    "start": "8320",
    "end": "13559"
  },
  {
    "text": "going to be talking about workload identity Federation and why you should stop using longlived credentials so by a",
    "start": "13559",
    "end": "20400"
  },
  {
    "text": "show of hands how many of you guys are using uh accessing Some Cloud resource from your kubernetes",
    "start": "20400",
    "end": "27000"
  },
  {
    "text": "cluster okay how many of you are using workload identity Federation to do that",
    "start": "27000",
    "end": "32279"
  },
  {
    "text": "okay so like a good number of you are already doing exactly what we're going to be talking about doing but wait how many of you are not doing that I mean",
    "start": "32279",
    "end": "37680"
  },
  {
    "text": "you're using service account Keys client client secret okay so there's a lot of you so that's perfect we're glad you're",
    "start": "37680",
    "end": "43399"
  },
  {
    "text": "here so for all those who raised their hands please stop doing that uh okay so",
    "start": "43399",
    "end": "51280"
  },
  {
    "text": "um workload identity is required to uniquely identify a workload uh so that",
    "start": "51280",
    "end": "57280"
  },
  {
    "text": "when it accesses the cluster and uh authenticates to other applications we",
    "start": "57280",
    "end": "62719"
  },
  {
    "text": "are able to monitor it and track it right so good news is that kubernetes",
    "start": "62719",
    "end": "68680"
  },
  {
    "text": "already comes with workload identity many of you raised your hands and uh",
    "start": "68680",
    "end": "73720"
  },
  {
    "text": "you're aware of service accounts most of you are aware of service service accounts here right so um service",
    "start": "73720",
    "end": "81759"
  },
  {
    "text": "accounts are treated just like any other user in kubernetes uh any other user or",
    "start": "81759",
    "end": "87200"
  },
  {
    "text": "group you can apply arback policies to to the the service accounts and uh you",
    "start": "87200",
    "end": "93159"
  },
  {
    "text": "can use them on the cluster for um uh communicating between services on the",
    "start": "93159",
    "end": "98640"
  },
  {
    "text": "cluster you can also use them uh for for any external applications that want to",
    "start": "98640",
    "end": "103920"
  },
  {
    "text": "run tasks and um automation on the cluster so thanks to the seot team for",
    "start": "103920",
    "end": "110000"
  },
  {
    "text": "thinking through workload identity um you know very early on when they build uh",
    "start": "110000",
    "end": "115960"
  },
  {
    "text": "kubernetes we are going to take a little bit of trip down memory l with how uh you know service accounts",
    "start": "115960",
    "end": "123119"
  },
  {
    "text": "were and what was the landscape like pre uh kubernetes 1121 that's a long time",
    "start": "123119",
    "end": "130160"
  },
  {
    "text": "back well actually not it's just three years back so um let's look at how it",
    "start": "130160",
    "end": "136120"
  },
  {
    "text": "was I have to use the clicker yeah so this was the landscape just you",
    "start": "136120",
    "end": "143360"
  },
  {
    "text": "know some 3 years back so you had uh service account tokens many of them had",
    "start": "143360",
    "end": "149160"
  },
  {
    "text": "tokens that uh didn't expire and they were Long Live tokens you could use that to communicate",
    "start": "149160",
    "end": "155400"
  },
  {
    "text": "between Services uh you could use that as I mentioned to run from external",
    "start": "155400",
    "end": "160760"
  },
  {
    "text": "applications to run automated tasks on the cluster like creating an application",
    "start": "160760",
    "end": "166239"
  },
  {
    "text": "running updating an application Etc um and then uh for services that wanted to",
    "start": "166239",
    "end": "173879"
  },
  {
    "text": "talk to external entities well you couldn't use service account tokens because service account tokens were",
    "start": "173879",
    "end": "180400"
  },
  {
    "text": "specific to the cluster um there was no Federation available between uh the",
    "start": "180400",
    "end": "186720"
  },
  {
    "text": "service account issuer and uh any other identity provider outside so really you",
    "start": "186720",
    "end": "192000"
  },
  {
    "text": "could use them only on the cluster or to run services on the cluster what did uh typically folks do if they wanted to use",
    "start": "192000",
    "end": "200040"
  },
  {
    "text": "uh or communicate with external applications long lived API tokens long",
    "start": "200040",
    "end": "206799"
  },
  {
    "text": "lived certificates mtls is not the answer for everything so um uh yeah I",
    "start": "206799",
    "end": "214000"
  },
  {
    "text": "see a lot of laughs there so um we all agree Long Live tokens can",
    "start": "214000",
    "end": "220519"
  },
  {
    "text": "create problems right what are some of the problems uh your credential can be stolen they are prone to exfiltration",
    "start": "220519",
    "end": "227680"
  },
  {
    "text": "attacks um you don't know how many times the bad actor has used your token how many times the badged actor has shared",
    "start": "227680",
    "end": "235040"
  },
  {
    "text": "the token so really uh you know you cannot control the blast radius and",
    "start": "235040",
    "end": "240439"
  },
  {
    "text": "these are extremely prone to attacks um some statistics that I want to highlight",
    "start": "240439",
    "end": "246879"
  },
  {
    "text": "in a um re recent Cloud security Alliance report in 2024 it was reported",
    "start": "246879",
    "end": "253000"
  },
  {
    "text": "that 80% of the organizations using Cloud reported a security incident at",
    "start": "253000",
    "end": "260280"
  },
  {
    "text": "least one at least one security incident and that's a huge number right so one of",
    "start": "260280",
    "end": "267280"
  },
  {
    "text": "the factors the second most uh important factor in this was identity and access",
    "start": "267280",
    "end": "273919"
  },
  {
    "text": "management any guesses which was the most important factor that caused the",
    "start": "273919",
    "end": "279440"
  },
  {
    "text": "breaches and security issues uh",
    "start": "279440",
    "end": "287400"
  },
  {
    "text": "misconfigurations human errors so automation is the answer so definitely",
    "start": "287400",
    "end": "293199"
  },
  {
    "text": "automate and make sure that your identity and access management is set up",
    "start": "293199",
    "end": "298320"
  },
  {
    "text": "correctly passwords is part of that yeah so as you can see uh long lived uh",
    "start": "298320",
    "end": "305840"
  },
  {
    "text": "token usage is definitely a big no no luckily uh you know our Upstream folks",
    "start": "305840",
    "end": "311639"
  },
  {
    "text": "have been working hard since kubernetes 120 and the landscape has changed quite",
    "start": "311639",
    "end": "316840"
  },
  {
    "text": "a bit so this is how it looks like now um I'm mostly going to focus on the",
    "start": "316840",
    "end": "324240"
  },
  {
    "text": "right side but let me give you a quick brief on the left side as well so uh for",
    "start": "324240",
    "end": "330240"
  },
  {
    "text": "external applications that want to um you know communicate with services on the cluster you can use bound service",
    "start": "330240",
    "end": "337400"
  },
  {
    "text": "account tokens now these are time bound they are audience bound um if you use",
    "start": "337400",
    "end": "342479"
  },
  {
    "text": "projected service account tokens then they are autor rotated by the cuet so this is the right approach if you want",
    "start": "342479",
    "end": "348800"
  },
  {
    "text": "to use for communication on the cluster or while you're running applications that want to you know run uh tasks on",
    "start": "348800",
    "end": "356880"
  },
  {
    "text": "the cluster uh external applications uh the one other thing you could do is",
    "start": "356880",
    "end": "362479"
  },
  {
    "text": "also use uh uh oidc um access and run",
    "start": "362479",
    "end": "368160"
  },
  {
    "text": "client credential workflows uh from external IDP there's a lot of good work that has been done in kubernetes lately",
    "start": "368160",
    "end": "375000"
  },
  {
    "text": "with structured o and integration of oidc so um you could use client",
    "start": "375000",
    "end": "380120"
  },
  {
    "text": "credential for talking to services on the cluster as well but let's focus on",
    "start": "380120",
    "end": "385479"
  },
  {
    "text": "the right side here um and workload identity Federation so uh big Kudos uh",
    "start": "385479",
    "end": "392440"
  },
  {
    "text": "to the team that uh really understood that shortlived credentials is the right approach and um they made it possible to",
    "start": "392440",
    "end": "401800"
  },
  {
    "text": "Federate with external identity providers using um service account",
    "start": "401800",
    "end": "407759"
  },
  {
    "text": "issuer oidc Discovery support so now you have a well-known endpoint from where",
    "start": "407759",
    "end": "413880"
  },
  {
    "text": "you can get the issuer information so you can get the issuer you can get uh",
    "start": "413880",
    "end": "420039"
  },
  {
    "text": "the public key uh that have signed the tokens and then you can create a federation relationship on your external",
    "start": "420039",
    "end": "427639"
  },
  {
    "text": "IDP so when your application on the cluster is trying to access an",
    "start": "427639",
    "end": "433759"
  },
  {
    "text": "application outside the cluster that um using your service account tokens what uh what will happen is it",
    "start": "433759",
    "end": "441800"
  },
  {
    "text": "will be redirected to the IDP the IDP will go and validate the token it already has that trust relationship and",
    "start": "441800",
    "end": "449039"
  },
  {
    "text": "once it validates the token it will provide an access token that uh the application can use to talk to the",
    "start": "449039",
    "end": "455440"
  },
  {
    "text": "external application this is the right approach so all of you who raised your hands this",
    "start": "455440",
    "end": "462720"
  },
  {
    "text": "is for you uh so this is great in theory but",
    "start": "462720",
    "end": "468159"
  },
  {
    "text": "let's look at how it looks in practice how it looks like in a production environment at scale and for that I'll",
    "start": "468159",
    "end": "475479"
  },
  {
    "text": "hand it over to Ben awesome so let's see here all right so first a",
    "start": "475479",
    "end": "483120"
  },
  {
    "text": "legal disclaimer uh got to do this sorry I don't speak on behalf of Ford if I say",
    "start": "483120",
    "end": "488560"
  },
  {
    "text": "we I'm not speaking as Ford I'm speaking as myself and my immediate team that deals with this stuff all the time and",
    "start": "488560",
    "end": "493960"
  },
  {
    "text": "Ford Motor Company and myself are not endorsing any project product or service that I mentioned in this presentation cool so uh Ford's Cloud Journey has been",
    "start": "493960",
    "end": "502280"
  },
  {
    "text": "ramped up dramatically in the past four years um we've been in the cloud space for some time now adoption started in",
    "start": "502280",
    "end": "507599"
  },
  {
    "text": "2016 with Cloud Foundry and then we quickly also started using kubernetes in 2017 um over the past four years uh it's",
    "start": "507599",
    "end": "516039"
  },
  {
    "text": "Cloud first mindset has been pushed super super heavily um we want people to be using the cloud to deploy their",
    "start": "516039",
    "end": "523599"
  },
  {
    "text": "applications whatever it may be something to support the business external facing stuff that kind of thing",
    "start": "523599",
    "end": "529519"
  },
  {
    "text": "um so prior to this push for adop cloud adoption um we",
    "start": "529519",
    "end": "536480"
  },
  {
    "text": "were using Ford was using uh Long Live credentials with long expiry times um",
    "start": "536480",
    "end": "542640"
  },
  {
    "text": "and this was not ideal it was pretty painful uh for one outages if you're",
    "start": "542640",
    "end": "548760"
  },
  {
    "text": "using these long lived credentials and they have a you know they do have eventually have an expiry time A lot of",
    "start": "548760",
    "end": "555200"
  },
  {
    "text": "times it's around a year or so um when that year comes around and someone forgets to renew it that's a problem",
    "start": "555200",
    "end": "562079"
  },
  {
    "text": "especially if like someone left the company and they were getting a bunch of emails that credential is about to",
    "start": "562079",
    "end": "567600"
  },
  {
    "text": "expire service gets interrupted the business isn't happy that's not fun um the other thing is uh credential",
    "start": "567600",
    "end": "573760"
  },
  {
    "text": "mismanagement people would leave Secrets stored on their local machines in emails push it to get that's not fun um no one",
    "start": "573760",
    "end": "581760"
  },
  {
    "text": "likes that everyone everyone disliked that so uh another thing toil no one",
    "start": "581760",
    "end": "587040"
  },
  {
    "text": "likes doing it no one likes rotating Secrets it's just kind of a painful process and obviously all the security",
    "start": "587040",
    "end": "594560"
  },
  {
    "text": "um disadvantages that Anie was talking about so um when the company began to",
    "start": "594560",
    "end": "599760"
  },
  {
    "text": "push for a cloud first mind set it became obvious that this was not going to be a sustainable pattern at scale um",
    "start": "599760",
    "end": "606320"
  },
  {
    "text": "so like for ex just to put it in perspective there's 7,000 name spaces just in our tekon clusters alone that",
    "start": "606320",
    "end": "613040"
  },
  {
    "text": "are only doing cicd workloads all the time and you can imagine that every single one of these would need some",
    "start": "613040",
    "end": "618519"
  },
  {
    "text": "credential to talk to Cloud providers to do whatever it is that your cicd system",
    "start": "618519",
    "end": "623680"
  },
  {
    "text": "needs to do and this doesn't include any name spaces that are running like actual applications it's just for cicd at Ford",
    "start": "623680",
    "end": "630519"
  },
  {
    "text": "so like this is a crazy amount of name spaces every single one would need credentials it would not have scaled",
    "start": "630519",
    "end": "636079"
  },
  {
    "text": "well so um it was decided that when this push was being made that long live",
    "start": "636079",
    "end": "641360"
  },
  {
    "text": "credentials for accessing Cloud resources were going to be the exception and not the norm so as such uh Ford",
    "start": "641360",
    "end": "647720"
  },
  {
    "text": "adopted this this uh strategy here use workload identity wherever possible whether running in kubernetes or not so",
    "start": "647720",
    "end": "654440"
  },
  {
    "text": "other platforms can also do workload identity it's not unique to kubernetes but obviously where C we're talking",
    "start": "654440",
    "end": "659760"
  },
  {
    "text": "about kubernetes we do workload identity with kubernetes so we can sum it up with this little flowchart here if if you",
    "start": "659760",
    "end": "666560"
  },
  {
    "text": "need to authenticate to the cloud use workload identity if you don't you well don't need to talk about it if it didn't",
    "start": "666560",
    "end": "673120"
  },
  {
    "text": "work when you tried it why did it not work if Ford wrote it fix it so you can use workload identity and then use",
    "start": "673120",
    "end": "679480"
  },
  {
    "text": "workload identity if Ford didn't write it talk to the vendor who did write it and if it doesn't support workload",
    "start": "679480",
    "end": "684639"
  },
  {
    "text": "identity you have to you put in an engineering request or feature request and you have to obtain an exception so",
    "start": "684639",
    "end": "691040"
  },
  {
    "text": "that you can use Long Live credentials within our Cloud environments um but obviously the preference is ask the",
    "start": "691040",
    "end": "698040"
  },
  {
    "text": "vendor to support workload identity and then you'll be good to go so uh whoops",
    "start": "698040",
    "end": "703279"
  },
  {
    "text": "that was not great there we go so this is just an example once again not endorsing any of these things this is",
    "start": "703279",
    "end": "709279"
  },
  {
    "text": "just an example of what we use in kind of our sphere of influence within Ford",
    "start": "709279",
    "end": "714519"
  },
  {
    "text": "um and the biggest one being like many other companies when you talk about workload identity is ICD um we do use",
    "start": "714519",
    "end": "720680"
  },
  {
    "text": "tecton and primarily terraform the the uh non vsl one um but uh we use those",
    "start": "720680",
    "end": "727720"
  },
  {
    "text": "for most of our Cloud provisioning as well as all those other projects that you see there every single one of these",
    "start": "727720",
    "end": "732760"
  },
  {
    "text": "is using workload identity to talk to our various Cloud providers and we don't use Long Live credentials to do any of",
    "start": "732760",
    "end": "738600"
  },
  {
    "text": "this stuff um so it works really really great if you use a lot of the cncf ecosystem a lot of it already has",
    "start": "738600",
    "end": "744199"
  },
  {
    "text": "workload identity support built in um so that's super awesome so for example Ford has an internal uh Ford Cloud portal",
    "start": "744199",
    "end": "751000"
  },
  {
    "text": "based on Backstage to get application teams bootstrapped with Cloud resources it comes with a techon namespace that",
    "start": "751000",
    "end": "756199"
  },
  {
    "text": "techon namespace comes with work Cloud identity preconfigured developers are ready to go to provision resources into",
    "start": "756199",
    "end": "762079"
  },
  {
    "text": "the cloud using our infrastructure as code tool of choice at the moment um",
    "start": "762079",
    "end": "767880"
  },
  {
    "text": "just to get them bootstrapped and they can do all this stuff without needing to ever configure Long Live credentials so that's super cool um there's a bunch",
    "start": "767880",
    "end": "774880"
  },
  {
    "text": "more we can talk about here but in the interest of time we'll move on so uh what do you need to do it so the first",
    "start": "774880",
    "end": "781000"
  },
  {
    "text": "thing you're going to need is a public oidc service count issuer endpoint um that is the yellow field there um if you",
    "start": "781000",
    "end": "788120"
  },
  {
    "text": "want to look at how this works you can generate a jot token from Cube CTL and",
    "start": "788120",
    "end": "793600"
  },
  {
    "text": "you can use that little JC uh CLI to parse it out into a nice Json structure here for you um so that's what that",
    "start": "793600",
    "end": "799720"
  },
  {
    "text": "issuer endpoint looks like um I'm it it can be whatever you want you can use",
    "start": "799720",
    "end": "805160"
  },
  {
    "text": "Ingress to expose it you can use uh S3 bucket it just has to be publicly available um the second thing is you",
    "start": "805160",
    "end": "811279"
  },
  {
    "text": "need a kubernetes service account and you have to know the subject claim of that service account so for kubernetes uh all of them take the format system",
    "start": "811279",
    "end": "817800"
  },
  {
    "text": "colon service account colon names space colon service account name so this is namespace scoped um when you do workl",
    "start": "817800",
    "end": "824360"
  },
  {
    "text": "identity it's always from the namespace um so it works great with multi- tendency and then you define the allowed",
    "start": "824360",
    "end": "831279"
  },
  {
    "text": "audience for the token exchange um what this looks like uh can depend on the",
    "start": "831279",
    "end": "837000"
  },
  {
    "text": "cloud provider you're trying to use and what you're trying to do workload identity with um some projects require",
    "start": "837000",
    "end": "843440"
  },
  {
    "text": "you to use a particular audience because it's hardcoded in their um code to use a particular audience so that's good to",
    "start": "843440",
    "end": "849800"
  },
  {
    "text": "know and then the expiry obviously the cloud provider will check to see if the token is expired or not so that's that's",
    "start": "849800",
    "end": "855079"
  },
  {
    "text": "super important um and it will also usually be required to be like time down to like an hour it kind of depends on",
    "start": "855079",
    "end": "861040"
  },
  {
    "text": "cloud provider but that's kind of the norm so let's uh let's do a demo let's see what it actually looks like to use",
    "start": "861040",
    "end": "867120"
  },
  {
    "text": "workload identity all",
    "start": "867120",
    "end": "872199"
  },
  {
    "text": "righty I cannot",
    "start": "873240",
    "end": "876759"
  },
  {
    "text": "see one there we go cool",
    "start": "882880",
    "end": "888440"
  },
  {
    "text": "so sweet so to start with like we said we need a publicly available oidc endpoint",
    "start": "888440",
    "end": "895160"
  },
  {
    "text": "um so I'm going to spin up a mini Cube cluster and we're going to enable workload identity on that mini Cube cluster cluster and then we're going to actually use workload ID entity with an",
    "start": "895160",
    "end": "901519"
  },
  {
    "text": "open source uh cncf project or C C project or whatever it is so um I'm I'm",
    "start": "901519",
    "end": "907160"
  },
  {
    "text": "using open tofu to spin up a Google storage bucket I'm making that storage bucket public so that I can satisfy the",
    "start": "907160",
    "end": "913920"
  },
  {
    "text": "requirement of having a public oidc issuer and I pre-created this ahead of time so we don't have to watch a plan",
    "start": "913920",
    "end": "920800"
  },
  {
    "text": "and apply and stuff like that so uh we're going to start our mini Cube cluster we're going to specify these two",
    "start": "920800",
    "end": "927480"
  },
  {
    "text": "API server args um one for specifying the oidc well-known endpoints um the",
    "start": "927480",
    "end": "933680"
  },
  {
    "text": "issuer which is the issuer um service account issuer and then one is the public key endpoint um we're going to",
    "start": "933680",
    "end": "940279"
  },
  {
    "text": "upload both of those things to the bucket after the cluster starts up",
    "start": "940279",
    "end": "945880"
  },
  {
    "text": "so this might take a minute I actually did already start this ahead of time um so it's just kind of making sure the",
    "start": "945880",
    "end": "951880"
  },
  {
    "text": "configuration matches just so that all the images that we're going to use were pre-cached and we have to wait for pods",
    "start": "951880",
    "end": "956920"
  },
  {
    "text": "to spin up and stuff like that",
    "start": "956920",
    "end": "960920"
  },
  {
    "text": "okay awesome so we're going to first look at",
    "start": "966880",
    "end": "972079"
  },
  {
    "text": "a service account token um you can see the issuer up there um is our bucket",
    "start": "972079",
    "end": "977440"
  },
  {
    "text": "that we created using open tofu um that is number one field that we said we need",
    "start": "977440",
    "end": "983240"
  },
  {
    "text": "the the issuer to be something that we know and is publicly available so that our Cloud providers can validate our",
    "start": "983240",
    "end": "989079"
  },
  {
    "text": "tokens that we're about to send up uh the subject information is right there on kind of down here I a laser pointer",
    "start": "989079",
    "end": "997639"
  },
  {
    "text": "yeah so that's going to be super important when we configure our IM policies and our Cloud providers and",
    "start": "997639",
    "end": "1003639"
  },
  {
    "text": "then the expiry it's probably something that you need to decode and we're not going to worry about okay",
    "start": "1003639",
    "end": "1010600"
  },
  {
    "text": "so did I mess this up",
    "start": "1010600",
    "end": "1015399"
  },
  {
    "text": "Okay cool so the next thing we're going to do is we're going to upload our uh open ID uh configuration endpoint to our",
    "start": "1019959",
    "end": "1026400"
  },
  {
    "text": "Google storage bucket awesome then we're going to",
    "start": "1026400",
    "end": "1032520"
  },
  {
    "text": "upload the",
    "start": "1032520",
    "end": "1034919"
  },
  {
    "text": "keys awesome now we're ready to use workload identity in any cloud provider that we want to use so to show you what",
    "start": "1038120",
    "end": "1044760"
  },
  {
    "text": "that looks like I've got a bunch of open n Fu code",
    "start": "1044760",
    "end": "1050280"
  },
  {
    "text": "of just to provide an example of what it actually looks like to do in to use workload identity in these Cloud providers so starting off with AWS um",
    "start": "1050280",
    "end": "1057400"
  },
  {
    "text": "you have to configure one of these uh open ID connect provider resources um you have to provide it the issuer URL",
    "start": "1057400",
    "end": "1063559"
  },
  {
    "text": "the uh client ID list which is actually the audiences that you want to use um and then the thumb print list which is",
    "start": "1063559",
    "end": "1069679"
  },
  {
    "text": "based off the htps certificate that you're serving your oidc mpoint from um I have some commands that you can all",
    "start": "1069679",
    "end": "1075520"
  },
  {
    "text": "the stuff is going to be available on my GitHub but I have some commands of how you can get that thum",
    "start": "1075520",
    "end": "1080840"
  },
  {
    "text": "print then if we're talking about Azure um you're going to need to spin up an Azure ad application um it's a little",
    "start": "1081720",
    "end": "1087440"
  },
  {
    "text": "bit different if you're using like AKs and managed identities not going to get into that but this this this will work",
    "start": "1087440",
    "end": "1093240"
  },
  {
    "text": "in any cluster so um you spin up your azid application you spin up a surface",
    "start": "1093240",
    "end": "1098320"
  },
  {
    "text": "principle associated with that application and then the magic is this part right here where you",
    "start": "1098320",
    "end": "1105200"
  },
  {
    "text": "configure the Federated identity credential um is a little bit different from the other two major Cloud providers",
    "start": "1105200",
    "end": "1110360"
  },
  {
    "text": "and that you have to Define this at per uh application not like in a generic",
    "start": "1110360",
    "end": "1116640"
  },
  {
    "text": "like pool or um open ID provider um",
    "start": "1116640",
    "end": "1121799"
  },
  {
    "text": "resource and then in Google Cloud uh you you spin up a workload identity pool and",
    "start": "1121799",
    "end": "1128240"
  },
  {
    "text": "a provider and then you provide that same kind of information um you provide the scroll down a little bit you can",
    "start": "1128240",
    "end": "1135120"
  },
  {
    "text": "provide the issuer information the allow the allowed audiences issuer information and then you can figure the I am",
    "start": "1135120",
    "end": "1141360"
  },
  {
    "text": "policies for each one of these things as you would with a regular like service count in these Cloud providers and I'll show you how to do that as well so let's",
    "start": "1141360",
    "end": "1148200"
  },
  {
    "text": "actually use this for something that's what we want so we're going to try out Secret store CSI driver",
    "start": "1148200",
    "end": "1154960"
  },
  {
    "text": "I know we're talking about not using long lift credentials but Secret store CSI driver is super cool because it lets you use workload identity to grab",
    "start": "1154960",
    "end": "1160960"
  },
  {
    "text": "credentials so if you need them it's kind of a good way to do it so we'll go ahead and give it a shot so",
    "start": "1160960",
    "end": "1169240"
  },
  {
    "text": "just to show you what we're actually working with here I've gone ahead and provisioned secrets in each one of these",
    "start": "1169799",
    "end": "1177080"
  },
  {
    "text": "Cloud providers uh obviously don't do this this way",
    "start": "1177080",
    "end": "1182520"
  },
  {
    "text": "uh it's it's for a demo it's fine don't do it this way um so I've I've gone",
    "start": "1182520",
    "end": "1189360"
  },
  {
    "text": "ahead and spit up spun up an uh ads secret manager secret I'm adding",
    "start": "1189360",
    "end": "1194440"
  },
  {
    "text": "information into that secret secret from AWS doing the same thing for the other two and then I'm defining the actual IM",
    "start": "1194440",
    "end": "1200720"
  },
  {
    "text": "role and policy um so that our workload identity um so that our service account",
    "start": "1200720",
    "end": "1206240"
  },
  {
    "text": "in kubernetes can use workload identity to authenticate and grab this secret um I'm not going to spend too much time if",
    "start": "1206240",
    "end": "1211679"
  },
  {
    "text": "you use these Cloud providers you should already know how to do this because you're doing it for other things that are not using workload identities so it",
    "start": "1211679",
    "end": "1217240"
  },
  {
    "text": "should be relatively straightforward same thing for Azure we have a secret secret from Azure it's going to be put",
    "start": "1217240",
    "end": "1223559"
  },
  {
    "text": "in an Azure key Vault and then in gcp",
    "start": "1223559",
    "end": "1229520"
  },
  {
    "text": "I mean gcp we have secret from gcp all these things are already provisioned because it takes a little bit of time to",
    "start": "1229520",
    "end": "1235640"
  },
  {
    "text": "provision them so I've gone ahead and done that ahead of time and we're going to install the",
    "start": "1235640",
    "end": "1242080"
  },
  {
    "text": "operator uh I've already kind of done this so it's already there",
    "start": "1242080",
    "end": "1247640"
  },
  {
    "text": "um secret St CSI driver provides a secret provider class this is how you tell uh The Secret store CSI driver how",
    "start": "1247640",
    "end": "1255600"
  },
  {
    "text": "to actually go and look for those secrets you tell it you know what uh client ID are you going to use what",
    "start": "1255600",
    "end": "1260919"
  },
  {
    "text": "tenant ID in Azure in AWS you define the Arn of the secret and then in",
    "start": "1260919",
    "end": "1267120"
  },
  {
    "text": "gcp if I can scroll here in gcp you tell it like the the uh uh project name and",
    "start": "1267120",
    "end": "1274679"
  },
  {
    "text": "stuff like that so this is all I've configured I haven't there's no secrets hidden anywhere all the stuff is on my",
    "start": "1274679",
    "end": "1280600"
  },
  {
    "text": "GitHub you can look at it um and then we're going to create a pod um we're",
    "start": "1280600",
    "end": "1286159"
  },
  {
    "text": "going to use the Secret store CSI driver to create these volum that will project these secrets into the file",
    "start": "1286159",
    "end": "1291840"
  },
  {
    "text": "system and into these places it's going to mount them the secrets going to be there it's going to be great it's going",
    "start": "1291840",
    "end": "1298240"
  },
  {
    "text": "to work we hope okay so that's all ready to go",
    "start": "1298240",
    "end": "1303919"
  },
  {
    "text": "we'll apply the Pod make sure the Pod is ready yep all right so uh we're going to",
    "start": "1303919",
    "end": "1311440"
  },
  {
    "text": "do an LS in those directories where we mounted those secrets in and we can see all three of them are there so let's go",
    "start": "1311440",
    "end": "1317559"
  },
  {
    "text": "ahead and Cat them out see if they're actually have the values that we claim that they do and they do so secret from",
    "start": "1317559",
    "end": "1324240"
  },
  {
    "text": "OS secret from Azure secret from gcp there's no credentials it was just me uploading those two things into that",
    "start": "1324240",
    "end": "1330480"
  },
  {
    "text": "public GCS storage bucket um and then pointing the cloud providers at that storage bucket so all that was happening",
    "start": "1330480",
    "end": "1335760"
  },
  {
    "text": "is the Secret store CSI driver is just taking the kubernetes service account token associated with this pod",
    "start": "1335760",
    "end": "1341080"
  },
  {
    "text": "exchanging it for the access token for that particular cloud provider and then using that to access the secret resource",
    "start": "1341080",
    "end": "1346919"
  },
  {
    "text": "and project it into the pod so this is awesome we didn't need to use any secrets but we can still use it to do",
    "start": "1346919",
    "end": "1352960"
  },
  {
    "text": "things and you canuse use this in for the most part in within any",
    "start": "1352960",
    "end": "1359080"
  },
  {
    "text": "application so",
    "start": "1359080",
    "end": "1364720"
  },
  {
    "text": "[Music] um awesome all right so this works great",
    "start": "1365140",
    "end": "1370360"
  },
  {
    "text": "for a single cluster if you're if you don't run at like a ton super large scale you should use this but what about",
    "start": "1370360",
    "end": "1376240"
  },
  {
    "text": "if you're using a ton of you have a ton of clusters that you're managing hundreds maybe thousands um it's kind of",
    "start": "1376240",
    "end": "1382000"
  },
  {
    "text": "tedious to be able have to do this every time uh trying to get use trying to get developers to use workload identity for",
    "start": "1382000",
    "end": "1387720"
  },
  {
    "text": "their stuff is hard enough uh try trying to get them to each configure their own oidc issuers for every cluster trying to",
    "start": "1387720",
    "end": "1394080"
  },
  {
    "text": "get them communicate that to them uh it's kind of a pain in the rear it's not",
    "start": "1394080",
    "end": "1399240"
  },
  {
    "text": "fun uh moving workloads between clusters requires them to reconfigure all their",
    "start": "1399240",
    "end": "1404320"
  },
  {
    "text": "IM they a lot of times don't know how to do that uh and wouldn't it be nice if it was possible to Federate with a single",
    "start": "1404320",
    "end": "1410720"
  },
  {
    "text": "issuer so I'm going to pass it back to angelene she's going to talk about something that might be helpful in this",
    "start": "1410720",
    "end": "1416760"
  },
  {
    "text": "situation awesome all right so Ben that was a",
    "start": "1416760",
    "end": "1424279"
  },
  {
    "text": "great demo by the way um so I want to pick on what Ben mentioned um have a",
    "start": "1424279",
    "end": "1430919"
  },
  {
    "text": "single schema it's very important to have a single schema not just for ease of use but also for making making sure",
    "start": "1430919",
    "end": "1438960"
  },
  {
    "text": "that you are providing the right set of policies across uh you know your clusters you're making sure that uh you",
    "start": "1438960",
    "end": "1447240"
  },
  {
    "text": "know you're uh using your resources in the right way so if you do automation",
    "start": "1447240",
    "end": "1453159"
  },
  {
    "text": "then the cost of automation is also lower um and um you know the cost of",
    "start": "1453159",
    "end": "1458200"
  },
  {
    "text": "maintenance is also lower if you have a single schema that uh can address your",
    "start": "1458200",
    "end": "1463440"
  },
  {
    "text": "Federation requirements across the various uh Cloud um you know whether you",
    "start": "1463440",
    "end": "1469039"
  },
  {
    "text": "have it on Prem or in a cloud provider or on the edge or very far Edge as well",
    "start": "1469039",
    "end": "1476480"
  },
  {
    "text": "so so that's the requirement we want a solution that can Federate across all these different uh uh Cloud platforms",
    "start": "1476480",
    "end": "1484760"
  },
  {
    "text": "and uh we want it to be open source so luckily we have spiffy and Spire which",
    "start": "1484760",
    "end": "1491760"
  },
  {
    "text": "works with kubernetes as well spiffy Inspire uh are graduated cncf projects",
    "start": "1491760",
    "end": "1498399"
  },
  {
    "text": "they have been used in production by many organizations we have some really awesome developers here who work very",
    "start": "1498399",
    "end": "1505840"
  },
  {
    "text": "hard to uh you know make spfy Inspire uh available to all of uh you know to all",
    "start": "1505840",
    "end": "1511159"
  },
  {
    "text": "the users um so spfy Inspire can really Federate and provide shortlived",
    "start": "1511159",
    "end": "1518440"
  },
  {
    "text": "verifiable identities that's the spiffy the standard for providing this uh um",
    "start": "1518440",
    "end": "1524880"
  },
  {
    "text": "identity framework and uh these uh spiffy IDs um consist of a trust domain",
    "start": "1524880",
    "end": "1531559"
  },
  {
    "text": "as well as a workload that's the spiffy ID it's included in a swid which is U uh",
    "start": "1531559",
    "end": "1539159"
  },
  {
    "text": "spiffy verifiable document and um it can be in the form of x59 or",
    "start": "1539159",
    "end": "1545880"
  },
  {
    "text": "jot and uh these are shortlived they uh they are rotated um the rotation and the",
    "start": "1545880",
    "end": "1553559"
  },
  {
    "text": "uh issuance everything is handled by Spire which is the implementation of",
    "start": "1553559",
    "end": "1558760"
  },
  {
    "text": "spiffy so uh as as you can see from this diagram it can Federate across all of",
    "start": "1558760",
    "end": "1565200"
  },
  {
    "text": "these different platforms and if you were part of the workload identity date",
    "start": "1565200",
    "end": "1570799"
  },
  {
    "text": "yesterday there was one very cool presentation where uh they talked about using Spire at the far Edge they",
    "start": "1570799",
    "end": "1578559"
  },
  {
    "text": "actually had spire deployments on a vessel in the middle of an ocean with very limited starlink connectivity so",
    "start": "1578559",
    "end": "1585960"
  },
  {
    "text": "really it scales and fed creates across all of these different platforms um the",
    "start": "1585960",
    "end": "1592720"
  },
  {
    "text": "Spire architecture itself consists of a Spire server that's the brains of spire",
    "start": "1592720",
    "end": "1598120"
  },
  {
    "text": "and uh Spire agent uh which is deployed on uh which is deployed on the Node so",
    "start": "1598120",
    "end": "1604640"
  },
  {
    "text": "the Spire server is the one that issues uh the swis it is the one that uh uh",
    "start": "1604640",
    "end": "1612360"
  },
  {
    "text": "provides the workload registrations it is also uh doing node and workload",
    "start": "1612360",
    "end": "1617880"
  },
  {
    "text": "levels so node level attestation so every time an agent is deployed on a",
    "start": "1617880",
    "end": "1622919"
  },
  {
    "text": "node the agent has to be attested and the node has to be verified by spire and",
    "start": "1622919",
    "end": "1628919"
  },
  {
    "text": "Spire does uh the verification of the attestation out of pound so in case of",
    "start": "1628919",
    "end": "1634679"
  },
  {
    "text": "kubernetes um it uses service accounts uh and it does the outof bound uh",
    "start": "1634679",
    "end": "1640880"
  },
  {
    "text": "validation using the token review API now uh Spire uh server is very EXT",
    "start": "1640880",
    "end": "1648200"
  },
  {
    "text": "sensible it integrates with a lot of plugins oidc is one of them so it",
    "start": "1648200",
    "end": "1653760"
  },
  {
    "text": "provides oidc Discovery and can Federate with an external uh IDP IDC IDP as",
    "start": "1653760",
    "end": "1660120"
  },
  {
    "text": "well it also provides uh the Spire controller manager which is uh you know",
    "start": "1660120",
    "end": "1666679"
  },
  {
    "text": "which is what is used for kubernetes uh registration so if you have workloads they'll automatically get registered",
    "start": "1666679",
    "end": "1674039"
  },
  {
    "text": "with the Spire server because it deploys each of the Spire agent as a demon set",
    "start": "1674039",
    "end": "1679559"
  },
  {
    "text": "on the cluster so it really has a very extensible um plug-in architecture one",
    "start": "1679559",
    "end": "1685480"
  },
  {
    "text": "of the cool plugins that it comes with is tonac which is a user management um",
    "start": "1685480",
    "end": "1691200"
  },
  {
    "text": "plug-in and it helps with Federation e of federation Dynamic Federation um and",
    "start": "1691200",
    "end": "1698200"
  },
  {
    "text": "it uh also helps with management of spiffy IDs we have uh the maintainers of",
    "start": "1698200",
    "end": "1704360"
  },
  {
    "text": "that project here May and Maria shout out to you guys so so uh great work that",
    "start": "1704360",
    "end": "1710519"
  },
  {
    "text": "they are doing Upstream on this and uh so SP that's the Spire",
    "start": "1710519",
    "end": "1716200"
  },
  {
    "text": "server the Spire agent itself uh like I said uh is per node and it will uh",
    "start": "1716200",
    "end": "1723320"
  },
  {
    "text": "provide a workload API that uh the applications can access to get spiffy",
    "start": "1723320",
    "end": "1728480"
  },
  {
    "text": "IDs and uh it does workload level attestation in case of kubernetes it",
    "start": "1728480",
    "end": "1734120"
  },
  {
    "text": "will the the workload add plugins will get the qu ID from your cgroup",
    "start": "1734120",
    "end": "1739600"
  },
  {
    "text": "membership and then um uh contact the cuet and get uh information about the",
    "start": "1739600",
    "end": "1745519"
  },
  {
    "text": "application and it matches that information with the registration entry and provides you with a spiffy ID so",
    "start": "1745519",
    "end": "1752840"
  },
  {
    "text": "that's in a nutshell how Spire Works um Spire federates between Spire servers so",
    "start": "1752840",
    "end": "1759640"
  },
  {
    "text": "you can set up the Federation relationship and uh when you want workload say from cluster a to talk to",
    "start": "1759640",
    "end": "1766360"
  },
  {
    "text": "Cluster B then you Federate across these two servers and you also tell the",
    "start": "1766360",
    "end": "1772600"
  },
  {
    "text": "workload uh that it needs to use the Spire server B by using federates with",
    "start": "1772600",
    "end": "1779519"
  },
  {
    "text": "uh as the uh configuration so that Spire in a nutshell um you know there have been",
    "start": "1779519",
    "end": "1787159"
  },
  {
    "text": "lots of talks on spifi and Spire this is the right way to go in terms of uh using",
    "start": "1787159",
    "end": "1792480"
  },
  {
    "text": "shortl tokens uh using Federation and uh you know uh",
    "start": "1792480",
    "end": "1798880"
  },
  {
    "text": "all of your multicloud needs can be um addressed so uh that's you know that's",
    "start": "1798880",
    "end": "1806600"
  },
  {
    "text": "the recommendation that we had and uh that's the future direction that we encourage everyone to try out um and I",
    "start": "1806600",
    "end": "1815720"
  },
  {
    "text": "think uh we want to wrap up here and take some questions from you",
    "start": "1815720",
    "end": "1821200"
  },
  {
    "text": "[Applause] guys yes there's a mic up here if you",
    "start": "1821980",
    "end": "1829320"
  },
  {
    "text": "guys want to if there's any questions for us I just want to say like this is just",
    "start": "1829320",
    "end": "1835480"
  },
  {
    "text": "as easy as using client client Secret Service account Keys simply because you only have to configure it once and you",
    "start": "1835480",
    "end": "1841679"
  },
  {
    "text": "never have to worry about it again which is super",
    "start": "1841679",
    "end": "1846640"
  },
  {
    "text": "nice yes do you have a link to the demo do I have a link to the demo yes I do",
    "start": "1851720",
    "end": "1858760"
  },
  {
    "text": "There You Go sir this is question",
    "start": "1858760",
    "end": "1867559"
  },
  {
    "text": "yes we are in the process of adopting the question was do you already",
    "start": "1869720",
    "end": "1876639"
  },
  {
    "text": "use Spire uh so thanks yes yeah okay",
    "start": "1876639",
    "end": "1885559"
  },
  {
    "text": "testing thank you for the talk so you talked about uh this for generating",
    "start": "1891480",
    "end": "1897159"
  },
  {
    "text": "tokens to access Cloud resources any thought about uh on premise",
    "start": "1897159",
    "end": "1903919"
  },
  {
    "text": "resources uh internal Cloud providers VSS spere integration with any providers",
    "start": "1903919",
    "end": "1909320"
  },
  {
    "text": "like that if you're not just using public Cloud so if you're not using public Cloud uh and if you have an",
    "start": "1909320",
    "end": "1916159"
  },
  {
    "text": "identity provider that you can fed with uh sure you can use it with on Prim clusters also yeah it works with so to",
    "start": "1916159",
    "end": "1924279"
  },
  {
    "text": "be clear this works with any cluster right we just SP it up on Mini Cube but it's more like what does it work with right so if if you're on Prem like",
    "start": "1924279",
    "end": "1931279"
  },
  {
    "text": "deploy like whatever it is service supports Federation then yeah you can totally use it if it doesn't support it then you're going to be as long as your",
    "start": "1931279",
    "end": "1937399"
  },
  {
    "text": "issuer is available and uh you know the Federation trust relationship can be built",
    "start": "1937399",
    "end": "1943639"
  },
  {
    "text": "yep any other questions",
    "start": "1943639",
    "end": "1948120"
  },
  {
    "text": "yeah any so internal application you mean uh applications on the cluster itself so",
    "start": "1955799",
    "end": "1963600"
  },
  {
    "text": "you can use bound service account tokens for that like the you know like I mentioned you can use projected service",
    "start": "1963600",
    "end": "1969000"
  },
  {
    "text": "account tokens which are Auto mounted inside the applications and then used within the cluster So within the cluster",
    "start": "1969000",
    "end": "1975080"
  },
  {
    "text": "there's never been a problem but now it's even better because now you can use tokens that are time and audience bound",
    "start": "1975080",
    "end": "1982840"
  },
  {
    "text": "yeah and if if you're going cluster to Cluster you can as long as you can as long as that oidc endpoint is available",
    "start": "1982840",
    "end": "1988200"
  },
  {
    "text": "you can always do a validation check against that endpoint to make sure that that token is valid and then you're good to",
    "start": "1988200",
    "end": "1994720"
  },
  {
    "text": "go uh thank you in the last diagram you were showing what was the relationship between the Spire server and the",
    "start": "2001039",
    "end": "2008440"
  },
  {
    "text": "oidc uh provider yeah that's a very good point and uh in the interest of time I",
    "start": "2008440",
    "end": "2013559"
  },
  {
    "text": "had just you know talked a little bit about it but if you you know I want to go a few slides",
    "start": "2013559",
    "end": "2018919"
  },
  {
    "text": "back uh here",
    "start": "2018919",
    "end": "2025440"
  },
  {
    "text": "sorry yeah so you see this workflow it's exactly like that think of uh instead of",
    "start": "2026240",
    "end": "2032639"
  },
  {
    "text": "the service account tokens think of uh Spire tokens where uh the spire as I",
    "start": "2032639",
    "end": "2038039"
  },
  {
    "text": "mentioned has an oidc integration so oidc Discovery is provided by the Spire",
    "start": "2038039",
    "end": "2043200"
  },
  {
    "text": "server and instead of the uh you know that the oidc discovery here being the",
    "start": "2043200",
    "end": "2049720"
  },
  {
    "text": "kubernetes uh service account isure this will be the Spire servers oidc endpoint",
    "start": "2049720",
    "end": "2054960"
  },
  {
    "text": "that you Federate with the external oidc application okay thank",
    "start": "2054960",
    "end": "2061200"
  },
  {
    "text": "you we got time for one more question anyone any takers",
    "start": "2061240",
    "end": "2068000"
  },
  {
    "text": "seems not awesome thanks everyone appreciate it",
    "start": "2072639",
    "end": "2078720"
  }
]