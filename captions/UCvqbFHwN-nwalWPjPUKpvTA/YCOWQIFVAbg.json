[
  {
    "start": "0",
    "end": "40000"
  },
  {
    "text": "hi everyone I'm Lucas shelter and right coming directly from Finland and I'm",
    "start": "30",
    "end": "7740"
  },
  {
    "text": "today gonna talk about qbm and how it works under the hood things like that I'm not a secular school student and",
    "start": "7740",
    "end": "16920"
  },
  {
    "text": "doing some cool stuff with combinators upstream contributing to some things and",
    "start": "16920",
    "end": "22230"
  },
  {
    "text": "working on this this year most like you barium and driving my own company that",
    "start": "22230",
    "end": "29099"
  },
  {
    "text": "is contracting for weworks and such things it's nice to be able to",
    "start": "29099",
    "end": "35550"
  },
  {
    "text": "contribute to this community so what are",
    "start": "35550",
    "end": "42000"
  },
  {
    "start": "40000",
    "end": "99000"
  },
  {
    "text": "we going to talk about today well how cube area what cube enemies and how it",
    "start": "42000",
    "end": "47250"
  },
  {
    "text": "fits into the ecosystem overall what is the scope why does it exist overall then",
    "start": "47250",
    "end": "54629"
  },
  {
    "text": "getting a bit more deeper into how does the different kubernetes components talk",
    "start": "54629",
    "end": "62190"
  },
  {
    "text": "to each other how is the cluster secured what is self hosting and how can we",
    "start": "62190",
    "end": "68670"
  },
  {
    "text": "benefit from using such a technique how does like m18 cube area metal",
    "start": "68670",
    "end": "74880"
  },
  {
    "text": "supports for easier upgrades and so what does that actually do under the hood and",
    "start": "74880",
    "end": "81770"
  },
  {
    "text": "then how can hedge a or high-availability someone could call it",
    "start": "81770",
    "end": "87450"
  },
  {
    "text": "multi master how can that be achieved with Q barium as a building block and",
    "start": "87450",
    "end": "93439"
  },
  {
    "text": "well this is a deep dive I hope you'll enjoy it okay so let's start with the",
    "start": "93439",
    "end": "101850"
  },
  {
    "start": "99000",
    "end": "395000"
  },
  {
    "text": "cube am the scope of cube am what what should cube Adam do where how does this fit into the ecosystem well it's at the",
    "start": "101850",
    "end": "111540"
  },
  {
    "text": "bottom of the stack we have some kind of instil infrastructure it could be some",
    "start": "111540",
    "end": "117930"
  },
  {
    "text": "of the public clouds shown here it could be your bare metal cluster it could be",
    "start": "117930",
    "end": "123710"
  },
  {
    "text": "my raspberry PI's on my desk or what what what any anything that",
    "start": "123710",
    "end": "130810"
  },
  {
    "text": "has some machines and then we're all",
    "start": "130810",
    "end": "136569"
  },
  {
    "text": "here today because we're excited about kubernetes yes then we want to have",
    "start": "136569",
    "end": "143230"
  },
  {
    "text": "kubernetes installed somehow to our machines and before qbm was created this",
    "start": "143230",
    "end": "151319"
  },
  {
    "text": "could could be done but it's it's kind of hard or you could use some other",
    "start": "151319",
    "end": "156900"
  },
  {
    "text": "end-to-end tool as well hmm so we create a cube area that bootstrap",
    "start": "156900",
    "end": "163090"
  },
  {
    "text": "kubernetes and it executes locally as a CLI tool on each machine it only sees",
    "start": "163090",
    "end": "172269"
  },
  {
    "text": "the machine it's a kid executing on like the file system and or other local",
    "start": "172269",
    "end": "178540"
  },
  {
    "text": "resources and the kubernetes api above it so what cubing cube Adam gets you is",
    "start": "178540",
    "end": "187150"
  },
  {
    "text": "a kubernetes cluster it stitches the parts together and makes it makes a best",
    "start": "187150",
    "end": "193870"
  },
  {
    "text": "practice but minimum viable cluster by design so we we don't install all the",
    "start": "193870",
    "end": "200410"
  },
  {
    "text": "things for you that's that's left up up to the user to lay a tree that could",
    "start": "200410",
    "end": "208920"
  },
  {
    "text": "possibly include things like cloud provider items a thing we're currently",
    "start": "208920",
    "end": "214739"
  },
  {
    "text": "wanting to extract out of core currently cloud providers are built a torso are",
    "start": "214739",
    "end": "221290"
  },
  {
    "text": "built into the core but that has some severe limitations so we're actively",
    "start": "221290",
    "end": "228549"
  },
  {
    "text": "trying to move those out to run as normal controllers on top of kubernetes",
    "start": "228549",
    "end": "234430"
  },
  {
    "text": "or it could be load balancers so monitoring logging whatever is still but",
    "start": "234430",
    "end": "241630"
  },
  {
    "text": "that's left up to the user and then we have a new exciting API coming up an API",
    "start": "241630",
    "end": "250780"
  },
  {
    "text": "spec called the cluster API you might have seen Robert Bayliss and Krishna was",
    "start": "250780",
    "end": "257229"
  },
  {
    "text": "talk earlier today about on this topic if you didn't you can check out check",
    "start": "257229",
    "end": "263169"
  },
  {
    "text": "the recording out on you in the coming weeks the cluster API is a",
    "start": "263169",
    "end": "268600"
  },
  {
    "text": "declarative way of specifying what should my cluster cluster look like I",
    "start": "268600",
    "end": "273900"
  },
  {
    "text": "can say things like I want the control plane configured like this and then I",
    "start": "273900",
    "end": "279640"
  },
  {
    "text": "want a machine set of these end nodes running on this cloud or whatever and",
    "start": "279640",
    "end": "286900"
  },
  {
    "text": "then we have some so the spec is generic but then we have an implementation that",
    "start": "286900",
    "end": "293050"
  },
  {
    "text": "is cloud specific or environment specific that is running on top of kubernetes and reconcile to create these",
    "start": "293050",
    "end": "300430"
  },
  {
    "text": "nodes and all masters so cube item is a tiny part in this",
    "start": "300430",
    "end": "305800"
  },
  {
    "text": "ecosystem there's a lot of different a lot of moving parts but cube atom is",
    "start": "305800",
    "end": "311530"
  },
  {
    "text": "this like turtle at the bottom that does it sting executes locally and has a very",
    "start": "311530",
    "end": "317560"
  },
  {
    "text": "small scope to just do the minimum viable thing needed for a cluster people",
    "start": "317560",
    "end": "325210"
  },
  {
    "text": "often ask me what is the difference between cubed M and cups are they competing which is better",
    "start": "325210",
    "end": "330960"
  },
  {
    "text": "things like that they aren't competing as they have totally different scopes",
    "start": "330960",
    "end": "337230"
  },
  {
    "text": "cubed M I said only executes locally on the master that's a very local view of",
    "start": "337230",
    "end": "344140"
  },
  {
    "text": "what's happening let's cops have this global view of the cluster and manages the infrastructure",
    "start": "344140",
    "end": "350650"
  },
  {
    "text": "all the machines bootstrapping kubernetes and atoms as well so there",
    "start": "350650",
    "end": "357160"
  },
  {
    "text": "are two total different things and should be used in by two different kinds",
    "start": "357160",
    "end": "364120"
  },
  {
    "text": "of uses if you just want a cluster up and running on AWS or GC or whatever and",
    "start": "364120",
    "end": "370870"
  },
  {
    "text": "want everything like just one command to do all the whole cluster for you then",
    "start": "370870",
    "end": "377230"
  },
  {
    "text": "cops is your thing if you want to build your own terraform whatever bootstrapper",
    "start": "377230",
    "end": "383080"
  },
  {
    "text": "on bare metal or your custom something then cube area might be your better a",
    "start": "383080",
    "end": "391180"
  },
  {
    "text": "better choice so what are the key design takeaways",
    "start": "391180",
    "end": "398230"
  },
  {
    "start": "395000",
    "end": "563000"
  },
  {
    "text": "with cubed em well when we started this effort one and a half years ago or so we",
    "start": "398230",
    "end": "404710"
  },
  {
    "text": "decided it should set up a best practice cluster for you and it should have a set",
    "start": "404710",
    "end": "409870"
  },
  {
    "text": "of very small scope the user experience should be simple and the class a reasonably secure for example we you can",
    "start": "409870",
    "end": "419260"
  },
  {
    "text": "add notes with this token the cubed M join which is a trade-off between",
    "start": "419260",
    "end": "424540"
  },
  {
    "text": "security and simplicity you can you can you don't have to use the token you can",
    "start": "424540",
    "end": "430840"
  },
  {
    "text": "use other ways as well like copying over a file from the master to the node and",
    "start": "430840",
    "end": "438120"
  },
  {
    "text": "it's intended to be a building book cube any minute that's a lot of things which",
    "start": "438120",
    "end": "443320"
  },
  {
    "text": "we'll see in a minute and you can run these separately as well it's a cube",
    "start": "443320",
    "end": "452920"
  },
  {
    "text": "Adam doesn't care about how the cube lattice run so we do provide package deb and RPM packages Sigler's the lifecycle",
    "start": "452920",
    "end": "460840"
  },
  {
    "text": "provides those for you but if you want to run cube area Mon like core OS or",
    "start": "460840",
    "end": "467440"
  },
  {
    "text": "Rancher or whatever other always that doesn't use them setup rpms you feel",
    "start": "467440",
    "end": "475510"
  },
  {
    "text": "free to run the cube let yourself and everything will just work",
    "start": "475510",
    "end": "482490"
  },
  {
    "text": "it's only a template then we made a design decision that we should not favor",
    "start": "482490",
    "end": "489070"
  },
  {
    "text": "any specific provider like flannel or weave or calico or something like that",
    "start": "489070",
    "end": "494860"
  },
  {
    "text": "instead we chose to not do do such",
    "start": "494860",
    "end": "501310"
  },
  {
    "text": "things and it's up to the user to install the CNI network we are a cube",
    "start": "501310",
    "end": "506950"
  },
  {
    "text": "CTL apply so that also has a consequence that if you run cube at a minute only",
    "start": "506950",
    "end": "512919"
  },
  {
    "text": "you won't get a working cluster as there is no networking the Cubans are Kotak",
    "start": "512919",
    "end": "521140"
  },
  {
    "text": "sure is composable and everything's divided interfaces as we'll see in the coming slide",
    "start": "521140",
    "end": "527720"
  },
  {
    "text": "who's the Cuban audience then who should use Cuban well a lot of users are happy",
    "start": "527720",
    "end": "533810"
  },
  {
    "text": "with this Cuban I mean it flows they're typing into the command line then joining nodes as they go and this is a",
    "start": "533810",
    "end": "541550"
  },
  {
    "text": "great way to get started to kubernetes start like tinkering about like with how",
    "start": "541550",
    "end": "548029"
  },
  {
    "text": "it works seeing all the API server running things like that or it could you be used in an",
    "start": "548029",
    "end": "554810"
  },
  {
    "text": "automated manner by tools like cops or cubicle or whatever so here is the",
    "start": "554810",
    "end": "565939"
  },
  {
    "start": "563000",
    "end": "630000"
  },
  {
    "text": "high-level component architecture for kubernetes we have the master which is",
    "start": "565939",
    "end": "571699"
  },
  {
    "text": "an API server which is stateless basically a REST API in front of a TD",
    "start": "571699",
    "end": "578230"
  },
  {
    "text": "then what makes kubernetes kubernetes is the controller manager which runs a",
    "start": "578230",
    "end": "584269"
  },
  {
    "text": "dozen dozens of controller loops to make sure that the solid state is the actual",
    "start": "584269",
    "end": "590810"
  },
  {
    "text": "state and reconcile on that then we also when you create the deployments for",
    "start": "590810",
    "end": "597529"
  },
  {
    "text": "example the controller manager will create replicas set and it turned ports",
    "start": "597529",
    "end": "602680"
  },
  {
    "text": "as a consequence and then the scheduler will kick in and bind these pods to a",
    "start": "602680",
    "end": "607970"
  },
  {
    "text": "node which will then trigger the cubelet to run the container image of your",
    "start": "607970",
    "end": "614779"
  },
  {
    "text": "choice using the container runtime which will well then execute on your host and we",
    "start": "614779",
    "end": "622759"
  },
  {
    "text": "have the all these beautiful interfaces with C and I CRI LCI etc so qubit a",
    "start": "622759",
    "end": "633110"
  },
  {
    "start": "630000",
    "end": "870000"
  },
  {
    "text": "minute does a lot of things the first thing it does is generate the needed",
    "start": "633110",
    "end": "638990"
  },
  {
    "text": "certificates they are a couple we have",
    "start": "638990",
    "end": "644149"
  },
  {
    "text": "the root CA cert which is the boundary of trust for a cluster from that root",
    "start": "644149",
    "end": "652279"
  },
  {
    "text": "CSR the API serving cert is generated with when I years well and it's valid",
    "start": "652279",
    "end": "658970"
  },
  {
    "text": "for a year then we have the cubelet client search",
    "start": "658970",
    "end": "664020"
  },
  {
    "text": "so well we'll see in a later slide that the API server when calling when you're",
    "start": "664020",
    "end": "671170"
  },
  {
    "text": "calling cube CTL logs or cube CTL x'q you are talking to the api server which",
    "start": "671170",
    "end": "676570"
  },
  {
    "text": "then is talking to the cubelet and then",
    "start": "676570",
    "end": "681730"
  },
  {
    "text": "the api server needs some kind of credential to talk to the cubelet then",
    "start": "681730",
    "end": "688480"
  },
  {
    "text": "we have a service account private key and some things needed for api aggregation support then we have we",
    "start": "688480",
    "end": "696760"
  },
  {
    "text": "generate some identities for the initial actors in the cluster",
    "start": "696760",
    "end": "703110"
  },
  {
    "text": "for example the cubelet client cert or search for the admin or for the KCM and",
    "start": "703890",
    "end": "712270"
  },
  {
    "text": "scheduler so far so good then we post a TD you could do this",
    "start": "712270",
    "end": "719530"
  },
  {
    "text": "externally as well I mean that's probably preferable but then the easiest",
    "start": "719530",
    "end": "727210"
  },
  {
    "text": "way is using a static port and letting the cubelet host it for you basically",
    "start": "727210",
    "end": "733390"
  },
  {
    "text": "babysit it then we have the API server controller manager and scheduler running",
    "start": "733390",
    "end": "739270"
  },
  {
    "text": "a static ports in from that it's EQ Benares manifest directory the running",
    "start": "739270",
    "end": "748180"
  },
  {
    "text": "cubelet will then start these static ports and we'll have the control plane",
    "start": "748180",
    "end": "753910"
  },
  {
    "text": "up and running",
    "start": "753910",
    "end": "756449"
  },
  {
    "text": "then Cuba remarks the initial node to be",
    "start": "759930",
    "end": "766269"
  },
  {
    "text": "schedulable with this label or key value pair and it also taints the master to",
    "start": "766269",
    "end": "773680"
  },
  {
    "text": "not schedule workloads there by default so and this is because of security",
    "start": "773680",
    "end": "778959"
  },
  {
    "text": "boundaries you shouldn't really run normal workloads on your master as that",
    "start": "778959",
    "end": "785709"
  },
  {
    "text": "might lead to privilege escalation pretty easily as well hence we have the",
    "start": "785709",
    "end": "792130"
  },
  {
    "text": "taint so that your your normal work laws won't schedule on the master then the",
    "start": "792130",
    "end": "798250"
  },
  {
    "text": "first queue Batum specific thing is that queue bearing will upload the configuration the internal state of the",
    "start": "798250",
    "end": "807100"
  },
  {
    "text": "world it's a config map so that later when upgrading it will know what is the",
    "start": "807100",
    "end": "812350"
  },
  {
    "text": "current state of the world and act based on that lastly we create a boot up token so you",
    "start": "812350",
    "end": "819700"
  },
  {
    "text": "can add you can use the cubed M join functionality to authenticate to the master when when adding this node and",
    "start": "819700",
    "end": "827550"
  },
  {
    "text": "then deploy the mandatory add-ons in order to pass conformance tests so that",
    "start": "827550",
    "end": "834699"
  },
  {
    "text": "is that is the current bar of cubed M cubed M should create a cluster that makes it possible to pass the",
    "start": "834699",
    "end": "840760"
  },
  {
    "text": "conformance test but nothing more I mean as well as other things like heap store",
    "start": "840760",
    "end": "845940"
  },
  {
    "text": "which is now matrix server or some logging solution or whatever other thing",
    "start": "845940",
    "end": "852550"
  },
  {
    "text": "that is normally used in kubernetes cluster should be installed by the use",
    "start": "852550",
    "end": "857740"
  },
  {
    "text": "of themselves or this higher level solution and one thing is one cool thing",
    "start": "857740",
    "end": "863860"
  },
  {
    "text": "is core DNS support is now alpha in 1 9 you can enable that with a feature gate",
    "start": "863860",
    "end": "870449"
  },
  {
    "start": "870000",
    "end": "922000"
  },
  {
    "text": "but if you don't want to do all these things at the same time or in like this",
    "start": "870449",
    "end": "879010"
  },
  {
    "text": "full meal deal you could run these phases as we call them these atomic sub",
    "start": "879010",
    "end": "886209"
  },
  {
    "text": "steps of cluster creation you could run them separately",
    "start": "886209",
    "end": "891320"
  },
  {
    "text": "generate the cube configs certificates the control plane static pawn manifests",
    "start": "891320",
    "end": "897200"
  },
  {
    "text": "and etc or you could if you have some good replacement or don't need for",
    "start": "897200",
    "end": "903890"
  },
  {
    "text": "example the bootstrap token you can just don't do that and do everything else and",
    "start": "903890",
    "end": "911530"
  },
  {
    "text": "provide some other like copying over the file there are credentials from the",
    "start": "911530",
    "end": "917090"
  },
  {
    "text": "master to the node if Stella so what",
    "start": "917090",
    "end": "924400"
  },
  {
    "start": "922000",
    "end": "1272000"
  },
  {
    "text": "does a like in a TLS secured cluster how",
    "start": "924400",
    "end": "929420"
  },
  {
    "text": "do these components talk to each other with what credentials and so forth well",
    "start": "929420",
    "end": "935900"
  },
  {
    "text": "we have the API server which serves on HTTP by default six four six four four",
    "start": "935900",
    "end": "942320"
  },
  {
    "text": "three and we have this cubelet client cert as I talked about then we have the",
    "start": "942320",
    "end": "949490"
  },
  {
    "text": "other components with their certificates that have have to have this like photo",
    "start": "949490",
    "end": "956510"
  },
  {
    "text": "control manager for example it has to have the CM of system cube controller",
    "start": "956510",
    "end": "961820"
  },
  {
    "text": "manager in order for it to be able to pass that well have the right or back",
    "start": "961820",
    "end": "969140"
  },
  {
    "text": "privileges of course if you have something else you have to assign you",
    "start": "969140",
    "end": "974300"
  },
  {
    "text": "have to create a cluster role binding between the normal well the control",
    "start": "974300",
    "end": "980420"
  },
  {
    "text": "manager privileges and dessert the controller manager runs to in this case",
    "start": "980420",
    "end": "987280"
  },
  {
    "text": "significance controllers which are the CSR signer and the CSR approver which",
    "start": "987280",
    "end": "992300"
  },
  {
    "text": "we'll see in action a bit later and here a CSR is a certificate signing request",
    "start": "992300",
    "end": "999460"
  },
  {
    "text": "then we have the initial master node and now we're about to join the second one",
    "start": "999460",
    "end": "1007770"
  },
  {
    "text": "we're now basically typing in cubed M join with with the token the cubelet",
    "start": "1007770",
    "end": "1013930"
  },
  {
    "text": "we'll start with a self-signed HTTP server this is still an area to improve this is basically true for all companies",
    "start": "1013930",
    "end": "1021400"
  },
  {
    "text": "deployments right now that the cubelets art is of a self-signed as we go hopefully this",
    "start": "1021400",
    "end": "1028990"
  },
  {
    "text": "feature will graduate to be the next title in 110 so that it can use the same",
    "start": "1028990",
    "end": "1034688"
  },
  {
    "text": "cluster CA but as that is working progress with singles so we give cubed",
    "start": "1034689",
    "end": "1043209"
  },
  {
    "text": "em the boot up token and it will figure out the trusted CA which is you which",
    "start": "1043209",
    "end": "1049090"
  },
  {
    "text": "the cubelets uses to talk to the API server will then get a CSR with no node",
    "start": "1049090",
    "end": "1057520"
  },
  {
    "text": "to which then the CSR approver will",
    "start": "1057520",
    "end": "1062679"
  },
  {
    "text": "automatically go ahead and approve if you don't want this link you can disable",
    "start": "1062679",
    "end": "1068409"
  },
  {
    "text": "it it's just an Arabic rule but by default in order to have a smooth flow",
    "start": "1068409",
    "end": "1074890"
  },
  {
    "text": "for you when you're joining notes that CSR approver automatically approves which the CSR signer then signs so that",
    "start": "1074890",
    "end": "1086770"
  },
  {
    "text": "means we have the C a key on the master we never give away the CA key anywhere",
    "start": "1086770",
    "end": "1093880"
  },
  {
    "text": "and then we have a single we have this",
    "start": "1093880",
    "end": "1101169"
  },
  {
    "text": "reconciliation flow where we just post these requests and whoever has the C a",
    "start": "1101169",
    "end": "1108730"
  },
  {
    "text": "key can then go ahead and sign them this",
    "start": "1108730",
    "end": "1114130"
  },
  {
    "text": "is also true for external cs for example one common request with cubed M is I have some kind of corporate policy that",
    "start": "1114130",
    "end": "1120970"
  },
  {
    "text": "I don't get access to the CI key or I can't move its own cluster how can i",
    "start": "1120970",
    "end": "1126370"
  },
  {
    "text": "Milla gate that and still use cubed M well the answer is you run cube RM face",
    "start": "1126370",
    "end": "1132960"
  },
  {
    "text": "certificates and cube config which will give you all the required identities",
    "start": "1132960",
    "end": "1138280"
  },
  {
    "text": "while you're having the CI key then you'll just go ahead and copy everything",
    "start": "1138280",
    "end": "1144880"
  },
  {
    "text": "by but the see a key to the cluster and run this CSR sign or somewhere else",
    "start": "1144880",
    "end": "1151980"
  },
  {
    "text": "that will give you the same effect so cool now we got the client search for",
    "start": "1151980",
    "end": "1160080"
  },
  {
    "text": "the node for the second node and we have and its identity is unique then we have",
    "start": "1160080",
    "end": "1166980"
  },
  {
    "text": "an old another feature introduced in 1:7 which is the node authorizer which will",
    "start": "1166980",
    "end": "1171990"
  },
  {
    "text": "make it which scopes down their cubelet privileges to only what it actually runs",
    "start": "1171990",
    "end": "1179419"
  },
  {
    "text": "so when the queue when you type in cube CTL logs the API server is going to",
    "start": "1180649",
    "end": "1187369"
  },
  {
    "text": "insecure or unverified connection to the",
    "start": "1187369",
    "end": "1193799"
  },
  {
    "text": "self-signed HTTP or so the this request is using HTTP but the API server can't",
    "start": "1193799",
    "end": "1200129"
  },
  {
    "text": "be sure that the cubelet is the one that it's actually pretending to be but this",
    "start": "1200129",
    "end": "1207570"
  },
  {
    "text": "is working progress and contributions welcome as always",
    "start": "1207570",
    "end": "1212809"
  },
  {
    "text": "then when the tublat gets this call or",
    "start": "1212809",
    "end": "1218039"
  },
  {
    "text": "gets any call it will send a subject access review request to the API server",
    "start": "1218039",
    "end": "1223830"
  },
  {
    "text": "asking is this actor now the cubelet client authorized to call my API",
    "start": "1223830",
    "end": "1231529"
  },
  {
    "text": "basically it's it's asking is this person who is trying to access my API",
    "start": "1231529",
    "end": "1237629"
  },
  {
    "text": "root in the cluster and in this case yes",
    "start": "1237629",
    "end": "1242809"
  },
  {
    "text": "in other cases no so in one four and one",
    "start": "1242809",
    "end": "1248610"
  },
  {
    "text": "five and earlier most clusters didn't secure this cubelet api bit which",
    "start": "1248610",
    "end": "1253889"
  },
  {
    "text": "essentially made it possible to access if you could ping any node you could exit in to that node because there when",
    "start": "1253889",
    "end": "1261899"
  },
  {
    "text": "there were no authentication in this step but as of cubed n16 this is all",
    "start": "1261899",
    "end": "1269100"
  },
  {
    "text": "secured okay let's move on to self",
    "start": "1269100",
    "end": "1274169"
  },
  {
    "start": "1272000",
    "end": "1330000"
  },
  {
    "text": "hosting what does it mean well we're using kubernetes primitives to configure",
    "start": "1274169",
    "end": "1282600"
  },
  {
    "text": "and host the control control plane itself and",
    "start": "1282600",
    "end": "1289070"
  },
  {
    "text": "this was in it this concept was developed by Korres and has been vetted in the boot cube project now we're",
    "start": "1289149",
    "end": "1296769"
  },
  {
    "text": "working the Cygnus lifecycle team is working on upstreaming this kind of functionality into cube ATM into this",
    "start": "1296769",
    "end": "1303129"
  },
  {
    "text": "building block the cube enemies so you can still run your cluster is in static",
    "start": "1303129",
    "end": "1308440"
  },
  {
    "text": "pods but the chances are you might want to use self-hosting because it leads to",
    "start": "1308440",
    "end": "1314559"
  },
  {
    "text": "easier upgrades eventually and stuff like that there's also another self-hosting talk",
    "start": "1314559",
    "end": "1320799"
  },
  {
    "text": "tomorrow by Diego from korra's make sure you check that out and so how is a",
    "start": "1320799",
    "end": "1333509"
  },
  {
    "start": "1330000",
    "end": "1437000"
  },
  {
    "text": "self-hosting cluster created that's kind of a pack to many people as well here is",
    "start": "1333509",
    "end": "1339849"
  },
  {
    "text": "the sequence diagram how it works there's quite some detail as well but",
    "start": "1339849",
    "end": "1345399"
  },
  {
    "text": "this is the deep dive so I guess it's fitting first cube areum was has to know",
    "start": "1345399",
    "end": "1353379"
  },
  {
    "text": "like what's the actual state what's the current state it figures that out by",
    "start": "1353379",
    "end": "1358539"
  },
  {
    "text": "reading the local file system for the static force it then mutates these static ports a bit to work a self-hosted",
    "start": "1358539",
    "end": "1366369"
  },
  {
    "text": "components for example tolerating the master taint is one thing and then it",
    "start": "1366369",
    "end": "1373599"
  },
  {
    "text": "just goes ahead and creates the exact same the nearly exact same resource in",
    "start": "1373599",
    "end": "1378609"
  },
  {
    "text": "the API server so you could pretend and think of it like I'm running a new",
    "start": "1378609",
    "end": "1384759"
  },
  {
    "text": "workload it's an API server that should be run on my master then the API server",
    "start": "1384759",
    "end": "1393369"
  },
  {
    "text": "is run but it can't bind to the port it's trying to bind to the 6 4 4 3 port",
    "start": "1393369",
    "end": "1399519"
  },
  {
    "text": "or whatever but then the cell the static pod hosted API server already listens to",
    "start": "1399519",
    "end": "1408159"
  },
  {
    "text": "that port so the self hosted API so we'll go ahead and trash loop when Cuban",
    "start": "1408159",
    "end": "1413710"
  },
  {
    "text": "and detects this crash rule looping it will remove the static port API server and the self hosted one will come up",
    "start": "1413710",
    "end": "1420219"
  },
  {
    "text": "cleanly and now we have a stage where kubernetes",
    "start": "1420219",
    "end": "1425320"
  },
  {
    "text": "can manage itself which is kind of cool and then given does this for all",
    "start": "1425320",
    "end": "1431980"
  },
  {
    "text": "components and there we go",
    "start": "1431980",
    "end": "1435960"
  },
  {
    "start": "1437000",
    "end": "1595000"
  },
  {
    "text": "upgrading clusters with cue barium we",
    "start": "1437310",
    "end": "1443680"
  },
  {
    "text": "made it easier with cuban upgrade plan and cuba time upgrade apply these helper",
    "start": "1443680",
    "end": "1451090"
  },
  {
    "text": "commands have a good UX and makes it straightforward to upgrade the cluster",
    "start": "1451090",
    "end": "1456220"
  },
  {
    "text": "but and then hides the complexity under the hood in 1 1 8 + 1 9",
    "start": "1456220",
    "end": "1465130"
  },
  {
    "text": "this basically shuffles around these static ports on disk and make sure to",
    "start": "1465130",
    "end": "1471670"
  },
  {
    "text": "catch edge cases and rollbacks for",
    "start": "1471670",
    "end": "1477520"
  },
  {
    "text": "example if the 1/9 manifest doesn't come up cleanly will roll back and but then",
    "start": "1477520",
    "end": "1485200"
  },
  {
    "text": "the promise is with self-hosted up with self-hosted and aj will be able to like",
    "start": "1485200",
    "end": "1491860"
  },
  {
    "text": "roll it out like any manifests well we'll just edit the daemon set it will",
    "start": "1491860",
    "end": "1499500"
  },
  {
    "text": "use the the controller manager will roll out new pods as we go and replace the",
    "start": "1499500",
    "end": "1505480"
  },
  {
    "text": "old ones and if something fails it will roll back itself so that is a cool thing",
    "start": "1505480",
    "end": "1514330"
  },
  {
    "text": "and in 1:9 we're also supporting automated downgrades in a future release",
    "start": "1514330",
    "end": "1521080"
  },
  {
    "text": "we might look at run time reconfiguration or basically cube CTL apply for a cluster so let's",
    "start": "1521080",
    "end": "1529060"
  },
  {
    "text": "say you started you started your cluster with some config or like normal cubed a",
    "start": "1529060",
    "end": "1538270"
  },
  {
    "text": "minute then you a week later or a month later found out that I should actually",
    "start": "1538270",
    "end": "1543940"
  },
  {
    "text": "have done this kind of thing but you have use of workloads there and don't",
    "start": "1543940",
    "end": "1549310"
  },
  {
    "text": "want to tear everything down then you could just do a cube a time upgrade",
    "start": "1549310",
    "end": "1554590"
  },
  {
    "text": "apply with a new desired state of the world and Cuba and we'll roll that out for you",
    "start": "1554590",
    "end": "1561639"
  },
  {
    "text": "we don't officially so support this yet because there are some parameters that",
    "start": "1561639",
    "end": "1568019"
  },
  {
    "text": "could be dangerous to to reconfigure that we'll get into",
    "start": "1568019",
    "end": "1574419"
  },
  {
    "text": "weird state so we probably have to catch that but technically it's already",
    "start": "1574419",
    "end": "1580149"
  },
  {
    "text": "working and possible to do if you know what you're doing",
    "start": "1580149",
    "end": "1586018"
  },
  {
    "text": "yeah so we have heard a user request",
    "start": "1594430",
    "end": "1600670"
  },
  {
    "text": "that AJ would be nice to have and yes it",
    "start": "1600670",
    "end": "1606970"
  },
  {
    "text": "would the the ideal flow here would be Cuban a minute",
    "start": "1606970",
    "end": "1611980"
  },
  {
    "text": "then we get to tokens we get one master token that we can use to add the master",
    "start": "1611980",
    "end": "1618490"
  },
  {
    "text": "and we get one node token as usual to add nodes by definition this means that",
    "start": "1618490",
    "end": "1625870"
  },
  {
    "text": "the the master token is equal to a net CD private key to a TD right key and",
    "start": "1625870",
    "end": "1635250"
  },
  {
    "text": "that is the thing like you may ask yourself is that production grade or is",
    "start": "1635250",
    "end": "1641350"
  },
  {
    "text": "that secure to have 22 chars string Abel",
    "start": "1641350",
    "end": "1647770"
  },
  {
    "text": "like if someone else gets to know this 22 char string then they'll have access",
    "start": "1647770",
    "end": "1654040"
  },
  {
    "text": "to my Etsy d2 rock-like can basically do anything so in order to achieve this we",
    "start": "1654040",
    "end": "1663820"
  },
  {
    "text": "have three primary challenges first we have to manage state and this is",
    "start": "1663820",
    "end": "1669340"
  },
  {
    "text": "probably the hardest one how do we run a TD especially in a secure manner with",
    "start": "1669340",
    "end": "1677650"
  },
  {
    "text": "unique identities dynamic identities like we could start cube at a minute run",
    "start": "1677650",
    "end": "1684190"
  },
  {
    "text": "one master for a week add some notes as we go then a month later find out that",
    "start": "1684190",
    "end": "1691630"
  },
  {
    "text": "well I actually want to have two masters or then three masters or five so we",
    "start": "1691630",
    "end": "1700540"
  },
  {
    "text": "can't know in in beforehand what will the desired cluster state look like instead we have to dynamically",
    "start": "1700540",
    "end": "1707050"
  },
  {
    "text": "reconfigure which is challenging then",
    "start": "1707050",
    "end": "1712150"
  },
  {
    "text": "sharing and rotating the common certificate between all masters is another challenge we have these like for",
    "start": "1712150",
    "end": "1720520"
  },
  {
    "text": "example the service account private key has to be the same in all controller managers otherwise",
    "start": "1720520",
    "end": "1727270"
  },
  {
    "text": "we'll get in interweb state where pods will start erroring so these these have",
    "start": "1727270",
    "end": "1736300"
  },
  {
    "text": "to be like on all masters but they also have to be rotated rotated at the same",
    "start": "1736300",
    "end": "1743530"
  },
  {
    "text": "time if we or when we rotate things and",
    "start": "1743530",
    "end": "1749080"
  },
  {
    "text": "then how should the cube let's be able to access to address all masters",
    "start": "1749080",
    "end": "1756150"
  },
  {
    "text": "dynamically so we started with the one master all cube let's talk to this one master then we scale that up to three",
    "start": "1756150",
    "end": "1763300"
  },
  {
    "text": "and now suddenly they should be able to somehow discover all three masters in a",
    "start": "1763300",
    "end": "1773050"
  },
  {
    "text": "secure way to be added well you can",
    "start": "1773050",
    "end": "1778690"
  },
  {
    "text": "achieve cubed M AJ today and that is one",
    "start": "1778690",
    "end": "1785200"
  },
  {
    "text": "of the most common misunderstandings which I'm glad to clarify here if you",
    "start": "1785200",
    "end": "1790780"
  },
  {
    "text": "run your own a TD AJ cluster to start with that might not be easy but we'll",
    "start": "1790780",
    "end": "1798400"
  },
  {
    "text": "provide documentation for the one nine release what it could look like and you",
    "start": "1798400",
    "end": "1806410"
  },
  {
    "text": "could build some some kind of automation yourself like ansible terraform or whatever then run cube animate on the",
    "start": "1806410",
    "end": "1816760"
  },
  {
    "text": "first master copy over the shared certificates to the second one run cube Adam in it again and do the",
    "start": "1816760",
    "end": "1823420"
  },
  {
    "text": "same for the third one so basically or you could preach ener eight all",
    "start": "1823420",
    "end": "1828670"
  },
  {
    "text": "certificates and just distribute them to all masters that might be preferable",
    "start": "1828670",
    "end": "1834630"
  },
  {
    "text": "then some kind of external load balancer it could be a load balancer or DNS",
    "start": "1834630",
    "end": "1842860"
  },
  {
    "text": "server or something like that just to make the cube let's address all the",
    "start": "1842860",
    "end": "1850510"
  },
  {
    "text": "Masters dynamically what static therefore I thought also",
    "start": "1850510",
    "end": "1855820"
  },
  {
    "text": "work and then the API service should talk to a TD so this is all doable and I",
    "start": "1855820",
    "end": "1863739"
  },
  {
    "text": "said will provide documentation for you how to do this there's there are more",
    "start": "1863739",
    "end": "1869139"
  },
  {
    "text": "commands to to execute than a cube radium joined by Chef master but at the",
    "start": "1869139",
    "end": "1876789"
  },
  {
    "text": "same time it takes a lot of a lot of pain away from you anyway because if",
    "start": "1876789",
    "end": "1883479"
  },
  {
    "text": "you're about to do or create a normal age a kubernetes cluster there's a lot",
    "start": "1883479",
    "end": "1891940"
  },
  {
    "text": "of things cubed I'm already just for you as said here with with things like",
    "start": "1891940",
    "end": "1898529"
  },
  {
    "text": "certificate generation and control plane spec generation with good defaults etc",
    "start": "1898529",
    "end": "1908409"
  },
  {
    "text": "so this is going to be documented then one possible solution to create this",
    "start": "1908409",
    "end": "1916559"
  },
  {
    "text": "cubed M join - master flow could be this",
    "start": "1916559",
    "end": "1924299"
  },
  {
    "text": "we're using the cubelet as the babysitter sitter for all components",
    "start": "1924539",
    "end": "1931529"
  },
  {
    "text": "self hosting the api server and control manager scheduler in daemon sets using",
    "start": "1931529",
    "end": "1937830"
  },
  {
    "text": "putting all the cluster certificates in secrets and having self hosting at CD on",
    "start": "1937830",
    "end": "1945399"
  },
  {
    "text": "top this is extremely challenging though",
    "start": "1945399",
    "end": "1950589"
  },
  {
    "text": "and hasn't been proven to work so I mean",
    "start": "1950589",
    "end": "1955749"
  },
  {
    "text": "this is one idea that we could do but",
    "start": "1955749",
    "end": "1961200"
  },
  {
    "text": "and then use something like envoy as a daemon set to address envoy as a proxy",
    "start": "1961200",
    "end": "1968739"
  },
  {
    "text": "to address the Masters in the meantime we might do something in between that",
    "start": "1968739",
    "end": "1975700"
  },
  {
    "text": "you can do cubed MHA but you still have to set up a TD externally and we'll do",
    "start": "1975700",
    "end": "1983559"
  },
  {
    "text": "the other two parts for you or whatever as Cuba diem has this local scope it's",
    "start": "1983559",
    "end": "1989220"
  },
  {
    "text": "really hard to not the global scope and and that it would know of all machines",
    "start": "1989220",
    "end": "1997350"
  },
  {
    "text": "it's very hard to achieve this cubed M join - - master flow just like that but",
    "start": "1997350",
    "end": "2005000"
  },
  {
    "text": "joins in lost lifecycle and you you'll be a valuable resource for us to speck",
    "start": "2005000",
    "end": "2011810"
  },
  {
    "text": "this out it's possible in that case how if it isn't possible with one command",
    "start": "2011810",
    "end": "2018380"
  },
  {
    "text": "maybe two or three and yeah that was my",
    "start": "2018380",
    "end": "2025760"
  },
  {
    "text": "talk I'll post the or this presentation is posted on scab so you can check it",
    "start": "2025760",
    "end": "2033140"
  },
  {
    "text": "out there and look at these links and yeah let's talk about this in three",
    "start": "2033140",
    "end": "2040970"
  },
  {
    "text": "class life cycle and continue to improve cubed M - Gi Gi and beyond any questions",
    "start": "2040970",
    "end": "2049030"
  },
  {
    "text": "we have one minute so as an alternative",
    "start": "2049030",
    "end": "2058550"
  },
  {
    "text": "to a che sometimes it feels like it would be nice to just like have a snapshot of its eg",
    "start": "2058550",
    "end": "2063919"
  },
  {
    "text": "and if something goes bad I'm like a panic and I kind of restore with that with is it easy to get Cuba DM to do",
    "start": "2063919",
    "end": "2072950"
  },
  {
    "text": "that or is that not at all the right direction I think you think helped a",
    "start": "2072950",
    "end": "2080120"
  },
  {
    "text": "lark or something similar will would be useful there or a dedicated backup tool",
    "start": "2080120",
    "end": "2086409"
  },
  {
    "text": "of course you could at CDC TL snapshot what I was assuming I have the backups",
    "start": "2086410",
    "end": "2092570"
  },
  {
    "text": "like it let's say I have a backup of HCG and I work in panic mode and I try to revive my dead cube master can I use",
    "start": "2092570",
    "end": "2100370"
  },
  {
    "text": "Cuba diem for that or am I using the wrong hammer on the wrong nail I would",
    "start": "2100370",
    "end": "2107290"
  },
  {
    "text": "haven't thought through it but spontaneously I would say you should use another tool okay thanks",
    "start": "2107290",
    "end": "2114140"
  },
  {
    "text": "let I'll go can you use cube admin to manage",
    "start": "2114140",
    "end": "2121579"
  },
  {
    "text": "existing clusters let's say if I have an existing production kubernetes cluster which is not created or managed using",
    "start": "2121579",
    "end": "2127579"
  },
  {
    "text": "cube Edwin can I use cubed win to take over that no I wouldn't say that okay I",
    "start": "2127579",
    "end": "2134810"
  },
  {
    "text": "mean it all depends if you happen to use the nail in the same semantics maybe but",
    "start": "2134810",
    "end": "2143109"
  },
  {
    "text": "there are so many parameters that that's probably impossible",
    "start": "2143109",
    "end": "2151240"
  },
  {
    "text": "so cube EDM has a had a slide where you can do everything in phases yeah the pay",
    "start": "2161190",
    "end": "2168870"
  },
  {
    "text": "functionalize there since 1/8 so and unfortunately not now the times up",
    "start": "2168870",
    "end": "2174570"
  },
  {
    "text": "so we'll have to you can come and talk to me after this and also we're gonna",
    "start": "2174570",
    "end": "2182390"
  },
  {
    "text": "host cyclist lifecycle in person meet up the tracker project at Hilton in Hilton",
    "start": "2182390",
    "end": "2189900"
  },
  {
    "text": "Austin just right now after this so feel free to come and talk to us to Clough",
    "start": "2189900",
    "end": "2195870"
  },
  {
    "text": "lifecycle guys after this thank you [Applause]",
    "start": "2195870",
    "end": "2203589"
  }
]