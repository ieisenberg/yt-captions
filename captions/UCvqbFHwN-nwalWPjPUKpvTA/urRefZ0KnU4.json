[
  {
    "text": "hello everyone Thank you for coming to our session on waring group",
    "start": "1120",
    "end": "8440"
  },
  {
    "text": "snapshots My name is Shining I work at VML by Bortcon I'm also co-chair of",
    "start": "8440",
    "end": "14759"
  },
  {
    "text": "Kubernetes six storage And my name is Leonardo I'm a principal software",
    "start": "14759",
    "end": "20400"
  },
  {
    "text": "engineer working in EDB I'm a posgress user since a lot of time and I I'm a",
    "start": "20400",
    "end": "26880"
  },
  {
    "text": "contributor to the Kubernetes CSI project and a maintainer of the cloud native PG",
    "start": "26880",
    "end": "34640"
  },
  {
    "text": "project Here's today's agenda We will discuss why we need warning group snapshots explain how it",
    "start": "38440",
    "end": "45840"
  },
  {
    "text": "works and how to use it At the end we will do a demo",
    "start": "45840",
    "end": "53160"
  },
  {
    "text": "When I was preparing for this presentation I asked Chad GBT to show me",
    "start": "54800",
    "end": "60000"
  },
  {
    "text": "why disaster recovery is important Here's what I got It looks chaotic and",
    "start": "60000",
    "end": "66159"
  },
  {
    "text": "dangerous all around but in the middle of this picture it looks calm and",
    "start": "66159",
    "end": "72200"
  },
  {
    "text": "safe This is definitely better than what I can draw here We have a data center being",
    "start": "72200",
    "end": "80080"
  },
  {
    "text": "protected from disasters such as fire flood cyber attacks A shield that",
    "start": "80080",
    "end": "87680"
  },
  {
    "text": "safeguards your critical data A contrast between chaos and",
    "start": "87680",
    "end": "94600"
  },
  {
    "text": "security Disaster can happen at any time How do we protect our precious data from",
    "start": "94600",
    "end": "100960"
  },
  {
    "text": "a potential loss here I listed what could cause a disaster Actually human",
    "start": "100960",
    "end": "107759"
  },
  {
    "text": "error is one of the leading factors as shown in this picture If this",
    "start": "107759",
    "end": "114640"
  },
  {
    "text": "data center is burned down your data stored there will be lost for sure",
    "start": "114640",
    "end": "119920"
  },
  {
    "text": "However if you have your data backed up in a different location you can always",
    "start": "119920",
    "end": "125520"
  },
  {
    "text": "restore your data back So data protection and disaster recovery",
    "start": "125520",
    "end": "131200"
  },
  {
    "text": "are very important for your mission critical",
    "start": "131200",
    "end": "136160"
  },
  {
    "text": "applications Volume snapshot API was introduced back in Kubernetes 1.12",
    "start": "138599",
    "end": "144959"
  },
  {
    "text": "release and moved to G in Kubernetes 1.20 release It allows you to take a",
    "start": "144959",
    "end": "151680"
  },
  {
    "text": "crash consistent snapshot of a persistent volume and use that to",
    "start": "151680",
    "end": "156879"
  },
  {
    "text": "restore your data back at a later time if a disaster strikes It provides a basic building",
    "start": "156879",
    "end": "164239"
  },
  {
    "text": "block to protect your applications running in",
    "start": "164239",
    "end": "170319"
  },
  {
    "text": "Kubernetes We already have a volume snapshot API for inter video volumes So",
    "start": "170440",
    "end": "176480"
  },
  {
    "text": "why do we need volume group snapshots now let's take a look at an",
    "start": "176480",
    "end": "182800"
  },
  {
    "text": "example Suppose you have an application running that uses multiple volumes to",
    "start": "184040",
    "end": "190319"
  },
  {
    "text": "store its data logs and so on You want to protect your application To ensure application",
    "start": "190319",
    "end": "198040"
  },
  {
    "text": "consistency you need to quiet your application before taking a snapshot and",
    "start": "198040",
    "end": "203360"
  },
  {
    "text": "unquest afterwards But quas takes a long time and it is very expensive So you may",
    "start": "203360",
    "end": "210080"
  },
  {
    "text": "not want to do it frequently But you still want to be able to back up your data more",
    "start": "210080",
    "end": "216200"
  },
  {
    "text": "frequently Without application quas you take a snapshot of the first volume at",
    "start": "216200",
    "end": "222319"
  },
  {
    "text": "time one Then you take a snapshot of the second volume at time",
    "start": "222319",
    "end": "228519"
  },
  {
    "text": "two Then you take a snapshot of the third volume at time three",
    "start": "228519",
    "end": "235120"
  },
  {
    "text": "Now you try to clone the same application to a different name space or",
    "start": "235120",
    "end": "240319"
  },
  {
    "text": "maybe your original application is corrupted somehow You are trying to restore your application back from those",
    "start": "240319",
    "end": "247720"
  },
  {
    "text": "snapshots Now after restore you may run into problems because the snapshots were",
    "start": "247720",
    "end": "253680"
  },
  {
    "text": "taken at different times and you get inconsistent",
    "start": "253680",
    "end": "259000"
  },
  {
    "text": "data How do we solve this problem",
    "start": "259000",
    "end": "264040"
  },
  {
    "text": "fortunately we have consistent group snapshots come to the rescue Consistent group snapshot allows",
    "start": "264479",
    "end": "272000"
  },
  {
    "text": "a snapshot to be taken from multiple volumes at the same point in time to",
    "start": "272000",
    "end": "277120"
  },
  {
    "text": "ensure right order consistency This is important for applications that have multiple volumes",
    "start": "277120",
    "end": "286600"
  },
  {
    "text": "After taking the consistent group snapshot you can create a volume from the snapshot and get your application",
    "start": "288160",
    "end": "295479"
  },
  {
    "text": "back Note that if your application is a database you will still need to do crash",
    "start": "295479",
    "end": "300840"
  },
  {
    "text": "recovery Leonardo will give an example",
    "start": "300840",
    "end": "305520"
  },
  {
    "text": "later Volume group snapshot feature supports crash consistency Taking snapshots of all the",
    "start": "306759",
    "end": "314080"
  },
  {
    "text": "volumes at the same point in time also is more efficient than taking one",
    "start": "314080",
    "end": "319520"
  },
  {
    "text": "snapshot at a time It provides better",
    "start": "319520",
    "end": "324240"
  },
  {
    "text": "performance We started to design the volume group snapshot feature shortly after volume snapshot moved to GA in",
    "start": "325960",
    "end": "334240"
  },
  {
    "text": "1.20 release but it took a while before we finalized the design and we",
    "start": "334240",
    "end": "340560"
  },
  {
    "text": "introduced it as alpha feature in 1.29 release Then we moved it to beta in",
    "start": "340560",
    "end": "348759"
  },
  {
    "text": "1.32 This feature introduces three new APIs We have a volume group snapshot",
    "start": "348759",
    "end": "356639"
  },
  {
    "text": "class that is created by a admin to describe how volume group snapshots",
    "start": "356639",
    "end": "362320"
  },
  {
    "text": "should be created We have a volume group snapshot that represents a user's request to",
    "start": "362320",
    "end": "370240"
  },
  {
    "text": "create a volume group snapshot for multiple volumes We have a volume group snapshot content",
    "start": "370240",
    "end": "376560"
  },
  {
    "text": "that represents a physical volume group snapshot resource on the Sod system The",
    "start": "376560",
    "end": "383120"
  },
  {
    "text": "content is created by the snapshot controller in a dynamic provisioning and created by the admin for the",
    "start": "383120",
    "end": "390000"
  },
  {
    "text": "pre-provisioning case Leonardo will explain the two types of provisioning later",
    "start": "390000",
    "end": "398600"
  },
  {
    "text": "In a volume group snapshot class we had the CSI driver name The parameters that",
    "start": "399440",
    "end": "404919"
  },
  {
    "text": "contain information that is opaque to Kubernetes and is understood only by CSI",
    "start": "404919",
    "end": "412600"
  },
  {
    "text": "drivers It contains the deletion policy This works the same way as the detection",
    "start": "412600",
    "end": "418560"
  },
  {
    "text": "policy in a volume snapshot class It can be either delete or",
    "start": "418560",
    "end": "424680"
  },
  {
    "text": "retain Here's an example of a volume group snapshot class The deletion policy is",
    "start": "424680",
    "end": "431360"
  },
  {
    "text": "delete here Here is the volume group snapshot API In the spec you need to specify the",
    "start": "431360",
    "end": "439560"
  },
  {
    "text": "source The source can be either a label selector or a warning group snapshot",
    "start": "439560",
    "end": "445759"
  },
  {
    "text": "content name depending on the type of provisioning",
    "start": "445759",
    "end": "451520"
  },
  {
    "text": "Warning group snapshot class name may be left new to indicate that the default",
    "start": "451520",
    "end": "457120"
  },
  {
    "text": "class will be used After warning group snapshot is created you can see the bounding group",
    "start": "457120",
    "end": "463919"
  },
  {
    "text": "snapshot content name and the creation timestamp in the status You'll also see",
    "start": "463919",
    "end": "469599"
  },
  {
    "text": "the ready to use parameter in the status that indicates whether this volume group",
    "start": "469599",
    "end": "475520"
  },
  {
    "text": "snapshot is ready to be used to restore your PBCs",
    "start": "475520",
    "end": "481879"
  },
  {
    "text": "Here is an example See the label here You need to specify the label on all the",
    "start": "482800",
    "end": "488800"
  },
  {
    "text": "PVCs you want to be snapshotted",
    "start": "488800",
    "end": "493280"
  },
  {
    "text": "together In the volume group snapshot contents back you have the deletion",
    "start": "494599",
    "end": "499919"
  },
  {
    "text": "policy CSI driver name volume group snapshot class name and the source The",
    "start": "499919",
    "end": "505840"
  },
  {
    "text": "source can be either a list of volume handles for the volumes on the storage system or group snapshot handles which",
    "start": "505840",
    "end": "513599"
  },
  {
    "text": "includes the volume group snapshot handle and a list of individual snapshot",
    "start": "513599",
    "end": "519200"
  },
  {
    "text": "handles on the storage system The volume group snapshot and volume group snapshot",
    "start": "519200",
    "end": "525200"
  },
  {
    "text": "content have a one to one mapping to each other",
    "start": "525200",
    "end": "531320"
  },
  {
    "text": "In the volume group snapshot content example here we see volume handles in",
    "start": "533279",
    "end": "538399"
  },
  {
    "text": "the source In the status we see volume group snapshot handle and the list of",
    "start": "538399",
    "end": "543839"
  },
  {
    "text": "individual volume handle and snapshot handle",
    "start": "543839",
    "end": "549040"
  },
  {
    "text": "pairs To support this feature we also added volume group snapshot definition",
    "start": "549640",
    "end": "555040"
  },
  {
    "text": "in the CSI spec This feature in CSS back moved to GA in the CSS back 1.11 release",
    "start": "555040",
    "end": "564000"
  },
  {
    "text": "CSI spec does not have a beta phase We added a new group controller",
    "start": "564000",
    "end": "570240"
  },
  {
    "text": "service and a new capability We added three new RPCs Create delete get warning group",
    "start": "570240",
    "end": "578640"
  },
  {
    "text": "snapshot In order to support this feature in a",
    "start": "578640",
    "end": "584160"
  },
  {
    "text": "CSI driver a sort vendor will need to implement this new controller service and the new",
    "start": "584160",
    "end": "592240"
  },
  {
    "text": "RPCs In this diagram we show how CSI driver is deployed and how various",
    "start": "593800",
    "end": "600279"
  },
  {
    "text": "components that support volume group snapshots uh are working together We",
    "start": "600279",
    "end": "606240"
  },
  {
    "text": "added the volume group snapshot support through the snapshot controller and the CSI snapshot set car Snapshot controller",
    "start": "606240",
    "end": "614399"
  },
  {
    "text": "does the heavy lifting It creates the volume group snapshot content and uh in",
    "start": "614399",
    "end": "620880"
  },
  {
    "text": "the in case of dynamic provisioning and it is responsible for binding the volume",
    "start": "620880",
    "end": "626079"
  },
  {
    "text": "group snapshot and the volume group snapshot shot content The CSI snapshot or site car is",
    "start": "626079",
    "end": "633600"
  },
  {
    "text": "deployed together with the CSI driver It watches the volume group snapshot content API objects It calls CSI driver",
    "start": "633600",
    "end": "641760"
  },
  {
    "text": "to create or delete volume group snapshot on the storage system We introduce feature gate in both",
    "start": "641760",
    "end": "650079"
  },
  {
    "text": "snapshot controller and the CSI snapshot set car Since this is the beta API the",
    "start": "650079",
    "end": "655920"
  },
  {
    "text": "feature gate is disabled by default Now let me hand it over to",
    "start": "655920",
    "end": "661200"
  },
  {
    "text": "Leonardo He will explain how the two types of provisioning works",
    "start": "661200",
    "end": "667880"
  },
  {
    "text": "Okay So there are three main things you can do with volume group snapshots The",
    "start": "669440",
    "end": "675040"
  },
  {
    "text": "first one is called dynamic provisioning and it is the workflow you use when you need to take a backup and given a volume",
    "start": "675040",
    "end": "681920"
  },
  {
    "text": "group snapshot class you need to create a volume group snapshot object and the",
    "start": "681920",
    "end": "687680"
  },
  {
    "text": "system will provision everything for you So a volume group snapshot content a set of volume snapshots and a set of volume",
    "start": "687680",
    "end": "694160"
  },
  {
    "text": "snapshot contents Isn't it beautiful it's magic From just one object you're going to get everything The second",
    "start": "694160",
    "end": "700800"
  },
  {
    "text": "workflow is called pre-provisioning And this is what you use when you want a Kubernetes cluster to take control of an",
    "start": "700800",
    "end": "708000"
  },
  {
    "text": "existing group snapshot existing already in your storage For that workflow to",
    "start": "708000",
    "end": "713040"
  },
  {
    "text": "work you need to create all the object yourself So the volume group snapshot content the volume group snapshot the",
    "start": "713040",
    "end": "719760"
  },
  {
    "text": "volume snapshot contents and the volume snapshots Then the third and most the",
    "start": "719760",
    "end": "725760"
  },
  {
    "text": "most important workflow is the restore And this is really easy to do because it's just designed to be used as you",
    "start": "725760",
    "end": "732959"
  },
  {
    "text": "would use a plain volume snapshot We see that",
    "start": "732959",
    "end": "737519"
  },
  {
    "text": "later And from now on we are going to explain how the dynamic provisioning works And you know since uh I am an",
    "start": "738120",
    "end": "746079"
  },
  {
    "text": "Italian guy and I love classical music at opera I will use an opera metaphor So we split this process in four acts and",
    "start": "746079",
    "end": "753440"
  },
  {
    "text": "each act as scenes and this is an opera for four personas You have a kubernetes",
    "start": "753440",
    "end": "758959"
  },
  {
    "text": "administrator you have a CSI driver you have the snapshot sidecar and the common",
    "start": "758959",
    "end": "764399"
  },
  {
    "text": "snapshot controller So let's start from act one",
    "start": "764399",
    "end": "770320"
  },
  {
    "text": "So what happens now you are a Kubernetes administrator working on your desk Everything is good Everything is fine",
    "start": "770320",
    "end": "776399"
  },
  {
    "text": "And suddenly a developer enters asking you for a database Do you really need it yes I do",
    "start": "776399",
    "end": "783200"
  },
  {
    "text": "Uh but it's just temporary data Don't worry You can destroy everything when you want and recreate it",
    "start": "783200",
    "end": "790600"
  },
  {
    "text": "back I don't trust temporary data Let's create some storage for it And I know",
    "start": "790600",
    "end": "796880"
  },
  {
    "text": "that is always best to have the transaction log in a separate volume So",
    "start": "796880",
    "end": "802399"
  },
  {
    "text": "I'm going to create two PVCs One is for data This example use CMPG because it's",
    "start": "802399",
    "end": "807839"
  },
  {
    "text": "the operator I'm most familiar with but concepts are generic The second one is",
    "start": "807839",
    "end": "813680"
  },
  {
    "text": "for the transaction loged in posgress This is named wall right ahead log The",
    "start": "813680",
    "end": "819680"
  },
  {
    "text": "most important bit here is the common label between the persistent volume frame of data and the other one of the",
    "start": "819680",
    "end": "826720"
  },
  {
    "text": "walls is named in this example instance name Then I configure immediately a",
    "start": "826720",
    "end": "833040"
  },
  {
    "text": "volume group snapshot class because it's better to feel safe than worry you know I'm going to back up everything and if",
    "start": "833040",
    "end": "840480"
  },
  {
    "text": "it is temporary okay act",
    "start": "840480",
    "end": "845560"
  },
  {
    "text": "two and now we are inside the cube controller manager you know everything is good someone created a chrome job and",
    "start": "845560",
    "end": "854000"
  },
  {
    "text": "the chrome job starts handling a yl definition of a job to the job",
    "start": "854000",
    "end": "859120"
  },
  {
    "text": "controller the job controller is one always complains because he want to be used by in isolation and everyone use",
    "start": "859120",
    "end": "866240"
  },
  {
    "text": "just the chrome jobs But anyway let's work I'm going to create a pod for you",
    "start": "866240",
    "end": "871360"
  },
  {
    "text": "It's fine And this pod is triggering your database operator to take a",
    "start": "871360",
    "end": "877480"
  },
  {
    "text": "backup And the database operator it is a quiet place That's back going on Back is",
    "start": "877480",
    "end": "884600"
  },
  {
    "text": "perfection Beautiful What is doing the database operator is creating a volume",
    "start": "884600",
    "end": "889680"
  },
  {
    "text": "group snapshot object and look at that we have the labels the instance name label we have seen beforeh isn't it",
    "start": "889680",
    "end": "896560"
  },
  {
    "text": "beautiful and we have the reference for the volume group snapshot class name this comes from act",
    "start": "896560",
    "end": "903959"
  },
  {
    "text": "one okay we have a new object the snapshot controller is waking up oh look",
    "start": "903959",
    "end": "910240"
  },
  {
    "text": "I have a new object let's create a content for it I'm going to get all the details about the volumes you need to",
    "start": "910240",
    "end": "916079"
  },
  {
    "text": "snapshot So I feel the volume handles everything beautiful",
    "start": "916079",
    "end": "922199"
  },
  {
    "text": "Okay And now we are inside the pod of the CSI driver And there's the snapshot",
    "start": "922199",
    "end": "927760"
  },
  {
    "text": "sidecar Realizing that there is a new volume group snapshot content object Okay But I",
    "start": "927760",
    "end": "935040"
  },
  {
    "text": "don't know how to take group snapshot by myself I need to ask my CSI driver",
    "start": "935040",
    "end": "940160"
  },
  {
    "text": "friend which is sitting next to me And so I scream in a gRPC format a create",
    "start": "940160",
    "end": "946000"
  },
  {
    "text": "group snapshot request But that poor guy is sitting just next to me Look I heard you Okay these are the UID I'm going to",
    "start": "946000",
    "end": "953440"
  },
  {
    "text": "do your work Good Okay let's take a group snapshots These are the UIDs of",
    "start": "953440",
    "end": "959040"
  },
  {
    "text": "the snapshot you requested me And this is the UID of the group snapshot And you know why group",
    "start": "959040",
    "end": "965279"
  },
  {
    "text": "snapshots are so fast it's because the snapshot is continuous screaming at that poor guy sitting next to him until it is",
    "start": "965279",
    "end": "973240"
  },
  {
    "text": "ready Oh good Okay let's do that So I'm going to",
    "start": "973240",
    "end": "978480"
  },
  {
    "text": "fill all the details It's everything there these magic numbers all the",
    "start": "978480",
    "end": "985160"
  },
  {
    "text": "UIDs and it is ready to use immediately Beautiful In this",
    "start": "985160",
    "end": "990680"
  },
  {
    "text": "example the snapshot controller wakes up again because the object changed So I now have a volume group",
    "start": "990680",
    "end": "998079"
  },
  {
    "text": "snapshot object I have a volume group snapshot content objects I need to",
    "start": "998079",
    "end": "1003120"
  },
  {
    "text": "create a set of volume snapshots and a set of volume snapshot contents because",
    "start": "1003120",
    "end": "1009199"
  },
  {
    "text": "this is what you need when you need to rehydrate your PVC I do that just using the data uh they",
    "start": "1009199",
    "end": "1017199"
  },
  {
    "text": "were sent to me in the step before and I'm going to create everything This is how the magic works",
    "start": "1017199",
    "end": "1024400"
  },
  {
    "text": "But you know again since I created new objects the snapshot sidecard wakes it",
    "start": "1024400",
    "end": "1030640"
  },
  {
    "text": "up Oh there's new object Let's ask the poor CSI driver the status of this",
    "start": "1030640",
    "end": "1035678"
  },
  {
    "text": "object I already told you they are ready Okay let's do I'm going to feel the status Good I have the status now They",
    "start": "1035679",
    "end": "1043600"
  },
  {
    "text": "are ready to use They have a volume group snapshot handle This classifies them as a member",
    "start": "1043600",
    "end": "1050320"
  },
  {
    "text": "of a group snapshot not just an individual snapshots Act",
    "start": "1050320",
    "end": "1058039"
  },
  {
    "text": "three Okay we go back to our office Everything is good and you know the",
    "start": "1058039",
    "end": "1064000"
  },
  {
    "text": "developer comes asking for a restore It's always happening But it was temporary data Yeah but you know it's",
    "start": "1064000",
    "end": "1070799"
  },
  {
    "text": "taking so long to recreate from scratch Can you restore as it was 2 days ago",
    "start": "1070799",
    "end": "1076640"
  },
  {
    "text": "okay Okay let's do it Okay it is enough to recreate a",
    "start": "1076640",
    "end": "1082640"
  },
  {
    "text": "system volume claim and use the data source stats inside the specification referring to the volume",
    "start": "1082640",
    "end": "1089440"
  },
  {
    "text": "snapshot objects that were created a few steps before This is just like you would",
    "start": "1089440",
    "end": "1095679"
  },
  {
    "text": "use a plain volume snapshot",
    "start": "1095679",
    "end": "1100519"
  },
  {
    "text": "We want restore to be easy because when you need to restore something we usually are having troubles It's better to avoid",
    "start": "1101120",
    "end": "1107200"
  },
  {
    "text": "complexity This is so important This is why works that way Act",
    "start": "1107200",
    "end": "1114639"
  },
  {
    "text": "four The world is quiet and beautiful And we finished And that's it So this is how",
    "start": "1115960",
    "end": "1123360"
  },
  {
    "text": "dynamic provisioning works And as you can see it is teamwork It not",
    "start": "1123360",
    "end": "1130320"
  },
  {
    "text": "it is not just one software component doing the magic It's collaboration So the most important here is the",
    "start": "1130320",
    "end": "1137280"
  },
  {
    "text": "communication between all these software components This is more important than the actual implementation",
    "start": "1137280",
    "end": "1144919"
  },
  {
    "text": "And if something doesn't work okay we need to know that this is a beta fisher",
    "start": "1146640",
    "end": "1152000"
  },
  {
    "text": "now and we need to check the fishes gate to be enabled There are feature gates in",
    "start": "1152000",
    "end": "1157600"
  },
  {
    "text": "the common snapshot controllers there are there is a fissure gate in the CSI snapshot cycle and then we need",
    "start": "1157600",
    "end": "1164799"
  },
  {
    "text": "obviously the CRD to be installed and we need to check that the PVCs need can be",
    "start": "1164799",
    "end": "1171200"
  },
  {
    "text": "really snapshot together at the same time at least they need to be provisioned by the same CSI driver and",
    "start": "1171200",
    "end": "1177919"
  },
  {
    "text": "that CMS CSI driver is the one that should be referred to in the volume group snapshot",
    "start": "1177919",
    "end": "1183720"
  },
  {
    "text": "class okay I checked everything but it still doesn't work well so You know the history You",
    "start": "1183720",
    "end": "1190640"
  },
  {
    "text": "know which actor is supposed to play Now the logs are your friend and you need to check which step you stopped and what",
    "start": "1190640",
    "end": "1199799"
  },
  {
    "text": "happened and then we need to iron out some bugs But anyway uh",
    "start": "1199799",
    "end": "1206520"
  },
  {
    "text": "okay so you know I'm a posgress person so I need to share a few words about posgress but this is true for many",
    "start": "1206520",
    "end": "1213840"
  },
  {
    "text": "software systems working like a DBMS So you get basically two data store at the",
    "start": "1213840",
    "end": "1219200"
  },
  {
    "text": "price of one The one on the right is called the transaction log and every time you change something uh someone is",
    "start": "1219200",
    "end": "1226720"
  },
  {
    "text": "adding a note there and when you commit this is flushed down to permanent storage and periodically the system will",
    "start": "1226720",
    "end": "1234240"
  },
  {
    "text": "perform a checkpoint Checkpoint means it's going to flush down all the hash to your data store which is the one on the",
    "start": "1234240",
    "end": "1240880"
  },
  {
    "text": "left and can be split in multiple volumes like in this example So to behap a system like that you need",
    "start": "1240880",
    "end": "1248240"
  },
  {
    "text": "collaboration between the primitives just like volume snapshots in this example and the database",
    "start": "1248240",
    "end": "1255159"
  },
  {
    "text": "operator So someone need to start the PG backup uh PG backup start function which",
    "start": "1255159",
    "end": "1261520"
  },
  {
    "text": "is going to turn a few knobs inside the DBMS and immediately perform a",
    "start": "1261520",
    "end": "1266919"
  },
  {
    "text": "checkpoint The system is consistent at that point and then you can take your snapshots When you did that you need to",
    "start": "1266919",
    "end": "1274080"
  },
  {
    "text": "run pg backup and this stops the backup process When you need to restore this",
    "start": "1274080",
    "end": "1279200"
  },
  {
    "text": "situation it is inconsistent because snapshots are taken at different point in time The database will just look for the",
    "start": "1279200",
    "end": "1286720"
  },
  {
    "text": "checkpoint immediately before the first snapshot So the one where PG backup",
    "start": "1286720",
    "end": "1291760"
  },
  {
    "text": "start was performed and then apply back all the transaction log until it is consistent This is going to take a bit",
    "start": "1291760",
    "end": "1298960"
  },
  {
    "text": "of time because they they are not consistent Meanwhile with group",
    "start": "1298960",
    "end": "1304440"
  },
  {
    "text": "snapshots this is easier because everything is consistent and it's going to be really quicker This is why group",
    "start": "1304440",
    "end": "1311280"
  },
  {
    "text": "snapshots are really loved by database people like me It's such a great feature for",
    "start": "1311280",
    "end": "1316760"
  },
  {
    "text": "us So let's do a little sacrifice for the demo gods",
    "start": "1316760",
    "end": "1323080"
  },
  {
    "text": "And uh uh uh uh uh uh uh I hope it is big",
    "start": "1323080",
    "end": "1331000"
  },
  {
    "text": "enough Can you see it is it big enough good Good Okay So this is a cluster",
    "start": "1331000",
    "end": "1338559"
  },
  {
    "text": "object I'm using CMPG but everything is generic here I just created a cluster object",
    "start": "1338559",
    "end": "1344960"
  },
  {
    "text": "with just one instance That means you are going to get just one port But this",
    "start": "1344960",
    "end": "1350480"
  },
  {
    "text": "database is split across multiple volumes You want it bigger That's",
    "start": "1350480",
    "end": "1358280"
  },
  {
    "text": "good Huh better now You multiple volumes there There are boot seven Yeah",
    "start": "1358280",
    "end": "1367720"
  },
  {
    "text": "Okay To back up this system I'm running the CMPG backup command It is no magic",
    "start": "1367720",
    "end": "1373840"
  },
  {
    "text": "Absolutely It's just creating a backup resource that is triggering the database operator And you know what wow this is",
    "start": "1373840",
    "end": "1381600"
  },
  {
    "text": "nice It's going to trigger even an update of item Whoops Okay it's fine",
    "start": "1381600",
    "end": "1388000"
  },
  {
    "text": "Anyway our backup started finished and completed This is what happens when you",
    "start": "1388000",
    "end": "1394240"
  },
  {
    "text": "turn on your Wi-Fi Um okay How did it do that it just created",
    "start": "1394240",
    "end": "1399679"
  },
  {
    "text": "a volume group snapshot object which is ready to use Look at the definition of this The most",
    "start": "1399679",
    "end": "1407760"
  },
  {
    "text": "important bit is this selector Okay And then you get",
    "start": "1407760",
    "end": "1412960"
  },
  {
    "text": "everything else because CNPG is annotating it with the database status But this is something for CMPG Then you",
    "start": "1412960",
    "end": "1420960"
  },
  {
    "text": "are going to get a volume group snapshot content object as we were saying before which is ready to",
    "start": "1420960",
    "end": "1427640"
  },
  {
    "text": "use And then you are going to get asset Oh this is the definition of the volume",
    "start": "1427640",
    "end": "1433600"
  },
  {
    "text": "group snapshot content with all the mapping between the UID of the volume and the UID of the",
    "start": "1433600",
    "end": "1440600"
  },
  {
    "text": "snapshot And then we get poof Okay a list of volume snapshots",
    "start": "1440600",
    "end": "1448480"
  },
  {
    "text": "one per PVC This is nice So you get a reference of the name of the PVC that was not",
    "start": "1448480",
    "end": "1456679"
  },
  {
    "text": "snapshot and a list of volume snapshot contents Here it",
    "start": "1456679",
    "end": "1462600"
  },
  {
    "text": "is So it's really easy to use them and it's",
    "start": "1462600",
    "end": "1467640"
  },
  {
    "text": "teamwork So great Uh I'm going to start",
    "start": "1467640",
    "end": "1473919"
  },
  {
    "text": "my presentation again Poof poof There we",
    "start": "1473919",
    "end": "1480039"
  },
  {
    "text": "go Back to Shing",
    "start": "1480039",
    "end": "1484440"
  },
  {
    "text": "Thanks Leonardo Now that the feature is beta we have been working on fixing bugs",
    "start": "1488640",
    "end": "1494240"
  },
  {
    "text": "and trying to bring this feature to GA We'd like to see implementation from",
    "start": "1494240",
    "end": "1500320"
  },
  {
    "text": "more storage vendors and we'd like to see integration for more Kubernetes",
    "start": "1500320",
    "end": "1506200"
  },
  {
    "text": "applications like the backup restore use case that Leonardo described for the",
    "start": "1506200",
    "end": "1511360"
  },
  {
    "text": "postgress SQL operator",
    "start": "1511360",
    "end": "1515559"
  },
  {
    "text": "Here are some resources for your reference That's all we have Thank you",
    "start": "1516640",
    "end": "1523800"
  },
  {
    "text": "[Applause]",
    "start": "1523800",
    "end": "1533140"
  },
  {
    "text": "Yeah I have a question about the demo Like in the demo you showed a volume that was 2 GB",
    "start": "1538080",
    "end": "1545520"
  },
  {
    "text": "uh how it works for how quick it works if we have some larger volumes attached",
    "start": "1545520",
    "end": "1552559"
  },
  {
    "text": "Okay Uh the answer is it depends on how your storage is implemented This is just",
    "start": "1552559",
    "end": "1557679"
  },
  {
    "text": "an infrastructure So yeah sorry I don't have a clear answer for you Check your",
    "start": "1557679",
    "end": "1563120"
  },
  {
    "text": "CSI driver You will find a lot of documentation about this works internally It may be immediate or it may",
    "start": "1563120",
    "end": "1570159"
  },
  {
    "text": "take some time depending on if your CSI driver implements secondary storage or not too",
    "start": "1570159",
    "end": "1577440"
  },
  {
    "text": "Yeah definitely depends on how how your storage works Okay Okay Thank you",
    "start": "1577440",
    "end": "1585679"
  },
  {
    "text": "Um hello Uh I have a question about the demo also about the restore with CNPG Uh",
    "start": "1585679",
    "end": "1592240"
  },
  {
    "text": "because in the CNPG documentation you need to delete the cluster and recreate from a backup Uh does it mean that with",
    "start": "1592240",
    "end": "1599120"
  },
  {
    "text": "volume group you need just to restore the volume group right and without touching the cluster object yes When the",
    "start": "1599120",
    "end": "1608000"
  },
  {
    "text": "volume group snapshot feature will be merged inside CPG you will just be able to reference the volume group snapshot",
    "start": "1608000",
    "end": "1614880"
  },
  {
    "text": "object and then you are done Okay So it's not available yet right but if you",
    "start": "1614880",
    "end": "1621279"
  },
  {
    "text": "need to change yeah it will be merged I hope for the next release Okay thank you",
    "start": "1621279",
    "end": "1629200"
  },
  {
    "text": "Okay thanks for the presentation I I want if I can I would like to answer the",
    "start": "1629200",
    "end": "1634799"
  },
  {
    "text": "also the question before about the recovery time Mhm because I I did a I",
    "start": "1634799",
    "end": "1639919"
  },
  {
    "text": "did a presentation in CubeCon in I think Chicago a year and a half ago where with",
    "start": "1639919",
    "end": "1646039"
  },
  {
    "text": "Michelle from Google we showed how to restore a posgus database of 4.5",
    "start": "1646039",
    "end": "1651400"
  },
  {
    "text": "terabytes in uh two minutes as Leonardo explained volume snapshots are still at",
    "start": "1651400",
    "end": "1658240"
  },
  {
    "text": "the the foundation on this but I would like to ask you uh if you can briefly",
    "start": "1658240",
    "end": "1664000"
  },
  {
    "text": "cover uh the differences between snapshoting in VMs and the benefits that Kubernetes",
    "start": "1664000",
    "end": "1672080"
  },
  {
    "text": "has brought to this technology that is unprecedented I mean",
    "start": "1672080",
    "end": "1678960"
  },
  {
    "text": "okay so uh you're talking okay the VMs right so yeah VMs or outside Kubernetes",
    "start": "1678960",
    "end": "1685520"
  },
  {
    "text": "I mean the advantage of Kubernetes right so uh with this feature if your VMs using multiple volumes you can take a",
    "start": "1685520",
    "end": "1692720"
  },
  {
    "text": "you know group group snapshot you can that will be very helpful for your VMs",
    "start": "1692720",
    "end": "1697840"
  },
  {
    "text": "right because your VMs typically have multiple volumes yeah and to add a bit of something This",
    "start": "1697840",
    "end": "1706159"
  },
  {
    "text": "is a foundation work that is common to every storage implementation So you just",
    "start": "1706159",
    "end": "1711279"
  },
  {
    "text": "have an an API and with using that API you are independent on the actual implementation",
    "start": "1711279",
    "end": "1718919"
  },
  {
    "text": "Yeah Sorry I probably rephrased it wrong but mine was uh I've seen from a from a",
    "start": "1718919",
    "end": "1728080"
  },
  {
    "text": "user's point of view the advantages of having a standard interface that",
    "start": "1728080",
    "end": "1733520"
  },
  {
    "text": "Kubernetes brings when taking volumes snapshots that it's not available in in",
    "start": "1733520",
    "end": "1738960"
  },
  {
    "text": "VMs where every vendor has their own Sorry I should So you if your VMs have",
    "start": "1738960",
    "end": "1744000"
  },
  {
    "text": "all the data stored in the PVC you can use this Yeah you can use this uh feature to take a group snapshots Okay",
    "start": "1744000",
    "end": "1752799"
  },
  {
    "text": "Yeah Thank you Thank you for presentation I have a",
    "start": "1752799",
    "end": "1758559"
  },
  {
    "text": "question Uh in your selector using only host name is it possible to use a different u attributes in a selector",
    "start": "1758559",
    "end": "1767000"
  },
  {
    "text": "absolutely Absolutely It's just a plain selector Okay So this is foundation work",
    "start": "1767000",
    "end": "1772480"
  },
  {
    "text": "It's not about a particular implementation It's for everyone to use So potentially we can make like",
    "start": "1772480",
    "end": "1778640"
  },
  {
    "text": "multiport uh snapshot Absolutely Okay Thank you",
    "start": "1778640",
    "end": "1786760"
  },
  {
    "text": "One clarification question Are you calling this CSI provider with a list",
    "start": "1786880",
    "end": "1792000"
  },
  {
    "text": "and delegating consistency to them or are you are you taking responsibility for consistency and handling calling",
    "start": "1792000",
    "end": "1798799"
  },
  {
    "text": "them parallel so CSI driver needs to implement this one and need to call their vendor",
    "start": "1798799",
    "end": "1805760"
  },
  {
    "text": "specific APIs right if they support consistent group then they can use this",
    "start": "1805760",
    "end": "1811440"
  },
  {
    "text": "they can implement this but if they do not have that yet then it's not going to work right so this depends on whether a",
    "start": "1811440",
    "end": "1818559"
  },
  {
    "text": "vendor supports this technology or not on their need you need adoption from each vendor that's providing a CSI",
    "start": "1818559",
    "end": "1824559"
  },
  {
    "text": "driver to handle yes consistency and they can implement that however they want in the back end Yes they can Yeah",
    "start": "1824559",
    "end": "1830320"
  },
  {
    "text": "they can implement this one if they have that feature in their storage system Yeah Do you know out of the major",
    "start": "1830320",
    "end": "1836960"
  },
  {
    "text": "vendors who supports it yet so right now uh it's it's a bit early Uh last time",
    "start": "1836960",
    "end": "1842960"
  },
  {
    "text": "when we asked there are like a couple of companies saying they they have implement this So that's why I'm calling",
    "start": "1842960",
    "end": "1850159"
  },
  {
    "text": "for implementation for most vendors Okay Thank you",
    "start": "1850159",
    "end": "1856720"
  },
  {
    "text": "any tentative timelines uh when this feature will become GA",
    "start": "1856720",
    "end": "1862080"
  },
  {
    "text": "Uh so we just moved to beta in 1.32 So right now we are fixing some issues",
    "start": "1862080",
    "end": "1869440"
  },
  {
    "text": "Probably need some soak time Um this is just tentative right maybe 1.35 release",
    "start": "1869440",
    "end": "1876240"
  },
  {
    "text": "So we'll see Thanks",
    "start": "1876240",
    "end": "1881480"
  },
  {
    "text": "Hello Bonjouro Uh I would like to ask uh",
    "start": "1882159",
    "end": "1887919"
  },
  {
    "text": "when you take the snapshot and uh uh the snapshot operator cooperate with",
    "start": "1887919",
    "end": "1895600"
  },
  {
    "text": "the CMPG uh operator uh of and you have to issue",
    "start": "1895600",
    "end": "1901840"
  },
  {
    "text": "the PG start backup combat it has to flash the wall to the disk to be able to",
    "start": "1901840",
    "end": "1907360"
  },
  {
    "text": "take a consistent snapshot How does this affect a affect performance and if this affect",
    "start": "1907360",
    "end": "1914720"
  },
  {
    "text": "performance because I imagine that I wonder that in that case uh right will",
    "start": "1914720",
    "end": "1921440"
  },
  {
    "text": "be locked for a moment to the database Yeah So this is actually posgress specific and not about but yeah okay uh",
    "start": "1921440",
    "end": "1930159"
  },
  {
    "text": "with posgress you can spread your checkpoints across time to avoid the spike of a workload just when you",
    "start": "1930159",
    "end": "1937360"
  },
  {
    "text": "perform a checkpoint So it depends on how you configure your engine but you can",
    "start": "1937360",
    "end": "1943440"
  },
  {
    "text": "definitely avoid that spike at least a good part of it Okay thank you",
    "start": "1943440",
    "end": "1951080"
  },
  {
    "text": "Oh so sorry I I just need one more minute or two minutes of your time I",
    "start": "1951600",
    "end": "1956960"
  },
  {
    "text": "would like to thank Shink for all the help she gave me when I started contributing to the Kubernetes CSI",
    "start": "1956960",
    "end": "1963039"
  },
  {
    "text": "ecosystem She set an example both at the technical level and the personal side as",
    "start": "1963039",
    "end": "1968240"
  },
  {
    "text": "could to be a really good leader on the tech storage initiative A big round of applause for",
    "start": "1968240",
    "end": "1973690"
  },
  {
    "text": "[Applause]",
    "start": "1973690",
    "end": "1976949"
  },
  {
    "text": "her Thanks Leonardo uh you have been contributing a lot to this feature and also there are many other community",
    "start": "1978919",
    "end": "1985679"
  },
  {
    "text": "members who are contributing to this feature They are not in this presentation but I want to thank all of",
    "start": "1985679",
    "end": "1990880"
  },
  {
    "text": "them for contributing [Applause]",
    "start": "1990880",
    "end": "1999150"
  }
]