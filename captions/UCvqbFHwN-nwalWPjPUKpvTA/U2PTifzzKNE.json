[
  {
    "text": "hello everyone welcome to this session of the community track my name is",
    "start": "120",
    "end": "7319"
  },
  {
    "text": "Leticia D I'm a software engineer with planet-scale and I'm also one of the maintainer zuv wit s which is a CNC F",
    "start": "7319",
    "end": "14610"
  },
  {
    "text": "open source project our next talk is going to be on a kubernetes application",
    "start": "14610",
    "end": "21779"
  },
  {
    "text": "end to end del stats and let me introduce our speakers this is Lukas",
    "start": "21779",
    "end": "29220"
  },
  {
    "text": "Greg latch key of CN CF he's a senior",
    "start": "29220",
    "end": "35489"
  },
  {
    "text": "software developer with CNC F and the primary developer on dev stats and we",
    "start": "35489",
    "end": "41070"
  },
  {
    "text": "also have Josh burkas who's the kubernetes community manager at Red Hat and he is active in the release and",
    "start": "41070",
    "end": "50719"
  },
  {
    "text": "introverts contributed experience six for kubernetes okay well thank you well",
    "start": "50719",
    "end": "59460"
  },
  {
    "text": "welcome we've already been introduced so you don't need that but let me talk a",
    "start": "59460",
    "end": "65909"
  },
  {
    "text": "little bit about why we're here so a while ago now we've actually had an",
    "start": "65909",
    "end": "74340"
  },
  {
    "text": "issue open for a long time - better kubernetes eye dev stats but",
    "start": "74340",
    "end": "80280"
  },
  {
    "text": "then a while ago is actually looking I was teaching some new people how to use kubernetes properly and I was like hey",
    "start": "80280",
    "end": "87049"
  },
  {
    "text": "let me give you a good let me find a good example for you of a production application in kubernetes right what",
    "start": "87049",
    "end": "94500"
  },
  {
    "text": "that would look like right something that's got deployment information and configuration and it's",
    "start": "94500",
    "end": "100020"
  },
  {
    "text": "set up to use some kind of CI CD and has like a database and a UI and connection",
    "start": "100020",
    "end": "105420"
  },
  {
    "text": "routing and maybe some other things like jobs and config maps etc and some way to deploy it right all these things and I",
    "start": "105420",
    "end": "112560"
  },
  {
    "text": "looked and I looked and it's Google searches and I looked in all of the",
    "start": "112560",
    "end": "117630"
  },
  {
    "text": "kubernetes and CN CF stuff and I looked in people's medium blogs and what I found was guestbook how many people",
    "start": "117630",
    "end": "125579"
  },
  {
    "text": "interview is the guestbook sample app right off of the cou Bernays sample UPS right great so this has got it's got a",
    "start": "125579",
    "end": "131069"
  },
  {
    "text": "couple replica sets it has secret and it has a couple services and",
    "start": "131069",
    "end": "137530"
  },
  {
    "text": "that's pretty much it doesn't have ingress doesn't the database is non-persistent",
    "start": "137530",
    "end": "142570"
  },
  {
    "text": "there's no operator or helm or any other way that you would actually deploy this as an app there aren't any jobs cron",
    "start": "142570",
    "end": "149740"
  },
  {
    "text": "jobs is no CIC D it's not current for 113 which is when we started working on",
    "start": "149740",
    "end": "155470"
  },
  {
    "text": "this certainly not current for one 14 or 15 now nothing is SSL",
    "start": "155470",
    "end": "160750"
  },
  {
    "text": "it's definitely miles away from being an example production application designed",
    "start": "160750",
    "end": "167110"
  },
  {
    "text": "to be as simple as possible so when we actually started work on making dev",
    "start": "167110",
    "end": "173920"
  },
  {
    "text": "stats completely a kubernetes application we're like let's not just make this a kubernetes application let's make this an example kubernetes",
    "start": "173920",
    "end": "180340"
  },
  {
    "text": "application because it's open source from top to bottom so we don't have any limitations for what we can put out",
    "start": "180340",
    "end": "186070"
  },
  {
    "text": "there and github for people to look at so before we actually go into the",
    "start": "186070",
    "end": "191200"
  },
  {
    "text": "details of what that looks like what's actually explaining with dev stats is so you'll understand what the parts of this",
    "start": "191200",
    "end": "197290"
  },
  {
    "text": "application do that's not the best stats",
    "start": "197290",
    "end": "204610"
  },
  {
    "text": "is a C&C have created tool that is that's main reason for it is to analyze",
    "start": "204610",
    "end": "210600"
  },
  {
    "text": "contributions and development process across the cnc of projects so it uses",
    "start": "210600",
    "end": "216510"
  },
  {
    "text": "three different data sources one of them is github are chips which are which are",
    "start": "216510",
    "end": "223570"
  },
  {
    "text": "just our way of store our github activity using bigquery and using",
    "start": "223570",
    "end": "229270"
  },
  {
    "text": "al-kitab al-kitab events we also use git for a storage to analyze files in git",
    "start": "229270",
    "end": "236140"
  },
  {
    "text": "and finally we use github API to to see if our data is correct it uses graph",
    "start": "236140",
    "end": "243040"
  },
  {
    "text": "Anna is a UI and also well you can just",
    "start": "243040",
    "end": "248230"
  },
  {
    "text": "take a look at great it's like yeah so I mean it's basically it's here this is the thing that I and some of the other",
    "start": "248230",
    "end": "253240"
  },
  {
    "text": "community managers use all the time to find out how the kubernetes community is doing it's also available for other",
    "start": "253240",
    "end": "259239"
  },
  {
    "text": "communities and so we have a whole large set of different dashboards for community information like for example an important one to us is one called",
    "start": "259239",
    "end": "266860"
  },
  {
    "text": "peer time to engage which is that if somebody submits a brand-new PR how long does it take to",
    "start": "266860",
    "end": "272080"
  },
  {
    "text": "get the first response from a human how long does it take before it actually gets reviewed and how long does it take until it gets merged or rejected right",
    "start": "272080",
    "end": "278740"
  },
  {
    "text": "because if that starts going if that amount of time starts going up then we have a problem so and lots and lots of",
    "start": "278740",
    "end": "287200"
  },
  {
    "text": "other charts like that and so across the",
    "start": "287200",
    "end": "293470"
  },
  {
    "text": "two years old def starts a project it initially was created to track CN CF",
    "start": "293470",
    "end": "299950"
  },
  {
    "text": "project but after some time some other foundations also joined some like for",
    "start": "299950",
    "end": "305650"
  },
  {
    "text": "example continuous delivery and so on and every single foundation can have its",
    "start": "305650",
    "end": "312400"
  },
  {
    "text": "own deaths as instance and in half it can have multiple projects tracking",
    "start": "312400",
    "end": "318040"
  },
  {
    "text": "across multiple get reports on things like that so so we get into that so so",
    "start": "318040",
    "end": "327760"
  },
  {
    "text": "then so we had but basically you know so then we went through an experience that I think a lot of you either have gone",
    "start": "327760",
    "end": "334030"
  },
  {
    "text": "through or going through how many people here are looking at moving a monolithic application to a bunch of kubernetes",
    "start": "334030",
    "end": "340930"
  },
  {
    "text": "micro services and how many people have already done it yeah so this is a",
    "start": "340930",
    "end": "347050"
  },
  {
    "text": "familiar experience right and again with the opportunity here to do this in sort of an example way right so our old set",
    "start": "347050",
    "end": "353980"
  },
  {
    "text": "up was a couple packet servers so our own set up that is currently still",
    "start": "353980",
    "end": "359440"
  },
  {
    "text": "running it's using two powerful packet net servers which are quite quite",
    "start": "359440",
    "end": "364480"
  },
  {
    "text": "powerful as I said so there's 38 core processors there are 20 20 200 gigabytes",
    "start": "364480",
    "end": "371350"
  },
  {
    "text": "of memory there are six mirror SSDs disks and so on so on we are using",
    "start": "371350",
    "end": "376600"
  },
  {
    "text": "Apache proxy we are using let's at Crypt and basically it's starting to became a",
    "start": "376600",
    "end": "382180"
  },
  {
    "text": "problem because we need to update all these tools when for example new version",
    "start": "382180",
    "end": "387580"
  },
  {
    "text": "of Ubuntu comes then we need to just install everything from scratch so yeah and so then a few weeks ago a friend of",
    "start": "387580",
    "end": "396850"
  },
  {
    "text": "mine Michael Rogers who I know from the calculated A's our ping mean was like hey we actually want to run dev stats for",
    "start": "396850",
    "end": "403029"
  },
  {
    "text": "our open source projects how do I install it and my answer for that is well that's kind of complicated right",
    "start": "403029",
    "end": "410439"
  },
  {
    "text": "now and it would be really nice to make it a little bit less complicated on top of",
    "start": "410439",
    "end": "416829"
  },
  {
    "text": "which yeah so we created this example for purpose of this cube don't talk but",
    "start": "416829",
    "end": "422709"
  },
  {
    "text": "do during doing so another foundation graph QL wanted their own deficit",
    "start": "422709",
    "end": "428289"
  },
  {
    "text": "instance and basically while developing instance for this talk",
    "start": "428289",
    "end": "433599"
  },
  {
    "text": "we used exactly the same approach and actually it's already running in production on kubernetes here's the",
    "start": "433599",
    "end": "446109"
  },
  {
    "text": "graph QL and also in the meantime many other projects asked us for creating",
    "start": "446109",
    "end": "451839"
  },
  {
    "text": "their own deficit since our for instance a cube flow HDL and Linux Foundation is",
    "start": "451839",
    "end": "457989"
  },
  {
    "text": "also considering running this internally as a data source so it's it's a lot of",
    "start": "457989",
    "end": "463389"
  },
  {
    "text": "other projects that need to be ported yeah and then of course we do work",
    "start": "463389",
    "end": "471339"
  },
  {
    "text": "either with or for the CNC F and so you know kind of was kind of need to be not",
    "start": "471339",
    "end": "478629"
  },
  {
    "text": "running a model with the gap you know we need to run this on kubernetes anyway it was built before that was really",
    "start": "478629",
    "end": "485319"
  },
  {
    "text": "reasonable thing to do but now need to actually do that so there were a few",
    "start": "485319",
    "end": "491469"
  },
  {
    "text": "steps involved yeah so basically we needed to the biggest problem to solve",
    "start": "491469",
    "end": "498099"
  },
  {
    "text": "was how to store our data so we needed to switch from local storage to some",
    "start": "498099",
    "end": "504309"
  },
  {
    "text": "cloud provider in our case we chose AWS just just for this example but we're",
    "start": "504309",
    "end": "510069"
  },
  {
    "text": "trying to avoid any cloud lock so basically it can be used from with",
    "start": "510069",
    "end": "515589"
  },
  {
    "text": "Google cloud with anything so we use EBS volumes we dock arised every part of",
    "start": "515589",
    "end": "521318"
  },
  {
    "text": "deaths that so we have deaths that's image we have graph on an image we have cron job image we have image for test we",
    "start": "521319",
    "end": "528939"
  },
  {
    "text": "replace local Postgres with our solution Patroni which is a high availability",
    "start": "528939",
    "end": "534940"
  },
  {
    "text": "today's cluster on three nodes currently we created a separate services for",
    "start": "534940",
    "end": "540280"
  },
  {
    "text": "read-only access and for a read/write access to take advantage of read replication and finally we used help for",
    "start": "540280",
    "end": "547570"
  },
  {
    "text": "template everything and to allow adding any new projects in a very easy way in",
    "start": "547570",
    "end": "553180"
  },
  {
    "text": "just a single diamo file and it will just generate templates kubernetes",
    "start": "553180",
    "end": "558850"
  },
  {
    "text": "manifests for every project needed were into a couple of problems in the course",
    "start": "558850",
    "end": "566260"
  },
  {
    "text": "of making this work yeah yeah so basically the biggest problem was with docker which was limiting a memorial",
    "start": "566260",
    "end": "574690"
  },
  {
    "text": "short memory available for pot to 64 megabytes so this is obviously a very",
    "start": "574690",
    "end": "579940"
  },
  {
    "text": "low value for for a database so we did a trick that's that's also used by",
    "start": "579940",
    "end": "585190"
  },
  {
    "text": "OpenShift we mounted a memory volume under the def s hm directory which is",
    "start": "585190",
    "end": "592750"
  },
  {
    "text": "Mac which basically gives port access to entire Ram of course we are using limits",
    "start": "592750",
    "end": "598810"
  },
  {
    "text": "and requests limitation kubernetes on every pot to not allow for example nodes",
    "start": "598810",
    "end": "606460"
  },
  {
    "text": "to be killed by too much around usage now but basically another problem was",
    "start": "606460",
    "end": "612730"
  },
  {
    "text": "with permissions related to storage because cloud provider in this case AWS",
    "start": "612730",
    "end": "619120"
  },
  {
    "text": "most our disk with root access while the Postgres database runs as a Postgres",
    "start": "619120",
    "end": "626170"
  },
  {
    "text": "user so we needed to handle that by patching Patroni installation and also",
    "start": "626170",
    "end": "632680"
  },
  {
    "text": "by running the container and special effects group mode for for the possible user and also so one of the other things",
    "start": "632680",
    "end": "640210"
  },
  {
    "text": "is we just have two big packet net servers and we actually need to split that out into more separate nodes in",
    "start": "640210",
    "end": "648550"
  },
  {
    "text": "order to have say three nodes of redundancy for Postgres other redundancy for other things the and the final thing",
    "start": "648550",
    "end": "654190"
  },
  {
    "text": "was for both of us this was actually our first production application in eks and there was a little bit of a learning",
    "start": "654190",
    "end": "659890"
  },
  {
    "text": "curve there there just some things that amazon assumes that you know about the",
    "start": "659890",
    "end": "664960"
  },
  {
    "text": "AWS environment that you don't necessarily know if you haven't done it before or even in my",
    "start": "664960",
    "end": "671620"
  },
  {
    "text": "case visibly haven't deployed a production application in a TBS in a couple of years so we ran into and had",
    "start": "671620",
    "end": "678880"
  },
  {
    "text": "to solve those so it's now ported over so and because one to show this example",
    "start": "678880",
    "end": "684430"
  },
  {
    "text": "app let's talk a little bit about what we have in there right so like I said we wanted to give examples of most of the",
    "start": "684430",
    "end": "690730"
  },
  {
    "text": "things that you would need for a production kubernetes application because we actually need most these things right so that includes ingress",
    "start": "690730",
    "end": "696040"
  },
  {
    "text": "for access to things multiple services a stateful set a replica set actually",
    "start": "696040",
    "end": "701529"
  },
  {
    "text": "multiple replica sets in a production deployment volumes cron jobs secrets SSL",
    "start": "701529",
    "end": "708339"
  },
  {
    "text": "Certificates helm which is what we used for deployment I are back for setting some",
    "start": "708339",
    "end": "714850"
  },
  {
    "text": "special permissions and also tests for the whole platform the technologies",
    "start": "714850",
    "end": "721540"
  },
  {
    "text": "involved include ingress EOB and then in ngns ingress for the ingress solution",
    "start": "721540",
    "end": "728310"
  },
  {
    "text": "using the AWS cloud provider in this installation of course because we're on on eks griffon a-- Postgres Travis CI",
    "start": "728310",
    "end": "739180"
  },
  {
    "text": "for CI update github docker hub AWS and then the wonderful let's encrypt",
    "start": "739180",
    "end": "744570"
  },
  {
    "text": "certificate manager we'll talk about more in a minute this is a very simple version of what the general application",
    "start": "744570",
    "end": "751720"
  },
  {
    "text": "structure is right so the idea here is on the Left we have contributions coming",
    "start": "751720",
    "end": "758110"
  },
  {
    "text": "in to projects via get and github we then take a whole bunch of contribution",
    "start": "758110",
    "end": "764170"
  },
  {
    "text": "information we put it into Postgres database where we massage it into in",
    "start": "764170",
    "end": "769959"
  },
  {
    "text": "analytics format the that is then displayed via graph fauna which people",
    "start": "769959",
    "end": "776170"
  },
  {
    "text": "access through in nginx ingress access in the front-end also in the backend",
    "start": "776170",
    "end": "782310"
  },
  {
    "text": "changes to the data structure and the generated reports I come from github and Travis CI tests",
    "start": "782310",
    "end": "788980"
  },
  {
    "text": "them and then we can deploy them to Postgres sets sort of our basic application structure there's a bunch of",
    "start": "788980",
    "end": "795100"
  },
  {
    "text": "refinement in this again we'll get more into that this lives in three different repositories",
    "start": "795100",
    "end": "800140"
  },
  {
    "text": "yes that starts initially was our one big repository but after time we think",
    "start": "800140",
    "end": "805839"
  },
  {
    "text": "that there are many different deployment modes like bare metal kubernetes hands and so on so we divided it into",
    "start": "805839",
    "end": "811600"
  },
  {
    "text": "containers report it contains docker images for every single part like",
    "start": "811600",
    "end": "817320"
  },
  {
    "text": "provisioning image that is needed that is started only once to provisional data our listing cron job image tests image",
    "start": "817320",
    "end": "825730"
  },
  {
    "text": "that build other image and execute test on get ops using Travis CI graph owner",
    "start": "825730",
    "end": "832660"
  },
  {
    "text": "image and finally Patroni database image",
    "start": "832660",
    "end": "837420"
  },
  {
    "text": "another another is a charts repo charts repo is where the hand chart",
    "start": "838290",
    "end": "843760"
  },
  {
    "text": "lives when child lives in it defines all the loads to to deploy all projects",
    "start": "843760",
    "end": "851500"
  },
  {
    "text": "define it here and finally we have a destiny report this is the old repo",
    "start": "851500",
    "end": "857470"
  },
  {
    "text": "where all the code was used to live it's split in two parts right now one is just",
    "start": "857470",
    "end": "862839"
  },
  {
    "text": "a source code needed to build and another one is deploying deployment related stuff that can be used for",
    "start": "862839",
    "end": "869470"
  },
  {
    "text": "bare-metal deployments and other things like that ok so like I said we're using",
    "start": "869470",
    "end": "879040"
  },
  {
    "text": "help for deployment right now one of the things that are warn you is when you look at the actual helmet arts you're",
    "start": "879040",
    "end": "885850"
  },
  {
    "text": "going to find that they are a little bit complicated let me show you the post-credits portion of the example is",
    "start": "885850",
    "end": "892920"
  },
  {
    "text": "both there's a bunch of exception code in there to allow you to swap out specific components because like one of",
    "start": "892920",
    "end": "900519"
  },
  {
    "text": "the things one of the ability to do is decide between hosting our own Postgres and using something like RDS because we",
    "start": "900519",
    "end": "908140"
  },
  {
    "text": "were on the fence about that the hosting on post quiz worked great and we decided",
    "start": "908140",
    "end": "914110"
  },
  {
    "text": "to stick with that but we wanted to be able to swap back out there's also a bunch of loop code in there for the",
    "start": "914110",
    "end": "919779"
  },
  {
    "text": "Gravano builders because we have a single graphic we have a separate group on a pod for each different project who",
    "start": "919779",
    "end": "927970"
  },
  {
    "text": "stats get displayed and for that reason we generate a whole bunch of them and that all is done through",
    "start": "927970",
    "end": "934059"
  },
  {
    "text": "Lupin code in the helm templates so just in the case of when you actually look at the helm source code itself it's gonna",
    "start": "934059",
    "end": "940089"
  },
  {
    "text": "be a little hard to read for those reasons to do so deployment platform",
    "start": "940089",
    "end": "948729"
  },
  {
    "text": "that were on top of right now kubernetes 112 because one eks and that's what eks has is goober Nettie's 112 i it's",
    "start": "948729",
    "end": "955629"
  },
  {
    "text": "designed to be fully portable though um you know I because we don't necessarily",
    "start": "955629",
    "end": "960669"
  },
  {
    "text": "want to be tied to a specific cloud the main reason for doing eks were you know",
    "start": "960669",
    "end": "967470"
  },
  {
    "text": "familiar with AWS otherwise the we had I",
    "start": "967470",
    "end": "972909"
  },
  {
    "text": "went to free eks credits did come into that and then finally in the case of why",
    "start": "972909",
    "end": "979419"
  },
  {
    "text": "we would want a major cloud provider to begin with is just that it was a much easier way for us to handle storage and",
    "start": "979419",
    "end": "985239"
  },
  {
    "text": "load balancing right it's because the cloud provider provide those whereas otherwise you have to do something like you know sand or Seth plus IP vs in",
    "start": "985239",
    "end": "993729"
  },
  {
    "text": "order to have those however we are looking at potentially moving back to a",
    "start": "993729",
    "end": "999279"
  },
  {
    "text": "more better metal engine yes yes exactly yes exactly where we just need at an",
    "start": "999279",
    "end": "1004289"
  },
  {
    "text": "example for cube contact so we don't have enough time to create a full bare metal deployment but our aim is to for",
    "start": "1004289",
    "end": "1010739"
  },
  {
    "text": "example we can even reuse our current bare metal servers that are serving deaths that's right now we can make them",
    "start": "1010739",
    "end": "1016979"
  },
  {
    "text": "two nodes for example and just take another few packet net servers to create",
    "start": "1016979",
    "end": "1022139"
  },
  {
    "text": "a fully bare metal deployment of course the problem will be with is grace and",
    "start": "1022139",
    "end": "1027449"
  },
  {
    "text": "with the storage but we would probably use local storage from this case yep so",
    "start": "1027449",
    "end": "1032519"
  },
  {
    "text": "let's talk about some components here and I'm gonna be flipping back and forth because we have a whole lot of llam√≥ here so here is the PV setup this is",
    "start": "1032519",
    "end": "1042329"
  },
  {
    "text": "actually the helm template I'll be showing you some helm templates and some generated files depending on which",
    "start": "1042329",
    "end": "1047490"
  },
  {
    "text": "component is but these this is the helm template for the various TVs in here the",
    "start": "1047490",
    "end": "1055799"
  },
  {
    "text": "because they're pretty generic since we're using cloud storage yeah so this",
    "start": "1055799",
    "end": "1061230"
  },
  {
    "text": "is a every single project you need to storage for get clones because in addition to get copy events we",
    "start": "1061230",
    "end": "1067580"
  },
  {
    "text": "also analyzing particular commits feel files so you can so every single project",
    "start": "1067580",
    "end": "1074300"
  },
  {
    "text": "need its own persistent volume crime for good storage so this is why we have it",
    "start": "1074300",
    "end": "1079490"
  },
  {
    "text": "we also have free provision free persistent volumes for Patroni database",
    "start": "1079490",
    "end": "1085180"
  },
  {
    "text": "one for master and two for slave nodes yeah so speaking the database first of",
    "start": "1085180",
    "end": "1091190"
  },
  {
    "text": "you who aren't familiar with Patroni in the setup that sort of thing is this isn't kubernetes based fully automated h",
    "start": "1091190",
    "end": "1098210"
  },
  {
    "text": "a setup for Postgres that where you have one master node and any number of reed",
    "start": "1098210",
    "end": "1105980"
  },
  {
    "text": "replicas at a given time with automated leader election so that you can fail",
    "start": "1105980",
    "end": "1112160"
  },
  {
    "text": "over and then that attaches to one pv per each individual Patroni node we have",
    "start": "1112160",
    "end": "1117680"
  },
  {
    "text": "three in the sort of default setup the",
    "start": "1117680",
    "end": "1122740"
  },
  {
    "text": "so this includes a stateful set for postcards and let me actually just show you that instead there's the generate is",
    "start": "1122740",
    "end": "1130040"
  },
  {
    "text": "the these stateful set and basically it's you're pretty straightforward",
    "start": "1130040",
    "end": "1136970"
  },
  {
    "text": "general stateful set the that pulls in there the one thing the aux we see in",
    "start": "1136970",
    "end": "1143180"
  },
  {
    "text": "the generated files is there's a whole bunch of command arguments which are all Patroni and postcards configuration",
    "start": "1143180",
    "end": "1149180"
  },
  {
    "text": "variables that all go in there in order to configure it via helm variables but",
    "start": "1149180",
    "end": "1155750"
  },
  {
    "text": "the only sort of weird thing we had to do here was both file system",
    "start": "1155750",
    "end": "1161290"
  },
  {
    "text": "configuration group access and then setting up shared memories of volume",
    "start": "1161290",
    "end": "1166790"
  },
  {
    "text": "like we mentioned earlier there are a",
    "start": "1166790",
    "end": "1172760"
  },
  {
    "text": "couple of dependencies in this which actually I think I can show you in here",
    "start": "1172760",
    "end": "1178090"
  },
  {
    "text": "yeah this is why I'm using the template circular to show you the dependencies because the generated files it's one per",
    "start": "1178090",
    "end": "1184430"
  },
  {
    "text": "object so we've got a couple of services obviously we've got the master service",
    "start": "1184430",
    "end": "1189680"
  },
  {
    "text": "and then we have the we'd only replicas service that we use for the public",
    "start": "1189680",
    "end": "1195590"
  },
  {
    "text": "portion the application and then there's also some are back stuff because",
    "start": "1195590",
    "end": "1201380"
  },
  {
    "text": "in order to control failover automatically Patroni manipulates kubernetes endpoints",
    "start": "1201380",
    "end": "1207769"
  },
  {
    "text": "which is an object type that you don't often talk about because it's generally implicitly created by kubernetes service",
    "start": "1207769",
    "end": "1213889"
  },
  {
    "text": "but you can't actually explicitly manipulate it as we do for Patroni in order to make sure that the connection",
    "start": "1213889",
    "end": "1220100"
  },
  {
    "text": "to the master always goes to whoever is the current master and thus prevents us from having split-brain and so you'll",
    "start": "1220100",
    "end": "1227000"
  },
  {
    "text": "see in there granting Patroni the ability to create and manipulate both config Maps and endpoints now the data",
    "start": "1227000",
    "end": "1237529"
  },
  {
    "text": "actually comes from a variety of sources as I mentioned at the beginning there are good github arches and github API",
    "start": "1237529",
    "end": "1243919"
  },
  {
    "text": "all this data is is checked and update every hour by the kubernetes cron job",
    "start": "1243919",
    "end": "1251059"
  },
  {
    "text": "and it then run a bunch of metric time series generated program that also saved",
    "start": "1251059",
    "end": "1257149"
  },
  {
    "text": "this data into possible database because we are using Postgres as our train service database and finally this data",
    "start": "1257149",
    "end": "1263000"
  },
  {
    "text": "got displayed from graph on a-- using real applications there are more than one replicas of graph Anna even for",
    "start": "1263000",
    "end": "1270380"
  },
  {
    "text": "single project and they just can take advantage of our high everbilly availability of the database yeah and so",
    "start": "1270380",
    "end": "1278029"
  },
  {
    "text": "that's called in a kubernetes cron job so we've got a cron job object in there that pulls the hourly sync image with",
    "start": "1278029",
    "end": "1287000"
  },
  {
    "text": "again a whole bunch of variables in there in order to do it yeah where you",
    "start": "1287000",
    "end": "1296210"
  },
  {
    "text": "talked about that ok so the graph owner",
    "start": "1296210",
    "end": "1302289"
  },
  {
    "text": "we were not able to use the standard graph owner installation because we have",
    "start": "1302289",
    "end": "1307399"
  },
  {
    "text": "a lot of custom changes to graph Anna so we decided to create graph on our",
    "start": "1307399",
    "end": "1312830"
  },
  {
    "text": "justice graph on an image that provision itself from a set of template variables",
    "start": "1312830",
    "end": "1318620"
  },
  {
    "text": "like database access like dashboards Jason's that needs to be displayed and we are also customizing some artwork",
    "start": "1318620",
    "end": "1326000"
  },
  {
    "text": "like icons and links and things so on so this is this is how graph owner is",
    "start": "1326000",
    "end": "1331250"
  },
  {
    "text": "created and if you want to add another dashboard you are just update the image and the kubernetes will fire",
    "start": "1331250",
    "end": "1337370"
  },
  {
    "text": "the rolling update and nuclear fauna will be available once it's finished yeah and as I mentioned we get a",
    "start": "1337370",
    "end": "1344179"
  },
  {
    "text": "separate brief on a pod for each hosted project for each project whose community stats are going to be displayed and for",
    "start": "1344179",
    "end": "1350870"
  },
  {
    "text": "that reason if you actually look at the generated files from helm what you'll see is you'll see a whole series of",
    "start": "1350870",
    "end": "1357880"
  },
  {
    "text": "deployments here like in this case this is for the Prometheus project do we're",
    "start": "1357880",
    "end": "1364190"
  },
  {
    "text": "doing more than one here is it just Prometheus oh you just did Prometheus yes but it's labeled right it's labeled",
    "start": "1364190",
    "end": "1369530"
  },
  {
    "text": "Prometheus in there but if you were actually hosting five or six different projects you would see five or six",
    "start": "1369530",
    "end": "1374540"
  },
  {
    "text": "different replica sets there yeah so the",
    "start": "1374540",
    "end": "1381799"
  },
  {
    "text": "secret files we are we can easy with that one we don't have any fancy",
    "start": "1381799",
    "end": "1388130"
  },
  {
    "text": "security management right now we just have a bunch of files ending with dot secret that are not checked in into the",
    "start": "1388130",
    "end": "1395240"
  },
  {
    "text": "repo and we are we have corresponding files ending with example so before you actually can install the home chart you",
    "start": "1395240",
    "end": "1402860"
  },
  {
    "text": "need to take the example files and for each of them you need to provide your own values they are just they are used",
    "start": "1402860",
    "end": "1410660"
  },
  {
    "text": "internal by the cluster but you need for example provide github appliques and passwords for graph ana for Postma's and",
    "start": "1410660",
    "end": "1417830"
  },
  {
    "text": "so on yeah and then the and then it'll generate the actual secrets calls for",
    "start": "1417830",
    "end": "1424330"
  },
  {
    "text": "populating those engine controller we",
    "start": "1424330",
    "end": "1430850"
  },
  {
    "text": "are using we are using nginx to road traffic to a specific graph on our instance we are we are registering a",
    "start": "1430850",
    "end": "1438530"
  },
  {
    "text": "domain with wildcard domains so for example we have def starts demo dotnet",
    "start": "1438530",
    "end": "1444110"
  },
  {
    "text": "and we every single sub domain from this is routed to our AWS ELB endpoint and",
    "start": "1444110",
    "end": "1451880"
  },
  {
    "text": "data data endpoint is used by by the nginx and nginx takes a look what is",
    "start": "1451880",
    "end": "1458780"
  },
  {
    "text": "your host name what is your sub domain name and based of that it directs the the traffic to a specific projects graph",
    "start": "1458780",
    "end": "1466520"
  },
  {
    "text": "and we are also using certain manager which is a very good program it once you have a domain once",
    "start": "1466520",
    "end": "1474820"
  },
  {
    "text": "you have a domain name you can use it to automatically use let's say script and",
    "start": "1474820",
    "end": "1480250"
  },
  {
    "text": "automatically renewal certificates yeah",
    "start": "1480250",
    "end": "1486520"
  },
  {
    "text": "so also testing so testing is not yet finished but the CI part is ready so we",
    "start": "1486520",
    "end": "1495640"
  },
  {
    "text": "have Travis a job that is a favorite on github and on every key tops we are building images and building test image",
    "start": "1495640",
    "end": "1502750"
  },
  {
    "text": "that is executing the test and returning the final state we are missing the continuous deployment part there was it",
    "start": "1502750",
    "end": "1510040"
  },
  {
    "text": "was implemented on the bare metal solution but right now but our solution",
    "start": "1510040",
    "end": "1515140"
  },
  {
    "text": "was not good enough for kubernetes so we are considering to switch possibly to some other CI C D and V Ron environment",
    "start": "1515140",
    "end": "1522940"
  },
  {
    "text": "but it's not ready yet yeah so in case any of you actually want",
    "start": "1522940",
    "end": "1528970"
  },
  {
    "text": "to deploy dev sets itself which you might if you're involved with other business projects that sort of thing just a few notes on actually running it",
    "start": "1528970",
    "end": "1536200"
  },
  {
    "text": "in production what you would actually need to do to take the code that we have in order to run in production yeah so",
    "start": "1536200",
    "end": "1542310"
  },
  {
    "text": "first things you need to do is to have some domain registry we used AWS wrote",
    "start": "1542310",
    "end": "1548550"
  },
  {
    "text": "53:4 for our example but it can be anything then you then you need to have",
    "start": "1548550",
    "end": "1554050"
  },
  {
    "text": "some ingress controller in our case it was lv from AWS and finally you need",
    "start": "1554050",
    "end": "1560980"
  },
  {
    "text": "something that to handle certificates in our case we used open source programs",
    "start": "1560980",
    "end": "1565990"
  },
  {
    "text": "certain manager that uses let's encrypt under the hood yeah now one of the",
    "start": "1565990",
    "end": "1571150"
  },
  {
    "text": "things that it is set up for and like I said the reason for some of those complicated home charts was it was designed to be a somewhat flexible",
    "start": "1571150",
    "end": "1576940"
  },
  {
    "text": "deployment I mean honestly it was because we wanted to be able to change our minds in the future about exactly",
    "start": "1576940",
    "end": "1581980"
  },
  {
    "text": "how this was installed and where it was installed so including things like if you don't feel comfortable running a",
    "start": "1581980",
    "end": "1587980"
  },
  {
    "text": "self-hosted database then you might want to swap it out for RDS or digitalocean Postgres or whatever else is available",
    "start": "1587980",
    "end": "1594460"
  },
  {
    "text": "on your platform and so you can do that you might not want to use graph on",
    "start": "1594460",
    "end": "1601419"
  },
  {
    "text": "if your goal is to just generate analytics data that is going to be",
    "start": "1601419",
    "end": "1606610"
  },
  {
    "text": "consumed by some platform other than Griffon a-- it's also set up to do that including output to elastic search as",
    "start": "1606610",
    "end": "1615009"
  },
  {
    "text": "another option yeah so we had some requests to create a special instance",
    "start": "1615009",
    "end": "1620710"
  },
  {
    "text": "for death cells and that instance was for example using Aurora DB so this is a",
    "start": "1620710",
    "end": "1626409"
  },
  {
    "text": "managed possible solution it wasn't using graph owner at all and it was using elastic search as a final",
    "start": "1626409",
    "end": "1633039"
  },
  {
    "text": "store for data from this stuff yep so still work-in-progress stuff that you",
    "start": "1633039",
    "end": "1639879"
  },
  {
    "text": "are welcome to submit stuff to contribute to obviously number one thing is documentation you know there's some",
    "start": "1639879",
    "end": "1646029"
  },
  {
    "text": "degree these charts and stuff are supposed to be self documenting but nothing is really self documenting so we need to actually write up the purposes",
    "start": "1646029",
    "end": "1651639"
  },
  {
    "text": "of all of the components and how they work internally etc we need to register",
    "start": "1651639",
    "end": "1660100"
  },
  {
    "text": "the helm chart on Quade i/o or another service so that you can install it without a git clone doesn't currently",
    "start": "1660100",
    "end": "1667570"
  },
  {
    "text": "have any monitoring built in that's another major sort of you know production application example thing and",
    "start": "1667570",
    "end": "1673059"
  },
  {
    "text": "so we need at least have some basic monitoring and there via Prometheus or otherwise because I work for Red Hat I'm",
    "start": "1673059",
    "end": "1680169"
  },
  {
    "text": "also going to create an example operator out of this using the operator",
    "start": "1680169",
    "end": "1685330"
  },
  {
    "text": "development kit talking about doing improve CI CD in here and then maybe",
    "start": "1685330",
    "end": "1692919"
  },
  {
    "text": "look at having a more sophisticated solution for secrets management you know vault or otherwise and one thing that is",
    "start": "1692919",
    "end": "1700389"
  },
  {
    "text": "sure for now we are moving our current deployment for our CN CF projects from",
    "start": "1700389",
    "end": "1705820"
  },
  {
    "text": "bare metal to kubernetes so it's not yet decide if we will use AWS or we will go",
    "start": "1705820",
    "end": "1711190"
  },
  {
    "text": "just bare metal I think we will go with the latter with the latter but it will we will see yep and of course the big",
    "start": "1711190",
    "end": "1717999"
  },
  {
    "text": "thing is we're really interested in people who are interested in contributing to this we're interested in",
    "start": "1717999",
    "end": "1723669"
  },
  {
    "text": "using dev stats are interesting in tributing to it either as dev stats because you want the community stats and the development stats or as an example",
    "start": "1723669",
    "end": "1730600"
  },
  {
    "text": "application right if you want to say hey I don't actually care about dev stats but do care about sequence management so I",
    "start": "1730600",
    "end": "1736190"
  },
  {
    "text": "want to have this robust implementation of secrets management as an example to",
    "start": "1736190",
    "end": "1741860"
  },
  {
    "text": "new kubernetes users we would love to have that because there's some things we probably won't get around to doing",
    "start": "1741860",
    "end": "1747669"
  },
  {
    "text": "because we don't actually need them in production so given that we actually",
    "start": "1747669",
    "end": "1753350"
  },
  {
    "text": "have you know seven eight minutes for some questions here's links to all of the repos and",
    "start": "1753350",
    "end": "1758390"
  },
  {
    "text": "everything else so do you have questions",
    "start": "1758390",
    "end": "1762159"
  },
  {
    "text": "yeah so his question was the experience of decomposing the monolithic application",
    "start": "1794110",
    "end": "1801280"
  },
  {
    "text": "into a bunch of services and talking specifically about having a lot a lot like hundreds of services I I don't",
    "start": "1801280",
    "end": "1807830"
  },
  {
    "text": "think the original application was that complicated now so the funny part is that this application was created by CN",
    "start": "1807830",
    "end": "1814100"
  },
  {
    "text": "CF and CN CF is a home for kubernetes so since the real beginning I was",
    "start": "1814100",
    "end": "1820280"
  },
  {
    "text": "considering kubernetes as a final platform so we of course needed to split",
    "start": "1820280",
    "end": "1826040"
  },
  {
    "text": "a bit of parts but basically the main dev start was built with kubernetes in",
    "start": "1826040",
    "end": "1831920"
  },
  {
    "text": "mind since the rear begin so for example every single Benari like bernard for",
    "start": "1831920",
    "end": "1836930"
  },
  {
    "text": "data sources like bernard that is calculating matrix and all other stuff they were all separate and they were",
    "start": "1836930",
    "end": "1843580"
  },
  {
    "text": "communicating through the database service that was also configurable from the real beginning by the environment",
    "start": "1843580",
    "end": "1850490"
  },
  {
    "text": "variables so it wasn't that hard because that was the final target from the",
    "start": "1850490",
    "end": "1857360"
  },
  {
    "text": "scenes beginning",
    "start": "1857360",
    "end": "1859900"
  },
  {
    "text": "so question was how we assigned specific contribution both in terms of how do we know who contributed something and then",
    "start": "1876059",
    "end": "1883389"
  },
  {
    "text": "asking about the company attribution of contributions so we have our separate ACF project which is CN CF get DM or get",
    "start": "1883389",
    "end": "1892929"
  },
  {
    "text": "data mine and this one is trying to get a big list of people and their",
    "start": "1892929",
    "end": "1899289"
  },
  {
    "text": "companions they were working for so for example for single github user we can have a list of companies and the data",
    "start": "1899289",
    "end": "1905980"
  },
  {
    "text": "ranges they were working for a given company for this is all the manual process we will train automatic tools",
    "start": "1905980",
    "end": "1912220"
  },
  {
    "text": "there are a lot of them and our outcome from this is that they help a bit but we",
    "start": "1912220",
    "end": "1918340"
  },
  {
    "text": "also get a lot of noise and trash that we need to manually filter currently there is a contractor that is working",
    "start": "1918340",
    "end": "1925330"
  },
  {
    "text": "only on this part so we are constantly researching using LinkedIn Facebook",
    "start": "1925330",
    "end": "1931120"
  },
  {
    "text": "Google Twitter wherever and trying to find affiliations and finally we are",
    "start": "1931120",
    "end": "1936820"
  },
  {
    "text": "importing the big JSON file with those affiliations about twice per month and",
    "start": "1936820",
    "end": "1942399"
  },
  {
    "text": "updating data okay there was another question go ahead",
    "start": "1942399",
    "end": "1954480"
  },
  {
    "text": "okay question was how we deal with gdpr and whether or not somebody wants to be delisted that that has not been our",
    "start": "1959680",
    "end": "1968870"
  },
  {
    "text": "problem so far in terms with first part of GDP our right is not privacy has not",
    "start": "1968870",
    "end": "1974300"
  },
  {
    "text": "been our problem because the data sources we draw from are all already public right we're drawing from github",
    "start": "1974300",
    "end": "1979910"
  },
  {
    "text": "where the information that we're drawing is already public the second part of it",
    "start": "1979910",
    "end": "1985370"
  },
  {
    "text": "which is the right of removal theoretically were prepared to",
    "start": "1985370",
    "end": "1990760"
  },
  {
    "text": "effectively anonymize somebody in the database so far we haven't had to do it",
    "start": "1990760",
    "end": "1996590"
  },
  {
    "text": "as far as I know we haven't had any but we did yes so okay there was a problem with gdpr but our solution was exactly",
    "start": "1996590",
    "end": "2005320"
  },
  {
    "text": "like Josh said this data is public so we don't need to hide this but some people",
    "start": "2005320",
    "end": "2011080"
  },
  {
    "text": "may want their data not to show and we have a separate section in documentation",
    "start": "2011080",
    "end": "2017410"
  },
  {
    "text": "how can you create a pull request that requests removal of your data and and we",
    "start": "2017410",
    "end": "2023530"
  },
  {
    "text": "have a special a binary program that will scan our data and remove that",
    "start": "2023530",
    "end": "2028650"
  },
  {
    "text": "replacing this with some some special marker that we don't have that data so",
    "start": "2028650",
    "end": "2034420"
  },
  {
    "text": "we actually have one or two cases of people ask us for remove their",
    "start": "2034420",
    "end": "2040540"
  },
  {
    "text": "affiliation data from CN CF gdm and we just did that and that's it",
    "start": "2040540",
    "end": "2046800"
  },
  {
    "text": "now what was the hardest part in moving everything to kubernetes well that that will that will again be a strange answer",
    "start": "2054950",
    "end": "2062310"
  },
  {
    "text": "I don't think we have a hard part I it was a big fun for me I am actually so",
    "start": "2062310",
    "end": "2068158"
  },
  {
    "text": "amazed how kubernetes make everything easier for me for example I don't need to care for an operating system anymore",
    "start": "2068159",
    "end": "2074730"
  },
  {
    "text": "I don't need to care about in this case storage and many other things so for",
    "start": "2074730",
    "end": "2080700"
  },
  {
    "text": "example when deploying new dashboards I don't need to stop gravano I am just creating a rolling update which creates",
    "start": "2080700",
    "end": "2087030"
  },
  {
    "text": "another one and because it was written since since the real beginning in kubernetes in mind I didn't really had",
    "start": "2087030",
    "end": "2093690"
  },
  {
    "text": "biggest problem other than this too is small issues with short memory and",
    "start": "2093690",
    "end": "2098880"
  },
  {
    "text": "permissions every everything color was just good for me any more questions and",
    "start": "2098880",
    "end": "2108920"
  },
  {
    "text": "the hardest part the hardest part of all of this I think is a database management",
    "start": "2108920",
    "end": "2114599"
  },
  {
    "text": "and persistent volumes for for stateful application but it wasn't hard at all",
    "start": "2114599",
    "end": "2119609"
  },
  {
    "text": "for me but if I need to choose the hardest part this was it what so we one",
    "start": "2119609",
    "end": "2127980"
  },
  {
    "text": "there and one here and then I think we'll be done yeah so one there",
    "start": "2127980",
    "end": "2133369"
  },
  {
    "text": "so how big of a box do you need to run a test deployment of dev stats but if you",
    "start": "2139970",
    "end": "2145160"
  },
  {
    "text": "don't want how much memory would we need memory yeah I don't it wouldn't be it",
    "start": "2145160",
    "end": "2151970"
  },
  {
    "text": "wouldn't be big I mean I think honestly something like in a in M 3 extra larger",
    "start": "2151970",
    "end": "2158180"
  },
  {
    "text": "and 4 extra larges actually yes actually it depends on the project that that's",
    "start": "2158180",
    "end": "2163550"
  },
  {
    "text": "the the best answer I think because if you want to deploy kubernetes which has 300 triples and millions of events you",
    "start": "2163550",
    "end": "2171200"
  },
  {
    "text": "will need a lot of memory but if you want to deploy something small you will just be fine with a single machine ec2",
    "start": "2171200",
    "end": "2178609"
  },
  {
    "text": "default instance I think and then last question a connection pool for database",
    "start": "2178609",
    "end": "2188569"
  },
  {
    "text": "I mean we rate we're not actually doing connection pooling because we have a",
    "start": "2188569",
    "end": "2194810"
  },
  {
    "text": "simple graph on a prod for every project the oh right because it could pooling",
    "start": "2194810",
    "end": "2201079"
  },
  {
    "text": "those connections for that right that hasn't been an issue I would inject a PG",
    "start": "2201079",
    "end": "2207560"
  },
  {
    "text": "bouncer pod in there if it became an issue but so far we never actually have",
    "start": "2207560",
    "end": "2215329"
  },
  {
    "text": "more than 100 simultaneous connections which is easily handled just through the post was default yes and our bare-metal",
    "start": "2215329",
    "end": "2222829"
  },
  {
    "text": "deployment actually I needed to tweak few Postgres variables like maximum",
    "start": "2222829",
    "end": "2228140"
  },
  {
    "text": "connections short buffers and things like that but our bare metal server is a beast beefy so powerful that even Q Burnett",
    "start": "2228140",
    "end": "2236510"
  },
  {
    "text": "says it's not a problem for again so thank you very much [Applause]",
    "start": "2236510",
    "end": "2244580"
  }
]