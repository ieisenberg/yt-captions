[
  {
    "text": "uh so first off thank you for being here",
    "start": "120",
    "end": "2040"
  },
  {
    "text": "I'm an East coaster so you know in about",
    "start": "2040",
    "end": "4120"
  },
  {
    "text": "30 minutes I'd normally be going to bed",
    "start": "4120",
    "end": "6040"
  },
  {
    "text": "but uh hopefully you're here for the",
    "start": "6040",
    "end": "7520"
  },
  {
    "text": "right talk it's a detection Engineering",
    "start": "7520",
    "end": "9080"
  },
  {
    "text": "in kubernetes environments and uh we're",
    "start": "9080",
    "end": "11160"
  },
  {
    "text": "going to talk about some",
    "start": "11160",
    "end": "13000"
  },
  {
    "text": "logs so just a quick intro about who I",
    "start": "13000",
    "end": "16278"
  },
  {
    "text": "am my name is Dakota Riley I am the vice",
    "start": "16279",
    "end": "18960"
  },
  {
    "text": "president of cloud engineering at Aquia",
    "start": "18960",
    "end": "20960"
  },
  {
    "text": "uh commonly confused with aqua or AIA",
    "start": "20960",
    "end": "23800"
  },
  {
    "text": "but it's uh Aquia uh and I'll talk a",
    "start": "23800",
    "end": "25680"
  },
  {
    "text": "little bit about our company in a second",
    "start": "25680",
    "end": "27039"
  },
  {
    "text": "but uh I describe myself as a you know",
    "start": "27039",
    "end": "29480"
  },
  {
    "text": "Cloud sec application security",
    "start": "29480",
    "end": "31519"
  },
  {
    "text": "practitioner and I love finding ways to",
    "start": "31519",
    "end": "33239"
  },
  {
    "text": "automate those things and make them as",
    "start": "33239",
    "end": "34360"
  },
  {
    "text": "easy as possible for people Downstream",
    "start": "34360",
    "end": "36840"
  },
  {
    "text": "uh outside of C I can't talk outside of",
    "start": "36840",
    "end": "39680"
  },
  {
    "text": "work I've got three cats back at home I",
    "start": "39680",
    "end": "41520"
  },
  {
    "text": "got married in April and I play way too",
    "start": "41520",
    "end": "44200"
  },
  {
    "text": "many video games and like working out",
    "start": "44200",
    "end": "46559"
  },
  {
    "text": "congratulations thank you thank",
    "start": "46559",
    "end": "48580"
  },
  {
    "text": "[Laughter]",
    "start": "48580",
    "end": "50600"
  },
  {
    "text": "you so uh quick little intro about my",
    "start": "50600",
    "end": "53960"
  },
  {
    "text": "employer who I'm here representing today",
    "start": "53960",
    "end": "56600"
  },
  {
    "text": "um so the easiest way to boil us down is",
    "start": "56600",
    "end": "58280"
  },
  {
    "text": "we're a consulting company uh we do a",
    "start": "58280",
    "end": "60120"
  },
  {
    "text": "lot of public sector work around Cloud",
    "start": "60120",
    "end": "61680"
  },
  {
    "text": "Security application security compliance",
    "start": "61680",
    "end": "64799"
  },
  {
    "text": "Cloud infrastructure the the",
    "start": "64799",
    "end": "66640"
  },
  {
    "text": "intersection of all those things",
    "start": "66640",
    "end": "68400"
  },
  {
    "text": "together and relevant to the talk we",
    "start": "68400",
    "end": "71200"
  },
  {
    "text": "actually do a lot of kubernetes and kind",
    "start": "71200",
    "end": "72680"
  },
  {
    "text": "of cloud native security work too",
    "start": "72680",
    "end": "73920"
  },
  {
    "text": "specifically with some of the uh",
    "start": "73920",
    "end": "75119"
  },
  {
    "text": "Department of Defense software factories",
    "start": "75119",
    "end": "76520"
  },
  {
    "text": "and federal software",
    "start": "76520",
    "end": "79320"
  },
  {
    "text": "factories so just a kind of a quick",
    "start": "80320",
    "end": "83000"
  },
  {
    "text": "little overview of the agenda of the",
    "start": "83000",
    "end": "84960"
  },
  {
    "text": "talk so the first thing I'll start out",
    "start": "84960",
    "end": "87479"
  },
  {
    "text": "with is kind of some some data points",
    "start": "87479",
    "end": "89720"
  },
  {
    "text": "right on why you should build kind of",
    "start": "89720",
    "end": "92960"
  },
  {
    "text": "kubernetes detection engineering into",
    "start": "92960",
    "end": "94240"
  },
  {
    "text": "your security backlog right why spend",
    "start": "94240",
    "end": "95720"
  },
  {
    "text": "the bandwidth doing it then we'll talk",
    "start": "95720",
    "end": "98320"
  },
  {
    "text": "with about a kind of a highle threat",
    "start": "98320",
    "end": "99720"
  },
  {
    "text": "model of what an attack cycle in a",
    "start": "99720",
    "end": "101759"
  },
  {
    "text": "kubernetes cluster might look like and",
    "start": "101759",
    "end": "104399"
  },
  {
    "text": "specifically at least the two minimum",
    "start": "104399",
    "end": "106040"
  },
  {
    "text": "data sources that you would need to get",
    "start": "106040",
    "end": "107520"
  },
  {
    "text": "started detecting bad things in your",
    "start": "107520",
    "end": "109600"
  },
  {
    "text": "clusters um we'll talk about CIS calls",
    "start": "109600",
    "end": "111759"
  },
  {
    "text": "kind of at a high level forview there's",
    "start": "111759",
    "end": "113360"
  },
  {
    "text": "lots of good CIS calls and runtime",
    "start": "113360",
    "end": "114759"
  },
  {
    "text": "security content here today um and on a",
    "start": "114759",
    "end": "117240"
  },
  {
    "text": "more deeper level we'll talk about",
    "start": "117240",
    "end": "118759"
  },
  {
    "text": "kubernetes Auto logs right and from that",
    "start": "118759",
    "end": "121840"
  },
  {
    "text": "point we'll talk about how to get",
    "start": "121840",
    "end": "123159"
  },
  {
    "text": "started writing your own detection cases",
    "start": "123159",
    "end": "124920"
  },
  {
    "text": "you know like what kind of mindsets you",
    "start": "124920",
    "end": "126159"
  },
  {
    "text": "want to apply to that uh where to look",
    "start": "126159",
    "end": "128280"
  },
  {
    "text": "for inspiration and what not to do and",
    "start": "128280",
    "end": "130520"
  },
  {
    "text": "then at the end of the talk we'll",
    "start": "130520",
    "end": "131840"
  },
  {
    "text": "actually look at some real world",
    "start": "131840",
    "end": "133080"
  },
  {
    "text": "examples where we look at logs we'll",
    "start": "133080",
    "end": "135120"
  },
  {
    "text": "look at you know the actions that",
    "start": "135120",
    "end": "136280"
  },
  {
    "text": "generate them they common uh you know uh",
    "start": "136280",
    "end": "138640"
  },
  {
    "text": "known true positive use cases and how to",
    "start": "138640",
    "end": "141160"
  },
  {
    "text": "bring them down to a low uh ratio false",
    "start": "141160",
    "end": "146440"
  },
  {
    "text": "positive so since we're talk about",
    "start": "147640",
    "end": "150200"
  },
  {
    "text": "detection engineering right uh one thing",
    "start": "150200",
    "end": "152319"
  },
  {
    "text": "that I find important when you kind of",
    "start": "152319",
    "end": "153640"
  },
  {
    "text": "start to think about what types of",
    "start": "153640",
    "end": "155560"
  },
  {
    "text": "activity you want to detect is are the",
    "start": "155560",
    "end": "157959"
  },
  {
    "text": "things that I'm wanting to detect",
    "start": "157959",
    "end": "158920"
  },
  {
    "text": "actually happening in the real world",
    "start": "158920",
    "end": "160239"
  },
  {
    "text": "right you know are people actually",
    "start": "160239",
    "end": "161680"
  },
  {
    "text": "attacking ku's clusters or attacking the",
    "start": "161680",
    "end": "163720"
  },
  {
    "text": "control plane and there's two real kind",
    "start": "163720",
    "end": "166640"
  },
  {
    "text": "of data points I wanted to throw in here",
    "start": "166640",
    "end": "167800"
  },
  {
    "text": "for the talk so the first and I want to",
    "start": "167800",
    "end": "170680"
  },
  {
    "text": "throw this one with the caveat because",
    "start": "170680",
    "end": "173080"
  },
  {
    "text": "um it's not the end all be all for",
    "start": "173080",
    "end": "174840"
  },
  {
    "text": "anything and I definitely don't",
    "start": "174840",
    "end": "175720"
  },
  {
    "text": "recommend you make heat maps for it but",
    "start": "175720",
    "end": "177760"
  },
  {
    "text": "uh is miter attack and specifically",
    "start": "177760",
    "end": "179560"
  },
  {
    "text": "miter attack for containers and the",
    "start": "179560",
    "end": "181879"
  },
  {
    "text": "interest the data point I would the",
    "start": "181879",
    "end": "183080"
  },
  {
    "text": "reason I would point to this is because",
    "start": "183080",
    "end": "185519"
  },
  {
    "text": "uh if you don't know what miter attack",
    "start": "185519",
    "end": "186599"
  },
  {
    "text": "is it's basically like a repository of",
    "start": "186599",
    "end": "188640"
  },
  {
    "text": "what are called ttps tactics techniques",
    "start": "188640",
    "end": "190640"
  },
  {
    "text": "and procedures and the criteria for",
    "start": "190640",
    "end": "193080"
  },
  {
    "text": "something to be added to miter attack is",
    "start": "193080",
    "end": "194599"
  },
  {
    "text": "it has to have been observed happening",
    "start": "194599",
    "end": "196120"
  },
  {
    "text": "in the real world right um so it makes",
    "start": "196120",
    "end": "199440"
  },
  {
    "text": "it a good starting point for hey if this",
    "start": "199440",
    "end": "201640"
  },
  {
    "text": "activity is in there maybe we should",
    "start": "201640",
    "end": "203239"
  },
  {
    "text": "have a detection for it don't make a",
    "start": "203239",
    "end": "205040"
  },
  {
    "text": "heat map um I'll say that a few times in",
    "start": "205040",
    "end": "207560"
  },
  {
    "text": "the talk but uh specific to kubernetes",
    "start": "207560",
    "end": "209840"
  },
  {
    "text": "there's actually an entire containers",
    "start": "209840",
    "end": "211480"
  },
  {
    "text": "Matrix that has ttps relevant to",
    "start": "211480",
    "end": "214480"
  },
  {
    "text": "container",
    "start": "214480",
    "end": "215360"
  },
  {
    "text": "orchestrators and most of those",
    "start": "215360",
    "end": "217239"
  },
  {
    "text": "techniques have sub techniques that tie",
    "start": "217239",
    "end": "219120"
  },
  {
    "text": "back to kuet specific Technologies",
    "start": "219120",
    "end": "222080"
  },
  {
    "text": "themselves the second uh a little more",
    "start": "222080",
    "end": "224280"
  },
  {
    "text": "specific data point is and I actually",
    "start": "224280",
    "end": "225640"
  },
  {
    "text": "found this when I was uh putting",
    "start": "225640",
    "end": "226760"
  },
  {
    "text": "together the talk is there was an",
    "start": "226760",
    "end": "228120"
  },
  {
    "text": "academic study done by the University of",
    "start": "228120",
    "end": "230439"
  },
  {
    "text": "California Santa Barbara and the the",
    "start": "230439",
    "end": "233400"
  },
  {
    "text": "easiest way to sum up what they did is",
    "start": "233400",
    "end": "234760"
  },
  {
    "text": "they took different container",
    "start": "234760",
    "end": "235760"
  },
  {
    "text": "orchestrator Technologies including",
    "start": "235760",
    "end": "237400"
  },
  {
    "text": "kubernetes exposed them to the internet",
    "start": "237400",
    "end": "239560"
  },
  {
    "text": "and and watched what happened right and",
    "start": "239560",
    "end": "242239"
  },
  {
    "text": "uh the gist of what happened was is",
    "start": "242239",
    "end": "244519"
  },
  {
    "text": "there were automated attacks against the",
    "start": "244519",
    "end": "246439"
  },
  {
    "text": "exposed kubernetes cluster basically",
    "start": "246439",
    "end": "248040"
  },
  {
    "text": "they were crawling the control plane API",
    "start": "248040",
    "end": "250439"
  },
  {
    "text": "trying to create pods trying to create",
    "start": "250439",
    "end": "253000"
  },
  {
    "text": "uh service account requests uh trying to",
    "start": "253000",
    "end": "255319"
  },
  {
    "text": "create the footle in the cluster uh but",
    "start": "255319",
    "end": "257160"
  },
  {
    "text": "the other thing was interesting to me as",
    "start": "257160",
    "end": "258280"
  },
  {
    "text": "a practitioner is they kind of went",
    "start": "258280",
    "end": "259680"
  },
  {
    "text": "beyond that and they also exposed the",
    "start": "259680",
    "end": "261560"
  },
  {
    "text": "culate API which you really shouldn't do",
    "start": "261560",
    "end": "263880"
  },
  {
    "text": "but there were automated attacks against",
    "start": "263880",
    "end": "265160"
  },
  {
    "text": "that too which to me implies that",
    "start": "265160",
    "end": "266919"
  },
  {
    "text": "adversaries out there have a you know",
    "start": "266919",
    "end": "268520"
  },
  {
    "text": "higher than Baseline understanding of",
    "start": "268520",
    "end": "270080"
  },
  {
    "text": "kubernetes and how to attack",
    "start": "270080",
    "end": "273159"
  },
  {
    "text": "it and with that we'll you know talk",
    "start": "274400",
    "end": "277039"
  },
  {
    "text": "about you know if I was an adversary uh",
    "start": "277039",
    "end": "279280"
  },
  {
    "text": "what are potential paths I could take to",
    "start": "279280",
    "end": "281080"
  },
  {
    "text": "compromise kubernetes cluster and you",
    "start": "281080",
    "end": "283680"
  },
  {
    "text": "know for the purpose of the talk this is",
    "start": "283680",
    "end": "285080"
  },
  {
    "text": "probably boiled down to its most",
    "start": "285080",
    "end": "286360"
  },
  {
    "text": "simplest form right I'm excluding like",
    "start": "286360",
    "end": "288080"
  },
  {
    "text": "you know kind of crazy supply chain",
    "start": "288080",
    "end": "289479"
  },
  {
    "text": "attacks but really there are two right",
    "start": "289479",
    "end": "292240"
  },
  {
    "text": "and you know let's say we have a cuberes",
    "start": "292240",
    "end": "294160"
  },
  {
    "text": "cluster that's running an application",
    "start": "294160",
    "end": "295639"
  },
  {
    "text": "that we're exposing to the internet the",
    "start": "295639",
    "end": "297360"
  },
  {
    "text": "first would be is Po exploiting that",
    "start": "297360",
    "end": "300639"
  },
  {
    "text": "application to get code execution on the",
    "start": "300639",
    "end": "302320"
  },
  {
    "text": "pot in the cluster right um you know",
    "start": "302320",
    "end": "304720"
  },
  {
    "text": "just because it's running on kubernetes",
    "start": "304720",
    "end": "305960"
  },
  {
    "text": "that doesn't change if you don't patch",
    "start": "305960",
    "end": "307120"
  },
  {
    "text": "your applications or you know uh build",
    "start": "307120",
    "end": "309600"
  },
  {
    "text": "them securely that's always a threat",
    "start": "309600",
    "end": "311440"
  },
  {
    "text": "right the second would be uh basically",
    "start": "311440",
    "end": "314960"
  },
  {
    "text": "attacking legitimate access to get",
    "start": "314960",
    "end": "316720"
  },
  {
    "text": "access to the control plane right and",
    "start": "316720",
    "end": "320520"
  },
  {
    "text": "where these get a little more",
    "start": "320520",
    "end": "321600"
  },
  {
    "text": "interesting is typically in you know the",
    "start": "321600",
    "end": "323680"
  },
  {
    "text": "life cycle of a real kill chain you're",
    "start": "323680",
    "end": "326039"
  },
  {
    "text": "probably moving laterally between the",
    "start": "326039",
    "end": "327520"
  },
  {
    "text": "two right maybe you comp that",
    "start": "327520",
    "end": "330080"
  },
  {
    "text": "application you found a service account",
    "start": "330080",
    "end": "331680"
  },
  {
    "text": "token on the Pod and you start trying to",
    "start": "331680",
    "end": "333800"
  },
  {
    "text": "see what it has access to there are",
    "start": "333800",
    "end": "335120"
  },
  {
    "text": "certain Secrets it can it read can it",
    "start": "335120",
    "end": "336880"
  },
  {
    "text": "create its own resources or vice versa",
    "start": "336880",
    "end": "339360"
  },
  {
    "text": "maybe you compromise a developer inpoint",
    "start": "339360",
    "end": "341039"
  },
  {
    "text": "or a cicd pipeline that has access to",
    "start": "341039",
    "end": "343039"
  },
  {
    "text": "the cluster control plane and now you're",
    "start": "343039",
    "end": "344919"
  },
  {
    "text": "using that to see if you can exec into",
    "start": "344919",
    "end": "347319"
  },
  {
    "text": "containers see if there's you know",
    "start": "347319",
    "end": "348680"
  },
  {
    "text": "anything interesting you could find that",
    "start": "348680",
    "end": "349720"
  },
  {
    "text": "would give you another lateral movement",
    "start": "349720",
    "end": "352520"
  },
  {
    "text": "point so great uh you just listed a",
    "start": "352520",
    "end": "355560"
  },
  {
    "text": "bunch of problems uh this is not an",
    "start": "355560",
    "end": "357919"
  },
  {
    "text": "offensive security talk it's a detection",
    "start": "357919",
    "end": "359199"
  },
  {
    "text": "engineering talk what do we do with that",
    "start": "359199",
    "end": "360919"
  },
  {
    "text": "how do we get started detecting all that",
    "start": "360919",
    "end": "362360"
  },
  {
    "text": "right and the first step really comes",
    "start": "362360",
    "end": "366160"
  },
  {
    "text": "down to having the appropriate data",
    "start": "366160",
    "end": "368360"
  },
  {
    "text": "sources to actually detect things",
    "start": "368360",
    "end": "370720"
  },
  {
    "text": "against that and those two things are at",
    "start": "370720",
    "end": "372400"
  },
  {
    "text": "a minimum right this is not a mutually",
    "start": "372400",
    "end": "374160"
  },
  {
    "text": "exclusive list but this is if you're",
    "start": "374160",
    "end": "376039"
  },
  {
    "text": "starting from nothing that would be some",
    "start": "376039",
    "end": "378199"
  },
  {
    "text": "sort of runtime capability you know",
    "start": "378199",
    "end": "379919"
  },
  {
    "text": "basically something that instruments and",
    "start": "379919",
    "end": "381080"
  },
  {
    "text": "detects CIS call based activity and the",
    "start": "381080",
    "end": "384199"
  },
  {
    "text": "kubernetes audit logs themselves",
    "start": "384199",
    "end": "388720"
  },
  {
    "text": "so uh starting with our overview right",
    "start": "391960",
    "end": "394039"
  },
  {
    "text": "we'll we'll start with cist calls first",
    "start": "394039",
    "end": "395560"
  },
  {
    "text": "but the easiest way from a capability",
    "start": "395560",
    "end": "397280"
  },
  {
    "text": "standpoint to explain what you know like",
    "start": "397280",
    "end": "399080"
  },
  {
    "text": "a runtime threat detection tool or",
    "start": "399080",
    "end": "401000"
  },
  {
    "text": "something that observe CIS calls",
    "start": "401000",
    "end": "402160"
  },
  {
    "text": "provides to us is that what's going on",
    "start": "402160",
    "end": "404080"
  },
  {
    "text": "in my containers why is my container",
    "start": "404080",
    "end": "406160"
  },
  {
    "text": "suddenly reaching out to pool. miner.",
    "start": "406160",
    "end": "408599"
  },
  {
    "text": "XMR whatever right um and the easiest",
    "start": "408599",
    "end": "412599"
  },
  {
    "text": "example that I threw up here and is you",
    "start": "412599",
    "end": "414720"
  },
  {
    "text": "know if I were to foolishly as an",
    "start": "414720",
    "end": "416960"
  },
  {
    "text": "attacker on this netcat command to",
    "start": "416960",
    "end": "419120"
  },
  {
    "text": "connect back to my obviously not evil C2",
    "start": "419120",
    "end": "423120"
  },
  {
    "text": "server uh we could observe the actual OS",
    "start": "423120",
    "end": "427199"
  },
  {
    "text": "level activity that's going under by",
    "start": "427199",
    "end": "428840"
  },
  {
    "text": "looking at the CIS calls that it's",
    "start": "428840",
    "end": "430039"
  },
  {
    "text": "making uh this is obviously a greatly",
    "start": "430039",
    "end": "432319"
  },
  {
    "text": "abbreviated list if you've recently ran",
    "start": "432319",
    "end": "434039"
  },
  {
    "text": "s trce on that cat so uh don't hold me",
    "start": "434039",
    "end": "436360"
  },
  {
    "text": "to that but uh from a detection",
    "start": "436360",
    "end": "438840"
  },
  {
    "text": "engineering standpoint you're usually",
    "start": "438840",
    "end": "441199"
  },
  {
    "text": "not directly interfacing with CIS calls",
    "start": "441199",
    "end": "443120"
  },
  {
    "text": "the reality is like if you're a",
    "start": "443120",
    "end": "444319"
  },
  {
    "text": "practitioner at a company implementing",
    "start": "444319",
    "end": "445680"
  },
  {
    "text": "this stuff you probably don't have time",
    "start": "445680",
    "end": "447080"
  },
  {
    "text": "and if you do you're probably a",
    "start": "447080",
    "end": "448720"
  },
  {
    "text": "contributor to one of these awesome",
    "start": "448720",
    "end": "450000"
  },
  {
    "text": "projects right um that said you know",
    "start": "450000",
    "end": "453039"
  },
  {
    "text": "even though we're consuming existing",
    "start": "453039",
    "end": "454280"
  },
  {
    "text": "tools uh the reality is that there's",
    "start": "454280",
    "end": "456440"
  },
  {
    "text": "still detection engineering work that",
    "start": "456440",
    "end": "458360"
  },
  {
    "text": "actually has to happen right you don't",
    "start": "458360",
    "end": "460160"
  },
  {
    "text": "just throw a tool in your environment",
    "start": "460160",
    "end": "461639"
  },
  {
    "text": "and suddenly all your runtime security",
    "start": "461639",
    "end": "463360"
  },
  {
    "text": "woes are solved right uh those tools you",
    "start": "463360",
    "end": "466199"
  },
  {
    "text": "know especially runtime security tools",
    "start": "466199",
    "end": "467400"
  },
  {
    "text": "typically lack the context of where that",
    "start": "467400",
    "end": "469560"
  },
  {
    "text": "container is running what's running on",
    "start": "469560",
    "end": "471440"
  },
  {
    "text": "it right who deployed it who owns it and",
    "start": "471440",
    "end": "474720"
  },
  {
    "text": "on top of that those alerts that get",
    "start": "474720",
    "end": "476280"
  },
  {
    "text": "generated they have to be properly",
    "start": "476280",
    "end": "478039"
  },
  {
    "text": "prioritized they have to be routed to",
    "start": "478039",
    "end": "480120"
  },
  {
    "text": "the person that can actually do",
    "start": "480120",
    "end": "481120"
  },
  {
    "text": "something about that and depending on",
    "start": "481120",
    "end": "482759"
  },
  {
    "text": "what type of company or organization you",
    "start": "482759",
    "end": "484159"
  },
  {
    "text": "work at that answer is going to be",
    "start": "484159",
    "end": "485440"
  },
  {
    "text": "different right you know at a larger",
    "start": "485440",
    "end": "487520"
  },
  {
    "text": "Enterprise it might be your sock um you",
    "start": "487520",
    "end": "490000"
  },
  {
    "text": "know at a more Cloud native organization",
    "start": "490000",
    "end": "491599"
  },
  {
    "text": "you might have like a cloud engineering",
    "start": "491599",
    "end": "492919"
  },
  {
    "text": "team or an Sr team that actually owns",
    "start": "492919",
    "end": "494479"
  },
  {
    "text": "that capability right uh the other thing",
    "start": "494479",
    "end": "497319"
  },
  {
    "text": "too and speaking from experience on",
    "start": "497319",
    "end": "498960"
  },
  {
    "text": "implementing these they're just by",
    "start": "498960",
    "end": "500280"
  },
  {
    "text": "Nature noisy and they have to be because",
    "start": "500280",
    "end": "502400"
  },
  {
    "text": "they have the bias towards you know",
    "start": "502400",
    "end": "504319"
  },
  {
    "text": "alerting on something that might be",
    "start": "504319",
    "end": "505280"
  },
  {
    "text": "potentially malicious right so there's a",
    "start": "505280",
    "end": "506919"
  },
  {
    "text": "lot of effort that goes into like tuning",
    "start": "506919",
    "end": "508280"
  },
  {
    "text": "those rule sets um you know one common",
    "start": "508280",
    "end": "510599"
  },
  {
    "text": "example that I've dealt with is that we",
    "start": "510599",
    "end": "512200"
  },
  {
    "text": "would instrument these on clusters and",
    "start": "512200",
    "end": "513680"
  },
  {
    "text": "we would have clusters that would run",
    "start": "513680",
    "end": "515240"
  },
  {
    "text": "both uh built applications and CI",
    "start": "515240",
    "end": "518518"
  },
  {
    "text": "pipeline jobs for building those",
    "start": "518519",
    "end": "519919"
  },
  {
    "text": "applications and the the reality is the",
    "start": "519919",
    "end": "521880"
  },
  {
    "text": "runtime activity uh between those things",
    "start": "521880",
    "end": "523839"
  },
  {
    "text": "is very very different one is running a",
    "start": "523839",
    "end": "526200"
  },
  {
    "text": "you know compiled binary with a",
    "start": "526200",
    "end": "528120"
  },
  {
    "text": "hopefully I shouldn't say super static",
    "start": "528120",
    "end": "529959"
  },
  {
    "text": "depends on what your application's doing",
    "start": "529959",
    "end": "531080"
  },
  {
    "text": "but relatively static set of behaviors",
    "start": "531080",
    "end": "533560"
  },
  {
    "text": "the other is reaching out to",
    "start": "533560",
    "end": "534959"
  },
  {
    "text": "repositories pulling down artifacts",
    "start": "534959",
    "end": "536600"
  },
  {
    "text": "compiling files and uh the same rule set",
    "start": "536600",
    "end": "539640"
  },
  {
    "text": "don't run nicely on those",
    "start": "539640",
    "end": "541640"
  },
  {
    "text": "right uh the other strategy I've kind of",
    "start": "541640",
    "end": "544160"
  },
  {
    "text": "seen success with and you know you have",
    "start": "544160",
    "end": "545640"
  },
  {
    "text": "to have a SIM that's capable of",
    "start": "545640",
    "end": "546760"
  },
  {
    "text": "supporting this type of activity is",
    "start": "546760",
    "end": "548079"
  },
  {
    "text": "instead of doing one forone alerting on",
    "start": "548079",
    "end": "550000"
  },
  {
    "text": "these types of alerts you would try to",
    "start": "550000",
    "end": "552040"
  },
  {
    "text": "Cluster them whether that's you know by",
    "start": "552040",
    "end": "553959"
  },
  {
    "text": "pod by names Space by time span and",
    "start": "553959",
    "end": "557320"
  },
  {
    "text": "alert if you know the number of alerts",
    "start": "557320",
    "end": "559880"
  },
  {
    "text": "or findings breaches a certain threshold",
    "start": "559880",
    "end": "562360"
  },
  {
    "text": "or you could go a risk-based alerting",
    "start": "562360",
    "end": "564040"
  },
  {
    "text": "type of Route if it matches a certain",
    "start": "564040",
    "end": "565760"
  },
  {
    "text": "pattern of activity like certain parts",
    "start": "565760",
    "end": "567360"
  },
  {
    "text": "of the killchain",
    "start": "567360",
    "end": "570560"
  },
  {
    "text": "so enough about CIS calls it's time to",
    "start": "572600",
    "end": "574720"
  },
  {
    "text": "talk about audit logs right so kuber's",
    "start": "574720",
    "end": "577440"
  },
  {
    "text": "Auto logs are basically just recording",
    "start": "577440",
    "end": "580160"
  },
  {
    "text": "of your interactions with the control",
    "start": "580160",
    "end": "581440"
  },
  {
    "text": "plane so when you're you know applying a",
    "start": "581440",
    "end": "583000"
  },
  {
    "text": "manifest you're hitting the API server",
    "start": "583000",
    "end": "585440"
  },
  {
    "text": "you're creating reading updating and",
    "start": "585440",
    "end": "587120"
  },
  {
    "text": "deleting resources",
    "start": "587120",
    "end": "589800"
  },
  {
    "text": "right so one thing to note and a lot of",
    "start": "589800",
    "end": "592680"
  },
  {
    "text": "this is dependent on you know what type",
    "start": "592680",
    "end": "594040"
  },
  {
    "text": "of kubernetes cluster you're running",
    "start": "594040",
    "end": "595320"
  },
  {
    "text": "whether you're running your own you're",
    "start": "595320",
    "end": "596320"
  },
  {
    "text": "running you know a cloud service",
    "start": "596320",
    "end": "598720"
  },
  {
    "text": "provider manager offering but these are",
    "start": "598720",
    "end": "601600"
  },
  {
    "text": "not on by default uh there's the lovely",
    "start": "601600",
    "end": "604720"
  },
  {
    "text": "little picture you're looking at here is",
    "start": "604720",
    "end": "605839"
  },
  {
    "text": "called an audit policy and this actually",
    "start": "605839",
    "end": "608279"
  },
  {
    "text": "one has to be turned on Via an API",
    "start": "608279",
    "end": "610240"
  },
  {
    "text": "server flag and then two specified um",
    "start": "610240",
    "end": "613880"
  },
  {
    "text": "with the audit policy of what you want",
    "start": "613880",
    "end": "616480"
  },
  {
    "text": "to log and how much detail you want to",
    "start": "616480",
    "end": "618839"
  },
  {
    "text": "log it out at right and you know I'll",
    "start": "618839",
    "end": "621480"
  },
  {
    "text": "spend a second talking about this in a",
    "start": "621480",
    "end": "622760"
  },
  {
    "text": "little more detail there's really kind",
    "start": "622760",
    "end": "625000"
  },
  {
    "text": "of two I would say parameters that you",
    "start": "625000",
    "end": "628160"
  },
  {
    "text": "definitely want to know and understand",
    "start": "628160",
    "end": "629399"
  },
  {
    "text": "from this um if not becoming you know a",
    "start": "629399",
    "end": "631360"
  },
  {
    "text": "full expert on audit log policy and the",
    "start": "631360",
    "end": "633959"
  },
  {
    "text": "first is log level right so there's",
    "start": "633959",
    "end": "637720"
  },
  {
    "text": "three log levels there's",
    "start": "637720",
    "end": "640160"
  },
  {
    "text": "metadata request and request response",
    "start": "640160",
    "end": "644000"
  },
  {
    "text": "and you know basically if I have a rule",
    "start": "644000",
    "end": "645800"
  },
  {
    "text": "in this audit log policy that that log",
    "start": "645800",
    "end": "648760"
  },
  {
    "text": "level will indicate how much information",
    "start": "648760",
    "end": "650760"
  },
  {
    "text": "I get on that request being made so if I",
    "start": "650760",
    "end": "653279"
  },
  {
    "text": "have only a log level of metadata I'm",
    "start": "653279",
    "end": "655560"
  },
  {
    "text": "only going to see the API call that was",
    "start": "655560",
    "end": "658000"
  },
  {
    "text": "made whether it was successful",
    "start": "658000",
    "end": "659880"
  },
  {
    "text": "there's some other highle metadata",
    "start": "659880",
    "end": "661279"
  },
  {
    "text": "fields and you know like Source IP and",
    "start": "661279",
    "end": "663279"
  },
  {
    "text": "user identity uh when we start to look",
    "start": "663279",
    "end": "665800"
  },
  {
    "text": "at request and request response that's",
    "start": "665800",
    "end": "667880"
  },
  {
    "text": "where we can see the actual raw API call",
    "start": "667880",
    "end": "670000"
  },
  {
    "text": "that the user passed into the server and",
    "start": "670000",
    "end": "672519"
  },
  {
    "text": "what the what configuration the server",
    "start": "672519",
    "end": "674240"
  },
  {
    "text": "actually",
    "start": "674240",
    "end": "676600"
  },
  {
    "text": "applied uh the next and this one's a",
    "start": "676600",
    "end": "679040"
  },
  {
    "text": "little interesting too is stages so by",
    "start": "679040",
    "end": "682000"
  },
  {
    "text": "default or if you have all these on when",
    "start": "682000",
    "end": "684320"
  },
  {
    "text": "you say if you make a call to the",
    "start": "684320",
    "end": "685720"
  },
  {
    "text": "control plane to create a pod right it's",
    "start": "685720",
    "end": "688040"
  },
  {
    "text": "a single API call",
    "start": "688040",
    "end": "689920"
  },
  {
    "text": "uh if you have all three stages set",
    "start": "689920",
    "end": "692600"
  },
  {
    "text": "you'll actually get either two or three",
    "start": "692600",
    "end": "694160"
  },
  {
    "text": "audit log events for that single call",
    "start": "694160",
    "end": "696760"
  },
  {
    "text": "because there's there's basically three",
    "start": "696760",
    "end": "698839"
  },
  {
    "text": "stages there's request received response",
    "start": "698839",
    "end": "700560"
  },
  {
    "text": "started which I believe only replies to",
    "start": "700560",
    "end": "703440"
  },
  {
    "text": "um watch actions and then response",
    "start": "703440",
    "end": "705920"
  },
  {
    "text": "complete um so you run the risk of",
    "start": "705920",
    "end": "708639"
  },
  {
    "text": "potentially you know doubling or",
    "start": "708639",
    "end": "709920"
  },
  {
    "text": "tripling your log volume which if you're",
    "start": "709920",
    "end": "712480"
  },
  {
    "text": "paying for your sim vendor uh you know I",
    "start": "712480",
    "end": "715120"
  },
  {
    "text": "know some of us have seen those ingest",
    "start": "715120",
    "end": "716720"
  },
  {
    "text": "bills they're expensive right and uh in",
    "start": "716720",
    "end": "719760"
  },
  {
    "text": "a couple slides later I'll talk about",
    "start": "719760",
    "end": "721320"
  },
  {
    "text": "which one has the most security",
    "start": "721320",
    "end": "723600"
  },
  {
    "text": "value and then finally because this is a",
    "start": "723600",
    "end": "725880"
  },
  {
    "text": "security talk and I I just felt the need",
    "start": "725880",
    "end": "727120"
  },
  {
    "text": "to mention it you can actually",
    "start": "727120",
    "end": "728680"
  },
  {
    "text": "accidentally configure this to log",
    "start": "728680",
    "end": "730200"
  },
  {
    "text": "sensitive values so think about your",
    "start": "730200",
    "end": "732320"
  },
  {
    "text": "resource types like your secrets your",
    "start": "732320",
    "end": "734199"
  },
  {
    "text": "config Maps which hopefully don't have",
    "start": "734199",
    "end": "735880"
  },
  {
    "text": "secrets in there or even if you have",
    "start": "735880",
    "end": "737360"
  },
  {
    "text": "custom resource definitions that have",
    "start": "737360",
    "end": "739199"
  },
  {
    "text": "certain sensitive properties if you've",
    "start": "739199",
    "end": "741279"
  },
  {
    "text": "configured them to log their full",
    "start": "741279",
    "end": "743399"
  },
  {
    "text": "request that'll actually be reflected in",
    "start": "743399",
    "end": "745360"
  },
  {
    "text": "your logs right um in a good example if",
    "start": "745360",
    "end": "747480"
  },
  {
    "text": "you look at the manage Cloud providers",
    "start": "747480",
    "end": "748959"
  },
  {
    "text": "they",
    "start": "748959",
    "end": "749959"
  },
  {
    "text": "you can't control this on your own um",
    "start": "749959",
    "end": "752519"
  },
  {
    "text": "but they provide the audit log policy",
    "start": "752519",
    "end": "754199"
  },
  {
    "text": "they provide or that they configure for",
    "start": "754199",
    "end": "756000"
  },
  {
    "text": "you and you can see that they've",
    "start": "756000",
    "end": "756959"
  },
  {
    "text": "Exempted those",
    "start": "756959",
    "end": "759600"
  },
  {
    "text": "out all right I promised logs so um",
    "start": "760360",
    "end": "764680"
  },
  {
    "text": "we're just going to you know I'm not",
    "start": "764680",
    "end": "765519"
  },
  {
    "text": "going to go through every single field",
    "start": "765519",
    "end": "766800"
  },
  {
    "text": "right but we have to look at you know an",
    "start": "766800",
    "end": "768639"
  },
  {
    "text": "example of an autog and we'll just look",
    "start": "768639",
    "end": "770040"
  },
  {
    "text": "at the high level pieces of information",
    "start": "770040",
    "end": "771519"
  },
  {
    "text": "we can get out of this and where we can",
    "start": "771519",
    "end": "772760"
  },
  {
    "text": "find",
    "start": "772760",
    "end": "774440"
  },
  {
    "text": "it so the first is those metadata Fields",
    "start": "774440",
    "end": "777240"
  },
  {
    "text": "I was talking about right um",
    "start": "777240",
    "end": "779639"
  },
  {
    "text": "you know at a high level there's",
    "start": "779639",
    "end": "781160"
  },
  {
    "text": "basically the what log level and what",
    "start": "781160",
    "end": "783160"
  },
  {
    "text": "stage this request was made at there's",
    "start": "783160",
    "end": "785959"
  },
  {
    "text": "an audit ID which really is useful from",
    "start": "785959",
    "end": "788839"
  },
  {
    "text": "a like a troubleshooting perspective",
    "start": "788839",
    "end": "790639"
  },
  {
    "text": "like if you're trying to figure out",
    "start": "790639",
    "end": "791800"
  },
  {
    "text": "where an event went where before it got",
    "start": "791800",
    "end": "793279"
  },
  {
    "text": "to your sim you could technically query",
    "start": "793279",
    "end": "795279"
  },
  {
    "text": "that same ID before it made it",
    "start": "795279",
    "end": "797079"
  },
  {
    "text": "Downstream and then there's request URI",
    "start": "797079",
    "end": "799560"
  },
  {
    "text": "and verb right which is the actual API",
    "start": "799560",
    "end": "801240"
  },
  {
    "text": "call you made and the method you Ed to",
    "start": "801240",
    "end": "802639"
  },
  {
    "text": "make",
    "start": "802639",
    "end": "804800"
  },
  {
    "text": "it the next is you know who made this",
    "start": "805240",
    "end": "808040"
  },
  {
    "text": "request and how did they they make it",
    "start": "808040",
    "end": "809600"
  },
  {
    "text": "right so there's a user key field that",
    "start": "809600",
    "end": "811639"
  },
  {
    "text": "actually uh tells us you know what",
    "start": "811639",
    "end": "813760"
  },
  {
    "text": "authenticated principle made this",
    "start": "813760",
    "end": "815040"
  },
  {
    "text": "request um and there'll be some",
    "start": "815040",
    "end": "816360"
  },
  {
    "text": "information about what groups they're a",
    "start": "816360",
    "end": "817600"
  },
  {
    "text": "part of what permissions they have or",
    "start": "817600",
    "end": "819000"
  },
  {
    "text": "you know maybe they're an",
    "start": "819000",
    "end": "819720"
  },
  {
    "text": "unauthenticated user um hopefully we",
    "start": "819720",
    "end": "821639"
  },
  {
    "text": "didn't accidentally expose our control",
    "start": "821639",
    "end": "822880"
  },
  {
    "text": "plan to the internet but you know",
    "start": "822880",
    "end": "824279"
  },
  {
    "text": "stranger things have happened uh you",
    "start": "824279",
    "end": "827440"
  },
  {
    "text": "you'll also see that there is the IP",
    "start": "827440",
    "end": "829480"
  },
  {
    "text": "address field and the user agent field",
    "start": "829480",
    "end": "831480"
  },
  {
    "text": "which gives you information about where",
    "start": "831480",
    "end": "832639"
  },
  {
    "text": "they're making the call from right is it",
    "start": "832639",
    "end": "834440"
  },
  {
    "text": "coming from in your cluster is it coming",
    "start": "834440",
    "end": "836120"
  },
  {
    "text": "from a developer workstation somewhere",
    "start": "836120",
    "end": "838000"
  },
  {
    "text": "out on the internet and",
    "start": "838000",
    "end": "839959"
  },
  {
    "text": "if it's not a malicious request you can",
    "start": "839959",
    "end": "841959"
  },
  {
    "text": "kind of glean how they're making that",
    "start": "841959",
    "end": "843480"
  },
  {
    "text": "call and the user agent in this case",
    "start": "843480",
    "end": "844959"
  },
  {
    "text": "there's a really outdated version of",
    "start": "844959",
    "end": "846680"
  },
  {
    "text": "cctl but you know maybe they're using",
    "start": "846680",
    "end": "848560"
  },
  {
    "text": "terraform or the",
    "start": "848560",
    "end": "851639"
  },
  {
    "text": "GDK um on any request we can see what",
    "start": "852399",
    "end": "855240"
  },
  {
    "text": "resource this request is particularly",
    "start": "855240",
    "end": "856720"
  },
  {
    "text": "targeting with the object ref",
    "start": "856720",
    "end": "859879"
  },
  {
    "text": "field um was it successful what status",
    "start": "861360",
    "end": "863680"
  },
  {
    "text": "code got actually returned from the",
    "start": "863680",
    "end": "864759"
  },
  {
    "text": "server which is important right because",
    "start": "864759",
    "end": "866160"
  },
  {
    "text": "we can write detections on you know if",
    "start": "866160",
    "end": "867560"
  },
  {
    "text": "there's a bunch of failed or",
    "start": "867560",
    "end": "868440"
  },
  {
    "text": "unauthorized calls right that might tell",
    "start": "868440",
    "end": "870160"
  },
  {
    "text": "us that somebody's trying to Brute Force",
    "start": "870160",
    "end": "873319"
  },
  {
    "text": "permissions and this one kind of ties",
    "start": "875360",
    "end": "878000"
  },
  {
    "text": "back to when I was talking about logging",
    "start": "878000",
    "end": "879560"
  },
  {
    "text": "levels where you have request and",
    "start": "879560",
    "end": "880800"
  },
  {
    "text": "request response this is actually where",
    "start": "880800",
    "end": "883320"
  },
  {
    "text": "we would see the raw request so in this",
    "start": "883320",
    "end": "885639"
  },
  {
    "text": "case this is a request for creating a",
    "start": "885639",
    "end": "887440"
  },
  {
    "text": "you know if this was a request for",
    "start": "887440",
    "end": "888759"
  },
  {
    "text": "creating a pod we could actually see the",
    "start": "888759",
    "end": "890360"
  },
  {
    "text": "full manifest of that pod reflected in",
    "start": "890360",
    "end": "892040"
  },
  {
    "text": "this and then under the response we can",
    "start": "892040",
    "end": "894480"
  },
  {
    "text": "see what the server actually applied",
    "start": "894480",
    "end": "898880"
  },
  {
    "text": "uh time stamps right you know knowing",
    "start": "899240",
    "end": "900920"
  },
  {
    "text": "when a request was made is pretty",
    "start": "900920",
    "end": "902120"
  },
  {
    "text": "important to like a security",
    "start": "902120",
    "end": "903800"
  },
  {
    "text": "investigation or",
    "start": "903800",
    "end": "905880"
  },
  {
    "text": "detection and finally you know if you're",
    "start": "905880",
    "end": "908440"
  },
  {
    "text": "using things like admission controllers",
    "start": "908440",
    "end": "910480"
  },
  {
    "text": "right they can actually add annotations",
    "start": "910480",
    "end": "912079"
  },
  {
    "text": "to requests you know if they modified",
    "start": "912079",
    "end": "914279"
  },
  {
    "text": "something or denied it out right um",
    "start": "914279",
    "end": "916399"
  },
  {
    "text": "which you know this is kind of",
    "start": "916399",
    "end": "917519"
  },
  {
    "text": "environment dependent but it's helpful",
    "start": "917519",
    "end": "920959"
  },
  {
    "text": "context so just kind of some high level",
    "start": "923720",
    "end": "926240"
  },
  {
    "text": "notes on audit logs and dealing with",
    "start": "926240",
    "end": "927920"
  },
  {
    "text": "audit logs in the first thing is out of",
    "start": "927920",
    "end": "929800"
  },
  {
    "text": "the box they they just generate a lot of",
    "start": "929800",
    "end": "931440"
  },
  {
    "text": "volume and the reason is is that you",
    "start": "931440",
    "end": "934079"
  },
  {
    "text": "know a lot of the internal kuber",
    "start": "934079",
    "end": "935759"
  },
  {
    "text": "controllers they they call the control",
    "start": "935759",
    "end": "937360"
  },
  {
    "text": "plane API right so it's generating noise",
    "start": "937360",
    "end": "940240"
  },
  {
    "text": "and that that tends to be useful for",
    "start": "940240",
    "end": "942199"
  },
  {
    "text": "like a debugging or you know if you're",
    "start": "942199",
    "end": "943600"
  },
  {
    "text": "building a feature on kubernetes",
    "start": "943600",
    "end": "944720"
  },
  {
    "text": "perspective but if you're trying to",
    "start": "944720",
    "end": "946360"
  },
  {
    "text": "detect just general malicious activity a",
    "start": "946360",
    "end": "948759"
  },
  {
    "text": "lot of times it's just extra noise and",
    "start": "948759",
    "end": "950240"
  },
  {
    "text": "volume Downstream for your sim or your",
    "start": "950240",
    "end": "952040"
  },
  {
    "text": "data lake or wherever you're sending",
    "start": "952040",
    "end": "953199"
  },
  {
    "text": "this to right uh the next thing is when",
    "start": "953199",
    "end": "955880"
  },
  {
    "text": "I was talking about stages and which one",
    "start": "955880",
    "end": "957079"
  },
  {
    "text": "is the most valuable from a security",
    "start": "957079",
    "end": "958360"
  },
  {
    "text": "perspective uh you know throughout the",
    "start": "958360",
    "end": "960040"
  },
  {
    "text": "process of doing all this and you know",
    "start": "960040",
    "end": "961319"
  },
  {
    "text": "building detections and all that stuff I",
    "start": "961319",
    "end": "962639"
  },
  {
    "text": "found really request complete uh",
    "start": "962639",
    "end": "964680"
  },
  {
    "text": "provides you what you need uh and the",
    "start": "964680",
    "end": "967040"
  },
  {
    "text": "reason being is you know request",
    "start": "967040",
    "end": "968360"
  },
  {
    "text": "received and response started again I",
    "start": "968360",
    "end": "970279"
  },
  {
    "text": "think it's the same kind of idea that if",
    "start": "970279",
    "end": "971880"
  },
  {
    "text": "you're developing functionality for",
    "start": "971880",
    "end": "973920"
  },
  {
    "text": "kubernetes it's great to be able to see",
    "start": "973920",
    "end": "975639"
  },
  {
    "text": "if the request got fully processed but",
    "start": "975639",
    "end": "977600"
  },
  {
    "text": "from a detection standpoint we still get",
    "start": "977600",
    "end": "980279"
  },
  {
    "text": "whether you know that request was a 401",
    "start": "980279",
    "end": "982199"
  },
  {
    "text": "instead of a 200 um we also get the",
    "start": "982199",
    "end": "984560"
  },
  {
    "text": "original time the request was remade",
    "start": "984560",
    "end": "986279"
  },
  {
    "text": "with the uh request received time stamp",
    "start": "986279",
    "end": "988600"
  },
  {
    "text": "field even in the response complete",
    "start": "988600",
    "end": "991160"
  },
  {
    "text": "stage and you know finally right",
    "start": "991160",
    "end": "993360"
  },
  {
    "text": "depending on where you're running",
    "start": "993360",
    "end": "994240"
  },
  {
    "text": "kubernetes you have to understand that",
    "start": "994240",
    "end": "995360"
  },
  {
    "text": "you might not control the audit policy",
    "start": "995360",
    "end": "997399"
  },
  {
    "text": "so when you're going to build these",
    "start": "997399",
    "end": "998600"
  },
  {
    "text": "detections for this activity you can go",
    "start": "998600",
    "end": "1000480"
  },
  {
    "text": "look at the audit policy that's being",
    "start": "1000480",
    "end": "1001639"
  },
  {
    "text": "applied by your cloud service provider",
    "start": "1001639",
    "end": "1003480"
  },
  {
    "text": "and you know understand if the thing you",
    "start": "1003480",
    "end": "1005279"
  },
  {
    "text": "want to detect is going to be logged in",
    "start": "1005279",
    "end": "1006600"
  },
  {
    "text": "the first",
    "start": "1006600",
    "end": "1008959"
  },
  {
    "text": "place all right um so now we're going to",
    "start": "1010680",
    "end": "1013240"
  },
  {
    "text": "talk about you know how to get started",
    "start": "1013240",
    "end": "1014440"
  },
  {
    "text": "generating detection cases right and I",
    "start": "1014440",
    "end": "1017880"
  },
  {
    "text": "think the first and probably the most",
    "start": "1017880",
    "end": "1019360"
  },
  {
    "text": "important kind of step to getting",
    "start": "1019360",
    "end": "1021399"
  },
  {
    "text": "started in this is understanding the",
    "start": "1021399",
    "end": "1023800"
  },
  {
    "text": "Norms of your environment right I think",
    "start": "1023800",
    "end": "1025319"
  },
  {
    "text": "this goes further than you know anything",
    "start": "1025319",
    "end": "1027798"
  },
  {
    "text": "then minor attack then pretty much any",
    "start": "1027799",
    "end": "1030720"
  },
  {
    "text": "framework out there right like you have",
    "start": "1030720",
    "end": "1032280"
  },
  {
    "text": "to ask what's normal in my environment",
    "start": "1032280",
    "end": "1033720"
  },
  {
    "text": "how do we deploy do we use get Ops into",
    "start": "1033720",
    "end": "1036000"
  },
  {
    "text": "to end do people just C CTL ply f is it",
    "start": "1036000",
    "end": "1039280"
  },
  {
    "text": "something in between right um you know",
    "start": "1039280",
    "end": "1042160"
  },
  {
    "text": "how do we organize our expression of the",
    "start": "1042160",
    "end": "1043760"
  },
  {
    "text": "software development life cycle where's",
    "start": "1043760",
    "end": "1045120"
  },
  {
    "text": "our production",
    "start": "1045120",
    "end": "1047079"
  },
  {
    "text": "environment uh what tools do we use to",
    "start": "1047079",
    "end": "1049120"
  },
  {
    "text": "do all that right you know like that's",
    "start": "1049120",
    "end": "1050760"
  },
  {
    "text": "any deviation from that is definitely",
    "start": "1050760",
    "end": "1052600"
  },
  {
    "text": "like potentially a cause for concern and",
    "start": "1052600",
    "end": "1055200"
  },
  {
    "text": "you know just how do we organize our",
    "start": "1055200",
    "end": "1056760"
  },
  {
    "text": "environment how do we organize our name",
    "start": "1056760",
    "end": "1058000"
  },
  {
    "text": "spaces what gets its own cluster does",
    "start": "1058000",
    "end": "1059919"
  },
  {
    "text": "everything get its own cloud account and",
    "start": "1059919",
    "end": "1062080"
  },
  {
    "text": "the thing that's really interesting",
    "start": "1062080",
    "end": "1063000"
  },
  {
    "text": "about knowing all this stuff is not only",
    "start": "1063000",
    "end": "1065320"
  },
  {
    "text": "can you use this as context to uh",
    "start": "1065320",
    "end": "1067760"
  },
  {
    "text": "augment your more kind of threat",
    "start": "1067760",
    "end": "1069160"
  },
  {
    "text": "detection type rules you can also",
    "start": "1069160",
    "end": "1072280"
  },
  {
    "text": "develop rules off of these things and",
    "start": "1072280",
    "end": "1074559"
  },
  {
    "text": "deviations off of these things which",
    "start": "1074559",
    "end": "1075840"
  },
  {
    "text": "might clue you into something that's",
    "start": "1075840",
    "end": "1077720"
  },
  {
    "text": "kind of strange",
    "start": "1077720",
    "end": "1080840"
  },
  {
    "text": "uh the next thing that I'd recommend",
    "start": "1081240",
    "end": "1082520"
  },
  {
    "text": "looking at is uh offensive tooling",
    "start": "1082520",
    "end": "1084360"
  },
  {
    "text": "that's out there right so um two",
    "start": "1084360",
    "end": "1087000"
  },
  {
    "text": "examples that I love to point to because",
    "start": "1087000",
    "end": "1088360"
  },
  {
    "text": "they're specifically adversary emulation",
    "start": "1088360",
    "end": "1090039"
  },
  {
    "text": "tools which means they're um basically",
    "start": "1090039",
    "end": "1092799"
  },
  {
    "text": "incorporating those ttps I mentioned are",
    "start": "1092799",
    "end": "1095080"
  },
  {
    "text": "you know Stratus red team which actually",
    "start": "1095080",
    "end": "1096679"
  },
  {
    "text": "has a module for kubernetes and",
    "start": "1096679",
    "end": "1099159"
  },
  {
    "text": "kubernetes tactics uh and then you have",
    "start": "1099159",
    "end": "1101960"
  },
  {
    "text": "Atomic red team which is really meant",
    "start": "1101960",
    "end": "1103760"
  },
  {
    "text": "more at the OS layer but it's great for",
    "start": "1103760",
    "end": "1105559"
  },
  {
    "text": "if you want to emulate you know",
    "start": "1105559",
    "end": "1106520"
  },
  {
    "text": "container level ttps and detections for",
    "start": "1106520",
    "end": "1108440"
  },
  {
    "text": "those right",
    "start": "1108440",
    "end": "1110039"
  },
  {
    "text": "the next two are more uh pin testing",
    "start": "1110039",
    "end": "1111960"
  },
  {
    "text": "tools and the difference is is that a",
    "start": "1111960",
    "end": "1113280"
  },
  {
    "text": "lot of times in detection engineering",
    "start": "1113280",
    "end": "1114799"
  },
  {
    "text": "people want to bias towards what's been",
    "start": "1114799",
    "end": "1116440"
  },
  {
    "text": "proven to be actually used by",
    "start": "1116440",
    "end": "1117799"
  },
  {
    "text": "adversaries but one challenge I found",
    "start": "1117799",
    "end": "1120400"
  },
  {
    "text": "when you're writing detections for cloud",
    "start": "1120400",
    "end": "1122200"
  },
  {
    "text": "or Cloud native is there's just not a",
    "start": "1122200",
    "end": "1123679"
  },
  {
    "text": "lot of data out there right you know",
    "start": "1123679",
    "end": "1125039"
  },
  {
    "text": "stuff is so new and Cutting Edge that",
    "start": "1125039",
    "end": "1126640"
  },
  {
    "text": "you know I I think there's some value in",
    "start": "1126640",
    "end": "1128679"
  },
  {
    "text": "still looking at even things that might",
    "start": "1128679",
    "end": "1129960"
  },
  {
    "text": "be kind of more pin testing focused and",
    "start": "1129960",
    "end": "1131720"
  },
  {
    "text": "looking at writing detections for those",
    "start": "1131720",
    "end": "1133640"
  },
  {
    "text": "um you know like pyate is a great",
    "start": "1133640",
    "end": "1135400"
  },
  {
    "text": "example where there's a command in there",
    "start": "1135400",
    "end": "1136679"
  },
  {
    "text": "that you can uh run exec on tons of",
    "start": "1136679",
    "end": "1139919"
  },
  {
    "text": "different pods say if you wanted to",
    "start": "1139919",
    "end": "1141120"
  },
  {
    "text": "steal a service account token from 50",
    "start": "1141120",
    "end": "1142720"
  },
  {
    "text": "Pods at once right that's a pretty great",
    "start": "1142720",
    "end": "1144640"
  },
  {
    "text": "detection candidate if you ask",
    "start": "1144640",
    "end": "1147280"
  },
  {
    "text": "me and then finally you know looking at",
    "start": "1147280",
    "end": "1150080"
  },
  {
    "text": "adversary emulation Frameworks for",
    "start": "1150080",
    "end": "1151760"
  },
  {
    "text": "inspiration right not not heat map",
    "start": "1151760",
    "end": "1153360"
  },
  {
    "text": "coverage or anything like that uh mitor",
    "start": "1153360",
    "end": "1155559"
  },
  {
    "text": "attack is a pretty awesome starting",
    "start": "1155559",
    "end": "1157039"
  },
  {
    "text": "point for feeding into detection cases",
    "start": "1157039",
    "end": "1158960"
  },
  {
    "text": "or a threat model um you'll notice I'm",
    "start": "1158960",
    "end": "1161320"
  },
  {
    "text": "mentioning two matrixes here and the",
    "start": "1161320",
    "end": "1163200"
  },
  {
    "text": "goal is not to just say look at all",
    "start": "1163200",
    "end": "1164440"
  },
  {
    "text": "these matrixes but um the Microsoft thre",
    "start": "1164440",
    "end": "1167000"
  },
  {
    "text": "Matrix is really interesting because uh",
    "start": "1167000",
    "end": "1169039"
  },
  {
    "text": "miter attack and the miter attack for",
    "start": "1169039",
    "end": "1170919"
  },
  {
    "text": "containers Matrix was built to",
    "start": "1170919",
    "end": "1172320"
  },
  {
    "text": "accommodate any container orchestration",
    "start": "1172320",
    "end": "1174120"
  },
  {
    "text": "technology so the techniques there can",
    "start": "1174120",
    "end": "1175679"
  },
  {
    "text": "apply to ECS Docker swarm um whatever",
    "start": "1175679",
    "end": "1180080"
  },
  {
    "text": "other container work ISR to right but",
    "start": "1180080",
    "end": "1181640"
  },
  {
    "text": "the U threat Matrix for kubernetes if",
    "start": "1181640",
    "end": "1183919"
  },
  {
    "text": "you go look at it in here almost",
    "start": "1183919",
    "end": "1185320"
  },
  {
    "text": "everybody would probably be familiar",
    "start": "1185320",
    "end": "1186559"
  },
  {
    "text": "with the tactics on there because",
    "start": "1186559",
    "end": "1187600"
  },
  {
    "text": "they're written you know it's like uh",
    "start": "1187600",
    "end": "1189679"
  },
  {
    "text": "hit the secrets API or exec into a pod",
    "start": "1189679",
    "end": "1191960"
  },
  {
    "text": "they're very technology",
    "start": "1191960",
    "end": "1193840"
  },
  {
    "text": "specific then finally you know uh threat",
    "start": "1193840",
    "end": "1196120"
  },
  {
    "text": "modeling your environment and writing up",
    "start": "1196120",
    "end": "1197360"
  },
  {
    "text": "a tag tree specific to your en",
    "start": "1197360",
    "end": "1200640"
  },
  {
    "text": "environment and before we start talking",
    "start": "1201799",
    "end": "1203960"
  },
  {
    "text": "about you know our actual you know log",
    "start": "1203960",
    "end": "1205640"
  },
  {
    "text": "examples and how to detect them and make",
    "start": "1205640",
    "end": "1207039"
  },
  {
    "text": "them better you know I want to talk",
    "start": "1207039",
    "end": "1208640"
  },
  {
    "text": "about common pitfalls as you go through",
    "start": "1208640",
    "end": "1210159"
  },
  {
    "text": "this process of building detections and",
    "start": "1210159",
    "end": "1213159"
  },
  {
    "text": "the first and probably my favorite is we",
    "start": "1213159",
    "end": "1216039"
  },
  {
    "text": "already have a preventive control for",
    "start": "1216039",
    "end": "1217440"
  },
  {
    "text": "this right and my response to that is",
    "start": "1217440",
    "end": "1220039"
  },
  {
    "text": "great this is an amazing detective",
    "start": "1220039",
    "end": "1221760"
  },
  {
    "text": "control because if this ever fires it's",
    "start": "1221760",
    "end": "1223600"
  },
  {
    "text": "going to be really high fidelity because",
    "start": "1223600",
    "end": "1224960"
  },
  {
    "text": "that means something weird is going on",
    "start": "1224960",
    "end": "1226799"
  },
  {
    "text": "either uh our preventive control turned",
    "start": "1226799",
    "end": "1229039"
  },
  {
    "text": "off it's not actually configured the way",
    "start": "1229039",
    "end": "1231000"
  },
  {
    "text": "we thought it is or something strange is",
    "start": "1231000",
    "end": "1233480"
  },
  {
    "text": "going on here right so it's it it's",
    "start": "1233480",
    "end": "1236159"
  },
  {
    "text": "something that happens all the time but",
    "start": "1236159",
    "end": "1237320"
  },
  {
    "text": "I I'm like you need both in reality",
    "start": "1237320",
    "end": "1240200"
  },
  {
    "text": "right the",
    "start": "1240200",
    "end": "1241960"
  },
  {
    "text": "second is and there's some value into",
    "start": "1241960",
    "end": "1245360"
  },
  {
    "text": "thinking from this perspective is that",
    "start": "1245360",
    "end": "1247000"
  },
  {
    "text": "you know an attacker would just do this",
    "start": "1247000",
    "end": "1248520"
  },
  {
    "text": "instead um and and the reality is like a",
    "start": "1248520",
    "end": "1251400"
  },
  {
    "text": "lot of this has to be informed by kind",
    "start": "1251400",
    "end": "1252960"
  },
  {
    "text": "of the threat model and risk posture of",
    "start": "1252960",
    "end": "1254320"
  },
  {
    "text": "your organization you know not everybody",
    "start": "1254320",
    "end": "1255960"
  },
  {
    "text": "is dealing with nation state or AP level",
    "start": "1255960",
    "end": "1258320"
  },
  {
    "text": "threat and even then attacker",
    "start": "1258320",
    "end": "1260559"
  },
  {
    "text": "sophistication varies and attackers make",
    "start": "1260559",
    "end": "1263120"
  },
  {
    "text": "mistakes too right so just because you",
    "start": "1263120",
    "end": "1264640"
  },
  {
    "text": "have a detection that's simplistic in",
    "start": "1264640",
    "end": "1266000"
  },
  {
    "text": "nature and might be able to be",
    "start": "1266000",
    "end": "1267000"
  },
  {
    "text": "circumvented it's not necessarily bad as",
    "start": "1267000",
    "end": "1269280"
  },
  {
    "text": "long as you considered that know",
    "start": "1269280",
    "end": "1272760"
  },
  {
    "text": "that all right um finally we've got our",
    "start": "1275200",
    "end": "1279080"
  },
  {
    "text": "uh detection cases so the the way I",
    "start": "1279080",
    "end": "1281279"
  },
  {
    "text": "formatted these is there's basically",
    "start": "1281279",
    "end": "1283840"
  },
  {
    "text": "just an upfront slide where I'll talk",
    "start": "1283840",
    "end": "1285159"
  },
  {
    "text": "about what the thing is what its",
    "start": "1285159",
    "end": "1286919"
  },
  {
    "text": "legitimate usage is because the is when",
    "start": "1286919",
    "end": "1289120"
  },
  {
    "text": "you're building detections against you",
    "start": "1289120",
    "end": "1291000"
  },
  {
    "text": "know cloud and Cloud Technologies most",
    "start": "1291000",
    "end": "1292679"
  },
  {
    "text": "of the time it's abusing legitimate",
    "start": "1292679",
    "end": "1294200"
  },
  {
    "text": "functionality in unintended ways there's",
    "start": "1294200",
    "end": "1296000"
  },
  {
    "text": "not really secret hidden ways to to do",
    "start": "1296000",
    "end": "1298159"
  },
  {
    "text": "things I mean there are but um so that",
    "start": "1298159",
    "end": "1300640"
  },
  {
    "text": "tends to lead to a lot of false",
    "start": "1300640",
    "end": "1301640"
  },
  {
    "text": "positives right so I'll talk about what",
    "start": "1301640",
    "end": "1303360"
  },
  {
    "text": "its legitimate usage is uh what its",
    "start": "1303360",
    "end": "1305799"
  },
  {
    "text": "attack purposes I'll show a log sample",
    "start": "1305799",
    "end": "1308440"
  },
  {
    "text": "and then we'll talk about um how to",
    "start": "1308440",
    "end": "1310360"
  },
  {
    "text": "detect off that log sample and then also",
    "start": "1310360",
    "end": "1312200"
  },
  {
    "text": "how to uh enrich that so you don't have",
    "start": "1312200",
    "end": "1315080"
  },
  {
    "text": "50 million fast positives from a",
    "start": "1315080",
    "end": "1316520"
  },
  {
    "text": "particular rule so the first um and this",
    "start": "1316520",
    "end": "1319799"
  },
  {
    "text": "is one I I really like because it also",
    "start": "1319799",
    "end": "1322200"
  },
  {
    "text": "serves as kind of an enforcement of like",
    "start": "1322200",
    "end": "1323720"
  },
  {
    "text": "privileged access is uh detecting direct",
    "start": "1323720",
    "end": "1326600"
  },
  {
    "text": "access to production via the exact",
    "start": "1326600",
    "end": "1328480"
  },
  {
    "text": "command so the exact command is just a",
    "start": "1328480",
    "end": "1330320"
  },
  {
    "text": "capability on kubernetes that lets you",
    "start": "1330320",
    "end": "1331840"
  },
  {
    "text": "get a running shell or run a command on",
    "start": "1331840",
    "end": "1333400"
  },
  {
    "text": "a running pot or a container right and",
    "start": "1333400",
    "end": "1335440"
  },
  {
    "text": "it's very common for you know return to",
    "start": "1335440",
    "end": "1337159"
  },
  {
    "text": "service operations or break glass or",
    "start": "1337159",
    "end": "1338880"
  },
  {
    "text": "troubleshooting right you know",
    "start": "1338880",
    "end": "1340159"
  },
  {
    "text": "production's down you need to get in",
    "start": "1340159",
    "end": "1341360"
  },
  {
    "text": "there and look at it um it can also be",
    "start": "1341360",
    "end": "1343279"
  },
  {
    "text": "an anti pattern if somebody's directly",
    "start": "1343279",
    "end": "1344520"
  },
  {
    "text": "changing things and not codifying them",
    "start": "1344520",
    "end": "1346159"
  },
  {
    "text": "right from the attacker perspective it's",
    "start": "1346159",
    "end": "1349240"
  },
  {
    "text": "a great execution or lateral movement",
    "start": "1349240",
    "end": "1351279"
  },
  {
    "text": "tactic in that you know I have",
    "start": "1351279",
    "end": "1353200"
  },
  {
    "text": "kubernetes credentials I want to start",
    "start": "1353200",
    "end": "1354720"
  },
  {
    "text": "interacting with compute layer or I want",
    "start": "1354720",
    "end": "1357600"
  },
  {
    "text": "to look around different containers and",
    "start": "1357600",
    "end": "1358720"
  },
  {
    "text": "see if there's other credentials or",
    "start": "1358720",
    "end": "1359919"
  },
  {
    "text": "other connections I can reach and",
    "start": "1359919",
    "end": "1361000"
  },
  {
    "text": "interact with",
    "start": "1361000",
    "end": "1362520"
  },
  {
    "text": "right so off of the audit log how do we",
    "start": "1362520",
    "end": "1365440"
  },
  {
    "text": "actually detect this right so you're",
    "start": "1365440",
    "end": "1367159"
  },
  {
    "text": "looking at an audit log that's generated",
    "start": "1367159",
    "end": "1368679"
  },
  {
    "text": "from a cctl exec command and the real",
    "start": "1368679",
    "end": "1371200"
  },
  {
    "text": "core thing there is that you'll see that",
    "start": "1371200",
    "end": "1373919"
  },
  {
    "text": "the action that we're taking in the",
    "start": "1373919",
    "end": "1375559"
  },
  {
    "text": "object ref is against the pods resource",
    "start": "1375559",
    "end": "1377760"
  },
  {
    "text": "but there's a sub source of exec right",
    "start": "1377760",
    "end": "1380039"
  },
  {
    "text": "and this is a create verb so we're",
    "start": "1380039",
    "end": "1381400"
  },
  {
    "text": "creating an exec session um the",
    "start": "1381400",
    "end": "1384200"
  },
  {
    "text": "interesting thing about this one is that",
    "start": "1384200",
    "end": "1386760"
  },
  {
    "text": "you can actually and it's not expressed",
    "start": "1386760",
    "end": "1388760"
  },
  {
    "text": "anywhere else in the request except",
    "start": "1388760",
    "end": "1390640"
  },
  {
    "text": "request URI um you can actually get the",
    "start": "1390640",
    "end": "1393000"
  },
  {
    "text": "requ the command that was passed into",
    "start": "1393000",
    "end": "1394960"
  },
  {
    "text": "the request out of there it's if you",
    "start": "1394960",
    "end": "1396360"
  },
  {
    "text": "look really closely it's URL encoded so",
    "start": "1396360",
    "end": "1398400"
  },
  {
    "text": "you can actually see our bin bash in",
    "start": "1398400",
    "end": "1400039"
  },
  {
    "text": "there um and that's like a really",
    "start": "1400039",
    "end": "1402480"
  },
  {
    "text": "valuable and useful piece of context",
    "start": "1402480",
    "end": "1404240"
  },
  {
    "text": "because you know if you see something",
    "start": "1404240",
    "end": "1406000"
  },
  {
    "text": "like cat like a VAR service account",
    "start": "1406000",
    "end": "1408159"
  },
  {
    "text": "token and right that's really strange as",
    "start": "1408159",
    "end": "1410240"
  },
  {
    "text": "opposed to this this is somebody",
    "start": "1410240",
    "end": "1411919"
  },
  {
    "text": "probably logging into troublesho prod",
    "start": "1411919",
    "end": "1414840"
  },
  {
    "text": "right so great we turn this on it's",
    "start": "1414840",
    "end": "1417520"
  },
  {
    "text": "really noisy how do we make it better",
    "start": "1417520",
    "end": "1420240"
  },
  {
    "text": "and you know one of the easiest ways to",
    "start": "1420240",
    "end": "1422320"
  },
  {
    "text": "do this is make your detection rules",
    "start": "1422320",
    "end": "1424880"
  },
  {
    "text": "actually aware of what your production",
    "start": "1424880",
    "end": "1426240"
  },
  {
    "text": "environment is right whether that's a",
    "start": "1426240",
    "end": "1427679"
  },
  {
    "text": "cluster or a cloud account and either",
    "start": "1427679",
    "end": "1430000"
  },
  {
    "text": "down scale or upscale the severity based",
    "start": "1430000",
    "end": "1431559"
  },
  {
    "text": "on that or don't alert right if this is",
    "start": "1431559",
    "end": "1433799"
  },
  {
    "text": "normal activity in",
    "start": "1433799",
    "end": "1435600"
  },
  {
    "text": "Dev and you know on top of that also",
    "start": "1435600",
    "end": "1438240"
  },
  {
    "text": "understanding your access patterns at",
    "start": "1438240",
    "end": "1439240"
  },
  {
    "text": "your or so um one thing we actually did",
    "start": "1439240",
    "end": "1442200"
  },
  {
    "text": "is we baked in context of our on call",
    "start": "1442200",
    "end": "1444880"
  },
  {
    "text": "rotation into our detection rule because",
    "start": "1444880",
    "end": "1447679"
  },
  {
    "text": "you know if there's an active incident",
    "start": "1447679",
    "end": "1449000"
  },
  {
    "text": "and somebody's on call this is probably",
    "start": "1449000",
    "end": "1451159"
  },
  {
    "text": "normal or accepted activity",
    "start": "1451159",
    "end": "1453600"
  },
  {
    "text": "right uh and the other thing you can",
    "start": "1453600",
    "end": "1455400"
  },
  {
    "text": "approach it with is an abnormal rate of",
    "start": "1455400",
    "end": "1457159"
  },
  {
    "text": "the calls right so if this happens you",
    "start": "1457159",
    "end": "1459320"
  },
  {
    "text": "know 500 times in one second that's",
    "start": "1459320",
    "end": "1462520"
  },
  {
    "text": "strange and probably worth a human",
    "start": "1462520",
    "end": "1463880"
  },
  {
    "text": "looking at is a potential indicator of",
    "start": "1463880",
    "end": "1465440"
  },
  {
    "text": "compromise",
    "start": "1465440",
    "end": "1468440"
  },
  {
    "text": "so the next one and this is one probably",
    "start": "1469120",
    "end": "1470880"
  },
  {
    "text": "everybody in the room knows right",
    "start": "1470880",
    "end": "1472279"
  },
  {
    "text": "because it's pretty Infamous is you know",
    "start": "1472279",
    "end": "1473960"
  },
  {
    "text": "launching a privileged container right",
    "start": "1473960",
    "end": "1475960"
  },
  {
    "text": "so in kubernetes uh you can run",
    "start": "1475960",
    "end": "1478720"
  },
  {
    "text": "privileged containers which have access",
    "start": "1478720",
    "end": "1480080"
  },
  {
    "text": "to the underlying capabilities on the",
    "start": "1480080",
    "end": "1481480"
  },
  {
    "text": "Node and um while it's not great there",
    "start": "1481480",
    "end": "1484840"
  },
  {
    "text": "are legitimate use cases for this and",
    "start": "1484840",
    "end": "1487000"
  },
  {
    "text": "ironically there's a lot of runtime",
    "start": "1487000",
    "end": "1488279"
  },
  {
    "text": "security tooling that has a need to do",
    "start": "1488279",
    "end": "1490039"
  },
  {
    "text": "this still today you know to listen to",
    "start": "1490039",
    "end": "1491640"
  },
  {
    "text": "CIS calls on the nodes right um there's",
    "start": "1491640",
    "end": "1494039"
  },
  {
    "text": "also certain workload types that might",
    "start": "1494039",
    "end": "1495480"
  },
  {
    "text": "need it but um it's a very infamous",
    "start": "1495480",
    "end": "1498399"
  },
  {
    "text": "privilege escalation tactic where I as",
    "start": "1498399",
    "end": "1500320"
  },
  {
    "text": "an attacker have a limited set of",
    "start": "1500320",
    "end": "1502320"
  },
  {
    "text": "privileges I find out I'm able to create",
    "start": "1502320",
    "end": "1504000"
  },
  {
    "text": "a container and the privilege flag is",
    "start": "1504000",
    "end": "1506120"
  },
  {
    "text": "uncontrolled to me",
    "start": "1506120",
    "end": "1508760"
  },
  {
    "text": "right um so in this case this is a",
    "start": "1508760",
    "end": "1511960"
  },
  {
    "text": "create pod event and this one is one",
    "start": "1511960",
    "end": "1514440"
  },
  {
    "text": "where you have to actually be logging",
    "start": "1514440",
    "end": "1515679"
  },
  {
    "text": "the full request object to see this and",
    "start": "1515679",
    "end": "1518559"
  },
  {
    "text": "you'll basically see in the request",
    "start": "1518559",
    "end": "1520640"
  },
  {
    "text": "object that there's a field of SEC",
    "start": "1520640",
    "end": "1522919"
  },
  {
    "text": "security context of privileged is true",
    "start": "1522919",
    "end": "1527639"
  },
  {
    "text": "so and this one is pretty near and dear",
    "start": "1529320",
    "end": "1531679"
  },
  {
    "text": "to my heart because this is such a",
    "start": "1531679",
    "end": "1532760"
  },
  {
    "text": "common detection but it's also a common",
    "start": "1532760",
    "end": "1534440"
  },
  {
    "text": "false positive too um filtering out all",
    "start": "1534440",
    "end": "1536600"
  },
  {
    "text": "the noise on it right um the first and",
    "start": "1536600",
    "end": "1539039"
  },
  {
    "text": "easiest way to start to tune this down",
    "start": "1539039",
    "end": "1540559"
  },
  {
    "text": "is to inventory all the tools that you",
    "start": "1540559",
    "end": "1542720"
  },
  {
    "text": "know or images you know absolutely have",
    "start": "1542720",
    "end": "1544720"
  },
  {
    "text": "to need this in your environment right",
    "start": "1544720",
    "end": "1546559"
  },
  {
    "text": "so if you're redeploying a cluster you",
    "start": "1546559",
    "end": "1548200"
  },
  {
    "text": "won't fire this because your chosen",
    "start": "1548200",
    "end": "1550480"
  },
  {
    "text": "runtime security tool is getting",
    "start": "1550480",
    "end": "1551880"
  },
  {
    "text": "redeployed right um also is this a new",
    "start": "1551880",
    "end": "1554880"
  },
  {
    "text": "deployment has this image been deployed",
    "start": "1554880",
    "end": "1556360"
  },
  {
    "text": "with a privilege configuration before",
    "start": "1556360",
    "end": "1559039"
  },
  {
    "text": "um who deployed it right uh that's also",
    "start": "1559039",
    "end": "1561880"
  },
  {
    "text": "uh potential piece of context and um",
    "start": "1561880",
    "end": "1564559"
  },
  {
    "text": "this is one this one's a little harder",
    "start": "1564559",
    "end": "1566679"
  },
  {
    "text": "to do programmatically um that I haven't",
    "start": "1566679",
    "end": "1568960"
  },
  {
    "text": "fully figured out yet but is was it an",
    "start": "1568960",
    "end": "1571080"
  },
  {
    "text": "actual escalation of privilege right",
    "start": "1571080",
    "end": "1573240"
  },
  {
    "text": "because when this is advantageous to an",
    "start": "1573240",
    "end": "1575679"
  },
  {
    "text": "attacker is they have a limited set of",
    "start": "1575679",
    "end": "1578159"
  },
  {
    "text": "Privileges and they want to actually get",
    "start": "1578159",
    "end": "1580600"
  },
  {
    "text": "more right if they're already an admin",
    "start": "1580600",
    "end": "1582080"
  },
  {
    "text": "on the kubernetes cluster and they're",
    "start": "1582080",
    "end": "1583080"
  },
  {
    "text": "creating a privileged pod they're not",
    "start": "1583080",
    "end": "1584159"
  },
  {
    "text": "doing themselves any favors they could",
    "start": "1584159",
    "end": "1585360"
  },
  {
    "text": "just exec into the Container to begin",
    "start": "1585360",
    "end": "1586880"
  },
  {
    "text": "with",
    "start": "1586880",
    "end": "1589880"
  },
  {
    "text": "and last but not least uh retrieving all",
    "start": "1590600",
    "end": "1592760"
  },
  {
    "text": "secrets right so you know we all know",
    "start": "1592760",
    "end": "1594679"
  },
  {
    "text": "the commity secret resource and just a",
    "start": "1594679",
    "end": "1596520"
  },
  {
    "text": "mechanism for providing Secrets objects",
    "start": "1596520",
    "end": "1598480"
  },
  {
    "text": "to your workloads right um but uh it's",
    "start": "1598480",
    "end": "1602039"
  },
  {
    "text": "it's a credential access tactic you know",
    "start": "1602039",
    "end": "1603760"
  },
  {
    "text": "say you've gotten code execution on a",
    "start": "1603760",
    "end": "1605840"
  },
  {
    "text": "pod and you find a service account token",
    "start": "1605840",
    "end": "1608120"
  },
  {
    "text": "this is probably going to be one of the",
    "start": "1608120",
    "end": "1609320"
  },
  {
    "text": "first things you try to see if there's",
    "start": "1609320",
    "end": "1610720"
  },
  {
    "text": "secrets you can",
    "start": "1610720",
    "end": "1613320"
  },
  {
    "text": "access um so this one's a little",
    "start": "1613320",
    "end": "1615240"
  },
  {
    "text": "interesting for me at least me coming",
    "start": "1615240",
    "end": "1616960"
  },
  {
    "text": "from some of the cloud providers uh in",
    "start": "1616960",
    "end": "1619120"
  },
  {
    "text": "that the actual API for looking at the",
    "start": "1619120",
    "end": "1622919"
  },
  {
    "text": "existence of a secret and accessing its",
    "start": "1622919",
    "end": "1625799"
  },
  {
    "text": "value it's the same API right it's all",
    "start": "1625799",
    "end": "1628240"
  },
  {
    "text": "just whether you're getting all the",
    "start": "1628240",
    "end": "1629240"
  },
  {
    "text": "fields or not but the way to detect it",
    "start": "1629240",
    "end": "1631480"
  },
  {
    "text": "is you're doing a list call against",
    "start": "1631480",
    "end": "1633440"
  },
  {
    "text": "secrets and you're not specifying a",
    "start": "1633440",
    "end": "1636960"
  },
  {
    "text": "namespace so great you turn this on and",
    "start": "1638440",
    "end": "1641440"
  },
  {
    "text": "it's this is very noisy without like",
    "start": "1641440",
    "end": "1643279"
  },
  {
    "text": "filtering out or doing anything to you",
    "start": "1643279",
    "end": "1645200"
  },
  {
    "text": "know reduce the noise right and the",
    "start": "1645200",
    "end": "1647480"
  },
  {
    "text": "first thing you have to do is is there's",
    "start": "1647480",
    "end": "1648799"
  },
  {
    "text": "a lot of internal kubernetes components",
    "start": "1648799",
    "end": "1650520"
  },
  {
    "text": "that actually have to watch Secrets",
    "start": "1650520",
    "end": "1651840"
  },
  {
    "text": "because they're secrets that use",
    "start": "1651840",
    "end": "1652640"
  },
  {
    "text": "internally you have to allow list those",
    "start": "1652640",
    "end": "1654720"
  },
  {
    "text": "right um the second thing is",
    "start": "1654720",
    "end": "1657240"
  },
  {
    "text": "constraining it to you know requests",
    "start": "1657240",
    "end": "1659600"
  },
  {
    "text": "that don't specify a specific name space",
    "start": "1659600",
    "end": "1662080"
  },
  {
    "text": "or label selectors because technically",
    "start": "1662080",
    "end": "1664039"
  },
  {
    "text": "you can could specify label selectors",
    "start": "1664039",
    "end": "1665159"
  },
  {
    "text": "and not get the secret",
    "start": "1665159",
    "end": "1666600"
  },
  {
    "text": "value um and then the last one I would",
    "start": "1666600",
    "end": "1669480"
  },
  {
    "text": "say that's really important is is this a",
    "start": "1669480",
    "end": "1671919"
  },
  {
    "text": "human doing this or a workload um and a",
    "start": "1671919",
    "end": "1675159"
  },
  {
    "text": "workload is definitely a much more",
    "start": "1675159",
    "end": "1677279"
  },
  {
    "text": "indicator of compromise because you'll",
    "start": "1677279",
    "end": "1679640"
  },
  {
    "text": "get so much more context say you have a",
    "start": "1679640",
    "end": "1681159"
  },
  {
    "text": "you know an application running as a pod",
    "start": "1681159",
    "end": "1683279"
  },
  {
    "text": "it's had no history of accessing the",
    "start": "1683279",
    "end": "1684840"
  },
  {
    "text": "secrets API there's been no code changes",
    "start": "1684840",
    "end": "1687960"
  },
  {
    "text": "and suddenly it's trying to access the",
    "start": "1687960",
    "end": "1689279"
  },
  {
    "text": "secrets API with you know a 401 or a 403",
    "start": "1689279",
    "end": "1692480"
  },
  {
    "text": "right um definitely kind of you know a",
    "start": "1692480",
    "end": "1695640"
  },
  {
    "text": "red flag from a security",
    "start": "1695640",
    "end": "1698880"
  },
  {
    "text": "perspective all right um that's the talk",
    "start": "1699880",
    "end": "1702640"
  },
  {
    "text": "so if there's anything you take away",
    "start": "1702640",
    "end": "1704320"
  },
  {
    "text": "from this talk I would say you know",
    "start": "1704320",
    "end": "1705720"
  },
  {
    "text": "don't sleep on audit logs for detection",
    "start": "1705720",
    "end": "1707799"
  },
  {
    "text": "use case cases right you know if you're",
    "start": "1707799",
    "end": "1709799"
  },
  {
    "text": "using kubernetes heavily at your",
    "start": "1709799",
    "end": "1711120"
  },
  {
    "text": "organization you know get those logs in",
    "start": "1711120",
    "end": "1713200"
  },
  {
    "text": "you know build useful detections in your",
    "start": "1713200",
    "end": "1714880"
  },
  {
    "text": "backlog and you know the last thing I",
    "start": "1714880",
    "end": "1717159"
  },
  {
    "text": "would say too is all those pieces of",
    "start": "1717159",
    "end": "1719039"
  },
  {
    "text": "context try to bake those into your",
    "start": "1719039",
    "end": "1720480"
  },
  {
    "text": "detections don't make an analyst go and",
    "start": "1720480",
    "end": "1722559"
  },
  {
    "text": "get a rule that fires 50 times a day and",
    "start": "1722559",
    "end": "1724720"
  },
  {
    "text": "then have to go look all this stuff up",
    "start": "1724720",
    "end": "1726000"
  },
  {
    "text": "instead automate it in",
    "start": "1726000",
    "end": "1728600"
  },
  {
    "text": "there um so that's the talk thanks for",
    "start": "1728600",
    "end": "1730880"
  },
  {
    "text": "sticking with me to the end of the day",
    "start": "1730880",
    "end": "1732640"
  },
  {
    "text": "um love to connect you know if you enjoy",
    "start": "1732640",
    "end": "1734279"
  },
  {
    "text": "the talk connect me on LinkedIn I'll be",
    "start": "1734279",
    "end": "1736720"
  },
  {
    "text": "at the happy hour thank you so much",
    "start": "1736720",
    "end": "1740039"
  }
]