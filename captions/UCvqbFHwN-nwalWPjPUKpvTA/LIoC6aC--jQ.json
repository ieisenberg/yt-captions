[
  {
    "text": "hey everybody welcome to Cardenas deep dive and let's dive in so let's take a",
    "start": "60",
    "end": "8760"
  },
  {
    "text": "look at the agenda so basically we want",
    "start": "8760",
    "end": "15719"
  },
  {
    "text": "to get a taste of the plug-in system so what it is about and the different types",
    "start": "15719",
    "end": "21390"
  },
  {
    "text": "of plugins you can basically do then we want to have in the advanced use case and which is called an hidden primary so",
    "start": "21390",
    "end": "29939"
  },
  {
    "text": "we go into basically one of the use cases that can use Cordy and ask for and we have John jump into the code and you",
    "start": "29939",
    "end": "38309"
  },
  {
    "text": "can learn how to write your own plug in for your own specific use case and then we have a small lookout outlook and then",
    "start": "38309",
    "end": "45480"
  },
  {
    "text": "how you can contribute and actually make Cardenas better so who are we",
    "start": "45480",
    "end": "52140"
  },
  {
    "text": "I'm Michael I'm the material or one of the maintainer of core Dinah's I'm the",
    "start": "52140",
    "end": "58440"
  },
  {
    "text": "founder of our collapse which is an open source research lab and also support companies on Google cloud cuban areas",
    "start": "58440",
    "end": "65040"
  },
  {
    "text": "and around Cardenas we're the company record solutions and we have john",
    "start": "65040",
    "end": "70799"
  },
  {
    "text": "polymeric he is a senior staff software engineer and he's also a material at",
    "start": "70799",
    "end": "75990"
  },
  {
    "text": "Cardenas so plugins so Cardenas is based",
    "start": "75990",
    "end": "81990"
  },
  {
    "text": "on a plug-in middleware system so it's really a plug-and-play model type thing so let's take a look at the different",
    "start": "81990",
    "end": "90150"
  },
  {
    "text": "plugin types so what do you usually use by default are the core plugins the ones",
    "start": "90150",
    "end": "96180"
  },
  {
    "text": "that are actually in the record E&S repository and they're maintained and controlled by the core team basically",
    "start": "96180",
    "end": "102470"
  },
  {
    "text": "these include the Prometheus logging plug-in caching the Kuban a nice one",
    "start": "102470",
    "end": "108420"
  },
  {
    "text": "basically everything that is bundled by default we have a few other ones that",
    "start": "108420",
    "end": "113939"
  },
  {
    "text": "are based based in the coordinates as sub projects so they're still aligned",
    "start": "113939",
    "end": "119460"
  },
  {
    "text": "with the overall project but there might not be completely specific to your use case and then we have the external",
    "start": "119460",
    "end": "126540"
  },
  {
    "text": "plugins which are completely maintained externally but can be linked through coordinates that IO so if it's something",
    "start": "126540",
    "end": "133840"
  },
  {
    "text": "that is relevant to your product or a really specific use case you can still",
    "start": "133840",
    "end": "139120"
  },
  {
    "text": "announce it but it might not be bundled in by default one of the plugins that's",
    "start": "139120",
    "end": "145150"
  },
  {
    "text": "currently being proposed and will start as an external plug-in is a resolver",
    "start": "145150",
    "end": "150940"
  },
  {
    "text": "plugin so you can use it on your home server or on your machine and it will",
    "start": "150940",
    "end": "157299"
  },
  {
    "text": "resolve DNS requests locally so it will start to basically mature as an external",
    "start": "157299",
    "end": "162940"
  },
  {
    "text": "plug-in and then probably move into the decor DNS repository if it's good enough",
    "start": "162940",
    "end": "168640"
  },
  {
    "text": "or stable enough to get bundled in by default so let's look at one of the more",
    "start": "168640",
    "end": "174849"
  },
  {
    "text": "advanced use cases so what's hidden primary basically a hidden primary is a",
    "start": "174849",
    "end": "182430"
  },
  {
    "text": "DNS setup where instead of pushing the configuration to for example route file",
    "start": "182430",
    "end": "189000"
  },
  {
    "text": "453 or your Cloud DNS server you basically have a hidden primary control",
    "start": "189000",
    "end": "196690"
  },
  {
    "text": "server which is the authoritative server from the behind the scenes basically so",
    "start": "196690",
    "end": "202720"
  },
  {
    "text": "what happens in general we have the user that is requesting DNS record that's",
    "start": "202720",
    "end": "209349"
  },
  {
    "text": "usually going to a recursive one which could be your eyes P DNS server or your",
    "start": "209349",
    "end": "216250"
  },
  {
    "text": "public DNS server that you use from CloudFlare Google Public DNS or things like that these are just recursive so",
    "start": "216250",
    "end": "223630"
  },
  {
    "text": "they don't have the authority to completely solve the DNS record and it",
    "start": "223630",
    "end": "228880"
  },
  {
    "text": "will then upstream if it doesn't know who or doesn't have anything cached to the secondary DNS server so the internet",
    "start": "228880",
    "end": "239200"
  },
  {
    "text": "based video or every user knows about the secondary so that's why it's a hidden primary set up so no one",
    "start": "239200",
    "end": "245530"
  },
  {
    "text": "basically knows that there's a server in the backend actually pushing the records so how can that be used in a more",
    "start": "245530",
    "end": "252819"
  },
  {
    "text": "interesting way so let's jump into so we",
    "start": "252819",
    "end": "259180"
  },
  {
    "text": "can basically use a good space DNS so especially for open source projects or",
    "start": "259180",
    "end": "265000"
  },
  {
    "text": "bigger companies then need an audit lock on their Denese tones on",
    "start": "265000",
    "end": "272050"
  },
  {
    "text": "the records they can use get for that so either you some companies use like a",
    "start": "272050",
    "end": "279039"
  },
  {
    "text": "little small library that will consume the get based zones and then push that",
    "start": "279039",
    "end": "284139"
  },
  {
    "text": "to their cloud provider which then serves the zones that's nice and",
    "start": "284139",
    "end": "289539"
  },
  {
    "text": "possible but with the hidden server or the hidden primary use case we can",
    "start": "289539",
    "end": "295150"
  },
  {
    "text": "actually manage a lot more so we basically get the data from the git repository in our case we use git",
    "start": "295150",
    "end": "301930"
  },
  {
    "text": "sync which is a small sidecar in in Cuban Aires which will pull in the git",
    "start": "301930",
    "end": "307960"
  },
  {
    "text": "repository which is basically just bind formatted zone files and this will",
    "start": "307960",
    "end": "313930"
  },
  {
    "text": "allocate the data in the sidecar and next Cardenas Cardenas has a few plugins",
    "start": "313930",
    "end": "320699"
  },
  {
    "text": "one being a file plucking and one being an out out of plug-in it basically can",
    "start": "320699",
    "end": "326470"
  },
  {
    "text": "read in zones from the file system and then search them Authority Leafly and",
    "start": "326470",
    "end": "332050"
  },
  {
    "text": "also add some can add a sorry can add a few more features for example rewrites",
    "start": "332050",
    "end": "338020"
  },
  {
    "text": "so you can rewrite any queries you want to have specifically handled so this",
    "start": "338020",
    "end": "343750"
  },
  {
    "text": "server cárdenas basically as the hidden primary will then just use notifies to",
    "start": "343750",
    "end": "350620"
  },
  {
    "text": "notify the secondary dns my DNS server to publicly or pull the latest updates",
    "start": "350620",
    "end": "357539"
  },
  {
    "text": "so sometimes these notifies get lost on the internet or some authentication",
    "start": "357539",
    "end": "364180"
  },
  {
    "text": "might not happen or something like that so that's where we jump into the server",
    "start": "364180",
    "end": "369430"
  },
  {
    "text": "record so it's the basically the primary the start of authority record it's the",
    "start": "369430",
    "end": "376090"
  },
  {
    "text": "one that describes or that's the one that's the most minimal record that's",
    "start": "376090",
    "end": "381190"
  },
  {
    "text": "needed in each zone so just to get into it I know probably most of you already",
    "start": "381190",
    "end": "387520"
  },
  {
    "text": "know that but just to get the constrictor ID so example the comb would be this zone then we have the TTL of",
    "start": "387520",
    "end": "394599"
  },
  {
    "text": "that specific record a man basically the record type being zero the anistar",
    "start": "394599",
    "end": "400810"
  },
  {
    "text": "example come would be the actual the actual name",
    "start": "400810",
    "end": "408310"
  },
  {
    "text": "server that is publicly requested for all the requests on the on the internet",
    "start": "408310",
    "end": "413920"
  },
  {
    "text": "for your specific domain and then we have a weird one so domains that example",
    "start": "413920",
    "end": "419740"
  },
  {
    "text": "has come it looks like a subdomain but it's actually an email address the",
    "start": "419740",
    "end": "424810"
  },
  {
    "text": "problem with emails the ad is a special character which can't be used in any",
    "start": "424810",
    "end": "429880"
  },
  {
    "text": "zone files so that's why the first dot will be translated to the ad but more",
    "start": "429880",
    "end": "435490"
  },
  {
    "text": "interestingly so we have the serial which is probably self-explanatory but more interestingly we have the different",
    "start": "435490",
    "end": "441340"
  },
  {
    "text": "TTL s usually there without wherever they are added without the comments so you basically see four numbers no one",
    "start": "441340",
    "end": "449350"
  },
  {
    "text": "usually knows what they are but to get into what they can be used for and why they are important for our hidden",
    "start": "449350",
    "end": "456220"
  },
  {
    "text": "primary so the refresh rate is basically how often the secondary tries to pull",
    "start": "456220",
    "end": "462820"
  },
  {
    "text": "data from the primary the second one the retry entry is how often it is it",
    "start": "462820",
    "end": "470290"
  },
  {
    "text": "retries and to check if anything changed so it basically just pulls the header",
    "start": "470290",
    "end": "475300"
  },
  {
    "text": "and then checks the serial if it's updated or not and then we use refresh",
    "start": "475300",
    "end": "480520"
  },
  {
    "text": "rate to refresh the record then we have the expire so in our case we use the",
    "start": "480520",
    "end": "487150"
  },
  {
    "text": "hidden primary in production it's running in one of our local Cuban Inez clusters but it's a replica and",
    "start": "487150",
    "end": "494140"
  },
  {
    "text": "sometimes it gets down but the wonderful thing about this set up is as long as",
    "start": "494140",
    "end": "499900"
  },
  {
    "text": "the expiry is longer than our time down time and we don't do any changes no one notices",
    "start": "499900",
    "end": "505450"
  },
  {
    "text": "so the expiry basically tells the secondary how long he can answer a thorough flea on you'd main or on your",
    "start": "505450",
    "end": "513460"
  },
  {
    "text": "zone without checking in with the master after the time basically is expired and",
    "start": "513460",
    "end": "518590"
  },
  {
    "text": "the master isn't reachable it will drop all requests and basically fail and Nick's domain and the other one is",
    "start": "518590",
    "end": "525910"
  },
  {
    "text": "minimum negative caching which is really helpful if you change domains and one a",
    "start": "525910",
    "end": "532570"
  },
  {
    "text": "black hole a domain or zone so if you had an old subdomain which is",
    "start": "532570",
    "end": "537620"
  },
  {
    "text": "not really used and you don't have negative caching on you might run into a huge bill on your DNS provider because",
    "start": "537620",
    "end": "545690"
  },
  {
    "text": "it keeps on keeps on spinning and doesn't cache on the ice P level it doesn't catch on the resolver level and",
    "start": "545690",
    "end": "551120"
  },
  {
    "text": "we ran into that once switching our customer and it wasn't a huge bill but",
    "start": "551120",
    "end": "557810"
  },
  {
    "text": "we still got probably a 50 thousand 50 million generic queries more than we",
    "start": "557810",
    "end": "564350"
  },
  {
    "text": "actually wanted to so let's jump into the code my Mike okay there we go all",
    "start": "564350",
    "end": "580910"
  },
  {
    "text": "right well so as Michael mentioned core DNS is a plug-in based system what that",
    "start": "580910",
    "end": "586550"
  },
  {
    "text": "means is that a request a DNS request",
    "start": "586550",
    "end": "591650"
  },
  {
    "text": "that comes in is is passed through a number of handlers and you can insert handlers in that chain of your own a few",
    "start": "591650",
    "end": "599750"
  },
  {
    "text": "things to note about that well it is a plug-in based system it's it's written and go and it's not using the go dynamic",
    "start": "599750",
    "end": "608720"
  },
  {
    "text": "loading plug-in facilities so it's actually the plugins are all compiled in that means that if you do want to create",
    "start": "608720",
    "end": "615800"
  },
  {
    "text": "your own plug-in you're gonna build the whole executable not just you know plug-in but nonetheless it's pretty easy",
    "start": "615800",
    "end": "621980"
  },
  {
    "text": "to view and you can you can accomplish a",
    "start": "621980",
    "end": "628070"
  },
  {
    "text": "lot of interesting use cases this way the plug-in we're gonna show here as a",
    "start": "628070",
    "end": "633410"
  },
  {
    "text": "demo is really a stupid plug-in it's always going to return no matter what",
    "start": "633410",
    "end": "639800"
  },
  {
    "text": "you ask for one of two different IP addresses one that one that one that one",
    "start": "639800",
    "end": "644900"
  },
  {
    "text": "dot quad one or quad eight and and but",
    "start": "644900",
    "end": "650720"
  },
  {
    "text": "it's going to look at your client source IP and it's going to decide how to do it based on that the code for this is on",
    "start": "650720",
    "end": "660620"
  },
  {
    "text": "that github it's super simple though we're just gonna go through the code I'll explain the different pieces you",
    "start": "660620",
    "end": "666680"
  },
  {
    "text": "need in order to create a plug-in so essentially for a simple",
    "start": "666680",
    "end": "674240"
  },
  {
    "text": "plugin like this it's two files you could put them all in one but it's two files it's a setup that go which",
    "start": "674240",
    "end": "680420"
  },
  {
    "text": "contains an init function that function is performs the one-time initializations",
    "start": "680420",
    "end": "689360"
  },
  {
    "text": "including registering this the setup function with caddy and that so",
    "start": "689360",
    "end": "695889"
  },
  {
    "text": "accordion s uses there's a webserver a go playing web server called caddy",
    "start": "695889",
    "end": "701389"
  },
  {
    "text": "that's been around for a while it's got a plug-in architecture and it's got a it's a sort of server infrastructure so",
    "start": "701389",
    "end": "708680"
  },
  {
    "text": "it that's what we've actually pulled in and built our server around so it",
    "start": "708680",
    "end": "713899"
  },
  {
    "text": "handles things like restarting the server in a safe way by starting up a",
    "start": "713899",
    "end": "720529"
  },
  {
    "text": "new one in destroying all when handing off the the sockets it handles the parsing of the configuration file for us",
    "start": "720529",
    "end": "727420"
  },
  {
    "text": "essentially a lot of those infrastructure facilities for building a server are all taken care of for us and",
    "start": "727420",
    "end": "733970"
  },
  {
    "text": "letting us focus on just the DNS pieces so in order to to build your plugin",
    "start": "733970",
    "end": "741139"
  },
  {
    "text": "you're going to integrate with that set of libraries and the the init process",
    "start": "741139",
    "end": "749029"
  },
  {
    "text": "this registration process is essentially just telling caddy hey when you read this configuration file you're going to",
    "start": "749029",
    "end": "754939"
  },
  {
    "text": "get this directive a string demo in this case and when you get that I want you to",
    "start": "754939",
    "end": "761660"
  },
  {
    "text": "call my function over here the setup function and pass to it the handle to",
    "start": "761660",
    "end": "769279"
  },
  {
    "text": "that configuration file basically sitting there right at that at that directive so I can just consume the",
    "start": "769279",
    "end": "775189"
  },
  {
    "text": "things that are relevant to to my plugin that's what the setup does it parses",
    "start": "775189",
    "end": "781130"
  },
  {
    "text": "that it adds the handler I guess if you if you weren't at one of the earlier core DNS ones you may not have seen the",
    "start": "781130",
    "end": "789170"
  },
  {
    "text": "explanation of a core file but essentially in a in a core file in our configuration file there's multiple",
    "start": "789170",
    "end": "795410"
  },
  {
    "text": "stanzas and each of those stanzas can have a different",
    "start": "795410",
    "end": "800720"
  },
  {
    "text": "of plugins associated with it and in a different zone so you could say example.com goes through this set of",
    "start": "800720",
    "end": "807439"
  },
  {
    "text": "plugins and foo.example.com goes through this different set of plugins with",
    "start": "807439",
    "end": "812540"
  },
  {
    "text": "different TTL different cache everything so those stanzas are you get this setup",
    "start": "812540",
    "end": "821449"
  },
  {
    "text": "call once for each of those stanzas in which your plug-in directive exists in",
    "start": "821449",
    "end": "829240"
  },
  {
    "text": "the responsibility of that set up call to to create a configuration essentially",
    "start": "829240",
    "end": "838399"
  },
  {
    "text": "to parse its configuration create an object and then associate a handler for that for that with that stanza",
    "start": "838399",
    "end": "845660"
  },
  {
    "text": "internally finally there's the serve DNS function which performs the actual",
    "start": "845660",
    "end": "850670"
  },
  {
    "text": "request processing so to look at the actual code you see it's just a handful",
    "start": "850670",
    "end": "857269"
  },
  {
    "text": "of handful of lines of code here the anit does the registration with the the",
    "start": "857269",
    "end": "862339"
  },
  {
    "text": "keyword demo server types dns caddy supports two server types HTTP and DNS",
    "start": "862339",
    "end": "868399"
  },
  {
    "text": "and only because we added dns but the the actions the setup as I said that",
    "start": "868399",
    "end": "874430"
  },
  {
    "text": "gets called the when you get this handler through this caddy configuration",
    "start": "874430",
    "end": "881180"
  },
  {
    "text": "file this caddy controller you it's sitting basically right at the token that that that was passed into register",
    "start": "881180",
    "end": "889879"
  },
  {
    "text": "so you can consume that one and then you can just start to consume the different pieces in our case there are no",
    "start": "889879",
    "end": "896209"
  },
  {
    "text": "parameters so we don't really do anything with it what we do is add this",
    "start": "896209",
    "end": "901699"
  },
  {
    "text": "handler so it's the handler is done as a your basically there's an interface you",
    "start": "901699",
    "end": "908389"
  },
  {
    "text": "have to implement that has served DNS in it and name and those are the only two functions and you pass that in here",
    "start": "908389",
    "end": "915439"
  },
  {
    "text": "we're instantiating the demo object if if we had parameters for this that for",
    "start": "915439",
    "end": "921230"
  },
  {
    "text": "the configuration we would we would fill that in there finally the serve DNS",
    "start": "921230",
    "end": "928939"
  },
  {
    "text": "which doesn't look the same on the screen now than it did before so seem to have lost the spacing but in",
    "start": "928939",
    "end": "937670"
  },
  {
    "text": "this case super simple you get you get three parameters you get a go context which we can use for all sorts of tricks",
    "start": "937670",
    "end": "943970"
  },
  {
    "text": "and games later if we wanted to you get a response writer which is essentially just a class or a interface you can call",
    "start": "943970",
    "end": "953060"
  },
  {
    "text": "in order to write the actual response back to the client although we have some implementations of that that will",
    "start": "953060",
    "end": "959420"
  },
  {
    "text": "essentially capture it and let let you manipulate other plugins data and I'm finally you get the DNS message which is",
    "start": "959420",
    "end": "965630"
  },
  {
    "text": "the actual request and in our case like I said it's a super simple stupid plugin and it just has one if statement and",
    "start": "965630",
    "end": "972920"
  },
  {
    "text": "changes the reply based upon that in the",
    "start": "972920",
    "end": "977930"
  },
  {
    "text": "next a little is the continuation of that function it basically creates a a",
    "start": "977930",
    "end": "984410"
  },
  {
    "text": "resource record for the reply at the NS message and sends back success so we can",
    "start": "984410",
    "end": "993080"
  },
  {
    "text": "try it this was what the core file would look like for for this particular case",
    "start": "993080",
    "end": "998570"
  },
  {
    "text": "we just have the one one plug-in activated this is a dr command you can",
    "start": "998570",
    "end": "1006400"
  },
  {
    "text": "use to build it so you don't have to get your whole go environment set up if you really want to and so we can look at",
    "start": "1006400",
    "end": "1011560"
  },
  {
    "text": "what that looks like so I've already done this I've already did the build so I won't run that again but we can run",
    "start": "1011560",
    "end": "1019480"
  },
  {
    "text": "the actual Gordian ass we can see what",
    "start": "1019480",
    "end": "1027010"
  },
  {
    "text": "these the one thing I didn't mention that you have to do if you're gonna do this is you have to add this to the",
    "start": "1027010",
    "end": "1032860"
  },
  {
    "text": "plug-in CFG which is essentially just our our way of doing the the plugins at",
    "start": "1032860",
    "end": "1040688"
  },
  {
    "text": "Build time and sort of pulling them individually this facility makes it",
    "start": "1040689",
    "end": "1046480"
  },
  {
    "text": "really easy to build versions of coordinates that are scoped to a particular purpose so for example",
    "start": "1046480",
    "end": "1052930"
  },
  {
    "text": "there's a node local DNS project that just came through kubernetes in 113 out",
    "start": "1052930",
    "end": "1059020"
  },
  {
    "text": "in alpha and that's done by actually stripping out all of these plugins CFG entries except for the very few that you",
    "start": "1059020",
    "end": "1065380"
  },
  {
    "text": "need that way we got the executable down to pretty much as small as we could get as",
    "start": "1065380",
    "end": "1070990"
  },
  {
    "text": "far as a memory consumption and because it's going you know on every single node so it's it's a nice way to tune things",
    "start": "1070990",
    "end": "1078880"
  },
  {
    "text": "and keep your resource utilization low in any case you insert this in the",
    "start": "1078880",
    "end": "1084490"
  },
  {
    "text": "plug-in CFG and one very important thing that's kind of I think something we need to fix eventually is that this also",
    "start": "1084490",
    "end": "1091960"
  },
  {
    "text": "dictates the order in which the plugins are passed the request so your stands",
    "start": "1091960",
    "end": "1099100"
  },
  {
    "text": "are that defines what plugins are activated for that for a particular zone",
    "start": "1099100",
    "end": "1105240"
  },
  {
    "text": "it it you can't change the order the order that you put them in that stands",
    "start": "1105240",
    "end": "1110440"
  },
  {
    "text": "it doesn't actually matter what matters is whether they are not if they're there they get added to the to the chain of",
    "start": "1110440",
    "end": "1118230"
  },
  {
    "text": "plug-in plugins but they're always added in the same order which is the order of this plug-in CFG that can limit you in a",
    "start": "1118230",
    "end": "1126010"
  },
  {
    "text": "number of ways we haven't figured out a good way for from a configuration point",
    "start": "1126010",
    "end": "1131860"
  },
  {
    "text": "of view that that's not too painful to reorder them because there's some of them do need to appear in a certain",
    "start": "1131860",
    "end": "1138070"
  },
  {
    "text": "order to work but in any case if you're building your own plug-in you're building your own version of core DNS be",
    "start": "1138070",
    "end": "1144100"
  },
  {
    "text": "sure you put your plug-in in the proper place in the chain so things can handle it properly",
    "start": "1144100",
    "end": "1149640"
  },
  {
    "text": "alright so we have it running over here",
    "start": "1149640",
    "end": "1155740"
  },
  {
    "text": "and it's very exciting we will",
    "start": "1155740",
    "end": "1161669"
  },
  {
    "text": "and it doesn't work I hope that's cuz a typo 70 there we go we get one dot one",
    "start": "1171830",
    "end": "1181340"
  },
  {
    "text": "dot one dot one no matter what we pass over here we see the log so not very",
    "start": "1181340",
    "end": "1187280"
  },
  {
    "text": "exciting as far as they are useful as far as a plugin but gives you the basic",
    "start": "1187280",
    "end": "1193010"
  },
  {
    "text": "structure of what you would need to do if you want our feature own alright so",
    "start": "1193010",
    "end": "1202090"
  },
  {
    "text": "the last thing we wanted to cover was the outlook and then we wanted to leave",
    "start": "1202090",
    "end": "1207380"
  },
  {
    "text": "a lot of time for questions and if that's fine so a few things we're",
    "start": "1207380",
    "end": "1213980"
  },
  {
    "text": "looking at going in the future the we've recently added something we",
    "start": "1213980",
    "end": "1220910"
  },
  {
    "text": "call the metadata plugin and what that does is it allows the passing of",
    "start": "1220910",
    "end": "1226010"
  },
  {
    "text": "information from one plugin to the next so where this is used today is in things",
    "start": "1226010",
    "end": "1231650"
  },
  {
    "text": "like the log plugin so you could publish to this to them to the go context it's",
    "start": "1231650",
    "end": "1236840"
  },
  {
    "text": "this metadata and then the log can put that in your log so if you had something",
    "start": "1236840",
    "end": "1242080"
  },
  {
    "text": "special you don't want to print like era log messages but you had some status or",
    "start": "1242080",
    "end": "1247430"
  },
  {
    "text": "something you wanted to come out of your plugin you could push it into this metadata and then anybody who's using",
    "start": "1247430",
    "end": "1253670"
  },
  {
    "text": "the log plugin could configure it to actually put that in the logs if they wanted to there are a few other really",
    "start": "1253670",
    "end": "1261230"
  },
  {
    "text": "interesting use cases I think we'll be able to to do once we have this fully plumbed through everything one is that",
    "start": "1261230",
    "end": "1267830"
  },
  {
    "text": "we have another plug-in coming soon called firewall this is a very simple sort of allow deny for request so you",
    "start": "1267830",
    "end": "1274730"
  },
  {
    "text": "could do that based on client client IP record type whatever it is in the request but if we allow say the",
    "start": "1274730",
    "end": "1282200"
  },
  {
    "text": "kubernetes plug-in to publish metadata about the requests and so could publish",
    "start": "1282200",
    "end": "1288680"
  },
  {
    "text": "for instance the name space of the source pod the pod corresponding to the",
    "start": "1288680",
    "end": "1295070"
  },
  {
    "text": "client IP then you could actually use that kubernetes metadata within the",
    "start": "1295070",
    "end": "1300980"
  },
  {
    "text": "firewall plugin to build all kinds of policies about how you're allowed to - to resolve requests so those are some",
    "start": "1300980",
    "end": "1308480"
  },
  {
    "text": "of the things we're looking at in the near future anything else you wanted to",
    "start": "1308480",
    "end": "1316190"
  },
  {
    "text": "discuss yes so one interesting use case for the firewall plugin for example is",
    "start": "1316190",
    "end": "1323320"
  },
  {
    "text": "this called or you can route traffic through DNS text records and for example",
    "start": "1323320",
    "end": "1329120"
  },
  {
    "text": "if you allow at an airport DNS you might be able to tunnel traffic through so one",
    "start": "1329120",
    "end": "1335000"
  },
  {
    "text": "idea is to basically disallow text records in airports or something like that so that would be a use case for the",
    "start": "1335000",
    "end": "1341690"
  },
  {
    "text": "firewall practice which is really tangible and the other one that is",
    "start": "1341690",
    "end": "1346700"
  },
  {
    "text": "basically coming or that we're looking into is a writable direct API for currently like how it's",
    "start": "1346700",
    "end": "1353000"
  },
  {
    "text": "done but kubernetes you would write something into cuba Nettie's or @cd and we can basically serve it from cárdenas",
    "start": "1353000",
    "end": "1360290"
  },
  {
    "text": "but we might look into the option to directly write something into cárdenas which is then served and the general we",
    "start": "1360290",
    "end": "1368210"
  },
  {
    "text": "are looking into performance optimizations especially around gr pc where we want to have the opportunity to",
    "start": "1368210",
    "end": "1375620"
  },
  {
    "text": "go DNS / G RPC so we can also do watch space DNS so instead of having a lot of",
    "start": "1375620",
    "end": "1381410"
  },
  {
    "text": "idle traffic Reif etching records it might just be able to hold the cache as",
    "start": "1381410",
    "end": "1386750"
  },
  {
    "text": "long as possible until the record changes and the change isn't a pool based one but a push based one which cut",
    "start": "1386750",
    "end": "1392990"
  },
  {
    "text": "is coming from the central instance or the cuban Eddie's master and if you have",
    "start": "1392990",
    "end": "1398780"
  },
  {
    "text": "any other ideas for plugins especially play external plugins for now give us",
    "start": "1398780",
    "end": "1404090"
  },
  {
    "text": "yeah come over and or do a pull request or issue and we're happy to receive any",
    "start": "1404090",
    "end": "1410630"
  },
  {
    "text": "contributions so we're on github on slack and if you're used in if you're",
    "start": "1410630",
    "end": "1417049"
  },
  {
    "text": "using or DNS in production we would love to hear about it yeah please open a pull",
    "start": "1417049",
    "end": "1422120"
  },
  {
    "text": "request and open and add yourself to the adopters file so we can see who's using what how and how we might improve as a",
    "start": "1422120",
    "end": "1429770"
  },
  {
    "text": "community and in general also code contributions and as I said plugins always welcome",
    "start": "1429770",
    "end": "1437320"
  },
  {
    "text": "so any questions and before you before you start we do have we have 10 t-shirts",
    "start": "1437320",
    "end": "1443050"
  },
  {
    "text": "here so I don't know what sizes you'll just have to get lucky with the sizes",
    "start": "1443050",
    "end": "1448570"
  },
  {
    "text": "but but every good question not bad questions good questions so ones we can",
    "start": "1448570",
    "end": "1453880"
  },
  {
    "text": "answer maybe or maybe once we can't answer would be better question you'll get a t-shirt so who's first",
    "start": "1453880",
    "end": "1460110"
  },
  {
    "text": "alright right here I have to turn this off we also have stickers for the bad",
    "start": "1460110",
    "end": "1467050"
  },
  {
    "text": "questions by the way",
    "start": "1467050",
    "end": "1469800"
  },
  {
    "text": "okay thank you for the talk so the web server component seems to be a very",
    "start": "1480180",
    "end": "1485680"
  },
  {
    "text": "critical piece of the entire project you guys I mean that's materials caddy project right so do you have a separate",
    "start": "1485680",
    "end": "1492250"
  },
  {
    "text": "folk wherein you can just put in whatever and if there's a fix do you do you contribute upstream to caddy and",
    "start": "1492250",
    "end": "1497860"
  },
  {
    "text": "then pull that caddy specific version into code ENS or do you have a separate folk and just maintain yours and because",
    "start": "1497860",
    "end": "1504010"
  },
  {
    "text": "that will have more flexibility into whatever changes you want to push you can just push it and make a new release for Cody honest and just push that no we",
    "start": "1504010",
    "end": "1513250"
  },
  {
    "text": "don't have a separate Fork we use the upstream carry and we haven't had any real issues we work pretty well with",
    "start": "1513250",
    "end": "1519940"
  },
  {
    "text": "with Matt and you know so that the times we've had we found bugs we've you know in say the",
    "start": "1519940",
    "end": "1529090"
  },
  {
    "text": "we thought we found some in the restart process so there's certain events that go out and causing issues during restart",
    "start": "1529090",
    "end": "1534820"
  },
  {
    "text": "under certain conditions so we were able to upstream any fixes like that so we haven't had an issue with that it also",
    "start": "1534820",
    "end": "1541930"
  },
  {
    "text": "depends on the use cases so if you use something within caddy that might be a bit more unexposed and he's changing",
    "start": "1541930",
    "end": "1549400"
  },
  {
    "text": "something internally or the Caddy project is you run into that issue more often but then it's basically it's a",
    "start": "1549400",
    "end": "1556060"
  },
  {
    "text": "build time error so you could do that by actually building a specific version but",
    "start": "1556060",
    "end": "1562930"
  },
  {
    "text": "we try to run as close as possible because it's still most of the code base is the same so we want to have the same",
    "start": "1562930",
    "end": "1569650"
  },
  {
    "text": "box and therefore fix it upstream faster any other question lots of people want",
    "start": "1569650",
    "end": "1577270"
  },
  {
    "text": "shirts alright",
    "start": "1577270",
    "end": "1580080"
  },
  {
    "text": "all right right here actually it said as a quick question",
    "start": "1583590",
    "end": "1590560"
  },
  {
    "text": "used all that there is no right API currently in code NSA have a zone file",
    "start": "1590560",
    "end": "1596440"
  },
  {
    "text": "and the detector to it how do I make a server to understand the files just in",
    "start": "1596440",
    "end": "1602110"
  },
  {
    "text": "something like our NGC in mind so the the file I believe the file plug-in but",
    "start": "1602110",
    "end": "1609130"
  },
  {
    "text": "definitely the auto plug-in will monitor the file automatically so as soon as you change the file it at well after a",
    "start": "1609130",
    "end": "1615490"
  },
  {
    "text": "little while it's it's actually polls periodically it'll it'll look at it and it'll see that it's change the serial numbers changed don't forget to change",
    "start": "1615490",
    "end": "1621640"
  },
  {
    "text": "the serial number and then it'll it'll reload it so no support for ddns what",
    "start": "1621640",
    "end": "1630010"
  },
  {
    "text": "we're looking at so so the idea behind the writable API is that we we have all",
    "start": "1630010",
    "end": "1635230"
  },
  {
    "text": "these different backends and we're not we don't just have one we have many different ones and so we don't want to",
    "start": "1635230",
    "end": "1640870"
  },
  {
    "text": "come up with one storage and you know keep the things and all of that on our",
    "start": "1640870",
    "end": "1646180"
  },
  {
    "text": "own we'd rather have that be a function of the plug-in so right now we have a like I said two to it functions you have",
    "start": "1646180",
    "end": "1653740"
  },
  {
    "text": "to implement for a plug-in name and serve DNS well we would add another interface for a writable plug-in that",
    "start": "1653740",
    "end": "1659590"
  },
  {
    "text": "allows you to store a record and then the the plugins that have that capability like let's say the sed",
    "start": "1659590",
    "end": "1664750"
  },
  {
    "text": "plug-in would would implement that interface and then on top of that we build other plugins that can do the",
    "start": "1664750",
    "end": "1672030"
  },
  {
    "text": "external API for those so you can do it through our G RPC interface or we can implement a plug-in that does three DNS",
    "start": "1672030",
    "end": "1679840"
  },
  {
    "text": "with the DNS or we can implement a plug-in that has a restful api so the idea is they still keep those the the",
    "start": "1679840",
    "end": "1687430"
  },
  {
    "text": "writing and storing function separate from the how you tell core DNS about the record okay so on the on the file based",
    "start": "1687430",
    "end": "1699970"
  },
  {
    "text": "one so we did use notifications on the file system so ii you basically change",
    "start": "1699970",
    "end": "1708340"
  },
  {
    "text": "the file on the system we would reload it but we ran into some race conditions",
    "start": "1708340",
    "end": "1713470"
  },
  {
    "text": "and issues with how FS notify works so there were so",
    "start": "1713470",
    "end": "1718510"
  },
  {
    "text": "many bugs that were just annoying and reading fouls most likely isn't that",
    "start": "1718510",
    "end": "1723790"
  },
  {
    "text": "problematic depending on the size of your zones so it now defaults to I think 30 second pools and you can go down to",
    "start": "1723790",
    "end": "1733540"
  },
  {
    "text": "like a second usually shouldn't be any issue Norris",
    "start": "1733540",
    "end": "1738600"
  },
  {
    "text": "okay so right now Cortinas doesn't have a native recursive resolver we have to",
    "start": "1738600",
    "end": "1744880"
  },
  {
    "text": "compile from source is that always going to be the case or is that is there a plan to merge that in all right that's a",
    "start": "1744880",
    "end": "1752440"
  },
  {
    "text": "really good question you definitely get a shirt so the so Michael mentioned this early in the talk so we do have a plug",
    "start": "1752440",
    "end": "1761140"
  },
  {
    "text": "in external plugin that compiles in unbound and that will allow you to do recursion but we recently had a",
    "start": "1761140",
    "end": "1768090"
  },
  {
    "text": "contributor who wrote I think he calls it s DNS it's a golang recursive DNS",
    "start": "1768090",
    "end": "1775140"
  },
  {
    "text": "server that he's already written he just stripped out a bunch of stuff and made it into a plugin so it's brand-new it'll",
    "start": "1775140",
    "end": "1783250"
  },
  {
    "text": "start as an external plugin that's not necessarily built in by default and then you know as we see it mature and we're",
    "start": "1783250",
    "end": "1789550"
  },
  {
    "text": "sure that it's solid we'll pull it into the into the core so that we're very much looking forward to that all right",
    "start": "1789550",
    "end": "1797280"
  },
  {
    "text": "get one more back here then I'll go back up front hi I'm wondering what's the if",
    "start": "1797280",
    "end": "1805810"
  },
  {
    "text": "there is guideline and gocha's around moving from cube genus as default to",
    "start": "1805810",
    "end": "1813550"
  },
  {
    "text": "core DNS when you're running running 18 to production and you're rolling just your your your deployment so we did",
    "start": "1813550",
    "end": "1822870"
  },
  {
    "text": "there were a few talks about specifically that that topic so",
    "start": "1822870",
    "end": "1827950"
  },
  {
    "text": "basically the move from keep DNS sue Cardenas is a performance one and a reliability one so a change for example",
    "start": "1827950",
    "end": "1834190"
  },
  {
    "text": "that is really important is that we didn't do negative caching with cube DNS but we will do with Cardenas the other",
    "start": "1834190",
    "end": "1840910"
  },
  {
    "text": "thing is it's easier to maintain because keep Tina's was a bundle of DNS mask which is single threaded and sky DNS",
    "start": "1840910",
    "end": "1848530"
  },
  {
    "text": "which sort of partly maintained and now we move to the only single one which is",
    "start": "1848530",
    "end": "1853930"
  },
  {
    "text": "much more extensible and the the cluster plug-in or add-on we are generally",
    "start": "1853930",
    "end": "1861280"
  },
  {
    "text": "mentioned called note local which is available as a fern 1.13 which adds a",
    "start": "1861280",
    "end": "1867010"
  },
  {
    "text": "diamond set of a minimalistic or DNS instance and it also spreads around all the different external requests so",
    "start": "1867010",
    "end": "1873460"
  },
  {
    "text": "internally as we said in the core file you can set depending on your your path",
    "start": "1873460",
    "end": "1880420"
  },
  {
    "text": "or your zone it will answer differently so all the internals will still go to the central core DNS instance but",
    "start": "1880420",
    "end": "1887020"
  },
  {
    "text": "everything external would go right upstream so you completely move around any issues and any bottlenecks inside",
    "start": "1887020",
    "end": "1895240"
  },
  {
    "text": "the club a central one so for the migration so the the what I would do is",
    "start": "1895240",
    "end": "1904660"
  },
  {
    "text": "I would create a deployment with core DNS that's got the same labels as the cube DNS instances and get it in the mix",
    "start": "1904660",
    "end": "1911350"
  },
  {
    "text": "and make sure everything's working well for you and you're watching the metrics and then you can you can transition it so it keeps the if you worse if you're",
    "start": "1911350",
    "end": "1918190"
  },
  {
    "text": "running cubed min it will I don't think it upgrades you by default but if you specify to upgrade you it will switch it",
    "start": "1918190",
    "end": "1924700"
  },
  {
    "text": "over but it keeps the same service name because service name in cluster IP are",
    "start": "1924700",
    "end": "1931060"
  },
  {
    "text": "immutable so the yeah I would use both in parallel until you're comfortable and then you",
    "start": "1931060",
    "end": "1936460"
  },
  {
    "text": "can confess which me over so I guess we had two more here before so anecdotally on the you can look for the next person",
    "start": "1936460",
    "end": "1943530"
  },
  {
    "text": "so mini cube for example had the problem that they wanted to switch and accidentally it deployed both and then",
    "start": "1943530",
    "end": "1951250"
  },
  {
    "text": "notice that because it's still using cube deenis as the cluster service are",
    "start": "1951250",
    "end": "1956470"
  },
  {
    "text": "basically both responded and there was like a weird issue where they're like oh yeah our DNS fails but only like half the",
    "start": "1956470",
    "end": "1963010"
  },
  {
    "text": "time so they fixed that but it happens so you can actually use that as a",
    "start": "1963010",
    "end": "1968140"
  },
  {
    "text": "deployment mechanism",
    "start": "1968140",
    "end": "1970770"
  },
  {
    "text": "I was wondering about the process and",
    "start": "1973570",
    "end": "1979780"
  },
  {
    "text": "timeline for new plugins going through you know external to sub-project decor and as a aside what plugins are compiled",
    "start": "1979780",
    "end": "1987820"
  },
  {
    "text": "with the official core DNS image very",
    "start": "1987820",
    "end": "1993790"
  },
  {
    "text": "good questions so the the process is",
    "start": "1993790",
    "end": "1998920"
  },
  {
    "text": "pretty informal so if it's a big complex plug-in like this recursive DNS plug-in",
    "start": "1998920",
    "end": "2004790"
  },
  {
    "text": "there we're going to take more time we're gonna we're gonna see that if it's something really small and simple we may",
    "start": "2004790",
    "end": "2010050"
  },
  {
    "text": "just pull it pulling it immediately we try and keep things compiled into the",
    "start": "2010050",
    "end": "2016170"
  },
  {
    "text": "basic default image very general purpose that useful to most people so if it's a",
    "start": "2016170",
    "end": "2022110"
  },
  {
    "text": "really narrow use case then it won't won't make it in there and I need another shirt to get you your questions",
    "start": "2022110",
    "end": "2029360"
  },
  {
    "text": "so yes and no I guess is the best answer",
    "start": "2036380",
    "end": "2041930"
  },
  {
    "text": "we don't support views in the sense of bind right now we do have there's some",
    "start": "2041930",
    "end": "2050010"
  },
  {
    "text": "external plugins that could help you do we have a there's an external policy plugin that you can use an external",
    "start": "2050010",
    "end": "2055679"
  },
  {
    "text": "policy engine to do all kinds of crazy stuff but we are looking at I know for",
    "start": "2055680",
    "end": "2061200"
  },
  {
    "text": "install over there and someone over there he's got a some plans to build a plugin that would allow you to do",
    "start": "2061200",
    "end": "2066929"
  },
  {
    "text": "something very similar to views at least the basic functionality of use",
    "start": "2066930",
    "end": "2073879"
  },
  {
    "text": "does it support DNS SEC yes it does support DNS SEC it's not it's it's not",
    "start": "2078569",
    "end": "2084339"
  },
  {
    "text": "full support of everything I cricket Lou is here earlier doing some of the talks",
    "start": "2084339",
    "end": "2090579"
  },
  {
    "text": "and he would be able to he's more lowers a lot more about DNS SEC than me but he said something like you have to use the",
    "start": "2090579",
    "end": "2096069"
  },
  {
    "text": "same key you can't do split keys it's only supports one of the algorithms so",
    "start": "2096069",
    "end": "2101979"
  },
  {
    "text": "there's some limitations but it does support it yeah I so just wanted to ask",
    "start": "2101979",
    "end": "2114670"
  },
  {
    "text": "if if there's any any plan to to support you know the same features that Rob 3 has you know in terms of you know",
    "start": "2114670",
    "end": "2120459"
  },
  {
    "text": "splitting the requests by by weight or failing over to two different services",
    "start": "2120459",
    "end": "2128338"
  },
  {
    "text": "not specifically but you know those are the sort of things that can be added as",
    "start": "2128910",
    "end": "2134739"
  },
  {
    "text": "plugins if people come to the community and they're really interested in it especially if they're willing to contribute I do know there's some I lost",
    "start": "2134739",
    "end": "2145690"
  },
  {
    "text": "the thought but there's been discussion of some of these things and there is a there are some plugins I know for the",
    "start": "2145690",
    "end": "2151660"
  },
  {
    "text": "Infoblox did that do alternate or fallback type of things if you get a if you get a failure from the upstream like",
    "start": "2151660",
    "end": "2158799"
  },
  {
    "text": "a sort of fail well go talk to a different upstream or do different things I mean we we already do that in a",
    "start": "2158799",
    "end": "2164349"
  },
  {
    "text": "way but it's a slightly different semantics yeah you can also like there's a plugin called fall through so as long",
    "start": "2164349",
    "end": "2170199"
  },
  {
    "text": "as the other plugins in the chain supported if it doesn't have an answer it will just fall back to the next",
    "start": "2170199",
    "end": "2176829"
  },
  {
    "text": "plug-in in line so you could say if it's in the zone files that are local for",
    "start": "2176829",
    "end": "2182289"
  },
  {
    "text": "example that will serve it if not I will fall through to the internal DNS server",
    "start": "2182289",
    "end": "2187509"
  },
  {
    "text": "if that's not you can fall through and do something like that and you could add one specific like reading zone files",
    "start": "2187509",
    "end": "2195579"
  },
  {
    "text": "from your own API implementation or something and then if it doesn't fall through and then fall through through",
    "start": "2195579",
    "end": "2201190"
  },
  {
    "text": "their central core DNS Inc you manage for example there was a question back here somewhere",
    "start": "2201190",
    "end": "2206910"
  },
  {
    "text": "I think that save you a trip now we've I've been trying to write a plug-in for",
    "start": "2206910",
    "end": "2212880"
  },
  {
    "text": "a while other some common pitfalls you've seen people running into through",
    "start": "2212880",
    "end": "2218760"
  },
  {
    "text": "this process I don't think you get a",
    "start": "2218760",
    "end": "2224430"
  },
  {
    "text": "shirt for that question no I I I don't I can't think of any",
    "start": "2224430",
    "end": "2232380"
  },
  {
    "text": "offhand I mean you know it well I got okay some would be if if you you have to",
    "start": "2232380",
    "end": "2237780"
  },
  {
    "text": "be careful about how the reload semantics work so sometimes people or even us and a lot of our earlier plugins",
    "start": "2237780",
    "end": "2243119"
  },
  {
    "text": "had like a package specific a package global variable and then when reload",
    "start": "2243119",
    "end": "2249150"
  },
  {
    "text": "happens they don't play well together and you get problem so you so that's one",
    "start": "2249150",
    "end": "2254579"
  },
  {
    "text": "I think area to be to be careful about another one would be probably the order in which",
    "start": "2254579",
    "end": "2260010"
  },
  {
    "text": "you add it into the plug-in CFG because",
    "start": "2260010",
    "end": "2265349"
  },
  {
    "text": "it might be that you rely on something in as a general serving plug-in or something and if you put your plug in",
    "start": "2265349",
    "end": "2272130"
  },
  {
    "text": "before that it might break all of the other plugins because there is some implicit ordering for some plugins so if",
    "start": "2272130",
    "end": "2279299"
  },
  {
    "text": "you interrupt them you might break the build type thing like not the build but at the runtime I still have t-shirts no",
    "start": "2279299",
    "end": "2291599"
  },
  {
    "text": "all right thank you well we'll be up here if anybody has anything [Applause]",
    "start": "2291599",
    "end": "2300059"
  }
]