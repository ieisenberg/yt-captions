[
  {
    "text": "hi I'm Mike Coleman and welcome to this webinar I am a developer Advocate on the",
    "start": "480",
    "end": "5880"
  },
  {
    "text": "Falco project I actually work for a company called systig but my full-time job is sort of Open Source developer",
    "start": "5880",
    "end": "11940"
  },
  {
    "text": "advocacy uh prior to joining uh systig I was at Google uh working on uh doing",
    "start": "11940",
    "end": "19080"
  },
  {
    "text": "developer advocacy for Google kubernetes engine before that I was at AWS working on some easy cloud services before that",
    "start": "19080",
    "end": "25920"
  },
  {
    "text": "I spent some time at Docker where I was an evangelist there um puppet before that VMware before that",
    "start": "25920",
    "end": "33360"
  },
  {
    "text": "Microsoft before that so been doing this for a long time been in sort of the cloud container virtualization space for",
    "start": "33360",
    "end": "41879"
  },
  {
    "text": "um about 15 years and so I'm going to try to bring all that experience in and talk a little bit about Falco and how",
    "start": "41879",
    "end": "48960"
  },
  {
    "text": "you can detect behavioral patterns or activities that will lead you to",
    "start": "48960",
    "end": "54420"
  },
  {
    "text": "understand when you might be undergoing an attack or an exploit so we're going to do that in the context of 5 famous",
    "start": "54420",
    "end": "61079"
  },
  {
    "text": "exploits so we're going to start with a quick overview of Falco and after that we're going to look at",
    "start": "61079",
    "end": "66659"
  },
  {
    "text": "these five different exploits and we'll have a demo for each one neo4j log4j a",
    "start": "66659",
    "end": "71700"
  },
  {
    "text": "path traversal attack on Apache um actually path reversal kind of is in all of the or in several of these",
    "start": "71700",
    "end": "78720"
  },
  {
    "text": "um a web logic uh console access remote execution again it's kind of through",
    "start": "78720",
    "end": "83820"
  },
  {
    "text": "path reversal and then uh Jenkins uh a Jenkins um exploit so um and then we'll",
    "start": "83820",
    "end": "90180"
  },
  {
    "text": "wrap up with a quick discussion discussion about um the rest of Falco's ecosystem uh in",
    "start": "90180",
    "end": "95700"
  },
  {
    "text": "the context of how you might use it um in what we talked about today um and then I'll leave you with some",
    "start": "95700",
    "end": "100799"
  },
  {
    "text": "additional resources um all right so let's jump in there if we go back uh a while and we think about",
    "start": "100799",
    "end": "108740"
  },
  {
    "text": "how we used to describe security we would almost always say firewall like",
    "start": "108740",
    "end": "114060"
  },
  {
    "text": "our systems were inside data centers they had this well-defined perimeter and what you needed to do was just keep",
    "start": "114060",
    "end": "119880"
  },
  {
    "text": "people out we weren't sort of in this space at all where we're thinking about zero trust we we looked at most of the",
    "start": "119880",
    "end": "126240"
  },
  {
    "text": "threats coming from the outside and we knew that if somebody had gotten into your space you probably had a problem",
    "start": "126240",
    "end": "131819"
  },
  {
    "text": "right well if you compare that to where we are today with the cloud there isn't",
    "start": "131819",
    "end": "137940"
  },
  {
    "text": "this idea of a well-defined perimeter right your your systems and your",
    "start": "137940",
    "end": "143940"
  },
  {
    "text": "um devices many of them sit directly on the internet you think of Internet of things all of these items you know",
    "start": "143940",
    "end": "149580"
  },
  {
    "text": "there's still a firewall in place but there's a lot more exposure so if you want to have fun go put an ec2 instance",
    "start": "149580",
    "end": "156959"
  },
  {
    "text": "or a gke instance or an Azure instance or Oracle Cloud instance whatever any Cloud digitalocean I don't care take one",
    "start": "156959",
    "end": "163260"
  },
  {
    "text": "of them put one of those their virtual machines out on the internet with a public-facing uh network interface and",
    "start": "163260",
    "end": "170760"
  },
  {
    "text": "see what happens it'll take a matter of seconds before it's inundated with people out there trying to figure out if",
    "start": "170760",
    "end": "176519"
  },
  {
    "text": "there's a way for them to get onto the system and then if you think about Cloud as",
    "start": "176519",
    "end": "181620"
  },
  {
    "text": "well there's a whole nother layer of responsibility right you have I am",
    "start": "181620",
    "end": "186840"
  },
  {
    "text": "identity and access management you've got networking policies you've got virtual private networks you've got",
    "start": "186840",
    "end": "192480"
  },
  {
    "text": "Network address translation tables you've got a whole bunch of different services that go together to secure your",
    "start": "192480",
    "end": "200700"
  },
  {
    "text": "environment and you have to make sure that the teams that you work with are using those appropriately and that",
    "start": "200700",
    "end": "206400"
  },
  {
    "text": "they're following operational best practices right they need to make sure they're not doing things like committing",
    "start": "206400",
    "end": "211760"
  },
  {
    "text": "uh API Keys into public GitHub repositories for instance which is something I have done right I'll talk",
    "start": "211760",
    "end": "218459"
  },
  {
    "text": "about things you shouldn't do and when I talk about things you shouldn't do you can be assured I've almost certainly done them I have done that I have put my",
    "start": "218459",
    "end": "225599"
  },
  {
    "text": "uh you know public key or excuse me my private key for my public Cloud up on",
    "start": "225599",
    "end": "231120"
  },
  {
    "text": "the you know a GitHub repo where people get it and then you need to be able to understand you know these things I had",
    "start": "231120",
    "end": "238440"
  },
  {
    "text": "somebody tell me recently in a conversation that you know the most dangerous person in you know to your",
    "start": "238440",
    "end": "245760"
  },
  {
    "text": "system to your integrity of your systems is a disgruntled former employee and I",
    "start": "245760",
    "end": "250799"
  },
  {
    "text": "thought yeah I mean that's pretty dangerous they can do a lot of damage they have keys if they if you know if",
    "start": "250799",
    "end": "255900"
  },
  {
    "text": "they're upset they can do a bunch of stuff on their way out the door if you don't know what's happening um but I actually think the the more",
    "start": "255900",
    "end": "262139"
  },
  {
    "text": "riskier person um is the overworked systems operator engineer whatever this person who makes",
    "start": "262139",
    "end": "270540"
  },
  {
    "text": "an honest mistake right and they're not trying to cause problems they just make a mistake or",
    "start": "270540",
    "end": "277860"
  },
  {
    "text": "they take a shortcut right thinking hey this isn't a big deal I'm just going to Shell into this container real fast and",
    "start": "277860",
    "end": "283919"
  },
  {
    "text": "do something those type of activities you need to be aware of them right because that's where",
    "start": "283919",
    "end": "289280"
  },
  {
    "text": "vulnerabilities can be introduced they're where prac you know you've defined rules of the way you operate and",
    "start": "289280",
    "end": "295139"
  },
  {
    "text": "when those get deviated from they can either be an indication of something bad happening or an indication of something",
    "start": "295139",
    "end": "301800"
  },
  {
    "text": "um that might lead to something bad happening so if you have a wall around your your",
    "start": "301800",
    "end": "307199"
  },
  {
    "text": "property or around your business or whatever and someone gets over that wall or maybe they're already inside because",
    "start": "307199",
    "end": "313979"
  },
  {
    "text": "we talked about you know somebody making a mistake or somebody being disgruntled how do you know what's going on well",
    "start": "313979",
    "end": "320040"
  },
  {
    "text": "you might use a security camera right your security camera to monitor the the inside of the thing you could you could",
    "start": "320040",
    "end": "326100"
  },
  {
    "text": "be looking for people wandering around that aren't supposed to be there or maybe people doing something suspicious and you could be alerted to that right",
    "start": "326100",
    "end": "332400"
  },
  {
    "text": "and that is you know that's kind of the next level of protection so even with",
    "start": "332400",
    "end": "338639"
  },
  {
    "text": "the perimeter with or without a perimeter you know a security camera is always good to have and if you don't",
    "start": "338639",
    "end": "345000"
  },
  {
    "text": "have a perimeter like the cloud it's more important to have a good security camera that doesn't necessarily to have a good lock if you've got no fences",
    "start": "345000",
    "end": "351840"
  },
  {
    "text": "around your property security cameras are going to be your next best thing so and that's kind of how we look at",
    "start": "351840",
    "end": "357720"
  },
  {
    "text": "Falco we look at Falco as a security camera for your workloads so what we do",
    "start": "357720",
    "end": "363180"
  },
  {
    "text": "with Falco is we monitor systems in real time runtime and we call you know open",
    "start": "363180",
    "end": "370259"
  },
  {
    "text": "source runtime solution security solution so at real time or at runtime we're monitoring what's happening inside",
    "start": "370259",
    "end": "376680"
  },
  {
    "text": "the system and we're looking for threats and either actual threats or patterns",
    "start": "376680",
    "end": "382740"
  },
  {
    "text": "that lead us to believe that there could be a threat and we can do this for kubernetes we can do it for containers we can do it on Virtual machines and",
    "start": "382740",
    "end": "389220"
  },
  {
    "text": "bare metal hosts and we can do it for cloud services right so we are a cncf",
    "start": "389220",
    "end": "394620"
  },
  {
    "text": "project we're in the incubating stage we have applied for graduation um I think we're in the public comment",
    "start": "394620",
    "end": "400680"
  },
  {
    "text": "phase right now uh and we've got about 60 million polls of our images up on Docker Hub and we've got about 6.2 000",
    "start": "400680",
    "end": "407100"
  },
  {
    "text": "stars on GitHub so fairly popular production uh project being used by some",
    "start": "407100",
    "end": "412620"
  },
  {
    "text": "big companies to do genome keep help keep their environment safe so how does",
    "start": "412620",
    "end": "418080"
  },
  {
    "text": "it work so this is this is one slide I usually take a lot more time on this but I want",
    "start": "418080",
    "end": "423360"
  },
  {
    "text": "to I want to get to the the exploits so with Falco what we do is we you know at",
    "start": "423360",
    "end": "430560"
  },
  {
    "text": "the most basic level we have a kernel driver a Falco driver that sits and has to interface with the kernel we can",
    "start": "430560",
    "end": "436680"
  },
  {
    "text": "either do that through a loadable kernel module or an ebpf probe and what we're doing is we're capturing sys calls so",
    "start": "436680",
    "end": "442919"
  },
  {
    "text": "everything that happens in the operating system is going to go through a system call so if somebody opens a file or",
    "start": "442919",
    "end": "448500"
  },
  {
    "text": "moves a file or accesses a network port or anything like that we're going to know that",
    "start": "448500",
    "end": "454199"
  },
  {
    "text": "um and we'll know that for containers as well because containers share the same kernel as the operating system right so",
    "start": "454199",
    "end": "460020"
  },
  {
    "text": "we instrument the Opera the kernel we capture those system call events we put them in a ring buffer and then they get",
    "start": "460020",
    "end": "466440"
  },
  {
    "text": "pulled up into user space right so we operate with a with a Falco driver on kernel space and then we have a",
    "start": "466440",
    "end": "472440"
  },
  {
    "text": "companion component that runs in user space that compares those activities against a set of rules to know whether",
    "start": "472440",
    "end": "480120"
  },
  {
    "text": "or not we need to let you know what's happening and by default we can send alerts to standard out syslog https grpc",
    "start": "480120",
    "end": "487139"
  },
  {
    "text": "right so that that user space kernel or that user-based component excuse me does a lot of things but the primary thing is",
    "start": "487139",
    "end": "493680"
  },
  {
    "text": "it does rule matching and then it does something called enrichment which is coupling metadata with syscall data to",
    "start": "493680",
    "end": "500580"
  },
  {
    "text": "produce output messages that you can read right so we'll tell you what the container ID is what the file name was",
    "start": "500580",
    "end": "505620"
  },
  {
    "text": "who the user was what was the parent process what was the child process all",
    "start": "505620",
    "end": "511020"
  },
  {
    "text": "of these things to make it easier for you to go off and do forensics and troubleshoot so at the most basic level",
    "start": "511020",
    "end": "516360"
  },
  {
    "text": "we capture events from system calls We compare them against a set of rules if something is out of whack we let you",
    "start": "516360",
    "end": "521880"
  },
  {
    "text": "know um and this is a Falco rule this isn't the output of a Falco rule right so this",
    "start": "521880",
    "end": "527880"
  },
  {
    "text": "is one where we're telling you a shell will spawned in a container with an attached terminal so someone did Docker",
    "start": "527880",
    "end": "534000"
  },
  {
    "text": "exact minus I.T you know my container slash bin slash bash right and we fired",
    "start": "534000",
    "end": "539820"
  },
  {
    "text": "up a bash shell in a running container which is you know might be a a thing you do but most the time for production",
    "start": "539820",
    "end": "547440"
  },
  {
    "text": "workloads it's probably not something you should be doing right so we wanted to let you know when it happens",
    "start": "547440",
    "end": "552720"
  },
  {
    "text": "um and then here's one you know netcat running inside a container well that could be indicative of a whole bunch of",
    "start": "552720",
    "end": "558540"
  },
  {
    "text": "things many of them bad um and we're going to actually use netcat in in a few of our demos today",
    "start": "558540",
    "end": "565320"
  },
  {
    "text": "um to do reverse shell for instance so we let you know about that now rules have multiple levels",
    "start": "565320",
    "end": "570660"
  },
  {
    "text": "um notices warnings critical uh errors I think is one sometimes I forget all of",
    "start": "570660",
    "end": "576540"
  },
  {
    "text": "them um and then we um and rules are customizable you can create your own rules we ship with about 80 default",
    "start": "576540",
    "end": "584459"
  },
  {
    "text": "rules you can augment them you can change them you can add your own you can",
    "start": "584459",
    "end": "590100"
  },
  {
    "text": "disable them all kinds of different things to make sure that you have rules that meet your needs so that is Falco I",
    "start": "590100",
    "end": "598740"
  },
  {
    "text": "detect events I compare them to rules I let you know if something is awry so how can that be used to help you",
    "start": "598740",
    "end": "606720"
  },
  {
    "text": "when uh an exploit might be happening predominantly we're not going to tell",
    "start": "606720",
    "end": "612000"
  },
  {
    "text": "you if you're running a piece of code that is vulnerable right that's image",
    "start": "612000",
    "end": "617399"
  },
  {
    "text": "scanning and or registry scanning and all kinds of things will do that what we do and in some cases we can't do that",
    "start": "617399",
    "end": "624360"
  },
  {
    "text": "but for the most part what we're going to do is we're going to show you activities that look like an attack is",
    "start": "624360",
    "end": "629940"
  },
  {
    "text": "happening right so did someone run netcap for instance is somebody uh",
    "start": "629940",
    "end": "635279"
  },
  {
    "text": "dropping a new binary into a container and running it that wasn't there before we're going to alert you so that sort of",
    "start": "635279",
    "end": "641760"
  },
  {
    "text": "behavior that's what we're going to see in these five exploits all right so the first export we're",
    "start": "641760",
    "end": "647459"
  },
  {
    "text": "going to look like look at is neo4j and uh neo4j is a graph database and in",
    "start": "647459",
    "end": "654420"
  },
  {
    "text": "versions Point through 3.418 when you had your shell server enabled",
    "start": "654420",
    "end": "659940"
  },
  {
    "text": "um there was the Expo there was a remote method invocation service an RMA service that was exposed and it will this",
    "start": "659940",
    "end": "668820"
  },
  {
    "text": "service would arbitrarily deserialize Java objects so what does that mean so when you need to put things together in",
    "start": "668820",
    "end": "675060"
  },
  {
    "text": "Java strings of bytes you can serialize them right and you can you can add all these things together in what's called a",
    "start": "675060",
    "end": "680579"
  },
  {
    "text": "chain and then you can send that out and then the receiving um code would deserialize that and then",
    "start": "680579",
    "end": "687600"
  },
  {
    "text": "it would just go and execute it well because it was arbitrarily deserializing",
    "start": "687600",
    "end": "693720"
  },
  {
    "text": "these objects it wasn't really checking them you could put whatever you wanted in them and they could they could have bad",
    "start": "693720",
    "end": "701160"
  },
  {
    "text": "code and whenever it was deserialized it was just gonna run and so the issue here",
    "start": "701160",
    "end": "707640"
  },
  {
    "text": "is that someone can take create a um a set of serialized code they could",
    "start": "707640",
    "end": "713760"
  },
  {
    "text": "send it to the neo4j server and that code gets executed so what we're going",
    "start": "713760",
    "end": "718800"
  },
  {
    "text": "to actually do is we're going to ship some code up to the server we're gonna",
    "start": "718800",
    "end": "723839"
  },
  {
    "text": "we're gonna get it installed we're getting running and then that's going to execute so you'll see that in the demo",
    "start": "723839",
    "end": "729779"
  },
  {
    "text": "and what you're going to see from Falco is that we don't tell you that you're running the wrong version of neo4j what",
    "start": "729779",
    "end": "736079"
  },
  {
    "text": "we tell you is hey somebody copied a file up here they probably shouldn't do",
    "start": "736079",
    "end": "741300"
  },
  {
    "text": "that um and and also there's a binary that's running now that was not in your base",
    "start": "741300",
    "end": "747180"
  },
  {
    "text": "engine um so now again this has been fixed they've",
    "start": "747180",
    "end": "752220"
  },
  {
    "text": "they've they've replaced this this shell object and and in later versions so it's it's a known exploit but there is a",
    "start": "752220",
    "end": "759480"
  },
  {
    "text": "defense against it as is the case in every one of these I'm not showing you anything that hasn't been out for a while that there aren't easy fixes",
    "start": "759480",
    "end": "765720"
  },
  {
    "text": "available for so um okay so let's take a look at this now as",
    "start": "765720",
    "end": "771240"
  },
  {
    "text": "you can see here I've got the neo4j server running now I've got the neo4j server I'm going to be using something",
    "start": "771240",
    "end": "776700"
  },
  {
    "text": "called exploit.jar and that is a wrapper that I downloaded from volhub and it",
    "start": "776700",
    "end": "783000"
  },
  {
    "text": "allows us to send commands to This Server so let's go ahead and jump into that so the first thing I'm going to do",
    "start": "783000",
    "end": "789300"
  },
  {
    "text": "is I'm going to use exploit.jar to just touch a file on the system right create a new file so exploit.jar URL of the",
    "start": "789300",
    "end": "797040"
  },
  {
    "text": "neo4j server touchtemp.owned if I go over and I look at the directory structure of the neo4j server which is",
    "start": "797040",
    "end": "804240"
  },
  {
    "text": "running in a Docker container I go into the Container I look at the temp directory there's that owned file so you",
    "start": "804240",
    "end": "810000"
  },
  {
    "text": "can see that I was able to send that payload in via the the shell interface",
    "start": "810000",
    "end": "815220"
  },
  {
    "text": "now let's do the same thing I'm going to download a crypto Miner here XM rig and",
    "start": "815220",
    "end": "820440"
  },
  {
    "text": "now I'm going to extract that crypto Miner onto the system and let me clear the screen because it's getting a little",
    "start": "820440",
    "end": "826260"
  },
  {
    "text": "bit crowded and um then we're going to go ahead and let's go ahead and actually execute XM",
    "start": "826260",
    "end": "832800"
  },
  {
    "text": "rig so we're just going to give it a command tell go mine some Monero and again if I go back over to the neo4j",
    "start": "832800",
    "end": "839300"
  },
  {
    "text": "docker container and I do a PS against that actually I can just do it here on the host",
    "start": "839300",
    "end": "845279"
  },
  {
    "text": "um I can see XM rig is running here on the host and I've actually killed it so now if I go into sidekick UI I've got",
    "start": "845279",
    "end": "852540"
  },
  {
    "text": "the zoomed in a little bit so it's easier to read um you can see here that is where you know this is where I copied the file in",
    "start": "852540",
    "end": "859560"
  },
  {
    "text": "and this is the the the notification we got and this is the notification that we",
    "start": "859560",
    "end": "864660"
  },
  {
    "text": "were executing a binary that was not part of that base image the next one we're going to look at is",
    "start": "864660",
    "end": "871500"
  },
  {
    "text": "log4j and so log4j pretty famous um it's a logging server and log4j uses",
    "start": "871500",
    "end": "877920"
  },
  {
    "text": "something called jndi which is the Java naming and directory interface and jdi",
    "start": "877920",
    "end": "883440"
  },
  {
    "text": "can pull objects from directory services so when uh an entry is written to the log that entry could actually be hey go",
    "start": "883440",
    "end": "890820"
  },
  {
    "text": "pull this information from this directory service and um and and then bring it bring it on in",
    "start": "890820",
    "end": "897660"
  },
  {
    "text": "and the thing is that those objects can be just information they could be text or whatever but they can also be code",
    "start": "897660",
    "end": "904320"
  },
  {
    "text": "right and um in certain versions of log4j this",
    "start": "904320",
    "end": "911040"
  },
  {
    "text": "code was going to be arbitrarily executed so you would basically you know",
    "start": "911040",
    "end": "916260"
  },
  {
    "text": "it's a fairly you know complex compared to you know it's the most complex one",
    "start": "916260",
    "end": "921899"
  },
  {
    "text": "we're showing today or there's others obviously they're much more complex than this but this is a little more complex than what we showed in the last one so",
    "start": "921899",
    "end": "927240"
  },
  {
    "text": "what we have here is we're going to set up an ldap server a lightweight directory access protocol server",
    "start": "927240",
    "end": "933480"
  },
  {
    "text": "and that's one of the servers that Jandy I can communicate with and we're going to set up an ldap server and we're going",
    "start": "933480",
    "end": "939839"
  },
  {
    "text": "to have a object out there that is malicious and what it will do is it will",
    "start": "939839",
    "end": "945180"
  },
  {
    "text": "instantiate a reverse shell and so you're going to see me start an ldap server start up a",
    "start": "945180",
    "end": "952320"
  },
  {
    "text": "um a listener and then we're going to execute this remote shell back using this object so",
    "start": "952320",
    "end": "959279"
  },
  {
    "text": "um you know and what's going to happen with Falco is Falco is going to say Hey you know someone's sending standard out",
    "start": "959279",
    "end": "965459"
  },
  {
    "text": "to a network connection right they're redirecting the console and uh netcat is",
    "start": "965459",
    "end": "970800"
  },
  {
    "text": "also running so these two things combined are probably not good even on their own they're not good so let's take a look at that demo",
    "start": "970800",
    "end": "976800"
  },
  {
    "text": "um and see how this works in action okay this is a Java application that",
    "start": "976800",
    "end": "983820"
  },
  {
    "text": "logs logins attempts to log4j so when I go to log in what I'm going to do is I'm",
    "start": "983820",
    "end": "989519"
  },
  {
    "text": "going to send it a directory query through JD ndi to a server that has a",
    "start": "989519",
    "end": "995040"
  },
  {
    "text": "bad payload so let me start by starting that server I'm going to start it on 104 155 96 228 let me start up my netcat",
    "start": "995040",
    "end": "1003320"
  },
  {
    "text": "listener here so this is the endpoint for my reverse shell now I'm going to go ahead and I'm going to create that",
    "start": "1003320",
    "end": "1009980"
  },
  {
    "text": "payload so basically you can see the IP address there of my ldap server and I'm",
    "start": "1009980",
    "end": "1015680"
  },
  {
    "text": "saying take this command which is netcat to my endpoint and run it so when I log",
    "start": "1015680",
    "end": "1023300"
  },
  {
    "text": "in with this it's going to send that command to log4j log4j is going to do",
    "start": "1023300",
    "end": "1029600"
  },
  {
    "text": "the ldap query and it's going to start the shell so now if I come over here I",
    "start": "1029600",
    "end": "1035298"
  },
  {
    "text": "am logged in right so I can look at the file systems I'm root I can take a look at the processes all of that stuff so",
    "start": "1035299",
    "end": "1043520"
  },
  {
    "text": "how does this look in Falco so let's go back to the Falco UI and here you can see I'm redirecting my standard out I've",
    "start": "1043520",
    "end": "1050600"
  },
  {
    "text": "got netcat running so I've been alerted to both of these things which could be absolutely problematic so then from",
    "start": "1050600",
    "end": "1056780"
  },
  {
    "text": "there you could decide how you were going to handle it the next one we're going to look at is a",
    "start": "1056780",
    "end": "1063620"
  },
  {
    "text": "path traversal exploit so patch reversal is the idea of trying to break out of a",
    "start": "1063620",
    "end": "1069559"
  },
  {
    "text": "directory structure and move you know through the directory or the file system traversing different paths right or",
    "start": "1069559",
    "end": "1075860"
  },
  {
    "text": "different directories and normally you have something in in the system and Apache has this it's called path",
    "start": "1075860",
    "end": "1080960"
  },
  {
    "text": "normalization and path normalization looks for things that shouldn't be there right and you know if if it would see",
    "start": "1080960",
    "end": "1088760"
  },
  {
    "text": "somebody going like web root dot dot dot dot dot dot and try to get up out of that direction structure and be like",
    "start": "1088760",
    "end": "1093860"
  },
  {
    "text": "that's not cool we can't do that the problem was in this very specific version of Apache 2.4.49 there is the",
    "start": "1093860",
    "end": "1101900"
  },
  {
    "text": "ASCII character percent to e that in ASCII represents dot the normalization",
    "start": "1101900",
    "end": "1107360"
  },
  {
    "text": "didn't treat it as a dot it just treated it as a string so the normalization uh",
    "start": "1107360",
    "end": "1113660"
  },
  {
    "text": "function looked at it and went oh okay and it just passed that on through and",
    "start": "1113660",
    "end": "1118760"
  },
  {
    "text": "then then when the web server got it it and interpreted the URL it knew that",
    "start": "1118760",
    "end": "1124340"
  },
  {
    "text": "percent 2E was a DOT so percent two e made it through normalization and then was executed so percent two we present",
    "start": "1124340",
    "end": "1130700"
  },
  {
    "text": "to e slash would be the same as dot dot slash which would allow you to break out of the web root now if you had CGI",
    "start": "1130700",
    "end": "1138799"
  },
  {
    "text": "installed on the system and CGI is a very common um uh scripting language programming",
    "start": "1138799",
    "end": "1144559"
  },
  {
    "text": "language or interface for uh Apache servers if CGI was enabled",
    "start": "1144559",
    "end": "1150919"
  },
  {
    "text": "um you could actually couple that path reversal with remote code execution right so you know with just the path",
    "start": "1150919",
    "end": "1157340"
  },
  {
    "text": "reversal you could look at sensitive files but with if CGI was installed you could actually invoke scripts to run and",
    "start": "1157340",
    "end": "1165260"
  },
  {
    "text": "that's what we're going to do and so we're gonna first show how a sensitive file was detected how it was access was",
    "start": "1165260",
    "end": "1170660"
  },
  {
    "text": "detected so we're going to look at pam.com we're gonna which is the configuration file",
    "start": "1170660",
    "end": "1175700"
  },
  {
    "text": "um and Falco is going to tell us that happened and then we're going to use um uh this uh CGI chaining together with",
    "start": "1175700",
    "end": "1184880"
  },
  {
    "text": "this the C this vulnerability to get a shell access onto the system",
    "start": "1184880",
    "end": "1190160"
  },
  {
    "text": "so let's take a look at that now okay so here's my Apache server with a",
    "start": "1190160",
    "end": "1195320"
  },
  {
    "text": "very simple web page the first thing I'm going to try to do is just use Curl to",
    "start": "1195320",
    "end": "1200900"
  },
  {
    "text": "take a look at a a an icon on the system so if I do a curl against the Apache",
    "start": "1200900",
    "end": "1206720"
  },
  {
    "text": "address and say show me the a.jif it shows up just fine now if I try to go",
    "start": "1206720",
    "end": "1212179"
  },
  {
    "text": "ahead and get to the pam.conf file using dotted notation relative to the icons",
    "start": "1212179",
    "end": "1218120"
  },
  {
    "text": "directory so dot dot backslash dot dot backslash Etsy pump Pam comp that fails that's not",
    "start": "1218120",
    "end": "1224000"
  },
  {
    "text": "going to work but if I take those dots and replace them with percent two e's and try to access it it actually works",
    "start": "1224000",
    "end": "1230480"
  },
  {
    "text": "so that's the problem so now what I'm going to do is because CGI is installed",
    "start": "1230480",
    "end": "1235820"
  },
  {
    "text": "I'm going to use that same command only this time I'm going to tell it to fire up a shell so it's done that so if you",
    "start": "1235820",
    "end": "1244280"
  },
  {
    "text": "see here it's the same thing bin shell so Falco should have picked that up so if I go into Falco here enter the UI and",
    "start": "1244280",
    "end": "1250820"
  },
  {
    "text": "I go to the event you can see that we're getting a warning that a shell was spawned by an untrusted process that",
    "start": "1250820",
    "end": "1257120"
  },
  {
    "text": "Apache spawned a shell and that's something we should look into all right the next one we're going to",
    "start": "1257120",
    "end": "1263000"
  },
  {
    "text": "look at is Oracle web logic and now this is actually 2 two two vulnerabilities",
    "start": "1263000",
    "end": "1270799"
  },
  {
    "text": "chained together the very first one uh 14882 is a past reversal attack only instead of like in the last one you saw",
    "start": "1270799",
    "end": "1277280"
  },
  {
    "text": "percent two EE and this one uses uh 25 2E um and it it doesn't it it doesn't get",
    "start": "1277280",
    "end": "1284360"
  },
  {
    "text": "normalized now so that gets treated as a DOT and if you send a URL formatted with",
    "start": "1284360",
    "end": "1290179"
  },
  {
    "text": "that ASCII string you are going to bypass the console console authentication so",
    "start": "1290179",
    "end": "1295880"
  },
  {
    "text": "with just that exploit alone you can go to a weblogic server if you've got access to it right and you can get to",
    "start": "1295880",
    "end": "1301880"
  },
  {
    "text": "the admin console now there are Java methods that allow you to execute remote",
    "start": "1301880",
    "end": "1308000"
  },
  {
    "text": "code and if you chain 14883 with 14882",
    "start": "1308000",
    "end": "1313100"
  },
  {
    "text": "you can bypass authentication pass in that one of those Java methods and say",
    "start": "1313100",
    "end": "1319640"
  },
  {
    "text": "hey run this code and it will do that right so we're going to use this",
    "start": "1319640",
    "end": "1326120"
  },
  {
    "text": "um this exploit these two exploits together to bypass ontication install a",
    "start": "1326120",
    "end": "1331880"
  },
  {
    "text": "crypto mining rig and run it and then Falco is going to again detect a remote file copy and it's going to also tell",
    "start": "1331880",
    "end": "1338299"
  },
  {
    "text": "you hey this thing is running and it wasn't part of the base image that's XM red and we're going to alert you to that",
    "start": "1338299",
    "end": "1344000"
  },
  {
    "text": "so again we don't we don't tell you that these vulnerabilities were running in",
    "start": "1344000",
    "end": "1349460"
  },
  {
    "text": "you know explicitly we tell you here's some things that happen that should be looked at all right so let's take a look",
    "start": "1349460",
    "end": "1355580"
  },
  {
    "text": "at that one okay so here's the login for the weblogic server and if I go up here and",
    "start": "1355580",
    "end": "1363080"
  },
  {
    "text": "I change the url and I go ahead and you see I'm going to put in those percent 25",
    "start": "1363080",
    "end": "1369020"
  },
  {
    "text": "2es to navigate to the console and by doing that I'm going to go ahead and",
    "start": "1369020",
    "end": "1374299"
  },
  {
    "text": "bypass the authentication so here I am I'm on the console at this point and I have full access to the system so what",
    "start": "1374299",
    "end": "1381620"
  },
  {
    "text": "I'm going to do next is I'm going to take this and I'm going to add some commands to it so that I'm able to",
    "start": "1381620",
    "end": "1388280"
  },
  {
    "text": "execute commands arbitrarily without uh authenticating so I'll go in here so I'm",
    "start": "1388280",
    "end": "1394520"
  },
  {
    "text": "going to do that same percent 25 2E in the URL but I'm going to use the Java language get runtime.exec method to go",
    "start": "1394520",
    "end": "1402860"
  },
  {
    "text": "ahead and just create a file on the server so let me go over and check the server and you can see here that that",
    "start": "1402860",
    "end": "1409280"
  },
  {
    "text": "file now exists okay so now what we're going to do is we're going to use that same methodology",
    "start": "1409280",
    "end": "1414940"
  },
  {
    "text": "to download xmrig the crypto Miner and so I've got that downloaded here you can",
    "start": "1414940",
    "end": "1420500"
  },
  {
    "text": "see I basically did a curl as the command and then coming out of that we'll go ahead and we'll use tar to",
    "start": "1420500",
    "end": "1426380"
  },
  {
    "text": "extract that and then we'll go ahead one more time and we will use the same methodology to go ahead and execute that",
    "start": "1426380",
    "end": "1433640"
  },
  {
    "text": "and get that running so now I have downloaded I have extracted and I am now",
    "start": "1433640",
    "end": "1439400"
  },
  {
    "text": "running the crypto Miner on the system so let's go ahead now and we'll take a look and if I look on the Oracle",
    "start": "1439400",
    "end": "1446360"
  },
  {
    "text": "weblogic server there is XM rig running as expected so what did Falco see so if",
    "start": "1446360",
    "end": "1452299"
  },
  {
    "text": "we go into events and there we go it's drop and execute a new binary in a",
    "start": "1452299",
    "end": "1457760"
  },
  {
    "text": "container basically there's a there's something running in this container that wasn't there before so that's what or",
    "start": "1457760",
    "end": "1465140"
  },
  {
    "text": "that is what uh Falco picked up and that's what you would need to take action on",
    "start": "1465140",
    "end": "1471020"
  },
  {
    "text": "so our next uh Expo that we're going to talk about is in the Jenkins server",
    "start": "1471020",
    "end": "1476299"
  },
  {
    "text": "right and Jenkins is a CI CD tool that is uh very widely used for build",
    "start": "1476299",
    "end": "1481580"
  },
  {
    "text": "pipelines testing uh automation all kinds of different stuff and so that makes it a target for hackers right",
    "start": "1481580",
    "end": "1487580"
  },
  {
    "text": "because it's just so widely deployed um and uh there's a CV out there that's",
    "start": "1487580",
    "end": "1494179"
  },
  {
    "text": "based around the stapler framework which is a Java framework that Jenkins is built using and",
    "start": "1494179",
    "end": "1501440"
  },
  {
    "text": "um stapler allows users to call public methods through a URL and there is a",
    "start": "1501440",
    "end": "1508820"
  },
  {
    "text": "vulnerability where um well typically these these calls are made inside of a groovy sandbox groovy",
    "start": "1508820",
    "end": "1515240"
  },
  {
    "text": "is like a Java based scripting language that Jenkins uses and typically there's",
    "start": "1515240",
    "end": "1520700"
  },
  {
    "text": "restrictions around what can happen inside of that sandbox it only allows certain methods to be called however",
    "start": "1520700",
    "end": "1528500"
  },
  {
    "text": "um there were there was does an error or a bug here where",
    "start": "1528500",
    "end": "1535159"
  },
  {
    "text": "um that The Groovy sandbox could be bypassed and allowed unauthorized users to execute arbitrary commands Jenkins",
    "start": "1535159",
    "end": "1541700"
  },
  {
    "text": "checks the script for errors before executing groovy in the sandbox so that the check operation isn't not actually",
    "start": "1541700",
    "end": "1548480"
  },
  {
    "text": "sandboxed right and the attacker can use meta programming to execute arbitrary commands while in this checking step so",
    "start": "1548480",
    "end": "1556400"
  },
  {
    "text": "um that's what we're going to show here in this next Lab so let's take a look at that and see how it works",
    "start": "1556400",
    "end": "1564220"
  },
  {
    "text": "okay here's our Jenkins server I'm going to log in now one of the problems with Jenkins is the default username and password admin admin on This Server so",
    "start": "1566120",
    "end": "1573020"
  },
  {
    "text": "I'm in the console I'm just showing it to you I'm not really going to use it I'm going to actually move into the command line here and the first thing",
    "start": "1573020",
    "end": "1578960"
  },
  {
    "text": "I'm going to do is I'm going to I'm going to issue a command to um just create a file like we've done",
    "start": "1578960",
    "end": "1584299"
  },
  {
    "text": "before and so you'll notice that the command is touch temp.own and we're going to create this encoded string here",
    "start": "1584299",
    "end": "1590600"
  },
  {
    "text": "and we're going to pass it in if you look at the if you look at that URL at",
    "start": "1590600",
    "end": "1595760"
  },
  {
    "text": "the end there you can see it's that check script routine that we talked about before so it's in the secure",
    "start": "1595760",
    "end": "1601100"
  },
  {
    "text": "groovy sandbox type of thing and we're going to do the check script um and then we're going to pass in that",
    "start": "1601100",
    "end": "1607220"
  },
  {
    "text": "value and then what we're going to see is that if I go over here and you know",
    "start": "1607220",
    "end": "1612260"
  },
  {
    "text": "Jenkins is in a container so if I look at the docker container look at the file system there it is the file that we just",
    "start": "1612260",
    "end": "1618440"
  },
  {
    "text": "created okay so let's set up a reverse shell using this exploit so I've got a netcat",
    "start": "1618440",
    "end": "1623720"
  },
  {
    "text": "listener that I'm setting up here on this machine and then I'm going to move back over to the original machine and",
    "start": "1623720",
    "end": "1629299"
  },
  {
    "text": "I'm going to issue a command to download uh netcat and put it here on this",
    "start": "1629299",
    "end": "1634460"
  },
  {
    "text": "machine now I've I've wrapped these commands in a python wrapper so that I don't have to have that long command",
    "start": "1634460",
    "end": "1640039"
  },
  {
    "text": "that we used before but I've downloaded netcat I've changed the executable bit and now it's running so I come over to",
    "start": "1640039",
    "end": "1646159"
  },
  {
    "text": "my original machine and you can see I'm logged into the Jenkins server and I can list out the directories so this machine",
    "start": "1646159",
    "end": "1651980"
  },
  {
    "text": "has now been compromised so what did Falco see let's pop back over to the events Tab",
    "start": "1651980",
    "end": "1658279"
  },
  {
    "text": "and here you can see we're getting the warning that we've been someone's been",
    "start": "1658279",
    "end": "1663380"
  },
  {
    "text": "redirecting standard and send it out to a network connection which is the end cap process and that's what's giving us",
    "start": "1663380",
    "end": "1668720"
  },
  {
    "text": "our Rochelle so that's an example of how this exploit can be used",
    "start": "1668720",
    "end": "1675020"
  },
  {
    "text": "all right so we've looked at the vulnerabilities um so you see Falco running as you know",
    "start": "1675020",
    "end": "1680059"
  },
  {
    "text": "as we described it originally which was like look we take system calls and we look at them and we take we do some sort",
    "start": "1680059",
    "end": "1685640"
  },
  {
    "text": "of alerting in this case we're writing writing out to Falco sidekick UI but Falco sidekick can actually do a lot",
    "start": "1685640",
    "end": "1691820"
  },
  {
    "text": "more than that and you can actually take input from a lot more places than just system calls so we have a plug-in",
    "start": "1691820",
    "end": "1698419"
  },
  {
    "text": "architecture that allows you to to look for events from kubernetes Auto logs OCTA cloudtrail GitHub we have a new one",
    "start": "1698419",
    "end": "1705380"
  },
  {
    "text": "for Google Cloud platform that was just released so you can look at things like did someone just publish their their",
    "start": "1705380",
    "end": "1711020"
  },
  {
    "text": "private key op into a GitHub repo did someone just try to access access a system and didn't use multi-factor",
    "start": "1711020",
    "end": "1717919"
  },
  {
    "text": "authentication or did multi-factor authentication fail a bunch of times so and then rather than just sending to",
    "start": "1717919",
    "end": "1723980"
  },
  {
    "text": "standard out standard error we can send that output to sidekick right which is actually what was happening the whole",
    "start": "1723980",
    "end": "1729559"
  },
  {
    "text": "time it was being sent to sidekick and rendered inside kick UI but it can also be sent out to all kinds of different",
    "start": "1729559",
    "end": "1735440"
  },
  {
    "text": "endpoints right so you can send it out to chat servers or chat systems like",
    "start": "1735440",
    "end": "1741080"
  },
  {
    "text": "slack or Discord or teams you can send it out to logs like elastic uh you know",
    "start": "1741080",
    "end": "1746299"
  },
  {
    "text": "message queuing systems you can send that output to functions as a service platforms to metrics platforms to",
    "start": "1746299",
    "end": "1752299"
  },
  {
    "text": "alerting platforms and you could even write it out to a storage bucket so with a sidekick now you can take that output",
    "start": "1752299",
    "end": "1758179"
  },
  {
    "text": "that information and you can start sending it into systems you're already using to let people know that these",
    "start": "1758179",
    "end": "1763580"
  },
  {
    "text": "things are happening or even to take action right so you get that notification it comes into sidekick",
    "start": "1763580",
    "end": "1770179"
  },
  {
    "text": "sidekick could send something to Lambda for instance or open files or whatever so for instance let's say somebody",
    "start": "1770179",
    "end": "1776200"
  },
  {
    "text": "executed a a new binary in a container that could come in you get that",
    "start": "1776200",
    "end": "1782360"
  },
  {
    "text": "notification you said look if this happens if this level happens we want you to go to Lambda and we want to have",
    "start": "1782360",
    "end": "1788899"
  },
  {
    "text": "a function that relabels that container so that it's not running in production anymore but we save it so we can do",
    "start": "1788899",
    "end": "1795380"
  },
  {
    "text": "forensics and then you know then kubernetes when that one comes out of service the the deployment side will",
    "start": "1795380",
    "end": "1801140"
  },
  {
    "text": "just you know fire up a new one and and we'll be on our merry way so that's how you can kind of do detection and",
    "start": "1801140",
    "end": "1806899"
  },
  {
    "text": "Remediation Falco does detection sidekick helps you build remediation you",
    "start": "1806899",
    "end": "1812179"
  },
  {
    "text": "know pipelines or or you know um chains or whatever you want to call them so that's you know plugins and sidekick",
    "start": "1812179",
    "end": "1819799"
  },
  {
    "text": "really complete the Falco story now I want to leave you with some Falco",
    "start": "1819799",
    "end": "1825200"
  },
  {
    "text": "resources the first is our website so you can get us at www.falco.org",
    "start": "1825200",
    "end": "1831140"
  },
  {
    "text": "um our GitHub is github.com Falco security we're always looking for new contributors please you know if you've",
    "start": "1831260",
    "end": "1838820"
  },
  {
    "text": "got an idea if you find an issue if you want to open a pull request head on over there and do that if you've got",
    "start": "1838820",
    "end": "1844640"
  },
  {
    "text": "questions before you do any of those things there's a bunch of different ways to reach us the first is in the",
    "start": "1844640",
    "end": "1851120"
  },
  {
    "text": "kubernetes slack on the hashtag Falco Channel pound Falco Channel",
    "start": "1851120",
    "end": "1857059"
  },
  {
    "text": "um on that slack server so we're in there the maintainers the contributors a very active community members",
    "start": "1857059",
    "end": "1863419"
  },
  {
    "text": "um they're there all the time to help folks out we also host a weekly Community call at 4 pm GMT 9 A.M Pacific",
    "start": "1863419",
    "end": "1871760"
  },
  {
    "text": "that is um those notifications are published on our LinkedIn so you can go to the",
    "start": "1871760",
    "end": "1876980"
  },
  {
    "text": "LinkedIn to find a link for that Community call as well as get updates from the project and we're also on",
    "start": "1876980",
    "end": "1883340"
  },
  {
    "text": "Twitter we're Falco underscore org on X slash Twitter so you can get us there so",
    "start": "1883340",
    "end": "1890059"
  },
  {
    "text": "with that I want to thank you for your time today uh I hope you've found some useful information here if you have",
    "start": "1890059",
    "end": "1895760"
  },
  {
    "text": "questions I'm at Mike G Coleman pretty much everywhere I'm Mike G Coleman assistant I'm Mike G Coleman on GitHub X",
    "start": "1895760",
    "end": "1902299"
  },
  {
    "text": "Twitter LinkedIn any of those platforms you can just reach out to me and I'll do my best and of course the kubernetes",
    "start": "1902299",
    "end": "1908299"
  },
  {
    "text": "slack um I will do my best to answer your question if I can't get an answer I will find somebody who can so once again",
    "start": "1908299",
    "end": "1914120"
  },
  {
    "text": "thank you very much I hope you found this useful and I look forward to seeing you in the future",
    "start": "1914120",
    "end": "1919539"
  }
]