[
  {
    "text": "hello everyone I hope you guys can hear",
    "start": "560",
    "end": "3480"
  },
  {
    "text": "me um I'm Larisa and today we're going",
    "start": "3480",
    "end": "7040"
  },
  {
    "text": "to talk about tailor deployment",
    "start": "7040",
    "end": "8880"
  },
  {
    "text": "strategies Argo rollouts for diverse",
    "start": "8880",
    "end": "12559"
  },
  {
    "text": "applications but first a little bit",
    "start": "12559",
    "end": "14839"
  },
  {
    "text": "about myself I'm a computer scientist",
    "start": "14839",
    "end": "17359"
  },
  {
    "text": "with the Adobe experience platform group",
    "start": "17359",
    "end": "20199"
  },
  {
    "text": "I've been mostly developing backend",
    "start": "20199",
    "end": "22160"
  },
  {
    "text": "services but I've always had an interest",
    "start": "22160",
    "end": "24680"
  },
  {
    "text": "in",
    "start": "24680",
    "end": "25480"
  },
  {
    "text": "Automation and in the last year and a",
    "start": "25480",
    "end": "27920"
  },
  {
    "text": "half I worked at uh updating our cicd",
    "start": "27920",
    "end": "31759"
  },
  {
    "text": "pipelines with tools such as Argo CD",
    "start": "31759",
    "end": "34640"
  },
  {
    "text": "Argo workflows events and roll outs",
    "start": "34640",
    "end": "37399"
  },
  {
    "text": "today we're going to talk about a use",
    "start": "37399",
    "end": "39680"
  },
  {
    "text": "case of the last one namely Argo roll",
    "start": "39680",
    "end": "44320"
  },
  {
    "text": "outs in experience platform we've always",
    "start": "45039",
    "end": "48399"
  },
  {
    "text": "had a focus on",
    "start": "48399",
    "end": "50120"
  },
  {
    "text": "quality uh every change that we make we",
    "start": "50120",
    "end": "53520"
  },
  {
    "text": "actually uh take that through a series",
    "start": "53520",
    "end": "56320"
  },
  {
    "text": "of various checks and validation before",
    "start": "56320",
    "end": "58760"
  },
  {
    "text": "it goes to production and everything is",
    "start": "58760",
    "end": "61320"
  },
  {
    "text": "automated of course so you can see on on",
    "start": "61320",
    "end": "64640"
  },
  {
    "text": "the screen uh all the checks that we",
    "start": "64640",
    "end": "66920"
  },
  {
    "text": "employ before we merge a",
    "start": "66920",
    "end": "69040"
  },
  {
    "text": "PR uh and we have we start with a basic",
    "start": "69040",
    "end": "72600"
  },
  {
    "text": "code verification then we go on and do a",
    "start": "72600",
    "end": "75560"
  },
  {
    "text": "series",
    "start": "75560",
    "end": "76840"
  },
  {
    "text": "of static analysis from vulner",
    "start": "76840",
    "end": "80000"
  },
  {
    "text": "vulnerability checks to license checks",
    "start": "80000",
    "end": "82079"
  },
  {
    "text": "to code analysis checks and security",
    "start": "82079",
    "end": "84720"
  },
  {
    "text": "scans and if everything checks out we",
    "start": "84720",
    "end": "87759"
  },
  {
    "text": "then go out go on and uh deploy that",
    "start": "87759",
    "end": "90360"
  },
  {
    "text": "code into an fmrl environment and run a",
    "start": "90360",
    "end": "93680"
  },
  {
    "text": "battery of comprehensive functional test",
    "start": "93680",
    "end": "95799"
  },
  {
    "text": "against it we do all of these things to",
    "start": "95799",
    "end": "100079"
  },
  {
    "text": "basically reduce the risk improve",
    "start": "100079",
    "end": "103079"
  },
  {
    "text": "confidence in our releases and uh reduce",
    "start": "103079",
    "end": "106119"
  },
  {
    "text": "change failure",
    "start": "106119",
    "end": "107960"
  },
  {
    "text": "rate when it comes to deployment we",
    "start": "107960",
    "end": "110759"
  },
  {
    "text": "employ a stagered approach we have",
    "start": "110759",
    "end": "112920"
  },
  {
    "text": "multiple vironments up to production and",
    "start": "112920",
    "end": "116320"
  },
  {
    "text": "we deploy the code in each of these",
    "start": "116320",
    "end": "119840"
  },
  {
    "text": "environments and then test it an",
    "start": "119840",
    "end": "122799"
  },
  {
    "text": "automatic uh promotion to the next next",
    "start": "122799",
    "end": "125320"
  },
  {
    "text": "environment or an automatic rollbacks H",
    "start": "125320",
    "end": "128800"
  },
  {
    "text": "roll back happen based on the result of",
    "start": "128800",
    "end": "131160"
  },
  {
    "text": "the deployment and the",
    "start": "131160",
    "end": "132640"
  },
  {
    "text": "tests and in production we're even more",
    "start": "132640",
    "end": "135400"
  },
  {
    "text": "careful and we deploy in groups starting",
    "start": "135400",
    "end": "139239"
  },
  {
    "text": "with smaller regions first and",
    "start": "139239",
    "end": "141040"
  },
  {
    "text": "continuing with the larger ones again we",
    "start": "141040",
    "end": "143480"
  },
  {
    "text": "do all this because we want to reduce",
    "start": "143480",
    "end": "145519"
  },
  {
    "text": "the risk we want to reduce the change",
    "start": "145519",
    "end": "147720"
  },
  {
    "text": "failure rate and we want to",
    "start": "147720",
    "end": "150680"
  },
  {
    "text": "basically reduce the blast radius in",
    "start": "150680",
    "end": "152920"
  },
  {
    "text": "case there is an",
    "start": "152920",
    "end": "154760"
  },
  {
    "text": "issue so you may be thinking that we're",
    "start": "154760",
    "end": "157800"
  },
  {
    "text": "doing a lot of checks right and this",
    "start": "157800",
    "end": "160239"
  },
  {
    "text": "should be good enough actually it isn't",
    "start": "160239",
    "end": "163920"
  },
  {
    "text": "um because on one hand as a growing",
    "start": "163920",
    "end": "168040"
  },
  {
    "text": "business experience platform is looking",
    "start": "168040",
    "end": "170200"
  },
  {
    "text": "at increasing its footprint and",
    "start": "170200",
    "end": "173360"
  },
  {
    "text": "expecting to open up new Regional",
    "start": "173360",
    "end": "175239"
  },
  {
    "text": "deployments around the world and with",
    "start": "175239",
    "end": "178159"
  },
  {
    "text": "new regions we'll have multiple parallel",
    "start": "178159",
    "end": "181360"
  },
  {
    "text": "deployments right we cannot just deploy",
    "start": "181360",
    "end": "183519"
  },
  {
    "text": "everything sequentially it will take us",
    "start": "183519",
    "end": "185200"
  },
  {
    "text": "too long and yeah monitoring them it",
    "start": "185200",
    "end": "188040"
  },
  {
    "text": "will become more",
    "start": "188040",
    "end": "190080"
  },
  {
    "text": "complex and on the other hand we'll",
    "start": "190080",
    "end": "192879"
  },
  {
    "text": "always always be focused on",
    "start": "192879",
    "end": "194879"
  },
  {
    "text": "stability and although we we employ a",
    "start": "194879",
    "end": "197959"
  },
  {
    "text": "lot of checks there are some uh use",
    "start": "197959",
    "end": "202239"
  },
  {
    "text": "cases where the area of impact might be",
    "start": "202239",
    "end": "205200"
  },
  {
    "text": "pretty",
    "start": "205200",
    "end": "206480"
  },
  {
    "text": "big so this was our motivation in",
    "start": "206480",
    "end": "209760"
  },
  {
    "text": "looking into Progressive deployment and",
    "start": "209760",
    "end": "212200"
  },
  {
    "text": "of course the simplest answer to that",
    "start": "212200",
    "end": "214680"
  },
  {
    "text": "question was aror outs why because it's",
    "start": "214680",
    "end": "217319"
  },
  {
    "text": "Cloud native because it's very easy to",
    "start": "217319",
    "end": "219040"
  },
  {
    "text": "learn and understand uh and basically",
    "start": "219040",
    "end": "222560"
  },
  {
    "text": "lets you configure every type of",
    "start": "222560",
    "end": "225239"
  },
  {
    "text": "progressive deployment out there but",
    "start": "225239",
    "end": "227799"
  },
  {
    "text": "this thing of roll out being very",
    "start": "227799",
    "end": "230040"
  },
  {
    "text": "flexible in terms of what you can",
    "start": "230040",
    "end": "232000"
  },
  {
    "text": "configure raises the question what do we",
    "start": "232000",
    "end": "234200"
  },
  {
    "text": "configure for our use case uh what's the",
    "start": "234200",
    "end": "237360"
  },
  {
    "text": "best strategy and it was important for",
    "start": "237360",
    "end": "240760"
  },
  {
    "text": "us to leverage the existing mechanism",
    "start": "240760",
    "end": "242920"
  },
  {
    "text": "that we had today like the",
    "start": "242920",
    "end": "246439"
  },
  {
    "text": "test uh now I'm going to walk you",
    "start": "246439",
    "end": "248879"
  },
  {
    "text": "through a simplified view of a feature",
    "start": "248879",
    "end": "251079"
  },
  {
    "text": "we have an experienced platform which is",
    "start": "251079",
    "end": "252840"
  },
  {
    "text": "called audit and we'll use the",
    "start": "252840",
    "end": "255959"
  },
  {
    "text": "components implementing these features",
    "start": "255959",
    "end": "258519"
  },
  {
    "text": "um as our test",
    "start": "258519",
    "end": "261359"
  },
  {
    "text": "subject so today this is implemented",
    "start": "261360",
    "end": "263880"
  },
  {
    "text": "like this uh we have events produced on",
    "start": "263880",
    "end": "266280"
  },
  {
    "text": "a cfat topic which are being consumed",
    "start": "266280",
    "end": "270560"
  },
  {
    "text": "processed and ingested into a data store",
    "start": "270560",
    "end": "273199"
  },
  {
    "text": "by this Kafka consumer component from",
    "start": "273199",
    "end": "276000"
  },
  {
    "text": "the data store they are exposed through",
    "start": "276000",
    "end": "278560"
  },
  {
    "text": "this restful web service it's important",
    "start": "278560",
    "end": "281240"
  },
  {
    "text": "to state that both these microservices",
    "start": "281240",
    "end": "283960"
  },
  {
    "text": "are both backwards and forwards",
    "start": "283960",
    "end": "286440"
  },
  {
    "text": "compatible to each",
    "start": "286440",
    "end": "288039"
  },
  {
    "text": "other when it comes to testing that post",
    "start": "288039",
    "end": "291440"
  },
  {
    "text": "deployment test I was talking about",
    "start": "291440",
    "end": "293880"
  },
  {
    "text": "earlier we are actually testing the",
    "start": "293880",
    "end": "296199"
  },
  {
    "text": "entire system so our functional test",
    "start": "296199",
    "end": "299560"
  },
  {
    "text": "generate data on the Kafka topic and",
    "start": "299560",
    "end": "302479"
  },
  {
    "text": "they uh validate the entire system's",
    "start": "302479",
    "end": "305120"
  },
  {
    "text": "Behavior through that restful web",
    "start": "305120",
    "end": "308080"
  },
  {
    "text": "service these tests are packaged in a",
    "start": "308080",
    "end": "310639"
  },
  {
    "text": "container and they run as a kubernetes",
    "start": "310639",
    "end": "312680"
  },
  {
    "text": "job in the cicd",
    "start": "312680",
    "end": "314280"
  },
  {
    "text": "pipeline so let's see how we can apply",
    "start": "314280",
    "end": "317479"
  },
  {
    "text": "roll outs to each of these components",
    "start": "317479",
    "end": "319720"
  },
  {
    "text": "and we'll start with the restful web",
    "start": "319720",
    "end": "321919"
  },
  {
    "text": "service which is a very good candidate",
    "start": "321919",
    "end": "324199"
  },
  {
    "text": "for roll outs with blue green U",
    "start": "324199",
    "end": "326000"
  },
  {
    "text": "deployment",
    "start": "326000",
    "end": "327440"
  },
  {
    "text": "strategy uh why because it can be tested",
    "start": "327440",
    "end": "330199"
  },
  {
    "text": "without any live traffic and we are",
    "start": "330199",
    "end": "332520"
  },
  {
    "text": "going to reuse some of the tests we",
    "start": "332520",
    "end": "334319"
  },
  {
    "text": "already have to do this testing so we",
    "start": "334319",
    "end": "337800"
  },
  {
    "text": "need to split up the test a bit and have",
    "start": "337800",
    "end": "340000"
  },
  {
    "text": "dedicated",
    "start": "340000",
    "end": "341080"
  },
  {
    "text": "container um for with component test for",
    "start": "341080",
    "end": "344759"
  },
  {
    "text": "this",
    "start": "344759",
    "end": "347759"
  },
  {
    "text": "API this test will be then referenced in",
    "start": "348960",
    "end": "352800"
  },
  {
    "text": "an analysis template similar to what you",
    "start": "352800",
    "end": "355400"
  },
  {
    "text": "see on the screen the important thing to",
    "start": "355400",
    "end": "358240"
  },
  {
    "text": "to note here is that the restful web",
    "start": "358240",
    "end": "360919"
  },
  {
    "text": "server URL needs to be uh added as a",
    "start": "360919",
    "end": "365479"
  },
  {
    "text": "parameter and it needs to uh point to",
    "start": "365479",
    "end": "368479"
  },
  {
    "text": "the preview service that's targeting the",
    "start": "368479",
    "end": "370919"
  },
  {
    "text": "preview pods basically the the green",
    "start": "370919",
    "end": "373080"
  },
  {
    "text": "part of a blue green",
    "start": "373080",
    "end": "375960"
  },
  {
    "text": "deployment uh this analysis is then",
    "start": "376240",
    "end": "379000"
  },
  {
    "text": "referenced by the roll out spec and it's",
    "start": "379000",
    "end": "382000"
  },
  {
    "text": "referenced as a pre-promotion analysis",
    "start": "382000",
    "end": "384960"
  },
  {
    "text": "meaning that uh roll out the roll out",
    "start": "384960",
    "end": "388840"
  },
  {
    "text": "controller is instructed to make sure to",
    "start": "388840",
    "end": "392840"
  },
  {
    "text": "run this test against the preview",
    "start": "392840",
    "end": "394840"
  },
  {
    "text": "service before the preview service is",
    "start": "394840",
    "end": "396720"
  },
  {
    "text": "promoted and receives any live traffic",
    "start": "396720",
    "end": "400360"
  },
  {
    "text": "therefore if there is an issue that can",
    "start": "400360",
    "end": "402680"
  },
  {
    "text": "be captured through testing will have no",
    "start": "402680",
    "end": "405280"
  },
  {
    "text": "impact here another thing to notice here",
    "start": "405280",
    "end": "408360"
  },
  {
    "text": "is that the preview replic account is",
    "start": "408360",
    "end": "409880"
  },
  {
    "text": "set to one uh this will help us not use",
    "start": "409880",
    "end": "412880"
  },
  {
    "text": "too many resources when we run both the",
    "start": "412880",
    "end": "415120"
  },
  {
    "text": "blue and the green deployments side by",
    "start": "415120",
    "end": "417240"
  },
  {
    "text": "side and we're basically spinning just",
    "start": "417240",
    "end": "419479"
  },
  {
    "text": "just a single",
    "start": "419479",
    "end": "421520"
  },
  {
    "text": "pod um we also you can see that we don't",
    "start": "421520",
    "end": "424960"
  },
  {
    "text": "set the replica count here because this",
    "start": "424960",
    "end": "426759"
  },
  {
    "text": "roll out is managed by an horizontal",
    "start": "426759",
    "end": "429840"
  },
  {
    "text": "pooto scaler HPA works great with",
    "start": "429840",
    "end": "433039"
  },
  {
    "text": "rollouts because it will manage only the",
    "start": "433039",
    "end": "435879"
  },
  {
    "text": "um active the replicas of the active",
    "start": "435879",
    "end": "438400"
  },
  {
    "text": "replicas that's actually receiving uh",
    "start": "438400",
    "end": "441280"
  },
  {
    "text": "live",
    "start": "441280",
    "end": "443479"
  },
  {
    "text": "traffic a takeaway from here is this",
    "start": "443479",
    "end": "446639"
  },
  {
    "text": "approach is very similar to what we do",
    "start": "446639",
    "end": "449400"
  },
  {
    "text": "with pre-pro",
    "start": "449400",
    "end": "450639"
  },
  {
    "text": "environment what we called the prepro",
    "start": "450639",
    "end": "452960"
  },
  {
    "text": "was actually an",
    "start": "452960",
    "end": "454879"
  },
  {
    "text": "environment very similar to production",
    "start": "454879",
    "end": "457479"
  },
  {
    "text": "in terms of",
    "start": "457479",
    "end": "458599"
  },
  {
    "text": "configuration but it did not receive any",
    "start": "458599",
    "end": "461639"
  },
  {
    "text": "live traffic just synthetic one and the",
    "start": "461639",
    "end": "464800"
  },
  {
    "text": "scope of prepro environment was to test",
    "start": "464800",
    "end": "467560"
  },
  {
    "text": "basically production configuration with",
    "start": "467560",
    "end": "469840"
  },
  {
    "text": "zero impact but of course prepro",
    "start": "469840",
    "end": "473280"
  },
  {
    "text": "environments are expensive to run",
    "start": "473280",
    "end": "475199"
  },
  {
    "text": "because alongside a new deployment of",
    "start": "475199",
    "end": "477800"
  },
  {
    "text": "the service they require additional",
    "start": "477800",
    "end": "479680"
  },
  {
    "text": "resources like in our case a",
    "start": "479680",
    "end": "482759"
  },
  {
    "text": "database uh while you can get the same",
    "start": "482759",
    "end": "485440"
  },
  {
    "text": "amount of validation basically with a",
    "start": "485440",
    "end": "487720"
  },
  {
    "text": "blue green uh and you you will be",
    "start": "487720",
    "end": "490520"
  },
  {
    "text": "running just a double amount of PODS",
    "start": "490520",
    "end": "492800"
  },
  {
    "text": "just before the cut over um until that",
    "start": "492800",
    "end": "496159"
  },
  {
    "text": "point because we said that preview",
    "start": "496159",
    "end": "497520"
  },
  {
    "text": "replic count one we you're we're just",
    "start": "497520",
    "end": "499720"
  },
  {
    "text": "using yet another",
    "start": "499720",
    "end": "502800"
  },
  {
    "text": "pod now let's see how um what strategy",
    "start": "502800",
    "end": "506240"
  },
  {
    "text": "can we apply to the streaming",
    "start": "506240",
    "end": "508199"
  },
  {
    "text": "application to the Kafka consumer so if",
    "start": "508199",
    "end": "511319"
  },
  {
    "text": "I were to apply the same strategy blue",
    "start": "511319",
    "end": "514159"
  },
  {
    "text": "green and to create a new version of my",
    "start": "514159",
    "end": "517719"
  },
  {
    "text": "application with the same configuration",
    "start": "517719",
    "end": "519880"
  },
  {
    "text": "as as the first one uh and this version",
    "start": "519880",
    "end": "524360"
  },
  {
    "text": "would act as my green part of my blue",
    "start": "524360",
    "end": "526920"
  },
  {
    "text": "blue green or actually my my yellow in",
    "start": "526920",
    "end": "528800"
  },
  {
    "text": "the the picture then I would have",
    "start": "528800",
    "end": "531839"
  },
  {
    "text": "mistakenly deploy a canary because if I",
    "start": "531839",
    "end": "536959"
  },
  {
    "text": "deploy the same configuration on both",
    "start": "536959",
    "end": "538920"
  },
  {
    "text": "vers of the application they will share",
    "start": "538920",
    "end": "541360"
  },
  {
    "text": "the same consumer group and as a",
    "start": "541360",
    "end": "543360"
  },
  {
    "text": "consequence they will share the traffic",
    "start": "543360",
    "end": "545320"
  },
  {
    "text": "that comes through that Kafka",
    "start": "545320",
    "end": "547640"
  },
  {
    "text": "topic",
    "start": "547640",
    "end": "549560"
  },
  {
    "text": "so let's say I I changed the consumer",
    "start": "549560",
    "end": "552320"
  },
  {
    "text": "group I intentionally changed that then",
    "start": "552320",
    "end": "556480"
  },
  {
    "text": "I will not be able to promote anymore my",
    "start": "556480",
    "end": "558160"
  },
  {
    "text": "V2 application because the whole idea",
    "start": "558160",
    "end": "561680"
  },
  {
    "text": "with using blue green is to able to be",
    "start": "561680",
    "end": "563440"
  },
  {
    "text": "able to promote a new version to be the",
    "start": "563440",
    "end": "565880"
  },
  {
    "text": "stable one but if it has a different",
    "start": "565880",
    "end": "568079"
  },
  {
    "text": "configuration than the stable I I cannot",
    "start": "568079",
    "end": "570200"
  },
  {
    "text": "promote it anymore so because blue green",
    "start": "570200",
    "end": "573240"
  },
  {
    "text": "is all about bringing new instances and",
    "start": "573240",
    "end": "575560"
  },
  {
    "text": "test them without receiving any live",
    "start": "575560",
    "end": "579000"
  },
  {
    "text": "traffic there's no fit",
    "start": "579000",
    "end": "582120"
  },
  {
    "text": "here well you can say Okay expose that",
    "start": "582120",
    "end": "585440"
  },
  {
    "text": "new version of the application to the",
    "start": "585440",
    "end": "586880"
  },
  {
    "text": "traffic through a canary and test it",
    "start": "586880",
    "end": "589279"
  },
  {
    "text": "like",
    "start": "589279",
    "end": "590360"
  },
  {
    "text": "this unfortunately this doesn't quite",
    "start": "590360",
    "end": "593680"
  },
  {
    "text": "work as well because of the same reason",
    "start": "593680",
    "end": "596240"
  },
  {
    "text": "of shared consumer",
    "start": "596240",
    "end": "597920"
  },
  {
    "text": "groups I",
    "start": "597920",
    "end": "599760"
  },
  {
    "text": "cannot uh Target the V2 pods which are",
    "start": "599760",
    "end": "603720"
  },
  {
    "text": "my canary pods here with the test",
    "start": "603720",
    "end": "605880"
  },
  {
    "text": "traffic because both the live traffic",
    "start": "605880",
    "end": "608240"
  },
  {
    "text": "and the test traffic are shared by both",
    "start": "608240",
    "end": "611760"
  },
  {
    "text": "my stable and my canary deployment so I",
    "start": "611760",
    "end": "616120"
  },
  {
    "text": "I have no guarantee that I'm actually",
    "start": "616120",
    "end": "618120"
  },
  {
    "text": "testing the the canary",
    "start": "618120",
    "end": "621839"
  },
  {
    "text": "deployment so what we ended up doing is",
    "start": "621839",
    "end": "626200"
  },
  {
    "text": "a canary but with metric analysis so all",
    "start": "626200",
    "end": "630959"
  },
  {
    "text": "my pods are exposing a HTTP end point",
    "start": "630959",
    "end": "634480"
  },
  {
    "text": "for Matrix which is being scraped by a",
    "start": "634480",
    "end": "637240"
  },
  {
    "text": "Prometheus instance and the canary is",
    "start": "637240",
    "end": "639800"
  },
  {
    "text": "running with the live traffic and we are",
    "start": "639800",
    "end": "642839"
  },
  {
    "text": "assessing how well is doing by using",
    "start": "642839",
    "end": "645399"
  },
  {
    "text": "some key",
    "start": "645399",
    "end": "647040"
  },
  {
    "text": "metric the key metric uh for our use",
    "start": "647040",
    "end": "650160"
  },
  {
    "text": "case are error rate which should not be",
    "start": "650160",
    "end": "652360"
  },
  {
    "text": "greater than",
    "start": "652360",
    "end": "653560"
  },
  {
    "text": "1% uh the error rate in our system means",
    "start": "653560",
    "end": "657079"
  },
  {
    "text": "that we are not not able to process the",
    "start": "657079",
    "end": "659120"
  },
  {
    "text": "messages and we are parking them on a",
    "start": "659120",
    "end": "661279"
  },
  {
    "text": "dead letter que and the second metric",
    "start": "661279",
    "end": "665120"
  },
  {
    "text": "just uh assesses that we are actually",
    "start": "665120",
    "end": "668440"
  },
  {
    "text": "producing event to that data",
    "start": "668440",
    "end": "670839"
  },
  {
    "text": "store you can see that both metrics have",
    "start": "670839",
    "end": "673720"
  },
  {
    "text": "an initial delay of 1 minute to allow",
    "start": "673720",
    "end": "676240"
  },
  {
    "text": "for the canary pods to be up and running",
    "start": "676240",
    "end": "679040"
  },
  {
    "text": "and to also allow for a first consumer",
    "start": "679040",
    "end": "681800"
  },
  {
    "text": "group rebalance as the canary p is being",
    "start": "681800",
    "end": "684880"
  },
  {
    "text": "added to the consumer",
    "start": "684880",
    "end": "687959"
  },
  {
    "text": "group these two metrics are then um",
    "start": "687959",
    "end": "693880"
  },
  {
    "text": "referen from the roll out spec of my",
    "start": "693880",
    "end": "695880"
  },
  {
    "text": "Kafka consumer roll out uh and they are",
    "start": "695880",
    "end": "698959"
  },
  {
    "text": "referenced as a background analysis",
    "start": "698959",
    "end": "701519"
  },
  {
    "text": "meaning that they will run for the",
    "start": "701519",
    "end": "703360"
  },
  {
    "text": "entire duration of the roll",
    "start": "703360",
    "end": "706120"
  },
  {
    "text": "out but how do we exactly um how do we",
    "start": "706120",
    "end": "711160"
  },
  {
    "text": "exactly uh scrape those metric and",
    "start": "711160",
    "end": "713720"
  },
  {
    "text": "collect metrics from the the can ports I",
    "start": "713720",
    "end": "716519"
  },
  {
    "text": "could use a service monitor which would",
    "start": "716519",
    "end": "719360"
  },
  {
    "text": "Target the canary",
    "start": "719360",
    "end": "721279"
  },
  {
    "text": "service this will correctly identify my",
    "start": "721279",
    "end": "724360"
  },
  {
    "text": "can reports during an roll out however",
    "start": "724360",
    "end": "728079"
  },
  {
    "text": "when The All Out is",
    "start": "728079",
    "end": "730360"
  },
  {
    "text": "promoted uh to the stable version to the",
    "start": "730360",
    "end": "733320"
  },
  {
    "text": "stable",
    "start": "733320",
    "end": "734680"
  },
  {
    "text": "version um I have an issue because the",
    "start": "734680",
    "end": "737800"
  },
  {
    "text": "canary service will Point basically to",
    "start": "737800",
    "end": "740440"
  },
  {
    "text": "my stable pods too because Canary servic",
    "start": "740440",
    "end": "743720"
  },
  {
    "text": "is using roll out pod template hash to",
    "start": "743720",
    "end": "746760"
  },
  {
    "text": "Target the pods as and the pod template",
    "start": "746760",
    "end": "749600"
  },
  {
    "text": "hash will stay the same after uh the",
    "start": "749600",
    "end": "753279"
  },
  {
    "text": "roll out is promoted because there is",
    "start": "753279",
    "end": "755839"
  },
  {
    "text": "basically no no change in the",
    "start": "755839",
    "end": "758519"
  },
  {
    "text": "spec so in this case my second service",
    "start": "758519",
    "end": "762480"
  },
  {
    "text": "monitor will actually point to the",
    "start": "762480",
    "end": "764480"
  },
  {
    "text": "stable pods and will collect data from",
    "start": "764480",
    "end": "766680"
  },
  {
    "text": "my stable version of the",
    "start": "766680",
    "end": "769199"
  },
  {
    "text": "application apart from the issue that we",
    "start": "769199",
    "end": "771360"
  },
  {
    "text": "are basically duplicating metrics I have",
    "start": "771360",
    "end": "774199"
  },
  {
    "text": "another issue if I want to run a new",
    "start": "774199",
    "end": "776000"
  },
  {
    "text": "roll out because",
    "start": "776000",
    "end": "779639"
  },
  {
    "text": "um depending on the time window I",
    "start": "779639",
    "end": "782560"
  },
  {
    "text": "use my first data points might be skewed",
    "start": "782560",
    "end": "785959"
  },
  {
    "text": "because they actually have data for the",
    "start": "785959",
    "end": "787720"
  },
  {
    "text": "from the staple service so an",
    "start": "787720",
    "end": "790720"
  },
  {
    "text": "alternative to this would be to use a",
    "start": "790720",
    "end": "793639"
  },
  {
    "text": "feature from rollouts uh called the",
    "start": "793639",
    "end": "796040"
  },
  {
    "text": "feral metadata which lets you basically",
    "start": "796040",
    "end": "799279"
  },
  {
    "text": "Define in the spec labels and annotation",
    "start": "799279",
    "end": "802160"
  },
  {
    "text": "to attach to the canary respective to",
    "start": "802160",
    "end": "804279"
  },
  {
    "text": "the uh stable PODS of course of interest",
    "start": "804279",
    "end": "807199"
  },
  {
    "text": "to us is the canary metad data here uh",
    "start": "807199",
    "end": "810440"
  },
  {
    "text": "which will be added by the roll out uh",
    "start": "810440",
    "end": "812519"
  },
  {
    "text": "during the the",
    "start": "812519",
    "end": "814839"
  },
  {
    "text": "canary then I can leverage a PO monitor",
    "start": "814839",
    "end": "817959"
  },
  {
    "text": "which selects based on the labels labels",
    "start": "817959",
    "end": "820040"
  },
  {
    "text": "I just added uh only the pods that are",
    "start": "820040",
    "end": "823320"
  },
  {
    "text": "part of the can redeployment the good",
    "start": "823320",
    "end": "825639"
  },
  {
    "text": "part with this approach is when the Kary",
    "start": "825639",
    "end": "828839"
  },
  {
    "text": "gets",
    "start": "828839",
    "end": "830279"
  },
  {
    "text": "promoted uh my P monitor will not select",
    "start": "830279",
    "end": "833680"
  },
  {
    "text": "any of the pods anymore because all the",
    "start": "833680",
    "end": "835920"
  },
  {
    "text": "pods have the label state label as the",
    "start": "835920",
    "end": "840320"
  },
  {
    "text": "canary label was an feral",
    "start": "840320",
    "end": "844040"
  },
  {
    "text": "one now let's go some some let's see",
    "start": "845320",
    "end": "849240"
  },
  {
    "text": "some of the takeaways we've got from",
    "start": "849240",
    "end": "850880"
  },
  {
    "text": "this U running roll outs with analysis",
    "start": "850880",
    "end": "854320"
  },
  {
    "text": "for streaming application the first one",
    "start": "854320",
    "end": "856600"
  },
  {
    "text": "was about how long to run the canary for",
    "start": "856600",
    "end": "859320"
  },
  {
    "text": "uh of course it depends uh on the",
    "start": "859320",
    "end": "861639"
  },
  {
    "text": "application uh the answer is enough for",
    "start": "861639",
    "end": "864680"
  },
  {
    "text": "the Matrix to be scraped and enough to",
    "start": "864680",
    "end": "867759"
  },
  {
    "text": "collect sufficient data data points for",
    "start": "867759",
    "end": "870320"
  },
  {
    "text": "your analysis in our case um because",
    "start": "870320",
    "end": "874399"
  },
  {
    "text": "it's a moderate traffic application uh",
    "start": "874399",
    "end": "878240"
  },
  {
    "text": "an interval and we're scraping every 15",
    "start": "878240",
    "end": "881560"
  },
  {
    "text": "seconds uh anywhere to 5 to 10 minutes",
    "start": "881560",
    "end": "884480"
  },
  {
    "text": "in it's enough to assess that this roll",
    "start": "884480",
    "end": "887320"
  },
  {
    "text": "out is okay or not uh another thing to",
    "start": "887320",
    "end": "891240"
  },
  {
    "text": "take into consideration here is how",
    "start": "891240",
    "end": "893519"
  },
  {
    "text": "frequent frequent you do changes to that",
    "start": "893519",
    "end": "895759"
  },
  {
    "text": "application because if you're running",
    "start": "895759",
    "end": "897600"
  },
  {
    "text": "roll outs for days and you have frequent",
    "start": "897600",
    "end": "901600"
  },
  {
    "text": "change to the service you might still",
    "start": "901600",
    "end": "904079"
  },
  {
    "text": "want to test each change at the time so",
    "start": "904079",
    "end": "908040"
  },
  {
    "text": "uh the speed delivery will be basically",
    "start": "908040",
    "end": "911560"
  },
  {
    "text": "reduced another takeaway here was about",
    "start": "911560",
    "end": "914959"
  },
  {
    "text": "the interval to compute metric on",
    "start": "914959",
    "end": "918199"
  },
  {
    "text": "because we need to be aware of consumer",
    "start": "918199",
    "end": "920800"
  },
  {
    "text": "rebalances which happen every time we",
    "start": "920800",
    "end": "923279"
  },
  {
    "text": "add new can",
    "start": "923279",
    "end": "924560"
  },
  {
    "text": "reports uh so time Windows short like",
    "start": "924560",
    "end": "928759"
  },
  {
    "text": "like 1 minutes might not be enough",
    "start": "928759",
    "end": "931399"
  },
  {
    "text": "because you still need to wait for the",
    "start": "931399",
    "end": "933920"
  },
  {
    "text": "uh rebalance to finish and also for the",
    "start": "933920",
    "end": "936399"
  },
  {
    "text": "metric to be",
    "start": "936399",
    "end": "939120"
  },
  {
    "text": "collected um another takeaway is",
    "start": "939839",
    "end": "942800"
  },
  {
    "text": "although matrics do help us reduce",
    "start": "942800",
    "end": "944639"
  },
  {
    "text": "impact when we're talking about rolling",
    "start": "944639",
    "end": "947000"
  },
  {
    "text": "out a new application they are not",
    "start": "947000",
    "end": "949839"
  },
  {
    "text": "comprehensive enough to test the entire",
    "start": "949839",
    "end": "951959"
  },
  {
    "text": "functionality of the deployment so they",
    "start": "951959",
    "end": "953440"
  },
  {
    "text": "are not a replacement for test so this",
    "start": "953440",
    "end": "955920"
  },
  {
    "text": "is actually a second reason that we want",
    "start": "955920",
    "end": "957560"
  },
  {
    "text": "to fail fast and run that roll out for",
    "start": "957560",
    "end": "960519"
  },
  {
    "text": "such a short time is because we still",
    "start": "960519",
    "end": "962560"
  },
  {
    "text": "have test afterwards to run uh so um we",
    "start": "962560",
    "end": "967440"
  },
  {
    "text": "are still running the component test for",
    "start": "967440",
    "end": "969800"
  },
  {
    "text": "this component but also the test for the",
    "start": "969800",
    "end": "971720"
  },
  {
    "text": "entire system post",
    "start": "971720",
    "end": "974639"
  },
  {
    "text": "deployment and a final note I wanted to",
    "start": "974639",
    "end": "977519"
  },
  {
    "text": "make um is running Argo rollouts with",
    "start": "977519",
    "end": "980560"
  },
  {
    "text": "Argo CD so and especially discuss the",
    "start": "980560",
    "end": "984079"
  },
  {
    "text": "roll backs use case so as you know roll",
    "start": "984079",
    "end": "987120"
  },
  {
    "text": "backs Argo roll CL will roll back uh",
    "start": "987120",
    "end": "991319"
  },
  {
    "text": "your code if there is an issue by",
    "start": "991319",
    "end": "993560"
  },
  {
    "text": "scaling down the replica set which has",
    "start": "993560",
    "end": "996839"
  },
  {
    "text": "issues and scaling up the stable one uh",
    "start": "996839",
    "end": "1001079"
  },
  {
    "text": "we actually do more than that uh we",
    "start": "1001079",
    "end": "1006279"
  },
  {
    "text": "follow closely G Up's principle and",
    "start": "1006279",
    "end": "1008680"
  },
  {
    "text": "basically we reflect that change back",
    "start": "1008680",
    "end": "1010560"
  },
  {
    "text": "into git through a git",
    "start": "1010560",
    "end": "1012480"
  },
  {
    "text": "revert uh there are multiple reasons why",
    "start": "1012480",
    "end": "1015240"
  },
  {
    "text": "you want to do this um one of them would",
    "start": "1015240",
    "end": "1018600"
  },
  {
    "text": "be that if the roll back is retried",
    "start": "1018600",
    "end": "1021800"
  },
  {
    "text": "without having a fix for it multiple",
    "start": "1021800",
    "end": "1024199"
  },
  {
    "text": "times and if that roll back is producing",
    "start": "1024199",
    "end": "1026640"
  },
  {
    "text": "some producing some impact with Canary",
    "start": "1026640",
    "end": "1030199"
  },
  {
    "text": "for for example uh then you will",
    "start": "1030199",
    "end": "1033558"
  },
  {
    "text": "basically be multiplying that impact",
    "start": "1033559",
    "end": "1037199"
  },
  {
    "text": "with the rri you're",
    "start": "1037199",
    "end": "1039000"
  },
  {
    "text": "making another uh reason to do this is",
    "start": "1039000",
    "end": "1042880"
  },
  {
    "text": "you usually don't know what happened",
    "start": "1042880",
    "end": "1044480"
  },
  {
    "text": "when a roll back do have does happen uh",
    "start": "1044480",
    "end": "1047640"
  },
  {
    "text": "with roll outs",
    "start": "1047640",
    "end": "1049080"
  },
  {
    "text": "so you might want to roll back all the",
    "start": "1049080",
    "end": "1052840"
  },
  {
    "text": "other regions you have in production",
    "start": "1052840",
    "end": "1054919"
  },
  {
    "text": "until you figure out what's the root",
    "start": "1054919",
    "end": "1057320"
  },
  {
    "text": "root cause and if it's actually a",
    "start": "1057320",
    "end": "1059480"
  },
  {
    "text": "configuration issue or it's more than",
    "start": "1059480",
    "end": "1063200"
  },
  {
    "text": "that this was all from me um if you have",
    "start": "1063200",
    "end": "1066440"
  },
  {
    "text": "any",
    "start": "1066440",
    "end": "1068679"
  },
  {
    "text": "questions there is a mic up",
    "start": "1068799",
    "end": "1073000"
  },
  {
    "text": "there if not we can take it",
    "start": "1076120",
    "end": "1078960"
  },
  {
    "text": "um after the the talk thank",
    "start": "1078960",
    "end": "1083440"
  },
  {
    "text": "you",
    "start": "1087320",
    "end": "1090320"
  }
]