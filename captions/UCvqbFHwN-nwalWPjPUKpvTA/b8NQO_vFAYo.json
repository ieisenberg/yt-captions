[
  {
    "start": "0",
    "end": "148000"
  },
  {
    "text": "I'm gonna be talking about how we use",
    "start": "0",
    "end": "3540"
  },
  {
    "text": "kubernetes and nomad at Circle CI and",
    "start": "3540",
    "end": "8189"
  },
  {
    "text": "how we run one inside of the other and a",
    "start": "8189",
    "end": "10920"
  },
  {
    "text": "little bit of why we do that so let's",
    "start": "10920",
    "end": "12630"
  },
  {
    "text": "get started so Who am I I'm Dani",
    "start": "12630",
    "end": "16800"
  },
  {
    "text": "I live in Berlin and I'm a staff",
    "start": "16800",
    "end": "18960"
  },
  {
    "text": "software engineer on the build execution",
    "start": "18960",
    "end": "20760"
  },
  {
    "text": "team at cycle CI I'm also a maintainer",
    "start": "20760",
    "end": "23519"
  },
  {
    "text": "of cocoapods a dependency manager from",
    "start": "23519",
    "end": "25439"
  },
  {
    "text": "Mac and iOS applications and fast lane",
    "start": "25439",
    "end": "28170"
  },
  {
    "text": "which is build and release tooling for",
    "start": "28170",
    "end": "29730"
  },
  {
    "text": "mobile engineers and if any of you",
    "start": "29730",
    "end": "32880"
  },
  {
    "text": "haven't heard about circle CI before",
    "start": "32880",
    "end": "34170"
  },
  {
    "text": "circle CI is continuous integration and",
    "start": "34170",
    "end": "36149"
  },
  {
    "text": "delivery platform with first-class",
    "start": "36149",
    "end": "37800"
  },
  {
    "text": "support for docker Mac OS and Linux VMs",
    "start": "37800",
    "end": "40820"
  },
  {
    "text": "and so what am I going to cover in this",
    "start": "40820",
    "end": "43649"
  },
  {
    "text": "talk I'm going to start out by covering",
    "start": "43649",
    "end": "46530"
  },
  {
    "text": "why we decided to repot form our",
    "start": "46530",
    "end": "47969"
  },
  {
    "text": "infrastructure and I'm going to talk",
    "start": "47969",
    "end": "50850"
  },
  {
    "text": "specifically why we chose to use nomads",
    "start": "50850",
    "end": "53460"
  },
  {
    "text": "and kubernetes together because the",
    "start": "53460",
    "end": "57360"
  },
  {
    "text": "first thing I say when people hear this",
    "start": "57360",
    "end": "59039"
  },
  {
    "text": "is a bit of a confused like for good",
    "start": "59039",
    "end": "63149"
  },
  {
    "text": "reasons and then I'm going to talk about",
    "start": "63149",
    "end": "65220"
  },
  {
    "text": "how our deployment has evolved and a few",
    "start": "65220",
    "end": "68189"
  },
  {
    "text": "sort of many post-mortems about some fun",
    "start": "68189",
    "end": "70409"
  },
  {
    "text": "production outages we had a few months",
    "start": "70409",
    "end": "72060"
  },
  {
    "text": "ago and how we managed to overcome them",
    "start": "72060",
    "end": "74430"
  },
  {
    "text": "using kubernetes so almost a year ago we",
    "start": "74430",
    "end": "80340"
  },
  {
    "text": "launched the current generation of the",
    "start": "80340",
    "end": "81780"
  },
  {
    "text": "circle CI infrastructure aptly named 2.0",
    "start": "81780",
    "end": "84990"
  },
  {
    "text": "and it was a huge amount of work that",
    "start": "84990",
    "end": "87570"
  },
  {
    "text": "involved everyone inside the company by",
    "start": "87570",
    "end": "89310"
  },
  {
    "text": "the time it was released which might",
    "start": "89310",
    "end": "91170"
  },
  {
    "text": "sound a little bit strange when we're a",
    "start": "91170",
    "end": "93030"
  },
  {
    "text": "CI NCD company that you know we would",
    "start": "93030",
    "end": "95759"
  },
  {
    "text": "take a year to go away and build the",
    "start": "95759",
    "end": "97380"
  },
  {
    "text": "thing before we shipped it to anybody",
    "start": "97380",
    "end": "98640"
  },
  {
    "text": "but why did we do that Circle C I was",
    "start": "98640",
    "end": "104549"
  },
  {
    "text": "founded in 2011 and this was a very",
    "start": "104549",
    "end": "106680"
  },
  {
    "text": "different time for many software",
    "start": "106680",
    "end": "107880"
  },
  {
    "text": "companies many places were not even",
    "start": "107880",
    "end": "110399"
  },
  {
    "text": "starting to do CI NCD yet and we didn't",
    "start": "110399",
    "end": "113610"
  },
  {
    "text": "even have docker yet and so many teams",
    "start": "113610",
    "end": "116189"
  },
  {
    "text": "deployed a mais over running",
    "start": "116189",
    "end": "117840"
  },
  {
    "text": "configuration management tools against",
    "start": "117840",
    "end": "119549"
  },
  {
    "text": "hosts in production just sort of like",
    "start": "119549",
    "end": "121560"
  },
  {
    "text": "git pull and bundle exec rakes of",
    "start": "121560",
    "end": "124970"
  },
  {
    "text": "[Music]",
    "start": "124970",
    "end": "126320"
  },
  {
    "text": "hopefully nothing that sad but we've all",
    "start": "126320",
    "end": "129209"
  },
  {
    "text": "been there the platform was originally",
    "start": "129209",
    "end": "131910"
  },
  {
    "text": "designed around being fairly opinionated",
    "start": "131910",
    "end": "133170"
  },
  {
    "text": "about",
    "start": "133170",
    "end": "133860"
  },
  {
    "text": "your CI and CD process should work with",
    "start": "133860",
    "end": "136290"
  },
  {
    "text": "explicit sort of demarcations for when",
    "start": "136290",
    "end": "138420"
  },
  {
    "text": "you build your testing you to playing",
    "start": "138420",
    "end": "139770"
  },
  {
    "text": "and this was great when we were all",
    "start": "139770",
    "end": "141510"
  },
  {
    "text": "writing like these huge monolithic rails",
    "start": "141510",
    "end": "143280"
  },
  {
    "text": "apps with relatively simple deployment",
    "start": "143280",
    "end": "146700"
  },
  {
    "text": "type lines but in the time how since",
    "start": "146700",
    "end": "149550"
  },
  {
    "start": "148000",
    "end": "148000"
  },
  {
    "text": "then however the industry has changed a",
    "start": "149550",
    "end": "151260"
  },
  {
    "text": "lot",
    "start": "151260",
    "end": "152550"
  },
  {
    "text": "docker was released in 2013 and since",
    "start": "152550",
    "end": "154740"
  },
  {
    "text": "then it's had an incredibly broad impact",
    "start": "154740",
    "end": "156510"
  },
  {
    "text": "on our Tao teams of building and",
    "start": "156510",
    "end": "157920"
  },
  {
    "text": "releasing software we could see where",
    "start": "157920",
    "end": "160680"
  },
  {
    "text": "our own and was the industry",
    "start": "160680",
    "end": "161850"
  },
  {
    "text": "requirements around CI and CD were going",
    "start": "161850",
    "end": "163770"
  },
  {
    "text": "but our existing infrastructure was",
    "start": "163770",
    "end": "165450"
  },
  {
    "text": "rapidly becoming a problem and we",
    "start": "165450",
    "end": "167400"
  },
  {
    "text": "couldn't see an incremental path to what",
    "start": "167400",
    "end": "168690"
  },
  {
    "text": "servicing them and so we eventually",
    "start": "168690",
    "end": "171930"
  },
  {
    "text": "decided that our best option was to tear",
    "start": "171930",
    "end": "174540"
  },
  {
    "text": "everything down andrey platform our core",
    "start": "174540",
    "end": "177000"
  },
  {
    "text": "infrastructure to allow us to service",
    "start": "177000",
    "end": "178830"
  },
  {
    "text": "these ever-changing needs Reap",
    "start": "178830",
    "end": "181980"
  },
  {
    "text": "platforming is terrifying",
    "start": "181980",
    "end": "183690"
  },
  {
    "text": "like it's a lot of work you're taking an",
    "start": "183690",
    "end": "186510"
  },
  {
    "text": "existing thing that's working reasonably",
    "start": "186510",
    "end": "188550"
  },
  {
    "text": "well and you're trying to rebuild a",
    "start": "188550",
    "end": "190320"
  },
  {
    "text": "better version of it and you have to do",
    "start": "190320",
    "end": "192330"
  },
  {
    "text": "all of this work without the constant",
    "start": "192330",
    "end": "194010"
  },
  {
    "text": "guiding light of all your customers",
    "start": "194010",
    "end": "196200"
  },
  {
    "text": "feedback and our customers were also",
    "start": "196200",
    "end": "198600"
  },
  {
    "text": "scared because it looked like we weren't",
    "start": "198600",
    "end": "200130"
  },
  {
    "text": "really doing anything for a year but we",
    "start": "200130",
    "end": "203910"
  },
  {
    "text": "had the advantage of existing domain",
    "start": "203910",
    "end": "205470"
  },
  {
    "text": "knowledge and understanding of what we",
    "start": "205470",
    "end": "206880"
  },
  {
    "text": "needed from our infrastructure so we had",
    "start": "206880",
    "end": "211260"
  },
  {
    "start": "210000",
    "end": "210000"
  },
  {
    "text": "a couple of key requirements to think",
    "start": "211260",
    "end": "212550"
  },
  {
    "text": "about when we started down the road to",
    "start": "212550",
    "end": "213900"
  },
  {
    "text": "2.0 we needed to handle both the needs",
    "start": "213900",
    "end": "216510"
  },
  {
    "text": "about build infrastructure and also a",
    "start": "216510",
    "end": "218670"
  },
  {
    "text": "way to scale out our platform as we",
    "start": "218670",
    "end": "220410"
  },
  {
    "text": "migrated from our old monolithic app to",
    "start": "220410",
    "end": "222630"
  },
  {
    "text": "micro services running other people's",
    "start": "222630",
    "end": "227970"
  },
  {
    "start": "225000",
    "end": "225000"
  },
  {
    "text": "code on your infrastructure and on the",
    "start": "227970",
    "end": "231450"
  },
  {
    "text": "same servers as other people's code is a",
    "start": "231450",
    "end": "235260"
  },
  {
    "text": "terrifying thought like raise your hands",
    "start": "235260",
    "end": "238140"
  },
  {
    "text": "if this is something you would willingly",
    "start": "238140",
    "end": "239370"
  },
  {
    "text": "want to do on a daily basis there's not",
    "start": "239370",
    "end": "243870"
  },
  {
    "text": "even a single brave soul out there",
    "start": "243870",
    "end": "245250"
  },
  {
    "text": "that's wonderful and this is a good",
    "start": "245250",
    "end": "248100"
  },
  {
    "text": "reason and so because of this we have to",
    "start": "248100",
    "end": "250410"
  },
  {
    "text": "bake in strong isolation to everything",
    "start": "250410",
    "end": "252239"
  },
  {
    "text": "we build and we have to do it from the",
    "start": "252239",
    "end": "254280"
  },
  {
    "text": "beginning and security is not something",
    "start": "254280",
    "end": "257459"
  },
  {
    "text": "you can just think about after the fact",
    "start": "257459",
    "end": "259019"
  },
  {
    "text": "when you're running like arbitrary",
    "start": "259019",
    "end": "261209"
  },
  {
    "text": "things on your environment and like",
    "start": "261209",
    "end": "264570"
  },
  {
    "text": "there are a few ways we could do",
    "start": "264570",
    "end": "265770"
  },
  {
    "text": "isolation in a",
    "start": "265770",
    "end": "267160"
  },
  {
    "text": "nobly Safeway and the one we picked for",
    "start": "267160",
    "end": "269680"
  },
  {
    "text": "sake I wonder though was Alex see as you",
    "start": "269680",
    "end": "273220"
  },
  {
    "text": "can see this is a perfect representation",
    "start": "273220",
    "end": "274690"
  },
  {
    "text": "of a sandbox as just everything flaps",
    "start": "274690",
    "end": "276820"
  },
  {
    "text": "around everywhere over the years we've",
    "start": "276820",
    "end": "281080"
  },
  {
    "text": "come pretty adept at managing the",
    "start": "281080",
    "end": "282550"
  },
  {
    "text": "nuances of Alex II and it's tools like",
    "start": "282550",
    "end": "285040"
  },
  {
    "text": "we know what they do how they work and",
    "start": "285040",
    "end": "287710"
  },
  {
    "text": "we understand a lot of the edge cases",
    "start": "287710",
    "end": "289240"
  },
  {
    "text": "and so we wanted to capitalize on an",
    "start": "289240",
    "end": "292510"
  },
  {
    "text": "experience by picking tools that share",
    "start": "292510",
    "end": "294100"
  },
  {
    "text": "many of these qualities and on tirado",
    "start": "294100",
    "end": "297250"
  },
  {
    "text": "alongside wanting to support",
    "start": "297250",
    "end": "298660"
  },
  {
    "text": "containerized builds we also had to",
    "start": "298660",
    "end": "300970"
  },
  {
    "text": "offer a fuscus support for alternative",
    "start": "300970",
    "end": "302680"
  },
  {
    "text": "environments such as running on a full",
    "start": "302680",
    "end": "304510"
  },
  {
    "text": "linux vm",
    "start": "304510",
    "end": "305110"
  },
  {
    "text": "or Mac OS VM for building software that",
    "start": "305110",
    "end": "307570"
  },
  {
    "text": "needs more resources or if you're",
    "start": "307570",
    "end": "309400"
  },
  {
    "text": "wanting to build and publish docking",
    "start": "309400",
    "end": "310630"
  },
  {
    "text": "containers or testing your iPhone app we",
    "start": "310630",
    "end": "317560"
  },
  {
    "text": "also have some slightly interesting",
    "start": "317560",
    "end": "318880"
  },
  {
    "text": "scheduling concerns at our peak we push",
    "start": "318880",
    "end": "321670"
  },
  {
    "text": "thousands of jobs for a minute and many",
    "start": "321670",
    "end": "323560"
  },
  {
    "text": "schedulers can't handle large volumes of",
    "start": "323560",
    "end": "325450"
  },
  {
    "text": "very short-lived batch jobs many job",
    "start": "325450",
    "end": "328480"
  },
  {
    "text": "schedulers the design for running",
    "start": "328480",
    "end": "330130"
  },
  {
    "text": "long-running services or processing",
    "start": "330130",
    "end": "333190"
  },
  {
    "text": "large expensive tasks tend to have",
    "start": "333190",
    "end": "335770"
  },
  {
    "text": "fairly slow schedulers that optimized",
    "start": "335770",
    "end": "337540"
  },
  {
    "text": "for finding optimal placement rather",
    "start": "337540",
    "end": "340480"
  },
  {
    "text": "than trying to like schedule it quickly",
    "start": "340480",
    "end": "344700"
  },
  {
    "text": "and these types of scheduling algorithms",
    "start": "344700",
    "end": "348100"
  },
  {
    "text": "tend to become quite expensive when",
    "start": "348100",
    "end": "350260"
  },
  {
    "text": "you're trying to schedule like this many",
    "start": "350260",
    "end": "352000"
  },
  {
    "text": "jobs on a very large cluster of machines",
    "start": "352000",
    "end": "354120"
  },
  {
    "text": "and circle CIA isn't just a SAS product",
    "start": "354120",
    "end": "359260"
  },
  {
    "start": "356000",
    "end": "356000"
  },
  {
    "text": "we also offer an on-premise deployment",
    "start": "359260",
    "end": "361480"
  },
  {
    "text": "option this means that any tool we",
    "start": "361480",
    "end": "363550"
  },
  {
    "text": "deploy as part of our product needs to",
    "start": "363550",
    "end": "365860"
  },
  {
    "text": "be operable by people who are not",
    "start": "365860",
    "end": "367000"
  },
  {
    "text": "necessarily domain experts and offer the",
    "start": "367000",
    "end": "370210"
  },
  {
    "text": "power to automate away most of the rough",
    "start": "370210",
    "end": "372040"
  },
  {
    "text": "edges and that means sometimes means we",
    "start": "372040",
    "end": "375880"
  },
  {
    "text": "are more sensitive to manual ops",
    "start": "375880",
    "end": "377470"
  },
  {
    "text": "overhead than many other organizations",
    "start": "377470",
    "end": "380820"
  },
  {
    "text": "and at the same time we were looking for",
    "start": "380820",
    "end": "383710"
  },
  {
    "start": "381000",
    "end": "381000"
  },
  {
    "text": "a platform that would enable us to run",
    "start": "383710",
    "end": "385600"
  },
  {
    "text": "our products services and infrastructure",
    "start": "385600",
    "end": "386980"
  },
  {
    "text": "though allow us to scale out beyond like",
    "start": "386980",
    "end": "389230"
  },
  {
    "text": "the single development instance that was",
    "start": "389230",
    "end": "390940"
  },
  {
    "text": "the first prototype of Toronto and",
    "start": "390940",
    "end": "393910"
  },
  {
    "text": "support us for the considerable future",
    "start": "393910",
    "end": "395710"
  },
  {
    "text": "and so this is going to sound a little",
    "start": "395710",
    "end": "398530"
  },
  {
    "text": "weird to everyone at a kubernetes",
    "start": "398530",
    "end": "400539"
  },
  {
    "text": "conference",
    "start": "400539",
    "end": "401080"
  },
  {
    "text": "but our initial search landed us with",
    "start": "401080",
    "end": "403180"
  },
  {
    "text": "two options mezzos and nomad Mesa has",
    "start": "403180",
    "end": "408250"
  },
  {
    "text": "had the advantage of being extremely",
    "start": "408250",
    "end": "409810"
  },
  {
    "text": "robust and battle-tested operating a",
    "start": "409810",
    "end": "412449"
  },
  {
    "text": "ridiculous scale in places like Twitter",
    "start": "412449",
    "end": "414520"
  },
  {
    "text": "air B&B and Apple however a big part of",
    "start": "414520",
    "end": "417189"
  },
  {
    "text": "its ability to support those",
    "start": "417189",
    "end": "418180"
  },
  {
    "text": "organizations rests on significant",
    "start": "418180",
    "end": "419979"
  },
  {
    "text": "overhead for the operator to use me as",
    "start": "419979",
    "end": "422919"
  },
  {
    "text": "US you also need an orchestration",
    "start": "422919",
    "end": "424569"
  },
  {
    "text": "framework like marathon or Chronos and",
    "start": "424569",
    "end": "426370"
  },
  {
    "text": "depending on going choose you get a very",
    "start": "426370",
    "end": "428590"
  },
  {
    "text": "different experience and for our build",
    "start": "428590",
    "end": "431919"
  },
  {
    "text": "infrastructure we need it's good support",
    "start": "431919",
    "end": "434650"
  },
  {
    "text": "for batch jobs and mazes didn't have a",
    "start": "434650",
    "end": "436389"
  },
  {
    "text": "great solution for this and like it's a",
    "start": "436389",
    "end": "438610"
  },
  {
    "text": "good tool but it was definitely not the",
    "start": "438610",
    "end": "440560"
  },
  {
    "text": "right tool for us with the engineering",
    "start": "440560",
    "end": "443590"
  },
  {
    "text": "capacity we had at the time and we'd",
    "start": "443590",
    "end": "445330"
  },
  {
    "text": "have had to write a lot of code to make",
    "start": "445330",
    "end": "446800"
  },
  {
    "text": "it do the right thing and we already use",
    "start": "446800",
    "end": "451210"
  },
  {
    "text": "a bunch of the hashing help stat stack",
    "start": "451210",
    "end": "453180"
  },
  {
    "text": "provisioning our infrastructure with",
    "start": "453180",
    "end": "454990"
  },
  {
    "text": "terraform and building our a.m. eyes",
    "start": "454990",
    "end": "456759"
  },
  {
    "text": "with Packer so how she copes still very",
    "start": "456759",
    "end": "459250"
  },
  {
    "text": "young Nomad was an interesting contender",
    "start": "459250",
    "end": "460840"
  },
  {
    "text": "and unlike many orchestrators",
    "start": "460840",
    "end": "464370"
  },
  {
    "start": "462000",
    "end": "462000"
  },
  {
    "text": "nomadically choose between a few",
    "start": "464370",
    "end": "466090"
  },
  {
    "text": "different scheduling algorithms and for",
    "start": "466090",
    "end": "468250"
  },
  {
    "text": "batch jobs used as an algorithm based on",
    "start": "468250",
    "end": "470110"
  },
  {
    "text": "the berkeley sparrow scheduler that",
    "start": "470110",
    "end": "471879"
  },
  {
    "text": "applies a power of two choices load",
    "start": "471879",
    "end": "473379"
  },
  {
    "text": "balancing technique to job scheduling",
    "start": "473379",
    "end": "474940"
  },
  {
    "text": "and this results in a job scheduler that",
    "start": "474940",
    "end": "477159"
  },
  {
    "text": "is incredibly fast",
    "start": "477159",
    "end": "480539"
  },
  {
    "start": "480000",
    "end": "480000"
  },
  {
    "text": "nomads executor is also incredibly",
    "start": "480750",
    "end": "483129"
  },
  {
    "text": "pluggable with built-in support for",
    "start": "483129",
    "end": "484690"
  },
  {
    "text": "running various container technologies",
    "start": "484690",
    "end": "486190"
  },
  {
    "text": "or simply allowing us to execute an",
    "start": "486190",
    "end": "489069"
  },
  {
    "text": "arbitrary binary allowing us to",
    "start": "489069",
    "end": "491440"
  },
  {
    "text": "precisely control how we set up and",
    "start": "491440",
    "end": "492969"
  },
  {
    "text": "execute our customer jobs this is",
    "start": "492969",
    "end": "495250"
  },
  {
    "text": "incredibly useful for us as we start",
    "start": "495250",
    "end": "497409"
  },
  {
    "text": "supporting things like virtual machines",
    "start": "497409",
    "end": "499710"
  },
  {
    "text": "or supporting running multiple services",
    "start": "499710",
    "end": "502810"
  },
  {
    "text": "alongside your primary build container",
    "start": "502810",
    "end": "506219"
  },
  {
    "text": "it also has a incredibly powerful API",
    "start": "506219",
    "end": "510150"
  },
  {
    "start": "507000",
    "end": "507000"
  },
  {
    "text": "the exposes most of its state which is",
    "start": "510150",
    "end": "513880"
  },
  {
    "text": "really great for when we're building a",
    "start": "513880",
    "end": "515198"
  },
  {
    "text": "toss scheduling capabilities and when we",
    "start": "515199",
    "end": "517570"
  },
  {
    "text": "want to provide tools on top of nomad to",
    "start": "517570",
    "end": "519370"
  },
  {
    "text": "automate its use in our on-premise",
    "start": "519370",
    "end": "521469"
  },
  {
    "text": "deployments",
    "start": "521469",
    "end": "523890"
  },
  {
    "text": "Nomad was also still very young and we",
    "start": "524760",
    "end": "527860"
  },
  {
    "text": "could talk with the know my team and",
    "start": "527860",
    "end": "529000"
  },
  {
    "text": "influenced its direction and contribute",
    "start": "529000",
    "end": "531130"
  },
  {
    "text": "our own patches upstream as necessary",
    "start": "531130",
    "end": "533050"
  },
  {
    "text": "with relative ease",
    "start": "533050",
    "end": "534670"
  },
  {
    "text": "it's also still rapidly evolving with",
    "start": "534670",
    "end": "536380"
  },
  {
    "text": "many abstain cheese coming that allow us",
    "start": "536380",
    "end": "537850"
  },
  {
    "text": "to remove many of our own out-of-band",
    "start": "537850",
    "end": "539320"
  },
  {
    "text": "patches and cycling that I'll talk about",
    "start": "539320",
    "end": "541240"
  },
  {
    "text": "later that being said this usefulness",
    "start": "541240",
    "end": "545740"
  },
  {
    "text": "came with some problems while by there",
    "start": "545740",
    "end": "548470"
  },
  {
    "text": "were various stability and operational",
    "start": "548470",
    "end": "549970"
  },
  {
    "text": "issues that would force us to ssh in and",
    "start": "549970",
    "end": "551830"
  },
  {
    "text": "restart like random processors because",
    "start": "551830",
    "end": "553600"
  },
  {
    "text": "things would be wedged or somewhat",
    "start": "553600",
    "end": "555460"
  },
  {
    "text": "randomly failing and so because of our",
    "start": "555460",
    "end": "559450"
  },
  {
    "start": "557000",
    "end": "557000"
  },
  {
    "text": "desire for strong isolation between",
    "start": "559450",
    "end": "561010"
  },
  {
    "text": "builds and internal services we came to",
    "start": "561010",
    "end": "564190"
  },
  {
    "text": "an interesting realization we didn't",
    "start": "564190",
    "end": "566470"
  },
  {
    "text": "need to use the same tool for both our",
    "start": "566470",
    "end": "567880"
  },
  {
    "text": "job execution and our internal",
    "start": "567880",
    "end": "569170"
  },
  {
    "text": "infrastructure this would allow us to",
    "start": "569170",
    "end": "571420"
  },
  {
    "text": "leverage the tools that make sense for",
    "start": "571420",
    "end": "572830"
  },
  {
    "text": "the problem domain without trying to",
    "start": "572830",
    "end": "575650"
  },
  {
    "text": "shoehorn the capabilities of one into",
    "start": "575650",
    "end": "577210"
  },
  {
    "text": "the other or maintaining huge amounts of",
    "start": "577210",
    "end": "579370"
  },
  {
    "text": "code to emulate the features we wanted",
    "start": "579370",
    "end": "580990"
  },
  {
    "text": "and we definitely still didn't want to",
    "start": "580990",
    "end": "583390"
  },
  {
    "text": "operationalize nomad and eventually we",
    "start": "583390",
    "end": "585940"
  },
  {
    "text": "decided I'm using nomads and kubernetes",
    "start": "585940",
    "end": "588100"
  },
  {
    "text": "together unlike many of the other",
    "start": "588100",
    "end": "591520"
  },
  {
    "text": "orchestration options at the time",
    "start": "591520",
    "end": "592900"
  },
  {
    "text": "kubernetes was already approaching the",
    "start": "592900",
    "end": "594400"
  },
  {
    "text": "point of being relatively stable and",
    "start": "594400",
    "end": "596920"
  },
  {
    "text": "used in a growing number of large-scale",
    "start": "596920",
    "end": "599200"
  },
  {
    "text": "production environments and has like as",
    "start": "599200",
    "end": "601570"
  },
  {
    "text": "you can see here today an amazing",
    "start": "601570",
    "end": "603370"
  },
  {
    "text": "community of people around it we also",
    "start": "603370",
    "end": "606580"
  },
  {
    "text": "members of our Suri team that had used",
    "start": "606580",
    "end": "608020"
  },
  {
    "text": "it in previous jobs and the lifespan and",
    "start": "608020",
    "end": "610720"
  },
  {
    "text": "adoption of the tool gave us confidence",
    "start": "610720",
    "end": "612220"
  },
  {
    "text": "that others had encountered similar",
    "start": "612220",
    "end": "613690"
  },
  {
    "text": "problems to us and perhaps knew how to",
    "start": "613690",
    "end": "615820"
  },
  {
    "text": "solve them being able to go to an IRC",
    "start": "615820",
    "end": "618250"
  },
  {
    "text": "channel or a mailing list or Twitter and",
    "start": "618250",
    "end": "620170"
  },
  {
    "text": "have people have potential ideas about",
    "start": "620170",
    "end": "622000"
  },
  {
    "text": "how to solve the problem is really",
    "start": "622000",
    "end": "623530"
  },
  {
    "text": "valuable so as I was saying a big part",
    "start": "623530",
    "end": "629440"
  },
  {
    "text": "of we didn't want to use Mesa was that a",
    "start": "629440",
    "end": "632170"
  },
  {
    "text": "lot of its operational knowledge is",
    "start": "632170",
    "end": "633730"
  },
  {
    "text": "locked in the silos of very very large",
    "start": "633730",
    "end": "635380"
  },
  {
    "text": "enterprises and nobody on a team already",
    "start": "635380",
    "end": "638020"
  },
  {
    "text": "knew how to use it and filling in those",
    "start": "638020",
    "end": "639490"
  },
  {
    "text": "gaps without the community it would have",
    "start": "639490",
    "end": "641020"
  },
  {
    "text": "been an impossible Mountain and so",
    "start": "641020",
    "end": "643450"
  },
  {
    "text": "that's really what one of the main",
    "start": "643450",
    "end": "644890"
  },
  {
    "text": "factors that gave us the confidence we",
    "start": "644890",
    "end": "647020"
  },
  {
    "text": "needed to push to use Kuban aids in",
    "start": "647020",
    "end": "648790"
  },
  {
    "text": "production the other like one of my",
    "start": "648790",
    "end": "654670"
  },
  {
    "text": "other like favorite reasons of using",
    "start": "654670",
    "end": "656590"
  },
  {
    "text": "kubernetes it now specific workload was",
    "start": "656590",
    "end": "659290"
  },
  {
    "text": "the great support has for doing rolling",
    "start": "659290",
    "end": "661360"
  },
  {
    "text": "updates and readiness checking we",
    "start": "661360",
    "end": "663730"
  },
  {
    "text": "continuously deliver all of our software",
    "start": "663730",
    "end": "665220"
  },
  {
    "text": "and regardless of how much you test a",
    "start": "665220",
    "end": "668020"
  },
  {
    "text": "server",
    "start": "668020",
    "end": "668500"
  },
  {
    "text": "knowing that if you push a bad config",
    "start": "668500",
    "end": "670700"
  },
  {
    "text": "change your service will crash and not",
    "start": "670700",
    "end": "672920"
  },
  {
    "text": "be rolled out to like all of production",
    "start": "672920",
    "end": "674570"
  },
  {
    "text": "thus taking everything down it's just",
    "start": "674570",
    "end": "677540"
  },
  {
    "text": "like a warm hug from your computer",
    "start": "677540",
    "end": "680890"
  },
  {
    "text": "usually they just make me want to throw",
    "start": "680890",
    "end": "683089"
  },
  {
    "text": "them into the sea and in the case of",
    "start": "683089",
    "end": "686540"
  },
  {
    "text": "running a state floor service like Nomad",
    "start": "686540",
    "end": "687920"
  },
  {
    "text": "it allows you to maintain quorum during",
    "start": "687920",
    "end": "690290"
  },
  {
    "text": "deployments which it was one of the more",
    "start": "690290",
    "end": "692750"
  },
  {
    "text": "frustrating issues during our testing",
    "start": "692750",
    "end": "694279"
  },
  {
    "text": "phases kubernetes also strikes a nice",
    "start": "694279",
    "end": "698810"
  },
  {
    "start": "696000",
    "end": "696000"
  },
  {
    "text": "balance of giving you a lot of valuable",
    "start": "698810",
    "end": "701540"
  },
  {
    "text": "functionality with reasonable default",
    "start": "701540",
    "end": "703190"
  },
  {
    "text": "somewhat out of the box while allowing",
    "start": "703190",
    "end": "705950"
  },
  {
    "text": "you to replace most of the components",
    "start": "705950",
    "end": "707390"
  },
  {
    "text": "without having to reinvent your entire",
    "start": "707390",
    "end": "709850"
  },
  {
    "text": "architecture which is really nice when",
    "start": "709850",
    "end": "712339"
  },
  {
    "text": "you're spinning up a new piece of",
    "start": "712339",
    "end": "713360"
  },
  {
    "text": "infrastructure so you want to last you a",
    "start": "713360",
    "end": "714769"
  },
  {
    "text": "while and so we ultimately made the",
    "start": "714769",
    "end": "717769"
  },
  {
    "start": "716000",
    "end": "716000"
  },
  {
    "text": "distinction that Nomad is part of our",
    "start": "717769",
    "end": "719420"
  },
  {
    "text": "product it's where we run builds and it",
    "start": "719420",
    "end": "721610"
  },
  {
    "text": "ships as part of our on premise product",
    "start": "721610",
    "end": "723019"
  },
  {
    "text": "as well as in our suffering but",
    "start": "723019",
    "end": "725750"
  },
  {
    "text": "kubernetes is what we use for scaling",
    "start": "725750",
    "end": "727490"
  },
  {
    "text": "our platform and operationalizing our",
    "start": "727490",
    "end": "729230"
  },
  {
    "text": "product we leverage its features to",
    "start": "729230",
    "end": "731480"
  },
  {
    "text": "allow us to run our application layer",
    "start": "731480",
    "end": "732709"
  },
  {
    "text": "services and to provide abstraction and",
    "start": "732709",
    "end": "734990"
  },
  {
    "text": "automation over our other cloud",
    "start": "734990",
    "end": "736190"
  },
  {
    "text": "resources and so what I'm really saying",
    "start": "736190",
    "end": "738709"
  },
  {
    "text": "is it's just schedulers all the way down",
    "start": "738709",
    "end": "741519"
  },
  {
    "text": "because yes we do run a scheduler inside",
    "start": "741519",
    "end": "744440"
  },
  {
    "text": "a scheduler and there's even a meta",
    "start": "744440",
    "end": "746779"
  },
  {
    "text": "scheduler running inside a scheduler the",
    "start": "746779",
    "end": "748490"
  },
  {
    "text": "schedules on the other scheduler and so",
    "start": "748490",
    "end": "752660"
  },
  {
    "text": "now we know some of the tools were",
    "start": "752660",
    "end": "754010"
  },
  {
    "text": "working with let's look at a bit of how",
    "start": "754010",
    "end": "755570"
  },
  {
    "text": "we set this up and explore some of the",
    "start": "755570",
    "end": "757070"
  },
  {
    "text": "things that didn't necessarily go so",
    "start": "757070",
    "end": "759680"
  },
  {
    "text": "well and how we left research tools to",
    "start": "759680",
    "end": "763760"
  },
  {
    "text": "fix them and so this was supposed to be",
    "start": "763760",
    "end": "769850"
  },
  {
    "start": "769000",
    "end": "769000"
  },
  {
    "text": "a gift but apparently it is not a gift",
    "start": "769850",
    "end": "771290"
  },
  {
    "text": "it's fine from an Operations perspective",
    "start": "771290",
    "end": "774199"
  },
  {
    "text": "Nomad is comprised of two main",
    "start": "774199",
    "end": "775850"
  },
  {
    "text": "components the nomad server which is the",
    "start": "775850",
    "end": "778220"
  },
  {
    "text": "nomad control plane and nomad clients",
    "start": "778220",
    "end": "780709"
  },
  {
    "text": "which execute the jobs provided by the",
    "start": "780709",
    "end": "782360"
  },
  {
    "text": "nomad server we were in the nomad",
    "start": "782360",
    "end": "784550"
  },
  {
    "text": "servers inside kubernetes and the",
    "start": "784550",
    "end": "787490"
  },
  {
    "text": "clients are external and for us another",
    "start": "787490",
    "end": "789980"
  },
  {
    "text": "deployment also has some ancillary",
    "start": "789980",
    "end": "791209"
  },
  {
    "text": "services that exist to integrate nomad",
    "start": "791209",
    "end": "793040"
  },
  {
    "text": "with the rest of our domain some",
    "start": "793040",
    "end": "794690"
  },
  {
    "text": "monitoring and a bunch of herbs",
    "start": "794690",
    "end": "795949"
  },
  {
    "text": "automation I'll talk more about this in",
    "start": "795949",
    "end": "798949"
  },
  {
    "text": "a minute",
    "start": "798949",
    "end": "800670"
  },
  {
    "text": "so Nomad is an inherently stateful",
    "start": "800670",
    "end": "802500"
  },
  {
    "text": "service built on top of Raph for",
    "start": "802500",
    "end": "804120"
  },
  {
    "text": "handling blog replication and with a",
    "start": "804120",
    "end": "806070"
  },
  {
    "text": "couple of different persistence operate",
    "start": "806070",
    "end": "807360"
  },
  {
    "text": "options",
    "start": "807360",
    "end": "808680"
  },
  {
    "text": "nobody require also requires some form",
    "start": "808680",
    "end": "810600"
  },
  {
    "text": "of service discovery for initial cluster",
    "start": "810600",
    "end": "812250"
  },
  {
    "text": "bootstrapping",
    "start": "812250",
    "end": "812760"
  },
  {
    "text": "after which standard gossip protocol",
    "start": "812760",
    "end": "815610"
  },
  {
    "text": "total takes over so how do we manage",
    "start": "815610",
    "end": "818760"
  },
  {
    "start": "817000",
    "end": "817000"
  },
  {
    "text": "that persistence we handled nomad",
    "start": "818760",
    "end": "821100"
  },
  {
    "text": "storage by having dedicated kubernetes",
    "start": "821100",
    "end": "823110"
  },
  {
    "text": "clients for Nomad server workloads I",
    "start": "823110",
    "end": "825170"
  },
  {
    "text": "which we then mount the host storage of",
    "start": "825170",
    "end": "827880"
  },
  {
    "text": "into the Nomad server container which",
    "start": "827880",
    "end": "830190"
  },
  {
    "text": "allows us to leverage our existing",
    "start": "830190",
    "end": "831510"
  },
  {
    "text": "practices for managing stateful services",
    "start": "831510",
    "end": "833460"
  },
  {
    "text": "and simplifies our kubernetes",
    "start": "833460",
    "end": "835380"
  },
  {
    "text": "configuration but this was before many",
    "start": "835380",
    "end": "840420"
  },
  {
    "text": "of the new sort of Nomad store other",
    "start": "840420",
    "end": "842340"
  },
  {
    "text": "criminally storage API is really existed",
    "start": "842340",
    "end": "847160"
  },
  {
    "text": "and because Nomad is a distributed",
    "start": "847340",
    "end": "850260"
  },
  {
    "text": "stateful services so this it also",
    "start": "850260",
    "end": "852150"
  },
  {
    "text": "requires some way to do discovery of",
    "start": "852150",
    "end": "853590"
  },
  {
    "text": "other server nodes and there are a few",
    "start": "853590",
    "end": "854850"
  },
  {
    "text": "ways you can do that how she caught",
    "start": "854850",
    "end": "857340"
  },
  {
    "text": "recommend using console for this and it",
    "start": "857340",
    "end": "859860"
  },
  {
    "text": "works reasonably well with relatively",
    "start": "859860",
    "end": "862110"
  },
  {
    "text": "low overhead to get set up and",
    "start": "862110",
    "end": "863310"
  },
  {
    "text": "configured and it's a very stable piece",
    "start": "863310",
    "end": "865470"
  },
  {
    "text": "of software",
    "start": "865470",
    "end": "866010"
  },
  {
    "text": "however our initial console setup was a",
    "start": "866010",
    "end": "869340"
  },
  {
    "text": "little bit of a snowflake cluster and it",
    "start": "869340",
    "end": "872490"
  },
  {
    "text": "was not running within kubernetes and so",
    "start": "872490",
    "end": "875550"
  },
  {
    "start": "875000",
    "end": "875000"
  },
  {
    "text": "when we started expanding our Nomad",
    "start": "875550",
    "end": "876930"
  },
  {
    "text": "requirements to deploy multiple clusters",
    "start": "876930",
    "end": "878960"
  },
  {
    "text": "we found were initially using the same",
    "start": "878960",
    "end": "881400"
  },
  {
    "text": "console cluster for multiple deployments",
    "start": "881400",
    "end": "883440"
  },
  {
    "text": "of nomad which when it comes to",
    "start": "883440",
    "end": "885180"
  },
  {
    "text": "minimizing share dependencies and",
    "start": "885180",
    "end": "886590"
  },
  {
    "text": "isolating cost clusters was not an ideal",
    "start": "886590",
    "end": "889110"
  },
  {
    "text": "solution so we started evaluating",
    "start": "889110",
    "end": "892530"
  },
  {
    "text": "alternatives before trying to deploy yet",
    "start": "892530",
    "end": "894750"
  },
  {
    "text": "another stateful service inside",
    "start": "894750",
    "end": "896040"
  },
  {
    "text": "kubernetes and we eventually decided on",
    "start": "896040",
    "end": "900510"
  },
  {
    "text": "switching Nomad into using a kubernetes",
    "start": "900510",
    "end": "902370"
  },
  {
    "text": "stateful set which gave us really",
    "start": "902370",
    "end": "904380"
  },
  {
    "text": "predictable upgrade semantics to blend",
    "start": "904380",
    "end": "906570"
  },
  {
    "text": "wanting to maintain core and also",
    "start": "906570",
    "end": "908910"
  },
  {
    "text": "allowed us to do our initial nomad",
    "start": "908910",
    "end": "910380"
  },
  {
    "text": "server bootstrapping using only",
    "start": "910380",
    "end": "912180"
  },
  {
    "text": "kubernetes for service discovery and",
    "start": "912180",
    "end": "915660"
  },
  {
    "text": "I'll talk a little bit more about how",
    "start": "915660",
    "end": "916860"
  },
  {
    "text": "that works later now my clients are our",
    "start": "916860",
    "end": "920010"
  },
  {
    "text": "jobs actually execute and these don't",
    "start": "920010",
    "end": "921630"
  },
  {
    "text": "run inside communities but instead",
    "start": "921630",
    "end": "923310"
  },
  {
    "text": "within a standard AWS auto scaling group",
    "start": "923310",
    "end": "926570"
  },
  {
    "start": "926000",
    "end": "926000"
  },
  {
    "text": "we scale the clients with a fairly",
    "start": "926570",
    "end": "928770"
  },
  {
    "text": "simple autoscaler",
    "start": "928770",
    "end": "929730"
  },
  {
    "text": "that is driven by our metrics and goes",
    "start": "929730",
    "end": "932160"
  },
  {
    "text": "through an alerting pipeline",
    "start": "932160",
    "end": "934510"
  },
  {
    "text": "which then goes through RabbitMQ which",
    "start": "934510",
    "end": "936010"
  },
  {
    "text": "don't get scaled it's a wonderful",
    "start": "936010",
    "end": "937570"
  },
  {
    "text": "internet Rube Goldberg machine but it",
    "start": "937570",
    "end": "941440"
  },
  {
    "text": "comes with the added side effect of it's",
    "start": "941440",
    "end": "943300"
  },
  {
    "text": "really easy to shut down or override",
    "start": "943300",
    "end": "945220"
  },
  {
    "text": "when we want to over provision for",
    "start": "945220",
    "end": "946660"
  },
  {
    "text": "expected spikes and other such changes",
    "start": "946660",
    "end": "949420"
  },
  {
    "text": "or when migrating over to a new cluster",
    "start": "949420",
    "end": "953190"
  },
  {
    "start": "953000",
    "end": "953000"
  },
  {
    "text": "we originally used a patched version of",
    "start": "954990",
    "end": "957279"
  },
  {
    "text": "nomads to support training clients",
    "start": "957279",
    "end": "958449"
  },
  {
    "text": "without rescheduling jobs and other",
    "start": "958449",
    "end": "959889"
  },
  {
    "text": "nodes and I know my training service",
    "start": "959889",
    "end": "962529"
  },
  {
    "text": "that consumes the AWS lifecycle Hut's",
    "start": "962529",
    "end": "964300"
  },
  {
    "text": "to enable and disable training is",
    "start": "964300",
    "end": "965620"
  },
  {
    "text": "required but a new version of nomads",
    "start": "965620",
    "end": "968260"
  },
  {
    "text": "that was released last week adds",
    "start": "968260",
    "end": "971380"
  },
  {
    "text": "first-class support for controlling the",
    "start": "971380",
    "end": "972970"
  },
  {
    "text": "deterring behavior of clients and as we",
    "start": "972970",
    "end": "975070"
  },
  {
    "text": "start our testing and upgrades it should",
    "start": "975070",
    "end": "976480"
  },
  {
    "text": "be fairly simple to update our trainer",
    "start": "976480",
    "end": "977800"
  },
  {
    "text": "to use the new API for this we also run",
    "start": "977800",
    "end": "983170"
  },
  {
    "start": "981000",
    "end": "981000"
  },
  {
    "text": "an agent on Nomad clients that validates",
    "start": "983170",
    "end": "985089"
  },
  {
    "text": "that Nomad is up the status of the doc",
    "start": "985089",
    "end": "986800"
  },
  {
    "text": "arrangement and the internet reach",
    "start": "986800",
    "end": "988149"
  },
  {
    "text": "ability this their reports - like cloud",
    "start": "988149",
    "end": "991389"
  },
  {
    "text": "watch and stats key and all the things",
    "start": "991389",
    "end": "993820"
  },
  {
    "text": "so we can automatically try and remove",
    "start": "993820",
    "end": "995380"
  },
  {
    "text": "unhealthy nodes without intervention oh",
    "start": "995380",
    "end": "999060"
  },
  {
    "start": "998000",
    "end": "998000"
  },
  {
    "text": "yeah a few months ago we also migrated",
    "start": "1002180",
    "end": "1005490"
  },
  {
    "text": "to running inside multiple clusters as I",
    "start": "1005490",
    "end": "1007199"
  },
  {
    "text": "was saying to provide redundancy and",
    "start": "1007199",
    "end": "1009089"
  },
  {
    "text": "also to make it easier to canary new",
    "start": "1009089",
    "end": "1010649"
  },
  {
    "text": "releases of Nomad and our surrounding",
    "start": "1010649",
    "end": "1012720"
  },
  {
    "text": "tooling without affecting all of our",
    "start": "1012720",
    "end": "1014279"
  },
  {
    "text": "customers workloads we leveraged some",
    "start": "1014279",
    "end": "1016680"
  },
  {
    "text": "really nice kubernetes and terraform",
    "start": "1016680",
    "end": "1018120"
  },
  {
    "text": "features for this we deployed all of our",
    "start": "1018120",
    "end": "1021269"
  },
  {
    "start": "1019000",
    "end": "1019000"
  },
  {
    "text": "tariff infrastructure using terraform",
    "start": "1021269",
    "end": "1022920"
  },
  {
    "text": "because it creates his great visibility",
    "start": "1022920",
    "end": "1024298"
  },
  {
    "text": "and changes of entire deployment and",
    "start": "1024299",
    "end": "1026100"
  },
  {
    "text": "allows us to easily reason about and",
    "start": "1026100",
    "end": "1028530"
  },
  {
    "text": "change our configuration one of the",
    "start": "1028530",
    "end": "1031020"
  },
  {
    "text": "first steps in migrating to a multi",
    "start": "1031020",
    "end": "1032459"
  },
  {
    "text": "cluster deployment was to modulate our",
    "start": "1032459",
    "end": "1034110"
  },
  {
    "text": "terraform 12 hours to easily create",
    "start": "1034110",
    "end": "1035790"
  },
  {
    "text": "multiple downstream clusters with",
    "start": "1035790",
    "end": "1037410"
  },
  {
    "text": "minimal duplication we then migrated all",
    "start": "1037410",
    "end": "1041308"
  },
  {
    "start": "1039000",
    "end": "1039000"
  },
  {
    "text": "of our kubernetes manifests for our",
    "start": "1041309",
    "end": "1042780"
  },
  {
    "text": "deployment into helm we actually",
    "start": "1042780",
    "end": "1046140"
  },
  {
    "text": "packaged the entire deployment alongside",
    "start": "1046140",
    "end": "1047699"
  },
  {
    "text": "a bunch of sidecar services that provide",
    "start": "1047699",
    "end": "1050549"
  },
  {
    "text": "garbage collection draining metrics and",
    "start": "1050549",
    "end": "1054380"
  },
  {
    "text": "other services into a single home",
    "start": "1054380",
    "end": "1056880"
  },
  {
    "text": "package this makes it really easy first",
    "start": "1056880",
    "end": "1059370"
  },
  {
    "text": "of all to both CD it uses a standard CD",
    "start": "1059370",
    "end": "1061230"
  },
  {
    "text": "flight plane to a grade Nomad while also",
    "start": "1061230",
    "end": "1064169"
  },
  {
    "text": "being able to really easily manually",
    "start": "1064169",
    "end": "1065820"
  },
  {
    "text": "deploy a cluster if circle CI is down",
    "start": "1065820",
    "end": "1069679"
  },
  {
    "text": "which is really useful when you deploy",
    "start": "1069680",
    "end": "1072060"
  },
  {
    "text": "all of your things using production it's",
    "start": "1072060",
    "end": "1075810"
  },
  {
    "text": "the wonderful thing about working on CI",
    "start": "1075810",
    "end": "1077160"
  },
  {
    "text": "because you use CI to deploy the CI we",
    "start": "1077160",
    "end": "1084120"
  },
  {
    "start": "1083000",
    "end": "1083000"
  },
  {
    "text": "then deploy each cluster into its own",
    "start": "1084120",
    "end": "1085620"
  },
  {
    "text": "namespace in kubernetes which acts as a",
    "start": "1085620",
    "end": "1087660"
  },
  {
    "text": "neat grouping mechanism for all of the",
    "start": "1087660",
    "end": "1089190"
  },
  {
    "text": "related services and allows us to easily",
    "start": "1089190",
    "end": "1090930"
  },
  {
    "text": "manage an individual cluster an axe is a",
    "start": "1090930",
    "end": "1093390"
  },
  {
    "text": "good isolation boundary for services",
    "start": "1093390",
    "end": "1094950"
  },
  {
    "text": "that want to talk to a deployment the",
    "start": "1094950",
    "end": "1098460"
  },
  {
    "start": "1098000",
    "end": "1098000"
  },
  {
    "text": "use of cuban a namespaces alongside a",
    "start": "1098460",
    "end": "1101010"
  },
  {
    "text": "stateful set makes it easier to have",
    "start": "1101010",
    "end": "1103680"
  },
  {
    "text": "both handle auxilary services to",
    "start": "1103680",
    "end": "1105720"
  },
  {
    "text": "discover the related nomad deployment",
    "start": "1105720",
    "end": "1107670"
  },
  {
    "text": "and also for nomad service to discover",
    "start": "1107670",
    "end": "1110910"
  },
  {
    "text": "each other as they have deterministic",
    "start": "1110910",
    "end": "1113550"
  },
  {
    "text": "dns names provided by the stay flow set",
    "start": "1113550",
    "end": "1115520"
  },
  {
    "text": "that we can then use in the home",
    "start": "1115520",
    "end": "1117420"
  },
  {
    "text": "template to make it know where to look",
    "start": "1117420",
    "end": "1121550"
  },
  {
    "text": "and but as with all things computers",
    "start": "1121550",
    "end": "1124170"
  },
  {
    "text": "though it has not been entirely a",
    "start": "1124170",
    "end": "1125760"
  },
  {
    "text": "magical land of rainbows unicorns and",
    "start": "1125760",
    "end": "1127650"
  },
  {
    "text": "sparkles we've definitely experienced",
    "start": "1127650",
    "end": "1130410"
  },
  {
    "text": "some rough edges of both nomads and",
    "start": "1130410",
    "end": "1131700"
  },
  {
    "text": "kubernetes such as when we were trying",
    "start": "1131700",
    "end": "1134430"
  },
  {
    "text": "to fake tapes and Toleration zin old",
    "start": "1134430",
    "end": "1136770"
  },
  {
    "text": "versions of kubernetes and also some",
    "start": "1136770",
    "end": "1139110"
  },
  {
    "text": "rough edges of nomads that being said",
    "start": "1139110",
    "end": "1141600"
  },
  {
    "text": "we've been out to overcome and walk",
    "start": "1141600",
    "end": "1142950"
  },
  {
    "text": "around them and in the latter case",
    "start": "1142950",
    "end": "1144330"
  },
  {
    "text": "kubernetes has been super valuable in",
    "start": "1144330",
    "end": "1146040"
  },
  {
    "text": "that so it's time to talk about some",
    "start": "1146040",
    "end": "1149700"
  },
  {
    "text": "outages the first major set of",
    "start": "1149700",
    "end": "1153030"
  },
  {
    "text": "production outages we experience with",
    "start": "1153030",
    "end": "1155070"
  },
  {
    "text": "nomad were in January and taught us a",
    "start": "1155070",
    "end": "1157620"
  },
  {
    "text": "lot about some less obvious behavior in",
    "start": "1157620",
    "end": "1159570"
  },
  {
    "text": "nomad and resulted in some changes to",
    "start": "1159570",
    "end": "1161340"
  },
  {
    "text": "how we deploy our clusters kubernetes",
    "start": "1161340",
    "end": "1162870"
  },
  {
    "text": "and how nomad does some things so the",
    "start": "1162870",
    "end": "1166950"
  },
  {
    "start": "1166000",
    "end": "1166000"
  },
  {
    "text": "symptoms were quite interesting we",
    "start": "1166950",
    "end": "1168780"
  },
  {
    "text": "initially got paged for the no my job -",
    "start": "1168780",
    "end": "1170430"
  },
  {
    "text": "you're starting to rise quickly despite",
    "start": "1170430",
    "end": "1172650"
  },
  {
    "text": "us having like significant capacity to",
    "start": "1172650",
    "end": "1176910"
  },
  {
    "text": "be able to run users jobs and all of the",
    "start": "1176910",
    "end": "1179760"
  },
  {
    "text": "nomadic clients and servers appeared to",
    "start": "1179760",
    "end": "1181410"
  },
  {
    "text": "be opt and healthy and working normally",
    "start": "1181410",
    "end": "1184200"
  },
  {
    "text": "by all of their metrics and so after",
    "start": "1184200",
    "end": "1190560"
  },
  {
    "text": "digging into this for about like half an",
    "start": "1190560",
    "end": "1192630"
  },
  {
    "text": "hour we were getting very confused",
    "start": "1192630",
    "end": "1194240"
  },
  {
    "text": "because we would definitely know when",
    "start": "1194240",
    "end": "1196140"
  },
  {
    "text": "there are peak load but as we look",
    "start": "1196140",
    "end": "1198000"
  },
  {
    "text": "deeper we saw that nodes were simply not",
    "start": "1198000",
    "end": "1200100"
  },
  {
    "text": "receiving jobs anymore",
    "start": "1200100",
    "end": "1202020"
  },
  {
    "text": "and so we started to take a look into",
    "start": "1202020",
    "end": "1204480"
  },
  {
    "text": "the nomad servers and saw that all US",
    "start": "1204480",
    "end": "1206820"
  },
  {
    "text": "all of that logging had stopped outside",
    "start": "1206820",
    "end": "1209940"
  },
  {
    "text": "of a significant number of failed to",
    "start": "1209940",
    "end": "1212400"
  },
  {
    "text": "delete job requests and an attempt to",
    "start": "1212400",
    "end": "1215970"
  },
  {
    "text": "unleash the hosts we started just like",
    "start": "1215970",
    "end": "1217740"
  },
  {
    "text": "cycling the Nomad server pods which",
    "start": "1217740",
    "end": "1220710"
  },
  {
    "text": "allowed some amount of jobs to pass",
    "start": "1220710",
    "end": "1221940"
  },
  {
    "text": "through and ultimately in this case we",
    "start": "1221940",
    "end": "1226050"
  },
  {
    "start": "1225000",
    "end": "1225000"
  },
  {
    "text": "ended up making the tough call and just",
    "start": "1226050",
    "end": "1228240"
  },
  {
    "text": "dropping on Nomad state completely and",
    "start": "1228240",
    "end": "1230670"
  },
  {
    "text": "re bringing up the cluster from scratch",
    "start": "1230670",
    "end": "1233510"
  },
  {
    "text": "and in follow-up from that we were",
    "start": "1233510",
    "end": "1238170"
  },
  {
    "start": "1237000",
    "end": "1237000"
  },
  {
    "text": "reanalyzing our configuration and source",
    "start": "1238170",
    "end": "1240000"
  },
  {
    "text": "code and the source code of nomad and we",
    "start": "1240000",
    "end": "1243600"
  },
  {
    "text": "noticed we were missing some options",
    "start": "1243600",
    "end": "1244770"
  },
  {
    "text": "that would give us greater visibility",
    "start": "1244770",
    "end": "1245640"
  },
  {
    "text": "into the operations of its internal",
    "start": "1245640",
    "end": "1247320"
  },
  {
    "text": "state machine so we quickly enabled them",
    "start": "1247320",
    "end": "1250310"
  },
  {
    "text": "so we could get more data the next time",
    "start": "1250310",
    "end": "1253140"
  },
  {
    "text": "this incident occurred and with all",
    "start": "1253140",
    "end": "1255960"
  },
  {
    "text": "things computers it turned out we",
    "start": "1255960",
    "end": "1257520"
  },
  {
    "text": "wouldn't have to wait so long the next",
    "start": "1257520",
    "end": "1262470"
  },
  {
    "start": "1259000",
    "end": "1259000"
  },
  {
    "text": "day if we were once again grieved by the",
    "start": "1262470",
    "end": "1264090"
  },
  {
    "text": "same lovely page but this time we had",
    "start": "1264090",
    "end": "1266610"
  },
  {
    "text": "the metrics we needed to identify the",
    "start": "1266610",
    "end": "1268350"
  },
  {
    "text": "issue we were quick to deploy crump",
    "start": "1268350",
    "end": "1270870"
  },
  {
    "text": "declare bankruptcy after validating we",
    "start": "1270870",
    "end": "1272820"
  },
  {
    "text": "had the data we needed and doing some",
    "start": "1272820",
    "end": "1274290"
  },
  {
    "text": "manual introspection of the running",
    "start": "1274290",
    "end": "1275550"
  },
  {
    "text": "state and so when analyzing the data",
    "start": "1275550",
    "end": "1279210"
  },
  {
    "start": "1277000",
    "end": "1277000"
  },
  {
    "text": "we've collected we eventually realized",
    "start": "1279210",
    "end": "1280980"
  },
  {
    "text": "the issue was occurring during garbage",
    "start": "1280980",
    "end": "1282870"
  },
  {
    "text": "collection cycles when Nomad was cycled",
    "start": "1282870",
    "end": "1285120"
  },
  {
    "text": "through all of the completed jobs and",
    "start": "1285120",
    "end": "1286830"
  },
  {
    "text": "try and remove them from its graph",
    "start": "1286830",
    "end": "1288000"
  },
  {
    "text": "database the original implementation of",
    "start": "1288000",
    "end": "1292980"
  },
  {
    "text": "garbage collection in nomad would",
    "start": "1292980",
    "end": "1294930"
  },
  {
    "text": "iterate over every job that needed to be",
    "start": "1294930",
    "end": "1297060"
  },
  {
    "text": "collected and issued a separate request",
    "start": "1297060",
    "end": "1299310"
  },
  {
    "text": "to the cleanup engine which would take a",
    "start": "1299310",
    "end": "1302670"
  },
  {
    "text": "slot in the raft transaction log which",
    "start": "1302670",
    "end": "1304620"
  },
  {
    "text": "would then need to be applied to its",
    "start": "1304620",
    "end": "1305850"
  },
  {
    "text": "state machine and each of these requests",
    "start": "1305850",
    "end": "1308640"
  },
  {
    "text": "would then call out to the current Nomad",
    "start": "1308640",
    "end": "1309930"
  },
  {
    "text": "leader and block until the deletion had",
    "start": "1309930",
    "end": "1311430"
  },
  {
    "text": "been applied which was not ideal when",
    "start": "1311430",
    "end": "1314160"
  },
  {
    "text": "you had several hundred thousand jobs",
    "start": "1314160",
    "end": "1316350"
  },
  {
    "text": "trying to be directed at once and when",
    "start": "1316350",
    "end": "1320700"
  },
  {
    "text": "multiple nodes may be issuing the same",
    "start": "1320700",
    "end": "1322470"
  },
  {
    "text": "GC command at once and so we initially",
    "start": "1322470",
    "end": "1328470"
  },
  {
    "text": "tried reducing the GC cooldown from the",
    "start": "1328470",
    "end": "1330690"
  },
  {
    "text": "default four hours down to about 30",
    "start": "1330690",
    "end": "1332580"
  },
  {
    "text": "minutes under the guise of if you're",
    "start": "1332580",
    "end": "1334980"
  },
  {
    "text": "doing it more often",
    "start": "1334980",
    "end": "1335789"
  },
  {
    "text": "you have less stuff to clean up which",
    "start": "1335789",
    "end": "1339029"
  },
  {
    "text": "resulted in much more stable behavior",
    "start": "1339029",
    "end": "1340669"
  },
  {
    "text": "however it wasn't quite perfect and",
    "start": "1340669",
    "end": "1342989"
  },
  {
    "text": "around our peak times scheduling would",
    "start": "1342989",
    "end": "1345239"
  },
  {
    "text": "hole for just like 10 seconds while it",
    "start": "1345239",
    "end": "1347759"
  },
  {
    "text": "was going clearing up some state which",
    "start": "1347759",
    "end": "1350070"
  },
  {
    "text": "was just slow enough to trip up handing",
    "start": "1350070",
    "end": "1351989"
  },
  {
    "text": "jobs alerts and so because we only",
    "start": "1351989",
    "end": "1356519"
  },
  {
    "text": "really use the nomad API to intercept",
    "start": "1356519",
    "end": "1358200"
  },
  {
    "text": "jobs that have failed we don't really",
    "start": "1358200",
    "end": "1360299"
  },
  {
    "text": "need to keep around jobs that are in a",
    "start": "1360299",
    "end": "1362039"
  },
  {
    "text": "successful terminal State so we were a",
    "start": "1362039",
    "end": "1364499"
  },
  {
    "text": "small service that uses the nomad API to",
    "start": "1364499",
    "end": "1366840"
  },
  {
    "text": "continuously collect dead jobs and we",
    "start": "1366840",
    "end": "1370259"
  },
  {
    "text": "use the built-in collector as a",
    "start": "1370259",
    "end": "1371489"
  },
  {
    "text": "fail-safe in case that our service is",
    "start": "1371489",
    "end": "1373619"
  },
  {
    "text": "unavailable or cannot reach the nomad",
    "start": "1373619",
    "end": "1375149"
  },
  {
    "text": "API this resulted in significantly more",
    "start": "1375149",
    "end": "1379019"
  },
  {
    "text": "stable operation and was significantly",
    "start": "1379019",
    "end": "1380849"
  },
  {
    "text": "easier to deploy through our usage of",
    "start": "1380849",
    "end": "1382950"
  },
  {
    "text": "kubernetes because we added it to a home",
    "start": "1382950",
    "end": "1385080"
  },
  {
    "text": "package pushed and then we had garbage",
    "start": "1385080",
    "end": "1388769"
  },
  {
    "text": "collection the latest version of nomad",
    "start": "1388769",
    "end": "1393539"
  },
  {
    "start": "1392000",
    "end": "1392000"
  },
  {
    "text": "now actually batches deletion requests",
    "start": "1393539",
    "end": "1395489"
  },
  {
    "text": "we should see much better performance in",
    "start": "1395489",
    "end": "1397710"
  },
  {
    "text": "this type of usage environment and",
    "start": "1397710",
    "end": "1399029"
  },
  {
    "text": "should allow us to archive our own",
    "start": "1399029",
    "end": "1401159"
  },
  {
    "text": "garbage collector it also introduces a",
    "start": "1401159",
    "end": "1404340"
  },
  {
    "text": "new API for draining nodes and",
    "start": "1404340",
    "end": "1405809"
  },
  {
    "text": "controlling the way that jobs would",
    "start": "1405809",
    "end": "1407220"
  },
  {
    "text": "migrate to a new instance which should",
    "start": "1407220",
    "end": "1409830"
  },
  {
    "text": "allow us to fleet a fork which I'm",
    "start": "1409830",
    "end": "1411210"
  },
  {
    "text": "pretty excited about it's super exciting",
    "start": "1411210",
    "end": "1414210"
  },
  {
    "text": "to see these types of changes coming to",
    "start": "1414210",
    "end": "1415379"
  },
  {
    "text": "nomad as part of our autopilot feature",
    "start": "1415379",
    "end": "1416970"
  },
  {
    "text": "set I'm excited for its future",
    "start": "1416970",
    "end": "1419179"
  },
  {
    "text": "so in summary kubernetes helm and",
    "start": "1419179",
    "end": "1422519"
  },
  {
    "text": "terraform have made it significantly",
    "start": "1422519",
    "end": "1423570"
  },
  {
    "text": "easier to orchestrate our build system",
    "start": "1423570",
    "end": "1425279"
  },
  {
    "text": "and I'm personally really happy with the",
    "start": "1425279",
    "end": "1427979"
  },
  {
    "text": "power and control that they have given",
    "start": "1427979",
    "end": "1429090"
  },
  {
    "text": "us over that and the ways they've given",
    "start": "1429090",
    "end": "1431519"
  },
  {
    "text": "us to handle our clusters and also with",
    "start": "1431519",
    "end": "1433859"
  },
  {
    "text": "nomad which is continually improving and",
    "start": "1433859",
    "end": "1435929"
  },
  {
    "text": "becoming easier to operate while still",
    "start": "1435929",
    "end": "1438149"
  },
  {
    "text": "being incredibly fast at scheduling your",
    "start": "1438149",
    "end": "1439769"
  },
  {
    "text": "customers workloads and so I'm happy to",
    "start": "1439769",
    "end": "1443519"
  },
  {
    "text": "take questions if there's time or if",
    "start": "1443519",
    "end": "1444809"
  },
  {
    "text": "that's a thing but everyone is more than",
    "start": "1444809",
    "end": "1447179"
  },
  {
    "text": "welcome to come chat with me if you see",
    "start": "1447179",
    "end": "1448559"
  },
  {
    "text": "me around the rest of the conference",
    "start": "1448559",
    "end": "1450409"
  },
  {
    "text": "thank you",
    "start": "1450409",
    "end": "1451940"
  },
  {
    "text": "[Applause]",
    "start": "1451940",
    "end": "1458049"
  }
]