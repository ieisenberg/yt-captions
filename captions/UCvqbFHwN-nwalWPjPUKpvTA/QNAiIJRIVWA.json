[
  {
    "start": "0",
    "end": "31000"
  },
  {
    "text": "all right so next up is uh francois here he's going to talk us about uh somebody i was just talking to to come to this",
    "start": "80",
    "end": "7440"
  },
  {
    "text": "talk uh they try they're trying to figure out how to do and testing in their environment so preview environment",
    "start": "7440",
    "end": "13920"
  },
  {
    "text": "sounds rather similar so take it away francois thank you thank you test test do you hear me all well",
    "start": "13920",
    "end": "20640"
  },
  {
    "text": "a bit of asmr test test no it's fine okay um",
    "start": "20640",
    "end": "26160"
  },
  {
    "text": "let's start with implementing previous environments with githubs in kubernetes",
    "start": "26160",
    "end": "31199"
  },
  {
    "start": "31000",
    "end": "31000"
  },
  {
    "text": "first about me as my accent can show you i'm french but i am working in",
    "start": "31199",
    "end": "36800"
  },
  {
    "text": "hamburg germany with weather maybe a bit different from spain from spain for the one that already visited the city i work",
    "start": "36800",
    "end": "43920"
  },
  {
    "text": "at i'm devops engineer at remazing which is a mid-sized company but we have a very small",
    "start": "43920",
    "end": "49280"
  },
  {
    "text": "team tech like roughly 10 persons so maybe not the same scale at some companies before",
    "start": "49280",
    "end": "54800"
  },
  {
    "text": "and on my free time i like open source so i joined the see release team of kubernetes for the last release",
    "start": "54800",
    "end": "60960"
  },
  {
    "text": "and for the summer i will pose a bit open source and maybe come back in the winter",
    "start": "60960",
    "end": "66080"
  },
  {
    "text": "about the company so you can understand what's uh why would it preview environments so it's a agency with a software that we",
    "start": "66080",
    "end": "73280"
  },
  {
    "text": "build in-house we sell to other companies and this software is multi-tenant and i will maybe refer it",
    "start": "73280",
    "end": "80640"
  },
  {
    "text": "later during the talk as remdash and that's for this software that we built previous environments",
    "start": "80640",
    "end": "87520"
  },
  {
    "start": "87000",
    "end": "87000"
  },
  {
    "text": "so one year ago again like not so long ago we still used a basic",
    "start": "87520",
    "end": "93280"
  },
  {
    "text": "uh workflow for our main software so we have plenty of microservices but this one had a simple git flow so we had a",
    "start": "93280",
    "end": "99920"
  },
  {
    "text": "team of developers and they are pushing to staging and then you have everything deployed on",
    "start": "99920",
    "end": "105040"
  },
  {
    "text": "staging environment so it's just one branch staging deployed everything fine and when you want to merge on production",
    "start": "105040",
    "end": "110960"
  },
  {
    "text": "we do it every monday we is a request a release or hotfix",
    "start": "110960",
    "end": "116079"
  },
  {
    "text": "and we merged on production it's deploying production it's kind of nice so imagine someone push a good comment",
    "start": "116079",
    "end": "122640"
  },
  {
    "text": "and you have maybe i don't know 10 15 per request before this release day and someone pushed a wrong comment what",
    "start": "122640",
    "end": "129520"
  },
  {
    "text": "will happen it comes it can seem maybe like super simple and the code looks great so you have the approval it's got",
    "start": "129520",
    "end": "136400"
  },
  {
    "text": "merchant staging but yeah too bad you couldn't test it very well and staging is broken so how do you deploy on monday",
    "start": "136400",
    "end": "144239"
  },
  {
    "text": "your features because you need to fix this for this first this feature before matching a production",
    "start": "144239",
    "end": "150800"
  },
  {
    "text": "and yeah it can happen with one pro request two requests whatever so let's see a quick list of pros and",
    "start": "150800",
    "end": "157120"
  },
  {
    "text": "cons about this workflow so the first one is quite easy to set up right so you have staging environment in",
    "start": "157120",
    "end": "164239"
  },
  {
    "text": "your bitbucket pipeline ammo or whatever you use for the pipeline it's mostly copy paste and then use a flag like",
    "start": "164239",
    "end": "170560"
  },
  {
    "text": "production for the production so super easy and it's fast like if you want to deploy",
    "start": "170560",
    "end": "176000"
  },
  {
    "text": "something in production you just have to create one through request two staging and then one prequest to production and",
    "start": "176000",
    "end": "183519"
  },
  {
    "text": "it's easily merged in production let's say but you have some cons that are added to those two nice pros uh first",
    "start": "183519",
    "end": "191120"
  },
  {
    "text": "one it's hard to reduce and test so let's say someone is going to merge something on staging you want to review",
    "start": "191120",
    "end": "197040"
  },
  {
    "text": "it you will need to check out on the branch pull the branch test everything is working fine maybe you don't have the",
    "start": "197040",
    "end": "202239"
  },
  {
    "text": "same environment or imagine someone is adding a radius you will need to set up and register in local",
    "start": "202239",
    "end": "207920"
  },
  {
    "text": "it's getting a bit messy and it's hard to let's just review the pro request or test something easily",
    "start": "207920",
    "end": "215519"
  },
  {
    "text": "second it's not the best for new joiners so imagine you have a new new developers joining the team",
    "start": "215519",
    "end": "221519"
  },
  {
    "text": "they may want to push as much as possible new codes to test okay let's let's try to break it to see if it works",
    "start": "221519",
    "end": "228799"
  },
  {
    "text": "and without breaking breaking staging because staging a lot of persons are working with staging or qa but if you",
    "start": "228799",
    "end": "234640"
  },
  {
    "text": "let's say work with previous environments which would be a new thermal environment aside you can break",
    "start": "234640",
    "end": "239920"
  },
  {
    "text": "it it's meant to be break which is very good and yeah as i said other difficulties to",
    "start": "239920",
    "end": "246720"
  },
  {
    "text": "test new infra so let's say you want to test radius or a mail server whatever it's hard to",
    "start": "246720",
    "end": "252560"
  },
  {
    "text": "manually add it to staging without modifying the other features that are on your staging",
    "start": "252560",
    "end": "258720"
  },
  {
    "text": "and last one as i said before one pull request one feature one branch",
    "start": "258720",
    "end": "264400"
  },
  {
    "text": "can break the world staging which will then you will need to fix this feature",
    "start": "264400",
    "end": "269440"
  },
  {
    "text": "without it you cannot merge to production so it will slower your time to market and in a startup environment",
    "start": "269440",
    "end": "275919"
  },
  {
    "text": "let's say time to market is very important because you want to to be better than the other tools so",
    "start": "275919",
    "end": "281759"
  },
  {
    "text": "that led us to this great schema and this one is about previous environments and git ups so i will say",
    "start": "281759",
    "end": "288720"
  },
  {
    "start": "283000",
    "end": "283000"
  },
  {
    "text": "there are two main features why get ups is useful if people there you want you have other",
    "start": "288720",
    "end": "295199"
  },
  {
    "text": "receipts i mean if you don't want to stand so about get ups",
    "start": "295199",
    "end": "300320"
  },
  {
    "text": "you have two main features where you want to to maybe use github's preview environment maybe you deploy all your",
    "start": "300320",
    "end": "305919"
  },
  {
    "text": "infrastructure or all the the rest with git ups principles and it just copy paste basically to deploy it in previous",
    "start": "305919",
    "end": "313120"
  },
  {
    "text": "the other part is maybe you want to move to github and start to i don't know see how it works and maybe you don't",
    "start": "313120",
    "end": "319520"
  },
  {
    "text": "want to switch directly to production or staging and preview environments is a step way just before staging or qa",
    "start": "319520",
    "end": "326960"
  },
  {
    "text": "so it allows you to to test basically how github works different tools like operators flux or argo and because it's",
    "start": "326960",
    "end": "334240"
  },
  {
    "text": "um it's a step before staging it's very likely to break so very good because then you can you can test what happens",
    "start": "334240",
    "end": "340720"
  },
  {
    "text": "if you have a wrong you have a drift and you need to reconcile it you have resources breaking maybe databases you",
    "start": "340720",
    "end": "346240"
  },
  {
    "text": "manage so i will say the best way to start githubs",
    "start": "346240",
    "end": "351600"
  },
  {
    "text": "as you can see here it's quite simple i will go through all the steps but it's easily like often you push code",
    "start": "351600",
    "end": "358400"
  },
  {
    "text": "to like let's say developers push codes on to a code repositories uh github bitbucket in our case it's bitbucket and",
    "start": "358400",
    "end": "365440"
  },
  {
    "text": "you will see in the following presentation that billboard has some flaws let's say that maybe you don't",
    "start": "365440",
    "end": "370479"
  },
  {
    "text": "have with github or gitlabs so it involves a bit of bash script spoil",
    "start": "370479",
    "end": "376240"
  },
  {
    "text": "and so you push your docker image to a docker registry in our case docker hub and then in another step you will just",
    "start": "376240",
    "end": "382960"
  },
  {
    "text": "commit the environment which is just a yaml file and a docker tag to make it declarative and",
    "start": "382960",
    "end": "389120"
  },
  {
    "text": "reproducible and we commit this to another repository ops repository where you store all your infrastructure and",
    "start": "389120",
    "end": "395360"
  },
  {
    "text": "then an agent let's say argo we just watch think and deploy to change changes to different namespaces so in the end if",
    "start": "395360",
    "end": "402479"
  },
  {
    "text": "you have 10 pro requests you have 10 namespaces in your communities cluster accessible with different urls",
    "start": "402479",
    "end": "409440"
  },
  {
    "text": "uh yeah disclaimer with argo cd let's say you have what's called generators proquest generators which is doing",
    "start": "409440",
    "end": "417440"
  },
  {
    "text": "like which in which is simplify most of the steps that i will talk about but for bitbucket it's not available yet so",
    "start": "417440",
    "end": "424000"
  },
  {
    "text": "yeah let's dig a bit into it first some pitfalls i would like to to",
    "start": "424000",
    "end": "429840"
  },
  {
    "start": "426000",
    "end": "426000"
  },
  {
    "text": "new before implementing previous environment first github is great when you want to",
    "start": "429840",
    "end": "435440"
  },
  {
    "text": "when you have a working state at the end because everything is working smoothly you can trace your commits you you can",
    "start": "435440",
    "end": "441360"
  },
  {
    "text": "test like it's super nice it's you feel shaved let's say but when you test it",
    "start": "441360",
    "end": "446800"
  },
  {
    "text": "it's a mess because then you need to push to build an image wait everything is committed to the apps repo so you",
    "start": "446800",
    "end": "452240"
  },
  {
    "text": "lose time so at the beginning what i would advise is to use a tool like scaffold that will compact all the steps",
    "start": "452240",
    "end": "457599"
  },
  {
    "text": "build push and deploy in one case it was just with docker and helm",
    "start": "457599",
    "end": "462720"
  },
  {
    "text": "and we compile everything of this to focus and intensify on maybe",
    "start": "462720",
    "end": "468000"
  },
  {
    "text": "uh just how the deployment will work how everything will fit for your preview environment",
    "start": "468000",
    "end": "473120"
  },
  {
    "text": "in our case we deployed a laravel application which is a bit harder than not gs let's say or go to deploy because",
    "start": "473120",
    "end": "479919"
  },
  {
    "text": "you have php fpm engineering and other stuff so scaffold really saves a lot of time",
    "start": "479919",
    "end": "486400"
  },
  {
    "text": "now let's dig a bit into the bitbucket pipeline.tml so for those of you that are not familiar",
    "start": "486400",
    "end": "492000"
  },
  {
    "text": "with bettercat you have one yaml file and this ml5 inside of it you declare everything you want for your pipeline",
    "start": "492000",
    "end": "498560"
  },
  {
    "text": "and so in this case you can say okay i want to listen to two branches",
    "start": "498560",
    "end": "506080"
  },
  {
    "text": "so all the branches that are matching feature and the other one fixed because in our case we didn't want to deploy a",
    "start": "506080",
    "end": "511840"
  },
  {
    "text": "previous environment on a very short-lived branch like hotfix or something we want to be as fast as",
    "start": "511840",
    "end": "516880"
  },
  {
    "text": "possible and this one you trigger two steps as i said you build and push to a remote registry remote docker registry",
    "start": "516880",
    "end": "523360"
  },
  {
    "text": "what to say and the second one github cd step so when you commit something to the apps",
    "start": "523360",
    "end": "528880"
  },
  {
    "text": "repository uh so yeah a bit scary so this one is super simple",
    "start": "528880",
    "end": "535519"
  },
  {
    "start": "530000",
    "end": "530000"
  },
  {
    "text": "just you log into docker you build your image and you push it to remote registry but because bitbucket makes it a bit",
    "start": "535519",
    "end": "542000"
  },
  {
    "text": "harder sometimes there is one step that is good to take a look look at is this one",
    "start": "542000",
    "end": "548480"
  },
  {
    "text": "so this one you export the current tag where your pipeline is building to a bash script and you will source it",
    "start": "548480",
    "end": "554800"
  },
  {
    "text": "later because all the way what can happen let's say you have a slow document building or maybe your pipeline",
    "start": "554800",
    "end": "560320"
  },
  {
    "text": "doesn't have a lot of ram you will have you will build one docker image and then you will go to the next step the",
    "start": "560320",
    "end": "567040"
  },
  {
    "text": "github step but then your head of the branch the head of the branch will change so with bitbucket with this",
    "start": "567040",
    "end": "572800"
  },
  {
    "text": "simple like trick let's say you can be sure that the two steps are matching the same tag",
    "start": "572800",
    "end": "579120"
  },
  {
    "text": "yeah i think that's all we have to say about it the second one which is a mix between cicd",
    "start": "579120",
    "end": "584480"
  },
  {
    "start": "582000",
    "end": "582000"
  },
  {
    "text": "it's about steel bit bucket so second step git ups first one we don't want to create a",
    "start": "584480",
    "end": "590800"
  },
  {
    "text": "previous environment with master so we just remove it at the beginning as you can see here",
    "start": "590800",
    "end": "596959"
  },
  {
    "text": "let's highlight it and then we import our environment so we are sure to match the same tag as",
    "start": "596959",
    "end": "604160"
  },
  {
    "text": "we had in the previous step otherwise we will commit something to the ops repo and argo will be like wait this stack",
    "start": "604160",
    "end": "609839"
  },
  {
    "text": "doesn't exist and then you have your preview that crash and then we just clone ops repo add some",
    "start": "609839",
    "end": "615839"
  },
  {
    "text": "ssh keys and commits the application yaml file so the interesting part here",
    "start": "615839",
    "end": "622000"
  },
  {
    "text": "is this one in the code repo in our case we stored the helm shot we use hem",
    "start": "622000",
    "end": "628480"
  },
  {
    "text": "inside our code repo so any developer can modify the handshaft let's say you work on a feature that",
    "start": "628480",
    "end": "634399"
  },
  {
    "text": "will increase a lot of memory you can modify the m shot it will deploy and it will deploy the previous",
    "start": "634399",
    "end": "641360"
  },
  {
    "text": "environment with let's say more memory or developer wants to add redis for caching database queries they can modify",
    "start": "641360",
    "end": "647760"
  },
  {
    "text": "it directly on the code repo and they don't have to touch the infrared report",
    "start": "647760",
    "end": "653519"
  },
  {
    "text": "and for this we just modify so a previous file that i will show you i think next slide",
    "start": "653519",
    "end": "659200"
  },
  {
    "text": "and we inject like pr id pr names so we can build nice urls uh you can inject",
    "start": "659200",
    "end": "665440"
  },
  {
    "text": "other stuff like the tag of the image for npm npm no",
    "start": "665440",
    "end": "670560"
  },
  {
    "text": "fpm and nginx and also stuff like this and then you just commit it and you push",
    "start": "670560",
    "end": "677120"
  },
  {
    "text": "uh yeah next slide about the continuous deployment on aggro cd",
    "start": "677120",
    "end": "682160"
  },
  {
    "start": "680000",
    "end": "680000"
  },
  {
    "text": "um so for our cd we just installed it in the cluster i mean you have plenty of documentation about doing it and in our",
    "start": "682160",
    "end": "689120"
  },
  {
    "text": "ops repository we have one file the one i told you about with the template so we have",
    "start": "689120",
    "end": "695360"
  },
  {
    "text": "environment variables that will be replaced with our current environment and inside of it you put everything you",
    "start": "695360",
    "end": "701680"
  },
  {
    "text": "want like the one which we use useful for the url you can put other values file let's say everything is",
    "start": "701680",
    "end": "708079"
  },
  {
    "text": "customizable and argo will watch this file and deploy it accordingly and as you can see here",
    "start": "708079",
    "end": "715120"
  },
  {
    "text": "we have the target revision just here to help you a bit more",
    "start": "715120",
    "end": "720639"
  },
  {
    "text": "this one is set to the branch we are working on so the the pro request let's say",
    "start": "720639",
    "end": "725680"
  },
  {
    "text": "and so every change will be detected by argo and argo will reconciliate",
    "start": "725680",
    "end": "731839"
  },
  {
    "start": "731000",
    "end": "731000"
  },
  {
    "text": "and then why argo cd i feel like there is a big yeah there are other tools but in our case it was mainly is do we use",
    "start": "731839",
    "end": "738800"
  },
  {
    "text": "flux or argo cd we use flux for everything related to infrastructure so",
    "start": "738800",
    "end": "744560"
  },
  {
    "text": "primitives graphene ingress controller traffic salt manager cube",
    "start": "744560",
    "end": "749920"
  },
  {
    "text": "city secrets whatever and it's nice it works nicely it's a cli i mean i love it",
    "start": "749920",
    "end": "755680"
  },
  {
    "text": "but in a case of preview environments you want to have developers easily debug what's wrong what's going uh what's",
    "start": "755680",
    "end": "762160"
  },
  {
    "text": "nicely happening in your cluster and sadly beautifully i don't know but argo",
    "start": "762160",
    "end": "767200"
  },
  {
    "text": "is way more nicer like in one url you can see what's happening how it works",
    "start": "767200",
    "end": "773200"
  },
  {
    "text": "so that's why we kept flux for the infrastructure and argos did to deploy previous environments",
    "start": "773200",
    "end": "779920"
  },
  {
    "text": "about it just quickly about the flex structure in our case we have one folder per cluster we have three four clusters",
    "start": "780320",
    "end": "787440"
  },
  {
    "text": "so it works nicely maybe if you scale up you want to change this way of working but in our case it's working super",
    "start": "787440",
    "end": "793360"
  },
  {
    "text": "nicely you have all your so uh tools like i said earlier ingress controller still secret monitoring whatever",
    "start": "793360",
    "end": "801600"
  },
  {
    "text": "and then argo cd and your applications will use all those custom resource definitions inside your shots or inside",
    "start": "801600",
    "end": "808160"
  },
  {
    "text": "your customizations so in anger cd we manage argo cd itself by ago city in",
    "start": "808160",
    "end": "814079"
  },
  {
    "text": "apps of apps concept and inside the previous arm folder",
    "start": "814079",
    "end": "819279"
  },
  {
    "text": "that i can highlight here that's where we commit all our previous environments so if you check master",
    "start": "819279",
    "end": "826160"
  },
  {
    "text": "branch of argo cd repository you will see all the previous environments that are deployed which make it easy to",
    "start": "826160",
    "end": "832639"
  },
  {
    "text": "delete afterwards when you close the branch when you close a when you merge a pr you just delete the file that is",
    "start": "832639",
    "end": "839440"
  },
  {
    "text": "responsible for the previous environment so as well for resources if you see something a file that got committed",
    "start": "839440",
    "end": "845040"
  },
  {
    "text": "maybe two weeks ago you may want to delete why do we have a feature open for two weeks we want to",
    "start": "845040",
    "end": "850560"
  },
  {
    "text": "merge fast and to test features then the biggest i would say uh problem",
    "start": "850560",
    "end": "856639"
  },
  {
    "start": "853000",
    "end": "853000"
  },
  {
    "text": "with the githubs when you start to use githubs you always have this way where you start",
    "start": "856639",
    "end": "861839"
  },
  {
    "text": "to committing your secrets to a repository hopefully a local i mean a private one that you just test stuff in",
    "start": "861839",
    "end": "868639"
  },
  {
    "text": "but then later you want to just store your secrets so let's say database credentials or",
    "start": "868639",
    "end": "874399"
  },
  {
    "text": "anything like uh api keys docker hub secrets to access your private registry",
    "start": "874399",
    "end": "881360"
  },
  {
    "text": "and in our case we will still secret so it's super easy you just install",
    "start": "881360",
    "end": "886399"
  },
  {
    "text": "sil secret and you have a small cli to use it and what you will commit is only the still secret part which is a crd",
    "start": "886399",
    "end": "894000"
  },
  {
    "text": "and this will be encrypted with a key of our controller so no one has access",
    "start": "894000",
    "end": "900320"
  },
  {
    "text": "to this key except the controller so you can give ups or admins access to this key and only them can encrypt secrets",
    "start": "900320",
    "end": "907680"
  },
  {
    "text": "and so then you can commit safely to get it's the easiest way with fun i know there are a vault or whatever that you",
    "start": "907680",
    "end": "914399"
  },
  {
    "text": "can use but as let's say fast to implement it was kind of very good and then in your cluster you have the",
    "start": "914399",
    "end": "920399"
  },
  {
    "text": "secrets additional tip if you use helm let's say you can use condition so",
    "start": "920399",
    "end": "926320"
  },
  {
    "text": "a simple if okay if you are deploying uh let's say a production environment or you are testing with local you can use a",
    "start": "926320",
    "end": "932399"
  },
  {
    "text": "different uh secret file that you encrypted with maybe your local kind cluster key or your staging cluster or",
    "start": "932399",
    "end": "939440"
  },
  {
    "text": "whatever which makes it easier to test because then depending of the values file you use you can use different",
    "start": "939440",
    "end": "945120"
  },
  {
    "text": "secrets you don't have to every time get the the key of the controller and",
    "start": "945120",
    "end": "950240"
  },
  {
    "text": "then encrypt again your secret etc then let's talk about the multi-tenants",
    "start": "950240",
    "end": "955440"
  },
  {
    "start": "953000",
    "end": "953000"
  },
  {
    "text": "so for our applications at our company rendash we have a multi-tenant setup and for",
    "start": "955440",
    "end": "960639"
  },
  {
    "text": "every previous environment so for every pro request created we want a url and for each url we have we want a client on",
    "start": "960639",
    "end": "968480"
  },
  {
    "text": "top of it so anyone can you can test different clients if you sit clients you can test them easily",
    "start": "968480",
    "end": "973839"
  },
  {
    "text": "and it causes a bit of problems because at the beginning we hardcoded on traffic",
    "start": "973839",
    "end": "979199"
  },
  {
    "text": "the wildcard and then how do you do this do you modify the traffic manifest which is",
    "start": "979199",
    "end": "984320"
  },
  {
    "text": "at the core in another infrareport because it's just a tool that's using the cluster it's not in the argo cd repo",
    "start": "984320",
    "end": "991920"
  },
  {
    "text": "so what we use is we combine traffic as in ingress controller and self manager another tool that will manage https",
    "start": "991920",
    "end": "999680"
  },
  {
    "text": "the great thing about start manager it's it will give you as well high availability because then",
    "start": "999680",
    "end": "1004720"
  },
  {
    "text": "traffic won't have to manage all the secrets and stuff so those two working together are deployed with flux",
    "start": "1004720",
    "end": "1010720"
  },
  {
    "text": "and i will show you next step um so that's how we manage like let's",
    "start": "1010720",
    "end": "1017440"
  },
  {
    "start": "1015000",
    "end": "1015000"
  },
  {
    "text": "say infrastructure to previous environment so in one side you have all the search manager stuff so you have the",
    "start": "1017440",
    "end": "1023600"
  },
  {
    "text": "helmet repository with cm for cell manager so we installed self manager with flux we have our cluster issuer",
    "start": "1023600",
    "end": "1031038"
  },
  {
    "text": "responsible for dns wildcards and or in our case digital sound secret but you",
    "start": "1031039",
    "end": "1036160"
  },
  {
    "text": "can put any cloud provider spreads cloudflare whatever and with this once it's set up all the",
    "start": "1036160",
    "end": "1042959"
  },
  {
    "text": "previous environment stuff all the argo will use those resources so for each environment that you commit you will",
    "start": "1042959",
    "end": "1049600"
  },
  {
    "text": "have a certificate which inside of it the name of the url you want to give it and to generate your wildcard and then",
    "start": "1049600",
    "end": "1056160"
  },
  {
    "text": "ingress route matching the secrets created by this secret certificate and you will have one card on the floor so",
    "start": "1056160",
    "end": "1062720"
  },
  {
    "text": "for any pro request created you have wildcard certificate which is i find super nice no need to ssh into",
    "start": "1062720",
    "end": "1070400"
  },
  {
    "text": "the pods install search bot whatever uh let's another challenge we had to",
    "start": "1070400",
    "end": "1077840"
  },
  {
    "start": "1073000",
    "end": "1073000"
  },
  {
    "text": "to go through let's say with what are with our elasticsearch database",
    "start": "1077840",
    "end": "1082960"
  },
  {
    "text": "is the hooks we have helm and that's how we deployed at the beginning and with helm you can easily match them with",
    "start": "1082960",
    "end": "1089520"
  },
  {
    "text": "hooks on argo city so hooks we just basically say okay every time you reconciliate and you",
    "start": "1089520",
    "end": "1094720"
  },
  {
    "text": "deploy something or you yeah in post-install mode you will just run a job for example and then",
    "start": "1094720",
    "end": "1100640"
  },
  {
    "text": "you can run long-running operations after each deployment in our case we",
    "start": "1100640",
    "end": "1105760"
  },
  {
    "text": "want everything text related to be indexed and so it runs on the flow it's",
    "start": "1105760",
    "end": "1111120"
  },
  {
    "text": "super nice and you can imagine i don't know applying to whatever you want so if you want to see new clients new data",
    "start": "1111120",
    "end": "1118320"
  },
  {
    "text": "yeah testing fake data you can do it on every deployment you can even maybe like wipe the database and re reseed with",
    "start": "1118320",
    "end": "1125120"
  },
  {
    "text": "random data everything makes it easy um then about namespace i don't know who",
    "start": "1125120",
    "end": "1131760"
  },
  {
    "start": "1129000",
    "end": "1129000"
  },
  {
    "text": "is using lens here but then it's super nice because you can give a drop down and you can see all the your name spaces",
    "start": "1131760",
    "end": "1137440"
  },
  {
    "text": "in your kubernetes cluster but as well when you do uh cubesatl get namespaces after a while imagine i don't",
    "start": "1137440",
    "end": "1144720"
  },
  {
    "text": "know you release 20 requests per week or way more depending on the size of your organization you will have a huge list",
    "start": "1144720",
    "end": "1151360"
  },
  {
    "text": "of name spaces and then you will start to graph into the namespaces to find the good one it's a mess so",
    "start": "1151360",
    "end": "1157360"
  },
  {
    "text": "an easy way to do it with argo you can create the namespace easily with adding just one option",
    "start": "1157360",
    "end": "1163520"
  },
  {
    "text": "but you cannot delete it easily and so if you create a namespace resource then argo when you delete the previous",
    "start": "1163520",
    "end": "1169840"
  },
  {
    "text": "environment file will go through all the resources secrets whatever delete them and then at the end we'll delete the",
    "start": "1169840",
    "end": "1175200"
  },
  {
    "text": "namespace itself so you don't hang up with empty namespaces in your cluster",
    "start": "1175200",
    "end": "1181760"
  },
  {
    "start": "1181000",
    "end": "1181000"
  },
  {
    "text": "now let's talk about developer experience because the main goal of previous environment is to",
    "start": "1181840",
    "end": "1188640"
  },
  {
    "text": "improve let's say time to market developer velocity like the you want to push comments like to test better",
    "start": "1188640",
    "end": "1194960"
  },
  {
    "text": "features and to push more comments so yeah a bit of bash not too hard though",
    "start": "1194960",
    "end": "1200320"
  },
  {
    "text": "before deploying we check if you know ops repository there is an environment file so as you can see first line",
    "start": "1200320",
    "end": "1207360"
  },
  {
    "text": "and if so we just commit on the pro request so i'm sure there are other tools to notify which trades like but",
    "start": "1207360",
    "end": "1212640"
  },
  {
    "text": "the best it's still on the pro request you left a comment okay this is the url of your previous environment so when a",
    "start": "1212640",
    "end": "1218799"
  },
  {
    "text": "developer is test they open the pro request they have their automated commit they click on it and they have their",
    "start": "1218799",
    "end": "1224320"
  },
  {
    "text": "previous environment where they can do anything they want they can break anything they won't slow down the release that will soon come to",
    "start": "1224320",
    "end": "1230320"
  },
  {
    "text": "production they can try to break it and that's we want if the pro the previous environment is broken that's good",
    "start": "1230320",
    "end": "1236159"
  },
  {
    "text": "because no no clients no no one cares if the previous is broken it's meant to be broken",
    "start": "1236159",
    "end": "1242880"
  },
  {
    "text": "another one is the good thing with argo cd is the ui so you want to expose this way to give it",
    "start": "1242880",
    "end": "1248559"
  },
  {
    "text": "access to your users or developers i mean by users i mean developers so you can easily add an ingress route",
    "start": "1248559",
    "end": "1254960"
  },
  {
    "text": "let's say you have a traffic so you had an ingress route you can secure it with passwords you can use",
    "start": "1254960",
    "end": "1260799"
  },
  {
    "text": "roles with argo cd so you just want to give a read-only role to your developers so they can just see",
    "start": "1260799",
    "end": "1267280"
  },
  {
    "text": "what's happening and if something breaks they can push some fixes and yeah they can just",
    "start": "1267280",
    "end": "1272480"
  },
  {
    "text": "see in a nice way what's happening and if you don't trust into",
    "start": "1272480",
    "end": "1278000"
  },
  {
    "text": "having let's say an operator such argo cd that controls your cluster with an open url even",
    "start": "1278000",
    "end": "1284320"
  },
  {
    "text": "behind a basic oauth and passwords and roles you can still keep power forwarding and give access only to this",
    "start": "1284320",
    "end": "1291440"
  },
  {
    "text": "forward power forward and then your developers can access argo cd",
    "start": "1291440",
    "end": "1296639"
  },
  {
    "text": "almost done with the dx so about the web book ocd with reconciliate every x minute so",
    "start": "1297280",
    "end": "1304480"
  },
  {
    "text": "i don't know what's the default five too but to speed up a bit the things especially if your docker",
    "start": "1304480",
    "end": "1310240"
  },
  {
    "text": "build time is taking long you can use what's called a web book so i guess everyone is familiar and you can",
    "start": "1310240",
    "end": "1317280"
  },
  {
    "text": "set it up with bitbucket easily and then every time you have a change on your ops repo it will just reconcile",
    "start": "1317280",
    "end": "1323679"
  },
  {
    "text": "reconciliate the state and you will have faster deployments",
    "start": "1323679",
    "end": "1328799"
  },
  {
    "text": "and last and i just wanted to add the slide because it's useful you can give some like say bash commands to easily",
    "start": "1328799",
    "end": "1335520"
  },
  {
    "text": "ssh into a pod to debug for the developers or let's say to forward database connection a mail server that",
    "start": "1335520",
    "end": "1341120"
  },
  {
    "text": "will catch all the emails to test it's kind of nice a bit dirty but it works well and tips depends of your",
    "start": "1341120",
    "end": "1348000"
  },
  {
    "text": "maturity in security but at the beginning we were pre pre we are like let's say refusing roots to",
    "start": "1348000",
    "end": "1354880"
  },
  {
    "text": "the containers but then you cannot install packages if you want to debug you cannot like ssh and then start to",
    "start": "1354880",
    "end": "1361039"
  },
  {
    "text": "create files modifying stuff so in the end for previous environment not production",
    "start": "1361039",
    "end": "1367919"
  },
  {
    "text": "i think it's a good idea to just allow roots to debug but that's a close environment like so",
    "start": "1368000",
    "end": "1373280"
  },
  {
    "text": "it's fine and last but not least thanks to uh flexity maintainer uh kingdom i think on",
    "start": "1373280",
    "end": "1379840"
  },
  {
    "start": "1374000",
    "end": "1374000"
  },
  {
    "text": "the slack and if you have questions slack channels are great like cncf or kubernetes",
    "start": "1379840",
    "end": "1385760"
  },
  {
    "text": "he told me about this renovabot which is a life changer honestly so the problem with installing resources is over the",
    "start": "1385760",
    "end": "1392320"
  },
  {
    "text": "time you have upgrade patches or security issues that happens or maybe you will i don't know stay for one year",
    "start": "1392320",
    "end": "1398159"
  },
  {
    "text": "to the same 0.5 versions and you want to upgrade automatically and you can run this bot on bitbucket um so it will just",
    "start": "1398159",
    "end": "1406159"
  },
  {
    "text": "run let's say weekly daily depending of how you trigger your pipeline automatically and then create pull",
    "start": "1406159",
    "end": "1411760"
  },
  {
    "text": "requests you would say okay your let's say your loki instance need to be upgraded you can change the change logs",
    "start": "1411760",
    "end": "1418240"
  },
  {
    "text": "okay you compare what's changing do i need to do something manual maybe remove some crgs i don't know and then you just",
    "start": "1418240",
    "end": "1423840"
  },
  {
    "text": "click merge and you have up to date clusters and tools so great tool and that was the last slide",
    "start": "1423840",
    "end": "1431919"
  },
  {
    "text": "so thanks for everyone to listening maybe change a bit of i don't know huge",
    "start": "1431919",
    "end": "1436960"
  },
  {
    "text": "clusters and stuff but that's how we do it in house and previous environments really helped now you can really easily",
    "start": "1436960",
    "end": "1442960"
  },
  {
    "text": "test features and with git apps it's a nice way to to start using git ups let's say before",
    "start": "1442960",
    "end": "1448080"
  },
  {
    "text": "going to production and maybe if something breaks you don't want i don't know bad things to happen",
    "start": "1448080",
    "end": "1454000"
  },
  {
    "text": "and that's it thanks especially git sapscon and kubecon if you have any questions let me know",
    "start": "1454000",
    "end": "1461440"
  },
  {
    "text": "any questions come on back also if you have a chair",
    "start": "1466320",
    "end": "1471520"
  },
  {
    "text": "that's open next to you raise your hand we have people standing over here",
    "start": "1471520",
    "end": "1476240"
  },
  {
    "text": "so so you mentioned that you're using flax cd for infra and argo argo cd for developers",
    "start": "1477520",
    "end": "1484480"
  },
  {
    "text": "why that split i understand the argo cd part for the ui and everything but then why for uh",
    "start": "1484480",
    "end": "1490720"
  },
  {
    "text": "yeah why flux so at the beginning it was just a random choice let's say let's pick flux it",
    "start": "1490720",
    "end": "1496720"
  },
  {
    "text": "looks great it's uh working well with the helm uh so i started with with flux",
    "start": "1496720",
    "end": "1502159"
  },
  {
    "text": "and then when doing something for developers uh cli i mean cli is not the best like",
    "start": "1502159",
    "end": "1507200"
  },
  {
    "text": "to to see quickly a change you need to learn a cli tool and stuff so the ui of ago cd i checked there was no project",
    "start": "1507200",
    "end": "1513760"
  },
  {
    "text": "from flux to have a ui but it doesn't seem like continuated or well updated",
    "start": "1513760",
    "end": "1520720"
  },
  {
    "text": "because it's like flux is doing production environment and it's working great and i don't want too much to move",
    "start": "1521600",
    "end": "1526880"
  },
  {
    "text": "to aggro city yet i mean maybe in six months one year we are mature enough to migrate to argo city but in a",
    "start": "1526880",
    "end": "1533440"
  },
  {
    "text": "environment let's say where it's not critical it's nice to test stuff so you can both test something nice",
    "start": "1533440",
    "end": "1539600"
  },
  {
    "text": "and at the same way it's not critical i i don't want to move production environment or production resources on",
    "start": "1539600",
    "end": "1546960"
  },
  {
    "text": "something just as a test you know as a co-chair uh i see a lot of people",
    "start": "1546960",
    "end": "1552320"
  },
  {
    "text": "doing exactly that like their actual infrastructure spun up with flux the applications are spun up with argo it's",
    "start": "1552320",
    "end": "1558960"
  },
  {
    "text": "totally normal and fine to use both you don't have to go all in on one",
    "start": "1558960",
    "end": "1564080"
  },
  {
    "text": "that's the beauty of kubernetes and githubs any other question",
    "start": "1564080",
    "end": "1568799"
  },
  {
    "text": "uh great talk um i'm just curious to see where application sets fits into",
    "start": "1572159",
    "end": "1577440"
  },
  {
    "text": "all of the preview environment set up that you have have you considered it at all within the orgo ecosystem can can",
    "start": "1577440",
    "end": "1583039"
  },
  {
    "text": "you repeat just application sets yes so for application sets we don't use them because uh we don't need to",
    "start": "1583039",
    "end": "1590480"
  },
  {
    "text": "let's say have the same setup i mean application applications applications set it's still hard to say",
    "start": "1590480",
    "end": "1597279"
  },
  {
    "text": "um it seems really good for if you want to generalize stuff and to maybe deploy to",
    "start": "1597279",
    "end": "1602559"
  },
  {
    "text": "several clusters or stuff but in our case it's working great and maybe we'll move to application application set",
    "start": "1602559",
    "end": "1608960"
  },
  {
    "text": "later i saw i mean i wish that the bitbucket is integrated into the pull request",
    "start": "1608960",
    "end": "1614480"
  },
  {
    "text": "generator which was may which will make listening on events way like faster and better and we can ditch",
    "start": "1614480",
    "end": "1620960"
  },
  {
    "text": "the world i guess commits parts inside the pipeline so yeah future step",
    "start": "1620960",
    "end": "1626799"
  },
  {
    "text": "but so much to do like observability monitoring we need to prioritize and uh",
    "start": "1626799",
    "end": "1632720"
  },
  {
    "text": "yeah i would say that's it maybe there was a question there yeah nice yeah just wanted to know how long",
    "start": "1632720",
    "end": "1639600"
  },
  {
    "text": "does it take on average to provision a new environment and have you taken any shortcuts to bring that time down",
    "start": "1639600",
    "end": "1645520"
  },
  {
    "text": "uh so what's the longest part is the docker build image because especially with larval we it's kind of heavy and",
    "start": "1645520",
    "end": "1652559"
  },
  {
    "text": "you need to build engine x php fm we use mix so you need to pull a part of the image in the back end it's a bit of a",
    "start": "1652559",
    "end": "1658880"
  },
  {
    "text": "mess but to deploy the environment is super fast because we use some",
    "start": "1658880",
    "end": "1664240"
  },
  {
    "text": "let's say subshots like for radius or sql so everything starts quite easily",
    "start": "1664240",
    "end": "1670480"
  },
  {
    "text": "it's not resource intensive because it's just a level app it's not like you start i don't know a huge parameters cluster",
    "start": "1670480",
    "end": "1675760"
  },
  {
    "text": "or whatever so it's super fast i wouldn't say in minutes but for the build time it's roughly five",
    "start": "1675760",
    "end": "1681600"
  },
  {
    "text": "minutes and then to commit bitbucket is a bit slow i would say no offense if there are big buckets uh people here but",
    "start": "1681600",
    "end": "1689200"
  },
  {
    "text": "i don't know it's a bit slow to like get the cash instead of everything but once it's committed to argo you have the web",
    "start": "1689200",
    "end": "1694399"
  },
  {
    "text": "book triggering and then it's instantly you see the the synchronization starting refresh and it's super nice to see to",
    "start": "1694399",
    "end": "1701120"
  },
  {
    "text": "see like how fast it is once it's in the repo awesome any other questions",
    "start": "1701120",
    "end": "1709120"
  },
  {
    "text": "all right hang on okay thanks very much oh there is one",
    "start": "1709600",
    "end": "1715760"
  },
  {
    "text": "more you have one question uh so we also have a similar setup",
    "start": "1715760",
    "end": "1720960"
  },
  {
    "text": "using flux actually in that case and the biggest challenge currently we have is uh executing end-to-end tests for",
    "start": "1720960",
    "end": "1727760"
  },
  {
    "text": "applications okay how do you deal with that so with n-testing we use cypress",
    "start": "1727760",
    "end": "1733600"
  },
  {
    "text": "and cypress use just the same like the same test as we have on staging",
    "start": "1733600",
    "end": "1738880"
  },
  {
    "text": "so we just run on the url we have and then uranus i press maybe okay so we're just doing end testing",
    "start": "1738880",
    "end": "1744960"
  },
  {
    "text": "easily and if you want to test on the docker image you would just add docker build look or push and in between you",
    "start": "1744960",
    "end": "1751200"
  },
  {
    "text": "just build it with a with the test tools and run the test so if it breaks it even breaks before",
    "start": "1751200",
    "end": "1756559"
  },
  {
    "text": "deploying to the the previous environment so they just you have an alert like how the pipeline broke um",
    "start": "1756559",
    "end": "1764919"
  },
  {
    "text": "previously and right now we have disconnect having everything deployed",
    "start": "1775600",
    "end": "1780720"
  },
  {
    "text": "in the cluster and don't know when to trigger those enter and test their",
    "start": "1780720",
    "end": "1786960"
  },
  {
    "text": "previous pipelines i mean i guess you have several ways to trigger it maybe you can run like your",
    "start": "1786960",
    "end": "1792960"
  },
  {
    "text": "end-to-end testing as like a post-install job a helm job that will run some smoke testing and other test",
    "start": "1792960",
    "end": "1799200"
  },
  {
    "text": "conformance tests you want to have on your cluster and you have so many options you can run them in the pipeline maybe after it got deployed then you",
    "start": "1799200",
    "end": "1806640"
  },
  {
    "text": "wait until the state is reconciliate and you deploy your test or the way i will you use it is with the helm i mean argo",
    "start": "1806640",
    "end": "1813360"
  },
  {
    "text": "cd hooks and then you wait everything to be deployed and you start your testing",
    "start": "1813360",
    "end": "1820200"
  },
  {
    "text": "i don't know [Laughter] maybe one reason to use argo for previews yeah i don't know you have",
    "start": "1822559",
    "end": "1828399"
  },
  {
    "text": "great tools and just use what yeah works the best i would say",
    "start": "1828399",
    "end": "1833840"
  },
  {
    "text": "thank you thank you francois",
    "start": "1833840",
    "end": "1837799"
  }
]