[
  {
    "text": "i'm mike and this is mo so um i will be doing uh this is technically",
    "start": "240",
    "end": "7359"
  },
  {
    "text": "the sig of deep dive so i'll be covering um a little bit of cigar stuff i'm gonna",
    "start": "7359",
    "end": "12400"
  },
  {
    "text": "give you guys a highlight reel of what we've been working on over the past year or so because i know it's been a while since we talked and then",
    "start": "12400",
    "end": "19279"
  },
  {
    "text": "i'll hand it off to mo who will begin the deep dive into pod security",
    "start": "19279",
    "end": "26640"
  },
  {
    "text": "so let's get started so um sigoth what do we do what are we responsible for um sig auth is primarily",
    "start": "26640",
    "end": "34320"
  },
  {
    "text": "responsible for authentication authorizations the kubernetes api and various other",
    "start": "34320",
    "end": "42480"
  },
  {
    "text": "security controls um such as uh admission and uh authorization policy",
    "start": "42480",
    "end": "48399"
  },
  {
    "text": "like rbac and extensions therein so um one of the admissions that we're",
    "start": "48399",
    "end": "54559"
  },
  {
    "text": "gonna be talking about today is uh pod security admission",
    "start": "54559",
    "end": "59840"
  },
  {
    "text": "so what have we been doing for the past year or so there's actually been a lot",
    "start": "60079",
    "end": "66080"
  },
  {
    "text": "going on so maybe actually",
    "start": "66080",
    "end": "71760"
  },
  {
    "text": "probably over a year ago we began discussing the defecation of uh",
    "start": "71760",
    "end": "77200"
  },
  {
    "text": "pod security policy um and uh discussing what it would mean to",
    "start": "77200",
    "end": "83680"
  },
  {
    "text": "be a successor of pod security policy and we knew that pod security policy had",
    "start": "83680",
    "end": "89040"
  },
  {
    "text": "a lot of users in open source like we debated whether we could defer",
    "start": "89040",
    "end": "94960"
  },
  {
    "text": "those users to look at out of tree um strategies for for doing the same",
    "start": "94960",
    "end": "101439"
  },
  {
    "text": "thing like opa ultimately we kind of landed on pod security",
    "start": "101439",
    "end": "106640"
  },
  {
    "text": "which we will discuss in great depth that is going to be beta in the upcoming release",
    "start": "106640",
    "end": "112320"
  },
  {
    "text": "of kubernetes we're targeting beta 123 targeting beta and 123.",
    "start": "112320",
    "end": "119119"
  },
  {
    "text": "um the certificates api which had uh was long overdue for ga",
    "start": "119119",
    "end": "125280"
  },
  {
    "text": "finally launched ga in 119.",
    "start": "125280",
    "end": "130319"
  },
  {
    "text": "um i think it had been around in beta since like 1-6",
    "start": "130319",
    "end": "136560"
  },
  {
    "text": "so it's like maybe three years overdue for going ga um",
    "start": "136560",
    "end": "142879"
  },
  {
    "text": "before the ga some some notable changes were uh added such as a new signer name",
    "start": "142879",
    "end": "148000"
  },
  {
    "text": "api so now the api can be divided between uh multiple consumers um after",
    "start": "148000",
    "end": "153360"
  },
  {
    "text": "ga a duration hint was added so now you can sign certificates or you can request uh",
    "start": "153360",
    "end": "159599"
  },
  {
    "text": "certificates for specific durations um the exec auth cube control plugin and",
    "start": "159599",
    "end": "165599"
  },
  {
    "text": "extension uh also went ga in 122 i think",
    "start": "165599",
    "end": "171360"
  },
  {
    "text": "um which uh it was either 121 or 122. i can't",
    "start": "171360",
    "end": "176400"
  },
  {
    "text": "actually remember it no i think it's 120 um and that paves the way for moving some of the final entry",
    "start": "176400",
    "end": "183360"
  },
  {
    "text": "uh authentication plugins for clouds out of tree so that's kind of part of the whole club provider extraction",
    "start": "183360",
    "end": "190560"
  },
  {
    "text": "effort and we also have a proposal to extend support for those plugins to um",
    "start": "190560",
    "end": "200000"
  },
  {
    "text": "to request signing and like mutual tls protocols",
    "start": "200000",
    "end": "205760"
  },
  {
    "text": "and the token request api bound service account token volume and",
    "start": "206159",
    "end": "212799"
  },
  {
    "text": "um uh provisioning uh for bound service cat tokens to replace like",
    "start": "212799",
    "end": "218239"
  },
  {
    "text": "the the legacy secret tokens all went ga um",
    "start": "218239",
    "end": "224239"
  },
  {
    "text": "the and i think the final ga was in 123 um",
    "start": "224239",
    "end": "229360"
  },
  {
    "text": "so that's a i think a huge accomplishment i think we've been working on that for a couple of years and",
    "start": "229360",
    "end": "234879"
  },
  {
    "text": "um there uh it should benefit the entire ecosystem because",
    "start": "234879",
    "end": "240159"
  },
  {
    "text": "those have significantly better security properties than legacy tokens there's some more work to do there",
    "start": "240159",
    "end": "247599"
  },
  {
    "text": "and finally the last highlight is we have",
    "start": "247599",
    "end": "252840"
  },
  {
    "text": "a sig sub project in uh",
    "start": "252840",
    "end": "257919"
  },
  {
    "text": "called this secret csi driver they're actually implementations of",
    "start": "257919",
    "end": "263680"
  },
  {
    "text": "um so csi is the canadian storage interface there are implementations of the secret",
    "start": "263680",
    "end": "268960"
  },
  {
    "text": "csi driver with back-ends for aws azure gcp and vault",
    "start": "268960",
    "end": "276639"
  },
  {
    "text": "and that allows configuring volumes that project",
    "start": "276639",
    "end": "283520"
  },
  {
    "text": "secrets in external uh um secret storage",
    "start": "283520",
    "end": "289040"
  },
  {
    "text": "providers so um i think the kep for gaining that",
    "start": "289040",
    "end": "294720"
  },
  {
    "text": "just uh merged maybe this last week",
    "start": "294720",
    "end": "300880"
  },
  {
    "text": "yeah so we've been super busy and with that i will hand it off to mo",
    "start": "301199",
    "end": "307840"
  },
  {
    "text": "cool i'll make some quick comments on this stuff so uh on the token request stuff",
    "start": "307840",
    "end": "313919"
  },
  {
    "text": "uh some of the stuff that's left is to stop generating the secrets the back",
    "start": "313919",
    "end": "319280"
  },
  {
    "text": "service accounts and really backpedal that functionality completely out of the api server or the",
    "start": "319280",
    "end": "326000"
  },
  {
    "text": "controller manager so there's caps open for that you know there's plenty of work there to be done",
    "start": "326000",
    "end": "331759"
  },
  {
    "text": "if anyone wants to get involved you know we're a very cautious bunch of folks we don't",
    "start": "331759",
    "end": "338960"
  },
  {
    "text": "want to break everyone's stuff like we understand that you know people run real stuff on kubernetes now so we're trying",
    "start": "338960",
    "end": "344560"
  },
  {
    "text": "very hard not to break things but we also need to move the ecosystem forward so there's a",
    "start": "344560",
    "end": "349680"
  },
  {
    "text": "balance there and like rita and anish have been working on secret csi driver for quite",
    "start": "349680",
    "end": "354960"
  },
  {
    "text": "some time so that is also a place one could get involved to try to push things forward",
    "start": "354960",
    "end": "362720"
  },
  {
    "text": "so the rest of the talk is mostly a code walkthrough so",
    "start": "362720",
    "end": "369199"
  },
  {
    "text": "tabitha and tim had a talk earlier today at 2 30 that talks about the new",
    "start": "369199",
    "end": "374800"
  },
  {
    "text": "p the new pod security stuff from the perspective of like an end user this one is more focused as the",
    "start": "374800",
    "end": "381199"
  },
  {
    "text": "perspective as a like a perspective contributor right like if you care about how the code is implemented and you know",
    "start": "381199",
    "end": "387360"
  },
  {
    "text": "maybe you want to get involved and help us get it from beta to ga and so forth",
    "start": "387360",
    "end": "392720"
  },
  {
    "text": "so everything in the code walkthrough is based on 123",
    "start": "393039",
    "end": "398479"
  },
  {
    "text": "alpha 3. so if you see something that's not what's in head of master right now",
    "start": "398479",
    "end": "404479"
  },
  {
    "text": "that's just that's probably why but in particular uh jordan and tim really set an",
    "start": "404479",
    "end": "410479"
  },
  {
    "text": "incredibly high bar for the code which is unlike basically anything that exists",
    "start": "410479",
    "end": "415919"
  },
  {
    "text": "within tree that you know this thing has to run you know be able to run standalone without",
    "start": "415919",
    "end": "421919"
  },
  {
    "text": "like an api server can be run as a web hook maybe used in ci tooling",
    "start": "421919",
    "end": "429199"
  },
  {
    "text": "also all the the checks like you know is this a para is this a privileged pod or whatever all",
    "start": "429199",
    "end": "434479"
  },
  {
    "text": "of those are implemented as individual units so there's not like some large",
    "start": "434479",
    "end": "439919"
  },
  {
    "text": "spaghetti thing that checks all the things and the idea there is over time you know",
    "start": "439919",
    "end": "445520"
  },
  {
    "text": "we'll evolve these things and add new checks or iterate on the an existing",
    "start": "445520",
    "end": "450639"
  },
  {
    "text": "check but at a different version so all of that stuff led to a pretty um",
    "start": "450639",
    "end": "457039"
  },
  {
    "text": "pretty elaborate implementation for what sort of just sounds like a pretty simple thing like you know if this field is set on a pod say no you're not allowed to do",
    "start": "457039",
    "end": "463759"
  },
  {
    "text": "that because that's a privilege part or whatever um so as a",
    "start": "463759",
    "end": "469440"
  },
  {
    "text": "most of this slide is j or sorry most of this talk is just me going through the code editor but i did have two slides",
    "start": "469440",
    "end": "475840"
  },
  {
    "text": "so as an example this is from one of jordan's examples on this stuff",
    "start": "475840",
    "end": "481039"
  },
  {
    "text": "if you wanted to run a little cli that would for example do some linter",
    "start": "481039",
    "end": "488479"
  },
  {
    "text": "checks on some pod specs that were going to be committed into your like your prod clusters coming up right you're going to",
    "start": "488479",
    "end": "493599"
  },
  {
    "text": "do some promotion but you wanted to validate that they met some security requirements right and you just want to",
    "start": "493599",
    "end": "498720"
  },
  {
    "text": "gate this all right so this is basically the skeleton of a tool",
    "start": "498720",
    "end": "504400"
  },
  {
    "text": "that can run just completely without an api server just and statically validate things",
    "start": "504400",
    "end": "509840"
  },
  {
    "text": "right so the pod security stuff unlike psp is much more constrained right you",
    "start": "509840",
    "end": "515680"
  },
  {
    "text": "basically say what level of the api you want and what version all right so like baseline or",
    "start": "515680",
    "end": "521599"
  },
  {
    "text": "restricted so restricted is best right if you if your pod can work under that that's what you want and",
    "start": "521599",
    "end": "527360"
  },
  {
    "text": "you know maybe uh maybe you're on like version 1.19 right now and you're like all right i want to make sure that this",
    "start": "527360",
    "end": "533600"
  },
  {
    "text": "stuff is going to run on 120. so i'm going to go ahead and try to validate against 120 and see like if i need to go",
    "start": "533600",
    "end": "539200"
  },
  {
    "text": "talk to my developers and like figure out some stuff before we actually move stuff forward so like",
    "start": "539200",
    "end": "545279"
  },
  {
    "text": "you know we pass those things in we'll go over like what the evaluator and the checks are like but basically if",
    "start": "545279",
    "end": "551440"
  },
  {
    "text": "you're if you're familiar with the kubernetes code base you're probably familiar with the builder pattern that we have",
    "start": "551440",
    "end": "556880"
  },
  {
    "text": "and so all this is doing is like you know passing in some files locally and then it's just doing the visitor",
    "start": "556880",
    "end": "562320"
  },
  {
    "text": "pattern on all those files and so the actual visitor is basically like all right i was given something",
    "start": "562320",
    "end": "568399"
  },
  {
    "text": "with a pod spec deployment whatever i'm going to extract that spec out and",
    "start": "568399",
    "end": "574000"
  },
  {
    "text": "then i'm just going to evaluate it against the level and the version whatever you pass me",
    "start": "574000",
    "end": "579600"
  },
  {
    "text": "and just check if it's allowed or not right so in roughly like 100 lines of code you",
    "start": "579600",
    "end": "585519"
  },
  {
    "text": "have like effectively like a production ready ci tool",
    "start": "585519",
    "end": "591040"
  },
  {
    "text": "and that's kind of the hope from this is that [Music] we want to enable people to build",
    "start": "591040",
    "end": "597040"
  },
  {
    "text": "tooling off of this and you know offer value just outside of just pure kubernetes admission",
    "start": "597040",
    "end": "605120"
  },
  {
    "text": "so the the notes um that i have kind of basically i went through the code and tried to write",
    "start": "605120",
    "end": "611440"
  },
  {
    "text": "notes on like interesting aspects that might not be completely obvious so all the notes are on that",
    "start": "611440",
    "end": "617920"
  },
  {
    "text": "fork of mine so now i'm just going to kind of walk through some stuff and",
    "start": "617920",
    "end": "623360"
  },
  {
    "text": "hopefully it'll be helpful for",
    "start": "623360",
    "end": "626480"
  },
  {
    "text": "folks you all read that okay we tried to make the text nice and big early on",
    "start": "630839",
    "end": "636320"
  },
  {
    "text": "uh so if you're familiar with kubernetes admission all of the all of the stuff",
    "start": "636320",
    "end": "642800"
  },
  {
    "text": "gets wired up in this api server package uh so admission is uh ordered in the sense",
    "start": "642800",
    "end": "650959"
  },
  {
    "text": "that it's a deny based system right so with a deny based system the ordering of",
    "start": "650959",
    "end": "656880"
  },
  {
    "text": "checks matters a lot because if you have an early check that denies it guarantees that the rest of the stack was wouldn't",
    "start": "656880",
    "end": "663040"
  },
  {
    "text": "run so one of the things that you know pod security does is to make sure it runs before pod security policy because you",
    "start": "663040",
    "end": "670160"
  },
  {
    "text": "can run pod security in audit and warning mode so it won't deny stuff",
    "start": "670160",
    "end": "675279"
  },
  {
    "text": "but you know what you could do with that is you know you could have your existing pod security policies the old style",
    "start": "675279",
    "end": "682320"
  },
  {
    "text": "go ahead and put the new pod security stuff in an audit mode but in a very restricted mode",
    "start": "682320",
    "end": "687680"
  },
  {
    "text": "and just let it run and generate events as things are going on right and like you the kubernetes administrator can go",
    "start": "687680",
    "end": "693040"
  },
  {
    "text": "check the audit log saying oh i see that mo is running this privileged pod that",
    "start": "693040",
    "end": "699279"
  },
  {
    "text": "doesn't meet the requirements now i can go talk to mo go ahead and start getting this stuff rectified",
    "start": "699279",
    "end": "704320"
  },
  {
    "text": "but that's only possible you know if you run pod security in front of pot security policy and i realize this is",
    "start": "704320",
    "end": "710639"
  },
  {
    "text": "obnoxious naming right because pot security admission or pot security policy like it's very hard to understand",
    "start": "710639",
    "end": "716240"
  },
  {
    "text": "sometimes what you're talking about also don't be confused by this this this",
    "start": "716240",
    "end": "723519"
  },
  {
    "text": "piece of code makes it sound like pot security is enabled by default it's not it's",
    "start": "723519",
    "end": "728720"
  },
  {
    "text": "feature gated so the code is there but feature gated off",
    "start": "728720",
    "end": "733839"
  },
  {
    "text": "so don't don't this this whole function is kind of a pain to read because it's like what's off but",
    "start": "733839",
    "end": "739920"
  },
  {
    "text": "it's on and then the intersection so it's a little painful uh oh man it did it did not globally",
    "start": "739920",
    "end": "747760"
  },
  {
    "text": "change the text size i'm sorry let's make it bigger",
    "start": "747760",
    "end": "754560"
  },
  {
    "text": "um so i'm gonna try i'm trying to assume that folks don't know how the internals",
    "start": "754560",
    "end": "760079"
  },
  {
    "text": "of cube work to some degree so one of the sort of weird things within the kubernetes",
    "start": "760079",
    "end": "765680"
  },
  {
    "text": "codebase is we have this concept of like an internal type or a hub type uh so whenever we read your",
    "start": "765680",
    "end": "773360"
  },
  {
    "text": "configurations or your objects you know we read them as like pod v1 or whatever there's an internal representation",
    "start": "773360",
    "end": "779920"
  },
  {
    "text": "that's completely like related but it's meant to represent the schema across all versions",
    "start": "779920",
    "end": "787680"
  },
  {
    "text": "um so obviously today pod security doesn't necessarily have that but you'll you'll kind of notice",
    "start": "787680",
    "end": "793920"
  },
  {
    "text": "some of this stuff so like you know like in this where it's doing the loading",
    "start": "793920",
    "end": "799680"
  },
  {
    "text": "if you don't provide it anything right it's going to be like all right i'm going to get the alpha configuration i'm going to",
    "start": "799680",
    "end": "806240"
  },
  {
    "text": "then default it we'll look at what the defaults look like then i'm going to convert it into the internal version",
    "start": "806240",
    "end": "813279"
  },
  {
    "text": "don't get too stressed about this but this is like all over our code basis happens all the time",
    "start": "813279",
    "end": "818320"
  },
  {
    "text": "but the defaults for pod security policy are are kind of what you would expect which is if you don't tell us we just",
    "start": "818320",
    "end": "824160"
  },
  {
    "text": "assume you mean privileged and if you don't tell us a version we just assume latest which by the way privilege means",
    "start": "824160",
    "end": "830240"
  },
  {
    "text": "don't do anything so in order to not break all your stuff we do nothing by default you have to tell",
    "start": "830240",
    "end": "836560"
  },
  {
    "text": "us to do something you know it is what it is when you add something new that can break stuff you",
    "start": "836560",
    "end": "842480"
  },
  {
    "text": "can't just turn it on you'll break people's stuff so looking at the actual configuration",
    "start": "842480",
    "end": "847839"
  },
  {
    "text": "uh it's pretty straightforward right it's um you know like what version do you want to enforce that what version do you want",
    "start": "847839",
    "end": "853680"
  },
  {
    "text": "to audit at so oh i'm sorry i yeah",
    "start": "853680",
    "end": "859440"
  },
  {
    "text": "i will i will try to remember the sort of interesting bit here is",
    "start": "859440",
    "end": "865120"
  },
  {
    "text": "there is a hard-coded list of exemptions so you can imagine that you have a pod runtime class that is",
    "start": "865120",
    "end": "872240"
  },
  {
    "text": "i don't know running vms under the hood and you're like i don't need pot security like i just have strict isolation",
    "start": "872240",
    "end": "878160"
  },
  {
    "text": "so you could you could tell us in this bit that like yeah if a pod asks for this i don't know windows runtime class",
    "start": "878160",
    "end": "883920"
  },
  {
    "text": "or something just ignore it completely like i have guaranteed out of band that this",
    "start": "883920",
    "end": "889040"
  },
  {
    "text": "is safe you could similarly have some user that's always allowed to",
    "start": "889040",
    "end": "894160"
  },
  {
    "text": "run privilege pods or whatever and you know then you're saying i'm taking ownership of somehow",
    "start": "894160",
    "end": "900560"
  },
  {
    "text": "gaining access to these pods right because if you can let like as a for example if you let arbitrary people execute to a running privileged pod well",
    "start": "900560",
    "end": "908000"
  },
  {
    "text": "you have broken all security for your cluster um let's let's walk through uh so if we go",
    "start": "908000",
    "end": "915120"
  },
  {
    "text": "back to the actual code um i always like to jump through",
    "start": "915120",
    "end": "920240"
  },
  {
    "text": "the name of the plugin to actually get to where it's wired in",
    "start": "920240",
    "end": "925279"
  },
  {
    "text": "so it's pretty straightforward it's like a [Music] it runs on create an update of",
    "start": "925279",
    "end": "932880"
  },
  {
    "text": "a set of resources primarily let me find it so it runs against",
    "start": "932880",
    "end": "938399"
  },
  {
    "text": "basically spaces and pods and anything that has a pot spec but for the most part the enforcing side",
    "start": "938399",
    "end": "945759"
  },
  {
    "text": "is on pods right so the idea would be is that you don't want to break like a deployment",
    "start": "945759",
    "end": "951839"
  },
  {
    "text": "controller with this you just want to prevent the pots from being run so because you can imagine you could have a",
    "start": "951839",
    "end": "957360"
  },
  {
    "text": "mutating web hook that will coerce the pod into a correct shape when it's created",
    "start": "957360",
    "end": "962880"
  },
  {
    "text": "even if the deployment has something slightly different in it so for the most part it doesn't enforce",
    "start": "962880",
    "end": "968399"
  },
  {
    "text": "on the embedded stuff uh so we can we can kind of look at",
    "start": "968399",
    "end": "973839"
  },
  {
    "text": "how some of this code works real quick let's see like the validation logic is",
    "start": "973839",
    "end": "981199"
  },
  {
    "text": "so as i just mentioned like so there's distinct logic for how name spaces are valid pods are validated or pod",
    "start": "981199",
    "end": "987199"
  },
  {
    "text": "controller pod controller being like controllers that cause the generation of pods because they have an embedded pot",
    "start": "987199",
    "end": "994000"
  },
  {
    "text": "spec somewhere within the schema like a deployment um",
    "start": "994000",
    "end": "999120"
  },
  {
    "text": "so the most interesting one is like pod because that's the one that actually like",
    "start": "999120",
    "end": "1005279"
  },
  {
    "text": "does the real work right so it's like all right ignore sub-resources that don't matter and so forth",
    "start": "1005279",
    "end": "1010810"
  },
  {
    "text": "[Music] the reason for doing that is to hoist",
    "start": "1010810",
    "end": "1016000"
  },
  {
    "text": "errors that you get as early as possible because it's terrible to create a deployment and have",
    "start": "1016000",
    "end": "1022959"
  },
  {
    "text": "that fail three steps later asynchronously yeah",
    "start": "1022959",
    "end": "1028400"
  },
  {
    "text": "yeah um but you can see like you know a pod evaluation you know is strictly in force um and which makes sense right",
    "start": "1028400",
    "end": "1035199"
  },
  {
    "text": "like at the end of the day the pod is what we have to prevent from running right like everything else is a byproduct of all that",
    "start": "1035199",
    "end": "1042558"
  },
  {
    "text": "let's see let's see i think some of the more interesting stuff is the whole uh registry so",
    "start": "1042559",
    "end": "1051440"
  },
  {
    "text": "with the old pot security stuff right you had this really expressive api",
    "start": "1051440",
    "end": "1057120"
  },
  {
    "text": "and you would make individual pot security objects and you would try to say like here's my policies",
    "start": "1057120",
    "end": "1063280"
  },
  {
    "text": "that level of expression is purposely omitted from this api",
    "start": "1063280",
    "end": "1068480"
  },
  {
    "text": "because the other api is unmaintainable effectively so what we have is basically this little",
    "start": "1068480",
    "end": "1074640"
  },
  {
    "text": "evaluator thing which takes a series of checks and so the idea is that this evaluator you know is given the input it",
    "start": "1074640",
    "end": "1081760"
  },
  {
    "text": "runs all the checks and says is everything okay some of this code is like a little bit hard to read because it's trying to do",
    "start": "1081760",
    "end": "1088160"
  },
  {
    "text": "like well you have a check at like version 1.12 but this is version 1.20",
    "start": "1088160",
    "end": "1095520"
  },
  {
    "text": "oh that's the like the newest check that's available so it must also be the 120",
    "start": "1095520",
    "end": "1101120"
  },
  {
    "text": "check it's kind of it's it's a little hard to read at times but for the most part you don't have to worry too much about it",
    "start": "1101120",
    "end": "1107360"
  },
  {
    "text": "jordan and tim got it right so you don't have to worry too much the more interesting stuff is like the",
    "start": "1107360",
    "end": "1113919"
  },
  {
    "text": "actual checks themselves so there's like this global registry of checks and you can add to them",
    "start": "1113919",
    "end": "1121960"
  },
  {
    "text": "oh i'm sorry ah lord i can read it so i assume you can read it i apologize",
    "start": "1122240",
    "end": "1128400"
  },
  {
    "text": "yeah it does it does work on my machine um so you know what does a check happen it's basically",
    "start": "1128400",
    "end": "1134880"
  },
  {
    "text": "like a unique id what level does it run on like baseline and restricted and then",
    "start": "1134880",
    "end": "1140559"
  },
  {
    "text": "the specific checks over time right so you could have a check the same check",
    "start": "1140559",
    "end": "1147039"
  },
  {
    "text": "change its meaning over time this is one of the core requirements of the pod security stuff which was",
    "start": "1147039",
    "end": "1152799"
  },
  {
    "text": "we can't just say like a check today is this valid over time because the pod spec changes right so if you have if you",
    "start": "1152799",
    "end": "1160080"
  },
  {
    "text": "add a new field somewhere within the prospect that's privileged like equivalent of privilege the existing",
    "start": "1160080",
    "end": "1167280"
  },
  {
    "text": "privilege check needs to start accounting for that but only at a newer version right we don't break you in",
    "start": "1167280",
    "end": "1172960"
  },
  {
    "text": "place right no kubernetes apis are allowed to arbitrarily break in the middle",
    "start": "1172960",
    "end": "1178360"
  },
  {
    "text": "[Music] so to show you what that looks like uh the privilege tech is sort of the",
    "start": "1178360",
    "end": "1183520"
  },
  {
    "text": "most canonical check right which is like don't let these fields be true",
    "start": "1183520",
    "end": "1188799"
  },
  {
    "text": "like false is good or undefined is good but true is bad all right and we can see that this check",
    "start": "1188799",
    "end": "1195440"
  },
  {
    "text": "has existed since the beginning of time effectively because these fields have existed since the beginning of time so",
    "start": "1195440",
    "end": "1201360"
  },
  {
    "text": "it's you know it's a very early check and you can kind of see that it's like all right look at all the containers and",
    "start": "1201360",
    "end": "1207520"
  },
  {
    "text": "by that i mean like all of them like the init containers the actual containers the ephemeral containers and maybe one day there'll be more containers and",
    "start": "1207520",
    "end": "1213520"
  },
  {
    "text": "they'll also be in here look at all of them and make sure that nobody sets privileged equals true in",
    "start": "1213520",
    "end": "1219679"
  },
  {
    "text": "there right and if they do then fail with a nice error message all right so that one's pretty easy",
    "start": "1219679",
    "end": "1226320"
  },
  {
    "text": "and you know it's a pretty easy check the run is non-root check it's kind of long and kind of sprawling",
    "start": "1226320",
    "end": "1233360"
  },
  {
    "text": "almost because it's got like like levels of checks in it so it kind of just keeps going for a bit",
    "start": "1233360",
    "end": "1240080"
  },
  {
    "text": "but the nice thing is all of these things are completely distinct right so if the pod security standards change and",
    "start": "1240080",
    "end": "1245840"
  },
  {
    "text": "we add a new check none of the existing stuff has to change we just add a new check to the rest of thing",
    "start": "1245840",
    "end": "1252320"
  },
  {
    "text": "and to make it so that",
    "start": "1252320",
    "end": "1258080"
  },
  {
    "text": "you know you could imagine a more expressive version of pod security that is completely implemented out of tree as",
    "start": "1258080",
    "end": "1263679"
  },
  {
    "text": "a validating admission web hook and let's say that someone wants to",
    "start": "1263679",
    "end": "1268960"
  },
  {
    "text": "not run this stuff at all they just want to run their whole thing it would be really nice for them to be able to validate that stuff that they",
    "start": "1268960",
    "end": "1275360"
  },
  {
    "text": "have built conforms the same validation checks as",
    "start": "1275360",
    "end": "1281120"
  },
  {
    "text": "the internal treatment stuff and so one of the ways we do that is for each of the checks we have a test",
    "start": "1281120",
    "end": "1288080"
  },
  {
    "text": "that generates a series of passing pods and generates a series of failing pods",
    "start": "1288080",
    "end": "1294080"
  },
  {
    "text": "right so those checks are obviously run uh sort of in line in our unit tests and stuff but they also generate so if we",
    "start": "1294080",
    "end": "1301679"
  },
  {
    "text": "look at this failure case and the zeroth index they also generate yaml",
    "start": "1301679",
    "end": "1308000"
  },
  {
    "text": "matching that so all of this yaml is available you know in a very structured",
    "start": "1308000",
    "end": "1313039"
  },
  {
    "text": "way right like this is a baseline check at version 12 122 and it's a failing check for the privileged",
    "start": "1313039",
    "end": "1319600"
  },
  {
    "text": "check right so if you were implementing equivalent code out of tree",
    "start": "1319600",
    "end": "1324880"
  },
  {
    "text": "you could run all of this yaml against your outer tree implementation and validate that it conforms exactly to the",
    "start": "1324880",
    "end": "1332000"
  },
  {
    "text": "entry one right obviously you know this is not a strict",
    "start": "1332000",
    "end": "1337840"
  },
  {
    "text": "requirement for having pod security be a thing it's just that you know jordan and tim were very",
    "start": "1337840",
    "end": "1343840"
  },
  {
    "text": "careful to make it so that the ecosystem could build and mature on top of this stuff so",
    "start": "1343840",
    "end": "1349200"
  },
  {
    "text": "it adds pretty significant complexity to our to the work we had to do to make all this work",
    "start": "1349200",
    "end": "1356559"
  },
  {
    "text": "so i'm done with the code does anyone want to ask me something before i go back to the slides",
    "start": "1356559",
    "end": "1362880"
  },
  {
    "text": "uh i did have a question here from online and uh this is uh this few sentences so i promise i'm getting there",
    "start": "1363520",
    "end": "1369520"
  },
  {
    "text": "a little bit longer though what is the recommendation for organizations that plan to use something like gatekeeper or caverno to provide",
    "start": "1369520",
    "end": "1376960"
  },
  {
    "text": "pod security pieces should the built-in pod security admission controller be disabled or is",
    "start": "1376960",
    "end": "1382559"
  },
  {
    "text": "the recommendation to have them co-exist with the built-in controller providing some basic level of protection and made",
    "start": "1382559",
    "end": "1388559"
  },
  {
    "text": "more fine-grained by a third-party admission controller [Music] um so",
    "start": "1388559",
    "end": "1393950"
  },
  {
    "text": "[Music] mike you might have a different opinion on me just because i feel like this is an opinion and less of a like a like a",
    "start": "1393950",
    "end": "1400080"
  },
  {
    "text": "thing that has a concrete answer i would personally lean towards always running",
    "start": "1400080",
    "end": "1407039"
  },
  {
    "text": "like the the built-in stuff you know in whatever mode is you know obviously if you can run",
    "start": "1407039",
    "end": "1412400"
  },
  {
    "text": "everything in restricted latest do that that might be impractical but",
    "start": "1412400",
    "end": "1418080"
  },
  {
    "text": "and then if you have further checks add those checks as you're validating",
    "start": "1418080",
    "end": "1423520"
  },
  {
    "text": "web hook or whatever you want opa or caverno whatever your favorite check is",
    "start": "1423520",
    "end": "1428640"
  },
  {
    "text": "because as you upgrade your kubernetes cluster this stuff will get upgraded by us",
    "start": "1428640",
    "end": "1435520"
  },
  {
    "text": "this stuff is tested by sega this stuff is maintained by segat right and we care deeply about this",
    "start": "1435520",
    "end": "1441919"
  },
  {
    "text": "implementation and we validate this one so i i would i would sort of that's the direction i would push people",
    "start": "1441919",
    "end": "1449120"
  },
  {
    "text": "um but it's more of an opinion it's not a straight guideline i like the job yeah i agree",
    "start": "1449120",
    "end": "1456240"
  },
  {
    "text": "so uh one of the initial problems uh with psp that was cited when we um you know",
    "start": "1456240",
    "end": "1463360"
  },
  {
    "text": "chose not to graduate from g uh to ga was that it was uh users were incapable",
    "start": "1463360",
    "end": "1469520"
  },
  {
    "text": "of turning it on in existing clusters without breaking their users so",
    "start": "1469520",
    "end": "1476480"
  },
  {
    "text": "what we did with psp v2 or whatever you want to call it",
    "start": "1476480",
    "end": "1482080"
  },
  {
    "text": "was we designed the system such that it can be turned on and the cluster will",
    "start": "1482080",
    "end": "1489919"
  },
  {
    "text": "continue to behave as normal so we would like we included",
    "start": "1489919",
    "end": "1495440"
  },
  {
    "text": "kind of what we saw as the table stakes for constraining pods and",
    "start": "1495440",
    "end": "1501600"
  },
  {
    "text": "you know we totally accept that our definitions aren't going to meet all",
    "start": "1501600",
    "end": "1508240"
  },
  {
    "text": "use cases in the world and i think in those cases it makes sense to run you know opa or kievarno",
    "start": "1508240",
    "end": "1515760"
  },
  {
    "text": "in that case uh like i would say you can use uh pod security mission for as far as it",
    "start": "1515760",
    "end": "1523679"
  },
  {
    "text": "gets you and then use kiverno i use them both at the same time really up to you",
    "start": "1523679",
    "end": "1529360"
  },
  {
    "text": "i would say probably it's not necessary to turn off a pod security mission controller and if you",
    "start": "1529360",
    "end": "1536240"
  },
  {
    "text": "feel like you need to then there's probably a problem with pod security mission controller and uh you",
    "start": "1536240",
    "end": "1541520"
  },
  {
    "text": "should let us know why yeah one of the core requirements of it for it was for it to co-exist with other",
    "start": "1541520",
    "end": "1548159"
  },
  {
    "text": "tools that are doing similar work and psp made that annoyingly hard",
    "start": "1548159",
    "end": "1554080"
  },
  {
    "text": "so we've tried hard on this one not to have that evan so as i understand it right now",
    "start": "1554080",
    "end": "1561120"
  },
  {
    "text": "um if i turn on the alpha flag in 122 all my name spaces by default are",
    "start": "1561120",
    "end": "1568400"
  },
  {
    "text": "privileged or using privileged um are there plans to either ship something",
    "start": "1568400",
    "end": "1573520"
  },
  {
    "text": "so that when i create a namespace i can set it down to a lower level or change the default in future versions of",
    "start": "1573520",
    "end": "1580159"
  },
  {
    "text": "kubernetes to steer users towards a more defended security posture",
    "start": "1580159",
    "end": "1587120"
  },
  {
    "text": "so i had this discussion with jordan and tim and david",
    "start": "1587440",
    "end": "1593120"
  },
  {
    "text": "they they did not believe we could do that while maintaining the compatibility requirements of the kubernetes api which",
    "start": "1593679",
    "end": "1600400"
  },
  {
    "text": "is unfortunate [Music] thing at least",
    "start": "1600400",
    "end": "1605440"
  },
  {
    "text": "like basically what they said is this this really comes down to like a choice for your distribution and what security",
    "start": "1605440",
    "end": "1611200"
  },
  {
    "text": "stance it has as this default posture so you know as a for example i work for vmware in the tonsu portfolio",
    "start": "1611200",
    "end": "1618799"
  },
  {
    "text": "as soon as this thing is beta i'm going to go turn it on and i'm going to hit anyone with a hammer if they try to turn it off",
    "start": "1618799",
    "end": "1625360"
  },
  {
    "text": "but uh you know that's sort of the opinion of the distribution uh",
    "start": "1625360",
    "end": "1632159"
  },
  {
    "text": "at least the nice thing is it's very easy to go change the default you know it's a very simple yaml file that just",
    "start": "1632159",
    "end": "1637600"
  },
  {
    "text": "says if you have no edit if you have no labels that means you're like latest",
    "start": "1637600",
    "end": "1644080"
  },
  {
    "text": "restricted or something right like you can really tighten it out very easily [Music]",
    "start": "1644080",
    "end": "1650559"
  },
  {
    "text": "it is a configuration that you pass to the api server so it's like the rest of admission",
    "start": "1650559",
    "end": "1656720"
  },
  {
    "text": "that's the rest of built-in admission yeah",
    "start": "1656720",
    "end": "1662159"
  },
  {
    "text": "it it's a little unfortunate but it's sort of",
    "start": "1662159",
    "end": "1667200"
  },
  {
    "text": "yeah we just want to break people's stuff and this like you know if we were building kubernetes all over again i'm pretty sure we'd start from the",
    "start": "1667200",
    "end": "1673039"
  },
  {
    "text": "beginning with this but yeah that was one of the core requirements and if like you are on a uh",
    "start": "1673039",
    "end": "1682159"
  },
  {
    "text": "in an environment where you don't have access to that configuration file it is also fairly easy to create an admission controller",
    "start": "1682159",
    "end": "1688159"
  },
  {
    "text": "on namespace create and just set that default so",
    "start": "1688159",
    "end": "1693200"
  },
  {
    "text": "all right we have uh one other question then uh we'll look to the room if anybody else has any questions too",
    "start": "1694960",
    "end": "1700320"
  },
  {
    "text": "this question is with the built-in pod security admission implementation is it possible for admins to add custom",
    "start": "1700320",
    "end": "1706640"
  },
  {
    "text": "profiles or are the built-in privileged baseline and restricted profiles the",
    "start": "1706640",
    "end": "1712000"
  },
  {
    "text": "only that will be available without a third-party admission controller uh yeah so this one i can actually give",
    "start": "1712000",
    "end": "1718320"
  },
  {
    "text": "an answer and yes baseline and restricted and privileges all we plan to ever implement",
    "start": "1718320",
    "end": "1724160"
  },
  {
    "text": "[Music] however the code is modular so you can",
    "start": "1724160",
    "end": "1730000"
  },
  {
    "text": "go ahead um fork it and use the same structure to",
    "start": "1730000",
    "end": "1736080"
  },
  {
    "text": "deploy your own admission controller um with your own profiles um yeah i i don't even think that the 4k",
    "start": "1736080",
    "end": "1742320"
  },
  {
    "text": "really just consume it it is meant to be a library you don't even have to forget um so yeah",
    "start": "1742320",
    "end": "1748399"
  },
  {
    "text": "you could totally do that but basically we're trying very hard one we don't want to become king maker",
    "start": "1748399",
    "end": "1754720"
  },
  {
    "text": "here we're not trying to like rule your policy in all the little ways but just also like",
    "start": "1754720",
    "end": "1759919"
  },
  {
    "text": "this is what prevented psp from going ga is because it was an ever expanding api surface",
    "start": "1759919",
    "end": "1766960"
  },
  {
    "text": "and trying to make it keep up with the growth of the pot spec over time just",
    "start": "1766960",
    "end": "1772320"
  },
  {
    "text": "proved to be untenable like",
    "start": "1772320",
    "end": "1777360"
  },
  {
    "text": "being opinionated and simplistic here is sort of allows us to even have this at all",
    "start": "1777360",
    "end": "1782960"
  },
  {
    "text": "and for the people who are willing to",
    "start": "1782960",
    "end": "1788159"
  },
  {
    "text": "and have the need to go and define their own profiles there are a lot of very good existing solutions that would allow",
    "start": "1788159",
    "end": "1794880"
  },
  {
    "text": "them to do that um such as opa gatekeeper kivarino so",
    "start": "1794880",
    "end": "1800080"
  },
  {
    "text": "that we felt like that was a problem that was already solved yeah yeah at a really simple level we want to",
    "start": "1800080",
    "end": "1806880"
  },
  {
    "text": "make sure that in the future on basically every kubernetes distribution sort of by default",
    "start": "1806880",
    "end": "1813760"
  },
  {
    "text": "um create pod does not mean root on cubelet right like if we can get to that stage",
    "start": "1813760",
    "end": "1819520"
  },
  {
    "text": "like we have made an incredible set of progress into what the default is today in most environments",
    "start": "1819520",
    "end": "1826720"
  },
  {
    "text": "all right come over to you i'm glad to ask for questions yeah i had",
    "start": "1827520",
    "end": "1833520"
  },
  {
    "text": "a couple questions about so when it was reading and trying to decide what to react on was looking for namespaces or things that had pod specs",
    "start": "1833520",
    "end": "1841360"
  },
  {
    "text": "internally so if you say create a deployment that violates some of the rules and it's turned on to reject it like it'll reject",
    "start": "1841360",
    "end": "1848320"
  },
  {
    "text": "the deployment creation or does it still allow the employer deployment to go through it just rejects the pods",
    "start": "1848320",
    "end": "1854399"
  },
  {
    "text": "the way like pod security policy does now so i might be misremembering because what mike said seemed to be misaligned",
    "start": "1854399",
    "end": "1861279"
  },
  {
    "text": "with what i had in my head i thought it was we would reject the pod but not the deployment we would only audit and warn",
    "start": "1861279",
    "end": "1867760"
  },
  {
    "text": "on the deployment but i might be misremembering i think that's right uh so the",
    "start": "1867760",
    "end": "1874180"
  },
  {
    "text": "[Music] like uh how has worn uh how is worm mode",
    "start": "1874180",
    "end": "1880159"
  },
  {
    "text": "triggered so you have an annotation um that sets like whether it's enforced",
    "start": "1880159",
    "end": "1885279"
  },
  {
    "text": "or or worn well if i remember correctly because it's under the pod controller path it's",
    "start": "1885279",
    "end": "1891279"
  },
  {
    "text": "always audit and worn for that piece i think but the idea was that",
    "start": "1891279",
    "end": "1896480"
  },
  {
    "text": "your deployment could be out of the valid spec but you could have a mutating admission controller for pods",
    "start": "1896480",
    "end": "1903519"
  },
  {
    "text": "that coerces the pods into a valid spec so the thing that gets created is allowed so that was sort of the nuance",
    "start": "1903519",
    "end": "1909679"
  },
  {
    "text": "that that it's not great right because that was my follow-up question is like because there are you could mutate your pods in line",
    "start": "1909679",
    "end": "1916399"
  },
  {
    "text": "and they'll they'll they can be yeah eventually good so rejecting the deploy out right would have been a bad idea yeah so that's",
    "start": "1916399",
    "end": "1923120"
  },
  {
    "text": "that's the use case we're trying to maintain is that we know that the pod itself is the thing that gets run everything else is implementation",
    "start": "1923120",
    "end": "1928960"
  },
  {
    "text": "details right uh so that's where we really enforce and the namespace stuff",
    "start": "1928960",
    "end": "1935039"
  },
  {
    "text": "where it's really powerful is you know server-side dry run is you know a really cool feature and what you can",
    "start": "1935039",
    "end": "1942000"
  },
  {
    "text": "do now is you know you could you can do a server-side dry run that says i would",
    "start": "1942000",
    "end": "1947760"
  },
  {
    "text": "like to change the label on all of my namespace says to restricted latest and",
    "start": "1947760",
    "end": "1953919"
  },
  {
    "text": "just tell cubectl to do that and what will happen is you will get back",
    "start": "1953919",
    "end": "1960159"
  },
  {
    "text": "all the warning messages from the api server saying hey here's the like 17 pods across your entire cluster that do",
    "start": "1960159",
    "end": "1966799"
  },
  {
    "text": "not meet this requirement so but you don't have to mutate anything to do that right so now you've gotten immediate",
    "start": "1966799",
    "end": "1973039"
  },
  {
    "text": "feedback on what you need to fix without causing any disruption to your cluster and",
    "start": "1973039",
    "end": "1978799"
  },
  {
    "text": "that's sort of like one of the cool things about this being label based and just the maturity of the ecosystem now that what didn't exist",
    "start": "1978799",
    "end": "1985440"
  },
  {
    "text": "when psp was originally written yeah thank you awesome we've uh time for",
    "start": "1985440",
    "end": "1991279"
  },
  {
    "text": "about one more question if anybody has one",
    "start": "1991279",
    "end": "1995039"
  },
  {
    "text": "let's uh hop to the slides real quick and all right yes",
    "start": "1996320",
    "end": "2002279"
  },
  {
    "text": "um cool so uh",
    "start": "2005679",
    "end": "2011200"
  },
  {
    "text": "let's we can so um we have some uh we're always looking for people to join uh",
    "start": "2011200",
    "end": "2016799"
  },
  {
    "text": "sigoth and get involved in the community so as a couple good links for new contributors to check out these slides",
    "start": "2016799",
    "end": "2023039"
  },
  {
    "text": "will be posted next to our talk in the schedule so come check it out we have some good",
    "start": "2023039",
    "end": "2028640"
  },
  {
    "text": "first issues we have a slack channel and we uh meet every",
    "start": "2028640",
    "end": "2034320"
  },
  {
    "text": "uh two weeks on uh wednesday um at 11",
    "start": "2034320",
    "end": "2039360"
  },
  {
    "text": "a.m pacific standard time i'll have a lot of good conversations a lot of ongoing initiatives discuss there",
    "start": "2039360",
    "end": "2046720"
  },
  {
    "text": "and we welcome any everyone anyone and everyone to get involved so",
    "start": "2046720",
    "end": "2051839"
  },
  {
    "text": "yeah thank you so much for attending today and i hope you had a good keep going",
    "start": "2051839",
    "end": "2057839"
  },
  {
    "text": "as a reminder this stuff the psp stuff is alpha so if there's something wrong",
    "start": "2057839",
    "end": "2062878"
  },
  {
    "text": "please come tell us because we can fix it before we promote it to beta because it gets a whole lot harder because this",
    "start": "2062879",
    "end": "2068720"
  },
  {
    "text": "is kubernetes and we don't try to break people's stuff and everyone likes to depend on every implementation detail of everything we",
    "start": "2068720",
    "end": "2074638"
  },
  {
    "text": "build so but thank you all thanks everyone [Applause]",
    "start": "2074639",
    "end": "2080989"
  }
]