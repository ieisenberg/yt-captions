[
  {
    "text": "so welcome today we're going to talk to you about what we learn whilst migrating",
    "start": "30",
    "end": "7410"
  },
  {
    "text": "our instructor from us start to get resurrected to kubernetes whilst maintaining containers delivery",
    "start": "7410",
    "end": "13940"
  },
  {
    "text": "my name is Adam fair Kallstrom I'm the lead developer of infrastructure apt",
    "start": "13940",
    "end": "19500"
  },
  {
    "text": "fiend oughta know my name is hello my name is Inigo I'm a developer only",
    "start": "19500",
    "end": "25890"
  },
  {
    "text": "infrastructure team and pin so since we're talking about migrating just to",
    "start": "25890",
    "end": "32460"
  },
  {
    "text": "give you some context to start with we're going to first talk about some history of infrastructure at fin and",
    "start": "32460",
    "end": "38969"
  },
  {
    "text": "then we get into how we use kubernetes after that we'll talk about the platform",
    "start": "38969",
    "end": "44640"
  },
  {
    "text": "that they built on top of kubernetes which we've called fin infrastructure as a service we'll talk about what it is",
    "start": "44640",
    "end": "49800"
  },
  {
    "text": "the motivation for building it in the first place how it works then when you get into some",
    "start": "49800",
    "end": "55440"
  },
  {
    "text": "experiences that we've had one migrating applications to this new infrastructure and we will try to make some conclusions",
    "start": "55440",
    "end": "61800"
  },
  {
    "text": "and leave some room for questions in the end so what is fin anyway finish on the",
    "start": "61800",
    "end": "70049"
  },
  {
    "text": "region internet marketplace where you can buy and sell cars real estate bits and pieces and you can get hotels and",
    "start": "70049",
    "end": "77310"
  },
  {
    "text": "everything tickets and find a job it's know as second largest websites in",
    "start": "77310",
    "end": "83880"
  },
  {
    "text": "terms of traffic after VG which is the biggest national newspaper now Norway is",
    "start": "83880",
    "end": "89670"
  },
  {
    "text": "relatively small population wise actually it's around the size of the greater billion metro area Elizabeth on",
    "start": "89670",
    "end": "96420"
  },
  {
    "text": "internet your later life and where you can sell it with a big fish in a fairly",
    "start": "96420",
    "end": "101640"
  },
  {
    "text": "small pond fin is owned by ships at Media Group which is a big company other",
    "start": "101640",
    "end": "108090"
  },
  {
    "text": "poems among other things similar sites to fill in several other countries in the world",
    "start": "108090",
    "end": "116390"
  },
  {
    "text": "so there are some vital numbers that when we are about 120 developers and",
    "start": "116390",
    "end": "123229"
  },
  {
    "text": "these developers manage around 350 micro-services along with a handful",
    "start": "123229",
    "end": "129729"
  },
  {
    "text": "bigger applications and these developers ship to production around 1,000 times a",
    "start": "129729",
    "end": "134830"
  },
  {
    "text": "week on average and the median time from a developer pushing a change to an",
    "start": "134830",
    "end": "140470"
  },
  {
    "text": "application to that change being rolled out into production is is six minutes",
    "start": "140470",
    "end": "145560"
  },
  {
    "text": "and it's very important to us that our developers can deliver value quickly so",
    "start": "145560",
    "end": "151540"
  },
  {
    "text": "we have dashboards and KPI built around these numbers so basically we managed to",
    "start": "151540",
    "end": "160150"
  },
  {
    "text": "get this development speed before we started using kubernetes so I'm just",
    "start": "160150",
    "end": "165190"
  },
  {
    "text": "going to talk a little bit about evolved and what we did before what we did to",
    "start": "165190",
    "end": "171940"
  },
  {
    "text": "achieve this speed and then try to talk about some of the problems we have that and why we had to move this is data from",
    "start": "171940",
    "end": "180100"
  },
  {
    "text": "our development pipeline which is our home build system the journey to continuous delivery of micro services",
    "start": "180100",
    "end": "185530"
  },
  {
    "text": "offense started in 2007 but on the delivery part you could really only start to see signs of that if you do",
    "start": "185530",
    "end": "192269"
  },
  {
    "text": "deployments by week in 2013 when we started to grow and then in the next few",
    "start": "192269",
    "end": "198730"
  },
  {
    "text": "years we had a real big growth so I think we have we now deploy to",
    "start": "198730",
    "end": "204400"
  },
  {
    "text": "production of a thousand apps a week regular around we can go up to 1,200 1,400 and we did this we had a bunch of",
    "start": "204400",
    "end": "216820"
  },
  {
    "text": "steps we went through first fin was a monolithic architecture and we had we basically deployed it manually from",
    "start": "216820",
    "end": "224070"
  },
  {
    "text": "operators and we wanted to we wanted to change that so that the management",
    "start": "224070",
    "end": "229660"
  },
  {
    "text": "haven't gone to a conference on her Mary poppendieck speak and I wanted to achieve some of the development the",
    "start": "229660",
    "end": "235239"
  },
  {
    "text": "speed she talks about so they came back and said instead of releasing every third month we're going to release every",
    "start": "235239",
    "end": "240910"
  },
  {
    "text": "month and then on the technology side people started we started creating",
    "start": "240910",
    "end": "248579"
  },
  {
    "text": "creating some shared with Java libraries to make it easier to create services and we created different servers we had an",
    "start": "248579",
    "end": "255459"
  },
  {
    "text": "API server a module server all our web services and we had some",
    "start": "255459",
    "end": "260970"
  },
  {
    "text": "project control development basically what we did was we restricted the options for the developer so a Java that",
    "start": "260970",
    "end": "267360"
  },
  {
    "text": "fin looked in a specific way and that was the only way to do it which made it easy to create new apps and collect new",
    "start": "267360",
    "end": "273810"
  },
  {
    "text": "services and when we had more services we started to get development speed but",
    "start": "273810",
    "end": "280170"
  },
  {
    "text": "then when we had 150 200 different services running on the same actual bare",
    "start": "280170",
    "end": "286680"
  },
  {
    "text": "metal servers we started getting problems because one application started",
    "start": "286680",
    "end": "292490"
  },
  {
    "text": "creating problems for another application and we learned that for developers if they know the guy who",
    "start": "292490",
    "end": "298800"
  },
  {
    "text": "takes down the wrapping protection it's okay but if the guy sits on a different floor for instance and you don't say",
    "start": "298800",
    "end": "303810"
  },
  {
    "text": "hello to him on a daily basis you get angry and he don't talk to that guy I talked to the introductory department",
    "start": "303810",
    "end": "309150"
  },
  {
    "text": "anyway so we we tried to solve that by using or to start using OpenStack we",
    "start": "309150",
    "end": "317730"
  },
  {
    "text": "equated virtual machines for this separate applications so then instead of",
    "start": "317730",
    "end": "324450"
  },
  {
    "text": "having 200 applications running on one server we had 200-300 virtual machines",
    "start": "324450",
    "end": "329520"
  },
  {
    "text": "running which was not easy to operate we there was a lot of stuff operator that",
    "start": "329520",
    "end": "337229"
  },
  {
    "text": "we needed to know to be able to fix problems in production and we had to know what we are all the different",
    "start": "337229",
    "end": "342770"
  },
  {
    "text": "applications run on which server and he had to know about all the virtual machines he created so even though we",
    "start": "342770",
    "end": "350520"
  },
  {
    "text": "had a lot of speed we saw that the complexity grew and working to operate",
    "start": "350520",
    "end": "356310"
  },
  {
    "text": "this increased but of course we want to be cool developers and read the Internet",
    "start": "356310",
    "end": "362430"
  },
  {
    "text": "and we went on happiness and hopefully respect it was one simple answer of happiness on what to do if you had to",
    "start": "362430",
    "end": "370169"
  },
  {
    "text": "solve something with programming doc and we started using docker really we had",
    "start": "370169",
    "end": "376320"
  },
  {
    "text": "doctor and doctor is great I think for developers it's easy to run something on the same Maranello closed as in",
    "start": "376320",
    "end": "381720"
  },
  {
    "text": "production but as soon as he started getting any kind of traction on running docker in production we saw that it",
    "start": "381720",
    "end": "388620"
  },
  {
    "text": "gives you a new set of problems because when they wind up in production there's so many",
    "start": "388620",
    "end": "394180"
  },
  {
    "text": "the things you need to do to be able to get the actual value out of docker because when there's no longer any",
    "start": "394180",
    "end": "399729"
  },
  {
    "text": "binding between application and the underlying infrastructure you can you can start running the containers for",
    "start": "399729",
    "end": "405100"
  },
  {
    "text": "every Walter and then you need some kind of system that hangs that forward because he can't do that manually and as",
    "start": "405100",
    "end": "411430"
  },
  {
    "text": "soon as the containers start moving around you need to some kind of services cover to figure out where the containers are at all points and of course you",
    "start": "411430",
    "end": "419380"
  },
  {
    "text": "don't want to as someone said earlier you don't want to be waking up but not just because not contain the dye see if",
    "start": "419380",
    "end": "426580"
  },
  {
    "text": "you can just restart it so we need to have some kind of life cycle support and monitoring to help you",
    "start": "426580",
    "end": "433110"
  },
  {
    "text": "and when you get have all these services in order develop all these developers you need you want to you want to control",
    "start": "433110",
    "end": "439810"
  },
  {
    "text": "who has access to what so we've also kind of authorization and authentication mechanism and you want to control that",
    "start": "439810",
    "end": "445949"
  },
  {
    "text": "and lastly we saw that when we started using docker we we crammed local stuff",
    "start": "445949",
    "end": "452020"
  },
  {
    "text": "into our containers we started putting all the information and all the business applications into one container and that",
    "start": "452020",
    "end": "458440"
  },
  {
    "text": "made it really hard to upgrade one thing we had to build a new container so we wanted some way of aggregating our",
    "start": "458440",
    "end": "464770"
  },
  {
    "text": "containers into jobs without building it into one image and of course when we",
    "start": "464770",
    "end": "470979"
  },
  {
    "text": "have when we web shop in Norway we have",
    "start": "470979",
    "end": "475990"
  },
  {
    "text": "quite a quite a small window overall pick traffic is normally between 8 o'clock at night and 11 so we wanted to",
    "start": "475990",
    "end": "483340"
  },
  {
    "text": "be able to scale our jobs according to traffic which we hadn't at all before so",
    "start": "483340",
    "end": "491320"
  },
  {
    "text": "we needed some sort of system to solve all of these problems that we never had and after some searching and even",
    "start": "491320",
    "end": "496780"
  },
  {
    "text": "experimenting with running missiles for a while long story short rail and alone using kubernetes so we've set up kubernetes",
    "start": "496780",
    "end": "506650"
  },
  {
    "text": "from scratch on their own hardware and this was before the cabinet is the",
    "start": "506650",
    "end": "511870"
  },
  {
    "text": "hardware guy it existed so there was kind of a guy that pointed in a general direction but since kubernetes is so",
    "start": "511870",
    "end": "519550"
  },
  {
    "text": "flexible there were a lot of details that we had to figure out for ourselves things like what bubbling Linux are we",
    "start": "519550",
    "end": "526630"
  },
  {
    "text": "going to use versions of the different components are actually compatible with each other how do you solve the community network",
    "start": "526630",
    "end": "533829"
  },
  {
    "text": "infrastructure requirements and how do we do a configuration and deployment and all of that let's just say that we learn",
    "start": "533829",
    "end": "541540"
  },
  {
    "text": "a lot but luckily the situation has improved a lot since then it's a while",
    "start": "541540",
    "end": "546549"
  },
  {
    "text": "ago now anyway we started out running on virtual machines that we provisioned from our OpenStack cluster that we",
    "start": "546549",
    "end": "552879"
  },
  {
    "text": "already had we used to terraform for this and then we did the installing and configuration",
    "start": "552879",
    "end": "558309"
  },
  {
    "text": "of kubernetes itself with puppet which we already used as well but after a long",
    "start": "558309",
    "end": "564699"
  },
  {
    "text": "period of debugging hypervisor performance issues in OpenStack we decided to just repurpose a few of those",
    "start": "564699",
    "end": "570639"
  },
  {
    "text": "OpenStack nodes to be pure cabinet ease notes and run directly on the metal so",
    "start": "570639",
    "end": "576699"
  },
  {
    "text": "right now we're running production on a few pretty large bare metal nodes that",
    "start": "576699",
    "end": "581889"
  },
  {
    "text": "are running in our own datacenter and we're on our development environments in",
    "start": "581889",
    "end": "587829"
  },
  {
    "text": "container engine this is really nice it's much easier to set up workers to you can just click a button or run a CLI",
    "start": "587829",
    "end": "594459"
  },
  {
    "text": "command and then you have a cluster very nice but unfortunately we can't run production on Google container engine",
    "start": "594459",
    "end": "600509"
  },
  {
    "text": "due to a lot of reasons one of which is that we are using a database that isn't",
    "start": "600509",
    "end": "607029"
  },
  {
    "text": "particularly cloud friendly right now",
    "start": "607029",
    "end": "611519"
  },
  {
    "text": "yes and so now we had kubernetes running but we still had a lot of micro services and although developers and as we",
    "start": "612269",
    "end": "619869"
  },
  {
    "text": "started to learn a bit about how cuban artists works we realized we needed to build something on top basically to",
    "start": "619869",
    "end": "626230"
  },
  {
    "text": "replicate the restrictions we created in our purpose set up to make it easy for people to create applications to run our",
    "start": "626230",
    "end": "631959"
  },
  {
    "text": "Honore on their infrastructure the main reason was that we could create",
    "start": "631959",
    "end": "637029"
  },
  {
    "text": "something called fin investor destructor as a service I mean if you're Norwegian you would pronounce that fierce and that",
    "start": "637029",
    "end": "643059"
  },
  {
    "text": "basically is silliness in its there's funny because now we have we talked",
    "start": "643059",
    "end": "649389"
  },
  {
    "text": "about migrating stuff to fuse and there is management sending emails but we need Morpheus and everything it's quite good",
    "start": "649389",
    "end": "655529"
  },
  {
    "text": "so I really recommend trying to get a silly name for your",
    "start": "655529",
    "end": "660660"
  },
  {
    "text": "but as I said we had three we had 130 developers I'm trading 50 microservices",
    "start": "660660",
    "end": "666520"
  },
  {
    "text": "we needed to we needed to figure out how to run fin applications on kubernetes as",
    "start": "666520",
    "end": "672640"
  },
  {
    "text": "we talk more about what we basically did was we with this we created a set of",
    "start": "672640",
    "end": "678550"
  },
  {
    "text": "contracts that describe how the applications and infrastructure should talk to each other and we said as long",
    "start": "678550",
    "end": "685390"
  },
  {
    "text": "as you had he adhere to dis contracts you can do whatever you want to and this",
    "start": "685390",
    "end": "690430"
  },
  {
    "text": "reduced the solution space for developers a lot they don't that they",
    "start": "690430",
    "end": "696580"
  },
  {
    "text": "don't know how we do networking they don't know how to do storage it dead just know what FERC's of course they",
    "start": "696580",
    "end": "702910"
  },
  {
    "text": "need access to Cuban artists to be able to debug and do migrations but it's it's",
    "start": "702910",
    "end": "709390"
  },
  {
    "text": "much easier so we really wanted our platform to be opinionated we wanted it",
    "start": "709390",
    "end": "714400"
  },
  {
    "text": "to be clear and say exactly how what Athena plication looks like right now",
    "start": "714400",
    "end": "721960"
  },
  {
    "text": "we're kind of in the we migrated as many",
    "start": "721960",
    "end": "727060"
  },
  {
    "text": "applications so we know said this is it works we as soon as I went up on stage",
    "start": "727060",
    "end": "732100"
  },
  {
    "text": "at FINA and said you can do docker there was for developers came running to my plate that's straight after because",
    "start": "732100",
    "end": "738100"
  },
  {
    "text": "everybody wants to use docker and then we use kind of used those poor souls to create our the first version of our",
    "start": "738100",
    "end": "744400"
  },
  {
    "text": "platform because they could take anything you couldn't keep as unstable",
    "start": "744400",
    "end": "749680"
  },
  {
    "text": "as you want to they would be happy and now we're running some of the biggest services we have introduced auto scaling",
    "start": "749680",
    "end": "756910"
  },
  {
    "text": "so we scale up and down according to traffic and now it's basically now most developers see that this is this is a",
    "start": "756910",
    "end": "763390"
  },
  {
    "text": "better way to go so they come to us and want to migrate instead of the other way around and of course we measure",
    "start": "763390",
    "end": "771700"
  },
  {
    "text": "distinctly how many services run on one feels sort of three layered model to",
    "start": "771700",
    "end": "781870"
  },
  {
    "text": "describe house at the bottom we have a kubernetes cluster which can be our own",
    "start": "781870",
    "end": "788710"
  },
  {
    "text": "premise cluster or one hour Google container engine coasters let me try to make sure that these clusters",
    "start": "788710",
    "end": "795140"
  },
  {
    "text": "have the same cluster add-ons and so on so that the clusters behave in mostly",
    "start": "795140",
    "end": "800360"
  },
  {
    "text": "the same way on top of kubernetes we run what we call platform services and these",
    "start": "800360",
    "end": "806000"
  },
  {
    "text": "are tools that handled application needs like deployment logs and metric segregation on traffic ingress etc and",
    "start": "806000",
    "end": "813320"
  },
  {
    "text": "these are deployed using a continuous delivery pipeline that we built based on helm on top of these services and sort",
    "start": "813320",
    "end": "822620"
  },
  {
    "text": "of around these services we run our business applications and these can rely on the API of our platform services as",
    "start": "822620",
    "end": "828620"
  },
  {
    "text": "well as the kubernetes api and these are deployed using the file system which",
    "start": "828620",
    "end": "835010"
  },
  {
    "text": "I'll get to in a second so I don't mention contracts but at the core of us",
    "start": "835010",
    "end": "841730"
  },
  {
    "text": "are these well-defined contracts that this gray describe the relationship between the infrastructure and the",
    "start": "841730",
    "end": "847250"
  },
  {
    "text": "applications that run inside it these contracts cover what we think are the basic needs of an applications like",
    "start": "847250",
    "end": "854980"
  },
  {
    "text": "allocating compute resources deployment logging metrics as well as how to get",
    "start": "854980",
    "end": "860810"
  },
  {
    "text": "traffic into your application so we try to design these contracts to sort of cover the 80% case which for us means",
    "start": "860810",
    "end": "867400"
  },
  {
    "text": "mostly stateless services that talk to each other over the network so that",
    "start": "867400",
    "end": "873170"
  },
  {
    "text": "developers of these applications can more easily migrate to this new infrastructure regardless of what sort",
    "start": "873170",
    "end": "878390"
  },
  {
    "text": "of programming language or framework they are using for writing in an application and when the way",
    "start": "878390",
    "end": "885170"
  },
  {
    "text": "applications interact with the infrastructure is well-defined like this it's easier to achieve a new ability run",
    "start": "885170",
    "end": "891560"
  },
  {
    "text": "it culture as well which you want and this is easier because they're running it part of it it's just easier we kind",
    "start": "891560",
    "end": "898970"
  },
  {
    "text": "of great if you implemented some of these contracts as shared libraries for some our most used programming languages",
    "start": "898970",
    "end": "905120"
  },
  {
    "text": "the logging contract for instance is just a shared Java library called Commons logging or not something like",
    "start": "905120",
    "end": "911500"
  },
  {
    "text": "yeah but if you want to write an application in Haskell or something you are sort of on your own you just but you",
    "start": "911500",
    "end": "917150"
  },
  {
    "text": "have these contracts that you have to adhere to anyway so you know what you have to do",
    "start": "917150",
    "end": "922960"
  },
  {
    "text": "to implement these contracts we use a Yammer configuration file named file CMO for each application this file lives in",
    "start": "923310",
    "end": "931410"
  },
  {
    "text": "the applications source repository and is used by our pipeline and deployment system to the right here you can see the",
    "start": "931410",
    "end": "938850"
  },
  {
    "text": "the piace mo config file for the service that renders the header on most pages on our sites it's about nine lines of",
    "start": "938850",
    "end": "946230"
  },
  {
    "text": "config and to the left you can see the beginning of the kubernetes manifest diamo for this application when it's",
    "start": "946230",
    "end": "953550"
  },
  {
    "text": "actually deployed into our cluster and it's about 147 lines but the important",
    "start": "953550",
    "end": "958980"
  },
  {
    "text": "thing about this isn't necessarily just fewer lines of config the interesting part is the abstraction layer that this",
    "start": "958980",
    "end": "964920"
  },
  {
    "text": "creates for us and it bites us a few nice things means that we can change the",
    "start": "964920",
    "end": "970920"
  },
  {
    "text": "configuration that the developers don't see this buys us a lot of room to sort",
    "start": "970920",
    "end": "976260"
  },
  {
    "text": "of change the underlying infrastructure if we have to without the application",
    "start": "976260",
    "end": "981690"
  },
  {
    "text": "developers having to change every application they own this makes them happy and when every application sort of",
    "start": "981690",
    "end": "990089"
  },
  {
    "text": "looks the same or at least similar from an operational perspective this means that we can more easily do changes in a",
    "start": "990089",
    "end": "996450"
  },
  {
    "text": "live production system if we have to and that sometimes happens since most",
    "start": "996450",
    "end": "1002060"
  },
  {
    "text": "applications look the same it's easier to get better development speed as well since developers just have less",
    "start": "1002060",
    "end": "1007910"
  },
  {
    "text": "configuration to worry about so",
    "start": "1007910",
    "end": "1013190"
  },
  {
    "text": "development speed is important we we want to push our six million minute medians I'm the production even further",
    "start": "1013190",
    "end": "1019060"
  },
  {
    "text": "so we needed the employment system that's fast and reliable and this is the",
    "start": "1019060",
    "end": "1024620"
  },
  {
    "text": "way we do it with kubernetes we have a deployable that has two parts we have a",
    "start": "1024620",
    "end": "1030170"
  },
  {
    "text": "few more config file and our reference to a docker image so when the developer",
    "start": "1030170",
    "end": "1036319"
  },
  {
    "text": "pushers have changed to to his application these two things are packaged by the CI system and our",
    "start": "1036319",
    "end": "1043188"
  },
  {
    "text": "pipeline which is a web application that we built herself it figures out the poi",
    "start": "1043189",
    "end": "1048560"
  },
  {
    "text": "to the development environment automatically the way it does this is just by publishing a message on our",
    "start": "1048560",
    "end": "1054410"
  },
  {
    "text": "Kafka topic then we have a kind of operator that runs inside the cluster we've named it",
    "start": "1054410",
    "end": "1060630"
  },
  {
    "text": "EOS deploy daemon suitably boring name it's anyway it subscribes on this topic",
    "start": "1060630",
    "end": "1067110"
  },
  {
    "text": "and it receives a message it talks to",
    "start": "1067110",
    "end": "1072630"
  },
  {
    "text": "the communities API server and creates this required kubernetes resources based",
    "start": "1072630",
    "end": "1079710"
  },
  {
    "text": "on the piace mo file and when it's done and all the thoughts are running and",
    "start": "1079710",
    "end": "1084960"
  },
  {
    "text": "healthy it pushes a mission message back to the pipeline so that it can render a nice green box in the web front-end so",
    "start": "1084960",
    "end": "1092640"
  },
  {
    "text": "that our developer knows that everything is fine in production at this point there are some teams that run some",
    "start": "1092640",
    "end": "1098730"
  },
  {
    "text": "integration tests or some teams maybe have a manual verification step in the pipeline before the change is rolled out",
    "start": "1098730",
    "end": "1105330"
  },
  {
    "text": "in the production yes and of course at",
    "start": "1105330",
    "end": "1110460"
  },
  {
    "text": "Finn as most people should we focus a lot on observability we had even before",
    "start": "1110460",
    "end": "1117660"
  },
  {
    "text": "Milotic abilities we've been collecting metrics and aggregating logs for a long time for logging we used to run the elk",
    "start": "1117660",
    "end": "1126480"
  },
  {
    "text": "stack on our legacy systems but when we take a blood test we replaced the log",
    "start": "1126480",
    "end": "1132300"
  },
  {
    "text": "start with fluency just because it's easier than we can use it's just easier to run and the logging part basically",
    "start": "1132300",
    "end": "1140370"
  },
  {
    "text": "just works we have some developers that still want to go to the disk on the",
    "start": "1140370",
    "end": "1146040"
  },
  {
    "text": "application run to do grep and tail so",
    "start": "1146040",
    "end": "1151290"
  },
  {
    "text": "we have kind of a constructive conversation with them to try to teach",
    "start": "1151290",
    "end": "1157080"
  },
  {
    "text": "them that even though that's how we used to do it it doesn't really work that that way anymore and we might be able to",
    "start": "1157080",
    "end": "1165270"
  },
  {
    "text": "put some logs on an s3 bucket or something so they can go do their thing and for metrics we use Prometheus and if",
    "start": "1165270",
    "end": "1173580"
  },
  {
    "text": "you went listen to the keynote earlier he described the integration between",
    "start": "1173580",
    "end": "1179250"
  },
  {
    "text": "Prometheus and kubernetes when I saw that the first time approximately err ago I saw that it was incredibly",
    "start": "1179250",
    "end": "1187200"
  },
  {
    "text": "incredibly powerful you get so much for free because we have functionality and",
    "start": "1187200",
    "end": "1193260"
  },
  {
    "text": "promethease that understands the Promethean functionality and for me this",
    "start": "1193260",
    "end": "1198330"
  },
  {
    "text": "it understands the community's api's and use that for service discovery so we",
    "start": "1198330",
    "end": "1203490"
  },
  {
    "text": "just basically just deployed with this inter cluster and give it a more or less standard configuration file and that",
    "start": "1203490",
    "end": "1209810"
  },
  {
    "text": "discovers everything that runs in the cluster and a part of the contract for Finn application is that you should",
    "start": "1209810",
    "end": "1216480"
  },
  {
    "text": "instrument your application with the Prometheus client and at least exposed default metrics which is CPU memory and",
    "start": "1216480",
    "end": "1223590"
  },
  {
    "text": "those kinds of things and then because we have the metadata from Prometheus and",
    "start": "1223590",
    "end": "1228630"
  },
  {
    "text": "we put some additional metadata using if you deploy demon that flows through the",
    "start": "1228630",
    "end": "1233640"
  },
  {
    "text": "system we have that metadata in Prometheus and we can use that in graph armor so what you see on the screen here",
    "start": "1233640",
    "end": "1241260"
  },
  {
    "text": "is basically a default dashboard that any application that deploys to our clusters get for free it's just because",
    "start": "1241260",
    "end": "1248670"
  },
  {
    "text": "to me we just use the app label in",
    "start": "1248670",
    "end": "1254310"
  },
  {
    "text": "Prometheus and kubernetes as to populate the drop-down so each new app just gets",
    "start": "1254310",
    "end": "1259830"
  },
  {
    "text": "a new line in the drop-down and you just go to the tab this dashboard and you find our app and of course then we can",
    "start": "1259830",
    "end": "1265740"
  },
  {
    "text": "also do things across every every application because every all applications send out CPU that are the",
    "start": "1265740",
    "end": "1272640"
  },
  {
    "text": "same way for instances so we can easily even though we don't don't it we could say what team uses most resources we",
    "start": "1272640",
    "end": "1279690"
  },
  {
    "text": "have all the data and for me this we just need to create the query and get someone who needs the data the last",
    "start": "1279690",
    "end": "1285270"
  },
  {
    "text": "thing we built is something called the FIA's canary app this is one application that we deploy using as part of the",
    "start": "1285270",
    "end": "1291540"
  },
  {
    "text": "platform applications that tests all the functionality it tries to expose the metrics and see that this comes into",
    "start": "1291540",
    "end": "1297330"
  },
  {
    "text": "prometheus it tries to talk to another application in the tester and it put",
    "start": "1297330",
    "end": "1303030"
  },
  {
    "text": "some logs and look at look at that in Kabana and this we use as part of the cluster deployment pipeline so we we deploy all",
    "start": "1303030",
    "end": "1312750"
  },
  {
    "text": "our platform applications into a staging cluster and then we do a call to the canary app to see that everything works",
    "start": "1312750",
    "end": "1319230"
  },
  {
    "text": "and if that works upgrade the production cluster so we even have kind of continuous delivery on our",
    "start": "1319230",
    "end": "1325020"
  },
  {
    "text": "platform applications into production",
    "start": "1325020",
    "end": "1328370"
  },
  {
    "text": "it's now to the last part which turns out to be one of the most time-consuming and difficult parts migrating",
    "start": "1330350",
    "end": "1337200"
  },
  {
    "text": "applications to doctor and Cuban I basically make them cloud native and of",
    "start": "1337200",
    "end": "1344040"
  },
  {
    "text": "course easy we're doing that is just saying you need to be 12 factor and at",
    "start": "1344040",
    "end": "1349890"
  },
  {
    "text": "least four new applications that's quite easy they can most developers will do that just by reading the doc and it's",
    "start": "1349890",
    "end": "1357210"
  },
  {
    "text": "quite easy but we have loads of legacy we spent 10 years trying to write applications and most of them doesn't",
    "start": "1357210",
    "end": "1364470"
  },
  {
    "text": "really fit we have some one that means this can we have someone that's tied to some tiny money detail inter in a puppet",
    "start": "1364470",
    "end": "1371040"
  },
  {
    "text": "setup that's impossible to replicate in kubernetes so for some applications migrating to FERC's like in our work and",
    "start": "1371040",
    "end": "1378210"
  },
  {
    "text": "for some it's weeks the funny thing is even the people who spent weeks migrating applications to different",
    "start": "1378210",
    "end": "1384809"
  },
  {
    "text": "kubernetes tells us that they think their application has gotten better from that work it's less coupled to the",
    "start": "1384809",
    "end": "1391740"
  },
  {
    "text": "infrastructure and it's easier to scale up and down for instance yeah so",
    "start": "1391740",
    "end": "1402210"
  },
  {
    "text": "adapting applications is just the first part of the journey for migrating though these applications are obviously",
    "start": "1402210",
    "end": "1408210"
  },
  {
    "text": "connected migrating an entire this complex distributed system like this is",
    "start": "1408210",
    "end": "1414500"
  },
  {
    "text": "difficult so we needed to build sort of some mechanisms to make it easier and",
    "start": "1414500",
    "end": "1420540"
  },
  {
    "text": "safer to do at speed towards excellence",
    "start": "1420540",
    "end": "1425299"
  },
  {
    "text": "but before we can get to that or to give you some context for what we've done for migrating we first have to talk about",
    "start": "1426799",
    "end": "1433559"
  },
  {
    "text": "how we do traffic ingress and to run traffic from the internet into our",
    "start": "1433559",
    "end": "1440370"
  },
  {
    "text": "cluster we use an ingress controller that we've implemented ourselves it's based on a GI proxy and we run to a",
    "start": "1440370",
    "end": "1449280"
  },
  {
    "text": "checkbox instances in an active/passive topology and they live outside the cluster itself and we use",
    "start": "1449280",
    "end": "1457530"
  },
  {
    "text": "note port services for for each application that we deploy in the cluster to make a chip Rox he'll be able",
    "start": "1457530",
    "end": "1463620"
  },
  {
    "text": "to talk to this and this English controller integrates with our feature",
    "start": "1463620",
    "end": "1468750"
  },
  {
    "text": "talking tool which is called unleash and note that this is a logical diagram the",
    "start": "1468750",
    "end": "1475140"
  },
  {
    "text": "traffic doesn't actually run through the unleash component it's just used to configure dangerous controller also when",
    "start": "1475140",
    "end": "1482430"
  },
  {
    "text": "you deploy an application into the cluster using files you can send requests to your that's supposed to go",
    "start": "1482430",
    "end": "1491100"
  },
  {
    "text": "to your application to your app name dot some well-defined fqdn let's set up us",
    "start": "1491100",
    "end": "1497010"
  },
  {
    "text": "as a wildcard DNS entry and then the traffic will be routed into your",
    "start": "1497010",
    "end": "1502890"
  },
  {
    "text": "application via the English controller without the developers essentially having to do anything but you can also",
    "start": "1502890",
    "end": "1508200"
  },
  {
    "text": "override this in the fuel CMO config file by specifying a different domain",
    "start": "1508200",
    "end": "1513330"
  },
  {
    "text": "name and path for where the application should be available so basically what we",
    "start": "1513330",
    "end": "1522750"
  },
  {
    "text": "do is rely heavily on using feature toggling in the load balancer and the",
    "start": "1522750",
    "end": "1529680"
  },
  {
    "text": "way it works is that the application developers can create feature toggles in the Unleashed application which is a web application and as long as these follow",
    "start": "1529680",
    "end": "1536970"
  },
  {
    "text": "a specific naming scheme they'll be picked up by the English controller and the English controller wind will be",
    "start": "1536970",
    "end": "1543150"
  },
  {
    "text": "configured to route traffic in a way that you could you could use the feature toggle to say that I want 10% of traffic",
    "start": "1543150",
    "end": "1550110"
  },
  {
    "text": "to go into kubernetes and then the rest wouldn't the remaining 90% will continue to go into the legacy",
    "start": "1550110",
    "end": "1557160"
  },
  {
    "text": "infrastructure for any given application and we can do these logos in the load",
    "start": "1557160",
    "end": "1562440"
  },
  {
    "text": "balancer or sometimes we do it in the client library if there's a service",
    "start": "1562440",
    "end": "1567510"
  },
  {
    "text": "that's only used internally and and",
    "start": "1567510",
    "end": "1572760"
  },
  {
    "text": "that's cool but marketing only parts of the traffic is just one part of the personal for doing it safely because we",
    "start": "1572760",
    "end": "1579390"
  },
  {
    "text": "also need to learn what's going on so we need to look at some metrics so we",
    "start": "1579390",
    "end": "1584880"
  },
  {
    "text": "basically what we have is dashboards that are measuring the same thing in new",
    "start": "1584880",
    "end": "1590720"
  },
  {
    "text": "infrastructure and the old room structure and these are things like response time and Status per call or",
    "start": "1590720",
    "end": "1597700"
  },
  {
    "text": "research usage like CPU memory treads in use for descriptor file descriptors that",
    "start": "1597700",
    "end": "1604580"
  },
  {
    "text": "are consumed by the application and so on and we also have our application developers be heavily involved in this",
    "start": "1604580",
    "end": "1611059"
  },
  {
    "text": "process as well because they usually usually know their applications bests and they know how they work and what we",
    "start": "1611059",
    "end": "1616820"
  },
  {
    "text": "should measure I think this graph is probably from time where it wasn't going that well I hope",
    "start": "1616820",
    "end": "1623480"
  },
  {
    "text": "so at least so we measure how things are going on in",
    "start": "1623480",
    "end": "1628520"
  },
  {
    "text": "the both of the infrastructures and compare to see if everything looks good and if it does we can just push more traffic until we hit some limit and my",
    "start": "1628520",
    "end": "1636530"
  },
  {
    "text": "graph ends up looking at it like this and we have to kind of roll back and start troubleshooting what was going on",
    "start": "1636530",
    "end": "1643510"
  },
  {
    "text": "and it this isn't easy you kind of have to handle each case separately but I guess this is the most the the most",
    "start": "1643510",
    "end": "1651080"
  },
  {
    "text": "general thing that we've found that has worked for us to to sort of maintain the development speed that we want while",
    "start": "1651080",
    "end": "1657320"
  },
  {
    "text": "migrating to any investor the infrastructure so for conclusions",
    "start": "1657320",
    "end": "1666070"
  },
  {
    "text": "kubernetes isn't the same for everybody if we tried moving our mimetic",
    "start": "1666100",
    "end": "1671570"
  },
  {
    "text": "application of the kubernetes but just everything would just gone a bit slower",
    "start": "1671570",
    "end": "1676580"
  },
  {
    "text": "basically it wouldn't given a given us any value but we need we need you need",
    "start": "1676580",
    "end": "1683419"
  },
  {
    "text": "micro services and we need small components to properly get the value out of kubernetes and if you're as big as",
    "start": "1683419",
    "end": "1691669"
  },
  {
    "text": "Finland is which in Norwegian terms at least it's big it's probably worth it to create something on top of kubernetes to",
    "start": "1691669",
    "end": "1698659"
  },
  {
    "text": "restrict the choices of developers also this is an important way of achieving the continuous delivery and the",
    "start": "1698659",
    "end": "1705110"
  },
  {
    "text": "development speed you need if every developer who wanted to create a new service at fin SATA and thought about",
    "start": "1705110",
    "end": "1710600"
  },
  {
    "text": "how they which ingress controller they will choose we wouldn't be able to do anything we will just discuss technology",
    "start": "1710600",
    "end": "1717470"
  },
  {
    "text": "which of course is cool but it doesn't for some reason product people don't like that",
    "start": "1717470",
    "end": "1722910"
  },
  {
    "text": "and metrics metric is the most important thing if you want to migrate in a safe way you need to know what happens in",
    "start": "1722910",
    "end": "1728040"
  },
  {
    "text": "production and it took didn't take us",
    "start": "1728040",
    "end": "1733440"
  },
  {
    "text": "too long to create kind of a Minimum Viable Product thing that we could start to use for migration but actually",
    "start": "1733440",
    "end": "1740400"
  },
  {
    "text": "migrating takes a lot of time and we I think the sooner you can start migrating",
    "start": "1740400",
    "end": "1746460"
  },
  {
    "text": "the sooner you can get actual feedback on what features you need to create which is useful if you want to be a part",
    "start": "1746460",
    "end": "1754500"
  },
  {
    "text": "of this ship set which is the owner of Finn has openings so go to job stop chip",
    "start": "1754500",
    "end": "1761130"
  },
  {
    "text": "stay calm and then it's time for questions",
    "start": "1761130",
    "end": "1767210"
  },
  {
    "text": "well I think I can imagine the developers coming to me complaining that",
    "start": "1796970",
    "end": "1802110"
  },
  {
    "text": "had to rewrite everything Oh actually I can imagine the public people deciding what the developers should do coming to",
    "start": "1802110",
    "end": "1808200"
  },
  {
    "text": "complain to me that developers can't great products they can only create applications again so we wanted to we",
    "start": "1808200",
    "end": "1813900"
  },
  {
    "text": "want to reduce things you need to do as much as possible right now if you create",
    "start": "1813900",
    "end": "1819809"
  },
  {
    "text": "the doctor container and you create a fire siamo the pipeline will just deploy your application into both systems so",
    "start": "1819809",
    "end": "1825990"
  },
  {
    "text": "would then we wanted to reduce the things to do to a minimum to migrate yes",
    "start": "1825990",
    "end": "1835820"
  },
  {
    "text": "well before we started this process Finn kind of had made one strategic decision",
    "start": "1862400",
    "end": "1868260"
  },
  {
    "text": "they wanted to have you build to run it so for this 120 developers this",
    "start": "1868260",
    "end": "1873740"
  },
  {
    "text": "basically killed the operations department and created infrastructure department which was both the Ops guys",
    "start": "1873740",
    "end": "1878790"
  },
  {
    "text": "and a bunch of developers so then we created a bigger infrastructure department than what we had as an",
    "start": "1878790",
    "end": "1884520"
  },
  {
    "text": "Operations team and that gave us some extra some extra strength and made it",
    "start": "1884520",
    "end": "1890580"
  },
  {
    "text": "possible to do more but at the same time we said at this department shouldn't do ops they should create tools for the",
    "start": "1890580",
    "end": "1896610"
  },
  {
    "text": "developers do their own operations and then we got in morally right so basically we moved all the",
    "start": "1896610",
    "end": "1902580"
  },
  {
    "text": "responsibility to the developers and then we start creating tooling that made it easy for them to do it and this",
    "start": "1902580",
    "end": "1907830"
  },
  {
    "text": "really works we see that not every developer but enough developers have",
    "start": "1907830",
    "end": "1913380"
  },
  {
    "text": "this connection to their production environment and they get alerts and everything so we I think we managed to",
    "start": "1913380",
    "end": "1918990"
  },
  {
    "text": "achieve this ability run it in a proper way and that makes everything easier because then they also understand why",
    "start": "1918990",
    "end": "1924540"
  },
  {
    "text": "this is better now well the devs also",
    "start": "1924540",
    "end": "1933270"
  },
  {
    "text": "work on the old infrastructure but them probably need more help and it's not as easy more questions yes",
    "start": "1933270",
    "end": "1944570"
  },
  {
    "text": "there isn't with a typical problem there's different problems every time I",
    "start": "1951600",
    "end": "1958260"
  },
  {
    "text": "can remember one where the applications kind of had they had to preform their",
    "start": "1961530",
    "end": "1967240"
  },
  {
    "text": "caches before they could start accepting traffic and this pre-warming was created",
    "start": "1967240",
    "end": "1973150"
  },
  {
    "text": "somewhere deep in puppet so it was this extra call from puppet to the application after it started by hitting",
    "start": "1973150",
    "end": "1979150"
  },
  {
    "text": "an HTTP endpoint and that's not possible to do it in kubernetes so they had to kind of rewrite their application to do",
    "start": "1979150",
    "end": "1987910"
  },
  {
    "text": "that themselves and then that didn't really fit that application was structured and then it that took a week",
    "start": "1987910",
    "end": "1993880"
  },
  {
    "text": "or two which basically is the worst case we had you also end up finding a lot of application bugs so we had vulnerable",
    "start": "1993880",
    "end": "2002340"
  },
  {
    "text": "just because their infrastructure different a lot of it is because the network is different one example is we",
    "start": "2002340",
    "end": "2008490"
  },
  {
    "text": "had an application that didn't set a time out on its database connection pools and for some reason the network",
    "start": "2008490",
    "end": "2016640"
  },
  {
    "text": "started not remembering method connections so it ended up just having",
    "start": "2016640",
    "end": "2023340"
  },
  {
    "text": "all of its connections waiting for a response forever and then it died so",
    "start": "2023340",
    "end": "2029700"
  },
  {
    "text": "let's just strange things that you discover when the infrastructure changes we also had problems with DNS being",
    "start": "2029700",
    "end": "2036210"
  },
  {
    "text": "slower and no js' not caching DNS responses so every request was slower so",
    "start": "2036210",
    "end": "2043230"
  },
  {
    "text": "a lot of strange things are happening but you just have to take everything as it comes and try to solve it and I think",
    "start": "2043230",
    "end": "2050760"
  },
  {
    "text": "everybody agrees that the quality increases when you do this so in theory at least everybody's happy practice",
    "start": "2050760",
    "end": "2057750"
  },
  {
    "text": "yeah we've even had a few demo maybe another few developers saying that my",
    "start": "2057750",
    "end": "2062760"
  },
  {
    "text": "application is so much better now after I migrated which is sounds good then we give them cake",
    "start": "2062760",
    "end": "2068610"
  },
  {
    "text": "yes well if you ask deployed him in",
    "start": "2068610",
    "end": "2082050"
  },
  {
    "text": "which is a Python through script running inside the cluster that creates dangerous for the service if you needed",
    "start": "2082050",
    "end": "2088530"
  },
  {
    "text": "to be exposed externally and then you come to find this this is done in Python",
    "start": "2088530",
    "end": "2094830"
  },
  {
    "text": "code so that's one of the things we take away from the developers when we started",
    "start": "2094830",
    "end": "2127320"
  },
  {
    "text": "to be on the new missiles but and then we kind of the people before the hard",
    "start": "2127320",
    "end": "2135240"
  },
  {
    "text": "way guide you learn a lot just by installing it and of course even when",
    "start": "2135240",
    "end": "2140760"
  },
  {
    "text": "the hardware guide is there you learn a lot and then basically we talk to developers and because because we have this ability running culture it's the",
    "start": "2140760",
    "end": "2148050"
  },
  {
    "text": "developers will they will they will just have to learn because they're responsible for their own production",
    "start": "2148050",
    "end": "2154410"
  },
  {
    "text": "system and when we change the production system they have to learn and that's yeah well I'm I think I've talked to",
    "start": "2154410",
    "end": "2161400"
  },
  {
    "text": "every developer in four times last year just saying kubernetes",
    "start": "2161400",
    "end": "2168890"
  },
  {
    "text": "that's also deployed using help the",
    "start": "2175990",
    "end": "2181390"
  },
  {
    "text": "operator is not using help itself but we using helm as part of our continuous delivery pipeline to sort of installed",
    "start": "2181390",
    "end": "2187910"
  },
  {
    "text": "all of the platform services no no",
    "start": "2187910",
    "end": "2194980"
  },
  {
    "text": "that's just what did you said yeah just a few siamo and a docker file that's",
    "start": "2194980",
    "end": "2200450"
  },
  {
    "text": "only to do and then the we did read the first deployment that's all the calls to",
    "start": "2200450",
    "end": "2205880"
  },
  {
    "text": "the APA Cuban intercept guys yes",
    "start": "2205880",
    "end": "2213279"
  },
  {
    "text": "I met them both I think we wanted to when we started do W ability run it the",
    "start": "2221470",
    "end": "2229480"
  },
  {
    "text": "developers they didn't have the knowledge that some of the operator operators had before for instance we",
    "start": "2229480",
    "end": "2235270"
  },
  {
    "text": "have apps running on some of the module mode servers and the user service runs on mode one two three but not for",
    "start": "2235270",
    "end": "2242200"
  },
  {
    "text": "because of Christ has a point but five and if you want to restart that service you need to know this and when you when",
    "start": "2242200",
    "end": "2248380"
  },
  {
    "text": "you give this responsibility to everybody it just doesn't scale everybody needs to know too much and we needed to we needed",
    "start": "2248380",
    "end": "2255130"
  },
  {
    "text": "to change this tool because the complexity of all the micro services kind of came back those it was too small",
    "start": "2255130",
    "end": "2261250"
  },
  {
    "text": "distress on the big foot we grew out our infrastructure as it was so we needed quite new tooling and that was the main",
    "start": "2261250",
    "end": "2270910"
  },
  {
    "text": "risk I don't know if you would call that technical or manner but we kind of collectively agreed that we need to do",
    "start": "2270910",
    "end": "2276640"
  },
  {
    "text": "something here and of course we want to stock or we did Oh No the database we",
    "start": "2276640",
    "end": "2287079"
  },
  {
    "text": "talked about compliment from the data center right now it runs on Solaris and we can't we",
    "start": "2287079",
    "end": "2296260"
  },
  {
    "text": "contact the services in Belgium or Frankfurt with the database in Oslo yeah",
    "start": "2296260",
    "end": "2303390"
  },
  {
    "text": "but I tried believe me yeah thank you",
    "start": "2303390",
    "end": "2312220"
  },
  {
    "text": "for coming thank you very much [Applause]",
    "start": "2312220",
    "end": "2319549"
  }
]