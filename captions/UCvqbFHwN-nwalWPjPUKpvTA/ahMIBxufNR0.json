[
  {
    "text": "welcome everyone thanks for coming my name is Ryan I'm a software engineer at",
    "start": "30",
    "end": "5310"
  },
  {
    "text": "lift I work at the office here in Seattle so it's great to be at a local conference I'm surprised by this amount",
    "start": "5310",
    "end": "11910"
  },
  {
    "text": "of people I should maybe start with a disclaimer you can see the talk title you know what that is I ran into a",
    "start": "11910",
    "end": "17010"
  },
  {
    "text": "friend as I was coming in I haven't seen in a couple years he said your talk looks interesting does this mean I don't",
    "start": "17010",
    "end": "22080"
  },
  {
    "text": "have to use llamo and I want to make a disclaimer it's whatever the opposite of",
    "start": "22080",
    "end": "27359"
  },
  {
    "text": "that is so if you need to get up and leave right now like no problem no judgment ya know so this is encouraging",
    "start": "27359",
    "end": "35460"
  },
  {
    "text": "you to embrace the Y Amal and we're going to talk about how you can deploy your applications more easily and more",
    "start": "35460",
    "end": "41430"
  },
  {
    "text": "customized with this tool is an open-source tool the structure of our talk we'll take a look at the landscape",
    "start": "41430",
    "end": "46590"
  },
  {
    "text": "as with most things kubernetes sometimes it's difficult to sort of place this in",
    "start": "46590",
    "end": "51960"
  },
  {
    "text": "the overall context of all the other tools out there to understand what problems it solves what problems it doesn't solve we'll look at some",
    "start": "51960",
    "end": "58710"
  },
  {
    "text": "features briefly and then we'll dive into a demo and we'll spend most of this talk doing a demo actually that is kind",
    "start": "58710",
    "end": "64680"
  },
  {
    "text": "of non-trivial will will deploy will deploy a piece of software from an upstream we will start layering in",
    "start": "64680",
    "end": "71310"
  },
  {
    "text": "various configuration we'll push it out to gke and use a bunch of the cloud features there as well so that should be good hopefully the Wi-Fi holds so lots",
    "start": "71310",
    "end": "80729"
  },
  {
    "text": "and lots of different tools out there today for deploying our applications you probably have been to talks at this",
    "start": "80729",
    "end": "86159"
  },
  {
    "text": "conference on one or more of these other tools helm is probably the most popular maybe you've seen what the folks over at",
    "start": "86159",
    "end": "93810"
  },
  {
    "text": "paluma are doing a sort of a different take on things it's quite interesting as well there's kisana these other tools and",
    "start": "93810",
    "end": "99299"
  },
  {
    "text": "there are many many more so when looking at them sometimes it's useful to develop even just a coarse-grained taxonomy of",
    "start": "99299",
    "end": "106079"
  },
  {
    "text": "what these tools offer some of them offer dependency management they tell you if you're going to install package a",
    "start": "106079",
    "end": "112350"
  },
  {
    "text": "that you need to install package B and C previously some of them provide application descriptors with URLs to",
    "start": "112350",
    "end": "118979"
  },
  {
    "text": "upstreams different metadata associated with the application there are application discovery systems things",
    "start": "118979",
    "end": "125579"
  },
  {
    "text": "like chart museum where you can go out and actually search for an application there are dashboards that live in your",
    "start": "125579",
    "end": "131340"
  },
  {
    "text": "cluster itself to tell you the current state of application their versions there are tools that let",
    "start": "131340",
    "end": "136560"
  },
  {
    "text": "you manage the lifecycle to deploy to deploy specific versions to roll back and control the lifecycle of your",
    "start": "136560",
    "end": "142260"
  },
  {
    "text": "applications and then there are capabilities of these tools that allow it to be customized or adapted or",
    "start": "142260",
    "end": "147510"
  },
  {
    "text": "tailored to your specific needs and in fact that is the the domain of customize",
    "start": "147510",
    "end": "153000"
  },
  {
    "text": "it is a very targeted tool it does not try to accomplish all of these other things it's really doing one thing and",
    "start": "153000",
    "end": "160110"
  },
  {
    "text": "that is allowing you to tailor your Yambol files to your specific environment so it's very useful in many",
    "start": "160110",
    "end": "166049"
  },
  {
    "text": "developer workflows and it can find a very natural place in some CD pipelines as well this is the description from the",
    "start": "166049",
    "end": "173910"
  },
  {
    "text": "rebe file on on the customized github page it lets you customize raw template for llamó files for multiple purposes",
    "start": "173910",
    "end": "180269"
  },
  {
    "text": "leaving the original Y amel untouched and usable as is so this is really a key idea that we'll come back to will",
    "start": "180269",
    "end": "186420"
  },
  {
    "text": "develop will sort of parse this and really understand what that means a very",
    "start": "186420",
    "end": "191519"
  },
  {
    "text": "simple invocation of it is shown below you'll run the CLI tool from the command line customize build it looks in the",
    "start": "191519",
    "end": "197579"
  },
  {
    "text": "directory at the contents of the files pulls those in and processes it and outputs the result to standard out so a",
    "start": "197579",
    "end": "203459"
  },
  {
    "text": "very common flow is simply to run this tool and pipe it as I'm doing in this case directly to coop cuddle apply and",
    "start": "203459",
    "end": "208859"
  },
  {
    "text": "you will immediately have those changes applied to your cluster a nuke a new",
    "start": "208859",
    "end": "215880"
  },
  {
    "text": "configuration file is introduced here by the customized tool so customization yamo is basically what parameterize --is",
    "start": "215880",
    "end": "222720"
  },
  {
    "text": "this tool so you may have some existing ml descriptors that are ready to be deployed into a kubernetes cluster you",
    "start": "222720",
    "end": "228870"
  },
  {
    "text": "can drop a customization llamó file in adjacent to those other files and begin",
    "start": "228870",
    "end": "234090"
  },
  {
    "text": "to define new behavior that will be performed during the build process so in this case this is pulling in two",
    "start": "234090",
    "end": "240000"
  },
  {
    "text": "resources this is assuming there is a deployment and a service y amal adjacent to this this file on the file system",
    "start": "240000",
    "end": "245730"
  },
  {
    "text": "and so when build runs it will pull these files in and then it will stamp this coop con namespace to all the",
    "start": "245730",
    "end": "251790"
  },
  {
    "text": "resources in that file in those files and omit it to standard out so that",
    "start": "251790",
    "end": "256859"
  },
  {
    "text": "would be a very very simple use case you may be thinking back to the 70s here and",
    "start": "256859",
    "end": "261900"
  },
  {
    "text": "the UNIX philosophy of doing one thing well and that is very very much the ethos of customized it's a very again",
    "start": "261900",
    "end": "267750"
  },
  {
    "text": "a very targeted tool to allow you to manipulate gamal and not not just any llamo this is manipulating specifically",
    "start": "267750",
    "end": "274920"
  },
  {
    "text": "kubernetes api llamo herman customize has its roots in this paper written by",
    "start": "274920",
    "end": "281160"
  },
  {
    "text": "barring grant a declarative application management in kubernetes if this is a general area of interest to you even if",
    "start": "281160",
    "end": "287160"
  },
  {
    "text": "this tool is not of interest i would strongly advocate that you go read this paper it's quite interesting it's available on github as well as on a",
    "start": "287160",
    "end": "293460"
  },
  {
    "text": "google dr you just google for it you'll find it relatively quickly but it talks about the motivation it talks about",
    "start": "293460",
    "end": "299100"
  },
  {
    "text": "other tools in this space and it talks about the general concept of splitting apart some of the functionality of these",
    "start": "299100",
    "end": "304470"
  },
  {
    "text": "tools these monolithic tools and exposing things like customize to handle these very purpose-built utilities let's",
    "start": "304470",
    "end": "312390"
  },
  {
    "text": "look at some features so once again you see a customization UML file and a pod",
    "start": "312390",
    "end": "317880"
  },
  {
    "text": "llamo so the pod yeah Mel should look very very familiar to everyone in the audience this is a super simple pods",
    "start": "317880",
    "end": "323430"
  },
  {
    "text": "back that's defined here and the mo file is sort of ready to be applied to a cluster all that we do would would be",
    "start": "323430",
    "end": "329280"
  },
  {
    "text": "spin up this busybox based container I'll point out that the that pot is called snooze if you look at metadata",
    "start": "329280",
    "end": "334680"
  },
  {
    "text": "name so customization yam all if it sits adjacent to it on the file system you'll",
    "start": "334680",
    "end": "339900"
  },
  {
    "text": "notice at the bottom resources pod yeah Mel so it's pulling this into the file system and then it will stamp on to that",
    "start": "339900",
    "end": "345600"
  },
  {
    "text": "these custom labels and these custom annotations further it will apply this",
    "start": "345600",
    "end": "350910"
  },
  {
    "text": "prefix of pre production to each of the resources processed and it will drop that into a customer preview namespace",
    "start": "350910",
    "end": "356100"
  },
  {
    "text": "so again you run a customized build with those two files in a file system and you'll see something that looks much",
    "start": "356100",
    "end": "361710"
  },
  {
    "text": "like this it's very similar to the original amel it's been augmented with these annotations with these labels",
    "start": "361710",
    "end": "368430"
  },
  {
    "text": "you'll see it's reached down into the metadata name and it's altered that name by prepending",
    "start": "368430",
    "end": "373650"
  },
  {
    "text": "this pre-production - prefix to it and it's placed it in this namespace a super",
    "start": "373650",
    "end": "380340"
  },
  {
    "text": "common workflow that's enabled by customized is this notion of overlays so perhaps you're you've got a team within",
    "start": "380340",
    "end": "386880"
  },
  {
    "text": "your company or you've pulled down something open-source or you're collaborating with someone they provide you a set of descriptors it's almost",
    "start": "386880",
    "end": "392669"
  },
  {
    "text": "what you need but you need to customize it you need to tailor it for each of your your various environments in some",
    "start": "392669",
    "end": "398550"
  },
  {
    "text": "specific ways so customized enables this via overlays and so base can contain",
    "start": "398550",
    "end": "404319"
  },
  {
    "text": "most of your descriptors and then in each environment you can specify the different changes you want to apply to",
    "start": "404319",
    "end": "409509"
  },
  {
    "text": "it so let's break this down what would that look like in practice I'm showing",
    "start": "409509",
    "end": "414610"
  },
  {
    "text": "an example here of three directories on a file system one it's called base another called production another called",
    "start": "414610",
    "end": "419800"
  },
  {
    "text": "staging base contains that similar simple pod specifier along with a base",
    "start": "419800",
    "end": "425380"
  },
  {
    "text": "customization yeah Mille and then in production and staging that's where each of the changes per environment are",
    "start": "425380",
    "end": "431199"
  },
  {
    "text": "applied to it what connects the two are the bases specifier that you see spouts that you see in the lower pink box where",
    "start": "431199",
    "end": "438550"
  },
  {
    "text": "it says basis and is referring back up on the file system to base and so if you're uncommon on this it will do what",
    "start": "438550",
    "end": "445449"
  },
  {
    "text": "you would expect it pulls in that base and it applies whatever change is not just a prefix but you can apply anything",
    "start": "445449",
    "end": "450520"
  },
  {
    "text": "that customize can do to whatever was contained in base and it has a sort of interesting recursive property that you",
    "start": "450520",
    "end": "456970"
  },
  {
    "text": "can take these simple primitives and compose very sophisticated capabilities and behaviors out of it you might also",
    "start": "456970",
    "end": "464409"
  },
  {
    "text": "want to do a mixin configuration and lift we have a sophisticated system that uses this mix in this mixing workflow",
    "start": "464409",
    "end": "472599"
  },
  {
    "text": "where basically you've got a bunch of different modules and there are many different deployment configurations that",
    "start": "472599",
    "end": "478690"
  },
  {
    "text": "are supported and for example what I'm showing here is you've got a UI module a back-end module and you might want to",
    "start": "478690",
    "end": "484870"
  },
  {
    "text": "deploy this in a headless configuration where you've got no UI or maybe you want to deploy it in the complete where",
    "start": "484870",
    "end": "490569"
  },
  {
    "text": "you're saying take all my modules and deploy them and so customized supports this this is very similar to the other",
    "start": "490569",
    "end": "497229"
  },
  {
    "text": "example we looked at if you'll notice at the bottom again these is referencing",
    "start": "497229",
    "end": "503259"
  },
  {
    "text": "basis but you'll notice that you can pull in more than one so by allowing you to pull in more than one base you can",
    "start": "503259",
    "end": "509979"
  },
  {
    "text": "sort of get this interesting mix in behavior and so in this example I've got this base modules directory that",
    "start": "509979",
    "end": "515050"
  },
  {
    "text": "contains all the modules in the complete",
    "start": "515050",
    "end": "520360"
  },
  {
    "text": "configuration and pulling in all of them and in headless I'm just pulling in the backend so you're right",
    "start": "520360",
    "end": "525399"
  },
  {
    "text": "run customize bill that will do what you would expect it pulls all those things in order them together and outputs it",
    "start": "525399",
    "end": "531720"
  },
  {
    "text": "when working with kubernetes especially if Leon you were probably surprised when",
    "start": "531900",
    "end": "536920"
  },
  {
    "text": "you made a change to a config map pushed it out and nothing happened customize can help with this as well so",
    "start": "536920",
    "end": "543399"
  },
  {
    "text": "there's a notion of a config map generator built in to customize where it enables you to externalize the contents",
    "start": "543399",
    "end": "550899"
  },
  {
    "text": "of your config maps so they can sit outside of ya mole files they can sit in for example files on the file system so",
    "start": "550899",
    "end": "556810"
  },
  {
    "text": "here in this example and config map generator within customization ya mole I'm saying DB params is going to be",
    "start": "556810",
    "end": "562779"
  },
  {
    "text": "defined by everything contained in this list of files in this case DB tamil so",
    "start": "562779",
    "end": "567850"
  },
  {
    "text": "that's one flavor of config map generator the other is the specification of just literals so I've got just",
    "start": "567850",
    "end": "572860"
  },
  {
    "text": "literal key value pairs where I'm specifying Java home and Java tools options so it would that look like",
    "start": "572860",
    "end": "579220"
  },
  {
    "text": "you're on customize build on that it's going to output something that looks like this where DB Tamil is pulled in",
    "start": "579220",
    "end": "586390"
  },
  {
    "text": "and you'll notice that the base name of the file DB Tamil becomes the key in the config map and the value is the",
    "start": "586390",
    "end": "591940"
  },
  {
    "text": "unstructured contents of the file you'll notice down below that literals are basically converted directly over to",
    "start": "591940",
    "end": "597490"
  },
  {
    "text": "their corresponding key value pairs and then maybe if you've got a sharp eye you've noticed that the name of the config map was altered and so that the",
    "start": "597490",
    "end": "604450"
  },
  {
    "text": "idea here is that there is a suffix appended to the config map name based on the hash of the contents of the config",
    "start": "604450",
    "end": "610660"
  },
  {
    "text": "map so any changes to the config map it will rotate the name of the config map and not only will it do that it will",
    "start": "610660",
    "end": "615790"
  },
  {
    "text": "find every other reference that you have to that config map within your specifiers and it'll update those linkages so the net effect is when you",
    "start": "615790",
    "end": "622390"
  },
  {
    "text": "change things within like for example DB Tamil and you run customize build again push that to cube cuddle apply it will",
    "start": "622390",
    "end": "629110"
  },
  {
    "text": "trigger a redeploy for you we'll look at examples of this so if you're not totally grokking all this as we go don't",
    "start": "629110",
    "end": "634270"
  },
  {
    "text": "worry super common use cases patching again maybe you've been provided a set",
    "start": "634270",
    "end": "639640"
  },
  {
    "text": "of descriptors and you you want to sort of reach down into the into the tree and",
    "start": "639640",
    "end": "644680"
  },
  {
    "text": "you want to add some content or change some content customize supports the",
    "start": "644680",
    "end": "650110"
  },
  {
    "text": "ability to apply patches so you'll notice on the right hand side and customize amel we have a list of patches",
    "start": "650110",
    "end": "655839"
  },
  {
    "text": "in this case I've just got one entry called request limits so that pod you'll recall it was very simple it had no",
    "start": "655839",
    "end": "661000"
  },
  {
    "text": "resource specifiers we were not specifying any request resources or limits and so what this does is it",
    "start": "661000",
    "end": "667240"
  },
  {
    "text": "provides a fragment this path provides enough of a fragment to identify where in the target yeah Mille",
    "start": "667240",
    "end": "673600"
  },
  {
    "text": "that you want to apply this patch and then it will be a strategic merge pull that in so if you're in custody",
    "start": "673600",
    "end": "680379"
  },
  {
    "text": "you'll see again the contents of that original pod spec listed unioned in with",
    "start": "680379",
    "end": "685660"
  },
  {
    "text": "those limits and request resources via strategic Marge we'll see more examples of this as well let's do a demo the the",
    "start": "685660",
    "end": "694299"
  },
  {
    "text": "paper I referred to earlier by Brian grant talks extensively about this fork modify rebase workflow this concept",
    "start": "694299",
    "end": "700749"
  },
  {
    "text": "where you can locate an upstream find some interesting animal descriptors that are located there fork the repo and then",
    "start": "700749",
    "end": "708489"
  },
  {
    "text": "start dropping in customization yeah Mille your patches your config Maps alongside the original descriptors",
    "start": "708489",
    "end": "715059"
  },
  {
    "text": "without altering that original file and then using customize to deploy this out to your environment and so that's",
    "start": "715059",
    "end": "721239"
  },
  {
    "text": "exactly what we're going to do we are going to use this it's kind of a github",
    "start": "721239",
    "end": "727179"
  },
  {
    "text": "clone called git T that is actually surprisingly capable it's an interesting product I recommend you take a look at",
    "start": "727179",
    "end": "733059"
  },
  {
    "text": "it but it's good for our purposes because they shipped with they happen to ship with a default descriptor that",
    "start": "733059",
    "end": "738970"
  },
  {
    "text": "we're gonna take that descriptor and we're gonna I forked this whole repo so if you if you got to get up calm slash",
    "start": "738970",
    "end": "744189"
  },
  {
    "text": "Ryan Cox I've pinned that on that fork up there at the top and I've created a couple of branches where I've started to",
    "start": "744189",
    "end": "751269"
  },
  {
    "text": "apply in various behaviors that we will compose and deploy out to gke and and",
    "start": "751269",
    "end": "756459"
  },
  {
    "text": "see how this all works ultimately we want to build up to it kind of a non toy non-trivial work workload that looks",
    "start": "756459",
    "end": "762999"
  },
  {
    "text": "something like this we want to basically tap into some of the other cloud resources that are provided giddy",
    "start": "762999",
    "end": "768639"
  },
  {
    "text": "supports a bunch of different backends will our an initial version will deploy with sequel Lite a subsequent version",
    "start": "768639",
    "end": "774730"
  },
  {
    "text": "will we'll use cloud sequel and a hosted Redis store the first thing that we'll will do though is we will use persistent",
    "start": "774730",
    "end": "780970"
  },
  {
    "text": "disks so the example that's provided by default it actually wouldn't even work if we tried to apply it because it's",
    "start": "780970",
    "end": "786399"
  },
  {
    "text": "using it's using some hosts paths that don't exist on my nodes so that's our first goal our first goal is to just get",
    "start": "786399",
    "end": "792879"
  },
  {
    "text": "this thing working in gke and you get it using persistent disks then we'll layer",
    "start": "792879",
    "end": "798279"
  },
  {
    "text": "on to ha on top of that some more complexity if we have time we'll show something a little bit more fancy let's talk about service mashes I'll",
    "start": "798279",
    "end": "804850"
  },
  {
    "text": "talk about envoy or get lift we sprinkle envoy on all our problems so I want to",
    "start": "804850",
    "end": "811240"
  },
  {
    "text": "show an example of how you can use customize to inject an envoy sidecar into an existing pod spec and this is an",
    "start": "811240",
    "end": "817449"
  },
  {
    "text": "interesting use case because maybe some of you are using mutating webhooks to do this course sort of thing on on pod",
    "start": "817449",
    "end": "823449"
  },
  {
    "text": "deploy this shows kind of a different approach where if you're using get up so you could actually sort of like inject it into your EML check that in and",
    "start": "823449",
    "end": "829990"
  },
  {
    "text": "deploy it out so this is maybe like an idea virus I'm hoping to put out there into the universe and see it fully",
    "start": "829990",
    "end": "835180"
  },
  {
    "text": "formed by someone else but the general ideas will inject this thing and we'll access it via 9211 and see how that",
    "start": "835180",
    "end": "841420"
  },
  {
    "text": "works okay so let's go to the demo this demo is a little bit elaborate so I'm",
    "start": "841420",
    "end": "848829"
  },
  {
    "text": "hoping that the demo gods are smiling on me let's take a look first at this repo",
    "start": "848829",
    "end": "854350"
  },
  {
    "text": "here so this is the repo for the the application that we're going to deploy out to our gke cluster and you'll notice",
    "start": "854350",
    "end": "861100"
  },
  {
    "text": "down here and contributes they've got this yellow file this is like pretty vanilla there's nothing too surprising",
    "start": "861100",
    "end": "866290"
  },
  {
    "text": "here they define a namespace hopefully you can see that this image is little bit more a deployment that deployment",
    "start": "866290",
    "end": "872350"
  },
  {
    "text": "has a pods back with a single container in it some vol mounts root and data wall",
    "start": "872350",
    "end": "877779"
  },
  {
    "text": "mounts these will become important to us as we start to adapt to this thing they expose out a couple of different ports",
    "start": "877779",
    "end": "882939"
  },
  {
    "text": "and here's the the first problem is we want to get rid of this this is bad this is gonna cause us some problems we don't",
    "start": "882939",
    "end": "888519"
  },
  {
    "text": "want hose paths we want to use these persistent disks okay so that's that's",
    "start": "888519",
    "end": "893920"
  },
  {
    "text": "what we're gonna start with let me show you my environment out in Google cloud",
    "start": "893920",
    "end": "899920"
  },
  {
    "text": "so I've got this coop con cluster actually I can just go back here but",
    "start": "899920",
    "end": "907600"
  },
  {
    "text": "this cube con cluster that is got three nodes on it through BBC three vc views and a few gigs of memory so that's what",
    "start": "907600",
    "end": "915879"
  },
  {
    "text": "we're going to play all this stuff on to let's go into the file system here so I'm out on the file system I'm in the",
    "start": "915879",
    "end": "922240"
  },
  {
    "text": "fork and I'm on master right now this this is looks just like what we looked at while we were browsing right through",
    "start": "922240",
    "end": "927879"
  },
  {
    "text": "github now I'm going to check out demo",
    "start": "927879",
    "end": "934540"
  },
  {
    "text": "step one okay so demo step one has a few more files in this directory so again this",
    "start": "934540",
    "end": "941049"
  },
  {
    "text": "concept I've mentioned is twice but I just want to reiterate this the original get diamo file is untouched we just",
    "start": "941049",
    "end": "946899"
  },
  {
    "text": "leave that there and we drop in other files alongside it in the file system to compose this behavior and for customized",
    "start": "946899",
    "end": "952600"
  },
  {
    "text": "during the build phase okay so that's untouched we never touch that and in fact later on we might want to come back and rebase our our Fork and pull in all",
    "start": "952600",
    "end": "961269"
  },
  {
    "text": "these changes and that has an interesting property of never having never having a git conflict when you",
    "start": "961269",
    "end": "967239"
  },
  {
    "text": "rebase because we never touch the original descriptor that makes sense so there's some interesting power here",
    "start": "967239",
    "end": "973179"
  },
  {
    "text": "in this model so we've dropped this in we have a customization llamó file and",
    "start": "973179",
    "end": "979739"
  },
  {
    "text": "we're telling it put everything in this namespace pull in the original yeah male",
    "start": "979739",
    "end": "986499"
  },
  {
    "text": "descriptor alongside a new one that I've proposed this has some persistent volume claims in it that refer out to those",
    "start": "986499",
    "end": "991929"
  },
  {
    "text": "disks a patch this basically what we'll take a look at this in more detail here",
    "start": "991929",
    "end": "997629"
  },
  {
    "text": "in a second through a little easier to see interface two patches one patch that use a strategic merge and the other this",
    "start": "997629",
    "end": "1004589"
  },
  {
    "text": "is a bit of a criticism of this tool which usually very confusingly named patches JSON 6900 - very bad product",
    "start": "1004589",
    "end": "1013649"
  },
  {
    "text": "name they're made some p.m. on this I think but the general idea is this was referring to RFC 69 Oh - and the RFC",
    "start": "1013649",
    "end": "1020220"
  },
  {
    "text": "that tells you how you can apply a patch to to JSON in in very sophisticated ways",
    "start": "1020220",
    "end": "1026279"
  },
  {
    "text": "and so we need this we need more sophisticated ways actually let me let",
    "start": "1026279",
    "end": "1031350"
  },
  {
    "text": "me pop back to the diff to show you why we need this so I'm showing you a delta between master and demo step one branch",
    "start": "1031350",
    "end": "1038188"
  },
  {
    "text": "that makes sense okay so this is the same thing on the file system I'm just showing you a few so that it's just",
    "start": "1038189",
    "end": "1043350"
  },
  {
    "text": "showing you what I've added all right so that's the customization file that we just looked at this ball mount patch is",
    "start": "1043350",
    "end": "1050340"
  },
  {
    "text": "the piece that's needed to get a little bit fancier so instead of a strategic merge of just adding new volumes in what",
    "start": "1050340",
    "end": "1056460"
  },
  {
    "text": "we want to do is you would think about like reaching down into that original yamo and just snipping off with a pair of scissors all those volumes that were",
    "start": "1056460",
    "end": "1063000"
  },
  {
    "text": "specified and replacing it with a new set of volume specifiers okay we need",
    "start": "1063000",
    "end": "1068250"
  },
  {
    "text": "that because we don't want to do is additively we want to just replace it and so it supports a relatively",
    "start": "1068250",
    "end": "1074640"
  },
  {
    "text": "sophisticated ability to provide an op type we can do replace and then this looks kind of XPath like users passing",
    "start": "1074640",
    "end": "1080910"
  },
  {
    "text": "down into that object graph and saying operate on volumes and then replace what's there with what's provided below",
    "start": "1080910",
    "end": "1087030"
  },
  {
    "text": "so again our goal our goal we're not beating towards is to use these persistent disks and so this reference",
    "start": "1087030",
    "end": "1092160"
  },
  {
    "text": "is the PBC's that we've defined that we've defined and have made one other",
    "start": "1092160",
    "end": "1097890"
  },
  {
    "text": "small change this other patch says change the original deployment to a strategy type of a recreate and it did",
    "start": "1097890",
    "end": "1103290"
  },
  {
    "text": "this for demo purposes I wanted the original persistent disks to stay there I didn't want new pods to be spun up and",
    "start": "1103290",
    "end": "1109980"
  },
  {
    "text": "new disks to be stomped I wanted to retain those disks and destroy the pods and recreate hopefully everybody's with",
    "start": "1109980",
    "end": "1116460"
  },
  {
    "text": "me on this okay so over on the filesystem customize build and",
    "start": "1116460",
    "end": "1123450"
  },
  {
    "text": "everything goes to standard out let's make that look a little nicer so we can",
    "start": "1123450",
    "end": "1129480"
  },
  {
    "text": "we can just look through this and see what's going on here here's our new persistent volume claims nothing too",
    "start": "1129480",
    "end": "1135420"
  },
  {
    "text": "surprising there here's our service definition that exposes the port's as SH HTTP here's our deployment specifier you",
    "start": "1135420",
    "end": "1144540"
  },
  {
    "text": "can see that if that patch has been applied to there's recreate that's the recreate patch that was applied into the original deployment and here we know",
    "start": "1144540",
    "end": "1153480"
  },
  {
    "text": "that our or our fancy patch we could call it worked because it's replaced it with the person blind claims there's no",
    "start": "1153480",
    "end": "1159630"
  },
  {
    "text": "reference to that original host path okay and then we had to do one other thing there's a new storage class that's",
    "start": "1159630",
    "end": "1165510"
  },
  {
    "text": "defined this says this is because we're on gzp we're saying use the where is it",
    "start": "1165510",
    "end": "1172290"
  },
  {
    "text": "specified we're saying use yeah here it is we use this provisioner here we want to use the GCE persistence this",
    "start": "1172290",
    "end": "1177600"
  },
  {
    "text": "provisioner and we want to retain those disks that are created this is for demo purposes so we don't want to blow away",
    "start": "1177600",
    "end": "1182670"
  },
  {
    "text": "those disks but it will just keep them there rather than trying to recreate them so to kick us off I actually have",
    "start": "1182670",
    "end": "1188070"
  },
  {
    "text": "this this working here I'm just going to port forward in onto port 3000 and the",
    "start": "1188070",
    "end": "1194340"
  },
  {
    "text": "way we'll know this works is if I hit refresh here and we see a screen that looks good huh bit yeah github like",
    "start": "1194340",
    "end": "1201210"
  },
  {
    "text": "there we are okay so that we're good so we can sign in and everything",
    "start": "1201210",
    "end": "1209460"
  },
  {
    "text": "looks good this checks out so that worked that's fantastic but let's convince ourselves that this really did",
    "start": "1209460",
    "end": "1216450"
  },
  {
    "text": "works I'm gonna go pop back into the Google console and I'm gonna look at storage I will zoom in here a little bit",
    "start": "1216450",
    "end": "1223350"
  },
  {
    "text": "for you and you'll see I've got data and root so those are the persons and volume claims that were specified in REM all",
    "start": "1223350",
    "end": "1230040"
  },
  {
    "text": "kicked out to that that a GCE provision are provisioned up and mounted back into the pods that we deployed we can take a",
    "start": "1230040",
    "end": "1237690"
  },
  {
    "text": "little bit closer look into the the pot itself so if we click in we've got single deployment that deployment again",
    "start": "1237690",
    "end": "1243870"
  },
  {
    "text": "has a single pod drilling into the pod you know some details about the pod",
    "start": "1243870",
    "end": "1249210"
  },
  {
    "text": "things things sort of look look good and unsurprising here here's our services exporting those same ports okay good so",
    "start": "1249210",
    "end": "1259260"
  },
  {
    "text": "I think that's good for step one but remember what we're navigating towards is this we want to do more fancy things",
    "start": "1259260",
    "end": "1264960"
  },
  {
    "text": "so we want to use not sequel Lite but we want to use a real database we may just",
    "start": "1264960",
    "end": "1270300"
  },
  {
    "text": "Postgres so let's let's point it at cloud sequel and we want to use a hosted Redis instance as well so git T supports",
    "start": "1270300",
    "end": "1276540"
  },
  {
    "text": "using using Redis as a caching layer and to store our credentials for the database we want to use KMS and GCE as",
    "start": "1276540",
    "end": "1283170"
  },
  {
    "text": "well and so we do all those things in the next branch so let's check that out",
    "start": "1283170",
    "end": "1290390"
  },
  {
    "text": "step two so I just checked out step two looks very similar I've got a couple of",
    "start": "1290570",
    "end": "1295830"
  },
  {
    "text": "extra files here that you might notice specifically I'm probably most importantly for this part of the demo is app dot ini' so giddy allows you to",
    "start": "1295830",
    "end": "1303600"
  },
  {
    "text": "configure it in very sophisticated ways with this initialization file so this is nothing to do burn Eddie's nothing to",
    "start": "1303600",
    "end": "1309360"
  },
  {
    "text": "customize this is has everything to do with the application that we are deploying and tailoring to our specific",
    "start": "1309360",
    "end": "1315480"
  },
  {
    "text": "needs so there's that and then there's PC cool that's secret so this is an encrypted binary file that is decrypted",
    "start": "1315480",
    "end": "1322560"
  },
  {
    "text": "at customized build time and I'll show you how that works here so again I'm",
    "start": "1322560",
    "end": "1328200"
  },
  {
    "text": "going to pop out to a diff so this time we're dipping step one and step two so",
    "start": "1328200",
    "end": "1334890"
  },
  {
    "text": "this is again there's just a kind of I isolate the differences in what the the steps are on our demo coming back down",
    "start": "1334890",
    "end": "1342420"
  },
  {
    "text": "to customize so what we're doing here is really mostly configuration in this step we're using this config map generator",
    "start": "1342420",
    "end": "1348600"
  },
  {
    "text": "that I referenced earlier as we were looking at the various features and we're saying pull in AP and I'm off the",
    "start": "1348600",
    "end": "1353640"
  },
  {
    "text": "file system map it into a config map called AB dash config and then we're using something called secret generator",
    "start": "1353640",
    "end": "1359070"
  },
  {
    "text": "which I have not talked about but is very very similar to a config nap generator it lets you basically run a",
    "start": "1359070",
    "end": "1364320"
  },
  {
    "text": "command take the output of the standard out of that command and load it into a kubernetes secret and so this is calling",
    "start": "1364320",
    "end": "1370650"
  },
  {
    "text": "g-cloud cam as decrypt and you should see that piece equal dot secret so that's the encrypted binary file sitting",
    "start": "1370650",
    "end": "1376620"
  },
  {
    "text": "my filesystem that's checked out checked into this branch specify the key ring and the key running this will emit a",
    "start": "1376620",
    "end": "1384480"
  },
  {
    "text": "secret just a few characters that is the password to the database that gets pulled into a secret called password and",
    "start": "1384480",
    "end": "1391020"
  },
  {
    "text": "we'll see that in a couple of different places so that's effectively what's gonna happen when we deploy this this",
    "start": "1391020",
    "end": "1397100"
  },
  {
    "text": "deployment patch specifies a couple things nothing too fancy here we're just telling the Getty app to go out and look",
    "start": "1397100",
    "end": "1403440"
  },
  {
    "text": "for its custom app any in that directory and then we're saying inject PG password",
    "start": "1403440",
    "end": "1409500"
  },
  {
    "text": "into the environment from this secret RAF Postgres password and so the the",
    "start": "1409500",
    "end": "1414660"
  },
  {
    "text": "Postgres library that this system uses happens to look for this PG password and so it's a convenient way to get",
    "start": "1414660",
    "end": "1419880"
  },
  {
    "text": "credentials into the system without putting in law files list or doing something on there like this so that",
    "start": "1419880",
    "end": "1425610"
  },
  {
    "text": "just happen to work out easily here and then we're mat where vomiting that config map in here the a penny I'm not",
    "start": "1425610",
    "end": "1432660"
  },
  {
    "text": "going to go through this in detail I want to point out just maybe two or three things one is the default theme arc green so you notice before it was",
    "start": "1432660",
    "end": "1438480"
  },
  {
    "text": "white so if things work in a moment here I'm gonna apply this out to that cluster I'm gonna hit refresh and the way you're",
    "start": "1438480",
    "end": "1443610"
  },
  {
    "text": "gonna know this worked is if it goes into this dark mode so cross your fingers then I specify Redis here this",
    "start": "1443610",
    "end": "1451050"
  },
  {
    "text": "is the address of a hosted reticence since I've got a GCE in that account and if we scroll a little further we see",
    "start": "1451050",
    "end": "1457890"
  },
  {
    "text": "it's not using sequel Lite we're saying use post grass and that's the cloud sequel database I'm I've got in my",
    "start": "1457890",
    "end": "1463320"
  },
  {
    "text": "account and the the password that it's that it's provisioned up or the IP rather for that for that database okay",
    "start": "1463320",
    "end": "1470190"
  },
  {
    "text": "so customize build this looks just like",
    "start": "1470190",
    "end": "1476440"
  },
  {
    "text": "the example I gave build we're gonna pipe it straight into coop cuddle apply",
    "start": "1476440",
    "end": "1481500"
  },
  {
    "text": "get pods okay so this is this this is triggering a redeployment so that that",
    "start": "1484320",
    "end": "1490540"
  },
  {
    "text": "pod is terminating new ones are spinning up should say running second here this",
    "start": "1490540",
    "end": "1503320"
  },
  {
    "text": "is a dramatic dramatic pause",
    "start": "1503320",
    "end": "1506759"
  },
  {
    "text": "running okay you didn't think I was gonna work I'm gonna report forward that",
    "start": "1511450",
    "end": "1517300"
  },
  {
    "text": "and I'm gonna pop over here and if i refresh this white theme should go to",
    "start": "1517300",
    "end": "1522310"
  },
  {
    "text": "dark and that will tell us like everything work that'll tell us that the theme worked and our database conductivity worked and there we are in",
    "start": "1522310",
    "end": "1528040"
  },
  {
    "text": "dark mode let's sign back in and this is",
    "start": "1528040",
    "end": "1535210"
  },
  {
    "text": "slightly different because this is now actually pointing out to the database and it's using this state from my from my previous invitations of this but we",
    "start": "1535210",
    "end": "1543010"
  },
  {
    "text": "can convince ourselves that this is working by looking at the applications configuration itself and just zoom in on",
    "start": "1543010",
    "end": "1550030"
  },
  {
    "text": "this a little bit you can see the application is telling us in its config page for the admins this is using",
    "start": "1550030",
    "end": "1555160"
  },
  {
    "text": "Postgres so we know that Postgres piece worked we know the Redis piece worked as well as telling you that the rightest thing",
    "start": "1555160",
    "end": "1561460"
  },
  {
    "text": "worked if we hop over to the console the",
    "start": "1561460",
    "end": "1566530"
  },
  {
    "text": "cloud console we can see some other interesting things so before I believe I showed you these or if I show this or",
    "start": "1566530",
    "end": "1573610"
  },
  {
    "text": "not but these are the the PVCs that were provisioned up the volumes we can go back and look at the config maps so this",
    "start": "1573610",
    "end": "1579610"
  },
  {
    "text": "stage of the demo actually went out and created those config maps remember the config maps get unique names and so what",
    "start": "1579610",
    "end": "1585280"
  },
  {
    "text": "do you notice here you notice that these config maps are sort of piling up right because every every time they change and",
    "start": "1585280",
    "end": "1590620"
  },
  {
    "text": "get deployed a new one gets created and so there's a couple ways of addressing this you could create some sort of garbage collection thing you could be",
    "start": "1590620",
    "end": "1597970"
  },
  {
    "text": "brave as well and use the coop cuttle applied after - prune if you're familiar at that Josh prune and you can give it a label and it will sort of clean things",
    "start": "1597970",
    "end": "1604240"
  },
  {
    "text": "up for you but I'm sort of I'm letting me stack up more for demo purposes than anything I'll click into this Postgres",
    "start": "1604240",
    "end": "1610750"
  },
  {
    "text": "secret and we should be able to see something that says password here",
    "start": "1610750",
    "end": "1617100"
  },
  {
    "text": "browser",
    "start": "1619140",
    "end": "1622140"
  },
  {
    "text": "so here's password so hopefully you can see sort of how this this secret threaded its way all the way through it",
    "start": "1634320",
    "end": "1639870"
  },
  {
    "text": "pulled it off the filesystem g-cloud KMS decrypt it pulled it into the the the",
    "start": "1639870",
    "end": "1645060"
  },
  {
    "text": "yeah mail descriptor and then when we deployed it out it pushed it out provisioned up this new kubernetes secret that is then mounted into the the",
    "start": "1645060",
    "end": "1652560"
  },
  {
    "text": "the environment of this application and used to go out and authenticate against the database okay so that all looks good",
    "start": "1652560",
    "end": "1660090"
  },
  {
    "text": "looks like we have time so let's let's do the the third step here demo step",
    "start": "1660090",
    "end": "1668970"
  },
  {
    "text": "three again very similar stuff on the filesystem you'll notice envoy I mentioned twice here so I've got an",
    "start": "1668970",
    "end": "1674430"
  },
  {
    "text": "envoy patch and this envoy patches the piece that says add a new container to that pod spec and envoy llamo is the",
    "start": "1674430",
    "end": "1681600"
  },
  {
    "text": "configuration for envoy itself this is not kubernetes related this is not customized related this is what envoy",
    "start": "1681600",
    "end": "1688260"
  },
  {
    "text": "needs in order to forward things around so let's let's take a look at the deltas",
    "start": "1688260",
    "end": "1693350"
  },
  {
    "text": "so this this compares branch two and three coming up to the top here so envoy",
    "start": "1693350",
    "end": "1699420"
  },
  {
    "text": "patch this is the piece that actually injects the container so the patch says reach down into this deployment and add",
    "start": "1699420",
    "end": "1707640"
  },
  {
    "text": "via strategic merge this envoy container here's the you notice it's envoy alpine and expose off port 9211 remember from",
    "start": "1707640",
    "end": "1716130"
  },
  {
    "text": "our diagram what our goal is here our goal is to come in from 9211 have envoy forward us across here and we get all",
    "start": "1716130",
    "end": "1723210"
  },
  {
    "text": "the benefits of envoy what are the benefits the benefits are this is the building blocks of a service mesh so i",
    "start": "1723210",
    "end": "1729420"
  },
  {
    "text": "have a service match you're gonna need something like this but even independent of a service mesh you get some interesting properties out of this you",
    "start": "1729420",
    "end": "1735210"
  },
  {
    "text": "get very very rich uniform observability by injecting sidecars like this so you could emit stats from from a",
    "start": "1735210",
    "end": "1741570"
  },
  {
    "text": "configuration like this to your observability systems similarly with logs even the you get",
    "start": "1741570",
    "end": "1748620"
  },
  {
    "text": "interesting behavior like you could tap into the rate-limiting capabilities or a circuit braking capabilities well boy",
    "start": "1748620",
    "end": "1754470"
  },
  {
    "text": "this is a really really rich potential to you know implement this sort of thing",
    "start": "1754470",
    "end": "1759930"
  },
  {
    "text": "so that's that and then here's the envoy llamo this is about the as simple as you",
    "start": "1759930",
    "end": "1765420"
  },
  {
    "text": "could possibly get for an envoy config on voice configurations can be quite complicated this basically",
    "start": "1765420",
    "end": "1770970"
  },
  {
    "text": "says listen on all IPS support 9211 and forward those two for 3000 on localhost",
    "start": "1770970",
    "end": "1778169"
  },
  {
    "text": "and so since these are in the same pod localhost forwards over to the existing application container okay hopefully",
    "start": "1778169",
    "end": "1784649"
  },
  {
    "text": "that makes sense there's a reference to the patch and customization Hamill's so",
    "start": "1784649",
    "end": "1789768"
  },
  {
    "text": "let's just apply it so I applied it I'm",
    "start": "1790909",
    "end": "1800399"
  },
  {
    "text": "watching the pods terminating creating",
    "start": "1800399",
    "end": "1805879"
  },
  {
    "text": "so the way I know this is going to work is if I go back to that browser window and I change the port from 3,000 to 92",
    "start": "1806240",
    "end": "1812039"
  },
  {
    "text": "11 and if things work then we know we're transiting through the sidecar and we're hitting the original application so down",
    "start": "1812039",
    "end": "1819749"
  },
  {
    "text": "here I have been port forwarding 3000 so I'm just going to change this to 92 11 okay we're up my port forward is up and",
    "start": "1819749",
    "end": "1828029"
  },
  {
    "text": "I can go over here I can change this to 92 11 and the sidecar works okay so we",
    "start": "1828029",
    "end": "1836940"
  },
  {
    "text": "know that's working because otherwise we would just get like errors here so hopefully that gives you a taste for",
    "start": "1836940",
    "end": "1842279"
  },
  {
    "text": "some of the primitives that exist in customize as a tool lots of places you",
    "start": "1842279",
    "end": "1848129"
  },
  {
    "text": "can go for additional info the original github repo is probably the canonical place to start the declarative app dock",
    "start": "1848129",
    "end": "1854039"
  },
  {
    "text": "is really good six CLI goes deeply into customize in its future there are some",
    "start": "1854039",
    "end": "1859649"
  },
  {
    "text": "caps on this on the kubernetes slack there's a customized channel Jeff one of",
    "start": "1859649",
    "end": "1864899"
  },
  {
    "text": "the key maintainer 'he's also recorded to talk on this you can find it on YouTube and there's interesting integration with other tools as well",
    "start": "1864899",
    "end": "1870600"
  },
  {
    "text": "there's a company called replicated doing some cool stuff with this cube builder automatically kicks out support",
    "start": "1870600",
    "end": "1875639"
  },
  {
    "text": "for customized and scaffold as well so scaffold is a development tool for that",
    "start": "1875639",
    "end": "1881249"
  },
  {
    "text": "your development workflow your sort of inner loop and that actually has support for customized deployments as well so",
    "start": "1881249",
    "end": "1886830"
  },
  {
    "text": "lots of other places to go quickly worth mentioning the road ahead coop cuddle",
    "start": "1886830",
    "end": "1892289"
  },
  {
    "text": "this support has get support for customized basically customized is getting merged into coop cuddle you can read this this cap here",
    "start": "1892289",
    "end": "1898559"
  },
  {
    "text": "I was just talk to him ed literally before I walked up on the stage and he was telling me that these there are PRS out there right now",
    "start": "1898559",
    "end": "1904330"
  },
  {
    "text": "that will be merged in a few days time probably and this should land in you know",
    "start": "1904330",
    "end": "1910350"
  },
  {
    "text": "kubernetes V dot next so so that's happening and then just I would",
    "start": "1910350",
    "end": "1915940"
  },
  {
    "text": "encourage you to think about some of the the primitives and then interesting workflows and sort of separate those things so customized is a simple tool",
    "start": "1915940",
    "end": "1922030"
  },
  {
    "text": "it's a command-line tool but it implements some very interesting primitives that can be composed into",
    "start": "1922030",
    "end": "1927790"
  },
  {
    "text": "very sophisticated workflows so I think could you go take two take a look at it if you want to find out more I want to talk about it I'm around the conference",
    "start": "1927790",
    "end": "1933790"
  },
  {
    "text": "all week so thank you very much about",
    "start": "1933790",
    "end": "1942880"
  },
  {
    "text": "three minutes for questions if there any questions yeah right go ahead",
    "start": "1942880",
    "end": "1947700"
  },
  {
    "text": "yet so the question is is like there's the different schools of thought there's charts and there's Yamma which do I use",
    "start": "1959990",
    "end": "1965340"
  },
  {
    "text": "in it Lancers why not both why not both so Google around for some examples that",
    "start": "1965340",
    "end": "1970710"
  },
  {
    "text": "have been created of taking helm output and using customize on it so the challenge you'll have is if you want to",
    "start": "1970710",
    "end": "1975750"
  },
  {
    "text": "use customize in the way I've just described you have to go find up streams that are publishing amal descriptors and those are very far and few between",
    "start": "1975750",
    "end": "1981629"
  },
  {
    "text": "however what's much more common are charts that will output llamo so I would encourage you to sort of like take a",
    "start": "1981629",
    "end": "1986639"
  },
  {
    "text": "look at like maybe fusing those two things yeah it does it does know about",
    "start": "1986639",
    "end": "1998220"
  },
  {
    "text": "that yeah if you if you dig into the source code of customize it it has special sorting that will will create things in the order necessary other",
    "start": "1998220",
    "end": "2006799"
  },
  {
    "text": "questions yes",
    "start": "2006799",
    "end": "2009490"
  },
  {
    "text": "well what's the question so it depends",
    "start": "2022490",
    "end": "2031340"
  },
  {
    "text": "on it depends so the question is is like I made the statement that when you when you rebase your fork you want to merge conflicts which is true the development",
    "start": "2031340",
    "end": "2037940"
  },
  {
    "text": "was made there like still things might not work is that your point yeah so it depends on when you run customize build",
    "start": "2037940",
    "end": "2044059"
  },
  {
    "text": "do you run it at deploy time when some end users clicking on deploy or do you run it and check the results in to get",
    "start": "2044059",
    "end": "2050628"
  },
  {
    "text": "so if you if you run and check the results in to get then you could diff the results between indications of",
    "start": "2050629",
    "end": "2056450"
  },
  {
    "text": "customized build so that hopefully answer your question yeah sure yeah the",
    "start": "2056450",
    "end": "2075020"
  },
  {
    "text": "I didn't show it but basically the kubernetes the the secret was there and it was on encrypt it was basically",
    "start": "2075020",
    "end": "2080118"
  },
  {
    "text": "foreign coated so yeah valid point secret handling is a larger topic yeah okay correct I suspect you probably use",
    "start": "2080119",
    "end": "2090888"
  },
  {
    "text": "something like vault if you're really doing is for reals yeah yep",
    "start": "2090889",
    "end": "2095679"
  },
  {
    "text": "I don't stripe all that kind of a question is there a validation concept",
    "start": "2101250",
    "end": "2106430"
  },
  {
    "text": "which in point oh I see I mean it will",
    "start": "2110180",
    "end": "2116580"
  },
  {
    "text": "air out if we can't resolve one of the one of the dependencies I'd okay",
    "start": "2116580",
    "end": "2124410"
  },
  {
    "text": "possible yes",
    "start": "2124410",
    "end": "2127730"
  },
  {
    "text": "no but you mean again it's to be composed in with other tools so I would encourage you to look at something like",
    "start": "2130670",
    "end": "2135780"
  },
  {
    "text": "cube Bell to validate the actual output or some like generic yamo validator as well okay looks like at a time we can",
    "start": "2135780",
    "end": "2144210"
  },
  {
    "text": "fine me down here if you want to talk more about it thank you very much [Applause]",
    "start": "2144210",
    "end": "2150889"
  }
]