[
  {
    "text": "hello everyone thanks for coming uh my name is Benjamin Elder and this is Antonio hea we're both senior software",
    "start": "399",
    "end": "6359"
  },
  {
    "text": "engineers at Google and our talk is on keep calm and load balance with",
    "start": "6359",
    "end": "11360"
  },
  {
    "text": "kind so what is kind kind is kubernetes and Docker um it's a tool that we",
    "start": "11360",
    "end": "19000"
  },
  {
    "text": "built for testing the kubernetes project initially um it uses Docker containers",
    "start": "19000",
    "end": "25640"
  },
  {
    "text": "to simulate nodes so you can run them locally and it can build and run kubernetes from sour as long as as well",
    "start": "25640",
    "end": "31320"
  },
  {
    "text": "as some pre-built images it boots a cluster in 30 seconds because everything is packed into the container and running",
    "start": "31320",
    "end": "38360"
  },
  {
    "text": "locally um this was really important for us for the kubernetes project to have very cheap fast local testing because we",
    "start": "38360",
    "end": "44320"
  },
  {
    "text": "need to test changes of kubernetes constantly it's minimal but fully",
    "start": "44320",
    "end": "51399"
  },
  {
    "text": "conformant want something is simple and streamlined uh and flexible it has multi- Noe support which",
    "start": "51399",
    "end": "59199"
  },
  {
    "text": "is required to actually run all of the conformance tests properly because there's some tests around rolling node",
    "start": "59199",
    "end": "64879"
  },
  {
    "text": "behavior and it has persistent volume support everything else comes from",
    "start": "64880",
    "end": "70600"
  },
  {
    "text": "kubernetes core itself and the rest is just getting those to run we have a very very minimal",
    "start": "70600",
    "end": "77759"
  },
  {
    "text": "lightweight networking agent called KET D it just ensures that pods are ratable between nodes with the minimal simplest",
    "start": "77759",
    "end": "85560"
  },
  {
    "text": "cni there's no load balancer and no Ingress we have bring your own and some",
    "start": "85560",
    "end": "91079"
  },
  {
    "text": "docks for that so that's where the project is coming from it looks a little bit like this so",
    "start": "91079",
    "end": "98600"
  },
  {
    "text": "you've got Docker running on your host within each Docker container for the node we have system D because we",
    "start": "98600",
    "end": "105280"
  },
  {
    "text": "need an anit process for kubernetes uh we're running container D and we have a",
    "start": "105280",
    "end": "110920"
  },
  {
    "text": "bunch of images for all the kubernetes project and the binaries we run cubet",
    "start": "110920",
    "end": "116479"
  },
  {
    "text": "and our KET depod and everything else is standard kubernetes so you have some cord Paws Cube proxy Cube controller",
    "start": "116479",
    "end": "123159"
  },
  {
    "text": "manager etcd Cube API server and your user workloads and these are in nested",
    "start": "123159",
    "end": "129280"
  },
  {
    "text": "containers um if you're familiar with Docker and Docker it's the same idea in kubernetes CI we actually run on",
    "start": "129280",
    "end": "137000"
  },
  {
    "text": "kubernetes so we wind up with um container D and Docker in container",
    "start": "137000",
    "end": "144760"
  },
  {
    "text": "D it's it's it works I I I don't recommend it but it it solved our",
    "start": "144760",
    "end": "152480"
  },
  {
    "text": "problems so as I said it supports multi Noe which looks something like this",
    "start": "152959",
    "end": "158319"
  },
  {
    "text": "spread across if you have a single node we'll just untaint the node and you can run your workloads there and for most",
    "start": "158319",
    "end": "163800"
  },
  {
    "text": "application testing that's what's appropriate but for testing kubernetes we really need to test Behavior across",
    "start": "163800",
    "end": "169000"
  },
  {
    "text": "nodes so it looks like a pretty standard Cub adom cluster it's powered by Cub Adam you've got a control plane node and",
    "start": "169000",
    "end": "175879"
  },
  {
    "text": "you've got some worker nodes standard kubernetes for for networking we have some really simple",
    "start": "175879",
    "end": "183440"
  },
  {
    "text": "stuff as I said it's a Docker Bridge Network and we're using uh V8 pairs with very simple standard cni plugins and",
    "start": "183440",
    "end": "190480"
  },
  {
    "text": "then just a small agent that handles some things like IP masquerade that are necessary to get traffic working in and",
    "start": "190480",
    "end": "196560"
  },
  {
    "text": "out of these nodes um you can see the IP tables fire here uh if you've ever",
    "start": "196560",
    "end": "202159"
  },
  {
    "text": "worked with IP tables containerized you'll know what we're talking about um",
    "start": "202159",
    "end": "207319"
  },
  {
    "text": "when you run IP tables the API is some user space binaries",
    "start": "207319",
    "end": "213120"
  },
  {
    "text": "there's not really a kernel API you're supposed to use but it kind of needs to match and over time it's actually moved",
    "start": "213120",
    "end": "218239"
  },
  {
    "text": "away from being backed by IP tables to being backed by NF tables and uh you",
    "start": "218239",
    "end": "223959"
  },
  {
    "text": "really need that to match what's happening on your host we have a little bit of magic in the entry point um Cod developed with the cor kubernetes",
    "start": "223959",
    "end": "230280"
  },
  {
    "text": "project to detect which one is in use and switch to the right one and try to match three layers down from your host",
    "start": "230280",
    "end": "237680"
  },
  {
    "text": "to the kind node to the cube proxy running inside the kind node a little bit of a fire but it works pretty simple",
    "start": "237680",
    "end": "244560"
  },
  {
    "text": "for the most part so since 2019 um Antonio my",
    "start": "244560",
    "end": "250280"
  },
  {
    "text": "co-maintainer and I have been talking about we should really have an actual load balance or implementation so we can",
    "start": "250280",
    "end": "257280"
  },
  {
    "text": "test these other things like we started with the conformance test that got us a lot of great coverage but there's a lot",
    "start": "257280",
    "end": "262759"
  },
  {
    "text": "of other kubernets functionality that people want to be able to develop and test and load balancer was a pretty obvious Gap and I'm going to hand off",
    "start": "262759",
    "end": "269840"
  },
  {
    "text": "Anton to talk some more about what we did there thanks thanks man okay let me well",
    "start": "269840",
    "end": "277479"
  },
  {
    "text": "as been say the kind become more and more popular and and kubernetes become",
    "start": "277479",
    "end": "285000"
  },
  {
    "text": "more more more complex right I'm TL in network too so I use kind a lot and as",
    "start": "285000",
    "end": "292240"
  },
  {
    "text": "you may know when you create a service you can have a service type load balancer what what's the problem with",
    "start": "292240",
    "end": "298479"
  },
  {
    "text": "this the problem is that for for being able to test it or to just to use it for",
    "start": "298479",
    "end": "303639"
  },
  {
    "text": "kind users we we don't have a good solution right so er we needed a",
    "start": "303639",
    "end": "311080"
  },
  {
    "text": "controller and something that that creates this load balancer that configure this external IP and that make",
    "start": "311080",
    "end": "318759"
  },
  {
    "text": "this accessible from from outside the kind cluster we have",
    "start": "318759",
    "end": "324720"
  },
  {
    "text": "a a good solution and temporal solution that is metal rate but the problem with",
    "start": "324720",
    "end": "331560"
  },
  {
    "text": "metal B is that have several gaps right one is that it uses it will go to the",
    "start": "331560",
    "end": "337680"
  },
  {
    "text": "technical part it uses or L2 or L3 to be able to spose the virtual IP for the",
    "start": "337680",
    "end": "344440"
  },
  {
    "text": "load balancer right and this has a hard dependency on the Linux Bridge so users",
    "start": "344440",
    "end": "349600"
  },
  {
    "text": "need to use Linux to be able to use that and the other problem is that you don't",
    "start": "349600",
    "end": "355000"
  },
  {
    "text": "have a lot of the features that the cloud providers load balancer have",
    "start": "355000",
    "end": "360800"
  },
  {
    "text": "so when we were developing in in sign networ this cap the 90 the",
    "start": "360800",
    "end": "367479"
  },
  {
    "text": "16 1669 terminating in points I started to struggle with how",
    "start": "367479",
    "end": "374039"
  },
  {
    "text": "are we going to test this because the main point of this ER feature is to user",
    "start": "374039",
    "end": "380120"
  },
  {
    "text": "to be able to have um rolling updates with Theo",
    "start": "380120",
    "end": "385759"
  },
  {
    "text": "tho disruption right so this is a very tricky feature to test with a lot of",
    "start": "385759",
    "end": "391960"
  },
  {
    "text": "timing uh a lot of race conditions and with multiple moving Parts this this feat is",
    "start": "391960",
    "end": "400240"
  },
  {
    "text": "based on on if you understand how the PO light cycle works you know that the Pod",
    "start": "400240",
    "end": "405880"
  },
  {
    "text": "has several state right the Pod start running but the Pod is not ready the r",
    "start": "405880",
    "end": "411919"
  },
  {
    "text": "of the Pod is what indicat when uh the pot must be used as an end point of the",
    "start": "411919",
    "end": "418120"
  },
  {
    "text": "service that means that is signaling every Network infrastructure that say okay this part",
    "start": "418120",
    "end": "424240"
  },
  {
    "text": "is ready to receive traffic because until this",
    "start": "424240",
    "end": "429639"
  },
  {
    "text": "cap the how can I say the the until this cap then points were binary so or the PO",
    "start": "429639",
    "end": "437080"
  },
  {
    "text": "can be ready or not ready but the problem with this is that when one po was terminating it still be able to",
    "start": "437080",
    "end": "443960"
  },
  {
    "text": "share traffic until the new pod is coming right so we need to add a new condition to the Pod that is the PO both",
    "start": "443960",
    "end": "449759"
  },
  {
    "text": "serving and terminating right and this allows to implement terminating points",
    "start": "449759",
    "end": "456080"
  },
  {
    "text": "the way that this work is is is a bit complex this is kind of a diagram and",
    "start": "456080",
    "end": "461280"
  },
  {
    "text": "explaining everything so you have a PO the PO start running the status of the",
    "start": "461280",
    "end": "467000"
  },
  {
    "text": "Pod is published by the cuet in the AP server right the there is another controller the point s controller that",
    "start": "467000",
    "end": "473560"
  },
  {
    "text": "runs in the Q controller manager this controller is watching for the parts Contin so when you figure a service you",
    "start": "473560",
    "end": "480280"
  },
  {
    "text": "have a selector to select all the PS and this controller is starting to watch okay the p is ready okay you can send",
    "start": "480280",
    "end": "486440"
  },
  {
    "text": "traffic to this P when the Pod is terminating before the capap the Pod was",
    "start": "486440",
    "end": "492879"
  },
  {
    "text": "removed from the end point what does it means that the Pod is still able to share traffic there is going to be a gap",
    "start": "492879",
    "end": "499360"
  },
  {
    "text": "between the Pod is terminating until the new pod is running where the Pod is the traffic can be black hole",
    "start": "499360",
    "end": "507800"
  },
  {
    "text": "so to be able to implement in this diagram so to be able to solve this",
    "start": "507800",
    "end": "513039"
  },
  {
    "text": "problem you need to coordinate different components right one is and the most",
    "start": "513039",
    "end": "518279"
  },
  {
    "text": "important component here is the external load balancer the way that this works is",
    "start": "518279",
    "end": "523560"
  },
  {
    "text": "with h the H checks of the Lo balancer if you see this diagram you have a",
    "start": "523560",
    "end": "530560"
  },
  {
    "text": "typical high Avail High availability deployment right you have your deployment and you deploy one instance",
    "start": "530560",
    "end": "536880"
  },
  {
    "text": "in each zone right the Lo balance it is has checking the the pots it's it's he",
    "start": "536880",
    "end": "543040"
  },
  {
    "text": "checking the service he check notep to see the health of the PO and is sending",
    "start": "543040",
    "end": "549600"
  },
  {
    "text": "traffic traffic to the one that are available so so far so",
    "start": "549600",
    "end": "556279"
  },
  {
    "text": "good when you are doing a rolling up dat usually let's go to the simple model",
    "start": "556279",
    "end": "562040"
  },
  {
    "text": "that you say okay I'm going to make only one an available at a time so then the",
    "start": "562040",
    "end": "567839"
  },
  {
    "text": "PO start terminating right but meanwhile the PO is start terminating the load",
    "start": "567839",
    "end": "573519"
  },
  {
    "text": "balancer need to detect oh this pod is still not ready so the H check has to",
    "start": "573519",
    "end": "579320"
  },
  {
    "text": "still be failing but traffic has to still going into this this pot to to be",
    "start": "579320",
    "end": "584600"
  },
  {
    "text": "serving this to fix this race right think that at the t0 the PO start",
    "start": "584600",
    "end": "592200"
  },
  {
    "text": "terminating but the load balancer is not going to notice that is unavailable until the health check fail so this this",
    "start": "592200",
    "end": "599519"
  },
  {
    "text": "is the key of the feature and the complexity and that's why we need to develop this solution",
    "start": "599519",
    "end": "604600"
  },
  {
    "text": "because doing this with a load balancer in a cloud provider is a new test that",
    "start": "604600",
    "end": "610320"
  },
  {
    "text": "can run for minutes and it's very racy once the new pod start running the",
    "start": "610320",
    "end": "617320"
  },
  {
    "text": "H check start to be serving again it start to be green again and the L balancer keep sending traffic to it so",
    "start": "617320",
    "end": "625800"
  },
  {
    "text": "this was the the main motivation right there are as you see there were a lot of issues open during the time but we never",
    "start": "625800",
    "end": "633040"
  },
  {
    "text": "have this strong use case to invest I of this and what we decided to do is okay",
    "start": "633040",
    "end": "639920"
  },
  {
    "text": "we want to test Cloud providers we want to and also the our users like the cloud",
    "start": "639920",
    "end": "645839"
  },
  {
    "text": "provider experience because it's more real they didn't they don't need to do work arounds with the port mapping with",
    "start": "645839",
    "end": "652560"
  },
  {
    "text": "the redirecting and all the stuff so let's try to build this cloud provider",
    "start": "652560",
    "end": "657720"
  },
  {
    "text": "kind and what the cloud provider kind is is doing is just mimicking the operation",
    "start": "657720",
    "end": "663880"
  },
  {
    "text": "of of a normal cloud provider right so it detect the service when it detect that it needs a load balancer spawns a",
    "start": "663880",
    "end": "671279"
  },
  {
    "text": "new load balancer the implementation right now is an hi proy container that",
    "start": "671279",
    "end": "677680"
  },
  {
    "text": "runs in the same Docker Network so when you create this container it has an IP",
    "start": "677680",
    "end": "683079"
  },
  {
    "text": "from the docker Network so the the users can use this IP to to connect to the Lo",
    "start": "683079",
    "end": "688519"
  },
  {
    "text": "balance the other important feature that we wanted to implement is just thinking in",
    "start": "688519",
    "end": "694079"
  },
  {
    "text": "the future right is let's see if we cover more use cases for for load",
    "start": "694079",
    "end": "699880"
  },
  {
    "text": "balancer and maybe multicluster right so we decided to keep iterating on this",
    "start": "699880",
    "end": "706160"
  },
  {
    "text": "idea of okay let's try to do our own cloud provider and what we implemented",
    "start": "706160",
    "end": "711720"
  },
  {
    "text": "is an out of three an a component that runs out of the cluster that is able to handle",
    "start": "711720",
    "end": "718720"
  },
  {
    "text": "multiple full cluster at the same time in the future this can be used for implementing Global Lo balancer for",
    "start": "718720",
    "end": "724920"
  },
  {
    "text": "example or I don't know I mean there are a lot of ideas that we want to hear from",
    "start": "724920",
    "end": "732079"
  },
  {
    "text": "all of you or the people that has idea please come to us and talk about what are your use cases and we we we think",
    "start": "732079",
    "end": "738880"
  },
  {
    "text": "about how to implement them so I prepare a demo I mean this is super uh okay let",
    "start": "738880",
    "end": "746399"
  },
  {
    "text": "me find it okay I prepare a a demo a demo for showing all this",
    "start": "746399",
    "end": "756480"
  },
  {
    "text": "complexity so let's see so you create I create the kind cluster already so kind",
    "start": "757320",
    "end": "765320"
  },
  {
    "text": "get clusters so you have a kind",
    "start": "765320",
    "end": "772160"
  },
  {
    "text": "cluster with three notes okay let's see that I didn't have any over so this is",
    "start": "772160",
    "end": "780480"
  },
  {
    "text": "empty this is empty okay oh what usually do I have the this deployment let me is",
    "start": "780480",
    "end": "789480"
  },
  {
    "text": "the screen good enough or should I zoom make it bigger okay so you can go",
    "start": "789480",
    "end": "797399"
  },
  {
    "text": "to the repo and you have this examples on how to use it you can see I have a deployment right this is typical",
    "start": "797399",
    "end": "804560"
  },
  {
    "text": "deployment that you should use for a c t if you are what about availability and",
    "start": "804560",
    "end": "810560"
  },
  {
    "text": "you want to roll out applications in with Z time you need to to think and",
    "start": "810560",
    "end": "816920"
  },
  {
    "text": "using these uh features for your deployment right so important things",
    "start": "816920",
    "end": "822560"
  },
  {
    "text": "that we have here we want to define the rolling update strategy right you define",
    "start": "822560",
    "end": "828160"
  },
  {
    "text": "the maximum number that you want to be an available is the see that you have a problem or something you don't want to",
    "start": "828160",
    "end": "834399"
  },
  {
    "text": "roll all of them at the same time another important piece here is the termination grace period seconds what",
    "start": "834399",
    "end": "841560"
  },
  {
    "text": "this is doing is that when the p is terminating the CET is still going to",
    "start": "841560",
    "end": "846720"
  },
  {
    "text": "give him like 30 minutes to finish to doing things in this case what we want is okay you are terminated St start to",
    "start": "846720",
    "end": "856040"
  },
  {
    "text": "gracefully terminate the TCP connection just don't break all of them another",
    "start": "856040",
    "end": "861360"
  },
  {
    "text": "important thing is we want to have s anti-affinity i mean there are different options to implement that but ideally",
    "start": "861360",
    "end": "867480"
  },
  {
    "text": "you want all your replicas to landar in different no right because you can high",
    "start": "867480",
    "end": "872920"
  },
  {
    "text": "availability if you put the p in the same node this is going to be a single point of",
    "start": "872920",
    "end": "879480"
  },
  {
    "text": "failure and your application need to be able to handle this termination uh period right so it's you",
    "start": "879480",
    "end": "887279"
  },
  {
    "text": "are going to receive a sick term at the time you need to start to do the cleanup so it's important this is not magic",
    "start": "887279",
    "end": "893839"
  },
  {
    "text": "there are multiple components working here and your application need to be aware of this and play well with",
    "start": "893839",
    "end": "899639"
  },
  {
    "text": "them the another important piece is that you need to to Define theal traffic",
    "start": "899639",
    "end": "905240"
  },
  {
    "text": "policy to local this is important you know when you have external traffic",
    "start": "905240",
    "end": "910440"
  },
  {
    "text": "policy you can have two external traffic policy right it can be local or cluster when you have cluster the load balancer",
    "start": "910440",
    "end": "917920"
  },
  {
    "text": "will send the traffic to any node in the cluster and then when it reaches one0",
    "start": "917920",
    "end": "924160"
  },
  {
    "text": "the Q proxy whatever service implementation you have is going to B bounce it back to any node in the class",
    "start": "924160",
    "end": "931000"
  },
  {
    "text": "so you have two problems because of this one is performance because you are doing a double hop on the Node and the other",
    "start": "931000",
    "end": "937600"
  },
  {
    "text": "problem is that you are going to lose your preuse Source IP you are going to",
    "start": "937600",
    "end": "943600"
  },
  {
    "text": "see the node IP that's something that most people don't like especially if you",
    "start": "943600",
    "end": "948880"
  },
  {
    "text": "need to be want to have some sort of telemetry on your application about who is using your",
    "start": "948880",
    "end": "955399"
  },
  {
    "text": "application okay so far so good let let's apply",
    "start": "955399",
    "end": "962440"
  },
  {
    "text": "this load balancer deployment okay what I did wrong",
    "start": "962440",
    "end": "969560"
  },
  {
    "text": "ah okay I bit nervous today",
    "start": "971920",
    "end": "979879"
  },
  {
    "text": "sorry it's good I think okay so now we",
    "start": "980399",
    "end": "985839"
  },
  {
    "text": "are going to see now I don't know there has is going to be a problem let's",
    "start": "985839",
    "end": "991560"
  },
  {
    "text": "see who spotted first so we have the pause running and we have the",
    "start": "991560",
    "end": "997959"
  },
  {
    "text": "service so you see the problem right how do I reach this service I mean",
    "start": "997959",
    "end": "1005680"
  },
  {
    "text": "I have my application but I'm not able to reach the cluster IP I'm outside of the cluster I need to reach and this is",
    "start": "1005680",
    "end": "1012759"
  },
  {
    "text": "when cloud provider kind comes to help us so this as I say this is a binary",
    "start": "1012759",
    "end": "1020199"
  },
  {
    "text": "that rounds outside of the cluster let's put some verbosity right",
    "start": "1020199",
    "end": "1026438"
  },
  {
    "text": "and everything happened too fast but I'm going to fast forward and explain you what happened",
    "start": "1026439",
    "end": "1032120"
  },
  {
    "text": "so it detects all the noes it DET test that there is a service it DET test that",
    "start": "1032120",
    "end": "1038520"
  },
  {
    "text": "the service is stat trffic policy local and that is a loot balance and what it",
    "start": "1038520",
    "end": "1044360"
  },
  {
    "text": "does is okay I'm going to configure create a Lo um load balancer let's see",
    "start": "1044360",
    "end": "1051320"
  },
  {
    "text": "here that's this container right H Pro whatever we can use another thing but",
    "start": "1051320",
    "end": "1058520"
  },
  {
    "text": "this was handy because we already had this image and then I'm conf I'm going to configure this H proy to be able to",
    "start": "1058520",
    "end": "1066520"
  },
  {
    "text": "connect to this important things important things",
    "start": "1066520",
    "end": "1071679"
  },
  {
    "text": "here the health check that's why I said before we have the metal B why you don't",
    "start": "1071679",
    "end": "1077320"
  },
  {
    "text": "use metal B metal B is L3 or L2 load balance it get IP or nothing else with",
    "start": "1077320",
    "end": "1083320"
  },
  {
    "text": "this we have this granularity we can configure health checks we can define a",
    "start": "1083320",
    "end": "1088880"
  },
  {
    "text": "different port for the health check because you know when you have a service load balancer with external traffic",
    "start": "1088880",
    "end": "1095000"
  },
  {
    "text": "policy local the system already provides you with a uh what's the name uh notp heal check",
    "start": "1095000",
    "end": "1103600"
  },
  {
    "text": "H check not Port that's a special not Port that is able to answer how many and",
    "start": "1103600",
    "end": "1109200"
  },
  {
    "text": "points are alive in that node right and this is what the load balance is going to use to the it should send traffic to",
    "start": "1109200",
    "end": "1117880"
  },
  {
    "text": "that node or not okay so now we should have thep",
    "start": "1117880",
    "end": "1125200"
  },
  {
    "text": "um you see we have the IP [Music] one2",
    "start": "1125200",
    "end": "1131280"
  },
  {
    "text": "16883 so and let's see now we are going to inspect the container of the J proy",
    "start": "1131280",
    "end": "1137240"
  },
  {
    "text": "and this has to much and you see so basically is",
    "start": "1137240",
    "end": "1144159"
  },
  {
    "text": "how I mean oversimplifying but it's it's most more or less the techniques that",
    "start": "1144159",
    "end": "1150320"
  },
  {
    "text": "the clowd providers use to to provide your load balance it when you are in the crowd right but it's okay now let me",
    "start": "1150320",
    "end": "1158799"
  },
  {
    "text": "clear this so we have the",
    "start": "1158799",
    "end": "1163960"
  },
  {
    "text": "PS we see that we have a different part in",
    "start": "1164240",
    "end": "1169320"
  },
  {
    "text": "different no those are the names let me get the IP and we are going to query the",
    "start": "1169320",
    "end": "1175200"
  },
  {
    "text": "IP 1 2 1 6 83 and then ask who are",
    "start": "1175200",
    "end": "1183720"
  },
  {
    "text": "you E I need to do the echo thing because other way okay this is b key",
    "start": "1183919",
    "end": "1192960"
  },
  {
    "text": "wsw that is this one and if I keep quaring I got the other one right so the",
    "start": "1192960",
    "end": "1199320"
  },
  {
    "text": "Lo balance is working that is great right and well you're saying I can do",
    "start": "1199320",
    "end": "1204720"
  },
  {
    "text": "that with the metal right you can do that of course the problem is as I say I",
    "start": "1204720",
    "end": "1210120"
  },
  {
    "text": "was super worried about this terminating in point Fus and I needed this well tested because it's critical we are",
    "start": "1210120",
    "end": "1215960"
  },
  {
    "text": "talking about people that is worried about losing one or two packets so this has to work like a clock so what we are",
    "start": "1215960",
    "end": "1223320"
  },
  {
    "text": "going to do we are going to emulate exactly the same behavior that the people that want see down time one so",
    "start": "1223320",
    "end": "1232880"
  },
  {
    "text": "well let's emulate a busic client ping",
    "start": "1232880",
    "end": "1238000"
  },
  {
    "text": "the L balancer",
    "start": "1238000",
    "end": "1242880"
  },
  {
    "text": "[Music]",
    "start": "1246160",
    "end": "1249269"
  },
  {
    "text": "two okay I don't know what they did ah do",
    "start": "1254640",
    "end": "1260600"
  },
  {
    "text": "okay now you need to trust me a bit but you see that things changes right so",
    "start": "1263760",
    "end": "1269159"
  },
  {
    "text": "basically every time it's hitting one of them so what we need to do so this is the scenario right we are pulling the",
    "start": "1269159",
    "end": "1275760"
  },
  {
    "text": "load balancer uh ideally this is spreading the load equally so 50% of",
    "start": "1275760",
    "end": "1283240"
  },
  {
    "text": "each request should go to one balancer but now is the key okay I have a new version of my application right get",
    "start": "1283240",
    "end": "1293039"
  },
  {
    "text": "deployment Z app [Music]",
    "start": "1295200",
    "end": "1300559"
  },
  {
    "text": "o so and now let me find the container image name not this places okay so my",
    "start": "1300559",
    "end": "1309159"
  },
  {
    "text": "application is 2.39 and now I have a new version that",
    "start": "1309159",
    "end": "1314799"
  },
  {
    "text": "is 2.40 and I want to roll out my new versions without any disruption so how",
    "start": "1314799",
    "end": "1322039"
  },
  {
    "text": "do I do that well I don't remember the command exactly so I'm going to go to",
    "start": "1322039",
    "end": "1328600"
  },
  {
    "text": "the history image okay you see so basically what I'm",
    "start": "1328600",
    "end": "1334200"
  },
  {
    "text": "saying is update this deployment to upgrade my image to 2.40 and let's see",
    "start": "1334200",
    "end": "1339559"
  },
  {
    "text": "what start to happen here right so when we see here get PS you see okay there is",
    "start": "1339559",
    "end": "1346600"
  },
  {
    "text": "a PO pending and another p terminating right I have a great period of 30 seconds so at this point you see the",
    "start": "1346600",
    "end": "1354720"
  },
  {
    "text": "load balance is detected oh the one application is terminating so let's go only to the one that is available right",
    "start": "1354720",
    "end": "1360880"
  },
  {
    "text": "it keeps terminating it keeps the stuff that they need to do but I keep sending the traffic to the only one that is",
    "start": "1360880",
    "end": "1367279"
  },
  {
    "text": "alive so when we reach the 30 seconds we should start to see the point okay you",
    "start": "1367279",
    "end": "1374679"
  },
  {
    "text": "see this new application the 2.30 start to be created and both start to receive the",
    "start": "1374679",
    "end": "1383240"
  },
  {
    "text": "traffic right so everything is good the load balancer detect everything is good and now again this start to be",
    "start": "1383240",
    "end": "1390200"
  },
  {
    "text": "terminated and all the traffic is switching to the to the good let's say the good",
    "start": "1390200",
    "end": "1396360"
  },
  {
    "text": "version if we can keep looking after some seconds when all the roll out is",
    "start": "1396360",
    "end": "1403320"
  },
  {
    "text": "complete everything has terminated and the new application is running now don't fail me okay you here",
    "start": "1403320",
    "end": "1410919"
  },
  {
    "text": "you go you have everything [Music]",
    "start": "1410919",
    "end": "1416190"
  },
  {
    "text": "working and well this is one of the main",
    "start": "1417000",
    "end": "1422480"
  },
  {
    "text": "motivation the other one that we want to keep developing is hear more ideas we know that people from Mac and windows",
    "start": "1422480",
    "end": "1428760"
  },
  {
    "text": "want to use Lo balancer just know that we have you in our minds but it's much",
    "start": "1428760",
    "end": "1434720"
  },
  {
    "text": "more complex than you know and we will try to solve that problem and I don't",
    "start": "1434720",
    "end": "1441039"
  },
  {
    "text": "know I think that's it did you have any",
    "start": "1441039",
    "end": "1446200"
  },
  {
    "text": "questions this light",
    "start": "1447679",
    "end": "1453840"
  },
  {
    "text": "okay well if you have questions there's a mic",
    "start": "1454159",
    "end": "1460000"
  },
  {
    "text": "here question in the mic there",
    "start": "1467360",
    "end": "1473279"
  },
  {
    "text": "y yeah thanks for the talk um I just want to go back to the the program you",
    "start": "1473279",
    "end": "1479279"
  },
  {
    "text": "started that created the L balancer how does it uh you want the code guide me",
    "start": "1479279",
    "end": "1486880"
  },
  {
    "text": "you want to see this yeah exactly well so I guess it's talking to the local DNS",
    "start": "1486880",
    "end": "1492679"
  },
  {
    "text": "to grab an IP so it's another new IP from the local network going on the host",
    "start": "1492679",
    "end": "1500320"
  },
  {
    "text": "okay that's from the docker where is the IP grab from wait one one second let me say so and is is that already open",
    "start": "1504720",
    "end": "1513360"
  },
  {
    "text": "source and accessible yeah yeah yeah this this this croud provider kind is an official kubernetes project right this",
    "start": "1513360",
    "end": "1520000"
  },
  {
    "text": "is now testing the CI this is when you when you use this feature this",
    "start": "1520000",
    "end": "1527440"
  },
  {
    "text": "program is testing that we don't regress so the way that this work is this cloud provider kind has to query to API right",
    "start": "1527440",
    "end": "1535399"
  },
  {
    "text": "is the API of the control plane of the cluster and the API of the implementation of kind in this case",
    "start": "1535399",
    "end": "1541960"
  },
  {
    "text": "Docker right so you go to the docker and is able to create containers so when you",
    "start": "1541960",
    "end": "1547039"
  },
  {
    "text": "create the load balancer you create a new Docker container that is a load balancer so this IP is from the",
    "start": "1547039",
    "end": "1552520"
  },
  {
    "text": "container that you just created so it's Docker in this case who is providing the IP so the the is able to glue these two",
    "start": "1552520",
    "end": "1560440"
  },
  {
    "text": "things the infrastructure provided provided by Docker and the kubernetes",
    "start": "1560440",
    "end": "1566640"
  },
  {
    "text": "services cruster we've also been saying Docker this whole time but podman has nominal",
    "start": "1566640",
    "end": "1573520"
  },
  {
    "text": "support uh for this one and nerd cuddle support is landing and kind so we'll probably look at nerd cuddle support and",
    "start": "1573520",
    "end": "1579880"
  },
  {
    "text": "cloud provider kind well I have a pretty s question",
    "start": "1579880",
    "end": "1585039"
  },
  {
    "text": "this because I just want to know where the IP is coming from so be nice to fire up some commands so we just could see",
    "start": "1585039",
    "end": "1590799"
  },
  {
    "text": "the IP interfaces which Bridges you are available um for example if you see if",
    "start": "1590799",
    "end": "1595960"
  },
  {
    "text": "you fire um cuy tail kep nodes me or wide so we could see which IPS the nodes",
    "start": "1595960",
    "end": "1602399"
  },
  {
    "text": "get and if they differ from the note that on there so we just know which network it is the IP gets it's the",
    "start": "1602399",
    "end": "1609559"
  },
  {
    "text": "bridge Network that the docker nodes are running on so the so the so there containers for the the kind cluster",
    "start": "1609559",
    "end": "1614960"
  },
  {
    "text": "nodes they're running on on a bridge Network so it's the same Bridge it's the same Bridge yeah as Ben say we we want",
    "start": "1614960",
    "end": "1621600"
  },
  {
    "text": "to make this portable right we have pman we have Docker and we have now nursity here right so that's that's what we are",
    "start": "1621600",
    "end": "1628399"
  },
  {
    "text": "trying to do we try to abstract the the controller from the infrastructure right",
    "start": "1628399",
    "end": "1633799"
  },
  {
    "text": "not to reuse these API that Dr pman provide to us and we just fetch this",
    "start": "1633799",
    "end": "1639000"
  },
  {
    "text": "information and we use it for for the different",
    "start": "1639000",
    "end": "1644200"
  },
  {
    "text": "implementation",
    "start": "1647159",
    "end": "1650159"
  },
  {
    "text": "sorry I have another question then so the the demo is using a che proxy let's say I want to use something else is it",
    "start": "1653760",
    "end": "1661159"
  },
  {
    "text": "doable or it's very TI to a proxy it's doable look is when I started this I I",
    "start": "1661159",
    "end": "1667840"
  },
  {
    "text": "was having a great fun right so the first thing that I try is okay I'm going to do a super L balancer and remade",
    "start": "1667840",
    "end": "1674080"
  },
  {
    "text": "myself with go and whatever and is when I spend two days and say this is super comp let me try to get the H proy",
    "start": "1674080",
    "end": "1681200"
  },
  {
    "text": "working and and see so ideally I would love to have something more fancy right",
    "start": "1681200",
    "end": "1686240"
  },
  {
    "text": "but this keeps the things working and we we actually um we didn't talk about kind",
    "start": "1686240",
    "end": "1692799"
  },
  {
    "text": "has some ha control plane support for testing kubernetes it's not very mature but it's there enough to do some so we",
    "start": "1692799",
    "end": "1699679"
  },
  {
    "text": "already have um in the core kind project we provision an ha proxy container for",
    "start": "1699679",
    "end": "1705320"
  },
  {
    "text": "similar purposes so it was just easy to start with but but uh if there's a really strong demand we could look at",
    "start": "1705320",
    "end": "1710480"
  },
  {
    "text": "something else it should just be an implementation detail though talking about implementation",
    "start": "1710480",
    "end": "1717000"
  },
  {
    "text": "details um the H proxy is configured for",
    "start": "1717000",
    "end": "1722080"
  },
  {
    "text": "the backend servers do you use the data plan API for it or is it templated it's templated right now it's",
    "start": "1722080",
    "end": "1729600"
  },
  {
    "text": "templated but I mean it's is as we we had a pro historically we just reducing",
    "start": "1729600",
    "end": "1735640"
  },
  {
    "text": "the things that we have it's it's just implementation thank",
    "start": "1735640",
    "end": "1742000"
  },
  {
    "text": "you uh first of all thank you for great uh presentation I really like it I have",
    "start": "1742000",
    "end": "1747960"
  },
  {
    "text": "just one question that uh maybe it's not to you but anyway I want to ask so",
    "start": "1747960",
    "end": "1753320"
  },
  {
    "text": "basically you create support or you create an application that uh U making",
    "start": "1753320",
    "end": "1759559"
  },
  {
    "text": "available to um test application or services that have uh type load balancer",
    "start": "1759559",
    "end": "1767159"
  },
  {
    "text": "and I know uh kind is uh uh does not have currently Network policy support",
    "start": "1767159",
    "end": "1774480"
  },
  {
    "text": "and official documentation uh suggest to use another plugin uh and make it work I",
    "start": "1774480",
    "end": "1781320"
  },
  {
    "text": "wanted to ask if uh there could be a solution like that because it was like a",
    "start": "1781320",
    "end": "1787320"
  },
  {
    "text": "plug and play it was more easy to do like that other than reconfigure some",
    "start": "1787320",
    "end": "1794880"
  },
  {
    "text": "networks yeah like I said when we started we were looking for this is the set of things that you're expected every",
    "start": "1794880",
    "end": "1800000"
  },
  {
    "text": "kubernetes cluster to have Network policy unfortunately is not one of those things that is actually super widespread",
    "start": "1800000",
    "end": "1806399"
  },
  {
    "text": "um and there is no implementation in the in the kuet project and um I I would say",
    "start": "1806399",
    "end": "1812000"
  },
  {
    "text": "something of a little bit of a loose API so it hasn't been a a focus yet the the",
    "start": "1812000",
    "end": "1818640"
  },
  {
    "text": "okay let's try to give context to this when kind of start to have this compies which C cni are you going to use right",
    "start": "1818640",
    "end": "1825519"
  },
  {
    "text": "and then I want to use Calico I want to use C I want to use FR I want to use so then they say okay let's do our minimum",
    "start": "1825519",
    "end": "1832919"
  },
  {
    "text": "C cni and then we have a knob that say disabl cni and you can install Calico",
    "start": "1832919",
    "end": "1839200"
  },
  {
    "text": " flanel whatever right if you go to any of these CIS they are using kind so",
    "start": "1839200",
    "end": "1845000"
  },
  {
    "text": "you can install celum Calico in kind and use that right the problem is with the f",
    "start": "1845000",
    "end": "1850360"
  },
  {
    "text": "as you say is are we going to implement a whole network policy demon in our cni",
    "start": "1850360",
    "end": "1856960"
  },
  {
    "text": "I can't tell you I implemented Network policies in different is a lot of work and very complex so what we decided is",
    "start": "1856960",
    "end": "1865159"
  },
  {
    "text": "okay let's keep the people the minimum and let's give the people that build CN",
    "start": "1865159",
    "end": "1870760"
  },
  {
    "text": "I oh sorry the opportunity to you know hook into our project and use it so the",
    "start": "1870760",
    "end": "1878760"
  },
  {
    "text": "people that want neor policies they can install the other c i and new thank",
    "start": "1878760",
    "end": "1886320"
  },
  {
    "text": "you last question question because we are not first thank you for the presentation thank you for kind great um",
    "start": "1886679",
    "end": "1894960"
  },
  {
    "text": "I have a question external binaries that you launch for the Lo bouncer are you",
    "start": "1894960",
    "end": "1900559"
  },
  {
    "text": "planning to actually make it avoidable in kind confing so that we for a kind cluster",
    "start": "1900559",
    "end": "1907720"
  },
  {
    "text": "like set we want this cluster to have a transversal API so it's a little bit of",
    "start": "1907720",
    "end": "1913200"
  },
  {
    "text": "an open question we wanted to start as an out of tree project because another thing about is it has an extremely",
    "start": "1913200",
    "end": "1919200"
  },
  {
    "text": "minimal dependency set people embedded in their test Runners their cluster API tools that sort of thing if you look at",
    "start": "1919200",
    "end": "1924919"
  },
  {
    "text": "the main kind module it Imports 12 packages so we wanted a little bit more",
    "start": "1924919",
    "end": "1930559"
  },
  {
    "text": "flexibility to iterate on this um the other thing is as Antony mentioned we're interested in being able to test things",
    "start": "1930559",
    "end": "1936080"
  },
  {
    "text": "like multicluster so now you need it to be provisioned once across them so it",
    "start": "1936080",
    "end": "1941159"
  },
  {
    "text": "kind of has a separate life cycle from the cluster if you think about it like it's like your cloud provider right you don't bring up a a cloud every time you",
    "start": "1941159",
    "end": "1948000"
  },
  {
    "text": "bring up a cluster you have the cloud running and then you bring up the Clusters to be honest I don't think I",
    "start": "1948000",
    "end": "1953519"
  },
  {
    "text": "see personally for like M maybe just understand why but okay",
    "start": "1953519",
    "end": "1960840"
  },
  {
    "text": "thank you sure yeah we're just trying to enable the kubernetes projects to to test things and there's some multicluster stuff in the in the",
    "start": "1960840",
    "end": "1966320"
  },
  {
    "text": "kubernetes orc okay well thank you very much and if you have more questions we are going to",
    "start": "1966320",
    "end": "1972320"
  },
  {
    "text": "be around thank you",
    "start": "1972320",
    "end": "1976278"
  }
]