[
  {
    "start": "0",
    "end": "105000"
  },
  {
    "text": "hi i'm jay beale and uh i'm here i'm here i'm gonna talk to you about uh",
    "start": "80",
    "end": "7040"
  },
  {
    "text": "kubernetes attack and defense i like to do uh capture the flag style exercises",
    "start": "7040",
    "end": "12559"
  },
  {
    "text": "and um um and i i do that honestly partly because it makes all this stuff more interesting",
    "start": "12559",
    "end": "17680"
  },
  {
    "text": "um it gives us a ties in a tyson's story and also i do i do it because um i i",
    "start": "17680",
    "end": "25039"
  },
  {
    "text": "i try my hardest to take any any of the kind of demos i do and make them into exercises that other",
    "start": "25039",
    "end": "30960"
  },
  {
    "text": "people can do and so i put them into a kubernetes cluster um that you can download called",
    "start": "30960",
    "end": "37280"
  },
  {
    "text": "bustikube so we're bust a cube who knows what the proper pronunciation is around here",
    "start": "37280",
    "end": "44000"
  },
  {
    "text": "um so um yeah sorry i'm feeling a little nervous because i can't",
    "start": "44000",
    "end": "49520"
  },
  {
    "text": "see any of you and this is a really new this is actually a really new experience for me like having the you know having",
    "start": "49520",
    "end": "55280"
  },
  {
    "text": "uh doing a lot of virtual um and uh but yeah i hope that i hope that uh you",
    "start": "55280",
    "end": "61039"
  },
  {
    "text": "have a good time i hope you learned some stuff i hope that you uh i hope uh eventually you know",
    "start": "61039",
    "end": "66400"
  },
  {
    "text": "uh out of this i learned some stuff i i know i tend to so cool so let's see first um",
    "start": "66400",
    "end": "74240"
  },
  {
    "text": "uh first up i've got a uh i've got a bio i've stopped doing the uh the text bio and i've started doing a",
    "start": "74240",
    "end": "80799"
  },
  {
    "text": "graphical bio because nobody reads the text it all just um it all just kind of you know blurs on the",
    "start": "80799",
    "end": "86720"
  },
  {
    "text": "page so this is stuff that i do or um or uh enjoy or you know have",
    "start": "86720",
    "end": "93439"
  },
  {
    "text": "have done in the past so the big the um a couple the ones you'll be hearing about today are",
    "start": "93439",
    "end": "100159"
  },
  {
    "text": "paradise and busta coupe a couple open source projects i work on um so cool let's see so what are we gonna",
    "start": "100159",
    "end": "107200"
  },
  {
    "start": "105000",
    "end": "288000"
  },
  {
    "text": "do what are we gonna do today um i'm gonna basically walk you through an attack on a kubernetes cluster",
    "start": "107200",
    "end": "114079"
  },
  {
    "text": "and i theme this on the movie inception which whoa was a lot harder than i thought um",
    "start": "114079",
    "end": "120079"
  },
  {
    "text": "so if you don't remember that movie because it's been a long time don't worry there's i'll uh whatever whatever minor",
    "start": "120079",
    "end": "126079"
  },
  {
    "text": "amount of plot you need to know well i'll catch you up the big deal basically is um over the course of the movie dream",
    "start": "126079",
    "end": "133120"
  },
  {
    "text": "within a dream within a dream within a dream we uh uh the so i think i'll i'll try to um i'll try to",
    "start": "133120",
    "end": "141280"
  },
  {
    "text": "speak to that plot in just a second so what are we gonna see um the attack",
    "start": "141280",
    "end": "146319"
  },
  {
    "text": "path we're gonna look at basically has um i start out you always uh attacking",
    "start": "146319",
    "end": "152160"
  },
  {
    "text": "kubernetes you rarely have this like amazing luck where somebody's just happened to",
    "start": "152160",
    "end": "157200"
  },
  {
    "text": "expose uh a uh kubernetes dashboard out of the internet the way tesla did um",
    "start": "157200",
    "end": "163120"
  },
  {
    "text": "to to make it easy to do crypto mining uh make it easy to do to uh to get a whole bunch of their resources involved",
    "start": "163120",
    "end": "169599"
  },
  {
    "text": "in in crypto mining for you um so most of the time an attack on a kubernetes cluster starts",
    "start": "169599",
    "end": "176160"
  },
  {
    "text": "out from inside it in some way so some kind of assumed breach um",
    "start": "176160",
    "end": "181519"
  },
  {
    "text": "what i've what i have the premise i've taken here is um because we had uh because of the",
    "start": "181519",
    "end": "188400"
  },
  {
    "text": "around the time that i was proposing in the talk uh there was uh um sorry there was a lot of news about",
    "start": "188400",
    "end": "196400"
  },
  {
    "text": "um library uh man apparently i'm either nervous or",
    "start": "196400",
    "end": "202959"
  },
  {
    "text": "sleepy i'm not sure which so apparently since there was there was a lot of news at the time about uh typo squatting on libraries um",
    "start": "202959",
    "end": "210799"
  },
  {
    "text": "the big one one of the big ones was something called colorize uh but where if there's the",
    "start": "210799",
    "end": "217040"
  },
  {
    "text": "you know the kind of uh let's call it u.s english spelling and um and maybe proper english spelling i'm",
    "start": "217040",
    "end": "223360"
  },
  {
    "text": "not sure but you know where you add a u and if you um the library is you know",
    "start": "223360",
    "end": "228799"
  },
  {
    "text": "uses one of those two the uh um but the attackers typo squatted on the other one and what that got them was uh",
    "start": "228799",
    "end": "237040"
  },
  {
    "text": "into uh into people's workloads into people's programs so i'm going to talk about that i'm",
    "start": "237040",
    "end": "242400"
  },
  {
    "text": "going to talk about um a monkey-in-the-middle attack on a service in kubernetes",
    "start": "242400",
    "end": "248560"
  },
  {
    "text": "um we'll use that for fun um i'll show you a public cloud api attack and",
    "start": "248560",
    "end": "255519"
  },
  {
    "text": "pod security policy of asian and then on the defense side we'll talk about software supply chain",
    "start": "255519",
    "end": "260720"
  },
  {
    "text": "um we'll talk about uh name space isolation and and um and what you'd want there i'm",
    "start": "260720",
    "end": "268240"
  },
  {
    "text": "really excited that we're about to start getting nested name spaces um we'll talk about workload identity and",
    "start": "268240",
    "end": "275759"
  },
  {
    "text": "uh and also opa gatekeeper one of the admission controllers um that's uh that's competing with pod",
    "start": "275759",
    "end": "281600"
  },
  {
    "text": "security policies and k-rail and whatever else people are making so",
    "start": "281600",
    "end": "287120"
  },
  {
    "text": "let's see um so we're gonna go right into demo and that's where we're gonna honestly spend the bulk of our time here",
    "start": "287120",
    "end": "293199"
  },
  {
    "start": "288000",
    "end": "392000"
  },
  {
    "text": "i've made a i made a demo video and um since i type a little slow i'm going to try to i'm going to try to",
    "start": "293199",
    "end": "299520"
  },
  {
    "text": "kick up the speed and we'll see how that uh we'll see how that works out um my my demo video is all typing",
    "start": "299520",
    "end": "307600"
  },
  {
    "text": "is all typing there's there's uh precious little graphics um but the this is probably a good time",
    "start": "307600",
    "end": "313759"
  },
  {
    "text": "for me to just tell you the tell you about this the uh remind you about the plot of the movie inception",
    "start": "313759",
    "end": "319520"
  },
  {
    "text": "so in inception um you've got leonardo dicaprio leonardo dicaprio and his team and they",
    "start": "319520",
    "end": "326080"
  },
  {
    "text": "are trying to uh they are trying to win by taking somebody by basically uh",
    "start": "326080",
    "end": "332720"
  },
  {
    "text": "affecting somebody's dreams um or bringing somebody into a dream and then doing that at multiple layers so they",
    "start": "332720",
    "end": "340160"
  },
  {
    "text": "they have a you know they have a they bring the they uh put the person under sedation",
    "start": "340160",
    "end": "345199"
  },
  {
    "text": "and uh bring them into one dream and then within that dream they in the dream they put them under",
    "start": "345199",
    "end": "351039"
  },
  {
    "text": "sedation again and into another dream and then another and then another one and then another one and the movie is kind of",
    "start": "351039",
    "end": "356720"
  },
  {
    "text": "is uh is kind of interesting and fun um but uh i thought it would be really neat",
    "start": "356720",
    "end": "362160"
  },
  {
    "text": "because you know we're you know with kubernetes we talk about you know where containers and",
    "start": "362160",
    "end": "367360"
  },
  {
    "text": "what's a container and and um and so on so it just seemed like a good theme to play with so let's go and uh let's go",
    "start": "367360",
    "end": "375199"
  },
  {
    "text": "and do the video thing so i'm gonna i've practiced this",
    "start": "375199",
    "end": "381120"
  },
  {
    "text": "let me just do my screen share and boom",
    "start": "381120",
    "end": "387440"
  },
  {
    "text": "okay cool so um so what i've uh sort of done is i'm i'm",
    "start": "387840",
    "end": "394639"
  },
  {
    "text": "basically uh um i'm asking you to stipulate to the idea that uh to the idea that we can do",
    "start": "394639",
    "end": "401680"
  },
  {
    "text": "um so i'm asking you to stipulate that we could basically um typo squat on a library",
    "start": "401680",
    "end": "409199"
  },
  {
    "text": "um on a library or on source code and end up in somebody's program and i want to show",
    "start": "409199",
    "end": "414880"
  },
  {
    "text": "you what that can look like so here we go this is i'm going to start",
    "start": "414880",
    "end": "420479"
  },
  {
    "text": "out we've got the um i just want to kind of talk about the news that got me thinking here",
    "start": "420479",
    "end": "426720"
  },
  {
    "text": "um the python and actually this wasn't my thought this was uh this was a friend of mine's thought",
    "start": "426720",
    "end": "432960"
  },
  {
    "text": "thought ava black who was very very interested in the fact that",
    "start": "432960",
    "end": "438000"
  },
  {
    "text": "the uh that pi pi doesn't use um signatures and that and that there's there's actually a",
    "start": "438000",
    "end": "443759"
  },
  {
    "text": "whole ton of work to be done um in uh in supply chain and software's",
    "start": "443759",
    "end": "449440"
  },
  {
    "text": "in secure software supply chain because we all download things um i certainly i certainly will build",
    "start": "449440",
    "end": "456880"
  },
  {
    "text": "things you know i certainly will build my images by starting with a from uh on docker hub and in the early days",
    "start": "456880",
    "end": "463120"
  },
  {
    "text": "that from would be whatever was useful it wasn't always you know one of three or four things that i",
    "start": "463120",
    "end": "468319"
  },
  {
    "text": "absolutely positively knew so um here's a couple uh here's a couple uh",
    "start": "468319",
    "end": "474240"
  },
  {
    "text": "things that happened that were discovered at exactly the same time typo squatting where attackers basically said wait date",
    "start": "474240",
    "end": "482000"
  },
  {
    "text": "util's used a ton everyone's making the move to python 3. let's get a",
    "start": "482000",
    "end": "487520"
  },
  {
    "text": "let's go and register python 3 date util on the pi pi on the python package index and",
    "start": "487520",
    "end": "493759"
  },
  {
    "text": "um and do some stuff and the other one they did was a modification on jellyfish um where",
    "start": "493759",
    "end": "500560"
  },
  {
    "text": "they were changing an l to a an l to a lowercase l um to a one so um",
    "start": "500560",
    "end": "509520"
  },
  {
    "text": "so anyway these these were two clones that were these are two clones that were found and",
    "start": "509520",
    "end": "515120"
  },
  {
    "text": "it turned out that that date util which was probably far more popular was only you know only had the typo",
    "start": "515120",
    "end": "522240"
  },
  {
    "text": "squatting going on for two days but the jellyfish library had been like that for like a year",
    "start": "522240",
    "end": "528399"
  },
  {
    "text": "and what the attackers got out of it was pgp keys and ssh keys and the way that",
    "start": "528399",
    "end": "535920"
  },
  {
    "start": "530000",
    "end": "870000"
  },
  {
    "text": "works is kind of like what you're going to see here um as an attacker you go and say",
    "start": "535920",
    "end": "541680"
  },
  {
    "text": "okay someone's trying to get that library they're going to be importing it they might be importing it on every single build um and",
    "start": "541680",
    "end": "549600"
  },
  {
    "text": "well they might be doing it on some less regular basis but they're going to be pulling it down on it and they're going to be pulling it down and if i can make it so that they pull",
    "start": "549600",
    "end": "556000"
  },
  {
    "text": "down my software all i got to do is make sure as an attacker that my software is does the same does the same thing as the",
    "start": "556000",
    "end": "562640"
  },
  {
    "text": "thing that they're expecting so that they don't notice it um but then also add some step and so",
    "start": "562640",
    "end": "568399"
  },
  {
    "text": "that step could be you know that step could be anything that you would that you would trojan that you would do with a trojan horse it",
    "start": "568399",
    "end": "574080"
  },
  {
    "text": "might be to you know grab whatever pgp keys or ssh keys are in a home directory and ship",
    "start": "574080",
    "end": "579279"
  },
  {
    "text": "them off and ship them off by some c2 mechanism as fast as you can",
    "start": "579279",
    "end": "584320"
  },
  {
    "text": "um i'm going to stipulate that one of them might be to that one of them might be to leave code running in your in a cluster and send",
    "start": "584320",
    "end": "591120"
  },
  {
    "text": "back a metaphoric interpreter binary so that's what we're going to do what i've done um what i've done is",
    "start": "591120",
    "end": "598320"
  },
  {
    "text": "created a and this is i'm going to have little pictures show up from the movie to kind of show",
    "start": "598320",
    "end": "604079"
  },
  {
    "text": "you where you are in the stages of this gentleman in the front being uh",
    "start": "604079",
    "end": "610720"
  },
  {
    "text": "being taken advantage of i guess so the so what i'm what i'm",
    "start": "610720",
    "end": "618480"
  },
  {
    "text": "what i'm uh what i'm doing with the software supply chain um issue here is basically",
    "start": "618480",
    "end": "626000"
  },
  {
    "text": "um saying uh if if uh if somebody were to happen to you know if somebody were to were to end up",
    "start": "626000",
    "end": "632720"
  },
  {
    "text": "with my code in their container that they were staging to kubernetes cluster this is this is where we go and what i",
    "start": "632720",
    "end": "640480"
  },
  {
    "text": "made my code do is i just took uh i just took one of the actual images that i was using",
    "start": "640480",
    "end": "646480"
  },
  {
    "text": "and i added something to it i added just i added two lines to a docker file one",
    "start": "646480",
    "end": "651839"
  },
  {
    "text": "was to copy and interpreter binary in and the other was to start it running",
    "start": "651839",
    "end": "657200"
  },
  {
    "text": "before running the real program that's supposed to be running in that container um so this container when it starts will",
    "start": "657200",
    "end": "664160"
  },
  {
    "text": "start up and as soon as it starts up it will phone home and this is just an interpreter",
    "start": "664160",
    "end": "669279"
  },
  {
    "text": "interpreter reverse shell binary connects back to me on https um and um",
    "start": "669279",
    "end": "676959"
  },
  {
    "text": "wait i don't know that it connects back on https what am i saying that's that's what i would love to do with by with uh with uh",
    "start": "676959",
    "end": "683920"
  },
  {
    "text": "web shells but that's uh but interpreters are not known for being anywhere near that careful",
    "start": "683920",
    "end": "689680"
  },
  {
    "text": "so i've got an interpreter it's going to it's going to start and it's going to connect back to me and i've staged a",
    "start": "689680",
    "end": "695040"
  },
  {
    "text": "copy of metasploit um actually in docker if you think you have to download kali to get metasploit",
    "start": "695040",
    "end": "700959"
  },
  {
    "text": "going it turns out it's way easier than that um there's a docker image for that which is also a great way",
    "start": "700959",
    "end": "706720"
  },
  {
    "text": "of getting menosploid into kubernetes cluster um so i've got a i've got metasploit",
    "start": "706720",
    "end": "712000"
  },
  {
    "text": "here and i've been practicing with this a bunch so you're seeing session number 11. um but as soon as",
    "start": "712000",
    "end": "717680"
  },
  {
    "text": "somebody as soon as um i should do this in another window i guess um but as soon as as soon as the uh so",
    "start": "717680",
    "end": "724959"
  },
  {
    "text": "as soon as somebody uh uh uh applies that image just starts up that pod in their",
    "start": "724959",
    "end": "731200"
  },
  {
    "text": "cluster that the the pod that's using this that's using this container image",
    "start": "731200",
    "end": "737839"
  },
  {
    "text": "is running my um is running my interpreter and so i'm going to end up in a pod in",
    "start": "737839",
    "end": "743839"
  },
  {
    "text": "the cluster and so this is kind of standard standard fare i'm going to interact with the",
    "start": "743839",
    "end": "749760"
  },
  {
    "text": "interpreter and find myself in a pod this pod is called supply chain just to kind of make the point and",
    "start": "749760",
    "end": "758800"
  },
  {
    "text": "the uh and so i'm i'm now uh i now basically have a shell um",
    "start": "758800",
    "end": "764800"
  },
  {
    "text": "that's gonna it's going to renew nicely out of my split so i do a little bit of quick little you",
    "start": "764800",
    "end": "771760"
  },
  {
    "text": "know pen tester give myself a nicer uh uh pty and um",
    "start": "771760",
    "end": "779600"
  },
  {
    "text": "and now i just start seeing what's the lay of the land so um i won't have the i to have the normal",
    "start": "779600",
    "end": "785440"
  },
  {
    "text": "environment variables tell me what the what the api servers ip address is but nicely i have cube i have",
    "start": "785440",
    "end": "790720"
  },
  {
    "text": "cube dns to uh or core dns to give me my um to give me my api server by",
    "start": "790720",
    "end": "798320"
  },
  {
    "text": "name um i'll use the token that's auto mounted into the pod um by the way that would be a great way",
    "start": "798320",
    "end": "804000"
  },
  {
    "text": "to a great way to give attackers a lot less capability is just say which pods do you have you know",
    "start": "804000",
    "end": "809920"
  },
  {
    "text": "which pods you have that actually need to have a service count token mounted in and for all the rest don't um and so i'll find",
    "start": "809920",
    "end": "816399"
  },
  {
    "text": "myself i find myself in this cluster and this cluster's got looks like three pods running they all look like",
    "start": "816399",
    "end": "822240"
  },
  {
    "text": "they were nicely put here by deployments so they've got kind of you know replicate numbers and all that and",
    "start": "822240",
    "end": "828959"
  },
  {
    "text": "um i'll do my i i've done my get pods to get a a list of what's running in here the",
    "start": "828959",
    "end": "834399"
  },
  {
    "text": "supply chain one has been only around for 36 seconds because that's how i just got in here and uh",
    "start": "834399",
    "end": "840399"
  },
  {
    "text": "like a like a um diligent attacker i was waiting um for this connection to come",
    "start": "840399",
    "end": "845839"
  },
  {
    "text": "in so very first thing i do is just make things easy on myself by taking those command line flags i needed for coup for",
    "start": "845839",
    "end": "852639"
  },
  {
    "text": "uh coupe control and uh make them into an alias so now i'll say let's get services",
    "start": "852639",
    "end": "858480"
  },
  {
    "text": "and uh okay see some services check position the normal kubernetes uh and then robert fisher and let's get",
    "start": "858480",
    "end": "865920"
  },
  {
    "text": "a list of secrets and i see oh there's a flag um i'm not actually able to read the",
    "start": "865920",
    "end": "872240"
  },
  {
    "start": "870000",
    "end": "910000"
  },
  {
    "text": "value of the flag but i don't need to this flag says okay here's your flag now go get robert fisher trust you",
    "start": "872240",
    "end": "878320"
  },
  {
    "text": "and at this point in the movie i've switched us to robert fisher has been you know was on that plane",
    "start": "878320",
    "end": "883600"
  },
  {
    "text": "and took the uh um uh took the drink that he was offered by leonardo dicaprio and",
    "start": "883600",
    "end": "889760"
  },
  {
    "text": "you know started dreaming and now he's now in a van with leonardo dicaprio and his team um",
    "start": "889760",
    "end": "896720"
  },
  {
    "text": "and they're all dreaming so now we're in our now we're in um so now we're in that dream and",
    "start": "896720",
    "end": "903120"
  },
  {
    "text": "entering into the next dream and we've got our flag go get uh robert fisher trust you",
    "start": "903120",
    "end": "908639"
  },
  {
    "text": "so how are we gonna get them to trust us well let's go connect to him he's got a he's got a nice little service okay so",
    "start": "908639",
    "end": "915120"
  },
  {
    "text": "robert fisher the the uh the mark here um",
    "start": "915120",
    "end": "920399"
  },
  {
    "text": "he's got a uh he's basically offering a microservice and says it answers to trust me and you",
    "start": "920399",
    "end": "926560"
  },
  {
    "text": "put in your you uh put in your last name so cobb is leonardo dicaprio's name in the movie so we're gonna see if if",
    "start": "926560",
    "end": "933759"
  },
  {
    "text": "robert fisher will trust uh cobb uh says nope you're not my head of security",
    "start": "933759",
    "end": "940399"
  },
  {
    "text": "and in this part of the movie leonardo capra is trying to get uh trying to convince um the mark",
    "start": "940399",
    "end": "946320"
  },
  {
    "text": "um robert fisher that leonardo dicaprio is his head of security for dreams um and he is going to and when he does",
    "start": "946320",
    "end": "954079"
  },
  {
    "text": "he gets he gets uh the mark to actually you know fight his own security forces off",
    "start": "954079",
    "end": "959920"
  },
  {
    "text": "so this says that he figures out where the trust is by looking at his check position service nothing's never heard",
    "start": "959920",
    "end": "965440"
  },
  {
    "start": "960000",
    "end": "1088000"
  },
  {
    "text": "of us so let's go interact with that check position service and see what it is so check position another nice helpful",
    "start": "965440",
    "end": "972240"
  },
  {
    "text": "service that gives us some information cool it says it's going to tell us what position somebody has",
    "start": "972240",
    "end": "979600"
  },
  {
    "text": "and man even when i'm recording i'm still going to typo um so it's going to tell us what position somebody has uh if you tell",
    "start": "980839",
    "end": "987759"
  },
  {
    "text": "them if you tell them the last name so this is what this is what robert fisher's service is querying",
    "start": "987759",
    "end": "993360"
  },
  {
    "text": "and i'm doing this because that's a very normal pattern we see kubernetes clusters where you have taken an app and broken it up",
    "start": "993360",
    "end": "999839"
  },
  {
    "text": "into microservices and they query each other so robert fisher is querying his",
    "start": "999839",
    "end": "1005920"
  },
  {
    "text": "check position service to find out what someone's job is and that's whether they work for him",
    "start": "1005920",
    "end": "1011120"
  },
  {
    "text": "and check position is going to say this person doesn't leonardo capri doesn't work for you um and that's not good we we want robert",
    "start": "1011120",
    "end": "1018399"
  },
  {
    "text": "fisher to think that leonardo dicaprio does so what do we do um well if we look at",
    "start": "1018399",
    "end": "1023680"
  },
  {
    "text": "the service turns out that if you're in a namespace um if you can if you can stage your pods in",
    "start": "1023680",
    "end": "1030480"
  },
  {
    "text": "the same name space as uh as somebody you know as somebody else or something else",
    "start": "1030480",
    "end": "1036319"
  },
  {
    "text": "and you'd like the traffic that's going to come to it from services kubernetes internal load balancers",
    "start": "1036319",
    "end": "1041678"
  },
  {
    "text": "all you've got to do is well and all we've got to do in this case is basically have the same labels",
    "start": "1041679",
    "end": "1047360"
  },
  {
    "text": "that that thing has so we can look at if we can look at the service we can figure out what those labels are",
    "start": "1047360",
    "end": "1052799"
  },
  {
    "text": "if we can look at the pod that's supposed to get the traffic we can find out what those labels are",
    "start": "1052799",
    "end": "1057919"
  },
  {
    "text": "or honestly we could automate that and create a ton of labels and and we can",
    "start": "1057919",
    "end": "1064160"
  },
  {
    "text": "figure that out based on what we find on github so uh i've created a little man a little",
    "start": "1064160",
    "end": "1069440"
  },
  {
    "text": "monkey in the middle pod um and",
    "start": "1069440",
    "end": "1075120"
  },
  {
    "text": "i'm gonna i'm going to upload it from my cali system come on jay take a little faster",
    "start": "1078160",
    "end": "1086480"
  },
  {
    "start": "1088000",
    "end": "1198000"
  },
  {
    "text": "and once i've uploaded it i'm going to interact and i'm going to see if i can stage that and so it turns out that",
    "start": "1088559",
    "end": "1096640"
  },
  {
    "text": "my account i've skipped all of the querying all the querying of auth can i and so on and",
    "start": "1096640",
    "end": "1101840"
  },
  {
    "text": "um my account is actually allowed to stage things is actually allowed to stage pods um",
    "start": "1101840",
    "end": "1108080"
  },
  {
    "text": "so i've created a man in the middle and my man in the middle basically is going to always answer that whoever the person is that you're asking",
    "start": "1108080",
    "end": "1114720"
  },
  {
    "text": "about is your head is uh your head of security so as long as i set my labels to the",
    "start": "1114720",
    "end": "1122080"
  },
  {
    "text": "same thing as in that selector on the service then i'm going to get some of the traffic um now there's one legitimate position",
    "start": "1122080",
    "end": "1130320"
  },
  {
    "text": "checker pod and one of me one of my man in the middle monkey in the middle pods",
    "start": "1130320",
    "end": "1135360"
  },
  {
    "text": "so i'll get half the traffic in general if i want what i really should do since i'm lightweight anyway is stage up",
    "start": "1135360",
    "end": "1141520"
  },
  {
    "text": "100 because then i'll get the traffic 100 out of 101 times",
    "start": "1141520",
    "end": "1146880"
  },
  {
    "text": "so once i've staged up this monkey in the middle pod if i curl that check position the way that robert fisher will if i curl it enough",
    "start": "1146880",
    "end": "1153840"
  },
  {
    "text": "times i'll start getting the monkey in the middle pod that'll say security head so and i'm going to do that",
    "start": "1153840",
    "end": "1162000"
  },
  {
    "text": "and i do that now with uh with robert fisher i query robert fischer robert fisher queries the",
    "start": "1162000",
    "end": "1168000"
  },
  {
    "text": "service the service sometimes goes to the real place sometimes goes to my monkey in the middle pod and once it goes to my monkey in the",
    "start": "1168000",
    "end": "1174080"
  },
  {
    "text": "middle pod once i get to you know i get i get what i'm looking for so um this thing now robert fisher says i",
    "start": "1174080",
    "end": "1181200"
  },
  {
    "text": "trust you you know i know my uncle is actually the bad guy and we need to invade my uncle's dream so i'm willing",
    "start": "1181200",
    "end": "1187600"
  },
  {
    "text": "to go you know into another level of dreaming and uh uh which means in this case you",
    "start": "1187600",
    "end": "1193520"
  },
  {
    "text": "know get root on one of the nodes on one of the nodes of the kubernetes cluster so um nicely robert fisher gives us the",
    "start": "1193520",
    "end": "1201280"
  },
  {
    "start": "1198000",
    "end": "1357000"
  },
  {
    "text": "service count token kind of similar to shooting his own guards and so this is the point where where",
    "start": "1201280",
    "end": "1208720"
  },
  {
    "text": "he's decided he trusts us so we're going to echo that i'm going to write that token to a file and now i'm",
    "start": "1208720",
    "end": "1214240"
  },
  {
    "text": "going to start using that token um instead of the one i normally had and",
    "start": "1214240",
    "end": "1221840"
  },
  {
    "text": "i'm going to see if i can upload an attack but i'm going to see if maybe robert fisher is allowed to",
    "start": "1223440",
    "end": "1231120"
  },
  {
    "text": "is allowed to stage pause that can mount the host file system on the node",
    "start": "1231120",
    "end": "1237120"
  },
  {
    "text": "and",
    "start": "1237919",
    "end": "1240158"
  },
  {
    "text": "turns out robert fischer isn't there's a pod security policy in place that says that uh robert fisher also can't",
    "start": "1245280",
    "end": "1252559"
  },
  {
    "text": "um launch pods that uh pods that mount the host file system so everything's safe right um well it it",
    "start": "1252559",
    "end": "1260799"
  },
  {
    "text": "it's uh we're gonna find out that there's uh we're gonna find out that there's a slight it's not kind of a",
    "start": "1260799",
    "end": "1266559"
  },
  {
    "text": "vulnerability it's more uh uh uh works as intended um but not as",
    "start": "1266559",
    "end": "1271679"
  },
  {
    "text": "expected kind of thing so this is uh this is something that that uh",
    "start": "1271679",
    "end": "1276799"
  },
  {
    "text": "the um i'm sorry this is something that uh the trailer vets folks found on the kubernetes security audit um",
    "start": "1276799",
    "end": "1284559"
  },
  {
    "text": "so i'm gonna take i'm basically gonna create a uh deployment i'm going to deploy a",
    "start": "1284559",
    "end": "1291039"
  },
  {
    "text": "pod and this pod is going to mount a volume but that and that volume is going to be",
    "start": "1291039",
    "end": "1296640"
  },
  {
    "text": "from the nodes file system and the way that's the reason that's",
    "start": "1296640",
    "end": "1302480"
  },
  {
    "text": "going to work is it turns out there's a there's another way of of mounting the host file system um there might be more but at the very",
    "start": "1302480",
    "end": "1309039"
  },
  {
    "text": "least you can you can use persistent volume claims and set the storage class to manual and then you if you're allowed to create",
    "start": "1309039",
    "end": "1316320"
  },
  {
    "text": "your own persistent volumes and your own persistent volume claims then you are that's the works as",
    "start": "1316320",
    "end": "1323280"
  },
  {
    "text": "intended um then you uh unfortunately that's not as safe as it's not as safe as you should be you",
    "start": "1323280",
    "end": "1328559"
  },
  {
    "text": "basically get to do the same thing the pod security policy was trying to stop here so",
    "start": "1328559",
    "end": "1334480"
  },
  {
    "text": "um so if we're allowed to stage this and we're going to stipulate that that robert fisher's account could",
    "start": "1334480",
    "end": "1343120"
  },
  {
    "text": "or we're going to see that robert fisher's account could then i'm able to get my uh my pod in that's called a called",
    "start": "1343120",
    "end": "1349360"
  },
  {
    "text": "attack pvc is persistent volume claim and",
    "start": "1349360",
    "end": "1354799"
  },
  {
    "text": "and so something else i've done is i've built those attack persistent volume claims to have",
    "start": "1356400",
    "end": "1362080"
  },
  {
    "text": "that same interpreter in them um because i'm just using the same image that i've staged",
    "start": "1362080",
    "end": "1367760"
  },
  {
    "text": "that i've staged as my you know as my hostel as my hostel typo squad of the image so um so now i'm",
    "start": "1367760",
    "end": "1375440"
  },
  {
    "text": "so now i'm i'm hopefully a little further along and i'm in the node um and the interesting",
    "start": "1375440",
    "end": "1382080"
  },
  {
    "text": "thing i find on the note is when i look at the host name i find out i'm in kind",
    "start": "1382080",
    "end": "1387919"
  },
  {
    "text": "so i'm in a kubernetes cluster that's running in docker um but even more than that there's a",
    "start": "1387919",
    "end": "1394559"
  },
  {
    "text": "configuration file on the root file system here for something called a outer",
    "start": "1394559",
    "end": "1401039"
  },
  {
    "text": "so there's another kubernetes cluster that this is running on so i'm running kind and i",
    "start": "1401120",
    "end": "1407280"
  },
  {
    "text": "was able to get kind to run in kind um and then and then that kind to run on the cluster",
    "start": "1407280",
    "end": "1412400"
  },
  {
    "text": "um but it's it was a little pain um so anyway um so we've got",
    "start": "1412400",
    "end": "1417760"
  },
  {
    "text": "so we've got our we've got kind which means that we have kubernetes cluster running um",
    "start": "1417760",
    "end": "1424000"
  },
  {
    "text": "running as a container in our kubernetes cluster whereas a set of containers and um using",
    "start": "1424000",
    "end": "1431520"
  },
  {
    "text": "the docker and docker style method um so the um",
    "start": "1431520",
    "end": "1437520"
  },
  {
    "text": "so at this point what i'm going to do is use that configuration file that i found this is kind of another flag",
    "start": "1437520",
    "end": "1442960"
  },
  {
    "text": "and i'm going to see if i can if i can deploy something if i can basically get out of",
    "start": "1442960",
    "end": "1448720"
  },
  {
    "text": "this inner cluster by deploying a workload onto the outer cluster so when i do that",
    "start": "1448720",
    "end": "1458720"
  },
  {
    "text": "i end up getting some more interpreters",
    "start": "1458720",
    "end": "1462559"
  },
  {
    "start": "1463000",
    "end": "1898000"
  },
  {
    "text": "and this is putting me in another supply chain pod but that pods in the outer cluster",
    "start": "1463840",
    "end": "1470240"
  },
  {
    "text": "so we should be on a new pod in the outer cluster now",
    "start": "1470240",
    "end": "1474960"
  },
  {
    "text": "and this is basically the kind of this is the um the last place that our mark goes he",
    "start": "1477200",
    "end": "1483760"
  },
  {
    "text": "goes to see his uh his dead father and and find out his father was",
    "start": "1483760",
    "end": "1488880"
  },
  {
    "text": "not so bad um so what i want to do now is uh add in a",
    "start": "1488880",
    "end": "1495840"
  },
  {
    "text": "cloud attack and i'm doing this with a tool that needs that needs your help um it's an open source tool that we've",
    "start": "1495840",
    "end": "1502480"
  },
  {
    "text": "bought that a few of us have worked on called paradise um kubernetes is uh is great for helmsman ferraris is greek",
    "start": "1502480",
    "end": "1509279"
  },
  {
    "text": "uh for pirates um and so this is um this is a little tool that uh",
    "start": "1509279",
    "end": "1515039"
  },
  {
    "text": "we've just been taking different things that we could automate that were useful on pen tests and putting them in and putting them",
    "start": "1515039",
    "end": "1520880"
  },
  {
    "text": "into a tool so um yeah we did a little ascii art logo",
    "start": "1520880",
    "end": "1526159"
  },
  {
    "text": "because you have to i'm just going to advance this a little",
    "start": "1526159",
    "end": "1532400"
  },
  {
    "text": "more so lets you kind of we have menu items",
    "start": "1532400",
    "end": "1537679"
  },
  {
    "text": "you can uh the idea in general is you're trying to pick up service accounts and then do things with them and",
    "start": "1537679",
    "end": "1544320"
  },
  {
    "text": "escalate privilege so i'm going to do so i'm going to do some of these um the one that i'm the one the one that",
    "start": "1544320",
    "end": "1551760"
  },
  {
    "text": "i like when i can get it is if i have a cops cluster if i use cops to build a cluster on gcp",
    "start": "1551760",
    "end": "1558080"
  },
  {
    "text": "um it stores it stores a whole bunch of bootstrap service",
    "start": "1558080",
    "end": "1563679"
  },
  {
    "text": "counts in the uh in a in a bucket and that bucket is readable with the default",
    "start": "1563679",
    "end": "1571600"
  },
  {
    "text": "scopes in uh in gcp that buckets basically readable by all the um by uh uh by all the accounts that are",
    "start": "1571600",
    "end": "1579760"
  },
  {
    "text": "in the project so i do a few command lines and we've just automated this point so we can basically",
    "start": "1579760",
    "end": "1586480"
  },
  {
    "text": "say okay let's let's get the default let's get the token out of the metadata api let's grab the project id out of the same place",
    "start": "1586480",
    "end": "1592240"
  },
  {
    "text": "let's go looking in all the buckets and then searching through all the buckets let's see if we can find any service count tokens and if we find",
    "start": "1592240",
    "end": "1598400"
  },
  {
    "text": "them then we'll automatically populate them so when you hit this essay menu and say i want to list my service counts",
    "start": "1598400",
    "end": "1603760"
  },
  {
    "text": "you see the one that you started with but then you also see these ones that were acquired from from gcs so now i can go",
    "start": "1603760",
    "end": "1610960"
  },
  {
    "text": "and say i'd like to switch service accounts and i'll put myself in the context of the admin account that i that i got from that",
    "start": "1610960",
    "end": "1616799"
  },
  {
    "text": "and i'll switch namespaces over to kubesystem because there's much more interesting stuff in there like control plane elements",
    "start": "1616799",
    "end": "1622640"
  },
  {
    "text": "and um and so i'll list the secrets that are available in that in that name space oh plenty of service",
    "start": "1622640",
    "end": "1629039"
  },
  {
    "text": "counts and that will basically let me keep adding to my store of service accounts um",
    "start": "1629039",
    "end": "1634559"
  },
  {
    "text": "and exploring what i can do with that uh now i'm just going to kind of get rid of the jump ahead and",
    "start": "1634559",
    "end": "1640159"
  },
  {
    "text": "take over a node um but before i do i just want to show you a couple more things",
    "start": "1640159",
    "end": "1645520"
  },
  {
    "text": "so one is we built in off menu so you can run kube control out of this actually if you're in karate's if you",
    "start": "1645520",
    "end": "1652159"
  },
  {
    "text": "name pirates cube control it will operate as cube control because it's built on the coop control um uh",
    "start": "1652159",
    "end": "1658799"
  },
  {
    "text": "library golang library um so it's it's kind of a little group control of its own",
    "start": "1658799",
    "end": "1664240"
  },
  {
    "text": "and then um the other um we've also built curl in um not a full",
    "start": "1664240",
    "end": "1671200"
  },
  {
    "text": "curl just we let you make get requests and post requests and um and specify custom headers like you'd",
    "start": "1671200",
    "end": "1677039"
  },
  {
    "text": "need for a lot of cloud apis um and uh and of course parameters and url code",
    "start": "1677039",
    "end": "1683520"
  },
  {
    "text": "them for you so i'm just going and i'm just doing a quick like here i can get my ip address",
    "start": "1683520",
    "end": "1689120"
  },
  {
    "text": "so let's do that whole like you know go get a actually i think what we'll do is we'll",
    "start": "1689120",
    "end": "1694720"
  },
  {
    "text": "first run a command in all the pods since we and this is only so easy",
    "start": "1694720",
    "end": "1700159"
  },
  {
    "text": "because we have because we have that admin already so i'm just going to say i'd like to run an id command in all the pods",
    "start": "1700159",
    "end": "1706960"
  },
  {
    "text": "so the fun here is honestly just automating it and if you like to write go or want to learn it",
    "start": "1706960",
    "end": "1712320"
  },
  {
    "text": "um please come help because it's i can't tell you how much fun i have when",
    "start": "1712320",
    "end": "1717760"
  },
  {
    "text": "i do when i do like in advance of this make myself go and add a feature or what have you um so turns out when we",
    "start": "1717760",
    "end": "1726080"
  },
  {
    "text": "look at the secrets that are available in the default name space we find one called flag and we can go get that um the thing i",
    "start": "1726080",
    "end": "1733520"
  },
  {
    "text": "like the reason the kube control from inside here is interesting is that you're getting to carry all of the",
    "start": "1733520",
    "end": "1739120"
  },
  {
    "text": "service counts you took with you and operate within those contexts and we even had for a little",
    "start": "1739120",
    "end": "1744240"
  },
  {
    "text": "while although it broke an injection mechanism where you could inject yourself into another pod and carry all of your",
    "start": "1744240",
    "end": "1749919"
  },
  {
    "text": "carry all of your service accounts with you so here's that flag it says you've gained admin on the cluster",
    "start": "1749919",
    "end": "1755200"
  },
  {
    "text": "um can you go a little further and get root on a node so we're gonna try this one and it says",
    "start": "1755200",
    "end": "1762000"
  },
  {
    "text": "this one's really simple it basically mounts it starts a pod that mounts the host file system and then",
    "start": "1762000",
    "end": "1767760"
  },
  {
    "text": "um edits crontab it's the crontab file and adds a netcat listener that'll that'll get that'll launch our netcat outbound shell",
    "start": "1767760",
    "end": "1774880"
  },
  {
    "text": "that'll get launched once a minute so you specify a port and ip and we'll just specify one that's in the that's right",
    "start": "1774880",
    "end": "1781440"
  },
  {
    "text": "in here that's in the pod",
    "start": "1781440",
    "end": "1795600"
  },
  {
    "text": "and um i am absolutely running short on time",
    "start": "1795600",
    "end": "1801600"
  },
  {
    "text": "which is to say i'm running into somebody else's time so i'm gonna as soon as this demo",
    "start": "1801600",
    "end": "1807200"
  },
  {
    "text": "finishes i'm going to go and see any of you want to talk in slack i'm really sorry i got such a slow start um",
    "start": "1807200",
    "end": "1813840"
  },
  {
    "text": "and i hope that it did not put you to sleep so if you start a netcat listener up",
    "start": "1813840",
    "end": "1818880"
  },
  {
    "text": "some time passes and you get to the end of the movie where um the guy on the left has become his",
    "start": "1818880",
    "end": "1824320"
  },
  {
    "text": "oldest guy in the right but it's only because he's in a really really deep dream so anyway",
    "start": "1824320",
    "end": "1829600"
  },
  {
    "text": "um let's see",
    "start": "1829600",
    "end": "1837840"
  },
  {
    "text": "um so this is that host mounting where we launch a pod we launch a pod mounts the host file system we use it to modify the cron tab",
    "start": "1840080",
    "end": "1846799"
  },
  {
    "text": "and then we remove the pod and that happens automatically and um and now your",
    "start": "1846799",
    "end": "1855840"
  },
  {
    "text": "some time would just pass a little faster you're on the you're on the node and this is",
    "start": "1856480",
    "end": "1863039"
  },
  {
    "text": "this isn't the master this is one of the nodes but you could use uh tolerations to get yourself onto the",
    "start": "1863039",
    "end": "1868480"
  },
  {
    "text": "master um and we can find our flag so anyway that is my demo and my",
    "start": "1868480",
    "end": "1876399"
  },
  {
    "text": "apparently poorly timed talk um so thank you i hope that you enjoyed",
    "start": "1876399",
    "end": "1881519"
  },
  {
    "text": "it and um i'm gonna stop sharing my screen",
    "start": "1881519",
    "end": "1886720"
  },
  {
    "text": "and i will see you in slack and i yeah i'll uh i'll be happy to to learn from you and see what i learned",
    "start": "1886720",
    "end": "1895919"
  },
  {
    "text": "cool thank you very much",
    "start": "1895919",
    "end": "1900480"
  }
]