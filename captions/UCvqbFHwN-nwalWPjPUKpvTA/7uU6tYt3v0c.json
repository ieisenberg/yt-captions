[
  {
    "text": "sorry about that hello everyone we're",
    "start": "900",
    "end": "4770"
  },
  {
    "text": "really excited to talk to you today",
    "start": "4770",
    "end": "6210"
  },
  {
    "text": "about how envoy has been sari how Square",
    "start": "6210",
    "end": "8820"
  },
  {
    "text": "has been using envoy as the basis for",
    "start": "8820",
    "end": "11220"
  },
  {
    "text": "our service mesh",
    "start": "11220",
    "end": "12530"
  },
  {
    "text": "I'm Michael pencil I've been at square",
    "start": "12530",
    "end": "16018"
  },
  {
    "text": "for about five years for the first four",
    "start": "16019",
    "end": "18539"
  },
  {
    "text": "of those I was working primarily on our",
    "start": "18539",
    "end": "20279"
  },
  {
    "text": "deployment systems the most recent one",
    "start": "20279",
    "end": "22289"
  },
  {
    "text": "being called p2 and then for the past",
    "start": "22289",
    "end": "24750"
  },
  {
    "text": "year I've been on our traffic team",
    "start": "24750",
    "end": "26250"
  },
  {
    "text": "working on exclusively this project",
    "start": "26250",
    "end": "28830"
  },
  {
    "text": "growing out our own voice service mich",
    "start": "28830",
    "end": "30920"
  },
  {
    "text": "hi I'm working but Square for two and a",
    "start": "30920",
    "end": "35040"
  },
  {
    "text": "half years last one a half years tell",
    "start": "35040",
    "end": "36960"
  },
  {
    "text": "the traffic team also working on end boy",
    "start": "36960",
    "end": "40860"
  },
  {
    "text": "and service mesh stuff so for this talk",
    "start": "40860",
    "end": "44880"
  },
  {
    "text": "I want to talk to you about we want to",
    "start": "44880",
    "end": "46140"
  },
  {
    "text": "talk to you about our motivation for",
    "start": "46140",
    "end": "47370"
  },
  {
    "text": "moving to NY as well as cover some of",
    "start": "47370",
    "end": "50670"
  },
  {
    "text": "our infrastructure details to shows",
    "start": "50670",
    "end": "52920"
  },
  {
    "text": "indeed some have some context why we",
    "start": "52920",
    "end": "55620"
  },
  {
    "text": "made the decisions that we made and then",
    "start": "55620",
    "end": "58020"
  },
  {
    "text": "we'll cover the design of our service",
    "start": "58020",
    "end": "60300"
  },
  {
    "text": "marrickville a control plane how we set",
    "start": "60300",
    "end": "62940"
  },
  {
    "text": "it up to facilitate migration to this",
    "start": "62940",
    "end": "65759"
  },
  {
    "text": "setup and what cover security there's no",
    "start": "65759",
    "end": "68759"
  },
  {
    "text": "traffic shaping features that were",
    "start": "68759",
    "end": "70020"
  },
  {
    "text": "making use of and we'll tell you about",
    "start": "70020",
    "end": "73590"
  },
  {
    "text": "where we're at now and what the future",
    "start": "73590",
    "end": "75029"
  },
  {
    "text": "looks like so one of the big things for",
    "start": "75029",
    "end": "79289"
  },
  {
    "text": "us was that we really needed to simplify",
    "start": "79289",
    "end": "80939"
  },
  {
    "text": "the way a client and server libraries'",
    "start": "80939",
    "end": "82649"
  },
  {
    "text": "worked when it came to service service",
    "start": "82649",
    "end": "85319"
  },
  {
    "text": "traffic score has three major languages",
    "start": "85319",
    "end": "87299"
  },
  {
    "text": "several minor ones and you get a lot of",
    "start": "87299",
    "end": "89639"
  },
  {
    "text": "different languages and frameworks they",
    "start": "89639",
    "end": "91229"
  },
  {
    "text": "have to give up the bay and they can",
    "start": "91229",
    "end": "93929"
  },
  {
    "text": "feature parity becomes a huge problem we",
    "start": "93929",
    "end": "98039"
  },
  {
    "text": "wanted to distribute load balancing",
    "start": "98039",
    "end": "99560"
  },
  {
    "text": "because we've been previously using",
    "start": "99560",
    "end": "102200"
  },
  {
    "text": "hormonal balance errors that were",
    "start": "102200",
    "end": "104429"
  },
  {
    "text": "becoming increasing availability concern",
    "start": "104429",
    "end": "107549"
  },
  {
    "text": "we're having load issues and we really",
    "start": "107549",
    "end": "109979"
  },
  {
    "text": "needed to get rid of the bottleneck we",
    "start": "109979",
    "end": "114329"
  },
  {
    "text": "also wanted to really abstract a way in",
    "start": "114329",
    "end": "116159"
  },
  {
    "text": "which our show from app developers",
    "start": "116159",
    "end": "117719"
  },
  {
    "text": "because previously they hadn't know a",
    "start": "117719",
    "end": "120359"
  },
  {
    "text": "lot about a lot of important details",
    "start": "120359",
    "end": "123840"
  },
  {
    "text": "they never do their job well so we",
    "start": "123840",
    "end": "125849"
  },
  {
    "text": "really want to make sure that they just",
    "start": "125849",
    "end": "127169"
  },
  {
    "text": "keep doing what they're good night the",
    "start": "127169",
    "end": "128968"
  },
  {
    "text": "Pelican alert",
    "start": "128969",
    "end": "129929"
  },
  {
    "text": "products and lastly we really wanted to",
    "start": "129929",
    "end": "132560"
  },
  {
    "text": "make it easier for us to make larger",
    "start": "132560",
    "end": "134790"
  },
  {
    "text": "infrastructure changes and gives us a",
    "start": "134790",
    "end": "137819"
  },
  {
    "text": "lot of light with both the accessibility",
    "start": "137819",
    "end": "139920"
  },
  {
    "text": "of custom filters as well as the",
    "start": "139920",
    "end": "143099"
  },
  {
    "text": "centralized control plane that gives us",
    "start": "143099",
    "end": "144930"
  },
  {
    "text": "a lot of power to move to rollout",
    "start": "144930",
    "end": "147810"
  },
  {
    "text": "changes really quickly so Square runs",
    "start": "147810",
    "end": "153719"
  },
  {
    "text": "primarily in our own data centers so we",
    "start": "153719",
    "end": "155400"
  },
  {
    "text": "have we have a few college expenses as",
    "start": "155400",
    "end": "158040"
  },
  {
    "text": "well but primarily our my data centers",
    "start": "158040",
    "end": "160310"
  },
  {
    "text": "this is oldest bare-metal we run our own",
    "start": "160310",
    "end": "164489"
  },
  {
    "text": "kubernetes light deployment system",
    "start": "164489",
    "end": "166909"
  },
  {
    "text": "somewhere in the sense that it has pods",
    "start": "166909",
    "end": "169019"
  },
  {
    "text": "that you can run multiple things in the",
    "start": "169019",
    "end": "170939"
  },
  {
    "text": "same pod you come here it's like but it",
    "start": "170939",
    "end": "173579"
  },
  {
    "text": "does not use containers it's all just",
    "start": "173579",
    "end": "175129"
  },
  {
    "text": "multi tenant hosts the only isolation",
    "start": "175129",
    "end": "178439"
  },
  {
    "text": "between multiple apps on a single host",
    "start": "178439",
    "end": "181200"
  },
  {
    "text": "is user permissions and like some c",
    "start": "181200",
    "end": "185310"
  },
  {
    "text": "groups so there's no net renamed network",
    "start": "185310",
    "end": "187290"
  },
  {
    "text": "no spacing then we MPLS between",
    "start": "187290",
    "end": "192989"
  },
  {
    "text": "everywhere for a while now you're pretty",
    "start": "192989",
    "end": "195419"
  },
  {
    "text": "strict security requirements as a famous",
    "start": "195419",
    "end": "196979"
  },
  {
    "text": "company so this is ban and requirement",
    "start": "196979",
    "end": "199319"
  },
  {
    "text": "previously in continues to be so with",
    "start": "199319",
    "end": "201060"
  },
  {
    "text": "with anyone and lastly our we've been",
    "start": "201060",
    "end": "203819"
  },
  {
    "text": "running we're running on mostly Sango 6",
    "start": "203819",
    "end": "206729"
  },
  {
    "text": "we're slowly moving toward seven but",
    "start": "206729",
    "end": "208859"
  },
  {
    "text": "it's it's a long process so we're we're",
    "start": "208859",
    "end": "210569"
  },
  {
    "text": "working on it",
    "start": "210569",
    "end": "213079"
  },
  {
    "text": "again now we'll get to the main part of",
    "start": "213079",
    "end": "215879"
  },
  {
    "text": "our talk where we'll go over a few parts",
    "start": "215879",
    "end": "217769"
  },
  {
    "text": "of our design of our service mesh that",
    "start": "217769",
    "end": "219540"
  },
  {
    "text": "we think are particularly interesting to",
    "start": "219540",
    "end": "221069"
  },
  {
    "text": "talk about so the first thing that",
    "start": "221069",
    "end": "223739"
  },
  {
    "text": "you'll probably think about if you're",
    "start": "223739",
    "end": "225030"
  },
  {
    "text": "rolling out a service mesh is what your",
    "start": "225030",
    "end": "226739"
  },
  {
    "text": "control plane will look like so we",
    "start": "226739",
    "end": "229049"
  },
  {
    "text": "decided to go with a centralized control",
    "start": "229049",
    "end": "231239"
  },
  {
    "text": "plan because as snow mentioned that",
    "start": "231239",
    "end": "233189"
  },
  {
    "text": "really helps you make changes very",
    "start": "233189",
    "end": "234930"
  },
  {
    "text": "quickly or you can deploy a single",
    "start": "234930",
    "end": "236790"
  },
  {
    "text": "server and like really change the way",
    "start": "236790",
    "end": "238919"
  },
  {
    "text": "that all the envoys are wired together",
    "start": "238919",
    "end": "240919"
  },
  {
    "text": "we also went to with the decision to",
    "start": "240919",
    "end": "243720"
  },
  {
    "text": "build our own control plane the main",
    "start": "243720",
    "end": "245759"
  },
  {
    "text": "reason for that is because we already",
    "start": "245759",
    "end": "247199"
  },
  {
    "text": "had a fairly sophisticated mechanism for",
    "start": "247199",
    "end": "249840"
  },
  {
    "text": "how traffic is routed at square and so",
    "start": "249840",
    "end": "252599"
  },
  {
    "text": "we felt like we really needed control",
    "start": "252599",
    "end": "253919"
  },
  {
    "text": "over all the knobs that envoy has in",
    "start": "253919",
    "end": "255900"
  },
  {
    "text": "order to make things look very similar",
    "start": "255900",
    "end": "258060"
  },
  {
    "text": "to the way they looked before but moving",
    "start": "258060",
    "end": "260549"
  },
  {
    "text": "on to envoy",
    "start": "260549",
    "end": "261930"
  },
  {
    "text": "so our control plane looks a little",
    "start": "261930",
    "end": "264630"
  },
  {
    "text": "something like this we use the Java",
    "start": "264630",
    "end": "267090"
  },
  {
    "text": "control plane library which is the same",
    "start": "267090",
    "end": "269850"
  },
  {
    "text": "as the go control plane one if you're",
    "start": "269850",
    "end": "271410"
  },
  {
    "text": "familiar with that it's on the omelet",
    "start": "271410",
    "end": "273210"
  },
  {
    "text": "proxy github the bottom part there is",
    "start": "273210",
    "end": "275850"
  },
  {
    "text": "the XDS server which was discussed in",
    "start": "275850",
    "end": "277979"
  },
  {
    "text": "the last talk so that's basically the",
    "start": "277979",
    "end": "279330"
  },
  {
    "text": "actual G RPC server that handles all the",
    "start": "279330",
    "end": "282050"
  },
  {
    "text": "version acknowledgement and all that",
    "start": "282050",
    "end": "284310"
  },
  {
    "text": "kind of stuff then there's a snapshot",
    "start": "284310",
    "end": "286410"
  },
  {
    "text": "cache which is a place where you after",
    "start": "286410",
    "end": "290430"
  },
  {
    "text": "you generate a given Envoy configuration",
    "start": "290430",
    "end": "292530"
  },
  {
    "text": "you save it into the cache where it can",
    "start": "292530",
    "end": "294840"
  },
  {
    "text": "be used later I'll walk through how",
    "start": "294840",
    "end": "297000"
  },
  {
    "text": "exactly that works in a second and then",
    "start": "297000",
    "end": "299190"
  },
  {
    "text": "the final piece is what we call the",
    "start": "299190",
    "end": "300930"
  },
  {
    "text": "snapshot Factory and so that's some code",
    "start": "300930",
    "end": "303030"
  },
  {
    "text": "that we wrote that's very specific to",
    "start": "303030",
    "end": "304590"
  },
  {
    "text": "the way squarer works and it generates",
    "start": "304590",
    "end": "307050"
  },
  {
    "text": "square specific envoy configuration on",
    "start": "307050",
    "end": "310260"
  },
  {
    "text": "the right we have the two primary data",
    "start": "310260",
    "end": "312120"
  },
  {
    "text": "sources that are control plane uses to",
    "start": "312120",
    "end": "315030"
  },
  {
    "text": "generate config we have an Access",
    "start": "315030",
    "end": "317190"
  },
  {
    "text": "Management registry that knows about",
    "start": "317190",
    "end": "319740"
  },
  {
    "text": "every micro service we deploy it also",
    "start": "319740",
    "end": "321840"
  },
  {
    "text": "knows which micro services talk to which",
    "start": "321840",
    "end": "323729"
  },
  {
    "text": "others so it knows the dependency graph",
    "start": "323729",
    "end": "325710"
  },
  {
    "text": "it also knows the identities of each",
    "start": "325710",
    "end": "328169"
  },
  {
    "text": "cert that the clients will be using so",
    "start": "328169",
    "end": "331110"
  },
  {
    "text": "we can use that for mt LS and then we",
    "start": "331110",
    "end": "333870"
  },
  {
    "text": "have a service discovery database that",
    "start": "333870",
    "end": "335430"
  },
  {
    "text": "of course tells us where on the network",
    "start": "335430",
    "end": "337110"
  },
  {
    "text": "certain pods are available it also has a",
    "start": "337110",
    "end": "339570"
  },
  {
    "text": "lot of traffic shaping information that",
    "start": "339570",
    "end": "341639"
  },
  {
    "text": "snow is going to talk about later in",
    "start": "341639",
    "end": "343289"
  },
  {
    "text": "more detail",
    "start": "343289",
    "end": "344419"
  },
  {
    "text": "so when a non-void boots up let's call",
    "start": "344419",
    "end": "347400"
  },
  {
    "text": "it foo envoy so it's associated with the",
    "start": "347400",
    "end": "349830"
  },
  {
    "text": "app foo it'll make an XDS request as",
    "start": "349830",
    "end": "352650"
  },
  {
    "text": "described in the last talk where it",
    "start": "352650",
    "end": "354389"
  },
  {
    "text": "doesn't yet have a version that it can",
    "start": "354389",
    "end": "356280"
  },
  {
    "text": "act so it sends an empty version are the",
    "start": "356280",
    "end": "359669"
  },
  {
    "text": "xes server will then look in the",
    "start": "359669",
    "end": "361050"
  },
  {
    "text": "snapshot cache or do I have a config",
    "start": "361050",
    "end": "363539"
  },
  {
    "text": "that's suitable for foo it doesn't so it",
    "start": "363539",
    "end": "366000"
  },
  {
    "text": "calls a callback in our code we then",
    "start": "366000",
    "end": "368699"
  },
  {
    "text": "pull in information from those two",
    "start": "368699",
    "end": "370830"
  },
  {
    "text": "databases generate a non-void",
    "start": "370830",
    "end": "372750"
  },
  {
    "text": "configuration for foo save it in the",
    "start": "372750",
    "end": "374490"
  },
  {
    "text": "snapshot cache and then the XDS server",
    "start": "374490",
    "end": "378030"
  },
  {
    "text": "is able to respond to that envoy and we",
    "start": "378030",
    "end": "381720"
  },
  {
    "text": "think that it's it's potentially",
    "start": "381720",
    "end": "383220"
  },
  {
    "text": "interesting that we're doing lazy",
    "start": "383220",
    "end": "384510"
  },
  {
    "text": "generation of snapshots here that's",
    "start": "384510",
    "end": "387030"
  },
  {
    "text": "really cool because it means you don't",
    "start": "387030",
    "end": "388440"
  },
  {
    "text": "have to pre-compute every possible",
    "start": "388440",
    "end": "390210"
  },
  {
    "text": "permutation of Envoy configuration you",
    "start": "390210",
    "end": "392010"
  },
  {
    "text": "might need up front and it also means",
    "start": "392010",
    "end": "394320"
  },
  {
    "text": "that we can pass up a ton of",
    "start": "394320",
    "end": "395460"
  },
  {
    "text": "information in the metadata of the XDS",
    "start": "395460",
    "end": "398310"
  },
  {
    "text": "requests and so we can do things like",
    "start": "398310",
    "end": "400139"
  },
  {
    "text": "toggle features on and off in the client",
    "start": "400139",
    "end": "402380"
  },
  {
    "text": "where we you pass your envoy some",
    "start": "402380",
    "end": "405180"
  },
  {
    "text": "configuration when it boots and then",
    "start": "405180",
    "end": "406620"
  },
  {
    "text": "that will later be used in the control",
    "start": "406620",
    "end": "408840"
  },
  {
    "text": "plane to decide which features to turn",
    "start": "408840",
    "end": "410880"
  },
  {
    "text": "on then if something changes so the",
    "start": "410880",
    "end": "414930"
  },
  {
    "text": "envoy re requests for version one",
    "start": "414930",
    "end": "416520"
  },
  {
    "text": "because it's last seen version one if",
    "start": "416520",
    "end": "419099"
  },
  {
    "text": "something changes in our databases our",
    "start": "419099",
    "end": "421800"
  },
  {
    "text": "snapshot factory can go ahead and create",
    "start": "421800",
    "end": "423419"
  },
  {
    "text": "a new snapshot configuration with a new",
    "start": "423419",
    "end": "425729"
  },
  {
    "text": "version and the XDS server will respond",
    "start": "425729",
    "end": "427770"
  },
  {
    "text": "with that and then our fou envoy re",
    "start": "427770",
    "end": "430470"
  },
  {
    "text": "requests to show you a little bit what",
    "start": "430470",
    "end": "433470"
  },
  {
    "text": "the control plane library gets you for",
    "start": "433470",
    "end": "435389"
  },
  {
    "text": "free if we have a second foo envoy",
    "start": "435389",
    "end": "437580"
  },
  {
    "text": "startup its able to just look in the",
    "start": "437580",
    "end": "439770"
  },
  {
    "text": "cache and respond and so our snapshot",
    "start": "439770",
    "end": "442289"
  },
  {
    "text": "factory didn't even get invoked didn't",
    "start": "442289",
    "end": "444479"
  },
  {
    "text": "have to do anything so it's very low",
    "start": "444479",
    "end": "446099"
  },
  {
    "text": "overhead if you have a lot of the same",
    "start": "446099",
    "end": "447810"
  },
  {
    "text": "configurations being served over and",
    "start": "447810",
    "end": "449610"
  },
  {
    "text": "over and then when we get an envoy with",
    "start": "449610",
    "end": "452520"
  },
  {
    "text": "a different identity bar we could kind",
    "start": "452520",
    "end": "455310"
  },
  {
    "text": "of go through that original flow where",
    "start": "455310",
    "end": "456599"
  },
  {
    "text": "you generate a bar configuration oh and",
    "start": "456599",
    "end": "462690"
  },
  {
    "text": "then when the foo envoys drop off the",
    "start": "462690",
    "end": "464639"
  },
  {
    "text": "network and stop requesting eventually a",
    "start": "464639",
    "end": "467250"
  },
  {
    "text": "garbage collection routine and the Java",
    "start": "467250",
    "end": "468780"
  },
  {
    "text": "control plane goes and clears out that",
    "start": "468780",
    "end": "470340"
  },
  {
    "text": "entry in the cache so that again helps",
    "start": "470340",
    "end": "472409"
  },
  {
    "text": "you not have to think about what kinds",
    "start": "472409",
    "end": "473880"
  },
  {
    "text": "of configs you need at a given moment",
    "start": "473880",
    "end": "475229"
  },
  {
    "text": "you can just generate whatever on-demand",
    "start": "475229",
    "end": "477979"
  },
  {
    "text": "or whatever requests come in and then",
    "start": "477979",
    "end": "480150"
  },
  {
    "text": "eventually they'll get cleaned up if",
    "start": "480150",
    "end": "481320"
  },
  {
    "text": "they stop being used alright so in",
    "start": "481320",
    "end": "484889"
  },
  {
    "text": "addition to the control thing itself we",
    "start": "484889",
    "end": "486690"
  },
  {
    "text": "felt that we needed to do some",
    "start": "486690",
    "end": "487710"
  },
  {
    "text": "additional work to make it safer for all",
    "start": "487710",
    "end": "489539"
  },
  {
    "text": "no changes to the control plane so",
    "start": "489539",
    "end": "493199"
  },
  {
    "text": "previously we were discovering the",
    "start": "493199",
    "end": "494909"
  },
  {
    "text": "control plane itself just using DNS and",
    "start": "494909",
    "end": "497340"
  },
  {
    "text": "like randomly picking a host of connect",
    "start": "497340",
    "end": "499469"
  },
  {
    "text": "to which meant that when were deployed a",
    "start": "499469",
    "end": "501630"
  },
  {
    "text": "new version in this case the bad version",
    "start": "501630",
    "end": "504440"
  },
  {
    "text": "probably no these English might only",
    "start": "504440",
    "end": "507210"
  },
  {
    "text": "restored van link boards connect to the",
    "start": "507210",
    "end": "509580"
  },
  {
    "text": "bad control plane and they bullets crash",
    "start": "509580",
    "end": "512039"
  },
  {
    "text": "like whatever happens was there's no",
    "start": "512039",
    "end": "514169"
  },
  {
    "text": "employee so we thought this was like",
    "start": "514169",
    "end": "517078"
  },
  {
    "text": "either being pretty risky whenever a",
    "start": "517079",
    "end": "518399"
  },
  {
    "text": "true look changes especially it changes",
    "start": "518399",
    "end": "522270"
  },
  {
    "text": "and I could not easily be controlled",
    "start": "522270",
    "end": "524370"
  },
  {
    "text": "within the app such as like a high-level",
    "start": "524370",
    "end": "526829"
  },
  {
    "text": "configuration changes",
    "start": "526829",
    "end": "528450"
  },
  {
    "text": "so we decided to put a proxy in front of",
    "start": "528450",
    "end": "530700"
  },
  {
    "text": "it because when it's all put more",
    "start": "530700",
    "end": "532440"
  },
  {
    "text": "process in the system and what does it",
    "start": "532440",
    "end": "536579"
  },
  {
    "text": "allows us to do is that when you deploy",
    "start": "536579",
    "end": "538790"
  },
  {
    "text": "you for sale about prefer playing the",
    "start": "538790",
    "end": "541800"
  },
  {
    "text": "proxy consults a feature service edge",
    "start": "541800",
    "end": "544139"
  },
  {
    "text": "flight service the use it because it",
    "start": "544139",
    "end": "546630"
  },
  {
    "text": "uses that alongside the metadata and",
    "start": "546630",
    "end": "548790"
  },
  {
    "text": "orestes --and-- which identifies the the",
    "start": "548790",
    "end": "552959"
  },
  {
    "text": "my so like which which akka runs next to",
    "start": "552959",
    "end": "555449"
  },
  {
    "text": "you all the soap and using that",
    "start": "555449",
    "end": "557610"
  },
  {
    "text": "alongside with the role I play the role",
    "start": "557610",
    "end": "559680"
  },
  {
    "text": "of Elias and the future like service I",
    "start": "559680",
    "end": "561389"
  },
  {
    "text": "can decide which control planet connects",
    "start": "561389",
    "end": "563670"
  },
  {
    "text": "to someone it does not remove no limited",
    "start": "563670",
    "end": "567329"
  },
  {
    "text": "the attack - by the boy - only this one",
    "start": "567329",
    "end": "570839"
  },
  {
    "text": "but it was quickly to the boat control",
    "start": "570839",
    "end": "572519"
  },
  {
    "text": "point and don't you see this we see this",
    "start": "572519",
    "end": "575370"
  },
  {
    "text": "boat we can flip it back just on water",
    "start": "575370",
    "end": "577500"
  },
  {
    "text": "flying the future flight and we can move",
    "start": "577500",
    "end": "579870"
  },
  {
    "text": "like the but no deploy good version and",
    "start": "579870",
    "end": "583500"
  },
  {
    "text": "then slowly move over so this is really",
    "start": "583500",
    "end": "586740"
  },
  {
    "text": "cool because it gives us essentially",
    "start": "586740",
    "end": "587940"
  },
  {
    "text": "granblue deploys of the control plane",
    "start": "587940",
    "end": "589529"
  },
  {
    "text": "and well we're still in the process of",
    "start": "589529",
    "end": "591600"
  },
  {
    "text": "broadens out it has given us a lot more",
    "start": "591600",
    "end": "594149"
  },
  {
    "text": "confidence in making bigger changes to",
    "start": "594149",
    "end": "597329"
  },
  {
    "text": "the control plane and ensuring that",
    "start": "597329",
    "end": "599010"
  },
  {
    "text": "doesn't take down the entire company",
    "start": "599010",
    "end": "602510"
  },
  {
    "text": "another piece of rolling out of service",
    "start": "603350",
    "end": "606120"
  },
  {
    "text": "mesh is actually migrating and this kind",
    "start": "606120",
    "end": "609240"
  },
  {
    "text": "of ends up being the most time intensive",
    "start": "609240",
    "end": "610829"
  },
  {
    "text": "part it's it's hard of harder than the",
    "start": "610829",
    "end": "613230"
  },
  {
    "text": "engineering pieces so at square we have",
    "start": "613230",
    "end": "615510"
  },
  {
    "text": "about 500 different micro services that",
    "start": "615510",
    "end": "618029"
  },
  {
    "text": "are deployed and we were three ICS",
    "start": "618029",
    "end": "619649"
  },
  {
    "text": "working on this so it was really key",
    "start": "619649",
    "end": "621690"
  },
  {
    "text": "that it's as easy as it could possibly",
    "start": "621690",
    "end": "623310"
  },
  {
    "text": "as we can possibly make it to my",
    "start": "623310",
    "end": "625529"
  },
  {
    "text": "greatest service so the first thing that",
    "start": "625529",
    "end": "628140"
  },
  {
    "text": "developers do when they want to add on",
    "start": "628140",
    "end": "629850"
  },
  {
    "text": "way to their service is they run a",
    "start": "629850",
    "end": "631170"
  },
  {
    "text": "command we give them called traffic CLI",
    "start": "631170",
    "end": "633149"
  },
  {
    "text": "ad envoy and that does basically all the",
    "start": "633149",
    "end": "635699"
  },
  {
    "text": "infrastructure things that need to go",
    "start": "635699",
    "end": "637050"
  },
  {
    "text": "into it it's going to be different for",
    "start": "637050",
    "end": "638160"
  },
  {
    "text": "everyone but the main thing it does is",
    "start": "638160",
    "end": "640140"
  },
  {
    "text": "actually deploy envoy into your pod",
    "start": "640140",
    "end": "641640"
  },
  {
    "text": "there's like ports that open things get",
    "start": "641640",
    "end": "644490"
  },
  {
    "text": "registered in various databases just",
    "start": "644490",
    "end": "647160"
  },
  {
    "text": "everything that you need to do to get it",
    "start": "647160",
    "end": "649019"
  },
  {
    "text": "deployed we also provide client and",
    "start": "649019",
    "end": "651839"
  },
  {
    "text": "server libraries in all the major",
    "start": "651839",
    "end": "653670"
  },
  {
    "text": "languages that use it's in use at square",
    "start": "653670",
    "end": "655550"
  },
  {
    "text": "and actually the server libraries kind",
    "start": "655550",
    "end": "658529"
  },
  {
    "text": "of just talk to the deployment system",
    "start": "658529",
    "end": "660180"
  },
  {
    "text": "and enable the listener",
    "start": "660180",
    "end": "662339"
  },
  {
    "text": "you get traffic in from envoy when you",
    "start": "662339",
    "end": "664319"
  },
  {
    "text": "do your deploy so that traffic seal I",
    "start": "664319",
    "end": "666629"
  },
  {
    "text": "add on voice step is all you have to do",
    "start": "666629",
    "end": "668309"
  },
  {
    "text": "to then be ready to receive traffic",
    "start": "668309",
    "end": "669749"
  },
  {
    "text": "ingress through your envoy which is",
    "start": "669749",
    "end": "671970"
  },
  {
    "text": "pretty cool",
    "start": "671970",
    "end": "672540"
  },
  {
    "text": "that's it takes like five minutes for",
    "start": "672540",
    "end": "673889"
  },
  {
    "text": "someone to do another thing that we",
    "start": "673889",
    "end": "676769"
  },
  {
    "text": "tried to do is keep the clients as",
    "start": "676769",
    "end": "678569"
  },
  {
    "text": "simple as possible so basically just",
    "start": "678569",
    "end": "680309"
  },
  {
    "text": "push as much stuff out into the proxy as",
    "start": "680309",
    "end": "682980"
  },
  {
    "text": "you can because that's gonna make it",
    "start": "682980",
    "end": "685379"
  },
  {
    "text": "much easier for someone to write a",
    "start": "685379",
    "end": "686850"
  },
  {
    "text": "client library if they want to start",
    "start": "686850",
    "end": "688800"
  },
  {
    "text": "using a new language that you haven't",
    "start": "688800",
    "end": "690240"
  },
  {
    "text": "been using before and so the way it",
    "start": "690240",
    "end": "692579"
  },
  {
    "text": "works is basically you send all your",
    "start": "692579",
    "end": "693990"
  },
  {
    "text": "requests to a UNIX socket I'll talk",
    "start": "693990",
    "end": "695790"
  },
  {
    "text": "about why we're using UNIX sockets later",
    "start": "695790",
    "end": "697309"
  },
  {
    "text": "and you format your hosts headers for",
    "start": "697309",
    "end": "699660"
  },
  {
    "text": "your HTTP requests as production or",
    "start": "699660",
    "end": "701339"
  },
  {
    "text": "staging dot the name of the server app",
    "start": "701339",
    "end": "703439"
  },
  {
    "text": "you want to talk to square and so that's",
    "start": "703439",
    "end": "705660"
  },
  {
    "text": "basically exactly the information that",
    "start": "705660",
    "end": "707220"
  },
  {
    "text": "developers know when they're developing",
    "start": "707220",
    "end": "709019"
  },
  {
    "text": "an integration they don't want to know",
    "start": "709019",
    "end": "710879"
  },
  {
    "text": "anything about load balance or host",
    "start": "710879",
    "end": "712110"
  },
  {
    "text": "names or IP addresses or whether they're",
    "start": "712110",
    "end": "713790"
  },
  {
    "text": "on the cloud or on-premises they know",
    "start": "713790",
    "end": "716309"
  },
  {
    "text": "what they're trying to talk to and",
    "start": "716309",
    "end": "718529"
  },
  {
    "text": "another thing that makes migration",
    "start": "718529",
    "end": "720180"
  },
  {
    "text": "possible for us is preserving the way",
    "start": "720180",
    "end": "722730"
  },
  {
    "text": "that our existing service discovery and",
    "start": "722730",
    "end": "725360"
  },
  {
    "text": "traffic shaping stuff works and we're",
    "start": "725360",
    "end": "727529"
  },
  {
    "text": "going to talk about that in detail later",
    "start": "727529",
    "end": "728910"
  },
  {
    "text": "but you're gonna live in a world where",
    "start": "728910",
    "end": "730800"
  },
  {
    "text": "you're halfway on Envoy and halfway not",
    "start": "730800",
    "end": "732509"
  },
  {
    "text": "and if that's if things are really",
    "start": "732509",
    "end": "734040"
  },
  {
    "text": "operating very differently that's going",
    "start": "734040",
    "end": "735449"
  },
  {
    "text": "to be a challenge and then we also have",
    "start": "735449",
    "end": "737790"
  },
  {
    "text": "a feature flag that we call the VIP to",
    "start": "737790",
    "end": "739949"
  },
  {
    "text": "mesh feature flag to show you what that",
    "start": "739949",
    "end": "742410"
  },
  {
    "text": "does we suppose we have a ring of three",
    "start": "742410",
    "end": "745350"
  },
  {
    "text": "micro services that all the circular",
    "start": "745350",
    "end": "747240"
  },
  {
    "text": "dependency on each other",
    "start": "747240",
    "end": "748290"
  },
  {
    "text": "Moe Larry and curly they talk to each",
    "start": "748290",
    "end": "751439"
  },
  {
    "text": "other through a VIP which is a virtual",
    "start": "751439",
    "end": "753209"
  },
  {
    "text": "IP that's sitting on a hardware a load",
    "start": "753209",
    "end": "754860"
  },
  {
    "text": "balancer somewhere and let's say that",
    "start": "754860",
    "end": "757079"
  },
  {
    "text": "Mo's team finally has some time to do",
    "start": "757079",
    "end": "759329"
  },
  {
    "text": "their own voicemail Gration so they do",
    "start": "759329",
    "end": "760649"
  },
  {
    "text": "traffic CLI at envoy there they have",
    "start": "760649",
    "end": "764220"
  },
  {
    "text": "envoy deployed in their pod but we",
    "start": "764220",
    "end": "765929"
  },
  {
    "text": "haven't done anything yet to actually",
    "start": "765929",
    "end": "767189"
  },
  {
    "text": "change the flow of traffic so it's still",
    "start": "767189",
    "end": "768959"
  },
  {
    "text": "going from Moe's VIP into the app and",
    "start": "768959",
    "end": "771209"
  },
  {
    "text": "the app is still talking to Curly's VIP",
    "start": "771209",
    "end": "773059"
  },
  {
    "text": "um so the the naive thing to do here",
    "start": "773059",
    "end": "776519"
  },
  {
    "text": "would then be to have them flip their",
    "start": "776519",
    "end": "777809"
  },
  {
    "text": "client configuration to start using the",
    "start": "777809",
    "end": "779610"
  },
  {
    "text": "mesh but there's no envoy on currently",
    "start": "779610",
    "end": "781920"
  },
  {
    "text": "side yet because they haven't gotten",
    "start": "781920",
    "end": "783089"
  },
  {
    "text": "around to it so what we ended up doing",
    "start": "783089",
    "end": "785550"
  },
  {
    "text": "is we have our control plane by default",
    "start": "785550",
    "end": "788309"
  },
  {
    "text": "you'll your envoy will send traffic to",
    "start": "788309",
    "end": "790139"
  },
  {
    "text": "that old VIP that we know is working",
    "start": "790139",
    "end": "792420"
  },
  {
    "text": "because we're already using it and then",
    "start": "792420",
    "end": "794309"
  },
  {
    "text": "later on when Curly's team gets a",
    "start": "794309",
    "end": "796250"
  },
  {
    "text": "to deploying their envoy they can flip a",
    "start": "796250",
    "end": "799220"
  },
  {
    "text": "feature flag that says hey I'm ready to",
    "start": "799220",
    "end": "801170"
  },
  {
    "text": "take traffic ingress through my envoy",
    "start": "801170",
    "end": "803090"
  },
  {
    "text": "and then our control plane will tell all",
    "start": "803090",
    "end": "804950"
  },
  {
    "text": "the clients to go through that so this",
    "start": "804950",
    "end": "807200"
  },
  {
    "text": "is really nice because it means that",
    "start": "807200",
    "end": "808370"
  },
  {
    "text": "Moe's team can finish their envoy",
    "start": "808370",
    "end": "810650"
  },
  {
    "text": "migration where they deploy their their",
    "start": "810650",
    "end": "813140"
  },
  {
    "text": "envoy they flip all their client",
    "start": "813140",
    "end": "814970"
  },
  {
    "text": "configuration and then they're done as",
    "start": "814970",
    "end": "817130"
  },
  {
    "text": "far as they're concerned they can go",
    "start": "817130",
    "end": "818390"
  },
  {
    "text": "back to the to writing their products",
    "start": "818390",
    "end": "820150"
  },
  {
    "text": "and curlies team later on sometime at",
    "start": "820150",
    "end": "823220"
  },
  {
    "text": "some point we'll flip a flag that",
    "start": "823220",
    "end": "824510"
  },
  {
    "text": "actually turns on the full mesh and then",
    "start": "824510",
    "end": "826970"
  },
  {
    "text": "when you continue this you eventually",
    "start": "826970",
    "end": "828860"
  },
  {
    "text": "get rid of all the VIPs and have a full",
    "start": "828860",
    "end": "831830"
  },
  {
    "text": "service mesh which is what we're trying",
    "start": "831830",
    "end": "833150"
  },
  {
    "text": "to get to one more thing that's pretty",
    "start": "833150",
    "end": "836900"
  },
  {
    "text": "important if you're using envoy is and",
    "start": "836900",
    "end": "839660"
  },
  {
    "text": "you're using TLS internally is being",
    "start": "839660",
    "end": "841910"
  },
  {
    "text": "able to offload that into the proxy so",
    "start": "841910",
    "end": "844340"
  },
  {
    "text": "you want to be able to take advantage of",
    "start": "844340",
    "end": "845810"
  },
  {
    "text": "all the layer 7 features that envoy has",
    "start": "845810",
    "end": "847670"
  },
  {
    "text": "like tracing and metrics and request",
    "start": "847670",
    "end": "850310"
  },
  {
    "text": "level load balancing and it's also nice",
    "start": "850310",
    "end": "853310"
  },
  {
    "text": "to be able to enforce TLS in the proxy",
    "start": "853310",
    "end": "856160"
  },
  {
    "text": "layer so you're not depending on client",
    "start": "856160",
    "end": "858020"
  },
  {
    "text": "like app configuration to do it and for",
    "start": "858020",
    "end": "861710"
  },
  {
    "text": "us as Snow mentioned earlier we're not",
    "start": "861710",
    "end": "863990"
  },
  {
    "text": "using containers with Network namespaces",
    "start": "863990",
    "end": "866030"
  },
  {
    "text": "yet so that's why we're using UNIX",
    "start": "866030",
    "end": "867800"
  },
  {
    "text": "sockets for egress traffic so the app is",
    "start": "867800",
    "end": "870920"
  },
  {
    "text": "talking unencrypted HTTP to the proxy",
    "start": "870920",
    "end": "873530"
  },
  {
    "text": "into a UNIX socket that's protected with",
    "start": "873530",
    "end": "875810"
  },
  {
    "text": "file system permissions and so that lets",
    "start": "875810",
    "end": "877850"
  },
  {
    "text": "us kind of get the behavior of having a",
    "start": "877850",
    "end": "879610"
  },
  {
    "text": "private network on loopback without",
    "start": "879610",
    "end": "882470"
  },
  {
    "text": "actually being able to do that yet and",
    "start": "882470",
    "end": "884900"
  },
  {
    "text": "then we are still having Apps server",
    "start": "884900",
    "end": "887510"
  },
  {
    "text": "apps enforce the layer 7 access control",
    "start": "887510",
    "end": "889520"
  },
  {
    "text": "so if you want /foo 2 to be allowed for",
    "start": "889520",
    "end": "892610"
  },
  {
    "text": "a certain client but not slash bar the",
    "start": "892610",
    "end": "894830"
  },
  {
    "text": "apps still have to enforce that that's",
    "start": "894830",
    "end": "896630"
  },
  {
    "text": "something we want to do later but we",
    "start": "896630",
    "end": "898400"
  },
  {
    "text": "facilitate that with having envoy passed",
    "start": "898400",
    "end": "900200"
  },
  {
    "text": "client details in an HTTP header on",
    "start": "900200",
    "end": "903290"
  },
  {
    "text": "every request all right so you don't",
    "start": "903290",
    "end": "906440"
  },
  {
    "text": "want to talk about some of the traffic",
    "start": "906440",
    "end": "908420"
  },
  {
    "text": "shaping and routing features seven years",
    "start": "908420",
    "end": "910040"
  },
  {
    "text": "and most of these always have been in",
    "start": "910040",
    "end": "913670"
  },
  {
    "text": "order to so i replicate the existing",
    "start": "913670",
    "end": "916580"
  },
  {
    "text": "purpose a framework that we had again",
    "start": "916580",
    "end": "918740"
  },
  {
    "text": "because that's my might say we want to",
    "start": "918740",
    "end": "920450"
  },
  {
    "text": "make sure that people can",
    "start": "920450",
    "end": "922260"
  },
  {
    "text": "in this transitionary world without",
    "start": "922260",
    "end": "924780"
  },
  {
    "text": "having to like know who's calling you so",
    "start": "924780",
    "end": "927360"
  },
  {
    "text": "make everything look the same so first I",
    "start": "927360",
    "end": "930660"
  },
  {
    "text": "want to go quickly over like what the",
    "start": "930660",
    "end": "931980"
  },
  {
    "text": "service is covering all that is not good",
    "start": "931980",
    "end": "933990"
  },
  {
    "text": "square where you have the app will just",
    "start": "933990",
    "end": "935790"
  },
  {
    "text": "like the routable target and then your",
    "start": "935790",
    "end": "939030"
  },
  {
    "text": "channel contains multiple deployments",
    "start": "939030",
    "end": "940530"
  },
  {
    "text": "corresponds like a cluster of clothes so",
    "start": "940530",
    "end": "944900"
  },
  {
    "text": "when you would target in hacked you'll",
    "start": "944900",
    "end": "947220"
  },
  {
    "text": "hit one of their deployments and the",
    "start": "947220",
    "end": "950100"
  },
  {
    "text": "Palomas can be the same or they can be",
    "start": "950100",
    "end": "951480"
  },
  {
    "text": "select a different different",
    "start": "951480",
    "end": "952620"
  },
  {
    "text": "configuration they were running a",
    "start": "952620",
    "end": "954870"
  },
  {
    "text": "different version but politically really",
    "start": "954870",
    "end": "960030"
  },
  {
    "text": "good thing up additionally each",
    "start": "960030",
    "end": "962880"
  },
  {
    "text": "deployment exists within a data center",
    "start": "962880",
    "end": "964710"
  },
  {
    "text": "which describes their physical location",
    "start": "964710",
    "end": "966180"
  },
  {
    "text": "in the world and so was this it was",
    "start": "966180",
    "end": "971310"
  },
  {
    "text": "important for us to ensure like traffic",
    "start": "971310",
    "end": "974280"
  },
  {
    "text": "always prefers the most as possible",
    "start": "974280",
    "end": "976740"
  },
  {
    "text": "data's him so in the case where you have",
    "start": "976740",
    "end": "979590"
  },
  {
    "text": "and we're running and one datacenter 22",
    "start": "979590",
    "end": "982470"
  },
  {
    "text": "different deployments this is one out to",
    "start": "982470",
    "end": "984930"
  },
  {
    "text": "the point one of the same thing center",
    "start": "984930",
    "end": "986970"
  },
  {
    "text": "one one in in every datacenter and you",
    "start": "986970",
    "end": "989730"
  },
  {
    "text": "want to prefer something traumatic to",
    "start": "989730",
    "end": "991080"
  },
  {
    "text": "the first one and then start failing",
    "start": "991080",
    "end": "993810"
  },
  {
    "text": "over to the other one only has the",
    "start": "993810",
    "end": "995850"
  },
  {
    "text": "second one becomes available the first",
    "start": "995850",
    "end": "997680"
  },
  {
    "text": "one becomes unavailable something that",
    "start": "997680",
    "end": "1000020"
  },
  {
    "text": "this we simply issues in with priorities",
    "start": "1000020",
    "end": "1001880"
  },
  {
    "text": "you know the control point will generate",
    "start": "1001880",
    "end": "1004850"
  },
  {
    "text": "based on they where the client this will",
    "start": "1004850",
    "end": "1007610"
  },
  {
    "text": "generate the priorities by looking at",
    "start": "1007610",
    "end": "1009830"
  },
  {
    "text": "like a pre-order list of data centers so",
    "start": "1009830",
    "end": "1012680"
  },
  {
    "text": "we knew",
    "start": "1012680",
    "end": "1013850"
  },
  {
    "text": "prioritize them in order of personally",
    "start": "1013850",
    "end": "1016690"
  },
  {
    "text": "additionally we love app users to kind",
    "start": "1016690",
    "end": "1021050"
  },
  {
    "text": "of mess with this concept by introducing",
    "start": "1021050",
    "end": "1022880"
  },
  {
    "text": "waiver for commercial data centers which",
    "start": "1022880",
    "end": "1025640"
  },
  {
    "text": "is the ability for them to put your data",
    "start": "1025640",
    "end": "1027410"
  },
  {
    "text": "centers into the same data center so",
    "start": "1027410",
    "end": "1030199"
  },
  {
    "text": "that they can say I'll treat these to us",
    "start": "1030200",
    "end": "1031880"
  },
  {
    "text": "that they're the same thing Center what",
    "start": "1031880",
    "end": "1033500"
  },
  {
    "text": "essentially puts them gives them the",
    "start": "1033500",
    "end": "1035480"
  },
  {
    "text": "priority of like the closest data center",
    "start": "1035480",
    "end": "1037720"
  },
  {
    "text": "this becomes really useful when you use",
    "start": "1037720",
    "end": "1041990"
  },
  {
    "text": "it alongside locality waiting which is",
    "start": "1041990",
    "end": "1043939"
  },
  {
    "text": "where we use in order to allow an",
    "start": "1043940",
    "end": "1045380"
  },
  {
    "text": "alchemist to assign weights during the",
    "start": "1045380",
    "end": "1048110"
  },
  {
    "text": "vigil deployments this instructs anyway",
    "start": "1048110",
    "end": "1051590"
  },
  {
    "text": "to load balance accordingly",
    "start": "1051590",
    "end": "1053660"
  },
  {
    "text": "so this can",
    "start": "1053660",
    "end": "1054320"
  },
  {
    "text": "like when I bake it's more traffic than",
    "start": "1054320",
    "end": "1057740"
  },
  {
    "text": "deployment a and giving up owners the",
    "start": "1057740",
    "end": "1061520"
  },
  {
    "text": "ability to flip these changes as they",
    "start": "1061520",
    "end": "1063410"
  },
  {
    "text": "please",
    "start": "1063410",
    "end": "1064640"
  },
  {
    "text": "becomes really powerful because they're",
    "start": "1064640",
    "end": "1066440"
  },
  {
    "text": "they give them a lot of flexibility they",
    "start": "1066440",
    "end": "1068480"
  },
  {
    "text": "can do going blue deploys they can do",
    "start": "1068480",
    "end": "1071480"
  },
  {
    "text": "[Music]",
    "start": "1071480",
    "end": "1073750"
  },
  {
    "text": "gradual failures between data centers",
    "start": "1073750",
    "end": "1075680"
  },
  {
    "text": "about utilizing virtual data centers",
    "start": "1075680",
    "end": "1077450"
  },
  {
    "text": "alongside this essentially you have two",
    "start": "1077450",
    "end": "1079070"
  },
  {
    "text": "davis owners you put them in a virtual",
    "start": "1079070",
    "end": "1080450"
  },
  {
    "text": "data center and now you can just control",
    "start": "1080450",
    "end": "1082070"
  },
  {
    "text": "chuffy between the two of them so we can",
    "start": "1082070",
    "end": "1084200"
  },
  {
    "text": "do consider doing a buyer switch you can",
    "start": "1084200",
    "end": "1085940"
  },
  {
    "text": "slowly bleed the traffic number so as I",
    "start": "1085940",
    "end": "1090530"
  },
  {
    "text": "mentioned the deployments have slightly",
    "start": "1090530",
    "end": "1092150"
  },
  {
    "text": "different configurations so their use",
    "start": "1092150",
    "end": "1094970"
  },
  {
    "text": "cases in which apps want to target a",
    "start": "1094970",
    "end": "1098420"
  },
  {
    "text": "specific one so to do this we associate",
    "start": "1098420",
    "end": "1103550"
  },
  {
    "text": "metadata with each of the deployments",
    "start": "1103550",
    "end": "1105560"
  },
  {
    "text": "and used a subsidy balancer essential",
    "start": "1105560",
    "end": "1109790"
  },
  {
    "text": "earliness let me look people to put on",
    "start": "1109790",
    "end": "1111440"
  },
  {
    "text": "the effluents whenever run time thirst",
    "start": "1111440",
    "end": "1114140"
  },
  {
    "text": "and they'll be updated in real time",
    "start": "1114140",
    "end": "1116950"
  },
  {
    "text": "which allows a client sheera specify",
    "start": "1116950",
    "end": "1119810"
  },
  {
    "text": "where they want chocolate ago when it",
    "start": "1119810",
    "end": "1121880"
  },
  {
    "text": "says setting header this case you're",
    "start": "1121880",
    "end": "1123440"
  },
  {
    "text": "gonna target the mass and we've also",
    "start": "1123440",
    "end": "1124520"
  },
  {
    "text": "just specify one reader will ensure that",
    "start": "1124520",
    "end": "1127130"
  },
  {
    "text": "all your traffic only hits the points",
    "start": "1127130",
    "end": "1128990"
  },
  {
    "text": "with the specified label so similarly",
    "start": "1128990",
    "end": "1131680"
  },
  {
    "text": "now that you can hear me to label which",
    "start": "1131680",
    "end": "1135260"
  },
  {
    "text": "will now head possible and being able to",
    "start": "1135260",
    "end": "1138350"
  },
  {
    "text": "move this these labels around at runtime",
    "start": "1138350",
    "end": "1140480"
  },
  {
    "text": "it makes them really powerful and",
    "start": "1140480",
    "end": "1142910"
  },
  {
    "text": "flexible when it comes to failing what",
    "start": "1142910",
    "end": "1146900"
  },
  {
    "text": "we're not just traffic but also like",
    "start": "1146900",
    "end": "1148900"
  },
  {
    "text": "[Music]",
    "start": "1148900",
    "end": "1150010"
  },
  {
    "text": "stuff like which is the master site like",
    "start": "1150010",
    "end": "1153650"
  },
  {
    "text": "was responsible right into the database",
    "start": "1153650",
    "end": "1155300"
  },
  {
    "text": "in an active active system so you can",
    "start": "1155300",
    "end": "1158180"
  },
  {
    "text": "use this both sort of what the clients",
    "start": "1158180",
    "end": "1159860"
  },
  {
    "text": "calling the app and internally you can",
    "start": "1159860",
    "end": "1161870"
  },
  {
    "text": "proxy all these use the same labels so",
    "start": "1161870",
    "end": "1164480"
  },
  {
    "text": "you can you get a lot of flexibility",
    "start": "1164480",
    "end": "1167780"
  },
  {
    "text": "from this and so the last thing that i",
    "start": "1167780",
    "end": "1172640"
  },
  {
    "text": "want to talk about is my choice",
    "start": "1172640",
    "end": "1174740"
  },
  {
    "text": "so where every request a lot of a",
    "start": "1174740",
    "end": "1180440"
  },
  {
    "text": "requests are very important because it's",
    "start": "1180440",
    "end": "1182360"
  },
  {
    "text": "payments and one because fails",
    "start": "1182360",
    "end": "1185299"
  },
  {
    "text": "somebody's not getting paid so a lot of",
    "start": "1185299",
    "end": "1189500"
  },
  {
    "text": "cases we really wanna make sure that",
    "start": "1189500",
    "end": "1190820"
  },
  {
    "text": "requests succeed so even use of won't",
    "start": "1190820",
    "end": "1193370"
  },
  {
    "text": "only to the end of my career choice but",
    "start": "1193370",
    "end": "1195740"
  },
  {
    "text": "also a bunch of smart retry so the idea",
    "start": "1195740",
    "end": "1200210"
  },
  {
    "text": "being the when you retry request do you",
    "start": "1200210",
    "end": "1202730"
  },
  {
    "text": "want to make use of the information from",
    "start": "1202730",
    "end": "1204080"
  },
  {
    "text": "previous attempts to improve your",
    "start": "1204080",
    "end": "1206510"
  },
  {
    "text": "chances so the interesting one most",
    "start": "1206510",
    "end": "1209990"
  },
  {
    "text": "interesting one is the cross latest",
    "start": "1209990",
    "end": "1211250"
  },
  {
    "text": "entry choice which is the idea but for",
    "start": "1211250",
    "end": "1213950"
  },
  {
    "text": "cases where you have an active active",
    "start": "1213950",
    "end": "1215330"
  },
  {
    "text": "setup where in multiple data centers you",
    "start": "1215330",
    "end": "1218299"
  },
  {
    "text": "have all the resources somewhat",
    "start": "1218299",
    "end": "1220309"
  },
  {
    "text": "duplicate you have two clusters of",
    "start": "1220309",
    "end": "1222620"
  },
  {
    "text": "databases a shorter database in 1h data",
    "start": "1222620",
    "end": "1225320"
  },
  {
    "text": "center yes it's the sugary regime would",
    "start": "1225320",
    "end": "1227960"
  },
  {
    "text": "be partially down and the closest data",
    "start": "1227960",
    "end": "1229610"
  },
  {
    "text": "center so one shortest down you're still",
    "start": "1229610",
    "end": "1232010"
  },
  {
    "text": "a bit to serve traffic 90% of traffic's",
    "start": "1232010",
    "end": "1234110"
  },
  {
    "text": "is succeeding you don't want to go and",
    "start": "1234110",
    "end": "1236480"
  },
  {
    "text": "healthy but 10% of junkies is",
    "start": "1236480",
    "end": "1238789"
  },
  {
    "text": "consistently failing because the",
    "start": "1238789",
    "end": "1240200"
  },
  {
    "text": "shortest in so it happens in the older",
    "start": "1240200",
    "end": "1244070"
  },
  {
    "text": "data center those the entire resources",
    "start": "1244070",
    "end": "1247159"
  },
  {
    "text": "available well it was very different",
    "start": "1247159",
    "end": "1249620"
  },
  {
    "text": "when you target just with minorities you",
    "start": "1249620",
    "end": "1252409"
  },
  {
    "text": "will never go down to the second",
    "start": "1252409",
    "end": "1254840"
  },
  {
    "text": "priority unless the first priority is",
    "start": "1254840",
    "end": "1258669"
  },
  {
    "text": "unavailable or healthiest away so we",
    "start": "1258669",
    "end": "1261950"
  },
  {
    "text": "configured what you use in the first few",
    "start": "1261950",
    "end": "1265669"
  },
  {
    "text": "rich wise to and if both of us fail it",
    "start": "1265669",
    "end": "1269539"
  },
  {
    "text": "won't Joseph Mooney table and it's in",
    "start": "1269539",
    "end": "1272179"
  },
  {
    "text": "the next year will request to the second",
    "start": "1272179",
    "end": "1274700"
  },
  {
    "text": "datacenter and this is like very",
    "start": "1274700",
    "end": "1276409"
  },
  {
    "text": "important from wonderful very highly",
    "start": "1276409",
    "end": "1277730"
  },
  {
    "text": "available active aqua so knows because",
    "start": "1277730",
    "end": "1279710"
  },
  {
    "text": "they've again they've been relying on",
    "start": "1279710",
    "end": "1281450"
  },
  {
    "text": "this behavior in our existing system so",
    "start": "1281450",
    "end": "1284090"
  },
  {
    "text": "instead of putting this logic in the app",
    "start": "1284090",
    "end": "1286100"
  },
  {
    "text": "you have in the RPC layer see it's kind",
    "start": "1286100",
    "end": "1288710"
  },
  {
    "text": "of nice automatic failover between data",
    "start": "1288710",
    "end": "1290899"
  },
  {
    "text": "centers when returns affecting the rule",
    "start": "1290899",
    "end": "1295039"
  },
  {
    "text": "doesn't mean we can you just use this",
    "start": "1295039",
    "end": "1296090"
  },
  {
    "text": "make sure you are getting W up strange",
    "start": "1296090",
    "end": "1297799"
  },
  {
    "text": "so just yeah just use it just configure",
    "start": "1297799",
    "end": "1300380"
  },
  {
    "text": "it um so to to talk a bit about where we",
    "start": "1300380",
    "end": "1306080"
  },
  {
    "text": "are now with our migration we have",
    "start": "1306080",
    "end": "1308750"
  },
  {
    "text": "feature parity with our old system so",
    "start": "1308750",
    "end": "1310640"
  },
  {
    "text": "all the same traffic shaping retry",
    "start": "1310640",
    "end": "1312980"
  },
  {
    "text": "behavior service discovery things",
    "start": "1312980",
    "end": "1316240"
  },
  {
    "text": "we have envoy currently partially rolled",
    "start": "1316240",
    "end": "1318880"
  },
  {
    "text": "out there are somewhere like around 120",
    "start": "1318880",
    "end": "1321760"
  },
  {
    "text": "or 140 different micro services that are",
    "start": "1321760",
    "end": "1323890"
  },
  {
    "text": "using envoy 2000 sidecars total I think",
    "start": "1323890",
    "end": "1327340"
  },
  {
    "text": "will get pretty close to 10,000 when",
    "start": "1327340",
    "end": "1329290"
  },
  {
    "text": "we're done and we're using envoy both",
    "start": "1329290",
    "end": "1332190"
  },
  {
    "text": "on-premises and in the cloud very",
    "start": "1332190",
    "end": "1334540"
  },
  {
    "text": "limited in the cloud but we are already",
    "start": "1334540",
    "end": "1335860"
  },
  {
    "text": "seeing that benefit of being able to",
    "start": "1335860",
    "end": "1338380"
  },
  {
    "text": "abstract the platform that the app is",
    "start": "1338380",
    "end": "1340120"
  },
  {
    "text": "running on and like just talk to the",
    "start": "1340120",
    "end": "1341710"
  },
  {
    "text": "thing that I want to talk to so what's",
    "start": "1341710",
    "end": "1344980"
  },
  {
    "text": "next for us of course we're going to",
    "start": "1344980",
    "end": "1346690"
  },
  {
    "text": "finish this migration get rid of those",
    "start": "1346690",
    "end": "1348730"
  },
  {
    "text": "Hardware load balancers all that good",
    "start": "1348730",
    "end": "1350470"
  },
  {
    "text": "stuff in 2019 we're also going to look",
    "start": "1350470",
    "end": "1353110"
  },
  {
    "text": "into migrating to kubernetes so we're",
    "start": "1353110",
    "end": "1356020"
  },
  {
    "text": "interested in chatting with people this",
    "start": "1356020",
    "end": "1357670"
  },
  {
    "text": "week to get people's wisdom on that we",
    "start": "1357670",
    "end": "1360940"
  },
  {
    "text": "are excited to try out spiffy",
    "start": "1360940",
    "end": "1362620"
  },
  {
    "text": "integration particularly using envoy",
    "start": "1362620",
    "end": "1364660"
  },
  {
    "text": "secrets discovery service API which lets",
    "start": "1364660",
    "end": "1367390"
  },
  {
    "text": "you do sir tro tation on a really",
    "start": "1367390",
    "end": "1369880"
  },
  {
    "text": "regular basis without having to do any",
    "start": "1369880",
    "end": "1371860"
  },
  {
    "text": "restarts of processes we also want to",
    "start": "1371860",
    "end": "1374860"
  },
  {
    "text": "push layer 7 access control out of our",
    "start": "1374860",
    "end": "1377530"
  },
  {
    "text": "server applications and into envoy",
    "start": "1377530",
    "end": "1379810"
  },
  {
    "text": "itself and then we're gonna look into",
    "start": "1379810",
    "end": "1382930"
  },
  {
    "text": "also replacing our edge and forward",
    "start": "1382930",
    "end": "1385210"
  },
  {
    "text": "proxies with envoy so that we can just",
    "start": "1385210",
    "end": "1386800"
  },
  {
    "text": "have one proxy to to be familiar with",
    "start": "1386800",
    "end": "1391530"
  },
  {
    "text": "that's all we have today I have our",
    "start": "1391530",
    "end": "1394690"
  },
  {
    "text": "email addresses and Twitter handles on",
    "start": "1394690",
    "end": "1396670"
  },
  {
    "text": "there if anyone wants to ask us",
    "start": "1396670",
    "end": "1397960"
  },
  {
    "text": "questions afterwards I think we looks",
    "start": "1397960",
    "end": "1400480"
  },
  {
    "text": "like we might have a few minutes for so",
    "start": "1400480",
    "end": "1403030"
  },
  {
    "text": "we have three minutes for your questions",
    "start": "1403030",
    "end": "1404350"
  },
  {
    "text": "if anyone has any",
    "start": "1404350",
    "end": "1407190"
  },
  {
    "text": "the question was have we are we running",
    "start": "1414900",
    "end": "1418050"
  },
  {
    "text": "envoy as a container or as a normal",
    "start": "1418050",
    "end": "1420120"
  },
  {
    "text": "process right now we're using it as a",
    "start": "1420120",
    "end": "1422280"
  },
  {
    "text": "normal process for a little bit we had",
    "start": "1422280",
    "end": "1424530"
  },
  {
    "text": "we're trying it with docker but for for",
    "start": "1424530",
    "end": "1426809"
  },
  {
    "text": "unrelated reasons we decided to roll",
    "start": "1426809",
    "end": "1428430"
  },
  {
    "text": "that back we have not done any horse",
    "start": "1428430",
    "end": "1430530"
  },
  {
    "text": "racing or anything like that",
    "start": "1430530",
    "end": "1431820"
  },
  {
    "text": "comparing the two but it works totally",
    "start": "1431820",
    "end": "1433440"
  },
  {
    "text": "fine as a normal process",
    "start": "1433440",
    "end": "1436490"
  },
  {
    "text": "yeah oh yeah of course was how high",
    "start": "1444110",
    "end": "1450360"
  },
  {
    "text": "available we share for the control plane",
    "start": "1450360",
    "end": "1453530"
  },
  {
    "text": "so first off it's somewhat point design",
    "start": "1453530",
    "end": "1457410"
  },
  {
    "text": "it's the entire system is resilient to",
    "start": "1457410",
    "end": "1459690"
  },
  {
    "text": "the control plane going down the control",
    "start": "1459690",
    "end": "1462390"
  },
  {
    "text": "band being unavailable simply means our",
    "start": "1462390",
    "end": "1464040"
  },
  {
    "text": "conferences are no longer being",
    "start": "1464040",
    "end": "1465360"
  },
  {
    "text": "propagated which is fine for it just",
    "start": "1465360",
    "end": "1470610"
  },
  {
    "text": "means in our case it means that if hosts",
    "start": "1470610",
    "end": "1473670"
  },
  {
    "text": "are moved around they won't be updated",
    "start": "1473670",
    "end": "1475350"
  },
  {
    "text": "immediately if I deploy a planner sting",
    "start": "1475350",
    "end": "1477360"
  },
  {
    "text": "goes out it's not going to get",
    "start": "1477360",
    "end": "1478410"
  },
  {
    "text": "propagated up so short failure like I",
    "start": "1478410",
    "end": "1481230"
  },
  {
    "text": "have like a temporary family of the",
    "start": "1481230",
    "end": "1482790"
  },
  {
    "text": "control plane is not like that that's",
    "start": "1482790",
    "end": "1486840"
  },
  {
    "text": "said we do run it multiple instances so",
    "start": "1486840",
    "end": "1489360"
  },
  {
    "text": "we have maybe six or seven instances",
    "start": "1489360",
    "end": "1491610"
  },
  {
    "text": "running so the individual host goes down",
    "start": "1491610",
    "end": "1493500"
  },
  {
    "text": "this is all just again with the proxy",
    "start": "1493500",
    "end": "1498900"
  },
  {
    "text": "Isabelle is aware of all of the backend",
    "start": "1498900",
    "end": "1501090"
  },
  {
    "text": "hosts and below don'ts between them so",
    "start": "1501090",
    "end": "1503370"
  },
  {
    "text": "not going just retry in two different",
    "start": "1503370",
    "end": "1505080"
  },
  {
    "text": "one if one is unavailable and then",
    "start": "1505080",
    "end": "1507929"
  },
  {
    "text": "there's also caching in the control",
    "start": "1507929",
    "end": "1509790"
  },
  {
    "text": "plane itself of like so if the the",
    "start": "1509790",
    "end": "1512610"
  },
  {
    "text": "primary data sources like service",
    "start": "1512610",
    "end": "1514110"
  },
  {
    "text": "discovery or access database go away",
    "start": "1514110",
    "end": "1516179"
  },
  {
    "text": "you'll you'll be able to run on those",
    "start": "1516179",
    "end": "1517950"
  },
  {
    "text": "old configs for a while so I guess like",
    "start": "1517950",
    "end": "1519900"
  },
  {
    "text": "as long as your service topology isn't",
    "start": "1519900",
    "end": "1521820"
  },
  {
    "text": "moving too much you'll be okay for a",
    "start": "1521820",
    "end": "1523200"
  },
  {
    "text": "little bit",
    "start": "1523200",
    "end": "1525500"
  },
  {
    "text": "um we haven't really seen a problem with",
    "start": "1530470",
    "end": "1533480"
  },
  {
    "text": "that I mean it's things kind of are",
    "start": "1533480",
    "end": "1535670"
  },
  {
    "text": "coming and going at a slow rate the",
    "start": "1535670",
    "end": "1537110"
  },
  {
    "text": "question was do we see problems with",
    "start": "1537110",
    "end": "1538250"
  },
  {
    "text": "control planes not being in sync but in",
    "start": "1538250",
    "end": "1540860"
  },
  {
    "text": "practice processes are not moving around",
    "start": "1540860",
    "end": "1542720"
  },
  {
    "text": "so frequently that that's a problem if",
    "start": "1542720",
    "end": "1544490"
  },
  {
    "text": "you do a little time traveling we",
    "start": "1544490",
    "end": "1546440"
  },
  {
    "text": "haven't really seen a problem with that",
    "start": "1546440",
    "end": "1549399"
  },
  {
    "text": "the question was about our keeping our",
    "start": "1564970",
    "end": "1567770"
  },
  {
    "text": "clients simple how does that work so for",
    "start": "1567770",
    "end": "1570920"
  },
  {
    "text": "now we so we've been using clients that",
    "start": "1570920",
    "end": "1575360"
  },
  {
    "text": "have very heavy amyl configuration for a",
    "start": "1575360",
    "end": "1577490"
  },
  {
    "text": "long time which is and we use mana repos",
    "start": "1577490",
    "end": "1579920"
  },
  {
    "text": "pretty extensively so it was pretty easy",
    "start": "1579920",
    "end": "1581510"
  },
  {
    "text": "for us to just like change the config",
    "start": "1581510",
    "end": "1583580"
  },
  {
    "text": "structure and then people just rewrite",
    "start": "1583580",
    "end": "1585410"
  },
  {
    "text": "their there yeah mile config and then",
    "start": "1585410",
    "end": "1586880"
  },
  {
    "text": "now they're using our Envoy client we",
    "start": "1586880",
    "end": "1588500"
  },
  {
    "text": "wrote for retry behavior we use",
    "start": "1588500",
    "end": "1591620"
  },
  {
    "text": "protobufs",
    "start": "1591620",
    "end": "1592280"
  },
  {
    "text": "almost everywhere and we have special",
    "start": "1592280",
    "end": "1593990"
  },
  {
    "text": "annotations that dictate like what the",
    "start": "1593990",
    "end": "1596210"
  },
  {
    "text": "per try timeout should be clients decide",
    "start": "1596210",
    "end": "1599330"
  },
  {
    "text": "the the overall timeout themselves and",
    "start": "1599330",
    "end": "1602420"
  },
  {
    "text": "we're not using circuit breaking or",
    "start": "1602420",
    "end": "1603770"
  },
  {
    "text": "anything like that yet because we've not",
    "start": "1603770",
    "end": "1605300"
  },
  {
    "text": "wanted to surprise anyone with like all",
    "start": "1605300",
    "end": "1607130"
  },
  {
    "text": "of a sudden requests are failing and its",
    "start": "1607130",
    "end": "1608390"
  },
  {
    "text": "envoys fault that's something that we",
    "start": "1608390",
    "end": "1610250"
  },
  {
    "text": "want to do at some point but for now we",
    "start": "1610250",
    "end": "1611960"
  },
  {
    "text": "just set everything to like 10,000",
    "start": "1611960",
    "end": "1613460"
  },
  {
    "text": "another thing we did that was nice with",
    "start": "1613460",
    "end": "1615410"
  },
  {
    "text": "the clients was that they basically edit",
    "start": "1615410",
    "end": "1617750"
  },
  {
    "text": "existing HTTP clients which already had",
    "start": "1617750",
    "end": "1620450"
  },
  {
    "text": "like retry and timeline features so we",
    "start": "1620450",
    "end": "1623390"
  },
  {
    "text": "just converted that con thing to just",
    "start": "1623390",
    "end": "1624770"
  },
  {
    "text": "set the right Harris so that instead of",
    "start": "1624770",
    "end": "1626270"
  },
  {
    "text": "having the client have to enforce it now",
    "start": "1626270",
    "end": "1627950"
  },
  {
    "text": "anyways doing it yeah in the back",
    "start": "1627950",
    "end": "1633730"
  },
  {
    "text": "the question was are we using envoy in",
    "start": "1646200",
    "end": "1648730"
  },
  {
    "text": "front of our databases we're not yet",
    "start": "1648730",
    "end": "1650560"
  },
  {
    "text": "that's something we might do at some",
    "start": "1650560",
    "end": "1652390"
  },
  {
    "text": "point because it could make the the",
    "start": "1652390",
    "end": "1653650"
  },
  {
    "text": "database failover mechanisms simpler",
    "start": "1653650",
    "end": "1655480"
  },
  {
    "text": "potentially but we're not doing it yet",
    "start": "1655480",
    "end": "1657930"
  },
  {
    "text": "yep so most of the monitoring is being",
    "start": "1657930",
    "end": "1670540"
  },
  {
    "text": "handled by app owners themself because",
    "start": "1670540",
    "end": "1672310"
  },
  {
    "text": "they are the ones for running it next to",
    "start": "1672310",
    "end": "1674410"
  },
  {
    "text": "their process and this is something that",
    "start": "1674410",
    "end": "1677560"
  },
  {
    "text": "we're working on it's kind of tricky",
    "start": "1677560",
    "end": "1678760"
  },
  {
    "text": "because people are not used to seeing if",
    "start": "1678760",
    "end": "1682780"
  },
  {
    "text": "CPA response code when they're timing",
    "start": "1682780",
    "end": "1684040"
  },
  {
    "text": "out for now we're just gonna teach in",
    "start": "1684040",
    "end": "1686350"
  },
  {
    "text": "people to look at the access logs which",
    "start": "1686350",
    "end": "1687700"
  },
  {
    "text": "will tell them whether it's a response",
    "start": "1687700",
    "end": "1690640"
  },
  {
    "text": "code generated by Android or whether it",
    "start": "1690640",
    "end": "1693100"
  },
  {
    "text": "came from the upstream but I think we're",
    "start": "1693100",
    "end": "1695680"
  },
  {
    "text": "something we're looking into exposing",
    "start": "1695680",
    "end": "1697390"
  },
  {
    "text": "this in like exception miss exception",
    "start": "1697390",
    "end": "1699700"
  },
  {
    "text": "messages in the client code are kind of",
    "start": "1699700",
    "end": "1701740"
  },
  {
    "text": "stuff but we're not there yet and I",
    "start": "1701740",
    "end": "1703990"
  },
  {
    "text": "think that's all we have time for thank",
    "start": "1703990",
    "end": "1705220"
  },
  {
    "text": "you so much for listening",
    "start": "1705220",
    "end": "1707820"
  }
]