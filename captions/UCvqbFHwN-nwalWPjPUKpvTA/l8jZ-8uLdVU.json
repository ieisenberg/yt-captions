[
  {
    "text": "i'm kp singh and i work for google",
    "start": "80",
    "end": "2399"
  },
  {
    "text": "security in zurich and today leonardo",
    "start": "2399",
    "end": "4799"
  },
  {
    "text": "and i are going to talk about how lsm",
    "start": "4799",
    "end": "7359"
  },
  {
    "text": "and bpf change everything",
    "start": "7359",
    "end": "10960"
  },
  {
    "text": "we're going to talk about why did we go",
    "start": "11040",
    "end": "12719"
  },
  {
    "text": "about writing a vp of lsm",
    "start": "12719",
    "end": "14639"
  },
  {
    "text": "what can we do using it",
    "start": "14639",
    "end": "16480"
  },
  {
    "text": "and then leonardo is going to show an",
    "start": "16480",
    "end": "17920"
  },
  {
    "text": "awesome demo showing the vp of lsm in",
    "start": "17920",
    "end": "20080"
  },
  {
    "text": "action",
    "start": "20080",
    "end": "22160"
  },
  {
    "text": "so why did we go about writing a vp of",
    "start": "22160",
    "end": "24000"
  },
  {
    "text": "lsm",
    "start": "24000",
    "end": "26080"
  },
  {
    "text": "i work for a group called detection and",
    "start": "26080",
    "end": "27680"
  },
  {
    "text": "response",
    "start": "27680",
    "end": "28880"
  },
  {
    "text": "we try to keep an eye on google's",
    "start": "28880",
    "end": "30400"
  },
  {
    "text": "internal systems and detect when unusual",
    "start": "30400",
    "end": "33040"
  },
  {
    "text": "things happen from a security",
    "start": "33040",
    "end": "34239"
  },
  {
    "text": "perspective",
    "start": "34239",
    "end": "35840"
  },
  {
    "text": "google has loads of linux systems all",
    "start": "35840",
    "end": "38239"
  },
  {
    "text": "the way from servers that run key",
    "start": "38239",
    "end": "39840"
  },
  {
    "text": "services",
    "start": "39840",
    "end": "40879"
  },
  {
    "text": "down to the very laptop that i'm using",
    "start": "40879",
    "end": "42559"
  },
  {
    "text": "right now these end points are",
    "start": "42559",
    "end": "44879"
  },
  {
    "text": "constantly piping security relevant",
    "start": "44879",
    "end": "46800"
  },
  {
    "text": "telemetry data to our software pipeline",
    "start": "46800",
    "end": "49280"
  },
  {
    "text": "which is doing some clever stuff on top",
    "start": "49280",
    "end": "50879"
  },
  {
    "text": "of this data",
    "start": "50879",
    "end": "52320"
  },
  {
    "text": "this information is then used by",
    "start": "52320",
    "end": "53760"
  },
  {
    "text": "security analysts who use this data",
    "start": "53760",
    "end": "57600"
  },
  {
    "text": "for responding to incidents",
    "start": "57600",
    "end": "59680"
  },
  {
    "text": "my team builds the agent that runs on",
    "start": "59680",
    "end": "61359"
  },
  {
    "text": "these internal google owned machines",
    "start": "61359",
    "end": "64400"
  },
  {
    "text": "at the very beginning of the pipeline",
    "start": "64400",
    "end": "67439"
  },
  {
    "text": "so what is the background",
    "start": "67439",
    "end": "69200"
  },
  {
    "text": "what was going wrong why did we make the",
    "start": "69200",
    "end": "71200"
  },
  {
    "text": "bp of lsm",
    "start": "71200",
    "end": "72640"
  },
  {
    "text": "so the traditional ways of doing this",
    "start": "72640",
    "end": "74560"
  },
  {
    "text": "would be using audit d",
    "start": "74560",
    "end": "76320"
  },
  {
    "text": "and audit d was not very flexible",
    "start": "76320",
    "end": "78479"
  },
  {
    "text": "i remember when we wanted to audit",
    "start": "78479",
    "end": "80479"
  },
  {
    "text": "environment variables",
    "start": "80479",
    "end": "82240"
  },
  {
    "text": "and the amount of work that needed to be",
    "start": "82240",
    "end": "84479"
  },
  {
    "text": "done on audit was quite high we needed",
    "start": "84479",
    "end": "86080"
  },
  {
    "text": "to patch the kernel and the audit user",
    "start": "86080",
    "end": "87840"
  },
  {
    "text": "space",
    "start": "87840",
    "end": "89520"
  },
  {
    "text": "we tried using kernel modules",
    "start": "89520",
    "end": "91600"
  },
  {
    "text": "and the kernel modules are a pain to",
    "start": "91600",
    "end": "93040"
  },
  {
    "text": "maintain",
    "start": "93040",
    "end": "94640"
  },
  {
    "text": "even with regular tracing and evpf",
    "start": "94640",
    "end": "97040"
  },
  {
    "text": "programs the number of places where one",
    "start": "97040",
    "end": "99040"
  },
  {
    "text": "can attach to is so high that one",
    "start": "99040",
    "end": "101680"
  },
  {
    "text": "doesn't really know what's the best",
    "start": "101680",
    "end": "103040"
  },
  {
    "text": "place to observe a particular behavior",
    "start": "103040",
    "end": "105280"
  },
  {
    "text": "and this will be very relevant once leo",
    "start": "105280",
    "end": "107520"
  },
  {
    "text": "shows his demo",
    "start": "107520",
    "end": "109439"
  },
  {
    "text": "and of course",
    "start": "109439",
    "end": "110799"
  },
  {
    "text": "policy enforcement was out of the",
    "start": "110799",
    "end": "112240"
  },
  {
    "text": "question using any of these systems",
    "start": "112240",
    "end": "115759"
  },
  {
    "text": "security can be broadly classified into",
    "start": "115759",
    "end": "118000"
  },
  {
    "text": "two approaches which work hand in hand",
    "start": "118000",
    "end": "121040"
  },
  {
    "text": "monitoring what is happening on a system",
    "start": "121040",
    "end": "123600"
  },
  {
    "text": "and enforcing which is taking action",
    "start": "123600",
    "end": "126320"
  },
  {
    "text": "based on the monetary monitored data",
    "start": "126320",
    "end": "129200"
  },
  {
    "text": "prior to bpf one could monitor using",
    "start": "129200",
    "end": "131760"
  },
  {
    "text": "linux audit or use perf or the",
    "start": "131760",
    "end": "134239"
  },
  {
    "text": "performance api",
    "start": "134239",
    "end": "135840"
  },
  {
    "text": "or trace points build custom kernel",
    "start": "135840",
    "end": "137840"
  },
  {
    "text": "modules or use trace probes",
    "start": "137840",
    "end": "139920"
  },
  {
    "text": "and the enforcement was completely",
    "start": "139920",
    "end": "141599"
  },
  {
    "text": "separate from all these systems",
    "start": "141599",
    "end": "143520"
  },
  {
    "text": "one could enforce or do mac policy",
    "start": "143520",
    "end": "145680"
  },
  {
    "text": "enforcement using security modules like",
    "start": "145680",
    "end": "147920"
  },
  {
    "text": "app armor se linux or one could do some",
    "start": "147920",
    "end": "150800"
  },
  {
    "text": "sandboxing using sitecomp which is based",
    "start": "150800",
    "end": "153120"
  },
  {
    "text": "on the syscall leg",
    "start": "153120",
    "end": "155440"
  },
  {
    "text": "the bpf lsm which we also call ksi",
    "start": "155440",
    "end": "158080"
  },
  {
    "text": "sometimes sits somewhere comfortably in",
    "start": "158080",
    "end": "160319"
  },
  {
    "text": "the middle and provides a unified and",
    "start": "160319",
    "end": "162640"
  },
  {
    "text": "flexible way to do both enforcement and",
    "start": "162640",
    "end": "164480"
  },
  {
    "text": "monitoring",
    "start": "164480",
    "end": "166480"
  },
  {
    "text": "now there are about 200 lsm hooks",
    "start": "166480",
    "end": "170319"
  },
  {
    "text": "these lsm hooks are a layer of",
    "start": "170319",
    "end": "171840"
  },
  {
    "text": "abstraction higher than the system",
    "start": "171840",
    "end": "173360"
  },
  {
    "text": "called api for example one can execute a",
    "start": "173360",
    "end": "176640"
  },
  {
    "text": "process using both the exec ve and exec",
    "start": "176640",
    "end": "179440"
  },
  {
    "text": "ve add system call but they both call",
    "start": "179440",
    "end": "182159"
  },
  {
    "text": "the same set of lsm hooks",
    "start": "182159",
    "end": "184560"
  },
  {
    "text": "the lsm hooks correspond to changes in",
    "start": "184560",
    "end": "186560"
  },
  {
    "text": "the kernel objects and are placed",
    "start": "186560",
    "end": "188560"
  },
  {
    "text": "strategically in the life cycle of the",
    "start": "188560",
    "end": "190560"
  },
  {
    "text": "object and the ongoing operation",
    "start": "190560",
    "end": "193920"
  },
  {
    "text": "this strategic placement ensures that an",
    "start": "193920",
    "end": "195920"
  },
  {
    "text": "attacker cannot use attacks like time of",
    "start": "195920",
    "end": "198480"
  },
  {
    "text": "check to time of use to trick the",
    "start": "198480",
    "end": "200480"
  },
  {
    "text": "security logic into believing something",
    "start": "200480",
    "end": "202640"
  },
  {
    "text": "that it's not actually doing",
    "start": "202640",
    "end": "204480"
  },
  {
    "text": "leonardo is going to show the importance",
    "start": "204480",
    "end": "206319"
  },
  {
    "text": "of this in his demo",
    "start": "206319",
    "end": "209200"
  },
  {
    "text": "the bp of lsm can happily coexist with",
    "start": "210959",
    "end": "213280"
  },
  {
    "text": "the other lsn's like se linux and app",
    "start": "213280",
    "end": "215120"
  },
  {
    "text": "armor and does not do anything by",
    "start": "215120",
    "end": "217200"
  },
  {
    "text": "default",
    "start": "217200",
    "end": "218720"
  },
  {
    "text": "one can load an ls and ebpf program to",
    "start": "218720",
    "end": "221599"
  },
  {
    "text": "implement their own custom logic for the",
    "start": "221599",
    "end": "223920"
  },
  {
    "text": "lsm hook",
    "start": "223920",
    "end": "225280"
  },
  {
    "text": "in this example the vp of lsm for the",
    "start": "225280",
    "end": "228239"
  },
  {
    "text": "process execution gets invoked after all",
    "start": "228239",
    "end": "231120"
  },
  {
    "text": "the other lsms",
    "start": "231120",
    "end": "232720"
  },
  {
    "text": "and of course this order can be changed",
    "start": "232720",
    "end": "234799"
  },
  {
    "text": "in the config lsm kconfig parameter or",
    "start": "234799",
    "end": "237439"
  },
  {
    "text": "the kernel command line",
    "start": "237439",
    "end": "241239"
  },
  {
    "text": "the lsn hook can then write audit data",
    "start": "241439",
    "end": "244080"
  },
  {
    "text": "back to the user space using ring",
    "start": "244080",
    "end": "245599"
  },
  {
    "text": "buffers and maps",
    "start": "245599",
    "end": "247120"
  },
  {
    "text": "and can also make policy decisions as we",
    "start": "247120",
    "end": "249120"
  },
  {
    "text": "talked about",
    "start": "249120",
    "end": "251599"
  },
  {
    "text": "lsm",
    "start": "252400",
    "end": "253360"
  },
  {
    "text": "programs are compiled once and run",
    "start": "253360",
    "end": "255439"
  },
  {
    "text": "everywhere they have verified pointer",
    "start": "255439",
    "end": "257680"
  },
  {
    "text": "accesses which is made possible by the",
    "start": "257680",
    "end": "259680"
  },
  {
    "text": "btf information present or compiled with",
    "start": "259680",
    "end": "262079"
  },
  {
    "text": "the kernel",
    "start": "262079",
    "end": "263600"
  },
  {
    "text": "we also added local storage or security",
    "start": "263600",
    "end": "266320"
  },
  {
    "text": "blobs for inodes task structs and",
    "start": "266320",
    "end": "268720"
  },
  {
    "text": "sockets",
    "start": "268720",
    "end": "269919"
  },
  {
    "text": "these blobs live and die with the kernel",
    "start": "269919",
    "end": "272000"
  },
  {
    "text": "object",
    "start": "272000",
    "end": "273360"
  },
  {
    "text": "making the memory management much easier",
    "start": "273360",
    "end": "275600"
  },
  {
    "text": "and can be used to tag security metadata",
    "start": "275600",
    "end": "278560"
  },
  {
    "text": "these blobs are especially useful in",
    "start": "278560",
    "end": "280240"
  },
  {
    "text": "conjunction with the with the atomics",
    "start": "280240",
    "end": "282639"
  },
  {
    "text": "api we added to bpf",
    "start": "282639",
    "end": "285120"
  },
  {
    "text": "and and especially for using or",
    "start": "285120",
    "end": "287120"
  },
  {
    "text": "generating custom unique identifiers for",
    "start": "287120",
    "end": "289120"
  },
  {
    "text": "example namespace ids or container ids",
    "start": "289120",
    "end": "292560"
  },
  {
    "text": "think of implementing a custom logic for",
    "start": "292560",
    "end": "294320"
  },
  {
    "text": "container ids and sending a patch to the",
    "start": "294320",
    "end": "296080"
  },
  {
    "text": "kernel people have tried that",
    "start": "296080",
    "end": "298320"
  },
  {
    "text": "tried to convince people for multiple",
    "start": "298320",
    "end": "300400"
  },
  {
    "text": "years on what a container is and has not",
    "start": "300400",
    "end": "302639"
  },
  {
    "text": "succeeded",
    "start": "302639",
    "end": "304560"
  },
  {
    "text": "lsm programs also can also sleep",
    "start": "304560",
    "end": "307360"
  },
  {
    "text": "this is especially useful if you want to",
    "start": "307360",
    "end": "309199"
  },
  {
    "text": "get them to read data from user space",
    "start": "309199",
    "end": "311039"
  },
  {
    "text": "for example command line arguments the",
    "start": "311039",
    "end": "313199"
  },
  {
    "text": "kernel leads to page in memory which",
    "start": "313199",
    "end": "315440"
  },
  {
    "text": "requires the program to be put to sleep",
    "start": "315440",
    "end": "318080"
  },
  {
    "text": "for the memory management unit to page",
    "start": "318080",
    "end": "319680"
  },
  {
    "text": "in memory",
    "start": "319680",
    "end": "321360"
  },
  {
    "text": "we also added helpers to get the ima",
    "start": "321360",
    "end": "323360"
  },
  {
    "text": "hashes of files which can be useful for",
    "start": "323360",
    "end": "325680"
  },
  {
    "text": "binary fingerprinting",
    "start": "325680",
    "end": "327680"
  },
  {
    "text": "and of course we have all the other dpf",
    "start": "327680",
    "end": "329360"
  },
  {
    "text": "goodness like the bpf ring buffer and",
    "start": "329360",
    "end": "331840"
  },
  {
    "text": "maps which help maintain state and send",
    "start": "331840",
    "end": "334800"
  },
  {
    "text": "data back to the user",
    "start": "334800",
    "end": "336840"
  },
  {
    "text": "space so what's happening next my",
    "start": "336840",
    "end": "339680"
  },
  {
    "text": "colleague flora is working on dns",
    "start": "339680",
    "end": "341520"
  },
  {
    "text": "auditing which has some interesting",
    "start": "341520",
    "end": "343440"
  },
  {
    "text": "challenges and we would like to do a",
    "start": "343440",
    "end": "345360"
  },
  {
    "text": "presentation about it at some point",
    "start": "345360",
    "end": "347840"
  },
  {
    "text": "we also want to add helpers for mac",
    "start": "347840",
    "end": "350080"
  },
  {
    "text": "policy enforcement and really make ppf",
    "start": "350080",
    "end": "352720"
  },
  {
    "text": "lsm",
    "start": "352720",
    "end": "353759"
  },
  {
    "text": "powerful enough to be a major lsm or be",
    "start": "353759",
    "end": "356880"
  },
  {
    "text": "able to implement a major lsm in the",
    "start": "356880",
    "end": "358400"
  },
  {
    "text": "kernel",
    "start": "358400",
    "end": "359840"
  },
  {
    "text": "we also want to provide more places that",
    "start": "359840",
    "end": "362080"
  },
  {
    "text": "ppf lsm programs can attach to",
    "start": "362080",
    "end": "364639"
  },
  {
    "text": "especially useful for auditing events",
    "start": "364639",
    "end": "366800"
  },
  {
    "text": "like nmap or kernel module loads",
    "start": "366800",
    "end": "369680"
  },
  {
    "text": "and we also want to make",
    "start": "369680",
    "end": "371520"
  },
  {
    "text": "the ppf lsm users to use it more easily",
    "start": "371520",
    "end": "373680"
  },
  {
    "text": "by providing an api like ppf phrase or",
    "start": "373680",
    "end": "376479"
  },
  {
    "text": "something that is more abstract from the",
    "start": "376479",
    "end": "377919"
  },
  {
    "text": "kernel internals right now you still",
    "start": "377919",
    "end": "380240"
  },
  {
    "text": "need to understand that dprm check",
    "start": "380240",
    "end": "382560"
  },
  {
    "text": "security means a process is being",
    "start": "382560",
    "end": "384479"
  },
  {
    "text": "executed which is not ideal",
    "start": "384479",
    "end": "386880"
  },
  {
    "text": "i'm now going to hand over to leonardo",
    "start": "386880",
    "end": "388960"
  },
  {
    "text": "who's going to show an awesome demo of",
    "start": "388960",
    "end": "390880"
  },
  {
    "text": "the bpf lsm in action",
    "start": "390880",
    "end": "395400"
  },
  {
    "text": "hello everybody",
    "start": "395600",
    "end": "397039"
  },
  {
    "text": "i'm leo i guess it's my tour now",
    "start": "397039",
    "end": "399840"
  },
  {
    "text": "first of all i want to thank kp for all",
    "start": "399840",
    "end": "402800"
  },
  {
    "text": "the wonderful explanations and for",
    "start": "402800",
    "end": "405280"
  },
  {
    "text": "introducing me and now to explain you",
    "start": "405280",
    "end": "407919"
  },
  {
    "text": "why i believe",
    "start": "407919",
    "end": "409440"
  },
  {
    "text": "lsm bpf will change everything and for",
    "start": "409440",
    "end": "412080"
  },
  {
    "text": "the better let me first tell you a story",
    "start": "412080",
    "end": "414880"
  },
  {
    "text": "some months ago while i was still",
    "start": "414880",
    "end": "416880"
  },
  {
    "text": "working on a daily basis on falco a",
    "start": "416880",
    "end": "419440"
  },
  {
    "text": "security researcher contacted me",
    "start": "419440",
    "end": "421840"
  },
  {
    "text": "presenting a very cool bypassing",
    "start": "421840",
    "end": "423520"
  },
  {
    "text": "technique as some of you may already",
    "start": "423520",
    "end": "425759"
  },
  {
    "text": "know falcor just like many other runtime",
    "start": "425759",
    "end": "428880"
  },
  {
    "text": "security tools out there",
    "start": "428880",
    "end": "431039"
  },
  {
    "text": "does its job thanks to",
    "start": "431039",
    "end": "432960"
  },
  {
    "text": "ebpf specifically in its case thanks to",
    "start": "432960",
    "end": "436080"
  },
  {
    "text": "the cisco trace points",
    "start": "436080",
    "end": "438160"
  },
  {
    "text": "the falco bpf probe basically attaches",
    "start": "438160",
    "end": "440720"
  },
  {
    "text": "to the kernel cisco trace points with",
    "start": "440720",
    "end": "443280"
  },
  {
    "text": "little abpf programs that are",
    "start": "443280",
    "end": "445199"
  },
  {
    "text": "responsible for any cisco being called",
    "start": "445199",
    "end": "448319"
  },
  {
    "text": "on your machine to extract its argument",
    "start": "448319",
    "end": "450479"
  },
  {
    "text": "plus other data and put all of them in a",
    "start": "450479",
    "end": "453039"
  },
  {
    "text": "ring buffer",
    "start": "453039",
    "end": "454400"
  },
  {
    "text": "then",
    "start": "454400",
    "end": "455280"
  },
  {
    "text": "all rules assert conditions against",
    "start": "455280",
    "end": "457199"
  },
  {
    "text": "those data",
    "start": "457199",
    "end": "459199"
  },
  {
    "text": "for example the default rule set",
    "start": "459199",
    "end": "461360"
  },
  {
    "text": "contains rules to detect crypto mining",
    "start": "461360",
    "end": "463440"
  },
  {
    "text": "activities",
    "start": "463440",
    "end": "464560"
  },
  {
    "text": "on euros by looking at the outgoing",
    "start": "464560",
    "end": "467120"
  },
  {
    "text": "connections happening on your machine",
    "start": "467120",
    "end": "469680"
  },
  {
    "text": "such rules simply trace saint to send",
    "start": "469680",
    "end": "472400"
  },
  {
    "text": "message or the connect syscalls and",
    "start": "472400",
    "end": "474960"
  },
  {
    "text": "assert conditions on their arguments",
    "start": "474960",
    "end": "477759"
  },
  {
    "text": "electing if the destination ip for",
    "start": "477759",
    "end": "479759"
  },
  {
    "text": "example or the destination domain",
    "start": "479759",
    "end": "483440"
  },
  {
    "text": "match those of known mining pools out",
    "start": "483440",
    "end": "486800"
  },
  {
    "text": "there",
    "start": "486800",
    "end": "487599"
  },
  {
    "text": "just to give you a sense of what i'm",
    "start": "487599",
    "end": "489440"
  },
  {
    "text": "talking about let's take a look at those",
    "start": "489440",
    "end": "491360"
  },
  {
    "text": "rules",
    "start": "491360",
    "end": "493840"
  },
  {
    "text": "let's take a look at this netminer pull",
    "start": "494319",
    "end": "496080"
  },
  {
    "text": "macro used by the rule detect.band",
    "start": "496080",
    "end": "498560"
  },
  {
    "text": "connections to common minor pull parts",
    "start": "498560",
    "end": "501440"
  },
  {
    "text": "as you can see here",
    "start": "501440",
    "end": "503680"
  },
  {
    "text": "this macro basically asserts the",
    "start": "503680",
    "end": "505919"
  },
  {
    "text": "conditions",
    "start": "505919",
    "end": "507680"
  },
  {
    "text": "on the send to and send message schools",
    "start": "507680",
    "end": "511520"
  },
  {
    "text": "and",
    "start": "511520",
    "end": "512479"
  },
  {
    "text": "on",
    "start": "512479",
    "end": "513518"
  },
  {
    "text": "these other",
    "start": "513519",
    "end": "515839"
  },
  {
    "text": "macros",
    "start": "515839",
    "end": "517120"
  },
  {
    "text": "which are defined above",
    "start": "517120",
    "end": "519680"
  },
  {
    "text": "here if we inspect them we can see that",
    "start": "519680",
    "end": "523039"
  },
  {
    "text": "the miner pool ladder macro checks for",
    "start": "523039",
    "end": "526080"
  },
  {
    "text": "destination part and domain name",
    "start": "526080",
    "end": "529279"
  },
  {
    "text": "to be in lists of",
    "start": "529279",
    "end": "531839"
  },
  {
    "text": "well-known",
    "start": "531839",
    "end": "533279"
  },
  {
    "text": "mining pools out there for example these",
    "start": "533279",
    "end": "535279"
  },
  {
    "text": "minor domains list contains things like",
    "start": "535279",
    "end": "538560"
  },
  {
    "text": "this okay so in this case falco when",
    "start": "538560",
    "end": "541839"
  },
  {
    "text": "detects specific ciscos with specific",
    "start": "541839",
    "end": "544800"
  },
  {
    "text": "arguments containing these values alerts",
    "start": "544800",
    "end": "547680"
  },
  {
    "text": "the user for outbound connection to",
    "start": "547680",
    "end": "550560"
  },
  {
    "text": "manage boots also it's worth taking",
    "start": "550560",
    "end": "553600"
  },
  {
    "text": "quickly a look at this pretty generic",
    "start": "553600",
    "end": "555839"
  },
  {
    "text": "and pretty useful outbound macro that a",
    "start": "555839",
    "end": "558000"
  },
  {
    "text": "lot of falco rules use as you can see",
    "start": "558000",
    "end": "561120"
  },
  {
    "text": "basically it checks for the event so the",
    "start": "561120",
    "end": "564160"
  },
  {
    "text": "cisco being executed on your machine to",
    "start": "564160",
    "end": "566880"
  },
  {
    "text": "be either a connect or a send or send",
    "start": "566880",
    "end": "569680"
  },
  {
    "text": "message and for",
    "start": "569680",
    "end": "572080"
  },
  {
    "text": "the the connection being in progress and",
    "start": "572080",
    "end": "575519"
  },
  {
    "text": "not towards",
    "start": "575519",
    "end": "577519"
  },
  {
    "text": "private networks okay or towards local",
    "start": "577519",
    "end": "581360"
  },
  {
    "text": "addresses",
    "start": "581360",
    "end": "582560"
  },
  {
    "text": "and to be",
    "start": "582560",
    "end": "584080"
  },
  {
    "text": "epv4 or epv6 all right so far so good",
    "start": "584080",
    "end": "589040"
  },
  {
    "text": "the problem is that the code sofia x",
    "start": "589040",
    "end": "592560"
  },
  {
    "text": "thank you my friend presented me was",
    "start": "592560",
    "end": "595040"
  },
  {
    "text": "able to reliable bypass those falco",
    "start": "595040",
    "end": "598000"
  },
  {
    "text": "rules by exploiting a tacto in the",
    "start": "598000",
    "end": "600720"
  },
  {
    "text": "corner 100 of the time i was like",
    "start": "600720",
    "end": "605200"
  },
  {
    "text": "oh my",
    "start": "605200",
    "end": "606720"
  },
  {
    "text": "how is that even possible well such code",
    "start": "606720",
    "end": "611519"
  },
  {
    "text": "was exploiting every window between the",
    "start": "611519",
    "end": "614320"
  },
  {
    "text": "moment the bpf three spawned read the",
    "start": "614320",
    "end": "617120"
  },
  {
    "text": "argument for example the destination ap",
    "start": "617120",
    "end": "619760"
  },
  {
    "text": "at the moment the current actually",
    "start": "619760",
    "end": "621600"
  },
  {
    "text": "executes the cisco with its arguments",
    "start": "621600",
    "end": "625279"
  },
  {
    "text": "the core issue is that cisco arguments",
    "start": "625279",
    "end": "628560"
  },
  {
    "text": "are at a two different point in time the",
    "start": "628560",
    "end": "631519"
  },
  {
    "text": "delta between those two moments",
    "start": "631519",
    "end": "633760"
  },
  {
    "text": "represents the time window into which",
    "start": "633760",
    "end": "636240"
  },
  {
    "text": "the attack replaces the malicious",
    "start": "636240",
    "end": "638000"
  },
  {
    "text": "argument with a good looking one that",
    "start": "638000",
    "end": "640079"
  },
  {
    "text": "the bpf trace point will eventually read",
    "start": "640079",
    "end": "642480"
  },
  {
    "text": "it's important to note anyways that the",
    "start": "642480",
    "end": "644240"
  },
  {
    "text": "beauty of this bypass was that it worked",
    "start": "644240",
    "end": "647440"
  },
  {
    "text": "again any tool using bpfc is called",
    "start": "647440",
    "end": "649760"
  },
  {
    "text": "trees point as a mean of detecting",
    "start": "649760",
    "end": "652480"
  },
  {
    "text": "malicious activities and threats not",
    "start": "652480",
    "end": "654959"
  },
  {
    "text": "tolerance falco which i'm using because",
    "start": "654959",
    "end": "657760"
  },
  {
    "text": "having worked a lot on it i'm very",
    "start": "657760",
    "end": "659680"
  },
  {
    "text": "familiar with it let me say this aloud",
    "start": "659680",
    "end": "662560"
  },
  {
    "text": "before people excuse me",
    "start": "662560",
    "end": "664560"
  },
  {
    "text": "i will not explain the bypassing",
    "start": "664560",
    "end": "666399"
  },
  {
    "text": "technique here in detail because it's",
    "start": "666399",
    "end": "668800"
  },
  {
    "text": "not the goal of this tool but i strongly",
    "start": "668800",
    "end": "671920"
  },
  {
    "text": "recommend you to go watch selfie rex",
    "start": "671920",
    "end": "673920"
  },
  {
    "text": "talk at deathcon for more details on it",
    "start": "673920",
    "end": "676800"
  },
  {
    "text": "it's worth it trust me",
    "start": "676800",
    "end": "678800"
  },
  {
    "text": "so long story short this attack connects",
    "start": "678800",
    "end": "681839"
  },
  {
    "text": "to",
    "start": "681839",
    "end": "683640"
  },
  {
    "text": "ip1.1.1.1 which we are considering",
    "start": "683640",
    "end": "685920"
  },
  {
    "text": "malicious just for the sake of",
    "start": "685920",
    "end": "688480"
  },
  {
    "text": "the this demo while the falco bpf probe",
    "start": "688480",
    "end": "691440"
  },
  {
    "text": "detects another ip and for this reason",
    "start": "691440",
    "end": "694399"
  },
  {
    "text": "it doesn't trigger any others at all but",
    "start": "694399",
    "end": "697200"
  },
  {
    "text": "let's see it in action i feel pragmatic",
    "start": "697200",
    "end": "699200"
  },
  {
    "text": "right now",
    "start": "699200",
    "end": "700320"
  },
  {
    "text": "first thing we need a falco rule that",
    "start": "700320",
    "end": "702240"
  },
  {
    "text": "detects connections to",
    "start": "702240",
    "end": "704360"
  },
  {
    "text": "1.1.1.1 i've already prepped one",
    "start": "704360",
    "end": "707279"
  },
  {
    "text": "let's take a look at it okay as you can",
    "start": "707279",
    "end": "709519"
  },
  {
    "text": "see in this little jumble 5 i basically",
    "start": "709519",
    "end": "712639"
  },
  {
    "text": "coped the outbound micro i shown before",
    "start": "712639",
    "end": "715920"
  },
  {
    "text": "and i wrote a folk rule called",
    "start": "715920",
    "end": "718639"
  },
  {
    "text": "unexpected outbound connection",
    "start": "718639",
    "end": "720240"
  },
  {
    "text": "destination",
    "start": "720240",
    "end": "721680"
  },
  {
    "text": "that basically used this macro together",
    "start": "721680",
    "end": "724399"
  },
  {
    "text": "with the check on the destination e3 to",
    "start": "724399",
    "end": "728160"
  },
  {
    "text": "not be",
    "start": "728160",
    "end": "729639"
  },
  {
    "text": "1.1.1.1 so if this is an oddband",
    "start": "729639",
    "end": "733120"
  },
  {
    "text": "connection and the destination ap is",
    "start": "733120",
    "end": "735360"
  },
  {
    "text": "1.1.1.1",
    "start": "735360",
    "end": "737120"
  },
  {
    "text": "falco should alert okay let's check it",
    "start": "737120",
    "end": "740880"
  },
  {
    "text": "falco starts",
    "start": "740880",
    "end": "742399"
  },
  {
    "text": "now simply let's call",
    "start": "742399",
    "end": "744360"
  },
  {
    "text": "1.1.1",
    "start": "744360",
    "end": "746000"
  },
  {
    "text": "and it works look as you can see photo",
    "start": "746000",
    "end": "748560"
  },
  {
    "text": "detects outgoing connection to the",
    "start": "748560",
    "end": "750240"
  },
  {
    "text": "targeted p in normal situations but what",
    "start": "750240",
    "end": "753200"
  },
  {
    "text": "if i run the bypass i was mentioning",
    "start": "753200",
    "end": "755760"
  },
  {
    "text": "before",
    "start": "755760",
    "end": "756720"
  },
  {
    "text": "notice that for this bypassed working",
    "start": "756720",
    "end": "758800"
  },
  {
    "text": "glass to be vulnerable but it needs to",
    "start": "758800",
    "end": "761680"
  },
  {
    "text": "have a privilege user fault of the",
    "start": "761680",
    "end": "763839"
  },
  {
    "text": "activated let's check its cctv knob",
    "start": "763839",
    "end": "767200"
  },
  {
    "text": "it's one okay in this case we are",
    "start": "767200",
    "end": "769200"
  },
  {
    "text": "vulnerable but first let me run tcp down",
    "start": "769200",
    "end": "772160"
  },
  {
    "text": "because why not and now let me run the",
    "start": "772160",
    "end": "775200"
  },
  {
    "text": "attack",
    "start": "775200",
    "end": "777279"
  },
  {
    "text": "as you can see the attack succeeded",
    "start": "777279",
    "end": "779839"
  },
  {
    "text": "connecting to the",
    "start": "779839",
    "end": "781720"
  },
  {
    "text": "1.1.1.1 ip this is its intelligent",
    "start": "781720",
    "end": "785519"
  },
  {
    "text": "representation and tcp dump catches it",
    "start": "785519",
    "end": "788880"
  },
  {
    "text": "while farco doesn't iaibpf cisco",
    "start": "788880",
    "end": "792480"
  },
  {
    "text": "tracebind",
    "start": "792480",
    "end": "794000"
  },
  {
    "text": "okay in falcon091",
    "start": "794000",
    "end": "796959"
  },
  {
    "text": "i implemented an initial workaround",
    "start": "796959",
    "end": "798560"
  },
  {
    "text": "binding support for tracing the user",
    "start": "798560",
    "end": "800560"
  },
  {
    "text": "full cisco which is the attack driver",
    "start": "800560",
    "end": "803279"
  },
  {
    "text": "that surface code is using to swap the",
    "start": "803279",
    "end": "806720"
  },
  {
    "text": "cisco arguments under the hood in fact",
    "start": "806720",
    "end": "809040"
  },
  {
    "text": "if we run falco",
    "start": "809040",
    "end": "811560"
  },
  {
    "text": "029.1 with the full true side that",
    "start": "811560",
    "end": "813920"
  },
  {
    "text": "contains a rule for it and the attack we",
    "start": "813920",
    "end": "816959"
  },
  {
    "text": "can see that falcon is a critical art",
    "start": "816959",
    "end": "819360"
  },
  {
    "text": "about user fault to fd getting cold but",
    "start": "819360",
    "end": "822720"
  },
  {
    "text": "aside from the fact that there are also",
    "start": "822720",
    "end": "824800"
  },
  {
    "text": "other means that i will not present here",
    "start": "824800",
    "end": "827600"
  },
  {
    "text": "you know to me the same precondition",
    "start": "827600",
    "end": "829839"
  },
  {
    "text": "that this bypass requires as it is at",
    "start": "829839",
    "end": "832240"
  },
  {
    "text": "the moment my patch just makes falco",
    "start": "832240",
    "end": "835279"
  },
  {
    "text": "scream about user fault if this is",
    "start": "835279",
    "end": "837120"
  },
  {
    "text": "called getting cold but does not provide",
    "start": "837120",
    "end": "839360"
  },
  {
    "text": "any detail or deep visibility on what it",
    "start": "839360",
    "end": "842560"
  },
  {
    "text": "really happening",
    "start": "842560",
    "end": "844079"
  },
  {
    "text": "after it furthermore we laid a",
    "start": "844079",
    "end": "846000"
  },
  {
    "text": "modification this attack called work",
    "start": "846000",
    "end": "848959"
  },
  {
    "text": "also for other uh cisco's like renamed",
    "start": "848959",
    "end": "851839"
  },
  {
    "text": "unlinked creators and two you name it so",
    "start": "851839",
    "end": "856320"
  },
  {
    "text": "what will be an actual and truly",
    "start": "856320",
    "end": "858480"
  },
  {
    "text": "meaningful fix or more there's even a",
    "start": "858480",
    "end": "861440"
  },
  {
    "text": "way to avoid this to happen at all this",
    "start": "861440",
    "end": "863519"
  },
  {
    "text": "is the question in my opinion a certain",
    "start": "863519",
    "end": "865600"
  },
  {
    "text": "condition against the actual arguments",
    "start": "865600",
    "end": "867360"
  },
  {
    "text": "getting used by the kennel would be the",
    "start": "867360",
    "end": "869519"
  },
  {
    "text": "best way to go for detection tools but",
    "start": "869519",
    "end": "872240"
  },
  {
    "text": "first of all how to grab them and to do",
    "start": "872240",
    "end": "874560"
  },
  {
    "text": "so we need to first understand a little",
    "start": "874560",
    "end": "876720"
  },
  {
    "text": "bit better the cisco's flow in the linux",
    "start": "876720",
    "end": "879279"
  },
  {
    "text": "kernel let's take a look at this whole",
    "start": "879279",
    "end": "881120"
  },
  {
    "text": "image of the flow of the open cisco that",
    "start": "881120",
    "end": "883440"
  },
  {
    "text": "i have on my laptop the flow for other",
    "start": "883440",
    "end": "886480"
  },
  {
    "text": "cisco's in here and is very similar and",
    "start": "886480",
    "end": "888800"
  },
  {
    "text": "and sophie also provided a bypass for",
    "start": "888800",
    "end": "891279"
  },
  {
    "text": "the open so when a processing user space",
    "start": "891279",
    "end": "894000"
  },
  {
    "text": "calls the open cisco on a file path the",
    "start": "894000",
    "end": "897120"
  },
  {
    "text": "cisco is dispatched and the path string",
    "start": "897120",
    "end": "899199"
  },
  {
    "text": "is used to contain a kernel file object",
    "start": "899199",
    "end": "901519"
  },
  {
    "text": "and an unknown object if the parameters",
    "start": "901519",
    "end": "904160"
  },
  {
    "text": "are incorrect error is returned as usual",
    "start": "904160",
    "end": "908000"
  },
  {
    "text": "but then the normal dsc descript access",
    "start": "908000",
    "end": "911600"
  },
  {
    "text": "control file permission checks",
    "start": "911600",
    "end": "913839"
  },
  {
    "text": "are checked and if they are satisfied",
    "start": "913839",
    "end": "917040"
  },
  {
    "text": "the lesson framework enters the game it",
    "start": "917040",
    "end": "920320"
  },
  {
    "text": "tags for reach of the file",
    "start": "920320",
    "end": "922399"
  },
  {
    "text": "lsm aux for hold enabled hell sams also",
    "start": "922399",
    "end": "926560"
  },
  {
    "text": "the vpf ones if there are and finally or",
    "start": "926560",
    "end": "930240"
  },
  {
    "text": "if all those security checks pass the",
    "start": "930240",
    "end": "933120"
  },
  {
    "text": "file is opened for the user space",
    "start": "933120",
    "end": "934639"
  },
  {
    "text": "process and the new file descriptor is",
    "start": "934639",
    "end": "936880"
  },
  {
    "text": "returned to it it's important to note",
    "start": "936880",
    "end": "939519"
  },
  {
    "text": "how",
    "start": "939519",
    "end": "940399"
  },
  {
    "text": "deep in the cisco flow the lsm hooks are",
    "start": "940399",
    "end": "944320"
  },
  {
    "text": "which is not the case for bpfc school",
    "start": "944320",
    "end": "946480"
  },
  {
    "text": "trees points not convinced yet when i",
    "start": "946480",
    "end": "949199"
  },
  {
    "text": "take a look at the kernel code for the",
    "start": "949199",
    "end": "950880"
  },
  {
    "text": "connect c school and just one of the",
    "start": "950880",
    "end": "953920"
  },
  {
    "text": "various lsm network cooks okay you want",
    "start": "953920",
    "end": "957920"
  },
  {
    "text": "don't blame me",
    "start": "957920",
    "end": "959680"
  },
  {
    "text": "well taking a look at the current it's",
    "start": "959680",
    "end": "961759"
  },
  {
    "text": "always the right thing to do so",
    "start": "961759",
    "end": "964399"
  },
  {
    "text": "here in the lsn ox depths either you can",
    "start": "964399",
    "end": "968240"
  },
  {
    "text": "find all the hooks the lsm framework",
    "start": "968240",
    "end": "971440"
  },
  {
    "text": "provides for example this one at line",
    "start": "971440",
    "end": "975320"
  },
  {
    "text": "208",
    "start": "975320",
    "end": "976880"
  },
  {
    "text": "is the one we are interested in or",
    "start": "976880",
    "end": "979120"
  },
  {
    "text": "blocking sophie to connect it to",
    "start": "979120",
    "end": "981560"
  },
  {
    "text": "1.1.1.1 isn't it",
    "start": "981560",
    "end": "983600"
  },
  {
    "text": "in fact if we go take a look at the",
    "start": "983600",
    "end": "985519"
  },
  {
    "text": "definition of the connect c school in",
    "start": "985519",
    "end": "987920"
  },
  {
    "text": "the socket.c file here cisco defines",
    "start": "987920",
    "end": "992160"
  },
  {
    "text": "disconnect disconnect move address to",
    "start": "992160",
    "end": "995120"
  },
  {
    "text": "kernel sees connect file if the",
    "start": "995120",
    "end": "998240"
  },
  {
    "text": "arguments move successfully to the",
    "start": "998240",
    "end": "1000560"
  },
  {
    "text": "kernel and sysconnect file calls this",
    "start": "1000560",
    "end": "1003680"
  },
  {
    "text": "function security socket connect if we",
    "start": "1003680",
    "end": "1006639"
  },
  {
    "text": "don't inspect what this function is and",
    "start": "1006639",
    "end": "1008959"
  },
  {
    "text": "does we suddenly realize it is the",
    "start": "1008959",
    "end": "1011440"
  },
  {
    "text": "function that calls the socket connect",
    "start": "1011440",
    "end": "1014000"
  },
  {
    "text": "lsm hawk so is this a ringing bell for",
    "start": "1014000",
    "end": "1016560"
  },
  {
    "text": "you",
    "start": "1016560",
    "end": "1017519"
  },
  {
    "text": "as we have seen alexa moocs are very low",
    "start": "1017519",
    "end": "1020800"
  },
  {
    "text": "in the cisco's flow and happens after",
    "start": "1020800",
    "end": "1023759"
  },
  {
    "text": "arguments have been moved to the kernel",
    "start": "1023759",
    "end": "1026400"
  },
  {
    "text": "so to prevent our friend sophie or any",
    "start": "1026400",
    "end": "1029280"
  },
  {
    "text": "problem using this fantastic technique",
    "start": "1029280",
    "end": "1031438"
  },
  {
    "text": "to connect to",
    "start": "1031439",
    "end": "1032760"
  },
  {
    "text": "1.1.1.1 to provide a real security layer",
    "start": "1032760",
    "end": "1036240"
  },
  {
    "text": "we may want to use this lesson hook and",
    "start": "1036240",
    "end": "1039199"
  },
  {
    "text": "attach a bpf program to it and this",
    "start": "1039199",
    "end": "1041760"
  },
  {
    "text": "isn't anything but just be aware that",
    "start": "1041760",
    "end": "1043918"
  },
  {
    "text": "this feature is new and it requires a",
    "start": "1043919",
    "end": "1046160"
  },
  {
    "text": "kernel greater than 5.7 furthermore",
    "start": "1046160",
    "end": "1049280"
  },
  {
    "text": "ensure your camera is configured with",
    "start": "1049280",
    "end": "1051679"
  },
  {
    "text": "the options config bpf lsn and config",
    "start": "1051679",
    "end": "1054960"
  },
  {
    "text": "debug info btf also you need to have lsm",
    "start": "1054960",
    "end": "1058640"
  },
  {
    "text": "bpf activated to check it take a look at",
    "start": "1058640",
    "end": "1061679"
  },
  {
    "text": "the lesson kernel boot parameters under",
    "start": "1061679",
    "end": "1064480"
  },
  {
    "text": "the config and the square lsm",
    "start": "1064480",
    "end": "1066000"
  },
  {
    "text": "configuration so basically",
    "start": "1066000",
    "end": "1068000"
  },
  {
    "text": "like this",
    "start": "1068000",
    "end": "1069120"
  },
  {
    "text": "okay we can write some",
    "start": "1069120",
    "end": "1070960"
  },
  {
    "text": "lsn bpf time to get our hands dirty with",
    "start": "1070960",
    "end": "1074480"
  },
  {
    "text": "some lsn bpf finally please meet",
    "start": "1074480",
    "end": "1077760"
  },
  {
    "text": "restrict connect please little bpf",
    "start": "1077760",
    "end": "1080799"
  },
  {
    "text": "program that i've written to attach to",
    "start": "1080799",
    "end": "1082720"
  },
  {
    "text": "the socket connector lessen mock as you",
    "start": "1082720",
    "end": "1085120"
  },
  {
    "text": "can see it's simpler than anything with",
    "start": "1085120",
    "end": "1086720"
  },
  {
    "text": "the sec helper macro i'm marking the",
    "start": "1086720",
    "end": "1088880"
  },
  {
    "text": "following function to handle the lsm",
    "start": "1088880",
    "end": "1091039"
  },
  {
    "text": "socket connect lsm hook then by using",
    "start": "1091039",
    "end": "1093760"
  },
  {
    "text": "bpf prog macro i am gaining the benefit",
    "start": "1093760",
    "end": "1096480"
  },
  {
    "text": "of not having to mess around with the",
    "start": "1096480",
    "end": "1098320"
  },
  {
    "text": "registers and i can simply declare the",
    "start": "1098320",
    "end": "1101200"
  },
  {
    "text": "signature of the function to contain the",
    "start": "1101200",
    "end": "1103679"
  },
  {
    "text": "same parameter as the socket connect to",
    "start": "1103679",
    "end": "1105919"
  },
  {
    "text": "that we've inspected before in the",
    "start": "1105919",
    "end": "1107600"
  },
  {
    "text": "kernel notice also that i'm appending a",
    "start": "1107600",
    "end": "1110000"
  },
  {
    "text": "red parameter that i check in the",
    "start": "1110000",
    "end": "1112400"
  },
  {
    "text": "function in fact since various programs",
    "start": "1112400",
    "end": "1115919"
  },
  {
    "text": "can be attached to this lsm hook i have",
    "start": "1115919",
    "end": "1118960"
  },
  {
    "text": "to respect the cannot override the",
    "start": "1118960",
    "end": "1120960"
  },
  {
    "text": "denial rule meaning that if this",
    "start": "1120960",
    "end": "1124080"
  },
  {
    "text": "function is not the first one attached",
    "start": "1124080",
    "end": "1126080"
  },
  {
    "text": "to the lsm socket connect 2 and the",
    "start": "1126080",
    "end": "1129039"
  },
  {
    "text": "previous one returned a value different",
    "start": "1129039",
    "end": "1131679"
  },
  {
    "text": "than 0 then i have to exit from it and",
    "start": "1131679",
    "end": "1134640"
  },
  {
    "text": "respect the decision of the previous",
    "start": "1134640",
    "end": "1136880"
  },
  {
    "text": "program attached studio the rest is",
    "start": "1136880",
    "end": "1139120"
  },
  {
    "text": "pretty straight forward i know non-epv4",
    "start": "1139120",
    "end": "1143280"
  },
  {
    "text": "protocols because this is just the",
    "start": "1143280",
    "end": "1145360"
  },
  {
    "text": "example",
    "start": "1145360",
    "end": "1146480"
  },
  {
    "text": "i obtained the destination ip and i",
    "start": "1146480",
    "end": "1148880"
  },
  {
    "text": "check it against a value the value that",
    "start": "1148880",
    "end": "1151520"
  },
  {
    "text": "i want to block a value that i've",
    "start": "1151520",
    "end": "1153679"
  },
  {
    "text": "articulated here for the sake of",
    "start": "1153679",
    "end": "1156080"
  },
  {
    "text": "simplicity but here we could also look",
    "start": "1156080",
    "end": "1159200"
  },
  {
    "text": "up into the bpf map please notice this",
    "start": "1159200",
    "end": "1161760"
  },
  {
    "text": "is the same number that the attack",
    "start": "1161760",
    "end": "1164400"
  },
  {
    "text": "connect outputs when it succeeds so it's",
    "start": "1164400",
    "end": "1167679"
  },
  {
    "text": "the ip representation of 1.1.1.1",
    "start": "1167679",
    "end": "1171280"
  },
  {
    "text": "let's run it now",
    "start": "1171280",
    "end": "1174240"
  },
  {
    "text": "a lot of relocations let's attach to the",
    "start": "1175039",
    "end": "1177600"
  },
  {
    "text": "trace pipe let's first simply test it by",
    "start": "1177600",
    "end": "1181039"
  },
  {
    "text": "fishing this command called connect whoa",
    "start": "1181039",
    "end": "1185280"
  },
  {
    "text": "look okay",
    "start": "1185280",
    "end": "1187600"
  },
  {
    "text": "but let's be serious and try it against",
    "start": "1187600",
    "end": "1190880"
  },
  {
    "text": "the bypass",
    "start": "1190880",
    "end": "1194080"
  },
  {
    "text": "error connecting operational permitted",
    "start": "1194080",
    "end": "1196799"
  },
  {
    "text": "lessened blocking",
    "start": "1196799",
    "end": "1199840"
  },
  {
    "text": "lsm blocking",
    "start": "1201520",
    "end": "1203440"
  },
  {
    "text": "oops",
    "start": "1203440",
    "end": "1206440"
  },
  {
    "text": "operation not permitted connection to",
    "start": "1208400",
    "end": "1210360"
  },
  {
    "text": "1.201 block",
    "start": "1210360",
    "end": "1212720"
  },
  {
    "text": "sorry my friend",
    "start": "1212720",
    "end": "1214480"
  },
  {
    "text": "this is good isn't it",
    "start": "1214480",
    "end": "1216960"
  },
  {
    "text": "in the procedure i'm going to share the",
    "start": "1216960",
    "end": "1218880"
  },
  {
    "text": "end of turk you'll also find the c code",
    "start": "1218880",
    "end": "1221120"
  },
  {
    "text": "to attach restrict connect thanks to the",
    "start": "1221120",
    "end": "1223840"
  },
  {
    "text": "bpf to the lessonbook actually",
    "start": "1223840",
    "end": "1226880"
  },
  {
    "text": "make files to compile everything and",
    "start": "1226880",
    "end": "1228960"
  },
  {
    "text": "stuff but now that we are deep into this",
    "start": "1228960",
    "end": "1231760"
  },
  {
    "text": "amazon rabbit tool let's keep the focus",
    "start": "1231760",
    "end": "1234720"
  },
  {
    "text": "what if we cannot want to block",
    "start": "1234720",
    "end": "1237200"
  },
  {
    "text": "connection to 1.212.1",
    "start": "1237200",
    "end": "1239760"
  },
  {
    "text": "but we want to receive the correct cisco",
    "start": "1239760",
    "end": "1243919"
  },
  {
    "text": "arguments so we want to have deep",
    "start": "1243919",
    "end": "1246320"
  },
  {
    "text": "visibility about this nation ip address",
    "start": "1246320",
    "end": "1248799"
  },
  {
    "text": "we've seen bpf cisco transparent are not",
    "start": "1248799",
    "end": "1251919"
  },
  {
    "text": "that reliable in our use case so let's",
    "start": "1251919",
    "end": "1254880"
  },
  {
    "text": "make a step further and let's try to",
    "start": "1254880",
    "end": "1257039"
  },
  {
    "text": "answer this question first idea that i",
    "start": "1257039",
    "end": "1259520"
  },
  {
    "text": "come up with is let's attach a kernel",
    "start": "1259520",
    "end": "1263200"
  },
  {
    "text": "probe to a key probe to the security",
    "start": "1263200",
    "end": "1265919"
  },
  {
    "text": "socket connect function that calls the",
    "start": "1265919",
    "end": "1268720"
  },
  {
    "text": "socket connect lsm hook that we've seen",
    "start": "1268720",
    "end": "1271600"
  },
  {
    "text": "before in the car do you remember s8",
    "start": "1271600",
    "end": "1274640"
  },
  {
    "text": "cisco arguments at this stage should",
    "start": "1274640",
    "end": "1276240"
  },
  {
    "text": "have been already moved to the kernel so",
    "start": "1276240",
    "end": "1278960"
  },
  {
    "text": "we should be able to see 1.1.1.1",
    "start": "1278960",
    "end": "1281760"
  },
  {
    "text": "and not another p but we need to try i",
    "start": "1281760",
    "end": "1284720"
  },
  {
    "text": "need to try i'm not sure i wrote this",
    "start": "1284720",
    "end": "1286960"
  },
  {
    "text": "other little bpa primer called key probe",
    "start": "1286960",
    "end": "1289919"
  },
  {
    "text": "connect yeah the name it's a bit",
    "start": "1289919",
    "end": "1291760"
  },
  {
    "text": "misleading but who cares let's take a",
    "start": "1291760",
    "end": "1294240"
  },
  {
    "text": "look at it also in this case i use the",
    "start": "1294240",
    "end": "1296320"
  },
  {
    "text": "sec",
    "start": "1296320",
    "end": "1297280"
  },
  {
    "text": "macro please notice that instead of the",
    "start": "1297280",
    "end": "1300159"
  },
  {
    "text": "bpf prog helper i'm using the bpf key",
    "start": "1300159",
    "end": "1303840"
  },
  {
    "text": "probe one here",
    "start": "1303840",
    "end": "1306159"
  },
  {
    "text": "it serves the same purpose",
    "start": "1306159",
    "end": "1308400"
  },
  {
    "text": "as bpf prog but this is specifically for",
    "start": "1308400",
    "end": "1313120"
  },
  {
    "text": "key probes thanks to it i can declare a",
    "start": "1313120",
    "end": "1315280"
  },
  {
    "text": "signature like this and easily having",
    "start": "1315280",
    "end": "1318640"
  },
  {
    "text": "the arguments of the security socket",
    "start": "1318640",
    "end": "1320960"
  },
  {
    "text": "connect function without getting crazy",
    "start": "1320960",
    "end": "1324240"
  },
  {
    "text": "in a way very similar to the previous",
    "start": "1324240",
    "end": "1326159"
  },
  {
    "text": "bpf lsm program this key probe bpf",
    "start": "1326159",
    "end": "1329200"
  },
  {
    "text": "program",
    "start": "1329200",
    "end": "1330240"
  },
  {
    "text": "checks for the protocol okay i'm only",
    "start": "1330240",
    "end": "1333520"
  },
  {
    "text": "caring about epv4 at the moment",
    "start": "1333520",
    "end": "1336240"
  },
  {
    "text": "and then",
    "start": "1336240",
    "end": "1337360"
  },
  {
    "text": "uh in this case i restrict",
    "start": "1337360",
    "end": "1340240"
  },
  {
    "text": "the outputs in the trace part of this",
    "start": "1340240",
    "end": "1342799"
  },
  {
    "text": "program depending on the program causing",
    "start": "1342799",
    "end": "1346640"
  },
  {
    "text": "the connection attack",
    "start": "1346640",
    "end": "1348960"
  },
  {
    "text": "connect okay",
    "start": "1348960",
    "end": "1350480"
  },
  {
    "text": "the rest is simple i cast the address to",
    "start": "1350480",
    "end": "1353360"
  },
  {
    "text": "an ipv4 basically and i bring it up",
    "start": "1353360",
    "end": "1358559"
  },
  {
    "text": "let's run it",
    "start": "1358559",
    "end": "1361679"
  },
  {
    "text": "the attack ready set go all right fine",
    "start": "1361679",
    "end": "1366159"
  },
  {
    "text": "correct destination",
    "start": "1366159",
    "end": "1367840"
  },
  {
    "text": "hey please wait a minute let's not get",
    "start": "1367840",
    "end": "1369919"
  },
  {
    "text": "carried away so easy are we really sure",
    "start": "1369919",
    "end": "1372720"
  },
  {
    "text": "this approach with key probes works 100",
    "start": "1372720",
    "end": "1375520"
  },
  {
    "text": "of time are we sure it's reliable but it",
    "start": "1375520",
    "end": "1378640"
  },
  {
    "text": "gets easily followed by the attack on",
    "start": "1378640",
    "end": "1380480"
  },
  {
    "text": "net minor just like the bpfc school",
    "start": "1380480",
    "end": "1382559"
  },
  {
    "text": "response",
    "start": "1382559",
    "end": "1384640"
  },
  {
    "text": "i'm short on time and that probably",
    "start": "1384640",
    "end": "1386640"
  },
  {
    "text": "write some tests to assess the",
    "start": "1386640",
    "end": "1388480"
  },
  {
    "text": "reliability of various approach",
    "start": "1388480",
    "end": "1391039"
  },
  {
    "text": "soon in the meantime take a note of the",
    "start": "1391039",
    "end": "1393440"
  },
  {
    "text": "repo it's oral is",
    "start": "1393440",
    "end": "1396320"
  },
  {
    "text": "this one you can find it on my github",
    "start": "1396320",
    "end": "1399440"
  },
  {
    "text": "here you'll find also other bpf programs",
    "start": "1399440",
    "end": "1401600"
  },
  {
    "text": "to play with and understand how much a",
    "start": "1401600",
    "end": "1404000"
  },
  {
    "text": "secure and connect team for they give to",
    "start": "1404000",
    "end": "1406159"
  },
  {
    "text": "you",
    "start": "1406159",
    "end": "1407200"
  },
  {
    "text": "now let me also tell you why i wanted to",
    "start": "1407200",
    "end": "1409280"
  },
  {
    "text": "show you various experiments and do some",
    "start": "1409280",
    "end": "1412080"
  },
  {
    "text": "considerations the main reasoning was to",
    "start": "1412080",
    "end": "1414320"
  },
  {
    "text": "prove why a lesson bpf are here to stay",
    "start": "1414320",
    "end": "1417919"
  },
  {
    "text": "and the other way to go they were",
    "start": "1417919",
    "end": "1419600"
  },
  {
    "text": "reshaping improving it the way that we",
    "start": "1419600",
    "end": "1422320"
  },
  {
    "text": "currently do security buff on prevention",
    "start": "1422320",
    "end": "1425360"
  },
  {
    "text": "and on detection side but they are a",
    "start": "1425360",
    "end": "1427600"
  },
  {
    "text": "fairly new feature that is not available",
    "start": "1427600",
    "end": "1430320"
  },
  {
    "text": "in all the kernels so i told that",
    "start": "1430320",
    "end": "1432559"
  },
  {
    "text": "showing you a key probe approach given",
    "start": "1432559",
    "end": "1435200"
  },
  {
    "text": "they exist on all the kernels too was",
    "start": "1435200",
    "end": "1437039"
  },
  {
    "text": "worth a try even though",
    "start": "1437039",
    "end": "1439039"
  },
  {
    "text": "pause a second to consider that",
    "start": "1439039",
    "end": "1441120"
  },
  {
    "text": "attaching a key probe to the function",
    "start": "1441120",
    "end": "1443200"
  },
  {
    "text": "calling an smoke makes it some more",
    "start": "1443200",
    "end": "1446159"
  },
  {
    "text": "dependent on this new feature that's not",
    "start": "1446159",
    "end": "1447840"
  },
  {
    "text": "available in older kernels",
    "start": "1447840",
    "end": "1450000"
  },
  {
    "text": "so maybe it's better to experiment with",
    "start": "1450000",
    "end": "1452880"
  },
  {
    "text": "the key probes on something else like",
    "start": "1452880",
    "end": "1454799"
  },
  {
    "text": "tcp v4 connect function but this is",
    "start": "1454799",
    "end": "1457919"
  },
  {
    "text": "another exercise for the audience at all",
    "start": "1457919",
    "end": "1461039"
  },
  {
    "text": "furthermore what does it take to use a",
    "start": "1461039",
    "end": "1463200"
  },
  {
    "text": "lesson bpf programs for auditing it's",
    "start": "1463200",
    "end": "1465760"
  },
  {
    "text": "just a matter of changing a bit the",
    "start": "1465760",
    "end": "1468080"
  },
  {
    "text": "restrict connect program we've seen",
    "start": "1468080",
    "end": "1469760"
  },
  {
    "text": "before by making it always returning",
    "start": "1469760",
    "end": "1472240"
  },
  {
    "text": "zero so not blocking connections to",
    "start": "1472240",
    "end": "1474640"
  },
  {
    "text": "specific aps and taking note of the",
    "start": "1474640",
    "end": "1476799"
  },
  {
    "text": "detected destination ep maybe putting",
    "start": "1476799",
    "end": "1479279"
  },
  {
    "text": "them in a bpf ring buffer or in a vpf",
    "start": "1479279",
    "end": "1481919"
  },
  {
    "text": "map i prep this audit connect example",
    "start": "1481919",
    "end": "1485440"
  },
  {
    "text": "that basically implements what i've just",
    "start": "1485440",
    "end": "1487200"
  },
  {
    "text": "said let's check it out as you can see",
    "start": "1487200",
    "end": "1489360"
  },
  {
    "text": "i'm always returning zero okay i'm just",
    "start": "1489360",
    "end": "1492000"
  },
  {
    "text": "clamping the program depending on the",
    "start": "1492000",
    "end": "1494480"
  },
  {
    "text": "binary making the connections and i'm",
    "start": "1494480",
    "end": "1496880"
  },
  {
    "text": "outputting the destination",
    "start": "1496880",
    "end": "1499600"
  },
  {
    "text": "the trace pipe as you may notice it's",
    "start": "1499600",
    "end": "1501520"
  },
  {
    "text": "very similar to the restrict connect",
    "start": "1501520",
    "end": "1503279"
  },
  {
    "text": "previously shown bpf program and it's an",
    "start": "1503279",
    "end": "1506320"
  },
  {
    "text": "lsm one",
    "start": "1506320",
    "end": "1508159"
  },
  {
    "text": "it's time to test it",
    "start": "1508159",
    "end": "1509840"
  },
  {
    "text": "let me run tcp dub to see where packets",
    "start": "1509840",
    "end": "1512080"
  },
  {
    "text": "go",
    "start": "1512080",
    "end": "1513120"
  },
  {
    "text": "attack time",
    "start": "1513120",
    "end": "1514960"
  },
  {
    "text": "okay the bypass is not able to use the",
    "start": "1514960",
    "end": "1518480"
  },
  {
    "text": "race window and it's connected to",
    "start": "1518480",
    "end": "1520840"
  },
  {
    "text": "13.107 etc and the last same it's",
    "start": "1520840",
    "end": "1523760"
  },
  {
    "text": "catching it correctly let's try it again",
    "start": "1523760",
    "end": "1526159"
  },
  {
    "text": "oh the attack is connecting to the",
    "start": "1526159",
    "end": "1527679"
  },
  {
    "text": "malicious b as you may see also from tcp",
    "start": "1527679",
    "end": "1531120"
  },
  {
    "text": "dump and from its output and the lsm is",
    "start": "1531120",
    "end": "1534159"
  },
  {
    "text": "getting the actual destination ap the",
    "start": "1534159",
    "end": "1536559"
  },
  {
    "text": "malicious one try again not able to use",
    "start": "1536559",
    "end": "1539120"
  },
  {
    "text": "the race window",
    "start": "1539120",
    "end": "1540799"
  },
  {
    "text": "not able to use this window it's working",
    "start": "1540799",
    "end": "1543520"
  },
  {
    "text": "easy peasy lemon squeezy isn't it so not",
    "start": "1543520",
    "end": "1546000"
  },
  {
    "text": "telling using lsm bpf for auditing is",
    "start": "1546000",
    "end": "1548640"
  },
  {
    "text": "possible it's also in my opinion the",
    "start": "1548640",
    "end": "1550720"
  },
  {
    "text": "recommended and future proof way to go",
    "start": "1550720",
    "end": "1553200"
  },
  {
    "text": "another and work would be to investigate",
    "start": "1553200",
    "end": "1555200"
  },
  {
    "text": "whether bpf product type tracing bpf",
    "start": "1555200",
    "end": "1557919"
  },
  {
    "text": "programs a new kind of tracing problem",
    "start": "1557919",
    "end": "1560000"
  },
  {
    "text": "are vulnerable to this family of talk to",
    "start": "1560000",
    "end": "1562400"
  },
  {
    "text": "attack or investigate the network trace",
    "start": "1562400",
    "end": "1564960"
  },
  {
    "text": "points in the repository i'll put an",
    "start": "1564960",
    "end": "1567200"
  },
  {
    "text": "example for you whole to try out now go",
    "start": "1567200",
    "end": "1570000"
  },
  {
    "text": "right and try them and please ping me",
    "start": "1570000",
    "end": "1572400"
  },
  {
    "text": "back with the results of your",
    "start": "1572400",
    "end": "1573600"
  },
  {
    "text": "experimentations i'm so curious my",
    "start": "1573600",
    "end": "1575840"
  },
  {
    "text": "twitter vms are always super recap time",
    "start": "1575840",
    "end": "1578480"
  },
  {
    "text": "today we've learned various things first",
    "start": "1578480",
    "end": "1580559"
  },
  {
    "text": "that by providing linux with a standard",
    "start": "1580559",
    "end": "1582559"
  },
  {
    "text": "api for policy enforcement lsm ensures",
    "start": "1582559",
    "end": "1585840"
  },
  {
    "text": "to enable the widespread deployment of",
    "start": "1585840",
    "end": "1588080"
  },
  {
    "text": "security hardness systems the",
    "start": "1588080",
    "end": "1590320"
  },
  {
    "text": "protections provided by lsms do help",
    "start": "1590320",
    "end": "1592720"
  },
  {
    "text": "protect your system from being hacked",
    "start": "1592720",
    "end": "1595279"
  },
  {
    "text": "when an attacker uses flows in one of",
    "start": "1595279",
    "end": "1597440"
  },
  {
    "text": "the running programs lsms are definitely",
    "start": "1597440",
    "end": "1600400"
  },
  {
    "text": "an important layer in any serious",
    "start": "1600400",
    "end": "1602960"
  },
  {
    "text": "defense in depth strategy on linux",
    "start": "1602960",
    "end": "1605120"
  },
  {
    "text": "machines we've also learned that bpf",
    "start": "1605120",
    "end": "1607279"
  },
  {
    "text": "cisco trace points are not that reliable",
    "start": "1607279",
    "end": "1610240"
  },
  {
    "text": "as we may have hoped and also that lsn",
    "start": "1610240",
    "end": "1612960"
  },
  {
    "text": "hooks happens at a very very deep level",
    "start": "1612960",
    "end": "1615440"
  },
  {
    "text": "in the cisco's flow and they can be used",
    "start": "1615440",
    "end": "1617520"
  },
  {
    "text": "for buff prevention and auditing with",
    "start": "1617520",
    "end": "1620480"
  },
  {
    "text": "little to zero effort so i'd say it's",
    "start": "1620480",
    "end": "1623200"
  },
  {
    "text": "all for today thank you for joining us",
    "start": "1623200",
    "end": "1625919"
  },
  {
    "text": "ciao",
    "start": "1625919",
    "end": "1628399"
  }
]