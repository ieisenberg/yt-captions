[
  {
    "start": "0",
    "end": "0"
  },
  {
    "text": "hey everyone thank you for joining me my",
    "start": "0",
    "end": "1599"
  },
  {
    "text": "name is derek and i'm going to give him",
    "start": "1599",
    "end": "2720"
  },
  {
    "text": "the story on how we built a service mesh",
    "start": "2720",
    "end": "4560"
  },
  {
    "text": "from scratch at pinterest",
    "start": "4560",
    "end": "6960"
  },
  {
    "text": "the story begins with the traffic",
    "start": "6960",
    "end": "8160"
  },
  {
    "text": "engineering team which i joined in 2017",
    "start": "8160",
    "end": "10320"
  },
  {
    "text": "and was relatively new at the time we'd",
    "start": "10320",
    "end": "12639"
  },
  {
    "text": "adopted the edge infrastructure as our",
    "start": "12639",
    "end": "14400"
  },
  {
    "text": "domain particularly the cdn and dns",
    "start": "14400",
    "end": "16160"
  },
  {
    "text": "infrastructure as well as our ingress",
    "start": "16160",
    "end": "17440"
  },
  {
    "text": "load balancing to our front-end",
    "start": "17440",
    "end": "18800"
  },
  {
    "text": "applications",
    "start": "18800",
    "end": "19920"
  },
  {
    "text": "one of the first projects that i was",
    "start": "19920",
    "end": "21199"
  },
  {
    "text": "able to participate in on the traffic",
    "start": "21199",
    "end": "22800"
  },
  {
    "text": "team",
    "start": "22800",
    "end": "23359"
  },
  {
    "text": "was replacing our http proxy inside our",
    "start": "23359",
    "end": "25439"
  },
  {
    "text": "ingress load balancer",
    "start": "25439",
    "end": "28160"
  },
  {
    "start": "28000",
    "end": "28000"
  },
  {
    "text": "the ingross load balancing architecture",
    "start": "28160",
    "end": "29599"
  },
  {
    "text": "at pinterest consists of a cloud load",
    "start": "29599",
    "end": "30880"
  },
  {
    "text": "balancer that goes to a set of http",
    "start": "30880",
    "end": "32558"
  },
  {
    "text": "proxies that can do",
    "start": "32559",
    "end": "33680"
  },
  {
    "text": "more rich and feature complete proxying",
    "start": "33680",
    "end": "36480"
  },
  {
    "text": "such as",
    "start": "36480",
    "end": "37200"
  },
  {
    "text": "http routing on headers or paths or",
    "start": "37200",
    "end": "39280"
  },
  {
    "text": "provide rich stats observability",
    "start": "39280",
    "end": "41680"
  },
  {
    "text": "the proxy that we were using at the time",
    "start": "41680",
    "end": "43360"
  },
  {
    "text": "was lacking some core features that we",
    "start": "43360",
    "end": "44960"
  },
  {
    "text": "really wanted in our proxy",
    "start": "44960",
    "end": "46559"
  },
  {
    "text": "and was constraining our ability to",
    "start": "46559",
    "end": "48000"
  },
  {
    "text": "innovate and go faster in the ingress",
    "start": "48000",
    "end": "49440"
  },
  {
    "text": "load balancer",
    "start": "49440",
    "end": "51199"
  },
  {
    "text": "we looked at the existing proxies",
    "start": "51199",
    "end": "53600"
  },
  {
    "text": "available and did a future comparison of",
    "start": "53600",
    "end": "55680"
  },
  {
    "text": "what they all provided",
    "start": "55680",
    "end": "57039"
  },
  {
    "text": "envoy checked all the boxes that we",
    "start": "57039",
    "end": "58559"
  },
  {
    "text": "needed for an edge proxy but we were",
    "start": "58559",
    "end": "60239"
  },
  {
    "text": "particularly excited about the c",
    "start": "60239",
    "end": "61520"
  },
  {
    "text": "plus api that allowed us to do whatever",
    "start": "61520",
    "end": "63520"
  },
  {
    "text": "we wanted inside the proxy",
    "start": "63520",
    "end": "65040"
  },
  {
    "text": "with a type safe and fast language along",
    "start": "65040",
    "end": "67119"
  },
  {
    "text": "with the strong unit testing framework",
    "start": "67119",
    "end": "68720"
  },
  {
    "text": "and awesome build support we were also",
    "start": "68720",
    "end": "71119"
  },
  {
    "text": "really excited about the open source",
    "start": "71119",
    "end": "72240"
  },
  {
    "text": "community around envoy",
    "start": "72240",
    "end": "73600"
  },
  {
    "text": "it was very receptive to any issues that",
    "start": "73600",
    "end": "75200"
  },
  {
    "text": "we had and people were willing to work",
    "start": "75200",
    "end": "77280"
  },
  {
    "text": "with us on workarounds",
    "start": "77280",
    "end": "78720"
  },
  {
    "text": "or to encourage us to contribute pull",
    "start": "78720",
    "end": "80880"
  },
  {
    "text": "requests to the",
    "start": "80880",
    "end": "81759"
  },
  {
    "text": "envoy code base and improve the proxy",
    "start": "81759",
    "end": "83360"
  },
  {
    "text": "better for it make it better for",
    "start": "83360",
    "end": "84840"
  },
  {
    "text": "everyone",
    "start": "84840",
    "end": "87360"
  },
  {
    "start": "87000",
    "end": "87000"
  },
  {
    "text": "to get ready for envoy we did a lot of",
    "start": "87360",
    "end": "88960"
  },
  {
    "text": "operational homework to make sure that",
    "start": "88960",
    "end": "90720"
  },
  {
    "text": "we had fast and reliable deployments",
    "start": "90720",
    "end": "93040"
  },
  {
    "text": "well integration with our ci cd and",
    "start": "93040",
    "end": "94640"
  },
  {
    "text": "monitoring and alerts",
    "start": "94640",
    "end": "96240"
  },
  {
    "text": "we wrote plenty of run books around",
    "start": "96240",
    "end": "97680"
  },
  {
    "text": "envoy to make sure we were prepared for",
    "start": "97680",
    "end": "99119"
  },
  {
    "text": "when things could go wrong",
    "start": "99119",
    "end": "100560"
  },
  {
    "text": "and we wrote numerous extensions both",
    "start": "100560",
    "end": "102320"
  },
  {
    "text": "internally and open source",
    "start": "102320",
    "end": "103680"
  },
  {
    "text": "to make envoy feature complete and",
    "start": "103680",
    "end": "106159"
  },
  {
    "text": "provide exact parity with our existing",
    "start": "106159",
    "end": "108159"
  },
  {
    "text": "proxy",
    "start": "108159",
    "end": "108960"
  },
  {
    "text": "our objective here was to have such",
    "start": "108960",
    "end": "111759"
  },
  {
    "text": "close feature completion",
    "start": "111759",
    "end": "113119"
  },
  {
    "text": "that we could essentially",
    "start": "113119",
    "end": "115840"
  },
  {
    "text": "elsewhere in the infrastructure we had a",
    "start": "126960",
    "end": "128720"
  },
  {
    "text": "big migration occurring",
    "start": "128720",
    "end": "130000"
  },
  {
    "start": "130000",
    "end": "130000"
  },
  {
    "text": "to shift all services to mtls the",
    "start": "130000",
    "end": "133040"
  },
  {
    "text": "service framework team",
    "start": "133040",
    "end": "134239"
  },
  {
    "text": "a sibling infrastructure team that",
    "start": "134239",
    "end": "136080"
  },
  {
    "text": "manages service to service communication",
    "start": "136080",
    "end": "138080"
  },
  {
    "text": "was working on the frameworks that all",
    "start": "138080",
    "end": "139920"
  },
  {
    "text": "these languages used to get them ready",
    "start": "139920",
    "end": "141360"
  },
  {
    "text": "for tls",
    "start": "141360",
    "end": "142720"
  },
  {
    "text": "we started with the java service",
    "start": "142720",
    "end": "143920"
  },
  {
    "text": "framework since java is one of the most",
    "start": "143920",
    "end": "145520"
  },
  {
    "text": "commonly used languages at pinterest",
    "start": "145520",
    "end": "147360"
  },
  {
    "text": "and that migration involved a lot of",
    "start": "147360",
    "end": "149280"
  },
  {
    "text": "work including bug fixes and libraries",
    "start": "149280",
    "end": "151120"
  },
  {
    "text": "and a massive coordination effort to",
    "start": "151120",
    "end": "152640"
  },
  {
    "text": "ensure",
    "start": "152640",
    "end": "153280"
  },
  {
    "text": "that deployments were safe once the",
    "start": "153280",
    "end": "156000"
  },
  {
    "text": "completion or once the migration for",
    "start": "156000",
    "end": "157519"
  },
  {
    "text": "java was",
    "start": "157519",
    "end": "158160"
  },
  {
    "text": "completed we looked at the long list of",
    "start": "158160",
    "end": "160080"
  },
  {
    "text": "languages that we had ahead of us",
    "start": "160080",
    "end": "161440"
  },
  {
    "text": "python node c plus elixir and go",
    "start": "161440",
    "end": "165120"
  },
  {
    "text": "and thought man we really have to",
    "start": "165120",
    "end": "166959"
  },
  {
    "text": "complete this all over again for each of",
    "start": "166959",
    "end": "168640"
  },
  {
    "text": "these languages",
    "start": "168640",
    "end": "169760"
  },
  {
    "text": "that sounds like a lot more work and not",
    "start": "169760",
    "end": "171680"
  },
  {
    "text": "to mention the intercompatibility",
    "start": "171680",
    "end": "173360"
  },
  {
    "text": "between the languages how to make sure",
    "start": "173360",
    "end": "174879"
  },
  {
    "text": "that python tls libraries play nicely",
    "start": "174879",
    "end": "176800"
  },
  {
    "text": "with the c",
    "start": "176800",
    "end": "177280"
  },
  {
    "text": "plus libraries and so forth and all this",
    "start": "177280",
    "end": "179519"
  },
  {
    "text": "is tls over thrift as well to add",
    "start": "179519",
    "end": "181120"
  },
  {
    "text": "another layer of complexity",
    "start": "181120",
    "end": "183519"
  },
  {
    "text": "rather than repeating all this work for",
    "start": "183519",
    "end": "185680"
  },
  {
    "text": "all these services again",
    "start": "185680",
    "end": "187200"
  },
  {
    "text": "we started looking at envoy as a",
    "start": "187200",
    "end": "188480"
  },
  {
    "text": "solution to terminate tls elsewhere in",
    "start": "188480",
    "end": "190720"
  },
  {
    "text": "infrastructure",
    "start": "190720",
    "end": "192000"
  },
  {
    "text": "the way that we have completed our load",
    "start": "192000",
    "end": "194239"
  },
  {
    "text": "balancer infrastructure",
    "start": "194239",
    "end": "195680"
  },
  {
    "text": "is such that envoy can be deployed to",
    "start": "195680",
    "end": "197280"
  },
  {
    "text": "arbitrary hosts and accept arbitrary",
    "start": "197280",
    "end": "199040"
  },
  {
    "text": "configuration",
    "start": "199040",
    "end": "200080"
  },
  {
    "text": "um using environment variables that are",
    "start": "200080",
    "end": "202239"
  },
  {
    "text": "set by our deployment tooling",
    "start": "202239",
    "end": "204319"
  },
  {
    "text": "so we looked at doing just that we",
    "start": "204319",
    "end": "206239"
  },
  {
    "text": "played around with taking",
    "start": "206239",
    "end": "208000"
  },
  {
    "start": "207000",
    "end": "207000"
  },
  {
    "text": "some non-ingress hosts and adding them",
    "start": "208000",
    "end": "209760"
  },
  {
    "text": "into the onboard deployment group as an",
    "start": "209760",
    "end": "211360"
  },
  {
    "text": "experiment to say",
    "start": "211360",
    "end": "212799"
  },
  {
    "text": "what happens if you put envoy there and",
    "start": "212799",
    "end": "215200"
  },
  {
    "text": "once it is there what does that",
    "start": "215200",
    "end": "216480"
  },
  {
    "text": "configuration look like and play around",
    "start": "216480",
    "end": "217920"
  },
  {
    "text": "with the different settings that we",
    "start": "217920",
    "end": "218879"
  },
  {
    "text": "needed to",
    "start": "218879",
    "end": "220000"
  },
  {
    "text": "successfully terminate tls on a canary",
    "start": "220000",
    "end": "222239"
  },
  {
    "text": "machine",
    "start": "222239",
    "end": "223360"
  },
  {
    "text": "once we had a successful configuration",
    "start": "223360",
    "end": "225040"
  },
  {
    "text": "going we adjusted our ingress load",
    "start": "225040",
    "end": "227120"
  },
  {
    "text": "balancers to recognize this new",
    "start": "227120",
    "end": "229200"
  },
  {
    "text": "deployment environment that had envoy",
    "start": "229200",
    "end": "230799"
  },
  {
    "text": "trimming tls and using envoy's",
    "start": "230799",
    "end": "232799"
  },
  {
    "text": "incremental",
    "start": "232799",
    "end": "233760"
  },
  {
    "text": "routing or sorry weighted routing we",
    "start": "233760",
    "end": "235680"
  },
  {
    "text": "gradually shifted traffic from non-envoy",
    "start": "235680",
    "end": "238000"
  },
  {
    "text": "tls to envoy with tls",
    "start": "238000",
    "end": "241120"
  },
  {
    "text": "and eventually we got something like",
    "start": "241120",
    "end": "242640"
  },
  {
    "text": "this which if you squint a little bit",
    "start": "242640",
    "end": "244799"
  },
  {
    "text": "it's",
    "start": "244799",
    "end": "245200"
  },
  {
    "text": "kind of starting to look like a mesh",
    "start": "245200",
    "end": "246640"
  },
  {
    "text": "right we have onboard both ends",
    "start": "246640",
    "end": "248239"
  },
  {
    "text": "uh proxying traffic and so once this",
    "start": "248239",
    "end": "251840"
  },
  {
    "text": "uh tls formation project was completed",
    "start": "251840",
    "end": "253519"
  },
  {
    "text": "and people started to see the value",
    "start": "253519",
    "end": "255040"
  },
  {
    "text": "that ava was providing that if we could",
    "start": "255040",
    "end": "256639"
  },
  {
    "text": "put it elsewhere it could take care of",
    "start": "256639",
    "end": "258639"
  },
  {
    "text": "all these really difficult problems that",
    "start": "258639",
    "end": "260079"
  },
  {
    "text": "we had across a variety of programming",
    "start": "260079",
    "end": "261759"
  },
  {
    "text": "languages",
    "start": "261759",
    "end": "262800"
  },
  {
    "text": "and thus began a great flooding of use",
    "start": "262800",
    "end": "265360"
  },
  {
    "text": "cases and feature requests",
    "start": "265360",
    "end": "266720"
  },
  {
    "text": "and the common vernacular around",
    "start": "266720",
    "end": "269120"
  },
  {
    "text": "pinterest included meshify",
    "start": "269120",
    "end": "270639"
  },
  {
    "text": "and meshified meshify is to of course to",
    "start": "270639",
    "end": "274000"
  },
  {
    "text": "add a service to the service mesh for",
    "start": "274000",
    "end": "275840"
  },
  {
    "text": "processing traffic and meshified was the",
    "start": "275840",
    "end": "277520"
  },
  {
    "text": "state of whether",
    "start": "277520",
    "end": "278720"
  },
  {
    "text": "a service has been added to the service",
    "start": "278720",
    "end": "280840"
  },
  {
    "text": "mesh",
    "start": "280840",
    "end": "282479"
  },
  {
    "text": "while we're adding all these services to",
    "start": "282479",
    "end": "284080"
  },
  {
    "text": "the service mesh our control plane",
    "start": "284080",
    "end": "286080"
  },
  {
    "start": "285000",
    "end": "285000"
  },
  {
    "text": "stayed relatively simple",
    "start": "286080",
    "end": "287600"
  },
  {
    "text": "one of envoy's shining features that",
    "start": "287600",
    "end": "289040"
  },
  {
    "text": "many people know it for is its xds api",
    "start": "289040",
    "end": "291680"
  },
  {
    "text": "that allows it to",
    "start": "291680",
    "end": "293199"
  },
  {
    "text": "be configured over http or grpc",
    "start": "293199",
    "end": "296479"
  },
  {
    "text": "and we did leverage that for service",
    "start": "296479",
    "end": "297840"
  },
  {
    "text": "discovery since service discovery is a",
    "start": "297840",
    "end": "299360"
  },
  {
    "text": "highly dynamic component with hosts",
    "start": "299360",
    "end": "301039"
  },
  {
    "text": "coming in and out of service discovery",
    "start": "301039",
    "end": "302400"
  },
  {
    "text": "all the time",
    "start": "302400",
    "end": "303759"
  },
  {
    "text": "but the other configuration aspects of",
    "start": "303759",
    "end": "305440"
  },
  {
    "text": "envoy like routes clusters and listeners",
    "start": "305440",
    "end": "307520"
  },
  {
    "text": "didn't really change all that often for",
    "start": "307520",
    "end": "309120"
  },
  {
    "text": "us we find us tweaking them maybe",
    "start": "309120",
    "end": "311360"
  },
  {
    "text": "once or twice a week maybe more often",
    "start": "311360",
    "end": "313199"
  },
  {
    "text": "than that if we were doing an active",
    "start": "313199",
    "end": "314479"
  },
  {
    "text": "migration",
    "start": "314479",
    "end": "315600"
  },
  {
    "text": "but those all stayed relatively static",
    "start": "315600",
    "end": "317520"
  },
  {
    "text": "once they were in place",
    "start": "317520",
    "end": "318880"
  },
  {
    "text": "so we figured why are we going to add",
    "start": "318880",
    "end": "320960"
  },
  {
    "text": "complexity where we don't need it and so",
    "start": "320960",
    "end": "322720"
  },
  {
    "text": "we just kept these as flat files that",
    "start": "322720",
    "end": "324240"
  },
  {
    "text": "get deployed to the hosts",
    "start": "324240",
    "end": "326560"
  },
  {
    "text": "and these are just envoy configuration",
    "start": "326560",
    "end": "328960"
  },
  {
    "text": "files hand written",
    "start": "328960",
    "end": "330240"
  },
  {
    "text": "full yaml files and as we started to",
    "start": "330240",
    "end": "333280"
  },
  {
    "text": "add more services into the service mesh",
    "start": "333280",
    "end": "334800"
  },
  {
    "text": "we found this configuration starting to",
    "start": "334800",
    "end": "336240"
  },
  {
    "text": "become more difficult to manage",
    "start": "336240",
    "end": "338000"
  },
  {
    "text": "and so started to introduce jinja",
    "start": "338000",
    "end": "339520"
  },
  {
    "text": "templating as a means to control the",
    "start": "339520",
    "end": "341199"
  },
  {
    "text": "complexity as well as to build higher",
    "start": "341199",
    "end": "342880"
  },
  {
    "text": "level abstractions that other developers",
    "start": "342880",
    "end": "344400"
  },
  {
    "text": "can use",
    "start": "344400",
    "end": "345199"
  },
  {
    "text": "to adopt the service mesh this example",
    "start": "345199",
    "end": "348000"
  },
  {
    "text": "here shows the",
    "start": "348000",
    "end": "349120"
  },
  {
    "text": "ideal base case for a service owner",
    "start": "349120",
    "end": "351199"
  },
  {
    "text": "assuming they're using all the defaults",
    "start": "351199",
    "end": "352479"
  },
  {
    "text": "we would like them to use",
    "start": "352479",
    "end": "353759"
  },
  {
    "text": "and aren't doing anything too crazy with",
    "start": "353759",
    "end": "355039"
  },
  {
    "text": "their service you can ideally just",
    "start": "355039",
    "end": "356880"
  },
  {
    "text": "import some macros",
    "start": "356880",
    "end": "358000"
  },
  {
    "text": "define your ingress and then define the",
    "start": "358000",
    "end": "359680"
  },
  {
    "text": "cluster you want to talk to and the rest",
    "start": "359680",
    "end": "361520"
  },
  {
    "text": "just gets generated from there",
    "start": "361520",
    "end": "364479"
  },
  {
    "text": "the having all the configuration in a",
    "start": "364479",
    "end": "366720"
  },
  {
    "text": "single repository also allowed us to do",
    "start": "366720",
    "end": "368720"
  },
  {
    "text": "a lot of powerful static analysis",
    "start": "368720",
    "end": "370479"
  },
  {
    "text": "and sort of compiler level controls on",
    "start": "370479",
    "end": "372479"
  },
  {
    "text": "the configuration",
    "start": "372479",
    "end": "374000"
  },
  {
    "text": "when a person is compiling the digital",
    "start": "374000",
    "end": "376000"
  },
  {
    "text": "templates we can check and verify things",
    "start": "376000",
    "end": "378000"
  },
  {
    "text": "such as",
    "start": "378000",
    "end": "378960"
  },
  {
    "text": "routes always point to a valid cluster",
    "start": "378960",
    "end": "380880"
  },
  {
    "text": "so we never end up with",
    "start": "380880",
    "end": "382720"
  },
  {
    "text": "a bad route in production we were also",
    "start": "382720",
    "end": "384960"
  },
  {
    "text": "using envoy's schema validation tool to",
    "start": "384960",
    "end": "386960"
  },
  {
    "text": "make sure that all the configuration",
    "start": "386960",
    "end": "388319"
  },
  {
    "text": "options that people were using",
    "start": "388319",
    "end": "389919"
  },
  {
    "text": "would actually be recognized by the data",
    "start": "389919",
    "end": "391600"
  },
  {
    "text": "plane once it got into production",
    "start": "391600",
    "end": "393680"
  },
  {
    "text": "this has saved us many times from bad",
    "start": "393680",
    "end": "396479"
  },
  {
    "text": "configuration options even just typos or",
    "start": "396479",
    "end": "398479"
  },
  {
    "text": "whatnot that",
    "start": "398479",
    "end": "399520"
  },
  {
    "text": "get post into a pull request and the ci",
    "start": "399520",
    "end": "401440"
  },
  {
    "text": "tools would check and say",
    "start": "401440",
    "end": "402880"
  },
  {
    "text": "no this isn't going to work this isn't",
    "start": "402880",
    "end": "404240"
  },
  {
    "text": "going to make it to production and so we",
    "start": "404240",
    "end": "405759"
  },
  {
    "text": "can fix our configurations before",
    "start": "405759",
    "end": "407360"
  },
  {
    "text": "even putting it into the pipeline",
    "start": "407360",
    "end": "410800"
  },
  {
    "start": "410000",
    "end": "410000"
  },
  {
    "text": "at this point we had really nailed the",
    "start": "411120",
    "end": "413120"
  },
  {
    "text": "fundamentals of what it meant to",
    "start": "413120",
    "end": "414800"
  },
  {
    "text": "package and deploy envoy in a generic",
    "start": "414800",
    "end": "417599"
  },
  {
    "text": "fashion",
    "start": "417599",
    "end": "418080"
  },
  {
    "text": "we had the ability to deploy envoy to",
    "start": "418080",
    "end": "419520"
  },
  {
    "text": "any service through our deployment tool",
    "start": "419520",
    "end": "421440"
  },
  {
    "text": "we had the ability to configure envoy",
    "start": "421440",
    "end": "422800"
  },
  {
    "text": "for any service through our compiler",
    "start": "422800",
    "end": "424960"
  },
  {
    "text": "config compiler and configuration",
    "start": "424960",
    "end": "426800"
  },
  {
    "text": "pipeline",
    "start": "426800",
    "end": "428000"
  },
  {
    "text": "we had templates in the configuration to",
    "start": "428000",
    "end": "429759"
  },
  {
    "text": "provide a simple interface and provide",
    "start": "429759",
    "end": "431440"
  },
  {
    "text": "the ability to write raw envelope when",
    "start": "431440",
    "end": "432880"
  },
  {
    "text": "needed just in case we had some",
    "start": "432880",
    "end": "434560"
  },
  {
    "text": "crazy use cases that required more",
    "start": "434560",
    "end": "436880"
  },
  {
    "text": "in-depth envoy expertise",
    "start": "436880",
    "end": "439280"
  },
  {
    "text": "we also had a build system through the",
    "start": "439280",
    "end": "441360"
  },
  {
    "text": "open source onboard project",
    "start": "441360",
    "end": "442880"
  },
  {
    "text": "that allowed us to write cpus plus",
    "start": "442880",
    "end": "444639"
  },
  {
    "text": "extensions apply patches",
    "start": "444639",
    "end": "446479"
  },
  {
    "text": "and regularly synchronize our envoy",
    "start": "446479",
    "end": "448240"
  },
  {
    "text": "build with upstream's code",
    "start": "448240",
    "end": "450080"
  },
  {
    "text": "we were often syncing our upgram code up",
    "start": "450080",
    "end": "452720"
  },
  {
    "text": "to twice a week deploying new envoy",
    "start": "452720",
    "end": "454479"
  },
  {
    "text": "builds",
    "start": "454479",
    "end": "455280"
  },
  {
    "text": "and the build system that allows us to",
    "start": "455280",
    "end": "456639"
  },
  {
    "text": "do that helped us go very quickly",
    "start": "456639",
    "end": "459520"
  },
  {
    "text": "we also had a static analysis system",
    "start": "459520",
    "end": "460880"
  },
  {
    "text": "that i just mentioned for our",
    "start": "460880",
    "end": "461759"
  },
  {
    "text": "configurations that",
    "start": "461759",
    "end": "462800"
  },
  {
    "text": "made sure that our config changes were",
    "start": "462800",
    "end": "466080"
  },
  {
    "text": "relatively safe to do",
    "start": "466080",
    "end": "469599"
  },
  {
    "text": "with the fundamentals in place we",
    "start": "469680",
    "end": "470960"
  },
  {
    "start": "470000",
    "end": "470000"
  },
  {
    "text": "started to get a lot of new use cases",
    "start": "470960",
    "end": "472800"
  },
  {
    "text": "and feature requests from teams outside",
    "start": "472800",
    "end": "474560"
  },
  {
    "text": "of traffic",
    "start": "474560",
    "end": "476160"
  },
  {
    "text": "one of my favorite use cases here one of",
    "start": "476160",
    "end": "478160"
  },
  {
    "text": "the first ones that came from security",
    "start": "478160",
    "end": "479599"
  },
  {
    "text": "is internal web envoy the idea being",
    "start": "479599",
    "end": "481440"
  },
  {
    "text": "that pinterest has a lot of internal web",
    "start": "481440",
    "end": "483120"
  },
  {
    "text": "services",
    "start": "483120",
    "end": "484000"
  },
  {
    "text": "websites that are um running for a",
    "start": "484000",
    "end": "486479"
  },
  {
    "text": "variety of reasons",
    "start": "486479",
    "end": "487199"
  },
  {
    "text": "deployment tooling or say an ml tool to",
    "start": "487199",
    "end": "490479"
  },
  {
    "text": "analyze",
    "start": "490479",
    "end": "491039"
  },
  {
    "text": "scoring on images whatever you could",
    "start": "491039",
    "end": "493440"
  },
  {
    "text": "imagine",
    "start": "493440",
    "end": "494560"
  },
  {
    "text": "we wanted all these websites to use safe",
    "start": "494560",
    "end": "496000"
  },
  {
    "text": "security defaults even though they are",
    "start": "496000",
    "end": "497360"
  },
  {
    "text": "internal to vpn",
    "start": "497360",
    "end": "500240"
  },
  {
    "text": "to do so the security team built a",
    "start": "500240",
    "end": "502080"
  },
  {
    "text": "configuration pipeline",
    "start": "502080",
    "end": "503360"
  },
  {
    "text": "that enables all to be deployed with the",
    "start": "503360",
    "end": "505919"
  },
  {
    "text": "standard",
    "start": "505919",
    "end": "506639"
  },
  {
    "text": "and well accepted security defaults for",
    "start": "506639",
    "end": "508879"
  },
  {
    "text": "web services such as csrf protection",
    "start": "508879",
    "end": "510800"
  },
  {
    "text": "course protection tls termination and",
    "start": "510800",
    "end": "513440"
  },
  {
    "text": "click tracking and crosstalk scripting",
    "start": "513440",
    "end": "514640"
  },
  {
    "text": "prevention headers",
    "start": "514640",
    "end": "515919"
  },
  {
    "text": "all this without the web developers",
    "start": "515919",
    "end": "517200"
  },
  {
    "text": "having to really do much except define",
    "start": "517200",
    "end": "519120"
  },
  {
    "text": "their service in the envoy configuration",
    "start": "519120",
    "end": "521518"
  },
  {
    "text": "jinja language the key idea here being",
    "start": "521519",
    "end": "524480"
  },
  {
    "text": "that internal web envoy while being a",
    "start": "524480",
    "end": "526320"
  },
  {
    "text": "really cool",
    "start": "526320",
    "end": "527360"
  },
  {
    "text": "pattern and deployment strategy is",
    "start": "527360",
    "end": "529600"
  },
  {
    "text": "really just another node in the mesh",
    "start": "529600",
    "end": "531600"
  },
  {
    "text": "it's not a unique case that we need to",
    "start": "531600",
    "end": "534240"
  },
  {
    "text": "cater to",
    "start": "534240",
    "end": "535120"
  },
  {
    "text": "we simply need to write the",
    "start": "535120",
    "end": "536240"
  },
  {
    "text": "configuration dsl for it and then treat",
    "start": "536240",
    "end": "538240"
  },
  {
    "text": "it just like any other node mesh",
    "start": "538240",
    "end": "539519"
  },
  {
    "text": "deployed to a host and",
    "start": "539519",
    "end": "540880"
  },
  {
    "text": "given an arbitrary configuration and",
    "start": "540880",
    "end": "543680"
  },
  {
    "text": "this now runs in front of all of our",
    "start": "543680",
    "end": "545040"
  },
  {
    "text": "major web services",
    "start": "545040",
    "end": "546160"
  },
  {
    "text": "including open source software such as",
    "start": "546160",
    "end": "547920"
  },
  {
    "text": "fabricator and jenkins",
    "start": "547920",
    "end": "549200"
  },
  {
    "text": "as well as a variety of internal web",
    "start": "549200",
    "end": "550560"
  },
  {
    "text": "services",
    "start": "550560",
    "end": "553040"
  },
  {
    "start": "553000",
    "end": "553000"
  },
  {
    "text": "some more mesh specific use cases also",
    "start": "553519",
    "end": "555120"
  },
  {
    "text": "started to come our way after proving",
    "start": "555120",
    "end": "556399"
  },
  {
    "text": "the success with internal web envoy",
    "start": "556399",
    "end": "558240"
  },
  {
    "text": "the web infrastructure team had a",
    "start": "558240",
    "end": "559600"
  },
  {
    "text": "particularly interesting case where",
    "start": "559600",
    "end": "561680"
  },
  {
    "text": "the deployment patterns used for the web",
    "start": "561680",
    "end": "563680"
  },
  {
    "text": "app were really difficult and fragile to",
    "start": "563680",
    "end": "565360"
  },
  {
    "text": "work with",
    "start": "565360",
    "end": "565920"
  },
  {
    "text": "and it was constraining the team from",
    "start": "565920",
    "end": "567200"
  },
  {
    "text": "adopting newer infrastructures such as",
    "start": "567200",
    "end": "568720"
  },
  {
    "text": "kubernetes",
    "start": "568720",
    "end": "570560"
  },
  {
    "text": "by analyzing the problem we realized",
    "start": "570560",
    "end": "572080"
  },
  {
    "text": "that this is really a routing problem",
    "start": "572080",
    "end": "573600"
  },
  {
    "text": "and if we could write an envoy filter",
    "start": "573600",
    "end": "575040"
  },
  {
    "text": "that would correctly route requests to",
    "start": "575040",
    "end": "576640"
  },
  {
    "text": "an arbitrary destination that we want",
    "start": "576640",
    "end": "577839"
  },
  {
    "text": "them to go to",
    "start": "577839",
    "end": "578880"
  },
  {
    "text": "we could very much alleviate the",
    "start": "578880",
    "end": "580880"
  },
  {
    "text": "problems that the web infrastructure",
    "start": "580880",
    "end": "581920"
  },
  {
    "text": "team was facing and allow them to adopt",
    "start": "581920",
    "end": "583440"
  },
  {
    "text": "newer infrastructure",
    "start": "583440",
    "end": "584560"
  },
  {
    "text": "and so to do so we wrote a novel",
    "start": "584560",
    "end": "586160"
  },
  {
    "text": "extension then the cyber liability team",
    "start": "586160",
    "end": "588399"
  },
  {
    "text": "came to us and said well if we're",
    "start": "588399",
    "end": "589839"
  },
  {
    "text": "deploying envoy",
    "start": "589839",
    "end": "591040"
  },
  {
    "text": "everywhere um then perhaps we could",
    "start": "591040",
    "end": "594160"
  },
  {
    "text": "do sli monitoring in a very generic way",
    "start": "594160",
    "end": "596399"
  },
  {
    "text": "for http and thrift which is true",
    "start": "596399",
    "end": "598800"
  },
  {
    "text": "uh regardless of what language you are",
    "start": "598800",
    "end": "601120"
  },
  {
    "text": "using we could deploy all in front of",
    "start": "601120",
    "end": "602640"
  },
  {
    "text": "your service and have envoy monitor for",
    "start": "602640",
    "end": "604399"
  },
  {
    "text": "success and error rates and report those",
    "start": "604399",
    "end": "606160"
  },
  {
    "text": "back",
    "start": "606160",
    "end": "606720"
  },
  {
    "text": "and the site variability team can then",
    "start": "606720",
    "end": "608240"
  },
  {
    "text": "compose error budget reports that are",
    "start": "608240",
    "end": "610000"
  },
  {
    "text": "generic to any application that's",
    "start": "610000",
    "end": "611360"
  },
  {
    "text": "deployed within pinterest infrastructure",
    "start": "611360",
    "end": "613920"
  },
  {
    "text": "and the privacy and legal team came to",
    "start": "613920",
    "end": "615279"
  },
  {
    "text": "us as well and said oh this is really",
    "start": "615279",
    "end": "616800"
  },
  {
    "text": "cool you're proxying all this hp traffic",
    "start": "616800",
    "end": "618399"
  },
  {
    "text": "to envoy",
    "start": "618399",
    "end": "619680"
  },
  {
    "text": "that means you could probably see all",
    "start": "619680",
    "end": "621279"
  },
  {
    "text": "the cookie headers being passed around",
    "start": "621279",
    "end": "622880"
  },
  {
    "text": "and make sure that the cookies being",
    "start": "622880",
    "end": "624560"
  },
  {
    "text": "used are what we allow it to be used",
    "start": "624560",
    "end": "627519"
  },
  {
    "text": "with the concern of user privacy in mind",
    "start": "627519",
    "end": "629360"
  },
  {
    "text": "we don't want to",
    "start": "629360",
    "end": "630800"
  },
  {
    "text": "be accepting third party cookies that we",
    "start": "630800",
    "end": "632959"
  },
  {
    "text": "find malicious or could",
    "start": "632959",
    "end": "634399"
  },
  {
    "text": "compromise user privacy and so envoy",
    "start": "634399",
    "end": "636959"
  },
  {
    "text": "provided a really powerful",
    "start": "636959",
    "end": "639200"
  },
  {
    "text": "observability point where we can inspect",
    "start": "639200",
    "end": "640800"
  },
  {
    "text": "all cookie traffic and make sure that",
    "start": "640800",
    "end": "642399"
  },
  {
    "text": "all the cookies were what you expect",
    "start": "642399",
    "end": "643600"
  },
  {
    "text": "them to be",
    "start": "643600",
    "end": "644240"
  },
  {
    "text": "that they have proper expirations and",
    "start": "644240",
    "end": "645680"
  },
  {
    "text": "they're using the right semantics for",
    "start": "645680",
    "end": "647279"
  },
  {
    "text": "cookies such as",
    "start": "647279",
    "end": "648079"
  },
  {
    "text": "secure only and http to do so we also",
    "start": "648079",
    "end": "652079"
  },
  {
    "text": "wrote an album extension to solve this",
    "start": "652079",
    "end": "653600"
  },
  {
    "text": "problem as well",
    "start": "653600",
    "end": "656160"
  },
  {
    "start": "656000",
    "end": "656000"
  },
  {
    "text": "and so we started to accumulate all",
    "start": "656240",
    "end": "657600"
  },
  {
    "text": "these external use cases and start to",
    "start": "657600",
    "end": "659680"
  },
  {
    "text": "really become a platform that people",
    "start": "659680",
    "end": "661200"
  },
  {
    "text": "wanted to use",
    "start": "661200",
    "end": "662959"
  },
  {
    "text": "we often did not have to ask people to",
    "start": "662959",
    "end": "664880"
  },
  {
    "text": "use envoy it was more often that people",
    "start": "664880",
    "end": "666320"
  },
  {
    "text": "came to us asking",
    "start": "666320",
    "end": "667360"
  },
  {
    "text": "can you put onboard in front of our",
    "start": "667360",
    "end": "668640"
  },
  {
    "text": "service and i would like to",
    "start": "668640",
    "end": "671519"
  },
  {
    "text": "reflect on how did we get here how did",
    "start": "671519",
    "end": "673600"
  },
  {
    "text": "we build this mesh",
    "start": "673600",
    "end": "674640"
  },
  {
    "text": "almost seemingly accidentally we started",
    "start": "674640",
    "end": "676720"
  },
  {
    "text": "off with an ingress load balancer",
    "start": "676720",
    "end": "678240"
  },
  {
    "text": "and ended up with envoy being deployed",
    "start": "678240",
    "end": "679920"
  },
  {
    "text": "everywhere and having",
    "start": "679920",
    "end": "681440"
  },
  {
    "text": "many new use cases that we had never",
    "start": "681440",
    "end": "683040"
  },
  {
    "text": "foreseen before",
    "start": "683040",
    "end": "684480"
  },
  {
    "text": "and i like to believe that we got here",
    "start": "684480",
    "end": "685760"
  },
  {
    "text": "by solving business problems first",
    "start": "685760",
    "end": "687680"
  },
  {
    "text": "we never really had a meeting saying",
    "start": "687680",
    "end": "690399"
  },
  {
    "text": "let's build a service mesh it was always",
    "start": "690399",
    "end": "692240"
  },
  {
    "text": "about",
    "start": "692240",
    "end": "692640"
  },
  {
    "text": "what business problem is it that we need",
    "start": "692640",
    "end": "694160"
  },
  {
    "text": "to solve in the first business problem",
    "start": "694160",
    "end": "696320"
  },
  {
    "text": "we needed a more reliable",
    "start": "696320",
    "end": "697600"
  },
  {
    "text": "and uh better observability in our",
    "start": "697600",
    "end": "700640"
  },
  {
    "text": "english load balancer",
    "start": "700640",
    "end": "701760"
  },
  {
    "text": "and so we deployed envoy then we needed",
    "start": "701760",
    "end": "704000"
  },
  {
    "text": "tls termination so we",
    "start": "704000",
    "end": "705760"
  },
  {
    "text": "took envoy as is and deployed it",
    "start": "705760",
    "end": "707040"
  },
  {
    "text": "elsewhere and then",
    "start": "707040",
    "end": "708880"
  },
  {
    "text": "very custom use cases came in like",
    "start": "708880",
    "end": "710480"
  },
  {
    "text": "cookie monitoring and sli monitoring for",
    "start": "710480",
    "end": "712320"
  },
  {
    "text": "which we could write",
    "start": "712320",
    "end": "713440"
  },
  {
    "text": "extensions using this powerful c plus",
    "start": "713440",
    "end": "715200"
  },
  {
    "text": "api that we love",
    "start": "715200",
    "end": "717040"
  },
  {
    "text": "and in that process we began delivering",
    "start": "717040",
    "end": "719760"
  },
  {
    "text": "incremental progress and showing",
    "start": "719760",
    "end": "721040"
  },
  {
    "text": "business value at each step",
    "start": "721040",
    "end": "722720"
  },
  {
    "text": "there was no mass time where people were",
    "start": "722720",
    "end": "726079"
  },
  {
    "text": "waiting for a new mesh it was kind of",
    "start": "726079",
    "end": "727600"
  },
  {
    "text": "incrementally growing and accumulating",
    "start": "727600",
    "end": "729760"
  },
  {
    "text": "new use cases that were very specific to",
    "start": "729760",
    "end": "731680"
  },
  {
    "text": "the problems that pinterest needed to",
    "start": "731680",
    "end": "732880"
  },
  {
    "text": "solve",
    "start": "732880",
    "end": "734560"
  },
  {
    "text": "in this process we also unified the",
    "start": "734560",
    "end": "735839"
  },
  {
    "text": "traffic and service framework teams we",
    "start": "735839",
    "end": "737600"
  },
  {
    "text": "found that they were solving very",
    "start": "737600",
    "end": "738880"
  },
  {
    "text": "similar problems",
    "start": "738880",
    "end": "740240"
  },
  {
    "text": "in regards to proxying and service",
    "start": "740240",
    "end": "742480"
  },
  {
    "text": "management and so we decided to unify",
    "start": "742480",
    "end": "744079"
  },
  {
    "text": "those efforts",
    "start": "744079",
    "end": "744720"
  },
  {
    "text": "in following the idea that every envoy",
    "start": "744720",
    "end": "748480"
  },
  {
    "text": "proxy is just a node in the mesh the",
    "start": "748480",
    "end": "750800"
  },
  {
    "text": "ingress load balancers",
    "start": "750800",
    "end": "752560"
  },
  {
    "text": "from the mesh perspective aren't really",
    "start": "752560",
    "end": "754000"
  },
  {
    "text": "that special they're just more awful",
    "start": "754000",
    "end": "755360"
  },
  {
    "text": "proxies getting configuration",
    "start": "755360",
    "end": "758000"
  },
  {
    "text": "also got here by having a build system",
    "start": "758000",
    "end": "759519"
  },
  {
    "text": "that allows us to write these powerful",
    "start": "759519",
    "end": "760720"
  },
  {
    "text": "envelope extensions and customize the",
    "start": "760720",
    "end": "762160"
  },
  {
    "text": "behavior at the data plane",
    "start": "762160",
    "end": "763760"
  },
  {
    "text": "while you do want to orchestrate as much",
    "start": "763760",
    "end": "765279"
  },
  {
    "text": "of the control plane layer",
    "start": "765279",
    "end": "766959"
  },
  {
    "text": "it's very powerful to have the ability",
    "start": "766959",
    "end": "768399"
  },
  {
    "text": "to manipulate the data plane behavior",
    "start": "768399",
    "end": "770399"
  },
  {
    "text": "http cookie monitoring is not something",
    "start": "770399",
    "end": "772480"
  },
  {
    "text": "you can really implement as a control",
    "start": "772480",
    "end": "773839"
  },
  {
    "text": "plane feature",
    "start": "773839",
    "end": "774720"
  },
  {
    "text": "that's really something that has to be",
    "start": "774720",
    "end": "775760"
  },
  {
    "text": "done at the data plane when it's running",
    "start": "775760",
    "end": "777680"
  },
  {
    "text": "the traffic through it",
    "start": "777680",
    "end": "779360"
  },
  {
    "text": "and lastly but most importantly we got",
    "start": "779360",
    "end": "782000"
  },
  {
    "text": "buy-in",
    "start": "782000",
    "end": "782560"
  },
  {
    "text": "from teams outside of the traffic team",
    "start": "782560",
    "end": "784399"
  },
  {
    "text": "it wasn't the traffic team pushing for",
    "start": "784399",
    "end": "785920"
  },
  {
    "text": "people to adopt our infrastructure",
    "start": "785920",
    "end": "787519"
  },
  {
    "text": "it was a lot of people asking to use",
    "start": "787519",
    "end": "789440"
  },
  {
    "text": "traffic infrastructure and that's a",
    "start": "789440",
    "end": "790560"
  },
  {
    "text": "fantastic position to be in",
    "start": "790560",
    "end": "792079"
  },
  {
    "text": "as an infrastructure team and throughout",
    "start": "792079",
    "end": "793760"
  },
  {
    "text": "all this we of course will grow",
    "start": "793760",
    "end": "795279"
  },
  {
    "text": "and incrementally evolve the mesh to",
    "start": "795279",
    "end": "797279"
  },
  {
    "text": "handle more complex",
    "start": "797279",
    "end": "798560"
  },
  {
    "text": "use cases and our control plane is",
    "start": "798560",
    "end": "800639"
  },
  {
    "text": "increasingly becoming more robust and",
    "start": "800639",
    "end": "802880"
  },
  {
    "text": "centralized",
    "start": "802880",
    "end": "803680"
  },
  {
    "text": "and we now stream our configurations",
    "start": "803680",
    "end": "806160"
  },
  {
    "text": "over grpc instead of flat files deployed",
    "start": "806160",
    "end": "808000"
  },
  {
    "text": "to hosts",
    "start": "808000",
    "end": "809279"
  },
  {
    "text": "but we always push this complexity until",
    "start": "809279",
    "end": "811120"
  },
  {
    "text": "we actually need to do it",
    "start": "811120",
    "end": "812639"
  },
  {
    "text": "and folks instead on solving business",
    "start": "812639",
    "end": "814399"
  },
  {
    "text": "problems first",
    "start": "814399",
    "end": "816399"
  },
  {
    "text": "thank you for joining me and that's the",
    "start": "816399",
    "end": "817519"
  },
  {
    "text": "story of how we built a service mesh at",
    "start": "817519",
    "end": "819880"
  },
  {
    "text": "pinterest",
    "start": "819880",
    "end": "822880"
  }
]