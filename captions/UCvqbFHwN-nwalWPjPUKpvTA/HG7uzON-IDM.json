[
  {
    "start": "0",
    "end": "135000"
  },
  {
    "text": "hello everyone my name is bjorn i work",
    "start": "160",
    "end": "2879"
  },
  {
    "text": "for a company called grafana labs",
    "start": "2879",
    "end": "5839"
  },
  {
    "text": "and i've done one or two things for the",
    "start": "5839",
    "end": "8480"
  },
  {
    "text": "prometheus project",
    "start": "8480",
    "end": "10880"
  },
  {
    "text": "my favorite topic in the prometheus",
    "start": "10880",
    "end": "13360"
  },
  {
    "text": "world",
    "start": "13360",
    "end": "14000"
  },
  {
    "text": "is histograms or at least one of my",
    "start": "14000",
    "end": "17039"
  },
  {
    "text": "favorite topics",
    "start": "17039",
    "end": "18240"
  },
  {
    "text": "and it's actually such a favorite topic",
    "start": "18240",
    "end": "20640"
  },
  {
    "text": "that i have given",
    "start": "20640",
    "end": "21680"
  },
  {
    "text": "more talks about it than than just this",
    "start": "21680",
    "end": "24560"
  },
  {
    "text": "one and",
    "start": "24560",
    "end": "25599"
  },
  {
    "text": "i decided to arrange them in a trilogy",
    "start": "25599",
    "end": "30000"
  },
  {
    "text": "and like we know it from popular movie",
    "start": "30000",
    "end": "32960"
  },
  {
    "text": "franchises",
    "start": "32960",
    "end": "33920"
  },
  {
    "text": "those trilogies don't necessarily appear",
    "start": "33920",
    "end": "36320"
  },
  {
    "text": "in the right order",
    "start": "36320",
    "end": "38000"
  },
  {
    "text": "so the the logically first",
    "start": "38000",
    "end": "41600"
  },
  {
    "text": "uh talk that you should watch first is",
    "start": "41600",
    "end": "44239"
  },
  {
    "text": "this one",
    "start": "44239",
    "end": "45520"
  },
  {
    "text": "which i gave earlier this year at",
    "start": "45520",
    "end": "47920"
  },
  {
    "text": "frostem in brussels",
    "start": "47920",
    "end": "50239"
  },
  {
    "text": "and that's about all the ancient history",
    "start": "50239",
    "end": "52800"
  },
  {
    "text": "of",
    "start": "52800",
    "end": "53360"
  },
  {
    "text": "prometheus histograms very important to",
    "start": "53360",
    "end": "56160"
  },
  {
    "text": "know and to understand",
    "start": "56160",
    "end": "58399"
  },
  {
    "text": "were why we why were sorry",
    "start": "58399",
    "end": "62239"
  },
  {
    "text": "why we are where we are now uh the",
    "start": "62239",
    "end": "65439"
  },
  {
    "text": "second part of the trilogy happened",
    "start": "65439",
    "end": "67439"
  },
  {
    "text": "first was screened first last year in",
    "start": "67439",
    "end": "70640"
  },
  {
    "text": "munich at promcon",
    "start": "70640",
    "end": "72240"
  },
  {
    "text": "and this is kind of the centerpiece it",
    "start": "72240",
    "end": "74000"
  },
  {
    "text": "was supposed to be kind of a trilogy of",
    "start": "74000",
    "end": "76320"
  },
  {
    "text": "its own with past present and future but",
    "start": "76320",
    "end": "78720"
  },
  {
    "text": "of course there wasn't enough time so i",
    "start": "78720",
    "end": "81439"
  },
  {
    "text": "decided to cut",
    "start": "81439",
    "end": "82720"
  },
  {
    "text": "out the past which gave me a reason to",
    "start": "82720",
    "end": "84400"
  },
  {
    "text": "give this first part",
    "start": "84400",
    "end": "86080"
  },
  {
    "text": "later so this is a very important talk",
    "start": "86080",
    "end": "88960"
  },
  {
    "text": "you should totally watch it if you",
    "start": "88960",
    "end": "90479"
  },
  {
    "text": "haven't",
    "start": "90479",
    "end": "91040"
  },
  {
    "text": "um this is about what prometheus",
    "start": "91040",
    "end": "93439"
  },
  {
    "text": "histograms can do",
    "start": "93439",
    "end": "95520"
  },
  {
    "text": "well right now and what doesn't work",
    "start": "95520",
    "end": "98640"
  },
  {
    "text": "that well",
    "start": "98640",
    "end": "99360"
  },
  {
    "text": "and what are options to address that in",
    "start": "99360",
    "end": "102079"
  },
  {
    "text": "the future",
    "start": "102079",
    "end": "103360"
  },
  {
    "text": "now this third part of the trilogy which",
    "start": "103360",
    "end": "105439"
  },
  {
    "text": "is now this",
    "start": "105439",
    "end": "106560"
  },
  {
    "text": "is about actual things i tried out",
    "start": "106560",
    "end": "110560"
  },
  {
    "text": "and i followed a certain idea and now i",
    "start": "110560",
    "end": "113680"
  },
  {
    "text": "want to tell you about",
    "start": "113680",
    "end": "115360"
  },
  {
    "text": "the results this is all planned to be",
    "start": "115360",
    "end": "119280"
  },
  {
    "text": "in a big and fat design dog or rfc",
    "start": "119280",
    "end": "122960"
  },
  {
    "text": "that i'll send out very soon and then",
    "start": "122960",
    "end": "126640"
  },
  {
    "text": "the community can discuss and we can see",
    "start": "126640",
    "end": "129360"
  },
  {
    "text": "what",
    "start": "129360",
    "end": "130160"
  },
  {
    "text": "of my ideas we can actually implement in",
    "start": "130160",
    "end": "132800"
  },
  {
    "text": "prometheus and have better histograms",
    "start": "132800",
    "end": "135680"
  },
  {
    "start": "135000",
    "end": "202000"
  },
  {
    "text": "all right one thing has already been",
    "start": "135680",
    "end": "138080"
  },
  {
    "text": "improved and i wanted to mention that",
    "start": "138080",
    "end": "139520"
  },
  {
    "text": "first because that was raised in the",
    "start": "139520",
    "end": "141360"
  },
  {
    "text": "second part of the trilogy as a problem",
    "start": "141360",
    "end": "143599"
  },
  {
    "text": "that's isolation prometheus is kind of",
    "start": "143599",
    "end": "146879"
  },
  {
    "text": "almost acid the tsdb part of prometheus",
    "start": "146879",
    "end": "150400"
  },
  {
    "text": "but i was",
    "start": "150400",
    "end": "151120"
  },
  {
    "text": "lacking this isolation aspect and",
    "start": "151120",
    "end": "153360"
  },
  {
    "text": "histograms were",
    "start": "153360",
    "end": "154480"
  },
  {
    "text": "a favorite victim of that in",
    "start": "154480",
    "end": "157840"
  },
  {
    "text": "prometheus 2.17.0 we finally got this",
    "start": "157840",
    "end": "161920"
  },
  {
    "text": "implemented",
    "start": "161920",
    "end": "164000"
  },
  {
    "text": "just one tiny line in the changelog but",
    "start": "164000",
    "end": "168160"
  },
  {
    "text": "huge step support isolation um",
    "start": "168160",
    "end": "171599"
  },
  {
    "text": "there is a lot of detail to share about",
    "start": "171599",
    "end": "174319"
  },
  {
    "text": "this",
    "start": "174319",
    "end": "174800"
  },
  {
    "text": "which i don't have time for here so i",
    "start": "174800",
    "end": "177840"
  },
  {
    "text": "have to refer you to this",
    "start": "177840",
    "end": "179200"
  },
  {
    "text": "awesome blog post um by written by",
    "start": "179200",
    "end": "182159"
  },
  {
    "text": "myself",
    "start": "182159",
    "end": "182879"
  },
  {
    "text": "shameless blog on the tech blog of my",
    "start": "182879",
    "end": "186080"
  },
  {
    "text": "employer another shameless blog but",
    "start": "186080",
    "end": "188319"
  },
  {
    "text": "here's the ul",
    "start": "188319",
    "end": "189360"
  },
  {
    "text": "just look it up and you see history in",
    "start": "189360",
    "end": "191680"
  },
  {
    "text": "quantile that's the",
    "start": "191680",
    "end": "192959"
  },
  {
    "text": "infamous function that gets hit quite",
    "start": "192959",
    "end": "195840"
  },
  {
    "text": "often by the lack of isolation",
    "start": "195840",
    "end": "198080"
  },
  {
    "text": "we have isolation now it's all good you",
    "start": "198080",
    "end": "199840"
  },
  {
    "text": "don't even have to think about it it'll",
    "start": "199840",
    "end": "201280"
  },
  {
    "text": "just magically work",
    "start": "201280",
    "end": "203040"
  },
  {
    "start": "202000",
    "end": "270000"
  },
  {
    "text": "so let's come to the remaining problem",
    "start": "203040",
    "end": "205840"
  },
  {
    "text": "of histograms or",
    "start": "205840",
    "end": "206959"
  },
  {
    "text": "let's first recap what are actually the",
    "start": "206959",
    "end": "209840"
  },
  {
    "text": "things that work well",
    "start": "209840",
    "end": "211200"
  },
  {
    "text": "this is a slight kind of flashback",
    "start": "211200",
    "end": "216159"
  },
  {
    "text": "to the slide of the second torque",
    "start": "216159",
    "end": "219519"
  },
  {
    "text": "to one of the slides in the second door",
    "start": "219519",
    "end": "222000"
  },
  {
    "text": "these are things that work well",
    "start": "222000",
    "end": "223519"
  },
  {
    "text": "updates score calculation high frequency",
    "start": "223519",
    "end": "225840"
  },
  {
    "text": "sampling is mathematically correct",
    "start": "225840",
    "end": "228400"
  },
  {
    "text": "uh which is actually you can't take for",
    "start": "228400",
    "end": "230080"
  },
  {
    "text": "granted unfortunately",
    "start": "230080",
    "end": "232080"
  },
  {
    "text": "uh and questions like those percentage",
    "start": "232080",
    "end": "234480"
  },
  {
    "text": "questions what percentage of",
    "start": "234480",
    "end": "236080"
  },
  {
    "text": "requests in the last hour got a response",
    "start": "236080",
    "end": "238879"
  },
  {
    "text": "in 100 milliseconds",
    "start": "238879",
    "end": "240239"
  },
  {
    "text": "or less these work really well",
    "start": "240239",
    "end": "243519"
  },
  {
    "text": "but unfortunately they only work well",
    "start": "243519",
    "end": "245840"
  },
  {
    "text": "under circumstances this is why",
    "start": "245840",
    "end": "248080"
  },
  {
    "text": "all those or most of these things get a",
    "start": "248080",
    "end": "250000"
  },
  {
    "text": "little asterisk",
    "start": "250000",
    "end": "252000"
  },
  {
    "text": "and as you know this is usually where",
    "start": "252000",
    "end": "253920"
  },
  {
    "text": "you read down here terms and conditions",
    "start": "253920",
    "end": "255840"
  },
  {
    "text": "apply and then you know",
    "start": "255840",
    "end": "257199"
  },
  {
    "text": "the deal is actually not as good as it",
    "start": "257199",
    "end": "259759"
  },
  {
    "text": "sounded",
    "start": "259759",
    "end": "260880"
  },
  {
    "text": "first and uh with prometheus histogram",
    "start": "260880",
    "end": "263520"
  },
  {
    "text": "you get this",
    "start": "263520",
    "end": "264320"
  },
  {
    "text": "if suitable pockets defined which is",
    "start": "264320",
    "end": "267280"
  },
  {
    "text": "actually hard to define",
    "start": "267280",
    "end": "269120"
  },
  {
    "text": "suitable buckets um there's this other",
    "start": "269120",
    "end": "272639"
  },
  {
    "start": "270000",
    "end": "434000"
  },
  {
    "text": "thing",
    "start": "272639",
    "end": "273120"
  },
  {
    "text": "histogram quantile which is what his",
    "start": "273120",
    "end": "275360"
  },
  {
    "text": "rooms were actually",
    "start": "275360",
    "end": "276560"
  },
  {
    "text": "added for to prometheus to calculate",
    "start": "276560",
    "end": "279360"
  },
  {
    "text": "quantiles like a median or 99th",
    "start": "279360",
    "end": "281280"
  },
  {
    "text": "percentile",
    "start": "281280",
    "end": "282240"
  },
  {
    "text": "in a correct way across distributed",
    "start": "282240",
    "end": "284160"
  },
  {
    "text": "systems",
    "start": "284160",
    "end": "285280"
  },
  {
    "text": "and this is it all works fine it just",
    "start": "285280",
    "end": "287759"
  },
  {
    "text": "has a few issues",
    "start": "287759",
    "end": "289120"
  },
  {
    "text": "again this is just recapping from the",
    "start": "289120",
    "end": "290960"
  },
  {
    "text": "second talk the accuracy depends on the",
    "start": "290960",
    "end": "293520"
  },
  {
    "text": "bucket layout",
    "start": "293520",
    "end": "294400"
  },
  {
    "text": "and now we come again to bucket layout",
    "start": "294400",
    "end": "296639"
  },
  {
    "text": "pockets are just super expensive",
    "start": "296639",
    "end": "298560"
  },
  {
    "text": "with the current prometheus histogram so",
    "start": "298560",
    "end": "300400"
  },
  {
    "text": "you only can have a few of them",
    "start": "300400",
    "end": "302639"
  },
  {
    "text": "and then you have to pick them really",
    "start": "302639",
    "end": "304240"
  },
  {
    "text": "wisely so you need",
    "start": "304240",
    "end": "306800"
  },
  {
    "text": "your interesting results you get here",
    "start": "306800",
    "end": "309520"
  },
  {
    "text": "they should be",
    "start": "309520",
    "end": "310479"
  },
  {
    "text": "close to a bucket boundary so in some",
    "start": "310479",
    "end": "312720"
  },
  {
    "text": "areas",
    "start": "312720",
    "end": "313759"
  },
  {
    "text": "of the observation range you can have",
    "start": "313759",
    "end": "315600"
  },
  {
    "text": "higher resolution buckets but not",
    "start": "315600",
    "end": "317199"
  },
  {
    "text": "everywhere",
    "start": "317199",
    "end": "318160"
  },
  {
    "text": "or you can't really have higher",
    "start": "318160",
    "end": "319360"
  },
  {
    "text": "resolution at all yeah but then on the",
    "start": "319360",
    "end": "322240"
  },
  {
    "text": "other hand the bucketing scheme",
    "start": "322240",
    "end": "324080"
  },
  {
    "text": "must be compatible across the aggregate",
    "start": "324080",
    "end": "326400"
  },
  {
    "text": "metrics and across the range of rate",
    "start": "326400",
    "end": "328320"
  },
  {
    "text": "calculations",
    "start": "328320",
    "end": "329840"
  },
  {
    "text": "which means you should actually not",
    "start": "329840",
    "end": "331600"
  },
  {
    "text": "change the bucket layout but",
    "start": "331600",
    "end": "333120"
  },
  {
    "text": "since it's so hard to find the right one",
    "start": "333120",
    "end": "335280"
  },
  {
    "text": "you are actually",
    "start": "335280",
    "end": "336400"
  },
  {
    "text": "tempted to change that quite often so",
    "start": "336400",
    "end": "338639"
  },
  {
    "text": "it's a kind of dilemma and it's really",
    "start": "338639",
    "end": "340639"
  },
  {
    "text": "annoying",
    "start": "340639",
    "end": "341919"
  },
  {
    "text": "back then in talk 2 there was lack of",
    "start": "341919",
    "end": "344560"
  },
  {
    "text": "ingestion isolation",
    "start": "344560",
    "end": "345919"
  },
  {
    "text": "as a problem stated on the slide i",
    "start": "345919",
    "end": "348160"
  },
  {
    "text": "scratched this because",
    "start": "348160",
    "end": "349520"
  },
  {
    "text": "as i told you isolation no just works",
    "start": "349520",
    "end": "353919"
  },
  {
    "text": "okay but we still have plenty of",
    "start": "353919",
    "end": "355520"
  },
  {
    "text": "remaining problems",
    "start": "355520",
    "end": "357199"
  },
  {
    "text": "this illustrates the cost problem again",
    "start": "357199",
    "end": "361440"
  },
  {
    "text": "with a different consequence so here we",
    "start": "361440",
    "end": "366479"
  },
  {
    "text": "have a histogram as you can configure it",
    "start": "366479",
    "end": "369039"
  },
  {
    "text": "in go code if you instrument go code",
    "start": "369039",
    "end": "371360"
  },
  {
    "text": "with a prometheus histogram",
    "start": "371360",
    "end": "372880"
  },
  {
    "text": "so this has kind of 10-ish pockets it's",
    "start": "372880",
    "end": "376080"
  },
  {
    "text": "a duration",
    "start": "376080",
    "end": "376960"
  },
  {
    "text": "histogram for essentially http latencies",
    "start": "376960",
    "end": "381520"
  },
  {
    "text": "and then there is also a counter",
    "start": "381520",
    "end": "384639"
  },
  {
    "text": "which you shouldn't need because you're",
    "start": "384639",
    "end": "387199"
  },
  {
    "text": "already",
    "start": "387199",
    "end": "387919"
  },
  {
    "text": "implicitly counting requests in this",
    "start": "387919",
    "end": "390080"
  },
  {
    "text": "histogram",
    "start": "390080",
    "end": "391039"
  },
  {
    "text": "but often you just have a counter and",
    "start": "391039",
    "end": "393039"
  },
  {
    "text": "you do this because",
    "start": "393039",
    "end": "394160"
  },
  {
    "text": "this counter is partitioned by status",
    "start": "394160",
    "end": "397039"
  },
  {
    "text": "code or path or method or whatever you",
    "start": "397039",
    "end": "399199"
  },
  {
    "text": "want",
    "start": "399199",
    "end": "399600"
  },
  {
    "text": "it to be partitioned by you don't do",
    "start": "399600",
    "end": "402560"
  },
  {
    "text": "this with the histogram because the",
    "start": "402560",
    "end": "404080"
  },
  {
    "text": "histogram is essentially",
    "start": "404080",
    "end": "405680"
  },
  {
    "text": "as expensive as a counter per bucket so",
    "start": "405680",
    "end": "408240"
  },
  {
    "text": "that's an order of magnitude more",
    "start": "408240",
    "end": "409599"
  },
  {
    "text": "expensive than the counter up here",
    "start": "409599",
    "end": "411759"
  },
  {
    "text": "so you're really yeah you really don't",
    "start": "411759",
    "end": "415039"
  },
  {
    "text": "want to partition this by too many",
    "start": "415039",
    "end": "416720"
  },
  {
    "text": "dimensions",
    "start": "416720",
    "end": "417520"
  },
  {
    "text": "so that's a very common topic a counter",
    "start": "417520",
    "end": "419599"
  },
  {
    "text": "that is partition at will",
    "start": "419599",
    "end": "421680"
  },
  {
    "text": "and a histogram that's not partitioned",
    "start": "421680",
    "end": "423360"
  },
  {
    "text": "at all which is annoying because",
    "start": "423360",
    "end": "425440"
  },
  {
    "text": "sometimes you actually want that",
    "start": "425440",
    "end": "426720"
  },
  {
    "text": "partitioning and you definitely don't",
    "start": "426720",
    "end": "428479"
  },
  {
    "text": "want to think about this",
    "start": "428479",
    "end": "430240"
  },
  {
    "text": "in the beginning you want to ask those",
    "start": "430240",
    "end": "432160"
  },
  {
    "text": "questions later when you look at your",
    "start": "432160",
    "end": "433680"
  },
  {
    "text": "metrics",
    "start": "433680",
    "end": "434960"
  },
  {
    "start": "434000",
    "end": "490000"
  },
  {
    "text": "so let's formulate a wish list for the",
    "start": "434960",
    "end": "437120"
  },
  {
    "text": "rest of this talk what we want to",
    "start": "437120",
    "end": "438639"
  },
  {
    "text": "accomplish",
    "start": "438639",
    "end": "439919"
  },
  {
    "text": "first of all we are like spoiled kids",
    "start": "439919",
    "end": "442319"
  },
  {
    "text": "here we want everything that works well",
    "start": "442319",
    "end": "445199"
  },
  {
    "text": "to continue to work well of course right",
    "start": "445199",
    "end": "449120"
  },
  {
    "text": "second we never want to configure",
    "start": "449120",
    "end": "450800"
  },
  {
    "text": "buckets again because that's just",
    "start": "450800",
    "end": "452319"
  },
  {
    "text": "annoying",
    "start": "452319",
    "end": "453280"
  },
  {
    "text": "but third all histograms should always",
    "start": "453280",
    "end": "456000"
  },
  {
    "text": "be aggregateable with each other across",
    "start": "456000",
    "end": "458000"
  },
  {
    "text": "time and space",
    "start": "458000",
    "end": "459199"
  },
  {
    "text": "i never want to have this problem again",
    "start": "459199",
    "end": "461280"
  },
  {
    "text": "and of course i want accurate quantile",
    "start": "461280",
    "end": "463680"
  },
  {
    "text": "and percentage estimations across the",
    "start": "463680",
    "end": "466240"
  },
  {
    "text": "whole range of observations",
    "start": "466240",
    "end": "467840"
  },
  {
    "text": "i don't want to have this area where oh",
    "start": "467840",
    "end": "469520"
  },
  {
    "text": "no sorry you didn't put pockets there",
    "start": "469520",
    "end": "471680"
  },
  {
    "text": "so you can't you can't have good good",
    "start": "471680",
    "end": "473520"
  },
  {
    "text": "obser good values here",
    "start": "473520",
    "end": "476080"
  },
  {
    "text": "but of course fifth i want all of that",
    "start": "476080",
    "end": "478560"
  },
  {
    "text": "at a",
    "start": "478560",
    "end": "479280"
  },
  {
    "text": "lower cost than current histograms so",
    "start": "479280",
    "end": "481440"
  },
  {
    "text": "that i can finally partition histograms",
    "start": "481440",
    "end": "483120"
  },
  {
    "text": "at will",
    "start": "483120",
    "end": "484000"
  },
  {
    "text": "so as that greedy small kid we want",
    "start": "484000",
    "end": "486800"
  },
  {
    "text": "everything",
    "start": "486800",
    "end": "487360"
  },
  {
    "text": "let's see how far we can get here",
    "start": "487360",
    "end": "490840"
  },
  {
    "start": "490000",
    "end": "560000"
  },
  {
    "text": "um in the second talk i have already",
    "start": "490840",
    "end": "495520"
  },
  {
    "text": "hinted at the solution that is most",
    "start": "495520",
    "end": "498160"
  },
  {
    "text": "likely the solution you go for",
    "start": "498160",
    "end": "500160"
  },
  {
    "text": "which is essentially a very old approach",
    "start": "500160",
    "end": "504000"
  },
  {
    "text": "it's just have a conventional histogram",
    "start": "504000",
    "end": "506400"
  },
  {
    "text": "it just has",
    "start": "506400",
    "end": "508240"
  },
  {
    "text": "infinite amount of buckets in a regular",
    "start": "508240",
    "end": "510960"
  },
  {
    "text": "usually exponential or logarithmic",
    "start": "510960",
    "end": "513760"
  },
  {
    "text": "marketing schemer but of course the",
    "start": "513760",
    "end": "516080"
  },
  {
    "text": "question is how can you deal with an",
    "start": "516080",
    "end": "518000"
  },
  {
    "text": "infinite amount of buckets and the basic",
    "start": "518000",
    "end": "520320"
  },
  {
    "text": "idea here is",
    "start": "520320",
    "end": "521360"
  },
  {
    "text": "that you just account for buckets that",
    "start": "521360",
    "end": "524480"
  },
  {
    "text": "actually contain",
    "start": "524480",
    "end": "525760"
  },
  {
    "text": "at least one observation and all the",
    "start": "525760",
    "end": "527920"
  },
  {
    "text": "empty buckets are ignored",
    "start": "527920",
    "end": "529920"
  },
  {
    "text": "there are different approaches there are",
    "start": "529920",
    "end": "531600"
  },
  {
    "text": "certainly many more than this this is",
    "start": "531600",
    "end": "533360"
  },
  {
    "text": "probably the",
    "start": "533360",
    "end": "534240"
  },
  {
    "text": "top three most well known but perhaps",
    "start": "534240",
    "end": "537360"
  },
  {
    "text": "not",
    "start": "537360",
    "end": "538160"
  },
  {
    "text": "hdr histogram you have heard about it so",
    "start": "538160",
    "end": "540720"
  },
  {
    "text": "konos has an implementation",
    "start": "540720",
    "end": "542560"
  },
  {
    "text": "which they have on the client part",
    "start": "542560",
    "end": "544560"
  },
  {
    "text": "there's open source",
    "start": "544560",
    "end": "546000"
  },
  {
    "text": "code and they have a written a paper",
    "start": "546000",
    "end": "547920"
  },
  {
    "text": "quite recently about it",
    "start": "547920",
    "end": "549360"
  },
  {
    "text": "but the approach is fairly old and",
    "start": "549360",
    "end": "551519"
  },
  {
    "text": "datadog is probably also doing this for",
    "start": "551519",
    "end": "553279"
  },
  {
    "text": "a while but they have recently",
    "start": "553279",
    "end": "555200"
  },
  {
    "text": "also published a paper where they",
    "start": "555200",
    "end": "556959"
  },
  {
    "text": "explain their histograms",
    "start": "556959",
    "end": "558959"
  },
  {
    "text": "um i should show you the whole link here",
    "start": "558959",
    "end": "562080"
  },
  {
    "start": "560000",
    "end": "725000"
  },
  {
    "text": "not covered with my face yeah so here",
    "start": "562080",
    "end": "565200"
  },
  {
    "text": "you can see all of that",
    "start": "565200",
    "end": "566959"
  },
  {
    "text": "the question is if this is all so well",
    "start": "566959",
    "end": "569920"
  },
  {
    "text": "established and old",
    "start": "569920",
    "end": "571360"
  },
  {
    "text": "why haven't we done this in prometheus",
    "start": "571360",
    "end": "573200"
  },
  {
    "text": "in the first place",
    "start": "573200",
    "end": "574560"
  },
  {
    "text": "and um yeah there are a few problems",
    "start": "574560",
    "end": "576560"
  },
  {
    "text": "because prometheus is a bit different",
    "start": "576560",
    "end": "578880"
  },
  {
    "text": "let's first check out how uh this",
    "start": "578880",
    "end": "581760"
  },
  {
    "text": "histogram",
    "start": "581760",
    "end": "582959"
  },
  {
    "text": "uh those sparse histogram as i call it",
    "start": "582959",
    "end": "586399"
  },
  {
    "text": "it's usually done you have this running",
    "start": "586399",
    "end": "589519"
  },
  {
    "text": "on different",
    "start": "589519",
    "end": "590000"
  },
  {
    "text": "instances this is just one instance that",
    "start": "590000",
    "end": "592480"
  },
  {
    "text": "is accumulating observations in a",
    "start": "592480",
    "end": "594240"
  },
  {
    "text": "histogram let's say for a minute",
    "start": "594240",
    "end": "596560"
  },
  {
    "text": "and of course every instance is doing",
    "start": "596560",
    "end": "598160"
  },
  {
    "text": "that and then kind of",
    "start": "598160",
    "end": "599839"
  },
  {
    "text": "at some point in time they all send",
    "start": "599839",
    "end": "602959"
  },
  {
    "text": "these histogram data to a central data",
    "start": "602959",
    "end": "605920"
  },
  {
    "text": "storage",
    "start": "605920",
    "end": "607040"
  },
  {
    "text": "where it's collected and with some magic",
    "start": "607040",
    "end": "609440"
  },
  {
    "text": "efficiency",
    "start": "609440",
    "end": "610560"
  },
  {
    "text": "we'll actually be able to save that",
    "start": "610560",
    "end": "612880"
  },
  {
    "text": "store that",
    "start": "612880",
    "end": "613600"
  },
  {
    "text": "nicely but for the monitor",
    "start": "613600",
    "end": "616800"
  },
  {
    "text": "target it's quite easy to then reset",
    "start": "616800",
    "end": "619680"
  },
  {
    "text": "everything so you have completely empty",
    "start": "619680",
    "end": "621600"
  },
  {
    "text": "slate and you start again",
    "start": "621600",
    "end": "623360"
  },
  {
    "text": "to collect observations um these",
    "start": "623360",
    "end": "625680"
  },
  {
    "text": "histograms should all look",
    "start": "625680",
    "end": "626959"
  },
  {
    "text": "slightly different i was just too lazy",
    "start": "626959",
    "end": "628800"
  },
  {
    "text": "to to modify them a bit",
    "start": "628800",
    "end": "630560"
  },
  {
    "text": "so this means every minute you kind of",
    "start": "630560",
    "end": "632560"
  },
  {
    "text": "start over you start from an empty slate",
    "start": "632560",
    "end": "634399"
  },
  {
    "text": "you have zero entropy all the pockets",
    "start": "634399",
    "end": "636240"
  },
  {
    "text": "are empty",
    "start": "636240",
    "end": "636959"
  },
  {
    "text": "and then you only have to account for",
    "start": "636959",
    "end": "638480"
  },
  {
    "text": "pockets that receive an",
    "start": "638480",
    "end": "640240"
  },
  {
    "text": "observation in that minute then you ship",
    "start": "640240",
    "end": "642079"
  },
  {
    "text": "it all over and you are done with it",
    "start": "642079",
    "end": "645279"
  },
  {
    "text": "so in prometheus that's kind of",
    "start": "645279",
    "end": "647440"
  },
  {
    "text": "unfortunately",
    "start": "647440",
    "end": "648320"
  },
  {
    "text": "very different prometheus is as you have",
    "start": "648320",
    "end": "651120"
  },
  {
    "text": "probably heard a pull-based monitoring",
    "start": "651120",
    "end": "653040"
  },
  {
    "text": "system and many people complain about",
    "start": "653040",
    "end": "654959"
  },
  {
    "text": "that",
    "start": "654959",
    "end": "655519"
  },
  {
    "text": "but there are a bunch of advantages and",
    "start": "655519",
    "end": "657440"
  },
  {
    "text": "this talk should not be about the",
    "start": "657440",
    "end": "659440"
  },
  {
    "text": "advantages",
    "start": "659440",
    "end": "660240"
  },
  {
    "text": "of a pool based data collection but",
    "start": "660240",
    "end": "663440"
  },
  {
    "text": "we are we i mean prometheus is doing",
    "start": "663440",
    "end": "666079"
  },
  {
    "text": "that right",
    "start": "666079",
    "end": "666640"
  },
  {
    "text": "this is not going to change and we have",
    "start": "666640",
    "end": "668640"
  },
  {
    "text": "to deal with it",
    "start": "668640",
    "end": "669920"
  },
  {
    "text": "and with small's histogram we have the",
    "start": "669920",
    "end": "672160"
  },
  {
    "text": "problem that for prometheus was",
    "start": "672160",
    "end": "674640"
  },
  {
    "text": "scrapes or stateless essentially you",
    "start": "674640",
    "end": "677600"
  },
  {
    "text": "cannot just",
    "start": "677600",
    "end": "678720"
  },
  {
    "text": "reset at will and then decide to send",
    "start": "678720",
    "end": "681040"
  },
  {
    "text": "the new histogram",
    "start": "681040",
    "end": "682240"
  },
  {
    "text": "you essentially have to accumulate data",
    "start": "682240",
    "end": "684880"
  },
  {
    "text": "forever",
    "start": "684880",
    "end": "686240"
  },
  {
    "text": "and it's also nothing about like",
    "start": "686240",
    "end": "687680"
  },
  {
    "text": "minutely anytime somebody could come",
    "start": "687680",
    "end": "690000"
  },
  {
    "text": "along and script which is one of the",
    "start": "690000",
    "end": "691600"
  },
  {
    "text": "advantages",
    "start": "691600",
    "end": "692560"
  },
  {
    "text": "but also difficult to deal with so in",
    "start": "692560",
    "end": "694720"
  },
  {
    "text": "prometheus",
    "start": "694720",
    "end": "695680"
  },
  {
    "text": "this is accumulating accumulating",
    "start": "695680",
    "end": "697200"
  },
  {
    "text": "accumulating as i try to",
    "start": "697200",
    "end": "700560"
  },
  {
    "text": "draw here but uh you can probably guess",
    "start": "700560",
    "end": "703519"
  },
  {
    "text": "uh what i mean here so you get you you",
    "start": "703519",
    "end": "706320"
  },
  {
    "text": "you accumulate a lot of entropy more and",
    "start": "706320",
    "end": "709120"
  },
  {
    "text": "more buckets are populated and your",
    "start": "709120",
    "end": "711040"
  },
  {
    "text": "histograms on the monitor target will",
    "start": "711040",
    "end": "713120"
  },
  {
    "text": "take",
    "start": "713120",
    "end": "713519"
  },
  {
    "text": "more and more storage space which is a",
    "start": "713519",
    "end": "716240"
  },
  {
    "text": "problem right",
    "start": "716240",
    "end": "717360"
  },
  {
    "text": "so this is kind of where we were where",
    "start": "717360",
    "end": "719200"
  },
  {
    "text": "we said this is it",
    "start": "719200",
    "end": "720560"
  },
  {
    "text": "doesn't even apply to to prometheus we",
    "start": "720560",
    "end": "723040"
  },
  {
    "text": "can't we just can't do that",
    "start": "723040",
    "end": "725360"
  },
  {
    "start": "725000",
    "end": "857000"
  },
  {
    "text": "but then also studying all the other",
    "start": "725360",
    "end": "727600"
  },
  {
    "text": "alternatives",
    "start": "727600",
    "end": "728560"
  },
  {
    "text": "as laid out in the second talk and",
    "start": "728560",
    "end": "730480"
  },
  {
    "text": "realizing they also",
    "start": "730480",
    "end": "731760"
  },
  {
    "text": "don't work i started to think perhaps",
    "start": "731760",
    "end": "735120"
  },
  {
    "text": "this works after all and there is",
    "start": "735120",
    "end": "737200"
  },
  {
    "text": "essentially a two-part",
    "start": "737200",
    "end": "739120"
  },
  {
    "text": "thinking process here the one is uh",
    "start": "739120",
    "end": "742480"
  },
  {
    "text": "about the accumulating entropy",
    "start": "742480",
    "end": "746000"
  },
  {
    "text": "so this is essentially how many buckets",
    "start": "746000",
    "end": "747680"
  },
  {
    "text": "you populate if you",
    "start": "747680",
    "end": "749279"
  },
  {
    "text": "calculate if you accumulate data for a",
    "start": "749279",
    "end": "751839"
  },
  {
    "text": "minute",
    "start": "751839",
    "end": "752480"
  },
  {
    "text": "and then your chip it would go back to",
    "start": "752480",
    "end": "753920"
  },
  {
    "text": "zero and do more or less the same again",
    "start": "753920",
    "end": "756240"
  },
  {
    "text": "right",
    "start": "756240",
    "end": "756880"
  },
  {
    "text": "but if you just do it for two minutes",
    "start": "756880",
    "end": "759040"
  },
  {
    "text": "it's not that you have twice as many",
    "start": "759040",
    "end": "760720"
  },
  {
    "text": "buckets populated because more and more",
    "start": "760720",
    "end": "762959"
  },
  {
    "text": "often you will hit a bucket",
    "start": "762959",
    "end": "764560"
  },
  {
    "text": "that already has seen an observation so",
    "start": "764560",
    "end": "767040"
  },
  {
    "text": "at some point",
    "start": "767040",
    "end": "768000"
  },
  {
    "text": "um this is the time access here",
    "start": "768000",
    "end": "771360"
  },
  {
    "text": "at some point in time you will reach",
    "start": "771360",
    "end": "775040"
  },
  {
    "text": "some saturation level or most of the",
    "start": "775040",
    "end": "777440"
  },
  {
    "text": "time you will hit the pocket that has",
    "start": "777440",
    "end": "778959"
  },
  {
    "text": "already",
    "start": "778959",
    "end": "779839"
  },
  {
    "text": "some counts in it so this is the idea",
    "start": "779839",
    "end": "783440"
  },
  {
    "text": "that this like you will the idea is that",
    "start": "783440",
    "end": "786480"
  },
  {
    "text": "you will approach this saturation",
    "start": "786480",
    "end": "788720"
  },
  {
    "text": "uh value quite quickly so that it's not",
    "start": "788720",
    "end": "791440"
  },
  {
    "text": "that much of a deal if you collect for",
    "start": "791440",
    "end": "793040"
  },
  {
    "text": "one minute two minutes three minutes an",
    "start": "793040",
    "end": "794560"
  },
  {
    "text": "hour or a day",
    "start": "794560",
    "end": "796160"
  },
  {
    "text": "that's the one idea right the other idea",
    "start": "796160",
    "end": "798959"
  },
  {
    "text": "is",
    "start": "798959",
    "end": "799440"
  },
  {
    "text": "that um in principle prometheus",
    "start": "799440",
    "end": "803120"
  },
  {
    "text": "has a concept of resetting counters it",
    "start": "803120",
    "end": "805680"
  },
  {
    "text": "just",
    "start": "805680",
    "end": "806240"
  },
  {
    "text": "doesn't have to happen too often it will",
    "start": "806240",
    "end": "809279"
  },
  {
    "text": "happen if you restart your binary right",
    "start": "809279",
    "end": "811440"
  },
  {
    "text": "so prometheus loses uh some counts",
    "start": "811440",
    "end": "814800"
  },
  {
    "text": "if that happens because as it as i said",
    "start": "814800",
    "end": "818399"
  },
  {
    "text": "it's pool based so a a monitor target",
    "start": "818399",
    "end": "820560"
  },
  {
    "text": "cannot just decide before i die i will",
    "start": "820560",
    "end": "822720"
  },
  {
    "text": "ship",
    "start": "822720",
    "end": "823040"
  },
  {
    "text": "all the metrics it will just die right",
    "start": "823040",
    "end": "825360"
  },
  {
    "text": "it will just go down",
    "start": "825360",
    "end": "827120"
  },
  {
    "text": "and um you scrape quite often like let's",
    "start": "827120",
    "end": "829760"
  },
  {
    "text": "say every 15 seconds so you might",
    "start": "829760",
    "end": "831760"
  },
  {
    "text": "lose a few seconds of code so if you now",
    "start": "831760",
    "end": "834720"
  },
  {
    "text": "reset",
    "start": "834720",
    "end": "835920"
  },
  {
    "text": "your histograms let's say every hour",
    "start": "835920",
    "end": "838560"
  },
  {
    "text": "that's",
    "start": "838560",
    "end": "838959"
  },
  {
    "text": "in relative terms not a lot of loss",
    "start": "838959",
    "end": "842240"
  },
  {
    "text": "so these are the two thoughts right",
    "start": "842240",
    "end": "844880"
  },
  {
    "text": "first",
    "start": "844880",
    "end": "846000"
  },
  {
    "text": "entropy will not accumulate into",
    "start": "846000",
    "end": "848079"
  },
  {
    "text": "infinity essentially",
    "start": "848079",
    "end": "849360"
  },
  {
    "text": "and second if it does i can still reset",
    "start": "849360",
    "end": "852959"
  },
  {
    "text": "a histogram",
    "start": "852959",
    "end": "853839"
  },
  {
    "text": "let's say after an hour or so so perhaps",
    "start": "853839",
    "end": "856079"
  },
  {
    "text": "it works",
    "start": "856079",
    "end": "856880"
  },
  {
    "text": "and we have to study that another thing",
    "start": "856880",
    "end": "859040"
  },
  {
    "start": "857000",
    "end": "904000"
  },
  {
    "text": "that prometheus is doing in its existing",
    "start": "859040",
    "end": "861040"
  },
  {
    "text": "histogram is this cumulative nature",
    "start": "861040",
    "end": "863040"
  },
  {
    "text": "which has a lot of",
    "start": "863040",
    "end": "864399"
  },
  {
    "text": "advantages um for like an",
    "start": "864399",
    "end": "868000"
  },
  {
    "text": "operational quality of life aspect",
    "start": "868000",
    "end": "871040"
  },
  {
    "text": "you can like drop buckets from it if you",
    "start": "871040",
    "end": "873760"
  },
  {
    "text": "want to reduce the isolate",
    "start": "873760",
    "end": "875279"
  },
  {
    "text": "the the or solution stuff like that",
    "start": "875279",
    "end": "878959"
  },
  {
    "text": "there are a bunch of things to say about",
    "start": "878959",
    "end": "880720"
  },
  {
    "text": "cumulative histogram but cumulative",
    "start": "880720",
    "end": "882160"
  },
  {
    "text": "histograms really don't play well with",
    "start": "882160",
    "end": "883920"
  },
  {
    "text": "the",
    "start": "883920",
    "end": "884800"
  },
  {
    "text": "sparse nature of sparse histograms so",
    "start": "884800",
    "end": "887760"
  },
  {
    "text": "this is really something we need to",
    "start": "887760",
    "end": "889920"
  },
  {
    "text": "change for",
    "start": "889920",
    "end": "890800"
  },
  {
    "text": "sparse high resolution histograms we",
    "start": "890800",
    "end": "893040"
  },
  {
    "text": "just have to go to",
    "start": "893040",
    "end": "894160"
  },
  {
    "text": "ordinary histograms but that's that's",
    "start": "894160",
    "end": "897360"
  },
  {
    "text": "probably something",
    "start": "897360",
    "end": "898160"
  },
  {
    "text": "something we can do it's not as",
    "start": "898160",
    "end": "899519"
  },
  {
    "text": "fundamental to prometheus as this",
    "start": "899519",
    "end": "901360"
  },
  {
    "text": "pull-based approach",
    "start": "901360",
    "end": "903519"
  },
  {
    "text": "all right so this is how sparse",
    "start": "903519",
    "end": "905600"
  },
  {
    "start": "904000",
    "end": "993000"
  },
  {
    "text": "histogram looks like",
    "start": "905600",
    "end": "907199"
  },
  {
    "text": "very much simplified you can represent",
    "start": "907199",
    "end": "909920"
  },
  {
    "text": "them in different ways this is the one i",
    "start": "909920",
    "end": "912079"
  },
  {
    "text": "chose for experiment the",
    "start": "912079",
    "end": "915519"
  },
  {
    "text": "idea here is that you specify the",
    "start": "915519",
    "end": "917519"
  },
  {
    "text": "resolution of the histogram",
    "start": "917519",
    "end": "919440"
  },
  {
    "text": "in by saying how many buckets there are",
    "start": "919440",
    "end": "922560"
  },
  {
    "text": "for every power of 10",
    "start": "922560",
    "end": "924480"
  },
  {
    "text": "in this little picture i",
    "start": "924480",
    "end": "927600"
  },
  {
    "text": "used three because i didn't want to draw",
    "start": "927600",
    "end": "929600"
  },
  {
    "text": "hundreds of pockets",
    "start": "929600",
    "end": "930800"
  },
  {
    "text": "in practice this will be somewhere",
    "start": "930800",
    "end": "932720"
  },
  {
    "text": "between 20 and 100 100",
    "start": "932720",
    "end": "934720"
  },
  {
    "text": "will be super high resolution and 20",
    "start": "934720",
    "end": "936800"
  },
  {
    "text": "will be",
    "start": "936800",
    "end": "937839"
  },
  {
    "text": "an okay resolution i just had three here",
    "start": "937839",
    "end": "941600"
  },
  {
    "text": "the buckets are all",
    "start": "941600",
    "end": "943120"
  },
  {
    "text": "logarithmic which you can't see here",
    "start": "943120",
    "end": "946240"
  },
  {
    "text": "because the x-axis",
    "start": "946240",
    "end": "949519"
  },
  {
    "text": "is already logarithmic right so i did it",
    "start": "949519",
    "end": "952720"
  },
  {
    "text": "that way because otherwise the buckets",
    "start": "952720",
    "end": "954240"
  },
  {
    "text": "would be super tiny here and super big",
    "start": "954240",
    "end": "956000"
  },
  {
    "text": "here",
    "start": "956000",
    "end": "956720"
  },
  {
    "text": "so these they look linear but they are",
    "start": "956720",
    "end": "958800"
  },
  {
    "text": "logarithmic because the accesses look",
    "start": "958800",
    "end": "960480"
  },
  {
    "text": "everything",
    "start": "960480",
    "end": "961440"
  },
  {
    "text": "you need a zero bucket because with",
    "start": "961440",
    "end": "964160"
  },
  {
    "text": "logarithmic pockets you will have an",
    "start": "964160",
    "end": "966000"
  },
  {
    "text": "infinite bucket density if you approach",
    "start": "966000",
    "end": "968160"
  },
  {
    "text": "zero and you might just have",
    "start": "968160",
    "end": "969759"
  },
  {
    "text": "observations that are zero",
    "start": "969759",
    "end": "971120"
  },
  {
    "text": "or very very small so you define a zero",
    "start": "971120",
    "end": "974079"
  },
  {
    "text": "bucket",
    "start": "974079",
    "end": "974800"
  },
  {
    "text": "which usually has a width that is super",
    "start": "974800",
    "end": "977279"
  },
  {
    "text": "super small",
    "start": "977279",
    "end": "978320"
  },
  {
    "text": "and in this case i picked 0.1 just",
    "start": "978320",
    "end": "981360"
  },
  {
    "text": "that i'm able to draw and here we have",
    "start": "981360",
    "end": "983360"
  },
  {
    "text": "three pockets",
    "start": "983360",
    "end": "984560"
  },
  {
    "text": "um then there's an empty bucket it's a",
    "start": "984560",
    "end": "986560"
  },
  {
    "text": "sparse histogram and then there are",
    "start": "986560",
    "end": "988000"
  },
  {
    "text": "three other buckets and you can continue",
    "start": "988000",
    "end": "989839"
  },
  {
    "text": "this into",
    "start": "989839",
    "end": "990560"
  },
  {
    "text": "infinity",
    "start": "990560",
    "end": "993279"
  },
  {
    "text": "so how does this all work in",
    "start": "993759",
    "end": "997440"
  },
  {
    "text": "real life to test that i took",
    "start": "997440",
    "end": "1000560"
  },
  {
    "text": "observations from a real production",
    "start": "1000560",
    "end": "1003279"
  },
  {
    "text": "cluster here at grafana labs from our",
    "start": "1003279",
    "end": "1004959"
  },
  {
    "text": "cortex cluster",
    "start": "1004959",
    "end": "1006320"
  },
  {
    "text": "if you know cortex you know what",
    "start": "1006320",
    "end": "1007519"
  },
  {
    "text": "injester and queria means but we don't",
    "start": "1007519",
    "end": "1009680"
  },
  {
    "text": "have to",
    "start": "1009680",
    "end": "1010320"
  },
  {
    "text": "worry about that the only important",
    "start": "1010320",
    "end": "1012639"
  },
  {
    "text": "information is that the queria has a",
    "start": "1012639",
    "end": "1014720"
  },
  {
    "text": "very broad",
    "start": "1014720",
    "end": "1015759"
  },
  {
    "text": "distribution of latencies durations",
    "start": "1015759",
    "end": "1019920"
  },
  {
    "text": "so this is like a high entropy scenario",
    "start": "1019920",
    "end": "1023519"
  },
  {
    "text": "well the ingestor is more like it has a",
    "start": "1023519",
    "end": "1025918"
  },
  {
    "text": "more",
    "start": "1025919",
    "end": "1026640"
  },
  {
    "text": "a smaller distribution most of the uh",
    "start": "1026640",
    "end": "1028880"
  },
  {
    "text": "requests the ingestor processes",
    "start": "1028880",
    "end": "1030959"
  },
  {
    "text": "it are processed in more or less the",
    "start": "1030959",
    "end": "1033038"
  },
  {
    "text": "same duration",
    "start": "1033039",
    "end": "1034640"
  },
  {
    "text": "so i i collected the ginormous amount of",
    "start": "1034640",
    "end": "1037600"
  },
  {
    "text": "almost 2 million observations here",
    "start": "1037600",
    "end": "1039280"
  },
  {
    "text": "and a bit more than half a million for",
    "start": "1039280",
    "end": "1041520"
  },
  {
    "text": "the querier",
    "start": "1041520",
    "end": "1042558"
  },
  {
    "text": "and put them all into one histogram",
    "start": "1042559",
    "end": "1045038"
  },
  {
    "text": "that's kind of a worst case scenario in",
    "start": "1045039",
    "end": "1047360"
  },
  {
    "text": "in practice you would probably have a",
    "start": "1047360",
    "end": "1049520"
  },
  {
    "text": "histogram",
    "start": "1049520",
    "end": "1050480"
  },
  {
    "text": "along certain dimensions and you would",
    "start": "1050480",
    "end": "1052240"
  },
  {
    "text": "have it on every instance",
    "start": "1052240",
    "end": "1054240"
  },
  {
    "text": "uh this is really like to to to to brute",
    "start": "1054240",
    "end": "1056799"
  },
  {
    "text": "force tests that put all the",
    "start": "1056799",
    "end": "1058000"
  },
  {
    "text": "observations",
    "start": "1058000",
    "end": "1059200"
  },
  {
    "text": "um into one histogram by the way the two",
    "start": "1059200",
    "end": "1061679"
  },
  {
    "text": "million here",
    "start": "1061679",
    "end": "1062400"
  },
  {
    "text": "are happening in just two minutes",
    "start": "1062400",
    "end": "1063919"
  },
  {
    "text": "because it's a super busy cluster",
    "start": "1063919",
    "end": "1066160"
  },
  {
    "text": "the query is not as busy so there was",
    "start": "1066160",
    "end": "1068240"
  },
  {
    "text": "half a million was over an hour",
    "start": "1068240",
    "end": "1070320"
  },
  {
    "text": "um so resolution 20 20 buckets per power",
    "start": "1070320",
    "end": "1073520"
  },
  {
    "text": "of 10",
    "start": "1073520",
    "end": "1074480"
  },
  {
    "text": "in fact with this genomic histogram only",
    "start": "1074480",
    "end": "1077120"
  },
  {
    "text": "78 pockets were populated",
    "start": "1077120",
    "end": "1079200"
  },
  {
    "text": "with this less observations but higher",
    "start": "1079200",
    "end": "1081679"
  },
  {
    "text": "entropy distribution",
    "start": "1081679",
    "end": "1083280"
  },
  {
    "text": "112 buckets were populated a bit more",
    "start": "1083280",
    "end": "1086960"
  },
  {
    "text": "the span here means how many continuous",
    "start": "1086960",
    "end": "1090080"
  },
  {
    "text": "bands of con subsequent histograms there",
    "start": "1090080",
    "end": "1093760"
  },
  {
    "text": "are",
    "start": "1093760",
    "end": "1094080"
  },
  {
    "text": "right um so this means there are two",
    "start": "1094080",
    "end": "1096960"
  },
  {
    "text": "groups of",
    "start": "1096960",
    "end": "1097679"
  },
  {
    "text": "pockets sorry there's histograms pockets",
    "start": "1097679",
    "end": "1100559"
  },
  {
    "text": "spans of buckets right so there are two",
    "start": "1100559",
    "end": "1102320"
  },
  {
    "text": "groups of pockets and there is",
    "start": "1102320",
    "end": "1103679"
  },
  {
    "text": "at least an empty bucket in between and",
    "start": "1103679",
    "end": "1105520"
  },
  {
    "text": "here all the 112 buckets are actually",
    "start": "1105520",
    "end": "1108320"
  },
  {
    "text": "in a row right there is no empty bucket",
    "start": "1108320",
    "end": "1110240"
  },
  {
    "text": "in between",
    "start": "1110240",
    "end": "1111679"
  },
  {
    "text": "you can also go to much higher",
    "start": "1111679",
    "end": "1113840"
  },
  {
    "text": "resolutions so this is the higher end",
    "start": "1113840",
    "end": "1115679"
  },
  {
    "text": "resolution of 100",
    "start": "1115679",
    "end": "1116960"
  },
  {
    "text": "we have many more buckets and also more",
    "start": "1116960",
    "end": "1119039"
  },
  {
    "text": "spans like more often you have some",
    "start": "1119039",
    "end": "1120880"
  },
  {
    "text": "empty pockets in the middle",
    "start": "1120880",
    "end": "1122559"
  },
  {
    "text": "but overall like a couple of hundred",
    "start": "1122559",
    "end": "1125120"
  },
  {
    "text": "buckets i think this is something we can",
    "start": "1125120",
    "end": "1127039"
  },
  {
    "text": "manage so this gave me some confidence",
    "start": "1127039",
    "end": "1129360"
  },
  {
    "text": "that i'm on the right track so",
    "start": "1129360",
    "end": "1133600"
  },
  {
    "text": "what i did next i thought about how to",
    "start": "1134799",
    "end": "1137280"
  },
  {
    "text": "encode",
    "start": "1137280",
    "end": "1138240"
  },
  {
    "text": "these histograms and represent them",
    "start": "1138240",
    "end": "1140640"
  },
  {
    "text": "first of all in the exposition",
    "start": "1140640",
    "end": "1142799"
  },
  {
    "text": "format and how to then",
    "start": "1142799",
    "end": "1145919"
  },
  {
    "text": "encode them in the tstb",
    "start": "1145919",
    "end": "1149200"
  },
  {
    "text": "of course a lot has been thought about",
    "start": "1149200",
    "end": "1151200"
  },
  {
    "text": "this this is just",
    "start": "1151200",
    "end": "1152480"
  },
  {
    "text": "um i had to come up with something to",
    "start": "1152480",
    "end": "1154880"
  },
  {
    "text": "try it out in the prometheus context",
    "start": "1154880",
    "end": "1156880"
  },
  {
    "text": "so there's a zero bucket and then i",
    "start": "1156880",
    "end": "1159919"
  },
  {
    "text": "number the bucket i start with zero at",
    "start": "1159919",
    "end": "1162160"
  },
  {
    "text": "the bucket that has an upper bound of",
    "start": "1162160",
    "end": "1163919"
  },
  {
    "text": "one",
    "start": "1163919",
    "end": "1165280"
  },
  {
    "text": "and then i go negative to the left and",
    "start": "1165280",
    "end": "1166799"
  },
  {
    "text": "positive to the right and this pocket",
    "start": "1166799",
    "end": "1168799"
  },
  {
    "text": "doesn't exist but it still has a number",
    "start": "1168799",
    "end": "1171600"
  },
  {
    "text": "and then those are organized in spans as",
    "start": "1171600",
    "end": "1173679"
  },
  {
    "text": "we have seen",
    "start": "1173679",
    "end": "1175039"
  },
  {
    "text": "spans of of consecutive buckets",
    "start": "1175039",
    "end": "1178400"
  },
  {
    "text": "this is a span that starts at bucket",
    "start": "1178400",
    "end": "1181120"
  },
  {
    "text": "number minus two and has a length of",
    "start": "1181120",
    "end": "1182640"
  },
  {
    "text": "three and then we have",
    "start": "1182640",
    "end": "1183679"
  },
  {
    "text": "one a gap of one so the next band has an",
    "start": "1183679",
    "end": "1185760"
  },
  {
    "text": "offset of one",
    "start": "1185760",
    "end": "1186880"
  },
  {
    "text": "and a length of three and so on so these",
    "start": "1186880",
    "end": "1190080"
  },
  {
    "text": "are small numbers then and you need very",
    "start": "1190080",
    "end": "1192480"
  },
  {
    "text": "few very small numbers to describe the",
    "start": "1192480",
    "end": "1194799"
  },
  {
    "text": "whole bucket layout",
    "start": "1194799",
    "end": "1196160"
  },
  {
    "text": "which is great because small numbers are",
    "start": "1196160",
    "end": "1199280"
  },
  {
    "text": "nicely",
    "start": "1199280",
    "end": "1200559"
  },
  {
    "text": "they they encode quite nicely with a var",
    "start": "1200559",
    "end": "1202880"
  },
  {
    "text": "int encoding scheme",
    "start": "1202880",
    "end": "1204480"
  },
  {
    "text": "which is essentially built into a",
    "start": "1204480",
    "end": "1205919"
  },
  {
    "text": "protobuf which",
    "start": "1205919",
    "end": "1207679"
  },
  {
    "text": "simplifies things a lot the other thing",
    "start": "1207679",
    "end": "1210480"
  },
  {
    "text": "are of course the counts in the pockets",
    "start": "1210480",
    "end": "1212559"
  },
  {
    "text": "they tend to be",
    "start": "1212559",
    "end": "1213600"
  },
  {
    "text": "really high like we have seen there are",
    "start": "1213600",
    "end": "1215440"
  },
  {
    "text": "millions of observations in my data set",
    "start": "1215440",
    "end": "1218320"
  },
  {
    "text": "so you don't want to encode the absolute",
    "start": "1218320",
    "end": "1220400"
  },
  {
    "text": "numbers but since a histogram is usually",
    "start": "1220400",
    "end": "1222640"
  },
  {
    "text": "like",
    "start": "1222640",
    "end": "1223200"
  },
  {
    "text": "smooth in some way it goes up and down",
    "start": "1223200",
    "end": "1225679"
  },
  {
    "text": "but not zigzagging like crazy",
    "start": "1225679",
    "end": "1228720"
  },
  {
    "text": "this is why um",
    "start": "1228720",
    "end": "1232240"
  },
  {
    "text": "i encode deltas from one bucket to the",
    "start": "1232240",
    "end": "1234480"
  },
  {
    "text": "next they are usually small",
    "start": "1234480",
    "end": "1236240"
  },
  {
    "text": "can be encoded with val int quite nicely",
    "start": "1236240",
    "end": "1239039"
  },
  {
    "text": "and i skip over gaps",
    "start": "1239039",
    "end": "1240559"
  },
  {
    "text": "just take the delta here and this is how",
    "start": "1240559",
    "end": "1243600"
  },
  {
    "text": "it works",
    "start": "1243600",
    "end": "1245679"
  },
  {
    "text": "um if you put this into a protobuf and",
    "start": "1245679",
    "end": "1248240"
  },
  {
    "text": "you have",
    "start": "1248240",
    "end": "1248720"
  },
  {
    "text": "proto based exposition format which was",
    "start": "1248720",
    "end": "1250960"
  },
  {
    "text": "by the way what prometheus used in the",
    "start": "1250960",
    "end": "1252880"
  },
  {
    "text": "beginning",
    "start": "1252880",
    "end": "1253440"
  },
  {
    "text": "and only the current prometheus server",
    "start": "1253440",
    "end": "1256080"
  },
  {
    "text": "uses",
    "start": "1256080",
    "end": "1256960"
  },
  {
    "text": "a text-based format we'll talk about",
    "start": "1256960",
    "end": "1258880"
  },
  {
    "text": "that in a minute so if you put this all",
    "start": "1258880",
    "end": "1260880"
  },
  {
    "text": "into a protobuf with",
    "start": "1260880",
    "end": "1262159"
  },
  {
    "text": "uh using var end and and specifying",
    "start": "1262159",
    "end": "1264720"
  },
  {
    "text": "those spans and deltas nicely",
    "start": "1264720",
    "end": "1266799"
  },
  {
    "text": "this is what you get this 78 pocket",
    "start": "1266799",
    "end": "1268880"
  },
  {
    "text": "histogram takes 244 bytes",
    "start": "1268880",
    "end": "1271039"
  },
  {
    "text": "the slightly larger takes a bit more and",
    "start": "1271039",
    "end": "1273679"
  },
  {
    "text": "even if you go to",
    "start": "1273679",
    "end": "1274960"
  },
  {
    "text": "a really high resolution you have more",
    "start": "1274960",
    "end": "1277840"
  },
  {
    "text": "buckets",
    "start": "1277840",
    "end": "1278960"
  },
  {
    "text": "but what is really nice that this is",
    "start": "1278960",
    "end": "1281280"
  },
  {
    "text": "essentially five times the resolution",
    "start": "1281280",
    "end": "1283120"
  },
  {
    "text": "but the",
    "start": "1283120",
    "end": "1283679"
  },
  {
    "text": "the size on the wire is significantly",
    "start": "1283679",
    "end": "1286559"
  },
  {
    "text": "less than five times right so you get",
    "start": "1286559",
    "end": "1289200"
  },
  {
    "text": "gets more efficient here with more",
    "start": "1289200",
    "end": "1290640"
  },
  {
    "text": "buckets so is this a lot or not a",
    "start": "1290640",
    "end": "1293200"
  },
  {
    "text": "kilobyte",
    "start": "1293200",
    "end": "1294159"
  },
  {
    "text": "um we can look at um how",
    "start": "1294159",
    "end": "1297760"
  },
  {
    "text": "it looks in the current text format that",
    "start": "1297760",
    "end": "1300000"
  },
  {
    "text": "we use for",
    "start": "1300000",
    "end": "1301039"
  },
  {
    "text": "histograms and it looks fairly",
    "start": "1301039",
    "end": "1303679"
  },
  {
    "text": "repetitive so",
    "start": "1303679",
    "end": "1304960"
  },
  {
    "text": "this is a very simple kind of ten ish",
    "start": "1304960",
    "end": "1307120"
  },
  {
    "text": "pockets",
    "start": "1307120",
    "end": "1308000"
  },
  {
    "text": "histogram and this one takes 1.6",
    "start": "1308000",
    "end": "1311280"
  },
  {
    "text": "kilobyte",
    "start": "1311280",
    "end": "1312080"
  },
  {
    "text": "as you see it here these are 1.6",
    "start": "1312080",
    "end": "1313840"
  },
  {
    "text": "kilobytes right there's also this",
    "start": "1313840",
    "end": "1315760"
  },
  {
    "text": "older protobuf format which is more",
    "start": "1315760",
    "end": "1318880"
  },
  {
    "text": "condensed less repetitive but even there",
    "start": "1318880",
    "end": "1322000"
  },
  {
    "text": "as you can see 300 something bytes for",
    "start": "1322000",
    "end": "1324480"
  },
  {
    "text": "like",
    "start": "1324480",
    "end": "1325039"
  },
  {
    "text": "12 pockets well here we have kind of the",
    "start": "1325039",
    "end": "1327919"
  },
  {
    "text": "same number of bytes for 100 buckets",
    "start": "1327919",
    "end": "1330799"
  },
  {
    "text": "so clearly we we're doing something",
    "start": "1330799",
    "end": "1333200"
  },
  {
    "text": "right here right the exposition format",
    "start": "1333200",
    "end": "1334960"
  },
  {
    "text": "as",
    "start": "1334960",
    "end": "1335600"
  },
  {
    "text": "uh sketched out here works",
    "start": "1335600",
    "end": "1339039"
  },
  {
    "start": "1339000",
    "end": "1428000"
  },
  {
    "text": "okay uh so exposition let's say we can",
    "start": "1339039",
    "end": "1341760"
  },
  {
    "text": "handle that right",
    "start": "1341760",
    "end": "1342640"
  },
  {
    "text": "now storage this is also interesting how",
    "start": "1342640",
    "end": "1345360"
  },
  {
    "text": "do we store this",
    "start": "1345360",
    "end": "1346720"
  },
  {
    "text": "the basic idea that should save us a lot",
    "start": "1346720",
    "end": "1349520"
  },
  {
    "text": "is that",
    "start": "1349520",
    "end": "1350559"
  },
  {
    "text": "we need to just save one time series",
    "start": "1350559",
    "end": "1354240"
  },
  {
    "text": "per histogram not per bucket that's what",
    "start": "1354240",
    "end": "1357280"
  },
  {
    "text": "we do right now that was decided back",
    "start": "1357280",
    "end": "1359360"
  },
  {
    "text": "then just",
    "start": "1359360",
    "end": "1360080"
  },
  {
    "text": "out of simplicity to not change",
    "start": "1360080",
    "end": "1362159"
  },
  {
    "text": "prometheus completely when you introduce",
    "start": "1362159",
    "end": "1363760"
  },
  {
    "text": "histograms",
    "start": "1363760",
    "end": "1364720"
  },
  {
    "text": "every pocket is its own time series",
    "start": "1364720",
    "end": "1367760"
  },
  {
    "text": "which has huge overheads as you can see",
    "start": "1367760",
    "end": "1370159"
  },
  {
    "text": "also because like",
    "start": "1370159",
    "end": "1371360"
  },
  {
    "text": "cardinality is that the bottleneck",
    "start": "1371360",
    "end": "1373840"
  },
  {
    "text": "currency",
    "start": "1373840",
    "end": "1374480"
  },
  {
    "text": "in a matrix based monitoring system",
    "start": "1374480",
    "end": "1377520"
  },
  {
    "text": "so now we we kind of say we can have",
    "start": "1377520",
    "end": "1380880"
  },
  {
    "text": "a lot of pockets but it will still be",
    "start": "1380880",
    "end": "1383120"
  },
  {
    "text": "one series per histogram",
    "start": "1383120",
    "end": "1384960"
  },
  {
    "text": "but that means assemble value is now a",
    "start": "1384960",
    "end": "1387520"
  },
  {
    "text": "sequence of pockets instead of",
    "start": "1387520",
    "end": "1389120"
  },
  {
    "text": "a float and we can take the bucket",
    "start": "1389120",
    "end": "1391200"
  },
  {
    "text": "deltas to have smaller numbers",
    "start": "1391200",
    "end": "1393440"
  },
  {
    "text": "and those values why not we can encode",
    "start": "1393440",
    "end": "1396000"
  },
  {
    "text": "them in the same way we already encode",
    "start": "1396000",
    "end": "1397760"
  },
  {
    "text": "timestamps",
    "start": "1397760",
    "end": "1398559"
  },
  {
    "text": "which is a double delta encoding so i",
    "start": "1398559",
    "end": "1400799"
  },
  {
    "text": "call it triple delta because we double",
    "start": "1400799",
    "end": "1402320"
  },
  {
    "text": "delta encode a bucket delta right",
    "start": "1402320",
    "end": "1404880"
  },
  {
    "text": "uh it sounds fancy and then those are",
    "start": "1404880",
    "end": "1408400"
  },
  {
    "text": "encoded with a what we call velvet",
    "start": "1408400",
    "end": "1411280"
  },
  {
    "text": "schema that's griller style",
    "start": "1411280",
    "end": "1413520"
  },
  {
    "text": "it's a bit different in detail but",
    "start": "1413520",
    "end": "1416000"
  },
  {
    "text": "mostly what you know",
    "start": "1416000",
    "end": "1417280"
  },
  {
    "text": "probably know from the gorilla paper",
    "start": "1417280",
    "end": "1420240"
  },
  {
    "text": "it's again used for timestamps already",
    "start": "1420240",
    "end": "1422480"
  },
  {
    "text": "and we can use it for",
    "start": "1422480",
    "end": "1425600"
  },
  {
    "text": "those triple delters so",
    "start": "1425840",
    "end": "1428880"
  },
  {
    "start": "1428000",
    "end": "1540000"
  },
  {
    "text": "if we do this um we can see how much",
    "start": "1428880",
    "end": "1431919"
  },
  {
    "text": "storage we need for those triple deltas",
    "start": "1431919",
    "end": "1433679"
  },
  {
    "text": "this completely ignores how to handle",
    "start": "1433679",
    "end": "1435440"
  },
  {
    "text": "like pocket layout and",
    "start": "1435440",
    "end": "1437440"
  },
  {
    "text": "schema changes and everything it's",
    "start": "1437440",
    "end": "1439039"
  },
  {
    "text": "really just to get the bulk storage",
    "start": "1439039",
    "end": "1441200"
  },
  {
    "text": "nailed down and to find out how much",
    "start": "1441200",
    "end": "1443919"
  },
  {
    "text": "space it needs i didn't implement a",
    "start": "1443919",
    "end": "1445679"
  },
  {
    "text": "whole tsub i really just",
    "start": "1445679",
    "end": "1448080"
  },
  {
    "text": "simulated scrapes 80 scrapes for the",
    "start": "1448080",
    "end": "1450000"
  },
  {
    "text": "ingester data set 7 240 for the courier",
    "start": "1450000",
    "end": "1453919"
  },
  {
    "text": "and found out what triple delta we have",
    "start": "1453919",
    "end": "1457039"
  },
  {
    "text": "here and then",
    "start": "1457039",
    "end": "1458640"
  },
  {
    "text": "we see a histogram will take 50 bytes",
    "start": "1458640",
    "end": "1461440"
  },
  {
    "text": "now not on the exposition format but in",
    "start": "1461440",
    "end": "1463200"
  },
  {
    "text": "the storage where we want it to be like",
    "start": "1463200",
    "end": "1465279"
  },
  {
    "text": "compressed over time in the time series",
    "start": "1465279",
    "end": "1467840"
  },
  {
    "text": "uh so every histogram takes 50 bytes",
    "start": "1467840",
    "end": "1470159"
  },
  {
    "text": "here 70 bytes for the",
    "start": "1470159",
    "end": "1472240"
  },
  {
    "text": "higher entropy case and in the higher",
    "start": "1472240",
    "end": "1474480"
  },
  {
    "text": "resolution case it takes more but again",
    "start": "1474480",
    "end": "1477039"
  },
  {
    "text": "far less than a factor of five and if",
    "start": "1477039",
    "end": "1479360"
  },
  {
    "text": "you break this down to s",
    "start": "1479360",
    "end": "1481679"
  },
  {
    "text": "bytes used per bucket per sample",
    "start": "1481679",
    "end": "1484720"
  },
  {
    "text": "then you come up with a fraction of a",
    "start": "1484720",
    "end": "1486480"
  },
  {
    "text": "bite here like 0.5 more or less",
    "start": "1486480",
    "end": "1489039"
  },
  {
    "text": "now as you might know in vanilla",
    "start": "1489039",
    "end": "1492080"
  },
  {
    "text": "prometheus for",
    "start": "1492080",
    "end": "1493279"
  },
  {
    "text": "normal floating point value samples we",
    "start": "1493279",
    "end": "1495840"
  },
  {
    "text": "need like about 1.5",
    "start": "1495840",
    "end": "1497760"
  },
  {
    "text": "bytes per sample per floating point",
    "start": "1497760",
    "end": "1500960"
  },
  {
    "text": "number",
    "start": "1500960",
    "end": "1501600"
  },
  {
    "text": "which is 3x now this is",
    "start": "1501600",
    "end": "1504799"
  },
  {
    "text": "um this is already kind of the worst",
    "start": "1504799",
    "end": "1506799"
  },
  {
    "text": "case",
    "start": "1506799",
    "end": "1507840"
  },
  {
    "text": "scenario here so we might be at 5x or",
    "start": "1507840",
    "end": "1510640"
  },
  {
    "text": "something",
    "start": "1510640",
    "end": "1511679"
  },
  {
    "text": "or even a bit better but we also have",
    "start": "1511679",
    "end": "1514480"
  },
  {
    "text": "probably",
    "start": "1514480",
    "end": "1515279"
  },
  {
    "text": "10x the amount of pockets compared to",
    "start": "1515279",
    "end": "1517679"
  },
  {
    "text": "conventional histograms",
    "start": "1517679",
    "end": "1519360"
  },
  {
    "text": "so overall the storage space will",
    "start": "1519360",
    "end": "1521600"
  },
  {
    "text": "probably be a bit",
    "start": "1521600",
    "end": "1522880"
  },
  {
    "text": "more demanding but on the other hand we",
    "start": "1522880",
    "end": "1525520"
  },
  {
    "text": "will save a lot",
    "start": "1525520",
    "end": "1526559"
  },
  {
    "text": "with the index so that overall",
    "start": "1526559",
    "end": "1529600"
  },
  {
    "text": "should hopefully this is what i hope for",
    "start": "1529600",
    "end": "1533120"
  },
  {
    "text": "we should be more more or comparable",
    "start": "1533120",
    "end": "1536640"
  },
  {
    "text": "like more or less the same efficiency or",
    "start": "1536640",
    "end": "1539039"
  },
  {
    "text": "better",
    "start": "1539039",
    "end": "1540320"
  },
  {
    "text": "querying that's a big deal because i",
    "start": "1540320",
    "end": "1543120"
  },
  {
    "text": "haven't done",
    "start": "1543120",
    "end": "1544159"
  },
  {
    "text": "concrete research about this because",
    "start": "1544159",
    "end": "1545919"
  },
  {
    "text": "then you really need to implement the",
    "start": "1545919",
    "end": "1547600"
  },
  {
    "text": "tsdb",
    "start": "1547600",
    "end": "1548400"
  },
  {
    "text": "and then you have to teach from ql how",
    "start": "1548400",
    "end": "1550480"
  },
  {
    "text": "it can deal with like those complex",
    "start": "1550480",
    "end": "1552400"
  },
  {
    "text": "histograms instead of just",
    "start": "1552400",
    "end": "1554080"
  },
  {
    "text": "individual pockets but i have good hope",
    "start": "1554080",
    "end": "1557600"
  },
  {
    "text": "that this will actually work out nicely",
    "start": "1557600",
    "end": "1559360"
  },
  {
    "text": "because",
    "start": "1559360",
    "end": "1559760"
  },
  {
    "text": "others have done this um it's like more",
    "start": "1559760",
    "end": "1562640"
  },
  {
    "text": "than just one group of people has done",
    "start": "1562640",
    "end": "1564480"
  },
  {
    "text": "this but i",
    "start": "1564480",
    "end": "1565200"
  },
  {
    "text": "have to pick one right and i really like",
    "start": "1565200",
    "end": "1567120"
  },
  {
    "text": "this talk at monitor rama last year",
    "start": "1567120",
    "end": "1570000"
  },
  {
    "text": "about filodb uh evan chan",
    "start": "1570000",
    "end": "1573039"
  },
  {
    "text": "gave this and slide 23 is my favorite i",
    "start": "1573039",
    "end": "1575840"
  },
  {
    "text": "mean the whole talk is great because it",
    "start": "1575840",
    "end": "1577679"
  },
  {
    "text": "very nicely explains all the problems",
    "start": "1577679",
    "end": "1579679"
  },
  {
    "text": "with prometheus histograms and what you",
    "start": "1579679",
    "end": "1582320"
  },
  {
    "text": "can do about it",
    "start": "1582320",
    "end": "1583679"
  },
  {
    "text": "and slide 23 is showing that a histogram",
    "start": "1583679",
    "end": "1587120"
  },
  {
    "text": "quantile calculation",
    "start": "1587120",
    "end": "1588799"
  },
  {
    "text": "um is 100 times more efficient in follow",
    "start": "1588799",
    "end": "1592240"
  },
  {
    "text": "db",
    "start": "1592240",
    "end": "1592720"
  },
  {
    "text": "where they where they use approaches",
    "start": "1592720",
    "end": "1594640"
  },
  {
    "text": "quite similar to what what i'm planning",
    "start": "1594640",
    "end": "1596320"
  },
  {
    "text": "here",
    "start": "1596320",
    "end": "1596960"
  },
  {
    "text": "so this is what gives me hope that it",
    "start": "1596960",
    "end": "1598960"
  },
  {
    "text": "will just work",
    "start": "1598960",
    "end": "1600240"
  },
  {
    "start": "1599000",
    "end": "1609000"
  },
  {
    "text": "okay let's quickly go through our wish",
    "start": "1600240",
    "end": "1602480"
  },
  {
    "text": "list and see",
    "start": "1602480",
    "end": "1604480"
  },
  {
    "text": "how this will work out everything that",
    "start": "1604480",
    "end": "1606640"
  },
  {
    "text": "works well now should continue to work",
    "start": "1606640",
    "end": "1608480"
  },
  {
    "text": "well",
    "start": "1608480",
    "end": "1609120"
  },
  {
    "start": "1609000",
    "end": "1644000"
  },
  {
    "text": "this is mostly true spoiler most of the",
    "start": "1609120",
    "end": "1612640"
  },
  {
    "text": "answers here",
    "start": "1612640",
    "end": "1613440"
  },
  {
    "text": "are almost so the one thing that",
    "start": "1613440",
    "end": "1617279"
  },
  {
    "text": "works really well if you have like an",
    "start": "1617279",
    "end": "1618960"
  },
  {
    "text": "slo which uh",
    "start": "1618960",
    "end": "1620400"
  },
  {
    "text": "reads like 99 of curies to be served in",
    "start": "1620400",
    "end": "1623039"
  },
  {
    "text": "150 milliseconds or less then you can",
    "start": "1623039",
    "end": "1624960"
  },
  {
    "text": "just put a pocket boundary at 150",
    "start": "1624960",
    "end": "1626960"
  },
  {
    "text": "milliseconds and you have a precise",
    "start": "1626960",
    "end": "1629279"
  },
  {
    "text": "answer from prometheus and now with the",
    "start": "1629279",
    "end": "1632159"
  },
  {
    "text": "um",
    "start": "1632159",
    "end": "1633840"
  },
  {
    "text": "logarithmic histograms it's just",
    "start": "1633840",
    "end": "1635279"
  },
  {
    "text": "impossible to get a boundary at 150",
    "start": "1635279",
    "end": "1637679"
  },
  {
    "text": "milliseconds but",
    "start": "1637679",
    "end": "1638799"
  },
  {
    "text": "you have like very boundaries very close",
    "start": "1638799",
    "end": "1641200"
  },
  {
    "text": "to that so it's it's almost there right",
    "start": "1641200",
    "end": "1644399"
  },
  {
    "start": "1644000",
    "end": "1687000"
  },
  {
    "text": "this is the only thing that works in",
    "start": "1644399",
    "end": "1646159"
  },
  {
    "text": "principle a bit less",
    "start": "1646159",
    "end": "1647840"
  },
  {
    "text": "well uh i never want to configure",
    "start": "1647840",
    "end": "1649760"
  },
  {
    "text": "markets again i told you there are",
    "start": "1649760",
    "end": "1651760"
  },
  {
    "text": "just two parameters the resolution and",
    "start": "1651760",
    "end": "1653919"
  },
  {
    "text": "the zero threshold this is",
    "start": "1653919",
    "end": "1655360"
  },
  {
    "text": "real go code from my proof of concept",
    "start": "1655360",
    "end": "1657600"
  },
  {
    "text": "code",
    "start": "1657600",
    "end": "1658480"
  },
  {
    "text": "now in practice you will never configure",
    "start": "1658480",
    "end": "1660240"
  },
  {
    "text": "the zero threshold it would just be at",
    "start": "1660240",
    "end": "1661919"
  },
  {
    "text": "this very small value and you never have",
    "start": "1661919",
    "end": "1663840"
  },
  {
    "text": "to change it",
    "start": "1663840",
    "end": "1664799"
  },
  {
    "text": "and ideally we will find a resolution",
    "start": "1664799",
    "end": "1667200"
  },
  {
    "text": "that is good enough for everyone but not",
    "start": "1667200",
    "end": "1669200"
  },
  {
    "text": "too high to not be too expensive and",
    "start": "1669200",
    "end": "1671520"
  },
  {
    "text": "you never have to touch this either it",
    "start": "1671520",
    "end": "1673840"
  },
  {
    "text": "could be 42",
    "start": "1673840",
    "end": "1675200"
  },
  {
    "text": "that would be fun it will be somewhere",
    "start": "1675200",
    "end": "1677679"
  },
  {
    "text": "between 20 and 100",
    "start": "1677679",
    "end": "1678960"
  },
  {
    "text": "200 i'm pretty sure about that and",
    "start": "1678960",
    "end": "1682080"
  },
  {
    "text": "i yeah we just have to find something",
    "start": "1682080",
    "end": "1684720"
  },
  {
    "text": "right because if you change this",
    "start": "1684720",
    "end": "1686080"
  },
  {
    "text": "resolution you",
    "start": "1686080",
    "end": "1687039"
  },
  {
    "start": "1687000",
    "end": "1756000"
  },
  {
    "text": "run into the next problem all histograms",
    "start": "1687039",
    "end": "1689360"
  },
  {
    "text": "should always be aggregated with each",
    "start": "1689360",
    "end": "1690960"
  },
  {
    "text": "other across time and space",
    "start": "1690960",
    "end": "1692799"
  },
  {
    "text": "yeah if you change the resolution you",
    "start": "1692799",
    "end": "1694640"
  },
  {
    "text": "you will not have this but",
    "start": "1694640",
    "end": "1696159"
  },
  {
    "text": "ideally there is a resolution that will",
    "start": "1696159",
    "end": "1698080"
  },
  {
    "text": "cover most of the cases and",
    "start": "1698080",
    "end": "1700000"
  },
  {
    "text": "only in various special cases you have",
    "start": "1700000",
    "end": "1702159"
  },
  {
    "text": "to change that",
    "start": "1702159",
    "end": "1704159"
  },
  {
    "text": "i want accurate quantile and percentage",
    "start": "1704159",
    "end": "1705919"
  },
  {
    "text": "estimation across the whole range of",
    "start": "1705919",
    "end": "1707120"
  },
  {
    "text": "observations",
    "start": "1707120",
    "end": "1707840"
  },
  {
    "text": "it's also almost i mean quantile",
    "start": "1707840",
    "end": "1710640"
  },
  {
    "text": "calculations",
    "start": "1710640",
    "end": "1711440"
  },
  {
    "text": "are fairly accurate with a resolution of",
    "start": "1711440",
    "end": "1713520"
  },
  {
    "text": "100 you have like about one percent of",
    "start": "1713520",
    "end": "1715840"
  },
  {
    "text": "worst case relative error which is",
    "start": "1715840",
    "end": "1718720"
  },
  {
    "text": "fairly good",
    "start": "1718720",
    "end": "1719760"
  },
  {
    "text": "uh compared to like the industry what",
    "start": "1719760",
    "end": "1722080"
  },
  {
    "text": "they're all doing",
    "start": "1722080",
    "end": "1723120"
  },
  {
    "text": "a percentage has this one problem that",
    "start": "1723120",
    "end": "1725840"
  },
  {
    "text": "you cannot freely pick where a pocket",
    "start": "1725840",
    "end": "1728000"
  },
  {
    "text": "boundary is so you have",
    "start": "1728000",
    "end": "1729600"
  },
  {
    "text": "some tiny error there but overall from",
    "start": "1729600",
    "end": "1732720"
  },
  {
    "text": "my research results i'm very satisfied",
    "start": "1732720",
    "end": "1735039"
  },
  {
    "text": "about this one",
    "start": "1735039",
    "end": "1736159"
  },
  {
    "text": "i'm on all of that at lower cost than",
    "start": "1736159",
    "end": "1738559"
  },
  {
    "text": "current histogram so that i can finally",
    "start": "1738559",
    "end": "1740559"
  },
  {
    "text": "partition histograms at will",
    "start": "1740559",
    "end": "1742080"
  },
  {
    "text": "this is orange because i really can't",
    "start": "1742080",
    "end": "1744720"
  },
  {
    "text": "tell",
    "start": "1744720",
    "end": "1745120"
  },
  {
    "text": "if it will really be dramatically lower",
    "start": "1745120",
    "end": "1747520"
  },
  {
    "text": "in cost",
    "start": "1747520",
    "end": "1748240"
  },
  {
    "text": "i'm hopeful that it will all of this",
    "start": "1748240",
    "end": "1750320"
  },
  {
    "text": "awesomeness will be",
    "start": "1750320",
    "end": "1751600"
  },
  {
    "text": "same price essentially all lower",
    "start": "1751600",
    "end": "1753840"
  },
  {
    "text": "hopefully lower",
    "start": "1753840",
    "end": "1754960"
  },
  {
    "text": "but we have to see all right there's",
    "start": "1754960",
    "end": "1758080"
  },
  {
    "start": "1756000",
    "end": "1796000"
  },
  {
    "text": "uh now we're at the end you can look at",
    "start": "1758080",
    "end": "1761120"
  },
  {
    "text": "all those um rough results in this",
    "start": "1761120",
    "end": "1764480"
  },
  {
    "text": "github repo it's very rough really it's",
    "start": "1764480",
    "end": "1766880"
  },
  {
    "text": "just my experience reboot the code has",
    "start": "1766880",
    "end": "1769039"
  },
  {
    "text": "horrible",
    "start": "1769039",
    "end": "1769919"
  },
  {
    "text": "quality i just wanted to try things out",
    "start": "1769919",
    "end": "1772480"
  },
  {
    "text": "i'm writing a proper design note which i",
    "start": "1772480",
    "end": "1774720"
  },
  {
    "text": "will",
    "start": "1774720",
    "end": "1775120"
  },
  {
    "text": "shortly announce on this mailing list so",
    "start": "1775120",
    "end": "1778000"
  },
  {
    "text": "follow this",
    "start": "1778000",
    "end": "1778720"
  },
  {
    "text": "and you can pick it up when it's there",
    "start": "1778720",
    "end": "1781360"
  },
  {
    "text": "to be reviewed by the world",
    "start": "1781360",
    "end": "1783679"
  },
  {
    "text": "these are my talks this is my email but",
    "start": "1783679",
    "end": "1786000"
  },
  {
    "text": "um",
    "start": "1786000",
    "end": "1786960"
  },
  {
    "text": "this leads us to the end so we have five",
    "start": "1786960",
    "end": "1789360"
  },
  {
    "text": "minutes and five seconds left for",
    "start": "1789360",
    "end": "1791200"
  },
  {
    "text": "q a thanks for your attention and see",
    "start": "1791200",
    "end": "1794480"
  },
  {
    "text": "you in the q a bye bye",
    "start": "1794480",
    "end": "1798720"
  }
]