[
  {
    "text": "my name is Leon Baron I'm a Solutions",
    "start": "1140",
    "end": "3300"
  },
  {
    "text": "architect at Tiger and in this video",
    "start": "3300",
    "end": "5220"
  },
  {
    "text": "we're going to run through the steps",
    "start": "5220",
    "end": "7140"
  },
  {
    "text": "needed to take a Bare Bones kubernetes",
    "start": "7140",
    "end": "9300"
  },
  {
    "text": "cluster to a cluster that has Calico",
    "start": "9300",
    "end": "12120"
  },
  {
    "text": "Prometheus and grafana deployed and",
    "start": "12120",
    "end": "14759"
  },
  {
    "text": "running and chemical components exposing",
    "start": "14759",
    "end": "17400"
  },
  {
    "text": "metrics for Prometheus consumption now",
    "start": "17400",
    "end": "19680"
  },
  {
    "text": "how we'll do that is we're going to take",
    "start": "19680",
    "end": "21300"
  },
  {
    "text": "a kubernetes cluster that has no cni",
    "start": "21300",
    "end": "23580"
  },
  {
    "text": "installed in it and using Helm will",
    "start": "23580",
    "end": "25859"
  },
  {
    "text": "deploy Calico open source and the",
    "start": "25859",
    "end": "27960"
  },
  {
    "text": "Prometheus stack we'll then enable the",
    "start": "27960",
    "end": "30000"
  },
  {
    "text": "Calico components to expose metrics and",
    "start": "30000",
    "end": "32758"
  },
  {
    "text": "ensure that Prometheus discovers these",
    "start": "32759",
    "end": "34800"
  },
  {
    "text": "metrics finally we'll create a sample",
    "start": "34800",
    "end": "37320"
  },
  {
    "text": "dashboard in grafana to display these",
    "start": "37320",
    "end": "39480"
  },
  {
    "text": "metrics",
    "start": "39480",
    "end": "40920"
  },
  {
    "text": "now before we begin let's first take a",
    "start": "40920",
    "end": "43860"
  },
  {
    "text": "look at the lab environment we have set",
    "start": "43860",
    "end": "45480"
  },
  {
    "text": "up here we have a three node kubernetes",
    "start": "45480",
    "end": "47640"
  },
  {
    "text": "cluster installed using Kube ADM and a",
    "start": "47640",
    "end": "50700"
  },
  {
    "text": "Bastion host where we'll be running all",
    "start": "50700",
    "end": "52500"
  },
  {
    "text": "of our commands from we have one master",
    "start": "52500",
    "end": "54539"
  },
  {
    "text": "node and two worker nodes and the node",
    "start": "54539",
    "end": "57539"
  },
  {
    "text": "network is",
    "start": "57539",
    "end": "60079"
  },
  {
    "text": "10.0.1.0 24 the Pod network is",
    "start": "60079",
    "end": "64518"
  },
  {
    "text": "10.48.0.0 24 and finally the service",
    "start": "64519",
    "end": "67920"
  },
  {
    "text": "network is",
    "start": "67920",
    "end": "70159"
  },
  {
    "text": "10.49.0.0 24. the Calico components",
    "start": "70159",
    "end": "73680"
  },
  {
    "text": "whose metrics we're interested in our",
    "start": "73680",
    "end": "75720"
  },
  {
    "text": "Calico node and specifically Felix",
    "start": "75720",
    "end": "78840"
  },
  {
    "text": "Calico typha and Calico Q controllers",
    "start": "78840",
    "end": "82500"
  },
  {
    "text": "as a brief overview of what each of",
    "start": "82500",
    "end": "84420"
  },
  {
    "text": "these components do with the Calico node",
    "start": "84420",
    "end": "86880"
  },
  {
    "text": "runs as a demon set on every cluster",
    "start": "86880",
    "end": "89220"
  },
  {
    "text": "node and Felix which is the component",
    "start": "89220",
    "end": "91799"
  },
  {
    "text": "that we're interested in is a core",
    "start": "91799",
    "end": "93900"
  },
  {
    "text": "process running inside of Calico node",
    "start": "93900",
    "end": "95939"
  },
  {
    "text": "one of the main responsibilities of",
    "start": "95939",
    "end": "98280"
  },
  {
    "text": "Felix is realizing and enforcing Calico",
    "start": "98280",
    "end": "100799"
  },
  {
    "text": "security policies on the data plane now",
    "start": "100799",
    "end": "103560"
  },
  {
    "text": "Calico typher is a caching data store",
    "start": "103560",
    "end": "106020"
  },
  {
    "text": "proxy that sits between the Calico nodes",
    "start": "106020",
    "end": "108240"
  },
  {
    "text": "and the kubernetes API server and really",
    "start": "108240",
    "end": "110759"
  },
  {
    "text": "its main function is to allow for scale",
    "start": "110759",
    "end": "113460"
  },
  {
    "text": "and then finally we have the Calico Q",
    "start": "113460",
    "end": "116280"
  },
  {
    "text": "controllers they monitor the kubernetes",
    "start": "116280",
    "end": "118740"
  },
  {
    "text": "API and they perform actions based on a",
    "start": "118740",
    "end": "121500"
  },
  {
    "text": "cluster state",
    "start": "121500",
    "end": "123180"
  },
  {
    "text": "so I have now sshed into the Bastion",
    "start": "123180",
    "end": "125520"
  },
  {
    "text": "server and to confirm the Bastion",
    "start": "125520",
    "end": "127860"
  },
  {
    "text": "server's Network information we can run",
    "start": "127860",
    "end": "129720"
  },
  {
    "text": "ipaddr",
    "start": "129720",
    "end": "132420"
  },
  {
    "text": "we can see that the Bastion server's IP",
    "start": "132420",
    "end": "134640"
  },
  {
    "text": "address is",
    "start": "134640",
    "end": "135920"
  },
  {
    "text": "10.0.1.10 24 and that's in keeping with",
    "start": "135920",
    "end": "139980"
  },
  {
    "text": "the lab architecture",
    "start": "139980",
    "end": "141840"
  },
  {
    "text": "now it's from the Bastion server that",
    "start": "141840",
    "end": "144480"
  },
  {
    "text": "we're going to run all of our Coupe",
    "start": "144480",
    "end": "145860"
  },
  {
    "text": "Cottle commands and Helm commands to",
    "start": "145860",
    "end": "148379"
  },
  {
    "text": "really build out this infrastructure but",
    "start": "148379",
    "end": "151140"
  },
  {
    "text": "to get a feeling for where we currently",
    "start": "151140",
    "end": "153360"
  },
  {
    "text": "are let's run the command kubecottle get",
    "start": "153360",
    "end": "156480"
  },
  {
    "text": "nodes",
    "start": "156480",
    "end": "159200"
  },
  {
    "text": "so we can see that we've got three nodes",
    "start": "160500",
    "end": "162540"
  },
  {
    "text": "deployed one control plane or Master",
    "start": "162540",
    "end": "165540"
  },
  {
    "text": "node and two worker nodes",
    "start": "165540",
    "end": "167760"
  },
  {
    "text": "and the IP address information is again",
    "start": "167760",
    "end": "170099"
  },
  {
    "text": "in keeping with lab architecture",
    "start": "170099",
    "end": "174080"
  },
  {
    "text": "you may also notice that these three",
    "start": "174080",
    "end": "177060"
  },
  {
    "text": "nodes are in a not ready status",
    "start": "177060",
    "end": "179940"
  },
  {
    "text": "the reason being is because there is no",
    "start": "179940",
    "end": "182280"
  },
  {
    "text": "cni deployed here now we can further",
    "start": "182280",
    "end": "184920"
  },
  {
    "text": "confirm that by running a coupon to get",
    "start": "184920",
    "end": "187500"
  },
  {
    "text": "pods hey",
    "start": "187500",
    "end": "191000"
  },
  {
    "text": "here we can see that we've got a number",
    "start": "191580",
    "end": "193620"
  },
  {
    "text": "of PODS that are indeed running but the",
    "start": "193620",
    "end": "197040"
  },
  {
    "text": "parts that are running are actually",
    "start": "197040",
    "end": "198860"
  },
  {
    "text": "reusing the IP address from the node",
    "start": "198860",
    "end": "202140"
  },
  {
    "text": "that they're on so these pods are host",
    "start": "202140",
    "end": "204780"
  },
  {
    "text": "networked pods",
    "start": "204780",
    "end": "207599"
  },
  {
    "text": "the two core DNS pods are in a pending",
    "start": "207599",
    "end": "210239"
  },
  {
    "text": "State and the reason is because they're",
    "start": "210239",
    "end": "212280"
  },
  {
    "text": "trying to get an IP address from the Pod",
    "start": "212280",
    "end": "214140"
  },
  {
    "text": "network but because we've got no cni",
    "start": "214140",
    "end": "216360"
  },
  {
    "text": "deployed there's no way that they can",
    "start": "216360",
    "end": "218760"
  },
  {
    "text": "get an IP address from that pod Network",
    "start": "218760",
    "end": "222180"
  },
  {
    "text": "so let's do that let's deploy Calico",
    "start": "222180",
    "end": "225540"
  },
  {
    "text": "open source and get a cni deployed and",
    "start": "225540",
    "end": "228239"
  },
  {
    "text": "get all of these pods up and running",
    "start": "228239",
    "end": "232580"
  },
  {
    "text": "as I had mentioned we're going to use",
    "start": "233099",
    "end": "234900"
  },
  {
    "text": "Helm to deploy calacle open source and",
    "start": "234900",
    "end": "238080"
  },
  {
    "text": "the first step to doing that is adding",
    "start": "238080",
    "end": "240900"
  },
  {
    "text": "the project Calico Helm repo",
    "start": "240900",
    "end": "245720"
  },
  {
    "text": "once we've got that done we're going to",
    "start": "246299",
    "end": "248220"
  },
  {
    "text": "create a namespace called tiger operator",
    "start": "248220",
    "end": "252840"
  },
  {
    "text": "and it's this is the namespace that",
    "start": "252840",
    "end": "254879"
  },
  {
    "text": "we're going to Target our Helm installed",
    "start": "254879",
    "end": "257340"
  },
  {
    "text": "into",
    "start": "257340",
    "end": "258299"
  },
  {
    "text": "so if we run the command Helm install",
    "start": "258299",
    "end": "261919"
  },
  {
    "text": "Calico project Calico tigera operator",
    "start": "261919",
    "end": "265560"
  },
  {
    "text": "I've chosen the latest version available",
    "start": "265560",
    "end": "267540"
  },
  {
    "text": "at the moment and we're going to install",
    "start": "267540",
    "end": "269639"
  },
  {
    "text": "it into the namespace tigera operator",
    "start": "269639",
    "end": "274280"
  },
  {
    "text": "now the helm install has completed",
    "start": "282060",
    "end": "284759"
  },
  {
    "text": "where we can check the deployment status",
    "start": "284759",
    "end": "286620"
  },
  {
    "text": "by running command cubecottle get tigera",
    "start": "286620",
    "end": "289979"
  },
  {
    "text": "status",
    "start": "289979",
    "end": "292160"
  },
  {
    "text": "so here we can see the API server",
    "start": "292560",
    "end": "295560"
  },
  {
    "text": "resource and the Calico resource none of",
    "start": "295560",
    "end": "298979"
  },
  {
    "text": "which are available and the Calico",
    "start": "298979",
    "end": "300600"
  },
  {
    "text": "resource is progressing",
    "start": "300600",
    "end": "302699"
  },
  {
    "text": "we can get a deeper understanding of",
    "start": "302699",
    "end": "304740"
  },
  {
    "text": "what's going on by running Coupe cuddle",
    "start": "304740",
    "end": "306720"
  },
  {
    "text": "getpod minus a",
    "start": "306720",
    "end": "308759"
  },
  {
    "text": "and here we can see all of the Calico",
    "start": "308759",
    "end": "312240"
  },
  {
    "text": "components that are being deployed",
    "start": "312240",
    "end": "315000"
  },
  {
    "text": "so we've got the Calico API server",
    "start": "315000",
    "end": "317820"
  },
  {
    "text": "he's got the Calico Coupe controllers",
    "start": "317820",
    "end": "320120"
  },
  {
    "text": "Calico nodes Calico typha and the CSI no",
    "start": "320120",
    "end": "324180"
  },
  {
    "text": "drivers",
    "start": "324180",
    "end": "326100"
  },
  {
    "text": "now because the Calico node pods have",
    "start": "326100",
    "end": "329699"
  },
  {
    "text": "been deployed if we rerun",
    "start": "329699",
    "end": "332100"
  },
  {
    "text": "the kukat will get tigera status",
    "start": "332100",
    "end": "335100"
  },
  {
    "text": "command we'll now see that the Calico",
    "start": "335100",
    "end": "338280"
  },
  {
    "text": "resource is available we can also see",
    "start": "338280",
    "end": "340680"
  },
  {
    "text": "that the API resource is available too",
    "start": "340680",
    "end": "342660"
  },
  {
    "text": "so if we rerun the get pods we now see",
    "start": "342660",
    "end": "346199"
  },
  {
    "text": "that everything is running",
    "start": "346199",
    "end": "348800"
  },
  {
    "text": "to confirm completely if we do a coupe",
    "start": "348800",
    "end": "351539"
  },
  {
    "text": "coddle get nodes",
    "start": "351539",
    "end": "354180"
  },
  {
    "text": "we can see that now all nodes are in a",
    "start": "354180",
    "end": "357539"
  },
  {
    "text": "ready state",
    "start": "357539",
    "end": "360139"
  },
  {
    "text": "so with Calico open source deployed and",
    "start": "360240",
    "end": "363060"
  },
  {
    "text": "all the pods up and running let's now",
    "start": "363060",
    "end": "365100"
  },
  {
    "text": "continue on to deploying Prometheus",
    "start": "365100",
    "end": "368160"
  },
  {
    "text": "again we're going to be using Helm to",
    "start": "368160",
    "end": "370620"
  },
  {
    "text": "deploy Prometheus and again the first",
    "start": "370620",
    "end": "373500"
  },
  {
    "text": "step is going to be to add the repo",
    "start": "373500",
    "end": "378680"
  },
  {
    "text": "once that's added we're going to create",
    "start": "378780",
    "end": "381600"
  },
  {
    "text": "a namespace monitoring",
    "start": "381600",
    "end": "384600"
  },
  {
    "text": "where we're going to Target the",
    "start": "384600",
    "end": "386639"
  },
  {
    "text": "Prometheus deployment",
    "start": "386639",
    "end": "390080"
  },
  {
    "text": "we then run the helm install Prometheus",
    "start": "390840",
    "end": "394139"
  },
  {
    "text": "stack",
    "start": "394139",
    "end": "395400"
  },
  {
    "text": "into the monitoring namespace",
    "start": "395400",
    "end": "400039"
  },
  {
    "text": "so once this is completed we can check",
    "start": "403319",
    "end": "407039"
  },
  {
    "text": "the status of Prometheus by",
    "start": "407039",
    "end": "410160"
  },
  {
    "text": "running a coupe coddle",
    "start": "410160",
    "end": "412380"
  },
  {
    "text": "get Prometheus minus n monitoring",
    "start": "412380",
    "end": "417319"
  },
  {
    "text": "so we can see here that we've got the",
    "start": "417720",
    "end": "419340"
  },
  {
    "text": "Prometheus stack Cube prom Prometheus",
    "start": "419340",
    "end": "421560"
  },
  {
    "text": "and we've got the version",
    "start": "421560",
    "end": "423120"
  },
  {
    "text": "got one desired nothing is ready yet so",
    "start": "423120",
    "end": "426060"
  },
  {
    "text": "it's still going on",
    "start": "426060",
    "end": "428039"
  },
  {
    "text": "we can check further by checking on the",
    "start": "428039",
    "end": "430680"
  },
  {
    "text": "pods in the monitoring namespace and",
    "start": "430680",
    "end": "433620"
  },
  {
    "text": "here now we can see that we've alert",
    "start": "433620",
    "end": "436440"
  },
  {
    "text": "manager that's running",
    "start": "436440",
    "end": "438780"
  },
  {
    "text": "got the Prometheus stack Cube prom",
    "start": "438780",
    "end": "441539"
  },
  {
    "text": "Prometheus",
    "start": "441539",
    "end": "442919"
  },
  {
    "text": "it's also running we have grafana that's",
    "start": "442919",
    "end": "445860"
  },
  {
    "text": "running",
    "start": "445860",
    "end": "446699"
  },
  {
    "text": "we've got the Prometheus operator",
    "start": "446699",
    "end": "448860"
  },
  {
    "text": "running the state metrics and then the",
    "start": "448860",
    "end": "451919"
  },
  {
    "text": "Prometheus node exporter pods all",
    "start": "451919",
    "end": "454199"
  },
  {
    "text": "running",
    "start": "454199",
    "end": "455220"
  },
  {
    "text": "so now that they're all running we",
    "start": "455220",
    "end": "457440"
  },
  {
    "text": "should get a good",
    "start": "457440",
    "end": "461039"
  },
  {
    "text": "output from here and indeed we see now",
    "start": "461039",
    "end": "463680"
  },
  {
    "text": "that it's ready",
    "start": "463680",
    "end": "466819"
  },
  {
    "text": "we can also check grafana and to check",
    "start": "467039",
    "end": "469979"
  },
  {
    "text": "rafana we can take a look at the",
    "start": "469979",
    "end": "471900"
  },
  {
    "text": "services that are in the monitoring",
    "start": "471900",
    "end": "473520"
  },
  {
    "text": "namespace",
    "start": "473520",
    "end": "474840"
  },
  {
    "text": "and here we can see all the services",
    "start": "474840",
    "end": "476819"
  },
  {
    "text": "deployed one of which being grafana",
    "start": "476819",
    "end": "480960"
  },
  {
    "text": "as a cluster AP address and an IP",
    "start": "480960",
    "end": "483180"
  },
  {
    "text": "address listening on Port 80.",
    "start": "483180",
    "end": "486539"
  },
  {
    "text": "now that we have Calico Prometheus and",
    "start": "486539",
    "end": "488759"
  },
  {
    "text": "grafana deployed let's look at how we",
    "start": "488759",
    "end": "491220"
  },
  {
    "text": "can expose both Prometheus and grafana",
    "start": "491220",
    "end": "493259"
  },
  {
    "text": "so that we have access to their uis",
    "start": "493259",
    "end": "496500"
  },
  {
    "text": "in this lab we already have an Ingress",
    "start": "496500",
    "end": "498660"
  },
  {
    "text": "controller deployed as you can see here",
    "start": "498660",
    "end": "501360"
  },
  {
    "text": "so I'm going to expose both Prometheus",
    "start": "501360",
    "end": "504060"
  },
  {
    "text": "and grafana using this Ingress",
    "start": "504060",
    "end": "506580"
  },
  {
    "text": "but there's no need to use an Ingress if",
    "start": "506580",
    "end": "508919"
  },
  {
    "text": "you don't wish to you can always use a",
    "start": "508919",
    "end": "511319"
  },
  {
    "text": "node pore for a load balancer to",
    "start": "511319",
    "end": "513180"
  },
  {
    "text": "accomplish the exact same task",
    "start": "513180",
    "end": "515839"
  },
  {
    "text": "now let's take a look at the Ingress",
    "start": "515839",
    "end": "518700"
  },
  {
    "text": "needed to expose Prometheus",
    "start": "518700",
    "end": "522860"
  },
  {
    "text": "so you can see that it's of kind Ingress",
    "start": "526440",
    "end": "528899"
  },
  {
    "text": "we've named a Prometheus service and",
    "start": "528899",
    "end": "531300"
  },
  {
    "text": "we're going to deploy it into the",
    "start": "531300",
    "end": "532680"
  },
  {
    "text": "monitoring namespace",
    "start": "532680",
    "end": "534720"
  },
  {
    "text": "once the Ingress is fully up and running",
    "start": "534720",
    "end": "537060"
  },
  {
    "text": "we should be able to browse to this",
    "start": "537060",
    "end": "539160"
  },
  {
    "text": "holster URL to access the Prometheus UI",
    "start": "539160",
    "end": "543240"
  },
  {
    "text": "and down here describes",
    "start": "543240",
    "end": "545940"
  },
  {
    "text": "what service the Ingress is going to",
    "start": "545940",
    "end": "548279"
  },
  {
    "text": "match to so if we run a coupe cuddle get",
    "start": "548279",
    "end": "551220"
  },
  {
    "text": "service",
    "start": "551220",
    "end": "552180"
  },
  {
    "text": "on the monitoring namespace",
    "start": "552180",
    "end": "555000"
  },
  {
    "text": "we can see that this service name",
    "start": "555000",
    "end": "557660"
  },
  {
    "text": "matches to this cluster IP service and",
    "start": "557660",
    "end": "561839"
  },
  {
    "text": "we can see that that service is",
    "start": "561839",
    "end": "563160"
  },
  {
    "text": "listening on TCP port 1990.",
    "start": "563160",
    "end": "566339"
  },
  {
    "text": "now if we want to look further into that",
    "start": "566339",
    "end": "568200"
  },
  {
    "text": "we could run a coup cuddle get endpoints",
    "start": "568200",
    "end": "571019"
  },
  {
    "text": "for that service",
    "start": "571019",
    "end": "574339"
  },
  {
    "text": "and we can see that it has been backed",
    "start": "578519",
    "end": "580800"
  },
  {
    "text": "by this IP address",
    "start": "580800",
    "end": "583440"
  },
  {
    "text": "if we want to look even further again we",
    "start": "583440",
    "end": "585839"
  },
  {
    "text": "could do a coupon to get pods",
    "start": "585839",
    "end": "588060"
  },
  {
    "text": "minus n monitoring minus or wide and",
    "start": "588060",
    "end": "591899"
  },
  {
    "text": "then grep for that IP address and there",
    "start": "591899",
    "end": "595500"
  },
  {
    "text": "we're going to see the Pod that",
    "start": "595500",
    "end": "598680"
  },
  {
    "text": "connects the service",
    "start": "598680",
    "end": "600120"
  },
  {
    "text": "so this is the pod that's backing this",
    "start": "600120",
    "end": "603420"
  },
  {
    "text": "service and this part is the Prometheus",
    "start": "603420",
    "end": "606240"
  },
  {
    "text": "server itself",
    "start": "606240",
    "end": "607920"
  },
  {
    "text": "okay",
    "start": "607920",
    "end": "609560"
  },
  {
    "text": "so let's now",
    "start": "609560",
    "end": "611940"
  },
  {
    "text": "apply",
    "start": "611940",
    "end": "613140"
  },
  {
    "text": "that Ingress",
    "start": "613140",
    "end": "616279"
  },
  {
    "text": "now the Ingress is going to take a",
    "start": "620760",
    "end": "622320"
  },
  {
    "text": "couple of seconds to apply we can",
    "start": "622320",
    "end": "624000"
  },
  {
    "text": "monitor that by running a get Ingress",
    "start": "624000",
    "end": "628019"
  },
  {
    "text": "and we can see that this is the Ingress",
    "start": "628019",
    "end": "630839"
  },
  {
    "text": "that's currently being deployed but",
    "start": "630839",
    "end": "632880"
  },
  {
    "text": "we've got no addresses associated with",
    "start": "632880",
    "end": "634860"
  },
  {
    "text": "it so if we were to open a browser to",
    "start": "634860",
    "end": "637860"
  },
  {
    "text": "this location we wouldn't see anything",
    "start": "637860",
    "end": "642120"
  },
  {
    "text": "take a look again and eventually we're",
    "start": "642120",
    "end": "644339"
  },
  {
    "text": "going to see addresses that are attached",
    "start": "644339",
    "end": "646980"
  },
  {
    "text": "to it and once they're attached to it",
    "start": "646980",
    "end": "648600"
  },
  {
    "text": "then we know that we've got access to it",
    "start": "648600",
    "end": "653880"
  },
  {
    "text": "so as you see here we now have these two",
    "start": "653880",
    "end": "657899"
  },
  {
    "text": "IP addresses attached to this Ingress so",
    "start": "657899",
    "end": "660839"
  },
  {
    "text": "if we were to open up a browser",
    "start": "660839",
    "end": "663959"
  },
  {
    "text": "to this location",
    "start": "663959",
    "end": "666680"
  },
  {
    "text": "we should now see the Prometheus UI and",
    "start": "668760",
    "end": "671579"
  },
  {
    "text": "indeed we do",
    "start": "671579",
    "end": "673500"
  },
  {
    "text": "we can even check the targets that",
    "start": "673500",
    "end": "676320"
  },
  {
    "text": "Prometheus already has and it's quite",
    "start": "676320",
    "end": "678779"
  },
  {
    "text": "interesting because we've deployed it",
    "start": "678779",
    "end": "680540"
  },
  {
    "text": "through Helm and it was the full stack",
    "start": "680540",
    "end": "683700"
  },
  {
    "text": "it's already monitoring itself so it's",
    "start": "683700",
    "end": "686220"
  },
  {
    "text": "already monitoring alert manager it's",
    "start": "686220",
    "end": "688860"
  },
  {
    "text": "monitoring the Prometheus operator",
    "start": "688860",
    "end": "690959"
  },
  {
    "text": "Prometheus server the state metrics and",
    "start": "690959",
    "end": "693180"
  },
  {
    "text": "a node export",
    "start": "693180",
    "end": "694860"
  },
  {
    "text": "it's also monitoring some kubernetes",
    "start": "694860",
    "end": "697440"
  },
  {
    "text": "components like kublish and the API",
    "start": "697440",
    "end": "700380"
  },
  {
    "text": "server and core DNS so this is all great",
    "start": "700380",
    "end": "703860"
  },
  {
    "text": "what we want to do is we want to add the",
    "start": "703860",
    "end": "706860"
  },
  {
    "text": "Calico components as targets here but",
    "start": "706860",
    "end": "710100"
  },
  {
    "text": "before we do that let's first expose",
    "start": "710100",
    "end": "712620"
  },
  {
    "text": "grafana as well",
    "start": "712620",
    "end": "715019"
  },
  {
    "text": "the next step is to expose grafana using",
    "start": "715019",
    "end": "717480"
  },
  {
    "text": "our Ingress and it's going to be very",
    "start": "717480",
    "end": "719519"
  },
  {
    "text": "similar to how we expose Prometheus",
    "start": "719519",
    "end": "721500"
  },
  {
    "text": "previously",
    "start": "721500",
    "end": "723480"
  },
  {
    "text": "let's take a look at the Ingress yaml",
    "start": "723480",
    "end": "726600"
  },
  {
    "text": "needed for grafana",
    "start": "726600",
    "end": "729560"
  },
  {
    "text": "we can see it's of kind Ingress again",
    "start": "733320",
    "end": "736260"
  },
  {
    "text": "we're calling this grafana service and",
    "start": "736260",
    "end": "739140"
  },
  {
    "text": "we're deploying it into the monitoring",
    "start": "739140",
    "end": "740700"
  },
  {
    "text": "name space",
    "start": "740700",
    "end": "742380"
  },
  {
    "text": "this will be the whole store the URL",
    "start": "742380",
    "end": "744540"
  },
  {
    "text": "that we're going to use to view the",
    "start": "744540",
    "end": "746459"
  },
  {
    "text": "grafana UI once the Ingress is fully up",
    "start": "746459",
    "end": "749579"
  },
  {
    "text": "and running",
    "start": "749579",
    "end": "751019"
  },
  {
    "text": "and again we can see that this ingresses",
    "start": "751019",
    "end": "753060"
  },
  {
    "text": "matching the service named Prometheus",
    "start": "753060",
    "end": "755519"
  },
  {
    "text": "stack grafana and again we can check the",
    "start": "755519",
    "end": "758040"
  },
  {
    "text": "services in the monitoring namespace",
    "start": "758040",
    "end": "761640"
  },
  {
    "text": "and we can see that this service matches",
    "start": "761640",
    "end": "764579"
  },
  {
    "text": "with this cluster IP service",
    "start": "764579",
    "end": "767519"
  },
  {
    "text": "and this cluster IP service is listening",
    "start": "767519",
    "end": "769560"
  },
  {
    "text": "on TCP port 80.",
    "start": "769560",
    "end": "772800"
  },
  {
    "text": "so we could look through the endpoints",
    "start": "772800",
    "end": "775620"
  },
  {
    "text": "and the pods that are backing the",
    "start": "775620",
    "end": "777240"
  },
  {
    "text": "service but for now let's just apply the",
    "start": "777240",
    "end": "781079"
  },
  {
    "text": "Ingress grafana yaml and take a look at",
    "start": "781079",
    "end": "784440"
  },
  {
    "text": "the grafana UI",
    "start": "784440",
    "end": "787639"
  },
  {
    "text": "this will take a few seconds so what we",
    "start": "794940",
    "end": "798180"
  },
  {
    "text": "can do to monitor it is run a coupe",
    "start": "798180",
    "end": "800279"
  },
  {
    "text": "cuddle get Ingress minus n monitoring",
    "start": "800279",
    "end": "805700"
  },
  {
    "text": "and we can see that the Prometheus",
    "start": "805700",
    "end": "808260"
  },
  {
    "text": "service of course already has IP",
    "start": "808260",
    "end": "810839"
  },
  {
    "text": "addresses um attached to it but the",
    "start": "810839",
    "end": "813120"
  },
  {
    "text": "grafana service that we just applied has",
    "start": "813120",
    "end": "816180"
  },
  {
    "text": "nothing so let's wait until that's",
    "start": "816180",
    "end": "818220"
  },
  {
    "text": "populated and then we'll look into the",
    "start": "818220",
    "end": "820079"
  },
  {
    "text": "grafana UI",
    "start": "820079",
    "end": "822980"
  },
  {
    "text": "so now we can see that both grafana",
    "start": "829079",
    "end": "832139"
  },
  {
    "text": "service and Prometheus service have",
    "start": "832139",
    "end": "834360"
  },
  {
    "text": "addresses associated with them so let's",
    "start": "834360",
    "end": "836940"
  },
  {
    "text": "now open up this URL to view the grafana",
    "start": "836940",
    "end": "840839"
  },
  {
    "text": "UI",
    "start": "840839",
    "end": "843320"
  },
  {
    "text": "and were presented with the grafana UI",
    "start": "855060",
    "end": "857160"
  },
  {
    "text": "here we can take a look of some things",
    "start": "857160",
    "end": "859560"
  },
  {
    "text": "for example we can take a look at the",
    "start": "859560",
    "end": "861660"
  },
  {
    "text": "data sources",
    "start": "861660",
    "end": "863040"
  },
  {
    "text": "and what's interesting is that we're",
    "start": "863040",
    "end": "865440"
  },
  {
    "text": "already connected to the Prometheus data",
    "start": "865440",
    "end": "867600"
  },
  {
    "text": "source because",
    "start": "867600",
    "end": "868800"
  },
  {
    "text": "we deploy this with helm",
    "start": "868800",
    "end": "871079"
  },
  {
    "text": "everything is aware of everything else",
    "start": "871079",
    "end": "872940"
  },
  {
    "text": "so this grafana is aware of the",
    "start": "872940",
    "end": "875399"
  },
  {
    "text": "Prometheus session was deployed with and",
    "start": "875399",
    "end": "877560"
  },
  {
    "text": "is configured the data source for",
    "start": "877560",
    "end": "879779"
  },
  {
    "text": "Prometheus",
    "start": "879779",
    "end": "881519"
  },
  {
    "text": "we can also take a look at some built-in",
    "start": "881519",
    "end": "885360"
  },
  {
    "text": "dashboards so we've got core DNS",
    "start": "885360",
    "end": "887820"
  },
  {
    "text": "dashboards kubernetes API server Etc and",
    "start": "887820",
    "end": "891959"
  },
  {
    "text": "if we take a look at one of the",
    "start": "891959",
    "end": "893459"
  },
  {
    "text": "dashboards we can see that we're already",
    "start": "893459",
    "end": "894899"
  },
  {
    "text": "getting metrics",
    "start": "894899",
    "end": "897139"
  },
  {
    "text": "all we want to do now is we want to",
    "start": "897139",
    "end": "900660"
  },
  {
    "text": "allow Prometheus to pull in the Calico",
    "start": "900660",
    "end": "903360"
  },
  {
    "text": "OSS metrics or from Felix from typhen",
    "start": "903360",
    "end": "906779"
  },
  {
    "text": "from Cube controllers and once those",
    "start": "906779",
    "end": "909720"
  },
  {
    "text": "targets are discovered and metrics are",
    "start": "909720",
    "end": "911579"
  },
  {
    "text": "being pulled in we will create a",
    "start": "911579",
    "end": "913680"
  },
  {
    "text": "dashboard for",
    "start": "913680",
    "end": "915959"
  },
  {
    "text": "Felix and for typher and take a look at",
    "start": "915959",
    "end": "918480"
  },
  {
    "text": "what type of data and metrics that we",
    "start": "918480",
    "end": "921180"
  },
  {
    "text": "can see",
    "start": "921180",
    "end": "922800"
  },
  {
    "text": "let's take stock of what we've done so",
    "start": "922800",
    "end": "924600"
  },
  {
    "text": "far",
    "start": "924600",
    "end": "925500"
  },
  {
    "text": "we first deployed the Calico components",
    "start": "925500",
    "end": "927480"
  },
  {
    "text": "using helm and this gave us components",
    "start": "927480",
    "end": "930000"
  },
  {
    "text": "such as Calico typher Calico Cube",
    "start": "930000",
    "end": "933120"
  },
  {
    "text": "controller and a Calico node pod on",
    "start": "933120",
    "end": "936300"
  },
  {
    "text": "every cluster node",
    "start": "936300",
    "end": "938339"
  },
  {
    "text": "we then deploy the Prometheus stack",
    "start": "938339",
    "end": "940139"
  },
  {
    "text": "using helmet deployed components such as",
    "start": "940139",
    "end": "942260"
  },
  {
    "text": "Prometheus grafana alert manager and",
    "start": "942260",
    "end": "945540"
  },
  {
    "text": "node exporters",
    "start": "945540",
    "end": "946920"
  },
  {
    "text": "we then configured an Ingress to allow",
    "start": "946920",
    "end": "949320"
  },
  {
    "text": "UI access to both Prometheus and grafana",
    "start": "949320",
    "end": "952680"
  },
  {
    "text": "and from looking at the Prometheus UI we",
    "start": "952680",
    "end": "954779"
  },
  {
    "text": "could see many targets have already been",
    "start": "954779",
    "end": "956519"
  },
  {
    "text": "discovered both from the Prometheus",
    "start": "956519",
    "end": "958380"
  },
  {
    "text": "stack itself and from the kubernetes",
    "start": "958380",
    "end": "959940"
  },
  {
    "text": "cluster",
    "start": "959940",
    "end": "961079"
  },
  {
    "text": "but now we want to add the Calico",
    "start": "961079",
    "end": "963360"
  },
  {
    "text": "components to these Prometheus targets",
    "start": "963360",
    "end": "966480"
  },
  {
    "text": "next we want to get a Calico component",
    "start": "966480",
    "end": "968880"
  },
  {
    "text": "metrics into our Prometheus deployment",
    "start": "968880",
    "end": "970980"
  },
  {
    "text": "and to do this we need to follow three",
    "start": "970980",
    "end": "973019"
  },
  {
    "text": "steps first we need to enable Prometheus",
    "start": "973019",
    "end": "975839"
  },
  {
    "text": "metrics on both Felix and typher and to",
    "start": "975839",
    "end": "979079"
  },
  {
    "text": "do this we're going to edit the Phoenix",
    "start": "979079",
    "end": "980639"
  },
  {
    "text": "configuration resource to enable Felix",
    "start": "980639",
    "end": "982920"
  },
  {
    "text": "metrics and we'll edit the installation",
    "start": "982920",
    "end": "985079"
  },
  {
    "text": "resource to enable type metrics after",
    "start": "985079",
    "end": "987600"
  },
  {
    "text": "this we need to create services for both",
    "start": "987600",
    "end": "989820"
  },
  {
    "text": "Felix and taifa and it's going to be",
    "start": "989820",
    "end": "991980"
  },
  {
    "text": "these services that Prometheus will use",
    "start": "991980",
    "end": "994320"
  },
  {
    "text": "to discover the endpoints and what ports",
    "start": "994320",
    "end": "997380"
  },
  {
    "text": "on that endpoint it needs to scrape do",
    "start": "997380",
    "end": "999959"
  },
  {
    "text": "note that these two first steps are",
    "start": "999959",
    "end": "1001940"
  },
  {
    "text": "completed by default for Calico Cube",
    "start": "1001940",
    "end": "1004459"
  },
  {
    "text": "controller so we don't need to do",
    "start": "1004459",
    "end": "1005600"
  },
  {
    "text": "anything further there",
    "start": "1005600",
    "end": "1007279"
  },
  {
    "text": "and then finally we create service",
    "start": "1007279",
    "end": "1009139"
  },
  {
    "text": "monitor resources that will tell",
    "start": "1009139",
    "end": "1010940"
  },
  {
    "text": "Prometheus about the Felix typher and",
    "start": "1010940",
    "end": "1013639"
  },
  {
    "text": "Calico Cube controller services",
    "start": "1013639",
    "end": "1016040"
  },
  {
    "text": "so the service monitors are really",
    "start": "1016040",
    "end": "1018079"
  },
  {
    "text": "what's tying all these pieces together",
    "start": "1018079",
    "end": "1021380"
  },
  {
    "text": "so let's now enable the metrics for both",
    "start": "1021380",
    "end": "1023600"
  },
  {
    "text": "Felix and typher",
    "start": "1023600",
    "end": "1025699"
  },
  {
    "text": "as we had mentioned",
    "start": "1025699",
    "end": "1027319"
  },
  {
    "text": "for Felix we're going to patch the Felix",
    "start": "1027319",
    "end": "1029540"
  },
  {
    "text": "configuration resource now we're going",
    "start": "1029540",
    "end": "1031760"
  },
  {
    "text": "to set the Prometheus metrics to be",
    "start": "1031760",
    "end": "1033438"
  },
  {
    "text": "enabled",
    "start": "1033439",
    "end": "1035918"
  },
  {
    "text": "pifer we need to patch the installation",
    "start": "1036439",
    "end": "1038900"
  },
  {
    "text": "resource",
    "start": "1038900",
    "end": "1041559"
  },
  {
    "text": "and here we're patching it by specifying",
    "start": "1042319",
    "end": "1044540"
  },
  {
    "text": "the Tifa metrics port to 1993.",
    "start": "1044540",
    "end": "1048199"
  },
  {
    "text": "now once we've got them enabled we need",
    "start": "1048199",
    "end": "1050660"
  },
  {
    "text": "to create services for both Felix and",
    "start": "1050660",
    "end": "1053600"
  },
  {
    "text": "typha for Prometheus to discover those",
    "start": "1053600",
    "end": "1055940"
  },
  {
    "text": "endpoints",
    "start": "1055940",
    "end": "1057140"
  },
  {
    "text": "so let's take a look at the Felix",
    "start": "1057140",
    "end": "1059179"
  },
  {
    "text": "service that we're going to create",
    "start": "1059179",
    "end": "1062860"
  },
  {
    "text": "so you can see that it's of kind service",
    "start": "1064820",
    "end": "1066620"
  },
  {
    "text": "it's called felixmetrics SVC it's in the",
    "start": "1066620",
    "end": "1070220"
  },
  {
    "text": "Calico system namespace and the label is",
    "start": "1070220",
    "end": "1073160"
  },
  {
    "text": "K8 app Calico Felix",
    "start": "1073160",
    "end": "1076220"
  },
  {
    "text": "we've also specified the metrics port to",
    "start": "1076220",
    "end": "1078799"
  },
  {
    "text": "be 1991 and that's the TCP Port that",
    "start": "1078799",
    "end": "1082220"
  },
  {
    "text": "Prometheus is going to scrape to get",
    "start": "1082220",
    "end": "1084200"
  },
  {
    "text": "those metrics",
    "start": "1084200",
    "end": "1086200"
  },
  {
    "text": "so let's now apply that",
    "start": "1086200",
    "end": "1090279"
  },
  {
    "text": "let's now take a look at the Piper",
    "start": "1094640",
    "end": "1097880"
  },
  {
    "text": "metrics oops sorry",
    "start": "1097880",
    "end": "1101679"
  },
  {
    "text": "let's now take a look at the typher",
    "start": "1103760",
    "end": "1105679"
  },
  {
    "text": "service that we're going to create",
    "start": "1105679",
    "end": "1108820"
  },
  {
    "text": "again it's of kind service we're calling",
    "start": "1111860",
    "end": "1114080"
  },
  {
    "text": "it typho metrics SVC in the chemical",
    "start": "1114080",
    "end": "1116480"
  },
  {
    "text": "system namespace the label is k8s app",
    "start": "1116480",
    "end": "1119660"
  },
  {
    "text": "type for metrics and again we specify",
    "start": "1119660",
    "end": "1122360"
  },
  {
    "text": "the metroport as 1993.",
    "start": "1122360",
    "end": "1125360"
  },
  {
    "text": "so let's apply that also",
    "start": "1125360",
    "end": "1129400"
  },
  {
    "text": "now with those Services created we're",
    "start": "1138500",
    "end": "1141679"
  },
  {
    "text": "ready to grab metrics from those",
    "start": "1141679",
    "end": "1143960"
  },
  {
    "text": "endpoints let's take a quick look",
    "start": "1143960",
    "end": "1146600"
  },
  {
    "text": "at the services in the calicore system",
    "start": "1146600",
    "end": "1149059"
  },
  {
    "text": "namespace and we can see that we've got",
    "start": "1149059",
    "end": "1152780"
  },
  {
    "text": "both Felix metrics and type metrics and",
    "start": "1152780",
    "end": "1155660"
  },
  {
    "text": "notice that their cluster IP type but",
    "start": "1155660",
    "end": "1157760"
  },
  {
    "text": "they've got no IP addresses we're not",
    "start": "1157760",
    "end": "1159860"
  },
  {
    "text": "really using them from a networking",
    "start": "1159860",
    "end": "1161960"
  },
  {
    "text": "perspective we're really just using them",
    "start": "1161960",
    "end": "1163760"
  },
  {
    "text": "so that we can discover the endpoints",
    "start": "1163760",
    "end": "1166039"
  },
  {
    "text": "and we can see that it's 1991 and 1993.",
    "start": "1166039",
    "end": "1170000"
  },
  {
    "text": "now notice the Calico Cube controller",
    "start": "1170000",
    "end": "1172700"
  },
  {
    "text": "metrics is already exposing the metrics",
    "start": "1172700",
    "end": "1175960"
  },
  {
    "text": "TCP Porsche so we don't need to do",
    "start": "1175960",
    "end": "1178880"
  },
  {
    "text": "anything there",
    "start": "1178880",
    "end": "1180080"
  },
  {
    "text": "if we run a show labels",
    "start": "1180080",
    "end": "1183700"
  },
  {
    "text": "we can also see the labels that the",
    "start": "1186620",
    "end": "1189200"
  },
  {
    "text": "service monitor is going to reference to",
    "start": "1189200",
    "end": "1191480"
  },
  {
    "text": "pick up those endpoints",
    "start": "1191480",
    "end": "1193960"
  },
  {
    "text": "so now that we've created the services",
    "start": "1193960",
    "end": "1196280"
  },
  {
    "text": "we've enabled the metrics let's create",
    "start": "1196280",
    "end": "1198080"
  },
  {
    "text": "the service monitors so let's take a",
    "start": "1198080",
    "end": "1200059"
  },
  {
    "text": "look",
    "start": "1200059",
    "end": "1202179"
  },
  {
    "text": "so here's the Phoenix service monitor",
    "start": "1205280",
    "end": "1208640"
  },
  {
    "text": "we can see that it's called Felix",
    "start": "1208640",
    "end": "1211460"
  },
  {
    "text": "service monitor it's in the monitoring",
    "start": "1211460",
    "end": "1213440"
  },
  {
    "text": "namespace",
    "start": "1213440",
    "end": "1214760"
  },
  {
    "text": "and what it's doing is it's selecting",
    "start": "1214760",
    "end": "1216860"
  },
  {
    "text": "the Calico system namespace and then",
    "start": "1216860",
    "end": "1219559"
  },
  {
    "text": "it's selecting a service based on this",
    "start": "1219559",
    "end": "1222440"
  },
  {
    "text": "label and we can see here that that is",
    "start": "1222440",
    "end": "1225080"
  },
  {
    "text": "going to be the same",
    "start": "1225080",
    "end": "1226520"
  },
  {
    "text": "as this",
    "start": "1226520",
    "end": "1228080"
  },
  {
    "text": "now something to be aware of here is",
    "start": "1228080",
    "end": "1230600"
  },
  {
    "text": "this label up here the release",
    "start": "1230600",
    "end": "1232160"
  },
  {
    "text": "Prometheus stack",
    "start": "1232160",
    "end": "1234020"
  },
  {
    "text": "when we create these service monitors",
    "start": "1234020",
    "end": "1236360"
  },
  {
    "text": "and we're creating them in the",
    "start": "1236360",
    "end": "1238640"
  },
  {
    "text": "monitoring namespace it's this label",
    "start": "1238640",
    "end": "1241400"
  },
  {
    "text": "that's telling Prometheus that it can",
    "start": "1241400",
    "end": "1244100"
  },
  {
    "text": "use this service Monitor and the",
    "start": "1244100",
    "end": "1246200"
  },
  {
    "text": "information within the service monitor",
    "start": "1246200",
    "end": "1247940"
  },
  {
    "text": "to grab new targets",
    "start": "1247940",
    "end": "1251360"
  },
  {
    "text": "so let's apply this",
    "start": "1251360",
    "end": "1255520"
  },
  {
    "text": "now if we take a look at the other",
    "start": "1263780",
    "end": "1265880"
  },
  {
    "text": "service monitors we'll see they're very",
    "start": "1265880",
    "end": "1267500"
  },
  {
    "text": "similar",
    "start": "1267500",
    "end": "1268460"
  },
  {
    "text": "let's look at typher so again it's a",
    "start": "1268460",
    "end": "1271700"
  },
  {
    "text": "service monitor again we've got the",
    "start": "1271700",
    "end": "1273500"
  },
  {
    "text": "release Prometheus stack which tells",
    "start": "1273500",
    "end": "1275480"
  },
  {
    "text": "Prometheus that it can use a service",
    "start": "1275480",
    "end": "1277220"
  },
  {
    "text": "monitor",
    "start": "1277220",
    "end": "1278720"
  },
  {
    "text": "it's called taifa service monitor",
    "start": "1278720",
    "end": "1280700"
  },
  {
    "text": "deployed in the monitoring namespace",
    "start": "1280700",
    "end": "1282700"
  },
  {
    "text": "we're looking at the Calico system",
    "start": "1282700",
    "end": "1285320"
  },
  {
    "text": "namespace and we're selecting case",
    "start": "1285320",
    "end": "1287960"
  },
  {
    "text": "Kate's typher metrics which is indeed",
    "start": "1287960",
    "end": "1291080"
  },
  {
    "text": "the label for this monitor that we",
    "start": "1291080",
    "end": "1293240"
  },
  {
    "text": "created",
    "start": "1293240",
    "end": "1294220"
  },
  {
    "text": "so let's apply that too",
    "start": "1294220",
    "end": "1298179"
  },
  {
    "text": "and finally let's take a look at IQ",
    "start": "1304760",
    "end": "1307880"
  },
  {
    "text": "controllers",
    "start": "1307880",
    "end": "1310480"
  },
  {
    "text": "again it's a service monitor again we've",
    "start": "1310780",
    "end": "1315020"
  },
  {
    "text": "got the release Prometheus stack",
    "start": "1315020",
    "end": "1317179"
  },
  {
    "text": "we're calling a Calico Cube controller's",
    "start": "1317179",
    "end": "1319400"
  },
  {
    "text": "monitor in the monitoring namespace",
    "start": "1319400",
    "end": "1321200"
  },
  {
    "text": "we're matching the Calico system",
    "start": "1321200",
    "end": "1323179"
  },
  {
    "text": "namespace and here we're matching K it's",
    "start": "1323179",
    "end": "1325880"
  },
  {
    "text": "a Calico Cube controllers which is the",
    "start": "1325880",
    "end": "1329179"
  },
  {
    "text": "same as this label",
    "start": "1329179",
    "end": "1330740"
  },
  {
    "text": "for this service",
    "start": "1330740",
    "end": "1333200"
  },
  {
    "text": "let's apply that",
    "start": "1333200",
    "end": "1336399"
  },
  {
    "text": "now with that done we should be able to",
    "start": "1344780",
    "end": "1347299"
  },
  {
    "text": "take a look",
    "start": "1347299",
    "end": "1348620"
  },
  {
    "text": "Prometheus targets",
    "start": "1348620",
    "end": "1351880"
  },
  {
    "text": "and just see if they've been spotted now",
    "start": "1352640",
    "end": "1356240"
  },
  {
    "text": "this can take a few seconds we can",
    "start": "1356240",
    "end": "1359179"
  },
  {
    "text": "already see that we've got the Felix",
    "start": "1359179",
    "end": "1360740"
  },
  {
    "text": "service monitor now we've got the typha",
    "start": "1360740",
    "end": "1362960"
  },
  {
    "text": "service monitor might take a few more",
    "start": "1362960",
    "end": "1365120"
  },
  {
    "text": "minutes for the cube controller service",
    "start": "1365120",
    "end": "1366679"
  },
  {
    "text": "monitor to appear so let's just wait",
    "start": "1366679",
    "end": "1370360"
  },
  {
    "text": "and after a few seconds we now see the",
    "start": "1377419",
    "end": "1380120"
  },
  {
    "text": "Calico Q controller's monitors",
    "start": "1380120",
    "end": "1382820"
  },
  {
    "text": "so that's everything now and we can",
    "start": "1382820",
    "end": "1384860"
  },
  {
    "text": "expand these we can see that they're up",
    "start": "1384860",
    "end": "1388100"
  },
  {
    "text": "and if we were to take a look at these",
    "start": "1388100",
    "end": "1389780"
  },
  {
    "text": "IP addresses these IP addresses are",
    "start": "1389780",
    "end": "1392720"
  },
  {
    "text": "going to be the pods that Prometheus is",
    "start": "1392720",
    "end": "1395539"
  },
  {
    "text": "scraping so that's service has shown",
    "start": "1395539",
    "end": "1398840"
  },
  {
    "text": "Prometheus what the endpoints are what",
    "start": "1398840",
    "end": "1401120"
  },
  {
    "text": "the pods are and then Prometheus is",
    "start": "1401120",
    "end": "1403340"
  },
  {
    "text": "scraping those pods on the TCP portion",
    "start": "1403340",
    "end": "1408080"
  },
  {
    "text": "be able to visualize these metrics in",
    "start": "1408080",
    "end": "1410120"
  },
  {
    "text": "grafana we need to create a dashboard",
    "start": "1410120",
    "end": "1412820"
  },
  {
    "text": "now you can of course create any",
    "start": "1412820",
    "end": "1414140"
  },
  {
    "text": "dashboard you want with the metrics that",
    "start": "1414140",
    "end": "1415820"
  },
  {
    "text": "have been exposed but for this video we",
    "start": "1415820",
    "end": "1418039"
  },
  {
    "text": "will create a Felix dashboard based on",
    "start": "1418039",
    "end": "1420080"
  },
  {
    "text": "what is provided in the project Calico",
    "start": "1420080",
    "end": "1422299"
  },
  {
    "text": "docs site",
    "start": "1422299",
    "end": "1425260"
  },
  {
    "text": "if we navigate to this URL",
    "start": "1425600",
    "end": "1429020"
  },
  {
    "text": "we can see a Felix dashboard.json and",
    "start": "1429020",
    "end": "1432200"
  },
  {
    "text": "there's all the configuration needed to",
    "start": "1432200",
    "end": "1434360"
  },
  {
    "text": "create a default Felix dashboard in",
    "start": "1434360",
    "end": "1437360"
  },
  {
    "text": "grafana",
    "start": "1437360",
    "end": "1438559"
  },
  {
    "text": "so what we really need to do is copy all",
    "start": "1438559",
    "end": "1441919"
  },
  {
    "text": "of this information and then change the",
    "start": "1441919",
    "end": "1444440"
  },
  {
    "text": "data sources because",
    "start": "1444440",
    "end": "1446179"
  },
  {
    "text": "in this example the data source is just",
    "start": "1446179",
    "end": "1449059"
  },
  {
    "text": "specified as grafana we need to specify",
    "start": "1449059",
    "end": "1451460"
  },
  {
    "text": "it for our Prometheus and our graphene",
    "start": "1451460",
    "end": "1454220"
  },
  {
    "text": "instance",
    "start": "1454220",
    "end": "1455720"
  },
  {
    "text": "so all we need to do is change data",
    "start": "1455720",
    "end": "1459080"
  },
  {
    "text": "source grafana to dinosaurs type data",
    "start": "1459080",
    "end": "1462080"
  },
  {
    "text": "source and uuid grafana so we'll replace",
    "start": "1462080",
    "end": "1465080"
  },
  {
    "text": "all",
    "start": "1465080",
    "end": "1466820"
  },
  {
    "text": "and then we can find another data source",
    "start": "1466820",
    "end": "1469880"
  },
  {
    "text": "that references Calico demo Prometheus",
    "start": "1469880",
    "end": "1472820"
  },
  {
    "text": "which of course is not referencing our",
    "start": "1472820",
    "end": "1476419"
  },
  {
    "text": "Prometheus installation so let's also",
    "start": "1476419",
    "end": "1479480"
  },
  {
    "text": "change that",
    "start": "1479480",
    "end": "1480860"
  },
  {
    "text": "so to change that we just need to",
    "start": "1480860",
    "end": "1484520"
  },
  {
    "text": "change",
    "start": "1484520",
    "end": "1486200"
  },
  {
    "text": "this",
    "start": "1486200",
    "end": "1488919"
  },
  {
    "text": "let's copy that",
    "start": "1491659",
    "end": "1493820"
  },
  {
    "text": "so now we're changing anywhere where it",
    "start": "1493820",
    "end": "1496159"
  },
  {
    "text": "says data source Calico demo Prometheus",
    "start": "1496159",
    "end": "1498980"
  },
  {
    "text": "to data source type Prometheus uid",
    "start": "1498980",
    "end": "1501559"
  },
  {
    "text": "Prometheus and we'll replace all of them",
    "start": "1501559",
    "end": "1505460"
  },
  {
    "text": "now we simply just need to",
    "start": "1505460",
    "end": "1507559"
  },
  {
    "text": "copy this",
    "start": "1507559",
    "end": "1510100"
  },
  {
    "text": "go to our dashboards",
    "start": "1510200",
    "end": "1513639"
  },
  {
    "text": "and import",
    "start": "1514720",
    "end": "1517100"
  },
  {
    "text": "here I can just paste the Json that I",
    "start": "1517100",
    "end": "1519799"
  },
  {
    "text": "have of course you could save it and",
    "start": "1519799",
    "end": "1521900"
  },
  {
    "text": "upload it I'll just load it in here you",
    "start": "1521900",
    "end": "1525380"
  },
  {
    "text": "can see that it gives a name Calico",
    "start": "1525380",
    "end": "1527120"
  },
  {
    "text": "Felix dashboard and then when I import",
    "start": "1527120",
    "end": "1528860"
  },
  {
    "text": "it",
    "start": "1528860",
    "end": "1530000"
  },
  {
    "text": "will immediately get all of the metrics",
    "start": "1530000",
    "end": "1532460"
  },
  {
    "text": "that we need",
    "start": "1532460",
    "end": "1535179"
  },
  {
    "text": "so to recap what we went over in this",
    "start": "1536120",
    "end": "1538279"
  },
  {
    "text": "video we first deployed both Calico OSS",
    "start": "1538279",
    "end": "1541640"
  },
  {
    "text": "and the Prometheus stack using helm",
    "start": "1541640",
    "end": "1544520"
  },
  {
    "text": "we then expose the Prometheus and",
    "start": "1544520",
    "end": "1546679"
  },
  {
    "text": "grafana's uis using an Ingress",
    "start": "1546679",
    "end": "1549799"
  },
  {
    "text": "we created services for both Calico node",
    "start": "1549799",
    "end": "1552559"
  },
  {
    "text": "and Calico typhen remember the Calico Q",
    "start": "1552559",
    "end": "1555559"
  },
  {
    "text": "controller service was already created",
    "start": "1555559",
    "end": "1558679"
  },
  {
    "text": "and then these Services were referenced",
    "start": "1558679",
    "end": "1561200"
  },
  {
    "text": "by the service monitors that we also",
    "start": "1561200",
    "end": "1563360"
  },
  {
    "text": "created to tell Prometheus how to",
    "start": "1563360",
    "end": "1566059"
  },
  {
    "text": "discover the calculate endpoints it",
    "start": "1566059",
    "end": "1567799"
  },
  {
    "text": "needed to scrape",
    "start": "1567799",
    "end": "1570320"
  },
  {
    "text": "we verify the targets were discovered",
    "start": "1570320",
    "end": "1572419"
  },
  {
    "text": "correctly in Prometheus and then we",
    "start": "1572419",
    "end": "1574580"
  },
  {
    "text": "created a dashboard for Felix exposed",
    "start": "1574580",
    "end": "1576799"
  },
  {
    "text": "metrics based on a default dashboard",
    "start": "1576799",
    "end": "1579260"
  },
  {
    "text": "provided in the project Calico dark site",
    "start": "1579260",
    "end": "1582559"
  },
  {
    "text": "I hope this video has been helpful and",
    "start": "1582559",
    "end": "1584539"
  },
  {
    "text": "we look forward to seeing you in future",
    "start": "1584539",
    "end": "1585980"
  },
  {
    "text": "videos",
    "start": "1585980",
    "end": "1586580"
  },
  {
    "text": "[Music]",
    "start": "1586580",
    "end": "1595279"
  }
]