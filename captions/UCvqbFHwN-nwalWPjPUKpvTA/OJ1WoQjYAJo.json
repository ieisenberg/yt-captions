[
  {
    "text": "well hello",
    "start": "80",
    "end": "2360"
  },
  {
    "text": "CubeCon thanks for saving the best talk",
    "start": "2360",
    "end": "4640"
  },
  {
    "text": "for",
    "start": "4640",
    "end": "6359"
  },
  {
    "text": "last this is evaporating Kubernetes",
    "start": "6359",
    "end": "8960"
  },
  {
    "text": "security risk adopting validation",
    "start": "8960",
    "end": "10960"
  },
  {
    "text": "admission policy at scale uh my name is",
    "start": "10960",
    "end": "13920"
  },
  {
    "text": "Jordan Connard i'm a security engineer",
    "start": "13920",
    "end": "15920"
  },
  {
    "text": "here at Data Dog um and I work on one of",
    "start": "15920",
    "end": "18960"
  },
  {
    "text": "our compute teams helping secure our",
    "start": "18960",
    "end": "21039"
  },
  {
    "text": "Kubernetes control planes and I'm",
    "start": "21039",
    "end": "23359"
  },
  {
    "text": "Kaitlin Lee a software engineer also on",
    "start": "23359",
    "end": "25519"
  },
  {
    "text": "the comput team here at Data Dog um I",
    "start": "25519",
    "end": "27840"
  },
  {
    "text": "started on the control plane team and",
    "start": "27840",
    "end": "29439"
  },
  {
    "text": "now I focus on our workload autoscaling",
    "start": "29439",
    "end": "31760"
  },
  {
    "text": "um but here at data dog we've been",
    "start": "31760",
    "end": "33840"
  },
  {
    "text": "working with validating admission policy",
    "start": "33840",
    "end": "35760"
  },
  {
    "text": "for a little over a year now so today we",
    "start": "35760",
    "end": "38320"
  },
  {
    "text": "wanted to come here and show you how you",
    "start": "38320",
    "end": "40000"
  },
  {
    "text": "can take some tutorial policies and",
    "start": "40000",
    "end": "42160"
  },
  {
    "text": "transform them into fully adopted",
    "start": "42160",
    "end": "43920"
  },
  {
    "text": "validating admission policy at scale",
    "start": "43920",
    "end": "47600"
  },
  {
    "text": "quick overview of what we're going to",
    "start": "47600",
    "end": "48960"
  },
  {
    "text": "talk about today so we're going to start",
    "start": "48960",
    "end": "50960"
  },
  {
    "text": "out with just a little bit about what",
    "start": "50960",
    "end": "52399"
  },
  {
    "text": "Kubernetes means at data dog uh then",
    "start": "52399",
    "end": "55440"
  },
  {
    "text": "we'll transition into data dog's history",
    "start": "55440",
    "end": "58320"
  },
  {
    "text": "with admission control kind of our",
    "start": "58320",
    "end": "60559"
  },
  {
    "text": "motivations for migrating to validate",
    "start": "60559",
    "end": "62960"
  },
  {
    "text": "admission policy we'll dive into one of",
    "start": "62960",
    "end": "66080"
  },
  {
    "text": "our policies and kind of take it from",
    "start": "66080",
    "end": "68560"
  },
  {
    "text": "what you might get out of the box in a",
    "start": "68560",
    "end": "70400"
  },
  {
    "text": "tutorial into something that we feel uh",
    "start": "70400",
    "end": "73680"
  },
  {
    "text": "is good enough to deploy out into",
    "start": "73680",
    "end": "75680"
  },
  {
    "text": "production uh next we'll cover a few",
    "start": "75680",
    "end": "78000"
  },
  {
    "text": "migration uh and monitoring strategies",
    "start": "78000",
    "end": "80159"
  },
  {
    "text": "that we've used and finally we'll wrap",
    "start": "80159",
    "end": "82400"
  },
  {
    "text": "up with some teasers to uh some day two",
    "start": "82400",
    "end": "85280"
  },
  {
    "text": "operations and kind of next steps",
    "start": "85280",
    "end": "88880"
  },
  {
    "text": "so for a little bit of background of",
    "start": "88880",
    "end": "90960"
  },
  {
    "text": "Kubernetes here at Data Dog we have over",
    "start": "90960",
    "end": "93280"
  },
  {
    "text": "2,000 employees in our engineering",
    "start": "93280",
    "end": "95400"
  },
  {
    "text": "organization we run multicloud with over",
    "start": "95400",
    "end": "98159"
  },
  {
    "text": "a 100 clusters over 10,000 nodes and",
    "start": "98159",
    "end": "101360"
  },
  {
    "text": "over a 100,000 pods so every single one",
    "start": "101360",
    "end": "104720"
  },
  {
    "text": "of our workloads runs on Kubernetes so",
    "start": "104720",
    "end": "107360"
  },
  {
    "text": "it's not just our infrastructure but",
    "start": "107360",
    "end": "109600"
  },
  {
    "text": "also all of our platforms and all of our",
    "start": "109600",
    "end": "113159"
  },
  {
    "text": "applications so as such we need a",
    "start": "113159",
    "end": "116079"
  },
  {
    "text": "granular and configurable set of",
    "start": "116079",
    "end": "117920"
  },
  {
    "text": "security policies to match our",
    "start": "117920",
    "end": "119520"
  },
  {
    "text": "heterogeneous workloads",
    "start": "119520",
    "end": "123119"
  },
  {
    "text": "and so data dog's kind of history with",
    "start": "123119",
    "end": "125439"
  },
  {
    "text": "admission policy starts around 2020 when",
    "start": "125439",
    "end": "128479"
  },
  {
    "text": "uh pod security policies were being",
    "start": "128479",
    "end": "130479"
  },
  {
    "text": "deprecated uh out of kubernetes we were",
    "start": "130479",
    "end": "133520"
  },
  {
    "text": "looking for a replacement at the time",
    "start": "133520",
    "end": "135840"
  },
  {
    "text": "and uh pod security and mission uh just",
    "start": "135840",
    "end": "138720"
  },
  {
    "text": "wasn't going to be a great fit for us uh",
    "start": "138720",
    "end": "141440"
  },
  {
    "text": "so around the time OPA gatekeeper was",
    "start": "141440",
    "end": "144000"
  },
  {
    "text": "kind of the go-to default solution um in",
    "start": "144000",
    "end": "147120"
  },
  {
    "text": "the ecosystem at the time and that's",
    "start": "147120",
    "end": "148959"
  },
  {
    "text": "ultimately what we began",
    "start": "148959",
    "end": "151400"
  },
  {
    "text": "with just a quick overview opa",
    "start": "151400",
    "end": "153920"
  },
  {
    "text": "gatekeeper OPA or open policy agent uh",
    "start": "153920",
    "end": "156720"
  },
  {
    "text": "is a graduated CNCF project it aims to",
    "start": "156720",
    "end": "160160"
  },
  {
    "text": "be a generalpurpose policy engine um it",
    "start": "160160",
    "end": "163280"
  },
  {
    "text": "primarily uses the Rego language to",
    "start": "163280",
    "end": "165760"
  },
  {
    "text": "write and define its policies and",
    "start": "165760",
    "end": "168080"
  },
  {
    "text": "gatekeeper is the part of the project",
    "start": "168080",
    "end": "170720"
  },
  {
    "text": "which kind of wraps the OPA engine into",
    "start": "170720",
    "end": "173680"
  },
  {
    "text": "a validating uh admission web hook",
    "start": "173680",
    "end": "177680"
  },
  {
    "text": "so as of Kubernetes version 130 SIG API",
    "start": "177680",
    "end": "181360"
  },
  {
    "text": "machinery has a new uh feature out",
    "start": "181360",
    "end": "183680"
  },
  {
    "text": "called validating admission policy it's",
    "start": "183680",
    "end": "185920"
  },
  {
    "text": "actually graduated to stable so from the",
    "start": "185920",
    "end": "188640"
  },
  {
    "text": "documentation validating admission",
    "start": "188640",
    "end": "190640"
  },
  {
    "text": "policy offers a declarative inprocess",
    "start": "190640",
    "end": "193120"
  },
  {
    "text": "alternative to validating admission web",
    "start": "193120",
    "end": "195120"
  },
  {
    "text": "hooks so this means that VIAP",
    "start": "195120",
    "end": "198080"
  },
  {
    "text": "validations are evaluated directly in",
    "start": "198080",
    "end": "200879"
  },
  {
    "text": "the API server rather than as an",
    "start": "200879",
    "end": "203599"
  },
  {
    "text": "admission web hook like gatekeeper",
    "start": "203599",
    "end": "205599"
  },
  {
    "text": "furthermore VIAP's policies are written",
    "start": "205599",
    "end": "208000"
  },
  {
    "text": "in the common expression language rather",
    "start": "208000",
    "end": "209920"
  },
  {
    "text": "than rego so if you'd like a little more",
    "start": "209920",
    "end": "212239"
  },
  {
    "text": "background on VAP and CEL we invite you",
    "start": "212239",
    "end": "214640"
  },
  {
    "text": "to check out Anish and Kevin's CubeCon",
    "start": "214640",
    "end": "216640"
  },
  {
    "text": "NA 2024 talk",
    "start": "216640",
    "end": "219920"
  },
  {
    "text": "so um once Kaitlin and I kind of got our",
    "start": "219920",
    "end": "223280"
  },
  {
    "text": "hands on validating emission policy uh",
    "start": "223280",
    "end": "225840"
  },
  {
    "text": "we did a proof of concept and ultimately",
    "start": "225840",
    "end": "228319"
  },
  {
    "text": "came to the conclusion that it'd be a",
    "start": "228319",
    "end": "230319"
  },
  {
    "text": "great fit for data dog we kind of came",
    "start": "230319",
    "end": "232640"
  },
  {
    "text": "up with three main categories as to",
    "start": "232640",
    "end": "234879"
  },
  {
    "text": "features that we really liked and uh",
    "start": "234879",
    "end": "237599"
  },
  {
    "text": "ultimately you know the first one is",
    "start": "237599",
    "end": "239200"
  },
  {
    "text": "just moving that from an external web",
    "start": "239200",
    "end": "241680"
  },
  {
    "text": "hook to an entry process was going to",
    "start": "241680",
    "end": "244080"
  },
  {
    "text": "save us a lot of operational complexity",
    "start": "244080",
    "end": "246480"
  },
  {
    "text": "it's going to reduce our cloud resources",
    "start": "246480",
    "end": "248640"
  },
  {
    "text": "and cost and finally it was going to",
    "start": "248640",
    "end": "250480"
  },
  {
    "text": "give us just a little bit better",
    "start": "250480",
    "end": "251680"
  },
  {
    "text": "security posture by not running that",
    "start": "251680",
    "end": "253920"
  },
  {
    "text": "external web",
    "start": "253920",
    "end": "255000"
  },
  {
    "text": "hook uh next we really liked the CL",
    "start": "255000",
    "end": "257840"
  },
  {
    "text": "language um we see it being used",
    "start": "257840",
    "end": "260639"
  },
  {
    "text": "increasingly across uh Kubernetes things",
    "start": "260639",
    "end": "263600"
  },
  {
    "text": "like validating fields and CRDs um it's",
    "start": "263600",
    "end": "267199"
  },
  {
    "text": "also being used internally at data log",
    "start": "267199",
    "end": "269919"
  },
  {
    "text": "in some developer tooling uh as",
    "start": "269919",
    "end": "273400"
  },
  {
    "text": "well and finally we really liked the",
    "start": "273400",
    "end": "276160"
  },
  {
    "text": "namespace scope parameters that",
    "start": "276160",
    "end": "277680"
  },
  {
    "text": "validating emission policy gives um as a",
    "start": "277680",
    "end": "280560"
  },
  {
    "text": "security engineer it's great it gives me",
    "start": "280560",
    "end": "282320"
  },
  {
    "text": "an entire namespaces security posture uh",
    "start": "282320",
    "end": "285280"
  },
  {
    "text": "at a single glance and uh it aligned",
    "start": "285280",
    "end": "288240"
  },
  {
    "text": "really well with some of data dog's",
    "start": "288240",
    "end": "290960"
  },
  {
    "text": "existing kind of name spa namespace",
    "start": "290960",
    "end": "293600"
  },
  {
    "text": "ownership and uh arbback boundaries",
    "start": "293600",
    "end": "298600"
  },
  {
    "text": "right so once we've decided to migrate",
    "start": "298720",
    "end": "301520"
  },
  {
    "text": "to validating emission policy one of the",
    "start": "301520",
    "end": "303919"
  },
  {
    "text": "first things that we needed to do was",
    "start": "303919",
    "end": "306000"
  },
  {
    "text": "actually take our existing policies and",
    "start": "306000",
    "end": "308479"
  },
  {
    "text": "then translate them into validating",
    "start": "308479",
    "end": "310720"
  },
  {
    "text": "mission policy um so we wanted to share",
    "start": "310720",
    "end": "313280"
  },
  {
    "text": "one of our policies with you today our",
    "start": "313280",
    "end": "316000"
  },
  {
    "text": "capabilities policy this one's come all",
    "start": "316000",
    "end": "318639"
  },
  {
    "text": "the way from come with us all the way",
    "start": "318639",
    "end": "321039"
  },
  {
    "text": "from our pod security policy days um and",
    "start": "321039",
    "end": "324000"
  },
  {
    "text": "it very simply just restricts uh the",
    "start": "324000",
    "end": "326960"
  },
  {
    "text": "added capabilities that a container can",
    "start": "326960",
    "end": "329360"
  },
  {
    "text": "give to its security context",
    "start": "329360",
    "end": "332960"
  },
  {
    "text": "so to get VIP up and running we're going",
    "start": "332960",
    "end": "335199"
  },
  {
    "text": "to need a few different components so",
    "start": "335199",
    "end": "337199"
  },
  {
    "text": "the first one is our validating",
    "start": "337199",
    "end": "339360"
  },
  {
    "text": "admission policy resource so you can see",
    "start": "339360",
    "end": "342000"
  },
  {
    "text": "in box one that this policy is",
    "start": "342000",
    "end": "343840"
  },
  {
    "text": "validating against the update and create",
    "start": "343840",
    "end": "346320"
  },
  {
    "text": "requests of pod resources",
    "start": "346320",
    "end": "349120"
  },
  {
    "text": "down below in box two you can see our",
    "start": "349120",
    "end": "351039"
  },
  {
    "text": "validation expression written in the",
    "start": "351039",
    "end": "353360"
  },
  {
    "text": "common express common expression",
    "start": "353360",
    "end": "355360"
  },
  {
    "text": "language so you can see that this",
    "start": "355360",
    "end": "357440"
  },
  {
    "text": "expression only validates pod resources",
    "start": "357440",
    "end": "360800"
  },
  {
    "text": "and it will only pass pod resources that",
    "start": "360800",
    "end": "363280"
  },
  {
    "text": "do not have anything specified in the",
    "start": "363280",
    "end": "365680"
  },
  {
    "text": "add field of any of its containers uh",
    "start": "365680",
    "end": "368560"
  },
  {
    "text": "security",
    "start": "368560",
    "end": "369560"
  },
  {
    "text": "contexts so in order to have this policy",
    "start": "369560",
    "end": "372319"
  },
  {
    "text": "take into effect we're going to need to",
    "start": "372319",
    "end": "373919"
  },
  {
    "text": "bind it to our name spaces",
    "start": "373919",
    "end": "376720"
  },
  {
    "text": "so we can do this by using a validating",
    "start": "376720",
    "end": "379440"
  },
  {
    "text": "admission uh policy binding",
    "start": "379440",
    "end": "382199"
  },
  {
    "text": "resource you can see in box 3 that we've",
    "start": "382199",
    "end": "384720"
  },
  {
    "text": "specified a namespace selector so that",
    "start": "384720",
    "end": "387520"
  },
  {
    "text": "means all of our namespaces will be",
    "start": "387520",
    "end": "389600"
  },
  {
    "text": "bound to this policy by default except",
    "start": "389600",
    "end": "392319"
  },
  {
    "text": "if they explicitly include this",
    "start": "392319",
    "end": "394560"
  },
  {
    "text": "exclusion label so right now we have the",
    "start": "394560",
    "end": "397680"
  },
  {
    "text": "ability to exclude entire namespaces",
    "start": "397680",
    "end": "400560"
  },
  {
    "text": "from entire policies",
    "start": "400560",
    "end": "403680"
  },
  {
    "text": "so you can see here an example pod that",
    "start": "403680",
    "end": "406240"
  },
  {
    "text": "is attempting to add a capability within",
    "start": "406240",
    "end": "408960"
  },
  {
    "text": "a uh one of its container security",
    "start": "408960",
    "end": "411479"
  },
  {
    "text": "contexts so this pod would actually be",
    "start": "411479",
    "end": "414240"
  },
  {
    "text": "denied admission by our policy but",
    "start": "414240",
    "end": "417039"
  },
  {
    "text": "sometimes we do have legitimate use",
    "start": "417039",
    "end": "418639"
  },
  {
    "text": "cases for these capabilities and",
    "start": "418639",
    "end": "420880"
  },
  {
    "text": "unfortunately with this current setup we",
    "start": "420880",
    "end": "423360"
  },
  {
    "text": "don't have um it's not adequate enough",
    "start": "423360",
    "end": "425840"
  },
  {
    "text": "for our needs so right now it's either",
    "start": "425840",
    "end": "428319"
  },
  {
    "text": "all or nothing pods would either be",
    "start": "428319",
    "end": "430560"
  },
  {
    "text": "denied admission from our policy for",
    "start": "430560",
    "end": "432400"
  },
  {
    "text": "using any capability or they could be",
    "start": "432400",
    "end": "435280"
  },
  {
    "text": "excluded from our policy but allowed to",
    "start": "435280",
    "end": "437360"
  },
  {
    "text": "use all capabilities",
    "start": "437360",
    "end": "440720"
  },
  {
    "text": "so yeah as a security engineer is",
    "start": "440720",
    "end": "442639"
  },
  {
    "text": "clearly not a great security posture uh",
    "start": "442639",
    "end": "445039"
  },
  {
    "text": "we'd love to introduce some more",
    "start": "445039",
    "end": "446400"
  },
  {
    "text": "flexibility into our policies before",
    "start": "446400",
    "end": "448479"
  },
  {
    "text": "they actually go out into production to",
    "start": "448479",
    "end": "450720"
  },
  {
    "text": "address these legitimate use cases um",
    "start": "450720",
    "end": "453280"
  },
  {
    "text": "and the first way we can do that is by",
    "start": "453280",
    "end": "455120"
  },
  {
    "text": "adding um a variable to our policy there",
    "start": "455120",
    "end": "458400"
  },
  {
    "text": "in box one we've just called it globally",
    "start": "458400",
    "end": "460639"
  },
  {
    "text": "allowed capabilities and this is simply",
    "start": "460639",
    "end": "462639"
  },
  {
    "text": "just a list of capabilities that we",
    "start": "462639",
    "end": "465039"
  },
  {
    "text": "think might not need additional security",
    "start": "465039",
    "end": "467280"
  },
  {
    "text": "review before they're used um in",
    "start": "467280",
    "end": "470599"
  },
  {
    "text": "workloads once we've got our variable",
    "start": "470599",
    "end": "473280"
  },
  {
    "text": "defined there in box one we can go ahead",
    "start": "473280",
    "end": "475599"
  },
  {
    "text": "and reference it in our CL expression",
    "start": "475599",
    "end": "478319"
  },
  {
    "text": "there in box two",
    "start": "478319",
    "end": "481680"
  },
  {
    "text": "so to make our expression even more",
    "start": "481680",
    "end": "483840"
  },
  {
    "text": "concise we have replaced our former use",
    "start": "483840",
    "end": "486639"
  },
  {
    "text": "of the has macros with CL optional field",
    "start": "486639",
    "end": "490080"
  },
  {
    "text": "selection syntax so that question mark",
    "start": "490080",
    "end": "492840"
  },
  {
    "text": "operator in conjunction with theor value",
    "start": "492840",
    "end": "495680"
  },
  {
    "text": "function seen in box 3 this allows us to",
    "start": "495680",
    "end": "498560"
  },
  {
    "text": "substitute in a value in the event that",
    "start": "498560",
    "end": "500720"
  },
  {
    "text": "a field we're checking doesn't exist so",
    "start": "500720",
    "end": "503440"
  },
  {
    "text": "in our case we're substituting in an",
    "start": "503440",
    "end": "505680"
  },
  {
    "text": "empty list so this allows us to check",
    "start": "505680",
    "end": "509759"
  },
  {
    "text": "fields without having to check their",
    "start": "509759",
    "end": "511680"
  },
  {
    "text": "existence every single time and thus",
    "start": "511680",
    "end": "514399"
  },
  {
    "text": "making our expression a little more",
    "start": "514399",
    "end": "516640"
  },
  {
    "text": "concise and also in this example an",
    "start": "516640",
    "end": "519599"
  },
  {
    "text": "empty list would in fact pass our",
    "start": "519599",
    "end": "521599"
  },
  {
    "text": "validation and therefore admit a",
    "start": "521599",
    "end": "524760"
  },
  {
    "text": "pod so globally allowed variables are a",
    "start": "524760",
    "end": "527440"
  },
  {
    "text": "great start to add flexibility in our",
    "start": "527440",
    "end": "529519"
  },
  {
    "text": "policy but we can go a step further",
    "start": "529519",
    "end": "531760"
  },
  {
    "text": "validating emission policy has a concept",
    "start": "531760",
    "end": "533920"
  },
  {
    "text": "called parameter resources and this",
    "start": "533920",
    "end": "536240"
  },
  {
    "text": "allows you to take basically any",
    "start": "536240",
    "end": "537839"
  },
  {
    "text": "Kubernetes resource and inject uh some",
    "start": "537839",
    "end": "541200"
  },
  {
    "text": "information from it into your policy um",
    "start": "541200",
    "end": "544240"
  },
  {
    "text": "this could be anything from a config map",
    "start": "544240",
    "end": "546720"
  },
  {
    "text": "something like a pod disruption budget",
    "start": "546720",
    "end": "549040"
  },
  {
    "text": "at Data Dog we uh made the decision to",
    "start": "549040",
    "end": "551839"
  },
  {
    "text": "go ahead and create our own CRD which",
    "start": "551839",
    "end": "554160"
  },
  {
    "text": "packages all of our variables that we",
    "start": "554160",
    "end": "557200"
  },
  {
    "text": "need for our policies there in box one",
    "start": "557200",
    "end": "559760"
  },
  {
    "text": "you can see kind of the beginnings of",
    "start": "559760",
    "end": "561680"
  },
  {
    "text": "our CRD and in box two an example",
    "start": "561680",
    "end": "565600"
  },
  {
    "text": "resource created from the CRD uh which",
    "start": "565600",
    "end": "568800"
  },
  {
    "text": "uh includes our allowed",
    "start": "568800",
    "end": "571959"
  },
  {
    "text": "capabilities once we've got our",
    "start": "571959",
    "end": "574080"
  },
  {
    "text": "parameter resources defined and created",
    "start": "574080",
    "end": "576640"
  },
  {
    "text": "we need to tell our policy resource",
    "start": "576640",
    "end": "578560"
  },
  {
    "text": "about it so there in box three we've",
    "start": "578560",
    "end": "580800"
  },
  {
    "text": "added a param kind field to our policy",
    "start": "580800",
    "end": "584080"
  },
  {
    "text": "and we're specifying the API version and",
    "start": "584080",
    "end": "586560"
  },
  {
    "text": "kind of our CRD",
    "start": "586560",
    "end": "589519"
  },
  {
    "text": "finally we also need to tell the binding",
    "start": "589519",
    "end": "591680"
  },
  {
    "text": "resource about which parameter to go and",
    "start": "591680",
    "end": "594480"
  },
  {
    "text": "look up uh and so we can add the param",
    "start": "594480",
    "end": "597200"
  },
  {
    "text": "ref field there uh to go and look for",
    "start": "597200",
    "end": "599680"
  },
  {
    "text": "our parameter",
    "start": "599680",
    "end": "601880"
  },
  {
    "text": "resource finally once uh the policy and",
    "start": "601880",
    "end": "605200"
  },
  {
    "text": "the binding both know about our",
    "start": "605200",
    "end": "607279"
  },
  {
    "text": "parameter resource we are then free to",
    "start": "607279",
    "end": "609200"
  },
  {
    "text": "add it in our CL expression there at the",
    "start": "609200",
    "end": "612080"
  },
  {
    "text": "bottom in box five in our policy",
    "start": "612080",
    "end": "614240"
  },
  {
    "text": "resource um ultimately this gives us the",
    "start": "614240",
    "end": "617120"
  },
  {
    "text": "flexibility to uh take a single policy",
    "start": "617120",
    "end": "620240"
  },
  {
    "text": "and configure it differently across each",
    "start": "620240",
    "end": "623120"
  },
  {
    "text": "namespace individual uh capabilities",
    "start": "623120",
    "end": "626320"
  },
  {
    "text": "needs and their security requirements so",
    "start": "626320",
    "end": "629279"
  },
  {
    "text": "right now we have a configurable policy",
    "start": "629279",
    "end": "631760"
  },
  {
    "text": "but it's only validating against pod",
    "start": "631760",
    "end": "633920"
  },
  {
    "text": "resources",
    "start": "633920",
    "end": "635440"
  },
  {
    "text": "it's perfectly acceptable from a",
    "start": "635440",
    "end": "637120"
  },
  {
    "text": "security standpoint but it would be a",
    "start": "637120",
    "end": "639040"
  },
  {
    "text": "better user experience if we could",
    "start": "639040",
    "end": "640640"
  },
  {
    "text": "validate against higher level pod",
    "start": "640640",
    "end": "642480"
  },
  {
    "text": "creating resources like",
    "start": "642480",
    "end": "644440"
  },
  {
    "text": "deployments so that's exactly what we're",
    "start": "644440",
    "end": "646800"
  },
  {
    "text": "going to do now um you can see in box",
    "start": "646800",
    "end": "649040"
  },
  {
    "text": "one that we've expanded the scope of our",
    "start": "649040",
    "end": "651120"
  },
  {
    "text": "policy to also validate the create and",
    "start": "651120",
    "end": "654000"
  },
  {
    "text": "update requests of these higher level",
    "start": "654000",
    "end": "656079"
  },
  {
    "text": "pod creating resources such as",
    "start": "656079",
    "end": "658480"
  },
  {
    "text": "deployments and crown jobs",
    "start": "658480",
    "end": "661839"
  },
  {
    "text": "so you can see down below in box two",
    "start": "661839",
    "end": "664079"
  },
  {
    "text": "we've created a podspec variable so we",
    "start": "664079",
    "end": "667600"
  },
  {
    "text": "need this podspec variable because",
    "start": "667600",
    "end": "669760"
  },
  {
    "text": "traditionally in VIP we would need an",
    "start": "669760",
    "end": "672160"
  },
  {
    "text": "additional two validating uh validation",
    "start": "672160",
    "end": "674640"
  },
  {
    "text": "expressions to accommodate for these",
    "start": "674640",
    "end": "676640"
  },
  {
    "text": "different resource kinds and this is",
    "start": "676640",
    "end": "678800"
  },
  {
    "text": "because all these resource kinds have",
    "start": "678800",
    "end": "680720"
  },
  {
    "text": "different paths to their podspec so you",
    "start": "680720",
    "end": "683519"
  },
  {
    "text": "can see we've enlarged this expression",
    "start": "683519",
    "end": "685440"
  },
  {
    "text": "in box 3 and we've expanded the scope to",
    "start": "685440",
    "end": "688160"
  },
  {
    "text": "the apps API groups and job resources",
    "start": "688160",
    "end": "690720"
  },
  {
    "text": "cron jobs and pods in",
    "start": "690720",
    "end": "694680"
  },
  {
    "text": "general so you can see that we use two",
    "start": "694680",
    "end": "697920"
  },
  {
    "text": "terinary conditionals to extract the",
    "start": "697920",
    "end": "700000"
  },
  {
    "text": "podspec from all these different kinds",
    "start": "700000",
    "end": "701839"
  },
  {
    "text": "of",
    "start": "701839",
    "end": "703160"
  },
  {
    "text": "resources and finally down below in box",
    "start": "703160",
    "end": "706160"
  },
  {
    "text": "four we've replaced our formally",
    "start": "706160",
    "end": "708399"
  },
  {
    "text": "hardcoded podspec path with our new",
    "start": "708399",
    "end": "711040"
  },
  {
    "text": "podspec variable so this allows us to",
    "start": "711040",
    "end": "714480"
  },
  {
    "text": "use the same single validation",
    "start": "714480",
    "end": "716480"
  },
  {
    "text": "expression to validate against all these",
    "start": "716480",
    "end": "719120"
  },
  {
    "text": "different kinds of",
    "start": "719120",
    "end": "721560"
  },
  {
    "text": "resources so with this posback variable",
    "start": "721560",
    "end": "724000"
  },
  {
    "text": "we've been a little bit more friendly to",
    "start": "724000",
    "end": "725600"
  },
  {
    "text": "our users um they you know they're",
    "start": "725600",
    "end": "728079"
  },
  {
    "text": "getting uh admission denials now from",
    "start": "728079",
    "end": "730399"
  },
  {
    "text": "resources they might be more familiar",
    "start": "730399",
    "end": "732160"
  },
  {
    "text": "with uh and might interact more directly",
    "start": "732160",
    "end": "735200"
  },
  {
    "text": "with um but we can go even a step",
    "start": "735200",
    "end": "737440"
  },
  {
    "text": "further uh and provide some helpful",
    "start": "737440",
    "end": "739920"
  },
  {
    "text": "error messages to our users whenever",
    "start": "739920",
    "end": "742320"
  },
  {
    "text": "they do have an admission denial uh and",
    "start": "742320",
    "end": "745519"
  },
  {
    "text": "we can do that here with what's called a",
    "start": "745519",
    "end": "747519"
  },
  {
    "text": "message expression this is also a CL",
    "start": "747519",
    "end": "750240"
  },
  {
    "text": "expression and it is attached to our uh",
    "start": "750240",
    "end": "753760"
  },
  {
    "text": "actual policy validation expression and",
    "start": "753760",
    "end": "756639"
  },
  {
    "text": "it's uh rendered and run whenever the",
    "start": "756639",
    "end": "759959"
  },
  {
    "text": "associated validation expression denies",
    "start": "759959",
    "end": "763120"
  },
  {
    "text": "admission to a workload uh you can see",
    "start": "763120",
    "end": "765680"
  },
  {
    "text": "here in box two we've also added an",
    "start": "765680",
    "end": "768000"
  },
  {
    "text": "additional docs variable which just has",
    "start": "768000",
    "end": "770320"
  },
  {
    "text": "a hyperlink to some further information",
    "start": "770320",
    "end": "773440"
  },
  {
    "text": "about our policy so when we combine that",
    "start": "773440",
    "end": "776240"
  },
  {
    "text": "with our message expression there in the",
    "start": "776240",
    "end": "779200"
  },
  {
    "text": "bottom right you can see that we are not",
    "start": "779200",
    "end": "781360"
  },
  {
    "text": "only returning the actual container",
    "start": "781360",
    "end": "783920"
  },
  {
    "text": "names which violate our policy but also",
    "start": "783920",
    "end": "786560"
  },
  {
    "text": "where our users might find more",
    "start": "786560",
    "end": "788639"
  },
  {
    "text": "information about why uh the resource",
    "start": "788639",
    "end": "790959"
  },
  {
    "text": "was denied",
    "start": "790959",
    "end": "793920"
  },
  {
    "text": "great so with all those enhancements we",
    "start": "793920",
    "end": "796000"
  },
  {
    "text": "feel comfortable now deploying our",
    "start": "796000",
    "end": "797440"
  },
  {
    "text": "policies out into production so just",
    "start": "797440",
    "end": "799440"
  },
  {
    "text": "want to take a second and kind of",
    "start": "799440",
    "end": "801360"
  },
  {
    "text": "summarize the enhancements that we've",
    "start": "801360",
    "end": "803600"
  },
  {
    "text": "done so far uh so at the beginning we",
    "start": "803600",
    "end": "805760"
  },
  {
    "text": "had this barebones kind of inflexible",
    "start": "805760",
    "end": "808160"
  },
  {
    "text": "policy um and the first thing we did was",
    "start": "808160",
    "end": "811040"
  },
  {
    "text": "we added this globally allowed",
    "start": "811040",
    "end": "812880"
  },
  {
    "text": "capabilities variable to just give us",
    "start": "812880",
    "end": "815120"
  },
  {
    "text": "that slightly bit more of flexibility",
    "start": "815120",
    "end": "818079"
  },
  {
    "text": "uh we've also reduced the complexity of",
    "start": "818079",
    "end": "820399"
  },
  {
    "text": "our policy by using CL optional types to",
    "start": "820399",
    "end": "823200"
  },
  {
    "text": "make expressions more concise",
    "start": "823200",
    "end": "826800"
  },
  {
    "text": "we've added uh even further flexibility",
    "start": "826800",
    "end": "829279"
  },
  {
    "text": "by introducing namespace parameter",
    "start": "829279",
    "end": "831600"
  },
  {
    "text": "resources this allows us to take that",
    "start": "831600",
    "end": "834079"
  },
  {
    "text": "single policy and configure it",
    "start": "834079",
    "end": "835839"
  },
  {
    "text": "differently across each namespace uh",
    "start": "835839",
    "end": "838639"
  },
  {
    "text": "depending on that namespace's security",
    "start": "838639",
    "end": "841120"
  },
  {
    "text": "requirements and capabilities needs",
    "start": "841120",
    "end": "844240"
  },
  {
    "text": "we've introduced a podsp spec variable",
    "start": "844240",
    "end": "846399"
  },
  {
    "text": "to allow our policy to validate multiple",
    "start": "846399",
    "end": "848959"
  },
  {
    "text": "kinds of pod creating resources within a",
    "start": "848959",
    "end": "851440"
  },
  {
    "text": "single expression",
    "start": "851440",
    "end": "853279"
  },
  {
    "text": "uh and finally we've given our users",
    "start": "853279",
    "end": "855199"
  },
  {
    "text": "some helpful error messages uh to",
    "start": "855199",
    "end": "857519"
  },
  {
    "text": "troubleshoot whenever they run into",
    "start": "857519",
    "end": "859440"
  },
  {
    "text": "issues so now we have a production grade",
    "start": "859440",
    "end": "862720"
  },
  {
    "text": "policy but how are we going to safely",
    "start": "862720",
    "end": "864800"
  },
  {
    "text": "and securely migrate from our old OP",
    "start": "864800",
    "end": "867519"
  },
  {
    "text": "gatekeeper setup to our new validating",
    "start": "867519",
    "end": "869680"
  },
  {
    "text": "admission policy setup so we can first",
    "start": "869680",
    "end": "872720"
  },
  {
    "text": "do this by utilizing VAP's audit",
    "start": "872720",
    "end": "875360"
  },
  {
    "text": "validation action so you can see in the",
    "start": "875360",
    "end": "877680"
  },
  {
    "text": "top left our policy binding resource and",
    "start": "877680",
    "end": "879760"
  },
  {
    "text": "how we specify that so in audit VIP will",
    "start": "879760",
    "end": "883600"
  },
  {
    "text": "log all policy violations to a specified",
    "start": "883600",
    "end": "886320"
  },
  {
    "text": "audit log and if audit is the only",
    "start": "886320",
    "end": "888720"
  },
  {
    "text": "validation action it won't actually deny",
    "start": "888720",
    "end": "890959"
  },
  {
    "text": "requests at this time so this gives us",
    "start": "890959",
    "end": "893519"
  },
  {
    "text": "some time to check the validity and",
    "start": "893519",
    "end": "895760"
  },
  {
    "text": "behavior of our policies",
    "start": "895760",
    "end": "898399"
  },
  {
    "text": "so you can see in the top right",
    "start": "898399",
    "end": "900079"
  },
  {
    "text": "validating admission policies are",
    "start": "900079",
    "end": "901680"
  },
  {
    "text": "evaluated before validating admission",
    "start": "901680",
    "end": "903760"
  },
  {
    "text": "web hooks which is where opa gatekeeper",
    "start": "903760",
    "end": "906079"
  },
  {
    "text": "runs so when we're checking we can uh we",
    "start": "906079",
    "end": "909279"
  },
  {
    "text": "will check the validity of our policies",
    "start": "909279",
    "end": "911519"
  },
  {
    "text": "by first seeing all policy violations",
    "start": "911519",
    "end": "913839"
  },
  {
    "text": "logged in vap's audit and then",
    "start": "913839",
    "end": "916079"
  },
  {
    "text": "subsequently um denied admission by opa",
    "start": "916079",
    "end": "919240"
  },
  {
    "text": "gatekeeper consequently we should also",
    "start": "919240",
    "end": "921600"
  },
  {
    "text": "see that every single um pod admission",
    "start": "921600",
    "end": "924880"
  },
  {
    "text": "denial from OB Gatekeeper has a matching",
    "start": "924880",
    "end": "928240"
  },
  {
    "text": "um policy violation in our VIP audit log",
    "start": "928240",
    "end": "932480"
  },
  {
    "text": "so to check that every single one of our",
    "start": "932480",
    "end": "934639"
  },
  {
    "text": "policies that we've migrated from Opa",
    "start": "934639",
    "end": "936720"
  },
  {
    "text": "Gatekeeper to VIP are correct we've made",
    "start": "936720",
    "end": "939519"
  },
  {
    "text": "sure to uh create some unit and",
    "start": "939519",
    "end": "942399"
  },
  {
    "text": "endto-end tests to check every single",
    "start": "942399",
    "end": "944399"
  },
  {
    "text": "one of our policies and make sure that",
    "start": "944399",
    "end": "946720"
  },
  {
    "text": "they have matching behaviors so now that",
    "start": "946720",
    "end": "949839"
  },
  {
    "text": "we're sure that our new policies are",
    "start": "949839",
    "end": "952160"
  },
  {
    "text": "correct how are we going to start",
    "start": "952160",
    "end": "953839"
  },
  {
    "text": "telling VIP to actually start denying",
    "start": "953839",
    "end": "956240"
  },
  {
    "text": "our requests",
    "start": "956240",
    "end": "958800"
  },
  {
    "text": "so once we're confident that VIAP uh all",
    "start": "958800",
    "end": "961680"
  },
  {
    "text": "of our policies are ready to go we can",
    "start": "961680",
    "end": "964320"
  },
  {
    "text": "then add the deny configuration there in",
    "start": "964320",
    "end": "966639"
  },
  {
    "text": "the top left to our binding resource and",
    "start": "966639",
    "end": "969279"
  },
  {
    "text": "again because validating admission",
    "start": "969279",
    "end": "970959"
  },
  {
    "text": "policy runs before validation web hooks",
    "start": "970959",
    "end": "973839"
  },
  {
    "text": "in our admission control chain we will",
    "start": "973839",
    "end": "976480"
  },
  {
    "text": "now start seeing uh admission denials",
    "start": "976480",
    "end": "979040"
  },
  {
    "text": "come from validation admission policy",
    "start": "979040",
    "end": "981519"
  },
  {
    "text": "before they ever get to gatekeeper we",
    "start": "981519",
    "end": "983839"
  },
  {
    "text": "can again confirm that our policies are",
    "start": "983839",
    "end": "986320"
  },
  {
    "text": "correct and match our old gatekeeper",
    "start": "986320",
    "end": "988160"
  },
  {
    "text": "policies by confirming we no longer see",
    "start": "988160",
    "end": "990720"
  },
  {
    "text": "any admission denials within Gatekeeper",
    "start": "990720",
    "end": "993040"
  },
  {
    "text": "itself",
    "start": "993040",
    "end": "994480"
  },
  {
    "text": "once we're confident that this is the",
    "start": "994480",
    "end": "996000"
  },
  {
    "text": "case we're free to go ahead and",
    "start": "996000",
    "end": "997199"
  },
  {
    "text": "decommission uh gatekeeper and uh",
    "start": "997199",
    "end": "1000160"
  },
  {
    "text": "complete our migration um but now that",
    "start": "1000160",
    "end": "1003519"
  },
  {
    "text": "we're done and validating a mission",
    "start": "1003519",
    "end": "1005519"
  },
  {
    "text": "policy is now in the critical path we",
    "start": "1005519",
    "end": "1007759"
  },
  {
    "text": "need to make sure that it's running",
    "start": "1007759",
    "end": "1009040"
  },
  {
    "text": "reliably and",
    "start": "1009040",
    "end": "1011000"
  },
  {
    "text": "smoothly so um a few ways to do that",
    "start": "1011000",
    "end": "1015040"
  },
  {
    "text": "first of all we can take a look at some",
    "start": "1015040",
    "end": "1016560"
  },
  {
    "text": "metrics that Kubernetes offers us um now",
    "start": "1016560",
    "end": "1020399"
  },
  {
    "text": "that we've moved our emission control",
    "start": "1020399",
    "end": "1022160"
  },
  {
    "text": "from an external web hook into our API",
    "start": "1022160",
    "end": "1025199"
  },
  {
    "text": "server the first thing we want to do is",
    "start": "1025199",
    "end": "1026959"
  },
  {
    "text": "make sure that the API server is running",
    "start": "1026959",
    "end": "1029280"
  },
  {
    "text": "healthy uh running with good health and",
    "start": "1029280",
    "end": "1031600"
  },
  {
    "text": "reliably um and so two um metrics that",
    "start": "1031600",
    "end": "1035520"
  },
  {
    "text": "we can use to do that are the total",
    "start": "1035520",
    "end": "1037520"
  },
  {
    "text": "number of policy checks and the duration",
    "start": "1037520",
    "end": "1040240"
  },
  {
    "text": "those uh checks are taking so to further",
    "start": "1040240",
    "end": "1043600"
  },
  {
    "text": "monitor that our validation expressions",
    "start": "1043600",
    "end": "1045760"
  },
  {
    "text": "aren't causing havoc to our API servers",
    "start": "1045760",
    "end": "1048240"
  },
  {
    "text": "we can look in at an additional two",
    "start": "1048240",
    "end": "1050400"
  },
  {
    "text": "metrics provided to us by the API server",
    "start": "1050400",
    "end": "1053039"
  },
  {
    "text": "so these two at the bottom right concern",
    "start": "1053039",
    "end": "1055039"
  },
  {
    "text": "CL compilation and evaluation",
    "start": "1055039",
    "end": "1057559"
  },
  {
    "text": "duration so the caveat to these metrics",
    "start": "1057559",
    "end": "1060240"
  },
  {
    "text": "is that they are aggregates of all CL",
    "start": "1060240",
    "end": "1062480"
  },
  {
    "text": "expressions across your API server so",
    "start": "1062480",
    "end": "1064799"
  },
  {
    "text": "this doesn't just include the",
    "start": "1064799",
    "end": "1066559"
  },
  {
    "text": "expressions in your policies but also",
    "start": "1066559",
    "end": "1068880"
  },
  {
    "text": "expressions used for CRD validation um",
    "start": "1068880",
    "end": "1072640"
  },
  {
    "text": "even though these are aggregates they do",
    "start": "1072640",
    "end": "1075679"
  },
  {
    "text": "give you a general sense of how CL in",
    "start": "1075679",
    "end": "1078000"
  },
  {
    "text": "general is affecting your API server but",
    "start": "1078000",
    "end": "1081039"
  },
  {
    "text": "if you did want to pinpoint exactly",
    "start": "1081039",
    "end": "1083120"
  },
  {
    "text": "which expressions may be causing you",
    "start": "1083120",
    "end": "1085120"
  },
  {
    "text": "trouble there are some great",
    "start": "1085120",
    "end": "1086480"
  },
  {
    "text": "troubleshooting tools out there um such",
    "start": "1086480",
    "end": "1088799"
  },
  {
    "text": "as this playground so as you can see",
    "start": "1088799",
    "end": "1091600"
  },
  {
    "text": "here we've input our validating",
    "start": "1091600",
    "end": "1093520"
  },
  {
    "text": "admission policy and some test request",
    "start": "1093520",
    "end": "1095520"
  },
  {
    "text": "objects so this tool allows us to kind",
    "start": "1095520",
    "end": "1098480"
  },
  {
    "text": "of check the um the validity of our",
    "start": "1098480",
    "end": "1101360"
  },
  {
    "text": "policy and of our",
    "start": "1101360",
    "end": "1103720"
  },
  {
    "text": "expressions on the bottom right side of",
    "start": "1103720",
    "end": "1106000"
  },
  {
    "text": "our playground you can see that it has a",
    "start": "1106000",
    "end": "1109760"
  },
  {
    "text": "validation cost associated with it so",
    "start": "1109760",
    "end": "1112640"
  },
  {
    "text": "the API server has a concept called the",
    "start": "1112640",
    "end": "1115039"
  },
  {
    "text": "validation cost budget um to protect",
    "start": "1115039",
    "end": "1118240"
  },
  {
    "text": "itself from any runaway CL expressions",
    "start": "1118240",
    "end": "1121679"
  },
  {
    "text": "so down below you can see there's a",
    "start": "1121679",
    "end": "1123440"
  },
  {
    "text": "static estimated cost limit which is the",
    "start": "1123440",
    "end": "1125600"
  },
  {
    "text": "largest allowed static CL cost on a per",
    "start": "1125600",
    "end": "1128480"
  },
  {
    "text": "expression basis and this is hardcoded",
    "start": "1128480",
    "end": "1131600"
  },
  {
    "text": "to 10",
    "start": "1131600",
    "end": "1132760"
  },
  {
    "text": "million so as you can see on our",
    "start": "1132760",
    "end": "1135039"
  },
  {
    "text": "playground our capabilities policy that",
    "start": "1135039",
    "end": "1137520"
  },
  {
    "text": "we showed today has costs associated",
    "start": "1137520",
    "end": "1140000"
  },
  {
    "text": "with each one of its variables and above",
    "start": "1140000",
    "end": "1142480"
  },
  {
    "text": "those you can see a total cost of the",
    "start": "1142480",
    "end": "1144320"
  },
  {
    "text": "policy so this total cost is a sum of",
    "start": "1144320",
    "end": "1147360"
  },
  {
    "text": "all the costs of the variables and all",
    "start": "1147360",
    "end": "1149919"
  },
  {
    "text": "of the expressions and message",
    "start": "1149919",
    "end": "1152120"
  },
  {
    "text": "expressions so you can see our total",
    "start": "1152120",
    "end": "1154559"
  },
  {
    "text": "cost of our policy today is relatively",
    "start": "1154559",
    "end": "1157200"
  },
  {
    "text": "low in comparison to the hard-coded 10",
    "start": "1157200",
    "end": "1159760"
  },
  {
    "text": "million but validation cost is still",
    "start": "1159760",
    "end": "1162320"
  },
  {
    "text": "something important to keep in mind um",
    "start": "1162320",
    "end": "1164559"
  },
  {
    "text": "this is because your costs can",
    "start": "1164559",
    "end": "1166559"
  },
  {
    "text": "exponentially increase especially with",
    "start": "1166559",
    "end": "1168480"
  },
  {
    "text": "the use of nested and chain macros so um",
    "start": "1168480",
    "end": "1171760"
  },
  {
    "text": "validation cost and validation cost",
    "start": "1171760",
    "end": "1173600"
  },
  {
    "text": "budget is still important to keep in",
    "start": "1173600",
    "end": "1175200"
  },
  {
    "text": "mind to protect the reliability of your",
    "start": "1175200",
    "end": "1177440"
  },
  {
    "text": "API server",
    "start": "1177440",
    "end": "1180559"
  },
  {
    "text": "so we kind of come to the end of the",
    "start": "1180559",
    "end": "1183120"
  },
  {
    "text": "topics we wanted to cover today so I",
    "start": "1183120",
    "end": "1184960"
  },
  {
    "text": "just wanted to kind of highlight and",
    "start": "1184960",
    "end": "1186160"
  },
  {
    "text": "summarize what we've discussed uh so far",
    "start": "1186160",
    "end": "1188720"
  },
  {
    "text": "so at the beginning we talked a little",
    "start": "1188720",
    "end": "1190559"
  },
  {
    "text": "bit about data dog's kind of history",
    "start": "1190559",
    "end": "1192400"
  },
  {
    "text": "with uh admission policy and some of our",
    "start": "1192400",
    "end": "1195440"
  },
  {
    "text": "motivations for migrating to validation",
    "start": "1195440",
    "end": "1198720"
  },
  {
    "text": "admission policy namely moving from that",
    "start": "1198720",
    "end": "1201600"
  },
  {
    "text": "external web hook to an entry process",
    "start": "1201600",
    "end": "1204880"
  },
  {
    "text": "next we stepped you through one of our",
    "start": "1204880",
    "end": "1207520"
  },
  {
    "text": "uh policies to show you how we kind of",
    "start": "1207520",
    "end": "1209600"
  },
  {
    "text": "took an outofthe-box tutorial and put it",
    "start": "1209600",
    "end": "1212240"
  },
  {
    "text": "and evolved it to something that we feel",
    "start": "1212240",
    "end": "1214320"
  },
  {
    "text": "comfortable deploying out into",
    "start": "1214320",
    "end": "1216000"
  },
  {
    "text": "production namely uh how we used",
    "start": "1216000",
    "end": "1218559"
  },
  {
    "text": "variables to simplify our configuration",
    "start": "1218559",
    "end": "1221200"
  },
  {
    "text": "how we added parameters to uh increase",
    "start": "1221200",
    "end": "1224400"
  },
  {
    "text": "flexibility into our policy and finally",
    "start": "1224400",
    "end": "1227120"
  },
  {
    "text": "how we're helping our users troubleshoot",
    "start": "1227120",
    "end": "1229440"
  },
  {
    "text": "whenever they run into",
    "start": "1229440",
    "end": "1231320"
  },
  {
    "text": "issues uh finally uh after uh after the",
    "start": "1231320",
    "end": "1235600"
  },
  {
    "text": "migration we showed you a few uh",
    "start": "1235600",
    "end": "1238159"
  },
  {
    "text": "monitoring and metrics to keep an eye on",
    "start": "1238159",
    "end": "1240880"
  },
  {
    "text": "to ensure your API server health and",
    "start": "1240880",
    "end": "1243840"
  },
  {
    "text": "reliability",
    "start": "1243840",
    "end": "1246480"
  },
  {
    "text": "so uh this might seem like a lot but",
    "start": "1246480",
    "end": "1248720"
  },
  {
    "text": "we've still got plenty to talk about",
    "start": "1248720",
    "end": "1250480"
  },
  {
    "text": "unfortunately we won't be able to cover",
    "start": "1250480",
    "end": "1252480"
  },
  {
    "text": "all of this uh in our talk but just",
    "start": "1252480",
    "end": "1254960"
  },
  {
    "text": "wanted to leave you with some day two",
    "start": "1254960",
    "end": "1256799"
  },
  {
    "text": "operations um and some next steps that",
    "start": "1256799",
    "end": "1259600"
  },
  {
    "text": "that we've been thinking about and um",
    "start": "1259600",
    "end": "1262080"
  },
  {
    "text": "some ideas that you might be able to",
    "start": "1262080",
    "end": "1264000"
  },
  {
    "text": "take back um first of all in our policy",
    "start": "1264000",
    "end": "1267360"
  },
  {
    "text": "we were just talking about our main uh",
    "start": "1267360",
    "end": "1270320"
  },
  {
    "text": "containers in our pods and pod creating",
    "start": "1270320",
    "end": "1272320"
  },
  {
    "text": "resources however both ephemeral and",
    "start": "1272320",
    "end": "1274880"
  },
  {
    "text": "init containers can also add",
    "start": "1274880",
    "end": "1277440"
  },
  {
    "text": "capabilities to their security context",
    "start": "1277440",
    "end": "1279840"
  },
  {
    "text": "and so expanding the scope of our",
    "start": "1279840",
    "end": "1281760"
  },
  {
    "text": "policies to cover these is something",
    "start": "1281760",
    "end": "1284159"
  },
  {
    "text": "that we have to cover as well um further",
    "start": "1284159",
    "end": "1287840"
  },
  {
    "text": "um adding flexibility into our policies",
    "start": "1287840",
    "end": "1290640"
  },
  {
    "text": "uh at data dog we inject sidecars into",
    "start": "1290640",
    "end": "1293440"
  },
  {
    "text": "many of our workloads um some of those",
    "start": "1293440",
    "end": "1295760"
  },
  {
    "text": "sidecars might need uh additional",
    "start": "1295760",
    "end": "1298240"
  },
  {
    "text": "capabilities and it would be kind of a",
    "start": "1298240",
    "end": "1300960"
  },
  {
    "text": "lot of manual toil to go in and add",
    "start": "1300960",
    "end": "1303120"
  },
  {
    "text": "those exclusions one by one uh so we've",
    "start": "1303120",
    "end": "1306080"
  },
  {
    "text": "added an additional parameter or",
    "start": "1306080",
    "end": "1308320"
  },
  {
    "text": "additional variable into our policies",
    "start": "1308320",
    "end": "1310559"
  },
  {
    "text": "which basically maps a given container",
    "start": "1310559",
    "end": "1312880"
  },
  {
    "text": "image name and an allowed list of",
    "start": "1312880",
    "end": "1315480"
  },
  {
    "text": "capabilities to automatically allow",
    "start": "1315480",
    "end": "1318400"
  },
  {
    "text": "admission to these uh sidecars",
    "start": "1318400",
    "end": "1322240"
  },
  {
    "text": "uh we've been really happy using the ED",
    "start": "1322240",
    "end": "1324640"
  },
  {
    "text": "framework to uh to run our end toend",
    "start": "1324640",
    "end": "1327440"
  },
  {
    "text": "tests like Caitlyn mentioned to ensure",
    "start": "1327440",
    "end": "1329760"
  },
  {
    "text": "we're not regressing uh any of our",
    "start": "1329760",
    "end": "1332000"
  },
  {
    "text": "policies and you know just to double",
    "start": "1332000",
    "end": "1333919"
  },
  {
    "text": "check that what we're running locally uh",
    "start": "1333919",
    "end": "1335840"
  },
  {
    "text": "and developing locally is what's",
    "start": "1335840",
    "end": "1337360"
  },
  {
    "text": "actually happening out on our",
    "start": "1337360",
    "end": "1339480"
  },
  {
    "text": "clusters uh I'm really excited about the",
    "start": "1339480",
    "end": "1342559"
  },
  {
    "text": "self-service platform that we are",
    "start": "1342559",
    "end": "1344240"
  },
  {
    "text": "developing internally at data dog as",
    "start": "1344240",
    "end": "1346320"
  },
  {
    "text": "APIdriven way for our end users to",
    "start": "1346320",
    "end": "1348960"
  },
  {
    "text": "request exclusions basically the",
    "start": "1348960",
    "end": "1351280"
  },
  {
    "text": "contents of those parameter resources um",
    "start": "1351280",
    "end": "1354159"
  },
  {
    "text": "and be able to configure that and be",
    "start": "1354159",
    "end": "1355679"
  },
  {
    "text": "able to request it uh themselves while",
    "start": "1355679",
    "end": "1358080"
  },
  {
    "text": "getting an a security review from us um",
    "start": "1358080",
    "end": "1362480"
  },
  {
    "text": "and finally we've got some really cool",
    "start": "1362480",
    "end": "1364000"
  },
  {
    "text": "ideas about how to prune um and identify",
    "start": "1364000",
    "end": "1367440"
  },
  {
    "text": "and prune unneeded policy exclusions",
    "start": "1367440",
    "end": "1370400"
  },
  {
    "text": "over time uh workloads might change uh",
    "start": "1370400",
    "end": "1374000"
  },
  {
    "text": "namespaces might be abandoned and",
    "start": "1374000",
    "end": "1376559"
  },
  {
    "text": "leaving those policy exclusions in place",
    "start": "1376559",
    "end": "1378960"
  },
  {
    "text": "just creates a little bit of a security",
    "start": "1378960",
    "end": "1380559"
  },
  {
    "text": "risk and so we've got some ideas on how",
    "start": "1380559",
    "end": "1382880"
  },
  {
    "text": "to identify those and ultimately uh get",
    "start": "1382880",
    "end": "1385440"
  },
  {
    "text": "rid of those so that all being said uh",
    "start": "1385440",
    "end": "1388320"
  },
  {
    "text": "we're wrapping up if you would love to",
    "start": "1388320",
    "end": "1390799"
  },
  {
    "text": "uh if you'd love to see more of this uh",
    "start": "1390799",
    "end": "1392720"
  },
  {
    "text": "please leave us a review uh we'd love to",
    "start": "1392720",
    "end": "1395200"
  },
  {
    "text": "present more on these topics later um we",
    "start": "1395200",
    "end": "1398400"
  },
  {
    "text": "uh are both available on LinkedIn if",
    "start": "1398400",
    "end": "1400720"
  },
  {
    "text": "you'd like to connect and talk with us",
    "start": "1400720",
    "end": "1402640"
  },
  {
    "text": "um and we'd be happy to take any",
    "start": "1402640",
    "end": "1404559"
  },
  {
    "text": "questions thank you very much thank you",
    "start": "1404559",
    "end": "1409480"
  },
  {
    "text": "is this on yeah hello uh thanks for your",
    "start": "1418000",
    "end": "1420880"
  },
  {
    "text": "talk was great um I have two questions",
    "start": "1420880",
    "end": "1424640"
  },
  {
    "text": "um how do you reference other resources",
    "start": "1424640",
    "end": "1427760"
  },
  {
    "text": "in the cluster in your uh policies do",
    "start": "1427760",
    "end": "1430960"
  },
  {
    "text": "you just load those in as parameters or",
    "start": "1430960",
    "end": "1433840"
  },
  {
    "text": "is there a better way you referring to",
    "start": "1433840",
    "end": "1436799"
  },
  {
    "text": "the parameter resources yes exactly like",
    "start": "1436799",
    "end": "1439760"
  },
  {
    "text": "if you want to write a cell policy um",
    "start": "1439760",
    "end": "1442480"
  },
  {
    "text": "that uh has some dependency on a the",
    "start": "1442480",
    "end": "1445679"
  },
  {
    "text": "value in another resource on the cluster",
    "start": "1445679",
    "end": "1448880"
  },
  {
    "text": "um can you do that somehow right um uh",
    "start": "1448880",
    "end": "1452799"
  },
  {
    "text": "we don't have the slides back up but",
    "start": "1452799",
    "end": "1454240"
  },
  {
    "text": "yeah exactly if you take a look at the",
    "start": "1454240",
    "end": "1455840"
  },
  {
    "text": "slide uh referring to the policy",
    "start": "1455840",
    "end": "1457760"
  },
  {
    "text": "resources here you can specify the API",
    "start": "1457760",
    "end": "1460880"
  },
  {
    "text": "version and kind of the resource that",
    "start": "1460880",
    "end": "1463600"
  },
  {
    "text": "you want to look at and then um actually",
    "start": "1463600",
    "end": "1466320"
  },
  {
    "text": "add the the path the the spec path that",
    "start": "1466320",
    "end": "1469120"
  },
  {
    "text": "you want there in the CL expression um I",
    "start": "1469120",
    "end": "1472480"
  },
  {
    "text": "didn't mention it uh explicitly but",
    "start": "1472480",
    "end": "1474320"
  },
  {
    "text": "there in box four there's a line to",
    "start": "1474320",
    "end": "1476400"
  },
  {
    "text": "basically configure your policy what to",
    "start": "1476400",
    "end": "1478720"
  },
  {
    "text": "do if that parameter doesn't exist in",
    "start": "1478720",
    "end": "1482320"
  },
  {
    "text": "your namespace or is somehow uh yeah",
    "start": "1482320",
    "end": "1485039"
  },
  {
    "text": "missing does that answer your question",
    "start": "1485039",
    "end": "1487200"
  },
  {
    "text": "okay so yes parameters are the right way",
    "start": "1487200",
    "end": "1489679"
  },
  {
    "text": "to go for that okay um wait what was the",
    "start": "1489679",
    "end": "1493679"
  },
  {
    "text": "other question um you mentioned the",
    "start": "1493679",
    "end": "1496159"
  },
  {
    "text": "audit log um to validate if the policies",
    "start": "1496159",
    "end": "1499760"
  },
  {
    "text": "are doing the correct thing did you",
    "start": "1499760",
    "end": "1501840"
  },
  {
    "text": "write a tool or a script to do that and",
    "start": "1501840",
    "end": "1504240"
  },
  {
    "text": "is that open source uh yeah we kind of",
    "start": "1504240",
    "end": "1507039"
  },
  {
    "text": "just parse our audit logs so for this",
    "start": "1507039",
    "end": "1509200"
  },
  {
    "text": "audit log you can specify the path to",
    "start": "1509200",
    "end": "1511840"
  },
  {
    "text": "the log so we just parse it and then",
    "start": "1511840",
    "end": "1514400"
  },
  {
    "text": "also parse our uh open gatekeeper logs",
    "start": "1514400",
    "end": "1516960"
  },
  {
    "text": "and just check that they have matching",
    "start": "1516960",
    "end": "1518640"
  },
  {
    "text": "behavior yeah it was mostly just some",
    "start": "1518640",
    "end": "1521360"
  },
  {
    "text": "some in-house scripting but um there are",
    "start": "1521360",
    "end": "1523840"
  },
  {
    "text": "there's an advanced feature in",
    "start": "1523840",
    "end": "1525600"
  },
  {
    "text": "validating admission policy to add",
    "start": "1525600",
    "end": "1527440"
  },
  {
    "text": "specific audit messages uh and tags and",
    "start": "1527440",
    "end": "1531120"
  },
  {
    "text": "so that could uh be an easier way to",
    "start": "1531120",
    "end": "1533279"
  },
  {
    "text": "kind of filter through um some of the",
    "start": "1533279",
    "end": "1535279"
  },
  {
    "text": "audit logs as well okay thank you",
    "start": "1535279",
    "end": "1540159"
  },
  {
    "text": "hi there um anything that you lost from",
    "start": "1540159",
    "end": "1543840"
  },
  {
    "text": "moving from the web hooks to the the",
    "start": "1543840",
    "end": "1548320"
  },
  {
    "text": "other one the admission policy um one of",
    "start": "1548320",
    "end": "1552799"
  },
  {
    "text": "the things that uh was a bit of a",
    "start": "1552799",
    "end": "1555760"
  },
  {
    "text": "struggle at first was just wrapping our",
    "start": "1555760",
    "end": "1557679"
  },
  {
    "text": "head around CL logic um it's quite a uh",
    "start": "1557679",
    "end": "1561679"
  },
  {
    "text": "it's quite a declarative uh language",
    "start": "1561679",
    "end": "1564080"
  },
  {
    "text": "where you know Rego is a little bit more",
    "start": "1564080",
    "end": "1566000"
  },
  {
    "text": "of a procedural language so just getting",
    "start": "1566000",
    "end": "1568720"
  },
  {
    "text": "our head around that paradigm shift was",
    "start": "1568720",
    "end": "1570880"
  },
  {
    "text": "a little bit of a challenge um and also",
    "start": "1570880",
    "end": "1574000"
  },
  {
    "text": "um you not not necessarily having um",
    "start": "1574000",
    "end": "1578640"
  },
  {
    "text": "userdefined functions within RCL",
    "start": "1578640",
    "end": "1581760"
  },
  {
    "text": "expressions can you know it was",
    "start": "1581760",
    "end": "1583600"
  },
  {
    "text": "something we were missing a little bit",
    "start": "1583600",
    "end": "1584960"
  },
  {
    "text": "from from the reggo language",
    "start": "1584960",
    "end": "1587679"
  },
  {
    "text": "thank you",
    "start": "1587679",
    "end": "1590919"
  },
  {
    "text": "hi uh first of all great talk uh we also",
    "start": "1591360",
    "end": "1594720"
  },
  {
    "text": "quite heavily adopted um validating",
    "start": "1594720",
    "end": "1596799"
  },
  {
    "text": "emission policies uh quite a while ago",
    "start": "1596799",
    "end": "1600080"
  },
  {
    "text": "and we did a very similar approach uh",
    "start": "1600080",
    "end": "1603039"
  },
  {
    "text": "but we started a bit earlier when they",
    "start": "1603039",
    "end": "1604880"
  },
  {
    "text": "were way less powerful and my question",
    "start": "1604880",
    "end": "1608880"
  },
  {
    "text": "would be so I feel like testing this end",
    "start": "1608880",
    "end": "1612159"
  },
  {
    "text": "test is quite cumbersome or it's quite",
    "start": "1612159",
    "end": "1613919"
  },
  {
    "text": "resource intensive and we like do",
    "start": "1613919",
    "end": "1615760"
  },
  {
    "text": "nightly builds on all regions all the",
    "start": "1615760",
    "end": "1618080"
  },
  {
    "text": "time and we when we introduced them",
    "start": "1618080",
    "end": "1620799"
  },
  {
    "text": "played around with trying to write unit",
    "start": "1620799",
    "end": "1623120"
  },
  {
    "text": "tests for validating admission policies",
    "start": "1623120",
    "end": "1625200"
  },
  {
    "text": "themselves in some way but very",
    "start": "1625200",
    "end": "1628000"
  },
  {
    "text": "ungracefully uh failed and I just wanted",
    "start": "1628000",
    "end": "1630799"
  },
  {
    "text": "to ask if you uh touched into that",
    "start": "1630799",
    "end": "1632880"
  },
  {
    "text": "anyways and maybe cuz honestly I I",
    "start": "1632880",
    "end": "1635760"
  },
  {
    "text": "learned a lot today we we're going to",
    "start": "1635760",
    "end": "1637840"
  },
  {
    "text": "definitely go home and rewrite our",
    "start": "1637840",
    "end": "1639120"
  },
  {
    "text": "policies uh uh if there's something",
    "start": "1639120",
    "end": "1642240"
  },
  {
    "text": "happened in this space that made that",
    "start": "1642240",
    "end": "1644000"
  },
  {
    "text": "easier or if there's any movement into",
    "start": "1644000",
    "end": "1646240"
  },
  {
    "text": "that direction is specifically about the",
    "start": "1646240",
    "end": "1648559"
  },
  {
    "text": "unit test yeah specifically uh so I mean",
    "start": "1648559",
    "end": "1650799"
  },
  {
    "text": "it's it's quite simple right it's uh",
    "start": "1650799",
    "end": "1652960"
  },
  {
    "text": "it's basically defining uh a bunch of uh",
    "start": "1652960",
    "end": "1656320"
  },
  {
    "text": "pod resources some that some that pass",
    "start": "1656320",
    "end": "1659039"
  },
  {
    "text": "the uh policies some that fail and uh",
    "start": "1659039",
    "end": "1662080"
  },
  {
    "text": "more or less just like rendering and",
    "start": "1662080",
    "end": "1664159"
  },
  {
    "text": "applying the uh policies into a kind",
    "start": "1664159",
    "end": "1666559"
  },
  {
    "text": "cluster uh and just trying to apply them",
    "start": "1666559",
    "end": "1668960"
  },
  {
    "text": "via dry run uh cubectl and",
    "start": "1668960",
    "end": "1673440"
  },
  {
    "text": "that's what we do we just had for uh",
    "start": "1673440",
    "end": "1676000"
  },
  {
    "text": "open policy agent policy previously like",
    "start": "1676000",
    "end": "1678000"
  },
  {
    "text": "you can test reggo itself in a unit test",
    "start": "1678000",
    "end": "1680640"
  },
  {
    "text": "and we I was just wondering if you",
    "start": "1680640",
    "end": "1682080"
  },
  {
    "text": "played around like doing it in line",
    "start": "1682080",
    "end": "1683360"
  },
  {
    "text": "without the need for for a kind cluster",
    "start": "1683360",
    "end": "1686000"
  },
  {
    "text": "or any cluster or something yeah that um",
    "start": "1686000",
    "end": "1688640"
  },
  {
    "text": "that is a bit of a challenge and kind of",
    "start": "1688640",
    "end": "1690240"
  },
  {
    "text": "what Caitlin was mentioning with the CL",
    "start": "1690240",
    "end": "1691919"
  },
  {
    "text": "playground that's kind of when we're",
    "start": "1691919",
    "end": "1693679"
  },
  {
    "text": "starting to develop CL from scratch from",
    "start": "1693679",
    "end": "1696240"
  },
  {
    "text": "nothing it's a lot of playing around uh",
    "start": "1696240",
    "end": "1698640"
  },
  {
    "text": "in the CL playground okay very similar",
    "start": "1698640",
    "end": "1702080"
  },
  {
    "text": "experience",
    "start": "1702080",
    "end": "1705080"
  },
  {
    "text": "uh hi uh from an application perspective",
    "start": "1705440",
    "end": "1708480"
  },
  {
    "text": "that you want to kind of stay in line",
    "start": "1708480",
    "end": "1710159"
  },
  {
    "text": "with a policy I kind of want to be able",
    "start": "1710159",
    "end": "1712159"
  },
  {
    "text": "to use policies like this as a lint uh",
    "start": "1712159",
    "end": "1715520"
  },
  {
    "text": "is it possible to test my YAML against",
    "start": "1715520",
    "end": "1718880"
  },
  {
    "text": "the policy uh at the client side or",
    "start": "1718880",
    "end": "1721360"
  },
  {
    "text": "would I have to basically set up a test",
    "start": "1721360",
    "end": "1722960"
  },
  {
    "text": "cluster apply the policies and then try",
    "start": "1722960",
    "end": "1725039"
  },
  {
    "text": "to apply my YAML",
    "start": "1725039",
    "end": "1727440"
  },
  {
    "text": "uh yeah that's a challenge you know",
    "start": "1727440",
    "end": "1729520"
  },
  {
    "text": "getting kind of these warnings to",
    "start": "1729520",
    "end": "1731760"
  },
  {
    "text": "application developers earlier in the",
    "start": "1731760",
    "end": "1733520"
  },
  {
    "text": "development cycle um it's something we",
    "start": "1733520",
    "end": "1735600"
  },
  {
    "text": "don't have a great answer for yet but",
    "start": "1735600",
    "end": "1737679"
  },
  {
    "text": "certainly are feeling some of the same",
    "start": "1737679",
    "end": "1739279"
  },
  {
    "text": "pain and yeah if you've got any ideas be",
    "start": "1739279",
    "end": "1741440"
  },
  {
    "text": "happy to to to maybe brainstorm later",
    "start": "1741440",
    "end": "1744159"
  },
  {
    "text": "okay uh thank you very much anyway",
    "start": "1744159",
    "end": "1745760"
  },
  {
    "text": "that's a really good talk thank you",
    "start": "1745760",
    "end": "1750559"
  },
  {
    "text": "okay thanks very much everyone",
    "start": "1750559",
    "end": "1753919"
  }
]