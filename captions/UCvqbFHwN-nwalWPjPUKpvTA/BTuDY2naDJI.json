[
  {
    "text": "alright let's get started yeah this is a",
    "start": "230",
    "end": "4080"
  },
  {
    "text": "last stop before lunch so we'll try our",
    "start": "4080",
    "end": "5670"
  },
  {
    "text": "best to be timely as possible so my name",
    "start": "5670",
    "end": "10559"
  },
  {
    "text": "is Lena Cho and this is Tom we both work",
    "start": "10559",
    "end": "13980"
  },
  {
    "text": "out lifts I work on a service mesh and",
    "start": "13980",
    "end": "16080"
  },
  {
    "text": "slash networking team and Tom works in",
    "start": "16080",
    "end": "18119"
  },
  {
    "text": "the deploys team and we're here to talk",
    "start": "18119",
    "end": "20100"
  },
  {
    "text": "to you about our starfish most service",
    "start": "20100",
    "end": "23640"
  },
  {
    "text": "managed my gracious to Cooper Nettie's",
    "start": "23640",
    "end": "25320"
  },
  {
    "text": "and all the specific issues we came",
    "start": "25320",
    "end": "28980"
  },
  {
    "text": "around and hopefully this will this will",
    "start": "28980",
    "end": "33329"
  },
  {
    "text": "give you some learnings so that when",
    "start": "33329",
    "end": "35880"
  },
  {
    "text": "you're in your process of your migration",
    "start": "35880",
    "end": "37469"
  },
  {
    "text": "you could take these learnings with you",
    "start": "37469",
    "end": "39890"
  },
  {
    "text": "so we separate the talk into three parts",
    "start": "39890",
    "end": "42899"
  },
  {
    "text": "first is giving you context of our",
    "start": "42899",
    "end": "44969"
  },
  {
    "text": "service discovery architecture legacy",
    "start": "44969",
    "end": "47969"
  },
  {
    "text": "versus kubernetes we'll quickly go",
    "start": "47969",
    "end": "50039"
  },
  {
    "text": "through that so you have the context to",
    "start": "50039",
    "end": "51690"
  },
  {
    "text": "understand the issues and so we broke up",
    "start": "51690",
    "end": "54329"
  },
  {
    "text": "the issues into scaling up as well as",
    "start": "54329",
    "end": "56820"
  },
  {
    "text": "scaling down on kubernetes",
    "start": "56820",
    "end": "58649"
  },
  {
    "text": "and then we are going to close it all up",
    "start": "58649",
    "end": "62039"
  },
  {
    "text": "with future work that's still left to do",
    "start": "62039",
    "end": "65059"
  },
  {
    "text": "so yeah our service discovery is fairly",
    "start": "65060",
    "end": "68880"
  },
  {
    "text": "simple how we run envoy as a sidecar and",
    "start": "68880",
    "end": "72810"
  },
  {
    "text": "a bunch of virtual machines and there's",
    "start": "72810",
    "end": "75420"
  },
  {
    "text": "a con job that registers ip's into a",
    "start": "75420",
    "end": "77700"
  },
  {
    "text": "Python discovery service that's stored",
    "start": "77700",
    "end": "79650"
  },
  {
    "text": "in dynamo and then envoy poles for that",
    "start": "79650",
    "end": "84840"
  },
  {
    "text": "data every 30 seconds giving the set of",
    "start": "84840",
    "end": "87030"
  },
  {
    "text": "IP addresses it needs to start routing",
    "start": "87030",
    "end": "88650"
  },
  {
    "text": "traffic to the services it cares about",
    "start": "88650",
    "end": "92240"
  },
  {
    "text": "so this is our hybrid discovery so again",
    "start": "92240",
    "end": "96720"
  },
  {
    "text": "rather than on belay sidecars polling",
    "start": "96720",
    "end": "100049"
  },
  {
    "text": "we've decided to send the old legacy",
    "start": "100049",
    "end": "104340"
  },
  {
    "text": "infrastructure data yeah go into the",
    "start": "104340",
    "end": "108750"
  },
  {
    "text": "control plane so we were migrating over",
    "start": "108750",
    "end": "110369"
  },
  {
    "text": "to access control plane and then also we",
    "start": "110369",
    "end": "113909"
  },
  {
    "text": "which is written and go and we are that",
    "start": "113909",
    "end": "117840"
  },
  {
    "text": "control plane also listens to the",
    "start": "117840",
    "end": "119430"
  },
  {
    "text": "kubernetes api server to get the state",
    "start": "119430",
    "end": "121619"
  },
  {
    "text": "information of all the pods and IP",
    "start": "121619",
    "end": "123689"
  },
  {
    "text": "addresses and just to note that we don't",
    "start": "123689",
    "end": "126810"
  },
  {
    "text": "use ingress controller in our kubernetes",
    "start": "126810",
    "end": "128849"
  },
  {
    "text": "cluster we use each will you see an ISO",
    "start": "128849",
    "end": "132209"
  },
  {
    "text": "each envoy has a router",
    "start": "132209",
    "end": "133709"
  },
  {
    "text": "IP address in each pod has a routable IP",
    "start": "133709",
    "end": "137129"
  },
  {
    "text": "address and can talk to any parts of a V",
    "start": "137129",
    "end": "140579"
  },
  {
    "text": "PC similar to the earlier talk that",
    "start": "140579",
    "end": "144720"
  },
  {
    "text": "Thomas gave today it's basically what we",
    "start": "144720",
    "end": "147900"
  },
  {
    "text": "use and then and then the control plane",
    "start": "147900",
    "end": "151470"
  },
  {
    "text": "that merges both datasets together and",
    "start": "151470",
    "end": "153900"
  },
  {
    "text": "streams that out via xes streaming and",
    "start": "153900",
    "end": "157109"
  },
  {
    "text": "to the sidecar on voice and this is the",
    "start": "157109",
    "end": "160980"
  },
  {
    "text": "biggest change here we're no longer",
    "start": "160980",
    "end": "162269"
  },
  {
    "text": "pulling anymore we're streaming data and",
    "start": "162269",
    "end": "165030"
  },
  {
    "text": "this was a conscious choice so that we",
    "start": "165030",
    "end": "167489"
  },
  {
    "text": "can resolve the service smash as quickly",
    "start": "167489",
    "end": "170280"
  },
  {
    "text": "as possible so to get the benefits of",
    "start": "170280",
    "end": "173670"
  },
  {
    "text": "kubernetes quickly scaling up and",
    "start": "173670",
    "end": "176010"
  },
  {
    "text": "quickly scaling down and then the end of",
    "start": "176010",
    "end": "178799"
  },
  {
    "text": "the day of the final state was what we",
    "start": "178799",
    "end": "180599"
  },
  {
    "text": "is we want the control plate to be run",
    "start": "180599",
    "end": "183510"
  },
  {
    "text": "in our kubernetes cluster and each",
    "start": "183510",
    "end": "186359"
  },
  {
    "text": "krimpet well plan will listen to the get",
    "start": "186359",
    "end": "189930"
  },
  {
    "text": "data from the API server and split it",
    "start": "189930",
    "end": "193470"
  },
  {
    "text": "send that data off to the side car",
    "start": "193470",
    "end": "195599"
  },
  {
    "text": "tomboys it's not clear yet whether we're",
    "start": "195599",
    "end": "197639"
  },
  {
    "text": "gonna make each cluster a separate mesh",
    "start": "197639",
    "end": "199440"
  },
  {
    "text": "but at the end of the day this is kind",
    "start": "199440",
    "end": "201900"
  },
  {
    "text": "of what we want we want the control",
    "start": "201900",
    "end": "203370"
  },
  {
    "text": "plane to be alongside with the pods",
    "start": "203370",
    "end": "205819"
  },
  {
    "text": "sending a discovery data in the",
    "start": "205819",
    "end": "208859"
  },
  {
    "text": "kubernetes cluster so to go into quick",
    "start": "208859",
    "end": "213659"
  },
  {
    "text": "details the control play leverages the",
    "start": "213659",
    "end": "216480"
  },
  {
    "text": "kubernetes Informers which uses the",
    "start": "216480",
    "end": "219720"
  },
  {
    "text": "watch api and that's just basically",
    "start": "219720",
    "end": "221280"
  },
  {
    "text": "syntactic sugar to handle the watch api",
    "start": "221280",
    "end": "224699"
  },
  {
    "text": "events parses them all nicely into nice",
    "start": "224699",
    "end": "226889"
  },
  {
    "text": "go structs and and we and we use the",
    "start": "226889",
    "end": "231209"
  },
  {
    "text": "endpoint objects so kubernetes endpoint",
    "start": "231209",
    "end": "233849"
  },
  {
    "text": "objects which provides the all the IP",
    "start": "233849",
    "end": "237180"
  },
  {
    "text": "addresses for that particular service",
    "start": "237180",
    "end": "239190"
  },
  {
    "text": "and so it provides both old state and",
    "start": "239190",
    "end": "241680"
  },
  {
    "text": "new state and what we do is we just take",
    "start": "241680",
    "end": "244530"
  },
  {
    "text": "the new state and over um merge that",
    "start": "244530",
    "end": "246930"
  },
  {
    "text": "with any legacy IP addresses that are",
    "start": "246930",
    "end": "249150"
  },
  {
    "text": "available merge them all together and",
    "start": "249150",
    "end": "251489"
  },
  {
    "text": "create es data and then send that out",
    "start": "251489",
    "end": "253639"
  },
  {
    "text": "the control and we the other key thing",
    "start": "253639",
    "end": "257849"
  },
  {
    "text": "that we want to mention which will be",
    "start": "257849",
    "end": "260400"
  },
  {
    "text": "important later in the talk is that we",
    "start": "260400",
    "end": "261840"
  },
  {
    "text": "didn't move to streaming xes api's and",
    "start": "261840",
    "end": "264990"
  },
  {
    "text": "this is so that",
    "start": "264990",
    "end": "266910"
  },
  {
    "text": "we could resolve the mesh as quickly as",
    "start": "266910",
    "end": "268830"
  },
  {
    "text": "possible the last piece of information",
    "start": "268830",
    "end": "272190"
  },
  {
    "text": "that we need to go over is how we",
    "start": "272190",
    "end": "275070"
  },
  {
    "text": "configured our CVS so we both have",
    "start": "275070",
    "end": "278640"
  },
  {
    "text": "active health checking turned on and",
    "start": "278640",
    "end": "280890"
  },
  {
    "text": "ever interval of 15 seconds we have",
    "start": "280890",
    "end": "283320"
  },
  {
    "text": "outlier detection enabled so if a",
    "start": "283320",
    "end": "286920"
  },
  {
    "text": "service or a host is sending a",
    "start": "286920",
    "end": "289610"
  },
  {
    "text": "consecutive mine of five five hundreds",
    "start": "289610",
    "end": "291990"
  },
  {
    "text": "or five eckesachs it will get dejected",
    "start": "291990",
    "end": "293420"
  },
  {
    "text": "temporarily from the service mesh and we",
    "start": "293420",
    "end": "295950"
  },
  {
    "text": "also have panic routing enabled so that",
    "start": "295950",
    "end": "298590"
  },
  {
    "text": "is turned on by default and what that",
    "start": "298590",
    "end": "301860"
  },
  {
    "text": "means is that if 50% of the hosts fail",
    "start": "301860",
    "end": "305670"
  },
  {
    "text": "health checks it will start ignoring",
    "start": "305670",
    "end": "308310"
  },
  {
    "text": "health checking status and route traffic",
    "start": "308310",
    "end": "310200"
  },
  {
    "text": "everywhere",
    "start": "310200",
    "end": "312320"
  },
  {
    "text": "so let's now dive into the issues um so",
    "start": "312320",
    "end": "316710"
  },
  {
    "text": "we're going to first talk about scale-up",
    "start": "316710",
    "end": "317970"
  },
  {
    "text": "so Ana kubernetes deployment as most of",
    "start": "317970",
    "end": "321810"
  },
  {
    "text": "you know that there is no such thing as",
    "start": "321810",
    "end": "323940"
  },
  {
    "text": "like a deployment before in our legacy",
    "start": "323940",
    "end": "327300"
  },
  {
    "text": "infrastructure we would hot restart and",
    "start": "327300",
    "end": "329130"
  },
  {
    "text": "so the IP address sets wouldn't change",
    "start": "329130",
    "end": "331530"
  },
  {
    "text": "very much but that's not true in",
    "start": "331530",
    "end": "333000"
  },
  {
    "text": "kubernetes each deployment is basically",
    "start": "333000",
    "end": "335430"
  },
  {
    "text": "a scale-up and that in a scale down so",
    "start": "335430",
    "end": "338930"
  },
  {
    "text": "again we need to we're not propagating",
    "start": "338930",
    "end": "341790"
  },
  {
    "text": "way more information in the mesh in time",
    "start": "341790",
    "end": "344250"
  },
  {
    "text": "and so we're gonna say let's look at",
    "start": "344250",
    "end": "346919"
  },
  {
    "text": "each problem separately and we kind of",
    "start": "346919",
    "end": "351600"
  },
  {
    "text": "made this story around with invitation",
    "start": "351600",
    "end": "354630"
  },
  {
    "text": "to a party so like a pod is coming in",
    "start": "354630",
    "end": "356880"
  },
  {
    "text": "it's like entering a party which is the",
    "start": "356880",
    "end": "358860"
  },
  {
    "text": "server smash so let's dive into scale-up",
    "start": "358860",
    "end": "362090"
  },
  {
    "text": "so it's very important to be polite to",
    "start": "362090",
    "end": "364350"
  },
  {
    "text": "yourself and introduce everyone yourself",
    "start": "364350",
    "end": "366870"
  },
  {
    "text": "to everyone at the party so we have",
    "start": "366870",
    "end": "370500"
  },
  {
    "text": "during scale-up let's say a pod comes up",
    "start": "370500",
    "end": "373640"
  },
  {
    "text": "Cooper nettie the the cube light or the",
    "start": "373640",
    "end": "376530"
  },
  {
    "text": "API server notice is that oh I knew",
    "start": "376530",
    "end": "378930"
  },
  {
    "text": "someone just joined the party so someone",
    "start": "378930",
    "end": "381419"
  },
  {
    "text": "joined the service smash and sends an",
    "start": "381419",
    "end": "383130"
  },
  {
    "text": "event to tell other people or in this",
    "start": "383130",
    "end": "386280"
  },
  {
    "text": "case your downstream services that a new",
    "start": "386280",
    "end": "388320"
  },
  {
    "text": "pod has entered the mesh and so it talks",
    "start": "388320",
    "end": "391710"
  },
  {
    "text": "to the control plane sends that converts",
    "start": "391710",
    "end": "395340"
  },
  {
    "text": "that event into IDs data and sends that",
    "start": "395340",
    "end": "398640"
  },
  {
    "text": "out to the downstream services",
    "start": "398640",
    "end": "400180"
  },
  {
    "text": "and then again you have to introduce",
    "start": "400180",
    "end": "402490"
  },
  {
    "text": "yourself via health checking so the down",
    "start": "402490",
    "end": "404470"
  },
  {
    "text": "tree services sends out a health check",
    "start": "404470",
    "end": "406360"
  },
  {
    "text": "and you notify the ham here I'm help I'm",
    "start": "406360",
    "end": "409180"
  },
  {
    "text": "ready to take traffic however so let's",
    "start": "409180",
    "end": "414009"
  },
  {
    "text": "go back so we've so unfortunately when",
    "start": "414009",
    "end": "417280"
  },
  {
    "text": "we scaled up too quickly",
    "start": "417280",
    "end": "418780"
  },
  {
    "text": "we noticed panic routing would be",
    "start": "418780",
    "end": "420880"
  },
  {
    "text": "enabled so the detent of panic routing",
    "start": "420880",
    "end": "424360"
  },
  {
    "text": "is to prevent thundering herd like his",
    "start": "424360",
    "end": "427479"
  },
  {
    "text": "with our legacy infrastructure scaling",
    "start": "427479",
    "end": "429490"
  },
  {
    "text": "up was quite expensive so we didn't want",
    "start": "429490",
    "end": "431470"
  },
  {
    "text": "all the healthy hosts to get overloaded",
    "start": "431470",
    "end": "433630"
  },
  {
    "text": "so that's the intent with panic routing",
    "start": "433630",
    "end": "436470"
  },
  {
    "text": "but the issue is out during a get",
    "start": "436470",
    "end": "439449"
  },
  {
    "text": "appointment or since it's a scaling",
    "start": "439449",
    "end": "441820"
  },
  {
    "text": "since a similar to us going up of it you",
    "start": "441820",
    "end": "444220"
  },
  {
    "text": "can see that if more than 50% of 50% of",
    "start": "444220",
    "end": "448990"
  },
  {
    "text": "hosts were entered you'll end it",
    "start": "448990",
    "end": "451810"
  },
  {
    "text": "unintentionally enter into panic routing",
    "start": "451810",
    "end": "453970"
  },
  {
    "text": "and that's because they enter an",
    "start": "453970",
    "end": "457120"
  },
  {
    "text": "unhealthy first all at once and then you",
    "start": "457120",
    "end": "459400"
  },
  {
    "text": "have brief moment panic routing and then",
    "start": "459400",
    "end": "461320"
  },
  {
    "text": "it will resolve itself so working with",
    "start": "461320",
    "end": "466630"
  },
  {
    "text": "the open source community was really",
    "start": "466630",
    "end": "468130"
  },
  {
    "text": "great they acknowledge doesn't fix this",
    "start": "468130",
    "end": "470889"
  },
  {
    "text": "it's no create a PR to exclude glued new",
    "start": "470889",
    "end": "477070"
  },
  {
    "text": "hosts into health into the load",
    "start": "477070",
    "end": "478690"
  },
  {
    "text": "balancing calculations for panic routing",
    "start": "478690",
    "end": "480580"
  },
  {
    "text": "this works both for panic routing and",
    "start": "480580",
    "end": "482889"
  },
  {
    "text": "priority spillover and you can and",
    "start": "482889",
    "end": "485500"
  },
  {
    "text": "basically you have to enable it in your",
    "start": "485500",
    "end": "487240"
  },
  {
    "text": "CVS file but this has solved that",
    "start": "487240",
    "end": "489130"
  },
  {
    "text": "problem so now if you have this if you",
    "start": "489130",
    "end": "491860"
  },
  {
    "text": "have this configuration enabled it won't",
    "start": "491860",
    "end": "494080"
  },
  {
    "text": "include new hosts into the panic routing",
    "start": "494080",
    "end": "497710"
  },
  {
    "text": "calculation so the second issue we ran",
    "start": "497710",
    "end": "501430"
  },
  {
    "text": "into was a voice start out so a lot of",
    "start": "501430",
    "end": "504220"
  },
  {
    "text": "applications that lift assume that envoy",
    "start": "504220",
    "end": "507070"
  },
  {
    "text": "will be ready to serve traffic and then",
    "start": "507070",
    "end": "509169"
  },
  {
    "text": "look it's the infrastructure that was",
    "start": "509169",
    "end": "510520"
  },
  {
    "text": "true like when you at deployment",
    "start": "510520",
    "end": "513130"
  },
  {
    "text": "happened you would what was it you would",
    "start": "513130",
    "end": "518130"
  },
  {
    "text": "on boy would still be there it was an",
    "start": "518130",
    "end": "520599"
  },
  {
    "text": "immutable infrastructure so when it was",
    "start": "520599",
    "end": "523570"
  },
  {
    "text": "hot we started Amelie will still be",
    "start": "523570",
    "end": "524980"
  },
  {
    "text": "running and when you scaled up in her",
    "start": "524980",
    "end": "527200"
  },
  {
    "text": "legacy infrastructure usually on boy was",
    "start": "527200",
    "end": "529660"
  },
  {
    "text": "started off first then your application",
    "start": "529660",
    "end": "532060"
  },
  {
    "text": "was started",
    "start": "532060",
    "end": "533000"
  },
  {
    "text": "um but that is not true with kubernetes",
    "start": "533000",
    "end": "537610"
  },
  {
    "text": "in kubernetes all the site cars are",
    "start": "537610",
    "end": "540530"
  },
  {
    "text": "started up altogether and so and so it",
    "start": "540530",
    "end": "545930"
  },
  {
    "text": "could be the case where your application",
    "start": "545930",
    "end": "547610"
  },
  {
    "text": "will be ready to run first and then",
    "start": "547610",
    "end": "549410"
  },
  {
    "text": "envoy would and and all we would not be",
    "start": "549410",
    "end": "552410"
  },
  {
    "text": "there and the one solution was to get",
    "start": "552410",
    "end": "556130"
  },
  {
    "text": "people to change their code and make an",
    "start": "556130",
    "end": "559010"
  },
  {
    "text": "entry and all that case but that's not a",
    "start": "559010",
    "end": "561290"
  },
  {
    "text": "really great experience for our product",
    "start": "561290",
    "end": "563810"
  },
  {
    "text": "engineers and also getting people to",
    "start": "563810",
    "end": "565880"
  },
  {
    "text": "change code will just end up delaying",
    "start": "565880",
    "end": "568370"
  },
  {
    "text": "our kubernetes migration even further so",
    "start": "568370",
    "end": "570770"
  },
  {
    "text": "we need to come up with a different",
    "start": "570770",
    "end": "571730"
  },
  {
    "text": "approach so we did two things one is we",
    "start": "571730",
    "end": "575420"
  },
  {
    "text": "edited edited what readiness means for",
    "start": "575420",
    "end": "578420"
  },
  {
    "text": "the Envoy a sidecar container so we",
    "start": "578420",
    "end": "580490"
  },
  {
    "text": "listen to the ready admin endpoint and",
    "start": "580490",
    "end": "582710"
  },
  {
    "text": "what that does is it will wait until all",
    "start": "582710",
    "end": "585200"
  },
  {
    "text": "the xes configuration is initialized",
    "start": "585200",
    "end": "588170"
  },
  {
    "text": "from your control plane however if you",
    "start": "588170",
    "end": "590840"
  },
  {
    "text": "have initialization time outset it will",
    "start": "590840",
    "end": "594410"
  },
  {
    "text": "respect that and after a certain time",
    "start": "594410",
    "end": "597170"
  },
  {
    "text": "and if he hasn't initialized during that",
    "start": "597170",
    "end": "599750"
  },
  {
    "text": "time out the readying the ready employee",
    "start": "599750",
    "end": "601970"
  },
  {
    "text": "will send it 200 after that timeout so",
    "start": "601970",
    "end": "604550"
  },
  {
    "text": "that's something to watch out for this",
    "start": "604550",
    "end": "606680"
  },
  {
    "text": "the second thing is that we we ended up",
    "start": "606680",
    "end": "609710"
  },
  {
    "text": "working kubernetes so that we can start",
    "start": "609710",
    "end": "612080"
  },
  {
    "text": "we can implement ordering and so through",
    "start": "612080",
    "end": "615380"
  },
  {
    "text": "that we ended up implementing container",
    "start": "615380",
    "end": "619700"
  },
  {
    "text": "ordering in that fork and it's not great",
    "start": "619700",
    "end": "622400"
  },
  {
    "text": "um that we're working with the",
    "start": "622400",
    "end": "624589"
  },
  {
    "text": "kubernetes community to make that better",
    "start": "624589",
    "end": "627290"
  },
  {
    "text": "and it seems like this is something",
    "start": "627290",
    "end": "628520"
  },
  {
    "text": "wandered in industry so if you want to",
    "start": "628520",
    "end": "631460"
  },
  {
    "text": "see what we did you can look at our fork",
    "start": "631460",
    "end": "634250"
  },
  {
    "text": "and hopefully this gets resolved later",
    "start": "634250",
    "end": "636980"
  },
  {
    "text": "later on in the cooper days community so",
    "start": "636980",
    "end": "640970"
  },
  {
    "text": "in the summary and for a scale up we had",
    "start": "640970",
    "end": "644570"
  },
  {
    "text": "issues with panic routing but judith of",
    "start": "644570",
    "end": "647140"
  },
  {
    "text": "but do do the upstream on boy fix that",
    "start": "647140",
    "end": "650240"
  },
  {
    "text": "ended up working out properly and then",
    "start": "650240",
    "end": "652490"
  },
  {
    "text": "the other thing is sidecar ordering so",
    "start": "652490",
    "end": "654230"
  },
  {
    "text": "we added ready a more a more",
    "start": "654230",
    "end": "658520"
  },
  {
    "text": "representative readiness check for envoy",
    "start": "658520",
    "end": "660500"
  },
  {
    "text": "as well as forking kubernetes to ensure",
    "start": "660500",
    "end": "663350"
  },
  {
    "text": "that envoys started first both",
    "start": "663350",
    "end": "666350"
  },
  {
    "text": "all the sidecar containers are started",
    "start": "666350",
    "end": "667910"
  },
  {
    "text": "first before the application so great",
    "start": "667910",
    "end": "671450"
  },
  {
    "text": "and so tom is not gonna go over scale",
    "start": "671450",
    "end": "673520"
  },
  {
    "text": "down great I don't think I need them",
    "start": "673520",
    "end": "675920"
  },
  {
    "text": "hello hello okay cool yeah so thank you",
    "start": "675920",
    "end": "679970"
  },
  {
    "text": "Lido we're talking about scale up so I'm",
    "start": "679970",
    "end": "682040"
  },
  {
    "text": "gonna talk about scale down and to",
    "start": "682040",
    "end": "684320"
  },
  {
    "text": "continue with the party analogy it's a",
    "start": "684320",
    "end": "686450"
  },
  {
    "text": "it's like saying bye before you leave",
    "start": "686450",
    "end": "688250"
  },
  {
    "text": "the party no one likes it when you just",
    "start": "688250",
    "end": "690290"
  },
  {
    "text": "ghost the party then people might say",
    "start": "690290",
    "end": "692060"
  },
  {
    "text": "like where's Tom and everyone gets",
    "start": "692060",
    "end": "693770"
  },
  {
    "text": "confused just like the service mesh so",
    "start": "693770",
    "end": "697280"
  },
  {
    "text": "let's let's look at what scale down",
    "start": "697280",
    "end": "698870"
  },
  {
    "text": "looks like so you have your pods I've",
    "start": "698870",
    "end": "701300"
  },
  {
    "text": "got some happy pods talking to up",
    "start": "701300",
    "end": "703310"
  },
  {
    "text": "streams and down streams let's say one",
    "start": "703310",
    "end": "706220"
  },
  {
    "text": "of the pods gets terminated and it's",
    "start": "706220",
    "end": "708320"
  },
  {
    "text": "scaling down for whatever reason",
    "start": "708320",
    "end": "710020"
  },
  {
    "text": "kubernetes will see this send this",
    "start": "710020",
    "end": "712460"
  },
  {
    "text": "update to the control plane and then",
    "start": "712460",
    "end": "714080"
  },
  {
    "text": "propagate to the downstream and of",
    "start": "714080",
    "end": "716000"
  },
  {
    "text": "course your health check will also have",
    "start": "716000",
    "end": "717590"
  },
  {
    "text": "to fail at some point looks a lot like",
    "start": "717590",
    "end": "720530"
  },
  {
    "text": "the scale-up case so one thing we",
    "start": "720530",
    "end": "724220"
  },
  {
    "text": "noticed when we first shipped this out",
    "start": "724220",
    "end": "725600"
  },
  {
    "text": "was that we had this case where we would",
    "start": "725600",
    "end": "727520"
  },
  {
    "text": "have kind of like undead hosts in local",
    "start": "727520",
    "end": "730280"
  },
  {
    "text": "discovery so basically like a pod we get",
    "start": "730280",
    "end": "732770"
  },
  {
    "text": "terminated but then that IP address",
    "start": "732770",
    "end": "734300"
  },
  {
    "text": "would just kind of linger and a couple",
    "start": "734300",
    "end": "735710"
  },
  {
    "text": "hosts local discovery and eventually",
    "start": "735710",
    "end": "738980"
  },
  {
    "text": "this this caused a number of issues",
    "start": "738980",
    "end": "740030"
  },
  {
    "text": "because people just kept getting paged",
    "start": "740030",
    "end": "741350"
  },
  {
    "text": "basically because the page would",
    "start": "741350",
    "end": "743930"
  },
  {
    "text": "basically think that there were some",
    "start": "743930",
    "end": "746720"
  },
  {
    "text": "number of hosts that were unhealthy",
    "start": "746720",
    "end": "748220"
  },
  {
    "text": "inside the mesh but they just weren't",
    "start": "748220",
    "end": "749750"
  },
  {
    "text": "there period so something was up the",
    "start": "749750",
    "end": "752090"
  },
  {
    "text": "mesh wasn't converging correctly we",
    "start": "752090",
    "end": "753680"
  },
  {
    "text": "really had no idea what was happening so",
    "start": "753680",
    "end": "755810"
  },
  {
    "text": "we dug in so the interesting thing here",
    "start": "755810",
    "end": "759380"
  },
  {
    "text": "is that Ottawa has some level of",
    "start": "759380",
    "end": "761990"
  },
  {
    "text": "protection from like a Byzantine failure",
    "start": "761990",
    "end": "764150"
  },
  {
    "text": "from the XDS control plane and the what",
    "start": "764150",
    "end": "766760"
  },
  {
    "text": "I mean by that is that it kind of",
    "start": "766760",
    "end": "768050"
  },
  {
    "text": "respects its health checks quite a bit",
    "start": "768050",
    "end": "770090"
  },
  {
    "text": "so if the control plane were just like",
    "start": "770090",
    "end": "772280"
  },
  {
    "text": "barf and tell you there's no more hosts",
    "start": "772280",
    "end": "774140"
  },
  {
    "text": "for something as long as the health",
    "start": "774140",
    "end": "776180"
  },
  {
    "text": "checks are still rolling like envoy is",
    "start": "776180",
    "end": "777620"
  },
  {
    "text": "gonna be fine with that and just keep",
    "start": "777620",
    "end": "779120"
  },
  {
    "text": "using those hosts so what end up",
    "start": "779120",
    "end": "782750"
  },
  {
    "text": "happening is is you know envoy basically",
    "start": "782750",
    "end": "784730"
  },
  {
    "text": "has to Ottawa has to see that the health",
    "start": "784730",
    "end": "787220"
  },
  {
    "text": "checks have failed and that the hosts",
    "start": "787220",
    "end": "789080"
  },
  {
    "text": "are absent from a control plane eds",
    "start": "789080",
    "end": "791000"
  },
  {
    "text": "response to remove the hose from local",
    "start": "791000",
    "end": "792620"
  },
  {
    "text": "discovery what we found out though was",
    "start": "792620",
    "end": "795230"
  },
  {
    "text": "that there was a bug here where this had",
    "start": "795230",
    "end": "797540"
  },
  {
    "text": "to happen in order",
    "start": "797540",
    "end": "798730"
  },
  {
    "text": "so with excess streaming this kind of",
    "start": "798730",
    "end": "801580"
  },
  {
    "text": "made things way more complicated because",
    "start": "801580",
    "end": "803080"
  },
  {
    "text": "basically we would kind of send the",
    "start": "803080",
    "end": "804850"
  },
  {
    "text": "update and the entry would get stale and",
    "start": "804850",
    "end": "807130"
  },
  {
    "text": "we wouldn't send the update again later",
    "start": "807130",
    "end": "808420"
  },
  {
    "text": "because of you know XTS streaming it's",
    "start": "808420",
    "end": "810070"
  },
  {
    "text": "not periodic the IP address which is",
    "start": "810070",
    "end": "812740"
  },
  {
    "text": "kind of linger so this is the the table",
    "start": "812740",
    "end": "816790"
  },
  {
    "text": "in which boys should respect as far as",
    "start": "816790",
    "end": "819910"
  },
  {
    "text": "like health check status and discovery",
    "start": "819910",
    "end": "821380"
  },
  {
    "text": "status we wanted to be here we were",
    "start": "821380",
    "end": "825310"
  },
  {
    "text": "stuck here and we really needed to get",
    "start": "825310",
    "end": "828130"
  },
  {
    "text": "here to delete the the thing so we",
    "start": "828130",
    "end": "829780"
  },
  {
    "text": "needed to fail the health check and be",
    "start": "829780",
    "end": "831130"
  },
  {
    "text": "absent so there's two patches thank you",
    "start": "831130",
    "end": "834460"
  },
  {
    "text": "Matt for implementing both of these the",
    "start": "834460",
    "end": "837160"
  },
  {
    "text": "bottom one I'll talk about first even",
    "start": "837160",
    "end": "839500"
  },
  {
    "text": "though it's the even though we kind of",
    "start": "839500",
    "end": "840940"
  },
  {
    "text": "discovered that bug later which is why",
    "start": "840940",
    "end": "842500"
  },
  {
    "text": "it was later but the bottom one is",
    "start": "842500",
    "end": "845140"
  },
  {
    "text": "handling the health check with you know",
    "start": "845140",
    "end": "846850"
  },
  {
    "text": "without any regard to how the ordering",
    "start": "846850",
    "end": "848440"
  },
  {
    "text": "works so with that change basically",
    "start": "848440",
    "end": "850360"
  },
  {
    "text": "envoy keeps track of the state of the",
    "start": "850360",
    "end": "852640"
  },
  {
    "text": "last discovery update and so if you",
    "start": "852640",
    "end": "854680"
  },
  {
    "text": "start failing health checks and in the",
    "start": "854680",
    "end": "856600"
  },
  {
    "text": "previous update you got removed then you",
    "start": "856600",
    "end": "859120"
  },
  {
    "text": "know it could clean that that a host out",
    "start": "859120",
    "end": "860980"
  },
  {
    "text": "of local discovery no problem",
    "start": "860980",
    "end": "863290"
  },
  {
    "text": "and then another upstream change that we",
    "start": "863290",
    "end": "865000"
  },
  {
    "text": "made was allowing the control plane to",
    "start": "865000",
    "end": "868540"
  },
  {
    "text": "sort of forcibly remove a host from the",
    "start": "868540",
    "end": "870310"
  },
  {
    "text": "mesh so this essentially allows this",
    "start": "870310",
    "end": "873000"
  },
  {
    "text": "extra state this draining state for you",
    "start": "873000",
    "end": "875770"
  },
  {
    "text": "to be able to set in XDS on a host and",
    "start": "875770",
    "end": "878860"
  },
  {
    "text": "so you could propagate that draining",
    "start": "878860",
    "end": "880510"
  },
  {
    "text": "state to all the downstream pods and",
    "start": "880510",
    "end": "882580"
  },
  {
    "text": "they will know like okay this pot is",
    "start": "882580",
    "end": "884470"
  },
  {
    "text": "about to be deleted I should stop",
    "start": "884470",
    "end": "885730"
  },
  {
    "text": "routing health care routing requests to",
    "start": "885730",
    "end": "887680"
  },
  {
    "text": "it and once it starts failing health",
    "start": "887680",
    "end": "889600"
  },
  {
    "text": "checks or whatever like it's it's good",
    "start": "889600",
    "end": "891340"
  },
  {
    "text": "to clean up so yeah so now envoys all",
    "start": "891340",
    "end": "895090"
  },
  {
    "text": "good after that patch everything's great",
    "start": "895090",
    "end": "897550"
  },
  {
    "text": "it's respecting the the holy table so",
    "start": "897550",
    "end": "901360"
  },
  {
    "text": "even after we fixed that bug though we",
    "start": "901360",
    "end": "902980"
  },
  {
    "text": "started seeing more we start seeing",
    "start": "902980",
    "end": "905170"
  },
  {
    "text": "still some more 503 s so we were digging",
    "start": "905170",
    "end": "907510"
  },
  {
    "text": "into this we could rely on retries but",
    "start": "907510",
    "end": "910780"
  },
  {
    "text": "we we wanted to do better we didn't want",
    "start": "910780",
    "end": "912550"
  },
  {
    "text": "to just let this happen so you know like",
    "start": "912550",
    "end": "916870"
  },
  {
    "text": "I said earlier we added that draining",
    "start": "916870",
    "end": "918160"
  },
  {
    "text": "endpoint we wanted to take advantage of",
    "start": "918160",
    "end": "920620"
  },
  {
    "text": "that and somehow notify the mesh that",
    "start": "920620",
    "end": "922450"
  },
  {
    "text": "when a host is going away you know start",
    "start": "922450",
    "end": "925210"
  },
  {
    "text": "draining request stop sending it request",
    "start": "925210",
    "end": "928690"
  },
  {
    "text": "the reason we saw this 503 issue is",
    "start": "928690",
    "end": "930940"
  },
  {
    "text": "because we're using the kubernetes",
    "start": "930940",
    "end": "932560"
  },
  {
    "text": "endpoints to sort of be our source of",
    "start": "932560",
    "end": "935500"
  },
  {
    "text": "truth as far as like what the eds data",
    "start": "935500",
    "end": "937269"
  },
  {
    "text": "is and the way endpoints are handled is",
    "start": "937269",
    "end": "939850"
  },
  {
    "text": "that they kind of get deleted like the",
    "start": "939850",
    "end": "941470"
  },
  {
    "text": "same time their readiness check fails",
    "start": "941470",
    "end": "942910"
  },
  {
    "text": "it's it's actually concurrent and in our",
    "start": "942910",
    "end": "944949"
  },
  {
    "text": "case the readiness check is the same",
    "start": "944949",
    "end": "946360"
  },
  {
    "text": "thing as our Envoy health check so there",
    "start": "946360",
    "end": "948430"
  },
  {
    "text": "could be a case where that endpoint well",
    "start": "948430",
    "end": "949959"
  },
  {
    "text": "basically the health check fails and the",
    "start": "949959",
    "end": "951850"
  },
  {
    "text": "endpoint disappears and then it's just",
    "start": "951850",
    "end": "953740"
  },
  {
    "text": "kind of chaos so here's a high-level",
    "start": "953740",
    "end": "957399"
  },
  {
    "text": "diagram of how our control plane looks",
    "start": "957399",
    "end": "959199"
  },
  {
    "text": "like like Leo was saying we use an",
    "start": "959199",
    "end": "961329"
  },
  {
    "text": "informer we're using an endpoint",
    "start": "961329",
    "end": "962649"
  },
  {
    "text": "Informer and basically the endpoint",
    "start": "962649",
    "end": "964839"
  },
  {
    "text": "Informer takes the kubernetes watch API",
    "start": "964839",
    "end": "967180"
  },
  {
    "text": "and makes it work kind of like a nice",
    "start": "967180",
    "end": "969430"
  },
  {
    "text": "cue the nice thing about this setup is",
    "start": "969430",
    "end": "972579"
  },
  {
    "text": "that on the kubernetes informer side",
    "start": "972579",
    "end": "975490"
  },
  {
    "text": "we're getting these endpoint updates and",
    "start": "975490",
    "end": "978370"
  },
  {
    "text": "you can imagine that's for like service",
    "start": "978370",
    "end": "980290"
  },
  {
    "text": "a service fee service d the nice thing",
    "start": "980290",
    "end": "983230"
  },
  {
    "text": "about endpoints is that they have the",
    "start": "983230",
    "end": "985389"
  },
  {
    "text": "entire state of the world for that",
    "start": "985389",
    "end": "987279"
  },
  {
    "text": "service within that cluster so basically",
    "start": "987279",
    "end": "990399"
  },
  {
    "text": "the design here is really simple you",
    "start": "990399",
    "end": "991930"
  },
  {
    "text": "just kind of pluck this thing off the",
    "start": "991930",
    "end": "993189"
  },
  {
    "text": "queue and then we shove it into this",
    "start": "993189",
    "end": "994600"
  },
  {
    "text": "cache that we have in the control plane",
    "start": "994600",
    "end": "996069"
  },
  {
    "text": "and then that cache gets propagated out",
    "start": "996069",
    "end": "997750"
  },
  {
    "text": "to all the down screws really simple",
    "start": "997750",
    "end": "1000720"
  },
  {
    "text": "worked well enough pretty easy",
    "start": "1000720",
    "end": "1004279"
  },
  {
    "text": "so again endpoints get removed",
    "start": "1004279",
    "end": "1006959"
  },
  {
    "text": "immediately once the readiness check",
    "start": "1006959",
    "end": "1008610"
  },
  {
    "text": "fails we don't have any time to send",
    "start": "1008610",
    "end": "1010380"
  },
  {
    "text": "this like fancy draining update we",
    "start": "1010380",
    "end": "1011819"
  },
  {
    "text": "implemented earlier and basically what",
    "start": "1011819",
    "end": "1014430"
  },
  {
    "text": "ended up happening was there's a race",
    "start": "1014430",
    "end": "1015660"
  },
  {
    "text": "where the pod gets terminated it fails",
    "start": "1015660",
    "end": "1018720"
  },
  {
    "text": "health checks because it's gone outright",
    "start": "1018720",
    "end": "1020399"
  },
  {
    "text": "but this happens before the EDS removal",
    "start": "1020399",
    "end": "1022769"
  },
  {
    "text": "happened EDS removal occurs and before",
    "start": "1022769",
    "end": "1025470"
  },
  {
    "text": "the act of health check comes in to save",
    "start": "1025470",
    "end": "1026819"
  },
  {
    "text": "the day so this is the source of the 503",
    "start": "1026819",
    "end": "1030030"
  },
  {
    "text": "s that we were hitting so the next",
    "start": "1030030",
    "end": "1034288"
  },
  {
    "text": "logical alternative is to use pods",
    "start": "1034289",
    "end": "1036538"
  },
  {
    "text": "instead of kubernetes endpoints for our",
    "start": "1036539",
    "end": "1038760"
  },
  {
    "text": "control plane it kind of makes sense the",
    "start": "1038760",
    "end": "1041400"
  },
  {
    "text": "endpoint controller inside of kubernetes",
    "start": "1041400",
    "end": "1042900"
  },
  {
    "text": "does the same thing and we're kind of",
    "start": "1042900",
    "end": "1044548"
  },
  {
    "text": "replacing endpoints with our solutions",
    "start": "1044549",
    "end": "1046140"
  },
  {
    "text": "so we might as well do what they're",
    "start": "1046140",
    "end": "1047370"
  },
  {
    "text": "doing so the nice thing about pods is",
    "start": "1047370",
    "end": "1050610"
  },
  {
    "text": "that they get when they get deleted they",
    "start": "1050610",
    "end": "1052830"
  },
  {
    "text": "have this termination grace period that",
    "start": "1052830",
    "end": "1054450"
  },
  {
    "text": "you can set and when that's set what",
    "start": "1054450",
    "end": "1056610"
  },
  {
    "text": "basically happens is the pod has this",
    "start": "1056610",
    "end": "1058230"
  },
  {
    "text": "deletion timestamp field that's set at",
    "start": "1058230",
    "end": "1060179"
  },
  {
    "text": "the",
    "start": "1060179",
    "end": "1060630"
  },
  {
    "text": "it's set with the time at which the pod",
    "start": "1060630",
    "end": "1062910"
  },
  {
    "text": "should be deleted so it's a nice way of",
    "start": "1062910",
    "end": "1065070"
  },
  {
    "text": "knowing that this pot is about to be",
    "start": "1065070",
    "end": "1066330"
  },
  {
    "text": "terminated and we can send a draining",
    "start": "1066330",
    "end": "1068549"
  },
  {
    "text": "update for positive it for pause that we",
    "start": "1068549",
    "end": "1070530"
  },
  {
    "text": "find that have that field set the",
    "start": "1070530",
    "end": "1073260"
  },
  {
    "text": "annoying thing here is that the pot",
    "start": "1073260",
    "end": "1075510"
  },
  {
    "text": "updates aren't service level like",
    "start": "1075510",
    "end": "1077010"
  },
  {
    "text": "endpoint updates are we don't get the",
    "start": "1077010",
    "end": "1078390"
  },
  {
    "text": "whole state of the world we're gonna get",
    "start": "1078390",
    "end": "1079890"
  },
  {
    "text": "updates for every single pod and then",
    "start": "1079890",
    "end": "1082289"
  },
  {
    "text": "we're gonna have to maintain a cache as",
    "start": "1082289",
    "end": "1083880"
  },
  {
    "text": "well sounds really annoying so if you",
    "start": "1083880",
    "end": "1087960"
  },
  {
    "text": "dig a little deeper into the kubernetes",
    "start": "1087960",
    "end": "1089549"
  },
  {
    "text": "client go code you'll find this neat",
    "start": "1089549",
    "end": "1090960"
  },
  {
    "text": "little thing called an indexer and the",
    "start": "1090960",
    "end": "1093210"
  },
  {
    "text": "indexer basically allows you to bucket",
    "start": "1093210",
    "end": "1095010"
  },
  {
    "text": "the objects that you're watching and",
    "start": "1095010",
    "end": "1096510"
  },
  {
    "text": "like an arbitrary way so we have a",
    "start": "1096510",
    "end": "1098610"
  },
  {
    "text": "special label on all the pods within a",
    "start": "1098610",
    "end": "1100350"
  },
  {
    "text": "service and it's so it's really easy for",
    "start": "1100350",
    "end": "1102690"
  },
  {
    "text": "us to use the indexer to just kind of",
    "start": "1102690",
    "end": "1104549"
  },
  {
    "text": "bucket all those pod updates into the",
    "start": "1104549",
    "end": "1107309"
  },
  {
    "text": "index by service name so it's kind of",
    "start": "1107309",
    "end": "1110250"
  },
  {
    "text": "like this extra cash but the cash gets",
    "start": "1110250",
    "end": "1111870"
  },
  {
    "text": "maintained it's it's sort of like the",
    "start": "1111870",
    "end": "1114240"
  },
  {
    "text": "latest state of the world for for that",
    "start": "1114240",
    "end": "1116220"
  },
  {
    "text": "service or for that set of pods rather",
    "start": "1116220",
    "end": "1118850"
  },
  {
    "text": "so what we end up doing is basically for",
    "start": "1118850",
    "end": "1121350"
  },
  {
    "text": "every pod update we just kind of pluck",
    "start": "1121350",
    "end": "1122850"
  },
  {
    "text": "out the service name put that on a queue",
    "start": "1122850",
    "end": "1124950"
  },
  {
    "text": "and then when we process that queue we",
    "start": "1124950",
    "end": "1127830"
  },
  {
    "text": "kind of take that service name out look",
    "start": "1127830",
    "end": "1129570"
  },
  {
    "text": "up that service and the index pull out",
    "start": "1129570",
    "end": "1131429"
  },
  {
    "text": "all the pods generate a cash entry and",
    "start": "1131429",
    "end": "1133559"
  },
  {
    "text": "then put it back into our control plane",
    "start": "1133559",
    "end": "1136289"
  },
  {
    "text": "cash and then propagate that to",
    "start": "1136289",
    "end": "1137520"
  },
  {
    "text": "downstream hosts a little more",
    "start": "1137520",
    "end": "1139289"
  },
  {
    "text": "complicated but we end up getting the",
    "start": "1139289",
    "end": "1141120"
  },
  {
    "text": "same benefit which is we have the entire",
    "start": "1141120",
    "end": "1143309"
  },
  {
    "text": "state of the world handled by kubernetes",
    "start": "1143309",
    "end": "1144900"
  },
  {
    "text": "and we don't really have to muck around",
    "start": "1144900",
    "end": "1146669"
  },
  {
    "text": "with our own cash and everything's good",
    "start": "1146669",
    "end": "1149940"
  },
  {
    "text": "and we have a happy Chihuahua so in",
    "start": "1149940",
    "end": "1152909"
  },
  {
    "text": "summary scale down the the two things we",
    "start": "1152909",
    "end": "1157679"
  },
  {
    "text": "kind of had to tackle here was tackling",
    "start": "1157679",
    "end": "1159840"
  },
  {
    "text": "the out of order bugs notably around",
    "start": "1159840",
    "end": "1163169"
  },
  {
    "text": "discovery in health check data and then",
    "start": "1163169",
    "end": "1165270"
  },
  {
    "text": "also getting our control plane to",
    "start": "1165270",
    "end": "1166559"
  },
  {
    "text": "monitor pods rather than endpoints",
    "start": "1166559",
    "end": "1168270"
  },
  {
    "text": "because that seems to give us time to",
    "start": "1168270",
    "end": "1170159"
  },
  {
    "text": "send the draining update and it allows",
    "start": "1170159",
    "end": "1172440"
  },
  {
    "text": "us to avoid yeah exactly just sending",
    "start": "1172440",
    "end": "1176640"
  },
  {
    "text": "the draining update basically so",
    "start": "1176640",
    "end": "1179190"
  },
  {
    "text": "everything's good we got all these cool",
    "start": "1179190",
    "end": "1180360"
  },
  {
    "text": "cool check marks so in summary",
    "start": "1180360",
    "end": "1185299"
  },
  {
    "text": "everybody likes talking about paradigm",
    "start": "1185299",
    "end": "1187169"
  },
  {
    "text": "shifts so I will talk about the paradigm",
    "start": "1187169",
    "end": "1188549"
  },
  {
    "text": "shift as well where the changes",
    "start": "1188549",
    "end": "1190620"
  },
  {
    "text": "essentially are moving from",
    "start": "1190620",
    "end": "1194120"
  },
  {
    "text": "no level changes like Lita was saying",
    "start": "1194120",
    "end": "1196100"
  },
  {
    "text": "earlier in our VM infrastructure the VMS",
    "start": "1196100",
    "end": "1198020"
  },
  {
    "text": "would kind of stay where they were and",
    "start": "1198020",
    "end": "1199130"
  },
  {
    "text": "we were kind of update things in place",
    "start": "1199130",
    "end": "1200390"
  },
  {
    "text": "but we're sort of moving the those",
    "start": "1200390",
    "end": "1202400"
  },
  {
    "text": "levels of changes with kubernetes into",
    "start": "1202400",
    "end": "1204920"
  },
  {
    "text": "the network topology or the network",
    "start": "1204920",
    "end": "1206450"
  },
  {
    "text": "topography and so that's to take",
    "start": "1206450",
    "end": "1209510"
  },
  {
    "text": "advantage of kubernetes quick scale up",
    "start": "1209510",
    "end": "1211490"
  },
  {
    "text": "and scale down and again few things",
    "start": "1211490",
    "end": "1213860"
  },
  {
    "text": "needed tweaking to get there we have to",
    "start": "1213860",
    "end": "1216380"
  },
  {
    "text": "patch kubernetes which was not ideal but",
    "start": "1216380",
    "end": "1218780"
  },
  {
    "text": "it's what we did and and yeah and as far",
    "start": "1218780",
    "end": "1224300"
  },
  {
    "text": "as future work goes Thomas from psyllium",
    "start": "1224300",
    "end": "1226610"
  },
  {
    "text": "had a very interesting talk about",
    "start": "1226610",
    "end": "1228170"
  },
  {
    "text": "running on voice a daemon set we run on",
    "start": "1228170",
    "end": "1230510"
  },
  {
    "text": "boy as a side car in every pod and this",
    "start": "1230510",
    "end": "1232250"
  },
  {
    "text": "is expensive for compute reasons it also",
    "start": "1232250",
    "end": "1234980"
  },
  {
    "text": "you know makes the mesh that makes mesh",
    "start": "1234980",
    "end": "1238250"
  },
  {
    "text": "scaling more difficult if you have even",
    "start": "1238250",
    "end": "1239840"
  },
  {
    "text": "more on voice to deal with seems",
    "start": "1239840",
    "end": "1242240"
  },
  {
    "text": "interesting seems complicated it's",
    "start": "1242240",
    "end": "1243860"
  },
  {
    "text": "probably something that will dig into",
    "start": "1243860",
    "end": "1244850"
  },
  {
    "text": "later the other thing that we're looking",
    "start": "1244850",
    "end": "1247100"
  },
  {
    "text": "into is that we have this like one giant",
    "start": "1247100",
    "end": "1249380"
  },
  {
    "text": "mesh or essentially two giant meshes one",
    "start": "1249380",
    "end": "1251809"
  },
  {
    "text": "for staging one for production and it's",
    "start": "1251809",
    "end": "1256130"
  },
  {
    "text": "it's hard to propagate that information",
    "start": "1256130",
    "end": "1258260"
  },
  {
    "text": "in time across to all the all the",
    "start": "1258260",
    "end": "1260179"
  },
  {
    "text": "downstream hosts when things are",
    "start": "1260179",
    "end": "1261350"
  },
  {
    "text": "changing especially when things are",
    "start": "1261350",
    "end": "1262370"
  },
  {
    "text": "rapidly changing in kubernetes so we're",
    "start": "1262370",
    "end": "1264470"
  },
  {
    "text": "looking into a couple strategies one of",
    "start": "1264470",
    "end": "1265820"
  },
  {
    "text": "which is cutting up that mesh maybe",
    "start": "1265820",
    "end": "1267860"
  },
  {
    "text": "cutting them up by AWS availability zone",
    "start": "1267860",
    "end": "1269929"
  },
  {
    "text": "or by cluster and another is batching",
    "start": "1269929",
    "end": "1273110"
  },
  {
    "text": "the updates so that in case there is",
    "start": "1273110",
    "end": "1274730"
  },
  {
    "text": "some big scaling up or scaling down",
    "start": "1274730",
    "end": "1276350"
  },
  {
    "text": "event we can just batch those updates",
    "start": "1276350",
    "end": "1278179"
  },
  {
    "text": "and send them send one update instead of",
    "start": "1278179",
    "end": "1280190"
  },
  {
    "text": "sending you know a thousand or however",
    "start": "1280190",
    "end": "1281630"
  },
  {
    "text": "many we have to and really interested in",
    "start": "1281630",
    "end": "1283850"
  },
  {
    "text": "some of the envoy OSS changes with",
    "start": "1283850",
    "end": "1285940"
  },
  {
    "text": "Federation and supporting multiple",
    "start": "1285940",
    "end": "1288470"
  },
  {
    "text": "control planes so thank you",
    "start": "1288470",
    "end": "1293480"
  },
  {
    "text": "and now we have an invitation to a party",
    "start": "1293480",
    "end": "1296809"
  },
  {
    "text": "for you and we hopefully you say hi and",
    "start": "1296809",
    "end": "1299690"
  },
  {
    "text": "bye to us appropriately please join us",
    "start": "1299690",
    "end": "1302150"
  },
  {
    "text": "at the lift happy hour on Tuesday",
    "start": "1302150",
    "end": "1303770"
  },
  {
    "text": "November 19th at a bar called thorn",
    "start": "1303770",
    "end": "1307220"
  },
  {
    "text": "barrio Logan which also sounds like",
    "start": "1307220",
    "end": "1309730"
  },
  {
    "text": "auto-generated password please RSVP'd on",
    "start": "1309730",
    "end": "1314090"
  },
  {
    "text": "the website or you could just show up at",
    "start": "1314090",
    "end": "1315770"
  },
  {
    "text": "the door and you'll be fine yeah thank",
    "start": "1315770",
    "end": "1318559"
  },
  {
    "text": "you",
    "start": "1318559",
    "end": "1320620"
  },
  {
    "text": "[Applause]",
    "start": "1321190",
    "end": "1325960"
  }
]