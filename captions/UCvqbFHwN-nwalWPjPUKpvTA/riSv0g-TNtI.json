[
  {
    "text": "hi everyone Welcome to our talk it's about project updates on the network policy API work that we've been doing in",
    "start": "199",
    "end": "6759"
  },
  {
    "text": "the kubernetes Sig Community I'm sya and I'm an engineer working on the open",
    "start": "6759",
    "end": "12000"
  },
  {
    "text": "shift networking team at Red Hat I'm also a contributor to the network policy API project and very very happy to be",
    "start": "12000",
    "end": "18880"
  },
  {
    "text": "here at ccon with all of you and hi everybody I'm Hunter I work",
    "start": "18880",
    "end": "24480"
  },
  {
    "text": "at Microsoft on uh Network policy and observability and today I'll be diving",
    "start": "24480",
    "end": "31119"
  },
  {
    "text": "into user tooling uh very excited to show you guys a demo later and I'll pass it",
    "start": "31119",
    "end": "37040"
  },
  {
    "text": "back yeah so let's get started with who are we right so um how many of you are hearing Network policies for the first",
    "start": "37040",
    "end": "43800"
  },
  {
    "text": "time can we have a raise of hands that's perfect because everybody",
    "start": "43800",
    "end": "49440"
  },
  {
    "text": "knows why you're here for right like so we are actually a subw working group",
    "start": "49440",
    "end": "54520"
  },
  {
    "text": "within the Sig Network so special interest group network but we are a sub-working group within that group and",
    "start": "54520",
    "end": "60239"
  },
  {
    "text": "we call ourselves the network policy API working group and we are mainly focused on developing new policy apis and",
    "start": "60239",
    "end": "67360"
  },
  {
    "text": "maintaining the existing ones that we already have and these are basically the network policy API which is stable and",
    "start": "67360",
    "end": "73560"
  },
  {
    "text": "we1 and has been around for a really long time 5 six years if I'm not wrong and it lives in the core kubernetes",
    "start": "73560",
    "end": "79720"
  },
  {
    "text": "kubernetes repo and recently we've been working a lot on the next two apis which is what we'll be talking a lot about in",
    "start": "79720",
    "end": "86240"
  },
  {
    "text": "the session which is the admin Network policy API and the base line admin Network policy apis so we'll dig a",
    "start": "86240",
    "end": "92759"
  },
  {
    "text": "little more deeper into what those are and if you are interested in our code-based repo or our websites please",
    "start": "92759",
    "end": "98640"
  },
  {
    "text": "um take the privilege to go and click on these links when you have the PDF from the skedge",
    "start": "98640",
    "end": "103759"
  },
  {
    "text": "available so let's look a little bit into what network policy API is but I",
    "start": "103759",
    "end": "108840"
  },
  {
    "text": "can see that a lot of you at least know what that is so that's good and I want to give a huge shout out to numerous",
    "start": "108840",
    "end": "114560"
  },
  {
    "text": "contributors in the community who have made this possible so for the past so many years I don't even know the",
    "start": "114560",
    "end": "119920"
  },
  {
    "text": "extensive list of contributors but um huge shout out to all of them for making this possible some of the use cases for",
    "start": "119920",
    "end": "126000"
  },
  {
    "text": "Network policies and the reason behind why we have this API in the first place is the fact that it was designed keeping",
    "start": "126000",
    "end": "133160"
  },
  {
    "text": "application developers in mind right so it was meant for namespace owners so as an application developer when you have",
    "start": "133160",
    "end": "139959"
  },
  {
    "text": "your namespace and you put your apps on it security is an important perspective especially the networking security",
    "start": "139959",
    "end": "145599"
  },
  {
    "text": "aspects of it so you might want to control what what's talking to your pods what can talk what should not talk and",
    "start": "145599",
    "end": "152480"
  },
  {
    "text": "stuff like that so that's the basic use case for why we have Network policy the second thing is having a tiered",
    "start": "152480",
    "end": "158400"
  },
  {
    "text": "architecture so you might have front ends backends databases and bunch of other stuff around it and you might want",
    "start": "158400",
    "end": "164280"
  },
  {
    "text": "to be able to say that your back ends can only receive traffic from your front ends databases can only receive traffic",
    "start": "164280",
    "end": "169920"
  },
  {
    "text": "from your back ends and have multi-tiered architecture so these are the two of the two of the most common use cases we had in mind in the cap for",
    "start": "169920",
    "end": "176879"
  },
  {
    "text": "why we designed Network policies and this was really really for the developers right like for the tenant",
    "start": "176879",
    "end": "181959"
  },
  {
    "text": "owners who deploy apps and like I mentioned this is like a",
    "start": "181959",
    "end": "187000"
  },
  {
    "text": "very basic example of how you can use at use the network policy API so you might have two name spaces the front end and",
    "start": "187000",
    "end": "193720"
  },
  {
    "text": "the back end you have a bunch of pods in each of these name spaces and you might want to be able to express things like",
    "start": "193720",
    "end": "199040"
  },
  {
    "text": "hey I want my back end to only receive traffic from my front end right like so Ingress traffic let's say in which case",
    "start": "199040",
    "end": "204440"
  },
  {
    "text": "you just add a network policy to your backend namespace which creates this implicit deny which is the red block",
    "start": "204440",
    "end": "211159"
  },
  {
    "text": "that you see so right now all Ingress traffic is blocked and then you can apply an allow rule on top which is the",
    "start": "211159",
    "end": "218159"
  },
  {
    "text": "green line that you see right there on the slide which is saying that oh any traffic coming from my front end I want",
    "start": "218159",
    "end": "224000"
  },
  {
    "text": "to allow but nothing else is allowed right so your namespace is basically very secure at the",
    "start": "224000",
    "end": "229360"
  },
  {
    "text": "moment so like I mentioned Network policy API is namespace scoped so which is why you see in the metadata the Nam",
    "start": "229360",
    "end": "236000"
  },
  {
    "text": "space field this is a sample yaml for Network policy API which a lot of you have seen before and it's simple because",
    "start": "236000",
    "end": "242840"
  },
  {
    "text": "it lets you express simple Ingress and egress rules on that crd right but one thing to keep in mind is the fact that",
    "start": "242840",
    "end": "249680"
  },
  {
    "text": "it is implicit in nature after all because the first Network policy that you create in your namespace gets you",
    "start": "249680",
    "end": "256479"
  },
  {
    "text": "that implicit default deny to that namespace right and then any allow rules",
    "start": "256479",
    "end": "261680"
  },
  {
    "text": "that you add on top is what let what defines who can talk to you and some of",
    "start": "261680",
    "end": "266960"
  },
  {
    "text": "the peers that you can express today with the network policy API are the name spaces the pods and IP",
    "start": "266960",
    "end": "274320"
  },
  {
    "text": "blocks stable API has been around for a really long time we have a lot of implementations uh we don't have the",
    "start": "274320",
    "end": "280320"
  },
  {
    "text": "extensive lists but these are the commonly known ones that are still active in the",
    "start": "280320",
    "end": "286320"
  },
  {
    "text": "community and let's talk about admin Network policy API right so this is the new API and remember how I mentioned the",
    "start": "286320",
    "end": "293160"
  },
  {
    "text": "network policy API was designed for developers this one was designed for admins right to cater to their needs of",
    "start": "293160",
    "end": "300360"
  },
  {
    "text": "the cluster and we have two objects two crds as part of this feature which is",
    "start": "300360",
    "end": "305440"
  },
  {
    "text": "the admin Network policy API and the Baseline admin policy API both of these",
    "start": "305440",
    "end": "310840"
  },
  {
    "text": "are out of tree so they're not in the core kubernetes / kubernetes repo so when you install your cluster you do not",
    "start": "310840",
    "end": "317000"
  },
  {
    "text": "get these by default you need to actually opt into them and they are currently in the webern",
    "start": "317000",
    "end": "323800"
  },
  {
    "text": "alpha alpha 1 actually so we've it's been around for a year and a half right",
    "start": "323800",
    "end": "329520"
  },
  {
    "text": "the kept merged two years ago and the API has been R for a year and a half we're still actively developing a lot of",
    "start": "329520",
    "end": "334720"
  },
  {
    "text": "features and adding stuff into it we are preparing to move towards beta not there",
    "start": "334720",
    "end": "339960"
  },
  {
    "text": "yet but hopefully in a couple of months we'll see and again thanks to numerous contributions here I want to particularly call out our maintainers",
    "start": "339960",
    "end": "346440"
  },
  {
    "text": "Dan Yang and Andrew who do numerous code reviews because of which this project is still",
    "start": "346440",
    "end": "351840"
  },
  {
    "text": "sustainable so some of the use cases for the admin Network policy API which is designed for admins again as a cluster",
    "start": "351840",
    "end": "358520"
  },
  {
    "text": "administrator you you might want to have or enforce security for your entire cluster not a specific namespace but",
    "start": "358520",
    "end": "364479"
  },
  {
    "text": "actually have rules that span cross namespace multi tenants isolate tenants have non overridable rules which which",
    "start": "364479",
    "end": "372520"
  },
  {
    "text": "actually cannot well non- overridable rules as in the network policies cannot override them which are created by the",
    "start": "372520",
    "end": "377759"
  },
  {
    "text": "developers so and all tenants in your cluster have to adher to this right so",
    "start": "377759",
    "end": "383080"
  },
  {
    "text": "that's our number one use case and then tenant isolation a tenant here could be one name space multiple name spaces and",
    "start": "383080",
    "end": "389639"
  },
  {
    "text": "you don't want to really replicate your network policies across all the tenants to express the same stuff so you can",
    "start": "389639",
    "end": "396000"
  },
  {
    "text": "just have a global cluster scoped policy which just us this work for",
    "start": "396000",
    "end": "402240"
  },
  {
    "text": "you again we can look at some of the use cases which was mentioned the original cap of the admin Network policy the",
    "start": "402240",
    "end": "408199"
  },
  {
    "text": "first one being I already covered this which is isolate your tenants right so you have the food tenant the bar tenant",
    "start": "408199",
    "end": "413840"
  },
  {
    "text": "you don't want them to talk to each other explicit allow which is you might",
    "start": "413840",
    "end": "420080"
  },
  {
    "text": "want as an admin to tell that your tenants or your applications should",
    "start": "420080",
    "end": "425120"
  },
  {
    "text": "always receive traffic from the monitoring name space so you might want to monitor gather metrics check what the",
    "start": "425120",
    "end": "431160"
  },
  {
    "text": "application owners are doing in your cluster as an admin and so you might want to do explicit allows so which",
    "start": "431160",
    "end": "436199"
  },
  {
    "text": "means if there is a network policy in that tenant's name space it still",
    "start": "436199",
    "end": "441440"
  },
  {
    "text": "doesn't matter right like the implicit deny of the network policy will not kick in your allow is what holds",
    "start": "441440",
    "end": "447039"
  },
  {
    "text": "precedence and same for the Ingress case which which is the fact that the cube DNS which is the internal DNS in your",
    "start": "447039",
    "end": "453720"
  },
  {
    "text": "cluster you want to always allow all the tenants to talk to it another interesting use case is the",
    "start": "453720",
    "end": "461240"
  },
  {
    "text": "delegation or commonly known as the pass action so we wanted to make sure that",
    "start": "461240",
    "end": "466360"
  },
  {
    "text": "the admin Network policies coexist with the network policies and they interact with each other in some Manner and the",
    "start": "466360",
    "end": "472240"
  },
  {
    "text": "admins should be able to choose to delegate specific set of traffic so you might have an implicit deny rule as an",
    "start": "472240",
    "end": "478919"
  },
  {
    "text": "admin saying saying oh nobody should be able to talk to anybody but then you might have these explicit rules which is",
    "start": "478919",
    "end": "484400"
  },
  {
    "text": "if the traffic matches this cider or this network or this node you want to pass which means you want to delegate",
    "start": "484400",
    "end": "491199"
  },
  {
    "text": "the decision of whether the traffic should be allowed or not to the namespace scoped Network policies in",
    "start": "491199",
    "end": "496759"
  },
  {
    "text": "your cluster so that's the yellow um diagram",
    "start": "496759",
    "end": "502120"
  },
  {
    "text": "that you see here and then the last use case is default deny to sensitive name space right which is the explicit deny",
    "start": "502120",
    "end": "510479"
  },
  {
    "text": "how can you do this right so I mentioned there are two new apis as part of this um new feature one of them being the",
    "start": "510479",
    "end": "516560"
  },
  {
    "text": "admin Network policy API and this is how a sample yaml looks like it's kind of",
    "start": "516560",
    "end": "522080"
  },
  {
    "text": "like Network policies in terms of I'm sure you recognize the Ingress and egress and the selectors namespace",
    "start": "522080",
    "end": "527360"
  },
  {
    "text": "selectors SP selectors but this is cluster scoped the first thing to note",
    "start": "527360",
    "end": "533080"
  },
  {
    "text": "and then note that you have a priority field which is explicit so you can have",
    "start": "533080",
    "end": "538200"
  },
  {
    "text": "multiple admin Network policy IES and actually order them based on priority so that gives you a clear way of saying",
    "start": "538200",
    "end": "544640"
  },
  {
    "text": "which A&P will be evaluated first right so zero being the highest priority and then as the number increases lower the",
    "start": "544640",
    "end": "551760"
  },
  {
    "text": "Precedence within the admin Network policy it's the same so you can have multiple Ingress and egress rules which",
    "start": "551760",
    "end": "557839"
  },
  {
    "text": "explicitly allow and deny traffic in our case we have taken the example of the monitoring name space and the DNS name",
    "start": "557839",
    "end": "563519"
  },
  {
    "text": "spe which we spoke about on the previous slide so here we have an Ingress rule that says any traffic coming from the",
    "start": "563519",
    "end": "569640"
  },
  {
    "text": "monitoring namespace should be allowed and we have an egress rule that says any traffic towards the C DNS namespace",
    "start": "569640",
    "end": "575680"
  },
  {
    "text": "should be allowed always so even if you have Network policies doesn't matter right and your subject here is all Nam",
    "start": "575680",
    "end": "581160"
  },
  {
    "text": "spaces you see the empty selector for the subject subject field and then this is the Baseline admin Network policy",
    "start": "581160",
    "end": "587680"
  },
  {
    "text": "which from the name of it might sound a little bit confusing because I've had multiple people reach out to me saying",
    "start": "587680",
    "end": "592720"
  },
  {
    "text": "hey is this the Baseline that I put in the cluster which will always be adhered to the answer is no actually because the",
    "start": "592720",
    "end": "599440"
  },
  {
    "text": "precedence of Baseline sits after the network policies so this is evaluated after the network policies so you want",
    "start": "599440",
    "end": "605519"
  },
  {
    "text": "to be careful about it so this is not something that you put on your cluster and say like oh yeah I have this so I'm",
    "start": "605519",
    "end": "610560"
  },
  {
    "text": "secure not really if you have something that you really want to do as an admin please creates an admin Network policy",
    "start": "610560",
    "end": "617440"
  },
  {
    "text": "Baseline is meant to be used when you have passed traffic and then you have",
    "start": "617440",
    "end": "622760"
  },
  {
    "text": "you have Network policies or mean you might not have Network policies to catch them right",
    "start": "622760",
    "end": "627959"
  },
  {
    "text": "like if it's a catch thing that sits at the lowest precedence in your",
    "start": "627959",
    "end": "633680"
  },
  {
    "text": "classroom it's explicit in design it's like Network firewall admins telling",
    "start": "633720",
    "end": "639600"
  },
  {
    "text": "what they want to allow and deny right like so it's not implicit like Network policies so that might catch you by",
    "start": "639600",
    "end": "645279"
  },
  {
    "text": "surprise if you have been using network policies for a really long time and then you switch to using this because if you",
    "start": "645279",
    "end": "650839"
  },
  {
    "text": "want to deny something you have to explicitly State what you want to deny and we will only deny that we are not",
    "start": "650839",
    "end": "656839"
  },
  {
    "text": "going to deny everything for you just because you created the the object in your cluster and then we have some the",
    "start": "656839",
    "end": "663279"
  },
  {
    "text": "commonly used peers or the allowed peers are the pods and name spaces but we also have nodes and networks networks are",
    "start": "663279",
    "end": "670279"
  },
  {
    "text": "like the IP blocks um so the nodes and networks are only supported for the egress at the",
    "start": "670279",
    "end": "677160"
  },
  {
    "text": "moment only been around for a year right we're on the journey towards beta only two implementations exist today and this",
    "start": "677160",
    "end": "683959"
  },
  {
    "text": "is where we really need help from the community we want more implementations we're having some dialogues with selum",
    "start": "683959",
    "end": "689680"
  },
  {
    "text": "we want help from Calico so um shout out to all of you here if you have implementations and you're interested",
    "start": "689680",
    "end": "695760"
  },
  {
    "text": "please um to um add this to your road map give us feedback or maybe even try to use it and let us know how it",
    "start": "695760",
    "end": "703320"
  },
  {
    "text": "goes and just to sum all that up because maybe that was a little bit lot in the short time it's this is how it's",
    "start": "703320",
    "end": "710160"
  },
  {
    "text": "evaluated so this is the admin Network policy API which comes first it has",
    "start": "710160",
    "end": "715519"
  },
  {
    "text": "priorities so it's evaluated based on priority it's cre created by the cluster admin and that's what gets evaluated",
    "start": "715519",
    "end": "722200"
  },
  {
    "text": "first and then you fall down to your network policies if any in your cluster or maybe you pass the traffic in which",
    "start": "722200",
    "end": "728800"
  },
  {
    "text": "case it lands to the network policy and then the network policy rules are evaluated and finally if nothing matched",
    "start": "728800",
    "end": "734560"
  },
  {
    "text": "these two layers that's when you fall down to the Baseline admin Network policy right and it's a single ton you",
    "start": "734560",
    "end": "740360"
  },
  {
    "text": "can only have one BP in your cluster so you use it wisely so that's a little bit about the",
    "start": "740360",
    "end": "747199"
  },
  {
    "text": "apis that our community supports maintains develops and we also maintain all the ecosystem around it so new",
    "start": "747199",
    "end": "753480"
  },
  {
    "text": "features end to end tests conformance tests bugs so feedback right any",
    "start": "753480",
    "end": "758600"
  },
  {
    "text": "everything so and we're going to dive into some of the new features that our community has been working really hard on for the past few months and we call",
    "start": "758600",
    "end": "766600"
  },
  {
    "text": "them the network policy enhancement proposals we kind of borrowed this from the gate to API enhancements the gaps we",
    "start": "766600",
    "end": "772279"
  },
  {
    "text": "call them the N peps so this is basically how the community can just",
    "start": "772279",
    "end": "777360"
  },
  {
    "text": "come up and then propose their ideas right if you have a cool idea you want to get involved in the community maybe",
    "start": "777360",
    "end": "782440"
  },
  {
    "text": "you have a security use case maybe you have other use cases for policies multic clustering or whatever that might be",
    "start": "782440",
    "end": "787480"
  },
  {
    "text": "multi networking whatever that is right just open an npep with our with the user",
    "start": "787480",
    "end": "793000"
  },
  {
    "text": "stories that you have in mind against our repo this is really lowkey as in",
    "start": "793000",
    "end": "798440"
  },
  {
    "text": "it's not super complicated as the cap it's literally what are your goals what are you trying to do just open a PR and",
    "start": "798440",
    "end": "804959"
  },
  {
    "text": "then we can get some get it reviewed and then if the use cases make sense and are General enough then we can start",
    "start": "804959",
    "end": "810920"
  },
  {
    "text": "implementing the API get that in and then these are the stages that the N peps go into but basically the point",
    "start": "810920",
    "end": "816680"
  },
  {
    "text": "tldd is contributions are welcome we are a small community but we love getting feedback in more use cases",
    "start": "816680",
    "end": "824079"
  },
  {
    "text": "here so the first in pep that I do want to talk about is the egress traffic controls the original kept for the admin",
    "start": "824079",
    "end": "830639"
  },
  {
    "text": "Network policies the scope were limited to East West and the Northbound was not",
    "start": "830639",
    "end": "836639"
  },
  {
    "text": "supported and so we did an npep to add that feature and it's an experimental",
    "start": "836639",
    "end": "842639"
  },
  {
    "text": "State status right now which means that the use cases were accepted we also have",
    "start": "842639",
    "end": "848160"
  },
  {
    "text": "the API merged but we will wait for 6 months before it goes into standard channel so that we can get some feedback",
    "start": "848160",
    "end": "854279"
  },
  {
    "text": "from the implementations and we are sure that the API semantics are correct so this npep basically introduces two new",
    "start": "854279",
    "end": "860920"
  },
  {
    "text": "peers which is the nodes and the networks and the networks are actually inline Siders so you have to put your",
    "start": "860920",
    "end": "868279"
  },
  {
    "text": "ciders as appear within the object some of the use cases are what you see on",
    "start": "868279",
    "end": "874759"
  },
  {
    "text": "that side of the slide which is you might want to block egress traffic controls to your control plane Pods at a",
    "start": "874759",
    "end": "880240"
  },
  {
    "text": "specific Port you might want to see the tenant who can talk to the DNS but not talk to some other external servers you",
    "start": "880240",
    "end": "886759"
  },
  {
    "text": "might want to deny everything to your 000000 /0 the next one is the Cog group Pier",
    "start": "886759",
    "end": "894399"
  },
  {
    "text": "npep this is kind of a continuation of the previous npep so when we did the previous npep like I mentioned the",
    "start": "894399",
    "end": "901880"
  },
  {
    "text": "networks was actually an inline Pier right like so you have to put your C of",
    "start": "901880",
    "end": "907680"
  },
  {
    "text": "blocks as within the& and the BP and if you're referring to multiple CER blocks",
    "start": "907680",
    "end": "913440"
  },
  {
    "text": "so if you have a really Dynamic set of ciders which keep changing you might have use cases for it so you might want",
    "start": "913440",
    "end": "920240"
  },
  {
    "text": "to actually have a separate object called the side a group this is this is not mer now this is just like a a sample",
    "start": "920240",
    "end": "927120"
  },
  {
    "text": "proposal for the npep and then you might want to refer to this CER group from your a& or BP this npep is currently in",
    "start": "927120",
    "end": "934720"
  },
  {
    "text": "the provisional State and a shout out to Michael and Joe who were the ones who",
    "start": "934720",
    "end": "939800"
  },
  {
    "text": "proposed the user stories here so we are trying to discuss and have more discussions around if this makes sense",
    "start": "939800",
    "end": "945720"
  },
  {
    "text": "in addition to the inline side ofs how do they work with each other should we do it or not so if you have use cases",
    "start": "945720",
    "end": "951279"
  },
  {
    "text": "please um comment on the npep if you if you would like to see something like this right",
    "start": "951279",
    "end": "956759"
  },
  {
    "text": "so the next one is the egis fqd and traffic controls again shout out to Rahul who's been working really hard on",
    "start": "956759",
    "end": "963000"
  },
  {
    "text": "getting this in user stories are merged so it's kind of again erress peer but proposing domains or fqdn as as your",
    "start": "963000",
    "end": "970519"
  },
  {
    "text": "peer being able to express that so we're adding support for this we have had lots of people come up to us and say we want",
    "start": "970519",
    "end": "976600"
  },
  {
    "text": "to see this in network policy we1 stable but we're not accepting features there right like so we're at least doing it in",
    "start": "976600",
    "end": "981720"
  },
  {
    "text": "the A&P so hope hoping this is going to be useful for many of you here if you have and this is currently in a stage",
    "start": "981720",
    "end": "987800"
  },
  {
    "text": "where the API design is happening so again we are looking for some feedback on",
    "start": "987800",
    "end": "993560"
  },
  {
    "text": "this the next one's the Ingress traffic controls uh this is being P pioneered by",
    "start": "993560",
    "end": "999720"
  },
  {
    "text": "nardia shout out to her for all the amazing work that she's been doing and this is the inverse right so we want to",
    "start": "999720",
    "end": "1005519"
  },
  {
    "text": "maybe you have southbound use cases we are a little bit struggling to figure",
    "start": "1005519",
    "end": "1010839"
  },
  {
    "text": "out how this use case would look like because for the southbound traffic that's trying to talk to your pod you always have an snat or an entity that",
    "start": "1010839",
    "end": "1017319"
  },
  {
    "text": "sits in the Middle where we are still figuring out how the policy interaction would look like here this is in the",
    "start": "1017319",
    "end": "1023360"
  },
  {
    "text": "provisional State please reach out to us and comment on the issue if you have user stories where you want to have",
    "start": "1023360",
    "end": "1030079"
  },
  {
    "text": "security posture controls for inbound right so external peer to pods who are",
    "start": "1030079",
    "end": "1035480"
  },
  {
    "text": "your subject in the cluster tency expression so remember that we mentioned that one of the main",
    "start": "1035480",
    "end": "1040520"
  },
  {
    "text": "use cases is multi-tenancy model where you want to isolate tenants but tenants",
    "start": "1040520",
    "end": "1045558"
  },
  {
    "text": "might not mean single name spaces right so you might want to express it in a better way than using selectors",
    "start": "1045559",
    "end": "1051799"
  },
  {
    "text": "like saying anything that's me or anything that's not me and me here being the subject tenant we are trying to",
    "start": "1051799",
    "end": "1058880"
  },
  {
    "text": "express that add a feature which will allow you to dynamically express it in a much better Manner and there's been this",
    "start": "1058880",
    "end": "1065280"
  },
  {
    "text": "has been a ongoing um npep for a long time and we are trying to converge on",
    "start": "1065280",
    "end": "1070440"
  },
  {
    "text": "how that API would look like um so again appreciated if you are interested in the",
    "start": "1070440",
    "end": "1075640"
  },
  {
    "text": "zenpep please to um leave us feedback on the API design conformance profiles um I gave a",
    "start": "1075640",
    "end": "1083520"
  },
  {
    "text": "talk earlier today so I don't know how many of you saw it but this is in this is in collaboration with the Gateway API",
    "start": "1083520",
    "end": "1089159"
  },
  {
    "text": "Community as as we are developing sorry as we are developing",
    "start": "1089159",
    "end": "1094799"
  },
  {
    "text": "new apis out of tree it's also important that we think about conformance tests",
    "start": "1094799",
    "end": "1099880"
  },
  {
    "text": "and how the implementations are going to help give us feedback and how we can track them better this effort is",
    "start": "1099880",
    "end": "1106559"
  },
  {
    "text": "actually aimed towards that where we want have where we defined clear profiles and test suits that the",
    "start": "1106559",
    "end": "1112720"
  },
  {
    "text": "implementors can then just take and run from our library run it in their suit give us the report back right like so",
    "start": "1112720",
    "end": "1117960"
  },
  {
    "text": "this is kind of meant for implementers but for end users the benefit that you get is there might be multiple",
    "start": "1117960",
    "end": "1123440"
  },
  {
    "text": "implementations doing A&P or BP so as an end user you might be confused on which",
    "start": "1123440",
    "end": "1129159"
  },
  {
    "text": "cni should I use for the policy this will help you because this shows you what cni supports which features and",
    "start": "1129159",
    "end": "1136640"
  },
  {
    "text": "then you can choose which one you want to use so that's what the end users get from here so that's all the new stuff",
    "start": "1136640",
    "end": "1142240"
  },
  {
    "text": "that we've been doing in the recent past and now coming to the future plans for us Network policy V2 should we maybe",
    "start": "1142240",
    "end": "1149480"
  },
  {
    "text": "let's look at some of the problem statements that we have with the existing Network policy framework I think I covered some of them in the",
    "start": "1149480",
    "end": "1156320"
  },
  {
    "text": "beginning which is the implicit deny right uh the first policy that you create on the names space just blocks",
    "start": "1156320",
    "end": "1161720"
  },
  {
    "text": "everything for you this is not written anywhere it just works that way weird syntactic Works might be let's say I",
    "start": "1161720",
    "end": "1168200"
  },
  {
    "text": "just mentioned implicit deny but if you have an IP block pier and I don't know if you've used the accept in that so you",
    "start": "1168200",
    "end": "1174880"
  },
  {
    "text": "might have a Blog but you want to accept uh some of the IPS within that block so that lets you kind of",
    "start": "1174880",
    "end": "1181919"
  },
  {
    "text": "explicitly deny stuff or not allow stuff so it kind of is weird in the sense of",
    "start": "1181919",
    "end": "1187280"
  },
  {
    "text": "how the API is designed so because of all those reasons we wanted to start fresh right like so",
    "start": "1187280",
    "end": "1192400"
  },
  {
    "text": "this is also it wasn't covering the admin use cases but we fixed it with the admin Network policy apis I'm just going",
    "start": "1192400",
    "end": "1198000"
  },
  {
    "text": "to quote Dan here right which is we did A&P which is a better Network policies for administrators and today",
    "start": "1198000",
    "end": "1204640"
  },
  {
    "text": "administrators are actually using this network policies and you can easily switch the& should we also be doing a",
    "start": "1204640",
    "end": "1210000"
  },
  {
    "text": "better Network policy for developers right like so which follows the same explicitness and easiness that& and BNP",
    "start": "1210000",
    "end": "1216159"
  },
  {
    "text": "API is offered today this is still just an idea we actually need somebody to just own and drive this in the community",
    "start": "1216159",
    "end": "1223520"
  },
  {
    "text": "so if you're interested in working on network policy ev2 please reach out to us um we are looking again for feedback",
    "start": "1223520",
    "end": "1229640"
  },
  {
    "text": "use cases ideas that you might have here with that I want to hand it over to Hunter who will talk about all the",
    "start": "1229640",
    "end": "1235880"
  },
  {
    "text": "exciting work that he's been doing with the user tooling and show us a cool demo of how all of what I said Works under",
    "start": "1235880",
    "end": "1241400"
  },
  {
    "text": "the hood yeah thanks Sera um so I'm going to shift gears a little bit uh going to be",
    "start": "1241400",
    "end": "1248000"
  },
  {
    "text": "talking about how you can get your hands dirty with these policies today and how",
    "start": "1248000",
    "end": "1253600"
  },
  {
    "text": "this will be helpful when you're using them in production",
    "start": "1253600",
    "end": "1260360"
  },
  {
    "text": "so I think we're all familiar with the Monday morning",
    "start": "1260360",
    "end": "1265640"
  },
  {
    "text": "issue imagine",
    "start": "1265640",
    "end": "1270880"
  },
  {
    "text": "sorry imagine for a moment that your application is",
    "start": "1270880",
    "end": "1276880"
  },
  {
    "text": "down and what would be the typical troubleshooting process today first we would probably access the nodes use a",
    "start": "1277000",
    "end": "1284520"
  },
  {
    "text": "utility like TCP dump and we might find out that they a drop package so now we need to find out",
    "start": "1284520",
    "end": "1292600"
  },
  {
    "text": "why when we proposed the admin Network policy we thought let's try to prevent",
    "start": "1292600",
    "end": "1298440"
  },
  {
    "text": "these headaches and we wanted this tooling from the start you know one example is a stacked policy uh like Shi",
    "start": "1298440",
    "end": "1307480"
  },
  {
    "text": "was saying we have priority based policies so what happens when the priority is the same uh there are also",
    "start": "1307480",
    "end": "1314080"
  },
  {
    "text": "some new features so let's just prevent headaches with all this stuff so today",
    "start": "1314080",
    "end": "1319799"
  },
  {
    "text": "we are introducing policy assistant this right now is a command line interface it can do things like",
    "start": "1319799",
    "end": "1326640"
  },
  {
    "text": "summarize all of your policies it has an analysis engine so",
    "start": "1326640",
    "end": "1331799"
  },
  {
    "text": "you can simulate What policies would do uh without actually needing a cluster",
    "start": "1331799",
    "end": "1338000"
  },
  {
    "text": "I'll get into that and finally there's some conformance testing capability uh which again I'll talk about at the end",
    "start": "1338000",
    "end": "1345159"
  },
  {
    "text": "so this is an extension of a pre-existing project called cyclus for",
    "start": "1345159",
    "end": "1350320"
  },
  {
    "text": "Network policy V1 and it's written in go and it's included in our repo so please do check",
    "start": "1350320",
    "end": "1357400"
  },
  {
    "text": "it out I'll have Links at the end um but yeah why why would we even want a policy",
    "start": "1357400",
    "end": "1363600"
  },
  {
    "text": "assistant I think of it as two two things uh one we want to",
    "start": "1363600",
    "end": "1370919"
  },
  {
    "text": "prevent issues and we want to troubleshoot issues so preventing issues",
    "start": "1370919",
    "end": "1376400"
  },
  {
    "text": "you can break that down into a pre validation say you have a policy and",
    "start": "1376400",
    "end": "1381520"
  },
  {
    "text": "you're about to apply it to your prod cluster let's hope that it doesn't break",
    "start": "1381520",
    "end": "1387320"
  },
  {
    "text": "anything um but the aim with this is you can actually validate that it won't",
    "start": "1387320",
    "end": "1393760"
  },
  {
    "text": "break anything using policy assistant to do the heavy lifting so you can say like how would this rule affect pre-existing",
    "start": "1393760",
    "end": "1400919"
  },
  {
    "text": "traffic I think of this kind of synonymous with experimentation you can",
    "start": "1400919",
    "end": "1406000"
  },
  {
    "text": "learn about the API ask it to summarize things for you just yeah learning about",
    "start": "1406000",
    "end": "1412360"
  },
  {
    "text": "the API and the other leg of it is troubleshooting issues like with the",
    "start": "1412360",
    "end": "1419080"
  },
  {
    "text": "application that was broken earlier are my policies causing this drop traffic and which policy is doing it now",
    "start": "1419080",
    "end": "1426480"
  },
  {
    "text": "that we have three apis so just a final recap before we get",
    "start": "1426480",
    "end": "1432200"
  },
  {
    "text": "into things we have the admin Network policy coming first uh and that has",
    "start": "1432200",
    "end": "1438520"
  },
  {
    "text": "priorities that will come into play and then we have the old Network policy",
    "start": "1438520",
    "end": "1444400"
  },
  {
    "text": "V1 and then finally you have the Baseline admin Network",
    "start": "1444400",
    "end": "1449600"
  },
  {
    "text": "policy so uh please join me in praying to the demo Gods because we will be doing a live",
    "start": "1449600",
    "end": "1457159"
  },
  {
    "text": "demo before we get into it I actually do want to just describe the topology here",
    "start": "1460520",
    "end": "1465559"
  },
  {
    "text": "so we have a demo name space with just two pods very simple setup we have pod A",
    "start": "1465559",
    "end": "1471159"
  },
  {
    "text": "and B B is connecting to a on Port 80",
    "start": "1471159",
    "end": "1476279"
  },
  {
    "text": "and 81 and similarly a is sending traffic to B on Port 80 and",
    "start": "1476279",
    "end": "1483240"
  },
  {
    "text": "81 um and like I said earlier you don't need a cluster I will not be using a cluster in My Demo so these are just",
    "start": "1483240",
    "end": "1491679"
  },
  {
    "text": "theoretical connections there are no pods everything's being",
    "start": "1491679",
    "end": "1496840"
  },
  {
    "text": "simulated okay let's do",
    "start": "1497320",
    "end": "1501640"
  },
  {
    "text": "it we going to start with the network",
    "start": "1507320",
    "end": "1512760"
  },
  {
    "text": "policy all my policies are going to be in the demo",
    "start": "1512760",
    "end": "1518399"
  },
  {
    "text": "namespace um to start we're going to have a rule that is ingress for incoming traffic and",
    "start": "1518679",
    "end": "1527640"
  },
  {
    "text": "it's talking about about traffic on Port 81 and it's going to be talking about",
    "start": "1527640",
    "end": "1533320"
  },
  {
    "text": "all pods in all Nam spaces and just to be explicit this is a",
    "start": "1533320",
    "end": "1539520"
  },
  {
    "text": "deny rule so without further Ado let's look",
    "start": "1539520",
    "end": "1546200"
  },
  {
    "text": "at this CLI we have this Command right",
    "start": "1546200",
    "end": "1551840"
  },
  {
    "text": "here since I'm not using a cluster I'm going to be using this thing called a",
    "start": "1551840",
    "end": "1557000"
  },
  {
    "text": "policy or I'm just going to feed the the policies the directory that they're",
    "start": "1557000",
    "end": "1562640"
  },
  {
    "text": "in and now we have this thing called a simulated connectivity",
    "start": "1562640",
    "end": "1568200"
  },
  {
    "text": "table so like I was saying we're talking about pods in the demo namespace both A",
    "start": "1568200",
    "end": "1573880"
  },
  {
    "text": "and B on the left we have Source pods and on the top we have destination",
    "start": "1573880",
    "end": "1580600"
  },
  {
    "text": "pods um and so again Port 8 and 81 are in play this dot is saying that this",
    "start": "1580600",
    "end": "1588919"
  },
  {
    "text": "admin Network policy would actually allow traffic from B to a on Port 81 or",
    "start": "1588919",
    "end": "1597360"
  },
  {
    "text": "sorry Port 80 but then the X on the right is saying that b to a is denied on Port",
    "start": "1597360",
    "end": "1606840"
  },
  {
    "text": "81 so we have a similar thing here uh for A to",
    "start": "1606840",
    "end": "1612640"
  },
  {
    "text": "B it's allowed on Port 80 denied on Port 81",
    "start": "1612640",
    "end": "1619480"
  },
  {
    "text": "so now I'm quickly going to add a couple more admin Network",
    "start": "1619480",
    "end": "1624480"
  },
  {
    "text": "policies the first one's a carbon copy of the previous except as doing this pass rule I like sir was saying pass",
    "start": "1624919",
    "end": "1632399"
  },
  {
    "text": "means stop EV valuing admin Network policy hand it down to the network",
    "start": "1632399",
    "end": "1637720"
  },
  {
    "text": "policy V1 and this is actually a higher priority than the previous",
    "start": "1637720",
    "end": "1644440"
  },
  {
    "text": "one and we also have an A admin Network policy talking about Port 80 this time",
    "start": "1644440",
    "end": "1651840"
  },
  {
    "text": "and it's allowing traffic so if you run the same",
    "start": "1651840",
    "end": "1657799"
  },
  {
    "text": "commands now we see that traffic from B to a is allowed on Port 80 so there was",
    "start": "1657799",
    "end": "1663840"
  },
  {
    "text": "that difference um where sorry I mean Port 81 it was",
    "start": "1663840",
    "end": "1671440"
  },
  {
    "text": "denied before but now all ports are allowed",
    "start": "1671440",
    "end": "1677120"
  },
  {
    "text": "so let's try to visualize what these policies are we have this summary",
    "start": "1677120",
    "end": "1685120"
  },
  {
    "text": "table they will group all policies by their subject so here we're",
    "start": "1685159",
    "end": "1692519"
  },
  {
    "text": "saying everything in the demo Nam space um so we have all three of our admin",
    "start": "1692519",
    "end": "1698159"
  },
  {
    "text": "Network policies right now targeting all pods all Nam spaces and then we group it",
    "start": "1698159",
    "end": "1703440"
  },
  {
    "text": "by Port so we have that allow rule for Port 80 and for Port 81 we see the pass",
    "start": "1703440",
    "end": "1710919"
  },
  {
    "text": "with a higher priority okay",
    "start": "1710919",
    "end": "1718039"
  },
  {
    "text": "finally I'm going to add a network policy V1 what we know and love or don't love",
    "start": "1718039",
    "end": "1726200"
  },
  {
    "text": "um and so this is targeting pod a again demo demo namespace and it's saying",
    "start": "1726200",
    "end": "1733360"
  },
  {
    "text": "don't allow any incoming traffic",
    "start": "1733360",
    "end": "1739720"
  },
  {
    "text": "so we can see one change traffic from B to a on Port 81 is",
    "start": "1739720",
    "end": "1746760"
  },
  {
    "text": "now blocked because of that deny all uh",
    "start": "1746760",
    "end": "1751799"
  },
  {
    "text": "Network policy I can go back into why uh in a",
    "start": "1751799",
    "end": "1758240"
  },
  {
    "text": "second and if things start to get confusing don't worry we will be walking",
    "start": "1758240",
    "end": "1764679"
  },
  {
    "text": "through things at the end um so finally we have a baseline admin Network policy",
    "start": "1764679",
    "end": "1771519"
  },
  {
    "text": "and this is going to be doing uh it's going to be talking about the demo namespace again talking about",
    "start": "1771519",
    "end": "1778159"
  },
  {
    "text": "all pods from all namespaces and it's saying deny the Ingress just whatever",
    "start": "1778159",
    "end": "1783519"
  },
  {
    "text": "comes past the network policy we should be denying",
    "start": "1783519",
    "end": "1788919"
  },
  {
    "text": "it so we can see that there's been one more change a to",
    "start": "1793240",
    "end": "1799640"
  },
  {
    "text": "B on Port 81 is blocked I'm going to show one more thing",
    "start": "1799640",
    "end": "1806519"
  },
  {
    "text": "here let's figure out what's going on this summary table also includes our",
    "start": "1806519",
    "end": "1814159"
  },
  {
    "text": "Network policy V1 and our Baseline admin Network policy and so for instance with mpv1 we",
    "start": "1814159",
    "end": "1821240"
  },
  {
    "text": "can see it's targeting pod a we can see it allows any peers but it doesn't have",
    "start": "1821240",
    "end": "1828039"
  },
  {
    "text": "any peers that're allowed hence to deny all there and finally we have the Baseline",
    "start": "1828039",
    "end": "1834559"
  },
  {
    "text": "AB Network policy denying all ports and all protocols",
    "start": "1834559",
    "end": "1842120"
  },
  {
    "text": "so let me bring up the table once",
    "start": "1845159",
    "end": "1850600"
  },
  {
    "text": "more so I'm going to walk through all this things",
    "start": "1856399",
    "end": "1862760"
  },
  {
    "text": "um I'm going to do it the hard way first and then I'm going to show you one last cool feature that",
    "start": "1862760",
    "end": "1869360"
  },
  {
    "text": "shows I guess an easier way to do things so uh let's walk through our four",
    "start": "1869360",
    "end": "1875600"
  },
  {
    "text": "connections we have B to a on Port 80 that is allowed why is that allowed it's",
    "start": "1875600",
    "end": "1881120"
  },
  {
    "text": "because we have this admin Network policy allowing on Port 80 similar thing for A to B that's",
    "start": "1881120",
    "end": "1888200"
  },
  {
    "text": "allowed because it's on Port 80 then Port 81 traffic is passed",
    "start": "1888200",
    "end": "1895480"
  },
  {
    "text": "down so now we're looking at this one B to",
    "start": "1895480",
    "end": "1903480"
  },
  {
    "text": "a that's going to be denied because there are no allowed peers for this network policy targeting",
    "start": "1903480",
    "end": "1910519"
  },
  {
    "text": "py and then finally for A to B on P 81 the Baseline admin Network policy kicks",
    "start": "1910519",
    "end": "1917039"
  },
  {
    "text": "in so the more policies you have the more confusing this could get harder it is to",
    "start": "1917039",
    "end": "1924240"
  },
  {
    "text": "walk through so let me show you this final thing we have this Mode called",
    "start": "1924240",
    "end": "1929720"
  },
  {
    "text": "walkthrough so it can do all the heavy lifting for you uh so we have all our four connections again A to B on Port 80",
    "start": "1929720",
    "end": "1936840"
  },
  {
    "text": "that's allowed by the Admin Network policy same with B to a on Port 80 and",
    "start": "1936840",
    "end": "1942399"
  },
  {
    "text": "then why is the traffic on Port 81 getting denied we can see",
    "start": "1942399",
    "end": "1949720"
  },
  {
    "text": "that for A to B that's denied by the Baseline admin Network policy but for B",
    "start": "1949720",
    "end": "1957080"
  },
  {
    "text": "to a it comes down to the network policy V1 so yeah we're really excited about",
    "start": "1957080",
    "end": "1965320"
  },
  {
    "text": "this feature hopefully can help you debug issues in your cluster or prevent them with that",
    "start": "1965320",
    "end": "1971960"
  },
  {
    "text": "prevalidation just going to summarize real quick so we have the simulated capabilities looking at allowed and",
    "start": "1971960",
    "end": "1979440"
  },
  {
    "text": "denied traffic we can summarize all our policies group together and we can walk through all of",
    "start": "1979440",
    "end": "1987080"
  },
  {
    "text": "our policies and why and which policy is",
    "start": "1987080",
    "end": "1992159"
  },
  {
    "text": "causing an allow or drop and just wanted to give a shout out",
    "start": "1992159",
    "end": "1998600"
  },
  {
    "text": "to the Future road map so this is just the beginning we just have three modes",
    "start": "1998600",
    "end": "2003880"
  },
  {
    "text": "in a command line interface we welcome all ideas when it comes to new features new designs so please um",
    "start": "2003880",
    "end": "2012679"
  },
  {
    "text": "check out the parent issue uh these are just a couple things we have in mind right now one being conformance testing",
    "start": "2012679",
    "end": "2020760"
  },
  {
    "text": "uh which you know with the cyclus framework we can add another conformance badge that just makes sure that all the",
    "start": "2020760",
    "end": "2028000"
  },
  {
    "text": "cnis cover all of the edge cases when it comes to these new apis so you don't",
    "start": "2028000",
    "end": "2033440"
  },
  {
    "text": "have to worry about that that's just something on our road map um and I do want to give a shout out to Nicola who",
    "start": "2033440",
    "end": "2039120"
  },
  {
    "text": "wrote that summary table you saw today that was a big help um and big shout out",
    "start": "2039120",
    "end": "2044320"
  },
  {
    "text": "to Matt fenrick who wrote the whole cyclist framework basically that we built off of and so yeah here's the parent issue",
    "start": "2044320",
    "end": "2052320"
  },
  {
    "text": "if you want to check it out and also I encourage you to look at the demo code",
    "start": "2052320",
    "end": "2057638"
  },
  {
    "text": "uh mess around with it try different admin Network policies just learn about the new apis um yeah just have fun with",
    "start": "2057639",
    "end": "2066720"
  },
  {
    "text": "it so pass it off",
    "start": "2066720",
    "end": "2071759"
  },
  {
    "text": "yeah yeah that was a cool demo um we're going to we're at the end of the presentation just want to say um if you",
    "start": "2076720",
    "end": "2082839"
  },
  {
    "text": "want to get involved in the project please reach out to us we are here at cucon and also on slack we live on slack",
    "start": "2082839",
    "end": "2089320"
  },
  {
    "text": "the Sig Network policy API slack on kubernetes so please check it out check out our website in codebase we need help",
    "start": "2089320",
    "end": "2096040"
  },
  {
    "text": "with lots and lots of issues the conform profiles testing all the N peps if you have new features add them Network",
    "start": "2096040",
    "end": "2102240"
  },
  {
    "text": "policy assistant needs help so we're always in shortage of developers and contributors and even non-code right",
    "start": "2102240",
    "end": "2108240"
  },
  {
    "text": "like so just giving us feedback on how these apis are working so thank you everyone for coming to our talk and if",
    "start": "2108240",
    "end": "2113920"
  },
  {
    "text": "you have any questions Hunter and I will be here so um we'll be happy to answer answer any of that thank",
    "start": "2113920",
    "end": "2120490"
  },
  {
    "text": "[Applause] you",
    "start": "2120490",
    "end": "2125320"
  }
]