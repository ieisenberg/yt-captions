[
  {
    "text": "okay I'm I'm going to start so hello hello everybody and welcome to our show",
    "start": "480",
    "end": "5839"
  },
  {
    "text": "uh sorry to our talk my name is Roman and I'm a Technical Solutions engineer",
    "start": "5839",
    "end": "11400"
  },
  {
    "text": "at Google today I'm going to be talking about kubernetes support at Google Cloud uh I just said that I'm Technical",
    "start": "11400",
    "end": "18800"
  },
  {
    "text": "Solutions engineer but that's just a fancy name for a support engineer so why we are all here we all",
    "start": "18800",
    "end": "26640"
  },
  {
    "text": "know that kubernetes is a powerful container orry we are all here that's why we are here",
    "start": "26640",
    "end": "32758"
  },
  {
    "text": "and kubernetes is turning 10 years this year we all know that the first cubec",
    "start": "32759",
    "end": "38480"
  },
  {
    "text": "con was almost 9 years ago after all this time we are all long past the demos",
    "start": "38480",
    "end": "44360"
  },
  {
    "text": "all long past the PC's many of you already adopted kubernetes and using it in",
    "start": "44360",
    "end": "50640"
  },
  {
    "text": "production and um but with all the all of the Ben that's all due to benefits",
    "start": "50640",
    "end": "56920"
  },
  {
    "text": "kubernetes brings but with all of the benefits there also come the challenges let's face it kubernetes is",
    "start": "56920",
    "end": "64439"
  },
  {
    "text": "not a magic want it also needs some loves and attention but fear not that's where",
    "start": "64439",
    "end": "71360"
  },
  {
    "text": "people like me and my colleagues come in to save the day let's take a look at some Trends out",
    "start": "71360",
    "end": "80240"
  },
  {
    "text": "of all the cases kubernetes related cases received in 2023 here is the list of future cases by",
    "start": "80240",
    "end": "88079"
  },
  {
    "text": "Future in descending on or order uh this is not an exhaustive list but these are",
    "start": "88079",
    "end": "93640"
  },
  {
    "text": "just the top seven features if we take a look at this list at the first place is networking and it",
    "start": "93640",
    "end": "100560"
  },
  {
    "text": "makes sense one of the main use cases of kubernetes are microservices and all",
    "start": "100560",
    "end": "106600"
  },
  {
    "text": "those microservices need to chat as a result first place is networking node",
    "start": "106600",
    "end": "112960"
  },
  {
    "text": "related issues are usually related to node stability resource allocation or",
    "start": "112960",
    "end": "118079"
  },
  {
    "text": "node failures if if kubernetes has like Auto healing mechanisms and it",
    "start": "118079",
    "end": "123600"
  },
  {
    "text": "reschedules the workload it replaces the failed node what I noticed is that",
    "start": "123600",
    "end": "128759"
  },
  {
    "text": "people really care about what happens to that node and they really want to know why they",
    "start": "128759",
    "end": "134680"
  },
  {
    "text": "failed for control plane issues we are dealing with Qi server controller",
    "start": "134680",
    "end": "139720"
  },
  {
    "text": "manager atcd these issues usually do not affect the workload directly but they do affect",
    "start": "139720",
    "end": "146760"
  },
  {
    "text": "the scheduling part the orchestration part so they do get your attention",
    "start": "146760",
    "end": "151800"
  },
  {
    "text": "really quickly even if your control plane is managed by a service provider you can",
    "start": "151800",
    "end": "158200"
  },
  {
    "text": "still break it depending on what you're running in your cluster all those control plane components they don't have",
    "start": "158200",
    "end": "166000"
  },
  {
    "text": "infinite resources so for example if you have a controller that runs and creates only resources and doesn't delete them",
    "start": "166000",
    "end": "172680"
  },
  {
    "text": "you can easily fill out the itd database causing",
    "start": "172680",
    "end": "177760"
  },
  {
    "text": "issues another way to look at this list is uh which feature is the most popular",
    "start": "177760",
    "end": "183760"
  },
  {
    "text": "and the most complicated at the same time like if uh as the feature set grows",
    "start": "183760",
    "end": "190879"
  },
  {
    "text": "so does the complexity and where complexity comes in this is where",
    "start": "190879",
    "end": "196000"
  },
  {
    "text": "support comes in so let me share with you a real life",
    "start": "196000",
    "end": "201480"
  },
  {
    "text": "case that had me scratching my head so when customers create cases there are",
    "start": "201480",
    "end": "208640"
  },
  {
    "text": "multiple automated job that are running analyzing the configuration the logs and try to help customers even before they",
    "start": "208640",
    "end": "216200"
  },
  {
    "text": "are opening a case but still if they're open a c opening a case all the output",
    "start": "216200",
    "end": "221959"
  },
  {
    "text": "from all those jobs come to us as support engineers and help us trouble should the issue",
    "start": "221959",
    "end": "227360"
  },
  {
    "text": "further even with all those automated jobs they just can't catch them",
    "start": "227360",
    "end": "233400"
  },
  {
    "text": "all so let's take a look at the case so this is a real life case all the names",
    "start": "233400",
    "end": "240239"
  },
  {
    "text": "were changed but the issue is still the same so this is how customers create cases this is the case",
    "start": "240239",
    "end": "247480"
  },
  {
    "text": "number this is who created the case John Doe what a popular name so John created the case and he",
    "start": "247480",
    "end": "255319"
  },
  {
    "text": "says not able to create G key clusters it is failing with the below error and",
    "start": "255319",
    "end": "261120"
  },
  {
    "text": "the error is like a CVS receipt apparently he wanted to put the whole",
    "start": "261120",
    "end": "267240"
  },
  {
    "text": "line in the subject and it didn't feel fit in so John can also set the priority",
    "start": "267240",
    "end": "272960"
  },
  {
    "text": "P1 is the highest priority which means we need to move fast to help John category so here he can select",
    "start": "272960",
    "end": "280400"
  },
  {
    "text": "technical kubernetes engine and then after kubernetes engine he can also select the feature one of the features",
    "start": "280400",
    "end": "287800"
  },
  {
    "text": "that I we've seen in the previous slide but he didn't do that so we'll have to figure that",
    "start": "287800",
    "end": "293000"
  },
  {
    "text": "out project ID then cluster name name space node name workload name the thing",
    "start": "293000",
    "end": "300960"
  },
  {
    "text": "is like all of these details they do help us but customers when they are in a",
    "start": "300960",
    "end": "307120"
  },
  {
    "text": "hurry they really don't feel don't put either they don't put the details or they put the them incorrectly so we just",
    "start": "307120",
    "end": "313759"
  },
  {
    "text": "need to read the case description to actually understand what's happening so this is what we're doing here we create",
    "start": "313759",
    "end": "320160"
  },
  {
    "text": "G ke clusters for our application and we do cctl patching it was working fine two",
    "start": "320160",
    "end": "326400"
  },
  {
    "text": "days ago suddenly we see this error for C c patch blah blah blah and we have",
    "start": "326400",
    "end": "332680"
  },
  {
    "text": "this certificate signed by unknown Authority okay so I have an error I have",
    "start": "332680",
    "end": "339039"
  },
  {
    "text": "where it's coming from but I don't know where the ccil is running I don't know on which cluster does this apply so I",
    "start": "339039",
    "end": "346120"
  },
  {
    "text": "need to ask these details to try to help John so this is what I'm doing",
    "start": "346120",
    "end": "351880"
  },
  {
    "text": "here can you please tell me does it occur on all of the cluster is it",
    "start": "351880",
    "end": "357600"
  },
  {
    "text": "happening on newly created clusters or for existence clusters as well and John",
    "start": "357600",
    "end": "362720"
  },
  {
    "text": "is apparently in a hurry and he just says any update on this okay but oh now just a little while",
    "start": "362720",
    "end": "371520"
  },
  {
    "text": "later he apparently seen my question and says this is occurring a new GQ clusters",
    "start": "371520",
    "end": "377120"
  },
  {
    "text": "the patching command is working fine from my MacBook but when it's running from a Google VM the command is not",
    "start": "377120",
    "end": "384080"
  },
  {
    "text": "working so this is a very important piece of information because c c is",
    "start": "384080",
    "end": "389280"
  },
  {
    "text": "working fine on his MacBook but it's failing on the Google VM so we kind of can limit this to a Google",
    "start": "389280",
    "end": "396960"
  },
  {
    "text": "VM and next this is a blocker for our production roll out please update on this okay we need to really hurry this",
    "start": "396960",
    "end": "404240"
  },
  {
    "text": "here so I have a little bit of more information but he has that error and",
    "start": "404240",
    "end": "410919"
  },
  {
    "text": "that error can come from so he's running cctl all the information Cube CTL has is",
    "start": "410919",
    "end": "417120"
  },
  {
    "text": "from Cube config so any manual tempering of that Cube config can generate this",
    "start": "417120",
    "end": "423280"
  },
  {
    "text": "error so what I'm trying to say here is like to to tell John to regenerate Cube",
    "start": "423280",
    "end": "429800"
  },
  {
    "text": "config hopefully he will get a fresh new Cube config everything will be fine",
    "start": "429800",
    "end": "435120"
  },
  {
    "text": "problem will be solved this is what I'm asking John to do please regenerate Cube",
    "start": "435120",
    "end": "440680"
  },
  {
    "text": "config John comes back we're still facing the same issue and an IP",
    "start": "440680",
    "end": "446080"
  },
  {
    "text": "address like I have this IP address I can find",
    "start": "446080",
    "end": "451319"
  },
  {
    "text": "the VM by the IP address because we as support Engineers we have readon access we can see the configuration we can see",
    "start": "451319",
    "end": "457039"
  },
  {
    "text": "the VMS we can see the logs but I cannot log in into VM because there could be private information for the customer so",
    "start": "457039",
    "end": "463680"
  },
  {
    "text": "this doesn't really help me then I'm asking John did you try to",
    "start": "463680",
    "end": "468840"
  },
  {
    "text": "recreate Cube config because I didn't really understand from the previous reply and I'm also asking him can you",
    "start": "468840",
    "end": "474919"
  },
  {
    "text": "please run this Comm cctl with insecure skip TLS verify just to make make sure",
    "start": "474919",
    "end": "480360"
  },
  {
    "text": "QB API server is reachable from that VM so we can kind of limit further down the",
    "start": "480360",
    "end": "487360"
  },
  {
    "text": "problem and John comes back with we just have the same error and again an IP",
    "start": "487360",
    "end": "493000"
  },
  {
    "text": "address at this point in time I'm just let's just jump on a call and troubleshoot this issue live as real",
    "start": "493000",
    "end": "500039"
  },
  {
    "text": "Engineers do so when we jump on a call I can",
    "start": "500039",
    "end": "505120"
  },
  {
    "text": "actually ask John to run some commands see the output and try to figure this out okay so this is what we're doing",
    "start": "505120",
    "end": "512719"
  },
  {
    "text": "here John is connected to this Bastion host and just to see the issue let's",
    "start": "512719",
    "end": "519320"
  },
  {
    "text": "just try Cube CTL sorry Cube CTL",
    "start": "519320",
    "end": "524760"
  },
  {
    "text": "getp Cube CTL Cube CTL get pod okay and sure enough we see the same",
    "start": "524760",
    "end": "533000"
  },
  {
    "text": "error certificate signed by a known Authority okay just to make sure that John did what I asked him to do to",
    "start": "533000",
    "end": "540519"
  },
  {
    "text": "regenerate Cube config let's just do that once again but first we need to back it",
    "start": "540519",
    "end": "546760"
  },
  {
    "text": "up so in case John needs it later remove the one that is there generate a new",
    "start": "546760",
    "end": "555160"
  },
  {
    "text": "one okay we're generating for cluster 45 that's the problem where um actually",
    "start": "555440",
    "end": "561600"
  },
  {
    "text": "it's for cluster 60 that's where the he reported",
    "start": "561600",
    "end": "566640"
  },
  {
    "text": "the problem and let's just we have a shiny new Cube config hopefully it",
    "start": "566640",
    "end": "572360"
  },
  {
    "text": "should work but no we still have the same issue now at this point I don't",
    "start": "572360",
    "end": "580240"
  },
  {
    "text": "understand what's happening like we have just generated the new Cube config everything should be working I have the",
    "start": "580240",
    "end": "585519"
  },
  {
    "text": "proper certificate I have like it should be fine like what's happening at this",
    "start": "585519",
    "end": "591360"
  },
  {
    "text": "point I need to read some documentation I I know I told you we're",
    "start": "591360",
    "end": "596760"
  },
  {
    "text": "experts but we're just basically on an a date with documentation So reading here I can see",
    "start": "596760",
    "end": "605160"
  },
  {
    "text": "client certificate authentification is enabled by bypassing this flag to the",
    "start": "605160",
    "end": "610480"
  },
  {
    "text": "API server so what this means is that we have a certificate Authority that is",
    "start": "610480",
    "end": "615760"
  },
  {
    "text": "used by Cube API server and all the client certificates and this certificate",
    "start": "615760",
    "end": "621279"
  },
  {
    "text": "used by the API server should be signed by the same certificate Authority if this is true everything",
    "start": "621279",
    "end": "629000"
  },
  {
    "text": "should be be working fine we can actually check that so let's do that the certificate used by Cube CTL",
    "start": "629000",
    "end": "637560"
  },
  {
    "text": "can be found in Cube config so let's just take that config",
    "start": "637560",
    "end": "644560"
  },
  {
    "text": "view with the row output so we it contains also the certificate we provide",
    "start": "644560",
    "end": "649839"
  },
  {
    "text": "the path to the certificate Authority data we decode it we put it into a file",
    "start": "649839",
    "end": "656000"
  },
  {
    "text": "good we have the cube C certificate now we can also get the certificate from the QBE API",
    "start": "656000",
    "end": "661720"
  },
  {
    "text": "server let's just find the cluster IP address first we also can get that from",
    "start": "661720",
    "end": "667440"
  },
  {
    "text": "Cube config we get the cluster IP and with the mighty open SSL command we can",
    "start": "667440",
    "end": "673959"
  },
  {
    "text": "actually get the certificate again get the certificate put it into a file again with",
    "start": "673959",
    "end": "680560"
  },
  {
    "text": "openl we can actually check the issues of both of the certificates the one used",
    "start": "680560",
    "end": "685680"
  },
  {
    "text": "by Cube config and the one used uh by QBE API server let's do",
    "start": "685680",
    "end": "692680"
  },
  {
    "text": "that this is for cube API server the",
    "start": "692680",
    "end": "697880"
  },
  {
    "text": "isure and for cube config for cube C and we can",
    "start": "697880",
    "end": "705480"
  },
  {
    "text": "see the issues are different so this is the problem I still don't understand how",
    "start": "705480",
    "end": "711120"
  },
  {
    "text": "this can happen because we have just generated the cube config but I'm focused on solving the problem so John",
    "start": "711120",
    "end": "717720"
  },
  {
    "text": "can use this Bastion host to to make this him his deployments we can actually do that so",
    "start": "717720",
    "end": "723399"
  },
  {
    "text": "the problem here is that issues are different and that's why he gets this error so if we use the certificate from",
    "start": "723399",
    "end": "730200"
  },
  {
    "text": "Cube API server and we put it in Cube config everything should be working fine",
    "start": "730200",
    "end": "735399"
  },
  {
    "text": "let's do that we're setting the context for the",
    "start": "735399",
    "end": "740480"
  },
  {
    "text": "current context with the certificate the certificate Authority for the current context and we are taking the",
    "start": "740480",
    "end": "747040"
  },
  {
    "text": "certificate from qbp which we just got encode it in B 64 and let's do that let's do Cube C get",
    "start": "747040",
    "end": "755760"
  },
  {
    "text": "pod it's working the error is gone this is kind of good because we mitigated the",
    "start": "755760",
    "end": "762040"
  },
  {
    "text": "issue but I still don't know what happened like why this issue was very in",
    "start": "762040",
    "end": "767560"
  },
  {
    "text": "the first place because like as I told you multiple times already we have just",
    "start": "767560",
    "end": "772839"
  },
  {
    "text": "generated Cube config like why is this is happening just to make sure everything is fine I'm asking John to R",
    "start": "772839",
    "end": "779240"
  },
  {
    "text": "some run some more commands like get no and he says like oh look at this this",
    "start": "779240",
    "end": "785920"
  },
  {
    "text": "is from cluster 35 this is a different cluster here I'm I'm like I know what's",
    "start": "785920",
    "end": "793399"
  },
  {
    "text": "happening I know what's the problem John thinks he's connecting to Cluster 60 but",
    "start": "793399",
    "end": "800120"
  },
  {
    "text": "he's actually connecting to Cluster 45 maybe the IP address of the QB API",
    "start": "800120",
    "end": "805720"
  },
  {
    "text": "server is the same we can also check that let's check in Cube",
    "start": "805720",
    "end": "811920"
  },
  {
    "text": "config the server IP address and see here we have two IP addresses of the",
    "start": "811920",
    "end": "817680"
  },
  {
    "text": "cube API server to same IP addresses so just to reiterate John has this Bastion host",
    "start": "817680",
    "end": "825839"
  },
  {
    "text": "that he uses to connect to different clusters there is some kind of routing",
    "start": "825839",
    "end": "831000"
  },
  {
    "text": "here that should route requests to a correct subnet where the correct QB API",
    "start": "831000",
    "end": "837560"
  },
  {
    "text": "server is in this case John generated the cube config for cluster 60 but he's",
    "start": "837560",
    "end": "844360"
  },
  {
    "text": "actually connecting to Cluster 35 getting this whole error when cube config is generated it has the",
    "start": "844360",
    "end": "850880"
  },
  {
    "text": "certificate for class 3 60 so if we generate Cube config now for cluster",
    "start": "850880",
    "end": "857320"
  },
  {
    "text": "60 Cube C get pod everything is working fine oh sorry",
    "start": "857320",
    "end": "866480"
  },
  {
    "text": "yeah ah no so cluster 60 is the problem if we generate for cluster",
    "start": "868040",
    "end": "873639"
  },
  {
    "text": "35 everything should be working fine",
    "start": "873639",
    "end": "878279"
  },
  {
    "text": "again see no error problem solved now I can go and",
    "start": "879519",
    "end": "885079"
  },
  {
    "text": "get a cup of coffee or something but there is over case coming",
    "start": "885079",
    "end": "892199"
  },
  {
    "text": "in support is a 24/7 operation so I can just hand this",
    "start": "893000",
    "end": "899600"
  },
  {
    "text": "case with this next case off to my colleague",
    "start": "899600",
    "end": "904000"
  },
  {
    "text": "Sian all set",
    "start": "916040",
    "end": "919880"
  },
  {
    "text": "up",
    "start": "927959",
    "end": "930959"
  },
  {
    "text": "sorry it's just not being",
    "start": "950600",
    "end": "954440"
  },
  {
    "text": "detected",
    "start": "957920",
    "end": "960920"
  },
  {
    "text": "I'll Tred I'll try the other",
    "start": "964120",
    "end": "969920"
  },
  {
    "text": "[Music] side",
    "start": "983950",
    "end": "990920"
  },
  {
    "text": "it's this",
    "start": "992079",
    "end": "994639"
  },
  {
    "text": "say",
    "start": "1017839",
    "end": "1020839"
  },
  {
    "text": "thank okay okay um I'm sorry for that um yeah",
    "start": "1025559",
    "end": "1031120"
  },
  {
    "text": "I guess talks can go however they go okay um so I'm taking over from Roman I",
    "start": "1031120",
    "end": "1037600"
  },
  {
    "text": "am another JK firefighter and my name is xan and we're going to be looking",
    "start": "1037600",
    "end": "1043079"
  },
  {
    "text": "through another case and this one started off as a P2 case okay okay so",
    "start": "1043079",
    "end": "1049640"
  },
  {
    "text": "let's take a look at the case so the final priority was P1 but started off as a P2 we have priorities all the way",
    "start": "1049640",
    "end": "1056520"
  },
  {
    "text": "between P1 to P4 and P2 is just under uh P1 and basically it's that something is",
    "start": "1056520",
    "end": "1063840"
  },
  {
    "text": "broken but the customer is not down in production and let's go through just",
    "start": "1063840",
    "end": "1069320"
  },
  {
    "text": "what has been reported to us so we have the title we have um a message here",
    "start": "1069320",
    "end": "1075440"
  },
  {
    "text": "saying that autoscaling is not working we have project ID D um we have a class",
    "start": "1075440",
    "end": "1080640"
  },
  {
    "text": "name that's good we have the namespace name um we have the workload name and",
    "start": "1080640",
    "end": "1085840"
  },
  {
    "text": "then we have a brief description here which says that they have scaled up their workload but most of the pods are",
    "start": "1085840",
    "end": "1092799"
  },
  {
    "text": "in the pending State again not much information for me to go on they haven't for example told me um when they first",
    "start": "1092799",
    "end": "1100600"
  },
  {
    "text": "noticed the issue when they attempted scale up what's the business impact for them if there any errors or relevant log",
    "start": "1100600",
    "end": "1108400"
  },
  {
    "text": "messages is so from there I just request for the information because as I say",
    "start": "1108400",
    "end": "1114080"
  },
  {
    "text": "many times we're not really magicians we don't know everything and we have to ask many times because it's P2 um I decide",
    "start": "1114080",
    "end": "1122760"
  },
  {
    "text": "to wait for the customer to come back to me and provide the details before I do",
    "start": "1122760",
    "end": "1128400"
  },
  {
    "text": "any more work okay after a while they come back and they say we're seeing",
    "start": "1128400",
    "end": "1134840"
  },
  {
    "text": "messages like this so zero of three nodes are available which is basically telling me um that the Pod the pods",
    "start": "1134840",
    "end": "1142000"
  },
  {
    "text": "couldn't be scheduled on a node they couldn't find a suitable node and then they also share um some messages here",
    "start": "1142000",
    "end": "1149240"
  },
  {
    "text": "about um Cube cattle um not uh returning couldn't get resource list for metrics",
    "start": "1149240",
    "end": "1156960"
  },
  {
    "text": "and it's not really clear to me how the two are related again they haven't told me anything about the business impact",
    "start": "1156960",
    "end": "1162600"
  },
  {
    "text": "they haven't told me what time the issue started but at this point I'm like it looks like it's still ongoing so I'm",
    "start": "1162600",
    "end": "1168760"
  },
  {
    "text": "might as well check as Roman mentioned we have uh read only access to uh",
    "start": "1168760",
    "end": "1175640"
  },
  {
    "text": "customer classes so we can run um Cube cattle commands we can view their logs",
    "start": "1175640",
    "end": "1182360"
  },
  {
    "text": "and we can also check uh just the configurations in the UI so um that's",
    "start": "1182360",
    "end": "1188039"
  },
  {
    "text": "what we're going to do now okay sorry I need to log in",
    "start": "1188039",
    "end": "1196200"
  },
  {
    "text": "again",
    "start": "1197640",
    "end": "1200640"
  },
  {
    "text": "okay okay so we're just going to check and see how many pods are still in the",
    "start": "1202720",
    "end": "1209000"
  },
  {
    "text": "pending State okay so they have a number of PS",
    "start": "1209000",
    "end": "1216960"
  },
  {
    "text": "that are in the pending state which means the issue is still ongoing and I'm just going to pick uh one of the Pods at",
    "start": "1216960",
    "end": "1223280"
  },
  {
    "text": "this point and describe it and see if there's anything interesting at all in the events",
    "start": "1223280",
    "end": "1230640"
  },
  {
    "text": "okay so if we look at the events here from the top we can see a fail scale up",
    "start": "1232760",
    "end": "1240039"
  },
  {
    "text": "um so we can see that there was an attempt to scale up uh looking at the trigger for scale up and uh at the",
    "start": "1240039",
    "end": "1246960"
  },
  {
    "text": "bottom you can see fail scheduling messages just like the one um that was shared on the case so part of the F of",
    "start": "1246960",
    "end": "1253799"
  },
  {
    "text": "support is uh when you get a case you really have no idea where it's going to go you you have no idea um what's",
    "start": "1253799",
    "end": "1260360"
  },
  {
    "text": "relevant to look at what you need to ignore and you're just trying to follow and think what's logical what should I",
    "start": "1260360",
    "end": "1267559"
  },
  {
    "text": "check next so at this point I can see scale up is being triggered but I'm not",
    "start": "1267559",
    "end": "1272960"
  },
  {
    "text": "I'm not really sure whether I really want to dig into autoscaling logs so I think okay let me check if there's even",
    "start": "1272960",
    "end": "1279039"
  },
  {
    "text": "any attempts that are being made to uh create new nodes so um all creation",
    "start": "1279039",
    "end": "1286080"
  },
  {
    "text": "requests for objects they go to API Ser logs and on GK you can enable uh some",
    "start": "1286080",
    "end": "1292080"
  },
  {
    "text": "control plane logging so you can view API Ser logs but as Roman said we don't know everything so I want to know what",
    "start": "1292080",
    "end": "1300039"
  },
  {
    "text": "does a create request for a node uh look like so here I can see the verb and I",
    "start": "1300039",
    "end": "1306240"
  },
  {
    "text": "can see it's uh post and it's for/ API slv1 nodes so I say okay um let me",
    "start": "1306240",
    "end": "1314919"
  },
  {
    "text": "create a query and look at just I can use this two string to search the logs and see what I find there and I really",
    "start": "1314919",
    "end": "1321919"
  },
  {
    "text": "don't know at this point what it is I'm looking for I'm just trying to build a picture and see what happens next so",
    "start": "1321919",
    "end": "1330960"
  },
  {
    "text": "because the issue is still ongoing and the customer didn't provide me any idea of the time I'll just search over the",
    "start": "1330960",
    "end": "1337640"
  },
  {
    "text": "first one hour if needed I can always look back a little further so let's run",
    "start": "1337640",
    "end": "1343240"
  },
  {
    "text": "the query okay so there's lots of logs I'll",
    "start": "1343240",
    "end": "1350679"
  },
  {
    "text": "just expand one of them and have a look and I can see here already that there's",
    "start": "1350679",
    "end": "1356640"
  },
  {
    "text": "a stack Trace um yeah so I'll just go through the",
    "start": "1356640",
    "end": "1362679"
  },
  {
    "text": "stack Trace all the way to the end and see if there's anything [Music]",
    "start": "1362679",
    "end": "1370579"
  },
  {
    "text": "useful okay so I can see it ends in an error and it says something about uh",
    "start": "1373520",
    "end": "1378559"
  },
  {
    "text": "failed calling a web Hook and the web Hook is check ignore label gatekeeper Dosh okay now maybe I'm finding",
    "start": "1378559",
    "end": "1386080"
  },
  {
    "text": "something so I'm sure a lot of you know about uh gatekeeper either you're using it or you've heard about it before and",
    "start": "1386080",
    "end": "1392320"
  },
  {
    "text": "then I read a bit more um in the error message and I see it says it failed to call the web hook um I see a post",
    "start": "1392320",
    "end": "1399720"
  },
  {
    "text": "request to the web hook I see a time out of 3 seconds okay that will be important later and then I see a context deadline",
    "start": "1399720",
    "end": "1407120"
  },
  {
    "text": "exceeded message so context deadline exceeded context ccel message I'm sure",
    "start": "1407120",
    "end": "1412440"
  },
  {
    "text": "you've seen them many times in kubernetes they don't really tell you much um so just from experience and some",
    "start": "1412440",
    "end": "1420200"
  },
  {
    "text": "Googling um I figured out that the era is is just a generic era in go and",
    "start": "1420200",
    "end": "1426080"
  },
  {
    "text": "basically what it means is that a request was made and it timed out it",
    "start": "1426080",
    "end": "1431720"
  },
  {
    "text": "didn't complete in the timeout that was set okay let's see what else we can find in the API server logs the there's also",
    "start": "1431720",
    "end": "1438960"
  },
  {
    "text": "this Trace log um which I'm not so familiar with so as I said we really",
    "start": "1438960",
    "end": "1445120"
  },
  {
    "text": "don't know what we'll find so I'll just expand it and have a look okay so it",
    "start": "1445120",
    "end": "1450600"
  },
  {
    "text": "seems to be sort of a a breakdown for the latency of the request to create a",
    "start": "1450600",
    "end": "1455799"
  },
  {
    "text": "node um and over here I can see all the requests some requests to web Hooks and",
    "start": "1455799",
    "end": "1463960"
  },
  {
    "text": "again at the bottom I see the internal error and I see again the web hook message um the web hook mentioned check",
    "start": "1463960",
    "end": "1471360"
  },
  {
    "text": "ignore label geke keeper Dosh okay so it looks like uh the",
    "start": "1471360",
    "end": "1477600"
  },
  {
    "text": "webbook could be involved somehow so um it makes sense for me to check for just",
    "start": "1477600",
    "end": "1483520"
  },
  {
    "text": "what's happening with the web hook in the API server logs and that's what I do as I said I'm just following the",
    "start": "1483520",
    "end": "1489480"
  },
  {
    "text": "breadcrumbs that I'm finding and trying to find um what makes the most sense to look at",
    "start": "1489480",
    "end": "1496159"
  },
  {
    "text": "next so again here was just search for the string web hook and then search for",
    "start": "1496159",
    "end": "1501480"
  },
  {
    "text": "the past one",
    "start": "1501480",
    "end": "1504240"
  },
  {
    "text": "hour okay so we can see lots of yellow and red and yellow is basically a",
    "start": "1507039",
    "end": "1514520"
  },
  {
    "text": "warning message and red is a is an error message so um we're looking for just to",
    "start": "1514520",
    "end": "1523120"
  },
  {
    "text": "see if there's anything else we can see that's useful we can see there's still more Trace uh logs returned here and if",
    "start": "1523120",
    "end": "1532080"
  },
  {
    "text": "we look at the check ignore label. gatekeeper specifically we see again The",
    "start": "1532080",
    "end": "1537919"
  },
  {
    "text": "Helpful context deadline exceeded message so nothing so exciting there",
    "start": "1537919",
    "end": "1545080"
  },
  {
    "text": "okay so at this point back to the case at this point the customer uh increases",
    "start": "1545080",
    "end": "1551240"
  },
  {
    "text": "the priority of the case they need this running in production right now so it's now a P1 for them and I just offered to",
    "start": "1551240",
    "end": "1559559"
  },
  {
    "text": "Hope on a call with them so on the call I explained what it is I found so far so",
    "start": "1559559",
    "end": "1565399"
  },
  {
    "text": "at this point I don't have um a complete picture of why it is that the web Hook",
    "start": "1565399",
    "end": "1572120"
  },
  {
    "text": "is affecting the creation of the of the nodes but I have a pretty good idea that that's where the problem is so in",
    "start": "1572120",
    "end": "1579000"
  },
  {
    "text": "support we often are prioritizing U mitigation over understanding the root cause and I just advis the customer why",
    "start": "1579000",
    "end": "1586159"
  },
  {
    "text": "don't you back up this web hook uh you can always restore it from the backup and then uh just go ahead and delete it",
    "start": "1586159",
    "end": "1593000"
  },
  {
    "text": "for now so let's pretend I'm the customer for now and we will delete the",
    "start": "1593000",
    "end": "1599399"
  },
  {
    "text": "web",
    "start": "1599399",
    "end": "1601760"
  },
  {
    "text": "hook and then we'll check to see if more pods will come into the",
    "start": "1606960",
    "end": "1614039"
  },
  {
    "text": "running State now that the web Hook is deleted",
    "start": "1614039",
    "end": "1620240"
  },
  {
    "text": "okay it seems it's going to take a while but yeah so um web hooks are they they a",
    "start": "1626440",
    "end": "1632240"
  },
  {
    "text": "classic example of third party tools that you can install in your cluster that can have very uh many different",
    "start": "1632240",
    "end": "1639919"
  },
  {
    "text": "effects they can really affect the stability of your cluster and they can manifest in many different ways okay now",
    "start": "1639919",
    "end": "1646559"
  },
  {
    "text": "we can see that once we deleted the web hook the pods are now running so with uh",
    "start": "1646559",
    "end": "1655000"
  },
  {
    "text": "web hooks the thing we really encourage is just to have a good idea of what the",
    "start": "1655000",
    "end": "1660600"
  },
  {
    "text": "failure looks like what um name spaces your covering what objects are affected",
    "start": "1660600",
    "end": "1666519"
  },
  {
    "text": "by the web hook and in general for third party tools there's very many operators",
    "start": "1666519",
    "end": "1671840"
  },
  {
    "text": "that you can install now in kubernetes very many demon sets that you can run um like system security demon set and we",
    "start": "1671840",
    "end": "1679640"
  },
  {
    "text": "encourage you just to understand what is the uh demon set doing um what does it",
    "start": "1679640",
    "end": "1686200"
  },
  {
    "text": "look like when it fails and will it have significant impact on my CL on your",
    "start": "1686200",
    "end": "1691960"
  },
  {
    "text": "claster and on the stability um so I still haven't found",
    "start": "1691960",
    "end": "1698640"
  },
  {
    "text": "the root cause of the issue so uh we'll just look into that and we'll take a look at the web hook that I also made a",
    "start": "1698640",
    "end": "1706120"
  },
  {
    "text": "backup of before the customer deleted it and there's two sections uh but we're",
    "start": "1706120",
    "end": "1714960"
  },
  {
    "text": "interested in this section with the name check ignore label. gatekeeper Dosh and",
    "start": "1714960",
    "end": "1721000"
  },
  {
    "text": "we can also confirm here it has a timeout of 3 seconds which we saw in the logs and we see here a failure policy of",
    "start": "1721000",
    "end": "1727200"
  },
  {
    "text": "fail and again back to documentation we're curious to understand what is a failure policy of fail mean so looking",
    "start": "1727200",
    "end": "1736120"
  },
  {
    "text": "up the documentation again a failure policy of fail means that there was an error calling the web hook and when this",
    "start": "1736120",
    "end": "1743880"
  },
  {
    "text": "happens it causes the request to be rejected so if you have ignore the request is allowed to continue but if",
    "start": "1743880",
    "end": "1751039"
  },
  {
    "text": "you have a failure policy uh set to rejected then the request will fail so",
    "start": "1751039",
    "end": "1758120"
  },
  {
    "text": "in the case that you don't need to strictly enforce um a policy or or use a",
    "start": "1758120",
    "end": "1763480"
  },
  {
    "text": "web hook it's better to set it to ignore and then together with this the customer",
    "start": "1763480",
    "end": "1769279"
  },
  {
    "text": "also came back and they explained that the backend pods for the gatekeeper web hook were overloaded at the time of the",
    "start": "1769279",
    "end": "1775799"
  },
  {
    "text": "issue and that's why the requests were like the response was not being returned",
    "start": "1775799",
    "end": "1781760"
  },
  {
    "text": "within the timeout so it's sort of an example of our collaboration between us and the customer so now we'll switch",
    "start": "1781760",
    "end": "1788799"
  },
  {
    "text": "gears a bit and we'll go back to the presentation and we just have a few um",
    "start": "1788799",
    "end": "1795440"
  },
  {
    "text": "just tips on troubleshooting that we collected just working on many different kind of kinds of cases so although the",
    "start": "1795440",
    "end": "1804080"
  },
  {
    "text": "cases we showed were not the best example of this we really encourage you to have a well defined problem get all",
    "start": "1804080",
    "end": "1810640"
  },
  {
    "text": "the details this is the whatever workload name is involved um what time",
    "start": "1810640",
    "end": "1816279"
  },
  {
    "text": "the issue started any relevant log messages if you have architecture diagrams that show different uh pieces",
    "start": "1816279",
    "end": "1823720"
  },
  {
    "text": "and how they are connected that's even better get an idea of if anything has change were there any new deployments",
    "start": "1823720",
    "end": "1830480"
  },
  {
    "text": "when did they happen just have a record of this as it really helps and then the next thing is using the whatever error",
    "start": "1830480",
    "end": "1837720"
  },
  {
    "text": "messages or log messages you've got or just the behavior you're seeing trying to understand is this a real problem or",
    "start": "1837720",
    "end": "1843720"
  },
  {
    "text": "a misunderstood feature so for example with things like um uh cluster",
    "start": "1843720",
    "end": "1848919"
  },
  {
    "text": "autoscaler we often see people complaining or the cluster is not scaling down but if you actually read",
    "start": "1848919",
    "end": "1856639"
  },
  {
    "text": "the documentation some many times it is working as intended so just make the",
    "start": "1856639",
    "end": "1862679"
  },
  {
    "text": "documentation your friend um the next thing is to narrow down the scope of",
    "start": "1862679",
    "end": "1868080"
  },
  {
    "text": "troubleshooting you can't be looking at everything um so you need to try and think especially in kubernetes it helps",
    "start": "1868080",
    "end": "1874799"
  },
  {
    "text": "either in terms of what uh my colleague mentioned features or components so in",
    "start": "1874799",
    "end": "1880440"
  },
  {
    "text": "this case I could either have looked at the scheduling or aut to scaling um but you're basically trying to eliminate",
    "start": "1880440",
    "end": "1887320"
  },
  {
    "text": "what it is that you're focusing on and then once you have a a list of",
    "start": "1887320",
    "end": "1893240"
  },
  {
    "text": "components that you want to focus on create a list of hypothesis and you and you then you can test them and you're",
    "start": "1893240",
    "end": "1899519"
  },
  {
    "text": "trying to go from the most simple hypothesis to the more complex ones you",
    "start": "1899519",
    "end": "1904799"
  },
  {
    "text": "don't want to start with anything that's too hard and then lastly if you are not",
    "start": "1904799",
    "end": "1910120"
  },
  {
    "text": "able if you can see that there's some relationship between the issue that you're seeing and uh just something that",
    "start": "1910120",
    "end": "1917039"
  },
  {
    "text": "you've observed in for example the logs try as much as possible to mitigate the problem and",
    "start": "1917039",
    "end": "1924399"
  },
  {
    "text": "this goes back to the first step for example if you knew this happened just after a new roll out then you could try",
    "start": "1924399",
    "end": "1931159"
  },
  {
    "text": "and roll back whatever change was made and then just collect all before you make the the roll back change for",
    "start": "1931159",
    "end": "1937960"
  },
  {
    "text": "example you can collect all the data you need so that later on you can uh perform",
    "start": "1937960",
    "end": "1943039"
  },
  {
    "text": "your analysis and of course if all else fails and you educate customer please",
    "start": "1943039",
    "end": "1948200"
  },
  {
    "text": "feel free to open a case and if you have all these details it's also really helpful to us and it saves us a lot of",
    "start": "1948200",
    "end": "1954039"
  },
  {
    "text": "time because as I said we're not magicians okay um thank you everyone for",
    "start": "1954039",
    "end": "1959919"
  },
  {
    "text": "your time please scan the QR code to give feedback and if you have any questions we'll be happy to take them",
    "start": "1959919",
    "end": "1966600"
  },
  {
    "text": "thank you",
    "start": "1966600",
    "end": "1970559"
  }
]