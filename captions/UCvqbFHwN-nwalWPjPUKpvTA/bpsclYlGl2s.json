[
  {
    "text": "all right we have 30 minutes only so I",
    "start": "320",
    "end": "2639"
  },
  {
    "text": "want to start the",
    "start": "2639",
    "end": "4120"
  },
  {
    "text": "presentation one more time welcome",
    "start": "4120",
    "end": "6240"
  },
  {
    "text": "everyone uh to presentation so uh title",
    "start": "6240",
    "end": "9200"
  },
  {
    "text": "is mastering efficiency in Argo CD and",
    "start": "9200",
    "end": "12559"
  },
  {
    "text": "uh we will be talking about how to what",
    "start": "12559",
    "end": "15519"
  },
  {
    "text": "does it take to scale Argo CD and how",
    "start": "15519",
    "end": "18080"
  },
  {
    "text": "much does it cost and I will share with",
    "start": "18080",
    "end": "20400"
  },
  {
    "text": "you you know tips how to reduce your",
    "start": "20400",
    "end": "23119"
  },
  {
    "text": "cloud bill uh before I start quick",
    "start": "23119",
    "end": "26119"
  },
  {
    "text": "introduction so my name is uh Alexander",
    "start": "26119",
    "end": "28800"
  },
  {
    "text": "Matensv don't try to pronounce my last",
    "start": "28800",
    "end": "31160"
  },
  {
    "text": "name uh so I'm one of the Argo project",
    "start": "31160",
    "end": "35200"
  },
  {
    "text": "co-creators i've been working on this",
    "start": "35200",
    "end": "37680"
  },
  {
    "text": "project for like seven or eight years",
    "start": "37680",
    "end": "39920"
  },
  {
    "text": "and I'm also co-founder of company",
    "start": "39920",
    "end": "42079"
  },
  {
    "text": "called Acuity where we run Argo CD for",
    "start": "42079",
    "end": "46480"
  },
  {
    "text": "other companies and in the last several",
    "start": "46480",
    "end": "49280"
  },
  {
    "text": "years we learned several lessons uh",
    "start": "49280",
    "end": "51640"
  },
  {
    "text": "about uh how much money we have to spend",
    "start": "51640",
    "end": "54239"
  },
  {
    "text": "to run Argo CD at scale and I'm going to",
    "start": "54239",
    "end": "56960"
  },
  {
    "text": "share this learnings with you and",
    "start": "56960",
    "end": "58239"
  },
  {
    "text": "hopefully help you to save some money",
    "start": "58239",
    "end": "60160"
  },
  {
    "text": "for your",
    "start": "60160",
    "end": "61879"
  },
  {
    "text": "organization um here is today's agenda",
    "start": "61879",
    "end": "65360"
  },
  {
    "text": "it's kind of simple first I want to",
    "start": "65360",
    "end": "68320"
  },
  {
    "text": "basically convince you that this topic",
    "start": "68320",
    "end": "71360"
  },
  {
    "text": "was a conversation so we all know that",
    "start": "71360",
    "end": "74320"
  },
  {
    "text": "if you use Argo CD you know it's cheap",
    "start": "74320",
    "end": "76000"
  },
  {
    "text": "and very efficient and until you have to",
    "start": "76000",
    "end": "79600"
  },
  {
    "text": "run it at a really large scale and so uh",
    "start": "79600",
    "end": "83200"
  },
  {
    "text": "it can get expensive at some point and I",
    "start": "83200",
    "end": "85759"
  },
  {
    "text": "want to share with you some numbers of",
    "start": "85759",
    "end": "87759"
  },
  {
    "text": "what expensive really means so you can",
    "start": "87759",
    "end": "90000"
  },
  {
    "text": "decide if it's time for you to invest",
    "start": "90000",
    "end": "92400"
  },
  {
    "text": "you know uh some effort into reducing",
    "start": "92400",
    "end": "94560"
  },
  {
    "text": "the build and optimizing and I'm going",
    "start": "94560",
    "end": "97040"
  },
  {
    "text": "to share with you some lessons we've",
    "start": "97040",
    "end": "99360"
  },
  {
    "text": "learned and solutions that you can apply",
    "start": "99360",
    "end": "101200"
  },
  {
    "text": "to reduce cost of your Argo",
    "start": "101200",
    "end": "103880"
  },
  {
    "text": "CD um",
    "start": "103880",
    "end": "106200"
  },
  {
    "text": "and now it's time to start um so I do",
    "start": "106200",
    "end": "110799"
  },
  {
    "text": "want to start from the statement that",
    "start": "110799",
    "end": "112960"
  },
  {
    "text": "Argo CD is you know it's not going to",
    "start": "112960",
    "end": "116399"
  },
  {
    "text": "cost you a lot from the beginning so one",
    "start": "116399",
    "end": "119200"
  },
  {
    "text": "of the most common ways to run Argo CD",
    "start": "119200",
    "end": "121520"
  },
  {
    "text": "is to install it into the cluster that",
    "start": "121520",
    "end": "124320"
  },
  {
    "text": "you plan to manage and uh this is the",
    "start": "124320",
    "end": "128000"
  },
  {
    "text": "screenshot of freshly installed Argo CD",
    "start": "128000",
    "end": "130080"
  },
  {
    "text": "on a small cluster and as you can see we",
    "start": "130080",
    "end": "133120"
  },
  {
    "text": "have quite a lot of pods but combined",
    "start": "133120",
    "end": "135920"
  },
  {
    "text": "they use a fraction of CPU and maybe 100",
    "start": "135920",
    "end": "138800"
  },
  {
    "text": "megabytes of memory couple of those pods",
    "start": "138800",
    "end": "141520"
  },
  {
    "text": "are even optional such as DEX and",
    "start": "141520",
    "end": "143599"
  },
  {
    "text": "notifications controller you can don't",
    "start": "143599",
    "end": "145440"
  },
  {
    "text": "even run them if you don't need to and",
    "start": "145440",
    "end": "148319"
  },
  {
    "text": "uh there is a diagram that shows how",
    "start": "148319",
    "end": "151200"
  },
  {
    "text": "those components interact and as you can",
    "start": "151200",
    "end": "153280"
  },
  {
    "text": "see there's basically four of them that",
    "start": "153280",
    "end": "155200"
  },
  {
    "text": "you would need to install and pay for",
    "start": "155200",
    "end": "157760"
  },
  {
    "text": "and so uh generally Argo CD won't cost",
    "start": "157760",
    "end": "161519"
  },
  {
    "text": "you anything because highly likely it",
    "start": "161519",
    "end": "163599"
  },
  {
    "text": "will just land on some nodes inside of",
    "start": "163599",
    "end": "166480"
  },
  {
    "text": "your cluster that have spare memory and",
    "start": "166480",
    "end": "168319"
  },
  {
    "text": "CPU and Argo will apply a little bit of",
    "start": "168319",
    "end": "171040"
  },
  {
    "text": "pressure on Kubernetes API server of",
    "start": "171040",
    "end": "174400"
  },
  {
    "text": "your cluster but it's really hard to",
    "start": "174400",
    "end": "176720"
  },
  {
    "text": "translate it to money so basically it's",
    "start": "176720",
    "end": "178560"
  },
  {
    "text": "kind of free uh and so it's free until",
    "start": "178560",
    "end": "182159"
  },
  {
    "text": "you decide to you know uh use Argo CD",
    "start": "182159",
    "end": "186640"
  },
  {
    "text": "more and use one of the most appealing",
    "start": "186640",
    "end": "189200"
  },
  {
    "text": "features of it uh which is called",
    "start": "189200",
    "end": "191440"
  },
  {
    "text": "multicluster management and so once you",
    "start": "191440",
    "end": "195840"
  },
  {
    "text": "try to manage multiple clusters you",
    "start": "195840",
    "end": "197680"
  },
  {
    "text": "would have to change a bunch of things",
    "start": "197680",
    "end": "201280"
  },
  {
    "text": "um and kind of high level you would need",
    "start": "201280",
    "end": "204000"
  },
  {
    "text": "to create a centralized control plane",
    "start": "204000",
    "end": "208000"
  },
  {
    "text": "which is used usually by multiple uh",
    "start": "208000",
    "end": "211360"
  },
  {
    "text": "engineers in your organization to manage",
    "start": "211360",
    "end": "213120"
  },
  {
    "text": "a lot of infrastructure and there is a",
    "start": "213120",
    "end": "216319"
  },
  {
    "text": "very important uh new requirement here",
    "start": "216319",
    "end": "219519"
  },
  {
    "text": "is that this control plane has to be",
    "start": "219519",
    "end": "222560"
  },
  {
    "text": "highly available and uh it's not very",
    "start": "222560",
    "end": "226080"
  },
  {
    "text": "specific to Argo CD but basically if you",
    "start": "226080",
    "end": "228799"
  },
  {
    "text": "have any application that has to be",
    "start": "228799",
    "end": "230640"
  },
  {
    "text": "available all the time and it has to",
    "start": "230640",
    "end": "232319"
  },
  {
    "text": "survive upgrades without downtime you",
    "start": "232319",
    "end": "235760"
  },
  {
    "text": "would have to start you know run",
    "start": "235760",
    "end": "238560"
  },
  {
    "text": "multiple instances of everything and uh",
    "start": "238560",
    "end": "241680"
  },
  {
    "text": "this is the same diagram that you just",
    "start": "241680",
    "end": "243439"
  },
  {
    "text": "saw in the previous slide in a so-called",
    "start": "243439",
    "end": "246560"
  },
  {
    "text": "HA mode so if you're not aware Argo CD",
    "start": "246560",
    "end": "249680"
  },
  {
    "text": "has um in official repository two",
    "start": "249680",
    "end": "252959"
  },
  {
    "text": "installation manifests and we highly",
    "start": "252959",
    "end": "255439"
  },
  {
    "text": "recommend to use HA version of manifests",
    "start": "255439",
    "end": "258160"
  },
  {
    "text": "if you install Argo CD in production and",
    "start": "258160",
    "end": "261280"
  },
  {
    "text": "uh the result is you would have to run",
    "start": "261280",
    "end": "265199"
  },
  {
    "text": "multiple replicas of pretty much every",
    "start": "265199",
    "end": "267960"
  },
  {
    "text": "component um so there is API server repo",
    "start": "267960",
    "end": "270960"
  },
  {
    "text": "server that serve requests we need",
    "start": "270960",
    "end": "273120"
  },
  {
    "text": "multiple replicas because to have a",
    "start": "273120",
    "end": "275280"
  },
  {
    "text": "rolling update uh we have one stateful",
    "start": "275280",
    "end": "278000"
  },
  {
    "text": "component uh radius and radius turns",
    "start": "278000",
    "end": "281840"
  },
  {
    "text": "from one port into five ports one is",
    "start": "281840",
    "end": "284400"
  },
  {
    "text": "stateful set and a J proxy that balance",
    "start": "284400",
    "end": "287280"
  },
  {
    "text": "requests and you might end up having",
    "start": "287280",
    "end": "289600"
  },
  {
    "text": "multiple controllers if you manage",
    "start": "289600",
    "end": "291280"
  },
  {
    "text": "multiple clusters and this transition",
    "start": "291280",
    "end": "294080"
  },
  {
    "text": "also requires uh infrastructure that",
    "start": "294080",
    "end": "297919"
  },
  {
    "text": "would cost you some money i kind of try",
    "start": "297919",
    "end": "300960"
  },
  {
    "text": "to highlight here you know things that",
    "start": "300960",
    "end": "304080"
  },
  {
    "text": "maybe not as obvious um and will",
    "start": "304080",
    "end": "307759"
  },
  {
    "text": "contribute to your cloud bill um so",
    "start": "307759",
    "end": "311199"
  },
  {
    "text": "obviously we need instances to run Argo",
    "start": "311199",
    "end": "313199"
  },
  {
    "text": "CD components that's you know obvious",
    "start": "313199",
    "end": "316400"
  },
  {
    "text": "what's not obvious is we need at least",
    "start": "316400",
    "end": "318479"
  },
  {
    "text": "three even if you have beefy instances",
    "start": "318479",
    "end": "320479"
  },
  {
    "text": "with a lot of memory CPU we need three",
    "start": "320479",
    "end": "323039"
  },
  {
    "text": "of them to kind of satisfy all all pod",
    "start": "323039",
    "end": "326960"
  },
  {
    "text": "anti- affinity rules and run uh all",
    "start": "326960",
    "end": "330720"
  },
  {
    "text": "components in HA mode uh next not you",
    "start": "330720",
    "end": "335759"
  },
  {
    "text": "know unpleasant surprise that you might",
    "start": "335759",
    "end": "337360"
  },
  {
    "text": "realize a little later uh it's not okay",
    "start": "337360",
    "end": "340360"
  },
  {
    "text": "to reuse one of your workload clusters",
    "start": "340360",
    "end": "343759"
  },
  {
    "text": "to host Argo CD as well you might regret",
    "start": "343759",
    "end": "346400"
  },
  {
    "text": "about it in the future and the reason is",
    "start": "346400",
    "end": "349240"
  },
  {
    "text": "sometimes other workloads on a cluster",
    "start": "349240",
    "end": "352000"
  },
  {
    "text": "overload API server and it affects Argo",
    "start": "352000",
    "end": "354960"
  },
  {
    "text": "CD and other way around so it's highly",
    "start": "354960",
    "end": "357199"
  },
  {
    "text": "recommended to have dedicated control",
    "start": "357199",
    "end": "360320"
  },
  {
    "text": "plane cluster and it kind of the bill",
    "start": "360320",
    "end": "363520"
  },
  {
    "text": "starts from several hundred dollars a",
    "start": "363520",
    "end": "365680"
  },
  {
    "text": "month just for HA uh API server usually",
    "start": "365680",
    "end": "370000"
  },
  {
    "text": "managed by your cloud provider plus",
    "start": "370000",
    "end": "372560"
  },
  {
    "text": "those three nodes that you need to have",
    "start": "372560",
    "end": "374240"
  },
  {
    "text": "for Argo CD workloads and so last but",
    "start": "374240",
    "end": "378319"
  },
  {
    "text": "not least um you are going to have to",
    "start": "378319",
    "end": "380720"
  },
  {
    "text": "pay for traffic and it's kind of not",
    "start": "380720",
    "end": "384000"
  },
  {
    "text": "obvious because if you use AWS those",
    "start": "384000",
    "end": "386960"
  },
  {
    "text": "costs will be hidden under this shy EC2",
    "start": "386960",
    "end": "390720"
  },
  {
    "text": "other section and but it surprisingly",
    "start": "390720",
    "end": "394479"
  },
  {
    "text": "big like in in multiple cases this",
    "start": "394479",
    "end": "397840"
  },
  {
    "text": "network cost is around 30% of the bill",
    "start": "397840",
    "end": "400960"
  },
  {
    "text": "so it is significant and as I will share",
    "start": "400960",
    "end": "404160"
  },
  {
    "text": "a little later sometimes it actually can",
    "start": "404160",
    "end": "407280"
  },
  {
    "text": "spike and there is but there is way to",
    "start": "407280",
    "end": "409280"
  },
  {
    "text": "mitigate the close cost close",
    "start": "409280",
    "end": "412520"
  },
  {
    "text": "spike um so next I promise to share some",
    "start": "412520",
    "end": "416800"
  },
  {
    "text": "numbers and this is mostly for you to",
    "start": "416800",
    "end": "419280"
  },
  {
    "text": "decide you know at which point it makes",
    "start": "419280",
    "end": "421759"
  },
  {
    "text": "sense to start looking at at the cost uh",
    "start": "421759",
    "end": "424800"
  },
  {
    "text": "and so before basically we uh didn't",
    "start": "424800",
    "end": "428160"
  },
  {
    "text": "want to guess and we just run an",
    "start": "428160",
    "end": "429680"
  },
  {
    "text": "experiment to get some real numbers that",
    "start": "429680",
    "end": "431680"
  },
  {
    "text": "we can then play with and so this is",
    "start": "431680",
    "end": "434720"
  },
  {
    "text": "description of what we did uh we used",
    "start": "434720",
    "end": "437599"
  },
  {
    "text": "created a GCP cluster uh that we used as",
    "start": "437599",
    "end": "440880"
  },
  {
    "text": "a control plane had it had three nodes",
    "start": "440880",
    "end": "443360"
  },
  {
    "text": "and we just chose this node size to make",
    "start": "443360",
    "end": "445759"
  },
  {
    "text": "sure it fit a pretty big Argo CD",
    "start": "445759",
    "end": "449120"
  },
  {
    "text": "instance that managed a lot of clusters",
    "start": "449120",
    "end": "450720"
  },
  {
    "text": "and applications uh next we installed",
    "start": "450720",
    "end": "453360"
  },
  {
    "text": "Argo CD on it and deployed 800",
    "start": "453360",
    "end": "457160"
  },
  {
    "text": "applications across three managed",
    "start": "457160",
    "end": "459280"
  },
  {
    "text": "clusters and we did not count cost of",
    "start": "459280",
    "end": "461840"
  },
  {
    "text": "those managed clusters because those",
    "start": "461840",
    "end": "464479"
  },
  {
    "text": "represent your workload clusters and uh",
    "start": "464479",
    "end": "468160"
  },
  {
    "text": "this is the result this slide is mostly",
    "start": "468160",
    "end": "470800"
  },
  {
    "text": "to you know prove that uh we did run it",
    "start": "470800",
    "end": "473440"
  },
  {
    "text": "we kept it for like almost a week and",
    "start": "473440",
    "end": "476759"
  },
  {
    "text": "uh later on we kind of took the most",
    "start": "476759",
    "end": "479440"
  },
  {
    "text": "important numbers and we've got this um",
    "start": "479440",
    "end": "483080"
  },
  {
    "text": "so a long story short the combined cost",
    "start": "483080",
    "end": "487280"
  },
  {
    "text": "of that uh whole setup was around $40 a",
    "start": "487280",
    "end": "491680"
  },
  {
    "text": "day and so if you multiply it by number",
    "start": "491680",
    "end": "494319"
  },
  {
    "text": "of days you will see that if we kept it",
    "start": "494319",
    "end": "496639"
  },
  {
    "text": "running for a year we would have to pay",
    "start": "496639",
    "end": "499599"
  },
  {
    "text": "around",
    "start": "499599",
    "end": "501240"
  },
  {
    "text": "$11,000 and 30% of that cost was uh",
    "start": "501240",
    "end": "505039"
  },
  {
    "text": "network traffic i think one important",
    "start": "505039",
    "end": "507919"
  },
  {
    "text": "detail the traffic most of the traffic",
    "start": "507919",
    "end": "510240"
  },
  {
    "text": "we had to pay for was u over internet",
    "start": "510240",
    "end": "513839"
  },
  {
    "text": "and significant part of it was u cross",
    "start": "513839",
    "end": "517360"
  },
  {
    "text": "avail um cross availability zone traffic",
    "start": "517360",
    "end": "520000"
  },
  {
    "text": "and so our workload clusters were",
    "start": "520000",
    "end": "522240"
  },
  {
    "text": "available to control plane over internet",
    "start": "522240",
    "end": "524959"
  },
  {
    "text": "so you might make it cheaper if you use",
    "start": "524959",
    "end": "527680"
  },
  {
    "text": "I don't know same VPC to connect all of",
    "start": "527680",
    "end": "529519"
  },
  {
    "text": "your clusters",
    "start": "529519",
    "end": "532160"
  },
  {
    "text": "uh and then one way to extrapolate the",
    "start": "532160",
    "end": "535120"
  },
  {
    "text": "results I I do realize it's very kind of",
    "start": "535120",
    "end": "538240"
  },
  {
    "text": "naive way to you know to try to measure",
    "start": "538240",
    "end": "541600"
  },
  {
    "text": "how much it would cost you if you have a",
    "start": "541600",
    "end": "543600"
  },
  {
    "text": "bigger setup but that's basically it",
    "start": "543600",
    "end": "547519"
  },
  {
    "text": "tracks very precisely with what we've",
    "start": "547519",
    "end": "549680"
  },
  {
    "text": "seen from our experience so uh you can",
    "start": "549680",
    "end": "553680"
  },
  {
    "text": "basically using this simple math you can",
    "start": "553680",
    "end": "556160"
  },
  {
    "text": "calculate that in our experiment at",
    "start": "556160",
    "end": "560080"
  },
  {
    "text": "least one Argo CG application cost us",
    "start": "560080",
    "end": "563440"
  },
  {
    "text": "$1.49",
    "start": "563440",
    "end": "565480"
  },
  {
    "text": "$49 and so this table is I don't mean to",
    "start": "565480",
    "end": "569680"
  },
  {
    "text": "scare you but it kind of shows you the",
    "start": "569680",
    "end": "571600"
  },
  {
    "text": "level of a problem if you're trying to",
    "start": "571600",
    "end": "573519"
  },
  {
    "text": "manage 3,000 applications you might have",
    "start": "573519",
    "end": "575600"
  },
  {
    "text": "to spend 50K a year on a control plane",
    "start": "575600",
    "end": "578959"
  },
  {
    "text": "and for 6,000 I didn't even want to put",
    "start": "578959",
    "end": "581680"
  },
  {
    "text": "this scary six-digit number uh yeah but",
    "start": "581680",
    "end": "585600"
  },
  {
    "text": "my main goal here is to convince you",
    "start": "585600",
    "end": "587720"
  },
  {
    "text": "that at large scale when you manage",
    "start": "587720",
    "end": "590880"
  },
  {
    "text": "6,000 applications that usually",
    "start": "590880",
    "end": "592640"
  },
  {
    "text": "translates to like close to 100 clusters",
    "start": "592640",
    "end": "596000"
  },
  {
    "text": "then control plane became quite costly",
    "start": "596000",
    "end": "598160"
  },
  {
    "text": "it's like comparable to a salary of",
    "start": "598160",
    "end": "599880"
  },
  {
    "text": "engineer and it does make sense to start",
    "start": "599880",
    "end": "602480"
  },
  {
    "text": "worrying about reducing the",
    "start": "602480",
    "end": "604760"
  },
  {
    "text": "cost and yeah so now I want to go to the",
    "start": "604760",
    "end": "609200"
  },
  {
    "text": "meat of the presentation and share with",
    "start": "609200",
    "end": "611680"
  },
  {
    "text": "you you know what we learned you know",
    "start": "611680",
    "end": "614880"
  },
  {
    "text": "from running Argo CD for many years for",
    "start": "614880",
    "end": "616959"
  },
  {
    "text": "various companies and a lot of those",
    "start": "616959",
    "end": "619680"
  },
  {
    "text": "learnings uh we kind of translated back",
    "start": "619680",
    "end": "622000"
  },
  {
    "text": "to contributions back to open source so",
    "start": "622000",
    "end": "624640"
  },
  {
    "text": "Argo CD the latest version is usually",
    "start": "624640",
    "end": "627399"
  },
  {
    "text": "has optimizations built in and it it's",
    "start": "627399",
    "end": "630320"
  },
  {
    "text": "cheaper to run it but some of those",
    "start": "630320",
    "end": "632640"
  },
  {
    "text": "changes are not enabled by default and",
    "start": "632640",
    "end": "636560"
  },
  {
    "text": "or requires additional configuration for",
    "start": "636560",
    "end": "639120"
  },
  {
    "text": "like various reasons for backward",
    "start": "639120",
    "end": "640560"
  },
  {
    "text": "compatibility reasons and so I'm",
    "start": "640560",
    "end": "642160"
  },
  {
    "text": "focusing on these type of changes here",
    "start": "642160",
    "end": "644880"
  },
  {
    "text": "and it covers networking compute cost",
    "start": "644880",
    "end": "647760"
  },
  {
    "text": "and basically a suggestion for you how",
    "start": "647760",
    "end": "649680"
  },
  {
    "text": "to reduce the cost on the dedicated",
    "start": "649680",
    "end": "651760"
  },
  {
    "text": "Kubernetes control plane server",
    "start": "651760",
    "end": "655519"
  },
  {
    "text": "and okay so I want to start from the",
    "start": "655519",
    "end": "658320"
  },
  {
    "text": "first",
    "start": "658320",
    "end": "660160"
  },
  {
    "text": "um lesson we've learned the hard way it",
    "start": "660160",
    "end": "662800"
  },
  {
    "text": "has a short story behind it so we um at",
    "start": "662800",
    "end": "667680"
  },
  {
    "text": "our company we run Argo CD for customers",
    "start": "667680",
    "end": "670320"
  },
  {
    "text": "and so one of the customers suddenly",
    "start": "670320",
    "end": "672480"
  },
  {
    "text": "start costing us a lot of money and we",
    "start": "672480",
    "end": "675360"
  },
  {
    "text": "had to do some investigation to figure",
    "start": "675360",
    "end": "677519"
  },
  {
    "text": "out what's happening and what we learned",
    "start": "677519",
    "end": "680000"
  },
  {
    "text": "is that we observed uh video streaming",
    "start": "680000",
    "end": "683920"
  },
  {
    "text": "like traffic between application",
    "start": "683920",
    "end": "685880"
  },
  {
    "text": "controller and the control plane cluster",
    "start": "685880",
    "end": "689440"
  },
  {
    "text": "and the I wanted to kind of highlight",
    "start": "689440",
    "end": "693120"
  },
  {
    "text": "that um it had nothing to do with how",
    "start": "693120",
    "end": "696320"
  },
  {
    "text": "Argo CD is implemented it uses very",
    "start": "696320",
    "end": "698880"
  },
  {
    "text": "traditional approach of you know how all",
    "start": "698880",
    "end": "702240"
  },
  {
    "text": "controllers in Kubernetes are",
    "start": "702240",
    "end": "703600"
  },
  {
    "text": "implemented so controller periodically",
    "start": "703600",
    "end": "706880"
  },
  {
    "text": "update um CRDs that it manages in this",
    "start": "706880",
    "end": "710480"
  },
  {
    "text": "case application CRDs in particular Argo",
    "start": "710480",
    "end": "714000"
  },
  {
    "text": "CD it send a tiny patch to every",
    "start": "714000",
    "end": "717040"
  },
  {
    "text": "application uh and patch usually",
    "start": "717040",
    "end": "719519"
  },
  {
    "text": "contains bytes it's like it changes the",
    "start": "719519",
    "end": "723200"
  },
  {
    "text": "last reconation timestamp on an",
    "start": "723200",
    "end": "726000"
  },
  {
    "text": "application so it's literally bytes uh",
    "start": "726000",
    "end": "729680"
  },
  {
    "text": "and also controller watches all the",
    "start": "729680",
    "end": "733240"
  },
  {
    "text": "application and that where this is where",
    "start": "733240",
    "end": "735839"
  },
  {
    "text": "the problem uh appeared so we learned",
    "start": "735839",
    "end": "739120"
  },
  {
    "text": "that for some reason our customers had",
    "start": "739120",
    "end": "742079"
  },
  {
    "text": "gigantic application CRDs",
    "start": "742079",
    "end": "745040"
  },
  {
    "text": "uh basically they were close to one",
    "start": "745040",
    "end": "746880"
  },
  {
    "text": "megabyte which is a limit of",
    "start": "746880",
    "end": "749720"
  },
  {
    "text": "Kubernetes and we had to understand the",
    "start": "749720",
    "end": "753279"
  },
  {
    "text": "use case why they were doing it and we",
    "start": "753279",
    "end": "755279"
  },
  {
    "text": "had to look for solution and so oh I",
    "start": "755279",
    "end": "758240"
  },
  {
    "text": "didn't explain why exactly 1 GB is a",
    "start": "758240",
    "end": "760880"
  },
  {
    "text": "problem so basically Kubernetes API",
    "start": "760880",
    "end": "763920"
  },
  {
    "text": "server every time when it receive a",
    "start": "763920",
    "end": "765920"
  },
  {
    "text": "patch request it replies with the whole",
    "start": "765920",
    "end": "768800"
  },
  {
    "text": "resource",
    "start": "768800",
    "end": "770279"
  },
  {
    "text": "uh JSON so in case of Argo CD We have",
    "start": "770279",
    "end": "775120"
  },
  {
    "text": "one watch and one patch request and so",
    "start": "775120",
    "end": "777760"
  },
  {
    "text": "every such request produces 2 megabytes",
    "start": "777760",
    "end": "780399"
  },
  {
    "text": "of traffic and with several thousands of",
    "start": "780399",
    "end": "782959"
  },
  {
    "text": "applications we did get to a level of",
    "start": "782959",
    "end": "785600"
  },
  {
    "text": "video streaming gigabytes uh per minute",
    "start": "785600",
    "end": "788959"
  },
  {
    "text": "and each gigabyte cost us a cent and so",
    "start": "788959",
    "end": "792079"
  },
  {
    "text": "we were paying several hundreds of",
    "start": "792079",
    "end": "793839"
  },
  {
    "text": "dollars per day for one customer so it",
    "start": "793839",
    "end": "795760"
  },
  {
    "text": "was kind of a loss for us um and so we",
    "start": "795760",
    "end": "799279"
  },
  {
    "text": "learned from our customers that they",
    "start": "799279",
    "end": "801519"
  },
  {
    "text": "just wanted to deploy Helm charts and",
    "start": "801519",
    "end": "805440"
  },
  {
    "text": "Helm charts were sitting in a OCI",
    "start": "805440",
    "end": "808120"
  },
  {
    "text": "register so for them it was very easy to",
    "start": "808120",
    "end": "811519"
  },
  {
    "text": "simply inline Helm values into the",
    "start": "811519",
    "end": "814639"
  },
  {
    "text": "application spec which is supported by",
    "start": "814639",
    "end": "816720"
  },
  {
    "text": "Argo CD and they had a lot of values",
    "start": "816720",
    "end": "819680"
  },
  {
    "text": "that they had to supply so it was",
    "start": "819680",
    "end": "821680"
  },
  {
    "text": "literally u several kilobytes hundreds",
    "start": "821680",
    "end": "825760"
  },
  {
    "text": "of kilobytes of value files and uh Argo",
    "start": "825760",
    "end": "829279"
  },
  {
    "text": "CD has a nice feature uh roll back and",
    "start": "829279",
    "end": "832399"
  },
  {
    "text": "so to facilitate roll back every time",
    "start": "832399",
    "end": "834399"
  },
  {
    "text": "when you sync Argo CD store a copy of",
    "start": "834399",
    "end": "837440"
  },
  {
    "text": "value files used for a sync in a history",
    "start": "837440",
    "end": "840079"
  },
  {
    "text": "so we ended up having",
    "start": "840079",
    "end": "841720"
  },
  {
    "text": "application resources with several",
    "start": "841720",
    "end": "844720"
  },
  {
    "text": "kilobytes of value files uh stored 10",
    "start": "844720",
    "end": "847760"
  },
  {
    "text": "times in the same C and yeah so that was",
    "start": "847760",
    "end": "851440"
  },
  {
    "text": "a problem and we had to to mitigate kind",
    "start": "851440",
    "end": "854399"
  },
  {
    "text": "of the problem we had to make a small",
    "start": "854399",
    "end": "856880"
  },
  {
    "text": "change in application spec so there is a",
    "start": "856880",
    "end": "859920"
  },
  {
    "text": "feature of Argo CD that let you control",
    "start": "859920",
    "end": "862079"
  },
  {
    "text": "how many versions you want to store in",
    "start": "862079",
    "end": "864480"
  },
  {
    "text": "history for each application so we had",
    "start": "864480",
    "end": "867199"
  },
  {
    "text": "to reduce it to two and our customer",
    "start": "867199",
    "end": "870079"
  },
  {
    "text": "luckily didn't mind because they use",
    "start": "870079",
    "end": "872079"
  },
  {
    "text": "githops for rbacks and uh next we",
    "start": "872079",
    "end": "875120"
  },
  {
    "text": "started working with them to convince",
    "start": "875120",
    "end": "877199"
  },
  {
    "text": "them to move those inlined values into a",
    "start": "877199",
    "end": "881839"
  },
  {
    "text": "separate value mml file stored in the g",
    "start": "881839",
    "end": "884360"
  },
  {
    "text": "repository uh and another feature of",
    "start": "884360",
    "end": "887120"
  },
  {
    "text": "Argo CD called multiple sources kind of",
    "start": "887120",
    "end": "889839"
  },
  {
    "text": "facilitate this transition and basically",
    "start": "889839",
    "end": "893199"
  },
  {
    "text": "this is a a suggestion for you to watch",
    "start": "893199",
    "end": "896880"
  },
  {
    "text": "and monitor the size of",
    "start": "896880",
    "end": "899320"
  },
  {
    "text": "application resources in your control",
    "start": "899320",
    "end": "901519"
  },
  {
    "text": "plane cluster and so if you see that",
    "start": "901519",
    "end": "903920"
  },
  {
    "text": "it's close to a megabyte highly likely",
    "start": "903920",
    "end": "906079"
  },
  {
    "text": "you're already paying a lot of money for",
    "start": "906079",
    "end": "909120"
  },
  {
    "text": "uh cross availability zone traffic",
    "start": "909120",
    "end": "910880"
  },
  {
    "text": "within a cluster",
    "start": "910880",
    "end": "913519"
  },
  {
    "text": "um and then next we kind of we were not",
    "start": "913519",
    "end": "916720"
  },
  {
    "text": "really happy because we had to work with",
    "start": "916720",
    "end": "918560"
  },
  {
    "text": "the end user and convince them to use",
    "start": "918560",
    "end": "920560"
  },
  {
    "text": "application in a slightly different way",
    "start": "920560",
    "end": "923360"
  },
  {
    "text": "we started to look for a more kind of",
    "start": "923360",
    "end": "925600"
  },
  {
    "text": "permanent solution and we found that",
    "start": "925600",
    "end": "927839"
  },
  {
    "text": "there is a way to uh dramatically reduce",
    "start": "927839",
    "end": "931440"
  },
  {
    "text": "number of times Kubernetes uh",
    "start": "931440",
    "end": "933040"
  },
  {
    "text": "application controller patches",
    "start": "933040",
    "end": "934560"
  },
  {
    "text": "application CRD and so um to be very",
    "start": "934560",
    "end": "938320"
  },
  {
    "text": "short we introduced a setting",
    "start": "938320",
    "end": "940959"
  },
  {
    "text": "uh which you can see here I'm not sure",
    "start": "940959",
    "end": "943360"
  },
  {
    "text": "if you can see my mouse setting is",
    "start": "943360",
    "end": "945279"
  },
  {
    "text": "called controller resource health",
    "start": "945279",
    "end": "946880"
  },
  {
    "text": "persist it's in argo CD cmd param cm",
    "start": "946880",
    "end": "950639"
  },
  {
    "text": "config map and what it does it uh in",
    "start": "950639",
    "end": "954880"
  },
  {
    "text": "configure controller to stop storing",
    "start": "954880",
    "end": "957839"
  },
  {
    "text": "health related metadata in a kubernetes",
    "start": "957839",
    "end": "961040"
  },
  {
    "text": "uh in application CRD and that metadata",
    "start": "961040",
    "end": "964800"
  },
  {
    "text": "is duplicated in a radius and so unless",
    "start": "964800",
    "end": "967279"
  },
  {
    "text": "you build something very specific around",
    "start": "967279",
    "end": "970079"
  },
  {
    "text": "argo",
    "start": "970079",
    "end": "971320"
  },
  {
    "text": "CD application CRDs without using Argo",
    "start": "971320",
    "end": "975120"
  },
  {
    "text": "CD API server you probably don't even",
    "start": "975120",
    "end": "977440"
  },
  {
    "text": "know this metadata exist and it's very",
    "start": "977440",
    "end": "979600"
  },
  {
    "text": "safe to just change this plug to true",
    "start": "979600",
    "end": "982639"
  },
  {
    "text": "and very likely you will reduce pressure",
    "start": "982639",
    "end": "985040"
  },
  {
    "text": "on your API server and it will really",
    "start": "985040",
    "end": "987199"
  },
  {
    "text": "reduce amount of traffic that uh",
    "start": "987199",
    "end": "989440"
  },
  {
    "text": "controller sends to",
    "start": "989440",
    "end": "991320"
  },
  {
    "text": "Kubernetes uh all right I want to move",
    "start": "991320",
    "end": "994320"
  },
  {
    "text": "to the next suggestion it uh also",
    "start": "994320",
    "end": "997360"
  },
  {
    "text": "related to traffic and also related to",
    "start": "997360",
    "end": "1000240"
  },
  {
    "text": "large applications same story we had a",
    "start": "1000240",
    "end": "1003519"
  },
  {
    "text": "customer who suddenly started sending",
    "start": "1003519",
    "end": "1005920"
  },
  {
    "text": "way more data and we had to investigate",
    "start": "1005920",
    "end": "1010480"
  },
  {
    "text": "you know where is this data coming from",
    "start": "1010480",
    "end": "1012240"
  },
  {
    "text": "and what's the reason and so what",
    "start": "1012240",
    "end": "1014720"
  },
  {
    "text": "happened is we learned that Argo CD had",
    "start": "1014720",
    "end": "1017680"
  },
  {
    "text": "a kind of inefficiency related to",
    "start": "1017680",
    "end": "1020560"
  },
  {
    "text": "applications that manage a lot of",
    "start": "1020560",
    "end": "1023199"
  },
  {
    "text": "Kubernetes",
    "start": "1023199",
    "end": "1024520"
  },
  {
    "text": "resources and so if you have an",
    "start": "1024520",
    "end": "1027438"
  },
  {
    "text": "application that creates single",
    "start": "1027439",
    "end": "1029520"
  },
  {
    "text": "deployment but deployment has hundreds",
    "start": "1029520",
    "end": "1031600"
  },
  {
    "text": "of replicas for Argo CD needs to",
    "start": "1031600",
    "end": "1034640"
  },
  {
    "text": "visualize",
    "start": "1034640",
    "end": "1036319"
  },
  {
    "text": "uh 101 resource in the user interface",
    "start": "1036319",
    "end": "1040240"
  },
  {
    "text": "because it kind of accounts it tries to",
    "start": "1040240",
    "end": "1043038"
  },
  {
    "text": "visualize everything including pods and",
    "start": "1043039",
    "end": "1046038"
  },
  {
    "text": "so if you have such applications then",
    "start": "1046039",
    "end": "1048799"
  },
  {
    "text": "Argo CD updates a set sorry a key in",
    "start": "1048799",
    "end": "1053120"
  },
  {
    "text": "radius and it stores their JSON",
    "start": "1053120",
    "end": "1055640"
  },
  {
    "text": "serialized list of all those resources",
    "start": "1055640",
    "end": "1059200"
  },
  {
    "text": "and we realiz realized",
    "start": "1059200",
    "end": "1061480"
  },
  {
    "text": "that with the growth of number of",
    "start": "1061480",
    "end": "1064080"
  },
  {
    "text": "resources traffic grows exponentially",
    "start": "1064080",
    "end": "1066480"
  },
  {
    "text": "and the reason is if you have a lot of",
    "start": "1066480",
    "end": "1068320"
  },
  {
    "text": "pots they change more frequently and",
    "start": "1068320",
    "end": "1070720"
  },
  {
    "text": "then every size change is bigger in size",
    "start": "1070720",
    "end": "1074000"
  },
  {
    "text": "and that's why we had a user who was",
    "start": "1074000",
    "end": "1077200"
  },
  {
    "text": "managing application with like several",
    "start": "1077200",
    "end": "1079120"
  },
  {
    "text": "thousands of of resources and it was",
    "start": "1079120",
    "end": "1082000"
  },
  {
    "text": "again kind of video streaming like",
    "start": "1082000",
    "end": "1083880"
  },
  {
    "text": "situation and so we've implemented uh an",
    "start": "1083880",
    "end": "1088520"
  },
  {
    "text": "optimization and encourage you",
    "start": "1088520",
    "end": "1092200"
  },
  {
    "text": "to consider enabling it in your cluster",
    "start": "1092200",
    "end": "1095760"
  },
  {
    "text": "uh so the the setting is an environment",
    "start": "1095760",
    "end": "1099520"
  },
  {
    "text": "variable and the setting is fairly new",
    "start": "1099520",
    "end": "1102000"
  },
  {
    "text": "so there is no good default yet but from",
    "start": "1102000",
    "end": "1104720"
  },
  {
    "text": "our experience we found that it's",
    "start": "1104720",
    "end": "1107039"
  },
  {
    "text": "beneficial to use",
    "start": "1107039",
    "end": "1109840"
  },
  {
    "text": "uh this magical number 50 and so what",
    "start": "1109840",
    "end": "1113520"
  },
  {
    "text": "this setting does is it manage it",
    "start": "1113520",
    "end": "1115919"
  },
  {
    "text": "instruct controller to split information",
    "start": "1115919",
    "end": "1119559"
  },
  {
    "text": "about application resources into chunks",
    "start": "1119559",
    "end": "1122960"
  },
  {
    "text": "and instead of storing them all in a",
    "start": "1122960",
    "end": "1124799"
  },
  {
    "text": "single radius key now we can control how",
    "start": "1124799",
    "end": "1127520"
  },
  {
    "text": "many resources go into a single key",
    "start": "1127520",
    "end": "1130240"
  },
  {
    "text": "shard that's how we call it internally",
    "start": "1130240",
    "end": "1132640"
  },
  {
    "text": "and number 50 showed the best results so",
    "start": "1132640",
    "end": "1134960"
  },
  {
    "text": "it doesn't roll doesn't overload CPU so",
    "start": "1134960",
    "end": "1138240"
  },
  {
    "text": "controller doesn't use much of uh CPU to",
    "start": "1138240",
    "end": "1141840"
  },
  {
    "text": "handle the cancellations and it really",
    "start": "1141840",
    "end": "1143840"
  },
  {
    "text": "reduce amount of data it sends to",
    "start": "1143840",
    "end": "1145960"
  },
  {
    "text": "traffic um yeah and then internally we",
    "start": "1145960",
    "end": "1148720"
  },
  {
    "text": "noticed that in in these extreme cases",
    "start": "1148720",
    "end": "1150559"
  },
  {
    "text": "where you have large applications it",
    "start": "1150559",
    "end": "1152320"
  },
  {
    "text": "reduced traffic by like 10x um",
    "start": "1152320",
    "end": "1155760"
  },
  {
    "text": "significant",
    "start": "1155760",
    "end": "1157400"
  },
  {
    "text": "amount um and",
    "start": "1157400",
    "end": "1160520"
  },
  {
    "text": "finally so we found that we had",
    "start": "1160520",
    "end": "1165320"
  },
  {
    "text": "excessive internet traffic uh from",
    "start": "1165320",
    "end": "1169120"
  },
  {
    "text": "controller to a managed cluster and uh",
    "start": "1169120",
    "end": "1172960"
  },
  {
    "text": "it's this is kind of there is no really",
    "start": "1172960",
    "end": "1176880"
  },
  {
    "text": "uh a good way",
    "start": "1176880",
    "end": "1178600"
  },
  {
    "text": "to reduce this traffic so there is no",
    "start": "1178600",
    "end": "1181280"
  },
  {
    "text": "magical setting in Argo CD unfortunately",
    "start": "1181280",
    "end": "1183840"
  },
  {
    "text": "but I wanted to suggest a workar around",
    "start": "1183840",
    "end": "1186400"
  },
  {
    "text": "here and the reason is uh this traffic",
    "start": "1186400",
    "end": "1188240"
  },
  {
    "text": "is 10 times more expensive than internal",
    "start": "1188240",
    "end": "1190960"
  },
  {
    "text": "traffic and that's why even smaller",
    "start": "1190960",
    "end": "1193280"
  },
  {
    "text": "optimization optimizations here kind of",
    "start": "1193280",
    "end": "1195440"
  },
  {
    "text": "translate to uh good savings and so the",
    "start": "1195440",
    "end": "1199840"
  },
  {
    "text": "reason for this traffic is controller",
    "start": "1199840",
    "end": "1203200"
  },
  {
    "text": "Argo application controller watches",
    "start": "1203200",
    "end": "1206080"
  },
  {
    "text": "managed Kubernetes clusters and it tries",
    "start": "1206080",
    "end": "1208640"
  },
  {
    "text": "to catch each and every event um that",
    "start": "1208640",
    "end": "1211799"
  },
  {
    "text": "happens uh and can potentially update",
    "start": "1211799",
    "end": "1215039"
  },
  {
    "text": "affect the state of managed applications",
    "start": "1215039",
    "end": "1217760"
  },
  {
    "text": "and so there are known resources that",
    "start": "1217760",
    "end": "1221120"
  },
  {
    "text": "changes very frequently and usually no",
    "start": "1221120",
    "end": "1224559"
  },
  {
    "text": "one kind of care about those changes and",
    "start": "1224559",
    "end": "1226880"
  },
  {
    "text": "resources are endpoint and endpoint",
    "start": "1226880",
    "end": "1228919"
  },
  {
    "text": "slices and so by default Argo CCD manage",
    "start": "1228919",
    "end": "1234080"
  },
  {
    "text": "and watch these resources because in",
    "start": "1234080",
    "end": "1236400"
  },
  {
    "text": "some cases end users wants to manage",
    "start": "1236400",
    "end": "1238480"
  },
  {
    "text": "endpoints manually but if you don't want",
    "start": "1238480",
    "end": "1240880"
  },
  {
    "text": "to do it then it's recommended to use a",
    "start": "1240880",
    "end": "1244000"
  },
  {
    "text": "setting called resource exclusions and",
    "start": "1244000",
    "end": "1246559"
  },
  {
    "text": "tell Argo CD",
    "start": "1246559",
    "end": "1247919"
  },
  {
    "text": "to just just don't watch this sources",
    "start": "1247919",
    "end": "1250559"
  },
  {
    "text": "and then that might save you tens of",
    "start": "1250559",
    "end": "1253440"
  },
  {
    "text": "dollars per day just because it will be",
    "start": "1253440",
    "end": "1256000"
  },
  {
    "text": "it's a significant source of of traffic",
    "start": "1256000",
    "end": "1258080"
  },
  {
    "text": "and it just uh makes sense to do not",
    "start": "1258080",
    "end": "1261280"
  },
  {
    "text": "watch these resources unless you really",
    "start": "1261280",
    "end": "1262799"
  },
  {
    "text": "want",
    "start": "1262799",
    "end": "1264280"
  },
  {
    "text": "it and this is this is all suggestions I",
    "start": "1264280",
    "end": "1267440"
  },
  {
    "text": "had uh about networking and next I want",
    "start": "1267440",
    "end": "1270640"
  },
  {
    "text": "to move to several lessons we learned",
    "start": "1270640",
    "end": "1273679"
  },
  {
    "text": "about optimizing",
    "start": "1273679",
    "end": "1276960"
  },
  {
    "text": "compute cost and so one of the most",
    "start": "1276960",
    "end": "1279760"
  },
  {
    "text": "impressive change we've made uh here is",
    "start": "1279760",
    "end": "1282400"
  },
  {
    "text": "here on the screen so as you can see we",
    "start": "1282400",
    "end": "1284880"
  },
  {
    "text": "changed one line in a radius",
    "start": "1284880",
    "end": "1287799"
  },
  {
    "text": "configuration and it helped us to reduce",
    "start": "1287799",
    "end": "1290720"
  },
  {
    "text": "our production uh in basically almost by",
    "start": "1290720",
    "end": "1294799"
  },
  {
    "text": "50% and so uh what this setting does is",
    "start": "1294799",
    "end": "1300400"
  },
  {
    "text": "in HA mode Argo CD uses",
    "start": "1300400",
    "end": "1303640"
  },
  {
    "text": "radius with a single master node and two",
    "start": "1303640",
    "end": "1306400"
  },
  {
    "text": "slaves configured to you know replicate",
    "start": "1306400",
    "end": "1308840"
  },
  {
    "text": "changes and so there is a default",
    "start": "1308840",
    "end": "1312000"
  },
  {
    "text": "setting in radius called replication by",
    "start": "1312000",
    "end": "1314320"
  },
  {
    "text": "clock size which is set to half a",
    "start": "1314320",
    "end": "1317440"
  },
  {
    "text": "gigabyte so 500 megabytes and it makes",
    "start": "1317440",
    "end": "1321840"
  },
  {
    "text": "sense I guess for lots of applications",
    "start": "1321840",
    "end": "1323919"
  },
  {
    "text": "that's why it's a default but Argo CD",
    "start": "1323919",
    "end": "1326240"
  },
  {
    "text": "uses radius as a throwaway cache and we",
    "start": "1326240",
    "end": "1329919"
  },
  {
    "text": "could not think of a single H single",
    "start": "1329919",
    "end": "1332640"
  },
  {
    "text": "single scenario where",
    "start": "1332640",
    "end": "1335200"
  },
  {
    "text": "uh you know inconsistent replication",
    "start": "1335200",
    "end": "1337679"
  },
  {
    "text": "might affect anything so radius is used",
    "start": "1337679",
    "end": "1340559"
  },
  {
    "text": "only for to visualize data in the UI and",
    "start": "1340559",
    "end": "1344320"
  },
  {
    "text": "it is anyways kind of has a a little lag",
    "start": "1344320",
    "end": "1348400"
  },
  {
    "text": "so it shows you state of your Kubernetes",
    "start": "1348400",
    "end": "1350480"
  },
  {
    "text": "cluster with a few seconds delay so if",
    "start": "1350480",
    "end": "1352640"
  },
  {
    "text": "it's delayed by another fraction of a",
    "start": "1352640",
    "end": "1354960"
  },
  {
    "text": "second nothing really nothing bad is",
    "start": "1354960",
    "end": "1357280"
  },
  {
    "text": "going to happen and so we changed it in",
    "start": "1357280",
    "end": "1359919"
  },
  {
    "text": "all our instances to uh 60 mgabytes 64",
    "start": "1359919",
    "end": "1364880"
  },
  {
    "text": "megabytes and reduced memory requests",
    "start": "1364880",
    "end": "1368240"
  },
  {
    "text": "and this is like a screenshot of uh the",
    "start": "1368240",
    "end": "1371360"
  },
  {
    "text": "change we've made so we used to run 100",
    "start": "1371360",
    "end": "1374640"
  },
  {
    "text": "almost 150 nodes and eventually number",
    "start": "1374640",
    "end": "1377840"
  },
  {
    "text": "of nodes dropped from 150 to 80",
    "start": "1377840",
    "end": "1383120"
  },
  {
    "text": "uh and we were running around 100 Argo",
    "start": "1383120",
    "end": "1385520"
  },
  {
    "text": "CD applications so this is for you to",
    "start": "1385520",
    "end": "1388159"
  },
  {
    "text": "kind of if you run several dozens of",
    "start": "1388159",
    "end": "1390880"
  },
  {
    "text": "Argo CD instances for your organization",
    "start": "1390880",
    "end": "1392799"
  },
  {
    "text": "there is a chance you can save",
    "start": "1392799",
    "end": "1395320"
  },
  {
    "text": "uh hundreds of gigabytes of memory and",
    "start": "1395320",
    "end": "1398400"
  },
  {
    "text": "this change is safe we can say it we've",
    "start": "1398400",
    "end": "1400559"
  },
  {
    "text": "been running this setup for several",
    "start": "1400559",
    "end": "1403039"
  },
  {
    "text": "months now and no complaints yet and",
    "start": "1403039",
    "end": "1405520"
  },
  {
    "text": "it's saving us $2 to $300 a day which is",
    "start": "1405520",
    "end": "1409280"
  },
  {
    "text": "pretty",
    "start": "1409280",
    "end": "1411320"
  },
  {
    "text": "significant um all right uh I have few",
    "start": "1411320",
    "end": "1415120"
  },
  {
    "text": "more suggestions and we still have 7",
    "start": "1415120",
    "end": "1417360"
  },
  {
    "text": "minutes to go through them so next",
    "start": "1417360",
    "end": "1420840"
  },
  {
    "text": "um another frequent complaint and",
    "start": "1420840",
    "end": "1424320"
  },
  {
    "text": "frequent consumer of uh uh compute is",
    "start": "1424320",
    "end": "1428200"
  },
  {
    "text": "reposerver and so the reason is this",
    "start": "1428200",
    "end": "1430960"
  },
  {
    "text": "component is kind of CPU heavy is uh",
    "start": "1430960",
    "end": "1434679"
  },
  {
    "text": "it uh run for us Helm template commands",
    "start": "1434679",
    "end": "1438720"
  },
  {
    "text": "and customized build and those commands",
    "start": "1438720",
    "end": "1441039"
  },
  {
    "text": "actually take a lot of memory and CPU",
    "start": "1441039",
    "end": "1443520"
  },
  {
    "text": "and uh another known problem is a repo",
    "start": "1443520",
    "end": "1447200"
  },
  {
    "text": "server is configured to by default it",
    "start": "1447200",
    "end": "1451440"
  },
  {
    "text": "does not process multiple requests for a",
    "start": "1451440",
    "end": "1454480"
  },
  {
    "text": "single application in a single repo and",
    "start": "1454480",
    "end": "1456880"
  },
  {
    "text": "the reason is sometimes there are side",
    "start": "1456880",
    "end": "1458559"
  },
  {
    "text": "effects",
    "start": "1458559",
    "end": "1459760"
  },
  {
    "text": "And uh for I would say historically just",
    "start": "1459760",
    "end": "1462720"
  },
  {
    "text": "in case repo server is configured to uh",
    "start": "1462720",
    "end": "1466000"
  },
  {
    "text": "only process one request at a time and",
    "start": "1466000",
    "end": "1468799"
  },
  {
    "text": "so in case you have a git repository",
    "start": "1468799",
    "end": "1472000"
  },
  {
    "text": "that has manifests of multiple",
    "start": "1472000",
    "end": "1474600"
  },
  {
    "text": "applications every time we make a single",
    "start": "1474600",
    "end": "1478400"
  },
  {
    "text": "commit Argo CD suddenly needs to",
    "start": "1478400",
    "end": "1480799"
  },
  {
    "text": "regenerate manifests of all the",
    "start": "1480799",
    "end": "1482799"
  },
  {
    "text": "applications in that repo and it will",
    "start": "1482799",
    "end": "1486559"
  },
  {
    "text": "handle every application one at a time",
    "start": "1486559",
    "end": "1489039"
  },
  {
    "text": "and so to provide a good user experience",
    "start": "1489039",
    "end": "1493039"
  },
  {
    "text": "you would be forced to run many many",
    "start": "1493039",
    "end": "1495600"
  },
  {
    "text": "replicas of repo server and that's the",
    "start": "1495600",
    "end": "1497440"
  },
  {
    "text": "waste of memory and CPU and so the",
    "start": "1497440",
    "end": "1500400"
  },
  {
    "text": "common suggestion we give to everyone",
    "start": "1500400",
    "end": "1502000"
  },
  {
    "text": "and apply it to ourselves is we enable",
    "start": "1502000",
    "end": "1505360"
  },
  {
    "text": "concurrent processing and there is two",
    "start": "1505360",
    "end": "1508400"
  },
  {
    "text": "well-known cases where it's safe uh and",
    "start": "1508400",
    "end": "1510799"
  },
  {
    "text": "that's why Argo CD has a kind of a",
    "start": "1510799",
    "end": "1512559"
  },
  {
    "text": "setting to explicitly enable it one is",
    "start": "1512559",
    "end": "1515840"
  },
  {
    "text": "called controlled by environment",
    "start": "1515840",
    "end": "1517679"
  },
  {
    "text": "variable argo CD helm allow concurrency",
    "start": "1517679",
    "end": "1520720"
  },
  {
    "text": "and it in a in a new version 3.0 zero it",
    "start": "1520720",
    "end": "1524720"
  },
  {
    "text": "will be set to true by default if you",
    "start": "1524720",
    "end": "1526880"
  },
  {
    "text": "run I I mean it's not yet released",
    "start": "1526880",
    "end": "1529360"
  },
  {
    "text": "that's why you for for older version you",
    "start": "1529360",
    "end": "1531919"
  },
  {
    "text": "would need to enable it by default and",
    "start": "1531919",
    "end": "1533679"
  },
  {
    "text": "we know it's safe and it will save you",
    "start": "1533679",
    "end": "1537200"
  },
  {
    "text": "it will allow you to run less replicas",
    "start": "1537200",
    "end": "1540000"
  },
  {
    "text": "of repo server and save some money and",
    "start": "1540000",
    "end": "1543080"
  },
  {
    "text": "another frequent reason why where Argo",
    "start": "1543080",
    "end": "1546320"
  },
  {
    "text": "CD sometimes have to run uh manifest",
    "start": "1546320",
    "end": "1550320"
  },
  {
    "text": "generation sequentially is related to",
    "start": "1550320",
    "end": "1552880"
  },
  {
    "text": "customize So if you",
    "start": "1552880",
    "end": "1555000"
  },
  {
    "text": "override images in uh customized base",
    "start": "1555000",
    "end": "1558480"
  },
  {
    "text": "settings and image is stored in",
    "start": "1558480",
    "end": "1560400"
  },
  {
    "text": "application spec then Argo CD have to",
    "start": "1560400",
    "end": "1563520"
  },
  {
    "text": "modify files in a local clone of git",
    "start": "1563520",
    "end": "1567360"
  },
  {
    "text": "repository and that requires to run",
    "start": "1567360",
    "end": "1570799"
  },
  {
    "text": "uh manifest generation sequentially so",
    "start": "1570799",
    "end": "1573039"
  },
  {
    "text": "if you simply disable if you don't use",
    "start": "1573039",
    "end": "1575440"
  },
  {
    "text": "this feature don't override images it",
    "start": "1575440",
    "end": "1577440"
  },
  {
    "text": "will provide better performance and it",
    "start": "1577440",
    "end": "1579279"
  },
  {
    "text": "will cost you less money and last",
    "start": "1579279",
    "end": "1581360"
  },
  {
    "text": "suggestion is uh once you enable",
    "start": "1581360",
    "end": "1583360"
  },
  {
    "text": "parallel generation you can use a",
    "start": "1583360",
    "end": "1586880"
  },
  {
    "text": "parallel limits flag available in",
    "start": "1586880",
    "end": "1589360"
  },
  {
    "text": "reposerver to control u how many",
    "start": "1589360",
    "end": "1592960"
  },
  {
    "text": "manifest generation you want to run in",
    "start": "1592960",
    "end": "1594559"
  },
  {
    "text": "parallel and there is a very simple rule",
    "start": "1594559",
    "end": "1596720"
  },
  {
    "text": "of what value you want to uh supply here",
    "start": "1596720",
    "end": "1600159"
  },
  {
    "text": "uh we found that it makes sense to check",
    "start": "1600159",
    "end": "1603760"
  },
  {
    "text": "how much CPU cores and how much",
    "start": "1603760",
    "end": "1605919"
  },
  {
    "text": "gigabytes of memory you give to uh your",
    "start": "1605919",
    "end": "1609360"
  },
  {
    "text": "repo server instances and small smaller",
    "start": "1609360",
    "end": "1612080"
  },
  {
    "text": "number between these two is per list",
    "start": "1612080",
    "end": "1614640"
  },
  {
    "text": "limit and the reason is it just makes",
    "start": "1614640",
    "end": "1616960"
  },
  {
    "text": "sense to reserve one core for uh one",
    "start": "1616960",
    "end": "1620880"
  },
  {
    "text": "fork exec of helm or customize and",
    "start": "1620880",
    "end": "1623679"
  },
  {
    "text": "usually every invocation takes one",
    "start": "1623679",
    "end": "1625279"
  },
  {
    "text": "gigabyte so that's why that's what we",
    "start": "1625279",
    "end": "1627760"
  },
  {
    "text": "use at least internally",
    "start": "1627760",
    "end": "1629880"
  },
  {
    "text": "Yeah and uh last suggestion almost on",
    "start": "1629880",
    "end": "1634240"
  },
  {
    "text": "time so we found",
    "start": "1634240",
    "end": "1636440"
  },
  {
    "text": "that reserving and giving the whole um",
    "start": "1636440",
    "end": "1639840"
  },
  {
    "text": "Kubernetes cluster to Argo CD is often",
    "start": "1639840",
    "end": "1643600"
  },
  {
    "text": "kind of a waste uh and the reason is",
    "start": "1643600",
    "end": "1646240"
  },
  {
    "text": "Argo CD uses Kubernetes API server",
    "start": "1646240",
    "end": "1650000"
  },
  {
    "text": "simply to store a collection of",
    "start": "1650000",
    "end": "1652200"
  },
  {
    "text": "applications and it needs to get access",
    "start": "1652200",
    "end": "1654640"
  },
  {
    "text": "to a few secrets and the config maps and",
    "start": "1654640",
    "end": "1657200"
  },
  {
    "text": "so if you provision a single Kubernetes",
    "start": "1657200",
    "end": "1659600"
  },
  {
    "text": "cluster for each each and every Argo CD",
    "start": "1659600",
    "end": "1661520"
  },
  {
    "text": "instance that you have it will not use a",
    "start": "1661520",
    "end": "1664480"
  },
  {
    "text": "lot of features that",
    "start": "1664480",
    "end": "1666799"
  },
  {
    "text": "uh production ready Kubernetes cluster",
    "start": "1666799",
    "end": "1669440"
  },
  {
    "text": "provides such as different controllers",
    "start": "1669440",
    "end": "1671919"
  },
  {
    "text": "and so those there will be some waste of",
    "start": "1671919",
    "end": "1674679"
  },
  {
    "text": "resources and internally we found that",
    "start": "1674679",
    "end": "1677279"
  },
  {
    "text": "it's beneficial for us to have a single",
    "start": "1677279",
    "end": "1679760"
  },
  {
    "text": "host cluster for multiple Argo CDs but",
    "start": "1679760",
    "end": "1683120"
  },
  {
    "text": "we configure our Argo CDs to use KS to",
    "start": "1683120",
    "end": "1686399"
  },
  {
    "text": "to store metadata and uh this way it's",
    "start": "1686399",
    "end": "1689679"
  },
  {
    "text": "possible to use a single host cluster",
    "start": "1689679",
    "end": "1692320"
  },
  {
    "text": "and have safely multiple Argo CDs with",
    "start": "1692320",
    "end": "1695840"
  },
  {
    "text": "various versions using K3S clusters that",
    "start": "1695840",
    "end": "1698960"
  },
  {
    "text": "runs on the same host cluster and it did",
    "start": "1698960",
    "end": "1703039"
  },
  {
    "text": "save us money uh because we didn't try",
    "start": "1703039",
    "end": "1706640"
  },
  {
    "text": "to calculate exactly how much money",
    "start": "1706640",
    "end": "1708159"
  },
  {
    "text": "we're saving but we are I'm pretty sure",
    "start": "1708159",
    "end": "1710720"
  },
  {
    "text": "we're talking about hundreds of dollars",
    "start": "1710720",
    "end": "1712399"
  },
  {
    "text": "for each Argo CD instance",
    "start": "1712399",
    "end": "1716399"
  },
  {
    "text": "Okay that's all I had and we almost run",
    "start": "1716399",
    "end": "1719360"
  },
  {
    "text": "out of time i'm using you know",
    "start": "1719360",
    "end": "1721279"
  },
  {
    "text": "opportunity to talk about the book that",
    "start": "1721279",
    "end": "1723760"
  },
  {
    "text": "our company",
    "start": "1723760",
    "end": "1725760"
  },
  {
    "text": "uh sponsoring so one of our colleagues",
    "start": "1725760",
    "end": "1728080"
  },
  {
    "text": "and uh uh an engineer from Red Hat wrote",
    "start": "1728080",
    "end": "1730799"
  },
  {
    "text": "this book if you want to get it for free",
    "start": "1730799",
    "end": "1733360"
  },
  {
    "text": "i guess yeah that's uh available with",
    "start": "1733360",
    "end": "1736720"
  },
  {
    "text": "via this uh QR code and thanks a lot i",
    "start": "1736720",
    "end": "1740159"
  },
  {
    "text": "hope this section was useful and",
    "start": "1740159",
    "end": "1741919"
  },
  {
    "text": "hopefully it will help you save some",
    "start": "1741919",
    "end": "1743440"
  },
  {
    "text": "money for your company",
    "start": "1743440",
    "end": "1746960"
  },
  {
    "text": "[Applause]",
    "start": "1748450",
    "end": "1750959"
  }
]