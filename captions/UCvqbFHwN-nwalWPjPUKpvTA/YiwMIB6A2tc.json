[
  {
    "text": "hi everyone thank you for joining us for this Cube clinic on Goldilocks my name",
    "start": "3840",
    "end": "10200"
  },
  {
    "text": "is Stevie um and I am and SRE technical lead here at",
    "start": "10200",
    "end": "18840"
  },
  {
    "text": "Fairwind and joining me today is Andy hi everybody I'm Andy CTO of",
    "start": "18840",
    "end": "25320"
  },
  {
    "text": "Fairwinds I've got about five or six years of experience in kubernetes I've been with our company for four and I",
    "start": "25320",
    "end": "30800"
  },
  {
    "text": "just love all things open source and all things kubernetes thanks for joining us there yeah so uh Andy and I work for",
    "start": "30800",
    "end": "38000"
  },
  {
    "text": "Fair Winds um and uh here's our mission statement which I'll read out loud here",
    "start": "38000",
    "end": "43960"
  },
  {
    "text": "real quick uh Fair Winds is the trusted partner for kubernetes security policy and governance with Fair Winds customers",
    "start": "43960",
    "end": "50039"
  },
  {
    "text": "ship Cloud native applications faster more cost effectively and with less risk we provide a unified view between Dev",
    "start": "50039",
    "end": "56879"
  },
  {
    "text": "SEC and Ops removing friction between those teams with soft Ware that simplifies complexity so there are two",
    "start": "56879",
    "end": "63719"
  },
  {
    "text": "sides to our house there's a side uh where we manage kubernetes clusters um and so we've got a lot of",
    "start": "63719",
    "end": "70720"
  },
  {
    "text": "experience we've seen a lot of things uh doing that work on the other side of our",
    "start": "70720",
    "end": "75880"
  },
  {
    "text": "house um is US using that experience to create a platform uh that's backed by",
    "start": "75880",
    "end": "81479"
  },
  {
    "text": "open source Solutions and software that helps users gain visibility into the state of their clusters from a security",
    "start": "81479",
    "end": "87439"
  },
  {
    "text": "governance and reliability stance and offer mitigation strategies for those challenges um so you know I talked about",
    "start": "87439",
    "end": "95520"
  },
  {
    "text": "or mentioned briefly that we use open source Solutions uh for that platform one of the open source solutions that we",
    "start": "95520",
    "end": "101360"
  },
  {
    "text": "use is Goldilocks uh which is a utility that can help you identify a starting",
    "start": "101360",
    "end": "106439"
  },
  {
    "text": "point for resource requests and limits for your kubernetes workloads and so today Andy is going to be uh installing",
    "start": "106439",
    "end": "113960"
  },
  {
    "text": "Goldilocks um for us and showing us around the CLI uh showing us how was",
    "start": "113960",
    "end": "120240"
  },
  {
    "text": "installed um commands and how to interpret the output that it shows us",
    "start": "120240",
    "end": "125280"
  },
  {
    "text": "and then we're also going to take a look at Goldilocks within the um context of uh that platform which is called",
    "start": "125280",
    "end": "133080"
  },
  {
    "text": "insights uh before we start Andy why did the uh FBI not catch the",
    "start": "133080",
    "end": "141840"
  },
  {
    "text": "hackers I I don't know he ran someware",
    "start": "142440",
    "end": "148560"
  },
  {
    "text": "nice that's that's great that's great all right so what is Goldilocks uh can",
    "start": "148560",
    "end": "154200"
  },
  {
    "text": "you tell us a bit about the background can you tell us a bit about the name because Fairwinds open source stuff",
    "start": "154200",
    "end": "159840"
  },
  {
    "text": "typically follows a Convention of being space related and this is not what I think of when I think Goldilocks yeah",
    "start": "159840",
    "end": "166480"
  },
  {
    "text": "definitely so um As Stevie mentioned you know we have managed a lot of clusters over the years for a lot of different",
    "start": "166480",
    "end": "172239"
  },
  {
    "text": "customers and we tell them you know we started out telling people hey you've got to set your resource requests and",
    "start": "172239",
    "end": "178200"
  },
  {
    "text": "limits because that's like fun Al to how we've been packing kubernetes how we Auto scale all that good stuff and um",
    "start": "178200",
    "end": "186239"
  },
  {
    "text": "you know fairly reasonable request ask our customers to do that but then they came back to us and they said well what do we set them to and so that usually",
    "start": "186239",
    "end": "193000"
  },
  {
    "text": "ended up with us going into our monitoring solution and looking at graphs and you know every time they",
    "start": "193000",
    "end": "199400"
  },
  {
    "text": "wanted to size a workload it would be kind of this process of you know just",
    "start": "199400",
    "end": "205040"
  },
  {
    "text": "using your knowledge of kubernetes to to give them that recommendation and I said well there's got to be an easier way to",
    "start": "205040",
    "end": "210599"
  },
  {
    "text": "do this because like this is kind of painful and we get this ask all the time uh and so what we did was we developed",
    "start": "210599",
    "end": "216000"
  },
  {
    "text": "Goldilocks and um we uh decided to leverage a different an existing",
    "start": "216000",
    "end": "222040"
  },
  {
    "text": "recommendation engine that already existed in the kubernetes community so goldilux is based on the vertical pod",
    "start": "222040",
    "end": "228760"
  },
  {
    "text": "autoscaler and it basically manages vertical pod autoscaler objects in uh",
    "start": "228760",
    "end": "235599"
  },
  {
    "text": "what I call recommendation mode or what they call off mode where the the vertical pod autoscaler doesn't do",
    "start": "235599",
    "end": "241159"
  },
  {
    "text": "anything it just sits there and watches your pods and makes recommendations on resource requests and limits and so",
    "start": "241159",
    "end": "247760"
  },
  {
    "text": "Goldilocks is a nice way to manage all of those objects and then show everything in a nice dashboard uh and",
    "start": "247760",
    "end": "254159"
  },
  {
    "text": "then you mentioned the name so we were trying to come up with a name uh and obviously Goldilocks makes sense because you know you don't want your resource",
    "start": "254159",
    "end": "260680"
  },
  {
    "text": "request to be too low you don't want to be too high you want it to be just right um and that plays into the Space theme",
    "start": "260680",
    "end": "266759"
  },
  {
    "text": "nicely as well which not everybody may know um the goldilock zone is the habitable",
    "start": "266759",
    "end": "273280"
  },
  {
    "text": "zone um in distance from a star and so the Earth sits in what we term what is",
    "start": "273280",
    "end": "279800"
  },
  {
    "text": "nickname The goldilock Zone because it's not cold enough for water to freeze but",
    "start": "279800",
    "end": "284919"
  },
  {
    "text": "not so hot that humans can't live on that planet and so it's a little bit of a dual meaning there that's super cool",
    "start": "284919",
    "end": "292759"
  },
  {
    "text": "okay all right you want to get started with the first part of the demo sure sure so if um you're curious about",
    "start": "292759",
    "end": "299759"
  },
  {
    "text": "Goldilocks you want to try it out it is on our GitHub page Fairwind Ops",
    "start": "299759",
    "end": "306199"
  },
  {
    "text": "Goldilocks um if I could type correctly uh our company name that would",
    "start": "306199",
    "end": "311919"
  },
  {
    "text": "be good there we go uh and so here you can find a link to our documentation site which I just had shown um you can",
    "start": "311919",
    "end": "318800"
  },
  {
    "text": "find releases and then uh the documentation site will have instructions on how to install it so if",
    "start": "318800",
    "end": "323840"
  },
  {
    "text": "you're curious on doing about doing this on your own feel free to check that out uh so I'm just going to jump straight in",
    "start": "323840",
    "end": "328960"
  },
  {
    "text": "here um the first thing we're going to do is we are going to kick off a kind cluster",
    "start": "328960",
    "end": "336240"
  },
  {
    "text": "so if you're not familiar with kind that's ku's in Docker it's a nice way to run just a quick easy test cluster on",
    "start": "336240",
    "end": "342440"
  },
  {
    "text": "your machine so if you want to Tinker around with Goldilocks this is the easiest way to get",
    "start": "342440",
    "end": "347800"
  },
  {
    "text": "started and then as soon as that comes up I'm gonna",
    "start": "347800",
    "end": "353120"
  },
  {
    "text": "install a bunch of stuff I'm going to do the thing that I hate it when people do",
    "start": "353120",
    "end": "359000"
  },
  {
    "text": "I'm going to copy paste a big old list of commands into my terminal here um and I'm going to run that and so",
    "start": "359000",
    "end": "367759"
  },
  {
    "text": "I'll I'll put it over here on the left so I can talk about what's going on here uh so the first thing go ahead I was",
    "start": "367759",
    "end": "374639"
  },
  {
    "text": "gonna say that's a lot of uh that's a big block of text so yeah if you'd walk us through that yeah no problem so",
    "start": "374639",
    "end": "380800"
  },
  {
    "text": "there's a couple of prerequisites for running Goldilocks the first one I already mentioned is the vertical po",
    "start": "380800",
    "end": "386720"
  },
  {
    "text": "autoscaler um and so you have to have that installed for Goldilocks can do anything so here uh fnds has a chart for",
    "start": "386720",
    "end": "393639"
  },
  {
    "text": "the vertical pod Auto scaler I don't believe there's an official Upstream chart for it which is why we have our own uh and so you can install that from",
    "start": "393639",
    "end": "400440"
  },
  {
    "text": "our repository I'm putting it in its own namespace um and the other the second",
    "start": "400440",
    "end": "406479"
  },
  {
    "text": "prerequisite for Goldilocks and something that I kind of just install in all of my clusters and in my kind",
    "start": "406479",
    "end": "412400"
  },
  {
    "text": "clusters as well is the metric server so we have here the metric server chart",
    "start": "412400",
    "end": "418160"
  },
  {
    "text": "with a couple of flags to make it work with uh the kind cluster specifically the Cubit insecure TLS",
    "start": "418160",
    "end": "425319"
  },
  {
    "text": "flag um and then I'm installing just a demo application this is in our incubator chart repository it's just a",
    "start": "425319",
    "end": "432680"
  },
  {
    "text": "neat little app that you can hit and get traffic um and and show what pod you're",
    "start": "432680",
    "end": "439000"
  },
  {
    "text": "connecting to and then the last thing I'm doing obviously is installing Goldilocks itself so we have a Helm",
    "start": "439000",
    "end": "444039"
  },
  {
    "text": "chart for that it's in the Fairwinds stable repository that's at github.com",
    "start": "444039",
    "end": "449680"
  },
  {
    "text": "op charts if you want to see the source code for that um and all of these instructions are should be in the",
    "start": "449680",
    "end": "456560"
  },
  {
    "text": "documentation for Goldie Locks um now real quick um I do always want to make",
    "start": "456560",
    "end": "462919"
  },
  {
    "text": "sure that you know we're not making assumptions about things so can you just talk really quickly about what the vertical pod autoscaler does in general",
    "start": "462919",
    "end": "470520"
  },
  {
    "text": "like how on its own yeah yeah sure so the ver so uh if you're familiar with",
    "start": "470520",
    "end": "476479"
  },
  {
    "text": "horizontal po out scaling that is giving kubernetes the ability to uh create more",
    "start": "476479",
    "end": "482120"
  },
  {
    "text": "replicas of a pod or less replicas of a pod based on some Metric and some Target",
    "start": "482120",
    "end": "487720"
  },
  {
    "text": "the vertical pod autoscaler looks at a pod's uh CPU and memory usage and will",
    "start": "487720",
    "end": "494879"
  },
  {
    "text": "scale it up and down in size so it'll give it more CPU or less CPU or more",
    "start": "494879",
    "end": "500599"
  },
  {
    "text": "memory or less memory it does this in a couple of different ways but the primary",
    "start": "500599",
    "end": "506560"
  },
  {
    "text": "uh way it can do that um well essentially there three parts there's a recommender which is the thing that",
    "start": "506560",
    "end": "512719"
  },
  {
    "text": "watches all the pods and looks at the or watches all the vertical pod autoscaler",
    "start": "512719",
    "end": "519200"
  },
  {
    "text": "objects which select pods much in the way that a horizontal pod autoscaler would and then calculates a",
    "start": "519200",
    "end": "525040"
  },
  {
    "text": "recommendation for those pods and you'll see a little bit more of this later uh as we go through the demo and then um it",
    "start": "525040",
    "end": "532160"
  },
  {
    "text": "has an admission controller and an updater that will actually modify those pods or quests as they get launched and",
    "start": "532160",
    "end": "539399"
  },
  {
    "text": "then I Believe In some cases it will actually start replacing pods if necessary we don't typically use it in",
    "start": "539399",
    "end": "544760"
  },
  {
    "text": "update mode because it doesn't work with horizontal po AO scalers that are scaling based on CPU and memory because",
    "start": "544760",
    "end": "551120"
  },
  {
    "text": "the two would fight each other basically um but we focus on the recommendation",
    "start": "551120",
    "end": "556440"
  },
  {
    "text": "engine portion of it uh in fact the chart that we installed um by default um only installs",
    "start": "556440",
    "end": "565360"
  },
  {
    "text": "the recommender and the updator and not the admission web hook because it's unnecessary you can actually even have it just install the the recommender if",
    "start": "565360",
    "end": "573519"
  },
  {
    "text": "you want um so those are all options on the chart cool thank you yeah no problem so",
    "start": "573519",
    "end": "581200"
  },
  {
    "text": "uh we have some output here from the Goldilocks install which uh actually",
    "start": "581200",
    "end": "586440"
  },
  {
    "text": "could probably use some updating um because there's an easier way to do this but what I'm going to do is I'm going to do a port forward to the Goldilocks",
    "start": "586440",
    "end": "593959"
  },
  {
    "text": "dashboard service which is now running in the uh goalie loocks namespace so we",
    "start": "593959",
    "end": "600880"
  },
  {
    "text": "can see the controller and the dashboard are running uh so I'm going to go ahead and kick off that port forward and we're",
    "start": "600880",
    "end": "607560"
  },
  {
    "text": "going to open our browser and we're going to go to Local Host 8080 the chart obviously has the ability to add an",
    "start": "607560",
    "end": "613360"
  },
  {
    "text": "Ingress or whatever if you want we run these with an Ingress and an oaf proxy so that we uh don't have to port forward",
    "start": "613360",
    "end": "620000"
  },
  {
    "text": "to them um and here we see nothing because we haven't done the next",
    "start": "620000",
    "end": "625680"
  },
  {
    "text": "step yet um so the instuctions are here about what you have to do next if you",
    "start": "625680",
    "end": "631040"
  },
  {
    "text": "miss this part of the uh installation instructions if you're going through the docs but basically goldilock doesn't",
    "start": "631040",
    "end": "636560"
  },
  {
    "text": "operate on anything unless we tell it to uh so we have to opt into Goldilocks instead of opting",
    "start": "636560",
    "end": "642920"
  },
  {
    "text": "out in the default installation so we do this via labels um so we can label our",
    "start": "642920",
    "end": "648360"
  },
  {
    "text": "Nam space with the Goldilocks dfn.com enabled equals true uh so I'm going to",
    "start": "648360",
    "end": "653959"
  },
  {
    "text": "go ahead and do that and if you'll recall actually",
    "start": "653959",
    "end": "660399"
  },
  {
    "text": "um we can see here that we also have no vertical pod autoscaler objects anywhere",
    "start": "660399",
    "end": "666120"
  },
  {
    "text": "in the cluster because Goldilocks haven't created any yet so what we'll do is we'll label our namespace demo with",
    "start": "666120",
    "end": "675800"
  },
  {
    "text": "the Goldilocks do aoins.com enabled",
    "start": "675800",
    "end": "681399"
  },
  {
    "text": "equals true and what we should see is Goldilocks immediately recognizes that",
    "start": "681399",
    "end": "687480"
  },
  {
    "text": "goes into a Reconciliation and creates a vertical po Auto scaler for the",
    "start": "687480",
    "end": "693839"
  },
  {
    "text": "deployment that exists in the Goldilocks name so we or sorry the demo name",
    "start": "693839",
    "end": "701399"
  },
  {
    "text": "space we see we have one deployment called demo basic demo and goldilock has",
    "start": "701399",
    "end": "706560"
  },
  {
    "text": "created a vpa for that you may have noticed that the CPU and memory were blank there for a second uh and the",
    "start": "706560",
    "end": "712680"
  },
  {
    "text": "provided was false now we see here CPU and memory are filled out so this is its",
    "start": "712680",
    "end": "717959"
  },
  {
    "text": "recommendation for the pods running underneath this",
    "start": "717959",
    "end": "723680"
  },
  {
    "text": "deployment uh so we can get that",
    "start": "723680",
    "end": "729399"
  },
  {
    "text": "vpa grab the name and we'll see that um goolock has",
    "start": "731120",
    "end": "739680"
  },
  {
    "text": "created it to Target the deployment demo basic",
    "start": "739680",
    "end": "745279"
  },
  {
    "text": "demo is off so we're not going to try to automatically update any we're just going to sit here and watch and then",
    "start": "745279",
    "end": "750959"
  },
  {
    "text": "we'll see in the status there's a recommendation here so it's giving us four different uh types of",
    "start": "750959",
    "end": "757639"
  },
  {
    "text": "recommendations um a lower bound and an upper bound which we will see sort of",
    "start": "757639",
    "end": "763560"
  },
  {
    "text": "used in a second and then a Target um and an uncapped Target I don't remember what uncapped Target is I'm not going to",
    "start": "763560",
    "end": "769600"
  },
  {
    "text": "go into that but anyway we see it has recommendations um it has looked at the",
    "start": "769600",
    "end": "775160"
  },
  {
    "text": "amount of CPU memory that it's using and it has made a recommendation um so if we",
    "start": "775160",
    "end": "781720"
  },
  {
    "text": "do a top on those pods we'll see they're actually using far less than this that's because the vpa has a default minimum",
    "start": "781720",
    "end": "788519"
  },
  {
    "text": "and that's configurable if you want to set that minimum lower but we're getting the default minimum recommendation here from vpa obviously if we wanted to see",
    "start": "788519",
    "end": "795440"
  },
  {
    "text": "real world numbers here we would want to generate some load against this so we can go back to our dashboard now and we",
    "start": "795440",
    "end": "802199"
  },
  {
    "text": "can refresh and we see that there is a name space listed here uh and we can go ahead and click on that and we will see",
    "start": "802199",
    "end": "809440"
  },
  {
    "text": "similar to what we were just looking at we see you know we have a namespace demo that we've labeled um it's got a",
    "start": "809440",
    "end": "815959"
  },
  {
    "text": "deployment in it that deployment has a single container in it and here are our recommendations we see it's recommending",
    "start": "815959",
    "end": "821839"
  },
  {
    "text": "15 millor and 105 megabytes of ram you",
    "start": "821839",
    "end": "827160"
  },
  {
    "text": "can drop that this down get a little code box if you want to just copy that straight into your app um and it will do",
    "start": "827160",
    "end": "835360"
  },
  {
    "text": "this for every top level workload in the uh namespace so Damon sets deployments",
    "start": "835360",
    "end": "843199"
  },
  {
    "text": "other things that create paths stateful sets um and you'll see those all listed here for this name space or you can",
    "start": "843199",
    "end": "849759"
  },
  {
    "text": "click on the detail all namespaces button over here and see all the namespaces all at",
    "start": "849759",
    "end": "856399"
  },
  {
    "text": "once now if you um oh I'm sorry so so",
    "start": "856399",
    "end": "861560"
  },
  {
    "text": "now you would get this recommendation from Goldilocks and you would decide to go and like make this change in your um",
    "start": "861560",
    "end": "868120"
  },
  {
    "text": "deployment right to change these settings yep okay yeah",
    "start": "868120",
    "end": "873519"
  },
  {
    "text": "so I could go and edit the AML for it and then put that in and see how it",
    "start": "873519",
    "end": "878720"
  },
  {
    "text": "performs is kind of the idea here and I I would like to you know note that this is a baseline right this is a place to",
    "start": "878720",
    "end": "884360"
  },
  {
    "text": "get started we're looking at you know right now we're looking at about two minutes worth of information about how",
    "start": "884360",
    "end": "889680"
  },
  {
    "text": "it's behaving we're not generating any load against it so you know goldilux is only as good as the information you put",
    "start": "889680",
    "end": "895079"
  },
  {
    "text": "into it so it's a it's a great Baseline good place to get started can be really useful for",
    "start": "895079",
    "end": "900600"
  },
  {
    "text": "that and so right now if you want to use Goldilocks for a workload you would have",
    "start": "900600",
    "end": "906000"
  },
  {
    "text": "to uh label that that namespace so you would have to go through and lab what if you don't want to manually label all",
    "start": "906000",
    "end": "911759"
  },
  {
    "text": "your name spaces one by one how would you go about doing that a great question so um earlier we ran the",
    "start": "911759",
    "end": "920519"
  },
  {
    "text": "um it over here the helm upgrade install Goldilocks create Nam space from our",
    "start": "920519",
    "end": "927279"
  },
  {
    "text": "Goldilocks chart there are a couple of flags for both the controller and the dashboard um they're both called on by",
    "start": "927279",
    "end": "934880"
  },
  {
    "text": "default uh and so basically that says all show me all the namespaces unless I",
    "start": "934880",
    "end": "940560"
  },
  {
    "text": "opt out of them uh and so we can flip that flag for both the controller and",
    "start": "940560",
    "end": "945800"
  },
  {
    "text": "the dashboard uh and we'll do our home upgrade",
    "start": "945800",
    "end": "951480"
  },
  {
    "text": "install uh and I will edit the namespace",
    "start": "951480",
    "end": "956600"
  },
  {
    "text": "demo and or yeah edit the demo name space and remove that",
    "start": "956600",
    "end": "963440"
  },
  {
    "text": "label um and now we should see a whole bunch more vpa so we've got one for",
    "start": "963440",
    "end": "971319"
  },
  {
    "text": "basically every top level workload in the cluster and so this will actually",
    "start": "971319",
    "end": "976680"
  },
  {
    "text": "give us a nice way to go back to our namespace list and see what this looks like when we have more than one",
    "start": "976680",
    "end": "982160"
  },
  {
    "text": "namespace involved I think my port forward probably died",
    "start": "982160",
    "end": "987519"
  },
  {
    "text": "because I killed the pond there we go so now we see all the name spaces in the cluster we can go take a look at the I",
    "start": "987519",
    "end": "996199"
  },
  {
    "text": "don't know let's look at the goldx name space because we know it has more than one workload in it and it probably hasn't populated yet",
    "start": "996199",
    "end": "1003720"
  },
  {
    "text": "so we're going to give that a minute there it is all right so now we",
    "start": "1003720",
    "end": "1010880"
  },
  {
    "text": "see we've got two different deployments they've got their own recommendations here um and I think something I skipped",
    "start": "1010880",
    "end": "1018279"
  },
  {
    "text": "over earlier I didn't talk about quality of service um if you're not familiar with quality of service in kubernetes",
    "start": "1018279",
    "end": "1026038"
  },
  {
    "text": "it's a designation that's given to pods based on how their resource requests and",
    "start": "1026039",
    "end": "1032160"
  },
  {
    "text": "limits are configured um so guaranteed qos is assigned when you have your",
    "start": "1032160",
    "end": "1037600"
  },
  {
    "text": "resource requests and your limits equal to each other so you say I I need this",
    "start": "1037600",
    "end": "1043558"
  },
  {
    "text": "much and I promise not to go over this much uh and so it puts it into sort of a",
    "start": "1043559",
    "end": "1049480"
  },
  {
    "text": "higher quality of service class because you've been very explicit about that there's a burstable qos as well which is",
    "start": "1049480",
    "end": "1055640"
  },
  {
    "text": "where you set your limits higher than your requests um which allows the Pod to",
    "start": "1055640",
    "end": "1060840"
  },
  {
    "text": "burst this is important because scheduling and scheduling is based on",
    "start": "1060840",
    "end": "1066760"
  },
  {
    "text": "request and hpas are also based on request uh not on limit and so you're",
    "start": "1066760",
    "end": "1072679"
  },
  {
    "text": "allowed to burst over it but if if you start to do a lot of burstable things and they're all bursting all the time",
    "start": "1072679",
    "end": "1078840"
  },
  {
    "text": "then you're over provisioned most likely or you're you're trying to use more resources than exist and so we give a",
    "start": "1078840",
    "end": "1084440"
  },
  {
    "text": "recommendation for either qos class um and that's based on that um uncapped",
    "start": "1084440",
    "end": "1092080"
  },
  {
    "text": "sorry not uncapped Target this is based on the target so we set both the resource request and limit to the target",
    "start": "1092080",
    "end": "1097520"
  },
  {
    "text": "from the vpa burstable is set to the lower bound and the upper bound I",
    "start": "1097520",
    "end": "1102600"
  },
  {
    "text": "believe it might be Target in Upper bound I'd have to check the code on that um but we give two different recommendations based on the information",
    "start": "1102600",
    "end": "1108760"
  },
  {
    "text": "the vpa gives us and if you ever forget all that qos stuff there's some helpful information down here and some links out",
    "start": "1108760",
    "end": "1114600"
  },
  {
    "text": "to the kubernetes documentation on those uh quality service classes nice yeah and you had said I",
    "start": "1114600",
    "end": "1122799"
  },
  {
    "text": "mean you mentioned that you know it's only as good as the information you feed it right and so um with the information",
    "start": "1122799",
    "end": "1130039"
  },
  {
    "text": "the vpa is getting about the uh resources being utilized for your workload like um how much data does",
    "start": "1130039",
    "end": "1139360"
  },
  {
    "text": "vpa uh retain to make this um you know like how far back does it go to make",
    "start": "1139360",
    "end": "1145480"
  },
  {
    "text": "these uh considerations and what if I you know what if I wanted to go back even further than whatever the default",
    "start": "1145480",
    "end": "1151880"
  },
  {
    "text": "is great question great question so the vertical po autoscaler by default um can",
    "start": "1151880",
    "end": "1157679"
  },
  {
    "text": "only take in so much historical data uh I'm not sure what the actual timeline on",
    "start": "1157679",
    "end": "1163200"
  },
  {
    "text": "that is it's I think it's relatively short because it's storing the model in memory and the recommendation model",
    "start": "1163200",
    "end": "1168760"
  },
  {
    "text": "memory um what you can do is the vertical pod autoscaler gives us the option to connect to Prometheus uh so",
    "start": "1168760",
    "end": "1176039"
  },
  {
    "text": "you can connect that vpa recommender to a Prometheus instance in your cluster",
    "start": "1176039",
    "end": "1181520"
  },
  {
    "text": "and then it's actually configurable how much time you want it to look back um so",
    "start": "1181520",
    "end": "1186679"
  },
  {
    "text": "you can kind of align your Prometheus retention settings with your vpa settings so that they're you know",
    "start": "1186679",
    "end": "1192400"
  },
  {
    "text": "somewhat um saying uh you know agreeing with each other shall we say um and so I",
    "start": "1192400",
    "end": "1199000"
  },
  {
    "text": "can show how to do that here pretty quickly uh what I'm going to do is I'm",
    "start": "1199000",
    "end": "1204520"
  },
  {
    "text": "I'm going to add a Prometheus stack to this cluster so I'm going to use the cube Prometheus stack which is a public",
    "start": "1204520",
    "end": "1210960"
  },
  {
    "text": "chart from the Prometheus Community uh and I'm going to disable Grana and alert manager because I don't need it right",
    "start": "1210960",
    "end": "1216240"
  },
  {
    "text": "now but what this is going to do is it's going to install Cube State metrics which gets all of like the kubernetes",
    "start": "1216240",
    "end": "1221559"
  },
  {
    "text": "state information it's going to install um a Prometheus instance and the",
    "start": "1221559",
    "end": "1227480"
  },
  {
    "text": "Prometheus op operator uh and so that Prometheus will immediately start gathering information about the",
    "start": "1227480",
    "end": "1233080"
  },
  {
    "text": "resources in my cluster uh and so we'll get that installed and then what we have",
    "start": "1233080",
    "end": "1238320"
  },
  {
    "text": "to do is we have to update our vertical pod autoscaler installation um so I'm going to find my",
    "start": "1238320",
    "end": "1246880"
  },
  {
    "text": "vpa install command that I ran earlier and I'm going to add a few Flags to that",
    "start": "1246880",
    "end": "1252159"
  },
  {
    "text": "so I'm going to add the recommender do extra args do Prometheus",
    "start": "1252159",
    "end": "1259760"
  },
  {
    "text": "address and I'm going to set that to the address pointing to the Prometheus",
    "start": "1259760",
    "end": "1266280"
  },
  {
    "text": "service so if we get pods or get services in the Prometheus",
    "start": "1266280",
    "end": "1273919"
  },
  {
    "text": "Nam space we will see we have a service called Cube Prometheus stack",
    "start": "1273919",
    "end": "1281600"
  },
  {
    "text": "Prometheus in the Prometheus namespace on the 9090 port and then we have to set",
    "start": "1281600",
    "end": "1288640"
  },
  {
    "text": "one other flag on the recommender uh this is documented in the",
    "start": "1288640",
    "end": "1293880"
  },
  {
    "text": "vpa chart as well as lightly documented in the vpa",
    "start": "1293880",
    "end": "1299200"
  },
  {
    "text": "project um although sometimes I've had to go download or go look at the code",
    "start": "1299200",
    "end": "1304880"
  },
  {
    "text": "where all the flags are defined for the uh vpa recommender because they're not super well documented so um so we have",
    "start": "1304880",
    "end": "1312000"
  },
  {
    "text": "to set the storage method for the vpa recommender to Prometheus uh and so we",
    "start": "1312000",
    "end": "1320360"
  },
  {
    "text": "can go ahead and take a look at the logs as that starts",
    "start": "1321440",
    "end": "1329640"
  },
  {
    "text": "to take place we should be getting a new recommender here in just a",
    "start": "1330480",
    "end": "1337520"
  },
  {
    "text": "second and now we should have yep um historical usage query used",
    "start": "1338960",
    "end": "1347600"
  },
  {
    "text": "contain CPU seconds total from the C advisor job which is default in the",
    "start": "1347600",
    "end": "1353000"
  },
  {
    "text": "Prometheus installation uh and so it's going to go just check all the and the container memory working set bytes so",
    "start": "1353000",
    "end": "1359039"
  },
  {
    "text": "it's going to go get all that historical information and make its recommendations based on the Prometheus",
    "start": "1359039",
    "end": "1365520"
  },
  {
    "text": "information there so if we'd had Prometheus running for a little bit longer I think the default on that flag is like 30 minutes um but I believe it",
    "start": "1365520",
    "end": "1374080"
  },
  {
    "text": "can be configured to be longer actually take a look real quick",
    "start": "1374080",
    "end": "1380600"
  },
  {
    "text": "folks are curious go to the vertical pod autoscaler folder and the autoscaler",
    "start": "1380600",
    "end": "1386520"
  },
  {
    "text": "repo uh and we go to the recommender package and we go",
    "start": "1386520",
    "end": "1395559"
  },
  {
    "text": "[Music] to don't remember where the flags are",
    "start": "1396870",
    "end": "1405759"
  },
  {
    "text": "exactly oh I think it might just be in main.go actually here we go yep um so we'll just",
    "start": "1406880",
    "end": "1414000"
  },
  {
    "text": "search for Prometheus here so we have that Prometheus address flag we set if your Prometheus job is a little bit",
    "start": "1414000",
    "end": "1419840"
  },
  {
    "text": "different you're not using the defaults in the Q Prometheus stack um and then when we start looking",
    "start": "1419840",
    "end": "1426159"
  },
  {
    "text": "at storage we have history length so we'll go back eight days uh history res",
    "start": "1426159",
    "end": "1431440"
  },
  {
    "text": "resolution one hour some timeout stuff so there's a lot of different flags to configure here um and this is probably",
    "start": "1431440",
    "end": "1438720"
  },
  {
    "text": "the easiest place to see them all because I don't think they're fully documented um and so the codee's definitely the source of Truth here",
    "start": "1438720",
    "end": "1446000"
  },
  {
    "text": "would any of these so I'm imagining a scenario where you have a workload that is um you know sometimes is burst just",
    "start": "1446000",
    "end": "1455240"
  },
  {
    "text": "burst up over a limit you know for a short amount of times you just have a little Spike right that can often be",
    "start": "1455240",
    "end": "1460720"
  },
  {
    "text": "hidden or or uh can adversely affect um you know the recommendation that you get",
    "start": "1460720",
    "end": "1467559"
  },
  {
    "text": "are those uh flags that we were looking at uh in Prometheus are those some things that you could use to sort of",
    "start": "1467559",
    "end": "1474200"
  },
  {
    "text": "sort the granularity there um to account for those kinds of spikes good question",
    "start": "1474200",
    "end": "1480440"
  },
  {
    "text": "I'm not sure how it takes that into account I'm guess well probably the uh resolution and the interval uh together",
    "start": "1480440",
    "end": "1488960"
  },
  {
    "text": "probably would affect that behavior um I'm not entirely certain you know the",
    "start": "1488960",
    "end": "1494679"
  },
  {
    "text": "Deep Nuance of that I do know that you know once it has that information from Prometheus we do see that encapsulated",
    "start": "1494679",
    "end": "1502120"
  },
  {
    "text": "in this upper bound here I've seen that upper bound go super high because the workflow will Spike up and that will be",
    "start": "1502120",
    "end": "1509279"
  },
  {
    "text": "encapsulated in that upper bound as long as your like you said your resolution from Prometheus is high enough such that",
    "start": "1509279",
    "end": "1516360"
  },
  {
    "text": "you're actually seeing that information from Prometheus right okay um and so how does uh Goldilocks",
    "start": "1516360",
    "end": "1525080"
  },
  {
    "text": "actually populate all this data yeah good question good question so um this",
    "start": "1525080",
    "end": "1531559"
  },
  {
    "text": "dashboard uh runs essentially the same as as a CLI command that we have um",
    "start": "1531559",
    "end": "1538080"
  },
  {
    "text": "there's a summary command in Goldilocks um so if we just do goldilock",
    "start": "1538080",
    "end": "1544360"
  },
  {
    "text": "summary we'll see it spits out this really large",
    "start": "1544360",
    "end": "1550240"
  },
  {
    "text": "uh um Json object",
    "start": "1550240",
    "end": "1555720"
  },
  {
    "text": "um and throw that into a file real quick",
    "start": "1555960",
    "end": "1563399"
  },
  {
    "text": "and look at that via JQ uh and so we see all of the vpa information for each",
    "start": "1563399",
    "end": "1569919"
  },
  {
    "text": "workload summarized in this object uh and so this is the data object that is",
    "start": "1569919",
    "end": "1575760"
  },
  {
    "text": "provided to the dashboard uh for each Nam space um and so you know if you",
    "start": "1575760",
    "end": "1583080"
  },
  {
    "text": "wanted to get that data out some other way or just you know you really like reading J on for some reason um you're",
    "start": "1583080",
    "end": "1590080"
  },
  {
    "text": "welcome to try out that goldilock summary command it's not fully supported because we don't really maintain the CLI",
    "start": "1590080",
    "end": "1596159"
  },
  {
    "text": "functionality all that much uh it's really there for testing um but it is definitely available and usable if folks",
    "start": "1596159",
    "end": "1603279"
  },
  {
    "text": "need that data somewhere else or want to you know or something you want to like",
    "start": "1603279",
    "end": "1609919"
  },
  {
    "text": "import that as a dashboard or something like that you could that's probably possible Right now the dashboard doesn't",
    "start": "1609919",
    "end": "1616480"
  },
  {
    "text": "actually you know what we might have",
    "start": "1616480",
    "end": "1624440"
  },
  {
    "text": "put I'll have to take a look there may be an endpoint on the dashboard to be able to grab that Json object directly",
    "start": "1626679",
    "end": "1633440"
  },
  {
    "text": "without having to U run the summary command but yeah you could effectively do whatever you wanted with that Json",
    "start": "1633440",
    "end": "1639720"
  },
  {
    "text": "object yeah so we've um you know talked",
    "start": "1639720",
    "end": "1645000"
  },
  {
    "text": "about installing Goldilocks in a cluster talked about um you know how to how to",
    "start": "1645000",
    "end": "1651919"
  },
  {
    "text": "label your name spaces so that um you know Goldie loock picks it up and and creates the vpa objects and for it or",
    "start": "1651919",
    "end": "1659679"
  },
  {
    "text": "sources of those vpa objects um and we've talked about um getting our data retention to",
    "start": "1659679",
    "end": "1667760"
  },
  {
    "text": "be longer so that we have more information to work off of but we've done this let's say you know in in one",
    "start": "1667760",
    "end": "1673799"
  },
  {
    "text": "cluster if you have multiple clusters so you've got like multiple production clusters for example that you might want",
    "start": "1673799",
    "end": "1678960"
  },
  {
    "text": "this data in um how would you go about is there a simpler way to run Goldilocks",
    "start": "1678960",
    "end": "1684279"
  },
  {
    "text": "rather than having to port forward or create ingresses for every different cluster yeah definitely definitely uh",
    "start": "1684279",
    "end": "1691799"
  },
  {
    "text": "and this is that's really where our SAS product comes into play right um our SAS product will allow you to Cate all of",
    "start": "1691799",
    "end": "1699039"
  },
  {
    "text": "the information from a whole bunch of clusters into um into a single dashboard where we",
    "start": "1699039",
    "end": "1706320"
  },
  {
    "text": "encapsulate that locks data and then we actually take it a bit further we add cost information and other things like",
    "start": "1706320",
    "end": "1712000"
  },
  {
    "text": "that so I can show you that real quick um um you know obviously there is a pure",
    "start": "1712000",
    "end": "1717919"
  },
  {
    "text": "open source option if you really want to run it everywhere and install it everywhere and grab that Json and do something with it but we've already done",
    "start": "1717919",
    "end": "1723760"
  },
  {
    "text": "that for you here uh that's exactly what we're doing here so uh this is Fairwinds insights um first we'll see you know the",
    "start": "1723760",
    "end": "1731559"
  },
  {
    "text": "we first see it we see we've got a whole bunch of clusters listed here um and they've got different scores and things",
    "start": "1731559",
    "end": "1737600"
  },
  {
    "text": "so not only do we pull in goalie loocks data but we have a whole bunch of other open source that feeds into this we've got Nova we've got Pluto we've got",
    "start": "1737600",
    "end": "1743960"
  },
  {
    "text": "Polaris we've got other people's uh best of breed open source like trivy from aquac all of that's in here and so you",
    "start": "1743960",
    "end": "1750960"
  },
  {
    "text": "get a lot more than just efficiency and cost but we're going to focus on that because we're talking about Goldilocks today um so here we see on the",
    "start": "1750960",
    "end": "1758080"
  },
  {
    "text": "efficiency tab we've got uh we first see a cluster comparison where we get these cool little box charts that show us",
    "start": "1758080",
    "end": "1764399"
  },
  {
    "text": "what's our available capacity what's our CPU requests what's our CPU limits and",
    "start": "1764399",
    "end": "1770960"
  },
  {
    "text": "how much of that are we actually using we can see here our utilization is actually far lower than our requests and our limits um so this is a little bit",
    "start": "1770960",
    "end": "1778240"
  },
  {
    "text": "more detailed view than what Goldilocks gives you uh into that and then we can also view Memory as well not just CPU",
    "start": "1778240",
    "end": "1785679"
  },
  {
    "text": "because obviously there's two sides to this story and then if you um you can either put in just a kind of a rough",
    "start": "1785679",
    "end": "1793320"
  },
  {
    "text": "cost per node that you think you have for your cluster and we'll calculate these cost estimates or you can um pull",
    "start": "1793320",
    "end": "1800440"
  },
  {
    "text": "in your AWS billing data into this and actually get a direct correlation to your CPU and memory costs uh calculated",
    "start": "1800440",
    "end": "1808120"
  },
  {
    "text": "for each cluster over time uh and so we can see our utilization percentages and",
    "start": "1808120",
    "end": "1813399"
  },
  {
    "text": "our cost for all of our different clusters and then if you want to look at it you know deeper than the cluster",
    "start": "1813399",
    "end": "1819679"
  },
  {
    "text": "level we get into this workloads tab where we dig into a single cluster uh on this workloads tab and we're going to",
    "start": "1819679",
    "end": "1826440"
  },
  {
    "text": "see uh all of our different workloads so say we want to filter down to you know just",
    "start": "1826440",
    "end": "1832159"
  },
  {
    "text": "deployments uh and we want to look at a specific namespace I don't know what the cranky",
    "start": "1832159",
    "end": "1838240"
  },
  {
    "text": "Nash name space is but I'm super curious now but anyway we'll take a look you",
    "start": "1838240",
    "end": "1845039"
  },
  {
    "text": "know we can do our that seems like an autogenerated name that's what it is um",
    "start": "1845039",
    "end": "1850320"
  },
  {
    "text": "we take a look at just our Prometheus Nam space here uh and see our our relative total costs our relative daily",
    "start": "1850320",
    "end": "1858200"
  },
  {
    "text": "costs um and then we have additional quality of services that we've defined",
    "start": "1858200",
    "end": "1864080"
  },
  {
    "text": "um to give you different types of recommendations so we already talked about guaranteed urable but now um you",
    "start": "1864080",
    "end": "1870159"
  },
  {
    "text": "know where where we add a little bit of value on that is we say you know maybe this is a critical workload and you want",
    "start": "1870159",
    "end": "1875799"
  },
  {
    "text": "to make sure it never ever ever gets oom killed well let's give it a little bit extra so we're going to bump that",
    "start": "1875799",
    "end": "1881320"
  },
  {
    "text": "recommendation up by a certain percentage or um you know limited and",
    "start": "1881320",
    "end": "1886799"
  },
  {
    "text": "maybe we we don't care about so we just want to drop it all the way down and just let it get killed all day long that's fine it's not going to bother us",
    "start": "1886799",
    "end": "1893360"
  },
  {
    "text": "so we add that on as well as you know what what do we think it's going to cost to make this change so sometimes you",
    "start": "1893360",
    "end": "1900799"
  },
  {
    "text": "need to give things more resources and your costs go up and that's okay but you maybe want to know what that's going to",
    "start": "1900799",
    "end": "1906440"
  },
  {
    "text": "look like before you make that change so we have all those recommendations here uh in one good place and then we can you",
    "start": "1906440",
    "end": "1913679"
  },
  {
    "text": "know slice and dice this different ways we've got ating by namespace so we can just see what different namespaces are",
    "start": "1913679",
    "end": "1920240"
  },
  {
    "text": "costing us and what our recommendations are going to cost us and then we can",
    "start": "1920240",
    "end": "1925519"
  },
  {
    "text": "start to aggregate by labeled too so if you have a labeling scheme you know you want to look at your app. kubernetes",
    "start": "1925519",
    "end": "1931200"
  },
  {
    "text": "doio name we can filter by that as well um so just a lot more feature Rich",
    "start": "1931200",
    "end": "1937440"
  },
  {
    "text": "dashboard multiple clusters um and then you know couple",
    "start": "1937440",
    "end": "1942559"
  },
  {
    "text": "that with the fact that we have automation rules and all this other good stuff there a lot going on here so I",
    "start": "1942559",
    "end": "1947799"
  },
  {
    "text": "definitely don't have time to talk about it all but that's what we got",
    "start": "1947799",
    "end": "1954000"
  },
  {
    "text": "cool um yeah so that's that's pretty awesome Goldilocks um seems like it'd be",
    "start": "1954000",
    "end": "1959960"
  },
  {
    "text": "super useful um certainly I feel like one of the places where people tend to struggle with their clusters is setting",
    "start": "1959960",
    "end": "1966919"
  },
  {
    "text": "uh their resource limits and requests um either not doing it at all or um you know struggling with figuring out where",
    "start": "1966919",
    "end": "1973760"
  },
  {
    "text": "the sweet spot is and so seems like uh gold elocks is a a good tool for that",
    "start": "1973760",
    "end": "1979639"
  },
  {
    "text": "yeah I like to think so we get good feedback from the community so I hope I hope other folks",
    "start": "1979639",
    "end": "1985840"
  },
  {
    "text": "find it useful as well yeah all right all right I think that",
    "start": "1985840",
    "end": "1991840"
  },
  {
    "text": "does it for our I believe so um we do have a uh",
    "start": "1991840",
    "end": "1999279"
  },
  {
    "text": "white paper that you can download about kubernetes misconfigurations uh the link is here on",
    "start": "1999279",
    "end": "2005880"
  },
  {
    "text": "this slide which I will up for a few seconds in case folks want to write it down uh and then I believe you'll get an",
    "start": "2005880",
    "end": "2013039"
  },
  {
    "text": "email with a link to that as well as well as the uh recording here which I think is only being sent out by email",
    "start": "2013039",
    "end": "2018880"
  },
  {
    "text": "because we had technical challenges today so thank you all for watching and",
    "start": "2018880",
    "end": "2024320"
  },
  {
    "text": "listening and and hope have a great rest of your day bye",
    "start": "2024320",
    "end": "2030799"
  },
  {
    "text": "everyone",
    "start": "2031279",
    "end": "2034279"
  }
]