[
  {
    "text": "thanks for making it to today's talk last day after lunch so thanks um I uh",
    "start": "280",
    "end": "7759"
  },
  {
    "text": "in this talk I would be um sharing a story with you about my experience and",
    "start": "7759",
    "end": "13679"
  },
  {
    "text": "my teen's experience on writing cuberes operator What were the challenges that",
    "start": "13679",
    "end": "19199"
  },
  {
    "text": "we faced and how we uh overcomed it so the content of this talk would look",
    "start": "19199",
    "end": "25599"
  },
  {
    "text": "something like this um I'll be sharing the problem context uh where we started",
    "start": "25599",
    "end": "31320"
  },
  {
    "text": "off with what were the um alternative Solutions apart from writing cuberes",
    "start": "31320",
    "end": "37640"
  },
  {
    "text": "operator for us how they did not work for us and how we transitioned into",
    "start": "37640",
    "end": "42920"
  },
  {
    "text": "writing a cuber 8s operator uh this was just the half story of finding the right",
    "start": "42920",
    "end": "49120"
  },
  {
    "text": "kind of solution for us but the technical challenges started coming after uh we um started implementing the",
    "start": "49120",
    "end": "56920"
  },
  {
    "text": "operator and making it productionize uh we would also go ahead uh and see",
    "start": "56920",
    "end": "63640"
  },
  {
    "text": "like what are the good resources that are already available uh which you can",
    "start": "63640",
    "end": "69000"
  },
  {
    "text": "look into if you want some additional uh resource uh resources or you are just",
    "start": "69000",
    "end": "74920"
  },
  {
    "text": "starting out in the space um apart from that we will uh do the recap of what we",
    "start": "74920",
    "end": "81320"
  },
  {
    "text": "looked uh what we will look today and any questions that you guys have uh feel",
    "start": "81320",
    "end": "88040"
  },
  {
    "text": "free to stop me in between if you you have some questions and something is not clear so yeah let's understand what kind",
    "start": "88040",
    "end": "96720"
  },
  {
    "text": "of application uh I and my team were working on um the application would",
    "start": "96720",
    "end": "102880"
  },
  {
    "text": "process lots of messages in a day and it would be of multiple kinds right I",
    "start": "102880",
    "end": "109439"
  },
  {
    "text": "cannot go into the details or architecture of the application but uh",
    "start": "109439",
    "end": "114520"
  },
  {
    "text": "you can um understand something like uh a message processor right right and it",
    "start": "114520",
    "end": "120920"
  },
  {
    "text": "could process the events ranging from a simple OTP message to some email content",
    "start": "120920",
    "end": "127920"
  },
  {
    "text": "that the marketing team would use right and once these messages would be processed these would be uh send to uh",
    "start": "127920",
    "end": "137040"
  },
  {
    "text": "different business applications so application who wants to send the marketing uh uh content right or wants",
    "start": "137040",
    "end": "145000"
  },
  {
    "text": "to uh uh process uh the uh credit card transactional statements so such kind of",
    "start": "145000",
    "end": "152560"
  },
  {
    "text": "applications would consume these events based on category and configuration so",
    "start": "152560",
    "end": "158319"
  },
  {
    "text": "maybe an uh transactional statement would want to read a message uh",
    "start": "158319",
    "end": "164680"
  },
  {
    "text": "immediately and even if the communication between the uh between my",
    "start": "164680",
    "end": "170159"
  },
  {
    "text": "application and that business application fails they want it to be retried immediately uh for 10 times",
    "start": "170159",
    "end": "176360"
  },
  {
    "text": "right but that might not be the case with uh notifications uh Team uh who",
    "start": "176360",
    "end": "182519"
  },
  {
    "text": "wants to read marketing messages and all right now uh these configurations that",
    "start": "182519",
    "end": "187879"
  },
  {
    "text": "we would manage uh in throughout the presentation I would refer to as States",
    "start": "187879",
    "end": "193120"
  },
  {
    "text": "so there were around 15 to 20 such Fields would which would contribute to a",
    "start": "193120",
    "end": "198920"
  },
  {
    "text": "state and we were managing it in a centralized way so one team would manage",
    "start": "198920",
    "end": "205120"
  },
  {
    "text": "all these states right and these states would be actually U replicated in",
    "start": "205120",
    "end": "212680"
  },
  {
    "text": "multiple zones for multiple tenants so uh only my testing Zone would have like",
    "start": "212680",
    "end": "218799"
  },
  {
    "text": "somewhere around 5 to 10 tenants which would be uh growing based on the business needs right now uh mainly we",
    "start": "218799",
    "end": "228599"
  },
  {
    "text": "say that a team would be managing it but behind the scenes there was a SRE who",
    "start": "228599",
    "end": "234000"
  },
  {
    "text": "would manage it and our s is Anand Anand would on a day apart from from handling",
    "start": "234000",
    "end": "240360"
  },
  {
    "text": "incidents and uh uh other issues he would just manage 15 to 20 tickets on",
    "start": "240360",
    "end": "247560"
  },
  {
    "text": "good days and on bad days he would like take 50 plus tickets at night if there",
    "start": "247560",
    "end": "253360"
  },
  {
    "text": "is any specific uh requirement from the business application right so the state",
    "start": "253360",
    "end": "259600"
  },
  {
    "text": "of the entire uh operations was not was not super good and uh Anand was stressed",
    "start": "259600",
    "end": "267759"
  },
  {
    "text": "out we needed a solution which could help out Anand uh uh lessen his burden",
    "start": "267759",
    "end": "275960"
  },
  {
    "text": "uh which would ensure that security is not compromised which would help us move",
    "start": "275960",
    "end": "282160"
  },
  {
    "text": "from this centralized solution uh to a decentralized solution and hopefully uh",
    "start": "282160",
    "end": "289400"
  },
  {
    "text": "it could be done in an automated way right um so these were the solutions",
    "start": "289400",
    "end": "295919"
  },
  {
    "text": "that we tried we thought okay maybe giving a helping and to Anand would help us out but given I as I mentioned",
    "start": "295919",
    "end": "304199"
  },
  {
    "text": "earlier that uh transferring the knowledge of uh what our application was",
    "start": "304199",
    "end": "310680"
  },
  {
    "text": "doing was uh pretty complex and the time",
    "start": "310680",
    "end": "316320"
  },
  {
    "text": "we invested in training a new uh resource was not uh was not yielding a",
    "start": "316320",
    "end": "321960"
  },
  {
    "text": "satisfactory result right so we thought maybe okay we can uh try out some",
    "start": "321960",
    "end": "327080"
  },
  {
    "text": "automated Solutions uh which tried to build a Jenkins Pipeline and a UI which",
    "start": "327080",
    "end": "333160"
  },
  {
    "text": "could uh just decentralize it and we could just give it to uh the business uh",
    "start": "333160",
    "end": "338720"
  },
  {
    "text": "application owners that you have your parameters manage them and we don't want",
    "start": "338720",
    "end": "344919"
  },
  {
    "text": "to like uh uh do that repetitive task for you right but that that led to uh",
    "start": "344919",
    "end": "352520"
  },
  {
    "text": "issues that we were not able to uh properly do the authentication and",
    "start": "352520",
    "end": "358840"
  },
  {
    "text": "auditing of uh the resource changes that were happening uh we had lot of duplication",
    "start": "358840",
    "end": "365880"
  },
  {
    "text": "so what we did was to offload the burden from Anon to other teams uh this did not",
    "start": "365880",
    "end": "373639"
  },
  {
    "text": "look like a solution that would help us in a long run so that is when we",
    "start": "373639",
    "end": "379599"
  },
  {
    "text": "transitioned into writing a kubernetes operator um I would emphasize here that",
    "start": "379599",
    "end": "385120"
  },
  {
    "text": "when we started writing an operator we were not the team who would know a lot about kubernetes or writing the operator",
    "start": "385120",
    "end": "393880"
  },
  {
    "text": "and uh like we just knew that what we wanted to do what were our requirements",
    "start": "393880",
    "end": "399960"
  },
  {
    "text": "and how it could roughly be solved with the operator we were trying to manage the states we were doing some repetitive",
    "start": "399960",
    "end": "408000"
  },
  {
    "text": "task all along we knew that we could easily convert our problem into a",
    "start": "408000",
    "end": "414000"
  },
  {
    "text": "declarative model we researched a bit and found that none of the uh existing",
    "start": "414000",
    "end": "420199"
  },
  {
    "text": "controllers available could solve our problem and the mistake that we've made",
    "start": "420199",
    "end": "426680"
  },
  {
    "text": "or the in accurate assumptions that we made were um uh that there wouldn't be",
    "start": "426680",
    "end": "433599"
  },
  {
    "text": "much learning curve for us or there wouldn't be uh much resource overhead",
    "start": "433599",
    "end": "439280"
  },
  {
    "text": "which uh we found out that uh caused uh the issue to uh us later",
    "start": "439280",
    "end": "446879"
  },
  {
    "text": "on so uh like we uh once we knew okay we are going with the cuberes operator",
    "start": "446879",
    "end": "453520"
  },
  {
    "text": "approach we started out uh with uh finalizing what our crds would look like",
    "start": "453520",
    "end": "460360"
  },
  {
    "text": "right and uh like just writing a boiler",
    "start": "460360",
    "end": "465720"
  },
  {
    "text": "plate code with those crds or custom resource definitions uh using the uh",
    "start": "465720",
    "end": "472159"
  },
  {
    "text": "Cube Builder framework um if anyone of you is looking to write you can you guys",
    "start": "472159",
    "end": "477400"
  },
  {
    "text": "can choose based like the framework B based on your use case and um uh uh",
    "start": "477400",
    "end": "484080"
  },
  {
    "text": "feasibility uh we wrote some uh basic custom logic and",
    "start": "484080",
    "end": "489520"
  },
  {
    "text": "validations uh based on our use cases and then we tested it in local",
    "start": "489520",
    "end": "496479"
  },
  {
    "text": "environments how many of you are aware of what crds or custom resource definitions",
    "start": "496479",
    "end": "503479"
  },
  {
    "text": "are okay quite a lot so just in case if someone doesn't know what a body is um",
    "start": "503479",
    "end": "510960"
  },
  {
    "text": "it's you can like Loosely uh relate it to uh something like a contract between",
    "start": "510960",
    "end": "517599"
  },
  {
    "text": "your operator and what it would read uh right so uh you can specify what kind of",
    "start": "517599",
    "end": "525839"
  },
  {
    "text": "uh Fields would be present and what kind of version your crd would use right uh",
    "start": "525839",
    "end": "531240"
  },
  {
    "text": "one of the mistakes we did as a newbie when we were starting out was not understanding the importance and uh of",
    "start": "531240",
    "end": "538399"
  },
  {
    "text": "deciding what our scope would be we were an infrastructure team so we had lots of permission and we started out with the",
    "start": "538399",
    "end": "545440"
  },
  {
    "text": "scope of cluster and we didn't realize at the time what security risks it could",
    "start": "545440",
    "end": "551640"
  },
  {
    "text": "possess and how it could uh uh be a roadblocker for us to serve a complete",
    "start": "551640",
    "end": "559279"
  },
  {
    "text": "self uh served solution to our users the second mistake that we uh made was that",
    "start": "559279",
    "end": "567959"
  },
  {
    "text": "we did not uh maintain the status of our CRS which uh blogged us into",
    "start": "567959",
    "end": "575720"
  },
  {
    "text": "understanding uh the insights of how our CRS were",
    "start": "575720",
    "end": "580959"
  },
  {
    "text": "performing getting the alerts on time and maintaining them right maintaining our application",
    "start": "580959",
    "end": "587399"
  },
  {
    "text": "stabil so uh before I move on to uh what",
    "start": "587399",
    "end": "593399"
  },
  {
    "text": "the challenges that we encountered during this process this is how uh a custom operator might work I as a user",
    "start": "593399",
    "end": "601240"
  },
  {
    "text": "might create some yaml file uh or something similar which would act as my custom resource my operator would have a",
    "start": "601240",
    "end": "609200"
  },
  {
    "text": "reconcilation loop which would keep on uh reading for any of the updates that",
    "start": "609200",
    "end": "614839"
  },
  {
    "text": "are happening in this year and try to make um my actual State uh similar to",
    "start": "614839",
    "end": "621360"
  },
  {
    "text": "what the desired State should be right and then maybe a verification um that we",
    "start": "621360",
    "end": "627120"
  },
  {
    "text": "would talk about how to do it in the later slides so yeah so like we moved on from",
    "start": "627120",
    "end": "634279"
  },
  {
    "text": "phase one where we did a basic setup of our kubernetes operator to the uh phase",
    "start": "634279",
    "end": "640440"
  },
  {
    "text": "two where we were testing and trying to see if we were able to make some uh",
    "start": "640440",
    "end": "645720"
  },
  {
    "text": "updates to our CRS and maybe crd right so we are testing with 5,000 plus CRS in",
    "start": "645720",
    "end": "653440"
  },
  {
    "text": "our prepro environment which looked much more similar to uh what my production",
    "start": "653440",
    "end": "659480"
  },
  {
    "text": "environment would look like rather than the case was with the local testing and",
    "start": "659480",
    "end": "667000"
  },
  {
    "text": "as I said earlier we were testing with the scope of cluster while we were testing it and we",
    "start": "667000",
    "end": "673480"
  },
  {
    "text": "uh reached out to multiple uh different teams who were using our uh operator we",
    "start": "673480",
    "end": "679200"
  },
  {
    "text": "realized most of the teams were not having uh the permission to access the",
    "start": "679200",
    "end": "684360"
  },
  {
    "text": "cluster scoped crds and create uh use their CRS properly uh and then we",
    "start": "684360",
    "end": "692720"
  },
  {
    "text": "explored okay like there were some security risks involved there right so we were having no other option than to",
    "start": "692720",
    "end": "700120"
  },
  {
    "text": "migrate uh our uh CRS and crd",
    "start": "700120",
    "end": "705440"
  },
  {
    "text": "uh for us this was the case but for others the case could be pretty",
    "start": "705440",
    "end": "711600"
  },
  {
    "text": "different that maybe uh you are not making some state which is Backward Compatible and you might be forced to to",
    "start": "711600",
    "end": "719079"
  },
  {
    "text": "migrate right and like for us we were also using uh Helm and Helm doesn't",
    "start": "719079",
    "end": "726480"
  },
  {
    "text": "support any upgrade or delion of crd so we were forced to uh uh like execute the",
    "start": "726480",
    "end": "734040"
  },
  {
    "text": "steps manually to update our crds now uh this is what we wanted to",
    "start": "734040",
    "end": "740480"
  },
  {
    "text": "avoid we wanted to avoid the cluster uh going down",
    "start": "740480",
    "end": "746120"
  },
  {
    "text": "and this is what exactly we faced we fac the split brain problem so while we were",
    "start": "746120",
    "end": "752000"
  },
  {
    "text": "uh upgrading our crds we later on realized that most of our CRS which",
    "start": "752000",
    "end": "757120"
  },
  {
    "text": "should have been deleted were not deleted and the entire cluster just got",
    "start": "757120",
    "end": "763279"
  },
  {
    "text": "down due to the state difference that we had uh I have a uh demo on this but I",
    "start": "763279",
    "end": "772120"
  },
  {
    "text": "don't have it in slide so if anyone requires it uh I can give it offline so",
    "start": "772120",
    "end": "778360"
  },
  {
    "text": "um this was our first lesson that any changes we make after we uh like uh go",
    "start": "778360",
    "end": "786920"
  },
  {
    "text": "to production we shouldn't be making any of the migrations as long as possible",
    "start": "786920",
    "end": "793040"
  },
  {
    "text": "and if we are actually uh planning for migration uh it should be like each and",
    "start": "793040",
    "end": "799480"
  },
  {
    "text": "every step should be thoroughly uh thought through right uh because",
    "start": "799480",
    "end": "805040"
  },
  {
    "text": "ultimately you are playing around with uh the cuberes internal system so uh try",
    "start": "805040",
    "end": "810920"
  },
  {
    "text": "to avoid it and if you are doing it just plan it uh well um apart from that one",
    "start": "810920",
    "end": "817320"
  },
  {
    "text": "mistakes that mistake we did not realize was that uh like playing around with the",
    "start": "817320",
    "end": "823839"
  },
  {
    "text": "finalizers of custom resources I would say not just custom resource don't play",
    "start": "823839",
    "end": "829760"
  },
  {
    "text": "around with any of the kubernetes finalizers you have right",
    "start": "829760",
    "end": "835920"
  },
  {
    "text": "so we were done with this we understood okay like what we shouldn't be doing uh",
    "start": "835920",
    "end": "842320"
  },
  {
    "text": "and we recovered uh soon from uh uh this problem and then we had our backups in",
    "start": "842320",
    "end": "849519"
  },
  {
    "text": "place so we were good to uh go to production once we got into production",
    "start": "849519",
    "end": "856759"
  },
  {
    "text": "we started having issues related to uh like how we get the insights and how",
    "start": "856759",
    "end": "864720"
  },
  {
    "text": "we make it fully self- served right it uh the operator was working fine we had",
    "start": "864720",
    "end": "870360"
  },
  {
    "text": "resolved our technical issues we had validations in place right but most of the people were not able to understand",
    "start": "870360",
    "end": "878440"
  },
  {
    "text": "how they would move on to the new process right of maintaining these",
    "start": "878440",
    "end": "883959"
  },
  {
    "text": "states now when I say this we had a basic documentation in place but we were",
    "start": "883959",
    "end": "892120"
  },
  {
    "text": "not having the documentation would would which would serve to different personas",
    "start": "892120",
    "end": "897360"
  },
  {
    "text": "and I think having that was the most critical part to making it self serve um",
    "start": "897360",
    "end": "903800"
  },
  {
    "text": "after we had a proper documentation we moved on from having daily like around",
    "start": "903800",
    "end": "909040"
  },
  {
    "text": "15 20 tickets to two three tickets and it was a great Savor for us later on um",
    "start": "909040",
    "end": "917800"
  },
  {
    "text": "we realized that as people were um people started using this process and as",
    "start": "917800",
    "end": "924720"
  },
  {
    "text": "Uh custom resources increased in our uh cluster uh we realized that most of",
    "start": "924720",
    "end": "931920"
  },
  {
    "text": "people were complaining uh the state difference was",
    "start": "931920",
    "end": "937040"
  },
  {
    "text": "not um getting reflected on time and",
    "start": "937040",
    "end": "942480"
  },
  {
    "text": "this was because we were not handling concurrency well for uh different like",
    "start": "942480",
    "end": "948519"
  },
  {
    "text": "for the needs of different zones so we realize okay we should have something",
    "start": "948519",
    "end": "955480"
  },
  {
    "text": "which uh makes it configurable and and with the growing tenants uh we should be",
    "start": "955480",
    "end": "962759"
  },
  {
    "text": "able to uh handle it uh well right uh we realized it later on as well",
    "start": "962759",
    "end": "970360"
  },
  {
    "text": "that because we were not having alerts on time the issues became uh critical",
    "start": "970360",
    "end": "976600"
  },
  {
    "text": "and if we had Matrix and alerts on what was the req size what was the uh lag",
    "start": "976600",
    "end": "982959"
  },
  {
    "text": "that like each what was the latency that each of the CR took to get uh uh into",
    "start": "982959",
    "end": "989560"
  },
  {
    "text": "reconcile Loop would have helped us tremendously so setting up the",
    "start": "989560",
    "end": "995160"
  },
  {
    "text": "observability in the process of maturing your operator would play a big",
    "start": "995160",
    "end": "1001480"
  },
  {
    "text": "role uh apart from that we realize that we had high latency uh we resolved the",
    "start": "1001480",
    "end": "1009519"
  },
  {
    "text": "issue of high latency but that came with the uh uh with with uh us processing lots of",
    "start": "1009519",
    "end": "1019440"
  },
  {
    "text": "CR right now with this we observed that a couple of Downstream applications that",
    "start": "1019440",
    "end": "1026438"
  },
  {
    "text": "we were having uh were actually uh not implementing rate limiting uh uh uh up",
    "start": "1026439",
    "end": "1035000"
  },
  {
    "text": "to the mark and that made uh those application go down and",
    "start": "1035000",
    "end": "1041600"
  },
  {
    "text": "uh created uh a bigger issue for us right so uh if you are having any of the",
    "start": "1041600",
    "end": "1049039"
  },
  {
    "text": "applications which is not able to uh handle these scenarios well uh then make",
    "start": "1049039",
    "end": "1055200"
  },
  {
    "text": "sure that you have configurable uh concurrency and rate limiting in place",
    "start": "1055200",
    "end": "1060799"
  },
  {
    "text": "apart from this was we also um understood that most of this overload",
    "start": "1060799",
    "end": "1068200"
  },
  {
    "text": "was coming from the stale resources so stale resources were not only using the",
    "start": "1068200",
    "end": "1074720"
  },
  {
    "text": "resources in our cluster but also making the entire process process slow so",
    "start": "1074720",
    "end": "1079960"
  },
  {
    "text": "having a systematic uh approach to cleaning up these resources on time",
    "start": "1079960",
    "end": "1086120"
  },
  {
    "text": "could lead to Greater advantages in terms of latency and uh resource uh um",
    "start": "1086120",
    "end": "1092919"
  },
  {
    "text": "saving uh then we were able to achieve this systematic uh cleanup uh",
    "start": "1092919",
    "end": "1100039"
  },
  {
    "text": "observability because we were able to maintain the status of each CR so make",
    "start": "1100039",
    "end": "1105720"
  },
  {
    "text": "sure that like initially you might not not needed but as you go to the higher zones you might uh want to make sure",
    "start": "1105720",
    "end": "1112799"
  },
  {
    "text": "that your State uh status of your CRS is in place uh and then uh in the last we",
    "start": "1112799",
    "end": "1120320"
  },
  {
    "text": "also added end to end uh testing uh which helped us uh like make sure that",
    "start": "1120320",
    "end": "1126760"
  },
  {
    "text": "our entire pipeline was not breaking uh due to any of the changes that we make",
    "start": "1126760",
    "end": "1131880"
  },
  {
    "text": "in Downstream applications so this is how we achieved uh the",
    "start": "1131880",
    "end": "1139559"
  },
  {
    "text": "stability of our kubernetes operator in um in all the uh production zones and",
    "start": "1139559",
    "end": "1146640"
  },
  {
    "text": "currently we are running this in around like five different production zones we",
    "start": "1146640",
    "end": "1151679"
  },
  {
    "text": "have with each having uh somewhere around 3 to five uh",
    "start": "1151679",
    "end": "1157600"
  },
  {
    "text": "tenant uh what I found useful in this entire Journey was were these stocks uh",
    "start": "1157600",
    "end": "1164400"
  },
  {
    "text": "why you shouldn't be writing the kubernetes operator in the first place avoiding any of",
    "start": "1164400",
    "end": "1170960"
  },
  {
    "text": "the like any of the changes like first figure out whether it's necessary for",
    "start": "1170960",
    "end": "1177120"
  },
  {
    "text": "you or not if there are other Alternatives go with it first uh else",
    "start": "1177120",
    "end": "1182600"
  },
  {
    "text": "like if you don't have just go through the checklist of uh required whatever",
    "start": "1182600",
    "end": "1189480"
  },
  {
    "text": "would be required in writing a kubernetes operator then uh bit on like what crds are and how it could be useful",
    "start": "1189480",
    "end": "1197840"
  },
  {
    "text": "for you and how not why and how not to play with your uh like uh finalizers",
    "start": "1197840",
    "end": "1204280"
  },
  {
    "text": "right uh you can go through them these are pretty good um so just recapping",
    "start": "1204280",
    "end": "1210720"
  },
  {
    "text": "through all the uh things that we went through uh first explore all the",
    "start": "1210720",
    "end": "1216520"
  },
  {
    "text": "Alternatives you have before diving into writing a kubernetes operator try to",
    "start": "1216520",
    "end": "1221919"
  },
  {
    "text": "make as accurate estimations as possible uh while you uh",
    "start": "1221919",
    "end": "1228200"
  },
  {
    "text": "plan to write a cuberes operator uh make sure that you are making correct uh",
    "start": "1228200",
    "end": "1236039"
  },
  {
    "text": "considerations when deciding on writing crds uh this could be uh this could",
    "start": "1236039",
    "end": "1242280"
  },
  {
    "text": "create a real uh big issues if you don't plan it will have a thorough",
    "start": "1242280",
    "end": "1248559"
  },
  {
    "text": "documentation for each and every Persona you have uh manage the concurrency of your",
    "start": "1248559",
    "end": "1255559"
  },
  {
    "text": "operator uh properly have effective observability before the issues become",
    "start": "1255559",
    "end": "1261400"
  },
  {
    "text": "big uh make sure that you are able to catch them do the proper resource",
    "start": "1261400",
    "end": "1267799"
  },
  {
    "text": "cleanup uh and have a systematic approach to it and make sure that you",
    "start": "1267799",
    "end": "1273200"
  },
  {
    "text": "have uh into end testing in place thank you um feel free to uh like",
    "start": "1273200",
    "end": "1280480"
  },
  {
    "text": "give any feedbacks you have on the [Applause]",
    "start": "1280480",
    "end": "1287039"
  },
  {
    "text": "slide any",
    "start": "1287039",
    "end": "1293640"
  },
  {
    "text": "questions uh hi uh great talk this is sh from University of Illinois so I'm not",
    "start": "1296600",
    "end": "1302159"
  },
  {
    "text": "able to hear sorry oh sorry how about now yeah oh yeah I'm sh from University Illinois and I'm in particular curious",
    "start": "1302159",
    "end": "1309880"
  },
  {
    "text": "about the split brain uh problem you mentioned in the talk could you elaborate on a little bit more how does",
    "start": "1309880",
    "end": "1316120"
  },
  {
    "text": "this happen what is exactly you know the split brain here how do you address that",
    "start": "1316120",
    "end": "1321360"
  },
  {
    "text": "uh so are you asking that how the split brain problem occurred for us yeah yeah",
    "start": "1321360",
    "end": "1327279"
  },
  {
    "text": "okay so as I mentioned I was we were actually running our crds with a scope",
    "start": "1327279",
    "end": "1334480"
  },
  {
    "text": "of cluster right now uh we actually ma manually went and changed all the uh uh",
    "start": "1334480",
    "end": "1343000"
  },
  {
    "text": "like required crds uh to the names space scope and we were having like in",
    "start": "1343000",
    "end": "1350000"
  },
  {
    "text": "thousands we were having our CR instances which were running with that cluster scope uh uh right so when we",
    "start": "1350000",
    "end": "1358880"
  },
  {
    "text": "moved our crd most of our uh CR instances were not moved to the name",
    "start": "1358880",
    "end": "1364799"
  },
  {
    "text": "space so we actually uh like what was expected or desired result was expecting",
    "start": "1364799",
    "end": "1371080"
  },
  {
    "text": "the scope of cluster While most of our CRS were running in the Nam space cope right and that was the the time we made",
    "start": "1371080",
    "end": "1379320"
  },
  {
    "text": "uh mistake while we were using finalizer right it did not work uh as expected and",
    "start": "1379320",
    "end": "1386159"
  },
  {
    "text": "um due to the state difference it led to uh split brain problem and actually our",
    "start": "1386159",
    "end": "1392679"
  },
  {
    "text": "entire pre-road cluster went down uh but yeah like once we fixed that we instead",
    "start": "1392679",
    "end": "1399400"
  },
  {
    "text": "of like uh playing around with the finalizers we patched the CRS and then",
    "start": "1399400",
    "end": "1405880"
  },
  {
    "text": "we were working fine like we did it for all of um uh prod zones as well like few",
    "start": "1405880",
    "end": "1412000"
  },
  {
    "text": "of the activities and it was working fine okay so it's basically because you are trying to change the scope from",
    "start": "1412000",
    "end": "1417919"
  },
  {
    "text": "Master to Nam space and yeah yeah and like it's not necessarily that uh this",
    "start": "1417919",
    "end": "1423760"
  },
  {
    "text": "was the case with us like we were trying to uh make sure that the state is uh",
    "start": "1423760",
    "end": "1430559"
  },
  {
    "text": "like the scope was migrated but it could be with any of the state that you are",
    "start": "1430559",
    "end": "1436679"
  },
  {
    "text": "trying to manage and it's not Backward Compatible so yeah like plan I think",
    "start": "1436679",
    "end": "1443400"
  },
  {
    "text": "what we learned was planning your uh crd spell is super helpful mhh okay go",
    "start": "1443400",
    "end": "1450200"
  },
  {
    "text": "thanks yeah yeah so on the crds with Helm uh",
    "start": "1450200",
    "end": "1458679"
  },
  {
    "text": "slide we ran into something similar we have uh uh we have a custom we have several custom crds internally that we",
    "start": "1458679",
    "end": "1465279"
  },
  {
    "text": "upgrade uh regularly mhm and we ran into this uh attempting to write a Helm chart",
    "start": "1465279",
    "end": "1470880"
  },
  {
    "text": "to deploy our coup Builder operator um upon some research it's actually a little misleading you can upgrade crds",
    "start": "1470880",
    "end": "1477760"
  },
  {
    "text": "with Helm absolutely uh you just have to not put them in the crd folder if you treat them",
    "start": "1477760",
    "end": "1483799"
  },
  {
    "text": "just like any other manifest they will apply and upgrade just like you would expect this is the approach that uh",
    "start": "1483799",
    "end": "1489640"
  },
  {
    "text": "several large operators uh C manager being one of them follow you just lose",
    "start": "1489640",
    "end": "1494840"
  },
  {
    "text": "the support for deletion because if you delete your CR you delete every CR as well so you can",
    "start": "1494840",
    "end": "1501720"
  },
  {
    "text": "upgrade you just have to take the risk of if I uninstall this I'm going to uninstall everything else yeah so uh uh",
    "start": "1501720",
    "end": "1508200"
  },
  {
    "text": "was it for like Helm 3 or Helm 2 uh that you explored I also uh saw that but at",
    "start": "1508200",
    "end": "1514360"
  },
  {
    "text": "the time we were using Helm to so um we had our restrictions",
    "start": "1514360",
    "end": "1519720"
  },
  {
    "text": "there what was the helm version I'm asking for you like this is recent so",
    "start": "1519720",
    "end": "1525080"
  },
  {
    "text": "this would be Helm 3 yeah okay yeah we were running Helm 2 and we had our",
    "start": "1525080",
    "end": "1530320"
  },
  {
    "text": "restrictions so yeah yeah Helm 3 it's standard yeah like they are making some",
    "start": "1530320",
    "end": "1536080"
  },
  {
    "text": "uh like they are considering other options going forward with the helm upgrade so it should be easier",
    "start": "1536080",
    "end": "1545519"
  },
  {
    "text": "yeah hi uh thanks for the session it's helpful so this operators right until",
    "start": "1545840",
    "end": "1552760"
  },
  {
    "text": "they run uh into issues they are great once you hit the kind of issues kind of",
    "start": "1552760",
    "end": "1559159"
  },
  {
    "text": "you get into all sorts of troubles as I understand so my question to you is one",
    "start": "1559159",
    "end": "1564799"
  },
  {
    "text": "you mentioned end testing right could you explain what kind of you know end to end testing that you have done and",
    "start": "1564799",
    "end": "1570919"
  },
  {
    "text": "second how did you handle the the errors right if it run successfully no issues",
    "start": "1570919",
    "end": "1576840"
  },
  {
    "text": "right when there are errors it's hard to deburg or troubleshoot yeah yeah so um",
    "start": "1576840",
    "end": "1583480"
  },
  {
    "text": "I'll start with the second question that you asked on uh how to handle right for",
    "start": "1583480",
    "end": "1588880"
  },
  {
    "text": "us we figured out three set of scenarios that we would run into one so our",
    "start": "1588880",
    "end": "1595120"
  },
  {
    "text": "operator would uh call external API and based on that it would uh like create",
    "start": "1595120",
    "end": "1602559"
  },
  {
    "text": "the states right now for us the uh there were three uh scenarios one was success",
    "start": "1602559",
    "end": "1609200"
  },
  {
    "text": "if it runs fine we are good the second was that if uh there is a error it could",
    "start": "1609200",
    "end": "1615919"
  },
  {
    "text": "be either retriable error or it won't be retriable error right if it's not",
    "start": "1615919",
    "end": "1622039"
  },
  {
    "text": "retriable error we just want to discard it and we want to make sure that the",
    "start": "1622039",
    "end": "1627399"
  },
  {
    "text": "status of what kind of error is maintained and if we are like for us we",
    "start": "1627399",
    "end": "1635440"
  },
  {
    "text": "uh were okay to retry it 10 times so if so uh when you write the operator it has",
    "start": "1635440",
    "end": "1641760"
  },
  {
    "text": "the custom logic of uh exponential back off uh so like if uh we wanted to retry",
    "start": "1641760",
    "end": "1648679"
  },
  {
    "text": "them 10 times if they were successful then good otherwise we won't retry them",
    "start": "1648679",
    "end": "1654799"
  },
  {
    "text": "so I think you can uh like play around with your uh retry logic but yeah like",
    "start": "1654799",
    "end": "1661279"
  },
  {
    "text": "having that distinction between what is Tri retriable and non- retriable is",
    "start": "1661279",
    "end": "1666440"
  },
  {
    "text": "important and for end to end testing uh so we were actually uh managing uh",
    "start": "1666440",
    "end": "1672519"
  },
  {
    "text": "multiple applications at the same time and few of the them were getting updated",
    "start": "1672519",
    "end": "1678240"
  },
  {
    "text": "pretty um quickly right so uh in the end uh what happened that while creating the",
    "start": "1678240",
    "end": "1685120"
  },
  {
    "text": "state we were calling couple of apis right for authentication and then for State creation we realized that if we",
    "start": "1685120",
    "end": "1692880"
  },
  {
    "text": "were uh playing around with those apis or those contracts we were actually",
    "start": "1692880",
    "end": "1698120"
  },
  {
    "text": "facing the issue uh with the operator because once your operator is stable or any application is stable you don't want",
    "start": "1698120",
    "end": "1704240"
  },
  {
    "text": "to touch it right and you tend to figure forget that uh something might be",
    "start": "1704240",
    "end": "1710840"
  },
  {
    "text": "causing problem so because we had alerts in place and we had like lots of uh uh",
    "start": "1710840",
    "end": "1718000"
  },
  {
    "text": "traffic uh if there would be any failure right we would get the alerts uh pretty",
    "start": "1718000",
    "end": "1725519"
  },
  {
    "text": "quickly so that is how it helped us uh like do the testing whenever we we made",
    "start": "1725519",
    "end": "1731840"
  },
  {
    "text": "changes in any of the downstream applications got it thank you helpful yeah",
    "start": "1731840",
    "end": "1739399"
  },
  {
    "text": "hey about the uh split brain um so one thing I want to bring up is um",
    "start": "1739519",
    "end": "1748000"
  },
  {
    "text": "uh the way I and we look at crds is basically we're extending the API layer",
    "start": "1748000",
    "end": "1755960"
  },
  {
    "text": "of kubernetes by introducing new domain objects right and that's what the",
    "start": "1755960",
    "end": "1761000"
  },
  {
    "text": "definitions are wouldn't it be because and if you think about it like those",
    "start": "1761000",
    "end": "1766039"
  },
  {
    "text": "attributes and those contracts are always going to be changing right um now",
    "start": "1766039",
    "end": "1771960"
  },
  {
    "text": "I know you said try not to change it but wouldn't it have been a Version Control",
    "start": "1771960",
    "end": "1778080"
  },
  {
    "text": "on the crd something that if you're doing a modification of let's say scope",
    "start": "1778080",
    "end": "1784399"
  },
  {
    "text": "changing well you could have easily just bumped the version of the crd and you're",
    "start": "1784399",
    "end": "1790240"
  },
  {
    "text": "treating it just like an API it is literally the API layer right so the new version of your API is now going to be",
    "start": "1790240",
    "end": "1797440"
  },
  {
    "text": "supported on a namespace scope versus your previous version is on a cluster scope and so your controller is now",
    "start": "1797440",
    "end": "1803440"
  },
  {
    "text": "looking at the new version of the object on the via the API right wouldn't have",
    "start": "1803440",
    "end": "1809000"
  },
  {
    "text": "that fixed maybe the split so uh for us the issue was that we wanted to manage",
    "start": "1809000",
    "end": "1815240"
  },
  {
    "text": "these states right so any of the CR instances that we had right we wanted to",
    "start": "1815240",
    "end": "1821039"
  },
  {
    "text": "make sure that if we are upgrading it so either the option was that we patch all",
    "start": "1821039",
    "end": "1826720"
  },
  {
    "text": "the CR instances that were present to use the like upgraded crd version right",
    "start": "1826720",
    "end": "1836039"
  },
  {
    "text": "uh we thought like that wasn't a good option for us to go ahead and that is",
    "start": "1836039",
    "end": "1841679"
  },
  {
    "text": "why we had to migrate so we did consider moving the version but uh that was not",
    "start": "1841679",
    "end": "1849080"
  },
  {
    "text": "useful for this youth case um the other thing is what I'm trying to look at is",
    "start": "1849080",
    "end": "1855159"
  },
  {
    "text": "would there be because um what we do like in a normal microservice development right is you have a request",
    "start": "1855159",
    "end": "1863799"
  },
  {
    "text": "ID um for requests right um normally like a uuid that gets passed on and then",
    "start": "1863799",
    "end": "1869679"
  },
  {
    "text": "you use a context object throughout to know um how do you correlate that inside",
    "start": "1869679",
    "end": "1875440"
  },
  {
    "text": "your logs right for debugging um when it comes to Again The Operators and",
    "start": "1875440",
    "end": "1881799"
  },
  {
    "text": "everything again we're going through the kubernetes apis right so assumably if",
    "start": "1881799",
    "end": "1887440"
  },
  {
    "text": "there is a request ID or an ID that's associated with that request with the",
    "start": "1887440",
    "end": "1892519"
  },
  {
    "text": "crud action that's happening against the object do you know if there is a way we",
    "start": "1892519",
    "end": "1897880"
  },
  {
    "text": "can grab that inside like the reconciliation inside the controller so that we can have that inside the context",
    "start": "1897880",
    "end": "1904120"
  },
  {
    "text": "object um pass through the execution of business logic and that way we're",
    "start": "1904120",
    "end": "1909720"
  },
  {
    "text": "actually storing it in logs uh and standard out so that when there's the request comes in on that object we we",
    "start": "1909720",
    "end": "1917279"
  },
  {
    "text": "have an Associated correlation ID that we can then track if there's a failure",
    "start": "1917279",
    "end": "1922559"
  },
  {
    "text": "or what what not uh does that make sense uh I couldn't actually follow it",
    "start": "1922559",
    "end": "1928799"
  },
  {
    "text": "entirely so is it that you are asking for a particular uh request are we able",
    "start": "1928799",
    "end": "1934679"
  },
  {
    "text": "to follow what are the errors yeah uh and this request is actually the CR",
    "start": "1934679",
    "end": "1940320"
  },
  {
    "text": "right is it yeah I mean you do the request for like apply right either it's a create update or delete m of a ob a CR",
    "start": "1940320",
    "end": "1948679"
  },
  {
    "text": "object right so again that request is literally an API call that's happening right now through the cube cuddle or",
    "start": "1948679",
    "end": "1955880"
  },
  {
    "text": "what have you right um now that's going to come and go inside the controller's",
    "start": "1955880",
    "end": "1961120"
  },
  {
    "text": "reconciliation right and then gets picked up and um do you know if there's",
    "start": "1961120",
    "end": "1966320"
  },
  {
    "text": "like a request ID if there's an ID of some sort for that request that we can use as a correlation ID in our logs cuz",
    "start": "1966320",
    "end": "1975360"
  },
  {
    "text": "when you go inside the reconciliation right we're logging what's happening and those are either it's kubernetes logs or",
    "start": "1975360",
    "end": "1982320"
  },
  {
    "text": "it's a log Rus that you're using and you're sending that onto like a centralized logging right if we have",
    "start": "1982320",
    "end": "1989240"
  },
  {
    "text": "that request we can use it as a correlation so that if anything does happen right inside our Central log we",
    "start": "1989240",
    "end": "1996440"
  },
  {
    "text": "can always refer to it I don't know if you guys looked into that or not I'm not",
    "start": "1996440",
    "end": "2001679"
  },
  {
    "text": "pretty sure about the entire like I'm not sure about the question itself uh well I I just wanted to know if there's",
    "start": "2001679",
    "end": "2008039"
  },
  {
    "text": "a request ID um that you knew about that comes down into the reconciliation or",
    "start": "2008039",
    "end": "2014279"
  },
  {
    "text": "not uh yeah so like uh the uh the CR name that were we were using that is",
    "start": "2014279",
    "end": "2021600"
  },
  {
    "text": "what we were using to actually search for any of the errors that would come in",
    "start": "2021600",
    "end": "2026880"
  },
  {
    "text": "the logs so uh for us at least that did solve our problem okay so the name the",
    "start": "2026880",
    "end": "2033919"
  },
  {
    "text": "CR name itself and we had the so the name of uh what our uh like state name",
    "start": "2033919",
    "end": "2042320"
  },
  {
    "text": "was right like each state had a unique ID as well right so uh the CR name was",
    "start": "2042320",
    "end": "2050398"
  },
  {
    "text": "also similar to it so we were pretty well uh able to like actually follow the",
    "start": "2050399",
    "end": "2056280"
  },
  {
    "text": "entire trace of like if it's going into reconciliation Loop uh how many times",
    "start": "2056280",
    "end": "2061480"
  },
  {
    "text": "it's going into reconciliation Loop and if there are any uh Downstream um",
    "start": "2061480",
    "end": "2068158"
  },
  {
    "text": "errors that we encounter okay thank you thank you",
    "start": "2068159",
    "end": "2073760"
  },
  {
    "text": "yeah um any other",
    "start": "2073839",
    "end": "2078520"
  },
  {
    "text": "questions okay thank",
    "start": "2079079",
    "end": "2083320"
  },
  {
    "text": "you",
    "start": "2086240",
    "end": "2089240"
  }
]