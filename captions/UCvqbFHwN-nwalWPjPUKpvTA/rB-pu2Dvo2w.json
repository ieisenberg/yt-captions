[
  {
    "text": "thanks everyone for being here today in this quote unquote advanced track for",
    "start": "520",
    "end": "6080"
  },
  {
    "text": "cube day uh I'm naven and I'm going to be talking on the topic of securing your",
    "start": "6080",
    "end": "11719"
  },
  {
    "text": "kubernetes Empire with open policy agent and Rego uh but before we get started just a",
    "start": "11719",
    "end": "17240"
  },
  {
    "text": "quick show of hands how many people here know or have heard of open policy agent oh perfect lots of folks here how",
    "start": "17240",
    "end": "24680"
  },
  {
    "text": "many folks you heard of opa gatekeeper perfect okay and uh how many",
    "start": "24680",
    "end": "30080"
  },
  {
    "text": "will actually use Opa gatekeeper in production today okay much fewer hands perfect so",
    "start": "30080",
    "end": "38760"
  },
  {
    "text": "cool we can get started uh I'm naven I go online as madmax uh I did my masters",
    "start": "38760",
    "end": "43840"
  },
  {
    "text": "from TripIt Bangalore and I currently work at this company called ops I spent the first part of my life purely on the",
    "start": "43840",
    "end": "50719"
  },
  {
    "text": "developer side of things and now I've moved into the Ops side of things and we built Ops tooling so I keep telling my",
    "start": "50719",
    "end": "58120"
  },
  {
    "text": "CTO who's a career devops guy that I spend the first half of my career yelling at my Ops guys for being too",
    "start": "58120",
    "end": "63600"
  },
  {
    "text": "slow and now I spend the second half yelling at my Engineers for being too fast and not being stable",
    "start": "63600",
    "end": "69280"
  },
  {
    "text": "enough so quick thing about opsource we basically build open source tool chains",
    "start": "69280",
    "end": "75159"
  },
  {
    "text": "uh we take op Source tool chains and build manage Stacks out of them so we have like an observability chain we have",
    "start": "75159",
    "end": "80520"
  },
  {
    "text": "a deployment stack we have aen which is a generative AI based devop scop pilot",
    "start": "80520",
    "end": "85560"
  },
  {
    "text": "and we also do a couple of manage Solutions uh so if anyone's interested in chatting about this later happy to",
    "start": "85560",
    "end": "90600"
  },
  {
    "text": "talk about this so let's quickly get into the agenda right I think the goal of this uh",
    "start": "90600",
    "end": "97880"
  },
  {
    "text": "talk is we talk a little bit about policy as code uh we'll talk about Opa we'll talk about Rego uh we'll talk",
    "start": "97880",
    "end": "103680"
  },
  {
    "text": "about how to use Opa and since lots of folks raise your hands we'll kind of rush through this after this we'll focus",
    "start": "103680",
    "end": "109520"
  },
  {
    "text": "on the meat of the topic which is Opa Gateway and kubernetes and how we actually use this both within our",
    "start": "109520",
    "end": "115320"
  },
  {
    "text": "company as well as externally we'll go through a few use cases um through this",
    "start": "115320",
    "end": "120799"
  },
  {
    "text": "thing we'll stop at two points to actually go through some code and do a few demos as well and uh yeah we'll also",
    "start": "120799",
    "end": "126600"
  },
  {
    "text": "then at the end we'll actually touch a little bit on the best practices for policy s",
    "start": "126600",
    "end": "132200"
  },
  {
    "text": "code so first things first right like how do you ensure security compliance requirements today and this is something that is like",
    "start": "133080",
    "end": "140800"
  },
  {
    "text": "it's always been something that I've always wondered especially when I was on the dev side of things because it was a",
    "start": "140800",
    "end": "146519"
  },
  {
    "text": "completely opaque process for me right it's a it's always been a process where you go to the Ops guy you raise a",
    "start": "146519",
    "end": "153160"
  },
  {
    "text": "request in some cases in a bigger company would Raise A J you say this is the access that I want this is what I want my application to be able to access",
    "start": "153160",
    "end": "160519"
  },
  {
    "text": "and then a few days later you get an update saying hey yeah it should work can you test out now but that opaque",
    "start": "160519",
    "end": "167640"
  },
  {
    "text": "pain of that opaque pain has always been problematic for me especially coming from the developer side of things and",
    "start": "167640",
    "end": "173040"
  },
  {
    "text": "then now when I started working on the op side of things it kind of became very Hazard as well right so this is kind of",
    "start": "173040",
    "end": "179400"
  },
  {
    "text": "a policy polics code starts coming in as a concept so basically what policy as code allows you to do and anyone who's like",
    "start": "179400",
    "end": "186239"
  },
  {
    "text": "worked with any every anything as code right Star as code as they call it will",
    "start": "186239",
    "end": "191280"
  },
  {
    "text": "understand like why policy as code matters because it kind of allows you to have a centralized place for your",
    "start": "191280",
    "end": "196519"
  },
  {
    "text": "policies uh it allows you to shift left I don't like that phrase shift left it's a little too catch phrasy in my opinion",
    "start": "196519",
    "end": "202239"
  },
  {
    "text": "but basically it says like you move your compliance closer to where the development is happening you have way",
    "start": "202239",
    "end": "207680"
  },
  {
    "text": "more visibility especially if you have like something where you integrate with Git then everyone kind of has visibility",
    "start": "207680",
    "end": "213200"
  },
  {
    "text": "into what your policies are where they set up where they are updated both your Ops and your Dev teams can actually work",
    "start": "213200",
    "end": "218920"
  },
  {
    "text": "together in order to like create these policies figure out issues come up with better things it's much easier to",
    "start": "218920",
    "end": "224640"
  },
  {
    "text": "integrate with cicd and anyone who's like worked with the Ops teams know that CD kind of becomes like a superpow when",
    "start": "224640",
    "end": "230439"
  },
  {
    "text": "it like when you're talking about like policies and then finally Version Control right which always means that",
    "start": "230439",
    "end": "235519"
  },
  {
    "text": "you set up a policy it doesn't work reverting it back is as simple as a g revert you want to have historical",
    "start": "235519",
    "end": "241000"
  },
  {
    "text": "evidence of what your policies were 6 months back a year back it's very very simple for you to do right especially if",
    "start": "241000",
    "end": "246280"
  },
  {
    "text": "you have a gitops kind of workflow then having policies policy as code actually allows you to have complete complete",
    "start": "246280",
    "end": "253239"
  },
  {
    "text": "knowledge within your team within your external stakeholders for what exactly are the policies that are",
    "start": "253239",
    "end": "259959"
  },
  {
    "text": "managing so this is where Opa comes in open policy agent it's a open source",
    "start": "259959",
    "end": "265199"
  },
  {
    "text": "project which is quite obvious it's CNC have graduated back in 2021 and and it",
    "start": "265199",
    "end": "270440"
  },
  {
    "text": "does a very simple thing in my opinion but I think the way that it does it is quite nice and all that it does it says",
    "start": "270440",
    "end": "276120"
  },
  {
    "text": "that you have your policies that run within your system and it says that let's have the policy decision happen at",
    "start": "276120",
    "end": "281960"
  },
  {
    "text": "one place and the action at somewhere else right so your services do the action but all the policies are stored",
    "start": "281960",
    "end": "287080"
  },
  {
    "text": "in a single place and opa kind of does this policy analysis for you like to actually run the policy and come up with",
    "start": "287080",
    "end": "293320"
  },
  {
    "text": "a decision so you have a request you have some sort of data and you have like your rule your policy Rule and all that",
    "start": "293320",
    "end": "298680"
  },
  {
    "text": "Opa kind of does is is it says that based on this data and this request and this rule this is what the output is and",
    "start": "298680",
    "end": "304080"
  },
  {
    "text": "then your service actually takes care of the rest it runs pretty much anywhere which is again a quite cool thing about",
    "start": "304080",
    "end": "310000"
  },
  {
    "text": "Opa and again the nice thing is that can be run both as a service and as a",
    "start": "310000",
    "end": "315160"
  },
  {
    "text": "library so just to touch on that a little bit what it means as the very common mode of running Opa is you run it",
    "start": "315160",
    "end": "321000"
  },
  {
    "text": "as a HTTP service and any other service that you have right it'll actually make an HTTP request along with the request",
    "start": "321000",
    "end": "328600"
  },
  {
    "text": "query that it has to the OPA uh service which then goes through the policy which is written Rego which we'll touch upon",
    "start": "328600",
    "end": "334919"
  },
  {
    "text": "and it goes to your data and it actually returns back a response which then your service can act upon for some cases",
    "start": "334919",
    "end": "341560"
  },
  {
    "text": "especially if you're like very latency sensitive then making an additional HTTP request is something you want to avoid in which case you can actually also run",
    "start": "341560",
    "end": "347960"
  },
  {
    "text": "Opa as a as a library uh ideally if you work with go it's kind of easier but otherwise you you have like vasum run",
    "start": "347960",
    "end": "353960"
  },
  {
    "text": "times that can actually use within other languages as well where you can compile your egos into like into like vasum and",
    "start": "353960",
    "end": "360440"
  },
  {
    "text": "then run it within your library so we can actually touch a bit",
    "start": "360440",
    "end": "366840"
  },
  {
    "text": "on Rego Rego u a language it's declarative inspired by data dog data",
    "start": "366840",
    "end": "372080"
  },
  {
    "text": "log sorry uh but the nice thing about it is it actually Builds on data laog quite a bit by understanding very commonly",
    "start": "372080",
    "end": "378960"
  },
  {
    "text": "used paradigms like what we use like Json um it's declarative in the sense that it looks way more like SQL than you",
    "start": "378960",
    "end": "385160"
  },
  {
    "text": "would look like say C or C++ and it's made up of assertion that determine policy",
    "start": "385160",
    "end": "391000"
  },
  {
    "text": "decisions and the nice thing about Rego is that like SQL it is very very easy to get started with and we'll actually go",
    "start": "391000",
    "end": "397120"
  },
  {
    "text": "through a quick demo about this uh but then yeah obviously it can get unwieldy over time so we'll talk about some best",
    "start": "397120",
    "end": "402400"
  },
  {
    "text": "practices later on as well so we do a quick demo of Rego right",
    "start": "402400",
    "end": "408319"
  },
  {
    "text": "uh and we'll take the trademark example for anyone who's like not worked around with open policy agent the playground",
    "start": "408319",
    "end": "413800"
  },
  {
    "text": "that they have is a really really cool place for you to actually test stuff out so it goes at play. open policy agent",
    "start": "413800",
    "end": "420440"
  },
  {
    "text": ".org um so yeah this is basically a simple Rego policy that we have right",
    "start": "420440",
    "end": "425560"
  },
  {
    "text": "where all we are saying is that if a user is admin if like one of the users roles is admin then we kind of let them",
    "start": "425560",
    "end": "431879"
  },
  {
    "text": "through right and then we have a set of data where it says that you have a user Arch you have bat and you have Chu and",
    "start": "431879",
    "end": "439560"
  },
  {
    "text": "you have Arch as an admin bat is an employee and also a contractor and charu is an employee right so let's just take",
    "start": "439560",
    "end": "446360"
  },
  {
    "text": "a very simple example if you have a request that comes in and the users Arch and let's it",
    "start": "446360",
    "end": "452759"
  },
  {
    "text": "actually evaluates to true so what it says is allow this user to access whatever resource you're trying to",
    "start": "452759",
    "end": "458560"
  },
  {
    "text": "access so if you imagine you have a service or you have multiple Services where you say you want just admins to be",
    "start": "458560",
    "end": "463680"
  },
  {
    "text": "allowed to access that service or you have only have admins allow access to that API then having a simple Opa like",
    "start": "463680",
    "end": "469759"
  },
  {
    "text": "this or simple Rego like this will actually do this for you so the same way if you say bat for",
    "start": "469759",
    "end": "477479"
  },
  {
    "text": "example then yeah they allow automatic atically becomes false because again as per the Rego there's no Barat is not an",
    "start": "477479",
    "end": "482840"
  },
  {
    "text": "admin hence he doesn't have access right the nice thing about Rego is you can actually build on top of it with different different code blocks right so",
    "start": "482840",
    "end": "490120"
  },
  {
    "text": "another example is here right so we say allow if the user is an admin or if the",
    "start": "490120",
    "end": "495280"
  },
  {
    "text": "user is an employee but not a contractor right this is a very simplistic example you can probably just say like the user is not a contractor for this simple use",
    "start": "495280",
    "end": "501800"
  },
  {
    "text": "case but yeah just to show it if you say that the user is an admin or if the user is an employee and not a",
    "start": "501800",
    "end": "507479"
  },
  {
    "text": "contractor so in this example what should happen is bat should not have access and charu should have",
    "start": "507479",
    "end": "512800"
  },
  {
    "text": "access so you see uh the allow is false for bat and if we actually go to",
    "start": "512800",
    "end": "520279"
  },
  {
    "text": "Chu then the allow is true right it kind of becomes very simple for you because of the declarative nature of Rego to",
    "start": "520279",
    "end": "527040"
  },
  {
    "text": "actually be able to build up slightly more comp complex use cases using these simple building blocks and the nice",
    "start": "527040",
    "end": "534320"
  },
  {
    "text": "thing about Rego is you can actually go much more complex right and this is a more complex example that actually does something something like JWT decoding",
    "start": "534320",
    "end": "540560"
  },
  {
    "text": "right and this is something that practically every one of us has actually done where you have like a JWT token and",
    "start": "540560",
    "end": "546360"
  },
  {
    "text": "at the first point you have some middleware in your API where you're trying to capture that token and you're trying to say hey like is this is this",
    "start": "546360",
    "end": "552079"
  },
  {
    "text": "person allowed to perform this action right so the nice thing about like Rego and opa is that actually has like some",
    "start": "552079",
    "end": "557560"
  },
  {
    "text": "helper functions as well which do like things like JWT verification very very simply for",
    "start": "557560",
    "end": "563240"
  },
  {
    "text": "you so just to dig a little bit deeper into some of those options that you have like I mentioned you have like a bunch",
    "start": "563240",
    "end": "568760"
  },
  {
    "text": "of buil-in functions depending on whether you're using numbers Aggregates whether you're using HTTP graphql uh",
    "start": "568760",
    "end": "574440"
  },
  {
    "text": "time related functions right so for example if you want to say I only want to give access to this resource if a",
    "start": "574440",
    "end": "579760"
  },
  {
    "text": "user has been with my service for more than 30 days right it's quite easy to do policies like this without actually",
    "start": "579760",
    "end": "585440"
  },
  {
    "text": "having to manage it completely separately and again because like regos are just text files it means that you",
    "start": "585440",
    "end": "591880"
  },
  {
    "text": "can always commit it into git you can always have your giops workflows you can integrate it with cicd you can do a bunch of stuff around",
    "start": "591880",
    "end": "598120"
  },
  {
    "text": "it so let's get back to this so yeah like I",
    "start": "598120",
    "end": "603600"
  },
  {
    "text": "said at the start we spoke about Opa so far but obviously this is a cube day right so obviously you guys care about",
    "start": "603600",
    "end": "609839"
  },
  {
    "text": "kubernetes but the nice part about Opa is that Opa and kubernetes SN together",
    "start": "609839",
    "end": "614880"
  },
  {
    "text": "like a match made in heaven so earlier on when people wanted to use Opa with kubernetes the standardized workflow was",
    "start": "614880",
    "end": "620839"
  },
  {
    "text": "to run Opa as a sidecar container and then basically have your main service call the OPA side car for whatever it",
    "start": "620839",
    "end": "627880"
  },
  {
    "text": "needed again it's a a bit messy because managing a side car kind of it's it's possible to do it but it's kind of messy",
    "start": "627880",
    "end": "633760"
  },
  {
    "text": "at the same time how exactly do you manage your OS how do you bring them in as config Maps bring them as some do you",
    "start": "633760",
    "end": "638880"
  },
  {
    "text": "want to manage them as Secrets cuz in some cases you want things within your ego to be secrets so how do you manage",
    "start": "638880",
    "end": "644200"
  },
  {
    "text": "that that kind of becomes problematic so this is where this new project called Opa gatekeeper came in and opa",
    "start": "644200",
    "end": "651360"
  },
  {
    "text": "gatekeeper basically brings all the goodness of opa to the world of kubernetes so what exactly does it mean",
    "start": "651360",
    "end": "657399"
  },
  {
    "text": "it means that this is completely kubernetes native and we'll dig into that a little bit more it is backed by",
    "start": "657399",
    "end": "662800"
  },
  {
    "text": "open policy agent which means anything if you have open policy agent running outside of kubernetes and you want to use exactly the same policies for your",
    "start": "662800",
    "end": "669360"
  },
  {
    "text": "services within kubernetes you can do just that and yeah there the nice thing that I personally find useful especially when",
    "start": "669360",
    "end": "675760"
  },
  {
    "text": "we're like trying to talk to people who are trying to start on their journey of compliance is that it comes with a well-built library of common policies",
    "start": "675760",
    "end": "682600"
  },
  {
    "text": "which you can use as a starting point right and we'll go through that as well in a little bit so the reason why this",
    "start": "682600",
    "end": "688279"
  },
  {
    "text": "pre-built Library of common policies is very useful is because if someone's just starting off with compliance they always",
    "start": "688279",
    "end": "694680"
  },
  {
    "text": "say right things like don't roll your own Earth the same way always suggest people don't try to roll your own compliance policies unless you know what",
    "start": "694680",
    "end": "700720"
  },
  {
    "text": "you're doing right because it's very easy to start off saying that I'm going to build out a compliance policy that ends up being either too open or being",
    "start": "700720",
    "end": "707839"
  },
  {
    "text": "too closed which leads to a lot of work later for either the Ops Team or for or for the dev team right and that that",
    "start": "707839",
    "end": "713160"
  },
  {
    "text": "makes it like unbearable for both the op side and the dev side of things so that's why yeah this pre-build library of common policies something that's very",
    "start": "713160",
    "end": "719839"
  },
  {
    "text": "useful for folks so installation uh it's very very",
    "start": "719839",
    "end": "725120"
  },
  {
    "text": "straightforward uh simple Cube cutle apply uh there's a 3.14 joke there if anyone's interested in it uh yeah or",
    "start": "725120",
    "end": "731440"
  },
  {
    "text": "Helm which I'm I'm sure a lot of us are fans of it's literally two commands you have Opa running within your or",
    "start": "731440",
    "end": "737440"
  },
  {
    "text": "gatekeeper running within your cluster it also runs as a replica set or deployment runs as replicas so in case",
    "start": "737440",
    "end": "743639"
  },
  {
    "text": "you're running a large cluster and you need you have way more policies that you need to do you can always scale up your replicas as you right it kind of makes",
    "start": "743639",
    "end": "750120"
  },
  {
    "text": "life very very easy for you to like actually get gatekeeper up and running and uh yeah so what exactly does",
    "start": "750120",
    "end": "757560"
  },
  {
    "text": "this installation do right so when you actually create this installation when you run a Helm install or a cube CLE",
    "start": "757560",
    "end": "764600"
  },
  {
    "text": "apply what Opa is doing is it's basically creating a bunch of kubernetes resources right it obviously creates the",
    "start": "764600",
    "end": "771880"
  },
  {
    "text": "the pods for open policy agent and creates an audit part as well and you have a validating web hook and you have",
    "start": "771880",
    "end": "777639"
  },
  {
    "text": "a mutating web hook and there's a bunch of policy crds that get created right so now the nice thing about because you",
    "start": "777639",
    "end": "783639"
  },
  {
    "text": "have a web hook validating web hook and a mutating web hook basically that means that anytime you're creating a",
    "start": "783639",
    "end": "788959"
  },
  {
    "text": "kubernetes resource or you're editing a kubernetes resource it actually can that becomes a policy point for you that",
    "start": "788959",
    "end": "794240"
  },
  {
    "text": "becomes a point we can ensure compliance happens right so what exactly would that",
    "start": "794240",
    "end": "799560"
  },
  {
    "text": "mean that means that say that I want to bring in certain rules within my thing within my system irrespective of whether",
    "start": "799560",
    "end": "806120"
  },
  {
    "text": "I set up my pods using a cube CLE apply or use Argo CD or I use any other deployment framework or I use a Jenkins",
    "start": "806120",
    "end": "811880"
  },
  {
    "text": "job for for all it matters right it kind of becomes a standard uh standard interface for where compliance is going",
    "start": "811880",
    "end": "818240"
  },
  {
    "text": "to compliance checks are going to happen the nice thing about the way that this new gatekeeper works is that it",
    "start": "818240",
    "end": "824959"
  },
  {
    "text": "actually has much more F grained access right so you can actually say things like I want this policy to apply on",
    "start": "824959",
    "end": "830920"
  },
  {
    "text": "parts of a certain type on a specific name space following certain rules right which which was a little harder with the",
    "start": "830920",
    "end": "837360"
  },
  {
    "text": "earlier earlier like side car based approach that we had but yeah and we'll actually go through some examples of uh",
    "start": "837360",
    "end": "843639"
  },
  {
    "text": "how exactly this works as well so yeah now we've spoke enough",
    "start": "843639",
    "end": "851560"
  },
  {
    "text": "about we spoke enough about like how exactly gatekeeper works so let's actually see some of this in action all",
    "start": "851560",
    "end": "858440"
  },
  {
    "text": "right so here I have a cluster and uh I have gatekeeper running on it so",
    "start": "858440",
    "end": "866120"
  },
  {
    "text": "if",
    "start": "867680",
    "end": "870680"
  },
  {
    "text": "oops okay yeah this is why live demos are",
    "start": "873839",
    "end": "880480"
  },
  {
    "text": "never",
    "start": "880480",
    "end": "882759"
  },
  {
    "text": "cool okay it looks like the demo may not be working yeah so basically what uh the",
    "start": "886399",
    "end": "891440"
  },
  {
    "text": "demo what we are going to go through I can actually show you what exactly that does right so we have",
    "start": "891440",
    "end": "897480"
  },
  {
    "text": "uh a a pseudo Corp which has a bunch of policies um let's say that the policies",
    "start": "897480",
    "end": "902880"
  },
  {
    "text": "are things like a simple one which may be you only use internal registry for images right we don't want to use",
    "start": "902880",
    "end": "908680"
  },
  {
    "text": "docker.io we don't want to use qu we don't want to use anything else we only want to use internal Registries for the images that are running within our pods",
    "start": "908680",
    "end": "915560"
  },
  {
    "text": "uh the second thing is that every kubernetes resource should have a team label and everyone who's like part of a cost center in their company knows why",
    "start": "915560",
    "end": "922240"
  },
  {
    "text": "this a critical right uh because all of us have kubernetes clusters where you have a bunch of resources that no one",
    "start": "922240",
    "end": "928440"
  },
  {
    "text": "knows who owns you're paying for it because you're running machines for it it's taking up space it's taking up resources but no one really knows what",
    "start": "928440",
    "end": "935240"
  },
  {
    "text": "who who actually owns this but you don't want to terminate it because it may be running something critical all right uh",
    "start": "935240",
    "end": "940399"
  },
  {
    "text": "then you say something like every P should have explicit resource limits right and again this is something that comes in from personal experience where",
    "start": "940399",
    "end": "947759"
  },
  {
    "text": "you have someone who comes in sets up a pod that has no limits set up no request set up on it which basically means that",
    "start": "947759",
    "end": "954639"
  },
  {
    "text": "over time they have a memory leak it ends up taking all the space in your cluster and then at some point it's taking down other services that's",
    "start": "954639",
    "end": "960759"
  },
  {
    "text": "running in the cluster and you don't know why right and finally you say that no container should run at Route and this I'm not really even going to go too",
    "start": "960759",
    "end": "967079"
  },
  {
    "text": "deep and this is quite obvious why we want this to happen now in the earlier world right if you had no Opa or no Opa",
    "start": "967079",
    "end": "973199"
  },
  {
    "text": "gatekeeper then kind of it would always make it harder for you to like do this because the way you do it would be through some sort of an audit right You'",
    "start": "973199",
    "end": "979680"
  },
  {
    "text": "audit all your resources you'd spend some time you'd have someone from the Ops Team go through all your kubernetes",
    "start": "979680",
    "end": "984920"
  },
  {
    "text": "resources manually like manually or some automated tools as well available there which would run once a week once a day",
    "start": "984920",
    "end": "990120"
  },
  {
    "text": "something like that to figure out what exactly is happening uh and then you try to figure out who is who is the team",
    "start": "990120",
    "end": "995519"
  },
  {
    "text": "that owns this again for things like which every kubernetes resource should have a team label then you start hunting down which team most likely owns the",
    "start": "995519",
    "end": "1002920"
  },
  {
    "text": "service which most likely owns the spot then go to them ask them about whether they can add a label then they' say yeah",
    "start": "1002920",
    "end": "1008040"
  },
  {
    "text": "we'll do it and then they don't really do it and then you go back and forth and back and forth and I've been on both sides of this table right so I",
    "start": "1008040",
    "end": "1013240"
  },
  {
    "text": "understand the pain on both sides so this is something like that you have right",
    "start": "1013240",
    "end": "1019079"
  },
  {
    "text": "so with Opa gatekeeper it kind of becomes very straightforward so what Opa",
    "start": "1019079",
    "end": "1024240"
  },
  {
    "text": "gatekeeper does is it kind of comes up with something called a constrained template right and you can set up a bunch of constrain templates uh within",
    "start": "1024240",
    "end": "1031079"
  },
  {
    "text": "your system which basically tell you the thing at the bottom is actually the Rego that you have right so if you see at the",
    "start": "1031079",
    "end": "1037798"
  },
  {
    "text": "bottom here you it's a very simple thing all that it says is this is internal Registries only so it says that if you",
    "start": "1037799",
    "end": "1044240"
  },
  {
    "text": "have uh all your containers you take all your containers and you basically say for the that you use it has to belong to a",
    "start": "1044240",
    "end": "1050559"
  },
  {
    "text": "specific repo note that this is a very standard Rego we are not really doing we are not really telling it what the",
    "start": "1050559",
    "end": "1056640"
  },
  {
    "text": "repository is here right because this is a template at the end of the day so as you mentioned at the start Opa works",
    "start": "1056640",
    "end": "1062559"
  },
  {
    "text": "with your policy which is your ego and there's also some data that comes in and when you're using Opa gatekeeper instead",
    "start": "1062559",
    "end": "1068480"
  },
  {
    "text": "of using constraint templates will be the Rego that you have and that is the Rego code that you have which is quite straightforward but then when you",
    "start": "1068480",
    "end": "1074919"
  },
  {
    "text": "actually want to set the data that that any request has to be validated against right you create something like this so",
    "start": "1074919",
    "end": "1083200"
  },
  {
    "text": "if you notice here when you had the previous uh step we actually created a",
    "start": "1083200",
    "end": "1088360"
  },
  {
    "text": "constraint template and we actually give it a kind called internal Registries right this is a custom crd that we are",
    "start": "1088360",
    "end": "1094720"
  },
  {
    "text": "creating it's a custom custom resource uh definition so later when you want to",
    "start": "1094720",
    "end": "1101039"
  },
  {
    "text": "actually create data that you want to validate against you actually create a type you create a crd of that type right",
    "start": "1101039",
    "end": "1108400"
  },
  {
    "text": "so here I'm creating a crd of type internal Registries and I say I can tell it exactly what I want it to match so I'm",
    "start": "1108400",
    "end": "1114720"
  },
  {
    "text": "telling it just to match on pod uh the name space is are default and the parameters here is where I say the repos",
    "start": "1114720",
    "end": "1120960"
  },
  {
    "text": "is registry. cop.com all right so if you see like here we",
    "start": "1120960",
    "end": "1126480"
  },
  {
    "text": "actually have the input. parameters. repos so this is where it actually validates against right so yeah the",
    "start": "1126480",
    "end": "1133159"
  },
  {
    "text": "whole point of this is that once that you have once you have like your uh crds that been created and you have like the",
    "start": "1133159",
    "end": "1140480"
  },
  {
    "text": "crd once you have the crd the constraint template and the crd created every single API call that goes to the",
    "start": "1140480",
    "end": "1146400"
  },
  {
    "text": "constraint is actually going to get validated right so yeah this is basically like how",
    "start": "1146400",
    "end": "1153200"
  },
  {
    "text": "that workflow uh would look like uh I wish there had a demo that I had to show I had like a few lines few uh examples",
    "start": "1153200",
    "end": "1160600"
  },
  {
    "text": "that we could go through but we can actually go through so something like this right a",
    "start": "1160600",
    "end": "1165799"
  },
  {
    "text": "very simple image like this if you had a pod that you had defined like this uh let's",
    "start": "1165799",
    "end": "1171840"
  },
  {
    "text": "just say that for Simplicity we have already have the security context which means that the root is not allowed and",
    "start": "1171840",
    "end": "1177039"
  },
  {
    "text": "we have like a bunch of uh other rules that we have right so the three policies that we had set up on this cluster one",
    "start": "1177039",
    "end": "1182559"
  },
  {
    "text": "said that we don't use docker.io we don't use any custom clusters so this obviously fails that uh would fail that",
    "start": "1182559",
    "end": "1189320"
  },
  {
    "text": "the second thing is we say that any resource any part that we have cannot take more than 200 M of CPU right which",
    "start": "1189320",
    "end": "1195360"
  },
  {
    "text": "again is a very very limited thing and in this pod whoever the dev or the Ops guy has set up 500 M which means again",
    "start": "1195360",
    "end": "1200440"
  },
  {
    "text": "it's a policy violation and the third constraint that we had was that every every pod should have a team name right",
    "start": "1200440",
    "end": "1207480"
  },
  {
    "text": "every a team name as a label so now if I tried to cube cutle apply the Pod then",
    "start": "1207480",
    "end": "1213840"
  },
  {
    "text": "what would happen if Cube cut apply this yaml then what would naturally happen is we'd have three policy violations where",
    "start": "1213840",
    "end": "1219640"
  },
  {
    "text": "it would say that this pod is not going to come up because of the policy violations and it's going to get blocked",
    "start": "1219640",
    "end": "1225039"
  },
  {
    "text": "at the entrance itself right and it's going to say that yeah you don't have team name you don't have uh the image is",
    "start": "1225039",
    "end": "1230720"
  },
  {
    "text": "not from a from an approved registry and your resources are not set correctly resources above the limit that we have",
    "start": "1230720",
    "end": "1236559"
  },
  {
    "text": "set up right and just to see",
    "start": "1236559",
    "end": "1240760"
  },
  {
    "text": "what yeah so this is a simple limits configuration that we have where we say",
    "start": "1248880",
    "end": "1255120"
  },
  {
    "text": "that this is a container limit and we say that every container should have a limit where the CPU is 200 M and the memory is 1 gig right it's just",
    "start": "1255120",
    "end": "1261520"
  },
  {
    "text": "randomized numbers so because we have this as our thing uh and if you see the crd the crd is again a custom crd based",
    "start": "1261520",
    "end": "1268559"
  },
  {
    "text": "on a constraint template called KS container limits so what this means is that again because I have uh the",
    "start": "1268559",
    "end": "1273919"
  },
  {
    "text": "container limits at to 200 M I'd actually get the violation so in so let's just imagine",
    "start": "1273919",
    "end": "1279799"
  },
  {
    "text": "that I ran this against my cluster and it actually went through perfectly and then um it actually threw the violation",
    "start": "1279799",
    "end": "1284840"
  },
  {
    "text": "right the fixes for this are again quite stand for quite straightforward so I'd basically add a",
    "start": "1284840",
    "end": "1292159"
  },
  {
    "text": "team label say sop Dev I'd",
    "start": "1292159",
    "end": "1299760"
  },
  {
    "text": "have sooc cop.com and I'd have to reduce this to 200 or let's say 100 and only after this",
    "start": "1302760",
    "end": "1310600"
  },
  {
    "text": "it would actually allow me to create the Pod all right so that is kind of like how this would work um sorry about the",
    "start": "1310600",
    "end": "1316120"
  },
  {
    "text": "demo yeah like I hate live demos but yeah this always happens so we'll just move past that uh but yeah basically if",
    "start": "1316120",
    "end": "1321320"
  },
  {
    "text": "you had this that kind of allows you to actually say uh where your compliance happens right the nice thing about Opa",
    "start": "1321320",
    "end": "1328120"
  },
  {
    "text": "gatekeeper is also the fact that because you have these checks happening at the",
    "start": "1328120",
    "end": "1333440"
  },
  {
    "text": "time of application right you can actually set this up at your cicd level as well so that means that every time",
    "start": "1333440",
    "end": "1338640"
  },
  {
    "text": "you create a new yaml that you want to execute either VI Argo or via your Jenkins job or some some other workflow",
    "start": "1338640",
    "end": "1344480"
  },
  {
    "text": "that uses Cube cardle apply or ton or whatever you use internally you can become that actually becomes a compliance checkpoint for you the nice",
    "start": "1344480",
    "end": "1351840"
  },
  {
    "text": "thing again about Opa Gateway gatekeeper is that it allows you to work in two modes one is the audit mode and again",
    "start": "1351840",
    "end": "1358120"
  },
  {
    "text": "for a lot of us I think compliance is something that comes very late in our journey right compliance comes up only",
    "start": "1358120",
    "end": "1364679"
  },
  {
    "text": "after someone comes and says hey we need to do XYZ compliance right and trust me when I say this a bunch of folks working",
    "start": "1364679",
    "end": "1371080"
  },
  {
    "text": "even in very sensitive domains fintech htech with all the compliances in the world they have the sock tool and the hipas and stuff like that when it it",
    "start": "1371080",
    "end": "1378080"
  },
  {
    "text": "comes to their cluster management when it comes to Cluster compliance right that's something that they' have always been struggling with and they always come out with workarounds for how to",
    "start": "1378080",
    "end": "1384679"
  },
  {
    "text": "manage it right but the problem with like compliance is that it's always hard to do in a postf factor basis right you",
    "start": "1384679",
    "end": "1391400"
  },
  {
    "text": "always have to do it early on rather than later on but the nice thing about gatekeeper is it actually allows you to do things like have violations tagged",
    "start": "1391400",
    "end": "1398520"
  },
  {
    "text": "but not blocked right so it will actually log violations so you can say for example that oh right now in your",
    "start": "1398520",
    "end": "1403840"
  },
  {
    "text": "cluster these are your policies but right now in your cluster there are these five parts that don't follow your policies or there are these 10 images",
    "start": "1403840",
    "end": "1410159"
  },
  {
    "text": "that are not coming from Registries that you approved and then you can follow up with folks to like actually get that get that Chang right and then later move to",
    "start": "1410159",
    "end": "1416600"
  },
  {
    "text": "a actually block or deny kind of workflow that you want to do and that that segregation between like a deny and",
    "start": "1416600",
    "end": "1423159"
  },
  {
    "text": "Only log kind of makes makes gatekeeper very very useful this again something that I spoke",
    "start": "1423159",
    "end": "1429760"
  },
  {
    "text": "about at the start uh when you have Opa gatekeeper there's a bunch of uh there's a bunch of pre-built policies for a lot",
    "start": "1429760",
    "end": "1437159"
  },
  {
    "text": "of common use cas cases that you have whether you're using validation or you want to like mutate your request as well happening to the kubernetes uh to",
    "start": "1437159",
    "end": "1443640"
  },
  {
    "text": "kubernetes API both of these can be managed um with with these pre-built libraries and to anyone who's getting",
    "start": "1443640",
    "end": "1449880"
  },
  {
    "text": "started with like Opa or gatekeeper I kind of strongly suggest to use uh the gatekeeper Library as a starting point",
    "start": "1449880",
    "end": "1456240"
  },
  {
    "text": "because yeah like it has a bunch of rules that uh you will you will have come across or you'll have thought of setting up and again like the nice thing",
    "start": "1456240",
    "end": "1463279"
  },
  {
    "text": "about this is It's always open for contributors so in case you have use cases right recently we had like one of my",
    "start": "1463279",
    "end": "1468720"
  },
  {
    "text": "uh colleagues who actually contributed something to the gatekeeper Library that's based upon some of his work works that work he's doing in an e-commerce",
    "start": "1468720",
    "end": "1474760"
  },
  {
    "text": "company which kind of became a use case that is much more broad so it actually ended up becoming a contribution to the",
    "start": "1474760",
    "end": "1480559"
  },
  {
    "text": "gatekeeper Library so anyone who's looking for open source contributions who like trying to get more involved with Opa but doesn't really want to get",
    "start": "1480559",
    "end": "1486799"
  },
  {
    "text": "into the core building of the OPA Library itself the gatekeeper library is a great place to start off right because",
    "start": "1486799",
    "end": "1492440"
  },
  {
    "text": "it's primarily just around building out policies that you think can other people can gain out of",
    "start": "1492440",
    "end": "1498960"
  },
  {
    "text": "so yeah let's talk a little bit about best practices right uh as with anything else I think the kiss principle is",
    "start": "1498960",
    "end": "1504440"
  },
  {
    "text": "always your friend it's it's always easier to like start off with uh like a",
    "start": "1504440",
    "end": "1509480"
  },
  {
    "text": "simple policy and build it over time rather than start off with something that you think is all-encompassing and",
    "start": "1509480",
    "end": "1515080"
  },
  {
    "text": "ends up becoming too unwieldy very early on right the second thing deny by default is your friend again that that",
    "start": "1515080",
    "end": "1522360"
  },
  {
    "text": "very simply I think everyone in the Ops Team kind of understands why deny by default makes sense and purely speaking",
    "start": "1522360",
    "end": "1527760"
  },
  {
    "text": "from a logical side of things right it kind of makes sense to have like a policy that denies Everyone by default",
    "start": "1527760",
    "end": "1533000"
  },
  {
    "text": "and then the more lines of Rego that you have or the more lines of Corde that you have the more people have access to",
    "start": "1533000",
    "end": "1538360"
  },
  {
    "text": "whatever resource you're trying to do right so it's it's more of a common sense kind of thing but very often we see folks who try to say that hey like I",
    "start": "1538360",
    "end": "1544919"
  },
  {
    "text": "want something that everyone has access to but only I want these three people not to have access to it for whatever",
    "start": "1544919",
    "end": "1550000"
  },
  {
    "text": "reason and then they build something where it's allowed by default except you block these three people or three",
    "start": "1550000",
    "end": "1555200"
  },
  {
    "text": "roles that in 3 months time becomes I want to like block these three people and one other role and then you want to",
    "start": "1555200",
    "end": "1561840"
  },
  {
    "text": "block a few more folks and then kind of that become that rule set becomes very unwieldy so always deny by default and",
    "start": "1561840",
    "end": "1567159"
  },
  {
    "text": "even in the examples that we showed I think deny by default has always been the has been what we've used by gatekeeper again allows you to like",
    "start": "1567159",
    "end": "1574600"
  },
  {
    "text": "log policy decisions which is very nice uh because it allows your devs and your Ops teams to like do policy",
    "start": "1574600",
    "end": "1580760"
  },
  {
    "text": "replay the caveat here is unless you mutate very heavily or you have like multiple mutation web hooks within your",
    "start": "1580760",
    "end": "1586279"
  },
  {
    "text": "workflow then replaying it or getting getting like the actual request at the time it hit the gatekeeper can become a",
    "start": "1586279",
    "end": "1592919"
  },
  {
    "text": "little harder uh it can still be done but it's still a little harder but usually we kind of ask people to",
    "start": "1592919",
    "end": "1598200"
  },
  {
    "text": "understand if they actually need to use the mutating web hooks within Opa gatekeeper if not yeah like if you can",
    "start": "1598200",
    "end": "1603720"
  },
  {
    "text": "stay away from it that's always great uh the fourth bit everything has coded the",
    "start": "1603720",
    "end": "1609039"
  },
  {
    "text": "reason why like everything as scored is great again like I mentioned at the start is because everyone in our team has like has that one Ops guy who kind",
    "start": "1609039",
    "end": "1616039"
  },
  {
    "text": "of manages all your access right and we've seen this happen at companies with four people we've seen this happen with company at like 4,000 people right where",
    "start": "1616039",
    "end": "1623600"
  },
  {
    "text": "there's always that one guy who if he's on leave everything comes to a standstill for a day it may not be something critical but like a lot of",
    "start": "1623600",
    "end": "1629159"
  },
  {
    "text": "distance depend on him but when you go to having everything as scored git becomes your bus Factor right which",
    "start": "1629159",
    "end": "1634640"
  },
  {
    "text": "means and again because git is distributed it means basically all your decisions are documented everyone knows where it is everyone knows how it is",
    "start": "1634640",
    "end": "1640840"
  },
  {
    "text": "everyone knows when it came in everyone knows what it does and if you integrated with cicd it's very easy to go back revert anything that you want to do",
    "start": "1640840",
    "end": "1648760"
  },
  {
    "text": "and the final bit of this is like we have Dev we talk Ops we talk compliance we talk security and that we do devops",
    "start": "1648760",
    "end": "1656360"
  },
  {
    "text": "SEC Ops Dev SEC Ops AI Ops mlops all these Ops right but in my opinion and this is something that we have seen more",
    "start": "1656360",
    "end": "1662559"
  },
  {
    "text": "and more as we talk to more folks within the industry is that they're all just facets of the same problem right they're",
    "start": "1662559",
    "end": "1668480"
  },
  {
    "text": "all just different facets but it's just we looking at the same problem from different angles which I think is very",
    "start": "1668480",
    "end": "1674039"
  },
  {
    "text": "similar to The Five Blind Men looking at the elephant right you're all looking at the same thing but we are looking touching it in different ways so we come",
    "start": "1674039",
    "end": "1680240"
  },
  {
    "text": "up with different constraints come up with different uh different different ways of looking at it but the core thing",
    "start": "1680240",
    "end": "1685880"
  },
  {
    "text": "is that visibility is the key right and just like with the five BL guys if all of them had visibility into what everyone is seeing you kind of have very",
    "start": "1685880",
    "end": "1692120"
  },
  {
    "text": "clear vision of what what we are building out right and at the end of the day I think like having some having some",
    "start": "1692120",
    "end": "1697600"
  },
  {
    "text": "of these policies in place right kind of becomes very very easy and using something like gatekeeper and using Rego",
    "start": "1697600",
    "end": "1702640"
  },
  {
    "text": "and actually having documented your policies especially if you have it in git or somewhere where even your teams",
    "start": "1702640",
    "end": "1707840"
  },
  {
    "text": "or your compliance teams and your Ops teams can actually see what is happening becomes very powerful one final caveat",
    "start": "1707840",
    "end": "1715200"
  },
  {
    "text": "on this is like you actually want to move your policym one step higher as well right we usually look at policies",
    "start": "1715200",
    "end": "1721519"
  },
  {
    "text": "as something that either devs build out or Ops build out or the compliance team builds out but in some cases why why is",
    "start": "1721519",
    "end": "1727519"
  },
  {
    "text": "it limited at that right why can compliance not be built out by say a product manager right why can compliance",
    "start": "1727519",
    "end": "1732640"
  },
  {
    "text": "not be built out by say someone who's who's deeply working on the revenue revenue up side of things right we actually want to have that happen and",
    "start": "1732640",
    "end": "1740000"
  },
  {
    "text": "the nice thing like having by using systems like gatekeeper or Opa in general what you're allowed to do is",
    "start": "1740000",
    "end": "1745960"
  },
  {
    "text": "like actually build out tools and we actually have like tools like opal that are here um that's an that's a",
    "start": "1745960",
    "end": "1752600"
  },
  {
    "text": "Administration layer on top of opa which kind of allows you to like like open up the policy making process itself a",
    "start": "1752600",
    "end": "1759159"
  },
  {
    "text": "little bit more right so that again like reduces the the load that's on the Ops Team to create policies but you can",
    "start": "1759159",
    "end": "1766039"
  },
  {
    "text": "actually bring in other members of the team as well because end of the day yeah you don't want anything to be like bottlenecked on one single",
    "start": "1766039",
    "end": "1772000"
  },
  {
    "text": "person so yeah that's the entire talk that I had uh in case anyone's like actually interested in Opa uh we",
    "start": "1772000",
    "end": "1778919"
  },
  {
    "text": "actually have this very nice repo called awesome Opa by the folks at styra who actually built Opa um it has almost",
    "start": "1778919",
    "end": "1785880"
  },
  {
    "text": "everything that you need including a bunch of stuff that I spoke about in the talk as well and uh yeah so feel free to",
    "start": "1785880",
    "end": "1791399"
  },
  {
    "text": "check this out and the slides in case anyone's interested they are online so you can check them out and anytime if",
    "start": "1791399",
    "end": "1797440"
  },
  {
    "text": "anyone has any questions uh feedback or anything I'm available on x/ Twitter as",
    "start": "1797440",
    "end": "1802480"
  },
  {
    "text": "naven p and AD obsv as well so thank you so",
    "start": "1802480",
    "end": "1807600"
  },
  {
    "text": "much",
    "start": "1808159",
    "end": "1811159"
  }
]