[
  {
    "start": "0",
    "end": "55000"
  },
  {
    "text": "I'm not just around Krishna I'm a",
    "start": "1750",
    "end": "4300"
  },
  {
    "text": "software engineer at Volterra we're a",
    "start": "4300",
    "end": "7149"
  },
  {
    "text": "startup based out of the San Francisco",
    "start": "7149",
    "end": "9190"
  },
  {
    "text": "Bay Area and today I will be talking",
    "start": "9190",
    "end": "12670"
  },
  {
    "text": "about the work that we have done to",
    "start": "12670",
    "end": "14560"
  },
  {
    "text": "integrate on ROI with DP DK and what",
    "start": "14560",
    "end": "17199"
  },
  {
    "text": "your networking quick overview about our",
    "start": "17199",
    "end": "20589"
  },
  {
    "text": "company we are an edge services company",
    "start": "20589",
    "end": "23909"
  },
  {
    "text": "we believe that with the advent of many",
    "start": "23909",
    "end": "27759"
  },
  {
    "text": "smart connected devices and the",
    "start": "27759",
    "end": "31569"
  },
  {
    "text": "explosion of bandwidth that's going to",
    "start": "31569",
    "end": "32950"
  },
  {
    "text": "happen with 5g increasingly a lot of the",
    "start": "32950",
    "end": "35890"
  },
  {
    "text": "traffic on the Internet is going to be",
    "start": "35890",
    "end": "37300"
  },
  {
    "text": "generated at the edge and pushed",
    "start": "37300",
    "end": "38980"
  },
  {
    "text": "upstream as opposed to the early days of",
    "start": "38980",
    "end": "41710"
  },
  {
    "text": "the internet when most of the content",
    "start": "41710",
    "end": "43570"
  },
  {
    "text": "was downloaded by users from upstream so",
    "start": "43570",
    "end": "47560"
  },
  {
    "text": "that is the problem we are trying to",
    "start": "47560",
    "end": "48580"
  },
  {
    "text": "solve and towards that end we are",
    "start": "48580",
    "end": "51310"
  },
  {
    "text": "building our own infrastructure so we",
    "start": "51310",
    "end": "56830"
  },
  {
    "start": "55000",
    "end": "55000"
  },
  {
    "text": "have our own private backbone and we",
    "start": "56830",
    "end": "60130"
  },
  {
    "text": "have several edge sites on this on this",
    "start": "60130",
    "end": "62740"
  },
  {
    "text": "backbone and at each of these edge sites",
    "start": "62740",
    "end": "66610"
  },
  {
    "text": "we expect to have multiple tenants",
    "start": "66610",
    "end": "69610"
  },
  {
    "text": "connecting to the Volterra",
    "start": "69610",
    "end": "71500"
  },
  {
    "text": "infrastructure and these tenants would",
    "start": "71500",
    "end": "74740"
  },
  {
    "text": "generate a lot of traffic towards the",
    "start": "74740",
    "end": "76120"
  },
  {
    "text": "edge site and we would like to",
    "start": "76120",
    "end": "78940"
  },
  {
    "text": "selectively process some of that traffic",
    "start": "78940",
    "end": "81100"
  },
  {
    "text": "at the edge itself and in some cases we",
    "start": "81100",
    "end": "84430"
  },
  {
    "text": "want to load balance that out to servers",
    "start": "84430",
    "end": "86979"
  },
  {
    "text": "running",
    "start": "86979",
    "end": "87280"
  },
  {
    "text": "elsewhere and that could be either in",
    "start": "87280",
    "end": "89830"
  },
  {
    "text": "the public cloud or in a private cloud",
    "start": "89830",
    "end": "92320"
  },
  {
    "text": "of an enterprise voice is a big part of",
    "start": "92320",
    "end": "97630"
  },
  {
    "text": "the stack that we run on the edge site",
    "start": "97630",
    "end": "100330"
  },
  {
    "text": "and we've made some extensions to envoy",
    "start": "100330",
    "end": "103690"
  },
  {
    "text": "to support that so for cases where we",
    "start": "103690",
    "end": "107020"
  },
  {
    "text": "want to handle the traffic locally on",
    "start": "107020",
    "end": "108670"
  },
  {
    "text": "the edge site itself we've added support",
    "start": "108670",
    "end": "111400"
  },
  {
    "text": "and envoy to use JavaScript as as a",
    "start": "111400",
    "end": "114820"
  },
  {
    "text": "language for filters in addition to",
    "start": "114820",
    "end": "116350"
  },
  {
    "text": "lower and we believe that javascript is",
    "start": "116350",
    "end": "120189"
  },
  {
    "text": "much more widely used than the wall so",
    "start": "120189",
    "end": "122260"
  },
  {
    "text": "it might be preferable to write those",
    "start": "122260",
    "end": "125020"
  },
  {
    "text": "filters in in JavaScript we've also",
    "start": "125020",
    "end": "127900"
  },
  {
    "text": "added support for multiple virtual",
    "start": "127900",
    "end": "130000"
  },
  {
    "text": "networks making envoy multi-tenant and",
    "start": "130000",
    "end": "132990"
  },
  {
    "text": "we do that with",
    "start": "132990",
    "end": "135280"
  },
  {
    "text": "- networking which I'll talk about in",
    "start": "135280",
    "end": "136750"
  },
  {
    "text": "later slides and finally in this",
    "start": "136750",
    "end": "139990"
  },
  {
    "text": "scenario we expect that performance",
    "start": "139990",
    "end": "142060"
  },
  {
    "text": "would be critical and that is where DP",
    "start": "142060",
    "end": "144760"
  },
  {
    "text": "DK comes in we expect a ton of traffic",
    "start": "144760",
    "end": "148510"
  },
  {
    "text": "from from devices to the edge sites and",
    "start": "148510",
    "end": "151980"
  },
  {
    "text": "key metrics would be the number of",
    "start": "151980",
    "end": "154330"
  },
  {
    "text": "packets that you process at the ED site",
    "start": "154330",
    "end": "155920"
  },
  {
    "text": "per second and the latency of those of",
    "start": "155920",
    "end": "158709"
  },
  {
    "text": "those requests another thing I want to",
    "start": "158709",
    "end": "162940"
  },
  {
    "text": "mention is that in in our deployment on",
    "start": "162940",
    "end": "165310"
  },
  {
    "text": "why does not run as a site guard it runs",
    "start": "165310",
    "end": "168040"
  },
  {
    "text": "out as its own process inside a",
    "start": "168040",
    "end": "169450"
  },
  {
    "text": "container it gets packets from the wire",
    "start": "169450",
    "end": "171610"
  },
  {
    "text": "and if it chooses to load balance them",
    "start": "171610",
    "end": "175750"
  },
  {
    "text": "it would send them back out on the wire",
    "start": "175750",
    "end": "177040"
  },
  {
    "text": "and there are cases where it will",
    "start": "177040",
    "end": "178690"
  },
  {
    "text": "process them locally so today envoy uses",
    "start": "178690",
    "end": "186610"
  },
  {
    "start": "184000",
    "end": "184000"
  },
  {
    "text": "the kernel network stack and there are",
    "start": "186610",
    "end": "190480"
  },
  {
    "text": "some performance issues with with using",
    "start": "190480",
    "end": "192340"
  },
  {
    "text": "the kernel for networking so we have to",
    "start": "192340",
    "end": "195970"
  },
  {
    "text": "make system calls from from an",
    "start": "195970",
    "end": "197680"
  },
  {
    "text": "application and the system calls",
    "start": "197680",
    "end": "200470"
  },
  {
    "text": "typically are are quite expensive in",
    "start": "200470",
    "end": "203650"
  },
  {
    "text": "addition to that whenever we transmit or",
    "start": "203650",
    "end": "207040"
  },
  {
    "text": "receive packets there are interrupts and",
    "start": "207040",
    "end": "209100"
  },
  {
    "text": "that again is a drag on performance we",
    "start": "209100",
    "end": "213670"
  },
  {
    "text": "have to copy data between between user",
    "start": "213670",
    "end": "215590"
  },
  {
    "text": "space applications and the kernel and",
    "start": "215590",
    "end": "217799"
  },
  {
    "text": "that again that again hits performance",
    "start": "217799",
    "end": "220090"
  },
  {
    "text": "and there are also context switches",
    "start": "220090",
    "end": "223230"
  },
  {
    "text": "especially when you're blocking on i/o",
    "start": "223230",
    "end": "225040"
  },
  {
    "text": "and you need to be switched back in",
    "start": "225040",
    "end": "228269"
  },
  {
    "text": "there are overheads associated with that",
    "start": "228269",
    "end": "230560"
  },
  {
    "text": "too so the net result of all of this is",
    "start": "230560",
    "end": "234430"
  },
  {
    "text": "that with a kernel based application we",
    "start": "234430",
    "end": "236950"
  },
  {
    "text": "can process a few hundred thousand",
    "start": "236950",
    "end": "238269"
  },
  {
    "text": "packets per second and not all of that",
    "start": "238269",
    "end": "242680"
  },
  {
    "text": "can be attributed to the overhead of the",
    "start": "242680",
    "end": "245049"
  },
  {
    "text": "TCP stack itself there's all this",
    "start": "245049",
    "end": "247390"
  },
  {
    "text": "additional infrastructure that's around",
    "start": "247390",
    "end": "249220"
  },
  {
    "text": "the network stack system calls",
    "start": "249220",
    "end": "251019"
  },
  {
    "text": "interrupts context switches and all of",
    "start": "251019",
    "end": "252820"
  },
  {
    "text": "that that is what contributes to the",
    "start": "252820",
    "end": "256510"
  },
  {
    "text": "bulk of the overhead there have been",
    "start": "256510",
    "end": "258100"
  },
  {
    "text": "papers which have showed that the",
    "start": "258100",
    "end": "259570"
  },
  {
    "text": "overhead of TCP itself is not as much",
    "start": "259570",
    "end": "262409"
  },
  {
    "text": "compared to these other additional",
    "start": "262409",
    "end": "264370"
  },
  {
    "text": "overheads that we have",
    "start": "264370",
    "end": "266970"
  },
  {
    "text": "so that is where DP DK comes in so DP DK",
    "start": "266970",
    "end": "271060"
  },
  {
    "start": "270000",
    "end": "270000"
  },
  {
    "text": "stands for data plane development kit",
    "start": "271060",
    "end": "272770"
  },
  {
    "text": "it's a set of libraries that was",
    "start": "272770",
    "end": "275950"
  },
  {
    "text": "originally developed at Intel and it has",
    "start": "275950",
    "end": "279070"
  },
  {
    "text": "since been open sourced and there's a",
    "start": "279070",
    "end": "281560"
  },
  {
    "text": "pretty healthy community of developers",
    "start": "281560",
    "end": "283600"
  },
  {
    "text": "working on TP DK and the design goal of",
    "start": "283600",
    "end": "288100"
  },
  {
    "text": "DP DK is to solve some of these",
    "start": "288100",
    "end": "290110"
  },
  {
    "text": "performance overheads associated",
    "start": "290110",
    "end": "291880"
  },
  {
    "text": "associated with the kernel Network stack",
    "start": "291880",
    "end": "294450"
  },
  {
    "text": "so DP DK does all of the i/o in user",
    "start": "294450",
    "end": "297400"
  },
  {
    "text": "space so we completely bypass the kernel",
    "start": "297400",
    "end": "299560"
  },
  {
    "text": "and it continuously pulls four packets",
    "start": "299560",
    "end": "304780"
  },
  {
    "text": "so that way we don't have the overhead",
    "start": "304780",
    "end": "308110"
  },
  {
    "text": "associated with interrupts it also uses",
    "start": "308110",
    "end": "311590"
  },
  {
    "text": "huge pages so instead of the typical 4k",
    "start": "311590",
    "end": "314590"
  },
  {
    "text": "page size you can use either 2 megabytes",
    "start": "314590",
    "end": "316570"
  },
  {
    "text": "or one gigabyte huge pages and that",
    "start": "316570",
    "end": "319900"
  },
  {
    "text": "helps with performance by reducing the",
    "start": "319900",
    "end": "322000"
  },
  {
    "text": "number of TLB misses and the DP DK",
    "start": "322000",
    "end": "325060"
  },
  {
    "text": "libraries have api's that allow for easy",
    "start": "325060",
    "end": "329080"
  },
  {
    "text": "communication between multiple CPU cores",
    "start": "329080",
    "end": "330910"
  },
  {
    "text": "without using locks and api is to do",
    "start": "330910",
    "end": "335890"
  },
  {
    "text": "batch processing of packets so for",
    "start": "335890",
    "end": "338410"
  },
  {
    "text": "example if you are sending a lot of",
    "start": "338410",
    "end": "339340"
  },
  {
    "text": "packets out instead of touching the NIC",
    "start": "339340",
    "end": "343210"
  },
  {
    "text": "for every single packet you can send a",
    "start": "343210",
    "end": "345160"
  },
  {
    "text": "burst of packets and and touch the NIC",
    "start": "345160",
    "end": "348340"
  },
  {
    "text": "just once and that again helps",
    "start": "348340",
    "end": "350290"
  },
  {
    "text": "significantly with performance so the",
    "start": "350290",
    "end": "353290"
  },
  {
    "text": "net result of all of this is that with",
    "start": "353290",
    "end": "355210"
  },
  {
    "text": "DP DK we can achieve an order of",
    "start": "355210",
    "end": "357820"
  },
  {
    "text": "magnitude better performance then you",
    "start": "357820",
    "end": "359320"
  },
  {
    "text": "can with the core network stack the",
    "start": "359320",
    "end": "362680"
  },
  {
    "text": "amount of processing that you can do",
    "start": "362680",
    "end": "364620"
  },
  {
    "text": "determines how many packets you can",
    "start": "364620",
    "end": "366430"
  },
  {
    "text": "process per second so if you have an",
    "start": "366430",
    "end": "368200"
  },
  {
    "text": "application that does a lot of per",
    "start": "368200",
    "end": "370660"
  },
  {
    "text": "packet processing of course the numbers",
    "start": "370660",
    "end": "372820"
  },
  {
    "text": "would be a little smaller but for simple",
    "start": "372820",
    "end": "375220"
  },
  {
    "text": "benchmarks DP DK has been shown to have",
    "start": "375220",
    "end": "379450"
  },
  {
    "text": "an order of magnitude better performance",
    "start": "379450",
    "end": "381100"
  },
  {
    "text": "then then the core network stack",
    "start": "381100",
    "end": "384840"
  },
  {
    "start": "387000",
    "end": "387000"
  },
  {
    "text": "so on top of DP DK we've added support",
    "start": "388230",
    "end": "390660"
  },
  {
    "text": "for virtual networking and this is what",
    "start": "390660",
    "end": "392670"
  },
  {
    "text": "allows support for multi-tenancy so each",
    "start": "392670",
    "end": "397050"
  },
  {
    "text": "tenant would gets get its own virtual",
    "start": "397050",
    "end": "398910"
  },
  {
    "text": "network which is basically its own VR F",
    "start": "398910",
    "end": "401610"
  },
  {
    "text": "and on the wire we use overlay tunnels",
    "start": "401610",
    "end": "405030"
  },
  {
    "text": "and the overlay tunnels are what",
    "start": "405030",
    "end": "408240"
  },
  {
    "text": "separates the virtual infrastructure",
    "start": "408240",
    "end": "409590"
  },
  {
    "text": "from the physical infrastructure so you",
    "start": "409590",
    "end": "411660"
  },
  {
    "text": "could have changes in the virtual",
    "start": "411660",
    "end": "412740"
  },
  {
    "text": "network without having any impact on the",
    "start": "412740",
    "end": "415200"
  },
  {
    "text": "physical network infrastructure itself",
    "start": "415200",
    "end": "417620"
  },
  {
    "text": "and for that we've built a video module",
    "start": "417620",
    "end": "421680"
  },
  {
    "text": "and integrated that with DP D K so it is",
    "start": "421680",
    "end": "426240"
  },
  {
    "text": "this module that handles packets coming",
    "start": "426240",
    "end": "428700"
  },
  {
    "text": "in from the wire and also in the other",
    "start": "428700",
    "end": "431070"
  },
  {
    "text": "direction and applications can run on",
    "start": "431070",
    "end": "434580"
  },
  {
    "text": "top of the video either in in a",
    "start": "434580",
    "end": "436980"
  },
  {
    "text": "container or a VM and performance is",
    "start": "436980",
    "end": "440400"
  },
  {
    "text": "best when the application also uses DP D",
    "start": "440400",
    "end": "443070"
  },
  {
    "text": "K so if the video uses DP DK and the",
    "start": "443070",
    "end": "446370"
  },
  {
    "text": "application doesn't it doesn't improve",
    "start": "446370",
    "end": "448620"
  },
  {
    "text": "performance significantly and for that",
    "start": "448620",
    "end": "451080"
  },
  {
    "text": "reason we've extended envoy to also use",
    "start": "451080",
    "end": "455370"
  },
  {
    "text": "DP d k because envoy is an application",
    "start": "455370",
    "end": "457620"
  },
  {
    "text": "that runs on top of our video so now",
    "start": "457620",
    "end": "467880"
  },
  {
    "start": "464000",
    "end": "464000"
  },
  {
    "text": "that we've moved all of the packet",
    "start": "467880",
    "end": "469140"
  },
  {
    "text": "forwarding into user space we need",
    "start": "469140",
    "end": "471450"
  },
  {
    "text": "something that should replace the kernel",
    "start": "471450",
    "end": "473940"
  },
  {
    "text": "network stack and we are using an open",
    "start": "473940",
    "end": "477810"
  },
  {
    "text": "source project called F stack if stack",
    "start": "477810",
    "end": "481320"
  },
  {
    "text": "is based on the FreeBSD networking stack",
    "start": "481320",
    "end": "484050"
  },
  {
    "text": "which has been around for a long time",
    "start": "484050",
    "end": "486120"
  },
  {
    "text": "and has a pretty good reputation and",
    "start": "486120",
    "end": "489200"
  },
  {
    "text": "what F stack did is to take that then",
    "start": "489200",
    "end": "492090"
  },
  {
    "text": "put FreeBSD Network stack and integrated",
    "start": "492090",
    "end": "495240"
  },
  {
    "text": "with DP DK and we have linked on Y with",
    "start": "495240",
    "end": "501570"
  },
  {
    "text": "F stack and we've also made some changes",
    "start": "501570",
    "end": "504000"
  },
  {
    "text": "in Lybia vent previously live event used",
    "start": "504000",
    "end": "508230"
  },
  {
    "text": "to use to sleep in an e poll and without",
    "start": "508230",
    "end": "513270"
  },
  {
    "text": "changes live event doesn't sleep it",
    "start": "513270",
    "end": "514770"
  },
  {
    "text": "continuously poles for packets and we",
    "start": "514770",
    "end": "518250"
  },
  {
    "text": "also have shared memory between between",
    "start": "518250",
    "end": "520919"
  },
  {
    "text": "Envoy",
    "start": "520920",
    "end": "522120"
  },
  {
    "text": "is running on wallaby when TANF stack",
    "start": "522120",
    "end": "523620"
  },
  {
    "text": "it's all in one process we have shared",
    "start": "523620",
    "end": "525540"
  },
  {
    "text": "memory between that and V router and we",
    "start": "525540",
    "end": "528870"
  },
  {
    "text": "used the user space V hosts mechanism",
    "start": "528870",
    "end": "531120"
  },
  {
    "text": "for that so the V host mechanism was",
    "start": "531120",
    "end": "533790"
  },
  {
    "text": "initially added inside Q EMU as an",
    "start": "533790",
    "end": "536520"
  },
  {
    "text": "optimization for handling traffic from",
    "start": "536520",
    "end": "539160"
  },
  {
    "text": "VMs initially the V host back-end was",
    "start": "539160",
    "end": "542850"
  },
  {
    "text": "inside the kernel and a couple of years",
    "start": "542850",
    "end": "546240"
  },
  {
    "text": "back that infrastructure was extended to",
    "start": "546240",
    "end": "548490"
  },
  {
    "text": "move it into user space so that it could",
    "start": "548490",
    "end": "551520"
  },
  {
    "text": "run in virtual router or virtual switch",
    "start": "551520",
    "end": "553290"
  },
  {
    "text": "environments and that is what we use to",
    "start": "553290",
    "end": "556200"
  },
  {
    "text": "communicate between between Envoy and",
    "start": "556200",
    "end": "558210"
  },
  {
    "text": "the Videodrome",
    "start": "558210",
    "end": "559320"
  },
  {
    "text": "so you use a space V host sets up the",
    "start": "559320",
    "end": "561779"
  },
  {
    "text": "shared memory and then any packets",
    "start": "561779",
    "end": "563850"
  },
  {
    "text": "exchange between Envoy and the V doubter",
    "start": "563850",
    "end": "566150"
  },
  {
    "text": "are sent over the shared memory so I",
    "start": "566150",
    "end": "569790"
  },
  {
    "text": "mentioned that we have one process which",
    "start": "569790",
    "end": "571410"
  },
  {
    "text": "runs on ydp DK and F stack we could",
    "start": "571410",
    "end": "575100"
  },
  {
    "text": "extend that to have multiple instances",
    "start": "575100",
    "end": "577140"
  },
  {
    "text": "of the same process and the V doctor",
    "start": "577140",
    "end": "579510"
  },
  {
    "text": "could load balance the traffic across",
    "start": "579510",
    "end": "581339"
  },
  {
    "text": "those multiple instances so this picture",
    "start": "581339",
    "end": "587760"
  },
  {
    "start": "586000",
    "end": "586000"
  },
  {
    "text": "shows the forwarding path so we have",
    "start": "587760",
    "end": "590820"
  },
  {
    "text": "packets coming in on the wire so you",
    "start": "590820",
    "end": "595200"
  },
  {
    "text": "have the orange which is packets on one",
    "start": "595200",
    "end": "597660"
  },
  {
    "text": "virtual network so because we use",
    "start": "597660",
    "end": "600150"
  },
  {
    "text": "overlay tunnels there is an identifier",
    "start": "600150",
    "end": "602850"
  },
  {
    "text": "inside the packet that identifies which",
    "start": "602850",
    "end": "605459"
  },
  {
    "text": "virtual network the packet belongs to",
    "start": "605459",
    "end": "606990"
  },
  {
    "text": "and we have the V out process which",
    "start": "606990",
    "end": "610650"
  },
  {
    "text": "itself uses TP DK so it's continuously",
    "start": "610650",
    "end": "613050"
  },
  {
    "text": "pulling for packets so the video outer",
    "start": "613050",
    "end": "615420"
  },
  {
    "text": "process polls for packets then does",
    "start": "615420",
    "end": "618779"
  },
  {
    "text": "whatever is necessary to handle the",
    "start": "618779",
    "end": "620190"
  },
  {
    "text": "virtual networking part so typically",
    "start": "620190",
    "end": "621990"
  },
  {
    "text": "that would you know include decap",
    "start": "621990",
    "end": "624209"
  },
  {
    "text": "sedating the packets and figuring out",
    "start": "624209",
    "end": "625740"
  },
  {
    "text": "which virtual network that packet",
    "start": "625740",
    "end": "627630"
  },
  {
    "text": "belongs to and in the opposite direction",
    "start": "627630",
    "end": "630080"
  },
  {
    "text": "the V doubter would encapsulate packets",
    "start": "630080",
    "end": "632520"
  },
  {
    "text": "into a tunnel and send them out on the",
    "start": "632520",
    "end": "633779"
  },
  {
    "text": "wire so once the packet is D capsulated",
    "start": "633779",
    "end": "637290"
  },
  {
    "text": "and V router has figure out which Envoy",
    "start": "637290",
    "end": "639270"
  },
  {
    "text": "instance the packet needs to be sent to",
    "start": "639270",
    "end": "642380"
  },
  {
    "text": "it puts the descriptor to the packet in",
    "start": "642380",
    "end": "644820"
  },
  {
    "text": "shared memory and we have this other",
    "start": "644820",
    "end": "647790"
  },
  {
    "text": "process which is envoy linked with DP D",
    "start": "647790",
    "end": "650790"
  },
  {
    "text": "K and F stack that process is",
    "start": "650790",
    "end": "653220"
  },
  {
    "text": "continuously pulling the shared memory",
    "start": "653220",
    "end": "654870"
  },
  {
    "text": "for packets",
    "start": "654870",
    "end": "655950"
  },
  {
    "text": "so the packet enters initially through",
    "start": "655950",
    "end": "658290"
  },
  {
    "text": "DP DK and then into F stack and as I",
    "start": "658290",
    "end": "662490"
  },
  {
    "text": "mentioned leap event is now continuously",
    "start": "662490",
    "end": "664350"
  },
  {
    "text": "pulling four packets so it pulls the",
    "start": "664350",
    "end": "668940"
  },
  {
    "text": "packet up from DP DK and dumps it into",
    "start": "668940",
    "end": "671670"
  },
  {
    "text": "the socket so we've added the ability to",
    "start": "671670",
    "end": "674760"
  },
  {
    "text": "tie a socket to a particular VR F so if",
    "start": "674760",
    "end": "678899"
  },
  {
    "text": "you have multiple virtual networks you",
    "start": "678899",
    "end": "680699"
  },
  {
    "text": "could have socket one belong to",
    "start": "680699",
    "end": "681839"
  },
  {
    "text": "belonging to one virtual network and",
    "start": "681839",
    "end": "683310"
  },
  {
    "text": "socket to belonging to a different",
    "start": "683310",
    "end": "684779"
  },
  {
    "text": "virtual network so once once the packet",
    "start": "684779",
    "end": "688529"
  },
  {
    "text": "is in the socket then envoy invokes F",
    "start": "688529",
    "end": "690959"
  },
  {
    "text": "stack calls instead of the traditional",
    "start": "690959",
    "end": "692790"
  },
  {
    "text": "socket calls and then it does whatever",
    "start": "692790",
    "end": "696480"
  },
  {
    "text": "processing needs to be done if the",
    "start": "696480",
    "end": "698040"
  },
  {
    "text": "packet needs to be sent back out it",
    "start": "698040",
    "end": "700470"
  },
  {
    "text": "would be deposited into the socket too",
    "start": "700470",
    "end": "703010"
  },
  {
    "text": "which could be in a different virtual",
    "start": "703010",
    "end": "705300"
  },
  {
    "text": "network and then that packet is sent out",
    "start": "705300",
    "end": "708060"
  },
  {
    "text": "again using F stack and DP decayed into",
    "start": "708060",
    "end": "710490"
  },
  {
    "text": "shared memory and then B router would",
    "start": "710490",
    "end": "713130"
  },
  {
    "text": "take care of encapsulating the packet",
    "start": "713130",
    "end": "715470"
  },
  {
    "text": "and sending it out on the wire so this",
    "start": "715470",
    "end": "723839"
  },
  {
    "text": "is a quick summary of the changes that",
    "start": "723839",
    "end": "725579"
  },
  {
    "text": "we had to make an envoy to get this",
    "start": "725579",
    "end": "726990"
  },
  {
    "text": "working so we added Basel external",
    "start": "726990",
    "end": "730110"
  },
  {
    "text": "repositories to include DP D K F stack",
    "start": "730110",
    "end": "735149"
  },
  {
    "text": "and live event live event poles",
    "start": "735149",
    "end": "738390"
  },
  {
    "text": "continuously as I mentioned and live",
    "start": "738390",
    "end": "741779"
  },
  {
    "text": "event calls into F stack to accept new",
    "start": "741779",
    "end": "744870"
  },
  {
    "text": "connections or to listen for connections",
    "start": "744870",
    "end": "748430"
  },
  {
    "text": "inside half stack we added some support",
    "start": "748430",
    "end": "750870"
  },
  {
    "text": "to support AF packet interfaces and",
    "start": "750870",
    "end": "753779"
  },
  {
    "text": "vertigo and we also added support for",
    "start": "753779",
    "end": "757019"
  },
  {
    "text": "ipv6 in F stack because that was not",
    "start": "757019",
    "end": "759390"
  },
  {
    "text": "supported and we added support for",
    "start": "759390",
    "end": "763199"
  },
  {
    "text": "multiple via refs in an envoy and that's",
    "start": "763199",
    "end": "766470"
  },
  {
    "text": "the API to tie a socket to a particular",
    "start": "766470",
    "end": "768390"
  },
  {
    "text": "virtual network and inside the or",
    "start": "768390",
    "end": "772470"
  },
  {
    "text": "annoyed dispatcher again instead of",
    "start": "772470",
    "end": "774240"
  },
  {
    "text": "sleeping we continuously Pole and we can",
    "start": "774240",
    "end": "777779"
  },
  {
    "text": "do that on a per socket basis so there",
    "start": "777779",
    "end": "781529"
  },
  {
    "text": "could be the main thread of one work for",
    "start": "781529",
    "end": "784769"
  },
  {
    "text": "example could be still be sleeping on",
    "start": "784769",
    "end": "786420"
  },
  {
    "text": "inside live event but the worker thread",
    "start": "786420",
    "end": "788940"
  },
  {
    "text": "could be continuously",
    "start": "788940",
    "end": "789690"
  },
  {
    "text": "moving on suck on sockets and finally we",
    "start": "789690",
    "end": "794160"
  },
  {
    "text": "had to move some of the code from the",
    "start": "794160",
    "end": "795990"
  },
  {
    "text": "main thread of envoy into the worker",
    "start": "795990",
    "end": "797550"
  },
  {
    "text": "thread because if stack expects that any",
    "start": "797550",
    "end": "800880"
  },
  {
    "text": "sockets that are created are created in",
    "start": "800880",
    "end": "803010"
  },
  {
    "text": "the context of the same thread so we",
    "start": "803010",
    "end": "804990"
  },
  {
    "text": "couldn't have sockets that were created",
    "start": "804990",
    "end": "806430"
  },
  {
    "text": "in the main thread and then handed off",
    "start": "806430",
    "end": "807630"
  },
  {
    "text": "to the worker thread so we had to move a",
    "start": "807630",
    "end": "810090"
  },
  {
    "text": "bunch of that code from the main thread",
    "start": "810090",
    "end": "812040"
  },
  {
    "text": "of envoy into the worker thread we have",
    "start": "812040",
    "end": "819030"
  },
  {
    "start": "818000",
    "end": "818000"
  },
  {
    "text": "some initial performance numbers this is",
    "start": "819030",
    "end": "822870"
  },
  {
    "text": "work in progress so please treat it as",
    "start": "822870",
    "end": "826200"
  },
  {
    "text": "work in progress these numbers are on",
    "start": "826200",
    "end": "829880"
  },
  {
    "text": "VMs running in in Azure cloud so we have",
    "start": "829880",
    "end": "833880"
  },
  {
    "text": "a client connecting to an HTTP server",
    "start": "833880",
    "end": "835620"
  },
  {
    "text": "and in the first scenario it's going",
    "start": "835620",
    "end": "838500"
  },
  {
    "text": "through on wye 1.8 unmodified and in the",
    "start": "838500",
    "end": "842580"
  },
  {
    "text": "second scenario we have on Y with F",
    "start": "842580",
    "end": "845430"
  },
  {
    "text": "stack and T ptk and in terms of requests",
    "start": "845430",
    "end": "850020"
  },
  {
    "text": "per second with the unmodified on Y we",
    "start": "850020",
    "end": "852330"
  },
  {
    "text": "got up 172 with a latency of about 4",
    "start": "852330",
    "end": "855180"
  },
  {
    "text": "milliseconds and with the Envoy with F",
    "start": "855180",
    "end": "860490"
  },
  {
    "text": "stack and DPD K that number was close to",
    "start": "860490",
    "end": "862680"
  },
  {
    "text": "500 and the latency was a little over 2",
    "start": "862680",
    "end": "865380"
  },
  {
    "text": "milliseconds we're now in the process of",
    "start": "865380",
    "end": "869160"
  },
  {
    "text": "measuring these same numbers with with",
    "start": "869160",
    "end": "871110"
  },
  {
    "text": "bare metal because on on ashore we see",
    "start": "871110",
    "end": "874620"
  },
  {
    "text": "some variance in the numbers so it's",
    "start": "874620",
    "end": "876360"
  },
  {
    "text": "hard to reproduce these numbers so what",
    "start": "876360",
    "end": "878970"
  },
  {
    "text": "I'm presenting here are are the",
    "start": "878970",
    "end": "880350"
  },
  {
    "text": "best-case numbers and we don't get the",
    "start": "880350",
    "end": "882270"
  },
  {
    "text": "same numbers on every run with a sure so",
    "start": "882270",
    "end": "884640"
  },
  {
    "text": "we're trying to do this with bare metal",
    "start": "884640",
    "end": "886200"
  },
  {
    "text": "I think that's the right way to do the",
    "start": "886200",
    "end": "887970"
  },
  {
    "text": "performance benchmarking and once we",
    "start": "887970",
    "end": "889980"
  },
  {
    "text": "have some numbers to share we'll publish",
    "start": "889980",
    "end": "892170"
  },
  {
    "text": "those so in summary our main",
    "start": "892170",
    "end": "899040"
  },
  {
    "start": "896000",
    "end": "896000"
  },
  {
    "text": "contributions we believe our edition of",
    "start": "899040",
    "end": "901170"
  },
  {
    "text": "multi-tenancy into envoy and improved",
    "start": "901170",
    "end": "904260"
  },
  {
    "text": "performance with integration with DPD k",
    "start": "904260",
    "end": "907589"
  },
  {
    "text": "and and of stack we plan to publish a",
    "start": "907589",
    "end": "911790"
  },
  {
    "text": "blog in the future once we have numbers",
    "start": "911790",
    "end": "915210"
  },
  {
    "text": "with bare metal and and more test",
    "start": "915210",
    "end": "917670"
  },
  {
    "text": "scenarios and our website is best or I",
    "start": "917670",
    "end": "921570"
  },
  {
    "text": "oh yeah our blog will",
    "start": "921570",
    "end": "923250"
  },
  {
    "text": "which published off of that and we",
    "start": "923250",
    "end": "926010"
  },
  {
    "text": "believe that this work could also have",
    "start": "926010",
    "end": "927750"
  },
  {
    "text": "other applications so for example inside",
    "start": "927750",
    "end": "930030"
  },
  {
    "text": "the sto community there's talk about",
    "start": "930030",
    "end": "931830"
  },
  {
    "text": "using sto CNI and sidecar less sto and",
    "start": "931830",
    "end": "935390"
  },
  {
    "text": "we believe some of this work could be",
    "start": "935390",
    "end": "937530"
  },
  {
    "text": "applicable in in those scenarios too so",
    "start": "937530",
    "end": "940410"
  },
  {
    "text": "that's all I had",
    "start": "940410",
    "end": "941040"
  },
  {
    "text": "thank you any questions",
    "start": "941040",
    "end": "954139"
  },
  {
    "text": "so the question is can we characterize",
    "start": "971880",
    "end": "974380"
  },
  {
    "text": "the performance aware of the overhead of",
    "start": "974380",
    "end": "976810"
  },
  {
    "text": "the kernel Network stack as compared to",
    "start": "976810",
    "end": "979330"
  },
  {
    "text": "the filters that execute with an envoy",
    "start": "979330",
    "end": "981070"
  },
  {
    "text": "with lower JavaScript so for the",
    "start": "981070",
    "end": "984400"
  },
  {
    "text": "performance test that we ran we did not",
    "start": "984400",
    "end": "986200"
  },
  {
    "text": "have any Louisville JavaScript so I",
    "start": "986200",
    "end": "988150"
  },
  {
    "text": "don't really have numbers there and hard",
    "start": "988150",
    "end": "991750"
  },
  {
    "text": "to say how that compares with the",
    "start": "991750",
    "end": "993100"
  },
  {
    "text": "overhead of the kernel stack itself yeah",
    "start": "993100",
    "end": "1003290"
  },
  {
    "text": "so I think I don't think all of the",
    "start": "1003290",
    "end": "1006390"
  },
  {
    "text": "overhead that we see with the kernel",
    "start": "1006390",
    "end": "1007560"
  },
  {
    "text": "stack can be attributed to to envoy in",
    "start": "1007560",
    "end": "1009870"
  },
  {
    "text": "fact I think it's not even a majority of",
    "start": "1009870",
    "end": "1012300"
  },
  {
    "text": "the overhead because as we saw in the",
    "start": "1012300",
    "end": "1014520"
  },
  {
    "text": "numbers the latency went down from four",
    "start": "1014520",
    "end": "1016020"
  },
  {
    "text": "milliseconds to two milliseconds but",
    "start": "1016020",
    "end": "1017610"
  },
  {
    "text": "we're still running the same Envoy code",
    "start": "1017610",
    "end": "1018930"
  },
  {
    "text": "but just not using the core network",
    "start": "1018930",
    "end": "1020910"
  },
  {
    "text": "stack so there is some overhead for sure",
    "start": "1020910",
    "end": "1023280"
  },
  {
    "text": "because for the same scenario we also",
    "start": "1023280",
    "end": "1025500"
  },
  {
    "text": "tested client going directly to the",
    "start": "1025500",
    "end": "1027150"
  },
  {
    "text": "server and the number was about 520",
    "start": "1027150",
    "end": "1030300"
  },
  {
    "text": "requests per second and the latency was",
    "start": "1030300",
    "end": "1032370"
  },
  {
    "text": "one millisecond and when be used on Y",
    "start": "1032370",
    "end": "1034620"
  },
  {
    "text": "with F stack and D PDK the requests per",
    "start": "1034620",
    "end": "1037020"
  },
  {
    "text": "second was about 500 and the latency was",
    "start": "1037020",
    "end": "1039810"
  },
  {
    "text": "about 2 milliseconds so we added about a",
    "start": "1039810",
    "end": "1041459"
  },
  {
    "text": "millisecond of latency how much of that",
    "start": "1041460",
    "end": "1044130"
  },
  {
    "text": "is just due to on why I am not exactly",
    "start": "1044130",
    "end": "1046319"
  },
  {
    "text": "sure but I would guess more than half of",
    "start": "1046320",
    "end": "1048270"
  },
  {
    "text": "that is the overhead of going through on",
    "start": "1048270",
    "end": "1050760"
  },
  {
    "text": "Y instead of going directly from client",
    "start": "1050760",
    "end": "1052320"
  },
  {
    "text": "to server good",
    "start": "1052320",
    "end": "1057919"
  },
  {
    "text": "yeah so there were two questions there",
    "start": "1095300",
    "end": "1097460"
  },
  {
    "text": "the first one was does DP D K really",
    "start": "1097460",
    "end": "1100100"
  },
  {
    "text": "deliver on the promise of order of",
    "start": "1100100",
    "end": "1102080"
  },
  {
    "text": "magnitude improvement and performance",
    "start": "1102080",
    "end": "1103880"
  },
  {
    "text": "when combined with everything that's",
    "start": "1103880",
    "end": "1105920"
  },
  {
    "text": "going on with an envoy with potentially",
    "start": "1105920",
    "end": "1108860"
  },
  {
    "text": "with other filters and things like that",
    "start": "1108860",
    "end": "1111010"
  },
  {
    "text": "so you'll see a lot of benchmarks with",
    "start": "1111010",
    "end": "1114440"
  },
  {
    "text": "DP DK which show fantastic numbers and",
    "start": "1114440",
    "end": "1117340"
  },
  {
    "text": "usually those are for cases where you",
    "start": "1117340",
    "end": "1120320"
  },
  {
    "text": "know there's very little packet",
    "start": "1120320",
    "end": "1121520"
  },
  {
    "text": "processing that's happening so you get a",
    "start": "1121520",
    "end": "1123350"
  },
  {
    "text": "packet you do a Mac look up and forward",
    "start": "1123350",
    "end": "1125090"
  },
  {
    "text": "and for that kind of benchmark you'll",
    "start": "1125090",
    "end": "1127580"
  },
  {
    "text": "see line rate with 10 gig NICs on a",
    "start": "1127580",
    "end": "1129830"
  },
  {
    "text": "single core but what we've seen in",
    "start": "1129830",
    "end": "1133010"
  },
  {
    "text": "practice is that that's really not",
    "start": "1133010",
    "end": "1134540"
  },
  {
    "text": "practical in most cases there's enough",
    "start": "1134540",
    "end": "1136840"
  },
  {
    "text": "that needs to be done with every packet",
    "start": "1136840",
    "end": "1139190"
  },
  {
    "text": "that achieving 14 million packets per",
    "start": "1139190",
    "end": "1141500"
  },
  {
    "text": "second is close to impossible so for",
    "start": "1141500",
    "end": "1144500"
  },
  {
    "text": "example we're on B router widths with DP",
    "start": "1144500",
    "end": "1147530"
  },
  {
    "text": "DK and the amount of work that we do and",
    "start": "1147530",
    "end": "1150050"
  },
  {
    "text": "B router itself brings the number",
    "start": "1150050",
    "end": "1151790"
  },
  {
    "text": "significantly significantly down from",
    "start": "1151790",
    "end": "1153650"
  },
  {
    "text": "say 14 million packets per second to a",
    "start": "1153650",
    "end": "1155660"
  },
  {
    "text": "handful of million packets per second so",
    "start": "1155660",
    "end": "1158150"
  },
  {
    "text": "as you add more processing it's expected",
    "start": "1158150",
    "end": "1160460"
  },
  {
    "text": "that that number will continue to go",
    "start": "1160460",
    "end": "1162530"
  },
  {
    "text": "down but we still believe that it's",
    "start": "1162530",
    "end": "1164090"
  },
  {
    "text": "going to be significantly better than",
    "start": "1164090",
    "end": "1165230"
  },
  {
    "text": "what you can get with the current",
    "start": "1165230",
    "end": "1166550"
  },
  {
    "text": "network stack and sorry what was the",
    "start": "1166550",
    "end": "1169730"
  },
  {
    "text": "second question again yeah the second",
    "start": "1169730",
    "end": "1173960"
  },
  {
    "text": "question was how good is the TCP stack",
    "start": "1173960",
    "end": "1175970"
  },
  {
    "text": "so we looked at what options we had and",
    "start": "1175970",
    "end": "1179660"
  },
  {
    "text": "the reason we picked F stack is it's",
    "start": "1179660",
    "end": "1181730"
  },
  {
    "text": "based on the freebsd networking stack",
    "start": "1181730",
    "end": "1183500"
  },
  {
    "text": "which has been around for a long time",
    "start": "1183500",
    "end": "1185180"
  },
  {
    "text": "and it has a pretty good reputation so",
    "start": "1185180",
    "end": "1188330"
  },
  {
    "text": "whether it supports everything that's",
    "start": "1188330",
    "end": "1189920"
  },
  {
    "text": "there in the Linux kernel stack I'm not",
    "start": "1189920",
    "end": "1192230"
  },
  {
    "text": "sure but I think of the options that we",
    "start": "1192230",
    "end": "1194330"
  },
  {
    "text": "have I think PBS D is a pretty good",
    "start": "1194330",
    "end": "1195740"
  },
  {
    "text": "choice",
    "start": "1195740",
    "end": "1197890"
  },
  {
    "text": "yes the question is if the application",
    "start": "1211890",
    "end": "1214570"
  },
  {
    "text": "does not use DP DK but V router itself",
    "start": "1214570",
    "end": "1217000"
  },
  {
    "text": "uses DP decade the performance is not as",
    "start": "1217000",
    "end": "1219580"
  },
  {
    "text": "good and and why is that and the reason",
    "start": "1219580",
    "end": "1222040"
  },
  {
    "text": "for that is the application would inhale",
    "start": "1222040",
    "end": "1224650"
  },
  {
    "text": "incur the same overheads that are",
    "start": "1224650",
    "end": "1226570"
  },
  {
    "text": "associated with the kernel network stack",
    "start": "1226570",
    "end": "1228900"
  },
  {
    "text": "yeah so you would have to make system",
    "start": "1228900",
    "end": "1231100"
  },
  {
    "text": "calls to send a packet to the",
    "start": "1231100",
    "end": "1232150"
  },
  {
    "text": "application which hurts reroute or it",
    "start": "1232150",
    "end": "1233920"
  },
  {
    "text": "also hurts the application thank you",
    "start": "1233920",
    "end": "1242830"
  },
  {
    "text": "[Applause]",
    "start": "1242830",
    "end": "1245859"
  }
]