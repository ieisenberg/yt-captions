[
  {
    "start": "0",
    "end": "47000"
  },
  {
    "text": "all right hello everyone uh it's not that big of a room so I'm gonna tone",
    "start": "5299",
    "end": "10920"
  },
  {
    "text": "down the mic is super loud too um we've been hearing so far and you're",
    "start": "10920",
    "end": "16020"
  },
  {
    "text": "probably going to hear quite a bit more about how networking is moving closer and closer to the edge right get closer",
    "start": "16020",
    "end": "22439"
  },
  {
    "text": "to your clients push it as far as you can well today I want to talk about pushing it just a little further than",
    "start": "22439",
    "end": "27720"
  },
  {
    "text": "that and actually running Envoy on your end user or client devices themselves uh",
    "start": "27720",
    "end": "34079"
  },
  {
    "text": "with a little project that's called Envoy mobile my name is JP I work at",
    "start": "34079",
    "end": "39719"
  },
  {
    "text": "Lyft on this thing called Envoy mobile so the idea here",
    "start": "39719",
    "end": "46079"
  },
  {
    "text": "is that we can take everything that's great about Envoy that you know love that you",
    "start": "46079",
    "end": "51899"
  },
  {
    "start": "47000",
    "end": "47000"
  },
  {
    "text": "run on the server side and we can embed it to run it in mobile apps to run it on",
    "start": "51899",
    "end": "57180"
  },
  {
    "text": "iOS on Android and to run it to power the networking",
    "start": "57180",
    "end": "62640"
  },
  {
    "text": "capabilities of those apps so a few years ago the team started taking",
    "start": "62640",
    "end": "69780"
  },
  {
    "text": "a look at what it would take to bring Envoy and embed it into a mobile client",
    "start": "69780",
    "end": "75720"
  },
  {
    "text": "so Envoy mobile is built around Envoy it's designed to run on IOS and Android",
    "start": "75720",
    "end": "81420"
  },
  {
    "text": "specifically although it does run on various platforms as well it's just not a Target platform and one of the main",
    "start": "81420",
    "end": "90119"
  },
  {
    "text": "differences is that we have a number of constraints by nature of running in",
    "start": "90119",
    "end": "96299"
  },
  {
    "text": "these highly sandboxed highly locked down mobile environments",
    "start": "96299",
    "end": "101939"
  },
  {
    "text": "right where as an application developer you ship a binary to your end users and that ends up running as a single binary",
    "start": "101939",
    "end": "108900"
  },
  {
    "text": "single process most of the time and so you can't just run your networking",
    "start": "108900",
    "end": "114420"
  },
  {
    "text": "client as a sidecar and spawn a process as your app is running and query requests off to it you have to run it as",
    "start": "114420",
    "end": "120119"
  },
  {
    "text": "part of your applications process sharing memory sharing CPU Cycles all of that uh we built Envoy mobile as a polyglot",
    "start": "120119",
    "end": "128580"
  },
  {
    "text": "library and what I mean by this is that there are apis for various languages and",
    "start": "128580",
    "end": "134220"
  },
  {
    "text": "platforms that you might want to use we have apis for C plus plus Swift kotlin Objective C Java python although",
    "start": "134220",
    "end": "141300"
  },
  {
    "text": "you don't really run that one in apps and the idea here being that we want to make the experience of making Network",
    "start": "141300",
    "end": "147840"
  },
  {
    "text": "requests for application developers as idiomatic and Native feelings possible",
    "start": "147840",
    "end": "153599"
  },
  {
    "text": "on those platforms and what this allows the library to do is both a feel right",
    "start": "153599",
    "end": "159780"
  },
  {
    "text": "at home for someone who for example writes kotlin all day long or out of Android apps or Swift on iOS but at the",
    "start": "159780",
    "end": "166560"
  },
  {
    "text": "same time offer some amount of flexibility for larger teams who may",
    "start": "166560",
    "end": "172200"
  },
  {
    "text": "want to invest into building a single interface to their networking apis and",
    "start": "172200",
    "end": "178980"
  },
  {
    "text": "write that in C plus ship it in a cross-platform way uh like Envoy envoyables open source",
    "start": "178980",
    "end": "186000"
  },
  {
    "text": "licensed under Apache 2.0 and you can find more about it at on vulnerable.io",
    "start": "186000",
    "end": "191840"
  },
  {
    "text": "which is where you see the nice screenshot of the website there so why",
    "start": "191840",
    "end": "197819"
  },
  {
    "start": "196000",
    "end": "196000"
  },
  {
    "text": "did we go out and build this and by we I mean that Envoy was first started around",
    "start": "197819",
    "end": "203940"
  },
  {
    "text": "2019 by a few Lyft folks and over over time uh more and more folks especially",
    "start": "203940",
    "end": "209099"
  },
  {
    "text": "Google but also from other companies started contributing why is this useful to build well there's",
    "start": "209099",
    "end": "216480"
  },
  {
    "text": "a lot of what you probably know and love about Envoy that would be hugely beneficial to bring in a mobile",
    "start": "216480",
    "end": "222540"
  },
  {
    "text": "application context and so that was sort of one of the main ideas and one of the",
    "start": "222540",
    "end": "227940"
  },
  {
    "text": "things that Envoy is quite known for is its Rich set of observability capabilities uh there's just a rich set",
    "start": "227940",
    "end": "235080"
  },
  {
    "text": "of stats that you can emit by just nature of using the library and what's",
    "start": "235080",
    "end": "241260"
  },
  {
    "text": "nice about this is that especially on mobile where you have very limited resources you have to be very careful in",
    "start": "241260",
    "end": "248580"
  },
  {
    "text": "how you instrument and you Monitor and You observe what's happening on your end users devices they might be in a",
    "start": "248580",
    "end": "254879"
  },
  {
    "text": "constrained environment both from CPU or memory perspective they might be in an",
    "start": "254879",
    "end": "260940"
  },
  {
    "text": "intermittent connectivity State you don't want to end up competing for the same resources that you're trying to",
    "start": "260940",
    "end": "266940"
  },
  {
    "text": "observe therefore degrading the whole experience right so that rich set of",
    "start": "266940",
    "end": "272160"
  },
  {
    "text": "observability and especially how lightweight and streamed and streamlined",
    "start": "272160",
    "end": "277380"
  },
  {
    "text": "and optimized it is is extremely helpful to bring to a mobile context another reason is that",
    "start": "277380",
    "end": "284060"
  },
  {
    "text": "Envoy has all of these support for newer",
    "start": "284060",
    "end": "289500"
  },
  {
    "text": "networking Technologies uh and I think we're actually going to hear some talks later today about some of what those are",
    "start": "289500",
    "end": "295560"
  },
  {
    "text": "and and some of the recent developments in Envoy uh Upstream there and what's nice about this is that on certain",
    "start": "295560",
    "end": "302880"
  },
  {
    "text": "platforms like on Apple's platforms the networking library and the networking engine ships with the operating system",
    "start": "302880",
    "end": "309180"
  },
  {
    "text": "so if you go back and you target you support your end users still using an OS",
    "start": "309180",
    "end": "314820"
  },
  {
    "text": "that's a few years old they're not going to have access to everything that's happened since then and what's nice",
    "start": "314820",
    "end": "321540"
  },
  {
    "text": "about being able to ship our own networking library with our apps is that we can go and back Port those and",
    "start": "321540",
    "end": "327300"
  },
  {
    "text": "support all of our users not just the ones on the bleeding edge another thing that bringing Envoy to",
    "start": "327300",
    "end": "334199"
  },
  {
    "text": "mobile gets us is a certain amount of consistency where instead of building",
    "start": "334199",
    "end": "339300"
  },
  {
    "text": "against different apis different uh having different engines on different",
    "start": "339300",
    "end": "344880"
  },
  {
    "text": "platforms and different OS versions all having their own quirks their own ways to think about them their own ideas for",
    "start": "344880",
    "end": "351060"
  },
  {
    "text": "how to architect the networking logic around them we can share that not just",
    "start": "351060",
    "end": "356220"
  },
  {
    "text": "across the mobile code bases but also on the server so that you know if you're",
    "start": "356220",
    "end": "361680"
  },
  {
    "text": "compressing something with Envoy proxy on the server side using broadly the version that you were decompressing on",
    "start": "361680",
    "end": "368340"
  },
  {
    "text": "the client is using that same code right so there's a high degree of compatibility and consistency",
    "start": "368340",
    "end": "374820"
  },
  {
    "text": "another layer that bring avoid mobile to bring Envoy to mobile gets us is a lot",
    "start": "374820",
    "end": "381000"
  },
  {
    "text": "of control uh these Network engines that ship with the operating system on the",
    "start": "381000",
    "end": "386880"
  },
  {
    "text": "lower extremely powerful fine-tuned But ultimately they end up targeting the",
    "start": "386880",
    "end": "393060"
  },
  {
    "text": "long the the vast majority of use cases they want to be good at everything but it means that they don't necessarily",
    "start": "393060",
    "end": "399060"
  },
  {
    "text": "expose many different ways to fine-tune and optimize and configure the",
    "start": "399060",
    "end": "404220"
  },
  {
    "text": "networking engine for your specific needs and if you're building a product",
    "start": "404220",
    "end": "409319"
  },
  {
    "text": "where you have a pretty well known usage pattern and every byte matters you",
    "start": "409319",
    "end": "415319"
  },
  {
    "text": "probably want the ability to fine-tune and say well these endpoints I know speak H2 for example so skip the whole",
    "start": "415319",
    "end": "422699"
  },
  {
    "text": "alpn process uh debuggability is another big one that",
    "start": "422699",
    "end": "428100"
  },
  {
    "text": "bring Envoy to mobile gets us where on alternate Network engines those are",
    "start": "428100",
    "end": "435479"
  },
  {
    "text": "closed Source they ship with the OS you can't step through the code necessarily to understand deep down what's happening",
    "start": "435479",
    "end": "442080"
  },
  {
    "text": "when you have a request that's timing out or you have something that you're just trying to observe and by having",
    "start": "442080",
    "end": "448440"
  },
  {
    "text": "full access to the source code and building it in and loading it into the IDE so that you can step through the",
    "start": "448440",
    "end": "454500"
  },
  {
    "text": "code set break points really introspect and understand what's going on you can",
    "start": "454500",
    "end": "460319"
  },
  {
    "text": "gain a whole new level of understanding in terms of what's going on under the hood so those are some of the reasons why uh",
    "start": "460319",
    "end": "468780"
  },
  {
    "text": "it's been helpful for us to continue to invest in this effort to bring Envoy to mobile",
    "start": "468780",
    "end": "474960"
  },
  {
    "start": "474000",
    "end": "474000"
  },
  {
    "text": "so brief timeline uh Matt touched on this a little bit earlier Envoy was",
    "start": "474960",
    "end": "480599"
  },
  {
    "text": "announced to the world in 2016 uh three years later some folks at Lyft started",
    "start": "480599",
    "end": "485639"
  },
  {
    "text": "working on bringing that to a mobile context then for two years after that there was",
    "start": "485639",
    "end": "492000"
  },
  {
    "text": "a lot of work that was done in order to bring it up to speed to be at",
    "start": "492000",
    "end": "497940"
  },
  {
    "text": "compatibility or as close as possible to the existing well-established",
    "start": "497940",
    "end": "503300"
  },
  {
    "text": "well-polished networking engines that were already out there in the industry and then from 2021 to 2022 Lyft ran a",
    "start": "503300",
    "end": "512159"
  },
  {
    "text": "number of production experiments in order to really understand where we",
    "start": "512159",
    "end": "518339"
  },
  {
    "text": "still had performance or other uh regressions compared to the existing",
    "start": "518339",
    "end": "524219"
  },
  {
    "text": "stacks and we worked hard to both understand them and Bridge them and this",
    "start": "524219",
    "end": "529320"
  },
  {
    "text": "is something that was only possible because of envoy's open Nature right",
    "start": "529320",
    "end": "534360"
  },
  {
    "text": "where we were able to dig into the source code talk to some of the maintainers to the contributors and",
    "start": "534360",
    "end": "540180"
  },
  {
    "text": "understand uh what might be going on and what might help and then finally just a few months ago",
    "start": "540180",
    "end": "545940"
  },
  {
    "text": "we completed rolling out Envoy mobile to all of our user-facing mobile apps and",
    "start": "545940",
    "end": "551940"
  },
  {
    "text": "now uh if you've taken a lift in the last few months if you've rented a scooter or bike using any of the lift",
    "start": "551940",
    "end": "558660"
  },
  {
    "text": "apps odds are that you were using Envoy on your device to actually make those requests so we only did this once we",
    "start": "558660",
    "end": "566820"
  },
  {
    "text": "were fully comfortable and confident that we weren't regressing the user",
    "start": "566820",
    "end": "571860"
  },
  {
    "text": "experience for anyone and so we made sure to be at par or exceeding any of",
    "start": "571860",
    "end": "577800"
  },
  {
    "text": "the performance measurements that we could make with the existing pre-existing networking engines",
    "start": "577800",
    "end": "583080"
  },
  {
    "text": "so we uh published a blog post on lyftengineeringblogenge.lift.com you can read more about it there",
    "start": "583080",
    "end": "590040"
  },
  {
    "start": "589000",
    "end": "589000"
  },
  {
    "text": "um and to give you a sense of what we now have now that Envoy Powers the vast",
    "start": "590040",
    "end": "595800"
  },
  {
    "text": "majority of network requests in the Lyft apps is we get these real-time",
    "start": "595800",
    "end": "600839"
  },
  {
    "text": "dashboards and statistics on what's happening at scale and this might seem",
    "start": "600839",
    "end": "606899"
  },
  {
    "text": "very simple to you this is table Stakes when you're building any sort of service",
    "start": "606899",
    "end": "612000"
  },
  {
    "text": "eye product but what you have to understand is that the mobile landscape is years behind when it comes to this",
    "start": "612000",
    "end": "617760"
  },
  {
    "text": "kind of level of observability and if you were to build this with any of the",
    "start": "617760",
    "end": "623519"
  },
  {
    "text": "existing networking engines you'd probably either be losing out on a lot",
    "start": "623519",
    "end": "628620"
  },
  {
    "text": "of data or you'd be degrading the user experience and so the fact that Envoy has such a strong focus on rich and",
    "start": "628620",
    "end": "636779"
  },
  {
    "text": "optimized observability out of the box means that we get a lot of this stuff more or less for free and then stats get",
    "start": "636779",
    "end": "643320"
  },
  {
    "text": "added Upstream in the main Envoy project we can take advantage of those and and add them to our observability",
    "start": "643320",
    "end": "650339"
  },
  {
    "text": "so this is really huge uh and probably one of the main um main advantages that we now have by",
    "start": "650339",
    "end": "657720"
  },
  {
    "text": "powering the lift platforms with Envoy Mobile on the client side so",
    "start": "657720",
    "end": "663839"
  },
  {
    "start": "661000",
    "end": "661000"
  },
  {
    "text": "I want to paint a picture here a little bit and just talk about um the road to Bringing Envoy to mobile",
    "start": "663839",
    "end": "670980"
  },
  {
    "text": "and uh the the obstacles or the challenges that we had along the way and",
    "start": "670980",
    "end": "678540"
  },
  {
    "text": "um envoys this highly deployed widely used product right so it's it's already",
    "start": "678540",
    "end": "684240"
  },
  {
    "text": "been quite heavily optimized and works quite well right um so you would think you just plug that",
    "start": "684240",
    "end": "691620"
  },
  {
    "text": "into an app and start using it to make requests and everything's beautiful",
    "start": "691620",
    "end": "696959"
  },
  {
    "text": "um well it turns out that the environments in which mobile applications run tends to be quite",
    "start": "696959",
    "end": "702839"
  },
  {
    "text": "different than a server application so to paint in very broad Strokes here",
    "start": "702839",
    "end": "709019"
  },
  {
    "text": "in a server environment you tend to have a very stable internet connection you're",
    "start": "709019",
    "end": "714660"
  },
  {
    "text": "directly wired into the backbone you have a wired connection to the network",
    "start": "714660",
    "end": "719700"
  },
  {
    "text": "it tends to be quite fast if it's not you'll probably change vendors right you have control over who is providing this",
    "start": "719700",
    "end": "728279"
  },
  {
    "text": "service if you don't like it if there's an outage you go and open a ticket you work with your provider you work through",
    "start": "728279",
    "end": "734579"
  },
  {
    "text": "it is not the status quo it is not the normal level of operation you tend to have a certain level of reliability that",
    "start": "734579",
    "end": "743279"
  },
  {
    "text": "you're expecting out of your infrastructure and you have control right where if uh you're on a provider",
    "start": "743279",
    "end": "750240"
  },
  {
    "text": "you're on premises and you don't like any of the quality of service that you're getting you have some amount of",
    "start": "750240",
    "end": "756240"
  },
  {
    "text": "agency in terms of uh moving that over I'm not saying it's simple but you do have that level of control",
    "start": "756240",
    "end": "763640"
  },
  {
    "text": "you contrast that to mobile and mobile networks are inherently",
    "start": "763680",
    "end": "769820"
  },
  {
    "text": "unreliable not only do you not control the carrier side and the provider side",
    "start": "769820",
    "end": "775800"
  },
  {
    "text": "of it you also don't control where the device is physically located you don't",
    "start": "775800",
    "end": "780959"
  },
  {
    "text": "you don't control the health of the device that your application is running on you don't",
    "start": "780959",
    "end": "786660"
  },
  {
    "text": "control how how constrained it is you you have a wide amount of variability in",
    "start": "786660",
    "end": "794639"
  },
  {
    "text": "terms of the quality and the performance envelopes of devices that your users are",
    "start": "794639",
    "end": "799920"
  },
  {
    "text": "running um you have a lot of carriers and this is even more true if you operate outside",
    "start": "799920",
    "end": "807360"
  },
  {
    "text": "of just North America which is primarily where Lyft operates uh your users can configure their device",
    "start": "807360",
    "end": "814980"
  },
  {
    "text": "in many ways and you don't really have the option to say oh your configuration isn't really one that we like and so",
    "start": "814980",
    "end": "822120"
  },
  {
    "text": "we're not going to support you everything has to work",
    "start": "822120",
    "end": "827360"
  },
  {
    "start": "827000",
    "end": "827000"
  },
  {
    "text": "we made some measurements and some of the numbers are a little small on the chart but just look at the variability",
    "start": "827959",
    "end": "835200"
  },
  {
    "text": "in terms of the the bars here um the bottom here is 80 85 success rate",
    "start": "835200",
    "end": "842220"
  },
  {
    "text": "the top is around 98 success rate and what this is measuring is the success",
    "start": "842220",
    "end": "847500"
  },
  {
    "text": "rate by carrier and by networking library that we've measured uh with one",
    "start": "847500",
    "end": "852779"
  },
  {
    "text": "of the lift apps uh over the span of 30 days and what this helps illustrate is that",
    "start": "852779",
    "end": "860339"
  },
  {
    "text": "not only is there a wide amount of variability across carriers",
    "start": "860339",
    "end": "865680"
  },
  {
    "text": "but also the top performing device or operating system is not consistent",
    "start": "865680",
    "end": "871620"
  },
  {
    "text": "neither is the top performing networking Library and this is helpful to make the point",
    "start": "871620",
    "end": "879060"
  },
  {
    "text": "that we don't control where what carrier our",
    "start": "879060",
    "end": "884100"
  },
  {
    "text": "users are running their devices on we need to offer them the best possible service regardless of where they are",
    "start": "884100",
    "end": "890940"
  },
  {
    "text": "and this is another reason why using Envoy mobiles has been helpful to us because if you see this and you're using",
    "start": "890940",
    "end": "899160"
  },
  {
    "text": "one of the uh the the the networking engine that's shipping with the operating system you",
    "start": "899160",
    "end": "905820"
  },
  {
    "text": "have very little control over how much you can influence that in order to help fix or Bridge some of these gaps that",
    "start": "905820",
    "end": "912600"
  },
  {
    "text": "you're seeing here all right so we've talked a little bit",
    "start": "912600",
    "end": "917820"
  },
  {
    "text": "about mobile constraints um here's some more devices have a finite amount of memory",
    "start": "917820",
    "end": "924180"
  },
  {
    "text": "that you are competing with the rest of the application for right they have unreliable connectivity we",
    "start": "924180",
    "end": "930300"
  },
  {
    "text": "touched on that there are many carriers you have to support them all user configurations you can install",
    "start": "930300",
    "end": "936500"
  },
  {
    "text": "a HTTP proxy to run on your phone you know VPN you can configure your DNS",
    "start": "936500",
    "end": "942480"
  },
  {
    "text": "settings to point to something that returns garbage data half the time",
    "start": "942480",
    "end": "947880"
  },
  {
    "text": "um users are frequently moving between networks and between interfaces and physical radios on the device as well",
    "start": "947880",
    "end": "954839"
  },
  {
    "text": "where and this is especially true of lyft's use cases where you might be",
    "start": "954839",
    "end": "960000"
  },
  {
    "text": "requesting a ride as you're exiting your condo building entering the elevator leaving your Wi-Fi right and those",
    "start": "960000",
    "end": "966060"
  },
  {
    "text": "requests still have to perform as best as they possibly can or you might be trying to unlock a scooter uh between",
    "start": "966060",
    "end": "973560"
  },
  {
    "text": "large buildings uh this is a fun one the operating",
    "start": "973560",
    "end": "978779"
  },
  {
    "text": "system can kill your app effectively at any moment but typically when it's misbehaving and generally you don't want",
    "start": "978779",
    "end": "985800"
  },
  {
    "text": "to be the reason why the operating system is killing you right so we need to make sure that the networking layer",
    "start": "985800",
    "end": "991980"
  },
  {
    "text": "is not responsible or is not overly hungry for these resources",
    "start": "991980",
    "end": "997820"
  },
  {
    "text": "um another tricky thing with with mobile deployments is that you can't SSH into a",
    "start": "998040",
    "end": "1003680"
  },
  {
    "text": "production environment and troubleshoot why something might not be working well uh you really need to rely on your",
    "start": "1003680",
    "end": "1009860"
  },
  {
    "text": "observability and more often than not in the mobile space that just means that you have very little insight into what's",
    "start": "1009860",
    "end": "1016820"
  },
  {
    "text": "happening and that's yet another reason why the observability angle of envoys hugely helpful to us",
    "start": "1016820",
    "end": "1024160"
  },
  {
    "text": "um from the developer experience point of view uh if you're one of the things",
    "start": "1024319",
    "end": "1030500"
  },
  {
    "text": "that we had to tackle bringing Envoy to the mobile side was getting it working and compiling in the Ides the mobile",
    "start": "1030500",
    "end": "1038600"
  },
  {
    "text": "application developers use right so now you can build and run Envoy in xcode or",
    "start": "1038600",
    "end": "1045079"
  },
  {
    "text": "with Android studio and still have full access to the uh the profilers that ship",
    "start": "1045079",
    "end": "1050480"
  },
  {
    "text": "with those or be able to set breakpoints which is pretty nice but that was certainly some amount of work that we",
    "start": "1050480",
    "end": "1056660"
  },
  {
    "text": "had to do another concern on mobile is binary size because we ship a single binary to all",
    "start": "1056660",
    "end": "1064039"
  },
  {
    "text": "of our users we need to really be careful how much heft we're adding to that binary",
    "start": "1064039",
    "end": "1069980"
  },
  {
    "text": "especially if they're updating Weekly right and you don't want to balloon the",
    "start": "1069980",
    "end": "1075200"
  },
  {
    "text": "application size just because you wanted to add some observability into your networking layer",
    "start": "1075200",
    "end": "1081760"
  },
  {
    "start": "1080000",
    "end": "1080000"
  },
  {
    "text": "uh we learned some things by Rolling this out first of all we've learned that",
    "start": "1081980",
    "end": "1087799"
  },
  {
    "text": "both IOS and Android tend to perform in some pretty surprising ways",
    "start": "1087799",
    "end": "1093160"
  },
  {
    "text": "so one example we discovered the hard way that Android can block some DNS",
    "start": "1093160",
    "end": "1099140"
  },
  {
    "text": "resolutions when the when the app is backgrounded and when the device is in",
    "start": "1099140",
    "end": "1104780"
  },
  {
    "text": "low power mode and so we had to go and experiment with various different ways",
    "start": "1104780",
    "end": "1111860"
  },
  {
    "text": "that we could perform these CNS resolutions prod at the at the source code for Android and try and understand",
    "start": "1111860",
    "end": "1117500"
  },
  {
    "text": "how we could work around this uh another one that took us quite a",
    "start": "1117500",
    "end": "1122660"
  },
  {
    "text": "while to discover is that Android uses dual stack sockets um and for some carrier configurations",
    "start": "1122660",
    "end": "1129140"
  },
  {
    "text": "this meant that if you were trying to connect to an ipv4 address those users",
    "start": "1129140",
    "end": "1134780"
  },
  {
    "text": "just couldn't connect at all and so what we ended up figuring out that we needed to do is on Android we now Force IPv6",
    "start": "1134780",
    "end": "1143059"
  },
  {
    "text": "addresses so if it's an ipv4 address we map it to an equivalent IPv6 address so",
    "start": "1143059",
    "end": "1148100"
  },
  {
    "text": "that the the connection can be made otherwise it it can't even connect and",
    "start": "1148100",
    "end": "1153260"
  },
  {
    "text": "this was certainly not something that we intuitively knew so we always Force IPv6 on Android for",
    "start": "1153260",
    "end": "1159260"
  },
  {
    "text": "that reason on iOS it also that OS also has its own",
    "start": "1159260",
    "end": "1165140"
  },
  {
    "text": "quirks uh and what we found is that the envoy uses quite a few and both Envoy",
    "start": "1165140",
    "end": "1172340"
  },
  {
    "text": "and Envoy Mobile use quite a few uh C plus plus static State uh C plus Constructors and what iOS in particular",
    "start": "1172340",
    "end": "1179960"
  },
  {
    "text": "does when an application is shutting down and it's being terminated is that it might go and free up some of those",
    "start": "1179960",
    "end": "1186559"
  },
  {
    "text": "static resources which means that if something's still accessing that it'll crash so this was a little surprising to",
    "start": "1186559",
    "end": "1194059"
  },
  {
    "text": "us because we found that when we had Envoy mobile enabled in our experiments those users were were experiencing way",
    "start": "1194059",
    "end": "1201679"
  },
  {
    "text": "more crashes but those crashes weren't happening while they were using the application they were happening while",
    "start": "1201679",
    "end": "1206780"
  },
  {
    "text": "they were shutting it down while they were Force quitting the app and so that's this added quite a bit of noise to even though it wasn't degrading the",
    "start": "1206780",
    "end": "1213980"
  },
  {
    "text": "user experience necessarily it was adding quite a bit of noise to how our",
    "start": "1213980",
    "end": "1219919"
  },
  {
    "text": "mobile device developers look at our overall observability for crash rates and we're saying oh well this this thing",
    "start": "1219919",
    "end": "1225980"
  },
  {
    "text": "isn't stable at all it's crashing well it turned out that it's it's fine it just happens to crash when you're",
    "start": "1225980",
    "end": "1231620"
  },
  {
    "text": "shutting it down and you know we've been working through some of these uh one by",
    "start": "1231620",
    "end": "1236660"
  },
  {
    "text": "one guarding against some of the state that might disappear But ultimately it's still still something that can happen",
    "start": "1236660",
    "end": "1243799"
  },
  {
    "text": "uh and this is um just a cost that you have to pay uh",
    "start": "1243799",
    "end": "1248900"
  },
  {
    "text": "if you're working in any sort of jvm interacting with uh with native code is",
    "start": "1248900",
    "end": "1253940"
  },
  {
    "text": "that you do have to cross the jni and that can it can be costly but also it's just cumbersome more often than not so",
    "start": "1253940",
    "end": "1260660"
  },
  {
    "text": "we try to minimize how often we cross that barrier so some of the things that we did in",
    "start": "1260660",
    "end": "1266299"
  },
  {
    "start": "1262000",
    "end": "1262000"
  },
  {
    "text": "order to address some of these concerns um for one trimming binary size we were",
    "start": "1266299",
    "end": "1272120"
  },
  {
    "text": "able to run some analyzes using tools like bloaty or um or other other means and try and",
    "start": "1272120",
    "end": "1279320"
  },
  {
    "text": "identify um where some of the heft was coming from and at this point we've gotten the",
    "start": "1279320",
    "end": "1284780"
  },
  {
    "text": "the overhead of linking Envoy mobile into apps to be less than five Megs generally speaking which is not very",
    "start": "1284780",
    "end": "1292940"
  },
  {
    "text": "light but um for applications that tend to be you know 50 plus Megs in size it um it's",
    "start": "1292940",
    "end": "1301700"
  },
  {
    "text": "it's a good enough trade-off in our case at least for Lyft uh IDE integration so this is something",
    "start": "1301700",
    "end": "1308539"
  },
  {
    "start": "1305000",
    "end": "1305000"
  },
  {
    "text": "that that we worked on um with uh some open source projects like uh the bazel rules xcode proj set a",
    "start": "1308539",
    "end": "1316580"
  },
  {
    "text": "rule set where you can run build and run Envoy and you have full access to all of the sources",
    "start": "1316580",
    "end": "1323120"
  },
  {
    "text": "um a c plus in this case there's some Objective C plus plus Objective C Swift you can step through those break points",
    "start": "1323120",
    "end": "1329360"
  },
  {
    "text": "use lldb and this has been extremely helpful in terms of understanding how um",
    "start": "1329360",
    "end": "1335539"
  },
  {
    "text": "how things work under the hood where if you do run into an edge case that you try and understand you have access to um",
    "start": "1335539",
    "end": "1342140"
  },
  {
    "text": "to to that same thing for Android Studio uh so some of the things that uh the",
    "start": "1342140",
    "end": "1349220"
  },
  {
    "start": "1346000",
    "end": "1346000"
  },
  {
    "text": "team's been working on recently um so earlier I mentioned that Envoy",
    "start": "1349220",
    "end": "1354740"
  },
  {
    "text": "mobile Powers 98 of lyft's mobile network requests so there's a two",
    "start": "1354740",
    "end": "1360740"
  },
  {
    "text": "percent holdout that we're keeping there part of that is to continue running comparison experiments with the uh the",
    "start": "1360740",
    "end": "1367700"
  },
  {
    "text": "previous networking Stacks that we were shipping with but another reason is that we do have a number of gaps where we",
    "start": "1367700",
    "end": "1374539"
  },
  {
    "text": "still don't offer uh full support for certain configurations and those are",
    "start": "1374539",
    "end": "1380299"
  },
  {
    "text": "generally they fall into two buckets one is vpns and one is HTTP proxies that",
    "start": "1380299",
    "end": "1385880"
  },
  {
    "text": "users can install and run on their phones so on the VPN front we recently added support for vpns on Android",
    "start": "1385880",
    "end": "1392900"
  },
  {
    "text": "this required moving from one DNS resolver to another that's backed by a",
    "start": "1392900",
    "end": "1399679"
  },
  {
    "text": "different system call that allows us to operate in the background in low power mode and uh and supports vpns",
    "start": "1399679",
    "end": "1407659"
  },
  {
    "text": "um so that that's now done uh we have work in progress actually the the code here is mostly shipped and we're running",
    "start": "1407659",
    "end": "1414980"
  },
  {
    "text": "some production experiments to see how we perform when the user has an HTTP proxy installed on Android",
    "start": "1414980",
    "end": "1422860"
  },
  {
    "text": "we um recently made a change so that Envoy can delegate some of the",
    "start": "1422919",
    "end": "1430400"
  },
  {
    "text": "um some of the SSL certificate chain uh evaluation to the operating system so",
    "start": "1430400",
    "end": "1436580"
  },
  {
    "text": "that you're consistent with whatever the OS provides and whatever the OS trusts",
    "start": "1436580",
    "end": "1443000"
  },
  {
    "text": "um so one of the main remaining gaps that we still have is HTTP proxies on iOS a lot of the code that was written",
    "start": "1443000",
    "end": "1449780"
  },
  {
    "text": "for proxy support on Android will be portable here and will work but there's a few things that still need to be done",
    "start": "1449780",
    "end": "1456140"
  },
  {
    "text": "such as parsing and interpreting pack files and within the next few months we should",
    "start": "1456140",
    "end": "1463520"
  },
  {
    "text": "have that up and running so this is really the last big piece of core functionality the last main rollout",
    "start": "1463520",
    "end": "1469700"
  },
  {
    "text": "Gap that uh that currently we require delegating to",
    "start": "1469700",
    "end": "1475220"
  },
  {
    "text": "um to to the uh alternate Legacy stacks uh another thing that we want to",
    "start": "1475220",
    "end": "1480980"
  },
  {
    "text": "experiment with is quick quick and HTTP HTTP 3. so this is something that",
    "start": "1480980",
    "end": "1486080"
  },
  {
    "text": "unformobile does support uh at the moment but we haven't run any production experiments and so there's probably some",
    "start": "1486080",
    "end": "1492559"
  },
  {
    "text": "stuff that we'll uncover once we start turning that on and running some production experiments but the fact that",
    "start": "1492559",
    "end": "1498740"
  },
  {
    "text": "Envoy has rich quick and HTTP 3 support does mean that we do get a lot of that",
    "start": "1498740",
    "end": "1505580"
  },
  {
    "text": "um more or less for free and actually that's something that I I want to reiterate is that",
    "start": "1505580",
    "end": "1511100"
  },
  {
    "text": "um the envelope mobile project it lives in a separate git repo but ultimately it it vendors uh Envoy as it gets up module",
    "start": "1511100",
    "end": "1518539"
  },
  {
    "text": "and we tend to keep that up to date on a weekly basis uh and what that means is that as more stats or bug fixes or",
    "start": "1518539",
    "end": "1525620"
  },
  {
    "text": "features added upstream and Envoy we get to benefit from that and so do all the users that we deploy to",
    "start": "1525620",
    "end": "1532360"
  },
  {
    "text": "and another thing that some contributors from Google are working on is improving",
    "start": "1532360",
    "end": "1537500"
  },
  {
    "text": "uh the XDS integration and support from a mobile perspective so caching some of",
    "start": "1537500",
    "end": "1543320"
  },
  {
    "text": "the XCS values and generally just making it work well on mobile",
    "start": "1543320",
    "end": "1550240"
  },
  {
    "start": "1550000",
    "end": "1550000"
  },
  {
    "text": "um I had some slides on how the architecture works I'll I'll brush through this pretty briefly because I'm",
    "start": "1550700",
    "end": "1555740"
  },
  {
    "text": "running a long time but um at a very high level what's going on here is that you have uh different",
    "start": "1555740",
    "end": "1562779"
  },
  {
    "text": "Frameworks and and products that we that we produce such as Frameworks for iOS",
    "start": "1562779",
    "end": "1568100"
  },
  {
    "text": "Frameworks for Android a common C and C plus layer that these bindings delegate",
    "start": "1568100",
    "end": "1573500"
  },
  {
    "text": "to and then ultimately that calls out into Envoy and recently we've also been putting",
    "start": "1573500",
    "end": "1581539"
  },
  {
    "text": "more love into not just the Swift and kotlin apis but uh First Class C plus",
    "start": "1581539",
    "end": "1587600"
  },
  {
    "text": "plus apis that also call into this Common Core um so",
    "start": "1587600",
    "end": "1593980"
  },
  {
    "text": "mostly three you can think of it in three pieces you have sort of the user-facing apis you have the the middle",
    "start": "1593980",
    "end": "1601039"
  },
  {
    "text": "core Bridge layer that then calls into the C plus native code and Envoy",
    "start": "1601039",
    "end": "1606380"
  },
  {
    "text": "uh I will skip through this um but I'm happy to dive into more details I'll just stop on this slide",
    "start": "1606380",
    "end": "1613400"
  },
  {
    "text": "real quick because what are the ways where we interoperate between uh kotlin Java Swift Objective C is we effectively",
    "start": "1613400",
    "end": "1622039"
  },
  {
    "text": "allow the platform layer those higher level language layers to Define",
    "start": "1622039",
    "end": "1627740"
  },
  {
    "text": "callbacks and closures and functions that are invoked either uh during Envoy",
    "start": "1627740",
    "end": "1633320"
  },
  {
    "text": "filters or at very various parts of the pipeline and we'll go and carry some",
    "start": "1633320",
    "end": "1640460"
  },
  {
    "text": "state for uh either that that step in in the filter chain such as like stream",
    "start": "1640460",
    "end": "1646159"
  },
  {
    "text": "Intel and carry it back up to the platform layer where we'll go in and deserialize it at that layer so that's",
    "start": "1646159",
    "end": "1653000"
  },
  {
    "text": "sort of how um we can communicate across languages",
    "start": "1653000",
    "end": "1658360"
  },
  {
    "text": "uh and this illustrates it a little bit where you have the envoy engine at the",
    "start": "1658520",
    "end": "1664520"
  },
  {
    "text": "upper left that's configured with those higher level languages that goes and translates things into uh an Envoy set",
    "start": "1664520",
    "end": "1673940"
  },
  {
    "text": "of Concepts which effectively calls back into that middle layer which then",
    "start": "1673940",
    "end": "1679419"
  },
  {
    "text": "invokes uh the the the the C functions that are passed in converted into top",
    "start": "1679419",
    "end": "1685820"
  },
  {
    "text": "level uh language lambdas at the at the very top um so just briefly over the last few",
    "start": "1685820",
    "end": "1693020"
  },
  {
    "text": "years there's uh over a dozen folks who've been contributing to the project uh I've been working on it for the last",
    "start": "1693020",
    "end": "1699440"
  },
  {
    "text": "year but ultimately um some folks have been working on it since long before that and so I just",
    "start": "1699440",
    "end": "1704480"
  },
  {
    "text": "wanted to call that out we have contributors from within Lyft from within Google but also from elsewhere in",
    "start": "1704480",
    "end": "1711260"
  },
  {
    "text": "the community and uh of course every time that you've contributed something to Upstream Envoy we've been able to to",
    "start": "1711260",
    "end": "1719179"
  },
  {
    "text": "benefit from that in in many ways in our project as well so that's it",
    "start": "1719179",
    "end": "1725779"
  },
  {
    "start": "1723000",
    "end": "1723000"
  },
  {
    "text": "um I can open it up for questions",
    "start": "1725779",
    "end": "1729159"
  },
  {
    "text": "[Applause]",
    "start": "1731530",
    "end": "1738559"
  },
  {
    "text": "yes",
    "start": "1738559",
    "end": "1741100"
  },
  {
    "text": "yeah that's a great question so to repeat uh the context is from the perspective of a room full of server",
    "start": "1756620",
    "end": "1762260"
  },
  {
    "text": "Engineers um how what sort of opportunities does this unlock from from a server",
    "start": "1762260",
    "end": "1768679"
  },
  {
    "text": "perspective well for one if you have any sort of expertise within your your",
    "start": "1768679",
    "end": "1775159"
  },
  {
    "text": "server team in terms of how Envoy Works how to configure filters or stats that",
    "start": "1775159",
    "end": "1781340"
  },
  {
    "text": "domain knowledge applies on the mobile side now as well so um your networking team your server",
    "start": "1781340",
    "end": "1788360"
  },
  {
    "text": "networking team can now collaborate more closely with your client networking team if uh if you adopt Envoy mobile and",
    "start": "1788360",
    "end": "1794419"
  },
  {
    "text": "you've already adopted Envoy on the server so that's one another is that",
    "start": "1794419",
    "end": "1799640"
  },
  {
    "text": "like I mentioned if you if you do any sort of optimizations or bug fixes in",
    "start": "1799640",
    "end": "1806480"
  },
  {
    "text": "code that happens to be shared between Envoy mobile and Envoy proxy on the server side that ends up in benefiting",
    "start": "1806480",
    "end": "1813559"
  },
  {
    "text": "mobile clients as well so in terms of sharing the code base that's helpful I",
    "start": "1813559",
    "end": "1818840"
  },
  {
    "text": "mentioned compatibility and consistency earlier where if you have a filter that",
    "start": "1818840",
    "end": "1824000"
  },
  {
    "text": "operates bilaterally then it you can be running the same filter on your server",
    "start": "1824000",
    "end": "1830419"
  },
  {
    "text": "as you are on the client and you have a high degree of confidence that they're going to be compatible because they're",
    "start": "1830419",
    "end": "1835640"
  },
  {
    "text": "they're using the exact same code right so a common example there is compression and decompression where you know that",
    "start": "1835640",
    "end": "1842299"
  },
  {
    "text": "you know you're unlikely to run into an edge case where one broadly compressor compresses things",
    "start": "1842299",
    "end": "1848840"
  },
  {
    "text": "one way but it's incompatible with an alternate implementation right it's the same implementation so there's a number",
    "start": "1848840",
    "end": "1854659"
  },
  {
    "text": "of ways and there's even things beyond that where",
    "start": "1854659",
    "end": "1859899"
  },
  {
    "text": "by sharing by understanding and knowing that you're",
    "start": "1859899",
    "end": "1864980"
  },
  {
    "text": "using the same networking engine on both ends of that connection there are some optimizations that you can do as well so",
    "start": "1864980",
    "end": "1870620"
  },
  {
    "text": "it extends Beyond just developer productivity there's also some aspects of of end user performance involved",
    "start": "1870620",
    "end": "1879279"
  },
  {
    "text": "yes Matt wants to ask something which is kind of scary do you want to answer it as well",
    "start": "1879679",
    "end": "1886520"
  },
  {
    "text": "I I just wanted to say real quick that as server Engineers we tend to be very",
    "start": "1886520",
    "end": "1892460"
  },
  {
    "text": "excited that you know we're 99.99 success rate but the reality is",
    "start": "1892460",
    "end": "1899179"
  },
  {
    "text": "that the client might be 100 broken right I mean that's like a pervasive problem so I just wanted to add that as",
    "start": "1899179",
    "end": "1907399"
  },
  {
    "text": "server Engineers we need to care what is happening on the client because we can be serving 100 success and there's",
    "start": "1907399",
    "end": "1915080"
  },
  {
    "text": "broken Json or something and the client is a hundred percent broken so just wanted to add that we should",
    "start": "1915080",
    "end": "1921860"
  },
  {
    "text": "care more about the end to end problem here um and I I think as JP was saying that",
    "start": "1921860",
    "end": "1929240"
  },
  {
    "text": "with the shared Library we can participate more right um there's just more there's more shared",
    "start": "1929240",
    "end": "1935240"
  },
  {
    "text": "knowledge because I think historically at most companies there's these silos there's the client people and the server",
    "start": "1935240",
    "end": "1941840"
  },
  {
    "text": "people and I think that's not super productive so I just wanted to add that color",
    "start": "1941840",
    "end": "1947179"
  },
  {
    "text": "no that's some great color matte and just briefly on that what we discovered is when we do look at um server-side",
    "start": "1947179",
    "end": "1954140"
  },
  {
    "text": "success rate versus uh success rate from the perspective of the client um we have seen some surprises there",
    "start": "1954140",
    "end": "1960260"
  },
  {
    "text": "where uh the um the numbers didn't match up and so we had uh additional insight into where to",
    "start": "1960260",
    "end": "1966919"
  },
  {
    "text": "invest in terms of bridging that Gap I don't know how we're doing on time I'm happy to take more questions",
    "start": "1966919",
    "end": "1972860"
  },
  {
    "text": "okay all right yes",
    "start": "1972860",
    "end": "1976480"
  },
  {
    "text": "yeah okay so the question is um that uh the audience member noticed that there",
    "start": "1997039",
    "end": "2002140"
  },
  {
    "text": "were different success rates across different uh networking libraries and across different carriers and operating",
    "start": "2002140",
    "end": "2008140"
  },
  {
    "text": "systems and in some cases Envoy mobile is underperforming or um rather URL session or okay CPU is",
    "start": "2008140",
    "end": "2015340"
  },
  {
    "text": "outperforming Envoy mobile because of the observability that we now have we",
    "start": "2015340",
    "end": "2020380"
  },
  {
    "text": "are able to discover these gaps where previously um okay well maybe we're just on a",
    "start": "2020380",
    "end": "2026260"
  },
  {
    "text": "single networking engine per operating system but we still didn't have as much of that visibility into the disparity",
    "start": "2026260",
    "end": "2033580"
  },
  {
    "text": "both um from within operating systems or within carriers or sometimes even",
    "start": "2033580",
    "end": "2039279"
  },
  {
    "text": "geographically where carriers end up sometimes a b testing Network",
    "start": "2039279",
    "end": "2044440"
  },
  {
    "text": "configurations geographically and so you end up having someone in Detroit that",
    "start": "2044440",
    "end": "2049960"
  },
  {
    "text": "has a very different networking experience than someone in Manhattan for example so yes there's still some areas",
    "start": "2049960",
    "end": "2057339"
  },
  {
    "text": "where uh it's some specific some specific areas where the alternate",
    "start": "2057339",
    "end": "2065320"
  },
  {
    "text": "networking engines are outperforming what we can do with Envoy mobile but because we have that added observability",
    "start": "2065320",
    "end": "2071980"
  },
  {
    "text": "we know the areas where we can go and dig into and optimize and potentially fix some issues and our barrier to fully",
    "start": "2071980",
    "end": "2081040"
  },
  {
    "text": "rolling out at least to 98 percent was to outperform globally right or to match",
    "start": "2081040",
    "end": "2086138"
  },
  {
    "text": "or outperform globally and so we looked at a number of top-level business metrics to make sure that we weren't",
    "start": "2086139",
    "end": "2091358"
  },
  {
    "text": "taking any step back there even though in some specific areas we might be underperforming other areas we're",
    "start": "2091359",
    "end": "2096878"
  },
  {
    "text": "outperforming the the ideas that um overall we we didn't take a step back",
    "start": "2096879",
    "end": "2104339"
  },
  {
    "text": "one more okay one more yes",
    "start": "2104400",
    "end": "2109319"
  },
  {
    "text": "right um so the question is uh how can other companies go and perform some of the same measurements and experiments",
    "start": "2117040",
    "end": "2123579"
  },
  {
    "text": "that we did and ultimately this is one of the reasons why we've invested in",
    "start": "2123579",
    "end": "2129280"
  },
  {
    "text": "offway Mobile is because of the observability that we can get out of it so in many ways what you're asking is",
    "start": "2129280",
    "end": "2136420"
  },
  {
    "text": "how can you get the same level of observability with the alternate stacks and the truth is it's very hard to to",
    "start": "2136420",
    "end": "2143140"
  },
  {
    "text": "accomplish that so what we ended up doing is we uh knowingly degrade the experience for",
    "start": "2143140",
    "end": "2151780"
  },
  {
    "text": "some users on the alternate networking stacks on URL session or okhgp in order",
    "start": "2151780",
    "end": "2157119"
  },
  {
    "text": "to add additional instrumentation right because that ends up competing for resources so we know that that there's a",
    "start": "2157119",
    "end": "2163480"
  },
  {
    "text": "hit there and we sample a small percentage of user traffic that we",
    "start": "2163480",
    "end": "2169060"
  },
  {
    "text": "randomize in order to compare with the same type of observability overhead on",
    "start": "2169060",
    "end": "2176380"
  },
  {
    "text": "Envoy mobile right because you can't necessarily compare Envoy Mobile's optimize stats to other stats that would",
    "start": "2176380",
    "end": "2185440"
  },
  {
    "text": "otherwise be adding overhead because that's not comparing Apples to Apples so we have the same sort of heavyweight",
    "start": "2185440",
    "end": "2190980"
  },
  {
    "text": "instrumentation on both ends and then we'll run at scale public experiments and sometimes take",
    "start": "2190980",
    "end": "2199180"
  },
  {
    "text": "multiple weeks of gathering data in order to understand how both perform",
    "start": "2199180",
    "end": "2204880"
  },
  {
    "text": "okay uh thank you very much for your time [Applause]",
    "start": "2204880",
    "end": "2211440"
  }
]