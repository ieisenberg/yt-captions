[
  {
    "start": "0",
    "end": "70000"
  },
  {
    "text": "all right hello folks and welcome to anatomy of a kubernetes release success through team and tools um as you",
    "start": "80",
    "end": "6640"
  },
  {
    "text": "can see this is part two we actually gave the part one section of this talk at the open source summit china virtual",
    "start": "6640",
    "end": "13759"
  },
  {
    "text": "event um so if you missed that i'm sure you can go back and check that out this time we talked about in that talk a little",
    "start": "13759",
    "end": "20240"
  },
  {
    "text": "bit about um kind of the overall structure of sig release for kubernetes um today we're",
    "start": "20240",
    "end": "26000"
  },
  {
    "text": "going to dive a little bit deeper into the technical side of things specifically in the release engineering subproject my name is daniel",
    "start": "26000",
    "end": "32800"
  },
  {
    "text": "mangum i am the ci signal lead for the kubernetes 1.19 release i'm also part of the release engineering",
    "start": "32800",
    "end": "39840"
  },
  {
    "text": "sub project and a branch manager which we can talk about what that is in a little bit and i'm joined today by sasha grener who",
    "start": "39840",
    "end": "47520"
  },
  {
    "text": "is the tech lead um for sig release and is also a branch manager and part of",
    "start": "47520",
    "end": "52800"
  },
  {
    "text": "the release engineering sub project so we're excited to tell you a little bit about what we kind of do on a daily",
    "start": "52800",
    "end": "57920"
  },
  {
    "text": "basis and also hopefully how you can get involved and understand a little bit of the areas where we are",
    "start": "57920",
    "end": "64320"
  },
  {
    "text": "looking for new contributors and that sort of thing so without any further ado i'll go ahead and jump into our content here",
    "start": "64320",
    "end": "71360"
  },
  {
    "start": "70000",
    "end": "145000"
  },
  {
    "text": "so a brief overview of what we're talking about today we're going to look at how we actually",
    "start": "71360",
    "end": "76560"
  },
  {
    "text": "technically make kubernetes releases so there's a lot of team and process that goes into things a lot of different",
    "start": "76560",
    "end": "82880"
  },
  {
    "text": "roles roles that folks play but today we're going to talk exactly about you know the commands we run the",
    "start": "82880",
    "end": "88400"
  },
  {
    "text": "tools we use and what actually happens to make that binary available for you to download",
    "start": "88400",
    "end": "94240"
  },
  {
    "text": "we're going to give a overview of the release engineering sub project so this is a sub project of sig release",
    "start": "94240",
    "end": "100799"
  },
  {
    "text": "specifically around building the tooling um and and running the actual releases as well as making sure",
    "start": "100799",
    "end": "106960"
  },
  {
    "text": "branches for different releases are up to date uh and running patch releases and that sort of thing and then sasha is going to take",
    "start": "106960",
    "end": "113920"
  },
  {
    "text": "over and do a bit more of a deep dive into the tooling where the tooling lives how it's developed how it's versioned",
    "start": "113920",
    "end": "120880"
  },
  {
    "text": "and how it's used to do different parts of the release process and how we're continuing to make that",
    "start": "120880",
    "end": "126079"
  },
  {
    "text": "more seamless and a more robust tool to be able to use for kubernetes and and also increasingly for other projects",
    "start": "126079",
    "end": "133520"
  },
  {
    "text": "as well as i mentioned before this is the second part of this talk so if you'd like a more broad overview of sig release",
    "start": "133520",
    "end": "140640"
  },
  {
    "text": "please go check out the previous talk that we gave and there's a link for that below",
    "start": "140640",
    "end": "146239"
  },
  {
    "start": "145000",
    "end": "247000"
  },
  {
    "text": "all right so giving you kind of just an overview of the different roles of folks in the release engineering",
    "start": "146239",
    "end": "151840"
  },
  {
    "text": "sub projects and this has actually changed pretty recently so you're getting very up-to-date information",
    "start": "151840",
    "end": "156879"
  },
  {
    "text": "um so so we used to have a branch management team and a patch release team so you can imagine um in kubernetes",
    "start": "156879",
    "end": "164160"
  },
  {
    "text": "there are release branches for for every release and in kubernetes we support the last three",
    "start": "164160",
    "end": "169519"
  },
  {
    "text": "releases um so it's a rolling cycle when a new release comes out we drop support um for for the third oldest um in that",
    "start": "169519",
    "end": "176959"
  },
  {
    "text": "cycle and there's so there's two main roles here one of them is branch management which is basically",
    "start": "176959",
    "end": "182480"
  },
  {
    "text": "making sure we're getting the release branch ready for the next release and then there's the patch release team which is making sure necessary fixes",
    "start": "182480",
    "end": "189680"
  },
  {
    "text": "um and improvements are made on those uh older versions of kubernetes um and patching those over and then",
    "start": "189680",
    "end": "196800"
  },
  {
    "text": "making those patch releases as you can see their branch managers usually cut minor releases and follow",
    "start": "196800",
    "end": "202800"
  },
  {
    "text": "the release cycle and the patch release team takes care of cherry picking some of those fixes that need to be",
    "start": "202800",
    "end": "208879"
  },
  {
    "text": "included in previous releases especially if they're security vulnerabilities or bugs or things like that",
    "start": "208879",
    "end": "214480"
  },
  {
    "text": "um recently the patch release team and branch management team has actually been consolidated into one",
    "start": "214480",
    "end": "220400"
  },
  {
    "text": "as you've kind of heard me talk about some of the different responsibilities you can imagine how there's a lot of overlap there so a lot of expertise you",
    "start": "220400",
    "end": "228000"
  },
  {
    "text": "gain in using the tooling and running some of these releases is really applicable to both roles so",
    "start": "228000",
    "end": "233280"
  },
  {
    "text": "having more folks around that are able to help out with both of these responsibilities is just more advantageous to the project",
    "start": "233280",
    "end": "239599"
  },
  {
    "text": "um so those have consolidated recently so folks like sasha and myself help out on both of those sides of",
    "start": "239599",
    "end": "245680"
  },
  {
    "text": "things all right so looking at the actual tooling that we use to run this release",
    "start": "245680",
    "end": "252159"
  },
  {
    "start": "247000",
    "end": "454000"
  },
  {
    "text": "so the commands we run the what actually happens behind the scenes all of that sort of thing all of this tooling lives in the",
    "start": "252159",
    "end": "258239"
  },
  {
    "text": "kubernetes release repo so um you can see the link to the github repo right there",
    "start": "258239",
    "end": "263520"
  },
  {
    "text": "so anything that happens there any of the issues that are tracking improvements we want to make any of the pr's are opening are happening against",
    "start": "263520",
    "end": "269600"
  },
  {
    "text": "that repo and it contains tooling for interacting with github interacting with google cloud build",
    "start": "269600",
    "end": "278080"
  },
  {
    "text": "all the different services that we use increasingly it's becoming a little more generic so that those",
    "start": "278080",
    "end": "283840"
  },
  {
    "text": "libraries that we write to be able to interact with those services can rapidly be used to iterate on new",
    "start": "283840",
    "end": "289280"
  },
  {
    "text": "commands and new functionality um so that's one of the things that's going right now and um",
    "start": "289280",
    "end": "294560"
  },
  {
    "text": "you'll see there that uh it's a big transition from bash to go so there's a number of advantages for",
    "start": "294560",
    "end": "300960"
  },
  {
    "text": "this but before i get into that one thing to mention is you know why was all this written in bash well like your",
    "start": "300960",
    "end": "306479"
  },
  {
    "text": "typical project that you've probably started it's really easy to get started just using bash scripts and and they'll get",
    "start": "306479",
    "end": "312160"
  },
  {
    "text": "you most of the way as kubernetes has become more production",
    "start": "312160",
    "end": "317199"
  },
  {
    "text": "ready and you know since the 1.0 release where it's really increased in adoption there's a desire to have a more testable",
    "start": "317199",
    "end": "324479"
  },
  {
    "text": "release tool and a more robust release tool as it does more things and the kind of complexity of releases",
    "start": "324479",
    "end": "330639"
  },
  {
    "text": "increases um also there's just a lot of folks who are familiar with how to write go it's a very approachable language",
    "start": "330639",
    "end": "336560"
  },
  {
    "text": "so transitioning to a go-based tool is a little bit easier to get new contributors in and and make more rapid",
    "start": "336560",
    "end": "343360"
  },
  {
    "text": "progress so that that process is still ongoing honestly it's something that will probably last for quite some time",
    "start": "343360",
    "end": "349759"
  },
  {
    "text": "because a lot of these scripts touch a lot of different parts of the kubernetes code base",
    "start": "349759",
    "end": "355840"
  },
  {
    "text": "but it's a very easy and approachable way for new folks to get involved personally how i got involved with lease",
    "start": "355840",
    "end": "361840"
  },
  {
    "text": "engineering at first is just transact transitioning some of that functionality from the bash scripts",
    "start": "361840",
    "end": "366960"
  },
  {
    "text": "over to go we do follow a workflow based approach for the tooling so",
    "start": "366960",
    "end": "372000"
  },
  {
    "text": "as i mentioned before the functionality is is attempted to be abstracted into general purpose libraries",
    "start": "372000",
    "end": "378720"
  },
  {
    "text": "so what that looks like is if we need um to transition a bash script that goes and generates",
    "start": "378720",
    "end": "384960"
  },
  {
    "text": "release notes from all the pr's that have been merged into the master branch there's some",
    "start": "384960",
    "end": "390720"
  },
  {
    "text": "generic tooling that we can use there so likely what we're doing is interacting with github pulling down some of those pr's inspecting some of their content",
    "start": "390720",
    "end": "397759"
  },
  {
    "text": "that sort of thing a lot of that functionality can be abstracted into general things that we can use to",
    "start": "397759",
    "end": "403440"
  },
  {
    "text": "interact with github and then if we later on want to do you know more sophisticated things like inspect",
    "start": "403440",
    "end": "408560"
  },
  {
    "text": "labels or do something like that we already have some of that library and shared knowledge built out and we can",
    "start": "408560",
    "end": "414960"
  },
  {
    "text": "add new new functionality really quickly the tooling also helps facilitate that merging of the two",
    "start": "414960",
    "end": "421759"
  },
  {
    "text": "roles that i talked about before of the patch release team in the branch management team obviously if you're using a consistent",
    "start": "421759",
    "end": "428080"
  },
  {
    "text": "single tool to be able to execute all of these different steps that are required for",
    "start": "428080",
    "end": "433360"
  },
  {
    "text": "both patch releases and alpha beta rc in official releases if you're using the same tool for that",
    "start": "433360",
    "end": "439280"
  },
  {
    "text": "it's just a little bit easier to context switch you also get things like helpful tooling",
    "start": "439280",
    "end": "444400"
  },
  {
    "text": "that you know tells you what you need to provide for a command and helpful messages and usage messages for the",
    "start": "444400",
    "end": "451120"
  },
  {
    "text": "different commands in the tool so now to actually take a look",
    "start": "451120",
    "end": "456160"
  },
  {
    "start": "454000",
    "end": "555000"
  },
  {
    "text": "at what the tool is um the main the main heart of release engineering is crow",
    "start": "456160",
    "end": "461520"
  },
  {
    "text": "so you'll see that short for kubernetes release toolbox so basically what this is is a single",
    "start": "461520",
    "end": "467680"
  },
  {
    "text": "command line interface that does all these different things that are required for these different",
    "start": "467680",
    "end": "473280"
  },
  {
    "text": "roles and release engineering so you'll see an example of some of the commands um below like generating the change logs sending",
    "start": "473280",
    "end": "480000"
  },
  {
    "text": "emails even to mailing lists um that sort of thing so having this single command number one gives us",
    "start": "480000",
    "end": "485919"
  },
  {
    "text": "a single binary that we can version and release so um just behind the scenes we usually",
    "start": "485919",
    "end": "491840"
  },
  {
    "text": "open an issue uh before we make any release and we kind of detail the steps there as we go through",
    "start": "491840",
    "end": "497199"
  },
  {
    "text": "the release process um and so we can have generic things like you always run you know krell mock stage here um",
    "start": "497199",
    "end": "504960"
  },
  {
    "text": "in in this process and so we can use those generic commands as opposed to just kind of doing like one-off bash scripts or running things in uis",
    "start": "504960",
    "end": "511759"
  },
  {
    "text": "um so so this is really useful uh as well this this krell command line tool can",
    "start": "511759",
    "end": "517279"
  },
  {
    "text": "also be used by um processes so if you want to use it as part of a job that runs in prow or",
    "start": "517279",
    "end": "523919"
  },
  {
    "text": "something like that it can also be automated and used for facilitating those types of workflows so",
    "start": "523919",
    "end": "530560"
  },
  {
    "text": "really flexible tool and we're continuing to build out some of the functionality there so if you're interested in getting involved",
    "start": "530560",
    "end": "536720"
  },
  {
    "text": "um definitely check that out now i'm going to hand it off to sasha who's going to talk a little bit",
    "start": "536720",
    "end": "542480"
  },
  {
    "text": "more about these specific commands and what happens um in a release and what kind of the sequence of",
    "start": "542480",
    "end": "548959"
  },
  {
    "text": "commands that you may run as a release manager would look like so sasha feel free to take it away",
    "start": "548959",
    "end": "556080"
  },
  {
    "start": "555000",
    "end": "695000"
  },
  {
    "text": "thanks then great overview so far so before we dive actually into how to",
    "start": "556240",
    "end": "561440"
  },
  {
    "text": "cut a kubernetes release i have prepared a short demo for you i would like to talk a little bit about",
    "start": "561440",
    "end": "566720"
  },
  {
    "text": "the theoretical aspects and how it works in general so if we look at the release cycle then",
    "start": "566720",
    "end": "573200"
  },
  {
    "text": "we usually have to cut alpha releases better releases so some pre-releases",
    "start": "573200",
    "end": "578480"
  },
  {
    "text": "then at some later point in the release cycle we will create a release candidate and from that",
    "start": "578480",
    "end": "584000"
  },
  {
    "text": "release candidate on we will also create a release branch which got management managed afterwards by branch",
    "start": "584000",
    "end": "590160"
  },
  {
    "text": "management and at some later point at the end of the release cycle we usually cut the final release otherwise it would",
    "start": "590160",
    "end": "596560"
  },
  {
    "text": "not make much sense at all and in between we also have some patch releases",
    "start": "596560",
    "end": "601600"
  },
  {
    "text": "so usually they come on a monthly basis and since we were able to unify our tooling",
    "start": "601600",
    "end": "608160"
  },
  {
    "text": "we were also able to unify our participants so we have in the green boxes here the branch management and the patch release team",
    "start": "608160",
    "end": "614560"
  },
  {
    "text": "which are just separated but in general right now they use the same tooling and they also can rely on the same yeah",
    "start": "614560",
    "end": "622480"
  },
  {
    "text": "on the same environment so from a tooling perspective we can see that we have the krell release toolbox and inside the create",
    "start": "622480",
    "end": "629600"
  },
  {
    "text": "release toolbox as then already mentioned we have for example krell gcp manager and krell gcp manager",
    "start": "629600",
    "end": "636079"
  },
  {
    "text": "is yeah stands for google cloud build manager and this has been completely rewritten",
    "start": "636079",
    "end": "643200"
  },
  {
    "text": "in go to be actually testable but then corel gcp manager",
    "start": "643200",
    "end": "648399"
  },
  {
    "text": "will get executed locally on on your local machine this will call a will trigger a google",
    "start": "648399",
    "end": "654800"
  },
  {
    "text": "cloud build build actually which uses ngo and nego is part of our technical depth so it's a",
    "start": "654800",
    "end": "661600"
  },
  {
    "text": "huge bash script which actually yeah for example builds artifacts and puts them into release buckets",
    "start": "661600",
    "end": "669040"
  },
  {
    "text": "anago will also call into corel change log so this is also pretty new and corel changelog takes care of yeah",
    "start": "669040",
    "end": "677279"
  },
  {
    "text": "modifying the kubernetes release repository generating to change logs and then putting back those data in for",
    "start": "677279",
    "end": "683680"
  },
  {
    "text": "energo and then go will take those outputs like mock markdown and yeah and also modifications on a git",
    "start": "683680",
    "end": "690880"
  },
  {
    "text": "repository and we'll put it into the repository at all so that sounds a little bit complicated",
    "start": "690880",
    "end": "697839"
  },
  {
    "text": "but what how do we actually cut a release and as dan already mentioned we have to",
    "start": "697839",
    "end": "704399"
  },
  {
    "text": "create an issue to cut a release in kubernetes sick release so that everyone from sick release is aware of",
    "start": "704399",
    "end": "710399"
  },
  {
    "text": "that we are going to plan to cut a release i will show you that later on and then we just have to run four steps so we",
    "start": "710399",
    "end": "716800"
  },
  {
    "text": "have to go to mock stage mock release stage and release so mock stage and stage are usually the",
    "start": "716800",
    "end": "725120"
  },
  {
    "text": "same steps but um the mocking is just executed and then on non disruptive way so we don't actually we",
    "start": "725120",
    "end": "732240"
  },
  {
    "text": "just build artifacts for example but we don't put them into production",
    "start": "732240",
    "end": "737440"
  },
  {
    "text": "and all everything else will be done automatically so for",
    "start": "737440",
    "end": "742720"
  },
  {
    "text": "example cutting creating release branches building the artifacts putting them into the right directories will be all done",
    "start": "742720",
    "end": "748480"
  },
  {
    "text": "automatically the release manager just has to take care of that it is executed in the right order",
    "start": "748480",
    "end": "756480"
  },
  {
    "start": "755000",
    "end": "820000"
  },
  {
    "text": "and what does stage do so stage just verifies that the build environment is",
    "start": "756480",
    "end": "761920"
  },
  {
    "text": "correctly set up it sets the right build versions i will show you that later on and it will also build the releases via",
    "start": "761920",
    "end": "768720"
  },
  {
    "text": "cubecross which is a container image and this produces binary artifacts container images",
    "start": "768720",
    "end": "774959"
  },
  {
    "text": "and we will also create some release notes and then we put all those data into a bucket",
    "start": "774959",
    "end": "781760"
  },
  {
    "text": "in a google cloud bucket and the release step will later on take those data and yeah we'll push to get repository",
    "start": "781760",
    "end": "788720"
  },
  {
    "text": "changes like the tags the actual change logs to github and it",
    "start": "788720",
    "end": "793760"
  },
  {
    "text": "will also update the github release page and then it will also push the container images",
    "start": "793760",
    "end": "798959"
  },
  {
    "text": "into the gcr.io registry for consuming from end users then we have",
    "start": "798959",
    "end": "806000"
  },
  {
    "text": "also to create a create a release announcement and this is a separate step and the release stage will pre-create",
    "start": "806000",
    "end": "813680"
  },
  {
    "text": "that release announcement for us and will archive and the release on the google cloud storage so why do we have to do it in a separate",
    "start": "813680",
    "end": "820079"
  },
  {
    "start": "820000",
    "end": "900000"
  },
  {
    "text": "step um usually we do it at the announcement in a separate",
    "start": "820079",
    "end": "825279"
  },
  {
    "text": "command like called krell announce and this also has been written from from a new",
    "start": "825279",
    "end": "830399"
  },
  {
    "text": "perspective and we have to do it because we also want to create some",
    "start": "830399",
    "end": "835440"
  },
  {
    "text": "depths and rpm packages and those packages are currently built by google build admins",
    "start": "835440",
    "end": "840480"
  },
  {
    "text": "and we usually have to reach out to them that they help us to build the packages and then we can send out the",
    "start": "840480",
    "end": "845519"
  },
  {
    "text": "announcements so there's a slight delay and we are going to automate that away in the future and maybe in one year we",
    "start": "845519",
    "end": "851920"
  },
  {
    "text": "we can also have uh directly send the announcement right after the release or directly in the release",
    "start": "851920",
    "end": "857120"
  },
  {
    "text": "would be really really cool um yeah we use we stick to zen crit um",
    "start": "857120",
    "end": "862720"
  },
  {
    "text": "which sends the mail to the right mailing list so the credit announce tool is highly workflow driven as then already",
    "start": "862720",
    "end": "868639"
  },
  {
    "text": "mentioned so there is no need to do any other interaction than just exporting a set",
    "start": "868639",
    "end": "873680"
  },
  {
    "text": "api key and then the announcement will be put into the right place so this whole release",
    "start": "873680",
    "end": "881760"
  },
  {
    "text": "cutting process will be done for each alpha beta and release candidate during the whole cycle so we do it multiple",
    "start": "881760",
    "end": "887040"
  },
  {
    "text": "times and the same process applies to patch releases as well but now we can have a look at a real",
    "start": "887040",
    "end": "894160"
  },
  {
    "text": "life example and i can just share my screen for you and if we now look into kubernetes stick",
    "start": "894160",
    "end": "901680"
  },
  {
    "start": "900000",
    "end": "1015000"
  },
  {
    "text": "release in the repository then we can see that right now somebody cuts a 119 rc2 which is pretty exciting and i",
    "start": "901680",
    "end": "908800"
  },
  {
    "text": "would like to say okay if i want to cut a new release then i just can create a new issue and",
    "start": "908800",
    "end": "914880"
  },
  {
    "text": "then we have our template for cutting a new release so it's pretty handy already we just",
    "start": "914880",
    "end": "920399"
  },
  {
    "text": "have to fill out some basic information when it will happen and we have to screenshot unhealthy",
    "start": "920399",
    "end": "925920"
  },
  {
    "text": "release branch test grid boards and then we have a checklist which guides us through the overall release",
    "start": "925920",
    "end": "932480"
  },
  {
    "text": "so we have all four release steps mock stage mock release stage and release",
    "start": "932480",
    "end": "938399"
  },
  {
    "text": "and after that we can cut the packages and send the announcement and that's basically it if we now look",
    "start": "938399",
    "end": "945519"
  },
  {
    "text": "at the previous release which is 119 rc1",
    "start": "945519",
    "end": "951040"
  },
  {
    "text": "and then we can see that this already happened some weeks ago and",
    "start": "951040",
    "end": "958000"
  },
  {
    "text": "the table is already filled out so some release manager callers in that case and run mock stage",
    "start": "958079",
    "end": "964959"
  },
  {
    "text": "we are gcp manager minus minus stage and then some command line flags how do they these command line flags",
    "start": "964959",
    "end": "972560"
  },
  {
    "text": "look like if we just look at the help page of krell gcp manager then we can see that there are some",
    "start": "972560",
    "end": "979040"
  },
  {
    "text": "flags which are necessary and the most important flags are for example stage and release so we have",
    "start": "979040",
    "end": "984800"
  },
  {
    "text": "to specify if we want to stage or to release and also there no mock flag as can be",
    "start": "984800",
    "end": "990000"
  },
  {
    "text": "used in combination with that and the branch is necessary if we want to cut a release not against",
    "start": "990000",
    "end": "996399"
  },
  {
    "text": "the master branch for example release candidates would be cut against the release branch",
    "start": "996399",
    "end": "1002800"
  },
  {
    "text": "and that's the basic command execution and usually",
    "start": "1002800",
    "end": "1010079"
  },
  {
    "text": "how does it look like so if we just create a mock stage release then we can go into",
    "start": "1010079",
    "end": "1016880"
  },
  {
    "text": "google cloud and this looks like this so we are here on google cloud build and and it executes the whole build shop",
    "start": "1016880",
    "end": "1024160"
  },
  {
    "text": "so we can see the build gets started then it's cloning the release repository let",
    "start": "1024160",
    "end": "1029438"
  },
  {
    "text": "me just skip that it's not that exciting",
    "start": "1029439",
    "end": "1035280"
  },
  {
    "text": "it will build krell locally and then it will check",
    "start": "1035919",
    "end": "1043360"
  },
  {
    "text": "the pre-requisites so we just check out what yeah what krell version do we have",
    "start": "1043360",
    "end": "1050080"
  },
  {
    "text": "at hand right here so this is all executed directly in energo then energo will set the build version",
    "start": "1050080",
    "end": "1056320"
  },
  {
    "text": "which is kind of a jenkins build version this is that one and then it will already",
    "start": "1056320",
    "end": "1062000"
  },
  {
    "text": "find out which release is going to build so we can see okay and ago found out that we want to build 119 rc one",
    "start": "1062000",
    "end": "1068960"
  },
  {
    "text": "and it will also point us to some open prs at the release for the release",
    "start": "1068960",
    "end": "1075280"
  },
  {
    "text": "branch which are not necessary at that point um and then with we can start to prepare",
    "start": "1075280",
    "end": "1081600"
  },
  {
    "text": "the workspace and preparing the workspace is nothing more than just cloning kubernetes kubernetes and yeah",
    "start": "1081600",
    "end": "1088320"
  },
  {
    "text": "checking if the if the disk space is available and then we'll create attack so that's the first the first thing it",
    "start": "1088320",
    "end": "1094640"
  },
  {
    "text": "will check out the release branch and it will create the attack on on that release branch and then it",
    "start": "1094640",
    "end": "1100000"
  },
  {
    "text": "starts to call into cube cross which actually builds the artifacts",
    "start": "1100000",
    "end": "1105280"
  },
  {
    "text": "so those artifacts as already mentioned are in the first place the binary artifacts",
    "start": "1105280",
    "end": "1114000"
  },
  {
    "text": "for sure so we have to build kubernetes for linux amd64 and different other architectures",
    "start": "1114000",
    "end": "1120559"
  },
  {
    "text": "as well and then if that is done let me just scroll down a little bit",
    "start": "1120559",
    "end": "1126640"
  },
  {
    "text": "we also have to create container images so here we can see that it's starting to",
    "start": "1126640",
    "end": "1132640"
  },
  {
    "text": "build the container images for the cube api server for amd64 and also some other architectures as",
    "start": "1132640",
    "end": "1139039"
  },
  {
    "text": "well this will happen all on that build job after that we just generate the release",
    "start": "1139039",
    "end": "1145760"
  },
  {
    "text": "notes here we can see the output from generating the release notes for the release candidate",
    "start": "1145760",
    "end": "1152080"
  },
  {
    "text": "it will also create an html which will be later on used for the release",
    "start": "1152080",
    "end": "1157120"
  },
  {
    "text": "announcement and it will commit the release notes into the release branch as well as the master branch",
    "start": "1157120",
    "end": "1164720"
  },
  {
    "text": "then this whole source tree gets staged to gcp and",
    "start": "1164720",
    "end": "1172000"
  },
  {
    "text": "and that's pretty interesting because we have two different buckets for mocking and non-mocking and this is the",
    "start": "1172000",
    "end": "1178400"
  },
  {
    "start": "1175000",
    "end": "1400000"
  },
  {
    "text": "job for the for the actual release and we can see that the artifacts will land on kubernetes release",
    "start": "1178400",
    "end": "1184480"
  },
  {
    "text": "and if we now look into that bucket so this is the kubernetes release bucket",
    "start": "1184480",
    "end": "1191360"
  },
  {
    "text": "then we can see that we have different directories here and for example we have this staging",
    "start": "1191360",
    "end": "1197919"
  },
  {
    "text": "directory so now i just can check for 1 19.0",
    "start": "1197919",
    "end": "1205600"
  },
  {
    "text": "rc0 this is the build version which we created by energy automatically",
    "start": "1205600",
    "end": "1210799"
  },
  {
    "text": "and then we can see that it will put the source turbo in here and also the artifacts so",
    "start": "1210799",
    "end": "1216240"
  },
  {
    "text": "if we browse a little bit down here then we can see there we have some images md64 for example and then we can",
    "start": "1216240",
    "end": "1223679"
  },
  {
    "text": "see that we have the cube api server and the cube proxy and all other container images with which has been",
    "start": "1223679",
    "end": "1228799"
  },
  {
    "text": "built during the release the same applies to the binary",
    "start": "1228799",
    "end": "1234000"
  },
  {
    "text": "artifacts so if we look to gcp stage rc1 then",
    "start": "1234000",
    "end": "1240480"
  },
  {
    "text": "we can see that we also have for example kubernetes client for 368 here and everything",
    "start": "1240480",
    "end": "1248799"
  },
  {
    "text": "is in and looks pretty good and i already downloaded for us the tower",
    "start": "1248799",
    "end": "1256320"
  },
  {
    "text": "and if we look at this tower ball and we can see so it's that that tower",
    "start": "1256320",
    "end": "1261679"
  },
  {
    "text": "and i extracted it here that there's the release in our release html in there and we have a full",
    "start": "1261679",
    "end": "1267520"
  },
  {
    "text": "kubernetes repository in so",
    "start": "1267520",
    "end": "1272640"
  },
  {
    "text": "if we look at the current state of this repository then we can see that we are on the release branch and that we",
    "start": "1273520",
    "end": "1280480"
  },
  {
    "text": "have a commit on top of that which just updates the change log to 119 rc1 so we have all those changelog",
    "start": "1280480",
    "end": "1288000"
  },
  {
    "text": "modifications in here and it's basically the state",
    "start": "1288000",
    "end": "1293520"
  },
  {
    "text": "for end state for the staging for the staging step",
    "start": "1293520",
    "end": "1300720"
  },
  {
    "text": "and now we can go ahead and have a look into the release execution",
    "start": "1300720",
    "end": "1307520"
  },
  {
    "text": "so let's assume we this has been finished and was successful",
    "start": "1307520",
    "end": "1312880"
  },
  {
    "text": "then we would have to run the release stage yeah and the release stage just requires the build version",
    "start": "1312880",
    "end": "1319760"
  },
  {
    "text": "and we run great gcp manager minus minus release minus minus no mock and then specify the",
    "start": "1319760",
    "end": "1325919"
  },
  {
    "text": "rc and the build version and this is how the output looks like we just have the same",
    "start": "1325919",
    "end": "1334000"
  },
  {
    "text": "steps like preparing the workspace compiling krell running energo and",
    "start": "1334000",
    "end": "1341520"
  },
  {
    "text": "after that we can just push the git objects so we actually push the rc1 tag into the",
    "start": "1341520",
    "end": "1349120"
  },
  {
    "text": "official kubernetes repository and we also update the release branch so then we",
    "start": "1349120",
    "end": "1356480"
  },
  {
    "text": "just print out a div which shows us now that the change lock has been modified and will point to",
    "start": "1356480",
    "end": "1364559"
  },
  {
    "text": "the binary artifacts which are on dlk's io but those are not actually available at",
    "start": "1364559",
    "end": "1371200"
  },
  {
    "text": "this point they have to be promoted to the actual release in inside this release bucket so we have",
    "start": "1371200",
    "end": "1378320"
  },
  {
    "text": "to push the binaural release artifacts from the release candidate and this means we push the the container",
    "start": "1378320",
    "end": "1384880"
  },
  {
    "text": "images like done here and we also have to move the",
    "start": "1384880",
    "end": "1391360"
  },
  {
    "text": "the binary artifacts into the right place to be down to be able to download them directly via the change log",
    "start": "1392080",
    "end": "1399759"
  },
  {
    "text": "after that we update the github release page and then we have our usual github",
    "start": "1399840",
    "end": "1405039"
  },
  {
    "start": "1400000",
    "end": "1535000"
  },
  {
    "text": "release page which points to the change log and then we archive the release on on google cloud so if we now",
    "start": "1405039",
    "end": "1412640"
  },
  {
    "text": "look into the release bucket so this is the same the same kubernetes release bucket we",
    "start": "1412640",
    "end": "1418000"
  },
  {
    "text": "don't go to stage we just have a look into release and then we can check for",
    "start": "1418000",
    "end": "1425679"
  },
  {
    "text": "119 rc1 down here",
    "start": "1425679",
    "end": "1432880"
  },
  {
    "text": "and there we can see that all those artifacts are now available here and we can download them",
    "start": "1434480",
    "end": "1439679"
  },
  {
    "text": "so they are ready to be consumed from end users from that point on and we also have",
    "start": "1439679",
    "end": "1445840"
  },
  {
    "text": "in the kubernetes release some updated version markers for example latest 119 txt",
    "start": "1445840",
    "end": "1453440"
  },
  {
    "text": "shot should show us something like the latest available release which is",
    "start": "1453440",
    "end": "1459200"
  },
  {
    "text": "119 rc1 in that case yeah so from that point on we can consume",
    "start": "1459200",
    "end": "1467600"
  },
  {
    "text": "this is the changelog the changelog artifacts like all those here",
    "start": "1467600",
    "end": "1475120"
  },
  {
    "text": "and then we usually have to build the depth and rpms and after that has",
    "start": "1475120",
    "end": "1481200"
  },
  {
    "text": "been done we can use krell announce i can just",
    "start": "1481200",
    "end": "1487840"
  },
  {
    "text": "show you the help page to that as well we have to export as encrypt api key",
    "start": "1487919",
    "end": "1493120"
  },
  {
    "text": "and then we just you have to run krell announce and krell tries to find out the right email and",
    "start": "1493120",
    "end": "1498880"
  },
  {
    "text": "checks the right and correspondence in this email and then after that it will push the",
    "start": "1498880",
    "end": "1504960"
  },
  {
    "text": "announcement out which is based on that html i recently showed to you and this looks",
    "start": "1504960",
    "end": "1510480"
  },
  {
    "text": "like this for example we are on kubernetes announce and then we have the announcement kubernetes 119 rc1 is",
    "start": "1510480",
    "end": "1517360"
  },
  {
    "text": "now live and yeah that's basically the content from the html changelog with some",
    "start": "1517360",
    "end": "1525279"
  },
  {
    "text": "short hints to the actual changelog file and who created this mail",
    "start": "1525279",
    "end": "1531278"
  },
  {
    "text": "okay let me check that out",
    "start": "1531440",
    "end": "1538799"
  },
  {
    "start": "1535000",
    "end": "1625000"
  },
  {
    "text": "so what are our future plans so one of our biggest plan is to",
    "start": "1538799",
    "end": "1544400"
  },
  {
    "text": "transform all those bash into a golan based version it's not that easy i must admit we have",
    "start": "1544400",
    "end": "1549679"
  },
  {
    "text": "a lot of technical depth and for example finding out the right release version and yeah looking up the right remote",
    "start": "1549679",
    "end": "1556559"
  },
  {
    "text": "locations to find a set of information to create a release is not as easy as it may look like",
    "start": "1556559",
    "end": "1562080"
  },
  {
    "text": "and everything should be tested this is a raw a huge drawback we have right now we are not that able to actually test",
    "start": "1562080",
    "end": "1569120"
  },
  {
    "text": "changes on our bash scripts but we try to improve on that on that part for sure",
    "start": "1569120",
    "end": "1574559"
  },
  {
    "text": "and then we would like to further automate the release process for example yeah the release cut the release cut issue",
    "start": "1574559",
    "end": "1580640"
  },
  {
    "text": "usually could be automated this is really would be really really nice that we just use a command line tool which",
    "start": "1580640",
    "end": "1586000"
  },
  {
    "text": "automatically updates the issue for us and yeah for sure also cutting the devs on rpms is something we",
    "start": "1586000",
    "end": "1592880"
  },
  {
    "text": "have in our mind we're also working on a tool like it's called and this should take care of",
    "start": "1592880",
    "end": "1598960"
  },
  {
    "text": "cutting dabs on rpms for us and promoting them to the right locations we also have some new features in mind",
    "start": "1598960",
    "end": "1605200"
  },
  {
    "text": "for example like yeah adding container image artifacts to the changelog file they are currently not",
    "start": "1605200",
    "end": "1610480"
  },
  {
    "text": "part of those change logs and for example also adding cve information to the changelog",
    "start": "1610480",
    "end": "1616400"
  },
  {
    "text": "could be also pretty a pretty nice feature yeah and as i already mentioned make you",
    "start": "1616400",
    "end": "1621520"
  },
  {
    "text": "pkhe able to cut and publish that in rpm packages automatically",
    "start": "1621520",
    "end": "1626559"
  },
  {
    "start": "1625000",
    "end": "2135000"
  },
  {
    "text": "and i think that's it i hope you get got a good overview about how we cut releases and how the technical part looks like",
    "start": "1626559",
    "end": "1633200"
  },
  {
    "text": "and now i would like hand over to dan for a wrap up",
    "start": "1633200",
    "end": "1640799"
  },
  {
    "text": "oh i think we jumped too far there there we go uh thanks for for that really informative demo and for walking through",
    "start": "1640799",
    "end": "1647039"
  },
  {
    "text": "all of that sasha i imagine this is gonna be a nice resource for folks um as they come back and watch the",
    "start": "1647039",
    "end": "1653440"
  },
  {
    "text": "recording of this talk so i'm excited that we now have this out there um for anyone who has um stayed along this whole way um we",
    "start": "1653440",
    "end": "1660960"
  },
  {
    "text": "definitely are looking for more folks to jump in and contribute if you are interested in that please feel free to go and look at the issues",
    "start": "1660960",
    "end": "1668640"
  },
  {
    "text": "in the kubernetes release repo and you know say that you're open to working on one of them or reach out to",
    "start": "1668640",
    "end": "1674159"
  },
  {
    "text": "me or sasha directly we're in kubernetes slack and on twitter and that sort of thing so definitely",
    "start": "1674159",
    "end": "1679520"
  },
  {
    "text": "feel free to reach out and i think with that we can go ahead and move into a q a",
    "start": "1679520",
    "end": "1685279"
  },
  {
    "text": "session for anyone who has questions about what we just talked about or questions in general about the whole kubernetes release",
    "start": "1685279",
    "end": "1694000"
  },
  {
    "text": "process hey unfortunately dan",
    "start": "1694840",
    "end": "1703039"
  },
  {
    "text": "can't join today to answer any questions but i'm here to answer all of yours so first of all the first part of the",
    "start": "1703039",
    "end": "1710000"
  },
  {
    "text": "talk was recorded at cloud native virtual summit in china and will be available at the end of",
    "start": "1710000",
    "end": "1715360"
  },
  {
    "text": "august and i will post the link to the schedule and then we can you can watch the first part",
    "start": "1715360",
    "end": "1720960"
  },
  {
    "text": "if you missed it so let's go over to the first question so which branches",
    "start": "1720960",
    "end": "1726799"
  },
  {
    "text": "branches are used for what purpose oleg asked this yeah we have two types",
    "start": "1726799",
    "end": "1733440"
  },
  {
    "text": "of releases so first of all we have new miner releases which is for example 119.0",
    "start": "1733440",
    "end": "1740080"
  },
  {
    "text": "and then we have patch releases which is for example yeah 118.6 with",
    "start": "1740080",
    "end": "1746320"
  },
  {
    "text": "147 which has been released last week and for the purpose of patch releases we",
    "start": "1746320",
    "end": "1752880"
  },
  {
    "text": "usually stick to the release branches so release 118 is for 118 patch releases",
    "start": "1752880",
    "end": "1758480"
  },
  {
    "text": "and release 117 is for 117 patch releases and then we during the create the",
    "start": "1758480",
    "end": "1765440"
  },
  {
    "text": "release cycle which takes around about three to four months um we usually create release branches",
    "start": "1765440",
    "end": "1771120"
  },
  {
    "text": "new release branches for their actual release so first of all we create",
    "start": "1771120",
    "end": "1776320"
  },
  {
    "text": "releases from the master branch and then we create a release branch where we just continue cutting",
    "start": "1776320",
    "end": "1781919"
  },
  {
    "text": "our releases during the cycle next question also from oleg um how",
    "start": "1781919",
    "end": "1788960"
  },
  {
    "text": "is release cutting happening and are features going to be cherry picked into a new really",
    "start": "1788960",
    "end": "1794240"
  },
  {
    "text": "in the into the release branch yeah exactly that's how it works we during the cycle",
    "start": "1794240",
    "end": "1799440"
  },
  {
    "text": "we create a new release branch then we fast forward that branch or sync it up with the master branch",
    "start": "1799440",
    "end": "1805679"
  },
  {
    "text": "and so it doesn't mean that we if we create a new release branch that your feature won't land into the release",
    "start": "1805679",
    "end": "1811840"
  },
  {
    "text": "so we sync then up and this is our quality gate that we can decide when we want to have",
    "start": "1811840",
    "end": "1817120"
  },
  {
    "text": "um a new fast forward of the release branch for example and then we at some certain point we",
    "start": "1817120",
    "end": "1823600"
  },
  {
    "text": "decide to only allow cherry picks into the release branch and from that point on some other",
    "start": "1823600",
    "end": "1829039"
  },
  {
    "text": "quality measurements has to have to be already in place for example documentation and stuff like that",
    "start": "1829039",
    "end": "1837039"
  },
  {
    "text": "next question how do you manage dependencies between features um yeah usually the",
    "start": "1837039",
    "end": "1843679"
  },
  {
    "text": "developer of the feature has to take care of this but we get a lot of help from other six as well for example from sick architecture",
    "start": "1843679",
    "end": "1850320"
  },
  {
    "text": "or from the dedicated code owners or from api review who helps us to decide when and when",
    "start": "1850320",
    "end": "1858080"
  },
  {
    "text": "it's usually sensible to merge what and in which order so yeah usually it works",
    "start": "1858080",
    "end": "1864640"
  },
  {
    "text": "pretty well and for that we also have something like a release milestone for 119 is the 119 milestone and then we can",
    "start": "1864640",
    "end": "1871840"
  },
  {
    "text": "decide okay we have to merge those three pr's for example to actually land the whole feature",
    "start": "1871840",
    "end": "1879679"
  },
  {
    "text": "pablo asks and all features in the master branch are all features from the master branch automatically in the release",
    "start": "1879679",
    "end": "1886320"
  },
  {
    "text": "may it happen some that something is going to be removed in the release for example due to stability reasons",
    "start": "1886320",
    "end": "1893120"
  },
  {
    "text": "usually we don't remove anything we have the duplication policy and kubernetes in place so if something",
    "start": "1893120",
    "end": "1899600"
  },
  {
    "text": "already was inside of a release then we are not able to remove it up to the to the next release if we",
    "start": "1899600",
    "end": "1904960"
  },
  {
    "text": "encounter something like regressions then we yeah then we have to cherry pick",
    "start": "1904960",
    "end": "1910559"
  },
  {
    "text": "those into the release branches and in general yes every feature which is tracked so the",
    "start": "1910559",
    "end": "1918399"
  },
  {
    "text": "enhancements sub theme of sick release takes care of that so every tracked feature will also land",
    "start": "1918399",
    "end": "1923840"
  },
  {
    "text": "in the master and this will go and go into the release so there's always a little bit room for",
    "start": "1923840",
    "end": "1928960"
  },
  {
    "text": "exceptions for example we can say okay some pull request is absolutely",
    "start": "1928960",
    "end": "1934080"
  },
  {
    "text": "necessary but they miss the deadline from one or two days and then we can say okay let's just raise an",
    "start": "1934080",
    "end": "1941440"
  },
  {
    "text": "exception request and then approve it afterwards that's also possible",
    "start": "1941440",
    "end": "1947200"
  },
  {
    "text": "next question is testing the main reason for going to go so did you consider",
    "start": "1947360",
    "end": "1953279"
  },
  {
    "text": "using bets yes so testing don't know we did not consider using bats but we have our zi signals up team",
    "start": "1953279",
    "end": "1961600"
  },
  {
    "text": "which tracks the overall ci health status of the release branches",
    "start": "1961600",
    "end": "1966880"
  },
  {
    "text": "and also on the actually master branch and then we decide uh if master for",
    "start": "1966880",
    "end": "1973840"
  },
  {
    "text": "example we have multiple categories of tests we have master informing and master blocking for example",
    "start": "1973840",
    "end": "1979519"
  },
  {
    "text": "and if a test is failing in master blocking then we usually will not have a chance to cut",
    "start": "1979519",
    "end": "1985200"
  },
  {
    "text": "the release so we have to stabilize the ci before we have a chance to do the actual release cut here",
    "start": "1985200",
    "end": "1993200"
  },
  {
    "text": "okay we have three minutes left i think i can answer all those questions next question can you please show how to",
    "start": "1993200",
    "end": "2000320"
  },
  {
    "text": "generate release notes again oh oh and there is an and follow-up talk in",
    "start": "2000320",
    "end": "2006320"
  },
  {
    "text": "one and a half hour about the next generation of release notes it's from me and you will have a chance to see the",
    "start": "2006320",
    "end": "2012960"
  },
  {
    "text": "generation of the release notes there definitely and then uh if that's not enough then i'm happy to show you in person how",
    "start": "2012960",
    "end": "2018799"
  },
  {
    "text": "how we generate the release notes sure how do you handle multi-arc architectures in the release",
    "start": "2018799",
    "end": "2025440"
  },
  {
    "text": "um there are two types of multiple architectures so the first type is the container",
    "start": "2025440",
    "end": "2031279"
  },
  {
    "text": "images so for container images we use the moody pre-built multi-arc binaries",
    "start": "2031279",
    "end": "2038720"
  },
  {
    "text": "and use something like docker build x to build multi architecture images which",
    "start": "2038720",
    "end": "2044640"
  },
  {
    "text": "works pretty well and the binaries are built by cross compilation so we have a dedicated container image called",
    "start": "2044640",
    "end": "2050240"
  },
  {
    "text": "cubecross and cubecos can take care of cross compiling the release artifacts as binary",
    "start": "2050240",
    "end": "2055440"
  },
  {
    "text": "artifacts for us next question oh very interesting talk",
    "start": "2055440",
    "end": "2060878"
  },
  {
    "text": "thank you thank you for the nice feedback and do you feel like this pattern of releasing could apply to",
    "start": "2060879",
    "end": "2067040"
  },
  {
    "text": "some other artifact based release as well i'm not sure i mean our current strategy",
    "start": "2067040",
    "end": "2074000"
  },
  {
    "text": "of building releases is highly bound to google cloud resources we also don't use",
    "start": "2074000",
    "end": "2079919"
  },
  {
    "text": "something like docker hub or quay we just stick to the google container registry and promote our images there",
    "start": "2079919",
    "end": "2086480"
  },
  {
    "text": "this is pretty new for example we decided to use the community infrastructure to regularly",
    "start": "2086480",
    "end": "2092720"
  },
  {
    "text": "push our container images to a staging repository and from that staging repository we",
    "start": "2092720",
    "end": "2098320"
  },
  {
    "text": "promote the images into gcr.io slash kubernetes",
    "start": "2098320",
    "end": "2103359"
  },
  {
    "text": "minus api 0 1.18 something like this and so it's highly customized from my",
    "start": "2103359",
    "end": "2109119"
  },
  {
    "text": "perspective um but i think the pattern behind the technical aspects of cutting releases",
    "start": "2109119",
    "end": "2115119"
  },
  {
    "text": "can be really can be reused as well all right i think that's it from the",
    "start": "2115119",
    "end": "2122320"
  },
  {
    "text": "questions i'm in the kubecon maintainer sub channel and",
    "start": "2122320",
    "end": "2127599"
  },
  {
    "text": "there's a threat for this talk and if you have any other questions then i'm happy to answer them as well there",
    "start": "2127599",
    "end": "2133520"
  },
  {
    "text": "thanks see you",
    "start": "2133520",
    "end": "2137520"
  }
]