[
  {
    "text": "all right good afternoon everybody hope you know you got over to food coma after",
    "start": "30",
    "end": "5730"
  },
  {
    "text": "lunch you you know you're gonna get better after this session so we're here",
    "start": "5730",
    "end": "11730"
  },
  {
    "text": "today to talk about building your clock enthralling manager for for kubernetes",
    "start": "11730",
    "end": "17490"
  },
  {
    "text": "so there's been you know a lot of discussion around this if you've been attending you know the various sakes",
    "start": "17490",
    "end": "23130"
  },
  {
    "text": "like sig note and say cloud provider and the various you know claw provider SIG's like Sig VMware seeing OpenStack CWS and",
    "start": "23130",
    "end": "30269"
  },
  {
    "text": "so on we're we're gonna go there the documentation on this specific part of",
    "start": "30269",
    "end": "35399"
  },
  {
    "text": "the kubernetes codebase where the company's ecosystem is a little bit you know foggy so we're we wanted to give some documentation some overview some",
    "start": "35399",
    "end": "43320"
  },
  {
    "text": "you know more information on what is what is happening in this space before",
    "start": "43320",
    "end": "49110"
  },
  {
    "text": "we get started I just want to briefly introduce ourselves again I guess my name is Fabio poiseuillie I",
    "start": "49110",
    "end": "54989"
  },
  {
    "text": "work at VMware software engineer I'm working in upstream kubernetes and also on product on the side I'm also",
    "start": "54989",
    "end": "62449"
  },
  {
    "text": "co-leader co-chair of cig VMware and we have Chris Chris Chris odds from the",
    "start": "62449",
    "end": "68040"
  },
  {
    "text": "OpenStack foundation and my title says strategic program manager and kind of",
    "start": "68040",
    "end": "74369"
  },
  {
    "text": "what that means is I get to engage both with the OpenStack community which I've been involved with for I think eight or",
    "start": "74369",
    "end": "80700"
  },
  {
    "text": "nine years now as well as the kubernetes community and help try to help build collaborations between us two and so",
    "start": "80700",
    "end": "87299"
  },
  {
    "text": "it's really exciting to be here and talking about you know what I think is",
    "start": "87299",
    "end": "92579"
  },
  {
    "text": "an incredibly important tool for enabling kubernetes to run on any cloud",
    "start": "92579",
    "end": "98610"
  },
  {
    "text": "infrastructure awesome so today we have like agenda with it's divided in three",
    "start": "98610",
    "end": "103979"
  },
  {
    "text": "major blocks so we're going to talk about what's the print status then we're going to go over on how to build your",
    "start": "103979",
    "end": "109920"
  },
  {
    "text": "color controller manager and there's a third one we're gonna give you some examples you know taking you the color",
    "start": "109920",
    "end": "116100"
  },
  {
    "text": "provider OpenStack in a club provider via vSphere as examples so let's get started with the current state of the",
    "start": "116100",
    "end": "122340"
  },
  {
    "text": "cloud providers so today you know when you when you you know sometimes we hear",
    "start": "122340",
    "end": "127649"
  },
  {
    "text": "the term entry so when you hear entry what we really mean is that today when you download kubernetes you",
    "start": "127649",
    "end": "134410"
  },
  {
    "text": "download you know a bunch of drivers that are part of the kubernetes core and there's a list here so you can see we",
    "start": "134410",
    "end": "141280"
  },
  {
    "text": "have like 8 probably more than that because some of them were kind of deprecated over time because people are",
    "start": "141280",
    "end": "146470"
  },
  {
    "text": "not maintaining them but right now we have this 8 club providers built inside",
    "start": "146470",
    "end": "152110"
  },
  {
    "text": "of the kubernetes core so whenever you download it even with 114 so the very rest of these even 115 now you're gonna",
    "start": "152110",
    "end": "159730"
  },
  {
    "text": "have all the code for this club providers bundling to your kubernetes refineries and whenever you around them",
    "start": "159730",
    "end": "166270"
  },
  {
    "text": "you have all this unnecessary code because you know you're probably running kubernetes on one of these clouds",
    "start": "166270",
    "end": "172030"
  },
  {
    "text": "yourself or maybe not even using this code potentially so it's a lot of code",
    "start": "172030",
    "end": "178120"
  },
  {
    "text": "that is you know sometimes it's maintained sometimes it's you know less maintain the quality of the testing for",
    "start": "178120",
    "end": "185080"
  },
  {
    "text": "all these provider is very I would say it's a mixed bag ok and when it comes to",
    "start": "185080",
    "end": "191230"
  },
  {
    "text": "maintaining this it's really not something that people that are not working with a platform itself can do so",
    "start": "191230",
    "end": "197380"
  },
  {
    "text": "it's all delegated to other you know people that have the domain knowledge for that so why is there's a problem",
    "start": "197380",
    "end": "203620"
  },
  {
    "text": "obviously the problem is that you know kubernetes should not be in the business Copernicus Corps should not be in the",
    "start": "203620",
    "end": "209560"
  },
  {
    "text": "business of maintaining this drivers so drivers should be maintained independently by the companies or the",
    "start": "209560",
    "end": "216700"
  },
  {
    "text": "people that know that platform very well they have the domain knowledge for that platform and again if you you have a",
    "start": "216700",
    "end": "224260"
  },
  {
    "text": "deployment of kubernetes possibly you're not running that on all these different clouds at the same time you're running",
    "start": "224260",
    "end": "230140"
  },
  {
    "text": "on one single cloth so you want to have a more you know specific configuration for just that cloud so you don't want to",
    "start": "230140",
    "end": "236560"
  },
  {
    "text": "have all this craft you know it's part of the bynars and then we're gonna you know at some point we're gonna get over one particular problem with the actual",
    "start": "236560",
    "end": "243190"
  },
  {
    "text": "code you know later on the presentation this is a problem of scully",
    "start": "243190",
    "end": "248530"
  },
  {
    "text": "supportability you know given that a code is part of kubernetes poor it kind of implicitly",
    "start": "248530",
    "end": "254800"
  },
  {
    "text": "implies that it's supported or endorsed by the kubernetes poor you know team and this is not",
    "start": "254800",
    "end": "262150"
  },
  {
    "text": "necessarily true I mean the code is there because you know it was useful at the time and it's still useful but does not imply that",
    "start": "262150",
    "end": "268160"
  },
  {
    "text": "kubernetes is supporting that in any specific way one very big problem that",
    "start": "268160",
    "end": "274190"
  },
  {
    "text": "we have in the past specifically in the past I guess through three minor version of kubernetes being that there's been",
    "start": "274190",
    "end": "280340"
  },
  {
    "text": "some critical fixes that had to be delivered in those cloud providers so think of it like if there's a there's a",
    "start": "280340",
    "end": "287060"
  },
  {
    "text": "CVE that has to be fixed and the code of the CVE is specifically for that cloud",
    "start": "287060",
    "end": "292580"
  },
  {
    "text": "provider it has to go through the normal release cycle of kubernetes which means you know it has to go into a patch so he",
    "start": "292580",
    "end": "299150"
  },
  {
    "text": "has to go or into a new minor release so it takes time to get there and has to be",
    "start": "299150",
    "end": "304520"
  },
  {
    "text": "reviewed it has to go through the you know traditional review process of kubernetes which is you know fast you",
    "start": "304520",
    "end": "311660"
  },
  {
    "text": "know if you look at that if you compare that to a traditional software development cycle but it's still a long time if you need to go and fix one",
    "start": "311660",
    "end": "318470"
  },
  {
    "text": "specific problem that he'd have so in some of the work I think I mentioned",
    "start": "318470",
    "end": "324080"
  },
  {
    "text": "this before some of the work on some of the providers has actually stopped you know maybe months or years ago and some",
    "start": "324080",
    "end": "330680"
  },
  {
    "text": "of those providers aren't they're just you know being there and lying there as element in code and people are you don't",
    "start": "330680",
    "end": "336770"
  },
  {
    "text": "really want to hold a band-aid because sometimes when you pull you know rip off some of the code that is there you end",
    "start": "336770",
    "end": "341870"
  },
  {
    "text": "up with unintended consequences that you really want to get into especially if you're working on a release or kubernetes so if we want to fix this we",
    "start": "341870",
    "end": "351349"
  },
  {
    "text": "need to decouple the code that is cloud provider dependent from the core so to",
    "start": "351349",
    "end": "358669"
  },
  {
    "text": "fix this actually uh you know several years ago I think it was a 1.6 or 1.5",
    "start": "358669",
    "end": "364490"
  },
  {
    "text": "and people can give me honest on that but there was a proposal to create a clock controlling that clock controller",
    "start": "364490",
    "end": "370220"
  },
  {
    "text": "manager interface and this was done because we wanted to decouple the the",
    "start": "370220",
    "end": "375650"
  },
  {
    "text": "interface from the core of grenades obviously this is a is proved to be a",
    "start": "375650",
    "end": "382729"
  },
  {
    "text": "very long and painful process because again ripping the band-aid removing the code",
    "start": "382729",
    "end": "387870"
  },
  {
    "text": "you know decoupling that code that is tied into so many part of the kubernetes core is not an easy you know an easy",
    "start": "387870",
    "end": "394889"
  },
  {
    "text": "thing to do especially since you know some of the providers took some liberties in in terms of you know adding",
    "start": "394889",
    "end": "401310"
  },
  {
    "text": "stuff inside other part of the kubernetes 1/4 enemies code base so",
    "start": "401310",
    "end": "406470"
  },
  {
    "text": "ripping those out as being proved to be very challenging I think this process",
    "start": "406470",
    "end": "412530"
  },
  {
    "text": "has been going on for I think at least two years and now we're getting to a",
    "start": "412530",
    "end": "417900"
  },
  {
    "text": "point where we've started to move this code out so all the major providers have an out of tree implementation so they have a",
    "start": "417900",
    "end": "423770"
  },
  {
    "text": "CCM create it they can run the grown as a sidecar on the notes instead of being",
    "start": "423770",
    "end": "429180"
  },
  {
    "text": "bundled inside the kubernetes core and we're actually moving we're starting",
    "start": "429180",
    "end": "435870"
  },
  {
    "text": "moved the cloud provider code that is part of entry into staging repositories",
    "start": "435870",
    "end": "441180"
  },
  {
    "text": "so we're trying to you know rip the band-aid slowly instead of just you know taking one go the idea here is that you",
    "start": "441180",
    "end": "449070"
  },
  {
    "text": "know through the with the help of cyclop Revital which is kind of you know pulling the strings of all this work we",
    "start": "449070",
    "end": "456090"
  },
  {
    "text": "want to have by the end of 2019 so with the release that will be released at the",
    "start": "456090",
    "end": "461310"
  },
  {
    "text": "end of 2019 to remove all the entry collateral so if you are using a cloud",
    "start": "461310",
    "end": "467639"
  },
  {
    "text": "provider integration today or if you are building a clock or an integration today this this matters to you you have to be",
    "start": "467639",
    "end": "474240"
  },
  {
    "text": "sure that you get on this train to make sure you figure it out what is the best course of action for your deployment",
    "start": "474240",
    "end": "480840"
  },
  {
    "text": "with your own platform if you have if you're building one and the point of",
    "start": "480840",
    "end": "486180"
  },
  {
    "text": "doing all this is that at some point we want to have everything that is poor kubernetes to be completely free of",
    "start": "486180",
    "end": "492450"
  },
  {
    "text": "anything that is cloud provider dependent so no longer no more code that",
    "start": "492450",
    "end": "497700"
  },
  {
    "text": "is just for one platform inside kubernetes port everything will be offloaded to separate buyers and now",
    "start": "497700",
    "end": "505200"
  },
  {
    "text": "crazy going to talk about how we actually build a clock controller okay",
    "start": "505200",
    "end": "510330"
  },
  {
    "text": "thanks so nice so we kind of laid out the problems",
    "start": "510330",
    "end": "515800"
  },
  {
    "text": "of why you know the problem that we were facing is having entry providers and how to make a more level playing field and a",
    "start": "515800",
    "end": "521800"
  },
  {
    "text": "more sustainable ecosystem for the multitude of cloud providers that are coming in and you know one thing that's",
    "start": "521800",
    "end": "529510"
  },
  {
    "text": "really great about the community they've actually set up a huge amount of help for you to be able to build external",
    "start": "529510",
    "end": "536020"
  },
  {
    "text": "providers that can allow kubernetes to to be aware of the resources that are that are within your cloud so we have",
    "start": "536020",
    "end": "548470"
  },
  {
    "text": "this Cloud Controller manager which replaces the former keep controller manager and as a daemon that",
    "start": "548470",
    "end": "554740"
  },
  {
    "text": "enables the following cloud specific alerts there's a node controller in it",
    "start": "554740",
    "end": "560020"
  },
  {
    "text": "there's a route controller and a service controller now if you're familiar with",
    "start": "560020",
    "end": "565060"
  },
  {
    "text": "the cube controller manager it also had a volume controller in it and you may be asking yourself where is the volume",
    "start": "565060",
    "end": "570820"
  },
  {
    "text": "controller and this work has been largely taken over by the zorka's",
    "start": "570820",
    "end": "579040"
  },
  {
    "text": "largely been taken over by the open storage I mean by the CSI interface the",
    "start": "579040",
    "end": "587430"
  },
  {
    "text": "container storage interface and so you know by loading the CSI and external CSI",
    "start": "587430",
    "end": "593650"
  },
  {
    "text": "into your into your cluster you should be able to get a volume access and again",
    "start": "593650",
    "end": "599740"
  },
  {
    "text": "the nice thing about this is you you can use any sort of volume implementation that you want and it doesn't have to",
    "start": "599740",
    "end": "604780"
  },
  {
    "text": "necessarily be tied to your specific cloud implementation and so it gives you a lot of freedom and a lot of choice",
    "start": "604780",
    "end": "610770"
  },
  {
    "text": "okay so you say you want to build your own controller manager they're only three steps involved in this the first",
    "start": "612920",
    "end": "618589"
  },
  {
    "text": "is you create a go package that satisfies the cloud provider interface it's very basic interface it's pretty",
    "start": "618589",
    "end": "624559"
  },
  {
    "text": "clear on how to set it up and you provide an implementation for that and you have a go package and then there is",
    "start": "624559",
    "end": "632089"
  },
  {
    "text": "a you create a copy of the cloud controller manager main go function",
    "start": "632089",
    "end": "637100"
  },
  {
    "text": "which is part of the kubernetes distribution and import your package making sure that there's an init block",
    "start": "637100",
    "end": "643160"
  },
  {
    "text": "available and what this does is this creates an application that when you run it will connect to your cube API server",
    "start": "643160",
    "end": "650209"
  },
  {
    "text": "and provide the services that you need then you're done right there's no step two except for the building and testing",
    "start": "650209",
    "end": "655999"
  },
  {
    "text": "and packaging and everything else you have to do to have a successful cloud provider but but at its added edits at",
    "start": "655999",
    "end": "662359"
  },
  {
    "text": "its first level these are the things you have to do and the tools are there to help you succeed in it and so those are some of the things that were going to",
    "start": "662359",
    "end": "667579"
  },
  {
    "text": "cover over the next few slides okay",
    "start": "667579",
    "end": "673260"
  },
  {
    "text": "so all the interfaces that are within the cloud provider interface are a load",
    "start": "673260",
    "end": "679560"
  },
  {
    "text": "balancer in instances interface interface or zones interface for",
    "start": "679560",
    "end": "685920"
  },
  {
    "text": "clusters and an interface for routes and the important thing to remember about this is that you only have to implement",
    "start": "685920",
    "end": "692430"
  },
  {
    "text": "the things that your cloud actually provides so if you if zones don't make",
    "start": "692430",
    "end": "697620"
  },
  {
    "text": "sense for your cloud provider then you don't need to implement zones and when",
    "start": "697620",
    "end": "702660"
  },
  {
    "text": "we look at the interface right here like you can fit the entire interface on a single screen and so at every point",
    "start": "702660",
    "end": "709550"
  },
  {
    "text": "these functions have a bool associated with it that tells you whether or not",
    "start": "709550",
    "end": "714690"
  },
  {
    "text": "that interface is implemented and so even though you have all of these things there you only implement what you need",
    "start": "714690",
    "end": "721350"
  },
  {
    "text": "or you can deliver you know partially implemented cloud provider to your customers and still continue to to work",
    "start": "721350",
    "end": "728940"
  },
  {
    "text": "on the others the only thing that really",
    "start": "728940",
    "end": "734910"
  },
  {
    "text": "has to be implemented is your provider name and that's because this is passed",
    "start": "734910",
    "end": "740010"
  },
  {
    "text": "into the argument of your of your of your controller application to tell it to use that actual provider with the",
    "start": "740010",
    "end": "745860"
  },
  {
    "text": "cube API server okay so the next thing",
    "start": "745860",
    "end": "751740"
  },
  {
    "text": "that you need was to build a cloud controller binary the external clock controller runs as a separate binary",
    "start": "751740",
    "end": "757320"
  },
  {
    "text": "that interacts the kubernetes api service and it's been speak it's configured with the standard set of options and so when you build one of",
    "start": "757320",
    "end": "764070"
  },
  {
    "text": "these binaries if you actually run it and ask for help you're gonna get a long list of options that look you know pretty much like you wouldn't see",
    "start": "764070",
    "end": "770550"
  },
  {
    "text": "options for the cube api server starting",
    "start": "770550",
    "end": "775770"
  },
  {
    "text": "template is provided for you in the corona DS CCM directory and again it's",
    "start": "775770",
    "end": "781980"
  },
  {
    "text": "pretty simple like this is with a little bit of editing down you can fit the entire binary on a screen and the",
    "start": "781980",
    "end": "788340"
  },
  {
    "text": "important things that are happening here are you're setting your your you're importing",
    "start": "788340",
    "end": "793590"
  },
  {
    "text": "your cloud provider up here you're setting your commend to be the",
    "start": "793590",
    "end": "799430"
  },
  {
    "text": "app that is from Cloud Controller manager commanded so that's gonna pull",
    "start": "799430",
    "end": "804680"
  },
  {
    "text": "in your interface and then you're telling the command to execute and that",
    "start": "804680",
    "end": "809780"
  },
  {
    "text": "starts up the control loop and you're ready to go now there are some additional things that you need to do on",
    "start": "809780",
    "end": "815600"
  },
  {
    "text": "this like the application by itself isn't the best thing for deploy into into a cluster it's nice to be able to",
    "start": "815600",
    "end": "822400"
  },
  {
    "text": "load this into a docker container and then and then run that in your cluster and we'll talk about that a little bit",
    "start": "822400",
    "end": "828020"
  },
  {
    "text": "more later in the talk but the one thing that all of this doesn't do for you is",
    "start": "828020",
    "end": "834200"
  },
  {
    "text": "providing testing yeah right and there are two major types of testing that you're gonna need to do you know and and likely more the first is you need to",
    "start": "834200",
    "end": "842510"
  },
  {
    "text": "have unit tests like you have code you have function you have things they're gonna interact with your cloud you",
    "start": "842510",
    "end": "849560"
  },
  {
    "text": "should test them you know and this is pretty straightforward you know use whatever mocks you need to do also write",
    "start": "849560",
    "end": "856400"
  },
  {
    "text": "whatever functional testing you need but you're also gonna have to set up end-to-end testing you'll want to make",
    "start": "856400",
    "end": "864170"
  },
  {
    "text": "sure that when you run your Cloud Controller manager on your cloud that",
    "start": "864170",
    "end": "869930"
  },
  {
    "text": "you're providing all of the services in the way that Corona expects them to be provided and the way you that you do",
    "start": "869930",
    "end": "876620"
  },
  {
    "text": "this is with the end-to-end testing you have a cloud available to you or you stand on the test cloud you install",
    "start": "876620",
    "end": "883010"
  },
  {
    "text": "kubernetes on that with your Cloud Controller manager and then you run the end-to-end testing against that and so you're running the external test",
    "start": "883010",
    "end": "888860"
  },
  {
    "text": "provided by the kubernetes community that guarantees your Cloud Controller manager works in the way of the you",
    "start": "888860",
    "end": "895130"
  },
  {
    "text": "expect it to work",
    "start": "895130",
    "end": "897670"
  },
  {
    "text": "and the nice thing about that too is that you can report that the test grid and and and and with enough tracks you",
    "start": "901560",
    "end": "907949"
  },
  {
    "text": "know if you if you have a large enough footprint on your cloud you can actually be common gating job for kubernetes release make sure that communities will",
    "start": "907949",
    "end": "914610"
  },
  {
    "text": "be released yeah there's a break in kubernetes that breaks on your cloud then that will be fixed okay so to run",
    "start": "914610",
    "end": "924689"
  },
  {
    "text": "this the main arguments are when you start your cube API server you need to provide cloud upfront provider external",
    "start": "924689",
    "end": "931379"
  },
  {
    "text": "formally you would provide cloud provider in the direct name of the provider in this case you say it's",
    "start": "931379",
    "end": "937079"
  },
  {
    "text": "external and then when you start your CCM binary you take that same cloud provider argument and give it your cloud",
    "start": "937079",
    "end": "943709"
  },
  {
    "text": "provider name the one that you define in that application we showed you earlier and then point to your cloud config and",
    "start": "943709",
    "end": "950639"
  },
  {
    "text": "then what other options that are necessary typically these you know these are things that are specific to you know",
    "start": "950639",
    "end": "957360"
  },
  {
    "text": "behaviors that your cloud expects that you can set in there and again the",
    "start": "957360",
    "end": "962370"
  },
  {
    "text": "similarity of these options comes from the scaffolding code and there may be a lot of unneeded options and at an",
    "start": "962370",
    "end": "968639"
  },
  {
    "text": "earlier session from this week people actually raised some concerns that like why is it when I run the Cloud",
    "start": "968639",
    "end": "973649"
  },
  {
    "text": "Controller binary then I get all of these other things associated with it and so it's something that sig cloud provider is aware of it and we might be",
    "start": "973649",
    "end": "980850"
  },
  {
    "text": "able to turn our attention to in upcoming releases",
    "start": "980850",
    "end": "985639"
  },
  {
    "text": "it's okay but the advice is when you're",
    "start": "988300",
    "end": "993820"
  },
  {
    "text": "running this binary is a user daemon set and keep in mind that when you're running an external cloud provider a few",
    "start": "993820",
    "end": "1000000"
  },
  {
    "text": "things are gonna change and these come these comments come directly from the building your own building a cloud",
    "start": "1000000",
    "end": "1006480"
  },
  {
    "text": "controller manager love this thing external is gonna add a taint to note",
    "start": "1006480",
    "end": "1013980"
  },
  {
    "text": "cloud provider dr. communities that io4 uninitialized the effect is is that",
    "start": "1013980",
    "end": "1019710"
  },
  {
    "text": "there's going to be no schedule so your QB API server is gonna come up and you're gonna be able to schedule anything why is that where your Cloud",
    "start": "1019710",
    "end": "1027240"
  },
  {
    "text": "Controller manager may or may not be running yet and you need to signal to the cube API server that the controller",
    "start": "1027240",
    "end": "1032880"
  },
  {
    "text": "manager is running and that the API server can actually talk to the cloud and so once your controller manager",
    "start": "1032880",
    "end": "1040170"
  },
  {
    "text": "comes up that team can be removed and the API server can start scheduling jobs",
    "start": "1040170",
    "end": "1047870"
  },
  {
    "text": "the second is cloud information about nodes in the cluster is no longer going to be provided using local metadata but",
    "start": "1048140",
    "end": "1054180"
  },
  {
    "text": "instead of API calls to retrieve node information will go through the cloud controller manager and so the API server",
    "start": "1054180",
    "end": "1060360"
  },
  {
    "text": "is going to start pinging your cloud and a might start in your cloud a lot especially as a number of nodes and your",
    "start": "1060360",
    "end": "1066120"
  },
  {
    "text": "workload increases and so you need to be aware that if you're running particularly large workloads you may",
    "start": "1066120",
    "end": "1073290"
  },
  {
    "text": "need to adjust the the rate limiting on the API server now again this is another",
    "start": "1073290",
    "end": "1079920"
  },
  {
    "text": "issue that Sigma provider is aware of it's been reported to us from our users who are running into troubles where the",
    "start": "1079920",
    "end": "1085230"
  },
  {
    "text": "external providers are are a little bit too chatty with the API servers and it's",
    "start": "1085230",
    "end": "1091620"
  },
  {
    "text": "something that you know we're looking at ways to mitigate this and possibly add some things to add some caching or other",
    "start": "1091620",
    "end": "1098010"
  },
  {
    "text": "techniques to lower the the number of times that we reach the your cloud EAP is these are things to be",
    "start": "1098010",
    "end": "1104150"
  },
  {
    "text": "aware of as you develop and if you're running a daemon set again this is a you",
    "start": "1104150",
    "end": "1110570"
  },
  {
    "text": "know a pretty basic file just you know that tells you how to set it up and how to run it so that you can load your you",
    "start": "1110570",
    "end": "1117890"
  },
  {
    "text": "can build a docker container with your cloud controller image in it and how to run it and these slides will be",
    "start": "1117890",
    "end": "1123860"
  },
  {
    "text": "available and these are also all available on the on the kubernetes documentation sites and will be able to",
    "start": "1123860",
    "end": "1129650"
  },
  {
    "text": "fight the links in the slides to those can I just make one point here given that when the cluster comes up it has a",
    "start": "1129650",
    "end": "1136250"
  },
  {
    "text": "cane that says no schedule effectively we want to schedule a pot on it right now because we want to schedule the CCM",
    "start": "1136250",
    "end": "1142640"
  },
  {
    "text": "in order to remove that taint so it's a sort of a chicken-and-egg direct intuition so in order to make",
    "start": "1142640",
    "end": "1148220"
  },
  {
    "text": "this possible there's the oration part that says oh this yamo five this is this deployment this",
    "start": "1148220",
    "end": "1154550"
  },
  {
    "text": "demon said it will tolerate having a no scheduled set on the cluster that I'm running this on this reflect to be able",
    "start": "1154550",
    "end": "1161270"
  },
  {
    "text": "to schedule this bog first so that when this this Paul will be sketching and work correctly you were removed and",
    "start": "1161270",
    "end": "1167150"
  },
  {
    "text": "attained and the noddle will be ready to schedule regular pods on it okay",
    "start": "1167150",
    "end": "1176050"
  },
  {
    "text": "thinking about some implementation details you're probably going to need a library that interacts with your cloud",
    "start": "1176050",
    "end": "1181310"
  },
  {
    "text": "right and so that's one of the first things you're gonna have to find as a library a go library that interacts with your cloud and that's the first step",
    "start": "1181310",
    "end": "1187610"
  },
  {
    "text": "because there are likely many other things within the kubernetes ecosystem that you want to be able to interact",
    "start": "1187610",
    "end": "1193670"
  },
  {
    "text": "with your cloud and so it's best to have some sort of library to interact with that rather than to implement all those",
    "start": "1193670",
    "end": "1198770"
  },
  {
    "text": "details directly into your cloud provider the second is you want to think",
    "start": "1198770",
    "end": "1203840"
  },
  {
    "text": "about how you handle authentication and authorization it's likely that your",
    "start": "1203840",
    "end": "1209240"
  },
  {
    "text": "Cloud Controller isn't the only thing that's interacting with your cloud especially with cluster api coming along",
    "start": "1209240",
    "end": "1214970"
  },
  {
    "text": "this is going to be an incredibly important API that you're gonna want to support within the kubernetes equal system because their goal is to become",
    "start": "1214970",
    "end": "1222230"
  },
  {
    "text": "the de facto way that you do not only cluster installation but also upgrading",
    "start": "1222230",
    "end": "1228590"
  },
  {
    "text": "and auto-scaling complete lifecycle management of your cluster and so this is something you want to pay attention to along with your",
    "start": "1228590",
    "end": "1235010"
  },
  {
    "text": "cloud provider you know so you want to",
    "start": "1235010",
    "end": "1240530"
  },
  {
    "text": "consolidate you out your efforts otherwise you're gonna wind up with fragmented and inconsistent often",
    "start": "1240530",
    "end": "1245570"
  },
  {
    "text": "configuration that leads across your projects speaking from experience on that one and speaking about experience",
    "start": "1245570",
    "end": "1253490"
  },
  {
    "text": "moving on to part three of the talk were just some examples that are drawn from our own experiences and developing these",
    "start": "1253490",
    "end": "1259610"
  },
  {
    "text": "providers and so the first is with the OpenStack cloud provider we use gopher",
    "start": "1259610",
    "end": "1265610"
  },
  {
    "text": "cloud it's the OpenStack SDK that we use we have a number of different sub",
    "start": "1265610",
    "end": "1270799"
  },
  {
    "text": "controllers that are independent of one another and so we're actually it makes it easier if for us to kind of load and",
    "start": "1270799",
    "end": "1275900"
  },
  {
    "text": "unload things that are running or nod and have a little bit better separation of concern across the codes we also",
    "start": "1275900",
    "end": "1282590"
  },
  {
    "text": "don't implement zones it's zones has an open stack abstraction",
    "start": "1282590",
    "end": "1288230"
  },
  {
    "text": "would be a kind of multi cloud type of situation and since there's really no commonly adopted way to federates",
    "start": "1288230",
    "end": "1295040"
  },
  {
    "text": "across the OpenStack zones aren't something that are you know something that we think about so it's just not implemented you know and things work",
    "start": "1295040",
    "end": "1302090"
  },
  {
    "text": "fine",
    "start": "1302090",
    "end": "1304270"
  },
  {
    "text": "just a little some comments about the level of effort to implement some of these things load balancer by far is the",
    "start": "1311190",
    "end": "1316379"
  },
  {
    "text": "most complicated part of the OpenStack power base followed by volumes 'men",
    "start": "1316379",
    "end": "1322950"
  },
  {
    "text": "volume support inside of our cloud provider which is a bit of a legacy thing that comes from the internal cloud provider routes come next and instances",
    "start": "1322950",
    "end": "1330389"
  },
  {
    "text": "are by far the easiest thing we have to implement plus there's a bunch of code that's a sushi associated with testing",
    "start": "1330389",
    "end": "1336239"
  },
  {
    "text": "the general interface and another testing in the client interface finally",
    "start": "1336239",
    "end": "1347879"
  },
  {
    "text": "we we we reuse the distant tools for standing up the various test environments so you know testing is really important for us and we put a lot",
    "start": "1347879",
    "end": "1354600"
  },
  {
    "text": "of thought and effort into this and we actually allow for a matrix of compatibility testing by building upon",
    "start": "1354600",
    "end": "1359759"
  },
  {
    "text": "the tools that are already out there so the first thing that we do is we bring up a test OpenStack cloud using",
    "start": "1359759",
    "end": "1365909"
  },
  {
    "text": "something called dev stack which is just the standard tool that we use to drink up clouds aside of OpenStack for testing",
    "start": "1365909",
    "end": "1372649"
  },
  {
    "text": "this way we can bring up any version of OpenStack cloud that we want whether that be a development from the from the",
    "start": "1372649",
    "end": "1379259"
  },
  {
    "text": "from the head of our development tree or from one of our releases then we run local up cluster which is one of the",
    "start": "1379259",
    "end": "1385259"
  },
  {
    "text": "standard kubernetes tools for standing up test clusters of kubernetes inside of that and this is actually a really cool",
    "start": "1385259",
    "end": "1391440"
  },
  {
    "text": "script to look at you should pay attention to this because when you're when you're when you're when you're developing your Cloud Controller manager",
    "start": "1391440",
    "end": "1397159"
  },
  {
    "text": "there is code in here that kind of shows you how to set those things up and have them set up your tests and there are environment variables that you've said",
    "start": "1397159",
    "end": "1403019"
  },
  {
    "text": "to bring it up and so it's actually really nice tool to do testing on we used it launched at kubernetes cluster",
    "start": "1403019",
    "end": "1408389"
  },
  {
    "text": "on the OpenStack cluster using the custom cloud controller manager and then finally we use e to e go to run and and",
    "start": "1408389",
    "end": "1416070"
  },
  {
    "text": "tests on it join the conformance testing on the cluster with the results reported back to test grid and all of this is",
    "start": "1416070",
    "end": "1421379"
  },
  {
    "text": "orchestrated with ansible playbooks and launched on the sole and so you know the level of effort you know the actual you",
    "start": "1421379",
    "end": "1427379"
  },
  {
    "text": "know unique code that we had to get this running was pretty small a lot of this RDS",
    "start": "1427379",
    "end": "1433700"
  },
  {
    "text": "with that I'm gonna turn it over for the vSphere implementation yep so vSphere of",
    "start": "1436440",
    "end": "1441900"
  },
  {
    "text": "the club a lot of useful information is relatively new because we we had the vSphere support inside the kinetics",
    "start": "1441900",
    "end": "1448410"
  },
  {
    "text": "course of entry for a very long time and it was mainly used because it also",
    "start": "1448410",
    "end": "1453690"
  },
  {
    "text": "supported storage inside the entry provider so part of that and the very",
    "start": "1453690",
    "end": "1459780"
  },
  {
    "text": "first bullet point on this slide is actually one of the points I was making you know in earlier and during the",
    "start": "1459780",
    "end": "1465059"
  },
  {
    "text": "presentation so one of the big problems we have with the code inside the kubernetes core is that some of these",
    "start": "1465059",
    "end": "1471419"
  },
  {
    "text": "SDKs that we're importing in are huge one of the main offenders is actually",
    "start": "1471419",
    "end": "1476460"
  },
  {
    "text": "our own so gooey mommy is our Go Go SDK",
    "start": "1476460",
    "end": "1481890"
  },
  {
    "text": "for the vSphere API and the types package is huge it's gigantic it's 23 megabytes so actually I heard that the",
    "start": "1481890",
    "end": "1489299"
  },
  {
    "text": "golang team is using it as a benchmark when they run benchmark for go because it's so big it's Auto generated by the",
    "start": "1489299",
    "end": "1495150"
  },
  {
    "text": "way it's not we're not doing it by hand but anyway regardless the the problem is",
    "start": "1495150",
    "end": "1502169"
  },
  {
    "text": "that we have all this all these SDKs that are built into the core so R is one",
    "start": "1502169",
    "end": "1508260"
  },
  {
    "text": "of the largest GCE is also very big so if you add you know we have eight of them so if you add up all these it",
    "start": "1508260",
    "end": "1515490"
  },
  {
    "text": "becomes gigantic so keeping them out of the core it's always a good idea in",
    "start": "1515490",
    "end": "1521549"
  },
  {
    "text": "terms of the actual club provider for vSphere we do not implement load balancer clusters enroll in routes today",
    "start": "1521549",
    "end": "1527940"
  },
  {
    "text": "because we don't have specifically the load balancer in routes we don't have an in plane v3 we don't have a little",
    "start": "1527940",
    "end": "1533820"
  },
  {
    "text": "balancer or or a networking facility that has you know layer 4th layer 7",
    "start": "1533820",
    "end": "1539000"
  },
  {
    "text": "services so we don't we don't have that so we're not supporting that directly but there's more to come in that we",
    "start": "1539000",
    "end": "1544320"
  },
  {
    "text": "support vSphere from version 6.5 which is you know it's been around for quite a while now",
    "start": "1544320",
    "end": "1549360"
  },
  {
    "text": "so we feel like it was a good starting point for for support and we do share",
    "start": "1549360",
    "end": "1554400"
  },
  {
    "text": "the secret so when you configure the claw provider vSphere we do have we",
    "start": "1554400",
    "end": "1559860"
  },
  {
    "text": "manage the credentials to connect to our cloud so to get the vSphere through a violence inside kubernetes we share the",
    "start": "1559860",
    "end": "1567179"
  },
  {
    "text": "same secret file with CSI vSphere which is for storage support in terms of",
    "start": "1567179",
    "end": "1575270"
  },
  {
    "text": "supporting we also have support for zone which was recently introduced I think it",
    "start": "1575270",
    "end": "1580320"
  },
  {
    "text": "was a 3-4 months ago this was actually a big deal for us because we didn't support it initially because the problem",
    "start": "1580320",
    "end": "1587520"
  },
  {
    "text": "with availability zones is that vSphere is an on-prem software that you install and you architect yourself so you don't",
    "start": "1587520",
    "end": "1593700"
  },
  {
    "text": "have one one type of a little bit zones you're not you know buying service from a cloud that defines the availability",
    "start": "1593700",
    "end": "1599730"
  },
  {
    "text": "zones for you you have to define them for you and it's a pretty interesting helping in pretty large topic I mean",
    "start": "1599730",
    "end": "1605640"
  },
  {
    "text": "there are entire books about it so there's a lot of there's a lot of work and a lot of different opinions on how",
    "start": "1605640",
    "end": "1611640"
  },
  {
    "text": "to architect fault domains for vSphere so we had to find a way to actually map those concepts through the you know",
    "start": "1611640",
    "end": "1618360"
  },
  {
    "text": "fixed concept that we have in kubernetes so zones and regions so we use vSphere",
    "start": "1618360",
    "end": "1623370"
  },
  {
    "text": "attacks so you can go into vSphere you can tag your data centers with zones and in region tags and we will take them and",
    "start": "1623370",
    "end": "1631110"
  },
  {
    "text": "use them inside the kubernetes club provider vSphere to map those availability zones between the two so",
    "start": "1631110",
    "end": "1639000"
  },
  {
    "text": "again I put the new acronym there so bring your own topology so you make your own topology in vSphere and you figure",
    "start": "1639000",
    "end": "1644789"
  },
  {
    "text": "out how do you want to you know use that into your inside your Q bananas clusters that you're running on it it even zone",
    "start": "1644789",
    "end": "1651960"
  },
  {
    "text": "support is actually important in the club provider because it enables the same support for CSI so when you when",
    "start": "1651960",
    "end": "1659280"
  },
  {
    "text": "you want to run when you want to do something particularly with the storage topology you need to have that's on this",
    "start": "1659280",
    "end": "1665460"
  },
  {
    "text": "information that zones information comes from the CCM so it's it it's symbiotic alliance between the two and then what",
    "start": "1665460",
    "end": "1674340"
  },
  {
    "text": "about starts so well in controller group is not implemented so this was actually",
    "start": "1674340",
    "end": "1679350"
  },
  {
    "text": "again another big pain point for us because again we had a you know long-standing entry implementation that",
    "start": "1679350",
    "end": "1686100"
  },
  {
    "text": "was mainly used for storage and we had to find a way to transition you know you know end users that are using call",
    "start": "1686100",
    "end": "1693690"
  },
  {
    "text": "provider vSphere entry today to the auditory model so building a CCM was not enough we had to build a CSI plugin so",
    "start": "1693690",
    "end": "1701700"
  },
  {
    "text": "today if you're running vSphere entry with of entry claw provider and you want to move to the auto tree you have to",
    "start": "1701700",
    "end": "1707460"
  },
  {
    "text": "move to both CCM and CSI at the same time and this for us is also a problem",
    "start": "1707460",
    "end": "1715500"
  },
  {
    "text": "in terms of support ability because this adds another dimension to the number of versions that we have support so if you",
    "start": "1715500",
    "end": "1721020"
  },
  {
    "text": "look at the support matrix we have you know kubernetes version and now out of tree CCM which is another version then we",
    "start": "1721020",
    "end": "1727980"
  },
  {
    "text": "have CSI which is another version and plus you know since it's a it's a it's a",
    "start": "1727980",
    "end": "1733050"
  },
  {
    "text": "non-print product we also have vSphere version so we have so many dimensions the support makes it's kind of a",
    "start": "1733050",
    "end": "1738300"
  },
  {
    "text": "nightmare right now we're trying to standardize that and making sure that we can support anymore I would say linear",
    "start": "1738300",
    "end": "1744300"
  },
  {
    "text": "way and future things so this is actually an interesting thought that we",
    "start": "1744300",
    "end": "1751170"
  },
  {
    "text": "got some feedback from users of vSphere on AWS vSphere edibility asked for people that don't know it's basically a",
    "start": "1751170",
    "end": "1757260"
  },
  {
    "text": "vSphere cluster running on a device which means that you're you have this",
    "start": "1757260",
    "end": "1763170"
  },
  {
    "text": "risk release your cluster that has you know access to some advanced services coming for an FPS directly so I'll say",
    "start": "1763170",
    "end": "1770220"
  },
  {
    "text": "that before you know vSphere on-prem the plain vSphere doesn't have a little dinosaur facility for example so you",
    "start": "1770220",
    "end": "1775650"
  },
  {
    "text": "have to you know either build your own or bring your own from you know and insects sort of some other commercial",
    "start": "1775650",
    "end": "1780720"
  },
  {
    "text": "product vSphere and ABARES has access to elastic load balancer from a table yes the problem is that it's two different",
    "start": "1780720",
    "end": "1787320"
  },
  {
    "text": "cloud providers right you have vSphere and you have AWS how do we how do we make sure that we can consume both",
    "start": "1787320",
    "end": "1793920"
  },
  {
    "text": "resources in the same kubernetes closet so this is still an open question which is researching you know discovering how",
    "start": "1793920",
    "end": "1800820"
  },
  {
    "text": "to do that but it's an interesting you know hybrid situation that we're getting into that was not explored before so and",
    "start": "1800820",
    "end": "1808170"
  },
  {
    "text": "again if actually if people have any questions or feedback on this be happy to hear that either directly or during",
    "start": "1808170",
    "end": "1815490"
  },
  {
    "text": "one of the sig calls SiC la provider speaking of seek la provider you know",
    "start": "1815490",
    "end": "1820669"
  },
  {
    "text": "and this is the last lie were you any longer on this say claw",
    "start": "1820669",
    "end": "1826029"
  },
  {
    "text": "provider is actually the focal point for anything that is happening around these discussions so everything that is and is",
    "start": "1826029",
    "end": "1832749"
  },
  {
    "text": "happening in terms of going out of Tresor removing all this code building new cloud providers even if you have a",
    "start": "1832749",
    "end": "1838720"
  },
  {
    "text": "if you are a cloud provider if you are a new cloud provider and you're building your own clock controlling manager I",
    "start": "1838720",
    "end": "1846159"
  },
  {
    "text": "make sure you join SiC claw provider because everything is and everything is happening in there in the convenience",
    "start": "1846159",
    "end": "1851169"
  },
  {
    "text": "community we do have three major caps so obviously they will be available this",
    "start": "1851169",
    "end": "1857830"
  },
  {
    "text": "light will be available in in the conference page but there's three major caps you want to look at if you're",
    "start": "1857830",
    "end": "1863679"
  },
  {
    "text": "interested in this we have you know the main cap for plug controller manager which is the very first one we have the",
    "start": "1863679",
    "end": "1869649"
  },
  {
    "text": "tested conformance requirements which are you know as was aligning before you know we have the reclines of having",
    "start": "1869649",
    "end": "1875970"
  },
  {
    "text": "end-to-end tests being reporting just desperate and that is also required if you want to gauge the release against",
    "start": "1875970",
    "end": "1883360"
  },
  {
    "text": "your own club on a test and there's also another one which is the removing entry cloud provider code cap which is an",
    "start": "1883360",
    "end": "1890139"
  },
  {
    "text": "effort to stage the code and then removing the code from from the main kubernetes repo so again",
    "start": "1890139",
    "end": "1896919"
  },
  {
    "text": "if you're interested in this topic make sure you go checked out these caps and if you have feedback you know sick la",
    "start": "1896919",
    "end": "1902230"
  },
  {
    "text": "provider meets every other week on Wednesday make sure you join the call and get your feedback and wait at that",
    "start": "1902230",
    "end": "1910210"
  },
  {
    "text": "said we are wrapping up the session any questions minutes for questions over",
    "start": "1910210",
    "end": "1915549"
  },
  {
    "text": "here and to stay your question then we'll repeat it for you for the for the camera",
    "start": "1915549",
    "end": "1920820"
  },
  {
    "text": "so be a little challenging we don't have another mic so if you will if you have a question could you like maybe come up",
    "start": "1921780",
    "end": "1927370"
  },
  {
    "text": "here and we keep coming that's the mic back important unfortunately we don't have more than",
    "start": "1927370",
    "end": "1932500"
  },
  {
    "text": "which is the one hand like thanks just a good question you were mentioning that",
    "start": "1932500",
    "end": "1938190"
  },
  {
    "text": "clock controller manager should run as a dementia we the Toleration does it make",
    "start": "1938190",
    "end": "1943570"
  },
  {
    "text": "sense to launch it as a static button rather than the Devon sense it actually",
    "start": "1943570",
    "end": "1948790"
  },
  {
    "text": "it's it's in the OpenStack cloud controller manager case we actually",
    "start": "1948790",
    "end": "1954790"
  },
  {
    "text": "provide code that lets you launch it as a daemon set or as a pod as a separate pot it's it's it's entirely up to you in",
    "start": "1954790",
    "end": "1962110"
  },
  {
    "text": "terms of recommend it's a recommendation versus you know a requirement so it's not a requirement to run it as a daemon",
    "start": "1962110",
    "end": "1968380"
  },
  {
    "text": "set you can run it as a static pot I tend to recommend the daemon set because",
    "start": "1968380",
    "end": "1974200"
  },
  {
    "text": "you can run the demon set all the master notes that you have and that will make it you know more available I guess using",
    "start": "1974200",
    "end": "1980919"
  },
  {
    "text": "a static but again there's no strict requirement on how to run it you can even run it as a binary you know",
    "start": "1980919",
    "end": "1988299"
  },
  {
    "text": "alongside the cubelet for example all right",
    "start": "1988299",
    "end": "1995759"
  },
  {
    "text": "Copernicus the I think maybe just the cluster autoscaler",
    "start": "1997370",
    "end": "2002500"
  },
  {
    "text": "that to interact with health providers there is some plan or some vision to",
    "start": "2002500",
    "end": "2008400"
  },
  {
    "text": "unify or maybe use its controller",
    "start": "2008400",
    "end": "2014530"
  },
  {
    "text": "manager in other places right so I think so it's my understanding that the long term plan for for cluster auto-scaling",
    "start": "2014530",
    "end": "2022210"
  },
  {
    "text": "is actually going to be very much baked into the cluster API project because",
    "start": "2022210",
    "end": "2028780"
  },
  {
    "text": "once you have do you have machine sets and everything kind of like comes down",
    "start": "2028780",
    "end": "2034630"
  },
  {
    "text": "who you want to like say oh I need to auto-scale you ask for more machine sets that implementation happens at the",
    "start": "2034630",
    "end": "2040929"
  },
  {
    "text": "cluster API level and then everybody can use the same techniques for auto scaling",
    "start": "2040929",
    "end": "2045970"
  },
  {
    "text": "you have one set of auto scaling code that talks to a number of small providers rather than a bunch of",
    "start": "2045970",
    "end": "2051158"
  },
  {
    "text": "different providers for auto scaling code and so I think that's the long-term solution shorter term people are",
    "start": "2051159",
    "end": "2056770"
  },
  {
    "text": "implementing their own cluster Auto scalars right now and one thing that I didn't mention their presentation but",
    "start": "2056770",
    "end": "2062620"
  },
  {
    "text": "it's actually something that people might be interested in doing it you know this obviously is open source code is",
    "start": "2062620",
    "end": "2067720"
  },
  {
    "text": "available and can be run you know without forking the kubernetes core so",
    "start": "2067720",
    "end": "2072908"
  },
  {
    "text": "if you have if you're running on a club provider you there's there's a feature that you really want to have or like an",
    "start": "2072909",
    "end": "2078370"
  },
  {
    "text": "integration that I really want to have you can fork the code for the auditory Club provider add your own code to it",
    "start": "2078370",
    "end": "2084158"
  },
  {
    "text": "and then run it as a pod so you don't have to keep a fork of kubernetes you only have to keep a fork of the cloud",
    "start": "2084159",
    "end": "2089408"
  },
  {
    "text": "provider okay if we don't have any other questions then I think we'll close out",
    "start": "2089409",
    "end": "2098380"
  },
  {
    "text": "this session all right thanks a lot [Applause]",
    "start": "2098380",
    "end": "2107050"
  }
]