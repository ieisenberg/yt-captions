[
  {
    "text": "hi everyone thanks for coming my name is",
    "start": "30",
    "end": "4620"
  },
  {
    "text": "Dylan Kearney I'm an engineer on the",
    "start": "4620",
    "end": "7080"
  },
  {
    "text": "traffic team at stripe and I'm here",
    "start": "7080",
    "end": "11070"
  },
  {
    "text": "today to talk to you about some things",
    "start": "11070",
    "end": "13139"
  },
  {
    "text": "that my team built with envoy over the",
    "start": "13139",
    "end": "16470"
  },
  {
    "text": "past year or so I'm going to talk about",
    "start": "16470",
    "end": "21720"
  },
  {
    "text": "what we built and how we incorporated",
    "start": "21720",
    "end": "24660"
  },
  {
    "text": "envoy into what we built some of the",
    "start": "24660",
    "end": "28050"
  },
  {
    "text": "challenges we faced along the way maybe",
    "start": "28050",
    "end": "31230"
  },
  {
    "text": "some of them are interesting or novel",
    "start": "31230",
    "end": "33090"
  },
  {
    "text": "depending on your experience with envoy",
    "start": "33090",
    "end": "35370"
  },
  {
    "text": "and then with the benefit of hindsight",
    "start": "35370",
    "end": "39600"
  },
  {
    "text": "and looking back at the entire project",
    "start": "39600",
    "end": "42620"
  },
  {
    "text": "what were some pros and cons maybe some",
    "start": "42620",
    "end": "45270"
  },
  {
    "text": "things we would have done differently so",
    "start": "45270",
    "end": "50070"
  },
  {
    "text": "with that before I dive into any sort of",
    "start": "50070",
    "end": "53399"
  },
  {
    "text": "technical details but just start",
    "start": "53399",
    "end": "55140"
  },
  {
    "text": "rambling on about HTTP or on vallei a",
    "start": "55140",
    "end": "57899"
  },
  {
    "text": "bit about my employer stripe some of you",
    "start": "57899",
    "end": "61520"
  },
  {
    "text": "might be developers in the audience you",
    "start": "61520",
    "end": "64290"
  },
  {
    "text": "might have integrated with stripe at one",
    "start": "64290",
    "end": "65909"
  },
  {
    "text": "point or you might work for a company",
    "start": "65909",
    "end": "67409"
  },
  {
    "text": "that uses stripe I know I saw it up on a",
    "start": "67409",
    "end": "70439"
  },
  {
    "text": "slide earlier but stripe is a technology",
    "start": "70439",
    "end": "73439"
  },
  {
    "text": "company that builds economic",
    "start": "73439",
    "end": "75630"
  },
  {
    "text": "infrastructure for the internet so what",
    "start": "75630",
    "end": "77700"
  },
  {
    "text": "does that actually mean another way to",
    "start": "77700",
    "end": "80670"
  },
  {
    "text": "think about that is that we run software",
    "start": "80670",
    "end": "83369"
  },
  {
    "text": "and api's to accept payments and to",
    "start": "83369",
    "end": "87060"
  },
  {
    "text": "allow companies to manage their",
    "start": "87060",
    "end": "88979"
  },
  {
    "text": "businesses online so a large part of",
    "start": "88979",
    "end": "91860"
  },
  {
    "text": "that is removing the complexity of",
    "start": "91860",
    "end": "93930"
  },
  {
    "text": "global money movement so we have",
    "start": "93930",
    "end": "97409"
  },
  {
    "text": "millions of customers in over 120",
    "start": "97409",
    "end": "100740"
  },
  {
    "text": "countries the use stripe to start run",
    "start": "100740",
    "end": "103799"
  },
  {
    "text": "and scale their business so what we have",
    "start": "103799",
    "end": "110159"
  },
  {
    "text": "here is a pretty abstracted high-level",
    "start": "110159",
    "end": "112829"
  },
  {
    "text": "view of where some of those 120 plus",
    "start": "112829",
    "end": "115770"
  },
  {
    "text": "countries are located and you'll see",
    "start": "115770",
    "end": "119640"
  },
  {
    "text": "that we as the title of my talk alluded",
    "start": "119640",
    "end": "123149"
  },
  {
    "text": "to literally span the globe",
    "start": "123149",
    "end": "127340"
  },
  {
    "text": "now I'm a software engineer I'm sure a",
    "start": "128550",
    "end": "133120"
  },
  {
    "text": "lot of you are as well and anyone who's",
    "start": "133120",
    "end": "136600"
  },
  {
    "text": "been in the software engineering or",
    "start": "136600",
    "end": "138730"
  },
  {
    "text": "computer science fields for a while",
    "start": "138730",
    "end": "141040"
  },
  {
    "text": "knows that the field is littered with",
    "start": "141040",
    "end": "143850"
  },
  {
    "text": "problems problems to work on some of",
    "start": "143850",
    "end": "147850"
  },
  {
    "text": "them are maybe a little more interesting",
    "start": "147850",
    "end": "149470"
  },
  {
    "text": "than others depending on your your",
    "start": "149470",
    "end": "152560"
  },
  {
    "text": "background we have problems of resource",
    "start": "152560",
    "end": "154660"
  },
  {
    "text": "constraints we have problems of taming",
    "start": "154660",
    "end": "158170"
  },
  {
    "text": "overwhelming complexity but I would",
    "start": "158170",
    "end": "161590"
  },
  {
    "text": "argue that having millions and millions",
    "start": "161590",
    "end": "163840"
  },
  {
    "text": "of people all around the world who want",
    "start": "163840",
    "end": "166300"
  },
  {
    "text": "to use your software all day every day",
    "start": "166300",
    "end": "168970"
  },
  {
    "text": "with many nines of availability is one",
    "start": "168970",
    "end": "173800"
  },
  {
    "text": "of the greatest problems to have it's",
    "start": "173800",
    "end": "175600"
  },
  {
    "text": "fun to work on it turns out from a",
    "start": "175600",
    "end": "178000"
  },
  {
    "text": "business perspective it's also a pretty",
    "start": "178000",
    "end": "180370"
  },
  {
    "text": "great problem to have as you can imagine",
    "start": "180370",
    "end": "182880"
  },
  {
    "text": "so that's the problem that I want to",
    "start": "182880",
    "end": "186130"
  },
  {
    "text": "talk about today and how my team at",
    "start": "186130",
    "end": "188890"
  },
  {
    "text": "stripe overcame some of the inherent",
    "start": "188890",
    "end": "191590"
  },
  {
    "text": "obstacles without particular software",
    "start": "191590",
    "end": "194530"
  },
  {
    "text": "engineering problem oh sorry I didn't",
    "start": "194530",
    "end": "198850"
  },
  {
    "text": "even read my slide here another way of",
    "start": "198850",
    "end": "200650"
  },
  {
    "text": "saying that is with increased reach with",
    "start": "200650",
    "end": "203020"
  },
  {
    "text": "global reach comes some pretty",
    "start": "203020",
    "end": "204310"
  },
  {
    "text": "interesting software problems so the",
    "start": "204310",
    "end": "208810"
  },
  {
    "text": "first one is a basic tale of latency",
    "start": "208810",
    "end": "212970"
  },
  {
    "text": "it's a fundamental problem when dealing",
    "start": "212970",
    "end": "216670"
  },
  {
    "text": "with networks now if we look at the time",
    "start": "216670",
    "end": "220990"
  },
  {
    "text": "it takes some data to make its way from",
    "start": "220990",
    "end": "223180"
  },
  {
    "text": "Seattle where I live and where I work to",
    "start": "223180",
    "end": "226660"
  },
  {
    "text": "where we are today here in San Diego",
    "start": "226660",
    "end": "228700"
  },
  {
    "text": "we're looking at I don't know",
    "start": "228700",
    "end": "230740"
  },
  {
    "text": "depending on your source about 36",
    "start": "230740",
    "end": "233470"
  },
  {
    "text": "milliseconds now if we move that out to",
    "start": "233470",
    "end": "237010"
  },
  {
    "text": "a city I was recently in Mexico City",
    "start": "237010",
    "end": "240130"
  },
  {
    "text": "we're now looking at say 67 milliseconds",
    "start": "240130",
    "end": "244260"
  },
  {
    "text": "give or take a few but if we move",
    "start": "244260",
    "end": "248560"
  },
  {
    "text": "further afield and look at parts of that",
    "start": "248560",
    "end": "252670"
  },
  {
    "text": "globe that I showed earlier much farther",
    "start": "252670",
    "end": "255130"
  },
  {
    "text": "from Seattle like Mumbai say were up to",
    "start": "255130",
    "end": "258609"
  },
  {
    "text": "a pretty appreciable 275 mm",
    "start": "258609",
    "end": "261010"
  },
  {
    "text": "seconds I don't need to beat you over",
    "start": "261010",
    "end": "264250"
  },
  {
    "text": "the head with examples for you to get",
    "start": "264250",
    "end": "265900"
  },
  {
    "text": "the point that some places are much",
    "start": "265900",
    "end": "267550"
  },
  {
    "text": "further away than others the speed of",
    "start": "267550",
    "end": "269680"
  },
  {
    "text": "light is a constant it's not moving any",
    "start": "269680",
    "end": "271840"
  },
  {
    "text": "faster Mumbai is not getting any closer",
    "start": "271840",
    "end": "274240"
  },
  {
    "text": "to Seattle last time I checked so one",
    "start": "274240",
    "end": "280740"
  },
  {
    "text": "one way you might think of to combat",
    "start": "280740",
    "end": "283360"
  },
  {
    "text": "this it's not just a naive solution but",
    "start": "283360",
    "end": "286930"
  },
  {
    "text": "one that actually works pretty well in",
    "start": "286930",
    "end": "288250"
  },
  {
    "text": "practice it's to move some of your",
    "start": "288250",
    "end": "291010"
  },
  {
    "text": "computers closer to where those users",
    "start": "291010",
    "end": "293260"
  },
  {
    "text": "are it makes intuitive sense and it",
    "start": "293260",
    "end": "295960"
  },
  {
    "text": "makes fundamental physical sense as well",
    "start": "295960",
    "end": "298920"
  },
  {
    "text": "so that's exactly what we started to do",
    "start": "298920",
    "end": "302740"
  },
  {
    "text": "at stripe that what my team initially",
    "start": "302740",
    "end": "304510"
  },
  {
    "text": "worked on and what we ended up with is a",
    "start": "304510",
    "end": "309130"
  },
  {
    "text": "this is a vastly oversimplified network",
    "start": "309130",
    "end": "313060"
  },
  {
    "text": "diagram but we moved some of our",
    "start": "313060",
    "end": "315340"
  },
  {
    "text": "computers closer to where our global",
    "start": "315340",
    "end": "317170"
  },
  {
    "text": "users are so for the sake of argument",
    "start": "317170",
    "end": "319690"
  },
  {
    "text": "here I've chosen Japan Ireland and the",
    "start": "319690",
    "end": "323140"
  },
  {
    "text": "US mainly for the reason that they're",
    "start": "323140",
    "end": "325210"
  },
  {
    "text": "all far from each other and again for",
    "start": "325210",
    "end": "328750"
  },
  {
    "text": "the purposes of argument I have sort of",
    "start": "328750",
    "end": "331630"
  },
  {
    "text": "our home data center and maybe all of",
    "start": "331630",
    "end": "334810"
  },
  {
    "text": "our databases located in the US now the",
    "start": "334810",
    "end": "339340"
  },
  {
    "text": "significance of the different colors on",
    "start": "339340",
    "end": "340720"
  },
  {
    "text": "the arrows the red arrows represent",
    "start": "340720",
    "end": "343020"
  },
  {
    "text": "traffic that moves over a connection",
    "start": "343020",
    "end": "345460"
  },
  {
    "text": "that might be the users internet say",
    "start": "345460",
    "end": "348040"
  },
  {
    "text": "mobile network their home broadband",
    "start": "348040",
    "end": "350370"
  },
  {
    "text": "their office what-have-you",
    "start": "350370",
    "end": "352840"
  },
  {
    "text": "whereas Green Arrow's represent",
    "start": "352840",
    "end": "355080"
  },
  {
    "text": "connections or traffic over connections",
    "start": "355080",
    "end": "357670"
  },
  {
    "text": "run and operated by stripe that would",
    "start": "357670",
    "end": "361000"
  },
  {
    "text": "become kind of important in a second",
    "start": "361000",
    "end": "363190"
  },
  {
    "text": "here so great we've established points",
    "start": "363190",
    "end": "366880"
  },
  {
    "text": "of presence or pops as I sometimes refer",
    "start": "366880",
    "end": "368950"
  },
  {
    "text": "to them in places all around the world",
    "start": "368950",
    "end": "372130"
  },
  {
    "text": "they're closer to users well what is",
    "start": "372130",
    "end": "373990"
  },
  {
    "text": "that bias the first thing we can do is",
    "start": "373990",
    "end": "377310"
  },
  {
    "text": "drastically reduce the TLS negotiation",
    "start": "377310",
    "end": "380860"
  },
  {
    "text": "time so any good API is going to require",
    "start": "380860",
    "end": "386710"
  },
  {
    "text": "that you establish a secure TLS",
    "start": "386710",
    "end": "388900"
  },
  {
    "text": "connection before doing anything else",
    "start": "388900",
    "end": "390850"
  },
  {
    "text": "and if we remember real quick back to",
    "start": "390850",
    "end": "394570"
  },
  {
    "text": "maybe our computer networking classes we",
    "start": "394570",
    "end": "396280"
  },
  {
    "text": "took in school we know that just to set",
    "start": "396280",
    "end": "399670"
  },
  {
    "text": "up that TLS connection before we can do",
    "start": "399670",
    "end": "401500"
  },
  {
    "text": "anything else we have to do a bunch of",
    "start": "401500",
    "end": "405190"
  },
  {
    "text": "round trips so between the center and",
    "start": "405190",
    "end": "406690"
  },
  {
    "text": "the receiver we have a full round trip",
    "start": "406690",
    "end": "408580"
  },
  {
    "text": "just open a TCP connection we've got two",
    "start": "408580",
    "end": "412120"
  },
  {
    "text": "more to exchange cipher suites and set",
    "start": "412120",
    "end": "414400"
  },
  {
    "text": "up TLS etc etc this is all before we can",
    "start": "414400",
    "end": "417850"
  },
  {
    "text": "exchange any meaningful application data",
    "start": "417850",
    "end": "420580"
  },
  {
    "text": "at all",
    "start": "420580",
    "end": "421150"
  },
  {
    "text": "now TLS 1.3 and things like that have",
    "start": "421150",
    "end": "425010"
  },
  {
    "text": "some mitigations to to make this faster",
    "start": "425010",
    "end": "428230"
  },
  {
    "text": "but those aren't widely adopted yet and",
    "start": "428230",
    "end": "432540"
  },
  {
    "text": "so we see that we've paid a pretty sorry",
    "start": "432540",
    "end": "439630"
  },
  {
    "text": "pretty large cost already if we're",
    "start": "439630",
    "end": "442810"
  },
  {
    "text": "talking about the sender and receiver",
    "start": "442810",
    "end": "444520"
  },
  {
    "text": "being located in places like Seattle and",
    "start": "444520",
    "end": "446440"
  },
  {
    "text": "Mumbai so how does the Envoy help with",
    "start": "446440",
    "end": "454060"
  },
  {
    "text": "this right I just talked about TLS",
    "start": "454060",
    "end": "456100"
  },
  {
    "text": "negotiation over a user's internet",
    "start": "456100",
    "end": "458860"
  },
  {
    "text": "connection well after that TLS",
    "start": "458860",
    "end": "461650"
  },
  {
    "text": "connection is established we still might",
    "start": "461650",
    "end": "463930"
  },
  {
    "text": "have to do something like this we still",
    "start": "463930",
    "end": "467140"
  },
  {
    "text": "need to get that users API request all",
    "start": "467140",
    "end": "470500"
  },
  {
    "text": "the way from wherever they happen to",
    "start": "470500",
    "end": "471880"
  },
  {
    "text": "live through one of our points of",
    "start": "471880",
    "end": "473380"
  },
  {
    "text": "presence all the way back to where our",
    "start": "473380",
    "end": "476080"
  },
  {
    "text": "home data center lives we might need to",
    "start": "476080",
    "end": "479080"
  },
  {
    "text": "hit the database for that and maybe",
    "start": "479080",
    "end": "481570"
  },
  {
    "text": "those are only geographically located in",
    "start": "481570",
    "end": "483520"
  },
  {
    "text": "one place now again there's nothing",
    "start": "483520",
    "end": "486210"
  },
  {
    "text": "about this or sorry the the part that",
    "start": "486210",
    "end": "492160"
  },
  {
    "text": "envoy can help us with is making that",
    "start": "492160",
    "end": "494740"
  },
  {
    "text": "leap from two geographically distant",
    "start": "494740",
    "end": "497860"
  },
  {
    "text": "points Japan Ireland those places aren't",
    "start": "497860",
    "end": "502030"
  },
  {
    "text": "getting any closer to the US no matter",
    "start": "502030",
    "end": "504270"
  },
  {
    "text": "what fancy tricks we wish we could pull",
    "start": "504270",
    "end": "506860"
  },
  {
    "text": "so in order to talk about the Envoy",
    "start": "506860",
    "end": "509290"
  },
  {
    "text": "portion of this I'd like to zoom in on",
    "start": "509290",
    "end": "513700"
  },
  {
    "text": "the most interesting part of this",
    "start": "513700",
    "end": "514960"
  },
  {
    "text": "topography which is again the links",
    "start": "514960",
    "end": "518740"
  },
  {
    "text": "between geographically distant locations",
    "start": "518740",
    "end": "521050"
  },
  {
    "text": "so we can ignore the users internet we",
    "start": "521050",
    "end": "522789"
  },
  {
    "text": "can ignore our database and focus on",
    "start": "522790",
    "end": "526240"
  },
  {
    "text": "these links now what we",
    "start": "526240",
    "end": "527970"
  },
  {
    "text": "at stripe so we connected all of these",
    "start": "527970",
    "end": "531300"
  },
  {
    "text": "points of presents using em TLS HTTP to",
    "start": "531300",
    "end": "535230"
  },
  {
    "text": "connections so M TLS is just mutual TLS",
    "start": "535230",
    "end": "538800"
  },
  {
    "text": "to both sides authenticate each other",
    "start": "538800",
    "end": "541200"
  },
  {
    "text": "that gives us security for all these",
    "start": "541200",
    "end": "543090"
  },
  {
    "text": "connections and HTTP to we'll talk about",
    "start": "543090",
    "end": "547920"
  },
  {
    "text": "some of the cool features of HTTP two in",
    "start": "547920",
    "end": "550470"
  },
  {
    "text": "a second but suffice it to say it gives",
    "start": "550470",
    "end": "552930"
  },
  {
    "text": "us efficiency the ability to multiplex",
    "start": "552930",
    "end": "556530"
  },
  {
    "text": "connection or requests over a single TCP",
    "start": "556530",
    "end": "559560"
  },
  {
    "text": "connection and solve some of the like",
    "start": "559560",
    "end": "563040"
  },
  {
    "text": "head-of-line blocking issues you may",
    "start": "563040",
    "end": "564600"
  },
  {
    "text": "have heard of with HTTP one-one where in",
    "start": "564600",
    "end": "568500"
  },
  {
    "text": "order to execute n requests you first do",
    "start": "568500",
    "end": "571650"
  },
  {
    "text": "the first request wait for it to",
    "start": "571650",
    "end": "573180"
  },
  {
    "text": "complete do the second request wait for",
    "start": "573180",
    "end": "575370"
  },
  {
    "text": "it to complete etc with HTTP two we can",
    "start": "575370",
    "end": "577980"
  },
  {
    "text": "multiplex these and perform them more",
    "start": "577980",
    "end": "583560"
  },
  {
    "text": "quickly so the great thing about setting",
    "start": "583560",
    "end": "586530"
  },
  {
    "text": "up this pretty basic envoy use case is",
    "start": "586530",
    "end": "588870"
  },
  {
    "text": "by having envoy and manage the",
    "start": "588870",
    "end": "591000"
  },
  {
    "text": "connection on both sides those",
    "start": "591000",
    "end": "593490"
  },
  {
    "text": "connections which are pretty expensive",
    "start": "593490",
    "end": "595380"
  },
  {
    "text": "to establish you can imagine we've got",
    "start": "595380",
    "end": "597300"
  },
  {
    "text": "to do em TLS between faraway places",
    "start": "597300",
    "end": "600050"
  },
  {
    "text": "those connections now outlive any",
    "start": "600050",
    "end": "603240"
  },
  {
    "text": "application restarts on either side so",
    "start": "603240",
    "end": "605660"
  },
  {
    "text": "at stripe we deploy many times a day",
    "start": "605660",
    "end": "609510"
  },
  {
    "text": "dozens of times a day depending on the",
    "start": "609510",
    "end": "611190"
  },
  {
    "text": "day if we have to deploy to any of those",
    "start": "611190",
    "end": "614550"
  },
  {
    "text": "points of presence and restart some",
    "start": "614550",
    "end": "616800"
  },
  {
    "text": "servers we don't have to tear down and",
    "start": "616800",
    "end": "619830"
  },
  {
    "text": "reestablish these MT last backhaul",
    "start": "619830",
    "end": "624150"
  },
  {
    "text": "connections as we call them to kind of",
    "start": "624150",
    "end": "626130"
  },
  {
    "text": "steal a metaphor from the trucking",
    "start": "626130",
    "end": "628440"
  },
  {
    "text": "industry those connections stay",
    "start": "628440",
    "end": "630930"
  },
  {
    "text": "established and quote-unquote warm so",
    "start": "630930",
    "end": "633690"
  },
  {
    "text": "that any incoming customer requests",
    "start": "633690",
    "end": "635850"
  },
  {
    "text": "whether it be to Japan Ireland the US",
    "start": "635850",
    "end": "637860"
  },
  {
    "text": "what-have-you lands on one of those",
    "start": "637860",
    "end": "640260"
  },
  {
    "text": "connections and gets sent back to our",
    "start": "640260",
    "end": "643740"
  },
  {
    "text": "home datacenter",
    "start": "643740",
    "end": "645560"
  },
  {
    "text": "so what envoy is done here is",
    "start": "645560",
    "end": "648590"
  },
  {
    "text": "drastically reduce the overhead of",
    "start": "648590",
    "end": "650880"
  },
  {
    "text": "serving each new user connection that",
    "start": "650880",
    "end": "653520"
  },
  {
    "text": "comes in so that's great we as you can",
    "start": "653520",
    "end": "659040"
  },
  {
    "text": "imagine connected all of our data",
    "start": "659040",
    "end": "660330"
  },
  {
    "text": "centers",
    "start": "660330",
    "end": "661140"
  },
  {
    "text": "in this way another thing I want to",
    "start": "661140",
    "end": "665040"
  },
  {
    "text": "touch on real quickly is something we",
    "start": "665040",
    "end": "666810"
  },
  {
    "text": "built with great help from envoy which",
    "start": "666810",
    "end": "669959"
  },
  {
    "text": "is our Bluegreen deployments so a quick",
    "start": "669959",
    "end": "674339"
  },
  {
    "text": "perimeter if if you're not familiar with",
    "start": "674339",
    "end": "675750"
  },
  {
    "text": "what Bluegreen deployments are",
    "start": "675750",
    "end": "677070"
  },
  {
    "text": "conveniently I've duplicated our home",
    "start": "677070",
    "end": "679500"
  },
  {
    "text": "data center we made one of them blue one",
    "start": "679500",
    "end": "681180"
  },
  {
    "text": "green there are two identical sets of",
    "start": "681180",
    "end": "684390"
  },
  {
    "text": "infrastructure and typically in the",
    "start": "684390",
    "end": "686970"
  },
  {
    "text": "steady state you have a hundred percent",
    "start": "686970",
    "end": "689970"
  },
  {
    "text": "of your traffic on one copy let's say",
    "start": "689970",
    "end": "692160"
  },
  {
    "text": "blue that leaves you free to deploy new",
    "start": "692160",
    "end": "695730"
  },
  {
    "text": "software to your other copy the green",
    "start": "695730",
    "end": "698459"
  },
  {
    "text": "copy and then shift traffic at your",
    "start": "698459",
    "end": "701399"
  },
  {
    "text": "leisure to test things out make sure",
    "start": "701399",
    "end": "702870"
  },
  {
    "text": "everything looks good there are no bugs",
    "start": "702870",
    "end": "705260"
  },
  {
    "text": "and you can gradually ramp traffic to",
    "start": "705260",
    "end": "708779"
  },
  {
    "text": "your new software version maybe",
    "start": "708779",
    "end": "711420"
  },
  {
    "text": "something like this until eventually",
    "start": "711420",
    "end": "713399"
  },
  {
    "text": "you're free to deploy back to blue so",
    "start": "713399",
    "end": "715740"
  },
  {
    "text": "that's blue green in a nutshell",
    "start": "715740",
    "end": "718200"
  },
  {
    "text": "well the great thing about using envoy",
    "start": "718200",
    "end": "720930"
  },
  {
    "text": "for this is that we use a custom XDS",
    "start": "720930",
    "end": "726449"
  },
  {
    "text": "sidecar that is hooked up to a developer",
    "start": "726449",
    "end": "728670"
  },
  {
    "text": "CLI so any developer can easily and",
    "start": "728670",
    "end": "731910"
  },
  {
    "text": "quickly define that traffic percentage",
    "start": "731910",
    "end": "734910"
  },
  {
    "text": "in that ramping and have it reflected in",
    "start": "734910",
    "end": "737790"
  },
  {
    "text": "envoy across all of our data centers",
    "start": "737790",
    "end": "740720"
  },
  {
    "text": "incredibly quickly the other nice thing",
    "start": "740720",
    "end": "744510"
  },
  {
    "text": "that gets you is that since we're using",
    "start": "744510",
    "end": "746699"
  },
  {
    "text": "our voice Software Defined Networking",
    "start": "746699",
    "end": "748800"
  },
  {
    "text": "for this rather than like changing",
    "start": "748800",
    "end": "750930"
  },
  {
    "text": "weights on a DNS entry or changing DNS",
    "start": "750930",
    "end": "753630"
  },
  {
    "text": "entries altogether we don't have a long",
    "start": "753630",
    "end": "756480"
  },
  {
    "text": "tail of traffic that refuses to shift",
    "start": "756480",
    "end": "759420"
  },
  {
    "text": "like you sometimes get with DNS clients",
    "start": "759420",
    "end": "762240"
  },
  {
    "text": "love to cache DNS entries and not",
    "start": "762240",
    "end": "764670"
  },
  {
    "text": "resolve them when you want them to so",
    "start": "764670",
    "end": "767610"
  },
  {
    "text": "the joke we use at stripe as we use",
    "start": "767610",
    "end": "769850"
  },
  {
    "text": "envoy Sdn not DNS to shift this traffic",
    "start": "769850",
    "end": "774000"
  },
  {
    "text": "it's easy its quick we get complete",
    "start": "774000",
    "end": "776880"
  },
  {
    "text": "traffic shifting it's easy to audit and",
    "start": "776880",
    "end": "781790"
  },
  {
    "text": "again it works dozens of times a day for",
    "start": "781790",
    "end": "786089"
  },
  {
    "text": "us it's probably happening right now as",
    "start": "786089",
    "end": "788670"
  },
  {
    "text": "I speak I'm sure my teammates are back",
    "start": "788670",
    "end": "790470"
  },
  {
    "text": "in Seattle deploying like mad as",
    "start": "790470",
    "end": "793500"
  },
  {
    "text": "speak so these are all elements of what",
    "start": "793500",
    "end": "799740"
  },
  {
    "text": "we think of as our custom control plan",
    "start": "799740",
    "end": "801780"
  },
  {
    "text": "that we built at stripe using on voice",
    "start": "801780",
    "end": "803700"
  },
  {
    "text": "so we have custom XDS services like I",
    "start": "803700",
    "end": "807540"
  },
  {
    "text": "said they give us control over routing",
    "start": "807540",
    "end": "811010"
  },
  {
    "text": "traffic routing traffic ramping they",
    "start": "811010",
    "end": "814080"
  },
  {
    "text": "power all of our Bluegreen deployments",
    "start": "814080",
    "end": "815880"
  },
  {
    "text": "instead of DNS and its myriad issues and",
    "start": "815880",
    "end": "819530"
  },
  {
    "text": "using the priority and locality features",
    "start": "819530",
    "end": "823230"
  },
  {
    "text": "of our voice configuration we've been",
    "start": "823230",
    "end": "826290"
  },
  {
    "text": "able to establish different tiers of",
    "start": "826290",
    "end": "828180"
  },
  {
    "text": "failover infrastructure so through both",
    "start": "828180",
    "end": "832800"
  },
  {
    "text": "active and passive health checking we",
    "start": "832800",
    "end": "834690"
  },
  {
    "text": "allow envoy to failover to different",
    "start": "834690",
    "end": "836760"
  },
  {
    "text": "classes of infrastructure if it detects",
    "start": "836760",
    "end": "838920"
  },
  {
    "text": "problems much faster than any developer",
    "start": "838920",
    "end": "842760"
  },
  {
    "text": "with their own cool little Co I would",
    "start": "842760",
    "end": "845040"
  },
  {
    "text": "manually be able to shift traffic in an",
    "start": "845040",
    "end": "847590"
  },
  {
    "text": "incident and we can do cool things like",
    "start": "847590",
    "end": "849840"
  },
  {
    "text": "prefer a nearby infrastructure versus",
    "start": "849840",
    "end": "852830"
  },
  {
    "text": "infrastructure further away which is the",
    "start": "852830",
    "end": "854820"
  },
  {
    "text": "locality piece of that again because we",
    "start": "854820",
    "end": "858750"
  },
  {
    "text": "have developer tooling built up on this",
    "start": "858750",
    "end": "860190"
  },
  {
    "text": "we can manually remediate incidents",
    "start": "860190",
    "end": "862500"
  },
  {
    "text": "pretty easily we can shift traffic off",
    "start": "862500",
    "end": "864270"
  },
  {
    "text": "of defective Hardware bat deployments",
    "start": "864270",
    "end": "866910"
  },
  {
    "text": "etc we can also and do take advantage of",
    "start": "866910",
    "end": "871740"
  },
  {
    "text": "on Veliz header based routing and things",
    "start": "871740",
    "end": "874080"
  },
  {
    "text": "like that to not only route specific",
    "start": "874080",
    "end": "877260"
  },
  {
    "text": "requests to particular infrastructure",
    "start": "877260",
    "end": "879300"
  },
  {
    "text": "but requests say per customer or per",
    "start": "879300",
    "end": "882750"
  },
  {
    "text": "account and I believe there's the talk",
    "start": "882750",
    "end": "885180"
  },
  {
    "text": "coming up later today about some dynamic",
    "start": "885180",
    "end": "887070"
  },
  {
    "text": "routing that I'm I'm excited to hear",
    "start": "887070",
    "end": "889020"
  },
  {
    "text": "about of course it wouldn't be a",
    "start": "889020",
    "end": "894110"
  },
  {
    "text": "comprehensive talk if all I did was talk",
    "start": "894110",
    "end": "896700"
  },
  {
    "text": "about the great things we built and none",
    "start": "896700",
    "end": "898440"
  },
  {
    "text": "of the challenges we experienced along",
    "start": "898440",
    "end": "900030"
  },
  {
    "text": "the way so I mentioned earlier that HTTP",
    "start": "900030",
    "end": "903720"
  },
  {
    "text": "2 allows you to multiplex many requests",
    "start": "903720",
    "end": "906000"
  },
  {
    "text": "onto a single TCP connection so what we",
    "start": "906000",
    "end": "908250"
  },
  {
    "text": "have here I know there's no y-axis and",
    "start": "908250",
    "end": "911280"
  },
  {
    "text": "there's no numbers on here that's on",
    "start": "911280",
    "end": "913140"
  },
  {
    "text": "purpose but this is a chart from our",
    "start": "913140",
    "end": "915780"
  },
  {
    "text": "production infrastructure between two of",
    "start": "915780",
    "end": "918240"
  },
  {
    "text": "those geographically distant points of",
    "start": "918240",
    "end": "921000"
  },
  {
    "text": "presence let's just say Ireland in the",
    "start": "921000",
    "end": "923130"
  },
  {
    "text": "US and what we're looking at is the",
    "start": "923130",
    "end": "925740"
  },
  {
    "text": "number of",
    "start": "925740",
    "end": "926910"
  },
  {
    "text": "ttp requests per TCP connection over",
    "start": "926910",
    "end": "930330"
  },
  {
    "text": "time so you'll notice there two of them",
    "start": "930330",
    "end": "932910"
  },
  {
    "text": "that seem to be a lot busier than the",
    "start": "932910",
    "end": "934650"
  },
  {
    "text": "rest and this is a pattern we actually",
    "start": "934650",
    "end": "937160"
  },
  {
    "text": "observed when we started building this",
    "start": "937160",
    "end": "939420"
  },
  {
    "text": "infrastructure now we run multi-threaded",
    "start": "939420",
    "end": "942330"
  },
  {
    "text": "envoy on the server we have one worker",
    "start": "942330",
    "end": "944640"
  },
  {
    "text": "thread per core I think you know how",
    "start": "944640",
    "end": "946560"
  },
  {
    "text": "this story goes envoy defers to the",
    "start": "946560",
    "end": "950460"
  },
  {
    "text": "kernel for certain things like figuring",
    "start": "950460",
    "end": "952560"
  },
  {
    "text": "out which worker thread will accept an",
    "start": "952560",
    "end": "954780"
  },
  {
    "text": "incoming connection and we we found in",
    "start": "954780",
    "end": "959490"
  },
  {
    "text": "our initial configuration that busy",
    "start": "959490",
    "end": "961530"
  },
  {
    "text": "threads tended to win so connections",
    "start": "961530",
    "end": "965370"
  },
  {
    "text": "with many requests tended to accept new",
    "start": "965370",
    "end": "967830"
  },
  {
    "text": "requests so with this knowledge in hand",
    "start": "967830",
    "end": "972530"
  },
  {
    "text": "and again going back to HTTP 2 which is",
    "start": "972530",
    "end": "979410"
  },
  {
    "text": "handling data for multiple requests at",
    "start": "979410",
    "end": "981750"
  },
  {
    "text": "the same time that's known as a stream",
    "start": "981750",
    "end": "983760"
  },
  {
    "text": "in HTTP 2 parlance here in this example",
    "start": "983760",
    "end": "986750"
  },
  {
    "text": "we have data for streams 1 3 & 5 all",
    "start": "986750",
    "end": "990390"
  },
  {
    "text": "being sent over the same TCP connection",
    "start": "990390",
    "end": "993440"
  },
  {
    "text": "by the way these images come from the",
    "start": "993440",
    "end": "995970"
  },
  {
    "text": "great high performance browser",
    "start": "995970",
    "end": "997380"
  },
  {
    "text": "networking book that's freely available",
    "start": "997380",
    "end": "999600"
  },
  {
    "text": "online it's amazing if you deal at all",
    "start": "999600",
    "end": "1003620"
  },
  {
    "text": "with HTTP so first stripe this means we",
    "start": "1003620",
    "end": "1008870"
  },
  {
    "text": "could have requests for say one of our",
    "start": "1008870",
    "end": "1012050"
  },
  {
    "text": "smallest startup customers they're just",
    "start": "1012050",
    "end": "1014360"
  },
  {
    "text": "trying to charge a credit card to make a",
    "start": "1014360",
    "end": "1016430"
  },
  {
    "text": "few bucks to keep the lights on right",
    "start": "1016430",
    "end": "1018800"
  },
  {
    "text": "alongside requests from one of our",
    "start": "1018800",
    "end": "1022040"
  },
  {
    "text": "largest most important enterprise",
    "start": "1022040",
    "end": "1023450"
  },
  {
    "text": "customers those customers that rely on",
    "start": "1023450",
    "end": "1026329"
  },
  {
    "text": "us for those many nines of availability",
    "start": "1026330",
    "end": "1028579"
  },
  {
    "text": "and uptime so why does any of that",
    "start": "1028580",
    "end": "1035449"
  },
  {
    "text": "matter who cares if more requests are on",
    "start": "1035450",
    "end": "1038689"
  },
  {
    "text": "one connection or the other as long as",
    "start": "1038690",
    "end": "1040189"
  },
  {
    "text": "they're succeeding right well as we know",
    "start": "1040190",
    "end": "1042910"
  },
  {
    "text": "or we should constantly remind ourselves",
    "start": "1042910",
    "end": "1045890"
  },
  {
    "text": "the network is not reliable that's a",
    "start": "1045890",
    "end": "1048620"
  },
  {
    "text": "fundamental fact and we experience",
    "start": "1048620",
    "end": "1052790"
  },
  {
    "text": "especially when going to these",
    "start": "1052790",
    "end": "1055900"
  },
  {
    "text": "geographically distant locations bad",
    "start": "1055900",
    "end": "1059420"
  },
  {
    "text": "Network condition",
    "start": "1059420",
    "end": "1060320"
  },
  {
    "text": "things like TCP packet loss so again",
    "start": "1060320",
    "end": "1064490"
  },
  {
    "text": "quick primer packet loss and TCP",
    "start": "1064490",
    "end": "1068330"
  },
  {
    "text": "retransmits or what happened when data",
    "start": "1068330",
    "end": "1070250"
  },
  {
    "text": "gets lost in transit so if we send three",
    "start": "1070250",
    "end": "1073190"
  },
  {
    "text": "TCP segments the receiver only gets two",
    "start": "1073190",
    "end": "1076399"
  },
  {
    "text": "of them eventually the fact has to be",
    "start": "1076399",
    "end": "1078470"
  },
  {
    "text": "communicated the head and get one",
    "start": "1078470",
    "end": "1080289"
  },
  {
    "text": "retransmitted this happens all the time",
    "start": "1080289",
    "end": "1082909"
  },
  {
    "text": "TCP is pretty good at dealing with this",
    "start": "1082909",
    "end": "1087399"
  },
  {
    "text": "but again what happens in practice when",
    "start": "1087399",
    "end": "1092139"
  },
  {
    "text": "packet loss and retransmit start to",
    "start": "1092139",
    "end": "1094519"
  },
  {
    "text": "occur well I apologize if this is a tiny",
    "start": "1094519",
    "end": "1098179"
  },
  {
    "text": "bit hard to read in the back but what",
    "start": "1098179",
    "end": "1100070"
  },
  {
    "text": "we're looking at here is a blue line",
    "start": "1100070",
    "end": "1101919"
  },
  {
    "text": "going steadily up into the right and",
    "start": "1101919",
    "end": "1104269"
  },
  {
    "text": "that represents TCP retransmits and this",
    "start": "1104269",
    "end": "1108110"
  },
  {
    "text": "is from our production infrastructure",
    "start": "1108110",
    "end": "1111350"
  },
  {
    "text": "and so we have cumulative retransmits",
    "start": "1111350",
    "end": "1115639"
  },
  {
    "text": "that means things are having to be",
    "start": "1115639",
    "end": "1117350"
  },
  {
    "text": "resent over and over by the operating",
    "start": "1117350",
    "end": "1119659"
  },
  {
    "text": "system we're experiencing some sort of",
    "start": "1119659",
    "end": "1121879"
  },
  {
    "text": "network difficulty and the green line is",
    "start": "1121879",
    "end": "1124610"
  },
  {
    "text": "a measure of the kernels right Q so the",
    "start": "1124610",
    "end": "1128120"
  },
  {
    "text": "data backing up",
    "start": "1128120",
    "end": "1129139"
  },
  {
    "text": "that's unable to be sent over the wire",
    "start": "1129139",
    "end": "1130909"
  },
  {
    "text": "during that time of retransmits",
    "start": "1130909",
    "end": "1133120"
  },
  {
    "text": "so this this kind of makes intuitive",
    "start": "1133120",
    "end": "1135320"
  },
  {
    "text": "sense right",
    "start": "1135320",
    "end": "1136129"
  },
  {
    "text": "like retransmits are happening the",
    "start": "1136129",
    "end": "1137929"
  },
  {
    "text": "kernels like backing up for the",
    "start": "1137929",
    "end": "1140990"
  },
  {
    "text": "customers that means increased latency",
    "start": "1140990",
    "end": "1142639"
  },
  {
    "text": "x' timeouts things that are not great so",
    "start": "1142639",
    "end": "1146899"
  },
  {
    "text": "this next chart i've Chet I've kept the",
    "start": "1146899",
    "end": "1148879"
  },
  {
    "text": "green line the kernel right queue what",
    "start": "1148879",
    "end": "1152899"
  },
  {
    "text": "we see instead the blue line is now a",
    "start": "1152899",
    "end": "1154340"
  },
  {
    "text": "measure of the effective bandwidth of",
    "start": "1154340",
    "end": "1156860"
  },
  {
    "text": "that connection again intuitively makes",
    "start": "1156860",
    "end": "1160039"
  },
  {
    "text": "sense when the retransmits",
    "start": "1160039",
    "end": "1161480"
  },
  {
    "text": "and right queuing or happening bandwidth",
    "start": "1161480",
    "end": "1164529"
  },
  {
    "text": "decreases dramatically so one thing we",
    "start": "1164529",
    "end": "1168590"
  },
  {
    "text": "did as we change which congestion",
    "start": "1168590",
    "end": "1173000"
  },
  {
    "text": "control algorithm we were using on the",
    "start": "1173000",
    "end": "1176470"
  },
  {
    "text": "hardware that I diagrammed earlier we",
    "start": "1176470",
    "end": "1180769"
  },
  {
    "text": "used a new congestion control algorithm",
    "start": "1180769",
    "end": "1183950"
  },
  {
    "text": "called bbr this is something that came",
    "start": "1183950",
    "end": "1187610"
  },
  {
    "text": "out of Google research I believe and",
    "start": "1187610",
    "end": "1190600"
  },
  {
    "text": "what the silly chart here",
    "start": "1190600",
    "end": "1194289"
  },
  {
    "text": "attempts to kind of show is that bbr",
    "start": "1194289",
    "end": "1197119"
  },
  {
    "text": "attempts to maintain higher throughput",
    "start": "1197119",
    "end": "1199069"
  },
  {
    "text": "in the face of packet loss retransmits",
    "start": "1199069",
    "end": "1201499"
  },
  {
    "text": "network instability",
    "start": "1201499",
    "end": "1204999"
  },
  {
    "text": "however rolling this out well it was not",
    "start": "1206829",
    "end": "1209569"
  },
  {
    "text": "a simple upgrade for us it depends a lot",
    "start": "1209569",
    "end": "1211969"
  },
  {
    "text": "on your OS version a kernel version",
    "start": "1211969",
    "end": "1213649"
  },
  {
    "text": "might not be the easiest thing to roll",
    "start": "1213649",
    "end": "1216349"
  },
  {
    "text": "out we made some other tweaks once we",
    "start": "1216349",
    "end": "1222499"
  },
  {
    "text": "set this up so in addition to changing",
    "start": "1222499",
    "end": "1225469"
  },
  {
    "text": "the congestion control algorithm we",
    "start": "1225469",
    "end": "1228319"
  },
  {
    "text": "encountered this HT to be - head of line",
    "start": "1228319",
    "end": "1231379"
  },
  {
    "text": "blocking problem well HTTP - is supposed",
    "start": "1231379",
    "end": "1234709"
  },
  {
    "text": "to solve head of line blocking but it",
    "start": "1234709",
    "end": "1236749"
  },
  {
    "text": "has its own head of line blocking",
    "start": "1236749",
    "end": "1238009"
  },
  {
    "text": "problem it's just one based on TCP if",
    "start": "1238009",
    "end": "1241549"
  },
  {
    "text": "TCP isn't able to send all the packets",
    "start": "1241549",
    "end": "1244279"
  },
  {
    "text": "there's nothing a higher level protocol",
    "start": "1244279",
    "end": "1245989"
  },
  {
    "text": "like HTTP 2 can do to fix that",
    "start": "1245989",
    "end": "1249199"
  },
  {
    "text": "so one thing we did is we increase the",
    "start": "1249199",
    "end": "1253549"
  },
  {
    "text": "number of upstream TCP connections and",
    "start": "1253549",
    "end": "1255709"
  },
  {
    "text": "what we found is that that distribution",
    "start": "1255709",
    "end": "1259699"
  },
  {
    "text": "of requests per connection got a month",
    "start": "1259699",
    "end": "1261709"
  },
  {
    "text": "got much more even and we didn't have",
    "start": "1261709",
    "end": "1265609"
  },
  {
    "text": "the disproportionate impact when one",
    "start": "1265609",
    "end": "1268399"
  },
  {
    "text": "link would experience packet loss or",
    "start": "1268399",
    "end": "1271609"
  },
  {
    "text": "retransmits we did this by telling envoy",
    "start": "1271609",
    "end": "1275569"
  },
  {
    "text": "to use these up streams so as it turns",
    "start": "1275569",
    "end": "1278719"
  },
  {
    "text": "out this is an actual Envoy config as",
    "start": "1278719",
    "end": "1281089"
  },
  {
    "text": "you can tell but andö is more than happy",
    "start": "1281089",
    "end": "1283219"
  },
  {
    "text": "to open twice as many TCP connections to",
    "start": "1283219",
    "end": "1285769"
  },
  {
    "text": "fubar striped comm if we tell it to so",
    "start": "1285769",
    "end": "1289339"
  },
  {
    "text": "this was a little unexpected but it was",
    "start": "1289339",
    "end": "1291139"
  },
  {
    "text": "great because now we have the best of",
    "start": "1291139",
    "end": "1292849"
  },
  {
    "text": "both worlds we have HTTP to request",
    "start": "1292849",
    "end": "1295519"
  },
  {
    "text": "multiplexing so we get more requests per",
    "start": "1295519",
    "end": "1297949"
  },
  {
    "text": "connection and now we have more TCP",
    "start": "1297949",
    "end": "1300199"
  },
  {
    "text": "connections great we're getting",
    "start": "1300199",
    "end": "1302269"
  },
  {
    "text": "somewhere",
    "start": "1302269",
    "end": "1302979"
  },
  {
    "text": "we're now sharing that request burden",
    "start": "1302979",
    "end": "1305719"
  },
  {
    "text": "evenly across our connections a little",
    "start": "1305719",
    "end": "1309169"
  },
  {
    "text": "bit of a I guess I'll call it creative",
    "start": "1309169",
    "end": "1311599"
  },
  {
    "text": "solution it felt it felt weird to set",
    "start": "1311599",
    "end": "1315649"
  },
  {
    "text": "something like this up in config but",
    "start": "1315649",
    "end": "1317299"
  },
  {
    "text": "again envoy is more than happy to honor",
    "start": "1317299",
    "end": "1319639"
  },
  {
    "text": "it",
    "start": "1319639",
    "end": "1321419"
  },
  {
    "text": "so with enough custom tweaks like this",
    "start": "1321419",
    "end": "1324359"
  },
  {
    "text": "we eventually figured out that we could",
    "start": "1324359",
    "end": "1326700"
  },
  {
    "text": "manage the bandwidth and request burden",
    "start": "1326700",
    "end": "1330059"
  },
  {
    "text": "across all of our geographically",
    "start": "1330059",
    "end": "1332129"
  },
  {
    "text": "distributed links and the infrastructure",
    "start": "1332129",
    "end": "1334769"
  },
  {
    "text": "became stable so this is kind of where",
    "start": "1334769",
    "end": "1337019"
  },
  {
    "text": "we move into the pros and cons looking",
    "start": "1337019",
    "end": "1341309"
  },
  {
    "text": "back what would we do differently part",
    "start": "1341309",
    "end": "1342779"
  },
  {
    "text": "of it to talk so again be be our",
    "start": "1342779",
    "end": "1347190"
  },
  {
    "text": "congestion control was something we used",
    "start": "1347190",
    "end": "1348839"
  },
  {
    "text": "along with the FQ fair queuing packet",
    "start": "1348839",
    "end": "1351690"
  },
  {
    "text": "scheduler these are all things I don't",
    "start": "1351690",
    "end": "1353039"
  },
  {
    "text": "have time to dive into we also enabled",
    "start": "1353039",
    "end": "1355979"
  },
  {
    "text": "TCP keep Alive's on all of our up",
    "start": "1355979",
    "end": "1357779"
  },
  {
    "text": "streams depending on your cloud provider",
    "start": "1357779",
    "end": "1360149"
  },
  {
    "text": "and what middle boxes you might have in",
    "start": "1360149",
    "end": "1362909"
  },
  {
    "text": "your architecture this becomes pretty",
    "start": "1362909",
    "end": "1365159"
  },
  {
    "text": "important to not have connection state",
    "start": "1365159",
    "end": "1367679"
  },
  {
    "text": "get garbage collected out from under you",
    "start": "1367679",
    "end": "1369359"
  },
  {
    "text": "we can if you find me later we can talk",
    "start": "1369359",
    "end": "1371399"
  },
  {
    "text": "all about the fun problems that come",
    "start": "1371399",
    "end": "1373409"
  },
  {
    "text": "with that",
    "start": "1373409",
    "end": "1374539"
  },
  {
    "text": "so let's look back we built this",
    "start": "1374539",
    "end": "1378899"
  },
  {
    "text": "architecture what were some of the",
    "start": "1378899",
    "end": "1380309"
  },
  {
    "text": "things it bought us so the biggest set",
    "start": "1380309",
    "end": "1383519"
  },
  {
    "text": "of pros is that we have these backhaul",
    "start": "1383519",
    "end": "1386039"
  },
  {
    "text": "connections as I referred to them that",
    "start": "1386039",
    "end": "1388709"
  },
  {
    "text": "outlive our application process restarts",
    "start": "1388709",
    "end": "1391549"
  },
  {
    "text": "they allow us to efficiently send",
    "start": "1391549",
    "end": "1395099"
  },
  {
    "text": "incoming customer requests all around",
    "start": "1395099",
    "end": "1398190"
  },
  {
    "text": "the globe without paying this massive",
    "start": "1398190",
    "end": "1400499"
  },
  {
    "text": "set-up cost for each additional",
    "start": "1400499",
    "end": "1402179"
  },
  {
    "text": "connection",
    "start": "1402179",
    "end": "1404009"
  },
  {
    "text": "we have great observability now between",
    "start": "1404009",
    "end": "1406649"
  },
  {
    "text": "all of our network links and our data",
    "start": "1406649",
    "end": "1408479"
  },
  {
    "text": "centers again the running joke any",
    "start": "1408479",
    "end": "1411899"
  },
  {
    "text": "conversation at envoy about Anglais that",
    "start": "1411899",
    "end": "1414209"
  },
  {
    "text": "happens at stripe usually starts with oh",
    "start": "1414209",
    "end": "1416399"
  },
  {
    "text": "there's a metric for that and indeed",
    "start": "1416399",
    "end": "1419609"
  },
  {
    "text": "there literally is a metric for almost",
    "start": "1419609",
    "end": "1422009"
  },
  {
    "text": "everything so we have great",
    "start": "1422009",
    "end": "1423029"
  },
  {
    "text": "observability now again fixes get",
    "start": "1423029",
    "end": "1427799"
  },
  {
    "text": "propagated to all of our network links",
    "start": "1427799",
    "end": "1431399"
  },
  {
    "text": "between data centers roughly at once I",
    "start": "1431399",
    "end": "1434639"
  },
  {
    "text": "don't want to say at once whether they",
    "start": "1434639",
    "end": "1437519"
  },
  {
    "text": "be fixes for a CVE",
    "start": "1437519",
    "end": "1439169"
  },
  {
    "text": "or regular Envoy version updates this is",
    "start": "1439169",
    "end": "1443070"
  },
  {
    "text": "in contrast to having to upgrade and",
    "start": "1443070",
    "end": "1445019"
  },
  {
    "text": "migrate all of your applications at each",
    "start": "1445019",
    "end": "1447149"
  },
  {
    "text": "of those points and similarly network",
    "start": "1447149",
    "end": "1450719"
  },
  {
    "text": "behavior so you find a better",
    "start": "1450719",
    "end": "1452359"
  },
  {
    "text": "configuration a better way to do retries",
    "start": "1452359",
    "end": "1455980"
  },
  {
    "text": "you change you want to change the cipher",
    "start": "1455980",
    "end": "1458080"
  },
  {
    "text": "Suites your TLS connections are using",
    "start": "1458080",
    "end": "1460330"
  },
  {
    "text": "you can change that behavior across your",
    "start": "1460330",
    "end": "1462970"
  },
  {
    "text": "network topology without having to go",
    "start": "1462970",
    "end": "1464769"
  },
  {
    "text": "modify 100 applications now I'm a",
    "start": "1464769",
    "end": "1468779"
  },
  {
    "text": "software engineer again I write",
    "start": "1468779",
    "end": "1470890"
  },
  {
    "text": "application code for living why do I",
    "start": "1470890",
    "end": "1472450"
  },
  {
    "text": "make it sound like changing an",
    "start": "1472450",
    "end": "1474190"
  },
  {
    "text": "application is this insurmountable huge",
    "start": "1474190",
    "end": "1476860"
  },
  {
    "text": "pain in the ass task well it's because",
    "start": "1476860",
    "end": "1480370"
  },
  {
    "text": "teams not only it's stripe but every",
    "start": "1480370",
    "end": "1484029"
  },
  {
    "text": "company I've ever worked at our polyglot",
    "start": "1484029",
    "end": "1486279"
  },
  {
    "text": "so it's stripe we have people writing",
    "start": "1486279",
    "end": "1488559"
  },
  {
    "text": "servers and applications and go we have",
    "start": "1488559",
    "end": "1491889"
  },
  {
    "text": "a ton of stuff in Ruby we have some",
    "start": "1491889",
    "end": "1493690"
  },
  {
    "text": "Scala thrown in there but even within a",
    "start": "1493690",
    "end": "1496360"
  },
  {
    "text": "language you have different frameworks",
    "start": "1496360",
    "end": "1498149"
  },
  {
    "text": "people might be using different Network",
    "start": "1498149",
    "end": "1500169"
  },
  {
    "text": "clients you might have different runtime",
    "start": "1500169",
    "end": "1502840"
  },
  {
    "text": "versions etc etc all of those are gonna",
    "start": "1502840",
    "end": "1505510"
  },
  {
    "text": "have different network behavior defaults",
    "start": "1505510",
    "end": "1508059"
  },
  {
    "text": "different ways to configure things and",
    "start": "1508059",
    "end": "1511360"
  },
  {
    "text": "so change making a sweeping like network",
    "start": "1511360",
    "end": "1514690"
  },
  {
    "text": "behavior change across many services",
    "start": "1514690",
    "end": "1517960"
  },
  {
    "text": "languages frameworks clients indeed ends",
    "start": "1517960",
    "end": "1520840"
  },
  {
    "text": "up being a huge challenge so we decided",
    "start": "1520840",
    "end": "1523720"
  },
  {
    "text": "to sort of outsource that to envoy where",
    "start": "1523720",
    "end": "1526539"
  },
  {
    "text": "things are much more uniform again I",
    "start": "1526539",
    "end": "1532809"
  },
  {
    "text": "can't give prose without given some cons",
    "start": "1532809",
    "end": "1536289"
  },
  {
    "text": "so what are some some cons that we get",
    "start": "1536289",
    "end": "1541450"
  },
  {
    "text": "with the benefit of hindsight so one is",
    "start": "1541450",
    "end": "1544029"
  },
  {
    "text": "that having ongoing manage both sides of",
    "start": "1544029",
    "end": "1546370"
  },
  {
    "text": "every connection between every data",
    "start": "1546370",
    "end": "1548289"
  },
  {
    "text": "center adds a lot of moving pieces to",
    "start": "1548289",
    "end": "1551649"
  },
  {
    "text": "your stack all those pieces need to be",
    "start": "1551649",
    "end": "1554620"
  },
  {
    "text": "monitored they need to be make their way",
    "start": "1554620",
    "end": "1557470"
  },
  {
    "text": "into your network diagrams they need to",
    "start": "1557470",
    "end": "1559600"
  },
  {
    "text": "be upgraded from time to time and your",
    "start": "1559600",
    "end": "1561730"
  },
  {
    "text": "engineers need to learn about how they",
    "start": "1561730",
    "end": "1563710"
  },
  {
    "text": "those pieces work and how to operate",
    "start": "1563710",
    "end": "1566950"
  },
  {
    "text": "them so they need to know like where the",
    "start": "1566950",
    "end": "1568659"
  },
  {
    "text": "knobs are how do I change config how do",
    "start": "1568659",
    "end": "1571539"
  },
  {
    "text": "I go about manipulating Envoy in",
    "start": "1571539",
    "end": "1575049"
  },
  {
    "text": "practice things like timeouts and access",
    "start": "1575049",
    "end": "1579610"
  },
  {
    "text": "logs and vestiges of network behavior",
    "start": "1579610",
    "end": "1582750"
  },
  {
    "text": "that live in your apps still need to be",
    "start": "1582750",
    "end": "1585100"
  },
  {
    "text": "kept in sync with the on boy that's kind",
    "start": "1585100",
    "end": "1586570"
  },
  {
    "text": "of a minor point",
    "start": "1586570",
    "end": "1588070"
  },
  {
    "text": "a bigger one for us was when you",
    "start": "1588070",
    "end": "1589989"
  },
  {
    "text": "encounter bugs in a product like envoy",
    "start": "1589989",
    "end": "1592690"
  },
  {
    "text": "it might not be in the sort of",
    "start": "1592690",
    "end": "1595600"
  },
  {
    "text": "wheelhouse or domain of your application",
    "start": "1595600",
    "end": "1597789"
  },
  {
    "text": "developers so for us at stripe there are",
    "start": "1597789",
    "end": "1600399"
  },
  {
    "text": "a few things we wanted to work on in",
    "start": "1600399",
    "end": "1603100"
  },
  {
    "text": "envoy in' it turns out we don't have a",
    "start": "1603100",
    "end": "1605109"
  },
  {
    "text": "lot of in-house c++ experience on boys a",
    "start": "1605109",
    "end": "1609129"
  },
  {
    "text": "large C++ application so that was just",
    "start": "1609129",
    "end": "1612129"
  },
  {
    "text": "something to to think about",
    "start": "1612129",
    "end": "1614549"
  },
  {
    "text": "again you have to spread operability",
    "start": "1614549",
    "end": "1616720"
  },
  {
    "text": "knowledge amongst your team members you",
    "start": "1616720",
    "end": "1619090"
  },
  {
    "text": "know I'm not on call right now thank",
    "start": "1619090",
    "end": "1621580"
  },
  {
    "text": "goodness but when I am on call I need to",
    "start": "1621580",
    "end": "1623710"
  },
  {
    "text": "know how to operate all the pieces of",
    "start": "1623710",
    "end": "1625809"
  },
  {
    "text": "the stack I'm responsible for whether",
    "start": "1625809",
    "end": "1629019"
  },
  {
    "text": "that be envoy or any other piece of",
    "start": "1629019",
    "end": "1631779"
  },
  {
    "text": "software and I see that I'm running a",
    "start": "1631779",
    "end": "1635559"
  },
  {
    "text": "little low on time so we don't have time",
    "start": "1635559",
    "end": "1637210"
  },
  {
    "text": "to dive into this last one but it's",
    "start": "1637210",
    "end": "1639129"
  },
  {
    "text": "pretty interesting if you want to find",
    "start": "1639129",
    "end": "1640509"
  },
  {
    "text": "me after the actual implementations of",
    "start": "1640509",
    "end": "1643869"
  },
  {
    "text": "the HTTP protocols themselves might",
    "start": "1643869",
    "end": "1647590"
  },
  {
    "text": "differ slightly in Envoy than they do in",
    "start": "1647590",
    "end": "1649809"
  },
  {
    "text": "other pieces of your stack",
    "start": "1649809",
    "end": "1651580"
  },
  {
    "text": "whether that be nginx go H a proxy and",
    "start": "1651580",
    "end": "1654539"
  },
  {
    "text": "you're thinking well HTTP is a standard",
    "start": "1654539",
    "end": "1657340"
  },
  {
    "text": "like they everything works the same if",
    "start": "1657340",
    "end": "1659799"
  },
  {
    "text": "it's codified in a standard well yeah",
    "start": "1659799",
    "end": "1661629"
  },
  {
    "text": "most the time and again like I have some",
    "start": "1661629",
    "end": "1665979"
  },
  {
    "text": "fun some fun stories about that I picked",
    "start": "1665979",
    "end": "1669220"
  },
  {
    "text": "and genetics go H a proxy these are",
    "start": "1669220",
    "end": "1671619"
  },
  {
    "text": "common at stripe common other places so",
    "start": "1671619",
    "end": "1676840"
  },
  {
    "text": "I guess that's a lot of information I",
    "start": "1676840",
    "end": "1679989"
  },
  {
    "text": "apologize I just kind of beat you over",
    "start": "1679989",
    "end": "1681639"
  },
  {
    "text": "the head with BB rtcp retransmits",
    "start": "1681639",
    "end": "1684509"
  },
  {
    "text": "Anglais configuration XDS sidecars a lot",
    "start": "1684509",
    "end": "1687639"
  },
  {
    "text": "of jargon but the message I'd like to",
    "start": "1687639",
    "end": "1691479"
  },
  {
    "text": "leave you with to kind of wrap this up",
    "start": "1691479",
    "end": "1693940"
  },
  {
    "text": "is that we built a network topology",
    "start": "1693940",
    "end": "1699090"
  },
  {
    "text": "heavily based on envoy and we did indeed",
    "start": "1699090",
    "end": "1702489"
  },
  {
    "text": "span the globe we used Envoy to connect",
    "start": "1702489",
    "end": "1708519"
  },
  {
    "text": "those millions of customers in those 120",
    "start": "1708519",
    "end": "1711489"
  },
  {
    "text": "plus countries I'm sure I left some of",
    "start": "1711489",
    "end": "1714279"
  },
  {
    "text": "them off of this diagram and we allowed",
    "start": "1714279",
    "end": "1717429"
  },
  {
    "text": "people to transact move money",
    "start": "1717429",
    "end": "1720100"
  },
  {
    "text": "start run and manage their businesses",
    "start": "1720100",
    "end": "1722740"
  },
  {
    "text": "online 24/7 not many nines of",
    "start": "1722740",
    "end": "1727570"
  },
  {
    "text": "availability and they're doing so even",
    "start": "1727570",
    "end": "1729430"
  },
  {
    "text": "as we speak today maybe for some of the",
    "start": "1729430",
    "end": "1731830"
  },
  {
    "text": "businesses that employ all of you so we",
    "start": "1731830",
    "end": "1735340"
  },
  {
    "text": "couldn't have done it without a lot of",
    "start": "1735340",
    "end": "1736930"
  },
  {
    "text": "help from the Anglais community I",
    "start": "1736930",
    "end": "1738340"
  },
  {
    "text": "actually just met someone before my talk",
    "start": "1738340",
    "end": "1740800"
  },
  {
    "text": "started that I knew from working on a PR",
    "start": "1740800",
    "end": "1743500"
  },
  {
    "text": "with I'd never met her in real life I",
    "start": "1743500",
    "end": "1745750"
  },
  {
    "text": "was like oh wait I know your github",
    "start": "1745750",
    "end": "1748300"
  },
  {
    "text": "username so thanks to everyone out there",
    "start": "1748300",
    "end": "1751840"
  },
  {
    "text": "who has worked or helped make on boy",
    "start": "1751840",
    "end": "1754480"
  },
  {
    "text": "what it is today and with that I have 37",
    "start": "1754480",
    "end": "1758560"
  },
  {
    "text": "seconds so thank you",
    "start": "1758560",
    "end": "1761260"
  },
  {
    "text": "[Applause]",
    "start": "1761260",
    "end": "1768190"
  }
]