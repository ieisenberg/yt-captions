[
  {
    "text": "all right it's 11:50 let's get started welcome to the maintainer tract session",
    "start": "390",
    "end": "7799"
  },
  {
    "text": "for spire thanks for making it out over here I'm excited to talk about scaling",
    "start": "7799",
    "end": "15089"
  },
  {
    "text": "spire for performance and availability I'm Tyler Julian for those of you who",
    "start": "15089",
    "end": "20670"
  },
  {
    "text": "don't know me I'm a software engineer at uber I work on our identity access management team I've been there for a",
    "start": "20670",
    "end": "26250"
  },
  {
    "text": "number of years working on building security infrastructure on spire I'm a",
    "start": "26250",
    "end": "32070"
  },
  {
    "text": "maintainer I've been working on the project for about a year now and and I'm",
    "start": "32070",
    "end": "37110"
  },
  {
    "text": "excited to talk about spire and sort of how it's changed over time what's important to the project and how you can",
    "start": "37110",
    "end": "43410"
  },
  {
    "text": "use that to build zero trust system I thought it might begin with a discussion",
    "start": "43410",
    "end": "49710"
  },
  {
    "text": "of trust what that word means the word",
    "start": "49710",
    "end": "54989"
  },
  {
    "text": "fidelity in English comes from the Latin root fides the Roman goddess of truth",
    "start": "54989",
    "end": "60809"
  },
  {
    "text": "and honesty and to trust someone in ancient Roman times was to say a prayer",
    "start": "60809",
    "end": "65909"
  },
  {
    "text": "to the goddess Thetis to to bless you with good faith and to to watch over",
    "start": "65909",
    "end": "71909"
  },
  {
    "text": "your trust now this hasn't really stood the test of time and today when we think",
    "start": "71909",
    "end": "77880"
  },
  {
    "text": "about trust we need a better definition one that I quite like goes like this Trust is meant to convey an expectation",
    "start": "77880",
    "end": "84840"
  },
  {
    "text": "of behavior however predictable behavior does not necessarily constitute behavior",
    "start": "84840",
    "end": "90000"
  },
  {
    "text": "that's worthy of trust for example we expect a bank will behave like a bank and we expect a thief will behave like a",
    "start": "90000",
    "end": "96060"
  },
  {
    "text": "thief trust as expectation of behavior look at a practical example imagine that",
    "start": "96060",
    "end": "102990"
  },
  {
    "text": "you and I were developing a service to deliver fresh produce to people right and so we would start with a front-end",
    "start": "102990",
    "end": "109049"
  },
  {
    "text": "service that serves orders and say we have Alice come and she wants to take a look at some of her prior orders well we",
    "start": "109049",
    "end": "116009"
  },
  {
    "text": "could trust that Alex would only look Alice would only look at her data we would have this expectation but as we",
    "start": "116009",
    "end": "121829"
  },
  {
    "text": "know that's not a very safe expectation we can't really trust alice in this regard so what do we do we set up an identity provider to provide identity to",
    "start": "121829",
    "end": "128369"
  },
  {
    "text": "Alex Alice some kind of cryptographic token right a set of a policy engine that defy",
    "start": "128369",
    "end": "133440"
  },
  {
    "text": "what Alice can actually access Alice can look at her data she can't look at Bob's data as we've taken this expectation of",
    "start": "133440",
    "end": "139890"
  },
  {
    "text": "behavior and we've turned it into an enforcement of behavior this is what it means to be zero trust to be trustless",
    "start": "139890",
    "end": "146040"
  },
  {
    "text": "to remove this expectation of behavior but we haven't removed trust completely we've sort of just displaced it we've",
    "start": "146040",
    "end": "153540"
  },
  {
    "text": "taken the trust that we had an Allison we've moved it to these components the identity provider in the policy engine",
    "start": "153540",
    "end": "158990"
  },
  {
    "text": "but why don't we trust those components where does that trust come from well we",
    "start": "158990",
    "end": "164310"
  },
  {
    "text": "had a developer set up the identity provider we had a developer set up the policy engine and the the front-end that",
    "start": "164310",
    "end": "170610"
  },
  {
    "text": "glues these pieces together right takes that identity does authentication takes that policy and",
    "start": "170610",
    "end": "176250"
  },
  {
    "text": "does authorization so ultimately the trust is coming from our organization",
    "start": "176250",
    "end": "181860"
  },
  {
    "text": "and you start to look at this and this whole idea of trustless is kind of just an exercise in us learning to trust",
    "start": "181860",
    "end": "187320"
  },
  {
    "text": "ourselves but that's not the full story right because Trust has to come from somewhere and if we we talked about",
    "start": "187320",
    "end": "194160"
  },
  {
    "text": "earlier trust as an expectation of behavior where is the expectation come from us as developers and who sets that",
    "start": "194160",
    "end": "202020"
  },
  {
    "text": "expectation so when Alice or Bob good",
    "start": "202020",
    "end": "207420"
  },
  {
    "text": "old Bob hit with it when they give us their data when they they set up an order with us they're handing us their",
    "start": "207420",
    "end": "212880"
  },
  {
    "text": "data and they're saying protect this secure my data keep it safe that's the expectation on us as developers that's",
    "start": "212880",
    "end": "219780"
  },
  {
    "text": "where the trust comes from so we talked a lot about building zero trust networks and we think that we're removing trust from the equation but we're not we're",
    "start": "219780",
    "end": "226410"
  },
  {
    "text": "really building trust okay and so how do we get there I want to talk about spiffy",
    "start": "226410",
    "end": "231530"
  },
  {
    "text": "spiffy is the secure production identity framework for everyone and it's a specification that talks about workload",
    "start": "231530",
    "end": "238350"
  },
  {
    "text": "identity when we think about workloads we're not talking about Alice and this front end we're talking beyond the front",
    "start": "238350",
    "end": "244769"
  },
  {
    "text": "end to this myriad of back-end services and how those communicate with each other we want to secure that workload",
    "start": "244769",
    "end": "252570"
  },
  {
    "text": "identity it can be an x.509 certificate it can be a JSON web token for the purpose of this talk I'm really just gonna be talking about x.509 but there's",
    "start": "252570",
    "end": "258900"
  },
  {
    "text": "sort of interchangeable in some sense spiffy introduces these trusted components the idea of a trust domain",
    "start": "258900",
    "end": "266520"
  },
  {
    "text": "and a trusted authority at the root of that domain and if you have workloads that are kind of loosely coupled inside",
    "start": "266520",
    "end": "272430"
  },
  {
    "text": "the stress domain in organization a and they want to talk with workloads and organized organization be spiffy",
    "start": "272430",
    "end": "279330"
  },
  {
    "text": "introduces this concept of Federation to solve this problem that's been traditionally and historically very hard",
    "start": "279330",
    "end": "284460"
  },
  {
    "text": "to solve so a specification is nice and implementation is nicer",
    "start": "284460",
    "end": "289680"
  },
  {
    "text": "that's where spire comes into play spires the spiffy runtime environment first and foremost what spires trying to",
    "start": "289680",
    "end": "296160"
  },
  {
    "text": "do is solve this problem of bootstrap of trust we saw in the in the earlier slide trust comes from your organization and",
    "start": "296160",
    "end": "302909"
  },
  {
    "text": "you want to allow that to permeate into all the components in your system so what spire does is it allows that trust",
    "start": "302909",
    "end": "308759"
  },
  {
    "text": "to permeate into your infrastructure it needs to be portable needs to be cloud native it needs to run on the",
    "start": "308759",
    "end": "314340"
  },
  {
    "text": "public cloud private cloud bring your own hardware anything and we'll talk about what that looks like in a minute is to be reliable performant observable",
    "start": "314340",
    "end": "323000"
  },
  {
    "text": "identity and authentication to me needs to be built into the very foundation of your infrastructure it's a it's a core",
    "start": "323000",
    "end": "329069"
  },
  {
    "text": "component like like routing or persistent storage because of that needs to be really really available and when",
    "start": "329069",
    "end": "335250"
  },
  {
    "text": "something goes wrong we need to know about it that's the the essence of observability we need to have the tools to fix those problem at problems in",
    "start": "335250",
    "end": "341250"
  },
  {
    "text": "recover effectively lastly but most importantly this thing needs to be secure but not at the expense of",
    "start": "341250",
    "end": "348240"
  },
  {
    "text": "usability developers so often want to do the right thing when it comes to security and they don't know how we",
    "start": "348240",
    "end": "354630"
  },
  {
    "text": "should make that easy for them so what I'm gonna talk about today is a little",
    "start": "354630",
    "end": "359819"
  },
  {
    "text": "bit of a high level architecture of spire in case you're unfamiliar the essence of short-lived credentials which",
    "start": "359819",
    "end": "365130"
  },
  {
    "text": "sort of formed the base level of security for all of spire and then the various components the agent the server",
    "start": "365130",
    "end": "370469"
  },
  {
    "text": "and what registrations are all about so for the purposes of this diagram we can",
    "start": "370469",
    "end": "376380"
  },
  {
    "text": "assume we have a multi-tenant system we have a host call it let's call it host X with workloads a B and C and so these",
    "start": "376380",
    "end": "382830"
  },
  {
    "text": "workloads are heterogeneous they're you know oftentimes unrelated and the way",
    "start": "382830",
    "end": "388500"
  },
  {
    "text": "that we that these workloads interact with spire is through an agent that lives on this host and so you can",
    "start": "388500",
    "end": "395849"
  },
  {
    "text": "imagine we have many hosts host X host Y with a spire agent located on on each",
    "start": "395849",
    "end": "401289"
  },
  {
    "text": "one of those hosts and so the the agent kind of acts as this data plane of the",
    "start": "401289",
    "end": "407529"
  },
  {
    "text": "of the ecosystem and it's a forwarding policy information from the control",
    "start": "407529",
    "end": "412629"
  },
  {
    "text": "plane which is the spire server so ultimately spire server is the root of",
    "start": "412629",
    "end": "418150"
  },
  {
    "text": "trust in our system and it's what allows delegation of trust into these agents so",
    "start": "418150",
    "end": "423999"
  },
  {
    "text": "spire it needs to serve some part or some policy information it does that in a database it needs to get policy",
    "start": "423999",
    "end": "429069"
  },
  {
    "text": "information and it does that through this component called a registrant and that thing writes the this policy",
    "start": "429069",
    "end": "435099"
  },
  {
    "text": "information and if you're not familiar as you can see workload a we want to run",
    "start": "435099",
    "end": "440439"
  },
  {
    "text": "on host X but we don't want workload a to run on host why we need this policy this this thing that tells us exactly",
    "start": "440439",
    "end": "446229"
  },
  {
    "text": "where a workload can run because you can imagine if you have a secure group of hosts and you want to run secure",
    "start": "446229",
    "end": "451330"
  },
  {
    "text": "workloads on that host you need to be very specific about what should run where and so this component this",
    "start": "451330",
    "end": "456759"
  },
  {
    "text": "registrant is very coupled to your scheduler if you have kubernetes api server causing these workloads to to",
    "start": "456759",
    "end": "463750"
  },
  {
    "text": "come up you need a direct integration there and so that's why this registrant is it's been a more it's not a core",
    "start": "463750",
    "end": "470259"
  },
  {
    "text": "really component of spire because it's so coupled to the scheduler ok so before",
    "start": "470259",
    "end": "476800"
  },
  {
    "text": "I dig into these components a little bit it's important to get a little bit of background on short-lived credentials that we use in spire the big question",
    "start": "476800",
    "end": "483909"
  },
  {
    "text": "everyone has is why you use short-lived credentials why don't you have a good revocation strategy and spoiler alert",
    "start": "483909",
    "end": "490509"
  },
  {
    "text": "revocation is a very hard problem there's a little bit of background on revocation strategies that have been",
    "start": "490509",
    "end": "496180"
  },
  {
    "text": "used historically there's this thing called a crl certificate revocation list I receive a certificate and I want to",
    "start": "496180",
    "end": "501819"
  },
  {
    "text": "know is it valid I consult with my CRL have some problems the list doesn't",
    "start": "501819",
    "end": "507339"
  },
  {
    "text": "really scale that well there's problems with stale data implementation difficulty of this thing so there were",
    "start": "507339",
    "end": "514029"
  },
  {
    "text": "some improvements the online certificate status protocol instead of consulting with a list I actually talked to a",
    "start": "514029",
    "end": "519729"
  },
  {
    "text": "service the OCSP responder and I say hey is this x.509 certificate still good",
    "start": "519729",
    "end": "526089"
  },
  {
    "text": "this has a lot of the same problems what do you do if that servers down the implementations outside of browser",
    "start": "526089",
    "end": "531699"
  },
  {
    "text": "software the imitations are actually not that great and so when we're thinking about using",
    "start": "531699",
    "end": "537670"
  },
  {
    "text": "revocation in back-end services we don't have the same of implementations from browsers we have you know x.509",
    "start": "537670",
    "end": "543520"
  },
  {
    "text": "implementations in in every language Under the Sun and we to think about that that's why there is a third method of",
    "start": "543520",
    "end": "549100"
  },
  {
    "text": "revocation that is sort of implicit revocation every certificate has a finite lifetime a beginning date and an",
    "start": "549100",
    "end": "555220"
  },
  {
    "text": "end date when you pass that end date the certificate expires and what's really",
    "start": "555220",
    "end": "561280"
  },
  {
    "text": "nice about this approach is when I receive an x.509 certificate all I need really I don't need a list or a service",
    "start": "561280",
    "end": "567010"
  },
  {
    "text": "the only thing I really need is a somewhat accurate clock that's a powerful construct but with the old",
    "start": "567010",
    "end": "573130"
  },
  {
    "text": "methods of revocation you might have these certificates that last years or months and we need to rethink that if we",
    "start": "573130",
    "end": "579820"
  },
  {
    "text": "want to be able to revoke quickly and this is the essence of what it means to have short-lived credentials these are credentials that only you know instead",
    "start": "579820",
    "end": "585970"
  },
  {
    "text": "of years or months it's weeks days hours okay and because",
    "start": "585970",
    "end": "591100"
  },
  {
    "text": "they're turning over so quickly we have this implicit revocation that's always happening and so further if you look at",
    "start": "591100",
    "end": "599140"
  },
  {
    "text": "x.509 implementations across the board this is not hard to get right you're",
    "start": "599140",
    "end": "604210"
  },
  {
    "text": "just checking you know against a a specific point in time and so revocation becomes really really reliable but one",
    "start": "604210",
    "end": "610900"
  },
  {
    "text": "of the problems is that rotations still hard so if you've ever used a server that implements TLS you've seen",
    "start": "610900",
    "end": "617380"
  },
  {
    "text": "configuration that looks like this you have to provide a certificate and a key from a file and when you have long-lived",
    "start": "617380",
    "end": "623740"
  },
  {
    "text": "certificates this is kind of fine right you know once a year you go in and you update this file it's not the greatest",
    "start": "623740",
    "end": "629680"
  },
  {
    "text": "solution but you know you don't have to do it that often so why do you care about automating it when you have",
    "start": "629680",
    "end": "635290"
  },
  {
    "text": "short-lived credentials you actually have to address rotation as a first-class concern and actually what",
    "start": "635290",
    "end": "640420"
  },
  {
    "text": "that does is it makes your rotation a lot more reliable so how does rotation",
    "start": "640420",
    "end": "646630"
  },
  {
    "text": "actually happen so one of the parts of the safety standard is this thing called the spiffy workload API instead of",
    "start": "646630",
    "end": "653170"
  },
  {
    "text": "reading your credentials from a file you make a G RPC call to a local agent and",
    "start": "653170",
    "end": "658270"
  },
  {
    "text": "that agent gives you credentials and uses a push model to continually update you every time that that credential is",
    "start": "658270",
    "end": "664540"
  },
  {
    "text": "rotated and so this this is part of what I'm talking about in terms of solving",
    "start": "664540",
    "end": "669730"
  },
  {
    "text": "rotation as a first-class citizen but a file read is so reliable right I mean if",
    "start": "669730",
    "end": "676030"
  },
  {
    "text": "the file is there you get it and we want this API to be just as reliable so file",
    "start": "676030",
    "end": "682270"
  },
  {
    "text": "reads so how do we achieve that aspire agent does is optimistic credential",
    "start": "682270",
    "end": "687730"
  },
  {
    "text": "fetching we talked earlier about how workloads need to be in a way assigned to certain hosts and so spire server",
    "start": "687730",
    "end": "695950"
  },
  {
    "text": "knows this policy it knows every workload that could conceivably run on a host and so the agent does this",
    "start": "695950",
    "end": "702220"
  },
  {
    "text": "optimistic fetching and by the time the workload starts on that host it already has that thing cached locally and so the",
    "start": "702220",
    "end": "707590"
  },
  {
    "text": "workload hits this workload API and the response is very fast that's one of the benefits of this model of using a",
    "start": "707590",
    "end": "712900"
  },
  {
    "text": "control plane and then a data plane that forwards a lot of this information is you have this agent that can provide",
    "start": "712900",
    "end": "718930"
  },
  {
    "text": "really really fast and snappy responses another cool kind of consequence of this",
    "start": "718930",
    "end": "726940"
  },
  {
    "text": "is that you've actually decoupled the traffic between the workload and the agent and the agent and the server so",
    "start": "726940",
    "end": "733510"
  },
  {
    "text": "you can scale them independently all right so you can have a hundred calls",
    "start": "733510",
    "end": "738670"
  },
  {
    "text": "from workloads to the agent and then it doesn't at all impact the agents",
    "start": "738670",
    "end": "743680"
  },
  {
    "text": "upstream calls to the server the request cycles are disjoint and so as the number of workloads on a single host scales up",
    "start": "743680",
    "end": "751410"
  },
  {
    "text": "it actually doesn't the server doesn't feel that load at all it says this is really important for a capacity planning",
    "start": "751410",
    "end": "757960"
  },
  {
    "text": "as you start to scale up the number of workloads in your fleet so doing this",
    "start": "757960",
    "end": "764470"
  },
  {
    "text": "kind of caching obviously you run into the the age-old problem of consistency versus availability when the agent can",
    "start": "764470",
    "end": "769690"
  },
  {
    "text": "no longer contact the server what do you do do you serve state potentially stale data or do you sacrifice being available",
    "start": "769690",
    "end": "776380"
  },
  {
    "text": "again we talked about this we want to be very very available we want snappy responses we have to decide to serve",
    "start": "776380",
    "end": "782740"
  },
  {
    "text": "stale data and because the the nature of these x.509 they're not rotating super",
    "start": "782740",
    "end": "789280"
  },
  {
    "text": "often so this is this is actually not very problematic unless the length of",
    "start": "789280",
    "end": "794440"
  },
  {
    "text": "unavailability gets to such a point that your certificates expire and so we'll talk about some strategies",
    "start": "794440",
    "end": "800200"
  },
  {
    "text": "that we use to address that one so on the server side the service providing",
    "start": "800200",
    "end": "806890"
  },
  {
    "text": "agent authentication we call this inspire parlance this is note attestation what this does for us is a",
    "start": "806890",
    "end": "814780"
  },
  {
    "text": "bit of platform translation so we talked earlier about needing to be platform",
    "start": "814780",
    "end": "819880"
  },
  {
    "text": "agnostic but the way you get there is by taking some platform specific data like",
    "start": "819880",
    "end": "825040"
  },
  {
    "text": "an AWS instance identity token or GCP instance identity token or document",
    "start": "825040",
    "end": "830620"
  },
  {
    "text": "however it may be or if you have a you know if you're running your own hardware and you have TPMS trusted platform",
    "start": "830620",
    "end": "836260"
  },
  {
    "text": "modules you can use an endorsement certificate to translate into this very spire specific document which is an",
    "start": "836260",
    "end": "843970"
  },
  {
    "text": "x.509 and so we do this platform translation and then the rest of spire is totally agnostic to this platform and",
    "start": "843970",
    "end": "850810"
  },
  {
    "text": "this this system is actually fairly pluggable so we're talking earlier about being portable this is what gives us",
    "start": "850810",
    "end": "857620"
  },
  {
    "text": "that portability is taking this very platform specific thing converting it into something spot from agnostic so",
    "start": "857620",
    "end": "863800"
  },
  {
    "text": "that the rest of the system can run anywhere so the the main purpose of the",
    "start": "863800",
    "end": "869980"
  },
  {
    "text": "server then is to issue these certificates to agents and workloads one",
    "start": "869980",
    "end": "877270"
  },
  {
    "text": "of the things to note is that as the number of agents and workloads scales up",
    "start": "877270",
    "end": "883330"
  },
  {
    "text": "obviously the amount of work that the servers are doing scales up as well signing operations do tend to get pretty",
    "start": "883330",
    "end": "889870"
  },
  {
    "text": "heavy but because this is CPU intensive work it's actually fairly trivial to parallelize but more than that there's",
    "start": "889870",
    "end": "896470"
  },
  {
    "text": "another knob that we can tune which is the certificates lifetime right if a",
    "start": "896470",
    "end": "902200"
  },
  {
    "text": "certificate only lives for a couple of minutes the server's doing a bunch of work right it's constantly signing and",
    "start": "902200",
    "end": "907570"
  },
  {
    "text": "actually as you begin to elongate that certificate lifetime the amount of work that the server has to do sort of is its",
    "start": "907570",
    "end": "914890"
  },
  {
    "text": "Tunes down a bit so some cool knobs that we can turn turn there as users to kind",
    "start": "914890",
    "end": "921340"
  },
  {
    "text": "of address that scaling problem and beyond that the server is managing this",
    "start": "921340",
    "end": "927780"
  },
  {
    "text": "agent and workload policy the which work loads can run on",
    "start": "927780",
    "end": "932940"
  },
  {
    "text": "and the way that happens is through this process called registration so backing up a bit we talked earlier about how in",
    "start": "932940",
    "end": "938310"
  },
  {
    "text": "kubernetes you have a scheduler cause a workload to to come out to boot right",
    "start": "938310",
    "end": "943680"
  },
  {
    "text": "and so somehow spire needs to be made aware of this placement decision so you",
    "start": "943680",
    "end": "950010"
  },
  {
    "text": "need some kind of integration to allow this to happen so we have this thing in",
    "start": "950010",
    "end": "955440"
  },
  {
    "text": "the open source called the kubernetes registrar that actually does this kind of integration so we get a really tight",
    "start": "955440",
    "end": "962010"
  },
  {
    "text": "integration with kubernetes out of the box but one of the problems here is as",
    "start": "962010",
    "end": "967950"
  },
  {
    "text": "you might notice is in order for a workload to get its identity it first",
    "start": "967950",
    "end": "973020"
  },
  {
    "text": "needs to be registered with spire this process can be kind of racy in terms of you know if the workload coming up",
    "start": "973020",
    "end": "979260"
  },
  {
    "text": "before the registration actually propagates through the system we got to be aware of that thing but not only that",
    "start": "979260",
    "end": "985080"
  },
  {
    "text": "the registrant the registrant is now a bottleneck for workload boot that's a",
    "start": "985080",
    "end": "990540"
  },
  {
    "text": "little bit of a problem from a reliability perspective because now you have this extra component that that",
    "start": "990540",
    "end": "995550"
  },
  {
    "text": "needs to always be up in order for we're close to launch so want to talk a little bit about the thought process from users",
    "start": "995550",
    "end": "1001820"
  },
  {
    "text": "perspective of how you scale these registrations and avoid bottlenecks a lot of what we've been talking about so",
    "start": "1001820",
    "end": "1007700"
  },
  {
    "text": "far has been this idea of per host registrations you have host X and you want to run workload a B and C that",
    "start": "1007700",
    "end": "1017209"
  },
  {
    "text": "means when you launch workload a you need to wait for that registration to propagate through your system and beyond",
    "start": "1017209",
    "end": "1022610"
  },
  {
    "text": "that registrations are going to scale with the number of workload instances that you have so if you have a kind of a disaster event where you need to reboot",
    "start": "1022610",
    "end": "1028850"
  },
  {
    "text": "all of your workloads you might run into a bottleneck here and so this idea of",
    "start": "1028850",
    "end": "1034730"
  },
  {
    "text": "per cluster registrations has sort of come about which is that you register a",
    "start": "1034730",
    "end": "1039770"
  },
  {
    "text": "workload against an alias of clusters and then you only need to do one registration this is really nice because",
    "start": "1039770",
    "end": "1044890"
  },
  {
    "text": "once that cluster registration happens you know you're not really blocked on on",
    "start": "1044890",
    "end": "1050420"
  },
  {
    "text": "this registrant being up so it gives you kind of a two-pronged benefit the the main kind of difference between these",
    "start": "1050420",
    "end": "1056480"
  },
  {
    "text": "two approaches in terms of security is is really about limiting blast radius if",
    "start": "1056480",
    "end": "1062780"
  },
  {
    "text": "you only have workloads they're allowed to run on one host and that host is compromised it's just the credentials on that host",
    "start": "1062780",
    "end": "1067930"
  },
  {
    "text": "being compromised but if you have you know many many workloads running on a little bit of a larger cluster and one",
    "start": "1067930",
    "end": "1073990"
  },
  {
    "text": "of those hosts is compromised kind of in a way all of that entire cluster is compromised so you really got to think",
    "start": "1073990",
    "end": "1080140"
  },
  {
    "text": "about what do you need from a business perspective is it okay what's what's",
    "start": "1080140",
    "end": "1085510"
  },
  {
    "text": "your threat model if it's okay to to think about these concerns maybe in some",
    "start": "1085510",
    "end": "1090670"
  },
  {
    "text": "cases you really do need that really tightness of policy and sometimes maybe",
    "start": "1090670",
    "end": "1095860"
  },
  {
    "text": "you don't so this is a really important knob that spire allows its users to tune",
    "start": "1095860",
    "end": "1101140"
  },
  {
    "text": "and because it's an important decision and we can't necessarily be opinionated about how people do registrations one",
    "start": "1101140",
    "end": "1108310"
  },
  {
    "text": "thing I'll allude to earlier was this idea of a certificates TTL time to live it's their lifetime the distance between",
    "start": "1108310",
    "end": "1114450"
  },
  {
    "text": "the beginning and end time on the certificate so one thing to note is that",
    "start": "1114450",
    "end": "1121900"
  },
  {
    "text": "a low TTL means that you're revoking very quickly you can imagine if you have a certificate with a one hour time to",
    "start": "1121900",
    "end": "1128890"
  },
  {
    "text": "live and you accidentally log that as part of your logging infrastructure it's",
    "start": "1128890",
    "end": "1135790"
  },
  {
    "text": "kind of okay in a way because within an hour that certificates no longer useful but if your TTL on your certificate is a",
    "start": "1135790",
    "end": "1142690"
  },
  {
    "text": "day and you're accidentally log it you know now you have to wait a full day while that certificate is potentially",
    "start": "1142690",
    "end": "1148270"
  },
  {
    "text": "out there being used and so a lower TTL means these things are constantly turning over and constantly being",
    "start": "1148270",
    "end": "1154060"
  },
  {
    "text": "revoked and it in a way reduces the risk of compromise but there's a but an hour",
    "start": "1154060",
    "end": "1162160"
  },
  {
    "text": "TTL means you have a one hour maximum time to recovery if your control plane",
    "start": "1162160",
    "end": "1167380"
  },
  {
    "text": "if your spire server goes down and it can no longer rotate these certificates",
    "start": "1167380",
    "end": "1172480"
  },
  {
    "text": "a clock starts ticking and you have about an hour to fix that outage before",
    "start": "1172480",
    "end": "1178090"
  },
  {
    "text": "kind of the whole system in a way breaks and you have to reboot strap all of your trusts it's uh it's not a good place to",
    "start": "1178090",
    "end": "1186790"
  },
  {
    "text": "be in so we sort of have to balance this you know if you have 24 hours to fix an",
    "start": "1186790",
    "end": "1191860"
  },
  {
    "text": "outage maybe that's a little bit more reasonable but you know you have this security trade-off so this isn't",
    "start": "1191860",
    "end": "1198010"
  },
  {
    "text": "something that necess Spira can make the decision for the users again it's a business decision you",
    "start": "1198010",
    "end": "1203020"
  },
  {
    "text": "have to understand what your threat model is and and make a security decision so a couple of takeaways here",
    "start": "1203020",
    "end": "1210760"
  },
  {
    "text": "because I do want to leave a good amount of time for questions caching is kind of the secret sauce of",
    "start": "1210760",
    "end": "1216250"
  },
  {
    "text": "distributed systems but you got to use it tastefully you can't you can't overdo it I think horizontally I think we're",
    "start": "1216250",
    "end": "1223810"
  },
  {
    "text": "starting to see some users in the community as they've started to scale up these things we're starting to see some of the pain points of having these like",
    "start": "1223810",
    "end": "1230260"
  },
  {
    "text": "multi thousand node deployments in terms of how the server reacts that kind of",
    "start": "1230260",
    "end": "1236440"
  },
  {
    "text": "load some trade-offs as we talked about the TTL on certificates and the",
    "start": "1236440",
    "end": "1242140"
  },
  {
    "text": "registration policy how course we want that to be should be tunable right these important decisions that as a project we",
    "start": "1242140",
    "end": "1249520"
  },
  {
    "text": "can't necessarily make that decision for our users you should leave those important decisions to the users within reason and",
    "start": "1249520",
    "end": "1257860"
  },
  {
    "text": "finally you know if you're interested in doing this kind of thing you know come set up a POC join us on slack I'm always",
    "start": "1257860",
    "end": "1264130"
  },
  {
    "text": "on slack super available so happy to answer any questions I'd be remiss if I also didn't mention that my team of you",
    "start": "1264130",
    "end": "1270820"
  },
  {
    "text": "retiring so if you're interested in working on this stuff come and talk to me and thank you very much",
    "start": "1270820",
    "end": "1276430"
  },
  {
    "text": "[Applause]",
    "start": "1276430",
    "end": "1279589"
  },
  {
    "text": "so we got about 10 minutes for questions I don't think that I have an extra",
    "start": "1281660",
    "end": "1287190"
  },
  {
    "text": "microphone but I can do my best to kind of run that around I know it's got questions I thanks for presentation",
    "start": "1287190",
    "end": "1304110"
  },
  {
    "text": "quick question you guys considering using our CSP or OCS beast a plane for",
    "start": "1304110",
    "end": "1312060"
  },
  {
    "text": "revocation yeah so this is one of the things that eluded to a little bit",
    "start": "1312060",
    "end": "1317340"
  },
  {
    "text": "earlier on is that OCSP while it is used actually pretty prevalently in web",
    "start": "1317340",
    "end": "1324270"
  },
  {
    "text": "browsers the implementations on the back end server side are actually kind of fuzzy at best it's hard to get right and",
    "start": "1324270",
    "end": "1331680"
  },
  {
    "text": "so a lot of implementations don't do it correctly and the other problem is that when the OCSP responder is down a lot of",
    "start": "1331680",
    "end": "1338790"
  },
  {
    "text": "these implementations fail open and they say oh I couldn't get the couldn't get the thing I guess certificate looks okay",
    "start": "1338790",
    "end": "1344940"
  },
  {
    "text": "to me and a lot of times that's the exact time that you need that you know and so yeah",
    "start": "1344940",
    "end": "1350940"
  },
  {
    "text": "it's it's I think it was probably considered in in the early days in the spiffy spec but ultimately the sort of",
    "start": "1350940",
    "end": "1357290"
  },
  {
    "text": "implicit revocation of short-lived certificates is the easiest to get right",
    "start": "1357290",
    "end": "1363680"
  },
  {
    "text": "yeah so the response here was that OCSP stapling which instead of talking to an",
    "start": "1372220",
    "end": "1378560"
  },
  {
    "text": "OC SB responder in line with with your validation you actually have your server",
    "start": "1378560",
    "end": "1384170"
  },
  {
    "text": "who's presenting the certificate talked to the OCSP server and and grab a",
    "start": "1384170",
    "end": "1390830"
  },
  {
    "text": "response a signed response from that OCSP responder and then send it in line with the certificate this has a couple",
    "start": "1390830",
    "end": "1396830"
  },
  {
    "text": "other problems in the implementation what do you do if that stapled response isn't there again a lot of times they fail open sometimes it's not even",
    "start": "1396830",
    "end": "1403340"
  },
  {
    "text": "implemented at all correctly in certain languages and again on the server side",
    "start": "1403340",
    "end": "1408410"
  },
  {
    "text": "you have to decide what to do if you can't get assigned OCSP response to",
    "start": "1408410",
    "end": "1413570"
  },
  {
    "text": "staple so there's a lot of failure modes there and it's just this idea of adding that extra component into into your",
    "start": "1413570",
    "end": "1420110"
  },
  {
    "text": "trust model necessarily complicates the reliability story down in front here hi",
    "start": "1420110",
    "end": "1430310"
  },
  {
    "text": "I was reading the installation instructions this morning and saw you mentioned the example of getting an AWS",
    "start": "1430310",
    "end": "1436730"
  },
  {
    "text": "say the identity document from the metadata server I hope you can maybe",
    "start": "1436730",
    "end": "1442400"
  },
  {
    "text": "explain the threat model more does it matter if if any other say pod or",
    "start": "1442400",
    "end": "1448460"
  },
  {
    "text": "program running on that machine could also access the identity document does it matter who it's a great question",
    "start": "1448460",
    "end": "1454820"
  },
  {
    "text": "that's a great question so the thing about AWS identity documents and same",
    "start": "1454820",
    "end": "1461150"
  },
  {
    "text": "with GCP is that you retrieve that document by essentially doing a curl in",
    "start": "1461150",
    "end": "1468500"
  },
  {
    "text": "HTTP request to the local system in the cloud and so potentially anything with",
    "start": "1468500",
    "end": "1474410"
  },
  {
    "text": "access to the host network can retrieve this instance identity document that you're trading in for this very trusted",
    "start": "1474410",
    "end": "1480830"
  },
  {
    "text": "credential and so the model with spire is a trust on first use for the agent",
    "start": "1480830",
    "end": "1486740"
  },
  {
    "text": "and so we assume that the agents like are kind of the first thing coming up in your system we only allow them to attest",
    "start": "1486740",
    "end": "1493190"
  },
  {
    "text": "once and so I don't know Evan is there anything else you want to mention on",
    "start": "1493190",
    "end": "1498500"
  },
  {
    "text": "this yeah trust on first use is kind of like the primary mitigation for the",
    "start": "1498500",
    "end": "1504620"
  },
  {
    "text": "concern you're talking about I think the the flipside is of course it's a race and of course it can be lost",
    "start": "1504620",
    "end": "1510649"
  },
  {
    "text": "and in that event because it's trust on first use that the legitimate agent will fail to come up and you can page on that",
    "start": "1510649",
    "end": "1517070"
  },
  {
    "text": "kind of a thing so at the very least is certainly detectable that's that's that's about as far as we can go from",
    "start": "1517070",
    "end": "1523220"
  },
  {
    "text": "like the spire implementation and mitigating that that kind of a problem there there of course other mitigations you can put in place as a user like",
    "start": "1523220",
    "end": "1529399"
  },
  {
    "text": "iptables rules and things like this that can like limit access to those but like from the project's perspective we can't",
    "start": "1529399",
    "end": "1537019"
  },
  {
    "text": "really expect that all users will do that and so we take as many steps as possible to kind of mitigate this replay",
    "start": "1537019",
    "end": "1542720"
  },
  {
    "text": "this show so the question was does a",
    "start": "1542720",
    "end": "1548720"
  },
  {
    "text": "survivor reboot it can the agent can be configured to persist it like the result",
    "start": "1548720",
    "end": "1554570"
  },
  {
    "text": "of that whole process of validating this identity document is and next I have an",
    "start": "1554570",
    "end": "1559700"
  },
  {
    "text": "identity issued to the agent so the agent can be configured to persist that key and that certificate and RAM or on",
    "start": "1559700",
    "end": "1565880"
  },
  {
    "text": "desk or against the TPM or something like this if need be so it can be it can survive reboot if configured",
    "start": "1565880",
    "end": "1572840"
  },
  {
    "text": "appropriately thanks happen yeah this is",
    "start": "1572840",
    "end": "1580850"
  },
  {
    "text": "maybe a poll to you but also the rest of the audience in the wild what's the kind",
    "start": "1580850",
    "end": "1586460"
  },
  {
    "text": "of bare minimum that you've seen for that certificate expiry time if you're really interested in keeping that down",
    "start": "1586460",
    "end": "1592340"
  },
  {
    "text": "to a tight loop you've got very very um you've got a network you don't trust at all and you want to keep that as small",
    "start": "1592340",
    "end": "1599179"
  },
  {
    "text": "as possible what's what's the smallest realistic window you've seen work cool",
    "start": "1599179",
    "end": "1604880"
  },
  {
    "text": "so I think spire the default TT on these certificates is an hour if I'm not",
    "start": "1604880",
    "end": "1611450"
  },
  {
    "text": "mistaken we've seen people in the community using weeks I personally I",
    "start": "1611450",
    "end": "1617240"
  },
  {
    "text": "would think something like in the realm of hours you know inside of a day is a",
    "start": "1617240",
    "end": "1623779"
  },
  {
    "text": "pretty decent policy but you know it's it's a bit up to you know someone like",
    "start": "1623779",
    "end": "1629870"
  },
  {
    "text": "your compliance team who's saying like hey we need to be able to revoke a certificate within X hours right and so",
    "start": "1629870",
    "end": "1635090"
  },
  {
    "text": "that becomes a little bit of the upper bound on on what you can tolerate",
    "start": "1635090",
    "end": "1640539"
  },
  {
    "text": "yeah so a question was is it reasonable to expect 10 minutes I think do you know",
    "start": "1643150",
    "end": "1649400"
  },
  {
    "text": "if people are using but certainly there",
    "start": "1649400",
    "end": "1654560"
  },
  {
    "text": "are implications that Tyler alluded to for example like that that becomes like the minimum time that you can withstand",
    "start": "1654560",
    "end": "1660500"
  },
  {
    "text": "an agent being down for example if it can't get that rotation then it it has to figure out how to like reboot strap",
    "start": "1660500",
    "end": "1666290"
  },
  {
    "text": "trust into the system inspire itself like we have integration tests that run with like really low TTLs you were",
    "start": "1666290",
    "end": "1671960"
  },
  {
    "text": "talking like 15 seconds or 10 seconds you know and that like spire can handle",
    "start": "1671960",
    "end": "1677150"
  },
  {
    "text": "that low of a TTL but yeah your your room for failure your tolerance for downtime it's really low at that point",
    "start": "1677150",
    "end": "1683660"
  },
  {
    "text": "so yeah I think it had you want to go with it as high as a TTL is reasonable",
    "start": "1683660",
    "end": "1689680"
  },
  {
    "text": "in terms of like downtime tolerance but you know as low as you as you can go in",
    "start": "1689680",
    "end": "1695240"
  },
  {
    "text": "terms of like revocation you know mitigation so cool I'm gonna go back",
    "start": "1695240",
    "end": "1704540"
  },
  {
    "text": "here won't come back the auto scaling",
    "start": "1704540",
    "end": "1709820"
  },
  {
    "text": "descaling so you mention about the Devore chord that should be a policy in spire to define which what Road",
    "start": "1709820",
    "end": "1715280"
  },
  {
    "text": "department what if you are on a scale of D scale all the time or you guys Andalite yes okay so the the question",
    "start": "1715280",
    "end": "1723560"
  },
  {
    "text": "primarily is around how do you deal with auto scaling and down scaling let me",
    "start": "1723560",
    "end": "1731780"
  },
  {
    "text": "think about that a little have you have any experience with people doing auto scaling okay",
    "start": "1731780",
    "end": "1742080"
  },
  {
    "text": "yeah so I'm guessing using some kind of like a note selector pattern here where",
    "start": "1742080",
    "end": "1747369"
  },
  {
    "text": "you're registering against like a cluster or a group of hosts and so as those hosts are sort of Auto scaled to",
    "start": "1747369",
    "end": "1754629"
  },
  {
    "text": "come up you actually have this registration against that group of foes so as long as the the host is coming up inside this group that you've already",
    "start": "1754629",
    "end": "1760989"
  },
  {
    "text": "created a registration for you actually don't really need any kind of interaction with the spire from a",
    "start": "1760989",
    "end": "1768009"
  },
  {
    "text": "registration perspective because the spire agent comes up on that server it kind of queries the spire server says",
    "start": "1768009",
    "end": "1773469"
  },
  {
    "text": "hey what workloads don't need to know about and has those identities available great question not so much a conceptual",
    "start": "1773469",
    "end": "1785769"
  },
  {
    "text": "question is implementation but I saw also that workload is intended to communicate with the agents over domain",
    "start": "1785769",
    "end": "1793089"
  },
  {
    "text": "sockets mounting a host path it's common to have pod security policies that won't",
    "start": "1793089",
    "end": "1798279"
  },
  {
    "text": "allow mounting of hosts paths so do you recommend white listing that path or what is there an alternate choice for",
    "start": "1798279",
    "end": "1804969"
  },
  {
    "text": "the workload talking to the agent yeah",
    "start": "1804969",
    "end": "1811869"
  },
  {
    "text": "the host path we've heard this a little bit now and the host path is kind of the",
    "start": "1811869",
    "end": "1816999"
  },
  {
    "text": "route that most people are taking there's not really a good alternative at the moment we've discussed the",
    "start": "1816999",
    "end": "1822849"
  },
  {
    "text": "possibility of opening like a management API on the agent which would allow you to build like a flex flow and plugin or",
    "start": "1822849",
    "end": "1829059"
  },
  {
    "text": "some similar integration that can poke the agent and say hey I'm turning this thing on create a new socket over here",
    "start": "1829059",
    "end": "1834399"
  },
  {
    "text": "baby here are the properties to kind of work around what you're describing it's not there today but it's kind of on the",
    "start": "1834399",
    "end": "1840580"
  },
  {
    "text": "table and maybe we'll look at it soon but you're certainly not there first to ask that question cool any other",
    "start": "1840580",
    "end": "1849639"
  },
  {
    "text": "questions",
    "start": "1849639",
    "end": "1852089"
  },
  {
    "text": "great talk Tyler so we talked a little bit about TTS for workload certificates",
    "start": "1854799",
    "end": "1861999"
  },
  {
    "text": "can you talk a little bit about what would happen if your zonal or regional CA that probably has a longer TTL is",
    "start": "1861999",
    "end": "1868960"
  },
  {
    "text": "compromised and how you might rotate that good question so when you're when you're",
    "start": "1868960",
    "end": "1878660"
  },
  {
    "text": "kind of like upstream CA or your spire CA so this speaks to a little bit to the",
    "start": "1878660",
    "end": "1884750"
  },
  {
    "text": "strategy of what is your root of trust in spire there's a couple of different strategies you can have spire create its",
    "start": "1884750",
    "end": "1890750"
  },
  {
    "text": "own key self sign it you can also refer to another spire server and which is",
    "start": "1890750",
    "end": "1896330"
  },
  {
    "text": "called nested spire to allow these things to sort of form a tree but you",
    "start": "1896330",
    "end": "1902360"
  },
  {
    "text": "could also just use a key pair that you provision yourself and so what do you do",
    "start": "1902360",
    "end": "1907640"
  },
  {
    "text": "if that thing is compromised it's pretty difficult right now I think we're planning to spend a lot of time on",
    "start": "1907640",
    "end": "1914390"
  },
  {
    "text": "revocation coming up on the middle of next year of 2020 there are some",
    "start": "1914390",
    "end": "1920840"
  },
  {
    "text": "strategies right now you essentially you know have the new key to your trust bundle and then rotate out the old one",
    "start": "1920840",
    "end": "1927700"
  },
  {
    "text": "but yeah rotating a root key is much more difficult than rotating the work load keys that sort of have this thing",
    "start": "1927700",
    "end": "1933670"
  },
  {
    "text": "this rotation mechanism built in I",
    "start": "1933670",
    "end": "1938080"
  },
  {
    "text": "should have I didn't even think about this but and this might be a question for Evan to what are the implications",
    "start": "1939280",
    "end": "1944600"
  },
  {
    "text": "for Federation and CR ELLs across trusts domains that's a great question",
    "start": "1944600",
    "end": "1954550"
  },
  {
    "text": "so there's not there's not so first of all the workload API it does have support for delivering an x.509 crl to a",
    "start": "1960840",
    "end": "1967960"
  },
  {
    "text": "workload aspire has not implemented implemented x509 crl but the workload",
    "start": "1967960",
    "end": "1974260"
  },
  {
    "text": "api has support for it this Divi Federation API is that we've",
    "start": "1974260",
    "end": "1979270"
  },
  {
    "text": "currently defined don't really have any concept of revocation like to communicating revocation information",
    "start": "1979270",
    "end": "1984910"
  },
  {
    "text": "across that wire right now the the you know the implication of a compromise is",
    "start": "1984910",
    "end": "1991330"
  },
  {
    "text": "usually hey I'm gonna yank this root from the bundle inspire propagates routes as well we can yank a root from",
    "start": "1991330",
    "end": "1998140"
  },
  {
    "text": "the bundle we can propagate that trains pretty rapidly and bring a new key in I think that there's probably a similar",
    "start": "1998140",
    "end": "2003420"
  },
  {
    "text": "story with Federation where you would expect the foreign trust domain which is compromised to nuke whatever keys out of",
    "start": "2003420",
    "end": "2011190"
  },
  {
    "text": "their bundle were affected or chained up to chained down to you know the affected compromised and that would come across",
    "start": "2011190",
    "end": "2018120"
  },
  {
    "text": "that change will come across pretty quickly but from from a you know from a",
    "start": "2018120",
    "end": "2023640"
  },
  {
    "text": "consumer point of view I always have the option to sever that Federation relationship if I think something's",
    "start": "2023640",
    "end": "2029430"
  },
  {
    "text": "screwy is going on on your side as well so I think there's there's a few options that we have it's an area of active",
    "start": "2029430",
    "end": "2036570"
  },
  {
    "text": "exploration how to communicate revocation information across those boundaries cool I think that's about all",
    "start": "2036570",
    "end": "2044160"
  },
  {
    "text": "the time we have if you have any more questions feel free come up and chat afterwards thank you guys so much and",
    "start": "2044160",
    "end": "2049800"
  },
  {
    "text": "enjoy the rest of coupon [Applause]",
    "start": "2049800",
    "end": "2055350"
  }
]