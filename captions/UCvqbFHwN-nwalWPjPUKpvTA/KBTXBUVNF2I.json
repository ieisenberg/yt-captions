[
  {
    "text": "all right so before we get started if you are having issues with like setting",
    "start": "350",
    "end": "7350"
  },
  {
    "text": "up your own cluster or if the conference Wi-Fi is being frustrating please raise",
    "start": "7350",
    "end": "14940"
  },
  {
    "text": "your hand my coworker over here will come along with a GCP account",
    "start": "14940",
    "end": "23900"
  },
  {
    "text": "information and you can use that GCP count to create VMs and run some stuff",
    "start": "23900",
    "end": "29910"
  },
  {
    "text": "in VMs so I'll talk a little bit more about doing that in a bit it's still a",
    "start": "29910",
    "end": "39660"
  },
  {
    "text": "little quiet ok all right so welcome to",
    "start": "39660",
    "end": "52980"
  },
  {
    "text": "zero to operator thank you all for coming today for those of you who don't know me I'm Solly Ross I'm a software",
    "start": "52980",
    "end": "61199"
  },
  {
    "text": "engineer on G ke and a maintainer of cube builder and my mission is to make",
    "start": "61199",
    "end": "66570"
  },
  {
    "text": "writing kubernetes extensions less arcane so before we get started let's",
    "start": "66570",
    "end": "77610"
  },
  {
    "text": "quickly talk about some definitions so to define an operator we have to define",
    "start": "77610",
    "end": "83850"
  },
  {
    "text": "a controller so a controller is a loop that reads desired state observed",
    "start": "83850",
    "end": "91470"
  },
  {
    "text": "cluster state and potentially some external state so things like load",
    "start": "91470",
    "end": "96900"
  },
  {
    "text": "balancers on your cloud for instance and then reconciles the desired state with",
    "start": "96900",
    "end": "102329"
  },
  {
    "text": "the observed cluster States and the observed external state and writes down observations at the end so that other",
    "start": "102329",
    "end": "110759"
  },
  {
    "text": "things can see what we're doing this is a relatively uncontroversial definition all of kubernetes functions on this",
    "start": "110759",
    "end": "117360"
  },
  {
    "text": "model everything from the deployment controller down to the node even the scheduler ok so now that we have that in",
    "start": "117360",
    "end": "126960"
  },
  {
    "text": "place let's define an operator an operator is a controller that has",
    "start": "126960",
    "end": "132540"
  },
  {
    "text": "specific knowledge of an application so for",
    "start": "132540",
    "end": "137640"
  },
  {
    "text": "instance the Prometheus operator knows how to manage Prometheus specifically it",
    "start": "137640",
    "end": "145290"
  },
  {
    "text": "knows how to take a bunch of rules from different namespaces about how to monitor applications bundle them up into",
    "start": "145290",
    "end": "152489"
  },
  {
    "text": "something that actually can be passed to Prometheus itself as configuration and manage some number of Prometheus",
    "start": "152489",
    "end": "159450"
  },
  {
    "text": "instances so all operators are controllers but not all controllers are operators some controllers just have",
    "start": "159450",
    "end": "167519"
  },
  {
    "text": "general knowledge so the deployment control art doesn't have any specific insight into what it's managing all it",
    "start": "167519",
    "end": "173880"
  },
  {
    "text": "knows is that it needs to do some rolling updates all right so generally",
    "start": "173880",
    "end": "180000"
  },
  {
    "text": "over the course of this presentation I'm going to talk to you about some concepts then we're gonna look at some practical",
    "start": "180000",
    "end": "186830"
  },
  {
    "text": "details and then I'm gonna pop over and try it out and y'all can follow along",
    "start": "186830",
    "end": "194010"
  },
  {
    "text": "and try it out as well so we'll talk about scaffolding and design and then",
    "start": "194010",
    "end": "199530"
  },
  {
    "text": "we'll move into types and then we'll move into the code that makes those types do something useful and then finally at the end we'll talk about",
    "start": "199530",
    "end": "206329"
  },
  {
    "text": "moving from your test dev loop into something that can be deployed on an",
    "start": "206329",
    "end": "212340"
  },
  {
    "text": "actual cluster for production use all right so without further ado perhaps a little",
    "start": "212340",
    "end": "218190"
  },
  {
    "text": "to do if some of you think you have seen similar things before it's probably true",
    "start": "218190",
    "end": "223260"
  },
  {
    "text": "I've given some similar presentations before but in this one we're gonna talk a lot about the new features in",
    "start": "223260",
    "end": "228959"
  },
  {
    "text": "kubernetes that make this even nicer some of the stuff that just came out recently right so cube Builder cube",
    "start": "228959",
    "end": "238200"
  },
  {
    "text": "builder is a set of opinions and building blocks so there's kind of three components there's queue builder itself",
    "start": "238200",
    "end": "244230"
  },
  {
    "text": "which is scaffolding out new projects and then there's that's built on top of",
    "start": "244230",
    "end": "250170"
  },
  {
    "text": "two libraries the first is controller runtime which is like a standard library",
    "start": "250170",
    "end": "255420"
  },
  {
    "text": "for writing controllers and the second is controller tools which is a set of tools to do stuff like compile your go",
    "start": "255420",
    "end": "263190"
  },
  {
    "text": "types into a custom resource definition that you can install in the cluster so that you don't have to write open API",
    "start": "263190",
    "end": "269110"
  },
  {
    "text": "SPAC by hand because that is not a fun experience in my opinion alright so",
    "start": "269110",
    "end": "276849"
  },
  {
    "text": "today we're going to be building an operator for the guestbook tutorial from",
    "start": "276849",
    "end": "283120"
  },
  {
    "text": "kubernetes so who here has played around with the guestbook tutorial before at",
    "start": "283120",
    "end": "288400"
  },
  {
    "text": "all alright so cool some of you it's a",
    "start": "288400",
    "end": "293440"
  },
  {
    "text": "pretty simple application there's a small front-end PHP application that connects to a Redis instance and then",
    "start": "293440",
    "end": "301810"
  },
  {
    "text": "just basically lets you write in a name stores the name in Redis and when you load the page and loads all the names",
    "start": "301810",
    "end": "307330"
  },
  {
    "text": "from Redis pretty simple but it has a few moving parts and so it'll be good to explore kind of some stuff on how to",
    "start": "307330",
    "end": "314409"
  },
  {
    "text": "write an operator so we're gonna manage and deploy both and then we're going to expose the whole application in terms of",
    "start": "314409",
    "end": "322659"
  },
  {
    "text": "a service alright so there is a repo for",
    "start": "322659",
    "end": "328930"
  },
  {
    "text": "the finished code for this tutorial since we have an hour and a half I'd recommend y'all take a look at that that",
    "start": "328930",
    "end": "336190"
  },
  {
    "text": "might help you save you some time typing it is at present dev slash cubic on u.s.",
    "start": "336190",
    "end": "343029"
  },
  {
    "text": "2019 slash code and I am going to give people a few minutes now to pull that up",
    "start": "343029",
    "end": "349330"
  },
  {
    "text": "also if you put chopped off the slash code you can follow along with the slides if you ever want to take a closer",
    "start": "349330",
    "end": "356770"
  },
  {
    "text": "look at something so this is all just on my website once you're in that repo",
    "start": "356770",
    "end": "362860"
  },
  {
    "text": "there's a directory called goals that is like the Amol from the tutorial so if",
    "start": "362860",
    "end": "370810"
  },
  {
    "text": "you want to look at like the stuff that we're going to generate on the cluster you can take a look in there so give",
    "start": "370810",
    "end": "380500"
  },
  {
    "text": "like 30 seconds for people to copy down that URL",
    "start": "380500",
    "end": "386129"
  },
  {
    "text": "all right so I sent out homework ahead of time hopefully at least some of you",
    "start": "399439",
    "end": "407360"
  },
  {
    "text": "who've done the homework but if you haven't you're going to need a copy of Q",
    "start": "407360",
    "end": "412939"
  },
  {
    "text": "builder you're going to want a copy of the complete repo probably and you might",
    "start": "412939",
    "end": "421489"
  },
  {
    "text": "want to pull open the original tutorial in your web browser just to take a look",
    "start": "421489",
    "end": "427819"
  },
  {
    "text": "and it might help to compare and contrast what we're doing in the operator so",
    "start": "427819",
    "end": "434919"
  },
  {
    "text": "oh yeah you can totally you can brew",
    "start": "445590",
    "end": "450810"
  },
  {
    "text": "install if brew has to 2.0 you can totally install from brew",
    "start": "450810",
    "end": "457800"
  },
  {
    "text": "yeah we have a couple of contributors that maintain a brew repository at this",
    "start": "457800",
    "end": "464880"
  },
  {
    "text": "point you're also if you don't have a cluster up and running you're also going to want to kick off launching a cluster",
    "start": "464880",
    "end": "472050"
  },
  {
    "text": "so I'm just going to quickly flip over to my terminal for those of you don't",
    "start": "472050",
    "end": "479970"
  },
  {
    "text": "have one and I'm just going to show you what I did so I already have one up and",
    "start": "479970",
    "end": "487350"
  },
  {
    "text": "running for the sake of this tutorial but so we can see I have created this VM",
    "start": "487350",
    "end": "498090"
  },
  {
    "text": "here it is a container optimized OS",
    "start": "498090",
    "end": "503669"
  },
  {
    "text": "image because we're just going to be running a cluster on it for the most part if you can't get other stuff",
    "start": "503669",
    "end": "509550"
  },
  {
    "text": "running on your system you might want to do is the Debian image instead so that you can install other tooling but I'm",
    "start": "509550",
    "end": "515430"
  },
  {
    "text": "just using it to run a kind cluster so I will just briefly show you what I did is",
    "start": "515430",
    "end": "523370"
  },
  {
    "text": "we see if we test the internet right now",
    "start": "523370",
    "end": "534650"
  },
  {
    "text": "cool right so once largest there we go",
    "start": "535310",
    "end": "544920"
  },
  {
    "text": "awesome so for those of you who don't have a cluster I'd recommend using kind so the first thing you're going to want",
    "start": "544920",
    "end": "552030"
  },
  {
    "text": "to do is download kind which is here if",
    "start": "552030",
    "end": "558030"
  },
  {
    "text": "you go to the kind web page so kind dot cigs gates do you can get this very long",
    "start": "558030",
    "end": "564380"
  },
  {
    "text": "URL so don't try to copy it from here just know that you or if you google",
    "start": "564380",
    "end": "571080"
  },
  {
    "text": "kubernetes times you will find the right web page and then if you're on container optimized OS you just need to move",
    "start": "571080",
    "end": "578470"
  },
  {
    "text": "kind to VAR run and then make it",
    "start": "578470",
    "end": "587350"
  },
  {
    "text": "executable like that and then finally",
    "start": "587350",
    "end": "593610"
  },
  {
    "text": "you can do VAR run kinds create cluster",
    "start": "593610",
    "end": "601770"
  },
  {
    "text": "and kick that off it'll take a couple minutes I'm gonna pop back to the presentation but it's good to get it",
    "start": "601770",
    "end": "609010"
  },
  {
    "text": "started now okay cool",
    "start": "609010",
    "end": "614290"
  },
  {
    "text": "on with the show so how do we get",
    "start": "614290",
    "end": "619540"
  },
  {
    "text": "started with queue builder so what we're gonna do is we're gonna make a new directory since this is a go project",
    "start": "619540",
    "end": "625360"
  },
  {
    "text": "we're going to initialize the go module in it and then we're going to scaffold out the basic queue builder code this",
    "start": "625360",
    "end": "632470"
  },
  {
    "text": "will create some initial project structure creating directories for our API types and for our controller and",
    "start": "632470",
    "end": "640600"
  },
  {
    "text": "give us some nice deployment files for later on we give it this domain here this is just the suffix that is put on",
    "start": "640600",
    "end": "649060"
  },
  {
    "text": "the end of our API groups so that we don't clash with anyone else alright so",
    "start": "649060",
    "end": "655090"
  },
  {
    "text": "I'm gonna do that now up over here C",
    "start": "655090",
    "end": "661750"
  },
  {
    "text": "will create a new in progress you all",
    "start": "661750",
    "end": "668320"
  },
  {
    "text": "see that let me make it bigger go mod",
    "start": "668320",
    "end": "675610"
  },
  {
    "text": "and knit coupon you can name this go module whatever you want and then we'll",
    "start": "675610",
    "end": "682720"
  },
  {
    "text": "do queue builder in it - - Jemaine I'm",
    "start": "682720",
    "end": "688030"
  },
  {
    "text": "gonna use my personal domain please don't use this domain this one's mine",
    "start": "688030",
    "end": "693850"
  },
  {
    "text": "you can choose whatever you want if you have your own domain name use that you",
    "start": "693850",
    "end": "699310"
  },
  {
    "text": "could use example.com if you really want to it's reserved for testing so right",
    "start": "699310",
    "end": "704920"
  },
  {
    "text": "and it's just going to scaffold out a project with the default dependencies",
    "start": "704920",
    "end": "710080"
  },
  {
    "text": "it'll hint at our next step if you want spoilers you don't want spoilers ignore that last line okay cool",
    "start": "710080",
    "end": "718029"
  },
  {
    "text": "so ugly alright so I'm you heard me",
    "start": "718029",
    "end": "724870"
  },
  {
    "text": "mention API groups a moment ago so let's talk about how we describe kubernetes api sand will howl explain what API",
    "start": "724870",
    "end": "730269"
  },
  {
    "text": "groups are so in kubernetes we collect API types together and so we call each",
    "start": "730269",
    "end": "737889"
  },
  {
    "text": "collection of related API types in API group API groups can have multiple",
    "start": "737889",
    "end": "743889"
  },
  {
    "text": "versions this is how we make breaking changes to api's in kubernetes we add",
    "start": "743889",
    "end": "750100"
  },
  {
    "text": "new versions and then we convert between them and within that API group we call",
    "start": "750100",
    "end": "755319"
  },
  {
    "text": "each type a kind now this is most of what you need to know to talk about",
    "start": "755319",
    "end": "760569"
  },
  {
    "text": "kubernetes api terminology but there is one more thing that may come up if you get really deep in you may also hear",
    "start": "760569",
    "end": "767560"
  },
  {
    "text": "people talk about resources it resources a use of a particular kind than the API",
    "start": "767560",
    "end": "773160"
  },
  {
    "text": "usually they're one-to-one but not always there's a few exceptions in certain parts of the kubernetes api so",
    "start": "773160",
    "end": "781449"
  },
  {
    "text": "just you can think of resources as functions and kinds as return types but",
    "start": "781449",
    "end": "787240"
  },
  {
    "text": "usually in kubernetes we only have like one set of functions that returns a given return type and so when we have go",
    "start": "787240",
    "end": "794410"
  },
  {
    "text": "types usually each of those go types corresponds to a single group version kind all right so the structure of every",
    "start": "794410",
    "end": "805209"
  },
  {
    "text": "almost every kubernetes kind looks roughly like this so all of them start",
    "start": "805209",
    "end": "810699"
  },
  {
    "text": "out with some metadata this provides information about what kind we're",
    "start": "810699",
    "end": "816069"
  },
  {
    "text": "dealing with what API version in this case we're looking at the pod in the",
    "start": "816069",
    "end": "821529"
  },
  {
    "text": "core v1 group we for historical reasons we don't write the core but it's kind of",
    "start": "821529",
    "end": "827230"
  },
  {
    "text": "implied and then there's also some what we call object metadata so this is things like name namespace labels",
    "start": "827230",
    "end": "833920"
  },
  {
    "text": "hopefully y'all are familiar with that and then almost all other types almost",
    "start": "833920",
    "end": "839579"
  },
  {
    "text": "have spec and status so the spec contains the desired state and",
    "start": "839579",
    "end": "845200"
  },
  {
    "text": "the status contains the observes date right so practically speaking the way we",
    "start": "845200",
    "end": "854260"
  },
  {
    "text": "get started here is we call queue build or create API we pass a group name and",
    "start": "854260",
    "end": "859270"
  },
  {
    "text": "then I'll get our domain appended so if I say group web app it'll be web app doesn't matter magic hole depth we give",
    "start": "859270",
    "end": "866470"
  },
  {
    "text": "it a kind name so we'll say guestbook here and then we give it a version we're",
    "start": "866470",
    "end": "871660"
  },
  {
    "text": "gonna be bold and we're gonna decide that we're going right to stable protip don't do this and that'll give us",
    "start": "871660",
    "end": "879850"
  },
  {
    "text": "something that looks like this for our API types so you can see up top here we have our spec and then we have our",
    "start": "879850",
    "end": "887320"
  },
  {
    "text": "status and then we have this root object which contains our metadata so type",
    "start": "887320",
    "end": "892570"
  },
  {
    "text": "meant an object meta so that's like API version and name and namespace and stuff",
    "start": "892570",
    "end": "898150"
  },
  {
    "text": "and then it also contains our spec in our status and finally we have this list type as you might guess this is the type",
    "start": "898150",
    "end": "906250"
  },
  {
    "text": "that's returned when we call west's so if we do cube cuddle get without a specific name it goes and says to the",
    "start": "906250",
    "end": "913090"
  },
  {
    "text": "API server give me all of the pods and the API server returns this kind of",
    "start": "913090",
    "end": "918460"
  },
  {
    "text": "record type all right so let's look through each of those sections so first",
    "start": "918460",
    "end": "923710"
  },
  {
    "text": "up is the root type we don't usually edit the go code of the root type because it almost never",
    "start": "923710",
    "end": "929830"
  },
  {
    "text": "changes between types but what we do do is we can add additional metadata to the",
    "start": "929830",
    "end": "937000"
  },
  {
    "text": "root type this describes more information about our CR D so the common",
    "start": "937000",
    "end": "942250"
  },
  {
    "text": "things that we do is we enable sub resources and we add print columns so we'll talk about the status sub resource",
    "start": "942250",
    "end": "949420"
  },
  {
    "text": "a little bit later in the tutorial but for now just know that we enable it here with this marker comment so that's that",
    "start": "949420",
    "end": "957310"
  },
  {
    "text": "comment that begins with a plus and then we also had print columns print columns are the way that we can get nice cube",
    "start": "957310",
    "end": "964990"
  },
  {
    "text": "cut' will get output so you know like with core types if I were to do cube cut' will get pods I would see like some",
    "start": "964990",
    "end": "970570"
  },
  {
    "text": "nice columns that would show like node name and maybe pot IP and stuff like that status whether or not it's running or",
    "start": "970570",
    "end": "977439"
  },
  {
    "text": "terminated or in progress the way we do that for CR DS is we had these print columns so here we've added to print",
    "start": "977439",
    "end": "985569"
  },
  {
    "text": "columns we add one for URL which we're gonna be exposing in our status and we",
    "start": "985569",
    "end": "992649"
  },
  {
    "text": "had one that shows the current desired replicas from our spec and this way when we type cube cut' we'll get guest bucks",
    "start": "992649",
    "end": "997839"
  },
  {
    "text": "instead of just seeing name and like creation timestamp we see like some useful information that is a summary of",
    "start": "997839",
    "end": "1004529"
  },
  {
    "text": "all of our guestbook instances right on to the spec so spec describes desired",
    "start": "1004529",
    "end": "1013829"
  },
  {
    "text": "state like we said before so we need to decide what we want to put in here so I've put in two kind of fields in the",
    "start": "1013829",
    "end": "1021899"
  },
  {
    "text": "root of the spec one of them is the name of the Redis object that we're going to use to fetch our connection details so",
    "start": "1021899",
    "end": "1028048"
  },
  {
    "text": "we'll also have a Redis kind and we will use the Redis status to know how to connect our deployment to Redis and then",
    "start": "1028049",
    "end": "1036030"
  },
  {
    "text": "we also have details about how to deploy and manage our front-end so I've added resource requirements so we can control",
    "start": "1036030",
    "end": "1043140"
  },
  {
    "text": "how much CPU it uses and also information about the service and the number of replicas and you can see we",
    "start": "1043140",
    "end": "1048900"
  },
  {
    "text": "also can use markers here marker comments this time they go in fields and",
    "start": "1048900",
    "end": "1054000"
  },
  {
    "text": "they control stuff like defaulting and validation so we actually have a pretty powerful language and open API and all",
    "start": "1054000",
    "end": "1060659"
  },
  {
    "text": "of that is exposed to these markers so we can say don't let people submit ports",
    "start": "1060659",
    "end": "1065820"
  },
  {
    "text": "that are negative because that doesn't make any sense if they don't add a port make it 8080",
    "start": "1065820",
    "end": "1071700"
  },
  {
    "text": "because that's a same default for instance and we can say that certain fields are optional so like port is",
    "start": "1071700",
    "end": "1077400"
  },
  {
    "text": "optional will default it all right status is very similar to spec there is",
    "start": "1077400",
    "end": "1084270"
  },
  {
    "text": "one thing to note here as you're thinking about your api's which is to say status is used to convey information",
    "start": "1084270",
    "end": "1090740"
  },
  {
    "text": "to the user and to other controllers it is not for storing things so you should",
    "start": "1090740",
    "end": "1097860"
  },
  {
    "text": "think about status as kind of ephemeral right like imagine that at any time someone could come through and delete",
    "start": "1097860",
    "end": "1103649"
  },
  {
    "text": "your entire status you need to be able to recreate it from everything else so a given",
    "start": "1103649",
    "end": "1108870"
  },
  {
    "text": "controller that's writing status to its own object should not be reading in that status",
    "start": "1108870",
    "end": "1113880"
  },
  {
    "text": "it should not be depending on information there it's it's for it to communicate information out to the world",
    "start": "1113880",
    "end": "1119570"
  },
  {
    "text": "right so we're also going to need Redis types kind of similar to what we talked",
    "start": "1119570",
    "end": "1126420"
  },
  {
    "text": "about for guestbook Redis has some one",
    "start": "1126420",
    "end": "1132179"
  },
  {
    "text": "leader and some number of follower instances so we let you control the",
    "start": "1132179",
    "end": "1137340"
  },
  {
    "text": "follower replicas a couple things to note here we can use Joe doc to set",
    "start": "1137340",
    "end": "1144080"
  },
  {
    "text": "basically API descriptions that come out in our open API this is nice if people are generate using nice UI is that or",
    "start": "1144080",
    "end": "1152010"
  },
  {
    "text": "IDs that give them help when they're writing their mo and it also shows up in cue cuddle explained so if someone says",
    "start": "1152010",
    "end": "1158640"
  },
  {
    "text": "cute cuddly explained guest books it'll read from the open API and I'll show like follower replicas is the number of",
    "start": "1158640",
    "end": "1165179"
  },
  {
    "text": "follower instances to run so right so if",
    "start": "1165179",
    "end": "1171780"
  },
  {
    "text": "you were paying super close attention you might have noticed that when I default 'add two fields in the guestbook",
    "start": "1171780",
    "end": "1178200"
  },
  {
    "text": "I use slightly different types for them so one of them was a pointer and one of",
    "start": "1178200",
    "end": "1183360"
  },
  {
    "text": "them was not a pointer this is a little bit of an important point in kubernetes so if we don't have a pointer the zero",
    "start": "1183360",
    "end": "1192960"
  },
  {
    "text": "value is assumed to mean unset so in the case of integers for instance that means",
    "start": "1192960",
    "end": "1199140"
  },
  {
    "text": "zero is the same thing as I didn't fill in a value and so the default will",
    "start": "1199140",
    "end": "1205800"
  },
  {
    "text": "always be applied even if the user passes zero so this is great for things like port because zero is kind of a",
    "start": "1205800",
    "end": "1212580"
  },
  {
    "text": "nonsensical port but it's not so great for replicas because it means we can",
    "start": "1212580",
    "end": "1217679"
  },
  {
    "text": "never stop our thing right so the solution to this is to make the zero value something else and the way we do",
    "start": "1217679",
    "end": "1223260"
  },
  {
    "text": "that is by using a pointer so if the zero zero value of a pointer is nil",
    "start": "1223260",
    "end": "1228809"
  },
  {
    "text": "which means unset becomes nil becomes a default but if it's explicitly set to",
    "start": "1228809",
    "end": "1234270"
  },
  {
    "text": "zero in the mo that becomes a pointer to zero and we don't do our defaulting so we let our users scale down our",
    "start": "1234270",
    "end": "1241260"
  },
  {
    "text": "things which is good because sometimes they won't want it running we can use",
    "start": "1241260",
    "end": "1246900"
  },
  {
    "text": "almost any type in go in our spec and status with a few exceptions",
    "start": "1246900",
    "end": "1252240"
  },
  {
    "text": "we don't use floats because for those of you not familiar with how floats",
    "start": "1252240",
    "end": "1257310"
  },
  {
    "text": "interact and they're they're very good at what they do but that what they do is probably not what you expect so they",
    "start": "1257310",
    "end": "1263280"
  },
  {
    "text": "don't round-trip very well through through Jason and llamó and through other languages so we use a different",
    "start": "1263280",
    "end": "1268740"
  },
  {
    "text": "representation instead called resource stock quantity you've probably seen it when you're sending your pod resource",
    "start": "1268740",
    "end": "1274410"
  },
  {
    "text": "requirements we also don't really use interfaces in our api's we prefer these kind of tagged unions down here where we",
    "start": "1274410",
    "end": "1280530"
  },
  {
    "text": "have an explicit type field and then multiple kind of variant fields that are",
    "start": "1280530",
    "end": "1285600"
  },
  {
    "text": "generally pointers to things or things with zero of all values all right so",
    "start": "1285600",
    "end": "1292980"
  },
  {
    "text": "let's try this out so we're gonna populate our scaffold it out sample so",
    "start": "1292980",
    "end": "1300240"
  },
  {
    "text": "by default queue builder scaffolds out kind of an empty sample with some bogus data in it so we can fill that out I'm",
    "start": "1300240",
    "end": "1306720"
  },
  {
    "text": "going to add some bad data that's an invalid field into mine just so that we",
    "start": "1306720",
    "end": "1312690"
  },
  {
    "text": "can see that validation is working and then we will actually pop over and",
    "start": "1312690",
    "end": "1319490"
  },
  {
    "text": "generate our CRD from our go types with make manifests we will install our CR D",
    "start": "1319490",
    "end": "1325530"
  },
  {
    "text": "with cube cuddle create and we will attempt to install our sample it will fail and then we will install it again",
    "start": "1325530",
    "end": "1334410"
  },
  {
    "text": "and it will succeed because we will remove the bad data and we'll be B we",
    "start": "1334410",
    "end": "1340380"
  },
  {
    "text": "will be able to run cube cuddle get guests books and it will work so let's",
    "start": "1340380",
    "end": "1346470"
  },
  {
    "text": "try that out just gonna flip back over",
    "start": "1346470",
    "end": "1352050"
  },
  {
    "text": "to over here so first I'm gonna fill out I'm gonna do all that stuff we talked",
    "start": "1352050",
    "end": "1357480"
  },
  {
    "text": "about at the beginning so we'll do Q builder create API we're",
    "start": "1357480",
    "end": "1364830"
  },
  {
    "text": "gonna get a API and it's gonna ask us do we want to create a resource we're gonna say yes that's do we want to create",
    "start": "1364830",
    "end": "1370770"
  },
  {
    "text": "those go types and do we want to create a controller we'll also say yes we'll deal with that in a little so it's going to scaffold out some types",
    "start": "1370770",
    "end": "1379740"
  },
  {
    "text": "that's going to attempt to run go imports to clean it up a little bit and then we've got this the scaffold out",
    "start": "1379740",
    "end": "1387179"
  },
  {
    "text": "types so I am going to cheat a little bit because I'm standing up here and I'm",
    "start": "1387179",
    "end": "1392370"
  },
  {
    "text": "gonna copy over from the completed tutorial so API v1 guestbook types and",
    "start": "1392370",
    "end": "1400020"
  },
  {
    "text": "then we'll also look at you know API v1",
    "start": "1400020",
    "end": "1406250"
  },
  {
    "text": "guestbook types in this not split so you",
    "start": "1406250",
    "end": "1412650"
  },
  {
    "text": "all can see both sides we can see we've got this empty here we've got this",
    "start": "1412650",
    "end": "1417900"
  },
  {
    "text": "complete here so I'm just going to grab my spec fields from here and copy them",
    "start": "1417900",
    "end": "1424140"
  },
  {
    "text": "over get rid of this nonsense and then",
    "start": "1424140",
    "end": "1431880"
  },
  {
    "text": "you can see we have like this nested front end spec so we'll also need that and then finally our status with just",
    "start": "1431880",
    "end": "1440790"
  },
  {
    "text": "the URL we could put other information in here too but oftentimes we have stuff",
    "start": "1440790",
    "end": "1447000"
  },
  {
    "text": "like status conditions that convey kind of what the current state is of the",
    "start": "1447000",
    "end": "1453590"
  },
  {
    "text": "deployment of the thing so like did we create our service successfully did create our deployment successfully and",
    "start": "1453590",
    "end": "1461970"
  },
  {
    "text": "then finally I'll also copy in all of those markers that go on our route type",
    "start": "1461970",
    "end": "1469520"
  },
  {
    "text": "over here and then finally last but",
    "start": "1469669",
    "end": "1477450"
  },
  {
    "text": "certainly not least since we use that core v1 dot resource requirements that's the same kind of structure used in the",
    "start": "1477450",
    "end": "1484530"
  },
  {
    "text": "pod container resource requirements we'll need to import core v1 and then my",
    "start": "1484530",
    "end": "1490890"
  },
  {
    "text": "compiler is happy so I'm all set I can run make manifests oh one more thing",
    "start": "1490890",
    "end": "1500970"
  },
  {
    "text": "sorry about this so we're using brand new features and so we've got a tell",
    "start": "1500970",
    "end": "1508430"
  },
  {
    "text": "controller gen that we want to generate in the new format with those new features so this was just launched in",
    "start": "1508430",
    "end": "1515460"
  },
  {
    "text": "kubernetes like one version ago and so by default we don't generate that so that people get projects that work on",
    "start": "1515460",
    "end": "1521670"
  },
  {
    "text": "older versions of new kubernetes but here we like living on the edge so we're",
    "start": "1521670",
    "end": "1526710"
  },
  {
    "text": "gonna say use the GA version so we open up the make file and say CRT versions",
    "start": "1526710",
    "end": "1532800"
  },
  {
    "text": "equals v1 as opposed to v1 beta 1 and let's try that again cool alright so",
    "start": "1532800",
    "end": "1539340"
  },
  {
    "text": "let's take a look at that quickly just so you can see that all the stuff you didn't have to write so we'll do config",
    "start": "1539340",
    "end": "1545730"
  },
  {
    "text": "CRD basis and you can see we get this nice open API spec that has all this",
    "start": "1545730",
    "end": "1552630"
  },
  {
    "text": "validation in here we get some defaulting you can see we had that",
    "start": "1552630",
    "end": "1558780"
  },
  {
    "text": "faulting on replicas with the default of 1 in the minimum of 0 and you can see",
    "start": "1558780",
    "end": "1565470"
  },
  {
    "text": "that we have all this nice resource requirements stuff in here too so let's",
    "start": "1565470",
    "end": "1571530"
  },
  {
    "text": "also edit our sample so it's under the config samples guestbook and we'll give",
    "start": "1571530",
    "end": "1578520"
  },
  {
    "text": "it a Redis name since that was required by this sample will generate the Redis",
    "start": "1578520",
    "end": "1584010"
  },
  {
    "text": "one later later and then we'll give it some front-end configuration so I'll say",
    "start": "1584010",
    "end": "1590250"
  },
  {
    "text": "resources requirements or requests sorry",
    "start": "1590250",
    "end": "1596360"
  },
  {
    "text": "say CPU 50 ml of course it's not a big application and then we'll also say",
    "start": "1596360",
    "end": "1604220"
  },
  {
    "text": "serving port whole and negative one and",
    "start": "1604220",
    "end": "1609630"
  },
  {
    "text": "that's just invalid right you can't have a porch of negative one and so our validation will catch that all right so",
    "start": "1609630",
    "end": "1617370"
  },
  {
    "text": "at this point all of you should have running kind cluster if you were on GCP",
    "start": "1617370",
    "end": "1623400"
  },
  {
    "text": "it should be up and running and if you were not on GC p your local cluster",
    "start": "1623400",
    "end": "1628590"
  },
  {
    "text": "should hopefully be running or your remote cluster or whatever whatever you're deploying on to so what I did",
    "start": "1628590",
    "end": "1638040"
  },
  {
    "text": "because I'm running against GC p is that I as saged into the node the compute instance",
    "start": "1638040",
    "end": "1645870"
  },
  {
    "text": "I grabbed the cube config that was generated by kind so kind we'll say it's your cube config is now set it's at",
    "start": "1645870",
    "end": "1652560"
  },
  {
    "text": "Tilley slash dot cube slash config so I copied that to my local machine and then",
    "start": "1652560",
    "end": "1659580"
  },
  {
    "text": "I'm going to run this fancy port forward command and I will show you how to",
    "start": "1659580",
    "end": "1665520"
  },
  {
    "text": "figure that out in a moment so swell commands over here I'm just gonna grab",
    "start": "1665520",
    "end": "1673260"
  },
  {
    "text": "this thing here so basically this is just the default g-cloud ssh command",
    "start": "1673260",
    "end": "1680010"
  },
  {
    "text": "that you will get if you press the little drop down next to the instance box and say next ssh and you say ssh",
    "start": "1680010",
    "end": "1686700"
  },
  {
    "text": "with g-cloud and then we're gonna pass this dash out here and - f + - n which",
    "start": "1686700",
    "end": "1692580"
  },
  {
    "text": "is going to port forward from my local machine to the remote machine and so",
    "start": "1692580",
    "end": "1698610"
  },
  {
    "text": "we're just going to use the connection string we got from the cube config so I'll show you how to get that in a",
    "start": "1698610",
    "end": "1704250"
  },
  {
    "text": "moment but we're just gonna run this here - F and - and just say no I don't",
    "start": "1704250",
    "end": "1711030"
  },
  {
    "text": "actually run it and want to run a command just go into the background in port forward and with any luck we should",
    "start": "1711030",
    "end": "1719940"
  },
  {
    "text": "be able to do cool so we have a working cluster right so let me just show you",
    "start": "1719940",
    "end": "1729799"
  },
  {
    "text": "console clouds at google.com and we'll go under our compute engine instances",
    "start": "1730940",
    "end": "1738590"
  },
  {
    "text": "here and then so the way I got that crazy command was I just went down to",
    "start": "1738590",
    "end": "1745050"
  },
  {
    "text": "this little drop down here and I said you g-cloud command and you just copy this whole thing and then at the end of",
    "start": "1745050",
    "end": "1753780"
  },
  {
    "text": "it you just add - - and then - L and the",
    "start": "1753780",
    "end": "1760260"
  },
  {
    "text": "port and then the connection string from the cupid favour",
    "start": "1760260",
    "end": "1765830"
  },
  {
    "text": "please if anybody is having issues with that or is confused please raise your hand and we can have someone come over",
    "start": "1768480",
    "end": "1779090"
  },
  {
    "text": "all right so now that you hopefully have a running cluster let's install the CRD",
    "start": "1779090",
    "end": "1786919"
  },
  {
    "text": "right and we'll also attempt to create our sample and we're gonna get this nice",
    "start": "1788480",
    "end": "1798330"
  },
  {
    "text": "message here see so our validation is working it said invalid value spec front",
    "start": "1798330",
    "end": "1807540"
  },
  {
    "text": "end that serving porch should be greater than or equal to zero so we're gonna go into config samples",
    "start": "1807540",
    "end": "1815220"
  },
  {
    "text": "and get rid of serving porch here and then we were going to try again it works",
    "start": "1815220",
    "end": "1823230"
  },
  {
    "text": "because we provided value valid data and then if we do cube cut' will get guestbooks we can see we have this nice",
    "start": "1823230",
    "end": "1833130"
  },
  {
    "text": "table display that shows us useful information just because we put those",
    "start": "1833130",
    "end": "1839100"
  },
  {
    "text": "markers in place we don't have any URL because we don't have any controller to set the URL so let's tackle that I'm",
    "start": "1839100",
    "end": "1847710"
  },
  {
    "text": "gonna give everybody a couple more minutes first though to try this out and remember all of this stuff is in the",
    "start": "1847710",
    "end": "1855180"
  },
  {
    "text": "completed get repo so if you are having",
    "start": "1855180",
    "end": "1861570"
  },
  {
    "text": "trouble or you think you type out something you can't figure out what it is or if you just don't feel like typing I frequently don't feel like typing",
    "start": "1861570",
    "end": "1868950"
  },
  {
    "text": "that's why I have Kay Elias to cue cuddle instead of having to type out cube cut' all the time you can just go",
    "start": "1868950",
    "end": "1874950"
  },
  {
    "text": "from there and if you really don't want spoilers in that repo I've got the exact",
    "start": "1874950",
    "end": "1881750"
  },
  {
    "text": "git commit where you should be checked out to in the completed repo if you",
    "start": "1881750",
    "end": "1887970"
  },
  {
    "text": "really want to just follow along exactly instead of just using the end right and",
    "start": "1887970",
    "end": "1894990"
  },
  {
    "text": "feel free to raise your hand if you are having issues",
    "start": "1894990",
    "end": "1899929"
  },
  {
    "text": "and or if you think there's something that's very confusing you can also ask",
    "start": "1911240",
    "end": "1917120"
  },
  {
    "text": "the question out loud and I will try to answer it on stage because it may be confusing for other people as well would",
    "start": "1917120",
    "end": "1929210"
  },
  {
    "text": "you say slow down a little bit yeah I can I'll give you I'll give you all a",
    "start": "1929210",
    "end": "1935539"
  },
  {
    "text": "few more minutes and as a reminder if",
    "start": "1935539",
    "end": "1946100"
  },
  {
    "text": "you would like to look back at any of the other slides if you go to present",
    "start": "1946100",
    "end": "1951830"
  },
  {
    "text": "meta magical dev which I can show you now you will get this webpage if the",
    "start": "1951830",
    "end": "1962779"
  },
  {
    "text": "conference Wi-Fi is working and you can just click on this link here that says 0",
    "start": "1962779",
    "end": "1968120"
  },
  {
    "text": "- operator a little zoom in a little bit this link here that says 0 - operator and you'll actually just get a copy of",
    "start": "1968120",
    "end": "1974750"
  },
  {
    "text": "the slides so if you would like to look at the slides at all or look back a few slides or whatever you can follow along",
    "start": "1974750",
    "end": "1981769"
  },
  {
    "text": "there as well can also look forward a few slides but that would be spoilers again and that's no fun",
    "start": "1981769",
    "end": "1988929"
  },
  {
    "text": "if you and if you want to ask a question you can also come up here and I'll repeat the question out loud if if it's",
    "start": "2015580",
    "end": "2020770"
  },
  {
    "text": "like you think it's relevant for everyone",
    "start": "2020770",
    "end": "2024929"
  },
  {
    "text": "actually I'll come down and help somebody dull to just expedite this Hey",
    "start": "2030920",
    "end": "2042400"
  },
  {
    "text": "it could make my own",
    "start": "2060679",
    "end": "2063940"
  },
  {
    "text": "yeah so I've got a couple of good questions the first one is what was that",
    "start": "2115580",
    "end": "2121220"
  },
  {
    "text": "make file option and it's CRD versions plural equals v1 and you can see that in",
    "start": "2121220",
    "end": "2128540"
  },
  {
    "text": "the completed repo too and the other one is if you get this weird error about go",
    "start": "2128540",
    "end": "2135020"
  },
  {
    "text": "dependencies that occasionally happens",
    "start": "2135020",
    "end": "2141160"
  },
  {
    "text": "due to the way go likes to resolve dependencies if you go into your Godot",
    "start": "2141160",
    "end": "2147890"
  },
  {
    "text": "mod file you should see if you're encountering this issue you should see two lines one that says controller",
    "start": "2147890",
    "end": "2153500"
  },
  {
    "text": "runtime and one that says kate's io / client go if you delete the line that says kto / client go and then you rerun",
    "start": "2153500",
    "end": "2162530"
  },
  {
    "text": "like go build or go mod tidy or something like that basically any of the commands that effect go modules it will",
    "start": "2162530",
    "end": "2170960"
  },
  {
    "text": "attempt to reira solve dependencies and actually use the right version basically kubernetes go dependencies management is",
    "start": "2170960",
    "end": "2180200"
  },
  {
    "text": "like half way to go modules and so occasionally it gets a little bit weird oh that changes in Godot mod so it's",
    "start": "2180200",
    "end": "2191360"
  },
  {
    "text": "your Godot mod is your dependency less right it's like your version of your all",
    "start": "2191360",
    "end": "2197960"
  },
  {
    "text": "your modules that you're using",
    "start": "2197960",
    "end": "2201460"
  },
  {
    "text": "the question was about the new features we're using in our CR D and what what",
    "start": "2225850",
    "end": "2234010"
  },
  {
    "text": "versions will this work with and and why are why are we turning on this feature so this is actually about things like",
    "start": "2234010",
    "end": "2242530"
  },
  {
    "text": "defaulting so those are only turned on in the GA version of CR DS and generally",
    "start": "2242530",
    "end": "2253210"
  },
  {
    "text": "you could hypothetically write a controller that assume the defaulting",
    "start": "2253210",
    "end": "2260260"
  },
  {
    "text": "was not going to take place and like back up defaulted but use the CR d",
    "start": "2260260",
    "end": "2266920"
  },
  {
    "text": "defaulting if it was available and just generate two different versions of the CR D that's actually why the option is",
    "start": "2266920",
    "end": "2273310"
  },
  {
    "text": "plural you can actually specify multiple versions there and install a different version depending on what cluster it's",
    "start": "2273310",
    "end": "2278980"
  },
  {
    "text": "running on that's kind of a little bit more advanced than this tutorial I think",
    "start": "2278980",
    "end": "2285040"
  },
  {
    "text": "so we're just gonna stick with stuff for the newer version",
    "start": "2285040",
    "end": "2291240"
  },
  {
    "text": "when you do queue build or create API it'll ask you two questions say yes to",
    "start": "2322200",
    "end": "2328620"
  },
  {
    "text": "both of them",
    "start": "2328620",
    "end": "2331040"
  },
  {
    "text": "yeah so actually if you had that failure with the dependencies it's just failure",
    "start": "2339420",
    "end": "2347380"
  },
  {
    "text": "attempting to build I believe you should have all the files still there okay so",
    "start": "2347380",
    "end": "2354340"
  },
  {
    "text": "if you then deleted them you can go into your project file it's just called",
    "start": "2354340",
    "end": "2359410"
  },
  {
    "text": "project and all upper case and there's like a list of types and if you just delete it you should be able to run the",
    "start": "2359410",
    "end": "2366040"
  },
  {
    "text": "command again",
    "start": "2366040",
    "end": "2368460"
  },
  {
    "text": "just a reminder so you will need a 1.16 or newer technically if you're compiling",
    "start": "2415480",
    "end": "2422829"
  },
  {
    "text": "from head a cluster so that's why we're using kind today for instance anything",
    "start": "2422829",
    "end": "2430000"
  },
  {
    "text": "older you'll get messages about the v1 CRD not existing or if you try to",
    "start": "2430000",
    "end": "2436089"
  },
  {
    "text": "generate v1 beta one it'll yell at you and say you're not allowed to use defaults in v1 beta one",
    "start": "2436089",
    "end": "2443880"
  },
  {
    "text": "okay so make sure if you're missing",
    "start": "2681049",
    "end": "2686049"
  },
  {
    "text": "config CRD bases make sure to run this first command make manifests that will",
    "start": "2686559",
    "end": "2693469"
  },
  {
    "text": "generate your CR DS and put them in that bassist directory that's probably it",
    "start": "2693469",
    "end": "2698809"
  },
  {
    "text": "alright quick show of hands who has managed to successfully run Q cuddle get",
    "start": "2698809",
    "end": "2705559"
  },
  {
    "text": "guest books this last step all right who has like gotten mostly the way there and",
    "start": "2705559",
    "end": "2713569"
  },
  {
    "text": "like hit some speed bump okay and who is",
    "start": "2713569",
    "end": "2719179"
  },
  {
    "text": "still waiting for their cluster to finish creating because of Internet issues okay",
    "start": "2719179",
    "end": "2726939"
  },
  {
    "text": "so for the sake of time just to make sure we get through everything I'm going",
    "start": "2726939",
    "end": "2732589"
  },
  {
    "text": "to advance along a little bit and then if we have time at the end or the next break I'll be happy to come around again",
    "start": "2732589",
    "end": "2738679"
  },
  {
    "text": "and and help out and Walter can also come around and help you out alright so",
    "start": "2738679",
    "end": "2746859"
  },
  {
    "text": "we have our types and this is awesome but at this point kubernetes is effectively acting acting as a",
    "start": "2747309",
    "end": "2753409"
  },
  {
    "text": "structured key value star which is like great but we probably actually want to",
    "start": "2753409",
    "end": "2759439"
  },
  {
    "text": "do stuff right deploy pods run workloads all that jazz see URLs have things show",
    "start": "2759439",
    "end": "2766880"
  },
  {
    "text": "up in our browser that's the fun demo endpoint right alright so let's talk about how we make things go so when we",
    "start": "2766880",
    "end": "2775459"
  },
  {
    "text": "talk about kubernetes and we talked about controllers the core concept that we talked about is reconciliation",
    "start": "2775459",
    "end": "2780729"
  },
  {
    "text": "reconciling our observed and desired states and so generally in kubernetes",
    "start": "2780729",
    "end": "2786189"
  },
  {
    "text": "reconciliation follows like a standard pattern this is followed by almost everything in kubernetes be it custom",
    "start": "2786189",
    "end": "2793819"
  },
  {
    "text": "operators custom controllers built-in controllers even like the qubit so we",
    "start": "2793819",
    "end": "2799399"
  },
  {
    "text": "read our route object the main object we care about for any given controller we",
    "start": "2799399",
    "end": "2804559"
  },
  {
    "text": "fetch all the other objects we care about so these are might be objects we created objects we're reading",
    "start": "2804559",
    "end": "2810319"
  },
  {
    "text": "information from we ensure the objects we created are in the right State we insure that our external state things",
    "start": "2810319",
    "end": "2817070"
  },
  {
    "text": "like load balancers databases etc are in the right seat and then we write back",
    "start": "2817070",
    "end": "2822260"
  },
  {
    "text": "what we did in to our object status and then we repeat over and over again so",
    "start": "2822260",
    "end": "2828880"
  },
  {
    "text": "let's take a look at what that looks like in code form so this is a little small but we'll go over it in more",
    "start": "2828880",
    "end": "2835340"
  },
  {
    "text": "detail and I can zoom in a little bit but this is in the essence the entire",
    "start": "2835340",
    "end": "2840860"
  },
  {
    "text": "reconciliation loop for our guestbook controller so we can see we start out we",
    "start": "2840860",
    "end": "2847640"
  },
  {
    "text": "get this reconciliation request here and that contains the name in the name space for a guestbook",
    "start": "2847640",
    "end": "2854890"
  },
  {
    "text": "so what we're gonna do is we're gonna attempt to load that guestbook and then",
    "start": "2854890",
    "end": "2860600"
  },
  {
    "text": "once we've loaded that guestbook we're also going to attempt to load the Redis",
    "start": "2860600",
    "end": "2865670"
  },
  {
    "text": "instance that it references so we're gonna look at spec dot Redis name and",
    "start": "2865670",
    "end": "2872090"
  },
  {
    "text": "we're gonna construct a key basically a name in the namespace and we're gonna say load the Redis name spectra Tasneem",
    "start": "2872090",
    "end": "2879859"
  },
  {
    "text": "in the namespace that's the same as our guestbook and then using information",
    "start": "2879859",
    "end": "2885350"
  },
  {
    "text": "from that Redis is status and our guestbook spec we're going to construct the deployment to run our guestbook",
    "start": "2885350",
    "end": "2892100"
  },
  {
    "text": "front-end and then we're also going to use the",
    "start": "2892100",
    "end": "2897440"
  },
  {
    "text": "information in our guestbook spec to construct the service that exposes that",
    "start": "2897440",
    "end": "2902480"
  },
  {
    "text": "deployment to the world and then finally we are going to submit those changes to",
    "start": "2902480",
    "end": "2908930"
  },
  {
    "text": "the API server and update our own status and then update our the value of our",
    "start": "2908930",
    "end": "2916400"
  },
  {
    "text": "status on the API server and finally we return this result value that result",
    "start": "2916400",
    "end": "2922730"
  },
  {
    "text": "value says things completed successfully and we don't need to riku so if we",
    "start": "2922730",
    "end": "2928580"
  },
  {
    "text": "needed to do periodic updates or if we need to check again later because say we're reconciling some external status",
    "start": "2928580",
    "end": "2936859"
  },
  {
    "text": "that doesn't implement this kind of watch mechanism that we have in kubernetes we could say like riku after",
    "start": "2936859",
    "end": "2943970"
  },
  {
    "text": "10 seconds to check again in 10 seconds well we don't need to do that also if we return an error here as the second value we",
    "start": "2943970",
    "end": "2951020"
  },
  {
    "text": "would get automatically recued with back off so if we fail to do something we can just return an error and our mechanics",
    "start": "2951020",
    "end": "2958730"
  },
  {
    "text": "will try again later but backing off so that we don't just keep trying really",
    "start": "2958730",
    "end": "2964640"
  },
  {
    "text": "quickly forever all right so you might have noticed there were a couple helpers there I kind of moved",
    "start": "2964640",
    "end": "2971240"
  },
  {
    "text": "them out so that it would be easier to go over the structure of the code but the helpers are actually pretty simple",
    "start": "2971240",
    "end": "2977240"
  },
  {
    "text": "so normally in kubernetes we need to be",
    "start": "2977240",
    "end": "2982750"
  },
  {
    "text": "make sure to be item potent with our changes all right so what this means is if our object is in the right state",
    "start": "2982750",
    "end": "2989810"
  },
  {
    "text": "already we don't want to accidentally reset any fields that someone else set",
    "start": "2989810",
    "end": "2994940"
  },
  {
    "text": "or change things we just want to make sure that everything is in the right state that we care about and so",
    "start": "2994940",
    "end": "3000640"
  },
  {
    "text": "previously in older versions of kubernetes this was kind of hard if any",
    "start": "3000640",
    "end": "3006430"
  },
  {
    "text": "of you were have seen any of my previous presentations you'll know that there's",
    "start": "3006430",
    "end": "3011589"
  },
  {
    "text": "like a couple pages of code just to do this this has gotten a lot nicer with a",
    "start": "3011589",
    "end": "3019599"
  },
  {
    "text": "feature called server-side apply which I like to call the Picard patch so what server-side apply lets you do is",
    "start": "3019599",
    "end": "3026650"
  },
  {
    "text": "it lets you declare the object in UML or Jason form and you just set the fields",
    "start": "3026650",
    "end": "3033880"
  },
  {
    "text": "that you care about and you always set all the fields that you care about and then you tell the API server make it so",
    "start": "3033880",
    "end": "3040990"
  },
  {
    "text": "and the API server figures out what changes if any need to be made to the",
    "start": "3040990",
    "end": "3046900"
  },
  {
    "text": "actual object and this allows multiple writers to make their changes and just",
    "start": "3046900",
    "end": "3052570"
  },
  {
    "text": "say ensure it's the way I want it without stomping over each other so here even if say the service",
    "start": "3052570",
    "end": "3059050"
  },
  {
    "text": "controller populates some more information or add some defaulting in even though we haven't specified that",
    "start": "3059050",
    "end": "3064960"
  },
  {
    "text": "defaulting we're just constructing it from scratch every time we won't clobber out those changes and so you can kind of",
    "start": "3064960",
    "end": "3073210"
  },
  {
    "text": "see this go code almost just looks like we've written kubernetes Hamill and go and that's basically because we have",
    "start": "3073210",
    "end": "3079390"
  },
  {
    "text": "it's very similar to how cube cut' all apply works but way more powerful because multiple",
    "start": "3079390",
    "end": "3084420"
  },
  {
    "text": "writers can do it and it's on the server so we don't need any special logic client-side view one other thing that",
    "start": "3084420",
    "end": "3090660"
  },
  {
    "text": "we're doing here is we're setting an owner reference this does two things the first is that when we delete our",
    "start": "3090660",
    "end": "3097529"
  },
  {
    "text": "root guestbook object it'll make sure that our service and deployment are also cleaned up this is called garbage",
    "start": "3097529",
    "end": "3103349"
  },
  {
    "text": "collection in kubernetes if you want to google for more information about it the other thing it does is a little bit",
    "start": "3103349",
    "end": "3110190"
  },
  {
    "text": "later on when we go to wire up our reconciler so that it's actually called it let's our controller machinery know",
    "start": "3110190",
    "end": "3118670"
  },
  {
    "text": "when you see changes for this deployment it's actually we need to be reconciled",
    "start": "3118670",
    "end": "3126710"
  },
  {
    "text": "instance the other one here is pretty similar it's how we construct our status",
    "start": "3126710",
    "end": "3133200"
  },
  {
    "text": "information you can just see we load the service we set some fields we always set",
    "start": "3133200",
    "end": "3139170"
  },
  {
    "text": "the value so if we don't have any information we explicitly say that and if we do we say that okay",
    "start": "3139170",
    "end": "3146609"
  },
  {
    "text": "so now we just need some wiring we need to tell it when to run we have our logic in place but it's not gonna do anything",
    "start": "3146609",
    "end": "3153769"
  },
  {
    "text": "so when we talk about wiring kubernetes controllers we talk about relationships",
    "start": "3153769",
    "end": "3160140"
  },
  {
    "text": "between objects so each controller is",
    "start": "3160140",
    "end": "3165200"
  },
  {
    "text": "for a single kind it can have other kinds that it cares about but there's",
    "start": "3165200",
    "end": "3172019"
  },
  {
    "text": "this kind of route kind that the reconciler functions in terms of and so our case for a guestbook controller the",
    "start": "3172019",
    "end": "3178410"
  },
  {
    "text": "route kind as you may have guessed from the name is guestbook and then we talked about two types of relationships one is",
    "start": "3178410",
    "end": "3185400"
  },
  {
    "text": "a very common relationship and that's the owns relationship this is for objects we create so we define that",
    "start": "3185400",
    "end": "3192450"
  },
  {
    "text": "relationship in terms of that owner reference that we just set and then there's another relationship which is",
    "start": "3192450",
    "end": "3197759"
  },
  {
    "text": "more free form called watches this is for objects we didn't create we probably don't modify but we do care about some",
    "start": "3197759",
    "end": "3205140"
  },
  {
    "text": "values in them so in the case of our guestbook if we flip back a couple slides we can see that we pull",
    "start": "3205140",
    "end": "3211470"
  },
  {
    "text": "information specifically we pull up we actually don't have we'll see",
    "start": "3211470",
    "end": "3220440"
  },
  {
    "text": "in a moment we pull information for constructing our deployment that was just the service from the Redis status",
    "start": "3220440",
    "end": "3228900"
  },
  {
    "text": "so we care when the Reta status changes because if it changes service names we",
    "start": "3228900",
    "end": "3234170"
  },
  {
    "text": "need to know so we can update our deployment configuration so we say that guestbook watches Redis alright so what",
    "start": "3234170",
    "end": "3242730"
  },
  {
    "text": "does this look like in terms of code practically so you can see basically our",
    "start": "3242730",
    "end": "3248550"
  },
  {
    "text": "reconcile our logic goes in this method called reconcile that implements the reconciler interface basically what we",
    "start": "3248550",
    "end": "3256140"
  },
  {
    "text": "saw before is everything in the reconciler the only difference is we set up some context and logging information",
    "start": "3256140",
    "end": "3262350"
  },
  {
    "text": "just so that we can see what's going on and then we put all of that log code that we just wrote in the middle here",
    "start": "3262350",
    "end": "3268790"
  },
  {
    "text": "should look fairly familiar all right and then we need to register that",
    "start": "3268790",
    "end": "3275220"
  },
  {
    "text": "reconciler with a controller that knows how to trigger it so we say we want to",
    "start": "3275220",
    "end": "3281430"
  },
  {
    "text": "create a new controller managed by a manager the manager is just responsible for setting up watches and all the",
    "start": "3281430",
    "end": "3288990"
  },
  {
    "text": "boilerplate and running our controllers and waiting for signal handlers all that like boring stuff that actually just we",
    "start": "3288990",
    "end": "3295680"
  },
  {
    "text": "don't really care about what we need to do for everything and then we say that this controller is for guestbooks",
    "start": "3295680",
    "end": "3302460"
  },
  {
    "text": "it owns services and deployments just like we talked about and it watches Redis instances now watches as you can",
    "start": "3302460",
    "end": "3309930"
  },
  {
    "text": "see is a bit more involved because it's an arbitrary relationship we need to specify what that relationship is and we",
    "start": "3309930",
    "end": "3317370"
  },
  {
    "text": "do that using a mapping function now the mapping function needs to be able to map",
    "start": "3317370",
    "end": "3322620"
  },
  {
    "text": "from a Redis instance back up to a guestbook and so to do that we need to",
    "start": "3322620",
    "end": "3328080"
  },
  {
    "text": "be able to quickly look up what guestbooks reference particular reticent sense and so we do that by setting in",
    "start": "3328080",
    "end": "3334890"
  },
  {
    "text": "index you can see this index is pretty simple basically we just say what is the",
    "start": "3334890",
    "end": "3340320"
  },
  {
    "text": "Redis name and then we index on the Redis name well see we'll use that in a moment in our mapping function so the",
    "start": "3340320",
    "end": "3346950"
  },
  {
    "text": "mapping function is also pretty straightforward basically the meat is this function",
    "start": "3346950",
    "end": "3352680"
  },
  {
    "text": "right here so all we're doing is we're saying given some particular Redis",
    "start": "3352680",
    "end": "3359400"
  },
  {
    "text": "instance list all of the guest books but",
    "start": "3359400",
    "end": "3365780"
  },
  {
    "text": "filter on that index we just set up so that we only get the guest books that",
    "start": "3365780",
    "end": "3371220"
  },
  {
    "text": "match that have spec dot Redis name as whatever the thing we're reconciling is",
    "start": "3371220",
    "end": "3378260"
  },
  {
    "text": "and then once we get all the guest books we just convert them into these reconcile requests and all that is is",
    "start": "3378260",
    "end": "3384870"
  },
  {
    "text": "just a name in the namespace so all we do is we go through each of the guest books we pull out the name of the namespace and we put it into this",
    "start": "3384870",
    "end": "3392820"
  },
  {
    "text": "reconcile request object and we return it and then our controller pushes all those onto the queue to get reconciled",
    "start": "3392820",
    "end": "3400640"
  },
  {
    "text": "all right so that was a lot so we're",
    "start": "3400640",
    "end": "3406920"
  },
  {
    "text": "gonna actually try that out now what I'd recommend is that you copy and paste",
    "start": "3406920",
    "end": "3413310"
  },
  {
    "text": "that from the completed repo you totally can take the contents in the",
    "start": "3413310",
    "end": "3419520"
  },
  {
    "text": "presentation and copy them in or write it out by hand but I'm assuming most of you like me are a little bit lazy and",
    "start": "3419520",
    "end": "3425790"
  },
  {
    "text": "wouldn't want to type all of that deployment go object out so I would recommend copying and pasting it and",
    "start": "3425790",
    "end": "3432450"
  },
  {
    "text": "then when once we've done that we can do we can run make run and that will run",
    "start": "3432450",
    "end": "3438240"
  },
  {
    "text": "the controller locally against our remote cluster this is super useful for",
    "start": "3438240",
    "end": "3443790"
  },
  {
    "text": "dev test cycles because we don't have to bundle it into a docker image and then deploy it on the cluster wait for it to",
    "start": "3443790",
    "end": "3449820"
  },
  {
    "text": "deploy and we can even do stuff like run it under Dell to debug if something goes terribly wrong so we're just going to",
    "start": "3449820",
    "end": "3456330"
  },
  {
    "text": "try that out so I am going to go and copy over the code myself and then I'll",
    "start": "3456330",
    "end": "3462570"
  },
  {
    "text": "come down and answer questions from y'all",
    "start": "3462570",
    "end": "3466580"
  },
  {
    "text": "yes sorry about that - remember what the",
    "start": "3479910",
    "end": "3487979"
  },
  {
    "text": "directory was called okay cool all right",
    "start": "3487979",
    "end": "3498019"
  },
  {
    "text": "let me make that bigger cool so I'm just",
    "start": "3498019",
    "end": "3503880"
  },
  {
    "text": "going to go into controllers here and we see we have this guestbook controller",
    "start": "3503880",
    "end": "3509599"
  },
  {
    "text": "and it kind of looks like what we just saw we have this empty reconciler so I'm",
    "start": "3509599",
    "end": "3514859"
  },
  {
    "text": "gonna split with the completed one and",
    "start": "3514859",
    "end": "3520400"
  },
  {
    "text": "we're gonna grab the complete controller which is effectively just what we went",
    "start": "3520400",
    "end": "3528180"
  },
  {
    "text": "over before all right I ignore some of",
    "start": "3528180",
    "end": "3533489"
  },
  {
    "text": "this extra stuff on top we'll talk about that in a bit I'm just going to copy go over of the",
    "start": "3533489",
    "end": "3541739"
  },
  {
    "text": "internals of this scaffolding here copy all of this stuff which is just what we",
    "start": "3541739",
    "end": "3547140"
  },
  {
    "text": "saw exactly and I'll paste it back in here and then same thing with our setup",
    "start": "3547140",
    "end": "3558420"
  },
  {
    "text": "here and I've actually moved that help",
    "start": "3558420",
    "end": "3563819"
  },
  {
    "text": "those helpers that we saw out into their own file just for organization purposes",
    "start": "3563819",
    "end": "3570289"
  },
  {
    "text": "so I'm going to copy that over we're also going to need all of the core API",
    "start": "3570619",
    "end": "3577140"
  },
  {
    "text": "types that we referenced so let's put those in place - right",
    "start": "3577140",
    "end": "3585660"
  },
  {
    "text": "so basically these two are the kubernetes api types for deployment and service and these three are the bits",
    "start": "3585660",
    "end": "3594210"
  },
  {
    "text": "that we need for writing that watches relationship all this says go doc so if",
    "start": "3594210",
    "end": "3601859"
  },
  {
    "text": "you're interested you can go and look at the go doc as well it's at Godot org so",
    "start": "3601859",
    "end": "3608039"
  },
  {
    "text": "I SIG's a kate's that I have slash controller runtime there's a link at the end of the slides too",
    "start": "3608039",
    "end": "3613329"
  },
  {
    "text": "all right so this is currently going to complain if I had to guess that we don't",
    "start": "3613329",
    "end": "3619249"
  },
  {
    "text": "have any of these helper methods and we don't have a Redis instance so I'm going",
    "start": "3619249",
    "end": "3624529"
  },
  {
    "text": "to really quickly create the reticence since - I'm gonna copy that over I",
    "start": "3624529",
    "end": "3629769"
  },
  {
    "text": "forgot to do that earlier beats",
    "start": "3629769",
    "end": "3636910"
  },
  {
    "text": "that'ss - version the one - - group web",
    "start": "3646760",
    "end": "3653370"
  },
  {
    "text": "app just like we did know just like we",
    "start": "3653370",
    "end": "3660510"
  },
  {
    "text": "did for our guestbook it's gonna complain then I'm gonna copy over all",
    "start": "3660510",
    "end": "3666530"
  },
  {
    "text": "the stuff that we're missing and then",
    "start": "3666530",
    "end": "3676830"
  },
  {
    "text": "we'll copy over that helpers file which is exactly the code that we just talked about under controllers cool and so now",
    "start": "3676830",
    "end": "3695600"
  },
  {
    "text": "if any luck hey Rach look we should be",
    "start": "3695600",
    "end": "3705240"
  },
  {
    "text": "able to do make run",
    "start": "3705240",
    "end": "3708500"
  },
  {
    "text": "let's regenerate for",
    "start": "3712270",
    "end": "3715830"
  },
  {
    "text": "yeah that's why sorry copied some stuff incorrectly let's fix that fix that up",
    "start": "3727280",
    "end": "3734839"
  },
  {
    "text": "perils of live coding right so we called",
    "start": "3734839",
    "end": "3743880"
  },
  {
    "text": "this Q con instead of workshop code and the this version so we just need to make",
    "start": "3743880",
    "end": "3749760"
  },
  {
    "text": "this cube con right let's try that again",
    "start": "3749760",
    "end": "3757800"
  },
  {
    "text": "cool so we'll install our Redis CRD as well since we have it I haven't done",
    "start": "3757800",
    "end": "3764760"
  },
  {
    "text": "that yet I don't know if any of you have but I haven't done it well make sure",
    "start": "3764760",
    "end": "3771660"
  },
  {
    "text": "cube cuddle is on my path and then we'll do that cool now we should be able to",
    "start": "3771660",
    "end": "3777660"
  },
  {
    "text": "connect run",
    "start": "3777660",
    "end": "3780140"
  },
  {
    "text": "aha we can see we've got this log line that says successfully reconciled our",
    "start": "3782900",
    "end": "3790190"
  },
  {
    "text": "guestbook controller so we have a running controller for guest bucks a",
    "start": "3790190",
    "end": "3798589"
  },
  {
    "text": "little bit later there's also code in the repo for the Redis controller I did",
    "start": "3798589",
    "end": "3805859"
  },
  {
    "text": "not cover it in the presentation because it looks almost exactly the same as the guestbook controller instead of creating",
    "start": "3805859",
    "end": "3811619"
  },
  {
    "text": "one deployment in service we create two deployments and services that's basically it",
    "start": "3811619",
    "end": "3818210"
  },
  {
    "text": "alright so let's take a look at the time cool I'm gonna give you all some time to",
    "start": "3818210",
    "end": "3826440"
  },
  {
    "text": "try this out if you are confused or unclear about anything or something's",
    "start": "3826440",
    "end": "3831510"
  },
  {
    "text": "not working as always raise your hands",
    "start": "3831510",
    "end": "3836930"
  },
  {
    "text": "we just turn it",
    "start": "3840270",
    "end": "3844319"
  },
  {
    "text": "just to reiterate if you're looking at the complete repository you'll also see those Redis types I just mentioned and",
    "start": "3958130",
    "end": "3965030"
  },
  {
    "text": "the Redis controller so for the final full working thing you'll also need the",
    "start": "3965030",
    "end": "3971030"
  },
  {
    "text": "Redis controller if you've got the guestbook controller up and running and",
    "start": "3971030",
    "end": "3976310"
  },
  {
    "text": "you're curious you can look at the Redis controller but it should look very very",
    "start": "3976310",
    "end": "3981860"
  },
  {
    "text": "very similar to the guestbook controller we walk through we create two deployments one for the leader one for",
    "start": "3981860",
    "end": "3989210"
  },
  {
    "text": "the followers we create two services one for the leader one for the followers and then we write down the leader and",
    "start": "3989210",
    "end": "3996260"
  },
  {
    "text": "follower service names in our status",
    "start": "3996260",
    "end": "4000150"
  },
  {
    "text": "but again if you're getting that error with like wrong number of arguments and",
    "start": "4016750",
    "end": "4022450"
  },
  {
    "text": "watch it's basically due to pulling to new of her version of client go so if",
    "start": "4022450",
    "end": "4029650"
  },
  {
    "text": "you go into your Godot mod you should see a number of lines that start with just cait's dot IO it should be API",
    "start": "4029650",
    "end": "4036010"
  },
  {
    "text": "machinery and client go and API if you just delete those and then run make run",
    "start": "4036010",
    "end": "4042150"
  },
  {
    "text": "go we'll reevaluate the dependency graph and find the right versions",
    "start": "4042150",
    "end": "4048930"
  },
  {
    "text": "this is actually a good point to bring up so modifying our controller does not",
    "start": "4076200",
    "end": "4082950"
  },
  {
    "text": "change our CRD definition so once you",
    "start": "4082950",
    "end": "4087960"
  },
  {
    "text": "add the Redis types in the only thing you need to reinstall hold on is the",
    "start": "4087960",
    "end": "4095180"
  },
  {
    "text": "Redis types the guestbook types haven't changed from when we generated them before even though we've changed the",
    "start": "4095180",
    "end": "4105650"
  },
  {
    "text": "controller itself the controller does not affect the CRD types",
    "start": "4105650",
    "end": "4112339"
  },
  {
    "text": "and one other note if you are running in kind do system last-minute changes that",
    "start": "4127030",
    "end": "4135250"
  },
  {
    "text": "URL is not going to show up because it's waiting to see a load balance service so",
    "start": "4135250",
    "end": "4141400"
  },
  {
    "text": "we could and I will if you want if we have time modify the service status code",
    "start": "4141400",
    "end": "4147310"
  },
  {
    "text": "to instead of looking for a load balancer vez or waiting for a load balancer vez just do a normal service",
    "start": "4147310",
    "end": "4152980"
  },
  {
    "text": "and put say the kubernetes api prefix in there instead but it's basically the",
    "start": "4152980",
    "end": "4160060"
  },
  {
    "text": "same premise",
    "start": "4160060",
    "end": "4162690"
  },
  {
    "text": "as a quick as a quick show of hands for a status check how many of you have",
    "start": "4185890",
    "end": "4192250"
  },
  {
    "text": "gotten make run running right how many",
    "start": "4192250",
    "end": "4197410"
  },
  {
    "text": "of you are still copying code how many of you have not gotten to this slides",
    "start": "4197410",
    "end": "4205300"
  },
  {
    "text": "point yet and are still trying to work out stuff from the last pause okay and",
    "start": "4205300",
    "end": "4212380"
  },
  {
    "text": "last but not least how many of you are encountering issues with make run cool",
    "start": "4212380",
    "end": "4219790"
  },
  {
    "text": "all right I will try to come around if you have issues with make run especially",
    "start": "4219790",
    "end": "4226470"
  },
  {
    "text": "raise your hand male to try to come around and figure out what they are and hopefully we can take care of some",
    "start": "4226470",
    "end": "4231970"
  },
  {
    "text": "issues for the group",
    "start": "4231970",
    "end": "4234720"
  },
  {
    "text": "so if you are running locally you are docker pulling over a conference Wi-Fi",
    "start": "4278479",
    "end": "4284929"
  },
  {
    "text": "on your cluster this may take a while",
    "start": "4284929",
    "end": "4290769"
  },
  {
    "text": "yes you should see a deployment all right",
    "start": "4290769",
    "end": "4297039"
  },
  {
    "text": "okay so if you copy code over from the completed workshop make sure you change",
    "start": "4588280",
    "end": "4594070"
  },
  {
    "text": "the import path so like my import path for the example workshop code was",
    "start": "4594070",
    "end": "4602040"
  },
  {
    "text": "workshop - code as the base but if you did go mod in it mycube con you're gonna",
    "start": "4602040",
    "end": "4609220"
  },
  {
    "text": "have to replace workshop - code with my cube con for instance",
    "start": "4609220",
    "end": "4617310"
  },
  {
    "text": "for those of you who are not seeing a",
    "start": "4660699",
    "end": "4666540"
  },
  {
    "text": "set of deployments as I am we have a",
    "start": "4666540",
    "end": "4671679"
  },
  {
    "text": "quick for this and this is cuz I was lazy and did not add sufficient logging to my controller so this is a",
    "start": "4671679",
    "end": "4679060"
  },
  {
    "text": "lesson to y'all make sure you have good instrumentation so let's uh let's figure",
    "start": "4679060",
    "end": "4692290"
  },
  {
    "text": "this out this is a good good learning opportunity so if something's going wrong in our guestbook controllers it's",
    "start": "4692290",
    "end": "4699370"
  },
  {
    "text": "not creating our deployments I'm going off the script here let's hope it works",
    "start": "4699370",
    "end": "4705179"
  },
  {
    "text": "alright so something's gone wrong so the first thing we probably want to do is we want",
    "start": "4705179",
    "end": "4711670"
  },
  {
    "text": "to add some logging so let's do this we'll say got Redis now I'm cheating a",
    "start": "4711670",
    "end": "4719140"
  },
  {
    "text": "little bit because I have a very strong idea of what's going wrong wrong and then we'll give a controller runtime",
    "start": "4719140",
    "end": "4726520"
  },
  {
    "text": "uses structured logging by default so we can cast key value pairs after our message so in this case we're gonna say",
    "start": "4726520",
    "end": "4733239"
  },
  {
    "text": "got Redis and then we'll give the Redis name so Redis name like that alright so",
    "start": "4733239",
    "end": "4739360"
  },
  {
    "text": "now we're gonna run make run again and we should see that we don't actually see",
    "start": "4739360",
    "end": "4746980"
  },
  {
    "text": "got Redis alright so I had to guess",
    "start": "4746980",
    "end": "4755820"
  },
  {
    "text": "or we got an empty rebus so let's try that again I'm guessing that we're",
    "start": "4761500",
    "end": "4773090"
  },
  {
    "text": "hitting an error there yeah see there we go didn't guy read us and that's cuz we",
    "start": "4773090",
    "end": "4780740"
  },
  {
    "text": "never created a reticence since whoops so let's edit our Redis sample",
    "start": "4780740",
    "end": "4789940"
  },
  {
    "text": "there we go that was rather quick all we did is set the follower replicas to one I think we set a default for that by",
    "start": "4796249",
    "end": "4803300"
  },
  {
    "text": "default so we didn't even need to do that but we'll do it and then we're gonna do all right let's try that again",
    "start": "4803300",
    "end": "4817599"
  },
  {
    "text": "and in fact you should",
    "start": "4817599",
    "end": "4823960"
  },
  {
    "text": "there we go so we see we got this got reddest line and we can actually see this is kind of cool with our structured",
    "start": "4830610",
    "end": "4836700"
  },
  {
    "text": "logging we have these key value pairs here and we see the ret we got the Redis ready seam so let's try that again tada",
    "start": "4836700",
    "end": "4850370"
  },
  {
    "text": "alright we actually have something that works now cool so I'm going to move on",
    "start": "4850370",
    "end": "4863390"
  },
  {
    "text": "because we're running a little bit low on time and then it's a very end I'll be",
    "start": "4863390",
    "end": "4868650"
  },
  {
    "text": "happy to come around and help anyone else who's still having issues all right",
    "start": "4868650",
    "end": "4874530"
  },
  {
    "text": "so before we are done we need to talk",
    "start": "4874530",
    "end": "4879780"
  },
  {
    "text": "about how to package this up and run it on the cluster so there's two things we",
    "start": "4879780",
    "end": "4884820"
  },
  {
    "text": "need to talk about and the first of which is permissions so right now I'm guessing y'all are running the",
    "start": "4884820",
    "end": "4891090"
  },
  {
    "text": "controller as cluster admin this is not great do not run all of your controllers as",
    "start": "4891090",
    "end": "4897180"
  },
  {
    "text": "cluster admin I can safely say this without being a security person so the",
    "start": "4897180",
    "end": "4904020"
  },
  {
    "text": "way we control permissions in kubernetes is generally through something called our back role based access control our",
    "start": "4904020",
    "end": "4911220"
  },
  {
    "text": "back functions in terms of roles as you might have guessed and bindings of users",
    "start": "4911220",
    "end": "4916230"
  },
  {
    "text": "to those roles so by defaults we generate a role binding that binds the",
    "start": "4916230",
    "end": "4921960"
  },
  {
    "text": "default service account that's like a user for a controller in the namespace",
    "start": "4921960",
    "end": "4927870"
  },
  {
    "text": "we're running to this role that automatically gets created by queue builder queue builder scaffolds out",
    "start": "4927870",
    "end": "4935580"
  },
  {
    "text": "markers to generate rules for that robot for that role that let us read our own",
    "start": "4935580",
    "end": "4941700"
  },
  {
    "text": "types but since we're also reading and writing other types we need permissions to read those too so we'll add these two",
    "start": "4941700",
    "end": "4948330"
  },
  {
    "text": "markers in here so this one says for the group apps and the resource deployments",
    "start": "4948330",
    "end": "4955730"
  },
  {
    "text": "we're gonna allow lists watch so that's so we can list and watch and trigger",
    "start": "4955730",
    "end": "4961550"
  },
  {
    "text": "reconciliation yet so we can fetch and patch patches the",
    "start": "4961550",
    "end": "4968030"
  },
  {
    "text": "the underlying verb behind server side apply same thing with services we need",
    "start": "4968030",
    "end": "4973860"
  },
  {
    "text": "to get list watch and package so that'll generate these roles and then when we run make",
    "start": "4973860",
    "end": "4980639"
  },
  {
    "text": "manifest it will regenerate right so the other thing that we probably want to",
    "start": "4980639",
    "end": "4987300"
  },
  {
    "text": "talk about is running this properly so",
    "start": "4987300",
    "end": "4992780"
  },
  {
    "text": "cube builder scaffolds out make file rules to build and run your controller",
    "start": "4994219",
    "end": "5001099"
  },
  {
    "text": "as a container on the cluster as a deployment in fact so this first command here will actually",
    "start": "5001099",
    "end": "5008449"
  },
  {
    "text": "build all your go code and then it will",
    "start": "5008449",
    "end": "5013790"
  },
  {
    "text": "push it up to a registry so for those of you who have GCR or GCP accounts you can",
    "start": "5013790",
    "end": "5020059"
  },
  {
    "text": "push to GCR if you'd like so you got GCR slashed your project name slash and then",
    "start": "5020059",
    "end": "5028159"
  },
  {
    "text": "whatever you want and then we should be able to deploy and that'll just launch a",
    "start": "5028159",
    "end": "5036139"
  },
  {
    "text": "deployment on the cluster with that image that runs our controller and if all went rel well and we're running both",
    "start": "5036139",
    "end": "5043159"
  },
  {
    "text": "the reddest controller and the guestbooks controller we should actually have a functioning guestbook instance",
    "start": "5043159",
    "end": "5053230"
  },
  {
    "text": "alright so i'm going to switch back here",
    "start": "5053650",
    "end": "5058730"
  },
  {
    "text": "and just for quickness is sake i'm going",
    "start": "5058730",
    "end": "5063980"
  },
  {
    "text": "to switch to the complete one because that's got everything all set and then",
    "start": "5063980",
    "end": "5070659"
  },
  {
    "text": "i'm going to cheat a little bit",
    "start": "5070659",
    "end": "5075889"
  },
  {
    "text": "i don't actually want to do all these doc our operations in my laptop because",
    "start": "5075889",
    "end": "5080900"
  },
  {
    "text": "it's gonna be slow so i'm going to run them with Google cloud build which is",
    "start": "5080900",
    "end": "5090860"
  },
  {
    "text": "like docker builds but on GCP so well that's running I'm gonna come",
    "start": "5090860",
    "end": "5099969"
  },
  {
    "text": "around and see who else has questions right as a show of hands who were able",
    "start": "5099969",
    "end": "5107320"
  },
  {
    "text": "to who was able to run make run from the last step who's still stuck at like the",
    "start": "5107320",
    "end": "5113320"
  },
  {
    "text": "make run portion alright and who's stuck before the make run portion okay cool",
    "start": "5113320",
    "end": "5121329"
  },
  {
    "text": "hey keep your hands up and I will come",
    "start": "5121329",
    "end": "5126400"
  },
  {
    "text": "around to help out",
    "start": "5126400",
    "end": "5129119"
  },
  {
    "text": "under at this point you can basically just go to the end of the completed repo",
    "start": "5156050",
    "end": "5163010"
  },
  {
    "text": "so like where you originally cloned or you can go to that sha at the bottom",
    "start": "5163010",
    "end": "5168620"
  },
  {
    "text": "there but basically we're at the end at this point",
    "start": "5168620",
    "end": "5174880"
  },
  {
    "text": "anybody is all finished and wants to do some further reading or investigation",
    "start": "5247400",
    "end": "5252940"
  },
  {
    "text": "you can go to book Q builder dot IO and there's other tutorials there and",
    "start": "5252940",
    "end": "5259040"
  },
  {
    "text": "whatnot just in case any of you have to scoot now or whatever and want to see",
    "start": "5259040",
    "end": "5264470"
  },
  {
    "text": "that before I advance to the next slide",
    "start": "5264470",
    "end": "5268360"
  },
  {
    "text": "this were roughly out of time I'm happy to continue staying around helping people out but I figured I'd advance the",
    "start": "5565239",
    "end": "5572530"
  },
  {
    "text": "last slide there are some resources up here if y'all want to learn more and",
    "start": "5572530",
    "end": "5580270"
  },
  {
    "text": "thank you all for coming out",
    "start": "5580270",
    "end": "5583290"
  }
]