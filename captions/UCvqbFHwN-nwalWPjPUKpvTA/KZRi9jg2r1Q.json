[
  {
    "text": "hi everyone thanks for joining um um I want to talk quickly",
    "start": "640",
    "end": "7920"
  },
  {
    "text": "about scaling cluster operators Beyond boundaries that is you know",
    "start": "7920",
    "end": "15040"
  },
  {
    "text": "single cluster boundry AKA we call it as a multicluster controller so this is more about tick tok's journey of how we",
    "start": "15040",
    "end": "24480"
  },
  {
    "text": "implemented multicluster controllers um and also like why we ended up",
    "start": "24480",
    "end": "30920"
  },
  {
    "text": "building multicluster controllers in the first place so by the way my name is nain nain Mula I'm a tech lead with Tik",
    "start": "30920",
    "end": "38239"
  },
  {
    "text": "Tok at Edge platform team so let me give a little bit of",
    "start": "38239",
    "end": "44280"
  },
  {
    "text": "introduction about my team first uh so I'm part of the edge platform team and we are responsible for infrastructure",
    "start": "44280",
    "end": "52239"
  },
  {
    "text": "for all the edge use cases that is you know CDN type of workloads live",
    "start": "52239",
    "end": "58120"
  },
  {
    "text": "streaming realtime Communications upload etc etc so we basically decided",
    "start": "58120",
    "end": "65640"
  },
  {
    "text": "to use kubernetes um on all of these we call it as a point of presence uh we",
    "start": "65640",
    "end": "72400"
  },
  {
    "text": "have around 250 to 300 Global clusters so we use this tiny data centers and we",
    "start": "72400",
    "end": "78560"
  },
  {
    "text": "build kubernetes on top of it and we provide it as a platform to internal",
    "start": "78560",
    "end": "83720"
  },
  {
    "text": "engineering teams uh that is Tik Tok CDN team Tik Tok live you know upload team",
    "start": "83720",
    "end": "88840"
  },
  {
    "text": "and all of those guys so um there are around 250 to 300",
    "start": "88840",
    "end": "95000"
  },
  {
    "text": "kubernetes clusters across the globe whenever I say Globe uh consider in this presentation it has a globe minus China",
    "start": "95000",
    "end": "102720"
  },
  {
    "text": "it's non-china um in a Tik Tok so and the important thing here I want",
    "start": "102720",
    "end": "109960"
  },
  {
    "text": "to just talk about is these are Edge clusters not main dat",
    "start": "109960",
    "end": "116039"
  },
  {
    "text": "as inter inter clusters so some of these clusters are very tiny like could be as minimum as like",
    "start": "116039",
    "end": "122360"
  },
  {
    "text": "10 you know nodes to all the way to you know we have around 600 700 nodes so uh",
    "start": "122360",
    "end": "128959"
  },
  {
    "text": "all of these are kubernetes clusters you know somewhere between like I I seen 10",
    "start": "128959",
    "end": "134360"
  },
  {
    "text": "node clusters and we have seen multiple 600 nodes based on the demand you know",
    "start": "134360",
    "end": "139720"
  },
  {
    "text": "based on the popularity of geolocations or whatnot so all these um clusters have",
    "start": "139720",
    "end": "145120"
  },
  {
    "text": "variety range of nodes and obviously uh the other one uh you know it's",
    "start": "145120",
    "end": "150599"
  },
  {
    "text": "predominantly um we are in bare metal infrastructure business rather than the cloud business because of you know",
    "start": "150599",
    "end": "156959"
  },
  {
    "text": "obvious reasons uh Tik Tok bandwidth uh you know uh transaction volume or",
    "start": "156959",
    "end": "162200"
  },
  {
    "text": "whatnot so it's going to be way too expensive in the cloud so we have our own point of presence across the globe",
    "start": "162200",
    "end": "169400"
  },
  {
    "text": "but we started exploring the cloud wherever it's possible uh you know we have presence in GK we have presence in",
    "start": "169400",
    "end": "177239"
  },
  {
    "text": "eks OK you know uh across all these places um in high level we have the you",
    "start": "177239",
    "end": "184280"
  },
  {
    "text": "know control plane and data plane clusters so data plane is more like where the actual um user workloads like",
    "start": "184280",
    "end": "191760"
  },
  {
    "text": "when I say User it's more like Tik Tok CDN team or you know other teams they workloads are deployed on these data",
    "start": "191760",
    "end": "197319"
  },
  {
    "text": "plane clusters and control plane is where you know our platform Services uh sets and we use that to manage all these",
    "start": "197319",
    "end": "205280"
  },
  {
    "text": "data plane clusters um one other thing one talk about it's like obviously like any other",
    "start": "205280",
    "end": "212360"
  },
  {
    "text": "platform team um we just not install these vanilla cubet clusters across the globe you know across these locations",
    "start": "212360",
    "end": "219200"
  },
  {
    "text": "and provideed as a platform but we obviously provide some essential features like logs metrics config secret",
    "start": "219200",
    "end": "227239"
  },
  {
    "text": "management you know all of these essential features so um yeah so platform features like",
    "start": "227239",
    "end": "234720"
  },
  {
    "text": "metrics config C management and we have you know internal uh Services as well we",
    "start": "234720",
    "end": "239760"
  },
  {
    "text": "proved as a platform like anytime you create anything probably creates an incident and all of these platform",
    "start": "239760",
    "end": "245319"
  },
  {
    "text": "features are provided by our team I want to talk a little bit about",
    "start": "245319",
    "end": "250680"
  },
  {
    "text": "you know since we're talking about the operators we want to talk a little bit about the operators here so um one of",
    "start": "250680",
    "end": "257040"
  },
  {
    "text": "them is like I said whenever it's not just a kubernetes uh you know vanilla clusters we're going to provide these",
    "start": "257040",
    "end": "263320"
  },
  {
    "text": "platform features which basically at the end of the day those features gets turned into operat ators like logs",
    "start": "263320",
    "end": "271120"
  },
  {
    "text": "metrics you know whatever all of these things and operators basically play key",
    "start": "271120",
    "end": "276199"
  },
  {
    "text": "role uh for platform team to platform team to provide these uh",
    "start": "276199",
    "end": "281440"
  },
  {
    "text": "features uh obviously if if it's already available in open source we basically just reuse those things we're not going",
    "start": "281440",
    "end": "288000"
  },
  {
    "text": "to reinvent any you know anything instead we just you know take the open source components as is and we deploy it",
    "start": "288000",
    "end": "294080"
  },
  {
    "text": "across all these clusters um obviously in the last two three years because of",
    "start": "294080",
    "end": "300080"
  },
  {
    "text": "the Tik toac grow of Ward so we have seen a lot of um you know more and more",
    "start": "300080",
    "end": "306160"
  },
  {
    "text": "platform feature requests came in from the you know user teams and obviously our team also grew and anytime a",
    "start": "306160",
    "end": "313120"
  },
  {
    "text": "platform feature comes in that basically turns into an operator so more and more",
    "start": "313120",
    "end": "318319"
  },
  {
    "text": "operators and the need of more operators basically started increasing um the other one uh is",
    "start": "318319",
    "end": "325280"
  },
  {
    "text": "complex workflow so whenever you want to deploy this operator across this 300 clusters you know you're going to have",
    "start": "325280",
    "end": "331400"
  },
  {
    "text": "to deal with go ahead and create the name spaces resource Coda uh Network",
    "start": "331400",
    "end": "336479"
  },
  {
    "text": "policies and you know if you're using gith UPS to deploy these things you're probably dealing with customization",
    "start": "336479",
    "end": "343120"
  },
  {
    "text": "you're basically adding more and more overlays or whatat to you know for each and every specific cluster to deploy",
    "start": "343120",
    "end": "349720"
  },
  {
    "text": "this operators uh into kubernetes cluster so uh another thing if you're",
    "start": "349720",
    "end": "357639"
  },
  {
    "text": "not into Edge ecosystem so I've been in the cubers ecosystem for the last five or six years before Tik Tok you know I",
    "start": "357639",
    "end": "364240"
  },
  {
    "text": "was mainly working on the main data center once where you know you may have you know 10 or 15 clusters which you",
    "start": "364240",
    "end": "371520"
  },
  {
    "text": "know 10,000 notes or 15,000 noes mostly if you're in cloud provider you're",
    "start": "371520",
    "end": "377000"
  },
  {
    "text": "probably using ASG which uh CL cluster Auto scaler which can scale up scale down but in our case I know like I said",
    "start": "377000",
    "end": "386080"
  },
  {
    "text": "we we are in more of a physical uh infrastructure business this basically",
    "start": "386080",
    "end": "391240"
  },
  {
    "text": "means that anytime you need extra you know resources like a server you know a",
    "start": "391240",
    "end": "396360"
  },
  {
    "text": "couple of more servers it's not just a straightforward thing it could take sometimes days weeks sometimes months",
    "start": "396360",
    "end": "402840"
  },
  {
    "text": "you know depends on the logistics so there is a limited resources constraint",
    "start": "402840",
    "end": "408080"
  },
  {
    "text": "in um you know Edge Edge ecosystem um obviously uh coming to the",
    "start": "408080",
    "end": "414000"
  },
  {
    "text": "platform featur so anytime we get more and more platform features that basically means that we",
    "start": "414000",
    "end": "420120"
  },
  {
    "text": "turning into operators and we have to deploy these operators which basically comes up with the cost it's already a",
    "start": "420120",
    "end": "427080"
  },
  {
    "text": "tiny resources resource constraint ecosystem and Tiny clusters and you",
    "start": "427080",
    "end": "433039"
  },
  {
    "text": "going to have to deploy your Edge uh in know your operators on these clusters and it's going to take up some",
    "start": "433039",
    "end": "439759"
  },
  {
    "text": "resources and on top of it we have you know some pretty good requirements",
    "start": "439759",
    "end": "445199"
  },
  {
    "text": "something like real-time processing where based on the response times on",
    "start": "445199",
    "end": "450360"
  },
  {
    "text": "these Edge clusters let's say you have two or three different Pops in the same geolocation and one of the pop is",
    "start": "450360",
    "end": "457479"
  },
  {
    "text": "probably responding within 2 milliseconds versus the other one is like 3 milliseconds so the routing team",
    "start": "457479",
    "end": "463560"
  },
  {
    "text": "GTM team uses that information to take the you know uh real time decisions in",
    "start": "463560",
    "end": "470120"
  },
  {
    "text": "terms of the routing for instead of pop one it probably goes to pop so for any",
    "start": "470120",
    "end": "475720"
  },
  {
    "text": "of these things you probably adding more and more operators and it takes making more and more resources on top of it so",
    "start": "475720",
    "end": "482680"
  },
  {
    "text": "The Balancing Act is like there are tiny clusters a lot of these application",
    "start": "482680",
    "end": "487840"
  },
  {
    "text": "teams want as many resources as possible on these tiny 10 or 15 or 100 nodes on",
    "start": "487840",
    "end": "494440"
  },
  {
    "text": "top of it you are getting more and more platform uh feature requests as well so",
    "start": "494440",
    "end": "499560"
  },
  {
    "text": "you're going to have to make some balance where you know at some point of time we were we used to say like hey 20%",
    "start": "499560",
    "end": "506120"
  },
  {
    "text": "of these resources are are reserved for plat team because we have lot of these",
    "start": "506120",
    "end": "512080"
  },
  {
    "text": "platform feature requests are coming and we have to sell and it it's probably not",
    "start": "512080",
    "end": "518080"
  },
  {
    "text": "going to go well with all the application teams because of obvious reasons they want to have more and more",
    "start": "518080",
    "end": "524159"
  },
  {
    "text": "resources so that they could serve a little bit more in these Edge locations and you know generate the revenue versus",
    "start": "524159",
    "end": "531560"
  },
  {
    "text": "uh you know we have our own reasons like hey you want more features it it is going to cost some resources",
    "start": "531560",
    "end": "538440"
  },
  {
    "text": "so like I think I kind of you know",
    "start": "538440",
    "end": "543959"
  },
  {
    "text": "summarized this thing in the previous chat you know previous thing so before multicluster controllers whenever the",
    "start": "543959",
    "end": "550480"
  },
  {
    "text": "request comes into to us and know as a new feature we basically convert that as a you know hey okay we're going to build",
    "start": "550480",
    "end": "556600"
  },
  {
    "text": "the operator for these kind of stuff so we build the operators the traditional approaches like you know use CU Builder",
    "start": "556600",
    "end": "562880"
  },
  {
    "text": "create an operator and go ahead and uh create these Nam spaces resource quoda and whatnot across all these 200 150 uh",
    "start": "562880",
    "end": "570600"
  },
  {
    "text": "300 clusters and start deploying those things but we more than you know a lot of the",
    "start": "570600",
    "end": "579399"
  },
  {
    "text": "times we run into these issues where some of these clusters are completely full like there's no capacity in some of",
    "start": "579399",
    "end": "586240"
  },
  {
    "text": "these clusters and you know a lot of these clusters may be reserved by you know CDN team or you know whatever the",
    "start": "586240",
    "end": "592640"
  },
  {
    "text": "application teams right so they Reserve this entire capacity and even today um",
    "start": "592640",
    "end": "598640"
  },
  {
    "text": "you're going to get into the situation where like you know hey you deserved 500 core CPU 1,000 core CPU but you're using",
    "start": "598640",
    "end": "606720"
  },
  {
    "text": "maybe 200 core or 300 core CPU that problem is not specific to our team and",
    "start": "606720",
    "end": "612399"
  },
  {
    "text": "not specific to Tik Tok I guess you know um even in my previous place as well the",
    "start": "612399",
    "end": "617560"
  },
  {
    "text": "same thing you know I was talking to Cloud providers yesterday you know uh",
    "start": "617560",
    "end": "622800"
  },
  {
    "text": "you aw folks as well as gcp they were also same thing hey we have seen this trend of where people",
    "start": "622800",
    "end": "630440"
  },
  {
    "text": "utilization is always less than 20 or 25% so this option is going to be always",
    "start": "630440",
    "end": "636880"
  },
  {
    "text": "there where we're going to work with the end users and trying to reclaim some of the resources to deploy platform",
    "start": "636880",
    "end": "643560"
  },
  {
    "text": "features that's was there that's that is there today as well that's going to be",
    "start": "643560",
    "end": "648800"
  },
  {
    "text": "there tomorrow as well we're going to have to continuously work with these guys to you know um you know efficiently",
    "start": "648800",
    "end": "654959"
  },
  {
    "text": "use these underlying resources but as an engineering point view from our point of",
    "start": "654959",
    "end": "660880"
  },
  {
    "text": "view what we want to do is like okay so for platform features or operators whenever you want to deploy it you",
    "start": "660880",
    "end": "669959"
  },
  {
    "text": "obviously on the resources side we can work with those guys but is there any other opportunities where we could",
    "start": "669959",
    "end": "675959"
  },
  {
    "text": "improve so that we don't have to consume resources in the edge clusters so that's",
    "start": "675959",
    "end": "683560"
  },
  {
    "text": "where we went to you know whiteboard and started looking at up you know what we",
    "start": "683560",
    "end": "688760"
  },
  {
    "text": "are using Cube Builder as a framework every time when we create in a controller so why don't we just take a",
    "start": "688760",
    "end": "694560"
  },
  {
    "text": "closer look at Cube Builder and see what we can do if there if there's any opportunities out there where we could",
    "start": "694560",
    "end": "701399"
  },
  {
    "text": "improve you know uh to not to utilize so many resources across all these Edge",
    "start": "701399",
    "end": "707519"
  },
  {
    "text": "clusters so if you look at on the left side you probably you know most of you might be aware of this architecture",
    "start": "707519",
    "end": "713800"
  },
  {
    "text": "diagram because it's been there in the cube Builder book for you know three or four five years so so in high level I",
    "start": "713800",
    "end": "720279"
  },
  {
    "text": "think I simplified it on the right side what do you see is you have one manager",
    "start": "720279",
    "end": "727200"
  },
  {
    "text": "which is basically provides the common functionalities such as client kubernetes client and you have the cache",
    "start": "727200",
    "end": "733800"
  },
  {
    "text": "that's more like you know informers and you you have controllers where you basically register with manager and it's",
    "start": "733800",
    "end": "742519"
  },
  {
    "text": "not one to one uh relationship one manager One controller but you can have multiple controllers in and and register",
    "start": "742519",
    "end": "750160"
  },
  {
    "text": "it with a manager so if you look at in high level it's it's pretty much basically anytime you're creating a",
    "start": "750160",
    "end": "758040"
  },
  {
    "text": "controller for specific your particular resource you basically register with Informer which is nothing but cash there",
    "start": "758040",
    "end": "764720"
  },
  {
    "text": "it builds the cash and once you get the cash you basically uh controller takes",
    "start": "764720",
    "end": "770320"
  },
  {
    "text": "those uh you know filters out those events based on predicate or whatever you want puts it in the queue uh a",
    "start": "770320",
    "end": "777199"
  },
  {
    "text": "worker item queue and the Recon is going to pick up those uh items one by one",
    "start": "777199",
    "end": "782279"
  },
  {
    "text": "from the queue and you know process it so in high level what we have seen when",
    "start": "782279",
    "end": "788880"
  },
  {
    "text": "we started looking at it is like Okay so this the problem is with the manager",
    "start": "788880",
    "end": "794240"
  },
  {
    "text": "where the manager is the one which is picking up the cube config from in",
    "start": "794240",
    "end": "799720"
  },
  {
    "text": "cluster and able to talk to API server so the boundary is one single cluster so",
    "start": "799720",
    "end": "807399"
  },
  {
    "text": "why don't we see if we can expand that option instead of",
    "start": "807399",
    "end": "812800"
  },
  {
    "text": "having man manager aware of one single cluster why don't we see if we can make",
    "start": "812800",
    "end": "819959"
  },
  {
    "text": "manager aware of multiple clusters so that's where you know where we have you",
    "start": "819959",
    "end": "826000"
  },
  {
    "text": "know what we started doing is if you look up on the right side we first started with the you know just a diagram",
    "start": "826000",
    "end": "832880"
  },
  {
    "text": "right okay what can we do let's bulk up the manager and have",
    "start": "832880",
    "end": "838759"
  },
  {
    "text": "mult multiple clients so that each and every client can talk to you know",
    "start": "838759",
    "end": "844360"
  },
  {
    "text": "respective API server and you can have you know multiple caches as well and the",
    "start": "844360",
    "end": "849759"
  },
  {
    "text": "same way you know a controller basically going to register with this U manager",
    "start": "849759",
    "end": "855079"
  },
  {
    "text": "and you know whenever controller wants to talk to Cluster one API server it goes and talk to client one that",
    "start": "855079",
    "end": "862480"
  },
  {
    "text": "basically talks to API server so on so in theoretically it was very good okay",
    "start": "862480",
    "end": "867720"
  },
  {
    "text": "so it was easy like you know but let's let's bulk up the manager to expand it",
    "start": "867720",
    "end": "872920"
  },
  {
    "text": "so that it can talk to more than one single cluster so what we have done is",
    "start": "872920",
    "end": "879399"
  },
  {
    "text": "we started taking Cube Builder as a reference you",
    "start": "879399",
    "end": "885240"
  },
  {
    "text": "know CU Builder code as a reference and then we started enhancing the",
    "start": "885240",
    "end": "890759"
  },
  {
    "text": "packages inside the cuq Builder so you have a you know controller component you",
    "start": "890759",
    "end": "896399"
  },
  {
    "text": "have a a cluster component consoler you know all of these packages inside the CU",
    "start": "896399",
    "end": "902639"
  },
  {
    "text": "Builder reference so we started modifying you know if you look at the uh CU Builder code you will see that you",
    "start": "902639",
    "end": "909320"
  },
  {
    "text": "know the struct uh the interfaces basically accepting only one client or",
    "start": "909320",
    "end": "914639"
  },
  {
    "text": "only one cluster so we Tred to like you know what let's just make it to accept",
    "start": "914639",
    "end": "920279"
  },
  {
    "text": "array of clusters array of clients array of caches so when we started doing that",
    "start": "920279",
    "end": "928000"
  },
  {
    "text": "it was all good good but we just went into the deep Rabbit Hole where we had",
    "start": "928000",
    "end": "934759"
  },
  {
    "text": "to change each and every component because if you're touching the top layer the you know when you change the",
    "start": "934759",
    "end": "940720"
  },
  {
    "text": "signature of the functions in the top layer you have to change the child as well because this is the one which is",
    "start": "940720",
    "end": "945959"
  },
  {
    "text": "calling the top layers so we ended up writing this beautiful code or the",
    "start": "945959",
    "end": "951440"
  },
  {
    "text": "complex code however you call it um and uh you know changed every component of",
    "start": "951440",
    "end": "958720"
  },
  {
    "text": "the you know all of these packages so the way we done is obviously like you",
    "start": "958720",
    "end": "963959"
  },
  {
    "text": "know on the left side left hand side you can see that Implement manager to be",
    "start": "963959",
    "end": "969199"
  },
  {
    "text": "aware of more than one single cluster and Implement controllers to be aware of",
    "start": "969199",
    "end": "975160"
  },
  {
    "text": "multiple caches and clients and start multiple caches instead of single cache",
    "start": "975160",
    "end": "981920"
  },
  {
    "text": "and you know start all the controllers at the end so that's more like the sequence of doing the things so but",
    "start": "981920",
    "end": "989560"
  },
  {
    "text": "in overall the idea is H instead of having these distributed operators",
    "start": "989560",
    "end": "995040"
  },
  {
    "text": "installed across all the Clusters why don't we do one single",
    "start": "995040",
    "end": "1000600"
  },
  {
    "text": "operator in the central cluster where we deployed in the cloud and we have this",
    "start": "1000600",
    "end": "1005800"
  },
  {
    "text": "flexibility of resources so why don't we do that in the central Hub and let's see",
    "start": "1005800",
    "end": "1011759"
  },
  {
    "text": "if it can do what it's supposed to do in all the Clusters so that's the idea and",
    "start": "1011759",
    "end": "1017800"
  },
  {
    "text": "we started working on and you know after good amount of you know code uh we're",
    "start": "1017800",
    "end": "1024199"
  },
  {
    "text": "able to get to a stage where you know it worked started saying like you know we",
    "start": "1024199",
    "end": "1030199"
  },
  {
    "text": "have you know when we started doing in a lower environments it was able to handle the things for the you know 20 or 25",
    "start": "1030199",
    "end": "1037199"
  },
  {
    "text": "different clusters uh whatever you want to do it in one single cluster you know it was able to watch the events uh",
    "start": "1037199",
    "end": "1044120"
  },
  {
    "text": "across all these clusters and start you know manipulating the changes whatever",
    "start": "1044120",
    "end": "1049360"
  },
  {
    "text": "you wanted to do for that particular cluster so in high level we went from",
    "start": "1049360",
    "end": "1056039"
  },
  {
    "text": "distributor operators deploying across all the Clusters creating name spaces working with other people",
    "start": "1056039",
    "end": "1064520"
  },
  {
    "text": "to one single operator in the central cluster and deploy it so that it can",
    "start": "1064520",
    "end": "1071799"
  },
  {
    "text": "actually access all the Clusters and it could do list and watch across all these clusters and perform the reconcilation",
    "start": "1071799",
    "end": "1078600"
  },
  {
    "text": "of whatever it needs to be done so it definitely helped in terms of the",
    "start": "1078600",
    "end": "1083760"
  },
  {
    "text": "deployment issues for us it definitely helped in terms of the troubleshooting where you know in Edge world when you",
    "start": "1083760",
    "end": "1090400"
  },
  {
    "text": "have 300 clusters if one of the cluster is down you got to go and you know get into that single cluster figure out",
    "start": "1090400",
    "end": "1096520"
  },
  {
    "text": "what's happening in that specific controller you know there's lot of specific things right networking issues",
    "start": "1096520",
    "end": "1102280"
  },
  {
    "text": "and whatnot so troubleshooting also helped U completely centralized into one",
    "start": "1102280",
    "end": "1107840"
  },
  {
    "text": "single place so that also helped for us um and like I said we don't have to",
    "start": "1107840",
    "end": "1113919"
  },
  {
    "text": "create Nam spaces resources or any of these things on across all the Clusters so that basically simplified and",
    "start": "1113919",
    "end": "1121600"
  },
  {
    "text": "everybody loved it but but during the",
    "start": "1121600",
    "end": "1127440"
  },
  {
    "text": "implementation so every time I create a PR every time I create a you know PR we",
    "start": "1127440",
    "end": "1133039"
  },
  {
    "text": "used to have lots of lots of discussions and lots of lots of comments on the pr",
    "start": "1133039",
    "end": "1138400"
  },
  {
    "text": "and that's for obvious good reasons because all of these Engineers as well",
    "start": "1138400",
    "end": "1143880"
  },
  {
    "text": "top class but none of them are exposed to the the underlying um you know",
    "start": "1143880",
    "end": "1150240"
  },
  {
    "text": "libraries itself right not many people are aware of controller runtime because",
    "start": "1150240",
    "end": "1155280"
  },
  {
    "text": "that's how much CU Builder and all of these Community is working towards to",
    "start": "1155280",
    "end": "1160840"
  },
  {
    "text": "hide all of these complexities under the rug so that people can just start writing controllers using these",
    "start": "1160840",
    "end": "1167240"
  },
  {
    "text": "Frameworks so whenever I started writing the pr you know building the you know creating the PRS and we used to have lot",
    "start": "1167240",
    "end": "1174840"
  },
  {
    "text": "of these conversations so I had to explain that okay so and so so and so so",
    "start": "1174840",
    "end": "1180240"
  },
  {
    "text": "that's when it hit us like okay the solution works but this is not going to",
    "start": "1180240",
    "end": "1187200"
  },
  {
    "text": "be scalable because now because of this one single reason where in a centralized",
    "start": "1187200",
    "end": "1193640"
  },
  {
    "text": "operator I need to make sure all of my Engineers all of the team need to aware",
    "start": "1193640",
    "end": "1199520"
  },
  {
    "text": "of underlying um you know libraries and all of the stuff",
    "start": "1199520",
    "end": "1205200"
  },
  {
    "text": "so and also obviously we you know because we were growing uh a lot uh",
    "start": "1205200",
    "end": "1210720"
  },
  {
    "text": "during that time uh new new Engineers were like hey what is this it's it's",
    "start": "1210720",
    "end": "1216559"
  },
  {
    "text": "taking a lot of time for them to onboard and adapt to this new frame you know new multicluster controllers whatever we",
    "start": "1216559",
    "end": "1222960"
  },
  {
    "text": "implemented from the scratch so uh like I said uh you know Community efforts",
    "start": "1222960",
    "end": "1230280"
  },
  {
    "text": "Community is working hard to hide these you know complexities so that people can",
    "start": "1230280",
    "end": "1235520"
  },
  {
    "text": "write in multiple controllers or you know lots of controllers but whatever the approach we have taken it actually",
    "start": "1235520",
    "end": "1241480"
  },
  {
    "text": "took it in a completely opposite direction where you know people need to Now understand what is controller what",
    "start": "1241480",
    "end": "1248080"
  },
  {
    "text": "is reconciler what is work right on Q what is caches what is you know all of",
    "start": "1248080",
    "end": "1253159"
  },
  {
    "text": "these things on L uh you know library items so um Balancing Act okay the",
    "start": "1253159",
    "end": "1260960"
  },
  {
    "text": "concept works because it helped us not to have distributed operators instead",
    "start": "1260960",
    "end": "1266159"
  },
  {
    "text": "one single operator is doing what it's supposed to do it across all the Clusters it reduce the resource issues",
    "start": "1266159",
    "end": "1272919"
  },
  {
    "text": "for us because we don't have to go and talk to four or five different teams like hey you reserved more resources can",
    "start": "1272919",
    "end": "1280039"
  },
  {
    "text": "you give us a little bit more can you give us so that we can deploy in know platform features um but also um you",
    "start": "1280039",
    "end": "1288320"
  },
  {
    "text": "know the on the other side is it's complex the complexity actually got",
    "start": "1288320",
    "end": "1294000"
  },
  {
    "text": "increased compared to our previous operators whatever we used to write so",
    "start": "1294000",
    "end": "1299360"
  },
  {
    "text": "what we want to do is The Balancing Act is like okay I want to use the concept",
    "start": "1299360",
    "end": "1304919"
  },
  {
    "text": "the centralized control plane concept having one single operator and one single centralized cluster",
    "start": "1304919",
    "end": "1312480"
  },
  {
    "text": "but try to see write the code in a way that it's closer to widely known",
    "start": "1312480",
    "end": "1318840"
  },
  {
    "text": "Frameworks whether it's a CU Builder or whether it's operator hdk whatever you know widely known operators right so",
    "start": "1318840",
    "end": "1326760"
  },
  {
    "text": "that's basically what we realized from this but also like you know the last",
    "start": "1326760",
    "end": "1333480"
  },
  {
    "text": "point is more like people can write or people can solve the problem many",
    "start": "1333480",
    "end": "1339039"
  },
  {
    "text": "different ways but at least the way um our culture you know in the team is more",
    "start": "1339039",
    "end": "1344640"
  },
  {
    "text": "like you basically code familiarity is more important than writing some complex code",
    "start": "1344640",
    "end": "1351720"
  },
  {
    "text": "and just be happy that hey I solve this problem you want as many people in your",
    "start": "1351720",
    "end": "1358080"
  },
  {
    "text": "team as possible understands your code so that they can also you know take it",
    "start": "1358080",
    "end": "1363840"
  },
  {
    "text": "Forward you're not going to be there forever so um someone else has to you know you know maintain that code at some",
    "start": "1363840",
    "end": "1369840"
  },
  {
    "text": "point of time so for that particular reason we basically ended up going back",
    "start": "1369840",
    "end": "1376120"
  },
  {
    "text": "to whiteboard again scratch andtie thing and start doing this thing like if you",
    "start": "1376120",
    "end": "1381320"
  },
  {
    "text": "look at these diagram whatever you see on this thing it's literally from the",
    "start": "1381320",
    "end": "1387480"
  },
  {
    "text": "very first Cube Builder um you know slide where you have one manager you",
    "start": "1387480",
    "end": "1393640"
  },
  {
    "text": "have controllers so each and every manager is basically dedicated to one",
    "start": "1393640",
    "end": "1399039"
  },
  {
    "text": "specific cluster so instead of having one single manager bulking up and making",
    "start": "1399039",
    "end": "1404679"
  },
  {
    "text": "it aware of all the Clusters we changed it to you you know what forget about let's just do cluster specific managers",
    "start": "1404679",
    "end": "1412440"
  },
  {
    "text": "let it have its own manager so that you're not changing anything in the cuq",
    "start": "1412440",
    "end": "1417919"
  },
  {
    "text": "Builder framework or any of these things but rather you're introducing something on top of it that is nothing but we",
    "start": "1417919",
    "end": "1424919"
  },
  {
    "text": "introduced something called multicluster manager and the multicluster manager's",
    "start": "1424919",
    "end": "1430360"
  },
  {
    "text": "responsibility is to make sure the you know it brings up the managers and it",
    "start": "1430360",
    "end": "1436600"
  },
  {
    "text": "shuts down the manager whenever it needs so in high level each cluster has its own cluster specific manager add the",
    "start": "1436600",
    "end": "1445320"
  },
  {
    "text": "controllers to all the you know uh cluster specific manager and then uh",
    "start": "1445320",
    "end": "1450880"
  },
  {
    "text": "adds those into multicluster manager and multicluster manager takes over in terms of um manager life cycle",
    "start": "1450880",
    "end": "1459240"
  },
  {
    "text": "events all right so yeah we it's pretty much where I was talking about you know multiple manager instead of one single",
    "start": "1459240",
    "end": "1466039"
  },
  {
    "text": "manager and uh um there's no changes no underlying changes whatever you see",
    "start": "1466039",
    "end": "1471919"
  },
  {
    "text": "reconciler however you create it in CU Builder literally the same way the new you know we can start using the same Rec",
    "start": "1471919",
    "end": "1479279"
  },
  {
    "text": "consiler and create these things so there's not nothing changed from that point of you except few you know this go",
    "start": "1479279",
    "end": "1487679"
  },
  {
    "text": "specific function you know goang related stuff nothing related to the the domain uh the controller runtime or any of",
    "start": "1487679",
    "end": "1493960"
  },
  {
    "text": "those Library related stuff so um other thing",
    "start": "1493960",
    "end": "1499000"
  },
  {
    "text": "it is important as if you look back here so the controllers are being added to",
    "start": "1499000",
    "end": "1504799"
  },
  {
    "text": "Cluster specific managers so the reconciler you have you're going to write one single reconciler class and",
    "start": "1504799",
    "end": "1512919"
  },
  {
    "text": "that needs to be aware of what cluster it's actually working on so we basically",
    "start": "1512919",
    "end": "1518919"
  },
  {
    "text": "introduced one extra you know field where we basically provide that the cluster name so it now at the reconciler",
    "start": "1518919",
    "end": "1526880"
  },
  {
    "text": "it knows which cluster it's actually working on and it basically if for",
    "start": "1526880",
    "end": "1533520"
  },
  {
    "text": "whatever the reason if you want to have a specific Logic for a specific cluster so now the reconciler now has the access",
    "start": "1533520",
    "end": "1539919"
  },
  {
    "text": "to the cluster name and you can you know write the code according to that",
    "start": "1539919",
    "end": "1545399"
  },
  {
    "text": "particular cluster so in high level I don't know if you can see it but in high",
    "start": "1545399",
    "end": "1551120"
  },
  {
    "text": "level this is on the left hand side sample Cube Builder right whenever you",
    "start": "1551120",
    "end": "1556240"
  },
  {
    "text": "use Cube Builder to create any controller what do you do this is more like a main.go if you look at it you create the",
    "start": "1556240",
    "end": "1563039"
  },
  {
    "text": "manager right on the top and then you add the controllers to that particular",
    "start": "1563039",
    "end": "1568360"
  },
  {
    "text": "manager and start the manager if you look at on the right hand",
    "start": "1568360",
    "end": "1574880"
  },
  {
    "text": "side that's our approach where multicluster controllers if you look at it it first",
    "start": "1574880",
    "end": "1581960"
  },
  {
    "text": "starts create a multicluster manager so before that if you look at it it actually instead of one single cluster",
    "start": "1581960",
    "end": "1590240"
  },
  {
    "text": "to be aware of multiple clusters you need to have multiple clusters Cube con so if you look at the you know one line",
    "start": "1590240",
    "end": "1597960"
  },
  {
    "text": "before that creating the cluster manager what we do is we basically go and pick",
    "start": "1597960",
    "end": "1603880"
  },
  {
    "text": "up the Clusters information which is in in our case we use it as a secret so you",
    "start": "1603880",
    "end": "1611200"
  },
  {
    "text": "have one secret per cluster which includes the cluster name and the cube config related to it so during the",
    "start": "1611200",
    "end": "1617159"
  },
  {
    "text": "bootstrap we go go and pick up all those secrets and now you have the list of clusters and the cube configs related to",
    "start": "1617159",
    "end": "1624039"
  },
  {
    "text": "it and create a m multicluster manager and then if you look at in the second",
    "start": "1624039",
    "end": "1630520"
  },
  {
    "text": "section it's basically adding the controllers to Cluster specific manager so if you look at the first line it's",
    "start": "1630520",
    "end": "1636200"
  },
  {
    "text": "more like pick up the cluster specific manager in the loop and go and add the",
    "start": "1636200",
    "end": "1642559"
  },
  {
    "text": "controllers so in this example we added two controllers if you look at this that's one of those is multi cluster",
    "start": "1642559",
    "end": "1648799"
  },
  {
    "text": "event where we are processing the events across all the Clusters and doing some",
    "start": "1648799",
    "end": "1654279"
  },
  {
    "text": "you know uh event related stuff and there's a namespace Recon where we are doing you know bunch of stuff related to",
    "start": "1654279",
    "end": "1661320"
  },
  {
    "text": "namespace whenever the namespace comes up but you get the point where you have a multicluster manager you create it you",
    "start": "1661320",
    "end": "1668679"
  },
  {
    "text": "add the controllers to the manager and then you start the multicluster manager",
    "start": "1668679",
    "end": "1673880"
  },
  {
    "text": "so it's closer to the CU Builder framework it's closer to um you know the",
    "start": "1673880",
    "end": "1680640"
  },
  {
    "text": "cube Builder framework and it's a centralized operator where instead of one single Cube config you basically",
    "start": "1680640",
    "end": "1686679"
  },
  {
    "text": "handing over multiple clusters Cube config so that's how closer uh you know",
    "start": "1686679",
    "end": "1694279"
  },
  {
    "text": "how much we closer we got to the CU Builder framework and that actually",
    "start": "1694279",
    "end": "1700840"
  },
  {
    "text": "helped a lot in terms of you know uh the users we we had one intern who were",
    "start": "1700840",
    "end": "1706880"
  },
  {
    "text": "writing the you know controllers on this particular framework where was easy for him to understand like okay so this is",
    "start": "1706880",
    "end": "1713519"
  },
  {
    "text": "what is there in the open source documentation and this is how we can do it for the multicluster controllers and",
    "start": "1713519",
    "end": "1719320"
  },
  {
    "text": "people are writing you know multiple multicluster controllers a lot um so",
    "start": "1719320",
    "end": "1727039"
  },
  {
    "text": "obviously the other thing I want to talk about like for any cluster um it any",
    "start": "1727039",
    "end": "1733760"
  },
  {
    "text": "product any software product um you're going to go it's going to go through lots of improvements enhancements and",
    "start": "1733760",
    "end": "1740440"
  },
  {
    "text": "whatnot so once we started running that for the last you know 6 months or 7 months we realized couple of things",
    "start": "1740440",
    "end": "1749919"
  },
  {
    "text": "couple of issues not issues but yeah challenges let's just say uh one of them is in Edge world there's a lot of",
    "start": "1749919",
    "end": "1757600"
  },
  {
    "text": "network connectivity issues more than you want it to happen right so a lot of",
    "start": "1757600",
    "end": "1763080"
  },
  {
    "text": "the times these clusters gets disconnected and you know because we",
    "start": "1763080",
    "end": "1768200"
  },
  {
    "text": "started the multicluster controllers and one of the manager gets stuck it's basically you know creating the issues",
    "start": "1768200",
    "end": "1774640"
  },
  {
    "text": "for that part all the controllers in that specific manager um but also um you",
    "start": "1774640",
    "end": "1781159"
  },
  {
    "text": "know like we said you know we are growing a lot and we are adding more and more clusters which basically means um",
    "start": "1781159",
    "end": "1789440"
  },
  {
    "text": "uh Dynamic clusters right you you know the whenever we pick whenever we're",
    "start": "1789440",
    "end": "1795080"
  },
  {
    "text": "doing the during the bootstrap we are actually picking up the clusters but after the part gets start if new cluster",
    "start": "1795080",
    "end": "1802880"
  },
  {
    "text": "comes up or if one of the existing cluster goes down we don't have a way to",
    "start": "1802880",
    "end": "1808360"
  },
  {
    "text": "manage those things so that's the another problem we had so what we have done is in very high level this is more",
    "start": "1808360",
    "end": "1814840"
  },
  {
    "text": "of a gorang related stuff and nothing more than that but so if you look at on the left side so these are the secrets",
    "start": "1814840",
    "end": "1821480"
  },
  {
    "text": "right in the particular multicluster controller you know people can add the secrets for specific clusters or if you",
    "start": "1821480",
    "end": "1828960"
  },
  {
    "text": "a cluster gets removed you know during the registration process or whatnot we are going to remove the secret that",
    "start": "1828960",
    "end": "1834640"
  },
  {
    "text": "basically based on the create update or delete event on uh in the on the secret",
    "start": "1834640",
    "end": "1840799"
  },
  {
    "text": "Informer we do those operations if you look at those things on the right side",
    "start": "1840799",
    "end": "1845840"
  },
  {
    "text": "if it's create you create that cluster specific manager add the controllers and",
    "start": "1845840",
    "end": "1851320"
  },
  {
    "text": "start the manage and for whatever the reason if the secet gets updated you know sometimes we actually do changes",
    "start": "1851320",
    "end": "1857760"
  },
  {
    "text": "the admin nodes from one side to the other side so at that time you need to have a different Cube convict so in that",
    "start": "1857760",
    "end": "1864159"
  },
  {
    "text": "case you literally stop the manager and do the same thing again and if it's you know secet gets deleted that means the",
    "start": "1864159",
    "end": "1870760"
  },
  {
    "text": "cluster got duplicated what not so you just stop the manager so this is all being done um you know uh inside the",
    "start": "1870760",
    "end": "1878360"
  },
  {
    "text": "part itself you're not stopping the part you're not doing any of the stuff it's just automatically getting taken care so",
    "start": "1878360",
    "end": "1885200"
  },
  {
    "text": "if you go back to the network connectivity issues right so what we have done is we started introducing",
    "start": "1885200",
    "end": "1892279"
  },
  {
    "text": "health checks so health check is basically every 30 seconds we're going to Ping these clusters and if there's",
    "start": "1892279",
    "end": "1898279"
  },
  {
    "text": "for whatever the reason there's a network connectivity issue we're going to stop the manager and going to we're",
    "start": "1898279",
    "end": "1903559"
  },
  {
    "text": "going to re try it so we basically simulating more like secret update",
    "start": "1903559",
    "end": "1908639"
  },
  {
    "text": "because it's a go Channel we just basically put a message there saying that hey there a you know update",
    "start": "1908639",
    "end": "1915000"
  },
  {
    "text": "happened which basically stops the manager and and then try to restart it and until the he Che ping is up to date",
    "start": "1915000",
    "end": "1924120"
  },
  {
    "text": "uh you know is able to talk to it and we should be able to good so so far we have",
    "start": "1924120",
    "end": "1929679"
  },
  {
    "text": "been running this for the last 2 years um it's no issues so far and we",
    "start": "1929679",
    "end": "1937200"
  },
  {
    "text": "probably have around nine different controllers uh and all of these are deployed in the central clusters we did",
    "start": "1937200",
    "end": "1944039"
  },
  {
    "text": "you know we save a lot of space or resources in the clusters uh for sure um",
    "start": "1944039",
    "end": "1950720"
  },
  {
    "text": "but this also solved as you know dynamic cluster management whenever new cluster comes in you know you don't have to",
    "start": "1950720",
    "end": "1957120"
  },
  {
    "text": "restart the parts or anything it just takes care of the things you know automatically all right so um finally uh",
    "start": "1957120",
    "end": "1966039"
  },
  {
    "text": "what I want to uh just talk about these things is more like resource",
    "start": "1966039",
    "end": "1971279"
  },
  {
    "text": "recognization you have to at least in Edge space you have to understand that",
    "start": "1971279",
    "end": "1976320"
  },
  {
    "text": "uh there's a lot of um re constraints especially if you are into in a physical server infrastructure uh but also you",
    "start": "1976320",
    "end": "1984159"
  },
  {
    "text": "can't just sit tight and say like hey there's no resources and we cannot provide more platform features so you",
    "start": "1984159",
    "end": "1989600"
  },
  {
    "text": "have to balance it so but also on the other hand you can't just write you know",
    "start": "1989600",
    "end": "1996440"
  },
  {
    "text": "or invent different things it's always good to invent those things but um if there is a possibility to be closer to",
    "start": "1996440",
    "end": "2003960"
  },
  {
    "text": "the open source related Frameworks uh at least from my team point of you that's our",
    "start": "2003960",
    "end": "2009120"
  },
  {
    "text": "preference keep it closer to the open source uh you know adoption so that it's easy for any new Engineers to understand",
    "start": "2009120",
    "end": "2017440"
  },
  {
    "text": "and you know easy to onboard um and simplified deployment this is the one of",
    "start": "2017440",
    "end": "2023320"
  },
  {
    "text": "those hidden benefits I cannot you know be happy about this is",
    "start": "2023320",
    "end": "2029480"
  },
  {
    "text": "more like previously it used to take multiple days for us to deploy a",
    "start": "2029480",
    "end": "2034919"
  },
  {
    "text": "platform operator across all the you know clusters big because um like I said you know a lot of the times users",
    "start": "2034919",
    "end": "2041840"
  },
  {
    "text": "reserve it all the uh you know resources and we need to work with those guys to",
    "start": "2041840",
    "end": "2046960"
  },
  {
    "text": "you know you know reclaim some of these resources so that this actually helped",
    "start": "2046960",
    "end": "2052079"
  },
  {
    "text": "us completely cleaning it up okay so I don't need anything all I need is in the central management cluster which we have",
    "start": "2052079",
    "end": "2058720"
  },
  {
    "text": "control and these are cluster you know uh Cloud clusters so that we can bump up",
    "start": "2058720",
    "end": "2063800"
  },
  {
    "text": "the you know resources if we need it um but I also want to finally you know",
    "start": "2063800",
    "end": "2069118"
  },
  {
    "text": "close it with this is a opinionated approach I'm not going to say that this is going to work for everybody every",
    "start": "2069119",
    "end": "2076000"
  },
  {
    "text": "organization some of these operators are probably you're writing is Demonite you know it has to be on the particular node",
    "start": "2076000",
    "end": "2083000"
  },
  {
    "text": "so there's no you know going around that uh you know demon set idea whatnot so",
    "start": "2083000",
    "end": "2088398"
  },
  {
    "text": "these are um you know opinionated approach it's space uh you know Case by",
    "start": "2088399",
    "end": "2093960"
  },
  {
    "text": "case it may work it may not work for your case but this is our journey from",
    "start": "2093960",
    "end": "2099079"
  },
  {
    "text": "Tik Tok where we had to go little bit of out of box to um improve the operators",
    "start": "2099079",
    "end": "2107320"
  },
  {
    "text": "from one single cluster to multiple clusters and uh hopefully you know we",
    "start": "2107320",
    "end": "2112680"
  },
  {
    "text": "were also uh talking to multicluster Sig um you know team as well and the you",
    "start": "2112680",
    "end": "2119720"
  },
  {
    "text": "know hopefully once you have the cluster inventory in a cube Builder also can",
    "start": "2119720",
    "end": "2125320"
  },
  {
    "text": "adapt the you know newer cluster inventory to uh",
    "start": "2125320",
    "end": "2131359"
  },
  {
    "text": "start making this operator aware of multiple cluster instead of one single cluster but obviously you know we are",
    "start": "2131359",
    "end": "2138560"
  },
  {
    "text": "very um far from that thing uh it's probably going to take one or one and a half year but yeah this is this is more",
    "start": "2138560",
    "end": "2146119"
  },
  {
    "text": "about our approach and that's about our you know our journey in terms of a",
    "start": "2146119",
    "end": "2152680"
  },
  {
    "text": "multicluster controllers thank [Applause] you",
    "start": "2152680",
    "end": "2159640"
  },
  {
    "text": "I know I probably took more time but anybody has any questions you know I can",
    "start": "2160640",
    "end": "2166079"
  },
  {
    "text": "yes I can yes we can talk about",
    "start": "2166079",
    "end": "2172960"
  }
]